000100*----------------------------------------------------------       00010002
000200 IDENTIFICATION DIVISION.                                         00020002
000300*----------------------------------------------------------       00030017
000400 PROGRAM-ID.             PMKUT114.                                00040002
000500 AUTHOR.                 ALEXIS KEIKER                            00050002
000600 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00060002
000700 DATE-WRITTEN.           AUGUST 2003.                             00070002
000800 DATE-COMPILED.                                                   00080002
000900*----------------------------------------------------------       00090002
001000*          PMKUT114 - AD EVENT FILE CREATOR                       00100002
001100*----------------------------------------------------------       00110002
001200* THIS PROGRAM TAKES IN TWO FILES, ONE A CONTROL CARD WITH        00120002
001300* A RUN DATE IN IT AND ANOTHER A CONTROL CARD THAT CONTAINS       00130002
001400* DATE INFORMATION.  THIS PROGRAM WILL FETCH ALL AD EVENTS        00140002
001500* THAT COINCIDE WITH THE TWO INPUT FILES AND WRITE EACH           00150002
001600* UNIQUE AD EVENT TO A SEPARATE FILE.  THERE ARE ONLY             00160002
001700* 5 AD EVENT FILES SET UP FOR THIS PROGRAM SO IF THERE ARE        00170002
001800* MORE THIS PROGRAM WILL ABEND.  IT WILL ALSO WRITE OUT           00180002
001900* THREE PROMOTION FILES: ONE THAT IS AN INITIAL PROMOTION         00190002
002000* FILE, ONE THAT IS A PRE CORRECTION PROMOTION FILE, AND          00200002
002100* ONE THAT IS A POST CORRECTION PROMOTION FILE.  THESE            00210002
002200* FILES WILL CONTAIN A PROMOTION THAT IS AN ADVERTISED            00220002
002300* NON-MAIN PROMOTION AND THEN IT WILL HAVE AN INDICATOR           00230002
002400* TELLING WHETHER IT IS INITIAL, PRE CORRECTION, OR               00240002
002500* POST CORRECTION.                                                00250002
002600*----------------------------------------------------------       00260002
002700* HISTORY LOG:                                                    00270002
002800*----------------------------------------------------------       00280002
002900* DATE:        1/12/2004                                          00290002
003000* WR/IR#:      WR25854                                            00300002
003100* PROGRAMMER:  COLLEEN CUMMINGS                                   00310002
003200* DESCRIPTION: CHANGED AD EVNT FILES TO BE LENGTH OF 80           00320002
003300*              INSTEAD OF 10 FOR ON-REQUEST SCHEDULING.           00330002
003400*              (CONTROL CARD LENGTH)                              00340002
003500*                                                                 00350002
003600* DATE:        5/04/2004                                          00360002
003700* WR/IR#:      WR25732                                            00370002
003800* PROGRAMMER:  COLLEEN CUMMINGS                                   00380002
003900* DESCRIPTION: CHANGED CURSOR TO ALSO PULL WHERE                  00390002
004000*              PROMO_DFLT_END_TMST BETWEEN DATES (OTHERWISE       00400002
004100*              WAS ONLY PULLING WHERE PROMO_DFLT_STRT_TMST        00410002
004200*              WAS BETWEEN THE DATES - SO NOTHING WAS LOADING     00420002
004300*              UP UNTIL THE PROMOTION ENDS).  NEED THIS FOR       00430002
004400*              EARLY RECEIPT REPORT.                              00440002
004500*                                                                 00450002
004600* DATE:        12/1/2004                                          00460002
004700* WR/IR#:      WR27525                                            00470002
004800* PROGRAMMER:  KELLY LARUM                                        00480002
004900* DESCRIPTION: ADDED 3 ADDITIONAL FILES OF PROMO IDS              00490002
005000*              FOR THE BOGO COMPLIANCE REPORT.                    00500002
005100*              ADDED 3 MORE FILES WITH DATE RANGES                00510002
005200*              FOR THE BOGO COMPLIANCE REPORT.                    00520002
005300*                                                                 00530002
005400* DATE:        06/08/2005                                         00540002
005500* WR/IR#:      WR28438                                            00550002
005600* PROGRAMMER:  TOM BOYD                                           00560002
005700* DESCRIPTION: REPORT AUTOMATION CHANGES.                         00570006
005800*        - RUN DATE PASSED IN IS THE CURRENT DATE                 00580006
005900*        - REPORT SCHEDULE CHANGED TO BE BASED OFF OF             00590006
006000*          LOCKOUT DATE INSTEAD OF START DATE.                    00600006
006100*        - ADDED ADDITIONAL OUTPUT FILES FOR AUTOMATION OF        00610006
006200*          ADDITIONAL REPORTS, PREVIOUS FILES WERE LEFT AS IS.    00620006
005400* DATE:        06/09/2006                                         00621024
005500* WR/IR#:      PM889501                                           00622025
005600* PROGRAMMER:  MINDY POWELL                                       00623024
005700* DESCRIPTION: UPDATED THE PARTIAL DAY QUERY.                     00624024
005800*        - TOOK OUT THE CALLS TO THE PL/SQL FUNCTION TO FIGURE    00625024
                 OUT THE DIFFERENCES BETWEEN THE START & END TMST.      00626024
               - ADDED IN CHECK FOR START TMST NOT EQUAL TO 00:00       00627024
                 OR END TMST NOT EQUAL TO 23:59.                        00628024
      *                                                                 00628128
      * DATE:        10/29/2008                                         00629028
      * WR/IR#:      INC000000567913                                    00629128
      * PROGRAMMER:  DARYL STEWART                                      00629228
      * DESCRIPTION:  HARD CODING BYPASS FOR NOVEMBER 2008 "DEAL OF THE 00629328
      *               DAY" PROMOTIONS. THEY ARE WEB ONLY PROMOTIONS.    00629428
      *                                                                 00629532
      * DATE:        05/19/2010                                         00629632
      * WR/IR#:      WR37986                                            00629732
      * PROGRAMMER:  COGNIZANT                                          00629832
      * DESCRIPTION: CREATING NEW OUTPUT FILE OUT30 FOR                 00629932
      *              KIOSK POST CORRECTION 2                            00630032
      *                                                                 00630133
PK7624* DATE:        04/21/2011                                         00630233
PK7624* WR/IR#:      PKE000000007624                                    00630333
PK7624* PROGRAMMER:  COGNIZANT                                          00630433
PK7624* DESCRIPTION: EOS PRE-CORRECTION REPORT AVAILABLILITY DAY CHANGE 00630533
PK7624*              IF THE LOCKOUT DATE OF THE PROMO IS MONDAY         00630633
C09985*                                                                 00630747
C09985* DATE:        04/20/2015                                         00630847
C09985* WR/IR#:      CHG0109985                                         00630947
C09985* PROGRAMMER:  JOHN SELWITSCHKA                                   00631047
C09985* DESCRIPTION: ADD ADDITIONAL VERSIONS FOR BELOW COST AND BOGO    00631147
C09985*              OVERLAP REPORTS                                    00631247
070941*                                                                 00631359
070941* DATE:        07/30/2018                                         00631459
070941* WR/IR#:      CHG0204126                                         00631559
070941* PROGRAMMER:  COGNIZANT                                          00631659
070941* DESCRIPTION: ORACLE LOGON STANDARDS PROGRAM CHANGE              00631759
006300*----------------------------------------------------------       00632047
006400 ENVIRONMENT DIVISION.                                            00640002
006500*----------------------------------------------------------       00650002
006600 CONFIGURATION SECTION.                                           00660002
006700 SOURCE-COMPUTER. IBM-3090.                                       00670002
006800 OBJECT-COMPUTER. IBM-3090.                                       00680002
006900                                                                  00690002
007000 INPUT-OUTPUT SECTION.                                            00700002
007100                                                                  00710002
007200 FILE-CONTROL.                                                    00720002
007300                                                                  00730002
007400     SELECT CONTROL-CARD-FILE                                     00740002
007500            ASSIGN TO INP01.                                      00750002
007600                                                                  00760002
007700     SELECT PROMO-BEGIN-FILE                                      00770002
007800            ASSIGN TO INP02.                                      00780002
007900                                                                  00790002
008000     SELECT EOS-TYPE-FILE                                         00800002
008100            ASSIGN TO INP03.                                      00810002
008200                                                                  00820002
070941     SELECT ORACLE-LOGON-FILE                                     00821054
070941            ASSIGN TO ORALOGON.                                   00822057
070941                                                                  00838256
008300     SELECT EXCPT-ADEVNT-FILE-1                                   00839002
008400            ASSIGN TO OUT01.                                      00840002
008500                                                                  00850002
008600     SELECT EXCPT-ADEVNT-FILE-2                                   00860002
008700            ASSIGN TO OUT02.                                      00870002
008800                                                                  00880002
008900     SELECT EXCPT-ADEVNT-FILE-3                                   00890002
009000            ASSIGN TO OUT03.                                      00900002
009100                                                                  00910002
009200     SELECT EXCPT-ADEVNT-FILE-4                                   00920002
009300            ASSIGN TO OUT04.                                      00930002
009400                                                                  00940002
009500     SELECT EXCPT-ADEVNT-FILE-5                                   00950002
009600            ASSIGN TO OUT05.                                      00960002
009700                                                                  00970002
009800     SELECT EXCPT-PROMO-INITIAL-FILE                              00980002
009900            ASSIGN TO OUT06.                                      00990002
010000                                                                  01000002
010100     SELECT EXCPT-PROMO-PRECORR-FILE                              01010002
010200            ASSIGN TO OUT07.                                      01020002
010300                                                                  01030002
010400     SELECT EXCPT-PROMO-POSTCORR-FILE                             01040002
010500            ASSIGN TO OUT08.                                      01050002
010600                                                                  01060002
010700     SELECT EXCPT-BOGOC-INITIAL-FILE                              01070002
010800            ASSIGN TO OUT09.                                      01080002
010900                                                                  01090002
011000     SELECT EXCPT-BOGOC-PRECORR-FILE                              01100002
011100            ASSIGN TO OUT10.                                      01110002
011200                                                                  01120002
011300     SELECT EXCPT-BOGOC-POSTCORR-FILE                             01130002
011400            ASSIGN TO OUT11.                                      01140002
011500                                                                  01150002
011600     SELECT EXCPT-BOGOC-INITIAL-DT-FILE                           01160002
011700            ASSIGN TO OUT12.                                      01170002
011800                                                                  01180002
011900     SELECT EXCPT-BOGOC-PRECORR-DT-FILE                           01190002
012000            ASSIGN TO OUT13.                                      01200002
012100                                                                  01210002
012200     SELECT EXCPT-BOGOC-POSTCORR-DT-FILE                          01220002
012300            ASSIGN TO OUT14.                                      01230002
012400                                                                  01240002
012500     SELECT EXCPT-BOGOO-INITIAL-FILE                              01250002
012600            ASSIGN TO OUT15.                                      01260002
012700                                                                  01270002
012800     SELECT EXCPT-BOGOO-PRECORR-FILE                              01280002
012900            ASSIGN TO OUT16.                                      01290002
013000                                                                  01300002
013100     SELECT EXCPT-BOGOO-POSTCORR-FILE                             01310002
013200            ASSIGN TO OUT17.                                      01320002
013300                                                                  01330002
013400     SELECT EXCPT-BOGOO-POSTCORR-FILE-2                           01340002
013500            ASSIGN TO OUT18.                                      01350002
013600                                                                  01360002
013700     SELECT EXCPT-EOS-INITIAL-FILE                                01370002
013800            ASSIGN TO OUT19.                                      01380002
013900                                                                  01390002
014000     SELECT EXCPT-EOS-PRECORR-FILE                                01400002
014100            ASSIGN TO OUT20.                                      01410002
014200                                                                  01420002
014300     SELECT EXCPT-EOS-POSTCORR-FILE                               01430002
014400            ASSIGN TO OUT21.                                      01440002
014500                                                                  01450002
014600     SELECT EXCPT-EOS-POSTCORR-FILE-2                             01460002
014700            ASSIGN TO OUT22.                                      01470002
014800                                                                  01480002
014900     SELECT EXCPT-EOS-INITIAL-DTE-FILE                            01490002
015000            ASSIGN TO OUT23.                                      01500002
015100                                                                  01510002
015200     SELECT EXCPT-EOS-PRECORR-DTE-FILE                            01520002
015300            ASSIGN TO OUT24.                                      01530002
015400                                                                  01540002
015500     SELECT EXCPT-EOS-POSTCORR-DTE-FILE                           01550002
015600            ASSIGN TO OUT25.                                      01560002
015700                                                                  01570002
015800     SELECT EXCPT-EOS-POSTCORR-DTE-FILE-2                         01580002
015900            ASSIGN TO OUT26.                                      01590002
016000                                                                  01600002
016100     SELECT EXCPT-PAR-INITIAL-FILE                                01610002
016200            ASSIGN TO OUT27.                                      01620002
016300                                                                  01630002
016400     SELECT EXCPT-PAR-PRECORR-FILE                                01640002
016500            ASSIGN TO OUT28.                                      01650002
016600                                                                  01660002
016700     SELECT EXCPT-PAR-POSTCORR-FILE                               01670002
016800            ASSIGN TO OUT29.                                      01680002
W37986                                                                  01681032
W37986     SELECT KIOSK-POST-CORR2-FILE                                 01682032
W37986            ASSIGN TO OUT30.                                      01683032
C09985                                                                  01684036
C09985     SELECT EXCPT-PROMO-POSTCORR-FILE-2                           01684136
C09985            ASSIGN TO OUT31.                                      01685036
C09985                                                                  01686036
C09985     SELECT EXCPT-PROMO-POSTCORR-FILE-3                           01687036
C09985            ASSIGN TO OUT32.                                      01688036
C09985                                                                  01689038
C09985     SELECT EXCPT-BOGOO-POSTCORR-FILE-3                           01689138
C09985            ASSIGN TO OUT33.                                      01689238
016900                                                                  01690002
017000                                                                  01700002
017100*----------------------------------------------------------       01710002
017200 DATA DIVISION.                                                   01720002
017300*----------------------------------------------------------       01730002
017400 FILE SECTION.                                                    01740002
017500                                                                  01750002
017600 FD  CONTROL-CARD-FILE                                            01760002
017700     RECORDING MODE F                                             01770002
017800     BLOCK CONTAINS 0 RECORDS                                     01780002
017900     LABEL RECORDS ARE OMITTED                                    01790002
018000     DATA RECORD IS CONTROL-CARD-RECORD.                          01800002
018100 01  CONTROL-CARD-RECORD              PIC X(80).                  01810002
018200                                                                  01820002
018300 FD  PROMO-BEGIN-FILE                                             01830002
018400     RECORDING MODE F                                             01840002
018500     BLOCK CONTAINS 0 RECORDS                                     01850002
018600     LABEL RECORDS ARE OMITTED                                    01860002
018700     DATA RECORD IS PROMO-BEGIN-RECORD.                           01870002
018800 01  PROMO-BEGIN-RECORD               PIC X(80).                  01880002
018900                                                                  01890002
019000 FD  EOS-TYPE-FILE                                                01900002
019100     RECORDING MODE F                                             01910002
019200     BLOCK CONTAINS 0 RECORDS                                     01920002
019300     LABEL RECORDS ARE OMITTED                                    01930002
019400     DATA RECORD IS EOS-TYPE-RECORD.                              01940002
019500 01  EOS-TYPE-RECORD                  PIC X(80).                  01950002
019600                                                                  01960002
019700 FD  EXCPT-ADEVNT-FILE-1                                          01970002
019800     RECORDING MODE F                                             01980002
019900     BLOCK CONTAINS 0 RECORDS                                     01990002
020000     LABEL RECORDS ARE OMITTED                                    02000002
020100     DATA RECORD IS EXCPT-ADEVNT-REC-1.                           02010002
020200 01  EXCPT-ADEVNT-REC-1               PIC X(80).                  02020002
020300                                                                  02030002
020400 FD  EXCPT-ADEVNT-FILE-2                                          02040002
020500     RECORDING MODE F                                             02050002
020600     BLOCK CONTAINS 0 RECORDS                                     02060002
020700     LABEL RECORDS ARE OMITTED                                    02070002
020800     DATA RECORD IS EXCPT-ADEVNT-REC-2.                           02080002
020900 01  EXCPT-ADEVNT-REC-2               PIC X(80).                  02090002
021000                                                                  02100002
021100 FD  EXCPT-ADEVNT-FILE-3                                          02110002
021200     RECORDING MODE F                                             02120002
021300     BLOCK CONTAINS 0 RECORDS                                     02130002
021400     LABEL RECORDS ARE OMITTED                                    02140002
021500     DATA RECORD IS EXCPT-ADEVNT-REC-3.                           02150002
021600 01  EXCPT-ADEVNT-REC-3               PIC X(80).                  02160002
021700                                                                  02170002
021800 FD  EXCPT-ADEVNT-FILE-4                                          02180002
021900     RECORDING MODE F                                             02190002
022000     BLOCK CONTAINS 0 RECORDS                                     02200002
022100     LABEL RECORDS ARE OMITTED                                    02210002
022200     DATA RECORD IS EXCPT-ADEVNT-REC-4.                           02220002
022300 01  EXCPT-ADEVNT-REC-4               PIC X(80).                  02230002
022400                                                                  02240002
022500 FD  EXCPT-ADEVNT-FILE-5                                          02250002
022600     RECORDING MODE F                                             02260002
022700     BLOCK CONTAINS 0 RECORDS                                     02270002
022800     LABEL RECORDS ARE OMITTED                                    02280002
022900     DATA RECORD IS EXCPT-ADEVNT-REC-5.                           02290002
023000 01  EXCPT-ADEVNT-REC-5               PIC X(80).                  02300002
023100                                                                  02310002
023200 FD  EXCPT-PROMO-INITIAL-FILE                                     02320002
023300     RECORDING MODE F                                             02330002
023400     BLOCK CONTAINS 0 RECORDS                                     02340002
023500     LABEL RECORDS ARE OMITTED                                    02350002
023600     DATA RECORD IS EXCPT-PROMO-INITIAL-REC.                      02360002
023700 01  EXCPT-PROMO-INITIAL-REC          PIC X(80).                  02370002
023800                                                                  02380002
023900 FD  EXCPT-PROMO-PRECORR-FILE                                     02390002
024000     RECORDING MODE F                                             02400002
024100     BLOCK CONTAINS 0 RECORDS                                     02410002
024200     LABEL RECORDS ARE OMITTED                                    02420002
024300     DATA RECORD IS EXCPT-PROMO-PRECORR-REC.                      02430002
024400 01  EXCPT-PROMO-PRECORR-REC          PIC X(80).                  02440002
024500                                                                  02450002
024600 FD  EXCPT-PROMO-POSTCORR-FILE                                    02460002
024700     RECORDING MODE F                                             02470002
024800     BLOCK CONTAINS 0 RECORDS                                     02480002
024900     LABEL RECORDS ARE OMITTED                                    02490002
025000     DATA RECORD IS EXCPT-PROMO-POSTCORR-REC.                     02500002
025100 01  EXCPT-PROMO-POSTCORR-REC         PIC X(80).                  02510002
025200                                                                  02520002
025300 FD  EXCPT-BOGOC-INITIAL-FILE                                     02530002
025400     RECORDING MODE F                                             02540002
025500     BLOCK CONTAINS 0 RECORDS                                     02550002
025600     LABEL RECORDS ARE OMITTED                                    02560002
025700     DATA RECORD IS EXCPT-BOGOC-INITIAL-REC.                      02570002
025800 01  EXCPT-BOGOC-INITIAL-REC          PIC X(80).                  02580002
025900                                                                  02590002
026000 FD  EXCPT-BOGOC-PRECORR-FILE                                     02600002
026100     RECORDING MODE F                                             02610002
026200     BLOCK CONTAINS 0 RECORDS                                     02620002
026300     LABEL RECORDS ARE OMITTED                                    02630002
026400     DATA RECORD IS EXCPT-BOGOC-PRECORR-REC.                      02640002
026500 01  EXCPT-BOGOC-PRECORR-REC          PIC X(80).                  02650002
026600                                                                  02660002
026700 FD  EXCPT-BOGOC-POSTCORR-FILE                                    02670002
026800     RECORDING MODE F                                             02680002
026900     BLOCK CONTAINS 0 RECORDS                                     02690002
027000     LABEL RECORDS ARE OMITTED                                    02700002
027100     DATA RECORD IS EXCPT-BOGOC-POSTCORR-REC.                     02710002
027200 01  EXCPT-BOGOC-POSTCORR-REC         PIC X(80).                  02720002
027300                                                                  02730002
027400 FD  EXCPT-BOGOC-INITIAL-DT-FILE                                  02740002
027500     RECORDING MODE F                                             02750002
027600     BLOCK CONTAINS 0 RECORDS                                     02760002
027700     LABEL RECORDS ARE OMITTED                                    02770002
027800     DATA RECORD IS EXCPT-BOGOC-INITIAL-DT-REC.                   02780002
027900 01  EXCPT-BOGOC-INITIAL-DT-REC       PIC X(80).                  02790002
028000                                                                  02800002
028100 FD  EXCPT-BOGOC-PRECORR-DT-FILE                                  02810002
028200     RECORDING MODE F                                             02820002
028300     BLOCK CONTAINS 0 RECORDS                                     02830002
028400     LABEL RECORDS ARE OMITTED                                    02840002
028500     DATA RECORD IS EXCPT-BOGOC-PRECORR-DT-REC.                   02850002
028600 01  EXCPT-BOGOC-PRECORR-DT-REC          PIC X(80).               02860002
028700                                                                  02870002
028800 FD  EXCPT-BOGOC-POSTCORR-DT-FILE                                 02880002
028900     RECORDING MODE F                                             02890002
029000     BLOCK CONTAINS 0 RECORDS                                     02900002
029100     LABEL RECORDS ARE OMITTED                                    02910002
029200     DATA RECORD IS EXCPT-BOGOC-POSTCORR-DT-REC.                  02920002
029300 01  EXCPT-BOGOC-POSTCORR-DT-REC         PIC X(80).               02930002
029400                                                                  02940002
029500 FD  EXCPT-BOGOO-INITIAL-FILE                                     02950002
029600     RECORDING MODE F                                             02960002
029700     BLOCK CONTAINS 0 RECORDS                                     02970002
029800     LABEL RECORDS ARE OMITTED                                    02980002
029900     DATA RECORD IS EXCPT-BOGOO-INITIAL-REC.                      02990002
030000 01  EXCPT-BOGOO-INITIAL-REC          PIC X(80).                  03000002
030100                                                                  03010002
030200 FD  EXCPT-BOGOO-PRECORR-FILE                                     03020002
030300     RECORDING MODE F                                             03030002
030400     BLOCK CONTAINS 0 RECORDS                                     03040002
030500     LABEL RECORDS ARE OMITTED                                    03050002
030600     DATA RECORD IS EXCPT-BOGOO-PRECORR-REC.                      03060002
030700 01  EXCPT-BOGOO-PRECORR-REC          PIC X(80).                  03070002
030800                                                                  03080002
030900 FD  EXCPT-BOGOO-POSTCORR-FILE                                    03090002
031000     RECORDING MODE F                                             03100002
031100     BLOCK CONTAINS 0 RECORDS                                     03110002
031200     LABEL RECORDS ARE OMITTED                                    03120002
031300     DATA RECORD IS EXCPT-BOGOO-POSTCORR-REC.                     03130002
031400 01  EXCPT-BOGOO-POSTCORR-REC         PIC X(80).                  03140002
031500                                                                  03150002
031600 FD  EXCPT-BOGOO-POSTCORR-FILE-2                                  03160002
031700     RECORDING MODE F                                             03170002
031800     BLOCK CONTAINS 0 RECORDS                                     03180002
031900     LABEL RECORDS ARE OMITTED                                    03190002
032000     DATA RECORD IS EXCPT-BOGOO-POSTCORR-2-REC.                   03200002
032100 01  EXCPT-BOGOO-POSTCORR-2-REC       PIC X(80).                  03210002
032200                                                                  03220002
032300 FD  EXCPT-EOS-INITIAL-FILE                                       03230002
032400     RECORDING MODE F                                             03240002
032500     BLOCK CONTAINS 0 RECORDS                                     03250002
032600     LABEL RECORDS ARE OMITTED                                    03260002
032700     DATA RECORD IS EXCPT-EOS-INITIAL-REC.                        03270002
032800 01  EXCPT-EOS-INITIAL-REC            PIC X(80).                  03280002
032900                                                                  03290002
033000 FD  EXCPT-EOS-PRECORR-FILE                                       03300002
033100     RECORDING MODE F                                             03310002
033200     BLOCK CONTAINS 0 RECORDS                                     03320002
033300     LABEL RECORDS ARE OMITTED                                    03330002
033400     DATA RECORD IS EXCPT-EOS-PRECORR-REC.                        03340002
033500 01  EXCPT-EOS-PRECORR-REC            PIC X(80).                  03350002
033600                                                                  03360002
033700 FD  EXCPT-EOS-POSTCORR-FILE                                      03370002
033800     RECORDING MODE F                                             03380002
033900     BLOCK CONTAINS 0 RECORDS                                     03390002
034000     LABEL RECORDS ARE OMITTED                                    03400002
034100     DATA RECORD IS EXCPT-EOS-POSTCORR-REC.                       03410002
034200 01  EXCPT-EOS-POSTCORR-REC           PIC X(80).                  03420002
034300                                                                  03430002
034400 FD  EXCPT-EOS-POSTCORR-FILE-2                                    03440002
034500     RECORDING MODE F                                             03450002
034600     BLOCK CONTAINS 0 RECORDS                                     03460002
034700     LABEL RECORDS ARE OMITTED                                    03470002
034800     DATA RECORD IS EXCPT-EOS-POSTCORR-REC-2.                     03480002
034900 01  EXCPT-EOS-POSTCORR-REC-2         PIC X(80).                  03490002
035000                                                                  03500002
035100 FD  EXCPT-EOS-INITIAL-DTE-FILE                                   03510002
035200     RECORDING MODE F                                             03520002
035300     BLOCK CONTAINS 0 RECORDS                                     03530002
035400     LABEL RECORDS ARE OMITTED                                    03540002
035500     DATA RECORD IS EXCPT-EOS-INITIAL-DTE-REC.                    03550002
035600 01  EXCPT-EOS-INITIAL-DTE-REC        PIC X(80).                  03560002
035700                                                                  03570002
035800 FD  EXCPT-EOS-PRECORR-DTE-FILE                                   03580002
035900     RECORDING MODE F                                             03590002
036000     BLOCK CONTAINS 0 RECORDS                                     03600002
036100     LABEL RECORDS ARE OMITTED                                    03610002
036200     DATA RECORD IS EXCPT-EOS-PRECORR-DTE-REC.                    03620002
036300 01  EXCPT-EOS-PRECORR-DTE-REC        PIC X(80).                  03630002
036400                                                                  03640002
036500 FD  EXCPT-EOS-POSTCORR-DTE-FILE                                  03650002
036600     RECORDING MODE F                                             03660002
036700     BLOCK CONTAINS 0 RECORDS                                     03670002
036800     LABEL RECORDS ARE OMITTED                                    03680002
036900     DATA RECORD IS EXCPT-EOS-POSTCORR-DTE-REC.                   03690002
037000 01  EXCPT-EOS-POSTCORR-DTE-REC       PIC X(80).                  03700002
037100                                                                  03710002
037200 FD  EXCPT-EOS-POSTCORR-DTE-FILE-2                                03720002
037300     RECORDING MODE F                                             03730002
037400     BLOCK CONTAINS 0 RECORDS                                     03740002
037500     LABEL RECORDS ARE OMITTED                                    03750002
037600     DATA RECORD IS EXCPT-EOS-POSTCORR-DTE-REC-2.                 03760002
037700 01  EXCPT-EOS-POSTCORR-DTE-REC-2     PIC X(80).                  03770002
037800                                                                  03780002
037900 FD  EXCPT-PAR-INITIAL-FILE                                       03790002
038000     RECORDING MODE F                                             03800002
038100     BLOCK CONTAINS 0 RECORDS                                     03810002
038200     LABEL RECORDS ARE OMITTED                                    03820002
038300     DATA RECORD IS EXCPT-PAR-INITIAL-REC.                        03830002
038400 01  EXCPT-PAR-INITIAL-REC            PIC X(80).                  03840002
038500                                                                  03850002
038600 FD  EXCPT-PAR-PRECORR-FILE                                       03860002
038700     RECORDING MODE F                                             03870002
038800     BLOCK CONTAINS 0 RECORDS                                     03880002
038900     LABEL RECORDS ARE OMITTED                                    03890002
039000     DATA RECORD IS EXCPT-PAR-PRECORR-REC.                        03900002
039100 01  EXCPT-PAR-PRECORR-REC            PIC X(80).                  03910002
039200                                                                  03920002
039300 FD  EXCPT-PAR-POSTCORR-FILE                                      03930002
039400     RECORDING MODE F                                             03940002
039500     BLOCK CONTAINS 0 RECORDS                                     03950002
039600     LABEL RECORDS ARE OMITTED                                    03960002
039700     DATA RECORD IS EXCPT-PAR-POSTCORR-REC.                       03970002
039800 01  EXCPT-PAR-POSTCORR-REC           PIC X(80).                  03980002
W37986                                                                  03981032
W37986 FD  KIOSK-POST-CORR2-FILE                                        03982032
W37986     RECORDING MODE F                                             03983032
W37986     BLOCK CONTAINS 0 RECORDS                                     03984032
W37986     LABEL RECORDS ARE OMITTED                                    03985032
W37986     DATA RECORD IS KIOSK-POST-CORR2-REC.                         03986032
W37986 01  KIOSK-POST-CORR2-REC             PIC X(80).                  03987032
039900                                                                  03990002
C09985 FD  EXCPT-PROMO-POSTCORR-FILE-2                                  03990138
C09985     RECORDING MODE F                                             03990238
C09985     BLOCK CONTAINS 0 RECORDS                                     03990338
C09985     LABEL RECORDS ARE OMITTED                                    03990438
C09985     DATA RECORD IS EXCPT-PROMO-POSTCORR-2-REC.                   03990543
C09985 01  EXCPT-PROMO-POSTCORR-2-REC       PIC X(80).                  03990638
C09985                                                                  03990738
C09985 FD  EXCPT-PROMO-POSTCORR-FILE-3                                  03990838
C09985     RECORDING MODE F                                             03990938
C09985     BLOCK CONTAINS 0 RECORDS                                     03991038
C09985     LABEL RECORDS ARE OMITTED                                    03991138
C09985     DATA RECORD IS EXCPT-PROMO-POSTCORR-3-REC.                   03991238
C09985 01  EXCPT-PROMO-POSTCORR-3-REC       PIC X(80).                  03991338
C09985                                                                  03991438
C09985 FD  EXCPT-BOGOO-POSTCORR-FILE-3                                  03991538
C09985     RECORDING MODE F                                             03992038
C09985     BLOCK CONTAINS 0 RECORDS                                     03993038
C09985     LABEL RECORDS ARE OMITTED                                    03994038
C09985     DATA RECORD IS EXCPT-BOGOO-POSTCORR-3-REC.                   03995038
C09985 01  EXCPT-BOGOO-POSTCORR-3-REC       PIC X(80).                  03996038
C09985                                                                  03997038
070941 FD  ORACLE-LOGON-FILE                                            03998054
070941     RECORDING MODE IS F                                          03999054
070941     LABEL RECORDS ARE STANDARD                                   03999154
070941     BLOCK CONTAINS 0 RECORDS                                     03999254
070941     RECORD CONTAINS 80 CHARACTERS                                03999354
070941     DATA RECORDS IS OL-ORACLE-LOGON-RECORD.                      03999454
070941 01  OL-ORACLE-LOGON-RECORD      PIC X(80).                       03999554
070941                                                                  03999656
040000                                                                  04000002
040100 WORKING-STORAGE SECTION.                                         04010002
040200*----------------------------------------------------------       04020002
040300* ABEND- ABEND VARIABLES                                          04030002
040400*----------------------------------------------------------       04040002
040500 01  ABEND-CODE                       PIC S9(04) COMP VALUE +0.   04050002
040600     88  ABEND-4001-WRITE-ERROR                  VALUE +4001.     04060002
040700     88  ABEND-4002-READ-ERROR                   VALUE +4002.     04070002
040800     88  ABEND-4003-CTRL-CARD-ERROR              VALUE +4003.     04080002
040900     88  ABEND-4004-TABLE-ERROR                  VALUE +4004.     04090002
041000     88  ABEND-4005-OPEN-ERROR                   VALUE +4005.     04100002
041100     88  ABEND-4006-CLOSE-ERROR                  VALUE +4006.     04110002
041200     88  ABEND-4007-SEQUENCE-ERROR               VALUE +4007.     04120002
041300     88  ABEND-4008-DATA-ERROR                   VALUE +4008.     04130002
041400     88  ABEND-4009-KEY-DATA-ERROR               VALUE +4009.     04140002
041500     88  ABEND-4013-SQL-ERROR                    VALUE +4013.     04150002
041600     88  ABEND-4014-ORACLE-LOGON-ERROR           VALUE +4014.     04160002
041700     88  ABEND-4019-DATE-ROUTINE-ERROR           VALUE +4019.     04170002
041800     88  ABEND-4444-FORCED-ABEND                 VALUE +4444.     04180002
041900                                                                  04190002
042000*----------------------------------------------------------       04200002
042100* CC- CONTROL CARDS                                               04210002
042200*----------------------------------------------------------       04220002
042300 01  CC-CONTROL-CARD-REC.                                         04230002
042400     05  CC-RUN-DTE                     PIC X(08) VALUE SPACES.   04240002
042500     05  FILLER                         PIC X(72) VALUE SPACES.   04250002
042600                                                                  04260002
042700 01  CC-PROMO-BEGIN-REC.                                          04270002
042800     05  CC-PROMO-INDEX                 PIC X(02) VALUE SPACES.   04280002
042900     05  FILLER                         PIC X(01) VALUE SPACES.   04290002
043000     05  CC-CALENDAR-DAYS               PIC X(02) VALUE SPACES.   04300002
043100     05  FILLER                         PIC X(01) VALUE SPACES.   04310002
043200     05  CC-MAX-DAYS                    PIC X(02) VALUE SPACES.   04320002
043300     05  FILLER                         PIC X(01) VALUE SPACES.   04330002
043400     05  CC-MIN-DAYS                    PIC X(02) VALUE SPACES.   04340002
043500     05  FILLER                         PIC X(70) VALUE SPACES.   04350002
043600                                                                  04360002
043700 01  CC-PROMO-ABBRV-REC.                                          04370002
043800     05  CC-PROMO-ABBRV                 PIC X(05) VALUE SPACES.   04380002
043900     05  FILLER                         PIC X(75) VALUE SPACES.   04390002
044000*----------------------------------------------------------       04400002
044100* PS- PROGRAM SWITCHES                                            04410002
044200*----------------------------------------------------------       04420002
044300 01  PS-PROGRAM-SWITCHES.                                         04430002
044400     05  PS-END-OF-PROMO-BEGIN-CC-SW  PIC X(01)  VALUE 'N'.       04440002
044500         88  PS-END-OF-PROMO-BEGIN-CC            VALUE 'Y'.       04450002
044600         88  PS-NOT-END-OF-PROMO-BEGIN-CC        VALUE 'N'.       04460002
044700     05  PS-END-OF-PROMO-ABBRV-CC-SW  PIC X(01)  VALUE 'N'.       04470002
044800         88  PS-END-OF-PROMO-ABBRV-CC            VALUE 'Y'.       04480002
044900         88  PS-NOT-END-OF-PROMO-ABBRV-CC        VALUE 'N'.       04490002
045000     05  PS-END-OF-ADEVNT-CSR-SW      PIC X(01)  VALUE 'N'.       04500002
045100         88  PS-END-OF-ADEVNT-CSR                VALUE 'Y'.       04510002
045200         88  PS-NOT-END-OF-ADEVNT-CSR            VALUE 'N'.       04520002
045300     05  PS-END-OF-OVERLAP-CSR-SW     PIC X(01)  VALUE 'N'.       04530002
045400         88  PS-END-OF-OVERLAP-CSR               VALUE 'Y'.       04540002
045500         88  PS-NOT-END-OF-OVERLAP-CSR           VALUE 'N'.       04550002
045600                                                                  04560002
045700     05  PS-END-OF-FULLDAY-CSR-SW     PIC X(01)  VALUE 'N'.       04570002
045800         88  PS-END-OF-FULLDAY-CSR               VALUE 'Y'.       04580002
045900         88  PS-NOT-END-OF-FULLDAY-CSR           VALUE 'N'.       04590002
046000                                                                  04600002
046100     05  PS-OVERLAP-PROMO-SW          PIC X(01) VALUE 'N'.        04610002
046200         88  PS-NO-OVERLAP-PROMO                VALUE 'N'.        04620002
046300         88  PS-OVERLAP-PROMO                   VALUE 'Y'.        04630002
046400                                                                  04640002
046500     05  PS-BOGO-SW                   PIC X(01) VALUE 'N'.        04650002
046600         88  PS-NOT-BOGO                        VALUE 'N'.        04660002
046700         88  PS-BOGO                            VALUE 'Y'.        04670002
046800                                                                  04680002
046900     05  PS-EOS-FOUND-SW              PIC X(01) VALUE 'N'.        04690002
047000         88  PS-EOS-NOT-FOUND                   VALUE 'N'.        04700002
047100         88  PS-EOS-FOUND                       VALUE 'Y'.        04710002
047200                                                                  04720002
047300     05  PS-PARTIAL-DAY-SW            PIC X(01) VALUE 'N'.        04730002
047400         88  PS-NOT-PARTIAL-DAY                 VALUE 'N'.        04740027
047500         88  PS-PARTIAL-DAY                     VALUE 'Y'.        04750002
047600                                                                  04760002
047700     05  PS-FULL-DAY-SW               PIC X(01) VALUE 'N'.        04770002
047800         88  PS-NO-FULL-DAY                     VALUE 'N'.        04780002
047900         88  PS-FULL-DAY-FOUND                  VALUE 'Y'.        04790002
048000                                                                  04800002
048100     05  PS-EOS-FILE-SW               PIC X(01) VALUE 'N'.        04810002
048200         88  PS-EOS-NOT-EOF                     VALUE 'N'.        04820002
048300         88  PS-EOS-EOF                         VALUE 'Y'.        04830002
048400                                                                  04840002
070941     05  PS-END-OF-LOGON-FILE-SW      PIC X(1)  VALUE 'N'.        04841057
070941         88  PS-END-OF-LOGON-FILE               VALUE 'Y'.        04842057
070941     05  PS-ORA-SRC-CTL-DONE-SW       PIC X(1)  VALUE 'N'.        04843057
070941         88  PS-ORA-SRC-EMPTY                   VALUE 'Y'.        04844057
070941                                                                  04845054
070941 01  CC-ORACLE-CONNECTION.                                        04846054
070941     05  CC-ORACLE-USERID             PIC X(40).                  04847054
070941         88 CC-AUTO-LOGON                       VALUE '/'.        04848057
070941     05  CC-ORACLE-PASSWORD           PIC X(40).                  04849054
070941                                                                  04849156
048500*----------------------------------------------------------       04850002
048600* PC- PROGRAM CONSTANTS                                           04860002
048700*----------------------------------------------------------       04870002
048800 01  PC-PROGRAM-CONSTANTS.                                        04880002
048900     05  PC-CURRENT-PROGRAM-NAME      PIC  X(08)  VALUE           04890055
049000                                                     'PMKUT114'.  04900002
049100     05  PC-01                        PIC  X(02)  VALUE '01'.     04910002
049200     05  PC-02                        PIC  X(02)  VALUE '02'.     04920002
049300     05  PC-03                        PIC  X(02)  VALUE '03'.     04930002
049400     05  PC-04                        PIC  X(02)  VALUE '04'.     04940002
C09985     05  PC-05                        PIC  X(02)  VALUE '05'.     04941039
049500                                                                  04950002
049600*----------------------------------------------------------       04960002
049700* PV- PROGRAM VARIABLES                                           04970002
049800*----------------------------------------------------------       04980002
049900 01  PV-PROGRAM-VARIABLES.                                        04990002
070941     05  PV-ORACLE-USERID-LEN         PIC S9(4) VALUE ZEROS       04991057
070941                                                COMP SYNC.        04992057
070941     05  PV-ORACLE-PASSWORD-LEN       PIC S9(4) VALUE ZEROS       04993057
070941                                                COMP SYNC.        04994057
050000     05  PV-TABLE-NAME                PIC X(30)  VALUE SPACES.    05000002
050100     05  PV-SQL-CODE                  PIC 9(09)  VALUE 0.         05010002
050200     05  PV-OPERATION-MSG             PIC X(60)  VALUE SPACES.    05020002
050300     05  PV-OPERATION-MSG-1           PIC X(40)  VALUE SPACES.    05030002
050400     05  PV-PARAGRAPH-NAME            PIC X(30)  VALUE SPACES.    05040002
050500     05  PV-SAVE-AD-EVNT-ID           PIC S9(10) VALUE +0         05050002
050600                                      COMP-3.                     05060002
050700     05  PV-SYS-DATE                  PIC X(21)  VALUE SPACES.    05070002
050800                                                                  05080002
050900     05  PV-SAVE-INIT-STRT-TMST.                                  05090002
051000         10  PV-SAVE-INIT-STRT-DTE.                               05100002
051100             15  PV-SAVE-INIT-STRT-CCYY  PIC X(04)  VALUE SPACES. 05110002
051200             15  FILLER                  PIC X(01)  VALUE SPACES. 05120002
051300             15  PV-SAVE-INIT-STRT-MM    PIC X(02)  VALUE SPACES. 05130002
051400             15  FILLER                  PIC X(01)  VALUE SPACES. 05140002
051500             15  PV-SAVE-INIT-STRT-DD    PIC X(02)  VALUE SPACES. 05150002
051600         10  PV-SAVE-INIT-STRT-TM        PIC X(09)  VALUE SPACES. 05160002
051700     05  PV-SAVE-INIT-END-TMST.                                   05170002
051800         10  PV-SAVE-INIT-END-DTE.                                05180002
051900             15  PV-SAVE-INIT-END-CCYY   PIC X(04)  VALUE SPACES. 05190002
052000             15  FILLER                  PIC X(01)  VALUE SPACES. 05200002
052100             15  PV-SAVE-INIT-END-MM     PIC X(02)  VALUE SPACES. 05210002
052200             15  FILLER                  PIC X(01)  VALUE SPACES. 05220002
052300             15  PV-SAVE-INIT-END-DD     PIC X(02)  VALUE SPACES. 05230002
052400         10  PV-SAVE-INIT-END-TM         PIC X(09)  VALUE SPACES. 05240002
052500                                                                  05250002
052600     05  PV-SAVE-PRE-STRT-TMST.                                   05260002
052700         10  PV-SAVE-PRE-STRT-DTE.                                05270002
052800             15  PV-SAVE-PRE-STRT-CCYY    PIC X(04)  VALUE SPACES.05280002
052900             15  FILLER                   PIC X(01)  VALUE SPACES.05290002
053000             15  PV-SAVE-PRE-STRT-MM      PIC X(02)  VALUE SPACES.05300002
053100             15  FILLER                   PIC X(01)  VALUE SPACES.05310002
053200             15  PV-SAVE-PRE-STRT-DD      PIC X(02)  VALUE SPACES.05320002
053300         10  PV-SAVE-PRE-STRT-TM          PIC X(09)  VALUE SPACES.05330002
053400     05  PV-SAVE-PRE-END-TMST.                                    05340002
053500         10  PV-SAVE-PRE-END-DTE.                                 05350002
053600             15  PV-SAVE-PRE-END-CCYY     PIC X(04)  VALUE SPACES.05360002
053700             15  FILLER                   PIC X(01)  VALUE SPACES.05370002
053800             15  PV-SAVE-PRE-END-MM       PIC X(02)  VALUE SPACES.05380002
053900             15  FILLER                   PIC X(01)  VALUE SPACES.05390002
054000             15  PV-SAVE-PRE-END-DD       PIC X(02)  VALUE SPACES.05400002
054100         10  PV-SAVE-PRE-END-TM           PIC X(09)  VALUE SPACES.05410002
054200                                                                  05420002
054300     05  PV-SAVE-POST-STRT-TMST.                                  05430002
054400         10  PV-SAVE-POST-STRT-DTE.                               05440002
054500             15  PV-SAVE-POST-STRT-CCYY  PIC X(04)  VALUE SPACES. 05450002
054600             15  FILLER                  PIC X(01)  VALUE SPACES. 05460002
054700             15  PV-SAVE-POST-STRT-MM    PIC X(02)  VALUE SPACES. 05470002
054800             15  FILLER                  PIC X(01)  VALUE SPACES. 05480002
054900             15  PV-SAVE-POST-STRT-DD    PIC X(02)  VALUE SPACES. 05490002
055000         10  PV-SAVE-POST-STRT-TM        PIC X(09)  VALUE SPACES. 05500002
055100     05  PV-SAVE-POST-END-TMST.                                   05510002
055200         10  PV-SAVE-POST-END-DTE.                                05520002
055300             15  PV-SAVE-POST-END-CCYY   PIC X(04)  VALUE SPACES. 05530002
055400             15  FILLER                  PIC X(01)  VALUE SPACES. 05540002
055500             15  PV-SAVE-POST-END-MM     PIC X(02)  VALUE SPACES. 05550002
055600             15  FILLER                  PIC X(01)  VALUE SPACES. 05560002
055700             15  PV-SAVE-POST-END-DD     PIC X(02)  VALUE SPACES. 05570002
055800         10  PV-SAVE-POST-END-TM         PIC X(09)  VALUE SPACES. 05580002
055900     05  PV-HOLD-INIT-STRT-DTE.                                   05590002
056000         10  PV-HOLD-INIT-STRT-CCYY   PIC X(04)  VALUE SPACES.    05600002
056100         10  PV-HOLD-INIT-STRT-MM     PIC X(02)  VALUE SPACES.    05610002
056200         10  PV-HOLD-INIT-STRT-DD     PIC X(02)  VALUE SPACES.    05620002
056300     05  PV-HOLD-INIT-END-DTE.                                    05630002
056400         10  PV-HOLD-INIT-END-CCYY    PIC X(04)  VALUE SPACES.    05640002
056500         10  PV-HOLD-INIT-END-MM      PIC X(02)  VALUE SPACES.    05650002
056600         10  PV-HOLD-INIT-END-DD      PIC X(02)  VALUE SPACES.    05660002
056700                                                                  05670002
056800     05  PV-HOLD-EOS-STRT-DTE.                                    05680002
056900         10  PV-HOLD-EOS-STRT-CCYY    PIC X(04)  VALUE SPACES.    05690002
057000         10  PV-HOLD-EOS-STRT-MM      PIC X(02)  VALUE SPACES.    05700002
057100         10  PV-HOLD-EOS-STRT-DD      PIC X(02)  VALUE SPACES.    05710002
057200     05  PV-HOLD-EOS-END-DTE.                                     05720002
057300         10  PV-HOLD-EOS-END-CCYY     PIC X(04)  VALUE SPACES.    05730002
057400         10  PV-HOLD-EOS-END-MM       PIC X(02)  VALUE SPACES.    05740002
057500         10  PV-HOLD-EOS-END-DD       PIC X(02)  VALUE SPACES.    05750002
057600                                                                  05760002
057700     05  PV-HOLD-PRE-STRT-DTE.                                    05770002
057800         10  PV-HOLD-PRE-STRT-CCYY    PIC X(04)  VALUE SPACES.    05780002
057900         10  PV-HOLD-PRE-STRT-MM      PIC X(02)  VALUE SPACES.    05790002
058000         10  PV-HOLD-PRE-STRT-DD      PIC X(02)  VALUE SPACES.    05800002
058100     05  PV-HOLD-PRE-END-DTE.                                     05810002
058200         10  PV-HOLD-PRE-END-CCYY     PIC X(04)  VALUE SPACES.    05820002
058300         10  PV-HOLD-PRE-END-MM       PIC X(02)  VALUE SPACES.    05830002
058400         10  PV-HOLD-PRE-END-DD       PIC X(02)  VALUE SPACES.    05840002
058500                                                                  05850002
058600     05  PV-HOLD-POST-STRT-DTE.                                   05860002
058700         10  PV-HOLD-POST-STRT-CCYY   PIC X(04)  VALUE SPACES.    05870002
058800         10  PV-HOLD-POST-STRT-MM     PIC X(02)  VALUE SPACES.    05880002
058900         10  PV-HOLD-POST-STRT-DD     PIC X(02)  VALUE SPACES.    05890002
059000     05  PV-HOLD-POST-END-DTE.                                    05900002
059100         10  PV-HOLD-POST-END-CCYY    PIC X(04)  VALUE SPACES.    05910002
059200         10  PV-HOLD-POST-END-MM      PIC X(02)  VALUE SPACES.    05920002
059300         10  PV-HOLD-POST-END-DD      PIC X(02)  VALUE SPACES.    05930002
059400                                                                  05940002
059500     05  PV-DAY-INDEX                 PIC S9(04)  COMP SYNC       05950002
059600                                                  VALUE +0.       05960002
059700     05  PV-NBR-OF-DAYS1              PIC S9(04)  COMP.           05970002
059800     05  PV-NBR-OF-DAYS2              PIC S9(04)  COMP.           05980002
059900     05  PV-NBR-OF-DAYS3              PIC S9(04)  COMP.           05990002
060000     05  PV-NBR-OF-DAYS4              PIC S9(04)  COMP.           06000002
060100     05  PV-NBR-OF-DAYS5              PIC S9(04)  COMP.           06010002
060200     05  PV-NBR-OF-DAYS6              PIC S9(04)  COMP.           06020002
060300     05  PV-NBR-OF-DAYS7              PIC S9(04)  COMP.           06030002
060400     05  PV-NBR-OF-DAYS8              PIC S9(04)  COMP.           06040002
060500     05  PV-NBR-OF-DAYS9              PIC S9(04)  COMP.           06050002
060600     05  PV-NBR-OF-DAYS10             PIC S9(04)  COMP.           06060002
PK7624     05  PV-NBR-OF-DAYS11             PIC S9(04)  COMP.           06061033
C09985     05  PV-NBR-OF-DAYS12             PIC S9(04)  COMP.           06062036
C09985     05  PV-NBR-OF-DAYS13             PIC S9(04)  COMP.           06063036
C09985     05  PV-NBR-OF-DAYS14             PIC S9(04)  COMP.           06064036
C09985     05  PV-NBR-OF-DAYS15             PIC S9(04)  COMP.           06065036
060700     05  PV-MIN-DAYS                  PIC S9(04)  COMP.           06070002
060800     05  PV-MAX-DAYS                  PIC S9(04)  COMP.           06080002
060900                                                                  06090002
061000 01  PV-SELECT-VARIABLES.                                         06100002
061100     05  PV-AD-EVNT-ID                PIC S9(10) VALUE +0         06110002
061200                                      COMP-3.                     06120002
061300     05  PV-PROMO-ID                  PIC S9(10) VALUE +0         06130002
061400                                      COMP-3.                     06140002
061500     05  PV-OVERLAP-PROMO-ID          PIC S9(10) VALUE +0         06150002
061600                                      COMP-3.                     06160002
061700     05  PV-PROMO-ABBR-NM             PIC X(05)  VALUE SPACES.    06170002
061800     05  PV-REG-PROMO-TYP-CDE         PIC X(02)  VALUE SPACES.    06180002
061900     05  PV-ADV-PROMO-TYP-CDE         PIC X(02)  VALUE SPACES.    06190002
062000     05  PV-PROMO-STRT-TMST           PIC X(19)  VALUE SPACES.    06200002
062100     05  PV-PROMO-STRT-TMST-SAVED-1   PIC X(19)  VALUE SPACES.    06210002
062200     05  PV-PROMO-STRT-TMST-SAVED-2   PIC X(19)  VALUE SPACES.    06220002
062300     05  PV-PROMO-STRT-TMST-SAVED-3   PIC X(19)  VALUE SPACES.    06230002
062400     05  PV-PROMO-STRT-TMST-SAVED-4   PIC X(19)  VALUE SPACES.    06240002
062500     05  PV-PROMO-END-TMST            PIC X(19)  VALUE SPACES.    06250002
062600     05  PV-PROMO-END-TMST-SAVED-1    PIC X(19)  VALUE SPACES.    06260002
062700     05  PV-PROMO-END-TMST-SAVED-2    PIC X(19)  VALUE SPACES.    06270002
062800     05  PV-PROMO-END-TMST-SAVED-3    PIC X(19)  VALUE SPACES.    06280002
062900     05  PV-PROMO-END-TMST-SAVED-4    PIC X(19)  VALUE SPACES.    06290002
063000     05  PV-POST-INITIAL-DTE          PIC X(19)  VALUE SPACES.    06300002
063100     05  PV-PRE-CORR-DTE              PIC X(19)  VALUE SPACES.    06310002
063200     05  PV-POST-CORR-DTE             PIC X(19)  VALUE SPACES.    06320002
063300     05  PV-POST-CORR-DTE-2           PIC X(19)  VALUE SPACES.    06330002
C09985     05  PV-POST-CORR-DTE-3           PIC X(19)  VALUE SPACES.    06331036
063400     05  PV-NULL-IND.                                             06340002
063500         10  PV-ADV-PROMO-TYP-NULL    PIC S9(4) COMP VALUE +0.    06350002
063600                                                                  06360002
063700     05 PV-DUAL-ONE                 PIC S9(02) COMP-3 VALUE 0.    06370002
063800     05  PV-EOS-STRT-TMST.                                        06380002
063900         10  PV-EOS-STRT-DTE.                                     06390002
064000             15  PV-EOS-STRT-CCYY         PIC X(04)  VALUE SPACES.06400002
064100             15  FILLER                   PIC X(01)  VALUE SPACES.06410002
064200             15  PV-EOS-STRT-MM           PIC X(02)  VALUE SPACES.06420002
064300             15  FILLER                   PIC X(01)  VALUE SPACES.06430002
064400             15  PV-EOS-STRT-DD           PIC X(02)  VALUE SPACES.06440002
064500         10  PV-EOS-STRT-TM               PIC X(09)  VALUE SPACES.06450002
064600     05  PV-EOS-END-TMST.                                         06460002
064700         10  PV-EOS-END-DTE.                                      06470002
064800             15  PV-EOS-END-CCYY          PIC X(04)  VALUE SPACES.06480002
064900             15  FILLER                   PIC X(01)  VALUE SPACES.06490002
065000             15  PV-EOS-END-MM            PIC X(02)  VALUE SPACES.06500002
065100             15  FILLER                   PIC X(01)  VALUE SPACES.06510002
065200             15  PV-EOS-END-DD            PIC X(02)  VALUE SPACES.06520002
065300         10  PV-EOS-END-TM                PIC X(09)  VALUE SPACES.06530002
065400                                                                  06540002
065500                                                                  06550002
065600 01  PV-PROMO-ABBRV-TBL.                                          06560002
065700     05  PV-PROMO-ABBRV-TABLE OCCURS 10                           06570002
065800                              INDEXED BY PV-ABBRV-INDX.           06580002
065900         10  PV-PROMO-ABBRV        PIC  X(05).                    06590002
066000                                                                  06600002
066100*----------------------------------------------------------       06610002
066200* PA- PROGRAM ACCUMULATORS                                        06620002
066300*----------------------------------------------------------       06630002
066400 01  PA-PROGRAM-ACCUMULATORS.                                     06640002
066500     05  PA-PROMO-CNT                 PIC 9(09) VALUE ZEROES.     06650002
066600     05  PA-ADEVNT-CNT                PIC 9(09) VALUE ZEROES.     06660002
066700                                                                  06670002
066800*------------------------------------------------------------     06680002
066900*  OUTPUT RECORDS FOR THE 3 DATE FILES                            06690002
067000*------------------------------------------------------------     06700002
067100 01  DATE-REC-1.                                                  06710002
067200     05  DT-STRT-DTE-1                  PIC X(08) VALUE SPACES.   06720002
067300     05  FILLER                         PIC X(01) VALUE SPACES.   06730002
067400     05  DT-END-DTE-1                   PIC X(08) VALUE SPACES.   06740002
067500     05  FILLER                         PIC X(01) VALUE SPACES.   06750002
067600     05  DT-RUN-DTE-1                   PIC X(08) VALUE SPACES.   06760002
067700     05  FILLER                         PIC X(54) VALUE SPACES.   06770002
067800                                                                  06780002
067900 01  DATE-REC-2.                                                  06790002
068000     05  DT-STRT-DTE-2                  PIC X(08) VALUE SPACES.   06800002
068100     05  FILLER                         PIC X(01) VALUE SPACES.   06810002
068200     05  DT-END-DTE-2                   PIC X(08) VALUE SPACES.   06820002
068300     05  FILLER                         PIC X(01) VALUE SPACES.   06830002
068400     05  DT-RUN-DTE-2                   PIC X(08) VALUE SPACES.   06840002
068500     05  FILLER                         PIC X(54) VALUE SPACES.   06850002
068600                                                                  06860002
068700 01  DATE-REC-3.                                                  06870002
068800     05  DT-STRT-DTE-3                  PIC X(08) VALUE SPACES.   06880002
068900     05  FILLER                         PIC X(01) VALUE SPACES.   06890002
069000     05  DT-END-DTE-3                   PIC X(08) VALUE SPACES.   06900002
069100     05  FILLER                         PIC X(01) VALUE SPACES.   06910002
069200     05  DT-RUN-DTE-3                   PIC X(08) VALUE SPACES.   06920002
069300     05  FILLER                         PIC X(54) VALUE SPACES.   06930002
069400                                                                  06940002
069500 01  EOS-DATE-REC-1.                                              06950002
069600     05  EOS-STRT-DTE-1                 PIC X(08) VALUE SPACES.   06960002
069700     05  FILLER                         PIC X(01) VALUE SPACES.   06970002
069800     05  EOS-END-DTE-1                  PIC X(08) VALUE SPACES.   06980002
069900     05  FILLER                         PIC X(01) VALUE SPACES.   06990002
070000     05  EOS-RUN-DTE-1                  PIC X(08) VALUE SPACES.   07000002
070100     05  FILLER                         PIC X(54) VALUE SPACES.   07010002
070200                                                                  07020002
070300 01  EOS-DATE-REC-2.                                              07030002
070400     05  EOS-STRT-DTE-2                 PIC X(08) VALUE SPACES.   07040002
070500     05  FILLER                         PIC X(01) VALUE SPACES.   07050002
070600     05  EOS-END-DTE-2                  PIC X(08) VALUE SPACES.   07060002
070700     05  FILLER                         PIC X(01) VALUE SPACES.   07070002
070800     05  EOS-RUN-DTE-2                  PIC X(08) VALUE SPACES.   07080002
070900     05  FILLER                         PIC X(54) VALUE SPACES.   07090002
071000                                                                  07100002
071100 01  EOS-DATE-REC-3.                                              07110002
071200     05  EOS-STRT-DTE-3                 PIC X(08) VALUE SPACES.   07120002
071300     05  FILLER                         PIC X(01) VALUE SPACES.   07130002
071400     05  EOS-END-DTE-3                  PIC X(08) VALUE SPACES.   07140002
071500     05  FILLER                         PIC X(01) VALUE SPACES.   07150002
071600     05  EOS-RUN-DTE-3                  PIC X(08) VALUE SPACES.   07160002
071700     05  FILLER                         PIC X(54) VALUE SPACES.   07170002
071800                                                                  07180002
071900 01  EOS-DATE-REC-4.                                              07190002
072000     05  EOS-STRT-DTE-4                 PIC X(08) VALUE SPACES.   07200002
072100     05  FILLER                         PIC X(01) VALUE SPACES.   07210002
072200     05  EOS-END-DTE-4                  PIC X(08) VALUE SPACES.   07220002
072300     05  FILLER                         PIC X(01) VALUE SPACES.   07230002
072400     05  EOS-RUN-DTE-4                  PIC X(08) VALUE SPACES.   07240002
072500     05  FILLER                         PIC X(54) VALUE SPACES.   07250002
072600                                                                  07260002
072700*----------------------------------------------------------       07270002
072800* COPYBOOK FOR THE PROMOTION/REPORT OUTPUT FILES                  07280002
072900*----------------------------------------------------------       07290002
073000     COPY PMRD114.                                                07300002
073100                                                                  07310002
073200*----------------------------------------------------------       07320002
073300* COPYBOOK FOR THE BOGO REPORT OUTPUT FILE                        07330002
073400*----------------------------------------------------------       07340002
073500     COPY PMRD115.                                                07350002
073600                                                                  07360002
073700*----------------------------------------------------------       07370002
073800* COPYBOOK FOR THE PARTIAL/FULL DAY REPORT                        07380002
073900*----------------------------------------------------------       07390002
074000     COPY PMRD121.                                                07400002
074100                                                                  07410002
074200*----------------------------------------------------------       07420002
074300*                      O  R  A  C  L  E                           07430002
074400*==========================================================       07440002
074500*                                                                 07450002
074600* ORACLE DECLARE SECTION                                          07460002
074700* ORACLE USED AND RETURNED VARIABLES                              07470002
074800*                                                                 07480002
074900*----------------------------------------------------------       07490002
075000     EXEC SQL BEGIN DECLARE SECTION END-EXEC.                     07500002
075100                                                                  07510002
075200*----------------------------------------------------------       07520002
075300* ORACLE LOGON WORKING STORAGE COPYBOOK                           07530002
075400*----------------------------------------------------------       07540002
075500                                                                  07550002
075600 01  PC-ENT01-TYPE-CDE                PIC X(02)  VALUE '01'.      07560002
075700 01  PV-ORACLE-ID                     PIC X(1)   VALUE '/'.       07570002
075800                                                                  07580002
075900 01  USERNAME                         PIC X(10)  VARYING.         07590002
076000 01  PASSWD                           PIC X(10)  VARYING.         07600002
076100                                                                  07610002
076200 01  ORACLE-RETURN                    PIC X(200) VALUE SPACES.    07620002
076300                                                                  07630002
076400     EXEC SQL END DECLARE SECTION END-EXEC.                       07640002
076500     EXEC SQL INCLUDE SQLCACOB    END-EXEC.                       07650002
076600                                                                  07660002
076700 EJECT                                                            07670002
076800                                                                  07680002
076900*----------------------------------------------------------       07690002
077000 PROCEDURE DIVISION.                                              07700002
077100*----------------------------------------------------------       07710002
077200 0000-MAINLINE.                                                   07720002
077300                                                                  07730002
077400     PERFORM 1000-INITIALIZATION.                                 07740002
077500                                                                  07750002
077600     PERFORM 2000-PROCESS-ADEVNT-CSR                              07760002
077700             UNTIL PS-END-OF-ADEVNT-CSR.                          07770002
077800                                                                  07780002
077900     PERFORM 2030-CLOSE-ADEVENT-CSR.                              07790002
078000                                                                  07800002
078100     PERFORM 9999-WRAPUP.                                         07810002
078200                                                                  07820002
078300     GOBACK.                                                      07830002
078400                                                                  07840002
078500*0000-EXIT.                                                       07850002
078600 EJECT.                                                           07860002
078700                                                                  07870002
078800*----------------------------------------------------------       07880002
078900* 1000-INITIALIZATION.                                            07890002
079000*     INITIALIZATION AREA - INITIALIZES ALL VARIABLES, OPENS      07900002
079100*     FILES, READS CONTROL CARD, AND PROCESSES ANY CONTROL        07910002
079200*     CARD PARAMETERS IT MAY NEED TO USE TO FETCH PROMO ITEMS     07920002
079300*     ITEMS FROM THE CURSOR.                                      07930002
079400*----------------------------------------------------------       07940002
079500 1000-INITIALIZATION.                                             07950002
079600                                                                  07960002
079700     INITIALIZE PM114-PROMO-RPT-FILE                              07970002
079800                PM115-PROMO-RPT-FILE                              07980002
079900                PM121-PROMO                                       07990002
080000                PV-SELECT-VARIABLES.                              08000002
080100                                                                  08010002
080200     OPEN INPUT  CONTROL-CARD-FILE                                08020002
080300                 PROMO-BEGIN-FILE                                 08030002
080400                 EOS-TYPE-FILE                                    08040002
080500          OUTPUT EXCPT-ADEVNT-FILE-1                              08050002
080600                 EXCPT-ADEVNT-FILE-2                              08060002
080700                 EXCPT-ADEVNT-FILE-3                              08070002
080800                 EXCPT-ADEVNT-FILE-4                              08080002
080900                 EXCPT-ADEVNT-FILE-5                              08090002
081000                 EXCPT-PROMO-INITIAL-FILE                         08100002
081100                 EXCPT-PROMO-PRECORR-FILE                         08110002
081200                 EXCPT-PROMO-POSTCORR-FILE                        08120002
081300                 EXCPT-BOGOC-INITIAL-FILE                         08130002
081400                 EXCPT-BOGOC-PRECORR-FILE                         08140002
081500                 EXCPT-BOGOC-POSTCORR-FILE                        08150002
081600                 EXCPT-BOGOC-INITIAL-DT-FILE                      08160002
081700                 EXCPT-BOGOC-PRECORR-DT-FILE                      08170002
081800                 EXCPT-BOGOC-POSTCORR-DT-FILE                     08180002
081900                 EXCPT-BOGOO-INITIAL-FILE                         08190002
082000                 EXCPT-BOGOO-PRECORR-FILE                         08200002
082100                 EXCPT-BOGOO-POSTCORR-FILE                        08210002
082200                 EXCPT-BOGOO-POSTCORR-FILE-2                      08220002
082300                 EXCPT-EOS-INITIAL-FILE                           08230002
082400                 EXCPT-EOS-PRECORR-FILE                           08240002
082500                 EXCPT-EOS-POSTCORR-FILE                          08250002
082600                 EXCPT-EOS-POSTCORR-FILE-2                        08260002
082700                 EXCPT-EOS-INITIAL-DTE-FILE                       08270002
082800                 EXCPT-EOS-PRECORR-DTE-FILE                       08280002
082900                 EXCPT-EOS-POSTCORR-DTE-FILE                      08290002
083000                 EXCPT-EOS-POSTCORR-DTE-FILE-2                    08300002
083100                 EXCPT-PAR-INITIAL-FILE                           08310002
083200                 EXCPT-PAR-PRECORR-FILE                           08320002
W37986                 EXCPT-PAR-POSTCORR-FILE                          08321032
C09985*                KIOSK-POST-CORR2-FILE.                           08322044
C09985                 KIOSK-POST-CORR2-FILE                            08322146
C09985                 EXCPT-PROMO-POSTCORR-FILE-2                      08323044
C09985                 EXCPT-PROMO-POSTCORR-FILE-3                      08324044
C09985                 EXCPT-BOGOO-POSTCORR-FILE-3.                     08325044
083400                                                                  08340002
083500     PERFORM 1100-READ-CONTROL-FILE.                              08350002
083600     PERFORM 1200-READ-PROMO-BEGIN-FILE                           08360002
083700       VARYING PV-DAY-INDEX                                       08370002
083800        FROM 1 BY 1                                               08380002
083900*         UNTIL PV-DAY-INDEX > 10                                 08390033
C09985*         UNTIL PV-DAY-INDEX > 11                                 08391044
C09985          UNTIL PV-DAY-INDEX > 15                                 08392044
084000             OR PS-END-OF-PROMO-BEGIN-CC                          08400002
084100     MOVE CC-MIN-DAYS TO PV-MIN-DAYS.                             08410002
084200     MOVE CC-MAX-DAYS TO PV-MAX-DAYS.                             08420002
084300                                                                  08430002
084400     PERFORM 1250-READ-PROMO-ABBR-FILE                            08440002
084500       VARYING PV-ABBRV-INDX                                      08450002
084600       FROM 1 BY 1                                                08460002
084700         UNTIL PS-EOS-EOF                                         08470002
084800                                                                  08480002
070941     PERFORM B110-ORACLE-SETUP.                                   08490054
070941                                                                  08491054
085000     PERFORM 1300-DECLARE-AD-EVENT-CSR.                           08500002
085100     PERFORM 1400-DECLARE-PM-OVERLAP-CSR.                         08510002
085200     PERFORM 1500-DECLARE-FULL-DAY-PM-CSR.                        08520002
085300     PERFORM 2010-OPEN-ADEVENT-CSR.                               08530002
085400     PERFORM 2020-FETCH-ADEVENT-CSR.                              08540002
085500                                                                  08550002
085600     IF PS-END-OF-ADEVNT-CSR                                      08560002
085700        DISPLAY 'NO AD EVENTS ASSOCIATED WITH THESE DATES'        08570002
085800     ELSE                                                         08580032
085900        PERFORM 3000-TRUNC-TABLE                                  08590048
086000     END-IF.                                                      08600002
086100                                                                  08610002
086200*1000-EXIT.                                                       08620002
086300 EJECT.                                                           08630002
070941 B110-ORACLE-SETUP.                                               08631053
070941                                                                  08632053
070941     OPEN INPUT ORACLE-LOGON-FILE.                                08633053
070941                                                                  08634053
070941     PERFORM B120-READ-ORACLE-LOGON.                              08635053
070941                                                                  08636053
070941     CLOSE ORACLE-LOGON-FILE.                                     08637053
070941                                                                  08638053
070941     IF ((PS-END-OF-LOGON-FILE)                                   08639053
070941             OR (CC-ORACLE-CONNECTION = SPACES))                  08639153
070941         DISPLAY '** ABEND **'                                    08639253
070941         DISPLAY PC-CURRENT-PROGRAM-NAME                          08639355
070941                 ' - ORACLE LOGON CONTROL CARD '                  08639455
070941                   'NOT PROVIDED'                                 08639555
070941         SET PS-ORA-SRC-EMPTY TO TRUE                             08639655
070941         CALL 'ILBOABN0' USING ABEND-CODE                         08639755
070941     END-IF.                                                      08639855
070941                                                                  08639955
070941     IF CC-AUTO-LOGON                                             08640055
070941         DISPLAY PC-CURRENT-PROGRAM-NAME ' - AUTO LOGON TO ORACLE'08640155
070941         EXEC SQL                                                 08640255
070941              CONNECT :USERNAME                                   08640355
070941         END-EXEC                                                 08640455
070941     ELSE                                                         08640555
070941         INITIALIZE PV-ORACLE-USERID-LEN                          08640655
070941                    PV-ORACLE-PASSWORD-LEN                        08640755
070941         INSPECT CC-ORACLE-USERID                                 08640855
070941             TALLYING PV-ORACLE-USERID-LEN                        08640955
070941          FOR CHARACTERS BEFORE INITIAL SPACE                     08641055
070941      INSPECT CC-ORACLE-PASSWORD                                  08641155
070941          TALLYING PV-ORACLE-PASSWORD-LEN                         08641255
070941          FOR CHARACTERS BEFORE INITIAL SPACE                     08641355
070941      MOVE CC-ORACLE-USERID (1:PV-ORACLE-USERID-LEN) TO           08641455
070941                USERNAME-ARR                                      08641555
070941      MOVE PV-ORACLE-USERID-LEN TO USERNAME-LEN                   08641655
070941      MOVE CC-ORACLE-PASSWORD (1:PV-ORACLE-PASSWORD-LEN) TO       08641755
070941                PASSWD-ARR                                        08641855
070941      MOVE PV-ORACLE-PASSWORD-LEN TO PASSWD-LEN                   08641955
070941      DISPLAY PC-CURRENT-PROGRAM-NAME                             08642055
070941              ' - LOGON TO ORACLE AS USER '                       08642155
070941                USERNAME-ARR                                      08642255
070941      EXEC SQL                                                    08642355
070941        CONNECT :USERNAME IDENTIFIED BY :PASSWD                   08642455
070941      END-EXEC                                                    08642555
070941      INITIALIZE CC-ORACLE-PASSWORD                               08642655
070941                 PASSWD                                           08642755
070941      END-IF.                                                     08642855
070941                                                                  08642955
070941     IF (SQLCODE NOT = 0)                                         08643055
070941         DISPLAY PV-PARAGRAPH-NAME                                08643155
070941         DISPLAY PC-CURRENT-PROGRAM-NAME                          08643255
070941                 ' - ERROR LOGGING ON TO ORACLE'                  08643355
070941         PERFORM Z100-ABEND                                       08643455
070941     END-IF.                                                      08643555
070941                                                                  08643655
070941******************************************************************08643755
070941* NEEDS TO BE IN FOR NOW TIL KURT FIXES CURSOR SHARING BUG        08643855
070941* OTHERWISE GET AN ORACLE ERROR (IE: 3113).                       08643955
070941******************************************************************08644055
070941     EXEC SQL                                                     08644155
070941      ALTER SESSION                                               08644255
070941            SET CURSOR_SHARING = 'EXACT'                          08644355
070941     END-EXEC.                                                    08644455
070941                                                                  08644555
070941                                                                  08644655
070941***************************************************************** 08644755
070941*  B120-READ-ORACLE-LOGON.                                      * 08644855
070941* ==> PROCESSES:                                                * 08644955
070941*   - READ ORCALE CONTROL CARD                                  * 08645055
070941* ==> PERFORMED FROM:  B110-ORACLE-SETUP                        * 08645155
070941***************************************************************** 08645255
070941 B120-READ-ORACLE-LOGON.                                          08645355
070941                                                                  08645455
070941     READ ORACLE-LOGON-FILE                                       08645555
070941         INTO CC-ORACLE-CONNECTION                                08645655
070941         AT END                                                   08645755
070941             SET PS-END-OF-LOGON-FILE TO TRUE                     08645855
070941     END-READ.                                                    08645955
086400                                                                  08646002
086500*---------------------------------------------------------------  08650002
086600* 1100-READ-CONTROL-FILE.                                         08660002
086700*     READS THE CONTROL CARD AND GETS A DATE.                     08670002
086800*---------------------------------------------------------------  08680002
086900 1100-READ-CONTROL-FILE.                                          08690002
087000                                                                  08700002
087100     READ CONTROL-CARD-FILE INTO CC-CONTROL-CARD-REC.             08710002
087200                                                                  08720002
087300     IF CC-RUN-DTE = SPACES                                       08730002
087400        MOVE '1100-READ-CONTROL-FILE' TO PV-PARAGRAPH-NAME        08740002
087500        MOVE 'CONTROL CARD IS EMPTY'     TO PV-OPERATION-MSG-1    08750002
087600        SET ABEND-4003-CTRL-CARD-ERROR   TO TRUE                  08760002
087700        PERFORM 9800-ABEND                                        08770002
087800     ELSE                                                         08780002
087900        DISPLAY '** RUN DATE CONTROL CARD  **'                    08790002
088000        DISPLAY 'CC-RUN-DTE: ' CC-RUN-DTE                         08800002
088100        DISPLAY ' '                                               08810002
088200        MOVE CC-RUN-DTE TO DT-RUN-DTE-1                           08820002
088300                           DT-RUN-DTE-2                           08830002
088400                           DT-RUN-DTE-3                           08840002
088500                           EOS-RUN-DTE-1                          08850002
088600                           EOS-RUN-DTE-2                          08860002
088700                           EOS-RUN-DTE-3                          08870002
088800                           EOS-RUN-DTE-4                          08880002
088900                           PM121-REPORT-RUN-DTE                   08890002
089000     END-IF.                                                      08900002
089100                                                                  08910002
089200*1100-EXIT.                                                       08920002
089300 EJECT.                                                           08930002
089400                                                                  08940002
089500*---------------------------------------------------------------  08950002
089600* 1200-READ-PROMO-BEGIN-FILE.                                     08960002
089700*     READS THE DATE ADJUSTMENT FILE.                             08970002
089800*---------------------------------------------------------------  08980002
089900 1200-READ-PROMO-BEGIN-FILE.                                      08990002
090000                                                                  09000002
090100     READ PROMO-BEGIN-FILE                                        09010002
090200       INTO CC-PROMO-BEGIN-REC                                    09020002
090300        AT END                                                    09030002
090400           SET PS-END-OF-PROMO-BEGIN-CC TO TRUE                   09040002
090500     END-READ.                                                    09050002
090600                                                                  09060002
090700     IF PS-END-OF-PROMO-BEGIN-CC                                  09070002
090800        CONTINUE                                                  09080002
090900     ELSE                                                         09090002
091000        DISPLAY 'PV-DAY-INDEX    : ' PV-DAY-INDEX                 09100002
091100        DISPLAY 'CC-CALENDAR-DAYS: ' CC-CALENDAR-DAYS             09110002
091200        EVALUATE PV-DAY-INDEX                                     09120002
091300           WHEN 1                                                 09130002
091400              MOVE CC-CALENDAR-DAYS    TO PV-NBR-OF-DAYS1         09140002
091500           WHEN 2                                                 09150002
091600              MOVE CC-CALENDAR-DAYS    TO PV-NBR-OF-DAYS2         09160002
091700           WHEN 3                                                 09170002
091800              MOVE CC-CALENDAR-DAYS    TO PV-NBR-OF-DAYS3         09180002
091900           WHEN 4                                                 09190002
092000              MOVE CC-CALENDAR-DAYS    TO PV-NBR-OF-DAYS4         09200002
092100           WHEN 5                                                 09210002
092200              MOVE CC-CALENDAR-DAYS    TO PV-NBR-OF-DAYS5         09220002
092300           WHEN 6                                                 09230002
092400              MOVE CC-CALENDAR-DAYS    TO PV-NBR-OF-DAYS6         09240002
092500           WHEN 7                                                 09250002
092600              MOVE CC-CALENDAR-DAYS    TO PV-NBR-OF-DAYS7         09260002
092700           WHEN 8                                                 09270002
092800              MOVE CC-CALENDAR-DAYS    TO PV-NBR-OF-DAYS8         09280002
092900           WHEN 9                                                 09290002
093000              MOVE CC-CALENDAR-DAYS    TO PV-NBR-OF-DAYS9         09300002
093100           WHEN 10                                                09310002
093200              MOVE CC-CALENDAR-DAYS    TO PV-NBR-OF-DAYS10        09321033
PK7624           WHEN 11                                                09322033
PK7624              MOVE CC-CALENDAR-DAYS    TO PV-NBR-OF-DAYS11        09323033
C09985           WHEN 12                                                09324041
C09985              MOVE CC-CALENDAR-DAYS    TO PV-NBR-OF-DAYS12        09325041
C09985           WHEN 13                                                09326041
C09985              MOVE CC-CALENDAR-DAYS    TO PV-NBR-OF-DAYS13        09327041
C09985           WHEN 14                                                09328041
C09985              MOVE CC-CALENDAR-DAYS    TO PV-NBR-OF-DAYS14        09329041
C09985           WHEN 15                                                09329141
C09985              MOVE CC-CALENDAR-DAYS    TO PV-NBR-OF-DAYS15        09329241
093300        END-EVALUATE                                              09330002
093400     END-IF.                                                      09340002
093500                                                                  09350002
093600*---------------------------------------------------------------  09360002
093700* 1250-READ-PROMO-ABBR-FILE.                                      09370002
093800*     READS THE PROMO ABBREVIATIONS FILE.                         09380002
093900*---------------------------------------------------------------  09390002
094000 1250-READ-PROMO-ABBR-FILE.                                       09400002
094100                                                                  09410002
094200     READ EOS-TYPE-FILE                                           09420002
094300       INTO CC-PROMO-ABBRV-REC                                    09430002
094400        AT END                                                    09440002
094500           SET PS-EOS-EOF  TO TRUE                                09450002
094600     END-READ.                                                    09460002
094700                                                                  09470002
094800     IF PS-EOS-EOF                                                09480002
094900        CONTINUE                                                  09490002
095000     ELSE                                                         09500002
095100        DISPLAY 'ABBR: ' CC-PROMO-ABBRV                           09510002
095200        MOVE CC-PROMO-ABBRV TO PV-PROMO-ABBRV (PV-ABBRV-INDX)     09520002
095300     END-IF.                                                      09530002
095400                                                                  09540002
095500*--------------------------------------------------------------   09550002
095600* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION THAT      09560002
095700* LOGS ON TO ORACLE.                                              09570002
095800*---------------------------------------------------------------  09580002
070941*    COPY PMPD700.                                                09590058
096100                                                                  09610002
096200*---------------------------------------------------------------  09620002
096300* 1300-DECLARE-AD-EVENT-CSR.                                      09630002
096400*     DECLARE THE AD EVENT CURSOR.                                09640002
096500*---------------------------------------------------------------  09650002
096600 1300-DECLARE-AD-EVENT-CSR.                                       09660002
096700                                                                  09670002
096800     EXEC SQL                                                     09680002
096900          DECLARE ADEVENTCSR CURSOR FOR                           09690002
097000            SELECT  A.AD_EVNT_ID                                  09700002
097100                   ,A.PROMO_ID                                    09710002
097200                   ,A.PROMO_ABBR_NM                               09720002
097300                   ,A.REG_PROMO_TYP_CDE                           09730002
097400                   ,A.ADV_PROMO_TYP_CDE                           09740002
097500                   ,A.PROMO_DFLT_STRT_TMST                        09750002
097600                   ,A.PROMO_DFLT_END_TMST                         09760002
097700                   ,TO_CHAR(                                      09770002
097800                   DECODE ((TO_CHAR(B.PLU_LCKDWN_TMST,'D'))       09780002
097900                  ,'1', (B.PLU_LCKDWN_TMST - :PV-NBR-OF-DAYS1)    09790002
098000                  ,'7', (B.PLU_LCKDWN_TMST - :PV-NBR-OF-DAYS2)    09800002
098100                  ,(B.PLU_LCKDWN_TMST - :PV-NBR-OF-DAYS3)),       09810002
098200                      'YYYYMMDD') "POST INITIAL DUE DATE"         09820002
098300                   ,TO_CHAR(                                      09830002
098400                   DECODE ((TO_CHAR(B.PLU_LCKDWN_TMST,'D'))       09840002
098500                  ,'1', (B.PLU_LCKDWN_TMST - :PV-NBR-OF-DAYS4)    09850002
PK7624                  ,'2', (B.PLU_LCKDWN_TMST - :PV-NBR-OF-DAYS5)    09851033
098600*                 ,'7', (B.PLU_LCKDWN_TMST - :PV-NBR-OF-DAYS5)    09860033
PK7624                  ,'7', (B.PLU_LCKDWN_TMST - :PV-NBR-OF-DAYS6)    09861033
098700*                 ,(B.PLU_LCKDWN_TMST - :PV-NBR-OF-DAYS6)),       09870033
PK7624                  ,(B.PLU_LCKDWN_TMST - :PV-NBR-OF-DAYS7)),       09871033
098800                      'YYYYMMDD') "PRE CORRECTIONS DATE"          09880002
098900                  ,TO_CHAR(B.PLU_LCKDWN_TMST,'YYYYMMDD')          09890002
099000                     "POST CORRECTIONS DATE"                      09900002
099100                  ,TO_CHAR(                                       09910002
099200                   DECODE ((TO_CHAR(A.PROMO_DFLT_STRT_TMST,'D'))  09920002
099300*                 ,'1',(A.PROMO_DFLT_STRT_TMST - :PV-NBR-OF-DAYS7)09930033
PK7624                  ,'1',(A.PROMO_DFLT_STRT_TMST - :PV-NBR-OF-DAYS8)09931033
099400*                 ,'2',(A.PROMO_DFLT_STRT_TMST - :PV-NBR-OF-DAYS8)09940033
PK7624                  ,'2',(A.PROMO_DFLT_STRT_TMST - :PV-NBR-OF-DAYS9)09941033
099500*                 ,'7',(A.PROMO_DFLT_STRT_TMST - :PV-NBR-OF-DAYS9)09950033
PK7624                 ,'7',(A.PROMO_DFLT_STRT_TMST - :PV-NBR-OF-DAYS10)09951033
099600*                 ,(A.PROMO_DFLT_STRT_TMST - :PV-NBR-OF-DAYS10)), 09960033
PK7624                  ,(A.PROMO_DFLT_STRT_TMST - :PV-NBR-OF-DAYS11)), 09961033
099700                      'YYYYMMDD') "POST CORRECTIONS DATE 2"       09970002
C09985                  ,TO_CHAR(                                       09971036
C09985                   DECODE ((TO_CHAR(A.PROMO_DFLT_STRT_TMST,'D'))  09972036
C09985                 ,'1',(A.PROMO_DFLT_STRT_TMST - :PV-NBR-OF-DAYS12)09974036
C09985                 ,'2',(A.PROMO_DFLT_STRT_TMST - :PV-NBR-OF-DAYS13)09976036
C09985                 ,'7',(A.PROMO_DFLT_STRT_TMST - :PV-NBR-OF-DAYS14)09978036
C09985                  ,(A.PROMO_DFLT_STRT_TMST - :PV-NBR-OF-DAYS15)), 09979136
C09985                      'YYYYMMDD') "POST CORRECTIONS DATE 3"       09979236
099800          FROM  PMV_PROMO_DIM A                                   09980002
099900               ,PMT_PROMO B                                       09990002
100000          WHERE A.PROMO_ID = B.PROMO_ID                           10000002
100100            AND (A.AD_EVNT_STRT_DTE                               10010009
100200          BETWEEN (TO_DATE(:CC-RUN-DTE,'YYYYMMDD') + :PV-MIN-DAYS)10020002
100300              AND (TO_DATE(:CC-RUN-DTE,'YYYYMMDD') + :PV-MAX-DAYS)10030002
100400             OR A.AD_EVNT_END_DTE                                 10040009
100500          BETWEEN (TO_DATE(:CC-RUN-DTE,'YYYYMMDD') + :PV-MIN-DAYS)10050002
100600             AND (TO_DATE(:CC-RUN-DTE,'YYYYMMDD') + :PV-MAX-DAYS))10060002
100700              AND A.PROMO_TYP_CDE  = 'R'                          10070002
100800              AND A.PROMO_STAT_CDE = 'S'                          10080002
567913              AND A.PROMO_ABBR_NM <> 'DOD'                        10081028
100900          ORDER BY A.AD_EVNT_ID, A.PROMO_ID                       10090002
101000     END-EXEC.                                                    10100002
101100                                                                  10110002
101200*---------------------------------------------------------------  10120002
101300* 1400-DECLARE-PM-OVERLAP-CSR                                     10130002
101400*     DECLARE THE PROMO OVERLAP CURSOR.                           10140002
101500*---------------------------------------------------------------  10150002
101600 1400-DECLARE-PM-OVERLAP-CSR.                                     10160002
101700                                                                  10170002
101800     EXEC SQL                                                     10180002
101900          DECLARE OVERLAPCSR CURSOR FOR                           10190002
102000            SELECT B.AD_EVNT_ID                                   10200002
102100                ,  B.PROMO_ID                                     10210002
102200            FROM PMV_PROMO_DIM A                                  10220002
102300               , PMV_PROMO_DIM B                                  10230002
102400            WHERE A.PROMO_ID = :PV-OVERLAP-PROMO-ID               10240002
102500              AND B.PROMO_ID <> :PV-OVERLAP-PROMO-ID              10250002
102600              AND A.PROMO_DFLT_STRT_TMST  <=                      10260002
102700                  B.PROMO_DFLT_END_TMST                           10270002
102800              AND A.PROMO_DFLT_END_TMST   >=                      10280002
102900                  B.PROMO_DFLT_STRT_TMST                          10290002
103000              AND B.PROMO_STAT_CDE = 'S'                          10300002
103100     END-EXEC.                                                    10310002
103200                                                                  10320002
103300*---------------------------------------------------------------  10330002
103400* 1500-DECLARE-FULL-DAY-PM-CSR                                    10340002
103500*     DECLARE THE FULL DAY PROMO CURSOR.                          10350002
103600*---------------------------------------------------------------  10360002
103700 1500-DECLARE-FULL-DAY-PM-CSR.                                    10370002
103800                                                                  10380002
103900     EXEC SQL                                                     10390002
104000          DECLARE FULLDAYCSR CURSOR FOR                           10400002
104100            SELECT B.PROMO_ID                                     10410002
104200            FROM PMV_PROMO_DIM A                                  10420002
104300               , PMV_PROMO_DIM B                                  10430002
104400            WHERE A.PROMO_ID = :PM121-PART-DAY-PROMO-ID           10440002
104500              AND B.PROMO_ID <> :PM121-PART-DAY-PROMO-ID          10450002
104600              AND A.PROMO_DFLT_STRT_TMST  <=                      10460002
104700                  B.PROMO_DFLT_END_TMST                           10470002
104800              AND A.PROMO_DFLT_END_TMST   >=                      10480002
104900                  B.PROMO_DFLT_STRT_TMST                          10490002
105000              AND B.PROMO_STAT_CDE = 'S'                          10500002
105100              AND B.PROMO_TYP_CDE = 'R'                           10510002
105200              AND B.REG_PROMO_TYP_CDE <> 'U'                      10520002
105300              AND B.ADV_PROMO_TYP_CDE <> 'M'                      10530002
105400                                                                  10540002
105500              AND PMFN_DATE_DIFF('YR',B.PROMO_DFLT_STRT_TMST,     10550002
105600                             B.PROMO_DFLT_END_TMST) = 0           10560002
105700              AND PMFN_DATE_DIFF('MO',B.PROMO_DFLT_STRT_TMST,     10570002
105800                             B.PROMO_DFLT_END_TMST) = 0           10580002
105900              AND PMFN_DATE_DIFF('DY',B.PROMO_DFLT_STRT_TMST,     10590002
106000                             B.PROMO_DFLT_END_TMST) >= 0          10600002
106100              AND PMFN_DATE_DIFF('HR',B.PROMO_DFLT_STRT_TMST,     10610002
106200                             B.PROMO_DFLT_END_TMST) >= 23         10620002
106300              AND PMFN_DATE_DIFF('MI',B.PROMO_DFLT_STRT_TMST,     10630002
106400                             B.PROMO_DFLT_END_TMST) >= 58         10640002
106500     END-EXEC.                                                    10650002
106600                                                                  10660002
106700*----------------------------------------------------------       10670002
106800* 2000-PROCESS-ADEVNT-CSR.                                        10680002
106900*     FETCHES THE AD EVENT CURSOR AND WRITES OUT EACH             10690002
107000*     AD EVENT TO A SEPERATE FILE AND ALSO WRITES OUT THE         10700002
107100*     PROMOTION FILES.                                            10710002
107200*----------------------------------------------------------       10720002
107300 2000-PROCESS-ADEVNT-CSR.                                         10730002
107400                                                                  10740002
107500*    IF AD ID HASN'T ALREADY BEEN WRITTEN, WRITE IT               10750002
107600*    TO THE NEXT AD FILE.  USED TO LOAD ORACLE TABLES             10760002
107700     IF PV-AD-EVNT-ID NOT = PV-SAVE-AD-EVNT-ID                    10770002
107800        ADD 1 TO PA-ADEVNT-CNT                                    10780002
107900        PERFORM 9000-WRITE-AD-EVNT                                10790002
108000        MOVE PV-AD-EVNT-ID TO PV-SAVE-AD-EVNT-ID                  10800002
108100     END-IF.                                                      10810017
108200                                                                  10820002
108300*    ONLY WRITE ADVERTISED NON-MAIN PROMOS                        10830002
108400*    WRITE FILES FOR PRICING CONFLICT REPORTS - PMKRP130          10840002
108500     IF (PV-REG-PROMO-TYP-CDE = 'A ' AND                          10850002
108600         PV-ADV-PROMO-TYP-CDE NOT = 'M ')                         10860002
108700        IF PV-POST-INITIAL-DTE = CC-RUN-DTE                       10870002
108800           MOVE PV-PROMO-ID TO PM114-PROMO-ID                     10880002
108900           MOVE PC-01       TO PM114-REPORT-TYPE                  10890002
109000           PERFORM 9100-WRITE-PROMO-INITIAL                       10900002
109100        ELSE                                                      10910002
109200           IF PV-PRE-CORR-DTE = CC-RUN-DTE                        10920002
109300              MOVE PV-PROMO-ID TO PM114-PROMO-ID                  10930002
109400              MOVE PC-02       TO PM114-REPORT-TYPE               10940002
109500              PERFORM 9200-WRITE-PROMO-PRECORR                    10950002
109600           ELSE                                                   10960002
109700              IF PV-POST-CORR-DTE = CC-RUN-DTE                    10970002
109800                 MOVE PV-PROMO-ID TO PM114-PROMO-ID               10980002
109900                 MOVE PC-03       TO PM114-REPORT-TYPE            10990002
110000                 PERFORM 9300-WRITE-PROMO-POSTCORR                11000002
C09985              ELSE                                                11001036
C09885                 IF PV-POST-CORR-DTE-2 = CC-RUN-DTE               11001136
C09985                    MOVE PV-PROMO-ID TO PM114-PROMO-ID            11002036
C09985                    MOVE PC-04       TO PM114-REPORT-TYPE         11003039
C09985                    PERFORM 9310-WRITE-PROMO-POSTCORR-2           11004036
C09985                 ELSE                                             11004136
C09885                    IF PV-POST-CORR-DTE-3 = CC-RUN-DTE            11004236
C09985                       MOVE PV-PROMO-ID TO PM114-PROMO-ID         11004336
C09985                       MOVE PC-05       TO PM114-REPORT-TYPE      11004439
C09985                       PERFORM 9320-WRITE-PROMO-POSTCORR-3        11004536
C09985                    END-IF                                        11005036
C09985                 END-IF                                           11006036
110100              END-IF                                              11010002
110200           END-IF                                                 11020002
110300        END-IF                                                    11030002
110400     END-IF.                                                      11040002
110500                                                                  11050002
110600*    BOGO COMPLIANCE REPORTS PMKRP141                             11060002
110700*    BOGO OVERLAP REPORT PMKRP131                                 11070002
110800*    CHECK FOR SKUS NOT ON SALE REPORT - PMKRP132                 11080002
110900     IF PV-POST-INITIAL-DTE = CC-RUN-DTE                          11090002
111000        MOVE PV-PROMO-ID TO PM114-PROMO-ID                        11100002
111100                            PM115-PROMO-ID                        11110002
111200        MOVE PC-01       TO PM114-REPORT-TYPE                     11120002
111300                            PM115-REPORT-TYPE                     11130002
111400                            PM121-REPORT-TYPE                     11140002
111500        MOVE PV-AD-EVNT-ID TO PM115-AD-ID                         11150002
111600        PERFORM 9400-WRITE-BOGOC-INITIAL                          11160002
111700        PERFORM 9450-WRITE-BOGOO-INITIAL                          11170002
111800        PERFORM 7000-CHECK-PARTIAL-DAY                            11180002
111900        PERFORM 8000-CHECK-FOR-EOS-TYPE                           11190002
112000                                                                  11200002
112100**      DISPLAY 'PV-PROMO-STRT-TMST1: ' PV-PROMO-STRT-TMST        11210016
112200**      DISPLAY 'STRT-SAVED: ' PV-PROMO-STRT-TMST-SAVED-1         11220016
112300        IF PV-PROMO-STRT-TMST > PV-PROMO-STRT-TMST-SAVED-1        11230002
112400**         DISPLAY 'GREATER THAN SO MOVING - 1'                   11240016
112500           MOVE PV-PROMO-STRT-TMST TO PV-PROMO-STRT-TMST-SAVED-1  11250002
112600           MOVE PV-PROMO-END-TMST  TO PV-PROMO-END-TMST-SAVED-1   11260002
112700        END-IF                                                    11270002
112800     ELSE                                                         11280002
112900        IF PV-PRE-CORR-DTE = CC-RUN-DTE                           11290002
113000           MOVE PV-PROMO-ID TO PM114-PROMO-ID                     11300002
113100                               PM115-PROMO-ID                     11310002
113200           MOVE PC-02       TO PM114-REPORT-TYPE                  11320002
113300                               PM115-REPORT-TYPE                  11330002
113400                               PM121-REPORT-TYPE                  11340002
113500           MOVE PV-AD-EVNT-ID TO PM115-AD-ID                      11350002
113600           PERFORM 9500-WRITE-BOGOC-PRECORR                       11360002
113700           PERFORM 9550-WRITE-BOGOO-PRECORR                       11370002
113800           PERFORM 7000-CHECK-PARTIAL-DAY                         11380002
113900           PERFORM 8000-CHECK-FOR-EOS-TYPE                        11390002
114000***        DISPLAY 'PV-PROMO-STRT-TMST2: ' PV-PROMO-STRT-TMST     11400016
114100***        DISPLAY 'STRT-SAVED: ' PV-PROMO-STRT-TMST-SAVED-2      11410016
114200           IF PV-PROMO-STRT-TMST > PV-PROMO-STRT-TMST-SAVED-2     11420002
114300***           DISPLAY 'GREATER THAN SO MOVING - 2'                11430016
114400              MOVE PV-PROMO-STRT-TMST TO                          11440002
114500                                      PV-PROMO-STRT-TMST-SAVED-2  11450002
114600              MOVE PV-PROMO-END-TMST TO                           11460002
114700                                    PV-PROMO-END-TMST-SAVED-2     11470002
114800           END-IF                                                 11480002
114900        ELSE                                                      11490002
115000           IF PV-POST-CORR-DTE = CC-RUN-DTE                       11500002
115100              MOVE PV-PROMO-ID TO PM114-PROMO-ID                  11510002
115200                                  PM115-PROMO-ID                  11520002
115300              MOVE PC-03       TO PM114-REPORT-TYPE               11530002
115400                                  PM115-REPORT-TYPE               11540002
115500                                  PM121-REPORT-TYPE               11550002
115600              MOVE PV-AD-EVNT-ID TO PM115-AD-ID                   11560002
115700              PERFORM 9600-WRITE-BOGOC-POSTCORR                   11570002
115800              PERFORM 9650-WRITE-BOGOO-POSTCORR                   11580002
115900              PERFORM 7000-CHECK-PARTIAL-DAY                      11590002
116000              PERFORM 8000-CHECK-FOR-EOS-TYPE                     11600002
116100***           DISPLAY 'PV-PROMO-STRT-TMST3: ' PV-PROMO-STRT-TMST  11610016
116200***           DISPLAY 'STRT-SAVED: ' PV-PROMO-STRT-TMST-SAVED-3   11620016
116300              IF PV-PROMO-STRT-TMST > PV-PROMO-STRT-TMST-SAVED-3  11630017
116400                 DISPLAY 'GREATER THAN SO MOVING - 3'             11640002
116500                 MOVE PV-PROMO-STRT-TMST TO                       11650002
116600                                      PV-PROMO-STRT-TMST-SAVED-3  11660002
116700                 MOVE PV-PROMO-END-TMST TO                        11670002
116800                                      PV-PROMO-END-TMST-SAVED-3   11680002
116900              END-IF                                              11690002
117000           ELSE                                                   11700002
117100              IF PV-POST-CORR-DTE-2 = CC-RUN-DTE                  11710002
117200                 MOVE PV-AD-EVNT-ID TO PM115-AD-ID                11720002
117300                 MOVE PV-PROMO-ID   TO PM114-PROMO-ID             11730002
117400                                       PM115-PROMO-ID             11740002
117500                 MOVE PC-04         TO PM114-REPORT-TYPE          11750002
117600                                       PM115-REPORT-TYPE          11760002
117700                 PERFORM 9660-WRITE-BOGOO-POSTCORR-2              11770002
W37986                 PERFORM 9680-WRITE-KIOSK-POSTCORR-2              11771032
117800                 PERFORM 8000-CHECK-FOR-EOS-TYPE                  11780002
C09985              ELSE                                                11781036
C09985                 IF PV-POST-CORR-DTE-3 = CC-RUN-DTE               11782036
C09985                    MOVE PV-AD-EVNT-ID TO PM115-AD-ID             11783036
C09985                    MOVE PV-PROMO-ID TO PM114-PROMO-ID            11784036
C09985                                          PM115-PROMO-ID          11785036
C09985                    MOVE PC-05      TO PM114-REPORT-TYPE          11786036
C09985                                          PM115-REPORT-TYPE       11787036
C09985                    PERFORM 9690-WRITE-BOGOO-POSTCORR-3           11788036
C09985                 END-IF                                           11790036
117900              END-IF                                              11791036
118000           END-IF                                                 11800002
118100        END-IF                                                    11810002
118200     END-IF.                                                      11820002
118300                                                                  11830002
118400     PERFORM 2020-FETCH-ADEVENT-CSR.                              11840002
118500                                                                  11850002
118600*2000-EXIT.                                                       11860002
118700 EJECT.                                                           11870002
118800                                                                  11880002
118900*----------------------------------------------------------       11890002
119000* 2010-OPEN-ADEVENT-CSR.                                          11900002
119100*     OPENS THE AD EVENT CURSOR.                                  11910002
119200*----------------------------------------------------------       11920002
119300 2010-OPEN-ADEVENT-CSR.                                           11930002
119400                                                                  11940002
119500     EXEC SQL                                                     11950002
119600           OPEN ADEVENTCSR                                        11960002
119700     END-EXEC.                                                    11970002
119800                                                                  11980002
119900     EVALUATE TRUE                                                11990002
120000         WHEN SQLCODE = ZEROES                                    12000002
120100              SET PS-NOT-END-OF-ADEVNT-CSR TO TRUE                12010002
120200         WHEN OTHER                                               12020002
120300              SET ABEND-4013-SQL-ERROR TO TRUE                    12030002
120400              MOVE SQLCODE             TO PV-SQL-CODE             12040002
120500              MOVE '2010-OPEN-ADEVENT-CSR'                        12050002
120600                                TO PV-PARAGRAPH-NAME              12060002
120700              MOVE 'OPEN ERROR ON ADEVENTCSR'                     12070002
120800                                TO PV-OPERATION-MSG               12080002
120900              PERFORM 9900-ORACLE-ABEND                           12090002
121000     END-EVALUATE.                                                12100002
121100                                                                  12110002
121200*2010-EXIT.                                                       12120002
121300 EJECT.                                                           12130002
121400                                                                  12140002
121500*----------------------------------------------------------       12150002
121600* 2020-FETCH-ADEVENT-CSR.                                         12160002
121700*     FETCHES THE ADEVENT CURSOR.                                 12170002
121800*----------------------------------------------------------       12180002
121900 2020-FETCH-ADEVENT-CSR.                                          12190002
122000                                                                  12200002
122100     EXEC SQL                                                     12210002
122200         FETCH ADEVENTCSR                                         12220002
122300          INTO  :PV-AD-EVNT-ID                                    12230002
122400               ,:PV-PROMO-ID                                      12240002
122500               ,:PV-PROMO-ABBR-NM                                 12250002
122600               ,:PV-REG-PROMO-TYP-CDE                             12260002
122700               ,:PV-ADV-PROMO-TYP-CDE:PV-ADV-PROMO-TYP-NULL       12270002
122800               ,:PV-PROMO-STRT-TMST                               12280002
122900               ,:PV-PROMO-END-TMST                                12290002
123000               ,:PV-POST-INITIAL-DTE                              12300002
123100               ,:PV-PRE-CORR-DTE                                  12310002
123200               ,:PV-POST-CORR-DTE                                 12320002
123300               ,:PV-POST-CORR-DTE-2                               12330002
C09985               ,:PV-POST-CORR-DTE-3                               12331036
123400     END-EXEC.                                                    12340002
123500                                                                  12350002
123600     EVALUATE TRUE                                                12360002
123700         WHEN SQLCODE = ZERO                                      12370002
123800              IF PV-ADV-PROMO-TYP-NULL < 0                        12380002
123900                  MOVE '  ' TO PV-ADV-PROMO-TYP-CDE               12390002
124000              END-IF                                              12400002
124700         WHEN SQLCODE = 1403                                      12470002
124800              SET PS-END-OF-ADEVNT-CSR TO TRUE                    12480002
124900              PERFORM 9700-WRITE-DTE-FILES                        12490002
125000         WHEN OTHER                                               12500002
125100              MOVE SQLCODE      TO PV-SQL-CODE                    12510002
125200              SET ABEND-4013-SQL-ERROR TO TRUE                    12520002
125300              MOVE '2020-FETCH-ADEVENT-CSR'                       12530002
125400                                TO PV-PARAGRAPH-NAME              12540002
125500              MOVE 'FETCH ERROR ON ADEVENTCSR'                    12550002
125600                               TO PV-OPERATION-MSG                12560002
125700              PERFORM 9900-ORACLE-ABEND                           12570002
125800     END-EVALUATE.                                                12580002
125900                                                                  12590002
126000*2020-EXIT.                                                       12600002
126100 EJECT.                                                           12610002
126200                                                                  12620002
126300*----------------------------------------------------------       12630002
126400* 2030-CLOSE-ADEVENT-CSR.                                         12640002
126500*     CLOSE THE ADEVENT CURSOR.                                   12650002
126600*----------------------------------------------------------       12660002
126700 2030-CLOSE-ADEVENT-CSR.                                          12670002
126800                                                                  12680002
126900     EXEC SQL                                                     12690002
127000          CLOSE ADEVENTCSR                                        12700002
127100     END-EXEC.                                                    12710002
127200                                                                  12720002
127300     EVALUATE TRUE                                                12730002
127400         WHEN SQLCODE = ZERO                                      12740002
127500              CONTINUE                                            12750002
127600         WHEN OTHER                                               12760002
127700              MOVE SQLCODE     TO PV-SQL-CODE                     12770002
127800              SET ABEND-4013-SQL-ERROR TO TRUE                    12780002
127900              MOVE '2030-CLOSE-ADEVENT-CSR'                       12790002
128000                               TO PV-PARAGRAPH-NAME               12800002
128100              MOVE 'CLOSE ERROR ON ADEVENTCSR'                    12810002
128200                               TO PV-OPERATION-MSG                12820002
128300              PERFORM 9900-ORACLE-ABEND                           12830002
128400     END-EVALUATE.                                                12840002
128500                                                                  12850002
128600*2030-EXIT.                                                       12860002
128700 EJECT.                                                           12870002
128800                                                                  12880002
128900*----------------------------------------------------------       12890002
129000* 2040-OPEN-OVERLAP-CSR.                                          12900002
129100*     OPENS THE PROMO OVERLAP CURSOR                              12910002
129200*----------------------------------------------------------       12920002
129300 2040-OPEN-OVERLAP-CSR.                                           12930002
129400                                                                  12940002
129500     EXEC SQL                                                     12950002
129600           OPEN OVERLAPCSR                                        12960002
129700     END-EXEC.                                                    12970002
129800                                                                  12980002
129900     EVALUATE TRUE                                                12990002
130000         WHEN SQLCODE = ZEROES                                    13000002
130100              SET PS-NOT-END-OF-OVERLAP-CSR TO TRUE               13010002
130200         WHEN OTHER                                               13020002
130300              SET ABEND-4013-SQL-ERROR TO TRUE                    13030002
130400              MOVE SQLCODE             TO PV-SQL-CODE             13040002
130500              MOVE '2040-OPEN-OVERLAP-CSR'                        13050002
130600                                TO PV-PARAGRAPH-NAME              13060002
130700              MOVE 'OPEN ERROR ON OVERLAPCSR'                     13070002
130800                                TO PV-OPERATION-MSG               13080002
130900              PERFORM 9900-ORACLE-ABEND                           13090002
131000     END-EVALUATE.                                                13100002
131100                                                                  13110002
131200*2040-EXIT.                                                       13120002
131300 EJECT.                                                           13130002
131400                                                                  13140002
131500*----------------------------------------------------------       13150002
131600* 2050-FETCH-OVERLAP-CSR.                                         13160002
131700*     FETCHES THE OVERLAP CURSOR.                                 13170002
131800*----------------------------------------------------------       13180002
131900 2050-FETCH-OVERLAP-CSR.                                          13190002
132000                                                                  13200002
132100     EXEC SQL                                                     13210002
132200         FETCH OVERLAPCSR                                         13220002
132300          INTO  :PM115-AD-ID                                      13230002
132400               ,:PM115-PROMO-ID                                   13240002
132500     END-EXEC.                                                    13250002
132600                                                                  13260002
132700     EVALUATE TRUE                                                13270002
132800         WHEN SQLCODE = ZERO                                      13280002
132900              SET PS-OVERLAP-PROMO TO TRUE                        13290002
133100         WHEN SQLCODE = 1403                                      13310002
133200              SET PS-NO-OVERLAP-PROMO TO TRUE                     13320002
133300              SET PS-END-OF-OVERLAP-CSR TO TRUE                   13330002
133400         WHEN OTHER                                               13340002
133500              SET PS-NO-OVERLAP-PROMO TO TRUE                     13350002
133600              MOVE SQLCODE      TO PV-SQL-CODE                    13360002
133700              SET ABEND-4013-SQL-ERROR TO TRUE                    13370002
133800              MOVE '2050-FETCH-OVERLAP-CSR'                       13380002
133900                                TO PV-PARAGRAPH-NAME              13390002
134000              MOVE 'FETCH ERROR ON OVERLAPCSR'                    13400002
134100                               TO PV-OPERATION-MSG                13410002
134200              PERFORM 9900-ORACLE-ABEND                           13420002
134300     END-EVALUATE.                                                13430002
134400                                                                  13440002
134500*2050-EXIT.                                                       13450002
134600 EJECT.                                                           13460002
134700                                                                  13470002
134800*----------------------------------------------------------       13480002
134900* 2060-CLOSE-OVERLAP-CSR.                                         13490002
135000*     CLOSE THE OVERLAP CURSOR.                                   13500002
135100*----------------------------------------------------------       13510002
135200 2060-CLOSE-OVERLAP-CSR.                                          13520002
135300                                                                  13530002
135400     EXEC SQL                                                     13540002
135500          CLOSE OVERLAPCSR                                        13550002
135600     END-EXEC.                                                    13560002
135700                                                                  13570002
135800     EVALUATE TRUE                                                13580002
135900         WHEN SQLCODE = ZERO                                      13590002
136000              CONTINUE                                            13600002
136100         WHEN OTHER                                               13610002
136200              MOVE SQLCODE     TO PV-SQL-CODE                     13620002
136300              SET ABEND-4013-SQL-ERROR TO TRUE                    13630002
136400              MOVE '2060-CLOSE-OVERLAP-CSR'                       13640002
136500                               TO PV-PARAGRAPH-NAME               13650002
136600              MOVE 'CLOSE ERROR ON OVERLAPCSR'                    13660002
136700                               TO PV-OPERATION-MSG                13670002
136800              PERFORM 9900-ORACLE-ABEND                           13680002
136900     END-EVALUATE.                                                13690002
137000                                                                  13700002
137100*2060-EXIT.                                                       13710002
137200 EJECT.                                                           13720002
137300                                                                  13730002
137400*----------------------------------------------------------       13740002
137500* 2070-OPEN-FULLDAY-CSR.                                          13750002
137600*     OPENS THE FULL-DAY PROMO CURSOR                             13760002
137700*----------------------------------------------------------       13770002
137800 2070-OPEN-FULLDAY-CSR.                                           13780002
137900                                                                  13790002
138000     EXEC SQL                                                     13800002
138100           OPEN FULLDAYCSR                                        13810002
138200     END-EXEC.                                                    13820002
138300                                                                  13830002
138400     EVALUATE TRUE                                                13840002
138500         WHEN SQLCODE = ZEROES                                    13850002
138600              SET PS-NOT-END-OF-FULLDAY-CSR TO TRUE               13860002
138700         WHEN OTHER                                               13870002
138800              SET ABEND-4013-SQL-ERROR TO TRUE                    13880002
138900              MOVE SQLCODE             TO PV-SQL-CODE             13890002
139000              MOVE '2070-OPEN-FULLDAY-CSR'                        13900002
139100                                TO PV-PARAGRAPH-NAME              13910002
139200              MOVE 'OPEN ERROR ON FULLDAYCSR'                     13920002
139300                                TO PV-OPERATION-MSG               13930002
139400              PERFORM 9900-ORACLE-ABEND                           13940002
139500     END-EVALUATE.                                                13950002
139600                                                                  13960002
139700 EJECT.                                                           13970002
139800                                                                  13980002
139900*----------------------------------------------------------       13990002
140000* 2080-FETCH-FULLDAY-CSR.                                         14000002
140100*     FETCHES THE FULLDAY CURSOR.                                 14010002
140200*----------------------------------------------------------       14020002
140300 2080-FETCH-FULLDAY-CSR.                                          14030002
140400                                                                  14040002
140500     EXEC SQL                                                     14050002
140600         FETCH FULLDAYCSR                                         14060002
140700          INTO  :PM121-FULL-DAY-PROMO-ID                          14070002
140800     END-EXEC.                                                    14080002
140900                                                                  14090002
141000     EVALUATE TRUE                                                14100002
141100         WHEN SQLCODE = ZERO                                      14110002
141200              CONTINUE                                            14120002
141300         WHEN SQLCODE = 1403                                      14130002
141400              SET PS-END-OF-FULLDAY-CSR TO TRUE                   14140002
141500         WHEN OTHER                                               14150002
141600              SET PS-END-OF-FULLDAY-CSR TO TRUE                   14160002
141700              MOVE SQLCODE      TO PV-SQL-CODE                    14170002
141800              SET ABEND-4013-SQL-ERROR TO TRUE                    14180002
141900              MOVE '2080-FETCH-FULLDAY-CSR'                       14190002
142000                                TO PV-PARAGRAPH-NAME              14200002
142100              MOVE 'FETCH ERROR ON FULLDAYCSR'                    14210002
142200                               TO PV-OPERATION-MSG                14220002
142300              PERFORM 9900-ORACLE-ABEND                           14230002
142400     END-EVALUATE.                                                14240002
142500                                                                  14250002
142600*2080-EXIT.                                                       14260002
142700 EJECT.                                                           14270002
142800                                                                  14280002
142900*----------------------------------------------------------       14290002
143000* 2090-CLOSE-FULLDAY-CSR.                                         14300002
143100*     CLOSE THE FULLDAY CURSOR.                                   14310002
143200*----------------------------------------------------------       14320002
143300 2090-CLOSE-FULLDAY-CSR.                                          14330002
143400                                                                  14340002
143500     EXEC SQL                                                     14350002
143600          CLOSE FULLDAYCSR                                        14360002
143700     END-EXEC.                                                    14370002
143800                                                                  14380002
143900     EVALUATE TRUE                                                14390002
144000         WHEN SQLCODE = ZERO                                      14400002
144100              CONTINUE                                            14410002
144200         WHEN OTHER                                               14420002
144300              MOVE SQLCODE     TO PV-SQL-CODE                     14430002
144400              SET ABEND-4013-SQL-ERROR TO TRUE                    14440002
144500              MOVE '2090-CLOSE-FULLDAY-CSR'                       14450002
144600                               TO PV-PARAGRAPH-NAME               14460002
144700              MOVE 'CLOSE ERROR ON FULLDAYCSR'                    14470002
144800                               TO PV-OPERATION-MSG                14480002
144900              PERFORM 9900-ORACLE-ABEND                           14490002
145000     END-EVALUATE.                                                14500002
145100                                                                  14510002
145200*2090-EXIT.                                                       14520002
145300 EJECT.                                                           14530002
145400                                                                  14540002
145500*----------------------------------------------------------       14550002
145600* 2100-PROCESS-OVERLAP-CSR                                        14560002
145700*     PROCESSES THE OVERLAP CURSOR                                14570002
145800*----------------------------------------------------------       14580002
145900 2100-PROCESS-OVERLAP-CSR.                                        14590002
146000                                                                  14600002
146100     PERFORM 2050-FETCH-OVERLAP-CSR.                              14610002
146200     IF PS-OVERLAP-PROMO                                          14620002
146300**     WRITE OVERLAP PROMO TO FILE                                14630002
146400        EVALUATE TRUE                                             14640002
146500          WHEN PM115-REPORT-TYPE = PC-01                          14650002
146600              PERFORM 9460-WRITE-OVERLAP-INITIAL                  14660002
146700          WHEN PM115-REPORT-TYPE = PC-02                          14670002
146800              PERFORM 9560-WRITE-OVERLAP-PRECORR                  14680002
146900          WHEN PM115-REPORT-TYPE = PC-03                          14690002
147000              PERFORM 9660-WRITE-OVERLAP-POSTCORR                 14700002
147100          WHEN PM115-REPORT-TYPE = PC-04                          14710002
147200              PERFORM 9670-WRITE-OVERLAP-POSTCORR-2               14720002
C09985          WHEN PM115-REPORT-TYPE = PC-05                          14721039
C09985              PERFORM 9695-WRITE-OVERLAP-POSTCORR-3               14722039
147300        END-EVALUATE                                              14730002
147400     END-IF.                                                      14740002
147500                                                                  14750002
147600*----------------------------------------------------------       14760002
147700* 3000-TRUNC-TABLE.                                               14770002
147800*     TRUNCATE THE SKU PRICING BY LOCATION TABLE.                 14780002
147900*----------------------------------------------------------       14790002
148000 3000-TRUNC-TABLE.                                                14800002
148100                                                                  14810002
148200     DISPLAY ' '                                                  14820002
148300     DISPLAY 'TRUNCATING K_PM01.PMT_SKU_LVL_PRICG_BY_LOC'         14830002
W37986     DISPLAY ' '.                                                 14840032
148500                                                                  14850002
148600     EXEC SQL EXECUTE                                             14851032
148700       BEGIN                                                      14852032
148800         PMSP_TRUNC_TABLE('K_PM01.PMT_SKU_LVL_PRICG_BY_LOC');     14853032
148900       END;                                                       14854032
149000     END-EXEC.                                                    14855032
149100                                                                  14856032
149200     EVALUATE TRUE                                                14857032
149300       WHEN SQLCODE = ZERO                                        14858032
149400           DISPLAY 'FINISHED TRUNCATING'                          14859032
149500       WHEN OTHER                                                 14859132
149600           MOVE SQLCODE                    TO PV-SQL-CODE         14859232
149700           MOVE 'PMT_SKU_LVL_PRICG_BY_LOC' TO PV-TABLE-NAME       14859332
149800           MOVE '3000-TRUNC-TABLE'         TO PV-PARAGRAPH-NAME   14859432
149900           PERFORM 9900-ORACLE-ABEND                              14859532
150000     END-EVALUATE.                                                14859632
150100                                                                  15010002
150200*3000-EXIT.                                                       15020002
150300 EJECT.                                                           15030002
150400                                                                  15040002
150500                                                                  15050002
150600*----------------------------------------------------------       15060002
150700* 7000-CHECK-PARTIAL-DAY.                                         15070002
150800*----------------------------------------------------------       15080002
150900 7000-CHECK-PARTIAL-DAY.                                          15090002
151000                                                                  15100002
151200     EXEC SQL                                                     15120002
151300           SELECT 1                                               15130002
151400           INTO :PV-DUAL-ONE                                      15140002
151500             FROM PMV_PROMO_DIM                                   15150002
151600            WHERE PROMO_ID            = :PV-PROMO-ID              15160002
                    AND (TO_CHAR(PROMO_DFLT_STRT_TMST, 'HH24:MI')       15170020
                                 != '00:00'                             15171020
                          OR TO_CHAR(PROMO_DFLT_END_TMST, 'HH24:MI')    15180020
                                 != '23:59')                            15190021
152900     END-EXEC.                                                    15290002
153000                                                                  15300002
153100     EVALUATE TRUE                                                15310002
153200       WHEN SQLCODE = ZEROES                                      15320002
153300            SET PS-PARTIAL-DAY     TO TRUE                        15330002
153400       WHEN SQLCODE = 1403                                        15340002
153500            SET PS-NOT-PARTIAL-DAY TO TRUE                        15350002
153600       WHEN OTHER                                                 15360002
153700            SET PS-NOT-PARTIAL-DAY TO TRUE                        15370002
153800            MOVE SQLCODE     TO PV-SQL-CODE                       15380002
153900            SET ABEND-4013-SQL-ERROR TO TRUE                      15390002
154000            MOVE 'PMT_PROMO_DIM' TO PV-TABLE-NAME                 15400002
154100            MOVE '7000-CHECK-PARTIAL-DAY'                         15410002
154200                                       TO PV-PARAGRAPH-NAME       15420002
154300            MOVE 'ERROR ON SELECT EXISTS'                         15430002
154400                                       TO PV-OPERATION-MSG-1      15440002
154500            PERFORM Z100-ABEND                                    15450002
154600     END-EVALUATE.                                                15460002
154700                                                                  15470002
154800     IF PS-PARTIAL-DAY                                            15480002
154900        MOVE PV-PROMO-ID      TO PM121-PART-DAY-PROMO-ID          15490002
155000        PERFORM 7200-GET-FULL-DAY-PROMO                           15500002
155100     END-IF.                                                      15510002
155200                                                                  15520002
155300*----------------------------------------------------------       15530002
155400* 7100-WRITE-PARTIAL-INITIAL.                                     15540002
155500*----------------------------------------------------------       15550002
155600 7100-WRITE-PARTIAL-INITIAL.                                      15560002
155700                                                                  15570002
155800     WRITE EXCPT-PAR-INITIAL-REC                                  15580002
155900         FROM PM121-PROMO.                                        15590002
156000                                                                  15600002
156100*----------------------------------------------------------       15610002
156200* 7110-WRITE-PARTIAL-PRECORR.                                     15620002
156300*----------------------------------------------------------       15630002
156400 7110-WRITE-PARTIAL-PRECORR.                                      15640002
156500                                                                  15650002
156600     WRITE EXCPT-PAR-PRECORR-REC                                  15660002
156700         FROM PM121-PROMO.                                        15670002
156800                                                                  15680002
156900*----------------------------------------------------------       15690002
157000* 7120-WRITE-PARTIAL-POSTCORR.                                    15700002
157100*----------------------------------------------------------       15710002
157200 7120-WRITE-PARTIAL-POSTCORR.                                     15720002
157300                                                                  15730002
157400     WRITE EXCPT-PAR-POSTCORR-REC                                 15740002
157500         FROM PM121-PROMO.                                        15750002
157600                                                                  15760002
157700*----------------------------------------------------------       15770002
157800* 7200-GET-FULL-DAY-PROMO.                                        15780002
157900*----------------------------------------------------------       15790002
158000 7200-GET-FULL-DAY-PROMO.                                         15800002
158100                                                                  15810002
158400     PERFORM 2070-OPEN-FULLDAY-CSR.                               15840002
158500     PERFORM 2080-FETCH-FULLDAY-CSR.                              15850002
158600                                                                  15860002
158700     PERFORM 7300-PROCESS-FULLDAY-CSR                             15870002
158800       UNTIL PS-END-OF-FULLDAY-CSR.                               15880002
158900                                                                  15890002
159000     PERFORM 2090-CLOSE-FULLDAY-CSR.                              15900002
159100                                                                  15910002
159200*----------------------------------------------------------       15920002
159300* 7300-PROCESS-FULLDAY-CSR.                                       15930002
159400*----------------------------------------------------------       15940002
159500 7300-PROCESS-FULLDAY-CSR.                                        15950002
159600                                                                  15960002
159900     EVALUATE TRUE                                                15990002
160000       WHEN PM121-REPORT-TYPE = PC-01                             16000002
160100           PERFORM 7100-WRITE-PARTIAL-INITIAL                     16010002
160200       WHEN PM121-REPORT-TYPE = PC-02                             16020002
160300           PERFORM 7110-WRITE-PARTIAL-PRECORR                     16030002
160400       WHEN PM121-REPORT-TYPE = PC-03                             16040002
160500           PERFORM 7120-WRITE-PARTIAL-POSTCORR                    16050002
160600     END-EVALUATE.                                                16060002
160700                                                                  16070002
160800     PERFORM 2080-FETCH-FULLDAY-CSR.                              16080002
160900                                                                  16090002
161000*----------------------------------------------------------       16100002
161100* 8000-CHECK-FOR-EOS-TYPE.                                        16110002
161200*----------------------------------------------------------       16120002
161300 8000-CHECK-FOR-EOS-TYPE.                                         16130002
161400                                                                  16140002
161500     PERFORM T100-PROMO-ABBRV-LOOKUP.                             16150002
161600                                                                  16160002
161700     MOVE SPACES TO PV-EOS-STRT-DTE.                              16170002
161800     MOVE SPACES TO PV-EOS-END-DTE.                               16180002
161900     MOVE SPACES TO PV-HOLD-EOS-STRT-DTE.                         16190002
162000     MOVE SPACES TO PV-HOLD-EOS-END-DTE.                          16200002
162100                                                                  16210002
162200     IF PS-EOS-FOUND                                              16220002
162300        IF PV-PROMO-STRT-TMST NOT EQUAL SPACES                    16230002
162400           MOVE PV-PROMO-STRT-TMST TO PV-EOS-STRT-DTE             16240002
162500           MOVE PV-EOS-STRT-CCYY   TO PV-HOLD-EOS-STRT-CCYY       16250002
162600           MOVE PV-EOS-STRT-MM     TO PV-HOLD-EOS-STRT-MM         16260002
162700           MOVE PV-EOS-STRT-DD     TO PV-HOLD-EOS-STRT-DD         16270002
162800        END-IF                                                    16280002
162900                                                                  16290002
163000        IF PV-PROMO-END-TMST  NOT EQUAL SPACES                    16300002
163100           MOVE PV-PROMO-END-TMST  TO PV-EOS-END-DTE              16310002
163200           MOVE PV-EOS-END-CCYY    TO PV-HOLD-EOS-END-CCYY        16320002
163300           MOVE PV-EOS-END-MM      TO PV-HOLD-EOS-END-MM          16330002
163400           MOVE PV-EOS-END-DD      TO PV-HOLD-EOS-END-DD          16340002
163500        END-IF                                                    16350002
163600                                                                  16360002
163700        EVALUATE TRUE                                             16370002
163800          WHEN PM114-REPORT-TYPE = PC-01                          16380002
163900              PERFORM 8100-WRITE-EOS-INITIAL                      16390002
164000              PERFORM 8140-WRITE-EOS-INITIAL-DTE                  16400002
164100          WHEN PM114-REPORT-TYPE = PC-02                          16410002
164200              PERFORM 8110-WRITE-EOS-PRECORR                      16420002
164300              PERFORM 8150-WRITE-EOS-PRECORR-DTE                  16430002
164400          WHEN PM114-REPORT-TYPE = PC-03                          16440002
164500              PERFORM 8120-WRITE-EOS-POSTCORR                     16450002
164600              PERFORM 8160-WRITE-EOS-POSTCORR-DTE                 16460002
164700          WHEN PM114-REPORT-TYPE = PC-04                          16470002
164800              PERFORM 8130-WRITE-EOS-POSTCORR-2                   16480002
164900              PERFORM 8170-WRITE-EOS-POSTCORR-2-DTE               16490002
165000        END-EVALUATE                                              16500002
165100     END-IF.                                                      16510002
165200                                                                  16520002
165300*----------------------------------------------------------       16530002
165400* 8100-WRITE-EOS-INITIAL.                                         16540002
165500*----------------------------------------------------------       16550002
165600 8100-WRITE-EOS-INITIAL.                                          16560002
165700                                                                  16570002
165800     WRITE EXCPT-EOS-INITIAL-REC                                  16580002
165900         FROM PM114-PROMO-RPT-FILE.                               16590002
166000                                                                  16600002
166100*----------------------------------------------------------       16610002
166200* 8110-WRITE-EOS-PRECORR.                                         16620002
166300*----------------------------------------------------------       16630002
166400 8110-WRITE-EOS-PRECORR.                                          16640002
166500                                                                  16650002
166600     WRITE EXCPT-EOS-PRECORR-REC                                  16660002
166700         FROM PM114-PROMO-RPT-FILE.                               16670002
166800                                                                  16680002
166900*----------------------------------------------------------       16690002
167000* 8120-WRITE-EOS-POSTCORR.                                        16700002
167100*----------------------------------------------------------       16710002
167200 8120-WRITE-EOS-POSTCORR.                                         16720002
167300                                                                  16730002
167400     WRITE EXCPT-EOS-POSTCORR-REC                                 16740002
167500         FROM PM114-PROMO-RPT-FILE.                               16750002
167600                                                                  16760002
167700*----------------------------------------------------------       16770002
167800* 8130-WRITE-EOS-POSTCORR-2.                                      16780002
167900*----------------------------------------------------------       16790002
168000 8130-WRITE-EOS-POSTCORR-2.                                       16800002
168100                                                                  16810002
168200     WRITE EXCPT-EOS-POSTCORR-REC-2                               16820002
168300         FROM PM114-PROMO-RPT-FILE.                               16830002
168400                                                                  16840002
168500*----------------------------------------------------------       16850002
168600* 8140-WRITE-EOS-INITIAL-DTE.                                     16860002
168700*----------------------------------------------------------       16870002
168800 8140-WRITE-EOS-INITIAL-DTE.                                      16880002
168900                                                                  16890002
169000     MOVE PV-HOLD-EOS-STRT-DTE TO EOS-STRT-DTE-1.                 16900002
169100     MOVE PV-HOLD-EOS-END-DTE  TO EOS-END-DTE-1.                  16910002
169200                                                                  16920002
169300     WRITE EXCPT-EOS-INITIAL-DTE-REC                              16930002
169400         FROM EOS-DATE-REC-1.                                     16940002
169500                                                                  16950002
169600*----------------------------------------------------------       16960002
169700* 8150-WRITE-EOS-PRECORR-DTE.                                     16970002
169800*----------------------------------------------------------       16980002
169900 8150-WRITE-EOS-PRECORR-DTE.                                      16990002
170000                                                                  17000002
170100     MOVE PV-HOLD-EOS-STRT-DTE TO EOS-STRT-DTE-2.                 17010002
170200     MOVE PV-HOLD-EOS-END-DTE  TO EOS-END-DTE-2.                  17020002
170300                                                                  17030002
170400     WRITE EXCPT-EOS-PRECORR-DTE-REC                              17040002
170500         FROM EOS-DATE-REC-2.                                     17050002
170600                                                                  17060002
170700*----------------------------------------------------------       17070002
170800* 8160-WRITE-EOS-POSTCORR-DTE.                                    17080002
170900*----------------------------------------------------------       17090002
171000 8160-WRITE-EOS-POSTCORR-DTE.                                     17100002
171100                                                                  17110002
171200     MOVE PV-HOLD-EOS-STRT-DTE TO EOS-STRT-DTE-3.                 17120002
171300     MOVE PV-HOLD-EOS-END-DTE  TO EOS-END-DTE-3.                  17130002
171400                                                                  17140002
171500     WRITE EXCPT-EOS-POSTCORR-DTE-REC                             17150002
171600         FROM EOS-DATE-REC-3.                                     17160002
171700                                                                  17170002
171800*----------------------------------------------------------       17180002
171900* 8170-WRITE-EOS-POSTCORR-2-DTE.                                  17190002
172000*----------------------------------------------------------       17200002
172100 8170-WRITE-EOS-POSTCORR-2-DTE.                                   17210002
172200                                                                  17220002
172300     MOVE PV-HOLD-EOS-STRT-DTE TO EOS-STRT-DTE-4.                 17230002
172400     MOVE PV-HOLD-EOS-END-DTE  TO EOS-END-DTE-4.                  17240002
172500                                                                  17250002
172600     WRITE EXCPT-EOS-POSTCORR-DTE-REC-2                           17260002
172700         FROM EOS-DATE-REC-4.                                     17270002
172800                                                                  17280002
172900*----------------------------------------------------------       17290002
173000* 9000-WRITE-AD-EVNT.                                             17300002
173100*     WRITES THE AD EVNT ID TO FILE.                              17310002
173200*----------------------------------------------------------       17320002
173300 9000-WRITE-AD-EVNT.                                              17330002
173400                                                                  17340002
173500     EVALUATE TRUE                                                17350002
173600       WHEN PA-ADEVNT-CNT = 1                                     17360002
173700         WRITE EXCPT-ADEVNT-REC-1                                 17370002
173800             FROM PV-AD-EVNT-ID                                   17380002
173900       WHEN PA-ADEVNT-CNT = 2                                     17390002
174000         WRITE EXCPT-ADEVNT-REC-2                                 17400002
174100             FROM PV-AD-EVNT-ID                                   17410002
174200       WHEN PA-ADEVNT-CNT = 3                                     17420002
174300         WRITE EXCPT-ADEVNT-REC-3                                 17430002
174400             FROM PV-AD-EVNT-ID                                   17440002
174500       WHEN PA-ADEVNT-CNT = 4                                     17450002
174600         WRITE EXCPT-ADEVNT-REC-4                                 17460002
174700             FROM PV-AD-EVNT-ID                                   17470002
174800       WHEN PA-ADEVNT-CNT = 5                                     17480002
174900         WRITE EXCPT-ADEVNT-REC-5                                 17490002
175000             FROM PV-AD-EVNT-ID                                   17500002
175100       WHEN OTHER                                                 17510002
175200         DISPLAY 'TOO MANY AD EVENTS!!!'                          17520002
175300     END-EVALUATE.                                                17530002
175400                                                                  17540002
175500*----------------------------------------------------------       17550002
175600* 9100-WRITE-PROMO-INITIAL.                                       17560002
175700*     WRITES THE PROMO INITIAL RECORD TO FILE.                    17570002
175800*----------------------------------------------------------       17580002
175900 9100-WRITE-PROMO-INITIAL.                                        17590002
176000                                                                  17600002
176100     WRITE EXCPT-PROMO-INITIAL-REC                                17610002
176200         FROM PM114-PROMO-RPT-FILE.                               17620002
176300                                                                  17630002
176400     ADD 1 TO PA-PROMO-CNT.                                       17640002
176500                                                                  17650002
176600*----------------------------------------------------------       17660002
176700* 9200-WRITE-PROMO-PRECORR.                                       17670002
176800*     WRITES THE PROMO PRE-CORRECTION RECORD TO FILE.             17680002
176900*----------------------------------------------------------       17690002
177000 9200-WRITE-PROMO-PRECORR.                                        17700002
177100                                                                  17710002
177200     WRITE EXCPT-PROMO-PRECORR-REC                                17720002
177300         FROM PM114-PROMO-RPT-FILE.                               17730002
177400                                                                  17740002
177500     ADD 1 TO PA-PROMO-CNT.                                       17750002
177600                                                                  17760002
177700*----------------------------------------------------------       17770002
177800* 9300-WRITE-PROMO-POSTCORR.                                      17780002
177900*     WRITES THE PROMO POST-CORRECTION RECORD TO FILE.            17790002
178000*----------------------------------------------------------       17800002
178100 9300-WRITE-PROMO-POSTCORR.                                       17810002
178200                                                                  17820002
178300     WRITE EXCPT-PROMO-POSTCORR-REC                               17830002
178400         FROM PM114-PROMO-RPT-FILE.                               17840002
178500                                                                  17850002
178600     ADD 1 TO PA-PROMO-CNT.                                       17860002
178700                                                                  17870002
C09985*----------------------------------------------------------       17871036
C09985* 9310-WRITE-PROMO-POSTCORR-2.                                    17872036
C09985*     WRITES THE PROMO POST-CORRECTION RECORD TO FILE.            17873036
C09985*----------------------------------------------------------       17874036
C09985 9310-WRITE-PROMO-POSTCORR-2.                                     17875036
C09985                                                                  17876036
C09985     WRITE EXCPT-PROMO-POSTCORR-2-REC                             17877036
C09985         FROM PM114-PROMO-RPT-FILE.                               17878036
C09985                                                                  17879036
C09985     ADD 1 TO PA-PROMO-CNT.                                       17879136
C09985                                                                  17879236
C09985*----------------------------------------------------------       17879336
C09985* 9320-WRITE-PROMO-POSTCORR-3.                                    17879436
C09985*     WRITES THE PROMO POST-CORRECTION RECORD TO FILE.            17879536
C09985*----------------------------------------------------------       17879636
C09985 9320-WRITE-PROMO-POSTCORR-3.                                     17879736
C09985                                                                  17879836
C09985     WRITE EXCPT-PROMO-POSTCORR-3-REC                             17879936
C09985         FROM PM114-PROMO-RPT-FILE.                               17880036
C09985                                                                  17880136
C09985     ADD 1 TO PA-PROMO-CNT.                                       17880236
C09985                                                                  17880336
178800*----------------------------------------------------------       17881036
178900* 9400-WRITE-BOGOC-INITIAL.                                       17890002
179000*     WRITES THE BOGOC PRE-CORRECTION RECORD TO FILE.             17900002
179100*----------------------------------------------------------       17910002
179200 9400-WRITE-BOGOC-INITIAL.                                        17920002
179300                                                                  17930002
179400     WRITE EXCPT-BOGOC-INITIAL-REC                                17940002
179500         FROM PM114-PROMO-RPT-FILE.                               17950002
179600                                                                  17960002
179700*----------------------------------------------------------       17970002
179800* 9450-WRITE-BOGOO-INITIAL.                                       17980002
179900*     WRITES THE BOGOO PRE-CORRECTION RECORD TO FILE.             17990002
180000*----------------------------------------------------------       18000002
180100 9450-WRITE-BOGOO-INITIAL.                                        18010002
180200                                                                  18020002
180500     PERFORM S100-SELECT-BOGO-EXISTS.                             18050002
180600     IF PS-BOGO                                                   18060002
180800        WRITE EXCPT-BOGOO-INITIAL-REC                             18080002
180900            FROM PM115-PROMO-RPT-FILE                             18090002
181000                                                                  18100002
181100        MOVE PM115-PROMO-ID  TO PV-OVERLAP-PROMO-ID               18110002
181200        PERFORM S200-CHECK-OVERLAP-PROMOS                         18120002
181300                                                                  18130002
181400     END-IF.                                                      18140002
181500                                                                  18150002
181600*----------------------------------------------------------       18160002
181700* 9460-WRITE-OVERLAP-INITIAL.                                     18170002
181800*     WRITES THE OVERLAP PROMO TO THE FILE.                       18180002
181900*----------------------------------------------------------       18190002
182000 9460-WRITE-OVERLAP-INITIAL.                                      18200002
182100                                                                  18210002
182200     WRITE EXCPT-BOGOO-INITIAL-REC                                18220002
182300         FROM PM115-PROMO-RPT-FILE.                               18230002
182400                                                                  18240002
182500*----------------------------------------------------------       18250002
182600* 9500-WRITE-BOGOC-PRECORR.                                       18260002
182700*     WRITES THE BOGOC PRE-CORRECTION RECORD TO FILE.             18270002
182800*----------------------------------------------------------       18280002
182900 9500-WRITE-BOGOC-PRECORR.                                        18290002
183000                                                                  18300002
183100     WRITE EXCPT-BOGOC-PRECORR-REC                                18310002
183200         FROM PM114-PROMO-RPT-FILE.                               18320002
183300                                                                  18330002
183400*----------------------------------------------------------       18340002
183500* 9550-WRITE-BOGOO-PRECORR.                                       18350002
183600*     WRITES THE BOGOO PRE-CORRECTION RECORD TO FILE.             18360002
183700*----------------------------------------------------------       18370002
183800 9550-WRITE-BOGOO-PRECORR.                                        18380002
183900                                                                  18390002
184000     PERFORM S100-SELECT-BOGO-EXISTS.                             18400002
184100     IF PS-BOGO                                                   18410002
184200        WRITE EXCPT-BOGOO-PRECORR-REC                             18420002
184300            FROM PM115-PROMO-RPT-FILE                             18430002
184400                                                                  18440002
184500        MOVE PM115-PROMO-ID  TO PV-OVERLAP-PROMO-ID               18450002
184600        PERFORM S200-CHECK-OVERLAP-PROMOS                         18460002
184700                                                                  18470002
184800     END-IF.                                                      18480002
184900                                                                  18490002
185000*----------------------------------------------------------       18500002
185100* 9560-WRITE-OVERLAP-PRECORR.                                     18510002
185200*     WRITES THE OVERLAPPING PROMO TO THE FILE.                   18520002
185300*----------------------------------------------------------       18530002
185400 9560-WRITE-OVERLAP-PRECORR.                                      18540002
185500                                                                  18550002
185600      WRITE EXCPT-BOGOO-PRECORR-REC                               18560002
185700         FROM PM115-PROMO-RPT-FILE.                               18570002
185800                                                                  18580002
185900*----------------------------------------------------------       18590002
186000* 9600-WRITE-BOGOC-POSTCORR.                                      18600002
186100*     WRITES THE BOGOC POST-CORRECTION RECORD TO FILE.            18610002
186200*----------------------------------------------------------       18620002
186300 9600-WRITE-BOGOC-POSTCORR.                                       18630002
186400                                                                  18640002
186500     WRITE EXCPT-BOGOC-POSTCORR-REC                               18650002
186600         FROM PM114-PROMO-RPT-FILE.                               18660002
186700                                                                  18670002
186800*----------------------------------------------------------       18680002
186900* 9650-WRITE-BOGOO-POSTCORR.                                      18690002
187000*     WRITES THE BOGOO POST-CORRECTION RECORD TO FILE.            18700002
187100*----------------------------------------------------------       18710002
187200 9650-WRITE-BOGOO-POSTCORR.                                       18720002
187300                                                                  18730002
187400     PERFORM S100-SELECT-BOGO-EXISTS.                             18740002
187500     IF PS-BOGO                                                   18750002
187600        WRITE EXCPT-BOGOO-POSTCORR-REC                            18760002
187700            FROM PM115-PROMO-RPT-FILE                             18770002
187800                                                                  18780002
187900        MOVE PM115-PROMO-ID  TO PV-OVERLAP-PROMO-ID               18790002
188000        PERFORM S200-CHECK-OVERLAP-PROMOS                         18800002
188100                                                                  18810002
188200     END-IF.                                                      18820002
188300                                                                  18830002
188400*----------------------------------------------------------       18840002
188500* 9660-WRITE-OVERLAP-POSTCORR.                                    18850002
188600*     WRITES THE OVERLAPPING PROMO TO THE FILE.                   18860002
188700*----------------------------------------------------------       18870002
188800 9660-WRITE-OVERLAP-POSTCORR.                                     18880002
188900                                                                  18890002
189000      WRITE EXCPT-BOGOO-POSTCORR-REC                              18900002
189100         FROM PM115-PROMO-RPT-FILE.                               18910002
189200                                                                  18920002
189300*----------------------------------------------------------       18930002
189400* 9660-WRITE-BOGOO-POSTCORR-2.                                    18940002
189500*     WRITES THE BOGOO POST-CORRECTION RECORD TO FILE.            18950002
189600*----------------------------------------------------------       18960002
189700 9660-WRITE-BOGOO-POSTCORR-2.                                     18970002
189800                                                                  18980002
189900     PERFORM S100-SELECT-BOGO-EXISTS.                             18990002
190000     IF PS-BOGO                                                   19000002
190100        WRITE EXCPT-BOGOO-POSTCORR-2-REC                          19010002
190200            FROM PM115-PROMO-RPT-FILE                             19020002
190300                                                                  19030002
190400        MOVE PM115-PROMO-ID  TO PV-OVERLAP-PROMO-ID               19040002
190500        PERFORM S200-CHECK-OVERLAP-PROMOS                         19050002
190600                                                                  19060002
190700     END-IF.                                                      19070002
190800                                                                  19080002
190900*----------------------------------------------------------       19090002
191000* 9670-WRITE-OVERLAP-POSTCORR-2.                                  19100002
191100*     WRITES THE OVERLAPPING PROMO TO THE FILE.                   19110002
191200*----------------------------------------------------------       19120002
191300 9670-WRITE-OVERLAP-POSTCORR-2.                                   19130002
191400                                                                  19140002
191500     WRITE EXCPT-BOGOO-POSTCORR-2-REC                             19150002
191600         FROM PM115-PROMO-RPT-FILE.                               19160002
191700                                                                  19170002
W37986*----------------------------------------------------------       19171032
W37986* 9680-WRITE-KIOSK-POSTCORR-2.                                    19172032
W37986*     WRITES KIOSK PROMO TO THE FILE.                             19173032
W37986*----------------------------------------------------------       19174032
W37986 9680-WRITE-KIOSK-POSTCORR-2.                                     19175032
W37986                                                                  19176032
W37986     WRITE KIOSK-POST-CORR2-REC                                   19178032
W37986         FROM PM114-PROMO-RPT-FILE.                               19179032
W37986                                                                  19179132
C09985*----------------------------------------------------------       19179236
C09885* 9690-WRITE-BOGOO-POSTCORR-3.                                    19179336
C09985*     WRITES THE BOGOO POST-CORRECTION RECORD TO FILE.            19179436
C09985*----------------------------------------------------------       19179536
C09985 9690-WRITE-BOGOO-POSTCORR-3.                                     19179636
C09985                                                                  19179736
C09985     PERFORM S100-SELECT-BOGO-EXISTS.                             19179839
C09985     IF PS-BOGO                                                   19179936
C09985        WRITE EXCPT-BOGOO-POSTCORR-3-REC                          19180039
C09985            FROM PM115-PROMO-RPT-FILE                             19180139
C09985                                                                  19180236
C09985        MOVE PM115-PROMO-ID  TO PV-OVERLAP-PROMO-ID               19180336
C09985        PERFORM S200-CHECK-OVERLAP-PROMOS                         19180439
C09985                                                                  19180536
C09985     END-IF.                                                      19180636
C09985                                                                  19180736
C09985*----------------------------------------------------------       19180839
C09985* 9695-WRITE-OVERLAP-POSTCORR-3.                                  19180939
C09985*     WRITES THE OVERLAPPING PROMO TO THE FILE.                   19181039
C09985*----------------------------------------------------------       19181139
C09985 9695-WRITE-OVERLAP-POSTCORR-3.                                   19181239
C09985                                                                  19181339
C09985     WRITE EXCPT-BOGOO-POSTCORR-3-REC                             19181439
C09985         FROM PM115-PROMO-RPT-FILE.                               19181539
C09985                                                                  19181639
191800*----------------------------------------------------------       19182002
191900* 9700-WRITE-DTE-FILES.                                           19190002
192000*     WRITES THE 3 DATE FILES FOR THE BOGO COMPARE REPORT         19200002
192100*----------------------------------------------------------       19210002
192200 9700-WRITE-DTE-FILES.                                            19220002
192300                                                                  19230002
192400     IF PV-PROMO-STRT-TMST-SAVED-1 NOT EQUAL SPACES               19240002
192500       MOVE PV-PROMO-STRT-TMST-SAVED-1 TO PV-SAVE-INIT-STRT-DTE   19250002
192600       MOVE PV-SAVE-INIT-STRT-CCYY TO PV-HOLD-INIT-STRT-CCYY      19260002
192700       MOVE PV-SAVE-INIT-STRT-MM   TO PV-HOLD-INIT-STRT-MM        19270002
192800       MOVE PV-SAVE-INIT-STRT-DD   TO PV-HOLD-INIT-STRT-DD        19280002
192900       MOVE PV-HOLD-INIT-STRT-DTE  TO DT-STRT-DTE-1               19290002
193000                                                                  19300002
193100       MOVE PV-PROMO-END-TMST-SAVED-1  TO PV-SAVE-INIT-END-DTE    19310002
193200       MOVE PV-SAVE-INIT-END-CCYY TO PV-HOLD-INIT-END-CCYY        19320002
193300       MOVE PV-SAVE-INIT-END-MM   TO PV-HOLD-INIT-END-MM          19330002
193400       MOVE PV-SAVE-INIT-END-DD   TO PV-HOLD-INIT-END-DD          19340002
193500       MOVE PV-HOLD-INIT-END-DTE  TO DT-END-DTE-1                 19350002
193600                                                                  19360002
193700       WRITE EXCPT-BOGOC-INITIAL-DT-REC FROM DATE-REC-1           19370002
193800     END-IF.                                                      19380002
193900                                                                  19390002
194000     IF PV-PROMO-STRT-TMST-SAVED-2 NOT EQUAL SPACES               19400002
194100       MOVE PV-PROMO-STRT-TMST-SAVED-2 TO PV-SAVE-PRE-STRT-DTE    19410002
194200       MOVE PV-SAVE-PRE-STRT-CCYY TO PV-HOLD-PRE-STRT-CCYY        19420002
194300       MOVE PV-SAVE-PRE-STRT-MM   TO PV-HOLD-PRE-STRT-MM          19430002
194400       MOVE PV-SAVE-PRE-STRT-DD   TO PV-HOLD-PRE-STRT-DD          19440002
194500       MOVE PV-HOLD-PRE-STRT-DTE  TO DT-STRT-DTE-2                19450002
194600                                                                  19460002
194700       MOVE PV-PROMO-END-TMST-SAVED-2  TO PV-SAVE-PRE-END-DTE     19470002
194800       MOVE PV-SAVE-PRE-END-CCYY TO PV-HOLD-PRE-END-CCYY          19480002
194900       MOVE PV-SAVE-PRE-END-MM   TO PV-HOLD-PRE-END-MM            19490002
195000       MOVE PV-SAVE-PRE-END-DD   TO PV-HOLD-PRE-END-DD            19500002
195100       MOVE PV-HOLD-PRE-END-DTE  TO DT-END-DTE-2                  19510002
195200                                                                  19520002
195300       WRITE EXCPT-BOGOC-PRECORR-DT-REC FROM DATE-REC-2           19530002
195400     END-IF.                                                      19540002
195500                                                                  19550002
195600     IF PV-PROMO-STRT-TMST-SAVED-3 NOT EQUAL SPACES               19560002
195700       MOVE PV-PROMO-STRT-TMST-SAVED-3 TO PV-SAVE-INIT-STRT-DTE   19570002
195800       MOVE PV-SAVE-INIT-STRT-CCYY TO PV-HOLD-INIT-STRT-CCYY      19580002
195900       MOVE PV-SAVE-INIT-STRT-MM   TO PV-HOLD-INIT-STRT-MM        19590002
196000       MOVE PV-SAVE-INIT-STRT-DD   TO PV-HOLD-INIT-STRT-DD        19600002
196100       MOVE PV-HOLD-INIT-STRT-DTE  TO DT-STRT-DTE-3               19610002
196200                                                                  19620002
196300       MOVE PV-PROMO-END-TMST-SAVED-3  TO PV-SAVE-POST-END-DTE    19630002
196400       MOVE PV-SAVE-POST-END-CCYY TO PV-HOLD-POST-END-CCYY        19640002
196500       MOVE PV-SAVE-POST-END-MM   TO PV-HOLD-POST-END-MM          19650002
196600       MOVE PV-SAVE-POST-END-DD   TO PV-HOLD-POST-END-DD          19660002
196700       MOVE PV-HOLD-POST-END-DTE  TO DT-END-DTE-3                 19670002
196800                                                                  19680002
196900       WRITE EXCPT-BOGOC-POSTCORR-DT-REC FROM DATE-REC-3          19690002
197000     END-IF.                                                      19700002
197100                                                                  19710002
197200                                                                  19720002
197300*---------------------------------------------------------------  19730002
197400* S100-SELECT-BOGO-EXISTS                                         19740002
197500*---------------------------------------------------------------  19750002
197600 S100-SELECT-BOGO-EXISTS.                                         19760002
197700                                                                  19770002
197800     EXEC SQL                                                     19780002
197900          SELECT  1                                               19790002
198000           INTO :PV-DUAL-ONE                                      19800002
198100           FROM  DUAL                                             19810002
198200          WHERE  EXISTS                                           19820002
198300          (SELECT 1                                               19830002
198400             FROM PMT_PROMO_ITM                                   19840002
198500            WHERE PROMO_ID            = :PM115-PROMO-ID           19850002
198600              AND PRICG_STRGY_TYP_CDE IN ('BG', 'BP')             19860002
198700              AND STAT_CDE            = 'S')                      19870002
198800     END-EXEC.                                                    19880002
198900                                                                  19890002
199000     EVALUATE TRUE                                                19900002
199100       WHEN SQLCODE = ZEROES                                      19910002
199200            SET PS-BOGO TO TRUE                                   19920002
199300       WHEN SQLCODE = 1403                                        19930002
199400            SET PS-NOT-BOGO TO TRUE                               19940002
199500            CONTINUE                                              19950002
199600       WHEN OTHER                                                 19960002
199700            SET PS-NOT-BOGO TO TRUE                               19970002
199900            MOVE SQLCODE     TO PV-SQL-CODE                       19990002
200000            SET ABEND-4013-SQL-ERROR TO TRUE                      20000002
200100            MOVE 'PMT_PROMO_ITM' TO PV-TABLE-NAME                 20010002
200200            MOVE 'S100-SELECT-DEPT-BOGO-EXISTS'                   20020002
200300                                       TO PV-PARAGRAPH-NAME       20030002
200400            MOVE 'ERROR ON SELECT EXISTS'                         20040002
200500                                       TO PV-OPERATION-MSG-1      20050002
200600            PERFORM Z100-ABEND                                    20060002
200700     END-EVALUATE.                                                20070002
200800                                                                  20080002
200900*---------------------------------------------------------------  20090002
201000* S200-CHECK-OVERLAP-PROMOS                                       20100002
201100*---------------------------------------------------------------  20110002
201200 S200-CHECK-OVERLAP-PROMOS.                                       20120002
201300                                                                  20130002
201400     PERFORM 2040-OPEN-OVERLAP-CSR.                               20140002
201500     PERFORM 2100-PROCESS-OVERLAP-CSR                             20150002
201600        UNTIL PS-END-OF-OVERLAP-CSR.                              20160002
201700     PERFORM 2060-CLOSE-OVERLAP-CSR.                              20170002
201800                                                                  20180002
201900*---------------------------------------------------------------  20190002
202000* T100-PROMO-ABBRV-LOOKUP                                         20200002
202100*---------------------------------------------------------------  20210002
202200 T100-PROMO-ABBRV-LOOKUP.                                         20220002
202300                                                                  20230002
202400     SET PS-EOS-NOT-FOUND    TO TRUE.                             20240002
202500     SET PV-ABBRV-INDX       TO 1.                                20250002
202600                                                                  20260002
202700     SEARCH PV-PROMO-ABBRV-TABLE                                  20270002
202800***     VARYING PV-ABBRV-INDX                                     20280002
202900        AT END                                                    20290002
203000           SET PS-EOS-NOT-FOUND    TO TRUE                        20300002
203100        WHEN PV-PROMO-ABBRV (PV-ABBRV-INDX)                       20310002
203200                             = PV-PROMO-ABBR-NM                   20320002
203300           SET PS-EOS-FOUND        TO TRUE                        20330002
203400     END-SEARCH.                                                  20340002
203500                                                                  20350002
203600*----------------------------------------------------------       20360002
203700* 9800-ABEND.                                                     20370002
203800*     PERFORMS A NON-SQL-ABEND.                                   20380002
203900*----------------------------------------------------------       20390002
204000 9800-ABEND.                                                      20400002
204100                                                                  20410002
204200     DISPLAY '** ABEND           **'.                             20420002
204300     DISPLAY '** PROGRAM         ** = ' PC-CURRENT-PROGRAM-NAME.  20430055
204400     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        20440002
204500     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG.         20450002
204600     DISPLAY '**                 ** = ' PV-OPERATION-MSG-1.       20460002
204700                                                                  20470002
204800     CALL 'ILBOABN0' USING ABEND-CODE.                            20480002
204900                                                                  20490002
205000*9800-EXIT.                                                       20500002
205100 EJECT.                                                           20510002
205200                                                                  20520002
205300*----------------------------------------------------------       20530002
205400* 9900-ORACLE-ABEND.                                              20540002
205500*     PERFORM AN ABEND THAT OCCURED RELATED TO ORACLE.            20550002
205600*----------------------------------------------------------       20560002
205700 9900-ORACLE-ABEND.                                               20570002
205800                                                                  20580002
205900     DISPLAY '                       '.                           20590002
206000     DISPLAY '** ABEND **       ** = SQLERROR'.                   20600002
206100     DISPLAY '** PROGRAM        ** = ' PC-CURRENT-PROGRAM-NAME.   20610055
206200     DISPLAY '** SQLCODE        ** = ' PV-SQL-CODE.               20620002
206300     DISPLAY '** ABEND CODE     ** = ' ABEND-CODE.                20630002
206400     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   20640002
206500     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  20650002
206600     DISPLAY '** SQLERRD(5)     ** = ' SQLERRD(5).                20660002
206700     DISPLAY '** PARAGRAPH      ** = ' PV-PARAGRAPH-NAME.         20670002
206800     DISPLAY '** TABLE          ** = ' PV-TABLE-NAME.             20680002
206900     DISPLAY '** OPERATION      ** = ' PV-OPERATION-MSG.          20690002
207000     DISPLAY '                       '.                           20700002
207100                                                                  20710002
207200     CALL 'ILBOABN0' USING ABEND-CODE.                            20720002
207300                                                                  20730002
207400*9900-EXIT.                                                       20740002
207500 EJECT.                                                           20750002
207600                                                                  20760002
207700***************************************************************** 20770002
207800* Z100-ABEND                                                    * 20780002
207900*  - PERFORM AN ABEND THAT OCCURED RELATED TO ORACLE            * 20790002
208000*  - CALLED BY PMPD700!                                         * 20800002
208100***************************************************************** 20810002
208200 Z100-ABEND.                                                      20820002
208300                                                                  20830002
208400     DISPLAY '                       '.                           20840002
208500     DISPLAY '** ABEND **       ** = SQLERROR'.                   20850002
208600     DISPLAY '** PROGRAM        ** = ' PC-CURRENT-PROGRAM-NAME.   20860055
208700     DISPLAY '** SQLCODE        ** = ' SQLCODE.                   20870002
208800     DISPLAY '** ABEND CODE     ** = ' ABEND-CODE.                20880002
208900     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   20890002
209000     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  20900002
209100     DISPLAY '** SQLERRD(5)     ** = ' SQLERRD(5).                20910002
209200     DISPLAY '** PARAGRAPH      ** = ' PV-PARAGRAPH-NAME.         20920002
209300     DISPLAY '** TABLE          ** = ' PV-TABLE-NAME.             20930002
209400     DISPLAY '** OPERATION      ** = ' PV-OPERATION-MSG.          20940002
209500     DISPLAY '                       '.                           20950002
209600                                                                  20960002
209700     CALL 'ILBOABN0' USING ABEND-CODE.                            20970002
209800                                                                  20980002
209900*----------------------------------------------------------       20990002
210000* 9999-WRAPUP.                                                    21000002
210100*     END OF PROGRAM ROUTINE.  CLOSES ALL FILES AND DISPLAYS      21010002
210200*     ANY DATA FROM THE PROGRAM.                                  21020002
210300*----------------------------------------------------------       21030002
210400 9999-WRAPUP.                                                     21040002
210500                                                                  21050002
210600     CLOSE CONTROL-CARD-FILE                                      21060002
210700           PROMO-BEGIN-FILE                                       21070002
210800           EOS-TYPE-FILE                                          21080002
210900           EXCPT-ADEVNT-FILE-1                                    21090002
211000           EXCPT-ADEVNT-FILE-2                                    21100002
211100           EXCPT-ADEVNT-FILE-3                                    21110002
211200           EXCPT-ADEVNT-FILE-4                                    21120002
211300           EXCPT-ADEVNT-FILE-5                                    21130002
211400           EXCPT-PROMO-INITIAL-FILE                               21140002
211500           EXCPT-PROMO-PRECORR-FILE                               21150002
211600           EXCPT-PROMO-POSTCORR-FILE                              21160002
211700           EXCPT-BOGOC-INITIAL-FILE                               21170002
211800           EXCPT-BOGOC-PRECORR-FILE                               21180002
211900           EXCPT-BOGOC-POSTCORR-FILE                              21190002
212000           EXCPT-BOGOC-INITIAL-DT-FILE                            21200002
212100           EXCPT-BOGOC-PRECORR-DT-FILE                            21210002
212200           EXCPT-BOGOC-POSTCORR-DT-FILE                           21220002
212300           EXCPT-BOGOO-INITIAL-FILE                               21230002
212400           EXCPT-BOGOO-PRECORR-FILE                               21240002
212500           EXCPT-BOGOO-POSTCORR-FILE                              21250002
212600           EXCPT-BOGOO-POSTCORR-FILE-2                            21260002
212700           EXCPT-EOS-INITIAL-FILE                                 21270002
212800           EXCPT-EOS-PRECORR-FILE                                 21280002
212900           EXCPT-EOS-POSTCORR-FILE                                21290002
213000           EXCPT-EOS-POSTCORR-FILE-2                              21300002
213100           EXCPT-EOS-INITIAL-DTE-FILE                             21310002
213200           EXCPT-EOS-PRECORR-DTE-FILE                             21320002
213300           EXCPT-EOS-POSTCORR-DTE-FILE                            21330002
213400           EXCPT-EOS-POSTCORR-DTE-FILE-2                          21340002
213500           EXCPT-PAR-INITIAL-FILE                                 21350002
213600           EXCPT-PAR-PRECORR-FILE                                 21360002
C09985*          EXCPT-PAR-POSTCORR-FILE.                               21370045
C09985           EXCPT-PAR-POSTCORR-FILE                                21370149
C09985           EXCPT-PROMO-POSTCORR-FILE-2                            21371045
C09985           EXCPT-PROMO-POSTCORR-FILE-3                            21372045
C09985           EXCPT-BOGOO-POSTCORR-FILE-3.                           21373045
213800                                                                  21380002
213900     DISPLAY ' '.                                                 21390002
214000     DISPLAY '*********************************************'.     21400002
214100     DISPLAY 'PROGRAM NAME: ' PC-CURRENT-PROGRAM-NAME.            21410055
214200     DISPLAY '*********************************************'.     21420002
214300     DISPLAY 'NUMBER OF ADEVENTS: ' PA-ADEVNT-CNT.                21430002
214400     DISPLAY 'NUMBER OF NON-MAIN PROMOS: ' PA-PROMO-CNT.          21440002
214500     DISPLAY '*********************************************'.     21450002
214600                                                                  21460002
214700*9999-EXIT.                                                       21470002
214800 EJECT.                                                           21480002
214900                                                                  21490002
