000100 IDENTIFICATION DIVISION.                                         00010005
000200 PROGRAM-ID.    RCKCS298.                                         00020005
000300 AUTHOR.        DENNIS STEFFEN - OMNI RESOURCES.                  00030005
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040005
000500 DATE-WRITTEN.  JULY  1998.                                       00050005
000600 DATE-COMPILED.                                                   00060005
000700                                                                  00070005
000800*---------------------------------------------------------------* 00080005
000900*    E298 - FULLCASE QUANTITY STORE UPDATE LIST                   00090005
001000*                                                                 00100005
001100*    THIS PROGRAM GENERATES A LIST OF STORES FOR A GIVEN          00110005
001200*     PO/RECEIVER/LINE.  THE USER WILL BE ABLE TO UPDATE THE      00120005
001300*    FULLCASE PROCESS QUANTITIES IF THE LINE IS NOT YET VERIFIED. 00130005
001400*                                                                 00140005
001410*  CHANGED 10/20/14 BY CHERI PARMLEY       CHG#0094571            00141058
001420*   EXPAND PO FROM 7 TO 8 DIGITS                                  00142038
001500*---------------------------------------------------------------* 00150005
001520* CHANGED 11/11/2021    BY JIM HUNTER      WR: CHG0263784         00152058
001530* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00153058
001540* MAKING THE CALL DYNAMIC VS STATIC.                              00154058
001550*---------------------------------------------------------------* 00155058
001600                                                                  00160005
001700 ENVIRONMENT DIVISION.                                            00170005
001800 DATA DIVISION.                                                   00180005
001900                                                                  00190005
002000 WORKING-STORAGE SECTION.                                         00200005
002100                                                                  00210005
002200 01  DK-DB2-KEYS.                                                 00220005
002300     05  DK-OPER-UNT-ID               PIC S9(04) COMP.            00230005
002400     05  DK-FCLTY-ID                  PIC S9(04) COMP.            00240005
002500     05  DK-ORD-NBR                   PIC S9(09) COMP.            00250005
002600     05  DK-RCVR-NBR                  PIC S9(09) COMP.            00260005
002700     05  DK-LINE-NBR                  PIC S9(09) COMP.            00270005
002800     05  DK-DRIVER-LINE-NBR           PIC S9(09) COMP.            00280005
002900     05  DK-DMG-LINE-NBR              PIC S9(09) COMP.            00290005
003000     05  DK-STR-NBR                   PIC S9(04) COMP.            00300005
003100     05  DK-PACK-ID                   PIC S9(04) COMP.            00310005
003200     05  DK-PK-SKU-NBR                PIC S9(8)V COMP-3.          00320005
003300                                                                  00330005
003400 01  PC-PROGRAM-CONSTANTS.                                        00340005
003500     05  PC-CURRENT-MAP-NAME          PIC X(08)  VALUE            00350005
003600                                                    'RC298A  '.   00360005
003700     05  PC-CURRENT-MAPSET-NAME       PIC X(08)  VALUE            00370005
003800                                                    'RCKM298 '.   00380005
003900     05  PC-CURRENT-PROGRAM-NAME      PIC X(08)  VALUE            00390005
004000                                                    'RCKCS298'.   00400005
004100     05  PC-LIST-QUEUE-SEQ            PIC 9(01)  VALUE 1.         00410005
004200     05  PC-SEL-QUEUE-SEQ             PIC 9(01)  VALUE 2.         00420005
004300     05  PC-CRIT-SPEC-FORMAT          PIC  X(01)  VALUE '2'.      00430005
004400     05  PC-LIST-FORMAT               PIC  X(01)  VALUE '1'.      00440005
004500     05  PC-ITEMS-PER-PANEL           PIC S9(04)  VALUE +09       00450005
004600                                                    COMP SYNC.    00460005
004700     05  PC-MAX-BLOCKS-IN-ARRAY       PIC S9(04)  VALUE +2        00470005
004800                                                    COMP SYNC.    00480005
004900     05  PC-MAX-ITEMS                 PIC S9(09)  VALUE           00490005
005000                                                    +1000000      00500005
005100                                                    COMP-3.       00510005
005200     05  PC-MSG-NUMBER-LENGTH         PIC S9(04)  VALUE +7        00520005
005300                                                    COMP SYNC.    00530005
005400     05  PC-INQ                       PIC X(03)  VALUE 'INQ'.     00540005
005500     05  PC-UPD                       PIC X(03)  VALUE 'UPD'.     00550005
005600     05  PC-DEL                       PIC X(03)  VALUE 'DEL'.     00560005
005700     05  PC-ERR                       PIC X(03)  VALUE 'ERR'.     00570005
005800     05  PC-SPACES                    PIC X(22)  VALUE SPACES.    00580005
005900     05  PC-M                         PIC X(01)  VALUE 'M'.       00590005
006000     05  PC-DISPLAY-PO                PIC 9(8)   VALUE ZEROS.     00600005
006100     05  PC-DISPLAY-RCVR              PIC 9(8)   VALUE ZEROS.     00610005
006200     05  PC-DISPLAY-LINE              PIC 9(8)   VALUE ZEROS.     00620005
006300     05  PC-DISPLAY-OPER              PIC 9(4)   VALUE ZEROS.     00630005
006400     05  PC-DISPLAY-SIGNON            PIC 9(4)   VALUE ZEROS.     00640005
006500     05  PC-DISPLAY-SQL-CODE          PIC 9999-  VALUE ZEROS.     00650005
006600     05  PC-DISPLAY-CICS-RESP         PIC 999999999-              00660005
006700                                                 VALUE ZEROS.     00670005
006800     05  PC-FKEY-MODULE               PIC X(08) VALUE 'RCKUT126'. 00680005
006900     05  PC-AUTO-VE-MODULE            PIC X(08) VALUE 'RCKUT127'. 00690005
007000     05  PC-FKEY-MODULE-LENGTH        PIC S9(04) VALUE  +400      00700005
007100                                                    COMP SYNC.    00710005
007200                                                                  00720005
007300*----------------------------------------------------------------*00730005
007400*  SYSTEM MESSAGES                                               *00740005
007500*----------------------------------------------------------------*00750005
007600*   00005 = INVALID VALUE                                         00760005
007700*   00007 = REQUIRED ENTRY                                        00770005
007800*   00008 = MUST BE NUMERIC                                       00780005
007900*   00050 = NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED   00790005
008000*   00051 = NO END OF RANGE HAS BEEN SPECIFIED                    00800005
008100*   00052 = END OF RANGE PRECEDES START OF RANGE                  00810005
008200*   00053 = NO START OF RANGE HAS BEEN SPECIFIED                  00820005
008300*   00054 = ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED    00830005
008400*   00055 = ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED      00840005
008500*   00057 = A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION        00850005
008600*   00059 = UPDATE(S) SUCCESSFUL                                  00860005
008700*   00069 = TOP OF LIST                                           00870005
008800*   00070 = BOTTOM OF LIST                                        00880005
008900*   00101 = VALUE MUST BE GREATER THAN ZERO AND LESS THAN 1,000,0000890005
009000*   00279 = MORE ITEMS TO DISPLAY                                 00900005
009100*   00551 = WAIT 15 SECONDS;RETRY FUNCTION AGAIN; IF UNSUCCESSFUL 00910005
009200*   00966 = INVALID FUNCTION FOR RECEIVER/RECEIPT ITEM STATUS     00920005
009300*   00984 = DATABASE IS BUSY, TRY AGAIN IN A FEW MINUTES          00930005
009400*   01783 = UPDATE QUANTITY NOT A MULTIPLE OF THE OUTER PACK      00940005
009500*   01784 = UPDATE QUANTITY NOT A MULTIPLE OF THE INNER PACK      00950005
009600*   02875 = PROBLEM ENCOUNTED WITH UNITS WORKED PROCESSING - CONTA00960005
009700*   03135 = YOU DO NOT HAVE THE AUTHORITY TO PERFORM MANUAL CONFIR00970005
009800*   03136 = YOU DO NOT HAVE THE AUTHORITY TO PERFORM MANUAL CONFIR00980005
009900*   03137 = YOU DO NOT HAVE THE AUTHORITY TO UPDATE CONFIRMATION  00990005
010000*   03138 = AN ERROR OCCURRED DETERMINING F-KEY ELIGIBILITY - CONT01000005
010100*   99901 = INVALID COMMAND WAS ENTERED                           01010005
010200*----------------------------------------------------------------*01020005
010300     05  PC-TSYMSG-NUMBERS.                                       01030005
010400         10  PC-TSYMSG-00005          PIC 9(05)  VALUE 00005.     01040005
010500         10  PC-TSYMSG-00007          PIC 9(05)  VALUE 00007.     01050005
010600         10  PC-TSYMSG-00008          PIC 9(05)  VALUE 00008.     01060005
010700         10  PC-TSYMSG-00050          PIC 9(05)  VALUE 00050.     01070005
010800         10  PC-TSYMSG-00051          PIC 9(05)  VALUE 00051.     01080005
010900         10  PC-TSYMSG-00052          PIC 9(05)  VALUE 00052.     01090005
011000         10  PC-TSYMSG-00053          PIC 9(05)  VALUE 00053.     01100005
011100         10  PC-TSYMSG-00054          PIC 9(05)  VALUE 00054.     01110005
011200         10  PC-TSYMSG-00055          PIC 9(05)  VALUE 00055.     01120005
011300         10  PC-TSYMSG-00057          PIC 9(05)  VALUE 00057.     01130005
011400         10  PC-TSYMSG-00059          PIC 9(05)  VALUE 00059.     01140005
011500         10  PC-TSYMSG-00069          PIC 9(05)  VALUE 00069.     01150005
011600         10  PC-TSYMSG-00070          PIC 9(05)  VALUE 00070.     01160005
011700         10  PC-TSYMSG-00101          PIC 9(05)  VALUE 00101.     01170005
011800         10  PC-TSYMSG-00279          PIC 9(05)  VALUE 00279.     01180005
011900         10  PC-TSYMSG-00551          PIC 9(05)  VALUE 00551.     01190005
012000         10  PC-TSYMSG-00966          PIC 9(05)  VALUE 00966.     01200005
012100         10  PC-TSYMSG-00984          PIC 9(05)  VALUE 00984.     01210005
012200         10  PC-TSYMSG-01783          PIC 9(05)  VALUE 01783.     01220005
012300         10  PC-TSYMSG-01784          PIC 9(05)  VALUE 01784.     01230005
012400         10  PC-TSYMSG-00736          PIC 9(05)  VALUE 00736.     01240005
012500         10  PC-TSYMSG-01298          PIC 9(05)  VALUE 01298.     01250005
012600         10  PC-TSYMSG-02463          PIC 9(05)  VALUE 02463.     01260005
012700         10  PC-TSYMSG-02475          PIC 9(05)  VALUE 02475.     01270005
012800         10  PC-TSYMSG-02875          PIC 9(05)  VALUE 02875.     01280005
012900         10  PC-TSYMSG-03135          PIC 9(05)  VALUE 03135.     01290005
013000         10  PC-TSYMSG-03136          PIC 9(05)  VALUE 03136.     01300005
013100         10  PC-TSYMSG-03137          PIC 9(05)  VALUE 03137.     01310005
013200         10  PC-TSYMSG-03138          PIC 9(05)  VALUE 03138.     01320005
013300         10  PC-TSYMSG-03302          PIC 9(05)  VALUE 03302.     01330005
013400         10  PC-TSYMSG-99901          PIC 9(05)  VALUE 99901.     01340005
013500     05  PC-DEFAULT-TMST              PIC X(26)  VALUE            01350005
013600                     '9999-09-09-09.09.09.999999'.                01360005
013700     05  PC-DEFAULT-DATE              PIC X(10)  VALUE            01370005
013800                     '09/09/9999'.                                01380005
013900                                                                  01390005
014000*----------------------------------------------------------------*01400005
014100* INCLUDED PROGRAM CONSTANTS PC-000 AND PC-999.      WR # 21361  *01410005
014200*----------------------------------------------------------------*01420005
014300     05  PC-000                       PIC X(03) VALUE '000'.      01430005
014400     05  PC-999                       PIC X(03) VALUE '999'.      01440005
014500*----------------------------------------------------------------*01450005
014600* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *01460005
014700*----------------------------------------------------------------*01470005
014800 01  PS-PROGRAM-SWITCHES.                                         01480005
014900     05  PS-FUNTION-RACF-SW           PIC X(01)  VALUE 'N'.       01490005
015000         88  PS-FUNCTION-RACF-YES                VALUE 'Y'.       01500005
015100         88  PS-FUNCTION-RACF-NO                 VALUE 'N'.       01510005
015200     05  PS-ERROR-SW                  PIC X(01)  VALUE 'Y'.       01520005
015300         88  PS-NO-ERROR                            VALUE 'Y'.    01530005
015400         88  PS-ERROR                               VALUE 'N'.    01540005
015500     05  PS-LIST-END-SW               PIC  X(01) VALUE  'N'.      01550005
015600         88  PS-LIST-END                            VALUE  'Y'.   01560005
015700         88  PS-NO-LIST-END                         VALUE  'N'.   01570005
015800     05  PS-COMMAREA-SW               PIC X(01)  VALUE 'N'.       01580005
015900         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01590005
016000         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01600005
016100     05  PS-NEXT-SCREEN-SW            PIC X(01)  VALUE 'N'.       01610005
016200         88  PS-NO-NEXT-SCREEN                  VALUE 'N'.        01620005
016300         88  PS-NEXT-SCREEN                     VALUE 'Y'.        01630005
016400     05  PS-EOF-INVPAR-CSR-SW         PIC X(01)  VALUE 'N'.       01640005
016500         88   PS-NOT-EOF-INVPAR-CSR              VALUE 'N'.       01650005
016600         88   PS-EOF-INVPAR-CSR                  VALUE 'Y'.       01660005
016700     05  PS-EOF-TDISTDT-CSR-SW        PIC X(01)  VALUE 'N'.       01670005
016800         88  PS-NOT-EOF-TDISTDT-CSR              VALUE 'N'.       01680005
016900         88  PS-EOF-TDISTDT-CSR                  VALUE 'Y'.       01690005
017000     05  PS-MORE-RECITM-SW            PIC X(01)  VALUE 'N'.       01700005
017100         88  PS-MORE-RECITM-YES                  VALUE 'Y'.       01710005
017200         88  PS-MORE-RECITM-NO                   VALUE 'N'.       01720005
017300     05  PS-TDISTDT-UPDATE-SW         PIC X(01)  VALUE 'N'.       01730005
017400         88  PS-TDISTDT-UPDATE-DONE              VALUE 'Y'.       01740005
017500         88  PS-TDISTDT-UPDATE-NOT-DONE          VALUE 'N'.       01750005
017600     05  PS-UNITS-WORKED-ERROR-SW     PIC X(01)  VALUE 'N'.       01760005
017700         88  PS-UNITS-WORKED-ERROR               VALUE 'Y'.       01770005
017800         88  PS-NO-UNITS-WORKED-ERROR            VALUE 'N'.       01780005
017900     05  PS-FIRST-TIME-UPDATE-SW      PIC X(01)  VALUE 'Y'.       01790005
018000         88 PS-FIRST-TIME-UPDATE                 VALUE 'Y'.       01800005
018100         88 PS-NOT-FIRST-TIME-UPDATE             VALUE 'N'.       01810005
018200     05  PS-PRE-PACK-SW               PIC X(01)  VALUE 'N'.       01820005
018300         88 PS-PRE-PACK                          VALUE 'Y'.       01830005
018400         88 PS-NOT-PRE-PACK                      VALUE 'N'.       01840005
018410     05  PS-DC-FLUSH-SW              PIC  X(01)  VALUE  'Y'.      01841033
018420         88  PS-DC-FLUSH-YES                     VALUE  'Y'.      01842029
018430         88  PS-DC-FLUSH-NO                      VALUE  'N'.      01843029
018500                                                                  01850005
018600*  LINE LEVEL SWITCHES                                            01860005
018700     05  PS-MATCH-ERROR-SW            PIC X(01)  VALUE 'N'.       01870005
018800         88  PS-NO-MATCH-ERROR                   VALUE 'N'.       01880005
018900         88  PS-MATCH-ERROR                      VALUE 'Y'.       01890005
019000     05  PS-VERIFY-MODULE-SW          PIC X(01)  VALUE 'N'.       01900005
019100         88  PS-DONT-SUBMIT-E200                 VALUE 'N'.       01910005
019200         88  PS-DO-SUBMIT-E200                   VALUE 'Y'.       01920005
019300                                                                  01930005
019400*  RECEIVER LEVEL SWITCHES                                        01940005
019500     05  PS-RCVR-MATCH-ERROR-SW       PIC X(01)  VALUE 'N'.       01950005
019600         88  PS-RCVR-NO-MATCH-ERROR              VALUE 'N'.       01960005
019700         88  PS-RCVR-MATCH-ERROR                 VALUE 'Y'.       01970005
019800     05  PS-RCVR-FREIGHT-ERROR-SW     PIC X(01)  VALUE 'N'.       01980005
019900         88  PS-RCVR-NO-FREIGHT-ERROR            VALUE 'N'.       01990005
020000         88  PS-RCVR-FREIGHT-ERROR               VALUE 'Y'.       02000005
020100     05  PS-RCVR-TROUBLE-ERROR-SW     PIC X(01)  VALUE 'N'.       02010005
020200         88  PS-RCVR-NO-TROUBLE-ERROR            VALUE 'N'.       02020005
020300         88  PS-RCVR-TROUBLE-ERROR               VALUE 'Y'.       02030005
020400     05  PS-RCVR-INVENTORY-ERROR-SW   PIC X(01)  VALUE 'N'.       02040005
020500         88  PS-RCVR-NO-INVENTORY-ERROR          VALUE 'N'.       02050005
020600         88  PS-RCVR-INVENTORY-ERROR             VALUE 'Y'.       02060005
020700                                                                  02070005
020800 01  PA-PROGRAM-ACCUMULATORS.                                     02080005
020900     05  PA-TOT-PACK-QTY              PIC S9(9) VALUE +0.         02090005
021000     05  PA-TOT-FCSE-PK-COUNT         PIC S9(9) VALUE +0.         02100005
021100     05  PA-TOT-P2L-PK-COUNT          PIC S9(9) VALUE +0.         02110005
021200     05  PA-TOT-ODD-PK-COUNT          PIC S9(9) VALUE +0.         02120005
021300     05  PA-FCSE-QTY                  PIC S9(9) VALUE +0.         02130005
021400     05  PA-P2L-QTY                   PIC S9(9) VALUE +0.         02140005
021500     05  PA-ODD-QTY                   PIC S9(9) VALUE +0.         02150005
021600     05  PA-UPDATE-TO-QTY             PIC S9(9) VALUE +0.         02160005
021700     05  PA-UPDATE-FROM-QTY           PIC S9(9) VALUE +0.         02170005
021800     05  PA-UPDATE-DIFF-QTY           PIC S9(9) VALUE +0.         02180005
021900     05  PA-ACCUM-UPDATE-QTY          PIC S9(9) VALUE +0.         02190005
022000*----------------------------------------------------------------*02200005
022100*  INCLUDED PROGRAM SWITCHES FOR XLKUT001       **   WR # 21361  *02210005
022200*----------------------------------------------------------------*02220005
022300     05  PS-CALL-API-SW               PIC  X    VALUE 'N'.        02230005
022400         88  PS-CALL-API-NO                     VALUE 'N'.        02240005
022500         88  PS-CALL-API-YES                    VALUE 'Y'.        02250005
022600*----------------------------------------------------------------*02260005
022700* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *02270005
022800*----------------------------------------------------------------*02280005
022900                                                                  02290005
023000 01  PV-PROGRAM-VARIABLES.                                        02300005
023100     05  PV-DRIVER-EXPTED-ALLOC-QTY   PIC S9(9) VALUE 0 COMP.     02310005
023200     05  PV-DRIVER-ACTL-ALLOC-QTY     PIC S9(9) VALUE 0 COMP.     02320005
023300     05  PV-DRIVER-P2L-SPLT-UNT-QTY   PIC S9(9) VALUE 0 COMP.     02330005
023400     05  PV-DRIVER-FCSE-SPLT-UNT-QTY  PIC S9(9) VALUE 0 COMP.     02340005
023500     05  PV-DRIVER-INPK-SPLT-UNT-QTY  PIC S9(9) VALUE 0 COMP.     02350005
023600     05  PV-DRIVER-FCSE-ACTL-UNT-QTY  PIC S9(9) VALUE 0 COMP.     02360005
023700     05  PV-OTPK-UNT-QTY              PIC S9(4) VALUE 0 COMP.     02370005
023800     05  PV-INPK-UNT-QTY              PIC S9(4) VALUE 0 COMP.     02380005
023810     05  PV-INPK-CART-CNT             PIC S9(4) VALUE 0 COMP.     02381009
023820     05  PV-FCSE-CART-CNT             PIC S9(4) VALUE 0 COMP.     02382009
023900     05  PV-NUMBER-OF-CARTONS         PIC S9(9) VALUE 0 COMP.     02390005
023910     05  PV-NUMBER-OF-UNITS           PIC S9(9) VALUE 0 COMP.     02391013
024000     05  PV-INPK-SPLT-UNT-QTY         PIC S9(9) VALUE 0 COMP.     02400005
024100     05  PV-FCSE-SPLT-UNT-QTY         PIC S9(9) VALUE 0 COMP.     02410005
024200     05  PV-FCSE-ACTL-UNT-QTY         PIC S9(9) VALUE 0 COMP.     02420005
024210     05  PV-EXPTD-CRTN-COUNT-INNER    PIC S9(9) VALUE 0 COMP.     02421009
024220     05  PV-EXPTD-CRTN-COUNT          PIC S9(9) VALUE 0 COMP.     02422009
024230     05  PV-CURR-CRTN-COUNT-INNER     PIC S9(9) VALUE 0 COMP.     02423009
024240     05  PV-CURR-CRTN-COUNT           PIC S9(9) VALUE 0 COMP.     02424009
024300     05  PV-SUM-OF-PACKS                 PIC S9(09)  VALUE ZERO   02430005
024400                                                    COMP-3.       02440005
024500     05  PV-DMG-CARTS                    PIC S9(09)  VALUE ZERO   02450005
024600                                                    COMP-3.       02460005
024700     05  PV-TABLE-LINE-NBR            PIC  9(4) VALUE ZEROS.      02470005
024800     05  PV-MIN-TABLE-LINE-NBR        PIC  9(4) VALUE 9999.       02480005
024900     05  PV-MAX-TABLE-LINE-NBR        PIC  9(4) VALUE ZEROS.      02490005
025000     05  PV-PREPK-ODD-UNT-QTY         PIC S9(4) VALUE 0 COMP.     02500005
025100     05  PV-STR-NBR                   PIC S9(4) VALUE 0 COMP.     02510005
025200     05  PV-PREPK-ID                  PIC S9(4) VALUE 0 COMP.     02520005
025300     05  PV-SEL-TERM-ID                  PIC  X(04).              02530005
025400     05  PV-SEL-TASK-NUMBER              PIC  9(05).              02540005
025500     05  PV-SEL-SEQ                      PIC  9(01).              02550005
025600     05  PV-CICS-MSG-AREA                PIC  X(100) VALUE SPACE. 02560005
025700     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 02570005
025800     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     02580005
025900                                                     COMP SYNC.   02590005
026000     05  PV-SUB                       PIC S9(04)  VALUE ZERO      02600005
026100                                                    COMP SYNC.    02610005
026200     05  PV-REMAINDER                 PIC S9(04)  VALUE ZERO      02620005
026300                                                    COMP SYNC.    02630005
026400     05  PV-READ-COUNT                PIC S9(09)  VALUE ZERO      02640005
026500                                                    COMP-3.       02650005
026600     05  PV-ITEMS-PROCESSED           PIC S9(09)  VALUE ZERO      02660005
026700                                                    COMP-3.       02670005
026800     05  PV-HOLD-SELECTED-ITEMS       PIC S9(09)  VALUE ZERO      02680005
026900                                                    COMP-3.       02690005
027000     05  PV-ITEM-IN-USE               PIC S9(09)  VALUE ZERO      02700005
027100                                                    COMP-3.       02710005
027200     05  PV-TOP-ITEM                  PIC S9(09)  VALUE ZERO      02720005
027300                                                    COMP-3.       02730005
027400     05  PV-BOTTOM-ITEM               PIC S9(09)  VALUE ZERO      02740005
027500                                                    COMP-3.       02750005
027600     05  PV-BLOCK-NUMBER              PIC S9(04)  VALUE ZERO      02760005
027700                                                    COMP SYNC.    02770005
027800     05  PV-CICS-RESP                 PIC S9(04)  VALUE ZERO      02780005
027900                                                    COMP SYNC.    02790005
028000     05  PV-CICS-RESPONSE             PIC S9(09)  VALUE ZEROS     02800005
028100                                                    COMP SYNC.    02810005
028200     05  PV-ITEM                      PIC S9(04)  VALUE ZERO      02820005
028300                                                    COMP SYNC.    02830005
028400     05  PV-SAVE-ITEM                 PIC S9(04)  VALUE ZERO      02840005
028500                                                    COMP SYNC.    02850005
028600     05  PV-HIGHEST-BLOCK-WRITTEN     PIC S9(04)  VALUE ZERO      02860005
028700                                                    COMP SYNC.    02870005
028800     05  PV-LIST-ITEM-NUMBER          PIC S9(04)  VALUE ZERO      02880005
028900                                                    COMP SYNC.    02890005
029000     05  PV-FIRST-BLOCK-IN-ARRAY      PIC S9(04)  VALUE ZERO      02900005
029100                                                    COMP SYNC.    02910005
029200     05  PV-NEXT-BLOCK-IN-ARRAY       PIC S9(04)  VALUE ZERO      02920005
029300                                                    COMP SYNC.    02930005
029400     05  PV-PREV-BLOCK-IN-ARRAY       PIC S9(04)  VALUE ZERO      02940005
029500                                                    COMP SYNC.    02950005
029600     05  PV-FIRST-BLOCK-IN-RANGE      PIC S9(04)  VALUE ZERO      02960005
029700                                                    COMP SYNC.    02970005
029800     05  PV-LAST-BLOCK-IN-RANGE       PIC S9(04)  VALUE ZERO      02980005
029900                                                    COMP SYNC.    02990005
030000     05  PV-START-OF-SELECTED-RANGE   PIC S9(04)  VALUE ZERO      03000005
030100                                                    COMP SYNC.    03010005
030200     05  PV-END-OF-SELECTED-RANGE     PIC S9(04)  VALUE ZERO      03020005
030300                                                    COMP SYNC.    03030005
030400     05  PV-TOTAL-LINE-COUNT          PIC S9(09) VALUE ZERO       03040005
030500                                                    COMP SYNC.    03050005
030600     05  PV-PREPK-BLANK-COUNT         PIC S9(09) VALUE ZERO       03060005
030700                                                    COMP SYNC.    03070005
030800     05  PV-STATUS-COUNTERS.                                      03080005
030900         10 PV-FREIGHT-COUNT          PIC S9(04) VALUE ZERO       03090005
031000                                                    COMP SYNC.    03100005
031100         10 PV-TROUBLE-COUNT          PIC S9(04) VALUE ZERO       03110005
031200                                                    COMP SYNC.    03120005
031300         10 PV-INVENTORY-COUNT        PIC S9(04) VALUE ZERO       03130005
031400                                                    COMP SYNC.    03140005
031500         10 PV-STORE-COUNT            PIC S9(04) VALUE ZERO       03150005
031600                                                    COMP SYNC.    03160005
031700     05  PV-NULL-IND                     PIC S9(04)  VALUE ZEROS  03170005
031800                                                     COMP SYNC.   03180005
031900     05  PV-DATE                      PIC X(10)  VALUE SPACES.    03190005
032000     05  PV-TIME                      PIC X(05)  VALUE SPACES.    03200005
032100     05  PV-PLUS-QTY                  PIC S9(05) VALUE ZERO.      03210005
032200     05  PV-MINUS-QTY                 PIC S9(05) VALUE ZERO.      03220005
032300     05  PV-UPDATE-QTY                PIC S9(05) COMP-3           03230005
032400                                                 VALUE ZERO.      03240005
032500     05  PV-NEW-OUT-PACK              PIC S9(05) COMP-3           03250005
032600                                                 VALUE ZERO.      03260005
032700     05  PV-REMAINDER-OUT-PACK        PIC S9(05) COMP-3           03270005
032800                                                 VALUE ZERO.      03280005
032810     05  PV-REMAINDER-CURR-CTN        PIC S9(05) COMP-3           03281009
032820                                                 VALUE ZERO.      03282009
032900     05  PV-NEW-INPAK                 PIC S9(05) COMP-3           03290005
033000                                                 VALUE ZERO.      03300005
033100     05  PV-REMAINDER-INPAK           PIC S9(05) COMP-3           03310005
033200                                                 VALUE ZERO.      03320005
033300     05  PV-PROCESS-CHANGE-QTY        PIC S9(05) COMP-3           03330005
033400                                                 VALUE ZERO.      03340005
033500     05  PV-PROCESS-QTY               PIC S9(06).                 03350005
033600     05  PV-DISTHD-FCSE-FCLTY-AREA-ID PIC X(06)  VALUE SPACES.    03360005
033700     05  PV-DISTHD-OPER-UNT-ID        PIC S9(4)  COMP             03370005
033800                                                 VALUE ZERO.      03380005
033900     05  PV-DISTHD-FCSE-CNFRMN-TMST   PIC X(26).                  03390005
034000     05  PV-DISPLAY-NO-ZERO           PIC Z(5).                   03400005
034100     05  PV-DISPLAY-ZERO              PIC Z(4)9.                  03410005
034200     05  PV-DISPLAY-PO                PIC 9(09).                  03420005
034300     05  PV-DISPLAY-RECV              PIC 9(09).                  03430005
034400     05  PV-DISPLAY-SKU               PIC 9(08).                  03440005
034500     05  PV-PCKCS756                  PIC X(08)  VALUE 'PCKCS756'.03450005
034600     05  PV-TMST                      PIC X(26).                  03460005
034700     05  FILLER REDEFINES PV-TMST.                                03470005
034800         10  PV-CCYY                  PIC X(04).                  03480005
034900         10  FILLER                   PIC X(01).                  03490005
035000         10  PV-MM                    PIC X(02).                  03500005
035100         10  FILLER                   PIC X(01).                  03510005
035200         10  PV-DD                    PIC X(02).                  03520005
035300         10  FILLER                   PIC X(01).                  03530005
035400         10  PV-HH                    PIC X(02).                  03540005
035500         10  FILLER                   PIC X(01).                  03550005
035600         10  PV-MIN                   PIC X(02).                  03560005
035700         10  FILLER                   PIC X(01).                  03570005
035800         10  PV-SEC                   PIC X(02).                  03580005
035900         10  FILLER                   PIC X(01).                  03590005
036000         10  FILLER                   PIC X(06).                  03600005
036100                                                                  03610005
036200     05  PV-PO-NBR                       PIC 9(08).               03620005
036300     05  PV-RCVR-NBR                     PIC 9(04).               03630005
036400     05  PV-OPER-UNT-ID                  PIC 9(04).               03640005
036500     05  PV-FCLTY-ID                     PIC 9(04).               03650005
036600     05  PV-LINE-NBR                     PIC 9(04).               03660005
036700     05  PV-PACK-ID                      PIC 9(04).               03670005
036800                                                                  03680005
036900                                                                  03690005
037000*----------------------------------------------------------------*03700005
037100*                                               WR # 21361       *03710005
037200* ADDED NEW PROGRAM VARIABLE - PV-CS-SKU                         *03720005
037300*----------------------------------------------------------------*03730005
037400     05  PV-CS-SKU                    PIC  X(08).                 03740005
037500*----------------------------------------------------------------*03750005
037600* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *03760005
037700*----------------------------------------------------------------*03770005
037800                                                                  03780005
037900 01  PT-INVPAR-TABLE.                                             03790005
038000     05  PT-INVSTORE-FLAG             PIC X OCCURS 1000 TIMES.    03800005
038100         88  PT-STORE-DOING-INVENTORY     VALUE 'Y'.              03810005
038200     05  PT-STORE-NBR                 PIC 9(04).                  03820005
038300                                                                  03830005
038400 01  PT-PRE-PACK-UPDATE-TABLE.                                    03840005
038500     05  PT-LINE-INFO  OCCURS 1000 TIMES.                         03850005
038600         10  PT-UPDATE-QTY            PIC S9(9) COMP.             03860005
038700                                                                  03870005
038800*---------------------------------------------------------------* 03880005
038900*   THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   * 03890005
039000*   THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           * 03900005
039100*   APPLICATION-SPECIFIC COMMAREA.                              * 03910005
039200*---------------------------------------------------------------* 03920005
039300 01  LQW-LIST-QUEUE-WORK-AREA.                                    03930005
039400     05  LQW-BLOCK-MODIFIED           PIC X(01)   VALUE SPACE.    03940005
039500     05  LQW-ITEM-ENTRIES               OCCURS 09 TIMES           03950005
039600                                        INDEXED BY LQW-IDX.       03960005
039700         10  LQW-LIST-ITEM-NUMBER     PIC S9(09)  COMP-3.         03970005
039800         10  LQW-TEMP-SELECTED-SW     PIC X(01).                  03980005
039900         10  LQW-SELECTED-SW          PIC X(01).                  03990005
040000             88  LQW-SELECT                         VALUE 'S'.    04000005
040100             88  LQW-DESELECT                       VALUE SPACE.  04010005
040200         10  LQW-ACTION               PIC X(03).                  04020005
040300             88  LQW-NULL-ACTION                    VALUE SPACES. 04030005
040400             88  LQW-ERROR                          VALUE 'ERR'.  04040005
040500             88  LQW-INQUIRE                        VALUE 'INQ'.  04050005
040600             88  LQW-UPDATE                         VALUE 'UPD'.  04060005
040700             88  LQW-SUB                            VALUE 'SUB'.  04070005
040800         10  LQW-U-PROCESS-QTY-X.                                 04080005
040900             15 LQW-U-PROCESS-QTY     PIC 9(05).                  04090005
041000         10  LQW-STORE-NBR            PIC 9(04).                  04100005
041100         10  LQW-EXP-STR-QTY          PIC 9(05).                  04110005
041200         10  LQW-CUR-STR-QTY          PIC 9(05).                  04120005
041300         10  LQW-EXP-STR-CRT          PIC 9(04).                  04130005
041400         10  LQW-CUR-STR-CRT          PIC 9(04).                  04140005
041500         10  LQW-P2L-QTY              PIC 9(05).                  04150005
041600         10  LQW-ODD-UNIT             PIC 9(04).                  04160005
041700         10  LQW-SEL-ZERO-SW    PIC X(01).                        04170005
041800             88  LQW-SEL-ZERO-YES   VALUE 'Y'.                    04180005
041900             88  LQW-SEL-ZERO-NO    VALUE 'N'.                    04190005
042000                                                                  04200005
042100                                                                  04210005
042200*---------------------------------------------------------------* 04220005
042300*  RECORD LAYOUT FOR THE LIST SELECTION TEMP STORAGE QUEUE.     * 04230005
042400*---------------------------------------------------------------* 04240005
042500     COPY RCWS013.                                                04250005
042600                                                                  04260005
042700     COPY RCWS074.                                                04270005
042800                                                                  04280005
042900     COPY RCKM298.                                                04290005
043000                                                                  04300005
043100*----------------------------------------------------------------*04310005
043200*                                                    WR # 21361  *04320005
043300* CHANGED THE STRUCTURE OF MR-SKU FROM X(10) TO X(15).           *04330005
043400*----------------------------------------------------------------*04340005
043500 01  MR-OCCURS-LAYOUT                   REDEFINES  RC298AO.       04350005
043600     02  MR-HEADER-INFO.                                          04360005
043700     05  FILLER                       PIC X(12).                  04370050
043800                                                                  04380005
043900     05  MR-OPERL                     PIC S9(04) COMP.            04390005
044000     05  MR-OPERA                     PIC X(01).                  04400005
044100     05  MR-OPERC                     PIC X(01).                  04410005
044200     05  MR-OPERH                     PIC X(01).                  04420005
044300     05  MR-OPER                      PIC X(04).                  04430005
044400                                                                  04440005
044500     05  MR-FCLTYL                    PIC S9(04) COMP.            04450005
044600     05  MR-FCLTYA                    PIC X(01).                  04460005
044700     05  MR-FCLTYC                    PIC X(01).                  04470005
044800     05  MR-FCLTYH                    PIC X(01).                  04480005
044900     05  MR-FCLTY                     PIC X(04).                  04490005
045000                                                                  04500005
045100     05  MR-POL                       PIC S9(04) COMP.            04510005
045200     05  MR-POA                       PIC X(01).                  04520005
045300     05  MR-POC                       PIC X(01).                  04530005
045400     05  MR-POH                       PIC X(01).                  04540005
045500     05  MR-PO-X.                                                 04550005
045510*CLP 10/22/14                                                     04551038
045600         10 MR-PO                     PIC 9(08).                  04560038
045700                                                                  04570005
045800     05  MR-RCVRL                     PIC S9(04) COMP.            04580005
045900     05  MR-RCVRA                     PIC X(01).                  04590005
046000     05  MR-RCVRC                     PIC X(01).                  04600005
046100     05  MR-RCVRH                     PIC X(01).                  04610005
046200     05  MR-RCVR                      PIC 9(04).                  04620005
046300                                                                  04630005
046400     05  MR-PKCDL                     PIC S9(04) COMP.            04640005
046500     05  MR-PKCDA                     PIC X(01).                  04650005
046600     05  MR-PKCDC                     PIC X(01).                  04660005
046700     05  MR-PKCDH                     PIC X(01).                  04670005
046800     05  MR-PKCD                      PIC X(01).                  04680005
046900                                                                  04690005
047000     05  MR-PO-LINE-L             PIC S9(04) COMP.                04700005
047100     05  MR-PO-LINE-A             PIC X(01).                      04710005
047200     05  MR-PO-LINE-C             PIC X(01).                      04720005
047300     05  MR-PO-LINE-H             PIC X(01).                      04730005
047400     05  MR-PO-LINE               PIC ZZZ9.                       04740005
047500                                                                  04750005
047600     05  FILLER                   PIC X(17).                      04760005
047700**   05  MR-SKU-HDG-L             PIC S9(04) COMP.                04770005
047800**   05  MR-SKU-HDG-A             PIC X(01).                      04780005
047900**   05  MR-SKU-HDG-C             PIC X(01).                      04790005
048000**   05  MR-SKU-HDG-H             PIC X(01).                      04800005
048100**   05  MR-SKU-HDG               PIC X(12).                      04810005
048200                                                                  04820005
048300     05  MR-SKUL                  PIC S9(04) COMP.                04830005
048400     05  MR-SKUA                  PIC X(01).                      04840005
048500     05  MR-SKUC                  PIC X(01).                      04850005
048600     05  MR-SKUH                  PIC X(01).                      04860005
048700     05  MR-SKU.                                                  04870005
048800         10  MR-DEPT               PIC X(03).                     04880005
048900         10  MR-SKU-DASH           PIC X(01).                     04890005
049000         10  MR-SKU-CL-NBR         PIC X(02).                     04900005
049100         10  MR-SKU-DASH2          PIC X(01).                     04910005
049200         10  MR-SKU-SEQ-NBR        PIC X(08).                     04920005
049300                                                                  04930005
049400     05  MR-CONF-DATEL            PIC S9(04) COMP.                04940005
049500     05  MR-CONF-DATEA            PIC X(01).                      04950005
049600     05  MR-CONF-DATEC            PIC X(01).                      04960005
049700     05  MR-CONF-DATEH            PIC X(01).                      04970005
049800     05  MR-CONF-DATE             PIC X(10).                      04980005
049900                                                                  04990005
050000     05  MR-CONF-TIMEL            PIC S9(04) COMP.                05000005
050100     05  MR-CONF-TIMEA            PIC X(01).                      05010005
050200     05  MR-CONF-TIMEC            PIC X(01).                      05020005
050300     05  MR-CONF-TIMEH            PIC X(01).                      05030005
050400     05  MR-CONF-TIME             PIC X(05).                      05040005
050500                                                                  05050005
050600     05  MR-OUT-PACK-QTYL         PIC S9(04) COMP.                05060005
050700     05  MR-OUT-PACK-QTYA         PIC X(01).                      05070005
050800     05  MR-OUT-PACK-QTYC         PIC X(01).                      05080005
050900     05  MR-OUT-PACK-QTYH         PIC X(01).                      05090005
051000     05  MR-OUT-PACK-QTY-X.                                       05100005
051100         10  MR-OUT-PACK-QTY       PIC ZZZ9.                      05110005
051200                                                                  05120005
051300     05  FILLER                    PIC X(17).                     05130005
051400**   05  MR-LSTS-HDGL              PIC S9(04) COMP.               05140005
051500**   05  MR-LSTS-HDGA              PIC X(01).                     05150005
051600**   05  MR-LSTS-HDGC              PIC X(01).                     05160005
051700**   05  MR-LSTS-HDGH              PIC X(01).                     05170005
051800**   05  MR-LSTS-HDG               PIC X(12).                     05180005
051900                                                                  05190005
052000     05  MR-LINE-STATUSL           PIC S9(04) COMP.               05200005
052100     05  MR-LINE-STATUSA           PIC X(01).                     05210005
052200     05  MR-LINE-STATUSC           PIC X(01).                     05220005
052300     05  MR-LINE-STATUSH           PIC X(01).                     05230005
052400     05  MR-LINE-STATUS            PIC X(09).                     05240005
052500                                                                  05250005
052600     05  MR-USER-IDL               PIC S9(04) COMP.               05260005
052700     05  MR-USER-IDA               PIC X(01).                     05270005
052800     05  MR-USER-IDC               PIC X(01).                     05280005
052900     05  MR-USER-IDH               PIC X(01).                     05290005
053000     05  MR-USER-ID                PIC X(08).                     05300005
053100                                                                  05310005
053200     05  FILLER                   PIC X(13).                      05320005
053300**   05  MR-INPAK-HDGL            PIC S9(04) COMP.                05330005
053400**   05  MR-INPAK-HDGA            PIC X(01).                      05340005
053500**   05  MR-INPAK-HDGC            PIC X(01).                      05350005
053600**   05  MR-INPAK-HDGH            PIC X(01).                      05360005
053700**   05  MR-INPAK-HDG             PIC X(08).                      05370005
053800                                                                  05380005
053900     05  MR-INPAK-QTYL            PIC S9(04) COMP.                05390005
054000     05  MR-INPAK-QTYA            PIC X(01).                      05400005
054100     05  MR-INPAK-QTYC            PIC X(01).                      05410005
054200     05  MR-INPAK-QTYH            PIC X(01).                      05420005
054300     05  MR-INPAK-QTY-X.                                          05430005
054400         10 MR-INPAK-QTY          PIC ZZZ9.                       05440005
054500                                                                  05450005
054600     05  FILLER                   PIC X(17).                      05460005
054700**   05  MR-EXP-HDGL              PIC S9(04) COMP.                05470005
054800**   05  MR-EXP-HDGA              PIC X(01).                      05480005
054900**   05  MR-EXP-HDGC              PIC X(01).                      05490005
055000**   05  MR-EXP-HDGH              PIC X(01).                      05500005
055100**   05  MR-EXP-HDG               PIC X(12).                      05510005
055200                                                                  05520005
055300     05  MR-EXP-QTYL              PIC S9(04) COMP.                05530005
055400     05  MR-EXP-QTYA              PIC X(01).                      05540005
055500     05  MR-EXP-QTYC              PIC X(01).                      05550005
055600     05  MR-EXP-QTYH              PIC X(01).                      05560005
055700     05  MR-EXP-QTY-X.                                            05570005
055800         10 MR-EXP-QTY            PIC ZZZZ9.                      05580005
055900                                                                  05590005
056000     05  MR-EXP-CARTL             PIC S9(04) COMP.                05600005
056100     05  MR-EXP-CARTA             PIC X(01).                      05610005
056200     05  MR-EXP-CARTC             PIC X(01).                      05620005
056300     05  MR-EXP-CARTH             PIC X(01).                      05630005
056400     05  MR-EXP-CART-X.                                           05640005
056500         10 MR-EXP-CART           PIC ZZZZ9.                      05650005
056600                                                                  05660005
056700     05  MR-P2L-STATUSL            PIC S9(04) COMP.               05670005
056800     05  MR-P2L-STATUSA            PIC X(01).                     05680005
056900     05  MR-P2L-STATUSC            PIC X(01).                     05690005
057000     05  MR-P2L-STATUSH            PIC X(01).                     05700005
057100     05  MR-P2L-STATUS             PIC X(08).                     05710005
057200                                                                  05720005
057300     05  FILLER                   PIC X(13).                      05730005
057400**   05  MR-P2L-HDGL              PIC S9(04) COMP.                05740005
057500**   05  MR-P2L-HDG-LINEA         PIC X(01).                      05750005
057600**   05  MR-P2L-HDG-LINEC         PIC X(01).                      05760005
057700**   05  MR-P2L-HDG-LINEH         PIC X(01).                      05770005
057800**   05  MR-P2L-HDG-LINE          PIC X(08).                      05780005
057900                                                                  05790005
058000     05  MR-P2L-QTYL              PIC S9(04) COMP.                05800005
058100     05  MR-P2L-QTY-LINEA         PIC X(01).                      05810005
058200     05  MR-P2L-QTY-LINEC         PIC X(01).                      05820005
058300     05  MR-P2L-QTY-LINEH         PIC X(01).                      05830005
058400     05  MR-P2L-QTY-LINE-X.                                       05840005
058500         10 MR-P2L-QTY-LINE       PIC ZZZZ9.                      05850005
058600                                                                  05860005
058700     05  MR-CURRENT-HDG           PIC X(17).                      05870005
058800**   05  MR-CURRENT-HDGL          PIC S9(04) COMP.                05880005
058900**   05  MR-CURRENT-HDGA          PIC X(01).                      05890005
059000**   05  MR-CURRENT-HDGC          PIC X(01).                      05900005
059100**   05  MR-CURRENT-HDGH          PIC X(01).                      05910005
059200**   05  MR-CURRENT-HDG           PIC X(12).                      05920005
059300                                                                  05930005
059400     05  MR-CURRENT-QTYL          PIC S9(04) COMP.                05940005
059500     05  MR-CURRENT-QTYA          PIC X(01).                      05950005
059600     05  MR-CURRENT-QTYC          PIC X(01).                      05960005
059700     05  MR-CURRENT-QTYH          PIC X(01).                      05970005
059800     05  MR-CURRENT-QTY-X.                                        05980005
059900         10 MR-CURRENT-QTY        PIC ZZZZ9.                      05990005
060000                                                                  06000005
060100     05  MR-CURRENT-CRTL          PIC S9(04) COMP.                06010005
060200     05  MR-CURRENT-CRTA          PIC X(01).                      06020005
060300     05  MR-CURRENT-CRTC          PIC X(01).                      06030005
060400     05  MR-CURRENT-CRTH          PIC X(01).                      06040005
060500     05  MR-CURRENT-CRT-X.                                        06050005
060600         10 MR-CURRENT-CRT        PIC ZZZZ9.                      06060005
060700                                                                  06070005
060800     05  MR-CNVYBL                 PIC S9(04) COMP.               06080005
060900     05  MR-CNVYBA                 PIC X(01).                     06090005
061000     05  MR-CNVYBC                 PIC X(01).                     06100005
061100     05  MR-CNVYBH                 PIC X(01).                     06110005
061200     05  MR-CNVYB                  PIC X(01).                     06120005
061300                                                                  06130005
061400     05  MR-DMG-CART-MSGL          PIC S9(04) COMP.               06140005
061500     05  MR-DMG-CART-MSGA          PIC X(01).                     06150005
061600     05  MR-DMG-CART-MSGC          PIC X(01).                     06160005
061700     05  MR-DMG-CART-MSGH          PIC X(01).                     06170005
061800     05  MR-DMG-CART-MSG           PIC X(20).                     06180005
061900                                                                  06190005
062000     05  FILLER                       PIC X(89).                  06200056
062100                                                                  06210005
062200     02  MR-DETAIL-LINES.                                         06220005
062300     05  MR-SCROLL-AREA                 OCCURS 09 TIMES.          06230005
062400         10  MR-SELECTL               PIC S9(04) COMP.            06240005
062500         10  MR-SELECTA               PIC X(01).                  06250005
062600         10  MR-SELECTC               PIC X(01).                  06260005
062700         10  MR-SELECTH               PIC X(01).                  06270005
062800         10  MR-SELECT                PIC X(01).                  06280005
062900                                                                  06290005
063000         10  MR-ACTIONL               PIC S9(04) COMP.            06300005
063100         10  MR-ACTIONA               PIC X(01).                  06310005
063200         10  MR-ACTIONC               PIC X(01).                  06320005
063300         10  MR-ACTIONH               PIC X(01).                  06330005
063400         10  MR-ACTION                PIC X(03).                  06340005
063500                                                                  06350005
063600         10  MR-U-PROCESS-QTYL        PIC S9(04) COMP.            06360005
063700         10  MR-U-PROCESS-QTYA        PIC X(01).                  06370005
063800         10  MR-U-PROCESS-QTYC        PIC X(01).                  06380005
063900         10  MR-U-PROCESS-QTYH        PIC X(01).                  06390005
064000         10  MR-U-PROCESS-QTY-X.                                  06400005
064100             15 MR-U-PROCESS-QTY      PIC ZZZZ9.                  06410005
064200                                                                  06420005
064300         10  MR-STOREL                PIC S9(04) COMP.            06430005
064400         10  MR-STOREA                PIC X(01).                  06440005
064500         10  MR-STOREC                PIC X(01).                  06450005
064600         10  MR-STOREH                PIC X(01).                  06460005
064700         10  MR-STORE-X.                                          06470005
064800             15 MR-STORE              PIC 9(4).                   06480005
064900                                                                  06490005
065000         10  MR-EXP-STR-QTYL          PIC S9(04) COMP.            06500005
065100         10  MR-EXP-STR-QTYA          PIC X(01).                  06510005
065200         10  MR-EXP-STR-QTYC          PIC X(01).                  06520005
065300         10  MR-EXP-STR-QTYH          PIC X(01).                  06530005
065400         10  MR-EXP-STR-QTY-X.                                    06540005
065500             15 MR-EXP-STR-QTY        PIC ZZZZ9.                  06550005
065600                                                                  06560005
065700         10  MR-CUR-STR-QTYL          PIC S9(04) COMP.            06570005
065800         10  MR-CUR-STR-QTYA          PIC X(01).                  06580005
065900         10  MR-CUR-STR-QTYC          PIC X(01).                  06590005
066000         10  MR-CUR-STR-QTYH          PIC X(01).                  06600005
066100         10  MR-CUR-STR-QTY-X.                                    06610005
066200             15 MR-CUR-STR-QTY        PIC ZZZZ9.                  06620005
066300                                                                  06630005
066400         10  MR-EXP-CRT-COUNTL        PIC S9(04) COMP.            06640005
066500         10  MR-EXP-CRT-COUNTA        PIC X(01).                  06650005
066600         10  MR-EXP-CRT-COUNTC        PIC X(01).                  06660005
066700         10  MR-EXP-CRT-COUNTH        PIC X(01).                  06670005
066800         10  MR-EXP-CRT-COUNT-X.                                  06680005
066900             15 MR-EXP-CRT-COUNT      PIC ZZZ9.                   06690005
067000                                                                  06700005
067100         10  MR-CUR-CRT-COUNTL        PIC S9(04) COMP.            06710005
067200         10  MR-CUR-CRT-COUNTA        PIC X(01).                  06720005
067300         10  MR-CUR-CRT-COUNTC        PIC X(01).                  06730005
067400         10  MR-CUR-CRT-COUNTH        PIC X(01).                  06740005
067500         10  MR-CUR-CRT-COUNT-X.                                  06750005
067600             15 MR-CUR-CRT-COUNT      PIC ZZZ9.                   06760005
067700                                                                  06770005
067800         10  MR-P2L-QTYL              PIC S9(04) COMP.            06780005
067900         10  MR-P2L-QTYA              PIC X(01).                  06790005
068000         10  MR-P2L-QTYC              PIC X(01).                  06800005
068100         10  MR-P2L-QTYH              PIC X(01).                  06810005
068200         10  MR-P2L-QTY-X.                                        06820005
068300             15 MR-P2L-QTY            PIC ZZZZ9.                  06830005
068400                                                                  06840005
068500         10  MR-ODD-UNITL             PIC S9(04) COMP.            06850005
068600         10  MR-ODD-UNITA             PIC X(01).                  06860005
068700         10  MR-ODD-UNITC             PIC X(01).                  06870005
068800         10  MR-ODD-UNITH             PIC X(01).                  06880005
068900         10  MR-ODD-UNIT-X.                                       06890005
069000             15 MR-ODD-UNIT           PIC ZZZ9.                   06900005
069100     05  FILLER                       PIC X(12).                  06910049
069200*----------------------------------------------------------------*06920049
069300* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *06930005
069400*----------------------------------------------------------------*06940005
069500                                                                  06950005
069600     COPY DPWS015.                                                06960005
069700                                                                  06970005
069800     COPY DPWS016.                                                06980005
069900                                                                  06990005
070000     COPY DPWS010I.                                               07000005
070100                                                                  07010005
070110******************************************************************07011059
070120** THE CALLING PARAMETER LIST (DPWS030/DPWS930) FOR THE CICS    **07012059
070130** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **07013059
070140******************************************************************07014059
070200     COPY DPWS030.                                                07020005
070210     COPY DPWS930.                                                07021059
070300                                                                  07030005
070400***************************************************************** 07040005
070500*   RCWS039 - IS THE LAYOUT THAT IS USED TO PASS INFO TO        * 07050005
070600*             THE F-KEY ELIGIBILITY MODULE (RCKUT126).          * 07060005
070700***************************************************************** 07070005
070800     COPY RCWS039.                                                07080005
070900                                                                  07090005
071000***************************************************************** 07100005
071100*   RCWS040 - IS THE LAYOUT THAT IS USED TO PASS INFO TO THE    * 07110005
071200*             AUTOVERIFY (AUTOVE) MODULE (RCKUT127).            * 07120005
071300***************************************************************** 07130005
071400     COPY RCWS040.                                                07140005
071500                                                                  07150005
071600*---------------------------------------------------------------* 07160005
071700*    STANDARD COMMAREA.                                         * 07170005
071800*---------------------------------------------------------------* 07180005
071900     COPY DPWS020.                                                07190005
072000     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                07200005
072100                                                                  07210005
072200*---------------------------------------------------------------* 07220005
072300* INTER-APPLICATION COMMAREA.                                   * 07230005
072400*   CNWS001 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 07240005
072500*             SPEC SCREEN.                                      * 07250005
072600*   CNWS003 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 07260005
072700*             THIS LIST PROGRAM FOR A LOCAL-GO FUNCTION.        * 07270005
072800*---------------------------------------------------------------* 07280005
072900                                                                  07290005
073000         10  INTER-APPL-COMM-AREA     PIC X(200).                 07300005
073100     COPY RCWS012.                                                07310005
073200     COPY RCWS015.                                                07320005
073300*---------------------------------------------------------------* 07330005
073400*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 07340005
073500*---------------------------------------------------------------* 07350005
073600         10  ASC-SPECIFIC-COMMAREA.                               07360005
073700             15  ASC-LIST-KEYS.                                   07370005
073800*  THESE ARE THE KEYS PASSED FROM THE CRIT SPEC SCREEN            07380005
073900                 20  ASC-KEY-FCLTY-ID      PIC S9(04) COMP.       07390005
074000                 20  ASC-KEY-OPER-UNT-ID                          07400005
074100                                           PIC S9(04) COMP.       07410005
074200                 20  ASC-KEY-PO-NBR        PIC S9(09) COMP.       07420005
074300                 20  ASC-KEY-RCVR-NBR      PIC S9(09) COMP.       07430005
074400                 20  ASC-KEY-LNE-NBR       PIC S9(09) COMP.       07440005
074500                 20  ASC-KEY-PACK-ID       PIC S9(04) COMP.       07450005
074600                 20  ASC-DRV-LNE-NBR       PIC S9(09) COMP.       07460005
074700             15  ASC-HEADER-FIELDS.                               07470005
074800                 20  ASC-RCVR-OPER-UNT-ID  PIC S9(04) COMP.       07480005
074900                 20  ASC-OPER-UNT-ID       PIC S9(04) COMP.       07490005
075000                 20  ASC-FCLTY-ID          PIC S9(04) COMP.       07500005
075100                 20  ASC-ORD-NBR           PIC  9(08).            07510053
075200                 20  ASC-RCVR-NBR          PIC S9(08) COMP.       07520005
075300                 20  ASC-PKGNG-CDE         PIC X(01).             07530005
075400                 20  ASC-PKGNG-CDE-DISPLAY PIC X(01).             07540005
075500                 20  ASC-LINE-NBR          PIC S9(09) COMP.       07550005
075600                 20  ASC-PACK-ID           PIC 9(04).             07560005
075700                 20  ASC-PREPK-RATO-QTY    PIC 9(04).             07570005
075800                 20  ASC-USER-ID           PIC X(08).             07580005
075900*----------------------------------------------------------------*07590005
076000*                                             WR # 21361         *07600005
076100* CHANGED THE STRUCTURE OF ASC TO MATCH THE APPL COMMAREA.       *07610005
076200* ASC-SKU FIELD IS INCREASED FROM X(10) TO X(15).           *     07620005
076300*----------------------------------------------------------------*07630005
076400                 20  ASC-SKU.                                     07640005
076500                     25  ASC-DEPT          PIC X(03).             07650005
076600                     25  ASC-SKU-DASH      PIC X(01).             07660005
076700                     25  ASC-SKU-CL-NBR    PIC X(02).             07670005
076800                     25  ASC-SKU-DASH1     PIC X(01).             07680005
076900                     25  ASC-SKU-SEQ-NBR   PIC X(08).             07690005
077000*----------------------------------------------------------------*07700005
077100* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *07710005
077200*----------------------------------------------------------------*07720005
077300                 20  FILLER REDEFINES ASC-SKU.                    07730005
077400                     25  ASC-PK-PRE        PIC X(03).             07740005
077500                     25  ASC-PK-NBR        PIC X(04).             07750005
077600                     25  ASC-PK-FILLER     PIC X(03).             07760005
077700                 20  ASC-CONF-DATE         PIC X(10).             07770005
077800                 20  ASC-CONF-TIME         PIC X(05).             07780005
077900                 20  ASC-OUT-PACK-QTY      PIC 9(04).             07790005
078000                 20  ASC-P2L-STATUS        PIC X(08).             07800005
078100                 20  ASC-CNVYB             PIC X(01).             07810005
078200                 20  ASC-LINE-STATUS       PIC X(09).             07820005
078300                 20  ASC-INPAK-QTY         PIC 9(04).             07830005
078400                 20  ASC-EXP-LINE-QTY      PIC 9(07).             07840005
078500                 20  ASC-EXP-CART-QTY      PIC 9(07).             07850005
078600                 20  ASC-CUR-LINE-QTY      PIC 9(07).             07860005
078700                 20  ASC-CUR-CART-QTY      PIC 9(07).             07870005
078800                 20  ASC-P2L-QTY-LINE      PIC 9(07).             07880005
078900                 20  ASC-PROTECT-SW        PIC X(01).             07890005
079000                     88  ASC-PROTECT-ALL-STORES  VALUE 'Y'.       07900005
079100                                                                  07910005
079200             15  ASC-BLOCK-ENTRIES      OCCURS 2 TIMES.           07920005
079300                 20  ASC-BLOCK-MODIFIED-SW                        07930005
079400                                      PIC  X(01).                 07940005
079500                     88  ASC-BLOCK-NOT-MODIFIED    VALUE 'N'.     07950005
079600                     88  ASC-BLOCK-MODIFIED        VALUE 'Y'.     07960005
079700                                                                  07970005
079800                 20  ASC-ITEM-ARRAY.                              07980005
079900                     25  ASC-ITEM-ENTRIES OCCURS 09 TIMES.        07990005
080000                         30  ASC-LIST-ITEM-NUMBER                 08000005
080100                                      PIC S9(09) COMP-3.          08010005
080200                         30  ASC-TEMP-SELECTED-SW  PIC X(01).     08020005
080300                             88  ASC-VALID-SELECT      VALUE ' '  08030005
080400                                                             'S'  08040005
080500                                                             'B'  08050005
080600                                                             'E'. 08060005
080700                             88  ASC-TEMP-NO-SELECT    VALUE ' '. 08070005
080800                             88  ASC-TEMP-SELECT       VALUE 'S'. 08080005
080900                             88  ASC-TEMP-BEGIN        VALUE 'B'. 08090005
081000                             88  ASC-TEMP-END          VALUE 'E'. 08100005
081100                         30  ASC-SELECTED-SW       PIC X(01).     08110005
081200                             88  ASC-NO-SELECT         VALUE ' '. 08120005
081300                             88  ASC-SELECT            VALUE 'S'. 08130005
081400                             88  ASC-BEGIN             VALUE 'B'. 08140005
081500                             88  ASC-END               VALUE 'E'. 08150005
081600                         30  ASC-ACTION          PIC X(03).       08160005
081700                         30  ASC-U-PROCESS-QTY-X PIC X(05).       08170005
081800                         30  ASC-U-PROCESS-QTY REDEFINES          08180005
081900                             ASC-U-PROCESS-QTY-X PIC 9(05).       08190005
082000                         30  ASC-STORE-NBR      PIC 9(04).        08200005
082100                         30  ASC-EXP-STR-QTY    PIC 9(05).        08210005
082200                         30  ASC-CUR-STR-QTY    PIC 9(05).        08220005
082300                         30  ASC-EXP-STR-CRT    PIC 9(04).        08230005
082400                         30  ASC-CUR-STR-CRT    PIC 9(04).        08240005
082500                         30  ASC-P2L-QTY        PIC 9(05).        08250005
082600                         30  ASC-ODD-UNIT       PIC 9(04).        08260005
082700                         30  ASC-SEL-ZERO-SW    PIC X(01).        08270005
082800                             88  ASC-SEL-ZERO-YES   VALUE 'Y'.    08280005
082900                             88  ASC-SEL-ZERO-NO    VALUE 'N'.    08290005
083000*                        30  ASC-W-FCSE-CART-COUNT                08300005
083100*                                          PIC S9(05) COMP-3.     08310005
083200*                        30  ASC-W-INPK-CART-COUNT                08320005
083300*                                          PIC S9(05) COMP-3.     08330005
083400                                                                  08340005
083500             15  ASC-BLK-SUB          PIC S9(04) COMP SYNC.       08350005
083600             15  ASC-ITEM-SUB         PIC S9(04) COMP SYNC.       08360005
083700             15  ASC-NUMBER-OF-ITEMS-READ                         08370005
083800                                      PIC S9(09) COMP-3.          08380005
083900             15  ASC-NUMBER-OF-SELECTED-ITEMS                     08390005
084000                                      PIC S9(09) COMP-3.          08400005
084100             15  ASC-ITEMS-DISPLAYED  PIC S9(03) COMP-3.          08410005
084200             15  ASC-ITEM-AT-TOP-OF-PANEL                         08420005
084300                                      PIC S9(09) COMP-3.          08430005
084400             15  ASC-ITEM-AT-BOT-OF-PANEL                         08440005
084500                                      PIC S9(09) COMP-3.          08450005
084600             15  ASC-HIGHEST-BLOCK-WRITTEN                        08460005
084700                                      PIC S9(04) COMP SYNC.       08470005
084800             15  ASC-START-OF-SELECTED-RANGE                      08480005
084900                                      PIC S9(09) COMP-3.          08490005
085000             15  ASC-END-OF-SELECTED-RANGE                        08500005
085100                                      PIC S9(09) COMP-3.          08510005
085200             15  ASC-ITEMS-LEFT-INDICATOR                         08520005
085300                                      PIC X(01).                  08530005
085400                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     08540005
085500                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     08550005
085600             15  ASC-TEMP-QUEUE-UPDATE-SW                         08560005
085700                                      PIC X(01).                  08570005
085800                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     08580005
085900                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     08590005
086000             15  ASC-LIST-QUEUE-NAME.                             08600005
086100                 20  ASC-LIST-TERM-ID PIC X(04).                  08610005
086200                 20  ASC-LIST-TASK-NUMBER                         08620005
086300                                      PIC S9(05) COMP-3.          08630005
086400                 20  ASC-LIST-SEQ     PIC 9(01).                  08640005
086500             15  ASC-SEL-QUEUE-NAME.                              08650005
086600                 20  ASC-SEL-TERM-ID  PIC X(04).                  08660005
086700                 20  ASC-SEL-TASK-NUMBER                          08670005
086800                                      PIC S9(05) COMP-3.          08680005
086900                 20  ASC-SEL-SEQ      PIC 9(01).                  08690005
087000             15  ASC-SEL-QUEUE-NAME-IN.                           08700005
087100                 20  ASC-SEL-TERM-ID-IN  PIC X(04).               08710005
087200                 20  ASC-SEL-TASK-NUMBER-IN                       08720005
087300                                      PIC S9(05) COMP-3.          08730005
087400                 20  ASC-SEL-SEQ-IN      PIC 9(01).               08740005
087500                                                                  08750005
087600             15  ASC-START-ITEM-REQUEST.                          08760005
087700                 20  ASC-START-ITEM-REQUEST-N                     08770005
087800                                      PIC 9(07).                  08780005
087900             15  ASC-CICS-SYSTEM       PIC X(08).                 08790005
088000                 88 ASC-TEST-CICS             VALUE 'CICST1  '.   08800005
088100             15  ASC-USE-SELECTION-QUEUE-IND         PIC X(01).   08810005
088200                 88  ASC-USE-SELECTION-QUEUE         VALUE 'Y'.   08820005
088300             15  ASC-NUMBER-OF-TS-ITEMS              PIC S9(05)   08830005
088400                                                          COMP-3. 08840005
088500             15  ASC-SEL-SUB                         PIC S9(04)   08850005
088600                                                          COMP.   08860005
088700             15  ASC-SEL-ITEM                        PIC S9(04)   08870005
088800                                                          COMP.   08880005
088900             15  ASC-DISPLAY-FORMAT                  PIC X(01).   08890005
089000                 88  ASC-LIST-FORMAT                 VALUE '1'.   08900005
089100                 88  ASC-CRIT-SPEC-FORMAT            VALUE '2'.   08910005
089200                 88  ASC-PACK-LINE-FORMAT            VALUE '3'.   08920005
089300             15  ASC-F22-RETURN-FLAG                 PIC X(01).   08930005
089400                 88  ASC-F22-RETURN-NO               VALUE 'N'.   08940005
089500                 88  ASC-F22-RETURN-YES              VALUE 'Y'.   08950005
089600             15  ASC-F23-RETURN-FLAG                 PIC X(01).   08960005
089700                 88  ASC-F23-RETURN-NO               VALUE 'N'.   08970005
089800                 88  ASC-F23-RETURN-YES              VALUE 'Y'.   08980005
089900             15  ASC-AUTO-VE-SW                      PIC X(01).   08990005
090000                 88  ASC-AUTO-VE-YES                 VALUE 'Y'.   09000005
090100                 88  ASC-AUTO-VE-NO                  VALUE 'N'.   09010005
090200                                                                  09020005
090300     COPY DPWS013.                                                09030005
090400                                                                  09040005
090500*----------------------------------------------------------------*09050005
090600*  COMMAREA LAYOUT FOR THE UNITS WORKED MODULE (PCKCS756)        *09060005
090700*----------------------------------------------------------------*09070005
090800     COPY PCWS238.                                                09080005
090900                                                                  09090005
091000/                                                                 09100005
091100*----------------------------------------------------------------*09110005
091200*                                                **   WR # 21361 *09120005
091300*  RECORD LAYOUT FOR LOGISTICS DOMAIN ITEM ACCESS MODULE         *09130005
091400*----------------------------------------------------------------*09140005
091500     COPY XLWS001.                                                09150005
091600*----------------------------------------------------------------*09160005
091700*   CHANGES MADE FOR WR # 21361 ENDS HERE.                        09170005
091800*----------------------------------------------------------------*09180005
091900                                                                  09190005
092000******************************************************************09200005
092100*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      09210005
092200*  UPC TABLE (SUT_OTBND_UPC)                                      09220005
092300******************************************************************09230005
092400     EXEC SQL                                                     09240005
092500         INCLUDE SUT00028                                         09250005
092600     END-EXEC.                                                    09260005
092700                                                                  09270005
092800******************************************************************09280005
092900*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      09290005
093000*  CARTON TABLE (SUT_OTBND_CART)                                  09300005
093100******************************************************************09310005
093200     EXEC SQL                                                     09320005
093300         INCLUDE SUT00024                                         09330005
093400     END-EXEC.                                                    09340005
093500                                                                  09350005
093600     EXEC SQL                                                     09360005
093700          INCLUDE TDISTHD                                         09370005
093800     END-EXEC.                                                    09380005
093900/                                                                 09390005
094000**        SUT_OTBND_PK                                            09400005
094100     EXEC SQL                                                     09410005
094200          INCLUDE SUT00041                                        09420005
094300     END-EXEC.                                                    09430005
094400                                                                  09440005
094500     EXEC SQL                                                     09450005
094600          INCLUDE TPOPRPK                                         09460005
094700     END-EXEC.                                                    09470005
094800                                                                  09480005
094900     EXEC SQL                                                     09490005
095000          INCLUDE TRECEIV                                         09500005
095100     END-EXEC.                                                    09510005
095200                                                                  09520005
095300     EXEC SQL                                                     09530005
095400          INCLUDE TRECITM                                         09540005
095500     END-EXEC.                                                    09550005
095600                                                                  09560005
095700     EXEC SQL                                                     09570005
095800          INCLUDE TRECDIS                                         09580005
095900     END-EXEC.                                                    09590005
096000                                                                  09600005
096100     EXEC SQL                                                     09610005
096200          INCLUDE TPURCHS                                         09620005
096300     END-EXEC.                                                    09630005
096400                                                                  09640005
096500     EXEC SQL                                                     09650005
096600          INCLUDE TPURITM                                         09660005
096700     END-EXEC.                                                    09670005
096800                                                                  09680005
096900     EXEC SQL                                                     09690005
097000          INCLUDE TDISTDT                                         09700005
097100     END-EXEC.                                                    09710005
097200                                                                  09720005
097300     EXEC SQL                                                     09730005
097400          INCLUDE TSHIPMT                                         09740005
097500     END-EXEC.                                                    09750005
097600                                                                  09760005
097700     EXEC SQL                                                     09770005
097800          INCLUDE TSHPTPO                                         09780005
097900     END-EXEC.                                                    09790005
098000                                                                  09800005
098100     EXEC SQL                                                     09810005
098200          INCLUDE TTRBNTF                                         09820005
098300     END-EXEC.                                                    09830005
098400                                                                  09840005
098500     EXEC SQL                                                     09850005
098600          INCLUDE TTRBRSN                                         09860005
098700     END-EXEC.                                                    09870005
098800                                                                  09880005
098900     EXEC SQL                                                     09890005
099000          INCLUDE XLT00025                                        09900037
099100     END-EXEC.                                                    09910005
099200                                                                  09920005
099210     EXEC SQL                                                     09921029
099220          INCLUDE TKRPRPM                                         09922029
099230     END-EXEC.                                                    09923029
099240                                                                  09924029
099300     EXEC SQL                                                     09930005
099400          INCLUDE SQLCA                                           09940005
099500     END-EXEC.                                                    09950005
099600                                                                  09960005
099700*---------------------------------------------------------------* 09970005
099800*    DRIVING CURSOR                                               09980005
099900*---------------------------------------------------------------* 09990005
100000     EXEC SQL                                                     10000005
100100          DECLARE STORE-CSR CURSOR FOR                            10010005
100200           SELECT                                                 10020005
100300                 STR_NBR                                          10030005
100400               , EXPTED_ALLOC_QTY                                 10040005
100500               , FCSE_ACTL_UNT_QTY                                10050005
100600               , ACTL_ALLOC_QTY                                   10060005
100700               , P2L_SPLT_UNT_QTY                                 10070005
100800               , PREPK_ODD_UNT_QTY                                10080005
100900               , FCSE_SPLT_UNT_QTY                                10090005
101000               , INPK_SPLT_UNT_QTY                                10100005
101100             FROM TDISTDT A                                       10110005
101200            WHERE                                                 10120005
101300                   A.ORD_NBR       = :DK-ORD-NBR                  10130005
101400              AND  A.RCVR_SEQ_NBR  = :DK-RCVR-NBR                 10140005
101500              AND  A.ORD_LNE_NBR   = :DK-LINE-NBR                 10150005
101600                                                                  10160005
101700              ORDER BY                                            10170005
101800                     STR_NBR                                      10180005
101900                                                                  10190005
102000     END-EXEC.                                                    10200005
102100                                                                  10210005
102200     EXEC SQL                                                     10220005
102300          DECLARE INVPAR-CSR CURSOR FOR                           10230005
102400              SELECT                                              10240005
102500                    A.LOC_NBR                                     10250005
102600              FROM                                                10260005
102700                    XLT_MDSE_INV_PARM A                           10270036
102800              WHERE                                               10280005
102900                   A.DC_CTOFF_DTE >= (CURRENT_DATE - 7 DAYS)      10290028
103000              AND  A.DC_CTOFF_DTE <= (CURRENT_DATE + 7 DAYS)      10300028
103010              AND  A.ACTV_IND         = 'Y'                       10301035
103020              AND  A.LOC_INV_STAT_CDE = 'IN'                      10302032
103100     END-EXEC.                                                    10310005
103200                                                                  10320005
103300*---------------------------------------------------------------* 10330005
103400*    THIS CURSOR CONTAINS ALL STORE NUMBERS ON TDISTDT FOR        10340005
103500*    A PO/RVCR/LINE                                               10350005
103600*---------------------------------------------------------------* 10360005
103700                                                                  10370005
103800     EXEC SQL                                                     10380005
103900          DECLARE TDISTDT-CSR CURSOR FOR                          10390005
104000           SELECT STR_NBR                                         10400005
104100             FROM TDISTDT A                                       10410005
104200           WHERE                                                  10420005
104300                  A.ORD_NBR      = :DISTHD-ORD-NBR                10430005
104400              AND A.RCVR_SEQ_NBR = :DISTHD-RCVR-SEQ-NBR           10440005
104500              AND A.ORD_LNE_NBR  = :DISTHD-ORD-LNE-NBR            10450005
104600              ORDER BY STR_NBR                                    10460005
104700     END-EXEC.                                                    10470005
104800                                                                  10480005
104900*---------------------------------------------------------------* 10490005
105000*  CURSOR TO SELECT DETAIL LINES (BY PACK ID)                   * 10500005
105100*---------------------------------------------------------------* 10510005
105200                                                                  10520005
105300     EXEC SQL                                                     10530005
105400          DECLARE PREPK-SEARCH-CSR CURSOR FOR                     10540005
105500           SELECT A.ORD_LNE_NBR                                   10550005
105600                , A.PREPK_RATO_QTY                                10560005
105700             FROM TRECITM A                                       10570005
105800            WHERE A.ORD_NBR        = :DK-ORD-NBR                  10580005
105900              AND A.REC_SEQ_NBR    = :DK-RCVR-NBR                 10590005
106000              AND A.PREPK_ID       = :DK-PACK-ID                  10600005
106100         ORDER BY A.ORD_LNE_NBR                                   10610005
106200     END-EXEC.                                                    10620005
106300                                                                  10630005
106400*---------------------------------------------------------------* 10640005
106500*---------------------------------------------------------------* 10650005
106600 LINKAGE SECTION.                                                 10660005
106700                                                                  10670005
106800 01  DFHCOMMAREA.                                                 10680005
106900     05  FILLER                         OCCURS  1 TO 4072 TIMES   10690005
107000                                        DEPENDING ON EIBCALEN.    10700005
107100         10  FILLER                   PIC X.                      10710005
107200                                                                  10720005
107300/                                                                 10730005
107400 PROCEDURE DIVISION.                                              10740005
107500*---------------------------------------------------------------* 10750005
107600*   THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. * 10760005
107700*   FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  * 10770005
107800*   PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. * 10780005
107900*---------------------------------------------------------------* 10790005
108000 0000-MAIN-MODULE.                                                10800005
108100                                                                  10810005
108200     INITIALIZE DP030-CICS-API-FIELDS.                            10820005
108300     INITIALIZE PT-PRE-PACK-UPDATE-TABLE.                         10830005
108400                                                                  10840005
108500     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       10850005
108600     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          10860005
108700     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         10870005
108800                                                                  10880005
108900     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       10890005
109000                                                                  10900005
109100     MOVE LENGTH OF RC298AI        TO DP030-MAP-LENGTH (1).       10910005
109200     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     10920005
109300                                                                  10930005
109400     PERFORM 0001-CALL-CICS-ARCH-API.                             10940005
109500     PERFORM 1000-CONTROL-PROCESSING                              10950005
109600                                                                  10960005
109700     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     10970005
109800     PERFORM 0001-CALL-CICS-ARCH-API.                             10980005
109900                                                                  10990005
110000*---------------------------------------------------------------* 11000005
110100*   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   * 11010005
110200*   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         * 11020005
110300*---------------------------------------------------------------* 11030005
110400 0001-CALL-CICS-ARCH-API.                                         11040005
110510     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      11051059
110600                                    DFHCOMMAREA                   11060059
110700                                    DP030-CICS-API-FIELDS         11070059
110800                                    DP020-STANDARD-COMMAREA       11080059
110900                                    RC298AI.                      11090059
111000                                                                  11100005
111100     IF  DP030-RC-CALL-SUCCESSFUL                                 11110005
111200         CONTINUE                                                 11120005
111300     ELSE                                                         11130005
111400         SET DP013-NO-ROLLBACK                                    11140005
111500             DP013-XCTL-DISPLAY-RESTART                           11150005
111600             DP013-CICS-ABEND      TO TRUE                        11160005
111700         MOVE '0001-CALL-CICS-ARCH-API'                           11170005
111800                                   TO DP013-PARAGRAPH             11180005
111820         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O11182059
111830-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      11183059
112100         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      11210005
112200         PERFORM DP013-0000-PROCESS-ABEND                         11220005
112300     END-IF.                                                      11230005
112400                                                                  11240005
112500*----------------------------------------------------------------*11250005
112600* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *11260005
112700* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *11270005
112800*                                                                *11280005
112900* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *11290005
113000*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *11300005
113100*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *11310005
113200*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *11320005
113300*----------------------------------------------------------------*11330005
113400                                                                  11340005
113500 1000-CONTROL-PROCESSING.                                         11350005
113600                                                                  11360005
113700                                                                  11370005
113800     EVALUATE TRUE                                                11380005
113900         WHEN DP020-NEXT-ACT-INITIAL                              11390005
114000             INITIALIZE ASC-SPECIFIC-COMMAREA                     11400005
114100             EXEC CICS                                            11410005
114200                 ASSIGN APPLID (ASC-CICS-SYSTEM)                  11420005
114300             END-EXEC                                             11430005
114400             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            11440005
114500                                      ASC-SEL-TERM-ID             11450005
114600             MOVE DP020-SRC-TASK-NUMBER                           11460005
114700                                   TO ASC-LIST-TASK-NUMBER        11470005
114800                                      ASC-SEL-TASK-NUMBER         11480005
114900             MOVE PC-LIST-QUEUE-SEQ                               11490005
115000                                   TO ASC-LIST-SEQ                11500005
115100             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 11510005
115200             PERFORM 1100-PROCESS-INTER-APPL-COMM                 11520005
115300                                                                  11530005
115400***-----$TEMPLATE NOTE$-------------------------------------------11540005
115500*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,11550005
115600*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  11560005
115700*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.11570005
115800***---------------------------------------------------------------11580005
115900             IF PS-COMMAREA-NOT-VALID                             11590005
116000***              MOVE PC-TSYMSG-99901 TO DP020-MSG-NUMBER         11600005
116100                 SET DP020-MSG-FATAL  TO TRUE                     11610005
116200                 SET DP020-NEXT-ACT-APPL-ERROR TO TRUE            11620005
116300             ELSE                                                 11630005
116400                 PERFORM 3200-RESET-ATTRIBUTES                    11640005
116500                 PERFORM 4000-BUILD-INITIAL-PANEL                 11650005
116600             END-IF                                               11660005
116700                                                                  11670005
116800         WHEN DP020-NEXT-ACT-READ-MAP                             11680005
116900             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        11690005
117000                                   TO PV-TOP-ITEM                 11700005
117100             PERFORM 2000-PROCESS-PANEL                           11710005
117200                                                                  11720005
117300         WHEN DP020-NEXT-ACT-RETURN                               11730005
117400             MOVE ASC-KEY-OPER-UNT-ID TO DK-OPER-UNT-ID           11740005
117500             MOVE ASC-KEY-FCLTY-ID    TO DK-FCLTY-ID              11750005
117600             MOVE ASC-KEY-PO-NBR      TO DK-ORD-NBR               11760005
117700             MOVE ASC-KEY-RCVR-NBR    TO DK-RCVR-NBR              11770005
117800             IF ASC-DISPLAY-FORMAT = '3'                          11780005
117900                 MOVE ASC-KEY-LNE-NBR TO DK-LINE-NBR              11790005
118000             ELSE                                                 11800005
118100                 IF ASC-PKGNG-CDE = 'I' OR 'M'                    11810005
118200                     MOVE ASC-DRV-LNE-NBR TO DK-LINE-NBR          11820005
118300                 ELSE                                             11830005
118400                     MOVE ASC-KEY-LNE-NBR TO DK-LINE-NBR          11840005
118500                 END-IF                                           11850005
118600             END-IF                                               11860005
118700                                                                  11870005
118800***      IF NOT (ASC-F22-RETURN-YES                               11880005
118900***           OR ASC-F23-RETURN-YES)                              11890005
119000***          SET DP013-LOGIC-ABEND TO TRUE                        11900005
119100***          SET DP013-NO-ROLLBACK TO TRUE                        11910005
119200***          MOVE '1000-CONTROL-PROCESSING'                       11920005
119300***                                TO DP013-PARAGRAPH             11930005
119400***          MOVE 'RETURN INDICATOR NOT IDENTIFIED'               11940005
119500***                                TO DP013-MESSAGE-TEXT(1)       11950005
119600***          PERFORM DP013-0000-PROCESS-ABEND                     11960005
119700***      END-IF                                                   11970005
119800             IF ASC-F22-RETURN-YES                                11980005
119900                 SET ASC-F22-RETURN-NO TO TRUE                    11990005
120000                 PERFORM 2050-DELETE-LIST-QUEUE                   12000005
120100                 PERFORM 3200-RESET-ATTRIBUTES                    12010005
120200                 PERFORM 4000-BUILD-INITIAL-PANEL                 12020005
120300             ELSE                                                 12030005
120400                 IF ASC-F23-RETURN-YES                            12040005
120500                     SET ASC-F23-RETURN-NO TO TRUE                12050005
120600                     MOVE ASC-ITEM-AT-TOP-OF-PANEL                12060005
120700                                       TO PV-TOP-ITEM             12070005
120800                     MOVE ZERO         TO ASC-ITEM-AT-TOP-OF-PANEL12080005
120900                     PERFORM 6000-REFRESH-PANEL-FROM-TEMP         12090005
121000                     PERFORM 3000-EDIT-DATA-IN-COMMAREA           12100005
121100                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         12110005
121200                 ELSE                                             12120005
121300                     MOVE ASC-ITEM-AT-TOP-OF-PANEL                12130005
121400                                       TO PV-TOP-ITEM             12140005
121500                     MOVE ZERO         TO ASC-ITEM-AT-TOP-OF-PANEL12150005
121600                     PERFORM 6000-REFRESH-PANEL-FROM-TEMP         12160005
121700                     PERFORM 3000-EDIT-DATA-IN-COMMAREA           12170005
121800                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         12180005
121900                 END-IF                                           12190005
122000             END-IF                                               12200005
122100                                                                  12210005
122200         WHEN OTHER                                               12220005
122300             SET DP013-LOGIC-ABEND TO TRUE                        12230005
122400             SET DP013-NO-ROLLBACK TO TRUE                        12240005
122500             MOVE '1000-CONTROL-PROCESSING'                       12250005
122600                                   TO DP013-PARAGRAPH             12260005
122700             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    12270005
122800                                   TO DP013-MESSAGE-TEXT(1)       12280005
122900             PERFORM DP013-0000-PROCESS-ABEND                     12290005
123000     END-EVALUATE.                                                12300005
123100                                                                  12310005
123200*----------------------------------------------------------------*12320005
123300* MOVE DATA PASSED THROUGH THE INTER-APPL COMMAREA               *12330005
123400*----------------------------------------------------------------*12340005
123500 1100-PROCESS-INTER-APPL-COMM.                                    12350005
123600                                                                  12360005
123700     SET PS-COMMAREA-VALID          TO TRUE.                      12370005
123800     MOVE SPACE                     TO ASC-START-ITEM-REQUEST.    12380005
123900     MOVE DP020-INT-APPL-FORMAT-IND TO ASC-DISPLAY-FORMAT.        12390005
124000                                                                  12400005
124100* ASC-LIST-FORMAT      = '1' (FROM RCKCS297)                      12410005
124200* ASC-CRIT-SPEC-FORMAT = '2' (FROM RCKCS296)                      12420005
124300* ASC-PACK-LINE-FORMAT = '3' (FROM RCKCS812)                      12430005
124400                                                                  12440005
124500     IF DP020-INT-APPL-FORMAT-IND = '1' OR '3'                    12450005
124600         SET ASC-USE-SELECTION-QUEUE TO TRUE                      12460005
124700         MOVE RC015-NUMBER-OF-SELECTED-ITEMS                      12470005
124800                                  TO ASC-NUMBER-OF-SELECTED-ITEMS 12480005
124900         MOVE RC015-NUMBER-OF-TS-ITEMS                            12490005
125000                                   TO ASC-NUMBER-OF-TS-ITEMS      12500005
125100         MOVE RC015-SEL-QUEUE-NAME                                12510005
125200                                   TO ASC-SEL-QUEUE-NAME-IN       12520005
125300         MOVE RC013-MAX-ITEMS      TO ASC-SEL-SUB                 12530005
125400         MOVE ZERO                 TO ASC-SEL-ITEM                12540005
125500         PERFORM 2300-GET-NEXT-RECORD                             12550005
125600         MOVE RC015-OPER-UNT-ID   TO ASC-KEY-OPER-UNT-ID          12560005
125700                                     ASC-OPER-UNT-ID              12570005
125800         MOVE RC015-FCLTY-ID      TO ASC-KEY-FCLTY-ID             12580005
125900                                     ASC-FCLTY-ID                 12590005
126000                                                                  12600005
126100         MOVE ASC-KEY-PO-NBR      TO DK-ORD-NBR                   12610005
126200         MOVE ASC-KEY-RCVR-NBR    TO DK-RCVR-NBR                  12620005
126300         PERFORM 7200-GET-RCVR-STATUS                             12630005
126400         IF SQLCODE NOT = +0                                      12640005
126500             MOVE PC-TSYMSG-01298 TO DP020-MSG-NUMBER             12650005
126600             SET PS-ERROR                                         12660005
126700                 PS-COMMAREA-NOT-VALID                            12670005
126800                 DP020-NEXT-ACT-APPL-ERROR                        12680005
126900                 DP020-MSG-FATAL   TO TRUE                        12690005
127000         END-IF                                                   12700005
127100*TO HANDLE ALREADY EXISTING ORDERS (PROCESSED BY LINE), CHECK     12710005
127200*DISTHD-PREPK-LNE-PRC-CDE FOR PACKS & PROCESS OLD WAY IF BLANK.   12720005
127300         IF ASC-PKGNG-CDE = 'I' OR 'M'                            12730005
127400             MOVE +0 TO PV-PREPK-BLANK-COUNT                      12740005
127500             PERFORM 4030-CHECK-DISTHD                            12750005
127600             IF PV-PREPK-BLANK-COUNT > +0                         12760005
127700                 MOVE 'X' TO ASC-PKGNG-CDE                        12770005
127800             END-IF                                               12780005
127900         END-IF                                                   12790005
128000                                                                  12800005
128100     ELSE                                                         12810005
128200     IF DP020-INT-APPL-FORMAT-IND = '2'                           12820005
128300         MOVE RC015-OPER-UNT-ID   TO ASC-KEY-OPER-UNT-ID          12830005
128400                                     ASC-OPER-UNT-ID              12840005
128500         MOVE RC015-FCLTY-ID      TO ASC-KEY-FCLTY-ID             12850005
128600                                     ASC-FCLTY-ID                 12860005
128700         MOVE RC015-PO-NBR        TO ASC-KEY-PO-NBR               12870005
128800         MOVE RC015-REC-SEQ-NBR   TO ASC-KEY-RCVR-NBR             12880005
128900         MOVE RC015-PO-LNE-NBR    TO ASC-KEY-LNE-NBR              12890005
129000                                                                  12900005
129100         MOVE ASC-KEY-PO-NBR      TO DK-ORD-NBR                   12910005
129200         MOVE ASC-KEY-RCVR-NBR    TO DK-RCVR-NBR                  12920005
129300         PERFORM 7200-GET-RCVR-STATUS                             12930005
129400         IF SQLCODE NOT = +0                                      12940005
129500             MOVE PC-TSYMSG-01298 TO DP020-MSG-NUMBER             12950005
129600             SET PS-ERROR                                         12960005
129700                 PS-COMMAREA-NOT-VALID                            12970005
129800                 DP020-NEXT-ACT-APPL-ERROR                        12980005
129900                 DP020-MSG-FATAL   TO TRUE                        12990005
130000         ELSE                                                     13000005
130100             IF ASC-PKGNG-CDE = 'I' OR 'M'                        13010005
130200                 MOVE PC-TSYMSG-02463 TO DP020-MSG-NUMBER         13020005
130300                 SET PS-ERROR                                     13030005
130400                     PS-COMMAREA-NOT-VALID                        13040005
130500                     DP020-NEXT-ACT-APPL-ERROR                    13050005
130600                     DP020-MSG-FATAL TO TRUE                      13060005
130700             END-IF                                               13070005
130800         END-IF                                                   13080005
130900     END-IF                                                       13090005
131000     END-IF.                                                      13100005
131100                                                                  13110005
131200*----------------------------------------------------------------*13120005
131300* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *13130005
131400* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *13140005
131500* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *13150005
131600* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *13160005
131700* FUNCTION KEYS CAN GET THIS FAR.                                *13170005
131800*----------------------------------------------------------------*13180005
131900 2000-PROCESS-PANEL.                                              13190005
132000                                                                  13200005
132100     SET PS-NEXT-SCREEN TO TRUE.                                  13210005
132200                                                                  13220005
132300     EVALUATE TRUE                                                13230005
132400         WHEN DP020-SRC-AID = DP016-CLEAR                         13240005
132500             MOVE ZEROES TO ASC-ITEM-AT-TOP-OF-PANEL              13250005
132600             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   13260005
132700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13270005
132800                                                                  13280005
132900         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    13290005
133000             MOVE ASC-KEY-OPER-UNT-ID TO DK-OPER-UNT-ID           13300005
133100             MOVE ASC-KEY-FCLTY-ID    TO DK-FCLTY-ID              13310005
133200             MOVE ASC-KEY-PO-NBR      TO DK-ORD-NBR               13320005
133300             MOVE ASC-KEY-RCVR-NBR    TO DK-RCVR-NBR              13330005
133400             IF ASC-DISPLAY-FORMAT = '3'                          13340005
133500                 MOVE ASC-KEY-LNE-NBR TO DK-LINE-NBR              13350005
133600             ELSE                                                 13360005
133700             IF ASC-PKGNG-CDE = 'I' OR 'M'                        13370005
133800                 MOVE ASC-DRV-LNE-NBR TO DK-LINE-NBR              13380005
133900             ELSE                                                 13390005
134000                 MOVE ASC-KEY-LNE-NBR TO DK-LINE-NBR              13400005
134100             END-IF                                               13410005
134200             END-IF                                               13420005
134300             MOVE ASC-KEY-OPER-UNT-ID TO DK-OPER-UNT-ID           13430005
134400             MOVE ASC-KEY-FCLTY-ID    TO DK-FCLTY-ID              13440005
134500             PERFORM 2050-DELETE-LIST-QUEUE                       13450005
134600             PERFORM 3200-RESET-ATTRIBUTES                        13460005
134700             PERFORM 4000-BUILD-INITIAL-PANEL                     13470005
134800                                                                  13480005
134900         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             13490005
135000             IF ASC-USE-SELECTION-QUEUE                           13500005
135100                 PERFORM 2300-GET-NEXT-RECORD                     13510005
135200                 IF PS-LIST-END                                   13520005
135300                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         13530005
135400                     SET PS-NO-LIST-END TO TRUE                   13540005
135500                 ELSE                                             13550005
135600                     PERFORM 2050-DELETE-LIST-QUEUE               13560005
135700                     PERFORM 3200-RESET-ATTRIBUTES                13570005
135800                     PERFORM 4000-BUILD-INITIAL-PANEL             13580005
135900                 END-IF                                           13590005
136000              ELSE                                                13600005
136100*                --- BOTTOM OF LIST ---                           13610005
136200                 MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER         13620005
136300                 SET DP020-MSG-INFORMATIONAL TO TRUE              13630005
136400             END-IF                                               13640005
136500                                                                  13650005
136600         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             13660005
136700             IF ASC-USE-SELECTION-QUEUE                           13670005
136800                 PERFORM 2310-GET-PREV-RECORD                     13680005
136900                 IF PS-LIST-END                                   13690005
137000                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         13700005
137100                     SET PS-NO-LIST-END TO TRUE                   13710005
137200                 ELSE                                             13720005
137300                     PERFORM 2050-DELETE-LIST-QUEUE               13730005
137400                     PERFORM 3200-RESET-ATTRIBUTES                13740005
137500                     PERFORM 4000-BUILD-INITIAL-PANEL             13750005
137600                 END-IF                                           13760005
137700             ELSE                                                 13770005
137800                 MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER         13780005
137900                 SET DP020-MSG-INFORMATIONAL TO TRUE              13790005
138000             END-IF                                               13800005
138100                                                                  13810005
138200         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    13820005
138300             PERFORM 2140-DESELECT-ALL-ITEMS                      13830005
138400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13840005
138500                                                                  13850005
138600         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  13860005
138700         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              13870005
138800             PERFORM 2150-SELECT-ALL-ITEMS                        13880005
138900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13890005
139000                                                                  13900005
139100         WHEN OTHER                                               13910005
139200             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 13920005
139300             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   13930005
139400             IF  PS-NO-ERROR                                      13940005
139500                 SET DP030-CONTINUE-GO TO TRUE                    13950005
139600                 PERFORM 2100-CHECK-FUNCTION-KEY                  13960005
139700             ELSE                                                 13970005
139800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             13980005
139900                 SET DP030-OVERRIDE-GO TO TRUE                    13990005
140000             END-IF                                               14000005
140100     END-EVALUATE.                                                14010005
140200                                                                  14020005
140300*----------------------------------------------------------------*14030005
140400*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *14040005
140500*----------------------------------------------------------------*14050005
140600 2050-DELETE-LIST-QUEUE.                                          14060005
140700                                                                  14070005
140800     EXEC CICS                                                    14080005
140900         DELETEQ TS                                               14090005
141000           QUEUE (ASC-LIST-QUEUE-NAME)                            14100005
141100            RESP (PV-CICS-RESP)                                   14110005
141200     END-EXEC.                                                    14120005
141300                                                                  14130005
141400*DMH     MOVE ASC-LIST-TERM-ID      TO PV-SEL-TERM-ID             14140005
141500*DMH     MOVE ASC-LIST-TASK-NUMBER  TO PV-SEL-TASK-NUMBER         14150005
141600*DMH     MOVE ASC-LIST-SEQ          TO PV-SEL-SEQ                 14160005
141700*DMH     STRING ' RCKCS298-DEL LST '  DELIMITED BY SIZE           14170005
141800*DMH            ' QUEUE TERM ID-'     DELIMITED BY SIZE           14180005
141900*DMH             PV-SEL-TERM-ID       DELIMITED BY SIZE           14190005
142000*DMH            ' QUEUE TASK-'        DELIMITED BY SIZE           14200005
142100*DMH             PV-SEL-TASK-NUMBER   DELIMITED BY SIZE           14210005
142200*DMH            ' QUEUE SEQ-'         DELIMITED BY SIZE           14220005
142300*DMH             PV-SEL-SEQ           DELIMITED BY SIZE           14230005
142400*DMH                             INTO  PV-CICS-MSG-AREA2          14240005
142500*DMH         MOVE LENGTH OF PV-CICS-MSG-AREA2                     14250005
142600*DMH           TO PV-COMMAREA-LENGTH                              14260005
142700*DMH         EXEC CICS                                            14270005
142800*DMH              WRITEQ TD                                       14280005
142900*DMH               QUEUE  ('CSSL')                                14290005
143000*DMH                FROM  (PV-CICS-MSG-AREA2)                     14300005
143100*DMH              LENGTH  (PV-COMMAREA-LENGTH)                    14310005
143200*DMH                RESP  (PV-CICS-RESP)                          14320005
143300*DMH         END-EXEC                                             14330005
143400                                                                  14340005
143500     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       14350005
143600        (PV-CICS-RESP = DFHRESP(QIDERR))                          14360005
143700         CONTINUE                                                 14370005
143800     ELSE                                                         14380005
143900         SET DP013-CICS-ABEND      TO TRUE                        14390005
144000         SET DP013-NO-ROLLBACK     TO TRUE                        14400005
144100                                                                  14410005
144200         MOVE '2050-DELETE-LIST-QUEUE'                            14420005
144300                                   TO DP013-PARAGRAPH             14430005
144400         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    14440005
144500                                   TO DP013-MESSAGE-TEXT (1)      14450005
144600         PERFORM DP013-0000-PROCESS-ABEND                         14460005
144700     END-IF.                                                      14470005
144800                                                                  14480005
144900     MOVE ZERO                     TO ASC-HIGHEST-BLOCK-WRITTEN.  14490005
145000                                                                  14500005
145100*----------------------------------------------------------------*14510005
145200* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*14520005
145300* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *14530005
145400* CICS ARCHITECTURE API.                                         *14540005
145500*----------------------------------------------------------------*14550005
145600 2100-CHECK-FUNCTION-KEY.                                         14560005
145700                                                                  14570005
145800     SET PS-NEXT-SCREEN TO TRUE.                                  14580005
145900                                                                  14590005
146000     EVALUATE TRUE                                                14600005
146100                                                                  14610005
146200*F15   UPDATE FULLCASE QTY                                        14620005
146300     WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)                  14630005
146400       IF ASC-AUTO-VE-YES                                         14640005
146500             MOVE PC-TSYMSG-03302      TO DP020-MSG-NUMBER        14650005
146600             SET DP020-MSG-FATAL       TO TRUE                    14660005
146700             MOVE -1                   TO MR-SELECTL (1)          14670005
146800             SET DP030-SET-CURSOR-APPL-1                          14680005
146900                                   TO TRUE                        14690005
147000             SET PS-ERROR              TO TRUE                    14700005
147100             SET ASC-NO-TSQ-UPDATE TO TRUE                        14710005
147200*DMH   ELSE                                                       14720005
147300*DMH       SET RC039-FUNC-CNFM           TO TRUE                  14730005
147400*DMH       PERFORM 2108-LINK-FKEY-MODULE                          14740005
147500*DMH   END-IF                                                     14750005
147600                                                                  14760005
147700*DMH   IF (ASC-AUTO-VE-YES  AND                                   14770005
147800*DMH       RC039-SUCCESSFUL AND                                   14780005
147900*DMH       PS-FUNCTION-RACF-YES)                                  14790005
148000       ELSE                                                       14800005
148100         IF ASC-PROTECT-ALL-STORES                                14810005
148200             MOVE PC-TSYMSG-00966      TO DP020-MSG-NUMBER        14820005
148300             SET DP020-MSG-FATAL       TO TRUE                    14830005
148400             MOVE -1                   TO MR-SELECTL (1)          14840005
148500             SET DP030-SET-CURSOR-APPL-1                          14850005
148600                                   TO TRUE                        14860005
148700             SET PS-ERROR              TO TRUE                    14870005
148800             SET ASC-NO-TSQ-UPDATE TO TRUE                        14880005
148900         ELSE                                                     14890005
149000             IF  ASC-NUMBER-OF-SELECTED-ITEMS = ZERO              14900005
149100                 MOVE PC-TSYMSG-00057      TO DP020-MSG-NUMBER    14910005
149200                 SET DP020-MSG-FATAL       TO TRUE                14920005
149300                 MOVE -1                   TO MR-SELECTL (1)      14930005
149400                 SET DP030-SET-CURSOR-APPL-1                      14940005
149500                                       TO TRUE                    14950005
149600                 SET PS-ERROR              TO TRUE                14960005
149700                 SET ASC-NO-TSQ-UPDATE TO TRUE                    14970005
149800             ELSE                                                 14980005
149900                 PERFORM 8000-UPDATE-STORE                        14990005
150000                     VARYING PV-ITEM  FROM 1 BY 1                 15000005
150100                     UNTIL PV-ITEM >  ASC-HIGHEST-BLOCK-WRITTEN   15010005
150200                 MOVE PC-TSYMSG-00059  TO DP020-MSG-NUMBER        15020005
150300                 SET DP020-MSG-INFORMATIONAL TO TRUE              15030005
150400                 IF  PS-TDISTDT-UPDATE-DONE                       15040005
150500                     IF  PS-PRE-PACK                              15050005
150600                         PERFORM 7900-PRE-PACK-UNITS-WORK         15060005
150700                     ELSE                                         15070005
150800                         IF  PA-ACCUM-UPDATE-QTY NOT EQUAL TO ZERO15080005
150900                             PERFORM 7800-UNITS-WORK-ROUTINE      15090005
151000                         END-IF                                   15100005
151100                     END-IF                                       15110005
151200                 END-IF                                           15120005
151300             END-IF                                               15130005
151400         END-IF                                                   15140005
151500       END-IF                                                     15150005
151600                                                                  15160005
151700     WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)                  15170005
151800*  ADD STORE                                                      15180005
151900         IF ASC-PROTECT-ALL-STORES                                15190005
152000             MOVE PC-TSYMSG-00966      TO DP020-MSG-NUMBER        15200005
152100             SET DP020-MSG-FATAL                                  15210005
152200                 DP030-OVERRIDE-GO     TO TRUE                    15220005
152300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 15230005
152400         ELSE                                                     15240005
152500*            MOVE ASC-KEY-OPER-UNT-ID  TO RC015-OPER-UNT-ID       15250005
152600             MOVE ASC-RCVR-OPER-UNT-ID TO RC015-OPER-UNT-ID       15260005
152700             MOVE ASC-KEY-FCLTY-ID     TO RC015-FCLTY-ID          15270005
152800             MOVE ASC-KEY-PO-NBR       TO RC015-PO-NBR            15280005
152900             MOVE ASC-KEY-RCVR-NBR     TO RC015-REC-SEQ-NBR       15290005
153000             MOVE ASC-KEY-LNE-NBR      TO RC015-PKSL-LNE-NBR      15300005
153100             IF ASC-PKGNG-CDE = 'I' OR 'M'                        15310005
153200                 MOVE ASC-KEY-PACK-ID  TO RC015-PO-PACK-ID        15320005
153300                 MOVE ASC-DRV-LNE-NBR  TO RC015-PO-LNE-NBR        15330005
153400             END-IF                                               15340005
153500             SET ASC-F22-RETURN-YES    TO TRUE                    15350005
153600         END-IF                                                   15360005
153700                                                                  15370005
153800*F23=BYSTRLNE (RCKCS813)                                          15380005
153900     WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)                  15390005
154000         IF ASC-PKGNG-CDE = 'I' OR 'M'                            15400005
154100             MOVE PC-TSYMSG-02475      TO DP020-MSG-NUMBER        15410005
154200             SET DP020-MSG-FATAL                                  15420005
154300                 DP030-OVERRIDE-GO     TO TRUE                    15430005
154400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 15440005
154500         ELSE                                                     15450005
154600         IF ASC-NUMBER-OF-SELECTED-ITEMS = ZERO                   15460005
154700             MOVE PC-TSYMSG-00057   TO DP020-MSG-NUMBER           15470005
154800             SET DP020-MSG-FATAL    TO TRUE                       15480005
154900             MOVE -1                TO MR-SELECTL (1)             15490005
155000             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  15500005
155100             SET PS-ERROR           TO TRUE                       15510005
155200             SET ASC-NO-TSQ-UPDATE  TO TRUE                       15520005
155300         ELSE                                                     15530005
155400             MOVE ASC-NUMBER-OF-SELECTED-ITEMS                    15540005
155500                                    TO RC013-SELECTED-ITEMS       15550005
155600             PERFORM 5000-PREPARE-SEL-QUEUE                       15560005
155700             MOVE ASC-NUMBER-OF-SELECTED-ITEMS                    15570005
155800               TO RC015-NUMBER-OF-SELECTED-ITEMS                  15580005
155900             SET ASC-F23-RETURN-YES TO TRUE                       15590005
156000         END-IF                                                   15600005
156100         END-IF                                                   15610005
156200                                                                  15620005
156300     WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                      15630005
156400             MOVE +1 TO PV-TOP-ITEM                               15640005
156500             PERFORM 3200-RESET-ATTRIBUTES                        15650005
156600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 15660005
156700                                                                  15670005
156800     WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                       15680005
156900             PERFORM 2110-BROWSE-BACKWARD                         15690005
157000             PERFORM 3200-RESET-ATTRIBUTES                        15700005
157100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 15710005
157200                                                                  15720005
157300     WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                       15730005
157400             PERFORM 2120-BROWSE-FORWARD                          15740005
157500             PERFORM 3200-RESET-ATTRIBUTES                        15750005
157600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 15760005
157700                                                                  15770005
157800     WHEN DP020-SRC-AID = DP016-ENTER                             15780005
157900             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   15790005
158000             IF PS-NO-ERROR                                       15800005
158100                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             15810005
158200             END-IF                                               15820005
158300                                                                  15830005
158400     WHEN OTHER                                                   15840005
158500         PERFORM 2050-DELETE-LIST-QUEUE                           15850005
158600         PERFORM 4000-BUILD-INITIAL-PANEL                         15860005
158700         PERFORM 3200-RESET-ATTRIBUTES                            15870005
158800         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     15880005
158900     END-EVALUATE.                                                15890005
159000                                                                  15900005
159100*----------------------------------------------------------------*15910005
159200*    LINK TO F-KEY ELIGIBILITY MODULE (RCKUT126)                 *15920005
159300*----------------------------------------------------------------*15930005
159400 2108-LINK-FKEY-MODULE.                                           15940005
159500                                                                  15950005
159600     MOVE DP020-LOCATION-NBR TO RC039-SIGNON-LOCATION.            15960005
159700     MOVE ASC-OPER-UNT-ID   TO RC039-OPER-UNT-ID                  15970005
159800                               PV-OPER-UNT-ID.                    15980005
159900     MOVE ASC-FCLTY-ID      TO RC039-FCLTY-ID                     15990005
160000                               PV-FCLTY-ID.                       16000005
160100     MOVE ASC-ORD-NBR       TO RC039-PO-NBR                       16010005
160200                               PV-PO-NBR.                         16020005
160300     MOVE ASC-RCVR-NBR      TO RC039-REC-SEQ-NBR                  16030005
160400                               PV-RCVR-NBR.                       16040005
160500     MOVE DK-LINE-NBR       TO RC039-PO-LNE-NBR                   16050005
160600                               PV-LINE-NBR.                       16060005
160700     MOVE ASC-PACK-ID       TO RC039-PREPACK-ID                   16070005
160800                               PV-PACK-ID.                        16080005
160900     MOVE DP020-USERID      TO RC039-USER-ID.                     16090005
161000     MOVE 'RCKCS298'        TO RC039-PROGRAM-NAME.                16100005
161100                                                                  16110005
161200     EXEC CICS                                                    16120005
161300          LINK PROGRAM (PC-FKEY-MODULE)                           16130005
161400          COMMAREA (RC039-FIELDS)                                 16140005
161500          LENGTH (PC-FKEY-MODULE-LENGTH)                          16150005
161600          RESP (PV-CICS-RESP)                                     16160005
161700     END-EXEC.                                                    16170005
161800                                                                  16180005
161900     EVALUATE TRUE                                                16190005
162000         WHEN RC039-SUCCESSFUL                                    16200005
162100             IF RC039-FUNCTION-YES                                16210005
162200                 SET  PS-FUNCTION-RACF-YES  TO  TRUE              16220005
162300             ELSE                                                 16230005
162400                 SET  PS-FUNCTION-RACF-NO   TO  TRUE              16240005
162500                 PERFORM 2109-PROCESS-NO-FUNCTION                 16250005
162600             END-IF                                               16260005
162700                                                                  16270005
162800         WHEN RC039-DATABASE-BUSY                                 16280005
162900             MOVE PC-TSYMSG-00984     TO DP020-MSG-NUMBER         16290005
163000             SET DP020-MSG-WARNING    TO TRUE                     16300005
163100                                                                  16310005
163200         WHEN RC039-INVALID-SQL                                   16320005
163300             MOVE PC-TSYMSG-00984     TO DP020-MSG-NUMBER         16330005
163400             SET DP020-MSG-WARNING    TO TRUE                     16340005
163500                                                                  16350005
163600         WHEN OTHER                                               16360005
163700             MOVE '2108-LINK-FKEY-MODULE' TO DP013-PARAGRAPH      16370005
163800             MOVE 'UNSUCCESSFUL CALL TO FKEY ELIGIBILITY MODULE'  16380005
163900                                 TO DP013-MESSAGE-TEXT (1)        16390005
164000             MOVE RC039-SUCCESS-IND TO DP013-MESSAGE-TEXT (2)     16400005
164100             MOVE RC039-CRA-RET-MSG TO DP013-MESSAGE-TEXT (3)     16410005
164200             MOVE DP020-LOCATION-NBR  TO  PC-DISPLAY-SIGNON       16420005
164300                 STRING ' LOCATION ='                             16430005
164400                        PC-DISPLAY-SIGNON                         16440005
164500                        ' USER = '                                16450005
164600                        DP020-USERID                              16460005
164700                        ' PO = '                                  16470005
164800                        PV-PO-NBR                                 16480005
164900                        ' RECV ='                                 16490005
165000                        PV-RCVR-NBR                               16500005
165100                        ' OPER = '                                16510005
165200                        PV-OPER-UNT-ID                            16520005
165300                        ' FCLTY = '                               16530005
165400                        PV-FCLTY-ID                               16540005
165500                        ' PO LINE = '                             16550005
165600                        PV-LINE-NBR                               16560005
165700                        ' PREPACK ID = '                          16570005
165800                        PV-PACK-ID        DELIMITED BY SIZE       16580005
165900                                 INTO DP013-MESSAGE-TEXT (4)      16590005
166000             MOVE RC039-SQLCA    TO DP013-SQLCA                   16600005
166100             SET DP013-DB2-ABEND                                  16610005
166200                 DP013-XCTL-DISPLAY-RESTART  TO TRUE              16620005
166300             PERFORM DP013-0000-PROCESS-ABEND                     16630005
166400     END-EVALUATE.                                                16640005
166500                                                                  16650005
166600*----------------------------------------------------------------*16660005
166700*    PROCESS NO FUNCTION REASON RETURNED FROM COMMAREA RCWS039   *16670005
166800*    AND SEND ERROR MESSAGE TO SCREEN.                           *16680005
166900*----------------------------------------------------------------*16690005
167000 2109-PROCESS-NO-FUNCTION.                                        16700005
167100                                                                  16710005
167200     EVALUATE TRUE                                                16720005
167300         WHEN RC039-FUNC-CNFM                                     16730005
167400             MOVE PC-TSYMSG-03136     TO DP020-MSG-NUMBER         16740005
167500             SET DP020-MSG-WARNING    TO TRUE                     16750005
167600         WHEN RC039-FUNC-UNCNFM                                   16760005
167700             MOVE PC-TSYMSG-03136     TO DP020-MSG-NUMBER         16770005
167800             SET DP020-MSG-WARNING    TO TRUE                     16780005
167900         WHEN RC039-FUNC-VRFY                                     16790005
168000             MOVE PC-TSYMSG-03135     TO DP020-MSG-NUMBER         16800005
168100             SET DP020-MSG-WARNING    TO TRUE                     16810005
168200         WHEN RC039-FUNC-UNVRFY                                   16820005
168300             MOVE PC-TSYMSG-03135     TO DP020-MSG-NUMBER         16830005
168400             SET DP020-MSG-WARNING    TO TRUE                     16840005
168500         WHEN RC039-FUNC-SMOOTH                                   16850005
168600*            MOVE PC-TSYMSG-03135     TO DP020-MSG-NUMBER         16860005
168700             SET DP020-MSG-WARNING    TO TRUE                     16870005
168800         WHEN RC039-FUNC-PHY-LBL                                  16880005
168900*            MOVE PC-TSYMSG-03135     TO DP020-MSG-NUMBER         16890005
169000             SET DP020-MSG-WARNING    TO TRUE                     16900005
169100         WHEN RC039-PO-AUTOVE-CHECK                               16910005
169200*            MOVE PC-TSYMSG-03135     TO DP020-MSG-NUMBER         16920005
169300             SET DP020-MSG-WARNING    TO TRUE                     16930005
169400     END-EVALUATE.                                                16940005
169500                                                                  16950005
169600*----------------------------------------------------------------*16960005
169700*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *16970005
169800*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *16980005
169900*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *16990005
170000*    MESSAGE.                                                    *17000005
170100*----------------------------------------------------------------*17010005
170200                                                                  17020005
170300 2110-BROWSE-BACKWARD.                                            17030005
170400                                                                  17040005
170500     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    17050005
170600         GIVING PV-TOP-ITEM.                                      17060005
170700                                                                  17070005
170800     IF  ((PV-TOP-ITEM < +1)                                      17080005
170900       OR (PV-TOP-ITEM = +1))                                     17090005
171000         MOVE +1                   TO PV-TOP-ITEM                 17100005
171100*        -- TOP OF LIST --                                        17110005
171200         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            17120005
171300         SET DP020-MSG-INFORMATIONAL                              17130005
171400                                   TO TRUE                        17140005
171500     END-IF.                                                      17150005
171600                                                                  17160005
171700*----------------------------------------------------------------*17170005
171800*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *17180005
171900*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *17190005
172000*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *17200005
172100*----------------------------------------------------------------*17210005
172200                                                                  17220005
172300 2120-BROWSE-FORWARD.                                             17230005
172400                                                                  17240005
172500     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              17250005
172600         GIVING PV-TOP-ITEM.                                      17260005
172700                                                                  17270005
172800     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   17280005
172900         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            17290005
173000                                   TO PV-TOP-ITEM                 17300005
173100*        -- BOTTOM OF LIST --                                     17310005
173200         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            17320005
173300         SET DP020-MSG-INFORMATIONAL                              17330005
173400                                   TO TRUE                        17340005
173500     ELSE                                                         17350005
173600         COMPUTE PV-BOTTOM-ITEM =                                 17360005
173700             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 17370005
173800         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            17380005
173900*            -- BOTTOM OF LIST --                                 17390005
174000             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            17400005
174100             SET DP020-MSG-INFORMATIONAL                          17410005
174200                                   TO TRUE                        17420005
174300         END-IF                                                   17430005
174400     END-IF.                                                      17440005
174500                                                                  17450005
174600*----------------------------------------------------------------*17460005
174700*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *17470005
174800*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *17480005
174900*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *17490005
175000*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *17500005
175100*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *17510005
175200*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *17520005
175300*----------------------------------------------------------------*17530005
175400                                                                  17540005
175500 2130-CHECK-FOR-JUMP-BROWSE.                                      17550005
175600                                                                  17560005
175700     SET PS-NO-ERROR               TO TRUE.                       17570005
175800     IF (ASC-START-ITEM-REQUEST = SPACE)                          17580005
175900         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            17590005
176000                                   TO PV-TOP-ITEM                 17600005
176100     ELSE                                                         17610005
176200         MOVE ASC-START-ITEM-REQUEST                              17620005
176300                                   TO DP010I-UNEDITED-FIELD       17630005
176400         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       17640005
176500         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     17650005
176600         SET DP010I-NEGATIVE-NOT-ALLOWED                          17660005
176700                                   TO TRUE                        17670005
176810         CALL DP010I-NUMERIC-EDIT-ROUTINE                         17681058
176820              USING DP010I-NUMERIC-EDIT-AREA                      17682058
176900                                                                  17690005
177000         IF  NOT DP010I-ERROR-DETECTED                            17700005
177100             MOVE DP010I-NUMERIC-FIELD                            17710005
177200                                   TO ASC-START-ITEM-REQUEST-N    17720005
177300             IF  ASC-START-ITEM-REQUEST-N > ZERO                  17730005
177400                 IF  ASC-START-ITEM-REQUEST-N >                   17740005
177500                                          ASC-NUMBER-OF-ITEMS-READ17750005
177600                     MOVE SPACE TO ASC-START-ITEM-REQUEST         17760005
177700                     COMPUTE PV-TOP-ITEM =                        17770005
177800                             ASC-NUMBER-OF-ITEMS-READ             17780005
177900                             - PC-ITEMS-PER-PANEL + 1             17790005
178000                     IF  PV-TOP-ITEM < +1                         17800005
178100                         MOVE +1   TO PV-TOP-ITEM                 17810005
178200                         MOVE PC-TSYMSG-00070                     17820005
178300                                   TO DP020-MSG-NUMBER            17830005
178400                         SET DP020-MSG-INFORMATIONAL              17840005
178500                                   TO TRUE                        17850005
178600                     END-IF                                       17860005
178700                 ELSE                                             17870005
178800                     MOVE ASC-START-ITEM-REQUEST-N                17880005
178900                                   TO PV-TOP-ITEM                 17890005
179000                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      17900005
179100                     COMPUTE PV-BOTTOM-ITEM =                     17910005
179200                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     17920005
179300                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ17930005
179400*                        -- BOTTOM OF LIST --                     17940005
179500                         MOVE PC-TSYMSG-00070                     17950005
179600                                   TO DP020-MSG-NUMBER            17960005
179700                         SET DP020-MSG-INFORMATIONAL              17970005
179800                                   TO TRUE                        17980005
179900                     END-IF                                       17990005
180000                 END-IF                                           18000005
180100             ELSE                                                 18010005
180200*                --- VALUE OUT OF RANGE ----                      18020005
180300                 MOVE PC-TSYMSG-00101                             18030005
180400                                   TO DP020-MSG-NUMBER            18040005
180500                 MOVE -1           TO ASTRTITL                    18050005
180600                 SET DP030-SET-CURSOR-APPL-1                      18060005
180700                                   TO TRUE                        18070005
180800                 MOVE DP015-REVERSE                               18080005
180900                                   TO ASTRTITH                    18090005
181000                 MOVE DP015-RED    TO ASTRTITC                    18100005
181100                 MOVE DP015-UNP-NUM-BRT-MDT                       18110005
181200                                   TO ASTRTITA                    18120005
181300                 SET DP020-MSG-FATAL                              18130005
181400                                   TO TRUE                        18140005
181500                 SET PS-ERROR      TO TRUE                        18150005
181600             END-IF                                               18160005
181700                                                                  18170005
181800         ELSE                                                     18180005
181900             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            18190005
182000             MOVE -1               TO ASTRTITL                    18200005
182100             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  18210005
182200             MOVE DP015-REVERSE    TO ASTRTITH                    18220005
182300             MOVE DP015-RED        TO ASTRTITC                    18230005
182400             MOVE DP015-UNP-NUM-BRT-MDT                           18240005
182500                                   TO ASTRTITA                    18250005
182600             SET DP020-MSG-FATAL   TO TRUE                        18260005
182700             SET PS-ERROR          TO TRUE                        18270005
182800         END-IF                                                   18280005
182900     END-IF.                                                      18290005
183000                                                                  18300005
183100*----------------------------------------------------------------*18310005
183200*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *18320005
183300*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *18330005
183400*----------------------------------------------------------------*18340005
183500 2140-DESELECT-ALL-ITEMS.                                         18350005
183600                                                                  18360005
183700     MOVE +1                       TO ASC-BLK-SUB.                18370005
183800                                                                  18380005
183900     PERFORM 2141-CLEAR-SELECTED-INDS                             18390005
184000         VARYING ASC-ITEM-SUB                                     18400005
184100         FROM 1 BY 1                                              18410005
184200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 18420005
184300                                                                  18430005
184400     ADD +1                        TO ASC-BLK-SUB.                18440005
184500                                                                  18450005
184600     PERFORM 2141-CLEAR-SELECTED-INDS                             18460005
184700         VARYING ASC-ITEM-SUB                                     18470005
184800         FROM 1 BY 1                                              18480005
184900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 18490005
185000                                                                  18500005
185100     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               18510005
185200                                   TO PV-LIST-ITEM-NUMBER.        18520005
185300                                                                  18530005
185400     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            18540005
185500         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    18550005
185600                                                                  18560005
185700     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     18570005
185800        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      18580005
185900         MOVE +1                   TO ASC-BLK-SUB                 18590005
186000                                                                  18600005
186100         PERFORM 5100-WRITE-TEMP-STORAGE                          18610005
186200                                                                  18620005
186300         MOVE +1                   TO PV-BLOCK-NUMBER             18630005
186400                                                                  18640005
186500         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         18650005
186600             PV-FIRST-BLOCK-IN-ARRAY - 1                          18660005
186700                                                                  18670005
186800         PERFORM                                                  18680005
186900             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       18690005
187000                                                                  18700005
187100             PERFORM 4410-READ-TEMP-STORAGE                       18710005
187200                                                                  18720005
187300             PERFORM 2141-CLEAR-SELECTED-INDS                     18730005
187400                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 18740005
187500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          18750005
187600                                                                  18760005
187700             PERFORM 5100-WRITE-TEMP-STORAGE                      18770005
187800                                                                  18780005
187900             ADD +1                TO PV-BLOCK-NUMBER             18790005
188000                                                                  18800005
188100         END-PERFORM                                              18810005
188200                                                                  18820005
188300         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         18830005
188400             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     18840005
188500                                                                  18850005
188600         PERFORM                                                  18860005
188700             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       18870005
188800                   ASC-HIGHEST-BLOCK-WRITTEN                      18880005
188900                                                                  18890005
189000             MOVE PV-NEXT-BLOCK-IN-ARRAY                          18900005
189100                                   TO PV-BLOCK-NUMBER             18910005
189200                                                                  18920005
189300             PERFORM 4410-READ-TEMP-STORAGE                       18930005
189400                                                                  18940005
189500             PERFORM 2141-CLEAR-SELECTED-INDS                     18950005
189600                 VARYING ASC-ITEM-SUB                             18960005
189700                 FROM 1 BY 1                                      18970005
189800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          18980005
189900                                                                  18990005
190000             PERFORM 5100-WRITE-TEMP-STORAGE                      19000005
190100                                                                  19010005
190200             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      19020005
190300                                                                  19030005
190400         END-PERFORM                                              19040005
190500                                                                  19050005
190600         MOVE PV-FIRST-BLOCK-IN-ARRAY                             19060005
190700                                   TO PV-BLOCK-NUMBER             19070005
190800                                                                  19080005
190900         PERFORM 4410-READ-TEMP-STORAGE                           19090005
191000     END-IF.                                                      19100005
191100                                                                  19110005
191200                                                                  19120005
191300     MOVE ZERO                     TO ASC-NUMBER-OF-SELECTED-ITEMS19130005
191400     MOVE ZERO                     TO ASC-START-OF-SELECTED-RANGE.19140005
191500     MOVE ZERO                     TO ASC-END-OF-SELECTED-RANGE.  19150005
191600                                                                  19160005
191700     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        19170005
191800                                                                  19180005
191900*----------------------------------------------------------------*19190005
192000*    MARK EACH ITEM AS BEING NOT SELECTED.                       *19200005
192100*----------------------------------------------------------------*19210005
192200                                                                  19220005
192300 2141-CLEAR-SELECTED-INDS.                                        19230005
192400                                                                  19240005
192500     IF  ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)          19250005
192600             NOT EQUAL ZERO                                       19260005
192700         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          19270005
192800             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          19280005
192900                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    19290005
193000                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  19300005
193100                                   TO TRUE                        19310005
193200         END-IF                                                   19320005
193300     END-IF.                                                      19330005
193400                                                                  19340005
193500*----------------------------------------------------------------*19350005
193600*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *19360005
193700*  FOR ALL ITEMS.                                                *19370005
193800*----------------------------------------------------------------*19380005
193900                                                                  19390005
194000 2150-SELECT-ALL-ITEMS.                                           19400005
194100                                                                  19410005
194200     MOVE +1                       TO ASC-BLK-SUB.                19420005
194300                                                                  19430005
194400     PERFORM 2151-SET-SELECTED-INDS                               19440005
194500         VARYING ASC-ITEM-SUB                                     19450005
194600         FROM 1 BY 1                                              19460005
194700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 19470005
194800                                                                  19480005
194900     ADD +1                        TO ASC-BLK-SUB.                19490005
195000                                                                  19500005
195100     PERFORM 2151-SET-SELECTED-INDS                               19510005
195200         VARYING ASC-ITEM-SUB                                     19520005
195300         FROM 1 BY 1                                              19530005
195400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 19540005
195500                                                                  19550005
195600     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               19560005
195700                                   TO PV-LIST-ITEM-NUMBER.        19570005
195800                                                                  19580005
195900     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            19590005
196000         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    19600005
196100                                                                  19610005
196200     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     19620005
196300        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    19630005
196400         MOVE +1                   TO ASC-BLK-SUB                 19640005
196500                                                                  19650005
196600         PERFORM 5100-WRITE-TEMP-STORAGE                          19660005
196700                                                                  19670005
196800         MOVE +1                   TO PV-BLOCK-NUMBER             19680005
196900                                                                  19690005
197000         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         19700005
197100             PV-FIRST-BLOCK-IN-ARRAY - 1                          19710005
197200                                                                  19720005
197300         PERFORM                                                  19730005
197400             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       19740005
197500                                                                  19750005
197600             PERFORM 4410-READ-TEMP-STORAGE                       19760005
197700                                                                  19770005
197800             PERFORM 2151-SET-SELECTED-INDS                       19780005
197900                 VARYING ASC-ITEM-SUB                             19790005
198000                 FROM 1 BY 1                                      19800005
198100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          19810005
198200                                                                  19820005
198300             PERFORM 5100-WRITE-TEMP-STORAGE                      19830005
198400                                                                  19840005
198500             ADD +1                TO PV-BLOCK-NUMBER             19850005
198600         END-PERFORM                                              19860005
198700                                                                  19870005
198800         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         19880005
198900             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     19890005
199000                                                                  19900005
199100         PERFORM                                                  19910005
199200             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       19920005
199300                   ASC-HIGHEST-BLOCK-WRITTEN                      19930005
199400                                                                  19940005
199500             MOVE PV-NEXT-BLOCK-IN-ARRAY                          19950005
199600                                   TO PV-BLOCK-NUMBER             19960005
199700                                                                  19970005
199800             PERFORM 4410-READ-TEMP-STORAGE                       19980005
199900                                                                  19990005
200000             PERFORM 2151-SET-SELECTED-INDS                       20000005
200100                 VARYING ASC-ITEM-SUB                             20010005
200200                 FROM 1 BY 1                                      20020005
200300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          20030005
200400                                                                  20040005
200500             PERFORM 5100-WRITE-TEMP-STORAGE                      20050005
200600                                                                  20060005
200700             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      20070005
200800         END-PERFORM                                              20080005
200900                                                                  20090005
201000         MOVE PV-FIRST-BLOCK-IN-ARRAY                             20100005
201100                                   TO PV-BLOCK-NUMBER             20110005
201200                                                                  20120005
201300         PERFORM 4410-READ-TEMP-STORAGE                           20130005
201400     END-IF.                                                      20140005
201500                                                                  20150005
201600                                                                  20160005
201700     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             20170005
201800          ASC-NUMBER-OF-SELECTED-ITEMS.                           20180005
201900                                                                  20190005
202000     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        20200005
202100                                                                  20210005
202200*----------------------------------------------------------------*20220005
202300*    MARK EACH ITEM AS BEING SELECTED.                           *20230005
202400*----------------------------------------------------------------*20240005
202500                                                                  20250005
202600 2151-SET-SELECTED-INDS.                                          20260005
202700                                                                  20270005
202800     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           20280005
202900             NOT EQUAL ZERO                                       20290005
203000         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             20300005
203100             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             20310005
203200                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        20320005
203300                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  20330005
203400                                   TO TRUE                        20340005
203500         END-IF                                                   20350005
203600         IF DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)                20360005
203700             MOVE ZEROES TO ASC-U-PROCESS-QTY                     20370005
203800                                  (ASC-BLK-SUB ASC-ITEM-SUB)      20380005
203900             SET ASC-SEL-ZERO-YES (ASC-BLK-SUB ASC-ITEM-SUB)      20390005
204000                         TO TRUE                                  20400005
204100         END-IF                                                   20410005
204200     END-IF.                                                      20420005
204300                                                                  20430005
204400*----------------------------------------------------------------*20440005
204500*  MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE     *20450005
204600*  SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM.  *20460005
204700*----------------------------------------------------------------*20470005
204800 2200-MOVE-SCREEN-TO-COMMAREA.                                    20480005
204900                                                                  20490005
205000     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             20500005
205100     MOVE +1                       TO PV-SUB.                     20510005
205200                                                                  20520005
205300     PERFORM 3100-SET-SUBSCRIPTS.                                 20530005
205400                                                                  20540005
205500     IF  ASTRTITL > ZERO                                          20550005
205600         MOVE ASTRTITI             TO ASC-START-ITEM-REQUEST      20560005
205700     ELSE                                                         20570005
205800         IF  ASTRTITF = DP015-ERASE-EOF                           20580005
205900             INITIALIZE ASC-START-ITEM-REQUEST                    20590005
206000         END-IF                                                   20600005
206100     END-IF.                                                      20610005
206200                                                                  20620005
206300     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          20630005
206400         VARYING PV-SUB                                           20640005
206500         FROM 1 BY 1                                              20650005
206600         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      20660005
206700                                                                  20670005
206800*----------------------------------------------------------------*20680005
206900*  MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA *20690005
207000*----------------------------------------------------------------*20700005
207100 2210-MOVE-LINES-TO-COMMAREA.                                     20710005
207200                                                                  20720005
207300     IF MR-SELECTL (PV-SUB) > ZERO                                20730005
207400         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             20740005
207500         MOVE MR-SELECT (PV-SUB) TO ASC-TEMP-SELECTED-SW          20750005
207600                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      20760005
207700     ELSE                                                         20770005
207800         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                20780005
207900             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE         20790005
208000             MOVE SPACE            TO ASC-TEMP-SELECTED-SW        20800005
208100                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      20810005
208200         END-IF                                                   20820005
208300     END-IF.                                                      20830005
208400                                                                  20840005
208500     IF MR-U-PROCESS-QTYL (PV-SUB) > ZERO                         20850005
208600*12/11   MOVE MR-U-PROCESS-QTY (PV-SUB)                           20860005
208700         MOVE MR-U-PROCESS-QTY-X (PV-SUB)                         20870005
208800                                 TO ASC-U-PROCESS-QTY-X           20880005
208900                                   (ASC-BLK-SUB ASC-ITEM-SUB)     20890005
209000     ELSE                                                         20900005
209100         IF MR-U-PROCESS-QTYA (PV-SUB) = DP015-ERASE-EOF          20910005
209200             MOVE SPACES         TO ASC-U-PROCESS-QTY-X           20920005
209300                                   (ASC-BLK-SUB ASC-ITEM-SUB)     20930005
209400***      ELSE                                                     20940005
209500***          MOVE SPACES         TO ASC-U-PROCESS-QTY-X           20950005
209600***                                (ASC-BLK-SUB ASC-ITEM-SUB)     20960005
209700         END-IF                                                   20970005
209800     END-IF.                                                      20980005
209900                                                                  20990005
210000     ADD +1                        TO ASC-ITEM-SUB.               21000005
210100                                                                  21010005
210200     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        21020005
210300         ADD +1                    TO ASC-BLK-SUB                 21030005
210400         MOVE +1                   TO ASC-ITEM-SUB                21040005
210500     END-IF.                                                      21050005
210600                                                                  21060005
210700 2300-GET-NEXT-RECORD.                                            21070005
210800     ADD +1                        TO ASC-SEL-SUB.                21080005
210900     IF ASC-SEL-SUB > RC013-MAX-ITEMS                             21090005
211000         ADD +1                    TO ASC-SEL-ITEM                21100005
211100         MOVE +1                   TO ASC-SEL-SUB                 21110005
211200     END-IF.                                                      21120005
211300                                                                  21130005
211400***  MOVE RC015-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME-IN       21140005
211500     IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 21150005
211600         PERFORM 9100-READ-SEL-QUEUE                              21160005
211700         IF RC013-ITEM (ASC-SEL-SUB) > ZERO                       21170005
211800             INITIALIZE ASC-LIST-KEYS                             21180005
211900             MOVE RC013-PO-NBR (ASC-SEL-SUB)                      21190005
212000                                      TO ASC-KEY-PO-NBR           21200005
212100             MOVE RC013-REC-SEQ-NBR (ASC-SEL-SUB)                 21210005
212200                                      TO ASC-KEY-RCVR-NBR         21220005
212300                                         ASC-RCVR-NBR             21230005
212400                                                                  21240005
212500             MOVE RC013-PKSL-LNE-NBR-N (ASC-SEL-SUB)              21250005
212600                                      TO ASC-KEY-LNE-NBR          21260005
212700                                          ASC-LINE-NBR            21270005
212800                                                                  21280005
212900* SH 10/8    MOVE RC013-OPER-UNT-ID (ASC-SEL-SUB)                 21290005
213000*                                     TO ASC-KEY-OPER-UNT-ID      21300005
213100*                                        ASC-OPER-UNT-ID          21310005
213200*            MOVE RC013-FCLTY-ID (ASC-SEL-SUB)                    21320005
213300*                                     TO ASC-KEY-FCLTY-ID         21330005
213400*                                        ASC-FCLTY-ID             21340005
213500                                                                  21350005
213600             SET RC013-INQ (ASC-SEL-SUB) TO TRUE                  21360005
213700             PERFORM 5120-REWRITE-LIST-QUEUE                      21370005
213800         ELSE                                                     21380005
213900             SUBTRACT +1 FROM ASC-SEL-SUB                         21390005
214000*            --- BOTTOM OF LIST ---                               21400005
214100             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            21410005
214200             SET DP020-MSG-INFORMATIONAL                          21420005
214300                                   TO TRUE                        21430005
214400         END-IF                                                   21440005
214500     ELSE                                                         21450005
214600         SUBTRACT +1 FROM ASC-SEL-ITEM                            21460005
214700         MOVE RC013-MAX-ITEMS      TO ASC-SEL-SUB                 21470005
214800         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            21480005
214900         SET DP020-MSG-INFORMATIONAL                              21490005
215000                                   TO TRUE                        21500005
215100     END-IF.                                                      21510005
215200                                                                  21520005
215300                                                                  21530005
215400 2310-GET-PREV-RECORD.                                            21540005
215500     SUBTRACT +1                 FROM ASC-SEL-SUB.                21550005
215600     IF ASC-SEL-SUB < +1                                          21560005
215700         SUBTRACT +1             FROM ASC-SEL-ITEM                21570005
215800         MOVE RC013-MAX-ITEMS      TO ASC-SEL-SUB                 21580005
215900     END-IF.                                                      21590005
216000                                                                  21600005
216100***  MOVE RC015-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME-IN       21610005
216200     IF ASC-SEL-ITEM > ZERO                                       21620005
216300         PERFORM 9100-READ-SEL-QUEUE                              21630005
216400         MOVE RC013-PO-NBR (ASC-SEL-SUB)                          21640005
216500                                      TO ASC-KEY-PO-NBR           21650005
216600         MOVE RC013-REC-SEQ-NBR (ASC-SEL-SUB)                     21660005
216700                                      TO ASC-KEY-RCVR-NBR         21670005
216800                                         ASC-RCVR-NBR             21680005
216900                                                                  21690005
217000         MOVE RC013-PKSL-LNE-NBR-N (ASC-SEL-SUB)                  21700005
217100                                  TO ASC-KEY-LNE-NBR              21710005
217200                                      ASC-LINE-NBR                21720005
217300* SH 10/8    MOVE RC013-OPER-UNT-ID (ASC-SEL-SUB)                 21730005
217400*                                     TO ASC-KEY-OPER-UNT-ID      21740005
217500*                                        ASC-OPER-UNT-ID          21750005
217600*            MOVE RC013-FCLTY-ID (ASC-SEL-SUB)                    21760005
217700*                                     TO ASC-KEY-FCLTY-ID         21770005
217800*                                        ASC-FCLTY-ID             21780005
217900                                                                  21790005
218000                                                                  21800005
218100             SET RC013-INQ (ASC-SEL-SUB) TO TRUE                  21810005
218200             PERFORM 5120-REWRITE-LIST-QUEUE                      21820005
218300         ELSE                                                     21830005
218400             MOVE +1 TO  ASC-SEL-SUB                              21840005
218500                         ASC-SEL-ITEM                             21850005
218600*            --- TOP OF LIST ---                                  21860005
218700             MOVE PC-TSYMSG-00069  TO DP020-MSG-NUMBER            21870005
218800             SET DP020-MSG-INFORMATIONAL                          21880005
218900                                   TO TRUE                        21890005
219000         END-IF.                                                  21900005
219100                                                                  21910005
219200                                                                  21920005
219300                                                                  21930005
219400                                                                  21940005
219500                                                                  21950005
219600*----------------------------------------------------------------*21960005
219700*  EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE       *21970005
219800*  COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY).  *21980005
219900*----------------------------------------------------------------*21990005
220000 3000-EDIT-DATA-IN-COMMAREA.                                      22000005
220100                                                                  22010005
220200     SET PS-NO-ERROR               TO TRUE.                       22020005
220300                                                                  22030005
220400     PERFORM 3200-RESET-ATTRIBUTES.                               22040005
220500                                                                  22050005
220600     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     22060005
220700**                                                                22070005
220800* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              22080005
220900* EDITING IS DONE FROM THE BOTTOM UP.                             22090005
221000**                                                                22100005
221100     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       22110005
221200         ASC-ITEMS-DISPLAYED - 1.                                 22120005
221300                                                                  22130005
221400     PERFORM 3100-SET-SUBSCRIPTS.                                 22140005
221500     PERFORM 3300-EDIT-SELECTIONS                                 22150005
221600         VARYING PV-SUB                                           22160005
221700         FROM PV-SUB BY -1                                        22170005
221800         UNTIL PV-SUB < +1                                        22180005
221900                                                                  22190005
222000     IF  PS-NO-ERROR                                              22200005
222100         PERFORM 3400-CHECK-RANGE-SEQUENCE                        22210005
222200     END-IF.                                                      22220005
222300                                                                  22230005
222400     IF  ((PS-NO-ERROR)                                           22240005
222500       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   22250005
222600       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    22260005
222700             PERFORM 3500-MARK-RANGE-AS-SELECTED                  22270005
222800     END-IF.                                                      22280005
222900                                                                  22290005
223000*----------------------------------------------------------------*22300005
223100*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *22310005
223200*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*22320005
223300*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *22330005
223400*                                                                *22340005
223500*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *22350005
223600*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *22360005
223700*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *22370005
223800*    US IN THE 2ND BLOCK OF THE ARRAY.                           *22380005
223900*----------------------------------------------------------------*22390005
224000                                                                  22400005
224100 3100-SET-SUBSCRIPTS.                                             22410005
224200                                                                  22420005
224300     COMPUTE ASC-ITEM-SUB =                                       22430005
224400         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        22440005
224500                                                                  22450005
224600     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         22460005
224700         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            22470005
224800                                                                  22480005
224900         MOVE PC-MAX-BLOCKS-IN-ARRAY                              22490005
225000                                   TO ASC-BLK-SUB                 22500005
225100     ELSE                                                         22510005
225200         MOVE +1                   TO ASC-BLK-SUB                 22520005
225300     END-IF.                                                      22530005
225400                                                                  22540005
225500*----------------------------------------------------------------*22550005
225600*  RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.      *22560005
225700*----------------------------------------------------------------*22570005
225800                                                                  22580005
225900 3200-RESET-ATTRIBUTES.                                           22590005
226000                                                                  22600005
226100     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA                    22610005
226200     MOVE DP015-GREEN              TO ASTRTITC                    22620005
226300     MOVE DP015-UNDERLINE          TO ASTRTITH.                   22630005
226400                                                                  22640005
226500     PERFORM VARYING PV-SUB  FROM 1 BY 1                          22650005
226600         UNTIL   PV-SUB > PC-ITEMS-PER-PANEL                      22660005
226700         IF ASC-PROTECT-ALL-STORES                                22670005
226800             MOVE DP015-ASK-DRK-OFF TO MR-SELECTA (PV-SUB)        22680005
226900                                       MR-ACTIONA (PV-SUB)        22690005
227000                                       MR-U-PROCESS-QTYA (PV-SUB) 22700005
227100             MOVE DP015-HL-OFF      TO MR-SELECTH (PV-SUB)        22710005
227200                                       MR-U-PROCESS-QTYH (PV-SUB) 22720005
227300             MOVE -1                TO ASTRTITL                   22730005
227400         ELSE                                                     22740005
227500             MOVE DP015-UNP-ALP-NOR-OFF                           22750005
227600                                 TO MR-SELECTA (PV-SUB)           22760005
227700                                    MR-U-PROCESS-QTYA  (PV-SUB)   22770005
227800             MOVE DP015-GREEN                                     22780005
227900                                 TO MR-SELECTC (PV-SUB)           22790005
228000                                    MR-U-PROCESS-QTYC  (PV-SUB)   22800005
228100             MOVE DP015-UNDERLINE                                 22810005
228200                                 TO MR-SELECTH (PV-SUB)           22820005
228300                                    MR-U-PROCESS-QTYH  (PV-SUB)   22830005
228400         END-IF                                                   22840005
228500     END-PERFORM.                                                 22850005
228600                                                                  22860005
228700                                                                  22870005
228800*----------------------------------------------------------------*22880005
228900*  EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS     *22890005
229000*  WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'    *22900005
229100*  IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR     *22910005
229200*  WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.              *22920005
229300*----------------------------------------------------------------*22930005
229400 3300-EDIT-SELECTIONS.                                            22940005
229500                                                                  22950005
229600     MOVE SPACES                   TO ASC-ACTION                  22960005
229700                                     (ASC-BLK-SUB ASC-ITEM-SUB)   22970005
229800                                      MR-ACTION (PV-SUB)          22980005
229900                                                                  22990005
230000     EVALUATE TRUE                                                23000005
230100         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     23010005
230200            = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)          23020005
230300             CONTINUE                                             23030005
230400                                                                  23040005
230500         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         23050005
230600             IF NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)         23060005
230700                 ADD +1   TO ASC-NUMBER-OF-SELECTED-ITEMS         23070005
230800                 MOVE ASC-TEMP-SELECTED-SW                        23080005
230900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 23090005
231000                   TO ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)  23100005
231100             END-IF                                               23110005
231200                                                                  23120005
231300         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     23130005
231400                                   = SPACE                        23140005
231500             EVALUATE TRUE                                        23150005
231600                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       23160005
231700                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS23170005
231800                     MOVE SPACE    TO ASC-SELECTED-SW             23180005
231900                                     (ASC-BLK-SUB ASC-ITEM-SUB)   23190005
232000                                                                  23200005
232100                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        23210005
232200                     MOVE ZERO     TO ASC-START-OF-SELECTED-RANGE 23220005
232300                     MOVE SPACE    TO ASC-SELECTED-SW             23230005
232400                                     (ASC-BLK-SUB ASC-ITEM-SUB)   23240005
232500                                                                  23250005
232600                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          23260005
232700                     MOVE ZERO     TO ASC-END-OF-SELECTED-RANGE   23270005
232800                     MOVE SPACE    TO ASC-SELECTED-SW             23280005
232900                                     (ASC-BLK-SUB ASC-ITEM-SUB)   23290005
233000             END-EVALUATE                                         23300005
233100                                                                  23310005
233200         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           23320005
233300             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            23330005
233400                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    23340005
233500             END-IF                                               23350005
233600             PERFORM 3310-EDIT-RANGE                              23360005
233700                                                                  23370005
233800         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             23380005
233900             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            23390005
234000                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    23400005
234100             END-IF                                               23410005
234200             PERFORM 3310-EDIT-RANGE                              23420005
234300                                                                  23430005
234400         WHEN OTHER                                               23440005
234500             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            23450005
234600             SET DP020-MSG-FATAL   TO TRUE                        23460005
234700             MOVE -1               TO MR-SELECTL (PV-SUB)         23470005
234800             SET DP030-SET-CURSOR-APPL-1                          23480005
234900                                   TO TRUE                        23490005
235000             MOVE DP015-RED        TO MR-SELECTC (PV-SUB)         23500005
235100             MOVE DP015-REVERSE    TO MR-SELECTH (PV-SUB)         23510005
235200             SET PS-ERROR          TO TRUE                        23520005
235300             MOVE PC-ERR           TO ASC-ACTION                  23530005
235400                                     (ASC-BLK-SUB ASC-ITEM-SUB)   23540005
235500                                      MR-ACTION (PV-SUB)          23550005
235600             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            23560005
235700                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     23570005
235800                 MOVE SPACE         TO ASC-SELECTED-SW            23580005
235900                                        (ASC-BLK-SUB ASC-ITEM-SUB)23590005
236000             END-IF                                               23600005
236100     END-EVALUATE.                                                23610005
236200                                                                  23620005
236300***  IF ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)                23630005
236400     IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)                     23640005
236500         IF ASC-U-PROCESS-QTY-X (ASC-BLK-SUB ASC-ITEM-SUB)        23650005
236600                                = SPACES                          23660005
236700           AND DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)             23670005
236800             SET PS-ERROR                                         23680005
236900                 DP020-MSG-FATAL                                  23690005
237000                 DP030-SET-CURSOR-APPL-1 TO TRUE                  23700005
237100                 MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER         23710005
237200                 MOVE DP015-UNP-NUM-BRT-OFF                       23720005
237300                                    TO MR-U-PROCESS-QTYA (PV-SUB) 23730005
237400                 MOVE -1            TO MR-U-PROCESS-QTYL (PV-SUB) 23740005
237500                 MOVE DP015-RED     TO MR-U-PROCESS-QTYC (PV-SUB) 23750005
237600                 MOVE DP015-REVERSE TO MR-U-PROCESS-QTYH (PV-SUB) 23760005
237700                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     23770005
237800         ELSE                                                     23780005
237900         IF ASC-U-PROCESS-QTY-X       (ASC-BLK-SUB ASC-ITEM-SUB)  23790005
238000                > SPACES                                          23800005
238100             MOVE ASC-U-PROCESS-QTY-X (ASC-BLK-SUB ASC-ITEM-SUB)  23810005
238200               TO DP010I-UNEDITED-FIELD                           23820005
238300             MOVE LENGTH OF ASC-U-PROCESS-QTY-X                   23830005
238400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  23840005
238500               TO DP010I-MAXIMUM-DIGITS                           23850005
238600             MOVE ZEROES  TO DP010I-MAXIMUM-DECIMALS              23860005
238700             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              23870005
238810             CALL DP010I-NUMERIC-EDIT-ROUTINE                     23881058
238820                  USING DP010I-NUMERIC-EDIT-AREA                  23882058
238900             IF DP010I-ERROR-DETECTED                             23890005
239000                 SET PS-ERROR                                     23900005
239100                     DP020-MSG-FATAL                              23910005
239200                     DP030-SET-CURSOR-APPL-1 TO TRUE              23920005
239300                 MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER         23930005
239400                 MOVE DP015-UNP-NUM-BRT-OFF                       23940005
239500                                 TO MR-U-PROCESS-QTYA (PV-SUB)    23950005
239600                 MOVE -1         TO MR-U-PROCESS-QTYL (PV-SUB)    23960005
239700                 MOVE DP015-RED  TO MR-U-PROCESS-QTYC (PV-SUB)    23970005
239800                 MOVE DP015-REVERSE                               23980005
239900                                 TO MR-U-PROCESS-QTYH (PV-SUB)    23990005
240000                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              24000005
240100                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     24010005
240200             ELSE                                                 24020005
240300                 MOVE DP010I-NUMERIC-FIELD                        24030005
240400                   TO ASC-U-PROCESS-QTY(ASC-BLK-SUB ASC-ITEM-SUB) 24040005
240500                 MOVE ASC-U-PROCESS-QTY(ASC-BLK-SUB ASC-ITEM-SUB) 24050005
240600                   TO MR-U-PROCESS-QTY (PV-SUB)                   24060005
240700                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE      24070005
240800*                PERFORM 3301-CHECK-PACK-MULTIPLES                24080005
240900             END-IF                                               24090005
241000         END-IF                                                   24100005
241100         END-IF                                                   24110005
241200     IF ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)             24120005
241300         MOVE SPACE TO MR-U-PROCESS-QTY-X (PV-SUB)                24130005
241400     END-IF                                                       24140005
241500     END-IF.                                                      24150005
241600                                                                  24160005
241700     SUBTRACT +1 FROM PV-ITEM-IN-USE.                             24170005
241800     SUBTRACT +1 FROM ASC-ITEM-SUB.                               24180005
241900                                                                  24190005
242000     IF  ASC-ITEM-SUB < 1                                         24200005
242100         SUBTRACT +1 FROM ASC-BLK-SUB                             24210005
242200         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                24220005
242300     END-IF.                                                      24230005
242400                                                                  24240005
242500 3301-CHECK-PACK-MULTIPLES.                                       24250005
242600*  THE UPDATE QTY ENTERED MUST BY A MULTIPLE OF THE OUTER PACK    24260005
242700*  QTY.  IF IT'S NOT AN EVEN MULTIPLE, THEN THE REMAINDER         24270005
242800*  MUST BE AN EVEN MULTIPLE OF THE INNER PACK QTY.                24280005
242900*  IF THE LINE IS NOT CONVEYABLE, THEN ONLY FULLCASES WILL BE     24290005
243000*  ALLOWED.  THAT IS, THE OUTER PACK MUST BE AN EVEN MULTIPLE.    24300005
243100                                                                  24310005
243200     MOVE ZERO                        TO PV-REMAINDER-OUT-PACK    24320005
243300                                         PV-REMAINDER-INPAK       24330005
243400                                         PV-NEW-INPAK             24340005
243500                                         PV-NEW-OUT-PACK          24350005
243600                                                                  24360005
243700     MOVE ASC-U-PROCESS-QTY (ASC-BLK-SUB ASC-ITEM-SUB)            24370005
243800                                      TO PV-UPDATE-QTY            24380005
243900     IF PV-UPDATE-QTY > ZERO                                      24390005
244000         DIVIDE ASC-OUT-PACK-QTY BY PV-UPDATE-QTY                 24400005
244100             GIVING PV-NEW-OUT-PACK                               24410005
244200             REMAINDER PV-REMAINDER-OUT-PACK                      24420009
244300     END-IF                                                       24430005
244400                                                                  24440005
244500     IF ASC-CNVYB = 'Y'                                           24450005
244600         IF PV-REMAINDER-OUT-PACK > ZERO                          24460005
244700             DIVIDE PV-REMAINDER-OUT-PACK BY ASC-INPAK-QTY        24470005
244800                 GIVING PV-NEW-INPAK                              24480005
244900                 REMAINDER PV-REMAINDER-INPAK                     24490005
245000             IF PV-REMAINDER-INPAK > ZERO                         24500005
245100                 SET PS-ERROR                                     24510005
245200                     DP020-MSG-FATAL                              24520005
245300                     DP030-SET-CURSOR-APPL-1                      24530005
245400                                 TO TRUE                          24540005
245500                 MOVE PC-TSYMSG-01784                             24550005
245600                                 TO DP020-MSG-NUMBER              24560005
245700                 MOVE DP015-UNP-NUM-BRT-OFF                       24570005
245800                                 TO MR-U-PROCESS-QTYA (PV-SUB)    24580005
245900                 MOVE -1         TO MR-U-PROCESS-QTYL (PV-SUB)    24590005
246000                 MOVE DP015-RED  TO MR-U-PROCESS-QTYC (PV-SUB)    24600005
246100                 MOVE DP015-REVERSE                               24610005
246200                                 TO MR-U-PROCESS-QTYH (PV-SUB)    24620005
246300                 SET DP030-SET-CURSOR-APPL-1                      24630005
246400                                 TO TRUE                          24640005
246500                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     24650005
246600             END-IF                                               24660005
246700         END-IF                                                   24670005
246800     ELSE                                                         24680005
246900         IF PV-REMAINDER-OUT-PACK > ZERO                          24690005
247000             SET PS-ERROR                                         24700005
247100                 DP020-MSG-FATAL                                  24710005
247200                 DP030-SET-CURSOR-APPL-1                          24720005
247300                                 TO TRUE                          24730005
247400             MOVE PC-TSYMSG-01783                                 24740005
247500                                 TO DP020-MSG-NUMBER              24750005
247600             MOVE DP015-UNP-NUM-BRT-OFF                           24760005
247700                                 TO MR-U-PROCESS-QTYA (PV-SUB)    24770005
247800             MOVE -1             TO MR-U-PROCESS-QTYL (PV-SUB)    24780005
247900             MOVE DP015-RED      TO MR-U-PROCESS-QTYC (PV-SUB)    24790005
248000             MOVE DP015-REVERSE                                   24800005
248100                                 TO MR-U-PROCESS-QTYH (PV-SUB)    24810005
248200             SET DP030-SET-CURSOR-APPL-1                          24820005
248300                                 TO TRUE                          24830005
248400             SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS         24840005
248500     END-IF.                                                      24850005
248600                                                                  24860005
248700*----------------------------------------------------------------*24870005
248800*  IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A       *24880005
248900*  RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1     *24890005
249000*  ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) *24900005
249100*  THE ENDING.                                                   *24910005
249200*----------------------------------------------------------------*24920005
249300 3310-EDIT-RANGE.                                                 24930005
249400                                                                  24940005
249500     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                24950005
249600         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   24960005
249700             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)24970005
249800                                   TO ASC-SELECTED-SW             24980005
249900                                        (ASC-BLK-SUB ASC-ITEM-SUB)24990005
250000             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 25000005
250100         ELSE                                                     25010005
250200             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     25020005
250300                 CONTINUE                                         25030005
250400             ELSE                                                 25040005
250500*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        25050005
250600                 MOVE PC-TSYMSG-00054                             25060005
250700                                   TO DP020-MSG-NUMBER            25070005
250800                 SET DP020-MSG-FATAL                              25080005
250900                                   TO TRUE                        25090005
251000                 MOVE -1           TO MR-SELECTL (PV-SUB)         25100005
251100                 SET DP030-SET-CURSOR-APPL-1                      25110005
251200                                   TO TRUE                        25120005
251300                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         25130005
251400                 MOVE DP015-UNDERLINE                             25140005
251500                                   TO MR-SELECTH (PV-SUB)         25150005
251600                                      MR-U-PROCESS-QTYH  (PV-SUB) 25160005
251700                 SET PS-ERROR      TO TRUE                        25170005
251800             END-IF                                               25180005
251900         END-IF                                                   25190005
252000     ELSE                                                         25200005
252100         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     25210005
252200             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 25220005
252300                                   TO ASC-SELECTED-SW             25230005
252400                                     (ASC-BLK-SUB ASC-ITEM-SUB)   25240005
252500             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   25250005
252600         ELSE                                                     25260005
252700             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       25270005
252800                 CONTINUE                                         25280005
252900             ELSE                                                 25290005
253000*                -- ONLY ONE END-OF-RANGE ALLOWED --              25300005
253100                 MOVE PC-TSYMSG-00055                             25310005
253200                                   TO DP020-MSG-NUMBER            25320005
253300                 SET DP020-MSG-FATAL                              25330005
253400                                   TO TRUE                        25340005
253500                 MOVE -1           TO MR-SELECTL (PV-SUB)         25350005
253600                 SET DP030-SET-CURSOR-APPL-1                      25360005
253700                                   TO TRUE                        25370005
253800                 SET PS-ERROR      TO TRUE                        25380005
253900             END-IF                                               25390005
254000         END-IF                                                   25400005
254100     END-IF.                                                      25410005
254200                                                                  25420005
254300*----------------------------------------------------------------*25430005
254400*  IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,     *25440005
254500*  MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.   *25450005
254600*----------------------------------------------------------------*25460005
254700 3400-CHECK-RANGE-SEQUENCE.                                       25470005
254800                                                                  25480005
254900     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       25490005
255000       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      25500005
255100       AND  ASC-START-OF-SELECTED-RANGE >                         25510005
255200                                         ASC-END-OF-SELECTED-RANGE25520005
255300*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                25530005
255400         MOVE PC-TSYMSG-00052      TO DP020-MSG-NUMBER            25540005
255500         SET DP020-MSG-FATAL       TO TRUE                        25550005
255600         SET PS-ERROR              TO TRUE                        25560005
255700         PERFORM 3410-POSITION-AT-ERROR                           25570005
255800     END-IF.                                                      25580005
255900                                                                  25590005
256000*----------------------------------------------------------------*25600005
256100*  BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE     *25610005
256200*  PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR  *25620005
256300*  SHOULD BE POSITIONED ON A RANGE ERROR.                        *25630005
256400*----------------------------------------------------------------*25640005
256500 3410-POSITION-AT-ERROR.                                          25650005
256600                                                                  25660005
256700     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       25670005
256800                                                                  25680005
256900     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 25690005
257000                    - PV-TOP-ITEM + 1.                            25700005
257100                                                                  25710005
257200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      25720005
257300         CONTINUE                                                 25730005
257400     ELSE                                                         25740005
257500         MOVE -1                   TO MR-SELECTL (PV-SUB)         25750005
257600         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         25760005
257700         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         25770005
257800     END-IF.                                                      25780005
257900                                                                  25790005
258000     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   25800005
258100                    - PV-TOP-ITEM + 1.                            25810005
258200                                                                  25820005
258300     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      25830005
258400         CONTINUE                                                 25840005
258500     ELSE                                                         25850005
258600         MOVE -1                   TO MR-SELECTL (PV-SUB)         25860005
258700         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         25870005
258800         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         25880005
258900     END-IF.                                                      25890005
259000                                                                  25900005
259100*----------------------------------------------------------------*25910005
259200*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *25920005
259300*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *25930005
259400*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *25940005
259500*----------------------------------------------------------------*25950005
259600                                                                  25960005
259700 3500-MARK-RANGE-AS-SELECTED.                                     25970005
259800                                                                  25980005
259900     MOVE +1                       TO ASC-BLK-SUB.                25990005
260000                                                                  26000005
260100     PERFORM 3510-MARK-SELECTED-INDS                              26010005
260200         VARYING ASC-ITEM-SUB                                     26020005
260300         FROM 1 BY 1                                              26030005
260400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 26040005
260500                                                                  26050005
260600     ADD +1                        TO ASC-BLK-SUB.                26060005
260700                                                                  26070005
260800     PERFORM 3510-MARK-SELECTED-INDS                              26080005
260900         VARYING ASC-ITEM-SUB                                     26090005
261000         FROM 1 BY 1                                              26100005
261100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 26110005
261200                                                                  26120005
261300     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               26130005
261400                                   TO PV-LIST-ITEM-NUMBER.        26140005
261500                                                                  26150005
261600     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            26160005
261700         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         26170005
261800               PC-ITEMS-PER-PANEL).                               26180005
261900                                                                  26190005
262000     MOVE ASC-START-OF-SELECTED-RANGE                             26200005
262100                                   TO PV-START-OF-SELECTED-RANGE. 26210005
262200                                                                  26220005
262300     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            26230005
262400         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  26240005
262500               PC-ITEMS-PER-PANEL).                               26250005
262600                                                                  26260005
262700     MOVE ASC-END-OF-SELECTED-RANGE                               26270005
262800                                   TO PV-END-OF-SELECTED-RANGE.   26280005
262900                                                                  26290005
263000     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             26300005
263100         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    26310005
263200               PC-ITEMS-PER-PANEL).                               26320005
263300                                                                  26330005
263400     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             26340005
263500         PV-FIRST-BLOCK-IN-ARRAY + 1.                             26350005
263600                                                                  26360005
263700     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    26370005
263800        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        26380005
263900         MOVE +1                   TO ASC-BLK-SUB                 26390005
264000         PERFORM 5100-WRITE-TEMP-STORAGE                          26400005
264100         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         26410005
264200             PV-FIRST-BLOCK-IN-ARRAY - 1                          26420005
264300                                                                  26430005
264400         PERFORM                                                  26440005
264500             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      26450005
264600                   PV-PREV-BLOCK-IN-ARRAY                         26460005
264700             MOVE PV-FIRST-BLOCK-IN-RANGE                         26470005
264800                                   TO PV-BLOCK-NUMBER             26480005
264900             PERFORM 4410-READ-TEMP-STORAGE                       26490005
265000             PERFORM 3510-MARK-SELECTED-INDS                      26500005
265100                 VARYING ASC-ITEM-SUB                             26510005
265200                 FROM 1 BY 1                                      26520005
265300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          26530005
265400             PERFORM 5100-WRITE-TEMP-STORAGE                      26540005
265500             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     26550005
265600         END-PERFORM                                              26560005
265700                                                                  26570005
265800         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         26580005
265900             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     26590005
266000         PERFORM                                                  26600005
266100             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       26610005
266200                   PV-LAST-BLOCK-IN-RANGE                         26620005
266300             MOVE PV-NEXT-BLOCK-IN-ARRAY                          26630005
266400                                   TO PV-BLOCK-NUMBER             26640005
266500             PERFORM 4410-READ-TEMP-STORAGE                       26650005
266600             PERFORM 3510-MARK-SELECTED-INDS                      26660005
266700                 VARYING ASC-ITEM-SUB                             26670005
266800                 FROM 1 BY 1                                      26680005
266900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          26690005
267000             PERFORM 5100-WRITE-TEMP-STORAGE                      26700005
267100             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      26710005
267200         END-PERFORM                                              26720005
267300                                                                  26730005
267400         MOVE PV-FIRST-BLOCK-IN-ARRAY                             26740005
267500                                   TO PV-BLOCK-NUMBER             26750005
267600         PERFORM 4410-READ-TEMP-STORAGE                           26760005
267700     END-IF.                                                      26770005
267800                                                                  26780005
267900     MOVE ZERO                     TO ASC-START-OF-SELECTED-RANGE 26790005
268000                                      ASC-END-OF-SELECTED-RANGE.  26800005
268100                                                                  26810005
268200*----------------------------------------------------------------*26820005
268300* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *26830005
268400*----------------------------------------------------------------*26840005
268500                                                                  26850005
268600 3510-MARK-SELECTED-INDS.                                         26860005
268700                                                                  26870005
268800     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) >         26880005
268900         ASC-START-OF-SELECTED-RANGE)                             26890005
269000     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) =         26900005
269100         ASC-START-OF-SELECTED-RANGE)                             26910005
269200                                                                  26920005
269300         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) <     26930005
269400             ASC-END-OF-SELECTED-RANGE)                           26940005
269500         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) =     26950005
269600             ASC-END-OF-SELECTED-RANGE)                           26960005
269700                                                                  26970005
269800             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          26980005
269900                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   26990005
270000                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   27000005
270100                                   TO TRUE                        27010005
270200                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              27020005
270300                                   TO TRUE                        27030005
270400                 ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS27040005
270500             END-IF                                               27050005
270600         END-IF                                                   27060005
270700     END-IF.                                                      27070005
270800                                                                  27080005
270900*----------------------------------------------------------------*27090005
271000*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *27100005
271100*    INITIALIZE ALL COUNTERS AND FLAGS.                          *27110005
271200*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *27120005
271300*    DISPLAY THE PANEL TO USER.                                  *27130005
271400*----------------------------------------------------------------*27140005
271500*----------------------------------------------------------------*27150005
271600*                                               **   WR # 21361  *27160005
271700* ADDED CODE TO CHECK DUMMY SKU                                  *27170005
271800* ADDED CODE TO INCLUDE XLKUT001 LOGIC.                          *27180005
271900*----------------------------------------------------------------*27190005
272000 4000-BUILD-INITIAL-PANEL.                                        27200005
272100                                                                  27210005
272200     INITIALIZE ASC-BLOCK-ENTRIES (1)                             27220005
272300                ASC-BLOCK-ENTRIES (2).                            27230005
272400                                                                  27240005
272500     MOVE +1                       TO ASC-BLK-SUB.                27250005
272600     MOVE SPACE                    TO ASC-PROTECT-SW.             27260005
272700                                                                  27270005
272800     SET ASC-ITEMS-LEFT-ON-DB      TO TRUE.                       27280005
272900                                                                  27290005
273000     MOVE ZERO                     TO ASC-ITEM-SUB                27300005
273100                                      ASC-NUMBER-OF-ITEMS-READ    27310005
273200                                      ASC-NUMBER-OF-SELECTED-ITEMS27320005
273300                                      ASC-HIGHEST-BLOCK-WRITTEN   27330005
273400                                      ASC-START-OF-SELECTED-RANGE 27340005
273500                                      ASC-END-OF-SELECTED-RANGE   27350005
273600                                      ASC-ITEM-AT-TOP-OF-PANEL.   27360005
273700                                                                  27370005
273800     PERFORM 8400-CHECK-AUTOVE.                                   27380005
273900                                                                  27390005
274000     PERFORM 4100-PREPARE-CURSOR.                                 27400005
274100                                                                  27410005
274200     MOVE ASC-RCVR-OPER-UNT-ID     TO MR-OPER.                    27420005
274300     MOVE ASC-FCLTY-ID             TO MR-FCLTY.                   27430005
274400     MOVE ASC-ORD-NBR              TO MR-PO.                      27440005
274500     MOVE ASC-RCVR-NBR             TO MR-RCVR.                    27450005
274600     MOVE ASC-PKGNG-CDE-DISPLAY    TO MR-PKCD.                    27460005
274700     MOVE ASC-LINE-NBR             TO MR-PO-LINE.                 27470005
274800                                                                  27480005
274900     PERFORM 7200-GET-RCVR-STATUS.                                27490005
275000*TO HANDLE ALREADY EXISTING ORDERS (PROCESSED BY LINE), CHECK     27500005
275100*DISTHD-PREPK-LNE-PRC-CDE FOR PACKS & PROCESS OLD WAY IF BLANK.   27510005
275200     IF ASC-PKGNG-CDE = 'I' OR 'M'                                27520005
275300         MOVE +0 TO PV-PREPK-BLANK-COUNT                          27530005
275400         PERFORM 4030-CHECK-DISTHD                                27540005
275500         IF PV-PREPK-BLANK-COUNT > +0                             27550005
275600             MOVE 'X' TO ASC-PKGNG-CDE                            27560005
275700         END-IF                                                   27570005
275800     END-IF.                                                      27580005
275900                                                                  27590005
276000     MOVE +0 TO RECITM-PREPK-ID.                                  27600005
276100     IF ASC-PKGNG-CDE = 'I' OR 'M'                                27610005
276200         PERFORM 7590-GET-PREPK-ID                                27620005
276300     END-IF.                                                      27630005
276400     MOVE RECITM-PREPK-ID TO ASC-PACK-ID                          27640005
276500                             ASC-KEY-PACK-ID                      27650005
276600                             DK-PACK-ID.                          27660005
276700     MOVE ZEROES TO ASC-PREPK-RATO-QTY.                           27670005
276800     IF RECITM-PREPK-ID > ZEROES AND                              27680005
276900        ASC-PKGNG-CDE = 'I' OR 'M'                                27690005
277000         PERFORM 7591-GET-PREPK-DRV-LNE                           27700005
277100         IF (ASC-DISPLAY-FORMAT NOT = '3')                        27710005
277200             MOVE RECITM-ORD-LNE-NBR    TO DK-LINE-NBR            27720005
277300                                           DK-DRIVER-LINE-NBR     27730005
277400         ELSE                                                     27740005
277500             MOVE RECITM-ORD-LNE-NBR    TO DK-DRIVER-LINE-NBR     27750005
277600         END-IF                                                   27760005
277700         MOVE RECITM-PREPK-RATO-QTY TO ASC-PREPK-RATO-QTY         27770005
277800     ELSE                                                         27780005
277900         MOVE DK-LINE-NBR           TO DK-DRIVER-LINE-NBR         27790005
278000     END-IF.                                                      27800005
278100                                                                  27810005
278200     PERFORM 7000-GET-DEPT.                                       27820005
278300     MOVE PURCHS-DEPT-NBR TO ASC-DEPT.                            27830005
278400                                                                  27840005
278500     PERFORM 7250-GET-SKU.                                        27850005
278600     IF (ASC-DISPLAY-FORMAT = '3')                                27860005
278700       OR (ASC-PKGNG-CDE NOT = 'I' AND 'M')                       27870005
278800                                                                  27880005
278900         IF PURITM-ITM-NBR < 0                                    27890005
279000            MOVE '4000-BUILD-INITIAL-PANEL'                       27900005
279100                             TO DP013-PARAGRAPH                   27910005
279200            MOVE 'PURITM-ITM-NBR < 0     '                        27920005
279300                             TO DP013-MESSAGE-TEXT (1)            27930005
279400            MOVE SQLCA       TO DP013-SQLCA                       27940005
279500            MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)          27950005
279600            SET DP013-DB2-ABEND                                   27960005
279700                DP013-NO-ROLLBACK                                 27970005
279800                             TO TRUE                              27980005
279900            PERFORM DP013-0000-PROCESS-ABEND                      27990005
280000         END-IF                                                   28000005
280100                                                                  28010005
280200         IF PURITM-ITM-NBR = 0                                    28020005
280300            IF PURITM-SKU-SEQ-NBR = PC-000                        28030005
280400               MOVE '00000000' TO PV-CS-SKU                       28040005
280500            ELSE                                                  28050005
280600               IF PURITM-SKU-SEQ-NBR = PC-999                     28060005
280700                  MOVE '99999999' TO PV-CS-SKU                    28070005
280800               ELSE                                               28080005
280900                  MOVE '4000-BUILD-INITIAL-PANEL'                 28090005
281000                               TO DP013-PARAGRAPH                 28100005
281100                  MOVE 'PURITM-ITM-NBR = 0     '                  28110005
281200                               TO DP013-MESSAGE-TEXT (1)          28120005
281300                  MOVE SQLCA      TO DP013-SQLCA                  28130005
281400                  MOVE 'TPURITM ' TO DP013-DB2-TABLE-NAME (1)     28140005
281500                  SET DP013-DB2-ABEND                             28150005
281600                      DP013-NO-ROLLBACK                           28160005
281700                               TO TRUE                            28170005
281800                  PERFORM DP013-0000-PROCESS-ABEND                28180005
281900               END-IF                                             28190005
282000            END-IF                                                28200005
282100         END-IF                                                   28210005
282200                                                                  28220005
282300         IF PURITM-ITM-NBR > 0 AND                                28230005
282400            PS-CALL-API-YES    AND                                28240005
282500            ((PURITM-SKU-SEQ-NBR NOT = PC-000) AND                28250005
282600            (PURITM-SKU-SEQ-NBR NOT = PC-999))                    28260005
282700                                                                  28270005
282800            INITIALIZE XL001-ITEM-COMMAREA                        28280005
282900            MOVE PURITM-ITM-NBR   TO XL001-KEY-ITM-NBR            28290005
283000                                                                  28300005
283100            SET  XL001-BY-ITEM                                    28310005
283200                 XL001-SELECT-SKU TO TRUE                         28320005
283300                                                                  28330005
283400            CALL XL001-VSM-PGM USING  DFHEIBLK                    28340005
283500                                      XL001-COMMAREA              28350005
283600                                      XL001-ITEM-COMMAREA         28360005
283700                                                                  28370005
283800            EVALUATE TRUE                                         28380005
283900                                                                  28390005
284000                WHEN XL001-SKU-SQLCODE = +0                       28400005
284100                      MOVE XL001-SKU-NBR                          28410005
284200                                       TO  PV-CS-SKU              28420005
284300                                                                  28430005
284400                WHEN XL001-SKU-SQLCODE = +100                     28440005
284500                      MOVE SPACES      TO  PV-CS-SKU              28450005
284600                                                                  28460005
284700                WHEN XL001-SKU-CONTENTION                         28470005
284800                      MOVE '4000-BUILD-INITIAL-PANEL'             28480005
284900                                       TO DP013-PARAGRAPH         28490005
285000                      MOVE 'SKU CONTENTION'                       28500005
285100                                       TO DP013-MESSAGE-TEXT (1)  28510005
285200                      MOVE 'XLV_SKU '  TO DP013-DB2-TABLE-NAME (1)28520005
285300                      MOVE XL001-SQLCA TO DP013-SQLCA             28530005
285400                      SET DP013-DB2-ABEND                         28540005
285500                                       TO TRUE                    28550005
285600                      PERFORM DP013-0000-PROCESS-ABEND            28560005
285700                                                                  28570005
285800                WHEN OTHER                                        28580005
285900                      MOVE '4000-BUILD-INITIAL-PANEL'             28590005
286000                                       TO DP013-PARAGRAPH         28600005
286100                      MOVE 'INVALID RETURN'                       28610005
286200                                       TO DP013-MESSAGE-TEXT (1)  28620005
286300                      MOVE 'XLV_SKU '  TO DP013-DB2-TABLE-NAME (1)28630005
286400                      MOVE XL001-SQLCA TO DP013-SQLCA             28640005
286500                      SET DP013-DB2-ABEND                         28650005
286600                                       TO TRUE                    28660005
286700                      PERFORM DP013-0000-PROCESS-ABEND            28670005
286800            END-EVALUATE                                          28680005
286900         END-IF                                                   28690005
287000                                                                  28700005
287100         MOVE PURITM-CL-NBR        TO ASC-SKU-CL-NBR              28710005
287200         MOVE PV-CS-SKU            TO ASC-SKU-SEQ-NBR             28720005
287300         MOVE ' '                  TO ASC-SKU-DASH                28730005
287400                                      ASC-SKU-DASH1               28740005
287500     ELSE                                                         28750005
287600         MOVE 'PK-'                TO ASC-PK-PRE                  28760005
287700         MOVE ASC-PACK-ID          TO ASC-PK-NBR                  28770005
287800         MOVE SPACES               TO ASC-PK-FILLER               28780005
287900     END-IF.                                                      28790005
288000                                                                  28800005
288100     PERFORM 7450-SELECT-TDISTHD.                                 28810005
288200     PERFORM 7480-SELECT-TDISTHD.                                 28820005
288300                                                                  28830005
288400     IF RECEIV-STATUS-CDE = 'VE'                                  28840005
288500         SET ASC-PROTECT-ALL-STORES TO TRUE                       28850005
288600         MOVE 'VERIFIED'           TO ASC-LINE-STATUS             28860005
288700     ELSE                                                         28870005
288800         PERFORM 7600-COUNT-LINE-TROUBLES                         28880005
288900         PERFORM 7550-FREIGHT-BILL                                28890005
288910         PERFORM 4001A-CHECK4-DC-FLUSH                            28891031
288920         IF PS-DC-FLUSH-YES                                       28892031
289000             PERFORM 4001-BUILD-INVPAR-TABLE                      28900029
289010         END-IF                                                   28901031
289100         PERFORM 4306A-LINE-STATUS                                28910005
289200     END-IF.                                                      28920005
289300                                                                  28930005
289400     IF PV-DATE = PC-DEFAULT-DATE                                 28940005
289500         MOVE SPACES               TO ASC-CONF-DATE               28950005
289600                                      ASC-CONF-TIME               28960005
289700     ELSE                                                         28970005
289800         MOVE PV-DATE              TO ASC-CONF-DATE               28980005
289900         MOVE PV-TIME              TO ASC-CONF-TIME               28990005
290000     END-IF.                                                      29000005
290100                                                                  29010005
290200     MOVE DISTHD-OTPK-UNT-QTY      TO ASC-OUT-PACK-QTY            29020005
290300     MOVE DISTHD-INPK-CNVYB-IND    TO ASC-CNVYB                   29030005
290400                                                                  29040005
290500     MOVE DISTHD-FCSE-CNFRMN-USR-ID TO ASC-USER-ID                29050005
290600                                                                  29060005
290700     IF ASC-DISPLAY-FORMAT = '3'                                  29070005
290800         MOVE DISTHD-INPK-UNT-QTY  TO ASC-INPAK-QTY               29080005
290900     ELSE                                                         29090005
291000         IF ASC-PKGNG-CDE = 'I' OR 'M'                            29100005
291100             MOVE ASC-PREPK-RATO-QTY   TO ASC-INPAK-QTY           29110005
291200         ELSE                                                     29120005
291300             MOVE DISTHD-INPK-UNT-QTY  TO ASC-INPAK-QTY           29130005
291400         END-IF                                                   29140005
291500     END-IF.                                                      29150005
291600                                                                  29160005
291700     PERFORM 7300-SUM-TDISTDT.                                    29170005
291800     PERFORM 7310-SUM-DRIVER-TDISTDT.                             29180005
291900                                                                  29190005
292000     IF (ASC-DISPLAY-FORMAT = '3')                                29200005
292100       OR (ASC-PKGNG-CDE NOT = 'I' AND 'M')                       29210005
292200         IF ASC-AUTO-VE-YES                                       29220005
292300             INITIALIZE RC074-FIELDS                              29230005
292400             IF (ASC-PKGNG-CDE = 'I' OR 'M')                      29240005
292500                 SET RC074-PACK-QTY-YES     TO TRUE               29250005
292600                 MOVE ASC-PACK-ID           TO RC074-PACK-ID      29260005
292700                 MOVE ASC-LINE-NBR          TO RC074-LINE-NBR     29270005
292800             ELSE                                                 29280005
292900                 SET RC074-UNIT-QTY-YES     TO TRUE               29290005
293000                 MOVE ASC-LINE-NBR          TO RC074-LINE-NBR     29300005
293100             END-IF                                               29310005
293200             SET RC074-CARTON-COUNT-YES TO TRUE                   29320005
293300             PERFORM 4350-CALL-RCKUT128                           29330005
293400                                                                  29340005
293500             IF (ASC-PKGNG-CDE = 'I' OR 'M')                      29350005
293600                 IF DISTHD-INPK-CNVYB-IND = 'Y'                   29360005
293700                     ADD DISTHD-INPK-CART-CNT                     29370005
293800                             TO DISTHD-FCSE-CART-CNT              29380005
293900                          GIVING ASC-EXP-CART-QTY                 29390005
294000                 ELSE                                             29400005
294100                     MOVE DISTHD-FCSE-CART-CNT TO ASC-EXP-CART-QTY29410005
294200                 END-IF                                           29420005
294300                 MOVE RC074-TOTAL-ACTL-PACK-QTY                   29430005
294400                                          TO ASC-CUR-LINE-QTY     29440005
294500                 IF ASC-AUTO-VE-YES                               29450005
294600                     MOVE RC074-TOTAL-ACTL-OTBND-CNT              29460005
294700                                           TO ASC-CUR-CART-QTY    29470005
294800                 ELSE                                             29480005
294900                     MOVE ASC-EXP-CART-QTY TO ASC-CUR-CART-QTY    29490005
295000                 END-IF                                           29500005
295100             ELSE                                                 29510005
295200                 MOVE RC074-EXPTED-ITM-QTY     TO ASC-EXP-LINE-QTY29520005
295300                 IF DISTHD-INPK-CNVYB-IND = 'Y'                   29530005
295400                     ADD DISTHD-INPK-CART-CNT                     29540005
295500                                          TO DISTHD-FCSE-CART-CNT 29550005
295600                          GIVING ASC-EXP-CART-QTY                 29560005
295700                 ELSE                                             29570005
295800                     MOVE DISTHD-FCSE-CART-CNT TO ASC-EXP-CART-QTY29580005
295900                 END-IF                                           29590005
296000                 MOVE RC074-TOTAL-ACTL-ITM-QTY                    29600005
296100                                           TO ASC-CUR-LINE-QTY    29610005
296200                 MOVE RC074-TOTAL-ACTL-OTBND-CNT                  29620005
296300                                           TO ASC-CUR-CART-QTY    29630005
296400             END-IF                                               29640005
296500         ELSE                                                     29650005
296600             COMPUTE ASC-EXP-LINE-QTY = DISTDT-FCSE-SPLT-UNT-QTY +29660005
296700                    DISTDT-INPK-SPLT-UNT-QTY                      29670005
296800             MOVE DISTDT-FCSE-ACTL-UNT-QTY TO ASC-CUR-LINE-QTY    29680005
296900             IF PV-OTPK-UNT-QTY > ZERO                            29690005
297000                 COMPUTE ASC-EXP-CART-QTY =                       29700005
297100                        (PV-DRIVER-FCSE-SPLT-UNT-QTY +            29710005
297200                          PV-DRIVER-INPK-SPLT-UNT-QTY)            29720005
297300                        / PV-OTPK-UNT-QTY                         29730005
297400                 DIVIDE PV-DRIVER-FCSE-ACTL-UNT-QTY               29740005
297500                        BY PV-OTPK-UNT-QTY                        29750005
297600                                      GIVING ASC-CUR-CART-QTY     29760005
297700             ELSE                                                 29770005
297800                 MOVE ASC-EXP-LINE-QTY                            29780005
297900                           TO ASC-EXP-CART-QTY                    29790005
298000                 MOVE DISTDT-FCSE-ACTL-UNT-QTY                    29800005
298100                           TO ASC-CUR-CART-QTY                    29810005
298200             END-IF                                               29820005
298300         END-IF                                                   29830005
298400     ELSE                                                         29840005
298500         IF ASC-PREPK-RATO-QTY NOT = +0                           29850005
298600             IF ASC-AUTO-VE-YES                                   29860005
298700                 INITIALIZE RC074-FIELDS                          29870005
298800                 SET RC074-PACK-QTY-YES     TO TRUE               29880005
298900                 SET RC074-CARTON-COUNT-YES TO TRUE               29890005
299000                 MOVE ASC-PACK-ID           TO RC074-PACK-ID      29900005
299100                 PERFORM 4350-CALL-RCKUT128                       29910005
299200                 MOVE RC074-TOTAL-EXPT-PACK-QTY                   29920005
299300                                          TO ASC-EXP-LINE-QTY     29930005
299400                 IF DISTHD-INPK-CNVYB-IND = 'Y'                   29940005
299500                     ADD DISTHD-INPK-CART-CNT                     29950005
299600                             TO DISTHD-FCSE-CART-CNT              29960005
299700                          GIVING ASC-EXP-CART-QTY                 29970005
299800                 ELSE                                             29980005
299900                     MOVE DISTHD-FCSE-CART-CNT TO ASC-EXP-CART-QTY29990005
300000                 END-IF                                           30000005
300100                 MOVE RC074-TOTAL-ACTL-PACK-QTY                   30010005
300200                                          TO ASC-CUR-LINE-QTY     30020005
300300                 IF ASC-AUTO-VE-YES                               30030005
300400                     MOVE RC074-TOTAL-ACTL-OTBND-CNT              30040005
300500                                           TO ASC-CUR-CART-QTY    30050005
300600                 ELSE                                             30060005
300700                     MOVE ASC-EXP-CART-QTY TO ASC-CUR-CART-QTY    30070005
300800                 END-IF                                           30080005
300900                                                                  30090005
301000             ELSE                                                 30100005
301100                 COMPUTE ASC-EXP-LINE-QTY =                       30110005
301200                    DISTDT-FCSE-SPLT-UNT-QTY +                    30120005
301300                            DISTDT-INPK-SPLT-UNT-QTY              30130005
301400                 MOVE DISTDT-FCSE-ACTL-UNT-QTY TO ASC-CUR-LINE-QTY30140005
301500                 IF DISTHD-OTPK-UNT-QTY > ZERO                    30150005
301600                     DIVIDE ASC-EXP-LINE-QTY                      30160005
301700                            BY DISTHD-OTPK-UNT-QTY                30170005
301800                                          GIVING ASC-EXP-CART-QTY 30180005
301900                     DIVIDE DISTDT-FCSE-ACTL-UNT-QTY              30190005
302000                            BY DISTHD-OTPK-UNT-QTY                30200005
302100                                          GIVING ASC-CUR-CART-QTY 30210005
302200                 ELSE                                             30220005
302300                     MOVE ASC-EXP-LINE-QTY                        30230005
302400                               TO ASC-EXP-CART-QTY                30240005
302500                     MOVE DISTDT-FCSE-ACTL-UNT-QTY                30250005
302600                               TO ASC-CUR-CART-QTY                30260005
302700                 END-IF                                           30270005
302800             END-IF                                               30280005
302900         ELSE                                                     30290005
303000             IF ASC-AUTO-VE-YES                                   30300005
303100                 INITIALIZE RC074-FIELDS                          30310005
303200                 SET RC074-UNIT-QTY-YES     TO TRUE               30320005
303300                 SET RC074-CARTON-COUNT-YES TO TRUE               30330005
303400                 MOVE ASC-LINE-NBR          TO RC074-LINE-NBR     30340005
303500                 PERFORM 4350-CALL-RCKUT128                       30350005
303600                 MOVE RC074-EXPTED-ITM-QTY     TO ASC-EXP-LINE-QTY30360005
303700                 IF DISTHD-INPK-CNVYB-IND = 'Y'                   30370005
303800                     ADD DISTHD-INPK-CART-CNT                     30380005
303900                                TO DISTHD-FCSE-CART-CNT           30390005
304000                          GIVING ASC-EXP-CART-QTY                 30400005
304100                 ELSE                                             30410005
304200                     MOVE DISTHD-FCSE-CART-CNT TO ASC-EXP-CART-QTY30420005
304300                 END-IF                                           30430005
304400                 MOVE RC074-TOTAL-ACTL-ITM-QTY TO ASC-CUR-LINE-QTY30440005
304500                 MOVE RC074-TOTAL-ACTL-OTBND-CNT                  30450005
304600                                           TO ASC-CUR-CART-QTY    30460005
304700             ELSE                                                 30470005
304800                 COMPUTE ASC-EXP-LINE-QTY =                       30480005
304900                                        DISTDT-FCSE-SPLT-UNT-QTY +30490005
305000                    DISTDT-INPK-SPLT-UNT-QTY                      30500005
305100                 MOVE DISTDT-FCSE-ACTL-UNT-QTY TO ASC-CUR-LINE-QTY30510005
305200                 IF DISTHD-OTPK-UNT-QTY > ZERO                    30520005
305300                     DIVIDE ASC-EXP-LINE-QTY                      30530005
305400                            BY DISTHD-OTPK-UNT-QTY                30540005
305500                                          GIVING ASC-EXP-CART-QTY 30550005
305600                     DIVIDE DISTDT-FCSE-ACTL-UNT-QTY              30560005
305700                            BY DISTHD-OTPK-UNT-QTY                30570005
305800                                          GIVING ASC-CUR-CART-QTY 30580005
305900                 ELSE                                             30590005
306000                     MOVE ASC-EXP-LINE-QTY                        30600005
306100                               TO ASC-EXP-CART-QTY                30610005
306200                     MOVE DISTDT-FCSE-ACTL-UNT-QTY                30620005
306300                               TO ASC-CUR-CART-QTY                30630005
306400                 END-IF                                           30640005
306500             END-IF                                               30650005
306600         END-IF                                                   30660005
306700     END-IF.                                                      30670005
306800                                                                  30680005
306900     IF DISTHD-RSLTS-RCVD-TMST = PC-DEFAULT-TMST                  30690005
307000         IF (ASC-DISPLAY-FORMAT = '3')                            30700005
307100           OR (ASC-PKGNG-CDE NOT = 'I' AND 'M')                   30710005
307200           OR (ASC-PREPK-RATO-QTY = +0)                           30720005
307300             MOVE DISTDT-P2L-SPLT-UNT-QTY TO ASC-P2L-QTY-LINE     30730005
307400         ELSE                                                     30740005
307500             COMPUTE ASC-P2L-QTY-LINE = DISTDT-P2L-SPLT-UNT-QTY   30750005
307600                                      / ASC-PREPK-RATO-QTY        30760005
307700         END-IF                                                   30770005
307800     ELSE                                                         30780005
307900         IF (ASC-DISPLAY-FORMAT = '3')                            30790005
308000           OR (ASC-PKGNG-CDE NOT = 'I' AND 'M')                   30800005
308100           OR (ASC-PREPK-RATO-QTY = +0)                           30810005
308200             MOVE DISTDT-ACTL-ALLOC-QTY TO ASC-P2L-QTY-LINE       30820005
308300         ELSE                                                     30830005
308400             COMPUTE ASC-P2L-QTY-LINE = DISTDT-ACTL-ALLOC-QTY     30840005
308500                                      / ASC-PREPK-RATO-QTY        30850005
308600         END-IF                                                   30860005
308700     END-IF.                                                      30870005
308800                                                                  30880005
308900                                                                  30890005
309000     EVALUATE TRUE                                                30900005
309100         WHEN DISTDT-P2L-SPLT-UNT-QTY       = ZERO                30910005
309200             MOVE 'N/A     '          TO ASC-P2L-STATUS           30920005
309300         WHEN DISTHD-RSLTS-RCVD-TMST = PC-DEFAULT-TMST            30930005
309400             MOVE 'DOWNLOAD'          TO ASC-P2L-STATUS           30940005
309500         WHEN OTHER                                               30950005
309600             MOVE 'COMPLETE'          TO ASC-P2L-STATUS           30960005
309700     END-EVALUATE.                                                30970005
309800     PERFORM 4200-COUNT-DAMAGED.                                  30980005
309900     IF PV-DMG-CARTS > 0                                          30990005
310000         MOVE 'DAMAGE CARTONS EXIST'  TO ADMGCRTO                 31000005
310100         MOVE DP015-YELLOW            TO ADMGCRTC                 31010005
310200     ELSE                                                         31020005
310300         MOVE SPACES                  TO ADMGCRTO                 31030005
310400         MOVE DP015-BLUE              TO ADMGCRTC                 31040005
310500     END-IF.                                                      31050005
310600                                                                  31060005
310700     PERFORM 4010-OPEN-CURSOR.                                    31070005
310800                                                                  31080005
310900     PERFORM 4300-READ-ITEMS-FROM-DB.                             31090005
311000                                                                  31100005
311100     PERFORM 4020-CLOSE-CURSOR.                                   31110005
311200                                                                  31120005
311300     MOVE +1                       TO PV-TOP-ITEM.                31130005
311400                                                                  31140005
311500     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          31150005
311600         IF DP020-NEXT-ACT-INITIAL                                31160005
311700             SET DP020-NEXT-ACT-APPL-ERROR                        31170005
311800                                   TO TRUE                        31180005
311900             SET DP020-MSG-FATAL   TO TRUE                        31190005
312000             MOVE PC-TSYMSG-00050  TO DP020-MSG-NUMBER            31200005
312100         ELSE                                                     31210005
312200             SET DP020-MSG-FATAL   TO TRUE                        31220005
312300             MOVE PC-TSYMSG-00050  TO DP020-MSG-NUMBER            31230005
312400             SET ASC-BLOCK-MODIFIED (1)                           31240005
312500                 ASC-BLOCK-MODIFIED (2)                           31250005
312600                                   TO TRUE                        31260005
312700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 31270005
312800         END-IF                                                   31280005
312900     ELSE                                                         31290005
313000         MOVE -1                   TO MR-SELECTL (1)              31300005
313100         SET DP030-SET-CURSOR-APPL-1                              31310005
313200                                   TO TRUE                        31320005
313300         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     31330005
313400     END-IF.                                                      31340005
313500                                                                  31350005
313810******************************************************************31381029
313820*  CHECK TKRPRPM TO SEE IF THE DC'S NEED TO BE FLUSHED.           31382029
313830******************************************************************31383029
313840 4001A-CHECK4-DC-FLUSH.                                           31384029
313850                                                                  31385029
313860     EXEC SQL                                                     31386029
313870          SELECT  FUNC_TXT                                        31387029
313880          INTO   :KRPRPM-FUNC-TXT                                 31388029
313890          FROM  TKRPRPM                                           31389029
313891          WHERE LOC_ID            =  90                           31389129
313892            AND SYS_PRC_FUNC_CDE  =  'FLUSH'                      31389229
313893            AND FUNC_PRC_STAT_CDE =  'AC'                         31389329
313894     END-EXEC.                                                    31389429
313895                                                                  31389529
313896     EVALUATE TRUE                                                31389629
313897         WHEN SQLCODE = +0                                        31389729
313898            IF KRPRPM-FUNC-TXT = 'N'                              31389829
313899                SET PS-DC-FLUSH-NO  TO TRUE                       31389929
313900            ELSE                                                  31390029
313901                SET PS-DC-FLUSH-YES TO TRUE                       31390129
313902            END-IF                                                31390229
313903         WHEN OTHER                                               31390329
313904                SET PS-DC-FLUSH-NO  TO TRUE                       31390429
313905     END-EVALUATE.                                                31390529
313910                                                                  31391005
314000 4001-BUILD-INVPAR-TABLE.                                         31400005
314100                                                                  31410005
314200*    THIS SETS A SWITCH FOR EACH STORE THAT HAS AN INVENTORY      31420005
314300*    IN PROCESS.                                                  31430005
314400                                                                  31440005
314500     PERFORM 7400-OPEN-INVPAR-CSR                                 31450005
314600     PERFORM 7401-FETCH-INVPAR-CSR                                31460005
314700     INITIALIZE PT-INVPAR-TABLE.                                  31470005
314800     PERFORM                                                      31480005
314900         UNTIL PS-EOF-INVPAR-CSR                                  31490005
315000             MOVE XLT00025-LOC-NBR    TO PT-STORE-NBR             31500028
315100             SET PT-STORE-DOING-INVENTORY (PT-STORE-NBR)          31510005
315200                                      TO TRUE                     31520005
315300             PERFORM 7401-FETCH-INVPAR-CSR                        31530005
315400     END-PERFORM.                                                 31540005
315500                                                                  31550005
315600     PERFORM 7402-CLOSE-INVPAR-CSR.                               31560005
315700                                                                  31570005
315800                                                                  31580005
315900 4010-OPEN-CURSOR.                                                31590005
316000                                                                  31600005
316100     EXEC SQL                                                     31610005
316200         OPEN STORE-CSR                                           31620005
316300     END-EXEC                                                     31630005
316400                                                                  31640005
316500     EVALUATE TRUE                                                31650005
316600         WHEN SQLCODE = ZERO                                      31660005
316700              CONTINUE                                            31670005
316800         WHEN SQLCODE = -904                                      31680005
316900         WHEN SQLCODE = -911                                      31690005
317000         WHEN SQLCODE = -913                                      31700005
317100             PERFORM 9900-SOFT-ABORT                              31710005
317200         WHEN SQLWARN0 NOT = SPACE                                31720005
317300         WHEN SQLCODE  NOT = ZERO                                 31730005
317400             MOVE '4010-OPEN-CURSOR'                              31740005
317500                                   TO DP013-PARAGRAPH             31750005
317600             MOVE 'OPEN STORE-CSR CURSOR'                         31760005
317700                                   TO DP013-MESSAGE-TEXT (1)      31770005
317800             MOVE SQLCA       TO DP013-SQLCA                      31780005
317900             MOVE 'TDISTDT'   TO DP013-DB2-TABLE-NAME (1)         31790005
318000             SET DP013-DB2-ABEND                                  31800005
318100                                   TO TRUE                        31810005
318200             PERFORM DP013-0000-PROCESS-ABEND                     31820005
318300     END-EVALUATE.                                                31830005
318400                                                                  31840005
318500*----------------------------------------------------------------*31850005
318600* CLOSE THE FACILITY CURSOR.                                     *31860005
318700*----------------------------------------------------------------*31870005
318800                                                                  31880005
318900 4020-CLOSE-CURSOR.                                               31890005
319000                                                                  31900005
319100     EXEC SQL                                                     31910005
319200         CLOSE STORE-CSR                                          31920005
319300     END-EXEC.                                                    31930005
319400                                                                  31940005
319500     EVALUATE TRUE                                                31950005
319600         WHEN SQLCODE = ZERO                                      31960005
319700              CONTINUE                                            31970005
319800         WHEN SQLWARN0 NOT = SPACE                                31980005
319900         WHEN SQLCODE  NOT = ZERO                                 31990005
320000              MOVE '4020-CLOSE-CURSOR'                            32000005
320100                                   TO DP013-PARAGRAPH             32010005
320200              MOVE 'CLOSE STORE-CSR CURSOR'                       32020005
320300                                   TO DP013-MESSAGE-TEXT (1)      32030005
320400              MOVE SQLCA           TO DP013-SQLCA                 32040005
320500              MOVE 'TDISTDT'       TO DP013-DB2-TABLE-NAME (1)    32050005
320600              SET DP013-DB2-ABEND  TO TRUE                        32060005
320700              PERFORM DP013-0000-PROCESS-ABEND                    32070005
320800     END-EVALUATE.                                                32080005
320900                                                                  32090005
321000*----------------------------------------------------------------*32100005
321100 4030-CHECK-DISTHD.                                               32110005
321200                                                                  32120005
321300     EXEC SQL                                                     32130005
321400         SELECT COUNT (*)                                         32140005
321500           INTO :PV-PREPK-BLANK-COUNT                             32150005
321600           FROM TDISTHD A                                         32160005
321700          WHERE A.ORD_NBR            = :DK-ORD-NBR                32170005
321800            AND A.RCVR_SEQ_NBR       = :DK-RCVR-NBR               32180005
321900            AND A.PREPK_LNE_PRC_CDE  = ' '                        32190005
322000            AND A.DLT_REQ_TMST       = :PC-DEFAULT-TMST           32200005
322100     END-EXEC.                                                    32210005
322200                                                                  32220005
322300     EVALUATE TRUE                                                32230005
322400         WHEN SQLCODE = ZERO                                      32240005
322500             CONTINUE                                             32250005
322600                                                                  32260005
322700         WHEN SQLWARN0 NOT = SPACES                               32270005
322800         WHEN SQLCODE < ZERO                                      32280005
322900         WHEN SQLCODE > ZERO                                      32290005
323000             MOVE '4030-CHECK-TDISTHD' TO DP013-PARAGRAPH         32300005
323100             MOVE 'UNSUCCESSFUL SELECT TDISTHD '                  32310005
323200                                   TO DP013-MESSAGE-TEXT (1)      32320005
323300             MOVE SQLCA            TO DP013-SQLCA                 32330005
323400             MOVE 'TDISTHD '       TO DP013-DB2-TABLE-NAME (1)    32340005
323500             SET DP013-DB2-ABEND                                  32350005
323600                 DP013-NO-ROLLBACK TO TRUE                        32360005
323700             PERFORM DP013-0000-PROCESS-ABEND                     32370005
323800     END-EVALUATE.                                                32380005
323900                                                                  32390005
324000*----------------------------------------------------------------*32400005
324100*    DEPENDING ON WHAT WAS PASSED IN THE COMMAREA, SETUP THE     *32410005
324200*    DB2 KEYS IN PREPARATION FOR THE OPEN CURSOR.                *32420005
324300*----------------------------------------------------------------*32430005
324400 4100-PREPARE-CURSOR.                                             32440005
324500                                                                  32450005
324600     MOVE ASC-KEY-PO-NBR            TO DK-ORD-NBR                 32460005
324700                                       ASC-ORD-NBR.               32470005
324800                                                                  32480005
324900     MOVE ASC-KEY-RCVR-NBR          TO DK-RCVR-NBR                32490005
325000                                       ASC-RCVR-NBR.              32500005
325100                                                                  32510005
325200     MOVE ASC-KEY-LNE-NBR           TO DK-LINE-NBR                32520005
325300                                       ASC-LINE-NBR.              32530005
325400                                                                  32540005
325500 4200-COUNT-DAMAGED.                                              32550005
325600                                                                  32560005
325700     IF ASC-PKGNG-CDE = 'I' OR 'M'                                32570005
325800         PERFORM 8091-OPEN-PACK-CSR                               32580005
325900         PERFORM 4210-GET-EACH-LINE-IN-PACK                       32590005
326000             UNTIL PS-MORE-RECITM-NO OR PS-ERROR                  32600005
326100         PERFORM 8092-CLOSE-PACK-CSR                              32610005
326200     ELSE                                                         32620005
326300         PERFORM 4250-COUNT-DAMAGED-CRTNS                         32630005
326400     END-IF.                                                      32640005
326500                                                                  32650005
326600 4210-GET-EACH-LINE-IN-PACK.                                      32660005
326700                                                                  32670005
326800     PERFORM 8094-FETCH-PACK-CSR.                                 32680005
326900                                                                  32690005
327000     IF PS-MORE-RECITM-YES                                        32700005
327100         MOVE RECITM-ORD-LNE-NBR      TO DK-DMG-LINE-NBR          32710005
327200         PERFORM 4250-COUNT-DAMAGED-CRTNS                         32720005
327300         IF PV-DMG-CARTS > +0                                     32730005
327400             SET PS-MORE-RECITM-NO TO TRUE                        32740005
327500         END-IF                                                   32750005
327600     END-IF.                                                      32760005
327700                                                                  32770005
327800 4250-COUNT-DAMAGED-CRTNS.                                        32780005
327900     MOVE 0             TO PV-DMG-CARTS.                          32790005
328000                                                                  32800005
328100     EXEC SQL                                                     32810005
328200         SELECT COUNT(*)                                          32820005
328300           INTO :PV-DMG-CARTS                                     32830005
328400           FROM SUT_OTBND_UPC A                                   32840005
328500              , SUT_OTBND_CART B                                  32850005
328600           WHERE A.TRN_NBR      = :DK-ORD-NBR                     32860005
328700             AND A.RCVR_SEQ_NBR = :DK-RCVR-NBR                    32870005
328800             AND A.TRN_LNE_NBR  = :DK-DMG-LINE-NBR                32880005
328900             AND A.SHIPT_UNT_ID = B.SHIPT_UNT_ID                  32890005
329000             AND B.CART_SRC_CDE = 'DMG'                           32900005
329100     END-EXEC.                                                    32910005
329200                                                                  32920005
329300     EVALUATE TRUE                                                32930005
329400         WHEN SQLCODE = ZERO                                      32940005
329500         WHEN SQLCODE = -305                                      32950005
329600              CONTINUE                                            32960005
329700         WHEN SQLWARN0 NOT = SPACE                                32970005
329800         WHEN SQLCODE < ZERO                                      32980005
329900         WHEN SQLCODE > ZERO                                      32990005
330000              MOVE '4250-COUNT-DAMAG' TO DP013-PARAGRAPH          33000005
330100              MOVE 'COUNT DAMAGED CARTONS'                        33010005
330200                                      TO DP013-MESSAGE-TEXT (1)   33020005
330300              MOVE SQLCA              TO DP013-SQLCA              33030005
330400              MOVE 'SUT00024'         TO DP013-DB2-TABLE-NAME (1) 33040005
330500              MOVE 'SUT00028'         TO DP013-DB2-TABLE-NAME (2) 33050005
330600              SET DP013-DB2-ABEND     TO TRUE                     33060005
330700              PERFORM DP013-0000-PROCESS-ABEND                    33070005
330800     END-EVALUATE.                                                33080005
330900                                                                  33090005
331000*----------------------------------------------------------------*33100005
331100*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *33110005
331200*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *33120005
331300*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *33130005
331400*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *33140005
331500*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *33150005
331600*                                                                *33160005
331700*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *33170005
331800*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *33180005
331900*    UPON INITIALIZATION.                                        *33190005
332000*----------------------------------------------------------------*33200005
332100 4300-READ-ITEMS-FROM-DB.                                         33210005
332200                                                                  33220005
332300     PERFORM                                                      33230005
332400         VARYING PV-READ-COUNT                                    33240005
332500         FROM 1 BY 1                                              33250005
332600         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    33260005
332700            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         33270005
332800                                                                  33280005
332900         PERFORM 4310-FETCH                                       33290005
333000                                                                  33300005
333100* 4300A-BLOCK-SUBSCRIPTS ADVANCES TO A NEW LINE ON THE SCREEN.    33310005
333200         IF  ASC-ITEMS-LEFT-ON-DB                                 33320005
333300             PERFORM 4300A-BLOCK-SUBSCRIPTS                       33330005
333400                                                                  33340005
333500             PERFORM 4306-FILL-SCREEN-LINE                        33350005
333600         END-IF                                                   33360005
333700                                                                  33370005
333800     END-PERFORM.                                                 33380005
333900                                                                  33390005
334000     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          33400005
334100         MOVE +1                   TO ASC-BLK-SUB                 33410005
334200         PERFORM 5100-WRITE-TEMP-STORAGE                          33420005
334300         ADD +1                    TO ASC-BLK-SUB                 33430005
334400         PERFORM 5100-WRITE-TEMP-STORAGE                          33440005
334500                                                                  33450005
334600         MOVE 1                    TO ASC-BLK-SUB                 33460005
334700                                      PV-BLOCK-NUMBER             33470005
334800         PERFORM 4410-READ-TEMP-STORAGE                           33480005
334900         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             33490005
335000             MOVE 2                TO ASC-BLK-SUB                 33500005
335100                                      PV-BLOCK-NUMBER             33510005
335200             PERFORM 4410-READ-TEMP-STORAGE                       33520005
335300         END-IF                                                   33530005
335400     END-IF.                                                      33540005
335500                                                                  33550005
335600 4300A-BLOCK-SUBSCRIPTS.                                          33560005
335700     IF  ASC-ITEMS-LEFT-ON-DB                                     33570005
335800             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                33580005
335900                 ADD +1            TO ASC-ITEM-SUB                33590005
336000             ELSE                                                 33600005
336100                 ADD +1            TO ASC-BLK-SUB                 33610005
336200                 MOVE +1           TO ASC-ITEM-SUB                33620005
336300                                                                  33630005
336400                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         33640005
336500                     MOVE +1       TO ASC-BLK-SUB                 33650005
336600                     SET ASC-BLOCK-MODIFIED (1)                   33660005
336700                                   TO TRUE                        33670005
336800                     PERFORM 5100-WRITE-TEMP-STORAGE              33680005
336900                     MOVE ASC-BLOCK-ENTRIES                       33690005
337000                               (PC-MAX-BLOCKS-IN-ARRAY)           33700005
337100                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 33710005
337200                     ADD +1        TO ASC-BLK-SUB                 33720005
337300                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   33730005
337400                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      33740005
337500                                   TO TRUE                        33750005
337600                 END-IF                                           33760005
337700             END-IF                                               33770005
337800             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    33780005
337900             MOVE ASC-NUMBER-OF-ITEMS-READ                        33790005
338000                                   TO ASC-LIST-ITEM-NUMBER        33800005
338100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  33810005
338200     END-IF.                                                      33820005
338300                                                                  33830005
364000                                                                  36400005
364010 4306-FILL-SCREEN-LINE.                                           36401012
364020                                                                  36402012
364030     MOVE DISTDT-STR-NBR              TO ASC-STORE-NBR            36403012
364040                                      (ASC-BLK-SUB ASC-ITEM-SUB). 36404012
364050                                                                  36405012
364060     PERFORM 7320-SELECT-DISTDT-DRIVER.                           36406012
364070                                                                  36407012
364080     IF (ASC-DISPLAY-FORMAT = '3')                                36408012
364090         IF ASC-AUTO-VE-YES                                       36409012
364091             INITIALIZE RC074-FIELDS                              36409112
364092             IF (ASC-PKGNG-CDE = 'I' OR 'M')                      36409212
364093               AND (ASC-PREPK-RATO-QTY NOT = +0)                  36409312
364094                 SET RC074-PACK-QTY-YES     TO TRUE               36409412
364095                 MOVE ASC-PACK-ID           TO RC074-PACK-ID      36409512
364096                 MOVE ASC-LINE-NBR          TO RC074-LINE-NBR     36409612
364097             ELSE                                                 36409712
364098                 SET RC074-UNIT-QTY-YES     TO TRUE               36409812
364099                 MOVE ASC-LINE-NBR          TO RC074-LINE-NBR     36409912
364100             END-IF                                               36410012
364101             SET RC074-CARTON-COUNT-YES TO TRUE                   36410112
364102             MOVE DISTDT-STR-NBR        TO RC074-STR-NBR          36410212
364103             PERFORM 4350-CALL-RCKUT128                           36410312
364104             IF (ASC-PKGNG-CDE = 'I' OR 'M')                      36410412
364105               AND (ASC-PREPK-RATO-QTY NOT = +0)                  36410512
364106                 MOVE RC074-FCSE-ACTL-ITM-QTY                     36410623
364107                   TO ASC-CUR-STR-QTY (ASC-BLK-SUB ASC-ITEM-SUB)  36410712
364108                 MOVE RC074-FCSE-ACTL-OTBND-CNT                   36410827
364109                   TO ASC-CUR-STR-CRT(ASC-BLK-SUB ASC-ITEM-SUB)   36410912
364110                 MOVE RC074-P2L-ACTL-ITM-QTY                      36411012
364111                   TO ASC-P2L-QTY (ASC-BLK-SUB ASC-ITEM-SUB)      36411112
364112             ELSE                                                 36411212
364113                 MOVE RC074-FCSE-ACTL-ITM-QTY                     36411323
364114                   TO ASC-CUR-STR-QTY (ASC-BLK-SUB ASC-ITEM-SUB)  36411412
364115                 MOVE RC074-TOTAL-ACTL-OTBND-CNT                  36411512
364117                   TO ASC-CUR-STR-CRT(ASC-BLK-SUB ASC-ITEM-SUB)   36411724
364118                 MOVE RC074-P2L-ACTL-ITM-QTY                      36411824
364119                   TO ASC-P2L-QTY (ASC-BLK-SUB ASC-ITEM-SUB)      36411924
364120             END-IF                                               36412024
364121         ELSE                                                     36412124
364122             MOVE DISTDT-FCSE-ACTL-UNT-QTY                        36412224
364123                    TO ASC-CUR-STR-QTY (ASC-BLK-SUB ASC-ITEM-SUB) 36412324
364124             IF PV-OTPK-UNT-QTY > ZERO                            36412424
364125                 DIVIDE PV-FCSE-ACTL-UNT-QTY                      36412524
364126                        BY PV-OTPK-UNT-QTY                        36412624
364127                  GIVING ASC-CUR-STR-CRT(ASC-BLK-SUB ASC-ITEM-SUB)36412724
364128             ELSE                                                 36412824
364129                 MOVE DISTDT-FCSE-ACTL-UNT-QTY                    36412924
364130                      TO ASC-CUR-STR-CRT(ASC-BLK-SUB ASC-ITEM-SUB)36413024
364131             END-IF                                               36413124
364132             IF DISTHD-RSLTS-RCVD-TMST = PC-DEFAULT-TMST          36413224
364133                 IF (ASC-DISPLAY-FORMAT = '3')                    36413324
364134                   OR (ASC-PKGNG-CDE NOT = 'I' AND 'M')           36413424
364135                   OR (ASC-PREPK-RATO-QTY = +0)                   36413524
364136                     MOVE DISTDT-P2L-SPLT-UNT-QTY                 36413624
364137                         TO ASC-P2L-QTY (ASC-BLK-SUB ASC-ITEM-SUB)36413724
364138                 ELSE                                             36413824
364139                    COMPUTE ASC-P2L-QTY (ASC-BLK-SUB ASC-ITEM-SUB)36413924
364140                       = DISTDT-P2L-SPLT-UNT-QTY                  36414024
364141                       / ASC-PREPK-RATO-QTY                       36414124
364142                 END-IF                                           36414224
364143             ELSE                                                 36414324
364144                 IF (ASC-DISPLAY-FORMAT = '3')                    36414424
364145                   OR (ASC-PKGNG-CDE NOT = 'I' AND 'M')           36414524
364146                   OR (ASC-PREPK-RATO-QTY = +0)                   36414624
364147                    MOVE DISTDT-ACTL-ALLOC-QTY                    36414724
364148                         TO ASC-P2L-QTY (ASC-BLK-SUB ASC-ITEM-SUB)36414824
364149                 ELSE                                             36414924
364150                     COMPUTE ASC-P2L-QTY(ASC-BLK-SUB ASC-ITEM-SUB)36415024
364151                                     =  DISTDT-ACTL-ALLOC-QTY     36415124
364152                                      / ASC-PREPK-RATO-QTY        36415224
364153                 END-IF                                           36415324
364154             END-IF                                               36415424
364155         END-IF                                                   36415524
364156     ELSE                                                         36415624
364157         IF (ASC-PKGNG-CDE = 'I' OR 'M')                          36415724
364158           AND (ASC-PREPK-RATO-QTY NOT = +0)                      36415824
364159             IF ASC-AUTO-VE-YES                                   36415924
364160                 INITIALIZE RC074-FIELDS                          36416024
364161                 SET RC074-PACK-QTY-YES     TO TRUE               36416124
364162                 SET RC074-CARTON-COUNT-YES TO TRUE               36416224
364163                 MOVE ASC-PACK-ID           TO RC074-PACK-ID      36416324
364164                 MOVE DISTDT-STR-NBR        TO RC074-STR-NBR      36416424
364165**************   MOVE ASC-LINE-NBR          TO RC074-LINE-NBR     36416524
364166                 PERFORM 4350-CALL-RCKUT128                       36416624
364167                 MOVE RC074-FCSE-ACTL-PACK-QTY                    36416724
364168                   TO ASC-CUR-STR-QTY (ASC-BLK-SUB ASC-ITEM-SUB)  36416824
364169                 MOVE RC074-TOTAL-ACTL-OTBND-CNT                  36416924
364170                   TO ASC-CUR-STR-CRT(ASC-BLK-SUB ASC-ITEM-SUB)   36417024
364171                 MOVE RC074-P2L-ACTL-PACK-QTY                     36417124
364172                   TO ASC-P2L-QTY (ASC-BLK-SUB ASC-ITEM-SUB)      36417224
364173             ELSE                                                 36417324
364174*QTY CALC                                                         36417424
364175               IF PV-OTPK-UNT-QTY > ZERO                          36417524
364176                   COMPUTE ASC-CUR-STR-QTY                        36417624
364177                               (ASC-BLK-SUB ASC-ITEM-SUB) =       36417724
364178                   DISTDT-FCSE-ACTL-UNT-QTY / PV-OTPK-UNT-QTY     36417824
364179               ELSE                                               36417924
364180                   COMPUTE ASC-CUR-STR-QTY                        36418024
364181                              (ASC-BLK-SUB ASC-ITEM-SUB) =        36418124
364182                   DISTDT-FCSE-ACTL-UNT-QTY / PV-INPK-UNT-QTY     36418224
364183               END-IF                                             36418324
364184*CRTN CALC                                                        36418424
364185               MOVE ZEROES     TO PV-CURR-CRTN-COUNT              36418524
364186                                  PV-CURR-CRTN-COUNT-INNER        36418624
364187                                  PV-REMAINDER-CURR-CTN           36418724
364188*CURRENT CRTN                                                     36418824
364189               IF PV-OTPK-UNT-QTY > 0                             36418924
364190                 DIVIDE PV-FCSE-ACTL-UNT-QTY                      36419024
364191                    BY PV-OTPK-UNT-QTY                            36419124
364192                  GIVING PV-CURR-CRTN-COUNT                       36419224
364193                  REMAINDER PV-REMAINDER-CURR-CTN                 36419324
364194                  IF PV-REMAINDER-CURR-CTN > 0                    36419424
364195                     COMPUTE PV-CURR-CRTN-COUNT-INNER =           36419524
364196                             (PV-REMAINDER-CURR-CTN /             36419624
364197                              PV-INPK-UNT-QTY )                   36419724
364198                     COMPUTE ASC-CUR-STR-CRT                      36419824
364199                               (ASC-BLK-SUB ASC-ITEM-SUB)         36419924
364200                        = (PV-CURR-CRTN-COUNT         +           36420024
364201                           PV-CURR-CRTN-COUNT-INNER )             36420124
364202                  ELSE                                            36420224
364203                     MOVE PV-CURR-CRTN-COUNT TO                   36420324
364204                            ASC-CUR-STR-CRT                       36420424
364205                              (ASC-BLK-SUB ASC-ITEM-SUB)          36420524
364206                                                                  36420624
364207                  END-IF                                          36420724
364208                ELSE                                              36420824
364209                   DIVIDE PV-FCSE-ACTL-UNT-QTY                    36420924
364210                      BY PV-INPK-UNT-QTY                          36421024
364211                    GIVING PV-CURR-CRTN-COUNT                     36421124
364212                       MOVE PV-CURR-CRTN-COUNT TO                 36421224
364213                              ASC-CUR-STR-CRT                     36421324
364214                                (ASC-BLK-SUB ASC-ITEM-SUB)        36421424
364215                END-IF                                            36421524
364223               IF DISTHD-RSLTS-RCVD-TMST = PC-DEFAULT-TMST        36422312
364224                  COMPUTE ASC-P2L-QTY (ASC-BLK-SUB ASC-ITEM-SUB)  36422412
364225                     = DISTDT-P2L-SPLT-UNT-QTY                    36422512
364226                     / ASC-PREPK-RATO-QTY                         36422612
364227               ELSE                                               36422712
364228                   COMPUTE ASC-P2L-QTY(ASC-BLK-SUB ASC-ITEM-SUB)  36422812
364229                                   =  DISTDT-ACTL-ALLOC-QTY       36422912
364230                                    / ASC-PREPK-RATO-QTY          36423012
364231               END-IF                                             36423112
364232           END-IF                                                 36423212
364233         ELSE                                                     36423312
364234             IF ASC-AUTO-VE-YES                                   36423412
364235                 INITIALIZE RC074-FIELDS                          36423512
364236                 SET RC074-UNIT-QTY-YES     TO TRUE               36423612
364237                 SET RC074-CARTON-COUNT-YES TO TRUE               36423712
364238                 MOVE DISTDT-STR-NBR        TO RC074-STR-NBR      36423812
364239                 MOVE ASC-LINE-NBR          TO RC074-LINE-NBR     36423912
364240                 PERFORM 4350-CALL-RCKUT128                       36424012
364241                 MOVE RC074-FCSE-ACTL-ITM-QTY                     36424123
364242                   TO ASC-CUR-STR-QTY (ASC-BLK-SUB ASC-ITEM-SUB)  36424212
364243                 MOVE RC074-TOTAL-ACTL-OTBND-CNT                  36424312
364244                   TO ASC-CUR-STR-CRT(ASC-BLK-SUB ASC-ITEM-SUB)   36424412
364245                 MOVE RC074-P2L-ACTL-ITM-QTY                      36424512
364246                   TO ASC-P2L-QTY (ASC-BLK-SUB ASC-ITEM-SUB)      36424612
364247             ELSE                                                 36424712
364248                 MOVE DISTDT-FCSE-ACTL-UNT-QTY                    36424812
364249                    TO ASC-CUR-STR-QTY (ASC-BLK-SUB ASC-ITEM-SUB) 36424912
364250                 IF PV-OTPK-UNT-QTY > ZERO                        36425012
364251                     DIVIDE PV-FCSE-ACTL-UNT-QTY                  36425112
364252                        BY PV-OTPK-UNT-QTY GIVING                 36425212
364253                         ASC-CUR-STR-CRT(ASC-BLK-SUB ASC-ITEM-SUB)36425312
364254                 ELSE                                             36425412
364255                     MOVE DISTDT-FCSE-ACTL-UNT-QTY                36425512
364256                      TO ASC-CUR-STR-CRT(ASC-BLK-SUB ASC-ITEM-SUB)36425612
364257                 END-IF                                           36425712
364258                 IF DISTHD-RSLTS-RCVD-TMST = PC-DEFAULT-TMST      36425812
364259                     IF (ASC-DISPLAY-FORMAT = '3')                36425912
364260                       OR (ASC-PKGNG-CDE NOT = 'I' AND 'M')       36426012
364261                       OR (ASC-PREPK-RATO-QTY = +0)               36426112
364262                         MOVE DISTDT-P2L-SPLT-UNT-QTY             36426212
364263                         TO ASC-P2L-QTY (ASC-BLK-SUB ASC-ITEM-SUB)36426312
364264                     ELSE                                         36426412
364265                        COMPUTE ASC-P2L-QTY                       36426512
364266                                        (ASC-BLK-SUB ASC-ITEM-SUB)36426612
364267                           = DISTDT-P2L-SPLT-UNT-QTY              36426712
364268                           / ASC-PREPK-RATO-QTY                   36426812
364269                     END-IF                                       36426912
364270                 ELSE                                             36427012
364271                     IF (ASC-DISPLAY-FORMAT = '3')                36427112
364272                       OR (ASC-PKGNG-CDE NOT = 'I' AND 'M')       36427212
364273                       OR (ASC-PREPK-RATO-QTY = +0)               36427312
364274                        MOVE DISTDT-ACTL-ALLOC-QTY                36427412
364275                          TO ASC-P2L-QTY(ASC-BLK-SUB ASC-ITEM-SUB)36427512
364276                     ELSE                                         36427612
364277                         COMPUTE ASC-P2L-QTY                      36427712
364278                                        (ASC-BLK-SUB ASC-ITEM-SUB)36427812
364279                                     =  DISTDT-ACTL-ALLOC-QTY     36427912
364280                                      / ASC-PREPK-RATO-QTY        36428012
364281                     END-IF                                       36428112
364282                 END-IF                                           36428212
364283             END-IF                                               36428312
364284         END-IF                                                   36428412
364285     END-IF.                                                      36428512
364286                                                                  36428612
364287     MOVE 0               TO PV-NUMBER-OF-CARTONS                 36428713
364288                             PV-NUMBER-OF-UNITS.                  36428813
364289****CALCULATE EXPECTED CARTONS                                    36428912
364290     IF PV-INPK-SPLT-UNT-QTY > 0 AND                              36429012
364291        PV-INPK-UNT-QTY > 0                                       36429112
364292         COMPUTE PV-NUMBER-OF-CARTONS = PV-INPK-SPLT-UNT-QTY      36429212
364293                    / PV-INPK-UNT-QTY                             36429312
364294     END-IF.                                                      36429412
364295     IF PV-OTPK-UNT-QTY > 0                                       36429512
364296         COMPUTE PV-NUMBER-OF-CARTONS = PV-NUMBER-OF-CARTONS +    36429612
364297                 (PV-FCSE-SPLT-UNT-QTY / PV-OTPK-UNT-QTY)         36429712
364298     ELSE                                                         36429812
364299         COMPUTE PV-NUMBER-OF-CARTONS = PV-NUMBER-OF-CARTONS +    36429912
364300                  PV-FCSE-SPLT-UNT-QTY                            36430012
364301     END-IF.                                                      36430112
364302     MOVE PV-NUMBER-OF-CARTONS                                    36430212
364303                   TO ASC-EXP-STR-CRT (ASC-BLK-SUB ASC-ITEM-SUB). 36430312
364304****CALCULATE EXPECTED UNITS                                      36430412
364305     IF (ASC-DISPLAY-FORMAT = '3')  OR                            36430521
364306        (ASC-PKGNG-CDE NOT = 'I' AND 'M') OR                      36430621
364307        (PV-INPK-UNT-QTY   = 0)                                   36430721
364308         COMPUTE PV-NUMBER-OF-UNITS =                             36430821
364309              DISTDT-FCSE-SPLT-UNT-QTY + DISTDT-INPK-SPLT-UNT-QTY 36430921
364310     ELSE                                                         36431018
364311       IF DISTDT-INPK-SPLT-UNT-QTY > 0                            36431121
364313           COMPUTE PV-NUMBER-OF-UNITS  = DISTDT-INPK-SPLT-UNT-QTY 36431318
364314                      / PV-INPK-UNT-QTY                           36431418
364315       END-IF                                                     36431519
364317       COMPUTE PV-NUMBER-OF-UNITS  =  PV-NUMBER-OF-UNITS   +      36431721
364318              (DISTDT-FCSE-SPLT-UNT-QTY / PV-INPK-UNT-QTY)        36431821
364324     END-IF                                                       36432418
364325     MOVE PV-NUMBER-OF-UNITS                                      36432512
364326                   TO ASC-EXP-STR-QTY (ASC-BLK-SUB ASC-ITEM-SUB). 36432612
364327*****                                                             36432712
364328                                                                  36432812
364329     IF ASC-PKGNG-CDE = 'I' OR 'M'                                36432912
364330        AND (ASC-PREPK-RATO-QTY NOT = +0)                         36433012
364331         IF ASC-AUTO-VE-YES                                       36433112
364332             IF  RECITM-STATUS-CDE EQUAL 'VE'                     36433212
364333                 MOVE RC074-VERIFY-ODD-QTY                        36433312
364334                   TO ASC-ODD-UNIT (ASC-BLK-SUB ASC-ITEM-SUB)     36433412
364335             ELSE                                                 36433512
364336                 MOVE RC074-ACTUAL-ODD-QTY                        36433612
364337                   TO ASC-ODD-UNIT (ASC-BLK-SUB ASC-ITEM-SUB)     36433712
364338             END-IF                                               36433812
364339         ELSE                                                     36433912
364340           MOVE ASC-PACK-ID  TO PV-PREPK-ID                       36434012
364341           MOVE ASC-STORE-NBR (ASC-BLK-SUB ASC-ITEM-SUB)          36434112
364342                                       TO PV-STR-NBR              36434212
364343           IF (ASC-DISPLAY-FORMAT = '3')                          36434312
364344               PERFORM 4320-SELECT-ODD-UNIT                       36434412
364345           ELSE                                                   36434512
364346               PERFORM 4330-SELECT-ODD-UNIT                       36434612
364347           END-IF                                                 36434712
364348                                                                  36434812
364349           MOVE PV-PREPK-ODD-UNT-QTY                              36434912
364350             TO ASC-ODD-UNIT (ASC-BLK-SUB ASC-ITEM-SUB)           36435012
364351         END-IF                                                   36435112
364352     ELSE                                                         36435212
364353        MOVE DISTDT-PREPK-ODD-UNT-QTY                             36435312
364354          TO ASC-ODD-UNIT (ASC-BLK-SUB ASC-ITEM-SUB)              36435412
364355     END-IF.                                                      36435512
364356                                                                  36435612
364357     SET ASC-SEL-ZERO-NO (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE.      36435712
364358                                                                  36435812
364359 4306A-LINE-STATUS.                                               36435905
364360                                                                  36436005
364370     EVALUATE TRUE                                                36437005
364400     WHEN RECITM-STATUS-CDE = 'VE'                                36440005
364500         MOVE 'VERIFIED'              TO ASC-LINE-STATUS          36450005
364600         SET ASC-PROTECT-ALL-STORES   TO TRUE                     36460005
364700     WHEN DISTHD-PRCG-STAT-CDE = 'P' OR 'V'                       36470005
364800         MOVE 'PRV VRFYD'             TO ASC-LINE-STATUS          36480005
364900         SET ASC-PROTECT-ALL-STORES   TO TRUE                     36490005
365000     WHEN DISTHD-PRCG-STAT-CDE = 'D'                              36500005
365100         IF  DISTHD-P2L-CART-CNT = ZEROES                         36510005
365200             MOVE 'FCSE RDY'          TO ASC-LINE-STATUS          36520005
365300         ELSE                                                     36530005
365400             MOVE 'DOWNLOAD '             TO ASC-LINE-STATUS      36540005
365500         END-IF                                                   36550005
365600     WHEN DISTHD-PRCG-STAT-CDE = 'B'                              36560005
365700         IF DISTHD-FCSE-CNFRMN-TMST = PC-DEFAULT-TMST             36570005
365800             MOVE 'CNFM NEED'         TO ASC-LINE-STATUS          36580005
365900         ELSE                                                     36590005
366000             IF DISTHD-RSLTS-RCVD-TMST = PC-DEFAULT-TMST          36600005
366100                 MOVE 'P2L NEED '     TO ASC-LINE-STATUS          36610005
366200             END-IF                                               36620005
366300         END-IF                                                   36630005
366400                                                                  36640005
366500*** BAD RATIO (PREPK M & I ORDER)                                 36650005
366600     WHEN DISTHD-PRCG-STAT-CDE = 'A'                              36660005
366700         MOVE 'BAD RAT  '             TO ASC-LINE-STATUS          36670005
366800*** NOT ARRIVED                                                   36680005
366900     WHEN DISTHD-PRCG-STAT-CDE = 'G'                              36690005
367000         MOVE 'NOT ARR  '             TO ASC-LINE-STATUS          36700005
367100     WHEN OTHER                                                   36710005
367200         IF PV-TROUBLE-COUNT > ZERO                               36720005
367300             PERFORM 4306A1-YES-TROUBLE                           36730005
367400         ELSE                                                     36740005
367500             PERFORM 4306A2-NO-TROUBLE                            36750005
367600         END-IF                                                   36760005
367700     END-EVALUATE.                                                36770005
367800                                                                  36780005
367900     IF ASC-LINE-STATUS = SPACES                                  36790005
368000         MOVE 'READY    '             TO ASC-LINE-STATUS          36800005
368100     END-IF.                                                      36810005
368200                                                                  36820005
368300 4306A1-YES-TROUBLE.                                              36830005
368400                                                                  36840005
368500     MOVE 'TRBL'               TO ASC-LINE-STATUS                 36850005
368600                                                                  36860005
368700     EVALUATE DISTHD-PRCG-STAT-CDE                                36870005
368800         WHEN 'E'                                                 36880005
368900         WHEN 'I'                                                 36890005
369000             PERFORM 4306B-DISTDT-VS-TRECDIS                      36900005
369100             IF PS-MATCH-ERROR                                    36910005
369200                 OR PT-STORE-DOING-INVENTORY(DISTDT-STR-NBR)      36920005
369300                     MOVE 'MULT ISSE' TO ASC-LINE-STATUS          36930005
369400             END-IF                                               36940005
369500                                                                  36950005
369600         WHEN 'F'                                                 36960005
369700             IF PV-FREIGHT-COUNT > ZERO                           36970005
369800                 MOVE 'MULT ISSE'     TO ASC-LINE-STATUS          36980005
369900             END-IF                                               36990005
370000     END-EVALUATE.                                                37000005
370100                                                                  37010005
370200 4306A2-NO-TROUBLE.                                               37020005
370300                                                                  37030005
370400     PERFORM 4306B-DISTDT-VS-TRECDIS                              37040005
370500     EVALUATE DISTHD-PRCG-STAT-CDE                                37050005
370600         WHEN 'E'                                                 37060005
370700         WHEN 'I'                                                 37070005
370800             EVALUATE TRUE                                        37080005
370900                 WHEN PS-MATCH-ERROR                              37090005
371000                     AND PT-STORE-DOING-INVENTORY(DISTDT-STR-NBR) 37100005
371100                         MOVE 'MULT ISSE'                         37110005
371200                                      TO ASC-LINE-STATUS          37120005
371300                                                                  37130005
371400                 WHEN PT-STORE-DOING-INVENTORY (DISTDT-STR-NBR)   37140005
371500                     MOVE 'PHYINV   ' TO ASC-LINE-STATUS          37150005
371600                                                                  37160005
371700                 WHEN PS-MATCH-ERROR                              37170005
371800                     MOVE 'MISS STRS' TO ASC-LINE-STATUS          37180005
371900             END-EVALUATE                                         37190005
372000         WHEN 'F'                                                 37200005
372100             PERFORM 7550-FREIGHT-BILL                            37210005
372200                 MOVE 'NO PRO # '     TO ASC-LINE-STATUS          37220005
372300     END-EVALUATE.                                                37230005
372400                                                                  37240005
372500 4306B-DISTDT-VS-TRECDIS.                                         37250005
372600     PERFORM 7410-OPEN-TDISTDT-CSR                                37260005
372700     PERFORM 7411-FETCH-TDISTDT-CSR                               37270005
372800     PERFORM UNTIL PS-EOF-TDISTDT-CSR OR PS-MATCH-ERROR           37280005
372900         PERFORM 7415-SELECT-TRECDIS                              37290005
373000         IF PV-STORE-COUNT = ZERO                                 37300005
373100             SET PS-MATCH-ERROR       TO TRUE                     37310005
373200         ELSE                                                     37320005
373300             PERFORM 7411-FETCH-TDISTDT-CSR                       37330005
373400         END-IF                                                   37340005
373500     END-PERFORM                                                  37350005
373600                                                                  37360005
373700     PERFORM 7412-CLOSE-TDISTDT-CSR.                              37370005
373800                                                                  37380005
373900 4310-FETCH.                                                      37390005
374000                                                                  37400005
374100     EXEC SQL                                                     37410005
374200         FETCH STORE-CSR                                          37420005
374300          INTO                                                    37430005
374400                 :DISTDT-STR-NBR                                  37440005
374500               , :DISTDT-EXPTED-ALLOC-QTY                         37450005
374600               , :DISTDT-FCSE-ACTL-UNT-QTY                        37460005
374700               , :DISTDT-ACTL-ALLOC-QTY                           37470005
374800               , :DISTDT-P2L-SPLT-UNT-QTY                         37480005
374900               , :DISTDT-PREPK-ODD-UNT-QTY                        37490005
375000               , :DISTDT-FCSE-SPLT-UNT-QTY                        37500005
375100               , :DISTDT-INPK-SPLT-UNT-QTY                        37510005
375200     END-EXEC.                                                    37520005
375300                                                                  37530005
375400     EVALUATE TRUE                                                37540005
375500         WHEN SQLCODE = ZERO                                      37550005
375600              CONTINUE                                            37560005
375700         WHEN SQLCODE = +100                                      37570005
375800              SET ASC-NO-ITEMS-LEFT-ON-DB                         37580005
375900                                   TO TRUE                        37590005
376000         WHEN SQLCODE = -904                                      37600005
376100         WHEN SQLCODE = -911                                      37610005
376200         WHEN SQLCODE = -913                                      37620005
376300             PERFORM 9900-SOFT-ABORT                              37630005
376400                                                                  37640005
376500         WHEN SQLWARN0 NOT = SPACE                                37650005
376600         WHEN SQLCODE < ZERO                                      37660005
376700         WHEN SQLCODE > ZERO                                      37670005
376800              MOVE '4310-FETCH'       TO DP013-PARAGRAPH          37680005
376900              MOVE 'FETCH STORE CURSOR'                           37690005
377000                                      TO DP013-MESSAGE-TEXT (1)   37700005
377100              MOVE SQLCA              TO DP013-SQLCA              37710005
377200              MOVE 'TDISTDT'          TO DP013-DB2-TABLE-NAME (1) 37720005
377300              SET DP013-DB2-ABEND     TO TRUE                     37730005
377400              PERFORM DP013-0000-PROCESS-ABEND                    37740005
377500     END-EVALUATE.                                                37750005
377600/                                                                 37760005
377700 4320-SELECT-ODD-UNIT.                                            37770005
377800     EXEC SQL                                                     37780005
377900         SELECT SUM (B.PREPK_ODD_UNT_QTY)                         37790005
378000           INTO :PV-PREPK-ODD-UNT-QTY                             37800005
378100           FROM TRECITM   A                                       37810005
378200               ,TDISTDT   B                                       37820005
378300          WHERE A.ORD_NBR      =  :DK-ORD-NBR                     37830005
378400            AND A.REC_SEQ_NBR  =  :DK-RCVR-NBR                    37840005
378500            AND A.PREPK_ID     =  :PV-PREPK-ID                    37850005
378600            AND B.STR_NBR      =  :PV-STR-NBR                     37860005
378700            AND A.VER_STATUS_CDE = 'A'                            37870005
378800            AND B.ORD_NBR      =  A.ORD_NBR                       37880005
378900            AND B.RCVR_SEQ_NBR =  A.REC_SEQ_NBR                   37890005
379000            AND B.ORD_LNE_NBR  =  A.ORD_LNE_NBR                   37900005
379100            AND B.ORD_LNE_NBR  =  :ASC-LINE-NBR                   37910005
379200     END-EXEC                                                     37920005
379300                                                                  37930005
379400     EVALUATE TRUE                                                37940005
379500         WHEN SQLCODE = +0                                        37950005
379600              CONTINUE                                            37960005
379700         WHEN SQLCODE = -305                                      37970005
379800              MOVE 0 TO PV-PREPK-ODD-UNT-QTY                      37980005
379900         WHEN OTHER                                               37990005
380000              MOVE '4320-SELECT-ODD-UNIT'                         38000005
380100                               TO DP013-PARAGRAPH                 38010005
380200              MOVE 'SUM ODD UNIT QUANITY     '                    38020005
380300                               TO DP013-MESSAGE-TEXT (1)          38030005
380400              MOVE SQLCA       TO DP013-SQLCA                     38040005
380500              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)        38050005
380600              MOVE 'TDISTDT '  TO DP013-DB2-TABLE-NAME (2)        38060005
380700              SET DP013-DB2-ABEND                                 38070005
380800                  DP013-XCTL-DISPLAY-RESTART                      38080005
380900                                   TO TRUE                        38090005
381000                  PERFORM DP013-0000-PROCESS-ABEND                38100005
381100     END-EVALUATE.                                                38110005
381200                                                                  38120005
381300 4330-SELECT-ODD-UNIT.                                            38130005
381400     EXEC SQL                                                     38140005
381500         SELECT SUM (B.PREPK_ODD_UNT_QTY)                         38150005
381600           INTO :PV-PREPK-ODD-UNT-QTY                             38160005
381700           FROM TRECITM   A                                       38170005
381800               ,TDISTDT   B                                       38180005
381900          WHERE A.ORD_NBR      =  :DK-ORD-NBR                     38190005
382000            AND A.REC_SEQ_NBR  =  :DK-RCVR-NBR                    38200005
382100            AND A.PREPK_ID     =  :PV-PREPK-ID                    38210005
382200            AND B.STR_NBR      =  :PV-STR-NBR                     38220005
382300            AND A.VER_STATUS_CDE = 'A'                            38230005
382400            AND B.ORD_NBR      =  A.ORD_NBR                       38240005
382500            AND B.RCVR_SEQ_NBR =  A.REC_SEQ_NBR                   38250005
382600            AND B.ORD_LNE_NBR  =  A.ORD_LNE_NBR                   38260005
382700     END-EXEC                                                     38270005
382800                                                                  38280005
382900     EVALUATE TRUE                                                38290005
383000         WHEN SQLCODE = +0                                        38300005
383100              CONTINUE                                            38310005
383200         WHEN SQLCODE = -305                                      38320005
383300              MOVE 0 TO PV-PREPK-ODD-UNT-QTY                      38330005
383400         WHEN OTHER                                               38340005
383500              MOVE '4330-SELECT-ODD-UNIT'                         38350005
383600                               TO DP013-PARAGRAPH                 38360005
383700              MOVE 'SUM ODD UNIT QUANITY     '                    38370005
383800                               TO DP013-MESSAGE-TEXT (1)          38380005
383900              MOVE SQLCA       TO DP013-SQLCA                     38390005
384000              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)        38400005
384100              MOVE 'TDISTDT '  TO DP013-DB2-TABLE-NAME (2)        38410005
384200              SET DP013-DB2-ABEND                                 38420005
384300                  DP013-XCTL-DISPLAY-RESTART                      38430005
384400                                   TO TRUE                        38440005
384500                  PERFORM DP013-0000-PROCESS-ABEND                38450005
384600     END-EVALUATE.                                                38460005
384700                                                                  38470005
384800                                                                  38480005
384900                                                                  38490005
385000 4350-CALL-RCKUT128.                                              38500005
385100     MOVE ASC-OPER-UNT-ID     TO RC074-OPER-UNT-ID.               38510005
385200     MOVE ASC-FCLTY-ID        TO RC074-FCLTY-ID.                  38520005
385300     MOVE ASC-ORD-NBR         TO RC074-PO-NBR.                    38530005
385400     MOVE ASC-RCVR-NBR        TO RC074-RCVR-SEQ-NBR.              38540005
385500     MOVE ASC-AUTO-VE-SW      TO RC074-AUTO-VE-SW.                38550005
385600                                                                  38560005
385700     CALL RC074-UNIT-CRTN-CNT-PGM USING  DFHEIBLK                 38570005
385800                                         RC074-COMMAREA           38580005
385900                                         RC074-FIELDS.            38590005
386000                                                                  38600005
386100     EVALUATE TRUE                                                38610005
386200         WHEN RC074-SUCCESSFUL                                    38620005
386300             CONTINUE                                             38630005
386400         WHEN OTHER                                               38640005
386500             MOVE '4350-CALL-RCKUT128'                            38650005
386600                                 TO DP013-PARAGRAPH               38660005
386700             STRING                                               38670005
386800                  'UNSUCCESSFUL CALL TO RCKUT128 '                38680005
386900                  'SUCCESS-IND = '                                38690005
387000                  RC074-SUCCESS-IND                               38700005
387100                               DELIMITED BY SIZE                  38710005
387200                               INTO DP013-MESSAGE-TEXT (1)        38720005
387300             MOVE RC074-CRA-RET-MSG                               38730005
387400                                 TO DP013-MESSAGE-TEXT (2)        38740005
387500             MOVE RC074-SQLCA    TO DP013-SQLCA                   38750005
387600             SET DP013-DB2-ABEND                                  38760005
387700                 DP013-XCTL-DISPLAY-RESTART                       38770005
387800                                 TO TRUE                          38780005
387900             PERFORM DP013-0000-PROCESS-ABEND                     38790005
388000     END-EVALUATE.                                                38800005
388100                                                                  38810005
388200                                                                  38820005
388300 4370-SUM-PACKS.                                                  38830005
388400                                                                  38840005
388500     MOVE 0            TO PV-SUM-OF-PACKS.                        38850005
388600                                                                  38860005
388700     EXEC SQL                                                     38870005
388800         SELECT SUM(SHPD_PK_QTY)                                  38880005
388900           INTO :PV-SUM-OF-PACKS                                  38890005
389000           FROM SUT_OTBND_PK                                      38900005
389100          WHERE TRN_NBR        =  :DK-ORD-NBR                     38910005
389200            AND RCVR_SEQ_NBR   =  :DK-RCVR-NBR                    38920005
389300            AND PK_SKU_NBR     =  :DK-PK-SKU-NBR                  38930005
389400     END-EXEC                                                     38940005
389500                                                                  38950005
389600     EVALUATE TRUE                                                38960005
389700         WHEN SQLCODE = +0                                        38970005
389800         WHEN SQLCODE = -305                                      38980005
389900         WHEN SQLCODE = +100                                      38990005
390000             CONTINUE                                             39000005
390100         WHEN SQLCODE = -904                                      39010005
390200         WHEN SQLCODE = -911                                      39020005
390300         WHEN SQLCODE = -913                                      39030005
390400             PERFORM 9900-SOFT-ABORT                              39040005
390500                                                                  39050005
390600         WHEN SQLWARN0 NOT = SPACES                               39060005
390700         WHEN SQLCODE < ZERO                                      39070005
390800         WHEN SQLCODE > ZERO                                      39080005
390900             MOVE DK-ORD-NBR       TO PV-DISPLAY-PO               39090005
391000             MOVE DK-RCVR-NBR      TO PV-DISPLAY-RECV             39100005
391100             MOVE DK-PK-SKU-NBR    TO PV-DISPLAY-SKU              39110005
391200             MOVE '4370-SUM-PACKS'                                39120005
391300                               TO DP013-PARAGRAPH                 39130005
391400             MOVE 'SUM PACKS FOR THE PO RECEIVER'                 39140005
391500                               TO DP013-MESSAGE-TEXT (1)          39150005
391600             STRING  'PO = '                                      39160005
391700                     PV-DISPLAY-PO                                39170005
391800                     ' RECVR = '                                  39180005
391900                     PV-DISPLAY-RECV                              39190005
392000                     ' PACK SKU = '                               39200005
392100                     PV-DISPLAY-SKU                               39210005
392200                                  DELIMITED BY SIZE               39220005
392300                             INTO DP013-MESSAGE-TEXT (2)          39230005
392400             MOVE SQLCA        TO DP013-SQLCA                     39240005
392500             MOVE 'SUT00041'   TO DP013-DB2-TABLE-NAME (1)        39250005
392600             SET DP013-DB2-ABEND                                  39260005
392700                 DP013-XCTL-DISPLAY-RESTART                       39270005
392800                               TO TRUE                            39280005
392900             PERFORM DP013-0000-PROCESS-ABEND                     39290005
393000     END-EVALUATE.                                                39300005
393100                                                                  39310005
393200 4400-MOVE-COMMAREA-TO-SCREEN.                                    39320005
393300                                                                  39330005
393400     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             39340005
393500         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          39350005
393600         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          39360005
393700             MOVE +1               TO ASC-BLK-SUB                 39370005
393800                                                                  39380005
393900             PERFORM 5100-WRITE-TEMP-STORAGE                      39390005
394000                                                                  39400005
394100             ADD +1                TO ASC-BLK-SUB                 39410005
394200             PERFORM 5100-WRITE-TEMP-STORAGE                      39420005
394300                                                                  39430005
394400             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             39440005
394500                 GIVING PV-BLOCK-NUMBER                           39450005
394600                 REMAINDER PV-REMAINDER                           39460005
394700             IF  PV-REMAINDER > ZERO                              39470005
394800                 ADD +1            TO PV-BLOCK-NUMBER             39480005
394900             END-IF                                               39490005
395000                                                                  39500005
395100             MOVE +1               TO ASC-BLK-SUB                 39510005
395200             PERFORM 4410-READ-TEMP-STORAGE                       39520005
395300                                                                  39530005
395400             ADD +1                TO ASC-BLK-SUB                 39540005
395500                                      PV-BLOCK-NUMBER             39550005
395600             PERFORM 4410-READ-TEMP-STORAGE                       39560005
395700     END-IF.                                                      39570005
395800                                                                  39580005
395900     MOVE +1                       TO ASC-BLK-SUB.                39590005
396000                                                                  39600005
396100     COMPUTE ASC-ITEM-SUB =                                       39610005
396200         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              39620005
396300         + PC-ITEMS-PER-PANEL).                                   39630005
396400                                                                  39640005
396500     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        39650005
396600         ADD +1                    TO ASC-BLK-SUB                 39660005
396700         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            39670005
396800     END-IF.                                                      39680005
396900                                                                  39690005
397000     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           39700005
397100         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                39710005
397200                                                                  39720005
397300     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        39730005
397400                                                                  39740005
397500     PERFORM 4420-FORMAT-LIST-LINES                               39750005
397600         VARYING PV-SUB                                           39760005
397700         FROM PC-ITEMS-PER-PANEL BY -1                            39770005
397800         UNTIL PV-SUB < +1.                                       39780005
397900                                                                  39790005
398000     COMPUTE ASC-ITEMS-DISPLAYED =                                39800005
398100         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          39810005
398200                                                                  39820005
398300     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    39830005
398400                                      ASTRTITO.                   39840005
398500                                                                  39850005
398600     IF (ASC-DISPLAY-FORMAT = '1')                                39860005
398700         IF (ASC-PKGNG-CDE = 'I' OR 'M')                          39870005
398800             MOVE 'PACK ID....:'       TO APKHDG1O                39880005
398900             MOVE 'PACK STATUS:'       TO APKHDG2O                39890005
399000             MOVE 'RATIO..:'           TO APKHDG3O                39900005
399100             MOVE 'EXP PAK/CRT:'       TO APKHDG4O                39910005
399200             MOVE 'CUR PAK/CRT:'       TO APKHDG5O                39920005
399300             MOVE 'P2L PAK:'           TO APKHDG6O                39930005
399400             MOVE 'FCSE'               TO APKHD0O                 39940005
399500             MOVE 'ODD'                TO APKHD1O                 39950005
399600             MOVE 'PAK '               TO APKHD2O                 39960005
399700             MOVE ' PAK'               TO APKHD3O                 39970005
399800             MOVE 'PAK'                TO APKHD4O                 39980005
399900             MOVE 'PAK'                TO APKHD5O                 39990005
400000             MOVE 'UNT'                TO APKHD6O                 40000005
400100         ELSE                                                     40010005
400200             MOVE 'DPT/CL/SKU.:'       TO APKHDG1O                40020005
400300             MOVE 'LINE STATUS:'       TO APKHDG2O                40030005
400400             MOVE 'INPAK..:'           TO APKHDG3O                40040005
400500             MOVE 'EXP QTY/CRT:'       TO APKHDG4O                40050005
400600             MOVE 'CUR QTY/CRT:'       TO APKHDG5O                40060005
400700             MOVE 'P2L QTY:'           TO APKHDG6O                40070005
400800             MOVE 'FCSE'               TO APKHD0O                 40080005
400900             MOVE '   '                TO APKHD1O                 40090005
401000             MOVE 'QTY '               TO APKHD2O                 40100005
401100             MOVE ' QTY'               TO APKHD3O                 40110005
401200             MOVE 'QTY'                TO APKHD4O                 40120005
401300             MOVE 'QTY'                TO APKHD5O                 40130005
401400             MOVE '   '                TO APKHD6O                 40140005
401500         END-IF                                                   40150005
401600     END-IF.                                                      40160005
401700     IF (ASC-DISPLAY-FORMAT = '2')                                40170005
401800         MOVE 'DPT/CL/SKU.:'       TO APKHDG1O                    40180005
401900         MOVE 'LINE STATUS:'       TO APKHDG2O                    40190005
402000         MOVE 'INPAK..:'           TO APKHDG3O                    40200005
402100         MOVE 'EXP QTY/CRT:'       TO APKHDG4O                    40210005
402200         MOVE 'CUR QTY/CRT:'       TO APKHDG5O                    40220005
402300         MOVE 'P2L QTY:'           TO APKHDG6O                    40230005
402400         MOVE 'FCSE'               TO APKHD0O                     40240005
402500         MOVE '   '                TO APKHD1O                     40250005
402600         MOVE 'QTY '               TO APKHD2O                     40260005
402700         MOVE ' QTY'               TO APKHD3O                     40270005
402800         MOVE 'QTY'                TO APKHD4O                     40280005
402900         MOVE 'QTY'                TO APKHD5O                     40290005
403000         MOVE '   '                TO APKHD6O                     40300005
403100     END-IF.                                                      40310005
403200     IF (ASC-DISPLAY-FORMAT = '3')                                40320005
403300         MOVE 'DPT/CL/SKU.:'       TO APKHDG1O                    40330005
403400         MOVE 'LINE STATUS:'       TO APKHDG2O                    40340005
403500         MOVE 'INPAK..:'           TO APKHDG3O                    40350005
403600         MOVE 'EXP QTY/CRT:'       TO APKHDG4O                    40360005
403700         MOVE 'CUR QTY/CRT:'       TO APKHDG5O                    40370005
403800         MOVE 'P2L QTY:'           TO APKHDG6O                    40380005
403900         MOVE 'ODD '               TO APKHD0O                     40390005
404000         MOVE 'ODD'                TO APKHD1O                     40400005
404100         MOVE 'QTY '               TO APKHD2O                     40410005
404200         MOVE ' QTY'               TO APKHD3O                     40420005
404300         MOVE 'QTY'                TO APKHD4O                     40430005
404400         MOVE 'QTY'                TO APKHD5O                     40440005
404500         MOVE 'UNT'                TO APKHD6O                     40450005
404600     END-IF.                                                      40460005
404700                                                                  40470005
404800* HEADING FIELDS                                                  40480005
404900     MOVE ASC-RCVR-OPER-UNT-ID        TO MR-OPER.                 40490005
405000     MOVE ASC-FCLTY-ID                TO MR-FCLTY.                40500005
405100     MOVE ASC-ORD-NBR                 TO MR-PO.                   40510005
405200     MOVE ASC-RCVR-NBR                TO MR-RCVR.                 40520005
405300     MOVE ASC-PKGNG-CDE-DISPLAY       TO MR-PKCD.                 40530005
405400     MOVE ASC-LINE-NBR                TO MR-PO-LINE.              40540005
405500***  IF ASC-DISPLAY-FORMAT = '3'                                  40550005
405600***      CONTINUE                                                 40560005
405700***  ELSE                                                         40570005
405800***      IF ASC-PKGNG-CDE = 'I' OR 'M'                            40580005
405900***          MOVE DP015-ASK-DRK-OFF   TO MR-PO-LINE-A             40590005
406000***      END-IF                                                   40600005
406100***  END-IF.                                                      40610005
406200     MOVE ASC-SKU                     TO MR-SKU.                  40620005
406300     MOVE ASC-CONF-DATE               TO MR-CONF-DATE.            40630005
406400     MOVE ASC-CONF-TIME               TO MR-CONF-TIME.            40640005
406500     MOVE ASC-OUT-PACK-QTY            TO MR-OUT-PACK-QTY.         40650005
406600     MOVE ASC-LINE-STATUS             TO MR-LINE-STATUS.          40660005
406700     MOVE ASC-USER-ID                 TO MR-USER-ID.              40670005
406800     MOVE ASC-P2L-STATUS              TO MR-P2L-STATUS.           40680005
406900     MOVE ASC-CNVYB                   TO MR-CNVYB.                40690005
407000     MOVE ASC-INPAK-QTY               TO MR-INPAK-QTY.            40700005
407100     MOVE ASC-EXP-LINE-QTY            TO MR-EXP-QTY.              40710005
407200     MOVE ASC-EXP-CART-QTY            TO MR-EXP-CART.             40720005
407300     MOVE ASC-CUR-LINE-QTY            TO MR-CURRENT-QTY.          40730005
407310     IF ASC-AUTO-VE-YES                                           40731026
407400         MOVE ASC-CUR-CART-QTY        TO MR-CURRENT-CRT           40740026
407401     ELSE                                                         40740126
407410         MOVE SPACES                  TO MR-CURRENT-CRT-X         40741026
407420     END-IF.                                                      40742026
407500     MOVE ASC-P2L-QTY-LINE            TO MR-P2L-QTY-LINE.         40750005
407600                                                                  40760005
407700     IF ASC-DISPLAY-FORMAT = '3'                                  40770005
407800             MOVE DP015-YELLOW        TO MR-PKCDC                 40780005
407900     ELSE                                                         40790005
408000         IF ASC-PKGNG-CDE = 'I' OR 'M'                            40800005
408100             MOVE DP015-YELLOW        TO MR-PKCDC                 40810005
408200                                         MR-SKUC                  40820005
408300                                         MR-EXP-QTYC              40830005
408400                                         MR-EXP-CARTC             40840005
408500                                         MR-CURRENT-QTYC          40850005
408600                                         MR-CURRENT-CRTC          40860005
408700                                         MR-P2L-QTY-LINEC         40870005
408800         END-IF                                                   40880005
408900     END-IF.                                                      40890005
409000                                                                  40900005
409100                                                                  40910005
409200     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    40920005
409300     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    40930005
409400     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            40940005
409500                                   TO ASELITO.                    40950005
409600                                                                  40960005
409700     IF  DP020-MSG-NUMBER-X = SPACE                               40970005
409800         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  40980005
409900*            --- MORE ITEMS TO DISPLAY ----                       40990005
410000             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            41000005
410100             SET DP020-MSG-INFORMATIONAL                          41010005
410200                                   TO TRUE                        41020005
410300         END-IF                                                   41030005
410400     END-IF.                                                      41040005
410500                                                                  41050005
410600*----------------------------------------------------------------*41060005
410700*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *41070005
410800*----------------------------------------------------------------*41080005
410900                                                                  41090005
411000 4410-READ-TEMP-STORAGE.                                          41100005
411100                                                                  41110005
411200     EXEC CICS                                                    41120005
411300         READQ TS                                                 41130005
411400             QUEUE (ASC-LIST-QUEUE-NAME)                          41140005
411500             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               41150005
411600             ITEM  (PV-BLOCK-NUMBER)                              41160005
411700             RESP  (PV-CICS-RESP)                                 41170005
411800     END-EXEC.                                                    41180005
411900                                                                  41190005
412000     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       41200005
412100       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     41210005
412200         CONTINUE                                                 41220005
412300     ELSE                                                         41230005
412400         SET DP013-CICS-ABEND      TO TRUE                        41240005
412500         SET DP013-NO-ROLLBACK     TO TRUE                        41250005
412600         MOVE '4410-READ-TEMP-STORAGE'                            41260005
412700                                   TO DP013-PARAGRAPH             41270005
412800         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      41280005
412900                                   TO DP013-MESSAGE-TEXT(1)       41290005
413000         PERFORM DP013-0000-PROCESS-ABEND                         41300005
413100     END-IF.                                                      41310005
413200                                                                  41320005
413300     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)                      41330005
413400                                   TO TRUE.                       41340005
413500                                                                  41350005
413600     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         41360005
413700         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               41370005
413800     END-IF.                                                      41380005
413900                                                                  41390005
414000*----------------------------------------------------------------*41400005
414100*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *41410005
414200*----------------------------------------------------------------*41420005
414300 4420-FORMAT-LIST-LINES.                                          41430005
414400                                                                  41440005
414500     IF ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ       41450005
414600         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                41460005
414700         IF ASC-STORE-NBR (ASC-BLK-SUB ASC-ITEM-SUB) = 0 OR SPACE 41470005
414800             MOVE DP015-ASK-DRK-OFF TO MR-SELECTA (PV-SUB)        41480005
414900                                       MR-ACTIONA (PV-SUB)        41490005
415000                                       MR-U-PROCESS-QTYA (PV-SUB) 41500005
415100             MOVE DP015-HL-OFF      TO MR-SELECTH (PV-SUB)        41510005
415200                                       MR-U-PROCESS-QTYH (PV-SUB) 41520005
415300             MOVE SPACE             TO MR-SELECT  (PV-SUB)        41530005
415400                                       MR-ACTION  (PV-SUB)        41540005
415500                                       MR-U-PROCESS-QTY-X (PV-SUB)41550005
415600                                       MR-STORE-X (PV-SUB)        41560005
415700                                       MR-EXP-STR-QTY-X (PV-SUB)  41570005
415800                                       MR-CUR-STR-QTY-X (PV-SUB)  41580005
415900                                       MR-EXP-CRT-COUNT-X (PV-SUB)41590005
416000                                       MR-CUR-CRT-COUNT-X (PV-SUB)41600005
416100                                       MR-P2L-QTY-X   (PV-SUB)    41610005
416200                                       MR-ODD-UNIT-X  (PV-SUB)    41620005
416300         END-IF                                                   41630005
416400     ELSE                                                         41640005
416500         IF ASC-TEMP-SELECTED-SW(ASC-BLK-SUB ASC-ITEM-SUB) > SPACE41650005
416600             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 41660005
416700               TO MR-SELECT (PV-SUB)                              41670005
416800         ELSE                                                     41680005
416900             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      41690005
417000               TO MR-SELECT (PV-SUB)                              41700005
417100         END-IF                                                   41710005
417200                                                                  41720005
417300         IF DP030-SET-CURSOR-TRAILER                              41730005
417400             IF ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 41740005
417500                 > SPACE)                                         41750005
417600               OR (PV-SUB = 1))                                   41760005
417700                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              41770005
417800                 MOVE -1 TO MR-SELECTL (PV-SUB)                   41780005
417900             END-IF                                               41790005
418000         END-IF                                                   41800005
418100                                                                  41810005
418200         MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)               41820005
418300           TO MR-ACTION (PV-SUB)                                  41830005
418400         MOVE ASC-STORE-NBR (ASC-BLK-SUB ASC-ITEM-SUB)            41840005
418500           TO MR-STORE  (PV-SUB)                                  41850005
418600*12/11       MOVE ASC-U-PROCESS-QTY   (ASC-BLK-SUB ASC-ITEM-SUB)  41860005
418700*12/11                             TO MR-U-PROCESS-QTY (PV-SUB)   41870005
418800         IF (ASC-U-PROCESS-QTY-X (ASC-BLK-SUB ASC-ITEM-SUB)       41880005
418900                                   = SPACES)                      41890005
419000           OR (MR-SELECT (PV-SUB) = SPACES)                       41900005
419100             MOVE SPACES TO MR-U-PROCESS-QTY-X (PV-SUB)           41910005
419200         ELSE                                                     41920005
419300             MOVE ASC-U-PROCESS-QTY (ASC-BLK-SUB ASC-ITEM-SUB)    41930005
419400                  TO MR-U-PROCESS-QTY (PV-SUB)                    41940005
419500         END-IF                                                   41950005
419600         IF ASC-SEL-ZERO-YES (ASC-BLK-SUB ASC-ITEM-SUB)           41960005
419700             MOVE ASC-U-PROCESS-QTY (ASC-BLK-SUB ASC-ITEM-SUB)    41970005
419800               TO PV-DISPLAY-ZERO                                 41980005
419900             MOVE PV-DISPLAY-ZERO  TO MR-U-PROCESS-QTY-X (PV-SUB) 41990005
420000             MOVE DP015-UNP-ALP-NOR-MDT                           42000005
420100                                   TO MR-U-PROCESS-QTYA (PV-SUB)  42010005
420200***      ELSE                                                     42020005
420300***          MOVE ASC-U-PROCESS-QTY (ASC-BLK-SUB ASC-ITEM-SUB)    42030005
420400***            TO PV-DISPLAY-NO-ZERO                              42040005
420500***          MOVE PV-DISPLAY-NO-ZERO                              42050005
420600***                                TO MR-U-PROCESS-QTY-X (PV-SUB) 42060005
420700         END-IF                                                   42070005
420800                                                                  42080005
420900         MOVE ASC-EXP-STR-QTY (ASC-BLK-SUB ASC-ITEM-SUB)          42090005
421000           TO MR-EXP-STR-QTY (PV-SUB)                             42100005
421100         MOVE ASC-CUR-STR-QTY (ASC-BLK-SUB ASC-ITEM-SUB)          42110005
421200           TO MR-CUR-STR-QTY (PV-SUB)                             42120005
421300         IF (ASC-DISPLAY-FORMAT NOT = '3')                        42130005
421400           AND (ASC-PKGNG-CDE = 'I' OR 'M')                       42140005
421500             MOVE DP015-YELLOW TO MR-EXP-STR-QTYC (PV-SUB)        42150005
421600             MOVE DP015-YELLOW TO MR-CUR-STR-QTYC (PV-SUB)        42160005
421700         END-IF                                                   42170005
421800                                                                  42180005
421900         MOVE ASC-EXP-STR-CRT (ASC-BLK-SUB ASC-ITEM-SUB)          42190005
422000           TO MR-EXP-CRT-COUNT (PV-SUB)                           42200005
422010         IF ASC-AUTO-VE-YES                                       42201024
422100             MOVE ASC-CUR-STR-CRT (ASC-BLK-SUB ASC-ITEM-SUB)      42210024
422200               TO MR-CUR-CRT-COUNT (PV-SUB)                       42220024
422210         ELSE                                                     42221024
422220             MOVE SPACES TO MR-CUR-CRT-COUNT-X (PV-SUB)           42222024
422230         END-IF                                                   42223024
422300                                                                  42230005
422400         MOVE ASC-P2L-QTY (ASC-BLK-SUB ASC-ITEM-SUB)              42240005
422500           TO MR-P2L-QTY (PV-SUB)                                 42250005
422600         IF (ASC-DISPLAY-FORMAT NOT = '3')                        42260005
422700           AND (ASC-PKGNG-CDE = 'I' OR 'M')                       42270005
422800             MOVE DP015-YELLOW TO MR-P2L-QTYC (PV-SUB)            42280005
422900         END-IF                                                   42290005
423000                                                                  42300005
423100         MOVE ASC-ODD-UNIT (ASC-BLK-SUB ASC-ITEM-SUB)             42310005
423200           TO MR-ODD-UNIT (PV-SUB)                                42320005
423300                                                                  42330005
423400         EVALUATE TRUE                                            42340005
423500             WHEN ASC-LIST-FORMAT                                 42350005
423600                  IF ASC-PKGNG-CDE = 'I' OR 'M'                   42360005
423700                     CONTINUE                                     42370005
423800                  ELSE                                            42380005
423900                     MOVE DP015-ASK-DRK-OFF TO MR-ODD-UNITA       42390005
424000                                                     (PV-SUB)     42400005
424100                  END-IF                                          42410005
424200                                                                  42420005
424300             WHEN ASC-CRIT-SPEC-FORMAT                            42430005
424400                  MOVE DP015-ASK-DRK-OFF TO MR-ODD-UNITA (PV-SUB) 42440005
424500                                                                  42450005
424600             WHEN ASC-PACK-LINE-FORMAT                            42460005
424700                  MOVE DP015-YELLOW TO MR-ODD-UNITC (PV-SUB)      42470005
424800                                                                  42480005
424900         END-EVALUATE                                             42490005
425000                                                                  42500005
425100**??     IF ASC-DISPLAY-FORMAT NOT = '3' AND                      42510005
425200**??        ASC-DISPLAY-FORMAT NOT = '1'                          42520005
425300**??         MOVE DP015-ASK-DRK-OFF TO MR-ODD-UNITA (PV-SUB)      42530005
425400**??     ELSE                                                     42540005
425500**??         MOVE DP015-YELLOW      TO MR-ODD-UNITC (PV-SUB)      42550005
425600**??     END-IF                                                   42560005
425700                                                                  42570005
425800         IF ASC-PROTECT-ALL-STORES                                42580005
425900             MOVE DP015-ASK-DRK-OFF TO MR-SELECTA (PV-SUB)        42590005
426000                                       MR-ACTIONA (PV-SUB)        42600005
426100                                       MR-U-PROCESS-QTYA (PV-SUB) 42610005
426200             MOVE DP015-HL-OFF      TO MR-SELECTH (PV-SUB)        42620005
426300                                       MR-U-PROCESS-QTYH (PV-SUB) 42630005
426400             MOVE -1                TO ASTRTITL                   42640005
426500         END-IF                                                   42650005
426600     END-IF.                                                      42660005
426700                                                                  42670005
426800     SUBTRACT +1 FROM ASC-ITEM-SUB.                               42680005
426900                                                                  42690005
427000     IF  ASC-ITEM-SUB < + 1                                       42700005
427100         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                42710005
427200         MOVE +1                   TO ASC-BLK-SUB                 42720005
427300     END-IF.                                                      42730005
427400                                                                  42740005
427500*----------------------------------------------------------------*42750005
427600*  IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF    *42760005
427700*  RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,       *42770005
427800*  ISSUE A WARNING.                                              *42780005
427900*----------------------------------------------------------------*42790005
428000 4430-CHECK-FOR-BEGIN-AND-END.                                    42800005
428100                                                                  42810005
428200     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       42820005
428300         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     42830005
428400*            -- NO END-OF-RANGE SPECFIED ---                      42840005
428500             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            42850005
428600             SET DP020-MSG-WARNING TO TRUE                        42860005
428700             PERFORM 4431-POSITION-AT-WARNING                     42870005
428800         END-IF                                                   42880005
428900     ELSE                                                         42890005
429000         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     42900005
429100*            -- NO BEGINNING-OF-RANGE SPECFIED ---                42910005
429200             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            42920005
429300             SET DP020-MSG-WARNING TO TRUE                        42930005
429400             PERFORM 4431-POSITION-AT-WARNING                     42940005
429500         END-IF                                                   42950005
429600     END-IF.                                                      42960005
429700                                                                  42970005
429800*----------------------------------------------------------------*42980005
429900*  ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,   *42990005
430000*  DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE    *43000005
430100*  IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND         *43010005
430200*  POSITION THE CURSOR THERE.                                    *43020005
430300*----------------------------------------------------------------*43030005
430400 4431-POSITION-AT-WARNING.                                        43040005
430500                                                                  43050005
430600     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 43060005
430700                    - PV-TOP-ITEM + 1.                            43070005
430800                                                                  43080005
430900     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      43090005
431000         CONTINUE                                                 43100005
431100     ELSE                                                         43110005
431200         SET DP030-SET-CURSOR-APPL-1                              43120005
431300                                   TO TRUE                        43130005
431400         MOVE -1                   TO MR-SELECTL (PV-SUB)         43140005
431500         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         43150005
431600         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         43160005
431700     END-IF.                                                      43170005
431800                                                                  43180005
431900     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   43190005
432000                    - PV-TOP-ITEM + 1.                            43200005
432100                                                                  43210005
432200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      43220005
432300         CONTINUE                                                 43230005
432400     ELSE                                                         43240005
432500         SET DP030-SET-CURSOR-APPL-1                              43250005
432600                                   TO TRUE                        43260005
432700         MOVE -1                   TO MR-SELECTL (PV-SUB)         43270005
432800         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         43280005
432900         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         43290005
433000     END-IF.                                                      43300005
433100                                                                  43310005
433200*----------------------------------------------------------------*43320005
433300* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *43330005
433400* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *43340005
433500* FOR THE SELECTED ITEMS QUEUE.                                  *43350005
433600*                                                                *43360005
433700* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *43370005
433800* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *43380005
433900* THE ARRAY IS FULL.                                             *43390005
434000*----------------------------------------------------------------*43400005
434100 5000-PREPARE-SEL-QUEUE.                                          43410005
434200                                                                  43420005
434300     MOVE +1                       TO ASC-BLK-SUB.                43430005
434400     PERFORM 5100-WRITE-TEMP-STORAGE.                             43440005
434500     ADD +1                        TO ASC-BLK-SUB.                43450005
434600     PERFORM 5100-WRITE-TEMP-STORAGE.                             43460005
434700                                                                  43470005
434800     MOVE ASC-OPER-UNT-ID      TO  RC015-OPER-UNT-ID.             43480005
434900     MOVE ASC-FCLTY-ID         TO  RC015-FCLTY-ID.                43490005
435000     MOVE ASC-ORD-NBR          TO  RC015-PO-NBR.                  43500005
435100     MOVE ASC-RCVR-NBR         TO  RC015-REC-SEQ-NBR.             43510005
435200     MOVE ASC-SEL-QUEUE-NAME   TO  RC015-SEL-QUEUE-NAME.          43520005
435300     PERFORM 6010-DELETE-SEL-QUEUE.                               43530005
435400                                                                  43540005
435500     IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO                      43550005
435600         SET ASC-UPDATE-TSQ        TO TRUE                        43560005
435700     END-IF.                                                      43570005
435800                                                                  43580005
435900                                                                  43590005
436000     SET RC013-IDX                 TO 1.                          43600005
436100     MOVE ZERO                     TO RC015-NUMBER-OF-TS-ITEMS.   43610005
436200     INITIALIZE RC013-SELECTED-ITEM-ARRAY.                        43620005
436300                                                                  43630005
436400                                                                  43640005
436500     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           43650005
436600         VARYING PV-ITEM  FROM 1 BY 1                             43660005
436700         UNTIL   PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN              43670005
436800                                                                  43680005
436900                                                                  43690005
437000                                                                  43700005
437100     IF  RC013-IDX > 1                                            43710005
437200         PERFORM 5205-WRITE-SEL-QUEUE                             43720005
437300         ADD +1                    TO RC015-NUMBER-OF-TS-ITEMS    43730005
437400     END-IF.                                                      43740005
437500                                                                  43750005
437600*----------------------------------------------------------------*43760005
437700*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *43770005
437800*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *43780005
437900*----------------------------------------------------------------*43790005
438000 5100-WRITE-TEMP-STORAGE.                                         43800005
438100                                                                  43810005
438200     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     43820005
438300                                   TO PV-LIST-ITEM-NUMBER.        43830005
438400     COMPUTE PV-BLOCK-NUMBER =                                    43840005
438500         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    43850005
438600                                                                  43860005
438700     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             43870005
438800     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             43880005
438900         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      43890005
439000             PERFORM 5105-REWRITE-ASC-LISTQ                       43900005
439100         END-IF                                                   43910005
439200     ELSE                                                         43920005
439300         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       43930005
439400         ASC-HIGHEST-BLOCK-WRITTEN + 1                            43940005
439500         PERFORM 5110-WRITE-ASC-LISTQ                             43950005
439600         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   43960005
439700     END-IF.                                                      43970005
439800                                                                  43980005
439900     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)                      43990005
440000                                   TO TRUE.                       44000005
440100                                                                  44010005
440200*----------------------------------------------------------------*44020005
440300*  REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-     *44030005
440400*  SPECIFIC COMMAREA.                                            *44040005
440500*----------------------------------------------------------------*44050005
440600 5105-REWRITE-ASC-LISTQ.                                          44060005
440700                                                                  44070005
440800     EXEC CICS                                                    44080005
440900         WRITEQ TS                                                44090005
441000             QUEUE (ASC-LIST-QUEUE-NAME)                          44100005
441100             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               44110005
441200             ITEM  (PV-BLOCK-NUMBER)                              44120005
441300             REWRITE                                              44130005
441400             RESP  (PV-CICS-RESP)                                 44140005
441500     END-EXEC.                                                    44150005
441600                                                                  44160005
441700     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           44170005
441800                                                                  44180005
441900*DMH     MOVE ASC-LIST-TERM-ID      TO PV-SEL-TERM-ID             44190005
442000*DMH     MOVE ASC-LIST-TASK-NUMBER  TO PV-SEL-TASK-NUMBER         44200005
442100*DMH     MOVE ASC-LIST-SEQ          TO PV-SEL-SEQ                 44210005
442200*DMH     STRING ' RCKCS298-WRI LST '  DELIMITED BY SIZE           44220005
442300*DMH            ' QUEUE TERM ID-'     DELIMITED BY SIZE           44230005
442400*DMH             PV-SEL-TERM-ID       DELIMITED BY SIZE           44240005
442500*DMH            ' QUEUE TASK-'        DELIMITED BY SIZE           44250005
442600*DMH             PV-SEL-TASK-NUMBER   DELIMITED BY SIZE           44260005
442700*DMH            ' QUEUE SEQ-'         DELIMITED BY SIZE           44270005
442800*DMH             PV-SEL-SEQ           DELIMITED BY SIZE           44280005
442900*DMH                             INTO  PV-CICS-MSG-AREA2          44290005
443000*DMH         MOVE LENGTH OF PV-CICS-MSG-AREA2                     44300005
443100*DMH           TO PV-COMMAREA-LENGTH                              44310005
443200*DMH         EXEC CICS                                            44320005
443300*DMH              WRITEQ TD                                       44330005
443400*DMH               QUEUE  ('CSSL')                                44340005
443500*DMH                FROM  (PV-CICS-MSG-AREA2)                     44350005
443600*DMH              LENGTH  (PV-COMMAREA-LENGTH)                    44360005
443700*DMH                RESP  (PV-CICS-RESP)                          44370005
443800*DMH         END-EXEC                                             44380005
443900         CONTINUE                                                 44390005
444000     ELSE                                                         44400005
444100         SET DP013-CICS-ABEND      TO TRUE                        44410005
444200         SET DP013-NO-ROLLBACK     TO TRUE                        44420005
444300         MOVE '5105-REWRITE-ASC-LISTQ'                            44430005
444400                                   TO DP013-PARAGRAPH             44440005
444500         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     44450005
444600                                   TO DP013-MESSAGE-TEXT(1)       44460005
444700         PERFORM DP013-0000-PROCESS-ABEND                         44470005
444800     END-IF.                                                      44480005
444900                                                                  44490005
445000*----------------------------------------------------------------*44500005
445100*  WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-       *44510005
445200*  SPECIFIC COMMAREA.                                            *44520005
445300*----------------------------------------------------------------*44530005
445400 5110-WRITE-ASC-LISTQ.                                            44540005
445500                                                                  44550005
445600     EXEC CICS                                                    44560005
445700         WRITEQ TS                                                44570005
445800             QUEUE (ASC-LIST-QUEUE-NAME)                          44580005
445900             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               44590005
446000             ITEM  (PV-BLOCK-NUMBER)                              44600005
446100             RESP  (PV-CICS-RESP)                                 44610005
446200     END-EXEC.                                                    44620005
446300                                                                  44630005
446400*DMH     MOVE ASC-LIST-TERM-ID      TO PV-SEL-TERM-ID             44640005
446500*DMH     MOVE ASC-LIST-TASK-NUMBER  TO PV-SEL-TASK-NUMBER         44650005
446600*DMH     MOVE ASC-LIST-SEQ          TO PV-SEL-SEQ                 44660005
446700*DMH     STRING ' RCKCS298-WRI LST '  DELIMITED BY SIZE           44670005
446800*DMH            ' QUEUE TERM ID-'     DELIMITED BY SIZE           44680005
446900*DMH             PV-SEL-TERM-ID       DELIMITED BY SIZE           44690005
447000*DMH            ' QUEUE TASK-'        DELIMITED BY SIZE           44700005
447100*DMH             PV-SEL-TASK-NUMBER   DELIMITED BY SIZE           44710005
447200*DMH            ' QUEUE SEQ-'         DELIMITED BY SIZE           44720005
447300*DMH             PV-SEL-SEQ           DELIMITED BY SIZE           44730005
447400*DMH                             INTO  PV-CICS-MSG-AREA2          44740005
447500*DMH         MOVE LENGTH OF PV-CICS-MSG-AREA2                     44750005
447600*DMH           TO PV-COMMAREA-LENGTH                              44760005
447700*DMH         EXEC CICS                                            44770005
447800*DMH              WRITEQ TD                                       44780005
447900*DMH               QUEUE  ('CSSL')                                44790005
448000*DMH                FROM  (PV-CICS-MSG-AREA2)                     44800005
448100*DMH              LENGTH  (PV-COMMAREA-LENGTH)                    44810005
448200*DMH                RESP  (PV-CICS-RESP)                          44820005
448300*DMH         END-EXEC                                             44830005
448400     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      44840005
448500         SET DP013-CICS-ABEND      TO TRUE                        44850005
448600         SET DP013-NO-ROLLBACK     TO TRUE                        44860005
448700         MOVE '5110-WRITE-ASC-LISTQ'                              44870005
448800                                   TO DP013-PARAGRAPH             44880005
448900         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           44890005
449000                                   TO DP013-MESSAGE-TEXT(1)       44900005
449100         PERFORM DP013-0000-PROCESS-ABEND                         44910005
449200     END-IF.                                                      44920005
449300                                                                  44930005
449400 5120-REWRITE-LIST-QUEUE.                                         44940005
449500     EXEC CICS                                                    44950005
449600          WRITEQ TS                                               44960005
449700              QUEUE   (ASC-SEL-QUEUE-NAME-IN)                     44970005
449800              FROM    (RC013-DC-SELECT-RECORD)                    44980005
449900              ITEM    (ASC-SEL-ITEM)                              44990005
450000              RESP    (PV-CICS-RESP)                              45000005
450100              REWRITE                                             45010005
450200     END-EXEC.                                                    45020005
450300                                                                  45030005
450400*DMH     MOVE ASC-SEL-TERM-ID-IN   TO PV-SEL-TERM-ID              45040005
450500*DMH     MOVE ASC-SEL-TASK-NUMBER-IN  TO PV-SEL-TASK-NUMBER       45050005
450600*DMH     MOVE ASC-SEL-SEQ-IN       TO PV-SEL-SEQ                  45060005
450700*DMH     STRING ' RCKCS298-WRI SEL1'  DELIMITED BY SIZE           45070005
450800*DMH            ' QUEUE TERM ID-'     DELIMITED BY SIZE           45080005
450900*DMH             PV-SEL-TERM-ID       DELIMITED BY SIZE           45090005
451000*DMH            ' QUEUE TASK-'        DELIMITED BY SIZE           45100005
451100*DMH             PV-SEL-TASK-NUMBER   DELIMITED BY SIZE           45110005
451200*DMH            ' QUEUE SEQ-'         DELIMITED BY SIZE           45120005
451300*DMH             PV-SEL-SEQ           DELIMITED BY SIZE           45130005
451400*DMH                             INTO  PV-CICS-MSG-AREA2          45140005
451500*DMH         MOVE LENGTH OF PV-CICS-MSG-AREA2                     45150005
451600*DMH           TO PV-COMMAREA-LENGTH                              45160005
451700*DMH         EXEC CICS                                            45170005
451800*DMH              WRITEQ TD                                       45180005
451900*DMH               QUEUE  ('CSSL')                                45190005
452000*DMH                FROM  (PV-CICS-MSG-AREA2)                     45200005
452100*DMH              LENGTH  (PV-COMMAREA-LENGTH)                    45210005
452200*DMH                RESP  (PV-CICS-RESP)                          45220005
452300*DMH         END-EXEC                                             45230005
452400                                                                  45240005
452500     IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                    45250005
452600         SET DP013-CICS-ABEND                                     45260005
452700             DP013-NO-ROLLBACK     TO TRUE                        45270005
452800         MOVE '5120-REWRITE-LIST-QUEUE'                           45280005
452900                                   TO DP013-PARAGRAPH             45290005
453000         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   45300005
453100                                   TO DP013-MESSAGE-TEXT (1)      45310005
453200         PERFORM DP013-0000-PROCESS-ABEND                         45320005
453300     END-IF.                                                      45330005
453400                                                                  45340005
453500*----------------------------------------------------------------*45350005
453600* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *45360005
453700* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *45370005
453800*----------------------------------------------------------------*45380005
453900 5200-FILL-SEL-QUEUE-RECORD.                                      45390005
454000                                                                  45400005
454100     PERFORM 6112-READ-LIST-QUEUE.                                45410005
454200                                                                  45420005
454300     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       45430005
454400         PERFORM                                                  45440005
454500         VARYING LQW-IDX                                          45450005
454600         FROM 1 BY 1                                              45460005
454700         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            45470005
454800           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          45480005
454900                                                                  45490005
455000             IF  LQW-SELECT (LQW-IDX)                             45500005
455100                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              45510005
455200                                   TO RC013-ITEM      (RC013-IDX) 45520005
455300                 MOVE SPACE        TO RC013-ACTION-SW (RC013-IDX) 45530005
455400                 MOVE RC015-OPER-UNT-ID                           45540005
455500                                 TO RC013-OPER-UNT-ID (RC013-IDX) 45550005
455600                 MOVE RC015-FCLTY-ID                              45560005
455700                                   TO RC013-FCLTY-ID (RC013-IDX)  45570005
455800                 MOVE RC015-PO-NBR TO RC013-PO-NBR (RC013-IDX)    45580005
455900                 MOVE RC015-REC-SEQ-NBR                           45590005
456000                                 TO RC013-REC-SEQ-NBR (RC013-IDX) 45600005
456100                 MOVE LQW-STORE-NBR (LQW-IDX)                     45610005
456200                                   TO RC013-STR-NBR (RC013-IDX)   45620005
456300                                                                  45630005
456400                 SET LQW-DESELECT (LQW-IDX)                       45640005
456500                     LQW-INQUIRE  (LQW-IDX) TO TRUE               45650005
456600                 SET RC013-IDX UP BY 1                            45660005
456700                 IF  RC013-IDX > RC013-MAX-ITEMS                  45670005
456800                     PERFORM 5205-WRITE-SEL-QUEUE                 45680005
456900                     ADD +1        TO RC015-NUMBER-OF-TS-ITEMS    45690005
457000                     INITIALIZE RC013-SELECTED-ITEM-ARRAY         45700005
457100                     SET RC013-IDX TO 1                           45710005
457200                 END-IF                                           45720005
457300             END-IF                                               45730005
457400         END-PERFORM                                              45740005
457500     END-IF.                                                      45750005
457600                                                                  45760005
457700*----------------------------------------------------------------*45770005
457800*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *45780005
457900*----------------------------------------------------------------*45790005
458000 5205-WRITE-SEL-QUEUE.                                            45800005
458100                                                                  45810005
458200     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            45820005
458300                                   TO RC013-SELECTED-ITEMS.       45830005
458400                                                                  45840005
458500     EXEC CICS                                                    45850005
458600          WRITEQ TS                                               45860005
458700              QUEUE (ASC-SEL-QUEUE-NAME)                          45870005
458800              FROM  (RC013-DC-SELECT-RECORD)                      45880005
458900              ITEM  (ASC-SEL-ITEM)                                45890005
459000              RESP  (PV-CICS-RESP)                                45900005
459100     END-EXEC.                                                    45910005
459200                                                                  45920005
459300*DMH     MOVE ASC-SEL-TERM-ID      TO PV-SEL-TERM-ID              45930005
459400*DMH     MOVE ASC-SEL-TASK-NUMBER  TO PV-SEL-TASK-NUMBER          45940005
459500*DMH     MOVE ASC-SEL-SEQ          TO PV-SEL-SEQ                  45950005
459600*DMH     STRING ' RCKCS298-WRI SEL2'  DELIMITED BY SIZE           45960005
459700*DMH            ' QUEUE TERM ID-'     DELIMITED BY SIZE           45970005
459800*DMH             PV-SEL-TERM-ID       DELIMITED BY SIZE           45980005
459900*DMH            ' QUEUE TASK-'        DELIMITED BY SIZE           45990005
460000*DMH             PV-SEL-TASK-NUMBER   DELIMITED BY SIZE           46000005
460100*DMH            ' QUEUE SEQ-'         DELIMITED BY SIZE           46010005
460200*DMH             PV-SEL-SEQ           DELIMITED BY SIZE           46020005
460300*DMH                             INTO  PV-CICS-MSG-AREA2          46030005
460400*DMH         MOVE LENGTH OF PV-CICS-MSG-AREA2                     46040005
460500*DMH           TO PV-COMMAREA-LENGTH                              46050005
460600*DMH         EXEC CICS                                            46060005
460700*DMH              WRITEQ TD                                       46070005
460800*DMH               QUEUE  ('CSSL')                                46080005
460900*DMH                FROM  (PV-CICS-MSG-AREA2)                     46090005
461000*DMH              LENGTH  (PV-COMMAREA-LENGTH)                    46100005
461100*DMH                RESP  (PV-CICS-RESP)                          46110005
461200*DMH         END-EXEC                                             46120005
461300     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          46130005
461400         CONTINUE                                                 46140005
461500     ELSE                                                         46150005
461600         SET DP013-CICS-ABEND      TO TRUE                        46160005
461700         SET DP013-NO-ROLLBACK     TO TRUE                        46170005
461800         MOVE '5205-WRITE-SEL-QUEUE'                              46180005
461900                                   TO DP013-PARAGRAPH             46190005
462000         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          46200005
462100                                   TO DP013-MESSAGE-TEXT(1)       46210005
462200         PERFORM DP013-0000-PROCESS-ABEND                         46220005
462300     END-IF.                                                      46230005
462400                                                                  46240005
462500*----------------------------------------------------------------*46250005
462600*  WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION,  *46260005
462700*  SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT  *46270005
462800*  THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO     *46280005
462900*  THE USER.                                                     *46290005
463000*----------------------------------------------------------------*46300005
463100 6000-REFRESH-PANEL-FROM-TEMP.                                    46310005
463200                                                                  46320005
463300     IF ASC-UPDATE-TSQ                                            46330005
463400         SET ASC-NO-TSQ-UPDATE     TO TRUE                        46340005
463500         MOVE ZERO                 TO PV-SAVE-ITEM                46350005
463600                                      ASC-SEL-ITEM                46360005
463700         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        46370005
463800                                   TO PV-HOLD-SELECTED-ITEMS      46380005
463900                                                                  46390005
464000         MOVE +1                   TO PV-ITEMS-PROCESSED          46400005
464100                                                                  46410005
464200***      MOVE RC015-SEL-QUEUE-NAME TO ASC-SEL-QUEUE-NAME-IN       46420005
464300         PERFORM 6100-UPDATE-TSQ                                  46430005
464400           UNTIL PV-ITEMS-PROCESSED > ASC-NUMBER-OF-SELECTED-ITEMS46440005
464500                                                                  46450005
464600         PERFORM 6010-DELETE-SEL-QUEUE                            46460005
464700                                                                  46470005
464800         INITIALIZE ASC-BLOCK-ENTRIES (1)                         46480005
464900                    ASC-BLOCK-ENTRIES (2)                         46490005
465000     END-IF.                                                      46500005
465100                                                                  46510005
465200*----------------------------------------------------------------*46520005
465300*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *46530005
465400*----------------------------------------------------------------*46540005
465500 6010-DELETE-SEL-QUEUE.                                           46550005
465600                                                                  46560005
465700     EXEC CICS                                                    46570005
465800         DELETEQ TS                                               46580005
465900             QUEUE (ASC-SEL-QUEUE-NAME)                           46590005
466000             RESP  (PV-CICS-RESP)                                 46600005
466100     END-EXEC.                                                    46610005
466200                                                                  46620005
466300*DMH     MOVE ASC-SEL-TERM-ID      TO PV-SEL-TERM-ID              46630005
466400*DMH     MOVE ASC-SEL-TASK-NUMBER  TO PV-SEL-TASK-NUMBER          46640005
466500*DMH     MOVE ASC-SEL-SEQ          TO PV-SEL-SEQ                  46650005
466600*DMH     STRING ' RCKCS298-DEL SEL '  DELIMITED BY SIZE           46660005
466700*DMH            ' QUEUE TERM ID-'     DELIMITED BY SIZE           46670005
466800*DMH             PV-SEL-TERM-ID       DELIMITED BY SIZE           46680005
466900*DMH            ' QUEUE TASK-'        DELIMITED BY SIZE           46690005
467000*DMH             PV-SEL-TASK-NUMBER   DELIMITED BY SIZE           46700005
467100*DMH            ' QUEUE SEQ-'         DELIMITED BY SIZE           46710005
467200*DMH             PV-SEL-SEQ           DELIMITED BY SIZE           46720005
467300*DMH                             INTO  PV-CICS-MSG-AREA2          46730005
467400*DMH         MOVE LENGTH OF PV-CICS-MSG-AREA2                     46740005
467500*DMH           TO PV-COMMAREA-LENGTH                              46750005
467600*DMH         EXEC CICS                                            46760005
467700*DMH              WRITEQ TD                                       46770005
467800*DMH               QUEUE  ('CSSL')                                46780005
467900*DMH                FROM  (PV-CICS-MSG-AREA2)                     46790005
468000*DMH              LENGTH  (PV-COMMAREA-LENGTH)                    46800005
468100*DMH                RESP  (PV-CICS-RESP)                          46810005
468200*DMH         END-EXEC                                             46820005
468300                                                                  46830005
468400     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      46840005
468500         (PV-CICS-RESP = DFHRESP(QIDERR)))                        46850005
468600                                                                  46860005
468700*DMH     MOVE ASC-SEL-TERM-ID      TO PV-SEL-TERM-ID              46870005
468800*DMH     MOVE ASC-SEL-TASK-NUMBER  TO PV-SEL-TASK-NUMBER          46880005
468900*DMH     MOVE ASC-SEL-SEQ          TO PV-SEL-SEQ                  46890005
469000*DMH     STRING ' RCKCS298-DEL SEL '  DELIMITED BY SIZE           46900005
469100*DMH            ' QUEUE TERM ID-'     DELIMITED BY SIZE           46910005
469200*DMH             PV-SEL-TERM-ID       DELIMITED BY SIZE           46920005
469300*DMH            ' QUEUE TASK-'        DELIMITED BY SIZE           46930005
469400*DMH             PV-SEL-TASK-NUMBER   DELIMITED BY SIZE           46940005
469500*DMH            ' QUEUE SEQ-'         DELIMITED BY SIZE           46950005
469600*DMH             PV-SEL-SEQ           DELIMITED BY SIZE           46960005
469700*DMH                             INTO  PV-CICS-MSG-AREA2          46970005
469800*DMH         MOVE LENGTH OF PV-CICS-MSG-AREA2                     46980005
469900*DMH           TO PV-COMMAREA-LENGTH                              46990005
470000*DMH         EXEC CICS                                            47000005
470100*DMH              WRITEQ TD                                       47010005
470200*DMH               QUEUE  ('CSSL')                                47020005
470300*DMH                FROM  (PV-CICS-MSG-AREA2)                     47030005
470400*DMH              LENGTH  (PV-COMMAREA-LENGTH)                    47040005
470500*DMH                RESP  (PV-CICS-RESP)                          47050005
470600*DMH         END-EXEC                                             47060005
470700         CONTINUE                                                 47070005
470800     ELSE                                                         47080005
470900         SET DP013-CICS-ABEND      TO TRUE                        47090005
471000         SET DP013-NO-ROLLBACK     TO TRUE                        47100005
471100         MOVE '6010-DELETE-SEL-QUEUE'                             47110005
471200                                   TO DP013-PARAGRAPH             47120005
471300         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         47130005
471400                                   TO DP013-MESSAGE-TEXT (1)      47140005
471500         PERFORM DP013-0000-PROCESS-ABEND                         47150005
471600     END-IF.                                                      47160005
471700                                                                  47170005
471800*----------------------------------------------------------------*47180005
471900*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *47190005
472000*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *47200005
472100*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *47210005
472200*    THE TEMP QUEUE.                                             *47220005
472300*----------------------------------------------------------------*47230005
472400 6100-UPDATE-TSQ.                                                 47240005
472500                                                                  47250005
472600     ADD +1  TO ASC-SEL-ITEM.                                     47260005
472700     PERFORM 6105-READ-SEL-QUEUE.                                 47270005
472800                                                                  47280005
472900     PERFORM                                                      47290005
473000       VARYING RC013-IDX FROM 1 BY 1                              47300005
473100         UNTIL ((PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS)     47310005
473200            OR (RC013-IDX GREATER THAN RC013-MAX-ITEMS))          47320005
473300                                                                  47330005
473400         IF RC013-ACTION-SW (RC013-IDX) > SPACE                   47340005
473500             PERFORM 6110-PROCESS-ITEMS                           47350005
473600         END-IF                                                   47360005
473700                                                                  47370005
473800         ADD +1 TO PV-ITEMS-PROCESSED                             47380005
473900     END-PERFORM.                                                 47390005
474000                                                                  47400005
474100     PERFORM 6111-WRITE-LIST-QUEUE.                               47410005
474200                                                                  47420005
474300*----------------------------------------------------------------*47430005
474400*    READ THE LIST QUEUE RECORD.                                 *47440005
474500*----------------------------------------------------------------*47450005
474600 6105-READ-SEL-QUEUE.                                             47460005
474700                                                                  47470005
474800     EXEC CICS                                                    47480005
474900          READQ TS                                                47490005
475000              QUEUE (ASC-SEL-QUEUE-NAME)                          47500005
475100              INTO  (RC013-DC-SELECT-RECORD)                      47510005
475200              ITEM  (ASC-SEL-ITEM)                                47520005
475300              RESP  (PV-CICS-RESP)                                47530005
475400     END-EXEC.                                                    47540005
475500                                                                  47550005
475600     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          47560005
475700         CONTINUE                                                 47570005
475800     ELSE                                                         47580005
475900         SET DP013-CICS-ABEND      TO TRUE                        47590005
476000         SET DP013-NO-ROLLBACK     TO TRUE                        47600005
476100         MOVE '6105-READ-SEL-QUEUE'                               47610005
476200                                   TO DP013-PARAGRAPH             47620005
476300         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           47630005
476400                                   TO DP013-MESSAGE-TEXT(1)       47640005
476500         PERFORM DP013-0000-PROCESS-ABEND                         47650005
476600     END-IF.                                                      47660005
476700                                                                  47670005
476800*----------------------------------------------------------------*47680005
476900*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*47690005
477000*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*47700005
477100*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *47710005
477200*----------------------------------------------------------------*47720005
477300 6110-PROCESS-ITEMS.                                              47730005
477400                                                                  47740005
477500     COMPUTE PV-ITEM = 1 + ((RC013-ITEM (RC013-IDX) - 1)          47750005
477600                     / PC-ITEMS-PER-PANEL).                       47760005
477700                                                                  47770005
477800     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           47780005
477900         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          47790005
478000             PERFORM 6111-WRITE-LIST-QUEUE                        47800005
478100         END-IF                                                   47810005
478200         MOVE PV-ITEM TO PV-SAVE-ITEM                             47820005
478300                                                                  47830005
478400         PERFORM 6112-READ-LIST-QUEUE                             47840005
478500         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               47850005
478600             CONTINUE                                             47860005
478700         END-IF                                                   47870005
478800     END-IF.                                                      47880005
478900                                                                  47890005
479000     COMPUTE PV-SUB = (RC013-ITEM (RC013-IDX)                     47900005
479100                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              47910005
479200                                                                  47920005
479300     SET LQW-DESELECT (PV-SUB)     TO TRUE.                       47930005
479400     MOVE LQW-SELECTED-SW (PV-SUB) TO LQW-TEMP-SELECTED-SW        47940005
479500                                     (PV-SUB).                    47950005
479600                                                                  47960005
479700     MOVE LQW-STORE-NBR (PV-SUB)   TO DK-STR-NBR.                 47970005
479800     PERFORM 7700-GET-TDISTDT.                                    47980005
479900     MOVE DISTDT-PREPK-ODD-UNT-QTY TO LQW-ODD-UNIT (PV-SUB).      47990005
480000                                                                  48000005
480100     EVALUATE TRUE                                                48010005
480200       WHEN RC013-INQ (RC013-IDX)                                 48020005
480300           MOVE PC-INQ TO LQW-ACTION (PV-SUB)                     48030005
480400                                                                  48040005
480500       WHEN RC013-UPD (RC013-IDX)                                 48050005
480600           MOVE PC-UPD TO LQW-ACTION (PV-SUB)                     48060005
480700                                                                  48070005
480800       WHEN RC013-DEL (RC013-IDX)                                 48080005
480900           MOVE PC-DEL TO LQW-ACTION (PV-SUB)                     48090005
481000                                                                  48100005
481100       WHEN RC013-ERR (RC013-IDX)                                 48110005
481200           MOVE PC-ERR TO LQW-ACTION (PV-SUB)                     48120005
481300     END-EVALUATE.                                                48130005
481400                                                                  48140005
481500     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                48150005
481600                                                                  48160005
481700*----------------------------------------------------------------*48170005
481800*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *48180005
481900*----------------------------------------------------------------*48190005
482000 6111-WRITE-LIST-QUEUE.                                           48200005
482100                                                                  48210005
482200     EXEC CICS                                                    48220005
482300         WRITEQ TS                                                48230005
482400             QUEUE (ASC-LIST-QUEUE-NAME)                          48240005
482500             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     48250005
482600             ITEM  (PV-SAVE-ITEM)                                 48260005
482700             REWRITE                                              48270005
482800             RESP  (PV-CICS-RESP)                                 48280005
482900     END-EXEC.                                                    48290005
483000                                                                  48300005
483100*DMH     MOVE ASC-LIST-TERM-ID      TO PV-SEL-TERM-ID             48310005
483200*DMH     MOVE ASC-LIST-TASK-NUMBER  TO PV-SEL-TASK-NUMBER         48320005
483300*DMH     MOVE ASC-LIST-SEQ          TO PV-SEL-SEQ                 48330005
483400*DMH     STRING ' RCKCS298-WRI LST '  DELIMITED BY SIZE           48340005
483500*DMH            ' QUEUE TERM ID-'     DELIMITED BY SIZE           48350005
483600*DMH             PV-SEL-TERM-ID       DELIMITED BY SIZE           48360005
483700*DMH            ' QUEUE TASK-'        DELIMITED BY SIZE           48370005
483800*DMH             PV-SEL-TASK-NUMBER   DELIMITED BY SIZE           48380005
483900*DMH            ' QUEUE SEQ-'         DELIMITED BY SIZE           48390005
484000*DMH             PV-SEL-SEQ           DELIMITED BY SIZE           48400005
484100*DMH                             INTO  PV-CICS-MSG-AREA2          48410005
484200*DMH         MOVE LENGTH OF PV-CICS-MSG-AREA2                     48420005
484300*DMH           TO PV-COMMAREA-LENGTH                              48430005
484400*DMH         EXEC CICS                                            48440005
484500*DMH              WRITEQ TD                                       48450005
484600*DMH               QUEUE  ('CSSL')                                48460005
484700*DMH                FROM  (PV-CICS-MSG-AREA2)                     48470005
484800*DMH              LENGTH  (PV-COMMAREA-LENGTH)                    48480005
484900*DMH                RESP  (PV-CICS-RESP)                          48490005
485000*DMH         END-EXEC                                             48500005
485100                                                                  48510005
485200     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          48520005
485300         CONTINUE                                                 48530005
485400     ELSE                                                         48540005
485500         SET DP013-CICS-ABEND      TO TRUE                        48550005
485600         SET DP013-NO-ROLLBACK     TO TRUE                        48560005
485700         MOVE '6111-WRITE-LIST-QUEUE'                             48570005
485800                                   TO DP013-PARAGRAPH             48580005
485900         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  48590005
486000                                   TO DP013-MESSAGE-TEXT(1)       48600005
486100         PERFORM DP013-0000-PROCESS-ABEND                         48610005
486200     END-IF.                                                      48620005
486300                                                                  48630005
486400*----------------------------------------------------------------*48640005
486500*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*48650005
486600*----------------------------------------------------------------*48660005
486700 6112-READ-LIST-QUEUE.                                            48670005
486800                                                                  48680005
486900     EXEC CICS                                                    48690005
487000         READQ TS                                                 48700005
487100             QUEUE (ASC-LIST-QUEUE-NAME)                          48710005
487200             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     48720005
487300             ITEM  (PV-ITEM)                                      48730005
487400             RESP  (PV-CICS-RESP)                                 48740005
487500     END-EXEC.                                                    48750005
487600                                                                  48760005
487700     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          48770005
487800         CONTINUE                                                 48780005
487900     ELSE                                                         48790005
488000         SET DP013-CICS-ABEND      TO TRUE                        48800005
488100         SET DP013-NO-ROLLBACK     TO TRUE                        48810005
488200         MOVE '6112-READ-LIST-QUEUE'                              48820005
488300                                   TO DP013-PARAGRAPH             48830005
488400         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    48840005
488500                                   TO DP013-MESSAGE-TEXT(1)       48850005
488600         PERFORM DP013-0000-PROCESS-ABEND                         48860005
488700     END-IF.                                                      48870005
488800                                                                  48880005
488900 7000-GET-DEPT.                                                   48890005
489000                                                                  48900005
489100     EXEC SQL                                                     48910005
489200     SELECT                                                       48920005
489300         DEPT_NBR                                                 48930005
489400     INTO                                                         48940005
489500         :PURCHS-DEPT-NBR                                         48950005
489600     FROM                                                         48960005
489700         TPURCHS A                                                48970005
489800     WHERE                                                        48980005
489900         A.PO_NBR = :DK-ORD-NBR                                   48990005
490000     AND                                                          49000005
490100         A.VER_STATUS_CDE = 'A'                                   49010005
490200     END-EXEC.                                                    49020005
490300                                                                  49030005
490400     EVALUATE TRUE                                                49040005
490500         WHEN SQLCODE = ZERO                                      49050005
490600         WHEN SQLCODE = +100                                      49060005
490700              CONTINUE                                            49070005
490800         WHEN SQLCODE = -904                                      49080005
490900         WHEN SQLCODE = -911                                      49090005
491000         WHEN SQLCODE = -913                                      49100005
491100             PERFORM 9900-SOFT-ABORT                              49110005
491200                                                                  49120005
491300         WHEN SQLWARN0 NOT = SPACE                                49130005
491400         WHEN SQLCODE < ZERO                                      49140005
491500         WHEN SQLCODE > ZERO                                      49150005
491600              MOVE '7000-GET-DEPT'                                49160005
491700                                   TO DP013-PARAGRAPH             49170005
491800              MOVE 'SELECT DEPT NUMBER'                           49180005
491900                                   TO DP013-MESSAGE-TEXT (1)      49190005
492000              MOVE SQLCA           TO DP013-SQLCA                 49200005
492100              MOVE 'TPURCHS'       TO DP013-DB2-TABLE-NAME (1)    49210005
492200              SET DP013-DB2-ABEND  TO TRUE                        49220005
492300              PERFORM DP013-0000-PROCESS-ABEND                    49230005
492400     END-EVALUATE.                                                49240005
492500                                                                  49250005
492600 7200-GET-RCVR-STATUS.                                            49260005
492700                                                                  49270005
492800     EXEC SQL                                                     49280005
492900     SELECT STATUS_CDE                                            49290005
493000           ,PKGNG_CDE                                             49300005
493100           ,OPER_UNT_ID                                           49310005
493200       INTO :RECEIV-STATUS-CDE                                    49320005
493300           ,:RECEIV-PKGNG-CDE                                     49330005
493400           ,:ASC-RCVR-OPER-UNT-ID                                 49340005
493500       FROM TRECEIV A                                             49350005
493600      WHERE A.ORD_NBR = :DK-ORD-NBR                               49360005
493700        AND A.REC_SEQ_NBR = :DK-RCVR-NBR                          49370005
493800        AND A.VER_STATUS_CDE = 'A'                                49380005
493900     END-EXEC.                                                    49390005
494000                                                                  49400005
494100     EVALUATE TRUE                                                49410005
494200         WHEN SQLCODE = ZERO                                      49420005
494300             MOVE RECEIV-PKGNG-CDE TO ASC-PKGNG-CDE               49430005
494400                                      ASC-PKGNG-CDE-DISPLAY       49440005
494500                                                                  49450005
494600         WHEN SQLCODE = +100                                      49460005
494700             CONTINUE                                             49470005
494800                                                                  49480005
494900         WHEN SQLCODE = -904                                      49490005
495000         WHEN SQLCODE = -911                                      49500005
495100         WHEN SQLCODE = -913                                      49510005
495200             PERFORM 9900-SOFT-ABORT                              49520005
495300                                                                  49530005
495400         WHEN SQLWARN0 NOT = SPACE                                49540005
495500         WHEN SQLCODE < ZERO                                      49550005
495600         WHEN SQLCODE > ZERO                                      49560005
495700              MOVE '7200-GET-RCVR-STATUS'                         49570005
495800                                   TO DP013-PARAGRAPH             49580005
495900              MOVE 'SELECT RCVR STATUS'                           49590005
496000                                   TO DP013-MESSAGE-TEXT (1)      49600005
496100              MOVE SQLCA           TO DP013-SQLCA                 49610005
496200              MOVE 'TRECEIV'       TO DP013-DB2-TABLE-NAME (1)    49620005
496300              SET DP013-DB2-ABEND  TO TRUE                        49630005
496400              PERFORM DP013-0000-PROCESS-ABEND                    49640005
496500     END-EVALUATE.                                                49650005
496600                                                                  49660005
496700 7250-GET-SKU.                                                    49670005
496800                                                                  49680005
496900*----------------------------------------------------------------*49690005
497000* INCLUDED FETCH TO ITEM_NBR.                     WR # 21361     *49700005
497100* IF THE SQL STATEMENT IS SUCCESSFUL, THEN SET PS-CALL-API-YES   *49710005
497200* TO TRUE.                                                       *49720005
497300*----------------------------------------------------------------*49730005
497400                                                                  49740005
497500     SET PS-CALL-API-NO      TO TRUE                              49750005
497600                                                                  49760005
497700     EXEC SQL                                                     49770005
497800     SELECT B.CL_NBR                                              49780005
497900     ,      B.SKU_SEQ_NBR                                         49790005
498000     ,      B.ITM_NBR                                             49800005
498100     ,      A.STATUS_CDE                                          49810005
498200         INTO :PURITM-CL-NBR                                      49820005
498300         ,    :PURITM-SKU-SEQ-NBR                                 49830005
498400         ,    :PURITM-ITM-NBR                                     49840005
498500         ,    :RECITM-STATUS-CDE                                  49850005
498600         FROM                                                     49860005
498700             TRECITM A                                            49870005
498800         ,   TPURITM B                                            49880005
498900         WHERE A.ORD_NBR          = :DK-ORD-NBR                   49890005
499000         AND   A.ORD_NBR          = B.PO_NBR                      49900005
499100         AND A.REC_SEQ_NBR        = :DK-RCVR-NBR                  49910005
499200         AND A.ORD_LNE_NBR        = :DK-LINE-NBR                  49920005
499300         AND A.ORD_LNE_NBR        = B.APP_PO_LNE_NBR              49930005
499400         AND A.VER_STATUS_CDE     = 'A'                           49940005
499500         AND A.PO_VER_NBR         = B.VER_NBR                     49950005
499600     END-EXEC.                                                    49960005
499700                                                                  49970005
499800     EVALUATE TRUE                                                49980005
499900         WHEN SQLCODE = ZERO                                      49990005
500000              SET PS-CALL-API-YES     TO TRUE                     50000005
500100         WHEN SQLCODE = +100                                      50010005
500200         WHEN SQLCODE = -305                                      50020005
500300             MOVE ZEROES     TO PURITM-SKU-SEQ-NBR                50030005
500400                                PURITM-ITM-NBR                    50040005
500500             MOVE SPACES     TO PURITM-CL-NBR                     50050005
500600                                RECITM-STATUS-CDE                 50060005
500700         WHEN SQLCODE = -904                                      50070005
500800         WHEN SQLCODE = -911                                      50080005
500900         WHEN SQLCODE = -913                                      50090005
501000             PERFORM 9900-SOFT-ABORT                              50100005
501100                                                                  50110005
501200         WHEN SQLWARN0 NOT = SPACES                               50120005
501300         WHEN SQLCODE < ZERO                                      50130005
501400         WHEN SQLCODE > ZERO                                      50140005
501500             MOVE '7250-GET-SKU'                                  50150005
501600                                  TO DP013-PARAGRAPH              50160005
501700             MOVE 'UNSUCCESSFUL COUNT OF VERIFIED LINES'          50170005
501800                                  TO DP013-MESSAGE-TEXT (1)       50180005
501900             MOVE SQLCA      TO DP013-SQLCA                       50190005
502000             MOVE 'TRECITM ' TO DP013-DB2-TABLE-NAME (1)          50200005
502100             SET DP013-DB2-ABEND                                  50210005
502200                 DP013-NO-ROLLBACK                                50220005
502300                                  TO TRUE                         50230005
502400             PERFORM DP013-0000-PROCESS-ABEND                     50240005
502500     END-EVALUATE.                                                50250005
502600*----------------------------------------------------------------*50260005
502700* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *50270005
502800*----------------------------------------------------------------*50280005
502900                                                                  50290005
503000 7300-SUM-TDISTDT.                                                50300005
503100                                                                  50310005
503200      EXEC SQL                                                    50320005
503300         SELECT                                                   50330005
503400             SUM(EXPTED_ALLOC_QTY)                                50340005
503500           , SUM(P2L_SPLT_UNT_QTY)                                50350005
503600           , SUM(FCSE_SPLT_UNT_QTY)                               50360005
503700           , SUM(INPK_SPLT_UNT_QTY)                               50370005
503800           , SUM(FCSE_ACTL_UNT_QTY)                               50380005
503900           , SUM(ACTL_ALLOC_QTY)                                  50390005
504000           INTO                                                   50400005
504100             :DISTDT-EXPTED-ALLOC-QTY                             50410005
504200           , :DISTDT-P2L-SPLT-UNT-QTY                             50420005
504300           , :DISTDT-FCSE-SPLT-UNT-QTY                            50430005
504400           , :DISTDT-INPK-SPLT-UNT-QTY                            50440005
504500           , :DISTDT-FCSE-ACTL-UNT-QTY                            50450005
504600           , :DISTDT-ACTL-ALLOC-QTY                               50460005
504700           FROM TDISTDT                                           50470005
504800           WHERE ORD_NBR    = :DK-ORD-NBR                         50480005
504900           AND RCVR_SEQ_NBR = :DK-RCVR-NBR                        50490005
505000           AND ORD_LNE_NBR  = :DK-LINE-NBR                        50500005
505100      END-EXEC.                                                   50510005
505200                                                                  50520005
505300      EVALUATE TRUE                                               50530005
505400           WHEN SQLCODE = ZERO                                    50540005
505500               CONTINUE                                           50550005
505600           WHEN SQLCODE = -305                                    50560005
505700               MOVE ZERO        TO DISTDT-P2L-SPLT-UNT-QTY        50570005
505800                                   DISTDT-FCSE-SPLT-UNT-QTY       50580005
505900                                   DISTDT-INPK-SPLT-UNT-QTY       50590005
506000         WHEN SQLCODE = -904                                      50600005
506100         WHEN SQLCODE = -911                                      50610005
506200         WHEN SQLCODE = -913                                      50620005
506300             PERFORM 9900-SOFT-ABORT                              50630005
506400                                                                  50640005
506500         WHEN SQLWARN0 NOT = SPACES                               50650005
506600         WHEN SQLCODE < ZERO                                      50660005
506700         WHEN SQLCODE > ZERO                                      50670005
506800             MOVE '7300-SUM-TDISTDT'                              50680005
506900                                  TO DP013-PARAGRAPH              50690005
507000             MOVE 'UNSUCCESSFUL COUNT OF VERIFIED LINES'          50700005
507100                                  TO DP013-MESSAGE-TEXT (1)       50710005
507200             MOVE SQLCA      TO DP013-SQLCA                       50720005
507300             MOVE 'TDISTDT ' TO DP013-DB2-TABLE-NAME (1)          50730005
507400             SET DP013-DB2-ABEND                                  50740005
507500                 DP013-NO-ROLLBACK                                50750005
507600                                  TO TRUE                         50760005
507700             PERFORM DP013-0000-PROCESS-ABEND                     50770005
507800     END-EVALUATE.                                                50780005
507900                                                                  50790005
508000 7310-SUM-DRIVER-TDISTDT.                                         50800005
508100                                                                  50810005
508200      EXEC SQL                                                    50820005
508300         SELECT                                                   50830005
508400             SUM(EXPTED_ALLOC_QTY)                                50840005
508500           , SUM(P2L_SPLT_UNT_QTY)                                50850005
508600           , SUM(FCSE_SPLT_UNT_QTY)                               50860005
508700           , SUM(INPK_SPLT_UNT_QTY)                               50870005
508800           , SUM(FCSE_ACTL_UNT_QTY)                               50880005
508900           , SUM(ACTL_ALLOC_QTY)                                  50890005
509000           INTO                                                   50900005
509100             :PV-DRIVER-EXPTED-ALLOC-QTY                          50910005
509200           , :PV-DRIVER-P2L-SPLT-UNT-QTY                          50920005
509300           , :PV-DRIVER-FCSE-SPLT-UNT-QTY                         50930005
509400           , :PV-DRIVER-INPK-SPLT-UNT-QTY                         50940005
509500           , :PV-DRIVER-FCSE-ACTL-UNT-QTY                         50950005
509600           , :PV-DRIVER-ACTL-ALLOC-QTY                            50960005
509700           FROM TDISTDT                                           50970005
509800           WHERE ORD_NBR    = :DK-ORD-NBR                         50980005
509900           AND RCVR_SEQ_NBR = :DK-RCVR-NBR                        50990005
510000           AND ORD_LNE_NBR  = :DK-DRIVER-LINE-NBR                 51000005
510100      END-EXEC.                                                   51010005
510200                                                                  51020005
510300      EVALUATE TRUE                                               51030005
510400           WHEN SQLCODE = ZERO                                    51040005
510500               CONTINUE                                           51050005
510600           WHEN SQLCODE = -305                                    51060005
510700               MOVE ZERO        TO PV-DRIVER-EXPTED-ALLOC-QTY     51070005
510800                                   PV-DRIVER-P2L-SPLT-UNT-QTY     51080005
510900                                   PV-DRIVER-FCSE-SPLT-UNT-QTY    51090005
511000                                   PV-DRIVER-INPK-SPLT-UNT-QTY    51100005
511100                                   PV-DRIVER-FCSE-ACTL-UNT-QTY    51110005
511200                                   PV-DRIVER-ACTL-ALLOC-QTY       51120005
511300         WHEN SQLCODE = -904                                      51130005
511400         WHEN SQLCODE = -911                                      51140005
511500         WHEN SQLCODE = -913                                      51150005
511600             PERFORM 9900-SOFT-ABORT                              51160005
511700                                                                  51170005
511800         WHEN SQLWARN0 NOT = SPACES                               51180005
511900         WHEN SQLCODE < ZERO                                      51190005
512000         WHEN SQLCODE > ZERO                                      51200005
512100             MOVE '7310-SUM-DRIVER-TDISTDT'                       51210005
512200                                  TO DP013-PARAGRAPH              51220005
512300             MOVE 'UNSUCCESSFUL SUM OF TDISTDT'                   51230005
512400                                  TO DP013-MESSAGE-TEXT (1)       51240005
512500             MOVE SQLCA      TO DP013-SQLCA                       51250005
512600             MOVE 'TDISTDT ' TO DP013-DB2-TABLE-NAME (1)          51260005
512700             SET DP013-DB2-ABEND                                  51270005
512800                 DP013-NO-ROLLBACK                                51280005
512900                                  TO TRUE                         51290005
513000             PERFORM DP013-0000-PROCESS-ABEND                     51300005
513100     END-EVALUATE.                                                51310005
513200                                                                  51320005
513300 7320-SELECT-DISTDT-DRIVER.                                       51330005
513400                                                                  51340005
513500      MOVE 0         TO PV-FCSE-SPLT-UNT-QTY                      51350005
513600                        PV-INPK-SPLT-UNT-QTY                      51360005
513700                        PV-FCSE-ACTL-UNT-QTY.                     51370005
513800      EXEC SQL                                                    51380005
513900         SELECT                                                   51390005
514000              FCSE_SPLT_UNT_QTY                                   51400005
514100           ,  INPK_SPLT_UNT_QTY                                   51410005
514200           ,  FCSE_ACTL_UNT_QTY                                   51420005
514300           INTO                                                   51430005
514400             :PV-FCSE-SPLT-UNT-QTY                                51440005
514500           , :PV-INPK-SPLT-UNT-QTY                                51450005
514600           , :PV-FCSE-ACTL-UNT-QTY                                51460005
514700           FROM TDISTDT                                           51470005
514800           WHERE ORD_NBR    = :DK-ORD-NBR                         51480005
514900           AND RCVR_SEQ_NBR = :DK-RCVR-NBR                        51490005
515000           AND ORD_LNE_NBR  = :DK-DRIVER-LINE-NBR                 51500005
515100           AND STR_NBR      = :DISTDT-STR-NBR                     51510005
515200      END-EXEC.                                                   51520005
515300                                                                  51530005
515400      EVALUATE TRUE                                               51540005
515500           WHEN SQLCODE = ZERO                                    51550005
515600               CONTINUE                                           51560005
515700           WHEN SQLCODE = -305                                    51570005
515800           WHEN SQLCODE = +100                                    51580005
515900               MOVE ZERO        TO PV-FCSE-SPLT-UNT-QTY           51590005
516000                                   PV-INPK-SPLT-UNT-QTY           51600005
516100                                   PV-FCSE-ACTL-UNT-QTY           51610005
516200         WHEN SQLCODE = -904                                      51620005
516300         WHEN SQLCODE = -911                                      51630005
516400         WHEN SQLCODE = -913                                      51640005
516500             PERFORM 9900-SOFT-ABORT                              51650005
516600                                                                  51660005
516700         WHEN SQLWARN0 NOT = SPACES                               51670005
516800         WHEN SQLCODE < ZERO                                      51680005
516900         WHEN SQLCODE > ZERO                                      51690005
517000             MOVE '7320-SELECT-DISTDT-DRIVER'                     51700005
517100                                  TO DP013-PARAGRAPH              51710005
517200             MOVE 'UNSUCCESSFUL COUNT OF VERIFIED LINES'          51720005
517300                                  TO DP013-MESSAGE-TEXT (1)       51730005
517400             MOVE SQLCA      TO DP013-SQLCA                       51740005
517500             MOVE 'TDISTDT ' TO DP013-DB2-TABLE-NAME (1)          51750005
517600             SET DP013-DB2-ABEND                                  51760005
517700                 DP013-NO-ROLLBACK                                51770005
517800                                  TO TRUE                         51780005
517900             PERFORM DP013-0000-PROCESS-ABEND                     51790005
518000     END-EVALUATE.                                                51800005
518100                                                                  51810005
518200 7350-CHECK-LINE-TROUBLE.                                         51820005
518300                                                                  51830005
518400     EXEC SQL                                                     51840005
518500     SELECT COUNT (*)                                             51850005
518600       INTO :PV-TROUBLE-COUNT                                     51860005
518700       FROM  TTRBNTF A                                            51870005
518800            ,TTRBRSN B                                            51880005
518900      WHERE  A.PO_NBR         =   :DK-ORD-NBR                     51890005
519000      AND    A.REC_SEQ_NBR    =   :DK-RCVR-NBR                    51900005
519100      AND  ((A.PO_LNE_NBR     =   :DK-LINE-NBR                    51910005
519200      AND    B.TRBL_LVL_IND    <> :PC-M)                          51920005
519300      OR    (A.PREPK_ID       =   :RECITM-PREPK-ID                51930005
519400      AND    B.TRBL_LVL_IND    =  :PC-M))                         51940005
519500      AND    A.RESOLVED_IND   IN  ('N', 'I', 'R')                 51950005
519600      AND    A.TRBL_RSN_CDE   =    B.TRBL_RSN_CDE                 51960005
519700      AND    B.NOTIF_IND      =    'T'                            51970005
519800     END-EXEC.                                                    51980005
519900                                                                  51990005
520000     EVALUATE TRUE                                                52000005
520100         WHEN SQLCODE = ZERO                                      52010005
520200         WHEN SQLCODE = +100                                      52020005
520300         WHEN SQLCODE = -811                                      52030005
520400              CONTINUE                                            52040005
520500         WHEN SQLCODE = -904                                      52050005
520600         WHEN SQLCODE = -911                                      52060005
520700         WHEN SQLCODE = -913                                      52070005
520800             PERFORM 9900-SOFT-ABORT                              52080005
520900                                                                  52090005
521000         WHEN SQLWARN0 NOT = SPACES                               52100005
521100         WHEN SQLCODE < ZERO                                      52110005
521200         WHEN SQLCODE > ZERO                                      52120005
521300             MOVE '7350-CHECK-LINE-TROUBLE'                       52130005
521400                                  TO DP013-PARAGRAPH              52140005
521500             MOVE 'UNSUCCESSFUL COUNT OF TTRBNTF ROWS'            52150005
521600                                  TO DP013-MESSAGE-TEXT (1)       52160005
521700             MOVE SQLCA      TO DP013-SQLCA                       52170005
521800             MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)          52180005
521900             SET DP013-DB2-ABEND                                  52190005
522000                  DP013-NO-ROLLBACK                               52200005
522100                                  TO TRUE                         52210005
522200             PERFORM DP013-0000-PROCESS-ABEND                     52220005
522300     END-EVALUATE.                                                52230005
522400                                                                  52240005
522500 7400-OPEN-INVPAR-CSR.                                            52250005
522600                                                                  52260005
522700     EXEC SQL                                                     52270005
522800         OPEN INVPAR-CSR                                          52280005
522900     END-EXEC                                                     52290005
523000                                                                  52300005
523100     EVALUATE TRUE                                                52310005
523200         WHEN SQLCODE = ZERO                                      52320005
523300              CONTINUE                                            52330005
523400         WHEN SQLCODE = -904                                      52340005
523500         WHEN SQLCODE = -911                                      52350005
523600         WHEN SQLCODE = -913                                      52360005
523700             PERFORM 9900-SOFT-ABORT                              52370005
523800         WHEN SQLWARN0 NOT = SPACE                                52380005
523900         WHEN SQLCODE  NOT = ZERO                                 52390005
524000             MOVE '7400-OPEN-INVPAR-CSR'                          52400005
524100                                   TO DP013-PARAGRAPH             52410005
524200             MOVE 'OPEN INVPAR-CSR CURSOR'                        52420005
524300                                   TO DP013-MESSAGE-TEXT (1)      52430005
524400             MOVE SQLCA       TO DP013-SQLCA                      52440005
524500             MOVE 'XLT_MDSE_INV_PARM'                             52450028
524510                              TO DP013-DB2-TABLE-NAME (1)         52451028
524600             SET DP013-DB2-ABEND                                  52460005
524700                                   TO TRUE                        52470005
524800             PERFORM DP013-0000-PROCESS-ABEND                     52480005
524900     END-EVALUATE.                                                52490005
525000                                                                  52500005
525100 7401-FETCH-INVPAR-CSR.                                           52510005
525200     EXEC SQL                                                     52520005
525300         FETCH INVPAR-CSR                                         52530005
525400          INTO                                                    52540005
525500                 :XLT00025-LOC-NBR                                52550028
525600     END-EXEC.                                                    52560005
525700                                                                  52570005
525800     EVALUATE TRUE                                                52580005
525900         WHEN SQLCODE = ZERO                                      52590005
526000              CONTINUE                                            52600005
526100         WHEN SQLCODE = +100                                      52610005
526200              SET PS-EOF-INVPAR-CSR                               52620005
526300                                   TO TRUE                        52630005
526400         WHEN SQLCODE = -904                                      52640005
526500         WHEN SQLCODE = -911                                      52650005
526600         WHEN SQLCODE = -913                                      52660005
526700             PERFORM 9900-SOFT-ABORT                              52670005
526800                                                                  52680005
526900         WHEN SQLWARN0 NOT = SPACE                                52690005
527000         WHEN SQLCODE < ZERO                                      52700005
527100         WHEN SQLCODE > ZERO                                      52710005
527200              MOVE '7401-FETCH-INVPAR-CSR' TO DP013-PARAGRAPH     52720005
527300              MOVE 'FETCH INVPAR CURSOR'                          52730005
527400                                      TO DP013-MESSAGE-TEXT (1)   52740005
527500              MOVE SQLCA              TO DP013-SQLCA              52750005
527600              MOVE 'XLT_MDSE_INV_PARM'                            52760028
527610                                      TO DP013-DB2-TABLE-NAME (1) 52761028
527700              SET DP013-DB2-ABEND     TO TRUE                     52770005
527800              PERFORM DP013-0000-PROCESS-ABEND                    52780005
527900     END-EVALUATE.                                                52790005
528000                                                                  52800005
528100 7402-CLOSE-INVPAR-CSR.                                           52810005
528200     EXEC SQL                                                     52820005
528300         CLOSE INVPAR-CSR                                         52830005
528400     END-EXEC                                                     52840005
528500                                                                  52850005
528600     EVALUATE TRUE                                                52860005
528700         WHEN SQLCODE = ZERO                                      52870005
528800              CONTINUE                                            52880005
528900         WHEN SQLCODE = -904                                      52890005
529000         WHEN SQLCODE = -911                                      52900005
529100         WHEN SQLCODE = -913                                      52910005
529200             PERFORM 9900-SOFT-ABORT                              52920005
529300         WHEN SQLWARN0 NOT = SPACE                                52930005
529400         WHEN SQLCODE  NOT = ZERO                                 52940005
529500             MOVE '7402-CLOSE-INVPAR-CSR'                         52950005
529600                                   TO DP013-PARAGRAPH             52960005
529700             MOVE 'CLOSE INVPAR-CSR CURSOR'                       52970005
529800                                   TO DP013-MESSAGE-TEXT (1)      52980005
529900             MOVE SQLCA       TO DP013-SQLCA                      52990005
530000             MOVE 'XLT_MDSE_INV_PARM'                             53000028
530010                              TO DP013-DB2-TABLE-NAME (1)         53001028
530100             SET DP013-DB2-ABEND                                  53010005
530200                                   TO TRUE                        53020005
530300             PERFORM DP013-0000-PROCESS-ABEND                     53030005
530400     END-EVALUATE.                                                53040005
530500 7410-OPEN-TDISTDT-CSR.                                           53050005
530600                                                                  53060005
530700     EXEC SQL                                                     53070005
530800         OPEN TDISTDT-CSR                                         53080005
530900     END-EXEC                                                     53090005
531000                                                                  53100005
531100     EVALUATE TRUE                                                53110005
531200         WHEN SQLCODE = ZERO                                      53120005
531300              CONTINUE                                            53130005
531400         WHEN SQLCODE = -904                                      53140005
531500         WHEN SQLCODE = -911                                      53150005
531600         WHEN SQLCODE = -913                                      53160005
531700             PERFORM 9900-SOFT-ABORT                              53170005
531800         WHEN SQLWARN0 NOT = SPACE                                53180005
531900         WHEN SQLCODE  NOT = ZERO                                 53190005
532000             MOVE '7410-OPEN-DISTDT-CSR'                          53200005
532100                                   TO DP013-PARAGRAPH             53210005
532200             MOVE 'OPEN DISTDT-CSR CURSOR'                        53220005
532300                                   TO DP013-MESSAGE-TEXT (1)      53230005
532400             MOVE SQLCA       TO DP013-SQLCA                      53240005
532500             MOVE 'TDISTDT'   TO DP013-DB2-TABLE-NAME (1)         53250005
532600             SET DP013-DB2-ABEND                                  53260005
532700                                   TO TRUE                        53270005
532800             PERFORM DP013-0000-PROCESS-ABEND                     53280005
532900     END-EVALUATE.                                                53290005
533000                                                                  53300005
533100 7411-FETCH-TDISTDT-CSR.                                          53310005
533200     EXEC SQL                                                     53320005
533300         FETCH TDISTDT-CSR                                        53330005
533400          INTO                                                    53340005
533500             :DISTDT-STR-NBR                                      53350005
533600     END-EXEC.                                                    53360005
533700                                                                  53370005
533800     EVALUATE TRUE                                                53380005
533900         WHEN SQLCODE = ZERO                                      53390005
534000              CONTINUE                                            53400005
534100         WHEN SQLCODE = +100                                      53410005
534200              SET PS-EOF-TDISTDT-CSR                              53420005
534300                                   TO TRUE                        53430005
534400         WHEN SQLCODE = -904                                      53440005
534500         WHEN SQLCODE = -911                                      53450005
534600         WHEN SQLCODE = -913                                      53460005
534700             PERFORM 9900-SOFT-ABORT                              53470005
534800                                                                  53480005
534900         WHEN SQLWARN0 NOT = SPACE                                53490005
535000         WHEN SQLCODE < ZERO                                      53500005
535100         WHEN SQLCODE > ZERO                                      53510005
535200              MOVE '7411-FETCH-DISTDT-CSR' TO DP013-PARAGRAPH     53520005
535300              MOVE 'FETCH INVPAR CURSOR'                          53530005
535400                                      TO DP013-MESSAGE-TEXT (1)   53540005
535500              MOVE SQLCA              TO DP013-SQLCA              53550005
535600              MOVE 'TDISTDT'          TO DP013-DB2-TABLE-NAME (1) 53560005
535700              SET DP013-DB2-ABEND     TO TRUE                     53570005
535800              PERFORM DP013-0000-PROCESS-ABEND                    53580005
535900     END-EVALUATE.                                                53590005
536000                                                                  53600005
536100 7412-CLOSE-TDISTDT-CSR.                                          53610005
536200     EXEC SQL                                                     53620005
536300         CLOSE TDISTDT-CSR                                        53630005
536400     END-EXEC                                                     53640005
536500                                                                  53650005
536600     EVALUATE TRUE                                                53660005
536700         WHEN SQLCODE = ZERO                                      53670005
536800              CONTINUE                                            53680005
536900         WHEN SQLCODE = -904                                      53690005
537000         WHEN SQLCODE = -911                                      53700005
537100         WHEN SQLCODE = -913                                      53710005
537200             PERFORM 9900-SOFT-ABORT                              53720005
537300         WHEN SQLWARN0 NOT = SPACE                                53730005
537400         WHEN SQLCODE  NOT = ZERO                                 53740005
537500             MOVE '7412-CLOSE-DISTDT-CSR'                         53750005
537600                                   TO DP013-PARAGRAPH             53760005
537700             MOVE 'CLOSE INVPAR-CSR CURSOR'                       53770005
537800                                   TO DP013-MESSAGE-TEXT (1)      53780005
537900             MOVE SQLCA       TO DP013-SQLCA                      53790005
538000             MOVE 'TDISTDT'   TO DP013-DB2-TABLE-NAME (1)         53800005
538100             SET DP013-DB2-ABEND                                  53810005
538200                                   TO TRUE                        53820005
538300             PERFORM DP013-0000-PROCESS-ABEND                     53830005
538400     END-EVALUATE.                                                53840005
538500 7415-SELECT-TRECDIS.                                             53850005
538600     INITIALIZE PV-STORE-COUNT.                                   53860005
538700                                                                  53870005
538800     EXEC SQL                                                     53880005
538900         SELECT  COUNT(*)                                         53890005
539000           INTO  :PV-STORE-COUNT                                  53900005
539100           FROM  TRECDIS                                          53910005
539200          WHERE  ORD_NBR         = :DK-ORD-NBR                    53920005
539300            AND  REC_SEQ_NBR     = :DK-RCVR-NBR                   53930005
539400            AND  ORD_LNE_NBR     = :DK-LINE-NBR                   53940005
539500            AND  OPER_UNT_ID     = :DK-OPER-UNT-ID                53950005
539600            AND  FCLTY_ID        = :DK-FCLTY-ID                   53960005
539700            AND  STR_NBR         = :DISTDT-STR-NBR                53970005
539900     END-EXEC.                                                    53990005
540000                                                                  54000005
540100     EVALUATE TRUE                                                54010005
540200         WHEN SQLCODE = ZERO                                      54020005
540300         WHEN SQLCODE = +100                                      54030005
540400              CONTINUE                                            54040005
540500         WHEN SQLCODE = -904                                      54050005
540600         WHEN SQLCODE = -911                                      54060005
540700         WHEN SQLCODE = -913                                      54070005
540800             PERFORM 9900-SOFT-ABORT                              54080005
540900                                                                  54090005
541000         WHEN SQLWARN0 NOT = SPACES                               54100005
541100         WHEN SQLCODE < ZERO                                      54110005
541200         WHEN SQLCODE > ZERO                                      54120005
541300             MOVE '7415-SELECT-TRECDIS'                           54130005
541400                                  TO DP013-PARAGRAPH              54140005
541500             MOVE 'UNSUCCESSFUL COUNT OF TRECDIS ROWS'            54150005
541600                                  TO DP013-MESSAGE-TEXT (1)       54160005
541700             MOVE SQLCA      TO DP013-SQLCA                       54170005
541800             MOVE 'TRECDIS ' TO DP013-DB2-TABLE-NAME (1)          54180005
541900             SET DP013-DB2-ABEND                                  54190005
542000                  DP013-NO-ROLLBACK                               54200005
542100                                  TO TRUE                         54210005
542200             PERFORM DP013-0000-PROCESS-ABEND                     54220005
542300     END-EVALUATE.                                                54230005
542400                                                                  54240005
542500 7450-SELECT-TDISTHD.                                             54250005
542600                                                                  54260005
542700     INITIALIZE DCLTDISTHD                                        54270005
542800     EXEC SQL                                                     54280005
542900     SELECT OTPK_UNT_QTY                                          54290005
543000        ,   INPK_UNT_QTY                                          54300005
543100        ,   RSLTS_RCVD_TMST                                       54310005
543200        ,   CHAR(DATE(A.FCSE_CNFRMN_TMST),USA)                    54320005
543300        ,   CHAR(TIME(A.FCSE_CNFRMN_TMST),JIS)                    54330005
543400        ,   PRCG_STAT_CDE                                         54340005
543500        ,   INPK_CNVYB_IND                                        54350005
543600        ,   INPK_UNT_QTY                                          54360005
543700        ,   P2L_CART_CNT                                          54370005
543800        ,   FCSE_CNFRMN_USR_ID                                    54380005
543900        ,   INPK_CART_CNT                                         54390005
544000        ,   FCSE_CART_CNT                                         54400005
544100        INTO :DISTHD-OTPK-UNT-QTY                                 54410005
544200        ,    :DISTHD-INPK-UNT-QTY                                 54420005
544300        ,    :DISTHD-RSLTS-RCVD-TMST                              54430005
544400        ,    :PV-DATE                                             54440005
544500        ,    :PV-TIME                                             54450005
544600        ,    :DISTHD-PRCG-STAT-CDE                                54460005
544700        ,    :DISTHD-INPK-CNVYB-IND                               54470005
544800        ,    :DISTHD-INPK-UNT-QTY                                 54480005
544900        ,    :DISTHD-P2L-CART-CNT                                 54490005
545000        ,    :DISTHD-FCSE-CNFRMN-USR-ID                           54500005
545100        ,    :DISTHD-INPK-CART-CNT                                54510005
545200        ,    :DISTHD-FCSE-CART-CNT                                54520005
545300        FROM  TDISTHD A                                           54530005
545400      WHERE ORD_NBR                  = :DK-ORD-NBR                54540005
545500        AND RCVR_SEQ_NBR             = :DK-RCVR-NBR               54550005
545600        AND ORD_LNE_NBR              = :DK-LINE-NBR               54560005
545700     END-EXEC.                                                    54570005
545800                                                                  54580005
545900     EVALUATE TRUE                                                54590005
546000         WHEN SQLCODE = ZERO                                      54600005
546100         WHEN SQLCODE = +100                                      54610005
546200              CONTINUE                                            54620005
546300         WHEN SQLCODE = -904                                      54630005
546400         WHEN SQLCODE = -911                                      54640005
546500         WHEN SQLCODE = -913                                      54650005
546600             PERFORM 9900-SOFT-ABORT                              54660005
546700                                                                  54670005
546800         WHEN SQLWARN0 NOT = SPACES                               54680005
546900         WHEN SQLCODE < ZERO                                      54690005
547000         WHEN SQLCODE > ZERO                                      54700005
547100             MOVE '7450-SELECT-TDISTHD'                           54710005
547200                                  TO DP013-PARAGRAPH              54720005
547300             MOVE 'UNSUCCESSFUL SELECT OF TDISTHD '               54730005
547400                                  TO DP013-MESSAGE-TEXT (1)       54740005
547500             MOVE SQLCA      TO DP013-SQLCA                       54750005
547600             MOVE 'TDISTHD ' TO DP013-DB2-TABLE-NAME (1)          54760005
547700             SET DP013-DB2-ABEND                                  54770005
547800                  DP013-NO-ROLLBACK                               54780005
547900                                  TO TRUE                         54790005
548000             PERFORM DP013-0000-PROCESS-ABEND                     54800005
548100     END-EVALUATE.                                                54810005
548200                                                                  54820005
548300                                                                  54830005
548400 7480-SELECT-TDISTHD.                                             54840005
548500                                                                  54850005
548600     EXEC SQL                                                     54860005
548700     SELECT OTPK_UNT_QTY                                          54870005
548800        ,   INPK_UNT_QTY                                          54880005
548900        INTO :PV-OTPK-UNT-QTY                                     54890005
549000        ,    :PV-INPK-UNT-QTY                                     54900005
549100        FROM  TDISTHD A                                           54910005
549200      WHERE ORD_NBR                  = :DK-ORD-NBR                54920005
549300        AND RCVR_SEQ_NBR             = :DK-RCVR-NBR               54930005
549400        AND ORD_LNE_NBR              = :DK-DRIVER-LINE-NBR        54940005
549500     END-EXEC.                                                    54950005
549600                                                                  54960005
549700     EVALUATE TRUE                                                54970005
549800         WHEN SQLCODE = ZERO                                      54980005
549900         WHEN SQLCODE = +100                                      54990005
550000              CONTINUE                                            55000005
550100         WHEN SQLCODE = -904                                      55010005
550200         WHEN SQLCODE = -911                                      55020005
550300         WHEN SQLCODE = -913                                      55030005
550400             PERFORM 9900-SOFT-ABORT                              55040005
550500                                                                  55050005
550600         WHEN SQLWARN0 NOT = SPACES                               55060005
550700         WHEN SQLCODE < ZERO                                      55070005
550800         WHEN SQLCODE > ZERO                                      55080005
550900             MOVE '7480-SELECT-TDISTHD'                           55090005
551000                                  TO DP013-PARAGRAPH              55100005
551100             MOVE 'UNSUCCESSFUL SELECT OF TDISTHD '               55110005
551200                                  TO DP013-MESSAGE-TEXT (1)       55120005
551300             MOVE SQLCA      TO DP013-SQLCA                       55130005
551400             MOVE 'TDISTHD ' TO DP013-DB2-TABLE-NAME (1)          55140005
551500             SET DP013-DB2-ABEND                                  55150005
551600                  DP013-NO-ROLLBACK                               55160005
551700                                  TO TRUE                         55170005
551800             PERFORM DP013-0000-PROCESS-ABEND                     55180005
551900     END-EVALUATE.                                                55190005
552000                                                                  55200005
552100 7500-RECITM-STATUS.                                              55210005
552200                                                                  55220005
552300     EXEC SQL                                                     55230005
552400     SELECT                                                       55240005
552500            A.STATUS_CDE                                          55250005
552600         INTO                                                     55260005
552700              :RECITM-STATUS-CDE                                  55270005
552800         FROM                                                     55280005
552900             TRECITM A                                            55290005
553000         WHERE A.ORD_NBR          = :DK-ORD-NBR                   55300005
553100         AND A.REC_SEQ_NBR        = :DK-RCVR-NBR                  55310005
553200         AND A.ORD_LNE_NBR        = :DK-LINE-NBR                  55320005
553300         AND A.VER_STATUS_CDE     = 'A'                           55330005
553400     END-EXEC.                                                    55340005
553500                                                                  55350005
553600     EVALUATE TRUE                                                55360005
553700         WHEN SQLCODE = ZERO                                      55370005
553800             CONTINUE                                             55380005
553900         WHEN SQLCODE = +100                                      55390005
554000             MOVE SPACES              TO RECITM-STATUS-CDE        55400005
554100         WHEN SQLCODE = -904                                      55410005
554200         WHEN SQLCODE = -911                                      55420005
554300         WHEN SQLCODE = -913                                      55430005
554400             PERFORM 9900-SOFT-ABORT                              55440005
554500                                                                  55450005
554600         WHEN SQLWARN0 NOT = SPACES                               55460005
554700         WHEN SQLCODE < ZERO                                      55470005
554800         WHEN SQLCODE > ZERO                                      55480005
554900             MOVE '7500-RECITM-STATUS'                            55490005
555000                                  TO DP013-PARAGRAPH              55500005
555100             MOVE 'UNSUCCESSFUL COUNT OF VERIFIED LINES'          55510005
555200                                  TO DP013-MESSAGE-TEXT (1)       55520005
555300             MOVE SQLCA      TO DP013-SQLCA                       55530005
555400             MOVE 'TRECITM ' TO DP013-DB2-TABLE-NAME (1)          55540005
555500             SET DP013-DB2-ABEND                                  55550005
555600                 DP013-NO-ROLLBACK                                55560005
555700                                  TO TRUE                         55570005
555800             PERFORM DP013-0000-PROCESS-ABEND                     55580005
555900     END-EVALUATE.                                                55590005
556000                                                                  55600005
556100 7550-FREIGHT-BILL.                                               55610005
556200                                                                  55620005
556300     MOVE ZERO                        TO PV-FREIGHT-COUNT         55630005
556400     EXEC SQL                                                     55640005
556500         SELECT COUNT(*)                                          55650005
556600         INTO :PV-FREIGHT-COUNT                                   55660005
556700         FROM TSHIPMT A                                           55670005
556800         ,    TSHPTPO B                                           55680005
556900         WHERE B.PO_NBR      = :DK-ORD-NBR                        55690005
557000           AND B.REC_SEQ_NBR = :DK-RCVR-NBR                       55700005
557100           AND A.SHIPT_ID    = B.SHIPT_ID                         55710005
557200           AND A.PRO_NBR <> :PC-SPACES                            55720005
557300     END-EXEC                                                     55730005
557400                                                                  55740005
557500     EVALUATE TRUE                                                55750005
557600         WHEN SQLCODE = ZERO                                      55760005
557700             IF PV-FREIGHT-COUNT = ZERO                           55770005
557800                 SET PS-DONT-SUBMIT-E200   TO TRUE                55780005
557900             END-IF                                               55790005
558000         WHEN SQLCODE = +100                                      55800005
558100             CONTINUE                                             55810005
558200         WHEN SQLCODE = -904                                      55820005
558300         WHEN SQLCODE = -911                                      55830005
558400         WHEN SQLCODE = -913                                      55840005
558500             PERFORM 9900-SOFT-ABORT                              55850005
558600                                                                  55860005
558700         WHEN SQLWARN0 NOT = SPACES                               55870005
558800         WHEN SQLCODE < ZERO                                      55880005
558900         WHEN SQLCODE > ZERO                                      55890005
559000             MOVE '7550-FREIGHT-BILL'                             55900005
559100                                  TO DP013-PARAGRAPH              55910005
559200             MOVE 'UNSUCCESSFUL COUNT OF SHIPMENT ROWS'           55920005
559300                                  TO DP013-MESSAGE-TEXT (1)       55930005
559400             MOVE SQLCA      TO DP013-SQLCA                       55940005
559500             MOVE 'TSHIPMT ' TO DP013-DB2-TABLE-NAME (1)          55950005
559600             MOVE 'TSHPTPO ' TO DP013-DB2-TABLE-NAME (2)          55960005
559700             SET DP013-DB2-ABEND                                  55970005
559800                 DP013-NO-ROLLBACK                                55980005
559900                                  TO TRUE                         55990005
560000              PERFORM DP013-0000-PROCESS-ABEND                    56000005
560100     END-EVALUATE.                                                56010005
560200                                                                  56020005
560300                                                                  56030005
560400 7590-GET-PREPK-ID.                                               56040005
560500     EXEC SQL                                                     56050005
560600          SELECT  A.PREPK_ID                                      56060005
560700               ,  B.PK_SKU_NBR                                    56070005
560800            INTO :RECITM-PREPK-ID                                 56080005
560900               , :POPRPK-PK-SKU-NBR                               56090005
561000            FROM  TRECITM A                                       56100005
561100                , TPOPRPK B                                       56110005
561200           WHERE  A.ORD_NBR          =  :DK-ORD-NBR               56120005
561300           AND    A.ORD_NBR          =  B.PO_NBR                  56130005
561400           AND    A.REC_SEQ_NBR      =  :DK-RCVR-NBR              56140005
561500           AND    A.ORD_LNE_NBR      =  :DK-LINE-NBR              56150005
561600           AND    A.VER_STATUS_CDE   =  'A'                       56160005
561700           AND    A.PREPK_ID         =  B.PO_PREPK_ID             56170005
561800     END-EXEC                                                     56180005
561900                                                                  56190005
562000     EVALUATE TRUE                                                56200005
562100         WHEN SQLCODE = ZERO                                      56210005
562200              CONTINUE                                            56220005
562300                                                                  56230005
562400         WHEN SQLCODE = +100                                      56240005
562500              MOVE +0 TO RECITM-PREPK-ID                          56250005
562600                                                                  56260005
562700         WHEN SQLCODE = -904                                      56270005
562800         WHEN SQLCODE = -911                                      56280005
562900         WHEN SQLCODE = -913                                      56290005
563000             PERFORM 9900-SOFT-ABORT                              56300005
563100                                                                  56310005
563200         WHEN SQLWARN0 NOT = SPACES                               56320005
563300         WHEN SQLCODE < ZERO                                      56330005
563400         WHEN SQLCODE > ZERO                                      56340005
563500             MOVE '7590-GET-PREPK-ID'                             56350005
563600                                  TO DP013-PARAGRAPH              56360005
563700             MOVE 'UNSUCCESSFUL SELECT FOR PREPK-ID  '            56370005
563800                                  TO DP013-MESSAGE-TEXT (1)       56380005
563900             MOVE SQLCA      TO DP013-SQLCA                       56390005
564000             MOVE 'TRECITM ' TO DP013-DB2-TABLE-NAME (1)          56400005
564100             SET DP013-DB2-ABEND                                  56410005
564200                  DP013-NO-ROLLBACK                               56420005
564300                                  TO TRUE                         56430005
564400             PERFORM DP013-0000-PROCESS-ABEND                     56440005
564500     END-EVALUATE.                                                56450005
564600                                                                  56460005
564700                                                                  56470005
564800 7591-GET-PREPK-DRV-LNE.                                          56480005
564900     EXEC SQL                                                     56490005
565000          SELECT  A.ORD_LNE_NBR                                   56500005
565100               ,  A.PREPK_RATO_QTY                                56510005
565200               ,  A.PREPK_ODD_UNT_QTY                             56520005
565300            INTO :RECITM-ORD-LNE-NBR                              56530005
565400               , :RECITM-PREPK-RATO-QTY                           56540005
565500               , :RECITM-PREPK-ODD-UNT-QTY                        56550005
565600            FROM  TRECITM A                                       56560005
565700               ,  TDISTHD B                                       56570005
565800           WHERE  A.ORD_NBR           =  :DK-ORD-NBR              56580005
565900             AND  A.REC_SEQ_NBR       =  :DK-RCVR-NBR             56590005
566000             AND  A.PREPK_ID          =  :DK-PACK-ID              56600005
566100                                                                  56610005
566200             AND  B.ORD_NBR           =  :DK-ORD-NBR              56620005
566300             AND  B.RCVR_SEQ_NBR      =  :DK-RCVR-NBR             56630005
566400             AND  B.ORD_LNE_NBR       =  A.ORD_LNE_NBR            56640005
566500             AND  B.PREPK_LNE_PRC_CDE =  'D'                      56650005
566600     END-EXEC                                                     56660005
566700                                                                  56670005
566800     EVALUATE TRUE                                                56680005
566900         WHEN SQLCODE = ZERO                                      56690005
567000             MOVE RECITM-ORD-LNE-NBR TO ASC-DRV-LNE-NBR           56700005
567100                                                                  56710005
567200         WHEN SQLCODE = +100                                      56720005
567300              MOVE +0 TO RECITM-ORD-LNE-NBR                       56730005
567400                         RECITM-PREPK-RATO-QTY                    56740005
567500                                                                  56750005
567600         WHEN SQLCODE = -904                                      56760005
567700         WHEN SQLCODE = -911                                      56770005
567800         WHEN SQLCODE = -913                                      56780005
567900             PERFORM 9900-SOFT-ABORT                              56790005
568000                                                                  56800005
568100         WHEN SQLWARN0 NOT = SPACES                               56810005
568200         WHEN SQLCODE < ZERO                                      56820005
568300         WHEN SQLCODE > ZERO                                      56830005
568400             MOVE '7591-GET-PREPK-DRV-LNE'                        56840005
568500                                  TO DP013-PARAGRAPH              56850005
568600             MOVE 'UNSUCCESSFUL SELECT FOR PREPK DRV LNE'         56860005
568700                                  TO DP013-MESSAGE-TEXT (1)       56870005
568800             MOVE SQLCA      TO DP013-SQLCA                       56880005
568900             MOVE 'TRECITM ' TO DP013-DB2-TABLE-NAME (1)          56890005
569000             SET DP013-DB2-ABEND                                  56900005
569100                  DP013-NO-ROLLBACK                               56910005
569200                                  TO TRUE                         56920005
569300             PERFORM DP013-0000-PROCESS-ABEND                     56930005
569400     END-EVALUATE.                                                56940005
569500                                                                  56950005
569600                                                                  56960005
569700 7600-COUNT-LINE-TROUBLES.                                        56970005
569800     MOVE ZERO TO PV-TROUBLE-COUNT.                               56980005
569900                                                                  56990005
570000     EXEC SQL                                                     57000005
570100         SELECT COUNT(*)                                          57010005
570200             INTO :PV-TROUBLE-COUNT :PV-NULL-IND                  57020005
570300             FROM TTRBNTF A                                       57030005
570400                 ,TTRBRSN B                                       57040005
570500             WHERE   A.PO_NBR          =   :DK-ORD-NBR            57050005
570600               AND   A.REC_SEQ_NBR     =   :DK-RCVR-NBR           57060005
570700               AND ((A.PO_LNE_NBR      =   :DK-LINE-NBR           57070005
570800               AND   B.TRBL_LVL_IND     <> :PC-M)                 57080005
570900               OR   (A.PREPK_ID        =   :RECITM-PREPK-ID       57090005
571000               AND   B.TRBL_LVL_IND     =  :PC-M))                57100005
571100               AND   A.RESOLVED_IND    IN ('N', 'I', 'R')         57110005
571200               AND   A.TRBL_RSN_CDE    =   B.TRBL_RSN_CDE         57120005
571300               AND   B.NOTIF_IND       =   'T'                    57130005
571400         END-EXEC                                                 57140005
571500                                                                  57150005
571600     EVALUATE TRUE                                                57160005
571700         WHEN SQLCODE = ZERO                                      57170005
571800             IF PV-TROUBLE-COUNT > ZERO                           57180005
571900                 SET PS-DONT-SUBMIT-E200   TO TRUE                57190005
572000             END-IF                                               57200005
572100         WHEN SQLCODE = +100                                      57210005
572200             CONTINUE                                             57220005
572300         WHEN SQLCODE = -904                                      57230005
572400         WHEN SQLCODE = -911                                      57240005
572500         WHEN SQLCODE = -913                                      57250005
572600             PERFORM 9900-SOFT-ABORT                              57260005
572700                                                                  57270005
572800         WHEN SQLWARN0 NOT = SPACES                               57280005
572900         WHEN SQLCODE < ZERO                                      57290005
573000         WHEN SQLCODE > ZERO                                      57300005
573100             MOVE '7600-COUNT-LINE-TROUBLES'                      57310005
573200                                  TO DP013-PARAGRAPH              57320005
573300             MOVE 'UNSUCCESSFUL COUNT OF SHIPMENT ROWS'           57330005
573400                                  TO DP013-MESSAGE-TEXT (1)       57340005
573500             MOVE SQLCA      TO DP013-SQLCA                       57350005
573600             MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)          57360005
573700             SET DP013-DB2-ABEND                                  57370005
573800                 DP013-NO-ROLLBACK                                57380005
573900                                  TO TRUE                         57390005
574000              PERFORM DP013-0000-PROCESS-ABEND                    57400005
574100     END-EVALUATE.                                                57410005
574200                                                                  57420005
578100*----------------------------------------------------------------*57810005
578200 7700-GET-TDISTDT.                                                57820005
578300                                                                  57830005
578400      EXEC SQL                                                    57840005
578500         SELECT PREPK_ODD_UNT_QTY                                 57850005
578600           INTO :DISTDT-PREPK-ODD-UNT-QTY                         57860005
578700           FROM TDISTDT                                           57870005
578800          WHERE ORD_NBR       = :DK-ORD-NBR                       57880005
578900            AND RCVR_SEQ_NBR  = :DK-RCVR-NBR                      57890005
579000            AND ORD_LNE_NBR   = :DK-LINE-NBR                      57900005
579100            AND STR_NBR       = :DK-STR-NBR                       57910005
579200      END-EXEC.                                                   57920005
579300                                                                  57930005
579400      EVALUATE TRUE                                               57940005
579500        WHEN SQLCODE = ZERO                                       57950005
579600            CONTINUE                                              57960005
579700                                                                  57970005
579800        WHEN SQLCODE = -904                                       57980005
579900        WHEN SQLCODE = -911                                       57990005
580000        WHEN SQLCODE = -913                                       58000005
580100            PERFORM 9900-SOFT-ABORT                               58010005
580200                                                                  58020005
580300        WHEN SQLWARN0 NOT = SPACES                                58030005
580400        WHEN SQLCODE < ZERO                                       58040005
580500        WHEN SQLCODE > ZERO                                       58050005
580600            MOVE '7700-GET-TDISTDT' TO DP013-PARAGRAPH            58060005
580700            MOVE 'UNSUCCESSFUL SELECT OF STORE'                   58070005
580800                                  TO DP013-MESSAGE-TEXT (1)       58080005
580900            MOVE SQLCA            TO DP013-SQLCA                  58090005
581000            MOVE 'TDISTDT '       TO DP013-DB2-TABLE-NAME (1)     58100005
581100            SET DP013-DB2-ABEND                                   58110005
581200                DP013-NO-ROLLBACK TO TRUE                         58120005
581300            PERFORM DP013-0000-PROCESS-ABEND                      58130005
581400     END-EVALUATE.                                                58140005
581500                                                                  58150005
581600*----------------------------------------------------------------*58160005
581700*  THIS PARAGRAPH WILL BE USED TO GET SOME FIELDS TO DETERMINE   *58170005
581800*  IF THE UNITS WORKED MODULE NEEDS TO BE CALLED (IF THE FULL-   *58180005
581900*  CASE TIMESTAMP IS A VALUE OTHER THAN 9'S, THEN THE LINE IS    *58190005
582000*  CONFIRMED AND THE UNITS WORKED MODULE WILL NEED TO BE CALLED  *58200005
582100*  FOR CONFIRMATION UNIT ADJUSTMENTS.  THE OTHER FIELDS ARE USED *58210005
582200*  BY THE MODULE TO DETERMINE THE RETAIL VALUE OF THE ADJUSTMENT *58220005
582300*  AND WHAT OPER UNIT AND PROCESS AREA THE ADJUSTMENT SHOULD BE  *58230005
582400*  POSTED TO WITHIN THE UNITS WORKED SYSTEM.                     *58240005
582500*----------------------------------------------------------------*58250005
582600 7750-DISTHD-PURITM-JOIN.                                         58260005
582700                                                                  58270005
582800     EXEC SQL                                                     58280005
582900     SELECT A.FCSE_CNFRMN_TMST,                                   58290005
583000            C.UNT_RTL_PR_AMT,                                     58300005
583100            A.OPER_UNT_ID,                                        58310005
583200            A.FCSE_FCLTY_AREA_ID                                  58320005
583300         INTO :PV-DISTHD-FCSE-CNFRMN-TMST                         58330005
583400         ,    :PURITM-UNT-RTL-PR-AMT                              58340005
583500         ,    :PV-DISTHD-OPER-UNT-ID                              58350005
583600         ,    :PV-DISTHD-FCSE-FCLTY-AREA-ID                       58360005
583700         FROM                                                     58370005
583800             TDISTHD A                                            58380005
583900         ,   TRECITM B                                            58390005
584000         ,   TPURITM C                                            58400005
584100         WHERE A.ORD_NBR          = :DK-ORD-NBR                   58410005
584200           AND A.RCVR_SEQ_NBR     = :DK-RCVR-NBR                  58420005
584300           AND A.ORD_LNE_NBR      = :DK-LINE-NBR                  58430005
584400           AND B.ORD_NBR          = A.ORD_NBR                     58440005
584500           AND B.REC_SEQ_NBR      = A.RCVR_SEQ_NBR                58450005
584600           AND B.ORD_LNE_NBR      = A.ORD_LNE_NBR                 58460005
584700           AND C.PO_NBR           = B.ORD_NBR                     58470005
584800           AND C.APP_PO_LNE_NBR   = B.ORD_LNE_NBR                 58480005
584900           AND C.VER_NBR          = B.PO_VER_NBR                  58490005
585000     END-EXEC.                                                    58500005
585100*                                                                 58510005
585200     EVALUATE TRUE                                                58520005
585300         WHEN SQLCODE = ZERO                                      58530005
585400             CONTINUE                                             58540005
585500         WHEN SQLCODE = -904                                      58550005
585600         WHEN SQLCODE = -911                                      58560005
585700         WHEN SQLCODE = -913                                      58570005
585800             PERFORM 9900-SOFT-ABORT                              58580005
585900                                                                  58590005
586000         WHEN SQLWARN0 NOT = SPACES                               58600005
586100         WHEN SQLCODE < ZERO                                      58610005
586200         WHEN SQLCODE > ZERO                                      58620005
586300             MOVE '7750-DISTHD-PURITM-JOIN'                       58630005
586400                                  TO DP013-PARAGRAPH              58640005
586500             MOVE 'UNSUCCESSFUL JOIN OF 3 TABLES'                 58650005
586600                                  TO DP013-MESSAGE-TEXT (1)       58660005
586700             MOVE SQLCA      TO DP013-SQLCA                       58670005
586800             MOVE 'TDISTHD ' TO DP013-DB2-TABLE-NAME (1)          58680005
586900             SET DP013-DB2-ABEND                                  58690005
587000                 DP013-NO-ROLLBACK                                58700005
587100                                  TO TRUE                         58710005
587200             PERFORM DP013-0000-PROCESS-ABEND                     58720005
587300     END-EVALUATE.                                                58730005
587400                                                                  58740005
587500*----------------------------------------------------------------*58750005
587600* THIS PARAGRAPH WILL FORMAT ALL OF THE DATA NEEDED FOR THE      *58760005
587700* UNITS WORKED ROUTINE AND WILL THEN CALL THE ROUTINE AND        *58770005
587800* THE RESULTS RETURNED FROM THE ROUTINE.                         *58780005
587900*----------------------------------------------------------------*58790005
588000 7800-UNITS-WORK-ROUTINE.                                         58800005
588100                                                                  58810005
588200     INITIALIZE PC238-COMM-AREA.                                  58820005
588300                                                                  58830005
588400     EXEC SQL                                                     58840005
588500         SET :PV-TMST =  CURRENT_TIMESTAMP                        58850005
588600     END-EXEC                                                     58860005
588700                                                                  58870005
588800     MOVE PV-TMST                 TO PC238-WRKD-TMST.             58880005
588900                                                                  58890005
589000     MOVE PV-DISTHD-OPER-UNT-ID   TO PC238-WRKD-OPER-UNT-ID.      58900005
589100     MOVE PV-DISTHD-FCSE-FCLTY-AREA-ID                            58910005
589200                                  TO PC238-PRCG-AREA-CDE.         58920005
589300     MOVE DK-ORD-NBR              TO PC238-PO-NBR.                58930005
589400     MOVE DK-RCVR-NBR             TO PC238-RCVR-SEQ-NBR.          58940005
589500     MOVE DK-LINE-NBR             TO PC238-PO-LNE-NBR.            58950005
589600                                                                  58960005
589700     MOVE PA-ACCUM-UPDATE-QTY     TO PC238-WRKD-UNT-QTY.          58970005
589800     MOVE PURITM-UNT-RTL-PR-AMT   TO PC238-UNT-RETAIL-PRC.        58980005
589900     SET  PC238-TRANS-CONFIRM-ADJ TO TRUE.                        58990005
590000     SET  PC238-NOT-VERIFY        TO TRUE.                        59000005
590100                                                                  59010005
590200************************************************                  59020005
590300*                                                                 59030005
590400*    MOVE PC238-PO-NBR       TO PC-DISPLAY-PO.                    59040005
590500*    MOVE PC238-RCVR-SEQ-NBR TO PC-DISPLAY-RCVR.                  59050005
590600*    MOVE PC238-PO-LNE-NBR   TO PC-DISPLAY-LINE.                  59060005
590700*    MOVE PC238-WRKD-OPER-UNT-ID                                  59070005
590800*                            TO PC-DISPLAY-OPER.                  59080005
590900*    STRING ' RCKCS298 - '      DELIMITED BY SIZE                 59090005
591000*           ' CALLING PCKCS756 WITH KEY INFO - '                  59100005
591100*                               DELIMITED BY SIZE                 59110005
591200*           PC-DISPLAY-PO       DELIMITED BY SIZE                 59120005
591300*           ' - '               DELIMITED BY SIZE                 59130005
591400*           PC-DISPLAY-RCVR     DELIMITED BY SIZE                 59140005
591500*           ' - '               DELIMITED BY SIZE                 59150005
591600*           PC-DISPLAY-LINE     DELIMITED BY SIZE                 59160005
591700*           ' - '               DELIMITED BY SIZE                 59170005
591800*           PC-DISPLAY-OPER     DELIMITED BY SIZE                 59180005
591900*                        INTO PV-CICS-MSG-AREA.                   59190005
592000*    MOVE LENGTH OF PV-CICS-MSG-AREA                              59200005
592100*                          TO PV-COMMAREA-LENGTH.                 59210005
592200*    PERFORM 9200-WRITE-TO-CICS-LOG.                              59220005
592300*                                                                 59230005
592400************************************************                  59240005
592500                                                                  59250005
592600     MOVE LENGTH OF PC238-COMM-AREA                               59260005
592700                                  TO PV-COMMAREA-LENGTH.          59270005
592800                                                                  59280005
592900     EXEC CICS                                                    59290005
593000         LINK PROGRAM  (PV-PCKCS756)                              59300005
593100              COMMAREA (PC238-COMM-AREA)                          59310005
593200              LENGTH   (PV-COMMAREA-LENGTH)                       59320005
593300              RESP     (PV-CICS-RESPONSE)                         59330005
593400     END-EXEC.                                                    59340005
593500                                                                  59350005
593600************************************************                  59360005
593700*                                                                 59370005
593800*    MOVE PC238-PO-NBR       TO PC-DISPLAY-PO.                    59380005
593900*    MOVE PC238-RCVR-SEQ-NBR TO PC-DISPLAY-RCVR.                  59390005
594000*    MOVE PC238-PO-LNE-NBR   TO PC-DISPLAY-LINE.                  59400005
594100*    MOVE PC238-WRKD-OPER-UNT-ID                                  59410005
594200*                            TO PC-DISPLAY-OPER.                  59420005
594300*    STRING ' RCKCS298 - '      DELIMITED BY SIZE                 59430005
594400*           ' RETURN FROM PCKCS756 - '                            59440005
594500*                               DELIMITED BY SIZE                 59450005
594600*           PC-DISPLAY-PO       DELIMITED BY SIZE                 59460005
594700*           ' - '               DELIMITED BY SIZE                 59470005
594800*           PC-DISPLAY-RCVR     DELIMITED BY SIZE                 59480005
594900*           ' - '               DELIMITED BY SIZE                 59490005
595000*           PC-DISPLAY-LINE     DELIMITED BY SIZE                 59500005
595100*           ' - '               DELIMITED BY SIZE                 59510005
595200*           PC238-MOD-SUCCESS-CDE                                 59520005
595300*                               DELIMITED BY SIZE                 59530005
595400*           ' - '               DELIMITED BY SIZE                 59540005
595500*           PC238-UNSUCCESSFUL-CDE                                59550005
595600*                               DELIMITED BY SIZE                 59560005
595700*                        INTO PV-CICS-MSG-AREA.                   59570005
595800*    MOVE LENGTH OF PV-CICS-MSG-AREA                              59580005
595900*                          TO PV-COMMAREA-LENGTH.                 59590005
596000*    PERFORM 9200-WRITE-TO-CICS-LOG.                              59600005
596100*                                                                 59610005
596200************************************************                  59620005
596300                                                                  59630005
596400     EVALUATE TRUE                                                59640005
596500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 59650005
596600              IF  PC238-MOD-UNSUCCESSFUL                          59660005
596700                  PERFORM 7810-MOD-UNSUCCESSFUL                   59670005
596800              END-IF                                              59680005
596900         WHEN OTHER                                               59690005
597000              MOVE PC238-PO-NBR       TO PC-DISPLAY-PO            59700005
597100              MOVE PC238-RCVR-SEQ-NBR TO PC-DISPLAY-RCVR          59710005
597200              MOVE PC238-PO-LNE-NBR   TO PC-DISPLAY-LINE          59720005
597300              MOVE PC238-WRKD-OPER-UNT-ID                         59730005
597400                                      TO PC-DISPLAY-OPER          59740005
597500              MOVE PC238-BAD-SQL-CDE  TO PC-DISPLAY-SQL-CODE      59750005
597600              MOVE PV-CICS-RESPONSE   TO PC-DISPLAY-CICS-RESP     59760005
597700              SET PS-UNITS-WORKED-ERROR  TO TRUE                  59770005
597800              STRING ' RCKCS298 - '      DELIMITED BY SIZE        59780005
597900                     ' 7800-UNITS-WORK-ROUTINE '                  59790005
598000                                         DELIMITED BY SIZE        59800005
598100                     ' BAD CALL TO UNITS WORKED MODULE '          59810005
598200                                         DELIMITED BY SIZE        59820005
598300                     ' - CICS RESP '                              59830005
598400                                         DELIMITED BY SIZE        59840005
598500                     PC-DISPLAY-CICS-RESP                         59850005
598600                                         DELIMITED BY SIZE        59860005
598700                                      INTO PV-CICS-MSG-AREA       59870005
598800              MOVE LENGTH OF PV-CICS-MSG-AREA                     59880005
598900                                        TO PV-COMMAREA-LENGTH     59890005
599000              PERFORM 9200-WRITE-TO-CICS-LOG                      59900005
599100              MOVE SPACES TO PV-CICS-MSG-AREA                     59910005
599200              STRING ' RCKCS298 - '      DELIMITED BY SIZE        59920005
599300                     ' 7800-UNITS-WORK-ROUTINE '                  59930005
599400                                         DELIMITED BY SIZE        59940005
599500                     ' KEY INFO - '      DELIMITED BY SIZE        59950005
599600                     PC-DISPLAY-PO       DELIMITED BY SIZE        59960005
599700                     ' - '               DELIMITED BY SIZE        59970005
599800                     PC-DISPLAY-RCVR     DELIMITED BY SIZE        59980005
599900                     ' - '               DELIMITED BY SIZE        59990005
600000                     PC-DISPLAY-LINE     DELIMITED BY SIZE        60000005
600100                                  INTO PV-CICS-MSG-AREA           60010005
600200              MOVE LENGTH OF PV-CICS-MSG-AREA                     60020005
600300                                    TO PV-COMMAREA-LENGTH         60030005
600400              PERFORM 9200-WRITE-TO-CICS-LOG                      60040005
600500              PERFORM 9900-SOFT-ABORT                             60050005
600600     END-EVALUATE.                                                60060005
600700                                                                  60070005
600800*----------------------------------------------------------------*60080005
600900* THIS PARAGRAPH WILL MANAGE THE DISPLAY OF INFORMATION TO CSSL  *60090005
601000* FOR WHEN THE UNITS WORKED ROUTINE WAS UNSUCCESSFUL.  THIS      *60100005
601100* PARAGRAPH WILL FORMAT A MESSAGE AND GET IT WRITTEN TO THE      *60110005
601200* CICS LOG AND THEN SOFT ABORT THE PROGRAM.                      *60120005
601300*----------------------------------------------------------------*60130005
601400 7810-MOD-UNSUCCESSFUL.                                           60140005
601500                                                                  60150005
601600     MOVE PC238-PO-NBR              TO PC-DISPLAY-PO.             60160005
601700     MOVE PC238-RCVR-SEQ-NBR        TO PC-DISPLAY-RCVR.           60170005
601800     MOVE PC238-PO-LNE-NBR          TO PC-DISPLAY-LINE.           60180005
601900     MOVE PC238-WRKD-OPER-UNT-ID    TO PC-DISPLAY-OPER.           60190005
602000     MOVE PC238-BAD-SQL-CDE         TO PC-DISPLAY-SQL-CODE.       60200005
602100     SET  PS-UNITS-WORKED-ERROR     TO TRUE.                      60210005
602200                                                                  60220005
602300     IF  PC238-MOD-BAD-TMST                                       60230005
602400         STRING ' RCKCS298 - '      DELIMITED BY SIZE             60240005
602500                ' 7800-UNITS-WORK-ROUTINE '                       60250005
602600                                    DELIMITED BY SIZE             60260005
602700                ' BAD TIMESTAMP '   DELIMITED BY SIZE             60270005
602800                PC238-WRKD-TMST     DELIMITED BY SIZE             60280005
602900                             INTO PV-CICS-MSG-AREA                60290005
603000         MOVE LENGTH OF PV-CICS-MSG-AREA                          60300005
603100                               TO PV-COMMAREA-LENGTH              60310005
603200         PERFORM 9200-WRITE-TO-CICS-LOG                           60320005
603300         STRING ' RCKCS298 - '      DELIMITED BY SIZE             60330005
603400                ' 7800-UNITS-WORK-ROUTINE '                       60340005
603500                                    DELIMITED BY SIZE             60350005
603600                ' KEY INFO - '      DELIMITED BY SIZE             60360005
603700                PC-DISPLAY-PO       DELIMITED BY SIZE             60370005
603800                ' - '               DELIMITED BY SIZE             60380005
603900                PC-DISPLAY-RCVR     DELIMITED BY SIZE             60390005
604000                ' - '               DELIMITED BY SIZE             60400005
604100                PC-DISPLAY-LINE     DELIMITED BY SIZE             60410005
604200                             INTO PV-CICS-MSG-AREA                60420005
604300         MOVE LENGTH OF PV-CICS-MSG-AREA                          60430005
604400                               TO PV-COMMAREA-LENGTH              60440005
604500         PERFORM 9200-WRITE-TO-CICS-LOG                           60450005
604600         PERFORM 9900-SOFT-ABORT                                  60460005
604700     ELSE                                                         60470005
604800     IF  PC238-MOD-BAD-OPER                                       60480005
604900         STRING ' RCKCS298 - '      DELIMITED BY SIZE             60490005
605000                ' 7800-UNITS-WORK-ROUTINE '                       60500005
605100                                    DELIMITED BY SIZE             60510005
605200                ' BAD OPER UNIT '   DELIMITED BY SIZE             60520005
605300                PC-DISPLAY-OPER     DELIMITED BY SIZE             60530005
605400                             INTO PV-CICS-MSG-AREA                60540005
605500         MOVE LENGTH OF PV-CICS-MSG-AREA                          60550005
605600                               TO PV-COMMAREA-LENGTH              60560005
605700         PERFORM 9200-WRITE-TO-CICS-LOG                           60570005
605800         STRING ' RCKCS298 - '      DELIMITED BY SIZE             60580005
605900                ' 7800-UNITS-WORK-ROUTINE '                       60590005
606000                                    DELIMITED BY SIZE             60600005
606100                ' KEY INFO - '      DELIMITED BY SIZE             60610005
606200                PC-DISPLAY-PO       DELIMITED BY SIZE             60620005
606300                ' - '               DELIMITED BY SIZE             60630005
606400                PC-DISPLAY-RCVR     DELIMITED BY SIZE             60640005
606500                ' - '               DELIMITED BY SIZE             60650005
606600                PC-DISPLAY-LINE     DELIMITED BY SIZE             60660005
606700                             INTO PV-CICS-MSG-AREA                60670005
606800         MOVE LENGTH OF PV-CICS-MSG-AREA                          60680005
606900                               TO PV-COMMAREA-LENGTH              60690005
607000         PERFORM 9200-WRITE-TO-CICS-LOG                           60700005
607100         PERFORM 9900-SOFT-ABORT                                  60710005
607200     ELSE                                                         60720005
607300     IF  PC238-MOD-BAD-TRANS-TYPE                                 60730005
607400         STRING ' RCKCS298 - '      DELIMITED BY SIZE             60740005
607500                ' 7800-UNITS-WORK-ROUTINE '                       60750005
607600                                    DELIMITED BY SIZE             60760005
607700                ' BAD TRAN TYPE '   DELIMITED BY SIZE             60770005
607800                PC238-TRANS-TYPE-CDE                              60780005
607900                                    DELIMITED BY SIZE             60790005
608000                             INTO PV-CICS-MSG-AREA                60800005
608100         MOVE LENGTH OF PV-CICS-MSG-AREA                          60810005
608200                               TO PV-COMMAREA-LENGTH              60820005
608300         PERFORM 9200-WRITE-TO-CICS-LOG                           60830005
608400         STRING ' RCKCS298 - '      DELIMITED BY SIZE             60840005
608500                ' 7800-UNITS-WORK-ROUTINE '                       60850005
608600                                    DELIMITED BY SIZE             60860005
608700                ' KEY INFO - '      DELIMITED BY SIZE             60870005
608800                PC-DISPLAY-PO       DELIMITED BY SIZE             60880005
608900                ' - '               DELIMITED BY SIZE             60890005
609000                PC-DISPLAY-RCVR     DELIMITED BY SIZE             60900005
609100                ' - '               DELIMITED BY SIZE             60910005
609200                PC-DISPLAY-LINE     DELIMITED BY SIZE             60920005
609300                             INTO PV-CICS-MSG-AREA                60930005
609400         MOVE LENGTH OF PV-CICS-MSG-AREA                          60940005
609500                               TO PV-COMMAREA-LENGTH              60950005
609600         PERFORM 9200-WRITE-TO-CICS-LOG                           60960005
609700         PERFORM 9900-SOFT-ABORT                                  60970005
609800     ELSE                                                         60980005
609900     IF  PC238-MOD-BAD-PO                                         60990005
610000         STRING ' RCKCS298 - '      DELIMITED BY SIZE             61000005
610100                ' 7800-UNITS-WORK-ROUTINE '                       61010005
610200                                    DELIMITED BY SIZE             61020005
610300                ' BAD PO NUMBER '   DELIMITED BY SIZE             61030005
610400                PC-DISPLAY-PO       DELIMITED BY SIZE             61040005
610500                             INTO PV-CICS-MSG-AREA                61050005
610600         MOVE LENGTH OF PV-CICS-MSG-AREA                          61060005
610700                               TO PV-COMMAREA-LENGTH              61070005
610800         PERFORM 9200-WRITE-TO-CICS-LOG                           61080005
610900         STRING ' RCKCS298 - '      DELIMITED BY SIZE             61090005
611000                ' 7800-UNITS-WORK-ROUTINE '                       61100005
611100                                    DELIMITED BY SIZE             61110005
611200                ' KEY INFO - '      DELIMITED BY SIZE             61120005
611300                PC-DISPLAY-PO       DELIMITED BY SIZE             61130005
611400                ' - '               DELIMITED BY SIZE             61140005
611500                PC-DISPLAY-RCVR     DELIMITED BY SIZE             61150005
611600                ' - '               DELIMITED BY SIZE             61160005
611700                PC-DISPLAY-LINE     DELIMITED BY SIZE             61170005
611800                             INTO PV-CICS-MSG-AREA                61180005
611900         MOVE LENGTH OF PV-CICS-MSG-AREA                          61190005
612000                               TO PV-COMMAREA-LENGTH              61200005
612100         PERFORM 9200-WRITE-TO-CICS-LOG                           61210005
612200         PERFORM 9900-SOFT-ABORT                                  61220005
612300     ELSE                                                         61230005
612400     IF  PC238-MOD-BAD-RCVR                                       61240005
612500         STRING ' RCKCS298 - '      DELIMITED BY SIZE             61250005
612600                ' 7800-UNITS-WORK-ROUTINE '                       61260005
612700                                    DELIMITED BY SIZE             61270005
612800                ' BAD RCVR NBR  '   DELIMITED BY SIZE             61280005
612900                PC-DISPLAY-RCVR     DELIMITED BY SIZE             61290005
613000                             INTO PV-CICS-MSG-AREA                61300005
613100         MOVE LENGTH OF PV-CICS-MSG-AREA                          61310005
613200                               TO PV-COMMAREA-LENGTH              61320005
613300         PERFORM 9200-WRITE-TO-CICS-LOG                           61330005
613400         STRING ' RCKCS298 - '      DELIMITED BY SIZE             61340005
613500                ' 7800-UNITS-WORK-ROUTINE '                       61350005
613600                                    DELIMITED BY SIZE             61360005
613700                ' KEY INFO - '      DELIMITED BY SIZE             61370005
613800                PC-DISPLAY-PO       DELIMITED BY SIZE             61380005
613900                ' - '               DELIMITED BY SIZE             61390005
614000                PC-DISPLAY-RCVR     DELIMITED BY SIZE             61400005
614100                ' - '               DELIMITED BY SIZE             61410005
614200                PC-DISPLAY-LINE     DELIMITED BY SIZE             61420005
614300                             INTO PV-CICS-MSG-AREA                61430005
614400         MOVE LENGTH OF PV-CICS-MSG-AREA                          61440005
614500                               TO PV-COMMAREA-LENGTH              61450005
614600         PERFORM 9200-WRITE-TO-CICS-LOG                           61460005
614700         PERFORM 9900-SOFT-ABORT                                  61470005
614800     ELSE                                                         61480005
614900     IF  PC238-MOD-BAD-LINE                                       61490005
615000         STRING ' RCKCS298 - '      DELIMITED BY SIZE             61500005
615100                ' 7800-UNITS-WORK-ROUTINE '                       61510005
615200                                    DELIMITED BY SIZE             61520005
615300                ' BAD LINE NBR  '   DELIMITED BY SIZE             61530005
615400                PC-DISPLAY-LINE     DELIMITED BY SIZE             61540005
615500                             INTO PV-CICS-MSG-AREA                61550005
615600         MOVE LENGTH OF PV-CICS-MSG-AREA                          61560005
615700                               TO PV-COMMAREA-LENGTH              61570005
615800         PERFORM 9200-WRITE-TO-CICS-LOG                           61580005
615900         STRING ' RCKCS298 - '      DELIMITED BY SIZE             61590005
616000                ' 7800-UNITS-WORK-ROUTINE '                       61600005
616100                                    DELIMITED BY SIZE             61610005
616200                ' KEY INFO - '      DELIMITED BY SIZE             61620005
616300                PC-DISPLAY-PO       DELIMITED BY SIZE             61630005
616400                ' - '               DELIMITED BY SIZE             61640005
616500                PC-DISPLAY-RCVR     DELIMITED BY SIZE             61650005
616600                ' - '               DELIMITED BY SIZE             61660005
616700                PC-DISPLAY-LINE     DELIMITED BY SIZE             61670005
616800                             INTO PV-CICS-MSG-AREA                61680005
616900         MOVE LENGTH OF PV-CICS-MSG-AREA                          61690005
617000                               TO PV-COMMAREA-LENGTH              61700005
617100         PERFORM 9200-WRITE-TO-CICS-LOG                           61710005
617200         PERFORM 9900-SOFT-ABORT                                  61720005
617300     ELSE                                                         61730005
617400     IF  PC238-MOD-BAD-NO-SHIFT                                   61740005
617500         STRING ' RCKCS298 - '      DELIMITED BY SIZE             61750005
617600                ' 7800-UNITS-WORK-ROUTINE '                       61760005
617700                                    DELIMITED BY SIZE             61770005
617800                ' SHIFT NOT FOUND ' DELIMITED BY SIZE             61780005
617900                PC238-WRKD-TMST     DELIMITED BY SIZE             61790005
618000                ' FOR OPER '        DELIMITED BY SIZE             61800005
618100                PC-DISPLAY-OPER     DELIMITED BY SIZE             61810005
618200                             INTO PV-CICS-MSG-AREA                61820005
618300         MOVE LENGTH OF PV-CICS-MSG-AREA                          61830005
618400                               TO PV-COMMAREA-LENGTH              61840005
618500         PERFORM 9200-WRITE-TO-CICS-LOG                           61850005
618600         STRING ' RCKCS298 - '      DELIMITED BY SIZE             61860005
618700                ' 7800-UNITS-WORK-ROUTINE '                       61870005
618800                                    DELIMITED BY SIZE             61880005
618900                ' KEY INFO - '      DELIMITED BY SIZE             61890005
619000                PC-DISPLAY-PO       DELIMITED BY SIZE             61900005
619100                ' - '               DELIMITED BY SIZE             61910005
619200                PC-DISPLAY-RCVR     DELIMITED BY SIZE             61920005
619300                ' - '               DELIMITED BY SIZE             61930005
619400                PC-DISPLAY-LINE     DELIMITED BY SIZE             61940005
619500                             INTO PV-CICS-MSG-AREA                61950005
619600         MOVE LENGTH OF PV-CICS-MSG-AREA                          61960005
619700                               TO PV-COMMAREA-LENGTH              61970005
619800         PERFORM 9200-WRITE-TO-CICS-LOG                           61980005
619900         PERFORM 9900-SOFT-ABORT                                  61990005
620000     ELSE                                                         62000005
620100         STRING ' RCKCS298 - '      DELIMITED BY SIZE             62010005
620200                ' 7800-UNITS-WORK-ROUTINE '                       62020005
620300                                    DELIMITED BY SIZE             62030005
620400                ' DB ERROR - SQL CODE '                           62040005
620500                                    DELIMITED BY SIZE             62050005
620600                PC-DISPLAY-SQL-CODE DELIMITED BY SIZE             62060005
620700                ' FUNC: '           DELIMITED BY SIZE             62070005
620800                PC238-BAD-TABLE-FUNCTION                          62080005
620900                                    DELIMITED BY SIZE             62090005
621000                ' TABLE: '          DELIMITED BY SIZE             62100005
621100                PC238-BAD-TABLE-NAME                              62110005
621200                                    DELIMITED BY SIZE             62120005
621300                             INTO PV-CICS-MSG-AREA                62130005
621400         MOVE LENGTH OF PV-CICS-MSG-AREA                          62140005
621500                               TO PV-COMMAREA-LENGTH              62150005
621600         PERFORM 9200-WRITE-TO-CICS-LOG                           62160005
621700         STRING ' RCKCS298 - '      DELIMITED BY SIZE             62170005
621800                ' 7800-UNITS-WORK-ROUTINE '                       62180005
621900                                    DELIMITED BY SIZE             62190005
622000                ' KEY INFO - '      DELIMITED BY SIZE             62200005
622100                PC-DISPLAY-PO       DELIMITED BY SIZE             62210005
622200                ' - '               DELIMITED BY SIZE             62220005
622300                PC-DISPLAY-RCVR     DELIMITED BY SIZE             62230005
622400                ' - '               DELIMITED BY SIZE             62240005
622500                PC-DISPLAY-LINE     DELIMITED BY SIZE             62250005
622600                             INTO PV-CICS-MSG-AREA                62260005
622700         MOVE LENGTH OF PV-CICS-MSG-AREA                          62270005
622800                               TO PV-COMMAREA-LENGTH              62280005
622900         PERFORM 9200-WRITE-TO-CICS-LOG                           62290005
623000         PERFORM 9900-SOFT-ABORT                                  62300005
623100     END-IF                                                       62310005
623200     END-IF                                                       62320005
623300     END-IF                                                       62330005
623400     END-IF                                                       62340005
623500     END-IF                                                       62350005
623600     END-IF                                                       62360005
623700     END-IF.                                                      62370005
623800                                                                  62380005
623900*----------------------------------------------------------------*62390005
624000* THIS PARAGRAPH WILL MANAGE THE PROCESS OF A PRE-PACK AND THE   *62400005
624100* ADJUSTMENTS ASSOCIATED TO THE LINES THAT ARE PART OF THE PACK. *62410005
624200* AS THE ADJUSTMENTS ARE PROCESSED IN THE 8090-UPDATE-PACK       *62420005
624300* PARAGRAPH, THE UNITS ARE BEING WRITTEN TO A WORKING STORAGE    *62430005
624400* TABLE USING THE LINE NUMBER AS THE SUBSCRIPT.                  *62440005
624500*                                                                *62450005
624600* ONCE ALL STORES ARE PROCESSED IN THE 8090-UPDATE-PACK PARA-    *62460005
624700* GRAPH, THIS PARAGRAPH WILL THEN BE EXECUTED TO CONTROL THE     *62470005
624800* UPDATES TO THE UNITS WORKED SYSTEM FOR EACH OF THE LINES       *62480005
624900* AFFECTED FROM THE PRE-PACK.                                    *62490005
625000*                                                                *62500005
625100* THE PV-MIN-TABLE-LINE-NBR WILL CONTAIN THE MINIMUM LINE NUMBER *62510005
625200* OCCURRENCE IN THE TABLE AND THE PV-MAX-TABLE-LINE-NBR WILL     *62520005
625300* CONTAIN THE MAXIMUM LINE NUMBER OCCURRENCE IN THE TABLE, THUS  *62530005
625400* THE LOGIC WILL EXECUTE FOR ONLY A PORTION OF THE 1000          *62540005
625500* OCCURRENCE TABLE.                                              *62550005
625600*----------------------------------------------------------------*62560005
625700 7900-PRE-PACK-UNITS-WORK.                                        62570005
625800                                                                  62580005
625900     MOVE PV-MIN-TABLE-LINE-NBR TO                                62590005
626000          PV-TABLE-LINE-NBR.                                      62600005
626100                                                                  62610005
626200     PERFORM 7910-PROCESS-PRE-PACK-TABLE                          62620005
626300        UNTIL PV-TABLE-LINE-NBR >                                 62630005
626400              PV-MAX-TABLE-LINE-NBR.                              62640005
626500                                                                  62650005
626600*----------------------------------------------------------------*62660005
626700* THIS PARAGRAPH WILL CHECK THE OCCURRENCE OF THE WORKING        *62670005
626800* STORAGE TABLE TO DETERMINE IF THE QUANTITY IS OTHER THAN ZERO. *62680005
626900* IF IT IS 0, PROCESSING DONE.  IF THE VALUE IS SOMETHING OTHER  *62690005
627000* THAN ZERO, THEN THE PARAGRAPH WILL GET INFORMATION FOR THE     *62700005
627100* MODULE FROM THE 7750-DISTHD-PURITM-JOIN PARAGRAPH AND THEN     *62710005
627200* CALL THE UNITS WORKED ROUTINE.                                 *62720005
627300*----------------------------------------------------------------*62730005
627400 7910-PROCESS-PRE-PACK-TABLE.                                     62740005
627500                                                                  62750005
627600      IF  PT-UPDATE-QTY (PV-TABLE-LINE-NBR) NOT EQUAL TO ZERO     62760005
627700          MOVE PT-UPDATE-QTY (PV-TABLE-LINE-NBR) TO               62770005
627800               PA-ACCUM-UPDATE-QTY                                62780005
627900          MOVE PV-TABLE-LINE-NBR TO                               62790005
628000               DK-LINE-NBR                                        62800005
628100          PERFORM 7750-DISTHD-PURITM-JOIN                         62810005
628200          PERFORM 7800-UNITS-WORK-ROUTINE                         62820005
628300      END-IF.                                                     62830005
628400                                                                  62840005
628500      ADD 1 TO PV-TABLE-LINE-NBR.                                 62850005
628600                                                                  62860005
628700*----------------------------------------------------------------*62870005
628800 8000-UPDATE-STORE.                                               62880005
628900                                                                  62890005
629000     MOVE +1                       TO ASC-BLK-SUB.                62900005
629100     PERFORM 5100-WRITE-TEMP-STORAGE.                             62910005
629200     ADD +1                        TO ASC-BLK-SUB.                62920005
629300     PERFORM 5100-WRITE-TEMP-STORAGE.                             62930005
629400                                                                  62940005
629500     PERFORM 6112-READ-LIST-QUEUE.                                62950005
629600                                                                  62960005
629700     MOVE ASC-KEY-PO-NBR              TO DK-ORD-NBR.              62970005
629800     MOVE ASC-KEY-RCVR-NBR            TO DK-RCVR-NBR.             62980005
629900     IF ASC-DISPLAY-FORMAT = '3'                                  62990005
630000         MOVE ASC-KEY-LNE-NBR         TO DK-LINE-NBR              63000005
630100     ELSE                                                         63010005
630200         IF ASC-PKGNG-CDE = 'I' OR 'M'                            63020005
630300             MOVE ASC-DRV-LNE-NBR     TO DK-LINE-NBR              63030005
630400         ELSE                                                     63040005
630500             MOVE ASC-KEY-LNE-NBR     TO DK-LINE-NBR              63050005
630600         END-IF                                                   63060005
630700     END-IF.                                                      63070005
630800     MOVE ASC-KEY-PACK-ID             TO DK-PACK-ID.              63080005
630900     MOVE ZERO                        TO PV-PLUS-QTY              63090005
631000                                         PV-MINUS-QTY.            63100005
631100                                                                  63110005
631200     IF  PS-FIRST-TIME-UPDATE                                     63120005
631300         PERFORM 7750-DISTHD-PURITM-JOIN                          63130005
631400         SET PS-NOT-FIRST-TIME-UPDATE TO TRUE                     63140005
631500     END-IF.                                                      63150005
631600                                                                  63160005
631700     IF PV-CICS-RESP = DFHRESP (NORMAL)                           63170005
631800         PERFORM                                                  63180005
631900         VARYING LQW-IDX FROM 1 BY 1                              63190005
632000           UNTIL LQW-IDX > PC-ITEMS-PER-PANEL                     63200005
632100              OR LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            63210005
632200                                                                  63220005
632300             IF LQW-SELECT (LQW-IDX)                              63230005
632400                 MOVE LQW-STORE-NBR (LQW-IDX) TO DK-STR-NBR       63240005
632500                                                                  63250005
632600                 IF (ASC-DISPLAY-FORMAT = '3')                    63260005
632700                     MOVE LQW-U-PROCESS-QTY (LQW-IDX)             63270005
632800                       TO DISTDT-PREPK-ODD-UNT-QTY                63280005
632900                 ELSE                                             63290005
633000                     MOVE LQW-U-PROCESS-QTY (LQW-IDX)             63300005
633100                       TO DISTDT-FCSE-ACTL-UNT-QTY                63310005
633200                 END-IF                                           63320005
633300                                                                  63330005
633400                 IF (ASC-DISPLAY-FORMAT = '3')                    63340005
633500                     PERFORM 8080-UPDATE-ODD-UNITS                63350005
633600                     IF  PV-DISTHD-FCSE-CNFRMN-TMST NOT EQUAL     63360005
633700                         PC-DEFAULT-TMST                          63370005
633800                         SET PS-TDISTDT-UPDATE-DONE TO TRUE       63380005
633900                         MOVE LQW-U-PROCESS-QTY (LQW-IDX) TO      63390005
634000                              PA-UPDATE-TO-QTY                    63400005
634100                         MOVE LQW-ODD-UNIT (LQW-IDX) TO           63410005
634200                              PA-UPDATE-FROM-QTY                  63420005
634300                         SUBTRACT PA-UPDATE-FROM-QTY              63430005
634400                             FROM PA-UPDATE-TO-QTY                63440005
634500                           GIVING PA-UPDATE-DIFF-QTY              63450005
634600                         ADD PA-UPDATE-DIFF-QTY TO                63460005
634700                             PA-ACCUM-UPDATE-QTY                  63470005
634800                     END-IF                                       63480005
634900                 ELSE                                             63490005
635000                     IF (ASC-PKGNG-CDE = 'I' OR 'M')              63500005
635100                         SET PS-PRE-PACK TO TRUE                  63510005
635200                         PERFORM 8090-UPDATE-PACK                 63520005
635300                     ELSE                                         63530005
635400                         PERFORM 8100-UPDATE-TDISTDT              63540005
635500                         IF  PV-DISTHD-FCSE-CNFRMN-TMST NOT EQUAL 63550005
635600                             PC-DEFAULT-TMST                      63560005
635700                             SET PS-TDISTDT-UPDATE-DONE TO TRUE   63570005
635800                             MOVE LQW-U-PROCESS-QTY (LQW-IDX) TO  63580005
635900                                  PA-UPDATE-TO-QTY                63590005
636000                             MOVE LQW-EXP-STR-QTY (LQW-IDX) TO    63600005
636100                                  PA-UPDATE-FROM-QTY              63610005
636200                             SUBTRACT PA-UPDATE-FROM-QTY          63620005
636300                                 FROM PA-UPDATE-TO-QTY            63630005
636400                               GIVING PA-UPDATE-DIFF-QTY          63640005
636500                             ADD PA-UPDATE-DIFF-QTY TO            63650005
636600                                 PA-ACCUM-UPDATE-QTY              63660005
636700                         END-IF                                   63670005
636800                     END-IF                                       63680005
636900                 END-IF                                           63690005
637000                                                                  63700005
637100                 IF (ASC-DISPLAY-FORMAT = '3')                    63710005
637200                     MOVE LQW-U-PROCESS-QTY (LQW-IDX)             63720005
637300                       TO LQW-ODD-UNIT (LQW-IDX)                  63730005
637400                 ELSE                                             63740005
637500                     MOVE LQW-U-PROCESS-QTY (LQW-IDX)             63750005
637600                       TO LQW-CUR-STR-QTY (LQW-IDX)               63760006
637610*                      TO LQW-EXP-STR-QTY (LQW-IDX)               63761006
637700                 END-IF                                           63770005
637800                                                                  63780005
637900                 MOVE SPACES TO LQW-U-PROCESS-QTY-X (LQW-IDX)     63790005
638000                                                                  63800005
638100                 SET LQW-DESELECT (LQW-IDX)                       63810005
638200                     LQW-UPDATE   (LQW-IDX) TO TRUE               63820005
638300                 MOVE LQW-SELECTED-SW (LQW-IDX)                   63830005
638400                   TO LQW-TEMP-SELECTED-SW (LQW-IDX)              63840005
638500*JPL                                                              63850005
638600                 IF ASC-DISPLAY-FORMAT NOT = '3'                  63860005
638700                     IF ASC-OUT-PACK-QTY > ZERO                   63870005
638800                         IF (ASC-PKGNG-CDE = 'I' OR 'M')          63880005
638900                             COMPUTE PV-PROCESS-QTY               63890005
639000                                   = LQW-EXP-STR-QTY (LQW-IDX)    63900005
639100                                   * ASC-PREPK-RATO-QTY           63910005
639200                              DIVIDE PV-PROCESS-QTY               63920005
639300                                  BY ASC-OUT-PACK-QTY             63930005
639400                              GIVING LQW-EXP-STR-CRT (LQW-IDX)    63940005
639500                         ELSE                                     63950005
639600                             DIVIDE DISTDT-FCSE-ACTL-UNT-QTY      63960005
639700                                 BY ASC-OUT-PACK-QTY              63970005
639800                             GIVING LQW-EXP-STR-CRT (LQW-IDX)     63980005
639900                     ELSE                                         63990005
640000                         MOVE DISTDT-FCSE-ACTL-UNT-QTY            64000005
640100                           TO LQW-EXP-STR-CRT (LQW-IDX)           64010005
640200                     END-IF                                       64020005
640300                 END-IF                                           64030005
640400                                                                  64040005
640500             END-IF                                               64050005
640600         END-PERFORM                                              64060005
640700                                                                  64070005
640800         MOVE PV-ITEM TO PV-SAVE-ITEM                             64080005
640900         PERFORM 6111-WRITE-LIST-QUEUE                            64090005
641000     END-IF.                                                      64100005
641100                                                                  64110005
641200     MOVE +1 TO ASC-BLK-SUB.                                      64120005
641300     PERFORM 4410-READ-TEMP-STORAGE                               64130005
641400                                                                  64140005
641500     ADD +1  TO ASC-BLK-SUB                                       64150005
641600                PV-BLOCK-NUMBER.                                  64160005
641700     PERFORM 4410-READ-TEMP-STORAGE.                              64170005
641800                                                                  64180005
641900     PERFORM 7300-SUM-TDISTDT.                                    64190005
642000                                                                  64200005
642100     IF (ASC-DISPLAY-FORMAT = '3')                                64210005
642200         MOVE DISTDT-FCSE-ACTL-UNT-QTY TO ASC-CUR-LINE-QTY        64220005
642300     ELSE                                                         64230005
642400         IF (ASC-PKGNG-CDE = 'I' OR 'M')                          64240005
642500             IF ASC-PREPK-RATO-QTY NOT = +0                       64250005
642600                 COMPUTE ASC-CUR-LINE-QTY                         64260005
642700                       = DISTDT-FCSE-ACTL-UNT-QTY                 64270005
642800                       / ASC-PREPK-RATO-QTY                       64280005
642900             ELSE                                                 64290005
643000                 MOVE DISTDT-FCSE-ACTL-UNT-QTY                    64300005
643100                   TO ASC-CUR-LINE-QTY                            64310005
643200             END-IF                                               64320005
643300         ELSE                                                     64330005
643400             MOVE DISTDT-FCSE-ACTL-UNT-QTY TO ASC-CUR-LINE-QTY    64340005
643500         END-IF                                                   64350005
643600     END-IF.                                                      64360005
643700                                                                  64370005
643800     IF DISTHD-RSLTS-RCVD-TMST = PC-DEFAULT-TMST                  64380005
643900         IF (ASC-DISPLAY-FORMAT = '3')                            64390005
644000             MOVE DISTDT-P2L-SPLT-UNT-QTY TO ASC-P2L-QTY-LINE     64400005
644100         ELSE                                                     64410005
644200         IF (ASC-PKGNG-CDE = 'I' OR 'M')                          64420005
644300           AND (ASC-PREPK-RATO-QTY NOT = +0)                      64430005
644400             COMPUTE ASC-P2L-QTY-LINE = DISTDT-P2L-SPLT-UNT-QTY   64440005
644500                                      / ASC-PREPK-RATO-QTY        64450005
644600         ELSE                                                     64460005
644700             MOVE DISTDT-P2L-SPLT-UNT-QTY TO ASC-P2L-QTY-LINE     64470005
644800         END-IF                                                   64480005
644900         END-IF                                                   64490005
645000     ELSE                                                         64500005
645100         IF (ASC-DISPLAY-FORMAT = '3')                            64510005
645200             MOVE DISTDT-ACTL-ALLOC-QTY TO ASC-P2L-QTY-LINE       64520005
645300         ELSE                                                     64530005
645400         IF (ASC-PKGNG-CDE = 'I' OR 'M')                          64540005
645500           AND (ASC-PREPK-RATO-QTY NOT = +0)                      64550005
645600             COMPUTE ASC-P2L-QTY-LINE = DISTDT-ACTL-ALLOC-QTY     64560005
645700                                      / ASC-PREPK-RATO-QTY        64570005
645800         ELSE                                                     64580005
645900             MOVE DISTDT-ACTL-ALLOC-QTY TO ASC-P2L-QTY-LINE       64590005
646000         END-IF                                                   64600005
646100         END-IF                                                   64610005
646200     END-IF.                                                      64620005
646300                                                                  64630005
646400     ADD ASC-CUR-LINE-QTY ASC-P2L-QTY-LINE                        64640005
646500                                          GIVING ASC-EXP-LINE-QTY.64650005
646600                                                                  64660005
646700     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        64670005
646800                                                                  64680005
646900*----------------------------------------------------------------*64690005
647000* UPDATE ODD UNIT QUANTITY FOR STORE.                            *64700005
647100*----------------------------------------------------------------*64710005
647200 8080-UPDATE-ODD-UNITS.                                           64720005
647300                                                                  64730005
647400     EXEC SQL                                                     64740005
647500         UPDATE  TDISTDT                                          64750005
647600            SET PREPK_ODD_UNT_QTY = :DISTDT-PREPK-ODD-UNT-QTY     64760005
647700          WHERE ORD_NBR           = :DK-ORD-NBR                   64770005
647800            AND RCVR_SEQ_NBR      = :DK-RCVR-NBR                  64780005
647900            AND ORD_LNE_NBR       = :DK-LINE-NBR                  64790005
648000            AND STR_NBR           = :DK-STR-NBR                   64800005
648100     END-EXEC.                                                    64810005
648200                                                                  64820005
648300     EVALUATE TRUE                                                64830005
648400         WHEN SQLCODE = ZERO                                      64840005
648500         WHEN SQLCODE = +100                                      64850005
648600              CONTINUE                                            64860005
648700                                                                  64870005
648800         WHEN SQLCODE = -904                                      64880005
648900         WHEN SQLCODE = -911                                      64890005
649000         WHEN SQLCODE = -913                                      64900005
649100             PERFORM 9900-SOFT-ABORT                              64910005
649200                                                                  64920005
649300         WHEN SQLWARN0 NOT = SPACES                               64930005
649400         WHEN SQLCODE < ZERO                                      64940005
649500         WHEN SQLCODE > ZERO                                      64950005
649600             MOVE '8080-UPDATE-ODD-UNITS'                         64960005
649700                                    TO DP013-PARAGRAPH            64970005
649800             MOVE 'UNSUCCESSFUL UPDATE OF STORE ROW'              64980005
649900                                    TO DP013-MESSAGE-TEXT (1)     64990005
650000             MOVE SQLCA      TO DP013-SQLCA                       65000005
650100             MOVE 'TDISTDT ' TO DP013-DB2-TABLE-NAME (1)          65010005
650200             SET DP013-DB2-ABEND                                  65020005
650300                  DP013-NO-ROLLBACK TO TRUE                       65030005
650400             PERFORM DP013-0000-PROCESS-ABEND                     65040005
650500     END-EVALUATE.                                                65050005
650600                                                                  65060005
650700*----------------------------------------------------------------*65070005
650800* UPDATE THE STORES ACROSS ALL LINES OF THE PACK.                *65080005
650900*----------------------------------------------------------------*65090005
651000 8090-UPDATE-PACK.                                                65100005
651100                                                                  65110005
651200     PERFORM 8091-OPEN-PACK-CSR.                                  65120005
651300                                                                  65130005
651400     PERFORM 8093-PROCESS-PACK                                    65140005
651500       UNTIL PS-MORE-RECITM-NO OR PS-ERROR.                       65150005
651600                                                                  65160005
651700     PERFORM 8092-CLOSE-PACK-CSR.                                 65170005
651800                                                                  65180005
651900*----------------------------------------------------------------*65190005
652000* OPEN THE PRE-PACK CURSOR.                                      *65200005
652100*----------------------------------------------------------------*65210005
652200 8091-OPEN-PACK-CSR.                                              65220005
652300                                                                  65230005
652400     EXEC SQL                                                     65240005
652500         OPEN PREPK-SEARCH-CSR                                    65250005
652600     END-EXEC.                                                    65260005
652700                                                                  65270005
652800     EVALUATE TRUE                                                65280005
652900         WHEN SQLCODE = ZERO                                      65290005
653000             SET PS-MORE-RECITM-YES TO TRUE                       65300005
653100                                                                  65310005
653200         WHEN SQLCODE = -904                                      65320005
653300         WHEN SQLCODE = -911                                      65330005
653400         WHEN SQLCODE = -913                                      65340005
653500             PERFORM 9900-SOFT-ABORT                              65350005
653600                                                                  65360005
653700         WHEN SQLWARN0 NOT = SPACE                                65370005
653800         WHEN SQLCODE  NOT = ZERO                                 65380005
653900             MOVE '8091-OPEN-PACK-CSR'                            65390005
654000                                 TO DP013-PARAGRAPH               65400005
654100             MOVE 'OPEN PRE-PACK CURSOR'                          65410005
654200                                 TO DP013-MESSAGE-TEXT (1)        65420005
654300             MOVE SQLCA          TO DP013-SQLCA                   65430005
654400             MOVE 'TRECITM'      TO DP013-DB2-TABLE-NAME (1)      65440005
654500             SET DP013-DB2-ABEND TO TRUE                          65450005
654600             PERFORM DP013-0000-PROCESS-ABEND                     65460005
654700     END-EVALUATE.                                                65470005
654800                                                                  65480005
654900*----------------------------------------------------------------*65490005
655000* CLOSE THE PRE-PACK CURSOR                                      *65500005
655100*----------------------------------------------------------------*65510005
655200 8092-CLOSE-PACK-CSR.                                             65520005
655300                                                                  65530005
655400     EXEC SQL                                                     65540005
655500         CLOSE PREPK-SEARCH-CSR                                   65550005
655600     END-EXEC.                                                    65560005
655700                                                                  65570005
655800     EVALUATE TRUE                                                65580005
655900         WHEN SQLCODE = ZERO                                      65590005
656000             CONTINUE                                             65600005
656100                                                                  65610005
656200         WHEN SQLCODE = -904                                      65620005
656300         WHEN SQLCODE = -911                                      65630005
656400         WHEN SQLCODE = -913                                      65640005
656500             PERFORM 9900-SOFT-ABORT                              65650005
656600                                                                  65660005
656700         WHEN SQLWARN0 NOT = SPACE                                65670005
656800         WHEN SQLCODE  NOT = ZERO                                 65680005
656900             MOVE '8092-CLOSE-PACK-CSR'                           65690005
657000                                 TO DP013-PARAGRAPH               65700005
657100             MOVE 'CLOSE PRE-PACK CURSOR'                         65710005
657200                                 TO DP013-MESSAGE-TEXT (1)        65720005
657300             MOVE SQLCA          TO DP013-SQLCA                   65730005
657400             MOVE 'TRECITM'      TO DP013-DB2-TABLE-NAME (1)      65740005
657500             SET DP013-DB2-ABEND TO TRUE                          65750005
657600             PERFORM DP013-0000-PROCESS-ABEND                     65760005
657700     END-EVALUATE.                                                65770005
657800                                                                  65780005
657900*----------------------------------------------------------------*65790005
658000* PROCESS ALL LINES ASSOCIATED WITH THE PACK-ID                  *65800005
658100*----------------------------------------------------------------*65810005
658200 8093-PROCESS-PACK.                                               65820005
658300                                                                  65830005
658400     PERFORM 8094-FETCH-PACK-CSR.                                 65840005
658500                                                                  65850005
658600     IF PS-MORE-RECITM-YES                                        65860005
658700         MOVE RECITM-ORD-LNE-NBR      TO DK-LINE-NBR              65870005
658800         MOVE LQW-STORE-NBR (LQW-IDX) TO DK-STR-NBR               65880005
658900*CONVERT FULLCASE QUANTITY FROM 'PACK' TO 'UNIT'.                 65890005
659000         COMPUTE DISTDT-FCSE-ACTL-UNT-QTY                         65900005
659100               = LQW-U-PROCESS-QTY (LQW-IDX)                      65910005
659200               * RECITM-PREPK-RATO-QTY                            65920005
659300*UPDATE STORE RECORD.                                             65930005
659400         PERFORM 8100-UPDATE-TDISTDT                              65940005
659500         IF  PV-DISTHD-FCSE-CNFRMN-TMST NOT EQUAL                 65950005
659600             PC-DEFAULT-TMST                                      65960005
659700             SET PS-TDISTDT-UPDATE-DONE TO TRUE                   65970005
659800             MOVE DISTDT-FCSE-ACTL-UNT-QTY TO                     65980005
659900                  PA-UPDATE-TO-QTY                                65990005
660000             COMPUTE PA-UPDATE-FROM-QTY                           66000005
660100                   = LQW-EXP-STR-QTY (LQW-IDX)                    66010005
660200                   * RECITM-PREPK-RATO-QTY                        66020005
660300             SUBTRACT PA-UPDATE-FROM-QTY                          66030005
660400                 FROM PA-UPDATE-TO-QTY                            66040005
660500               GIVING PA-UPDATE-DIFF-QTY                          66050005
660600             MOVE RECITM-ORD-LNE-NBR TO                           66060005
660700                  PV-TABLE-LINE-NBR                               66070005
660800             COMPUTE PT-UPDATE-QTY (PV-TABLE-LINE-NBR)            66080005
660900                   = PT-UPDATE-QTY (PV-TABLE-LINE-NBR)            66090005
661000                   + PA-UPDATE-DIFF-QTY                           66100005
661100             IF  PV-TABLE-LINE-NBR < PV-MIN-TABLE-LINE-NBR        66110005
661200                 MOVE PV-TABLE-LINE-NBR TO                        66120005
661300                      PV-MIN-TABLE-LINE-NBR                       66130005
661400             END-IF                                               66140005
661500             IF  PV-TABLE-LINE-NBR > PV-MAX-TABLE-LINE-NBR        66150005
661600                 MOVE PV-TABLE-LINE-NBR TO                        66160005
661700                      PV-MAX-TABLE-LINE-NBR                       66170005
661800             END-IF                                               66180005
661900         END-IF                                                   66190005
662000     END-IF.                                                      66200005
662100                                                                  66210005
662200*----------------------------------------------------------------*66220005
662300* FETCH NEXT LINE ASSOCIATED WITH THE PACK-ID                    *66230005
662400*----------------------------------------------------------------*66240005
662500 8094-FETCH-PACK-CSR.                                             66250005
662600                                                                  66260005
662700     EXEC SQL                                                     66270005
662800         FETCH PREPK-SEARCH-CSR                                   66280005
662900          INTO :RECITM-ORD-LNE-NBR                                66290005
663000             , :RECITM-PREPK-RATO-QTY                             66300005
663100     END-EXEC.                                                    66310005
663200                                                                  66320005
663300     EVALUATE TRUE                                                66330005
663400         WHEN SQLCODE = ZERO                                      66340005
663500             CONTINUE                                             66350005
663600                                                                  66360005
663700         WHEN SQLCODE = +100                                      66370005
663800             SET PS-MORE-RECITM-NO TO TRUE                        66380005
663900                                                                  66390005
664000         WHEN SQLCODE = -904                                      66400005
664100         WHEN SQLCODE = -911                                      66410005
664200         WHEN SQLCODE = -913                                      66420005
664300             PERFORM 9900-SOFT-ABORT                              66430005
664400                                                                  66440005
664500         WHEN SQLWARN0 NOT = SPACE                                66450005
664600         WHEN SQLCODE < ZERO                                      66460005
664700         WHEN SQLCODE > ZERO                                      66470005
664800             MOVE '8094-FETCH-PACK-CSR'                           66480005
664900                                 TO DP013-PARAGRAPH               66490005
665000             MOVE 'FETCH PREPK SEARCH CURSOR'                     66500005
665100                                 TO DP013-MESSAGE-TEXT (1)        66510005
665200             MOVE SQLCA          TO DP013-SQLCA                   66520005
665300             MOVE 'TRECITM'      TO DP013-DB2-TABLE-NAME (1)      66530005
665400             SET DP013-DB2-ABEND TO TRUE                          66540005
665500             PERFORM DP013-0000-PROCESS-ABEND                     66550005
665600     END-EVALUATE.                                                66560005
665700                                                                  66570005
665800*----------------------------------------------------------------*66580005
665900 8100-UPDATE-TDISTDT.                                             66590005
666000                                                                  66600005
666100     EXEC SQL                                                     66610005
666200         UPDATE  TDISTDT                                          66620005
666300           SET FCSE_ACTL_UNT_QTY     = :DISTDT-FCSE-ACTL-UNT-QTY  66630005
666400      WHERE ORD_NBR                  = :DK-ORD-NBR                66640005
666500        AND RCVR_SEQ_NBR             = :DK-RCVR-NBR               66650005
666600        AND ORD_LNE_NBR              = :DK-LINE-NBR               66660005
666700        AND STR_NBR                  = :DK-STR-NBR                66670005
666800     END-EXEC.                                                    66680005
666900                                                                  66690005
667000     EVALUATE TRUE                                                66700005
667100         WHEN SQLCODE = ZERO                                      66710005
667200         WHEN SQLCODE = +100                                      66720005
667300              CONTINUE                                            66730005
667400                                                                  66740005
667500         WHEN SQLCODE = -904                                      66750005
667600         WHEN SQLCODE = -911                                      66760005
667700         WHEN SQLCODE = -913                                      66770005
667800             PERFORM 9900-SOFT-ABORT                              66780005
667900                                                                  66790005
668000         WHEN SQLWARN0 NOT = SPACES                               66800005
668100         WHEN SQLCODE < ZERO                                      66810005
668200         WHEN SQLCODE > ZERO                                      66820005
668300             MOVE '7950-UPDATE-TDISTDT'                           66830005
668400                                  TO DP013-PARAGRAPH              66840005
668500             MOVE 'UNSUCCESSFUL UPDATE OF STORE ROW'              66850005
668600                                  TO DP013-MESSAGE-TEXT (1)       66860005
668700             MOVE SQLCA      TO DP013-SQLCA                       66870005
668800             MOVE 'TDISTDT ' TO DP013-DB2-TABLE-NAME (1)          66880005
668900             SET DP013-DB2-ABEND                                  66890005
669000                  DP013-NO-ROLLBACK                               66900005
669100                                  TO TRUE                         66910005
669200             PERFORM DP013-0000-PROCESS-ABEND                     66920005
669300     END-EVALUATE.                                                66930005
669400                                                                  66940005
669500*----------------------------------------------------------------*66950005
669600*    CALL (AUTOVE) AUTOVERIFICATION MODULE (RCKUT127)             66960005
669700*    TO SEE IF THIS IS AN AUTOVE PO                               66970005
669800*----------------------------------------------------------------*66980005
669900 8400-CHECK-AUTOVE.                                               66990005
670000                                                                  67000005
670100     INITIALIZE RC040-FIELDS.                                     67010005
670200     MOVE ASC-KEY-OPER-UNT-ID TO RC040-SIGNON-LOCATION.           67020005
670300     MOVE ASC-KEY-PO-NBR      TO RC040-PO-NBR.                    67030005
670400     MOVE ASC-KEY-RCVR-NBR    TO RC040-PO-RCVR.                   67040005
670500     SET  RC040-RCVR-EXISTS   TO TRUE.                            67050005
670600     MOVE DP020-USERID        TO RC040-USER-ID.                   67060005
670700     MOVE 'RCKCS298'          TO RC040-CALLING-PROGRAM.           67070005
670800                                                                  67080005
670900     CALL RC040-AUTOVE-CHECK-PGM USING  DFHEIBLK                  67090005
671000                                        RC040-COMMAREA            67100005
671100                                        RC040-FIELDS.             67110005
671200     EVALUATE TRUE                                                67120005
671300         WHEN RC040-SUCCESSFUL                                    67130005
671400              MOVE RC040-AUTO-VE-SW     TO ASC-AUTO-VE-SW         67140005
671500         WHEN RC040-DATABASE-BUSY OR                              67150005
671600              RC040-INVALID-SQL                                   67160005
671700                  MOVE PC-TSYMSG-00984  TO DP020-MSG-NUMBER       67170005
671800                  SET DP020-MSG-WARNING TO TRUE                   67180005
671900                  SET DP030-OVERRIDE-GO TO TRUE                   67190005
672000                  SET PS-ERROR          TO TRUE                   67200005
672100         WHEN RC040-NOT-SUCCESSFUL                                67210005
672200                  MOVE PC-TSYMSG-03138  TO DP020-MSG-NUMBER       67220005
672300                  SET DP020-MSG-WARNING TO TRUE                   67230005
672400                  SET DP030-OVERRIDE-GO TO TRUE                   67240005
672500                  SET PS-ERROR          TO TRUE                   67250005
672600         WHEN OTHER                                               67260005
672700             MOVE '8400-CHECK-AUTOVE ' TO DP013-PARAGRAPH         67270005
672800             MOVE 'UNSUCCESSFUL CALL TO AUTO VE MOD'              67280005
672900                                         TO DP013-MESSAGE-TEXT (1)67290005
673000             MOVE RC040-SUCCESS-IND      TO DP013-MESSAGE-TEXT (2)67300005
673100             MOVE RC040-SQLCA            TO DP013-SQLCA           67310005
673200             SET DP013-DB2-ABEND                                  67320005
673300                 DP013-XCTL-DISPLAY-RESTART  TO TRUE              67330005
673400             SET PS-ERROR                    TO TRUE              67340005
673500             PERFORM DP013-0000-PROCESS-ABEND                     67350005
673600     END-EVALUATE.                                                67360005
673700                                                                  67370005
673800*----------------------------------------------------------------*67380005
673900*    READ THE INPUT SELECTION QUEUE.                             *67390005
674000*----------------------------------------------------------------*67400005
674100 9100-READ-SEL-QUEUE.                                             67410005
674200                                                                  67420005
674300     EXEC CICS                                                    67430005
674400         READQ TS                                                 67440005
674500            QUEUE (ASC-SEL-QUEUE-NAME-IN)                         67450005
674600             INTO (RC013-DC-SELECT-RECORD)                        67460005
674700             ITEM (ASC-SEL-ITEM)                                  67470005
674800             RESP (PV-CICS-RESP)                                  67480005
674900     END-EXEC.                                                    67490005
675000                                                                  67500005
675100     IF PV-CICS-RESP = DFHRESP (NORMAL)                           67510005
675200         CONTINUE                                                 67520005
675300     ELSE                                                         67530005
675400         SET DP013-CICS-ABEND       TO TRUE                       67540005
675500         SET DP013-NO-ROLLBACK      TO TRUE                       67550005
675600         MOVE '9100-READ-SEL-QUEUE' TO DP013-PARAGRAPH            67560005
675700         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           67570005
675800                                    TO DP013-MESSAGE-TEXT(1)      67580005
675900         PERFORM DP013-0000-PROCESS-ABEND                         67590005
676000     END-IF.                                                      67600005
676100                                                                  67610005
676200*----------------------------------------------------------------*67620005
676300 9200-WRITE-TO-CICS-LOG.                                          67630005
676400                                                                  67640005
676500     EXEC CICS                                                    67650005
676600          WRITEQ TD                                               67660005
676700          QUEUE  ('CSSL')                                         67670005
676800          FROM  (PV-CICS-MSG-AREA)                                67680005
676900          LENGTH  (PV-COMMAREA-LENGTH)                            67690005
677000          RESP  (PV-CICS-RESP)                                    67700005
677100     END-EXEC.                                                    67710005
677200                                                                  67720005
677300     MOVE SPACES TO PV-CICS-MSG-AREA.                             67730005
677400                                                                  67740005
677500*----------------------------------------------------------------*67750005
677600 9900-SOFT-ABORT.                                                 67760005
677700     SET PS-ERROR         TO TRUE.                                67770005
677800     SET DP020-MSG-FATAL  TO TRUE.                                67780005
677900     MOVE 'THROUGH SOFT-ABORT PARA'                               67790005
678000                      TO DP013-MESSAGE-TEXT (1).                  67800005
678100                                                                  67810005
678200     IF  PS-UNITS-WORKED-ERROR                                    67820005
678300         MOVE PC-TSYMSG-02875 TO DP020-MSG-NUMBER                 67830005
678400     ELSE                                                         67840005
678500         MOVE PC-TSYMSG-00551 TO DP020-MSG-NUMBER                 67850005
678600     END-IF.                                                      67860005
678700                                                                  67870005
678800     IF PS-NO-NEXT-SCREEN                                         67880005
678900        SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                     67890005
679000     END-IF.                                                      67900005
679100     PERFORM 9901-BACKUP.                                         67910005
679200     MOVE 'PROGRAM EXIT CALL' TO DP013-MESSAGE-TEXT (1).          67920005
679300     PERFORM 0001-CALL-CICS-ARCH-API.                             67930005
679400                                                                  67940005
679500 9901-BACKUP.                                                     67950005
679600     EXEC CICS SYNCPOINT                                          67960005
679700          ROLLBACK                                                67970005
679800     END-EXEC.                                                    67980005
679900                                                                  67990005
680000 9902-SYNCPOINT.                                                  68000005
680100     EXEC CICS                                                    68010005
680200         SYNCPOINT                                                68020005
680300     END-EXEC.                                                    68030005
680400                                                                  68040005
680500*----------------------------------------------------------------*68050005
680600*    ABEND PROCESSOR MODULE                                      *68060005
680700*----------------------------------------------------------------*68070005
680800     COPY DPPD013.                                                68080005
