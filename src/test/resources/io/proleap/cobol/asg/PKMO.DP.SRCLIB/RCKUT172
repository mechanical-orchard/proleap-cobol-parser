000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400                                                                  00040000
000500 PROGRAM-ID.             RCKUT172.                                00050000
000600 AUTHOR.                 RON KRIER.                               00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            APRIL 2021.                              00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100***************************************************************** 00110000
001200*  THIS PROGRAM WILL BE USED TO TAKE IN A FILE USING COPYBOOK   * 00120000
001300*  RCRD001 FROM PROGRAM RCKTU171 AND WILL BUILD THE OUTPUT      * 00130000
001400*  FILE USING COPYBOOK RCRD001 TO PASS ONTO THE RCKUP006        * 00140000
001500*  TO POPULATE DATA TO THE PACKSLIP AND INBOUND CARTON          * 00150000
001510*  DATABASES.                                                   * 00151000
001520*  THIS PROGRAM WILL ALSO TAKE IN AN INPUT FILE OF CARTON DATA  * 00152002
001530*  FROM RCKUT171 USING COPYBOOK RCRD102 WHICH WILL BE USED TO   * 00153002
001700*  COUNT UP THE NUMBER OF CARTONS PER DC/BILL OF LADING/PO SO   * 00170002
001800*  THAT THE CARTON COUNT CAN BE UPDATED TO THE CORRESPONDING    * 00180002
001900*  HEADER RECORD IN THE FOLLOWING FIELDS:                       * 00190002
001910*       RC001-CARTON-CNT-STORE                                  * 00191000
001920*       RC001-CARTON-CNT-PO                                     * 00192000
002000***************************************************************** 00200000
002100                                                                  00210000
002200 ENVIRONMENT DIVISION.                                            00220000
002300                                                                  00230000
002400 CONFIGURATION SECTION.                                           00240000
002500                                                                  00250000
002600 SOURCE-COMPUTER.        IBM-3090.                                00260000
002700 OBJECT-COMPUTER.        IBM-3090.                                00270000
002800                                                                  00280000
002900 INPUT-OUTPUT SECTION.                                            00290000
003000                                                                  00300000
003100 FILE-CONTROL.                                                    00310000
003200                                                                  00320000
003300     SELECT PACKSLIP-CARTON-FILE-IN                               00330000
003400         ASSIGN TO INP01.                                         00340000
003500                                                                  00350000
003510     SELECT SSCC-CARTON-FILE-IN                                   00351002
003520         ASSIGN TO INP02.                                         00352002
003530                                                                  00353002
003600     SELECT PACKSLIP-CARTON-FILE-OUT                              00360000
003700         ASSIGN TO OUT01.                                         00370000
003800                                                                  00380000
003900******************************************************************00390000
004000 DATA DIVISION.                                                   00400000
004100******************************************************************00410000
004200                                                                  00420000
004300 FILE SECTION.                                                    00430000
004400                                                                  00440000
004500 FD  PACKSLIP-CARTON-FILE-IN                                      00450000
004600     RECORDING MODE IS F                                          00460000
004700     LABEL RECORDS ARE STANDARD                                   00470000
004800     BLOCK CONTAINS 0 RECORDS.                                    00480000
004900 01  PACKSLIP-CARTON-RECORD-IN        PIC  X(600).                00490000
005000                                                                  00500000
005001 FD  SSCC-CARTON-FILE-IN                                          00500102
005002     RECORDING MODE IS F                                          00500202
005003     LABEL RECORDS ARE STANDARD                                   00500302
005004     BLOCK CONTAINS 0 RECORDS.                                    00500402
005005 01  SSCC-CARTON-RECORD-IN            PIC  X(75).                 00500502
005006                                                                  00500602
005010 FD  PACKSLIP-CARTON-FILE-OUT                                     00501000
005020     RECORDING MODE IS F                                          00502000
005030     LABEL RECORDS ARE STANDARD                                   00503000
005040     BLOCK CONTAINS 0 RECORDS.                                    00504000
005050 01  PACKSLIP-CARTON-RECORD-OUT       PIC  X(600).                00505000
005500                                                                  00550000
005600 WORKING-STORAGE SECTION.                                         00560000
005700                                                                  00570000
005800 01  FILLER                      PIC  X(46)    VALUE              00580000
005900     '** WORKING STORAGE FOR RCKUT172 STARTS HERE **'.            00590000
006000                                                                  00600000
007200 01  PROGRAM-SWITCHES.                                            00720000
007300     05  END-OF-PKSL-FILE-SW         PIC  X(01)    VALUE 'N'.     00730008
007400         88  END-OF-PKSL-FILE                      VALUE 'Y'.     00740008
007500     05  END-OF-SSCC-FILE-SW         PIC  X(01)    VALUE 'N'.     00750008
007600         88  END-OF-SSCC-FILE                      VALUE 'Y'.     00760008
007700     05  PS-PO-COUNT-DONE-SW         PIC  X(01)    VALUE 'N'.     00770003
007800         88  PS-PO-COUNT-DONE                      VALUE 'Y'.     00780003
007900         88  PS-PO-COUNT-NOT-DONE                  VALUE 'N'.     00790003
010600                                                                  01060000
010700 01  PC-CONSTANTS.                                                01070000
011100     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          01110000
011200                                                   'RCKUT172'.    01120000
011400                                                                  01140000
012230     05  PC-PROGRESSIVE-READ-LIMIT   PIC S9(9)     VALUE 1000     01223011
012240                                                   COMP-3.        01224011
012300                                                                  01230000
012400 01  PV-ACCUMULATOR-FIELDS.                                       01240000
013300     05  PV-BOL-CARTON-QTY           PIC  9(07)    VALUE ZERO.    01330000
013400     05  PV-PO-CARTON-QTY            PIC  9(07)    VALUE ZERO.    01340000
013700                                                                  01370000
020400 01  PV-MISC-FIELDS.                                              02040000
020500     05  PV-READ-COUNT               PIC  S9(9)     VALUE ZERO    02050000
020600                                                    COMP-3.       02060000
020601     05  PV-READ-HEADER-COUNT        PIC  S9(9)     VALUE ZERO    02060106
020602                                                    COMP-3.       02060206
020603     05  PV-READ-DETAIL-COUNT        PIC  S9(9)     VALUE ZERO    02060306
020604                                                    COMP-3.       02060406
020605     05  PV-READ-CARTON-COUNT        PIC  S9(9)     VALUE ZERO    02060506
020606                                                    COMP-3.       02060606
020607     05  PV-READ-OTHER-COUNT         PIC  S9(9)     VALUE ZERO    02060706
020608                                                    COMP-3.       02060806
020609     05  PV-SSCC-READ-COUNT          PIC  S9(9)     VALUE ZERO    02060906
020610                                                    COMP-3.       02061006
020611     05  PV-PROGRESSIVE-READ-COUNT   PIC  S9(9)     VALUE ZERO    02061106
020620                                                    COMP-3.       02062000
021300     05  PV-WRITE-HEADER-COUNT       PIC  S9(9)     VALUE ZERO    02130000
021400                                                    COMP-3.       02140000
021500     05  PV-WRITE-DETAIL-COUNT       PIC  S9(9)     VALUE ZERO    02150000
021600                                                    COMP-3.       02160000
021700     05  PV-WRITE-CARTON-COUNT       PIC  S9(9)     VALUE ZERO    02170000
021800                                                    COMP-3.       02180000
021810     05  PV-WRITE-OTHER-COUNT        PIC  S9(9)     VALUE ZERO    02181004
021820                                                    COMP-3.       02182004
021900     05  PV-WRITE-TOTAL-COUNT        PIC  S9(9)     VALUE ZERO    02190000
022000                                                    COMP-3.       02200000
022100                                                                  02210007
025900     05  PV-DISP-NBR-C               PIC  ZZ,ZZZ,ZZ9.             02590000
026000     05  PV-DISP-NBR-C2              PIC  ZZ,ZZZ,ZZ9.             02600000
026100     05  PV-DISP-NBR                 PIC  ZZZZZZZ9.               02610000
026200     05  PV-DISP-NBR-15              PIC  999999999999999.        02620000
026300     05  PV-DISP-NBR-10              PIC  9999999999.             02630000
026400     05  PV-DISP-NBR-8               PIC  99999999.               02640000
026500     05  PV-DISP-NBR-18              PIC  999999999999999999.     02650000
026600     05  PV-DISP-NBR-4               PIC  9999.                   02660000
026610                                                                  02661003
026700     05  PV-PARAGRAPH-NAME           PIC  X(30)    VALUE SPACES.  02670007
026800     05  AC-ABEND-CODE               PIC S9(04)    VALUE +0.      02680007
026900                                                                  02690008
027000     05  PV-PKSLIP-FILE-KEY.                                      02700008
027100         10  PV-PKSLIP-DIST-CNTR            PIC 9(04).            02710008
027200         10  PV-PKSLIP-BILL-OF-LADING-NBR   PIC X(30).            02720008
027300         10  PV-PKSLIP-PO-NBR               PIC 9(09).            02730008
027310                                                                  02731008
027400     05  PV-SSCC-FILE-KEY.                                        02740008
027500         10  PV-SSCC-DIST-CNTR              PIC 9(04).            02750008
027600         10  PV-SSCC-BILL-OF-LADING-NBR     PIC X(30).            02760008
027700         10  PV-SSCC-PO-NBR                 PIC 9(09).            02770008
029191                                                                  02919100
029700******************************************************************02970000
029800*  COPYBOOKS.                                                     02980000
029900******************************************************************02990000
030000                                                                  03000000
031600*----------------------------------------------------------------*03160000
031700*    PACKSLIP INBOUND CARTON FILE LAYOUT - INPUT & OUTPUT         03170002
031800*----------------------------------------------------------------*03180000
031900     COPY RCRD001.                                                03190000
032000                                                                  03200002
032010*----------------------------------------------------------------*03201002
032020*    SSCC CARTON INPUT FILE LAYOUT                                03202002
032030*----------------------------------------------------------------*03203002
032040     COPY RCRD102.                                                03204002
032100                                                                  03210000
041200                                                                  04120000
041300 LINKAGE SECTION.                                                 04130000
041400                                                                  04140000
041500***************************************************************** 04150000
041600 PROCEDURE DIVISION.                                              04160000
041700***************************************************************** 04170000
041800                                                                  04180000
041900 0000-MAINLINE-PROCESSING.                                        04190000
042000                                                                  04200000
042100     DISPLAY 'START OF PROGRAM RCKUT172'.                         04210000
042200                                                                  04220000
042210     MOVE PC-PROGRESSIVE-READ-LIMIT TO PV-DISP-NBR.               04221011
042220     DISPLAY 'PROGRESSIVE READ DISPLAY TRIGGER IS:  '             04222011
042230             PV-DISP-NBR.                                         04223011
042240                                                                  04224011
042300     PERFORM 1000-INITIALIZATION.                                 04230000
042400                                                                  04240000
042500     PERFORM 2000-PROCESS-PKSL-INPUT-FILE                         04250006
042600       UNTIL END-OF-PKSL-FILE.                                    04260002
042700                                                                  04270000
042800     IF  PV-READ-COUNT = 0                                        04280000
042900         DISPLAY ' '                                              04290000
043000         DISPLAY '*** EMPTY INPUT FILE ***'                       04300000
043100         DISPLAY ' '                                              04310000
043200     END-IF.                                                      04320000
043300                                                                  04330000
043400     PERFORM 8500-SHOW-COUNTERS.                                  04340000
043500                                                                  04350000
043600     CLOSE PACKSLIP-CARTON-FILE-IN                                04360001
043610           SSCC-CARTON-FILE-IN                                    04361002
043700           PACKSLIP-CARTON-FILE-OUT.                              04370001
043800                                                                  04380000
043900     STOP RUN.                                                    04390000
044000                                                                  04400000
044100                                                                  04410000
044200******************************************************************04420000
044300*  OPEN FILES AND READ THE FIRST INPUT RECORD                    *04430000
044400******************************************************************04440000
044500 1000-INITIALIZATION.                                             04450000
044600                                                                  04460000
044700     OPEN INPUT  PACKSLIP-CARTON-FILE-IN                          04470002
044710                 SSCC-CARTON-FILE-IN.                             04471002
044800     OPEN OUTPUT PACKSLIP-CARTON-FILE-OUT.                        04480001
044900                                                                  04490000
047000     PERFORM 7000-READ-PKSL-INPUT.                                04700002
047001     PERFORM 7200-READ-SSCC-INPUT.                                04700108
047010                                                                  04701002
047020     IF  END-OF-PKSL-FILE                                         04702002
047030         CONTINUE                                                 04703002
047040     ELSE                                                         04704002
047050         IF  RC001-CARTON-IND = SPACE                             04705002
047060         AND RC001-SEQUENCE-NBR = ZERO                            04706002
047070             CONTINUE                                             04707002
047080         ELSE                                                     04708002
047081               DISPLAY '**************************************'   04708103
047082               DISPLAY '** INVALID FIRST RECORD ON INP01 FILE '   04708203
047083               DISPLAY '** THIS IS THE RCRD001 PACKSLIP INPUT '   04708303
047084               DISPLAY '** FILE - FIRST RECORD IS NOT A HEADER'   04708403
047085               DISPLAY '** TYPE RECORD                        '   04708503
047086               DISPLAY '**************************************'   04708603
047087               MOVE '1000-INITIALIZATION' TO PV-PARAGRAPH-NAME    04708703
047090             PERFORM 9999-ABEND                                   04709003
047091         END-IF                                                   04709103
047092     END-IF.                                                      04709203
047100                                                                  04710000
047200                                                                  04720000
047300******************************************************************04730000
047400* THIS PARAGRAPH WILL MANAGE THE FLOW OF THE PROGRAM.  WHEN THE  *04740010
047500* RECORD ON THE RCRD001 INPUT FILE IS A HEADER RECORD, THEN THIS *04750010
047510* PARAGRAPH WILL MANAGE READING THE RCRD102 FILE TO COUNT THE    *04751010
047520* NUMBER OF CARTONS FOR THE DC/BOL/PO AND THEN WRITING OUT THE   *04752010
047530* HEADER RECORD TO THE RCRD001 OUTPUT FILE.                      *04753010
047540* IN THIS PROGRAM, EVERY RECORD ON THE RCRD001 INPUT FILE WILL   *04754010
047550* BE WRITTEN TO THE RCRD001 OUTPUT FILE AND THE ONLY RECORD TYPE *04755010
047560* THAT WOULD BE CHANGED ON THE OUTPUT FILE IS THE HEADER TYPE    *04756010
047570* RECORD HAVING THE UPDATED CARTON COUNTS.                       *04757010
047600******************************************************************04760000
047700 2000-PROCESS-PKSL-INPUT-FILE.                                    04770006
047800                                                                  04780000
047810     IF  RC001-CARTON-IND = SPACE                                 04781003
047820     AND RC001-SEQUENCE-NBR = ZERO                                04782003
047822         SET PS-PO-COUNT-NOT-DONE TO TRUE                         04782204
047823         MOVE ZERO TO PV-PO-CARTON-QTY                            04782304
047824         MOVE RC001-DIST-CNTR          TO                         04782408
047825              PV-PKSLIP-DIST-CNTR                                 04782508
047826         MOVE RC001-BILL-OF-LADING-NBR TO                         04782608
047827              PV-PKSLIP-BILL-OF-LADING-NBR                        04782708
047828         MOVE RC001-PO-NBR             TO                         04782808
047829              PV-PKSLIP-PO-NBR                                    04782908
047830         PERFORM 3000-GET-CARTON-COUNT                            04783004
047840           UNTIL PS-PO-COUNT-DONE                                 04784004
047841              OR END-OF-SSCC-FILE                                 04784105
047850         MOVE PV-PO-CARTON-QTY TO RC001-CARTON-CNT-STORE          04785004
047860                                  RC001-CARTON-CNT-PO             04786004
047861     END-IF.                                                      04786104
047862                                                                  04786204
047870     PERFORM 8000-WRITE-PKSL-OUTPUT.                              04787004
048600                                                                  04860000
048700     PERFORM 7000-READ-PKSL-INPUT.                                04870002
048800                                                                  04880000
048900******************************************************************04890000
049000* THIS PARAGRAPH WILL CONTROL THE READING OF THE RCRD102 FILE TO *04900010
049100* GET THE NEEDED CARTON COUNTS.                                  *04910010
049200******************************************************************04920000
049210 3000-GET-CARTON-COUNT.                                           04921004
049400                                                                  04940000
049403     IF  END-OF-SSCC-FILE                                         04940305
049404         SET PS-PO-COUNT-DONE TO TRUE                             04940405
049405     ELSE                                                         04940505
049406         IF  PV-SSCC-FILE-KEY    = PV-PKSLIP-FILE-KEY             04940608
049411             ADD +1 TO PV-PO-CARTON-QTY                           04941105
049412             PERFORM 7200-READ-SSCC-INPUT                         04941207
049420         ELSE                                                     04942005
049430             IF  PV-SSCC-FILE-KEY < PV-PKSLIP-FILE-KEY            04943008
049440                 PERFORM 7200-READ-SSCC-INPUT                     04944008
049450             ELSE                                                 04945008
049500                 SET PS-PO-COUNT-DONE TO TRUE                     04950008
049501             END-IF                                               04950108
049510         END-IF                                                   04951005
049520     END-IF.                                                      04952005
050900                                                                  05090000
051000                                                                  05100000
099800******************************************************************09980000
099900* READ A SHIPPED MERHANDISE INPUT FILE RECORD                    *09990010
100000******************************************************************10000000
100100 7000-READ-PKSL-INPUT.                                            10010002
100200                                                                  10020000
100300     READ PACKSLIP-CARTON-FILE-IN                                 10030006
100400       INTO RC001-ASN-TRANSCRIPTION-RECORD                        10040006
100500         AT END                                                   10050000
100600           SET END-OF-PKSL-FILE TO TRUE                           10060002
100700         NOT AT END                                               10070000
100800           ADD +1                     TO PV-READ-COUNT            10080005
100810                                         PV-PROGRESSIVE-READ-COUNT10081000
101710           IF  PV-PROGRESSIVE-READ-COUNT =                        10171000
101720               PC-PROGRESSIVE-READ-LIMIT                          10172000
101721               MOVE PV-READ-COUNT TO PV-DISP-NBR                  10172100
101722               DISPLAY 'PROGRESSIVE PACKSLIP READ COUNT IS: '     10172206
101723                       PV-DISP-NBR                                10172300
101730               MOVE ZEROS TO PV-PROGRESSIVE-READ-COUNT            10173000
101740           END-IF                                                 10174000
101750           IF  RC001-CARTON-IND = SPACE                           10175006
101760           AND RC001-SEQUENCE-NBR = ZERO                          10176006
101770               ADD +1 TO PV-READ-HEADER-COUNT                     10177006
101780           ELSE                                                   10178006
101790               IF  RC001-DETAIL-RECORD                            10179006
101791                   ADD +1 TO PV-READ-DETAIL-COUNT                 10179106
101792               ELSE                                               10179206
101793                   IF  RC001-CARTON-RECORD                        10179306
101794                       ADD +1 TO PV-READ-CARTON-COUNT             10179406
101795                   ELSE                                           10179506
101796                       ADD +1 TO PV-READ-OTHER-COUNT              10179606
101797                   END-IF                                         10179706
101798               END-IF                                             10179806
101799           END-IF                                                 10179906
101800     END-READ.                                                    10180000
101810                                                                  10181005
101820                                                                  10182005
101830******************************************************************10183005
101840* READ A SSCC CARTON INPUT FILE RECORD                           *10184010
101850******************************************************************10185005
101860 7200-READ-SSCC-INPUT.                                            10186005
101870                                                                  10187005
101880     READ SSCC-CARTON-FILE-IN                                     10188005
101890       INTO RC102-CARTON-REC                                      10189005
101891         AT END                                                   10189105
101892           SET END-OF-SSCC-FILE TO TRUE                           10189205
101893           SET PS-PO-COUNT-DONE TO TRUE                           10189305
101894         NOT AT END                                               10189405
101895           ADD +1                     TO PV-SSCC-READ-COUNT       10189505
101896         MOVE RC102-DC-NBR             TO                         10189608
101897              PV-SSCC-DIST-CNTR                                   10189708
101898         MOVE RC102-BOL-NBR            TO                         10189808
101899              PV-SSCC-BILL-OF-LADING-NBR                          10189908
101900         MOVE RC102-KOHLS-ORD-NBR      TO                         10190008
101910              PV-SSCC-PO-NBR                                      10191008
101912     END-READ.                                                    10191205
101920                                                                  10192005
102000                                                                  10200000
102100******************************************************************10210000
102200* MOVE ALL OF THE DATA TO THE HEADER RECORD AND WRITE OUT THE    *10220010
102210* HEADER RECORD TO THE OUTPUT FILE.                              *10221010
102300******************************************************************10230000
102310 8000-WRITE-PKSL-OUTPUT.                                          10231004
102500                                                                  10250000
102510     IF  RC001-CARTON-IND = SPACE                                 10251004
102520     AND RC001-SEQUENCE-NBR = ZERO                                10252004
102530         ADD +1 TO PV-WRITE-HEADER-COUNT                          10253004
102560     ELSE                                                         10256004
102570         IF  RC001-DETAIL-RECORD                                  10257004
102580             ADD +1 TO PV-WRITE-DETAIL-COUNT                      10258004
102590         ELSE                                                     10259004
102591             IF  RC001-CARTON-RECORD                              10259104
102592                 ADD +1 TO PV-WRITE-CARTON-COUNT                  10259204
102593             ELSE                                                 10259304
102594                 ADD +1 TO PV-WRITE-OTHER-COUNT                   10259404
102595             END-IF                                               10259504
102596         END-IF                                                   10259604
102597     END-IF.                                                      10259704
102600                                                                  10260004
106300     WRITE PACKSLIP-CARTON-RECORD-OUT                             10630004
106400      FROM RC001-ASN-TRANSCRIPTION-RECORD.                        10640000
106500                                                                  10650000
106700     ADD +1 TO PV-WRITE-TOTAL-COUNT.                              10670004
106800                                                                  10680000
106900                                                                  10690000
113100******************************************************************11310000
113200* DISPLAY RECORD COUNTS AT THE END OF THE RUN OF THE PROGRAM     *11320010
113300******************************************************************11330000
113400 8500-SHOW-COUNTERS.                                              11340000
113500     DISPLAY ' *********  RCKUT172 STATISTICS *********'          11350000
113510     MOVE PV-READ-HEADER-COUNT    TO PV-DISP-NBR-C                11351008
113520     DISPLAY 'HEADER PKSLIP RECORDS READ= ' PV-DISP-NBR-C.        11352008
113530     MOVE PV-READ-DETAIL-COUNT    TO PV-DISP-NBR-C                11353008
113540     DISPLAY 'DETAIL PKSLIP RECORDS READ= ' PV-DISP-NBR-C.        11354008
113550     MOVE PV-READ-CARTON-COUNT    TO PV-DISP-NBR-C                11355008
113560     DISPLAY 'CARTON PKSLIP RECORDS READ= ' PV-DISP-NBR-C.        11356008
113570     MOVE PV-READ-OTHER-COUNT     TO PV-DISP-NBR-C                11357008
113580     DISPLAY 'OTHER PKSLIP RECORDS READ = ' PV-DISP-NBR-C.        11358008
113600     MOVE PV-READ-COUNT           TO PV-DISP-NBR-C                11360000
113700     DISPLAY 'TOTAL PKSLIP RECORDS READ = ' PV-DISP-NBR-C.        11370008
113710     MOVE PV-SSCC-READ-COUNT      TO PV-DISP-NBR-C                11371006
113720     DISPLAY 'SSCC CARTON RECORDS READ  = ' PV-DISP-NBR-C.        11372006
113800     MOVE PV-WRITE-HEADER-COUNT   TO PV-DISP-NBR-C                11380000
113900     DISPLAY 'HEADER RECORDS WRITTEN    = ' PV-DISP-NBR-C.        11390000
114000     MOVE PV-WRITE-DETAIL-COUNT   TO PV-DISP-NBR-C                11400000
114100     DISPLAY 'DETAIL RECORDS WRITTEN    = ' PV-DISP-NBR-C.        11410000
114200     MOVE PV-WRITE-CARTON-COUNT   TO PV-DISP-NBR-C                11420000
114300     DISPLAY 'CARTON RECORDS WRITTEN    = ' PV-DISP-NBR-C.        11430000
114310     MOVE PV-WRITE-OTHER-COUNT    TO PV-DISP-NBR-C                11431004
114320     DISPLAY 'OTHER RECORDS WRITTEN     = ' PV-DISP-NBR-C.        11432004
114400     MOVE PV-WRITE-TOTAL-COUNT    TO PV-DISP-NBR-C.               11440000
114500     DISPLAY 'TOTAL NBR RECORDS WRITTEN = ' PV-DISP-NBR-C.        11450000
114800                                                                  11480000
117710******************************************************************11771003
117720* 9999-ABEND                                                      11772003
117730*     ABEND PROGRAM WHEN AN ERROR OCCURS.                         11773003
117740******************************************************************11774003
117750 9999-ABEND.                                                      11775003
117760                                                                  11776003
117770     DISPLAY '** ABEND           **'.                             11777003
117780     DISPLAY '** PROGRAM         ** = ' PC-CURRENT-PROGRAM-NAME.  11778003
117790     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        11779003
117791     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         11779103
117800* ************************ END OF RCKUT172 ********************** 11780000
