000100 IDENTIFICATION DIVISION.                                         00010001
000200 PROGRAM-ID.      XSKRP038.                                       00020001
000300 AUTHOR.          NANCY MARTIN                                    00030001
000400 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00040001
000500 DATE-WRITTEN.    10/05/2004.                                     00050001
000600 DATE-COMPILED.                                                   00060001
000700******************************************************************00070001
000800**XS DOMAIN TABLE INTEGRITY CHECK - FOR TABLE XST_PRCHG           00080001
000900******************************************************************00090001
001000**THIS PROGRAM VALIDATES THE DATA IN THE XS DOMAIN IS THE SAME    00100001
001100**AS THE DATA IN THE SOR                                          00110001
001150**   THIS PROGRAM WAS CLONED FROM XSKRP011                        00120001
001160**   CREATED FOR NEW PERM SYSTEM WORK WR27634                     00121021
001200******************************************************************00122001
      * DATE:        02/04/2005                                         00122230
      * WR/IR#:      WR27634                                            00122330
      * PROGRAMMER:  NANCY MARTIN                                       00122430
      * DESCRIPTION: CHANGE TO NOT HAVE EMPTY SOR FILE TRIGGER MSG.     00122530
      *                                                                 00122630
      *--------------------------------------------------------------*  00122736
      * DATE:        07/26/2010                                         00122836
      * WR/IR#:      WR36734                                            00122936
      * PROGRAMMER:  DAVE METZGER                                       00123036
      * DESCRIPTION: REMOVED TMST VALIDATION CHECK AS PART OF THE       00123136
      *              MDO SPRING 2010 PROJECT DUE TO MESSAGING           00123236
      *              CHANGES FROM PERM TO XS.                           00123336
      *                                                                 00123436
      *--------------------------------------------------------------*  00123630
      * DATE:                                                           00123730
      * WR/IR#:                                                         00123830
      * PROGRAMMER:                                                     00123930
      * DESCRIPTION:                                                    00124030
      *                                                                 00124130
      *--------------------------------------------------------------*  00124230
001300 ENVIRONMENT DIVISION.                                            00124301
001400 CONFIGURATION SECTION.                                           00124401
001500 SOURCE-COMPUTER.        IBM-3090.                                00125001
001600 OBJECT-COMPUTER.        IBM-3090.                                00126001
001700 INPUT-OUTPUT SECTION.                                            00127001
001800 FILE-CONTROL.                                                    00128001
001900                                                                  00129001
002400     SELECT SOR-PRCHG-EXTRACT-FILE                                00150002
002500            ASSIGN TO INP01.                                      00160001
002600     SELECT XS-PRCHG-EXTRACT-FILE                                 00170001
002700            ASSIGN TO INP02.                                      00180001
002800     SELECT XS-PRCHG-INTEG-RPT-FILE                               00190001
002900            ASSIGN TO RPT01.                                      00200001
003000                                                                  00210001
003100 DATA DIVISION.                                                   00220001
003200 FILE SECTION.                                                    00230001
003300                                                                  00240001
004800 FD  SOR-PRCHG-EXTRACT-FILE                                       00320001
004900     RECORDING MODE F                                             00330001
005000     BLOCK CONTAINS 0 RECORDS                                     00340001
005100     LABEL RECORDS ARE OMITTED                                    00350001
005200     DATA RECORD IS SOR-PRCHG-EXTRACT-RECORD.                     00360001
005300 01  SOR-PRCHG-EXTRACT-RECORD        PIC X(200).                  00370001
005400                                                                  00380001
005500 FD  XS-PRCHG-EXTRACT-FILE                                        00390001
005600     RECORDING MODE F                                             00400001
005700     BLOCK CONTAINS 0 RECORDS                                     00410001
005800     LABEL RECORDS ARE OMITTED                                    00420001
005900     DATA RECORD IS XS-PRCHG-EXTRACT-RECORD.                      00430001
006000 01  XS-PRCHG-EXTRACT-RECORD         PIC X(130).                  00440026
006100                                                                  00450001
006200 FD  XS-PRCHG-INTEG-RPT-FILE                                      00460001
006300     RECORDING MODE IS F                                          00470001
006400     BLOCK CONTAINS 0  RECORDS.                                   00480001
006500 01  XS-PRCHG-INTEG-RPT-RECORD       PIC  X(200).                 00490001
006600                                                                  00500001
006700 WORKING-STORAGE SECTION.                                         00510001
006800                                                                  00520001
006900 01  FILLER                              PIC X(41)                00530001
007000     VALUE 'WORKING STORAGE STARTS HERE FOR XSKRP038'.            00540001
007100                                                                  00550001
007200 01  PS-PROGRAM-SWITCHES.                                         00560001
007900     05  PS-END-OF-SOR-PRCHG-SW          PIC X(01) VALUE 'N'.     00600001
008000         88  PS-END-OF-SOR-PRCHG                   VALUE 'Y'.     00610001
008100         88  PS-NOT-END-OF-SOR-PRCHG               VALUE 'N'.     00620001
008200     05  PS-END-OF-XS-PRCHG-SW           PIC X(01) VALUE 'N'.     00630001
008300         88  PS-END-OF-XS-PRCHG                    VALUE 'Y'.     00640001
008400         88  PS-NOT-END-OF-XS-PRCHG                VALUE 'N'.     00650001
008800     05  PS-PRCHG-ID-ERROR-SW            PIC X(01) VALUE 'N'.     00690001
008900         88  PS-PRCHG-ID-ERROR                     VALUE 'Y'.     00700001
009000         88  PS-NO-PRCHG-ID-ERROR                  VALUE 'N'.     00710001
009100     05  PS-ERROR-FOUND-SW               PIC X(01) VALUE 'N'.     00720001
009200         88  PS-ERROR-FOUND                        VALUE 'Y'.     00730001
009300         88  PS-NO-ERROR-FOUND                     VALUE 'N'.     00740001
009400                                                                  00750001
010500 01  PC-PROGRAM-CONSTANTS.                                        00760001
010600     05  PC-CURRENT-PROGRAM-NAME         PIC X(08)  VALUE         00770001
010700                                                    'XSKRP038'.   00780001
010800     05  PC-REPORT-NBR-1                 PIC  9(01) VALUE 1.      00790001
010900     05  PC-ONE                          PIC  9(01) VALUE 1.      00800001
NEMTST     05  PC-NULL                         PIC S9(04) VALUE -1.     00801008
011200     05  PC-MAX-REPORT-LINES             PIC S9(05) VALUE +74     00810001
011300                                                    COMP-3.       00820001
011400                                                                  00830001
011500     05  PC-NO-ERROR-MESSAGE             PIC  X(200) VALUE        00840001
011600         'NO ERRORS'.                                             00850001
011900                                                                  00860001
012000     05  PC-MISMATCHED-PRCHG-ID          PIC  X(35) VALUE         00870001
012100         'PRCHG ID NUMBERS NOT IN SYNCH      '.                   00880001
012500                                                                  00920001
012600     05  PC-MISSING-FROM-SOR-PRCHG       PIC  X(53) VALUE         00960001
012700         'MATCHING DATA IS NOT FOUND ON SOR PRCHG EXTRACT   '.    00970001
012800                                                                  00980001
012900     05  PC-MISSING-FROM-XS-PRCHG        PIC  X(52) VALUE         00990001
013000         'MATCHING DATA IS NOT FOUND ON XS PRCHG EXTRACT   '.     01000001
013100                                                                  01010001
012600     05  PC-EXTRA-FOUND-SOR-PRCHG        PIC  X(53) VALUE         01020001
012700         'ADDITIONAL DATA FOUND FOR SOR PRCHG EXTRACT      '.     01030001
012800                                                                  01040001
012900     05  PC-EXTRA-FOUND-XS-PRCHG        PIC  X(52) VALUE          01050001
013000         'ADDITTIONAL DATA FOUND ON XS PRCHG EXTRACT       '.     01060001
013100                                                                  01070001
           05  PC-EMPTY-SOR-PRCHG              PIC  X(53) VALUE         01070127
               'NO DATA RECEIVED FROM SOR PRCHG EXTRACT      '.         01070231
                                                                        01070327
013200 01  PV-MISCELANEOUS.                                             01080001
NEMCHG     05  PV-TEMP-PRCHG-ID                PIC S9(11) COMP          01090001
NEMCHG                                                    VALUE ZEROS.  01100001
013400     05  PV-PRINT-RECORD                 PIC X(200) VALUE SPACE.  01110001
013500     05  PV-LINE-SPACING                 PIC S9(04) VALUE ZEROES  01120001
013600                                                    COMP SYNC.    01130001
013700     05  PV-CURR-TIME.                                            01140001
013800        10  PV-CURR-TIME-HH              PIC  9(02) VALUE ZEROES. 01150001
013900        10  PV-CURR-TIME-MM              PIC  9(02) VALUE ZEROES. 01160001
014000        10  PV-CURR-TIME-SSHH            PIC  9(04) VALUE ZEROES. 01170001
014100                                                                  01180001
014200     05  PV-CURR-DATE-CCYYMMDD.                                   01190001
014300         10  PV-CURR-DATE-CCYY           PIC  9(04) VALUE ZEROES. 01200001
014400         10  PV-CURR-DATE-MM             PIC  9(02) VALUE ZEROES. 01210001
014500         10  PV-CURR-DATE-DD             PIC  9(02) VALUE ZEROES. 01220001
014600                                                                  01230001
014700 01  PV-PROGRAM-COUNTER.                                          01240001
014800     05  PV-PAGE-CNT                     PIC  9(05) VALUE ZEROS.  01250001
014900     05  PV-LINE-CNT                     PIC S9(07) VALUE ZEROS.  01260001
015000     05  PV-SOR-PRCHG-RECS-READ-CNT      PIC  9(09) VALUE ZEROS.  01270001
015200     05  PV-XS-EXTRACT-REC-READ-CNT      PIC  9(09) VALUE ZEROS.  01271015
015000     05  PV-SOR-PRCHG-RECS-UNIQUE        PIC  9(09) VALUE ZEROS.  01280015
015200     05  PV-XS-EXTRACT-REC-UNIQUE        PIC  9(09) VALUE ZEROS.  01291015
015000     05  PV-SOR-XS-COMMON-CNT            PIC  9(09) VALUE ZEROS.  01292015
015000     05  PV-SOR-XS-TOTAL-CNT             PIC  9(09) VALUE ZEROS.  01293017
015300     05  PV-ERROR-RECORD-WRITTEN-CNT     PIC  9(09) VALUE ZEROS.  01300001
015400     05  PV-VALID-MATCH-CNT              PIC  9(09) VALUE ZEROS.  01310001
015500                                                                  01320001
015600 01  PV-MISC-ABEND-FIELDS.                                        01330001
015700     05  PV-PARAGRAPH-NAME               PIC  X(30) VALUE SPACE.  01340001
015800     05  PV-OPERATION-MSG-1              PIC  X(40) VALUE SPACE.  01350001
015900     05  PV-OPERATION-MSG-2              PIC  X(40) VALUE SPACE.  01360001
016100                                                                  01380001
016200 01  PV-ABEND-CODE   COMP  SYNC          PIC S9(04) VALUE +0000.  01390001
016300     88  PV-ABEND-4008-DATA-ERROR                   VALUE +4008.  01400001
016400     88  PV-ABEND-4009-CARD-ERROR                   VALUE +4009.  01410001
016700                                                                  01430001
016800******************************************************************01440001
016900*  TOP OF PAGE HEADING LINE FOR PRINTING A 200 CHARACTER REPORT.  01450001
017000******************************************************************01460001
017100     COPY DPWS200.                                                01470001
017200                                                                  01480001
017300 01  HL2-HEADING-LINE-2.                                          01490001
017400     05  FILLER                  PIC X(84)   VALUE SPACES.        01500001
017500     05  FILLER                  PIC X(33)   VALUE                01510001
017600         'XS PRCHG    DATA INTEGRITY ERRORS'.                     01520001
017700     05  FILLER                  PIC X(83)   VALUE SPACES.        01530001
017800                                                                  01540001
017900 01  HL3-HEADING-LINE-3.                                          01550001
018000     05  FILLER                  PIC X(02)   VALUE SPACES.        01560001
018400     05  FILLER                  PIC X(09)   VALUE                01570003
018500         'PRCHG ID '.                                             01580003
018600     05  FILLER                  PIC X(02)   VALUE SPACES.        01600001
018700     05  FILLER                  PIC X(06)   VALUE                01610002
018800         'SOURCE'.                                                01620002
019000     05  FILLER                  PIC X(34)   VALUE                01621004
019100         '  ------PRCHG DESCRIPTION-------  '.                    01622004
***************   123456789-123456789-123456789-                        01623005
019000     05  FILLER                  PIC X(26)   VALUE                01660006
019100         'DEPT  EVNT TYP  STAT ALL '.                             01670007
*************   123456789-123456789-123456789                           01671006
019200     05  FILLER                  PIC X(52)   VALUE SPACES.        01680012
019000     05  FILLER                  PIC X(36)   VALUE                01682001
019100         '  ----------------- ERROR MESSAGE(S)'.                  01683001
019200     05  FILLER                  PIC X(25)   VALUE                01684001
019300         ' ------------------------'.                             01685001
017900 01  HL4-HEADING-LINE-4.                                          01685102
018000     05  FILLER                  PIC X(19)   VALUE SPACES.        01685202
019000     05  FILLER                  PIC X(34)   VALUE SPACES.        01685906
019000     05  FILLER                  PIC X(26)   VALUE                01686106
019100         'NBR   CTG  CDE  CDE  IND '.                             01686207
019000     05  FILLER                  PIC X(40)   VALUE                01686413
019100         '  APPROVE TIMESTAMP       ---SOR UPDATE '.              01686512
*************   123456789-123456789-123456789-12345678                  01686613
019200     05  FILLER                  PIC X(12)   VALUE                01686712
019300         'TIMESTAMP---'.                                          01686812
*************   123456789-123456789                                     01686902
019200     05  FILLER                  PIC X(85)   VALUE SPACES.        01687012
019500                                                                  01687101
019600******************************************************************01687201
019700*  DETAIL LINE LAYOUT FOR THE ERROR REPORT.                       01688001
019800******************************************************************01689001
019900 01  DL1-DETAIL-LINE-1.                                           01690001
020000     05  FILLER                  PIC X(01)     VALUE SPACES.      01700001
020100     05  DL1-PRCHG-ID            PIC Z(10)-    VALUE ZEROES.      01710002
021000     05  FILLER                  PIC X(03)     VALUE SPACES.      01780004
020300     05  DL1-SOURCE              PIC X(03)     VALUE SPACES.      01790002
021200     05  FILLER                  PIC X(123)    VALUE SPACES.      01800012
021100     05  DL1-ERROR-MESSAGE       PIC X(55)     VALUE SPACES.      01810001
021200     05  FILLER                  PIC X(02)     VALUE SPACES.      01820001
021300                                                                  01830001
019900 01  DLS-DETAIL-LINE-1-SOR.                                       01840001
020000     05  FILLER                  PIC X(01)     VALUE SPACES.      01850001
020100     05  DLS-SOR-PRCHG-ID        PIC Z(10)-    VALUE ZEROES.      01860001
021000     05  FILLER                  PIC X(03)     VALUE SPACES.      01870004
020300     05  DLS-SOURCE              PIC X(03)     VALUE 'SOR'.       01880002
020600     05  FILLER                  PIC X(03)     VALUE SPACES.      01890004
020300     05  DLS-SOR-DESC            PIC X(30)     VALUE SPACES.      01900002
021200     05  FILLER                  PIC X(01)     VALUE SPACES.      01910006
020300     05  DLS-SOR-DEPT            PIC -Z(4)     VALUE ZEROES.      01920002
021000     05  FILLER                  PIC X(02)     VALUE SPACES.      01930001
020300     05  DLS-SOR-EVNT-CTG        PIC X(03)     VALUE ZEROES.      01940002
021000     05  FILLER                  PIC X(02)     VALUE SPACES.      01950001
020300     05  DLS-SOR-TYP-CDE         PIC X(03)     VALUE SPACES.      01960002
021200     05  FILLER                  PIC X(02)     VALUE SPACES.      01970001
020300     05  DLS-SOR-ST-CDE          PIC X(03)     VALUE SPACES.      01980002
021200     05  FILLER                  PIC X(02)     VALUE SPACES.      01990001
020300     05  DLS-SOR-ALL-RMNG        PIC X(01)     VALUE SPACES.      02000002
021200     05  FILLER                  PIC X(02)     VALUE SPACES.      02010001
020300     05  DLS-SOR-APP-TMST        PIC X(26)     VALUE ZEROES.      02020002
021200     05  FILLER                  PIC X(02)     VALUE SPACES.      02030001
020300     05  DLS-SOR-SOR-UPD         PIC X(26)     VALUE ZEROES.      02040002
021200     05  FILLER                  PIC X(02)     VALUE SPACES.      02050002
021100     05  FILLER                  PIC X(12)     VALUE 'MISMATCH'.  02080001
021100     05  DLS-ERR-DESC            PIC X(12)     VALUE SPACES.      02090002
021100     05  DLS-ERR-DEPT            PIC X(12)     VALUE SPACES.      02100002
021100     05  DLS-ERR-EVNT-CTG        PIC X(12)     VALUE SPACES.      02110002
021100     05  DLS-ERR-TYP-CDE         PIC X(12)     VALUE SPACES.      02120002
021200     05  FILLER                  PIC X(01)     VALUE SPACES.      02130001
021300                                                                  02140001
019900 01  DLX-DETAIL-LINE-1-XS.                                        02150001
020200     05  FILLER                  PIC X(01)     VALUE SPACES.      02160003
020500     05  DLX-XS-PRCHG-ID         PIC Z(10)-    VALUE ZEROES.      02170001
021000     05  FILLER                  PIC X(03)     VALUE SPACES.      02181006
020300     05  DLX-SOURCE              PIC X(03)     VALUE 'XS '.       02182002
021200     05  FILLER                  PIC X(03)     VALUE SPACES.      02183006
020300     05  DLX-XS-DESC             PIC X(30)     VALUE SPACES.      02210002
021200     05  FILLER                  PIC X(01)     VALUE SPACES.      02220006
020300     05  DLX-XS-DEPT             PIC -Z(4)     VALUE ZEROES.      02230002
021000     05  FILLER                  PIC X(02)     VALUE SPACES.      02240001
020300     05  DLX-XS-EVNT-CTG         PIC X(03)     VALUE ZEROES.      02250002
021000     05  FILLER                  PIC X(02)     VALUE SPACES.      02260001
020300     05  DLX-XS-TYP-CDE          PIC X(03)     VALUE SPACES.      02270002
021200     05  FILLER                  PIC X(02)     VALUE SPACES.      02280001
020300     05  DLX-XS-ST-CDE           PIC X(03)     VALUE SPACES.      02290002
021200     05  FILLER                  PIC X(02)     VALUE SPACES.      02300001
020300     05  DLX-XS-ALL-RMNG         PIC X(01)     VALUE SPACES.      02310002
021200     05  FILLER                  PIC X(02)     VALUE SPACES.      02320001
020300     05  DLX-XS-APP-TMST         PIC X(26)     VALUE ZEROES.      02330002
021200     05  FILLER                  PIC X(02)     VALUE SPACES.      02340001
020300     05  DLX-XS-SOR-UPD          PIC X(26)     VALUE ZEROES.      02350002
021200     05  FILLER                  PIC X(02)     VALUE SPACES.      02360001
021100     05  DLX-ERR-ST-CDE          PIC X(12)     VALUE SPACES.      02390002
021100     05  DLX-ERR-ALL-RMNG        PIC X(12)     VALUE SPACES.      02391002
021100     05  DLX-ERR-APP-TMST        PIC X(12)     VALUE SPACES.      02410002
021100     05  DLX-ERR-SOR-UPD         PIC X(12)     VALUE SPACES.      02420002
021200     05  FILLER                  PIC X(13)     VALUE SPACES.      02440002
021300                                                                  02450001
021400******************************************************************02460001
021500*  TRAILER LAYOUT FOR THE ERROR REPORT.                           02470001
021600******************************************************************02480001
021700 01  TR1-TRAILER-LINE-1.                                          02490001
021800     05  FILLER                  PIC X(25)   VALUE                02500001
021900         ' TOTAL NUMBER OF ERRORS: '.                             02510001
022000     05  TR1-TOTAL-ERROR-CNT     PIC Z(09)   VALUE ZEROS.         02520001
022100     05  FILLER                  PIC X(166)  VALUE SPACES.        02530001
022200                                                                  02540001
022300******************************************************************02550001
022400**COPYBOOKS                                                       02560001
022500******************************************************************02570001
022600                                                                  02580001
022700***SOR EXTRACT FILE LAYOUT                                        02590001
022800     COPY PERD103.                                                02600001
022900                                                                  02610001
023000***XS EXTRACT FILE LAYOUT                                         02620001
023100     COPY XSRD069.                                                02630001
023200                                                                  02640001
023300***************************************************************** 02680001
023400 PROCEDURE DIVISION.                                              02690001
023500***************************************************************** 02700001
023600 0000-MAINLINE.                                                   02710001
023700                                                                  02720001
023800     PERFORM 1000-INITIALIZATION.                                 02730001
023900                                                                  02740001
           IF PS-NOT-END-OF-SOR-PRCHG                                   02741027
024000        PERFORM 2000-PROCESS-RECORDS                              02750027
024100          UNTIL PS-END-OF-SOR-PRCHG                               02760027
024200             OR PS-END-OF-XS-PRCHG                                02770027
           END-IF.                                                      02771027
024300                                                                  02780001
024400     PERFORM 2200-PROCESS-EXTRA-RECORDS                           02790001
024500       UNTIL PS-END-OF-SOR-PRCHG                                  02800001
024600         AND PS-END-OF-XS-PRCHG.                                  02810001
024700                                                                  02820001
024710     IF PV-ERROR-RECORD-WRITTEN-CNT = 0                           02830001
024720         MOVE PC-NO-ERROR-MESSAGE TO DL1-DETAIL-LINE-1            02840001
024730         MOVE DL1-DETAIL-LINE-1   TO PV-PRINT-RECORD              02850001
024740         PERFORM 8900-WRITE-REPORT-LINE                           02860001
024750     ELSE                                                         02870001
024760         MOVE PV-ERROR-RECORD-WRITTEN-CNT TO                      02880001
024770                TR1-TOTAL-ERROR-CNT                               02890001
024780         MOVE TR1-TRAILER-LINE-1  TO PV-PRINT-RECORD              02900001
024790         PERFORM 8900-WRITE-REPORT-LINE                           02910001
024791     END-IF.                                                      02920001
024792                                                                  02930001
024800     PERFORM 9000-END-OF-PGM.                                     02940001
024900                                                                  02950001
025000     GOBACK.                                                      02960001
025100                                                                  02970001
025200******************************************************************02980001
025300*1000-INITIALIZATION.                                             02990001
025400* INITIALIZATION AREA                                             03000001
025500******************************************************************03010001
025600 1000-INITIALIZATION.                                             03020001
025700                                                                  03030001
025800     INITIALIZE PV-PROGRAM-COUNTER.                               03040001
025900                                                                  03050001
026000     OPEN INPUT  SOR-PRCHG-EXTRACT-FILE                           03060001
026300                 XS-PRCHG-EXTRACT-FILE.                           03080001
026400                                                                  03090001
026500     OPEN OUTPUT XS-PRCHG-INTEG-RPT-FILE.                         03100001
026600                                                                  03110001
031100     ACCEPT PV-CURR-TIME FROM TIME.                               03120029
031200     MOVE PV-CURR-TIME-HH          TO DP200-RUN-HOUR.             03130029
031300     MOVE PV-CURR-TIME-MM          TO DP200-RUN-MINUTE.           03140029
031400                                                                  03150029
031500     MOVE FUNCTION CURRENT-DATE (1:8)                             03160029
031600                                   TO PV-CURR-DATE-CCYYMMDD.      03170029
031700                                                                  03180029
031800     MOVE PV-CURR-DATE-MM          TO DP200-RUN-MONTH.            03190029
031900     MOVE PV-CURR-DATE-DD          TO DP200-RUN-DAY.              03200029
032000     MOVE PV-CURR-DATE-CCYY        TO DP200-RUN-YEAR.             03210029
032100                                                                  03220029
032200     MOVE PC-CURRENT-PROGRAM-NAME  TO DP200-PROGRAM-NAME.         03230029
032300                                                                  03240029
032400     PERFORM 8700-REPORT-HEADER-ROUTINE.                          03241029
032500                                                                  03242029
029300     PERFORM 7000-READ-SOR-PRCHG-EXTRACT                          03250001
029600                                                                  03280001
029700     IF PS-END-OF-SOR-PRCHG                                       03290001
              MOVE ZEROES             TO DL1-PRCHG-ID                   03292027
                                         PE103-PRCHG-ID                 03293027
              MOVE 'SOR'              TO DL1-SOURCE                     03294027
              MOVE PC-EMPTY-SOR-PRCHG TO DL1-ERROR-MESSAGE              03300027
              MOVE DL1-DETAIL-LINE-1  TO PV-PRINT-RECORD                03320027
NEMDEL**** NOTE: THIS SITUATION WILL NOT TRIGGER RC 4 FOR MSG           03330030
NEMDEL******* ADD +1 TO PV-ERROR-RECORD-WRITTEN-CNT                     03340030
              PERFORM 8900-WRITE-REPORT-LINE                            03341027
030200     END-IF.                                                      03350001
030300                                                                  03360001
030500     PERFORM 7100-READ-XS-PRCHG-EXTRACT.                          03380001
031000                                                                  03460001
032600******************************************************************03620001
032700*2000-PROCESS-RECORDS.                                            03630001
032800* THIS SECTION COMPARES RECORDS ON THE SOR PRICE CHANGE FILE &    03640001
032900* XS DOMAIN PRCHG EXTRACT FILE. IF KEYS MATCH, PROGRAM LOOKS AT   03650001
032900* DETAIL FIELDS AND CHECKS THAT THEY MATCH, DIFFERENCES ARE       03651001
033000* REPORTED. IF THE KEY (PRCHG ID) DOES NOT APPEAR ON ONE FILE,    03660001
033010* BUT IS ON THE OTHER FILE THEN AN APPROPRIATE MESSAGE WILL BE    03670001
033100* WRITTEN TO THE ERROR FILE, ALONG WITH THE DATA THAT WAS ON      03680001
033200* THE CORRESPONDING FILES.                                        03690001
033300******************************************************************03700001
033400 2000-PROCESS-RECORDS.                                            03710001
033500                                                                  03720001
033600     INITIALIZE DL1-DETAIL-LINE-1                                 03730001
                      DLS-DETAIL-LINE-1-SOR                             03740001
                      DLX-DETAIL-LINE-1-XS                              03750001
033800                                                                  03770001
NEMTST**   DISPLAY '>>> 2000-PROCESS KEYS ARE SOR*'                     03780015
NEMTST**           PE103-PRCHG-ID,                                      03790015
NEMTST**              '== AND XS*'                                      03800015
NEMTST**           XS069-PRCHG-ID, '**'                                 03810015
033900     EVALUATE TRUE                                                03820001
034000        WHEN PE103-PRCHG-ID = XS069-PRCHG-ID                      03830001
                   ADD +1 TO PV-SOR-XS-COMMON-CNT                       03840015
034100             PERFORM 2100-COMPARE-FIELDS                          03860001
034200             PERFORM 7000-READ-SOR-PRCHG-EXTRACT                  03880001
034700             PERFORM 7100-READ-XS-PRCHG-EXTRACT                   03930002
035200*A          END-IF                                                04051401
035300        WHEN PE103-PRCHG-ID < XS069-PRCHG-ID                      04260001
NEMTST***     DISPLAY '=== SOR LOWER *'                                 04270001
NEMTST***          PE103-PRCHG-ID, '-', PE103-PRCHG-ID                  04280001
NEMTST***             '== AND XS*'                                      04290001
NEMTST***          XS069-PRCHG-ID, '-', XS069-PRCHG, '**'               04300001
035400             PERFORM 2300-CHECK-IF-NEW-PG-NEEDED                  04310001
035500             PERFORM 2400-MOVE-SOR-VALUES                         04320001
035600             MOVE PC-MISSING-FROM-XS-PRCHG                        04340001
035700                TO DL1-ERROR-MESSAGE                              04350001
035800             MOVE DL1-DETAIL-LINE-1 TO PV-PRINT-RECORD            04360001
035900             ADD +1 TO PV-ERROR-RECORD-WRITTEN-CNT                04370001
                   ADD +1 TO PV-SOR-PRCHG-RECS-UNIQUE                   04371015
036000             PERFORM 8900-WRITE-REPORT-LINE                       04380001
036100             PERFORM 7000-READ-SOR-PRCHG-EXTRACT                  04390001
036200        WHEN PE103-PRCHG-ID > XS069-PRCHG-ID                      04400001
036300             PERFORM 2300-CHECK-IF-NEW-PG-NEEDED                  04410001
036400             PERFORM 2500-MOVE-XS-VALUES                          04420001
036500             MOVE PC-MISSING-FROM-SOR-PRCHG                       04430001
036600                TO DL1-ERROR-MESSAGE                              04440001
036700             MOVE DL1-DETAIL-LINE-1 TO PV-PRINT-RECORD            04450001
036800             ADD +1 TO PV-ERROR-RECORD-WRITTEN-CNT                04460001
                   ADD +1 TO PV-XS-EXTRACT-REC-UNIQUE                   04460115
036900             PERFORM 8900-WRITE-REPORT-LINE                       04470001
037000             PERFORM 7100-READ-XS-PRCHG-EXTRACT                   04480001
037100     END-EVALUATE.                                                04490001
037200                                                                  04500001
037300******************************************************************04510001
037400*2100-COMPARE-FIELDS.                                             04520001
037500* COMPARES FIELDS BETWEEN FILES TO SEE IF ANY DIFFERENCES EXIST   04530001
037600******************************************************************04540001
037700 2100-COMPARE-FIELDS.                                             04550001
037800                                                                  04560001
037900     SET                                                          04570001
038000         PS-NO-PRCHG-ID-ERROR                                     04580001
038100         PS-NO-ERROR-FOUND               TO TRUE.                 04590001
038200                                                                  04600001
038300     IF  PE103-PRCHG-ID  NOT EQUAL XS069-PRCHG-ID                 04610001
038400         SET PS-ERROR-FOUND                                       04620001
038500         PS-PRCHG-ID-ERROR             TO TRUE                    04630001
038600     END-IF.                                                      04640001
038700                                                                  04650001
038800     IF  PE103-PRCHG-DESC NOT EQUAL XS069-PRCHG-DESC              04711002
NEMTST        IF  PE103-PRCHG-DESC-NI EQUAL PC-NULL                     04712008
NEMTST         AND XS069-PRCHG-DESC-IS-NULL                             04713008
                  CONTINUE                                              04714009
              ELSE                                                      04730108
038900            SET PS-ERROR-FOUND  TO TRUE                           04731008
021100            MOVE ' DESCRIPTION' TO  DLS-ERR-DESC                  04732008
039100        END-IF                                                    04740008
039100     END-IF.                                                      04741008
039200                                                                  04750001
           IF  PE103-DEPT-NBR-NI EQUAL PC-NULL                          04751034
              IF XS069-PRCHG-DEPT-IS-NULL                               04752034
                 CONTINUE                                               04753034
              ELSE                                                      04754034
038900           SET PS-ERROR-FOUND  TO TRUE                            04755034
021100           MOVE ' DEPARTMENT ' TO  DLS-ERR-DEPT                   04756034
              END-IF                                                    04757034
           ELSE                                                         04758034
              IF XS069-PRCHG-DEPT-IS-NULL                               04759034
038900           SET PS-ERROR-FOUND  TO TRUE                            04759134
021100           MOVE ' DEPARTMENT ' TO  DLS-ERR-DEPT                   04759234
              ELSE                                                      04759334
                 IF  PE103-DEPT-NBR NOT EQUAL XS069-DEPT-NBR            04759434
                    SET PS-ERROR-FOUND  TO TRUE                         04759534
                    MOVE ' DEPARTMENT ' TO  DLS-ERR-DEPT                04759634
                 END-IF                                                 04759834
              END-IF                                                    04790034
039100     END-IF.                                                      04791034
039200                                                                  04800001
038800     IF  PE103-EVNT-CTG-CDE NOT EQUAL XS069-EVNT-CTG-CDE          04810002
038900         SET PS-ERROR-FOUND  TO TRUE                              04820001
021100         MOVE ' EVENT CATG ' TO  DLS-ERR-EVNT-CTG                 04830002
039100     END-IF.                                                      04840001
039200                                                                  04850001
038800     IF  PE103-ALL-RMNG-STR-IND                                   04860002
                               NOT EQUAL XS069-ALL-RMNG-STR-IND         04870023
              IF  PE103-ALL-RMNG-STR-IND-NI EQUAL PC-NULL               04880022
               AND XS069-ALL-RMNG-STR-IS-NULL                           04890023
                  CONTINUE                                              04900022
              ELSE                                                      04910022
038900         SET PS-ERROR-FOUND  TO TRUE                              04940001
021100         MOVE ' ALL RMN STR' TO  DLX-ERR-ALL-RMNG                 04950002
              END-IF                                                    04960022
039100     END-IF.                                                      04961022
039200                                                                  04970001
038800     IF  PE103-PRCHG-TYP-CDE NOT EQUAL XS069-PRCHG-TYP-CDE        04980002
038900         SET PS-ERROR-FOUND  TO TRUE                              04981001
021100         MOVE ' TYPE CODE  ' TO   DLS-ERR-TYP-CDE                 04982002
039100     END-IF.                                                      04983001
039200                                                                  04984001
038800     IF  PE103-PRCHG-ST-CDE NOT EQUAL XS069-PRCHG-ST-CDE          04985002
038900         SET PS-ERROR-FOUND  TO TRUE                              04986001
021100         MOVE ' STATUS CODE' TO   DLX-ERR-ST-CDE                  04987002
039100     END-IF.                                                      04988001
039200                                                                  04989001
038800     IF  PE103-APP-TMST     NOT EQUAL XS069-APP-TMST              04991704
              IF  PE103-APP-TMST-NI EQUAL PC-NULL                       04991809
                AND XS069-APP-TMST-IS-NULL                              04991909
                  CONTINUE                                              04992009
              ELSE                                                      04992508
038900            SET PS-ERROR-FOUND  TO TRUE                           04992608
021100            MOVE ' APPROV TMST' TO   DLX-ERR-APP-TMST             04992708
039100        END-IF                                                    04993008
039100     END-IF.                                                      04993108
039200                                                                  04994001
039200* 07/26/2010 - COMMENTED OUT AS PART OF MDO SPRING 2010 PROJECT   04996038
038800*    IF  PE103-SOR-LAST-UPD-TMST                                  04997036
      *                       NOT EQUAL XS069-SOR-LAST-UPD-TMST         04997136
038900*         SET PS-ERROR-FOUND  TO TRUE                             04998036
021100*         MOVE ' SOR UPD TS ' TO  DLX-ERR-SOR-UPD                 04999036
039100*    END-IF.                                                      05010036
039200                                                                  05011001
039300     IF  PS-ERROR-FOUND                                           05016401
039400         PERFORM 2300-CHECK-IF-NEW-PG-NEEDED                      05016501
039500         PERFORM 2600-MOVE-ALL-VALUES                             05016601
039700         PERFORM 2900-MOVE-ERROR-MSG                              05016701
039800         MOVE DLS-DETAIL-LINE-1-SOR TO PV-PRINT-RECORD            05016801
040000         PERFORM 8900-WRITE-REPORT-LINE                           05016901
039800         MOVE DLX-DETAIL-LINE-1-XS  TO PV-PRINT-RECORD            05017001
039900         ADD +1 TO PV-ERROR-RECORD-WRITTEN-CNT                    05018001
040000         PERFORM 8900-WRITE-REPORT-LINE                           05019001
040100     ELSE                                                         05020001
040200         ADD +1 TO PV-VALID-MATCH-CNT                             05030001
040300     END-IF.                                                      05040001
040400                                                                  05050001
040700******************************************************************05080001
040800**  PROCESSES THRU END OF FILE FOR REMAINING RECORDS              05090001
040900******************************************************************05100001
041000 2200-PROCESS-EXTRA-RECORDS.                                      05110001
041100                                                                  05120001
041200     INITIALIZE DL1-DETAIL-LINE-1.                                05130001
041400                                                                  05150001
041500     IF  PS-NOT-END-OF-SOR-PRCHG                                  05160001
041600         IF PE103-PRCHG-ID NOT = XS069-PRCHG-ID                   05170002
041700            PERFORM 2400-MOVE-SOR-VALUES                          05180001
041800            MOVE PC-EXTRA-FOUND-SOR-PRCHG                         05190001
041900               TO DL1-ERROR-MESSAGE                               05200001
042000            MOVE DL1-DETAIL-LINE-1   TO PV-PRINT-RECORD           05210001
                  ADD +1 TO PV-SOR-PRCHG-RECS-UNIQUE                    05211035
042010            ADD +1 TO PV-ERROR-RECORD-WRITTEN-CNT                 05220001
042100            PERFORM 8900-WRITE-REPORT-LINE                        05230001
042200         END-IF                                                   05330001
042300         PERFORM 7000-READ-SOR-PRCHG-EXTRACT                      05340001
042400     END-IF.                                                      05350001
042500                                                                  05360001
042600     IF  PS-NOT-END-OF-XS-PRCHG                                   05370001
042700         IF PE103-PRCHG-ID NOT = XS069-PRCHG-ID                   05380002
042800            PERFORM 2500-MOVE-XS-VALUES                           05390001
042900            MOVE PC-EXTRA-FOUND-XS-PRCHG                          05400001
043000                TO DL1-ERROR-MESSAGE                              05410001
043100            MOVE DL1-DETAIL-LINE-1   TO PV-PRINT-RECORD           05420001
043110            ADD +1 TO PV-ERROR-RECORD-WRITTEN-CNT                 05430001
                  ADD +1 TO PV-XS-EXTRACT-REC-UNIQUE                    05431035
043200            PERFORM 8900-WRITE-REPORT-LINE                        05440001
043300         END-IF                                                   05540001
043400         PERFORM 7100-READ-XS-PRCHG-EXTRACT                       05550001
043500     END-IF.                                                      05560001
043600                                                                  05570001
043700******************************************************************05580001
043800* 2300-CHECK-IF-NEW-PG-NEEDED.                                    05590001
043900*     CHECKS TO SEE IF A NEW PAGE IS NEEDED.                      05600001
044000***************************************************************** 05610001
044100 2300-CHECK-IF-NEW-PG-NEEDED.                                     05620001
044200                                                                  05630001
044300     IF PV-LINE-CNT > PC-MAX-REPORT-LINES                         05640001
044400        PERFORM 8700-REPORT-HEADER-ROUTINE                        05650001
044500     END-IF.                                                      05660001
044600                                                                  05670001
044700******************************************************************05680001
044800* 2400-MOVE-SOR-VALUES.                                           05690001
044900*     MOVES THE SOR ITEM PRCHG VALUES TO THE ERROR RECORD.        05700001
045000***************************************************************** 05710001
045100 2400-MOVE-SOR-VALUES.                                            05720001
045200                                                                  05730001
045300     MOVE PE103-PRCHG-ID     TO PV-TEMP-PRCHG-ID                  05740002
045400     MOVE PV-TEMP-PRCHG-ID   TO DL1-PRCHG-ID,                     05750003
                                      DLS-SOR-PRCHG-ID.                 05751003
045400     MOVE 'SOR'              TO DL1-SOURCE,                       05760003
                                      DLS-SOURCE.                       05770003
045700                                                                  05820001
045800******************************************************************05830001
045900* 2500-MOVE-XS-VALUES.                                            05840001
046000*     MOVES THE XS PRCHG VALUES TO THE ERROR RECORD.              05850001
046100***************************************************************** 05860001
046200 2500-MOVE-XS-VALUES.                                             05870001
046300                                                                  05880001
046400     MOVE XS069-PRCHG-ID     TO PV-TEMP-PRCHG-ID.                 05890002
046500     MOVE PV-TEMP-PRCHG-ID   TO DL1-PRCHG-ID,                     05900003
                                      DLX-XS-PRCHG-ID.                  05901003
045400     MOVE 'XS '              TO DL1-SOURCE,                       05910003
045400                                DLX-SOURCE.                       05911003
046800                                                                  05970001
045800******************************************************************05980001
045900* 2600-MOVE-ALL-VALUES.                                           05990001
046000*     MOVES THE XS AND SOR VALUES TO THE TWO DETAIL LINES.        06000001
046100***************************************************************** 06010001
046200 2600-MOVE-ALL-VALUES.                                            06020001
046300                                                                  06030001
045300     MOVE PE103-PRCHG-ID        TO PV-TEMP-PRCHG-ID               06040002
045400     MOVE PV-TEMP-PRCHG-ID      TO DLS-SOR-PRCHG-ID.              06050002
045700                                                                  06065001
046400     MOVE XS069-PRCHG-ID        TO PV-TEMP-PRCHG-ID.              06066002
046500     MOVE PV-TEMP-PRCHG-ID      TO DLX-XS-PRCHG-ID.               06067002
046800                                                                  06100001
045400     MOVE 'SOR'                 TO DLS-SOURCE.                    06101003
045400     MOVE 'XS '                 TO DLX-SOURCE.                    06101103
                                                                        06101203
045500     MOVE XS069-PRCHG-DESC      TO DLX-XS-DESC.                   06110002
045500     MOVE PE103-PRCHG-DESC      TO DLS-SOR-DESC.                  06120002
045700                                                                  06130001
           IF XS069-PRCHG-DEPT-IS-NULL                                  06132032
045500        MOVE ZEROS                 TO DLX-XS-DEPT                 06140032
           ELSE                                                         06140132
045500        MOVE XS069-DEPT-NBR        TO DLX-XS-DEPT                 06140232
           END-IF.                                                      06140332
           IF  PE103-DEPT-NBR-NI EQUAL PC-NULL                          06141032
045500        MOVE ZEROS                 TO DLS-SOR-DEPT                06150032
           ELSE                                                         06150132
045500        MOVE PE103-DEPT-NBR        TO DLS-SOR-DEPT                06151032
           END-IF.                                                      06152032
045700                                                                  06160001
045500     MOVE XS069-EVNT-CTG-CDE    TO DLX-XS-EVNT-CTG.               06170002
045500     MOVE PE103-EVNT-CTG-CDE    TO DLS-SOR-EVNT-CTG.              06180002
045700                                                                  06190001
045500     MOVE XS069-PRCHG-TYP-CDE    TO DLX-XS-TYP-CDE.               06200002
045500     MOVE PE103-PRCHG-TYP-CDE    TO DLS-SOR-TYP-CDE.              06210002
046800                                                                  06220001
045500     MOVE XS069-PRCHG-ST-CDE    TO DLX-XS-ST-CDE.                 06230002
045500     MOVE PE103-PRCHG-ST-CDE    TO DLS-SOR-ST-CDE.                06240002
045700                                                                  06250001
045500     MOVE XS069-ALL-RMNG-STR-IND TO DLX-XS-ALL-RMNG.              06260002
045500     MOVE PE103-ALL-RMNG-STR-IND TO DLS-SOR-ALL-RMNG.             06270002
045700                                                                  06280001
045500     MOVE XS069-APP-TMST        TO DLX-XS-APP-TMST.               06290002
045500     MOVE PE103-APP-TMST        TO DLS-SOR-APP-TMST.              06300002
045700                                                                  06301001
045500     MOVE XS069-SOR-LAST-UPD-TMST TO DLX-XS-SOR-UPD.              06302002
045500     MOVE PE103-SOR-LAST-UPD-TMST TO DLS-SOR-SOR-UPD.             06303002
045700                                                                  06304001
046900******************************************************************06308001
047000* 2900-MOVE-ERROR-MSG.                                            06309001
047100*     MOVES THE ERROR MESSAGE TO THE ERROR RECORD.                06310001
047200***************************************************************** 06320001
047300 2900-MOVE-ERROR-MSG.                                             06330001
047400                                                                  06340001
047500     IF PS-PRCHG-ID-ERROR                                         06350001
047600        MOVE PC-MISMATCHED-PRCHG-ID   TO DL1-ERROR-MESSAGE        06360001
048300     END-IF.                                                      06420001
048400                                                                  06430001
048500***************************************************************** 06440001
048600*7000-READ-SOR-PRCHG-EXTRACT.                                     06450001
048700*  READ SOR PRCHG    EXTRACT FILE                                 06460001
049100***************************************************************** 06490001
049200 7000-READ-SOR-PRCHG-EXTRACT.                                     06500001
049300                                                                  06510001
049400     IF  PS-NOT-END-OF-SOR-PRCHG                                  06520001
049500         READ SOR-PRCHG-EXTRACT-FILE                              06530001
049550            INTO PE103-RECORD                                     06540001
049600              AT END                                              06550001
049700                 SET PS-END-OF-SOR-PRCHG TO TRUE                  06560001
049800         END-READ                                                 06570001
049900     END-IF.                                                      06580001
050000                                                                  06590001
050100     IF  PS-NOT-END-OF-SOR-PRCHG                                  06600001
NEMTST****    DISPLAY '=== SYSTEM OF RECORD READ *'                     06610011
NEMTST****         PE103-PRCHG-ID, '**'                                 06620011
052200         ADD +1 TO PV-SOR-PRCHG-RECS-READ-CNT                     06640001
052500     END-IF.                                                      06650001
052600                                                                  06660001
052700***************************************************************** 06670001
052800*7100-READ-XS-PRCHG-EXTRACT.                                      06680001
052900* READ XS EXTRACT FILE                                            06690001
053000***************************************************************** 06700001
053100 7100-READ-XS-PRCHG-EXTRACT.                                      06710001
053200                                                                  06720001
053300     IF  PS-NOT-END-OF-XS-PRCHG                                   06730001
053400         READ XS-PRCHG-EXTRACT-FILE                               06740001
053450           INTO XS069-PRCHG-UNLOAD                                06750001
053500             AT END                                               06760001
053600                SET PS-END-OF-XS-PRCHG TO TRUE                    06770001
053700         END-READ                                                 06780001
053800     END-IF.                                                      06790001
053900                                                                  06800001
054000     IF  PS-NOT-END-OF-XS-PRCHG                                   06810001
NEMTST***     DISPLAY '=== XS READ *'                                   06820011
NEMTST***          XS069-PRCHG-ID, '**'                                 06830011
054100         ADD +1                   TO PV-XS-EXTRACT-REC-READ-CNT   06840001
054200     END-IF.                                                      06850001
054300                                                                  06860001
054400******************************************************************06870001
054500* 8700-REPORT-HEADER-ROUTINE.                                     06880001
054600*     PRINT THE HEADINGS FOR THE REPORT.                          06890001
054700******************************************************************06900001
054800 8700-REPORT-HEADER-ROUTINE.                                      06910001
054900                                                                  06920001
055000     MOVE ZEROS                  TO PV-LINE-CNT.                  06930001
055100     ADD +1                      TO PV-PAGE-CNT.                  06940001
055200     MOVE PV-PAGE-CNT            TO DP200-PAGE-NUMBER.            06950001
055300                                                                  06960001
055400     MOVE PC-REPORT-NBR-1        TO DP200-REPORT-NUMBER.          06970001
055500     MOVE DP200-STANDRD-HEADER-200-COLS                           06980001
055600                                 TO PV-PRINT-RECORD.              06990001
055700                                                                  07000001
055800     PERFORM 8800-WRITE-RPT-TOP-OF-PAGE.                          07010001
055900                                                                  07020001
056000     MOVE HL2-HEADING-LINE-2     TO PV-PRINT-RECORD.              07030001
056100     MOVE +2                     TO PV-LINE-SPACING.              07040001
056200     PERFORM 8900-WRITE-REPORT-LINE.                              07050001
056300                                                                  07060001
056400     MOVE HL3-HEADING-LINE-3     TO PV-PRINT-RECORD.              07061002
056500     MOVE +3                     TO PV-LINE-SPACING.              07062002
056600     PERFORM 8900-WRITE-REPORT-LINE.                              07063002
056700                                                                  07064002
056400     MOVE HL4-HEADING-LINE-4     TO PV-PRINT-RECORD.              07070002
056500     MOVE +1                     TO PV-LINE-SPACING.              07080002
056600     PERFORM 8900-WRITE-REPORT-LINE.                              07090001
056700                                                                  07100001
056800******************************************************************07110001
056900* 8800-WRITE-RPT-TOP-OF-PAGE                                      07120001
057000*     WRITE FIRST REPORT LINE AFTER PAGE BREAK.                   07130001
057100******************************************************************07140001
057200 8800-WRITE-RPT-TOP-OF-PAGE.                                      07150001
057300                                                                  07160001
057400     WRITE XS-PRCHG-INTEG-RPT-RECORD                              07170001
057500       FROM PV-PRINT-RECORD                                       07180001
057600         AFTER ADVANCING PAGE.                                    07190001
057700                                                                  07200001
057800     MOVE +1 TO PV-LINE-CNT.                                      07210001
057900                                                                  07220001
058000******************************************************************07230001
058100* 8900-WRITE-REPORT-LINE                                          07240001
058200*     WRITE REPORT LINE AFTER ADVANCING LINE SPACING.             07250001
058300******************************************************************07260001
058400 8900-WRITE-REPORT-LINE.                                          07270001
058500                                                                  07280001
058600     WRITE XS-PRCHG-INTEG-RPT-RECORD                              07290002
058700       FROM PV-PRINT-RECORD                                       07300001
058800         AFTER ADVANCING PV-LINE-SPACING.                         07310001
058900                                                                  07320001
059000     ADD PV-LINE-SPACING TO PV-LINE-CNT.                          07330001
059100                                                                  07340001
059200****************************************************************  07350001
059300*END OF PROGRAM ROUTINE                                           07360001
059400****************************************************************  07370001
059500 9000-END-OF-PGM.                                                 07380001
059600                                                                  07390001
060800     DISPLAY '******** XSKRP038 COUNTS *********'.                07400001
060850     DISPLAY ' INTEGRITY CHECK - FOR XST_PRCHG '.                 07410001
060900     DISPLAY '   SOR REC READ CNT= '                              07420001
060950                     PV-SOR-PRCHG-RECS-READ-CNT.                  07430001
061000     DISPLAY 'XS PRCHG READ COUNT= ' PV-XS-EXTRACT-REC-READ-CNT.  07440001
061300     DISPLAY '  =============================== '                 07440115
           DISPLAY 'UNIQUE TO SOR ONLY  - ', PV-SOR-PRCHG-RECS-UNIQUE   07441018
           DISPLAY 'UNIQUE TO XS  ONLY  - ', PV-XS-EXTRACT-REC-UNIQUE   07442018
           DISPLAY 'COMMON TO BOTH FILES- ',  PV-SOR-XS-COMMON-CNT      07443018
           COMPUTE PV-SOR-XS-TOTAL-CNT =  PV-SOR-XS-COMMON-CNT          07443117
            + PV-SOR-PRCHG-RECS-UNIQUE  + PV-XS-EXTRACT-REC-UNIQUE      07443417
           DISPLAY 'TOTAL COMMON + UNIQUE=', PV-SOR-XS-TOTAL-CNT        07443718
061300     DISPLAY '  =============================== '                 07444015
061100     DISPLAY ' ERROR MSGS WRITTEN= ' PV-ERROR-RECORD-WRITTEN-CNT. 07450001
061200     DISPLAY '  VALID MATCH COUNT= ' PV-VALID-MATCH-CNT.          07460001
061300     DISPLAY '                              '.                    07470001
061700     DISPLAY '**********************************'.                07510001
061800                                                                  07520001
061900     IF  PV-ERROR-RECORD-WRITTEN-CNT > 0                          07530001
062000         MOVE 04               TO RETURN-CODE                     07540001
062100     END-IF.                                                      07550001
062200                                                                  07560001
062300     CLOSE SOR-PRCHG-EXTRACT-FILE                                 07570001
062400           XS-PRCHG-EXTRACT-FILE                                  07580001
062500           XS-PRCHG-INTEG-RPT-FILE.                               07590001
062600                                                                  07600001
062700******************************************************************07610001
062800*     9999-ABEND                                                 *07620001
062900* ==> PROCESSES:                                                 *07630001
063000*     -PERFORMS ABEND PROCESSING FOR NON-SQL-ERRORS.             *07640001
063100******************************************************************07650001
063200 9999-ABEND.                                                      07660001
063300                                                                  07670001
063400     DISPLAY '9999-ABEND'.                                        07680001
063500     DISPLAY '**  ABEND     **', PC-CURRENT-PROGRAM-NAME.         07690001
063600     DISPLAY '**  PARAGRAPH ** ' PV-PARAGRAPH-NAME.               07700001
063700     DISPLAY '**  OPERATION ** ' PV-OPERATION-MSG-1.              07710001
063800     DISPLAY '**            ** ' PV-OPERATION-MSG-2.              07720001
063900     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         07730001
