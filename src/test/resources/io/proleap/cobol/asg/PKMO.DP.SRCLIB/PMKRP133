       IDENTIFICATION DIVISION.                                         00010000
       PROGRAM-ID.             PMKRP133.                                00020000
       AUTHOR.                 COLLEEN CUMMINGS.                        00030000
       INSTALLATION.           KOHLS DEPARTMENT STORES.                 00040000
       DATE-WRITTEN.           FEBRUARY 2004.                           00050000
       DATE-COMPILED.                                                   00060000
      ***************************************************************** 00070000
      *  PMKRP133 -- BUSINESS RULE PRICING EXCEPTION REPORT (WR26451)   00080000
      *    **** EARLY BIRD VS. FULL-DAY PROMOTION ****                  00090000
      *    THIS REPORT READS PMT_SKU_LVL_PRICG_BY_LOC ORACLE TABLE      00100000
      *    LOOKING FOR SKUS ON SALE IN EARLY BIRD PROMOTION AT A HIGHER 00110000
      *    OR EQUAL PRICE THAN THEY ARE IN THE FULL-DAY PROMOTION.      00120000
      *    REPORT BREAKS ON CHANGE OF GMM, DMM, BUYER, AND DEPT.        00130000
      ***************************************************************** 00140000
      *----------------------------------------------------------       00150000
      * HISTORY LOG:                                                    00160000
      *----------------------------------------------------------       00170000
      * DATE:        11/03/2004                                         00180000
      * WR/IR#:      P000707991                                         00190000
      * PROGRAMMER:  COLLEEN CUMMINGS                                   00200000
      * DESCRIPTION: SIGN NBR NOT DISPLAYING CORRECTLY.                 00210000
      *              CHANGED "D355-FILL-IN-MAIN-SIGN-NBR" TO            00220000
      *              LOOK AT "PV-FULL-DAY-INDEX" INSTEAD OF             00230000
      *              "PV-PART-DAY-INDEX".                               00240000
      *----------------------------------------------------------       00250000
      * DATE:        02/10/2005                                         00260000
      * WR/IR#:      WR26654                                            00270000
      * PROGRAMMER:  KELLY WIESNER                                      00280000
      * DESCRIPTION: ADD IN TIER PRICING.                               00290000
      *----------------------------------------------------------       00300000
      * DATE:        07/19/2005                                         00310000
      * WR/IR#:      WR28438                                            00320000
      * PROGRAMMER:  TOM BOYD                                           00330000
      * DESCRIPTION: REPORT AUTOMATION CHANGES.                         00340000
      *----------------------------------------------------------       00350000
      * DATE:        08/08/2005                                         00360000
      * WR/IR#:      WR29140                                            00370000
      * PROGRAMMER:  AMANDA NEWHART                                     00380000
      * DESCRIPTION: CHANGE THE ADVERTISED/UNADVERTISED INDICATORS      00390000
      *              FROM Y/N TO A/U.  RETURN STYLE NBR AND RETAIL      00400000
      *              AMT FROM C100.  REMOVE GP QTY, GP PRICE, AND       00410000
      *              %/PP.  FORMAT THE DATES AS MM-DD-YY.               00420000
      *----------------------------------------------------------       00430000
      *                                                                 00440000
      * DATE:        07/22/2010                                         00450000
      * WR/IR#:      WR37986                                            00460000
      * PROGRAMMER:  PATTY JAEGER                                       00470000
      * DESCRIPTION: CHANGES MADE TO EXCLUDE WEB STORE DATA FROM        00480000
      *              THE REPORT                                         00490000
      *                                                                 00500008
      * DATE:        04/20/2012                                         00510008
PM3403* WR/IR#:      PMO 3403                                           00520008
      * PROGRAMMER:  SCOTT JACKSON                                      00530008
      * DESCRIPTION: CHANGES FOR LARGE UNIT RETAIL > 9999.99            00540008
      *                                                                 00540115
P59023* WR/IR#:      PRB0059023                                         00541015
P59023* PROGRAMMER:  COGNIZANT                                          00542015
P59023* DESCRIPTION: ADDED LOGIC TO SKIP SKU WHICH IS DELETED BY        00543015
P59023*              MDM I.E> WHICH IS NOT FOUND IN XST_SKU TABLE       00544015
P59023*              PARA: D350-GET-SIGN-AND-DESC                       00545015
      *                                                                 00546017
      * DATE:        07/30/2018                                         00548017
      * WR/IR#:      CHG0204126                                         00549017
      * PROGRAMMER:  COGNIZANT                                          00549117
      * DESCRIPTION: ORACLE LOGON STANDARDS PROGRAM CHANGE              00549217
      *----------------------------------------------------------       00550008
       ENVIRONMENT DIVISION.                                            00560008
       CONFIGURATION SECTION.                                           00570000
       SOURCE-COMPUTER. IBM-3090.                                       00580000
       OBJECT-COMPUTER. IBM-3090.                                       00590000
                                                                        00600000
       INPUT-OUTPUT SECTION.                                            00610000
       FILE-CONTROL.                                                    00620000
                                                                        00630000
           SELECT CC-PROMO-FILE                                         00640000
              ASSIGN                     TO INP01.                      00650000
                                                                        00660000
W37986     SELECT SMPL-STR-INFILE                                       00670000
W37986        ASSIGN                     TO INP02.                      00680000
W37986                                                                  00690000
           SELECT PR-CONFLICT-RPT                                       00700000
               ASSIGN                    TO RPT01.                      00710000
                                                                        00711016
           SELECT ORACLE-LOGON-FILE                                     00712016
               ASSIGN                    TO ORALOGON.                   00713016
                                                                        00720000
       DATA DIVISION.                                                   00730000
                                                                        00740000
       FILE SECTION.                                                    00750000
                                                                        00760000
       FD  CC-PROMO-FILE                                                00770000
           RECORDING MODE F                                             00780000
           BLOCK CONTAINS 0 RECORDS                                     00790000
           LABEL RECORDS ARE OMITTED                                    00800000
           DATA RECORD IS CC-PROMO-REC.                                 00810000
       01  CC-PROMO-REC                    PIC X(80).                   00820000
                                                                        00830000
W37986 FD  SMPL-STR-INFILE                                              00840000
W37986     RECORDING MODE F                                             00850000
W37986     BLOCK CONTAINS 0 RECORDS                                     00860000
W37986     LABEL RECORDS ARE OMITTED                                    00870000
W37986     DATA RECORD IS SMPL-STR-INFILE-REC.                          00880000
W37986 01  SMPL-STR-INFILE-REC           PIC X(80).                     00890000
W37986                                                                  00900000
       FD  PR-CONFLICT-RPT                                              00910000
           RECORDING MODE F                                             00920000
           BLOCK CONTAINS 0 RECORDS                                     00930000
           LABEL RECORDS ARE OMITTED.                                   00940000
       01  PR-CONFLICT-LINE              PIC X(175).                    00950000
                                                                        00951016
       FD  ORACLE-LOGON-FILE                                            00952016
           RECORDING MODE IS F                                          00953016
           LABEL RECORDS ARE STANDARD                                   00954016
           BLOCK CONTAINS 0 RECORDS                                     00955016
           RECORD CONTAINS 80 CHARACTERS                                00956016
           DATA RECORDS IS OL-ORACLE-LOGON-RECORD.                      00957016
       01  OL-ORACLE-LOGON-RECORD      PIC X(80).                       00958016
                                                                        00960000
       WORKING-STORAGE SECTION.                                         00970000
                                                                        00980000
       01  ABEND-CODE                    PIC S9(04) COMP VALUE +0.      00990000
           88  ABEND-4001-WRITE-ERROR               VALUE +4001.        01000000
           88  ABEND-4002-READ-ERROR                VALUE +4002.        01010000
           88  ABEND-4003-CTRL-CARD-ERROR           VALUE +4003.        01020000
           88  ABEND-4004-TABLE-ERROR               VALUE +4004.        01030000
           88  ABEND-4005-OPEN-ERROR                VALUE +4005.        01040000
           88  ABEND-4006-CLOSE-ERROR               VALUE +4006.        01050000
           88  ABEND-4007-SEQUENCE-ERROR            VALUE +4007.        01060000
           88  ABEND-4008-DATA-ERROR                VALUE +4008.        01070000
           88  ABEND-4009-KEY-DATA-ERROR            VALUE +4009.        01080000
           88  ABEND-4013-SQL-ERROR                 VALUE +4013.        01090000
           88  ABEND-4014-ORACLE-LOGON-ERROR        VALUE +4014.        01100000
           88  ABEND-4019-DATE-ROUTINE-ERROR        VALUE +4019.        01110000
           88  ABEND-4444-FORCED-ABEND              VALUE +4444.        01120000
                                                                        01130000
       01  CD-CPU-DATE.                                                 01140000
           05  CD-CPU-YR                  PIC 9(02) VALUE ZERO.         01150000
           05  CD-CPU-MO                  PIC 9(02) VALUE ZERO.         01160000
           05  CD-CPU-DY                  PIC 9(02) VALUE ZERO.         01170000
                                                                        01180000
       01  CD-CPU-DATE-GREG.                                            01190000
           05  CD-CPU-MM                  PIC 9(02) VALUE ZERO.         01200000
           05  CD-CPU-DD                  PIC 9(02) VALUE ZERO.         01210000
           05  CD-CPU-YY                  PIC 9(02) VALUE ZERO.         01220000
                                                                        01230000
       01  CT-CPU-TIME.                                                 01240000
           05  CT-CPU-HR                  PIC 9(02) VALUE ZERO.         01250000
           05  CT-CPU-MIN                 PIC 9(02) VALUE ZERO.         01260000
           05  CT-CPU-SEC                 PIC 9(02) VALUE ZERO.         01270000
           05  CT-CPU-HSEC                PIC 9(02) VALUE ZERO.         01280000
                                                                        01290000
       01  LEGAL-LINE.                                                  01300000
           05  FILLER                       PIC X(44)      VALUE SPACES.01310000
           05  FILLER                       PIC X(43)      VALUE        01320000
               '** PRIVILEGED AND CONFIDENTIAL, ATTORNEY-CL'.           01330000
           05  FILLER                       PIC X(43)      VALUE        01340000
               'IENT PRIVILEGE AND ATTORNEY WORK PRODUCT **'.           01350000
           05  FILLER                       PIC X(45)      VALUE SPACES.01360000
                                                                        01370000
       01  END-OF-REPORT-LINE.                                          01380000
           05  FILLER                     PIC X(77) VALUE SPACES.       01390000
           05  FILLER                     PIC X(20) VALUE               01400000
               ' ** END OF REPORT **'.                                  01410000
           05  FILLER                     PIC X(78) VALUE SPACES.       01420000
                                                                        01430000
       01  NOTHING-TO-REPORT-LINE.                                      01440000
           05  FILLER                     PIC X(79) VALUE SPACES.       01450000
           05  FILLER                     PIC X(24) VALUE               01460000
               ' ** NOTHING TO REPORT **'.                              01470000
           05  FILLER                     PIC X(80) VALUE SPACES.       01480000
                                                                        01490000
       01  HEADER-01.                                                   01500000
           05  FILLER                     PIC X(56) VALUE SPACES.       01510000
           05  HDR-01-TITLE               PIC X(38) VALUE SPACES.       01520000
           05  FILLER                     PIC X(81) VALUE SPACES.       01530000
                                                                        01540000
       01  HEADER-02.                                                   01550000
           05  FILLER                     PIC X(54) VALUE SPACES.       01560000
           05  HDR-02-TITLE-1             PIC X(09) VALUE SPACES.       01570000
           05  FILLER                     PIC X(01) VALUE SPACES.       01580000
           05  HDR-02-TITLE-2             PIC X(15) VALUE SPACES.       01590000
           05  FILLER                     PIC X(02) VALUE SPACES.       01600000
           05  HDR-02-TITLE-3             PIC X(25) VALUE SPACES.       01610000
           05  FILLER                     PIC X(38) VALUE SPACES.       01620000
                                                                        01630000
       01  HEADER-03.                                                   01640000
           05  FILLER                     PIC  X(58) VALUE SPACES.      01650000
           05  HDR-03-TITLE               PIC X(105) VALUE SPACES.      01660000
           05  FILLER                     PIC  X(12) VALUE SPACES.      01670000
                                                                        01680000
       01  HEADER-04.                                                   01690000
           05  FILLER                     PIC  X(63) VALUE SPACES.      01700000
           05  HDR-04-TITLE               PIC  X(30) VALUE SPACES.      01710000
           05  FILLER                     PIC  X(82) VALUE SPACES.      01720000
                                                                        01730000
       01  HEADER-GMM.                                                  01740000
           05  FILLER                     PIC X(07) VALUE               01750000
               'GMM:   '.                                               01760000
           05  FILLER                     PIC X(01) VALUE SPACES.       01770000
           05  HDR-GMM-NBR                PIC X(04).                    01780000
           05  FILLER                     PIC X(01) VALUE SPACES.       01790000
           05  HDR-GMM-NAME               PIC X(36).                    01800000
           05  FILLER                     PIC X(127) VALUE SPACES.      01810000
                                                                        01820000
       01  HEADER-DMM.                                                  01830000
           05  FILLER                     PIC X(07) VALUE               01840000
               'DMM:   '.                                               01850000
           05  FILLER                     PIC X(01) VALUE SPACES.       01860000
           05  HDR-DMM-NBR                PIC X(04).                    01870000
           05  FILLER                     PIC X(01) VALUE SPACES.       01880000
           05  HDR-DMM-NAME               PIC X(36).                    01890000
           05  FILLER                     PIC X(127) VALUE SPACES.      01900000
                                                                        01910000
       01  HEADER-BUYER.                                                01920000
           05  FILLER                     PIC X(08) VALUE               01930000
               'BUYER:  '.                                              01940000
           05  HDR-BYR-NBR              PIC X(04).                      01950000
           05  FILLER                     PIC X(01) VALUE SPACES.       01960000
           05  HDR-BYR-NAME             PIC X(36).                      01970000
           05  FILLER                     PIC X(126) VALUE SPACES.      01980000
                                                                        01990000
       01  HEADER-DEPT.                                                 02000000
           05  FILLER                     PIC X(08) VALUE               02010000
               'DEPT:   '.                                              02020000
           05  HDR-DEPT-NBR               PIC X(04).                    02030000
           05  FILLER                     PIC X(01) VALUE SPACES.       02040000
           05  HDR-DEPT-NAME              PIC X(36).                    02050000
           05  FILLER                     PIC X(126) VALUE SPACES.      02060000
                                                                        02070000
       01  HEADER-PRE-05.                                               02080000
           05  FILLER                     PIC X(77) VALUE SPACES.       02090000
           05  FILLER                     PIC X(08) VALUE               02100000
               'BEGIN'.                                                 02110000
           05  FILLER                     PIC X(01) VALUE SPACES.       02120000
           05  FILLER                     PIC X(08) VALUE               02130000
               'END'.                                                   02140000
           05  FILLER                     PIC X(48) VALUE SPACES.       02150000
           05  FILLER                     PIC X(08) VALUE               02160000
               '  RETAIL'.                                              02170000
           05  FILLER                     PIC X(01) VALUE SPACES.       02180000
           05  FILLER                     PIC X(09) VALUE               02190000
               '    PROMO'.                                             02200000
           05  FILLER                     PIC X(04) VALUE SPACES.       02210000
           05  FILLER                     PIC X(09) VALUE               02220000
               '    PRICE'.                                             02230000
                                                                        02240000
       01  HEADER-05.                                                   02250000
           05  FILLER                     PIC X(04) VALUE               02260000
               'DPT'.                                                   02270000
           05  FILLER                     PIC X(01) VALUE SPACES.       02280000
           05  FILLER                     PIC X(04) VALUE               02290000
               'SCL'.                                                   02300000
           05  FILLER                     PIC X(01) VALUE SPACES.       02310000
           05  FILLER                     PIC X(08) VALUE               02320000
               'SKU NBR'.                                               02330000
           05  FILLER                     PIC X(01) VALUE SPACES.       02340000
           05  FILLER                     PIC X(20) VALUE               02350000
               'SKU DESC'.                                              02360000
           05  FILLER                     PIC X(02) VALUE SPACES.       02370000
           05  FILLER                     PIC X(19) VALUE               02380000
               'STYLE NBR'.                                             02390000
           05  FILLER                     PIC X(01) VALUE SPACES.       02400000
           05  FILLER                     PIC X(15) VALUE               02410000
               'PROMOTION'.                                             02420000
           05  FILLER                     PIC X(01) VALUE SPACES.       02430000
           05  FILLER                     PIC X(08) VALUE               02440000
               'DATE'.                                                  02450000
           05  FILLER                     PIC X(01) VALUE SPACES.       02460000
           05  FILLER                     PIC X(08) VALUE               02470000
               'DATE  '.                                                02480000
           05  FILLER                     PIC X(01) VALUE SPACES.       02490000
           05  FILLER                     PIC X(31) VALUE               02500000
               'PROMO ITEM DESCRIPTION'.                                02510000
           05  FILLER                     PIC X(01) VALUE SPACES.       02520000
           05  FILLER                     PIC X(03) VALUE               02530000
               'A/U'.                                                   02540000
           05  FILLER                     PIC X(01) VALUE SPACES.       02550000
           05  FILLER                     PIC X(10) VALUE               02560000
               'SIGN NBR'.                                              02570000
           05  FILLER                     PIC X(01) VALUE SPACES.       02580000
           05  FILLER                     PIC X(08) VALUE               02590000
               '   PRICE'.                                              02600000
           05  FILLER                     PIC X(01) VALUE SPACES.       02610000
           05  FILLER                     PIC X(09) VALUE               02620000
               '    PRICE'.                                             02630000
           05  FILLER                     PIC X(01) VALUE SPACES.       02640000
           05  FILLER                     PIC X(02) VALUE               02650000
               'TP'.                                                    02660000
           05  FILLER                     PIC X(01) VALUE SPACES.       02670000
           05  FILLER                     PIC X(09) VALUE               02680000
               'VIOLATION'.                                             02690000
                                                                        02700000
       01  BLANK-PAGE-NOTE.                                             02710000
           05  FILLER                     PIC X(64) VALUE SPACES.       02720000
           05  FILLER                     PIC X(46) VALUE               02730000
               '***** THIS PAGE INTENTIONALLY LEFT BLANK *****'.        02740000
           05  FILLER                     PIC X(65) VALUE SPACES.       02750000
                                                                        02760000
       01  DETAIL-01.                                                   02770000
           05  DTL-01-DEPT-NBR            PIC X(04).                    02780000
           05  FILLER                     PIC X(01) VALUE SPACES.       02790000
           05  DTL-01-SUB-CL-NBR          PIC X(04).                    02800000
           05  FILLER                     PIC X(01) VALUE SPACES.       02810000
           05  DTL-01-SKU-NBR             PIC X(08).                    02820000
           05  FILLER                     PIC X(01) VALUE SPACES.       02830000
           05  DTL-01-SKU-DESC            PIC X(20).                    02840000
           05  FILLER                     PIC X(02) VALUE SPACES.       02850000
           05  DTL-01-STYLE-NBR           PIC X(19).                    02860000
           05  FILLER                     PIC X(01) VALUE SPACES.       02870000
           05  DTL-01-PROMO-NAME-1        PIC X(15).                    02880000
           05  FILLER                     PIC X(01) VALUE SPACES.       02890000
           05  DTL-01-PROMO-BEG-DTE-1.                                  02900000
               10 DTL-01-PM-BEG-DTE-MM    PIC X(02) VALUE SPACES.       02910000
               10 DTL-01-PM-BEG-DTE-D1    PIC X(01) VALUE '/'.          02920000
               10 DTL-01-PM-BEG-DTE-DD    PIC X(02) VALUE SPACES.       02930000
               10 DTL-01-PM-BEG-DTE-D2    PIC X(01) VALUE '/'.          02940000
               10 DTL-01-PM-BEG-DTE-YY    PIC X(02) VALUE SPACES.       02950000
           05  FILLER                     PIC X(01) VALUE SPACES.       02960000
           05  DTL-01-PROMO-END-DTE-1.                                  02970000
               10 DTL-01-PM-END-DTE-MM    PIC X(02) VALUE SPACES.       02980000
               10 DTL-01-PM-END-DTE-D1    PIC X(01) VALUE '/'.          02990000
               10 DTL-01-PM-END-DTE-DD    PIC X(02) VALUE SPACES.       03000000
               10 DTL-01-PM-END-DTE-D2    PIC X(01) VALUE '/'.          03010000
               10 DTL-01-PM-END-DTE-YY    PIC X(02) VALUE SPACES.       03020000
           05  FILLER                     PIC X(01) VALUE SPACES.       03030000
           05  DTL-01-PROMO-ITM-DESC-1    PIC X(31).                    03040000
           05  FILLER                     PIC X(02) VALUE SPACES.       03050000
           05  DTL-01-ADV-IND-1           PIC X(01).                    03060000
PM3403*    05  FILLER                     PIC X(02) VALUE SPACES.       03070008
PM3403     05  FILLER                     PIC X(01) VALUE SPACES.       03080008
           05  DTL-01-SIGN-NBR            PIC X(10).                    03090000
           05  FILLER                     PIC X(01) VALUE SPACES.       03100000
PM3403*    05  DTL-01-RETAIL-PRICE-1      PIC Z,ZZZ.99.                 03110008
PM3403     05  DTL-01-RETAIL-PRICE-1      PIC ZZ,ZZZ.99.                03120008
           05  FILLER                     PIC X(01) VALUE SPACES.       03130000
           05  DTL-01-PROMO-PRICE-1       PIC ZZ,ZZZ.ZZ.                03140000
           05  FILLER                     PIC X(02) VALUE SPACES.       03150000
           05  DTL-01-TIER-PRICE-IND      PIC X(01) VALUE SPACES.       03160000
           05  FILLER                     PIC X(10) VALUE SPACES.       03170000
                                                                        03180000
       01  DETAIL-SGN.                                                  03190000
           05  FILLER                     PIC X(107) VALUE SPACES.      03200000
           05  DTL-NEXT-SGN-NBR           PIC X(07).                    03210000
           05  FILLER                     PIC X(67) VALUE SPACES.       03220000
                                                                        03230000
       01  DETAIL-PRINT-01                PIC X(175) VALUE SPACES.      03240000
                                                                        03250000
       01  DETAIL-02.                                                   03260000
           05  FILLER                     PIC X(61) VALUE SPACES.       03270000
           05  DTL-02-PROMO-NAME-2        PIC X(15).                    03280000
           05  FILLER                     PIC X(01) VALUE SPACES.       03290000
           05  DTL-02-PROMO-BEG-DTE-2.                                  03300000
               10 DTL-02-PM-BEG-DTE-MM    PIC X(02) VALUE SPACES.       03310000
               10 DTL-02-PM-BEG-DTE-D1    PIC X(01) VALUE '/'.          03320000
               10 DTL-02-PM-BEG-DTE-DD    PIC X(02) VALUE SPACES.       03330000
               10 DTL-02-PM-BEG-DTE-D2    PIC X(01) VALUE '/'.          03340000
               10 DTL-02-PM-BEG-DTE-YY    PIC X(02) VALUE SPACES.       03350000
           05  FILLER                     PIC X(01) VALUE SPACES.       03360000
           05  DTL-02-PROMO-END-DTE-2.                                  03370000
               10 DTL-02-PM-END-DTE-MM    PIC X(02) VALUE SPACES.       03380000
               10 DTL-02-PM-END-DTE-D1    PIC X(01) VALUE '/'.          03390000
               10 DTL-02-PM-END-DTE-DD    PIC X(02) VALUE SPACES.       03400000
               10 DTL-02-PM-END-DTE-D2    PIC X(01) VALUE '/'.          03410000
               10 DTL-02-PM-END-DTE-YY    PIC X(02) VALUE SPACES.       03420000
           05  FILLER                     PIC X(01) VALUE SPACES.       03430000
           05  DTL-02-PROMO-ITM-DESC-2    PIC X(31).                    03440000
           05  FILLER                     PIC X(02) VALUE SPACES.       03450000
           05  DTL-02-ADV-IND-2           PIC X(01).                    03460000
PM3403*    05  FILLER                     PIC X(02) VALUE SPACES.       03470008
PM3403     05  FILLER                     PIC X(01) VALUE SPACES.       03480008
           05  DTL-02-SIGN-NBR            PIC X(10).                    03490000
           05  FILLER                     PIC X(01) VALUE SPACES.       03500000
PM3403*    05  DTL-02-RETAIL-PRICE-2      PIC Z,ZZZ.99.                 03510008
PM3403     05  DTL-02-RETAIL-PRICE-2      PIC ZZ,ZZZ.99.                03520008
           05  FILLER                     PIC X(01) VALUE SPACES.       03530000
           05  DTL-02-PROMO-PRICE-2       PIC ZZ,ZZZ.99.                03540000
           05  FILLER                     PIC X(02) VALUE SPACES.       03550000
           05  DTL-02-TIER-PRICE-IND      PIC X(01) VALUE SPACES.       03560000
           05  FILLER                     PIC X(01) VALUE SPACES.       03570000
           05  DTL-02-WINNER-IND          PIC X(02).                    03580000
           05  FILLER                     PIC X(01) VALUE SPACES.       03590000
           05  DTL-02-WINNER-REASON       PIC X(06).                    03600000
                                                                        03610000
       01  DETAIL-PRINT-02                PIC X(175) VALUE SPACES.      03620000
                                                                        03630000
       01  PC-PROGRAM-CONSTANTS.                                        03640000
           05  PC-AUTO-LOGON              PIC  X(01) VALUE '/'.         03641016
           05  PC-MAX-LINES               PIC S9(04) COMP VALUE +59.    03650000
           05  PC-PROGRAM-NAME            PIC  X(08) VALUE 'PMKRP133'.  03660016
           05  PC-RDS-REPORT-NAME         PIC  X(02) VALUE SPACES.      03670000
           05  PC-ONE                     PIC  9(02)  VALUE 01.         03680000
           05  PC-HDR1-TITLE1             PIC  X(38) VALUE              03690000
               ' PARTIAL DAY PRICING EXCEPTION REPORT '.                03700000
           05  PC-PMKUT117-PGM            PIC  X(08) VALUE 'PMKUT117'.  03710000
           05  PC-HDR1-TITLE4-01          PIC  X(30) VALUE              03720000
               '  POST INITIAL DUE DATE       '.                        03730000
           05  PC-HDR1-TITLE4-02          PIC  X(30) VALUE              03740000
               '  PRE CORRECTIONS             '.                        03750000
           05  PC-HDR1-TITLE4-03          PIC  X(30) VALUE              03760000
               '  POST CORRECTIONS            '.                        03770000
                                                                        03780000
      ***************************************************************** 03790000
      * PS PROGRAM SWITCHES                                             03800000
      ***************************************************************** 03810000
       01  PS-PROGRAM-SWITCHES.                                         03820000
006510     05  PS-END-OF-LOGON-FILE-SW      PIC X(01) VALUE 'N'.        03821016
006530         88  PS-END-OF-LOGON-FILE               VALUE 'Y'.        03822016
           05  PS-ORA-SRC-CTL-DONE-SW       PIC X(01) VALUE 'N'.        03823016
               88  PS-ORA-SRC-EMPTY                   VALUE 'Y'.        03824016
           05  PS-SAME-SKU-SW               PIC X(01) VALUE 'N'.        03830000
               88  PS-SAME-SKU                        VALUE 'Y'.        03840000
               88  PS-NOT-SAME-SKU                    VALUE 'N'.        03850000
           05  PS-CONTROL-CARD-SW           PIC X(01) VALUE 'N'.        03860000
               88  PS-CONTROL-CARD-EOF                VALUE 'Y'.        03870000
               88  PS-CONTROL-CARD-NOT-EOF            VALUE 'N'.        03880000
W37986     05  PS-CONTROL-CARD-STR-SW       PIC X(01) VALUE 'N'.        03890000
W37986         88  PS-END-OF-CC-FILE-STR              VALUE 'Y'.        03900000
W37986         88  PS-NOT-END-OF-CC-FILE-STR          VALUE 'N'.        03910000
           05  PS-PROMO-FILE-SW             PIC X(01) VALUE 'N'.        03920000
               88  PS-PROMO-EOF                       VALUE 'Y'.        03930000
               88  PS-PROMO-NOT-EOF                   VALUE 'N'.        03940000
           05  PS-FIRST-TIME-IN-SW          PIC X(01) VALUE 'N'.        03950000
               88  PS-NOT-FIRST-TIME-IN               VALUE 'Y'.        03960000
               88  PS-FIRST-TIME-IN                   VALUE 'N'.        03970000
           05  PS-RUN-REPORT-SW             PIC X(01) VALUE 'N'.        03980000
               88  PS-RUN-REPORT                      VALUE 'Y'.        03990000
               88  PS-NOT-RUN-REPORT                  VALUE 'N'.        04000000
           05  PS-PROMO-AVAIL-SW            PIC X(01) VALUE 'N'.        04010000
               88  PS-NO-PROMO                        VALUE 'Y'.        04020000
               88  PS-PROMO-AVAIL                     VALUE 'N'.        04030000
           05  PS-SKIP-RECORD-SW            PIC X(01) VALUE 'N'.        04040000
               88  PS-SKIP-RECORD                     VALUE 'Y'.        04050000
               88  PS-NOT-SKIP-RECORD                 VALUE 'N'.        04060000
           05  PS-END-OF-PRCON-SR-SW        PIC X(01) VALUE 'N'.        04070000
               88  PS-END-OF-PRCON-CSR                VALUE 'Y'.        04080000
               88  PS-NOT-END-OF-PRCON-CSR            VALUE 'N'.        04090000
                                                                        04100000
       01  CC-ORACLE-CONNECTION.                                        04101016
           05  CC-ORACLE-USERID             PIC X(40).                  04102016
               88 CC-AUTO-LOGON                         VALUE '/'.      04103016
           05  CC-ORACLE-PASSWORD           PIC X(40).                  04104016
                                                                        04105016
       01  PV-PROGRAM-VARIABLES.                                        04110000
           05  PV-ORACLE-USERID-LEN       PIC S9(4) VALUE ZEROS         04111016
                                                    COMP SYNC.          04112016
           05  PV-ORACLE-PASSWORD-LEN     PIC S9(4) VALUE ZEROS         04113016
                                                    COMP SYNC.          04114016
           05 PV-PARAGRAPH-NAME           PIC X(30) VALUE SPACES.       04120000
           05 PV-TABLE-NAME               PIC X(30) VALUE SPACES.       04130000
           05 PV-OPERATION-MSG-1          PIC X(40) VALUE SPACES.       04140000
           05 PV-OPERATION-MSG-2          PIC X(40) VALUE SPACES.       04150000
           05 PV-CPU-TIME                 PIC 9(08) VALUE ZERO.         04160000
           05 PV-PAGE-CNT                 PIC 9(05) VALUE ZERO.         04170000
           05 PV-ADVANCE-LINES            PIC S9(04) COMP VALUE +1.     04180000
           05 PV-ADVANCE-CNT              PIC S9(04) COMP VALUE +0.     04190000
           05 PV-LINE-CNT                 PIC S9(04) COMP VALUE +0.     04200000
           05 PV-SKU-CNT                  PIC S9(04) COMP VALUE +0.     04210000
           05 PV-FULL-DAY-INDEX           PIC S9(04)  VALUE +0          04220000
                                                        COMP SYNC.      04230000
           05 PV-PART-DAY-INDEX           PIC S9(04)  VALUE +0          04240000
                                                        COMP SYNC.      04250000
           05 PV-PAGE-DIV                 PIC S9(05) VALUE +0.          04260000
           05 PV-PAGE-REM                 PIC S9(03) VALUE +0.          04270000
           05 PV-UPC-ID                   PIC S9(9) COMP VALUE ZEROS.   04280000
           05 PV-PROMO-NBR                PIC S9(3)V COMP-3.            04290000
           05 PV-SGN-NBR                  PIC 9(07) COMP VALUE ZEROS.   04300000
           05 PV-SIGN-COUNT               PIC S9(9) VALUE ZERO COMP-3.  04310000
           05 PV-AD-EVNT-NM               PIC X(25) VALUE SPACES.       04320000
           05 PV-AD-EVNT-NBR-TXT          PIC X(15) VALUE SPACES.       04330000
           05 PV-AD-EVNT-NBR-TXT-SV       PIC X(15) VALUE SPACES.       04340000
           05 PV-MDSE-SELN-LNE-ID         PIC S9(10) COMP-3 VALUE +0.   04350000
           05 PV-MDSE-SELN-LNE-ID-S       PIC S9(10) COMP-3 VALUE +0.   04360000
           05 PV-REPORT-TYPE              PIC X(02) VALUE SPACES.       04370000
           05 PV-FULL-DAY-PROMO-ID        PIC S9(10) COMP-3 VALUE +0.   04380000
           05 PV-FULL-DAY-PROMO-NM        PIC X(25) VALUE SPACES.       04390000
           05 PV-PART-DAY-PROMO-ID        PIC S9(10) COMP-3 VALUE +0.   04400000
           05 PV-PART-DAY-PROMO-ID-SAVED  PIC S9(10) COMP-3 VALUE +0.   04410000
           05 PV-PART-DAY-PROMO-NM        PIC X(25) VALUE SPACES.       04420000
           05 PV-FULL-DAY-PROMO-STRT-TMST PIC X(19) VALUE SPACES.       04430000
           05 PV-FD-STRT-TMST-RDF REDEFINES PV-FULL-DAY-PROMO-STRT-TMST.04440000
              10 PV-FD-STRT-TMST-DATE.                                  04450000
                15 PV-FD-STRT-DTE-CC      PIC X(02).                    04460000
                15 PV-FD-STRT-DTE-YY      PIC X(02).                    04470000
                15 FILLER                 PIC X(01).                    04480000
                15 PV-FD-STRT-DTE-MM      PIC X(02).                    04490000
                15 FILLER                 PIC X(01).                    04500000
                15 PV-FD-STRT-DTE-DD      PIC X(02).                    04510000
              10 PV-FD-STRT-TMST-HYPHEN   PIC X(01).                    04520000
              10 PV-FD-STRT-DAY-TMST-TIME PIC X(08).                    04530000
           05 PV-FULL-DAY-PROMO-END-TMST  PIC X(19) VALUE SPACES.       04540000
           05 PV-FD-END-TMST-RDF REDEFINES PV-FULL-DAY-PROMO-END-TMST.  04550000
              10 PV-FD-END-TMST-DATE.                                   04560000
                15 PV-FD-END-DTE-CC       PIC X(02).                    04570000
                15 PV-FD-END-DTE-YY       PIC X(02).                    04580000
                15 FILLER                 PIC X(01).                    04590000
                15 PV-FD-END-DTE-MM       PIC X(02).                    04600000
                15 FILLER                 PIC X(01).                    04610000
                15 PV-FD-END-DTE-DD       PIC X(02).                    04620000
              10 PV-FD-END-TMST-HYPHEN    PIC X(01).                    04630000
              10 PV-FD-END-DAY-TMST-TIME  PIC X(08).                    04640000
           05 PV-PART-DAY-PROMO-STRT-TMST PIC X(19) VALUE SPACES.       04650000
           05 PV-PD-STRT-TMST-RDF REDEFINES PV-PART-DAY-PROMO-STRT-TMST.04660000
              10 PV-PD-STRT-TMST-DATE.                                  04670000
                15 PV-PD-STRT-DTE-CC      PIC X(02).                    04680000
                15 PV-PD-STRT-DTE-YY      PIC X(02).                    04690000
                15 FILLER                 PIC X(01).                    04700000
                15 PV-PD-STRT-DTE-MM      PIC X(02).                    04710000
                15 FILLER                 PIC X(01).                    04720000
                15 PV-PD-STRT-DTE-DD      PIC X(02).                    04730000
              10 PV-PD-STRT-TMST-HYPHEN   PIC X(01).                    04740000
              10 PV-PD-STRT-DAY-TMST-TIME PIC X(08).                    04750000
           05 PV-PART-DAY-PROMO-END-TMST  PIC X(19) VALUE SPACES.       04760000
           05 PV-PD-END-TMST-RDF REDEFINES PV-PART-DAY-PROMO-END-TMST.  04770000
              10 PV-PD-END-TMST-DATE.                                   04780000
                15 PV-PD-END-DTE-CC       PIC X(02).                    04790000
                15 PV-PD-END-DTE-YY       PIC X(02).                    04800000
                15 FILLER                 PIC X(01).                    04810000
                15 PV-PD-END-DTE-MM       PIC X(02).                    04820000
                15 FILLER                 PIC X(01).                    04830000
                15 PV-PD-END-DTE-DD       PIC X(02).                    04840000
              10 PV-PD-END-TMST-HYPHEN    PIC X(01).                    04850000
              10 PV-PD-END-DAY-TMST-TIME  PIC X(08).                    04860000
           05 PV-FULL-DAY-PROMO-ITM-ID    PIC S9(10) COMP-3 VALUE +0.   04870000
           05 PV-PART-DAY-PROMO-ITM-ID    PIC S9(10) COMP-3 VALUE +0.   04880000
           05 PV-FULL-DAY-PROMO-ITM-DESC  PIC X(31) VALUE SPACES.       04890000
           05 PV-PART-DAY-PROMO-ITM-DESC  PIC X(31) VALUE SPACES.       04900000
           05 PV-FULL-DAY-ADV-IND         PIC X(01) VALUE SPACES.       04910000
           05 PV-PART-DAY-ADV-IND         PIC X(01) VALUE SPACES.       04920000
           05 PV-FULL-DAY-PRCH-TYP-CDE    PIC X(01)  VALUE SPACES.      04930000
           05 PV-PART-DAY-PRCH-TYP-CDE    PIC X(01)  VALUE SPACES.      04940000
           05 PV-DEPT-NBR                 PIC S9(04) COMP-3 VALUE +0.   04950000
           05 PV-DEPT-NBR-SAVED           PIC S9(04) COMP-3 VALUE +0.   04960000
           05 PV-SUB-CL-NBR               PIC S9(04) COMP-3 VALUE +0.   04970000
           05 PV-SKU-NBR                  PIC S9(08) COMP-3 VALUE +0.   04980000
           05 PV-SKU-NBR-SAVED            PIC S9(08) COMP-3 VALUE +0.   04990000
           05 PV-STYLE-NBR                PIC  X(15) VALUE SPACES.      05000000
           05 PV-FULL-DAY-RETAIL-AMT    PIC S9(10)V9(3) COMP-3 VALUE +0.05010000
           05 PV-PART-DAY-RETAIL-AMT    PIC S9(10)V9(3) COMP-3 VALUE +0.05020000
           05 PV-PART-DAY-RETAIL-AMT-S  PIC S9(10)V9(3) COMP-3 VALUE +0.05030000
           05 PV-FULL-DAY-PRIC-PT-AMT   PIC S9(10)V9(3) COMP-3 VALUE +0.05040000
           05 PV-PART-DAY-PRIC-PT-AMT   PIC S9(10)V9(3) COMP-3 VALUE +0.05050000
           05 PV-PART-DAY-PRIC-PT-AMT-S PIC S9(10)V9(3) COMP-3 VALUE +0.05060000
           05 PV-FULL-DAY-PROMO-GP-QTY    PIC S9(05) COMP-3 VALUE +0.   05070000
           05 PV-PART-DAY-PROMO-GP-QTY PIC S9(05) COMP-3 VALUE +0.      05080000
           05 PV-FULL-DAY-PROMO-GP-AMT  PIC S9(09)V9(2) COMP-3 VALUE +0.05090000
           05 PV-PART-DAY-PROMO-GP-AMT  PIC S9(09)V9(2) COMP-3 VALUE +0.05100000
           05 PV-FULL-DAY-PRICG-TYP-CDE   PIC X(03) VALUE SPACES.       05110000
           05 PV-PART-DAY-PRICG-TYP-CDE PIC X(03) VALUE SPACES.         05120000
           05 PV-THRS-QTY                 PIC S9(05) COMP-3 VALUE +0.   05130000
           05 PV-LOC-NBR                  PIC S9(05) COMP-3 VALUE +0.   05140000
           05 PV-DEPT-NM                  PIC X(20) VALUE SPACES.       05150000
           05 PV-GMA-NBR                  PIC S9(4) COMP-3 VALUE +0.    05160000
           05 PV-GMA-NBR-SAVED            PIC S9(4) COMP-3 VALUE +0.    05170000
           05 PV-DMA-NBR                  PIC S9(4) COMP-3 VALUE +0.    05180000
           05 PV-DMA-NBR-SAVED            PIC S9(4) COMP-3 VALUE +0.    05190000
           05 PV-BYR-NBR                  PIC S9(4) COMP-3 VALUE +0.    05200000
           05 PV-BYR-NBR-SAVED            PIC S9(4) COMP-3 VALUE +0.    05210000
           05 PV-GMM-FRST-NM              PIC X(20).                    05220000
           05 PV-GMM-LAST-NM              PIC X(30).                    05230000
           05 PV-DMM-FRST-NM              PIC X(20).                    05240000
           05 PV-DMM-LAST-NM              PIC X(30).                    05250000
           05 PV-BYR-FRST-NM              PIC X(20).                    05260000
           05 PV-BYR-LAST-NM              PIC X(30).                    05270000
           05 PV-TEMP-VALUE               PIC X(01)  VALUE SPACES.      05280000
W37986     05 PV-CNT-STRS                 PIC 9(02)  VALUE ZEROES.      05290000
W37986     05 PV-HOST-STRS.                                             05300000
W37986        10  PV-HOST-STR-1           PIC S9(04) VALUE +0 COMP-3.   05310000
W37986        10  PV-HOST-STR-2           PIC S9(04) VALUE +0 COMP-3.   05320000
W37986        10  PV-HOST-STR-3           PIC S9(04) VALUE +0 COMP-3.   05330000
W37986        10  PV-HOST-STR-4           PIC S9(04) VALUE +0 COMP-3.   05340000
W37986        10  PV-HOST-STR-5           PIC S9(04) VALUE +0 COMP-3.   05350000
W37986        10  PV-HOST-STR-6           PIC S9(04) VALUE +0 COMP-3.   05360000
W37986        10  PV-HOST-STR-7           PIC S9(04) VALUE +0 COMP-3.   05370000
W37986        10  PV-HOST-STR-8           PIC S9(04) VALUE +0 COMP-3.   05380000
W37986        10  PV-HOST-STR-9           PIC S9(04) VALUE +0 COMP-3.   05390000
W37986        10  PV-HOST-STR-10          PIC S9(04) VALUE +0 COMP-3.   05400000
W37986        10  PV-HOST-STR-11          PIC S9(04) VALUE +0 COMP-3.   05410000
W37986        10  PV-HOST-STR-12          PIC S9(04) VALUE +0 COMP-3.   05420000
W37986        10  PV-HOST-STR-13          PIC S9(04) VALUE +0 COMP-3.   05430000
W37986        10  PV-HOST-STR-14          PIC S9(04) VALUE +0 COMP-3.   05440000
W37986        10  PV-HOST-STR-15          PIC S9(04) VALUE +0 COMP-3.   05450000
                                                                        05460000
                                                                        05470000
      ***************************************************************** 05480000
      *  STANDARD HEADER LINE - KOHLS 175 COL                           05490000
      ***************************************************************** 05500000
           COPY DPWS150O.                                               05510000
                                                                        05520000
      ***************************************************************** 05530000
      *    THE LAYOUT FOR THE GET SIGN NUMBER AND SKU DESCRIPTION     * 05540000
      *    PROGRAM PMKUT117 PARAMETER LIST.                           * 05550000
      ***************************************************************** 05560000
           COPY PMRD117.                                                05570000
                                                                        05580000
      ***************************************************************** 05590000
      *    THE LAYOUT FOR INPUT CONTROL CARD:                         * 05600000
      *    RUN DATE, REPORT TYPE, EB PROMO ID, FULL DAY PROMO ID      * 05610000
      ***************************************************************** 05620000
           COPY PMRD121.                                                05630011
                                                                        05640000
W37986***************************************************************** 05650000
W37986*    THE LAYOUT FOR INPUT FILE - SMPL-STR-INFILE                * 05660000
W37986***************************************************************** 05670000
W37986 01  CC-SMPL-STR-INFILE-REC.                                      05680000
W37986     05  CC-STR-NBR                     PIC 9(04) VALUE 0.        05690000
W37986     05  FILLER                         PIC X(76) VALUE SPACES.   05700000
W37986                                                                  05710000
      ***************************************************************** 05720000
      *                      O  R  A  C  L  E                           05730000
      *----------------------------------------------------------------*05740000
      *    ORACLE DECLARE SECTION                                       05750000
      *----------------------------------------------------------------*05760000
           EXEC SQL BEGIN DECLARE SECTION END-EXEC.                     05770000
                                                                        05780000
      *---------------------------------------------------------------* 05790000
      * ORACLE LOGON WORKING STORAGE COPYBOOK                           05800000
      *---------------------------------------------------------------* 05810000
       01      PC-ENT01-TYPE-CDE          PIC X(02)      VALUE '01'.    05820000
       01      PV-ORACLE-ID               PIC X(1)       VALUE '/'.     05830000
                                                                        05840000
       01      USERNAME                   PIC X(10)      VARYING.       05850000
       01      PASSWD                     PIC X(10)      VARYING.       05860000
                                                                        05870000
       01      ORACLE-RETURN              PIC X(200)     VALUE SPACES.  05880000
                                                                        05890000
           EXEC SQL END DECLARE SECTION END-EXEC.                       05900000
           EXEC SQL INCLUDE SQLCACOB    END-EXEC.                       05910000
                                                                        05920000
       PROCEDURE DIVISION.                                              05930000
      ***************************************************************** 05940000
      * MAINLINE ROUTINE                                                05950000
      ***************************************************************** 05960000
       A100-MAINLINE.                                                   05970000
                                                                        05980000
           PERFORM B100-INITIALIZE.                                     05990000
                                                                        06000000
           PERFORM B210-READ-PROMO-FILE                                 06010000
             UNTIL PS-PROMO-EOF.                                        06020000
                                                                        06030000
           PERFORM B900-CLOSE-FILES.                                    06040000
W37986     GOBACK.                                                      06050000
                                                                        06060000
      ***************************************************************** 06070000
      * INITIALIZE ROUTINE                                              06080000
      ***************************************************************** 06090000
       B100-INITIALIZE.                                                 06100000
                                                                        06110000
           OPEN INPUT  CC-PROMO-FILE                                    06120000
W37986                 SMPL-STR-INFILE                                  06130000
                OUTPUT PR-CONFLICT-RPT.                                 06140000
                                                                        06150000
           MOVE ZEROES                   TO PV-GMA-NBR-SAVED.           06160000
                                                                        06170000
      *    PERFORM PM700-A000-ORACLE-SETUP.                             06180016
           PERFORM B110-ORACLE-SETUP.                                   06181016
                                                                        06190000
      * SETS THE CURRENT DATE AND TIME ON THE TITLE OF THE REPORT.      06200000
           ACCEPT CD-CPU-DATE FROM DATE.                                06210000
           MOVE CD-CPU-YR                TO CD-CPU-YY.                  06220000
           MOVE CD-CPU-MO                TO CD-CPU-MM                   06230000
           MOVE CD-CPU-DY                TO CD-CPU-DD.                  06240000
                                                                        06250000
           ACCEPT CT-CPU-TIME FROM TIME.                                06260000
           MOVE CT-CPU-HR                TO DP150O-RUN-HOUR.            06270000
           MOVE CT-CPU-MIN               TO DP150O-RUN-MINUTE.          06280000
           MOVE CD-CPU-MO                TO DP150O-RUN-MONTH.           06290000
           MOVE CD-CPU-DY                TO DP150O-RUN-DAY.             06300000
           MOVE CD-CPU-YR                TO DP150O-RUN-YEAR.            06310000
           MOVE PC-PROGRAM-NAME          TO DP150O-PROGRAM-NAME.        06320016
           MOVE PC-RDS-REPORT-NAME       TO DP150O-REPORT-NUMBER.       06330000
                                                                        06340000
      ***************************************************************** 06341016
      * B110-READ-RUN-DATE-FILE.                                      * 06342016
      * ==> PROCESSES:                                                * 06343016
      *   - READ ORCALE CONTROL CARD                                  * 06344016
      * ==> PERFORMED FROM:  A100-MAINLINE                            * 06345016
      ***************************************************************** 06346016
       B110-ORACLE-SETUP.                                               06347016
                                                                        06348016
           OPEN INPUT ORACLE-LOGON-FILE.                                06349016
                                                                        06349116
           PERFORM B120-READ-ORACLE-LOGON.                              06349216
                                                                        06349316
           CLOSE ORACLE-LOGON-FILE.                                     06349416
                                                                        06349516
           IF ((PS-END-OF-LOGON-FILE)                                   06349616
                   OR (CC-ORACLE-CONNECTION = SPACES))                  06349716
               DISPLAY '** ABEND **'                                    06349816
               DISPLAY PC-PROGRAM-NAME ' - ORACLE LOGON CONTROL CARD '  06349916
                         'NOT PROVIDED'                                 06350016
               SET PS-ORA-SRC-EMPTY TO TRUE                             06350116
               CALL 'ILBOABN0' USING ABEND-CODE                         06350216
           END-IF.                                                      06350316
                                                                        06350416
           IF CC-AUTO-LOGON                                             06350516
               DISPLAY PC-PROGRAM-NAME ' - AUTO LOGON TO ORACLE'        06350616
               EXEC SQL                                                 06350716
                    CONNECT :USERNAME                                   06350816
               END-EXEC                                                 06350916
           ELSE                                                         06351016
               INITIALIZE PV-ORACLE-USERID-LEN                          06351116
                          PV-ORACLE-PASSWORD-LEN                        06351216
               INSPECT CC-ORACLE-USERID                                 06351316
                   TALLYING PV-ORACLE-USERID-LEN                        06351416
                FOR CHARACTERS BEFORE INITIAL SPACE                     06351516
            INSPECT CC-ORACLE-PASSWORD                                  06351616
                TALLYING PV-ORACLE-PASSWORD-LEN                         06351716
                FOR CHARACTERS BEFORE INITIAL SPACE                     06351816
            MOVE CC-ORACLE-USERID (1:PV-ORACLE-USERID-LEN) TO           06351916
                      USERNAME-ARR                                      06352016
            MOVE PV-ORACLE-USERID-LEN TO USERNAME-LEN                   06352116
            MOVE CC-ORACLE-PASSWORD (1:PV-ORACLE-PASSWORD-LEN) TO       06352216
                      PASSWD-ARR                                        06352316
            MOVE PV-ORACLE-PASSWORD-LEN TO PASSWD-LEN                   06352416
            DISPLAY PC-PROGRAM-NAME ' - LOGON TO ORACLE AS USER '       06352516
                      USERNAME-ARR                                      06352616
            EXEC SQL                                                    06352716
              CONNECT :USERNAME IDENTIFIED BY :PASSWD                   06352816
            END-EXEC                                                    06352916
            INITIALIZE CC-ORACLE-PASSWORD                               06353016
                       PASSWD                                           06353116
            END-IF.                                                     06353216
                                                                        06353316
020500     IF (SQLCODE NOT = 0)                                         06353416
020900         DISPLAY PV-PARAGRAPH-NAME                                06353516
020910         DISPLAY PC-PROGRAM-NAME ' - ERROR LOGGING ON TO ORACLE'  06353616
021000*        PERFORM 9900-ORACLE-ABEND                                06353716
               PERFORM Z100-ABEND                                       06353816
021200     END-IF.                                                      06353916
                                                                        06354016
      ***************************************************************** 06354116
      *  B120-READ-ORACLE-LOGON.                                      * 06354216
      * ==> PROCESSES:                                                * 06354316
      *   - READ ORCALE CONTROL CARD                                  * 06354416
      * ==> PERFORMED FROM:  B110-ORACLE-SETUP                        * 06354516
      ***************************************************************** 06354616
       B120-READ-ORACLE-LOGON.                                          06354716
                                                                        06354816
034510     READ ORACLE-LOGON-FILE                                       06354916
034520         INTO CC-ORACLE-CONNECTION                                06355016
034530         AT END                                                   06355116
034540             SET PS-END-OF-LOGON-FILE TO TRUE                     06355216
034550     END-READ.                                                    06355316
                                                                        06355416
      ****************************************************************  06356000
      * B210-READ-PROMO-FILE.                                           06360000
      *     READ IN THE PROMO FILE AND LOAD TO TABLE.                   06370000
      ****************************************************************  06380000
       B210-READ-PROMO-FILE.                                            06390000
                                                                        06400000
           READ CC-PROMO-FILE INTO PM121-PROMO                          06410000
              AT END                                                    06420000
                 SET PS-PROMO-EOF TO TRUE                               06430000
           END-READ.                                                    06440000
                                                                        06450000
           IF PS-PROMO-NOT-EOF                                          06460000
W37986         IF PS-FIRST-TIME-IN                                      06470000
W37986             SET PS-NOT-FIRST-TIME-IN TO TRUE                     06480000
W37986                                                                  06490000
W37986             PERFORM UNTIL PS-END-OF-CC-FILE-STR                  06500000
W37986                PERFORM B240-READ-SMPL-STR-FILE                   06510000
W37986             END-PERFORM                                          06520000
W37986                                                                  06530000
W37986         END-IF                                                   06540000
               SET PS-RUN-REPORT     TO TRUE                            06550000
               MOVE PM121-PART-DAY-PROMO-ID TO                          06560000
                    PV-PART-DAY-PROMO-ID                                06570000
               MOVE PM121-FULL-DAY-PROMO-ID TO                          06580000
                    PV-FULL-DAY-PROMO-ID                                06590000
               MOVE PM121-REPORT-TYPE TO                                06600000
                    PV-REPORT-TYPE                                      06610000
                    PC-RDS-REPORT-NAME                                  06620000
               DISPLAY '****************************'                   06630000
               DISPLAY 'PM121-PART-DAY-PROMO-ID = '                     06640000
                        PM121-PART-DAY-PROMO-ID                         06650000
               DISPLAY 'PM121-FULL-DAY-PROMO-ID = '                     06660000
                        PM121-FULL-DAY-PROMO-ID                         06670000
               DISPLAY 'PM121-REPORT-TYPE       = '                     06680000
                        PM121-REPORT-TYPE                               06690000
               DISPLAY '****************************'                   06700000
                                                                        06710000
               PERFORM B250-SELECT-PROMO-INFO                           06720000
               PERFORM B220-PROCESS-REPORT                              06730000
           END-IF.                                                      06740000
                                                                        06750000
      ****************************************************************  06760000
      * B220-PROCESS-REPORT.                                            06770000
      *     PROCESS THE REPORT.                                         06780000
      ****************************************************************  06790000
       B220-PROCESS-REPORT.                                             06800000
                                                                        06810000
           IF PS-PROMO-AVAIL                                            06820000
              PERFORM C100-DECLARE-PR-CONFLICT-CSR                      06830000
              PERFORM C200-OPEN-PR-CONFLICT-CSR                         06840000
              PERFORM C300-FETCH-PR-CONFLICT-CSR                        06850000
                                                                        06860000
              IF NOT PS-END-OF-PRCON-CSR                                06870000
                 PERFORM C400-PROCESS-PR-CONFLICT-CSR                   06880000
                        UNTIL PS-END-OF-PRCON-CSR                       06890000
              END-IF                                                    06900000
                                                                        06910000
              PERFORM C500-CLOSE-PR-CONFLICT-CSR                        06920000
           ELSE                                                         06930000
              PERFORM H100-WRITE-PAGE-HEADER                            06940000
              PERFORM W300-WRITE-LEGAL-LINE                             06950000
              PERFORM W400-WRITE-END-OF-RPT-LINE                        06960000
           END-IF.                                                      06970000
                                                                        06980000
W37986****************************************************************  06990000
W37986* B240-READ-SMPL-STR-FILE.                                        07000000
W37986*     READ IN SAMPLE STORE INFO FROM SMPL-STR-INFILE              07010000
W37986****************************************************************  07020000
W37986 B240-READ-SMPL-STR-FILE.                                         07030000
W37986                                                                  07040000
W37986     READ SMPL-STR-INFILE INTO CC-SMPL-STR-INFILE-REC             07050000
W37986       AT END                                                     07060000
W37986          SET PS-END-OF-CC-FILE-STR        TO TRUE                07070000
W37986     END-READ.                                                    07080000
W37986                                                                  07090000
W37986     ADD 1                                 TO PV-CNT-STRS.        07100000
W37986     IF  PS-END-OF-CC-FILE-STR                                    07110000
W37986     AND PV-CNT-STRS = 1                                          07120000
W37986         MOVE 'B240-READ-SMPL-STR-FILE'    TO PV-PARAGRAPH-NAME   07130000
W37986         MOVE 'CONTROL CARD IS EMPTY'      TO PV-OPERATION-MSG-1  07140000
W37986         SET ABEND-4003-CTRL-CARD-ERROR    TO TRUE                07150000
W37986         PERFORM Z200-ABEND                                       07160000
W37986     END-IF                                                       07170000
W37986                                                                  07180000
W37986     IF PS-END-OF-CC-FILE-STR                                     07190000
W37986        CONTINUE                                                  07200000
W37986     ELSE                                                         07210000
W37986        EVALUATE TRUE                                             07220000
W37986          WHEN PV-CNT-STRS = 1                                    07230000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-1       07240000
W37986          WHEN PV-CNT-STRS = 2                                    07250000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-2       07260000
W37986          WHEN PV-CNT-STRS = 3                                    07270000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-3       07280000
W37986          WHEN PV-CNT-STRS = 4                                    07290000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-4       07300000
W37986          WHEN PV-CNT-STRS = 5                                    07310000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-5       07320000
W37986          WHEN PV-CNT-STRS = 6                                    07330000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-6       07340000
W37986          WHEN PV-CNT-STRS = 7                                    07350000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-7       07360000
W37986          WHEN PV-CNT-STRS = 8                                    07370000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-8       07380000
W37986          WHEN PV-CNT-STRS = 9                                    07390000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-9       07400000
W37986          WHEN PV-CNT-STRS = 10                                   07410000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-10      07420000
W37986          WHEN PV-CNT-STRS = 11                                   07430000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-11      07440000
W37986          WHEN PV-CNT-STRS = 12                                   07450000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-12      07460000
W37986          WHEN PV-CNT-STRS = 13                                   07470000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-13      07480000
W37986          WHEN PV-CNT-STRS = 14                                   07490000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-14      07500000
W37986          WHEN PV-CNT-STRS = 15                                   07510000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-15      07520000
W37986        END-EVALUATE                                              07530000
W37986     END-IF.                                                      07540000
W37986                                                                  07550000
      ****************************************************************  07560000
      * B250-SELECT-PROMO-INFO.                                         07570000
      *     CHECK TO SEE THAT A NON-MAIN PROMOTION EXISTS ON THE        07580000
      *     PMT_SKU_LVL_PRICG_BY_LOC TABLE WITH A RUNDATE = TO          07590000
      *     THE CONTROL DATE PASSED INTO THE PROGRAM - THAT WAY         07600000
      *     WE KNOW WE HAVE AT LEAST ONE PROMOTION TO REPORT ON         07610000
      ****************************************************************  07620000
       B250-SELECT-PROMO-INFO.                                          07630000
                                                                        07640000
           EXEC SQL                                                     07650000
               SELECT  B.AD_EVNT_NM                                     07660000
                      ,B.AD_EVNT_NBR_TXT                                07670000
                      ,B.PROMO_NM                                       07680000
                      ,B.PROMO_DFLT_STRT_TMST                           07690000
                 INTO  :PV-AD-EVNT-NM                                   07700000
                      ,:PV-AD-EVNT-NBR-TXT                              07710000
                      ,:PV-PART-DAY-PROMO-NM                            07720000
                      ,:PV-PART-DAY-PROMO-STRT-TMST                     07730000
                 FROM  PMT_SKU_LVL_PRICG_BY_LOC A,                      07740000
                       PMV_PROMO_DIM B                                  07750000
                WHERE  A.PROMO_ID            = B.PROMO_ID               07760000
                  AND  A.AD_EVNT_ID          = B.AD_EVNT_ID             07770000
                  AND  B.PROMO_STAT_CDE      = 'S'                      07780000
                  AND  B.PROMO_ID            = :PV-PART-DAY-PROMO-ID    07790000
W37986            AND  A.LOC_NBR                                        07800000
W37986              NOT IN ( SELECT LOC_NBR                             07810000
W37986                         FROM XKT_LOC                             07820000
W37986                        WHERE E_BUS_IND = 'Y'                     07830000
W37986                          AND LOC_NBR IN ( :PV-HOST-STR-1         07840000
W37986                                          ,:PV-HOST-STR-2         07850000
W37986                                          ,:PV-HOST-STR-3         07860000
W37986                                          ,:PV-HOST-STR-4         07870000
W37986                                          ,:PV-HOST-STR-5         07880000
W37986                                          ,:PV-HOST-STR-6         07890000
W37986                                          ,:PV-HOST-STR-7         07900000
W37986                                          ,:PV-HOST-STR-8         07910000
W37986                                          ,:PV-HOST-STR-9         07920000
W37986                                          ,:PV-HOST-STR-10        07930000
W37986                                          ,:PV-HOST-STR-11        07940000
W37986                                          ,:PV-HOST-STR-12        07950000
W37986                                          ,:PV-HOST-STR-13        07960000
W37986                                          ,:PV-HOST-STR-14        07970000
W37986                                          ,:PV-HOST-STR-15        07980000
W37986                                          )                       07990000
W37986                      )                                           08000000
           END-EXEC.                                                    08010000
                                                                        08020000
           EVALUATE TRUE                                                08030000
             WHEN SQLCODE = ZEROES                                      08040000
             WHEN SQLCODE = 2112                                        08050000
             WHEN SQLCODE = -2112                                       08060000
                  SET PS-PROMO-AVAIL TO TRUE                            08070000
                  PERFORM B260-SELECT-FULL-DAY-PROMO                    08080000
             WHEN SQLCODE = 1403                                        08090000
                  SET PS-NO-PROMO TO TRUE                               08100000
                  DISPLAY 'NO PART-DAY PROMO WITH PROMO-ID:'            08110000
                  DISPLAY 'PV-PART-DAY-PROMO-ID = ' PV-PART-DAY-PROMO-ID08120000
                  DISPLAY '*** NOTHING TO REPORT ***'                   08130000
             WHEN OTHER                                                 08140000
                  SET ABEND-4013-SQL-ERROR TO TRUE                      08150000
                  MOVE 'PMT_SKU_LVL_PRICG_BY_LOC' TO PV-TABLE-NAME      08160000
                  MOVE 'B250-SELECT-PROMO-INFO'                         08170000
                                             TO PV-PARAGRAPH-NAME       08180000
                  MOVE 'ERROR ON SELECT PROMO INFO'                     08190000
                                             TO PV-OPERATION-MSG-1      08200000
                  PERFORM Z100-ABEND                                    08210000
           END-EVALUATE.                                                08220000
                                                                        08230000
      ****************************************************************  08240000
      * B260-SELECT-FULL-DAY-PROMO.                                     08250000
      *     SELECT FULL-DAY PROMO NAME FOR DISPLAY ON REPORTS           08260000
      *     IN CASE THERE ARE NO EXCEPTIONS TO REPORT.                  08270000
      ****************************************************************  08280000
       B260-SELECT-FULL-DAY-PROMO.                                      08290000
                                                                        08300000
           EXEC SQL                                                     08310000
               SELECT  A.PROMO_NM                                       08320000
                 INTO  :PV-FULL-DAY-PROMO-NM                            08330000
                 FROM  PMV_PROMO_DIM A                                  08340000
                WHERE  A.PROMO_ID        = :PV-FULL-DAY-PROMO-ID        08350000
                  AND  A.PROMO_STAT_CDE  = 'S'                          08360000
                                                                        08370000
           END-EXEC.                                                    08380000
                                                                        08390000
           EVALUATE TRUE                                                08400000
             WHEN SQLCODE = ZEROES                                      08410000
             WHEN SQLCODE = 2112                                        08420000
             WHEN SQLCODE = -2112                                       08430000
                  CONTINUE                                              08440000
             WHEN OTHER                                                 08450000
                  SET ABEND-4013-SQL-ERROR TO TRUE                      08460000
                  MOVE 'PMV_PROMO_DIM' TO PV-TABLE-NAME                 08470000
                  MOVE 'B260-SELECT-FULL-DAY-PROMO'                     08480000
                                             TO PV-PARAGRAPH-NAME       08490000
                  MOVE 'ERROR ON SELECT PROMO INFO'                     08500000
                                             TO PV-OPERATION-MSG-1      08510000
                  PERFORM Z100-ABEND                                    08520000
           END-EVALUATE.                                                08530000
                                                                        08540000
      ***************************************************************** 08550000
      *    CLOSE FILES                                                  08560000
      ***************************************************************** 08570000
       B900-CLOSE-FILES.                                                08580000
                                                                        08590000
           CLOSE  CC-PROMO-FILE                                         08600000
W37986            SMPL-STR-INFILE                                       08610000
                  PR-CONFLICT-RPT.                                      08620000
                                                                        08630000
      ***********************************************************       08640000
      * C100-DECLARE-PR-CONFLICT-CSR.                                   08650000
      ***********************************************************       08660000
       C100-DECLARE-PR-CONFLICT-CSR.                                    08670000
                                                                        08680000
           EXEC SQL                                                     08690000
                DECLARE CONFLICTCSR CURSOR FOR                          08700000
                SELECT /*+ FIRST_ROWS */                                08710015
                      C.AD_EVNT_NBR_TXT,                                08720000
                      C.AD_EVNT_NM,                                     08730000
                      A.PROMO_ID,                                       08740000
                      C.PROMO_NM,                                       08750000
                      A2.PROMO_ID,                                      08760000
                      C2.PROMO_NM,                                      08770000
                      A2.MDSE_SELN_LNE_ID,                              08780000
                      A.PROMO_STRT_TMST,                                08790000
                      A2.PROMO_STRT_TMST,                               08800000
                      A.PROMO_END_TMST,                                 08810000
                      A2.PROMO_END_TMST,                                08820000
                      A.PROMO_ITM_ID,                                   08830000
                      A2.PROMO_ITM_ID,                                  08840000
                      A.DEPT_NBR,                                       08850000
                      A.SUB_CL_NBR,                                     08860000
                      A.SKU_NBR,                                        08870000
                      A.VS_NBR,                                         08880000
                      A.UNT_RTL_AMT,                                    08890000
                      A2.UNT_RTL_AMT,                                   08900000
                      A.PROMO_PRIC_PT_AMT,                              08910000
                      A2.PROMO_PRIC_PT_AMT,                             08920000
                      A.PROMO_GP_QTY,                                   08930000
                      A2.PROMO_GP_QTY,                                  08940000
                      A.PROMO_GP_AMT,                                   08950000
                      A2.PROMO_GP_AMT,                                  08960000
                      A.PROMO_PRICG_TYP_CDE,                            08970000
                      A2.PROMO_PRICG_TYP_CDE,                           08980000
                      A.LOC_NBR,                                        08990000
                      B.PROMO_ITM_DESC,                                 09000000
                      B2.PROMO_ITM_DESC,                                09010000
                      B.ADV_IND,                                        09020000
                      B2.ADV_IND,                                       09030000
                      D.DEPT_NM,                                        09040000
                      D.GMA_NBR,                                        09050000
                      D.DMA_NBR,                                        09060000
                      D.BYR_NBR,                                        09070000
                      D.GMM_FRST_NM,                                    09080000
                      D.GMM_LAST_NM,                                    09090000
                      D.DMM_FRST_NM,                                    09100000
                      D.DMM_LAST_NM,                                    09110000
                      D.BYR_FRST_NM,                                    09120000
                      D.BYR_LAST_NM,                                    09130000
                      B.PRCH_TYP_CDE,                                   09140000
                      B2.PRCH_TYP_CDE                                   09150000
                 FROM PMT_SKU_LVL_PRICG_BY_LOC A,                       09160000
                      PMT_SKU_LVL_PRICG_BY_LOC A2,                      09170000
                      PMT_PROMO_ITM B,                                  09180000
                      PMT_PROMO_ITM B2,                                 09190000
                      PMV_PROMO_DIM C,                                  09200000
                      PMV_PROMO_DIM C2,                                 09210000
                      PMV_PRSN_MDSE_HIER D                              09220000
                WHERE C.PROMO_ID          = :PV-FULL-DAY-PROMO-ID       09230000
                  AND C.PROMO_STAT_CDE    = 'S'                         09240000
                  AND A2.PROMO_ID         = :PV-PART-DAY-PROMO-ID       09250000
                  AND A.AD_EVNT_ID        = A2.AD_EVNT_ID               09260000
                  AND A.SKU_NBR           = A2.SKU_NBR                  09270000
                  AND A.LOC_NBR           = A2.LOC_NBR                  09280000
W37986            AND A.LOC_NBR                                         09290000
W37986              NOT IN ( SELECT LOC_NBR                             09300000
W37986                         FROM XKT_LOC                             09310000
W37986                        WHERE E_BUS_IND = 'Y'                     09320000
W37986                          AND LOC_NBR IN ( :PV-HOST-STR-1         09330000
W37986                                          ,:PV-HOST-STR-2         09340000
W37986                                          ,:PV-HOST-STR-3         09350000
W37986                                          ,:PV-HOST-STR-4         09360000
W37986                                          ,:PV-HOST-STR-5         09370000
W37986                                          ,:PV-HOST-STR-6         09380000
W37986                                          ,:PV-HOST-STR-7         09390000
W37986                                          ,:PV-HOST-STR-8         09400000
W37986                                          ,:PV-HOST-STR-9         09410000
W37986                                          ,:PV-HOST-STR-10        09420000
W37986                                          ,:PV-HOST-STR-11        09430000
W37986                                          ,:PV-HOST-STR-12        09440000
W37986                                          ,:PV-HOST-STR-13        09450000
W37986                                          ,:PV-HOST-STR-14        09460000
W37986                                          ,:PV-HOST-STR-15        09470000
W37986                                          )                       09480000
W37986                      )                                           09490000
                  AND A.DEPT_NBR          = A2.DEPT_NBR                 09500000
                  AND A.PROMO_ID          <> A2.PROMO_ID                09510000
                  AND A.PROMO_ID          = C.PROMO_ID                  09520000
                  AND A2.PROMO_ID         = C2.PROMO_ID                 09530000
                  AND A.AD_EVNT_ID        = C.AD_EVNT_ID                09540000
                  AND A.PROMO_ITM_ID      = B.PROMO_ITM_ID              09550000
                  AND A2.PROMO_ITM_ID     = B2.PROMO_ITM_ID             09560000
                  AND A.PROMO_PRIC_PT_AMT > 0.01                        09570000
                  AND A2.PROMO_PRIC_PT_AMT  > 0.01                      09580000
                  AND A2.PROMO_PRIC_PT_AMT  >= A.PROMO_PRIC_PT_AMT      09590000
                  AND A.DEPT_NBR            = D.DEPT_NBR                09600000
                  AND A2.DEPT_NBR           = D.DEPT_NBR                09610000
                  AND A2.FRST_RCVD_DTE IS NOT NULL                      09620000
                  AND ((A2.OH_UNT_QTY       > 0)                        09630000
                   OR (A2.OH_UNT_QTY       <= 0                         09640000
                  AND A2.ONORD_UNT_QTY_IND = 'Y'                        09650000
                  AND A2.DONT_SHIP_BEF_DTE < A2.PROMO_END_TMST))        09660000
                  AND A.PROMO_PRICG_TYP_CDE                             09670000
                      NOT IN ('GBL', 'GBD', 'GBP', 'GAO')               09680000
                  AND A2.PROMO_PRICG_TYP_CDE                            09690000
                      NOT IN ('GBL', 'GBD', 'GBP', 'GAO')               09700000
                  AND C2.REG_PROMO_TYP_CDE  = 'A'                       09710000
                ORDER BY C.AD_EVNT_NBR_TXT,                             09720000
                         A2.PROMO_ID,                                   09730000
                         D.GMA_NBR,                                     09740000
                         D.DMA_NBR,                                     09750000
                         D.BYR_NBR,                                     09760000
                         A.DEPT_NBR,                                    09770000
                         A.SKU_NBR,                                     09780000
                         A2.MDSE_SELN_LNE_ID                            09790000
           END-EXEC.                                                    09800000
                                                                        09810000
      ***********************************************************       09820000
      * C200-OPEN-PR-CONFLICT-CSR.                                      09830000
      ***********************************************************       09840000
       C200-OPEN-PR-CONFLICT-CSR.                                       09850000
           ACCEPT PV-CPU-TIME FROM TIME.                                09860000
           DISPLAY ' '.                                                 09870000
           DISPLAY 'START PR CONF CSR OPEN: ' PV-CPU-TIME.              09880000
           SET PS-NOT-END-OF-PRCON-CSR TO TRUE.                         09890000
                                                                        09900000
           EXEC SQL                                                     09910000
               OPEN CONFLICTCSR                                         09920000
           END-EXEC.                                                    09930000
                                                                        09940000
           EVALUATE TRUE                                                09950000
               WHEN SQLCODE = ZERO                                      09960000
               WHEN SQLCODE = 1403                                      09970000
                   CONTINUE                                             09980000
               WHEN SQLCODE = 8103                                      09990000
                   DISPLAY '*** NO PR-EXCPTN TO REPORT ***'             10000000
                   PERFORM W300-WRITE-LEGAL-LINE                        10010000
                   PERFORM W400-WRITE-END-OF-RPT-LINE                   10020000
                   SET PS-END-OF-PRCON-CSR TO TRUE                      10030000
               WHEN OTHER                                               10040000
                   MOVE 'C200-OPEN-PR-CONFLICT-CSR'                     10050000
                                                 TO PV-PARAGRAPH-NAME   10060000
                   DISPLAY PV-PARAGRAPH-NAME                            10070000
                   PERFORM Z100-ABEND                                   10080000
           END-EVALUATE.                                                10090000
                                                                        10100000
      ***********************************************************       10110000
      * C300-FETCH-PR-CONFLICT-CSR.                                     10120000
      ***********************************************************       10130000
       C300-FETCH-PR-CONFLICT-CSR.                                      10140000
                                                                        10150000
           EXEC SQL                                                     10160000
               FETCH CONFLICTCSR                                        10170000
                 INTO :PV-AD-EVNT-NBR-TXT                               10180000
                     ,:PV-AD-EVNT-NM                                    10190000
                     ,:PV-FULL-DAY-PROMO-ID                             10200000
                     ,:PV-FULL-DAY-PROMO-NM                             10210000
                     ,:PV-PART-DAY-PROMO-ID                             10220000
                     ,:PV-PART-DAY-PROMO-NM                             10230000
                     ,:PV-MDSE-SELN-LNE-ID                              10240000
                     ,:PV-FULL-DAY-PROMO-STRT-TMST                      10250000
                     ,:PV-PART-DAY-PROMO-STRT-TMST                      10260000
                     ,:PV-FULL-DAY-PROMO-END-TMST                       10270000
                     ,:PV-PART-DAY-PROMO-END-TMST                       10280000
                     ,:PV-FULL-DAY-PROMO-ITM-ID                         10290000
                     ,:PV-PART-DAY-PROMO-ITM-ID                         10300000
                     ,:PV-DEPT-NBR                                      10310000
                     ,:PV-SUB-CL-NBR                                    10320000
                     ,:PV-SKU-NBR                                       10330000
                     ,:PV-STYLE-NBR                                     10340000
                     ,:PV-FULL-DAY-RETAIL-AMT                           10350000
                     ,:PV-PART-DAY-RETAIL-AMT                           10360000
                     ,:PV-FULL-DAY-PRIC-PT-AMT                          10370000
                     ,:PV-PART-DAY-PRIC-PT-AMT                          10380000
                     ,:PV-FULL-DAY-PROMO-GP-QTY                         10390000
                     ,:PV-PART-DAY-PROMO-GP-QTY                         10400000
                     ,:PV-FULL-DAY-PROMO-GP-AMT                         10410000
                     ,:PV-PART-DAY-PROMO-GP-AMT                         10420000
                     ,:PV-FULL-DAY-PRICG-TYP-CDE                        10430000
                     ,:PV-PART-DAY-PRICG-TYP-CDE                        10440000
                     ,:PV-LOC-NBR                                       10450000
                     ,:PV-FULL-DAY-PROMO-ITM-DESC                       10460000
                     ,:PV-PART-DAY-PROMO-ITM-DESC                       10470000
                     ,:PV-FULL-DAY-ADV-IND                              10480000
                     ,:PV-PART-DAY-ADV-IND                              10490000
                     ,:PV-DEPT-NM                                       10500000
                     ,:PV-GMA-NBR                                       10510000
                     ,:PV-DMA-NBR                                       10520000
                     ,:PV-BYR-NBR                                       10530000
                     ,:PV-GMM-FRST-NM                                   10540000
                     ,:PV-GMM-LAST-NM                                   10550000
                     ,:PV-DMM-FRST-NM                                   10560000
                     ,:PV-DMM-LAST-NM                                   10570000
                     ,:PV-BYR-FRST-NM                                   10580000
                     ,:PV-BYR-LAST-NM                                   10590000
                     ,:PV-FULL-DAY-PRCH-TYP-CDE                         10600000
                     ,:PV-PART-DAY-PRCH-TYP-CDE                         10610000
           END-EXEC.                                                    10620000
                                                                        10630000
           EVALUATE TRUE                                                10640000
               WHEN SQLCODE = ZERO                                      10650000
               WHEN SQLCODE = -1405                                     10660000
                  CONTINUE                                              10670000
                                                                        10680000
               WHEN SQLCODE = 1403                                      10690000
                                                                        10700000
                   IF PV-SKU-CNT > 0                                    10710000
                     PERFORM W300-WRITE-LEGAL-LINE                      10720000
                     PERFORM W400-WRITE-END-OF-RPT-LINE                 10730000
                     DISPLAY '*** END OF PRICING CONFLICTS TO RPT ***'  10740000
                   ELSE                                                 10750000
                     PERFORM H100-WRITE-PAGE-HEADER                     10760000
                     PERFORM W300-WRITE-LEGAL-LINE                      10770000
                     PERFORM W401-WRITE-NOTHING-TO-RPT-LINE             10780000
                     DISPLAY '***  NOTHING TO REPORT  ***'              10790000
                     DISPLAY '***  PROMO ID EXISTS ON  TABLE ***'       10800000
                     DISPLAY '***  BUT NO PRICING CONFLICTS  ***'       10810000
                   END-IF                                               10820000
                                                                        10830000
                   SET PS-END-OF-PRCON-CSR TO TRUE                      10840000
                                                                        10850000
               WHEN OTHER                                               10860000
                   MOVE 'C300-FETCH-PR-CONFLICT-CSR'                    10870000
                                           TO PV-PARAGRAPH-NAME         10880000
                   DISPLAY PV-PARAGRAPH-NAME                            10890000
                   PERFORM Z100-ABEND                                   10900000
           END-EVALUATE.                                                10910000
                                                                        10920000
      ***********************************************************       10930000
      * C400-PROCESS-PR-CONFLICT-CSR.                                   10940000
      ***********************************************************       10950000
       C400-PROCESS-PR-CONFLICT-CSR.                                    10960000
                                                                        10970000
           IF (PV-FULL-DAY-PRIC-PT-AMT = PV-PART-DAY-PRIC-PT-AMT        10980000
              AND PV-PART-DAY-PRCH-TYP-CDE = 'T')                       10990000
              PERFORM D150-CHECK-TIER                                   11000000
           END-IF.                                                      11010000
                                                                        11020000
           IF PS-NOT-SKIP-RECORD                                        11030000
              PERFORM D100-PROCESS-BREAKS                               11040000
           END-IF.                                                      11050000
                                                                        11060000
           IF PS-NOT-SKIP-RECORD                                        11070000
              PERFORM D200-PROCESS-DETAIL                               11080000
           END-IF.                                                      11090000
                                                                        11100000
           SET PS-NOT-SKIP-RECORD TO TRUE.                              11110000
           PERFORM C300-FETCH-PR-CONFLICT-CSR.                          11120000
                                                                        11130000
      ***********************************************************       11140000
      * C500-CLOSE-PR-CONFLICT-CSR.                                     11150000
      ***********************************************************       11160000
       C500-CLOSE-PR-CONFLICT-CSR.                                      11170000
                                                                        11180000
           EXEC SQL                                                     11190000
               CLOSE CONFLICTCSR                                        11200000
           END-EXEC.                                                    11210000
                                                                        11220000
           EVALUATE TRUE                                                11230000
               WHEN SQLCODE = ZERO                                      11240000
               WHEN SQLCODE = 1403                                      11250000
                   CONTINUE                                             11260000
               WHEN OTHER                                               11270000
                   MOVE 'C500-CLOSE-PR-CONFLICT-CSR'                    11280000
                                                TO PV-PARAGRAPH-NAME    11290000
                   DISPLAY PV-PARAGRAPH-NAME                            11300000
                   PERFORM Z100-ABEND                                   11310000
           END-EVALUATE.                                                11320000
                                                                        11330000
      ***************************************************************** 11340000
      * PROCESS BREAKS                                                  11350000
      * CHECK TO SEE IF PROCESSING NEW ADEVENT, NEW PROMOTION, NEW      11360000
      * GMM, NEW DMM, NEW BUYER OR NEW DEPT - WRITE OUT NEW PAGE        11370000
      * HEADER IF ANY OF THESE ARE THE CASE.                            11380000
      *                                                                 11390000
      * IF NOT ON ANY OF THOSE NEW ITEMS - NEED TO SEE IF WE ARE        11400000
      * PROCESSING A RECORD FOR THE SAME SKU WITH THE SAME              11410000
      * NON MAIN MDSE SELN LINE ID AND SAME NON MAIN PRICE POINT -      11420000
      * IF THIS IS THE CASE WE WANT TO SKIP OVER THIS RECORD TO         11430000
      * ELIMINATE DUPLICATING THE INFORMATION FOR ALL LOCATIONS         11440000
      * THAT ARE SETUP FOR THIS SKU/MDSE SELN LINE ID /PRICE.           11450000
      ***************************************************************** 11460000
       D100-PROCESS-BREAKS.                                             11470000
                                                                        11480000
           IF (PV-AD-EVNT-NBR-TXT NOT = PV-AD-EVNT-NBR-TXT-SV) OR       11490000
              (PV-PART-DAY-PROMO-ID NOT = PV-PART-DAY-PROMO-ID-SAVED) OR11500000
              (PV-GMA-NBR     NOT = PV-GMA-NBR-SAVED) OR                11510000
              (PV-DMA-NBR     NOT = PV-DMA-NBR-SAVED) OR                11520000
              (PV-BYR-NBR     NOT = PV-BYR-NBR-SAVED) OR                11530000
              (PV-DEPT-NBR    NOT = PV-DEPT-NBR-SAVED)                  11540000
                                                                        11550000
               IF PV-GMA-NBR-SAVED NOT = ZEROES                         11560000
                   PERFORM H010-WRITE-BLANK-PAGE-IF-NEED                11570000
               END-IF                                                   11580000
                                                                        11590000
              PERFORM H100-WRITE-PAGE-HEADER                            11600000
                                                                        11610000
           ELSE                                                         11620000
               IF (PV-SKU-NBR = PV-SKU-NBR-SAVED) AND                   11630000
                  (PV-SKU-NBR-SAVED NOT = 0) AND                        11640000
                  (PV-MDSE-SELN-LNE-ID = PV-MDSE-SELN-LNE-ID-S) AND     11650000
                  (PV-PART-DAY-PRIC-PT-AMT = PV-PART-DAY-PRIC-PT-AMT-S) 11660000
                  SET PS-SKIP-RECORD TO TRUE                            11670000
      *        ELSE                                                     11680000
      *           IF (PV-PART-DAY-PROMO-ITM-ID = 36471     OR           11690000
      *               PV-PART-DAY-PROMO-ITM-ID = 17793)                 11700000
      *           SET PS-SKIP-RECORD TO TRUE                            11710000
      *        END-IF                                                   11720000
                                                                        11730000
           END-IF.                                                      11740000
                                                                        11750000
                                                                        11760000
           MOVE PV-AD-EVNT-NBR-TXT      TO PV-AD-EVNT-NBR-TXT-SV.       11770000
           MOVE PV-PART-DAY-PROMO-ID    TO PV-PART-DAY-PROMO-ID-SAVED.  11780000
           MOVE PV-GMA-NBR              TO PV-GMA-NBR-SAVED.            11790000
           MOVE PV-DMA-NBR              TO PV-DMA-NBR-SAVED.            11800000
           MOVE PV-BYR-NBR              TO PV-BYR-NBR-SAVED.            11810000
           MOVE PV-DEPT-NBR             TO PV-DEPT-NBR-SAVED.           11820000
           MOVE PV-SKU-NBR              TO PV-SKU-NBR-SAVED.            11830000
           MOVE PV-MDSE-SELN-LNE-ID     TO PV-MDSE-SELN-LNE-ID-S.       11840000
           MOVE PV-PART-DAY-PRIC-PT-AMT TO    PV-PART-DAY-PRIC-PT-AMT-S.11850000
                                                                        11860000
           ADD +1 TO PV-SKU-CNT.                                        11870000
                                                                        11880000
      ***************************************************************** 11890000
      * D150 PARAGRAPH CALLED WHERE FULL DAY PRICE AND PART DAY PRICE   11900000
      * ARE EQUAL AND THE PART DAY HAS TIER PRICING.  NEED TO CHECK     11910000
      * IF THE QTY 1 - IF IT IS - SKIP OVER RECORD - DON'T NEED ON RPT  11920000
      ***************************************************************** 11930000
       D150-CHECK-TIER.                                                 11940000
                                                                        11950000
           EXEC SQL                                                     11960000
               SELECT  C.THRS_QTY                                       11970000
                 INTO  :PV-THRS-QTY                                     11980000
                 FROM  PMT_TIER_PRICG A,                                11990000
                       PMT_TIER_PRICG_GP B,                             12000000
                       PMT_TIER_PRICG_GP_TIER C                         12010000
                WHERE  A.PROMO_ITM_ID      = :PV-PART-DAY-PROMO-ITM-ID  12020000
                  AND  A.TIER_PRICG_ID     = B.TIER_PRICG_ID            12030000
                  AND  B.TIER_PRICG_GP_ID  = C.TIER_PRICG_GP_ID         12040000
                  AND  C.THRS_QTY          = 1                          12050000
                  AND  A.STAT_CDE          = 'S'                        12060000
                  AND  B.STAT_CDE          = 'S'                        12070000
                  AND  C.STAT_CDE          = 'S'                        12080000
           END-EXEC.                                                    12090000
                                                                        12100000
           EVALUATE TRUE                                                12110000
             WHEN SQLCODE = ZEROES                                      12120000
             WHEN SQLCODE = 2112                                        12130000
             WHEN SQLCODE = -2112                                       12140000
                  SET PS-SKIP-RECORD TO TRUE                            12150000
             WHEN SQLCODE = 1403                                        12160000
                  DISPLAY 'QTY NOT EQUAL 1'                             12170000
             WHEN OTHER                                                 12180000
                  SET ABEND-4013-SQL-ERROR TO TRUE                      12190000
                  MOVE 'PMT_TIER_PRICG'      TO PV-TABLE-NAME           12200000
                  MOVE 'D300-GET-QTY'        TO PV-PARAGRAPH-NAME       12210000
                  MOVE 'ERROR ON SELECT THRS QTY'                       12220000
                                             TO PV-OPERATION-MSG-1      12230000
                  PERFORM Z100-ABEND                                    12240000
           END-EVALUATE.                                                12250000
      ***************************************************************** 12260000
      * PROCESS DETAIL                                                  12270000
      ***************************************************************** 12280000
       D200-PROCESS-DETAIL.                                             12290000
                                                                        12300000
           IF PV-PART-DAY-PRIC-PT-AMT > PV-FULL-DAY-PRIC-PT-AMT         12310000
               MOVE 'HIGHER'           TO DTL-02-WINNER-REASON          12320000
           ELSE                                                         12330000
               IF PV-PART-DAY-PRIC-PT-AMT = PV-FULL-DAY-PRIC-PT-AMT     12340000
                   MOVE 'EQUAL '       TO DTL-02-WINNER-REASON          12350000
               ELSE                                                     12360000
                   MOVE 'LOWER '       TO DTL-02-WINNER-REASON          12370000
               END-IF                                                   12380000
           END-IF.                                                      12390000
                                                                        12400000
           MOVE '**' TO DTL-02-WINNER-IND.                              12410000
           PERFORM D400-POPULATE-DETAIL1.                               12420000
           PERFORM D500-POPULATE-DETAIL2.                               12430000
           PERFORM D350-GET-SIGN-AND-DESC.                              12440000
                                                                        12450000
P59023     IF PS-NOT-SKIP-RECORD                                        12451015
      *IF NOT THE SAME SKU, WRITE A BLANK DIVIDER LINE FIRST            12460000
           IF (PV-SKU-NBR NOT = PV-SKU-NBR-SAVED)                       12470000
               MOVE 'N'                  TO PS-SAME-SKU-SW              12480000
           ELSE                                                         12490000
               MOVE 'Y'                  TO PS-SAME-SKU-SW              12500000
P59023     END-IF                                                       12510015
                                                                        12520000
                                                                        12530000
           IF PS-NOT-SAME-SKU THEN                                      12540000
               PERFORM W700-WRITE-BLANK-LINE                            12550000
P59023     END-IF                                                       12560015
                                                                        12570000
           IF PM117-MAIN-INDEX GREATER ZERO                             12580000
             MOVE PC-ONE TO PV-FULL-DAY-INDEX                           12590000
             PERFORM D355-FILL-IN-MAIN-SIGN-NBR                         12600000
                  UNTIL PV-FULL-DAY-INDEX > PM117-MAIN-INDEX            12610000
           ELSE                                                         12620000
             MOVE DETAIL-01            TO DETAIL-PRINT-01               12630000
             PERFORM W200-WRITE-RPT-DETAIL-LINE1                        12640000
P59023     END-IF                                                       12650015
                                                                        12660000
           IF PM117-NON-MAIN-INDEX GREATER ZERO                         12670000
             MOVE PC-ONE TO PV-PART-DAY-INDEX                           12680000
             PERFORM D356-FILL-IN-NON-MAIN-SIGN-NBR                     12690000
                  UNTIL PV-PART-DAY-INDEX > PM117-NON-MAIN-INDEX        12700000
           ELSE                                                         12710000
             MOVE DETAIL-02                TO DETAIL-PRINT-02           12720000
             PERFORM W250-WRITE-RPT-DETAIL-LINE2                        12730000
P59023     END-IF                                                       12740015
P59023     END-IF.                                                      12741015
                                                                        12750000
      ***************************************************************** 12760000
      * GET SKU DESC AND SIGN NUMBERS USING PMKUT117 DB2 SUBROUTINE     12770000
      ***************************************************************** 12780000
       D350-GET-SIGN-AND-DESC.                                          12790000
                                                                        12800000
           INITIALIZE PM117-PARAMETERS.                                 12810000
           MOVE PV-SKU-NBR            TO PM117-SKU-NBR.                 12820000
           MOVE  SPACES               TO PM117-SKU-DESC.                12830000
           MOVE  ZEROES               TO PM117-UPC-ID.                  12840000
                                                                        12850000
           SET PM117-GET-DESC TO TRUE.                                  12860000
           CALL PC-PMKUT117-PGM USING PM117-PARAMETERS.                 12870000
                                                                        12880000
P59023     IF PM117-SKU-DESC = 'SKU NOT FOUND'                          12881015
P59023      SET PS-SKIP-RECORD TO TRUE                                  12882015
P59023      DISPLAY '******************************************'        12883015
P59023      DISPLAY 'SKU NBR = ' PM117-SKU-NBR                          12884015
P59023      DISPLAY 'UPC ID  = ' PM117-UPC-ID                           12885015
P59023      DISPLAY 'SKU NOT FOUND IN XMT_LOC TABLE'                    12886015
P59023      DISPLAY 'THE SKU IS SKIPPED FROM REPORTING'                 12887015
P59023      DISPLAY '******************************************'        12888015
P59023     END-IF.                                                      12889015
                                                                        12889109
           IF PM117-UNSUCCESSFUL-CALL                                   12890000
              DISPLAY 'SKU NBR = ' PM117-SKU-NBR                        12900000
              DISPLAY 'UPC ID  = ' PM117-UPC-ID                         12910000
              MOVE PM117-ERROR-MESSAGE      TO PV-OPERATION-MSG-1       12920000
              MOVE PM117-SQLCODE            TO SQLCODE                  12930000
              MOVE 'TSIESGN XST_SKU'        TO PV-TABLE-NAME            12940000
              MOVE 'D350-GET-SIGN-AND-DESC' TO PV-PARAGRAPH-NAME        12950000
              PERFORM Z100-ABEND                                        12960000
           ELSE                                                         12970000
              MOVE PM117-SKU-DESC           TO DTL-01-SKU-DESC          12980000
           END-IF.                                                      12990000
                                                                        13000000
P59023     IF PS-NOT-SKIP-RECORD                                        13001015
           IF PM117-UPC-ID NOT EQUAL 0                                  13010000
            SET PM117-GET-SIGNS TO TRUE                                 13020000
            MOVE PV-FULL-DAY-PROMO-ID TO PM117-MAIN-PROMO-ID            13030000
            MOVE PV-PART-DAY-PROMO-ID TO PM117-NON-MAIN-PROMO-ID        13040000
            INITIALIZE PM117-MAIN-SIGN-TABLE-PARMS                      13050000
            INITIALIZE PM117-NMAIN-SIGN-TABLE-PARMS                     13060000
            CALL PC-PMKUT117-PGM USING PM117-PARAMETERS                 13070000
                                                                        13080000
            IF PM117-UNSUCCESSFUL-CALL                                  13090000
               DISPLAY 'MAIN PROMO ID = ' PM117-MAIN-PROMO-ID           13100000
               DISPLAY 'NONMAIN PROMO ID = ' PM117-NON-MAIN-PROMO-ID    13110000
               MOVE PM117-ERROR-MESSAGE      TO PV-OPERATION-MSG-1      13120000
               MOVE PM117-SQLCODE            TO SQLCODE                 13130000
               MOVE 'TSIESGN XST_SKU'        TO PV-TABLE-NAME           13140000
               MOVE 'D350-GET-SIGN-AND-DESC' TO PV-PARAGRAPH-NAME       13150000
               PERFORM Z100-ABEND                                       13160000
            END-IF                                                      13170000
P59023      END-IF                                                      13171015
P59023     END-IF.                                                      13180015
      ***************************************************************** 13190000
      * FILLS IN SIGN NUMBER FROM ARRAY PASSED BACK FROM SUBROUTINE     13200000
      * SIKELLY FOR DETAIL-1                                            13210000
      ***************************************************************** 13220000
       D355-FILL-IN-MAIN-SIGN-NBR.                                      13230000
                                                                        13240000
           MOVE PM117-MAIN-SIGN-NBR(PV-FULL-DAY-INDEX)                  13250000
                                     TO DTL-01-SIGN-NBR.                13260000
           MOVE DETAIL-01            TO DETAIL-PRINT-01.                13270000
           PERFORM W200-WRITE-RPT-DETAIL-LINE1.                         13280000
           ADD PC-ONE TO PV-FULL-DAY-INDEX.                             13290000
                                                                        13300000
      ***************************************************************** 13310000
      * FILLS IN SIGN NUMBER FROM ARRAY PASSED BACK FROM SUBROUTINE     13320000
      * SIKELLY FOR DETAIL-2 - NON MAIN                                 13330000
      ***************************************************************** 13340000
       D356-FILL-IN-NON-MAIN-SIGN-NBR.                                  13350000
           MOVE PM117-NON-MAIN-SIGN-NBR(PV-PART-DAY-INDEX)              13360000
                                         TO DTL-02-SIGN-NBR.            13370000
           MOVE DETAIL-02                TO DETAIL-PRINT-02.            13380000
           PERFORM W250-WRITE-RPT-DETAIL-LINE2.                         13390000
           ADD PC-ONE TO PV-PART-DAY-INDEX.                             13400000
                                                                        13410000
      ***************************************************************** 13420000
      * POPULATES THE FIRST DETAIL LINE (MAIN PROMO)                    13430000
      ***************************************************************** 13440000
       D400-POPULATE-DETAIL1.                                           13450000
                                                                        13460000
           MOVE PV-DEPT-NBR              TO DTL-01-DEPT-NBR.            13470000
           MOVE PV-SUB-CL-NBR            TO DTL-01-SUB-CL-NBR.          13480000
           MOVE PV-SKU-NBR               TO DTL-01-SKU-NBR.             13490000
           MOVE PV-STYLE-NBR             TO DTL-01-STYLE-NBR.           13500000
                                                                        13510000
           MOVE PV-FULL-DAY-PROMO-NM     TO DTL-01-PROMO-NAME-1.        13520000
           MOVE PV-FD-STRT-DTE-MM        TO DTL-01-PM-BEG-DTE-MM.       13530000
           MOVE '/'                      TO DTL-01-PM-BEG-DTE-D1.       13540000
           MOVE PV-FD-STRT-DTE-DD        TO DTL-01-PM-BEG-DTE-DD.       13550000
           MOVE '/'                      TO DTL-01-PM-BEG-DTE-D2.       13560000
           MOVE PV-FD-STRT-DTE-YY        TO DTL-01-PM-BEG-DTE-YY.       13570000
           MOVE PV-FD-END-DTE-MM         TO DTL-01-PM-END-DTE-MM.       13580000
           MOVE '/'                      TO DTL-01-PM-END-DTE-D1.       13590000
           MOVE PV-FD-END-DTE-DD         TO DTL-01-PM-END-DTE-DD.       13600000
           MOVE '/'                      TO DTL-01-PM-END-DTE-D2.       13610000
           MOVE PV-FD-END-DTE-YY         TO DTL-01-PM-END-DTE-YY.       13620000
           MOVE PV-FULL-DAY-PROMO-ITM-DESC TO DTL-01-PROMO-ITM-DESC-1.  13630000
           IF PV-FULL-DAY-ADV-IND = 'Y'                                 13640000
               MOVE 'A' TO DTL-01-ADV-IND-1                             13650000
           ELSE                                                         13660000
               MOVE 'U' TO DTL-01-ADV-IND-1                             13670000
           END-IF.                                                      13680000
                                                                        13690000
           MOVE PV-FULL-DAY-RETAIL-AMT   TO DTL-01-RETAIL-PRICE-1.      13700000
           MOVE PV-FULL-DAY-PRIC-PT-AMT  TO DTL-01-PROMO-PRICE-1.       13710000
                                                                        13720000
           MOVE ZEROES TO DTL-01-SIGN-NBR.                              13730000
                                                                        13740000
           IF PV-FULL-DAY-PRCH-TYP-CDE = 'T'                            13750000
             MOVE 'Y' TO DTL-01-TIER-PRICE-IND                          13760000
           ELSE                                                         13770000
             MOVE 'N' TO DTL-01-TIER-PRICE-IND                          13780000
           END-IF.                                                      13790000
                                                                        13800000
      ***************************************************************** 13810000
      * POPULATES THE SECOND DETAIL LINE (ALL OTHER PROMOS)             13820000
      ***************************************************************** 13830000
       D500-POPULATE-DETAIL2.                                           13840000
                                                                        13850000
           MOVE PV-PART-DAY-PROMO-NM        TO DTL-02-PROMO-NAME-2.     13860000
           MOVE PV-PD-STRT-DTE-MM        TO DTL-02-PM-BEG-DTE-MM.       13870000
           MOVE '/'                      TO DTL-02-PM-BEG-DTE-D1.       13880000
           MOVE PV-PD-STRT-DTE-DD        TO DTL-02-PM-BEG-DTE-DD.       13890000
           MOVE '/'                      TO DTL-02-PM-BEG-DTE-D2.       13900000
           MOVE PV-PD-STRT-DTE-YY        TO DTL-02-PM-BEG-DTE-YY.       13910000
           MOVE PV-PD-END-DTE-MM         TO DTL-02-PM-END-DTE-MM.       13920000
           MOVE '/'                      TO DTL-02-PM-END-DTE-D1.       13930000
           MOVE PV-PD-END-DTE-DD         TO DTL-02-PM-END-DTE-DD.       13940000
           MOVE '/'                      TO DTL-02-PM-END-DTE-D2.       13950000
           MOVE PV-PD-END-DTE-YY         TO DTL-02-PM-END-DTE-YY.       13960000
           MOVE PV-PART-DAY-PROMO-ITM-DESC  TO DTL-02-PROMO-ITM-DESC-2. 13970000
           IF PV-PART-DAY-ADV-IND = 'Y'                                 13980000
               MOVE 'A' TO DTL-02-ADV-IND-2                             13990000
           ELSE                                                         14000000
               MOVE 'U' TO DTL-02-ADV-IND-2                             14010000
           END-IF.                                                      14020000
                                                                        14030000
           MOVE PV-PART-DAY-RETAIL-AMT  TO DTL-02-RETAIL-PRICE-2.       14040000
           MOVE PV-PART-DAY-PRIC-PT-AMT TO DTL-02-PROMO-PRICE-2.        14050000
                                                                        14060000
           MOVE ZEROES TO DTL-02-SIGN-NBR.                              14070000
                                                                        14080000
           IF PV-PART-DAY-PRCH-TYP-CDE = 'T'                            14090000
             MOVE 'Y' TO DTL-02-TIER-PRICE-IND                          14100000
           ELSE                                                         14110000
             MOVE 'N' TO DTL-02-TIER-PRICE-IND                          14120000
           END-IF.                                                      14130000
                                                                        14140000
      ***************************************************************** 14150000
      *   WRITES A BLANK PAGE SO NEW BUYER STARTS ON NEW SHEET.         14160000
      ***************************************************************** 14170000
       H010-WRITE-BLANK-PAGE-IF-NEED.                                   14180000
                                                                        14190000
           DIVIDE PV-PAGE-CNT BY 2                                      14200000
               GIVING PV-PAGE-DIV                                       14210000
               REMAINDER PV-PAGE-REM.                                   14220000
                                                                        14230000
           IF PV-PAGE-REM > 0                                           14240000
                PERFORM H030-WRITE-ONE-BLANK-PAGE                       14250000
           END-IF.                                                      14260000
                                                                        14270000
      ***************************************************************** 14280000
      *   WRITES THE HEADER LINES TO THE REPORT.                        14290000
      ***************************************************************** 14300000
       H030-WRITE-ONE-BLANK-PAGE.                                       14310000
                                                                        14320000
           IF  PV-PAGE-CNT >= 1                                         14330000
              PERFORM W300-WRITE-LEGAL-LINE                             14340000
           END-IF.                                                      14350000
                                                                        14360000
           ADD 1                         TO PV-PAGE-CNT.                14370000
           MOVE PV-PAGE-CNT              TO DP150O-PAGE-NUMBER.         14380000
                                                                        14390000
           MOVE PC-RDS-REPORT-NAME       TO DP150O-REPORT-NUMBER.       14400000
           MOVE DP150O-STANDRD-HEADER-150-COLS TO PR-CONFLICT-LINE.     14410000
           PERFORM W100-WRITE-RPT-NEW-PAGE.                             14420000
                                                                        14430000
           MOVE HEADER-01                TO PR-CONFLICT-LINE.           14440000
           MOVE 2                        TO PV-ADVANCE-LINES.           14450000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          14460000
                                                                        14470000
           MOVE HEADER-02                TO PR-CONFLICT-LINE.           14480000
           MOVE 2                        TO PV-ADVANCE-LINES.           14490000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          14500000
                                                                        14510000
           MOVE HEADER-03                TO PR-CONFLICT-LINE.           14520000
           MOVE 2                        TO PV-ADVANCE-LINES.           14530000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          14540000
                                                                        14550000
           PERFORM W700-WRITE-BLANK-LINE.                               14560000
                                                                        14570000
           MOVE HEADER-GMM               TO PR-CONFLICT-LINE.           14580000
           MOVE 1                        TO PV-ADVANCE-LINES.           14590000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          14600000
                                                                        14610000
           MOVE HEADER-DMM               TO PR-CONFLICT-LINE.           14620000
           MOVE 1                        TO PV-ADVANCE-LINES.           14630000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          14640000
                                                                        14650000
           MOVE HEADER-BUYER             TO PR-CONFLICT-LINE.           14660000
           MOVE 1                        TO PV-ADVANCE-LINES.           14670000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          14680000
                                                                        14690000
           MOVE HEADER-DEPT              TO PR-CONFLICT-LINE.           14700000
           MOVE 1                        TO PV-ADVANCE-LINES.           14710000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          14720000
                                                                        14730000
           MOVE BLANK-PAGE-NOTE          TO PR-CONFLICT-LINE.           14740000
           MOVE 10                       TO PV-ADVANCE-LINES.           14750000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          14760000
                                                                        14770000
      ***************************************************************** 14780000
      *   WRITES THE HEADER LINES TO THE REPORT.                        14790000
      ***************************************************************** 14800000
       H100-WRITE-PAGE-HEADER.                                          14810000
                                                                        14820000
           IF  PV-PAGE-CNT >= 1                                         14830000
              PERFORM W300-WRITE-LEGAL-LINE                             14840000
           END-IF.                                                      14850000
                                                                        14860000
           ADD 1                         TO PV-PAGE-CNT.                14870000
           MOVE PV-PAGE-CNT              TO DP150O-PAGE-NUMBER.         14880000
                                                                        14890000
           MOVE PC-RDS-REPORT-NAME       TO DP150O-REPORT-NUMBER.       14900000
           MOVE DP150O-STANDRD-HEADER-150-COLS TO PR-CONFLICT-LINE.     14910000
           PERFORM W100-WRITE-RPT-NEW-PAGE.                             14920000
                                                                        14930000
           MOVE PC-HDR1-TITLE1           TO HDR-01-TITLE.               14940000
           MOVE HEADER-01                TO PR-CONFLICT-LINE.           14950000
           MOVE 2                        TO PV-ADVANCE-LINES.           14960000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          14970000
                                                                        14980000
           MOVE  'AD EVENT '             TO HDR-02-TITLE-1.             14990000
           MOVE   PV-AD-EVNT-NBR-TXT     TO HDR-02-TITLE-2.             15000000
           MOVE   PV-AD-EVNT-NM          TO HDR-02-TITLE-3.             15010000
           MOVE HEADER-02                TO PR-CONFLICT-LINE.           15020000
           MOVE 2                        TO PV-ADVANCE-LINES.           15030000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          15040000
                                                                        15050000
           MOVE SPACES TO HDR-03-TITLE.                                 15060000
           STRING PV-FULL-DAY-PROMO-NM DELIMITED BY '  '                15070000
                  ' VS. '                  DELIMITED BY SIZE            15080000
                  PV-PART-DAY-PROMO-NM     DELIMITED BY '  '            15090000
           INTO HDR-03-TITLE.                                           15100000
           MOVE HEADER-03                TO PR-CONFLICT-LINE.           15110000
           MOVE 2                        TO PV-ADVANCE-LINES.           15120000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          15130000
                                                                        15140000
           MOVE SPACES TO HDR-04-TITLE.                                 15150000
           IF PV-REPORT-TYPE = '01'                                     15160000
              MOVE PC-HDR1-TITLE4-01 TO HDR-04-TITLE                    15170000
           END-IF.                                                      15180000
                                                                        15190000
           IF PV-REPORT-TYPE = '02'                                     15200000
              MOVE PC-HDR1-TITLE4-02 TO HDR-04-TITLE                    15210000
           END-IF.                                                      15220000
                                                                        15230000
           IF PV-REPORT-TYPE = '03'                                     15240000
              MOVE PC-HDR1-TITLE4-03 TO HDR-04-TITLE                    15250000
           END-IF.                                                      15260000
                                                                        15270000
           MOVE HEADER-04                TO PR-CONFLICT-LINE.           15280000
           MOVE 2                        TO PV-ADVANCE-LINES.           15290000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          15300000
                                                                        15310000
           PERFORM W700-WRITE-BLANK-LINE.                               15320000
                                                                        15330000
           MOVE PV-GMA-NBR               TO HDR-GMM-NBR.                15340000
           MOVE SPACES                   TO HDR-GMM-NAME.               15350000
           STRING PV-GMM-FRST-NM DELIMITED BY SPACE                     15360000
                  ' '            DELIMITED BY SIZE                      15370000
                  PV-GMM-LAST-NM DELIMITED BY SPACE                     15380000
                                       INTO HDR-GMM-NAME.               15390000
           MOVE HEADER-GMM               TO PR-CONFLICT-LINE.           15400000
           MOVE 1                        TO PV-ADVANCE-LINES.           15410000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          15420000
                                                                        15430000
           MOVE PV-DMA-NBR               TO HDR-DMM-NBR.                15440000
           MOVE SPACES                   TO HDR-DMM-NAME.               15450000
           STRING PV-DMM-FRST-NM DELIMITED BY SPACE                     15460000
                  ' '            DELIMITED BY SIZE                      15470000
                  PV-DMM-LAST-NM DELIMITED BY SPACE                     15480000
                                       INTO HDR-DMM-NAME.               15490000
           MOVE HEADER-DMM               TO PR-CONFLICT-LINE.           15500000
           MOVE 1                        TO PV-ADVANCE-LINES.           15510000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          15520000
                                                                        15530000
           MOVE PV-BYR-NBR               TO HDR-BYR-NBR.                15540000
           MOVE SPACES                   TO HDR-BYR-NAME.               15550000
           STRING PV-BYR-FRST-NM DELIMITED BY SPACE                     15560000
                  ' '            DELIMITED BY SIZE                      15570000
                  PV-BYR-LAST-NM DELIMITED BY SPACE                     15580000
                                       INTO HDR-BYR-NAME.               15590000
           MOVE HEADER-BUYER             TO PR-CONFLICT-LINE.           15600000
           MOVE 1                        TO PV-ADVANCE-LINES.           15610000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          15620000
                                                                        15630000
           MOVE PV-DEPT-NBR              TO HDR-DEPT-NBR.               15640000
           MOVE PV-DEPT-NM               TO HDR-DEPT-NAME.              15650000
           MOVE HEADER-DEPT              TO PR-CONFLICT-LINE.           15660000
           MOVE 1                        TO PV-ADVANCE-LINES.           15670000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          15680000
                                                                        15690000
           PERFORM W700-WRITE-BLANK-LINE.                               15700000
                                                                        15710000
           MOVE HEADER-PRE-05            TO PR-CONFLICT-LINE.           15720000
           MOVE 1                        TO PV-ADVANCE-LINES.           15730000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          15740000
                                                                        15750000
           MOVE HEADER-05                TO PR-CONFLICT-LINE.           15760000
           MOVE 1                        TO PV-ADVANCE-LINES.           15770000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          15780000
                                                                        15790000
           PERFORM W700-WRITE-BLANK-LINE.                               15800000
                                                                        15810000
      ***************************************************************** 15820000
      *     WRITE NEW PAGE                                              15830000
      ***************************************************************** 15840000
       W100-WRITE-RPT-NEW-PAGE.                                         15850000
                                                                        15860000
           WRITE PR-CONFLICT-LINE AFTER ADVANCING PAGE.                 15870000
           MOVE 1                        TO PV-LINE-CNT.                15880000
                                                                        15890000
      ***************************************************************** 15900000
      *     WRITE HEADER LINE                                           15910000
      ***************************************************************** 15920000
       W150-WRITE-RPT-HEADER-LINE.                                      15930000
                                                                        15940000
           WRITE PR-CONFLICT-LINE AFTER ADVANCING                       15950000
                                       PV-ADVANCE-LINES.                15960000
           ADD PV-ADVANCE-LINES          TO PV-LINE-CNT.                15970000
                                                                        15980000
      ***************************************************************** 15990000
      *     WRITE DETAIL LINE1                                          16000000
      ***************************************************************** 16010000
       W200-WRITE-RPT-DETAIL-LINE1.                                     16020000
                                                                        16030000
           IF PV-LINE-CNT >=  PC-MAX-LINES                              16040000
               PERFORM H100-WRITE-PAGE-HEADER                           16050000
           END-IF.                                                      16060000
                                                                        16070000
           MOVE 1                        TO PV-ADVANCE-LINES.           16080000
           MOVE DETAIL-PRINT-01          TO PR-CONFLICT-LINE.           16090000
           WRITE PR-CONFLICT-LINE AFTER ADVANCING                       16100000
                                            PV-ADVANCE-LINES.           16110000
           ADD PV-ADVANCE-LINES          TO PV-LINE-CNT.                16120000
                                                                        16130000
           MOVE SPACES                   TO DETAIL-01.                  16140000
                                                                        16150000
      ***************************************************************** 16160000
      *     WRITE DETAIL LINE2                                          16170000
      ***************************************************************** 16180000
       W250-WRITE-RPT-DETAIL-LINE2.                                     16190000
                                                                        16200000
           IF PV-LINE-CNT >=  PC-MAX-LINES                              16210000
               PERFORM H100-WRITE-PAGE-HEADER                           16220000
           END-IF.                                                      16230000
                                                                        16240000
           MOVE 1                        TO PV-ADVANCE-LINES.           16250000
           MOVE DETAIL-PRINT-02          TO PR-CONFLICT-LINE.           16260000
           WRITE PR-CONFLICT-LINE AFTER ADVANCING PV-ADVANCE-LINES.     16270000
           ADD PV-ADVANCE-LINES          TO PV-LINE-CNT.                16280000
                                                                        16290000
           MOVE SPACES                   TO DETAIL-02.                  16300000
                                                                        16310000
      ******************************************************************16320000
      *     WRITE LEGAL LINE VERBAGE PER KOHL'S LEGAL DEPT.            *16330000
      ******************************************************************16340000
       W300-WRITE-LEGAL-LINE.                                           16350000
                                                                        16360000
           SUBTRACT PV-LINE-CNT FROM PC-MAX-LINES                       16370000
             GIVING PV-ADVANCE-CNT.                                     16380000
                                                                        16390000
           IF PV-ADVANCE-CNT < 1 THEN                                   16400000
               MOVE 2                  TO PV-ADVANCE-CNT                16410000
           ELSE                                                         16420000
               ADD 2                   TO PV-ADVANCE-CNT                16430000
           END-IF.                                                      16440000
                                                                        16450000
           MOVE LEGAL-LINE             TO PR-CONFLICT-LINE.             16460000
           WRITE PR-CONFLICT-LINE AFTER ADVANCING PV-ADVANCE-CNT.       16470000
           ADD PV-ADVANCE-CNT          TO PV-LINE-CNT.                  16480000
                                                                        16490000
      ***************************************************************** 16500000
      *     WRITE END OF REPORT LINE                                    16510000
      ***************************************************************** 16520000
       W400-WRITE-END-OF-RPT-LINE.                                      16530000
                                                                        16540000
           SUBTRACT PV-LINE-CNT FROM PC-MAX-LINES                       16550000
             GIVING PV-ADVANCE-CNT.                                     16560000
           MOVE PV-ADVANCE-CNT           TO PV-ADVANCE-LINES.           16570000
                                                                        16580000
           MOVE END-OF-REPORT-LINE       TO PR-CONFLICT-LINE.           16590000
           WRITE PR-CONFLICT-LINE AFTER ADVANCING                       16600000
                                        PV-ADVANCE-LINES.               16610000
           ADD PV-ADVANCE-LINES          TO PV-LINE-CNT.                16620000
                                                                        16630000
      ***************************************************************** 16640000
      *     WRITE NOTHING TO REPORT LINE                                16650000
      ***************************************************************** 16660000
       W401-WRITE-NOTHING-TO-RPT-LINE.                                  16670000
                                                                        16680000
           SUBTRACT PV-LINE-CNT FROM PC-MAX-LINES                       16690000
             GIVING PV-ADVANCE-CNT.                                     16700000
           MOVE PV-ADVANCE-CNT           TO PV-ADVANCE-LINES.           16710000
                                                                        16720000
           MOVE NOTHING-TO-REPORT-LINE   TO PR-CONFLICT-LINE.           16730000
           WRITE PR-CONFLICT-LINE AFTER ADVANCING                       16740000
                                        PV-ADVANCE-LINES.               16750000
                                                                        16760000
           ADD PV-ADVANCE-LINES          TO PV-LINE-CNT.                16770000
                                                                        16780000
      ***************************************************************** 16790000
      *     WRITE BLANK LINE                                            16800000
      ***************************************************************** 16810000
       W700-WRITE-BLANK-LINE.                                           16820000
                                                                        16830000
           MOVE SPACES                   TO PR-CONFLICT-LINE.           16840000
           WRITE PR-CONFLICT-LINE AFTER ADVANCING 1.                    16850000
           ADD 1                         TO PV-LINE-CNT.                16860000
                                                                        16870000
      ******************************************************************16880000
      * THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION THAT     *16890000
      * LOGONS TO ORACLE.                                              *16900000
      ******************************************************************16910000
      *    COPY PMPD700.                                                16920016
                                                                        16930000
      ***************************************************************** 16940000
      * Z100-ABEND.                                                   * 16950000
      *  - PERFORM AN ABEND THAT OCCURED RELATED TO ORACLE            * 16960000
      ***************************************************************** 16970000
       Z100-ABEND.                                                      16980000
                                                                        16990000
           DISPLAY '                       '.                           17000000
           DISPLAY '** ABEND **       ** = SQLERROR'.                   17010000
           DISPLAY '** PROGRAM        ** = ' PC-PROGRAM-NAME.           17020016
           DISPLAY '** SQLCODE        ** = ' SQLCODE.                   17030000
           DISPLAY '** ABEND CODE     ** = ' ABEND-CODE.                17040000
           DISPLAY '** SQLERRM        ** = ' SQLERRM.                   17050000
           DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  17060000
           DISPLAY '** SQLERRD(5)     ** = ' SQLERRD(5).                17070000
           DISPLAY '** PARAGRAPH      ** = ' PV-PARAGRAPH-NAME.         17080000
           DISPLAY '** TABLE          ** = ' PV-TABLE-NAME.             17090000
           DISPLAY '** OPERATION      ** = ' PV-OPERATION-MSG-1.        17100000
           DISPLAY '                       '.                           17110000
                                                                        17120000
                                                                        17130000
           CALL 'ILBOABN0' USING ABEND-CODE.                            17140000
                                                                        17150000
W37986************************************************************      17160000
W37986* Z200-ABEND.                                                     17170000
W37986*     PERFORMS A NON-SQL-ABEND.                                   17180000
W37986************************************************************      17190000
W37986 Z200-ABEND.                                                      17200000
W37986                                                                  17210000
W37986     DISPLAY '** ABEND           **'.                             17220000
W37986     DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          17230016
W37986     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        17240000
W37986     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       17250000
W37986     DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.       17260000
W37986                                                                  17270000
W37986     CALL 'ILBOABN0' USING ABEND-CODE.                            17280000
W37986                                                                  17290000
