000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             SUKRP010.                                00050000
000600 AUTHOR.                 MICHAEL WALTERS.                         00060000
000700 INSTALLATION.           KOHLS.                                   00070000
000800 DATE-WRITTEN            SEPTEMBER, 1997.                         00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200*       THIS PROGRAM WILL PRINT THE AUDIT SUMMARY REPORT FOR THE  00120000
001300*  UCC128 CARTON AUDITING SYSTEM -- FOR CASEPACK ORDERS ONLY      00130000
001400******************************************************************00140000
001500*  CHANGED 10/05/09 BY SAURABH DUDDALWAR                        * 00150000
001600*   CHANGES ARE DONE TO HANDLE DATA CONTENTION ERRORS IN THE    * 00160000
001700*            PROGRAM WHILE REPORT GENERATION.                   * 00170000
001800*  CHANGED 11/22/13 BY SHOBHIT BAIJAL                           * 00180067
001900*   PR# 5148D  ADDED NEW LOGIC TO PRINT RFID ERROR REPORT FOR   * 00190068
002000*              RFID AUDIT OR MANUAL AUDIT                       * 00200068
002100*  CHANGED 12/26/13 BY RAMYA SREEDHAREN                         * 00210068
002200*   PR# 5148D  ADDED NEW LOGIC TO DISPLAY TOTAL UNITS AUDITED   * 00220068
002300*              FOR RFID AUDIT                                   * 00230068
002400*  CHANGED 01/10/14 BY RAMYA SREEDHAREN                         * 00240068
002500*   PR# 5148D  ADDED NEW LOGIC TO DISPLAY TOTAL UNITS AUDITED   * 00250068
002600*              FOR RFID AUDIT                                   * 00260068
002610*  CHANGED 03/19/14 BY SHOBHIT BAIJAL                           * 00261068
002620*   PR# 5148D  CHANGED THE LAYOUT OF PAGE HEADERS AND ADDED NEW * 00262068
002630*              HEADER FIELDS FOR 'AUDIT' AND 'DESIGNATION'      * 00263068
002640*  CHANGED 04/28/14 BY SHOBHIT BAIJAL                           * 00264068
002650*   PR# 5148D  ADDED LOGIC TO IDENTIFY IF DEPARTMENT IS RFID    * 00265068
002660*              TAGGING OR NOT AND DISPLAY COMBO ACCORDINGLY.    * 00266068
002670*  CHANGED 10/13/14 BY CHERI PARMLEY                            * 00267068
002680*              CHANGED PO# FROM 7 TO 8 DIGITS                   * 00268068
002690*  CHANGED 07/08/22 BY DENISE HAHN                              * 00269069
002691*              TO ALLOW REPORT TO BE SENT TO A FILE INSTEAD OF  * 00269169
002692*              ACTUALLY PRINTING THE REPORT                     * 00269269
002693*              ADDED A 3 "RPT" FILE THAT WILL ACTUALLY BE THE   * 00269370
002694*              REPORT SENT TO A FLAT FILE.                      * 00269470
002690*  CHANGED 02/14/23 BY JEAN KURK             CHG0281369         * 00269599
002691*              REMOVED COPYBOOK FOR UPC CHECK DIGIT ROUTINE     * 00269699
002700***************************************************************** 00270000
002800                                                                  00280000
002900******************************************************************00290000
003000 ENVIRONMENT DIVISION.                                            00300000
003100******************************************************************00310000
003200                                                                  00320000
003300 CONFIGURATION SECTION.                                           00330000
003400                                                                  00340000
003500 SOURCE-COMPUTER.        IBM-3090.                                00350000
003600 OBJECT-COMPUTER.        IBM-3090.                                00360000
003700                                                                  00370000
003800 INPUT-OUTPUT SECTION.                                            00380000
003900                                                                  00390000
004000 FILE-CONTROL.                                                    00400000
004100                                                                  00410000
004200     SELECT AS-AUDIT-SUM-EXTRACT-FILE                             00420000
004300         ASSIGN TO INP01.                                         00430000
004400                                                                  00440000
004500     SELECT AS-AUDIT-SUM-REPORT-FILE                              00450000
004600         ASSIGN TO RPT01.                                         00460000
004700                                                                  00470000
004800     SELECT AS-AUDIT-SUM-REPORT-FILE-LOG                          00480000
004900         ASSIGN TO RPT02.                                         00490000
005000                                                                  00500000
005010     SELECT AS-AUDIT-SUM-REPORT-FLAT-FILE                         00501070
005020         ASSIGN TO RPT03.                                         00502070
005030                                                                  00503070
005100******************************************************************00510000
005200 DATA DIVISION.                                                   00520000
005300******************************************************************00530000
005400                                                                  00540000
005500 FILE SECTION.                                                    00550000
005600                                                                  00560000
005700 FD  AS-AUDIT-SUM-EXTRACT-FILE                                    00570000
005800     RECORDING MODE IS F                                          00580000
005900     LABEL RECORDS ARE STANDARD                                   00590000
006000     BLOCK CONTAINS 0 RECORDS.                                    00600000
006100                                                                  00610000
006200 01  AS-AUDIT-SUM-EXTRACT-RECORD         PIC  X(200).             00620000
006300                                                                  00630000
006400 FD  AS-AUDIT-SUM-REPORT-FILE                                     00640000
006500     RECORDING MODE IS F                                          00650000
006600     LABEL RECORDS ARE STANDARD                                   00660000
006700     BLOCK CONTAINS 0 RECORDS.                                    00670000
006800                                                                  00680000
006900 01  AS-AUDIT-SUM-REPORT-LINE            PIC  X(132).             00690000
007000                                                                  00700000
007100 FD  AS-AUDIT-SUM-REPORT-FILE-LOG                                 00710000
007200     RECORDING MODE IS F                                          00720000
007300     LABEL RECORDS ARE STANDARD                                   00730000
007400     BLOCK CONTAINS 0 RECORDS.                                    00740000
007500                                                                  00750000
007600 01  AS-AUDIT-SUM-REPORT-LINE-LOG        PIC  X(132).             00760000
007610                                                                  00761070
007620 FD  AS-AUDIT-SUM-REPORT-FLAT-FILE                                00762070
007630     RECORDING MODE IS F                                          00763070
007640     LABEL RECORDS ARE STANDARD                                   00764070
007650     BLOCK CONTAINS 0 RECORDS.                                    00765070
007660                                                                  00766070
007670 01  AS-AUDIT-SUM-REPORT-LINE-FLAT       PIC  X(132).             00767070
007700                                                                  00770000
007800******************************************************************00780000
007900 WORKING-STORAGE SECTION.                                         00790000
008000******************************************************************00800000
008100                                                                  00810000
008200* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 00820000
008300*  STANDARD REPORT HEADER FOR A 132 COLUMN REPORT.                00830000
008400* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 00840000
008500     COPY DPWS132O.                                               00850000
008600                                                                  00860000
008700* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 00870000
008800*  RECORD LAYOUT FOR THE AUDIT SUMMARY EXTRACT FILE             * 00880000
008900* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 00890000
009000     COPY SURD005.                                                00900000
009100/                                                                 00910000
009200*    DOMAIN LOCATION MODULE                                       00920000
009300     COPY XLWS071.                                                00930000
009400/                                                                 00940000
009500* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 00950000
009600*  COPYBOOK MEMBER OF PRINTER LINE COMMANDS TO BE SUED WITH     * 00960000
009700*  PRINTEK PRINTERS                                             * 00970000
009800* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 00980000
009900     COPY DSWS004.                                                00990000
010000                                                                  01000000
010100* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 01010000
010200*  WORK AREA FOR SQL ERROR ROUTINE 'DSNTIAR'                      01020000
010300* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 01030000
010400     COPY DPWS004.                                                01040000
010500                                                                  01050000
010600* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 01060000
010700*  COPYBOOK FOR XLKUT001.                         WR # 21361    * 01070000
010800* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 01080000
010900     COPY XLWS001.                                                01090000
011000******************************************************************01100000
011100*  CHANGES MADE FOR WR # 21361 ENDS HERE                         *01110000
011200******************************************************************01120000
011300                                                                  01130000
011400 01  ABEND-CODE                          PIC S9(04) VALUE +0      01140000
011500                                                     COMP SYNC.   01150000
011600******************************************************************01160000
011700*     PAGE HEADINGS        PAGE HEADINGS         PAGE HEADING    *01170000
011800******************************************************************01180000
011900 01  PH2-PAGE-HEADING-2.                                          01190000
012000     05  FILLER                          PIC  X(52)  VALUE SPACE. 01200000
012100     05  FILLER                          PIC  X(28)  VALUE        01210000
012200         'VENDOR ACCURACY CARTON AUDIT'.                          01220000
012300     05  FILLER                          PIC  X(52)  VALUE SPACE. 01230000
012400                                                                  01240000
012500 01  PH3-PAGE-HEADING-3.                                          01250000
012600     05  FILLER                          PIC  X(55)  VALUE SPACE. 01260000
012700     05  FILLER                          PIC  X(22)  VALUE        01270000
012800         'CASEPACK CARTON AUDIT '.                                01280000
012900     05  FILLER                          PIC  X(55)  VALUE SPACE. 01290000
013000                                                                  01300000
013100 01  PH4-PAGE-HEADING-4.                                          01310000
013200     05  FILLER                          PIC  X(59)  VALUE SPACE. 01320000
013300     05  FILLER                          PIC  X(14)  VALUE        01330000
013400         'SUMMARY REPORT'.                                        01340000
013500     05  FILLER                          PIC  X(59)  VALUE SPACE. 01350000
013600                                                                  01360000
013700***************************************************************** 01370000
035502 01  AH1-AUDIT-HEADING-1.                                         03550200
035503     05  FILLER                          PIC  X(02)  VALUE SPACE. 03550300
035505     05  FILLER                          PIC  X(17)  VALUE        03550500
035506         'AUDIT CONTROL #: '.                                     03550600
035507     05  AH1-AUD-CNTL-NBR                PIC  Z(9)9  VALUE SPACE. 03550700
035509     05  FILLER                          PIC  X(17)  VALUE SPACE. 03550900
035520     05  FILLER                          PIC  X(17)  VALUE        03552000
035530         'AUDIT STATUS...: '.                                     03553000
035540     05  AH1-AUDIT-STATUS                PIC  X(15)  VALUE SPACE. 03554000
035550     05  FILLER                          PIC  X(11)  VALUE SPACE. 03555000
035560     05  FILLER                          PIC  X(19)  VALUE        03556000
035570         'FACILITY.........: '.                                   03557000
035580     05  AH1-OPER-UNT-ID                 PIC Z9(03)  VALUE SPACE. 03558000
035590     05  FILLER                          PIC  X(01)  VALUE '-'.   03559000
035600     05  AH1-FCLTY-DESC                  PIC  X(19)  VALUE SPACE. 03560074
035610                                                                  03561074
035700 01  AH2-AUDIT-HEADING-2.                                         03570000
035800     05  FILLER                          PIC  X(02)  VALUE SPACE. 03580000
035820     05  FILLER                          PIC  X(17)  VALUE        03582000
035830         'VENDOR NAME....: '.                                     03583000
035840     05  AH2-VENDOR-NAME                 PIC  X(20)  VALUE SPACE. 03584000
035860     05  FILLER                          PIC  X(07)  VALUE SPACE. 03586000
035880     05  FILLER                          PIC  X(17)  VALUE        03588000
035881         'DEPARTMENT.....: '.                                     03588100
035883     05  AH2-DEPT-NBR                    PIC  Z(03)  VALUE ZERO.  03588300
035884     05  FILLER                          PIC  X(66)  VALUE SPACE. 03588474
035885                                                                  03588500
035886***************************************************************** 03588600
035887 01  AH3-AUDIT-HEADING-3.                                         03588700
035888     05  FILLER                          PIC  X(02)  VALUE SPACE. 03588800
035890     05  FILLER                          PIC  X(17)  VALUE        03589000
035891         'PO/RECEIVER....: '.                                     03589100
035894     05  AH3-PO                          PIC  9(08)  VALUE ZERO.  03589467
035895     05  FILLER                          PIC  X      VALUE '-'.   03589500
035896     05  AH3-RECEIVER                    PIC  9(03)  VALUE ZERO.  03589600
035898     05  FILLER                          PIC  X(15)  VALUE SPACE. 03589867
035901     05  FILLER                          PIC  X(17)  VALUE        03590100
035902         'PRETICKET IND..: '.                                     03590200
035904     05  AH3-PRETICKET-IND               PIC  X(01)  VALUE SPACE. 03590400
035905         88  AH3-PRETICKET               VALUE 'Y'.               03590500
035906         88  AH3-NOT-PRETICKET           VALUE 'N'.               03590600
035908     05  FILLER                          PIC  X(25)  VALUE SPACE. 03590800
035909     05  FILLER                          PIC  X(19)  VALUE        03590900
035910         'AUDIT AREA.......: '.                                   03591000
035912     05  AH3-AUDIT-AREA                  PIC  X(04)  VALUE SPACE. 03591200
035913     05  FILLER                          PIC  X(20)  VALUE SPACE. 03591374
035914                                                                  03591400
035915***************************************************************** 03591500
035916 01  AH4-RECEIVER-HEADING-4.                                      03591600
035917     05  FILLER                          PIC  X(02)  VALUE SPACE. 03591700
035919     05  FILLER                          PIC  X(17)  VALUE        03591900
035920         'AUDIT TYPE.....: '.                                     03592000
035922     05  AH4-AUDIT-TYPE                  PIC  X(16)  VALUE SPACE. 03592200
035924     05  FILLER                          PIC  X(11)  VALUE SPACE. 03592400
035926     05  FILLER                          PIC  X(17)  VALUE        03592600
035927         'HANGER IND.....: '.                                     03592700
035929     05  AH4-HANGER-IND                  PIC  X(01)  VALUE SPACE. 03592900
035930         88  AH4-HANGER                  VALUE 'Y'.               03593000
035931         88  AH4-NOT-HANGER              VALUE 'N'.               03593100
035933     05  FILLER                          PIC  X(25)  VALUE SPACE. 03593300
035935     05  FILLER                          PIC  X(19)  VALUE        03593500
035936         'UNITS TRANSCRIBED: '.                                   03593600
035937     05  AH4-UNITS-TRANSCRIBED       PIC ZZZ,ZZZ,ZZ9 VALUE ZERO.  03593700
035938     05  FILLER                          PIC  X(13)  VALUE SPACE. 03593874
035939                                                                  03593900
035940***************************************************************** 03594000
035941 01  AH5-RECEIVER-HEADING-5.                                      03594100
035942     05  FILLER                          PIC  X(02)  VALUE SPACE. 03594200
035944     05  FILLER                          PIC  X(17)  VALUE        03594400
035945         'RECEIPT DATE...: '.                                     03594500
035947     05  AH5-RECIPT-DATE                 PIC  X(10)  VALUE SPACE. 03594700
035949     05  FILLER                          PIC  X(17)  VALUE SPACE. 03594900
035951     05  FILLER                          PIC  X(17)  VALUE        03595100
035952         'NEW STORE IND..: '.                                     03595200
035954     05  AH5-NEW-STORE-IND               PIC  X(01)  VALUE SPACE. 03595400
035955         88  AH5-NEW-STORE               VALUE 'Y'.               03595500
035956         88  AH5-NOT-NEW-STORE           VALUE 'N'.               03595600
035958     05  FILLER                          PIC  X(25)  VALUE SPACE. 03595800
035960     05  FILLER                          PIC  X(19)  VALUE        03596000
035961         'EXP CARTON COUNT.: '.                                   03596100
035962     05  FILLER                          PIC  X(01)  VALUE SPACE. 03596200
035963     05  AH5-EST-CART-COUNT          PIC  ZZ,ZZZ,ZZ9 VALUE ZERO.  03596300
035964     05  FILLER                          PIC  X(13)  VALUE SPACE. 03596474
035965                                                                  03596500
035966***************************************************************** 03596600
035967 01  AH6-RECEIVER-HEADING-6.                                      03596700
035968     05  FILLER                          PIC  X(02)  VALUE SPACE. 03596800
035970     05  FILLER                          PIC  X(17)  VALUE        03597000
035971         'AUDIT CATEGORY.: '.                                     03597100
035973     05  AH6-AUDIT-CATEGORY              PIC  X(04)  VALUE SPACE. 03597300
035975     05  FILLER                          PIC  X(23)  VALUE SPACE. 03597500
035977     05  FILLER                          PIC  X(17)  VALUE        03597700
035978         'AUDIT START....: '.                                     03597800
035979     05  AH6-AUDIT-START-DATE            PIC  X(10)  VALUE SPACE. 03597900
035980     05  FILLER                          PIC  X(01)  VALUE SPACE. 03598000
035981     05  AH6-AUDIT-START-TIME            PIC  X(05)  VALUE SPACE. 03598100
035983     05  FILLER                          PIC  X(10)  VALUE SPACE. 03598300
035985     05  FILLER                          PIC  X(19)  VALUE        03598500
035986         'CARTONS AUDITED..: '.                                   03598600
035988     05  AH6-CARTONS-AUDITED         PIC ZZZ,ZZZ,ZZ9 VALUE ZERO.  03598800
035989     05  FILLER                          PIC  X(13)  VALUE SPACE. 03598974
035990                                                                  03599000
035991***************************************************************** 03599100
035992 01  AH7-RECEIVER-HEADING-7.                                      03599200
035993     05  FILLER                          PIC  X(02)  VALUE SPACE. 03599300
035995     05  FILLER                          PIC  X(17)  VALUE        03599500
035996         'AUDIT..........: '.                                     03599600
035998     05  AH7-SYS-MAN-AUDIT               PIC  X(08)  VALUE SPACE. 03599800
035999         88 AH7-PROMPTED-AUDIT           VALUE 'PROMPTED'.        03599900
036000         88 AH7-MANUAL-AUDIT             VALUE 'MANUAL  '.        03600000
036002     05  FILLER                          PIC  X(19)  VALUE SPACE. 03600200
036004     05  FILLER                          PIC  X(17)  VALUE        03600400
036005         'AUDIT STOP.....: '.                                     03600500
036006     05  AH7-AUDIT-STOP-DATE             PIC  X(10)  VALUE SPACE. 03600600
036007     05  FILLER                          PIC  X(01)  VALUE SPACE. 03600700
036008     05  AH7-AUDIT-STOP-TIME             PIC  X(05)  VALUE SPACE. 03600800
036010     05  FILLER                          PIC  X(10)  VALUE SPACE. 03601000
036012     05  FILLER                          PIC  X(19)  VALUE        03601200
036013         'ADJ CARTON COUNT.: '.                                   03601300
036014     05  FILLER                          PIC  X(01)  VALUE SPACE. 03601400
036015     05  AH7-ADJ-CART-COUNT           PIC ZZ,ZZZ,ZZ9 VALUE ZERO.  03601500
036016     05  FILLER                          PIC  X(13)  VALUE SPACE. 03601674
036017                                                                  03601774
036018***************************************************************** 03601800
036019 01  AH8-RECEIVER-HEADING-8.                                      03601900
036020     05  FILLER                          PIC  X(02)  VALUE SPACE. 03602000
036022     05  FILLER                          PIC  X(17)  VALUE        03602200
036023         'DESIGNATION....: '.                                     03602300
036026     05  AH8-COMBO-AUDIT-IND             PIC  X(05)  VALUE SPACE. 03602600
036027         88 AH8-COMBO                    VALUE 'COMBO'.           03602700
036028         88 AH8-NOT-COMBO                VALUE '     '.           03602800
036030     05  FILLER                          PIC  X(22)  VALUE SPACE. 03603000
036032     05  FILLER                          PIC  X(17)  VALUE        03603200
036033         'DURATION(HH:MM): '.                                     03603300
036035     05  AH8-DURATION.                                            03603500
036036         15  AH8-DURATION-HOURS          PIC  ZZ99.               03603600
036037         15  FILLER                      PIC  X      VALUE ':'.   03603700
036038         15  AH8-DURATION-MINUTES        PIC  99.                 03603800
036039     05  AH8-DURATION-X REDEFINES AH8-DURATION                    03603900
036040                                         PIC  X(07).              03604000
036042     05  FILLER                          PIC  X(19)  VALUE SPACE. 03604200
036044     05  FILLER                          PIC  X(19)  VALUE        03604400
036045         'UNITS AUDITED....: '.                                   03604500
036047     05  AH8-UNITS-AUDITED           PIC ZZZ,ZZZ,ZZ9 VALUE ZERO.  03604700
036048     05  FILLER                          PIC  X(13)  VALUE SPACE. 03604874
036049                                                                  03604900
036050******************************************************************03605000
036051 01  AH9-RECEIVER-HEADING-9.                                      03605100
036052     05  FILLER                          PIC  X(02)  VALUE SPACE. 03605200
036053     05  FILLER                          PIC  X(21)  VALUE        03605300
036054         'AUDITING ASSOCIATES: '.                                 03605400
036055     05  AH9-USERID-TABLE.                                        03605500
036056       07 FILLER  OCCURS 12 TIMES                                 03605600
036057                  INDEXED BY AH9-UID-IDX.                         03605700
036058         10 AH9-USER-ID                  PIC  X(07) VALUE SPACE.  03605800
036059         10 AH9-COMMA                    PIC  X(01) VALUE SPACE.  03605900
036060         10 FILLER                       PIC  X(01) VALUE SPACE.  03606000
036061     05  FILLER                          PIC  X(01)  VALUE SPACE. 03606174
036062                                                                  03606200
036064                                                                  03606400
036065******************************************************************03606500
036066*     DETAIL HEADINGS      DETAIL HEADINGS       DETAIL HEADINGS *03606600
036067******************************************************************03606700
036070 01  PDH1-PICKING-DETAIL-HEADING-1.                               03607000
036100     05  FILLER                          PIC  X(52)  VALUE SPACE. 03610000
036200     05  FILLER                          PIC  X(27)  VALUE        03620000
036300         'P I C K I N G   E R R O R S'.                           03630000
036400     05  FILLER                          PIC  X(53)  VALUE SPACE. 03640000
036500                                                                  03650000
036600******************************************************************03660000
037100 01  PDH2-PICKING-DETAIL-HEADING-2.                               03710000
037200     05  FILLER                          PIC  X(02)  VALUE SPACE. 03720000
037300     05  FILLER                          PIC  X(07)  VALUE        03730000
037400         'DPT CL'.                                                03740000
037500     05  FILLER                          PIC  X(08)  VALUE        03750000
037600         'SKU NBRS'.                                              03760000
037700     05  FILLER                          PIC  X(03)  VALUE SPACE. 03770000
037800     05  FILLER                          PIC  X(03)  VALUE        03780000
037900         'LNE'.                                                   03790000
038000     05  FILLER                          PIC  X(05)  VALUE SPACE. 03800000
038100     05  FILLER                          PIC  X(11)  VALUE        03810000
038200         '--VENDOR-- '.                                           03820000
038300     05  FILLER                          PIC  X(03)  VALUE SPACES.03830000
038400     05  FILLER                          PIC  X(11)  VALUE        03840000
038500         '-RECEIVER- '.                                           03850000
038600     05  FILLER                          PIC  X(04)  VALUE SPACES.03860000
038700     05  FILLER                          PIC  X(05)  VALUE        03870000
038800         'STYLE'.                                                 03880000
038900     05  FILLER                          PIC  X(01)  VALUE SPACES.03890000
039000     05  FILLER                          PIC  X(07)  VALUE        03900000
039100         'DAMAGED'.                                               03910000
039200     05  FILLER                          PIC  X(10)  VALUE SPACES.03920000
039300     05  FILLER                          PIC  X(07)  VALUE        03930000
039400         '  TOTAL'.                                               03940000
039500     05  FILLER                          PIC  X(01)  VALUE SPACES.03950000
039600     05  FILLER                          PIC  X(09)  VALUE        03960000
039700         'TOT UNITS'.                                             03970000
039800     05  FILLER                          PIC  X(03)  VALUE SPACES.03980000
039900     05  FILLER                          PIC  X(09)  VALUE        03990000
040000         'TOT UNITS'.                                             04000000
040100     05  FILLER                          PIC  X(03)  VALUE SPACES.04010000
040200     05  FILLER                          PIC  X(09)  VALUE        04020000
040300         'TOT UNITS'.                                             04030000
040400     05  FILLER                          PIC  X(03)  VALUE SPACES.04040000
040500     05  FILLER                          PIC  X(07)  VALUE        04050000
040600         'ERROR  '.                                               04060000
040610     05  FILLER                          PIC  X(01)  VALUE SPACES.04061074
041000                                                                  04100000
041100******************************************************************04110000
041200 01  PDH3-PICKING-DETAIL-HEADING-3.                               04120000
041300     05  FILLER                          PIC  X(08)  VALUE SPACE. 04130000
041400     05  FILLER                          PIC  X(08)  VALUE        04140000
041500         'W/ERRORS'.                                              04150000
041600     05  FILLER                          PIC  X(04)  VALUE SPACE. 04160000
041700     05  FILLER                          PIC  X(03)  VALUE        04170000
041800         'NBR'.                                                   04180000
041900     05  FILLER                          PIC  X(05)  VALUE SPACE. 04190000
042000     05  FILLER                          PIC  X(11)  VALUE        04200000
042100         'OVER  SHORT'.                                           04210000
042200     05  FILLER                          PIC  X(03)  VALUE SPACES.04220000
042300     05  FILLER                          PIC  X(11)  VALUE        04230000
042400         'OVER  SHORT'.                                           04240000
042500     05  FILLER                          PIC  X(04)  VALUE SPACES.04250000
042600     05  FILLER                          PIC  X(05)  VALUE        04260000
042700         ' SUBS'.                                                 04270000
042800     05  FILLER                          PIC  X(01)  VALUE SPACES.04280000
042900     05  FILLER                          PIC  X(07)  VALUE        04290000
043000         ' UNITS '.                                               04300000
043100     05  FILLER                          PIC  X(10)  VALUE SPACES.04310000
043200     05  FILLER                          PIC  X(07)  VALUE        04320000
043300         ' ERRORS'.                                               04330000
043400     05  FILLER                          PIC  X(01)  VALUE SPACES.04340000
043500     05  FILLER                          PIC  X(09)  VALUE        04350000
043600         ' IN ERROR'.                                             04360000
043700     05  FILLER                          PIC  X(03)  VALUE SPACES.04370000
043800     05  FILLER                          PIC  X(09)  VALUE        04380000
043900         'TRANSCRIB'.                                             04390000
044000     05  FILLER                          PIC  X(03)  VALUE SPACES.04400000
044100     05  FILLER                          PIC  X(09)  VALUE        04410000
044200         ' AUDITED '.                                             04420000
044300     05  FILLER                          PIC  X(03)  VALUE SPACES.04430000
044400     05  FILLER                          PIC  X(07)  VALUE        04440000
044500         'RATIO  '.                                               04450000
044510     05  FILLER                          PIC  X(01)  VALUE SPACES.04451074
044600                                                                  04460000
044700******************************************************************04470000
045300 01  PDL-PICKING-DETAIL-LINE.                                     04530000
045400     05  FILLER                          PIC  X(02)  VALUE SPACES.04540000
045500     05  PDL-SKU-DEPT                    PIC  X(03).              04550000
045600     05  FILLER                          PIC  X      VALUE SPACE. 04560000
045700     05  PDL-SKU-CLASS                   PIC  X(02).              04570000
045800     05  FILLER                          PIC  X      VALUE SPACE. 04580000
045900     05  PDL-SKU-NBR                     PIC  X(08).              04590000
046000     05  FILLER                          PIC  X(02)  VALUE SPACES.04600000
046100     05  PDL-LINE-NBR                    PIC  ZZZ9.               04610000
046200     05  PDL-LINE-NBR-X REDEFINES                                 04620000
046300         PDL-LINE-NBR                    PIC  X(04).              04630000
046400     05  FILLER                          PIC  X(05)  VALUE SPACES.04640000
046500     05  PDL-VND-OVER                    PIC  ZZZ9.               04650000
046600     05  FILLER                          PIC  X(03)  VALUE SPACES.04660000
046700     05  PDL-VND-SHORT                   PIC  ZZZ9.               04670000
046800     05  FILLER                          PIC  X(03)  VALUE SPACES.04680000
046900     05  PDL-RCVR-OVER                   PIC  ZZZ9.               04690000
047000     05  PDL-RCVR-OVER-X REDEFINES                                04700000
047100         PDL-RCVR-OVER                   PIC  X(04).              04710000
047200     05  FILLER                          PIC  X(03)  VALUE SPACES.04720000
047300     05  PDL-RCVR-SHORT                  PIC  ZZZ9.               04730000
047400     05  PDL-RCVR-SHORT-X REDEFINES                               04740000
047500         PDL-RCVR-SHORT                  PIC  X(04).              04750000
047600     05  FILLER                          PIC  X(05)  VALUE SPACES.04760000
047700     05  PDL-STYLE-SUB                   PIC  ZZZ9.               04770000
047800     05  FILLER                          PIC  X(03)  VALUE SPACES.04780000
047900     05  PDL-DAMAGED-UNITS               PIC  ZZZ9.               04790000
048000     05  FILLER                          PIC  X(11)  VALUE SPACES.04800000
048100     05  PDL-TOTAL-ERRORS                PIC  ZZ,ZZ9.             04810000
048200     05  FILLER                          PIC  X(04)  VALUE SPACES.04820000
048300     05  PDL-TOTAL-UNITS-IN-ERROR        PIC  ZZ,ZZ9.             04830000
048400     05  FILLER                          PIC  X(04)  VALUE SPACES.04840000
048500     05  PDL-TOTAL-UNITS-TRNSCRBD        PIC  ZZZ,ZZ9.            04850000
048600     05  FILLER                          PIC  X(04)  VALUE SPACES.04860000
048700     05  PDL-TOTAL-UNITS-AUDITED         PIC  ZZZ,ZZ9.            04870000
048800     05  FILLER                          PIC  X(04)  VALUE SPACES.04880000
048900     05  PDL-ERROR-RATIO                 PIC  ZZ9.99.             04890000
049000     05  PDL-ERROR-RATIO-X  REDEFINES PDL-ERROR-RATIO             04900000
049100                                         PIC  X(6).               04910000
049200     05  PDL-PERCENT                     PIC  X(1)  VALUE '%'.    04920000
049210     05  FILLER                          PIC  X(03)  VALUE SPACES.04921074
049300                                                                  04930000
049400******************************************************************04940000
049500 01  PTL-PICKING-TOTAL-LINE.                                      04950000
049600     05  FILLER                          PIC  X(05)  VALUE SPACES.04960000
049700     05  PTL-TOTAL-DESCRIPTION           PIC  X(13)  VALUE SPACES.04970000
049800     05  FILLER                          PIC  X(01)  VALUE SPACES.04980000
049900     05  PTL-SKU-COUNT                   PIC  ZZZ9.               04990000
050000     05  FILLER                          PIC  X(03)  VALUE SPACES.05000000
050100     05  PTL-VND-OVER                    PIC  ZZ,ZZ9.             05010000
050200     05  FILLER                          PIC  X(01)  VALUE SPACES.05020000
050300     05  PTL-VND-SHORT                   PIC  ZZ,ZZ9.             05030000
050400     05  FILLER                          PIC  X(01)  VALUE SPACES.05040000
050500     05  PTL-RCVR-OVER                   PIC  ZZ,ZZ9.             05050000
050600     05  PTL-RCVR-OVER-X REDEFINES                                05060000
050700         PTL-RCVR-OVER                   PIC  X(06).              05070000
050800     05  FILLER                          PIC  X(01)  VALUE SPACES.05080000
050900     05  PTL-RCVR-SHORT                  PIC  ZZ,ZZ9.             05090000
051000     05  PTL-RCVR-SHORT-X REDEFINES                               05100000
051100         PTL-RCVR-SHORT                  PIC  X(06).              05110000
051200     05  FILLER                          PIC  X(03)  VALUE SPACES.05120000
051300     05  PTL-STYLE-SUB                   PIC  ZZ,ZZ9.             05130000
051400     05  FILLER                          PIC  X(01)  VALUE SPACES.05140000
051500     05  PTL-DAMAGED-UNITS               PIC  ZZ,ZZ9.             05150000
051600     05  FILLER                          PIC  X(08)  VALUE SPACES.05160000
051700     05  PTL-TOTAL-ERRORS                PIC  Z,ZZZ,ZZ9.          05170000
051800     05  FILLER                          PIC  X(01)  VALUE SPACES.05180000
051900     05  PTL-TOTAL-UNITS-IN-ERROR        PIC  Z,ZZZ,ZZ9.          05190000
052000     05  FILLER                          PIC  X(02)  VALUE SPACES.05200000
052100     05  PTL-TOTAL-UNITS-TRNSCRBD        PIC  Z,ZZZ,ZZ9.          05210000
052200     05  FILLER                          PIC  X(02)  VALUE SPACES.05220000
052300     05  PTL-TOTAL-UNITS-AUDITED         PIC  Z,ZZZ,ZZ9.          05230000
052400     05  FILLER                          PIC  X(04)  VALUE SPACES.05240000
052500     05  PTL-ERROR-RATIO                 PIC  ZZ9.99.             05250000
052600     05  PTL-ERROR-RATIO-X REDEFINES PTL-ERROR-RATIO              05260000
052700                                         PIC  X(6).               05270000
052800     05  PTL-PERCENT                     PIC  X(1)  VALUE '%'.    05280000
052810     05  FILLER                          PIC  X(03)  VALUE SPACES.05281074
052900                                                                  05290000
053000******************************************************************05300000
053100*     DETAIL HEADINGS      DETAIL HEADINGS       DETAIL HEADINGS *05310000
053200******************************************************************05320000
053300******************************************************************05330000
053400 01  TDH1-TICK-DETAIL-HEADING-1.                                  05340000
053500     05  FILLER                          PIC  X(42)  VALUE SPACE. 05350000
053600     05  FILLER                          PIC  X(31)  VALUE        05360000
053700         'T I C K E T I N G   E R R O R S'.                       05370000
053800     05  FILLER                          PIC  X(59)  VALUE SPACE. 05380000
053900******************************************************************05390000
054300******************************************************************05430000
054400 01  TDH2-TICK-DETAIL-HEADING-2.                                  05440000
054500     05  FILLER                          PIC  X(02)  VALUE SPACE. 05450000
054600     05  FILLER                          PIC  X(07)  VALUE        05460000
054700         'DPT CL'.                                                05470000
054800     05  FILLER                          PIC  X(08)  VALUE        05480000
054900         'SKU NBRS'.                                              05490000
055000     05  FILLER                          PIC  X(02)  VALUE SPACE. 05500000
055100     05  FILLER                          PIC  X(03)  VALUE        05510000
055200         'LNE'.                                                   05520000
055300     05  FILLER                          PIC  X(02)  VALUE SPACE. 05530000
055400     05  FILLER                          PIC  X(07)  VALUE        05540000
055500         'MISSING'.                                               05550000
055600     05  FILLER                          PIC  X(01)  VALUE SPACES.05560000
055700     05  FILLER                          PIC  X(06)  VALUE        05570000
055800         ' WRONG'.                                                05580000
055900     05  FILLER                          PIC  X(02)  VALUE SPACES.05590000
056000     05  FILLER                          PIC  X(07)  VALUE        05600000
056100         'WRG LBL'.                                               05610000
056200     05  FILLER                          PIC  X(02)  VALUE SPACES.05620000
056300     05  FILLER                          PIC  X(07)  VALUE        05630000
056400         '  NO   '.                                               05640000
056500     05  FILLER                          PIC  X(02)  VALUE SPACES.05650000
056600     05  FILLER                          PIC  X(07)  VALUE        05660000
056700         'DAMAGED'.                                               05670000
056800     05  FILLER                          PIC  X(02)  VALUE SPACES.05680000
056900     05  FILLER                          PIC  X(05)  VALUE        05690000
057000         'WRONG'.                                                 05700000
057100     05  FILLER                          PIC  X(02)  VALUE SPACES.05710000
057200     05  FILLER                          PIC  X(06)  VALUE        05720000
057300         '      '.                                                05730000
057400     05  FILLER                          PIC  X(02)  VALUE SPACES.05740000
057500     05  FILLER                          PIC  X(07)  VALUE        05750000
057600         '  TOTAL'.                                               05760000
057700     05  FILLER                          PIC  X(01)  VALUE SPACES.05770000
057800     05  FILLER                          PIC  X(09)  VALUE        05780000
057900         'TOT UNITS'.                                             05790000
058000     05  FILLER                          PIC  X(03)  VALUE SPACES.05800000
058100     05  FILLER                          PIC  X(09)  VALUE        05810000
058200         'TOT UNITS'.                                             05820000
058300     05  FILLER                          PIC  X(03)  VALUE SPACES.05830000
058400     05  FILLER                          PIC  X(09)  VALUE        05840000
058500         'TOT UNITS'.                                             05850000
058600     05  FILLER                          PIC  X(03)  VALUE SPACES.05860000
058700     05  FILLER                          PIC  X(07)  VALUE        05870000
058800         'ERROR '.                                                05880074
058900                                                                  05890000
059300******************************************************************05930000
059400 01  TDH3-TICK-DETAIL-HEADING-3.                                  05940000
059500     05  FILLER                          PIC  X(07)  VALUE SPACE. 05950000
059600     05  FILLER                          PIC  X(08)  VALUE        05960000
059700         'W/ERRORS'.                                              05970000
059800     05  FILLER                          PIC  X(04)  VALUE SPACE. 05980000
059900     05  FILLER                          PIC  X(03)  VALUE        05990000
060000         'NBR'.                                                   06000000
060100     05  FILLER                          PIC  X(02)  VALUE SPACE. 06010000
060200     05  FILLER                          PIC  X(07)  VALUE        06020000
060300         'TICKET '.                                               06030000
060400     05  FILLER                          PIC  X(01)  VALUE SPACES.06040000
060500     05  FILLER                          PIC  X(06)  VALUE        06050000
060600         'TICKET'.                                                06060000
060700     05  FILLER                          PIC  X(02)  VALUE SPACES.06070000
060800     05  FILLER                          PIC  X(07)  VALUE        06080000
060900         'ON MDSE'.                                               06090000
061000     05  FILLER                          PIC  X(02)  VALUE SPACES.06100000
061100     05  FILLER                          PIC  X(07)  VALUE        06110000
061200         'BARCODE'.                                               06120000
061300     05  FILLER                          PIC  X(02)  VALUE SPACES.06130000
061400     05  FILLER                          PIC  X(07)  VALUE        06140000
061500         'BARCODE'.                                               06150000
061600     05  FILLER                          PIC  X(02)  VALUE SPACES.06160000
061700     05  FILLER                          PIC  X(05)  VALUE        06170000
061800         ' UPC '.                                                 06180000
061900     05  FILLER                          PIC  X(02)  VALUE SPACES.06190000
062000     05  FILLER                          PIC  X(06)  VALUE        06200000
062100         'NO UPC'.                                                06210000
062200     05  FILLER                          PIC  X(02)  VALUE SPACES.06220000
062300     05  FILLER                          PIC  X(07)  VALUE        06230000
062400         ' ERRORS'.                                               06240000
062500     05  FILLER                          PIC  X(01)  VALUE SPACES.06250000
062600     05  FILLER                          PIC  X(09)  VALUE        06260000
062700         ' IN ERROR'.                                             06270000
062800     05  FILLER                          PIC  X(03)  VALUE SPACES.06280000
062900     05  FILLER                          PIC  X(09)  VALUE        06290000
063000         'TRANSCRIB'.                                             06300000
063100     05  FILLER                          PIC  X(03)  VALUE SPACES.06310000
063200     05  FILLER                          PIC  X(09)  VALUE        06320000
063300         ' AUDITED '.                                             06330000
063400     05  FILLER                          PIC  X(03)  VALUE SPACES.06340000
063500     05  FILLER                          PIC  X(07)  VALUE        06350000
063600         'RATIO  '.                                               06360000
063700                                                                  06370000
063800******************************************************************06380000
064300******************************************************************06430000
064400 01  TDL-TICKETING-DETAIL-LINE.                                   06440000
064500     05  FILLER                          PIC  X(01)  VALUE SPACES.06450000
064600     05  TDL-SKU-DEPT                    PIC  X(03).              06460000
064700     05  FILLER                          PIC  X      VALUE SPACE. 06470000
064800     05  TDL-SKU-CLASS                   PIC  X(02).              06480000
064900     05  FILLER                          PIC  X      VALUE SPACE. 06490000
065000     05  TDL-SKU-NBR                     PIC  X(08).              06500000
065100     05  FILLER                          PIC  X(02)  VALUE SPACES.06510000
065200     05  TDL-LINE-NBR                    PIC  ZZZ9.               06520000
065300     05  TDL-LINE-NBR-X REDEFINES                                 06530000
065400         TDL-LINE-NBR                    PIC  X(04).              06540000
065500     05  FILLER                          PIC  X(03)  VALUE SPACES.06550000
065600     05  TDL-MISSING-TICKET              PIC  ZZZ9.               06560000
065700     05  FILLER                          PIC  X(05)  VALUE SPACES.06570000
065800     05  TDL-WRONG-TICKET                PIC  ZZZ9.               06580000
065900     05  FILLER                          PIC  X(04)  VALUE SPACES.06590000
066000     05  TDL-WRONG-LABEL                 PIC  ZZZ9.               06600000
066100     05  FILLER                          PIC  X(04)  VALUE SPACES.06610000
066200     05  TDL-NO-BARCODE                  PIC  ZZZ9.               06620000
066300     05  FILLER                          PIC  X(05)  VALUE SPACES.06630000
066400     05  TDL-DAMAGED-BARCODE             PIC  ZZZ9.               06640000
066500     05  FILLER                          PIC  X(04)  VALUE SPACES.06650000
066600     05  TDL-WRONG-UPC                   PIC  ZZZ9.               06660000
066700     05  FILLER                          PIC  X(04)  VALUE SPACES.06670000
066800     05  TDL-NO-UPC                      PIC  ZZZ9.               06680000
066900     05  FILLER                          PIC  X(03)  VALUE SPACES.06690000
067000     05  TDL-TOTAL-ERRORS                PIC  ZZ,ZZ9.             06700000
067100     05  FILLER                          PIC  X(04)  VALUE SPACES.06710000
067200     05  TDL-TOTAL-UNITS-IN-ERROR        PIC  ZZ,ZZ9.             06720000
067300     05  FILLER                          PIC  X(04)  VALUE SPACES.06730000
067400     05  TDL-TOTAL-UNITS-TRNSCRBD        PIC  ZZZ,ZZ9.            06740000
067500     05  FILLER                          PIC  X(04)  VALUE SPACES.06750000
067600     05  TDL-TOTAL-UNITS-AUDITED         PIC  ZZZ,ZZ9.            06760000
067700     05  FILLER                          PIC  X(04)  VALUE SPACES.06770000
067800     05  TDL-ERROR-RATIO                 PIC  ZZ9.99.             06780000
067900     05  TDL-ERROR-RATIO-X  REDEFINES TDL-ERROR-RATIO             06790000
068000                                         PIC  X(06).              06800000
068100     05  TDL-PERCENT                     PIC  X(1)  VALUE '%'.    06810000
068110     05  FILLER                          PIC  X(01)  VALUE SPACES.06811074
068200                                                                  06820000
068300******************************************************************06830000
068600******************************************************************06860000
068700 01  TTL-TICKETING-TOTAL-LINE.                                    06870000
068800     05  TTL-TOTAL-DESCRIPTION           PIC  X(13).              06880000
068900     05  FILLER                          PIC  X(03)  VALUE SPACES.06890000
069000     05  TTL-SKU-COUNT                   PIC  ZZZ9.               06900000
069100     05  FILLER                          PIC  X(03)  VALUE SPACES.06910000
069200     05  TTL-MISSING-TICKET              PIC  ZZ,ZZ9.             06920000
069300     05  FILLER                          PIC  X(03)  VALUE SPACES.06930000
069400     05  TTL-WRONG-TICKET                PIC  ZZ,ZZ9.             06940000
069500     05  FILLER                          PIC  X(02)  VALUE SPACES.06950000
069600     05  TTL-WRONG-LABEL                 PIC  ZZ,ZZ9.             06960000
069700     05  FILLER                          PIC  X(02)  VALUE SPACES.06970000
069800     05  TTL-NO-BARCODE                  PIC  ZZ,ZZ9.             06980000
069900     05  FILLER                          PIC  X(03)  VALUE SPACES.06990000
070000     05  TTL-DAMAGED-BARCODE             PIC  ZZ,ZZ9.             07000000
070100     05  FILLER                          PIC  X(02)  VALUE SPACES.07010000
070200     05  TTL-WRONG-UPC                   PIC  ZZ,ZZ9.             07020000
070300     05  FILLER                          PIC  X(02)  VALUE SPACES.07030000
070400     05  TTL-NO-UPC                      PIC  ZZ,ZZ9.             07040000
070500     05  TTL-TOTAL-ERRORS                PIC  Z,ZZZ,ZZ9.          07050000
070600     05  FILLER                          PIC  X(01)  VALUE SPACES.07060000
070700     05  TTL-TOTAL-UNITS-IN-ERROR        PIC  Z,ZZZ,ZZ9.          07070000
070800     05  FILLER                          PIC  X(02)  VALUE SPACES.07080000
070900     05  TTL-TOTAL-UNITS-TRNSCRBD        PIC  Z,ZZZ,ZZ9.          07090000
071000     05  FILLER                          PIC  X(02)  VALUE SPACES.07100000
071100     05  TTL-TOTAL-UNITS-AUDITED         PIC  Z,ZZZ,ZZ9.          07110000
071200     05  FILLER                          PIC  X(04)  VALUE SPACES.07120000
071300     05  TTL-ERROR-RATIO                 PIC  ZZ9.99.             07130000
071400     05  TTL-ERROR-RATIO-X  REDEFINES TTL-ERROR-RATIO             07140000
071500                                         PIC  X(06).              07150000
071600     05  TTL-PERCENT                     PIC  X(1)  VALUE '%'.    07160000
071610     05  FILLER                          PIC  X(01)  VALUE SPACES.07161074
071700                                                                  07170000
071900******************************************************************07190000
072000*     DETAIL HEADINGS      DETAIL HEADINGS       DETAIL HEADINGS *07200000
072100******************************************************************07210000
072200******************************************************************07220000
072300 01  RDH1-RFID-DETAIL-HEADING-1.                                  07230000
072400     05  FILLER                          PIC  X(52)  VALUE SPACE. 07240000
072500     05  FILLER                          PIC  X(21)  VALUE        07250000
072600         'R F I D   E R R O R S'.                                 07260000
072700     05  FILLER                          PIC  X(59)  VALUE SPACE. 07270000
072800******************************************************************07280000
072900 01  RDH2-RFID-DETAIL-HEADING-2.                                  07290000
073000     05  FILLER                          PIC  X(02)  VALUE SPACE. 07300000
073100     05  FILLER                          PIC  X(07)  VALUE        07310000
073200         'DPT CL'.                                                07320000
073300     05  FILLER                          PIC  X(08)  VALUE        07330000
073400         'SKU NBRS'.                                              07340000
073500     05  FILLER                          PIC  X(02)  VALUE SPACE. 07350000
073600     05  FILLER                          PIC  X(03)  VALUE        07360000
073700         'LNE'.                                                   07370000
073800     05  FILLER                          PIC  X(02)  VALUE SPACE. 07380000
073900     05  FILLER                          PIC  X(05)  VALUE        07390000
074000         ' UPC '.                                                 07400000
074100     05  FILLER                          PIC  X(04)  VALUE SPACES.07410000
074200     05  FILLER                          PIC  X(05)  VALUE        07420000
074300         'WRONG'.                                                 07430000
074400     05  FILLER                          PIC  X(02)  VALUE SPACES.07440000
074500     05  FILLER                          PIC  X(05)  VALUE        07450000
074600         'WRONG'.                                                 07460000
074700     05  FILLER                          PIC  X(02)  VALUE SPACES.07470000
074800     05  FILLER                          PIC  X(05)  VALUE        07480000
074900         'WRONG'.                                                 07490000
075000     05  FILLER                          PIC  X(02)  VALUE SPACES.07500000
075100     05  FILLER                          PIC  X(07)  VALUE        07510000
075200         'NO RFID'.                                               07520000
075300     05  FILLER                          PIC  X(23)  VALUE SPACES.07530000
075400     05  FILLER                          PIC  X(05)  VALUE        07540000
075500         'TOTAL'.                                                 07550000
075600     05  FILLER                          PIC  X(01)  VALUE SPACES.07560000
075700     05  FILLER                          PIC  X(09)  VALUE        07570000
075800         'TOT UNITS'.                                             07580000
075900     05  FILLER                          PIC  X(03)  VALUE SPACES.07590000
076000     05  FILLER                          PIC  X(09)  VALUE        07600000
076100         'TOT UNITS'.                                             07610000
076200     05  FILLER                          PIC  X(03)  VALUE SPACES.07620000
076300     05  FILLER                          PIC  X(09)  VALUE        07630000
076400         'TOT UNITS'.                                             07640000
076500     05  FILLER                          PIC  X(04)  VALUE SPACES.07650000
076600     05  FILLER                          PIC  X(05)  VALUE        07660000
076700         'ERROR'.                                                 07670000
077400                                                                  07740000
077500******************************************************************07750000
077600 01  RDH3-RFID-DETAIL-HEADING-3.                                  07760000
077700     05  FILLER                          PIC  X(07)  VALUE SPACE. 07770000
077800     05  FILLER                          PIC  X(08)  VALUE        07780000
077900         'W/ERRORS'.                                              07790000
078000     05  FILLER                          PIC  X(04)  VALUE SPACE. 07800000
078100     05  FILLER                          PIC  X(03)  VALUE        07810000
078200         'NBR'.                                                   07820000
078300     05  FILLER                          PIC  X(01)  VALUE SPACE. 07830000
078400     05  FILLER                          PIC  X(08)  VALUE        07840000
078500         ' MISPACK'.                                              07850000
078600     05  FILLER                          PIC  X(02)  VALUE SPACES.07860000
078700     05  FILLER                          PIC  X(05)  VALUE        07870000
078800         'COLOR'.                                                 07880000
078900     05  FILLER                          PIC  X(02)  VALUE SPACES.07890000
079000     05  FILLER                          PIC  X(04)  VALUE        07900000
079100         'SIZE'.                                                  07910000
079200     05  FILLER                          PIC  X(03)  VALUE SPACES.07920000
079300     05  FILLER                          PIC  X(05)  VALUE        07930000
079400         'STYLE'.                                                 07940000
079500     05  FILLER                          PIC  X(02)  VALUE SPACES.07950000
079600     05  FILLER                          PIC  X(06)  VALUE        07960000
079700         'TICKET'.                                                07970000
079800     05  FILLER                          PIC  X(23)  VALUE SPACES.07980000
079900     05  FILLER                          PIC  X(06)  VALUE        07990000
080000         'ERRORS'.                                                08000000
080100     05  FILLER                          PIC  X(02)  VALUE SPACES.08010000
080200     05  FILLER                          PIC  X(08)  VALUE        08020000
080300         'IN ERROR'.                                              08030000
080400     05  FILLER                          PIC  X(03)  VALUE SPACES.08040000
080500     05  FILLER                          PIC  X(09)  VALUE        08050000
080600         'TRANSCRIB'.                                             08060000
080700     05  FILLER                          PIC  X(04)  VALUE SPACES.08070000
080800     05  FILLER                          PIC  X(07)  VALUE        08080000
080900         'AUDITED'.                                               08090000
081000     05  FILLER                          PIC  X(05)  VALUE SPACES.08100000
081100     05  FILLER                          PIC  X(05)  VALUE        08110000
081200         'RATIO'.                                                 08120000
081900                                                                  08190000
082000******************************************************************08200000
082100 01  RDL-RFID-DETAIL-LINE.                                        08210000
082200     05  FILLER                          PIC  X(01)  VALUE SPACES.08220000
082300     05  RDL-SKU-DEPT                    PIC  X(03).              08230000
082400     05  FILLER                          PIC  X      VALUE SPACE. 08240000
082500     05  RDL-SKU-CLASS                   PIC  X(02).              08250000
082600     05  FILLER                          PIC  X      VALUE SPACE. 08260000
082700     05  RDL-SKU-NBR                     PIC  X(08).              08270000
082800     05  FILLER                          PIC  X(02)  VALUE SPACES.08280000
082900     05  RDL-LINE-NBR                    PIC  ZZZ9.               08290000
083000     05  RDL-LINE-NBR-X REDEFINES                                 08300000
083100         RDL-LINE-NBR                    PIC  X(04).              08310000
083200     05  FILLER                          PIC  X(05)  VALUE SPACES.08320000
083300     05  RDL-WRONG-EPC-LOGO              PIC  ZZZ9.               08330000
083400     05  FILLER                          PIC  X(03)  VALUE SPACES.08340000
083500     05  RDL-WRONG-COLOR                 PIC  ZZZ9.               08350000
083600     05  FILLER                          PIC  X(03)  VALUE SPACES.08360000
083700     05  RDL-WRONG-SIZE                  PIC  ZZZ9.               08370000
083800     05  FILLER                          PIC  X(03)  VALUE SPACES.08380000
083900     05  RDL-WRONG-STYLE                 PIC  ZZZ9.               08390000
084000     05  FILLER                          PIC  X(05)  VALUE SPACES.08400000
084100     05  RDL-NO-RFID-TICKET              PIC  ZZZ9.               08410000
084200     05  FILLER                          PIC  X(22)  VALUE SPACES.08420000
084800     05  RDL-TOTAL-ERRORS                PIC  ZZ,ZZ9.             08480000
084900     05  FILLER                          PIC  X(04)  VALUE SPACES.08490000
085000     05  RDL-TOTAL-UNITS-IN-ERROR        PIC  ZZ,ZZ9.             08500000
085100     05  FILLER                          PIC  X(04)  VALUE SPACES.08510000
085200     05  RDL-TOTAL-UNITS-TRNSCRBD        PIC  ZZZ,ZZ9.            08520000
085300     05  FILLER                          PIC  X(04)  VALUE SPACES.08530000
085400     05  RDL-TOTAL-UNITS-AUDITED         PIC  ZZZ,ZZ9.            08540000
085500     05  FILLER                          PIC  X(04)  VALUE SPACES.08550000
085600     05  RDL-ERROR-RATIO                 PIC  ZZ9.99.             08560000
085700     05  RDL-ERROR-RATIO-X  REDEFINES RDL-ERROR-RATIO             08570000
085800                                         PIC  X(06).              08580000
085900     05  RDL-PERCENT                     PIC  X(1)  VALUE '%'.    08590000
086000                                                                  08600000
086100******************************************************************08610000
086200 01  RTL-RFID-TOTAL-LINE.                                         08620000
086300     05  RTL-TOTAL-DESCRIPTION           PIC  X(13).              08630000
086400     05  FILLER                          PIC  X(05)  VALUE SPACES.08640000
086500     05  RTL-SKU-COUNT                   PIC  ZZZ9.               08650000
086600     05  FILLER                          PIC  X(03)  VALUE SPACES.08660000
086700     05  RTL-WRONG-EPC-LOGO              PIC  ZZ,ZZ9.             08670000
086800     05  FILLER                          PIC  X(01)  VALUE SPACES.08680000
086900     05  RTL-WRONG-COLOR                 PIC  ZZ,ZZ9.             08690000
087000     05  FILLER                          PIC  X(01)  VALUE SPACES.08700000
087100     05  RTL-WRONG-SIZE                  PIC  ZZ,ZZ9.             08710000
087200     05  FILLER                          PIC  X(01)  VALUE SPACES.08720000
087300     05  RTL-WRONG-STYLE                 PIC  ZZ,ZZ9.             08730000
087400     05  FILLER                          PIC  X(03)  VALUE SPACES.08740000
087500     05  RTL-NO-RFID-TICKET              PIC  ZZ,ZZ9.             08750000
087600     05  FILLER                          PIC  X(19)  VALUE SPACES.08760000
088100     05  RTL-TOTAL-ERRORS                PIC  Z,ZZZ,ZZ9.          08810000
088200     05  FILLER                          PIC  X(01)  VALUE SPACES.08820000
088300     05  RTL-TOTAL-UNITS-IN-ERROR        PIC  Z,ZZZ,ZZ9.          08830000
088400     05  FILLER                          PIC  X(02)  VALUE SPACES.08840000
088500     05  RTL-TOTAL-UNITS-TRNSCRBD        PIC  Z,ZZZ,ZZ9.          08850000
088600     05  FILLER                          PIC  X(02)  VALUE SPACES.08860000
088700     05  RTL-TOTAL-UNITS-AUDITED         PIC  Z,ZZZ,ZZ9.          08870000
088800     05  FILLER                          PIC  X(04)  VALUE SPACES.08880000
088900     05  RTL-ERROR-RATIO                 PIC  ZZ9.99.             08890000
089000     05  RTL-ERROR-RATIO-X  REDEFINES RTL-ERROR-RATIO             08900000
089100                                         PIC  X(06).              08910000
089200     05  RTL-PERCENT                     PIC  X(1)  VALUE '%'.    08920000
089400                                                                  08940000
089500******************************************************************08950000
089600*     TOTAL FOOTERS        TOTAL FOOTERS         TOTAL FOOTERS   *08960000
089700******************************************************************08970000
089800******************************************************************08980000
089900 01  TRL-TOTAL-RATIO-LINE.                                        08990000
090000     05  TRL-TOTAL-RATIO-DESC            PIC  X(31).              09000000
090100     05  TRL-TOTAL-RATIO                 PIC  ZZ9.99.             09010000
090200     05  FILLER                          PIC  X(01)  VALUE '%'.   09020000
090210     05  FILLER                          PIC  X(94)  VALUE SPACES.09021075
090300                                                                  09030000
090400******************************************************************09040000
090500 01  ARL1-AUDITING-REQUIRED-LINE-1.                               09050000
090600     05  FILLER                          PIC X(132) VALUE ALL '*'.09060000
090700******************************************************************09070000
090800 01  ARL2-AUDITING-REQUIRED-LINE-2.                               09080000
090900     05  FILLER                          PIC X(043) VALUE ALL '*'.09090000
091000     05  FILLER                          PIC X(045) VALUE         09100000
091100         '   AUDITING REQUIRED ON ADDITIONAL CARTONS   '.         09110000
091200     05  FILLER                          PIC X(044) VALUE ALL '*'.09120000
091300                                                                  09130000
091400******************************************************************09140000
091500 01  AS1-AUDITED-STORES-1.                                        09150000
091600     05  AS1-AUDITED-STORE-DESC          PIC  X(16) VALUE SPACES. 09160000
091700     05  AS1-AUDITED-STORES-TABLE.                                09170000
091800       07 FILLER  OCCURS 20 TIMES                                 09180000
091900                  INDEXED BY AS1-AUD-STR-IDX.                     09190000
092000         10 AS1-STR-NBR                  PIC  X(03) VALUE SPACE.  09200000
092100         10 AS1-COMMA                    PIC  X(01) VALUE SPACE.  09210000
092200         10 FILLER                       PIC  X(01) VALUE SPACE.  09220000
092300******************************************************************09230000
092400 01  PV-AUDITED-STORES.                                           09240000
092504                                                                  09250480
092510     05  PV-MAX-STORES                   PIC S9(04) COMP          09251080
092600                                                    VALUE +200.   09260000
092700     05  PV-STR-COUNT                    PIC S9(04) COMP.         09270000
092800     05  PV-STR-REMAINDER                PIC S9(04) COMP.         09280000
092900     05  PV-STR-LINES                    PIC S9(04) COMP.         09290000
093000     05  PV-AUDITED-STORES-TABLE.                                 09300000
093100       07  FILLER  OCCURS 200 TIMES                               09310000
093200                  INDEXED BY PV-AUD-STR-IDX.                      09320000
093300         10  PV-STR-NBR                  PIC  9(03) VALUE 0.      09330000
093400******************************************************************09340000
093500                                                                  09350000
093600                                                                  09360000
093700 01  BLANK-LINE.                                                  09370000
093800     05  FILLER                          PIC  X(132) VALUE SPACE. 09380000
093900                                                                  09390000
094000                                                                  09400000
094100 01  END-OF-REPORT-LINE.                                          09410000
094200     05  FILLER                          PIC  X(54)  VALUE SPACE. 09420074
094300     05  FILLER                          PIC  X(25)  VALUE        09430000
094400         '***** END OF REPORT *****'.                             09440000
094500     05  FILLER                          PIC  X(53)  VALUE SPACE. 09450074
094600                                                                  09460000
095000 01  RE-REPORT-ERROR-1.                                           09500000
095100     05  FILLER                  PIC  X(07)  VALUE ' AUDIT:'.     09510000
095200     05  RE-AUD-CNTL-NBR         PIC  9(09)  VALUE ZERO.          09520000
095300     05  FILLER                  PIC  X(03)  VALUE SPACE.         09530000
095400     05  FILLER                  PIC  X(08)  VALUE 'PO-RCVR:'.    09540000
095500     05  RE-PO                   PIC  9(08)  VALUE ZERO.          09550000
095600     05  FILLER                  PIC  X(01)  VALUE '-'.           09560000
095700     05  RE-RCVR                 PIC  9(04)  VALUE ZERO.          09570000
095800     05  FILLER                  PIC  X(05)  VALUE SPACE.         09580000
095900     05  FILLER                  PIC  X(53)  VALUE                09590000
096000         '**** RECEIVER DOES NOT EXIST - PLEASE TRANSCRIBE ****'. 09600000
096100     05  FILLER                          PIC  X(34)  VALUE SPACE. 09610000
096500                                                                  09650000
096600 01  NO-DATA-LINE.                                                09660000
096700     05  FILLER                          PIC  X(49)  VALUE SPACE. 09670074
096800     05  FILLER                          PIC  X(35)  VALUE        09680000
096900         '********* NO DATA TO REPORT *******'.                   09690000
097000     05  FILLER                          PIC  X(48)  VALUE SPACE. 09700074
097100                                                                  09710000
097200                                                                  09720000
097800 01  DK-DB2-KEY-VALUE.                                            09780000
097900     05  DK-OPER-UNT-ID                  PIC S9(04) COMP.         09790000
098000     05  DK-AUD-CNTL-NBR                 PIC S9(09) COMP.         09800000
098100     05  DK-PO-NBR                       PIC S9(09) COMP.         09810000
098200     05  DK-REC-SEQ-NBR                  PIC S9(09) COMP.         09820000
098600                                                                  09860000
098700 01  PA-PROGRAM-ACCUMULATORS.                                     09870000
098800     05  PA-RECEIVER-ACCUM.                                       09880000
098900         10 PA-VENDOR-OVER             PIC  S9(5) COMP-3.         09890000
099000         10 PA-VENDOR-SHORT            PIC  S9(5) COMP-3.         09900000
099100         10 PA-RECEIVER-OVER           PIC  S9(5) COMP-3.         09910000
099200         10 PA-RECEIVER-SHORT          PIC  S9(5) COMP-3.         09920000
099300         10 PA-STYLE-SUB               PIC  S9(5) COMP-3.         09930000
099400         10 PA-DAMAGED-UNITS           PIC  S9(5) COMP-3.         09940000
099500         10 PA-MISSING-TICKET          PIC  S9(5) COMP-3.         09950000
099600         10 PA-WRONG-TICKET            PIC  S9(5) COMP-3.         09960000
099700         10 PA-WRONG-LABEL             PIC  S9(5) COMP-3.         09970000
099800         10 PA-NO-BARCODE              PIC  S9(5) COMP-3.         09980000
099900         10 PA-DAMAGED-BARCODE         PIC  S9(5) COMP-3.         09990000
100000         10 PA-WRONG-UPC               PIC  S9(5) COMP-3.         10000000
100100         10 PA-NO-UPC                  PIC  S9(5) COMP-3.         10010000
100200         10 PA-NET-UNTS-IN-ERROR       PIC  S9(7) COMP-3.         10020000
100400         10 PA-WRONG-EPC-LOGO          PIC  S9(5) COMP-3.         10040000
100500         10 PA-WRONG-COLOR             PIC  S9(5) COMP-3.         10050000
100600         10 PA-WRONG-SIZE              PIC  S9(5) COMP-3.         10060000
100700         10 PA-WRONG-STYLE             PIC  S9(5) COMP-3.         10070000
100800         10 PA-NO-RFID-TICKET          PIC  S9(5) COMP-3.         10080000
101000                                                                  10100000
101100*         PICKING TOTAL FIELDS                                    10110000
101200         10 PA-TOT-ERRS-PIC            PIC  S9(7) COMP-3.         10120000
101300         10 PA-TOT-UNTS-IN-ERR-PIC     PIC  S9(7) COMP-3.         10130000
101400         10 PA-SKUS-W-ERRS-PIC         PIC  S9(5) COMP-3.         10140000
101500         10 PA-SKUS-W-NO-ERRS-PIC      PIC  S9(5) COMP-3.         10150000
101600         10 PA-SKU-COUNT-PIC           PIC  S9(5) COMP-3.         10160000
101700         10 PA-UNTS-TRNS-PIC           PIC  S9(7) COMP-3.         10170000
101800         10 PA-UNTS-AUD-PIC            PIC  S9(7) COMP-3.         10180000
101900         10 PA-TOT-UNTS-TRNS-IE-PIC    PIC  S9(7) COMP-3.         10190000
102000         10 PA-TOT-UNTS-AUD-IE-PIC     PIC  S9(7) COMP-3.         10200000
102100         10 PA-TOT-UNTS-TRNS-NE-PIC    PIC  S9(7) COMP-3.         10210000
102200         10 PA-TOT-UNTS-AUD-NE-PIC     PIC  S9(7) COMP-3.         10220000
102300                                                                  10230000
102400*        TICKETING TOTAL FIELDS                                   10240000
102500         10 PA-TOT-ERRS-TIC            PIC  S9(7) COMP-3.         10250000
102600         10 PA-TOT-UNTS-IN-ERR-TIC     PIC  S9(7) COMP-3.         10260000
102700         10 PA-SKUS-W-ERRS-TIC         PIC  S9(5) COMP-3.         10270000
102800         10 PA-SKUS-W-NO-ERRS-TIC      PIC  S9(5) COMP-3.         10280000
102900         10 PA-SKU-COUNT-TIC           PIC  S9(5) COMP-3.         10290000
103000         10 PA-UNTS-TRNS-TIC           PIC  S9(7) COMP-3.         10300000
103100         10 PA-UNTS-AUD-TIC            PIC  S9(7) COMP-3.         10310000
103200         10 PA-TOT-UNTS-TRNS-IE-TIC    PIC  S9(7) COMP-3.         10320000
103300         10 PA-TOT-UNTS-AUD-IE-TIC     PIC  S9(7) COMP-3.         10330000
103400         10 PA-TOT-UNTS-TRNS-NE-TIC    PIC  S9(7) COMP-3.         10340000
103500         10 PA-TOT-UNTS-AUD-NE-TIC     PIC  S9(7) COMP-3.         10350000
103600                                                                  10360000
103800*        RFID TOTAL FIELDS                                        10380000
103900         10 PA-TOT-ERRS-RFID           PIC  S9(7) COMP-3.         10390000
104000         10 PA-TOT-UNTS-IN-ERR-RFID    PIC  S9(7) COMP-3.         10400000
104100         10 PA-SKUS-W-ERRS-RFID        PIC  S9(5) COMP-3.         10410000
104200         10 PA-SKUS-W-NO-ERRS-RFID     PIC  S9(5) COMP-3.         10420000
104300         10 PA-SKU-COUNT-RFID          PIC  S9(5) COMP-3.         10430000
104400         10 PA-UNTS-TRNS-RFID          PIC  S9(7) COMP-3.         10440000
104500         10 PA-UNTS-AUD-RFID           PIC  S9(7) COMP-3.         10450000
104600         10 PA-TOT-UNTS-TRNS-IE-RFID   PIC  S9(7) COMP-3.         10460000
104700         10 PA-TOT-UNTS-AUD-IE-RFID    PIC  S9(7) COMP-3.         10470000
104800         10 PA-TOT-UNTS-TRNS-NE-RFID   PIC  S9(7) COMP-3.         10480000
104900         10 PA-TOT-UNTS-AUD-NE-RFID    PIC  S9(7) COMP-3.         10490000
105000         10 PA-TOT-UNTS-AUDITED-RFID   PIC  S9(7) COMP-3.         10500000
105200                                                                  10520000
105300                                                                  10530000
105400 01  PC-CONSTANTS.                                                10540000
105500     05  PC-MAX-STRS-PER-LINE            PIC S9(04) COMP          10550000
105600                                                    VALUE +20.    10560000
105700     05  PC-MAX-REPORT-LINES             PIC S9(04)  VALUE +60    10570000
105800                                                     COMP SYNC.   10580000
105900     05  PC-ZERO                         PIC  9(01)  VALUE 0.     10590000
106000     05  PC-ONE                          PIC  9(01)  VALUE 1.     10600000
106100     05  PC-TWO                          PIC  9(01)  VALUE 2.     10610000
106200     05  PC-THREE                        PIC  9(01)  VALUE 3.     10620000
106300     05  PC-FOUR                         PIC  9(01)  VALUE 4.     10630000
106400     05  PC-EIGHT                        PIC  9(01)  VALUE 8.     10640000
106500     05  PC-NINE                         PIC  9(01)  VALUE 9.     10650000
106600     05  PC-E                            PIC  X(01)  VALUE 'E'.   10660000
106700     05  PC-KOHLS-OPERATING-COMPANY      PIC  X(02)  VALUE '03'.  10670000
106800     05  PC-NINES-TIMESTAMP              PIC  X(26)  VALUE        10680000
106900         '9999-09-09-09.09.09.999999'.                            10690000
107000     05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        10700000
107100         'SUKRP010'.                                              10710000
107200     05  PC-CURRENT-JOB-NAME             PIC  X(08)  VALUE        10720000
107300         'SUK905  '.                                              10730000
107400                                                                  10740000
107500 01  CC-CONTROL-CARD.                                             10750000
107600     05  CC-PRINTER-ID                PIC  X(08)  VALUE SPACES.   10760000
107610         88 CC-FLAT-FILE                          VALUE 'FILE'.   10761092
107700     05  CC-PRTR-CNTL-IND             PIC  X(01)  VALUE SPACE.    10770000
107800     05  CC-TRACK-NBR                 PIC  9(01)  VALUE ZERO.     10780000
108000     05  CC-BRCDE-IND                 PIC  X(01)  VALUE SPACE.    10800000
108100     05  CC-PRTR-CUT-IND              PIC  X(01)  VALUE SPACE.    10810000
108110*                                                                 10811096
108120     05  CC-CNTL-CARD-OPER            PIC  9(04)  VALUE ZEROES.   10812096
108130     05  CC-CNTL-CARD-USERID          PIC  X(08)  VALUE SPACES.   10813096
108140     05  CC-CNTL-CARD-AUD-NBR         PIC  9(09)  VALUE ZEROES.   10814096
108150     05  FILLER                       PIC  X(47)  VALUE SPACES.   10815096
108200                                                                  10820000
108300 01  PS-PROGRAM-SWITCHES.                                         10830000
108400     05  PS-EOF-AUD-STR-CURSOR-IND       PIC  X(01)  VALUE 'N'.   10840000
108500         88  PS-EOF-AUD-STR-CURSOR                   VALUE 'Y'.   10850000
108600         88  PS-NOT-EOF-AUD-STR-CURSOR               VALUE 'N'.   10860000
108700     05  PS-DATA-IND                     PIC  X(01)  VALUE 'N'.   10870000
108800         88  PS-DATA                                 VALUE 'Y'.   10880000
108900         88  PS-NO-DATA                              VALUE 'N'.   10890000
109000     05  PS-EOF-AUDIT-SUM-EXTRACT-IND    PIC  X(01)  VALUE 'N'.   10900000
109100         88  PS-EOF-AUDIT-SUM-EXTRACT                VALUE 'Y'.   10910000
109200         88  PS-NOT-EOF-AUDIT-SUM-EXTRACT            VALUE 'N'.   10920000
109300     05  PS-EOF-RECEIVER-CURSOR-IND      PIC  X(01)  VALUE 'N'.   10930000
109400         88  PS-EOF-RECEIVER-CURSOR                  VALUE 'Y'.   10940000
109500         88  PS-NOT-EOF-RECEIVER-CURSOR              VALUE 'N'.   10950000
109600     05  PS-EOF-UID-CURSOR-IND           PIC  X(01)  VALUE 'N'.   10960000
109700         88  PS-EOF-UID-CURSOR                       VALUE 'Y'.   10970000
109800         88  PS-NOT-EOF-UID-CURSOR                   VALUE 'N'.   10980000
109900     05  PS-PRINT-PICK-HEADING-IND       PIC  X(01)  VALUE 'N'.   10990000
110000         88  PS-PRINT-PICK-HEADING                   VALUE 'Y'.   11000000
110100         88  PS-DONT-PRINT-PICK-HEADING              VALUE 'N'.   11010000
110200     05  PS-PRINT-TICK-HEADING-IND       PIC  X(01)  VALUE 'N'.   11020000
110300         88  PS-PRINT-TICK-HEADING                   VALUE 'Y'.   11030000
110400         88  PS-DONT-PRINT-TICK-HEADING              VALUE 'N'.   11040000
110600     05  PS-PRINT-RFID-HEADING-IND       PIC  X(01)  VALUE 'N'.   11060000
110700         88  PS-PRINT-RFID-HEADING                   VALUE 'Y'.   11070000
110800         88  PS-DONT-PRINT-RFID-HEADING              VALUE 'N'.   11080000
111000     05  PS-PRINT-DETAIL-IND             PIC  X(01)  VALUE 'N'.   11100000
111100         88  PS-PRINT-DETAIL                         VALUE 'Y'.   11110000
111200         88  PS-DONT-PRINT-DETAIL                    VALUE 'N'.   11120000
111220     05  PS-PO-EXCEPTION-SW              PIC  X(01)  VALUE SPACE. 11122000
111230         88 PS-PO-EXCEPTION              VALUE 'Y'.               11123000
111240         88 PS-NO-PO-EXCEPTION           VALUE 'N'.               11124000
111250     05  PS-VENDOR-RFID-AGRMNT-SW        PIC  X(01)  VALUE SPACE. 11125000
111260         88 PS-VENDOR-TAGGING            VALUE 'T'.               11126000
111270         88 PS-VENDOR-COMPLIANT          VALUE 'C'.               11127000
111280         88 PS-VENDOR-NOT-TAGGING        VALUE 'N'.               11128000
111292     05  PS-DEPT-RFID-TAGGING-SW         PIC  X(01)  VALUE SPACE. 11129200
111293         88 PS-DEPT-TAGGING              VALUE 'Y'.               11129300
111294         88 PS-DEPT-NOT-TAGGING          VALUE 'N'.               11129400
111300                                                                  11130000
111400 01  PV-PROGRAM-VARIABLES.                                        11140000
111500     05  PV-SPOT-PERCENT                 PIC S9(3)V9(4) COMP.     11150000
111600     05  PV-ERROR-RATIO                  PIC S9(3)V9(4) COMP.     11160000
111700     05  PV-MIN-CARTONS                  PIC S9(09)  VALUE ZERO   11170000
111800                                                     COMP.        11180000
111900     05  PV-CARTONS-LEFT                 PIC S9(09)  VALUE ZERO   11190000
112000                                                     COMP.        11200000
112100     05  PV-OPER-UNT-ID                  PIC  9(03).              11210000
112200     05  PV-HOLD-PO-NBR                  PIC S9(09)  VALUE ZERO   11220000
112300                                                     COMP.        11230000
112400     05  PV-HOLD-REC-SEQ-NBR             PIC S9(09)  VALUE ZERO   11240000
112500                                                     COMP.        11250000
112600     05  PV-VENDOR-NAME                  PIC  X(19)  VALUE SPACES.11260000
112700     05  PV-HOLD-UID                     PIC  X(07)  VALUE SPACES.11270000
112800     05  PV-HOUR-COUNT                   PIC S9(09)  VALUE ZERO   11280000
112900                                                     COMP.        11290000
113000     05  PV-DAY-COUNT                    PIC S9(09)  VALUE ZERO   11300000
113100                                                     COMP.        11310000
113200     05  PV-MINUTE-COUNT                 PIC S9(09)  VALUE ZERO   11320000
113300                                                     COMP.        11330000
113400     05  PV-RECEIPT-DATE                 PIC  X(10)  VALUE SPACES.11340000
113500     05  PV-UNITS-TRNSCRBD               PIC S9(09)  VALUE ZERO   11350000
113600                                                     COMP.        11360000
113700     05  PV-AUDIT-CARTON-COUNT           PIC S9(09)  VALUE ZERO   11370000
113800                                                     COMP.        11380000
113900     05  PV-AUDIT-UNIT-COUNT             PIC S9(09)  VALUE ZERO   11390000
114000                                                     COMP.        11400000
114200     05  PV-AUDIT-UNIT-COUNT-RFID        PIC S9(09)  VALUE ZERO   11420000
114300                                                     COMP.        11430000
114310     05  PV-AUDIT-NOT-TAGGED-RFID        PIC S9(09)  VALUE ZERO   11431000
114320                                                     COMP.        11432000
114500     05  PV-DURATION-TOTAL               PIC S9(09)  VALUE +0     11450000
114600                                                     COMP.        11460000
114700     05  PV-DURATION-HOURS               PIC S9(09)  VALUE +0     11470000
114800                                                     COMP.        11480000
114900     05  PV-DURATION-MINUTES             PIC S9(09)  VALUE +0     11490000
115000                                                     COMP.        11500000
115100     05  PV-TIMESTAMP.                                            11510000
115200         10 PV-TIMESTAMP-DATE            PIC  X(10)  VALUE SPACES.11520000
115300         10 FILLER                       PIC  X(01)  VALUE SPACES.11530000
115400         10 PV-TIMESTAMP-TIME            PIC  X(08)  VALUE SPACES.11540000
115500         10 FILLER                       PIC  X(07)  VALUE SPACES.11550000
115600     05  PV-CURR-TMST                    PIC  X(26)  VALUE SPACES.11560000
115700     05  PV-CURR-DEPT                    PIC  X(03)  VALUE SPACES.11570000
115800     05  PV-PREV-DEPT                    PIC  X(03)  VALUE SPACES.11580000
115900     05  PV-FIELD-NAME                   PIC  X(30)  VALUE SPACES.11590000
116000     05  PV-COMMIT-TMST                  PIC  X(26)  VALUE SPACES.11600000
116100     05  PV-SORT-RETURN              PIC  9(02)      VALUE ZERO.  11610000
116200     05  PV-DETAIL-PAGE-COUNT            PIC S9(04)  VALUE +0     11620000
116300                                                     COMP SYNC.   11630000
116400     05  PV-DETAIL-LINE-COUNT            PIC S9(04)  VALUE +0     11640000
116500                                                     COMP SYNC.   11650000
116600     05  PV-SUM-PAGE-COUNT               PIC S9(04)  VALUE +0     11660000
116700                                                     COMP SYNC.   11670000
116800     05  PV-SUM-LINE-COUNT               PIC S9(04)  VALUE +0     11680000
116900                                                     COMP SYNC.   11690000
117000     05  PV-ADVANCE-COUNT                PIC S9(04)  VALUE +0     11700000
117100                                                     COMP SYNC.   11710000
117200     05  PV-TOTAL-APPROVED-DOLLARS       PIC S9(09)V9(02)         11720000
117300                                                     VALUE +0     11730000
117400                                                     COMP-3.      11740000
117500     05  PV-TOTAL-DECLINED-DOLLARS       PIC S9(09)V9(02)         11750000
117600                                                     VALUE +0     11760000
117700                                                     COMP-3.      11770000
117800     05  PV-TOTAL-APPROVED-REFERRALS     PIC  9(09)  VALUE ZEROS  11780000
117900                                                     COMP-3.      11790000
118000     05  PV-TOTAL-DECLINED-REFERRALS     PIC  9(09)  VALUE ZEROS  11800000
118100                                                     COMP-3.      11810000
118200     05  PV-DOLLARS                      PIC  9(04)V9(02)         11820000
118300                                                     VALUE ZEROS. 11830000
118400                                                                  11840000
118500     05  PV-PARAGRAPH-NAME               PIC  X(30)  VALUE SPACE. 11850000
118600     05  PV-DB2-OPERATION-ATTEMPTED      PIC  X(30)  VALUE SPACE. 11860000
118700     05  PV-DB2-OPER-UNT-ID              PIC  X(03).              11870000
118800     05  PV-DB2-CURR-TIMESTAMP           PIC  X(26).              11880000
118900     05  PV-CURR-TIMESTAMP.                                       11890000
119000         10  PV-CURR-DATE.                                        11900000
119100             15  PV-CURR-CC              PIC  X(02).              11910000
119200             15  PV-CURR-YY              PIC  X(02).              11920000
119300             15  FILLER                  PIC  X.                  11930000
119400             15  PV-CURR-MM              PIC  X(02).              11940000
119500             15  FILLER                  PIC  X.                  11950000
119600             15  PV-CURR-DD              PIC  X(02).              11960000
119700         10  FILLER                      PIC  X(01).              11970000
119800         10  PV-CURR-TIME.                                        11980000
119900             15  PV-CURR-HH              PIC  X(02).              11990000
120000             15  FILLER                  PIC  X.                  12000000
120100             15  PV-CURR-MIN             PIC  X(02).              12010000
120200             15  FILLER                  PIC  X.                  12020000
120300             15  PV-CURR-SS              PIC  X(02).              12030000
120400         10  FILLER                      PIC  X(07).              12040000
120500     05  PV-WORK-DATE.                                            12050000
120600         10  PV-WORK-MONTH               PIC  9(02).              12060000
120700         10  FILLER                      PIC  X(01) VALUE '/'.    12070000
120800         10  PV-WORK-DAY                 PIC  9(02).              12080000
120900         10  FILLER                      PIC  X(01) VALUE '/'.    12090000
121000         10  PV-WORK-YEAR                PIC  9(02).              12100000
121100     05  PV-AUDIT-TYPE                   PIC  X(02)  VALUE SPACE. 12110000
121200         88  PV-100-AUDIT-CHECK          VALUE '01'.              12120000
121300         88  PV-SPOT-AUDIT-CHECK         VALUE '02'.              12130000
121400         88  PV-REWORK-AUDIT-CHECK       VALUE '03'.              12140000
121500     05  PV-AUDIT-STATUS                 PIC  X(02)  VALUE SPACE. 12150000
121600         88  PV-AUDIT-INPROCESS          VALUE 'IP'.              12160000
121700         88  PV-AUDIT-COMPLETE           VALUE 'CM'.              12170000
121800         88  PV-AUDIT-POSTPONE           VALUE 'PP'.              12180000
121820     05  PV-COUNT                        PIC S9(04)  COMP.        12182000
121900                                                                  12190000
122000 01  DN-DB2-NULL-INDICATORS.                                      12200000
122100     05  DN-NOT-TRANS-ID              PIC S9(04) COMP VALUE +0.   12210000
122200*                                                                 12220000
122800******************************************************************12280000
122900*  WORK FIELDS FOR THE MBS SUBROUTINE                             12290000
123000******************************************************************12300000
123100     COPY DPWS003.                                                12310000
123200*                                                                 12320000
123300******************************************************************12330000
123400*  DB2 COMMUNICATION AREA.                                        12340000
123500******************************************************************12350000
123600     EXEC SQL                                                     12360000
123700          INCLUDE SQLCA                                           12370000
123800     END-EXEC.                                                    12380000
123900*                                                                 12390000
124000*                                                                 12400000
124100******************************************************************12410000
124200*  DB2 TABLE COBOL WORKING STORAGE AREA FOR THE SHIPPING UNIT     12420000
124300*  AUDIT TABLE (TSUNTRN)                                          12430000
124400******************************************************************12440000
124500     EXEC SQL                                                     12450000
124600          INCLUDE TSUATRN                                         12460000
124700     END-EXEC.                                                    12470000
124800*                                                                 12480000
124900*                                                                 12490000
125000******************************************************************12500000
125100*  DB2 TABLE COBOL WORKING STORAGE AREA FOR THE SHIPPING UNIT     12510000
125200*  AUDIT TABLE (TSUAUPC)                                          12520000
125300******************************************************************12530000
125400     EXEC SQL                                                     12540000
125500          INCLUDE TSUAUPC                                         12550000
125600     END-EXEC.                                                    12560000
125700*                                                                 12570000
125800*                                                                 12580000
125900******************************************************************12590000
126000*  DB2 TABLE COBOL WORKING STORAGE AREA FOR THE SHIPPING UNIT     12600000
126100*  AUDIT TABLE (TSUNAUD)                                          12610000
126200******************************************************************12620000
126300     EXEC SQL                                                     12630000
126400          INCLUDE TSUNAUD                                         12640000
126500     END-EXEC.                                                    12650000
126600*                                                                 12660000
126700*                                                                 12670000
126800******************************************************************12680000
126900*  DB2 TABLE COBOL WORKING STORAGE AREA FOR THE PURCHASE ORDER    12690000
127000*  ITEM TABLE (TPURITM)                                           12700000
127100******************************************************************12710000
127200     EXEC SQL                                                     12720000
127300          INCLUDE TPURITM                                         12730000
127400     END-EXEC.                                                    12740000
127500*                                                                 12750000
127600******************************************************************12760000
127700*  DB2 TABLE COBOL WORKING STORAGE AREA FOR THE COMPANY CONTROL   12770000
127800*  TABLE (TCOCNTL)                                                12780000
127900******************************************************************12790000
128000     EXEC SQL                                                     12800000
128100          INCLUDE TCOCNTL                                         12810000
128200     END-EXEC.                                                    12820000
128300*                                                                 12830000
128400*                                                                 12840000
128500******************************************************************12850000
128600*  DB2 TABLE COBOL WORKING STORAGE AREA FOR THE PURCHASE ORDER    12860000
128700*  HEADER TABLE (TPURCHS)                                         12870000
128800******************************************************************12880000
128900     EXEC SQL                                                     12890000
129000          INCLUDE TPURCHS                                         12900000
129100     END-EXEC.                                                    12910000
129200*                                                                 12920000
129300*                                                                 12930000
129400******************************************************************12940000
129500*  DB2 TABLE COBOL WORKING STORAGE AREA FOR THE EXTERNAL ENTERPRIS12950000
129600*  NAME TABLE (TENTNME)                                           12960000
129700******************************************************************12970000
129800     EXEC SQL                                                     12980000
129900          INCLUDE TENTNME                                         12990000
130000     END-EXEC.                                                    13000000
130100*                                                                 13010000
130200*                                                                 13020000
130300******************************************************************13030000
130400*  DB2 TABLE COBOL WORKING STORAGE AREA FOR THE RECEIVING TABLE   13040000
130500******************************************************************13050000
130600     EXEC SQL                                                     13060000
130700          INCLUDE TRECEIV                                         13070000
130800     END-EXEC.                                                    13080000
130900                                                                  13090000
131000******************************************************************13100000
131100*  DB2 TABLE COBOL WORKING STORAGE AREA                           13110000
131200******************************************************************13120000
131300     EXEC SQL                                                     13130000
131400          INCLUDE TRECDIS                                         13140000
131500     END-EXEC.                                                    13150000
131600                                                                  13160000
131610******************************************************************13161000
131620*  DB2 TABLE COBOL WORKING STORAGE AREA                           13162000
131630******************************************************************13163000
131640     EXEC SQL                                                     13164000
131650          INCLUDE TSUEXCP                                         13165000
131660     END-EXEC.                                                    13166000
131670                                                                  13167000
131690*----------------------------------------------------------------*13169000
131691*    DB2 DCLGEN FOR THE VENDOR PO AUDIT REQUEST TABLE             13169100
131692*    (SUT_PO_AUD_REQ)                                             13169200
131693*----------------------------------------------------------------*13169300
131694     EXEC SQL                                                     13169400
131695          INCLUDE SUT00015                                        13169500
131696     END-EXEC.                                                    13169600
131697                                                                  13169700
131698*----------------------------------------------------------------*13169800
131699*    DB2 DCLGEN FOR THE VENDOR PO AUDIT EXCEPTION TABLE           13169900
131700*    (SUT_PO_AUD_EXC)                                             13170000
131701*----------------------------------------------------------------*13170100
131702     EXEC SQL                                                     13170200
131703          INCLUDE SUT00014                                        13170300
131704     END-EXEC.                                                    13170400
131705                                                                  13170500
131706*----------------------------------------------------------------*13170600
131707*    DB2 DCLGEN FOR THE VENDOR AGREEMENT TABLE                    13170700
131708*    (TVNDAGR)                                                    13170800
131709*----------------------------------------------------------------*13170900
131710     EXEC SQL                                                     13171000
131711          INCLUDE TVNDAGR                                         13171100
131712     END-EXEC.                                                    13171200
131714                                                                  13171400
131716******************************************************************13171600
131717*    DB2 AREA FOR THE RIT_RFID_VRFN TABLE                       * 13171700
131718******************************************************************13171800
131719     EXEC SQL                                                     13171900
131720         INCLUDE RIT00000                                         13172000
131721     END-EXEC.                                                    13172100
131723                                                                  13172300
131730******************************************************************13173000
131800*   DB2 COMMUNICATIONS AREA2                                      13180000
131900******************************************************************13190000
132000     COPY SQLCA2.                                                 13200000
132100 EJECT                                                            13210000
132200                                                                  13220000
132300***************************************************************** 13230000
132400*    AUDIT ASSOCIATE USERID CURSOR -- THIS CURSOR WILL RETRIEVE   13240000
132500*  THE USERIDS OF ALL THE ASSOCIATES THAT WORKED ON THIS AUDIT    13250000
132600***************************************************************** 13260000
132700     EXEC SQL                                                     13270000
132800         DECLARE UID_CURSOR CURSOR FOR                            13280000
132900             SELECT                                               13290000
133000                     A.AUD_USR_ID                                 13300000
133100             FROM                                                 13310000
133200                    TSUNAUD A                                     13320000
133300             WHERE                                                13330000
133400                 A.AUD_CNTL_NBR = :DK-AUD-CNTL-NBR                13340000
133500         UNION ALL                                                13350000
133600             SELECT                                               13360000
133700                    DISTINCT( B.UNT_AUD_USR_ID)                   13370000
133800             FROM                                                 13380000
133900                    TSUATRN B                                     13390000
134000             WHERE                                                13400000
134100                 B.AUD_CNTL_NBR = :DK-AUD-CNTL-NBR                13410000
134200             AND B.TRN_NBR      = :DK-PO-NBR                      13420000
134300             AND B.REC_SEQ_NBR  = :DK-REC-SEQ-NBR                 13430000
134400         UNION ALL                                                13440000
134500             SELECT                                               13450000
134600                    DISTINCT( D.AUD_USR_ID  )                     13460000
134700             FROM                                                 13470000
134800                    TSUATRN C                                     13480000
134900                  , TSUAUPC D                                     13490000
135000             WHERE                                                13500000
135100                 C.AUD_CNTL_NBR = :DK-AUD-CNTL-NBR                13510000
135200             AND C.TRN_NBR      = :DK-PO-NBR                      13520000
135300             AND C.REC_SEQ_NBR  = :DK-REC-SEQ-NBR                 13530000
135400             AND C.AUD_CNTL_NBR = D.AUD_CNTL_NBR                  13540000
135500             AND C.SHIPT_UNT_ID = D.SHIPT_UNT_ID                  13550000
135600         ORDER BY 1                                               13560000
135700     END-EXEC.                                                    13570000
135800                                                                  13580000
135900***************************************************************** 13590000
136000*    AUDITED STORES CURSOR -- THIS CURSOR WILL RETRIEVE ALL THE   13600000
136100*  STORES THAT WERE AUDITED FOR THIS RECEIVER                     13610000
136200***************************************************************** 13620000
136300     EXEC SQL                                                     13630000
136400         DECLARE AUD_STR_CURSOR CURSOR FOR                        13640000
136500             SELECT                                               13650000
136600                     DISTINCT (B.DEST_OPER_UNT_ID)                13660000
136700             FROM                                                 13670000
136800                    TSUATRN B                                     13680000
136900             WHERE                                                13690000
137000                 B.AUD_CNTL_NBR = :DK-AUD-CNTL-NBR                13700000
137100             AND B.TRN_NBR      = :DK-PO-NBR                      13710000
137200             AND B.REC_SEQ_NBR  = :DK-REC-SEQ-NBR                 13720000
137300         ORDER BY 1                                               13730000
137400     END-EXEC.                                                    13740000
137500 EJECT                                                            13750000
137600                                                                  13760000
137700* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 13770000
137800 PROCEDURE DIVISION.                                              13780000
137900* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 13790000
138000                                                                  13800000
138100******************************************************************13810000
138200*  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM    13820000
138300******************************************************************13830000
138400 0000-PROGRAM-MAINLINE.                                           13840000
138500                                                                  13850000
138600     PERFORM 1000-INITIALIZE.                                     13860000
138700                                                                  13870000
138800     PERFORM 2000-CREATE-REPORT                                   13880000
138900         UNTIL PS-EOF-AUDIT-SUM-EXTRACT.                          13890000
139000                                                                  13900000
139100     PERFORM 9000-EOJ-ROUTINE.                                    13910000
139200     STOP RUN.                                                    13920000
139400                                                                  13940000
139500                                                                  13950000
139600******************************************************************13960000
139700*  1000-INITIALIZE                                                13970000
139800*       - ACCEPTS, EDITS, AND DISPLAYS THE CONTROL CARD.          13980000
139900*       - OPEN ALL INPUT/OUTPUT FILES                             13990000
140000*       - SELECT ALL HEADER INFORMATION                           14000000
140100******************************************************************14010000
140200 1000-INITIALIZE.                                                 14020000
140300                                                                  14030000
140400     INITIALIZE PA-PROGRAM-ACCUMULATORS.                          14040000
140500**                                                                14050000
140510     DISPLAY ' '.                                                 14051097
140520     DISPLAY 'SUKRP010 - START'.                                  14052097
140600     ACCEPT CC-CONTROL-CARD FROM SYSIN.                           14060000
140700     DISPLAY 'CONTROL CARD = ' CC-CONTROL-CARD.                   14070000
140800**                                                                14080000
140900     OPEN INPUT  AS-AUDIT-SUM-EXTRACT-FILE                        14090000
141000          OUTPUT AS-AUDIT-SUM-REPORT-FILE                         14100000
141100                 AS-AUDIT-SUM-REPORT-FILE-LOG                     14110070
141110                 AS-AUDIT-SUM-REPORT-FLAT-FILE.                   14111070
141200                                                                  14120000
141210     MOVE SPACES  TO  AS-AUDIT-SUM-REPORT-LINE-FLAT.              14121084
141220                                                                  14122084
141300     SET PS-NOT-EOF-AUDIT-SUM-EXTRACT   TO TRUE.                  14130000
141400                                                                  14140000
141500     PERFORM 8001-READ-EXTRACT-FILE.                              14150000
141600                                                                  14160000
141700                                                                  14170000
141800*    IF THERE IS NO DATA, PRINT NO DATA MESSAGE TO THE REPORT,    14180000
141900*    OTHERWISE SET-UP THE PAGE HEADINGS                           14190000
142000     IF PS-EOF-AUDIT-SUM-EXTRACT                                  14200000
142100         SET PS-NO-DATA                  TO TRUE                  14210000
142200         DISPLAY '*******  NO DATA TO REPORT IN SUKRP010 ******'  14220000
142300     ELSE                                                         14230000
142400         SET PS-DATA                     TO TRUE                  14240000
142500*        IF THIS IS A PRINTEK PRINTER, LOAD THE FORM              14250000
142600         IF CC-PRTR-CNTL-IND = 'P'                                14260000
142700             MOVE CC-TRACK-NBR           TO DS004-PLC-LF-FORM-NBR 14270000
142800             MOVE DS004-PES-8LPI         TO DS004-PLC-LF-LPI      14280000
142900                                                                  14290000
143000             WRITE AS-AUDIT-SUM-REPORT-LINE                       14300000
143100                 FROM DS004-PLC-LOAD-FORM                         14310000
143200             AFTER ADVANCING 1 LINE                               14320000
143201                                                                  14320170
143300         END-IF                                                   14330000
143400         PERFORM 1100-SET-UP-HEADER                               14340000
143500     END-IF.                                                      14350000
143600                                                                  14360000
143700                                                                  14370000
143800                                                                  14380000
143900                                                                  14390000
144000******************************************************************14400000
144100*  1100-SET-UP-HEADER                                             14410000
144200*       - SELECTS ALL THE AUDIT LEVEL INFORMATION.                14420000
144300*       - MOVES ALL INFO TO THE HEADER FIELDS                     14430000
144400******************************************************************14440000
144500 1100-SET-UP-HEADER.                                              14450000
144510*                                                                 14451073
144600                                                                  14460000
144700     MOVE SU005-AUD-CNTL-NBR            TO AH1-AUD-CNTL-NBR       14470000
144800                                           DK-AUD-CNTL-NBR.       14480000
144900                                                                  14490000
145000     MOVE PC-CURRENT-PROGRAM-NAME       TO DP132O-PROGRAM-NAME.   14500000
145100                                                                  14510000
145200     PERFORM 1200-SELECT-HEADER-INFORMATION.                      14520000
145220     PERFORM 1300-SELECT-AUDIT-TYPE.                              14522000
145300                                                                  14530000
145400     MOVE PV-CURR-YY                    TO DP132O-RUN-YEAR.       14540000
145500     MOVE PV-CURR-MM                    TO DP132O-RUN-MONTH.      14550000
145600     MOVE PV-CURR-DD                    TO DP132O-RUN-DAY.        14560000
145700                                                                  14570000
145800     MOVE PV-CURR-HH                    TO DP132O-RUN-HOUR.       14580000
145900     MOVE PV-CURR-MIN                   TO DP132O-RUN-MINUTE.     14590000
146000                                                                  14600000
146100     MOVE SUNAUD-AUD-STRT-TMST          TO PV-TIMESTAMP.          14610000
146200     MOVE PV-TIMESTAMP-DATE             TO  AH6-AUDIT-START-DATE. 14620000
146300     MOVE PV-TIMESTAMP-TIME             TO  AH6-AUDIT-START-TIME. 14630000
146400                                                                  14640000
146500     IF SUNAUD-AUD-STP-TMST = PC-NINES-TIMESTAMP                  14650000
146600         MOVE SPACES                    TO  AH8-DURATION-X        14660000
146700                                            AH7-AUDIT-STOP-DATE   14670000
146800                                            AH7-AUDIT-STOP-TIME   14680000
146900                                                                  14690000
147000     ELSE                                                         14700000
147100         MOVE SUNAUD-AUD-STP-TMST       TO PV-TIMESTAMP           14710000
147200         MOVE PV-TIMESTAMP-DATE         TO  AH7-AUDIT-STOP-DATE   14720000
147300         MOVE PV-TIMESTAMP-TIME         TO  AH7-AUDIT-STOP-TIME   14730000
147400                                                                  14740000
147500*        CONVERT THE NUMBER OF DAYS AND HOURS TO MINUTES...ADD    14750000
147600*        IT TO THE REMINDER OF THE MINUTES, AND SUBRACT ANY MIN.  14760000
147700*        THAT THE AUDIT WAS POSTPONED TO GET THE TOTAL NUMBER OF  14770000
147800*        MINUTES TO PROCESS                                       14780000
147810                                                                  14781073
147900         COMPUTE PV-DURATION-TOTAL =                              14790000
148000             ((PV-DAY-COUNT   * 1440) +                           14800000
148100              (PV-HOUR-COUNT  *   60) +                           14810000
148200               PV-MINUTE-COUNT ) - SUNAUD-AUD-PSPND-MNIT-QTY      14820000
148300                                                                  14830000
148400*        DIVIDE THE TOTAL NUMBER OF MINUTES BY 60 TO COME UP WITH 14840000
148500*        THE NNUMBER OF HOURS...THE REMAINDER IS THE MINUTES.     14850000
148510                                                                  14851073
148600         DIVIDE PV-DURATION-TOTAL BY 60                           14860000
148700         GIVING    PV-DURATION-HOURS                              14870000
148800         REMAINDER PV-DURATION-MINUTES                            14880000
148900                                                                  14890000
149000         MOVE PV-DURATION-HOURS         TO AH8-DURATION-HOURS     14900000
149100         MOVE PV-DURATION-MINUTES       TO AH8-DURATION-MINUTES   14910000
149200     END-IF.                                                      14920000
149300                                                                  14930000
150100                                                                  15010000
150200     MOVE SUNAUD-OPER-UNT-ID            TO AH1-OPER-UNT-ID        15020000
150300                                           PV-OPER-UNT-ID         15030000
150400                                           DK-OPER-UNT-ID.        15040000
150500     PERFORM 1110-GET-FCLTY-DESC                                  15050000
150600                                                                  15060000
150700     MOVE SUNAUD-PRC-FCLTY-AREA-ID      TO AH3-AUDIT-AREA.        15070000
150800     MOVE SUNAUD-AUD-STAT-CDE           TO PV-AUDIT-STATUS.       15080000
150900     MOVE SUNAUD-AUD-TYP-CDE            TO PV-AUDIT-TYPE.         15090000
151000                                                                  15100000
151100     EVALUATE TRUE                                                15110000
151200       WHEN  PV-100-AUDIT-CHECK                                   15120000
151300             MOVE '100% CHECK      '    TO AH4-AUDIT-TYPE         15130000
151400       WHEN  PV-SPOT-AUDIT-CHECK                                  15140000
151500             MOVE 'SPOT CHECK      '    TO AH4-AUDIT-TYPE         15150000
151600       WHEN  PV-REWORK-AUDIT-CHECK                                15160000
151700             MOVE 'REWORK          '    TO AH4-AUDIT-TYPE         15170000
151800     END-EVALUATE.                                                15180000
151900                                                                  15190000
152000     EVALUATE TRUE                                                15200000
152100       WHEN  PV-AUDIT-INPROCESS                                   15210000
152200             MOVE 'INPROCESS      '     TO AH1-AUDIT-STATUS       15220000
152300       WHEN  PV-AUDIT-COMPLETE                                    15230000
152400             MOVE 'COMPLETE       '     TO AH1-AUDIT-STATUS       15240000
152500       WHEN  PV-AUDIT-POSTPONE                                    15250000
152600             MOVE 'POSTPONED      '     TO AH1-AUDIT-STATUS       15260000
152700     END-EVALUATE.                                                15270000
152800                                                                  15280000
152900                                                                  15290000
153000******************************************************************15300000
153100* 1110-GET-FCLTY-DESC                                             15310000
153200*    THIS PARAGRAPH WILL SELECT THE FACLITY DESC                  15320000
153300******************************************************************15330000
153400 1110-GET-FCLTY-DESC.                                             15340000
153500                                                                  15350000
153600     INITIALIZE XL071-COMMAREA-REC.                               15360000
153700     MOVE DK-OPER-UNT-ID        TO XL071-LOCATION-NUMBER          15370000
153800                                                                  15380000
153900     CALL XL071-LOCATION-MODULE USING XL071-COMMAREA-REC.         15390000
154000                                                                  15400000
154100     EVALUATE TRUE                                                15410000
154200     WHEN XL071-NO-ERRORS                                         15420000
154300         MOVE XL071-LOC-NM          TO AH1-FCLTY-DESC             15430000
154400     WHEN XL071-LOC-NOT-FOUND                                     15440000
154500     WHEN XL071-DC-ASGMT-NOT-FND                                  15450000
154600         MOVE 'UNKNOWN'             TO AH1-FCLTY-DESC             15460000
154700     WHEN XL071-BAD-DB2-RETURN                                    15470000
154800         DISPLAY '1110-GET-FCLTY-DESC'                            15480000
154900         DISPLAY 'CALL LOCATION MOD '                             15490000
155000         DISPLAY 'XLT00010'                                       15500000
155100         MOVE XL071-SQLCA             TO SQLCA                    15510000
155200         MOVE '1110-GET-FCLTY-DESC'   TO PV-PARAGRAPH-NAME        15520000
155300         MOVE 'CALL TO XLKUT071'     TO PV-DB2-OPERATION-ATTEMPTED15530000
155400         DISPLAY 'OPER-UNT-ID = ' DK-OPER-UNT-ID                  15540000
155500         PERFORM 9999-SQL-ABEND                                   15550000
155600     END-EVALUATE.                                                15560000
155700/                                                                 15570000
155800******************************************************************15580000
155900* 1200-SELECT-HEADER-INFORMATION                                  15590000
156000*    THIS PARAGRAPH WILL SELECT ALL THE HEADER INFORMATION FOR    15600000
156100*    THE REPORT                                                   15610000
156200******************************************************************15620000
156300 1200-SELECT-HEADER-INFORMATION.                                  15630000
156400                                                                  15640000
156500     EXEC SQL                                                     15650000
156600         SELECT                                                   15660000
156700                AUD_STRT_TMST                                     15670000
156800              , AUD_STP_TMST                                      15680000
156900              , DAYS(AUD_STP_TMST)   - DAYS(AUD_STRT_TMST)        15690000
157000              , HOUR(AUD_STP_TMST)   - HOUR(AUD_STRT_TMST)        15700000
157100              , MINUTE(AUD_STP_TMST) - MINUTE(AUD_STRT_TMST)      15710000
157200              , AUD_PSPND_MNIT_QTY                                15720000
157300              , AUD_CLO_MNIT_QTY                                  15730000
157400              , OPER_UNT_ID                                       15740000
157500              , PRC_FCLTY_AREA_ID                                 15750000
157600              , AUD_STAT_CDE                                      15760000
157700              , AUD_TYP_CDE                                       15770000
157800              , CURRENT TIMESTAMP                                 15780000
157900         INTO                                                     15790000
158000                :SUNAUD-AUD-STRT-TMST                             15800000
158100              , :SUNAUD-AUD-STP-TMST                              15810000
158200              , :PV-DAY-COUNT                                     15820000
158300              , :PV-HOUR-COUNT                                    15830000
158400              , :PV-MINUTE-COUNT                                  15840000
158500              , :SUNAUD-AUD-PSPND-MNIT-QTY                        15850000
158600              , :SUNAUD-AUD-CLO-MNIT-QTY                          15860000
158700              , :SUNAUD-OPER-UNT-ID                               15870000
158800              , :SUNAUD-PRC-FCLTY-AREA-ID                         15880000
158900              , :SUNAUD-AUD-STAT-CDE                              15890000
159000              , :SUNAUD-AUD-TYP-CDE                               15900000
159100              , :PV-DB2-CURR-TIMESTAMP                            15910000
159200         FROM                                                     15920000
159300                TSUNAUD                                           15930000
159400         WHERE                                                    15940000
159500             AUD_CNTL_NBR = :DK-AUD-CNTL-NBR                      15950000
159600     END-EXEC.                                                    15960000
159700                                                                  15970000
159800     EVALUATE TRUE                                                15980000
159900         WHEN SQLCODE = ZERO                                      15990000
160000              MOVE PV-DB2-CURR-TIMESTAMP                          16000000
160100                               TO PV-CURR-TIMESTAMP               16010000
160200         WHEN OTHER                                               16020000
160300              MOVE '1200-SELECT-HEADER-INFO.'                     16030000
160400                               TO  PV-PARAGRAPH-NAME              16040000
160500              MOVE 'SELECT OF TSUNAUD'                            16050000
160600                               TO  PV-DB2-OPERATION-ATTEMPTED     16060000
160700              PERFORM 9999-SQL-ABEND                              16070000
160800     END-EVALUATE.                                                16080000
160900                                                                  16090000
161020******************************************************************16102000
161030* 1300-SELECT-AUDIT-TYPE                                          16103000
161040*    THIS PARAGRAPH WILL SELECT FROM SUT_PO_AUD_REQ TO CHECK IF   16104000
161050*    THE AUDIT IS PROMPTED OR MANUAL                              16105000
161060******************************************************************16106000
161070 1300-SELECT-AUDIT-TYPE.                                          16107000
161083                                                                  16108300
161090     INITIALIZE DCLSUT00015.                                      16109000
161091                                                                  16109100
161092     EXEC SQL                                                     16109200
161093         SELECT PKGNG_TYP_CDE                                     16109300
161094               ,VALUE(RWRK_AUD_CNTL_NBR,0)                        16109400
161095         INTO  :SUT00015-PKGNG-TYP-CDE                            16109500
161096              ,:SUT00015-RWRK-AUD-CNTL-NBR                        16109600
161097         FROM   SUT_PO_AUD_REQ                                    16109700
161098         WHERE  AUD_CNTL_NBR   = :DK-AUD-CNTL-NBR                 16109800
161099     END-EXEC.                                                    16109900
161100                                                                  16110000
161101     EVALUATE TRUE                                                16110100
161102       WHEN SQLCODE = +0                                          16110200
161103            SET AH7-PROMPTED-AUDIT TO TRUE                        16110300
161104       WHEN SQLCODE = +100                                        16110400
161105            SET AH7-MANUAL-AUDIT   TO TRUE                        16110500
161106       WHEN OTHER                                                 16110600
161107            DISPLAY DK-AUD-CNTL-NBR                               16110700
161108            MOVE '1300-SELECT-AUDIT-TYPE'                         16110800
161109                                   TO  PV-PARAGRAPH-NAME          16110900
161110            MOVE 'SELECT OF SUT_PO_AUD_REQ'                       16111000
161111                                   TO PV-DB2-OPERATION-ATTEMPTED  16111100
161117            PERFORM 9999-SQL-ABEND                                16111700
161118     END-EVALUATE.                                                16111800
161124                                                                  16112400
161126                                                                  16112600
161130******************************************************************16113000
161200* 2000-CREATE-REPORT -- CREATE THE AUDIT SUMMARY REPORT FOR A     16120000
161300*    PARTICULAR RECEIVER -- THIS PARAGRAPH WILL REPEAT UNTIL THE  16130000
161400*    END OF THE EXTRACT FILE                                      16140000
161500*                                                                 16150000
161600*    -GET THE RECEIVER LEVEL INFO AND START A NEW PAGE PRINTING   16160000
161700*     THE RECEIVER INFORMATION                                    16170000
161800*    -SPIN THROUGH THE PICKING ERRORS FIRST, PRINTING DETAIL LINES16180000
161900*     OR ACCUMULATING COUNT OF SKUS WITH NO ERRORS.               16190000
162000*    -THEN SPIN THORUGH THE TICKETING ERRORS DOING THE SAME THING 16200000
162100*    -AFTER ALL DETAIL, CALCULATE THE ERROR RATIO'S, AND DISPLAY  16210000
162200*     THE SKU LIST                                                16220000
162300******************************************************************16230000
162400 2000-CREATE-REPORT.                                              16240000
162500                                                                  16250000
162600     INITIALIZE PA-RECEIVER-ACCUM.                                16260000
162700     MOVE SU005-PO-NBR                  TO PV-HOLD-PO-NBR.        16270000
162800     MOVE SU005-REC-SEQ-NBR             TO PV-HOLD-REC-SEQ-NBR.   16280000
162900                                                                  16290000
162911*                                                                 16291173
162915*    GET INFORMATION                                              16291500
162920     PERFORM 3110-SELECT-RECEIVER-INFO.                           16292000
162930*                                                                 16293073
163000*    PRINT THE PAGE AND RECEIVER HEADINGS                         16300000
163200     IF SU005-PICKING-ERRORS  OR                                  16320000
163300        SU005-TICKETING-ERRORS                                    16330000
163400        MOVE 'QC  ' TO AH6-AUDIT-CATEGORY                         16340000
163600        PERFORM 3000-PRINT-PAGE-HEADING                           16360000
163800                                                                  16380000
163900*    CREATE THE PICKING ERROR DETAIL UNTIL THE END OF THE INPUT   16390000
164000*    FILE, OR THE END OF THE PICKING ERRORS, OR UNTIL THE RECEIVER16400000
164100*    NUMBER CHANGES                                               16410000
164200        PERFORM 2200-CREATE-PICKING-DETAIL                        16420000
164300         UNTIL  PS-EOF-AUDIT-SUM-EXTRACT                          16430000
164400            OR  SU005-TICKETING-ERRORS                            16440000
164600            OR  SU005-RFID-ERRORS                                 16460000
164800            OR  SU005-PO-NBR        > PV-HOLD-PO-NBR              16480000
164900            OR  SU005-REC-SEQ-NBR   > PV-HOLD-REC-SEQ-NBR         16490000
165000                                                                  16500000
165100         PERFORM 2210-CREATE-PICKING-SUMMARY                      16510000
165200                                                                  16520000
165300*    CREATE THE TICKETING ERROR DETAIL UNTIL THE END OF THE INPUT 16530000
165400*    FILE, OR THE END OF THE TICKETING ERRORS, OR UNTIL THE       16540000
165500*    RECEIVER NUMBER CHANGES                                      16550000
165510                                                                  16551073
165600         PERFORM 2300-CREATE-TICKETING-DETAIL                     16560000
165700           UNTIL PS-EOF-AUDIT-SUM-EXTRACT                         16570000
165900             OR  SU005-RFID-ERRORS                                16590000
166100             OR  SU005-PO-NBR        > PV-HOLD-PO-NBR             16610000
166200             OR  SU005-REC-SEQ-NBR   > PV-HOLD-REC-SEQ-NBR        16620000
166300                                                                  16630000
166400         PERFORM 2310-CREATE-TICKETING-SUMMARY                    16640000
166500                                                                  16650000
166600*    BY THIS POINT, ALL THE DETAIL FOR A PARTICULAR RECEIVING HAS 16660000
166700*    BE PRINTED, NOW CALCULATE THE VARIOUS ERROR RATIO FIGURES    16670000
166800*    AND PRINT THE REPORT FOOTERS.                                16680000
166810                                                                  16681073
166900         PERFORM 2400-PRINT-FOOTER                                16690000
167000     END-IF.                                                      16700000
167100                                                                  16710000
167300     IF SU005-RFID-ERRORS                                         16730000
167400        MOVE 'RFID' TO AH6-AUDIT-CATEGORY                         16740000
167500        PERFORM 3000-PRINT-PAGE-HEADING                           16750000
167600                                                                  16760073
167700*    CREATE THE RFID ERROR DETAIL UNTIL THE END OF THE INPUT      16770000
167800*    FILE, OR THE END OF THE RFID ERRORS, OR UNTIL THE            16780000
167900*    RECEIVER NUMBER CHANGES                                      16790000
167910                                                                  16791073
168000        PERFORM 2500-CREATE-RFID-DETAIL                           16800000
168100          UNTIL PS-EOF-AUDIT-SUM-EXTRACT                          16810000
168200            OR  SU005-PO-NBR        > PV-HOLD-PO-NBR              16820000
168300            OR  SU005-REC-SEQ-NBR   > PV-HOLD-REC-SEQ-NBR         16830000
168400                                                                  16840000
168500        PERFORM 2510-CREATE-RFID-SUMMARY                          16850000
168600                                                                  16860000
168700*    BY THIS POINT, ALL THE DETAIL FOR A PARTICULAR RECEIVING HAS 16870000
168800*    BE PRINTED, NOW CALCULATE THE VARIOUS ERROR RATIO FIGURES    16880000
168900*    AND PRINT THE REPORT FOOTERS FOR RFID.                       16890000
168910                                                                  16891073
169000        PERFORM 2600-PRINT-RFID-FOOTER                            16900000
169100     END-IF.                                                      16910000
169300                                                                  16930000
169400******************************************************************16940000
169500* 2200-CREATE-PICKING-DETAIL                                      16950000
169600*  -CHECK EACH ERROR DETAIL BUCKET -- IF FOUND, MOVE TO THE DETAIL16960000
169700*  --- IF ANY FOUND, MOVE THE NUMBER TO THE DETAIL LINE, AND ADD  16970000
169800*      IT TO THE APPROPRIATE REPORT BUCKET -- IF ERRORS           16980000
169900*  -IF ANY ERRORS FOUND, PRINT THE REPORT LINE, OTHERWISE ADD     16990000
170000*   TO THE SKU COUNT WITH NO ERRORS                               17000000
170100******************************************************************17010000
170600 2200-CREATE-PICKING-DETAIL.                                      17060000
170700                                                                  17070000
170800     IF PS-PRINT-PICK-HEADING                                     17080000
170900         PERFORM 2220-PRINT-PICK-HEADINGS                         17090000
171000     END-IF.                                                      17100000
171100                                                                  17110000
171200     INITIALIZE PDL-PICKING-DETAIL-LINE.                          17120000
171300                                                                  17130000
171400     SET   PS-DONT-PRINT-DETAIL       TO TRUE.                    17140000
171500                                                                  17150000
171600     MOVE SU005-SKU-DEPT-NBR          TO PDL-SKU-DEPT.            17160000
171700     MOVE SU005-SKU-CL-NBR            TO PDL-SKU-CLASS.           17170000
171800     MOVE SU005-SKU-NMBR              TO PDL-SKU-NBR.             17180000
172200                                                                  17220000
172300*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  17230000
172400*  *  VENDOR OVER *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  17240000
172500*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  17250000
172600     IF  SU005-VENDOR-OVER             > ZERO                     17260000
172700         MOVE  SU005-VENDOR-OVER      TO PDL-VND-OVER             17270000
172800         SET   PS-PRINT-DETAIL        TO TRUE                     17280000
172900                                                                  17290000
173000         MOVE 'PA-VENDOR-OVER'        TO PV-FIELD-NAME            17300000
173100         COMPUTE PA-VENDOR-OVER =                                 17310000
173200                 PA-VENDOR-OVER + SU005-VENDOR-OVER               17320000
173300             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      17330000
173400         END-COMPUTE                                              17340000
173500     END-IF.                                                      17350000
173600                                                                  17360000
173700*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  17370000
173800*  *  VENDOR SHORT   *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  17380000
173900*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  17390000
174000     IF  SU005-VENDOR-SHORT            > ZERO                     17400000
174100         MOVE  SU005-VENDOR-SHORT     TO PDL-VND-SHORT            17410000
174200         SET   PS-PRINT-DETAIL        TO TRUE                     17420000
174300                                                                  17430000
174400         MOVE 'PA-VENDOR-SHORT'       TO PV-FIELD-NAME            17440000
174500         COMPUTE PA-VENDOR-SHORT =                                17450000
174600                 PA-VENDOR-SHORT + SU005-VENDOR-SHORT             17460000
174700             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      17470000
174800         END-COMPUTE                                              17480000
174900     END-IF.                                                      17490000
175000                                                                  17500000
175100*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  17510000
175200*  *  RECEIVER OVER  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  17520000
175300*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  17530000
175400*    CAN ONLY HAVE A RECEIVER OVER/SHORT ON A FULL/REWORKED AUDIT 17540000
175500     IF  PV-SPOT-AUDIT-CHECK                                      17550000
175600        MOVE ' N/A'                   TO PDL-RCVR-OVER-X          17560000
175700     ELSE                                                         17570000
175800        IF  SU005-RECEIVER-OVER           > ZERO                  17580000
175900            MOVE  SU005-RECEIVER-OVER TO PDL-RCVR-OVER            17590000
176000            SET   PS-PRINT-DETAIL     TO TRUE                     17600000
176100                                                                  17610000
176200            MOVE 'PA-RECEIVER-OVER'   TO PV-FIELD-NAME            17620000
176300            COMPUTE PA-RECEIVER-OVER =                            17630000
176400                    PA-RECEIVER-OVER + SU005-RECEIVER-OVER        17640000
176500                ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR   17650000
176600            END-COMPUTE                                           17660000
176700        END-IF                                                    17670000
176800     END-IF.                                                      17680000
176900                                                                  17690000
177000*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  17700000
177100*  *  RECEIVER SHORT *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  17710000
177200*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  17720000
177300*    CAN ONLY HAVE A RECEIVER OVER/SHORT ON A FULL/REWORKED AUDIT 17730000
177400     IF  PV-SPOT-AUDIT-CHECK                                      17740000
177500        MOVE ' N/A'                   TO PDL-RCVR-SHORT-X         17750000
177600     ELSE                                                         17760000
177700        IF  SU005-RECEIVER-SHORT          > ZERO                  17770000
177800            MOVE SU005-RECEIVER-SHORT TO PDL-RCVR-SHORT           17780000
177900            SET  PS-PRINT-DETAIL      TO TRUE                     17790000
178000                                                                  17800000
178100            MOVE 'PA-RECEIVER-SHORT'  TO PV-FIELD-NAME            17810000
178200            COMPUTE PA-RECEIVER-SHORT =                           17820000
178300                    PA-RECEIVER-SHORT + SU005-RECEIVER-SHORT      17830000
178400                ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR   17840000
178500            END-COMPUTE                                           17850000
178600        END-IF                                                    17860000
178700     END-IF.                                                      17870000
178800                                                                  17880000
178900*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  17890000
179000*  *  STYLE SUB   *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  17900000
179100*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  17910000
179200     IF  SU005-STYLE-SUB               > ZERO                     17920000
179300         MOVE  SU005-STYLE-SUB        TO PDL-STYLE-SUB            17930000
179400         SET   PS-PRINT-DETAIL        TO TRUE                     17940000
179500                                                                  17950000
179600         MOVE 'PA-STYLE-SUB'          TO PV-FIELD-NAME            17960000
179700         COMPUTE PA-STYLE-SUB  =                                  17970000
179800                 PA-STYLE-SUB  + SU005-STYLE-SUB                  17980000
179900             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      17990000
180000         END-COMPUTE                                              18000000
180100     END-IF.                                                      18010000
180200                                                                  18020000
180300*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  18030000
180400*  *  DAMAGED UNITS  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  18040000
180500*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  18050000
180600     IF  SU005-DAMAGED-UNITS           > ZERO                     18060000
180700         MOVE  SU005-DAMAGED-UNITS    TO PDL-DAMAGED-UNITS        18070000
180800         SET   PS-PRINT-DETAIL        TO TRUE                     18080000
180900                                                                  18090000
181000         MOVE 'PA-DAMAGED-UNITS'      TO PV-FIELD-NAME            18100000
181100         COMPUTE PA-DAMAGED-UNITS =                               18110000
181200                 PA-DAMAGED-UNITS + SU005-DAMAGED-UNITS           18120000
181300             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      18130000
181400         END-COMPUTE                                              18140000
181500     END-IF.                                                      18150000
181600                                                                  18160000
181700*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  18170000
181800*  *  TOTAL ERRORS   *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  18180000
181900*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  18190000
182000     IF  SU005-TOT-PIC-ERR             > ZERO                     18200000
182100         MOVE  SU005-TOT-PIC-ERR      TO PDL-TOTAL-ERRORS         18210000
182200         SET   PS-PRINT-DETAIL        TO TRUE                     18220000
182300                                                                  18230000
182400         MOVE 'PA-TOT-ERRS-PIC'       TO PV-FIELD-NAME            18240000
182500         COMPUTE PA-TOT-ERRS-PIC  =                               18250000
182600                 PA-TOT-ERRS-PIC  + SU005-TOT-PIC-ERR             18260000
182700             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      18270000
182800         END-COMPUTE                                              18280000
182900     END-IF.                                                      18290000
183000                                                                  18300000
183100*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  18310000
183200*  *  UNITS IN ERROR *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  18320000
183300*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  18330000
183400     IF  SU005-TOT-UNITS-IN-PIC-ERR    > ZERO                     18340000
183500         MOVE  SU005-TOT-UNITS-IN-PIC-ERR                         18350000
183600                                      TO PDL-TOTAL-UNITS-IN-ERROR 18360000
183700         SET   PS-PRINT-DETAIL        TO TRUE                     18370000
183800                                                                  18380000
183900         MOVE 'PA-TOT-UNTS-IN-ERR-PIC' TO PV-FIELD-NAME           18390000
184000         COMPUTE PA-TOT-UNTS-IN-ERR-PIC =                         18400000
184100                 PA-TOT-UNTS-IN-ERR-PIC +                         18410000
184200                 SU005-TOT-UNITS-IN-PIC-ERR                       18420000
184300             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      18430000
184400         END-COMPUTE                                              18440000
184500     END-IF.                                                      18450000
184600                                                                  18460000
184700*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  18470000
184800*  *  UNITS TRANSCRIBED *  *  *  *  *  *  *  *  *  *  *  *  *  *  18480000
184900*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  18490000
185000     IF  SU005-UNITS-TRNSCRBD          > ZERO                     18500000
185100         MOVE  SU005-UNITS-TRNSCRBD   TO PDL-TOTAL-UNITS-TRNSCRBD 18510000
185200                                                                  18520000
185300*        IF THERE ARE ERRORS, ADD THE UNITS TRANSCRIBED TO THE    18530000
185400*        TOTAL FOR THOSE SKUS WITH ERRORS.                        18540000
185500         IF PS-PRINT-DETAIL                                       18550000
185600             MOVE 'PA-TOT-UNTS-TRNS-IE-PIC' TO PV-FIELD-NAME      18560000
185700             COMPUTE PA-TOT-UNTS-TRNS-IE-PIC =                    18570000
185800                     PA-TOT-UNTS-TRNS-IE-PIC +                    18580000
185900                     SU005-UNITS-TRNSCRBD                         18590000
186000                 ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR  18600000
186100             END-COMPUTE                                          18610000
186200         ELSE                                                     18620000
186300*        OTHERWISE ADD TO THOSE SKUS WITH NO ERRORS               18630000
186400             MOVE 'PA-TOT-UNTS-TRNS-NE-PIC' TO PV-FIELD-NAME      18640000
186500             COMPUTE PA-TOT-UNTS-TRNS-NE-PIC =                    18650000
186600                     PA-TOT-UNTS-TRNS-NE-PIC +                    18660000
186700                     SU005-UNITS-TRNSCRBD                         18670000
186800                 ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR  18680000
186900             END-COMPUTE                                          18690000
187000         END-IF                                                   18700000
187100*        EITHER WAY ADD TO THE OVERALL TOTAL                      18710000
187200         MOVE 'PA-UNTS-TRNS-PIC'             TO PV-FIELD-NAME     18720000
187300         COMPUTE PA-UNTS-TRNS-PIC =                               18730000
187400                 PA-UNTS-TRNS-PIC +                               18740000
187500                 SU005-UNITS-TRNSCRBD                             18750000
187600             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      18760000
187700         END-COMPUTE                                              18770000
187800     END-IF.                                                      18780000
187900                                                                  18790000
188000*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  18800000
188100*  *  UNITS AUDITED  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  18810000
188200*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  18820000
188300     IF  SU005-UNITS-AUDITED           > ZERO                     18830000
188400         MOVE  SU005-UNITS-AUDITED    TO PDL-TOTAL-UNITS-AUDITED  18840000
188500                                                                  18850000
188600*        IF THERE ARE ERRORS, ADD THE UNITS AUDITED TO THE BUCKET 18860000
188700*        TOTAL FOR THOSE SKUS WITH ERRORS.                        18870000
188800         IF PS-PRINT-DETAIL                                       18880000
188900             MOVE 'PA-TOT-UNTS-AUD-IE-PIC' TO PV-FIELD-NAME       18890000
189000             COMPUTE PA-TOT-UNTS-AUD-IE-PIC =                     18900000
189100                     PA-TOT-UNTS-AUD-IE-PIC +                     18910000
189200                     SU005-UNITS-AUDITED                          18920000
189300                 ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR  18930000
189400             END-COMPUTE                                          18940000
189500         ELSE                                                     18950000
189600*        OTHERWISE ADD TO THOSE SKUS WITH NO ERRORS               18960000
189700             MOVE 'PA-TOT-UNTS-AUD-NE-PIC' TO PV-FIELD-NAME       18970000
189800             COMPUTE PA-TOT-UNTS-AUD-NE-PIC =                     18980000
189900                     PA-TOT-UNTS-AUD-NE-PIC +                     18990000
190000                     SU005-UNITS-AUDITED                          19000000
190100                 ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR  19010000
190200             END-COMPUTE                                          19020000
190300         END-IF                                                   19030000
190400*        EITHER WAY ADD TO THE OVERALL TOTAL                      19040000
190500         MOVE 'PA-UNTS-AUD-PIC'             TO PV-FIELD-NAME      19050000
190600         COMPUTE PA-UNTS-AUD-PIC       =                          19060000
190700                 PA-UNTS-AUD-PIC       +                          19070000
190800                 SU005-UNITS-AUDITED                              19080000
190900             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      19090000
191000         END-COMPUTE                                              19100000
191100     END-IF.                                                      19110000
191200                                                                  19120000
191300*    ADD THE NET NUMBER OF UNITS IN ERROR -- EVEN THOUGH THIS     19130000
191400*    FIELD IS IN THE "HEADER" SECTION OF SURD005, IT CAN ONLY BE  19140000
191500*    ACCULUATED ONCE FOR EACH TYPE OF RECORD (EACH STORE WILL HAVE19150000
191600*    A PICKING AND TICKETING SECTION)                             19160000
191700     MOVE 'PA-NET-UNTS-IN-ERROR'           TO PV-FIELD-NAME.      19170000
191800     COMPUTE PA-NET-UNTS-IN-ERROR   =                             19180000
191900             PA-NET-UNTS-IN-ERROR  +                              19190000
192000             SU005-TOT-UNITS-IN-ERROR                             19200000
192100     ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR.             19210000
192200                                                                  19220000
192300                                                                  19230000
192400*    IF ANY ERRORS FOUND, PRINT THE DETAIL...IF NOT, ADD TO THE   19240000
192500*    TOTALS OF THE SKUS WITH NO ERRORS                            19250000
192600     IF PS-PRINT-DETAIL                                           19260000
192700*        IF A SPOT ERROR USE THE UNITS AUDITED TO CALCULATE THE   19270000
192800*        ERROR RATIO -- OTHERWISE USE THE UNITS TRANSCRIBED       19280000
192900         IF PV-SPOT-AUDIT-CHECK                                   19290000
193000             IF SU005-UNITS-AUDITED > ZERO                        19300000
193100                 COMPUTE PV-ERROR-RATIO  =                        19310000
193200                     (SU005-TOT-UNITS-IN-PIC-ERR /                19320000
193300                      SU005-UNITS-AUDITED)  * 100                 19330000
193400                 MOVE PV-ERROR-RATIO    TO PDL-ERROR-RATIO        19340000
193500             ELSE                                                 19350000
193600                 IF SU005-TOT-UNITS-IN-PIC-ERR > ZERO             19360000
193700                     MOVE 100                 TO PDL-ERROR-RATIO  19370000
193800                 ELSE                                             19380000
193900                     MOVE ZERO                TO PDL-ERROR-RATIO  19390000
194000                 END-IF                                           19400000
194100             END-IF                                               19410000
194200         ELSE                                                     19420000
194300             IF SU005-UNITS-TRNSCRBD > ZERO                       19430000
194400                 COMPUTE PV-ERROR-RATIO  =                        19440000
194500                     (SU005-TOT-UNITS-IN-PIC-ERR /                19450000
194600                      SU005-UNITS-TRNSCRBD)  * 100                19460000
194700                 MOVE PV-ERROR-RATIO    TO PDL-ERROR-RATIO        19470000
194800             ELSE                                                 19480000
194900                 IF SU005-TOT-UNITS-IN-PIC-ERR > ZERO             19490000
195000                     MOVE 100                 TO PDL-ERROR-RATIO  19500000
195100                 ELSE                                             19510000
195200                     MOVE ZERO                TO PDL-ERROR-RATIO  19520000
195300                 END-IF                                           19530000
195400             END-IF                                               19540000
195500         END-IF                                                   19550000
195600                                                                  19560000
195700         MOVE '%'                   TO PDL-PERCENT                19570000
195800                                                                  19580000
195900         IF (PV-DETAIL-LINE-COUNT + 1) > PC-MAX-REPORT-LINES      19590000
196000             PERFORM 3000-PRINT-PAGE-HEADING                      19600000
196200             PERFORM 2220-PRINT-PICK-HEADINGS                     19620000
196300         END-IF                                                   19630000
196400                                                                  19640000
196500*        GET THE LINE NUMBER                                      19650000
196600         PERFORM 8100-GET-LINE-NUMBER                             19660000
196700         EVALUATE TRUE                                            19670000
196800           WHEN SQLCODE = -811                                    19680000
196900             MOVE 'MULT'            TO PDL-LINE-NBR-X             19690000
197000           WHEN SQLCODE = +100                                    19700000
197100             MOVE ' N/A'            TO PDL-LINE-NBR-X             19710000
197200           WHEN OTHER                                             19720000
197300             MOVE PURITM-APP-PO-LNE-NBR                           19730000
197400                                    TO PDL-LINE-NBR               19740000
197500         END-EVALUATE                                             19750000
197600                                                                  19760000
197610         IF  CC-FLAT-FILE                                         19761093
197640             WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                  19764093
197650              FROM PDL-PICKING-DETAIL-LINE                        19765093
197660         ELSE                                                     19766093
197700             WRITE AS-AUDIT-SUM-REPORT-LINE                       19770093
197800              FROM PDL-PICKING-DETAIL-LINE                        19780093
197900             AFTER ADVANCING 1 LINES                              19790000
198000             WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                   19800093
198100                 FROM PDL-PICKING-DETAIL-LINE                     19810093
198200                 AFTER ADVANCING 1 LINES                          19820093
198210         END-IF                                                   19821093
198220                                                                  19822093
198300         ADD +1                     TO PV-DETAIL-LINE-COUNT       19830000
198400                                       PA-SKUS-W-ERRS-PIC         19840000
198500                                       PA-SKU-COUNT-PIC           19850000
198600     ELSE                                                         19860000
198700         ADD +1                     TO PA-SKUS-W-NO-ERRS-PIC      19870000
198800                                       PA-SKU-COUNT-PIC           19880000
198900     END-IF.                                                      19890000
199000                                                                  19900000
199100     PERFORM 8001-READ-EXTRACT-FILE.                              19910000
199200                                                                  19920000
199300                                                                  19930000
199400******************************************************************19940000
199500* 2210-CREATE-PICKING-SUMMARY                                     19950000
199600*  -PRINT THE ERROR AND NO-ERROR SUB TOTALS AND A PICK TOTAL LINE 19960000
199700******************************************************************19970000
199800 2210-CREATE-PICKING-SUMMARY.                                     19980000
199900                                                                  19990000
200000*    IF THE SUMMARY WON'T FIT ON THE PAGE, GO TO THE NEXT ONE     20000000
200100     IF (PV-DETAIL-LINE-COUNT + 4) > PC-MAX-REPORT-LINES          20010000
200200         PERFORM 3000-PRINT-PAGE-HEADING                          20020000
200400     END-IF                                                       20040000
200500                                                                  20050000
200600*    WRITE SUMMARY LINE FOR THE SKUS WITH ERRORS                  20060000
200700     INITIALIZE PTL-PICKING-TOTAL-LINE.                           20070000
200800     MOVE '  SKUS W/ERRS'             TO PTL-TOTAL-DESCRIPTION.   20080000
200900     MOVE PA-SKUS-W-ERRS-PIC          TO PTL-SKU-COUNT.           20090000
201000     MOVE PA-VENDOR-OVER              TO PTL-VND-OVER.            20100000
201100     MOVE PA-VENDOR-SHORT             TO PTL-VND-SHORT.           20110000
201200     IF PV-SPOT-AUDIT-CHECK                                       20120000
201300         MOVE '   N/A'                TO PTL-RCVR-OVER-X          20130000
201400                                         PTL-RCVR-SHORT-X         20140000
201500     ELSE                                                         20150000
201600         MOVE PA-RECEIVER-OVER        TO PTL-RCVR-OVER            20160000
201700         MOVE PA-RECEIVER-SHORT       TO PTL-RCVR-SHORT           20170000
201800     END-IF.                                                      20180000
201900     MOVE PA-STYLE-SUB                TO PTL-STYLE-SUB.           20190000
202000     MOVE PA-DAMAGED-UNITS            TO PTL-DAMAGED-UNITS.       20200000
202100     MOVE PA-TOT-ERRS-PIC             TO PTL-TOTAL-ERRORS.        20210000
202200     MOVE PA-TOT-UNTS-IN-ERR-PIC      TO PTL-TOTAL-UNITS-IN-ERROR.20220000
202300     MOVE PA-TOT-UNTS-TRNS-IE-PIC     TO PTL-TOTAL-UNITS-TRNSCRBD.20230000
202400     MOVE PA-TOT-UNTS-AUD-IE-PIC      TO PTL-TOTAL-UNITS-AUDITED. 20240000
202500     MOVE SPACES                      TO PTL-PERCENT              20250000
202600                                         PTL-ERROR-RATIO-X.       20260000
202700                                                                  20270000
202800                                                                  20280000
202810     IF  CC-FLAT-FILE                                             20281093
202840         MOVE SPACES  TO  AS-AUDIT-SUM-REPORT-LINE-FLAT           20284093
202850         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      20285093
202860         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      20286093
202870          FROM PTL-PICKING-TOTAL-LINE                             20287093
202880     ELSE                                                         20288093
202900         WRITE AS-AUDIT-SUM-REPORT-LINE                           20290093
203000          FROM PTL-PICKING-TOTAL-LINE                             20300093
203100         AFTER ADVANCING 2 LINES                                  20310093
203200         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       20320093
203300          FROM PTL-PICKING-TOTAL-LINE                             20330093
203400         AFTER ADVANCING 2 LINES                                  20340093
203410     END-IF.                                                      20341093
203420                                                                  20342093
203500     ADD +2                           TO PV-DETAIL-LINE-COUNT.    20350000
203600                                                                  20360000
203700*    WRITE SUMMARY LINE FOR THE SKUS WITH NO ERRORS               20370000
203800     INITIALIZE PTL-PICKING-TOTAL-LINE.                           20380000
203900     MOVE ' SKUS WO/ERRS'             TO PTL-TOTAL-DESCRIPTION.   20390000
204000     MOVE PA-SKUS-W-NO-ERRS-PIC       TO PTL-SKU-COUNT.           20400000
204100     IF PV-SPOT-AUDIT-CHECK                                       20410000
204200         MOVE '   N/A'                TO PTL-RCVR-OVER-X          20420000
204300                                         PTL-RCVR-SHORT-X         20430000
204400     END-IF.                                                      20440000
204500     MOVE PA-TOT-UNTS-TRNS-NE-PIC     TO PTL-TOTAL-UNITS-TRNSCRBD.20450000
204600     MOVE PA-TOT-UNTS-AUD-NE-PIC      TO PTL-TOTAL-UNITS-AUDITED. 20460000
204700     MOVE SPACES                      TO PTL-PERCENT              20470000
204800                                         PTL-ERROR-RATIO-X.       20480000
204810                                                                  20481093
204820     IF  CC-FLAT-FILE                                             20482093
204850         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      20485093
204860          FROM PTL-PICKING-TOTAL-LINE                             20486093
204870     ELSE                                                         20487093
204900         WRITE AS-AUDIT-SUM-REPORT-LINE                           20490093
205000          FROM PTL-PICKING-TOTAL-LINE                             20500093
205100         AFTER ADVANCING 1 LINES                                  20510093
205200         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       20520093
205300          FROM PTL-PICKING-TOTAL-LINE                             20530093
205400         AFTER ADVANCING 1 LINES                                  20540093
205410     END-IF.                                                      20541093
205420                                                                  20542093
205500     ADD +1                           TO PV-DETAIL-LINE-COUNT.    20550000
205600                                                                  20560000
205700*    WRITE SUMMARY LINE FOR THE PICK TOTALS                       20570000
205800     INITIALIZE PTL-PICKING-TOTAL-LINE.                           20580000
205900     MOVE '   PICK TOTAL'             TO PTL-TOTAL-DESCRIPTION.   20590000
206000     MOVE PA-SKU-COUNT-PIC            TO PTL-SKU-COUNT.           20600000
206100     MOVE PA-VENDOR-OVER              TO PTL-VND-OVER.            20610000
206200     MOVE PA-VENDOR-SHORT             TO PTL-VND-SHORT.           20620000
206300     IF PV-SPOT-AUDIT-CHECK                                       20630000
206400         MOVE '   N/A'                TO PTL-RCVR-OVER-X          20640000
206500                                         PTL-RCVR-SHORT-X         20650000
206600     ELSE                                                         20660000
206700         MOVE PA-RECEIVER-OVER        TO PTL-RCVR-OVER            20670000
206800         MOVE PA-RECEIVER-SHORT       TO PTL-RCVR-SHORT           20680000
206900     END-IF.                                                      20690000
207000     MOVE PA-STYLE-SUB                TO PTL-STYLE-SUB.           20700000
207100     MOVE PA-DAMAGED-UNITS            TO PTL-DAMAGED-UNITS.       20710000
207200     MOVE PA-TOT-ERRS-PIC             TO PTL-TOTAL-ERRORS.        20720000
207300     MOVE PA-TOT-UNTS-IN-ERR-PIC      TO PTL-TOTAL-UNITS-IN-ERROR.20730000
207400     MOVE PA-UNTS-TRNS-PIC            TO PTL-TOTAL-UNITS-TRNSCRBD.20740000
207500     MOVE PA-UNTS-AUD-PIC             TO PTL-TOTAL-UNITS-AUDITED. 20750000
207600     MOVE '%'                         TO PTL-PERCENT.             20760000
207700                                                                  20770000
207800*    IF A SPOT ERROR USE THE UNITS AUDITED TO CALCULATE THE       20780000
207900*    ERROR RATIO -- OTHERWISE USE THE UNITS TRANSCRIBED           20790000
208000     IF PV-SPOT-AUDIT-CHECK                                       20800000
208100         IF PA-UNTS-AUD-PIC > ZERO                                20810000
208200            COMPUTE PV-ERROR-RATIO  =                             20820000
208300               (PA-TOT-UNTS-IN-ERR-PIC /                          20830000
208400                PA-UNTS-AUD-PIC) * 100                            20840000
208500            MOVE PV-ERROR-RATIO           TO PTL-ERROR-RATIO      20850000
208600         ELSE                                                     20860000
208700             IF PA-TOT-UNTS-IN-ERR-PIC  > ZERO                    20870000
208800                 MOVE 100                 TO PTL-ERROR-RATIO      20880000
208900             ELSE                                                 20890000
209000                 MOVE ZERO                TO PTL-ERROR-RATIO      20900000
209100             END-IF                                               20910000
209200         END-IF                                                   20920000
209300     ELSE                                                         20930000
209400         IF PA-UNTS-TRNS-PIC > ZERO                               20940000
209500            COMPUTE PV-ERROR-RATIO  =                             20950000
209600               (PA-TOT-UNTS-IN-ERR-PIC /                          20960000
209700                PA-UNTS-TRNS-PIC) * 100                           20970000
209800            MOVE PV-ERROR-RATIO           TO PTL-ERROR-RATIO      20980000
209900         ELSE                                                     20990000
210000             IF PA-TOT-UNTS-IN-ERR-PIC  > ZERO                    21000000
210100                 MOVE 100                 TO PTL-ERROR-RATIO      21010000
210200             ELSE                                                 21020000
210300                 MOVE ZERO                TO PTL-ERROR-RATIO      21030000
210400             END-IF                                               21040000
210500         END-IF                                                   21050000
210600     END-IF.                                                      21060000
210700                                                                  21070000
210710     IF  CC-FLAT-FILE                                             21071093
210740         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      21074093
210750          FROM PTL-PICKING-TOTAL-LINE                             21075093
210760     ELSE                                                         21076093
210800         WRITE AS-AUDIT-SUM-REPORT-LINE                           21080093
210900          FROM PTL-PICKING-TOTAL-LINE                             21090093
211000         AFTER ADVANCING 1 LINES                                  21100093
211100         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       21110093
211200          FROM PTL-PICKING-TOTAL-LINE                             21120093
211300         AFTER ADVANCING 1 LINES                                  21130093
211310     END-IF.                                                      21131093
211400                                                                  21140000
211500     ADD +1                           TO PV-DETAIL-LINE-COUNT.    21150000
211600                                                                  21160000
211700                                                                  21170000
211800******************************************************************21180000
211900* 2220-PRINT-PICK-HEADINGS                                        21190000
212000*  -PRINT THE DETAIL HEADINGS FOR THE PICKING ERRORS              21200000
212100******************************************************************21210000
212200 2220-PRINT-PICK-HEADINGS.                                        21220000
212300                                                                  21230000
212400*    IF THE HEADINGS + 1 DETAIL LINE WON'T FIT, GOTO THE NEXT PGE 21240000
212500     IF (PV-DETAIL-LINE-COUNT + 8) > PC-MAX-REPORT-LINES          21250000
212600         PERFORM 3000-PRINT-PAGE-HEADING                          21260000
212800     END-IF                                                       21280000
212900     SET PS-DONT-PRINT-PICK-HEADING   TO TRUE                     21290000
213000                                                                  21300000
213010     IF  CC-FLAT-FILE                                             21301093
213040         MOVE SPACES  TO  AS-AUDIT-SUM-REPORT-LINE-FLAT           21304093
213050         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      21305093
213060         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      21306093
213070          FROM PDH1-PICKING-DETAIL-HEADING-1                      21307093
213080     ELSE                                                         21308093
213100         WRITE AS-AUDIT-SUM-REPORT-LINE                           21310093
213200          FROM PDH1-PICKING-DETAIL-HEADING-1                      21320093
213300         AFTER ADVANCING 2 LINES                                  21330093
213400         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       21340093
213500          FROM PDH1-PICKING-DETAIL-HEADING-1                      21350093
213600         AFTER ADVANCING 2 LINES                                  21360093
213610     END-IF.                                                      21361093
213620                                                                  21362093
213630     IF  CC-FLAT-FILE                                             21363093
213680         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      21368093
213690          FROM PDH2-PICKING-DETAIL-HEADING-2                      21369093
213700     ELSE                                                         21370093
213800         WRITE AS-AUDIT-SUM-REPORT-LINE                           21380093
213900          FROM PDH2-PICKING-DETAIL-HEADING-2                      21390093
214000         AFTER ADVANCING 2 LINES                                  21400093
214100         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       21410093
214200          FROM PDH2-PICKING-DETAIL-HEADING-2                      21420093
214300         AFTER ADVANCING 2 LINES                                  21430093
214310     END-IF.                                                      21431093
214400                                                                  21440000
214410     IF  CC-FLAT-FILE                                             21441093
214420         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      21442093
214430          FROM PDH3-PICKING-DETAIL-HEADING-3                      21443093
214440     ELSE                                                         21444093
214500         WRITE AS-AUDIT-SUM-REPORT-LINE                           21450093
214600          FROM PDH3-PICKING-DETAIL-HEADING-3                      21460093
214700         AFTER ADVANCING 1 LINES                                  21470093
214800         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       21480093
214900          FROM PDH3-PICKING-DETAIL-HEADING-3                      21490093
215000         AFTER ADVANCING 1 LINES                                  21500093
215010     END-IF.                                                      21501093
215020                                                                  21502093
215100     ADD +5                           TO PV-DETAIL-LINE-COUNT.    21510000
215200                                                                  21520000
215300                                                                  21530000
215400******************************************************************21540000
215500* 2300-CREATE-TICKETING-DETAIL                                    21550000
215600*  -DETERMINE IF THERE ARE ANY ERRORS TO REPORT FOR THIS SKU      21560000
215700*      -IF SO, PRINT THE DETAIL REPORT, ADDING THE QUANTITES TO   21570000
215800*       THE ERROR ACCUMULATOR FIELDS.                             21580000
215900*      -OTHERWISE ADD TO THE "SKU WITH NO ERROR" BUCKETS          21590000
216000******************************************************************21600000
216500 2300-CREATE-TICKETING-DETAIL.                                    21650000
216600                                                                  21660000
216700     IF PS-PRINT-TICK-HEADING                                     21670000
216800         PERFORM 2320-PRINT-TICK-HEADINGS                         21680000
216900     END-IF.                                                      21690000
217000                                                                  21700000
217100     INITIALIZE TDL-TICKETING-DETAIL-LINE.                        21710000
217200                                                                  21720000
217300     SET   PS-DONT-PRINT-DETAIL       TO TRUE.                    21730000
217400                                                                  21740000
217500     MOVE SU005-SKU-DEPT-NBR          TO TDL-SKU-DEPT.            21750000
217600     MOVE SU005-SKU-CL-NBR            TO TDL-SKU-CLASS.           21760000
217700     MOVE SU005-SKU-NMBR              TO TDL-SKU-NBR.             21770000
217800                                                                  21780000
218300*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  21830000
218400*  *  MISSING TICKET *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  21840000
218500*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  21850000
218600     IF  SU005-MISSING-TICKET          > ZERO                     21860000
218700         MOVE  SU005-MISSING-TICKET   TO TDL-MISSING-TICKET       21870000
218800         SET   PS-PRINT-DETAIL        TO TRUE                     21880000
218900                                                                  21890000
219000         MOVE 'PA-MISSING-TICKET'     TO PV-FIELD-NAME            21900000
219100         COMPUTE PA-MISSING-TICKET =                              21910000
219200                 PA-MISSING-TICKET + SU005-MISSING-TICKET         21920000
219300             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      21930000
219400         END-COMPUTE                                              21940000
219500     END-IF.                                                      21950000
219600                                                                  21960000
219700*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  21970000
219800*  *  WRONG TICKET   *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  21980000
219900*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  21990000
220000     IF  SU005-WRONG-TICKET            > ZERO                     22000000
220100         MOVE  SU005-WRONG-TICKET     TO TDL-WRONG-TICKET         22010000
220200         SET   PS-PRINT-DETAIL        TO TRUE                     22020000
220300                                                                  22030000
220400         MOVE 'PA-WRONG-TICKET'       TO PV-FIELD-NAME            22040000
220500         COMPUTE PA-WRONG-TICKET =                                22050000
220600                 PA-WRONG-TICKET + SU005-WRONG-TICKET             22060000
220700             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      22070000
220800         END-COMPUTE                                              22080000
220900     END-IF.                                                      22090000
221000                                                                  22100000
221100*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  22110000
221200*  *  WRONG LABEL ON TICKET   *  *  *  *  *  *  *  *  *  *  *  *  22120000
221300*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  22130000
221400     IF  SU005-WRONG-LABEL             > ZERO                     22140000
221500         MOVE  SU005-WRONG-LABEL           TO TDL-WRONG-LABEL     22150000
221600         SET   PS-PRINT-DETAIL        TO TRUE                     22160000
221700                                                                  22170000
221800         MOVE 'PA-WRONG-LABEL' TO PV-FIELD-NAME                   22180000
221900         COMPUTE PA-WRONG-LABEL =                                 22190000
222000                 PA-WRONG-LABEL +                                 22200000
222100                 SU005-WRONG-LABEL                                22210000
222200             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      22220000
222300         END-COMPUTE                                              22230000
222400     END-IF.                                                      22240000
222500                                                                  22250000
222600*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  22260000
222700*  *  NO BARCODE  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  22270000
222800*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  22280000
222900     IF  SU005-NO-BARCODE              > ZERO                     22290000
223000         MOVE  SU005-NO-BARCODE TO TDL-NO-BARCODE                 22300000
223100         SET   PS-PRINT-DETAIL        TO TRUE                     22310000
223200                                                                  22320000
223300         MOVE 'PA-NO-BARCODE' TO PV-FIELD-NAME                    22330000
223400         COMPUTE PA-NO-BARCODE = PA-NO-BARCODE + SU005-NO-BARCODE 22340000
223500             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      22350000
223600         END-COMPUTE                                              22360000
223700     END-IF.                                                      22370000
223800                                                                  22380000
223900*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  22390000
224000*  *  DAMAGED BARCODE   *  *  *  *  *  *  *  *  *  *  *  *  *  *  22400000
224100*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  22410000
224200     IF  SU005-DAMAGED-BARCODE         > ZERO                     22420000
224300         MOVE  SU005-DAMAGED-BARCODE TO TDL-DAMAGED-BARCODE       22430000
224400         SET   PS-PRINT-DETAIL        TO TRUE                     22440000
224500                                                                  22450000
224600         MOVE 'PA-DAMAGED-BARCODE' TO PV-FIELD-NAME               22460000
224700         COMPUTE PA-DAMAGED-BARCODE =                             22470000
224800                 PA-DAMAGED-BARCODE + SU005-DAMAGED-BARCODE       22480000
224900             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      22490000
225000         END-COMPUTE                                              22500000
225100     END-IF.                                                      22510000
225200                                                                  22520000
225300*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  22530000
225400*  *  WRONG UPC   *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  22540000
225500*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  22550000
225600     IF  SU005-WRONG-UPC               > ZERO                     22560000
225700         MOVE  SU005-WRONG-UPC       TO TDL-WRONG-UPC             22570000
225800         SET   PS-PRINT-DETAIL        TO TRUE                     22580000
225900                                                                  22590000
226000         MOVE 'PA-WRONG-UPC'       TO PV-FIELD-NAME               22600000
226100         COMPUTE PA-WRONG-UPC       =                             22610000
226200                 PA-WRONG-UPC       + SU005-WRONG-UPC             22620000
226300             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      22630000
226400         END-COMPUTE                                              22640000
226500     END-IF.                                                      22650000
226600                                                                  22660000
226700*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  22670000
226800*  *  NO UPC      *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  22680000
226900*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  22690000
227000     IF  SU005-NO-UPC                  > ZERO                     22700000
227100         MOVE  SU005-NO-UPC          TO TDL-NO-UPC                22710000
227200         SET   PS-PRINT-DETAIL        TO TRUE                     22720000
227300                                                                  22730000
227400         MOVE 'PA-NO-UPC'          TO PV-FIELD-NAME               22740000
227500         COMPUTE PA-NO-UPC          =                             22750000
227600                 PA-NO-UPC          + SU005-NO-UPC                22760000
227700             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      22770000
227800         END-COMPUTE                                              22780000
227900     END-IF.                                                      22790000
228000                                                                  22800000
228100                                                                  22810000
228200*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  22820000
228300*  *  TOTAL ERRORS   *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  22830000
228400*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  22840000
228500     IF  SU005-TOT-TIC-ERR             > ZERO                     22850000
228600         MOVE  SU005-TOT-TIC-ERR      TO TDL-TOTAL-ERRORS         22860000
228700         SET   PS-PRINT-DETAIL        TO TRUE                     22870000
228800                                                                  22880000
228900         MOVE 'PA-TOT-ERRS-TIC'       TO PV-FIELD-NAME            22890000
229000         COMPUTE PA-TOT-ERRS-TIC  =                               22900000
229100                 PA-TOT-ERRS-TIC  + SU005-TOT-TIC-ERR             22910000
229200             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      22920000
229300         END-COMPUTE                                              22930000
229400     END-IF.                                                      22940000
229500                                                                  22950000
229600*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  22960000
229700*  *  UNITS IN ERROR *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  22970000
229800*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  22980000
229900     IF  SU005-TOT-UNITS-IN-TIC-ERR    > ZERO                     22990000
230000         MOVE  SU005-TOT-UNITS-IN-TIC-ERR                         23000000
230100                                      TO TDL-TOTAL-UNITS-IN-ERROR 23010000
230200         SET   PS-PRINT-DETAIL        TO TRUE                     23020000
230300                                                                  23030000
230400         MOVE 'PA-TOT-UNTS-IN-ERR-TIC' TO PV-FIELD-NAME           23040000
230500         COMPUTE PA-TOT-UNTS-IN-ERR-TIC =                         23050000
230600                 PA-TOT-UNTS-IN-ERR-TIC +                         23060000
230700                 SU005-TOT-UNITS-IN-TIC-ERR                       23070000
230800             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      23080000
230900         END-COMPUTE                                              23090000
231000     END-IF.                                                      23100000
231100                                                                  23110000
231200*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  23120000
231300*  *  UNITS TRANSCRIBED *  *  *  *  *  *  *  *  *  *  *  *  *  *  23130000
231400*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  23140000
231500     IF  SU005-UNITS-TRNSCRBD          > ZERO                     23150000
231600         MOVE  SU005-UNITS-TRNSCRBD   TO TDL-TOTAL-UNITS-TRNSCRBD 23160000
231700                                                                  23170000
231800*        IF THERE ARE ERRORS, ADD THE UNITS TRANSCRIBED TO THE    23180000
231900*        TOTAL FOR THOSE SKUS WITH ERRORS.                        23190000
232000         IF PS-PRINT-DETAIL                                       23200000
232100             MOVE 'PA-TOT-UNTS-TRNS-IE-TIC' TO PV-FIELD-NAME      23210000
232200             COMPUTE PA-TOT-UNTS-TRNS-IE-TIC =                    23220000
232300                     PA-TOT-UNTS-TRNS-IE-TIC +                    23230000
232400                     SU005-UNITS-TRNSCRBD                         23240000
232500                 ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR  23250000
232600             END-COMPUTE                                          23260000
232700         ELSE                                                     23270000
232800*        OTHERWISE ADD TO THOSE SKUS WITH NO ERRORS               23280000
232900             MOVE 'PA-TOT-UNTS-TRNS-IE-TIC' TO PV-FIELD-NAME      23290000
233000             COMPUTE PA-TOT-UNTS-TRNS-NE-TIC =                    23300000
233100                     PA-TOT-UNTS-TRNS-NE-TIC +                    23310000
233200                     SU005-UNITS-TRNSCRBD                         23320000
233300                 ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR  23330000
233400             END-COMPUTE                                          23340000
233500         END-IF                                                   23350000
233600*        EITHER WAY ADD TO THE OVERALL TOTAL                      23360000
233700         MOVE 'PA-UNTS-TRNS-TIC'             TO PV-FIELD-NAME     23370000
233800         COMPUTE PA-UNTS-TRNS-TIC =                               23380000
233900                 PA-UNTS-TRNS-TIC +                               23390000
234000                 SU005-UNITS-TRNSCRBD                             23400000
234100             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      23410000
234200         END-COMPUTE                                              23420000
234300     END-IF.                                                      23430000
234400                                                                  23440000
234500*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  23450000
234600*  *  UNITS AUDITED  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  23460000
234700*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  23470000
234800     IF  SU005-UNITS-AUDITED           > ZERO                     23480000
234900         MOVE  SU005-UNITS-AUDITED    TO TDL-TOTAL-UNITS-AUDITED  23490000
235000                                                                  23500000
235100*        IF THERE ARE ERRORS, ADD THE UNITS AUDITED TO THE BUCKET 23510000
235200*        TOTAL FOR THOSE SKUS WITH ERRORS.                        23520000
235300         IF PS-PRINT-DETAIL                                       23530000
235400             MOVE 'PA-TOT-UNTS-AUD-IE-TIC' TO PV-FIELD-NAME       23540000
235500             COMPUTE PA-TOT-UNTS-AUD-IE-TIC =                     23550000
235600                     PA-TOT-UNTS-AUD-IE-TIC +                     23560000
235700                     SU005-UNITS-AUDITED                          23570000
235800                 ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR  23580000
235900             END-COMPUTE                                          23590000
236000         ELSE                                                     23600000
236100*        OTHERWISE ADD TO THOSE SKUS WITH NO ERRORS               23610000
236200             MOVE 'PA-TOT-UNTS-AUD-NE-TIC' TO PV-FIELD-NAME       23620000
236300             COMPUTE PA-TOT-UNTS-AUD-NE-TIC =                     23630000
236400                     PA-TOT-UNTS-AUD-NE-TIC +                     23640000
236500                     SU005-UNITS-AUDITED                          23650000
236600                 ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR  23660000
236700             END-COMPUTE                                          23670000
236800         END-IF                                                   23680000
236900*        EITHER WAY ADD TO THE OVERALL TOTAL                      23690000
237000         MOVE 'PA-UNTS-AUD-PIC'             TO PV-FIELD-NAME      23700000
237100         COMPUTE PA-UNTS-AUD-TIC       =                          23710000
237200                 PA-UNTS-AUD-TIC       +                          23720000
237300                 SU005-UNITS-AUDITED                              23730000
237400             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      23740000
237500         END-COMPUTE                                              23750000
237600     END-IF.                                                      23760000
237700                                                                  23770000
237800*    IF ANY ERRORS FOUND, PRINT THE DETAIL...IF NOT, ADD TO THE   23780000
237900*    TOTALS OF THE SKUS WITH NO ERRORS                            23790000
238000     IF PS-PRINT-DETAIL                                           23800000
238100*        IF A SPOT ERROR USE THE UNITS AUDITED TO CALCULATE THE   23810000
238200*        ERROR RATIO -- OTHERWISE USE THE UNITS TRANSCRIBED       23820000
238300         IF PV-SPOT-AUDIT-CHECK                                   23830000
238400             IF SU005-UNITS-AUDITED > ZERO                        23840000
238500                 COMPUTE PV-ERROR-RATIO  =                        23850000
238600                     (SU005-TOT-UNITS-IN-TIC-ERR /                23860000
238700                      SU005-UNITS-AUDITED)  * 100                 23870000
238800                 MOVE PV-ERROR-RATIO    TO TDL-ERROR-RATIO        23880000
238900             ELSE                                                 23890000
239000                 IF SU005-TOT-UNITS-IN-TIC-ERR  > ZERO            23900000
239100                     MOVE 100           TO TDL-ERROR-RATIO        23910000
239200                 ELSE                                             23920000
239300                     MOVE ZERO          TO TDL-ERROR-RATIO        23930000
239400                 END-IF                                           23940000
239500             END-IF                                               23950000
239600         ELSE                                                     23960000
239700             IF SU005-UNITS-TRNSCRBD > ZERO                       23970000
239800                 COMPUTE PV-ERROR-RATIO  =                        23980000
239900                     (SU005-TOT-UNITS-IN-TIC-ERR /                23990000
240000                      SU005-UNITS-TRNSCRBD)  * 100                24000000
240100                 MOVE PV-ERROR-RATIO    TO TDL-ERROR-RATIO        24010000
240200             ELSE                                                 24020000
240300                 IF SU005-TOT-UNITS-IN-TIC-ERR  > ZERO            24030000
240400                     MOVE 100           TO TDL-ERROR-RATIO        24040000
240500                 ELSE                                             24050000
240600                     MOVE ZERO          TO TDL-ERROR-RATIO        24060000
240700                 END-IF                                           24070000
240800             END-IF                                               24080000
240900         END-IF                                                   24090000
241000                                                                  24100000
241100         MOVE '%'                   TO PDL-PERCENT                24110000
241200                                                                  24120000
241300         IF (PV-DETAIL-LINE-COUNT + 1) > PC-MAX-REPORT-LINES      24130000
241400             PERFORM 3000-PRINT-PAGE-HEADING                      24140000
241600             PERFORM 2320-PRINT-TICK-HEADINGS                     24160000
241700         END-IF                                                   24170000
241800                                                                  24180000
241900*        GET THE LINE NUMBER                                      24190000
242000         PERFORM 8100-GET-LINE-NUMBER                             24200000
242100         EVALUATE TRUE                                            24210000
242200           WHEN SQLCODE = -811                                    24220000
242300             MOVE 'MULT'            TO TDL-LINE-NBR-X             24230000
242400           WHEN SQLCODE = +100                                    24240000
242500             MOVE ' N/A'            TO TDL-LINE-NBR-X             24250000
242600           WHEN OTHER                                             24260000
242700             MOVE PURITM-APP-PO-LNE-NBR                           24270000
242800                                    TO TDL-LINE-NBR               24280000
242900         END-EVALUATE                                             24290000
243000                                                                  24300000
243010         IF  CC-FLAT-FILE                                         24301093
243040             WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                  24304093
243050              FROM TDL-TICKETING-DETAIL-LINE                      24305093
243060         ELSE                                                     24306093
243100             WRITE AS-AUDIT-SUM-REPORT-LINE                       24310093
243200              FROM TDL-TICKETING-DETAIL-LINE                      24320093
243300             AFTER ADVANCING 1 LINES                              24330000
243400             WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                   24340093
243500              FROM TDL-TICKETING-DETAIL-LINE                      24350093
243600             AFTER ADVANCING 1 LINES                              24360000
243610         END-IF                                                   24361093
243620                                                                  24362093
243700         ADD +1                     TO PV-DETAIL-LINE-COUNT       24370000
243800                                       PA-SKUS-W-ERRS-TIC         24380000
243900                                       PA-SKU-COUNT-TIC           24390000
244000     ELSE                                                         24400000
244100         ADD +1                     TO PA-SKUS-W-NO-ERRS-TIC      24410000
244200                                       PA-SKU-COUNT-TIC           24420000
244300     END-IF.                                                      24430000
244400                                                                  24440000
244500     PERFORM 8001-READ-EXTRACT-FILE.                              24450000
244600                                                                  24460000
244700                                                                  24470000
244800******************************************************************24480000
244900* 2310-CREATE-TICKETING-SUMMARY.                                  24490000
245000*  -PRINT THE ERROR AND NO-ERROR SUB TOTALS AND A PICK TOTAL LINE 24500000
245100******************************************************************24510000
245200 2310-CREATE-TICKETING-SUMMARY.                                   24520000
245300                                                                  24530000
245400*    IF THE SUMMARY WON'T FIT ON THE PAGE, GO TO THE NEXT ONE     24540000
245500     IF (PV-DETAIL-LINE-COUNT + 4) > PC-MAX-REPORT-LINES          24550000
245600         PERFORM 3000-PRINT-PAGE-HEADING                          24560000
245800     END-IF                                                       24580000
245900                                                                  24590000
246000*    WRITE SUMMARY LINE FOR THE SKUS WITH ERRORS                  24600000
246100     INITIALIZE TTL-TICKETING-TOTAL-LINE.                         24610000
246200     MOVE '  SKUS W/ERRS'             TO TTL-TOTAL-DESCRIPTION.   24620000
246300     MOVE PA-SKUS-W-ERRS-TIC          TO TTL-SKU-COUNT.           24630000
246400     MOVE PA-MISSING-TICKET           TO TTL-MISSING-TICKET.      24640000
246500     MOVE PA-WRONG-TICKET             TO TTL-WRONG-TICKET.        24650000
246600     MOVE PA-WRONG-LABEL              TO TTL-WRONG-LABEL.         24660000
246700     MOVE PA-NO-BARCODE               TO TTL-NO-BARCODE.          24670000
246800     MOVE PA-DAMAGED-BARCODE          TO TTL-DAMAGED-BARCODE.     24680000
246900     MOVE PA-WRONG-UPC                TO TTL-WRONG-UPC.           24690000
247000     MOVE PA-NO-UPC                   TO TTL-NO-UPC.              24700000
247100     MOVE PA-TOT-ERRS-TIC             TO TTL-TOTAL-ERRORS.        24710000
247200     MOVE PA-TOT-UNTS-IN-ERR-TIC      TO TTL-TOTAL-UNITS-IN-ERROR.24720000
247300     MOVE PA-TOT-UNTS-TRNS-IE-TIC     TO TTL-TOTAL-UNITS-TRNSCRBD.24730000
247400     MOVE PA-TOT-UNTS-AUD-IE-TIC      TO TTL-TOTAL-UNITS-AUDITED. 24740000
247500     MOVE SPACES                      TO TTL-PERCENT              24750000
247600                                         TTL-ERROR-RATIO-X.       24760000
247700                                                                  24770000
247800     IF  CC-FLAT-FILE                                             24780093
248100         MOVE SPACES  TO  AS-AUDIT-SUM-REPORT-LINE-FLAT           24810093
248200         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      24820093
248300         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      24830093
248400          FROM TTL-TICKETING-TOTAL-LINE                           24840093
248500     ELSE                                                         24850093
250800         WRITE AS-AUDIT-SUM-REPORT-LINE                           25080093
250900          FROM TTL-TICKETING-TOTAL-LINE                           25090093
251000         AFTER ADVANCING 2 LINES                                  25100093
251100         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       25110093
251200          FROM TTL-TICKETING-TOTAL-LINE                           25120093
251300         AFTER ADVANCING 2 LINES                                  25130093
251310     END-IF.                                                      25131093
251320                                                                  25132093
251400     ADD +2                           TO PV-DETAIL-LINE-COUNT.    25140000
251500                                                                  25150000
251600*    WRITE SUMMARY LINE FOR THE SKUS WITH NO ERRORS               25160000
251700     INITIALIZE TTL-TICKETING-TOTAL-LINE.                         25170000
251800     MOVE ' SKUS WO/ERRS'             TO TTL-TOTAL-DESCRIPTION.   25180000
251900     MOVE PA-SKUS-W-NO-ERRS-TIC       TO TTL-SKU-COUNT.           25190000
252000     MOVE PA-TOT-UNTS-TRNS-NE-TIC     TO TTL-TOTAL-UNITS-TRNSCRBD.25200000
252100     MOVE PA-TOT-UNTS-AUD-NE-TIC      TO TTL-TOTAL-UNITS-AUDITED. 25210000
252200     MOVE SPACES                      TO TTL-PERCENT              25220000
252300                                         TTL-ERROR-RATIO-X.       25230000
252310                                                                  25231093
252320     IF  CC-FLAT-FILE                                             25232093
252350         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      25235093
252360          FROM TTL-TICKETING-TOTAL-LINE                           25236093
252370     ELSE                                                         25237093
252400         WRITE AS-AUDIT-SUM-REPORT-LINE                           25240093
252500          FROM TTL-TICKETING-TOTAL-LINE                           25250093
252600         AFTER ADVANCING 1 LINES                                  25260093
252700         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       25270093
252800          FROM TTL-TICKETING-TOTAL-LINE                           25280093
252900         AFTER ADVANCING 1 LINES                                  25290093
252910     END-IF.                                                      25291093
252920                                                                  25292093
253000     ADD +1                           TO PV-DETAIL-LINE-COUNT.    25300000
253100                                                                  25310000
253200*    WRITE SUMMARY LINE FOR THE TICKETING TOTALS                  25320000
253300     INITIALIZE TTL-TICKETING-TOTAL-LINE.                         25330000
253400     MOVE '   TICK TOTAL'             TO TTL-TOTAL-DESCRIPTION.   25340000
253500     MOVE PA-SKU-COUNT-TIC            TO TTL-SKU-COUNT.           25350000
253600     MOVE PA-MISSING-TICKET           TO TTL-MISSING-TICKET.      25360000
253700     MOVE PA-WRONG-TICKET             TO TTL-WRONG-TICKET.        25370000
253800     MOVE PA-WRONG-LABEL              TO TTL-WRONG-LABEL.         25380000
253900     MOVE PA-NO-BARCODE               TO TTL-NO-BARCODE.          25390000
254000     MOVE PA-DAMAGED-BARCODE          TO TTL-DAMAGED-BARCODE.     25400000
254100     MOVE PA-WRONG-UPC                TO TTL-WRONG-UPC.           25410000
254200     MOVE PA-NO-UPC                   TO TTL-NO-UPC.              25420000
254300     MOVE PA-TOT-ERRS-TIC             TO TTL-TOTAL-ERRORS.        25430000
254400     MOVE PA-TOT-UNTS-IN-ERR-TIC      TO TTL-TOTAL-UNITS-IN-ERROR.25440000
254500     MOVE PA-UNTS-TRNS-TIC            TO TTL-TOTAL-UNITS-TRNSCRBD.25450000
254600     MOVE PA-UNTS-AUD-TIC             TO TTL-TOTAL-UNITS-AUDITED. 25460000
254700     MOVE '%'                         TO TTL-PERCENT.             25470000
254800                                                                  25480000
254900*    IF A SPOT ERROR USE THE UNITS AUDITED TO CALCULATE THE       25490000
255000*    ERROR RATIO -- OTHERWISE USE THE UNITS TRANSCRIBED           25500000
255100     IF PV-SPOT-AUDIT-CHECK                                       25510000
255200         IF PA-UNTS-AUD-TIC > ZERO                                25520000
255300             COMPUTE PV-ERROR-RATIO  =                            25530000
255400             (PA-TOT-UNTS-IN-ERR-TIC / PA-UNTS-AUD-TIC) * 100     25540000
255500             MOVE PV-ERROR-RATIO          TO TTL-ERROR-RATIO      25550000
255600         ELSE                                                     25560000
255700             IF PA-TOT-UNTS-IN-ERR-TIC  > ZERO                    25570000
255800                 MOVE 100                TO TTL-ERROR-RATIO       25580000
255900             ELSE                                                 25590000
256000                 MOVE ZERO               TO TTL-ERROR-RATIO       25600000
256100             END-IF                                               25610000
256200         END-IF                                                   25620000
256300     ELSE                                                         25630000
256400         IF PA-UNTS-TRNS-TIC > ZERO                               25640000
256500             COMPUTE PV-ERROR-RATIO  =                            25650000
256600             (PA-TOT-UNTS-IN-ERR-TIC / PA-UNTS-TRNS-TIC) * 100    25660000
256700             MOVE PV-ERROR-RATIO          TO TTL-ERROR-RATIO      25670000
256800         ELSE                                                     25680000
256900             IF PA-TOT-UNTS-IN-ERR-TIC  > ZERO                    25690000
257000                 MOVE 100                TO TTL-ERROR-RATIO       25700000
257100             ELSE                                                 25710000
257200                 MOVE ZERO               TO TTL-ERROR-RATIO       25720000
257300             END-IF                                               25730000
257400         END-IF                                                   25740000
257500     END-IF.                                                      25750000
257600                                                                  25760000
257610     IF  CC-FLAT-FILE                                             25761093
257640         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      25764093
257650          FROM TTL-TICKETING-TOTAL-LINE                           25765093
257660     ELSE                                                         25766093
257700         WRITE AS-AUDIT-SUM-REPORT-LINE                           25770093
257800          FROM TTL-TICKETING-TOTAL-LINE                           25780093
257900         AFTER ADVANCING 1 LINES                                  25790093
258000         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       25800093
258100          FROM TTL-TICKETING-TOTAL-LINE                           25810093
258200         AFTER ADVANCING 1 LINES                                  25820093
258210     END-IF.                                                      25821093
258220                                                                  25822093
258300     ADD +1                           TO PV-DETAIL-LINE-COUNT.    25830000
258400                                                                  25840000
258500                                                                  25850000
258600******************************************************************25860000
258700* 2320-PRINT-TICK-HEADINGS                                        25870000
258800*  -PRINT THE DETAIL HEADINGS FOR THE TICKETING ERRORS            25880000
258900******************************************************************25890000
259000 2320-PRINT-TICK-HEADINGS.                                        25900000
259100                                                                  25910000
259200*    IF THE HEADINGS + 1 DETAIL LINE WON'T FIT, GOTO THE NEXT PGE 25920000
259300     IF (PV-DETAIL-LINE-COUNT + 8) > PC-MAX-REPORT-LINES          25930000
259400         PERFORM 3000-PRINT-PAGE-HEADING                          25940000
259500*                                                                 25950073
259600     END-IF                                                       25960000
259700     SET PS-DONT-PRINT-TICK-HEADING TO TRUE                       25970000
259800                                                                  25980000
259810     IF  CC-FLAT-FILE                                             25981093
259840         MOVE SPACES  TO  AS-AUDIT-SUM-REPORT-LINE-FLAT           25984093
259850         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      25985093
259860         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      25986093
259870          FROM TDH1-TICK-DETAIL-HEADING-1                         25987093
259880     ELSE                                                         25988093
259900         WRITE AS-AUDIT-SUM-REPORT-LINE                           25990093
260000          FROM TDH1-TICK-DETAIL-HEADING-1                         26000093
260100         AFTER ADVANCING 2 LINES                                  26010093
260200         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       26020093
260300          FROM TDH1-TICK-DETAIL-HEADING-1                         26030093
260400         AFTER ADVANCING 2 LINES                                  26040093
260410     END-IF.                                                      26041093
260420                                                                  26042093
260500                                                                  26050000
260510     IF  CC-FLAT-FILE                                             26051093
260560         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      26056093
260570          FROM TDH2-TICK-DETAIL-HEADING-2                         26057093
260580     ELSE                                                         26058093
260600         WRITE AS-AUDIT-SUM-REPORT-LINE                           26060093
260700          FROM TDH2-TICK-DETAIL-HEADING-2                         26070093
260800         AFTER ADVANCING 2 LINES                                  26080093
260900         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       26090093
261000          FROM TDH2-TICK-DETAIL-HEADING-2                         26100093
261100         AFTER ADVANCING 2 LINES                                  26110093
261110     END-IF.                                                      26111093
261200                                                                  26120000
261210     IF  CC-FLAT-FILE                                             26121093
261220         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      26122093
261230          FROM TDH3-TICK-DETAIL-HEADING-3                         26123093
261240     ELSE                                                         26124093
261300         WRITE AS-AUDIT-SUM-REPORT-LINE                           26130093
261400          FROM TDH3-TICK-DETAIL-HEADING-3                         26140093
261500         AFTER ADVANCING 1 LINES                                  26150093
261600         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       26160093
261700          FROM TDH3-TICK-DETAIL-HEADING-3                         26170093
261800         AFTER ADVANCING 1 LINES                                  26180093
261810     END-IF.                                                      26181093
261900                                                                  26190000
262000     ADD +5                           TO PV-DETAIL-LINE-COUNT.    26200000
262200                                                                  26220000
262300                                                                  26230000
262400******************************************************************26240000
262500* 2400-PRINT-FOOTER.                                              26250000
262600******************************************************************26260000
262700 2400-PRINT-FOOTER.                                               26270000
262800                                                                  26280000
262900*    IF THE FOOTER LINE WON'T FIT, GOTO THE NEXT PGE              26290000
263000     IF (PV-DETAIL-LINE-COUNT + 5) > PC-MAX-REPORT-LINES          26300000
263100         PERFORM 3000-PRINT-PAGE-HEADING                          26310000
263300     END-IF.                                                      26330000
263400                                                                  26340000
263500     INITIALIZE TRL-TOTAL-RATIO-LINE.                             26350000
263600     MOVE '  TOTAL PICKING ERROR RATIO -  '                       26360000
263700                                TO TRL-TOTAL-RATIO-DESC.          26370000
263800                                                                  26380000
263900*    IF A SPOT ERROR USE THE UNITS AUDITED TO CALCULATE THE       26390000
264000*    ERROR RATIO -- OTHERWISE USE THE UNITS TRANSCRIBED           26400000
264100     IF PV-SPOT-AUDIT-CHECK                                       26410000
264200         IF PA-UNTS-AUD-PIC > ZERO                                26420000
264300            COMPUTE PV-ERROR-RATIO  =                             26430000
264400               (PA-TOT-UNTS-IN-ERR-PIC /                          26440000
264500                PA-UNTS-AUD-PIC) * 100                            26450000
264600            MOVE PV-ERROR-RATIO           TO TRL-TOTAL-RATIO      26460000
264700         ELSE                                                     26470000
264800             IF PA-TOT-UNTS-IN-ERR-PIC  > ZERO                    26480000
264900                 MOVE 100                TO TRL-TOTAL-RATIO       26490000
265000             ELSE                                                 26500000
265100                 MOVE ZERO               TO TRL-TOTAL-RATIO       26510000
265200             END-IF                                               26520000
265300         END-IF                                                   26530000
265400     ELSE                                                         26540000
265500         IF PA-UNTS-TRNS-PIC > ZERO                               26550000
265600            COMPUTE PV-ERROR-RATIO  =                             26560000
265700               (PA-TOT-UNTS-IN-ERR-PIC /                          26570000
265800                PA-UNTS-TRNS-PIC) * 100                           26580000
265900            MOVE PV-ERROR-RATIO           TO TRL-TOTAL-RATIO      26590000
266000         ELSE                                                     26600000
266100             IF PA-TOT-UNTS-IN-ERR-PIC  > ZERO                    26610000
266200                 MOVE 100                TO TRL-TOTAL-RATIO       26620000
266300             ELSE                                                 26630000
266400                 MOVE ZERO               TO TRL-TOTAL-RATIO       26640000
266500             END-IF                                               26650000
266600         END-IF                                                   26660000
266700     END-IF.                                                      26670000
266800*                                                                 26680000
266810     IF  CC-FLAT-FILE                                             26681093
266840         MOVE SPACES  TO  AS-AUDIT-SUM-REPORT-LINE-FLAT           26684093
266850         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      26685093
266860         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      26686093
266870          FROM TRL-TOTAL-RATIO-LINE                               26687093
266880     ELSE                                                         26688093
266900         WRITE AS-AUDIT-SUM-REPORT-LINE                           26690093
267000          FROM TRL-TOTAL-RATIO-LINE                               26700093
267100         AFTER ADVANCING 2 LINES                                  26710093
267200         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       26720093
267300          FROM TRL-TOTAL-RATIO-LINE                               26730093
267400         AFTER ADVANCING 2 LINES                                  26740093
267410     END-IF.                                                      26741093
267420                                                                  26742093
267500     ADD +2                           TO PV-DETAIL-LINE-COUNT.    26750000
267600                                                                  26760000
267700                                                                  26770000
267800     INITIALIZE TRL-TOTAL-RATIO-LINE.                             26780000
267900     MOVE 'TOTAL TICKETING ERROR RATIO -  '                       26790000
268000                                TO TRL-TOTAL-RATIO-DESC.          26800000
268100                                                                  26810000
268200*    IF A SPOT ERROR USE THE UNITS AUDITED TO CALCULATE THE       26820000
268300*    ERROR RATIO -- OTHERWISE USE THE UNITS TRANSCRIBED           26830000
268400     IF PV-SPOT-AUDIT-CHECK                                       26840000
268500         IF PA-UNTS-AUD-TIC > ZERO                                26850000
268600             COMPUTE PV-ERROR-RATIO  =                            26860000
268700             (PA-TOT-UNTS-IN-ERR-TIC / PA-UNTS-AUD-TIC) * 100     26870000
268800             MOVE PV-ERROR-RATIO          TO TRL-TOTAL-RATIO      26880000
268900         ELSE                                                     26890000
269000             IF PA-TOT-UNTS-IN-ERR-TIC  > ZERO                    26900000
269100                 MOVE 100                TO TRL-TOTAL-RATIO       26910000
269200             ELSE                                                 26920000
269300                 MOVE ZERO               TO TRL-TOTAL-RATIO       26930000
269400             END-IF                                               26940000
269500         END-IF                                                   26950000
269600     ELSE                                                         26960000
269700         IF PA-UNTS-TRNS-TIC > ZERO                               26970000
269800             COMPUTE PV-ERROR-RATIO  =                            26980000
269900             (PA-TOT-UNTS-IN-ERR-TIC / PA-UNTS-TRNS-TIC) * 100    26990000
270000             MOVE PV-ERROR-RATIO          TO TRL-TOTAL-RATIO      27000000
270100         ELSE                                                     27010000
270200             IF PA-TOT-UNTS-IN-ERR-TIC  > ZERO                    27020000
270300                 MOVE 100                TO TRL-TOTAL-RATIO       27030000
270400             ELSE                                                 27040000
270500                 MOVE ZERO               TO TRL-TOTAL-RATIO       27050000
270600             END-IF                                               27060000
270700         END-IF                                                   27070000
270800     END-IF.                                                      27080000
270900*                                                                 27090000
270910     IF  CC-FLAT-FILE                                             27091093
270940         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      27094093
270950          FROM TRL-TOTAL-RATIO-LINE                               27095093
270960     ELSE                                                         27096093
271000         WRITE AS-AUDIT-SUM-REPORT-LINE                           27100093
271100          FROM TRL-TOTAL-RATIO-LINE                               27110093
271200         AFTER ADVANCING 1 LINES                                  27120093
271300         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       27130093
271400          FROM TRL-TOTAL-RATIO-LINE                               27140093
271500         AFTER ADVANCING 1 LINES                                  27150093
271510     END-IF.                                                      27151093
271520                                                                  27152093
271600     ADD +1                           TO PV-DETAIL-LINE-COUNT.    27160000
271700                                                                  27170000
271800                                                                  27180000
271900     INITIALIZE TRL-TOTAL-RATIO-LINE.                             27190000
272000     MOVE '          TOTAL ERROR RATIO -  '                       27200000
272100                                TO TRL-TOTAL-RATIO-DESC.          27210000
272200*    IF A SPOT CHECK, CALCULATE THE ERROR RATIO USING THE NUMBER  27220000
272300*    OF UNITS TRANSCRIBED, AND THE TOTAL NUMBER OF UNITS IN       27230000
272400*    ERROR                                                        27240000
272500     IF PV-SPOT-AUDIT-CHECK                                       27250000
272600         IF PV-AUDIT-UNIT-COUNT > ZERO                            27260000
272700             COMPUTE PV-ERROR-RATIO  =                            27270000
272800                ( PA-NET-UNTS-IN-ERROR  /                         27280000
272900                  PV-AUDIT-UNIT-COUNT) * 100                      27290000
273000             MOVE PV-ERROR-RATIO    TO TRL-TOTAL-RATIO            27300000
273100         ELSE                                                     27310000
273200             IF PA-NET-UNTS-IN-ERROR   > ZERO                     27320000
273300                 MOVE 100                TO TRL-TOTAL-RATIO       27330000
273400             ELSE                                                 27340000
273500                 MOVE ZERO               TO TRL-TOTAL-RATIO       27350000
273600             END-IF                                               27360000
273700         END-IF                                                   27370000
273800     ELSE                                                         27380000
273900         IF PV-UNITS-TRNSCRBD > ZERO                              27390000
274000             COMPUTE PV-ERROR-RATIO  =                            27400000
274100                ( PA-NET-UNTS-IN-ERROR  /                         27410000
274200                  PV-UNITS-TRNSCRBD) * 100                        27420000
274300             MOVE PV-ERROR-RATIO    TO TRL-TOTAL-RATIO            27430000
274400         ELSE                                                     27440000
274500             IF PA-NET-UNTS-IN-ERROR   > ZERO                     27450000
274600                 MOVE 100                TO TRL-TOTAL-RATIO       27460000
274700             ELSE                                                 27470000
274800                 MOVE ZERO               TO TRL-TOTAL-RATIO       27480000
274900             END-IF                                               27490000
275000         END-IF                                                   27500000
275100     END-IF.                                                      27510000
275200*                                                                 27520000
275210     IF  CC-FLAT-FILE                                             27521093
275240         MOVE SPACES  TO  AS-AUDIT-SUM-REPORT-LINE-FLAT           27524093
275250         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      27525093
275260         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      27526093
275270          FROM TRL-TOTAL-RATIO-LINE                               27527093
275280     ELSE                                                         27528093
275300         WRITE AS-AUDIT-SUM-REPORT-LINE                           27530093
275400          FROM TRL-TOTAL-RATIO-LINE                               27540093
275500         AFTER ADVANCING 2 LINES                                  27550093
275600         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       27560093
275700          FROM TRL-TOTAL-RATIO-LINE                               27570093
275800         AFTER ADVANCING 2 LINES                                  27580093
275810     END-IF.                                                      27581093
275820                                                                  27582093
275900     ADD +2                           TO PV-DETAIL-LINE-COUNT.    27590000
276000                                                                  27600000
276100*    BLANK LINE BETWEEN SUMMAY AND THE AUDITED STORE LIST         27610000
276110                                                                  27611093
276120     IF  CC-FLAT-FILE                                             27612093
276130         MOVE SPACES  TO  AS-AUDIT-SUM-REPORT-LINE-FLAT           27613093
276140         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      27614093
276150     ELSE                                                         27615093
276200         WRITE AS-AUDIT-SUM-REPORT-LINE                           27620093
276300          FROM BLANK-LINE                                         27630093
276400         AFTER ADVANCING 1 LINES                                  27640093
276500         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       27650093
276600          FROM BLANK-LINE                                         27660093
276700         AFTER ADVANCING 1 LINES                                  27670093
276710     END-IF.                                                      27671093
276720                                                                  27672093
276800     ADD  +1                          TO PV-DETAIL-LINE-COUNT.    27680000
276900                                                                  27690000
277000*    LIST THE STORES THAT WERE CHECKED IN THIS AUDIT              27700000
277100     PERFORM 2420-PRINT-AUD-STR-LIST.                             27710000
277200                                                                  27720000
277300*    BLANK LINE BETWEEN THE AUDITED STORE LIST AND SPOT PERCENT   27730000
277310                                                                  27731093
277320     IF  CC-FLAT-FILE                                             27732093
277330         MOVE SPACES  TO  AS-AUDIT-SUM-REPORT-LINE-FLAT           27733093
277340         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      27734093
277350     ELSE                                                         27735093
277400         WRITE AS-AUDIT-SUM-REPORT-LINE                           27740093
277500          FROM BLANK-LINE                                         27750093
277600         AFTER ADVANCING 1 LINES                                  27760093
277700         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       27770093
277800          FROM BLANK-LINE                                         27780093
277900         AFTER ADVANCING 1 LINES                                  27790093
277910     END-IF.                                                      27791093
277920                                                                  27792093
278000     ADD  +1                          TO PV-DETAIL-LINE-COUNT.    27800000
278100                                                                  27810000
278200                                                                  27820000
278300     PERFORM 2410-GET-SPOT-PERCENT.                               27830000
278400*    IF MORE AUDITING NEEDS TO BE DONE (THE MIN IS MORE THAN WHAT 27840000
278500*    HAS BEEN AUDITED) TO SATISFY A SPOT-CHECK, WRITE A MESSAGE   27850000
278600*    TELLING THE USER THAT MORE NEEDS TO BE CHECKED.              27860000
278700     IF ((RECEIV-ACTL-CART-CNT * PV-SPOT-PERCENT) >               27870000
278800          PV-AUDIT-CARTON-COUNT)                                  27880000
278900     AND PV-SPOT-AUDIT-CHECK                                      27890000
278910                                                                  27891093
278920         IF  CC-FLAT-FILE                                         27892093
278950             WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                  27895093
278960              FROM ARL1-AUDITING-REQUIRED-LINE-1                  27896093
278970         ELSE                                                     27897093
279000             WRITE AS-AUDIT-SUM-REPORT-LINE                       27900093
279100              FROM ARL1-AUDITING-REQUIRED-LINE-1                  27910093
279200             AFTER ADVANCING 1 LINES                              27920000
279300             WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                   27930093
279400              FROM ARL1-AUDITING-REQUIRED-LINE-1                  27940093
279500             AFTER ADVANCING 1 LINES                              27950000
279510         END-IF                                                   27951093
279600                                                                  27960000
279610         IF  CC-FLAT-FILE                                         27961093
279640             WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                  27964093
279650              FROM ARL2-AUDITING-REQUIRED-LINE-2                  27965093
279660         ELSE                                                     27966093
279700             WRITE AS-AUDIT-SUM-REPORT-LINE                       27970093
279800              FROM ARL2-AUDITING-REQUIRED-LINE-2                  27980093
279900             AFTER ADVANCING 1 LINES                              27990000
280000             WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                   28000093
280100              FROM ARL2-AUDITING-REQUIRED-LINE-2                  28010093
280200             AFTER ADVANCING 1 LINES                              28020000
280210         END-IF                                                   28021093
280220                                                                  28022093
280230         IF  CC-FLAT-FILE                                         28023093
280260             WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                  28026093
280270              FROM ARL1-AUDITING-REQUIRED-LINE-1                  28027093
280280         ELSE                                                     28028093
280400             WRITE AS-AUDIT-SUM-REPORT-LINE                       28040093
280500              FROM ARL1-AUDITING-REQUIRED-LINE-1                  28050093
280600             AFTER ADVANCING 1 LINES                              28060000
280700             WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                   28070093
280800              FROM ARL1-AUDITING-REQUIRED-LINE-1                  28080093
280900             AFTER ADVANCING 1 LINES                              28090000
280910         END-IF                                                   28091093
281000     END-IF.                                                      28100000
281100                                                                  28110000
281200                                                                  28120000
281300******************************************************************28130000
281400* 2410-GET-SPOT-PERCENT                                           28140000
281500*    THIS PARAGRAPH WILL SELECT THE SPOT PERCENT                  28150000
281600******************************************************************28160000
281700 2410-GET-SPOT-PERCENT.                                           28170000
281800                                                                  28180000
281900     EXEC SQL                                                     28190000
282000         SELECT                                                   28200000
282100                 CA_SPTCK_DFLT_PCT / 100                          28210000
282200         INTO                                                     28220000
282300                :PV-SPOT-PERCENT                                  28230000
282400         FROM                                                     28240000
282500                TCOCNTL                                           28250000
282600         WHERE                                                    28260000
282700             OPER_UNT_ID  = :DK-OPER-UNT-ID                       28270000
282800         AND FCLTY_ID     = 1                                     28280000
282900     END-EXEC.                                                    28290000
283000                                                                  28300000
283100     EVALUATE TRUE                                                28310000
283200         WHEN SQLCODE = ZERO                                      28320000
283300              CONTINUE                                            28330000
283400         WHEN OTHER                                               28340000
283500              DISPLAY 'OPER-UNT-ID = ' DK-OPER-UNT-ID             28350000
283600              MOVE '2410-GET-SPOT-PERCENT'                        28360000
283700                               TO  PV-PARAGRAPH-NAME              28370000
283800              MOVE 'SELECT OF TCOCNTL'                            28380000
283900                               TO  PV-DB2-OPERATION-ATTEMPTED     28390000
284000              PERFORM 9999-SQL-ABEND                              28400000
284100     END-EVALUATE.                                                28410000
284200                                                                  28420000
284300                                                                  28430000
284400******************************************************************28440000
284500* 2420-PRINT-AUD-STR-LIST.                                        28450000
284600*    THIS PARAGRAPH WILL PRINT THE LIST OF STORES THAT WERE       28460000
284700*    AUDITED IN THIS AUDIT/PO/RECEIVER                            28470000
284800******************************************************************28480000
284900 2420-PRINT-AUD-STR-LIST.                                         28490000
285000                                                                  28500000
285100     INITIALIZE  AS1-AUDITED-STORES-1.                            28510000
285200                                                                  28520000
285300     DIVIDE PV-STR-COUNT BY PC-MAX-STRS-PER-LINE                  28530000
285400     GIVING PV-STR-LINES                                          28540000
285500     REMAINDER PV-STR-REMAINDER.                                  28550000
285600                                                                  28560000
285700     IF PV-STR-REMAINDER > +0                                     28570000
285800        ADD +1           TO PV-STR-LINES                          28580000
285900     END-IF.                                                      28590000
286000                                                                  28600000
286100*    IF THE LIST OF STORES WON'T FIT, GOTO THE NEXT PAGE          28610000
286200     IF (PV-DETAIL-LINE-COUNT + PV-STR-LINES)                     28620000
286300                              > PC-MAX-REPORT-LINES               28630000
286400         PERFORM 3000-PRINT-PAGE-HEADING                          28640000
286600     END-IF.                                                      28660000
286700                                                                  28670000
286800     SET  PV-AUD-STR-IDX                                          28680000
286900          AS1-AUD-STR-IDX       TO +1.                            28690000
287000     SET  PV-AUD-STR-IDX                                          28700000
287100          AS1-AUD-STR-IDX DOWN BY +1.                             28710000
287200                                                                  28720000
287300     MOVE 'STORES AUDITED: '    TO AS1-AUDITED-STORE-DESC.        28730000
287400                                                                  28740000
287500     PERFORM UNTIL PV-AUD-STR-IDX >= PV-STR-COUNT                 28750000
287600         IF AS1-AUD-STR-IDX > +0                                  28760000
287700             MOVE ','           TO AS1-COMMA (AS1-AUD-STR-IDX)    28770000
287800         END-IF                                                   28780000
287900                                                                  28790000
288000         SET AS1-AUD-STR-IDX                                      28800000
288100             PV-AUD-STR-IDX     UP BY +1                          28810000
288200                                                                  28820000
288300*        IF THE CURRENT DETAIL PRINT LINE IS FULL, PRINT IT OUT.  28830000
288400         IF AS1-AUD-STR-IDX > PC-MAX-STRS-PER-LINE                28840000
288500             PERFORM 2421-PRINT-AUDITED-STORE-LINE                28850000
288600                                                                  28860000
288700             INITIALIZE AS1-AUDITED-STORES-1                      28870000
288800             SET AS1-AUD-STR-IDX   TO +1                          28880000
288900         END-IF                                                   28890000
289000                                                                  28900000
289100*        MOVE THIS STORE NUMBER TO THE NEXT DETAIL LINE BUCKET    28910000
289200         MOVE PV-STR-NBR (PV-AUD-STR-IDX)                         28920000
289300                                TO AS1-STR-NBR (AS1-AUD-STR-IDX)  28930000
289400     END-PERFORM.                                                 28940000
289500                                                                  28950000
289600     PERFORM 2421-PRINT-AUDITED-STORE-LINE.                       28960000
289700                                                                  28970000
289800                                                                  28980000
289900******************************************************************28990000
290000*  2421-PRINT-AUDITED-STORE-LINE                                  29000000
290100******************************************************************29010000
290200 2421-PRINT-AUDITED-STORE-LINE.                                   29020000
290240                                                                  29024073
290250     IF  CC-FLAT-FILE                                             29025093
290280         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      29028093
290290          FROM AS1-AUDITED-STORES-1                               29029093
290300     ELSE                                                         29030093
290400         WRITE AS-AUDIT-SUM-REPORT-LINE                           29040093
290500          FROM AS1-AUDITED-STORES-1                               29050093
290600         AFTER ADVANCING 1 LINES                                  29060093
290700         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       29070093
290800          FROM AS1-AUDITED-STORES-1                               29080093
290900         AFTER ADVANCING 1 LINES                                  29090093
290910     END-IF.                                                      29091093
290920                                                                  29092093
291000     ADD  +1                  TO PV-DETAIL-LINE-COUNT.            29100000
291100                                                                  29110000
291200                                                                  29120000
291400******************************************************************29140000
291500* 2500-CREATE-RFID-DETAIL                                         29150000
291600*  -DETERMINE IF THERE ARE ANY ERRORS TO REPORT FOR THIS SKU      29160000
291700*      -IF SO, PRINT THE DETAIL REPORT, ADDING THE QUANTITES TO   29170000
291800*       THE ERROR ACCUMULATOR FIELDS.                             29180000
291900*      -OTHERWISE ADD TO THE "SKU WITH NO ERROR" BUCKETS          29190000
292000******************************************************************29200000
292100 2500-CREATE-RFID-DETAIL.                                         29210000
292200                                                                  29220000
292300     IF PS-PRINT-RFID-HEADING                                     29230000
292400         PERFORM 2520-PRINT-RFID-HEADINGS                         29240000
292500     END-IF.                                                      29250000
292600                                                                  29260000
292700     INITIALIZE RDL-RFID-DETAIL-LINE.                             29270000
292800                                                                  29280000
292900     SET   PS-DONT-PRINT-DETAIL       TO TRUE.                    29290000
293000                                                                  29300000
293100     MOVE SU005-SKU-DEPT-NBR          TO RDL-SKU-DEPT.            29310000
293200     MOVE SU005-SKU-CL-NBR            TO RDL-SKU-CLASS.           29320000
293300     MOVE SU005-SKU-NMBR              TO RDL-SKU-NBR.             29330000
293400                                                                  29340000
293500*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  29350000
293600*  *  NO EPC   *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  29360000
293700*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  29370000
293800     IF  SU005-WRG-TKT-NO-EPC-LOGO    > ZERO                      29380000
293900         MOVE  SU005-WRG-TKT-NO-EPC-LOGO TO                       29390000
294000               RDL-WRONG-EPC-LOGO                                 29400000
294100         SET   PS-PRINT-DETAIL        TO TRUE                     29410000
294200                                                                  29420000
294300         MOVE 'PA-WRONG-EPC-LOGO'     TO PV-FIELD-NAME            29430000
294400         COMPUTE PA-WRONG-EPC-LOGO = PA-WRONG-EPC-LOGO +          29440000
294500                 SU005-WRG-TKT-NO-EPC-LOGO                        29450000
294600             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      29460000
294700         END-COMPUTE                                              29470000
294800     END-IF.                                                      29480000
294900                                                                  29490000
295000*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  29500000
295100*  *  WRONG COLOR *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  29510000
295200*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  29520000
295300     IF  SU005-WRG-RFID-TKT-CLR            > ZERO                 29530000
295400         MOVE  SU005-WRG-RFID-TKT-CLR     TO RDL-WRONG-COLOR      29540000
295500         SET   PS-PRINT-DETAIL        TO TRUE                     29550000
295600                                                                  29560000
295700         MOVE 'PA-WRONG-COLOR'       TO PV-FIELD-NAME             29570000
295800         COMPUTE PA-WRONG-COLOR  =                                29580000
295900                 PA-WRONG-COLOR  + SU005-WRG-RFID-TKT-CLR         29590000
296000             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      29600000
296100         END-COMPUTE                                              29610000
296200     END-IF.                                                      29620000
296300                                                                  29630000
296400*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  29640000
296500*  *  WRONG SIZE ON TICKET *  *  *  *  *  *  *  *  *  *  *  *  *  29650000
296600*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  29660000
296700     IF  SU005-WRG-RFID-TKT-SIZE           > ZERO                 29670000
296800         MOVE  SU005-WRG-RFID-TKT-SIZE     TO RDL-WRONG-SIZE      29680000
296900         SET   PS-PRINT-DETAIL        TO TRUE                     29690000
297000                                                                  29700000
297100         MOVE 'PA-WRONG-SIZE' TO PV-FIELD-NAME                    29710000
297200         COMPUTE PA-WRONG-SIZE =                                  29720000
297300                 PA-WRONG-SIZE +                                  29730000
297400                 SU005-WRG-RFID-TKT-SIZE                          29740000
297500             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      29750000
297600         END-COMPUTE                                              29760000
297700     END-IF.                                                      29770000
297800                                                                  29780000
297900*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  29790000
298000*  *  WRONG STYLE ON TICKET*  *  *  *  *  *  *  *  *  *  *  *  *  29800000
298100*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  29810000
298200     IF  SU005-WRG-RFID-TKT-STYLE          > ZERO                 29820000
298300         MOVE  SU005-WRG-RFID-TKT-STYLE TO RDL-WRONG-STYLE        29830000
298400         SET   PS-PRINT-DETAIL        TO TRUE                     29840000
298500                                                                  29850000
298600         MOVE 'PA-WRONG-STYLE' TO PV-FIELD-NAME                   29860000
298700         COMPUTE PA-WRONG-STYLE = PA-WRONG-STYLE +                29870000
298800                                  SU005-WRG-RFID-TKT-STYLE        29880000
298900             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      29890000
299000         END-COMPUTE                                              29900000
299100     END-IF.                                                      29910000
299200                                                                  29920000
299300*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  29930000
299400*  *  NO TICKET   *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  29940000
299500*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  29950000
299600     IF  SU005-NO-RFID-TICKET          > ZERO                     29960000
299700         MOVE  SU005-NO-RFID-TICKET  TO RDL-NO-RFID-TICKET        29970000
299800         SET   PS-PRINT-DETAIL        TO TRUE                     29980000
299900                                                                  29990000
300000         MOVE 'PA-NO-RFID-TICKET' TO PV-FIELD-NAME                30000000
300100         COMPUTE PA-NO-RFID-TICKET  =                             30010000
300200                 PA-NO-RFID-TICKET + SU005-NO-RFID-TICKET         30020000
300300             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      30030000
300400         END-COMPUTE                                              30040000
300500     END-IF.                                                      30050000
300600                                                                  30060000
300700*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  30070000
300800*  *  TOTAL ERRORS   *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  30080000
300900*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  30090000
301000     IF  SU005-TOT-RFID-ERR            > ZERO                     30100000
301100         MOVE  SU005-TOT-RFID-ERR     TO RDL-TOTAL-ERRORS         30110000
301200         SET   PS-PRINT-DETAIL        TO TRUE                     30120000
301300                                                                  30130000
301400         MOVE 'PA-TOT-ERRS-RFID'      TO PV-FIELD-NAME            30140000
301500         COMPUTE PA-TOT-ERRS-RFID =                               30150000
301600                 PA-TOT-ERRS-RFID + SU005-TOT-RFID-ERR            30160000
301700             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      30170000
301800         END-COMPUTE                                              30180000
301900     END-IF.                                                      30190000
302000                                                                  30200000
302100*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  30210000
302200*  *  UNITS IN ERROR *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  30220000
302300*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  30230000
302400     IF  SU005-TOT-UNITS-IN-RFID-ERR   > ZERO                     30240000
302500         MOVE  SU005-TOT-UNITS-IN-RFID-ERR                        30250000
302600                                      TO RDL-TOTAL-UNITS-IN-ERROR 30260000
302700         SET   PS-PRINT-DETAIL        TO TRUE                     30270000
302800                                                                  30280000
302900         MOVE 'PA-TOT-UNTS-IN-ERR-TIC' TO PV-FIELD-NAME           30290000
303000         COMPUTE PA-TOT-UNTS-IN-ERR-RFID =                        30300000
303100                 PA-TOT-UNTS-IN-ERR-RFID +                        30310000
303200                 SU005-TOT-UNITS-IN-RFID-ERR                      30320000
303300             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      30330000
303400         END-COMPUTE                                              30340000
303500     END-IF.                                                      30350000
303600                                                                  30360000
303700*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  30370000
303800*  *  UNITS TRANSCRIBED *  *  *  *  *  *  *  *  *  *  *  *  *  *  30380000
303900*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  30390000
304000     IF  SU005-UNITS-TRNSCRBD          > ZERO                     30400000
304100         MOVE  SU005-UNITS-TRNSCRBD   TO RDL-TOTAL-UNITS-TRNSCRBD 30410000
304200                                                                  30420000
304300*        IF THERE ARE ERRORS, ADD THE UNITS TRANSCRIBED TO THE    30430000
304400*        TOTAL FOR THOSE SKUS WITH ERRORS.                        30440000
304500         IF PS-PRINT-DETAIL                                       30450000
304600             MOVE 'PA-TOT-UNTS-TRNS-IE-RFID' TO PV-FIELD-NAME     30460000
304700             COMPUTE PA-TOT-UNTS-TRNS-IE-RFID =                   30470000
304800                     PA-TOT-UNTS-TRNS-IE-RFID +                   30480000
304900                     SU005-UNITS-TRNSCRBD                         30490000
305000                 ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR  30500000
305100             END-COMPUTE                                          30510000
305200         ELSE                                                     30520000
305300*        OTHERWISE ADD TO THOSE SKUS WITH NO ERRORS               30530000
305400             MOVE 'PA-TOT-UNTS-TRNS-NE-RFID' TO PV-FIELD-NAME     30540000
305500             COMPUTE PA-TOT-UNTS-TRNS-NE-RFID =                   30550000
305600                     PA-TOT-UNTS-TRNS-NE-RFID +                   30560000
305700                     SU005-UNITS-TRNSCRBD                         30570000
305800                 ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR  30580000
305900             END-COMPUTE                                          30590000
306000         END-IF                                                   30600000
306100*        EITHER WAY ADD TO THE OVERALL TOTAL                      30610000
306200         MOVE 'PA-UNTS-TRNS-RFID'             TO PV-FIELD-NAME    30620000
306300         COMPUTE PA-UNTS-TRNS-RFID =                              30630000
306400                 PA-UNTS-TRNS-RFID +                              30640000
306500                 SU005-UNITS-TRNSCRBD                             30650000
306600             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      30660000
306700         END-COMPUTE                                              30670000
306800     END-IF.                                                      30680000
306900                                                                  30690000
307000*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  30700000
307100*  *  UNITS AUDITED  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  30710000
307200*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  30720000
307300     IF  SU005-UNITS-AUDITED           > ZERO OR                  30730000
307410         SU005-NO-RFID-TICKET          > ZERO                     30741000
307500         MOVE 'PA-TOT-UNTS-AUDITED-RFID' TO PV-FIELD-NAME         30750000
307600         COMPUTE PA-TOT-UNTS-AUDITED-RFID =                       30760000
307700                 SU005-NO-RFID-TICKET +                           30770000
307800                 SU005-UNITS-AUDITED                              30780000
307900             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      30790000
308000         END-COMPUTE                                              30800000
308100         MOVE PA-TOT-UNTS-AUDITED-RFID                            30810000
308200                                      TO RDL-TOTAL-UNITS-AUDITED  30820000
308600*        IF THERE ARE ERRORS, ADD THE UNITS AUDITED TO THE BUCKET 30860000
308700*        TOTAL FOR THOSE SKUS WITH ERRORS.                        30870000
308800         IF PS-PRINT-DETAIL                                       30880000
308900             MOVE 'PA-TOT-UNTS-AUD-IE-RFID' TO PV-FIELD-NAME      30890000
309000             COMPUTE PA-TOT-UNTS-AUD-IE-RFID =                    30900000
309100                     PA-TOT-UNTS-AUD-IE-RFID +                    30910000
309200                     SU005-UNITS-AUDITED +                        30920000
309400                     SU005-NO-RFID-TICKET                         30940000
309600                 ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR  30960000
309700             END-COMPUTE                                          30970000
309800         ELSE                                                     30980000
309900*        OTHERWISE ADD TO THOSE SKUS WITH NO ERRORS               30990000
310000             MOVE 'PA-TOT-UNTS-AUD-NE-RFID' TO PV-FIELD-NAME      31000000
310100             COMPUTE PA-TOT-UNTS-AUD-NE-RFID =                    31010000
310200                     PA-TOT-UNTS-AUD-NE-RFID +                    31020000
310300                     SU005-UNITS-AUDITED                          31030000
310400                 ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR  31040000
310500             END-COMPUTE                                          31050000
310600         END-IF                                                   31060000
310700*        EITHER WAY ADD TO THE OVERALL TOTAL                      31070000
310800         MOVE 'PA-UNTS-AUD-RFID'            TO PV-FIELD-NAME      31080000
310900         COMPUTE PA-UNTS-AUD-RFID      =                          31090000
311000                 PA-UNTS-AUD-RFID      +                          31100000
311100                 SU005-UNITS-AUDITED   +                          31110000
311300                 SU005-NO-RFID-TICKET                             31130000
311500             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      31150000
311600         END-COMPUTE                                              31160000
311700     END-IF.                                                      31170000
311800                                                                  31180000
311900*    IF ANY ERRORS FOUND, PRINT THE DETAIL...IF NOT, ADD TO THE   31190000
312000*    TOTALS OF THE SKUS WITH NO ERRORS                            31200000
312100     IF PS-PRINT-DETAIL                                           31210000
312200*        IF A SPOT ERROR USE THE UNITS AUDITED TO CALCULATE THE   31220000
312300*        ERROR RATIO -- OTHERWISE USE THE UNITS TRANSCRIBED       31230000
312400         IF PV-SPOT-AUDIT-CHECK                                   31240000
312500             IF SU005-UNITS-AUDITED > ZERO                        31250000
312600                 COMPUTE PV-ERROR-RATIO  =                        31260000
312700                     (SU005-TOT-UNITS-IN-RFID-ERR /               31270000
312900                     (SU005-NO-RFID-TICKET +                      31290000
313100                      SU005-UNITS-AUDITED)) * 100                 31310000
313200                 MOVE PV-ERROR-RATIO    TO RDL-ERROR-RATIO        31320000
313300             ELSE                                                 31330000
313400                 IF SU005-TOT-UNITS-IN-RFID-ERR  > ZERO           31340000
313500                     MOVE 100           TO RDL-ERROR-RATIO        31350000
313600                 ELSE                                             31360000
313700                     MOVE ZERO          TO RDL-ERROR-RATIO        31370000
313800                 END-IF                                           31380000
313900             END-IF                                               31390000
314000         ELSE                                                     31400000
314100             IF SU005-UNITS-TRNSCRBD > ZERO                       31410000
314200                 COMPUTE PV-ERROR-RATIO  =                        31420000
314300                     (SU005-TOT-UNITS-IN-RFID-ERR /               31430000
314400                      SU005-UNITS-TRNSCRBD)  * 100                31440000
314500                 MOVE PV-ERROR-RATIO    TO RDL-ERROR-RATIO        31450000
314600             ELSE                                                 31460000
314700                 IF SU005-TOT-UNITS-IN-RFID-ERR  > ZERO           31470000
314800                     MOVE 100           TO RDL-ERROR-RATIO        31480000
314900                 ELSE                                             31490000
315000                     MOVE ZERO          TO RDL-ERROR-RATIO        31500000
315100                 END-IF                                           31510000
315200             END-IF                                               31520000
315300         END-IF                                                   31530000
315400                                                                  31540000
315500         MOVE '%'                   TO RDL-PERCENT                31550000
315600                                                                  31560000
315700         IF (PV-DETAIL-LINE-COUNT + 1) > PC-MAX-REPORT-LINES      31570000
315800             PERFORM 3000-PRINT-PAGE-HEADING                      31580000
316000             PERFORM 2520-PRINT-RFID-HEADINGS                     31600000
316100         END-IF                                                   31610000
316200                                                                  31620000
316300*        GET THE LINE NUMBER                                      31630000
316400         PERFORM 8100-GET-LINE-NUMBER                             31640000
316500         EVALUATE TRUE                                            31650000
316600           WHEN SQLCODE = -811                                    31660000
316700             MOVE 'MULT'            TO RDL-LINE-NBR-X             31670000
316800           WHEN SQLCODE = +100                                    31680000
316900             MOVE ' N/A'            TO RDL-LINE-NBR-X             31690000
317000           WHEN OTHER                                             31700000
317100             MOVE PURITM-APP-PO-LNE-NBR                           31710000
317200                                    TO RDL-LINE-NBR               31720000
317300         END-EVALUATE                                             31730000
317400                                                                  31740000
317410         IF  CC-FLAT-FILE                                         31741093
317440             WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                  31744093
317450              FROM RDL-RFID-DETAIL-LINE                           31745093
317460         ELSE                                                     31746093
317500             WRITE AS-AUDIT-SUM-REPORT-LINE                       31750093
317600              FROM RDL-RFID-DETAIL-LINE                           31760093
317700             AFTER ADVANCING 1 LINES                              31770000
317800             WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                   31780093
317900              FROM RDL-RFID-DETAIL-LINE                           31790093
318000             AFTER ADVANCING 1 LINES                              31800000
318010         END-IF                                                   31801093
318020                                                                  31802093
318100         ADD +1                     TO PV-DETAIL-LINE-COUNT       31810000
318200                                       PA-SKUS-W-ERRS-RFID        31820000
318300                                       PA-SKU-COUNT-RFID          31830000
318400     ELSE                                                         31840000
318500         ADD +1                     TO PA-SKUS-W-NO-ERRS-RFID     31850000
318600                                       PA-SKU-COUNT-RFID          31860000
318700     END-IF.                                                      31870000
318800                                                                  31880000
318900     PERFORM 8001-READ-EXTRACT-FILE.                              31890000
319000                                                                  31900000
319100                                                                  31910000
319200******************************************************************31920000
319300* 2510-CREATE-RFID-SUMMARY.                                       31930000
319400*  -PRINT THE ERROR AND NO-ERROR SUB TOTALS AND A RFID TOTAL LINE 31940000
319500******************************************************************31950000
319600 2510-CREATE-RFID-SUMMARY.                                        31960000
319610*                                                                 31961073
319640                                                                  31964073
319700                                                                  31970000
319800*    IF THE SUMMARY WON'T FIT ON THE PAGE, GO TO THE NEXT ONE     31980000
319900     IF (PV-DETAIL-LINE-COUNT + 4) > PC-MAX-REPORT-LINES          31990000
320000         PERFORM 3000-PRINT-PAGE-HEADING                          32000000
320200     END-IF                                                       32020000
320300                                                                  32030000
320400*    WRITE SUMMARY LINE FOR THE SKUS WITH ERRORS                  32040000
320500     INITIALIZE RTL-RFID-TOTAL-LINE.                              32050000
320600     MOVE '  SKUS W/ERRS'             TO RTL-TOTAL-DESCRIPTION.   32060000
320700     MOVE PA-SKUS-W-ERRS-RFID         TO RTL-SKU-COUNT.           32070000
320800     MOVE PA-WRONG-EPC-LOGO           TO RTL-WRONG-EPC-LOGO.      32080000
320900     MOVE PA-WRONG-COLOR              TO RTL-WRONG-COLOR.         32090000
321000     MOVE PA-WRONG-SIZE               TO RTL-WRONG-SIZE.          32100000
321100     MOVE PA-WRONG-STYLE              TO RTL-WRONG-STYLE.         32110000
321200     MOVE PA-NO-RFID-TICKET           TO RTL-NO-RFID-TICKET.      32120000
321300     MOVE PA-TOT-ERRS-RFID            TO RTL-TOTAL-ERRORS.        32130000
321400     MOVE PA-TOT-UNTS-IN-ERR-RFID     TO RTL-TOTAL-UNITS-IN-ERROR.32140000
321500     MOVE PA-TOT-UNTS-TRNS-IE-RFID    TO RTL-TOTAL-UNITS-TRNSCRBD.32150000
321600     MOVE PA-TOT-UNTS-AUD-IE-RFID     TO RTL-TOTAL-UNITS-AUDITED. 32160000
321700     MOVE SPACES                      TO RTL-PERCENT              32170000
321800                                         RTL-ERROR-RATIO-X.       32180000
321900                                                                  32190000
324910     IF  CC-FLAT-FILE                                             32491093
324940         MOVE SPACES  TO  AS-AUDIT-SUM-REPORT-LINE-FLAT           32494093
324950         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      32495093
324960         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      32496093
324970          FROM RTL-RFID-TOTAL-LINE                                32497093
324980     ELSE                                                         32498093
325000         WRITE AS-AUDIT-SUM-REPORT-LINE                           32500093
325100          FROM RTL-RFID-TOTAL-LINE                                32510093
325200         AFTER ADVANCING 2 LINES                                  32520093
325300         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       32530093
325400          FROM RTL-RFID-TOTAL-LINE                                32540093
325500         AFTER ADVANCING 2 LINES                                  32550093
325510     END-IF.                                                      32551093
325520                                                                  32552093
325600     ADD +2                           TO PV-DETAIL-LINE-COUNT.    32560000
325700                                                                  32570000
325800*    WRITE SUMMARY LINE FOR THE SKUS WITH NO ERRORS               32580000
325900     INITIALIZE RTL-RFID-TOTAL-LINE.                              32590000
326000     MOVE ' SKUS WO/ERRS'             TO RTL-TOTAL-DESCRIPTION.   32600000
326100     MOVE PA-SKUS-W-NO-ERRS-RFID      TO RTL-SKU-COUNT.           32610000
326200     MOVE PA-TOT-UNTS-TRNS-NE-RFID    TO RTL-TOTAL-UNITS-TRNSCRBD.32620000
326300     MOVE PA-TOT-UNTS-AUD-NE-RFID     TO RTL-TOTAL-UNITS-AUDITED. 32630000
326400     MOVE SPACES                      TO RTL-PERCENT              32640000
326500                                         RTL-ERROR-RATIO-X.       32650000
326510                                                                  32651093
326520     IF  CC-FLAT-FILE                                             32652093
326550         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      32655093
326560          FROM RTL-RFID-TOTAL-LINE                                32656093
326570     ELSE                                                         32657093
326600         WRITE AS-AUDIT-SUM-REPORT-LINE                           32660093
326700          FROM RTL-RFID-TOTAL-LINE                                32670093
326800         AFTER ADVANCING 1 LINES                                  32680093
326900         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       32690093
327000          FROM RTL-RFID-TOTAL-LINE                                32700093
327100         AFTER ADVANCING 1 LINES                                  32710093
327110     END-IF.                                                      32711093
327120                                                                  32712093
327200     ADD +1                           TO PV-DETAIL-LINE-COUNT.    32720000
327300                                                                  32730000
327400*    WRITE SUMMARY LINE FOR THE RFID TOTALS                       32740000
327500     INITIALIZE RTL-RFID-TOTAL-LINE.                              32750000
327600     MOVE '   RFID TOTAL'             TO RTL-TOTAL-DESCRIPTION.   32760000
327700     MOVE PA-SKU-COUNT-RFID           TO RTL-SKU-COUNT.           32770000
327800     MOVE PA-WRONG-EPC-LOGO           TO RTL-WRONG-EPC-LOGO.      32780000
327900     MOVE PA-WRONG-COLOR              TO RTL-WRONG-COLOR.         32790000
328000     MOVE PA-WRONG-SIZE               TO RTL-WRONG-SIZE.          32800000
328100     MOVE PA-WRONG-STYLE              TO RTL-WRONG-STYLE.         32810000
328200     MOVE PA-NO-RFID-TICKET           TO RTL-NO-RFID-TICKET.      32820000
328300     MOVE PA-TOT-ERRS-RFID            TO RTL-TOTAL-ERRORS.        32830000
328400     MOVE PA-TOT-UNTS-IN-ERR-RFID     TO RTL-TOTAL-UNITS-IN-ERROR.32840000
328500     MOVE PA-UNTS-TRNS-RFID           TO RTL-TOTAL-UNITS-TRNSCRBD.32850000
328600     MOVE PA-UNTS-AUD-RFID            TO RTL-TOTAL-UNITS-AUDITED. 32860000
328700     MOVE '%'                         TO RTL-PERCENT.             32870000
328800                                                                  32880000
328900*    IF A SPOT ERROR USE THE UNITS AUDITED TO CALCULATE THE       32890000
329000*    ERROR RATIO -- OTHERWISE USE THE UNITS TRANSCRIBED           32900000
329100     IF PV-SPOT-AUDIT-CHECK                                       32910000
329200         IF PA-UNTS-AUD-RFID > ZERO                               32920000
329300             COMPUTE PV-ERROR-RATIO  =                            32930000
329400             (PA-TOT-UNTS-IN-ERR-RFID / PA-UNTS-AUD-RFID) * 100   32940000
329500             MOVE PV-ERROR-RATIO          TO RTL-ERROR-RATIO      32950000
329600         ELSE                                                     32960000
329700             IF PA-TOT-UNTS-IN-ERR-RFID > ZERO                    32970000
329800                 MOVE 100                TO RTL-ERROR-RATIO       32980000
329900             ELSE                                                 32990000
330000                 MOVE ZERO               TO RTL-ERROR-RATIO       33000000
330100             END-IF                                               33010000
330200         END-IF                                                   33020000
330300     ELSE                                                         33030000
330400         IF PA-UNTS-TRNS-RFID > ZERO                              33040000
330500             COMPUTE PV-ERROR-RATIO  =                            33050000
330600             (PA-TOT-UNTS-IN-ERR-RFID / PA-UNTS-TRNS-RFID) * 100  33060000
330700             MOVE PV-ERROR-RATIO          TO RTL-ERROR-RATIO      33070000
330800         ELSE                                                     33080000
330900             IF PA-TOT-UNTS-IN-ERR-RFID > ZERO                    33090000
331000                 MOVE 100                TO RTL-ERROR-RATIO       33100000
331100             ELSE                                                 33110000
331200                 MOVE ZERO               TO RTL-ERROR-RATIO       33120000
331300             END-IF                                               33130000
331400         END-IF                                                   33140000
331500     END-IF.                                                      33150000
331600                                                                  33160000
331610     IF  CC-FLAT-FILE                                             33161093
331640         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      33164093
331650          FROM RTL-RFID-TOTAL-LINE                                33165093
331660     ELSE                                                         33166093
331700         WRITE AS-AUDIT-SUM-REPORT-LINE                           33170093
331800          FROM RTL-RFID-TOTAL-LINE                                33180093
331900         AFTER ADVANCING 1 LINES                                  33190093
332000         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       33200093
332100          FROM RTL-RFID-TOTAL-LINE                                33210093
332200         AFTER ADVANCING 1 LINES                                  33220093
332210     END-IF.                                                      33221093
332220                                                                  33222093
332300     ADD +1                           TO PV-DETAIL-LINE-COUNT.    33230000
332400                                                                  33240000
332500                                                                  33250000
332600******************************************************************33260000
332700* 2520-PRINT-RFID-HEADINGS                                        33270000
332800*  -PRINT THE DETAIL HEADINGS FOR THE RFID ERRORS                 33280000
332900******************************************************************33290000
333000 2520-PRINT-RFID-HEADINGS.                                        33300000
333100                                                                  33310000
333200*    IF THE HEADINGS + 1 DETAIL LINE WON'T FIT, GOTO THE NEXT PGE 33320000
333300     IF (PV-DETAIL-LINE-COUNT + 8) > PC-MAX-REPORT-LINES          33330000
333400         PERFORM 3000-PRINT-PAGE-HEADING                          33340000
333600     END-IF                                                       33360000
333700     SET PS-DONT-PRINT-RFID-HEADING TO TRUE                       33370000
333800                                                                  33380000
333810     IF  CC-FLAT-FILE                                             33381093
333840         MOVE SPACES  TO  AS-AUDIT-SUM-REPORT-LINE-FLAT           33384093
333850         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      33385093
333860         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      33386093
333870          FROM RDH1-RFID-DETAIL-HEADING-1                         33387093
333880     ELSE                                                         33388093
333900         WRITE AS-AUDIT-SUM-REPORT-LINE                           33390093
334000          FROM RDH1-RFID-DETAIL-HEADING-1                         33400093
334100         AFTER ADVANCING 2 LINES                                  33410093
334200         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       33420093
334300          FROM RDH1-RFID-DETAIL-HEADING-1                         33430093
334400         AFTER ADVANCING 2 LINES                                  33440093
334410     END-IF.                                                      33441093
334420                                                                  33442093
334510     IF  CC-FLAT-FILE                                             33451093
334540         MOVE SPACES  TO  AS-AUDIT-SUM-REPORT-LINE-FLAT           33454093
334550         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      33455093
334560         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      33456093
334570          FROM RDH2-RFID-DETAIL-HEADING-2                         33457093
334580     ELSE                                                         33458093
334600         WRITE AS-AUDIT-SUM-REPORT-LINE                           33460093
334700          FROM RDH2-RFID-DETAIL-HEADING-2                         33470093
334800         AFTER ADVANCING 2 LINES                                  33480093
334900         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       33490093
335000          FROM RDH2-RFID-DETAIL-HEADING-2                         33500093
335100         AFTER ADVANCING 2 LINES                                  33510093
335110     END-IF.                                                      33511093
335200                                                                  33520000
335210     IF  CC-FLAT-FILE                                             33521093
335220         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      33522093
335230          FROM RDH3-RFID-DETAIL-HEADING-3                         33523093
335240     ELSE                                                         33524093
335300         WRITE AS-AUDIT-SUM-REPORT-LINE                           33530093
335400          FROM RDH3-RFID-DETAIL-HEADING-3                         33540093
335500         AFTER ADVANCING 1 LINES                                  33550093
335600         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       33560093
335700         FROM RDH3-RFID-DETAIL-HEADING-3                          33570000
335800         AFTER ADVANCING 1 LINES                                  33580093
335810     END-IF.                                                      33581093
335900                                                                  33590000
336000     ADD +5                           TO PV-DETAIL-LINE-COUNT.    33600000
336100                                                                  33610000
336200******************************************************************33620000
336300* 2600-PRINT-RFID-FOOTER.                                         33630000
336400******************************************************************33640000
336500 2600-PRINT-RFID-FOOTER.                                          33650000
336600                                                                  33660000
336700*    IF THE FOOTER LINE WON'T FIT, GOTO THE NEXT PGE              33670000
336800     IF (PV-DETAIL-LINE-COUNT + 5) > PC-MAX-REPORT-LINES          33680000
336900         PERFORM 3000-PRINT-PAGE-HEADING                          33690000
337100     END-IF.                                                      33710000
337200                                                                  33720000
337300     INITIALIZE TRL-TOTAL-RATIO-LINE.                             33730000
337400     MOVE '     TOTAL RFID ERROR RATIO -  '                       33740000
337500                                TO TRL-TOTAL-RATIO-DESC.          33750000
337600                                                                  33760000
337700*    IF A SPOT ERROR USE THE UNITS AUDITED TO CALCULATE THE       33770000
337800*    ERROR RATIO -- OTHERWISE USE THE UNITS TRANSCRIBED           33780000
337900     IF PV-SPOT-AUDIT-CHECK                                       33790000
338000         IF PA-UNTS-AUD-RFID > ZERO                               33800000
338100             COMPUTE PV-ERROR-RATIO  =                            33810000
338200             (PA-TOT-UNTS-IN-ERR-RFID / PA-UNTS-AUD-RFID) * 100   33820000
338300             MOVE PV-ERROR-RATIO          TO TRL-TOTAL-RATIO      33830000
338400         ELSE                                                     33840000
338500             IF PA-TOT-UNTS-IN-ERR-RFID  > ZERO                   33850000
338600                 MOVE 100                TO TRL-TOTAL-RATIO       33860000
338700             ELSE                                                 33870000
338800                 MOVE ZERO               TO TRL-TOTAL-RATIO       33880000
338900             END-IF                                               33890000
339000         END-IF                                                   33900000
339100     ELSE                                                         33910000
339200         IF PA-UNTS-TRNS-RFID > ZERO                              33920000
339300             COMPUTE PV-ERROR-RATIO  =                            33930000
339400             (PA-TOT-UNTS-IN-ERR-RFID / PA-UNTS-TRNS-RFID) * 100  33940000
339500             MOVE PV-ERROR-RATIO          TO TRL-TOTAL-RATIO      33950000
339600         ELSE                                                     33960000
339700             IF PA-TOT-UNTS-IN-ERR-RFID  > ZERO                   33970000
339800                 MOVE 100                TO TRL-TOTAL-RATIO       33980000
339900             ELSE                                                 33990000
340000                 MOVE ZERO               TO TRL-TOTAL-RATIO       34000000
340100             END-IF                                               34010000
340200         END-IF                                                   34020000
340300     END-IF.                                                      34030000
340400*                                                                 34040000
340410     IF  CC-FLAT-FILE                                             34041093
340440         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      34044093
340450          FROM TRL-TOTAL-RATIO-LINE                               34045093
340460     ELSE                                                         34046093
340500         WRITE AS-AUDIT-SUM-REPORT-LINE                           34050093
340600          FROM TRL-TOTAL-RATIO-LINE                               34060093
340700         AFTER ADVANCING 1 LINES                                  34070093
340800         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       34080093
340900          FROM TRL-TOTAL-RATIO-LINE                               34090093
341000         AFTER ADVANCING 1 LINES                                  34100093
341010     END-IF.                                                      34101093
341020                                                                  34102093
341100     ADD +1                           TO PV-DETAIL-LINE-COUNT.    34110000
341200                                                                  34120000
341300                                                                  34130000
345500                                                                  34550000
345600*    BLANK LINE BETWEEN SUMMAY AND THE AUDITED STORE LIST         34560000
345610                                                                  34561093
345620     IF  CC-FLAT-FILE                                             34562093
345630         MOVE SPACES  TO  AS-AUDIT-SUM-REPORT-LINE-FLAT           34563093
345640         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      34564093
345650     ELSE                                                         34565093
345700         WRITE AS-AUDIT-SUM-REPORT-LINE                           34570093
345800          FROM BLANK-LINE                                         34580093
345900         AFTER ADVANCING 1 LINES                                  34590093
346000         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       34600093
346100          FROM BLANK-LINE                                         34610093
346200         AFTER ADVANCING 1 LINES                                  34620093
346210     END-IF.                                                      34621093
346220                                                                  34622093
346300     ADD  +1                          TO PV-DETAIL-LINE-COUNT.    34630000
346400                                                                  34640000
346500*    LIST THE STORES THAT WERE CHECKED IN THIS AUDIT              34650000
346600     PERFORM 2420-PRINT-AUD-STR-LIST.                             34660000
346700                                                                  34670000
346800*    BLANK LINE BETWEEN THE AUDITED STORE LIST AND SPOT PERCENT   34680000
346801                                                                  34680193
346810     IF  CC-FLAT-FILE                                             34681093
346820         MOVE SPACES  TO  AS-AUDIT-SUM-REPORT-LINE-FLAT           34682093
346830         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      34683093
346840     ELSE                                                         34684093
346900         WRITE AS-AUDIT-SUM-REPORT-LINE                           34690093
347000          FROM BLANK-LINE                                         34700093
347100         AFTER ADVANCING 1 LINES                                  34710093
347200         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       34720093
347300          FROM BLANK-LINE                                         34730093
347400         AFTER ADVANCING 1 LINES                                  34740093
347410     END-IF.                                                      34741093
347420                                                                  34742093
347500     ADD  +1                          TO PV-DETAIL-LINE-COUNT.    34750000
347600                                                                  34760000
347700                                                                  34770000
347800     PERFORM 2410-GET-SPOT-PERCENT.                               34780000
347900*    IF MORE AUDITING NEEDS TO BE DONE (THE MIN IS MORE THAN WHAT 34790000
348000*    HAS BEEN AUDITED) TO SATISFY A SPOT-CHECK, WRITE A MESSAGE   34800000
348100*    TELLING THE USER THAT MORE NEEDS TO BE CHECKED.              34810000
348200     IF ((RECEIV-ACTL-CART-CNT * PV-SPOT-PERCENT) >               34820000
348300          PV-AUDIT-CARTON-COUNT)                                  34830000
348400     AND PV-SPOT-AUDIT-CHECK                                      34840000
348410                                                                  34841093
348420         IF  CC-FLAT-FILE                                         34842093
348450             WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                  34845093
348460              FROM ARL1-AUDITING-REQUIRED-LINE-1                  34846093
348470         ELSE                                                     34847093
348500             WRITE AS-AUDIT-SUM-REPORT-LINE                       34850093
348600              FROM ARL1-AUDITING-REQUIRED-LINE-1                  34860093
348700             AFTER ADVANCING 1 LINES                              34870000
348800             WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                   34880093
348900              FROM ARL1-AUDITING-REQUIRED-LINE-1                  34890093
349000             AFTER ADVANCING 1 LINES                              34900000
349010         END-IF                                                   34901093
349100                                                                  34910000
349110         IF  CC-FLAT-FILE                                         34911093
349140             WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                  34914093
349150              FROM ARL2-AUDITING-REQUIRED-LINE-2                  34915093
349160         ELSE                                                     34916093
349200             WRITE AS-AUDIT-SUM-REPORT-LINE                       34920093
349300              FROM ARL2-AUDITING-REQUIRED-LINE-2                  34930093
349400             AFTER ADVANCING 1 LINES                              34940000
349500             WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                   34950093
349600              FROM ARL2-AUDITING-REQUIRED-LINE-2                  34960093
349700             AFTER ADVANCING 1 LINES                              34970000
349710         END-IF                                                   34971093
349800                                                                  34980000
349810         IF  CC-FLAT-FILE                                         34981093
349840             WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                  34984093
349850              FROM ARL1-AUDITING-REQUIRED-LINE-1                  34985093
349860         ELSE                                                     34986093
349900             WRITE AS-AUDIT-SUM-REPORT-LINE                       34990093
350000              FROM ARL1-AUDITING-REQUIRED-LINE-1                  35000093
350100             AFTER ADVANCING 1 LINES                              35010000
350200             WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                   35020093
350300              FROM ARL1-AUDITING-REQUIRED-LINE-1                  35030093
350400             AFTER ADVANCING 1 LINES                              35040000
350410         END-IF                                                   35041093
350420                                                                  35042093
350500     END-IF.                                                      35050000
350600                                                                  35060000
350800                                                                  35080000
350900******************************************************************35090000
351000*  3000-PRINT-PAGE-HEADING --  CREATES THE PAGE HEADING           35100000
351100*  FOR THE REPORT AT A BREAK IN RECEIVER                          35110000
351200*     - PRINT THE PAGE HEADING                                    35120000
351300*     - SETUP/PRINT THE RECEIVER HEADING                          35130000
351400******************************************************************35140000
351500 3000-PRINT-PAGE-HEADING.                                         35150000
351600                                                                  35160000
351700     ADD 1                     TO PV-DETAIL-PAGE-COUNT.           35170000
351800     MOVE +09                  TO PV-DETAIL-LINE-COUNT.           35180000
351900     MOVE 1                    TO DP132O-REPORT-NUMBER.           35190000
352000     MOVE PV-DETAIL-PAGE-COUNT TO DP132O-PAGE-NUMBER.             35200000
352100                                                                  35210000
352110     IF  CC-FLAT-FILE                                             35211093
352180         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      35218093
352190          FROM DP132O-STANDRD-HEADER-132-COLS                     35219093
352191*                                                                 35219199
352192*** 11/10/22 BEGIN - DMH                                          35219299
352193*                                                                 35219399
352194         AFTER ADVANCING PAGE                                     35219499
352195*                                                                 35219599
352196*** 11/10/22 ENDD  - DMH                                          35219699
352197*                                                                 35219799
352198     ELSE                                                         35219893
352200         WRITE AS-AUDIT-SUM-REPORT-LINE                           35220093
352300          FROM DP132O-STANDRD-HEADER-132-COLS                     35230093
352400         AFTER ADVANCING PAGE                                     35240093
352500         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       35250093
352600          FROM DP132O-STANDRD-HEADER-132-COLS                     35260093
352700         AFTER ADVANCING PAGE                                     35270093
352710     END-IF.                                                      35271093
352720                                                                  35272093
352800                                                                  35280000
352900*    "VENDOR ACCURACY CARTON AUDIT"                               35290000
352901                                                                  35290193
352910     IF  CC-FLAT-FILE                                             35291093
352960         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      35296093
352970          FROM PH2-PAGE-HEADING-2                                 35297093
352980     ELSE                                                         35298093
353000         WRITE AS-AUDIT-SUM-REPORT-LINE                           35300093
353100          FROM PH2-PAGE-HEADING-2                                 35310093
353200         AFTER ADVANCING 2 LINES                                  35320094
353300         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       35330093
353400          FROM PH2-PAGE-HEADING-2                                 35340093
353500         AFTER ADVANCING 2 LINES                                  35350094
353510     END-IF.                                                      35351093
353520                                                                  35352093
353600                                                                  35360000
353700*    "CASEPACK CARTON AUDIT"                                      35370000
353710                                                                  35371093
353720     IF  CC-FLAT-FILE                                             35372093
353730         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      35373093
353740          FROM PH3-PAGE-HEADING-3                                 35374093
353750     ELSE                                                         35375093
353800         WRITE AS-AUDIT-SUM-REPORT-LINE                           35380093
353900          FROM PH3-PAGE-HEADING-3                                 35390093
354000         AFTER ADVANCING 1 LINES                                  35400093
354100         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       35410093
354200          FROM PH3-PAGE-HEADING-3                                 35420093
354300         AFTER ADVANCING 1 LINES                                  35430093
354310     END-IF.                                                      35431093
354320                                                                  35432093
354400                                                                  35440000
354500*    "SUMMARY REPORT"                                             35450000
354501                                                                  35450193
354510     IF  CC-FLAT-FILE                                             35451093
354520         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      35452093
354530          FROM PH4-PAGE-HEADING-4                                 35453093
354540     ELSE                                                         35454093
354600         WRITE AS-AUDIT-SUM-REPORT-LINE                           35460093
354700          FROM PH4-PAGE-HEADING-4                                 35470093
354800         AFTER ADVANCING 1 LINE                                   35480093
354900         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       35490093
355000          FROM PH4-PAGE-HEADING-4                                 35500093
355100         AFTER ADVANCING 1 LINE                                   35510093
355110     END-IF.                                                      35511093
355120                                                                  35512093
355200                                                                  35520000
355300*    "AUDIT CONTROL NBR - AUDIT STATUS - FACILITY"                35530000
355310                                                                  35531093
355320     IF  CC-FLAT-FILE                                             35532093
355350         MOVE SPACES  TO  AS-AUDIT-SUM-REPORT-LINE-FLAT           35535093
355360         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      35536093
355370         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      35537093
355380          FROM AH1-AUDIT-HEADING-1                                35538093
355390     ELSE                                                         35539093
355400         WRITE AS-AUDIT-SUM-REPORT-LINE                           35540093
355500          FROM AH1-AUDIT-HEADING-1                                35550093
355600         AFTER ADVANCING 2 LINES                                  35560093
355700         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       35570093
355800          FROM AH1-AUDIT-HEADING-1                                35580093
355900         AFTER ADVANCING 2 LINES                                  35590093
355910     END-IF.                                                      35591093
356000                                                                  35600000
356100*    "VENDOR NAME - DEPARTMENT"                                   35610000
356110                                                                  35611093
356120     IF  CC-FLAT-FILE                                             35612093
356150         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      35615093
356160          FROM AH2-AUDIT-HEADING-2                                35616093
356170     ELSE                                                         35617093
356200         WRITE AS-AUDIT-SUM-REPORT-LINE                           35620093
356300          FROM AH2-AUDIT-HEADING-2                                35630093
356400         AFTER ADVANCING 1 LINES                                  35640093
356500         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       35650093
356600          FROM AH2-AUDIT-HEADING-2                                35660093
356700         AFTER ADVANCING 1 LINES                                  35670093
356710     END-IF.                                                      35671093
356800                                                                  35680000
356900*    "PO/REC - PRETICKET IND - AUDIT AREA"                        35690000
356910     IF  CC-FLAT-FILE                                             35691093
356940         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      35694093
356950          FROM AH3-AUDIT-HEADING-3                                35695093
356960     ELSE                                                         35696093
357000         WRITE AS-AUDIT-SUM-REPORT-LINE                           35700093
357100          FROM AH3-AUDIT-HEADING-3                                35710093
357200         AFTER ADVANCING 1 LINES                                  35720093
357300         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       35730093
357400          FROM AH3-AUDIT-HEADING-3                                35740093
357500         AFTER ADVANCING 1 LINES                                  35750093
357510     END-IF.                                                      35751093
358600                                                                  35860000
358700*    "AUDIT TYPE - HANGER IND - UNITS TRANSCRIBED"                35870000
358710                                                                  35871093
358720     IF  CC-FLAT-FILE                                             35872093
358750         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      35875093
358760          FROM AH4-RECEIVER-HEADING-4                             35876093
358770     ELSE                                                         35877093
358800         WRITE AS-AUDIT-SUM-REPORT-LINE                           35880093
358900          FROM AH4-RECEIVER-HEADING-4                             35890093
359000         AFTER ADVANCING 1 LINES                                  35900093
359100         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       35910093
359200          FROM AH4-RECEIVER-HEADING-4                             35920093
359300         AFTER ADVANCING 1 LINES                                  35930093
359310     END-IF.                                                      35931093
359400                                                                  35940000
359500*    RECEIPT DATE - NEW STORE IND - EXP CARTON COUNT              35950000
359510                                                                  35951093
359520     IF  CC-FLAT-FILE                                             35952093
359550         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      35955093
359560          FROM AH5-RECEIVER-HEADING-5                             35956093
359570     ELSE                                                         35957093
359600         WRITE AS-AUDIT-SUM-REPORT-LINE                           35960093
359700          FROM AH5-RECEIVER-HEADING-5                             35970093
359800         AFTER ADVANCING 1 LINE                                   35980093
359900         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       35990093
360000          FROM AH5-RECEIVER-HEADING-5                             36000093
360100         AFTER ADVANCING 1 LINE                                   36010093
360110     END-IF.                                                      36011093
360200                                                                  36020000
360300*    AUDIT CATEGORY - AUDIT START - CARTONS AUDITED               36030000
360310                                                                  36031093
360320     IF  CC-FLAT-FILE                                             36032093
360370         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      36037093
360380          FROM AH6-RECEIVER-HEADING-6                             36038093
360390     ELSE                                                         36039093
360400         WRITE AS-AUDIT-SUM-REPORT-LINE                           36040093
360500          FROM AH6-RECEIVER-HEADING-6                             36050093
360600         AFTER ADVANCING 2 LINE                                   36060093
360700         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       36070093
360800          FROM AH6-RECEIVER-HEADING-6                             36080093
360900         AFTER ADVANCING 2 LINE                                   36090093
360910     END-IF.                                                      36091093
361000                                                                  36100000
361100*    AUDIT - AUDIT STOP - ADJ CARTON COUNT                        36110000
361110                                                                  36111093
361120     IF  CC-FLAT-FILE                                             36112093
361150         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      36115093
361160          FROM AH7-RECEIVER-HEADING-7                             36116093
361170     ELSE                                                         36117093
361200         WRITE AS-AUDIT-SUM-REPORT-LINE                           36120093
361300          FROM AH7-RECEIVER-HEADING-7                             36130093
361400         AFTER ADVANCING 1 LINE                                   36140093
361500         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       36150093
361600          FROM AH7-RECEIVER-HEADING-7                             36160093
361700         AFTER ADVANCING 1 LINE                                   36170093
361710     END-IF.                                                      36171093
361800                                                                  36180000
361801*    DESIGNATION - DURATION - UNITS AUDITED                       36180100
361802                                                                  36180293
361803     IF  CC-FLAT-FILE                                             36180393
361806         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      36180693
361807          FROM AH8-RECEIVER-HEADING-8                             36180793
361808     ELSE                                                         36180893
361810         WRITE AS-AUDIT-SUM-REPORT-LINE                           36181093
361820          FROM AH8-RECEIVER-HEADING-8                             36182093
361830         AFTER ADVANCING 1 LINE                                   36183093
361840         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       36184093
361850          FROM AH8-RECEIVER-HEADING-8                             36185093
361860         AFTER ADVANCING 1 LINE                                   36186093
361861     END-IF.                                                      36186193
361870                                                                  36187000
361900     ADD  +6                   TO PV-DETAIL-LINE-COUNT.           36190000
362000                                                                  36200000
362100*    AUDITING ASSOCIATES                                          36210000
362110                                                                  36211093
362120     IF  CC-FLAT-FILE                                             36212093
362170         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      36217093
362180          FROM AH9-RECEIVER-HEADING-9                             36218093
362190     ELSE                                                         36219093
362200         WRITE AS-AUDIT-SUM-REPORT-LINE                           36220093
362300          FROM AH9-RECEIVER-HEADING-9                             36230093
362400         AFTER ADVANCING 2 LINE                                   36240093
362500         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       36250093
362600          FROM AH9-RECEIVER-HEADING-9                             36260093
362700         AFTER ADVANCING 2 LINE                                   36270093
362710     END-IF.                                                      36271093
362800                                                                  36280000
362900     ADD  +2                   TO PV-DETAIL-LINE-COUNT.           36290000
363000                                                                  36300000
363100*    SET FLAGS SO THE NEXT DETAIL OF EITHER TYPE WILL PRINT THEIR 36310000
363200*    SECTION HEADINGS FIRST                                       36320000
363300     SET PS-PRINT-PICK-HEADING                                    36330000
363400         PS-PRINT-TICK-HEADING                                    36340000
363500         PS-PRINT-RFID-HEADING          TO TRUE.                  36350000
363600                                                                  36360000
363700                                                                  36370000
363800******************************************************************36380000
363900*  3110-SELECT-RECEIVER-INFO.                                     36390000
364000******************************************************************36400000
364100 3110-SELECT-RECEIVER-INFO.                                       36410000
364200                                                                  36420000
364300*    SELECT INFO FROM THE RECEIVER TABLE                          36430000
364400     IF SU005-REC-SEQ-NBR > 0                                     36440000
364500*        SELECT INFO FROM THE RECEIVER TABLE                      36450000
364600         PERFORM 3120-SELECT-RCVR-HEADER-INFO                     36460000
364700*        SELECT THE UNITS TRANSCRIBED FROM THE RECEIVING          36470000
364800*        DISTRO TABLE                                             36480000
364900         PERFORM 3130-SELECT-UNITS-TRNSCRBD                       36490000
365000     ELSE                                                         36500000
365100         INITIALIZE PV-RECEIPT-DATE                               36510000
365200                    RECEIV-EXPTED-CART-CNT                        36520000
365300                    RECEIV-ACTL-CART-CNT                          36530000
365400                    RECEIV-PRE-TKT-IND                            36540000
365500                    RECEIV-GOH-IND                                36550000
365600                    PURCHS-DEPT-NBR                               36560000
365700                    PURCHS-NEW-STR-PO-IND                         36570000
365800                    ENTNME-ENT-NAME-DESC                          36580000
365900                    PV-UNITS-TRNSCRBD                             36590000
366000     END-IF.                                                      36600000
366100                                                                  36610000
366200                                                                  36620000
366300*    SELECT RECEIVER LEVEL INFO FROM THE CARTON AUDITING TABLES   36630000
366400                                                                  36640095
366500     IF SU005-RFID-ERRORS                                         36650000
366600        PERFORM 3135-SELECT-RF-AUDIT-COUNTS                       36660000
366700     ELSE                                                         36670000
366900        PERFORM 3140-SELECT-AUDIT-COUNTS                          36690000
367100     END-IF                                                       36710000
367300                                                                  36730000
367400*    SELECT ALL THE ASSOCIATE USER-IDS THAT HAVE WORKED ON THIS   36740000
367500*    AUDIT/RECEIVER.                                              36750000
367600     PERFORM 3150-SELECT-AUDIT-UIDS.                              36760000
367700                                                                  36770000
367800*    MOVE SQL FIELDS TO THE REPORT LINE FIELDS                    36780000
367900     MOVE SU005-PO-NBR                TO AH3-PO.                  36790000
368000     MOVE SU005-REC-SEQ-NBR           TO AH3-RECEIVER.            36800000
368100     MOVE ENTNME-ENT-NAME-DESC        TO PV-VENDOR-NAME.          36810000
368200     MOVE PV-VENDOR-NAME              TO AH2-VENDOR-NAME.         36820000
368300     MOVE PURCHS-DEPT-NBR             TO AH2-DEPT-NBR.            36830000
368400                                                                  36840000
368500     MOVE PV-RECEIPT-DATE             TO AH5-RECIPT-DATE.         36850000
368600     MOVE PURCHS-NEW-STR-PO-IND       TO AH5-NEW-STORE-IND.       36860000
368700     MOVE RECEIV-PRE-TKT-IND          TO AH3-PRETICKET-IND.       36870000
368800     MOVE RECEIV-GOH-IND              TO AH4-HANGER-IND.          36880000
368900                                                                  36890000
369000     MOVE RECEIV-EXPTED-CART-CNT      TO AH5-EST-CART-COUNT.      36900000
369100     MOVE RECEIV-ACTL-CART-CNT        TO AH7-ADJ-CART-COUNT.      36910000
369200     MOVE PV-UNITS-TRNSCRBD           TO AH4-UNITS-TRANSCRIBED.   36920000
369300*                                                                 36930000
369400     MOVE PV-AUDIT-CARTON-COUNT       TO AH6-CARTONS-AUDITED.     36940000
370600        MOVE PV-AUDIT-UNIT-COUNT         TO AH8-UNITS-AUDITED     37060000
371000                                                                  37100000
371100*    SELECT ALL THE STORES THAT WERE AUDITED FOR THIS AUDIT/      37110000
371200*    RECEIVER.                                                    37120000
371300     PERFORM 3160-SELECT-AUD-STR-NBRS.                            37130000
371310                                                                  37131095
371320     PERFORM 3170-CHECK-COMBO.                                    37132000
371330                                                                  37133095
371400                                                                  37140000
371500******************************************************************37150000
371600*  3120-SELECT-RCVR-HEADER-INFO                                   37160000
371700******************************************************************37170000
371800 3120-SELECT-RCVR-HEADER-INFO.                                    37180000
371900                                                                  37190000
372000     MOVE SU005-PO-NBR                TO DK-PO-NBR.               37200000
372100     MOVE SU005-REC-SEQ-NBR           TO DK-REC-SEQ-NBR.          37210000
372200                                                                  37220000
372300     EXEC SQL                                                     37230000
372400         SELECT                                                   37240000
372500               CHAR (DATE (A.REC_TMST), USA)                      37250000
372600             , A.EXPTED_CART_CNT                                  37260000
372700             , A.ACTL_CART_CNT                                    37270000
372800             , A.PRE_TKT_IND                                      37280000
372900             , A.GOH_IND                                          37290000
373000             , B.DEPT_NBR                                         37300000
373100             , B.NEW_STR_PO_IND                                   37310000
373200             , C.ENT_NAME_DESC                                    37320000
373300         INTO                                                     37330000
373400               :PV-RECEIPT-DATE                                   37340000
373500             , :RECEIV-EXPTED-CART-CNT                            37350000
373600             , :RECEIV-ACTL-CART-CNT                              37360000
373700             , :RECEIV-PRE-TKT-IND                                37370000
373800             , :RECEIV-GOH-IND                                    37380000
373900             , :PURCHS-DEPT-NBR                                   37390000
374000             , :PURCHS-NEW-STR-PO-IND                             37400000
374100             , :ENTNME-ENT-NAME-DESC                              37410000
374200         FROM                                                     37420000
374300               TRECEIV A                                          37430000
374400             , TPURCHS B                                          37440000
374500             , TENTNME C                                          37450000
374600         WHERE                                                    37460000
374700               A.ORD_NBR        = :DK-PO-NBR                      37470000
374800           AND A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR                 37480000
374900           AND A.ORD_NBR        = B.PO_NBR                        37490000
375000           AND B.VER_STATUS_CDE = 'A'                             37500000
375100           AND B.ENT_ID         = C.ENT_ID                        37510000
375200           AND C.TYPE_CDE       = '01'                            37520000
375300     END-EXEC.                                                    37530000
375400                                                                  37540000
375500     EVALUATE TRUE                                                37550000
375600         WHEN SQLCODE = ZERO                                      37560000
375700              CONTINUE                                            37570000
375800                                                                  37580095
376100         WHEN SQLCODE = +100                                      37610000
376200              MOVE SU005-AUD-CNTL-NBR  TO  RE-AUD-CNTL-NBR        37620000
376300              MOVE SU005-PO-NBR        TO  RE-PO                  37630000
376400              MOVE SU005-REC-SEQ-NBR   TO  RE-RCVR                37640000
376500                                                                  37650000
376510             IF  CC-FLAT-FILE                                     37651093
376540                 WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT              37654093
376550                  FROM RE-REPORT-ERROR-1                          37655093
376560             ELSE                                                 37656093
376600                  WRITE AS-AUDIT-SUM-REPORT-LINE                  37660093
376700                   FROM RE-REPORT-ERROR-1                         37670093
376800                  AFTER ADVANCING 1 LINES                         37680093
376900                  WRITE AS-AUDIT-SUM-REPORT-LINE-LOG              37690093
377000                   FROM RE-REPORT-ERROR-1                         37700093
377100                   AFTER ADVANCING 1 LINES                        37710093
377110             END-IF                                               37711093
377120                                                                  37712093
377600         WHEN SQLWARN0 NOT EQUAL SPACE                            37760000
377700         WHEN SQLCODE NOT EQUAL ZERO                              37770000
377800              DISPLAY 'PO NBR: ' DK-PO-NBR                        37780000
377900              DISPLAY 'REC SEQ NBR: ' DK-REC-SEQ-NBR              37790000
378000              MOVE '3120-SELECT-RECVR-HEADER-INFO'                37800000
378100                               TO  PV-PARAGRAPH-NAME              37810000
378200              MOVE 'SELECT RECIVER INFORMATION'                   37820000
378300                               TO  PV-DB2-OPERATION-ATTEMPTED     37830000
378400              PERFORM 9999-SQL-ABEND                              37840000
378500     END-EVALUATE.                                                37850000
378600                                                                  37860000
378700                                                                  37870000
378800******************************************************************37880000
378900*  3130-SELECT-UNITS-TRNSCRBD.                                    37890000
379000******************************************************************37900000
379100 3130-SELECT-UNITS-TRNSCRBD.                                      37910000
379200                                                                  37920000
379300     MOVE SU005-PO-NBR                TO DK-PO-NBR.               37930000
379400     MOVE SU005-REC-SEQ-NBR           TO DK-REC-SEQ-NBR.          37940000
379500     MOVE +1                          TO DN-NOT-TRANS-ID.         37950000
379600                                                                  37960000
379700     EXEC SQL                                                     37970000
379800         SELECT                                                   37980000
379900               SUM(EXPTED_ITM_QTY)                                37990000
380000         INTO                                                     38000000
380100               :PV-UNITS-TRNSCRBD :DN-NOT-TRANS-ID                38010000
380200         FROM                                                     38020000
380300               TRECDIS A                                          38030000
380400         WHERE                                                    38040000
380500               A.ORD_NBR        = :DK-PO-NBR                      38050000
380600           AND A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR                 38060000
380800     END-EXEC.                                                    38080000
380900                                                                  38090000
381000     EVALUATE TRUE                                                38100000
381100         WHEN SQLCODE = ZERO                                      38110000
381200              IF DN-NOT-TRANS-ID = -1                             38120000
381300                 MOVE ZEROES TO PV-UNITS-TRNSCRBD                 38130000
381400              END-IF                                              38140000
381500         WHEN SQLWARN0 NOT EQUAL SPACE                            38150000
381600         WHEN SQLCODE NOT EQUAL ZERO                              38160000
381700              DISPLAY 'PO-NBR       = ' DK-PO-NBR                 38170000
381800              DISPLAY 'REC-SEQ-NBR  = ' DK-REC-SEQ-NBR            38180000
381900              MOVE '3130-SELECT-UNITS-TRNSCRBD.'                  38190000
382000                               TO  PV-PARAGRAPH-NAME              38200000
382100              MOVE 'SELECT RECDIS INFORMATION'                    38210000
382200                               TO  PV-DB2-OPERATION-ATTEMPTED     38220000
382300              PERFORM 9999-SQL-ABEND                              38230000
382400     END-EVALUATE.                                                38240000
382500                                                                  38250000
382600                                                                  38260095
382700******************************************************************38270000
382800*  3135-SELECT-RF-AUDIT-COUNTS.                                   38280000
382900******************************************************************38290000
383000 3135-SELECT-RF-AUDIT-COUNTS.                                     38300000
383100** CHANGES SELECT TO SUM RFID_TGD_QTY RATHER THAN                 38310000
383200** COUNT THE TOTAL ROWS, ALSO, IGNORE 'E' SCN_TYPE CODES          38320000
383300** WHICH ARE UPC'S EXPECTED ON THE ASN BUT NOT RECEIVED           38330000
383400                                                                  38340000
383500     MOVE SU005-AUD-CNTL-NBR          TO DK-AUD-CNTL-NBR.         38350000
383600     MOVE SU005-PO-NBR                TO DK-PO-NBR.               38360000
383700     MOVE SU005-REC-SEQ-NBR           TO DK-REC-SEQ-NBR.          38370000
383800                                                                  38380000
383900     EXEC SQL                                                     38390000
384000         SELECT                                                   38400000
384100               COUNT(DISTINCT A.SHIPT_UNT_ID)                     38410000
384200             , SUM(RFID_TGD_QTY)                                  38420000
384300         INTO                                                     38430000
384400               :PV-AUDIT-CARTON-COUNT                             38440000
384500            ,  :PV-AUDIT-UNIT-COUNT                               38450000
384600         FROM                                                     38460000
384700               TSUAUPC A                                          38470000
384800             , TSUATRN B                                          38480000
384900         WHERE                                                    38490000
385000               A.AUD_CNTL_NBR   = :DK-AUD-CNTL-NBR                38500000
385100           AND A.AUD_CNTL_NBR   = B.AUD_CNTL_NBR                  38510000
385200           AND A.SHIPT_UNT_ID   = B.SHIPT_UNT_ID                  38520000
385300           AND B.TRN_NBR        = :DK-PO-NBR                      38530000
385400           AND B.REC_SEQ_NBR    = :DK-REC-SEQ-NBR                 38540000
385500           AND A.SCN_TYP_CDE   <> 'E'                             38550000
385600     END-EXEC.                                                    38560000
385700                                                                  38570000
385800     EVALUATE TRUE                                                38580000
385900         WHEN SQLCODE = ZERO                                      38590000
386000              CONTINUE                                            38600000
386100         WHEN SQLCODE = -305                                      38610000
386200              MOVE 0            TO PV-AUDIT-CARTON-COUNT          38620000
386300                                   PV-AUDIT-UNIT-COUNT            38630000
386400         WHEN SQLWARN0 NOT EQUAL SPACE                            38640000
386500         WHEN SQLCODE NOT EQUAL ZERO                              38650000
386600              DISPLAY 'AUD-CNTL-NBR     = ' DK-AUD-CNTL-NBR       38660000
386700              DISPLAY 'PO-NBR           = ' DK-PO-NBR             38670000
386800              DISPLAY 'REC-SEQ-NBR      = ' DK-REC-SEQ-NBR        38680000
386900              MOVE '3135-SELECT-RF-AUDIT-COUNTS.'                 38690000
387000                               TO  PV-PARAGRAPH-NAME              38700000
387100              MOVE 'SELECT COUNTS OF AUDIT CARTONS AND UNITS'     38710000
387200                               TO  PV-DB2-OPERATION-ATTEMPTED     38720000
387300              PERFORM 9999-SQL-ABEND                              38730000
387400     END-EVALUATE.                                                38740000
387401                                                                  38740100
387410     EXEC SQL                                                     38741000
387420         SELECT                                                   38742000
387440               SUM(SCND_UNT_QTY) - SUM(RFID_TGD_QTY)              38744000
387450         INTO                                                     38745000
387470               :PV-AUDIT-NOT-TAGGED-RFID                          38747000
387480         FROM                                                     38748000
387490               TSUAUPC A                                          38749000
387491             , TSUATRN B                                          38749100
387492             , TSUEXCP C                                          38749200
387493         WHERE                                                    38749300
387494               A.AUD_CNTL_NBR    = :DK-AUD-CNTL-NBR               38749400
387495           AND A.AUD_CNTL_NBR    = B.AUD_CNTL_NBR                 38749500
387496           AND A.SHIPT_UNT_ID    = B.SHIPT_UNT_ID                 38749600
387497           AND B.TRN_NBR         = :DK-PO-NBR                     38749700
387498           AND B.REC_SEQ_NBR     = :DK-REC-SEQ-NBR                38749800
387499           AND A.AUD_CNTL_NBR    = C.AUD_CNTL_NBR                 38749900
387500           AND A.SCN_TMST        = C.SCN_TMST                     38750000
387501           AND A.SCN_TYP_CDE     = 'E'                            38750100
387502           AND C.VILN_GP_SEQ_NBR = 42                             38750200
387503           AND C.VILN_GP_CDE     = 'VA'                           38750300
387504     END-EXEC.                                                    38750400
387505                                                                  38750500
387506     EVALUATE TRUE                                                38750600
387507         WHEN SQLCODE = ZERO                                      38750700
387508              ADD PV-AUDIT-NOT-TAGGED-RFID TO PV-AUDIT-UNIT-COUNT 38750800
387511         WHEN SQLCODE = -305                                      38751100
387512              CONTINUE                                            38751200
387514         WHEN SQLWARN0 NOT EQUAL SPACE                            38751400
387515         WHEN SQLCODE NOT EQUAL ZERO                              38751500
387516              DISPLAY 'AUD-CNTL-NBR     = ' DK-AUD-CNTL-NBR       38751600
387517              DISPLAY 'PO-NBR           = ' DK-PO-NBR             38751700
387518              DISPLAY 'REC-SEQ-NBR      = ' DK-REC-SEQ-NBR        38751800
387519              MOVE '3135-SELECT-RF-AUDIT-COUNTS.'                 38751900
387520                               TO  PV-PARAGRAPH-NAME              38752000
387521              MOVE 'SELECT COUNTS OF AUDIT CARTONS AND UNITS'     38752100
387522                               TO  PV-DB2-OPERATION-ATTEMPTED     38752200
387523              PERFORM 9999-SQL-ABEND                              38752300
387524     END-EVALUATE.                                                38752400
387530                                                                  38753095
387600                                                                  38760000
387700******************************************************************38770000
387800*  3140-SELECT-AUDIT-COUNTS.                                      38780000
387900******************************************************************38790000
388000 3140-SELECT-AUDIT-COUNTS.                                        38800000
388100** CHANGES SELECT TO SUM SCN_UNT-QTY RATHER THAN                  38810095
388200** COUNT THE TOTAL ROWS, ALSO, IGNORE 'E' SCN_TYPE CODES          38820000
388300** WHICH ARE UPC'S EXPECTED ON THE ASN BUT NOT RECEIVED           38830000
388400                                                                  38840000
388500     MOVE SU005-AUD-CNTL-NBR          TO DK-AUD-CNTL-NBR.         38850000
388600     MOVE SU005-PO-NBR                TO DK-PO-NBR.               38860000
388700     MOVE SU005-REC-SEQ-NBR           TO DK-REC-SEQ-NBR.          38870000
388800                                                                  38880000
388900     EXEC SQL                                                     38890000
389000         SELECT                                                   38900000
389100               COUNT(DISTINCT A.SHIPT_UNT_ID)                     38910000
389200             , SUM(SCND_UNT_QTY)                                  38920000
389300         INTO                                                     38930000
389400               :PV-AUDIT-CARTON-COUNT                             38940000
389500            ,  :PV-AUDIT-UNIT-COUNT                               38950000
389600         FROM                                                     38960000
389700               TSUAUPC A                                          38970000
389800             , TSUATRN B                                          38980000
389900         WHERE                                                    38990000
390000               A.AUD_CNTL_NBR   = :DK-AUD-CNTL-NBR                39000000
390100           AND A.AUD_CNTL_NBR   = B.AUD_CNTL_NBR                  39010000
390200           AND A.SHIPT_UNT_ID   = B.SHIPT_UNT_ID                  39020000
390300           AND B.TRN_NBR        = :DK-PO-NBR                      39030000
390400           AND B.REC_SEQ_NBR    = :DK-REC-SEQ-NBR                 39040000
390500           AND A.SCN_TYP_CDE   <> :PC-E                           39050000
390600     END-EXEC.                                                    39060000
390700                                                                  39070000
390800     EVALUATE TRUE                                                39080000
390900         WHEN SQLCODE = ZERO                                      39090000
391000              CONTINUE                                            39100000
391100         WHEN SQLCODE = -305                                      39110000
391200             MOVE ZEROES             TO PV-AUDIT-CARTON-COUNT     39120000
391300                                        PV-AUDIT-UNIT-COUNT       39130000
391400         WHEN SQLWARN0 NOT EQUAL SPACE                            39140000
391500         WHEN SQLCODE NOT EQUAL ZERO                              39150000
391600              DISPLAY 'AUD-CNTL-NBR     = ' DK-AUD-CNTL-NBR       39160000
391700              DISPLAY 'PO-NBR           = ' DK-PO-NBR             39170000
391800              DISPLAY 'REC-SEQ-NBR      = ' DK-REC-SEQ-NBR        39180000
391900              MOVE '3140-SELECT-AUDIT-COUNTS.'                    39190000
392000                               TO  PV-PARAGRAPH-NAME              39200000
392100              MOVE 'SELECT COUNTS OF AUDIT CARTONS AND UNITS'     39210000
392200                               TO  PV-DB2-OPERATION-ATTEMPTED     39220000
392300              PERFORM 9999-SQL-ABEND                              39230000
392400     END-EVALUATE.                                                39240000
392500                                                                  39250000
392600                                                                  39260000
392700******************************************************************39270000
392800*  3150-SELECT-AUDIT-UIDS.                                        39280000
392900* OPEN A CURSOR TO SELECT ALL THE USERIDS OF ALL THE ASSOCIATES   39290000
393000* THAT HAVE TOUCHED THIS AUDIT.                                   39300000
393100******************************************************************39310000
393200 3150-SELECT-AUDIT-UIDS.                                          39320000
393300                                                                  39330000
393400     INITIALIZE AH9-USERID-TABLE                                  39340000
393500                PV-HOLD-UID.                                      39350000
393510     MOVE SPACES  TO  AH9-USERID-TABLE.                           39351079
393600     SET AH9-UID-IDX TO +1.                                       39360000
393700     SET AH9-UID-IDX DOWN BY +1.                                  39370000
393800                                                                  39380000
393900     MOVE SU005-PO-NBR              TO DK-PO-NBR                  39390000
394000     MOVE SU005-REC-SEQ-NBR         TO DK-REC-SEQ-NBR             39400000
394100     MOVE SU005-AUD-CNTL-NBR        TO DK-AUD-CNTL-NBR            39410000
394200                                                                  39420000
394300     PERFORM 4000-OPEN-UID-CURSOR.                                39430000
394400     PERFORM 4020-FETCH-UID-CURSOR.                               39440000
394500*                                                                 39450000
394600     PERFORM UNTIL PS-EOF-UID-CURSOR                              39460000
394700         IF SUNAUD-AUD-USR-ID = PV-HOLD-UID                       39470000
394800             CONTINUE                                             39480000
394900         ELSE                                                     39490000
395000             IF AH9-UID-IDX > 0                                   39500000
395100                 MOVE ','          TO AH9-COMMA (AH9-UID-IDX)     39510000
395200             END-IF                                               39520000
395300                                                                  39530000
395400             SET AH9-UID-IDX UP BY +1                             39540000
395500             MOVE SUNAUD-AUD-USR-ID TO                            39550000
395600                             AH9-USER-ID (AH9-UID-IDX)            39560000
395700             MOVE SUNAUD-AUD-USR-ID TO PV-HOLD-UID                39570000
395800         END-IF                                                   39580000
395900         PERFORM 4020-FETCH-UID-CURSOR                            39590000
396000     END-PERFORM                                                  39600000
396100                                                                  39610000
396200     PERFORM 4010-CLOSE-UID-CURSOR.                               39620000
396300                                                                  39630000
396400                                                                  39640000
396500******************************************************************39650000
396600*  3160-SELECT-AUD-STR-NBRS.                                      39660000
396700* OPEN A CURSOR TO SELECT ALL THE USERIDS OF ALL THE ASSOCIATES   39670000
396800* THAT HAVE TOUCHED THIS AUDIT.                                   39680000
396900******************************************************************39690000
397000 3160-SELECT-AUD-STR-NBRS.                                        39700000
397100                                                                  39710000
397200     INITIALIZE PV-AUDITED-STORES-TABLE.                          39720000
397300     SET PV-AUD-STR-IDX TO +1.                                    39730000
397400     SET PV-AUD-STR-IDX DOWN BY +1.                               39740000
397500                                                                  39750000
397600     MOVE SU005-PO-NBR              TO DK-PO-NBR.                 39760000
397700     MOVE SU005-REC-SEQ-NBR         TO DK-REC-SEQ-NBR.            39770000
397800     MOVE SU005-AUD-CNTL-NBR        TO DK-AUD-CNTL-NBR.           39780000
397900                                                                  39790000
398000     PERFORM 4100-OPEN-AUD-STR-CURSOR.                            39800000
398100     PERFORM 4120-FETCH-AUD-STR-CURSOR.                           39810000
398200*                                                                 39820000
398300     PERFORM UNTIL PS-EOF-AUD-STR-CURSOR                          39830000
398400         SET PV-AUD-STR-IDX UP BY +1                              39840000
398500         IF PV-AUD-STR-IDX > PV-MAX-STORES                        39850000
398600             DISPLAY '** ABEND     **'                            39860000
398700             DISPLAY '** PROGRAM   ** = SUKRP009'                 39870000
398800             DISPLAY '** AUDITED STORE TABLE OVERFLOW **'         39880000
398900             DISPLAY '** CURRENT SIZE OF THE TABLE: '             39890000
399000                      PV-MAX-STORES                               39900000
399100             DISPLAY '** CURRENT SIZE OF THE TABLE '              39910000
399200                      'MUST BE INCREASED'                         39920000
399300             MOVE +4004 TO ABEND-CODE                             39930000
399400             CALL 'ILBOABN0' USING ABEND-CODE                     39940000
399500         END-IF                                                   39950000
399600         MOVE SUATRN-DEST-OPER-UNT-ID                             39960000
399700                             TO PV-STR-NBR (PV-AUD-STR-IDX)       39970000
399800                                                                  39980000
399900         PERFORM 4120-FETCH-AUD-STR-CURSOR                        39990000
400000     END-PERFORM.                                                 40000000
400100                                                                  40010000
400200     PERFORM 4110-CLOSE-AUD-STR-CURSOR.                           40020000
400300                                                                  40030000
400400     SET PV-STR-COUNT        TO PV-AUD-STR-IDX.                   40040000
400500                                                                  40050000
400501*SB 03/19/14 - BEGIN PR#5148D                                     40050100
400510******************************************************************40051000
400520* 3170-CHECK-COMBO                                                40052000
400530*    THIS PARAGRAPH WILL CHECK IF THE AUDIT WAS PART OF A COMBO   40053000
400540*    AUDIT OR NOT.                                                40054000
400550******************************************************************40055000
400560 3170-CHECK-COMBO.                                                40056000
400570                                                                  40057000
400580     IF AH7-PROMPTED-AUDIT                                        40058000
400590*       SYSTEM GENERATED AUDIT                                    40059000
400591        IF SUT00015-PKGNG-TYP-CDE = 'RF'                          40059100
400592*          RFID AUDIT                                             40059200
400593           INITIALIZE PV-COUNT                                    40059300
400594           PERFORM 3180-CHECK-REWORK-AUD                          40059400
400595           IF PV-COUNT > 0                                        40059500
400596*             AUDIT FOUND IN RWRK_AUD_CNTL_NBR OF OTHER AUDIT     40059600
400597              SET AH8-COMBO     TO TRUE                           40059700
400598           ELSE                                                   40059800
400599*             AUDIT NOT FOUND IN RWRK_AUD_CNTL_NBR OF OTHER AUDIT 40059900
400600              SET AH8-NOT-COMBO TO TRUE                           40060000
400601           END-IF                                                 40060100
400602        ELSE                                                      40060200
400603*          QC AUDIT                                               40060300
400604           IF SUT00015-RWRK-AUD-CNTL-NBR > 0                      40060400
400605*             PART OF COMBO                                       40060500
400606              SET AH8-COMBO     TO TRUE                           40060600
400607           ELSE                                                   40060700
400608*             NOT PART OF COMBO                                   40060800
400609              SET AH8-NOT-COMBO TO TRUE                           40060900
400610           END-IF                                                 40061000
400611        END-IF                                                    40061100
400612     ELSE                                                         40061200
400613*       MANUAL AUDIT                                              40061300
400614        PERFORM 3190-CHECK-PO-EXCEPTION                           40061400
400615        PERFORM 3195-CHECK-VENDOR-TAGGING                         40061500
400616        IF PS-VENDOR-TAGGING  OR                                  40061600
400617           PS-VENDOR-COMPLIANT                                    40061700
400618           PERFORM 3200-CHECK-DEPT-TAGGING                        40061800
400619        END-IF                                                    40061900
400620        IF PS-PO-EXCEPTION                                        40062000
400621*          THERE ARE PO EXCEPTIONS DEFINED FOR PO/DC              40062100
400622           EVALUATE SUT00014-AUD-TYP-CDE                          40062200
400623             WHEN 'Q'                                             40062300
400624             WHEN 'R'                                             40062400
400625*                 QC/RF ONLY EXCEPTION DEFINED                    40062500
400626                  SET AH8-NOT-COMBO     TO TRUE                   40062600
400627             WHEN 'A'                                             40062700
400628*                 100% EXCEPTION DEFINED                          40062800
400629                  IF (PS-VENDOR-TAGGING  OR                       40062900
400630                     PS-VENDOR-COMPLIANT) AND PS-DEPT-TAGGING     40063000
400631*                    VENDOR IS RFID TAGGING OR COMPLIANT          40063100
400632                     SET AH8-COMBO     TO TRUE                    40063200
400633                  ELSE                                            40063300
400634*                    VENDOR IS NOT RFID TAGGING OR COMPLIANT      40063400
400635                     SET AH8-NOT-COMBO     TO TRUE                40063500
400636                  END-IF                                          40063600
400637             WHEN 'N'                                             40063700
400638*                 NONE EXCEPTION DEFINED                          40063800
400639                  IF PS-VENDOR-TAGGING AND PS-DEPT-TAGGING        40063900
400640*                    VENDOR IS RFID TAGGING                       40064000
400641                     SET AH8-COMBO     TO TRUE                    40064100
400642                  ELSE                                            40064200
400643*                    VENDOR IS NOT RFID TAGGING                   40064300
400644                     SET AH8-NOT-COMBO     TO TRUE                40064400
400645                  END-IF                                          40064500
400646           END-EVALUATE                                           40064600
400647        ELSE                                                      40064700
400648*          THERE ARE NO PO EXCEPTIONS DEFINED FOR PO/DC           40064800
400649           IF PS-VENDOR-TAGGING AND PS-DEPT-TAGGING               40064900
400650*             VENDOR IS RFID TAGGING                              40065000
400651              SET AH8-COMBO     TO TRUE                           40065100
400652           ELSE                                                   40065200
400653*             VENDOR IS NOT RFID TAGGING                          40065300
400654              SET AH8-NOT-COMBO     TO TRUE                       40065400
400655           END-IF                                                 40065500
400656        END-IF                                                    40065600
400657     END-IF.                                                      40065700
400658                                                                  40065800
400659******************************************************************40065900
400660* 1410-CHECK-REWORK-AUD.                                          40066000
400661*    THIS PARAGRAPH WILL CHECK IF THE RFID AUDIT IS PRESENT IN THE40066100
400662*    REWORK AUDIT CONTROL NUMBER FOR ANY OTHER AUDIT. IF SO, IT   40066200
400663*    WILL BE A COMBO.                                             40066300
400664******************************************************************40066400
400665 3180-CHECK-REWORK-AUD.                                           40066500
400666                                                                  40066600
400667     EXEC SQL                                                     40066700
400668         SELECT VALUE(COUNT(*), 0)                                40066800
400669         INTO  :PV-COUNT                                          40066900
400670         FROM   SUT_PO_AUD_REQ                                    40067000
400671         WHERE  RWRK_AUD_CNTL_NBR = :DK-AUD-CNTL-NBR              40067100
400672     END-EXEC.                                                    40067200
400673                                                                  40067300
400674     EVALUATE TRUE                                                40067400
400675         WHEN SQLCODE = ZERO                                      40067500
400676         WHEN SQLCODE = +100                                      40067600
400677         WHEN SQLCODE = -811                                      40067700
400678              CONTINUE                                            40067800
400679         WHEN SQLWARN0 NOT = SPACES                               40067900
400680         WHEN SQLCODE < +0                                        40068000
400681         WHEN SQLCODE > ZERO                                      40068100
400682            DISPLAY DK-AUD-CNTL-NBR                               40068200
400683            MOVE '3180-CHECK-REWORK-AUD'                          40068300
400684                                   TO  PV-PARAGRAPH-NAME          40068400
400685            MOVE 'SELECT OF SUT_PO_AUD_REQ'                       40068500
400686                                   TO PV-DB2-OPERATION-ATTEMPTED  40068600
400688            PERFORM 9999-SQL-ABEND                                40068800
400689     END-EVALUATE.                                                40068900
400690                                                                  40069000
400691 3190-CHECK-PO-EXCEPTION.                                         40069100
400692                                                                  40069200
400693     INITIALIZE DCLSUT00014.                                      40069300
400694     MOVE SU005-PO-NBR    TO SUT00014-PO-NBR                      40069400
400695     MOVE DK-OPER-UNT-ID  TO SUT00014-OPER-UNT-ID                 40069500
400696                                                                  40069600
400697     EXEC SQL                                                     40069700
400698         SELECT AUD_TYP_CDE                                       40069800
400699         INTO   :SUT00014-AUD-TYP-CDE                             40069900
400700         FROM  SUT_PO_AUD_EXC                                     40070000
400701         WHERE PO_NBR      = :SUT00014-PO-NBR                     40070100
400702         AND   OPER_UNT_ID = :SUT00014-OPER-UNT-ID                40070200
400703         ORDER BY AUD_TYP_CDE DESC                                40070368
400704     END-EXEC.                                                    40070400
400705                                                                  40070500
400706     EVALUATE SQLCODE                                             40070600
400707         WHEN 0                                                   40070700
400708         WHEN -811                                                40070868
400709             SET PS-PO-EXCEPTION    TO TRUE                       40070968
400710         WHEN 100                                                 40071068
400711             SET PS-NO-PO-EXCEPTION TO TRUE                       40071168
400712         WHEN OTHER                                               40071268
400713            DISPLAY DK-AUD-CNTL-NBR                               40071368
400714            MOVE '3190-CHECK-PO-EXCEPTION'                        40071468
400715                                   TO  PV-PARAGRAPH-NAME          40071568
400716            MOVE 'SELECT OF SUT_PO_AUD_EXC'                       40071668
400717                                   TO PV-DB2-OPERATION-ATTEMPTED  40071768
400724            PERFORM 9999-SQL-ABEND                                40072400
400725     END-EVALUATE.                                                40072500
400726                                                                  40072600
400727 3195-CHECK-VENDOR-TAGGING.                                       40072700
400728                                                                  40072800
400729     INITIALIZE DCLTPURCHS                                        40072900
400730                DCLTVNDAGR.                                       40073000
400731                                                                  40073100
400732     MOVE SU005-PO-NBR    TO PURCHS-PO-NBR                        40073200
400733                                                                  40073300
400734     EXEC SQL                                                     40073400
400735         SELECT DEPT_NBR                                          40073500
400736               ,ENT_ID                                            40073600
400737         INTO   :PURCHS-DEPT-NBR                                  40073700
400738               ,:PURCHS-ENT-ID                                    40073800
400739         FROM TPURCHS                                             40073900
400740         WHERE PO_NBR = :PURCHS-PO-NBR                            40074000
400741         AND   VER_STATUS_CDE = 'A'                               40074100
400742     END-EXEC.                                                    40074200
400743                                                                  40074300
400744     EVALUATE SQLCODE                                             40074400
400745        WHEN 0                                                    40074500
400746             MOVE PURCHS-DEPT-NBR TO VNDAGR-DEPT-NBR              40074600
400747             MOVE PURCHS-ENT-ID   TO VNDAGR-ENT-ID                40074700
400748             EXEC SQL                                             40074800
400749                  SELECT TYP_CDE                                  40074900
400750                  INTO :VNDAGR-TYP-CDE                            40075000
400751                  FROM TVNDAGR                                    40075100
400752                  WHERE ENT_ID        = :VNDAGR-ENT-ID            40075200
400753                  AND DEPT_NBR        = :VNDAGR-DEPT-NBR          40075300
400754                  AND AGRMT_TYP_ID    = '4'                       40075400
400755                  AND TYP_CDE         IN (11,12)                  40075500
400756                  AND EFFECTIVE_DATE <= CURRENT DATE              40075600
400757                  AND EXPIRATION_DATE > CURRENT DATE              40075700
400758                  ORDER BY TYP_CDE                                40075800
400759                  FETCH FIRST 1 ROW ONLY                          40075900
400760             END-EXEC                                             40076000
400761                                                                  40076100
400762             EVALUATE SQLCODE                                     40076200
400763                WHEN 0                                            40076300
400764                     IF VNDAGR-TYP-CDE = 11                       40076400
400765                        SET PS-VENDOR-TAGGING     TO TRUE         40076500
400766                     ELSE                                         40076600
400767                        SET PS-VENDOR-COMPLIANT   TO TRUE         40076700
400768                     END-IF                                       40076800
400769                WHEN 100                                          40076900
400770                     SET PS-VENDOR-NOT-TAGGING    TO TRUE         40077000
400771                WHEN OTHER                                        40077100
400772                     DISPLAY DK-AUD-CNTL-NBR                      40077200
400773                     MOVE '3195-CHECK-VENDOR-TAGGING'             40077300
400774                                    TO  PV-PARAGRAPH-NAME         40077400
400775                     MOVE 'SELECT OF TVNDAGR'                     40077500
400776                                    TO PV-DB2-OPERATION-ATTEMPTED 40077600
400780                     PERFORM 9999-SQL-ABEND                       40078000
400781             END-EVALUATE                                         40078100
400782                                                                  40078200
400783        WHEN 100                                                  40078300
400784             SET PS-VENDOR-NOT-TAGGING TO TRUE                    40078400
400785        WHEN OTHER                                                40078500
400786            DISPLAY DK-AUD-CNTL-NBR                               40078600
400787            MOVE '3195-CHECK-VENDOR-TAGGING'                      40078700
400788                                   TO  PV-PARAGRAPH-NAME          40078800
400789            MOVE 'SELECT OF TPURCHS'                              40078900
400790                                   TO PV-DB2-OPERATION-ATTEMPTED  40079000
400796            PERFORM 9999-SQL-ABEND                                40079600
400797     END-EVALUATE.                                                40079700
400799                                                                  40079900
400800                                                                  40080095
400801 3200-CHECK-DEPT-TAGGING.                                         40080100
400802                                                                  40080200
400803     MOVE PURCHS-DEPT-NBR TO RIT00000-DEPT-NBR                    40080300
400804                                                                  40080400
400805     EXEC SQL                                                     40080500
400806          SELECT  'Y'                                             40080600
400807          INTO   :PS-DEPT-RFID-TAGGING-SW                         40080700
400808          FROM RIT_RFID_VRFN A                                    40080800
400809          WHERE RFID_LVL_CDE = 'STRDPT'                           40080900
400810            AND DEPT_NBR     = :RIT00000-DEPT-NBR                 40081000
400811            AND (CURRENT TIMESTAMP BETWEEN EFF_STRT_TMST          40081100
400812                AND EFF_END_TMST)                                 40081200
400813          FETCH FIRST ROW ONLY                                    40081300
400814     END-EXEC                                                     40081400
400815                                                                  40081500
400816     EVALUATE TRUE                                                40081600
400817         WHEN SQLCODE = +0                                        40081700
400818         WHEN SQLCODE = -811                                      40081800
400819             SET PS-DEPT-TAGGING TO TRUE                          40081900
400820         WHEN SQLCODE = +100                                      40082000
400821             SET PS-DEPT-NOT-TAGGING TO TRUE                      40082100
400822         WHEN OTHER                                               40082200
400823            DISPLAY DK-AUD-CNTL-NBR                               40082300
400824            MOVE '3200-CHECK-DEPT-TAGGING'                        40082400
400825                                   TO  PV-PARAGRAPH-NAME          40082500
400826            MOVE 'SELECT OF RIT_RFID_VRFN'                        40082600
400827                                   TO PV-DB2-OPERATION-ATTEMPTED  40082700
400833            PERFORM 9999-SQL-ABEND                                40083300
400834     END-EVALUATE.                                                40083400
400835                                                                  40083595
400836                                                                  40083600
400837******************************************************************40083700
400840* 4000-OPEN-UID-CURSOR.                                          *40084000
400900*  THIS PROCEDURE WILL OPEN THE UID CURSOR.                       40090000
401000******************************************************************40100000
401100 4000-OPEN-UID-CURSOR.                                            40110000
401200                                                                  40120000
401300     EXEC SQL                                                     40130000
401400          OPEN UID_CURSOR                                         40140000
401500     END-EXEC.                                                    40150000
401600                                                                  40160000
401700     EVALUATE TRUE                                                40170000
401800         WHEN SQLCODE = ZERO                                      40180000
401900              SET PS-NOT-EOF-UID-CURSOR                           40190000
402000                               TO  TRUE                           40200000
402100         WHEN SQLWARN0 NOT EQUAL SPACE                            40210000
402200         WHEN SQLCODE NOT EQUAL ZERO                              40220000
402300             DISPLAY 'AUD-CNTL-NBR = ' DK-AUD-CNTL-NBR            40230000
402400             DISPLAY 'PO-NBR       = ' DK-PO-NBR                  40240000
402500             DISPLAY 'REC-SEQ-NBR  = ' DK-REC-SEQ-NBR             40250000
402600              MOVE '4000-OPEN-UID-CURSOR'                         40260000
402700                               TO  PV-PARAGRAPH-NAME              40270000
402800              MOVE 'OPEN UID_CURSOR'                              40280000
402900                               TO  PV-DB2-OPERATION-ATTEMPTED     40290000
403000              PERFORM 9999-SQL-ABEND                              40300000
403100     END-EVALUATE.                                                40310000
403200                                                                  40320095
403300******************************************************************40330000
403400* 4010-CLOSE-UID-CURSOR.                                         *40340000
403500*  THIS PROCEDURE WILL CLOSE THE UID_CURSOR.                      40350000
403600******************************************************************40360000
403700 4010-CLOSE-UID-CURSOR.                                           40370000
403800                                                                  40380000
403900     EXEC SQL                                                     40390000
404000         CLOSE UID_CURSOR                                         40400000
404100     END-EXEC.                                                    40410000
404200                                                                  40420000
404300     EVALUATE TRUE                                                40430000
404400         WHEN SQLWARN0 NOT EQUAL SPACE                            40440000
404500         WHEN SQLCODE NOT EQUAL ZERO                              40450000
404600             DISPLAY 'AUD-CNTL-NBR = ' DK-AUD-CNTL-NBR            40460000
404700             DISPLAY 'PO-NBR       = ' DK-PO-NBR                  40470000
404800             DISPLAY 'REC-SEQ-NBR  = ' DK-REC-SEQ-NBR             40480000
404900              MOVE '4010-CLOSE-UID-CURSOR'                        40490000
405000                               TO  PV-PARAGRAPH-NAME              40500000
405100              MOVE 'CLOSE UID_CURSOR'                             40510000
405200                               TO  PV-DB2-OPERATION-ATTEMPTED     40520000
405300              PERFORM 9999-SQL-ABEND                              40530000
405400     END-EVALUATE.                                                40540000
405500                                                                  40550000
405600                                                                  40560095
405700******************************************************************40570000
405800* 4020-FETCH-UID-CURSOR                                          *40580000
405900*  THIS PROCEDURE WILL FETCH THE UID-CURSOR.                      40590000
406000******************************************************************40600000
406100 4020-FETCH-UID-CURSOR.                                           40610000
406200                                                                  40620000
406300     EXEC SQL                                                     40630000
406400          FETCH UID_CURSOR                                        40640000
406500          INTO                                                    40650000
406600                 :SUNAUD-AUD-USR-ID                               40660000
406700     END-EXEC.                                                    40670000
406800                                                                  40680000
406900     EVALUATE TRUE                                                40690000
407000         WHEN SQLCODE = ZERO                                      40700000
407100              CONTINUE                                            40710000
407200                                                                  40720000
407300         WHEN SQLCODE = +100                                      40730000
407400              SET PS-EOF-UID-CURSOR                               40740000
407500                               TO  TRUE                           40750000
407600                                                                  40760000
407700         WHEN SQLWARN0 NOT EQUAL SPACE                            40770000
407800         WHEN SQLCODE NOT EQUAL ZERO                              40780000
407900             DISPLAY 'AUD-CNTL-NBR = ' DK-AUD-CNTL-NBR            40790000
408000             DISPLAY 'PO-NBR       = ' DK-PO-NBR                  40800000
408100             DISPLAY 'REC-SEQ-NBR  = ' DK-REC-SEQ-NBR             40810000
408200              MOVE '4020-FETCH-UID-CURSOR'                        40820000
408300                               TO  PV-PARAGRAPH-NAME              40830000
408400              MOVE 'FETCH UID_CURSOR'                             40840000
408500                               TO  PV-DB2-OPERATION-ATTEMPTED     40850000
408600              PERFORM 9999-SQL-ABEND                              40860000
408700     END-EVALUATE.                                                40870000
408800                                                                  40880000
408900                                                                  40890000
409000******************************************************************40900000
409100* 4100-OPEN-AUD-STR-CURSOR.                                      *40910000
409200*  THIS PROCEDURE WILL OPEN THE AUDITED STORE CURSOR              40920000
409300******************************************************************40930000
409400 4100-OPEN-AUD-STR-CURSOR.                                        40940000
409500                                                                  40950000
409600     EXEC SQL                                                     40960000
409700          OPEN AUD_STR_CURSOR                                     40970000
409800     END-EXEC.                                                    40980000
409900                                                                  40990000
410000     EVALUATE TRUE                                                41000000
410100         WHEN SQLCODE = ZERO                                      41010000
410200              SET PS-NOT-EOF-AUD-STR-CURSOR                       41020000
410300                               TO  TRUE                           41030000
410400         WHEN SQLWARN0 NOT EQUAL SPACE                            41040000
410500         WHEN SQLCODE NOT EQUAL ZERO                              41050000
410600             DISPLAY 'AUD-CNTL-NBR = ' DK-AUD-CNTL-NBR            41060000
410700             DISPLAY 'PO-NBR       = ' DK-PO-NBR                  41070000
410800             DISPLAY 'REC-SEQ-NBR  = ' DK-REC-SEQ-NBR             41080000
410900              MOVE '4100-OPEN-AUD-STR-CURSOR'                     41090000
411000                               TO  PV-PARAGRAPH-NAME              41100000
411100              MOVE 'OPEN AUD_STR_CURSOR'                          41110000
411200                               TO  PV-DB2-OPERATION-ATTEMPTED     41120000
411300              PERFORM 9999-SQL-ABEND                              41130000
411400     END-EVALUATE.                                                41140000
411500                                                                  41150095
411600******************************************************************41160000
411700* 4110-CLOSE-AUD-STR-CURSOR.                                     *41170000
411800*  THIS PROCEDURE WILL CLOSE THE AUD-STR_CURSOR.                  41180000
411900******************************************************************41190000
412000 4110-CLOSE-AUD-STR-CURSOR.                                       41200000
412100                                                                  41210000
412200     EXEC SQL                                                     41220000
412300         CLOSE AUD_STR_CURSOR                                     41230000
412400     END-EXEC.                                                    41240000
412500                                                                  41250000
412600     EVALUATE TRUE                                                41260000
412700         WHEN SQLWARN0 NOT EQUAL SPACE                            41270000
412800         WHEN SQLCODE NOT EQUAL ZERO                              41280000
412900             DISPLAY 'AUD-CNTL-NBR = ' DK-AUD-CNTL-NBR            41290000
413000             DISPLAY 'PO-NBR       = ' DK-PO-NBR                  41300000
413100             DISPLAY 'REC-SEQ-NBR  = ' DK-REC-SEQ-NBR             41310000
413200              MOVE '4110-CLOSE-AUD-STR-CURSOR'                    41320000
413300                               TO  PV-PARAGRAPH-NAME              41330000
413400              MOVE 'CLOSE AUD_STR_CURSOR'                         41340000
413500                               TO  PV-DB2-OPERATION-ATTEMPTED     41350000
413600              PERFORM 9999-SQL-ABEND                              41360000
413700     END-EVALUATE.                                                41370000
413800                                                                  41380000
413900                                                                  41390095
414000******************************************************************41400000
414100* 4120-FETCH-AUD-STR-CURSOR                                      *41410000
414200*  THIS PROCEDURE WILL FETCH THE AUD-STR-CURSOR.                  41420000
414300******************************************************************41430000
414400 4120-FETCH-AUD-STR-CURSOR.                                       41440000
414500                                                                  41450000
414600     EXEC SQL                                                     41460000
414700          FETCH AUD_STR_CURSOR                                    41470000
414800          INTO                                                    41480000
414900                 :SUATRN-DEST-OPER-UNT-ID                         41490000
415000     END-EXEC.                                                    41500000
415100                                                                  41510000
415200     EVALUATE TRUE                                                41520000
415300         WHEN SQLCODE = ZERO                                      41530000
415400              CONTINUE                                            41540000
415500                                                                  41550000
415600         WHEN SQLCODE = +100                                      41560000
415700              SET PS-EOF-AUD-STR-CURSOR                           41570000
415800                               TO  TRUE                           41580000
415900                                                                  41590000
416000         WHEN SQLWARN0 NOT EQUAL SPACE                            41600000
416100         WHEN SQLCODE NOT EQUAL ZERO                              41610000
416200             DISPLAY 'AUD-CNTL-NBR = ' DK-AUD-CNTL-NBR            41620000
416300             DISPLAY 'PO-NBR       = ' DK-PO-NBR                  41630000
416400             DISPLAY 'REC-SEQ-NBR  = ' DK-REC-SEQ-NBR             41640000
416500              MOVE '4020-FETCH-AUD-STR-CURSOR'                    41650000
416600                               TO  PV-PARAGRAPH-NAME              41660000
416700              MOVE 'FETCH AUD-STR_CURSOR'                         41670000
416800                               TO  PV-DB2-OPERATION-ATTEMPTED     41680000
416900              PERFORM 9999-SQL-ABEND                              41690000
417000     END-EVALUATE.                                                41700000
417100                                                                  41710000
417200                                                                  41720095
417300******************************************************************41730000
417400* 8001-READ-EXTRACT-FILE - READS THE NEXT RECORD FROM THE AUDIT   41740000
417500* SUMMARY EXTRACT FILE.                                           41750000
417600******************************************************************41760000
417700 8001-READ-EXTRACT-FILE.                                          41770000
417800                                                                  41780000
417900     READ AS-AUDIT-SUM-EXTRACT-FILE                               41790000
418000         INTO SU005-EXTRACT-RECORD                                41800000
418100     AT END                                                       41810000
418200         SET PS-EOF-AUDIT-SUM-EXTRACT  TO TRUE                    41820000
418300     END-READ.                                                    41830000
418400                                                                  41840000
418500                                                                  41850000
418600******************************************************************41860000
418700*  8100-GET-LINE-NUMBER.                                          41870000
418800* SELECT THE PERCENT OF CARTONS THAT NEED TO BE AUDITED FOR A     41880000
418900* SPOTCHECK                                                       41890000
419000******************************************************************41900000
419100******************************************************************41910000
419200*   REMOVED MOVE STATEMENT FOR SKU NUMBER AND ADDED A PERFORM    *41920000
419300*   8200-CALL-XLKUT-DOMAIN-PGM. ADDED A  MOVE STATEMENT FOR ITEM *41930000
419400*   NUMBER. CHANGED THE SQL TO ADD ITEM NUMBER AS KEY INSTEAD OF *41940000
419500*   SKU SEQ NBR AND CLASS NBR. ALSO CHANGED TO DISPLAY ITEM NBR  *41950000
419600*   INSTEAD OF SKU SEQ NBR AND CLASS NBR IN EVALUATE STATEMENT.  *41960000
419700*                                                 WR # 21361     *41970000
419800******************************************************************41980000
419900 8100-GET-LINE-NUMBER.                                            41990000
420000                                                                  42000000
420100     MOVE SU005-PO-NBR             TO PURITM-PO-NBR.              42010000
420200                                                                  42020000
420300     PERFORM 8200-CALL-XLKUT-DOMAIN-PGM.                          42030000
420400     MOVE XL001-ITM-NBR            TO PURITM-ITM-NBR.             42040000
420500                                                                  42050000
420600                                                                  42060000
420700     EXEC SQL                                                     42070000
420800         SELECT                                                   42080000
420900               A.APP_PO_LNE_NBR                                   42090000
421000         INTO                                                     42100000
421100               :PURITM-APP-PO-LNE-NBR                             42110000
421200         FROM                                                     42120000
421300               TPURITM A                                          42130000
421400         WHERE                                                    42140000
421500               A.PO_NBR             = :PURITM-PO-NBR              42150000
421600           AND A.ITM_NBR            = :PURITM-ITM-NBR             42160000
421700           AND A.VER_STATUS_CDE     = 'A'                         42170000
421800           AND A.STATUS_CDE         = 'CA'                        42180000
421900     END-EXEC.                                                    42190000
422000                                                                  42200000
422100     EVALUATE TRUE                                                42210000
422200         WHEN SQLCODE = ZERO                                      42220000
422300         WHEN SQLCODE = -811                                      42230000
422400         WHEN SQLCODE = +100                                      42240000
422500              CONTINUE                                            42250000
422600         WHEN SQLWARN0 NOT EQUAL SPACE                            42260000
422700         WHEN SQLCODE NOT EQUAL ZERO                              42270000
422800              DISPLAY 'PO NBR: '       PURITM-PO-NBR              42280000
422900              DISPLAY 'ITEM NBR: '     PURITM-ITM-NBR             42290000
423000              MOVE '8100-GET-LINE-NUMBER'                         42300000
423100                               TO  PV-PARAGRAPH-NAME              42310000
423200              MOVE 'SELECT LINE NUMBER FROM PURITM'               42320000
423300                               TO  PV-DB2-OPERATION-ATTEMPTED     42330000
423400              PERFORM 9999-SQL-ABEND                              42340000
423500     END-EVALUATE.                                                42350000
423900                                                                  42390000
424000******************************************************************42400000
424100* ADDED TO FETCH ITEM NBR FROM XLKUT001  PROGRAM.                *42410095
424300******************************************************************42430000
424500 8200-CALL-XLKUT-DOMAIN-PGM.                                      42450000
424600                                                                  42460000
424700        INITIALIZE XL001-ITEM-COMMAREA.                           42470000
424800        SET XL001-BY-NUMERIC-SKU       TO TRUE.                   42480000
424900        SET XL001-SELECT-SKU           TO TRUE.                   42490000
425000                                                                  42500000
425100        MOVE  SU005-SKU-NMBR           TO  XL001-KEY-SKU.         42510000
425200                                                                  42520000
425300        CALL XL001-VSM-PGM USING XL001-ITEM-COMMAREA.             42530000
425400                                                                  42540000
425500        MOVE XL001-SKU-SQLCODE         TO SQLCODE.                42550000
425600                                                                  42560000
425700     EVALUATE TRUE                                                42570000
425800         WHEN XL001-SKU-SQLCODE = ZEROES                          42580000
425900         WHEN XL001-SKU-NOT-FOUND                                 42590000
426000              CONTINUE                                            42600000
426100         WHEN XL001-SKU-CONTENTION                                42610000
426200              DISPLAY 'SKU: '          XL001-KEY-SKU              42620000
426300              MOVE '8200-CALL-XLKUT'                              42630000
426400                               TO  PV-PARAGRAPH-NAME              42640000
426500              MOVE 'SELECT ITEM NUMBER FROM XLKUT'                42650000
426600                               TO  PV-DB2-OPERATION-ATTEMPTED     42660000
426700              PERFORM 9999-SQL-ABEND                              42670000
426800         WHEN OTHER                                               42680000
426900              DISPLAY 'SKU: '          XL001-KEY-SKU              42690000
427000              MOVE '8200-CALL-XLKUT'                              42700000
427100                               TO  PV-PARAGRAPH-NAME              42710000
427200              MOVE 'SELECT ITEM NUMBER FROM XLKUT'                42720000
427300                               TO  PV-DB2-OPERATION-ATTEMPTED     42730000
427400              PERFORM 9999-SQL-ABEND                              42740000
427500     END-EVALUATE.                                                42750000
427600                                                                  42760000
427700******************************************************************42770000
427800*  CHANGES MADE FOR WR # 21361 ENDS HERE                         *42780000
427900******************************************************************42790000
428000                                                                  42800000
428100******************************************************************42810000
428200* 9000-EOJ-ROUTINE - PRINTS A GRAND TOTAL, AND CLOSES THE DRIVER  42820000
428300* CURSOR AND THE REPORT FILE.                                     42830000
428400******************************************************************42840000
428500 9000-EOJ-ROUTINE.                                                42850000
428600                                                                  42860000
428700     IF PS-DATA                                                   42870000
428710                                                                  42871093
428720         IF  CC-FLAT-FILE                                         42872093
428750             WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                  42875093
428760              FROM END-OF-REPORT-LINE                             42876093
428761                                                                  42876199
428762             MOVE 4051 TO RETURN-CODE                             42876299
428770         ELSE                                                     42877093
428800             WRITE AS-AUDIT-SUM-REPORT-LINE                       42880093
428900              FROM END-OF-REPORT-LINE                             42890093
429000             AFTER ADVANCING 1 LINES                              42900000
429100             WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                   42910093
429200              FROM END-OF-REPORT-LINE                             42920093
429300             AFTER ADVANCING 1 LINES                              42930000
429310         END-IF                                                   42931093
429320                                                                  42932093
429400                                                                  42940000
429500*        IF THIS IS A PRINTEK PRINTER, CUT THE PAPER              42950000
429700         IF CC-PRTR-CUT-IND = 'Y'                                 42970000
429710             IF  CC-FLAT-FILE                                     42971093
429720                 MOVE SPACES  TO  AS-AUDIT-SUM-REPORT-LINE-FLAT   42972093
429730                 WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT              42973093
429740             ELSE                                                 42974093
429800                 WRITE AS-AUDIT-SUM-REPORT-LINE                   42980093
429900                  FROM DS004-PLC-CUT-FORM                         42990093
430000                 AFTER ADVANCING 1 LINE                           43000093
430070             END-IF                                               43007070
430100         END-IF                                                   43010000
430200     END-IF.                                                      43020000
430300                                                                  43030000
430310     DISPLAY 'SUKRP010 - END  '.                                  43031097
430320     DISPLAY ' '.                                                 43032097
430330                                                                  43033097
430400     CLOSE  AS-AUDIT-SUM-EXTRACT-FILE                             43040000
430500            AS-AUDIT-SUM-REPORT-FILE                              43050000
430600            AS-AUDIT-SUM-REPORT-FILE-LOG                          43060070
430610            AS-AUDIT-SUM-REPORT-FLAT-FILE.                        43061070
430700                                                                  43070000
430900******************************************************************43090000
431000* 9100-FIELD-OVERFLOW-ERROR - IF ON OF THE ACCUMULATOR FIELDS    *43100000
431100* ROLLS OVER (IE THE NUMBER IS TOO BIG TO FIT) THIS PARAGRAPH    *43110000
431200* WILL ABEND THE PROGRAM                                         *43120000
431300******************************************************************43130000
431400 9100-FIELD-OVERFLOW-ERROR.                                       43140000
431500     DISPLAY '** ABEND     **'.                                   43150000
431600     DISPLAY '** PROGRAM   ** = SUKRP010'.                        43160000
431700     DISPLAY '** PROGRAM ACCUMULATOR OVERFLOW ERROR **'.          43170000
431800     DISPLAY '** THE DATA CREATES A TOTALS VALUE LARGER THAN '.   43180000
431900     DISPLAY '** THE FIELD SET-UP TO HANDLE IT.  INCREASE THE'.   43190000
432000     DISPLAY '** THE FOLLOWING FIELD WAS TOO SMALL: '.            43200000
432100     DISPLAY PV-FIELD-NAME.                                       43210000
432200                                                                  43220000
432300     MOVE +4004 TO ABEND-CODE.                                    43230000
432400     CALL 'ILBOABN0' USING ABEND-CODE.                            43240000
432500                                                                  43250000
432600******************************************************************43260000
432700* 9999-SQL-ABEND - PERFORMS THE ABEND FOR THE PROGRAM IN THE     *43270095
432800* EVENT THAT AN SQL ERROR OR WARNING CODE OCCURS.                *43280095
432810* DATA CONTENTION                                                 43281095
432900******************************************************************43290000
433200 9999-SQL-ABEND.                                                  43320000
433300                                                                  43330095
433400     IF SQLCODE                  = -904 OR -911 OR -913           43340000
433500        MOVE +4050               TO RETURN-CODE                   43350000
433600        STOP RUN                                                  43360000
433700     ELSE                                                         43370000
433800        PERFORM 9998-ABEND-PROGRAM                                43380000
433900     END-IF.                                                      43390000
434000                                                                  43400095
434200                                                                  43420095
434400 9998-ABEND-PROGRAM.                                              43440000
434500     DISPLAY '** ABEND      **'.                                  43450000
434600     DISPLAY '** PROGRAM    ** = SUKRP010'.                       43460000
434700     DISPLAY '** PARAGRAPH  ** = ' PV-PARAGRAPH-NAME.             43470000
434800     DISPLAY '** OPERATION  ** = ' PV-DB2-OPERATION-ATTEMPTED.    43480000
434900                                                                  43490000
435000******************************************************************43500000
435100* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-   *43510000
435200* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE        *43520000
435300* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE    *43530000
435400* FORMAT.                                                        *43540000
435500******************************************************************43550000
435600     COPY DPPD004.                                                43560000
435700                                                                  43570000
435800     MOVE +4013 TO ABEND-CODE.                                    43580000
435900     CALL 'ILBOABN0' USING ABEND-CODE.                            43590000
