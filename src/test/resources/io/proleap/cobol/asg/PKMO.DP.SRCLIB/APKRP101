000100 IDENTIFICATION DIVISION.                                         00010025
000200 PROGRAM-ID.     APKRP101.                                        00020025
000300 AUTHOR.         M.WILKINSON.                                     00030025
000400 DATE-WRITTEN.   10/18/1995.                                      00040025
000500 DATE-COMPILED.                                                   00050025
000600*************************************************************     00060025
000700*    COBOL 2                                                *     00070025
000800*                                                           *     00080025
000900*    NON-INVOICED RECEIPT AGING REPORT BY DEPARTMENT        *     00090026
001000*                                                           *     00100025
001100*   PROGRAM OVERVIEW:                                       *     00110025
001200*                                                           *     00120025
001300*     THIS PROGRAM CREATES THE NON-INVOICED RECEIPTS        *     00130025
001400*   AGING BY DEPTMENT REPORT FROM AN EXTRACT FILE PRODUCED  *     00140025
001500*   IN APKUT100.                                            *     00150025
001600*                                                           *     00160025
001700*   INPUT:                                                  *     00170025
001800*                                                           *     00180025
001900*   1) NON-INVC-FILE                        (APRD042)       *     00190027
002000*                                                           *     00200025
002100*   OUTPUT:                                                 *     00210025
002200*                                                           *     00220025
002300*   1) RPT01-FILE                           (DPWS150O)      *     00230027
002400*                                                           *     00240025
002500*************************************************************     00250025
002600*   CHANGES:                                                *     00260025
002700*                                                           *     00270025
002800*    MADE MODIFICATIONS IN THE REPORT FORMAT:               *     00280025
002900*   - REVERSED THE SEQUENCE OF SETS OF COLUMNS SO THAT THE  *     00290025
003000*     NUMBER OF DAYS DESCENDS IN AGE MOVING RIGHT ACROSS    *     00300025
003100*     THE PAGE                                              *     00310025
003200*   - ADDED A VERITCAL LINE BETWEEN EACH CATEGORY TO IMPROVE*     00320025
003300*     READABILITY                                           *     00330025
003400*   - ADDED AN INDICATOR OF '**' IF THE NR IS OVER 360 DAYS *     00340025
003500*     OLD                                                   *     00350025
003600*                                                           *     00360025
003700*   02/06/95  MARY KING                                     *     00370025
003800*   - CORRECTED CALCULATION OF AGING DATES                  *     00380025
003900*                                                           *     00390025
004000*   11/10/97  CHANGE MADE:CHANGED CALL OF DATE MODULE FOR   *     00400025
004100*             Y2K                                           *     00410025
004200*             MADE BY:ROBIN BERNOSKI           WR/IR #:5703 *     00420025
004300*                                                           *     00430025
004400*   06/11/98  CHANGE MADE: Y2K. REMOVE HARDCODING OF        *     00440025
004500*             CENTURY, INCREASE JULIAN DATES TO PIC 9(07)   *     00450025
004600*             TO INCLUDE CENTURY, SEPARATE JULIAN DATES     *     00460025
004700*             INTO CC YY DDD FIELDS. ADD LOGIC TO CALCULATE *     00470025
004800*             CENTURY FOR JULIAN DATES.                     *     00480025
004900*             MADE BY: CAROLYN GIFFORD         WR/IR #:6041 *     00490025
005000*                                                           *     00500025
005100*   08/03/99  CHANGE MADE: Y2K. REPLACED THE INTRANEX       *     00510025
005200*             COPYBOOK WITH APRD042.                        *     00520025
005300*             MADE BY: ROBIN BERNOSKI          WR/IR #:6041 *     00530025
005400*                                                           *     00540027
005500* 12/08/1999 JILL JUEL                       WR/IR #: WR6041*     00550027
005600*            - MODIFIED THE CHECK ON THE DATE ROUTINE TO    *     00560027
005700*              CONFORM WITH Y2K STANDARDS BY ADDING         *     00570027
005800*              DPG54-WARNING-ERROR.                         *     00580027
005900*                                                           *     00590027
006000* 02/04/2003  CHANGED MADE: ARKPO PHASE3 PROJECT            *     00600029
006100*             INCREASED THE PO PRINT FIELD TO Z(9) AND ADDED*     00610032
006200*             PV-PO-NBR TO BE USED AS A BREAK FIELD.        *     00620032
006300*             REALIGNED THE PRINT PO NUMBER ON THE          *     00630032
006400*             DETAIL LINE FOR THE REPORT AND THE PO HEADER. *     00640030
006500*             MADE BY: MIKE BESKE             WR/IR #:23500 *     00650029
006600*                                                           *     00660030
006700* 05/21/2004  CHANGED MADE: STORE CONSTRAINTS PROJECT       *     00670033
006800*             RECOMPILED THIS PROGRAM TO PICK UP THE APRD042*     00680033
006900*             COPYBOOK MODIFICATIONS.                       *     00690033
007000*             MADE BY: MIKE BESKE             WR/IR #:25805 *     00700033
007100*                                                           *     00710033
006700* 09/10/2021  CHANGED MADE: RECOMPILE FOR NEW APRD042       *     00711034
007000*             MADE BY: JEAN KURK              CHG0260549    *     00714034
007200*************************************************************     00720025
007300/                                                                 00730025
007400 ENVIRONMENT DIVISION.                                            00740025
007500 CONFIGURATION SECTION.                                           00750025
007600 INPUT-OUTPUT SECTION.                                            00760025
007700 FILE-CONTROL.                                                    00770025
007800                                                                  00780025
007900     SELECT NON-INVC-FILE        ASSIGN TO UT-S-INP01.            00790025
008000     SELECT RPT01-FILE           ASSIGN TO UT-S-RPT01.            00800025
008100                                                                  00810025
008200 DATA DIVISION.                                                   00820025
008300 FILE SECTION.                                                    00830025
008400 FD  NON-INVC-FILE                                                00840025
008500     RECORDING MODE IS F                                          00850025
008600     LABEL RECORDS ARE STANDARD                                   00860025
008700     BLOCK CONTAINS 0 RECORDS                                     00870025
008800     DATA RECORD IS NON-INVC-RECORD.                              00880025
008900 01  NON-INVC-RECORD             PIC  X(120).                     00890025
009000                                                                  00900025
009100 FD  RPT01-FILE                                                   00910025
009200     RECORDING MODE IS F                                          00920025
009300     LABEL RECORDS ARE STANDARD                                   00930025
009400     BLOCK CONTAINS 0 RECORDS                                     00940025
009500     DATA RECORD IS RPT01-RECORD.                                 00950025
009600 01  RPT01-RECORD                PIC  X(150).                     00960025
009700                                                                  00970025
009800 EJECT                                                            00980025
009900 WORKING-STORAGE SECTION.                                         00990025
010000                                                                  01000025
010100 01  PROGRAM-CONSTANTS.                                           01010025
010200     05  PC-MAX-LINES            PIC S9(05)   COMP-3  VALUE +60.  01020025
010300                                                                  01030025
010400 01  PROGRAM-WORKAREA.                                            01040025
010500     05  FILLER                  PIC  X(30)           VALUE       01050025
010600         '** BEGINING OF APKRP101 W/S **'.                        01060025
010700                                                                  01070025
010800     05  PV-CURRENT-PARAGRAPH    PIC  X(30)           VALUE SPACE.01080025
010900     05  PV-PROGRAM-NAME         PIC  X(08)           VALUE       01090025
011000         'APKRP101'.                                              01100025
011100     05  DB2-RETRY-MAX           PIC S9(04)    COMP   VALUE +3.   01110025
011200                                                                  01120025
011300     05  PV-PO-NBR               PIC  9(09)    VALUE ZERO.        01130032
011400                                                                  01140032
011500     05  PV-YYYY-MM-DD.                                           01150025
011600         10  PV-CHECK-DATE       PIC X(10) VALUE SPACES.          01160025
011700                                                                  01170025
011800     05  PV-CURRENT-DATE.                                         01180025
011900         10  PV-CURRENT-YEAR     PIC  9(02)           VALUE 0.    01190025
012000         10  PV-CURRENT-MONTH    PIC  9(02)           VALUE 0.    01200025
012100         10  PV-CURRENT-DAY      PIC  9(02)           VALUE 0.    01210025
012200                                                                  01220025
012300     05  PV-CURRENT-JULIAN.                                       01230025
012400         10 PV-CURRENT-JUL-YY    PIC  9(02) VALUE 0.              01240025
012500         10 PV-CURRENT-JUL-DDD   PIC  9(03) VALUE 0.              01250025
012600     05  PV-CURRENT-JULIAN-CCYYDDD.                               01260025
012700         10 PV-CURRENT-JUL-CC    PIC  9(02) VALUE 0.              01270025
012800         10 PV-CURRENT-JUL-YYDDD PIC  9(05) VALUE 0.              01280025
012900                                                                  01290025
013000     05  PV-CURR-DATE-MINUS-60   PIC 9(07)            VALUE 0.    01300025
013100     05  PV-CURR-DT-MINUS-60-CH REDEFINES                         01310025
013200               PV-CURR-DATE-MINUS-60   PIC X(07).                 01320025
013300     05  PV-CURR-DATE-MINUS-90   PIC 9(07)            VALUE 0.    01330025
013400     05  PV-CURR-DT-MINUS-90-CH REDEFINES                         01340025
013500               PV-CURR-DATE-MINUS-90   PIC X(07).                 01350025
013600     05  PV-CURR-DATE-MINUS-120  PIC 9(07)            VALUE 0.    01360025
013700     05  PV-CURR-DT-MINUS-120-CH REDEFINES                        01370025
013800               PV-CURR-DATE-MINUS-120  PIC X(07).                 01380025
013900     05  PV-CURR-DATE-MINUS-180  PIC 9(07)            VALUE 0.    01390025
014000     05  PV-CURR-DT-MINUS-180-CH REDEFINES                        01400025
014100               PV-CURR-DATE-MINUS-180  PIC X(07).                 01410025
014200     05  PV-CURR-DATE-MINUS-360  PIC 9(07)            VALUE 0.    01420025
014300     05  PV-CURR-DT-MINUS-360-CH REDEFINES                        01430025
014400               PV-CURR-DATE-MINUS-360  PIC X(07).                 01440025
014500                                                                  01450025
014600     05  WS-COMPARE-CCYYDDD            PIC 9(07)      VALUE 0.    01460025
014700                                                                  01470025
014800     05  PV-CURRENT-TIME.                                         01480025
014900         10  PV-CURRENT-HOUR     PIC  9(02)           VALUE 0.    01490025
015000         10  PV-CURRENT-MINUTE   PIC  9(02)           VALUE 0.    01500025
015100         10  FILLER              PIC  9(02)           VALUE 0.    01510025
015200                                                                  01520025
015300 01  ACCUM-FIELDS.                                                01530025
015400     05  DTL-FIELDS.                                              01540025
015500         10  DTL-COST-0          PIC S9(08)V99 COMP-3 VALUE +0.   01550025
015600         10  DTL-COST-61         PIC S9(08)V99 COMP-3 VALUE +0.   01560025
015700         10  DTL-COST-91         PIC S9(08)V99 COMP-3 VALUE +0.   01570025
015800         10  DTL-COST-121        PIC S9(08)V99 COMP-3 VALUE +0.   01580025
015900         10  DTL-COST-181        PIC S9(08)V99 COMP-3 VALUE +0.   01590025
016000         10  DTL-RETAIL-0        PIC S9(08)V99 COMP-3 VALUE +0.   01600025
016100         10  DTL-RETAIL-61       PIC S9(08)V99 COMP-3 VALUE +0.   01610025
016200         10  DTL-RETAIL-91       PIC S9(08)V99 COMP-3 VALUE +0.   01620025
016300         10  DTL-RETAIL-121      PIC S9(08)V99 COMP-3 VALUE +0.   01630025
016400         10  DTL-RETAIL-181      PIC S9(08)V99 COMP-3 VALUE +0.   01640025
016500     05  TOT-FIELDS.                                              01650025
016600         10  TOT-COST-0          PIC S9(09)V99 COMP-3 VALUE +0.   01660025
016700         10  TOT-COST-61         PIC S9(09)V99 COMP-3 VALUE +0.   01670025
016800         10  TOT-COST-91         PIC S9(09)V99 COMP-3 VALUE +0.   01680025
016900         10  TOT-COST-121        PIC S9(09)V99 COMP-3 VALUE +0.   01690025
017000         10  TOT-COST-181        PIC S9(09)V99 COMP-3 VALUE +0.   01700025
017100         10  TOT-RETAIL-0        PIC S9(09)V99 COMP-3 VALUE +0.   01710025
017200         10  TOT-RETAIL-61       PIC S9(09)V99 COMP-3 VALUE +0.   01720025
017300         10  TOT-RETAIL-91       PIC S9(09)V99 COMP-3 VALUE +0.   01730025
017400         10  TOT-RETAIL-121      PIC S9(09)V99 COMP-3 VALUE +0.   01740025
017500         10  TOT-RETAIL-181      PIC S9(09)V99 COMP-3 VALUE +0.   01750025
017600     05  GR-TOT-FIELDS.                                           01760025
017700         10  GR-TOT-COST-0       PIC S9(09)V99 COMP-3 VALUE +0.   01770025
017800         10  GR-TOT-COST-61      PIC S9(09)V99 COMP-3 VALUE +0.   01780025
017900         10  GR-TOT-COST-91      PIC S9(09)V99 COMP-3 VALUE +0.   01790025
018000         10  GR-TOT-COST-121     PIC S9(09)V99 COMP-3 VALUE +0.   01800025
018100         10  GR-TOT-COST-181     PIC S9(09)V99 COMP-3 VALUE +0.   01810025
018200         10  GR-TOT-RETAIL-0     PIC S9(09)V99 COMP-3 VALUE +0.   01820025
018300         10  GR-TOT-RETAIL-61    PIC S9(09)V99 COMP-3 VALUE +0.   01830025
018400         10  GR-TOT-RETAIL-91    PIC S9(09)V99 COMP-3 VALUE +0.   01840025
018500         10  GR-TOT-RETAIL-121   PIC S9(09)V99 COMP-3 VALUE +0.   01850025
018600         10  GR-TOT-RETAIL-181   PIC S9(09)V99 COMP-3 VALUE +0.   01860025
018700                                                                  01870025
018800 01  PRINT-FIELDS.                                                01880025
018900     05  PV-LINE-COUNT           PIC S9(05)   COMP-3  VALUE +0.   01890025
019000     05  PV-PAGE-COUNT           PIC S9(05)   COMP-3  VALUE +0.   01900025
019100                                                                  01910025
019200 01  PROGRAM-SWITCHES-SUBS.                                       01920025
019300     05  PV-EOF-SW               PIC  X(01)           VALUE 'N'.  01930025
019400         88  EOF                 VALUE 'Y'.                       01940025
019500     05  PV-DATE-SW              PIC  X(01)           VALUE 'N'.  01950025
019600         88  VALID-DATE          VALUE 'Y'.                       01960025
019700         88  NOT-VALID-DATE      VALUE 'N'.                       01970025
019800 EJECT                                                            01980025
019900*  INPUT RECORD AREA                                              01990025
020000                                                                  02000025
020100     COPY APRD042.                                                02010025
020200                                                                  02020025
020300 EJECT                                                            02030025
020400*  PRINT AREA                                                     02040025
020500                                                                  02050025
020600     COPY DPWS150O.                                               02060025
020700                                                                  02070025
020800 01  HDR-LINE2.                                                   02080025
020900     05  FILLER                  PIC  X(55)   VALUE SPACES.       02090025
021000     05  HL2-TITLE               PIC  X(41)   VALUE               02100025
021100         'NON-INVOICED RECEIPTS AGING BY DEPARTMENT'.             02110025
021200     05  FILLER                  PIC  X(54)   VALUE SPACES.       02120025
021300                                                                  02130025
021400 01  HDR-LINE3.                                                   02140025
021500     05  FILLER                  PIC  X(013)   VALUE              02150025
021600         'DEPARTMENT:  '.                                         02160025
021700     05  HDR3-DEPARTMENT         PIC  9(003)   VALUE 0.           02170025
021800     05  FILLER                  PIC  X(134)   VALUE SPACE.       02180025
021900                                                                  02190025
022000 01  HDR-LINE3B.                                                  02200025
022100     05  FILLER                  PIC  X(13)    VALUE              02210025
022200         'VENDOR NAME: '.                                         02220025
022300     05  HDR3-VENDOR-NAME        PIC  X(30)    VALUE SPACE.       02230025
022400     05  FILLER                  PIC  X(02)    VALUE SPACE.       02240025
022500     05  FILLER                  PIC  X(15)    VALUE              02250025
022600         'VENDOR NUMBER: '.                                       02260025
022700     05  HDR3-VENDOR-NBR         PIC  X(09)    VALUE SPACE.       02270025
022800     05  FILLER                  PIC  X(86)    VALUE SPACE.       02280025
022900                                                                  02290025
023000 01  HDR-LINE4.                                                   02300025
023100     05  FILLER                  PIC  X(10)    VALUE              02310025
023200         'PO NBR    '.                                            02320027
023300     05  FILLER                  PIC  X(28)    VALUE              02330025
023400         '           OVER 180 DAYS    '.                          02340025
023500     05  FILLER                  PIC  X(28)    VALUE              02350025
023600         '          121 - 180 DAYS    '.                          02360025
023700     05  FILLER                  PIC  X(28)    VALUE              02370025
023800         '           91 - 120 DAYS    '.                          02380025
023900     05  FILLER                  PIC  X(28)    VALUE              02390025
024000         '           61 - 90 DAYS     '.                          02400025
024100     05  FILLER                  PIC  X(28)    VALUE              02410025
024200         '            0 - 60 DAYS     '.                          02420025
024300                                                                  02430025
024400 01  HDR-LINE5.                                                   02440025
024500     05  FILLER                  PIC  X(10)    VALUE SPACE.       02450025
024600     05  FILLER                  PIC  X(28)    VALUE              02460025
024700         '        COST        RETAIL  '.                          02470025
024800     05  FILLER                  PIC  X(28)    VALUE              02480025
024900         '        COST        RETAIL  '.                          02490025
025000     05  FILLER                  PIC  X(28)    VALUE              02500025
025100         '        COST        RETAIL  '.                          02510025
025200     05  FILLER                  PIC  X(28)    VALUE              02520025
025300         '        COST        RETAIL  '.                          02530025
025400     05  FILLER                  PIC  X(28)    VALUE              02540025
025500         '        COST        RETAIL  '.                          02550025
025600                                                                  02560025
025700 01  DETAIL-LINE.                                                 02570025
025800     05  DL-PO-NBR               PIC  Z(09)    VALUE ZERO.        02580031
025900     05  DL-OLD-IND              PIC  X(02)    VALUE SPACES.      02590025
026000     05  FILLER                  PIC  X(01)    VALUE SPACES.      02600025
026100     05  DL-COST-181             PIC  ZZZZZZZZ.99-                02610025
026200                                               BLANK WHEN ZERO.   02620025
026300     05  FILLER                  PIC  X(02)    VALUE SPACES.      02630025
026400     05  DL-RETAIL-181           PIC  ZZZZZZZZ.99-                02640025
026500                                               BLANK WHEN ZERO.   02650025
026600     05  FILLER                  PIC  X(02)    VALUE '| '.        02660025
026700     05  DL-COST-121             PIC  ZZZZZZZZ.99-                02670025
026800                                               BLANK WHEN ZERO.   02680025
026900     05  FILLER                  PIC  X(02)    VALUE SPACES.      02690025
027000     05  DL-RETAIL-121           PIC  ZZZZZZZZ.99-                02700025
027100                                               BLANK WHEN ZERO.   02710025
027200     05  FILLER                  PIC  X(02)    VALUE '| '.        02720025
027300     05  DL-COST-91              PIC  ZZZZZZZZ.99-                02730025
027400                                               BLANK WHEN ZERO.   02740025
027500     05  FILLER                  PIC  X(02)    VALUE SPACES.      02750025
027600     05  DL-RETAIL-91            PIC  ZZZZZZZZ.99-                02760025
027700                                               BLANK WHEN ZERO.   02770025
027800     05  FILLER                  PIC  X(02)    VALUE '| '.        02780025
027900     05  DL-COST-61              PIC  ZZZZZZZZ.99-                02790025
028000                                               BLANK WHEN ZERO.   02800025
028100     05  FILLER                  PIC  X(02)    VALUE SPACES.      02810025
028200     05  DL-RETAIL-61            PIC  ZZZZZZZZ.99-                02820025
028300                                               BLANK WHEN ZERO.   02830025
028400     05  FILLER                  PIC  X(02)    VALUE '| '.        02840025
028500     05  DL-COST-0               PIC  ZZZZZZZZ.99-                02850025
028600                                               BLANK WHEN ZERO.   02860025
028700     05  FILLER                  PIC  X(02)    VALUE SPACES.      02870025
028800     05  DL-RETAIL-0             PIC  ZZZZZZZZ.99-                02880025
028900                                               BLANK WHEN ZERO.   02890025
029000                                                                  02900025
029100 01  TOTAL-LINE.                                                  02910025
029200     05  FILLER                  PIC  X(03)    VALUE SPACES.      02920025
029300     05  FILLER                  PIC  X(07)    VALUE              02930025
029400         'TOTAL: '.                                               02940025
029500     05  FILLER                  PIC  X(01)    VALUE SPACES.      02950025
029600     05  TL-COST-181             PIC  ZZZZZZZZZ.99-               02960025
029700                                               BLANK WHEN ZERO.   02970025
029800     05  FILLER                  PIC  X(01)    VALUE SPACES.      02980025
029900     05  TL-RETAIL-181           PIC  ZZZZZZZZZ.99-               02990025
030000                                               BLANK WHEN ZERO.   03000025
030100     05  FILLER                  PIC  X(01)    VALUE '|'.         03010025
030200     05  TL-COST-121             PIC  ZZZZZZZZZ.99-               03020025
030300                                               BLANK WHEN ZERO.   03030025
030400     05  FILLER                  PIC  X(01)    VALUE SPACES.      03040025
030500     05  TL-RETAIL-121           PIC  ZZZZZZZZZ.99-               03050025
030600                                               BLANK WHEN ZERO.   03060025
030700     05  FILLER                  PIC  X(01)    VALUE '|'.         03070025
030800     05  TL-COST-91              PIC  ZZZZZZZZZ.99-               03080025
030900                                               BLANK WHEN ZERO.   03090025
031000     05  FILLER                  PIC  X(01)    VALUE SPACES.      03100025
031100     05  TL-RETAIL-91            PIC  ZZZZZZZZZ.99-               03110025
031200                                               BLANK WHEN ZERO.   03120025
031300     05  FILLER                  PIC  X(01)    VALUE '|'.         03130025
031400     05  TL-COST-61              PIC  ZZZZZZZZZ.99-               03140025
031500                                               BLANK WHEN ZERO.   03150025
031600     05  FILLER                  PIC  X(01)    VALUE SPACES.      03160025
031700     05  TL-RETAIL-61            PIC  ZZZZZZZZZ.99-               03170025
031800                                               BLANK WHEN ZERO.   03180025
031900     05  FILLER                  PIC  X(01)    VALUE '|'.         03190025
032000     05  TL-COST-0               PIC  ZZZZZZZZZ.99-               03200025
032100                                               BLANK WHEN ZERO.   03210025
032200     05  FILLER                  PIC  X(01)    VALUE SPACES.      03220025
032300     05  TL-RETAIL-0             PIC  ZZZZZZZZZ.99-               03230025
032400                                               BLANK WHEN ZERO.   03240025
032500 01  DASH-LINE.                                                   03250025
032600     05  FILLER                  PIC  X(150)   VALUE ALL '-'.     03260025
032700                                                                  03270025
032800 01  BLANK-LINE.                                                  03280025
032900     05  FILLER                  PIC  X(38)    VALUE SPACES.      03290025
033000     05  FILLER                  PIC  X(01)    VALUE '|'.         03300025
033100     05  FILLER                  PIC  X(27)    VALUE SPACES.      03310025
033200     05  FILLER                  PIC  X(01)    VALUE '|'.         03320025
033300     05  FILLER                  PIC  X(27)    VALUE SPACES.      03330025
033400     05  FILLER                  PIC  X(01)    VALUE '|'.         03340025
033500     05  FILLER                  PIC  X(27)    VALUE SPACES.      03350025
033600     05  FILLER                  PIC  X(01)    VALUE '|'.         03360025
033700     05  FILLER                  PIC  X(27)    VALUE SPACES.      03370025
033800                                                                  03380025
033900 01  EOR-END-OF-REPORT.                                           03390025
034000     05  FILLER                  PIC  X(52)  VALUE SPACES.        03400025
034100     05  FILLER                  PIC  X(80)  VALUE                03410025
034200         '*****  END OF REPORT *****'.                            03420025
034300                                                                  03430025
034400*** GREGORIAN/JULIAN DATE CONVERSION                              03440025
034500     COPY DPWS500.                                                03450025
034600                                                                  03460025
034700 EJECT                                                            03470025
034800*----------------------------------------------------------------*03480025
034900*  ABEND DATA AREAS                                              *03490025
035000*----------------------------------------------------------------*03500025
035100 01  ABEND-CODE                  PIC S9(04)  VALUE ZEROS          03510025
035200                                             COMP SYNC.           03520025
035300     88  AC-BAD-DATA                         VALUE +4003.         03530025
035400     88  AC-DATE-ERROR                       VALUE +4019.         03540025
035500                                                                  03550025
035600                                                                  03560025
035700 01  ABEND-AREAS.                                                 03570025
035800     05  AA-ABEND-LIT            PIC  X(40)  VALUE                03580025
035900             '*****       ABEND'.                                 03590025
036000     05  AA-PROGRAM-LIT          PIC  X(40)  VALUE                03600025
036100             '*****   PROGRAM: APKRP100'.                         03610025
036200     05  AA-PARAGRAPH-LIT.                                        03620025
036300         10  FILLER              PIC  X(17)  VALUE                03630025
036400             '***** PARAGRAPH: '.                                 03640025
036500         10  AA-PARAGRAPH-NAME   PIC  X(35)  VALUE SPACES.        03650025
036600     05  AA-MESSAGE-LINE.                                         03660025
036700         10  FILLER              PIC  X(06)  VALUE '*****'.       03670025
036800         10  AA-MESSAGE          PIC  X(127) VALUE SPACES.        03680025
036900                                                                  03690025
037000 01  FILLER                      PIC  X(25)  VALUE                03700025
037100     '** END OF APKRP101 W/S **'.                                 03710025
037200                                                                  03720025
037300 EJECT                                                            03730025
037400 PROCEDURE DIVISION.                                              03740025
037500                                                                  03750025
037600***************************************************************** 03760025
037700*  MAIN PARAGRAPH                                                 03770025
037800***************************************************************** 03780025
037900 0000-MAIN.                                                       03790025
038000                                                                  03800025
038100     MOVE '0000-MAIN'            TO   PV-CURRENT-PARAGRAPH.       03810025
038200                                                                  03820025
038300     PERFORM 1000-BEGIN-PROGRAM.                                  03830025
038400                                                                  03840025
038500     PERFORM 2000-PROCESS-DATA UNTIL EOF.                         03850025
038600                                                                  03860025
038700     PERFORM 9200-END-PROGRAM.                                    03870025
038800                                                                  03880025
038900     GOBACK.                                                      03890025
039000                                                                  03900025
039100 EJECT                                                            03910025
039200***************************************************************** 03920025
039300*  BEGIN PROGRAM STUFF                                            03930025
039400***************************************************************** 03940025
039500 1000-BEGIN-PROGRAM.                                              03950025
039600                                                                  03960025
039700     MOVE '1000-BEGIN-PROGRAM'   TO   PV-CURRENT-PARAGRAPH.       03970025
039800                                                                  03980025
039900     OPEN INPUT  NON-INVC-FILE                                    03990025
040000          OUTPUT RPT01-FILE.                                      04000025
040100                                                                  04010025
040200     ACCEPT PV-CURRENT-JULIAN    FROM DAY.                        04020025
040300     MOVE PV-CURRENT-JULIAN    TO PV-CURRENT-JUL-YYDDD.           04030025
040400     IF PV-CURRENT-JUL-YY > 80                                    04040025
040500        MOVE 19 TO PV-CURRENT-JUL-CC                              04050025
040600     ELSE                                                         04060025
040700        MOVE 20 TO PV-CURRENT-JUL-CC.                             04070025
040800                                                                  04080025
040900     PERFORM 1100-CALC-OLD-DATES.                                 04090025
041000                                                                  04100025
041100     ACCEPT PV-CURRENT-DATE      FROM DATE.                       04110025
041200     MOVE PV-CURRENT-MONTH       TO   DP150O-RUN-MONTH.           04120025
041300     MOVE PV-CURRENT-DAY         TO   DP150O-RUN-DAY.             04130025
041400     MOVE PV-CURRENT-YEAR        TO   DP150O-RUN-YEAR.            04140025
041500                                                                  04150025
041600     ACCEPT PV-CURRENT-TIME      FROM TIME.                       04160025
041700     MOVE PV-CURRENT-HOUR        TO   DP150O-RUN-HOUR.            04170025
041800     MOVE PV-CURRENT-MINUTE      TO   DP150O-RUN-MINUTE.          04180025
041900                                                                  04190025
042000     MOVE PV-PROGRAM-NAME        TO   DP150O-PROGRAM-NAME.        04200025
042100     MOVE 1                      TO   DP150O-REPORT-NUMBER.       04210025
042200                                                                  04220025
042300     MOVE 99                     TO   PV-LINE-COUNT.              04230025
042400                                                                  04240025
042500     PERFORM 8000-READ-NON-INVC-FILE.                             04250025
042600     MOVE AP042-DEPT-NBR         TO   HDR3-DEPARTMENT.            04260025
042700     IF AP042-ENT-NM-DESC = SPACES                                04270025
042800        MOVE 'UNKNOWN VENDOR'    TO   HDR3-VENDOR-NAME            04280025
042900     ELSE                                                         04290025
043000        MOVE AP042-ENT-NM-DESC   TO   HDR3-VENDOR-NAME.           04300025
043100     MOVE AP042-VND-NBR          TO   HDR3-VENDOR-NBR.            04310025
043200     MOVE AP042-PO-NBR           TO   PV-PO-NBR.                  04320032
043300                                                                  04330025
043400                                                                  04340025
043500***************************************************************** 04350025
043600*  CALCULATES DATES 60, 90, 120, 180, AND 360 DAYS PAST TO BE     04360025
043700*  USED IN DATE COMPARISONS FOR AGING.                            04370025
043800***************************************************************** 04380025
043900 1100-CALC-OLD-DATES.                                             04390025
044000                                                                  04400025
044100* CALCULATE 60 DAYS AGO                                           04410025
044200     MOVE SPACES                    TO PV-DATE-SW.                04420025
044300     INITIALIZE DPG51, DPG52, DPG53, DPG54, DPG55, DPG56.         04430025
044400     SET DPG51-ACTUAL-CALENDAR-ONLY                               04440025
044500         DPG51-DECREMENT-DATE                                     04450025
044600         DPG52-LK-DTE-JULIAN-CC     TO TRUE.                      04460025
044700     MOVE PV-CURRENT-JULIAN-CCYYDDD TO DPG52-LK-DATE-INPUT.       04470025
044800     MOVE 60                        TO DPG51-INCR-DECR-DAYS-9.    04480025
044900     PERFORM 4000-DATE-ROUTINE.                                   04490025
045000     IF VALID-DATE                                                04500025
045100         MOVE DPG55-JULIAN-DATE-CCYYDDD TO PV-CURR-DT-MINUS-60-CH 04510025
045200     ELSE                                                         04520025
045300         DISPLAY 'JULIAN DATE '  PV-CURRENT-JULIAN-CCYYDDD        04530025
045400         MOVE '1100-CALC-OLD-DATES' TO AA-PARAGRAPH-NAME          04540025
045500         MOVE 'BAD DATE CONVERSION FOR CURRENT DATE MINUS 60'     04550025
045600                                    TO AA-MESSAGE                 04560025
045700         SET AC-DATE-ERROR          TO TRUE                       04570025
045800         PERFORM 9999-ABEND                                       04580025
045900     END-IF.                                                      04590025
046000                                                                  04600025
046100* CALCULATE 90 DAYS AGO                                           04610025
046200     MOVE SPACES                    TO PV-DATE-SW.                04620025
046300     INITIALIZE DPG51, DPG52, DPG53, DPG54, DPG55, DPG56.         04630025
046400     SET DPG51-ACTUAL-CALENDAR-ONLY                               04640025
046500         DPG51-DECREMENT-DATE                                     04650025
046600**       DPG52-LK-DTE-JULIAN        TO TRUE.                      04660025
046700         DPG52-LK-DTE-JULIAN-CC     TO TRUE.                      04670025
046800     MOVE PV-CURRENT-JULIAN-CCYYDDD TO DPG52-LK-DATE-INPUT.       04680025
046900     MOVE 90                        TO DPG51-INCR-DECR-DAYS-9.    04690025
047000     PERFORM 4000-DATE-ROUTINE.                                   04700025
047100     IF VALID-DATE                                                04710025
047200**       MOVE DPG55-JULIAN-DATE-N   TO PV-CURR-DATE-MINUS-90      04720025
047300         MOVE DPG55-JULIAN-DATE-CCYYDDD TO PV-CURR-DT-MINUS-90-CH 04730025
047400     ELSE                                                         04740025
047500         DISPLAY 'JULIAN DATE '  PV-CURRENT-JULIAN-CCYYDDD        04750025
047600         MOVE '1100-CALC-OLD-DATES' TO AA-PARAGRAPH-NAME          04760025
047700         MOVE 'BAD DATE CONVERSION FOR CURRENT DATE MINUS 90'     04770025
047800                                    TO AA-MESSAGE                 04780025
047900         SET AC-DATE-ERROR          TO TRUE                       04790025
048000         PERFORM 9999-ABEND                                       04800025
048100     END-IF.                                                      04810025
048200                                                                  04820025
048300* CALCULATE 120 DAYS AGO                                          04830025
048400     MOVE SPACES                    TO PV-DATE-SW.                04840025
048500     INITIALIZE DPG51, DPG52, DPG53, DPG54, DPG55, DPG56.         04850025
048600     SET DPG51-ACTUAL-CALENDAR-ONLY                               04860025
048700         DPG51-DECREMENT-DATE                                     04870025
048800**       DPG52-LK-DTE-JULIAN        TO TRUE.                      04880025
048900         DPG52-LK-DTE-JULIAN-CC     TO TRUE.                      04890025
049000     MOVE PV-CURRENT-JULIAN-CCYYDDD TO DPG52-LK-DATE-INPUT.       04900025
049100     MOVE 120                       TO DPG51-INCR-DECR-DAYS-9.    04910025
049200     PERFORM 4000-DATE-ROUTINE.                                   04920025
049300     IF VALID-DATE                                                04930025
049400**       MOVE DPG55-JULIAN-DATE-N   TO PV-CURR-DATE-MINUS-120     04940025
049500         MOVE DPG55-JULIAN-DATE-CCYYDDD TO PV-CURR-DT-MINUS-120-CH04950025
049600     ELSE                                                         04960025
049700         DISPLAY 'JULIAN DATE '  PV-CURRENT-JULIAN-CCYYDDD        04970025
049800         MOVE '1100-CALC-OLD-DATES' TO AA-PARAGRAPH-NAME          04980025
049900         MOVE 'BAD DATE CONVERSION FOR CURRENT DATE MINUS 120'    04990025
050000                                    TO AA-MESSAGE                 05000025
050100         SET AC-DATE-ERROR          TO TRUE                       05010025
050200         PERFORM 9999-ABEND                                       05020025
050300     END-IF.                                                      05030025
050400                                                                  05040025
050500* CALCULATE 180 DAYS AGO                                          05050025
050600     MOVE SPACES                    TO PV-DATE-SW.                05060025
050700     INITIALIZE DPG51, DPG52, DPG53, DPG54, DPG55, DPG56.         05070025
050800     SET DPG51-ACTUAL-CALENDAR-ONLY                               05080025
050900         DPG51-DECREMENT-DATE                                     05090025
051000**       DPG52-LK-DTE-JULIAN        TO TRUE.                      05100025
051100         DPG52-LK-DTE-JULIAN-CC     TO TRUE.                      05110025
051200     MOVE PV-CURRENT-JULIAN-CCYYDDD TO DPG52-LK-DATE-INPUT.       05120025
051300     MOVE 180                       TO DPG51-INCR-DECR-DAYS-9.    05130025
051400     PERFORM 4000-DATE-ROUTINE.                                   05140025
051500     IF VALID-DATE                                                05150025
051600**       MOVE DPG55-JULIAN-DATE-N   TO PV-CURR-DATE-MINUS-180     05160025
051700         MOVE DPG55-JULIAN-DATE-CCYYDDD TO PV-CURR-DT-MINUS-180-CH05170025
051800     ELSE                                                         05180025
051900         DISPLAY 'JULIAN DATE '  PV-CURRENT-JULIAN-CCYYDDD        05190025
052000         MOVE '1100-CALC-OLD-DATES' TO AA-PARAGRAPH-NAME          05200025
052100         MOVE 'BAD DATE CONVERSION FOR CURRENT DATE MINUS 180'    05210025
052200                                    TO AA-MESSAGE                 05220025
052300         SET AC-DATE-ERROR          TO TRUE                       05230025
052400         PERFORM 9999-ABEND                                       05240025
052500     END-IF.                                                      05250025
052600                                                                  05260025
052700* CALCULATE 360 DAYS AGO                                          05270025
052800     MOVE SPACES                    TO PV-DATE-SW.                05280025
052900     INITIALIZE DPG51, DPG52, DPG53, DPG54, DPG55, DPG56.         05290025
053000     SET DPG51-ACTUAL-CALENDAR-ONLY                               05300025
053100         DPG51-DECREMENT-DATE                                     05310025
053200**       DPG52-LK-DTE-JULIAN        TO TRUE.                      05320025
053300         DPG52-LK-DTE-JULIAN-CC     TO TRUE.                      05330025
053400     MOVE PV-CURRENT-JULIAN-CCYYDDD TO DPG52-LK-DATE-INPUT.       05340025
053500     MOVE 360                       TO DPG51-INCR-DECR-DAYS-9.    05350025
053600     PERFORM 4000-DATE-ROUTINE.                                   05360025
053700     IF VALID-DATE                                                05370025
053800**       MOVE DPG55-JULIAN-DATE-N   TO PV-CURR-DATE-MINUS-360     05380025
053900         MOVE DPG55-JULIAN-DATE-CCYYDDD TO PV-CURR-DT-MINUS-360-CH05390025
054000     ELSE                                                         05400025
054100         DISPLAY 'JULIAN DATE '  PV-CURRENT-JULIAN-CCYYDDD        05410025
054200         MOVE '1100-CALC-OLD-DATES' TO AA-PARAGRAPH-NAME          05420025
054300         MOVE 'BAD DATE CONVERSION FOR CURRENT DATE MINUS 360'    05430025
054400                                    TO AA-MESSAGE                 05440025
054500         SET AC-DATE-ERROR          TO TRUE                       05450025
054600         PERFORM 9999-ABEND                                       05460025
054700     END-IF.                                                      05470025
054800 EJECT                                                            05480025
054900***************************************************************** 05490025
055000*  MAIN PROGRAM LOOP                                              05500025
055100*                                                                 05510025
055200*  CALLED FROM 0000-MAIN                                          05520025
055300***************************************************************** 05530025
055400 2000-PROCESS-DATA.                                               05540025
055500                                                                  05550025
055600     MOVE '2000-PROCESS-DATA'    TO   PV-CURRENT-PARAGRAPH.       05560025
055700                                                                  05570025
055800*  PROCESS INPUT RECORD                                           05580025
055900                                                                  05590025
056000     IF AP042-DEPT-NBR NOT = HDR3-DEPARTMENT                      05600025
056100        PERFORM 3000-PROCESS-DETAIL                               05610025
056200        PERFORM 3100-PROCESS-DEPARTMENT                           05620025
056300        MOVE AP042-DEPT-NBR         TO   HDR3-DEPARTMENT          05630025
056400        MOVE AP042-ENT-NM-DESC      TO   HDR3-VENDOR-NAME         05640025
056500        MOVE AP042-VND-NBR          TO   HDR3-VENDOR-NBR          05650025
056600        MOVE AP042-PO-NBR           TO   PV-PO-NBR                05660032
056700                                                                  05670025
056800        IF (PV-LINE-COUNT + 3) > PC-MAX-LINES                     05680025
056900           PERFORM 9000-WRITE-HEADING                             05690025
057000        ELSE                                                      05700025
057100          WRITE RPT01-RECORD FROM DASH-LINE AFTER 1               05710025
057200          WRITE RPT01-RECORD FROM HDR-LINE3 AFTER 1               05720025
057300          WRITE RPT01-RECORD FROM HDR-LINE3B AFTER 1              05730025
057400          ADD +3                      TO PV-LINE-COUNT            05740025
057500        END-IF                                                    05750025
057600     ELSE                                                         05760025
057700        IF AP042-ENT-NM-DESC NOT = HDR3-VENDOR-NAME               05770025
057800           PERFORM 3000-PROCESS-DETAIL                            05780025
057900           MOVE AP042-ENT-NM-DESC      TO   HDR3-VENDOR-NAME      05790025
058000           MOVE AP042-VND-NBR          TO   HDR3-VENDOR-NBR       05800025
058100           MOVE AP042-PO-NBR           TO   PV-PO-NBR             05810032
058200                                                                  05820025
058300           IF (PV-LINE-COUNT + 1) > PC-MAX-LINES                  05830025
058400              PERFORM 9000-WRITE-HEADING                          05840025
058500           ELSE                                                   05850025
058600              WRITE RPT01-RECORD FROM DASH-LINE AFTER 1           05860025
058700              WRITE RPT01-RECORD FROM HDR-LINE3B AFTER 1          05870025
058800              ADD +2                   TO PV-LINE-COUNT           05880025
058900           END-IF                                                 05890025
059000        ELSE                                                      05900025
059100           IF AP042-PO-NBR NOT  = PV-PO-NBR                       05910032
059200              PERFORM 3000-PROCESS-DETAIL                         05920025
059300              MOVE AP042-PO-NBR        TO   PV-PO-NBR             05930032
059400           END-IF                                                 05940025
059500        END-IF.                                                   05950025
059600                                                                  05960025
059700     SET NOT-VALID-DATE TO TRUE.                                  05970025
059800     MOVE AP042-REC-DTE                TO PV-CHECK-DATE.          05980025
059900                                                                  05990025
060000     MOVE SPACES                     TO PV-DATE-SW                06000025
060100     INITIALIZE DPG51, DPG52, DPG53, DPG54, DPG55, DPG56          06010025
060200     SET DPG51-ACTUAL-CALENDAR-ONLY                               06020025
060300         DPG52-LK-DTE-ISO-FMT                                     06030025
060400         DPG51-DO-NOT-INCR-DECR-DATE TO TRUE                      06040025
060500     MOVE PV-YYYY-MM-DD              TO DPG52-LK-DATE-INPUT       06050025
060600     PERFORM 4000-DATE-ROUTINE                                    06060025
060700                                                                  06070025
060800     IF VALID-DATE                                                06080025
060900          MOVE DPG55-JULIAN-DATE-CCYYDDD TO WS-COMPARE-CCYYDDD    06090025
061000        EVALUATE TRUE                                             06100025
061100          WHEN WS-COMPARE-CCYYDDD  < PV-CURR-DATE-MINUS-180       06110025
061200               PERFORM 2500-COST-181                              06120025
061300          WHEN WS-COMPARE-CCYYDDD  < PV-CURR-DATE-MINUS-120       06130025
061400               PERFORM 2400-COST-121                              06140025
061500          WHEN WS-COMPARE-CCYYDDD  < PV-CURR-DATE-MINUS-90        06150025
061600               PERFORM 2300-COST-91                               06160025
061700          WHEN WS-COMPARE-CCYYDDD  < PV-CURR-DATE-MINUS-60        06170025
061800               PERFORM 2200-COST-61                               06180025
061900          WHEN OTHER                                              06190025
062000               PERFORM 2100-COST-0                                06200025
062100        END-EVALUATE                                              06210025
062200     END-IF.                                                      06220025
062300                                                                  06230025
062400*  READ NEXT INPUT RECORD                                         06240025
062500                                                                  06250025
062600     PERFORM 8000-READ-NON-INVC-FILE.                             06260025
062700                                                                  06270025
062800 2100-COST-0.                                                     06280025
062900                                                                  06290025
063000     ADD AP042-CALCD-VRFD-RTL-AMT  TO  DTL-RETAIL-0               06300025
063100                                       TOT-RETAIL-0               06310025
063200                                       GR-TOT-RETAIL-0.           06320025
063300     ADD AP042-CALCD-VRFD-COST-AMT TO  DTL-COST-0                 06330025
063400                                       TOT-COST-0                 06340025
063500                                       GR-TOT-COST-0.             06350025
063600                                                                  06360025
063700 2200-COST-61.                                                    06370025
063800                                                                  06380025
063900     ADD AP042-CALCD-VRFD-RTL-AMT  TO  DTL-RETAIL-61              06390025
064000                                       TOT-RETAIL-61              06400025
064100                                       GR-TOT-RETAIL-61.          06410025
064200     ADD AP042-CALCD-VRFD-COST-AMT TO  DTL-COST-61                06420025
064300                                       TOT-COST-61                06430025
064400                                       GR-TOT-COST-61.            06440025
064500                                                                  06450025
064600 2300-COST-91.                                                    06460025
064700                                                                  06470025
064800     ADD AP042-CALCD-VRFD-RTL-AMT  TO  DTL-RETAIL-91              06480025
064900                                       TOT-RETAIL-91              06490025
065000                                       GR-TOT-RETAIL-91.          06500025
065100     ADD AP042-CALCD-VRFD-COST-AMT TO  DTL-COST-91                06510025
065200                                       TOT-COST-91                06520025
065300                                       GR-TOT-COST-91.            06530025
065400                                                                  06540025
065500 2400-COST-121.                                                   06550025
065600                                                                  06560025
065700     ADD AP042-CALCD-VRFD-RTL-AMT  TO  DTL-RETAIL-121             06570025
065800                                       TOT-RETAIL-121             06580025
065900                                       GR-TOT-RETAIL-121.         06590025
066000     ADD AP042-CALCD-VRFD-COST-AMT TO  DTL-COST-121               06600025
066100                                       TOT-COST-121               06610025
066200                                       GR-TOT-COST-121.           06620025
066300                                                                  06630025
066400 2500-COST-181.                                                   06640025
066500                                                                  06650025
066600     ADD AP042-CALCD-VRFD-RTL-AMT  TO  DTL-RETAIL-181             06660025
066700                                       TOT-RETAIL-181             06670025
066800                                       GR-TOT-RETAIL-181.         06680025
066900     ADD AP042-CALCD-VRFD-COST-AMT TO  DTL-COST-181               06690025
067000                                       TOT-COST-181               06700025
067100                                       GR-TOT-COST-181.           06710025
067200                                                                  06720025
067300     IF DPG55-JULIAN-DATE-CCYYDDD < PV-CURR-DATE-MINUS-360        06730025
067400        MOVE '**'     TO DL-OLD-IND                               06740025
067500     END-IF.                                                      06750025
067600 EJECT                                                            06760025
067700 3000-PROCESS-DETAIL.                                             06770025
067800                                                                  06780025
067900     MOVE PV-PO-NBR      TO DL-PO-NBR.                            06790032
068000                                                                  06800032
068100     MOVE DTL-COST-0     TO DL-COST-0.                            06810025
068200     MOVE DTL-COST-61    TO DL-COST-61.                           06820025
068300     MOVE DTL-COST-91    TO DL-COST-91.                           06830025
068400     MOVE DTL-COST-121   TO DL-COST-121.                          06840025
068500     MOVE DTL-COST-181   TO DL-COST-181.                          06850025
068600                                                                  06860025
068700     MOVE DTL-RETAIL-0   TO DL-RETAIL-0.                          06870025
068800     MOVE DTL-RETAIL-61  TO DL-RETAIL-61.                         06880025
068900     MOVE DTL-RETAIL-91  TO DL-RETAIL-91.                         06890025
069000     MOVE DTL-RETAIL-121 TO DL-RETAIL-121.                        06900025
069100     MOVE DTL-RETAIL-181 TO DL-RETAIL-181.                        06910025
069200                                                                  06920025
069300     IF PV-LINE-COUNT > PC-MAX-LINES                              06930025
069400        PERFORM 9000-WRITE-HEADING                                06940025
069500     END-IF.                                                      06950025
069600                                                                  06960025
069700     WRITE RPT01-RECORD FROM DETAIL-LINE                          06970025
069800        AFTER ADVANCING 1 LINES.                                  06980025
069900     ADD +1            TO PV-LINE-COUNT.                          06990025
070000                                                                  07000025
070100     INITIALIZE DTL-FIELDS                                        07010025
070200                DETAIL-LINE.                                      07020025
070300                                                                  07030025
070400 3100-PROCESS-DEPARTMENT.                                         07040025
070500                                                                  07050025
070600     MOVE TOT-COST-0     TO TL-COST-0.                            07060025
070700     MOVE TOT-COST-61    TO TL-COST-61.                           07070025
070800     MOVE TOT-COST-91    TO TL-COST-91.                           07080025
070900     MOVE TOT-COST-121   TO TL-COST-121.                          07090025
071000     MOVE TOT-COST-181   TO TL-COST-181.                          07100025
071100                                                                  07110025
071200     MOVE TOT-RETAIL-0   TO TL-RETAIL-0.                          07120025
071300     MOVE TOT-RETAIL-61  TO TL-RETAIL-61.                         07130025
071400     MOVE TOT-RETAIL-91  TO TL-RETAIL-91.                         07140025
071500     MOVE TOT-RETAIL-121 TO TL-RETAIL-121.                        07150025
071600     MOVE TOT-RETAIL-181 TO TL-RETAIL-181.                        07160025
071700                                                                  07170025
071800     WRITE RPT01-RECORD FROM BLANK-LINE AFTER 1.                  07180025
071900     WRITE RPT01-RECORD FROM TOTAL-LINE AFTER 1.                  07190025
072000     ADD +2            TO PV-LINE-COUNT.                          07200025
072100                                                                  07210025
072200     INITIALIZE TOT-FIELDS.                                       07220025
072300                                                                  07230025
072400 EJECT                                                            07240025
072500*----------------------------------------------------------------*07250025
072600*    CALLS THE DATE ROUTINE MODULE.                              *07260025
072700*----------------------------------------------------------------*07270025
072800 4000-DATE-ROUTINE.                                               07280025
072900                                                                  07290025
073000     CALL DP500-KOHLS-CALENDAR-ROUTINE                            07300025
073100         USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.               07310025
073200                                                                  07320025
073300     IF (DPG54-SEVERE-ERROR OR                                    07330025
073400         DPG54-WARNING-ERROR)                                     07340025
073500         SET NOT-VALID-DATE TO TRUE                               07350025
073600     ELSE                                                         07360025
073700         SET VALID-DATE TO TRUE                                   07370025
073800     END-IF.                                                      07380025
073900 EJECT                                                            07390025
074000***************************************************************** 07400025
074100*  THIS ROUTINE READS THE REPORT FILE FROM APKUT100               07410025
074200*                                                                 07420025
074300*  CALLED FROM 1000-BEGIN-PROGRAM                                 07430025
074400***************************************************************** 07440025
074500 8000-READ-NON-INVC-FILE.                                         07450025
074600                                                                  07460025
074700     MOVE '8000-READ-NON-INVC-FILE'                               07470025
074800                                 TO   PV-CURRENT-PARAGRAPH.       07480025
074900                                                                  07490025
075000     READ NON-INVC-FILE          INTO AP042-EXTRACT-FILE          07500025
075100         AT END                                                   07510025
075200             SET EOF TO TRUE.                                     07520025
075300                                                                  07530025
075400 EJECT                                                            07540025
075500***************************************************************** 07550025
075600*  REPORT AND COLUMN HEADINGS FOR BOTH REPORTS                    07560025
075700***************************************************************** 07570025
075800 9000-WRITE-HEADING.                                              07580025
075900                                                                  07590025
076000     MOVE '9000-WRITE-HEADING'   TO   PV-CURRENT-PARAGRAPH.       07600025
076100                                                                  07610025
076200*  BUMP PAGE COUNT                                                07620025
076300                                                                  07630025
076400     ADD 1                       TO   PV-PAGE-COUNT.              07640025
076500     MOVE PV-PAGE-COUNT          TO   DP150O-PAGE-NUMBER.         07650025
076600                                                                  07660025
076700*  CLEAR LINE COUNT                                               07670025
076800                                                                  07680025
076900     MOVE 0                      TO   PV-LINE-COUNT.              07690025
077000                                                                  07700025
077100*  HEADING LINE 1 (STANDARD)                                      07710025
077200                                                                  07720025
077300     WRITE RPT01-RECORD FROM DP150O-STANDRD-HEADER-150-COLS       07730025
077400           AFTER ADVANCING PAGE.                                  07740025
077500                                                                  07750025
077600*  HEADING LINE 2 APPL SPECIFIC                                   07760025
077700                                                                  07770025
077800     WRITE RPT01-RECORD FROM HDR-LINE2                            07780025
077900           AFTER ADVANCING 1 LINES.                               07790025
078000                                                                  07800025
078100*  HEADING LINE 3 APPL SPECIFIC                                   07810025
078200                                                                  07820025
078300     WRITE RPT01-RECORD FROM HDR-LINE3                            07830025
078400           AFTER ADVANCING 2 LINES.                               07840025
078500                                                                  07850025
078600     WRITE RPT01-RECORD FROM HDR-LINE3B                           07860025
078700           AFTER ADVANCING 1 LINES.                               07870025
078800                                                                  07880025
078900*  HEADING LINE 4 APPL SPECIFIC                                   07890025
079000                                                                  07900025
079100     WRITE RPT01-RECORD FROM HDR-LINE4                            07910025
079200           AFTER ADVANCING 1 LINES.                               07920025
079300                                                                  07930025
079400*  HEADING LINE 5 APPL SPECIFIC                                   07940025
079500                                                                  07950025
079600     WRITE RPT01-RECORD FROM HDR-LINE5                            07960025
079700           AFTER ADVANCING 1 LINES.                               07970025
079800                                                                  07980025
079900     MOVE SPACES TO RPT01-RECORD.                                 07990025
080000     WRITE RPT01-RECORD  AFTER ADVANCING 1 LINES.                 08000025
080100                                                                  08010025
080200     MOVE 8                      TO   PV-LINE-COUNT.              08020025
080300                                                                  08030025
080400 EJECT                                                            08040025
080500***************************************************************** 08050025
080600 9200-END-PROGRAM.                                                08060025
080700                                                                  08070025
080800     MOVE '9200-END-PROGRAM'     TO   PV-CURRENT-PARAGRAPH.       08080025
080900                                                                  08090025
081000     PERFORM 3000-PROCESS-DETAIL.                                 08100025
081100     PERFORM 3100-PROCESS-DEPARTMENT.                             08110025
081200                                                                  08120025
081300     MOVE GR-TOT-COST-0     TO TL-COST-0.                         08130025
081400     MOVE GR-TOT-COST-61    TO TL-COST-61.                        08140025
081500     MOVE GR-TOT-COST-91    TO TL-COST-91.                        08150025
081600     MOVE GR-TOT-COST-121   TO TL-COST-121.                       08160025
081700     MOVE GR-TOT-COST-181   TO TL-COST-181.                       08170025
081800                                                                  08180025
081900     MOVE GR-TOT-RETAIL-0   TO TL-RETAIL-0.                       08190025
082000     MOVE GR-TOT-RETAIL-61  TO TL-RETAIL-61.                      08200025
082100     MOVE GR-TOT-RETAIL-91  TO TL-RETAIL-91.                      08210025
082200     MOVE GR-TOT-RETAIL-121 TO TL-RETAIL-121.                     08220025
082300     MOVE GR-TOT-RETAIL-181 TO TL-RETAIL-181.                     08230025
082400                                                                  08240025
082500     WRITE RPT01-RECORD FROM BLANK-LINE AFTER 1.                  08250025
082600     WRITE RPT01-RECORD FROM TOTAL-LINE AFTER 1.                  08260025
082700     ADD +2            TO PV-LINE-COUNT.                          08270025
082800                                                                  08280025
082900     WRITE RPT01-RECORD FROM EOR-END-OF-REPORT                    08290025
083000           AFTER ADVANCING 2 LINES.                               08300025
083100                                                                  08310025
083200*----------------------------------------------------------------*08320025
083300*    ABEND ROUTINE                                               *08330025
083400*----------------------------------------------------------------*08340025
083500 9999-ABEND.                                                      08350025
083600                                                                  08360025
083700     CLOSE  NON-INVC-FILE                                         08370025
083800            RPT01-FILE.                                           08380025
083900                                                                  08390025
084000     DISPLAY AA-ABEND-LIT.                                        08400025
084100     DISPLAY AA-PROGRAM-LIT.                                      08410025
084200     DISPLAY AA-PARAGRAPH-LIT.                                    08420025
084300     DISPLAY AA-MESSAGE-LINE.                                     08430025
084400     CALL 'ILBOABN0' USING ABEND-CODE.                            08440025
