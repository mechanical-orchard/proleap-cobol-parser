000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             KSKUT003.                                00050000
000600 AUTHOR.                 RICK TULLOCH.                            00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN.           10-08-13.                                00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200*       THIS PROGRAM READS THROUGH THE MERCHANDISE HIERARCHY     *00120000
001300*  DEPARTMENT LEVEL DATA SYSTEM OF RECORD EXTRACT AND PREPARES   *00130000
001400*  A DEPARTMENT CSV FILE FOR USE BY SERVICE MANAGEMENT.  A CSV   *00140004
001500*  COLUMN HEADER LINE WILL BE WRITTEN AS THE FIRST RECORD OF THE *00150004
001600*  FILE.                                                         *00160004
001916******************************************************************00191600
001917                                                                  00191700
001918******************************************************************00191800
001919 ENVIRONMENT DIVISION.                                            00191900
001920******************************************************************00192000
001930                                                                  00193000
001940 CONFIGURATION SECTION.                                           00194000
001950                                                                  00195000
001960 SOURCE-COMPUTER.        IBM-3090.                                00196000
001970 OBJECT-COMPUTER.        IBM-3090.                                00197000
001980                                                                  00198000
001990 INPUT-OUTPUT SECTION.                                            00199000
002000                                                                  00200000
002100 FILE-CONTROL.                                                    00210000
002200                                                                  00220000
002300     SELECT HM-DEPT-DATA-EXTRACT-FILE                             00230000
002400         ASSIGN TO INP01.                                         00240000
002500                                                                  00250000
002600     SELECT SRV-MGT-DEPT-FILE                                     00260000
002700         ASSIGN TO OUT01.                                         00270000
003100                                                                  00310000
003200******************************************************************00320000
003300 DATA DIVISION.                                                   00330000
003400******************************************************************00340000
003500                                                                  00350000
003600 FILE SECTION.                                                    00360000
003700                                                                  00370000
003800 FD  HM-DEPT-DATA-EXTRACT-FILE                                    00380000
003900     RECORDING MODE IS F                                          00390000
004000     LABEL RECORDS ARE STANDARD                                   00400000
004100     BLOCK CONTAINS 0 RECORDS                                     00410000
004200     RECORD CONTAINS 54 CHARACTERS                                00420000
004300     DATA RECORDS IS HD-HM-DEPT-DATA-EXTRACT-RECORD.              00430000
004400                                                                  00440000
004500 01  HD-HM-DEPT-DATA-EXTRACT-RECORD                               00450000
004600                                 PIC X(54).                       00460000
004700                                                                  00470000
004800 FD  SRV-MGT-DEPT-FILE                                            00480000
004900     RECORDING MODE IS F                                          00490000
005000     LABEL RECORDS ARE STANDARD                                   00500000
005100     BLOCK CONTAINS 0 RECORDS                                     00510000
005200     RECORD CONTAINS 27 CHARACTERS                                00520000
005300     DATA RECORDS IS SM-SRV-MGT-DEPT-RECORD.                      00530000
005400                                                                  00540000
005500 01  SM-SRV-MGT-DEPT-RECORD      PIC X(27).                       00550000
006510                                                                  00651000
006520 WORKING-STORAGE SECTION.                                         00652000
006530                                                                  00653000
006540*                                                                 00654000
006550*  MERCHANDISE HIERARCHY DOMAIN EXTRACT - DEPARTMENT LEVEL DATA   00655000
006560*  RECORD LAYOUT                                                  00656000
006561*                                                                 00656100
006570                                                                  00657000
006580     COPY HMRD008.                                                00658000
007230                                                                  00723000
007240 01  PS-PROGRAM-SWITCHES.                                         00724000
007250     05  PS-END-OF-EXTRACT-FILE-SW                                00725000
007260                                 PIC X(1)     VALUE 'N'.          00726000
007270         88  PS-END-OF-EXTRACT-FILE           VALUE 'Y'.          00727000
007280                                                                  00728000
007290 01  PC-PROGRAM-CONSTANTS.                                        00729000
007300     05  PC-CURRENT-PROGRAM-NAME PIC X(8)     VALUE 'KSKUT003'.   00730000
007400     05  PC-QUOTATION-MARK       PIC X(1)     VALUE '"'.          00740003
007410     05  PC-DEPT-NBR-HEADING     PIC X(4)     VALUE 'DEPT'.       00741000
007420     05  PC-DEPT-NM-HEADING      PIC X(9)     VALUE 'DEPT NAME'.  00742000
007500                                                                  00750000
007600 01  PV-PROGRAM-VARIABLES.                                        00760000
007700     05  PV-STR-DEPT-NM-STRING   PIC X(22)    VALUE SPACES.       00770000
008900                                                                  00890000
009000 01  DC-DEPT-CSV-RECORD.                                          00900000
009100     05  DC-DEPT-NBR-X.                                           00910000
009200         10  DC-DEPT-NBR         PIC 9(4)     VALUE ZEROS.        00920000
009400         10  FILLER              PIC X(1)     VALUE SPACES.       00940000
009410             88  DC-COMMA-SEPARATOR           VALUE ','.          00941000
009500         10  DC-DEPT-NM-STRING   PIC X(22)    VALUE SPACES.       00950001
010000                                                                  01000000
010100******************************************************************01010000
010200 PROCEDURE DIVISION.                                              01020000
010300******************************************************************01030000
010400                                                                  01040000
010500 0000-MAINLINE.                                                   01050000
010600                                                                  01060000
010700     PERFORM 1000-INITIALIZE.                                     01070000
010800                                                                  01080000
010900     PERFORM 2000-PROCESS-DEPT-EXTRACT                            01090000
011000         UNTIL PS-END-OF-EXTRACT-FILE.                            01100000
011100                                                                  01110000
011200     PERFORM 9000-EOJ-ROUTINE.                                    01120000
011300                                                                  01130000
011400     GOBACK.                                                      01140000
011500                                                                  01150000
011600******************************************************************01160000
011700*  INITIALIZE FOR PROGRAM PROCESSING.  OPEN ALL FILES, AND       *01170000
011800*  PERFORM A PRIMING READ ON THE MERCHANDISE HIERARCHY EXTRACT   *01180000
011900*  FILE.  WRITE THE SERVICE MANAGEMENT DEPARTMENT CSV FILE       *01190001
012000*  COLUMN HEADER RECORD.                                         *01200004
012200******************************************************************01220000
012300                                                                  01230000
012400 1000-INITIALIZE.                                                 01240000
012960     OPEN INPUT  HM-DEPT-DATA-EXTRACT-FILE                        01296000
012970          OUTPUT SRV-MGT-DEPT-FILE.                               01297000
012990                                                                  01299000
013000     PERFORM 7000-READ-HM-DEPT-FILE.                              01300000
013010                                                                  01301001
013100     INITIALIZE DC-DEPT-CSV-RECORD.                               01310001
013200     MOVE PC-DEPT-NBR-HEADING TO DC-DEPT-NBR-X.                   01320001
013210     SET DC-COMMA-SEPARATOR TO TRUE.                              01321001
013220     MOVE PC-DEPT-NM-HEADING TO PV-STR-DEPT-NM-STRING.            01322001
013230     STRING PC-QUOTATION-MARK        DELIMITED BY SIZE            01323001
013240            PV-STR-DEPT-NM-STRING    DELIMITED BY '  '            01324001
013250            PC-QUOTATION-MARK        DELIMITED BY SIZE            01325001
013260         INTO DC-DEPT-NM-STRING.                                  01326001
013270                                                                  01327001
013280     PERFORM 8000-WRITE-SM-DEPT-EXTR-RECORD.                      01328001
013300*1000-EXIT.                                                       01330000
013400                                                                  01340000
016223******************************************************************01622300
016224*  PROCESS A MERCHANDISE HIERARCHY DEPARTMENT LEVEL DATA EXTRACT *01622404
016225*  RECORD.  REFORMAT THE REQUIRED ATTRIBUTES TO CREATE THE       *01622504
016226*  SERVICE MANAGEMENT DEPARTMENT CSV RECORD, CREATING A STRING   *01622604
016227*  IN QUOTES OF THE DEPARTMENT NAME, WITH TRAILING SPACES        *01622704
016228*  REMOVED.  WRITE THE SERVICE MANAGEMENT DEPARTMENT CSV RECORD. *01622804
016229*  READ THE NEXT MERCHANDISE HIERARCHY DEPARTMENT LEVEL DATA     *01622904
016230*  EXTRACT RECORD.                                               *01623004
016231******************************************************************01623104
016232                                                                  01623204
016233 2000-PROCESS-DEPT-EXTRACT.                                       01623304
016234     INITIALIZE DC-DEPT-CSV-RECORD.                               01623404
016235     MOVE HM008-DEPT-NBR TO DC-DEPT-NBR.                          01623504
016236     SET DC-COMMA-SEPARATOR TO TRUE.                              01623604
016237     MOVE HM008-STR-DEPT-NM TO PV-STR-DEPT-NM-STRING.             01623704
016238     STRING PC-QUOTATION-MARK        DELIMITED BY SIZE            01623804
016239            PV-STR-DEPT-NM-STRING    DELIMITED BY '  '            01623904
016240            PC-QUOTATION-MARK        DELIMITED BY SIZE            01624004
016250         INTO DC-DEPT-NM-STRING.                                  01625004
017400                                                                  01740000
017500     PERFORM 8000-WRITE-SM-DEPT-EXTR-RECORD.                      01750000
017600                                                                  01760000
017610     PERFORM 7000-READ-HM-DEPT-FILE.                              01761000
017800*2000-EXIT.                                                       01780000
017900                                                                  01790000
018000******************************************************************01800000
018100*  READ A MERCHANDISE HIERARCHY DEPARTMENT LEVEL DATA EXTRACT    *01810000
018110*  RECORD.                                                       *01811000
018200******************************************************************01820000
018300                                                                  01830000
018400 7000-READ-HM-DEPT-FILE.                                          01840000
018500     READ HM-DEPT-DATA-EXTRACT-FILE                               01850002
018600         INTO HMRD008-RECORD                                      01860000
018700         AT END                                                   01870000
018800             SET PS-END-OF-EXTRACT-FILE TO TRUE                   01880000
018900     END-READ.                                                    01890000
019000*7000-EXIT.                                                       01900000
019100                                                                  01910000
019200******************************************************************01920000
019300*  WRITE A SERVICE MANAGEMENT DEPARTMENT EXTRACT RECORD.         *01930000
019400******************************************************************01940000
019500                                                                  01950000
019600 8000-WRITE-SM-DEPT-EXTR-RECORD.                                  01960000
019700     WRITE SM-SRV-MGT-DEPT-RECORD                                 01970000
019800         FROM DC-DEPT-CSV-RECORD.                                 01980000
019900*8000-EXIT.                                                       01990000
020900                                                                  02090000
021000******************************************************************02100000
021100*  CLOSE ALL FILES.                                              *02110000
021200******************************************************************02120000
021300                                                                  02130000
021400 9000-EOJ-ROUTINE.                                                02140000
021500     CLOSE HM-DEPT-DATA-EXTRACT-FILE                              02150000
021700           SRV-MGT-DEPT-FILE.                                     02170000
021800*9000-EXIT.                                                       02180000
