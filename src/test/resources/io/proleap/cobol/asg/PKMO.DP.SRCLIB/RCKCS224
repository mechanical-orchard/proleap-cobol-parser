000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    RCKCS224.                                         00040000
000500 AUTHOR.        JOHN GREFFER (STRATAGEM, INC.).                   00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  04-02-93.                                         00070000
000800 DATE-COMPILED.                                                   00080000
000900*----------------------------------------------------------------*00090000
001000*    E224 - RECEIVING TRAILER CRITERIA SPECIFICATION             *00100000
001100*                                                                *00110000
001200*    THIS PROGRAM ALLOWS THE USER TO ENTER DATA TO BE USED BY    *00120000
001300*    SUBSEQUENT PROGRAMS TO CREATE A LIST OR TO BRING UP A       *00130000
001400*    DETAIL SCREEN.  WHEN ENTERED, THE TRAILER NUMBER AND        *00140000
001500*    CARRIER ARE EDITTED TO BE VALID.  ALL OTHER EDITS ARE DONE  *00150000
001600*    IN THE DESTINATION PROGRAMS WHEN THE 'GO-TO' TYPE FUNCTION  *00160000
001700*    IS USED.                                                    *00170000
001800*----------------------------------------------------------------*00180000
001900*               C H A N G E    L O G                              00190004
002000*----------------------------------------------------------------*00200000
002100*    2012-02-06 CHRISTINE TWIEHAUS WR40574                       *00210000
002200*               ADDED CAN TO SCREEN - DISPLAY ONLY, NO LOOKUP    *00220000
002300*----------------------------------------------------------------*00230000
002400*                                                                 00240000
002500*----------------------------------------------------------------*00250000
002600*    2013-04-15 SHRIRAM (COGNIZANT) CHG0052003                   *00260000
002700*               INTRODUCED TWO VARIABLES TO UPDATE VALUES FOR    *00270000
002800*               INBOUND-TRIP-ID AND THE SELECT-DATE IN THE       *00280000
002900*               PARAGRAPH '5700-UP-VEH-INFO'                     *00290000
003000*                                                                *00300000
003100*               NEW PARAGRAPH '5710-GET-PARM-DATE' IS INTRODUCED *00310000
003200*               TO FETCH THE DATE FROM TKRPRPM TABLE             *00320000
003300*----------------------------------------------------------------*00330000
003400*                                                                 00340000
003500*----------------------------------------------------------------*00350000
003600*    2013-12-27 ROOPA S P                                        *00360000
003700*               INTRODUCED EFC SHIPMENT NUMBER FOR THE           *00370000
003800*               REQUIREMENT LOCATE BY TRAILER                    *00380000
003900*               CHANGES ARE TAGGED AS ROOPA START AND ROOPA      *00390000
004000*               END                                              *00400000
004100*----------------------------------------------------------------*00410000
004101* CHANGED 11/10/2021    BY JIM HUNTER      WR: CHG0263784         00410122
004102* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00410223
004103* MAKING THE CALL DYNAMIC VS STATIC.                              00410323
004104*---------------------------------------------------------------* 00410423
004200                                                                  00420000
004300 ENVIRONMENT DIVISION.                                            00430000
004400                                                                  00440000
004500                                                                  00450000
004600                                                                  00460000
004700 DATA DIVISION.                                                   00470000
004800                                                                  00480000
004900                                                                  00490000
005000 WORKING-STORAGE SECTION.                                         00500000
005100*                                                                 00510000
005200                                                                  00520000
005300 01  DK-DB2-KEYS.                                                 00530000
005400     05  DK-OWNER-SCAC-ID          PIC  X(04)  VALUE SPACE.       00540000
005500     05  DK-VEH-NBR                PIC  X(10)  VALUE SPACE.       00550000
005600     05  DK-OPER-UNT-ID            PIC S9(04)  VALUE +0 COMP.     00560000
005700     05  DK-FCLTY-ID               PIC S9(04)  VALUE +0 COMP.     00570000
005800     05  DK-CURR-OPER-UNT-ID       PIC S9(04)  VALUE +0 COMP.     00580000
005900     05  DK-CURR-FCLTY-ID          PIC S9(04)  VALUE +0 COMP.     00590000
006000     05  DK-PRTR-ID                PIC S9(04)  VALUE +0 COMP.     00600000
006100     05  DK-PO-NBR                 PIC S9(09)  VALUE +0 COMP.     00610000
006200     05  DK-TRIP-ID                PIC S9(09)  VALUE +0 COMP.     00620000
006300*                                                                 00630012
006400     05  DK-SCR-SHIP               PIC  X(10)  VALUE SPACE.       00640000
006500*                                                                 00650012
006600     05  DK-SCR-TRIP               PIC S9(09)  VALUE +0 COMP.     00660000
006700     05  DK-ARRIVAL-DTE            PIC  X(10)  VALUE SPACE.       00670000
006800     05  DK-DEPT-NBR               PIC  X(03)  VALUE SPACE.       00680000
006900     05  DK-ORD-NBR                PIC S9(09)  VALUE +0 COMP.     00690000
007000     05  DK-REC-SEQ-NBR            PIC S9(09)  VALUE +0 COMP.     00700000
007100     05  DK-SHIPT-ID               PIC S9(09)  VALUE +0 COMP.     00710000
007200     05  DK-CNTL-DESC              PIC X(07)   VALUE SPACES.      00720000
007300                                                                  00730000
007400 01  DN-NULL-INDICATORS.                                          00740000
007500     05  DN-AD-EVNT-DTE            PIC S9(04) COMP VALUE +0.      00750000
007600     05  DN-TKT-FMT-ID             PIC S9(04) COMP VALUE +0.      00760000
007700     05  DN-CURR-TRIP-ID           PIC S9(04) COMP VALUE +0.      00770000
007800     05  DN-VEH-NBR                PIC S9(4) COMP VALUE +0.       00780000
007900     05  DN-EST-AR-TMST            PIC S9(4) COMP VALUE +0.       00790000
008000                                                                  00800000
008100 01  PC-PROGRAM-CONSTANTS.                                        00810000
008200     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE  'RC224A  '. 00820000
008300     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE  'RCKM224 '. 00830000
008400     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE  'RCKCS224'. 00840000
008500     05  PC-REPORT-PROGRAM-NAME    PIC  X(08)  VALUE  'PCKCS112'. 00850000
008600     05  PC-DPKUT500               PIC  X(08)  VALUE  'DPKUT500'. 00860000
008700     05  PC-DPKCS060               PIC  X(08)  VALUE  'DPKCS060'. 00870000
008800     05  PC-RANDNBR-PGM            PIC  X(08)  VALUE  'DPKUT902'. 00880000
008900     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            00890000
009000                                               COMP-3.            00900000
009100     05  PC-DEFAULT-DATE              PIC X(10)  VALUE            00910000
009200                                                 '0001-01-01'.    00920000
009300     05  PC-DEFAULT-TIME              PIC X(08)  VALUE            00930000
009400                                                 '00.00.00'.      00940000
009500     05  PC-PRE-TICKETED                 PIC  X(15)  VALUE        00950000
009600         'PRE TICKETED   '.                                       00960000
009700     05  PC-PACKED-BY-STORE              PIC  X(15)  VALUE        00970000
009800         'PACKED BY STORE'.                                       00980000
009900     05  PC-DETAIL-CHECK                 PIC  X(12)  VALUE        00990000
010000         'DETAIL CHECK'.                                          01000000
010100     05  PC-MULTIPLE-SHIPMENTS           PIC  X(18)  VALUE        01010000
010200         'MULTIPLE SHIPMENTS'.                                    01020000
010300     05  PC-ON-HANGER                    PIC  X(09)  VALUE        01030000
010400         'ON HANGER'.                                             01040000
010500     05  PC-AR                           PIC  X(02)  VALUE 'AR'.  01050000
010600     05  PC-ET                           PIC  X(02)  VALUE 'ET'.  01060000
010700     05  PC-A                            PIC  X(01)  VALUE 'A'.   01070000
010800     05  PC-01                           PIC  X(02)  VALUE '01'.  01080000
010900     05  PC-90                    PIC  X(02)  VALUE '90'.         01090000
011000     05  PC-OPER-UNT-ID               PIC S9(04) VALUE +0         01100000
011100                                                 COMP.            01110000
011200     05  PC-FCLTY-ID                  PIC S9(04) VALUE +0         01120000
011300                                                 COMP.            01130000
011400                                                                  01140000
011500*----------------------------------------------------------------*01150000
011600*              SYSTEM MESSAGES                                   *01160000
011700*----------------------------------------------------------------*01170000
011800* 00005-INVALID VALUE                                             01180000
011900* 00007-REQUIRED ENTRY                                            01190000
012000* 00008-MUST BE NUMERIC                                           01200000
012100* 00009-INVALID DATE                                              01210000
012200* 00746-INVALID PRINTER DESTINATION                               01220000
012300*----------------------------------------------------------------*01230000
012400     05  PC-TSYMSG-NUMBERS.                                       01240000
012500         10  PC-TSYMSG-02400       PIC  9(05)  VALUE  02400.      01250000
012600         10  PC-TSYMSG-00005       PIC  9(05)  VALUE  00005.      01260000
012700         10  PC-TSYMSG-00007       PIC  9(05)  VALUE  00007.      01270000
012800         10  PC-TSYMSG-00008       PIC  9(05)  VALUE  00008.      01280000
012900         10  PC-TSYMSG-00009       PIC  9(05)  VALUE  00009.      01290000
013000         10  PC-TSYMSG-00034       PIC  9(05)  VALUE  00034.      01300000
013100         10  PC-TSYMSG-00050       PIC  9(05)  VALUE  00050.      01310000
013200         10  PC-TSYMSG-00059       PIC  9(05)  VALUE  00059.      01320000
013300         10  PC-TSYMSG-00098       PIC  9(05)  VALUE  00098.      01330000
013400         10  PC-TSYMSG-00117       PIC  9(05)  VALUE  00117.      01340000
013500         10  PC-TSYMSG-00726       PIC  9(05)  VALUE  00726.      01350000
013600         10  PC-TSYMSG-00743       PIC  9(05)  VALUE  00743.      01360000
013800         10  PC-TSYMSG-03744       PIC  9(05)  VALUE  03744.      01380000
013900         10  PC-TSYMSG-01303       PIC  9(05)  VALUE  01303.      01390000
014000         10  PC-TSYMSG-03045       PIC  9(05)  VALUE  03045.      01400000
014200         10  PC-TSYMSG-00746       PIC  9(05)  VALUE  00746.      01420000
014300         10  PC-TSYMSG-00984       PIC  9(05)  VALUE  00984.      01430000
014400         10  PC-TSYMSG-01020       PIC  9(05)  VALUE  01020.      01440000
014500         10  PC-TSYMSG-01021       PIC  9(05)  VALUE  01021.      01450000
014600         10  PC-TSYMSG-01022       PIC  9(05)  VALUE  01022.      01460000
014700         10  PC-TSYMSG-01097       PIC  9(05)  VALUE  01097.      01470000
014800         10  PC-TSYMSG-01570       PIC  9(05)  VALUE  01570.      01480000
014900         10  PC-TSYMSG-02122       PIC  9(05)  VALUE  02122.      01490000
015000         10  PC-TSYMSG-03731       PIC  9(05)  VALUE  03731.      01500000
015100                                                                  01510000
015200 01  PS-PROGRAM-SWITCHES.                                         01520000
015300     05  PS-ERROR-SW               PIC  X(01)  VALUE  'N'.        01530000
015400         88  PS-ERROR                          VALUE  'Y'.        01540000
015500         88  PS-NO-ERROR                       VALUE  'N'.        01550000
015600     05  PS-DATA-SW                PIC  X(01)  VALUE  'N'.        01560000
015700         88  PS-DATA-LEFT                      VALUE  'Y'.        01570000
015800         88  PS-NO-DATA-LEFT                   VALUE  'N'.        01580000
015900     05  PS-TRIP-EXIST-SW          PIC  X(01)  VALUE  'N'.        01590000
016000         88 PS-TRIP-EXIST                      VALUE 'Y'.         01600000
016100         88 PS-TRIP-DOES-NOT-EXIST             VALUE 'N'.         01610000
016200     05  PS-ARIV-DTE-SW            PIC  X(01)  VALUE  'N'.        01620000
016300         88  PS-NO-ARIV-DTE                    VALUE  'N'.        01630000
016400         88  PS-ARIV-DTE                       VALUE  'Y'.        01640000
016500     05  PS-SCAC-EXISTS-SW         PIC  X(01)  VALUE  'N'.        01650000
016600         88  PS-SCAC-EXISTS                    VALUE  'Y'.        01660000
016700         88  PS-SCAC-DOESNT-EXIST              VALUE  'N'.        01670000
016800     05  PS-CALL-ITM-SW            PIC  X(01)  VALUE  'N'.        01680000
016900         88  PS-CALL-ITM-NO                    VALUE  'N'.        01690000
017000         88  PS-CALL-ITM-YES                   VALUE  'Y'.        01700000
017200     05  PS-TRIP-OPER-ERROR-SW     PIC  X(01)  VALUE  'N'.        01720000
017300         88  PS-TRIP-OPER-ERROR-YES            VALUE  'Y'.        01730000
017400         88  PS-TRIP-OPER-ERROR-NO             VALUE  'N'.        01740000
017600                                                                  01760000
017700 01  PM-PROGRAM-MESSAGES.                                         01770000
017800     05  PM-PROGRAM-MESSAGE-1.                                    01780000
017900         10  PM-RET-CDE                  PIC  X(02)  VALUE SPACE. 01790000
018000         10  FILLER                      PIC  X(01)  VALUE '-'.   01800000
018100         10  PM-RET-MSG                  PIC  X(25)  VALUE SPACE. 01810000
018200         10  FILLER                      PIC  X(48)  VALUE SPACE. 01820000
018300                                                                  01830000
018400 01  PV-RCKCS226-COMMAREA.                                        01840000
018500     05  PV-CA-SCAC-CDE            PIC X(04).                     01850000
018600     05  PV-CA-VEH-NBR             PIC X(10).                     01860000
018700     05  PV-CA-ARRIVAL-DTE         PIC X(10).                     01870000
018800     05  PV-CA-PRINTER             PIC X(08).                     01880000
018900     05  PV-CA-TRIP-ID             PIC S9(09) COMP.               01890000
019000     05  PV-CA-USERID              PIC X(08).                     01900000
019100     05  PV-CA-PRTR-AUTO-CUTTER-IND PIC X(01).                    01910000
019200     05  PV-CA-PRTR-BARCODE-IND    PIC  X(01).                    01920000
019300     05  PV-CA-PRTR-PRTR-CNTL-IND  PIC  X(01).                    01930000
019400     05  PV-CA-PRTR-TRACK-NBR      PIC S9(04) COMP.               01940000
019500     05  PV-CA-PRNT-PACKAGE-IND    PIC  X(01).                    01950000
019600         88  PV-NOT-PRINT-PACKAGE  VALUE 'N'.                     01960000
019610                                                                  01961006
019620     05  PV-DISP-CURR-TRIP-HDR    PIC X(13) VALUE 'CURRENT TRIP '.01962014
019650     05  PV-DISP-CURR-OPER-LNE.                                   01965006
019660         10  FILLER                PIC X(06) VALUE 'OPER: '.      01966012
019670         10  PV-DISP-CURR-OPER-NBR PIC Z(04).                     01967007
019680         10  FILLER                PIC X(01).                     01968006
019690         10  PV-DISP-CURR-OPER-NME PIC X(10).                     01969006
019691     05  PV-DISP-CURR-SCAC-LNE.                                   01969106
019692         10  FILLER                PIC X(06) VALUE 'SCAC: '.      01969212
019693         10  PV-DISP-CURR-SCAC-NBR PIC X(04).                     01969307
019694     05  PV-DISP-CURR-TRLR-LNE.                                   01969406
019695         10  FILLER                PIC X(06) VALUE 'TRLR: '.      01969512
019696         10  PV-DISP-CURR-TRLR-NBR PIC X(10).                     01969606
019697     05  PV-DISP-CURR-TRIP-LNE.                                   01969706
019698         10  FILLER                PIC X(06) VALUE 'TRIP: '.      01969812
019699         10  PV-DISP-CURR-TRIP-NBR PIC Z(09).                     01969907
019700     05  PV-DISP-CURR-STAT-LNE.                                   01970014
019701         10  FILLER                PIC X(06) VALUE 'STAT: '.      01970114
019702         10  PV-DISP-CURR-STAT-CDE PIC X(02).                     01970214
019710                                                                  01971000
019800 01  PV-PROGRAM-VARIABLES.                                        01980000
019900     05  PV-SUB-CL-NBR-2CH         PIC  X(02).                    01990000
020000     05  PV-TRECEIV-ACTL-CART-CNT  PIC S9(04)  COMP.              02000000
020100     05  PV-COMMAREA-LENGTH        PIC S9(04)  VALUE +0           02010000
020200                                               COMP.              02020000
020300     05  PV-SHIPMENT-COUNT         PIC S9(04)  VALUE +0           02030000
020400                                               COMP.              02040000
020600     05  PV-PO-NBR                 PIC  9(08).                    02060003
020800     05  PV-PRINTER-NO.                                           02080000
020900         10  PV-PRINTER-NO-9       PIC  9(03)  VALUE ZERO.        02090000
021000     05  PV-LABEL-COUNT            PIC  9(04).                    02100000
021100     05  PV-CURRENT-TIME           PIC  9(06).                    02110000
021200     05  PV-CURRENT-DATE           PIC  9(06).                    02120000
021300     05  FILLER REDEFINES PV-CURRENT-DATE.                        02130000
021400         10  PV-CURRENT-DATE-YY    PIC  9(02).                    02140000
021500         10  PV-CURRENT-DATE-MM    PIC  9(02).                    02150000
021600         10  PV-CURRENT-DATE-DD    PIC  9(02).                    02160000
021700     05  PV-ABSTIME                PIC S9(15)  COMP.              02170000
021800     05  PV-NULL-IND-1             PIC S9(04)  VALUE +0           02180000
021900                                               COMP.              02190000
022000     05  PV-CURR-TRIP-ID           PIC S9(09)  VALUE +0           02200000
022100                                               COMP-3.            02210000
022200     05  PV-CICS-RESP                    PIC S9(04)  VALUE +0     02220000
022300                                                     COMP SYNC.   02230000
022400     05  PV-VHTRIP-COUNT           PIC S9(09)  VALUE +0           02240000
022500                                               COMP-3.            02250000
022600     05  PV-RETRY-COUNTER          PIC S9(04)  VALUE +0           02260000
022700                                               COMP SYNC.         02270000
022800     05  PV-DB2-COUNT              PIC S9(09) COMP-3.             02280000
022900     05 PV-DC-5-CHAR-ABBR            PIC X(05) VALUE SPACES.      02290000
023000     05 PV-DC-5-CHAR-ABBR-R REDEFINES PV-DC-5-CHAR-ABBR.          02300000
023100         10 FILLER                   PIC  X(03).                  02310000
023200         10 PV-2-DIGIT-DC-ABBR       PIC  X(02).                  02320000
023300     05  PV-MESSAGE.                                              02330000
023400         10  PV-MESSAGE1                PIC X(10).                02340000
023500         10  PV-FILLER                  PIC X(01).                02350000
023600         10  PV-MESSAGE2                PIC X(10).                02360000
023700         10  PV-FILLER                  PIC X(01).                02370000
023800         10  PV-MESSAGE3                PIC X(10).                02380000
023900     05  PV-DB2-TEMP-DATE          PIC  X(10).                    02390000
024000     05  PV-DB2-REC-DATE           PIC  X(10).                    02400000
024100     05  PV-DB2-DATE               PIC  X(10).                    02410000
024200     05  FILLER  REDEFINES PV-DB2-DATE.                           02420000
024300         10  PV-DB2-DATE-CC        PIC  X(02).                    02430000
024400         10  PV-DB2-DATE-YY        PIC  X(02).                    02440000
024500         10  FILLER                PIC  X(01).                    02450000
024600         10  PV-DB2-DATE-MM        PIC  X(02).                    02460000
024700         10  FILLER                PIC  X(01).                    02470000
024800         10  PV-DB2-DATE-DD        PIC  X(02).                    02480000
024900     05  PV-DISPLAY-DATE.                                         02490000
025000         10  PV-DISPLAY-DATE-MM    PIC  X(02).                    02500000
025100         10  FILLER                PIC  X(01) VALUE '/'.          02510000
025200         10  PV-DISPLAY-DATE-DD    PIC  X(02).                    02520000
025300         10  FILLER                PIC  X(01) VALUE '/'.          02530000
025400         10  PV-DISPLAY-DATE-YY    PIC  X(02).                    02540000
025500     05  PV-STATUS-CODE            PIC  X(02).                    02550000
025600         88  PS-VALID-STATUS       VALUE 'AC'.                    02560000
025700     05  PV-CURR-STATUS-CCYYMMDD.                                 02570000
025800         10  PV-CURR-STATUS-CC     PIC X(02).                     02580000
025900         10  PV-CURR-STATUS-DTE    PIC X(08).                     02590000
026000         10  FILLER REDEFINES PV-CURR-STATUS-DTE.                 02600000
026100             15  PV-CURR-STATUS-YY PIC X(02).                     02610000
026200             15  FILLER            PIC X(06).                     02620000
026300     05  PV-CURR-STATUS-TME        PIC X(08).                     02630000
026400     05  PV-MOD-10-CK-DGT          PIC  9(01)  VALUE ZERO.        02640000
026500     05  PV-RCVR-SEQ-4-DGT         PIC  9(04)  VALUE ZERO.        02650000
026600     05  PV-RCVR-SEQ-4-X REDEFINES PV-RCVR-SEQ-4-DGT.             02660000
026700         10  FILLER                PIC  X(01).                    02670000
026800         10  PV-RCVR-SEQ-3-X       PIC  X(03).                    02680000
026900     05  PV-SELECT-DATE            PIC  X(10) VALUE SPACES.       02690000
027000     05  PV-DISP-TRIP-ID           PIC -Z(08)9.                   02700000
027100     05  PV-DISP-OPER-ID           PIC -Z(08)9.                   02710000
027200     05  PV-CICS-MSG-AREA          PIC X(75)  VALUE SPACE.        02720000
027300     05  PV-SQL-RETURN-CD          PIC ----9.                     02730000
027500     05  PV-TRIP-ID                PIC S9(09) COMP.               02750000
027600     05  PV-DEST-LOC-NBR           PIC S9(04) COMP.               02760000
027800                                                                  02780000
027900***************************************************************** 02790000
028000* COPY BOOK FOR LOGISTICS DOMAIN ITEM ACCESS MODULE               02800000
028100***************************************************************** 02810000
028200     COPY XLWS001.                                                02820000
028300                                                                  02830000
028400*----------------------------------------------------------------*02840000
028500*  COPYBOOK FOR LOCATION CALL MODULE                              02850000
028600*-----------------------------------------------------------------02860000
028700     COPY XLWS071.                                                02870000
028800                                                                  02880000
028900*----------------------------------------------------------------*02890000
029000*    MAP LAYOUT                                                  *02900000
029100*----------------------------------------------------------------*02910000
029200                                                                  02920000
029300     COPY RCKM224.                                                02930000
029400                                                                  02940000
029500/                                                                 02950000
029600     COPY DPWS017.                                                02960000
029700                                                                  02970000
029800*----------------------------------------------------------------*02980000
029900*    ATTRIBUTE SETTINGS COPYBOOK.                                *02990000
030000*----------------------------------------------------------------*03000000
030100                                                                  03010000
030200     COPY DPWS015.                                                03020000
030300                                                                  03030000
030400/                                                                 03040000
030500*----------------------------------------------------------------*03050000
030600*  WORK AREA PASSED IN CALL TO DPKUT902                          *03060000
030700*----------------------------------------------------------------*03070000
030800     COPY DPWS902.                                                03080000
030900                                                                  03090000
031000***************************************************************** 03100000
031100*    COPY BOOKS FOR THE VALIDATION ROUTINE FOR THE FREIGHT BILL   03110000
031200*    BILL OF LADING, AND VEHICLE NUMBER                           03120000
031300***************************************************************** 03130000
031400     COPY RCWS023.                                                03140000
031500                                                                  03150000
031600*----------------------------------------------------------------*03160000
031700*    FUNCTION KEYS COPYBOOK                                      *03170000
031800*----------------------------------------------------------------*03180000
031900                                                                  03190000
032000     COPY DPWS016.                                                03200000
032100/                                                                 03210000
032200*----------------------------------------------------------------*03220000
032300*  WORK AREA PASSED IN CALL TO DPKUT500                          *03230000
032400*----------------------------------------------------------------*03240000
032500                                                                  03250000
032600     COPY DPWS500.                                                03260000
032700/                                                                 03270000
032800*----------------------------------------------------------------*03280000
032900*  WORK AREA PASSED IN CALL TO DPKCS060                          *03290000
033000*----------------------------------------------------------------*03300000
033100                                                                  03310000
033200     COPY DPWS072.                                                03320000
033300/                                                                 03330000
033400*----------------------------------------------------------------*03340000
033500*  WORK AREA CONTAINING PRINTER LINE COMMANDS                    *03350000
033600*----------------------------------------------------------------*03360000
033700                                                                  03370000
033800     COPY DSWS004.                                                03380000
033900/                                                                 03390000
034000******************************************************************03400000
034100** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **03410000
034200** SUB-ROUTINE (DPKUT100).                                      **03420000
034300******************************************************************03430000
034400     COPY DPWS010I.                                               03440000
034500/                                                                 03450000
034600******************************************************************03460000
034700** THE CALLING PARAMETER LIST (DPWS030/DPWS930) FOR THE CICS    **03470023
034800** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **03480000
034900******************************************************************03490000
035000     COPY DPWS030.                                                03500000
035010     COPY DPWS930.                                                03501023
035100                                                                  03510000
035200/                                                                 03520000
035300***************************************************************** 03530000
035400*    DC PROCESSING CARTON LABEL RECORD LAYOUT (SOCKETS)           03540000
035500***************************************************************** 03550000
035600     COPY PCWS140.                                                03560000
035700/                                                                 03570000
035800***************************************************************** 03580000
035900*    STANDARD COMMAREA.                                           03590000
036000***************************************************************** 03600000
036100                                                                  03610000
036200     COPY DPWS020.                                                03620000
036300     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                03630000
036400                                                                  03640000
036500***************************************************************** 03650000
036600*    INTER-APPLICATION COMMAREA.                                  03660000
036700***************************************************************** 03670000
036800                                                                  03680000
036900         10  INTER-APPL-COMM-AREA PIC X(200).                     03690000
037000     COPY RCWS012.                                                03700000
037100***************************************************************** 03710000
037200*    SPECIFIC COMMMAREA FOR RCKCS224.                             03720000
037300***************************************************************** 03730000
037400         10  ASC-SPECIFIC-COMMAREA.                               03740000
037500             15  ASC-OPER-UNT-ID             PIC X(04).           03750000
037600             15  ASC-OPER-UNT-ID-N REDEFINES ASC-OPER-UNT-ID      03760000
037700                                             PIC 9(04).           03770000
037800             15  ASC-FCLTY-NME               PIC X(25).           03780000
037900             15  ASC-FCLTY-ID                PIC X(04).           03790000
038000             15  ASC-FCLTY-ID-N REDEFINES ASC-FCLTY-ID            03800000
038100                                             PIC 9(04).           03810002
038200             15  ASC-CURR-OPER-UNT-ID        PIC 9(04).           03820000
038300             15  ASC-CURR-FCLTY-ID           PIC 9(04).           03830000
038400             15  ASC-OWNER-SCAC-ID           PIC  X(04).          03840000
038500             15  ASC-ORIGIN-SCAC-ID          PIC  X(04).          03850000
038600             15  ASC-STATUS-CODE             PIC  X(02).          03860000
038700             15  ASC-SCR-TRIP-X              PIC  X(09).          03870000
038800             15  ASC-SCR-TRIP REDEFINES ASC-SCR-TRIP-X            03880000
038900                                             PIC  9(09).          03890000
039000             15  ASC-SCR-TRIP-N              PIC S9(09) COMP.     03900000
039100*                                                                 03910012
039200             15  ASC-SCR-SHIP-X              PIC  X(15).          03920000
039300             15  ASC-SCR-SHIP REDEFINES ASC-SCR-SHIP-X            03930000
039400                                             PIC  X(10).          03940000
039500             15  ASC-SCR-SHIP-N              PIC  X(15).          03950000
039600*                                                                 03960012
039700             15  ASC-FREIGHT-BILL            PIC  X(22).          03970000
039800             15  ASC-BILL-OF-LADING          PIC  X(30).          03980000
040000             15  ASC-PO-NBR-X.                                    04000000
040100                 20  ASC-PO-NBR              PIC  Z(08).          04010003
040200             15  ASC-MANIFEST                PIC  X(15).          04020000
040300             15  ASC-VEH-NBR                 PIC  X(10).          04030000
040400             15  ASC-ARRIVAL-DTE             PIC  X(08).          04040000
040500             15  ASC-ARRIVAL-DTE-ISO         PIC  X(10).          04050000
040600             15  FILLER REDEFINES ASC-ARRIVAL-DTE-ISO.            04060000
040700                 20  ASC-ARRIVAL-DTE-ISO-CC  PIC  9(02).          04070000
040800                 20  ASC-ARRIVAL-DTE-ISO-YY  PIC  9(02).          04080000
040900                 20  ASC-DASH-1              PIC  X(01).          04090000
041000                 20  ASC-ARRIVAL-DTE-ISO-MM  PIC  9(02).          04100000
041100                 20  ASC-DASH-2              PIC  X(01).          04110000
041200                 20  ASC-ARRIVAL-DTE-ISO-DD  PIC  9(02).          04120000
041300             15  ASC-PRINTER-ID              PIC  X(08).          04130000
041400             15  ASC-PRINTER-ID-N            PIC 9(08).           04140000
041500             15  ASC-TRIP-PRTY-CDE           PIC X(02).           04150000
041600             15  ASC-TRIP-PRTY-CDE-N REDEFINES                    04160000
041700                 ASC-TRIP-PRTY-CDE           PIC 9(02).           04170000
041800             15  ASC-VEH-EXIST-SW            PIC  X(01).          04180000
041900                 88 ASC-VEH-EXIST            VALUE 'Y'.           04190000
042000                 88 ASC-VEH-NULL-TRIP        VALUE 'N'.           04200000
042100                 88 ASC-VEH-DOES-NOT-EXIST   VALUE 'D'.           04210000
042200             15  ASC-ARIV-DTE-SW             PIC  X(01).          04220000
042300                 88  ASC-NO-ARIV-DTE         VALUE  'N'.          04230000
042400                 88  ASC-ARIV-DTE            VALUE  'Y'.          04240000
042500             15  ASC-TRIP-ID                 PIC S9(09) COMP.     04250000
042600             15  ASC-PRTR-AUTO-CUTTER-IND    PIC  X(01).          04260000
042700             15  ASC-PRTR-BARCODE-IND        PIC  X(01).          04270000
042800             15  ASC-PRTR-PRTR-CNTL-IND      PIC  X(01).          04280000
042900             15  ASC-PRTR-TRACK-NBR          PIC S9(04) COMP.     04290000
043100             15  ASC-CAN                     PIC  X(30).          04310000
043210                                                                  04321006
043230             15  ASC-DISP-CURR-OPER-NBR      PIC S9(04) COMP.     04323006
043250             15  ASC-DISP-CURR-OPER-NME      PIC  X(10).          04325006
043280             15  ASC-DISP-CURR-SCAC-NBR      PIC  X(04).          04328006
043292             15  ASC-DISP-CURR-TRLR-NBR      PIC  X(10).          04329206
043295             15  ASC-DISP-CURR-TRIP-NBR      PIC S9(09) COMP.     04329506
043296             15  ASC-DISP-CURR-STAT-CDE      PIC  X(02).          04329614
043297             15  ASC-DISP-CURR-TRIP-SW       PIC  X(01).          04329714
043298                 88  ASC-DISP-CURR-TRIP-Y         VALUE 'Y'.      04329814
043299                 88  ASC-DISP-CURR-TRIP-N         VALUE 'N'.      04329914
043300             15  FILLER                      PIC  X(55).          04330014
043310                                                                  04331014
043400/                                                                 04340000
043500*----------------------------------------------------------------*04350000
043600*    ABEND PROCESSING COPYBOOK.                                  *04360000
043700*----------------------------------------------------------------*04370000
043800                                                                  04380000
043900     COPY DPWS013.                                                04390000
044000                                                                  04400000
044100/                                                                 04410000
044200*---------------------------------------------------------------* 04420000
044300*    DB2 AREA FOR SHIPMENT PO TABLE                             * 04430000
044400*---------------------------------------------------------------* 04440000
044500     EXEC SQL                                                     04450000
044600          INCLUDE TSHPTPO                                         04460000
044700     END-EXEC.                                                    04470000
044800                                                                  04480000
044900/                                                                 04490000
045000*----------------------------------------------------------------*04500000
045100*    DB2 AREA FOR OPERATION SET TABLE                            *04510000
045200*----------------------------------------------------------------*04520000
045300                                                                  04530000
045400     EXEC SQL                                                     04540000
045500          INCLUDE TOPRSET                                         04550000
045600     END-EXEC.                                                    04560000
045700                                                                  04570000
045800/                                                                 04580000
045900*----------------------------------------------------------------*04590000
046000*    DB2 AREA FOR THE EXTERNAL ENTERPRISE TABLE                  *04600000
046100*----------------------------------------------------------------*04610000
046200                                                                  04620000
046300     EXEC SQL                                                     04630000
046400          INCLUDE TEXTENT                                         04640000
046500     END-EXEC.                                                    04650000
046600                                                                  04660000
046700/                                                                 04670000
046800*---------------------------------------------------------------* 04680000
046900*    DB2 AREA FOR PURCHASE ORDER TABLE                          * 04690000
047000*---------------------------------------------------------------* 04700000
047100     EXEC SQL                                                     04710000
047200          INCLUDE TPURCHS                                         04720000
047300     END-EXEC.                                                    04730000
047400                                                                  04740000
047500/                                                                 04750000
047600*---------------------------------------------------------------* 04760000
047700*    DB2 AREA FOR THE ENTERPRISE NAME TABLE                     * 04770000
047800*---------------------------------------------------------------* 04780000
047900     EXEC SQL                                                     04790000
048000          INCLUDE TENTNME                                         04800000
048100     END-EXEC.                                                    04810000
048200                                                                  04820000
048300/                                                                 04830000
048400*---------------------------------------------------------------* 04840000
048500*    DB2 AREA FOR THE                                             04850000
048600*---------------------------------------------------------------* 04860000
048700     EXEC SQL                                                     04870000
048800          INCLUDE TPOINST                                         04880000
048900     END-EXEC.                                                    04890000
049000                                                                  04900000
049100                                                                  04910000
049200/                                                                 04920000
049300*---------------------------------------------------------------* 04930000
049400*    DB2 AREA FOR THE WORK ORDER TABLE                          * 04940000
049500*---------------------------------------------------------------* 04950000
049600     EXEC SQL                                                     04960000
049700          INCLUDE TWRKORD                                         04970000
049800     END-EXEC.                                                    04980000
049900                                                                  04990000
050000/                                                                 05000000
050100*---------------------------------------------------------------* 05010000
050200*    DB2 AREA FOR THE PURCHASE ORDER LINE ITEM TABLE            * 05020000
050300*---------------------------------------------------------------* 05030000
050400     EXEC SQL                                                     05040000
050500          INCLUDE TPURITM                                         05050000
050600     END-EXEC.                                                    05060000
050700                                                                  05070000
050800/                                                                 05080000
050900*---------------------------------------------------------------* 05090000
051000*    DB2 AREA FOR RECEIVER TABLE                                * 05100000
051100*---------------------------------------------------------------* 05110000
051200     EXEC SQL                                                     05120000
051300          INCLUDE TRECEIV                                         05130000
051400     END-EXEC.                                                    05140000
051500                                                                  05150000
051600/                                                                 05160000
051700*---------------------------------------------------------------* 05170000
051800*    DB2 AREA FOR THE PO INSTRUCTION CODE TABLE                 * 05180000
051900*---------------------------------------------------------------* 05190000
052000     EXEC SQL                                                     05200000
052100          INCLUDE TINSTCD                                         05210000
052200     END-EXEC.                                                    05220000
052300                                                                  05230000
052400/                                                                 05240000
052500*---------------------------------------------------------------* 05250000
052600*    DB2 AREA FOR TICKET FORMAT ASSIGNMENTS                     * 05260000
052700*---------------------------------------------------------------* 05270000
052800     EXEC SQL                                                     05280000
052900          INCLUDE TDCTFAS                                         05290000
053000     END-EXEC.                                                    05300000
053100                                                                  05310000
053200/                                                                 05320000
053300*---------------------------------------------------------------* 05330000
053400*    DB2 AREA FOR SHIPMENT TABLE                                * 05340000
053500*---------------------------------------------------------------* 05350000
053600     EXEC SQL                                                     05360000
053700          INCLUDE TSHIPMT                                         05370000
053800     END-EXEC.                                                    05380000
053900                                                                  05390000
054000/                                                                 05400000
054100*---------------------------------------------------------------* 05410000
054200*    DB2 AREA FOR TRIP AUDIT TABLE                                05420000
054300*---------------------------------------------------------------* 05430000
054400     EXEC SQL                                                     05440000
054500          INCLUDE TAUTRIP                                         05450000
054600     END-EXEC.                                                    05460000
054700                                                                  05470000
054800/                                                                 05480000
054900*---------------------------------------------------------------* 05490000
055000*    DB2 AREA FOR VEHICLE AUDIT TABLE                             05500000
055100*---------------------------------------------------------------* 05510000
055200     EXEC SQL                                                     05520000
055300          INCLUDE TAUVHCL                                         05530000
055400     END-EXEC.                                                    05540000
055500                                                                  05550000
055600/                                                                 05560000
055700*---------------------------------------------------------------* 05570000
055800*    DB2 AREA FOR VEHICLE TABLE                                 * 05580000
055900*---------------------------------------------------------------* 05590000
056000     EXEC SQL                                                     05600000
056100          INCLUDE TVEHICL                                         05610000
056200     END-EXEC.                                                    05620000
056300                                                                  05630000
056400/                                                                 05640000
056500*---------------------------------------------------------------* 05650000
056600*    DB2 AREA FOR VEHICLE TRIP TABLE                            * 05660000
056700*---------------------------------------------------------------* 05670000
056800     EXEC SQL                                                     05680000
056900          INCLUDE TVHTRIP                                         05690000
057000     END-EXEC.                                                    05700000
057100                                                                  05710000
057200/                                                                 05720000
057300*---------------------------------------------------------------* 05730000
057400*    DB2 AREA FOR SUT_TRLR_RPLN_CART                            * 05740000
057500*---------------------------------------------------------------* 05750000
057600     EXEC SQL                                                     05760000
057700          INCLUDE SUT00113                                        05770000
057800     END-EXEC.                                                    05780000
057900                                                                  05790000
058000/                                                                 05800000
058100*---------------------------------------------------------------* 05810000
058200*    DB2 AREA FOR TKRPRPM                                       * 05820000
058300*---------------------------------------------------------------* 05830000
058400     EXEC SQL                                                     05840000
058500          INCLUDE TKRPRPM                                         05850000
058600     END-EXEC.                                                    05860000
058700                                                                  05870000
058800/                                                                 05880000
058900*---------------------------------------------------------------* 05890000
059000*    DB2 AREA FOR VEHICLE TRIP STATUS TABLE                     * 05900000
059100*---------------------------------------------------------------* 05910000
059200     EXEC SQL                                                     05920000
059300          INCLUDE TTRIPST                                         05930000
059400     END-EXEC.                                                    05940000
059500                                                                  05950000
059600/                                                                 05960000
059700*---------------------------------------------------------------* 05970000
059800*    DB2 AREA FOR VEHICLE TRIP STATUS CODE TABLE                * 05980000
059900*---------------------------------------------------------------* 05990000
060000     EXEC SQL                                                     06000000
060100          INCLUDE TTRSTYP                                         06010000
060200     END-EXEC.                                                    06020000
060300                                                                  06030000
060400/                                                                 06040000
060500*----------------------------------------------------------------*06050012
060600*     WST_SHPMT_XREF_HDR VIEW - WMS SHIPMENT XREF HEADER          06060012
060610*----------------------------------------------------------------*06061012
060700     EXEC SQL                                                     06070000
060800         INCLUDE WST00001                                         06080000
060900     END-EXEC.                                                    06090000
061000                                                                  06100012
061100*----------------------------------------------------------------*06110000
061200*    DB2 AREA FOR XLT_LOC TABLE                                   06120000
061300*----------------------------------------------------------------*06130000
061400                                                                  06140000
061500     EXEC SQL                                                     06150000
061600          INCLUDE XLT00010                                        06160000
061700     END-EXEC.                                                    06170000
061800*                                                                 06180000
061900*  COMMUNICATION AREAS FOR DB2                                    06190000
062000*                                                                 06200000
062100     EXEC SQL                                                     06210000
062200         INCLUDE SQLCA                                            06220000
062300     END-EXEC.                                                    06230000
062400                                                                  06240000
062500*---------------------------------------------------------------* 06250000
062600*     RECEIVER CURSOR DECLARE                                   * 06260000
062700*---------------------------------------------------------------* 06270000
062800* WR40574 ADDED CARR-AUTH-ID (CAN) BELOW 2012-02-03 CLT           06280000
062900                                                                  06290000
063000     EXEC SQL                                                     06300000
063100          DECLARE RECEIVER-CSR CURSOR WITH HOLD FOR               06310000
063200             SELECT DISTINCT                                      06320000
063300                    A.PO_NBR                                      06330000
063400                   ,A.REC_SEQ_NBR                                 06340000
063500                   ,A.EXPTED_CART_CNT                             06350000
063600                   ,F.ACTL_CART_CNT                               06360000
063700                   ,A.DMG_CART_CNT                                06370000
063800                   ,A.PKSL_IND                                    06380000
063900                   ,A.VEND_NAME                                   06390000
064000                   ,B.SHIPT_ID                                    06400000
064100                   ,B.LAST_UPD_DTE                                06410000
064200                   ,B.LAST_UPD_TME                                06420000
064300                   ,C.OWNER_SCAC_ID                               06430000
064400                   ,C.VEH_NBR                                     06440000
064500                   ,C.TRIP_ID                                     06450000
064600                   ,DATE(F.REC_TMST)                              06460000
064700                   ,F.CRE_TMST                                    06470000
064800                   ,B.CARR_AUTH_ID                                06480000
064900               FROM TSHPTPO A                                     06490000
065000                   ,TSHIPMT B                                     06500000
065100                   ,TVHTRIP C                                     06510000
065200                   ,TVEHICL D                                     06520000
065300                   ,TRECEIV F                                     06530000
065400              WHERE C.OWNER_SCAC_ID = :DK-OWNER-SCAC-ID           06540000
065500                AND C.VEH_NBR       = :DK-VEH-NBR                 06550000
065600                AND A.SHIPT_ID        = B.SHIPT_ID                06560000
065700                AND B.TRIP_ID         = C.TRIP_ID                 06570000
065800                AND C.TRIP_ID         = D.CURR_TRIP_ID            06580000
065900                AND A.PO_NBR          = F.ORD_NBR                 06590000
066000                AND A.REC_SEQ_NBR     = F.REC_SEQ_NBR             06600000
066100                AND F.VER_STATUS_CDE  = 'A'                       06610000
066200             ORDER BY F.CRE_TMST                                  06620000
066300     END-EXEC.                                                    06630000
066400                                                                  06640000
066500 LINKAGE SECTION.                                                 06650000
066600                                                                  06660000
066700 01  DFHCOMMAREA.                                                 06670000
066800     05  FILLER                         OCCURS  1 TO 4072 TIMES   06680000
066900                                        DEPENDING ON EIBCALEN.    06690000
067000         10  FILLER                     PIC X.                    06700000
067100                                                                  06710000
067200 PROCEDURE DIVISION.                                              06720000
067300***************************************************************** 06730000
067400** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 06740000
067500** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 06750000
067600** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 06760000
067700**                                                             ** 06770000
067800** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 06780000
067900** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 06790000
068000***************************************************************** 06800000
068100 0000-MAIN-MODULE.                                                06810000
068200                                                                  06820000
068300     INITIALIZE DP030-CICS-API-FIELDS.                            06830000
068400     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       06840000
068500     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          06850000
068600     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         06860000
068700     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       06870000
068800     MOVE LENGTH OF RC224AI        TO DP030-MAP-LENGTH (1).       06880000
068900     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     06890000
069000     PERFORM 0001-CALL-CICS-ARCH-API.                             06900000
069100                                                                  06910000
069200     PERFORM 1000-CONTROL-PROCESSING                              06920000
069300                                                                  06930000
069400     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     06940000
069500     PERFORM 0001-CALL-CICS-ARCH-API.                             06950000
069600                                                                  06960000
069700                                                                  06970000
069800 0001-CALL-CICS-ARCH-API.                                         06980000
069900                                                                  06990000
070010     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      07001023
070100                                    DFHCOMMAREA                   07010023
070200                                    DP030-CICS-API-FIELDS         07020023
070300                                    DP020-STANDARD-COMMAREA       07030023
070400                                    RC224AI.                      07040023
070500                                                                  07050000
070600     IF  DP030-RC-CALL-SUCCESSFUL                                 07060000
070700         CONTINUE                                                 07070000
070800     ELSE                                                         07080000
070900         SET DP013-NO-ROLLBACK                                    07090000
071000             DP013-XCTL-DISPLAY-RESTART                           07100000
071100             DP013-CICS-ABEND      TO TRUE                        07110000
071200         MOVE 'BEFORE 0000-MAIN-MODULE'                           07120000
071300                                   TO DP013-PARAGRAPH             07130000
071510         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O07151023
071520-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      07152023
071600         MOVE DP030-RETURN-CODE                                   07160000
071700                                   TO DP013-MESSAGE-TEXT (3)      07170000
071800         PERFORM DP013-0000-PROCESS-ABEND                         07180000
071900     END-IF.                                                      07190000
072000/                                                                 07200000
072100*----------------------------------------------------------------*07210000
072200*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *07220000
072300*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *07230000
072400*----------------------------------------------------------------*07240000
072500 1000-CONTROL-PROCESSING.                                         07250000
072600                                                                  07260000
072700     EVALUATE TRUE                                                07270000
072800         WHEN DP020-NEXT-ACT-INITIAL                              07280000
072900             INITIALIZE ASC-SPECIFIC-COMMAREA                     07290000
072901                                                                  07290107
072902             MOVE ZEROES  TO  ASC-DISP-CURR-TRIP-NBR              07290207
072903                              ASC-DISP-CURR-OPER-NBR              07290307
072911             MOVE SPACES  TO  ASC-DISP-CURR-OPER-NME              07291107
072920                              ASC-DISP-CURR-SCAC-NBR              07292007
072930                              ASC-DISP-CURR-TRLR-NBR              07293007
072980             SET  ASC-DISP-CURR-TRIP-N TO TRUE                    07298007
072990                                                                  07299007
073000             SET ASC-NO-ARIV-DTE       TO TRUE                    07300000
073100             MOVE DP020-LOCATION-NBR TO ASC-OPER-UNT-ID-N         07310000
073200                                        ASC-CURR-OPER-UNT-ID      07320000
073300             MOVE 1                  TO ASC-FCLTY-ID-N            07330000
073400                                        ASC-CURR-FCLTY-ID         07340000
073500             PERFORM 4000-BUILD-INITIAL-PANEL                     07350000
073600                                                                  07360000
073700         WHEN DP020-NEXT-ACT-READ-MAP                             07370000
073710                                                                  07371019
073720             MOVE ZEROES  TO  ASC-DISP-CURR-TRIP-NBR              07372019
073730                              ASC-DISP-CURR-OPER-NBR              07373019
073740             MOVE SPACES  TO  ASC-DISP-CURR-OPER-NME              07374019
073750                              ASC-DISP-CURR-SCAC-NBR              07375019
073760                              ASC-DISP-CURR-TRLR-NBR              07376019
073770             SET  ASC-DISP-CURR-TRIP-N TO TRUE                    07377019
073780                                                                  07378019
073800             PERFORM 2000-FKEY-PROCESSING                         07380000
073900                                                                  07390000
074000         WHEN DP020-NEXT-ACT-RETURN                               07400000
074010                                                                  07401019
074020             MOVE ZEROES  TO  ASC-DISP-CURR-TRIP-NBR              07402019
074030                              ASC-DISP-CURR-OPER-NBR              07403019
074040             MOVE SPACES  TO  ASC-DISP-CURR-OPER-NME              07404019
074050                              ASC-DISP-CURR-SCAC-NBR              07405019
074060                              ASC-DISP-CURR-TRLR-NBR              07406019
074070             SET  ASC-DISP-CURR-TRIP-N TO TRUE                    07407019
074080                                                                  07408019
074100             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   07410000
074200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07420000
074300                                                                  07430000
074400         WHEN OTHER                                               07440000
074500             SET DP013-LOGIC-ABEND                                07450000
074600                 DP013-NO-ROLLBACK TO TRUE                        07460000
074700             MOVE '1000-CONTROL-PROCESSING'                       07470000
074800                                   TO  DP013-PARAGRAPH            07480000
074900             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   07490000
075000                                   TO  DP013-MESSAGE-TEXT(1)      07500000
075100             MOVE DP020-NEXT-APPL-ACTIVITY                        07510000
075200                                   TO DP013-MESSAGE-TEXT(2)       07520000
075300             PERFORM DP013-0000-PROCESS-ABEND                     07530000
075400     END-EVALUATE.                                                07540000
075500/                                                                 07550000
075600*----------------------------------------------------------------*07560000
075700* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*07570000
075800* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*07580000
075900* EDITS.                                                         *07590000
076000*----------------------------------------------------------------*07600000
076100 2000-FKEY-PROCESSING.                                            07610000
076200                                                                  07620000
076300     EVALUATE TRUE                                                07630000
076400                                                                  07640000
076500         WHEN DP020-SRC-AID = DP016-CLEAR                         07650000
076600             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   07660000
076700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07670000
076800                                                                  07680000
076900         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     07690000
077000             INITIALIZE ASC-SPECIFIC-COMMAREA                     07700000
077010                                                                  07701007
077020             MOVE ZEROES  TO  ASC-DISP-CURR-TRIP-NBR              07702007
077030                              ASC-DISP-CURR-OPER-NBR              07703007
077040             MOVE SPACES  TO  ASC-DISP-CURR-OPER-NME              07704007
077050                              ASC-DISP-CURR-SCAC-NBR              07705007
077060                              ASC-DISP-CURR-TRLR-NBR              07706007
077070             SET  ASC-DISP-CURR-TRIP-N TO TRUE                    07707007
077080                                                                  07708007
077100             SET ASC-NO-ARIV-DTE       TO TRUE                    07710000
077200             MOVE DP020-LOCATION-NBR TO ASC-OPER-UNT-ID-N         07720000
077300                                        ASC-CURR-OPER-UNT-ID      07730000
077400             MOVE 1                  TO ASC-FCLTY-ID-N            07740000
077500                                        ASC-CURR-FCLTY-ID         07750000
077600             PERFORM 4000-BUILD-INITIAL-PANEL                     07760000
077700             PERFORM 3200-RESET-ATTRIBUTES                        07770000
077800                                                                  07780000
077900         WHEN OTHER                                               07790000
078000             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 07800000
078100             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   07810000
078200             IF  PS-NO-ERROR                                      07820000
078300                 SET DP030-CONTINUE-GO TO TRUE                    07830000
078400                 PERFORM 2100-CHECK-FUNCTION-KEY                  07840000
078500             ELSE                                                 07850000
078600                 SET DP030-OVERRIDE-GO TO TRUE                    07860000
078610                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             07861018
078700             END-IF                                               07870000
078800     END-EVALUATE.                                                07880000
078900/                                                                 07890000
079000******************************************************************07900000
079100** ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     **07910000
079200** FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED **07920000
079300** FROM THE CICS ARCHITECTURE API.                              **07930000
079400******************************************************************07940000
079500 2100-CHECK-FUNCTION-KEY.                                         07950000
079600                                                                  07960000
079700     EVALUATE TRUE                                                07970000
079800                                                                  07980000
079900         WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 07990000
080000* JAK ADD FUNC-05 (F21) FOR WMSSHIP                               08000000
080100         WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)              08010000
080200             PERFORM 2110-PREPARE-INTER-APPL-COMM                 08020000
080300                                                                  08030000
080400         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              08040000
080500             PERFORM 7400-FORMAT-COMMAREA                         08050000
080600             INITIALIZE PV-DB2-COUNT                              08060000
080700             PERFORM 7000-CHECK-DATA-EXISTS                       08070000
080800             IF  PV-DB2-COUNT > +0                                08080000
080900                 PERFORM 7500-START-TRANID-E226                   08090000
081000                 SET DP030-OVERRIDE-GO TO TRUE                    08100000
081100                 MOVE PC-TSYMSG-00098 TO DP020-MSG-NUMBER         08110000
081200                 SET DP020-MSG-INFORMATIONAL TO TRUE              08120000
081300                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             08130000
081400              ELSE                                                08140000
081500                 SET PS-ERROR                                     08150000
081600                     DP020-MSG-FATAL   TO TRUE                    08160000
081700                 MOVE PC-TSYMSG-00050  TO DP020-MSG-NUMBER        08170000
081800                 MOVE -1               TO ASCACL                  08180000
081900                 SET DP030-SET-CURSOR-APPL-1                      08190000
082000                     DP030-OVERRIDE-GO TO TRUE                    08200000
082100             END-IF                                               08210000
082200                                                                  08220000
082300         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              08230000
082400             IF ASC-VEH-EXIST                                     08240000
082500                 SET PS-ERROR                                     08250000
082600                     DP020-MSG-FATAL   TO TRUE                    08260000
082700                 MOVE PC-TSYMSG-00117  TO DP020-MSG-NUMBER        08270000
082800                 MOVE DP015-UNP-ALP-BRT-OFF                       08280000
082900                                       TO ASCACA                  08290000
083000                                          ATRLRA                  08300000
083100                 MOVE DP015-RED        TO ASCACC                  08310000
083200                                          ATRLRC                  08320000
083300                 MOVE DP015-REVERSE    TO ASCACH                  08330000
083400                                          ATRLRH                  08340000
083500                 MOVE -1               TO ASCACL                  08350000
083600                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              08360000
083700             ELSE                                                 08370000
083800                 PERFORM 5000-ADD-VEHICLE                         08380000
083900             END-IF                                               08390000
084000                                                                  08400000
084100         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              08410000
084200             PERFORM 6000-PRINT-HEADER-LABEL                      08420000
084300                                                                  08430000
084400         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              08440000
084500             CONTINUE                                             08450000
084600                                                                  08460000
084700         WHEN DP020-SRC-AID = DP016-ENTER                         08470000
084800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08480000
084900                                                                  08490000
085000         WHEN OTHER                                               08500000
085100             SET DP013-NO-ROLLBACK                                08510000
085200                 DP013-XCTL-DISPLAY-RESTART                       08520000
085300                 DP013-CICS-ABEND  TO TRUE                        08530000
085400             MOVE '2100-CHECK-FUNCTION-KEY'                       08540000
085500                                   TO DP013-PARAGRAPH             08550000
085600             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      08560000
085700                                   TO DP013-MESSAGE-TEXT (1)      08570000
085800             PERFORM DP013-0000-PROCESS-ABEND                     08580000
085900     END-EVALUATE.                                                08590000
086000                                                                  08600000
086100                                                                  08610000
086200******************************************************************08620000
086300** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **08630000
086400** INTER-APPLICATION COMMAREA.                                  **08640000
086500******************************************************************08650000
086600 2110-PREPARE-INTER-APPL-COMM.                                    08660000
086700                                                                  08670000
086800     INITIALIZE RC012-INTER-APPL-COMMAREA.                        08680000
086900     MOVE ASC-OPER-UNT-ID-N        TO RC012-OPER-UNT-ID.          08690000
087000     MOVE ASC-FCLTY-ID-N           TO RC012-FCLTY-ID.             08700000
087100     MOVE ASC-OWNER-SCAC-ID        TO RC012-OWNER-SCAC-ID.        08710000
087200     MOVE ASC-ORIGIN-SCAC-ID       TO RC012-ORIGIN-SCAC-ID.       08720000
087300     MOVE ASC-STATUS-CODE          TO RC012-STATUS.               08730000
087400     MOVE ASC-FREIGHT-BILL         TO RC012-PRO-NBR.              08740000
087500     MOVE ASC-BILL-OF-LADING       TO RC012-BOL-NBR.              08750000
087600     MOVE ASC-PO-NBR               TO RC012-PO-NBR.               08760000
087700     MOVE ASC-MANIFEST             TO RC012-MANIFEST.             08770000
087800     MOVE ASC-VEH-NBR              TO RC012-VEH-NBR.              08780000
087900     MOVE ASC-ARRIVAL-DTE-ISO      TO RC012-ARRIVAL-DTE.          08790000
088000     MOVE ASC-TRIP-ID              TO RC012-TRIP-ID.              08800000
088100                                                                  08810000
088200/                                                                 08820000
088300*----------------------------------------------------------------*08830000
088400* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*08840000
088500* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *08850000
088600* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *08860000
088700*----------------------------------------------------------------*08870000
088800 2200-MOVE-SCREEN-TO-COMMAREA.                                    08880000
088900                                                                  08890000
089000     IF  AOPERL > ZERO                                            08900000
089100         MOVE AOPERI               TO ASC-OPER-UNT-ID             08910000
089200     ELSE                                                         08920000
089300         IF  AOPERF = DP015-ERASE-EOF                             08930000
089400             MOVE SPACES           TO ASC-OPER-UNT-ID             08940000
089500         END-IF                                                   08950000
089600     END-IF.                                                      08960000
089700                                                                  08970000
089800     IF  AFCLTYL > ZERO                                           08980000
089900         MOVE AFCLTYI              TO ASC-FCLTY-ID                08990000
090000     ELSE                                                         09000000
090100         IF  AFCLTYF = DP015-ERASE-EOF                            09010000
090200             MOVE SPACES           TO ASC-FCLTY-ID                09020000
090300         END-IF                                                   09030000
090400     END-IF.                                                      09040000
090500                                                                  09050000
090600     IF  ASCACL > ZERO                                            09060000
090700         MOVE ASCACI               TO ASC-OWNER-SCAC-ID           09070000
090800         MOVE SPACES               TO ASC-ARRIVAL-DTE             09080000
090900                                      ASC-STATUS-CODE             09090000
091000     ELSE                                                         09100000
091100         IF  ASCACF = DP015-ERASE-EOF                             09110000
091200             MOVE SPACE            TO ASC-OWNER-SCAC-ID           09120000
091300                                      ASC-ARRIVAL-DTE             09130000
091400                                      ASC-STATUS-CODE             09140000
091500         END-IF                                                   09150000
091600     END-IF.                                                      09160000
091700                                                                  09170000
091800     IF  AOSCACL > ZERO                                           09180000
091900         MOVE AOSCACI              TO ASC-ORIGIN-SCAC-ID          09190000
092000     ELSE                                                         09200000
092100         IF  AOSCACF = DP015-ERASE-EOF                            09210000
092200             MOVE SPACE            TO ASC-ORIGIN-SCAC-ID          09220000
092300         END-IF                                                   09230000
092400     END-IF.                                                      09240000
092500                                                                  09250000
092600     IF  ATRLRL > ZERO                                            09260000
092700         MOVE ATRLRI               TO ASC-VEH-NBR                 09270000
092800         MOVE SPACES               TO ASC-ARRIVAL-DTE             09280000
092900                                      ASC-STATUS-CODE             09290000
093000     ELSE                                                         09300000
093100         IF  ATRLRF = DP015-ERASE-EOF                             09310000
093200             MOVE SPACE            TO ASC-VEH-NBR                 09320000
093300                                      ASC-ARRIVAL-DTE             09330000
093400                                      ASC-STATUS-CODE             09340000
093500         END-IF                                                   09350000
093600     END-IF.                                                      09360000
093700                                                                  09370000
093800     SET PS-NO-ARIV-DTE TO TRUE.                                  09380000
093900     IF  AARRVDTL > ZERO                                          09390000
094000         MOVE AARRVDTI             TO ASC-ARRIVAL-DTE             09400000
094100         SET PS-ARIV-DTE TO TRUE                                  09410000
094200     ELSE                                                         09420000
094300         IF AARRVDTF = DP015-ERASE-EOF                            09430000
094400             MOVE SPACES           TO ASC-ARRIVAL-DTE             09440000
094500             SET ASC-NO-ARIV-DTE       TO TRUE                    09450000
094600         END-IF                                                   09460000
094700     END-IF.                                                      09470000
094800                                                                  09480000
094900     IF  ATRIPL > ZERO                                            09490000
095000         MOVE ATRIPI               TO ASC-SCR-TRIP-X              09500000
095100     ELSE                                                         09510000
095200         IF  ATRIPF = DP015-ERASE-EOF                             09520000
095300             MOVE SPACE            TO ASC-SCR-TRIP-X              09530000
095400         END-IF                                                   09540000
095500     END-IF.                                                      09550000
095700                                                                  09570000
095800     IF  ASHIPL > ZERO                                            09580000
095900         MOVE ASHIPI               TO ASC-SCR-SHIP-X              09590000
096000     ELSE                                                         09600000
096100         IF  ASHIPF = DP015-ERASE-EOF                             09610000
096200             MOVE SPACE            TO ASC-SCR-SHIP-X              09620000
096300         END-IF                                                   09630000
096400     END-IF.                                                      09640000
096600                                                                  09660000
096700     IF  AFBL > ZERO                                              09670000
096800         MOVE AFBI                 TO ASC-FREIGHT-BILL            09680000
096900     ELSE                                                         09690000
097000         IF  AFBF = DP015-ERASE-EOF                               09700000
097100             MOVE SPACE            TO ASC-FREIGHT-BILL            09710000
097200         END-IF                                                   09720000
097300     END-IF.                                                      09730000
097400                                                                  09740000
097500     IF  ABOLL > ZERO                                             09750000
097600         MOVE ABOLI                TO ASC-BILL-OF-LADING          09760000
097700     ELSE                                                         09770000
097800         IF  ABOLF = DP015-ERASE-EOF                              09780000
097900             MOVE SPACE            TO ASC-BILL-OF-LADING          09790000
098000         END-IF                                                   09800000
098100     END-IF.                                                      09810000
098200                                                                  09820000
098300     IF  APOL > ZERO                                              09830000
098400         MOVE APOI                 TO ASC-PO-NBR-X                09840000
098500     ELSE                                                         09850000
098600         IF  APOF = DP015-ERASE-EOF                               09860000
098700             MOVE SPACE            TO ASC-PO-NBR-X                09870000
098800         END-IF                                                   09880000
098900     END-IF.                                                      09890000
099000                                                                  09900000
099100     IF  AMANIFL > ZERO                                           09910000
099200         MOVE AMANIFI              TO ASC-MANIFEST                09920000
099300     ELSE                                                         09930000
099400         IF  AMANIFF = DP015-ERASE-EOF                            09940000
099500             MOVE SPACE            TO ASC-MANIFEST                09950000
099600         END-IF                                                   09960000
099700     END-IF.                                                      09970000
099800                                                                  09980000
099900     IF APRINTRL > ZERO                                           09990000
100000         MOVE APRINTRI             TO ASC-PRINTER-ID              10000000
100100     ELSE                                                         10010000
100200         IF APRINTRF = DP015-ERASE-EOF                            10020000
100300             INITIALIZE ASC-PRINTER-ID                            10030000
100400         END-IF                                                   10040000
100500     END-IF.                                                      10050000
100600/                                                                 10060000
100700*----------------------------------------------------------------*10070000
100800* ENSURE THE DATA IS CORRECT.  NOTE THAT IN A CRITERIA SPECIFI-  *10080000
100900* CATION SCREEN ONLY MINIMAL EDITS ARE DONE.  EDITS RELATED TO   *10090000
101000* A SPECIFIC SCREEN THAT THE USER IS GOING TO (LOCAL-GO) ARE DONE*10100000
101100* IN THE DESTINATION PROGRAM, NOT HERE.                          *10110000
101200*----------------------------------------------------------------*10120000
101300 3000-EDIT-DATA-IN-COMMAREA.                                      10130000
101400                                                                  10140000
101500     PERFORM 3200-RESET-ATTRIBUTES.                               10150000
101600                                                                  10160000
101700     IF DP020-NEXT-ACT-RETURN                                     10170000
101800        CONTINUE                                                  10180000
101900     ELSE                                                         10190000
102000     IF DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)                    10200000
102100         IF ASC-PRINTER-ID = SPACES                               10210000
102200             SET PS-ERROR            TO TRUE                      10220000
102300             SET DP020-MSG-FATAL     TO TRUE                      10230000
102400             MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER          10240000
102500             MOVE DP015-UNP-ALP-BRT-OFF TO APRINTRA               10250000
102600             MOVE DP015-RED          TO APRINTRC                  10260000
102700             MOVE DP015-REVERSE      TO APRINTRH                  10270000
102800             MOVE -1                 TO APRINTRL                  10280000
102900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  10290000
103000         ELSE                                                     10300000
103100             PERFORM 3070-VALIDATE-MANIFEST-PRINTER               10310000
103200         END-IF                                                   10320000
103300     ELSE                                                         10330000
103400     IF DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)                    10340000
103500         IF ASC-PRINTER-ID = SPACES                               10350000
103600             SET PS-ERROR            TO TRUE                      10360000
103700             SET DP020-MSG-FATAL     TO TRUE                      10370000
103800             MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER          10380000
103900             MOVE DP015-UNP-ALP-BRT-OFF TO APRINTRA               10390000
104000             MOVE DP015-RED          TO APRINTRC                  10400000
104100             MOVE DP015-REVERSE      TO APRINTRH                  10410000
104200             MOVE -1                 TO APRINTRL                  10420000
104300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  10430000
104400         ELSE                                                     10440000
104500             MOVE ASC-PRINTER-ID     TO DP010I-UNEDITED-FIELD     10450000
104600             MOVE LENGTH OF ASC-PRINTER-ID                        10460000
104700                                     TO DP010I-MAXIMUM-DIGITS     10470000
104800             MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS   10480000
104900             SET DP010I-NEGATIVE-NOT-ALLOWED                      10490000
105000                                     TO TRUE                      10500000
105100             CALL DP010I-NUMERIC-EDIT-ROUTINE                     10510023
105110                  USING DP010I-NUMERIC-EDIT-AREA                  10511023
105200             IF  DP010I-ERROR-DETECTED                            10520000
105300                 SET PS-ERROR                                     10530000
105400                     DP020-MSG-FATAL TO TRUE                      10540000
105500                 MOVE PC-TSYMSG-00008                             10550000
105600                                     TO DP020-MSG-NUMBER          10560000
105700                 MOVE DP015-UNP-ALP-BRT-OFF                       10570000
105800                                     TO APRINTRA                  10580000
105900                 MOVE DP015-RED      TO APRINTRC                  10590000
106000                 MOVE DP015-REVERSE  TO APRINTRH                  10600000
106100                 MOVE -1             TO APRINTRL                  10610000
106200                 SET DP030-SET-CURSOR-APPL-1                      10620000
106300                                     TO TRUE                      10630000
106400             ELSE                                                 10640000
106500                 MOVE DP010I-NUMERIC-FIELD                        10650000
106600                                     TO ASC-PRINTER-ID-N          10660000
106700             END-IF                                               10670000
106800         END-IF                                                   10680000
106900     END-IF.                                                      10690000
107000                                                                  10700000
107100     IF  ASC-PO-NBR-X > SPACES                                    10710000
107200         MOVE ASC-PO-NBR-X       TO DP010I-UNEDITED-FIELD         10720000
107300         MOVE LENGTH OF ASC-PO-NBR                                10730000
107400                                 TO DP010I-MAXIMUM-DIGITS         10740000
107500         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       10750000
107600         SET DP010I-NEGATIVE-NOT-ALLOWED                          10760000
107700                                 TO TRUE                          10770000
107800         CALL DP010I-NUMERIC-EDIT-ROUTINE                         10780023
107810              USING DP010I-NUMERIC-EDIT-AREA                      10781023
107900         IF  DP010I-ERROR-DETECTED                                10790000
108000             SET PS-ERROR                                         10800000
108100                 DP020-MSG-FATAL TO TRUE                          10810000
108200             MOVE PC-TSYMSG-00008                                 10820000
108300                                 TO DP020-MSG-NUMBER              10830000
108400             MOVE DP015-UNP-ALP-BRT-OFF                           10840000
108500                                 TO APOA                          10850000
108600             MOVE DP015-RED      TO APOC                          10860000
108700             MOVE DP015-REVERSE  TO APOH                          10870000
108800             MOVE -1             TO APOL                          10880000
108900             SET DP030-SET-CURSOR-APPL-1                          10890000
109000                                 TO TRUE                          10900000
109100         ELSE                                                     10910000
109200             MOVE DP010I-NUMERIC-FIELD                            10920000
109300                                 TO ASC-PO-NBR                    10930000
109400                                    DK-PO-NBR                     10940000
109500             PERFORM 3040-VALIDATE-PO-NBR                         10950000
109600             IF  SQLCODE = +100                                   10960000
109700                 SET PS-ERROR                                     10970000
109800                     DP020-MSG-FATAL TO TRUE                      10980000
109900                 MOVE PC-TSYMSG-00726                             10990000
110000                                     TO DP020-MSG-NUMBER          11000000
110100                 MOVE DP015-UNP-ALP-BRT-OFF                       11010000
110200                                     TO APOA                      11020000
110300                 MOVE DP015-RED      TO APOC                      11030000
110400                 MOVE DP015-REVERSE  TO APOH                      11040000
110500                 MOVE -1             TO APOL                      11050000
110600                 SET DP030-SET-CURSOR-APPL-1                      11060000
110700                                     TO TRUE                      11070000
110800                 MOVE ASC-PO-NBR     TO APOO                      11080000
110900             END-IF                                               11090000
111000         END-IF                                                   11100000
111100     END-IF.                                                      11110000
111200                                                                  11120000
111300     IF  ASC-BILL-OF-LADING > SPACES                              11130000
111400         MOVE ASC-BILL-OF-LADING TO RC023-BILL-OF-LADING          11140000
111500         CALL RC023-FB-BOL-VEH-FORMAT USING RC023-FORMAT-DATA-AREA11150000
111600         MOVE RC023-BILL-OF-LADING   TO ASC-BILL-OF-LADING        11160000
111700     END-IF.                                                      11170000
111800                                                                  11180000
111900     IF  ASC-FREIGHT-BILL > SPACES                                11190000
112000         MOVE ASC-FREIGHT-BILL   TO RC023-FREIGHT-BILL            11200000
112100         CALL RC023-FB-BOL-VEH-FORMAT USING RC023-FORMAT-DATA-AREA11210000
112200         MOVE RC023-FREIGHT-BILL     TO ASC-FREIGHT-BILL          11220000
112300     END-IF.                                                      11230000
112400                                                                  11240000
112500     IF PS-ARIV-DTE                                               11250000
112600         INITIALIZE DPG51                                         11260000
112700         SET  DPG51-ACTUAL-CALENDAR-ONLY                          11270000
112800              DPG51-DO-NOT-INCR-DECR-DATE                         11280000
112900                                 TO TRUE                          11290000
113000         MOVE ZEROES             TO TALLY                         11300000
113100         INSPECT ASC-ARRIVAL-DTE                                  11310000
113200                 TALLYING TALLY FOR ALL '/'                       11320000
113300         IF  TALLY > 1                                            11330000
113400*            'MM/DD/YY'                                           11340000
113500             SET DPG52-LK-DTE-GREG-FMT                            11350000
113600                                 TO TRUE                          11360000
113700         ELSE                                                     11370000
113800*            'MMDDYY  '                                           11380000
113900             SET  DPG52-LK-DTE-GREG                               11390000
114000                                 TO TRUE                          11400000
114100         END-IF                                                   11410000
114200         MOVE ASC-ARRIVAL-DTE          TO DPG52-LK-DATE-INPUT     11420000
114300         CALL PC-DPKUT500 USING DPG51 DPG52 DPG53                 11430000
114400                                DPG54 DPG55 DPG56                 11440000
114500         IF (DPG54-DATE-INVALID                                   11450000
114600         OR  DPG54-SEVERE-ERROR)                                  11460000
114700             SET PS-ERROR                                         11470000
114800                 DP020-MSG-FATAL       TO TRUE                    11480000
114900             MOVE PC-TSYMSG-00009      TO DP020-MSG-NUMBER        11490000
115000             MOVE DP015-UNP-ALP-BRT-OFF                           11500000
115100                                       TO AARRVDTA                11510000
115200             MOVE DP015-RED            TO AARRVDTC                11520000
115300             MOVE DP015-REVERSE        TO AARRVDTH                11530000
115400             MOVE -1                   TO AARRVDTL                11540000
115500             SET DP030-SET-CURSOR-APPL-1                          11550000
115600                                       TO TRUE                    11560000
115700         ELSE                                                     11570000
115800             MOVE DPG55-GREG-DATE-FMT  TO ASC-ARRIVAL-DTE         11580000
115900                                          AARRVDTO                11590000
116000             MOVE DPG55-DB2-ISO-DATE-FMT                          11600000
116100                                       TO ASC-ARRIVAL-DTE-ISO     11610000
116200             SET ASC-ARIV-DTE          TO TRUE                    11620000
116300         END-IF                                                   11630000
116400     ELSE                                                         11640000
116500         SET ASC-NO-ARIV-DTE           TO TRUE                    11650000
116600     END-IF.                                                      11660000
116700                                                                  11670000
116800     IF  ASC-OPER-UNT-ID = (SPACES OR ZEROES)                     11680000
116900         SET PS-ERROR                                             11690000
117000             DP020-MSG-FATAL     TO TRUE                          11700000
117100         MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER              11710000
117200         MOVE DP015-UNP-ALP-BRT-OFF                               11720000
117300                                 TO AOPERA                        11730000
117400         MOVE DP015-RED          TO AOPERC                        11740000
117500         MOVE DP015-REVERSE      TO AOPERH                        11750000
117600         MOVE -1                 TO AOPERL                        11760000
117700         SET DP030-SET-CURSOR-APPL-1                              11770000
117800                                 TO TRUE                          11780000
117900     ELSE                                                         11790000
118000         MOVE ASC-OPER-UNT-ID    TO DP010I-UNEDITED-FIELD         11800000
118100         MOVE LENGTH OF ASC-OPER-UNT-ID                           11810000
118200                                 TO DP010I-MAXIMUM-DIGITS         11820000
118300         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       11830000
118400         SET DP010I-NEGATIVE-NOT-ALLOWED                          11840000
118500                                 TO TRUE                          11850000
118600         CALL DP010I-NUMERIC-EDIT-ROUTINE                         11860023
118610              USING DP010I-NUMERIC-EDIT-AREA                      11861023
118700         IF  DP010I-ERROR-DETECTED                                11870000
118800             SET PS-ERROR                                         11880000
118900                 DP020-MSG-FATAL TO TRUE                          11890000
119000             MOVE PC-TSYMSG-00008                                 11900000
119100                                 TO DP020-MSG-NUMBER              11910000
119200             MOVE DP015-UNP-ALP-BRT-OFF                           11920000
119300                                 TO AOPERA                        11930000
119400             MOVE DP015-RED      TO AOPERC                        11940000
119500             MOVE DP015-REVERSE  TO AOPERH                        11950000
119600             MOVE -1             TO AOPERL                        11960000
119700             SET DP030-SET-CURSOR-APPL-1                          11970000
119800                                 TO TRUE                          11980000
119900         ELSE                                                     11990000
120000             MOVE DP010I-NUMERIC-FIELD                            12000000
120100                                 TO ASC-OPER-UNT-ID-N             12010000
120200                                    DK-OPER-UNT-ID                12020000
120300             MOVE ASC-OPER-UNT-ID                                 12030000
120400                                 TO AOPERO                        12040000
120500             PERFORM 3020-VALIDATE-OPER-UNT-ID                    12050000
120600             IF  XL071-LOC-NOT-FOUND                              12060000
120700                 SET PS-ERROR                                     12070000
120800                     DP020-MSG-FATAL     TO TRUE                  12080000
120900                 MOVE PC-TSYMSG-00005    TO DP020-MSG-NUMBER      12090000
121000                 MOVE DP015-UNP-ALP-BRT-OFF                       12100000
121100                                         TO AOPERA                12110000
121200                 MOVE DP015-RED          TO AOPERC                12120000
121300                 MOVE DP015-REVERSE      TO AOPERH                12130000
121400                 MOVE -1                 TO AOPERL                12140000
121500                 SET DP030-SET-CURSOR-APPL-1                      12150000
121600                                         TO TRUE                  12160000
121700             END-IF                                               12170000
121800         END-IF                                                   12180000
121900     END-IF.                                                      12190000
122000                                                                  12200000
122100     IF  ASC-FCLTY-ID = (SPACES OR ZEROES)                        12210000
122200         SET PS-ERROR                                             12220000
122300             DP020-MSG-FATAL     TO TRUE                          12230000
122400         MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER              12240000
122500         MOVE DP015-UNP-ALP-BRT-OFF                               12250000
122600                                 TO AFCLTYA                       12260000
122700         MOVE DP015-RED          TO AFCLTYC                       12270000
122800         MOVE DP015-REVERSE      TO AFCLTYH                       12280000
122900         MOVE -1                 TO AFCLTYL                       12290000
123000         SET DP030-SET-CURSOR-APPL-1                              12300000
123100                                 TO TRUE                          12310000
123200     ELSE                                                         12320000
123300         MOVE ASC-FCLTY-ID       TO DP010I-UNEDITED-FIELD         12330000
123400         MOVE LENGTH OF ASC-FCLTY-ID                              12340000
123500                                 TO DP010I-MAXIMUM-DIGITS         12350000
123600         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       12360000
123700         SET DP010I-NEGATIVE-NOT-ALLOWED                          12370000
123800                                 TO TRUE                          12380000
123900         CALL DP010I-NUMERIC-EDIT-ROUTINE                         12390023
123910              USING DP010I-NUMERIC-EDIT-AREA                      12391023
124000         IF  DP010I-ERROR-DETECTED                                12400000
124100             SET PS-ERROR                                         12410000
124200                 DP020-MSG-FATAL TO TRUE                          12420000
124300             MOVE PC-TSYMSG-00008                                 12430000
124400                                 TO DP020-MSG-NUMBER              12440000
124500             MOVE DP015-UNP-ALP-BRT-OFF                           12450000
124600                                 TO AFCLTYA                       12460000
124700             MOVE DP015-RED      TO AFCLTYC                       12470000
124800             MOVE DP015-REVERSE  TO AFCLTYH                       12480000
124900             MOVE -1             TO AFCLTYL                       12490000
125000             SET DP030-SET-CURSOR-APPL-1                          12500000
125100                                 TO TRUE                          12510000
125200         ELSE                                                     12520000
125300             MOVE DP010I-NUMERIC-FIELD                            12530000
125400                                 TO ASC-FCLTY-ID-N                12540000
125500                                    DK-FCLTY-ID                   12550000
125600             MOVE ASC-FCLTY-ID   TO AFCLTYO                       12560000
125700             MOVE ASC-FCLTY-ID   TO PC140-CRA-FACLTY-ID           12570000
125800             PERFORM 3030-VALIDATE-XLT-LOC-ID                     12580000
125900             IF  SQLCODE = +100                                   12590000
126000                 SET PS-ERROR                                     12600000
126100                     DP020-MSG-FATAL     TO TRUE                  12610000
126200                 MOVE PC-TSYMSG-00005    TO DP020-MSG-NUMBER      12620000
126300                 MOVE DP015-UNP-ALP-BRT-OFF                       12630000
126400                                         TO AFCLTYA               12640000
126500                 MOVE DP015-RED          TO AFCLTYC               12650000
126600                 MOVE DP015-REVERSE      TO AFCLTYH               12660000
126700                 MOVE -1                 TO AFCLTYL               12670000
126800                 SET DP030-SET-CURSOR-APPL-1                      12680000
126900                                         TO TRUE                  12690000
127000             ELSE                                                 12700000
127100                 MOVE XLT00010-LOC-NM    TO ASC-FCLTY-NME         12710000
127200                                            AFDESCO               12720000
127300             END-IF                                               12730000
127400         END-IF                                                   12740000
127500     END-IF.                                                      12750000
127600                                                                  12760000
127700     IF ASC-VEH-NBR > SPACES                                      12770000
127800         IF ASC-OWNER-SCAC-ID = SPACES                            12780000
127900             MOVE ZEROS            TO ASC-TRIP-ID                 12790000
128000             SET PS-ERROR                                         12800000
128100                 DP020-MSG-FATAL   TO TRUE                        12810000
128200             MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER            12820000
128300             MOVE DP015-UNP-ALP-BRT-OFF                           12830000
128400                                   TO ASCACA                      12840000
128500             MOVE DP015-RED        TO ASCACC                      12850000
128600             MOVE DP015-REVERSE    TO ASCACH                      12860000
128700             MOVE -1               TO ASCACL                      12870000
128800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  12880000
128900         ELSE                                                     12890000
129000             MOVE ASC-OWNER-SCAC-ID                               12900000
129100                                   TO DK-OWNER-SCAC-ID            12910000
129200             IF DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)            12920000
129300                 PERFORM 3100-VALIDATE-SCAC-CDE                   12930000
129400                 IF PS-SCAC-EXISTS                                12940000
129500                     MOVE ASC-VEH-NBR      TO RC023-VEHICLE       12950000
129600                     CALL RC023-FB-BOL-VEH-FORMAT                 12960000
129700                                      USING RC023-FORMAT-DATA-AREA12970000
129800                     MOVE RC023-VEHICLE    TO ASC-VEH-NBR         12980000
129900                                               ATRLRO             12990000
130000                     PERFORM 3050-VALIDATE-TRAILER                13000000
130100                 ELSE                                             13010000
130200                     SET PS-ERROR                                 13020000
130300                         DP020-MSG-FATAL  TO TRUE                 13030000
130400                     MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER     13040000
130500                     MOVE DP015-UNP-ALP-BRT-OFF                   13050000
130600                                          TO ASCACA               13060000
130700                     MOVE DP015-RED       TO ASCACC               13070000
130800                     MOVE DP015-REVERSE   TO ASCACH               13080000
130900                     MOVE -1              TO ASCACL               13090000
131000                     SET DP030-SET-CURSOR-APPL-1                  13100000
131100                                          TO TRUE                 13110000
131200                 END-IF                                           13120000
131300             ELSE                                                 13130000
131400                 MOVE ASC-VEH-NBR      TO RC023-VEHICLE           13140000
131500                 CALL RC023-FB-BOL-VEH-FORMAT                     13150000
131600                                  USING RC023-FORMAT-DATA-AREA    13160000
131700                 MOVE RC023-VEHICLE    TO ASC-VEH-NBR             13170000
131800                                           ATRLRO                 13180000
131900                 PERFORM 3050-VALIDATE-TRAILER                    13190000
132000             END-IF                                               13200000
132100         END-IF                                                   13210000
132200     ELSE                                                         13220000
132300         MOVE ZEROS                    TO ASC-TRIP-ID             13230000
132400         SET ASC-VEH-DOES-NOT-EXIST    TO TRUE                    13240000
132500     END-IF.                                                      13250000
132600                                                                  13260000
132610*                                                                 13261012
132700* NUMERIC EDIT FOR TRIP ID (SCREEN).                              13270012
132710*                                                                 13271012
132800     IF ASC-SCR-TRIP-X > SPACES                                   13280000
132900         MOVE ASC-SCR-TRIP-X     TO DP010I-UNEDITED-FIELD         13290000
133000         MOVE LENGTH OF ASC-SCR-TRIP                              13300000
133100                                 TO DP010I-MAXIMUM-DIGITS         13310000
133200         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       13320000
133300         SET DP010I-NEGATIVE-NOT-ALLOWED                          13330000
133400                                 TO TRUE                          13340000
133500         CALL DP010I-NUMERIC-EDIT-ROUTINE                         13350023
133510              USING DP010I-NUMERIC-EDIT-AREA                      13351023
133600         IF  DP010I-ERROR-DETECTED                                13360000
133700             SET PS-ERROR                                         13370000
133800                 DP020-MSG-FATAL TO TRUE                          13380000
133900             MOVE PC-TSYMSG-00008                                 13390000
134000                                 TO DP020-MSG-NUMBER              13400000
134100             MOVE DP015-UNP-ALP-BRT-OFF                           13410000
134200                                 TO ATRIPA                        13420000
134300             MOVE DP015-RED      TO ATRIPC                        13430000
134400             MOVE DP015-REVERSE  TO ATRIPH                        13440000
134500             MOVE -1             TO ATRIPL                        13450000
134600             SET DP030-SET-CURSOR-APPL-1                          13460000
134700                                 TO TRUE                          13470000
134800         ELSE                                                     13480000
134900             MOVE DP010I-NUMERIC-FIELD                            13490000
135000                                 TO ASC-SCR-TRIP-N                13500000
135100                                    ASC-SCR-TRIP                  13510000
135200                                    DK-SCR-TRIP                   13520000
135300         END-IF                                                   13530000
135400     ELSE                                                         13540000
135500         MOVE ZEROES TO ASC-SCR-TRIP-N                            13550000
135600     END-IF.                                                      13560000
135700                                                                  13570000
135710*                                                                 13571012
135800* IF NO SCAC/TRLR ENTERED, USE TRIP ID TO GET DATA.               13580012
135810*                                                                 13581012
135900     IF PS-NO-ERROR                                               13590000
136000       AND ASC-VEH-NBR NOT > SPACES                               13600000
136100       AND ASC-SCR-TRIP-N > ZEROES                                13610000
136200         PERFORM 3005-GET-SCAC-TRLR                               13620000
136300     END-IF.                                                      13630000
136400                                                                  13640000
136600     IF ASC-SCR-SHIP-X > SPACES                                   13660000
136700         IF ASC-SCR-SHIP-X(1:1) = 'K'                             13670000
136800             MOVE ASC-SCR-SHIP-X         TO ASC-SCR-SHIP-N        13680000
136900                                                                  13690000
137000             MOVE ASC-SCR-SHIP-N(1:10)   TO ASC-SCR-SHIP          13700000
137100                                            DK-SCR-SHIP           13710000
137200                                                                  13720000
137300         ELSE                                                     13730000
137400             SET PS-ERROR                                         13740000
137500                 DP020-MSG-FATAL         TO TRUE                  13750000
137600             MOVE PC-TSYMSG-01303        TO DP020-MSG-NUMBER      13760000
137700             MOVE DP015-UNP-ALP-BRT-OFF  TO ASHIPA                13770000
137800             MOVE DP015-RED              TO ASHIPC                13780000
137900             MOVE DP015-REVERSE          TO ASHIPH                13790000
138000             MOVE -1                     TO ATRIPL                13800000
138100             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  13810000
138200             MOVE SPACES                 TO ASC-SCR-SHIP-N        13820000
138300                                                                  13830000
138400         END-IF                                                   13840000
138500     ELSE                                                         13850000
138600         MOVE SPACES                     TO ASC-SCR-SHIP-N        13860000
138700     END-IF.                                                      13870000
138710*                                                                 13871012
138800* IF NO SCAC/TRLR,TRIP ID ENTERED, USE SHIPMENT # TO GET DATA     13880012
138910*                                                                 13891012
139000     IF PS-NO-ERROR                                               13900000
139100       AND ASC-VEH-NBR NOT > SPACES                               13910000
139200       AND ASC-SCR-TRIP-N NOT > ZEROES                            13920000
139300       AND ASC-SCR-SHIP-N > SPACES                                13930000
139400           PERFORM 3004-GET-TRIP-ID                               13940000
139500           IF PS-NO-ERROR                                         13950000
139600              PERFORM 3005-GET-SCAC-TRLR                          13960000
139700           END-IF                                                 13970000
139800     END-IF.                                                      13980000
139900                                                                  13990000
140010*                                                                 14001012
140100* USE ENTERED SCAC/TRLR TO RETRIEVE DATA.                         14010012
140110*                                                                 14011012
140200     IF PS-NO-ERROR                                               14020000
140300       AND ASC-VEH-NBR > SPACES                                   14030000
140400         IF ASC-NO-ARIV-DTE                                       14040000
140500             MOVE ASC-OWNER-SCAC-ID TO DK-OWNER-SCAC-ID           14050000
140600             MOVE ASC-VEH-NBR       TO DK-VEH-NBR                 14060000
140700             SET PS-TRIP-EXIST TO TRUE                            14070000
140800             PERFORM 3010-GET-ARRIVAL-DATE                        14080000
141400             IF PS-TRIP-DOES-NOT-EXIST                            14140000
141500                 MOVE '0001-01-01'       TO ASC-ARRIVAL-DTE-ISO   14150000
141600                 MOVE SPACES             TO ASC-ARRIVAL-DTE       14160000
141700                                            ASC-STATUS-CODE       14170000
141800                 MOVE ZERO               TO ASC-TRIP-ID           14180000
141810                 PERFORM 3080-GET-CURR-BY-SCAC-TRLR               14181013
141900             ELSE                                                 14190000
141910*                                                                 14191012
142000* ENTERED TRIP-ID MUST MATCH SCAC/TRLR TRIP-ID.                   14200012
142010*                                                                 14201012
142100                 IF (ASC-SCR-TRIP-N > ZEROES)                     14210000
142200                   AND (ASC-SCR-TRIP-N NOT = ASC-TRIP-ID)         14220000
142300                     SET PS-ERROR                                 14230000
142400                         DP020-MSG-FATAL  TO TRUE                 14240000
142500                     MOVE PC-TSYMSG-02400 TO DP020-MSG-NUMBER     14250000
142600                     MOVE DP015-UNP-ALP-BRT-OFF                   14260000
142700                                          TO ATRIPA               14270000
142800                     MOVE DP015-RED       TO ATRIPC               14280000
142900                     MOVE DP015-REVERSE   TO ATRIPH               14290000
143000                     MOVE -1              TO ATRIPL               14300000
143100                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          14310000
143200                 ELSE                                             14320000
143300                     MOVE TRIPST-STATUS-DTE TO PV-DB2-DATE        14330000
143400                                              ASC-ARRIVAL-DTE-ISO 14340000
143500                     MOVE PV-DB2-DATE-MM    TO PV-DISPLAY-DATE-MM 14350000
143600                     MOVE PV-DB2-DATE-DD    TO PV-DISPLAY-DATE-DD 14360000
143700                     MOVE PV-DB2-DATE-YY    TO PV-DISPLAY-DATE-YY 14370000
143800                     MOVE PV-DISPLAY-DATE   TO ASC-ARRIVAL-DTE    14380000
143900                                               AARRVDTO           14390000
144000                 END-IF                                           14400000
144100             END-IF                                               14410000
144200         ELSE                                                     14420000
144300             MOVE ASC-OWNER-SCAC-ID TO DK-OWNER-SCAC-ID           14430000
144400             MOVE ASC-VEH-NBR       TO DK-VEH-NBR                 14440000
144500             PERFORM 3019-SELECT-TRIP                             14450000
145100             IF SQLCODE NOT = +0                                  14510000
145110                 PERFORM 3080-GET-CURR-BY-SCAC-TRLR               14511007
145200                 SET PS-ERROR                                     14520000
145300                     DP020-MSG-FATAL        TO TRUE               14530000
145400                 MOVE PC-TSYMSG-00743       TO DP020-MSG-NUMBER   14540000
145500                 MOVE DP015-UNP-ALP-BRT-OFF TO AARRVDTA           14550000
145600                 MOVE DP015-RED             TO AARRVDTC           14560000
145700                 MOVE DP015-REVERSE         TO AARRVDTH           14570000
145800                 IF ASC-SCR-TRIP-X > SPACES                       14580000
145900                     MOVE DP015-UNP-ALP-BRT-OFF                   14590000
146000                                            TO ATRIPA             14600000
146100                     MOVE DP015-RED         TO ATRIPC             14610000
146200                     MOVE DP015-REVERSE     TO ATRIPH             14620000
146300                 END-IF                                           14630000
146400                 MOVE -1                    TO AARRVDTL           14640000
146500                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              14650000
146600             ELSE                                                 14660000
146610*                                                                 14661012
146700* ENTERED TRIP-ID MUST MATCH SCAC/TRLR TRIP-ID.                   14670012
146710*                                                                 14671012
146800                 IF (ASC-SCR-TRIP-N > ZEROES)                     14680000
146900                   AND (ASC-SCR-TRIP-N NOT = ASC-TRIP-ID)         14690000
147000                     SET PS-ERROR                                 14700000
147100                         DP020-MSG-FATAL   TO TRUE                14710000
147200                     MOVE PC-TSYMSG-02400  TO DP020-MSG-NUMBER    14720000
147300                     MOVE DP015-UNP-ALP-BRT-OFF                   14730000
147400                                           TO ATRIPA              14740000
147500                     MOVE DP015-RED        TO ATRIPC              14750000
147600                     MOVE DP015-REVERSE    TO ATRIPH              14760000
147700                     MOVE -1               TO ATRIPL              14770000
147800                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          14780000
147900                 ELSE                                             14790000
148000                     MOVE 'AR'             TO ASC-STATUS-CODE     14800000
148100                 END-IF                                           14810000
148200             END-IF                                               14820000
148300         END-IF                                                   14830000
148400     END-IF.                                                      14840000
148500                                                                  14850000
148700     MOVE ASC-CAN                    TO ACANO.                    14870000
148900                                                                  14890000
149000     MOVE ASC-ARRIVAL-DTE-ISO        TO DK-ARRIVAL-DTE            14900000
149100                                                                  14910000
149200     IF DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)                    14920000
149300        IF ASC-MANIFEST = SPACES                                  14930000
149400            SET PS-ERROR                                          14940000
149500                DP020-MSG-FATAL     TO TRUE                       14950000
149600            MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER           14960000
149700            MOVE DP015-UNP-ALP-BRT-OFF                            14970000
149800                                    TO AMANIFA                    14980000
149900            MOVE DP015-RED          TO AMANIFC                    14990000
150000            MOVE DP015-REVERSE      TO AMANIFH                    15000000
150100            MOVE -1                 TO AMANIFL                    15010000
150200            SET DP030-SET-CURSOR-APPL-1                           15020000
150300                                    TO TRUE                       15030000
150400        END-IF                                                    15040000
150500     END-IF.                                                      15050000
150600                                                                  15060000
150700     IF PS-NO-ERROR                                               15070000
150800         MOVE -1                   TO ASCACL                      15080000
150900         SET DP030-SET-CURSOR-APPL-1                              15090000
151000                                   TO TRUE                        15100000
151100     END-IF.                                                      15110000
151200                                                                  15120000
151400******************************************************************15140000
151500*GET THE TRIP ID WITH THE EFC SHIPMENT NUMBER                     15150000
151600******************************************************************15160000
151700 3004-GET-TRIP-ID.                                                15170000
151800                                                                  15180000
151900     EXEC SQL                                                     15190000
152000         SELECT DISTINCT                                          15200000
152100                A.INTR_TRIP_ID                                    15210000
152200              , A.DEST_LOC_NBR                                    15220000
152300           INTO :PV-TRIP-ID                                       15230000
152400              , :PV-DEST-LOC-NBR                                  15240000
152500           FROM WST_SHPMT_XREF_HDR A                              15250000
152600          WHERE A.EXT_SHP_ID    = :DK-SCR-SHIP                    15260000
152700            AND A.SOR_CDE       = 'RC'                            15270000
152800     END-EXEC.                                                    15280000
152900                                                                  15290000
153000     EVALUATE TRUE                                                15300000
153100       WHEN SQLCODE = +0                                          15310000
153200       WHEN SQLCODE = -811                                        15320000
153300           MOVE PV-TRIP-ID                  TO DK-SCR-TRIP        15330000
153400           PERFORM 3004A-VALIDATE-TRIP-TO-OPER                    15340000
153500           IF PS-TRIP-OPER-ERROR-YES                              15350000
153600              SET PS-ERROR                                        15360000
153700                  DP020-MSG-FATAL           TO TRUE               15370000
153800              MOVE PC-TSYMSG-03045          TO DP020-MSG-NUMBER   15380000
153900              MOVE TRIPST-OPER-UNT-ID                             15390000
154000                                            TO DP020-MSG-TEXT     15400000
154100              MOVE DP015-UNP-ALP-BRT-OFF                          15410000
154200                                            TO ASHIPA             15420000
154300              MOVE DP015-RED                TO ASHIPC             15430000
154400              MOVE DP015-REVERSE            TO ASHIPH             15440000
154500              MOVE -1                       TO AOPERL             15450000
154600              SET DP030-SET-CURSOR-APPL-1                         15460000
154700                                            TO TRUE               15470000
154800              MOVE ZERO                     TO ASC-TRIP-ID        15480000
154900           END-IF                                                 15490000
155000                                                                  15500000
155100       WHEN SQLCODE = +100                                        15510000
155200       WHEN SQLCODE = -904                                        15520000
155300       WHEN SQLCODE = -913                                        15530000
155400       WHEN SQLCODE = -305                                        15540000
155500           SET PS-ERROR                                           15550000
155600               DP020-MSG-FATAL         TO TRUE                    15560000
155700           MOVE PC-TSYMSG-03744        TO DP020-MSG-NUMBER        15570000
155800           MOVE DP015-UNP-ALP-BRT-OFF  TO ASHIPA                  15580000
155900           MOVE DP015-RED              TO ASHIPC                  15590000
156000           MOVE DP015-REVERSE          TO ASHIPH                  15600000
156100           MOVE -1                     TO ATRIPL                  15610000
156200           SET DP030-SET-CURSOR-APPL-1 TO TRUE                    15620000
156300                                                                  15630000
156400       WHEN SQLWARN0 NOT = SPACES                                 15640000
156500       WHEN SQLCODE < +0                                          15650000
156600       WHEN SQLCODE > +0                                          15660000
156700           MOVE '3004-GET-TRIP-ID'   TO DP013-PARAGRAPH           15670000
156800           MOVE 'UNSUCCESSFUL SELECT ON WST_SHPMT_XREF_HDR'       15680000
156900                                     TO DP013-MESSAGE-TEXT (1)    15690000
157000           MOVE SQLCA                TO DP013-SQLCA               15700000
157100           MOVE 'WST_SHPMT_XREF_HDR' TO DP013-DB2-TABLE-NAME (1)  15710000
157200           SET DP013-DB2-ABEND                                    15720000
157300               DP013-XCTL-DISPLAY-RESTART TO TRUE                 15730000
157400           PERFORM DP013-0000-PROCESS-ABEND                       15740000
157500     END-EVALUATE.                                                15750000
157600                                                                  15760000
157700******************************************************************15770000
157800*CHECK THE TRIP ENTERED  IS FOR THE OPER ID ENTERED            ***15780000
157900******************************************************************15790000
158000 3004A-VALIDATE-TRIP-TO-OPER.                                     15800000
158100                                                                  15810000
158200     EXEC SQL                                                     15820000
158300         SELECT DISTINCT                                          15830000
158400                B.OPER_UNT_ID                                     15840000
158500         INTO   :TRIPST-OPER-UNT-ID                               15850000
158600         FROM   TVHTRIP A                                         15860000
158700               ,TTRIPST B                                         15870000
158800         WHERE A.TRIP_ID = :DK-SCR-TRIP                           15880000
158900           AND A.TRIP_ID = B.TRIP_ID                              15890000
159000           AND B.STATUS_DTE =                                     15900000
159100                 (SELECT MAX(D.STATUS_DTE)                        15910000
159200                    FROM TTRIPST D                                15920000
159300                   WHERE D.TRIP_ID       = A.TRIP_ID)             15930000
159400     END-EXEC.                                                    15940000
159500                                                                  15950000
159600     EVALUATE TRUE                                                15960000
159700         WHEN SQLCODE = +0                                        15970000
159800              IF ASC-OPER-UNT-ID-N = TRIPST-OPER-UNT-ID           15980000
159900                  SET PS-TRIP-OPER-ERROR-NO  TO TRUE              15990000
160000              ELSE                                                16000000
160100                  SET PS-TRIP-OPER-ERROR-YES TO TRUE              16010000
160200              END-IF                                              16020000
160300         WHEN SQLCODE = +100                                      16030000
160400             CONTINUE                                             16040000
160500                                                                  16050000
160600         WHEN SQLWARN0 NOT = SPACES                               16060000
160700         WHEN SQLCODE < +0                                        16070000
160800         WHEN SQLCODE > +0                                        16080000
160900              MOVE '3004A-VALIDATE-TRIP'                          16090000
161000                              TO DP013-PARAGRAPH                  16100000
161100              MOVE 'UNSUCCESSFUL SELECT ON TVHTRIP'               16110000
161200                              TO DP013-MESSAGE-TEXT (1)           16120000
161300              MOVE DK-TRIP-ID TO DP013-MESSAGE-TEXT (2)           16130000
161400              MOVE SQLCA      TO DP013-SQLCA                      16140000
161500              MOVE 'TVHTRIP ' TO DP013-DB2-TABLE-NAME (1)         16150000
161600              MOVE 'TTRIPST ' TO DP013-DB2-TABLE-NAME (2)         16160000
161700              SET DP013-DB2-ABEND                                 16170000
161800                  DP013-XCTL-DISPLAY-RESTART                      16180000
161900                              TO TRUE                             16190000
162000              PERFORM DP013-0000-PROCESS-ABEND                    16200000
162100     END-EVALUATE.                                                16210000
162200                                                                  16220000
162300******************************************************************16230000
162400*                                                                 16240012
162600******************************************************************16260000
162700 3005-GET-SCAC-TRLR.                                              16270000
162800                                                                  16280000
162900     EXEC SQL                                                     16290000
163000         SELECT DISTINCT                                          16300000
163100                A.TRIP_ID                                         16310000
163200              , A.OWNER_SCAC_ID                                   16320000
163300              , A.VEH_NBR                                         16330000
163400              , B.STATUS_DTE                                      16340000
163500           INTO :VHTRIP-TRIP-ID                                   16350000
163600              , :VHTRIP-OWNER-SCAC-ID                             16360000
163700              , :VHTRIP-VEH-NBR                                   16370000
163800              , :TRIPST-STATUS-DTE                                16380000
163900           FROM TVHTRIP A                                         16390000
164000              , TTRIPST B                                         16400000
164100          WHERE A.TRIP_ID       = :DK-SCR-TRIP                    16410000
164200            AND B.TRIP_ID       = A.TRIP_ID                       16420000
164300            AND B.OPER_UNT_ID   = :DK-OPER-UNT-ID                 16430000
164400            AND B.FCLTY_ID      = :DK-FCLTY-ID                    16440000
164500            AND B.STATUS_DTE =                                    16450000
164600                 (SELECT MAX(C.STATUS_DTE)                        16460000
164700                    FROM TTRIPST C                                16470000
164800                   WHERE C.TRIP_ID = A.TRIP_ID)                   16480000
164900     END-EXEC.                                                    16490000
165000                                                                  16500000
165100     EVALUATE TRUE                                                16510000
165200       WHEN SQLCODE = +0                                          16520000
165300           MOVE VHTRIP-TRIP-ID         TO ASC-TRIP-ID             16530000
165400           MOVE VHTRIP-OWNER-SCAC-ID   TO ASC-OWNER-SCAC-ID       16540000
165500                                          DK-OWNER-SCAC-ID        16550000
165600                                                                  16560000
165700           MOVE TRIPST-STATUS-DTE      TO PV-DB2-DATE             16570000
165800                                          ASC-ARRIVAL-DTE-ISO     16580000
165900           MOVE PV-DB2-DATE-MM         TO PV-DISPLAY-DATE-MM      16590000
166000           MOVE PV-DB2-DATE-DD         TO PV-DISPLAY-DATE-DD      16600000
166100           MOVE PV-DB2-DATE-YY         TO PV-DISPLAY-DATE-YY      16610000
166200           MOVE PV-DISPLAY-DATE        TO ASC-ARRIVAL-DTE         16620000
166300                                          AARRVDTO                16630000
166400                                                                  16640000
166500           MOVE VHTRIP-VEH-NBR         TO ASC-VEH-NBR             16650000
166600                                          RC023-VEHICLE           16660000
166700           CALL RC023-FB-BOL-VEH-FORMAT                           16670000
166800                USING RC023-FORMAT-DATA-AREA                      16680000
166900           MOVE RC023-VEHICLE          TO ASC-VEH-NBR             16690000
167000                                          ATRLRO                  16700000
167100           PERFORM 3050-VALIDATE-TRAILER                          16710000
167200                                                                  16720000
167300       WHEN SQLCODE = +100                                        16730000
167400       WHEN SQLCODE = -904                                        16740000
167500       WHEN SQLCODE = -913                                        16750000
167600       WHEN SQLCODE = -305                                        16760000
167610            PERFORM 3085-GET-CURR-BY-TRIP                         16761016
167700           SET PS-ERROR                                           16770000
167800               DP020-MSG-FATAL         TO TRUE                    16780000
167900           MOVE PC-TSYMSG-00743        TO DP020-MSG-NUMBER        16790000
168000           MOVE DP015-UNP-ALP-BRT-OFF  TO ATRIPA                  16800000
168100           MOVE DP015-RED              TO ATRIPC                  16810000
168200           MOVE DP015-REVERSE          TO ATRIPH                  16820000
168300           MOVE -1                     TO AARRVDTL                16830000
168400           SET DP030-SET-CURSOR-APPL-1 TO TRUE                    16840000
168500                                                                  16850000
168600       WHEN SQLWARN0 NOT = SPACES                                 16860000
168700       WHEN SQLCODE < +0                                          16870000
168800       WHEN SQLCODE > +0                                          16880000
168900           MOVE '3005-GET-SCAC-TRLR' TO DP013-PARAGRAPH           16890000
169000           MOVE 'UNSUCCESSFUL SELECT ON TVHTRIP'                  16900000
169100                                     TO DP013-MESSAGE-TEXT (1)    16910000
169200           MOVE SQLCA                TO DP013-SQLCA               16920000
169300           MOVE 'TVHTRIP '           TO DP013-DB2-TABLE-NAME (1)  16930000
169400           MOVE 'TTRIPST '           TO DP013-DB2-TABLE-NAME (2)  16940000
169500           SET DP013-DB2-ABEND                                    16950000
169600               DP013-XCTL-DISPLAY-RESTART TO TRUE                 16960000
169700           PERFORM DP013-0000-PROCESS-ABEND                       16970000
169800     END-EVALUATE.                                                16980000
169900                                                                  16990000
170000******************************************************************17000000
170100 3010-GET-ARRIVAL-DATE.                                           17010000
170200                                                                  17020000
170300     PERFORM                                                      17030000
170400         WITH TEST AFTER                                          17040000
170500         VARYING PV-RETRY-COUNTER                                 17050000
170600         FROM 1 BY 1                                              17060000
170700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               17070000
170800             OR (SQLCODE = +0)                                    17080000
170900             OR (SQLCODE = +100)                                  17090000
171000             OR (SQLCODE = -305))                                 17100000
171100                                                                  17110000
171200         EXEC SQL                                                 17120000
171300              SELECT DISTINCT                                     17130000
171400                     MAX(B.STATUS_DTE)                            17140000
171500                   , MAX(B.TRIP_ID)                               17150000
171600                INTO :TRIPST-STATUS-DTE                           17160000
171700                   , :TRIPST-TRIP-ID                              17170000
171800                FROM TVHTRIP A                                    17180000
171900                    ,TTRIPST B                                    17190000
172000                    ,TVEHICL C                                    17200000
172100              WHERE A.OWNER_SCAC_ID = :DK-OWNER-SCAC-ID           17210000
172200                AND A.VEH_NBR       = :DK-VEH-NBR                 17220000
172300                AND B.OPER_UNT_ID   = :DK-OPER-UNT-ID             17230000
172400                AND B.FCLTY_ID      = :DK-FCLTY-ID                17240000
172500                AND A.TRIP_ID = B.TRIP_ID                         17250000
172600                AND B.TRIP_ID = C.CURR_TRIP_ID                    17260000
172700                AND B.STATUS_DTE =                                17270000
172800                      (SELECT MAX(D.STATUS_DTE)                   17280000
172900                         FROM TTRIPST D                           17290000
173000                        WHERE D.TRIP_ID       = A.TRIP_ID)        17300000
173100         END-EXEC                                                 17310000
173200                                                                  17320000
173300         EVALUATE TRUE                                            17330000
173400             WHEN SQLCODE = +0                                    17340000
173500                     MOVE TRIPST-TRIP-ID TO ASC-TRIP-ID           17350000
173600                                                                  17360000
173700             WHEN SQLCODE = -305                                  17370000
173800             WHEN SQLCODE = +100                                  17380000
173900             WHEN SQLCODE = -904                                  17390000
174000             WHEN SQLCODE = -913                                  17400000
174100                  CONTINUE                                        17410000
174200                                                                  17420000
174300             WHEN SQLWARN0 NOT = SPACES                           17430000
174400             WHEN SQLCODE < +0                                    17440000
174500             WHEN SQLCODE > +0                                    17450000
174600                  MOVE '3010-GET-ARRIVAL-DATE'                    17460000
174700                                  TO DP013-PARAGRAPH              17470000
174800                  MOVE 'UNSUCCESSFUL SELECT ON TVHTRIP'           17480000
174900                                  TO DP013-MESSAGE-TEXT (1)       17490000
175000                  MOVE SQLCA      TO DP013-SQLCA                  17500000
175100                  MOVE 'TVHTRIP ' TO DP013-DB2-TABLE-NAME (1)     17510000
175200                  MOVE 'TTRIPST ' TO DP013-DB2-TABLE-NAME (2)     17520000
175300                  MOVE 'TVEHICL ' TO DP013-DB2-TABLE-NAME (3)     17530000
175400                  SET DP013-DB2-ABEND                             17540000
175500                      DP013-XCTL-DISPLAY-RESTART                  17550000
175600                                  TO TRUE                         17560000
175700                  PERFORM DP013-0000-PROCESS-ABEND                17570000
175800         END-EVALUATE                                             17580000
175900     END-PERFORM.                                                 17590000
176000                                                                  17600000
176100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    17610000
176200         SQLCODE NOT = +0                                         17620000
176300         MOVE '3010-GET-ARRIVAL-DATE'                             17630000
176400                                  TO DP013-PARAGRAPH              17640000
176500         MOVE 'MAX RETRIES EXCEEDED ON SELECT TVHTRIP'            17650000
176600                                  TO DP013-MESSAGE-TEXT (1)       17660000
176700         MOVE SQLCA               TO DP013-SQLCA                  17670000
176800         MOVE 'TVHTRIP '          TO DP013-DB2-TABLE-NAME (1)     17680000
176900         MOVE 'TTRIPST '          TO DP013-DB2-TABLE-NAME (2)     17690000
177000         MOVE 'TVEHICL '          TO DP013-DB2-TABLE-NAME (3)     17700000
177100         SET DP013-DB2-ABEND                                      17710000
177200             DP013-XCTL-DISPLAY-RESTART                           17720000
177300                                  TO TRUE                         17730000
177400         PERFORM DP013-0000-PROCESS-ABEND                         17740000
177500     END-IF.                                                      17750000
177600                                                                  17760000
177700     IF  SQLCODE = -305                                           17770000
177800      OR SQLCODE = +100                                           17780000
177900         PERFORM                                                  17790000
178000             WITH TEST AFTER                                      17800000
178100             VARYING PV-RETRY-COUNTER                             17810000
178200             FROM 1 BY 1                                          17820000
178300             UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)           17830000
178400                 OR (SQLCODE = +0)                                17840000
178500                 OR (SQLCODE = -305))                             17850000
178600                                                                  17860000
178700             EXEC SQL                                             17870000
178800                 SELECT MAX(B.STATUS_DTE)                         17880000
178900                   INTO :TRIPST-STATUS-DTE                        17890000
179000                   FROM TVHTRIP A                                 17900000
179100                       ,TTRIPST B                                 17910000
179200                  WHERE A.OWNER_SCAC_ID = :DK-OWNER-SCAC-ID       17920000
179300                    AND A.VEH_NBR       = :DK-VEH-NBR             17930000
179400                    AND B.OPER_UNT_ID   = :DK-OPER-UNT-ID         17940000
179500                    AND B.FCLTY_ID      = :DK-FCLTY-ID            17950000
179600                    AND A.TRIP_ID       = B.TRIP_ID               17960000
179700                    AND B.TRIP_STATUS_CDE ^= :PC-ET               17970000
179800             END-EXEC                                             17980000
179900                                                                  17990000
180000             EVALUATE TRUE                                        18000000
180100                 WHEN SQLCODE = -305                              18010000
180200                 WHEN SQLCODE = +100                              18020000
180300                     SET PS-TRIP-DOES-NOT-EXIST                   18030000
180400                                     TO TRUE                      18040000
180500                 WHEN SQLCODE = +0                                18050000
180600                     PERFORM 3015-SELECT-TIME                     18060000
180700                                                                  18070000
180800                 WHEN SQLCODE = -904                              18080000
180900                 WHEN SQLCODE = -913                              18090000
181000                      CONTINUE                                    18100000
181100                                                                  18110000
181200                 WHEN SQLWARN0 NOT = SPACES                       18120000
181300                 WHEN SQLCODE < +0                                18130000
181400                 WHEN SQLCODE > +0                                18140000
181500                      MOVE '3010-GET-ARRIVAL-DATE'                18150000
181600                                      TO DP013-PARAGRAPH          18160000
181700                      MOVE 'UNSUCCESSFUL SELECT ON TVHTRIP'       18170000
181800                                      TO DP013-MESSAGE-TEXT (1)   18180000
181900                      MOVE SQLCA      TO DP013-SQLCA              18190000
182000                      MOVE 'TVHTRIP ' TO DP013-DB2-TABLE-NAME (1) 18200000
182100                      MOVE 'TTRIPST ' TO DP013-DB2-TABLE-NAME (2) 18210000
182200                      MOVE 'TTRSTYP ' TO DP013-DB2-TABLE-NAME (3) 18220000
182300                      SET DP013-DB2-ABEND                         18230000
182400                          DP013-XCTL-DISPLAY-RESTART              18240000
182500                                      TO TRUE                     18250000
182600                      PERFORM DP013-0000-PROCESS-ABEND            18260000
182700             END-EVALUATE                                         18270000
182800         END-PERFORM                                              18280000
182900                                                                  18290000
183000         IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                18300000
183100             SQLCODE NOT = +0                                     18310000
183200             MOVE '3010-GET-ARRIVAL-DATE'                         18320000
183300                                      TO DP013-PARAGRAPH          18330000
183400             MOVE 'MAX RETRIES EXCEEDED ON SELECT TVHTRIP'        18340000
183500                                      TO DP013-MESSAGE-TEXT (1)   18350000
183600             MOVE SQLCA               TO DP013-SQLCA              18360000
183700             MOVE 'TVHTRIP '          TO DP013-DB2-TABLE-NAME (1) 18370000
183800             MOVE 'TTRIPST '          TO DP013-DB2-TABLE-NAME (2) 18380000
183900             MOVE 'TTRSTYP '          TO DP013-DB2-TABLE-NAME (3) 18390000
184000             SET DP013-DB2-ABEND                                  18400000
184100                 DP013-XCTL-DISPLAY-RESTART                       18410000
184200                                      TO TRUE                     18420000
184300             PERFORM DP013-0000-PROCESS-ABEND                     18430000
184400         END-IF                                                   18440000
184500     END-IF.                                                      18450000
184600                                                                  18460012
184610                                                                  18461012
200500                                                                  20050000
200600 3015-SELECT-TIME.                                                20060000
200700     PERFORM                                                      20070000
200800         WITH TEST AFTER                                          20080000
200900         VARYING PV-RETRY-COUNTER                                 20090000
201000         FROM 1 BY 1                                              20100000
201100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               20110000
201200                   OR (SQLCODE = +0)                              20120000
201300                   OR (SQLCODE = -305)                            20130000
201400                   OR (SQLCODE = -811))                           20140000
201500                                                                  20150000
201600         EXEC SQL                                                 20160000
201700          SELECT MAX(B.STATUS_TME)                                20170000
201800            INTO :TRIPST-STATUS-TME                               20180000
201900            FROM TVHTRIP A                                        20190000
202000                ,TTRIPST B                                        20200000
202100           WHERE A.OWNER_SCAC_ID = :DK-OWNER-SCAC-ID              20210000
202200             AND A.VEH_NBR       = :DK-VEH-NBR                    20220000
202300             AND B.OPER_UNT_ID   = :DK-OPER-UNT-ID                20230000
202400             AND B.FCLTY_ID      = :DK-FCLTY-ID                   20240000
202500             AND A.TRIP_ID       = B.TRIP_ID                      20250000
202600             AND B.STATUS_DTE    = :TRIPST-STATUS-DTE             20260000
202700             AND B.TRIP_STATUS_CDE ^= :PC-ET                      20270000
202800         END-EXEC                                                 20280000
202900                                                                  20290000
203000         EVALUATE TRUE                                            20300000
203100             WHEN SQLCODE = -305                                  20310000
203200             WHEN SQLCODE = +100                                  20320000
203300                 SET PS-TRIP-DOES-NOT-EXIST                       20330000
203400                                 TO TRUE                          20340000
203500             WHEN SQLCODE = +0                                    20350000
203600                     PERFORM 3017-SELECT-TRIP                     20360000
203700                                                                  20370000
203800             WHEN SQLCODE = -904                                  20380000
203900             WHEN SQLCODE = -913                                  20390000
204000                  CONTINUE                                        20400000
204100                                                                  20410000
204200             WHEN SQLWARN0 NOT = SPACES                           20420000
204300             WHEN SQLCODE < +0                                    20430000
204400             WHEN SQLCODE > +0                                    20440000
204500                  MOVE '3015-SELECT-TIME'                         20450000
204600                                  TO DP013-PARAGRAPH              20460000
204700                  MOVE 'UNSUCCESSFUL SELECT ON TVHTRIP'           20470000
204800                                  TO DP013-MESSAGE-TEXT (1)       20480000
204900                  MOVE SQLCA      TO DP013-SQLCA                  20490000
205000                  MOVE 'TVHTRIP ' TO DP013-DB2-TABLE-NAME (1)     20500000
205100                  MOVE 'TTRIPST ' TO DP013-DB2-TABLE-NAME (2)     20510000
205200                  SET DP013-DB2-ABEND                             20520000
205300                      DP013-XCTL-DISPLAY-RESTART                  20530000
205400                                  TO TRUE                         20540000
205500                  PERFORM DP013-0000-PROCESS-ABEND                20550000
205600         END-EVALUATE                                             20560000
205700     END-PERFORM.                                                 20570000
205800                                                                  20580000
205900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    20590000
206000         SQLCODE NOT = +0                                         20600000
206100         MOVE '3015-SELECT-TIME'                                  20610000
206200                                  TO DP013-PARAGRAPH              20620000
206300         MOVE 'MAX RETRIES EXCEEDED ON SELECT TVHTRIP'            20630000
206400                                  TO DP013-MESSAGE-TEXT (1)       20640000
206500         MOVE SQLCA               TO DP013-SQLCA                  20650000
206600         MOVE 'TVHTRIP '          TO DP013-DB2-TABLE-NAME (1)     20660000
206700         MOVE 'TTRIPST '          TO DP013-DB2-TABLE-NAME (2)     20670000
206800         SET DP013-DB2-ABEND                                      20680000
206900             DP013-XCTL-DISPLAY-RESTART                           20690000
207000                                  TO TRUE                         20700000
207100         PERFORM DP013-0000-PROCESS-ABEND                         20710000
207200     END-IF.                                                      20720000
207300                                                                  20730000
207400 3017-SELECT-TRIP.                                                20740000
207500     PERFORM                                                      20750000
207600         WITH TEST AFTER                                          20760000
207700         VARYING PV-RETRY-COUNTER                                 20770000
207800         FROM 1 BY 1                                              20780000
207900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               20790000
208000                   OR (SQLCODE = +0)                              20800000
208100                   OR (SQLCODE = -811))                           20810000
208200                                                                  20820000
208300             EXEC SQL                                             20830000
208400                  SELECT DISTINCT                                 20840000
208500                         B.TRIP_ID                                20850000
208600                    INTO :TRIPST-TRIP-ID                          20860000
208700                  FROM   TVHTRIP A                                20870000
208800                        ,TTRIPST B                                20880000
208900                  WHERE A.OWNER_SCAC_ID = :DK-OWNER-SCAC-ID       20890000
209000                    AND A.VEH_NBR       = :DK-VEH-NBR             20900000
209100                    AND B.OPER_UNT_ID   = :DK-OPER-UNT-ID         20910000
209200                    AND B.FCLTY_ID      = :DK-FCLTY-ID            20920000
209300                    AND B.STATUS_DTE    = :TRIPST-STATUS-DTE      20930000
209400                    AND B.STATUS_TME    = :TRIPST-STATUS-TME      20940000
209500                    AND A.TRIP_ID       = B.TRIP_ID               20950000
209600             END-EXEC                                             20960000
209700                                                                  20970000
209800             EVALUATE TRUE                                        20980000
209900                 WHEN SQLCODE = +0                                20990000
210000                     MOVE TRIPST-TRIP-ID TO ASC-TRIP-ID           21000000
210100                                                                  21010000
210200                 WHEN SQLCODE = -904                              21020000
210300                 WHEN SQLCODE = -913                              21030000
210400                      CONTINUE                                    21040000
210500                                                                  21050000
210600                 WHEN SQLWARN0 NOT = SPACES                       21060000
210700                 WHEN SQLCODE < +0                                21070000
210800                 WHEN SQLCODE > +0                                21080000
210900                      INITIALIZE PV-MESSAGE                       21090000
211000                      MOVE DK-OWNER-SCAC-ID TO PV-MESSAGE1        21100000
211100                      MOVE DK-VEH-NBR       TO PV-MESSAGE2        21110000
211200                      MOVE TRIPST-STATUS-DTE TO PV-MESSAGE3       21120000
211300                      MOVE '3017-SELECT-TRIP'                     21130000
211400                                      TO DP013-PARAGRAPH          21140000
211500                      MOVE 'UNSUCCESSFUL SELECT ON TVHTRIP'       21150000
211600                                      TO DP013-MESSAGE-TEXT (1)   21160000
211700                      MOVE PV-MESSAGE TO DP013-MESSAGE-TEXT (2)   21170000
211800                      MOVE TRIPST-STATUS-TME                      21180000
211900                                      TO DP013-MESSAGE-TEXT (3)   21190000
212000                      MOVE SQLCA      TO DP013-SQLCA              21200000
212100                      MOVE 'TVHTRIP ' TO DP013-DB2-TABLE-NAME (1) 21210000
212200                      MOVE 'TTRIPST ' TO DP013-DB2-TABLE-NAME (2) 21220000
212300                      SET DP013-DB2-ABEND                         21230000
212400                          DP013-XCTL-DISPLAY-RESTART              21240000
212500                                      TO TRUE                     21250000
212600                      PERFORM DP013-0000-PROCESS-ABEND            21260000
212700             END-EVALUATE                                         21270000
212800     END-PERFORM.                                                 21280000
212900                                                                  21290000
213000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    21300000
213100         SQLCODE NOT = +0                                         21310000
213200         MOVE '3017-SELECT-TRIP'                                  21320000
213300                                  TO DP013-PARAGRAPH              21330000
213400         MOVE 'MAX RETRIES EXCEEDED ON SELECT TVHTRIP'            21340000
213500                                  TO DP013-MESSAGE-TEXT (1)       21350000
213600         MOVE SQLCA               TO DP013-SQLCA                  21360000
213700         MOVE 'TVHTRIP '          TO DP013-DB2-TABLE-NAME (1)     21370000
213800         MOVE 'TTRIPST '          TO DP013-DB2-TABLE-NAME (2)     21380000
213900         SET DP013-DB2-ABEND                                      21390000
214000             DP013-XCTL-DISPLAY-RESTART                           21400000
214100                                  TO TRUE                         21410000
214200         PERFORM DP013-0000-PROCESS-ABEND                         21420000
214300     END-IF.                                                      21430000
214400                                                                  21440000
214500                                                                  21450000
214600 3019-SELECT-TRIP.                                                21460000
214800     PERFORM                                                      21480000
214900         WITH TEST AFTER                                          21490000
215000         VARYING PV-RETRY-COUNTER                                 21500000
215100         FROM 1 BY 1                                              21510000
215200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               21520000
215300                   OR (SQLCODE = +0)                              21530000
215400                   OR (SQLCODE = +100))                           21540000
215500                                                                  21550000
215600             EXEC SQL                                             21560000
215700                  SELECT DISTINCT                                 21570000
215800                         B.TRIP_ID                                21580000
215900                    INTO :TRIPST-TRIP-ID                          21590000
216000                    FROM TVHTRIP A                                21600000
216100                        ,TTRIPST B                                21610000
216200                  WHERE A.OWNER_SCAC_ID = :DK-OWNER-SCAC-ID       21620000
216300                    AND A.VEH_NBR       = :DK-VEH-NBR             21630000
216400                    AND B.OPER_UNT_ID   = :DK-OPER-UNT-ID         21640000
216500                    AND B.FCLTY_ID      = :DK-FCLTY-ID            21650000
216600                    AND B.STATUS_DTE    = :ASC-ARRIVAL-DTE-ISO    21660000
216700                    AND B.TRIP_STATUS_CDE = :PC-AR                21670000
216800                    AND A.TRIP_ID       = B.TRIP_ID               21680000
216900             END-EXEC                                             21690000
217000                                                                  21700000
217100             EVALUATE TRUE                                        21710000
217200                 WHEN SQLCODE = +0                                21720000
217300                     MOVE TRIPST-TRIP-ID TO ASC-TRIP-ID           21730000
217400                                                                  21740000
217500                 WHEN SQLCODE = +100                              21750000
217600                 WHEN SQLCODE = -904                              21760000
217700                 WHEN SQLCODE = -913                              21770000
217800                      CONTINUE                                    21780000
217900                                                                  21790000
218000                 WHEN SQLWARN0 NOT = SPACES                       21800000
218100                 WHEN SQLCODE < +0                                21810000
218200                 WHEN SQLCODE > +0                                21820000
218300                      INITIALIZE PV-MESSAGE                       21830000
218400                      MOVE DK-OWNER-SCAC-ID TO PV-MESSAGE1        21840000
218500                      MOVE DK-VEH-NBR       TO PV-MESSAGE2        21850000
218600                      MOVE ASC-ARRIVAL-DTE-ISO TO PV-MESSAGE3     21860000
218700                      MOVE '3019-SELECT-TRIP'                     21870000
218800                                      TO DP013-PARAGRAPH          21880000
218900                      MOVE 'UNSUCCESSFUL SELECT ON TVHTRIP'       21890000
219000                                      TO DP013-MESSAGE-TEXT (1)   21900000
219100                      MOVE PV-MESSAGE TO DP013-MESSAGE-TEXT (2)   21910000
219200                      MOVE SQLCA      TO DP013-SQLCA              21920000
219300                      MOVE 'TVHTRIP ' TO DP013-DB2-TABLE-NAME (1) 21930000
219400                      MOVE 'TTRIPST ' TO DP013-DB2-TABLE-NAME (2) 21940000
219500                      SET DP013-DB2-ABEND                         21950000
219600                          DP013-XCTL-DISPLAY-RESTART              21960000
219700                                      TO TRUE                     21970000
219800                      PERFORM DP013-0000-PROCESS-ABEND            21980000
219900             END-EVALUATE                                         21990000
220000     END-PERFORM.                                                 22000000
220100                                                                  22010000
220200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    22020000
220300         SQLCODE NOT = +0                                         22030000
220400         MOVE '3019-SELECT-TRIP'                                  22040000
220500                                  TO DP013-PARAGRAPH              22050000
220600         MOVE 'MAX RETRIES EXCEEDED ON SELECT TVHTRIP'            22060000
220700                                  TO DP013-MESSAGE-TEXT (1)       22070000
220800         MOVE SQLCA               TO DP013-SQLCA                  22080000
220900         MOVE 'TVHTRIP '          TO DP013-DB2-TABLE-NAME (1)     22090000
221000         MOVE 'TTRIPST '          TO DP013-DB2-TABLE-NAME (2)     22100000
221100         SET DP013-DB2-ABEND                                      22110000
221200             DP013-XCTL-DISPLAY-RESTART                           22120000
221300                                  TO TRUE                         22130000
221400         PERFORM DP013-0000-PROCESS-ABEND                         22140000
221500     END-IF.                                                      22150000
221600                                                                  22160000
221700                                                                  22170000
228900*----------------------------------------------------------------*22890000
229000*  CHECK THE OPER UNIT TABLE TO VERIFY THE OPER UNIT             *22900000
229100*  ENTERED ON THE MAP IS VALID.                                  *22910000
229200*----------------------------------------------------------------*22920000
229300                                                                  22930000
229400 3020-VALIDATE-OPER-UNT-ID.                                       22940000
229500                                                                  22950000
229600     INITIALIZE XL071-COMMAREA-REC.                               22960000
229700     MOVE DK-OPER-UNT-ID  TO XL071-LOCATION-NUMBER.               22970000
229800                                                                  22980000
229900     CALL XL071-LOCATION-MODULE USING DFHEIBLK                    22990000
230000                                      XL071-COMMAREA              23000000
230100                                      XL071-COMMAREA-REC.         23010000
230200     EVALUATE TRUE                                                23020000
230300                                                                  23030000
230400     WHEN XL071-NO-ERRORS                                         23040000
230500     WHEN XL071-LOC-NOT-FOUND                                     23050000
230600     WHEN XL071-DC-ASGMT-NOT-FND                                  23060000
230700     WHEN XL071-SQLCODE-N  = -904                                 23070000
230800     WHEN XL071-SQLCODE-N  = -913                                 23080000
230900         CONTINUE                                                 23090000
231000                                                                  23100000
231100     WHEN OTHER                                                   23110000
231200         MOVE '3020-VALIDATE-OPER-UNT-ID'                         23120000
231300                           TO DP013-PARAGRAPH                     23130000
231400         MOVE 'CALL TO XLKUT071'                                  23140000
231500                           TO DP013-MESSAGE-TEXT (1)              23150000
231600         MOVE XL071-SQLCA  TO DP013-SQLCA                         23160000
231700         MOVE 'XLT_LOC'    TO DP013-DB2-TABLE-NAME (1)            23170000
231800         SET DP013-DB2-ABEND                                      23180000
231900                           TO TRUE                                23190000
232000         SET DP013-XCTL-DISPLAY-RESTART                           23200000
232100                           TO TRUE                                23210000
232200         PERFORM DP013-0000-PROCESS-ABEND                         23220000
232300     END-EVALUATE.                                                23230000
232400                                                                  23240000
232500                                                                  23250000
232600/                                                                 23260000
232700*----------------------------------------------------------------*23270000
232800*  CHECK THE FACILITY TABLE TO VERIFY THAT THE FACILITY          *23280000
232900*  ENTERED ON THE MAP IS VALID.                                  *23290000
233000*----------------------------------------------------------------*23300000
233100                                                                  23310000
233200 3030-VALIDATE-XLT-LOC-ID.                                        23320000
233300                                                                  23330000
233400     PERFORM                                                      23340000
233500         WITH TEST AFTER                                          23350000
233600         VARYING PV-RETRY-COUNTER                                 23360000
233700         FROM 1 BY 1                                              23370000
233800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               23380000
233900                   OR (SQLCODE = +0)                              23390000
234000                   OR (SQLCODE = +100))                           23400000
234100                                                                  23410000
234200         EXEC SQL                                                 23420000
234300            SELECT LOC_NBR                                        23430000
234400                  ,LOC_NM                                         23440000
234500              INTO :XLT00010-LOC-NBR                              23450000
234600                  ,:XLT00010-LOC-NM                               23460000
234700              FROM XLT_LOC                                        23470000
234800             WHERE LOC_NBR     = :DK-OPER-UNT-ID                  23480000
234900         END-EXEC                                                 23490000
235000                                                                  23500000
235100         EVALUATE TRUE                                            23510000
235200             WHEN SQLCODE = +0                                    23520000
235300             WHEN SQLCODE = +100                                  23530000
235400             WHEN SQLCODE = -904                                  23540000
235500             WHEN SQLCODE = -913                                  23550000
235600                 CONTINUE                                         23560000
235700                                                                  23570000
235800             WHEN SQLWARN0 NOT = SPACES                           23580000
235900             WHEN SQLCODE < +0                                    23590000
236000             WHEN SQLCODE > +0                                    23600000
236100                 MOVE '3030-VALIDATE-XLT-LOC-ID'                  23610000
236200                                 TO DP013-PARAGRAPH               23620000
236300                 MOVE 'SELECT LOCATION NAME'                      23630000
236400                                 TO DP013-MESSAGE-TEXT (1)        23640000
236500                 MOVE SQLCA      TO DP013-SQLCA                   23650000
236600                 MOVE 'XLT_LOC'  TO DP013-DB2-TABLE-NAME (1)      23660000
236700                 SET DP013-DB2-ABEND                              23670000
236800                                 TO TRUE                          23680000
236900                 SET DP013-XCTL-DISPLAY-RESTART                   23690000
237000                                 TO TRUE                          23700000
237100                 PERFORM DP013-0000-PROCESS-ABEND                 23710000
237200         END-EVALUATE                                             23720000
237300     END-PERFORM.                                                 23730000
237400                                                                  23740000
237500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    23750000
237600         SQLCODE NOT = +0                                         23760000
237700         MOVE '3030-VALIDATE-FCLTY-ID'                            23770000
237800                                 TO DP013-PARAGRAPH               23780000
237900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     23790000
238000                                 TO DP013-MESSAGE-TEXT (1)        23800000
238100         MOVE 'LOCATION NBR  '   TO DP013-MESSAGE-TEXT (2)        23810000
238200         MOVE SQLCA              TO DP013-SQLCA                   23820000
238300         MOVE 'XLT_LOC'          TO DP013-DB2-TABLE-NAME (1)      23830000
238400         SET DP013-DB2-ABEND     TO TRUE                          23840000
238500         SET DP013-XCTL-DISPLAY-RESTART                           23850000
238600                                 TO TRUE                          23860000
238700         PERFORM DP013-0000-PROCESS-ABEND                         23870000
238800     END-IF.                                                      23880000
238900                                                                  23890000
239000/                                                                 23900000
239100*----------------------------------------------------------------*23910000
239200*  CHECK THE SHIPMENT/PO TABLE TO VERIFY THAT THE PO NUMBER      *23920000
239300*  ENTERED ON THE MAP IS VALID.                                  *23930000
239400*----------------------------------------------------------------*23940000
239500                                                                  23950000
239600 3040-VALIDATE-PO-NBR.                                            23960000
239700                                                                  23970000
239800     PERFORM                                                      23980000
239900         WITH TEST AFTER                                          23990000
240000         VARYING PV-RETRY-COUNTER                                 24000000
240100         FROM 1 BY 1                                              24010000
240200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               24020000
240300                   OR (SQLCODE = +0)                              24030000
240400                   OR (SQLCODE = -811)                            24040000
240500                   OR (SQLCODE = +100))                           24050000
240600                                                                  24060000
240700         EXEC SQL                                                 24070000
240800            SELECT  PO_NBR                                        24080000
240900              INTO :SHPTPO-PO-NBR                                 24090000
241000              FROM  TSHPTPO                                       24100000
241100             WHERE  PO_NBR = :DK-PO-NBR                           24110000
241200         END-EXEC                                                 24120000
241300                                                                  24130000
241400         EVALUATE TRUE                                            24140000
241500             WHEN SQLCODE = +0                                    24150000
241600             WHEN SQLCODE = +100                                  24160000
241700             WHEN SQLCODE = -811                                  24170000
241800             WHEN SQLCODE = -904                                  24180000
241900             WHEN SQLCODE = -913                                  24190000
242000                 CONTINUE                                         24200000
242100                                                                  24210000
242200             WHEN SQLWARN0 NOT = SPACES                           24220000
242300             WHEN SQLCODE < +0                                    24230000
242400             WHEN SQLCODE > +0                                    24240000
242500                 MOVE '3040-VALIDATE-PO-NBR'                      24250000
242600                                 TO DP013-PARAGRAPH               24260000
242700                 MOVE 'SELECT PO NUMBER   '                       24270000
242800                                 TO DP013-MESSAGE-TEXT (1)        24280000
242900                 MOVE SQLCA      TO DP013-SQLCA                   24290000
243000                 MOVE 'TSHPTPO'  TO DP013-DB2-TABLE-NAME (1)      24300000
243100                 SET DP013-DB2-ABEND                              24310000
243200                                 TO TRUE                          24320000
243300                 SET DP013-XCTL-DISPLAY-RESTART                   24330000
243400                                 TO TRUE                          24340000
243500                 PERFORM DP013-0000-PROCESS-ABEND                 24350000
243600         END-EVALUATE                                             24360000
243700     END-PERFORM.                                                 24370000
243800                                                                  24380000
243900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    24390000
244000         SQLCODE NOT = +0                                         24400000
244100         MOVE '3040-VALIDATE-PO-NBR  '                            24410000
244200                                 TO DP013-PARAGRAPH               24420000
244300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     24430000
244400                                 TO DP013-MESSAGE-TEXT (1)        24440000
244500         MOVE 'PO NUMBER     '   TO DP013-MESSAGE-TEXT (2)        24450000
244600         MOVE SQLCA              TO DP013-SQLCA                   24460000
244700         MOVE 'TSHPTPO'          TO DP013-DB2-TABLE-NAME (1)      24470000
244800         SET DP013-DB2-ABEND     TO TRUE                          24480000
244900         SET DP013-XCTL-DISPLAY-RESTART                           24490000
245000                                 TO TRUE                          24500000
245100         PERFORM DP013-0000-PROCESS-ABEND                         24510000
245200     END-IF.                                                      24520000
245300                                                                  24530000
245400/                                                                 24540000
245500*----------------------------------------------------------------*24550000
245600*  CHECK THE SHIPMENT/PO TABLE TO VERIFY THAT THE PO NUMBER      *24560000
245700*  ENTERED ON THE MAP IS VALID.                                  *24570000
245800*----------------------------------------------------------------*24580000
245900                                                                  24590000
246000 3050-VALIDATE-TRAILER.                                           24600000
246100                                                                  24610000
246200     PERFORM                                                      24620000
246300         WITH TEST AFTER                                          24630000
246400         VARYING PV-RETRY-COUNTER                                 24640000
246500         FROM 1 BY 1                                              24650000
246600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               24660000
246700                   OR (SQLCODE = +0)                              24670000
246800                   OR (SQLCODE = -811)                            24680000
246900                   OR (SQLCODE = +100))                           24690000
247000                                                                  24700000
247100         EXEC SQL                                                 24710000
247200            SELECT  VEH_NBR                                       24720000
247300                  , CURR_TRIP_ID                                  24730000
247400                  , CURR_STATUS_CDE                               24740000
247500                  , CURR_OPER_UNT_ID                              24750000
247600                  , CURR_FCLTY_ID                                 24760000
247700              INTO :VEHICL-VEH-NBR                                24770000
247800                  ,:VEHICL-CURR-TRIP-ID  :DN-CURR-TRIP-ID         24780000
247900                  ,:VEHICL-CURR-STATUS-CDE                        24790000
248000                  ,:VEHICL-CURR-OPER-UNT-ID                       24800000
248100                  ,:VEHICL-CURR-FCLTY-ID                          24810000
248200              FROM TVEHICL                                        24820000
248300             WHERE VEH_NBR        = :ASC-VEH-NBR                  24830000
248400               AND OWNER_SCAC_ID  = :ASC-OWNER-SCAC-ID            24840000
248500         END-EXEC                                                 24850000
248600                                                                  24860000
248700         EVALUATE TRUE                                            24870000
248800             WHEN SQLCODE = +0                                    24880000
248900             WHEN SQLCODE = -811                                  24890000
249000                 MOVE VEHICL-CURR-STATUS-CDE TO ASC-STATUS-CODE   24900000
249100                                                                  24910000
249200                 IF DN-CURR-TRIP-ID = -1                          24920000
249300                     SET ASC-VEH-NULL-TRIP  TO TRUE               24930000
249500                     MOVE ZERO              TO ASC-TRIP-ID        24950000
249700                     MOVE SPACES            TO ASC-CAN            24970000
250000                 ELSE                                             25000000
250100                     SET ASC-VEH-EXIST      TO TRUE               25010000
250200                     MOVE VEHICL-CURR-TRIP-ID                     25020000
250300                                            TO ASC-TRIP-ID        25030000
250500                     PERFORM 3052-GET-CAN-LATEST                  25050000
250800                     IF DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)    25080000
250900                        IF VEHICL-CURR-OPER-UNT-ID NOT =          25090000
251000                                       ASC-OPER-UNT-ID-N OR       25100000
251100                           VEHICL-CURR-FCLTY-ID    NOT =          25110000
251200                                            ASC-FCLTY-ID-N        25120000
251300                            SET PS-ERROR                          25130000
251400                                DP020-MSG-FATAL   TO TRUE         25140000
251500                            MOVE PC-TSYMSG-01097                  25150000
251600                                    TO DP020-MSG-NUMBER           25160000
251700                            MOVE VEHICL-CURR-OPER-UNT-ID          25170000
251800                                         TO DP020-MSG-TEXT        25180000
251900                            MOVE DP015-UNP-ALP-BRT-OFF            25190000
252000                                                  TO AOPERA       25200000
252100                            MOVE DP015-RED        TO AOPERC       25210000
252200                            MOVE DP015-REVERSE    TO AOPERH       25220000
252300                            MOVE -1               TO AOPERL       25230000
252400                            SET DP030-SET-CURSOR-APPL-1 TO TRUE   25240000
252500                        END-IF                                    25250000
252600                     END-IF                                       25260000
252700                 END-IF                                           25270000
252800                                                                  25280000
252900             WHEN SQLCODE = +100                                  25290000
253000                 SET ASC-VEH-DOES-NOT-EXIST TO TRUE               25300000
253300                 MOVE ZERO                  TO ASC-TRIP-ID        25330000
253500                 MOVE SPACES                TO ASC-CAN            25350000
253800                                                                  25380000
253900             WHEN SQLCODE = -904                                  25390000
254000             WHEN SQLCODE = -913                                  25400000
254100                 CONTINUE                                         25410000
254200                                                                  25420000
254300             WHEN SQLWARN0 NOT = SPACES                           25430000
254400             WHEN SQLCODE < +0                                    25440000
254500             WHEN SQLCODE > +0                                    25450000
254600                 MOVE '3050-VALIDATE-TRAILER'                     25460000
254700                                 TO DP013-PARAGRAPH               25470000
254800                 MOVE 'SELECT VEHICLE NUMBER'                     25480000
254900                                 TO DP013-MESSAGE-TEXT (1)        25490000
255000                 MOVE SQLCA      TO DP013-SQLCA                   25500000
255100                 MOVE 'TVEHICL'  TO DP013-DB2-TABLE-NAME (1)      25510000
255200                 SET DP013-DB2-ABEND                              25520000
255300                                 TO TRUE                          25530000
255400                 SET DP013-XCTL-DISPLAY-RESTART                   25540000
255500                                 TO TRUE                          25550000
255600                 PERFORM DP013-0000-PROCESS-ABEND                 25560000
255700         END-EVALUATE                                             25570000
255800     END-PERFORM.                                                 25580000
255900                                                                  25590000
256000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    25600000
256100         SQLCODE NOT = +0                                         25610000
256200         MOVE '3050-VALIDATE-TRAILER '                            25620000
256300                                 TO DP013-PARAGRAPH               25630000
256400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     25640000
256500                                 TO DP013-MESSAGE-TEXT (1)        25650000
256600         MOVE 'VEHICLE NUMBER'   TO DP013-MESSAGE-TEXT (2)        25660000
256700         MOVE SQLCA              TO DP013-SQLCA                   25670000
256800         MOVE 'TVEHICL'          TO DP013-DB2-TABLE-NAME (1)      25680000
256900         SET DP013-DB2-ABEND     TO TRUE                          25690000
257000         SET DP013-XCTL-DISPLAY-RESTART                           25700000
257100                                 TO TRUE                          25710000
257200         PERFORM DP013-0000-PROCESS-ABEND                         25720000
257300     END-IF.                                                      25730000
257400                                                                  25740000
257500                                                                  25750000
262600*----------------------------------------------------------------*26260000
262700*  DUE TO MULTIPLES - GET CARR AUTH ID FOR DIDSLAY ONLY           26270012
262800*                                                                 26280000
263000*  REMOVED TRIP STATUS (TTRIPST) FROM THIS SQL - IS NOT NEEDED    26300000
263100*  CHANGED SQL TO GO BY TRIP_ID INSTEAD OF SCAC/TRLR TO BE MORE   26310000
263200*  EFFICIENT                                                      26320000
263300*  ADDED FETCH FIRST 1 ROW ONLY                                   26330000
263400*  ADDED DESC SEQUENCE TO THE ORDER BY FOR LAST_UPD_DTE           26340000
263500*----------------------------------------------------------------*26350000
263600 3052-GET-CAN-LATEST.                                             26360000
263700                                                                  26370000
263800         EXEC SQL                                                 26380000
263900            SELECT DISTINCT CARR_AUTH_ID                          26390000
264000                           ,LAST_UPD_DTE                          26400000
264100                           ,LAST_UPD_TME                          26410000
264200              INTO :SHIPMT-CARR-AUTH-ID                           26420000
264300                  ,:SHIPMT-LAST-UPD-DTE                           26430000
264400                  ,:SHIPMT-LAST-UPD-TME                           26440000
264500              FROM TSHIPMT A                                      26450000
264900             WHERE A.TRIP_ID      = :ASC-TRIP-ID                  26490000
265000               AND A.CARR_AUTH_ID > ' '                           26500000
265300             ORDER BY  LAST_UPD_DTE DESC                          26530000
265400                      ,LAST_UPD_TME DESC                          26540000
265500             FETCH FIRST 1 ROW ONLY                               26550000
265600         END-EXEC                                                 26560000
265700                                                                  26570000
265800         EVALUATE TRUE                                            26580000
265900             WHEN SQLCODE = +0                                    26590000
266000             WHEN SQLCODE = -811                                  26600000
266100                 MOVE SHIPMT-CARR-AUTH-ID   TO ASC-CAN            26610000
266200             WHEN SQLCODE = +100                                  26620000
266300                 MOVE SPACES                TO ASC-CAN            26630000
266400             WHEN SQLCODE = -904                                  26640000
266500             WHEN SQLCODE = -913                                  26650000
266600                 CONTINUE                                         26660000
266700             WHEN SQLWARN0 NOT = SPACES                           26670000
266800             WHEN SQLCODE < +0                                    26680000
266900             WHEN SQLCODE > +0                                    26690000
267000                 MOVE '3052-GET-CAN-LATEST'                       26700000
267100                                 TO DP013-PARAGRAPH               26710000
267200                 MOVE 'SELECT CARR-AUTH-ID'                       26720000
267300                                 TO DP013-MESSAGE-TEXT (1)        26730000
267400                 MOVE SQLCA      TO DP013-SQLCA                   26740000
267500                 MOVE 'TSHIPMT'  TO DP013-DB2-TABLE-NAME (1)      26750000
267600                 SET DP013-DB2-ABEND                              26760000
267700                                 TO TRUE                          26770000
267800                 SET DP013-XCTL-DISPLAY-RESTART                   26780000
267900                                 TO TRUE                          26790000
268000                 PERFORM DP013-0000-PROCESS-ABEND                 26800000
268100         END-EVALUATE.                                            26810000
268200                                                                  26820000
268300*----------------------------------------------------------------*26830000
268310*  VALIDATE THE PRINTER ID BASED ON THE PHYSICAL LOCATION         26831012
268320*  OF THE TERMINAL.                                               26832012
268500* CALLS DPKCS060 TO VALIDATE THE PRINTER ID                      *26850000
268600*----------------------------------------------------------------*26860000
268700                                                                  26870000
268800 3060-VALIDATE-PRINTER-ID.                                        26880000
269100                                                                  26910000
269200     MOVE ASC-PRINTER-ID             TO DP072-PRINTER-ID.         26920000
269300     MOVE PC-REPORT-PROGRAM-NAME     TO DP072-RPT-PGM-NME.        26930000
269400     MOVE PC-01                      TO DP072-RPT-PGM-TYP-ID.     26940000
269500     MOVE ASC-CURR-OPER-UNT-ID       TO DP072-ORIGIN-OPER-UNT-ID  26950000
269600                                        DP072-OPER-UNT-ID.        26960000
269700     MOVE ASC-CURR-FCLTY-ID          TO DP072-ORIGIN-FCLTY-ID     26970000
269800                                        DP072-FCLTY-ID.           26980000
269900                                                                  26990000
270000     SET DP072-VALIDATE              TO TRUE.                     27000000
270100                                                                  27010000
270200     EXEC CICS                                                    27020000
270300         LINK PROGRAM  (PC-DPKCS060)                              27030000
270400              COMMAREA (DP072-COMM-AREA)                          27040000
270500              RESP     (PV-CICS-RESP)                             27050000
270600     END-EXEC.                                                    27060000
270700                                                                  27070000
270800     EVALUATE TRUE                                                27080000
270900         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     27090000
271000             CONTINUE                                             27100000
271100         WHEN OTHER                                               27110000
271200               MOVE '3060-VALIDATE-PRINTER-ID'                    27120000
271300                                     TO DP013-PARAGRAPH           27130000
271400               MOVE PV-CICS-RESP                                  27140000
271500                    TO DP013-MESSAGE-TEXT(1)                      27150000
271600               MOVE SQLCA            TO DP013-SQLCA               27160000
271700               SET DP013-CICS-ABEND                               27170000
271800                   DP013-NO-ROLLBACK TO TRUE                      27180000
271900               PERFORM DP013-0000-PROCESS-ABEND                   27190000
272000     END-EVALUATE.                                                27200000
272100                                                                  27210000
272200     IF  DP072-PRTR-PRTR-TRK-STAT-CDE =  PC-A                     27220000
272300         MOVE DP072-PRTR-IP-ADDRESS  TO PC140-HL-IP-ADDRESS       27230000
272400                                                                  27240000
272500         MOVE DP072-PRTR-CLUSTER-OS-RLSE-CDE                      27250000
272600                                     TO PC140-HL-OS-RLSE-CDE      27260000
272700                                                                  27270000
272800         MOVE DP072-PRTR-DATA-XFER-MODE-ID                        27280000
272900                                     TO PC140-HL-XFER-MODE-ID     27290000
273000                                                                  27300000
273100         MOVE DP072-XMIT-INTFC-CDE                                27310000
273200                                     TO PC140-XMIT-INTFC-CDE      27320000
273300         MOVE DP072-PRTR-OPER-UNT-ID TO PC-OPER-UNT-ID            27330000
273400                                                                  27340000
273500     ELSE                                                         27350000
273600         MOVE PC-TSYMSG-00746        TO DP020-MSG-NUMBER          27360000
273700         SET PS-ERROR                                             27370000
273800             DP020-MSG-FATAL                                      27380000
273900             DP030-SET-CURSOR-APPL-1 TO TRUE                      27390000
274000                                                                  27400000
274100         MOVE DP015-UNP-ALP-BRT-OFF  TO APRINTRA                  27410000
274200         MOVE DP015-RED              TO APRINTRC                  27420000
274300         MOVE DP015-REVERSE          TO APRINTRH                  27430000
274400         MOVE -1                     TO APRINTRL                  27440000
274500     END-IF.                                                      27450000
274600                                                                  27460000
274700/                                                                 27470000
274800*----------------------------------------------------------------*27480000
274900*    VERIFY THE PRINTER ID USING THE PRINTER CONTROL ROUTINE     *27490000
275000*    (DPKCS060) WHEN PRINTING THE MANIFEST                       *27500000
275100*----------------------------------------------------------------*27510000
275200                                                                  27520000
275300 3070-VALIDATE-MANIFEST-PRINTER.                                  27530000
275400                                                                  27540000
275500     MOVE ASC-PRINTER-ID             TO DP072-PRINTER-ID.         27550000
275600     MOVE 'RCKCS226'                 TO DP072-RPT-PGM-NME.        27560000
275700     MOVE PC-01                      TO DP072-RPT-PGM-TYP-ID.     27570000
275800                                                                  27580000
275900     MOVE ASC-OPER-UNT-ID            TO DP072-ORIGIN-OPER-UNT-ID. 27590000
276000     MOVE DP020-LOCATION-NBR         TO DP072-OPER-UNT-ID.        27600000
276100                                                                  27610000
276200     MOVE ASC-FCLTY-ID               TO DP072-ORIGIN-FCLTY-ID     27620000
276300                                        DP072-FCLTY-ID.           27630000
276400                                                                  27640000
276500     SET DP072-VALIDATE              TO TRUE.                     27650000
276600                                                                  27660000
276700     EXEC CICS                                                    27670000
276800         LINK PROGRAM  (PC-DPKCS060)                              27680000
276900              COMMAREA (DP072-COMM-AREA)                          27690000
277000              RESP     (PV-CICS-RESP)                             27700000
277100     END-EXEC.                                                    27710000
277200                                                                  27720000
277300     EVALUATE TRUE                                                27730000
277400         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     27740000
277500             CONTINUE                                             27750000
277600         WHEN OTHER                                               27760000
277700               MOVE '3070-VALIDATE-MANIFEST-PRINTER'              27770000
277800                                     TO DP013-PARAGRAPH           27780000
277900               MOVE PV-CICS-RESP                                  27790000
278000                    TO DP013-MESSAGE-TEXT(1)                      27800000
278100               MOVE SQLCA            TO DP013-SQLCA               27810000
278200               SET DP013-CICS-ABEND                               27820000
278300                   DP013-NO-ROLLBACK TO TRUE                      27830000
278400               PERFORM DP013-0000-PROCESS-ABEND                   27840000
278500     END-EVALUATE.                                                27850000
278600                                                                  27860000
278700     IF  DP072-PRTR-PRTR-TRK-STAT-CDE = PC-A                      27870000
278800         MOVE DP072-PRTR-AUTO-CUTTER-IND                          27880000
278900                                     TO ASC-PRTR-AUTO-CUTTER-IND  27890000
279000         MOVE DP072-PRTR-PRTR-BRCDE-IND                           27900000
279100                                     TO ASC-PRTR-BARCODE-IND      27910000
279200         MOVE DP072-PRTR-PRTR-CNTL-IND                            27920000
279300                                     TO ASC-PRTR-PRTR-CNTL-IND    27930000
279400         MOVE DP072-PRTR-TRACK-NBR   TO ASC-PRTR-TRACK-NBR        27940000
279500     ELSE                                                         27950000
279600         MOVE PC-TSYMSG-00746        TO DP020-MSG-NUMBER          27960000
279700         SET PS-ERROR                                             27970000
279800             DP020-MSG-FATAL                                      27980000
279900             DP030-SET-CURSOR-APPL-1 TO TRUE                      27990000
280000                                                                  28000000
280100         MOVE DP015-UNP-ALP-BRT-OFF  TO APRINTRA                  28010000
280200         MOVE DP015-RED              TO APRINTRC                  28020000
280300         MOVE DP015-REVERSE          TO APRINTRH                  28030000
280400         MOVE -1                     TO APRINTRL                  28040000
280500     END-IF.                                                      28050000
280600                                                                  28060000
280700/                                                                 28070000
280701******************************************************************28070107
280702* IF SCAC/TRAILER DOES NOT HAVE TRIP FOR CURRENT SIGN ON LOCATION*28070207
280703* THIS PARAGRAPH IS CALLED TO DETERMINE WHICH OPER THE SCAC/TRLR *28070307
280704* IS FOR AND WHAT THE CURRENT TRIP IS.                           *28070407
280705* ADDED 11/10/20 DMH                                             *28070507
280706******************************************************************28070607
280710 3080-GET-CURR-BY-SCAC-TRLR.                                      28071007
280711                                                                  28071107
280712     SET  ASC-DISP-CURR-TRIP-N  TO  TRUE.                         28071207
280713                                                                  28071307
280720     PERFORM                                                      28072007
280730         WITH TEST AFTER                                          28073007
280740         VARYING PV-RETRY-COUNTER                                 28074007
280750         FROM 1 BY 1                                              28075007
280760         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               28076007
280770                   OR (SQLCODE = +0)                              28077007
280780                   OR (SQLCODE = +100)                            28078021
280781                   OR (SQLCODE = -305))                           28078120
280790                                                                  28079007
280791             EXEC SQL                                             28079107
280793                  SELECT A.OWNER_SCAC_ID                          28079307
280794                       , A.VEH_NBR                                28079407
280795                       , A.TRIP_ID                                28079507
280796                       , B.OPER_UNT_ID                            28079607
280797                       , B.TRIP_STATUS_CDE                        28079714
280798                       , E.LOC_10_ABBR_NM                         28079814
280799                    INTO :ASC-DISP-CURR-SCAC-NBR                  28079914
280800                       , :ASC-DISP-CURR-TRLR-NBR                  28080009
280801                       , :ASC-DISP-CURR-TRIP-NBR                  28080109
280802                       , :ASC-DISP-CURR-OPER-NBR                  28080209
280803                       , :ASC-DISP-CURR-STAT-CDE                  28080314
280804                       , :ASC-DISP-CURR-OPER-NME                  28080414
280808                    FROM TVHTRIP A                                28080807
280809                       , TTRIPST B                                28080907
280810                       , TVEHICL C                                28081007
280811                       , TTRSTYP D                                28081107
280812                       , XLT_LOC E                                28081207
280815                  WHERE A.OWNER_SCAC_ID   = :DK-OWNER-SCAC-ID     28081507
280816                    AND A.VEH_NBR         = :DK-VEH-NBR           28081607
280817                    AND A.OWNER_SCAC_ID   =  C.OWNER_SCAC_ID      28081707
280818                    AND A.VEH_NBR         =  C.VEH_NBR            28081807
280819                    AND A.TRIP_ID         =  C.CURR_TRIP_ID       28081907
280820                    AND A.TRIP_ID         =  B.TRIP_ID            28082007
280821                    AND B.TRIP_STATUS_CDE =  D.TRIP_STATUS_CDE    28082107
280822                    AND D.PRTY_CDE IN                             28082207
280823                        (SELECT MAX(DD.PRTY_CDE)                  28082307
280824                           FROM TTRSTYP DD                        28082407
280825                              , TTRIPST BB                        28082507
280826                          WHERE B.TRIP_ID  =  BB.TRIP_ID          28082607
280827                            AND BB.TRIP_STATUS_CDE =              28082707
280828                                DD.TRIP_STATUS_CDE)               28082810
280829                    AND B.OPER_UNT_ID  =  E.LOC_NBR               28082907
280836             END-EXEC                                             28083607
280837                                                                  28083707
280838             EVALUATE TRUE                                        28083807
280839                 WHEN SQLCODE = +0                                28083907
280840                      SET  ASC-DISP-CURR-TRIP-Y  TO  TRUE         28084007
280842                                                                  28084207
280843                 WHEN SQLCODE = +100                              28084307
280844                 WHEN SQLCODE = -305                              28084420
280845                 WHEN SQLCODE = -904                              28084520
280846                 WHEN SQLCODE = -913                              28084620
280847                      CONTINUE                                    28084720
280848                                                                  28084820
280849                 WHEN SQLWARN0 NOT = SPACES                       28084920
280850                 WHEN SQLCODE < +0                                28085020
280851                 WHEN SQLCODE > +0                                28085120
280852                      INITIALIZE PV-MESSAGE                       28085220
280853                      MOVE DK-OWNER-SCAC-ID TO PV-MESSAGE1        28085320
280854                      MOVE DK-VEH-NBR       TO PV-MESSAGE2        28085420
280855                      MOVE '3080-GET-CURR-BY-SCAC-TRLR'           28085507
280856                                      TO DP013-PARAGRAPH          28085607
280857                      MOVE 'UNSUCCESSFUL SELECT ON TVHTRIP'       28085707
280858                                      TO DP013-MESSAGE-TEXT (1)   28085807
280859                      MOVE PV-MESSAGE TO DP013-MESSAGE-TEXT (2)   28085907
280860                      MOVE SQLCA      TO DP013-SQLCA              28086007
280861                      MOVE 'TVHTRIP ' TO DP013-DB2-TABLE-NAME (1) 28086107
280862                      MOVE 'TTRIPST ' TO DP013-DB2-TABLE-NAME (2) 28086207
280863                      MOVE 'TVEHICL ' TO DP013-DB2-TABLE-NAME (3) 28086307
280864                      SET DP013-DB2-ABEND                         28086407
280865                          DP013-XCTL-DISPLAY-RESTART              28086507
280866                                      TO TRUE                     28086607
280867                      PERFORM DP013-0000-PROCESS-ABEND            28086707
280868             END-EVALUATE                                         28086807
280869     END-PERFORM.                                                 28086907
280870                                                                  28087007
280871     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    28087107
280872         SQLCODE NOT = +0                                         28087207
280873         MOVE '3080-GET-CURR-BY-SCAC-TRLR'                        28087308
280874                                  TO DP013-PARAGRAPH              28087407
280875         MOVE 'MAX RETRIES EXCEEDED ON SELECT TVHTRIP'            28087507
280876                                  TO DP013-MESSAGE-TEXT (1)       28087607
280877         MOVE SQLCA               TO DP013-SQLCA                  28087707
280878         MOVE 'TVHTRIP '          TO DP013-DB2-TABLE-NAME (1)     28087807
280879         MOVE 'TTRIPST '          TO DP013-DB2-TABLE-NAME (2)     28087907
280880         MOVE 'TVEHICL '          TO DP013-DB2-TABLE-NAME (3)     28088007
280881         SET DP013-DB2-ABEND                                      28088107
280882             DP013-XCTL-DISPLAY-RESTART                           28088207
280883                                  TO TRUE                         28088307
280884         PERFORM DP013-0000-PROCESS-ABEND                         28088407
280885     END-IF.                                                      28088507
280886                                                                  28088607
280887                                                                  28088707
280888******************************************************************28088816
280889* IF TRIP ID IS ENTERED AND THE TRIP IS NOT FOR THE CURRENT LOC  *28088916
280890* THIS PARAGRAPH IS CALLED TO DETERMINE WHICH OPER THE SCAC/TRLR *28089016
280891* IS FOR AND WHAT THE CURRENT TRIP IS.                           *28089116
280892* ADDED 11/10/20 DMH                                             *28089216
280893******************************************************************28089316
280894 3085-GET-CURR-BY-TRIP.                                           28089416
280895                                                                  28089516
280896     SET  ASC-DISP-CURR-TRIP-N  TO  TRUE.                         28089616
280897                                                                  28089716
280898     PERFORM                                                      28089816
280899         WITH TEST AFTER                                          28089916
280900         VARYING PV-RETRY-COUNTER                                 28090016
280901         FROM 1 BY 1                                              28090116
280902         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               28090216
280903                   OR (SQLCODE = +0)                              28090316
280904                   OR (SQLCODE = +100))                           28090416
280905                                                                  28090516
280906             EXEC SQL                                             28090616
280907                  SELECT A.OWNER_SCAC_ID                          28090716
280908                       , A.VEH_NBR                                28090816
280909                       , A.TRIP_ID                                28090916
280910                       , B.OPER_UNT_ID                            28091016
280911                       , B.TRIP_STATUS_CDE                        28091116
280912                       , E.LOC_10_ABBR_NM                         28091216
280913                    INTO :ASC-DISP-CURR-SCAC-NBR                  28091316
280914                       , :ASC-DISP-CURR-TRLR-NBR                  28091416
280915                       , :ASC-DISP-CURR-TRIP-NBR                  28091516
280916                       , :ASC-DISP-CURR-OPER-NBR                  28091616
280917                       , :ASC-DISP-CURR-STAT-CDE                  28091716
280918                       , :ASC-DISP-CURR-OPER-NME                  28091816
280919                    FROM TVHTRIP A                                28091916
280920                       , TTRIPST B                                28092016
280921                       , TVEHICL C                                28092116
280922                       , TTRSTYP D                                28092216
280923                       , XLT_LOC E                                28092316
280924                  WHERE A.TRIP_ID         = :DK-SCR-TRIP          28092416
280926                    AND A.OWNER_SCAC_ID   =  C.OWNER_SCAC_ID      28092616
280927                    AND A.VEH_NBR         =  C.VEH_NBR            28092716
280928                    AND A.TRIP_ID         =  C.CURR_TRIP_ID       28092816
280929                    AND A.TRIP_ID         =  B.TRIP_ID            28092916
280930                    AND B.TRIP_STATUS_CDE =  D.TRIP_STATUS_CDE    28093016
280931                    AND D.PRTY_CDE IN                             28093116
280932                        (SELECT MAX(DD.PRTY_CDE)                  28093216
280933                           FROM TTRSTYP DD                        28093316
280934                              , TTRIPST BB                        28093416
280935                          WHERE B.TRIP_ID  =  BB.TRIP_ID          28093516
280936                            AND BB.TRIP_STATUS_CDE =              28093616
280937                                DD.TRIP_STATUS_CDE)               28093716
280938                    AND B.OPER_UNT_ID  =  E.LOC_NBR               28093816
280940             END-EXEC                                             28094016
280941                                                                  28094116
280942             EVALUATE TRUE                                        28094216
280943                 WHEN SQLCODE = +0                                28094316
280944                      SET  ASC-DISP-CURR-TRIP-Y  TO  TRUE         28094416
280945                                                                  28094516
280946                 WHEN SQLCODE = +100                              28094616
280947                 WHEN SQLCODE = -904                              28094716
280948                 WHEN SQLCODE = -913                              28094816
280949                      CONTINUE                                    28094916
280950                                                                  28095016
280951                 WHEN SQLWARN0 NOT = SPACES                       28095116
280952                 WHEN SQLCODE < +0                                28095216
280953                 WHEN SQLCODE > +0                                28095316
280954                      INITIALIZE PV-MESSAGE                       28095416
280955                      MOVE DK-OWNER-SCAC-ID TO PV-MESSAGE1        28095516
280956                      MOVE DK-VEH-NBR       TO PV-MESSAGE2        28095616
280957                      MOVE '3085-GET-CURR-BY-TRIP'                28095716
280958                                      TO DP013-PARAGRAPH          28095816
280959                      MOVE 'UNSUCCESSFUL SELECT ON TVHTRIP'       28095916
280960                                      TO DP013-MESSAGE-TEXT (1)   28096016
280961                      MOVE PV-MESSAGE TO DP013-MESSAGE-TEXT (2)   28096116
280962                      MOVE SQLCA      TO DP013-SQLCA              28096216
280963                      MOVE 'TVHTRIP ' TO DP013-DB2-TABLE-NAME (1) 28096316
280964                      MOVE 'TTRIPST ' TO DP013-DB2-TABLE-NAME (2) 28096416
280965                      MOVE 'TVEHICL ' TO DP013-DB2-TABLE-NAME (3) 28096516
280966                      SET DP013-DB2-ABEND                         28096616
280967                          DP013-XCTL-DISPLAY-RESTART              28096716
280968                                      TO TRUE                     28096816
280969                      PERFORM DP013-0000-PROCESS-ABEND            28096916
280970             END-EVALUATE                                         28097016
280971     END-PERFORM.                                                 28097116
280972                                                                  28097216
280973     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    28097316
280974         SQLCODE NOT = +0                                         28097416
280975         MOVE '3085-GET-CURR-BY-TRIP'                             28097516
280976                                  TO DP013-PARAGRAPH              28097616
280977         MOVE 'MAX RETRIES EXCEEDED ON SELECT TVHTRIP'            28097716
280978                                  TO DP013-MESSAGE-TEXT (1)       28097816
280979         MOVE SQLCA               TO DP013-SQLCA                  28097916
280980         MOVE 'TVHTRIP '          TO DP013-DB2-TABLE-NAME (1)     28098016
280981         MOVE 'TTRIPST '          TO DP013-DB2-TABLE-NAME (2)     28098116
280982         MOVE 'TVEHICL '          TO DP013-DB2-TABLE-NAME (3)     28098216
280983         SET DP013-DB2-ABEND                                      28098316
280984             DP013-XCTL-DISPLAY-RESTART                           28098416
280985                                  TO TRUE                         28098516
280986         PERFORM DP013-0000-PROCESS-ABEND                         28098616
280987     END-IF.                                                      28098716
280988                                                                  28098816
280989                                                                  28098916
280990*----------------------------------------------------------------*28099007
280991*  CHECK THE EXTERNAL ENTERPRISE TABLE TO VERIFY THE SCAC CODE   *28099100
281000*  ENTERED IS VALID.                                             *28100000
281100*----------------------------------------------------------------*28110000
281200                                                                  28120000
281300 3100-VALIDATE-SCAC-CDE.                                          28130000
281400                                                                  28140000
281500     PERFORM                                                      28150000
281600         WITH TEST AFTER                                          28160000
281700         VARYING PV-RETRY-COUNTER                                 28170000
281800         FROM 1 BY 1                                              28180000
281900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               28190000
282000                   OR (SQLCODE = +0)                              28200000
282100                   OR (SQLCODE = +100)                            28210000
282200                   OR (SQLCODE = -811))                           28220000
282300                                                                  28230000
282400         EXEC SQL                                                 28240000
282500            SELECT  SCAC_CDE                                      28250000
282600              INTO :EXTENT-SCAC-CDE                               28260000
282700              FROM  TEXTENT                                       28270000
282800             WHERE  SCAC_CDE    = :DK-OWNER-SCAC-ID               28280000
282900               AND  CARRIER_IND = 'Y'                             28290000
283000             WITH UR                                              28300000
283100         END-EXEC                                                 28310000
283200                                                                  28320000
283300         EVALUATE TRUE                                            28330000
283400             WHEN SQLCODE = +0                                    28340000
283500             WHEN SQLCODE = -811                                  28350000
283600                 SET PS-SCAC-EXISTS       TO TRUE                 28360000
283700                                                                  28370000
283800             WHEN SQLCODE = +100                                  28380000
283900                 SET PS-SCAC-DOESNT-EXIST TO TRUE                 28390000
284000                                                                  28400000
284100             WHEN SQLCODE = -904                                  28410000
284200             WHEN SQLCODE = -913                                  28420000
284300                 CONTINUE                                         28430000
284400                                                                  28440000
284500             WHEN SQLWARN0 NOT = SPACES                           28450000
284600             WHEN SQLCODE < +0                                    28460000
284700             WHEN SQLCODE > +0                                    28470000
284800                 MOVE '3100-VALIDATE-SCAC-CDE'                    28480000
284900                                 TO DP013-PARAGRAPH               28490000
285000                 MOVE 'SELECT SCAC CODE'                          28500000
285100                                 TO DP013-MESSAGE-TEXT (1)        28510000
285200                 MOVE DK-OWNER-SCAC-ID                            28520000
285300                                 TO DP013-MESSAGE-TEXT (2)        28530000
285400                 MOVE SQLCA      TO DP013-SQLCA                   28540000
285500                 MOVE 'TEXTENT'  TO DP013-DB2-TABLE-NAME (1)      28550000
285600                 SET DP013-DB2-ABEND                              28560000
285700                                 TO TRUE                          28570000
285800                 SET DP013-XCTL-DISPLAY-RESTART                   28580000
285900                                 TO TRUE                          28590000
286000                 PERFORM DP013-0000-PROCESS-ABEND                 28600000
286100         END-EVALUATE                                             28610000
286200     END-PERFORM.                                                 28620000
286300                                                                  28630000
286400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    28640000
286500         SQLCODE NOT = +0                                         28650000
286600         MOVE '3100-VALIDATE-SCAC-CDE'                            28660000
286700                                 TO DP013-PARAGRAPH               28670000
286800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     28680000
286900                                 TO DP013-MESSAGE-TEXT (1)        28690000
287000         MOVE 'SCAC CODE       ' TO DP013-MESSAGE-TEXT (2)        28700000
287100         MOVE SQLCA              TO DP013-SQLCA                   28710000
287200         MOVE 'TEXTENT'          TO DP013-DB2-TABLE-NAME (1)      28720000
287300         SET DP013-DB2-ABEND     TO TRUE                          28730000
287400         SET DP013-XCTL-DISPLAY-RESTART                           28740000
287500                                 TO TRUE                          28750000
287600         PERFORM DP013-0000-PROCESS-ABEND                         28760000
287700     END-IF.                                                      28770000
287800                                                                  28780000
287900/                                                                 28790000
288000******************************************************************28800000
288100** MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS ON THE **28810000
288200** MAP.                                                         **28820000
288300******************************************************************28830000
288400 3200-RESET-ATTRIBUTES.                                           28840000
288500                                                                  28850000
288600     MOVE DP015-UNP-ALP-NOR-OFF    TO AOPERA                      28860000
288700                                      AFCLTYA                     28870000
288800                                      ATRLRA                      28880000
288900                                      ASCACA                      28890000
289000                                      AOSCACA                     28900000
289100                                      AARRVDTA                    28910000
289200                                      AFBA                        28920000
289300                                      ATRIPA                      28930000
289500                                      ASHIPA                      28950000
289700                                      ABOLA                       28970000
289800                                      APOA                        28980000
289900                                      AMANIFA                     28990000
290000                                      APRINTRA.                   29000000
290100     MOVE DP015-GREEN              TO AOPERC                      29010000
290200                                      AFCLTYC                     29020000
290300                                      ATRLRC                      29030000
290400                                      ASCACC                      29040000
290500                                      AOSCACC                     29050000
290600                                      AARRVDTC                    29060000
290700                                      AFBC                        29070000
290800                                      ATRIPC                      29080000
291000                                      ASHIPC                      29100000
291200                                      ABOLC                       29120000
291300                                      APOC                        29130000
291400                                      AMANIFC                     29140000
291500                                      APRINTRC.                   29150000
291600     MOVE DP015-UNDERLINE          TO AOPERH                      29160000
291700                                      AFCLTYH                     29170000
291800                                      ATRLRH                      29180000
291900                                      ASCACH                      29190000
292000                                      AOSCACH                     29200000
292100                                      AARRVDTH                    29210000
292200                                      AFBH                        29220000
292300                                      ATRIPH                      29230000
292500                                      ASHIPH                      29250000
292700                                      ABOLH                       29270000
292800                                      APOH                        29280000
292900                                      AMANIFH                     29290000
293000                                      APRINTRH.                   29300000
293100                                                                  29310000
293200/                                                                 29320000
293300*----------------------------------------------------------------*29330000
293400*                                                                *29340000
293500*----------------------------------------------------------------*29350000
293600 3500-GET-DC-LOCATION.                                            29360000
293700     INITIALIZE XL071-COMMAREA-REC.                               29370000
293800     MOVE PC-OPER-UNT-ID  TO XL071-LOCATION-NUMBER.               29380000
293900                                                                  29390000
294000     CALL XL071-LOCATION-MODULE USING DFHEIBLK                    29400000
294100                                XL071-COMMAREA                    29410000
294200                                XL071-COMMAREA-REC.               29420000
294300                                                                  29430000
294400     EVALUATE TRUE                                                29440000
294500         WHEN XL071-NO-ERRORS                                     29450000
294600             IF XL071-LOC-TYP-CDE = 'DC'                          29460000
294700                 MOVE  XL071-LOC-5-ABBR-NM                        29470000
294800                                 TO  PV-DC-5-CHAR-ABBR            29480000
294900                 MOVE  PV-2-DIGIT-DC-ABBR                         29490000
295000                                 TO  PC140-CRA-DC-ID              29500000
295100                 MOVE  PC-OPER-UNT-ID                             29510000
295200                                 TO  PC140-CRA-OPER-UNT-ID        29520000
295300             END-IF                                               29530000
295400                                                                  29540000
295500         WHEN XL071-LOC-NOT-FOUND                                 29550000
295600              MOVE  PC-90   TO  PC140-CRA-DC-ID                   29560000
295700                                PC140-CRA-OPER-UNT-ID             29570000
295800                                                                  29580000
295900         WHEN OTHER                                               29590000
296000             MOVE '3500-GET-DC-LOCATION'                          29600000
296100                                 TO DP013-PARAGRAPH               29610000
296200             MOVE 'CALL TO XLKUT071'                              29620000
296300                                   TO DP013-MESSAGE-TEXT (1)      29630000
296400             MOVE XL071-SQLCODE-N  TO SQLCODE                     29640000
296500             MOVE XL071-SQLCA      TO DP013-SQLCA                 29650000
296600             MOVE 'XLT_LOC'        TO DP013-DB2-TABLE-NAME (1)    29660000
296700             SET DP013-DB2-ABEND                                  29670000
296800                                 TO TRUE                          29680000
296900             SET DP013-XCTL-DISPLAY-RESTART                       29690000
297000                                 TO TRUE                          29700000
297100             PERFORM DP013-0000-PROCESS-ABEND                     29710000
297200     END-EVALUATE.                                                29720000
297300                                                                  29730000
297400*----------------------------------------------------------------*29740000
297500*  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *29750000
297600*  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *29760000
297700*  IT HERE.                                                      *29770000
297800*----------------------------------------------------------------*29780000
297900 4000-BUILD-INITIAL-PANEL.                                        29790000
298000                                                                  29800000
298100     MOVE ASC-OPER-UNT-ID-N        TO DK-OPER-UNT-ID.             29810000
298200     MOVE ASC-FCLTY-ID-N           TO DK-FCLTY-ID.                29820000
298300                                                                  29830000
298400     PERFORM 4010-GET-FCLTY-NAME.                                 29840000
298500                                                                  29850000
298600     SET DP030-SET-CURSOR-APPL-1   TO TRUE                        29860000
298700     MOVE -1                       TO ASCACL.                     29870000
298800                                                                  29880000
298900     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        29890000
299000                                                                  29900000
299100/                                                                 29910000
299200*----------------------------------------------------------------*29920000
299300*    GET THE FACILITY NAME                                       *29930000
299400*----------------------------------------------------------------*29940000
299500 4010-GET-FCLTY-NAME.                                             29950000
299600                                                                  29960000
299700     INITIALIZE XL071-COMMAREA-REC.                               29970000
299800     MOVE DK-OPER-UNT-ID  TO XL071-LOCATION-NUMBER.               29980000
299900                                                                  29990000
300000     CALL XL071-LOCATION-MODULE USING DFHEIBLK                    30000000
300100                                      XL071-COMMAREA              30010000
300200                                      XL071-COMMAREA-REC.         30020000
300300                                                                  30030000
300400     EVALUATE TRUE                                                30040000
300500         WHEN XL071-NO-ERRORS                                     30050000
300600             MOVE XL071-LOC-NM  TO ASC-FCLTY-NME                  30060000
300700         WHEN XL071-LOC-NOT-FOUND                                 30070000
300800         WHEN XL071-SQLCODE-N  = -904                             30080000
300900         WHEN XL071-SQLCODE-N  = -913                             30090000
301000             MOVE SPACES TO ASC-FCLTY-NME                         30100000
301100                                                                  30110000
301200         WHEN XL071-BAD-DB2-RETURN                                30120000
301300             MOVE '4010-GET-FCLTY-NAME'                           30130000
301400                                TO DP013-PARAGRAPH                30140000
301500             MOVE 'CALL TO XLKUT071'                              30150000
301600                                TO DP013-MESSAGE-TEXT (1)         30160000
301700             MOVE XL071-SQLCA   TO DP013-SQLCA                    30170000
301800             MOVE 'XLT_LOC'     TO DP013-DB2-TABLE-NAME (1)       30180000
301900             SET DP013-DB2-ABEND                                  30190000
302000                 DP013-XCTL-DISPLAY-RESTART TO TRUE               30200000
302100             PERFORM DP013-0000-PROCESS-ABEND                     30210000
302200     END-EVALUATE.                                                30220000
302300                                                                  30230000
302400                                                                  30240000
302500/                                                                 30250000
302600*----------------------------------------------------------------*30260000
302700*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *30270000
302800*----------------------------------------------------------------*30280000
302900 4400-MOVE-COMMAREA-TO-SCREEN.                                    30290000
303000                                                                  30300000
303100     MOVE ASC-OPER-UNT-ID          TO AOPERO.                     30310000
303200     MOVE ASC-FCLTY-NME            TO AFDESCO.                    30320000
303300     MOVE ASC-FCLTY-ID             TO AFCLTYO.                    30330000
303400     MOVE ASC-ORIGIN-SCAC-ID       TO AOSCACO.                    30340000
303500     MOVE ASC-OWNER-SCAC-ID        TO ASCACO.                     30350000
303600     MOVE ASC-VEH-NBR              TO ATRLRO.                     30360000
303700     MOVE ASC-ARRIVAL-DTE          TO AARRVDTO.                   30370000
303800     MOVE ASC-STATUS-CODE          TO ASTATO.                     30380000
303900     MOVE ASC-SCR-TRIP             TO ATRIPO.                     30390000
304100     MOVE ASC-SCR-SHIP-N           TO ASHIPO.                     30410000
304300                                                                  30430000
304500     IF  ASC-SCR-TRIP  >  0                                       30450000
304600         CONTINUE                                                 30460000
304700     ELSE                                                         30470000
304800         IF  VEHICL-CURR-TRIP-ID  >  0                            30480000
304900             MOVE VEHICL-CURR-TRIP-ID TO ATRIPO                   30490000
305000         END-IF                                                   30500000
305100     END-IF.                                                      30510000
305300                                                                  30530000
305400     MOVE ASC-FREIGHT-BILL         TO AFBO.                       30540000
305500     MOVE ASC-BILL-OF-LADING       TO ABOLO.                      30550000
305600     MOVE ASC-PO-NBR               TO APOO.                       30560000
305700     MOVE ASC-MANIFEST             TO AMANIFO.                    30570000
305800     MOVE ASC-PRINTER-ID           TO APRINTRO.                   30580000
306000     MOVE ASC-CAN                  TO ACANO.                      30600000
306101                                                                  30610107
306118     IF  ASC-DISP-CURR-TRIP-Y                                     30611807
306119         MOVE  PV-DISP-CURR-TRIP-HDR   TO  ADPHDRO                30611907
306120         MOVE  ASC-DISP-CURR-OPER-NBR  TO  PV-DISP-CURR-OPER-NBR  30612007
306121         MOVE  ASC-DISP-CURR-OPER-NME  TO  PV-DISP-CURR-OPER-NME  30612107
306122         MOVE  PV-DISP-CURR-OPER-LNE   TO  ADPOPRO                30612207
306130         MOVE  ASC-DISP-CURR-SCAC-NBR  TO  PV-DISP-CURR-SCAC-NBR  30613007
306131         MOVE  PV-DISP-CURR-SCAC-LNE   TO  ADPSCAO                30613107
306140         MOVE  ASC-DISP-CURR-TRLR-NBR  TO  PV-DISP-CURR-TRLR-NBR  30614007
306141         MOVE  PV-DISP-CURR-TRLR-LNE   TO  ADPTRLO                30614107
306150         MOVE  ASC-DISP-CURR-TRIP-NBR  TO  PV-DISP-CURR-TRIP-NBR  30615007
306151         MOVE  PV-DISP-CURR-TRIP-LNE   TO  ADPTRPO                30615107
306152         MOVE  ASC-DISP-CURR-STAT-CDE  TO  PV-DISP-CURR-STAT-CDE  30615214
306153         MOVE  PV-DISP-CURR-STAT-LNE   TO  ADPSTO                 30615314
306154     ELSE                                                         30615407
306160         MOVE  SPACES                  TO  ADPHDRO                30616007
306170                                           ADPOPRO                30617007
306171                                           ADPSCAO                30617107
306172                                           ADPTRLO                30617207
306173                                           ADPTRPO                30617307
306174                                           ADPSTO                 30617414
306176     END-IF.                                                      30617607
306200                                                                  30620000
306300/                                                                 30630000
306400*----------------------------------------------------------------*30640000
306500* ADD A VEHICLE                                                  *30650000
306600*----------------------------------------------------------------*30660000
306700 5000-ADD-VEHICLE.                                                30670000
306800                                                                  30680000
306900     INITIALIZE DCLTVEHICL                                        30690000
307000                DCLTVHTRIP                                        30700000
307100                DCLTTRIPST.                                       30710000
307200                                                                  30720000
307300     MOVE ASC-OWNER-SCAC-ID        TO DK-OWNER-SCAC-ID.           30730000
307400     MOVE ASC-VEH-NBR              TO DK-VEH-NBR.                 30740000
307500                                                                  30750000
307600     MOVE 'CE'                     TO VEHICL-CRT-SRC-CDE          30760000
307700                                      VHTRIP-CRT-SRC-CDE.         30770000
307800     MOVE 'RCV'                    TO VEHICL-USAGE-CDE.           30780000
307900     MOVE 'TR'                     TO VEHICL-VEH-TYP-CDE.         30790000
308000     MOVE 'EN'                     TO VEHICL-CURR-STATUS-CDE      30800000
308100                                      TRIPST-TRIP-STATUS-CDE.     30810000
308200     MOVE ASC-OPER-UNT-ID          TO VEHICL-CURR-OPER-UNT-ID     30820000
308300                                      TRIPST-OPER-UNT-ID.         30830000
308400     MOVE ASC-FCLTY-ID             TO VEHICL-CURR-FCLTY-ID        30840000
308500                                      TRIPST-FCLTY-ID.            30850000
308600     MOVE ASC-MANIFEST             TO VHTRIP-MANIFEST-NBR.        30860000
308700                                                                  30870000
308800     PERFORM 5050-GET-RANDOM-NUMBER                               30880000
308900         WITH TEST AFTER                                          30890000
309000         UNTIL PV-VHTRIP-COUNT = 0.                               30900000
309100                                                                  30910000
309200     MOVE PV-CURR-TRIP-ID          TO VEHICL-CURR-TRIP-ID         30920000
309300                                      VHTRIP-TRIP-ID              30930000
309400                                      VHTRIP-REF-TRIP-ID          30940000
309500                                      TRIPST-TRIP-ID.             30950000
309600                                                                  30960000
309700     MOVE +1                       TO DN-EST-AR-TMST.             30970000
309800                                                                  30980000
309900                                                                  30990000
310000     IF ASC-VEH-NULL-TRIP                                         31000000
310100         PERFORM 5200-UPDATE-TVEHICL                              31010000
310200     ELSE                                                         31020000
310300         PERFORM 5100-INSERT-TVEHICL                              31030000
310400     END-IF.                                                      31040000
310500                                                                  31050000
310600     IF PS-NO-ERROR                                               31060000
310700         PERFORM 5500-AUDIT-TVEHICL                               31070000
310800                                                                  31080000
310900         MOVE +1                 TO DN-VEH-NBR                    31090000
311000         PERFORM 5300-INSERT-TVHTRIP                              31100000
311100         MOVE VHTRIP-TRIP-ID   TO DK-TRIP-ID                      31110000
311200         PERFORM 5600-AUDIT-TVHTRIP                               31120000
311300         PERFORM 5400-INSERT-TTRIPST                              31130000
311400         PERFORM 5700-UP-VEH-INFO THRU 5700-EXIT                  31140000
311500                                                                  31150000
311600         MOVE 'EN'               TO ASC-STATUS-CODE               31160000
311700         MOVE ASC-STATUS-CODE    TO ASTATO                        31170000
311900         MOVE SHIPMT-CARR-AUTH-ID TO ACANO                        31190000
312100         MOVE PV-CURRENT-DATE-MM TO PV-DISPLAY-DATE-MM            31210000
312200                                    ASC-ARRIVAL-DTE-ISO-MM        31220000
312300         MOVE PV-CURRENT-DATE-DD TO PV-DISPLAY-DATE-DD            31230000
312400                                    ASC-ARRIVAL-DTE-ISO-DD        31240000
312500         MOVE PV-CURRENT-DATE-YY TO PV-DISPLAY-DATE-YY            31250000
312600                                    ASC-ARRIVAL-DTE-ISO-YY        31260000
312700         MOVE '-'                TO ASC-DASH-1                    31270000
312800                                    ASC-DASH-2                    31280000
312900         IF ASC-ARRIVAL-DTE-ISO-YY > 60                           31290000
313000             MOVE 19             TO ASC-ARRIVAL-DTE-ISO-CC        31300000
313100         ELSE                                                     31310000
313200             MOVE 20             TO ASC-ARRIVAL-DTE-ISO-CC        31320000
313300         END-IF                                                   31330000
313400         MOVE PV-DISPLAY-DATE    TO ASC-ARRIVAL-DTE               31340000
313500                                    AARRVDTO                      31350000
313600         MOVE ASC-ARRIVAL-DTE-ISO TO DK-ARRIVAL-DTE               31360000
313700     END-IF.                                                      31370000
313800     IF PS-NO-ERROR                                               31380000
313900         IF ASC-VEH-NULL-TRIP                                     31390000
314000             SET DP020-MSG-INFORMATIONAL TO TRUE                  31400000
314100             MOVE PC-TSYMSG-00059    TO DP020-MSG-NUMBER          31410000
314200         ELSE                                                     31420000
314300             SET DP020-MSG-INFORMATIONAL TO TRUE                  31430000
314400             MOVE PC-TSYMSG-00034    TO DP020-MSG-NUMBER          31440000
314500         END-IF                                                   31450000
314600     END-IF.                                                      31460000
314700                                                                  31470000
314800/                                                                 31480000
314900*----------------------------------------------------------------*31490000
315000*  GET A RANDOM NUMBER FROM THE RANDOM NUMBER GENERATOR          *31500000
315100*----------------------------------------------------------------*31510000
315200 5050-GET-RANDOM-NUMBER.                                          31520000
315300     INITIALIZE DP902-RANDNBR-ROUTINE-FIELDS.                     31530000
315400                                                                  31540000
315500     CALL PC-RANDNBR-PGM USING DFHEIBLK                           31550000
315600                               DFHCOMMAREA                        31560000
315700                               DP902-RANDNBR-ROUTINE-FIELDS.      31570000
315800                                                                  31580000
315900     IF  DP902-SUCCESSFUL                                         31590000
316000         MOVE DP902-RANDOM-NUMBER  TO PV-CURR-TRIP-ID             31600000
316100         MOVE +1                   TO DN-CURR-TRIP-ID             31610000
316200     ELSE                                                         31620000
316300         MOVE '5050-GET-RANDOM-NUMBER'                            31630000
316400                                   TO DP013-PARAGRAPH             31640000
316500         MOVE 'CALL TO DPKUT902 FAILED'                           31650000
316600                                   TO DP013-MESSAGE-TEXT(1)       31660000
316700         SET DP013-XCTL-DISPLAY-RESTART                           31670000
316800                                   TO TRUE                        31680000
316900         PERFORM DP013-0000-PROCESS-ABEND                         31690000
317000     END-IF.                                                      31700000
317100                                                                  31710000
317200     PERFORM 7600-READ-DUPL-TVHTRIP.                              31720000
317300/                                                                 31730000
317400*----------------------------------------------------------------*31740000
317500*  INSERT A ROW ON THE VEHICLE TABLE                             *31750000
317600*----------------------------------------------------------------*31760000
317700 5100-INSERT-TVEHICL.                                             31770000
317800                                                                  31780000
317900     PERFORM                                                      31790000
318000         WITH TEST AFTER                                          31800000
318100         VARYING PV-RETRY-COUNTER                                 31810000
318200         FROM 1 BY 1                                              31820000
318300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               31830000
318400             OR (SQLCODE = +0)                                    31840000
318500             OR (SQLCODE = -803))                                 31850000
318600                                                                  31860000
318700         EXEC SQL                                                 31870000
318800             INSERT  INTO TVEHICL                                 31880000
318900                    (OWNER_SCAC_ID                                31890000
319000                    ,VEH_NBR                                      31900000
319100                    ,CRT_SRC_CDE                                  31910000
319200                    ,LAST_UPD_DTE                                 31920000
319300                    ,LAST_UPD_TME                                 31930000
319400                    ,LAST_UPD_UID                                 31940000
319500                    ,USAGE_CDE                                    31950000
319600                    ,VEH_TYP_CDE                                  31960000
319700                    ,CURR_STATUS_CDE                              31970000
319800                    ,CURR_STATUS_DTE                              31980000
319900                    ,CURR_STATUS_TME                              31990000
320000                    ,CURR_OPER_UNT_ID                             32000000
320100                    ,CURR_FCLTY_ID                                32010000
320200                    ,CURR_FAC_AREA_ID                             32020000
320300                    ,CURR_LOC_DTE                                 32030000
320400                    ,CURR_LOC_TME                                 32040000
320500                    ,CURR_TRIP_ID                                 32050000
320600                    ,VEH_SIZE_CDE)                                32060000
320700            VALUES  (:DK-OWNER-SCAC-ID                            32070000
320800                    ,:DK-VEH-NBR                                  32080000
320900                    ,:VEHICL-CRT-SRC-CDE                          32090000
321000                    ,CURRENT DATE                                 32100000
321100                    ,CURRENT TIME                                 32110000
321200                    ,:DP020-USERID                                32120000
321300                    ,:VEHICL-USAGE-CDE                            32130000
321400                    ,:VEHICL-VEH-TYP-CDE                          32140000
321500                    ,:VEHICL-CURR-STATUS-CDE                      32150000
321600                    ,CURRENT DATE                                 32160000
321700                    ,CURRENT TIME                                 32170000
321800                    ,:DK-OPER-UNT-ID                              32180000
321900                    ,:DK-FCLTY-ID                                 32190000
322000                    ,:VEHICL-CURR-FAC-AREA-ID                     32200000
322100                    ,CURRENT DATE                                 32210000
322200                    ,CURRENT TIME                                 32220000
322300                    ,:VEHICL-CURR-TRIP-ID                         32230000
322400                       :DN-CURR-TRIP-ID                           32240000
322500                    ,:VEHICL-VEH-SIZE-CDE)                        32250000
322600         END-EXEC                                                 32260000
322700                                                                  32270000
322800         EVALUATE TRUE                                            32280000
322900             WHEN SQLCODE = +0                                    32290000
323000                 CONTINUE                                         32300000
323100                                                                  32310000
323200             WHEN SQLCODE = -803                                  32320000
323300                 SET PS-ERROR           TO TRUE                   32330000
323400                 SET DP020-MSG-FATAL    TO TRUE                   32340000
323500                 SET DP013-ROLLBACK     TO TRUE                   32350000
323600                 MOVE PC-TSYMSG-01020   TO DP020-MSG-NUMBER       32360000
323700                 MOVE DP015-UNP-ALP-BRT-OFF                       32370000
323800                                        TO ASCACA                 32380000
323900                                           ATRLRA                 32390000
324000                 MOVE DP015-RED         TO ASCACC                 32400000
324100                                           ATRLRC                 32410000
324200                 MOVE DP015-REVERSE     TO ASCACH                 32420000
324300                                           ATRLRH                 32430000
324400                 MOVE -1                TO ASCACL                 32440000
324500                 SET DP030-SET-CURSOR-APPL-1                      32450000
324600                                        TO TRUE                   32460000
324700                                                                  32470000
324800             WHEN SQLCODE = -904                                  32480000
324900             WHEN SQLCODE = -913                                  32490000
325000                 CONTINUE                                         32500000
325100                                                                  32510000
325200             WHEN SQLWARN0 NOT = SPACES                           32520000
325300             WHEN SQLCODE < +0                                    32530000
325400             WHEN SQLCODE > +0                                    32540000
325500                 MOVE '5100-INSERT-TVEHICL'                       32550000
325600                                   TO DP013-PARAGRAPH             32560000
325700                 MOVE 'INSERT A ROW ON TVEHICL'                   32570000
325800                                   TO DP013-MESSAGE-TEXT(1)       32580000
325900                 MOVE SQLCA        TO DP013-SQLCA                 32590000
326000                 MOVE 'TVEHICL'    TO DP013-DB2-TABLE-NAME (1)    32600000
326100                 SET DP013-DB2-ABEND                              32610000
326200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           32620000
326300                 PERFORM DP013-0000-PROCESS-ABEND                 32630000
326400         END-EVALUATE                                             32640000
326500     END-PERFORM.                                                 32650000
326600                                                                  32660000
326700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    32670000
326800         SQLCODE NOT = +0                                         32680000
326900         MOVE '5100-INSERT-TVEHICL'                               32690000
327000                                   TO DP013-PARAGRAPH             32700000
327100         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              32710000
327200                                   TO DP013-MESSAGE-TEXT (1)      32720000
327300         MOVE 'TO INSERT A TVEHICL ROW'                           32730000
327400                                   TO DP013-MESSAGE-TEXT (2)      32740000
327500         MOVE SQLCA                TO DP013-SQLCA                 32750000
327600         MOVE 'TVEHICL'            TO DP013-DB2-TABLE-NAME (1)    32760000
327700         SET DP013-DB2-ABEND                                      32770000
327800             DP013-XCTL-DISPLAY-RESTART                           32780000
327900                                   TO TRUE                        32790000
328000         PERFORM DP013-0000-PROCESS-ABEND                         32800000
328100     END-IF.                                                      32810000
328200                                                                  32820000
328300                                                                  32830000
328400/                                                                 32840000
328500*----------------------------------------------------------------*32850000
328600*  UPDATE THE LOCATION AND STATUS OF THE VEHICLE                 *32860000
328700*----------------------------------------------------------------*32870000
328800 5200-UPDATE-TVEHICL.                                             32880000
328900                                                                  32890000
329000     IF VEHICL-CURR-TRIP-ID = ZERO                                32900000
329100         MOVE -1 TO DN-CURR-TRIP-ID                               32910000
329200     ELSE                                                         32920000
329300         MOVE +1 TO DN-CURR-TRIP-ID                               32930000
329400     END-IF.                                                      32940000
329500                                                                  32950000
329600     IF VEHICL-CURR-STATUS-DTE = SPACES OR                        32960000
329700        VEHICL-CURR-STATUS-TME = SPACES                           32970000
329800         EXEC CICS ASKTIME                                        32980000
329900              ABSTIME (PV-ABSTIME)                                32990000
330000         END-EXEC                                                 33000000
330100         EXEC CICS FORMATTIME                                     33010000
330200              ABSTIME (PV-ABSTIME)                                33020000
330300              DATESEP ('-') YYMMDD  (PV-CURR-STATUS-DTE)          33030000
330400              TIME (PV-CURR-STATUS-TME) TIMESEP                   33040000
330500         END-EXEC                                                 33050000
330600         IF PV-CURR-STATUS-YY > 60                                33060000
330700             MOVE '19'   TO PV-CURR-STATUS-CC                     33070000
330800         ELSE                                                     33080000
330900             MOVE '20'   TO PV-CURR-STATUS-CC                     33090000
331000         END-IF                                                   33100000
331100         MOVE PV-CURR-STATUS-CCYYMMDD  TO                         33110000
331200                              VEHICL-CURR-STATUS-DTE              33120000
331300         MOVE PV-CURR-STATUS-TME TO                               33130000
331400                              VEHICL-CURR-STATUS-TME              33140000
331500     END-IF                                                       33150000
331600                                                                  33160000
331700     PERFORM                                                      33170000
331800         WITH TEST AFTER                                          33180000
331900         VARYING PV-RETRY-COUNTER                                 33190000
332000         FROM 1 BY 1                                              33200000
332100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               33210000
332200             OR (SQLCODE = +0))                                   33220000
332300                                                                  33230000
332400         EXEC SQL                                                 33240000
332500           UPDATE TVEHICL                                         33250000
332600              SET LAST_UPD_DTE     = CURRENT DATE                 33260000
332700                 ,LAST_UPD_TME     = CURRENT TIME                 33270000
332800                 ,LAST_UPD_UID     = :DP020-USERID                33280000
332900                 ,USAGE_CDE        = :VEHICL-USAGE-CDE            33290000
333000                 ,VEH_SIZE_CDE     = :VEHICL-VEH-SIZE-CDE         33300000
333100                 ,CURR_STATUS_DTE  = :VEHICL-CURR-STATUS-DTE      33310000
333200                 ,CURR_STATUS_TME  = :VEHICL-CURR-STATUS-TME      33320000
333300                 ,CURR_STATUS_CDE  = :VEHICL-CURR-STATUS-CDE      33330000
333400                 ,CURR_FAC_AREA_ID = :VEHICL-CURR-FAC-AREA-ID     33340000
333500                 ,CURR_OPER_UNT_ID = :VEHICL-CURR-OPER-UNT-ID     33350000
333600                 ,CURR_FCLTY_ID    = :VEHICL-CURR-FCLTY-ID        33360000
333700                 ,CURR_TRIP_ID     = :VEHICL-CURR-TRIP-ID         33370000
333800                                     :DN-CURR-TRIP-ID             33380000
333900           WHERE  VEH_NBR       = :DK-VEH-NBR                     33390000
334000             AND  OWNER_SCAC_ID = :DK-OWNER-SCAC-ID               33400000
334100         END-EXEC                                                 33410000
334200                                                                  33420000
334300         EVALUATE TRUE                                            33430000
334400             WHEN SQLCODE = +0                                    33440000
334500             WHEN SQLCODE = -904                                  33450000
334600             WHEN SQLCODE = -913                                  33460000
334700                 CONTINUE                                         33470000
334800                                                                  33480000
334900             WHEN SQLWARN0 NOT = SPACES                           33490000
335000             WHEN SQLCODE < +0                                    33500000
335100             WHEN SQLCODE > +0                                    33510000
335200                 MOVE '5200-UPDATE-TVEHICL'                       33520000
335300                                   TO DP013-PARAGRAPH             33530000
335400                 MOVE 'UPDATE CURR INFO ON TVEHICL'               33540000
335500                                   TO DP013-MESSAGE-TEXT(1)       33550000
335600                 MOVE SQLCA        TO DP013-SQLCA                 33560000
335700                 MOVE 'TVEHICL'    TO DP013-DB2-TABLE-NAME (1)    33570000
335800                 SET DP013-DB2-ABEND                              33580000
335900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           33590000
336000                 PERFORM DP013-0000-PROCESS-ABEND                 33600000
336100         END-EVALUATE                                             33610000
336200     END-PERFORM.                                                 33620000
336300                                                                  33630000
336400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    33640000
336500         SQLCODE NOT = +0                                         33650000
336600         MOVE '5200-UPDATE-TVEHICL'                               33660000
336700                                   TO DP013-PARAGRAPH             33670000
336800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              33680000
336900                                   TO DP013-MESSAGE-TEXT (1)      33690000
337000         MOVE 'TO UPDATE A TVEHICL ROW'                           33700000
337100                                   TO DP013-MESSAGE-TEXT (2)      33710000
337200         MOVE SQLCA                TO DP013-SQLCA                 33720000
337300         MOVE 'TVEHICL'            TO DP013-DB2-TABLE-NAME (1)    33730000
337400         SET DP013-DB2-ABEND                                      33740000
337500             DP013-XCTL-DISPLAY-RESTART                           33750000
337600                                   TO TRUE                        33760000
337700         PERFORM DP013-0000-PROCESS-ABEND                         33770000
337800     END-IF.                                                      33780000
337900                                                                  33790000
338000                                                                  33800000
338100/                                                                 33810000
338200*----------------------------------------------------------------*33820000
338300*  INSERT A ROW ON THE VEHICLE TRIP TABLE                        *33830000
338400*----------------------------------------------------------------*33840000
338500 5300-INSERT-TVHTRIP.                                             33850000
338600                                                                  33860000
338700     PERFORM                                                      33870000
338800         WITH TEST AFTER                                          33880000
338900         VARYING PV-RETRY-COUNTER                                 33890000
339000         FROM 1 BY 1                                              33900000
339100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               33910000
339200             OR (SQLCODE = +0))                                   33920000
339300                                                                  33930000
339400         EXEC SQL                                                 33940000
339500             INSERT  INTO TVHTRIP                                 33950000
339600                    (OWNER_SCAC_ID                                33960000
339700                    ,VEH_NBR                                      33970000
339800                    ,TRIP_ID                                      33980000
339900                    ,TRIP_BEG_DTE                                 33990000
340000                    ,TRIP_BEG_TME                                 34000000
340100                    ,CRT_SRC_CDE                                  34010000
340200                    ,LAST_UPD_DTE                                 34020000
340300                    ,LAST_UPD_TME                                 34030000
340400                    ,LAST_UPD_UID                                 34040000
340500                    ,MANIFEST_NBR                                 34050000
340600                    ,PLND_TRIP_SEQ                                34060000
340700                    ,REF_TRIP_ID                                  34070000
340800                    ,EST_AR_TMST                                  34080000
340900                    ,SPLT_XMIT_IND                                34090000
341000                    ,SPLT_XMIT_DTE                                34100000
341100                    ,SPLT_XMIT_TM )                               34110000
341200            VALUES  (:DK-OWNER-SCAC-ID                            34120000
341300                    ,:DK-VEH-NBR                                  34130000
341400                       :DN-VEH-NBR                                34140000
341500                    ,:VHTRIP-TRIP-ID                              34150000
341600                    ,CURRENT DATE                                 34160000
341700                    ,CURRENT TIME                                 34170000
341800                    ,:VHTRIP-CRT-SRC-CDE                          34180000
341900                    ,CURRENT DATE                                 34190000
342000                    ,CURRENT TIME                                 34200000
342100                    ,:DP020-USERID                                34210000
342200                    ,:VHTRIP-MANIFEST-NBR                         34220000
342300                    ,:VHTRIP-PLND-TRIP-SEQ                        34230000
342400                    ,:VHTRIP-REF-TRIP-ID                          34240000
342500                    ,CURRENT TIMESTAMP                            34250000
342600                    ,:VHTRIP-SPLT-XMIT-IND                        34260000
342700                    ,:PC-DEFAULT-DATE                             34270000
342800                    ,:PC-DEFAULT-TIME )                           34280000
342900         END-EXEC                                                 34290000
343000                                                                  34300000
343100         EVALUATE TRUE                                            34310000
343200             WHEN SQLCODE = +0                                    34320000
343300             WHEN SQLCODE = -904                                  34330000
343400             WHEN SQLCODE = -913                                  34340000
343500                 CONTINUE                                         34350000
343600                                                                  34360000
343700             WHEN SQLWARN0 NOT = SPACES                           34370000
343800             WHEN SQLCODE < +0                                    34380000
343900             WHEN SQLCODE > +0                                    34390000
344000                 MOVE '5300-INSERT-TVHTRIP'                       34400000
344100                                   TO DP013-PARAGRAPH             34410000
344200                 MOVE 'INSERT A ROW ON TVHTRIP'                   34420000
344300                                   TO DP013-MESSAGE-TEXT(1)       34430000
344400                 MOVE SQLCA        TO DP013-SQLCA                 34440000
344500                 MOVE 'TVHTRIP'    TO DP013-DB2-TABLE-NAME (1)    34450000
344600                 SET DP013-DB2-ABEND                              34460000
344700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           34470000
344800                 PERFORM DP013-0000-PROCESS-ABEND                 34480000
344900         END-EVALUATE                                             34490000
345000     END-PERFORM.                                                 34500000
345100                                                                  34510000
345200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    34520000
345300         SQLCODE NOT = +0                                         34530000
345400         MOVE '5300-INSERT-TVHTRIP'                               34540000
345500                                   TO DP013-PARAGRAPH             34550000
345600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              34560000
345700                                   TO DP013-MESSAGE-TEXT (1)      34570000
345800         MOVE 'TO INSERT A TVHTRIP ROW'                           34580000
345900                                   TO DP013-MESSAGE-TEXT (2)      34590000
346000         MOVE SQLCA                TO DP013-SQLCA                 34600000
346100         MOVE 'TVHTRIP'            TO DP013-DB2-TABLE-NAME (1)    34610000
346200         SET DP013-DB2-ABEND                                      34620000
346300             DP013-XCTL-DISPLAY-RESTART                           34630000
346400                                   TO TRUE                        34640000
346500         PERFORM DP013-0000-PROCESS-ABEND                         34650000
346600     END-IF.                                                      34660000
346700                                                                  34670000
346800/                                                                 34680000
346900*----------------------------------------------------------------*34690000
347000*  INSERT A ROW ON THE VEHICLE TRIP STATUS TABLE                 *34700000
347100*----------------------------------------------------------------*34710000
347200 5400-INSERT-TTRIPST.                                             34720000
347300                                                                  34730000
347400     PERFORM                                                      34740000
347500         WITH TEST AFTER                                          34750000
347600         VARYING PV-RETRY-COUNTER                                 34760000
347700         FROM 1 BY 1                                              34770000
347800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               34780000
347900             OR (SQLCODE = +0))                                   34790000
348000                                                                  34800000
348100         EXEC SQL                                                 34810000
348200             INSERT  INTO TTRIPST                                 34820000
348300                    (TRIP_ID                                      34830000
348400                    ,TRIP_STATUS_CDE                              34840000
348500                    ,STATUS_DTE                                   34850000
348600                    ,STATUS_TME                                   34860000
348700                    ,STATUS_UID                                   34870000
348800                    ,OPER_UNT_ID                                  34880000
348900                    ,FCLTY_ID                                     34890000
349000                    ,FCLTY_AREA_ID)                               34900000
349100            VALUES  (:TRIPST-TRIP-ID                              34910000
349200                    ,:TRIPST-TRIP-STATUS-CDE                      34920000
349300                    ,CURRENT DATE                                 34930000
349400                    ,CURRENT TIME                                 34940000
349500                    ,:DP020-USERID                                34950000
349600                    ,:TRIPST-OPER-UNT-ID                          34960000
349700                    ,:TRIPST-FCLTY-ID                             34970000
349800                    ,:TRIPST-FCLTY-AREA-ID)                       34980000
349900         END-EXEC                                                 34990000
350000                                                                  35000000
350100         EVALUATE TRUE                                            35010000
350200             WHEN SQLCODE = +0                                    35020000
350300                 CONTINUE                                         35030000
350400             WHEN SQLCODE = -904                                  35040000
350500             WHEN SQLCODE = -913                                  35050000
350600                 CONTINUE                                         35060000
350700                                                                  35070000
350800             WHEN SQLWARN0 NOT = SPACES                           35080000
350900             WHEN SQLCODE < +0                                    35090000
351000             WHEN SQLCODE > +0                                    35100000
351100                 MOVE '5400-INSERT-TTRIPST'                       35110000
351200                                   TO DP013-PARAGRAPH             35120000
351300                 MOVE 'INSERT A ROW ON TTRIPST'                   35130000
351400                                   TO DP013-MESSAGE-TEXT(1)       35140000
351500                 MOVE SQLCA        TO DP013-SQLCA                 35150000
351600                 MOVE 'TTRIPST'    TO DP013-DB2-TABLE-NAME (1)    35160000
351700                 SET DP013-DB2-ABEND                              35170000
351800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           35180000
351900                 PERFORM DP013-0000-PROCESS-ABEND                 35190000
352000         END-EVALUATE                                             35200000
352100     END-PERFORM.                                                 35210000
352200                                                                  35220000
352300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    35230000
352400         SQLCODE NOT = +0                                         35240000
352500         MOVE '5400-INSERT-TTRIPST'                               35250000
352600                                   TO DP013-PARAGRAPH             35260000
352700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              35270000
352800                                   TO DP013-MESSAGE-TEXT (1)      35280000
352900         MOVE 'TO INSERT A TTRIPST ROW'                           35290000
353000                                   TO DP013-MESSAGE-TEXT (2)      35300000
353100         MOVE SQLCA                TO DP013-SQLCA                 35310000
353200         MOVE 'TTRIPST'            TO DP013-DB2-TABLE-NAME (1)    35320000
353300         SET DP013-DB2-ABEND                                      35330000
353400             DP013-XCTL-DISPLAY-RESTART                           35340000
353500                                   TO TRUE                        35350000
353600         PERFORM DP013-0000-PROCESS-ABEND                         35360000
353700     END-IF.                                                      35370000
353800                                                                  35380000
353900/                                                                 35390000
354000*----------------------------------------------------------------*35400000
354100*  TAKE A SNAPSHOT OF THE AFTER  IMAGE OF TVEHICL AND WRITE      *35410000
354200*  TO THE AUDIT TABLE.                                           *35420000
354300*----------------------------------------------------------------*35430000
354400 5500-AUDIT-TVEHICL.                                              35440000
354500                                                                  35450000
354600     INITIALIZE DCLTAUVHCL.                                       35460000
354700                                                                  35470000
354800     PERFORM                                                      35480000
354900         WITH TEST AFTER                                          35490000
355000         VARYING PV-RETRY-COUNTER                                 35500000
355100         FROM 1 BY 1                                              35510000
355200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               35520000
355300             OR (SQLCODE = +0))                                   35530000
355400                                                                  35540000
355500         EXEC SQL                                                 35550000
355600             SELECT  A.OWNER_SCAC_ID                              35560000
355700                    ,A.VEH_NBR                                    35570000
355800                    ,A.CRT_SRC_CDE                                35580000
355900                    ,A.LAST_UPD_DTE                               35590000
356000                    ,A.LAST_UPD_TME                               35600000
356100                    ,A.LAST_UPD_UID                               35610000
356200                    ,A.USAGE_CDE                                  35620000
356300                    ,A.VEH_TYP_CDE                                35630000
356400                    ,A.CURR_STATUS_CDE                            35640000
356500                    ,A.CURR_STATUS_DTE                            35650000
356600                    ,A.CURR_STATUS_TME                            35660000
356700                    ,A.CURR_OPER_UNT_ID                           35670000
356800                    ,A.CURR_FCLTY_ID                              35680000
356900                    ,A.CURR_FAC_AREA_ID                           35690000
357000                    ,A.CURR_LOC_DTE                               35700000
357100                    ,A.CURR_LOC_TME                               35710000
357200                    ,A.CURR_TRIP_ID                               35720000
357300                    ,A.VEH_SIZE_CDE                               35730000
357400            INTO     :VEHICL-OWNER-SCAC-ID                        35740000
357500                    ,:VEHICL-VEH-NBR                              35750000
357600                    ,:VEHICL-CRT-SRC-CDE                          35760000
357700                    ,:VEHICL-LAST-UPD-DTE                         35770000
357800                    ,:VEHICL-LAST-UPD-TME                         35780000
357900                    ,:VEHICL-LAST-UPD-UID                         35790000
358000                    ,:VEHICL-USAGE-CDE                            35800000
358100                    ,:VEHICL-VEH-TYP-CDE                          35810000
358200                    ,:VEHICL-CURR-STATUS-CDE                      35820000
358300                    ,:VEHICL-CURR-STATUS-DTE                      35830000
358400                    ,:VEHICL-CURR-STATUS-TME                      35840000
358500                    ,:VEHICL-CURR-OPER-UNT-ID                     35850000
358600                    ,:VEHICL-CURR-FCLTY-ID                        35860000
358700                    ,:VEHICL-CURR-FAC-AREA-ID                     35870000
358800                    ,:VEHICL-CURR-LOC-DTE                         35880000
358900                    ,:VEHICL-CURR-LOC-TME                         35890000
359000                    ,:VEHICL-CURR-TRIP-ID                         35900000
359100                       :DN-CURR-TRIP-ID                           35910000
359200                    ,:VEHICL-VEH-SIZE-CDE                         35920000
359300           FROM   TVEHICL A                                       35930000
359400           WHERE  A.VEH_NBR       = :DK-VEH-NBR                   35940000
359500             AND  A.OWNER_SCAC_ID = :DK-OWNER-SCAC-ID             35950000
359600         END-EXEC                                                 35960000
359700                                                                  35970000
359800         EVALUATE TRUE                                            35980000
359900             WHEN SQLCODE = +0                                    35990000
360000             WHEN SQLCODE = -904                                  36000000
360100             WHEN SQLCODE = -913                                  36010000
360200                 CONTINUE                                         36020000
360300                                                                  36030000
360400             WHEN SQLWARN0 NOT = SPACES                           36040000
360500             WHEN SQLCODE < +0                                    36050000
360600             WHEN SQLCODE > +0                                    36060000
360700                 MOVE '5500-AUDIT-TVEHICL'                        36070000
360800                                   TO DP013-PARAGRAPH             36080000
360900                 MOVE 'SELECT A TVEHICL ROW   '                   36090000
361000                                   TO DP013-MESSAGE-TEXT(1)       36100000
361100                 MOVE SQLCA        TO DP013-SQLCA                 36110000
361200                 MOVE 'TVEHICL'    TO DP013-DB2-TABLE-NAME (1)    36120000
361300                 SET DP013-DB2-ABEND                              36130000
361400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           36140000
361500                 PERFORM DP013-0000-PROCESS-ABEND                 36150000
361600         END-EVALUATE                                             36160000
361700     END-PERFORM.                                                 36170000
361800                                                                  36180000
361900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    36190000
362000         SQLCODE NOT = +0                                         36200000
362100         MOVE '5500-AUDIT-TVEHICL '                               36210000
362200                                   TO DP013-PARAGRAPH             36220000
362300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              36230000
362400                                   TO DP013-MESSAGE-TEXT (1)      36240000
362500         MOVE 'TO SELECT A TVEHICL ROW'                           36250000
362600                                   TO DP013-MESSAGE-TEXT (2)      36260000
362700         MOVE SQLCA                TO DP013-SQLCA                 36270000
362800         MOVE 'TVEHICL'            TO DP013-DB2-TABLE-NAME (1)    36280000
362900         SET DP013-DB2-ABEND                                      36290000
363000             DP013-XCTL-DISPLAY-RESTART                           36300000
363100                                   TO TRUE                        36310000
363200         PERFORM DP013-0000-PROCESS-ABEND                         36320000
363300     END-IF.                                                      36330000
363400                                                                  36340000
363500                                                                  36350000
363600     PERFORM                                                      36360000
363700         WITH TEST AFTER                                          36370000
363800         VARYING PV-RETRY-COUNTER                                 36380000
363900         FROM 1 BY 1                                              36390000
364000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               36400000
364100             OR (SQLCODE = +0))                                   36410000
364200                                                                  36420000
364300         EXEC SQL                                                 36430000
364400             INSERT  INTO TAUVHCL                                 36440000
364500                    (OWNER_SCAC_ID                                36450000
364600                    ,VEH_NBR                                      36460000
364700                    ,CRT_SRC_CDE                                  36470000
364800                    ,LAST_UPD_DTE                                 36480000
364900                    ,LAST_UPD_TME                                 36490000
365000                    ,LAST_UPD_UID                                 36500000
365100                    ,USAGE_CDE                                    36510000
365200                    ,VEH_TYP_CDE                                  36520000
365300                    ,CURR_STATUS_CDE                              36530000
365400                    ,CURR_STATUS_DTE                              36540000
365500                    ,CURR_STATUS_TME                              36550000
365600                    ,CURR_OPER_UNT_ID                             36560000
365700                    ,CURR_FCLTY_ID                                36570000
365800                    ,CURR_FAC_AREA_ID                             36580000
365900                    ,CURR_LOC_DTE                                 36590000
366000                    ,CURR_LOC_TME                                 36600000
366100                    ,CURR_TRIP_ID                                 36610000
366200                    ,VEH_SIZE_CDE)                                36620000
366300            VALUES  (:VEHICL-OWNER-SCAC-ID                        36630000
366400                    ,:VEHICL-VEH-NBR                              36640000
366500                    ,:VEHICL-CRT-SRC-CDE                          36650000
366600                    ,:VEHICL-LAST-UPD-DTE                         36660000
366700                    ,:VEHICL-LAST-UPD-TME                         36670000
366800                    ,:VEHICL-LAST-UPD-UID                         36680000
366900                    ,:VEHICL-USAGE-CDE                            36690000
367000                    ,:VEHICL-VEH-TYP-CDE                          36700000
367100                    ,:VEHICL-CURR-STATUS-CDE                      36710000
367200                    ,:VEHICL-CURR-STATUS-DTE                      36720000
367300                    ,:VEHICL-CURR-STATUS-TME                      36730000
367400                    ,:VEHICL-CURR-OPER-UNT-ID                     36740000
367500                    ,:VEHICL-CURR-FCLTY-ID                        36750000
367600                    ,:VEHICL-CURR-FAC-AREA-ID                     36760000
367700                    ,:VEHICL-CURR-LOC-DTE                         36770000
367800                    ,:VEHICL-CURR-LOC-TME                         36780000
367900                    ,:VEHICL-CURR-TRIP-ID                         36790000
368000                       :DN-CURR-TRIP-ID                           36800000
368100                    ,:VEHICL-VEH-SIZE-CDE)                        36810000
368200         END-EXEC                                                 36820000
368300                                                                  36830000
368400         EVALUATE TRUE                                            36840000
368500             WHEN SQLCODE = +0                                    36850000
368600             WHEN SQLCODE = -904                                  36860000
368700             WHEN SQLCODE = -913                                  36870000
368800                 CONTINUE                                         36880000
368900                                                                  36890000
369000             WHEN SQLWARN0 NOT = SPACES                           36900000
369100             WHEN SQLCODE < +0                                    36910000
369200             WHEN SQLCODE > +0                                    36920000
369300                 MOVE '5500-AUDIT-TVEHICL '                       36930000
369400                                   TO DP013-PARAGRAPH             36940000
369500                 MOVE 'INSERT A ROW ON TAUVHCL'                   36950000
369600                                   TO DP013-MESSAGE-TEXT(1)       36960000
369700                 MOVE SQLCA        TO DP013-SQLCA                 36970000
369800                 MOVE 'TAUVHCL'    TO DP013-DB2-TABLE-NAME (1)    36980000
369900                 SET DP013-DB2-ABEND                              36990000
370000                     DP013-XCTL-DISPLAY-RESTART TO TRUE           37000000
370100                 PERFORM DP013-0000-PROCESS-ABEND                 37010000
370200         END-EVALUATE                                             37020000
370300     END-PERFORM.                                                 37030000
370400                                                                  37040000
370500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    37050000
370600         SQLCODE NOT = +0                                         37060000
370700         MOVE '5500-AUDIT-TAUVHCL'                                37070000
370800                                   TO DP013-PARAGRAPH             37080000
370900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              37090000
371000                                   TO DP013-MESSAGE-TEXT (1)      37100000
371100         MOVE 'TO INSERT A TAUVHCL ROW'                           37110000
371200                                   TO DP013-MESSAGE-TEXT (2)      37120000
371300         MOVE SQLCA                TO DP013-SQLCA                 37130000
371400         MOVE 'TAUVHCL'            TO DP013-DB2-TABLE-NAME (1)    37140000
371500         SET DP013-DB2-ABEND                                      37150000
371600             DP013-XCTL-DISPLAY-RESTART                           37160000
371700                                   TO TRUE                        37170000
371800         PERFORM DP013-0000-PROCESS-ABEND                         37180000
371900     END-IF.                                                      37190000
372000                                                                  37200000
372100/                                                                 37210000
372200*----------------------------------------------------------------*37220000
372300*  TAKE A SNAPSHOT OF THE AFTER  IMAGE OF TVHTRIP AND WRITE      *37230000
372400*  TO THE AUDIT TABLE.                                           *37240000
372500*----------------------------------------------------------------*37250000
372600 5600-AUDIT-TVHTRIP.                                              37260000
372700                                                                  37270000
372800     INITIALIZE DCLTAUTRIP.                                       37280000
372900                                                                  37290000
373000     PERFORM                                                      37300000
373100         WITH TEST AFTER                                          37310000
373200         VARYING PV-RETRY-COUNTER                                 37320000
373300         FROM 1 BY 1                                              37330000
373400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               37340000
373500             OR (SQLCODE = +0))                                   37350000
373600                                                                  37360000
373700         EXEC SQL                                                 37370000
373800             SELECT  OWNER_SCAC_ID                                37380000
373900                    ,VEH_NBR                                      37390000
374000                    ,TRIP_ID                                      37400000
374100                    ,TRIP_BEG_DTE                                 37410000
374200                    ,TRIP_BEG_TME                                 37420000
374300                    ,CRT_SRC_CDE                                  37430000
374400                    ,LAST_UPD_DTE                                 37440000
374500                    ,LAST_UPD_TME                                 37450000
374600                    ,LAST_UPD_UID                                 37460000
374700                    ,MANIFEST_NBR                                 37470000
374800                    ,PLND_TRIP_SEQ                                37480000
374900                    ,PLND_ACTVY_CDE                               37490000
375000                    ,OWNR_SCAC_SHIP_DTE                           37500000
375100                    ,REF_TRIP_ID                                  37510000
375200                    ,EST_AR_TMST                                  37520000
375300                    ,SPLT_XMIT_IND                                37530000
375400                    ,SPLT_XMIT_DTE                                37540000
375500                    ,SPLT_XMIT_TM                                 37550000
375600            INTO     :VHTRIP-OWNER-SCAC-ID                        37560000
375700                    ,:VHTRIP-VEH-NBR                              37570000
375800                       :DN-VEH-NBR                                37580000
375900                    ,:VHTRIP-TRIP-ID                              37590000
376000                    ,:VHTRIP-TRIP-BEG-DTE                         37600000
376100                    ,:VHTRIP-TRIP-BEG-TME                         37610000
376200                    ,:VHTRIP-CRT-SRC-CDE                          37620000
376300                    ,:VHTRIP-LAST-UPD-DTE                         37630000
376400                    ,:VHTRIP-LAST-UPD-TME                         37640000
376500                    ,:VHTRIP-LAST-UPD-UID                         37650000
376600                    ,:VHTRIP-MANIFEST-NBR                         37660000
376700                    ,:VHTRIP-PLND-TRIP-SEQ                        37670000
376800                    ,:VHTRIP-PLND-ACTVY-CDE                       37680000
376900                    ,:VHTRIP-OWNR-SCAC-SHIP-DTE                   37690000
377000                    ,:VHTRIP-REF-TRIP-ID                          37700000
377100                    ,:VHTRIP-EST-AR-TMST                          37710000
377200                           :DN-EST-AR-TMST                        37720000
377300                    ,:VHTRIP-SPLT-XMIT-IND                        37730000
377400                    ,:VHTRIP-SPLT-XMIT-DTE                        37740000
377500                    ,:VHTRIP-SPLT-XMIT-TM                         37750000
377600           FROM   TVHTRIP                                         37760000
377700           WHERE  OWNER_SCAC_ID = :DK-OWNER-SCAC-ID               37770000
377800             AND  VEH_NBR       IS NOT NULL                       37780000
377900             AND  VEH_NBR       = :DK-VEH-NBR                     37790000
378000             AND  TRIP_ID       = :DK-TRIP-ID                     37800000
378100         END-EXEC                                                 37810000
378200                                                                  37820000
378300         EVALUATE TRUE                                            37830000
378400             WHEN SQLCODE = +0                                    37840000
378500             WHEN SQLCODE = -904                                  37850000
378600             WHEN SQLCODE = -913                                  37860000
378700                 CONTINUE                                         37870000
378800                                                                  37880000
378900             WHEN SQLWARN0 NOT = SPACES                           37890000
379000             WHEN SQLCODE < +0                                    37900000
379100             WHEN SQLCODE > +0                                    37910000
379200                 MOVE '5600-AUDIT-TVHTRIP'                        37920000
379300                                   TO DP013-PARAGRAPH             37930000
379400                 MOVE 'SELECT A ROW ON TVHTRIP'                   37940000
379500                                   TO DP013-MESSAGE-TEXT(1)       37950000
379600                 MOVE SQLCA        TO DP013-SQLCA                 37960000
379700                 MOVE 'TVHTRIP'    TO DP013-DB2-TABLE-NAME (1)    37970000
379800                 SET DP013-DB2-ABEND                              37980000
379900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           37990000
380000                 PERFORM DP013-0000-PROCESS-ABEND                 38000000
380100         END-EVALUATE                                             38010000
380200     END-PERFORM.                                                 38020000
380300                                                                  38030000
380400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    38040000
380500         SQLCODE NOT = +0                                         38050000
380600         MOVE '5600-AUDIT-TVHTRIP'                                38060000
380700                                   TO DP013-PARAGRAPH             38070000
380800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              38080000
380900                                   TO DP013-MESSAGE-TEXT (1)      38090000
381000         MOVE 'TO SELECT A TVHTRIP ROW'                           38100000
381100                                   TO DP013-MESSAGE-TEXT (2)      38110000
381200         MOVE SQLCA                TO DP013-SQLCA                 38120000
381300         MOVE 'TVHTRIP'            TO DP013-DB2-TABLE-NAME (1)    38130000
381400         SET DP013-DB2-ABEND                                      38140000
381500             DP013-XCTL-DISPLAY-RESTART                           38150000
381600                                   TO TRUE                        38160000
381700         PERFORM DP013-0000-PROCESS-ABEND                         38170000
381800     END-IF.                                                      38180000
381900                                                                  38190000
382000     MOVE 'CE'                     TO VHTRIP-CRT-SRC-CDE.         38200000
382100                                                                  38210000
382200     PERFORM                                                      38220000
382300         WITH TEST AFTER                                          38230000
382400         VARYING PV-RETRY-COUNTER                                 38240000
382500         FROM 1 BY 1                                              38250000
382600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               38260000
382700             OR (SQLCODE = +0))                                   38270000
382800                                                                  38280000
382900         EXEC SQL                                                 38290000
383000             INSERT  INTO TAUTRIP                                 38300000
383100                    (OWNER_SCAC_ID                                38310000
383200                    ,VEH_NBR                                      38320000
383300                    ,TRIP_ID                                      38330000
383400                    ,TRIP_BEG_DTE                                 38340000
383500                    ,TRIP_BEG_TME                                 38350000
383600                    ,CRT_SRC_CDE                                  38360000
383700                    ,LAST_UPD_DTE                                 38370000
383800                    ,LAST_UPD_TME                                 38380000
383900                    ,LAST_UPD_UID                                 38390000
384000                    ,MANIFEST_NBR                                 38400000
384100                    ,PLND_TRIP_SEQ                                38410000
384200                    ,PLND_ACTVY_CDE                               38420000
384300                    ,OWNR_SCAC_SHIP_DTE                           38430000
384400                    ,REF_TRIP_ID                                  38440000
384500                    ,EST_AR_TMST                                  38450000
384600                    ,AUD_STATUS_CDE                               38460000
384700                    ,SPLT_XMIT_IND                                38470000
384800                    ,SPLT_XMIT_DTE                                38480000
384900                    ,SPLT_XMIT_TM )                               38490000
385000            VALUES  (:VHTRIP-OWNER-SCAC-ID                        38500000
385100                    ,:VHTRIP-VEH-NBR                              38510000
385200                       :DN-VEH-NBR                                38520000
385300                    ,:VHTRIP-TRIP-ID                              38530000
385400                    ,:VHTRIP-TRIP-BEG-DTE                         38540000
385500                    ,:VHTRIP-TRIP-BEG-TME                         38550000
385600                    ,:VHTRIP-CRT-SRC-CDE                          38560000
385700                    ,:VHTRIP-LAST-UPD-DTE                         38570000
385800                    ,:VHTRIP-LAST-UPD-TME                         38580000
385900                    ,:VHTRIP-LAST-UPD-UID                         38590000
386000                    ,:VHTRIP-MANIFEST-NBR                         38600000
386100                    ,:VHTRIP-PLND-TRIP-SEQ                        38610000
386200                    ,:VHTRIP-PLND-ACTVY-CDE                       38620000
386300                    ,:VHTRIP-OWNR-SCAC-SHIP-DTE                   38630000
386400                    ,:VHTRIP-REF-TRIP-ID                          38640000
386500                    ,:VHTRIP-EST-AR-TMST                          38650000
386600                           :DN-EST-AR-TMST                        38660000
386700                    ,:TRIPST-TRIP-STATUS-CDE                      38670000
386800                    ,:VHTRIP-SPLT-XMIT-IND                        38680000
386900                    ,:VHTRIP-SPLT-XMIT-DTE                        38690000
387000                    ,:VHTRIP-SPLT-XMIT-TM )                       38700000
387100         END-EXEC                                                 38710000
387200                                                                  38720000
387300         EVALUATE TRUE                                            38730000
387400             WHEN SQLCODE = +0                                    38740000
387500             WHEN SQLCODE = -904                                  38750000
387600             WHEN SQLCODE = -913                                  38760000
387700                 CONTINUE                                         38770000
387800                                                                  38780000
387900             WHEN SQLWARN0 NOT = SPACES                           38790000
388000             WHEN SQLCODE < +0                                    38800000
388100             WHEN SQLCODE > +0                                    38810000
388200                 MOVE '5600-AUDIT-TVHTRIP'                        38820000
388300                                   TO DP013-PARAGRAPH             38830000
388400                 MOVE 'INSERT A ROW ON TAUTRIP'                   38840000
388500                                   TO DP013-MESSAGE-TEXT(1)       38850000
388600                 MOVE SQLCA        TO DP013-SQLCA                 38860000
388700                 MOVE 'TAUTRIP'    TO DP013-DB2-TABLE-NAME (1)    38870000
388800                 SET DP013-DB2-ABEND                              38880000
388900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           38890000
389000                 PERFORM DP013-0000-PROCESS-ABEND                 38900000
389100         END-EVALUATE                                             38910000
389200     END-PERFORM.                                                 38920000
389300                                                                  38930000
389400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    38940000
389500         SQLCODE NOT = +0                                         38950000
389600         MOVE '5600-AUDIT-TVHTRIP'                                38960000
389700                                   TO DP013-PARAGRAPH             38970000
389800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              38980000
389900                                   TO DP013-MESSAGE-TEXT (1)      38990000
390000         MOVE 'TO INSERT A TAUTRIP ROW'                           39000000
390100                                   TO DP013-MESSAGE-TEXT (2)      39010000
390200         MOVE SQLCA                TO DP013-SQLCA                 39020000
390300         MOVE 'TAUTRIP'            TO DP013-DB2-TABLE-NAME (1)    39030000
390400         SET DP013-DB2-ABEND                                      39040000
390500             DP013-XCTL-DISPLAY-RESTART                           39050000
390600                                   TO TRUE                        39060000
390700         PERFORM DP013-0000-PROCESS-ABEND                         39070000
390800     END-IF.                                                      39080000
390900                                                                  39090000
391000/                                                                 39100000
391100 5700-UP-VEH-INFO.                                                39110000
391200                                                                  39120000
391300     PERFORM 5710-GET-PARM-DATE.                                  39130000
391400                                                                  39140000
391500     EXEC SQL                                                     39150000
391600       UPDATE SUT_TRLR_RPLN_CART                                  39160000
391700          SET LAST_UPD_TMST    = CURRENT TIMESTAMP                39170000
391800             ,LAST_UPD_USR_ID  = :DP020-USERID                    39180000
391900             ,INBND_TRIP_ID    = :PV-CURR-TRIP-ID                 39190000
392000        WHERE  VEH_NBR         = :DK-VEH-NBR                      39200000
392100          AND  OPER_UNT_ID     = :DK-OPER-UNT-ID                  39210000
392200          AND  SCAC_CDE        = :DK-OWNER-SCAC-ID                39220000
392300          AND  INBND_TRIP_ID   = 0                                39230000
392400          AND  DATE(CRE_TMST) >= :PV-SELECT-DATE                  39240000
392500     END-EXEC.                                                    39250000
392600                                                                  39260000
392700     EVALUATE TRUE                                                39270000
392800         WHEN SQLCODE = +0                                        39280000
392900         WHEN SQLCODE = +100                                      39290000
393000             CONTINUE                                             39300000
393100         WHEN SQLCODE = -904                                      39310000
393200         WHEN SQLCODE = -911                                      39320000
393300         WHEN SQLCODE = -913                                      39330000
393400             MOVE SQLCODE            TO PV-SQL-RETURN-CD          39340000
393500             MOVE PC-TSYMSG-00984    TO DP020-MSG-NUMBER          39350000
393600             STRING   ' RCKCS224 - 5700-UP-VEH-INFO'              39360000
393700                      '| UPDATE SUT_TRLR_RPLN_CART'               39370000
393800                      '| SQLCODE = '     PV-SQL-RETURN-CD         39380000
393900                      DELIMITED BY SIZE                           39390000
394000                                   INTO PV-CICS-MSG-AREA          39400000
394100             PERFORM 9903-WRITE-CICS-LOG                          39410000
394200             PERFORM 9900-SOFT-ABORT                              39420000
394300                                                                  39430000
394400         WHEN SQLWARN0 NOT = SPACES                               39440000
394500         WHEN SQLCODE < +0                                        39450000
394600         WHEN SQLCODE > +0                                        39460000
395700             MOVE PV-CURR-TRIP-ID    TO PV-DISP-TRIP-ID           39570000
395800             MOVE DK-OPER-UNT-ID     TO PV-DISP-OPER-ID           39580000
395900             MOVE SQLCODE            TO PV-SQL-RETURN-CD          39590000
396000             MOVE PC-TSYMSG-01570    TO DP020-MSG-NUMBER          39600000
396100             STRING   ' RCKCS224 - 5700-UP-VEH-INFO'              39610000
396200                      '| UPDATE SUT_TRLR_RPLN_CART'               39620000
396300                      '| SQLCODE = '    PV-SQL-RETURN-CD          39630000
396400                      DELIMITED BY SIZE                           39640000
396500                                   INTO PV-CICS-MSG-AREA          39650000
396600             PERFORM 9903-WRITE-CICS-LOG                          39660000
396700             STRING   '  OPER UNT: ' PV-DISP-OPER-ID              39670000
396800                      '| USER ID : ' DP020-USERID                 39680000
396900                        DELIMITED BY SIZE                         39690000
397000                                   INTO PV-CICS-MSG-AREA          39700000
397100             PERFORM 9903-WRITE-CICS-LOG                          39710000
397200             STRING   '  TRIP ID : ' PV-DISP-TRIP-ID              39720000
397300                      '| VEH NBR : ' DK-VEH-NBR                   39730000
397400                      '| SCAC ID : ' DK-OWNER-SCAC-ID             39740000
397500                        DELIMITED BY SIZE                         39750000
397600                                   INTO PV-CICS-MSG-AREA          39760000
397700             PERFORM 9903-WRITE-CICS-LOG                          39770000
397800             PERFORM 9900-SOFT-ABORT                              39780000
397900         END-EVALUATE.                                            39790000
398000                                                                  39800000
398100 5700-EXIT.                                                       39810000
398200     EXIT.                                                        39820000
398300                                                                  39830000
398400 5710-GET-PARM-DATE.                                              39840000
398500                                                                  39850000
398600      EXEC SQL                                                    39860000
398700         SELECT CURRENT DATE - FUNC_QTY DAYS                      39870000
398800           INTO :PV-SELECT-DATE                                   39880000
398900           FROM TKRPRPM                                           39890000
399000         WHERE LOC_ID             = 90                            39900000
399100            AND INTFC_SYS_CDE     = 'KHL'                         39910000
399200            AND SYS_PRC_FUNC_CDE  = 'PTCASG'                      39920000
399300            AND FUNC_PRC_STAT_CDE = 'AC'                          39930000
399400            WITH UR                                               39940000
399500      END-EXEC.                                                   39950000
399600                                                                  39960000
399700      EVALUATE TRUE                                               39970000
399800          WHEN SQLCODE = 0                                        39980000
399900               CONTINUE                                           39990000
400000                                                                  40000000
400100          WHEN SQLCODE = +100                                     40010000
400200             MOVE PC-TSYMSG-03731    TO DP020-MSG-NUMBER          40020000
400300             PERFORM 9900-SOFT-ABORT                              40030000
400400                                                                  40040000
400500          WHEN SQLCODE = -904                                     40050000
400600          WHEN SQLCODE = -911                                     40060000
400700          WHEN SQLCODE = -913                                     40070000
400800             MOVE SQLCODE            TO PV-SQL-RETURN-CD          40080000
400900             MOVE PC-TSYMSG-00984    TO DP020-MSG-NUMBER          40090000
401000             STRING   ' RCKCS224 - 5710-GET-PARM-DATE'            40100000
401100                      '| SELECT FROM TKRPRPM'                     40110000
401200                      '| SQLCODE = '    PV-SQL-RETURN-CD          40120000
401300                      DELIMITED BY SIZE                           40130000
401400                                   INTO PV-CICS-MSG-AREA          40140000
401500             PERFORM 9903-WRITE-CICS-LOG                          40150000
401600             PERFORM 9900-SOFT-ABORT                              40160000
401700                                                                  40170000
401800          WHEN OTHER                                              40180000
401900             MOVE PC-TSYMSG-01570    TO DP020-MSG-NUMBER          40190000
402000             MOVE SQLCODE            TO PV-SQL-RETURN-CD          40200000
402100             STRING   ' RCKCS224 - 5710-GET-PARM-DATE'            40210000
402200                      '| BAD SQL RETURN CODE '                    40220000
402300                      '| FROM TKRPRPM SELECT '                    40230000
402400                      DELIMITED BY SIZE                           40240000
402500                                   INTO PV-CICS-MSG-AREA          40250000
402600             PERFORM 9903-WRITE-CICS-LOG                          40260000
402700             STRING   ' | SQLCODE = '   PV-SQL-RETURN-CD          40270000
402800                      DELIMITED BY SIZE                           40280000
402900                                   INTO PV-CICS-MSG-AREA          40290000
403000             PERFORM 9903-WRITE-CICS-LOG                          40300000
403100             PERFORM 9900-SOFT-ABORT                              40310000
403200          END-EVALUATE.                                           40320000
403300                                                                  40330000
403400 5710-EXIT.                                                       40340000
403500     EXIT.                                                        40350000
403600                                                                  40360000
403700*----------------------------------------------------------------*40370000
403800*    PRINT HEADER LABEL FOR EACH RECEIVER WITH THIS TRAILER      *40380000
403900*----------------------------------------------------------------*40390000
404000                                                                  40400000
404100 6000-PRINT-HEADER-LABEL.                                         40410000
404200                                                                  40420000
404300     PERFORM 3060-VALIDATE-PRINTER-ID.                            40430000
404400                                                                  40440000
404500     PERFORM 3500-GET-DC-LOCATION.                                40450000
404600                                                                  40460000
404700     IF PS-ERROR                                                  40470000
404800         CONTINUE                                                 40480000
404900     ELSE                                                         40490000
405000         MOVE ASC-OWNER-SCAC-ID TO DK-OWNER-SCAC-ID               40500000
405100         MOVE ASC-VEH-NBR       TO DK-VEH-NBR                     40510000
405200         MOVE ASC-ARRIVAL-DTE-ISO                                 40520000
405300                                TO DK-ARRIVAL-DTE                 40530000
405400                                                                  40540000
405500         PERFORM 6010-OPEN-CURSOR                                 40550000
405600                                                                  40560000
405700         MOVE +0 TO PV-LABEL-COUNT                                40570000
405800                                                                  40580000
405900         PERFORM 6030-FETCH-CURSOR                                40590000
406000                                                                  40600000
406100         PERFORM UNTIL PS-NO-DATA-LEFT                            40610000
406200                                                                  40620000
406300             ADD +1 TO PV-LABEL-COUNT                             40630000
406400                                                                  40640000
406500             MOVE ASC-OPER-UNT-ID        TO DK-OPER-UNT-ID        40650000
406600             MOVE ASC-FCLTY-ID           TO DK-FCLTY-ID           40660000
406700             MOVE SHPTPO-PO-NBR          TO DK-PO-NBR             40670000
406800                                            DK-ORD-NBR            40680000
406900             MOVE SHPTPO-REC-SEQ-NBR     TO DK-REC-SEQ-NBR        40690000
407000                                                                  40700000
407100             PERFORM 6500-SETUP-HDR-LABELS-ASC                    40710000
407200                                                                  40720000
407300         END-PERFORM                                              40730000
407400                                                                  40740000
407500         IF PV-LABEL-COUNT = +0                                   40750000
407600             SET PS-ERROR                TO TRUE                  40760000
407700             SET DP020-MSG-FATAL         TO TRUE                  40770000
407800             MOVE PC-TSYMSG-01021        TO DP020-MSG-NUMBER      40780000
407900             MOVE DP015-UNP-ALP-BRT-OFF  TO ASCACA                40790000
408000                                            ATRLRA                40800000
408100             MOVE DP015-RED              TO ASCACC                40810000
408200                                            ATRLRC                40820000
408300             MOVE DP015-REVERSE          TO ASCACH                40830000
408400                                            ATRLRH                40840000
408500             MOVE -1                     TO ASCACL                40850000
408600             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  40860000
408700         ELSE                                                     40870000
408800             SET DP020-MSG-INFORMATIONAL TO TRUE                  40880000
408900             MOVE PV-LABEL-COUNT         TO DP020-MSG-TEXT        40890000
409000             MOVE PC-TSYMSG-01022        TO DP020-MSG-NUMBER      40900000
409100         END-IF                                                   40910000
409200                                                                  40920000
409300         PERFORM 6020-CLOSE-CURSOR                                40930000
409400     END-IF.                                                      40940000
409500                                                                  40950000
409600/                                                                 40960000
409700*----------------------------------------------------------------*40970000
409800* OPEN THE RECEIVER CURSOR.                                      *40980000
409900*----------------------------------------------------------------*40990000
410000                                                                  41000000
410100 6010-OPEN-CURSOR.                                                41010000
410200                                                                  41020000
410300     PERFORM                                                      41030000
410400         WITH TEST AFTER                                          41040000
410500         VARYING PV-RETRY-COUNTER                                 41050000
410600         FROM 1 BY 1                                              41060000
410700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               41070000
410800            OR (SQLCODE = +0))                                    41080000
410900                                                                  41090000
411000         EXEC SQL                                                 41100000
411100              OPEN RECEIVER-CSR                                   41110000
411200         END-EXEC                                                 41120000
411300                                                                  41130000
411400         EVALUATE TRUE                                            41140000
411500             WHEN SQLCODE = +0                                    41150000
411600                  CONTINUE                                        41160000
411700             WHEN SQLCODE = -904                                  41170000
411800             WHEN SQLCODE = -913                                  41180000
411900                  CONTINUE                                        41190000
412000             WHEN SQLWARN0 NOT = SPACE                            41200000
412100             WHEN SQLCODE  NOT = +0                               41210000
412200                  MOVE '6010-OPEN-CURSOR'                         41220000
412300                                   TO DP013-PARAGRAPH             41230000
412400                  MOVE 'OPEN RECEIVER CURSOR'                     41240000
412500                                   TO DP013-MESSAGE-TEXT (1)      41250000
412600                  MOVE SQLCA       TO DP013-SQLCA                 41260000
412700                  MOVE 'TSHPTPO'   TO DP013-DB2-TABLE-NAME (1)    41270000
412800                  MOVE 'TSHIPMT'   TO DP013-DB2-TABLE-NAME (2)    41280000
412900                  MOVE 'TVHTRIP'   TO DP013-DB2-TABLE-NAME (3)    41290000
413000                  MOVE 'TTRIPST'   TO DP013-DB2-TABLE-NAME (4)    41300000
413100                  MOVE 'TTRSTYP'   TO DP013-DB2-TABLE-NAME (5)    41310000
413200                  SET DP013-DB2-ABEND                             41320000
413300                                   TO TRUE                        41330000
413400                  PERFORM DP013-0000-PROCESS-ABEND                41340000
413500         END-EVALUATE                                             41350000
413600     END-PERFORM.                                                 41360000
413700                                                                  41370000
413800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    41380000
413900         SQLCODE NOT = +0                                         41390000
414000         MOVE '6010-OPEN-CURSOR' TO DP013-PARAGRAPH               41400000
414100         MOVE 'MAX RETRIES EXCEEDED FOR OPEN RECEIVER CURSOR'     41410000
414200                                   TO DP013-MESSAGE-TEXT (1)      41420000
414300         MOVE SQLCA                TO DP013-SQLCA                 41430000
414400         SET DP013-DB2-ABEND       TO TRUE                        41440000
414500         PERFORM DP013-0000-PROCESS-ABEND                         41450000
414600     END-IF.                                                      41460000
414700                                                                  41470000
414800/                                                                 41480000
414900*----------------------------------------------------------------*41490000
415000* CLOSE THE RECEIVER CURSOR.                                     *41500000
415100*----------------------------------------------------------------*41510000
415200                                                                  41520000
415300 6020-CLOSE-CURSOR.                                               41530000
415400                                                                  41540000
415500     PERFORM                                                      41550000
415600         WITH TEST AFTER                                          41560000
415700         VARYING PV-RETRY-COUNTER                                 41570000
415800         FROM 1 BY 1                                              41580000
415900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               41590000
416000            OR (SQLCODE = +0))                                    41600000
416100                                                                  41610000
416200         EXEC SQL                                                 41620000
416300              CLOSE RECEIVER-CSR                                  41630000
416400         END-EXEC                                                 41640000
416500                                                                  41650000
416600         EVALUATE TRUE                                            41660000
416700             WHEN SQLCODE = +0                                    41670000
416800                  CONTINUE                                        41680000
416900             WHEN SQLCODE = -904                                  41690000
417000             WHEN SQLCODE = -913                                  41700000
417100                  CONTINUE                                        41710000
417200             WHEN SQLWARN0 NOT = SPACE                            41720000
417300             WHEN SQLCODE  NOT = +0                               41730000
417400                  MOVE '6020-CLOSE-CURSOR'                        41740000
417500                                   TO DP013-PARAGRAPH             41750000
417600                  MOVE 'CLOSE RECEIVER CURSOR'                    41760000
417700                                   TO DP013-MESSAGE-TEXT (1)      41770000
417800                  MOVE SQLCA       TO DP013-SQLCA                 41780000
417900                  MOVE 'TSHPTPO'   TO DP013-DB2-TABLE-NAME (1)    41790000
418000                  MOVE 'TSHIPMT'   TO DP013-DB2-TABLE-NAME (2)    41800000
418100                  MOVE 'TVHTRIP'   TO DP013-DB2-TABLE-NAME (3)    41810000
418200                  MOVE 'TTRIPST'   TO DP013-DB2-TABLE-NAME (4)    41820000
418300                  MOVE 'TTRSTYP'   TO DP013-DB2-TABLE-NAME (5)    41830000
418400                  SET DP013-DB2-ABEND                             41840000
418500                                   TO TRUE                        41850000
418600                  PERFORM DP013-0000-PROCESS-ABEND                41860000
418700         END-EVALUATE                                             41870000
418800     END-PERFORM.                                                 41880000
418900                                                                  41890000
419000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    41900000
419100         SQLCODE NOT = +0                                         41910000
419200         MOVE '6020-CLOSE-CURSOR' TO DP013-PARAGRAPH              41920000
419300         MOVE 'MAX RETRIES EXCEEDED FOR CLOSE RECEIVER CURSOR'    41930000
419400                                   TO DP013-MESSAGE-TEXT (1)      41940000
419500         MOVE SQLCA                TO DP013-SQLCA                 41950000
419600         SET DP013-DB2-ABEND       TO TRUE                        41960000
419700         PERFORM DP013-0000-PROCESS-ABEND                         41970000
419800     END-IF.                                                      41980000
419900                                                                  41990000
420000/                                                                 42000000
420100*----------------------------------------------------------------*42010000
420200*    FETCH THE RECEIVER NUMBER CURSOR.                           *42020000
420300*----------------------------------------------------------------*42030000
420400* WR40574 ADDED CARR-AUTH-ID (CAN) BELOW 2012-02-03 CLT           42040000
420500                                                                  42050000
420600 6030-FETCH-CURSOR.                                               42060000
420700                                                                  42070000
420800                                                                  42080000
420900     EXEC SQL                                                     42090000
421000          FETCH RECEIVER-CSR                                      42100000
421100          INTO                                                    42110000
421200                :SHPTPO-PO-NBR                                    42120000
421300              , :SHPTPO-REC-SEQ-NBR                               42130000
421400              , :SHPTPO-EXPTED-CART-CNT                           42140000
421500              , :PV-TRECEIV-ACTL-CART-CNT                         42150000
421600              , :SHPTPO-DMG-CART-CNT                              42160000
421700              , :SHPTPO-PKSL-IND                                  42170000
421800              , :SHPTPO-VEND-NAME                                 42180000
421900              , :SHIPMT-SHIPT-ID                                  42190000
422000              , :SHIPMT-LAST-UPD-DTE                              42200000
422100              , :SHIPMT-LAST-UPD-TME                              42210000
422200              , :VHTRIP-OWNER-SCAC-ID                             42220000
422300              , :VHTRIP-VEH-NBR                                   42230000
422400              , :VHTRIP-TRIP-ID                                   42240000
422500              , :PV-DB2-REC-DATE                                  42250000
422600              , :RECEIV-CRE-TMST                                  42260000
422700              , :SHIPMT-CARR-AUTH-ID                              42270000
422800     END-EXEC.                                                    42280000
422900                                                                  42290000
423000     EVALUATE TRUE                                                42300000
423100         WHEN SQLCODE = ZERO                                      42310000
423200              SET PS-DATA-LEFT            TO TRUE                 42320000
423300              MOVE SHIPMT-CARR-AUTH-ID    TO ASC-CAN              42330000
423400         WHEN SQLCODE = +100                                      42340000
423500              SET PS-NO-DATA-LEFT         TO TRUE                 42350000
423600              MOVE SPACES                 TO ASC-CAN              42360000
423700         WHEN SQLWARN0 NOT EQUAL SPACE                            42370000
423800         WHEN SQLCODE NOT EQUAL ZERO                              42380000
423900              MOVE '6030-FETCH-CURSOR'                            42390000
424000                               TO DP013-PARAGRAPH                 42400000
424100              MOVE 'FETCH REC SEQ CURSOR'                         42410000
424200                               TO DP013-MESSAGE-TEXT (1)          42420000
424300              MOVE SQLCA       TO DP013-SQLCA                     42430000
424400              SET DP013-DB2-ABEND                                 42440000
424500                               TO TRUE                            42450000
424600              PERFORM DP013-0000-PROCESS-ABEND                    42460000
424700     END-EVALUATE.                                                42470000
424800                                                                  42480000
424900*----------------------------------------------------------------*42490000
425000*    FORMAT HEADER LABEL PRIOR TO PRINT REQUEST FORM ASC.        *42500000
425100*----------------------------------------------------------------*42510000
425200                                                                  42520000
425300 6500-SETUP-HDR-LABELS-ASC.                                       42530000
425400                                                                  42540000
425500     INITIALIZE DCLTPURCHS                                        42550000
425600                DCLTRECEIV                                        42560000
425700                DCLTDCTFAS                                        42570000
425800                DCLTENTNME                                        42580000
425900                DCLTOPRSET.                                       42590000
426000                                                                  42600000
426100     SET PC140-COMMON-HDR-LBL-NBR       TO TRUE.                  42610000
426200                                                                  42620000
426300     MOVE ASC-PRINTER-ID-N       TO PV-PRINTER-NO-9.              42630000
426400     MOVE PV-PRINTER-NO          TO PC140-HL-PRTR-ID.             42640000
426500                                                                  42650000
426600                                                                  42660000
426700     MOVE ASC-TRIP-ID            TO PC140-HL-TRIP-ID.             42670000
426800                                                                  42680000
426900                                                                  42690000
427000     PERFORM 6610-GET-OPER-SET-DESC.                              42700000
427100                                                                  42710000
427200     MOVE OPRSET-CNTL-DESC       TO PC140-HL-PRC-AREA-TX.         42720000
427300                                                                  42730000
427400     MOVE SPACES                 TO PC140-HL-PRC-AREA-CD.         42740000
427500                                                                  42750000
427600                                                                  42760000
427700     IF  PV-TRECEIV-ACTL-CART-CNT > ZEROES                        42770000
427800         MOVE PV-TRECEIV-ACTL-CART-CNT                            42780000
427900                                 TO PC140-HL-CART-CT              42790000
428000     ELSE                                                         42800000
428100         MOVE SHPTPO-EXPTED-CART-CNT                              42810000
428200                                 TO PC140-HL-CART-CT              42820000
428300     END-IF.                                                      42830000
428400                                                                  42840000
428500     IF PV-DB2-REC-DATE = '9999-09-09'                            42850000
428600         MOVE 'ENROUTE '    TO PC140-HL-RCVD-MM-DD-YY             42860000
428700                                                                  42870000
428800     ELSE                                                         42880000
428900         MOVE PV-DB2-REC-DATE   TO PV-DB2-DATE                    42890000
429000                                                                  42900000
429100         STRING                                                   42910000
429200             PV-DB2-DATE-MM                                       42920000
429300             '-'                                                  42930000
429400             PV-DB2-DATE-DD                                       42940000
429500             '-'                                                  42950000
429600             PV-DB2-DATE-YY                                       42960000
429700                 DELIMITED BY SIZE                                42970000
429800                                   INTO PC140-HL-RCVD-MM-DD-YY    42980000
429900     END-IF.                                                      42990000
430000                                                                  43000000
430200     MOVE SHPTPO-PO-NBR          TO PC140-HL-PO-NBR.              43020003
430700                                                                  43070000
430800     PERFORM 6620-GET-PO-INFO.                                    43080000
430900     MOVE PURCHS-DEPT-NBR        TO DK-DEPT-NBR.                  43090000
431000                                                                  43100000
431100     IF  SQLCODE = +0                                             43110000
431200         MOVE ENTNME-ENT-NAME-DESC                                43120000
431300                                 TO PC140-HL-VEND-NAME            43130000
431400     ELSE                                                         43140000
431500         MOVE SHPTPO-VEND-NAME   TO                               43150000
431600                                    PC140-HL-VEND-NAME            43160000
431700     END-IF.                                                      43170000
431800                                                                  43180000
431900     MOVE SHPTPO-REC-SEQ-NBR     TO PV-RCVR-SEQ-4-DGT.            43190000
432000     MOVE PV-RCVR-SEQ-3-X        TO                               43200000
432100                                    PC140-HL-RCVR-SEQ-NBR-TX.     43210000
432200                                                                  43220000
432300     PERFORM 6630-GET-AD-DATE.                                    43230000
432400                                                                  43240000
432500     IF  SQLCODE = -305 OR DN-AD-EVNT-DTE = -1                    43250000
432600         MOVE '  -  -  '         TO                               43260000
432700                                    PC140-HL-AD-MM-DD-YY          43270000
432800     ELSE                                                         43280000
432900         MOVE PURITM-AD-EVNT-DTE TO PV-DB2-DATE                   43290000
433000         STRING                                                   43300000
433100             PV-DB2-DATE-MM                                       43310000
433200             '-'                                                  43320000
433300             PV-DB2-DATE-DD                                       43330000
433400             '-'                                                  43340000
433500             PV-DB2-DATE-YY                                       43350000
433600                 DELIMITED BY SIZE                                43360000
433700                               INTO PC140-HL-AD-MM-DD-YY          43370000
433800     END-IF.                                                      43380000
433900                                                                  43390000
434000     PERFORM 6640-GET-RECEIVER-INFO.                              43400000
434100                                                                  43410000
434200     EVALUATE RECEIV-AD-INFO-DESC                                 43420000
434300         WHEN '1'                                                 43430000
434400             MOVE 'HOT '         TO                               43440000
434500                                    PC140-HL-PIC-TX               43450000
434600         WHEN '2'                                                 43460000
434700             MOVE 'PICT'         TO                               43470000
434800                                    PC140-HL-PIC-TX               43480000
434900         WHEN '3'                                                 43490000
435000             MOVE 'PREP'         TO                               43500000
435100                                    PC140-HL-PIC-TX               43510000
435200         WHEN '4'                                                 43520000
435300             MOVE 'RAIN'         TO                               43530000
435400                                    PC140-HL-PIC-TX               43540000
435500         WHEN '5'                                                 43550000
435600             MOVE 'CUST'         TO                               43560000
435700                                    PC140-HL-PIC-TX               43570000
435800         WHEN OTHER                                               43580000
435900             MOVE SPACES         TO                               43590000
436000                                    PC140-HL-PIC-TX               43600000
436100     END-EVALUATE.                                                43610000
436200                                                                  43620000
436300     PERFORM 6650-GET-SPECIAL-INSTR.                              43630000
436400                                                                  43640000
436500     IF  SQLCODE = +0                                             43650000
436600         MOVE INSTCD-INSTR-DESC(1:25)                             43660000
436700                                 TO                               43670000
436800                                    PC140-HL-SPECIAL-TX           43680000
436900     ELSE                                                         43690000
437000         MOVE SPACES             TO                               43700000
437100                                    PC140-HL-SPECIAL-TX           43710000
437200     END-IF.                                                      43720000
437300                                                                  43730000
437400     IF  RECEIV-PRE-TKT-IND = 'N' OR ' '                          43740000
437500         MOVE SPACES             TO                               43750000
437600                                    PC140-HL-PRE-TKT-TX           43760000
437700     ELSE                                                         43770000
437800         MOVE PC-PRE-TICKETED    TO                               43780000
437900                                    PC140-HL-PRE-TKT-TX           43790000
438000     END-IF.                                                      43800000
438100                                                                  43810000
438200     IF RECEIV-PACK-BY-ST-IND = 'N' OR ' '                        43820000
438300         MOVE SPACES             TO                               43830000
438400                                    PC140-HL-PACKED-BY-TX         43840000
438500     ELSE                                                         43850000
438600         MOVE PC-PACKED-BY-STORE TO                               43860000
438700                                    PC140-HL-PACKED-BY-TX         43870000
438800     END-IF.                                                      43880000
438900                                                                  43890000
439000     IF RECEIV-GOH-IND = 'N' OR ' '                               43900000
439100         MOVE SPACES             TO                               43910000
439200                                    PC140-HL-ON-HANGER-TX         43920000
439300     ELSE                                                         43930000
439400         MOVE PC-ON-HANGER       TO                               43940000
439500                                    PC140-HL-ON-HANGER-TX         43950000
439600     END-IF.                                                      43960000
439700                                                                  43970000
439800     PERFORM 6659-SELECT-MIN-ITM.                                 43980000
439900     PERFORM 6671-CALL-XLKUT001.                                  43990000
440000         IF XL001-SUCCESSFUL                                      44000000
440100             MOVE XL001-SUB-CL-NBR-2CH TO PV-SUB-CL-NBR-2CH       44010000
440200         ELSE                                                     44020000
440300             MOVE SPACE                TO PV-SUB-CL-NBR-2CH       44030000
440400         END-IF.                                                  44040000
440500                                                                  44050000
440600     PERFORM 6660-SELECT-TDCTFAS.                                 44060000
440700                                                                  44070000
440800     IF  DN-TKT-FMT-ID = -1                                       44080000
440900         MOVE SPACES             TO                               44090000
441000                                    PC140-HL-TICKET-TYPE          44100000
441100     ELSE                                                         44110000
441200         MOVE DCTFAS-TKT-FMT-ID  TO                               44120000
441300                                    PC140-HL-TICKET-TYPE          44130000
441400     END-IF.                                                      44140000
441500                                                                  44150000
441600     MOVE PURCHS-DEPT-NBR        TO                               44160000
441700                                    PC140-HL-DEPT.                44170000
441800                                                                  44180000
441900     PERFORM 6670-GET-ITM-NBR.                                    44190000
442000     INITIALIZE XL001-ITEM-COMMAREA.                              44200000
442100     IF PS-CALL-ITM-YES                                           44210000
442200         PERFORM 6671-CALL-XLKUT001                               44220000
442300     END-IF                                                       44230000
442400     IF XL001-SUCCESSFUL                                          44240000
442500         MOVE XL001-SUB-CL-NBR-2CH  TO PC140-HL-CLASS             44250000
442600     ELSE                                                         44260000
442700         MOVE SPACE                 TO PC140-HL-CLASS             44270000
442800     END-IF.                                                      44280000
442900                                                                  44290000
443000                                                                  44300000
443100     IF SHPTPO-PKSL-IND = 'Y'                                     44310000
443200         MOVE PC-DETAIL-CHECK    TO                               44320000
443300                                    PC140-HL-DETAIL-CHECK         44330000
443400     ELSE                                                         44340000
443500         MOVE SPACES             TO                               44350000
443600                                    PC140-HL-DETAIL-CHECK         44360000
443700     END-IF.                                                      44370000
443800                                                                  44380000
443900     PERFORM 6680-CHECK-MULT-SHIPMENTS.                           44390000
444000                                                                  44400000
444100     IF PV-SHIPMENT-COUNT > 1                                     44410000
444200         MOVE PC-MULTIPLE-SHIPMENTS                               44420000
444300                                 TO                               44430000
444400                                    PC140-HL-MULT-SHIPMENTS-TX    44440000
444500     ELSE                                                         44450000
444600         MOVE SPACES             TO                               44460000
444700                                    PC140-HL-MULT-SHIPMENTS-TX    44470000
444800     END-IF.                                                      44480000
444900                                                                  44490000
445000         PERFORM 6520-LINK-SOCKET-PRINT-ROUTINE.                  44500000
445100                                                                  44510000
445200     PERFORM 6030-FETCH-CURSOR.                                   44520000
445300                                                                  44530000
445400/                                                                 44540000
445500                                                                  44550000
445600                                                                  44560000
445700 6520-LINK-SOCKET-PRINT-ROUTINE.                                  44570000
445800                                                                  44580000
445900     MOVE DP020-USERID           TO PC140-CRA-USERID.             44590000
446000     MOVE 400                    TO PV-COMMAREA-LENGTH.           44600000
446100                                                                  44610000
446200     EXEC CICS                                                    44620000
446300          LINK PROGRAM  ('PCKCS707')                              44630000
446400               COMMAREA (PC140-LABELMST)                          44640000
446500               LENGTH   (PV-COMMAREA-LENGTH)                      44650000
446600               RESP     (PV-CICS-RESP)                            44660000
446700     END-EXEC.                                                    44670000
446800                                                                  44680000
446900     EVALUATE TRUE                                                44690000
447000         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     44700000
447100              CONTINUE                                            44710000
447200         WHEN OTHER                                               44720000
447300              PERFORM DP013-0000-PROCESS-ABEND                    44730000
447400     END-EVALUATE.                                                44740000
447500     IF PC140-CRA-SOCKET-COMM-ERROR                               44750000
447600         SET PS-ERROR            TO TRUE                          44760000
447700         SET DP020-MSG-FATAL     TO TRUE                          44770000
447800         MOVE PC-TSYMSG-02122    TO DP020-MSG-NUMBER              44780000
447900         MOVE DP015-UNP-NUM-BRT-OFF                               44790000
448000                                 TO APRINTRA                      44800000
448100         MOVE DP015-RED          TO APRINTRC                      44810000
448200         MOVE DP015-REVERSE      TO APRINTRH                      44820000
448300         MOVE -1                 TO APRINTRL                      44830000
448400         SET DP030-SET-CURSOR-APPL-1                              44840000
448500                                 TO TRUE                          44850000
448600     ELSE                                                         44860000
448700     IF PC140-CRA-INVALID-PRT-FMT                                 44870000
448800         SET PS-ERROR            TO TRUE                          44880000
448900         SET DP020-MSG-FATAL     TO TRUE                          44890000
449000         MOVE DP015-UNP-NUM-BRT-OFF                               44900000
449100                                 TO APRINTRA                      44910000
449200         MOVE DP015-RED          TO APRINTRC                      44920000
449300         MOVE DP015-REVERSE      TO APRINTRH                      44930000
449400         MOVE -1                 TO APRINTRL                      44940000
449500         SET DP030-SET-CURSOR-APPL-1                              44950000
449600                                 TO TRUE                          44960000
449700         MOVE PC140-CRA-RET-CDE      TO PM-RET-CDE                44970000
449800         MOVE PC140-CRA-RET-MSG      TO PM-RET-MSG                44980000
449900         MOVE PM-PROGRAM-MESSAGE-1   TO DP020-MSG-TEXT            44990000
450000     ELSE                                                         45000000
450100         SET DP020-MSG-INFORMATIONAL TO TRUE                      45010000
450200         MOVE PC-TSYMSG-00098    TO DP020-MSG-NUMBER              45020000
450300         MOVE -1                 TO APRINTRL                      45030000
450400         SET DP030-SET-CURSOR-APPL-1                              45040000
450500                                 TO TRUE                          45050000
450600     END-IF.                                                      45060000
450700/                                                                 45070000
450800*----------------------------------------------------------------*45080000
450900*    RETRIEVE OPERATION SET DESCRIPTION                          *45090000
451000*----------------------------------------------------------------*45100000
451100 6610-GET-OPER-SET-DESC.                                          45110000
451200                                                                  45120000
451300     PERFORM                                                      45130000
451400         WITH TEST AFTER                                          45140000
451500         VARYING PV-RETRY-COUNTER                                 45150000
451600         FROM 1 BY 1                                              45160000
451700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               45170000
451800             OR (SQLCODE = +0)                                    45180000
451900             OR (SQLCODE = +100))                                 45190000
452000                                                                  45200000
452100         EXEC SQL                                                 45210000
452200            SELECT  DISTINCT                                      45220000
452300                    C.OPER_SET_DESC                               45230000
452400                   ,C.CNTL_DESC                                   45240000
452500              INTO :OPRSET-OPER-SET-DESC                          45250000
452600                  ,:OPRSET-CNTL-DESC                              45260000
452700              FROM  TRECEIV A                                     45270000
452800                   ,TWRKORD B                                     45280000
452900                   ,TOPRSET C                                     45290000
453000             WHERE  A.OPER_UNT_ID    = :DK-OPER-UNT-ID            45300000
453100               AND  A.FCLTY_ID       = :DK-FCLTY-ID               45310000
453200               AND  A.ORD_NBR        = :DK-PO-NBR                 45320000
453300               AND  A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR            45330000
453400               AND  B.ORD_LNE_NBR    = 0                          45340000
453500               AND  A.VER_STATUS_CDE = 'A'                        45350000
453600               AND  B.VER_STATUS_CDE = 'A'                        45360000
453700               AND  A.ORD_NBR        = B.ORD_NBR                  45370000
453800               AND  A.REC_SEQ_NBR    = B.RCVR_SEQ_NBR             45380000
453900               AND  B.OPER_SET_ID    = C.OPER_SET_ID              45390000
454000               AND  C.OPER_UNT_ID    = A.CURR_OPER_UNT_ID         45400000
454100         END-EXEC                                                 45410000
454200                                                                  45420000
454300         EVALUATE TRUE                                            45430000
454400             WHEN SQLCODE = +0                                    45440000
454500             WHEN SQLCODE = +100                                  45450000
454600             WHEN SQLCODE = -904                                  45460000
454700             WHEN SQLCODE = -913                                  45470000
454800                  CONTINUE                                        45480000
454900                                                                  45490000
455000             WHEN SQLWARN0 NOT = SPACES                           45500000
455100             WHEN SQLCODE < +0                                    45510000
455200             WHEN SQLCODE > +0                                    45520000
455300                  INITIALIZE PV-MESSAGE                           45530000
455400                  MOVE DK-PO-NBR    TO PV-MESSAGE1                45540000
455500                  MOVE DK-REC-SEQ-NBR TO PV-MESSAGE2              45550000
455600                  MOVE '6610-GET-OPER-SET-DESC'                   45560000
455700                                  TO DP013-PARAGRAPH              45570000
455800                  MOVE 'UNSUCCESSFUL SELECT ON TOPRSET  '         45580000
455900                                  TO DP013-MESSAGE-TEXT (1)       45590000
456000                  MOVE PV-MESSAGE TO DP013-MESSAGE-TEXT (2)       45600000
456100                  MOVE SQLCA      TO DP013-SQLCA                  45610000
456200                  MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (1)     45620000
456300                  MOVE 'TWRKORD ' TO DP013-DB2-TABLE-NAME (2)     45630000
456400                  MOVE 'TOPRSET ' TO DP013-DB2-TABLE-NAME (3)     45640000
456500                  SET DP013-DB2-ABEND                             45650000
456600                      DP013-XCTL-DISPLAY-RESTART                  45660000
456700                                  TO TRUE                         45670000
456800                  PERFORM DP013-0000-PROCESS-ABEND                45680000
456900         END-EVALUATE                                             45690000
457000     END-PERFORM.                                                 45700000
457100                                                                  45710000
457200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    45720000
457300         SQLCODE NOT = +0                                         45730000
457400         MOVE '6610-GET-OPER-SET-DESC'                            45740000
457500                                  TO DP013-PARAGRAPH              45750000
457600         MOVE 'MAX RETRIES EXCEEDED ON SELECT ON TOPRSET  '       45760000
457700                                  TO DP013-MESSAGE-TEXT (1)       45770000
457800         MOVE SQLCA               TO DP013-SQLCA                  45780000
457900         MOVE 'TRECEIV '          TO DP013-DB2-TABLE-NAME (1)     45790000
458000         MOVE 'TWRKORD '          TO DP013-DB2-TABLE-NAME (2)     45800000
458100         MOVE 'TOPRSET '          TO DP013-DB2-TABLE-NAME (3)     45810000
458200         SET DP013-DB2-ABEND                                      45820000
458300             DP013-XCTL-DISPLAY-RESTART                           45830000
458400                                  TO TRUE                         45840000
458500         PERFORM DP013-0000-PROCESS-ABEND                         45850000
458600     END-IF.                                                      45860000
458700                                                                  45870000
458800/                                                                 45880000
458900*----------------------------------------------------------------*45890000
459000*    GET PURCHASE ORDER INFO                                     *45900000
459100*----------------------------------------------------------------*45910000
459200 6620-GET-PO-INFO.                                                45920000
459300                                                                  45930000
459400     PERFORM                                                      45940000
459500         WITH TEST AFTER                                          45950000
459600         VARYING PV-RETRY-COUNTER                                 45960000
459700         FROM 1 BY 1                                              45970000
459800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               45980000
459900            OR (SQLCODE = +0)                                     45990000
460000            OR (SQLCODE = +100))                                  46000000
460100                                                                  46010000
460200         EXEC SQL                                                 46020000
460300            SELECT  A.DEPT_NBR                                    46030000
460400                   ,B.ENT_NAME_DESC                               46040000
460500              INTO :PURCHS-DEPT-NBR                               46050000
460600                  ,:ENTNME-ENT-NAME-DESC                          46060000
460700              FROM  TPURCHS A                                     46070000
460800                   ,TENTNME B                                     46080000
460900          WHERE A.PO_NBR         = :DK-PO-NBR                     46090000
461000            AND A.VER_STATUS_CDE = 'A'                            46100000
461100            AND B.TYPE_CDE       = '01'                           46110000
461200            AND A.ENT_ID = B.ENT_ID                               46120000
461300         END-EXEC                                                 46130000
461400                                                                  46140000
461500         EVALUATE TRUE                                            46150000
461600             WHEN SQLCODE = +0                                    46160000
461700             WHEN SQLCODE = +100                                  46170000
461800             WHEN SQLCODE = -904                                  46180000
461900             WHEN SQLCODE = -913                                  46190000
462000                 CONTINUE                                         46200000
462100                                                                  46210000
462200             WHEN SQLWARN0 NOT = SPACE                            46220000
462300             WHEN SQLCODE < +0                                    46230000
462400             WHEN SQLCODE > +0                                    46240000
462500                 MOVE '6620-GET-PO-INFO'                          46250000
462600                                 TO DP013-PARAGRAPH               46260000
462700                 MOVE 'SELECT ON TPURCHS'                         46270000
462800                                 TO DP013-MESSAGE-TEXT (1)        46280000
462900                 MOVE SQLCA      TO DP013-SQLCA                   46290000
463000                 MOVE 'TPURCHS'  TO DP013-DB2-TABLE-NAME (1)      46300000
463100                 MOVE 'TENTNME'  TO DP013-DB2-TABLE-NAME (2)      46310000
463200                 SET DP013-DB2-ABEND                              46320000
463300                                 TO TRUE                          46330000
463400                 SET DP013-XCTL-DISPLAY-RESTART                   46340000
463500                                 TO TRUE                          46350000
463600                 PERFORM DP013-0000-PROCESS-ABEND                 46360000
463700         END-EVALUATE                                             46370000
463800     END-PERFORM.                                                 46380000
463900                                                                  46390000
464000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    46400000
464100         SQLCODE NOT = +0                                         46410000
464200         MOVE '6620-GET-PO-INFO'                                  46420000
464300                                 TO DP013-PARAGRAPH               46430000
464400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     46440000
464500                                 TO DP013-MESSAGE-TEXT (1)        46450000
464600         MOVE 'PURCHASE ORDER INFO'                               46460000
464700                                 TO DP013-MESSAGE-TEXT (2)        46470000
464800         MOVE SQLCA              TO DP013-SQLCA                   46480000
464900         MOVE 'TPURCHS'          TO DP013-DB2-TABLE-NAME (1)      46490000
465000         MOVE 'TENTNME'          TO DP013-DB2-TABLE-NAME (2)      46500000
465100         SET DP013-DB2-ABEND     TO TRUE                          46510000
465200         SET DP013-XCTL-DISPLAY-RESTART                           46520000
465300                                 TO TRUE                          46530000
465400         PERFORM DP013-0000-PROCESS-ABEND                         46540000
465500     END-IF.                                                      46550000
465600                                                                  46560000
465700                                                                  46570000
465800/                                                                 46580000
465900*----------------------------------------------------------------*46590000
466000*    GET THE EARLIEST AD DATE                                    *46600000
466100*----------------------------------------------------------------*46610000
466200 6630-GET-AD-DATE.                                                46620000
466300                                                                  46630000
466400     PERFORM                                                      46640000
466500         WITH TEST AFTER                                          46650000
466600         VARYING PV-RETRY-COUNTER                                 46660000
466700         FROM 1 BY 1                                              46670000
466800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               46680000
466900             OR (SQLCODE = +0)                                    46690000
467000             OR (SQLCODE = -305))                                 46700000
467100                                                                  46710000
467200         EXEC SQL                                                 46720000
467300              SELECT MIN(AD_EVNT_DTE)                             46730000
467400                INTO :PURITM-AD-EVNT-DTE                          46740000
467500                       :DN-AD-EVNT-DTE                            46750000
467600                FROM TPURITM                                      46760000
467700               WHERE PO_NBR         = :DK-PO-NBR                  46770000
467800                 AND VER_STATUS_CDE = 'A'                         46780000
467900                 AND AD_EVNT_DTE > '0001-01-01'                   46790000
468000         END-EXEC                                                 46800000
468100                                                                  46810000
468200         EVALUATE TRUE                                            46820000
468300             WHEN SQLCODE = +0                                    46830000
468400             WHEN SQLCODE = -305                                  46840000
468500             WHEN SQLCODE = -904                                  46850000
468600             WHEN SQLCODE = -913                                  46860000
468700                  CONTINUE                                        46870000
468800                                                                  46880000
468900             WHEN SQLWARN0 NOT = SPACES                           46890000
469000             WHEN SQLCODE < +0                                    46900000
469100             WHEN SQLCODE > +0                                    46910000
469200                  MOVE '6630-GET-AD-DATE'                         46920000
469300                                  TO DP013-PARAGRAPH              46930000
469400                  MOVE 'UNSUCCESSFUL SELECT ON TPURITM'           46940000
469500                                  TO DP013-MESSAGE-TEXT (1)       46950000
469600                  MOVE SQLCA      TO DP013-SQLCA                  46960000
469700                  MOVE 'TPURITM ' TO DP013-DB2-TABLE-NAME (1)     46970000
469800                  SET DP013-DB2-ABEND                             46980000
469900                      DP013-XCTL-DISPLAY-RESTART                  46990000
470000                                  TO TRUE                         47000000
470100                  PERFORM DP013-0000-PROCESS-ABEND                47010000
470200         END-EVALUATE                                             47020000
470300     END-PERFORM.                                                 47030000
470400                                                                  47040000
470500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    47050000
470600         SQLCODE NOT = +0                                         47060000
470700         MOVE '6630-GET-AD-DATE'                                  47070000
470800                                  TO DP013-PARAGRAPH              47080000
470900         MOVE 'MAX RETRIES EXCEEDED ON SELECT TPURITM'            47090000
471000                                  TO DP013-MESSAGE-TEXT (1)       47100000
471100         MOVE SQLCA               TO DP013-SQLCA                  47110000
471200         MOVE 'TPURITM '          TO DP013-DB2-TABLE-NAME (1)     47120000
471300         SET DP013-DB2-ABEND                                      47130000
471400             DP013-XCTL-DISPLAY-RESTART                           47140000
471500                                  TO TRUE                         47150000
471600         PERFORM DP013-0000-PROCESS-ABEND                         47160000
471700     END-IF.                                                      47170000
471800                                                                  47180000
471900/                                                                 47190000
472000*----------------------------------------------------------------*47200000
472100*    GET RECEIVER INFO                                           *47210000
472200*----------------------------------------------------------------*47220000
472300 6640-GET-RECEIVER-INFO.                                          47230000
472400                                                                  47240000
472500     PERFORM                                                      47250000
472600         WITH TEST AFTER                                          47260000
472700         VARYING PV-RETRY-COUNTER                                 47270000
472800         FROM 1 BY 1                                              47280000
472900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               47290000
473000            OR (SQLCODE = +0)                                     47300000
473100            OR (SQLCODE = +100))                                  47310000
473200                                                                  47320000
473300         EXEC SQL                                                 47330000
473400            SELECT  PRE_TKT_IND                                   47340000
473500                   ,AD_INFO_DESC                                  47350000
473600                   ,PACK_BY_ST_IND                                47360000
473700                   ,REC_TYP_CDE                                   47370000
473800                   ,RCVG_CLERK_INIT_ID                            47380000
473900                   ,OPER_UNT_ID                                   47390000
474000                   ,FCLTY_ID                                      47400000
474100                   ,GOH_IND                                       47410000
474200              INTO :RECEIV-PRE-TKT-IND                            47420000
474300                  ,:RECEIV-AD-INFO-DESC                           47430000
474400                  ,:RECEIV-PACK-BY-ST-IND                         47440000
474500                  ,:RECEIV-REC-TYP-CDE                            47450000
474600                  ,:RECEIV-RCVG-CLERK-INIT-ID                     47460000
474700                  ,:RECEIV-OPER-UNT-ID                            47470000
474800                  ,:RECEIV-FCLTY-ID                               47480000
474900                  ,:RECEIV-GOH-IND                                47490000
475000              FROM  TRECEIV                                       47500000
475100          WHERE OPER_UNT_ID    = :DK-OPER-UNT-ID                  47510000
475200            AND FCLTY_ID       = :DK-FCLTY-ID                     47520000
475300            AND ORD_NBR        = :DK-ORD-NBR                      47530000
475400            AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR                  47540000
475500            AND VER_STATUS_CDE = 'A'                              47550000
475600         END-EXEC                                                 47560000
475700                                                                  47570000
475800         EVALUATE TRUE                                            47580000
475900             WHEN SQLCODE = +0                                    47590000
476000             WHEN SQLCODE = +100                                  47600000
476100             WHEN SQLCODE = -904                                  47610000
476200             WHEN SQLCODE = -913                                  47620000
476300                 CONTINUE                                         47630000
476400                                                                  47640000
476500             WHEN SQLWARN0 NOT = SPACE                            47650000
476600             WHEN SQLCODE < +0                                    47660000
476700             WHEN SQLCODE > +0                                    47670000
476800                 MOVE '6640-GET-RECEIVER-INFO'                    47680000
476900                                 TO DP013-PARAGRAPH               47690000
477000                 MOVE 'SELECT ON TRECEIV'                         47700000
477100                                 TO DP013-MESSAGE-TEXT (1)        47710000
477200                 MOVE SQLCA      TO DP013-SQLCA                   47720000
477300                 MOVE 'TRECEIV'  TO DP013-DB2-TABLE-NAME (1)      47730000
477400                 SET DP013-DB2-ABEND                              47740000
477500                                 TO TRUE                          47750000
477600                 SET DP013-XCTL-DISPLAY-RESTART                   47760000
477700                                 TO TRUE                          47770000
477800                 PERFORM DP013-0000-PROCESS-ABEND                 47780000
477900         END-EVALUATE                                             47790000
478000     END-PERFORM.                                                 47800000
478100                                                                  47810000
478200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    47820000
478300         SQLCODE NOT = +0                                         47830000
478400         MOVE '6640-GET-RECEIVER-INFO'                            47840000
478500                                 TO DP013-PARAGRAPH               47850000
478600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     47860000
478700                                 TO DP013-MESSAGE-TEXT (1)        47870000
478800         MOVE 'RECEIVER INFO     '                                47880000
478900                                 TO DP013-MESSAGE-TEXT (2)        47890000
479000         MOVE SQLCA              TO DP013-SQLCA                   47900000
479100         MOVE 'TRECEIV'          TO DP013-DB2-TABLE-NAME (1)      47910000
479200         SET DP013-DB2-ABEND     TO TRUE                          47920000
479300         SET DP013-XCTL-DISPLAY-RESTART                           47930000
479400                                 TO TRUE                          47940000
479500         PERFORM DP013-0000-PROCESS-ABEND                         47950000
479600     END-IF.                                                      47960000
479700                                                                  47970000
479800/                                                                 47980000
479900*----------------------------------------------------------------*47990000
480000*    GET SPECIAL INSTRUCTION FOR PO                              *48000000
480100*----------------------------------------------------------------*48010000
480200 6650-GET-SPECIAL-INSTR.                                          48020000
480300                                                                  48030000
480400     PERFORM                                                      48040000
480500         WITH TEST AFTER                                          48050000
480600         VARYING PV-RETRY-COUNTER                                 48060000
480700         FROM 1 BY 1                                              48070000
480800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               48080000
480900            OR (SQLCODE = +0)                                     48090000
481000            OR (SQLCODE = -811)                                   48100000
481100            OR (SQLCODE = +100))                                  48110000
481200                                                                  48120000
481300         EXEC SQL                                                 48130000
481400            SELECT  B.INSTR_DESC                                  48140000
481500              INTO :INSTCD-INSTR-DESC                             48150000
481600              FROM  TPOINST A                                     48160000
481700                   ,TINSTCD B                                     48170000
481800          WHERE A.PO_NBR    = :DK-PO-NBR                          48180000
481900            AND A.RECIP_CDE = 'DC'                                48190000
482000            AND A.INSTR_NBR = B.INSTR_NBR                         48200000
482100         END-EXEC                                                 48210000
482200                                                                  48220000
482300         EVALUATE TRUE                                            48230000
482400             WHEN SQLCODE = +0                                    48240000
482500             WHEN SQLCODE = +100                                  48250000
482600             WHEN SQLCODE = -811                                  48260000
482700             WHEN SQLCODE = -904                                  48270000
482800             WHEN SQLCODE = -913                                  48280000
482900                 CONTINUE                                         48290000
483000                                                                  48300000
483100             WHEN SQLWARN0 NOT = SPACE                            48310000
483200             WHEN SQLCODE < +0                                    48320000
483300             WHEN SQLCODE > +0                                    48330000
483400                 MOVE '6650-GET-SPECIAL-INSTR'                    48340000
483500                                 TO DP013-PARAGRAPH               48350000
483600                 MOVE 'SELECT ON TPOINST'                         48360000
483700                                 TO DP013-MESSAGE-TEXT (1)        48370000
483800                 MOVE SQLCA      TO DP013-SQLCA                   48380000
483900                 MOVE 'TPOINST'  TO DP013-DB2-TABLE-NAME (1)      48390000
484000                 MOVE 'TINSTCD'  TO DP013-DB2-TABLE-NAME (2)      48400000
484100                 SET DP013-DB2-ABEND                              48410000
484200                                 TO TRUE                          48420000
484300                 SET DP013-XCTL-DISPLAY-RESTART                   48430000
484400                                 TO TRUE                          48440000
484500                 PERFORM DP013-0000-PROCESS-ABEND                 48450000
484600         END-EVALUATE                                             48460000
484700     END-PERFORM.                                                 48470000
484800                                                                  48480000
484900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    48490000
485000         SQLCODE NOT = +0                                         48500000
485100         MOVE '6650-GET-SPECIAL-INSTR'                            48510000
485200                                 TO DP013-PARAGRAPH               48520000
485300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     48530000
485400                                 TO DP013-MESSAGE-TEXT (1)        48540000
485500         MOVE 'SPECIAL INSTRUCTIONS FOR PO'                       48550000
485600                                 TO DP013-MESSAGE-TEXT (2)        48560000
485700         MOVE SQLCA              TO DP013-SQLCA                   48570000
485800         MOVE 'TPOINST'          TO DP013-DB2-TABLE-NAME (1)      48580000
485900         MOVE 'TINSTCD'          TO DP013-DB2-TABLE-NAME (2)      48590000
486000         SET DP013-DB2-ABEND     TO TRUE                          48600000
486100         SET DP013-XCTL-DISPLAY-RESTART                           48610000
486200                                 TO TRUE                          48620000
486300         PERFORM DP013-0000-PROCESS-ABEND                         48630000
486400     END-IF.                                                      48640000
486500                                                                  48650000
486600/                                                                 48660000
486700*----------------------------------------------------------------*48670000
486800*    GET MIN ITM FOR FROM TPURITM TABLE                          *48680000
486900*----------------------------------------------------------------*48690000
487000 6659-SELECT-MIN-ITM.                                             48700000
487100                                                                  48710000
487200     EXEC SQL                                                     48720000
487300         SELECT MIN (B.ITM_NBR)                                   48730000
487400            INTO :PURITM-ITM-NBR                                  48740000
487500            FROM TPURITM B                                        48750000
487600         WHERE B.PO_NBR = :DK-PO-NBR                              48760000
487700            AND B.VER_STATUS_CDE = 'A'                            48770000
487800     END-EXEC                                                     48780000
487900                                                                  48790000
488000     EVALUATE TRUE                                                48800000
488100         WHEN SQLCODE = +0                                        48810000
488200         WHEN SQLCODE = +100                                      48820000
488300         WHEN SQLCODE = -904                                      48830000
488400         WHEN SQLCODE = -913                                      48840000
488500            CONTINUE                                              48850000
488600                                                                  48860000
488700         WHEN SQLWARN0 NOT = SPACES                               48870000
488800         WHEN SQLCODE < +0                                        48880000
488900         WHEN SQLCODE > +0                                        48890000
489000            MOVE '6659-SELECT-MIIN-ITM' TO DP013-PARAGRAPH        48900000
489100            MOVE 'UNSUCCESSFUL SELECT ON TPURITM TABLE'           48910000
489200                                        TO DP013-MESSAGE-TEXT(1)  48920000
489300            MOVE SQLCA     TO DP013-SQLCA                         48930000
489400            MOVE 'TPURITM' TO DP013-DB2-TABLE-NAME(1)             48940000
489500            SET DP013-DB2-ABEND                                   48950000
489600                DP013-XCTL-DISPLAY-RESTART TO TRUE                48960000
489700            PERFORM DP013-0000-PROCESS-ABEND                      48970000
489800     END-EVALUATE.                                                48980000
489900/                                                                 48990000
490000*----------------------------------------------------------------*49000000
490100*    RETRIEVE TICKET FORMAT                                      *49010000
490200*----------------------------------------------------------------*49020000
490300 6660-SELECT-TDCTFAS.                                             49030000
490400     PERFORM                                                      49040000
490500         WITH TEST AFTER                                          49050000
490600         VARYING PV-RETRY-COUNTER                                 49060000
490700         FROM 1 BY 1                                              49070000
490800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               49080000
490900             OR (SQLCODE = +0)                                    49090000
491000             OR (SQLCODE = +100))                                 49100000
491100                                                                  49110000
491200         EXEC SQL                                                 49120000
491300              SELECT TKT_FMT_ID                                   49130000
491400                INTO :DCTFAS-TKT-FMT-ID                           49140000
491500                       :DN-TKT-FMT-ID                             49150000
491600                FROM TDCTFAS A                                    49160000
491700               WHERE A.OPER_UNT_ID = :DK-OPER-UNT-ID              49170000
491800                 AND A.FCLTY_ID    = :DK-FCLTY-ID                 49180000
491900                 AND A.DEPT_NBR    = :DK-DEPT-NBR                 49190000
492000                 AND A.RANK_NBR    = 1                            49200000
492100                 AND A.CL_NBR      = :PV-SUB-CL-NBR-2CH           49210000
492200         END-EXEC                                                 49220000
492300                                                                  49230000
492400         EVALUATE TRUE                                            49240000
492500                                                                  49250000
492600             WHEN SQLCODE = +0                                    49260000
492700             WHEN SQLCODE = +100                                  49270000
492800             WHEN SQLCODE = -904                                  49280000
492900             WHEN SQLCODE = -913                                  49290000
493000                  CONTINUE                                        49300000
493100                                                                  49310000
493200             WHEN SQLWARN0 NOT = SPACES                           49320000
493300             WHEN SQLCODE < +0                                    49330000
493400             WHEN SQLCODE > +0                                    49340000
493500                  MOVE '6660-SELECT-TDCTFAS'                      49350000
493600                                  TO DP013-PARAGRAPH              49360000
493700                  MOVE 'UNSUCCESSFUL SELECT ON TDCTFAS TABLE'     49370000
493800                                  TO DP013-MESSAGE-TEXT (1)       49380000
493900                  MOVE SQLCA      TO DP013-SQLCA                  49390000
494000                  MOVE 'TDCTFAS ' TO DP013-DB2-TABLE-NAME (1)     49400000
494100                  SET DP013-DB2-ABEND                             49410000
494200                      DP013-XCTL-DISPLAY-RESTART                  49420000
494300                                  TO TRUE                         49430000
494400                  PERFORM DP013-0000-PROCESS-ABEND                49440000
494500         END-EVALUATE                                             49450000
494600     END-PERFORM.                                                 49460000
494700                                                                  49470000
494800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    49480000
494900         SQLCODE NOT = +0                                         49490000
495000         MOVE '6660-SELECT-TDCTFAS'  TO DP013-PARAGRAPH           49500000
495100         MOVE 'MAX RETRIES EXCEEDED ON SELECT TICKET FORMAT ASSIG'49510000
495200                                  TO DP013-MESSAGE-TEXT (1)       49520000
495300         MOVE SQLCA               TO DP013-SQLCA                  49530000
495400         MOVE 'TDCTFAS'           TO DP013-DB2-TABLE-NAME (1)     49540000
495500         SET DP013-DB2-ABEND                                      49550000
495600             DP013-XCTL-DISPLAY-RESTART                           49560000
495700                                  TO TRUE                         49570000
495800         PERFORM DP013-0000-PROCESS-ABEND                         49580000
495900     END-IF.                                                      49590000
496000                                                                  49600000
496100                                                                  49610000
496200/                                                                 49620000
496300*----------------------------------------------------------------*49630000
496400*    GET THE CLASS NUMBER                                        *49640000
496500*----------------------------------------------------------------*49650000
496600 6670-GET-ITM-NBR.                                                49660000
496700                                                                  49670000
496800     INITIALIZE PS-CALL-ITM-SW.                                   49680000
496900                                                                  49690000
497000     PERFORM                                                      49700000
497100         WITH TEST AFTER                                          49710000
497200         VARYING PV-RETRY-COUNTER                                 49720000
497300         FROM 1 BY 1                                              49730000
497400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               49740000
497500             OR (SQLCODE = +0)                                    49750000
497600             OR (SQLCODE = +100))                                 49760000
497700                                                                  49770000
497800         EXEC SQL                                                 49780000
497900              SELECT A.ITM_NBR                                    49790000
498000                INTO :PURITM-ITM-NBR                              49800000
498100                FROM TPURITM A                                    49810000
498200               WHERE A.PO_NBR         = :DK-PO-NBR                49820000
498300                 AND A.VER_STATUS_CDE = 'A'                       49830000
498400                 AND A.PO_LNE_NBR =                               49840000
498500                  (SELECT MIN(B.PO_LNE_NBR)                       49850000
498600                    FROM TPURITM B                                49860000
498700                   WHERE B.PO_NBR = A.PO_NBR                      49870000
498800                     AND B.VER_STATUS_CDE = 'A')                  49880000
498900         END-EXEC                                                 49890000
499000                                                                  49900000
499100         EVALUATE TRUE                                            49910000
499200             WHEN SQLCODE = +0                                    49920000
499300             WHEN SQLCODE = +100                                  49930000
499400             WHEN SQLCODE = -904                                  49940000
499500             WHEN SQLCODE = -913                                  49950000
499600                  SET PS-CALL-ITM-YES TO TRUE                     49960000
499700                                                                  49970000
499800             WHEN SQLWARN0 NOT = SPACES                           49980000
499900             WHEN SQLCODE < +0                                    49990000
500000             WHEN SQLCODE > +0                                    50000000
500100                  MOVE '6670-GET-ITM-NBR'                         50010000
500200                                  TO DP013-PARAGRAPH              50020000
500300                  MOVE 'UNSUCCESSFUL SELECT ON TPURITM'           50030000
500400                                  TO DP013-MESSAGE-TEXT (1)       50040000
500500                  MOVE SQLCA      TO DP013-SQLCA                  50050000
500600                  MOVE 'TPURITM ' TO DP013-DB2-TABLE-NAME (1)     50060000
500700                  SET DP013-DB2-ABEND                             50070000
500800                      DP013-XCTL-DISPLAY-RESTART                  50080000
500900                                  TO TRUE                         50090000
501000                  PERFORM DP013-0000-PROCESS-ABEND                50100000
501100         END-EVALUATE                                             50110000
501200     END-PERFORM.                                                 50120000
501300                                                                  50130000
501400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    50140000
501500         SQLCODE NOT = +0                                         50150000
501600         MOVE '6670-GET-ITM-NBR '                                 50160000
501700                                  TO DP013-PARAGRAPH              50170000
501800         MOVE 'MAX RETRIES EXCEEDED ON SELECT TPURITM'            50180000
501900                                  TO DP013-MESSAGE-TEXT (1)       50190000
502000         MOVE SQLCA               TO DP013-SQLCA                  50200000
502100         MOVE 'TPURITM '          TO DP013-DB2-TABLE-NAME (1)     50210000
502200         SET DP013-DB2-ABEND                                      50220000
502300             DP013-XCTL-DISPLAY-RESTART                           50230000
502400                                  TO TRUE                         50240000
502500         PERFORM DP013-0000-PROCESS-ABEND                         50250000
502600     END-IF.                                                      50260000
502700                                                                  50270000
502800                                                                  50280000
502900/                                                                 50290000
503000*----------------------------------------------------------------*50300000
503100*    CALL THE XLKUT001 ITEM BLACK BOX                            *50310000
503200*----------------------------------------------------------------*50320000
503300 6671-CALL-XLKUT001.                                              50330000
503400                                                                  50340000
503500     MOVE PURITM-ITM-NBR TO XL001-KEY-ITM-NBR.                    50350000
503600                                                                  50360000
503700     SET XL001-BY-ITEM                                            50370000
503800         XL001-SELECT-VND-STYL TO TRUE.                           50380000
503900                                                                  50390000
504000     CALL XL001-VSM-PGM USING DFHEIBLK                            50400000
504100                              XL001-COMMAREA                      50410000
504200                              XL001-ITEM-COMMAREA.                50420000
504300     EVALUATE TRUE                                                50430000
504400                                                                  50440000
504500         WHEN XL001-SUCCESSFUL                                    50450000
504600             WHEN XL001-SKU-SQLCODE =                             50460000
504700                        (0 OR +100 OR -904 OR -913)               50470000
504800             WHEN XL001-VND-STYL-SQLCODE =                        50480000
504900                        (0 OR +100 OR -904 OR -913)               50490000
505000                 CONTINUE                                         50500000
505100                                                                  50510000
505200         WHEN OTHER                                               50520000
505300             MOVE '6671-CALL-XLKUT001'                            50530000
505400                                  TO DP013-PARAGRAPH              50540000
505500             MOVE 'UNSUCCESSFUL SELECT OF SUBCLASS'               50550000
505600                                  TO DP013-MESSAGE-TEXT (1)       50560000
505700             MOVE SQLCA      TO DP013-SQLCA                       50570000
505800             MOVE 'XLT_VND_STYL'                                  50580000
505900                             TO DP013-DB2-TABLE-NAME (1)          50590000
506000             SET DP013-DB2-ABEND                                  50600000
506100                 DP013-XCTL-DISPLAY-RESTART                       50610000
506200                             TO TRUE                              50620000
506300             PERFORM DP013-0000-PROCESS-ABEND                     50630000
506400     END-EVALUATE.                                                50640000
506500                                                                  50650000
506600                                                                  50660000
506700/                                                                 50670000
506800*----------------------------------------------------------------*50680000
506900*    CHECK IF THERE ARE MULTIPLE SHIPMENTS FOR THIS RECEIVER     *50690000
507000*----------------------------------------------------------------*50700000
507100 6680-CHECK-MULT-SHIPMENTS.                                       50710000
507200                                                                  50720000
507300     INITIALIZE PV-SHIPMENT-COUNT.                                50730000
507400                                                                  50740000
507500     PERFORM                                                      50750000
507600         WITH TEST AFTER                                          50760000
507700         VARYING PV-RETRY-COUNTER                                 50770000
507800         FROM 1 BY 1                                              50780000
507900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               50790000
508000            OR (SQLCODE = +0)                                     50800000
508100            OR (SQLCODE = +100))                                  50810000
508200                                                                  50820000
508300         EXEC SQL                                                 50830000
508400            SELECT COUNT(*)                                       50840000
508500              INTO :PV-SHIPMENT-COUNT                             50850000
508600              FROM TSHPTPO                                        50860000
508700          WHERE PO_NBR      = :DK-PO-NBR                          50870000
508800            AND REC_SEQ_NBR = :DK-REC-SEQ-NBR                     50880000
508900         END-EXEC                                                 50890000
509000                                                                  50900000
509100         EVALUATE TRUE                                            50910000
509200             WHEN SQLCODE = +0                                    50920000
509300             WHEN SQLCODE = +100                                  50930000
509400             WHEN SQLCODE = -904                                  50940000
509500             WHEN SQLCODE = -913                                  50950000
509600                 CONTINUE                                         50960000
509700                                                                  50970000
509800             WHEN SQLWARN0 NOT = SPACE                            50980000
509900             WHEN SQLCODE < +0                                    50990000
510000             WHEN SQLCODE > +0                                    51000000
510100                 MOVE '6680-CHECK-MULT-SHIPMENTS'                 51010000
510200                                 TO DP013-PARAGRAPH               51020000
510300                 MOVE 'COUNT MULTIPLE SHIPMENTS'                  51030000
510400                                 TO DP013-MESSAGE-TEXT (1)        51040000
510500                 MOVE SQLCA      TO DP013-SQLCA                   51050000
510600                 MOVE 'TSHPTPO'  TO DP013-DB2-TABLE-NAME (1)      51060000
510700                 SET DP013-DB2-ABEND                              51070000
510800                                 TO TRUE                          51080000
510900                 SET DP013-XCTL-DISPLAY-RESTART                   51090000
511000                                 TO TRUE                          51100000
511100                 PERFORM DP013-0000-PROCESS-ABEND                 51110000
511200         END-EVALUATE                                             51120000
511300     END-PERFORM.                                                 51130000
511400                                                                  51140000
511500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        51150000
511600             AND (SQLCODE = -904 OR -913)                         51160000
511700         MOVE '6680-CHECK-MULT-SHIPMENTS'                         51170000
511800                                 TO DP013-PARAGRAPH               51180000
511900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO COUNT'      51190000
512000                                 TO DP013-MESSAGE-TEXT (1)        51200000
512100         MOVE 'MULTIPLE SHIPMENTS'                                51210000
512200                                 TO DP013-MESSAGE-TEXT (2)        51220000
512300         MOVE SQLCA              TO DP013-SQLCA                   51230000
512400         MOVE 'TSHPTPO'          TO DP013-DB2-TABLE-NAME (1)      51240000
512500         SET DP013-DB2-ABEND     TO TRUE                          51250000
512600         SET DP013-XCTL-DISPLAY-RESTART                           51260000
512700                                 TO TRUE                          51270000
512800         PERFORM DP013-0000-PROCESS-ABEND                         51280000
512900     END-IF.                                                      51290000
513000                                                                  51300000
513100/                                                                 51310000
513200*----------------------------------------------------------------*51320000
513300*    SINCE A STARTED TRANSACTION CANNOT RETURN WITH A MESSAGE    *51330000
513400*    STATING NO RECORDS EXIST, VALIDATION IS DONE IN THIS PROGRAM*51340000
513500*----------------------------------------------------------------*51350000
513600 7000-CHECK-DATA-EXISTS.                                          51360000
513700                                                                  51370000
513800     EXEC SQL                                                     51380000
513900         SELECT COUNT(*)                                          51390000
514000           INTO :PV-DB2-COUNT                                     51400000
514100           FROM TVHTRIP A                                         51410000
514200               ,TSHPTPO B                                         51420000
514300               ,TSHIPMT C                                         51430000
514400               ,TTRIPST D                                         51440000
514500               ,TVEHICL E                                         51450000
514600          WHERE A.OWNER_SCAC_ID = :PV-CA-SCAC-CDE                 51460000
514700            AND A.VEH_NBR       = :PV-CA-VEH-NBR                  51470000
514800            AND D.STATUS_DTE    = :PV-CA-ARRIVAL-DTE              51480000
514900            AND B.SHIPT_ID = C.SHIPT_ID                           51490000
515000            AND A.TRIP_ID  = C.TRIP_ID                            51500000
515100            AND C.TRIP_ID  = E.CURR_TRIP_ID                       51510000
515200     END-EXEC.                                                    51520000
515300                                                                  51530000
515400     EVALUATE TRUE                                                51540000
515500         WHEN SQLCODE = ZERO                                      51550000
515600         WHEN SQLCODE = +100                                      51560000
515700             CONTINUE                                             51570000
515800         WHEN SQLWARN0 NOT = SPACES                               51580000
515900         WHEN SQLCODE < ZERO                                      51590000
516000         WHEN SQLCODE > ZERO                                      51600000
516100             MOVE '7000-CHECK-DATA-EXISTS'                        51610000
516200                                   TO DP013-PARAGRAPH             51620000
516300             MOVE 'COUNT ON TVHTRIP '                             51630000
516400                                   TO DP013-MESSAGE-TEXT (1)      51640004
516500             MOVE SQLCA            TO DP013-SQLCA                 51650000
516600             STRING ' SCAC-CDE=     '                             51660004
516700                      PV-CA-SCAC-CDE                              51670004
516800                      DELIMITED BY SIZE                           51680004
516900                                 INTO DP013-MESSAGE-TEXT (2)      51690004
517000             STRING ' VEH-NBR=      '                             51700004
517100                      PV-CA-VEH-NBR                               51710004
517200                      DELIMITED BY SIZE                           51720004
517300                                 INTO DP013-MESSAGE-TEXT (3)      51730004
517400             STRING ' ARRIVAL DATE= '                             51740004
517500                      PV-CA-ARRIVAL-DTE                           51750004
517600                      DELIMITED BY SIZE                           51760004
517700                                 INTO DP013-MESSAGE-TEXT (4)      51770004
517800             MOVE 'TVHTRIP'        TO DP013-DB2-TABLE-NAME (1)    51780000
517900             MOVE 'TSHPTPO'        TO DP013-DB2-TABLE-NAME (2)    51790000
518000             MOVE 'TSHIPMT'        TO DP013-DB2-TABLE-NAME (3)    51800000
518100             MOVE 'TTRIPST'        TO DP013-DB2-TABLE-NAME (4)    51810000
518200             MOVE 'TVEHICL'        TO DP013-DB2-TABLE-NAME (5)    51820000
518300             SET DP013-DB2-ABEND   TO TRUE                        51830000
518400             SET DP013-XCTL-DISPLAY-RESTART                       51840000
518500                                   TO TRUE                        51850000
518600             PERFORM DP013-0000-PROCESS-ABEND                     51860000
518700     END-EVALUATE.                                                51870000
518800                                                                  51880000
518900     IF  PV-DB2-COUNT = +0                                        51890000
519000         EXEC SQL                                                 51900000
519100             SELECT COUNT(*)                                      51910000
519200               INTO :PV-DB2-COUNT                                 51920000
519300               FROM TVHTRIP A                                     51930000
519400                   ,TSHPTPO B                                     51940000
519500                   ,TSHIPMT C                                     51950000
519600                   ,TTRIPST D                                     51960000
519700                   ,TTRSTYP E                                     51970000
519800              WHERE A.OWNER_SCAC_ID = :PV-CA-SCAC-CDE             51980000
519900                AND A.VEH_NBR       = :PV-CA-VEH-NBR              51990000
520000                AND D.STATUS_DTE    = :PV-CA-ARRIVAL-DTE          52000000
520100                AND E.PRTY_CDE =                                  52010000
520200                     (SELECT MAX(G.PRTY_CDE)                      52020000
520300                        FROM TTRIPST F                            52030000
520400                            ,TTRSTYP G                            52040000
520500                       WHERE F.TRIP_ID       = A.TRIP_ID          52050000
520600                       AND F.TRIP_STATUS_CDE = G.TRIP_STATUS_CDE) 52060000
520700                AND D.TRIP_STATUS_CDE = E.TRIP_STATUS_CDE         52070000
520800                AND B.SHIPT_ID        = C.SHIPT_ID                52080000
520900                AND A.TRIP_ID         = C.TRIP_ID                 52090000
521000         END-EXEC                                                 52100000
521100                                                                  52110000
521200         EVALUATE TRUE                                            52120000
521300             WHEN SQLCODE = ZERO                                  52130000
521400             WHEN SQLCODE = +100                                  52140000
521500                 CONTINUE                                         52150000
521600             WHEN SQLWARN0 NOT = SPACES                           52160000
521700             WHEN SQLCODE < ZERO                                  52170000
521800             WHEN SQLCODE > ZERO                                  52180000
521900                 MOVE '7000-CHECK-DATA-EXISTS'                    52190000
522000                                       TO DP013-PARAGRAPH         52200000
522100                 MOVE 'COUNT ON TVHTRIP '                         52210000
522200                                       TO DP013-MESSAGE-TEXT (1)  52220000
522300                 STRING ' SCAC-CDE=     '                         52230004
522400                          PV-CA-SCAC-CDE                          52240004
522500                          DELIMITED BY SIZE                       52250004
522600                                     INTO DP013-MESSAGE-TEXT (2)  52260004
522700                 STRING ' VEH-NBR=      '                         52270004
522800                          PV-CA-VEH-NBR                           52280004
522900                          DELIMITED BY SIZE                       52290004
523000                                     INTO DP013-MESSAGE-TEXT (3)  52300004
523100                 STRING ' ARRIVAL DATE= '                         52310004
523200                          PV-CA-ARRIVAL-DTE                       52320004
523300                          DELIMITED BY SIZE                       52330004
523400                                     INTO DP013-MESSAGE-TEXT (4)  52340004
523500                 MOVE SQLCA            TO DP013-SQLCA             52350000
523600                 MOVE 'TVHTRIP'        TO DP013-DB2-TABLE-NAME (1)52360000
523700                 MOVE 'TSHPTPO'        TO DP013-DB2-TABLE-NAME (2)52370000
523800                 MOVE 'TSHIPMT'        TO DP013-DB2-TABLE-NAME (3)52380000
523900                 MOVE 'TTRIPST'        TO DP013-DB2-TABLE-NAME (4)52390000
524000                 MOVE 'TTRSTYP'        TO DP013-DB2-TABLE-NAME (5)52400000
524100                 SET DP013-DB2-ABEND   TO TRUE                    52410000
524200                 SET DP013-XCTL-DISPLAY-RESTART                   52420000
524300                                       TO TRUE                    52430000
524400                 PERFORM DP013-0000-PROCESS-ABEND                 52440000
524500         END-EVALUATE                                             52450000
524600     END-IF.                                                      52460000
524700                                                                  52470000
524800/                                                                 52480000
524900*----------------------------------------------------------------*52490000
525000*    START TRANID FOR RCKCS226 (PRINT MANIFEST).                 *52500000
525100*----------------------------------------------------------------*52510000
525200 7400-FORMAT-COMMAREA.                                            52520000
525300                                                                  52530000
525400     MOVE ASC-OWNER-SCAC-ID      TO PV-CA-SCAC-CDE.               52540000
525500     MOVE ASC-VEH-NBR            TO PV-CA-VEH-NBR.                52550000
525600     MOVE ASC-ARRIVAL-DTE-ISO    TO PV-CA-ARRIVAL-DTE.            52560000
525700     MOVE ASC-PRINTER-ID         TO PV-CA-PRINTER.                52570000
525800     MOVE ASC-TRIP-ID            TO PV-CA-TRIP-ID.                52580000
525900     MOVE DP020-USERID           TO PV-CA-USERID.                 52590000
526000     MOVE ASC-PRTR-AUTO-CUTTER-IND                                52600000
526100                                 TO  PV-CA-PRTR-AUTO-CUTTER-IND.  52610000
526200     MOVE ASC-PRTR-BARCODE-IND   TO  PV-CA-PRTR-BARCODE-IND.      52620000
526300     MOVE ASC-PRTR-PRTR-CNTL-IND TO  PV-CA-PRTR-PRTR-CNTL-IND.    52630000
526400     MOVE ASC-PRTR-TRACK-NBR     TO  PV-CA-PRTR-TRACK-NBR.        52640000
526500     SET  PV-NOT-PRINT-PACKAGE   TO  TRUE.                        52650000
526600                                                                  52660000
526700                                                                  52670000
526800*----------------------------------------------------------------*52680000
526900*    START TRANID FOR RCKCS226 (PRINT MANIFEST).                 *52690000
527000*----------------------------------------------------------------*52700000
527100 7500-START-TRANID-E226.                                          52710000
527200                                                                  52720000
527300* ************************************************************** *52730000
527400* * PURGE-ARCHIVE-RETRIEVAL (PAR) PROJECT:                     * *52740000
527500* * CHECK PACKAGE INDICATOR IN DETERMIMING WHICH TRAN ID TO    * *52750000
527600* * START. (MULTIPLE TRAN IDS AND MNEMONICS ASSOCIATED WITH    * *52760000
527700* * THE PROGRAM TO BE STARTED; THESE DETERMINE WHICH SET OF    * *52770000
527800* * DB2 TABLES WILL BE ACCESSED: REGULAR OR ARCHIVED HISTORY.) * *52780000
527900* ************************************************************** *52790000
528000     IF DP020-SRC-DB2-PKG-ARCHIVE                                 52800000
528100         EXEC CICS                                                52810000
528200              START TRANSID ('EC26')                              52820000
528300                   FROM     (PV-RCKCS226-COMMAREA)                52830000
528400         END-EXEC                                                 52840000
528500     ELSE                                                         52850000
528600         EXEC CICS                                                52860000
528700              START TRANSID ('E226')                              52870000
528800                   FROM     (PV-RCKCS226-COMMAREA)                52880000
528900         END-EXEC                                                 52890000
529000     END-IF.                                                      52900000
529100                                                                  52910000
529200                                                                  52920000
529300 7600-READ-DUPL-TVHTRIP.                                          52930000
529400                                                                  52940000
529500     PERFORM                                                      52950000
529600         WITH TEST AFTER                                          52960000
529700         VARYING PV-RETRY-COUNTER                                 52970000
529800         FROM 1 BY 1                                              52980000
529900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               52990000
530000             OR (SQLCODE = +0))                                   53000000
530100                                                                  53010000
530200         EXEC SQL                                                 53020000
530300              SELECT COUNT(*)                                     53030000
530400               INTO :PV-VHTRIP-COUNT                              53040000
530500                FROM  TVHTRIP                                     53050000
530600               WHERE (TRIP_ID         = :PV-CURR-TRIP-ID)         53060000
530700         END-EXEC                                                 53070000
530800                                                                  53080000
530900         EVALUATE TRUE                                            53090000
531000             WHEN SQLCODE = +0                                    53100000
531100             WHEN SQLCODE = -904                                  53110000
531200             WHEN SQLCODE = -913                                  53120000
531300                 CONTINUE                                         53130000
531400                                                                  53140000
531500             WHEN SQLWARN0 NOT = SPACES                           53150000
531600             WHEN SQLCODE < +0                                    53160000
531700             WHEN SQLCODE > +0                                    53170000
531800                 MOVE '7600-READ-DUPL-TVHTRIP'                    53180000
531900                                   TO DP013-PARAGRAPH             53190000
532000                 MOVE 'GET COUNT OF TRIPS'                        53200000
532100                                   TO DP013-MESSAGE-TEXT(1)       53210000
532200                 MOVE SQLCA        TO DP013-SQLCA                 53220000
532300                 MOVE 'TVHTRIP'    TO DP013-DB2-TABLE-NAME (1)    53230000
532400                 SET DP013-DB2-ABEND                              53240000
532500                     DP013-XCTL-DISPLAY-RESTART TO TRUE           53250000
532600                 PERFORM DP013-0000-PROCESS-ABEND                 53260000
532700         END-EVALUATE                                             53270000
532800     END-PERFORM.                                                 53280000
532900                                                                  53290000
533000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    53300000
533100         SQLCODE NOT = +0                                         53310000
533200         MOVE '7600-READ-DUPL-TVHTRIP'                            53320000
533300                                   TO DP013-PARAGRAPH             53330000
533400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              53340000
533500                                   TO DP013-MESSAGE-TEXT (1)      53350000
533600         MOVE 'TO COUNT TVHTRIP ROWS'                             53360000
533700                                   TO DP013-MESSAGE-TEXT (2)      53370000
533800         MOVE SQLCA                TO DP013-SQLCA                 53380000
533900         MOVE 'TVHTRIP'            TO DP013-DB2-TABLE-NAME (1)    53390000
534000         SET DP013-DB2-ABEND                                      53400000
534100             DP013-XCTL-DISPLAY-RESTART                           53410000
534200                                   TO TRUE                        53420000
534300         PERFORM DP013-0000-PROCESS-ABEND                         53430000
534400     END-IF.                                                      53440000
534500                                                                  53450000
534600 9903-WRITE-CICS-LOG.                                             53460000
534700                                                                  53470000
534800     EXEC CICS                                                    53480000
534900         WRITEQ TD                                                53490000
535000             QUEUE  ('CSSL')                                      53500000
535100             FROM   (PV-CICS-MSG-AREA)                            53510000
535200             RESP   (PV-CICS-RESP)                                53520000
535300     END-EXEC.                                                    53530000
535400     MOVE SPACES                  TO PV-CICS-MSG-AREA.            53540000
535500                                                                  53550000
535600 9900-SOFT-ABORT.                                                 53560000
535700     SET PS-ERROR                                                 53570000
535800         DP020-MSG-FATAL  TO TRUE.                                53580000
535900                                                                  53590000
536000     EXEC CICS SYNCPOINT                                          53600000
536100          ROLLBACK                                                53610000
536200     END-EXEC.                                                    53620000
536300                                                                  53630000
536400     MOVE 'PROGRAM EXIT CALL' TO DP013-MESSAGE-TEXT (1).          53640000
536500     PERFORM 0001-CALL-CICS-ARCH-API.                             53650000
536600                                                                  53660000
536700/                                                                 53670000
536800*----------------------------------------------------------------*53680000
536900*    ABEND PROCESSOR MODULE                                      *53690000
537000*----------------------------------------------------------------*53700000
537100                                                                  53710000
537200     COPY DPPD013.                                                53720000
537300                                                                  53730000
