000100 IDENTIFICATION DIVISION.                                         00010077
000200                                                                  00020077
000300 PROGRAM-ID.    IMKUP033.                                         00030077
000400 AUTHOR.        PAUL KEBER.                                       00040077
000500 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00050077
000600 DATE-WRITTEN.  04/30/2003.                                       00060077
000700 DATE-COMPILED.                                                   00070077
000800                                                                  00080077
000900******************************************************************00090077
000910*     ## THIS PROGRAM MUST NEVER BE RUN AGAINST PRODUCTION ##    *00091077
000920*                                                                *00092077
001000*   IMKUP033 - INSERT OR UPDATE VSM DB2TDBA TEST DATA            *00100077
001001*                                                                *00100177
001002*     ## THIS PROGRAM MUST NEVER BE RUN AGAINST PRODUCTION ##    *00100277
001100******************************************************************00110077
001200* CHANGE LOG:                                                     00120077
001300* 06/17/2003 P.KEBER  CHANGES TO MAINTAIN TSKST AND TPPCPRC.      00130077
001400* 10/23/2003 P.KEBER  CHANGES TO POPULATE KY_CLSN_SEQ_NBR WITH    00140077
001500*                     THE PROD VALUE OF WS-MDARVS-SLHTT-SEQ-NBR   00150077
001600*                     AND REMOVE OBSOLETE TMDARVS TRND_SEQ_NBR.   00160077
001700* 01/22/2004 P.KEBER  CHANGES TO ADD NEW TMDARVS FIELDS.          00170077
001800* 02/03/2004 P.KEBER  CHANGES TO ADD ERROR PROCESSING DISPLAYS.   00180077
001900* 04/21/2004 P.KEBER  CHANGES TO HANDLE TEXTENT AND TVSCHVL ADDS. 00190077
002000* 05/11/2004 P.KEBER  ADD MAP_UNT_RTL_AMT TO TMDARVS UNLOAD.      00200077
002100* 06/14/2004 P.KEBER  POPULATE LOC_NBR FROM STORE_NMBR ON TSKST.  00210077
002200* 07/21/2004 P.KEBER  ADD LOC_NBR AND LAST_UPD_TMST TO TSKST.     00220077
002300* 12/13/2004 P.KEBER  ADD LOGIC TO RECLASS STYLES.                00230077
002400* 06/09/2005 P.KEBER  REMOVE STORE_NMBR, MDL_STOCK_UNIT_QTY,      00240077
002500*                     INV_CUTOFF_OH_QTY,POST_FL_AFT_REC FROM TSKST00250077
002600* 09/14/2005 P.KEBER  ADD C_O_ORGN_CDE TO TMDARVS. ADD TABLE      00260077
002700*                     IMT_STYL_PRTNR.                             00270077
002800* 10/04/2005 P.KEBER  ADD ORIG_CLR_DTE AND MKDN_CDE TO TUPCPLS.   00280077
002900* 01/16/2006 P.KEBER  ADD PRIC_TIER_SEQ_NBR AND LFSTYL_SEQ_NBR    00290077
003000*            TO TMDARVS.  ADD TRNSTN_IND TO TUPC.                 00300077
003100* 09/28/2006 P.KEBER  ADD IMT_LBL TABLE PROCESSING.               00310077
003200* 10/12/2006 P.KEBER  PREVENT SKU LOC CHANGES BEFORE A SKU ADD.   00320077
003300* 04/04/2007 P.KEBER  TUPC TYPE CODE CHECKS.                      00330077
003400* 04/30/2007 P.KEBER  ADD CUST_INTFC_DESC TO TMDARVS.             00340077
003500* 05/24/2007 P.KEBER  CHANGES TO MAINTAIN TVNDDPT.                00350077
003600* 06/15/2007 P.KEBER  TMDSEAR CHANGES TO HANDLE MDSEAR_DKEY DIFFS.00360077
003700* 08/02/2007 P.KEBER  ADD NEW TWEBITM COLUMNS.                    00370077
003800* 10/25/2007 D.THEEL  ADD NEW TUPC PO_SHRT_CYC_IND AND TWEBITM    00380077
003900*                        WEB_EXCLV_IND.                           00390077
004000* 03/27/2009 D.STEFFE RECOMPILE TO PICK UP NEW WS-ENTNME.         00400077
004100* 08/15/2010 B.GRAHAM - KFORCE   ADD TMDARVS AND TUPC COLUMNS     00410077
004200*                       WR35681, WR37044, WR37184, WR38861        00420077
004510* 08/10/2022  J KURK  - RECOMPILE FOR COPYBOOK DSPD002            00420179
004201******************************************************************00420277
004202 ENVIRONMENT DIVISION.                                            00420377
004203                                                                  00420477
004204 INPUT-OUTPUT SECTION.                                            00420577
004205                                                                  00420677
004206 FILE-CONTROL.                                                    00420777
004207                                                                  00420877
004208     SELECT PO-NBR-FILE                                           00420977
004209         ASSIGN         TO UT-S-PO01.                             00421077
004210     SELECT TBLE-FILE                                             00421177
004211         ASSIGN         TO UT-S-TBL01.                            00421277
004212     SELECT EXTRA-TBLE-FILE                                       00421377
004213         ASSIGN         TO UT-S-TBL02.                            00421477
004214     SELECT CONTROL-FILE                                          00421577
004215         ASSIGN         TO UT-S-CTL01.                            00421677
004216                                                                  00421777
004217 DATA DIVISION.                                                   00421877
004218                                                                  00421977
004219 FILE SECTION.                                                    00422077
004220******************************************************************00422177
004230     COPY DSFD001.                                                00423077
004240                                                                  00424077
004250 FD  EXTRA-TBLE-FILE                                              00425077
004260     LABEL RECORDS  ARE STANDARD                                  00426077
004270     RECORD IS VARYING FROM 75 TO 1075                            00427077
004280        DEPENDING ON DS009-RECORD-SIZE                            00428077
004290        RECORDING MODE IS V                                       00429077
004300        DATA RECORD  IS  EXTRA-TBLE-RECORD.                       00430077
004400 01  EXTRA-TBLE-RECORD.                                           00440077
004500     05  EXTRA-TBLE-ORDER            PIC  9(2).                   00450077
004600     05  EXTRA-TBLE-VERSION          PIC  9(2).                   00460077
004700     05  EXTRA-TBLE-NAME             PIC  X(18).                  00470077
004800     05  EXTRA-TBLE-DATA-SIZE        PIC  9(05) COMP-3.           00480077
004900     05  EXTRA-TBLE-KEYS             PIC  X(50).                  00490077
005000     05  EXTRA-TBLE-DATA-ITEM.                                    00500077
005100         10 EXTRA-TBLE-DATA          PIC  X(01)                   00510077
005200                                     OCCURS 0 TO 1000             00520077
005300                                     DEPENDING ON                 00530077
005400                                     DS009-TBLE-DATA-SIZE.        00540077
005500                                                                  00550077
005600 WORKING-STORAGE SECTION.                                         00560077
005700     COPY DSRD002.                                                00570077
005800     COPY DSWS008.                                                00580077
005900     COPY DSWS009.                                                00590077
006000     COPY DSWS010.                                                00600077
006100     COPY DPWS004.                                                00610077
006200                                                                  00620077
006210 01  PC-CONSTANTS.                                                00621077
006220     05  PC-90                       PIC S9(04)    COMP           00622077
006230                                                   VALUE 90.      00623077
006240     05  PC-A                        PIC  X(01)    VALUE 'A'.     00624077
006250     05  PC-Y                        PIC  X(01)    VALUE 'Y'.     00625077
006260     05  PC-RCV                      PIC  X(03)    VALUE 'RCV'.   00626077
006270     05  PC-KHL                      PIC  X(03)    VALUE 'KHL'.   00627077
006280     05  PC-PRDCHK                   PIC  X(06)    VALUE 'PRDCHK'.00628077
006290     05  PC-PARM-TEXT                PIC  X(25)    VALUE          00629077
006291         'LOWER LEVEL ONLY         '.                             00629177
006292     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          00629277
006293         'IMKUP033'.                                              00629377
006294                                                                  00629477
006295 01  WS-LOCAL-SERVER.                                             00629577
006296     05  WS-SUBSYS                   PIC X(04)  VALUE SPACES.     00629677
006297     05  FILLER                      PIC X(12)  VALUE SPACES.     00629777
006298                                                                  00629877
006300 01  OTHER-SWITCHES.                                              00630077
006400     05  PS-TUPCPLS-DIFFS-SW          PIC X VALUE SPACE.          00640077
006500         88  PS-TUPCPLS-DIFFS               VALUE 'Y'.            00650077
006600         88  PS-TUPCPLS-NO-DIFFS            VALUE 'N'.            00660077
006700     05  PS-TUPCPLS-PROD-NEWER-SW     PIC X VALUE SPACE.          00670077
006800         88  PS-TUPCPLS-PROD-NEWER          VALUE 'Y'.            00680077
006900         88  PS-TUPCPLS-PROD-NOT-NEWER      VALUE 'N'.            00690077
007000     05  PS-END-OF-RECLASS-STYLES-SW  PIC X VALUE SPACE.          00700077
007100         88  PS-END-OF-RECLASS-STYLES       VALUE 'Y'.            00710077
007200         88  PS-NOT-END-OF-RECLASS-STYLES   VALUE 'N'.            00720077
007300     05  PS-STYLE-RECLASSED-SW        PIC X VALUE SPACE.          00730077
007400         88  PS-STYLE-RECLASSED             VALUE 'Y'.            00740077
007500         88  PS-STYLE-NOT-RECLASSED         VALUE 'N'.            00750077
007600                                                                  00760077
007700 01  OTHER-VARIABLES.                                             00770077
007800     05  PV-DOUBLE-COMP               PIC S9(15) COMP VALUE +0.   00780077
007900     05  PV-ONE                       PIC S9(9) COMP VALUE +0.    00790077
008000     05  PV-VNDSTL-EFF-END-DTE-NN     PIC S9(4) COMP VALUE +0.    00800077
008100     05  PV-UPC-EFF-END-DTE-NN        PIC S9(4) COMP VALUE +0.    00810077
008200     05  PV-UPCPLS-EFF-END-TMST-NN    PIC S9(4) COMP VALUE +0.    00820077
008300     05  PV-UPCPLS-UPC-STAT-CDE-NN    PIC S9(4) COMP VALUE +0.    00830077
008400     05  PV-UPCPLS-UNT-COST-AMT-NN    PIC S9(4) COMP VALUE +0.    00840077
008500     05  PV-UPCPLS-UNT-RTL-AMT-NN     PIC S9(4) COMP VALUE +0.    00850077
008600     05  PV-UPCPLS-MEITGP-NBR-NN      PIC S9(4) COMP VALUE +0.    00860077
008700     05  PV-WEBITM-EFF-END-TMST-NN    PIC S9(4) COMP VALUE +0.    00870077
008800     05  PV-HOLD-STR-NBR              PIC S9(4) COMP VALUE +0.    00880077
008900     05  PV-SKST-NUM-STORE-NMBR       PIC  9(3) VALUE ZERO.       00890077
009000     05  PV-MDSEAR-DKEY               PIC S9(6)V COMP-3 VALUE +0. 00900077
009100     05  PV-HOLD-TSKST-ITEM-NBR       PIC S9(15) COMP-3 VALUE +0. 00910077
009200     05  PV-HOLD-TPPCPRC-ITEM-NBR     PIC S9(15) COMP-3 VALUE +0. 00920077
009300     05  PV-MDARVS-ACTV-IND           PIC X(01)  VALUE SPACE.     00930077
009400     05  PV-CURRENT-TIMESTAMP         PIC X(26)  VALUE SPACES.    00940077
009500     05  PV-READ-COUNT                PIC S9(09) COMP-3 VALUE     00950077
009600                                                        ZERO.     00960077
009700     05  PV-TOTAL-DELETES             PIC S9(09) COMP-3 VALUE     00970077
009800                                                        ZERO.     00980077
009900     05  PV-TOTAL-INSERTS             PIC S9(09) COMP-3 VALUE     00990077
010000                                                        ZERO.     01000077
010100     05  PV-TOTAL-UPDATES             PIC S9(09) COMP-3 VALUE     01010077
010200                                                        ZERO.     01020077
010300     05  PV-WHEN-COMPILED.                                        01030077
010400         10  PV-COMPILE-DATE          PIC X(08).                  01040077
010500         10  PV-COMPILE-TIME          PIC X(08).                  01050077
010501                                                                  01050177
010502     05  PV-HOLD-STRUCTURE-2.                                     01050277
010503         10  FILLER                   PIC X(03)  VALUE 'KY='.     01050377
010504         10  PV-HOLD-STRUCT2-KEY      PIC 9(15)  VALUE ZERO.      01050477
010505                                                                  01050577
010506 01  WS-CNTL-FILE.                                                01050677
010507     05 WS-CNTL-RECORDS                                           01050777
010508         OCCURS 200 TIMES                                         01050877
010509         INDEXED BY WS-CNTL-SRCH-IDX                              01050977
010510                    WS-CNTL-I.                                    01051077
010520         10 WS-CNTL-TABLE             PIC X(18).                  01052077
010530         10 WS-CNTL-UPDATE-COUNT      PIC S9(07) COMP-3.          01053077
010540                                                                  01054077
010550******************************************************************01055077
010560*  COMMUNICATIONS AREA FOR PROD TO TEST UTILITIES                 01056077
010570******************************************************************01057077
010580     COPY DSWS011.                                                01058077
010590*                                                                 01059077
010600*    DB2 AREA FOR SYSDUMMY1                                       01060077
010700                                                                  01070077
010800     EXEC SQL                                                     01080077
010900          INCLUDE SYSDUMMY                                        01090077
011000     END-EXEC.                                                    01100077
011100                                                                  01110077
011200***************************************************************** 01120077
011300*   CURSOR FOR SELECTING A STYLE THAT NEEDS TO BE RECLASSED       01130077
011400***************************************************************** 01140077
011500     EXEC SQL                                                     01150077
011600         DECLARE RECLASS_STYLE_CSR CURSOR FOR                     01160077
011700             SELECT SUB_CL_MDSEAR_ID                              01170077
011800             FROM TMDARVS                                         01180077
011900             WHERE RMS_STYL_ID = :MDARVS-RMS-STYL-ID              01190077
012000               AND SUB_CL_MDSEAR_ID <> :HOLD-SUB-CL-MDSEAR-ID     01200077
012100               AND VS_ID       = :HOLD-VS-ID                      01210077
012200               AND ACTV_IND    = 'Y'                              01220077
012300     END-EXEC.                                                    01230077
012400                                                                  01240077
012500 PROCEDURE DIVISION.                                              01250077
012600                                                                  01260077
012700 A100-MAINLINE.                                                   01270077
012800                                                                  01280077
012900     MOVE WHEN-COMPILED TO PV-WHEN-COMPILED.                      01290077
013000     DISPLAY '***  NEW VERSION  ***'.                             01300077
013100     DISPLAY 'COMPILE DATE: ' PV-COMPILE-DATE                     01310077
013200             ' ' PV-COMPILE-TIME.                                 01320077
013310                                                                  01331077
013320     PERFORM 1100-GET-DB2-INSTANCE.                               01332077
013330     PERFORM 1200-CHECK-IF-PRODUCTION.                            01333077
013340                                                                  01334077
013400     SET DS009-I-PGM TO TRUE.                                     01340077
013500     PERFORM DS002-INITIAL-PROCESSING.                            01350077
013600                                                                  01360077
013700     PERFORM VARYING CNTL-I FROM 1 BY 1 UNTIL                     01370077
013800           CNTL-I > CNTL-SUB-MAX OR CNTL-I > CNTL-SUB-LIMIT       01380077
013900         IF NOT (CNTL-TABLE(CNTL-I) = 'TEXTENT' OR 'TENTNME'      01390077
014000                 OR 'TVNDSTL' OR 'TMDARVS' OR 'TUPC' OR 'TUPCPLS' 01400077
014100                 OR 'TSK' OR 'TSKXREF' OR 'TUPCSKU' OR 'TWEBITM'  01410077
014200                 OR 'TMDSEAR' OR 'TSKST' OR 'TPPCPRC'             01420077
014300                 OR 'TVSCHVL' OR 'IMT_STYL_PRTNR' OR 'IMT_LBL'    01430077
014400                 OR 'TVNDDPT')                                    01440077
014500             MOVE SPACES TO CNTL-TABLE(CNTL-I)                    01450077
014600         END-IF                                                   01460077
014700         SET WS-CNTL-I TO CNTL-I                                  01470077
014800         MOVE CNTL-TABLE(CNTL-I) TO WS-CNTL-TABLE(WS-CNTL-I)      01480077
014900         MOVE ZERO TO WS-CNTL-UPDATE-COUNT (WS-CNTL-I)            01490077
015000     END-PERFORM.                                                 01500077
015100                                                                  01510077
015200     PERFORM B100-PROCESSING                                      01520077
015300         UNTIL TABLE-EOF.                                         01530077
015400                                                                  01540077
015500     OPEN  INPUT  EXTRA-TBLE-FILE.                                01550077
015600     SET NOT-TABLE-EOF TO TRUE.                                   01560077
015700     PERFORM B200-EXTRA-PROCESSING                                01570077
015800         UNTIL TABLE-EOF.                                         01580077
015900                                                                  01590077
016000     PERFORM 9000-DUMP-COUNT-TABLE.                               01600077
016100                                                                  01610077
016200     PERFORM DS002-END-OF-JOB.                                    01620077
016300     CLOSE EXTRA-TBLE-FILE.                                       01630077
016400                                                                  01640077
016500     GOBACK.                                                      01650077
016600                                                                  01660077
016700/                                                                 01670077
016800***************************************************************** 01680077
016900*     FOR EACH TABLE, DELETE ANY EXISTING DATA AND THEN INSERT    01690077
017000*     THE DATA FROM THE FILE, OR UPDATE THE DATA.                 01700077
017100***************************************************************** 01710077
017200 B100-PROCESSING.                                                 01720077
017300*                                                                 01730077
017400     READ TBLE-FILE INTO DS002-RECORD                             01740077
017500         AT END                                                   01750077
017600             SET TABLE-EOF TO TRUE                                01760077
017700         NOT AT END                                               01770077
017800             ADD 1 TO PV-READ-COUNT                               01780077
017900     END-READ.                                                    01790077
018000                                                                  01800077
018100     IF NOT-TABLE-EOF                                             01810077
018200        MOVE DS002-DATA-SIZE TO DS009-TBLE-DATA-SIZE              01820077
018300        MOVE DS002-NAME TO DS009-PROCESS-TABLE                    01830077
018400        MOVE DS002-KEYS TO DS009-PKYS                             01840077
018500        PERFORM DS002-DO-PROCESS                                  01850077
018600                                                                  01860077
018700        IF DS009-DO-PROCESS                                       01870077
018800        EVALUATE TRUE                                             01880077
018900         WHEN DS009-PROCESS-TABLE = 'TMDSEAR'                     01890077
019000             MOVE DS002-DATA-ITEM TO WS-MDSEAR                    01900077
019100             MOVE WS-MDSEAR-MDSEAR-DKEY TO                        01910077
019200                  HOLD-SUB-CL-MDSEAR-ID                           01920077
019300             PERFORM R300-SELECT-TMDSEAR-DKEY                     01930077
019400             IF SQLCODE = +100                                    01940077
019500                 PERFORM R301-SELECT-TMDSEAR-LIST-SEQ             01950077
019600                 IF SQLCODE = +100                                01960077
019700                     PERFORM R200-INSERT                          01970077
019800                 ELSE                                             01980077
019900                     PERFORM B300-MDSEAR-DKEY-CHANGE              01990077
020000                 END-IF                                           02000077
020100             END-IF                                               02010077
020200         WHEN DS009-PROCESS-TABLE = 'TEXTENT'                     02020077
020300             MOVE DS002-DATA-ITEM TO WS-EXTENT                    02030077
020400             MOVE WS-EXTENT-ENT-ID        TO HOLD-ENT-ID          02040077
020500             PERFORM R305-SELECT-TEXTENT                          02050077
020600             IF SQLCODE = +100                                    02060077
020700                 PERFORM R200-INSERT                              02070077
020800             END-IF                                               02080077
020900         WHEN DS009-PROCESS-TABLE = 'TENTNME'                     02090077
021000             MOVE DS002-DATA-ITEM TO WS-ENTNME                    02100077
021100             MOVE WS-ENTNME-ENT-ID        TO HOLD-ENT-ID          02110077
021200             MOVE WS-ENTNME-SEQ-NBR       TO HOLD-ENTNME-SEQ-NBR  02120077
021300             PERFORM R100-DELETE                                  02130077
021400             PERFORM R200-INSERT                                  02140077
021500         WHEN DS009-PROCESS-TABLE = 'TVNDDPT'                     02150077
021600             MOVE DS002-DATA-ITEM TO WS-VNDDPT                    02160077
021700             MOVE WS-VNDDPT-ENT-ID        TO HOLD-ENT-ID          02170077
021800             MOVE WS-VNDDPT-DEPT-NBR      TO HOLD-DEPT-NBR        02180077
021900             PERFORM R355-SELECT-TVNDDPT                          02190077
022000             IF SQLCODE = +100                                    02200077
022100                 PERFORM R200-INSERT                              02210077
022200             ELSE                                                 02220077
022300*                UPDATE ALL FIELDS ON THE TVNDDPT ROW             02230077
022400                 PERFORM U160-UPDATE-TVNDDPT                      02240077
022500             END-IF                                               02250077
022600         WHEN DS009-PROCESS-TABLE = 'TVSCHVL'                     02260077
022700             MOVE DS002-DATA-ITEM TO WS-VSCHVL                    02270077
022800             MOVE WS-VSCHVL-CHARTC-CDE    TO HOLD-CHARTC-CDE      02280077
022900             MOVE WS-VSCHVL-CHARTC-SEQ-NBR TO HOLD-CHARTC-SEQ-NBR 02290077
023000             PERFORM R315-SELECT-TVSCHVL                          02300077
023100             IF SQLCODE = +100                                    02310077
023200                 PERFORM R200-INSERT                              02320077
023300             END-IF                                               02330077
023400         WHEN DS009-PROCESS-TABLE = 'IMT_LBL'                     02340077
023500             MOVE DS002-DATA-ITEM TO DS008-DCLIMT00000            02350077
023600             MOVE DS008-IMT00-LBL-SEQ-NBR TO DS010-LBL-SEQ-NBR    02360077
023700             PERFORM R100-DELETE                                  02370077
023800             PERFORM R200-INSERT                                  02380077
023900         WHEN DS009-PROCESS-TABLE = 'TVNDSTL'                     02390077
024000             MOVE DS002-DATA-ITEM TO WS-VNDSTL                    02400077
024100             IF WS-VNDSTL-EFF-END-DTE-NN >= 0                     02410077
024101                 DISPLAY '*** NON-ACTIVE INPUT TVNDSTL ROW'       02410177
024102                 MOVE +4001       TO DS009-ABEND-CODE             02410277
024103                 PERFORM 9990-NON-SQL-ABEND                       02410377
024104             END-IF                                               02410477
024105             MOVE WS-VNDSTL-VS-ID TO HOLD-VS-ID                   02410577
024106             PERFORM R310-SELECT-TVNDSTL                          02410677
024107             IF SQLCODE = +100                                    02410777
024108                 PERFORM R200-INSERT                              02410877
024109             ELSE                                                 02410977
024110                 IF PV-VNDSTL-EFF-END-DTE-NN < 0                  02411077
024120*                    UPDATE ALL FIELDS ON AN ACTIVE TVNDSTL ROW   02412077
024130                     PERFORM U100-UPDATE-TVNDSTL                  02413077
024140                 ELSE                                             02414077
024150*                    DELETE AND REINSERT AN INACTIVE TVNDSTL ROW  02415077
024160                     PERFORM R100-DELETE                          02416077
024170                     PERFORM R200-INSERT                          02417077
024180                 END-IF                                           02418077
024190             END-IF                                               02419077
024200         WHEN DS009-PROCESS-TABLE = 'TMDARVS'                     02420077
024300             MOVE DS002-DATA-ITEM TO WS-MDARVS                    02430077
024400             IF WS-MDARVS-ACTV-IND = 'N'                          02440077
024401                 DISPLAY '*** NON-ACTIVE INPUT TMDARVS ROW'       02440177
024402                 MOVE +4002       TO DS009-ABEND-CODE             02440277
024403                 PERFORM 9990-NON-SQL-ABEND                       02440377
024404             END-IF                                               02440477
024405             MOVE WS-MDARVS-SUB-CL-MDSEAR-ID TO                   02440577
024406                  HOLD-SUB-CL-MDSEAR-ID                           02440677
024407             MOVE WS-MDARVS-VS-ID TO HOLD-VS-ID                   02440777
024408*            PROCESS INPUT TMDARVS RECORD                         02440877
024409             PERFORM R320-SELECT-TMDARVS                          02440977
024410             IF SQLCODE = +100                                    02441077
024420*                INACTIVATE ANY STYLES FOR AN RMS STYLE ID THAT   02442077
024430*                NEED TO BE RECLASSED.                            02443077
024440                 MOVE WS-MDARVS-RMS-STYL-ID TO MDARVS-RMS-STYL-ID 02444077
024450                 SET PS-NOT-END-OF-RECLASS-STYLES TO TRUE         02445077
024460                 SET PS-STYLE-NOT-RECLASSED TO TRUE               02446077
024470                 PERFORM R325-OPEN-RECLASS-STYLE-CSR              02447077
024480                 PERFORM R326-FETCH-RECLASS-STYLE-CSR             02448077
024490                 PERFORM B110-PROCESS-RECLASS-STYLES              02449077
024500                   UNTIL PS-END-OF-RECLASS-STYLES                 02450077
024600                 PERFORM R327-CLOSE-RECLASS-STYLE-CSR             02460077
024700                 MOVE WS-MDARVS-SUB-CL-MDSEAR-ID TO               02470077
024800                      HOLD-SUB-CL-MDSEAR-ID                       02480077
024900*                PROCEED WITH EITHER A STYLE RECLASS OR INSERT    02490077
025000                 IF PS-STYLE-RECLASSED                            02500077
025100                     MOVE 'Y' TO PV-MDARVS-ACTV-IND               02510077
025200                     PERFORM R200-INSERT                          02520077
025300                 ELSE                                             02530077
025400                     MOVE 'N' TO PV-MDARVS-ACTV-IND               02540077
025500                     PERFORM R200-INSERT                          02550077
025600                     PERFORM U115-UPDATE-TMDARVS-ACTV-IND         02560077
025700                 END-IF                                           02570077
025800             ELSE                                                 02580077
025900                 IF MDARVS-ACTV-IND = 'Y'                         02590077
026000*                    UPDATE ALL FIELDS ON AN ACTIVE TMDARVS ROW   02600077
026100                     PERFORM U110-UPDATE-TMDARVS                  02610077
026200*                    DELETE ALL IMT_STYL_PRTNR ROWS FOR THE STYLE 02620077
026300                     MOVE 'IMT_STYL_PRTNR' TO DS009-PROCESS-TABLE 02630077
026400                                              DS002-NAME          02640077
026500                     PERFORM R100-DELETE                          02650077
026600                     MOVE 'TMDARVS' TO DS009-PROCESS-TABLE        02660077
026700                                       DS002-NAME                 02670077
026800                 ELSE                                             02680077
026900*                    DELETE AND REINSERT AN INACTIVE TMDARVS ROW  02690077
027000*                    DELETES ALL IMT_STYL_PRTNR ROWS FOR THE STYLE02700077
027100                     PERFORM R100-DELETE                          02710077
027200                     MOVE 'N' TO PV-MDARVS-ACTV-IND               02720077
027300                     PERFORM R200-INSERT                          02730077
027400                     PERFORM U115-UPDATE-TMDARVS-ACTV-IND         02740077
027500                 END-IF                                           02750077
027600             END-IF                                               02760077
027700         WHEN DS009-PROCESS-TABLE = 'TUPC'                        02770077
027800             MOVE DS002-DATA-ITEM TO WS-UPC                       02780077
027900*            ONLY PROCESS INTERNAL UPCS FROM THE FIRST TABLE FILE 02790077
028000             IF WS-UPC-UPC-TYP-CDE = 'I'                          02800077
028100                 MOVE WS-UPC-UPC-ID   TO HOLD-UPC-ID              02810077
028200                 PERFORM R330-SELECT-TUPC                         02820077
028300                 IF SQLCODE = +100                                02830077
028400                     PERFORM R200-INSERT                          02840077
028500                 ELSE                                             02850077
028600                     IF PV-UPC-EFF-END-DTE-NN < 0                 02860077
028700                       AND WS-UPC-UPC-TYP-CDE = UPC-UPC-TYP-CDE   02870077
028800*                        UPDATE ALL FIELDS ON AN ACTIVE TUPC ROW  02880077
028900*                        IF IT IS THE SAME UPC TYPE               02890077
029000                         PERFORM U120-UPDATE-TUPC                 02900077
029100                     ELSE                                         02910077
029200*                        DELETE AN INACTIVE TUPC ROW AND INSERT A 02920077
029300*                        NEW ACTIVE TUPC ROW                      02930077
029400                         PERFORM R100-DELETE                      02940077
029500                         PERFORM R200-INSERT                      02950077
029600                     END-IF                                       02960077
029700                 END-IF                                           02970077
029701             END-IF                                               02970177
029702         WHEN DS009-PROCESS-TABLE = 'TUPCPLS'                     02970277
029703             MOVE DS002-DATA-ITEM TO WS-UPCPLS                    02970377
029704*            ONLY PROCESS STORE ZERO ROWS FROM THE 1ST TABLE FILE 02970477
029705             IF WS-UPCPLS-STR-NBR = 0                             02970577
029706                 MOVE WS-UPCPLS-UPC-ID TO HOLD-UPC-ID             02970677
029707                 MOVE WS-UPCPLS-STR-NBR TO PV-HOLD-STR-NBR        02970777
029708                 PERFORM R340-SELECT-TUPCPLS                      02970877
029709                 IF SQLCODE = +100                                02970977
029710                     PERFORM R200-INSERT                          02971077
029720                 ELSE                                             02972077
029730                     IF PV-UPCPLS-EFF-END-TMST-NN < 0             02973077
029740*                        IF AN ACTIVE TUPCPLS ROW IS FOUND WITH   02974077
029750*                        DIFFERENT ATTRIBUTES, EXPIRE THE ACTIVE  02975077
029760*                        ROW AND INSERT A NEW ACTIVE STORE 0 ROW  02976077
029770                         PERFORM C104-CHECK-TUPCPLS-FIELDS        02977077
029780                         IF PS-TUPCPLS-DIFFS                      02978077
029790                             IF PS-TUPCPLS-PROD-NEWER             02979077
029800                                 MOVE WS-UPCPLS-ITM-NBR           02980077
029900                                       TO HOLD-ITM-NBR            02990077
030000                                 PERFORM R350-SELECT-TSKXREF      03000077
030100*                                IF SKU IS NOT SET UP, DELETE THE 03010077
030200*                                TUPCPLS ROW FOR THE OLD SKU      03020077
030300*                                BEFORE INSERTING A NEW ROW       03030077
030400                                 IF SQLCODE = +100                03040077
030500                                     PERFORM R100-DELETE          03050077
030600                                     PERFORM R200-INSERT          03060077
030700                                 ELSE                             03070077
030800                                   PERFORM U130-INACTIVATE-TUPCPLS03080077
030900                                     PERFORM R200-INSERT          03090077
031000                                 END-IF                           03100077
031100                             ELSE                                 03110077
031200                                 PERFORM U130-INACTIVATE-TUPCPLS  03120077
031300                                 PERFORM R200-INSERT              03130077
031400                             END-IF                               03140077
031500                         END-IF                                   03150077
031600                     ELSE                                         03160077
031700*                        DELETE INACTIVE STORE 0 ROWS AND INSERT A03170077
031800*                        NEW ACTIVE STORE 0 ROW                   03180077
031900                         PERFORM R100-DELETE                      03190077
032000                         PERFORM R200-INSERT                      03200077
032100                     END-IF                                       03210077
032200                 END-IF                                           03220077
032201             END-IF                                               03220177
032202         WHEN DS009-PROCESS-TABLE = 'TSK'                         03220277
032203             MOVE DS002-DATA-ITEM TO WS-SK                        03220377
032204             MOVE WS-TSK-ITEM-NMBR TO HOLD-ITEM-NBR               03220477
032205             PERFORM R100-DELETE                                  03220577
032206             PERFORM R200-INSERT                                  03220677
032207         WHEN DS009-PROCESS-TABLE = 'TSKXREF'                     03220777
032208             MOVE DS002-DATA-ITEM TO WS-SKXREF                    03220877
032209*            ONLY PROCESS INTERNAL UPC ROWS FROM THE FIRST TABLE  03220977
032210*            FILE                                                 03221077
032211             IF WS-SKXREF-SKU-STAT-CDE < '98'                     03221177
032212                 MOVE WS-SKXREF-ITM-NBR TO HOLD-ITM-NBR           03221277
032213                 PERFORM R350-SELECT-TSKXREF                      03221377
032214                 IF SQLCODE = +100                                03221477
032215                     PERFORM R200-INSERT                          03221577
032216                 ELSE                                             03221677
032217*                    UPDATE ALL FIELDS ON THE TSKXREF ROW         03221777
032218                     PERFORM U140-UPDATE-TSKXREF                  03221877
032219                 END-IF                                           03221977
032220             END-IF                                               03222077
032221         WHEN DS009-PROCESS-TABLE = 'TUPCSKU'                     03222177
032222             MOVE DS002-DATA-ITEM TO WS-UPCSKU                    03222277
032223             MOVE WS-TUPCSKU-UPC-NBR TO HOLD-UPC-NBR              03222377
032224             PERFORM R100-DELETE                                  03222477
032225             PERFORM R200-INSERT                                  03222577
032226         WHEN DS009-PROCESS-TABLE = 'TWEBITM'                     03222677
032227             MOVE DS002-DATA-ITEM       TO WS-WEBITM              03222777
032228             MOVE WS-WEBITM-INTR-UPC-ID TO HOLD-INTR-UPC-ID       03222877
032229             IF WS-WEBITM-EFF-END-TMST-NN < 0                     03222977
032230*                DELETE AND REINSERT AN ACTIVE TWEBITM ROW        03223077
032231                 PERFORM R100-DELETE                              03223177
032232                 PERFORM R200-INSERT                              03223277
032233             ELSE                                                 03223377
032234*                PROCESS AN INPUT INACTIVE TWEBITM ROW            03223477
032235                 PERFORM R360-SELECT-ACTIVE-TWEBITM               03223577
032236                 IF SQLCODE = ZERO                                03223677
032237*                    INACTIVATE THE ACTIVE TWEBITM ROW            03223777
032238                     PERFORM U150-INACTIVATE-TWEBITM              03223877
032239                 END-IF                                           03223977
032240             END-IF                                               03224077
032241         WHEN DS009-PROCESS-TABLE = 'TSKST'                       03224177
032242             MOVE DS002-DATA-ITEM TO WS-SKST                      03224277
032243             IF WS-SKST-ITEM-NMBR NOT = PV-HOLD-TSKST-ITEM-NBR    03224377
032244                 MOVE WS-SKST-ITEM-NMBR TO HOLD-ITEM-NBR          03224477
032245                 PERFORM R100-DELETE                              03224577
032246                 MOVE WS-SKST-ITEM-NMBR TO PV-HOLD-TSKST-ITEM-NBR 03224677
032247             END-IF                                               03224777
032248             PERFORM R200-INSERT                                  03224877
032249         WHEN DS009-PROCESS-TABLE = 'TPPCPRC'                     03224977
032250             MOVE DS002-DATA-ITEM TO WS-PPCPRC                    03225077
032260             IF WS-PPCPRC-TSK-ITM-NBR NOT =                       03226077
032261                   PV-HOLD-TPPCPRC-ITEM-NBR                       03226177
032262                 MOVE WS-PPCPRC-TSK-ITM-NBR TO HOLD-ITEM-NBR      03226277
032263                 PERFORM R100-DELETE                              03226377
032264                 MOVE WS-PPCPRC-TSK-ITM-NBR TO                    03226477
032265                       PV-HOLD-TPPCPRC-ITEM-NBR                   03226577
032266             END-IF                                               03226677
032267             PERFORM R200-INSERT                                  03226777
032268         WHEN DS009-PROCESS-TABLE = 'IMT_STYL_PRTNR'              03226877
032269             MOVE DS002-DATA-ITEM TO DS008-IMT00016-DATA          03226977
032270             PERFORM R200-INSERT                                  03227077
032280                                                                  03228077
032290         END-EVALUATE                                             03229077
032300                                                                  03230077
032400         PERFORM DS002-COMMIT                                     03240077
032500                                                                  03250077
032600        END-IF                                                    03260077
032601     END-IF.                                                      03260177
032602/                                                                 03260277
032603***************************************************************** 03260377
032604*     INACTIVATE ANY STYLES FOR AN RMS STYLE ID THAT NEED TO BE   03260477
032605*     RECLASSED.                                                  03260577
032606***************************************************************** 03260677
032607 B110-PROCESS-RECLASS-STYLES.                                     03260777
032608*                                                                 03260877
032609     MOVE MDARVS-SUB-CL-MDSEAR-ID TO HOLD-SUB-CL-MDSEAR-ID.       03260977
032610     PERFORM U116-TMDARVS-RECLASS-UPDATE.                         03261077
032620     PERFORM R326-FETCH-RECLASS-STYLE-CSR.                        03262077
032621     SET PS-STYLE-RECLASSED TO TRUE.                              03262177
032622/                                                                 03262277
032623***************************************************************** 03262377
032624*     FOR EACH TABLE, DELETE ANY EXISTING DATA AND THEN INSERT    03262477
032625*     THE DATA FROM THE FILE, OR UPDATE THE DATA.                 03262577
032626***************************************************************** 03262677
032627 B200-EXTRA-PROCESSING.                                           03262777
032628*                                                                 03262877
032629     READ EXTRA-TBLE-FILE INTO DS002-RECORD                       03262977
032630         AT END                                                   03263077
032640             SET TABLE-EOF TO TRUE                                03264077
032650         NOT AT END                                               03265077
032660             ADD 1 TO PV-READ-COUNT                               03266077
032670     END-READ.                                                    03267077
032671                                                                  03267177
032672     IF NOT-TABLE-EOF                                             03267277
032673        MOVE DS002-DATA-SIZE TO DS009-TBLE-DATA-SIZE              03267377
032674        MOVE DS002-NAME TO DS009-PROCESS-TABLE                    03267477
032675        MOVE DS002-KEYS TO DS009-PKYS                             03267577
032676        PERFORM DS002-DO-PROCESS                                  03267677
032677                                                                  03267777
032678        IF DS009-DO-PROCESS                                       03267877
032679        EVALUATE TRUE                                             03267977
032680         WHEN DS009-PROCESS-TABLE = 'TUPC'                        03268077
032690             MOVE DS002-DATA-ITEM TO WS-UPC                       03269077
032700*            PROCESS RENUMBERED AND VENDOR UPCS FROM THE SECOND   03270077
032800*            TABLE FILE                                           03280077
032900             MOVE WS-UPC-UPC-ID       TO HOLD-UPC-ID              03290077
033000             PERFORM R330-SELECT-TUPC                             03300077
033100             IF SQLCODE = +100                                    03310077
033200                 PERFORM R200-INSERT                              03320077
033300             ELSE                                                 03330077
033400                 IF PV-UPC-EFF-END-DTE-NN < 0                     03340077
033500                   AND WS-UPC-UPC-TYP-CDE = UPC-UPC-TYP-CDE       03350077
033600*                    UPDATE ALL FIELDS ON AN ACTIVE TUPC ROW      03360077
033700*                    IF IT IS THE SAME UPC TYPE                   03370077
033800                     PERFORM U120-UPDATE-TUPC                     03380077
033900                 ELSE                                             03390077
034000*                    DELETE AN INACTIVE TUPC ROW AND INSERT A NEW 03400077
034100*                    ACTIVE TUPC ROW                              03410077
034200                     PERFORM R100-DELETE                          03420077
034300                     PERFORM R200-INSERT                          03430077
034400                 END-IF                                           03440077
034401             END-IF                                               03440177
034402         WHEN DS009-PROCESS-TABLE = 'TUPCPLS'                     03440277
034403             MOVE DS002-DATA-ITEM TO WS-UPCPLS                    03440377
034404*            RESET CRE_BY_USR_ID SO THE TUPCPLS TRIGGER WILL FIRE 03440477
034405             MOVE 'IMKUP033'      TO WS-UPCPLS-CRE-BY-USR-ID      03440577
034406*            PROCESS ROWS WITH STORE > 0                          03440677
034407             MOVE WS-UPCPLS-UPC-ID TO HOLD-UPC-ID                 03440777
034408             MOVE WS-UPCPLS-STR-NBR TO PV-HOLD-STR-NBR            03440877
034409             PERFORM R340-SELECT-TUPCPLS                          03440977
034410             IF SQLCODE = +100                                    03441077
034420                 PERFORM R200-INSERT                              03442077
034430             ELSE                                                 03443077
034440                 IF PV-UPCPLS-EFF-END-TMST-NN < 0                 03444077
034450*                    IF AN ACTIVE TUPCPLS ROW IS FOUND WITH       03445077
034460*                    DIFFERENT ATTRIBUTES, EXPIRE THE ACTIVE      03446077
034470*                    ROW AND INSERT A NEW ACTIVE STORE ROW        03447077
034480                     PERFORM C104-CHECK-TUPCPLS-FIELDS            03448077
034490                     IF PS-TUPCPLS-DIFFS                          03449077
034500                         PERFORM U130-INACTIVATE-TUPCPLS          03450077
034600                         PERFORM R200-INSERT                      03460077
034700                     END-IF                                       03470077
034800                 ELSE                                             03480077
034900*                    DELETE INACTIVE STORE ROWS AND INSERT A NEW  03490077
035000*                    ACTIVE STORE ROW                             03500077
035100                     PERFORM R100-DELETE                          03510077
035200                     PERFORM R200-INSERT                          03520077
035300                 END-IF                                           03530077
035301             END-IF                                               03530177
035302         WHEN DS009-PROCESS-TABLE = 'TSKXREF'                     03530277
035303             MOVE DS002-DATA-ITEM TO WS-SKXREF                    03530377
035304*            PROCESS RENUMBERED SKU ROWS FROM THE 2ND TABLE FILE  03530477
035305             MOVE WS-SKXREF-ITM-NBR TO HOLD-ITM-NBR               03530577
035306             PERFORM R350-SELECT-TSKXREF                          03530677
035307             IF SQLCODE = +100                                    03530777
035308                 PERFORM R200-INSERT                              03530877
035309             ELSE                                                 03530977
035310*                UPDATE ALL FIELDS ON THE TSKXREF ROW             03531077
035320                 PERFORM U140-UPDATE-TSKXREF                      03532077
035330             END-IF                                               03533077
035331                                                                  03533177
035332         END-EVALUATE                                             03533277
035333                                                                  03533377
035334         PERFORM DS002-COMMIT                                     03533477
035335                                                                  03533577
035336        END-IF                                                    03533677
035337     END-IF.                                                      03533777
035338                                                                  03533877
035339/                                                                 03533977
035340***************************************************************** 03534077
035341*     A TMDSEAR MDSEAR_DKEY CHANGE AFFECTS TABLES TMDSEAR,        03534177
035342*     TMDSECL, TAPLAVL, TDCVSVL, IMT_CHARTC_RULDESC, TMDARVS,     03534277
035343*     TUPC, AND IMT_STYL_PRTNR.                                   03534377
035344***************************************************************** 03534477
035345 B300-MDSEAR-DKEY-CHANGE.                                         03534577
035346*                                                                 03534677
035347     DISPLAY '  ****  CHANGING TMDSEAR DKEY FROM '                03534777
035348           PV-MDSEAR-DKEY ' TO ' HOLD-SUB-CL-MDSEAR-ID.           03534877
035349     PERFORM U170-UPDATE-TMDSEAR-DKEY.                            03534977
035350     PERFORM U171-UPDATE-TMDSECL-DKEY.                            03535077
035360     PERFORM U172-UPDATE-TAPLAVL-DKEY.                            03536077
035370     PERFORM U173-UPDATE-TDCVSVL-DKEY.                            03537077
035380     PERFORM U174-UPDATE-RULDESC-DKEY.                            03538077
035390     PERFORM U175-UPDATE-TMDARVS-DKEY.                            03539077
035400     IF SQLCODE = 0                                               03540077
035500*        ONLY NEED TO UPDATE THESE TABLES IF STYLES WERE UPDATED  03550077
035600         PERFORM U176-UPDATE-TUPC-DKEY                            03560077
035601         PERFORM U177-UPDATE-PRTNR-DKEY                           03560177
035602     END-IF.                                                      03560277
035603                                                                  03560377
035604 C101-ADD-TO-DELETE-COUNTS.                                       03560477
035605     IF NOT-TABLE-EOF AND DS009-DO-PROCESS                        03560577
035606         SET DS009-SRCH-IDX TO +1                                 03560677
035607         SEARCH DS009-CNTL-RECORDS                                03560777
035608                 VARYING DS009-SRCH-IDX                           03560877
035609             AT END                                               03560977
035610                 CONTINUE                                         03561077
035620             WHEN CNTL-TABLE (DS009-SRCH-IDX) = DS002-NAME        03562077
035630                 ADD SQLERRD(3)                                   03563077
035631                        TO DS009-READ-COUNT (DS009-SRCH-IDX)      03563177
035632         END-SEARCH                                               03563277
035633     END-IF.                                                      03563377
035634                                                                  03563477
035635 C102-ADD-TO-INSERT-COUNTS.                                       03563577
035636     IF NOT-TABLE-EOF AND DS009-DO-PROCESS                        03563677
035637         SET DS009-SRCH-IDX TO +1                                 03563777
035638         SEARCH DS009-CNTL-RECORDS                                03563877
035639                 VARYING DS009-SRCH-IDX                           03563977
035640             AT END                                               03564077
035641                 CONTINUE                                         03564177
035642             WHEN CNTL-TABLE (DS009-SRCH-IDX) = DS002-NAME        03564277
035643                 ADD SQLERRD(3)                                   03564377
035644                        TO DS009-WRITE-COUNT (DS009-SRCH-IDX)     03564477
035645         END-SEARCH                                               03564577
035646     END-IF.                                                      03564677
035647                                                                  03564777
035648 C103-ADD-TO-UPDATE-COUNTS.                                       03564877
035649     IF NOT-TABLE-EOF AND DS009-DO-PROCESS                        03564977
035650         SET WS-CNTL-SRCH-IDX TO +1                               03565077
035651         SEARCH WS-CNTL-RECORDS                                   03565177
035652                 VARYING WS-CNTL-SRCH-IDX                         03565277
035653             AT END                                               03565377
035654                 CONTINUE                                         03565477
035655             WHEN WS-CNTL-TABLE (WS-CNTL-SRCH-IDX) = DS002-NAME   03565577
035656                 ADD SQLERRD(3)                                   03565677
035657                      TO WS-CNTL-UPDATE-COUNT (WS-CNTL-SRCH-IDX)  03565777
035658         END-SEARCH                                               03565877
035659     END-IF.                                                      03565977
035660                                                                  03566077
035670***************************************************************** 03567077
035680*    CHECK IF PROD TUPCPLS FIELDS ARE DIFFERENT FROM TEST FIELDS  03568077
035690***************************************************************** 03569077
035691 C104-CHECK-TUPCPLS-FIELDS.                                       03569177
035692     SET PS-TUPCPLS-DIFFS TO TRUE.                                03569277
035693     IF UPCPLS-UPC-STAT-CDE        = WS-UPCPLS-UPC-STAT-CDE       03569377
035694       AND UPCPLS-UNT-COST-AMT     = WS-UPCPLS-UNT-COST-AMT       03569477
035695       AND UPCPLS-UNT-RTL-AMT      = WS-UPCPLS-UNT-RTL-AMT        03569577
035696       AND UPCPLS-MEITGP-NBR       = WS-UPCPLS-MEITGP-NBR         03569677
035697       AND UPCPLS-ITM-NBR          = WS-UPCPLS-ITM-NBR            03569777
035698       AND UPCPLS-PLU-IND          = WS-UPCPLS-PLU-IND            03569877
035699       AND UPCPLS-UPC-STAT-CHG-DTE = WS-UPCPLS-UPC-STAT-CHG-DTE   03569977
035700       AND UPCPLS-UNT-RTL-CHG-DTE  = WS-UPCPLS-UNT-RTL-CHG-DTE    03570077
035800         SET PS-TUPCPLS-NO-DIFFS TO TRUE                          03580077
035900     ELSE                                                         03590077
036000         IF UPCPLS-EFF-BEG-TMST >= WS-UPCPLS-EFF-BEG-TMST         03600077
036100*            QA ROW IS MORE CURRENT THAN PROD ROW                 03610077
036200             PERFORM V100-GET-CURRENT-TIMESTAMP                   03620077
036300             MOVE PV-CURRENT-TIMESTAMP TO WS-UPCPLS-EFF-BEG-TMST  03630077
036400             SET PS-TUPCPLS-PROD-NOT-NEWER TO TRUE                03640077
036500         ELSE                                                     03650077
036600             SET PS-TUPCPLS-PROD-NEWER TO TRUE                    03660077
036700         END-IF                                                   03670077
036701     END-IF.                                                      03670177
036702 EJECT                                                            03670277
036703*                                                                 03670377
036704***************************************************************** 03670477
036705*     DELETE RECORD                                               03670577
036706***************************************************************** 03670677
036707*                                                                 03670777
036708 R100-DELETE.                                                     03670877
036709     PERFORM WITH TEST AFTER                                      03670977
036710             VARYING DS009-RETRY-COUNTER FROM 1 BY 1              03671077
036720             UNTIL   DS009-RETRY-COUNTER > 3 OR                   03672077
036730                     SQLCODE = ZERO OR +100 OR -310 OR -532       03673077
036740                                                                  03674077
036750        EVALUATE TRUE                                             03675077
036760           WHEN DS009-PROCESS-TABLE = 'TENTNME'                   03676077
036770             EXEC SQL                                             03677077
036780                DELETE FROM TENTNME                               03678077
036790                WHERE ENT_ID  = :HOLD-ENT-ID                      03679077
036800                  AND SEQ_NBR = :HOLD-ENTNME-SEQ-NBR              03680077
036900             END-EXEC                                             03690077
037000          WHEN DS009-PROCESS-TABLE = 'TVNDSTL'                    03700077
037100             EXEC SQL                                             03710077
037200                DELETE FROM TVNDSTL                               03720077
037300                WHERE VS_ID = :HOLD-VS-ID                         03730077
037400             END-EXEC                                             03740077
037500          WHEN DS009-PROCESS-TABLE = 'TMDARVS'                    03750077
037600             EXEC SQL                                             03760077
037700                DELETE FROM TMDARVS                               03770077
037800                WHERE SUB_CL_MDSEAR_ID = :HOLD-SUB-CL-MDSEAR-ID   03780077
037900                  AND VS_ID            = :HOLD-VS-ID              03790077
038000             END-EXEC                                             03800077
038100          WHEN DS009-PROCESS-TABLE = 'TUPC'                       03810077
038200             EXEC SQL                                             03820077
038300                DELETE FROM TUPC                                  03830077
038400                WHERE UPC_ID = :HOLD-UPC-ID                       03840077
038500             END-EXEC                                             03850077
038600          WHEN DS009-PROCESS-TABLE = 'TUPCPLS'                    03860077
038700             EXEC SQL                                             03870077
038800                DELETE FROM TUPCPLS                               03880077
038900                WHERE UPC_ID     = :HOLD-UPC-ID                   03890077
039000                  AND OPERCO_NBR = '03'                           03900077
039100                  AND STR_NBR    = :PV-HOLD-STR-NBR               03910077
039200             END-EXEC                                             03920077
039300          WHEN DS009-PROCESS-TABLE = 'TSK'                        03930077
039400             EXEC SQL                                             03940077
039500                DELETE FROM TSK                                   03950077
039600                WHERE ITEM_NMBR   = :HOLD-ITEM-NBR                03960077
039700             END-EXEC                                             03970077
039800          WHEN DS009-PROCESS-TABLE = 'TUPCSKU'                    03980077
039900             EXEC SQL                                             03990077
040000                DELETE FROM TUPCSKU                               04000077
040010                WHERE UPC_NBR = :HOLD-UPC-NBR                     04001077
040020             END-EXEC                                             04002077
040030           WHEN DS009-PROCESS-TABLE = 'TWEBITM'                   04003077
040040             EXEC SQL                                             04004077
040050                DELETE FROM TWEBITM                               04005077
040051                WHERE INTR_UPC_ID  = :HOLD-INTR-UPC-ID            04005177
040052                  AND EFF_END_TMST IS NULL                        04005277
040053             END-EXEC                                             04005377
040054             EXEC SQL                                             04005477
040055                DELETE FROM TWEBITM                               04005577
040056                WHERE INTR_UPC_ID  = :HOLD-INTR-UPC-ID            04005677
040057                  AND EFF_BEG_TMST >= :WS-WEBITM-EFF-BEG-TMST     04005777
040058             END-EXEC                                             04005877
040059          WHEN DS009-PROCESS-TABLE = 'TSKST'                      04005977
040060             EXEC SQL                                             04006077
040061                DELETE FROM TSKST                                 04006177
040062                WHERE ITEM_NMBR   = :HOLD-ITEM-NBR                04006277
040063             END-EXEC                                             04006377
040064          WHEN DS009-PROCESS-TABLE = 'TPPCPRC'                    04006477
040065             EXEC SQL                                             04006577
040066                DELETE FROM TPPCPRC                               04006677
040067                WHERE TSK_ITM_NBR = :HOLD-ITEM-NBR                04006777
040068             END-EXEC                                             04006877
040069          WHEN DS009-PROCESS-TABLE = 'IMT_STYL_PRTNR'             04006977
040070             EXEC SQL                                             04007077
040071                DELETE FROM IMT_STYL_PRTNR                        04007177
040072                WHERE SUB_CL_MDSEAR_ID = :HOLD-SUB-CL-MDSEAR-ID   04007277
040073                  AND VS_ID            = :HOLD-VS-ID              04007377
040074             END-EXEC                                             04007477
040075          WHEN DS009-PROCESS-TABLE = 'IMT_LBL'                    04007577
040076             EXEC SQL                                             04007677
040077                DELETE FROM IMT_LBL                               04007777
040078                WHERE LBL_SEQ_NBR  = :DS010-LBL-SEQ-NBR           04007877
040079             END-EXEC                                             04007977
040080                                                                  04008077
040090        END-EVALUATE                                              04009077
040100     END-PERFORM.                                                 04010077
040200                                                                  04020077
040300     PERFORM DS002-SQL-ABEND-DELETE.                              04030077
040400     PERFORM C101-ADD-TO-DELETE-COUNTS.                           04040077
040401                                                                  04040177
040402 EJECT                                                            04040277
040403*                                                                 04040377
040404***************************************************************** 04040477
040405*     INSERT RECORD                                               04040577
040406***************************************************************** 04040677
040407*                                                                 04040777
040408 R200-INSERT.                                                     04040877
040409     IF WS-UPC-PO-SHRT-CYC-IND = SPACE                            04040977
040410         MOVE 'N' TO WS-UPC-PO-SHRT-CYC-IND                       04041077
040420     END-IF.                                                      04042077
040430     IF WS-WEBITM-WEB-EXCLV-IND = SPACE                           04043077
040440         MOVE 'N' TO WS-WEBITM-WEB-EXCLV-IND                      04044077
040441     END-IF.                                                      04044177
040442     PERFORM WITH TEST AFTER                                      04044277
040443             VARYING DS009-RETRY-COUNTER FROM 1 BY 1              04044377
040444             UNTIL   DS009-RETRY-COUNTER > 3 OR                   04044477
040445                     SQLCODE = ZERO OR +100 OR -803               04044577
040446                               OR -181                            04044677
040447                               OR -310                            04044777
040448                                                                  04044877
040449          EVALUATE TRUE                                           04044977
040450            WHEN DS009-PROCESS-TABLE = 'TMDSEAR'                  04045077
040451               EXEC SQL                                           04045177
040452                INSERT INTO TMDSEAR                               04045277
040453                  (                                               04045377
040454                    OPERCO_NBR                                    04045477
040455                   ,GMA_NBR                                       04045577
040456                   ,DMA_NBR                                       04045677
040457                   ,DEPT_NBR                                      04045777
040458                   ,MAJ_CL_NBR                                    04045877
040459                   ,SUB_CL_NBR                                    04045977
040460                   ,MDSELV_CDE                                    04046077
040470                   ,MDSEAR_DKEY                                   04047077
040480                   ,CHG_DTE                                       04048077
040490                   ,CRE_DTE                                       04049077
040500                   ,STRT_DTE                                      04050077
040600                   ,END_DTE                                       04060077
040700                   ,GEN_MDSE_TYP_CDE                              04070077
040800                   ,MDSEAR_DESC                                   04080077
040900                   ,BYR_NBR                                       04090077
041000                   ,LIST_SEQ_NBR                                  04100077
041100                   ,PHY_INV_OH_VAR_PCT                            04110077
041101                   ,PHY_INV_OH_VAR_QTY                            04110177
041102                  )                                               04110277
041103                VALUES (                                          04110377
041104                    :WS-MDSEAR-OPERCO-NBR                         04110477
041105                   ,:WS-MDSEAR-GMA-NBR                            04110577
041106                   ,:WS-MDSEAR-DMA-NBR                            04110677
041107                   ,:WS-MDSEAR-DEPT-NBR                           04110777
041108                   ,:WS-MDSEAR-MAJ-CL-NBR                         04110877
041109                   ,:WS-MDSEAR-SUB-CL-NBR                         04110977
041110                   ,:WS-MDSEAR-MDSELV-CDE                         04111077
041120                   ,:WS-MDSEAR-MDSEAR-DKEY                        04112077
041130                   ,:WS-MDSEAR-CHG-DTE                            04113077
041140                   ,:WS-MDSEAR-CRE-DTE                            04114077
041150                   ,:WS-MDSEAR-STRT-DTE                           04115077
041160                   ,:WS-MDSEAR-END-DTE                            04116077
041170                   ,:WS-MDSEAR-GEN-MDSE-TYP-CDE                   04117077
041180                   ,:WS-MDSEAR-DESC                               04118077
041190                   ,:WS-MDSEAR-BYR-NBR                            04119077
041200                   ,:WS-MDSEAR-LIST-SEQ-NBR                       04120077
041300                   ,:WS-MDSEAR-PHY-INV-OH-VAR-PCT                 04130077
041400                      :WS-MDSEAR-PHY-INV-OH-VAR-PCT-N             04140077
041500                   ,:WS-MDSEAR-PHY-INV-OH-VAR-QTY                 04150077
041501                      :WS-MDSEAR-PHY-INV-OH-VAR-QTY-N             04150177
041502                  )                                               04150277
041503               END-EXEC                                           04150377
041504               MOVE WS-MDSEAR-MDSEAR-DKEY TO PV-HOLD-STRUCT2-KEY  04150477
041505            WHEN DS009-PROCESS-TABLE = 'TEXTENT'                  04150577
041506               EXEC SQL                                           04150677
041507                  INSERT INTO TEXTENT                             04150777
041508                    (                                             04150877
041509                     ENT_ID                                       04150977
041510                    ,SCAC_CDE                                     04151077
041511                    ,DUN_NBR                                      04151177
041512                    ,ASN_TRSCP_IND                                04151277
041513                    ,FED_EXPRESS_NBR                              04151377
041514                    ,MDSE_VENDOR_IND                              04151477
041515                    ,CARRIER_IND                                  04151577
041516                    ,STATUS_CDE                                   04151677
041517                    ,CARR_MAN_PRO_IND                             04151777
041518                    ,EDI214_TEST_IND                              04151877
041519                    ,IMPRT_IND                                    04151977
041520                    ,SHIP_INSTR_LT_QTY                            04152077
041521                    ,SHIP_INSTR_REQD                              04152177
041522                    ,EXP_VEND_IND                                 04152277
041523                    ,NEED_1099_IND                                04152377
041524                    ,CRE_BY_UID                                   04152477
041525                    ,CRE_TMST                                     04152577
041526                    ,LAST_UPD_BY_UID                              04152677
041527                    ,LAST_UPD_TMST                                04152777
041528*MAM                ,CFY_SLSRNK_NBR                               04152877
041529*MAM                ,PFY_SLSRNK_NBR                               04152977
041530                    ,CRE_ASN_FCST_IND                             04153077
041531                    ,CRE_SHIPT_FCST_IND                           04153177
041532                    ,STR_DISTRO_LT_QTY                            04153277
041533                    ,VLD_CART_LBL_IND                             04153377
041534                    ,PRNT_CO_ENT_ID                               04153477
041535                    ,VND_CLSN_CDE                                 04153577
041536                    ,VND_PRSST_CDE                                04153677
041537                    ,FED_TX_ID_TYP_CDE                            04153777
041538                    ,FED_TX_ID_NBR                                04153877
041539                    ,FCTR_IND                                     04153977
041540                    ,PRNT_CO_IND                                  04154077
041541                    ,CAP_EXP_CDE                                  04154177
041542                    ,HLD_PAYT_IND                                 04154277
041543                    ,PAY_FCTR_VND_IND                             04154377
041544                    ,SEPR_INVC_PAYT_IND                           04154477
041545                    ,WHLDG_PAYT_TYP_CDE                           04154577
041546                    ,PAYT_HNDLG_CDE                               04154677
041547                    )                                             04154777
041548                VALUES (                                          04154877
041549                   :WS-EXTENT-ENT-ID                              04154977
041550                  ,:WS-EXTENT-SCAC-CDE                            04155077
041551                  ,:WS-EXTENT-DUN-NBR                             04155177
041552                  ,:WS-EXTENT-ASN-TRSCP-IND                       04155277
041553                  ,:WS-EXTENT-FED-EXPRESS-NBR                     04155377
041554                  ,:WS-EXTENT-MDSE-VENDOR-IND                     04155477
041555                  ,:WS-EXTENT-CARRIER-IND                         04155577
041556                  ,:WS-EXTENT-STATUS-CDE                          04155677
041557                  ,:WS-EXTENT-CARR-MAN-PRO-IND                    04155777
041558                  ,:WS-EXTENT-EDI214-TEST-IND                     04155877
041559                  ,:WS-EXTENT-IMPRT-IND                           04155977
041560                  ,:WS-EXTENT-SHIP-INSTR-LT-QTY                   04156077
041561                  ,:WS-EXTENT-SHIP-INSTR-REQD                     04156177
041562                  ,:WS-EXTENT-EXP-VEND-IND                        04156277
041563                  ,:WS-EXTENT-NEED-1099-IND                       04156377
041564                  ,:WS-EXTENT-CRE-BY-UID                          04156477
041565                  ,:WS-EXTENT-CRE-TMST                            04156577
041566                  ,:WS-EXTENT-LAST-UPD-BY-UID                     04156677
041567                  ,:WS-EXTENT-LAST-UPD-TMST                       04156777
041568*MAM              ,:WS-EXTENT-CFY-SLSRNK-NBR                      04156877
041569*MAM              ,:WS-EXTENT-PFY-SLSRNK-NBR                      04156977
041570                  ,:WS-EXTENT-CRE-ASN-FCST-IND                    04157077
041571                  ,:WS-EXTENT-CRE-SHIPT-FCST-IND                  04157177
041572                  ,:WS-EXTENT-STR-DISTRO-LT-QTY                   04157277
041573                  ,:WS-EXTENT-VLD-CART-LBL-IND                    04157377
041574                  ,:WS-EXTENT-PRNT-CO-ENT-ID                      04157477
041575                  ,:WS-EXTENT-VND-CLSN-CDE                        04157577
041576                  ,:WS-EXTENT-VND-PRSST-CDE                       04157677
041577                  ,:WS-EXTENT-FED-TX-ID-TYP-CDE                   04157777
041578                  ,:WS-EXTENT-FED-TX-ID-NBR                       04157877
041579                  ,:WS-EXTENT-FCTR-IND                            04157977
041580                  ,:WS-EXTENT-PRNT-CO-IND                         04158077
041581                  ,:WS-EXTENT-CAP-EXP-CDE                         04158177
041582                  ,:WS-EXTENT-HLD-PAYT-IND                        04158277
041583                  ,:WS-EXTENT-PAY-FCTR-VND-IND                    04158377
041584                  ,:WS-EXTENT-SEPR-INVC-PAYT-IND                  04158477
041585                  ,:WS-EXTENT-WHLDG-PAYT-TYP-CDE                  04158577
041586                  ,:WS-EXTENT-PAYT-HNDLG-CDE                      04158677
041587                       )                                          04158777
041588               END-EXEC                                           04158877
041589               MOVE WS-EXTENT-ENT-ID   TO PV-DOUBLE-COMP          04158977
041590               MOVE PV-DOUBLE-COMP     TO PV-HOLD-STRUCT2-KEY     04159077
041591            WHEN DS009-PROCESS-TABLE = 'TENTNME'                  04159177
041592               EXEC SQL                                           04159277
041593                  INSERT INTO TENTNME                             04159377
041594                    (                                             04159477
041595                     ENT_ID                                       04159577
041596                    ,SEQ_NBR                                      04159677
041597                    ,ENT_NAME_DESC                                04159777
041598                    ,TYPE_CDE                                     04159877
041599                    )                                             04159977
041600                VALUES (                                          04160077
041601                     :WS-ENTNME-ENT-ID                            04160177
041602                    ,:WS-ENTNME-SEQ-NBR                           04160277
041603                    ,:WS-ENTNME-ENT-NAME-DESC                     04160377
041604                    ,:WS-ENTNME-TYPE-CDE                          04160477
041605                       )                                          04160577
041606               END-EXEC                                           04160677
041607               MOVE WS-ENTNME-ENT-ID   TO PV-DOUBLE-COMP          04160777
041608               MOVE PV-DOUBLE-COMP     TO PV-HOLD-STRUCT2-KEY     04160877
041609            WHEN DS009-PROCESS-TABLE = 'TVNDDPT'                  04160977
041610               EXEC SQL                                           04161077
041620                  INSERT INTO TVNDDPT                             04162077
041630                    (                                             04163077
041640                     ENT_ID                                       04164077
041650                    ,DEPT_NBR                                     04165077
041660                    ,INHOUSE_NBR                                  04166077
041670                    ,VEND_TYP_IND                                 04167077
041680                    ,INVC_REQ_PO_IND                              04168077
041690                    ,VND_DEPT_STAT_CD                             04169077
041700                    )                                             04170077
041800                VALUES (                                          04180077
041900                     :WS-VNDDPT-ENT-ID                            04190077
042000                    ,:WS-VNDDPT-DEPT-NBR                          04200077
042100                    ,:WS-VNDDPT-INHOUSE-NBR                       04210077
042200                    ,:WS-VNDDPT-VEND-TYP-IND                      04220077
042300                    ,:WS-VNDDPT-INVC-REQ-PO-IND                   04230077
042400                    ,:WS-VNDDPT-VND-DEPT-STAT-CD                  04240077
042500                       )                                          04250077
042600               END-EXEC                                           04260077
042700               MOVE WS-VNDDPT-ENT-ID   TO PV-DOUBLE-COMP          04270077
042701               MOVE PV-DOUBLE-COMP     TO PV-HOLD-STRUCT2-KEY     04270177
042702            WHEN DS009-PROCESS-TABLE = 'TVSCHVL'                  04270277
042703               EXEC SQL                                           04270377
042704                  INSERT INTO TVSCHVL                             04270477
042705                    (                                             04270577
042706                     CHARTC_CDE                                   04270677
042707                    ,CHARTC_SEQ_NBR                               04270777
042708                    ,CHARTC_VAL_DESC                              04270877
042709                    ,STAT_CDE                                     04270977
042710                    )                                             04271077
042711                VALUES (                                          04271177
042712                     :WS-VSCHVL-CHARTC-CDE                        04271277
042713                    ,:WS-VSCHVL-CHARTC-SEQ-NBR                    04271377
042714                    ,:WS-VSCHVL-CHARTC-VAL-DESC                   04271477
042715                    ,:WS-VSCHVL-STAT-CDE                          04271577
042716                       )                                          04271677
042717               END-EXEC                                           04271777
042718               MOVE WS-VSCHVL-CHARTC-CDE TO PV-HOLD-STRUCT2-KEY   04271877
042719            WHEN DS009-PROCESS-TABLE = 'TVNDSTL'                  04271977
042720               EXEC SQL                                           04272077
042721                INSERT INTO TVNDSTL                               04272177
042722                  (                                               04272277
042723                    VS_ID                                         04272377
042724                   ,ENT_ID                                        04272477
042725                   ,VS_NBR                                        04272577
042726                   ,EFF_BEG_DTE                                   04272677
042727                   ,EFF_END_DTE                                   04272777
042728                   ,COST_UM_CDE                                   04272877
042729                   ,RTL_UM_CDE                                    04272977
042730                   ,BYP_CAT_IND                                   04273077
042731                   ,CRE_BY_USR_ID                                 04273177
042732                   ,LAST_UPD_BY_USR_ID                            04273277
042733                   ,LAST_UPD_TMST                                 04273377
042734                  )                                               04273477
042735                VALUES (                                          04273577
042736                :WS-VNDSTL-VS-ID                                  04273677
042737               ,:WS-VNDSTL-ENT-ID                                 04273777
042738               ,:WS-VNDSTL-VS-NBR                                 04273877
042739               ,:WS-VNDSTL-EFF-BEG-DTE                            04273977
042740                :WS-VNDSTL-EFF-BEG-DTE-NN                         04274077
042741               ,:WS-VNDSTL-EFF-END-DTE                            04274177
042742                :WS-VNDSTL-EFF-END-DTE-NN                         04274277
042743               ,:WS-VNDSTL-COST-UM-CDE                            04274377
042744               ,:WS-VNDSTL-RTL-UM-CDE                             04274477
042745               ,:WS-VNDSTL-BYP-CAT-IND                            04274577
042746               ,:WS-VNDSTL-CRE-BY-USR-ID                          04274677
042747               ,:WS-VNDSTL-LAST-UPD-BY-USR-ID                     04274777
042748               ,:WS-VNDSTL-LAST-UPD-TMST                          04274877
042749                   )                                              04274977
042750               END-EXEC                                           04275077
042760               MOVE WS-VNDSTL-VS-ID    TO PV-DOUBLE-COMP          04276077
042761               MOVE PV-DOUBLE-COMP     TO PV-HOLD-STRUCT2-KEY     04276177
042762            WHEN DS009-PROCESS-TABLE = 'TMDARVS'                  04276277
042763               EXEC SQL                                           04276377
042764                INSERT INTO TMDARVS                               04276477
042765                  (                                               04276577
042766                    SUB_CL_MDSEAR_ID                              04276677
042767                   ,VS_ID                                         04276777
042768                   ,ACTV_IND                                      04276877
042769                   ,VS_DESC                                       04276977
042770                   ,STKR_NBR                                      04277077
042780                   ,TKT_TYP_SEQ_NBR                               04278077
042790                   ,LBL_SEQ_NBR                                   04279077
042800                   ,HNG_FOLD_SEQ_NBR                              04280077
042900                   ,KY_CLSN_SEQ_NBR                               04290077
043000                   ,FBRCN_SEQ_NBR                                 04300077
043100                   ,FNSH_SEQ_NBR                                  04310077
043200                   ,RMS_STYL_ID                                   04320077
043300                   ,STYL_RECLS_IND                                04330077
043400                   ,RTL_CLSN_SEQ_NBR                              04340077
043500                   ,DEPT_NBR                                      04350077
043600                   ,MAJ_CL_NBR                                    04360077
043700                   ,SUB_CL_NBR                                    04370077
043800                   ,ESL_SEQ_NBR                                   04380077
043900                   ,RPT_HIER_SEQ_NBR                              04390077
044000                   ,BDY_STYL_SEQ_NBR                              04400077
044100                   ,CONST_SEQ_NBR                                 04410077
044200                   ,FUNC_SEQ_NBR                                  04420077
044300                   ,GNDR_SEQ_NBR                                  04430077
044400                   ,PATRN_SEQ_NBR                                 04440077
044500                   ,SLHTT_SEQ_NBR                                 04450077
044600                   ,CLLCTN_SEQ_NBR                                04460077
044700                   ,MAP_UNT_RTL_AMT                               04470077
044800                   ,C_O_ORGN_CDE                                  04480077
044900                   ,PRIC_TIER_SEQ_NBR                             04490077
045000                   ,LFSTYL_SEQ_NBR                                04500077
045100                   ,CUST_INTFC_DESC                               04510077
045200                   ,FSHN_PYRMD_SEQ_NBR                            04520077
045300                   ,PRFL_GP_NM_TXT                                04530077
045400                   ,CTG_SEQ_NBR                                   04540077
045500                   ,MAJ_CTG_SEQ_NBR                               04550077
045600                   ,MTRL_SEQ_NBR                                  04560077
045700                   ,PRIM_TRND_SEQ_NBR                             04570077
045800                   ,SEC_TRND_SEQ_NBR                              04580077
045900                   ,ATTR_1_SEQ_NBR                                04590077
046000                   ,ATTR_2_SEQ_NBR                                04600077
046001                   ,NW_SLHTT_SEQ_NBR                              04600177
046002                  )                                               04600277
046003                VALUES (                                          04600377
046004                    :WS-MDARVS-SUB-CL-MDSEAR-ID                   04600477
046005                   ,:WS-MDARVS-VS-ID                              04600577
046006                   ,:PV-MDARVS-ACTV-IND                           04600677
046007                   ,:WS-MDARVS-VS-DESC                            04600777
046008                   ,:WS-MDARVS-STKR-NBR                           04600877
046009                   ,:WS-MDARVS-TKT-TYP-SEQ-NBR                    04600977
046010                   ,:WS-MDARVS-LBL-SEQ-NBR                        04601077
046020                   ,:WS-MDARVS-HNG-FOLD-SEQ-NBR                   04602077
046030                   ,:WS-MDARVS-KY-CLSN-SEQ-NBR                    04603077
046040                   ,:WS-MDARVS-FBRCN-SEQ-NBR                      04604077
046050                   ,:WS-MDARVS-FNSH-SEQ-NBR                       04605077
046060                   ,:WS-MDARVS-RMS-STYL-ID                        04606077
046070                   ,:WS-MDARVS-STYL-RECLS-IND                     04607077
046080                   ,:WS-MDARVS-RTL-CLSN-SEQ-NBR                   04608077
046090                   ,:WS-MDARVS-DEPT-NBR                           04609077
046100                   ,:WS-MDARVS-MAJ-CL-NBR                         04610077
046200                   ,:WS-MDARVS-SUB-CL-NBR                         04620077
046300                   ,:WS-MDARVS-ESL-SEQ-NBR                        04630077
046400                   ,:WS-MDARVS-RPT-HIER-SEQ-NBR                   04640077
046500                   ,:WS-MDARVS-BDY-STYL-SEQ-NBR                   04650077
046600                   ,:WS-MDARVS-CONST-SEQ-NBR                      04660077
046700                   ,:WS-MDARVS-FUNC-SEQ-NBR                       04670077
046800                   ,:WS-MDARVS-GNDR-SEQ-NBR                       04680077
046900                   ,:WS-MDARVS-PATRN-SEQ-NBR                      04690077
047000                   ,:WS-MDARVS-SLHTT-SEQ-NBR                      04700077
047100                   ,:WS-MDARVS-CLLCTN-SEQ-NBR                     04710077
047200                   ,:WS-MDARVS-MAP-UNT-RTL-AMT                    04720077
047300                   ,:WS-MDARVS-C-O-ORGN-CDE                       04730077
047400                   ,:WS-MDARVS-PRIC-TIER-SEQ-NBR                  04740077
047500                   ,:WS-MDARVS-LFSTYL-SEQ-NBR                     04750077
047600                   ,:WS-MDARVS-CUST-INTFC-DESC                    04760077
047700                   ,:WS-MDARVS-FSHN-PYRMD-SEQ-NBR                 04770077
047800                   ,:WS-MDARVS-PRFL-GP-NM-TXT                     04780077
047900                   ,:WS-MDARVS-CTG-SEQ-NBR                        04790077
048000                   ,:WS-MDARVS-MAJ-CTG-SEQ-NBR                    04800077
048100                   ,:WS-MDARVS-MTRL-SEQ-NBR                       04810077
048200                   ,:WS-MDARVS-PRIM-TRND-SEQ-NBR                  04820077
048300                   ,:WS-MDARVS-SEC-TRND-SEQ-NBR                   04830077
048400                   ,:WS-MDARVS-ATTR-1-SEQ-NBR                     04840077
048500                   ,:WS-MDARVS-ATTR-2-SEQ-NBR                     04850077
048501                   ,:WS-MDARVS-NW-SLHTT-SEQ-NBR                   04850177
048502                  )                                               04850277
048503               END-EXEC                                           04850377
048504               MOVE WS-MDARVS-VS-ID    TO PV-DOUBLE-COMP          04850477
048505               MOVE PV-DOUBLE-COMP     TO PV-HOLD-STRUCT2-KEY     04850577
048506            WHEN DS009-PROCESS-TABLE = 'TUPC'                     04850677
048507               EXEC SQL                                           04850777
048508                INSERT INTO TUPC                                  04850877
048509                  (                                               04850977
048510                    UPC_ID                                        04851077
048511                   ,UPC_NBR                                       04851177
048512                   ,SUB_CL_MDSEAR_ID                              04851277
048513                   ,VS_ID                                         04851377
048514                   ,INTR_UPC_ID                                   04851477
048515                   ,EFF_BEG_DTE                                   04851577
048516                   ,EFF_END_DTE                                   04851677
048517                   ,UPC_TYP_CDE                                   04851777
048518                   ,KOHLS_SIZE_CDE                                04851877
048519                   ,NRF_SIZE_IND                                  04851977
048520                   ,NRF_CLOR_CDE                                  04852077
048521                   ,NRF_CLOR_IND                                  04852177
048522                   ,CSTM_CLOR_DESC                                04852277
048523                   ,EDI_ORD_IND                                   04852377
048524                   ,PREPK_IND                                     04852477
048525                   ,GP_CDE                                        04852577
048526                   ,CERTD_IND                                     04852677
048527                   ,CERTD_DTE                                     04852777
048528                   ,RPLNMT_IND                                    04852877
048529                   ,KY_ITM_IND                                    04852977
048530                   ,UNT_COST_1ST_AMT                              04853077
048531                   ,UPC_SRC_CDE                                   04853177
048532                   ,INNR_PK_QTY                                   04853277
048533                   ,OUTR_PK_QTY                                   04853377
048534                   ,SEA_SEQ_NBR                                   04853477
048535                   ,CRE_BY_USR_ID                                 04853577
048536                   ,LAST_UPD_BY_USR_ID                            04853677
048537                   ,LAST_UPD_TMST                                 04853777
048538                   ,WD_UM_QTY                                     04853877
048539                   ,DPTH_UM_QTY                                   04853977
048540                   ,HT_UM_QTY                                     04854077
048541                   ,SIZE_UM_CDE                                   04854177
048542                   ,WT_UM_QTY                                     04854277
048543                   ,WT_UM_CDE                                     04854377
048544                   ,POG_IND                                       04854477
048545                   ,REGN_PRIC_IND                                 04854577
048546                   ,TX_PRD_CDE_SEQ_NBR                            04854677
048547                   ,CUSTFACG_CLOR_DESC                            04854777
048548                   ,INTR_UPC_DESC                                 04854877
048549                   ,TRNSTN_IND                                    04854977
048550                   ,PO_SHRT_CYC_IND                               04855077
048560                   ,TST_PRD_TYP_SEQ_NBR                           04856077
048561                   ,WHSE_RPLNT_IND                                04856177
048562                  )                                               04856277
048563                VALUES (                                          04856377
048564                    :WS-UPC-UPC-ID                                04856477
048565                   ,:WS-UPC-UPC-NBR                               04856577
048566                   ,:WS-UPC-SUB-CL-MDSEAR-ID                      04856677
048567                   ,:WS-UPC-VS-ID                                 04856777
048568                   ,:WS-UPC-INTR-UPC-ID                           04856877
048569                   ,:WS-UPC-EFF-BEG-DTE                           04856977
048570                   ,:WS-UPC-EFF-END-DTE:WS-UPC-EFF-END-DTE-NN     04857077
048571                   ,:WS-UPC-UPC-TYP-CDE                           04857177
048572                   ,:WS-UPC-KOHLS-SIZE-CDE                        04857277
048573                   ,:WS-UPC-NRF-SIZE-IND                          04857377
048574                   ,:WS-UPC-NRF-CLOR-CDE                          04857477
048575                   ,:WS-UPC-NRF-CLOR-IND                          04857577
048576                   ,:WS-UPC-CSTM-CLOR-DESC                        04857677
048577                   ,:WS-UPC-EDI-ORD-IND                           04857777
048578                   ,:WS-UPC-PREPK-IND                             04857877
048579                   ,:WS-UPC-GP-CDE                                04857977
048580                   ,:WS-UPC-CERTD-IND                             04858077
048581                   ,:WS-UPC-CERTD-DTE                             04858177
048582                   ,:WS-UPC-RPLNMT-IND                            04858277
048583                   ,:WS-UPC-KY-ITM-IND                            04858377
048584                   ,:WS-UPC-UNT-COST-1ST-AMT                      04858477
048585                   ,:WS-UPC-UPC-SRC-CDE                           04858577
048586                   ,:WS-UPC-INNR-PK-QTY                           04858677
048587                   ,:WS-UPC-OUTR-PK-QTY                           04858777
048588                   ,:WS-UPC-SEA-SEQ-NBR                           04858877
048589                   ,:WS-UPC-CRE-BY-USR-ID                         04858977
048590                   ,:WS-UPC-LAST-UPD-BY-USR-ID                    04859077
048591                   ,:WS-UPC-LAST-UPD-TMST                         04859177
048592                   ,:WS-UPC-WD-UM-QTY                             04859277
048593                   ,:WS-UPC-DPTH-UM-QTY                           04859377
048594                   ,:WS-UPC-HT-UM-QTY                             04859477
048595                   ,:WS-UPC-SIZE-UM-CDE                           04859577
048596                   ,:WS-UPC-WT-UM-QTY                             04859677
048597                   ,:WS-UPC-WT-UM-CDE                             04859777
048598                   ,:WS-UPC-POG-IND                               04859877
048599                   ,:WS-UPC-REGN-PRIC-IND                         04859977
048600                   ,:WS-UPC-TX-PRD-CDE-SEQ-NBR                    04860077
048700                   ,:WS-UPC-CUSTFACG-CLOR-DESC                    04870077
048800                   ,:WS-UPC-INTR-UPC-DESC                         04880077
048900                   ,:WS-UPC-TRNSTN-IND                            04890077
049000                   ,:WS-UPC-PO-SHRT-CYC-IND                       04900077
049100                   ,:WS-UPC-TST-PRD-TYP-SEQ-NBR                   04910077
049101                   ,:WS-UPC-WHSE-RPLNT-IND                        04910177
049102                   )                                              04910277
049103               END-EXEC                                           04910377
049104               MOVE WS-UPC-UPC-ID      TO PV-DOUBLE-COMP          04910477
049105               MOVE PV-DOUBLE-COMP     TO PV-HOLD-STRUCT2-KEY     04910577
049106            WHEN DS009-PROCESS-TABLE = 'TUPCPLS'                  04910677
049107               EXEC SQL                                           04910777
049108                INSERT INTO TUPCPLS                               04910877
049109                  (                                               04910977
049110                    UPC_ID                                        04911077
049120                   ,OPERCO_NBR                                    04912077
049130                   ,STR_NBR                                       04913077
049140                   ,EFF_BEG_TMST                                  04914077
049150                   ,EFF_END_TMST                                  04915077
049160                   ,UPC_STAT_CDE                                  04916077
049170                   ,UNT_COST_AMT                                  04917077
049180                   ,UNT_RTL_AMT                                   04918077
049190                   ,MEITGP_NBR                                    04919077
049200                   ,CRE_BY_USR_ID                                 04920077
049300                   ,CRE_TMST                                      04930077
049400                   ,ITM_NBR                                       04940077
049500                   ,PLU_IND                                       04950077
049600                   ,UPC_STAT_CHG_DTE                              04960077
049700                   ,UNT_RTL_CHG_DTE                               04970077
049800                   ,ORIG_CLR_DTE                                  04980077
049801                   ,MKDN_CDE                                      04980177
049802                  )                                               04980277
049803                VALUES (                                          04980377
049804                    :WS-UPCPLS-UPC-ID                             04980477
049805                   ,:WS-UPCPLS-OPERCO-NBR                         04980577
049806                   ,:WS-UPCPLS-STR-NBR                            04980677
049807                   ,:WS-UPCPLS-EFF-BEG-TMST                       04980777
049808                   ,:WS-UPCPLS-EFF-END-TMST                       04980877
049809                    :WS-UPCPLS-EFF-END-TMST-NN                    04980977
049810                   ,:WS-UPCPLS-UPC-STAT-CDE                       04981077
049820                    :WS-UPCPLS-UPC-STAT-CDE-NN                    04982077
049830                   ,:WS-UPCPLS-UNT-COST-AMT                       04983077
049840                    :WS-UPCPLS-UNT-COST-AMT-NN                    04984077
049850                   ,:WS-UPCPLS-UNT-RTL-AMT                        04985077
049860                    :WS-UPCPLS-UNT-RTL-AMT-NN                     04986077
049870                   ,:WS-UPCPLS-MEITGP-NBR                         04987077
049880                    :WS-UPCPLS-MEITGP-NBR-NN                      04988077
049890                   ,:WS-UPCPLS-CRE-BY-USR-ID                      04989077
049900                   ,:WS-UPCPLS-CRE-TMST                           04990077
050000                   ,:WS-UPCPLS-ITM-NBR                            05000077
050100                   ,:WS-UPCPLS-PLU-IND                            05010077
050200                   ,:WS-UPCPLS-UPC-STAT-CHG-DTE                   05020077
050300                   ,:WS-UPCPLS-UNT-RTL-CHG-DTE                    05030077
050400                   ,:WS-UPCPLS-ORIG-CLR-DTE                       05040077
050500                    :WS-UPCPLS-ORIG-CLR-DTE-NN                    05050077
050600                   ,:WS-UPCPLS-MKDN-CDE                           05060077
050601                    :WS-UPCPLS-MKDN-CDE-NN                        05060177
050602                  )                                               05060277
050603               END-EXEC                                           05060377
050604               MOVE WS-UPCPLS-UPC-ID   TO PV-DOUBLE-COMP          05060477
050605               MOVE PV-DOUBLE-COMP     TO PV-HOLD-STRUCT2-KEY     05060577
050606            WHEN DS009-PROCESS-TABLE = 'TSK'                      05060677
050607               EXEC SQL                                           05060777
050608                INSERT INTO TSK                                   05060877
050609                  (                                               05060977
050610               MERCH_DEPT_NMBR                                    05061077
050611              ,MERCH_CLASS_NMBR                                   05061177
050612              ,SEQ_NMBR                                           05061277
050613              ,CUM_SALES_UNIT_QTY                                 05061377
050614              ,RTL_UNIT_RCVD_QTY                                  05061477
050615              ,COST_UNIT_MSRMNT                                   05061577
050616              ,RTL_UNIT_MSRMNT                                    05061677
050617              ,UNIT_COST_AMT                                      05061777
050618              ,CUR_UNIT_RTL_AMT                                   05061877
050619              ,ORIG_UNIT_RTL_AMT                                  05061977
050620              ,VNDR_INNR_PACK_QTY                                 05062077
050621              ,SHPMT_COUNT_QTY                                    05062177
050622              ,VENDOR_STYLE_CODE                                  05062277
050623              ,STAT_CHNGD_DATE                                    05062377
050624              ,STATUS_CODE                                        05062477
050625              ,AUTO_RORD_MTH_CODE                                 05062577
050626              ,RTL_CST_CVRSN_FCTR                                 05062677
050627              ,SETUP_DATE                                         05062777
050628              ,PRICE_CHNG_DATE                                    05062877
050629              ,GROUP_CODE                                         05062977
050630              ,SKU_DESC                                           05063077
050631              ,SIZE_DESC                                          05063177
050632              ,COLOR_DESC                                         05063277
050633              ,REORDER_FRMT_CODE                                  05063377
050634              ,MERCH_DIV_CODE                                     05063477
050635              ,DMM_NMBR                                           05063577
050636              ,BUYER_NMBR                                         05063677
050637              ,VENDOR_NMBR                                        05063777
050638              ,VNDR_IN_HSE_NMBR                                   05063877
050639              ,MKDN_PGM_CODE                                      05063977
050640              ,LOWST_UNIT_RTL_AMT                                 05064077
050641              ,LOW_RTL_PRICE_DATE                                 05064177
050642              ,ITEM_NMBR                                          05064277
050643              ,GP_RTL_AMT                                         05064377
050644              ,ORIG_GP_QTY                                        05064477
050645              ,ORIG_GP_RTL_AMT                                    05064577
050646              ,FS_RPT_IND                                         05064677
050647              ,GP_QTY                                             05064777
050648              ,MULT_PR_PT_IND                                     05064877
050649              ,PLU_DWNLD_EXCL_IND                                 05064977
050650              ,LAST_PO_REV_DTE                                    05065077
050651              ,PO_REV_DAY_NBR                                     05065177
050652              ,PO_REV_SUN_WK_NBR                                  05065277
050653              ,PO_REV_MON_WK_NBR                                  05065377
050654              ,PO_REV_TUE_WK_NBR                                  05065477
050655              ,PO_REV_WED_WK_NBR                                  05065577
050656              ,PO_REV_THU_WK_NBR                                  05065677
050657              ,PO_REV_FRI_WK_NBR                                  05065777
050658              ,PO_REV_SAT_WK_NBR                                  05065877
050659              ,CENT_STK_CDE                                       05065977
050660              ,MEITGP_NBR                                         05066077
050661              ,SKU_TYP_CDE                                        05066177
050662              ,VEND_OUTR_PACK_QTY                                 05066277
050663              ,LONG_VENDOR_STYLE                                  05066377
050664              ,SIZE_CDE                                           05066477
050665              ,LONG_SIZE_DESC                                     05066577
050666              ,COLOR_CDE                                          05066677
050667              ,LONG_COLOR_DESC                                    05066777
050668              ,STICKER_NBR                                        05066877
050669              ,ENT_ID                                             05066977
050670              ,TKT_FMT_ID                                         05067077
050671              ,KY_ITM_IND                                         05067177
050672              ,VS_CHARTC_CDE                                      05067277
050673              ,VS_CHARTC_SEQ_NBR                                  05067377
050674              ,UNT_COST_1ST_AMT                                   05067477
050675              ,REGN_PRIC_IND                                      05067577
050676                  )                                               05067677
050677                VALUES (                                          05067777
050678                    :WS-TSK-MERCH-DEPT-NMBR                       05067877
050679                   ,:WS-TSK-MERCH-CLASS-NMBR                      05067977
050680                   ,:WS-TSK-SEQ-NMBR                              05068077
050681                   ,:WS-TSK-CUM-SALES-UNIT-QTY                    05068177
050682                   ,:WS-TSK-RTL-UNIT-RCVD-QTY                     05068277
050683                   ,:WS-TSK-COST-UNIT-MSRMNT                      05068377
050684                   ,:WS-TSK-RTL-UNIT-MSRMNT                       05068477
050685                   ,:WS-TSK-UNIT-COST-AMT                         05068577
050686                   ,:WS-TSK-CUR-UNIT-RTL-AMT                      05068677
050687                   ,:WS-TSK-ORIG-UNIT-RTL-AMT                     05068777
050688                   ,:WS-TSK-VNDR-INNR-PACK-QTY                    05068877
050689                   ,:WS-TSK-SHPMT-COUNT-QTY                       05068977
050690                   ,:WS-TSK-VENDOR-STYLE-CODE                     05069077
050691                   ,:WS-TSK-STAT-CHNGD-DATE                       05069177
050692                   ,:WS-TSK-STATUS-CODE                           05069277
050693                   ,:WS-TSK-AUTO-RORD-MTH-CODE                    05069377
050694                   ,:WS-TSK-RTL-CST-CVRSN-FCTR                    05069477
050695                   ,:WS-TSK-SETUP-DATE                            05069577
050696                   ,:WS-TSK-PRICE-CHNG-DATE                       05069677
050697                   ,:WS-TSK-GROUP-CODE                            05069777
050698                   ,:WS-TSK-SKU-DESC                              05069877
050699                   ,:WS-TSK-SIZE-DESC                             05069977
050700                   ,:WS-TSK-COLOR-DESC                            05070077
050701                   ,:WS-TSK-REORDER-FRMT-CODE                     05070177
050702                   ,:WS-TSK-MERCH-DIV-CODE                        05070277
050703                   ,:WS-TSK-DMM-NMBR                              05070377
050704                   ,:WS-TSK-BUYER-NMBR                            05070477
050705                   ,:WS-TSK-VENDOR-NMBR                           05070577
050706                   ,:WS-TSK-VNDR-IN-HSE-NMBR                      05070677
050707                   ,:WS-TSK-MKDN-PGM-CODE                         05070777
050708                   ,:WS-TSK-LOWST-UNIT-RTL-AMT                    05070877
050709                   ,:WS-TSK-LOW-RTL-PRICE-DATE                    05070977
050710                   ,:WS-TSK-ITEM-NMBR                             05071077
050711                   ,:WS-TSK-GP-RTL-AMT                            05071177
050712                   ,:WS-TSK-ORIG-GP-QTY                           05071277
050713                   ,:WS-TSK-ORIG-GP-RTL-AMT                       05071377
050714                   ,:WS-TSK-FS-RPT-IND                            05071477
050715                   ,:WS-TSK-GP-QTY                                05071577
050716                   ,:WS-TSK-MULT-PR-PT-IND                        05071677
050717                   ,:WS-TSK-PLU-DWNLD-EXCL-IND                    05071777
050718                   ,:WS-TSK-LAST-PO-REV-DTE                       05071877
050719                   ,:WS-TSK-PO-REV-DAY-NBR                        05071977
050720                   ,:WS-TSK-PO-REV-SUN-WK-NBR                     05072077
050721                   ,:WS-TSK-PO-REV-MON-WK-NBR                     05072177
050722                   ,:WS-TSK-PO-REV-TUE-WK-NBR                     05072277
050723                   ,:WS-TSK-PO-REV-WED-WK-NBR                     05072377
050724                   ,:WS-TSK-PO-REV-THU-WK-NBR                     05072477
050725                   ,:WS-TSK-PO-REV-FRI-WK-NBR                     05072577
050726                   ,:WS-TSK-PO-REV-SAT-WK-NBR                     05072677
050727                   ,:WS-TSK-CENT-STK-CDE                          05072777
050728                   ,:WS-TSK-MEITGP-NBR                            05072877
050729                   ,:WS-TSK-SKU-TYP-CDE                           05072977
050730                   ,:WS-TSK-VEND-OUTR-PACK-QTY                    05073077
050731                   ,:WS-TSK-LONG-VENDOR-STYLE                     05073177
050732                   ,:WS-TSK-SIZE-CDE                              05073277
050733                   ,:WS-TSK-LONG-SIZE-DESC                        05073377
050734                   ,:WS-TSK-COLOR-CDE                             05073477
050735                   ,:WS-TSK-LONG-COLOR-DESC                       05073577
050736                   ,:WS-TSK-STICKER-NBR                           05073677
050737                   ,:WS-TSK-ENT-ID                                05073777
050738                   ,:WS-TSK-TKT-FMT-ID                            05073877
050739                   ,:WS-TSK-KY-ITM-IND                            05073977
050740                   ,:WS-TSK-VS-CHARTC-CDE                         05074077
050741                   ,:WS-TSK-VS-CHARTC-SEQ-NBR                     05074177
050742                   ,:WS-TSK-UNT-COST-1ST-AMT                      05074277
050743                   ,:WS-TSK-REGN-PRIC-IND                         05074377
050744                  )                                               05074477
050745               END-EXEC                                           05074577
050746               MOVE WS-TSK-ITEM-NMBR   TO PV-HOLD-STRUCT2-KEY     05074677
050747            WHEN DS009-PROCESS-TABLE = 'TSKXREF'                  05074777
050748               EXEC SQL                                           05074877
050749                INSERT INTO TSKXREF                               05074977
050750                  (                                               05075077
050760                    DEPT_NBR                                      05076077
050770                   ,CL_NBR                                        05077077
050780                   ,SKU_SEQ_NBR                                   05078077
050790                   ,SKU_STAT_CDE                                  05079077
050800                   ,ITM_NBR                                       05080077
050900                   ,INTR_UPC_ID                                   05090077
051000                   ,DEPT                                          05100077
051100                   ,CLASS                                         05110077
051200                   ,SUBCLASS                                      05120077
051201                   ,SKU                                           05120177
051202                  )                                               05120277
051203                VALUES (                                          05120377
051204                    :WS-SKXREF-DEPT-NBR                           05120477
051205                   ,:WS-SKXREF-CL-NBR                             05120577
051206                   ,:WS-SKXREF-SKU-SEQ-NBR                        05120677
051207                   ,:WS-SKXREF-SKU-STAT-CDE                       05120777
051208                   ,:WS-SKXREF-ITM-NBR                            05120877
051209                   ,:WS-SKXREF-INTR-UPC-ID                        05120977
051210                   ,:WS-SKXREF-DEPT                               05121077
051220                   ,:WS-SKXREF-CLASS                              05122077
051230                   ,:WS-SKXREF-SUBCLASS                           05123077
051231                   ,:WS-SKXREF-SKU                                05123177
051232                  )                                               05123277
051233               END-EXEC                                           05123377
051234               MOVE WS-SKXREF-ITM-NBR  TO PV-HOLD-STRUCT2-KEY     05123477
051235            WHEN DS009-PROCESS-TABLE = 'TUPCSKU'                  05123577
051236               EXEC SQL                                           05123677
051237                INSERT INTO TUPCSKU                               05123777
051238                  (                                               05123877
051239                    UPC_NBR                                       05123977
051240                   ,ITEM_NBR                                      05124077
051241                   ,EDI_ORD_IND                                   05124177
051242                   ,PLU_DWNLD_IND                                 05124277
051243                   ,XREF_CRE_DTE                                  05124377
051244                   ,UPC_DESC                                      05124477
051245                   ,CERT_IND                                      05124577
051246                   ,CERT_DTE                                      05124677
051247                   ,UPC_SRC_IND                                   05124777
051248                   ,UMDCLN_IND                                    05124877
051249                  )                                               05124977
051250                VALUES (                                          05125077
051251                    :WS-TUPCSKU-UPC-NBR                           05125177
051252                   ,:WS-TUPCSKU-ITEM-NBR                          05125277
051253                   ,:WS-TUPCSKU-EDI-ORD-IND                       05125377
051254                   ,:WS-TUPCSKU-PLU-DWNLD-IND                     05125477
051255                   ,:WS-TUPCSKU-XREF-CRE-DTE                      05125577
051256                   ,:WS-TUPCSKU-UPC-DESC                          05125677
051257                   ,:WS-TUPCSKU-CERT-IND                          05125777
051258                   ,:WS-TUPCSKU-CERT-DTE                          05125877
051259                   ,:WS-TUPCSKU-UPC-SRC-IND                       05125977
051260                   ,:WS-TUPCSKU-UMDCLN-IND                        05126077
051261                  )                                               05126177
051262               END-EXEC                                           05126277
051263               MOVE WS-TUPCSKU-ITEM-NBR TO PV-HOLD-STRUCT2-KEY    05126377
051264            WHEN DS009-PROCESS-TABLE = 'TWEBITM'                  05126477
051265               EXEC SQL                                           05126577
051266                  INSERT INTO TWEBITM                             05126677
051267                    (                                             05126777
051268                       INTR_UPC_ID                                05126877
051269                      ,EFF_BEG_TMST                               05126977
051270                      ,EFF_END_TMST                               05127077
051280                      ,ASRT_BEG_DTE                               05128077
051290                      ,ASRT_END_DTE                               05129077
051300                      ,STRG_AREA_SEQ_NBR                          05130077
051400                      ,SHIP_WD_QTY                                05140077
051500                      ,SHIP_DPTH_QTY                              05150077
051600                      ,SHIP_HT_QTY                                05160077
051700                      ,SHIP_WT_QTY                                05170077
051800                      ,SHIP_DIM_SRC_CDE                           05180077
051900                      ,PKG_SEQ_NBR                                05190077
052000                      ,SHIP_RSTRC_SEQ_NBR                         05200077
052100                      ,GFT_WRAP_AVL_IND                           05210077
052200                      ,PRD_GP_NBR                                 05220077
052300                      ,PRD_GP_IND                                 05230077
052400                      ,SHIP_SRCHG_FEE_AMT                         05240077
052500                      ,SHIP_SRVC_SEQ_NBR                          05250077
052600                      ,SHIP_GP_SEQ_NBR                            05260077
052700                      ,CRE_BY_USR_ID                              05270077
052800                      ,WEB_ITM_DLTD_IND                           05280077
052900                      ,HAZDS_IND                                  05290077
053000                      ,BRKBL_IND                                  05300077
053100                      ,GC_IND                                     05310077
053200                      ,SHIP_ALN_IND                               05320077
053300                      ,WEB_EXCLV_IND                              05330077
053400                    )                                             05340077
053500                VALUES (                                          05350077
053600                       :WS-WEBITM-INTR-UPC-ID                     05360077
053700                      ,:WS-WEBITM-EFF-BEG-TMST                    05370077
053800                      ,:WS-WEBITM-EFF-END-TMST                    05380077
053900                       :WS-WEBITM-EFF-END-TMST-NN                 05390077
054000                      ,:WS-WEBITM-ASRT-BEG-DTE                    05400077
054100                      ,:WS-WEBITM-ASRT-END-DTE                    05410077
054200                      ,:WS-WEBITM-STRG-AREA-SEQ-NBR               05420077
054300                      ,:WS-WEBITM-SHIP-WD-QTY                     05430077
054400                      ,:WS-WEBITM-SHIP-DPTH-QTY                   05440077
054500                      ,:WS-WEBITM-SHIP-HT-QTY                     05450077
054600                      ,:WS-WEBITM-SHIP-WT-QTY                     05460077
054700                      ,:WS-WEBITM-SHIP-DIM-SRC-CDE                05470077
054800                      ,:WS-WEBITM-PKG-SEQ-NBR                     05480077
054900                      ,:WS-WEBITM-SHIP-RSTRC-SEQ-NBR              05490077
055000                      ,:WS-WEBITM-GFT-WRAP-AVL-IND                05500077
055100                      ,:WS-WEBITM-PRD-GP-NBR                      05510077
055200                      ,:WS-WEBITM-PRD-GP-IND                      05520077
055300                      ,:WS-WEBITM-SHIP-SRCHG-FEE-AMT              05530077
055400                      ,:WS-WEBITM-SHIP-SRVC-SEQ-NBR               05540077
055500                      ,:WS-WEBITM-SHIP-GP-SEQ-NBR                 05550077
055600                      ,:WS-WEBITM-CRE-BY-USR-ID                   05560077
055700                      ,:WS-WEBITM-WEB-ITM-DLTD-IND                05570077
055800                      ,:WS-WEBITM-HAZDS-IND                       05580077
055900                      ,:WS-WEBITM-BRKBL-IND                       05590077
056000                      ,:WS-WEBITM-GC-IND                          05600077
056100                      ,:WS-WEBITM-SHIP-ALN-IND                    05610077
056200                      ,:WS-WEBITM-WEB-EXCLV-IND                   05620077
056300                       )                                          05630077
056400               END-EXEC                                           05640077
056500               MOVE WS-WEBITM-INTR-UPC-ID TO PV-DOUBLE-COMP       05650077
056501               MOVE PV-DOUBLE-COMP        TO PV-HOLD-STRUCT2-KEY  05650177
056502            WHEN DS009-PROCESS-TABLE = 'TSKST'                    05650277
056503               EXEC SQL                                           05650377
056504                INSERT INTO TSKST                                 05650477
056505                  (                                               05650577
056506                    ITEM_NMBR                                     05650677
056507                   ,LOC_NBR                                       05650777
056508                   ,LAST_SALE_DATE                                05650877
056509                   ,LAST_RCVD_DATE                                05650977
056510                   ,ONHAND_QTY                                    05651077
056520                   ,FIRST_RCVD_DATE                               05652077
056530                   ,FIRST_SALE_DATE                               05653077
056540                   ,YTD_SALES_UNIT_QTY                            05654077
056550                   ,YTD_SALES_AMT                                 05655077
056560                   ,LAST_UPD_TMST                                 05656077
056570                  )                                               05657077
056580                VALUES (                                          05658077
056590                    :WS-SKST-ITEM-NMBR                            05659077
056600                   ,:WS-SKST-LOC-NBR                              05660077
056700                   ,:WS-SKST-LAST-SALE-DATE                       05670077
056800                   ,:WS-SKST-LAST-RCVD-DATE                       05680077
056900                   ,:WS-SKST-ONHAND-QTY                           05690077
057000                   ,:WS-SKST-FIRST-RCVD-DATE                      05700077
057100                   ,:WS-SKST-FIRST-SALE-DATE                      05710077
057200                   ,:WS-SKST-YTD-SALES-UNIT-QTY                   05720077
057300                   ,:WS-SKST-YTD-SALES-AMT                        05730077
057301                   ,:WS-SKST-LAST-UPD-TMST                        05730177
057302                  )                                               05730277
057303               END-EXEC                                           05730377
057304               MOVE WS-SKST-ITEM-NMBR   TO PV-HOLD-STRUCT2-KEY    05730477
057305            WHEN DS009-PROCESS-TABLE = 'TPPCPRC'                  05730577
057306               EXEC SQL                                           05730677
057307                INSERT INTO TPPCPRC                               05730777
057308                  (                                               05730877
057309                    TSK_ITM_NBR                                   05730977
057310                   ,STRT_TMST                                     05731077
057320                   ,STR_NBR                                       05732077
057330                   ,END_TMST                                      05733077
057340                   ,MEITGP_NBR                                    05734077
057350                   ,RTL_AMT                                       05735077
057360                   ,STATUS_CDE                                    05736077
057370                   ,UID_NBR                                       05737077
057380                  )                                               05738077
057390                VALUES (                                          05739077
057400                    :WS-PPCPRC-TSK-ITM-NBR                        05740077
057500                   ,:WS-PPCPRC-STRT-TMST                          05750077
057600                   ,:WS-PPCPRC-STR-NBR                            05760077
057700                   ,:WS-PPCPRC-END-TMST                           05770077
057800                   ,:WS-PPCPRC-MEITGP-NBR                         05780077
057900                   ,:WS-PPCPRC-RTL-AMT                            05790077
058000                   ,:WS-PPCPRC-STATUS-CDE                         05800077
058001                   ,:WS-PPCPRC-UID-NBR                            05800177
058002                  )                                               05800277
058003               END-EXEC                                           05800377
058004               MOVE WS-PPCPRC-TSK-ITM-NBR TO PV-HOLD-STRUCT2-KEY  05800477
058005               IF SQLCODE = -803                                  05800577
058006                   MOVE ZERO              TO SQLCODE              05800677
058007               END-IF                                             05800777
058008            WHEN DS009-PROCESS-TABLE = 'IMT_STYL_PRTNR'           05800877
058009               EXEC SQL                                           05800977
058010                INSERT INTO IMT_STYL_PRTNR                        05801077
058020                  (                                               05802077
058030                    SUB_CL_MDSEAR_ID                              05803077
058040                   ,VS_ID                                         05804077
058050                   ,BUS_PRTNR_ROL_CDE                             05805077
058051                   ,ENT_ID                                        05805177
058052                  )                                               05805277
058053                VALUES (                                          05805377
058054                    :DS008-IMT16-SUB-CL-MDSEAR-ID                 05805477
058055                   ,:DS008-IMT16-VS-ID                            05805577
058056                   ,:DS008-IMT16-BUS-PRTNR-ROL-CDE                05805677
058057                   ,:DS008-IMT16-ENT-ID                           05805777
058058                  )                                               05805877
058059               END-EXEC                                           05805977
058060               MOVE DS008-IMT16-VS-ID  TO PV-DOUBLE-COMP          05806077
058061               MOVE PV-DOUBLE-COMP     TO PV-HOLD-STRUCT2-KEY     05806177
058062            WHEN DS009-PROCESS-TABLE = 'IMT_LBL'                  05806277
058063               EXEC SQL                                           05806377
058064                INSERT INTO IMT_LBL                               05806477
058065                  (                                               05806577
058066                    LBL_SEQ_NBR                                   05806677
058067                   ,LBL_TYP_CDE                                   05806777
058068                   ,LBL_ABBR_NM                                   05806877
058069                   ,PRIC_TIER_SEQ_NBR                             05806977
058070                   ,LFSTYL_SEQ_NBR                                05807077
058071                  )                                               05807177
058072                VALUES (                                          05807277
058073                    :DS008-IMT00-LBL-SEQ-NBR                      05807377
058074                   ,:DS008-IMT00-LBL-TYP-CDE                      05807477
058075                   ,:DS008-IMT00-LBL-ABBR-NM                      05807577
058076                   ,:DS008-IMT00-PRIC-TIER-SEQ-NBR                05807677
058077                   ,:DS008-IMT00-LFSTYL-SEQ-NBR                   05807777
058078                  )                                               05807877
058079               END-EXEC                                           05807977
058080               MOVE DS008-IMT00-LBL-SEQ-NBR TO PV-HOLD-STRUCT2-KEY05808077
058081                                                                  05808177
058082     END-EVALUATE                                                 05808277
058083     END-PERFORM.                                                 05808377
058084                                                                  05808477
058085     PERFORM 9920-SQL-ABEND-INSERT.                               05808577
058086     PERFORM C102-ADD-TO-INSERT-COUNTS.                           05808677
058087                                                                  05808777
058088***************************************************************** 05808877
058089*    DETERMINE IF THE TMDSEAR ROW EXISTS FOR THE MDSEAR_DKEY      05808977
058090***************************************************************** 05809077
058091 R300-SELECT-TMDSEAR-DKEY.                                        05809177
058092     PERFORM WITH TEST AFTER                                      05809277
058093         VARYING DS009-RETRY-COUNTER FROM 1 BY 1                  05809377
058094         UNTIL   DS009-RETRY-COUNTER > 3 OR                       05809477
058095                 SQLCODE = ZERO OR +100                           05809577
058096         EXEC SQL                                                 05809677
058097            SELECT 1                                              05809777
058098                 INTO :PV-ONE                                     05809877
058099            FROM SYSIBM.SYSDUMMY1 X                               05809977
058100            WHERE EXISTS (SELECT 1                                05810077
058101                          FROM TMDSEAR                            05810177
058102                          WHERE MDSEAR_DKEY =                     05810277
058103                                    :HOLD-SUB-CL-MDSEAR-ID        05810377
058104                            AND X.IBMREQD = X.IBMREQD)            05810477
058105         END-EXEC                                                 05810577
058106     END-PERFORM.                                                 05810677
058107                                                                  05810777
058108     MOVE 'R300-SELECT-TMDSEAR-DKEY' TO DS009-PARAGRAPH.          05810877
058109     MOVE HOLD-SUB-CL-MDSEAR-ID TO PV-DOUBLE-COMP.                05810977
058110     MOVE PV-DOUBLE-COMP        TO PV-HOLD-STRUCT2-KEY.           05811077
058120     PERFORM 9900-SQL-ABEND-SELECT.                               05812077
058121                                                                  05812177
058122***************************************************************** 05812277
058123*    DETERMINE IF THE TMDSEAR ROW EXISTS FOR THE LIST_SEQ_NBR     05812377
058124***************************************************************** 05812477
058125 R301-SELECT-TMDSEAR-LIST-SEQ.                                    05812577
058126     PERFORM WITH TEST AFTER                                      05812677
058127         VARYING DS009-RETRY-COUNTER FROM 1 BY 1                  05812777
058128         UNTIL   DS009-RETRY-COUNTER > 3 OR                       05812877
058129                 SQLCODE = ZERO OR +100                           05812977
058130         EXEC SQL                                                 05813077
058140            SELECT MDSEAR_DKEY                                    05814077
058150              INTO :PV-MDSEAR-DKEY                                05815077
058160            FROM TMDSEAR                                          05816077
058161            WHERE LIST_SEQ_NBR = :WS-MDSEAR-LIST-SEQ-NBR          05816177
058162         END-EXEC                                                 05816277
058163     END-PERFORM.                                                 05816377
058164                                                                  05816477
058165     MOVE 'R301-SELECT-TMDSEAR-LIST-SEQ' TO DS009-PARAGRAPH.      05816577
058166     MOVE WS-MDSEAR-LIST-SEQ-NBR TO PV-HOLD-STRUCT2-KEY.          05816677
058167     PERFORM 9900-SQL-ABEND-SELECT.                               05816777
058168                                                                  05816877
058169***************************************************************** 05816977
058170*    DETERMINE IF THE TEXTENT ROW EXISTS                          05817077
058171***************************************************************** 05817177
058172 R305-SELECT-TEXTENT.                                             05817277
058173     PERFORM WITH TEST AFTER                                      05817377
058174         VARYING DS009-RETRY-COUNTER FROM 1 BY 1                  05817477
058175         UNTIL   DS009-RETRY-COUNTER > 3 OR                       05817577
058176                 SQLCODE = ZERO OR +100                           05817677
058177         EXEC SQL                                                 05817777
058178            SELECT 1                                              05817877
058179                 INTO :PV-ONE                                     05817977
058180            FROM SYSIBM.SYSDUMMY1 X                               05818077
058190            WHERE EXISTS (SELECT 1                                05819077
058191                          FROM TEXTENT                            05819177
058192                          WHERE ENT_ID = :HOLD-ENT-ID             05819277
058193                            AND X.IBMREQD = X.IBMREQD)            05819377
058194         END-EXEC                                                 05819477
058195     END-PERFORM.                                                 05819577
058196                                                                  05819677
058197     MOVE 'R305-SELECT-TEXTENT' TO DS009-PARAGRAPH.               05819777
058198     MOVE HOLD-ENT-ID           TO PV-DOUBLE-COMP.                05819877
058199     MOVE PV-DOUBLE-COMP        TO PV-HOLD-STRUCT2-KEY.           05819977
058200     PERFORM 9900-SQL-ABEND-SELECT.                               05820077
058201                                                                  05820177
058202***************************************************************** 05820277
058203*    SELECT THE TVNDSTL ROW                                       05820377
058204***************************************************************** 05820477
058205 R310-SELECT-TVNDSTL.                                             05820577
058206     PERFORM WITH TEST AFTER                                      05820677
058207         VARYING DS009-RETRY-COUNTER FROM 1 BY 1                  05820777
058208         UNTIL   DS009-RETRY-COUNTER > 3 OR                       05820877
058209                 SQLCODE = ZERO OR +100                           05820977
058210         EXEC SQL                                                 05821077
058211             SELECT EFF_END_DTE                                   05821177
058212             INTO   :VNDSTL-EFF-END-DTE :PV-VNDSTL-EFF-END-DTE-NN 05821277
058213             FROM TVNDSTL                                         05821377
058214             WHERE VS_ID = :HOLD-VS-ID                            05821477
058215         END-EXEC                                                 05821577
058216     END-PERFORM.                                                 05821677
058217                                                                  05821777
058218     MOVE 'R310-SELECT-TVNDSTL' TO DS009-PARAGRAPH.               05821877
058219     MOVE HOLD-VS-ID            TO PV-DOUBLE-COMP.                05821977
058220     MOVE PV-DOUBLE-COMP        TO PV-HOLD-STRUCT2-KEY.           05822077
058230     PERFORM 9900-SQL-ABEND-SELECT.                               05823077
058231                                                                  05823177
058232***************************************************************** 05823277
058233*    DETERMINE IF THE TVSCHVL ROW EXISTS                          05823377
058234***************************************************************** 05823477
058235 R315-SELECT-TVSCHVL.                                             05823577
058236     PERFORM WITH TEST AFTER                                      05823677
058237         VARYING DS009-RETRY-COUNTER FROM 1 BY 1                  05823777
058238         UNTIL   DS009-RETRY-COUNTER > 3 OR                       05823877
058239                 SQLCODE = ZERO OR +100                           05823977
058240         EXEC SQL                                                 05824077
058250            SELECT 1                                              05825077
058260                 INTO :PV-ONE                                     05826077
058270            FROM SYSIBM.SYSDUMMY1 X                               05827077
058280            WHERE EXISTS (SELECT 1                                05828077
058290                          FROM TVSCHVL                            05829077
058300                          WHERE CHARTC_CDE = :HOLD-CHARTC-CDE     05830077
058400                            AND CHARTC_SEQ_NBR =                  05840077
058401                                            :HOLD-CHARTC-SEQ-NBR  05840177
058402                            AND X.IBMREQD = X.IBMREQD)            05840277
058403         END-EXEC                                                 05840377
058404     END-PERFORM.                                                 05840477
058405                                                                  05840577
058406     MOVE 'R315-SELECT-TVSCHVL' TO DS009-PARAGRAPH.               05840677
058407     MOVE HOLD-CHARTC-CDE       TO PV-HOLD-STRUCT2-KEY.           05840777
058408     PERFORM 9900-SQL-ABEND-SELECT.                               05840877
058409                                                                  05840977
058410***************************************************************** 05841077
058411*    SELECT THE TMDARVS ROW                                       05841177
058412***************************************************************** 05841277
058413 R320-SELECT-TMDARVS.                                             05841377
058414     PERFORM WITH TEST AFTER                                      05841477
058415         VARYING DS009-RETRY-COUNTER FROM 1 BY 1                  05841577
058416         UNTIL   DS009-RETRY-COUNTER > 3 OR                       05841677
058417                 SQLCODE = ZERO OR +100                           05841777
058418         EXEC SQL                                                 05841877
058419             SELECT ACTV_IND                                      05841977
058420                   ,RMS_STYL_ID                                   05842077
058421             INTO   :MDARVS-ACTV-IND                              05842177
058422                   ,:MDARVS-RMS-STYL-ID                           05842277
058423             FROM TMDARVS                                         05842377
058424             WHERE SUB_CL_MDSEAR_ID = :HOLD-SUB-CL-MDSEAR-ID      05842477
058425               AND VS_ID            = :HOLD-VS-ID                 05842577
058426         END-EXEC                                                 05842677
058427     END-PERFORM.                                                 05842777
058428                                                                  05842877
058429     MOVE 'R320-SELECT-TMDARVS' TO DS009-PARAGRAPH.               05842977
058430     MOVE HOLD-VS-ID            TO PV-DOUBLE-COMP.                05843077
058431     MOVE PV-DOUBLE-COMP        TO PV-HOLD-STRUCT2-KEY.           05843177
058432     PERFORM 9900-SQL-ABEND-SELECT.                               05843277
058433                                                                  05843377
058434***************************************************************** 05843477
058435*    OPEN THE RECLASS STYLE CURSOR                                05843577
058436***************************************************************** 05843677
058437 R325-OPEN-RECLASS-STYLE-CSR.                                     05843777
058438     PERFORM WITH TEST AFTER                                      05843877
058439         VARYING DS009-RETRY-COUNTER FROM 1 BY 1                  05843977
058440         UNTIL   DS009-RETRY-COUNTER > 3 OR                       05844077
058441                 SQLCODE = ZERO OR +100                           05844177
058442         EXEC SQL                                                 05844277
058443             OPEN RECLASS_STYLE_CSR                               05844377
058444         END-EXEC                                                 05844477
058445     END-PERFORM.                                                 05844577
058446                                                                  05844677
058447     MOVE 'R325-OPEN-RECLASS-STYLE-CSR'                           05844777
058448                                TO DS009-PARAGRAPH.               05844877
058449     MOVE HOLD-VS-ID            TO PV-DOUBLE-COMP.                05844977
058450     MOVE PV-DOUBLE-COMP        TO PV-HOLD-STRUCT2-KEY.           05845077
058460     PERFORM 9900-SQL-ABEND-SELECT.                               05846077
058461                                                                  05846177
058462***************************************************************** 05846277
058463*   FETCH THE TMDARVS ROWS FOR A STYLE THAT NEEDS TO BE RECLASSED 05846377
058464***************************************************************** 05846477
058465 R326-FETCH-RECLASS-STYLE-CSR.                                    05846577
058466     PERFORM WITH TEST AFTER                                      05846677
058467         VARYING DS009-RETRY-COUNTER FROM 1 BY 1                  05846777
058468         UNTIL   DS009-RETRY-COUNTER > 3 OR                       05846877
058469                 SQLCODE = ZERO OR +100                           05846977
058470         EXEC SQL                                                 05847077
058471             FETCH RECLASS_STYLE_CSR                              05847177
058472             INTO  :MDARVS-SUB-CL-MDSEAR-ID                       05847277
058473         END-EXEC                                                 05847377
058474     END-PERFORM.                                                 05847477
058475                                                                  05847577
058476     IF SQLCODE = +100                                            05847677
058477         SET PS-END-OF-RECLASS-STYLES TO TRUE                     05847777
058478     END-IF.                                                      05847877
058479                                                                  05847977
058480     MOVE 'R326-FETCH-RECLASS-STYLE-CSR'                          05848077
058481                                TO DS009-PARAGRAPH.               05848177
058482     MOVE HOLD-VS-ID            TO PV-DOUBLE-COMP.                05848277
058483     MOVE PV-DOUBLE-COMP        TO PV-HOLD-STRUCT2-KEY.           05848377
058484     PERFORM 9900-SQL-ABEND-SELECT.                               05848477
058485                                                                  05848577
058486***************************************************************** 05848677
058487*    CLOSE THE RECLASS STYLE CURSOR                               05848777
058488***************************************************************** 05848877
058489 R327-CLOSE-RECLASS-STYLE-CSR.                                    05848977
058490     PERFORM WITH TEST AFTER                                      05849077
058491         VARYING DS009-RETRY-COUNTER FROM 1 BY 1                  05849177
058492         UNTIL   DS009-RETRY-COUNTER > 3 OR                       05849277
058493                 SQLCODE = ZERO OR +100                           05849377
058494         EXEC SQL                                                 05849477
058495             CLOSE RECLASS_STYLE_CSR                              05849577
058496         END-EXEC                                                 05849677
058497     END-PERFORM.                                                 05849777
058498                                                                  05849877
058499     MOVE 'R327-CLOSE-RECLASS-STYLE-CSR'                          05849977
058500                                TO DS009-PARAGRAPH.               05850077
058600     MOVE HOLD-VS-ID            TO PV-DOUBLE-COMP.                05860077
058601     MOVE PV-DOUBLE-COMP        TO PV-HOLD-STRUCT2-KEY.           05860177
058602     PERFORM 9900-SQL-ABEND-SELECT.                               05860277
058603                                                                  05860377
058604***************************************************************** 05860477
058605*    SELECT THE TUPC ROW                                          05860577
058606***************************************************************** 05860677
058607 R330-SELECT-TUPC.                                                05860777
058608     PERFORM WITH TEST AFTER                                      05860877
058609         VARYING DS009-RETRY-COUNTER FROM 1 BY 1                  05860977
058610         UNTIL   DS009-RETRY-COUNTER > 3 OR                       05861077
058611                 SQLCODE = ZERO OR +100                           05861177
058612         EXEC SQL                                                 05861277
058613             SELECT EFF_END_DTE                                   05861377
058614                   ,UPC_TYP_CDE                                   05861477
058615             INTO   :UPC-EFF-END-DTE :PV-UPC-EFF-END-DTE-NN       05861577
058616                   ,:UPC-UPC-TYP-CDE                              05861677
058617             FROM TUPC                                            05861777
058618             WHERE UPC_ID = :HOLD-UPC-ID                          05861877
058619         END-EXEC                                                 05861977
058620     END-PERFORM.                                                 05862077
058621                                                                  05862177
058622     MOVE 'R330-SELECT-TUPC' TO DS009-PARAGRAPH.                  05862277
058623     MOVE HOLD-UPC-ID           TO PV-DOUBLE-COMP.                05862377
058624     MOVE PV-DOUBLE-COMP        TO PV-HOLD-STRUCT2-KEY.           05862477
058625     PERFORM 9900-SQL-ABEND-SELECT.                               05862577
058626                                                                  05862677
058627***************************************************************** 05862777
058628*    SELECT THE ACTIVE TUPCPLS ROW                                05862877
058629***************************************************************** 05862977
058630 R340-SELECT-TUPCPLS.                                             05863077
058631     PERFORM WITH TEST AFTER                                      05863177
058632         VARYING DS009-RETRY-COUNTER FROM 1 BY 1                  05863277
058633         UNTIL   DS009-RETRY-COUNTER > 3 OR                       05863377
058634                 SQLCODE = ZERO OR +100                           05863477
058635         EXEC SQL                                                 05863577
058636             SELECT EFF_BEG_TMST                                  05863677
058637                   ,EFF_END_TMST                                  05863777
058638                   ,UPC_STAT_CDE                                  05863877
058639                   ,UNT_COST_AMT                                  05863977
058640                   ,UNT_RTL_AMT                                   05864077
058650                   ,MEITGP_NBR                                    05865077
058660                   ,ITM_NBR                                       05866077
058670                   ,PLU_IND                                       05867077
058680                   ,UPC_STAT_CHG_DTE                              05868077
058690                   ,UNT_RTL_CHG_DTE                               05869077
058700             INTO   :UPCPLS-EFF-BEG-TMST                          05870077
058800                   ,:UPCPLS-EFF-END-TMST:PV-UPCPLS-EFF-END-TMST-NN05880077
058900                   ,:UPCPLS-UPC-STAT-CDE:PV-UPCPLS-UPC-STAT-CDE-NN05890077
059000                   ,:UPCPLS-UNT-COST-AMT:PV-UPCPLS-UNT-COST-AMT-NN05900077
059100                   ,:UPCPLS-UNT-RTL-AMT:PV-UPCPLS-UNT-RTL-AMT-NN  05910077
059200                   ,:UPCPLS-MEITGP-NBR:PV-UPCPLS-MEITGP-NBR-NN    05920077
059300                   ,:UPCPLS-ITM-NBR                               05930077
059400                   ,:UPCPLS-PLU-IND                               05940077
059500                   ,:UPCPLS-UPC-STAT-CHG-DTE                      05950077
059600                   ,:UPCPLS-UNT-RTL-CHG-DTE                       05960077
059700             FROM TUPCPLS                                         05970077
059800             WHERE UPC_ID     = :HOLD-UPC-ID                      05980077
059900               AND OPERCO_NBR = '03'                              05990077
060000               AND STR_NBR    = :PV-HOLD-STR-NBR                  06000077
060100               AND EFF_END_TMST IS NULL                           06010077
060101             WITH UR                                              06010177
060102         END-EXEC                                                 06010277
060103     END-PERFORM.                                                 06010377
060104                                                                  06010477
060105     MOVE 'R340-SELECT-TUPCPLS' TO DS009-PARAGRAPH.               06010577
060106     MOVE HOLD-UPC-ID           TO PV-DOUBLE-COMP.                06010677
060107     MOVE PV-DOUBLE-COMP        TO PV-HOLD-STRUCT2-KEY.           06010777
060108     PERFORM 9900-SQL-ABEND-SELECT.                               06010877
060109                                                                  06010977
060110*    IF AN ACTIVE ROW IS NOT FOUND, SELECT THE MOST RECENTLY      06011077
060120*    EXPIRED TUPCPLS ROW                                          06012077
060130     IF SQLCODE = +100                                            06013077
060140         PERFORM R345-SELECT-TUPCPLS-EXPIRED                      06014077
060150     END-IF.                                                      06015077
060151                                                                  06015177
060152***************************************************************** 06015277
060153*    SELECT THE MOST RECENT EXPIRED TUPCPLS ROW                   06015377
060154***************************************************************** 06015477
060155 R345-SELECT-TUPCPLS-EXPIRED.                                     06015577
060156     PERFORM WITH TEST AFTER                                      06015677
060157         VARYING DS009-RETRY-COUNTER FROM 1 BY 1                  06015777
060158         UNTIL   DS009-RETRY-COUNTER > 3 OR                       06015877
060159                 SQLCODE = ZERO OR +100                           06015977
060160         EXEC SQL                                                 06016077
060170             SELECT EFF_BEG_TMST                                  06017077
060180                   ,EFF_END_TMST                                  06018077
060190                   ,UPC_STAT_CDE                                  06019077
060200                   ,UNT_COST_AMT                                  06020077
060300                   ,UNT_RTL_AMT                                   06030077
060400                   ,MEITGP_NBR                                    06040077
060500                   ,ITM_NBR                                       06050077
060600                   ,PLU_IND                                       06060077
060700                   ,UPC_STAT_CHG_DTE                              06070077
060800                   ,UNT_RTL_CHG_DTE                               06080077
060900             INTO   :UPCPLS-EFF-BEG-TMST                          06090077
061000                   ,:UPCPLS-EFF-END-TMST:PV-UPCPLS-EFF-END-TMST-NN06100077
061100                   ,:UPCPLS-UPC-STAT-CDE:PV-UPCPLS-UPC-STAT-CDE-NN06110077
061200                   ,:UPCPLS-UNT-COST-AMT:PV-UPCPLS-UNT-COST-AMT-NN06120077
061300                   ,:UPCPLS-UNT-RTL-AMT:PV-UPCPLS-UNT-RTL-AMT-NN  06130077
061400                   ,:UPCPLS-MEITGP-NBR:PV-UPCPLS-MEITGP-NBR-NN    06140077
061500                   ,:UPCPLS-ITM-NBR                               06150077
061600                   ,:UPCPLS-PLU-IND                               06160077
061700                   ,:UPCPLS-UPC-STAT-CHG-DTE                      06170077
061800                   ,:UPCPLS-UNT-RTL-CHG-DTE                       06180077
061900             FROM TUPCPLS                                         06190077
062000             WHERE UPC_ID     = :HOLD-UPC-ID                      06200077
062100               AND OPERCO_NBR = '03'                              06210077
062200               AND STR_NBR    = :PV-HOLD-STR-NBR                  06220077
062300               AND EFF_END_TMST =                                 06230077
062400                   (SELECT MAX(EFF_END_TMST)                      06240077
062500                    FROM TUPCPLS                                  06250077
062600                    WHERE  UPC_ID       = :HOLD-UPC-ID            06260077
062700                      AND  OPERCO_NBR   = '03'                    06270077
062800                      AND  STR_NBR      = :PV-HOLD-STR-NBR)       06280077
062801             WITH UR                                              06280177
062802         END-EXEC                                                 06280277
062803     END-PERFORM.                                                 06280377
062804                                                                  06280477
062805     MOVE 'R345-SELECT-TUPCPLS-EXPIRED' TO DS009-PARAGRAPH.       06280577
062806     MOVE HOLD-UPC-ID           TO PV-DOUBLE-COMP.                06280677
062807     MOVE PV-DOUBLE-COMP        TO PV-HOLD-STRUCT2-KEY.           06280777
062808     PERFORM 9900-SQL-ABEND-SELECT.                               06280877
062809                                                                  06280977
062810***************************************************************** 06281077
062811*    SELECT THE TSKXREF ROW                                       06281177
062812***************************************************************** 06281277
062813 R350-SELECT-TSKXREF.                                             06281377
062814     PERFORM WITH TEST AFTER                                      06281477
062815         VARYING DS009-RETRY-COUNTER FROM 1 BY 1                  06281577
062816         UNTIL   DS009-RETRY-COUNTER > 3 OR                       06281677
062817                 SQLCODE = ZERO OR +100                           06281777
062818         EXEC SQL                                                 06281877
062819            SELECT 1                                              06281977
062820                 INTO :PV-ONE                                     06282077
062830            FROM SYSIBM.SYSDUMMY1  X                              06283077
062840            WHERE EXISTS (SELECT 1                                06284077
062841                          FROM TSKXREF                            06284177
062842                          WHERE ITM_NBR = :HOLD-ITM-NBR           06284277
062843                            AND X.IBMREQD = X.IBMREQD)            06284377
062844         END-EXEC                                                 06284477
062845     END-PERFORM.                                                 06284577
062846                                                                  06284677
062847***************************************************************** 06284777
062848*    SELECT THE TVNDDPT ROW                                       06284877
062849***************************************************************** 06284977
062850 R355-SELECT-TVNDDPT.                                             06285077
062851     PERFORM WITH TEST AFTER                                      06285177
062852         VARYING DS009-RETRY-COUNTER FROM 1 BY 1                  06285277
062853         UNTIL   DS009-RETRY-COUNTER > 3 OR                       06285377
062854                 SQLCODE = ZERO OR +100                           06285477
062855         EXEC SQL                                                 06285577
062856            SELECT 1                                              06285677
062857                 INTO :PV-ONE                                     06285777
062858            FROM SYSIBM.SYSDUMMY1  X                              06285877
062859            WHERE EXISTS (SELECT 1                                06285977
062860                          FROM TVNDDPT                            06286077
062861                          WHERE ENT_ID    = :HOLD-ENT-ID          06286177
062862                            AND DEPT_NBR  = :HOLD-DEPT-NBR        06286277
062863                            AND X.IBMREQD = X.IBMREQD)            06286377
062864         END-EXEC                                                 06286477
062865     END-PERFORM.                                                 06286577
062866                                                                  06286677
062867     MOVE 'R355-SELECT-TVNDDPT' TO DS009-PARAGRAPH.               06286777
062868     MOVE HOLD-ENT-ID           TO PV-DOUBLE-COMP.                06286877
062869     MOVE PV-DOUBLE-COMP        TO PV-HOLD-STRUCT2-KEY.           06286977
062870     PERFORM 9900-SQL-ABEND-SELECT.                               06287077
062871                                                                  06287177
062872***************************************************************** 06287277
062873*    SELECT THE TWEBITM ROW                                       06287377
062874***************************************************************** 06287477
062875 R360-SELECT-ACTIVE-TWEBITM.                                      06287577
062876     PERFORM WITH TEST AFTER                                      06287677
062877         VARYING DS009-RETRY-COUNTER FROM 1 BY 1                  06287777
062878         UNTIL   DS009-RETRY-COUNTER > 3 OR                       06287877
062879                 SQLCODE = ZERO OR +100                           06287977
062880         EXEC SQL                                                 06288077
062890             SELECT EFF_BEG_TMST                                  06289077
062900                   ,EFF_END_TMST                                  06290077
063000             INTO   :WEBITM-EFF-BEG-TMST                          06300077
063100                   ,:WEBITM-EFF-END-TMST:PV-WEBITM-EFF-END-TMST-NN06310077
063200             FROM TWEBITM                                         06320077
063201             WHERE INTR_UPC_ID  = :HOLD-INTR-UPC-ID               06320177
063202               AND EFF_END_TMST IS NULL                           06320277
063203         END-EXEC                                                 06320377
063204     END-PERFORM.                                                 06320477
063205                                                                  06320577
063206     MOVE 'R360-SELECT-ACTIVE-TWEBITM' TO DS009-PARAGRAPH.        06320677
063207     MOVE HOLD-INTR-UPC-ID      TO PV-DOUBLE-COMP.                06320777
063208     MOVE PV-DOUBLE-COMP        TO PV-HOLD-STRUCT2-KEY.           06320877
063209     PERFORM 9900-SQL-ABEND-SELECT.                               06320977
063210                                                                  06321077
063211***************************************************************** 06321177
063212*    UPDATE ALL FIELDS ON AN ACTIVE TVNDSTL ROW                   06321277
063213***************************************************************** 06321377
063214 U100-UPDATE-TVNDSTL.                                             06321477
063215     PERFORM WITH TEST AFTER                                      06321577
063216         VARYING DS009-RETRY-COUNTER FROM 1 BY 1                  06321677
063217         UNTIL   DS009-RETRY-COUNTER > 3 OR                       06321777
063218                 SQLCODE = ZERO                                   06321877
063219         EXEC SQL                                                 06321977
063220             UPDATE TVNDSTL                                       06322077
063221             SET ENT_ID        = :WS-VNDSTL-ENT-ID                06322177
063222                ,VS_NBR        = :WS-VNDSTL-VS-NBR                06322277
063223                ,EFF_BEG_DTE   = :WS-VNDSTL-EFF-BEG-DTE           06322377
063224                                 :WS-VNDSTL-EFF-BEG-DTE-NN        06322477
063225                ,COST_UM_CDE   = :WS-VNDSTL-COST-UM-CDE           06322577
063226                ,RTL_UM_CDE    = :WS-VNDSTL-RTL-UM-CDE            06322677
063227                ,BYP_CAT_IND   = :WS-VNDSTL-BYP-CAT-IND           06322777
063228                ,CRE_BY_USR_ID = :WS-VNDSTL-CRE-BY-USR-ID         06322877
063229                ,LAST_UPD_BY_USR_ID                               06322977
063230                               = :WS-VNDSTL-LAST-UPD-BY-USR-ID    06323077
063240                ,LAST_UPD_TMST = :WS-VNDSTL-LAST-UPD-TMST         06324077
063241             WHERE VS_ID = :HOLD-VS-ID                            06324177
063242         END-EXEC                                                 06324277
063243     END-PERFORM.                                                 06324377
063244                                                                  06324477
063245     MOVE 'U100-UPDATE-TVNDSTL' TO DS009-PARAGRAPH.               06324577
063246     MOVE HOLD-VS-ID            TO PV-DOUBLE-COMP.                06324677
063247     MOVE PV-DOUBLE-COMP        TO PV-HOLD-STRUCT2-KEY.           06324777
063248     PERFORM 9910-SQL-ABEND-UPDATE.                               06324877
063249     PERFORM C103-ADD-TO-UPDATE-COUNTS.                           06324977
063250                                                                  06325077
063251***************************************************************** 06325177
063252*    UPDATE ALL FIELDS ON AN ACTIVE TMDARVS ROW                   06325277
063253***************************************************************** 06325377
063254 U110-UPDATE-TMDARVS.                                             06325477
063255     PERFORM WITH TEST AFTER                                      06325577
063256         VARYING DS009-RETRY-COUNTER FROM 1 BY 1                  06325677
063257         UNTIL   DS009-RETRY-COUNTER > 3 OR                       06325777
063258                 SQLCODE = ZERO                                   06325877
063259         EXEC SQL                                                 06325977
063260             UPDATE TMDARVS                                       06326077
063261             SET VS_DESC            = :WS-MDARVS-VS-DESC          06326177
063262                ,STKR_NBR           = :WS-MDARVS-STKR-NBR         06326277
063263                ,TKT_TYP_SEQ_NBR    = :WS-MDARVS-TKT-TYP-SEQ-NBR  06326377
063264                ,LBL_SEQ_NBR        = :WS-MDARVS-LBL-SEQ-NBR      06326477
063265                ,HNG_FOLD_SEQ_NBR   = :WS-MDARVS-HNG-FOLD-SEQ-NBR 06326577
063266                ,KY_CLSN_SEQ_NBR    = :WS-MDARVS-KY-CLSN-SEQ-NBR  06326677
063267                ,FBRCN_SEQ_NBR      = :WS-MDARVS-FBRCN-SEQ-NBR    06326777
063268                ,FNSH_SEQ_NBR       = :WS-MDARVS-FNSH-SEQ-NBR     06326877
063269                ,RMS_STYL_ID        = :WS-MDARVS-RMS-STYL-ID      06326977
063270                ,STYL_RECLS_IND     = :WS-MDARVS-STYL-RECLS-IND   06327077
063271                ,RTL_CLSN_SEQ_NBR   = :WS-MDARVS-RTL-CLSN-SEQ-NBR 06327177
063272                ,DEPT_NBR           = :WS-MDARVS-DEPT-NBR         06327277
063273                ,MAJ_CL_NBR         = :WS-MDARVS-MAJ-CL-NBR       06327377
063274                ,SUB_CL_NBR         = :WS-MDARVS-SUB-CL-NBR       06327477
063275                ,ESL_SEQ_NBR        = :WS-MDARVS-ESL-SEQ-NBR      06327577
063276                ,RPT_HIER_SEQ_NBR   = :WS-MDARVS-RPT-HIER-SEQ-NBR 06327677
063277                ,BDY_STYL_SEQ_NBR   = :WS-MDARVS-BDY-STYL-SEQ-NBR 06327777
063278                ,CONST_SEQ_NBR      = :WS-MDARVS-CONST-SEQ-NBR    06327877
063279                ,FUNC_SEQ_NBR       = :WS-MDARVS-FUNC-SEQ-NBR     06327977
063280                ,GNDR_SEQ_NBR       = :WS-MDARVS-GNDR-SEQ-NBR     06328077
063290                ,PATRN_SEQ_NBR      = :WS-MDARVS-PATRN-SEQ-NBR    06329077
063300                ,SLHTT_SEQ_NBR      = :WS-MDARVS-SLHTT-SEQ-NBR    06330077
063400                ,CLLCTN_SEQ_NBR     = :WS-MDARVS-CLLCTN-SEQ-NBR   06340077
063500                ,MAP_UNT_RTL_AMT    = :WS-MDARVS-MAP-UNT-RTL-AMT  06350077
063600                ,C_O_ORGN_CDE       = :WS-MDARVS-C-O-ORGN-CDE     06360077
063700                ,PRIC_TIER_SEQ_NBR  = :WS-MDARVS-PRIC-TIER-SEQ-NBR06370077
063800                ,LFSTYL_SEQ_NBR     = :WS-MDARVS-LFSTYL-SEQ-NBR   06380077
063900                ,CUST_INTFC_DESC    = :WS-MDARVS-CUST-INTFC-DESC  06390077
064000                ,FSHN_PYRMD_SEQ_NBR =                             06400077
064100                                    :WS-MDARVS-FSHN-PYRMD-SEQ-NBR 06410077
064200                ,PRFL_GP_NM_TXT     = :WS-MDARVS-PRFL-GP-NM-TXT   06420077
064300                ,CTG_SEQ_NBR        = :WS-MDARVS-CTG-SEQ-NBR      06430077
064400                ,MAJ_CTG_SEQ_NBR    = :WS-MDARVS-MAJ-CTG-SEQ-NBR  06440077
064500                ,MTRL_SEQ_NBR       = :WS-MDARVS-MTRL-SEQ-NBR     06450077
064600                ,PRIM_TRND_SEQ_NBR  = :WS-MDARVS-PRIM-TRND-SEQ-NBR06460077
064700                ,SEC_TRND_SEQ_NBR   = :WS-MDARVS-SEC-TRND-SEQ-NBR 06470077
064800                ,ATTR_1_SEQ_NBR     = :WS-MDARVS-ATTR-1-SEQ-NBR   06480077
064900                ,ATTR_2_SEQ_NBR     = :WS-MDARVS-ATTR-2-SEQ-NBR   06490077
065000                ,NW_SLHTT_SEQ_NBR   = :WS-MDARVS-NW-SLHTT-SEQ-NBR 06500077
065100             WHERE SUB_CL_MDSEAR_ID = :HOLD-SUB-CL-MDSEAR-ID      06510077
065101               AND VS_ID            = :HOLD-VS-ID                 06510177
065102         END-EXEC                                                 06510277
065103     END-PERFORM.                                                 06510377
065104                                                                  06510477
065105     MOVE 'U110-UPDATE-TMDARVS' TO DS009-PARAGRAPH.               06510577
065106     MOVE HOLD-VS-ID            TO PV-DOUBLE-COMP.                06510677
065107     MOVE PV-DOUBLE-COMP        TO PV-HOLD-STRUCT2-KEY.           06510777
065108     PERFORM 9910-SQL-ABEND-UPDATE.                               06510877
065109     PERFORM C103-ADD-TO-UPDATE-COUNTS.                           06510977
065110                                                                  06511077
065111***************************************************************** 06511177
065112*    UPDATE THE ACTV_IND FIELD ON AN INSERTED TMDARVS ROW         06511277
065113***************************************************************** 06511377
065114 U115-UPDATE-TMDARVS-ACTV-IND.                                    06511477
065115     PERFORM WITH TEST AFTER                                      06511577
065116         VARYING DS009-RETRY-COUNTER FROM 1 BY 1                  06511677
065117         UNTIL   DS009-RETRY-COUNTER > 3 OR                       06511777
065118                 SQLCODE = ZERO                                   06511877
065119         EXEC SQL                                                 06511977
065120             UPDATE TMDARVS                                       06512077
065130             SET ACTV_IND           = 'Y'                         06513077
065140             WHERE SUB_CL_MDSEAR_ID = :HOLD-SUB-CL-MDSEAR-ID      06514077
065141               AND VS_ID            = :HOLD-VS-ID                 06514177
065142         END-EXEC                                                 06514277
065143     END-PERFORM.                                                 06514377
065144                                                                  06514477
065145     MOVE 'U115-UPDATE-TMDARVS-ACTV-IND' TO DS009-PARAGRAPH.      06514577
065146     MOVE HOLD-VS-ID                     TO PV-DOUBLE-COMP.       06514677
065147     MOVE PV-DOUBLE-COMP                 TO PV-HOLD-STRUCT2-KEY.  06514777
065148     PERFORM 9910-SQL-ABEND-UPDATE.                               06514877
065149     PERFORM C103-ADD-TO-UPDATE-COUNTS.                           06514977
065150                                                                  06515077
065151***************************************************************** 06515177
065152*    UPDATE THE ACTV_IND AND STYL_RECL_IND FIELDS ON A TMDARVS ROW06515277
065153***************************************************************** 06515377
065154 U116-TMDARVS-RECLASS-UPDATE.                                     06515477
065155     PERFORM WITH TEST AFTER                                      06515577
065156         VARYING DS009-RETRY-COUNTER FROM 1 BY 1                  06515677
065157         UNTIL   DS009-RETRY-COUNTER > 3 OR                       06515777
065158                 SQLCODE = ZERO                                   06515877
065159         EXEC SQL                                                 06515977
065160             UPDATE TMDARVS                                       06516077
065170             SET ACTV_IND           = 'N'                         06517077
065180                ,STYL_RECLS_IND     = 'Y'                         06518077
065190             WHERE SUB_CL_MDSEAR_ID = :HOLD-SUB-CL-MDSEAR-ID      06519077
065191               AND VS_ID            = :HOLD-VS-ID                 06519177
065192         END-EXEC                                                 06519277
065193     END-PERFORM.                                                 06519377
065194                                                                  06519477
065195     MOVE 'U116-TMDARVS-RECLASS-UPDATE'  TO DS009-PARAGRAPH.      06519577
065196     MOVE HOLD-VS-ID                     TO PV-DOUBLE-COMP.       06519677
065197     MOVE PV-DOUBLE-COMP                 TO PV-HOLD-STRUCT2-KEY.  06519777
065198     PERFORM 9910-SQL-ABEND-UPDATE.                               06519877
065199     PERFORM C103-ADD-TO-UPDATE-COUNTS.                           06519977
065200                                                                  06520077
065201***************************************************************** 06520177
065202*    UPDATE ALL FIELDS ON AN AN ACTIVE TUPC ROW                   06520277
065203***************************************************************** 06520377
065204 U120-UPDATE-TUPC.                                                06520477
065205     IF WS-UPC-PO-SHRT-CYC-IND = SPACE                            06520577
065206         MOVE 'N' TO WS-UPC-PO-SHRT-CYC-IND                       06520677
065207     END-IF.                                                      06520777
065208     PERFORM WITH TEST AFTER                                      06520877
065209         VARYING DS009-RETRY-COUNTER FROM 1 BY 1                  06520977
065210         UNTIL   DS009-RETRY-COUNTER > 3 OR                       06521077
065211                 SQLCODE = ZERO                                   06521177
065212         EXEC SQL                                                 06521277
065213             UPDATE TUPC                                          06521377
065214             SET UPC_NBR            = :WS-UPC-UPC-NBR             06521477
065215                ,SUB_CL_MDSEAR_ID   = :WS-UPC-SUB-CL-MDSEAR-ID    06521577
065216                ,VS_ID              = :WS-UPC-VS-ID               06521677
065217                ,INTR_UPC_ID        = :WS-UPC-INTR-UPC-ID         06521777
065218                ,EFF_BEG_DTE        = :WS-UPC-EFF-BEG-DTE         06521877
065219                ,UPC_TYP_CDE        = :WS-UPC-UPC-TYP-CDE         06521977
065220                ,KOHLS_SIZE_CDE     = :WS-UPC-KOHLS-SIZE-CDE      06522077
065221                ,NRF_SIZE_IND       = :WS-UPC-NRF-SIZE-IND        06522177
065222                ,NRF_CLOR_CDE       = :WS-UPC-NRF-CLOR-CDE        06522277
065223                ,NRF_CLOR_IND       = :WS-UPC-NRF-CLOR-IND        06522377
065224                ,CSTM_CLOR_DESC     = :WS-UPC-CSTM-CLOR-DESC      06522477
065225                ,EDI_ORD_IND        = :WS-UPC-EDI-ORD-IND         06522577
065226                ,PREPK_IND          = :WS-UPC-PREPK-IND           06522677
065227                ,GP_CDE             = :WS-UPC-GP-CDE              06522777
065228                ,CERTD_IND          = :WS-UPC-CERTD-IND           06522877
065229                ,CERTD_DTE          = :WS-UPC-CERTD-DTE           06522977
065230                ,RPLNMT_IND         = :WS-UPC-RPLNMT-IND          06523077
065231                ,KY_ITM_IND         = :WS-UPC-KY-ITM-IND          06523177
065232                ,UNT_COST_1ST_AMT   = :WS-UPC-UNT-COST-1ST-AMT    06523277
065233                ,UPC_SRC_CDE        = :WS-UPC-UPC-SRC-CDE         06523377
065234                ,INNR_PK_QTY        = :WS-UPC-INNR-PK-QTY         06523477
065235                ,OUTR_PK_QTY        = :WS-UPC-OUTR-PK-QTY         06523577
065236                ,SEA_SEQ_NBR        = :WS-UPC-SEA-SEQ-NBR         06523677
065237                ,CRE_BY_USR_ID      = :WS-UPC-CRE-BY-USR-ID       06523777
065238                ,LAST_UPD_BY_USR_ID = :WS-UPC-LAST-UPD-BY-USR-ID  06523877
065239                ,LAST_UPD_TMST      = :WS-UPC-LAST-UPD-TMST       06523977
065240                ,WD_UM_QTY          = :WS-UPC-WD-UM-QTY           06524077
065241                ,DPTH_UM_QTY        = :WS-UPC-DPTH-UM-QTY         06524177
065242                ,HT_UM_QTY          = :WS-UPC-HT-UM-QTY           06524277
065243                ,SIZE_UM_CDE        = :WS-UPC-SIZE-UM-CDE         06524377
065244                ,WT_UM_QTY          = :WS-UPC-WT-UM-QTY           06524477
065245                ,WT_UM_CDE          = :WS-UPC-WT-UM-CDE           06524577
065246                ,POG_IND            = :WS-UPC-POG-IND             06524677
065247                ,REGN_PRIC_IND      = :WS-UPC-REGN-PRIC-IND       06524777
065248                ,TX_PRD_CDE_SEQ_NBR = :WS-UPC-TX-PRD-CDE-SEQ-NBR  06524877
065249                ,CUSTFACG_CLOR_DESC = :WS-UPC-CUSTFACG-CLOR-DESC  06524977
065250                ,INTR_UPC_DESC      = :WS-UPC-INTR-UPC-DESC       06525077
065260                ,TRNSTN_IND         = :WS-UPC-TRNSTN-IND          06526077
065270                ,PO_SHRT_CYC_IND    = :WS-UPC-PO-SHRT-CYC-IND     06527077
065280                ,TST_PRD_TYP_SEQ_NBR                              06528077
065290                                    = :WS-UPC-TST-PRD-TYP-SEQ-NBR 06529077
065300                ,WHSE_RPLNT_IND     = :WS-UPC-WHSE-RPLNT-IND      06530077
065301             WHERE UPC_ID = :HOLD-UPC-ID                          06530177
065302         END-EXEC                                                 06530277
065303     END-PERFORM.                                                 06530377
065304                                                                  06530477
065305     MOVE 'U120-UPDATE-TUPC' TO DS009-PARAGRAPH.                  06530577
065306     MOVE HOLD-UPC-ID        TO PV-DOUBLE-COMP.                   06530677
065307     MOVE PV-DOUBLE-COMP     TO PV-HOLD-STRUCT2-KEY.              06530777
065308     PERFORM 9910-SQL-ABEND-UPDATE.                               06530877
065309     PERFORM C103-ADD-TO-UPDATE-COUNTS.                           06530977
065310                                                                  06531077
065311***************************************************************** 06531177
065312*    UPDATE THE EFF_END_TMST TO INACTIVATE THE ACTIVE TUPCPLS ROW 06531277
065313***************************************************************** 06531377
065314 U130-INACTIVATE-TUPCPLS.                                         06531477
065315     PERFORM WITH TEST AFTER                                      06531577
065316         VARYING DS009-RETRY-COUNTER FROM 1 BY 1                  06531677
065317         UNTIL   DS009-RETRY-COUNTER > 3 OR                       06531777
065318                 SQLCODE = ZERO                                   06531877
065319         EXEC SQL                                                 06531977
065320             UPDATE TUPCPLS                                       06532077
065330             SET EFF_END_TMST =                                   06533077
065340                TIMESTAMP(:WS-UPCPLS-EFF-BEG-TMST) - 1 MICROSECOND06534077
065350             WHERE UPC_ID     = :HOLD-UPC-ID                      06535077
065360               AND OPERCO_NBR = '03'                              06536077
065361               AND STR_NBR    = :PV-HOLD-STR-NBR                  06536177
065362               AND EFF_END_TMST IS NULL                           06536277
065363         END-EXEC                                                 06536377
065364     END-PERFORM.                                                 06536477
065365                                                                  06536577
065366     MOVE 'U130-INACTIVATE-TUPCPLS' TO DS009-PARAGRAPH.           06536677
065367     MOVE HOLD-UPC-ID               TO PV-DOUBLE-COMP.            06536777
065368     MOVE PV-DOUBLE-COMP            TO PV-HOLD-STRUCT2-KEY.       06536877
065369     PERFORM 9910-SQL-ABEND-UPDATE.                               06536977
065370     PERFORM C103-ADD-TO-UPDATE-COUNTS.                           06537077
065371                                                                  06537177
065372***************************************************************** 06537277
065373*    UPDATE ALL FIELDS ON A TSKXREF ROW                           06537377
065374***************************************************************** 06537477
065375 U140-UPDATE-TSKXREF.                                             06537577
065376     PERFORM WITH TEST AFTER                                      06537677
065377         VARYING DS009-RETRY-COUNTER FROM 1 BY 1                  06537777
065378         UNTIL   DS009-RETRY-COUNTER > 3 OR                       06537877
065379                 SQLCODE = ZERO                                   06537977
065380         EXEC SQL                                                 06538077
065381             UPDATE TSKXREF                                       06538177
065382             SET DEPT_NBR      = :WS-SKXREF-DEPT-NBR              06538277
065383                ,CL_NBR        = :WS-SKXREF-CL-NBR                06538377
065384                ,SKU_SEQ_NBR   = :WS-SKXREF-SKU-SEQ-NBR           06538477
065385                ,SKU_STAT_CDE  = :WS-SKXREF-SKU-STAT-CDE          06538577
065386                ,ITM_NBR       = :WS-SKXREF-ITM-NBR               06538677
065387                ,INTR_UPC_ID   = :WS-SKXREF-INTR-UPC-ID           06538777
065388                ,DEPT          = :WS-SKXREF-DEPT                  06538877
065389                ,CLASS         = :WS-SKXREF-CLASS                 06538977
065390                ,SUBCLASS      = :WS-SKXREF-SUBCLASS              06539077
065400                ,SKU           = :WS-SKXREF-SKU                   06540077
065401             WHERE ITM_NBR     = :HOLD-ITM-NBR                    06540177
065402         END-EXEC                                                 06540277
065403     END-PERFORM.                                                 06540377
065404                                                                  06540477
065405     MOVE 'U140-UPDATE-TSKXREF' TO DS009-PARAGRAPH.               06540577
065406     MOVE HOLD-ITM-NBR          TO PV-HOLD-STRUCT2-KEY.           06540677
065407     PERFORM 9910-SQL-ABEND-UPDATE.                               06540777
065408     PERFORM C103-ADD-TO-UPDATE-COUNTS.                           06540877
065409                                                                  06540977
065410***************************************************************** 06541077
065411*    UPDATE THE EFF_END_TMST TO INACTIVATE THE ACTIVE TWEBITM ROW 06541177
065412***************************************************************** 06541277
065413 U150-INACTIVATE-TWEBITM.                                         06541377
065414     PERFORM WITH TEST AFTER                                      06541477
065415         VARYING DS009-RETRY-COUNTER FROM 1 BY 1                  06541577
065416         UNTIL   DS009-RETRY-COUNTER > 3 OR                       06541677
065417                 SQLCODE = ZERO                                   06541777
065418         EXEC SQL                                                 06541877
065419             UPDATE TWEBITM                                       06541977
065420             SET EFF_END_TMST = :WS-WEBITM-EFF-END-TMST           06542077
065421             WHERE INTR_UPC_ID  = :HOLD-INTR-UPC-ID               06542177
065422               AND EFF_END_TMST IS NULL                           06542277
065423         END-EXEC                                                 06542377
065424     END-PERFORM.                                                 06542477
065425                                                                  06542577
065426     MOVE 'U150-INACTIVATE-TWEBITM' TO DS009-PARAGRAPH.           06542677
065427     MOVE HOLD-INTR-UPC-ID          TO PV-DOUBLE-COMP.            06542777
065428     MOVE PV-DOUBLE-COMP            TO PV-HOLD-STRUCT2-KEY.       06542877
065429     PERFORM 9910-SQL-ABEND-UPDATE.                               06542977
065430     PERFORM C103-ADD-TO-UPDATE-COUNTS.                           06543077
065431                                                                  06543177
065432***************************************************************** 06543277
065433*    UPDATE ALL FIELDS ON A TVNDDPT ROW                           06543377
065434***************************************************************** 06543477
065435 U160-UPDATE-TVNDDPT.                                             06543577
065436     PERFORM WITH TEST AFTER                                      06543677
065437         VARYING DS009-RETRY-COUNTER FROM 1 BY 1                  06543777
065438         UNTIL   DS009-RETRY-COUNTER > 3 OR                       06543877
065439                 SQLCODE = ZERO                                   06543977
065440         EXEC SQL                                                 06544077
065441             UPDATE TVNDDPT                                       06544177
065442             SET INHOUSE_NBR      = :WS-VNDDPT-INHOUSE-NBR        06544277
065443                ,VEND_TYP_IND     = :WS-VNDDPT-VEND-TYP-IND       06544377
065444                ,INVC_REQ_PO_IND  = :WS-VNDDPT-INVC-REQ-PO-IND    06544477
065445                ,VND_DEPT_STAT_CD = :WS-VNDDPT-VND-DEPT-STAT-CD   06544577
065446             WHERE ENT_ID         = :HOLD-ENT-ID                  06544677
065447               AND DEPT_NBR       = :HOLD-DEPT-NBR                06544777
065448         END-EXEC                                                 06544877
065449     END-PERFORM.                                                 06544977
065450                                                                  06545077
065451     MOVE 'U160-UPDATE-TVNDDPT' TO DS009-PARAGRAPH.               06545177
065452     MOVE HOLD-ENT-ID           TO PV-DOUBLE-COMP.                06545277
065453     MOVE PV-DOUBLE-COMP        TO PV-HOLD-STRUCT2-KEY.           06545377
065454     PERFORM 9910-SQL-ABEND-UPDATE.                               06545477
065455     PERFORM C103-ADD-TO-UPDATE-COUNTS.                           06545577
065456                                                                  06545677
065457***************************************************************** 06545777
065458*    UPDATE MDSEAR_DKEY ON A TMDSEAR ROW                          06545877
065459***************************************************************** 06545977
065460 U170-UPDATE-TMDSEAR-DKEY.                                        06546077
065461     PERFORM WITH TEST AFTER                                      06546177
065462         VARYING DS009-RETRY-COUNTER FROM 1 BY 1                  06546277
065463         UNTIL   DS009-RETRY-COUNTER > 3 OR                       06546377
065464                 SQLCODE = ZERO                                   06546477
065465         EXEC SQL                                                 06546577
065466             UPDATE TMDSEAR                                       06546677
065467             SET MDSEAR_DKEY      = :HOLD-SUB-CL-MDSEAR-ID        06546777
065468             WHERE MDSEAR_DKEY    = :PV-MDSEAR-DKEY               06546877
065469         END-EXEC                                                 06546977
065470     END-PERFORM.                                                 06547077
065471                                                                  06547177
065472     MOVE 'U170-UPDATE-TMDSEAR-DKEY' TO DS009-PARAGRAPH.          06547277
065473     MOVE PV-MDSEAR-DKEY        TO PV-HOLD-STRUCT2-KEY.           06547377
065474     PERFORM 9910-SQL-ABEND-UPDATE.                               06547477
065475     PERFORM C103-ADD-TO-UPDATE-COUNTS.                           06547577
065476                                                                  06547677
065477***************************************************************** 06547777
065478*    UPDATE MDSEAR_DKEY ON A TMDSECL ROW                          06547877
065479***************************************************************** 06547977
065480 U171-UPDATE-TMDSECL-DKEY.                                        06548077
065481     PERFORM WITH TEST AFTER                                      06548177
065482         VARYING DS009-RETRY-COUNTER FROM 1 BY 1                  06548277
065483         UNTIL   DS009-RETRY-COUNTER > 3 OR                       06548377
065484                 SQLCODE = ZERO OR                                06548477
065485                 SQLCODE = +100                                   06548577
065486         EXEC SQL                                                 06548677
065487             UPDATE TMDSECL                                       06548777
065488             SET MDSEAR_DKEY      = :HOLD-SUB-CL-MDSEAR-ID        06548877
065489             WHERE MDSEAR_DKEY    = :PV-MDSEAR-DKEY               06548977
065490         END-EXEC                                                 06549077
065500     END-PERFORM.                                                 06550077
065501                                                                  06550177
065502     MOVE 'U171-UPDATE-TMDSECL-DKEY' TO DS009-PARAGRAPH.          06550277
065503     MOVE PV-MDSEAR-DKEY        TO PV-HOLD-STRUCT2-KEY.           06550377
065504     PERFORM 9900-SQL-ABEND-SELECT.                               06550477
065505                                                                  06550577
065506***************************************************************** 06550677
065507*    UPDATE MDSEAR_DKEY ON TAPLAVL ROWS                           06550777
065508***************************************************************** 06550877
065509 U172-UPDATE-TAPLAVL-DKEY.                                        06550977
065510     PERFORM WITH TEST AFTER                                      06551077
065511         VARYING DS009-RETRY-COUNTER FROM 1 BY 1                  06551177
065512         UNTIL   DS009-RETRY-COUNTER > 3 OR                       06551277
065513                 SQLCODE = ZERO OR                                06551377
065514                 SQLCODE = +100                                   06551477
065515         EXEC SQL                                                 06551577
065516             UPDATE TAPLAVL                                       06551677
065517             SET MDSEAR_DKEY      = :HOLD-SUB-CL-MDSEAR-ID        06551777
065518             WHERE MDSEAR_DKEY    = :PV-MDSEAR-DKEY               06551877
065519         END-EXEC                                                 06551977
065520     END-PERFORM.                                                 06552077
065521                                                                  06552177
065522     MOVE 'U172-UPDATE-TAPLAVL-DKEY' TO DS009-PARAGRAPH.          06552277
065523     MOVE PV-MDSEAR-DKEY        TO PV-HOLD-STRUCT2-KEY.           06552377
065524     PERFORM 9900-SQL-ABEND-SELECT.                               06552477
065525                                                                  06552577
065526***************************************************************** 06552677
065527*    UPDATE MDSEAR_ID ON TDCVSVL ROWS                             06552777
065528***************************************************************** 06552877
065529 U173-UPDATE-TDCVSVL-DKEY.                                        06552977
065530     PERFORM WITH TEST AFTER                                      06553077
065531         VARYING DS009-RETRY-COUNTER FROM 1 BY 1                  06553177
065532         UNTIL   DS009-RETRY-COUNTER > 3 OR                       06553277
065533                 SQLCODE = ZERO OR                                06553377
065534                 SQLCODE = +100                                   06553477
065535         EXEC SQL                                                 06553577
065536             UPDATE TDCVSVL                                       06553677
065537             SET MDSEAR_ID        = :HOLD-SUB-CL-MDSEAR-ID        06553777
065538             WHERE MDSEAR_ID      = :PV-MDSEAR-DKEY               06553877
065539         END-EXEC                                                 06553977
065540     END-PERFORM.                                                 06554077
065541                                                                  06554177
065542     MOVE 'U173-UPDATE-TDCVSVL-DKEY' TO DS009-PARAGRAPH.          06554277
065543     MOVE PV-MDSEAR-DKEY        TO PV-HOLD-STRUCT2-KEY.           06554377
065544     PERFORM 9900-SQL-ABEND-SELECT.                               06554477
065545                                                                  06554577
065546***************************************************************** 06554677
065547*    UPDATE MDSEAR_ID ON A IMT_CHARTC_RULDESC ROW                 06554777
065548***************************************************************** 06554877
065549 U174-UPDATE-RULDESC-DKEY.                                        06554977
065550     PERFORM WITH TEST AFTER                                      06555077
065551         VARYING DS009-RETRY-COUNTER FROM 1 BY 1                  06555177
065552         UNTIL   DS009-RETRY-COUNTER > 3 OR                       06555277
065553                 SQLCODE = ZERO OR                                06555377
065554                 SQLCODE = +100                                   06555477
065555         EXEC SQL                                                 06555577
065556             UPDATE IMT_CHARTC_RULDESC                            06555677
065557             SET MDSEAR_ID        = :HOLD-SUB-CL-MDSEAR-ID        06555777
065558             WHERE MDSEAR_ID      = :PV-MDSEAR-DKEY               06555877
065559         END-EXEC                                                 06555977
065560     END-PERFORM.                                                 06556077
065561                                                                  06556177
065562     MOVE 'U174-UPDATE-RULDESC-DKEY' TO DS009-PARAGRAPH.          06556277
065563     MOVE PV-MDSEAR-DKEY        TO PV-HOLD-STRUCT2-KEY.           06556377
065564     PERFORM 9900-SQL-ABEND-SELECT.                               06556477
065565                                                                  06556577
065566***************************************************************** 06556677
065567*    UPDATE SUB_CL_MDSEAR_ID ON TMDARVS ROWS                      06556777
065568***************************************************************** 06556877
065569 U175-UPDATE-TMDARVS-DKEY.                                        06556977
065570     PERFORM WITH TEST AFTER                                      06557077
065571         VARYING DS009-RETRY-COUNTER FROM 1 BY 1                  06557177
065572         UNTIL   DS009-RETRY-COUNTER > 3 OR                       06557277
065573                 SQLCODE = ZERO OR                                06557377
065574                 SQLCODE = +100                                   06557477
065575         EXEC SQL                                                 06557577
065576             UPDATE TMDARVS                                       06557677
065577             SET SUB_CL_MDSEAR_ID   = :HOLD-SUB-CL-MDSEAR-ID      06557777
065578             WHERE SUB_CL_MDSEAR_ID = :PV-MDSEAR-DKEY             06557877
065579         END-EXEC                                                 06557977
065580     END-PERFORM.                                                 06558077
065581                                                                  06558177
065582     MOVE 'U175-UPDATE-TMDARVS-DKEY' TO DS009-PARAGRAPH.          06558277
065583     MOVE PV-MDSEAR-DKEY        TO PV-HOLD-STRUCT2-KEY.           06558377
065584     PERFORM 9900-SQL-ABEND-SELECT.                               06558477
065585                                                                  06558577
065586     DISPLAY '  ****  TMDARVS UPDATES FOR SUB_CL_MDSEAR_ID UPDATE'06558677
065587           ': ' SQLERRD(3).                                       06558777
065588                                                                  06558877
065589***************************************************************** 06558977
065590*    UPDATE SUB_CL_MDSEAR_ID ON TUPC ROWS                         06559077
065600***************************************************************** 06560077
065601 U176-UPDATE-TUPC-DKEY.                                           06560177
065602     PERFORM WITH TEST AFTER                                      06560277
065603         VARYING DS009-RETRY-COUNTER FROM 1 BY 1                  06560377
065604         UNTIL   DS009-RETRY-COUNTER > 3 OR                       06560477
065605                 SQLCODE = ZERO                                   06560577
065606         EXEC SQL                                                 06560677
065607             UPDATE TUPC                                          06560777
065608             SET SUB_CL_MDSEAR_ID   = :HOLD-SUB-CL-MDSEAR-ID      06560877
065609             WHERE SUB_CL_MDSEAR_ID = :PV-MDSEAR-DKEY             06560977
065610         END-EXEC                                                 06561077
065620     END-PERFORM.                                                 06562077
065621                                                                  06562177
065622     MOVE 'U176-UPDATE-TUPC-DKEY' TO DS009-PARAGRAPH.             06562277
065623     MOVE PV-MDSEAR-DKEY        TO PV-HOLD-STRUCT2-KEY.           06562377
065624     PERFORM 9900-SQL-ABEND-SELECT.                               06562477
065625                                                                  06562577
065626     DISPLAY '  ****  TUPC UPDATES FOR SUB_CL_MDSEAR_ID UPDATE'   06562677
065627           ': ' SQLERRD(3).                                       06562777
065628                                                                  06562877
065629***************************************************************** 06562977
065630*    UPDATE SUB_CL_MDSEAR_ID ON IMT_STYL_PRTNR ROWS               06563077
065640***************************************************************** 06564077
065641 U177-UPDATE-PRTNR-DKEY.                                          06564177
065642     PERFORM WITH TEST AFTER                                      06564277
065643         VARYING DS009-RETRY-COUNTER FROM 1 BY 1                  06564377
065644         UNTIL   DS009-RETRY-COUNTER > 3 OR                       06564477
065645                 SQLCODE = ZERO                                   06564577
065646         EXEC SQL                                                 06564677
065647             UPDATE IMT_STYL_PRTNR                                06564777
065648             SET SUB_CL_MDSEAR_ID   = :HOLD-SUB-CL-MDSEAR-ID      06564877
065649             WHERE SUB_CL_MDSEAR_ID = :PV-MDSEAR-DKEY             06564977
065650         END-EXEC                                                 06565077
065660     END-PERFORM.                                                 06566077
065661                                                                  06566177
065662     MOVE 'U177-UPDATE-PRTNR-DKEY' TO DS009-PARAGRAPH.            06566277
065663     MOVE PV-MDSEAR-DKEY        TO PV-HOLD-STRUCT2-KEY.           06566377
065664     PERFORM 9900-SQL-ABEND-SELECT.                               06566477
065665                                                                  06566577
065666***************************************************************** 06566677
065667*    GET THE CURRENT TIMESTAMP                                    06566777
065668***************************************************************** 06566877
065669 V100-GET-CURRENT-TIMESTAMP.                                      06566977
065670     EXEC SQL                                                     06567077
065671         SET :PV-CURRENT-TIMESTAMP = CURRENT TIMESTAMP            06567177
065672     END-EXEC.                                                    06567277
065673                                                                  06567377
065674 1100-GET-DB2-INSTANCE.                                           06567477
065675                                                                  06567577
065676     MOVE '1100-GET-DB2-INSTANCE'                                 06567677
065677          TO DS009-PARAGRAPH.                                     06567777
065678     MOVE 'GET DB2 INSTANCE'                                      06567877
065679          TO DS009-OPERATION.                                     06567977
065680                                                                  06568077
065681     EXEC SQL                                                     06568177
065682         SELECT CURRENT SERVER INTO :WS-LOCAL-SERVER              06568277
065683             FROM SYSIBM.SYSDUMMY1 WITH UR                        06568377
065684     END-EXEC.                                                    06568477
065685                                                                  06568577
065686     EVALUATE TRUE                                                06568677
065687         WHEN SQLCODE = +0                                        06568777
065688             CONTINUE                                             06568877
065689         WHEN SQLWARN0 NOT = SPACES                               06568977
065690         WHEN SQLCODE < +0                                        06569077
065691         WHEN SQLCODE > +0                                        06569177
065692             PERFORM DS002-SQL-ERROR                              06569277
065693     END-EVALUATE.                                                06569377
065694*                                                                 06569477
065695 1200-CHECK-IF-PRODUCTION.                                        06569577
065696                                                                  06569677
065697     MOVE '1200-CHECK-IF-PRODUCTION'                              06569777
065698          TO DS009-PARAGRAPH.                                     06569877
065699     MOVE 'SELECT PRDCHK TKRPRPM '                                06569977
065700          TO DS009-OPERATION.                                     06570077
065701                                                                  06570177
065702     EXEC SQL                                                     06570277
065703       SELECT FUNC_TXT                                            06570377
065704         INTO :KRPRPM-FUNC-TXT                                    06570477
065705       FROM   TKRPRPM                                             06570577
065706       WHERE  SYS_PRC_FUNC_CDE  = :PC-PRDCHK                      06570678
065707         AND  INTFC_SYS_CDE     = :PC-KHL                         06570777
065708         AND  LOC_ID            = :PC-90                          06570877
065709         AND  FUNC_TXT          = :PC-PARM-TEXT                   06570977
065710     END-EXEC                                                     06571077
065711                                                                  06571177
065712     EVALUATE TRUE                                                06571277
065713         WHEN SQLCODE = +0                                        06571377
065714             CONTINUE                                             06571477
065715         WHEN SQLCODE = +100                                      06571577
065716             DISPLAY '*******************************************'06571677
065717             DISPLAY '** ABEND - DO NOT RUN THIS IMKUP033 PROGRAM'06571777
065718             DISPLAY '** ABEND - AGAINST PRODUCTION'              06571877
065719             DISPLAY '** ABEND - THIS SHOULD ONLY EVER BE'        06571977
065720             DISPLAY '** ABEND - RUN AGAINST TEST DATA'           06572077
065721             DISPLAY '*******************************************'06572177
065722             DISPLAY '** ABEND - THIS RUN IS GOING AGAINST'       06572277
065723             DISPLAY '** ABEND - DB2 INSTANCE:  '                 06572377
065724                     WS-LOCAL-SERVER                              06572477
065725             DISPLAY '*******************************************'06572577
065726             PERFORM DS002-SQL-ERROR                              06572677
065727                                                                  06572777
065728         WHEN SQLWARN0 NOT = SPACES                               06572877
065729         WHEN SQLCODE < +0                                        06572977
065730         WHEN SQLCODE > +0                                        06573077
065731             PERFORM DS002-SQL-ERROR                              06573177
065732     END-EVALUATE.                                                06573277
065733                                                                  06573377
065734***************************************************************** 06573477
065735*    DISPLAY PROCESSING TOTALS                                    06573577
065736***************************************************************** 06573677
065737 9000-DUMP-COUNT-TABLE.                                           06573777
065738     DISPLAY '  ****  DELETE AND INSERT TOTALS  ****'             06573877
065739                                                                  06573977
065740     PERFORM VARYING CNTL-I FROM 1 BY 1 UNTIL                     06574077
065741           CNTL-I > CNTL-SUB-MAX OR CNTL-I > CNTL-SUB-LIMIT       06574177
065750         IF CNTL-TABLE(CNTL-I) NOT = SPACES                       06575077
065800             MOVE DS009-READ-COUNT (CNTL-I) TO DS009-DISP-NBR     06580077
065900             DISPLAY 'TABLE = ' CNTL-TABLE(CNTL-I)                06590077
066000                'DELETE TOTAL = ' DS009-DISP-NBR                  06600077
066100             ADD DS009-READ-COUNT (CNTL-I) TO PV-TOTAL-DELETES    06610077
066200             MOVE DS009-WRITE-COUNT (CNTL-I) TO DS009-DISP-NBR    06620077
066300             DISPLAY 'TABLE = ' CNTL-TABLE(CNTL-I)                06630077
066400                'INSERT TOTAL = ' DS009-DISP-NBR                  06640077
066500             ADD DS009-WRITE-COUNT (CNTL-I) TO PV-TOTAL-INSERTS   06650077
066600         END-IF                                                   06660077
066700         SET WS-CNTL-I TO CNTL-I                                  06670077
066800         IF WS-CNTL-TABLE(WS-CNTL-I) NOT = SPACES                 06680077
066900             MOVE WS-CNTL-UPDATE-COUNT (WS-CNTL-I)                06690077
067000                                       TO DS009-DISP-NBR          06700077
067100             DISPLAY 'TABLE = ' WS-CNTL-TABLE (WS-CNTL-I)         06710077
067200                'UPDATE TOTAL = ' DS009-DISP-NBR                  06720077
067300             ADD WS-CNTL-UPDATE-COUNT (WS-CNTL-I)                 06730077
067400                                        TO PV-TOTAL-UPDATES       06740077
067500         END-IF                                                   06750077
067600     END-PERFORM.                                                 06760077
067700                                                                  06770077
067800     MOVE PV-TOTAL-DELETES          TO DS009-DISP-NBR             06780077
067900     DISPLAY SPACES.                                              06790077
068000     DISPLAY '**  TOTAL DELETES = ' DS009-DISP-NBR.               06800077
068100                                                                  06810077
068200     MOVE PV-TOTAL-INSERTS          TO DS009-DISP-NBR             06820077
068300     DISPLAY SPACES.                                              06830077
068400     DISPLAY '**  TOTAL INSERTS = ' DS009-DISP-NBR.               06840077
068500                                                                  06850077
068600     MOVE PV-TOTAL-UPDATES          TO DS009-DISP-NBR             06860077
068700     DISPLAY SPACES.                                              06870077
068800     DISPLAY '**  TOTAL UPDATES = ' DS009-DISP-NBR.               06880077
068801                                                                  06880177
068802 EJECT                                                            06880277
068803***************************************************************** 06880377
068804*     CHECK FOR DB2 ABENDS ON A SELECT                            06880477
068805***************************************************************** 06880577
068806 9900-SQL-ABEND-SELECT.                                           06880677
068807      IF (DS009-RETRY-COUNTER > 3                                 06880777
068808        OR (SQLWARN0 NOT = SPACES                                 06880877
068809          OR SQLCODE  NOT = ZERO))                                06880977
068810         AND SQLCODE NOT = +100                                   06881077
068811           IF DS009-RETRY-COUNTER > 3                             06881177
068812              MOVE 'MAX RETRIES EXCEEDED ON SELECT'               06881277
068813                           TO DS009-OPERATION                     06881377
068814           ELSE                                                   06881477
068815              MOVE 'UNSUCCESSFUL SELECT'                          06881577
068816                           TO DS009-OPERATION                     06881677
068817           END-IF                                                 06881777
068818           MOVE DS009-PROCESS-TABLE                               06881877
068819                           TO DS009-STRUCTURE-1                   06881977
068820           MOVE PV-HOLD-STRUCTURE-2                               06882077
068821                           TO DS009-STRUCTURE-2                   06882177
068822           MOVE SPACES     TO DS009-STRUCTURE-3                   06882277
068823           PERFORM DS002-SQL-ERROR                                06882377
068824      END-IF.                                                     06882477
068825                                                                  06882577
068826***************************************************************** 06882677
068827*     CHECK FOR DB2 ABENDS ON AN UPDATE                           06882777
068828***************************************************************** 06882877
068829 9910-SQL-ABEND-UPDATE.                                           06882977
068830      IF (DS009-RETRY-COUNTER > 3                                 06883077
068831        OR (SQLWARN0 NOT = SPACES                                 06883177
068832          OR SQLCODE  NOT = ZERO))                                06883277
068833           IF DS009-RETRY-COUNTER > 3                             06883377
068834              MOVE 'MAX RETRIES EXCEEDED ON UPDATE'               06883477
068835                           TO DS009-OPERATION                     06883577
068836           ELSE                                                   06883677
068837              MOVE 'UNSUCCESSFUL UPDATE'                          06883777
068838                           TO DS009-OPERATION                     06883877
068839           END-IF                                                 06883977
068840           MOVE DS009-PROCESS-TABLE                               06884077
068841                           TO DS009-STRUCTURE-1                   06884177
068842           MOVE PV-HOLD-STRUCTURE-2                               06884277
068843                           TO DS009-STRUCTURE-2                   06884377
068844           MOVE SPACES                                            06884477
068845                           TO DS009-STRUCTURE-3                   06884577
068846           PERFORM DS002-SQL-ERROR                                06884677
068847      END-IF.                                                     06884777
068848                                                                  06884877
068849***************************************************************** 06884977
068850*     CHECK FOR DB2 ABENDS ON AN INSERT                           06885077
068851***************************************************************** 06885177
068852 9920-SQL-ABEND-INSERT.                                           06885277
068853     IF SQLCODE  NOT = ZERO                                       06885377
068854         IF DS009-RETRY-COUNTER > 3                               06885477
068855             MOVE 'MAX RETRIES EXCEEDED ON INSERT'                06885577
068856                         TO DS009-OPERATION                       06885677
068857         ELSE                                                     06885777
068858             MOVE 'UNSUCCESSFUL INSERT'                           06885877
068859                         TO DS009-OPERATION                       06885977
068860         END-IF                                                   06886077
068861         MOVE DS009-PROCESS-TABLE                                 06886177
068862                         TO DS009-STRUCTURE-1                     06886277
068863         MOVE PV-HOLD-STRUCTURE-2                                 06886377
068864                         TO DS009-STRUCTURE-2                     06886477
068865         MOVE SPACES                                              06886577
068866                         TO DS009-STRUCTURE-3                     06886677
068867         PERFORM DS002-SQL-ERROR                                  06886777
068868     END-IF.                                                      06886877
068869                                                                  06886977
068870***************************************************************** 06887077
068871*     PROCESS NON-SQL ABENDS                                      06887177
068872***************************************************************** 06887277
068873 9990-NON-SQL-ABEND.                                              06887377
068874      DISPLAY '*** PGM ERROR '.                                   06887477
068875      DISPLAY '*** PROGRAM   = ' DS009-PROGRAM.                   06887577
068876      DISPLAY '*** CURRENT RECORD  = ' DS009-TUPDATE-COUNT.       06887677
068877                                                                  06887777
068878      CALL 'ILBOABN0' USING DS009-ABEND-CODE.                     06887877
068879                                                                  06887977
068880***************************************************************** 06888077
068881*     PRODUCTION - TO - TEST STANDARD PARAGRAPHS                * 06888177
068882***************************************************************** 06888277
068883     COPY DSPD002.                                                06888377
