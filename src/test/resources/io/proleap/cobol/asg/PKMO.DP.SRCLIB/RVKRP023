000100******************************************************************00010066
000200 IDENTIFICATION DIVISION.                                         00020066
000300******************************************************************00030066
000400                                                                  00040066
000500 PROGRAM-ID.   RVKRP023.                                          00050066
000600 AUTHOR.       THERESE RAMSEYER.                                  00060066
000700 INSTALLATION. KOHLS DEPARTMENT STORES.                           00070066
000800 DATE-WRITTEN. JANUARY 2007.                                      00080066
000900 DATE-COMPILED.                                                   00090066
001000                                                                  00100066
001100******************************************************************00110066
001200*  GENCO LOAD TO RTV :  RCVD -VS- APPLIED TOTALS SUMMARY REPORT   00120066
001300******************************************************************00130066
001400*  THIS PROGRAM PRODUCES A SINGLE PAGE REPORT.                    00140066
001500*  THE REPORT COMPARES VALUES THAT ARE RECEIVED FROM GENCO TO     00150066
001600*  VALUES THAT ARE ACTUALLY APPLIED TO THE RTV TABLES.            00160066
001700*  THE COMPARISON IS DONE FOR THE DIFFERENT RETURN-TYPES THAT ARE 00170066
001800*  PROCESSED: 'D', 'M' & 'R'.                                     00180066
001900*  THE NUMBER OF DETAIL RECORDS FOR EACH TYPE IS COUNTED. THE     00190073
002000*  RTL_COST_AMT AND UNIT_COST_AMT DOLLAR VALUES ARE SUMMED.       00200066
002100*  THE 'RCVD' TOTALS ARE TABULATED IN RVKUP002 AND A SINGLE       00210066
002200*  'S' TYPE RECORD IS WRITTEN TO THE RVTW_DFCTOR_ERR TABLE. THIS  00220066
002300*  'S' RECORD IS SORTED AND PASSED AS AN INPUT FILE.              00230066
002400*  THE APPLIED TOTALS ARE TABULATED BY READING THE SAME HDR       00240066
002500*  FILE USED IN RVKUP002, TAKING EACH DFCT-ORD-ID AND MATCHING    00250066
002600*  THAT TO A JOIN BETWEEN TDFCTOR & TDFMEIT. THE RTL_COST_AMT &   00260066
002700*  UNIT_COST_AMT AND THE DTL REC COUNTS SUMMED FOR EACH           00270066
002800*  DFCT-ORD-ID (LISTING).                                         00280066
002900*  ANY DISCREPANCY BETWEEN THE RCVD VALUES AND THE APPLIED        00290066
003000*  VALUES SHOULD BE EXPLAINED BY THE TOTAL OF WHAT WAS BYPASSED   00300066
003100*  IN RVKUP002 PROCESSING DUE TO ERRORS IN THE GENCO DATA.        00310066
003200*-----------------------------------------------------------------00320066
003300* DATE:        10/30/2011                                         00330066
003400* PROJ#:       3219  GENCO/RTV UPGRADE PROJECT                    00340066
003500* WR/IR#:      WR40134                                            00350066
003600* PROGRAMMER:  JOHN HUTCHINSON / CHRIS STRODTHOFF                 00360072
003700* DESCRIPTION: ADD RTV LOCATION TO REPORT HEADING FROM INPUT FILE.00370066
003800*-----------------------------------------------------------------00380066
003900******************************************************************00390066
004000 ENVIRONMENT DIVISION.                                            00400066
004100******************************************************************00410066
004200                                                                  00420066
004300 CONFIGURATION SECTION.                                           00430066
004400                                                                  00440066
004500 SOURCE-COMPUTER.        IBM-3090.                                00450066
004600 OBJECT-COMPUTER.        IBM-3090.                                00460066
004700                                                                  00470066
004800 INPUT-OUTPUT SECTION.                                            00480066
004900                                                                  00490066
005000 FILE-CONTROL.                                                    00500066
005100                                                                  00510066
005200     SELECT RCVD-SUMMARY-FILE                                     00520066
005300         ASSIGN TO INP01.                                         00530066
005400                                                                  00540066
005500     SELECT SUMMARY-REPORT-FILE                                   00550066
005600         ASSIGN TO RPT01.                                         00560066
005700                                                                  00570066
005800******************************************************************00580066
005900 DATA DIVISION.                                                   00590066
006000******************************************************************00600066
006100                                                                  00610066
006200 FILE SECTION.                                                    00620066
006300                                                                  00630066
006400 FD  RCVD-SUMMARY-FILE                                            00640066
006500     RECORDING MODE IS F                                          00650066
006600     LABEL RECORDS ARE STANDARD                                   00660066
006700     BLOCK CONTAINS 0 RECORDS.                                    00670066
006800                                                                  00680066
006900 01  RCVD-SUMMARY-RECORD             PIC X(254).                  00690066
007000                                                                  00700066
007100 FD  SUMMARY-REPORT-FILE                                          00710066
007200     RECORDING MODE IS F                                          00720066
007300     LABEL RECORDS ARE STANDARD                                   00730066
007400     BLOCK CONTAINS 0 RECORDS.                                    00740066
007500                                                                  00750066
007600 01  SUMMARY-REPORT-RECORD          PIC X(132).                   00760066
007700                                                                  00770066
007800******************************************************************00780066
007900 WORKING-STORAGE SECTION.                                         00790066
008000******************************************************************00800066
008100                                                                  00810066
008200**  CMS 10/30/2011  BEG                                           00820069
008300***************************************************************** 00830069
008400*    CONTROL CARD INPUT                                           00840069
008500***************************************************************** 00850069
008600 01  CC-CONTROL-CARD.                                             00860069
008700     05  CC-LOC                       PIC X(04).                  00870069
008800     05  FILLER REDEFINES CC-LOC.                                 00880069
008900         10  CC-LOC-NBR               PIC 9(04).                  00890069
009000     05  FILLER                       PIC X(76).                  00900069
009100                                                                  00910069
009200**  CMS 10/30/2011  END                                           00920069
009300******************************************************************00930066
009400*  COMMUNICATIONS AREA FOR DB2                                    00940066
009500******************************************************************00950066
009600     EXEC SQL                                                     00960066
009700          INCLUDE SQLCA                                           00970066
009800     END-EXEC.                                                    00980066
009900                                                                  00990069
010000**  JH  10/30/2011  BEG                                           01000066
010100***************************************************************** 01010066
010200**   TCOCNTL TABLE                                                01020066
010300***************************************************************** 01030066
010400     EXEC SQL                                                     01040066
010500          INCLUDE TCOCNTL                                         01050066
010600     END-EXEC.                                                    01060066
010700                                                                  01070069
010800***************************************************************** 01080069
010900**   DCLGEN FOR THE LOGISTICS LOCATION TABLE                      01090069
011000***************************************************************** 01100069
011100     EXEC SQL                                                     01110069
011200         INCLUDE XLT00010                                         01120069
011300     END-EXEC.                                                    01130069
011400                                                                  01140069
011500**  JH  10/30/2011  END                                           01150066
011600                                                                  01160066
011700******************************************************************01170066
011800* ERROR TABLE LAYOUT FOR DTLS SUMMARY- RV020-DTL-SUMMARY-RECORD.  01180066
011900******************************************************************01190066
012000     COPY RVWS020.                                                01200066
012100                                                                  01210066
012200******************************************************************01220066
012300*  DB2 FORMATTED MESSAGE AREA                                     01230066
012400******************************************************************01240066
012500     COPY DPWS004.                                                01250066
012600                                                                  01260066
012700******************************************************************01270066
012800*  WORK AREA FOR THE KOHLS CALENDAR ROUTINE                       01280066
012900******************************************************************01290066
013000     COPY DPWS500.                                                01300066
013100                                                                  01310066
013200******************************************************************01320066
013300*  COPYBOOK FOR STANDARD REPORT HEADER FOR A 132 COLUMN REPORT    01330066
013400******************************************************************01340066
013500     COPY DPWS132.                                                01350066
013600                                                                  01360066
013700 01  ABEND-CODE                      PIC S9(04)    VALUE +0       01370066
013800                                                   COMP SYNC.     01380066
013900 01  PA-PROGRAM-ACCUMULATORS.                                     01390066
014000     05  PA-TOTALS.                                               01400066
014100         10 PA-TOT-HDR-RECS-READ      PIC S9(09) VALUE +0 COMP-3. 01410066
014200                                                                  01420066
014300***  SYSTEM DATE VARIABLES                                        01430066
014400 01  SD-SYSTEM-DATE.                                              01440066
014500     05  SD-SYSTEM-CCYY              PIC  9(04)  VALUE ZEROS.     01450066
014600     05  SD-SYSTEM-MONTH             PIC  9(02)  VALUE ZEROS.     01460066
014700     05  SD-SYSTEM-DAY               PIC  9(02)  VALUE ZEROS.     01470066
014800                                                                  01480066
014900***  SYSTEM TIME VARIABLES                                        01490066
015000 01  ST-SYSTEM-TIME.                                              01500066
015100     05  ST-SYSTEM-HOUR              PIC  9(02)  VALUE ZEROS.     01510066
015200     05  ST-SYSTEM-MINUTE            PIC  9(02)  VALUE ZEROS.     01520066
015300                                                                  01530066
015400 01  PS-PROGRAM-SWITCHES.                                         01540066
015500     05  PS-END-OF-HDR-INPUT-SW        PIC  X(01)    VALUE 'N'.   01550066
015600         88  PS-END-OF-HDR-INPUT-YES                 VALUE 'Y'.   01560066
015700         88  PS-END-OF-HDR-INPUT-NO                  VALUE 'N'.   01570066
015800     05  PS-END-OF-SUM-INPUT-SW        PIC  X(01)    VALUE 'N'.   01580066
015900         88  PS-END-OF-SUM-INPUT-YES                 VALUE 'Y'.   01590066
016000         88  PS-END-OF-SUM-INPUT-NO                  VALUE 'N'.   01600066
016100     05  PS-XLT00010-SWITCH            PIC  X(01)    VALUE 'N'.   01610071
016200         88  PS-XLT00010-FOUND                       VALUE 'Y'.   01620071
016300         88  PS-XLT00010-NOTFND                      VALUE 'N'.   01630071
016400                                                                  01640066
016500 01  PC-PROGRAM-CONSTANTS.                                        01650066
016600     05  PC-MAX-RETRIES              PIC S9(03) VALUE +5 COMP-3.  01660066
016700     05  PC-CURRENT-PROGRAM-NAME     PIC X(08)  VALUE 'RVKRP023'. 01670066
016800     05  PC-D                        PIC X(01)  VALUE 'D'.        01680066
016900     05  PC-M                        PIC X(01)  VALUE 'M'.        01690066
017000     05  PC-R                        PIC X(01)  VALUE 'R'.        01700066
017100                                                                  01710066
017200 01  PV-PROGRAM-VARIABLES.                                        01720066
017300     05  PV-PAGE-COUNT                 PIC  9(05)    VALUE 0.     01730066
017400     05  PV-CURRENT-TMST               PIC X(26)  VALUE SPACE.    01740066
017500     05  PV-RETRY-COUNTER              PIC S9(04) VALUE +0 COMP   01750066
017600                                                             SYNC.01760066
017700     05  PV-DISPLAY-RECORD             PIC ZZ,ZZZ,ZZ9-.           01770066
017800     05  PV-RTL-COST-AMT         PIC S9(09)V99 COMP-3 VALUE +0.   01780066
017900     05  PV-UNT-COST-AMT         PIC S9(09)V99 COMP-3 VALUE +0.   01790066
018000     05  PV-ORD-ID-COUNT         PIC S9(05) COMP-3 VALUE +0.      01800066
018100                                                                  01810066
018200     05  PV-RTV-TOT-RTL-RCVD     PIC S9(09)V99 COMP-3 VALUE +0.   01820066
018300     05  PV-RTV-TOT-UNT-RCVD     PIC S9(09)V99 COMP-3 VALUE +0.   01830066
018400     05  PV-RTV-TOT-ORD-ID-RCVD  PIC S9(09) COMP-3 VALUE +0.      01840066
018500     05  PV-MOS-RTL-RCVD         PIC S9(09)V99 COMP-3 VALUE +0.   01850066
018600     05  PV-MOS-TOT-UNT-RCVD     PIC S9(09)V99 COMP-3 VALUE +0.   01860066
018700     05  PV-MOS-TOT-ORD-ID-RCVD  PIC S9(09) COMP-3 VALUE +0.      01870066
018800     05  PV-DD-RTL-RCVD          PIC S9(09)V99 COMP-3 VALUE +0.   01880066
018900     05  PV-DD-TOT-UNT-RCVD      PIC S9(09)V99 COMP-3 VALUE +0.   01890066
019000     05  PV-DD-TOT-ORD-ID-RCVD   PIC S9(09) COMP-3 VALUE +0.      01900066
019100     05  PV-RTV-TOT-RTL-ERR      PIC S9(09)V99 COMP-3 VALUE +0.   01910066
019200     05  PV-RTV-TOT-UNT-ERR      PIC S9(09)V99 COMP-3 VALUE +0.   01920066
019300     05  PV-RTV-TOT-ORD-ID-ERR   PIC S9(09) COMP-3 VALUE +0.      01930066
019400     05  PV-MOS-RTL-ERR          PIC S9(09)V99 COMP-3 VALUE +0.   01940066
019500     05  PV-MOS-TOT-UNT-ERR      PIC S9(09)V99 COMP-3 VALUE +0.   01950066
019600     05  PV-MOS-TOT-ORD-ID-ERR   PIC S9(09) COMP-3 VALUE +0.      01960066
019700     05  PV-DD-RTL-ERR           PIC S9(09)V99 COMP-3 VALUE +0.   01970066
019800     05  PV-DD-TOT-UNT-ERR       PIC S9(09)V99 COMP-3 VALUE +0.   01980066
019900     05  PV-DD-TOT-ORD-ID-ERR    PIC S9(09) COMP-3 VALUE +0.      01990066
020000     05  PV-UNK-TOT-RTL-UNK      PIC S9(09)V99 COMP-3 VALUE +0.   02000066
020100     05  PV-UNK-TOT-UNT-UNK      PIC S9(09)V99 COMP-3 VALUE +0.   02010066
020200     05  PV-UNK-TOT-ORD-ID-UNK   PIC S9(09) COMP-3 VALUE +0.      02020066
020300                                                                  02030066
020400     05  PV-RCVD-CNT-TOT         PIC S9(09) COMP-3 VALUE +0.      02040066
020500     05  PV-RCVD-COST-TOT        PIC S9(09)V99 COMP-3 VALUE +0.   02050066
020600     05  PV-RCVD-RETL-TOT        PIC S9(09)V99 COMP-3 VALUE +0.   02060066
020700     05  PV-APPLD-CNT-TOT        PIC S9(09) COMP-3 VALUE +0.      02070066
020800     05  PV-APPLD-COST-TOT       PIC S9(09)V99 COMP-3 VALUE +0.   02080066
020900     05  PV-APPLD-RETL-TOT       PIC S9(09)V99 COMP-3 VALUE +0.   02090066
021000     05  PV-ERROR-CNT-TOT        PIC S9(09) COMP-3 VALUE +0.      02100066
021100     05  PV-ERROR-COST-TOT       PIC S9(09)V99 COMP-3 VALUE +0.   02110066
021200     05  PV-ERROR-RETL-TOT       PIC S9(09)V99 COMP-3 VALUE +0.   02120066
021300**  JH  10/30/2011  BEG                                           02130066
021400     05  PV-KEY-LOC-NBR              PIC S9(04) VALUE +0          02140070
021500                                                COMP SYNC.        02150070
021600     05  PV-PD-DTE.                                               02160066
021700         10  PV-PD-CY                PIC 9(04)  VALUE ZERO.       02170066
021800         10  FILLER                  PIC X(01).                   02180066
021900         10  PV-PD-MM                PIC 9(02)  VALUE ZERO.       02190066
022000         10  FILLER                  PIC X(01).                   02200066
022100         10  PV-PD-DD                PIC 9(02)  VALUE ZERO.       02210066
022200**  JH  10/30/2011  END                                           02220066
022300                                                                  02230066
022400                                                                  02240066
022500 01  PV-ABEND-VARIABLES.                                          02250066
022600     05  PV-ABEND-CODE              PIC S9(04) VALUE +0 COMP SYNC.02260066
022700     05  PV-PARAGRAPH-NAME          PIC  X(30) VALUE SPACE.       02270066
022800     05  PV-ABEND-MESSAGE           PIC  X(30) VALUE SPACE.       02280066
022900     05  PV-SQLCODE                 PIC  S9(9) VALUE ZEROES.      02290066
023000     05  PV-DB2-VIEW-NAME           PIC X(10) VALUE SPACES.       02300066
023100                                                                  02310066
023200 01  PH2-PAGE-HEADING-2.                                          02320066
023300     05  FILLER                          PIC  X(41)  VALUE SPACE. 02330074
023400     05  FILLER                          PIC  X(49)  VALUE        02340074
023500         'SUMMARY LOADING RETURNS DATA TO RTV TABLES REPORT'.     02350074
023600     05  FILLER                          PIC  X(42)  VALUE SPACE. 02360074
023700                                                                  02370066
023800 01  PH3-PAGE-HEADING-3.                                          02380066
023900     05  FILLER                          PIC  X(54)  VALUE SPACE. 02390066
024000     05  FILLER                          PIC  X(16)  VALUE        02400066
024100         'PROCESSING DATE '.                                      02410066
024200**  JH  10/30/2011  BEG                                           02420066
024300     05  PH3-DATE.                                                02430066
024400         10  PH3-DATE-MM                 PIC  9(2).               02440066
024500         10  FILLER                      PIC  X      VALUE '/'.   02450066
024600         10  PH3-DATE-DD                 PIC  9(2).               02460066
024700         10  FILLER                      PIC  X      VALUE '/'.   02470066
024800         10  PH3-DATE-CCYY               PIC  9(4).               02480066
024900     05  FILLER                          PIC  X(52)  VALUE SPACE. 02490067
025000                                                                  02500066
025100 01  PH4-PAGE-HEADING-4.                                          02510066
025200     05  FILLER                          PIC  X(17)  VALUE        02520066
025300         '  RTV LOCATION:  '.                                     02530066
025400     05  PH4-RTV-LOC                     PIC  X(06).              02540066
025500     05  FILLER                          PIC  X(02)  VALUE SPACE. 02550066
025600     05  PH4-RTV-NAME                    PIC  X(10).              02560066
025700**  JH 10/30/2011 END                                             02570066
025800                                                                  02580066
025900 01  DH1-DETAIL-HEADING-1.                                        02590066
026000     05  FILLER                          PIC  X(01)  VALUE SPACE. 02600066
026100     05  FILLER                          PIC  X(06)  VALUE        02610066
026200         'RETURN'.                                                02620066
026300     05  FILLER                          PIC  X(02)  VALUE SPACE. 02630066
026400     05  FILLER                          PIC  X(08)  VALUE        02640066
026500         'RECEIVED'.                                              02650066
026600     05  FILLER                          PIC  X(03)  VALUE SPACE. 02660066
026700     05  FILLER                          PIC  X(08)  VALUE        02670066
026800         'RECEIVED'.                                              02680066
026900     05  FILLER                          PIC  X(06)  VALUE SPACE. 02690066
027000     05  FILLER                          PIC  X(08)  VALUE        02700066
027100         'RECEIVED'.                                              02710066
027200     05  FILLER                          PIC  X(07)  VALUE SPACE. 02720066
027300     05  FILLER                          PIC  X(07)  VALUE        02730066
027400         'APPLIED'.                                               02740066
027500     05  FILLER                          PIC  X(07)  VALUE SPACE. 02750066
027600     05  FILLER                          PIC  X(07)  VALUE        02760066
027700         'APPLIED'.                                               02770066
027800     05  FILLER                          PIC  X(07)  VALUE SPACE. 02780066
027900     05  FILLER                          PIC  X(07)  VALUE        02790066
028000         'APPLIED'.                                               02800066
028100     05  FILLER                          PIC  X(08)  VALUE SPACE. 02810066
028200     05  FILLER                          PIC  X(05)  VALUE        02820066
028300         'ERROR'.                                                 02830066
028400     05  FILLER                          PIC  X(09)  VALUE SPACE. 02840066
028500     05  FILLER                          PIC  X(05)  VALUE        02850066
028600         'ERROR'.                                                 02860066
028700     05  FILLER                          PIC  X(09)  VALUE SPACE. 02870066
028800     05  FILLER                          PIC  X(05)  VALUE        02880066
028900         'ERROR'.                                                 02890066
029000     05  FILLER                          PIC  X(05)  VALUE SPACE. 02900066
029100                                                                  02910066
029200 01  DH2-DETAIL-HEADING-2.                                        02920066
029300     05  FILLER                          PIC  X(01)  VALUE SPACE. 02930066
029400     05  FILLER                          PIC  X(04)  VALUE        02940066
029500         'TYPE'.                                                  02950066
029600     05  FILLER                          PIC  X(04)  VALUE SPACE. 02960066
029700     05  FILLER                          PIC  X(05)  VALUE        02970066
029800         'COUNT'.                                                 02980066
029900     05  FILLER                          PIC  X(05)  VALUE SPACE. 02990066
030000     05  FILLER                          PIC  X(11)  VALUE        03000066
030100         'COST AMOUNT'.                                           03010066
030200     05  FILLER                          PIC  X(02)  VALUE SPACE. 03020066
030300     05  FILLER                          PIC  X(13)  VALUE        03030066
030400         'RETAIL AMOUNT'.                                         03040066
030500     05  FILLER                          PIC  X(05)  VALUE SPACE. 03050066
030600     05  FILLER                          PIC  X(05)  VALUE        03060066
030700         'COUNT'.                                                 03070066
030800     05  FILLER                          PIC  X(06)  VALUE SPACE. 03080066
030900     05  FILLER                          PIC  X(11)  VALUE        03090066
031000         'COST AMOUNT'.                                           03100066
031100     05  FILLER                          PIC  X(02)  VALUE SPACE. 03110066
031200     05  FILLER                          PIC  X(13)  VALUE        03120066
031300         'RETAIL AMOUNT'.                                         03130066
031400     05  FILLER                          PIC  X(05)  VALUE SPACE. 03140066
031500     05  FILLER                          PIC  X(05)  VALUE        03150066
031600         'COUNT'.                                                 03160066
031700     05  FILLER                          PIC  X(06)  VALUE SPACE. 03170066
031800     05  FILLER                          PIC  X(11)  VALUE        03180066
031900         'COST AMOUNT'.                                           03190066
032000     05  FILLER                          PIC  X(01)  VALUE SPACE. 03200066
032100     05  FILLER                          PIC  X(13)  VALUE        03210066
032200         'RETAIL AMOUNT'.                                         03220066
032300     05  FILLER                          PIC  X(01)  VALUE SPACE. 03230066
032400                                                                  03240066
032500 01  DH3-DETAIL-HEADING-3.                                        03250066
032600     05  FILLER                          PIC  X(132) VALUE        03260066
032700                                                       ALL '-'.   03270066
032800 01  DL1-DETAIL-LINE-RTV.                                         03280066
032900     05  FILLER                          PIC  X(01)  VALUE SPACE. 03290066
033000     05  FILLER                          PIC  X(03)  VALUE        03300066
033100         'RTV'.                                                   03310066
033200     05  FILLER                          PIC  X(01)  VALUE SPACE. 03320066
033300     05  DL1-RTV-DTLS-RCVD               PIC  ZZZ,ZZZ,ZZ9.        03330066
033400     05  FILLER                          PIC  X(01)  VALUE SPACE. 03340066
033500     05  DL1-RTV-UNT-DLRS-RCVD           PIC  ZZZ,ZZZ,ZZ9.99.     03350066
033600     05  FILLER                          PIC  X(01)  VALUE SPACE. 03360066
033700     05  DL1-RTV-RTL-DLRS-RCVD           PIC  ZZZ,ZZZ,ZZ9.99.     03370066
033800     05  FILLER                          PIC  X(01)  VALUE SPACE. 03380066
033900     05  DL1-RTV-DTLS-APP                PIC  ZZZ,ZZZ,ZZ9.        03390066
034000     05  FILLER                          PIC  X(01)  VALUE SPACE. 03400066
034100     05  DL1-RTV-UNT-DLRS-APP            PIC  ZZZ,ZZZ,ZZ9.99.     03410066
034200     05  FILLER                          PIC  X(01)  VALUE SPACE. 03420066
034300     05  DL1-RTV-RTL-DLRS-APP            PIC  ZZZ,ZZZ,ZZ9.99.     03430066
034400     05  FILLER                          PIC  X(01)  VALUE SPACE. 03440066
034500     05  DL1-RTV-DTLS-ERR                PIC  ZZZ,ZZZ,ZZ9.        03450066
034600     05  FILLER                          PIC  X(01)  VALUE SPACE. 03460066
034700     05  DL1-RTV-UNT-DLRS-ERR            PIC  ZZZ,ZZZ,ZZ9.99.     03470066
034800     05  FILLER                          PIC  X(01)  VALUE SPACE. 03480066
034900     05  DL1-RTV-RTL-DLRS-ERR            PIC  ZZZ,ZZZ,ZZ9.99.     03490066
035000     05  FILLER                          PIC  X(01)  VALUE SPACE. 03500066
035100                                                                  03510066
035200 01  DL2-DETAIL-LINE-DD.                                          03520066
035300     05  FILLER                          PIC  X(01)  VALUE SPACE. 03530066
035400     05  FILLER                          PIC  X(03)  VALUE        03540066
035500         'D&D'.                                                   03550066
035600     05  FILLER                          PIC  X(01)  VALUE SPACE. 03560066
035700     05  DL2-DD-DTLS-RCVD                PIC  ZZZ,ZZZ,ZZ9.        03570066
035800     05  FILLER                          PIC  X(01)  VALUE SPACE. 03580066
035900     05  DL2-DD-UNT-DLRS-RCVD            PIC  ZZZ,ZZZ,ZZ9.99.     03590066
036000     05  FILLER                          PIC  X(01)  VALUE SPACE. 03600066
036100     05  DL2-DD-RTL-DLRS-RCVD            PIC  ZZZ,ZZZ,ZZ9.99.     03610066
036200     05  FILLER                          PIC  X(01)  VALUE SPACE. 03620066
036300     05  DL2-DD-DTLS-APP                 PIC  ZZZ,ZZZ,ZZ9.        03630066
036400     05  FILLER                          PIC  X(01)  VALUE SPACE. 03640066
036500     05  DL2-DD-UNT-DLRS-APP             PIC  ZZZ,ZZZ,ZZ9.99.     03650066
036600     05  FILLER                          PIC  X(01)  VALUE SPACE. 03660066
036700     05  DL2-DD-RTL-DLRS-APP             PIC  ZZZ,ZZZ,ZZ9.99.     03670066
036800     05  FILLER                          PIC  X(01)  VALUE SPACE. 03680066
036900     05  DL2-DD-DTLS-ERR                 PIC  ZZZ,ZZZ,ZZ9.        03690066
037000     05  FILLER                          PIC  X(01)  VALUE SPACE. 03700066
037100     05  DL2-DD-UNT-DLRS-ERR             PIC  ZZZ,ZZZ,ZZ9.99.     03710066
037200     05  FILLER                          PIC  X(01)  VALUE SPACE. 03720066
037300     05  DL2-DD-RTL-DLRS-ERR             PIC  ZZZ,ZZZ,ZZ9.99.     03730066
037400     05  FILLER                          PIC  X(01)  VALUE SPACE. 03740066
037500                                                                  03750066
037600 01  DL3-DETAIL-LINE-MOS.                                         03760066
037700     05  FILLER                          PIC  X(01)  VALUE SPACE. 03770066
037800     05  FILLER                          PIC  X(03)  VALUE        03780066
037900         'MOS'.                                                   03790066
038000     05  FILLER                          PIC  X(01)  VALUE SPACE. 03800066
038100     05  DL3-MOS-DTLS-RCVD               PIC  ZZZ,ZZZ,ZZ9.        03810066
038200     05  FILLER                          PIC  X(01)  VALUE SPACE. 03820066
038300     05  DL3-MOS-UNT-DLRS-RCVD           PIC  ZZZ,ZZZ,ZZ9.99.     03830066
038400     05  FILLER                          PIC  X(01)  VALUE SPACE. 03840066
038500     05  DL3-MOS-RTL-DLRS-RCVD           PIC  ZZZ,ZZZ,ZZ9.99.     03850066
038600     05  FILLER                          PIC  X(01)  VALUE SPACE. 03860066
038700     05  DL3-MOS-DTLS-APP                PIC  ZZZ,ZZZ,ZZ9.        03870066
038800     05  FILLER                          PIC  X(01)  VALUE SPACE. 03880066
038900     05  DL3-MOS-UNT-DLRS-APP            PIC  ZZZ,ZZZ,ZZ9.99.     03890066
039000     05  FILLER                          PIC  X(01)  VALUE SPACE. 03900066
039100     05  DL3-MOS-RTL-DLRS-APP            PIC  ZZZ,ZZZ,ZZ9.99.     03910066
039200     05  FILLER                          PIC  X(01)  VALUE SPACE. 03920066
039300     05  DL3-MOS-DTLS-ERR                PIC  ZZZ,ZZZ,ZZ9.        03930066
039400     05  FILLER                          PIC  X(01)  VALUE SPACE. 03940066
039500     05  DL3-MOS-UNT-DLRS-ERR            PIC  ZZZ,ZZZ,ZZ9.99.     03950066
039600     05  FILLER                          PIC  X(01)  VALUE SPACE. 03960066
039700     05  DL3-MOS-RTL-DLRS-ERR            PIC  ZZZ,ZZZ,ZZ9.99.     03970066
039800     05  FILLER                          PIC  X(01)  VALUE SPACE. 03980066
039900                                                                  03990066
040000 01  DL4-DETAIL-LINE-UNK.                                         04000066
040100     05  FILLER                          PIC  X(01)  VALUE SPACE. 04010066
040200     05  FILLER                          PIC  X(03)  VALUE        04020066
040300         'UNK'.                                                   04030066
040400     05  FILLER                          PIC  X(01)  VALUE SPACE. 04040066
040500     05  DL4-UNK-DTLS-UNK                PIC  ZZZ,ZZZ,ZZ9.        04050066
040600     05  FILLER                          PIC  X(01)  VALUE SPACE. 04060066
040700     05  DL4-UNK-UNT-DLRS-UNK            PIC  ZZZ,ZZZ,ZZ9.99.     04070066
040800     05  FILLER                          PIC  X(01)  VALUE SPACE. 04080066
040900     05  DL4-UNK-RTL-DLRS-UNK            PIC  ZZZ,ZZZ,ZZ9.99.     04090066
041000     05  FILLER                          PIC  X(94)  VALUE SPACE. 04100066
041100                                                                  04110066
041200 01  TL1-TOTAL-LINE.                                              04120066
041300     05  FILLER                          PIC  X(05)  VALUE        04130066
041400         'TOTAL'.                                                 04140066
041500     05  TL1-DTLS-RCVD                   PIC  ZZZ,ZZZ,ZZ9.        04150066
041600     05  FILLER                          PIC  X(01)  VALUE SPACE. 04160066
041700     05  TL1-UNT-DLRS-RCVD               PIC  ZZZ,ZZZ,ZZ9.99.     04170066
041800     05  FILLER                          PIC  X(01)  VALUE SPACE. 04180066
041900     05  TL1-RTL-DLRS-RCVD               PIC  ZZZ,ZZZ,ZZ9.99.     04190066
042000     05  FILLER                          PIC  X(01)  VALUE SPACE. 04200066
042100     05  TL1-DTLS-APP                    PIC  ZZZ,ZZZ,ZZ9.        04210066
042200     05  FILLER                          PIC  X(01)  VALUE SPACE. 04220066
042300     05  TL1-UNT-DLRS-APP                PIC  ZZZ,ZZZ,ZZ9.99.     04230066
042400     05  FILLER                          PIC  X(01)  VALUE SPACE. 04240066
042500     05  TL1-RTL-DLRS-APP                PIC  ZZZ,ZZZ,ZZ9.99.     04250066
042600     05  FILLER                          PIC  X(01)  VALUE SPACE. 04260066
042700     05  TL1-DTLS-ERR                    PIC  ZZZ,ZZZ,ZZ9.        04270066
042800     05  FILLER                          PIC  X(01)  VALUE SPACE. 04280066
042900     05  TL1-UNT-DLRS-ERR                PIC  ZZZ,ZZZ,ZZ9.99.     04290066
043000     05  FILLER                          PIC  X(01)  VALUE SPACE. 04300066
043100     05  TL1-RTL-DLRS-ERR                PIC  ZZZ,ZZZ,ZZ9.99.     04310066
043200     05  FILLER                          PIC  X(01)  VALUE SPACE. 04320066
043300                                                                  04330066
043400 01  BLANK-LINE.                                                  04340066
043500     05  FILLER                          PIC  X(132) VALUE SPACE. 04350066
043600                                                                  04360066
043700 01  END-OF-REPORT-LINE.                                          04370066
043800     05  FILLER                          PIC  X(54)  VALUE SPACE. 04380066
043900     05  FILLER                          PIC  X(25)  VALUE        04390066
044000         '***** END OF REPORT *****'.                             04400066
044100     05  FILLER                          PIC  X(53)  VALUE SPACE. 04410066
044200                                                                  04420066
044300 01  PV-NO-ERROR-LINE.                                            04430066
044400     05  FILLER                          PIC  X(43)  VALUE SPACE. 04440066
044500     05  FILLER                          PIC  X(47)  VALUE        04450066
044600         '******** THERE ARE NO ERRORS TO REPORT ********'.       04460066
044700     05  FILLER                          PIC  X(42)  VALUE SPACE. 04470066
044800                                                                  04480066
044900 01  PV-NO-HDR-LINE.                                              04490066
045000     05  FILLER                          PIC  X(43)  VALUE SPACE. 04500066
045100     05  FILLER                          PIC  X(47)  VALUE        04510066
045200         '******** HDR FILE MISSING - NO REPORT *********'.       04520066
045300     05  FILLER                          PIC  X(42)  VALUE SPACE. 04530066
045400                                                                  04540066
045500 01  PV-NO-SUM-LINE.                                              04550066
045600     05  FILLER                          PIC  X(43)  VALUE SPACE. 04560066
045700     05  FILLER                          PIC  X(47)  VALUE        04570066
045800         '******** SUM FILE MISSING - NO REPORT *********'.       04580066
045900     05  FILLER                          PIC  X(42)  VALUE SPACE. 04590066
046000                                                                  04600066
046100******************************************************************04610066
046200 LINKAGE SECTION.                                                 04620066
046300******************************************************************04630066
046400                                                                  04640066
046500******************************************************************04650066
046600 PROCEDURE DIVISION.                                              04660066
046700******************************************************************04670066
046800******************************************************************04680066
046900*  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM.  *04690066
047000******************************************************************04700066
047100 0000-PROGRAM-MAINLINE.                                           04710066
047200                                                                  04720066
047300     DISPLAY '************ START OF RVKRP023 ***************'     04730066
047400* * * THIS EXEC SQL IS JUST TO MAKE IT A DB2 PROGRAM              04740066
047500     EXEC SQL                                                     04750066
047600         SET :PV-CURRENT-TMST = CURRENT TIMESTAMP                 04760066
047700     END-EXEC                                                     04770066
047800     EVALUATE SQLCODE                                             04780066
047900         WHEN 0                                                   04790066
048000             CONTINUE                                             04800066
048100         WHEN OTHER                                               04810066
048200             PERFORM 9100-SQL-ABEND                               04820066
048300     END-EVALUATE.                                                04830066
048400                                                                  04840066
048500     PERFORM 1000-INITIALIZE.                                     04850066
048600                                                                  04860066
048700**CONTINUE PROCESSING IF INPUT FILE CONTAINS AT LEAST 1 RECORD    04870066
048800     IF PS-END-OF-SUM-INPUT-NO                                    04880066
048900         PERFORM 2000-PROCESS                                     04890066
049000     ELSE                                                         04900066
049100**NO RECORDS TO PROCESS                                           04910066
049200         DISPLAY ' '                                              04920066
049300         DISPLAY '******* MISSING RCVD SUMMARY FILE DATA  *****'  04930066
049400         DISPLAY ' '                                              04940066
049500         PERFORM 4200-WRITE-MISSING-SUM-REPORT                    04950066
049600         PERFORM 4300-WRITE-END-OF-REPORT                         04960066
049700     END-IF.                                                      04970066
049800                                                                  04980066
049900*END OF INPUT PROCESSING.                                         04990066
050000     PERFORM 8000-EOJ-ROUTINE.                                    05000066
050100     DISPLAY '************  END OF RVKRP023  ***************'     05010066
050200**  JH  10/30/2011  BEG                                           05020068
050300     GOBACK.                                                      05030068
050400**  JH  10/30/2011  END                                           05040068
050500                                                                  05050066
050600******************************************************************05060066
050700* INITIALIZE VARIABLES.                                           05070066
050800* OPEN INPUT AND OUTPUT FILES.                                    05080066
050900* DO A PRIME AND ONLY READ OF SINGLE REC FROM RCVD-SUMMARY-FILE   05090066
051000* READS THE RUN DATE FROM CONTROL CARD.                           05100066
051100* WRTIE PAGE HEADING TO THE REPORT.                               05110066
051200******************************************************************05120066
051300 1000-INITIALIZE.                                                 05130066
051400                                                                  05140066
051500     INITIALIZE   PA-PROGRAM-ACCUMULATORS                         05150066
051600                  PV-PROGRAM-VARIABLES.                           05160066
051700                                                                  05170066
051800*    OPEN INPUT  RTV-HEADER-FILE                                  05180066
051900     OPEN INPUT  RCVD-SUMMARY-FILE                                05190066
052000          OUTPUT SUMMARY-REPORT-FILE.                             05200066
052100                                                                  05210066
052200**PRIME READ OF RCVD SUMMARY FILE - IT CONTAINS 1 RECORD          05220066
052300     PERFORM 6001-READ-RCVD-SUMMARY-FILE.                         05230066
052400                                                                  05240066
052500**LOAD THE SUMMARY VALUES TO THE RESPECTIVE REPORT FIELDS         05250066
052600*    PERFORM 6100-LOAD-SUMMARY-DATA.                              05260066
052700**  JH  10/30/2011  BEG                                           05270066
052800                                                                  05280066
052900     ACCEPT CC-CONTROL-CARD FROM SYSIN.                           05290069
053000     PERFORM 1100-VALIDATE-CONTOL-CARD.                           05300069
053100                                                                  05310069
053200     PERFORM 5000-SELECT-TCOCNTL.                                 05320066
053300                                                                  05330066
053400     MOVE COCNTL-BTCH-PRC-DTE TO PV-PD-DTE.                       05340066
053500                                                                  05350066
053600     MOVE PV-PD-MM TO PH3-DATE-MM.                                05360066
053700     MOVE PV-PD-DD TO PH3-DATE-DD.                                05370066
053800     MOVE PV-PD-CY TO PH3-DATE-CCYY.                              05380066
053900                                                                  05390066
054000**  JH  10/30/2011  END                                           05400066
054100                                                                  05410066
054200     MOVE FUNCTION CURRENT-DATE (1:8) TO SD-SYSTEM-DATE.          05420066
054300     MOVE FUNCTION CURRENT-DATE (9:6) TO ST-SYSTEM-TIME.          05430066
054400                                                                  05440066
054500     MOVE SD-SYSTEM-CCYY   TO DP132-RUN-YEAR.                     05450066
054600     MOVE SD-SYSTEM-MONTH  TO DP132-RUN-MONTH.                    05460066
054700     MOVE SD-SYSTEM-DAY    TO DP132-RUN-DAY.                      05470066
054800                                                                  05480066
054900     MOVE ST-SYSTEM-HOUR   TO DP132-RUN-HOUR.                     05490066
055000     MOVE ST-SYSTEM-MINUTE TO DP132-RUN-MINUTE.                   05500066
055100                                                                  05510066
055200     MOVE 'RVKRP023'       TO DP132-PROGRAM-NAME.                 05520066
055300     MOVE 1                TO DP132-REPORT-NUMBER.                05530066
055400                                                                  05540066
055500**   CMS 10/30/2011  BEG                                          05550069
055600     IF RV020-RTV-LOC IS NUMERIC AND                              05560069
055700        RV020-RTV-LOC IS GREATER THAN ZERO                        05570069
055800         MOVE RV020-RTV-LOC     TO PH4-RTV-LOC                    05580069
055900         MOVE RV020-RTV-LOC-NME TO PH4-RTV-NAME                   05590069
056000     ELSE                                                         05600069
056100         MOVE CC-LOC            TO PV-KEY-LOC-NBR                 05610069
056200         PERFORM 6000-READ-XLT00010                               05620069
056300         MOVE CC-LOC            TO PH4-RTV-LOC                    05630069
056400         MOVE XLT00010-LOC-10-ABBR-NM                             05640069
056500                                TO PH4-RTV-NAME                   05650069
056600     END-IF.                                                      05660069
056700**   CMS 10/30/2011  END                                          05670069
056800                                                                  05680066
056900     PERFORM 4000-WRITE-PAGE-HEADING.                             05690066
057000                                                                  05700066
057100**   CMS 10/30/2011  BEG                                          05710069
057200 1100-VALIDATE-CONTOL-CARD.                                       05720069
057300     IF CC-LOC-NBR IS NOT NUMERIC                                 05730069
057400         DISPLAY '** ABEND **'                                    05740069
057500         DISPLAY '** PARAGRAPH '                                  05750069
057600                 '= 1100-VALIDATE-CONTOL-CARD **'                 05760069
057700         DISPLAY '** INVALID LOC NBR IN CONTROL CARD **'          05770069
057800         MOVE +4003 TO PV-ABEND-CODE                              05780069
057900         CALL 'ILBOABN0' USING PV-ABEND-CODE                      05790069
058000     END-IF.                                                      05800069
058100**   CMS 10/30/2011  END                                          05810069
058200                                                                  05820069
058300******************************************************************05830066
058400** PROCESS                                                        05840066
058500******************************************************************05850066
058600 2000-PROCESS.                                                    05860066
058700                                                                  05870066
058800**LOAD THE SUMMARY VALUES TO THE RESPECTIVE REPORT FIELDS         05880066
058900     PERFORM 6100-LOAD-SUMMARY-DATA.                              05890066
059000                                                                  05900066
059100     PERFORM 4100-WRITE-REPORT.                                   05910066
059200                                                                  05920066
059300******************************************************************05930066
059400** WRITE HEADING TO THE REPORT.                                   05940066
059500** THIS ONLY EXECUTES ONCE SINCE THIS IS A SINGLE PAGE REPORT.    05950066
059600******************************************************************05960066
059700 4000-WRITE-PAGE-HEADING.                                         05970066
059800                                                                  05980066
059900     ADD  1             TO PV-PAGE-COUNT.                         05990066
060000     MOVE PV-PAGE-COUNT TO DP132-PAGE-NUMBER.                     06000066
060100                                                                  06010066
060200     WRITE SUMMARY-REPORT-RECORD                                  06020066
060300         FROM DP132-STANDRD-HEADER-132-COLS.                      06030066
060400                                                                  06040066
060500     WRITE SUMMARY-REPORT-RECORD                                  06050066
060600         FROM PH2-PAGE-HEADING-2                                  06060066
060700         AFTER ADVANCING 1 LINES.                                 06070066
060800                                                                  06080066
060900     WRITE SUMMARY-REPORT-RECORD                                  06090066
061000         FROM PH3-PAGE-HEADING-3                                  06100066
061100         AFTER ADVANCING 1 LINES.                                 06110066
061200                                                                  06120066
061300**  JH 10/30/2011 BEG                                             06130066
061400     WRITE SUMMARY-REPORT-RECORD                                  06140066
061500         FROM PH4-PAGE-HEADING-4                                  06150066
061600         AFTER ADVANCING 1 LINES.                                 06160066
061700**  JH 10/30/2011 END                                             06170066
061800                                                                  06180066
061900     WRITE SUMMARY-REPORT-RECORD                                  06190066
062000         FROM BLANK-LINE                                          06200066
062100         AFTER ADVANCING 1 LINES.                                 06210066
062200                                                                  06220066
062300     WRITE SUMMARY-REPORT-RECORD                                  06230066
062400         FROM DH1-DETAIL-HEADING-1                                06240066
062500         AFTER ADVANCING 1 LINES.                                 06250066
062600                                                                  06260066
062700     WRITE SUMMARY-REPORT-RECORD                                  06270066
062800         FROM DH2-DETAIL-HEADING-2                                06280066
062900         AFTER ADVANCING 1 LINES.                                 06290066
063000                                                                  06300066
063100     WRITE SUMMARY-REPORT-RECORD                                  06310066
063200         FROM DH3-DETAIL-HEADING-3                                06320066
063300         AFTER ADVANCING 1 LINES.                                 06330066
063400                                                                  06340066
063500     WRITE SUMMARY-REPORT-RECORD                                  06350066
063600         FROM BLANK-LINE                                          06360066
063700         AFTER ADVANCING 1 LINES.                                 06370066
063800                                                                  06380066
063900******************************************************************06390066
064000** WRITE DETAIL LINES TO THE REPORT.                              06400066
064100******************************************************************06410066
064200 4100-WRITE-REPORT.                                               06420066
064300                                                                  06430066
064400     WRITE SUMMARY-REPORT-RECORD                                  06440066
064500      FROM DL1-DETAIL-LINE-RTV                                    06450066
064600     AFTER ADVANCING 1 LINES.                                     06460066
064700                                                                  06470066
064800     WRITE SUMMARY-REPORT-RECORD                                  06480066
064900      FROM DL2-DETAIL-LINE-DD                                     06490066
065000     AFTER ADVANCING 1 LINES.                                     06500066
065100                                                                  06510066
065200     WRITE SUMMARY-REPORT-RECORD                                  06520066
065300      FROM DL3-DETAIL-LINE-MOS                                    06530066
065400     AFTER ADVANCING 1 LINES.                                     06540066
065500                                                                  06550066
065600     WRITE SUMMARY-REPORT-RECORD                                  06560066
065700      FROM DL4-DETAIL-LINE-UNK                                    06570066
065800     AFTER ADVANCING 1 LINES.                                     06580066
065900                                                                  06590066
066000     WRITE SUMMARY-REPORT-RECORD                                  06600066
066100      FROM TL1-TOTAL-LINE                                         06610066
066200     AFTER ADVANCING 3 LINES.                                     06620066
066300                                                                  06630066
066400     WRITE SUMMARY-REPORT-RECORD                                  06640066
066500      FROM END-OF-REPORT-LINE                                     06650066
066600     AFTER ADVANCING 10 LINES.                                    06660066
066700                                                                  06670066
066800                                                                  06680066
066900******************************************************************06690066
067000** WRITE MISSING SUM REPORT IF THE RCVD SUMMARY FILE IS EMPTY     06700066
067100******************************************************************06710066
067200 4200-WRITE-MISSING-SUM-REPORT.                                   06720066
067300                                                                  06730066
067400     WRITE SUMMARY-REPORT-RECORD                                  06740066
067500         FROM PV-NO-SUM-LINE                                      06750066
067600         AFTER ADVANCING 2 LINES.                                 06760066
067700                                                                  06770066
067800******************************************************************06780066
067900** WRITE END OF REPORT LINE                                       06790066
068000******************************************************************06800066
068100 4300-WRITE-END-OF-REPORT.                                        06810066
068200                                                                  06820066
068300     WRITE SUMMARY-REPORT-RECORD                                  06830066
068400      FROM END-OF-REPORT-LINE                                     06840066
068500     AFTER ADVANCING 10 LINES.                                    06850066
068600                                                                  06860066
068700 5000-SELECT-TCOCNTL.                                             06870066
068800                                                                  06880066
068900     MOVE '5000-SELECT-TCOCNTL'  TO PV-PARAGRAPH-NAME.            06890066
069000                                                                  06900066
069100     EXEC SQL                                                     06910066
069200        SELECT  A.BTCH_PRC_DTE                                    06920066
069300          INTO :COCNTL-BTCH-PRC-DTE                               06930066
069400          FROM  TCOCNTL A                                         06940066
069500          WHERE A.OPER_UNT_ID   =  90                             06950066
069600     END-EXEC.                                                    06960066
069700                                                                  06970066
069800     EVALUATE TRUE                                                06980066
069900                                                                  06990066
070000         WHEN SQLCODE = ZEROS                                     07000066
070100             CONTINUE                                             07010066
070200         WHEN OTHER                                               07020066
070300             MOVE 'TCOCNTL' TO PV-DB2-VIEW-NAME                   07030066
070400             PERFORM 9100-SQL-ABEND                               07040066
070500                                                                  07050066
070600     END-EVALUATE.                                                07060066
070700**  JH  10/30/2011  END                                           07070066
070800                                                                  07080066
070900**  CMS 10/30/2011  BEG                                           07090069
071000******************************************************************07100069
071100*  READ XLT00010 - XLT_LOC TABLE.                                 07110069
071200******************************************************************07120069
071300 6000-READ-XLT00010.                                              07130069
071400     INITIALIZE DCLXLT00010.                                      07140069
071500     SET PS-XLT00010-NOTFND        TO TRUE.                       07150069
071600                                                                  07160069
071700     PERFORM                                                      07170069
071800         WITH TEST AFTER                                          07180069
071900         VARYING PV-RETRY-COUNTER                                 07190069
072000         FROM 1 BY 1                                              07200069
072100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               07210069
072200                   OR (SQLCODE = ZERO)                            07220069
072300                   OR (SQLCODE = +100))                           07230069
072400         EXEC SQL                                                 07240069
072500              SELECT  LOC_10_ABBR_NM                              07250069
072600              INTO  :XLT00010-LOC-10-ABBR-NM                      07260069
072700              FROM XLT_LOC                                        07270069
072800              WHERE LOC_NBR = :PV-KEY-LOC-NBR                     07280069
072900         END-EXEC                                                 07290069
073000                                                                  07300069
073100         EVALUATE TRUE                                            07310069
073200             WHEN SQLCODE = ZERO                                  07320069
073300             WHEN SQLCODE = -904                                  07330069
073400             WHEN SQLCODE = -911                                  07340069
073500             WHEN SQLCODE = -913                                  07350069
073600                 SET PS-XLT00010-FOUND TO TRUE                    07360069
073700             WHEN SQLCODE = +100                                  07370069
073800                 SET PS-XLT00010-NOTFND TO TRUE                   07380069
073900             WHEN SQLWARN0 NOT EQUAL SPACE                        07390069
074000             WHEN SQLCODE NOT EQUAL ZERO                          07400069
074100                 DISPLAY '** ABEND **'                            07410069
074200                 DISPLAY '** PROGRAM = RVKRP023 **'               07420073
074300                 DISPLAY '** PARAGRAPH = '                        07430069
074400                         '6000-READ-XLT00010 **'                  07440069
074500                 MOVE SQLCODE           TO PV-SQLCODE             07450071
074600                 MOVE 'SELECT XLT_LOC'  TO PV-ABEND-MESSAGE       07460071
074700                 MOVE 'XLT_LOC'         TO PV-DB2-VIEW-NAME       07470071
074800                 PERFORM 9100-SQL-ABEND                           07480071
074900         END-EVALUATE                                             07490069
075000     END-PERFORM.                                                 07500069
075100                                                                  07510069
075200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        07520069
075300         DISPLAY '** ABEND **'                                    07530069
075400         DISPLAY '** PROGRAM = RVKRP023 **'                       07540073
075500         DISPLAY '** PARAGRAPH = 6000-READ-XLT00010 **'           07550069
075600         MOVE SQLCODE                   TO PV-SQLCODE             07560071
075700         MOVE 'SELECT MAX RETRIES'                                07570069
075800                                        TO PV-ABEND-MESSAGE       07580069
075900         MOVE 'XLT_LOC'                 TO PV-DB2-VIEW-NAME       07590071
076000         PERFORM 9100-SQL-ABEND                                   07600071
076100     END-IF.                                                      07610069
076200**  CMS 10/30/2011  END                                           07620069
076300******************************************************************07630066
076400* READ THE RCVD SUMMARY FILE                                     *07640066
076500******************************************************************07650066
076600 6001-READ-RCVD-SUMMARY-FILE.                                     07660066
076700                                                                  07670066
076800     INITIALIZE RV020-DTL-SUMMARY-RECORD.                         07680066
076900                                                                  07690066
077000     READ RCVD-SUMMARY-FILE                                       07700066
077100         INTO RV020-DTL-SUMMARY-RECORD                            07710066
077200         AT END                                                   07720066
077300           SET PS-END-OF-SUM-INPUT-YES TO TRUE.                   07730066
077400                                                                  07740066
077500******************************************************************07750066
077600* LOAD THE SUMMARY VALUES FROM THE FILE TO THE RESPECTIVE        *07760066
077700* REPORT DISPLAY FIELDS                                          *07770066
077800******************************************************************07780066
077900 6100-LOAD-SUMMARY-DATA.                                          07790066
078000                                                                  07800066
078100     MOVE RV020-RTV-DTLS-RCVD      TO DL1-RTV-DTLS-RCVD.          07810066
078200     MOVE RV020-RTV-RTL-DLRS-RCVD  TO DL1-RTV-RTL-DLRS-RCVD.      07820066
078300     MOVE RV020-RTV-UNT-DLRS-RCVD  TO DL1-RTV-UNT-DLRS-RCVD.      07830066
078400     MOVE RV020-MOS-DTLS-RCVD      TO DL3-MOS-DTLS-RCVD.          07840066
078500     MOVE RV020-MOS-RTL-DLRS-RCVD  TO DL3-MOS-RTL-DLRS-RCVD.      07850066
078600     MOVE RV020-MOS-UNT-DLRS-RCVD  TO DL3-MOS-UNT-DLRS-RCVD.      07860066
078700     MOVE RV020-DD-DTLS-RCVD       TO DL2-DD-DTLS-RCVD.           07870066
078800     MOVE RV020-DD-RTL-DLRS-RCVD   TO DL2-DD-RTL-DLRS-RCVD.       07880066
078900     MOVE RV020-DD-UNT-DLRS-RCVD   TO DL2-DD-UNT-DLRS-RCVD.       07890066
079000                                                                  07900066
079100     MOVE RV020-RTV-DTLS-APPLID     TO DL1-RTV-DTLS-APP.          07910066
079200     MOVE RV020-RTV-RTL-DLRS-APPLID TO DL1-RTV-RTL-DLRS-APP.      07920066
079300     MOVE RV020-RTV-UNT-DLRS-APPLID TO DL1-RTV-UNT-DLRS-APP.      07930066
079400     MOVE RV020-MOS-DTLS-APPLID     TO DL3-MOS-DTLS-APP.          07940066
079500     MOVE RV020-MOS-RTL-DLRS-APPLID TO DL3-MOS-RTL-DLRS-APP.      07950066
079600     MOVE RV020-MOS-UNT-DLRS-APPLID TO DL3-MOS-UNT-DLRS-APP.      07960066
079700     MOVE RV020-DD-DTLS-APPLID      TO DL2-DD-DTLS-APP.           07970066
079800     MOVE RV020-DD-RTL-DLRS-APPLID  TO DL2-DD-RTL-DLRS-APP.       07980066
079900     MOVE RV020-DD-UNT-DLRS-APPLID  TO DL2-DD-UNT-DLRS-APP.       07990066
080000                                                                  08000066
080100     MOVE RV020-RTV-DTLS-ERR       TO DL1-RTV-DTLS-ERR.           08010066
080200     MOVE RV020-RTV-RTL-DLRS-ERR   TO DL1-RTV-RTL-DLRS-ERR.       08020066
080300     MOVE RV020-RTV-UNT-DLRS-ERR   TO DL1-RTV-UNT-DLRS-ERR.       08030066
080400     MOVE RV020-MOS-DTLS-ERR       TO DL3-MOS-DTLS-ERR.           08040066
080500     MOVE RV020-MOS-RTL-DLRS-ERR   TO DL3-MOS-RTL-DLRS-ERR.       08050066
080600     MOVE RV020-MOS-UNT-DLRS-ERR   TO DL3-MOS-UNT-DLRS-ERR.       08060066
080700     MOVE RV020-DD-DTLS-ERR        TO DL2-DD-DTLS-ERR.            08070066
080800     MOVE RV020-DD-RTL-DLRS-ERR    TO DL2-DD-RTL-DLRS-ERR.        08080066
080900     MOVE RV020-DD-UNT-DLRS-ERR    TO DL2-DD-UNT-DLRS-ERR.        08090066
081000                                                                  08100066
081100     MOVE RV020-UNK-DTLS-UNK       TO DL4-UNK-DTLS-UNK.           08110066
081200     MOVE RV020-UNK-RTL-DLRS-UNK   TO DL4-UNK-RTL-DLRS-UNK.       08120066
081300     MOVE RV020-UNK-UNT-DLRS-UNK   TO DL4-UNK-UNT-DLRS-UNK.       08130066
081400                                                                  08140066
081500     COMPUTE PV-RCVD-CNT-TOT = RV020-RTV-DTLS-RCVD +              08150066
081600                               RV020-MOS-DTLS-RCVD +              08160066
081700                               RV020-DD-DTLS-RCVD +               08170066
081800                               RV020-UNK-DTLS-UNK.                08180066
081900                                                                  08190066
082000     COMPUTE PV-RCVD-COST-TOT = RV020-RTV-UNT-DLRS-RCVD +         08200066
082100                                RV020-MOS-UNT-DLRS-RCVD +         08210066
082200                                RV020-DD-UNT-DLRS-RCVD +          08220066
082300                                RV020-UNK-UNT-DLRS-UNK.           08230066
082400                                                                  08240066
082500     COMPUTE PV-RCVD-RETL-TOT = RV020-RTV-RTL-DLRS-RCVD +         08250066
082600                                RV020-MOS-RTL-DLRS-RCVD +         08260066
082700                                RV020-DD-RTL-DLRS-RCVD +          08270066
082800                                RV020-UNK-RTL-DLRS-UNK.           08280066
082900                                                                  08290066
083000     MOVE PV-RCVD-CNT-TOT       TO TL1-DTLS-RCVD.                 08300066
083100     MOVE PV-RCVD-COST-TOT      TO TL1-UNT-DLRS-RCVD.             08310066
083200     MOVE PV-RCVD-RETL-TOT      TO TL1-RTL-DLRS-RCVD.             08320066
083300                                                                  08330066
083400     COMPUTE PV-APPLD-CNT-TOT = RV020-RTV-DTLS-APPLID +           08340066
083500                                RV020-MOS-DTLS-APPLID +           08350066
083600                                RV020-DD-DTLS-APPLID.             08360066
083700                                                                  08370066
083800     COMPUTE PV-APPLD-COST-TOT = RV020-RTV-UNT-DLRS-APPLID +      08380066
083900                                 RV020-MOS-UNT-DLRS-APPLID +      08390066
084000                                 RV020-DD-UNT-DLRS-APPLID.        08400066
084100                                                                  08410066
084200     COMPUTE PV-APPLD-RETL-TOT = RV020-RTV-RTL-DLRS-APPLID +      08420066
084300                                RV020-MOS-RTL-DLRS-APPLID +       08430066
084400                                RV020-DD-RTL-DLRS-APPLID.         08440066
084500                                                                  08450066
084600     MOVE PV-APPLD-CNT-TOT       TO TL1-DTLS-APP.                 08460066
084700     MOVE PV-APPLD-COST-TOT      TO TL1-UNT-DLRS-APP.             08470066
084800     MOVE PV-APPLD-RETL-TOT      TO TL1-RTL-DLRS-APP.             08480066
084900                                                                  08490066
085000     COMPUTE PV-ERROR-CNT-TOT = RV020-RTV-DTLS-ERR +              08500066
085100                                RV020-MOS-DTLS-ERR +              08510066
085200                                RV020-DD-DTLS-ERR.                08520066
085300                                                                  08530066
085400     COMPUTE PV-ERROR-COST-TOT = RV020-RTV-UNT-DLRS-ERR +         08540066
085500                                 RV020-MOS-UNT-DLRS-ERR +         08550066
085600                                 RV020-DD-UNT-DLRS-ERR.           08560066
085700                                                                  08570066
085800     COMPUTE PV-ERROR-RETL-TOT = RV020-RTV-RTL-DLRS-ERR +         08580066
085900                                RV020-MOS-RTL-DLRS-ERR +          08590066
086000                                RV020-DD-RTL-DLRS-ERR.            08600066
086100                                                                  08610066
086200**  JH 10/30/2011 BEG                                             08620066
086300     MOVE RV020-RTV-LOC     TO PH4-RTV-LOC.                       08630066
086400     MOVE RV020-RTV-LOC-NME TO PH4-RTV-NAME.                      08640066
086500**  JH 10/30/2011 END                                             08650066
086600                                                                  08660066
086700     MOVE PV-ERROR-CNT-TOT       TO TL1-DTLS-ERR.                 08670066
086800     MOVE PV-ERROR-COST-TOT      TO TL1-UNT-DLRS-ERR.             08680066
086900     MOVE PV-ERROR-RETL-TOT      TO TL1-RTL-DLRS-ERR.             08690066
087000                                                                  08700066
087100******************************************************************08710066
087200* CLOSE FILES                                                     08720066
087300* DISPLAY SUMMARY STATISTICS                                      08730066
087400******************************************************************08740066
087500 8000-EOJ-ROUTINE.                                                08750066
087600                                                                  08760066
087700     CLOSE RCVD-SUMMARY-FILE                                      08770066
087800           SUMMARY-REPORT-FILE.                                   08780066
087900                                                                  08790066
088000*    DISPLAY '***********************************************'.   08800066
088100*    DISPLAY '**    * RVKRP023 SUMMARY STATISTICS *        **'.   08810066
088200*    DISPLAY '**                                           **'.   08820066
088300*    DISPLAY '**      ----------------------------         **'.   08830066
088400*    DISPLAY '**      RCVD -VS- APPLIED GENCO LOAD         **'.   08840066
088500*    DISPLAY '**      ----------------------------         **'.   08850066
088600*    DISPLAY '***********************************************'.   08860066
088700                                                                  08870066
088800******************************************************************08880066
088900* PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    *08890066
089000* ERROR OR WARNING CODE OCCURS.                                  *08900066
089100******************************************************************08910066
089200 9100-SQL-ABEND.                                                  08920066
089300******************************************************************08930066
089400* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-   *08940066
089500* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE        *08950066
089600* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE    *08960066
089700* FORMAT.                                                        *08970066
089800******************************************************************08980066
089900                                                                  08990066
090000     COPY DPPD004.                                                09000066
090100                                                                  09010066
090200     DISPLAY '***********************************'.               09020066
090300     DISPLAY ' GENCO - COMPARE RCVD TO LOADED    '.               09030066
090400     DISPLAY '       REPORT - RVKRP023           '.               09040066
090500     DISPLAY '***********************************'.               09050066
090600     DISPLAY '* CURRENT STATS AT TIME OF ABEND  *'.               09060066
090700     DISPLAY '***********************************'.               09070066
090800     DISPLAY '** TOT HDR RECS READ   :' PA-TOT-HDR-RECS-READ.     09080066
090900     DISPLAY '***********************************************'.   09090066
091000     DISPLAY '** ABEND PARAGRAPH **  ' PV-PARAGRAPH-NAME.         09100066
091100     DISPLAY '** ERROR MESSAGE   **  ' PV-ABEND-MESSAGE.          09110066
091200     DISPLAY '** SQLCODE         **  ' PV-SQLCODE.                09120066
091300     DISPLAY '** VIEW  NAME      **  ' PV-DB2-VIEW-NAME.          09130066
091400     DISPLAY '***********************************************'.   09140066
091500     DISPLAY ' '.                                                 09150066
091600     MOVE +4013 TO ABEND-CODE.                                    09160066
091700     CALL 'ILBOABN0' USING ABEND-CODE.                            09170066
091800                                                                  09180066
091900****************************************************************  09190066
092000** PERFORM NON SQL ABEND PROCESSING                               09200066
092100****************************************************************  09210066
092200 9200-NON-SQL-ABEND.                                              09220066
092300                                                                  09230066
092400     DISPLAY '************************************************'.  09240066
092500     DISPLAY '********** NON SQL PROGRAM ABEND ***************'.  09250066
092600     DISPLAY '** PROGRAM:    ', PC-CURRENT-PROGRAM-NAME.          09260066
092700     DISPLAY '** ABEND CODE: ', PV-ABEND-CODE.                    09270066
092800     DISPLAY '** PARAGRAPH:  ', PV-PARAGRAPH-NAME.                09280066
092900     DISPLAY '** MESSAGE:    ', PV-ABEND-MESSAGE.                 09290066
093000     DISPLAY '***********************************'.               09300066
093100     DISPLAY '* CURRENT STATS AT TIME OF ABEND  *'.               09310066
093200     DISPLAY '***********************************'.               09320066
093300     DISPLAY '** TOT HDR RECS READ   :' PA-TOT-HDR-RECS-READ.     09330066
093400     DISPLAY '***********************************************'.   09340066
093500     MOVE +4013 TO ABEND-CODE.                                    09350066
093600     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         09360066
093700                                                                  09370066
093800******************************************************************09380066
093900*                       END OF PROGRAM                            09390066
094000******************************************************************09400066
