000100******************************************************************00010002
000200 IDENTIFICATION DIVISION.                                         00020002
000300******************************************************************00030002
000400                                                                  00040002
000500 PROGRAM-ID.    TRKRP202.                                         00050002
000600 AUTHOR.        DAVE PHELPS                                       00060002
000700 INSTALLATION.  KOHLS.                                            00070002
000800 DATE-WRITTEN   FEB, 1998.                                        00080002
000900 DATE-COMPILED.                                                   00090002
001000                                                                  00100002
001100*----------------------------------------------------------------*00110002
001200*  THIS PROGRAM CREATES AN GOOD REPORT OF DATA THAT WAS           00120002
001300*  LOADED TO THE DB2 TABLES IN TRKRP200.                          00130002
001400*----------------------------------------------------------------*00140002
001500                                                                  00150002
001600******************************************************************00160002
001700 ENVIRONMENT DIVISION.                                            00170002
001800******************************************************************00180002
001900                                                                  00190002
002000 CONFIGURATION SECTION.                                           00200002
002100                                                                  00210002
002200 SOURCE-COMPUTER.        IBM-3090.                                00220002
002300 OBJECT-COMPUTER.        IBM-3090.                                00230002
002400                                                                  00240002
002500 INPUT-OUTPUT SECTION.                                            00250002
002600                                                                  00260002
002700 FILE-CONTROL.                                                    00270002
002800                                                                  00280002
002900     SELECT ERROR-FILE                                            00290002
003000         ASSIGN TO INP01.                                         00300002
003100                                                                  00310002
003200     SELECT ERROR-REPORT-FILE                                     00320002
003300         ASSIGN TO RPT01.                                         00330002
003400                                                                  00340002
003500******************************************************************00350002
003600 DATA DIVISION.                                                   00360002
003700******************************************************************00370002
003800                                                                  00380002
003900 FILE SECTION.                                                    00390002
004000                                                                  00400002
004100 FD  ERROR-FILE                                                   00410002
004200     RECORDING MODE IS F                                          00420002
004300     LABEL RECORDS ARE STANDARD                                   00430002
004400     BLOCK CONTAINS 0 RECORDS.                                    00440002
004500                                                                  00450002
004600 01  ERROR-RECORD                     PIC  X(254).                00460002
004700                                                                  00470002
004800                                                                  00480002
004900 FD  ERROR-REPORT-FILE                                            00490002
005000     RECORDING MODE IS F                                          00500002
005100     LABEL RECORDS ARE STANDARD                                   00510002
005200     BLOCK CONTAINS 0 RECORDS.                                    00520002
005300                                                                  00530002
005400 01  ERROR-REPORT-RECORD              PIC  X(132).                00540002
005500*                                                                 00550002
005600*                                                                 00560002
005700*----------------------------------------------------------------*00570002
005800 WORKING-STORAGE SECTION.                                         00580002
005900*----------------------------------------------------------------*00590002
005901*                                                                 00600002
005902*----------------------------------------------------------------*00610002
005903*   PURCHASE ORDER HEADER TABLE.                                  00620002
005904*----------------------------------------------------------------*00630002
005905                                                                  00640002
005906     EXEC SQL                                                     00650002
005907         INCLUDE TPURCHS                                          00660002
005908     END-EXEC.                                                    00670002
005909                                                                  00680002
005910*----------------------------------------------------------------*00690002
005920*   VENDOR NAME HEADER TABLE.                                     00700002
005930*----------------------------------------------------------------*00710002
005940                                                                  00720002
005950     EXEC SQL                                                     00730002
005960         INCLUDE TENTNME                                          00740002
005970     END-EXEC.                                                    00750002
005971                                                                  00760002
005972*----------------------------------------------------------------*00770002
005973*   POL HEADER TABLE.                                             00780002
005974*----------------------------------------------------------------*00790002
005975                                                                  00800002
005976     EXEC SQL                                                     00810002
005977         INCLUDE TIMFOB                                           00820002
005978     END-EXEC.                                                    00830002
005979                                                                  00840002
006100*----------------------------------------------------------------*00850002
006200***  WORK FIELDS FOR THE ERROR REPORT                             00860002
006400*----------------------------------------------------------------*00870002
006500     COPY TRRD201.                                                00880099
006600*                                                                 00890002
006800*----------------------------------------------------------------*00900002
006900***  STANDARD REPORT HEADER FOR 132 COLUMN REPORT                 00910002
007000*----------------------------------------------------------------*00920002
007100     COPY DPWS132O.                                               00930099
007200*                                                                 00940002
007400 01  HL1-HEADING-LINE-1.                                          00950002
007815         10 FILLER                   PIC  X(02)      VALUE SPACES.00960002
007816     05  HL1-TRANS-DATE.                                          00970002
007817         10 HL-TRANS-MM              PIC  X(02)      VALUE SPACE. 00980002
007818         10 FILLER                   PIC  X(01)      VALUE '/'.   00990002
007819         10 HL-TRANS-DD              PIC  X(02)      VALUE SPACE. 01000002
007820         10 FILLER                   PIC  X(01)      VALUE '/'.   01010002
007821         10 HL-TRANS-YY              PIC  X(02)      VALUE SPACE. 01020002
007822     05  FILLER                      PIC  X(02)      VALUE SPACE. 01030002
007823     05  HL1-TRANS-TIME.                                          01040002
007830         10 HL-TRANS-TIME-HH         PIC  X(02)      VALUE SPACE. 01050002
007840         10 FILLER                   PIC  X(01)      VALUE ':'.   01060002
007841         10 HL-TRANS-TIME-MM         PIC  X(02)      VALUE SPACE. 01070002
007842     05  FILLER                      PIC  X(01)      VALUE SPACE. 01080002
007843     05  FILLER                      PIC  X(13)      VALUE        01090002
007844         'TRANSMIT DATE'.                                         01100002
007845     05  FILLER                      PIC  X(16)      VALUE SPACE. 01110002
007846     05  FILLER                      PIC  X(38)      VALUE        01120002
007847         '    IMPORT PURCHASE ORDER TRACKING    '.                01130002
007848     05  FILLER                      PIC  X(16)      VALUE SPACE. 01140002
007849     05  FILLER                      PIC  X(07)      VALUE        01150002
007850         'FILE ID'.                                               01160002
007851     05  FILLER                      PIC  X(02)      VALUE SPACE. 01170002
007852     05  HL1-FILE-ID                 PIC  X(09)      VALUE SPACE. 01180002
007853     05  FILLER                      PIC  X(01)      VALUE SPACE. 01190002
007854*                                                                 01200002
007855 01  HL1-HEADING-LINE-2.                                          01210002
007856         10 FILLER                   PIC  X(02)      VALUE SPACES.01220002
007857     05  HL1-LOAD-DATE.                                           01230002
007858         10 HL-LOAD-MM               PIC  X(02)      VALUE SPACE. 01240002
007859         10 FILLER                   PIC  X(01)      VALUE '/'.   01250002
007860         10 HL-LOAD-DD               PIC  X(02)      VALUE SPACE. 01260002
007861         10 FILLER                   PIC  X(01)      VALUE '/'.   01270002
007862         10 HL-LOAD-YY               PIC  X(02)      VALUE SPACE. 01280002
007863     05  FILLER                      PIC  X(02)      VALUE SPACE. 01290002
007864     05  HL1-LOAD-TIME.                                           01300002
007865         10 HL-LOAD-TIME-HH          PIC  X(02)      VALUE SPACE. 01310002
007866         10 FILLER                   PIC  X(01)      VALUE ':'.   01320002
007867         10 HL-LOAD-TIME-MM          PIC  X(02)      VALUE SPACE. 01330002
007868     05  FILLER                      PIC  X(01)      VALUE SPACE. 01340002
007869     05  FILLER                      PIC  X(13)      VALUE        01350002
007870         'LOAD DATE    '.                                         01360002
007871     05  FILLER                      PIC  X(16)      VALUE SPACE. 01370002
007872     05  FILLER                      PIC  X(38)      VALUE        01380002
007873         '      BOOKING LOAD DETAIL REPORT      '.                01391090
007874     05  FILLER                      PIC  X(16)      VALUE SPACE. 01400002
007875     05  HL1-EXPEDITOR               PIC  X(30)      VALUE SPACES.01410002
007876*                                                                 01420168
007877 01  HL2-HEADING-LINE-1.                                          01420268
007878     05  FILLER                      PIC  X(31)      VALUE SPACE. 01420368
007879     05  HL2-RECD-1                  PIC  X(03)      VALUE        01420468
007880         'EST'.                                                   01420568
007881     05  FILLER                      PIC  X(05)      VALUE SPACE. 01420668
007882     05  FILLER                      PIC  X(04)      VALUE        01420768
007883         'SHPD'.                                                  01421068
007884     05  FILLER                      PIC  X(28)      VALUE SPACE. 01430068
007885*                                                                 01490002
007886 01  HL2-HEADING-LINE-2.                                          01490268
007887     05  FILLER                      PIC  X(03)      VALUE SPACE. 01490368
007888     05  HL2-RECD-2                  PIC  X(02)      VALUE        01490468
007889         'PO'.                                                    01490568
007890     05  FILLER                      PIC  X(06)      VALUE SPACE. 01490668
007891     05  HL2-TRN                     PIC  X(09)      VALUE        01490768
007892         'REFERENCE'.                                             01490868
007893     05  FILLER                      PIC  X(08)      VALUE SPACE. 01490968
007894     05  FILLER                      PIC  X(08)      VALUE        01491068
007895         'DELY DTE'.                                              01491168
007896     05  FILLER                      PIC  X(03)      VALUE SPACE. 01491268
007897     05  FILLER                      PIC  X(04)      VALUE        01491368
007898         'FROM'.                                                  01491468
007899     05  FILLER                      PIC  X(10)      VALUE SPACE. 01491568
007900     05  FILLER                      PIC  X(11)      VALUE        01491668
007901         'VENDOR NAME'.                                           01492068
007902     05  FILLER                      PIC  X(33)      VALUE SPACE. 01500068
007980*                                                                 01640002
007981 01  HL3-HEADING-LINE-1.                                          01650002
007982     05  HL3-TYPE-1-LNE-1            PIC  X(04).                  01660007
007983     05  FILLER                      PIC  X(04)      VALUE SPACE. 01670016
007984     05  HL3-TYPE-2-LNE-1            PIC  X(04).                  01680007
008300     05  FILLER                      PIC  X(49)      VALUE SPACE. 01690099
008400     05  FILLER                      PIC  X(06)      VALUE        01730002
008401         'CONSOL'.                                                01740002
008402*                                                                 01760002
008403 01  HL3-HEADING-LINE-2.                                          01770002
008404     05  HL3-TYPE-1-LNE-2            PIC  X(04).                  01780007
008405     05  FILLER                      PIC  X(04)      VALUE SPACE. 01790002
008406     05  HL3-TYPE-2-LNE-2            PIC  X(04).                  01800007
008407     05  FILLER                      PIC  X(02)      VALUE SPACE. 01810002
008408     05  FILLER                      PIC  X(05)      VALUE        01820002
008409         'CNTRY'.                                                 01830002
008422     05  FILLER                      PIC  X(17)      VALUE SPACE. 01870099
008423     05  FILLER                      PIC  X(12)      VALUE        01880002
008424         'FACTORY NAME'.                                          01890002
008425     05  FILLER                      PIC  X(14)      VALUE SPACE. 01900002
008426     05  FILLER                      PIC  X(06)      VALUE        01940081
008427         'SCAC'.                                                  01950002
008428     05  FILLER                      PIC  X(02)      VALUE SPACE. 01960099
008429     05  FILLER                      PIC  X(07)      VALUE        01970002
008430         'CARTONS'.                                               01980002
008410     05  FILLER                      PIC  X(07)      VALUE SPACE. 01981081
008420     05  FILLER                      PIC  X(05)      VALUE        01982076
008421         'UNITS'.                                                 01983076
008431     05  FILLER                      PIC  X(09)      VALUE SPACE. 01990080
008432     05  FILLER                      PIC  X(04)      VALUE        02000002
008433         'CBMS'.                                                  02010002
008434     05  FILLER                      PIC  X(06)      VALUE SPACE. 02020091
008435     05  FILLER                      PIC  X(05)      VALUE        02030002
008436         'KGRMS'.                                                 02040002
008437     05  FILLER                      PIC  X(70)      VALUE SPACE. 02050002
008438*                                                                 02210002
008439 01  HL4-HEADING-LINE-1.                                          02220002
008440     05  FILLER                      PIC  X(09)      VALUE SPACE. 02221089
008441     05  HL4-TYPE-1-LNE-1            PIC  X(04).                  02230022
008442     05  FILLER                      PIC  X(04)      VALUE SPACE. 02240089
008443     05  HL4-TYPE-2-LNE-1            PIC  X(03).                  02250022
008444     05  FILLER                      PIC  X(71)      VALUE SPACE. 02260002
008445*                                                                 02270002
008446 01  HL4-HEADING-LINE-2.                                          02280002
008447     05  FILLER                      PIC  X(09)      VALUE SPACE. 02290082
008448     05  HL4-TYPE-1-LNE-2            PIC  X(04).                  02300022
008449     05  FILLER                      PIC  X(04)      VALUE SPACE. 02310002
008450     05  HL4-TYPE-2-LNE-2            PIC  X(04).                  02320022
008451     05  FILLER                      PIC  X(07)      VALUE SPACE. 02330021
008452     05  FILLER                      PIC  X(12)      VALUE        02340002
008453         'VENDOR STYLE'.                                          02350002
008454     05  FILLER                      PIC  X(30)      VALUE SPACE. 02360079
008455     05  FILLER                      PIC  X(07)      VALUE        02400002
008456         'CARTONS'.                                               02410002
008457     05  FILLER                      PIC  X(07)      VALUE SPACE. 02420081
008458     05  FILLER                      PIC  X(05)      VALUE        02430002
008459         'UNITS'.                                                 02440002
008460     05  FILLER                      PIC  X(09)      VALUE SPACE. 02450081
008470     05  FILLER                      PIC  X(04)      VALUE        02460002
008471         'CBMS'.                                                  02470002
008472     05  FILLER                      PIC  X(06)      VALUE SPACE. 02480091
008473     05  FILLER                      PIC  X(05)      VALUE        02490002
008474         'KGRMS'.                                                 02500002
008475     05  FILLER                      PIC  X(70)      VALUE SPACE. 02510002
008476*                                                                 02670002
008477 01  HL5-HEADING-LINE-1.                                          02680002
008478     05  FILLER                      PIC  X(17)      VALUE SPACE. 02690098
008479     05  HL5-RECD                    PIC  X(04).                  02700002
008480     05  FILLER                      PIC  X(04)      VALUE SPACE. 02710002
008481     05  HL5-TRN                     PIC  X(03).                  02720002
008482     05  FILLER                      PIC  X(02)      VALUE SPACE. 02730002
008483*                                                                 02740002
008484 01  HL5-HEADING-LINE-2.                                          02750002
008485     05  FILLER                      PIC  X(17)      VALUE SPACE. 02760098
008486     05  HL5-TYPE-1                  PIC  X(04).                  02770002
008487     05  FILLER                      PIC  X(04)      VALUE SPACE. 02780002
008488     05  HL5-TYPE-2                  PIC  X(04).                  02790002
008489     05  FILLER                      PIC  X(07)      VALUE SPACE. 02800098
008490     05  FILLER                      PIC  X(12)      VALUE        02810002
008491         'VENDOR STYLE'.                                          02820002
008492     05  FILLER                      PIC  X(10)      VALUE SPACE. 02830081
008493     05  FILLER                      PIC  X(03)      VALUE        02840002
008494         'UPC'.                                                   02850002
008495     05  FILLER                      PIC  X(09)      VALUE SPACE. 02860081
008496     05  FILLER                      PIC  X(07)      VALUE        02870002
008497         'CARTONS'.                                               02880002
008498     05  FILLER                      PIC  X(07)      VALUE SPACE. 02890080
008499     05  FILLER                      PIC  X(05)      VALUE        02900002
008500         'UNITS'.                                                 02910002
008501     05  FILLER                      PIC  X(09)      VALUE SPACE. 02920080
008502     05  FILLER                      PIC  X(04)      VALUE        02930002
008503         'CBMS'.                                                  02940002
008504     05  FILLER                      PIC  X(06)      VALUE SPACE. 02950091
008505     05  FILLER                      PIC  X(05)      VALUE        02960002
008506         'KGRMS'.                                                 02970002
008508*                                                                 03150002
008509 01  HL6-HEADING-LINE-1.                                          03160002
008510     05  HL6-RECD                    PIC  X(04)      VALUE        03170025
008511         'RECD'.                                                  03180002
008512     05  FILLER                      PIC  X(04)      VALUE SPACE. 03190040
008513     05  HL6-TRN                     PIC  X(04)      VALUE        03200025
008514         'TRN '.                                                  03210002
008515     05  FILLER                      PIC  X(02)      VALUE SPACE. 03220083
008516     05  HL6-TYPE-3                  PIC  X(03)      VALUE        03230002
008517         'VSL'.                                                   03240002
008518     05  FILLER                      PIC  X(13)      VALUE SPACE. 03250002
008519     05  FILLER                      PIC  X(04)      VALUE        03260002
008520         'CARR'.                                                  03270002
008461     05  FILLER                      PIC  X(74)      VALUE SPACE. 03270174
008482     05  FILLER                      PIC  X(07)      VALUE        03270274
008483         'EST LBD'.                                               03270374
008461     05  FILLER                      PIC  X(10)      VALUE SPACE. 03270474
008482     05  FILLER                      PIC  X(03)      VALUE        03271074
008483         'EST'.                                                   03280074
008522*                                                                 03290002
008523 01  HL6-HEADING-LINE-2-A.                                        03300002
008524     05  HL6-TYPE-1                  PIC  X(04)      VALUE        03310026
008525         'TYPE'.                                                  03320002
008526     05  FILLER                      PIC  X(04)      VALUE SPACE. 03330002
008527     05  HL6-TYPE-2                  PIC  X(04)      VALUE        03340026
008528         'TYPE'.                                                  03350002
008529     05  FILLER                      PIC  X(01)      VALUE SPACE. 03360083
008530     05  HL6-A-TYPE-3                PIC  X(04)      VALUE        03370002
008531         'TYPE'.                                                  03380002
008532     05  FILLER                      PIC  X(02)      VALUE SPACE. 03390002
008533     05  FILLER                      PIC  X(10)      VALUE        03400002
008534         'VOYAGE NBR'.                                            03410002
008481     05  FILLER                      PIC  X(01)      VALUE SPACE. 03410184
008488     05  FILLER                      PIC  X(04)      VALUE        03410284
008489         'SCAC'.                                                  03410384
008484     05  FILLER                      PIC  X(10)      VALUE SPACE. 03410484
008485     05  FILLER                      PIC  X(11)      VALUE        03410584
008486         'VESSEL NAME'.                                           03410684
008490     05  FILLER                      PIC  X(13)      VALUE SPACE. 03410784
008491     05  FILLER                      PIC  X(03)      VALUE        03410874
008492         'POL'.                                                   03410984
008487     05  FILLER                      PIC  X(08)      VALUE SPACE. 03411084
008482     05  FILLER                      PIC  X(03)      VALUE        03411174
008483         'ETD'.                                                   03411295
008487     05  FILLER                      PIC  X(06)      VALUE SPACE. 03411384
008482     05  FILLER                      PIC  X(03)      VALUE        03411484
008483         'POE'.                                                   03411584
008487     05  FILLER                      PIC  X(04)      VALUE SPACE. 03411684
008482     05  FILLER                      PIC  X(03)      VALUE        03411774
008483         'ETA'.                                                   03412084
008493     05  FILLER                      PIC  X(11)      VALUE SPACE. 03420084
008482     05  FILLER                      PIC  X(04)      VALUE        03430084
008483         'DEST'.                                                  03440084
008493     05  FILLER                      PIC  X(12)      VALUE SPACE. 03450084
008482     05  FILLER                      PIC  X(03)      VALUE        03460084
008483         'LBD'.                                                   03470084
008493     05  FILLER                      PIC  X(09)      VALUE SPACE. 03480084
008554*                                                                 03760002
008555 01  HL7-HEADING-LINE-1.                                          03762124
008556     05  HL7-RECD                    PIC  X(04)      VALUE        03763024
008557         'RECD'.                                                  03764024
008558     05  FILLER                      PIC  X(04)      VALUE SPACE. 03765024
008559     05  HL7-TRN                     PIC  X(04)      VALUE        03766024
008560         'TRN '.                                                  03767024
008561     05  FILLER                      PIC  X(16)      VALUE SPACE. 03840002
008562     05  FILLER                      PIC  X(04)      VALUE        03850002
008563         'CARR'.                                                  03860002
008564     05  FILLER                      PIC  X(12)      VALUE SPACE. 03870002
008565*                                                                 03880002
008566 01  HL7-HEADING-LINE-2.                                          03890002
008567     05  HL7-TYPE-1                  PIC  X(04)      VALUE        03900024
008568         'TYPE'.                                                  03910002
008569     05  FILLER                      PIC  X(04)      VALUE SPACE. 03920002
008570     05  HL7-TYPE-2                  PIC  X(04)      VALUE        03930024
008571         'TYPE'.                                                  03940002
008572     05  FILLER                      PIC  X(03)      VALUE SPACE. 03950002
008573     05  FILLER                      PIC  X(10)      VALUE        03960002
008574         'VOYAGE NBR'.                                            03970002
008575     05  FILLER                      PIC  X(02)      VALUE SPACE. 03980002
008576     05  FILLER                      PIC  X(04)      VALUE        03990002
008577         'SCAC'.                                                  04000002
008578     05  FILLER                      PIC  X(05)      VALUE SPACE. 04010002
008579     05  FILLER                      PIC  X(03)      VALUE        04020002
008580         'ETA'.                                                   04030002
008581     05  FILLER                      PIC  X(09)      VALUE SPACE. 04040002
008582     05  FILLER                      PIC  X(03)      VALUE        04050002
008583         'ETD'.                                                   04060095
008584     05  FILLER                      PIC  X(08)      VALUE SPACE. 04070002
008585     05  FILLER                      PIC  X(20)      VALUE        04080002
008586         'VOYAGE CHANGE REASON'.                                  04090002
008587     05  FILLER                      PIC  X(11)      VALUE SPACE. 04100002
009990*                                                                 04260002
009991 01  DL-DETAIL-LINE-2.                                            04270002
009992     05  DL02-PO-NBR-9              PIC  ZZZZZZZZZ  VALUE ZEROES. 04280053
013306     05  DL02-PO-NBR-X REDEFINES DL02-PO-NBR-9                    04281052
013307                                    PIC  XXXXXXXXX.               04282052
013308     05  FILLER                     PIC  X(02)    VALUE SPACES.   04290002
013309     05  DL02-REFERENCE-NBR         PIC  X(15)    VALUE SPACES.   04300002
013310     05  FILLER                     PIC  X(01)    VALUE SPACES.   04310002
013320     05  DL02-EST-DELIVERY-DATE.                                  04320002
013330         10  DL02-EST-DEL-MON       PIC  X(02)    VALUE SPACES.   04330002
013340         10  DL02-EST-SLASH-1       PIC  X(01)    VALUE '/'.      04340002
013350         10  DL02-EST-DEL-DAY       PIC  X(02)    VALUE SPACES.   04350002
013360         10  DL02-EST-SLASH-2       PIC  X(01)    VALUE '/'.      04360002
013361         10  DL02-EST-DEL-YEAR      PIC  X(04)    VALUE SPACES.   04370002
013362     05  FILLER                     PIC  X(02)    VALUE SPACES.   04370165
013363     05  DL02-SHPD-FR-CDE           PIC  X(03)    VALUE SPACES.   04371065
013364     05  FILLER                     PIC  X(02)    VALUE SPACES.   04380065
013365     05  DL02-VENDOR-NAME           PIC  X(30)    VALUE SPACES.   04390002
013366     05  FILLER                     PIC  X(10)    VALUE SPACES.   04400002
013367*                                                                 04410002
013368 01  DL-DETAIL-LINE-3.                                            04420002
013369     05  DL03-RECD-TYPE             PIC  X(06)    VALUE SPACES.   04430002
013370     05  FILLER                     PIC  X(03)    VALUE SPACES.   04440041
013371     05  DL03-TRN-TYPE              PIC  X(01)    VALUE SPACES.   04450002
013372     05  FILLER                     PIC  X(05)    VALUE SPACES.   04460042
013373     05  DL03-PROD-CNTRY-CDE        PIC  X(03).                   04470002
013378     05  FILLER                     PIC  X(07)    VALUE SPACES.   04500099
013379     05  DL03-PROD-FCTRY-CDE        PIC  X(35).                   04510002
013380     05  FILLER                     PIC  X(02)    VALUE SPACES.   04540069
013381     05  DL03-SCAC                  PIC  X(04).                   04550002
013382     05  FILLER                     PIC  X(02)    VALUE SPACES.   04560099
013383     05  DL03-CARTONS-9             PIC ZZZZZZZZ9.                04570043
013384     05  DL03-CARTONS-X REDEFINES DL03-CARTONS-9                  04570144
013385                                    PIC XXXXXXXXX.                04571043
013374     05  FILLER                     PIC  X(03)    VALUE SPACES.   04572076
013375     05  DL03-UNITS-9               PIC  ZZZZZZZZ9.               04573076
013376     05  DL03-UNITS-X   REDEFINES DL03-UNITS-9                    04574076
013377                                    PIC  XXXXXXXXX.               04575076
013386     05  FILLER                     PIC  X(03)    VALUE SPACES.   04580081
013387     05  DL03-CBMS-9                PIC ZZZZZZ9.99.               04590044
013388     05  DL03-CBMS-X  REDEFINES DL03-CBMS-9                       04590143
013389                                    PIC XXXXXXXXXX.               04591044
013390     05  FILLER                     PIC  X(02)    VALUE SPACES.   04600091
013391     05  DL03-KGRMS-9               PIC ZZZZZZZZ9.                04610044
013392     05  DL03-KGRMS-X REDEFINES DL03-KGRMS-9                      04611043
013393                                    PIC XXXXXXXXX.                04612043
013394     05  FILLER                     PIC  X(01)    VALUE SPACES.   04620081
013395*                                                                 04740002
013396 01  DL-DETAIL-LINE-4.                                            04750002
013397     05  FILLER                     PIC  X(09)    VALUE SPACES.   04760087
013398     05  DL04-RECD-TYPE             PIC  X(06)    VALUE SPACES.   04770002
013399     05  FILLER                     PIC  X(03)    VALUE SPACES.   04780002
013400     05  DL04-TRN-TYPE              PIC  X(01)    VALUE SPACES.   04790002
013401     05  FILLER                     PIC  X(06)    VALUE SPACES.   04800087
013402     05  DL04-VENDOR-STYLE          PIC  X(20)    VALUE SPACES.   04810002
013403     05  FILLER                     PIC  X(23)    VALUE SPACES.   04820081
013404     05  DL04-CARTONS-9             PIC ZZZZZZZZ9.                04830050
013405     05  DL04-CARTONS-X REDEFINES DL04-CARTONS-9                  04831045
013406                                    PIC XXXXXXXXX.                04832045
013407     05  FILLER                     PIC  X(03)    VALUE SPACES.   04840081
013408     05  DL04-UNITS-9               PIC ZZZZZZZZ9.                04850047
013409     05  DL04-UNITS-X   REDEFINES DL04-UNITS-9                    04851045
013410                                    PIC XXXXXXXXX.                04852045
013411     05  FILLER                     PIC  X(01)    VALUE SPACES.   04860081
013412     05  DL04-CBMS-9                PIC ZZZZZZZZ9.99.             04870086
013413     05  DL04-CBMS-X    REDEFINES DL04-CBMS-9                     04871047
013414                                    PIC XXXXXXXXXXXX.             04872086
013415     05  FILLER                     PIC  X(02)    VALUE SPACES.   04880091
013416     05  DL04-KGRMS-9               PIC ZZZZZZZZ9.                04890047
013417     05  DL04-KGRMS-X   REDEFINES DL04-KGRMS-9                    04891045
013418                                    PIC XXXXXXXXX.                04892049
013419     05  FILLER                     PIC  X(02)    VALUE SPACES.   04900002
013420*                                                                 04910002
013421*                                                                 05020002
013422 01  DL-DETAIL-LINE-5.                                            05030002
013423     05  FILLER                     PIC  X(17)    VALUE SPACES.   05040098
013424     05  DL05-RECD-TYPE             PIC  X(06)    VALUE SPACES.   05050002
013425     05  FILLER                     PIC  X(03)    VALUE SPACES.   05060002
013426     05  DL05-TRN-TYPE              PIC  X(01)    VALUE SPACES.   05070002
013427     05  FILLER                     PIC  X(04)    VALUE SPACES.   05080098
013428     05  DL05-VENDOR-STYLE          PIC  X(20).                   05090002
013429     05  FILLER                     PIC  X(01)    VALUE SPACES.   05100002
013430     05  DL05-UPC                   PIC  999999999999999.         05110002
013431     05  FILLER                     PIC  X(01)    VALUE SPACES.   05120002
013432     05  DL05-CARTON-9              PIC ZZZZZZZZ9.                05130055
013433     05  DL05-CARTON-X  REDEFINES DL05-CARTON-9                   05131055
013434                                    PIC XXXXXXXXX.                05132055
013435     05  FILLER                     PIC  X(03)    VALUE SPACES.   05140081
013436     05  DL05-UNITS-9               PIC ZZZZZZZZ9.                05150055
013437     05  DL05-UNITS-X   REDEFINES DL05-UNITS-9                    05151055
013438                                    PIC XXXXXXXXX.                05152055
013439     05  FILLER                     PIC  X(03)    VALUE SPACES.   05160081
013440     05  DL05-CBMS-9                PIC ZZZZZZ9.99.               05170055
013441     05  DL05-CBMS-X    REDEFINES DL05-CBMS-9                     05171055
013442                                    PIC XXXXXXXXXX.               05172055
013443     05  FILLER                     PIC  X(02)    VALUE SPACES.   05180091
013444     05  DL05-KGRMS-9               PIC ZZZZZZZZ9.                05190053
013445     05  DL05-KGRMS-X REDEFINES DL05-KGRMS-9                      05191051
013446                                    PIC XXXXXXXXX.                05192051
013447     05  FILLER                     PIC  X(02)    VALUE SPACES.   05200002
013448*                                                                 05320002
013449 01  DL-DETAIL-LINE-6-A.                                          05330002
013450     05  DL06-A-RECD-TYPE           PIC  X(06)    VALUE SPACES.   05340002
013451     05  FILLER                     PIC  X(03)    VALUE SPACES.   05350002
013452     05  DL06-A-TRN-TYPE            PIC  X(01)    VALUE SPACES.   05360002
013453     05  FILLER                     PIC  X(04)    VALUE SPACES.   05370083
013454     05  DL06-A-VSL-TYPE            PIC  X(01)    VALUE SPACES.   05380002
013455     05  FILLER                     PIC  X(04)    VALUE SPACES.   05390002
013456     05  DL06-A-VOYAGE-NBR          PIC  X(10)    VALUE SPACES.   05400002
013457     05  FILLER                     PIC  X(01)    VALUE SPACES.   05410002
013458     05  DL06-A-SCAC                PIC  X(04)    VALUE SPACES.   05420002
013459     05  FILLER                     PIC  X(03)    VALUE SPACES.   05430002
013460     05  DL06-A-VESSEL-NAME         PIC  X(25)    VALUE SPACES.   05440083
013507     05  FILLER                     PIC  X(06)    VALUE SPACES.   05440174
013508     05  DL06-A-POL                 PIC  X(05)    VALUE SPACES.   05440274
013500     05  FILLER                     PIC  X(03)    VALUE SPACES.   05440374
013501     05  DL06-A-ETD-DTE.                                          05440495
013502         10  DL06-A-ETD-DTE-MM      PIC  X(02)    VALUE SPACES.   05440595
013503         10  DL06-A-ETD-SLASH-1     PIC  X(01)    VALUE '/'.      05440695
013504         10  DL06-A-ETD-DTE-DD      PIC  X(02)    VALUE SPACES.   05440795
013505         10  DL06-A-ETD-SLASH-2     PIC  X(01)    VALUE '/'.      05440895
013506         10  DL06-A-ETD-DTE-YY      PIC  X(04)    VALUE SPACES.   05440995
013509     05  FILLER                     PIC  X(01)    VALUE SPACES.   05441074
013510     05  DL06-A-POE                 PIC  X(04)    VALUE SPACES.   05450074
013493     05  FILLER                     PIC  X(01)    VALUE SPACES.   05450174
013494     05  DL06-A-ETA-DTE.                                          05450274
013495         10  DL06-A-ETA-DTE-MM      PIC  X(02)    VALUE SPACES.   05450374
013496         10  DL06-A-ETA-SLASH-1     PIC  X(01)    VALUE '/'.      05450494
013497         10  DL06-A-ETA-DTE-DD      PIC  X(02)    VALUE SPACES.   05450574
013498         10  DL06-A-ETA-SLASH-2     PIC  X(01)    VALUE '/'.      05450694
013499         10  DL06-A-ETA-DTE-YY      PIC  X(04)    VALUE SPACES.   05450774
013509     05  FILLER                     PIC  X(01)    VALUE SPACES.   05450874
013510     05  DL06-A-EST-LBD-DEST        PIC  X(18)    VALUE SPACES.   05450974
013509     05  FILLER                     PIC  X(01)    VALUE SPACES.   05451074
013510     05  DL06-A-EST-LBD.                                          05451174
013527         10  DL06-A-EST-DTE-MM      PIC  X(02)    VALUE SPACES.   05451274
013528         10  DL06-A-EST-SLASH-1     PIC  X(01)    VALUE '/'.      05451394
013529         10  DL06-A-EST-DTE-DD      PIC  X(02)    VALUE SPACES.   05451474
013530         10  DL06-A-EST-SLASH-2     PIC  X(01)    VALUE '/'.      05451594
013531         10  DL06-A-EST-DTE-YY      PIC  X(04)    VALUE SPACES.   05452074
013511     05  FILLER                     PIC  X(02)    VALUE SPACES.   05460074
013480*                                                                 05640002
013512*                                                                 06070002
013513 01  DL-DETAIL-LINE-7.                                            06080002
013514     05  DL07-A-RECD-TYPE           PIC  X(06)    VALUE SPACES.   06090002
013515     05  FILLER                     PIC  X(04)    VALUE SPACES.   06100002
013516     05  DL07-A-TRN-TYPE            PIC  X(01)    VALUE SPACES.   06110002
013517     05  FILLER                     PIC  X(04)    VALUE SPACES.   06120002
013518     05  DL07-A-VOYAGE-NBR          PIC  X(10)    VALUE SPACES.   06130002
013519     05  FILLER                     PIC  X(02)    VALUE SPACES.   06140002
013520     05  DL07-A-SCAC                PIC  X(04)    VALUE SPACES.   06150002
013521     05  FILLER                     PIC  X(02)    VALUE SPACES.   06160002
013522     05  DL07-A-ETA-DTE.                                          06170002
013523         10  DL07-A-ETA-DTE-MM      PIC  X(02)    VALUE SPACES.   06180002
013524         10  DL07-A-ETA-SLASH-1     PIC  X(01)    VALUE '/'.      06190094
013525         10  DL07-A-ETA-DTE-DD      PIC  X(02)    VALUE SPACES.   06200002
013526         10  DL07-A-ETA-SLASH-2     PIC  X(01)    VALUE '/'.      06210094
013527         10  DL07-A-ETA-DTE-YY      PIC  X(04)    VALUE SPACES.   06220002
013528     05  FILLER                     PIC  X(02)    VALUE SPACES.   06230002
013529     05  DL07-A-ETD-DTE.                                          06240095
013530         10  DL07-A-ETD-DTE-MM      PIC  X(02)    VALUE SPACES.   06250095
013531         10  DL07-A-ETD-SLASH-1     PIC  X(01)    VALUE '/'.      06260095
013532         10  DL07-A-ETD-DTE-DD      PIC  X(02)    VALUE SPACES.   06270095
013533         10  DL07-A-ETD-SLASH-2     PIC  X(01)    VALUE '/'.      06280095
013534         10  DL07-A-ETD-DTE-YY      PIC  X(04)    VALUE SPACES.   06290095
013535     05  FILLER                     PIC  X(01)    VALUE SPACES.   06300002
013536     05  DL07-A-VOYAGE-CHANGE       PIC  X(30)    VALUE SPACES.   06310002
013537     05  FILLER                     PIC  X(01)    VALUE SPACES.   06320002
013592*                                                                 06320199
008306 01  TRL-HEADING-LINE-1.                                          06320299
008320     05  FILLER                      PIC  X(45)      VALUE        06320399
008321         'A = ADD, B/Z = CHANGE, C = CHANGE, D = DELETE'.         06320499
008325     05  FILLER                      PIC  X(01)      VALUE SPACE. 06320599
008326     05  FILLER                      PIC  X(20)      VALUE        06320699
008327         'E = CHANGE TO DELETE'.                                  06320799
008328     05  FILLER                      PIC  X(14)      VALUE SPACE. 06321099
013538*                                                                 06440002
013539 01  ER-END-OF-REPORT-LINE.                                       06450002
013540     05  FILLER                     PIC  X(54)    VALUE SPACE.    06460002
013541     05  FILLER                     PIC  X(25)    VALUE           06470002
013542         '***** END OF REPORT *****'.                             06480002
013543     05  FILLER                     PIC  X(53)    VALUE SPACE.    06490002
013544*                                                                 06500002
013545 01  EP-EMPTY-REPORT-LINE.                                        06510002
013546     05  FILLER                     PIC  X(25)    VALUE           06520002
013547         '******* NO DATA *********'.                             06530002
013548     05  FILLER                     PIC  X(87)    VALUE SPACE.    06540002
013549*                                                                 06550002
013550 01  PS-PROGRAM-SWITCHES.                                         06560002
013560     05  PS-EOF-ERROR-FILE-SW       PIC  X(01)    VALUE SPACE.    06570002
013600         88  PS-EOF-ERROR-FILE                    VALUE 'Y'.      06580002
014201     05  PS-NEW-PAGE-SW             PIC  X(01)    VALUE SPACE.    06590002
014202         88  PS-NEW-PAGE                          VALUE 'Y'.      06600002
014203         88  PS-NOT-NEW-PAGE                      VALUE 'N'.      06610002
014204     05  PS-NEW-PO-SW               PIC  X(01)    VALUE SPACE.    06620002
014205         88  PS-NEW-PO                            VALUE 'Y'.      06630002
014206         88  PS-NOT-NEW-PO                        VALUE 'N'.      06640002
014270     05  PS-EDD-SW                  PIC  X(01)    VALUE SPACE.    06641032
014280         88  PS-EDD-YES                           VALUE 'Y'.      06642032
014290         88  PS-EDD-NO                            VALUE 'N'.      06643032
014291     05  PS-EDL-SW                  PIC  X(01)    VALUE SPACE.    06650002
014292         88  PS-EDL-YES                           VALUE 'Y'.      06660002
014293         88  PS-EDL-NO                            VALUE 'N'.      06670002
014294     05  PS-EDLVS-SW                PIC  X(01)    VALUE SPACE.    06680002
014295         88  PS-EDLVS-YES                         VALUE 'Y'.      06690002
014296         88  PS-EDLVS-NO                          VALUE 'N'.      06700002
014297     05  PS-EDLUPC-SW               PIC  X(01)    VALUE SPACE.    06710002
014298         88  PS-EDLUPC-YES                        VALUE 'Y'.      06720002
014299         88  PS-EDLUPC-NO                         VALUE 'N'.      06730002
014300     05  PS-EDDRSN-SW               PIC  X(01)    VALUE SPACE.    06770002
014301         88  PS-EDDRSN-YES                        VALUE 'Y'.      06780002
014302         88  PS-EDDRSN-NO                         VALUE 'N'.      06790002
014303*                                                                 07010002
014400*                                                                 07020002
014500 01 PC-PROGRAM-CONSTANTS.                                         07030002
014600     05  PC-PAGE-SIZE-055           PIC S9(04)    VALUE +055      07040002
014700                                                  COMP SYNC.      07050002
014701     05  PC-PAGE-SIZE-060           PIC S9(04)    VALUE +060      07060002
014702                                                  COMP SYNC.      07070002
014800     05  PC-HEADING-SIZE            PIC S9(04)    VALUE +006      07080099
014900                                                  COMP SYNC.      07090002
015000     05  PC-MAX-RETRIES             PIC S9(04)    VALUE +3        07100002
015100                                                  COMP SYNC.      07110002
015200     05  PC-MAX-TABLE-ENTRIES       PIC S9(04)    VALUE +20       07120002
015300                                                  COMP SYNC.      07130002
015600     05  PC-CURRENT-PROGRAM-NAME    PIC  X(08)    VALUE           07140002
015700         'TRKRP202'.                                              07150002
015800     05  PC-A                       PIC  X(01)    VALUE 'A'.      07160002
015900     05  PC-01                      PIC  X(02)    VALUE '01'.     07170002
016300*                                                                 07180002
016400 01  V-PROGRAM-VARIABLES.                                         07190028
016500     05  PV-LINES-USED              PIC S9(04)    VALUE ZERO      07200002
016600                                                  COMP SYNC.      07210002
016700     05  PV-DELY-DTE-PREV           PIC  X(08)    VALUE SPACES.   07211027
016800     05  PV-SHPD-FR-CDE-PREV        PIC  X(03)    VALUE SPACES.   07211165
016900     05  PV-TRN-TYPE-PREV           PIC  X(01)    VALUE SPACES.   07212028
016901     05  PV-REC-TYP-CDE-PREV        PIC  X(06)    VALUE SPACES.   07220002
016902         88 PV-EDL-REC-TYP-CDE-EDL       VALUE 'EDL  '.           07230002
016903         88 PV-EDLVS-REC-TYP-CDE-EDLVS   VALUE 'EDLVS '.          07240002
016904         88 PV-EDLUPC-REC-TYP-CDE-EDLUPC VALUE 'EDLUPC'.          07250002
016905         88 PV-EDD-REC-TYP-CDE-EDD       VALUE 'EDD  '.           07260002
016906         88 PV-EDDRSN-REC-TYP-CD-EDDRSN  VALUE 'EDDRSN'.          07270002
016907     05  PV-PO-NBR                  PIC  9(09)    VALUE ZERO.     07280002
016908     05  PV-CONTAINER-NBR           PIC  X(12)    VALUE SPACES.   07290002
016909     05  PV-EXTL-REF-NBR            PIC  X(15)    VALUE SPACES.   07300002
016910     05  PV-BLANK-LINE              PIC  X(132)   VALUE SPACES.   07310002
016920     05  PV-NO-OF-POS-IN-ERROR      PIC  S9(06)   VALUE ZEROES.   07320002
017100     05  PV-PAGE-COUNT              PIC  9(05)    VALUE ZERO.     07330002
020200*                                                                 07340002
020300 01  SD-SYSTEM-DATE.                                              07350002
020400     05  SD-SYSTEM-DATE-YY          PIC  9(02)      VALUE ZERO.   07360002
020500     05  SD-SYSTEM-DATE-MM          PIC  9(02)      VALUE ZERO.   07370002
020600     05  SD-SYSTEM-DATE-DD          PIC  9(02)      VALUE ZERO.   07380002
020800*                                                                 07390002
020900 01  ST-SYSTEM-TIME.                                              07400002
021000     05  ST-SYSTEM-HOUR             PIC  9(02)      VALUE ZERO.   07410002
021100     05  ST-SYSTEM-MINUTE           PIC  9(02)      VALUE ZERO.   07420002
021200     05  FILLER                     PIC  9(04)      VALUE ZERO.   07430002
021300*----------------------------------------------------------------*07440002
033200*  COMMUNICATION AREAS FOR DB2                                    07450002
033300*----------------------------------------------------------------*07460002
033400     EXEC SQL                                                     07470002
033500         INCLUDE SQLCA                                            07480002
033600     END-EXEC.                                                    07490002
033800*----------------------------------------------------------------*07500002
033900*  DB2 COMMUNICATION AREA 2                                       07510002
034000*----------------------------------------------------------------*07520002
034100     COPY SQLCA2.                                                 07530099
034101*                                                                 07540002
034102******************************************************************07550002
034103 PROCEDURE DIVISION.                                              07560002
034104******************************************************************07570002
034105*                                                                 07580002
034106*----------------------------------------------------------------*07590002
034107* 0000-PROGRAM-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE     07600002
034108*      PROGRAM.                                                   07610002
034109*----------------------------------------------------------------*07620002
034110 0000-PROGRAM-MAINLINE.                                           07630002
034120                                                                  07640002
034130     PERFORM 1000-INITIALIZE.                                     07650002
034140*                                                                 07660002
034141     PERFORM 2000-PROCESS-REPORT-DATA                             07670002
034142       UNTIL PS-EOF-ERROR-FILE.                                   07680002
034143*                                                                 07681002
034144     PERFORM 9000-EOJ-ROUTINE.                                    07690002
034145*                                                                 07700002
034146     STOP RUN.                                                    07710002
034147*                                                                 07720002
034148*0000-EXIT.                                                       07730002
034149*                                                                 07740002
034150******************************************************************07750002
034151*  DO FIRST TIME PROGRAM INITIALIZATION TASKS.                    07760002
034152*    -- OPEN FILES                                                07770002
034153*    -- SET UP AND PRINT REPORT HEADINGS                          07780002
034154******************************************************************07790002
034155 1000-INITIALIZE.                                                 07800002
034156                                                                  07810002
034157     OPEN INPUT  ERROR-FILE                                       07820002
034158          OUTPUT ERROR-REPORT-FILE.                               07830002
034159*                                                                 07840002
034160     ACCEPT SD-SYSTEM-DATE FROM DATE.                             07850002
034161     ACCEPT ST-SYSTEM-TIME FROM TIME.                             07860002
034162     MOVE SD-SYSTEM-DATE-YY      TO DP132O-RUN-YEAR.              07870002
034163     MOVE SD-SYSTEM-DATE-MM      TO DP132O-RUN-MONTH.             07880002
034164     MOVE SD-SYSTEM-DATE-DD      TO DP132O-RUN-DAY.               07890002
034165     MOVE ST-SYSTEM-HOUR         TO DP132O-RUN-HOUR.              07900002
034166     MOVE ST-SYSTEM-MINUTE       TO DP132O-RUN-MINUTE.            07910002
034167     MOVE PC-CURRENT-PROGRAM-NAME                                 07920002
034168                                 TO DP132O-PROGRAM-NAME.          07930002
034169     MOVE 1                      TO DP132O-REPORT-NUMBER.         07940002
034170     INITIALIZE     PS-EDD-SW                                     07960032
034180                    PS-EDL-SW                                     07961032
034190                    PS-EDLVS-SW                                   07962032
034200                    PS-EDLUPC-SW                                  07963032
034300                    PS-EDDRSN-SW                                  07970032
034301                    PS-NEW-PAGE-SW.                               08040002
034302*                                                                 08050002
034303     PERFORM 7000-READ-ERROR-FILE UNTIL                           08060002
034304             PS-EOF-ERROR-FILE OR                                 08070002
034305            (TR201-RPT-TYP-DETAIL AND                             08080004
034306             NOT TR201-REC-TYP-HDR-CDE-HDR)                       08090002
034307*                                                                 08100002
034500     IF NOT PS-EOF-ERROR-FILE                                     08110002
034600                                                                  08110152
034700         IF TR201-PO-NBR NUMERIC                                  08110252
034800            MOVE TR201-PO-NBR        TO DL02-PO-NBR-9             08110353
034900         ELSE                                                     08110452
035000            MOVE TR201-PO-NBR-X      TO DL02-PO-NBR-X             08110553
035100         END-IF                                                   08110652
035200                                                                  08110752
035300         MOVE TR201-PO-NBR    TO     PV-PO-NBR                    08112052
035400         MOVE TR201-EXTL-REF-NBR TO PV-EXTL-REF-NBR               08120052
035500                                     DL02-REFERENCE-NBR           08130052
035600                                                                  08140002
035700         MOVE TR201-PO-BKG-DELY-DTE (5:2) TO                      08150002
035800                                     PV-DELY-DTE-PREV (5:2)       08151027
035900                                     DL02-EST-DEL-MON             08160002
036000         MOVE TR201-PO-BKG-DELY-DTE (7:2) TO                      08170002
036100                                     PV-DELY-DTE-PREV (7:2)       08171027
036200                                     DL02-EST-DEL-DAY             08180002
036300         MOVE TR201-PO-BKG-DELY-DTE (1:4) TO                      08190002
036400                                     PV-DELY-DTE-PREV (1:4)       08191027
036500                                     DL02-EST-DEL-YEAR            08200002
036600                                                                  08200428
036700         MOVE TR201-TRN-TYP       TO PV-TRN-TYPE-PREV             08201028
036800                                                                  08201164
036900         MOVE TR201-ORGN-SHPD-FR-CDE TO                           08201264
037000                                  PV-SHPD-FR-CDE-PREV             08202064
037100                                  DL02-SHPD-FR-CDE                08203065
037200                                                                  08210002
037300       IF TR201-PO-BKG-DELY-DTE (1:4) = '0001' OR                 08220002
037400         TR201-PO-BKG-DELY-DTE (1:4) = SPACES                     08230002
037500            MOVE SPACES TO DL02-EST-SLASH-1                       08240002
037600                           DL02-EST-SLASH-2                       08250002
037700                           DL02-EST-DEL-MON                       08260002
037800                           DL02-EST-DEL-DAY                       08270002
037900                           DL02-EST-DEL-YEAR                      08280002
038000       ELSE                                                       08290002
038100            MOVE '/'    TO DL02-EST-SLASH-1                       08300002
038200                           DL02-EST-SLASH-2                       08310002
038201       END-IF                                                     08320002
038202*                                                                 08330002
038203        IF TR201-ERROR-TYPE NOT = 'EMT' AND                       08340002
038204           TR201-ERROR-TYPE NOT = 'IEA' OR                        08350093
037904           TR201-ERROR-TYPE = '   '                               08351093
038205             PERFORM  8000-WRITE-PAGE-HEADINGS                    08360002
038206        END-IF                                                    08370002
038207*                                                                 08380002
038208     ELSE                                                         08390099
038205          PERFORM  8000-WRITE-PAGE-HEADINGS                       08390199
038208     END-IF                                                       08391099
038240*                                                                 08440002
038250     IF PS-EOF-ERROR-FILE OR                                      08450002
038260        TR201-ERROR-TYPE = 'EMT' OR                               08460002
038270        TR201-ERROR-TYPE = 'IEA'                                  08470002
038280        PERFORM 9100-EOJ-ROUTINE                                  08480002
038290        STOP RUN                                                  08490002
           ELSE                                                         08491099
038220        PERFORM 2025-BUILD-ERROR-RPT-DATA                         08492099
038291     END-IF.                                                      08500002
038292*                                                                 08510002
038293*1000-EXIT.                                                       08520002
038294*                                                                 08530002
038295* **************************************************************  08540002
038296*  PROCESSING FOR ERROR RECORDS.                                  08550002
038297******************************************************************08560002
038298 2000-PROCESS-REPORT-DATA.                                        08570002
038299                                                                  08580002
038300     MOVE SPACES TO TR201-RPT-TYP                                 08590002
038400*                                                                 08600002
038500     PERFORM 7000-READ-ERROR-FILE UNTIL                           08610002
038600             PS-EOF-ERROR-FILE OR                                 08620002
038700            (TR201-RPT-TYP-DETAIL AND                             08620104
038800             NOT TR201-REC-TYP-HDR-CDE-HDR)                       08622002
038900*                                                                 08630002
039000     IF TR201-RPT-TYP-DETAIL                                      08640004
039100        PERFORM 2025-BUILD-ERROR-RPT-DATA                         08650002
039200     END-IF.                                                      08660002
039300*                                                                 08670002
039400******************************************************************08680002
039500*  BUILD THE LINES FOR THE REPORT.                                08690002
039600******************************************************************08700002
039700 2025-BUILD-ERROR-RPT-DATA.                                       08710002
039800                                                                  08720002
043115     IF TR201-REC-TYP-EDD-CDE-EDD                                 08730002
043116         PERFORM 3250-MOVE-EDD-TO-DETAIL                          08740002
043117     END-IF.                                                      08750002
043118                                                                  08760002
043119     IF TR201-REC-TYP-EDDRSN-CD-EDDRSN                            08770002
043120         PERFORM 3300-MOVE-EDDRSN-TO-DETAIL                       08780002
043130     END-IF.                                                      08790002
043131                                                                  08800002
043132     IF TR201-REC-TYP-EDL-CDE-EDL                                 08810002
043133         PERFORM 3100-MOVE-EDL-TO-DETAIL                          08820002
043134     END-IF.                                                      08830002
043135                                                                  08840002
043136     IF TR201-REC-TYP-EDLVS-CDE-EDLVS                             08850002
043137         PERFORM 3150-MOVE-EDLVS-TO-DETAIL                        08860002
043138     END-IF.                                                      08870002
043139                                                                  08880002
043140     IF TR201-REC-TYP-EDLUPC-CD-EDLUPC                            08890002
043141         PERFORM 3200-MOVE-EDLUPC-TO-DETAIL                       08900002
043142     END-IF.                                                      08910002
043143                                                                  08920002
043144     PERFORM 2050-CHECK-FOR-PREVIOUS.                             08930002
043145     PERFORM 8100-WRITE-ERROR-RPT-DETAIL.                         08940002
043146*                                                                 08940156
043147     IF NOT TR201-REC-TYP-EDD-CDE-EDD AND                         08940259
043148        NOT TR201-REC-TYP-EDL-CDE-EDL AND                         08940359
043149        NOT TR201-REC-TYP-EDLUPC-CD-EDLUPC AND                    08940461
043150        NOT TR201-REC-TYP-EDDRSN-CD-EDDRSN                        08940562
043151         PERFORM 3650-MOVE-ERROR-TO-DETAIL                        08940656
043152     END-IF.                                                      08941056
043153*                                                                 08950002
043154*2000-EXIT.                                                       08960002
043155*                                                                 08970002
043156* **************************************************************  08980002
043157*  CHECKS TO SEE IF THERE IS A BREAK, IF THERE IS NOT             08990002
043158*  DATA IS NOT REPEATED FOR CONTAINER-NO AND REFERNCE-NO          09000002
043159* *************************************************************** 09010002
043160 2050-CHECK-FOR-PREVIOUS.                                         09020002
043170                                                                  09030007
043180     IF  TR201-EXTL-REF-NBR = PV-EXTL-REF-NBR AND                 09040005
043190         TR201-PO-NBR = PV-PO-NBR AND                             09041007
043200         TR201-PO-BKG-DELY-DTE (5:2) = PV-DELY-DTE-PREV (5:2) AND 09044027
043300         TR201-PO-BKG-DELY-DTE (7:2) = PV-DELY-DTE-PREV (7:2) AND 09046027
043400         TR201-PO-BKG-DELY-DTE (1:4) = PV-DELY-DTE-PREV (1:4) AND 09048027
043500         TR201-TRN-TYP               = PV-TRN-TYPE-PREV AND       09049128
043600         TR201-ORGN-SHPD-FR-CDE      = PV-SHPD-FR-CDE-PREV AND    09049264
043700        (TR201-REC-TYP-EDD-CDE-EDD OR                             09050005
043800         TR201-REC-TYP-EDDRSN-CD-EDDRSN OR                        09060005
043900         TR201-REC-TYP-EDL-CDE-EDL OR                             09070005
044000         TR201-REC-TYP-EDLVS-CDE-EDLVS OR                         09080005
044100         TR201-REC-TYP-EDLUPC-CD-EDLUPC)                          09090005
044200         CONTINUE                                                 09100005
044300     ELSE                                                         09110005
044400                                                                  09110152
044500         IF TR201-PO-NBR NUMERIC                                  09110252
044600            MOVE TR201-PO-NBR        TO DL02-PO-NBR-9             09110353
044700         ELSE                                                     09110452
044800            MOVE TR201-PO-NBR-X      TO DL02-PO-NBR-X             09110553
044900         END-IF                                                   09110652
045000                                                                  09111052
045100         MOVE TR201-PO-NBR    TO     PV-PO-NBR                    09112052
045200         MOVE TR201-EXTL-REF-NBR TO PV-EXTL-REF-NBR               09120005
045300                                    DL02-REFERENCE-NBR            09130005
045400                                                                  09140002
045500         MOVE TR201-PO-BKG-DELY-DTE (5:2) TO                      09150002
045600                                     PV-DELY-DTE-PREV (5:2)       09151027
045700                                     DL02-EST-DEL-MON             09160002
045800         MOVE TR201-PO-BKG-DELY-DTE (7:2) TO                      09170002
045900                                     PV-DELY-DTE-PREV (7:2)       09181027
046000                                     DL02-EST-DEL-DAY             09181127
046100         MOVE TR201-PO-BKG-DELY-DTE (1:4) TO                      09190002
046200                                     PV-DELY-DTE-PREV (1:4)       09191027
046300                                     DL02-EST-DEL-YEAR            09200002
046400                                                                  09201028
046500         MOVE TR201-TRN-TYP          TO PV-TRN-TYPE-PREV          09210064
046600                                                                  09210164
046700         MOVE TR201-ORGN-SHPD-FR-CDE TO                           09210264
046800                                     PV-SHPD-FR-CDE-PREV          09210364
046900                                     DL02-SHPD-FR-CDE             09210465
047000                                                                  09211002
047100       IF TR201-PO-BKG-DELY-DTE (1:4) = '0001' OR                 09212002
047200         TR201-PO-BKG-DELY-DTE (1:4) = SPACES                     09213002
047300            MOVE SPACES TO DL02-EST-SLASH-1                       09214002
047400                           DL02-EST-SLASH-2                       09215002
047500                           DL02-EST-DEL-MON                       09216002
047600                           DL02-EST-DEL-DAY                       09217002
047700                           DL02-EST-DEL-YEAR                      09218002
047800       ELSE                                                       09219002
047900            MOVE '/'    TO DL02-EST-SLASH-1                       09219102
048000                           DL02-EST-SLASH-2                       09219202
048100       END-IF                                                     09219302
048200                                                                  09219439
048300         INITIALIZE     PS-EDD-SW                                 09219539
048400                        PS-EDL-SW                                 09219639
048500                        PS-EDLVS-SW                               09219739
048600                        PS-EDLUPC-SW                              09219839
048700                        PS-EDDRSN-SW                              09219939
048800         SET PS-NEW-PO           TO TRUE                          09330035
048900         SET PS-NEW-PAGE  TO TRUE                                 09331035
049000         PERFORM  8000-WRITE-PAGE-HEADINGS                        09340035
049100     END-IF.                                                      09350035
049200*                                                                 09360035
049300     IF PV-LINES-USED >= PC-PAGE-SIZE-060                         09370035
049301        SET PS-NEW-PAGE  TO TRUE                                  09380035
049302        SET PS-EDD-NO TO TRUE                                     09381022
049303        SET PS-EDL-NO TO TRUE                                     09390002
049304        SET PS-EDLVS-NO TO TRUE                                   09400002
049305        SET PS-EDLUPC-NO TO TRUE                                  09410002
049306        SET PS-EDDRSN-NO TO TRUE                                  09430002
049307        PERFORM 8000-WRITE-PAGE-HEADINGS                          09440002
049308     END-IF.                                                      09450002
049309                                                                  09460002
049310                                                                  09470002
049311                                                                  09480002
049312******************************************************************09490002
049313* SELECT VENDOR NAME FROM TPURCHS.                                09500002
049314******************************************************************09510002
049400                                                                  09520002
049401 2060-SELECT-VENDOR-NAME.                                         09530002
049402                                                                  09540002
049403     MOVE TR201-PO-NBR         TO  PURCHS-PO-NBR.                 09550002
049404     MOVE PC-A                 TO  PURCHS-VER-STATUS-CDE.         09560002
049405                                                                  09570002
049600     EXEC SQL                                                     09580002
049700           SELECT DISTINCT                                        09590002
049800                  A.ENT_NAME_DESC                                 09600002
050300           INTO   :ENTNME-ENT-NAME-DESC                           09610002
050800           FROM   TENTNME A,                                      09620002
050900                  TPURCHS B                                       09630002
051000           WHERE  B.PO_NBR       = :PURCHS-PO-NBR                 09640002
051100           AND    A.ENT_ID       = B.ENT_ID                       09650002
051200           AND    VER_STATUS_CDE = :PURCHS-VER-STATUS-CDE         09660002
051300           AND    A.TYPE_CDE    = :PC-01                          09670002
051400                                                                  09680002
051900     END-EXEC.                                                    09690002
052000                                                                  09700002
052100     EVALUATE TRUE                                                09710002
052200         WHEN SQLCODE = 0                                         09720002
052300             MOVE ENTNME-ENT-NAME-DESC   TO DL02-VENDOR-NAME      09730002
052400         WHEN SQLCODE = +100                                      09740002
052500             MOVE SPACES                 TO DL02-VENDOR-NAME      09750002
053000         WHEN SQLCODE = -904                                      09760002
053100         WHEN SQLCODE = -911                                      09770002
053200             MOVE SPACES                 TO DL02-VENDOR-NAME      09780002
053300             CONTINUE                                             09790002
054600     END-EVALUATE.                                                09800002
054700*                                                                 09810074
208800******************************************************************09840074
208900* CHECKS TO SEE IF THE POE-CDE ON MAINFRAME IS VALID (ACTIVE).   *09850074
208910* ALSO, CHECKS THE LANDBRIGDE NAME.                              *09860074
209000******************************************************************09870074
209100 3010-EDIT-POE-LBD.                                               09880074
209200                                                                  09890074
013527     MOVE SPACES TO               DL06-A-EST-DTE-MM               09900074
013529                                  DL06-A-EST-DTE-DD               09910074
013531                                  DL06-A-EST-DTE-YY               09920074
013527     MOVE SPACES TO               DL06-A-EST-SLASH-1              09920194
                                        DL06-A-EST-SLASH-2              09920294
209200                                                                  09930074
209210     IF TR201-EDD-DEST-POE-CDE = SPACES  AND                      09940074
209220        TR201-EDD-EST-LBD-NM   = SPACES                           09950074
210420         CONTINUE                                                 09960074
210600     ELSE                                                         09970074
210610         IF TR201-EDD-EST-LBD-NM = SPACES                         09980074
210620             PERFORM 3015-POE-CHECK                               09990074
210621         ELSE                                                     10000074
210622             IF TR201-EDD-DEST-POE-CDE = SPACES                   10010074
                        MOVE TR201-EDD-POE-DELY-DTE (1:4)  TO           10020074
                              DL06-A-EST-DTE-YY                         10030074
                        MOVE TR201-EDD-POE-DELY-DTE (5:2)  TO           10040074
                              DL06-A-EST-DTE-MM                         10050074
                        MOVE TR201-EDD-POE-DELY-DTE (7:2)  TO           10060074
                              DL06-A-EST-DTE-DD                         10070074
                                                                        10074092
                     IF TR201-EDD-POE-DELY-DTE(1:4) = '0001' OR         10075092
                       TR201-EDD-POE-DELY-DTE(1:4) = SPACES             10076092
                          MOVE SPACES TO DL06-A-EST-SLASH-1             10077092
                                         DL06-A-EST-SLASH-2             10078092
                                         DL06-A-EST-DTE-MM              10079097
                                         DL06-A-EST-DTE-DD              10079197
                                         DL06-A-EST-DTE-YY              10079297
                     ELSE                                               10079392
                          MOVE '/'    TO DL06-A-EST-SLASH-1             10079492
                                         DL06-A-EST-SLASH-2             10079592
                     END-IF                                             10079692
                   ELSE                                                 10080074
                   IF TR201-EDD-DEST-POE-CDE = SPACES                   10090074
                        MOVE TR201-EDD-POE-DELY-DTE (1:4)  TO           10100074
                              DL06-A-EST-DTE-YY                         10110074
                        MOVE TR201-EDD-POE-DELY-DTE (5:2)  TO           10120074
                              DL06-A-EST-DTE-MM                         10121074
                        MOVE TR201-EDD-POE-DELY-DTE (7:2)  TO           10122074
                              DL06-A-EST-DTE-DD                         10123074
                                                                        10123492
                     IF TR201-EDD-POE-DELY-DTE(1:4) = '0001' OR         10123592
                       TR201-EDD-POE-DELY-DTE(1:4) = SPACES             10123692
                          MOVE SPACES TO DL06-A-EST-SLASH-1             10123792
                                         DL06-A-EST-SLASH-2             10123892
                                         DL06-A-EST-DTE-MM              10123996
                                         DL06-A-EST-DTE-DD              10124096
                                         DL06-A-EST-DTE-YY              10124196
                     ELSE                                               10124292
                          MOVE '/'    TO DL06-A-EST-SLASH-1             10124392
                                         DL06-A-EST-SLASH-2             10124492
                     END-IF                                             10124592
                       PERFORM 3015-POE-CHECK                           10124674
                   END-IF                                               10125074
               END-IF                                                   10126074
           END-IF.                                                      10127074
213300                                                                  10128074
213310******************************************************************10129074
213320* CHECKS TO SEE IF THE POE-CDE ON MAINFRAME IS VALID (ACTIVE).   *10129174
213330* ALSO, CHECKS THE LANDBRIGDE NAME.                              *10129274
213340******************************************************************10129374
213350 3015-POE-CHECK.                                                  10129474
213395                                                                  10129574
068000     IF TR201-EDD-DEST-POE-CDE NOT = SPACES                       10129674
213399         MOVE TR201-EDD-POE-DELY-DTE (1:4)  TO                    10129774
                     DL06-A-EST-DTE-YY                                  10129874
213403         MOVE TR201-EDD-POE-DELY-DTE (5:2)  TO                    10129974
                     DL06-A-EST-DTE-MM                                  10130074
213407         MOVE TR201-EDD-POE-DELY-DTE (7:2)  TO                    10130174
013529               DL06-A-EST-DTE-DD                                  10130274
                                                                        10130692
                   IF TR201-EDD-POE-DELY-DTE(1:4) = '0001' OR           10130792
                     TR201-EDD-POE-DELY-DTE(1:4) = SPACES               10130892
                        MOVE SPACES TO DL06-A-EST-SLASH-1               10130992
                                       DL06-A-EST-SLASH-2               10131092
                                       DL06-A-EST-DTE-MM                10131196
                                       DL06-A-EST-DTE-DD                10131296
                                       DL06-A-EST-DTE-YY                10131396
                   ELSE                                                 10131492
                        MOVE '/'    TO DL06-A-EST-SLASH-1               10131592
                                       DL06-A-EST-SLASH-2               10131692
                  END-IF                                                10131792
213426     ELSE                                                         10131874
213429         MOVE TR201-EDD-POE-DELY-DTE (1:4)  TO                    10131974
                     DL06-A-EST-DTE-YY                                  10132074
213433         MOVE TR201-EDD-POE-DELY-DTE (5:2)  TO                    10132174
                     DL06-A-EST-DTE-MM                                  10132274
213437         MOVE TR201-EDD-POE-DELY-DTE (7:2)  TO                    10132374
013529               DL06-A-EST-DTE-DD                                  10132474
                                                                        10132892
                   IF TR201-EDD-POE-DELY-DTE(1:4) = '0001' OR           10132992
                     TR201-EDD-POE-DELY-DTE(1:4) = SPACES               10133092
                        MOVE SPACES TO DL06-A-EST-SLASH-1               10133192
                                       DL06-A-EST-SLASH-2               10133292
                                       DL06-A-EST-DTE-MM                10133396
                                       DL06-A-EST-DTE-DD                10133496
                                       DL06-A-EST-DTE-YY                10133596
                   ELSE                                                 10133692
                        MOVE '/'    TO DL06-A-EST-SLASH-1               10133792
                                       DL06-A-EST-SLASH-2               10133892
                  END-IF                                                10133992
213466     END-IF.                                                      10134074
054701*                                                                 10135002
054702******************************************************************10140002
054703*MOVE EDL DATA TO REPORT DETAIL LINE                              10150002
054704******************************************************************10160002
054705 3100-MOVE-EDL-TO-DETAIL.                                         10170002
054706                                                                  10180002
054707     MOVE TR201-REC-TYP-EDL-CDE      TO                           10190043
054708                                     PV-REC-TYP-CDE-PREV          10200043
054709                                     DL03-RECD-TYPE.              10210043
054710     MOVE TR201-TRN-TYP              TO                           10220043
054720                                     DL03-TRN-TYPE                10230043
054730     MOVE TR201-EDL-C-O-PROD-CDE     TO                           10240043
054740                                     DL03-PROD-CNTRY-CDE          10250043
054750                                                                  10270146
054760     IF TR201-EDL-PO-UNT-QTY  NUMERIC                             10271046
054770        MOVE TR201-EDL-PO-UNT-QTY    TO DL03-UNITS-9              10272046
054780     ELSE                                                         10273046
054790        MOVE TR201-EDL-PO-UNT-QTY-X  TO DL03-UNITS-X              10274046
054800     END-IF                                                       10275046
054900                                                                  10276046
055000     MOVE TR201-EDL-PROD-FCTRY-NM    TO                           10280043
055100                                     DL03-PROD-FCTRY-CDE          10290043
055200     MOVE TR201-EDL-CONSOL-SCAC-ID   TO                           10320043
055300                                     DL03-SCAC                    10330043
055400                                                                  10330145
055500     IF TR201-EDL-PO-CART-CNT NUMERIC                             10330246
055600        MOVE TR201-EDL-PO-CART-CNT     TO DL03-CARTONS-9          10330350
055700     ELSE                                                         10330445
055800        MOVE TR201-EDL-PO-CART-CNT-X   TO DL03-CARTONS-X          10330550
055900     END-IF                                                       10330645
056000                                                                  10330743
056100     IF TR201-EDL-PO-CBMT-QTY NUMERIC                             10330844
056200        MOVE TR201-EDL-PO-CBMT-QTY     TO DL03-CBMS-9             10330944
056300     ELSE                                                         10331043
056400        MOVE TR201-EDL-PO-CBMT-QTY-X   TO DL03-CBMS-X             10331144
056500     END-IF                                                       10331243
056600                                                                  10331343
056700     IF TR201-EDL-PO-WT-KGRM-QTY NUMERIC                          10331444
056800        MOVE TR201-EDL-PO-WT-KGRM-QTY   TO DL03-KGRMS-9           10331544
056900     ELSE                                                         10331643
057000        MOVE TR201-EDL-PO-WT-KGRM-QTY-X TO DL03-KGRMS-X           10331744
057100     END-IF.                                                      10331848
057101*                                                                 10480002
057102******************************************************************10490002
057103*MOVE EDLVS DATA TO REPORT DETAIL LINE                            10500002
057104******************************************************************10510002
057105 3150-MOVE-EDLVS-TO-DETAIL.                                       10520002
057106                                                                  10530002
057107     MOVE TR201-REC-TYP-EDLVS-CDE    TO                           10540045
057108                                     PV-REC-TYP-CDE-PREV          10550045
057109                                     DL04-RECD-TYPE               10560045
057110     MOVE TR201-TRN-TYP              TO                           10570045
057120                                     DL04-TRN-TYPE                10580045
057130     MOVE TR201-EDLVS-VS-NBR         TO                           10590045
057140                                     DL04-VENDOR-STYLE            10600045
057150                                                                  10601045
057160     IF TR201-EDLVS-VS-CART-CNT NUMERIC                           10601145
057170        MOVE TR201-EDLVS-VS-CART-CNT   TO DL04-CARTONS-9          10601250
057180     ELSE                                                         10601345
057190        MOVE TR201-EDLVS-VS-CART-CNT-X TO DL04-CARTONS-X          10601450
057200     END-IF                                                       10601545
057300                                                                  10621045
057400     IF TR201-EDLVS-VS-UNT-QTY  NUMERIC                           10622045
057500        MOVE TR201-EDLVS-VS-UNT-QTY    TO DL04-UNITS-9            10623045
057600     ELSE                                                         10624045
057700        MOVE TR201-EDLVS-VS-UNT-QTY-X  TO DL04-UNITS-X            10625045
057800     END-IF                                                       10626045
057900                                                                  10641045
058000     IF TR201-EDLVS-VS-CBMT-QTY NUMERIC                           10642045
058100        MOVE TR201-EDLVS-VS-CBMT-QTY   TO DL04-CBMS-9             10643045
058200     ELSE                                                         10644045
058300        MOVE TR201-EDLVS-VS-CBMT-QTY-X TO DL04-CBMS-X             10645045
058400     END-IF                                                       10646045
058500                                                                  10661045
058600     IF TR201-EDLVS-VS-WT-KGRM-QTY NUMERIC                        10662045
058700        MOVE TR201-EDLVS-VS-WT-KGRM-QTY TO DL04-KGRMS-9           10663045
058800     ELSE                                                         10664045
058900        MOVE TR201-EDLVS-VS-WT-KGRM-QTY-X TO DL04-KGRMS-X         10665049
059000     END-IF.                                                      10666049
059001*                                                                 10770002
059002******************************************************************10780002
059003*MOVE EDLUPC DATA TO REPORT DETAIL LINE                           10790002
059004******************************************************************10800002
059005 3200-MOVE-EDLUPC-TO-DETAIL.                                      10810002
059006                                                                  10820002
059007     MOVE TR201-REC-TYP-EDLUPC-CDE      TO                        10830054
059008                                        PV-REC-TYP-CDE-PREV       10840054
059009                                        DL05-RECD-TYPE.           10850054
059010     MOVE TR201-TRN-TYP                 TO                        10860054
059020                                        DL05-TRN-TYPE.            10870054
059030     MOVE TR201-EDLUPC-VS-NBR           TO                        10880054
059040                                        DL05-VENDOR-STYLE         10890054
059050     MOVE TR201-EDLUPC-UPC-NBR          TO                        10900054
059060                                        DL05-UPC                  10910054
059070                                                                  10910155
059080     IF TR201-EDLUPC-UPC-CART-CNT NUMERIC                         10910255
059090         MOVE TR201-EDLUPC-UPC-CART-CNT  TO DL05-CARTON-9         10910355
059100     ELSE                                                         10910455
059200         MOVE TR201-EDLUPC-UPC-CART-CNT-X TO DL05-CARTON-X        10910555
059300     END-IF                                                       10911055
059400                                                                  10931055
059500     IF TR201-EDLUPC-UPC-UNT-QTY  NUMERIC                         10932055
059600         MOVE TR201-EDLUPC-UPC-UNT-QTY   TO DL05-UNITS-9          10933055
059700     ELSE                                                         10934055
059800         MOVE TR201-EDLUPC-UPC-UNT-QTY-X TO DL05-UNITS-X          10935055
059900     END-IF                                                       10936055
060000                                                                  10937055
060100     IF TR201-EDLUPC-UPC-CART-CNT NUMERIC                         10938055
060200         MOVE TR201-EDLUPC-UPC-CART-CNT  TO DL05-CBMS-9           10939055
060300     ELSE                                                         10940055
060400         MOVE TR201-EDLUPC-UPC-CART-CNT-X TO DL05-CBMS-X          10950055
060500     END-IF                                                       10951055
060600                                                                  10960055
060700                                                                  11000051
060800     IF TR201-EDLUPC-UPC-WT-KGRM-QTY NUMERIC                      11010051
060900        MOVE TR201-EDLUPC-UPC-WT-KGRM-QTY   TO DL05-KGRMS-9       11020051
061000     ELSE                                                         11030051
061100        MOVE TR201-EDLUPC-UPC-WT-KGRM-QTY-X TO DL05-KGRMS-X       11040051
061200     END-IF.                                                      11050054
061201*                                                                 11080002
061202******************************************************************11090002
061203*MOVE EDD DATA TO REPORT DETAIL LINE                              11100002
061204******************************************************************11110002
061205 3250-MOVE-EDD-TO-DETAIL.                                         11120002
061206                                                                  11130002
061207     MOVE TR201-REC-TYP-EDD-CDE       TO                          11140054
061208                                      PV-REC-TYP-CDE-PREV         11150054
061209                                      DL06-A-RECD-TYPE.           11160054
061210     MOVE TR201-TRN-TYP               TO                          11170054
061220                                      DL06-A-TRN-TYPE.            11180054
061230     MOVE TR201-EDD-TRIP-TYP-CDE      TO                          11190054
061240                                      DL06-A-VSL-TYPE             11200054
061250     MOVE TR201-EDD-IMPRT-TRIP-ID     TO                          11210054
061260                                      DL06-A-VOYAGE-NBR           11220054
061270     MOVE TR201-EDD-CARR-SCAC-ID      TO                          11230054
061280                                      DL06-A-SCAC                 11240054
061290     MOVE TR201-EDD-IMPRT-VEH-NM      TO                          11250099
061300                                      DL06-A-VESSEL-NAME          11260054
061400     MOVE TR201-EDD-POE-DELY-DTE (5:2) TO                         11270054
061500                                      DL06-A-ETA-DTE-MM           11280054
061600     MOVE TR201-EDD-POE-DELY-DTE (7:2) TO                         11290054
061700                                      DL06-A-ETA-DTE-DD           11300054
061800     MOVE TR201-EDD-POE-DELY-DTE (1:4) TO                         11310054
061900                                      DL06-A-ETA-DTE-YY           11320054
062000                                                                  11330002
062100     IF TR201-EDD-POE-DELY-DTE (1:4) = '0001' OR                  11340054
062200       TR201-EDD-POE-DELY-DTE (1:4) = SPACES                      11350054
062300          MOVE SPACES TO DL06-A-ETA-SLASH-1                       11360094
062400                         DL06-A-ETA-SLASH-2                       11370094
062500                         DL06-A-ETA-DTE-MM                        11380088
062600                         DL06-A-ETA-DTE-DD                        11390088
062700                         DL06-A-ETA-DTE-YY                        11400088
062800     ELSE                                                         11410054
062900          MOVE '/'    TO DL06-A-ETA-SLASH-1                       11420094
063000                         DL06-A-ETA-SLASH-2                       11430094
063100     END-IF                                                       11440054
063200                                                                  11450002
063300     MOVE TR201-EDD-DPRTR-DTE (5:2)   TO                          11460054
063400                                      DL06-A-ETD-DTE-MM           11470095
063500     MOVE TR201-EDD-DPRTR-DTE (7:2)   TO                          11480054
063600                                      DL06-A-ETD-DTE-DD           11490095
063700     MOVE TR201-EDD-DPRTR-DTE (1:4)   TO                          11500054
063800                                      DL06-A-ETD-DTE-YY           11510095
063900                                                                  11520002
064000     IF TR201-EDD-DPRTR-DTE (1:4) = '0001' OR                     11530054
064100       TR201-EDD-DPRTR-DTE (1:4) = SPACES                         11540054
064200           MOVE SPACES TO DL06-A-ETD-SLASH-1                      11550095
064300                          DL06-A-ETD-SLASH-2                      11560095
064400                          DL06-A-ETD-DTE-MM                       11570095
064500                          DL06-A-ETD-DTE-DD                       11580095
064600                          DL06-A-ETD-DTE-YY                       11590095
064700     ELSE                                                         11600054
064800           MOVE '/'    TO DL06-A-ETD-SLASH-1                      11610095
064900                          DL06-A-ETD-SLASH-2                      11620095
065000     END-IF                                                       11630054
065100                                                                  11640002
065200     MOVE TR201-EDD-FOB-CDE           TO                          11650054
065300                                      DL06-A-POL                  11660054
065400     MOVE TR201-EDD-DEST-POE-CDE      TO                          11670054
065500                                      DL06-A-POE.                 11680054
068000     MOVE TR201-EDD-EST-LBD-NM        TO                          11680174
                                            DL06-A-EST-LBD-DEST         11680274
208200     PERFORM 3010-EDIT-POE-LBD.                                   11681075
065501*                                                                 11830002
065502******************************************************************11840002
065503*MOVE EDDRSN DATA TO REPORT DETAIL LINE                           11850002
065504******************************************************************11860002
065505 3300-MOVE-EDDRSN-TO-DETAIL.                                      11870002
065506                                                                  11880002
065507     IF TR201-PO-NBR  = PV-PO-NBR                                 11890054
065508        SET PS-NOT-NEW-PO        TO TRUE                          11900054
065509     ELSE                                                         11910054
065510        SET PS-NEW-PO            TO TRUE                          11920054
065520        SET PS-EDDRSN-NO         TO TRUE                          11930054
065530     END-IF.                                                      12000054
065540                                                                  12001052
065550     IF TR201-PO-NBR NUMERIC                                      12002054
065560         MOVE TR201-PO-NBR        TO DL02-PO-NBR-9                12003054
065570     ELSE                                                         12004054
065580         MOVE TR201-PO-NBR-X      TO DL02-PO-NBR-X                12005054
065590     END-IF                                                       12006054
065600                                                                  12010052
065900                                                                  12040002
066000     MOVE TR201-REC-TYP-EDDRSN-CDE TO                             12050054
066100                                   PV-REC-TYP-CDE-PREV            12060054
066200                                   DL07-A-RECD-TYPE.              12070054
066300     MOVE TR201-TRN-TYP            TO                             12080054
066400                                   DL07-A-TRN-TYPE                12090054
066500     MOVE TR201-EDDRSN-IMPRT-TRIP-ID TO                           12100054
066600                                   DL07-A-VOYAGE-NBR              12110054
066700     MOVE TR201-EDDRSN-CARR-SCAC-ID TO                            12120054
066800                                   DL07-A-SCAC                    12130054
066900     MOVE TR201-EDDRSN-POE-DELY-DTE (5:2) TO                      12140054
067000                                   DL07-A-ETA-DTE-MM              12150054
067100     MOVE TR201-EDDRSN-POE-DELY-DTE (7:2) TO                      12160054
067200                                   DL07-A-ETA-DTE-DD              12170054
067300     MOVE TR201-EDDRSN-POE-DELY-DTE (1:4) TO                      12180054
067400                                   DL07-A-ETA-DTE-YY              12190054
067500                                                                  12200002
067600     IF TR201-EDDRSN-POE-DELY-DTE (1:4) = '0001' OR               12210054
067700       TR201-EDDRSN-POE-DELY-DTE (1:4) = SPACES                   12220054
067800          MOVE SPACES TO DL07-A-ETA-SLASH-1                       12230094
067900                         DL07-A-ETA-SLASH-2                       12240094
068000                         DL07-A-ETA-DTE-MM                        12250054
068100                         DL07-A-ETA-DTE-DD                        12260054
068200                         DL07-A-ETA-DTE-YY                        12270054
068300     ELSE                                                         12280054
068400          MOVE '/'    TO DL07-A-ETA-SLASH-1                       12290094
068500                         DL07-A-ETA-SLASH-2                       12300094
068600     END-IF                                                       12310054
068700                                                                  12320002
068800     MOVE TR201-EDDRSN-DPRTR-DTE (5:2) TO                         12330054
068900                                   DL07-A-ETD-DTE-MM              12340095
069000     MOVE TR201-EDDRSN-DPRTR-DTE (7:2) TO                         12350054
069100                                   DL07-A-ETD-DTE-DD              12360095
069200     MOVE TR201-EDDRSN-DPRTR-DTE (1:4) TO                         12370054
069300                                   DL07-A-ETD-DTE-YY              12380095
069400                                                                  12390002
069500     IF TR201-EDDRSN-DPRTR-DTE (1:4) = '0001' OR                  12400054
069600       TR201-EDDRSN-DPRTR-DTE (1:4) = SPACES                      12410054
069700          MOVE SPACES TO DL07-A-ETD-SLASH-1                       12420095
069800                         DL07-A-ETD-SLASH-2                       12430095
069900                         DL07-A-ETD-DTE-MM                        12440095
070000                         DL07-A-ETD-DTE-DD                        12450095
070100                         DL07-A-ETD-DTE-YY                        12460095
070200     ELSE                                                         12470054
070300          MOVE '/'    TO DL07-A-ETD-SLASH-1                       12480095
070400                         DL07-A-ETD-SLASH-2                       12490095
070500     END-IF                                                       12500054
070600                                                                  12510002
070700     MOVE TR201-EDDRSN-VOY-CHG-RSN-DESC TO                        12520054
070800                         DL07-A-VOYAGE-CHANGE.                    12530054
070900*                                                                 12620002
091702******************************************************************12620160
091703*3650-MOVE-ERROR-TO-DETAIL.                                       12620260
091704******************************************************************12620360
091705 3650-MOVE-ERROR-TO-DETAIL.                                       12620460
091706                                                                  12620560
091707     SET PS-NEW-PO               TO TRUE.                         12620699
091708     SET PS-EDD-NO               TO TRUE.                         12620799
091709     SET PS-EDL-NO               TO TRUE.                         12620899
091710*    SET PS-EDLVS-NO             TO TRUE.                         12620999
091720*    SET PS-EDLUPC-NO            TO TRUE.                         12621099
091730*    SET PS-EDDRSN-NO            TO TRUE.                         12622099
091760                                                                  12622160
091761                                                                  12630002
091762******************************************************************12640002
091763*MOVE WHS DATA TO REPORT DETAIL LINE                              12650002
091764                                                                  12660002
091765******************************************************************12670002
091766*  READ THE ERROR-FILE                                           *12680002
091767******************************************************************12690002
091768 7000-READ-ERROR-FILE.                                            12700002
091769                                                                  12710002
091770     READ ERROR-FILE                                              12720002
091771       INTO TR201-RECORD                                          12730002
091772         AT END                                                   12740002
091773           SET PS-EOF-ERROR-FILE TO TRUE.                         12750002
092320                                                                  12760002
092330     IF TR201-REC-TYP-HDR-CDE-HDR                                 12770002
092340        MOVE TR201-HDR-CONSOL-TRNS-DTE (5:2) TO                   12780002
092350             HL-TRANS-MM                                          12790002
092360        MOVE TR201-HDR-CONSOL-TRNS-DTE (7:2) TO                   12800002
092370             HL-TRANS-DD                                          12810002
092380        MOVE TR201-HDR-CONSOL-TRNS-DTE (3:2) TO                   12820002
092390             HL-TRANS-YY                                          12830002
092400        MOVE TR201-HDR-CONSOL-TRNS-TM (1:2) TO                    12840002
092500             HL-TRANS-TIME-HH                                     12850002
092600        MOVE TR201-HDR-CONSOL-TRNS-TM (3:2) TO                    12860002
092700             HL-TRANS-TIME-MM                                     12870002
092800        MOVE TR201-HDR-CONSOL-FIL-ID TO                           12880002
092900             HL1-FILE-ID                                          12890002
093000        MOVE TR201-HDR-LOAD-DTE (5:2) TO                          12900002
093100             HL-LOAD-MM                                           12910002
093200        MOVE TR201-HDR-LOAD-DTE (7:2) TO                          12920002
093300             HL-LOAD-DD                                           12930002
093400        MOVE TR201-HDR-LOAD-DTE (3:2) TO                          12940002
093500             HL-LOAD-YY                                           12950002
093600        MOVE TR201-HDR-LOAD-TM (1:2) TO                           12960002
093700             HL-LOAD-TIME-HH                                      12970002
093800        MOVE TR201-HDR-LOAD-TM (3:2) TO                           12980002
093900             HL-LOAD-TIME-MM                                      12990002
094000        MOVE TR201-HDR-CONSOL-ENTNME TO                           13000002
094100             HL1-EXPEDITOR                                        13010002
094101     END-IF.                                                      13020002
094102*                                                                 13030002
094103***************************************************************** 13040002
094104*  PRINT THE HEADINGS ON EACH PAGE.                             * 13050002
094105***************************************************************** 13060002
094106 8000-WRITE-PAGE-HEADINGS.                                        13070002
094107                                                                  13080002
094108     ADD 1                TO PV-PAGE-COUNT.                       13090002
094109     MOVE PV-PAGE-COUNT   TO DP132O-PAGE-NUMBER.                  13100002
094110*                                                                 13100199
094108     IF PV-PAGE-COUNT > 1                                         13100299
094110*                                                                 13100399
              PERFORM                                                   13100499
                  WITH TEST AFTER                                       13100599
                  VARYING PV-LINES-USED                                 13100699
                  FROM PV-LINES-USED BY 1                               13100799
                  UNTIL PV-LINES-USED GREATER THAN PC-PAGE-SIZE-060     13100899
094110*                                                                 13100999
                   IF PV-LINES-USED > PC-PAGE-SIZE-060                  13101099
                     WRITE ERROR-REPORT-RECORD                          13101199
                       FROM TRL-HEADING-LINE-1                          13101299
                         AFTER ADVANCING 2 LINES                        13101399
                   ELSE                                                 13101499
                     WRITE ERROR-REPORT-RECORD                          13101599
                       FROM PV-BLANK-LINE                               13101699
                         AFTER ADVANCING 1 LINE                         13101799
                   END-IF                                               13101899
094110*                                                                 13101999
              END-PERFORM                                               13102099
094108     END-IF.                                                      13103099
094110*                                                                 13110002
094111     WRITE ERROR-REPORT-RECORD                                    13120002
094112       FROM DP132O-STANDRD-HEADER-132-COLS                        13130002
094113         AFTER ADVANCING PAGE.                                    13140002
094114*                                                                 13150002
065700     MOVE TR201-PO-NBR    TO       PV-PO-NBR                      13151099
065800     PERFORM 2060-SELECT-VENDOR-NAME.                             13152099
094114*                                                                 13153099
094115     MOVE PC-HEADING-SIZE TO PV-LINES-USED.                       13160002
094116*                                                                 13170002
094117     WRITE ERROR-REPORT-RECORD                                    13180002
094118       FROM HL1-HEADING-LINE-1                                    13190002
094119         AFTER ADVANCING 1 LINE.                                  13200002
094120*                                                                 13210002
094121     WRITE ERROR-REPORT-RECORD                                    13220002
094122       FROM HL1-HEADING-LINE-2                                    13230002
094123         AFTER ADVANCING 1 LINE.                                  13240002
094124                                                                  13250002
094125     WRITE ERROR-REPORT-RECORD                                    13260002
094126       FROM HL2-HEADING-LINE-1                                    13270002
094127         AFTER ADVANCING 2 LINES.                                 13280002
094128                                                                  13290002
094129     WRITE ERROR-REPORT-RECORD                                    13300002
094130       FROM HL2-HEADING-LINE-2                                    13310002
094140         AFTER ADVANCING 1 LINES.                                 13320002
094150                                                                  13330002
094160     WRITE ERROR-REPORT-RECORD                                    13340002
094170       FROM DL-DETAIL-LINE-2                                      13350002
094171         AFTER ADVANCING 1 LINES.                                 13360002
094172*                                                                 13370002
094173     WRITE ERROR-REPORT-RECORD                                    13380002
094174       FROM PV-BLANK-LINE                                         13390002
094175         AFTER ADVANCING 1 LINES.                                 13400002
094178*                                                                 13430002
094179     INITIALIZE DP132O-LASER-NEW-PAGE-INDICATR.                   13440002
094180*                                                                 13450002
094181*8000-EXIT.                                                       13460002
094182*                                                                 13470002
094183******************************************************************13480002
094184*  WRITE THE ERROR REPORT DETAIL RECORD.                          13490002
094185******************************************************************13500002
094186 8100-WRITE-ERROR-RPT-DETAIL.                                     13510002
094187                                                                  13520002
094188                                                                  13530002
094189     IF TR201-REC-TYP-EDL-CDE-EDL                                 13540002
094190        PERFORM 8200-WRITE-EDL-RECORD                             13550002
094191     END-IF.                                                      13560002
094192                                                                  13570002
094193     IF TR201-REC-TYP-EDLVS-CDE-EDLVS                             13580002
094194        PERFORM 8250-WRITE-EDLVS-RECORD                           13590002
094195     END-IF.                                                      13600002
094200                                                                  13610002
094300     IF TR201-REC-TYP-EDLUPC-CD-EDLUPC                            13620002
094400        PERFORM 8300-WRITE-EDLUPC-RECORD                          13630002
094500     END-IF.                                                      13640002
094600                                                                  13650002
094700     IF TR201-REC-TYP-EDD-CDE-EDD                                 13660002
094800        PERFORM 8350-WRITE-EDD-RECORD                             13670002
094900     END-IF.                                                      13680002
095000                                                                  13690002
095100     IF TR201-REC-TYP-EDDRSN-CD-EDDRSN                            13700002
095200        PERFORM 8400-WRITE-EDDRSN-RECORD                          13710002
095300     END-IF.                                                      13720002
095400                                                                  13730002
098000     IF NOT TR201-REC-TYP-EDL-CDE-EDL AND                         13740002
098100        NOT TR201-REC-TYP-EDLVS-CDE-EDLVS AND                     13750002
098200        NOT TR201-REC-TYP-EDLUPC-CD-EDLUPC AND                    13760002
098300        NOT TR201-REC-TYP-EDD-CDE-EDD AND                         13770002
098400        NOT TR201-REC-TYP-EDDRSN-CD-EDDRSN                        13780002
098900        PERFORM 8750-WRITE-ERROR-RECORD                           13790002
099000     END-IF.                                                      13800002
099100                                                                  13810002
099101     IF PV-LINES-USED >= PC-PAGE-SIZE-060                         13820002
099102        SET PS-NEW-PAGE  TO TRUE                                  13830002
099103        SET PS-EDDRSN-NO TO TRUE                                  13840002
099109     END-IF.                                                      13850002
099110*                                                                 13860002
099111*8100-EXIT.                                                       13880002
099112*                                                                 13890002
099113******************************************************************13900002
099114*  WRITE THE ERROR REPORT DETAIL RECORD.                          13910002
099115******************************************************************13920002
099116 8150-WRITE-ERROR-RPT-DETAIL.                                     13930002
099117                                                                  13931054
099118     IF PV-EDL-REC-TYP-CDE-EDL                                    13950002
099119        PERFORM 8200-WRITE-EDL-RECORD                             13960002
099120     END-IF.                                                      13970002
099130                                                                  13980002
099140     IF PV-EDLVS-REC-TYP-CDE-EDLVS                                13990002
099150        PERFORM 8250-WRITE-EDLVS-RECORD                           14000002
099160     END-IF.                                                      14010002
099170                                                                  14020002
099180     IF PV-EDLUPC-REC-TYP-CDE-EDLUPC                              14030002
099190        PERFORM 8300-WRITE-EDLUPC-RECORD                          14040002
099200     END-IF.                                                      14050002
099300                                                                  14060002
099400     IF PV-EDD-REC-TYP-CDE-EDD                                    14070002
099500        PERFORM 8350-WRITE-EDD-RECORD                             14080002
099600     END-IF.                                                      14090002
099700                                                                  14100002
099800     IF PV-EDDRSN-REC-TYP-CD-EDDRSN                               14110002
099900        PERFORM 8400-WRITE-EDDRSN-RECORD                          14120002
100000     END-IF.                                                      14130002
100001                                                                  14140002
100002*    IF PV-LINES-USED > PC-PAGE-SIZE-051 AND                      14150002
100003     IF PV-LINES-USED > PC-PAGE-SIZE-060                          14160002
100004        SET PS-NEW-PAGE  TO TRUE                                  14170002
100005        SET PS-EDD-NO TO TRUE                                     14180022
100006        SET PS-EDL-NO TO TRUE                                     14180122
100007        SET PS-EDLVS-NO TO TRUE                                   14180232
100008        SET PS-EDLUPC-NO TO TRUE                                  14180332
100009        SET PS-EDDRSN-NO TO TRUE                                  14181022
100010        PERFORM 8000-WRITE-PAGE-HEADINGS                          14240002
100011     END-IF.                                                      14250002
100012*                                                                 14260002
100013*8150-EXIT.                                                       14270002
100014*                                                                 14280002
100015******************************************************************14290002
100016*  PRINT EDL ERROR RECORD                                         14300002
100017******************************************************************14310002
100018 8200-WRITE-EDL-RECORD.                                           14320002
100019                                                                  14331127
100020     IF PS-EDD-YES AND                                            14332027
100030       NOT PS-NEW-PAGE                                            14333027
100040        MOVE SPACES TO HL3-TYPE-1-LNE-1                           14334027
100050                       HL3-TYPE-1-LNE-2                           14335027
100060                       HL3-TYPE-2-LNE-1                           14336027
100070                       HL3-TYPE-2-LNE-2                           14337027
100080     ELSE                                                         14338027
100090        MOVE 'RECD' TO HL3-TYPE-1-LNE-1                           14339027
100100        MOVE 'TYPE' TO HL3-TYPE-1-LNE-2                           14339127
100200        MOVE 'TRN'  TO HL3-TYPE-2-LNE-1                           14339227
100300        MOVE 'TYPE' TO HL3-TYPE-2-LNE-2                           14339327
100400     END-IF.                                                      14339427
100500                                                                  14339527
100600     WRITE ERROR-REPORT-RECORD                                    14340027
100700         FROM HL3-HEADING-LINE-1                                  14350027
100800             AFTER ADVANCING 2 LINES.                             14360027
100900                                                                  14370010
101000     WRITE ERROR-REPORT-RECORD                                    14400027
101100         FROM HL3-HEADING-LINE-2                                  14410027
101200             AFTER ADVANCING 1 LINES.                             14420027
101300                                                                  14421010
101400     WRITE ERROR-REPORT-RECORD                                    14430027
101500         FROM DL-DETAIL-LINE-3                                    14440027
101600             AFTER ADVANCING 1 LINES.                             14450027
101700                                                                  14540002
101800     ADD 4 TO PV-LINES-USED.                                      14550027
101900                                                                  14560002
102000     SET PS-EDL-YES TO TRUE.                                      14570027
102100     SET PS-NOT-NEW-PAGE TO TRUE.                                 14571036
102101                                                                  14580002
102102******************************************************************14590002
102103*  PRINT EDLVS ERROR RECORD                                       14600002
102104******************************************************************14610002
102105 8250-WRITE-EDLVS-RECORD.                                         14620002
102106                                                                  14630002
102107     IF PS-EDLVS-YES AND                                          14630119
102108       PS-NOT-NEW-PAGE                                            14631037
102109        MOVE SPACES TO HL4-TYPE-1-LNE-1                           14650022
102110                       HL4-TYPE-1-LNE-2                           14651022
102120                       HL4-TYPE-2-LNE-1                           14660022
102130                       HL4-TYPE-2-LNE-2                           14661022
102140     ELSE                                                         14680017
102150        MOVE 'RECD' TO HL4-TYPE-1-LNE-1                           14690024
102160        MOVE 'TYPE' TO HL4-TYPE-1-LNE-2                           14691022
102170        MOVE 'TRN'  TO HL4-TYPE-2-LNE-1                           14700022
102180        MOVE 'TYPE' TO HL4-TYPE-2-LNE-2                           14710022
102190     END-IF.                                                      14720017
102200                                                                  14730002
102300     WRITE ERROR-REPORT-RECORD                                    14740002
102400         FROM HL4-HEADING-LINE-1                                  14750002
102500     AFTER ADVANCING 2 LINES.                                     14760002
102600                                                                  14770002
102700     WRITE ERROR-REPORT-RECORD                                    14780002
102800         FROM HL4-HEADING-LINE-2                                  14790002
102900     AFTER ADVANCING 1 LINES.                                     14800002
103000                                                                  14810002
103100     WRITE ERROR-REPORT-RECORD                                    14820002
103200         FROM DL-DETAIL-LINE-4                                    14830002
103300     AFTER ADVANCING 1 LINES.                                     14840002
103400                                                                  14930002
103500     ADD 4 TO PV-LINES-USED.                                      14940010
103600                                                                  14950002
103700     SET PS-EDLVS-YES TO TRUE.                                    14960002
103800     SET PS-NOT-NEW-PAGE TO TRUE.                                 14961036
103801                                                                  14970002
103802******************************************************************14980002
103803*  PRINT EDLUPC ERROR RECORD                                      14990002
103804******************************************************************15000002
103805 8300-WRITE-EDLUPC-RECORD.                                        15010002
103806                                                                  15020002
103807     IF PS-EDLUPC-YES AND                                         15040031
103808       NOT PS-NEW-PAGE                                            15041016
103809        MOVE SPACES TO HL5-RECD                                   15051017
103810        MOVE SPACES TO HL5-TRN                                    15052017
103820        MOVE SPACES TO HL5-TYPE-1                                 15053017
103830                       HL5-TYPE-2                                 15054017
103840     ELSE                                                         15060002
103850        MOVE 'RECD' TO HL5-RECD                                   15070002
103860        MOVE 'TRN'  TO HL5-TRN                                    15080002
103870        MOVE 'TYPE' TO HL5-TYPE-1                                 15090002
103880                       HL5-TYPE-2                                 15100002
103890     END-IF.                                                      15110002
103900                                                                  15120002
104000     WRITE ERROR-REPORT-RECORD                                    15130002
104100         FROM HL5-HEADING-LINE-1                                  15140002
104200     AFTER ADVANCING 2 LINES.                                     15150002
104300                                                                  15160002
104400     WRITE ERROR-REPORT-RECORD                                    15170002
104500         FROM HL5-HEADING-LINE-2                                  15180002
104600     AFTER ADVANCING 1 LINES.                                     15190002
104700                                                                  15200002
104800     WRITE ERROR-REPORT-RECORD                                    15210002
104900         FROM DL-DETAIL-LINE-5                                    15220002
105000     AFTER ADVANCING 1 LINES.                                     15230002
105100                                                                  15240002
105200*                                                                 15280002
105300     ADD 4 TO PV-LINES-USED.                                      15330010
105400                                                                  15340002
105500     SET PS-EDLUPC-YES TO TRUE.                                   15350002
105600     SET PS-NOT-NEW-PAGE TO TRUE.                                 15351036
105601                                                                  15360002
105602******************************************************************15370002
105603*  PRINT EDD ERROR RECORD                                         15380002
105604******************************************************************15390002
105605 8350-WRITE-EDD-RECORD.                                           15400002
105606                                                                  15410002
105607     IF (PS-EDD-YES OR                                            15420031
105608       PS-EDL-YES) AND                                            15430031
105609       NOT PS-NEW-PAGE                                            15441017
105610        MOVE SPACES TO HL6-RECD                                   15443023
105620        MOVE SPACES TO HL6-TRN                                    15444023
105630        MOVE SPACES TO HL6-TYPE-1                                 15445023
105640                       HL6-TYPE-2                                 15446023
105650     ELSE                                                         15460017
105660        MOVE 'RECD' TO HL6-RECD                                   15470023
105670        MOVE 'TRN'  TO HL6-TRN                                    15480023
105680        MOVE 'TYPE' TO HL6-TYPE-1                                 15490023
105690                       HL6-TYPE-2                                 15500023
105700     END-IF.                                                      15510017
105800                                                                  15520002
105900     WRITE ERROR-REPORT-RECORD                                    15530017
106000         FROM HL6-HEADING-LINE-1                                  15540017
106100     AFTER ADVANCING 2 LINES.                                     15550017
106200                                                                  15560002
106300     WRITE ERROR-REPORT-RECORD                                    15570017
106400         FROM HL6-HEADING-LINE-2-A                                15580017
106500     AFTER ADVANCING 1 LINES.                                     15590017
106600                                                                  15600002
106700     WRITE ERROR-REPORT-RECORD                                    15610017
106800         FROM DL-DETAIL-LINE-6-A                                  15620017
106900     AFTER ADVANCING 1 LINES.                                     15630017
107000                                                                  15720002
107100     ADD 4 TO PV-LINES-USED.                                      15730017
107200                                                                  15740002
107300     SET PS-EDD-YES TO TRUE.                                      15750017
107400     SET PS-NOT-NEW-PAGE TO TRUE.                                 15751036
107401                                                                  15760002
107402******************************************************************15770002
107403*  PRINT EDDRSN ERROR RECORD                                      15780002
107404******************************************************************15790002
107405 8400-WRITE-EDDRSN-RECORD.                                        15800002
107406                                                                  15801024
107407     IF PS-EDL-YES OR                                             15802024
107408       PS-EDLVS-YES OR                                            15803024
107409       PS-EDLUPC-YES OR                                           15803124
107410       PS-EDDRSN-YES AND                                          15804024
107420       NOT PS-NEW-PAGE                                            15805024
107430        MOVE SPACES TO HL7-RECD                                   15806024
107440        MOVE SPACES TO HL7-TRN                                    15807024
107450        MOVE SPACES TO HL7-TYPE-1                                 15808024
107460                       HL7-TYPE-2                                 15809024
107470     ELSE                                                         15809124
107480        MOVE 'RECD' TO HL7-RECD                                   15809224
107490        MOVE 'TRN'  TO HL7-TRN                                    15809324
107500        MOVE 'TYPE' TO HL7-TYPE-1                                 15809424
107600                       HL7-TYPE-2                                 15809524
107601     END-IF.                                                      15809624
107602                                                                  15810002
107603     WRITE ERROR-REPORT-RECORD                                    15820002
107604           FROM HL7-HEADING-LINE-1                                15830002
107605     AFTER ADVANCING 2 LINES                                      15840002
107606                                                                  15850002
107607     WRITE ERROR-REPORT-RECORD                                    15860002
107608           FROM HL7-HEADING-LINE-2                                15870002
107609     AFTER ADVANCING 1 LINES.                                     15880002
107610                                                                  15890002
107620     WRITE ERROR-REPORT-RECORD                                    15900002
107630           FROM DL-DETAIL-LINE-7                                  15910002
107640     AFTER ADVANCING 1 LINES.                                     15920002
107650                                                                  15930002
107660                                                                  16010002
107670     ADD 4 TO PV-LINES-USED.                                      16020010
107680                                                                  16030002
107690     SET PS-EDDRSN-YES TO TRUE.                                   16040002
107700     SET PS-NOT-NEW-PAGE TO TRUE.                                 16041036
107800                                                                  16050002
145101*                                                                 16060002
145102******************************************************************16070002
145103*  PRINT ERROR  ERROR RECORD                                      16080002
145104******************************************************************16090002
145105 8750-WRITE-ERROR-RECORD.                                         16100002
145106                                                                  16110002
145107      IF  PS-NEW-PAGE OR                                          16120002
145108          PS-EDD-NO OR                                            16130002
145109          PS-NEW-PO                                               16140002
145110            WRITE ERROR-REPORT-RECORD                             16150002
145120                  FROM HL6-HEADING-LINE-1                         16160002
145130            AFTER ADVANCING 2 LINES                               16170002
145140                                                                  16180002
145150            SET PS-NOT-NEW-PAGE TO TRUE                           16190002
145160                                                                  16200002
145170            ADD 2 TO PV-LINES-USED                                16210010
145180     END-IF.                                                      16220002
145190                                                                  16230002
145200     WRITE ERROR-REPORT-RECORD                                    16240002
145300         FROM HL2-HEADING-LINE-1                                  16250002
145400             AFTER ADVANCING 2 LINES.                             16260002
146300                                                                  16350002
146400     ADD 2 TO PV-LINES-USED.                                      16360010
146401                                                                  16370002
146402******************************************************************16380002
146403*  PRINT END OF REPORT MESSAGE, CLOSE THE OUTPUT FILE, AND CLOSE  16390002
146404*  THE CURSOR.                                                    16400002
146405******************************************************************16410002
146406 9000-EOJ-ROUTINE.                                                16420002
146407                                                                  16430002
146408     IF NOT TR201-RPT-TYP-DETAIL AND                              16440004
146409       TR201-RPT-TYP NOT = SPACES                                 16450002
146410        PERFORM  8150-WRITE-ERROR-RPT-DETAIL                      16460002
146411     END-IF.                                                      16470002
146412                                                                  16480002
146413     ADD 2 TO PV-LINES-USED.                                      16490002
146414                                                                  16500002
146415     IF PV-LINES-USED > PC-PAGE-SIZE-060                          16510002
146416        PERFORM 8000-WRITE-PAGE-HEADINGS                          16520002
146417     END-IF.                                                      16530002
146418                                                                  16540002
146419     WRITE ERROR-REPORT-RECORD                                    16550002
146420         FROM ER-END-OF-REPORT-LINE                               16560002
146421             AFTER ADVANCING 2 LINES.                             16570002
146422                                                                  16580002
146423     CLOSE ERROR-FILE                                             16590002
146424           ERROR-REPORT-FILE.                                     16600002
146425*                                                                 16610002
146426*9000-EXIT.                                                       16620002
146427*                                                                 16630002
146428******************************************************************16640002
146429*  PRINTS REPORT MESSAGE IF THERE IS NO DATA ON THE FILE          16650002
146430******************************************************************16660002
146431 9100-EOJ-ROUTINE.                                                16670002
146432**                                                                16680002
146433**   PERFORM 8000-WRITE-PAGE-HEADINGS.                            16690002
146434**                                                                16700002
146435     WRITE ERROR-REPORT-RECORD                                    16710002
146436         FROM EP-EMPTY-REPORT-LINE                                16720002
146437             AFTER ADVANCING 2 LINES.                             16730002
146438                                                                  16740002
146439                                                                  16750002
146440     WRITE ERROR-REPORT-RECORD                                    16760002
146441         FROM ER-END-OF-REPORT-LINE                               16770002
146442             AFTER ADVANCING 2 LINES.                             16780002
146443                                                                  16790002
146444     CLOSE ERROR-FILE                                             16800002
146445           ERROR-REPORT-FILE.                                     16810002
146446*                                                                 16820002
146447*9100-EXIT.                                                       16830002
146448                                                                  16840002
