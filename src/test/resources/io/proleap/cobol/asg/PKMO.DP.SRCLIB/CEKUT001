000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400*                                                                 00040000
000500 PROGRAM-ID.    CEKUT001.                                         00050000
000600 AUTHOR.        TESS BESTE.                                       00060000
000700 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00070000
000800 DATE-WRITTEN.  06/07/94.                                         00080000
000900 DATE-COMPILED.                                                   00090000
001000*                                                                 00100000
001100*----------------------------------------------------------------*00110000
001200*         CENTRAL STOCK TRANSFER PROCESSING                      *00120000
001300*----------------------------------------------------------------*00130000
001400* CHANGES: S. JACKSON                                             00140000
001500*         12/17/2001 (NEW SKU PROJECT) CHANGE ID : W21731         00150000
001600*         SKU NUMBER WILL BE READ AND USED TO RETRIEVE INTELLIGENT00160000
001700*         SKU ATTRIBUTES (FROM TSKXREF).                          00170000
001800*----------------------------------------------------------------*00180000
001900                                                                  00190000
002000******************************************************************00200000
002100 ENVIRONMENT DIVISION.                                            00210000
002200******************************************************************00220000
002300                                                                  00230000
002400 CONFIGURATION SECTION.                                           00240000
002500                                                                  00250000
002600 OBJECT-COMPUTER.  IBM-3090.                                      00260000
002700 SOURCE-COMPUTER.  IBM-3090.                                      00270000
002800                                                                  00280000
002900 INPUT-OUTPUT SECTION.                                            00290000
003000                                                                  00300000
003100 FILE-CONTROL.                                                    00310000
003200     SELECT CENTRAL-STK-XFER-FILE                                 00320000
003300         ASSIGN TO INP01.                                         00330000
003400     SELECT MERCHANDISE-LEDGER-FILE                               00340000
003500         ASSIGN TO OUT01.                                         00350000
003600     SELECT SKU-RECEIPTS-FILE                                     00360000
003700         ASSIGN TO OUT02.                                         00370000
003800     SELECT SKU-ADJUST-FILE                                       00380000
003900         ASSIGN TO OUT03.                                         00390000
004000     SELECT CENTRAL-STK-ERROR-REPORT                              00400000
004100         ASSIGN TO RPT01.                                         00410000
004200     SELECT CENTRAL-STK-DETAIL-REPORT                             00420000
004300         ASSIGN TO RPT02.                                         00430000
004400                                                                  00440000
004500******************************************************************00450000
004600 DATA DIVISION.                                                   00460000
004700******************************************************************00470000
004800                                                                  00480000
004900 FILE SECTION.                                                    00490000
005000                                                                  00500000
005100 FD  CENTRAL-STK-XFER-FILE                                        00510000
005200     RECORDING MODE IS F                                          00520000
005300     LABEL RECORDS ARE STANDARD                                   00530000
005400     RECORD CONTAINS 80 CHARACTERS                                00540000
005500     BLOCK CONTAINS 0 RECORDS.                                    00550000
005600                                                                  00560000
005700 01  CENTRAL-STK-XFER-RECORD       PIC X(80).                     00570000
005800                                                                  00580000
005900                                                                  00590000
006000 FD  MERCHANDISE-LEDGER-FILE                                      00600000
006100     RECORDING MODE IS F                                          00610000
006200     LABEL RECORDS ARE STANDARD                                   00620000
006300     RECORD CONTAINS 80 CHARACTERS                                00630000
006400     BLOCK CONTAINS 0 RECORDS.                                    00640000
006500                                                                  00650000
006600 01  MERCHANDISE-LEDGER-RECORD     PIC X(80).                     00660000
006700                                                                  00670000
006800                                                                  00680000
006900 FD  SKU-RECEIPTS-FILE                                            00690000
007000     RECORDING MODE IS F                                          00700000
007100     LABEL RECORDS ARE STANDARD                                   00710000
007200     RECORD CONTAINS 200 CHARACTERS                               00720000
007300     BLOCK CONTAINS 0 RECORDS.                                    00730000
007400                                                                  00740000
007500 01  SKU-RECEIPTS-RECORD           PIC X(200).                    00750000
007600                                                                  00760000
007700                                                                  00770000
007800 FD  SKU-ADJUST-FILE                                              00780000
007900     RECORDING MODE IS F                                          00790000
008000     LABEL RECORDS ARE STANDARD                                   00800000
008100     RECORD CONTAINS 200 CHARACTERS                               00810000
008200     BLOCK CONTAINS 0 RECORDS.                                    00820000
008300                                                                  00830000
008400 01  SKU-ADJUST-RECORD             PIC X(200).                    00840000
008500                                                                  00850000
008600                                                                  00860000
008700 FD  CENTRAL-STK-ERROR-REPORT                                     00870000
008800     RECORDING MODE IS F                                          00880000
008900     LABEL RECORDS ARE STANDARD                                   00890000
009000     RECORD CONTAINS 200 CHARACTERS                               00900000
009100     BLOCK CONTAINS 0 RECORDS.                                    00910000
009200                                                                  00920000
009300 01  CENTRAL-STK-ERR-RPT-LINE PIC X(200).                         00930000
009400                                                                  00940000
009500                                                                  00950000
009600 FD  CENTRAL-STK-DETAIL-REPORT                                    00960000
009700     RECORDING MODE IS F                                          00970000
009800     LABEL RECORDS ARE STANDARD                                   00980000
009900     RECORD CONTAINS 200 CHARACTERS                               00990000
010000     BLOCK CONTAINS 0 RECORDS.                                    01000000
010100                                                                  01010000
010200 01  CENTRAL-STK-DTL-RPT-LINE PIC X(200).                         01020000
010300                                                                  01030000
010400                                                                  01040000
010500 WORKING-STORAGE SECTION.                                         01050000
010600*COPYBOOK FOR LOGISTIC DOMAIN MODULE              **              01060000
010700                                                                  01070000
010800     COPY XLWS001.                                                01080000
010900                                                                  01090000
011000*   DATE ENTRY CENTRAL STOCK TRANSFER INPUT RECORD LAYOUT.        01100000
011100                                                                  01110000
011200     COPY CERD004.                                                01120000
011300                                                                  01130000
011400*   MERCHANDISE LEDGER OUTPUT RECORD LAYOUT.                      01140000
011500                                                                  01150000
011600     COPY MLRD019.                                                01160000
011700                                                                  01170000
011800*   FASHION SALES MAINTENANCE RECORD LAYOUTS.                     01180000
011900                                                                  01190000
012000     COPY FSRD035.                                                01200000
012100                                                                  01210000
012200     COPY FSRD036.                                                01220000
012300                                                                  01230000
012400*   STANDARD HEADING FOR 200 COLUMN REPORT.                       01240000
012500                                                                  01250000
012600     COPY DPWS200O.                                               01260000
012700                                                                  01270000
012800 01  PS-PROGRAM-SWITCHES.                                         01280000
012900     05  PS-MORE-RECV-STORES-SW       PIC  X   VALUE 'Y'.         01290000
013000         88  PS-NO-MORE-RECV-STORES            VALUE 'N'.         01300000
013100     05  PS-MORE-DC-STORES-SW         PIC  X   VALUE 'Y'.         01310000
013200         88  PS-NO-MORE-DC-STORES              VALUE 'N'.         01320000
013300     05  PS-END-OF-CENTRAL-STK-XFERS-SW                           01330000
013400                                      PIC  X   VALUE 'N'.         01340000
013500         88  PS-END-OF-CENTRAL-STK-XFERS       VALUE 'Y'.         01350000
013600     05  PS-XFER-ERRORS-FOUND-SW      PIC  X   VALUE 'N'.         01360000
013700         88  PS-XFER-ERRORS-FOUND              VALUE 'Y'.         01370000
013800         88  PS-XFER-ERRORS-NOT-FOUND          VALUE 'N'.         01380000
013900     05  PS-SKU-FOUND-SW              PIC X(01)  VALUE 'N'.       01390000
014000         88  PS-SKU-FOUND                        VALUE 'Y'.       01400000
014100         88  PS-SKU-NOT-FOUND                    VALUE 'N'.       01410000
014200     05  PS-UPC-PRICE-SW              PIC X(01)  VALUE 'N'.       01420000
014300         88  PS-UPC-PRICE                        VALUE 'Y'.       01430000
014400         88  PS-NO-UPC-PRICE                     VALUE 'N'.       01440000
014500     05  PS-SKU-SW                    PIC X(01)  VALUE 'N'.       01450000
014600         88  PS-SAME-SKU                         VALUE 'Y'.       01460000
014700         88  PS-DIFF-SKU                         VALUE 'N'.       01470000
014800                                                                  01480000
014900 01  DK-DB2-KEY-FIELDS.                                           01490000
015000     05  DK-SKU                   PIC 9(08).                      01500000
015100                                                                  01510000
015200 01  PV-PROGRAM-VARIABLES.                                        01520000
015300     05  PV-ML-QTY               PIC  9(05).                      01530010
015310     05  PV-DTL-RPT-LINE-COUNT   PIC S9(03)    COMP SYNC VALUE +0.01531010
015400     05  PV-DTL-RPT-PAGE-COUNT   PIC S9(05)    COMP SYNC VALUE +0.01540000
015500     05  PV-ERR-RPT-LINE-COUNT   PIC S9(03)    COMP SYNC VALUE +0.01550000
015600     05  PV-ERR-RPT-PAGE-COUNT   PIC S9(05)    COMP SYNC VALUE +0.01560000
015700     05  PV-STK-XFERS-READ       PIC S9(07)    COMP SYNC VALUE +0.01570000
015800     05  PV-MERCH-RECS-WR        PIC S9(07)    COMP SYNC VALUE +0.01580000
015900     05  PV-RECEIPT-RECS-WR      PIC S9(07)    COMP SYNC VALUE +0.01590000
016000     05  PV-ADJUST-RECS-WR       PIC S9(07)    COMP SYNC VALUE +0.01600000
016100     05  PV-DISPLAY-COUNT        PIC Z,ZZZ,ZZ9.                   01610000
016110     05  PV-RCT-START-DTE        PIC X(10).                       01611000
016120     05  PV-RCT-STOP-DTE         PIC X(10).                       01612000
016200     05  PV-SQLCODE                   PIC 9(9)  VALUE ZERO.       01620000
016300     05  PV-FILLED-DATE.                                          01630000
016400         10  PV-FILLED-DATE-CC   PIC X(02) VALUE '20'.            01640000
016500         10  PV-FILLED-DATE-YY   PIC X(02).                       01650000
016600         10  FILLER              PIC X VALUE '-'.                 01660000
016700         10  PV-FILLED-DATE-MM   PIC X(02).                       01670000
016800         10  FILLER              PIC X VALUE '-'.                 01680000
016900         10  PV-FILLED-DATE-DD   PIC X(02).                       01690000
017000                                                                  01700000
017100     05  PV-BATCH-TOTALS.                                         01710000
017200         10  PV-BTOT-TOTAL-QTY   PIC S9(09)    COMP-3    VALUE +0.01720000
017300         10  PV-BTOT-UNIT-PRICE  PIC S9(09)V99 COMP-3    VALUE +0.01730000
017400         10  PV-BTOT-EXT-PRICE   PIC S9(09)V99 COMP-3    VALUE +0.01740000
017500                                                                  01750000
017600     05  PV-GRAND-TOTALS.                                         01760000
017700         15  PV-GTOT-TOTAL-QTY   PIC  S9(9)    COMP-3    VALUE +0.01770000
017800         15  PV-GTOT-UNIT-PRICE  PIC  S9(9)V99 COMP-3    VALUE +0.01780000
017900         15  PV-GTOT-EXT-PRICE   PIC  S9(9)V99 COMP-3    VALUE +0.01790000
018000                                                                  01800000
018100 01  PV-ABEND-FIELDS.                                             01810000
018200     05  PV-ABEND-CODE                PIC S9(04) VALUE +0         01820000
018300                                                 COMP SYNC.       01830000
018400     05  PV-ABEND-PROGRAM             PIC  X(08) VALUE 'CEKUT001'.01840000
018500     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    01850000
018600     05  PV-ABEND-OPERATION           PIC  X(50) VALUE SPACES.    01860000
018700     05  PV-ABEND-STRUCTURE-1         PIC  X(08) VALUE SPACES.    01870000
018800     05  PV-ABEND-STRUCTURE-2         PIC  X(08) VALUE SPACES.    01880000
018900     05  PV-ABEND-STRUCTURE-3         PIC  X(08) VALUE SPACES.    01890000
019000     05  PV-DB2-OPERATION-MESSAGE-1   PIC  X(79) VALUE SPACES.    01900000
019100     05  PV-DB2-OPERATION-MESSAGE-2   PIC  X(79) VALUE SPACES.    01910000
019200     05  PV-DB2-OPERATION-MESSAGE-3   PIC  X(79) VALUE SPACES.    01920000
019300     05  PV-DB2-OPERATION-MESSAGE-4   PIC  X(79) VALUE SPACES.    01930000
019400     05  PV-DB2-TABLE-NAME            PIC  X(08) VALUE SPACES.    01940000
019500                                                                  01950000
019600     05  PV-PARAGRAPH            PIC  X(30).                      01960000
019700     05  PV-DB2-OPER-ATTEMPTED   PIC  X(30).                      01970000
019800     05  PV-RETRY-COUNT          PIC S9(4)     COMP SYNC VALUE +0.01980000
019900     05  PV-UPC-CODE             PIC S9(15)V   COMP-3    VALUE +0.01990000
020000     05  PV-SKU-NUM.                                              02000000
020100         10  PV-SKUNUM-DEPT      PIC  9(03).                      02010000
020200         10  PV-SKUNUM-CLASS     PIC  9(02).                      02020000
020300         10  PV-SKUNUM-SUBCLASS  PIC  9(02).                      02030000
020400     05  PV-NEW-SKU.                                              02040000
020500         10  PV-NEW-SKU-DEPT     PIC  X(03).                      02050000
020600         10  PV-NEW-SKU-CLASS    PIC  X(02).                      02060000
020700         10  PV-NEW-SKU-SUBCLASS PIC  X(02).                      02070000
020800     05  PV-DEPT                 PIC  X(03).                      02080000
020900     05  PV-MAJ-CL-NBR-WORK.                                      02090000
021000         10  PV-MAJ-CL-NBR-1     PIC  X.                          02100000
021100         10  PV-MAJ-CL-NBR-2     PIC  X.                          02110000
021200     05  PV-MAJ-CL-NBR           REDEFINES                        02120000
021300         PV-MAJ-CL-NBR-WORK      PIC  X(02).                      02130000
021400     05  PV-SUB-CL-NBR-WORK.                                      02140000
021500         10  PV-SUB-CL-NBR-1     PIC  X.                          02150000
021600         10  PV-SUB-CL-NBR-2-3   PIC  X(02).                      02160000
021700     05  PV-SUB-CL-NBR           REDEFINES                        02170000
021800         PV-SUB-CL-NBR-WORK      PIC  X(03).                      02180000
021900     05  PV-DATE-MMDDYY.                                          02190000
022000         10  PV-DATE-MMDDYY-MM   PIC  9(02).                      02200000
022100         10  PV-DATE-MMDDYY-DD   PIC  9(02).                      02210000
022200         10  PV-DATE-MMDDYY-YY   PIC  9(02).                      02220000
022300     05  PV-REC-SEQ-NBR          PIC  S9(3)    COMP-3    VALUE +0.02230000
022400     05  PV-XFER-FIELDS.                                          02240000
022500         10  PV-XFER-FISCAL-PERIOD                                02250000
022600                                 PIC  X(02).                      02260000
022700         10  PV-XFER-FILLED-DATE-ISO-FMT                          02270000
022800                                 PIC  X(10).                      02280000
022900         10  PV-XFER-RENUM-SKU   PIC  X(08).                      02290000
023000         10  PV-XFER-RENUM-SKU-ATTR.                              02300000
023100             15  PV-XFER-RENUM-DEPT-CLASS.                        02310000
023200                 20  PV-XFER-RENUM-DEPT                           02320000
023300                                 PIC  X(03).                      02330000
023400                 20  PV-XFER-RENUM-CLASS                          02340000
023500                                 PIC  X(02).                      02350000
023600             15  PV-XFER-RENUM-SUB-CLASS                          02360000
023700                                 PIC  X(02).                      02370000
023800         10  PV-XFER-STORE-QTY-TOT                                02380000
023900                                 PIC  S9(7)    COMP-3    VALUE +0.02390000
024000         10  PV-XFER-EXT-PRICE   PIC  S9(7)V99 COMP-3    VALUE +0.02400000
024100                                                                  02410000
024200     05  PV-PREV-TRAN-CODE       PIC X(01)     VALUE SPACE.       02420000
024300                                                                  02430000
024400 01  PC-PROGRAM-CONSTANTS.                                        02440000
024500     05  PC-MERCH-TRAN-CODE      PIC  X        VALUE '3'.         02450000
024600     05  PC-SKU-RECEIPT-TRANS-SOURCE                              02460000
024700                                 PIC  X(08)    VALUE 'CEKUT001'.  02470000
024800     05  PC-UNIT-OF-MEASURE      PIC S9(02)    VALUE +1.          02480000
024900     05  PC-SKU-FIELD-NUM        PIC  X(03)    VALUE '123'.       02490000
025000     05  PC-SKU-ACTION-MINUS     PIC  X        VALUE '-'.         02500000
025100     05  PC-SLASH                PIC  X        VALUE '/'.         02510000
025200     05  PC-DASH                 PIC  X        VALUE '-'.         02520000
025300     05  PC-DASH-LINE            PIC  X(200)   VALUE ALL '-'.     02530000
025400     05  PC-END-OF-RPT-LINE      PIC  X(200)   VALUE              02540000
025500                                          '*** END OF REPORT ***'.02550000
025600     05  PC-XFER-LINE-LIMIT      PIC S9(03)    COMP SYNC          02560000
025700                                               VALUE +51.         02570000
025800     05  PC-PAGE-LINE-LIMIT      PIC S9(03)    COMP SYNC          02580000
025900                                               VALUE +65.         02590000
026000     05  PC-MAX-RETRIES          PIC S9(4)     COMP SYNC VALUE +2.02600000
026100     05  PC-ALL-ZERO-UPC-CODE    PIC S9(15)V   COMP-3    VALUE +0.02610000
026200     05  PC-TSK-STATUS-CODE-RENUM                                 02620000
026300*                                PIC S9(03)    COMP-3   VALUE +98.02630000
026400                                 PIC X(02)     VALUE '98'.        02640000
026500     05  PC-MDSELV-CDE           PIC X(03)     VALUE 'SCL'.       02650000
026600     05  PC-OP-CO-NMBR           PIC X(02)     VALUE '03'.        02660000
026700     05  PC-APLSYS-CDE           PIC X(02)     VALUE 'ML'.        02670000
026800     05  PC-CALENDAR-ROUTINE     PIC X(08)     VALUE 'DPKUT500'.  02680000
026900                                                                  02690000
027000 01  CD-CURRENT-DATE-ISO-FMT     PIC X(10).                       02700000
027100 01  FILLER                      REDEFINES                        02710000
027200     CD-CURRENT-DATE-ISO-FMT.                                     02720000
027300     05  CD-CURRENT-DATE-ISO-FMT-CC                               02730000
027400                                 PIC  9(2).                       02740000
027500     05  CD-CURRENT-DATE-ISO-FMT-YY                               02750000
027600                                 PIC  9(2).                       02760000
027700     05  FILLER                  PIC  X.                          02770000
027800     05  CD-CURRENT-DATE-ISO-FMT-MM                               02780000
027900                                 PIC  9(2).                       02790000
028000     05  FILLER                  PIC  X.                          02800000
028100     05  CD-CURRENT-DATE-ISO-FMT-DD                               02810000
028200                                 PIC  9(2).                       02820000
028300                                                                  02830000
028400 01  ST-SYSTEM-TIME.                                              02840000
028500     05  ST-SYSTEM-HOUR          PIC  9(2)     VALUE ZEROES.      02850000
028600     05  ST-SYSTEM-MINUTE        PIC  9(2)     VALUE ZEROES.      02860000
028700     05  FILLER                  PIC  X(4)     VALUE SPACES.      02870000
028800                                                                  02880000
028900 01  EH1-ERR-RPT-HEADING-1.                                       02890000
029000     05  FILLER                  PIC  X(86)    VALUE SPACE.       02900000
029100     05  FILLER                  PIC  X(33)    VALUE              02910000
029200                              'CENTRAL STOCK DISTRIBUTION ERRORS'.02920000
029300                                                                  02930000
029400 01  EH2-ERR-RPT-HEADING-2.                                       02940000
029500     05  FILLER                  PIC  X        VALUE SPACE.       02950000
029600     05  FILLER                  PIC  X(5)     VALUE 'BATCH'.     02960000
029700     05  FILLER                  PIC  X(3)     VALUE SPACE.       02970000
029800     05  FILLER                  PIC  X(6)     VALUE 'FILLED'.    02980000
029900     05  FILLER                  PIC  X(6)     VALUE SPACE.       02990000
030000     05  FILLER                  PIC  X(3)     VALUE 'REQ'.       03000000
030100     05  FILLER                  PIC  X(5)     VALUE SPACE.       03010000
030200     05  FILLER                  PIC  X(10)    VALUE 'ORIG SKU /'.03020000
030300     05  FILLER                  PIC  X(20)    VALUE SPACE.       03030000
030400     05  FILLER                  PIC  X(5)     VALUE 'TOTAL'.     03040000
030500     05  FILLER                  PIC  X(6)     VALUE SPACE.       03050000
030600     05  FILLER                  PIC  X(5)     VALUE 'TOTAL'.     03060000
030700                                                                  03070000
030800 01  EH3-ERR-RPT-HEADING-3.                                       03080000
030900     05  FILLER                  PIC  X(3)     VALUE SPACE.       03090000
031000     05  FILLER                  PIC  X(2)     VALUE 'NO'.        03100000
031100     05  FILLER                  PIC  X(5)     VALUE SPACE.       03110000
031200     05  FILLER                  PIC  X(4)     VALUE 'DATE'.      03120000
031300     05  FILLER                  PIC  X(6)     VALUE SPACE.       03130000
031400     05  FILLER                  PIC  X(6)     VALUE 'NUMBER'.    03140000
031500     05  FILLER                  PIC  X(3)     VALUE SPACE.       03150000
031600     05  FILLER                  PIC  X(9)     VALUE 'RENUM SKU'. 03160000
031700     05  FILLER                  PIC  X(2)     VALUE SPACE.       03170000
031800     05  FILLER                  PIC  X(4)     VALUE 'DPT/'.      03180000
031900     05  FILLER                  PIC  X(5)     VALUE 'CLASS'.     03190000
032000     05  FILLER                  PIC  X(4)     VALUE '/SUB'.      03200000
032100     05  FILLER                  PIC  X(6)     VALUE SPACE.       03210000
032200     05  FILLER                  PIC  X(5)     VALUE 'PRICE'.     03220000
032300     05  FILLER                  PIC  X(8)     VALUE SPACE.       03230000
032400     05  FILLER                  PIC  X(3)     VALUE 'QTY'.       03240000
032500     05  FILLER                  PIC  X(5)     VALUE SPACE.       03250000
032600     05  FILLER                  PIC  X(14)                       03260000
032700                                           VALUE 'STR    QTY    '.03270000
032800     05  FILLER                  PIC  X(14)                       03280000
032900                                           VALUE 'STR    QTY    '.03290000
033000     05  FILLER                  PIC  X(14)                       03300000
033100                                           VALUE 'STR    QTY    '.03310000
033200     05  FILLER                  PIC  X(14)                       03320000
033300                                           VALUE 'STR    QTY    '.03330000
033400     05  FILLER                  PIC  X(14)                       03340000
033500                                           VALUE 'STR    QTY    '.03350000
033600     05  FILLER                  PIC  X(14)                       03360000
033700                                           VALUE 'STR    QTY    '.03370000
033800     05  FILLER                  PIC  X(14)                       03380000
033900                                           VALUE 'STR    QTY    '.03390000
034000*    05  FILLER                  PIC  X(14)                       03400000
034100*                                          VALUE 'STR    QTY    '.03410000
034200     05  FILLER                  PIC  X(9)     VALUE SPACE.       03420000
034300     05  FILLER                  PIC  X(6)     VALUE 'ERRORS'.    03430000
034400                                                                  03440000
034500                                                                  03450000
034600*01  ERL-IDX-MAX                 PIC S9(4)     VALUE +8    COMP   03460000
034700 01  ERL-IDX-MAX                 PIC S9(4)     VALUE +7    COMP   03470000
034800                                                           SYNC.  03480000
034900 01  ERL-ERR-RPT-LINE                          VALUE SPACE.       03490003
035000     05  ERL-HEADER-DATA.                                         03500000
035100         10  FILLER                PIC X.                         03510000
035200         10  ERL-BATCH-NMBR        PIC X(4).                      03520000
035300         10  FILLER                PIC X(3).                      03530000
035400         10  ERL-MONTH             PIC X(2).                      03540000
035500         10  ERL-DATE-SLASH1       PIC X.                         03550000
035600         10  ERL-DAY               PIC X(2).                      03560000
035700         10  ERL-DATE-SLASH2       PIC X.                         03570000
035800         10  ERL-YEAR              PIC X(2).                      03580000
035900         10  FILLER                PIC X(2).                      03590000
036000         10  ERL-PO-NMBR           PIC X(8).                      03600000
036100         10  FILLER                PIC X(3).                      03610000
036200         10  ERL-SKU               PIC X(8).                      03620000
036300         10  FILLER                PIC X(2).                      03630000
036400         10  ERL-DEPT              PIC ZZZ9.                      03640000
036500         10  FILLER                PIC X(1).                      03650000
036600         10  ERL-CLASS             PIC ZZZ9.                      03660000
036700         10  FILLER                PIC X(2).                      03670000
036800         10  ERL-SUBCLASS          PIC ZZZ9.                      03680000
036900         10  FILLER                PIC X(2).                      03690000
037000         10  ERL-UNIT-PRICE        PIC ZZ,ZZ9.99.                 03700000
037100         10  ERL-UNIT-PRICE-X      REDEFINES                      03710000
037200             ERL-UNIT-PRICE        PIC X(9).                      03720000
037300         10  FILLER                PIC X(2).                      03730000
037400         10  ERL-TOTAL-QTY         PIC Z,ZZZ,ZZ9.                 03740000
037500         10  ERL-TOTAL-QTY-X       REDEFINES                      03750000
037600             ERL-TOTAL-QTY         PIC X(9).                      03760000
037700         10  FILLER                PIC X(3).                      03770003
037800     05  ERL-STORE-DATA            OCCURS 7                       03780000
037900                                   INDEXED BY ERL-IDX.            03790000
038000         10  ERL-STORE-NBR         PIC 9(4).                      03800000
038100         10  FILLER                PIC X.                         03810000
038200         10  ERL-STORE-QTY-DASH    PIC X.                         03820000
038300         10  FILLER                PIC X.                         03830000
038400         10  ERL-STORE-QTY         PIC ZZZZ9.                     03840000
038500         10  ERL-STORE-QTY-X       REDEFINES                      03850000
038600             ERL-STORE-QTY         PIC X(5).                      03860000
038700         10  FILLER                PIC X(2).                      03870000
038800     05  ERL-ERROR-MESSAGE         PIC X(20).                     03880000
038900                                                                  03890000
039000 01  DH1-DTL-RPT-HEADING-1.                                       03900000
039100     05  FILLER                  PIC  X(77)    VALUE SPACE.       03910000
039200     05  FILLER                  PIC  X(33)    VALUE              03920000
039300                              'CENTRAL STOCK DISTRIBUTION DETAIL'.03930000
039400     05  FILLER                  PIC  X        VALUE SPACE.       03940000
039500     05  FILLER                  PIC  X(8)     VALUE 'BATCH - '.  03950000
039600     05  DH1-BATCH-NMBR          PIC  X(4)     VALUE SPACE.       03960000
039700                                                                  03970000
039800 01  DH2-DTL-RPT-HEADING-2.                                       03980000
039900     05  FILLER                  PIC  X        VALUE SPACE.       03990000
040000     05  FILLER                  PIC  X(6)     VALUE 'FILLED'.    04000000
040100     05  FILLER                  PIC  X(4)     VALUE SPACE.       04010000
040200     05  FILLER                  PIC  X(3)     VALUE 'REQ'.       04020000
040300     05  FILLER                  PIC  X(5)     VALUE SPACE.       04030000
040400     05  FILLER                  PIC  X(10)    VALUE 'ORIG SKU /'.04040000
040500     05  FILLER                  PIC  X(21)    VALUE SPACE.       04050000
040600     05  FILLER                  PIC  X(4)     VALUE 'UNIT'.      04060000
040700     05  FILLER                  PIC  X(6)     VALUE SPACE.       04070000
040800     05  FILLER                  PIC  X(3)     VALUE 'EXT'.       04080000
040900     05  FILLER                  PIC  X(7)     VALUE SPACE.       04090000
041000     05  FILLER                  PIC  X(5)     VALUE 'TOTAL'.     04100000
041100     05  FILLER                  PIC  X(2)     VALUE SPACE.       04110000
041200     05  FILLER                  PIC  X(4)     VALUE 'FROM'.      04120000
041300                                                                  04130000
041400 01  DH3-DTL-RPT-HEADING-3.                                       04140000
041500     05  FILLER                  PIC  X(2)     VALUE SPACE.       04150000
041600     05  FILLER                  PIC  X(4)     VALUE 'DATE'.      04160000
041700     05  FILLER                  PIC  X(4)     VALUE SPACE.       04170000
041800     05  FILLER                  PIC  X(6)     VALUE 'NUMBER'.    04180000
041900     05  FILLER                  PIC  X(3)     VALUE SPACE.       04190000
042000     05  FILLER                  PIC  X(9)     VALUE 'RENUM SKU'. 04200000
042100     05  FILLER                  PIC  X(2)     VALUE SPACE.       04210000
042200     05  FILLER                  PIC  X(4)     VALUE 'DPT/'.      04220000
042300     05  FILLER                  PIC  X(5)     VALUE 'CLASS'.     04230000
042400     05  FILLER                  PIC  X(4)     VALUE '/SUB'.      04240000
042500     05  FILLER                  PIC  X(6)     VALUE SPACE.       04250000
042600     05  FILLER                  PIC  X(5)     VALUE 'PRICE'.     04260000
042700     05  FILLER                  PIC  X(5)     VALUE SPACE.       04270000
042800     05  FILLER                  PIC  X(5)     VALUE 'PRICE'.     04280000
042900     05  FILLER                  PIC  X(7)     VALUE SPACE.       04290000
043000     05  FILLER                  PIC  X(3)     VALUE 'QTY'.       04300000
043100     05  FILLER                  PIC  X(2)     VALUE SPACE.       04310000
043200     05  FILLER                  PIC  X(5)     VALUE 'STORE'.     04320000
043300     05  FILLER                  PIC  X(4)     VALUE SPACE.       04330000
043400     05  FILLER                  PIC  X(14)    VALUE              04340000
043500                                                 'STR    QTY    '.04350000
043600     05  FILLER                  PIC  X(14)    VALUE              04360000
043700                                                 'STR    QTY    '.04370000
043800     05  FILLER                  PIC  X(14)    VALUE              04380000
043900                                                 'STR    QTY    '.04390000
044000     05  FILLER                  PIC  X(14)    VALUE              04400000
044100                                                 'STR    QTY    '.04410000
044200     05  FILLER                  PIC  X(14)    VALUE              04420000
044300                                                 'STR    QTY    '.04430000
044400     05  FILLER                  PIC  X(14)    VALUE              04440000
044500                                                 'STR    QTY    '.04450000
044600     05  FILLER                  PIC  X(14)    VALUE              04460000
044700                                                 'STR    QTY    '.04470000
044800                                                                  04480000
044900 01  DRL-IDX-MAX                 PIC S9(4)     VALUE +7    COMP   04490000
045000                                                           SYNC.  04500000
045100 01  DRL-DTL-RPT-LINE                          VALUE SPACE.       04510000
045200     05  DRL-HEADER-DATA.                                         04520000
045300         10  DRL-MONTH             PIC X(2).                      04530000
045400         10  DRL-DATE-SLASH1       PIC X.                         04540000
045500         10  DRL-DAY               PIC X(2).                      04550000
045600         10  DRL-DATE-SLASH2       PIC X.                         04560000
045700         10  DRL-YEAR              PIC X(2).                      04570000
045800         10  FILLER                PIC X.                         04580000
045900         10  DRL-PO-NMBR           PIC X(8).                      04590000
046000         10  FILLER                PIC X(2).                      04600000
046100         10  DRL-SKU               PIC X(8).                      04610000
046200         10  FILLER                PIC X(2).                      04620000
046300         10  DRL-DEPT              PIC ZZZ9.                      04630000
046400         10  FILLER                PIC X(1).                      04640000
046500         10  DRL-CLASS             PIC ZZZ9.                      04650000
046600         10  FILLER                PIC X(1).                      04660000
046700         10  DRL-SUBCLASS          PIC ZZZ9.                      04670000
046800         10  FILLER                PIC X(2).                      04680000
046900         10  DRL-UNIT-PRICE        PIC ZZ,ZZ9.99.                 04690000
047000         10  DRL-UNIT-PRICE-X      REDEFINES                      04700000
047100             DRL-UNIT-PRICE        PIC X(9).                      04710000
047200         10  FILLER                PIC X.                         04720000
047300         10  DRL-EXT-PRICE         PIC ZZZ,ZZ9.99.                04730000
047400         10  DRL-EXT-PRICE-X       REDEFINES                      04740000
047500             DRL-EXT-PRICE         PIC X(10).                     04750000
047600         10  FILLER                PIC X.                         04760000
047700         10  DRL-TOTAL-QTY         PIC Z,ZZZ,ZZ9.                 04770000
047800         10  DRL-TOTAL-QTY-X       REDEFINES                      04780000
047900             DRL-TOTAL-QTY         PIC X(9).                      04790000
048000         10  FILLER                PIC X(2).                      04800002
048100         10  DRL-FROM-STORE-NBR    PIC 9(4).                      04810000
048200         10  FILLER                PIC X(4).                      04820002
048300     05  DRL-STORE-DATA            OCCURS 7                       04830000
048400                                   INDEXED BY DRL-IDX.            04840000
048500         10  DRL-STORE-NBR         PIC 9(4).                      04850000
048600         10  FILLER                PIC X.                         04860000
048700         10  DRL-STORE-QTY-DASH    PIC X.                         04870000
048800         10  FILLER                PIC X.                         04880000
048900         10  DRL-STORE-QTY         PIC ZZZZ9.                     04890000
049000         10  DRL-STORE-QTY-X       REDEFINES                      04900000
049100             DRL-STORE-QTY         PIC X(5).                      04910000
049200         10  FILLER                PIC X(2).                      04920000
049300     05  DRL-ERROR-MESSAGE         PIC X(20).                     04930000
049400                                                                  04940000
049500 01  DTH1-DTL-RPT-TOTAL-HEADING-1.                                04950000
049600     05  FILLER                  PIC  X(50)    VALUE SPACE.       04960000
049700     05  FILLER                  PIC  X(4)     VALUE 'UNIT'.      04970000
049800     05  FILLER                  PIC  X(12)    VALUE SPACE.       04980000
049900     05  FILLER                  PIC  X(3)     VALUE 'EXT'.       04990000
050000     05  FILLER                  PIC  X(9)     VALUE SPACE.       05000000
050100     05  FILLER                  PIC  X(5)     VALUE 'TOTAL'.     05010000
050200                                                                  05020000
050300 01  DTH2-DTL-RPT-TOTAL-HEADING-2.                                05030000
050400     05  FILLER                  PIC  X(49)    VALUE SPACE.       05040000
050500     05  FILLER                  PIC  X(5)     VALUE 'PRICE'.     05050000
050600     05  FILLER                  PIC  X(11)    VALUE SPACE.       05060000
050700     05  FILLER                  PIC  X(5)     VALUE 'PRICE'.     05070000
050800     05  FILLER                  PIC  X(9)     VALUE SPACE.       05080000
050900     05  FILLER                  PIC  X(3)     VALUE 'QTY'.       05090000
051000                                                                  05100000
051100 01  DRT-DTL-RPT-TOTAL-LINE.                                      05110000
051200     05  FILLER                  PIC  X(04)    VALUE ' ** '.      05120000
051300     05  DRT-BT-BATCH-INFO.                                       05130000
051400         10  DRT-BT-BATCH-LIT    PIC  X(05).                      05140000
051500         10  FILLER              PIC  X.                          05150000
051600         10  DRT-BT-BATCH-NMBR   PIC  X(04).                      05160000
051700         10  FILLER              PIC  X.                          05170000
051800         10  DRT-BT-TOTAL-LIT    PIC  X(05).                      05180000
051900         10  FILLER              PIC  X(20).                      05190000
052000     05  DRT-DC-INFO             REDEFINES                        05200000
052100         DRT-BT-BATCH-INFO.                                       05210000
052200         10  DRT-DC-STORE-NMBR   PIC  9(04).                      05220000
052300         10  FILLER              PIC  X.                          05230000
052400         10  DRT-DC-DASH         PIC  X.                          05240000
052500         10  FILLER              PIC  X.                          05250000
052600         10  DRT-DC-CHAR10-ABBR-NAME                              05260000
052700                                 PIC  X(10).                      05270000
052800         10  FILLER              PIC  X(19).                      05280000
052900     05  DRT-GT-GTOT-INFO        REDEFINES                        05290000
053000         DRT-BT-BATCH-INFO.                                       05300000
053100         10  FILLER              PIC  X(02).                      05310000
053200         10  DRT-GT-GTOT-LIT     PIC  X(11).                      05320000
053300         10  FILLER              PIC  X(23).                      05330000
053400     05  DRT-UNIT-PRICE          PIC  ZZZ,ZZZ,ZZZ.99.             05340000
053500     05  FILLER                  PIC  X(2)     VALUE SPACE.       05350000
053600     05  DRT-EXT-PRICE           PIC  ZZZ,ZZZ,ZZZ.99.             05360000
053700     05  FILLER                  PIC  X(2)     VALUE SPACE.       05370000
053800     05  DRT-TOTAL-QTY           PIC  ZZZ,ZZZ,ZZ9.                05380000
053900*                                                                 05390000
054000*-----------------------------------------------------------------05400000
054100* THE FOLLOWING TABLE CONTAINS ALL VALID RECEIVING STORES.        05410000
054200*-----------------------------------------------------------------05420000
054300 01  VRS-IDX-MAX                 PIC S9(4)     VALUE +2500 COMP   05430007
054400                                                           SYNC.  05440000
054500 01  VRS-VALID-RECV-STORE-TBL.                                    05450000
054600     05  VRS-VALID-RECV-STORE-TBL-ENTRY                           05460000
054700                                 OCCURS 2500                      05470007
054800                                 INDEXED BY VRS-IDX.              05480000
054900         10  VRS-STORE-NMBR      PIC  9(4).                       05490000
055000         10  VRS-RCT-START-DATE  PIC  X(10).                      05500000
055100         10  VRS-RCT-STOP-DATE   PIC  X(10).                      05510000
055400         10  VRS-CHAR10-ABBR-NAME                                 05540000
055500                                 PIC  X(10).                      05550000
055600         10  VRS-TYPE-CODE       PIC  X(2).                       05560000
055700                                                                  05570000
057100*-----------------------------------------------------------------05710000
057200* THE FOLLOWING TABLE CONTAINS AN ERROR INDICATOR AND MESSAGE FOR 05720000
057300* EACH ERROR THAT CAN OCCUR.                                      05730000
057400*                                                                 05740000
057500* THE OCCURS CLAUSE ON THIS TABLE MUST BE KEPT IN SYNC WITH THE   05750000
057600* VALUE OF EIT-IDX-MAX AND WITH THE OCCURS CLAUSE IN THE ERROR    05760000
057700* MESSAGE TABLE.                                                  05770000
057800*-----------------------------------------------------------------05780000
057900                                                                  05790000
058000 01  EIT-IDX-MAX                 PIC S9(4)     VALUE +14   COMP   05800000
058100                                                           SYNC.  05810000
058200 01  EI-ERROR-INDICATORS.                                         05820000
058300                                                                  05830000
058400     05  EI-DUP-RECV-STORE-SW         PIC X         VALUE SPACE.  05840000
058500         88  EI-DUP-RECV-STORE                      VALUE 'Y'.    05850000
058600     05  FILLER                       PIC X(20)     VALUE         05860000
058700                                           'DUP RECEIVING STORE '.05870000
058800                                                                  05880000
058900     05  EI-INVALID-STORE-QTY-SW      PIC X         VALUE SPACE.  05890000
059000         88  EI-INVALID-STORE-QTY                   VALUE 'Y'.    05900000
059100     05  FILLER                       PIC X(20)     VALUE         05910000
059200                                           'INVALID STORE QTY   '.05920000
059300                                                                  05930000
059400     05  EI-STORE-QTY-EXCEEDS-MAX-SW  PIC X         VALUE SPACE.  05940000
059500         88  EI-STORE-QTY-EXCEEDS-MAX               VALUE 'Y'.    05950000
059600     05  FILLER                       PIC X(20)     VALUE         05960000
059700                                           'STORE QTY > 999     '.05970000
059800                                                                  05980000
059900     05  EI-INVALID-TOTAL-QTY-SW      PIC X         VALUE SPACE.  05990000
060000         88  EI-INVALID-TOTAL-QTY                   VALUE 'Y'.    06000000
060100     05  FILLER                       PIC X(20)     VALUE         06010000
060200                                           'INVALID TOTAL QTY   '.06020000
060300                                                                  06030000
060400     05  EI-INVALID-UNIT-PRICE-SW     PIC X         VALUE SPACE.  06040000
060500         88  EI-INVALID-UNIT-PRICE                  VALUE 'Y'.    06050000
060600     05  FILLER                       PIC X(20)     VALUE         06060000
060700                                           'INVALID UNIT PRICE  '.06070000
060800                                                                  06080000
060900     05  EI-UNIT-PRICE-EXCEEDS-MAX-SW PIC X         VALUE SPACE.  06090000
061000         88  EI-UNIT-PRICE-EXCEEDS-MAX              VALUE 'Y'.    06100000
061100     05  FILLER                       PIC X(20)     VALUE         06110000
061200                                           'UNIT PRICE>99999.99 '.06120016
061300                                                                  06130000
061400     05  EI-EXT-PRICE-EXCEEDS-MAX-SW PIC X          VALUE SPACE.  06140000
061500         88  EI-EXT-PRICE-EXCEEDS-MAX               VALUE 'Y'.    06150000
061600     05  FILLER                       PIC X(20)     VALUE         06160000
061700                                           'EXT PRICE OVERFLOW  '.06170000
061800                                                                  06180000
061900     05  EI-INVALID-DC-SW             PIC X         VALUE SPACE.  06190000
062000         88  EI-INVALID-DC                          VALUE 'Y'.    06200000
062100     05  FILLER                       PIC X(20)     VALUE         06210000
062200                                           'INVALID FROM STORE  '.06220000
062300                                                                  06230000
062400     05  EI-INVALID-RECV-STORE-SW     PIC X         VALUE SPACE.  06240000
062500         88  EI-INVALID-RECV-STORE                  VALUE 'Y'.    06250000
062600     05  FILLER                       PIC X(20)     VALUE         06260000
062700                                           'INVALID RECV STORE  '.06270000
062800                                                                  06280000
062900     05  EI-INVALID-FILLED-DATE-SW    PIC X         VALUE SPACE.  06290000
063000         88  EI-INVALID-FILLED-DATE                 VALUE 'Y'.    06300000
063100     05  FILLER                       PIC X(20)     VALUE         06310000
063200                                           'INVALID FILLED DATE '.06320000
063300                                                                  06330000
063400     05  EI-NOT-IN-RCT-DATE-RANGE-SW  PIC X         VALUE SPACE.  06340000
063500         88  EI-NOT-IN-RCT-DATE-RANGE               VALUE 'Y'.    06350000
063600     05  FILLER                       PIC X(20)     VALUE         06360000
063700                                           'NOT IN RCPT DT RANGE'.06370000
063800                                                                  06380000
063900     05  EI-INVALID-RENUM-SKU-SW      PIC X         VALUE SPACE.  06390000
064000         88  EI-INVALID-RENUM-SKU                   VALUE 'Y'.    06400000
064100     05  FILLER                       PIC X(20)     VALUE         06410000
064200                                           'INVALID RENUM SKU   '.06420000
064300                                                                  06430000
064400     05  EI-INVALID-SKU-DEPT-CLASS-SW PIC X         VALUE SPACE.  06440000
064500         88  EI-INVALID-SKU-DEPT-CLASS              VALUE 'Y'.    06450000
064600     05  FILLER                       PIC X(20)     VALUE         06460000
064700                                           'INVALID DEPT/CLASS  '.06470000
064800                                                                  06480000
064900     05  EI-QTY-IMBALANCE-SW          PIC X         VALUE SPACE.  06490000
065000         88  EI-QTY-IMBALANCE                       VALUE 'Y'.    06500000
065100     05  FILLER                       PIC X(20)     VALUE         06510000
065200                                           'QTY IMBALANCE       '.06520000
065300                                                                  06530000
065400 01  EIT-ERROR-INDICATOR-TBL          REDEFINES                   06540000
065500     EI-ERROR-INDICATORS.                                         06550000
065600     05  EIT-ERROR-INDICATOR-TBL-ENTRY                            06560000
065700                                      OCCURS 14                   06570000
065800                                      INDEXED BY EIT-IDX.         06580000
065900         10  EIT-ERROR-INDICATOR      PIC X.                      06590000
066000             88  EIT-ERROR-INDICATOR-ON             VALUE 'Y'.    06600000
066100         10  EIT-ERROR-MESSAGE        PIC X(20).                  06610000
066200                                                                  06620000
066300*-----------------------------------------------------------------06630000
066400* THE FOLLOWING TABLE CONTAINS ALL THE ERROR MESSAGES THAT APPLY  06640000
066500* TO THE TRANSFER BEING PROCESSED.                                06650000
066600*                                                                 06660000
066700* THE OCCURS CLAUSE ON THIS TABLE MUST BE KEPT IN SYNC WITH THE   06670000
066800* VALUE OF EMT-IDX-MAX AND WITH THE OCCURS CLAUSE IN THE ERROR    06680000
066900* INDICATOR TABLE.                                                06690000
067000*-----------------------------------------------------------------06700000
067100 01  EMT-IDX-MAX                 PIC S9(4)     VALUE +14   COMP   06710000
067200                                                           SYNC.  06720000
067300 01  EMT-ERROR-MESSAGE-TBL.                                       06730000
067400     05  EMT-ERROR-MESSAGE-TBL-ENTRY OCCURS 14                    06740000
067500                                     INDEXED BY EMT-IDX.          06750000
067600         10  EMT-ERROR-MESSAGE     PIC X(20).                     06760000
067700                                                                  06770000
067800*-----------------------------------------------------------------06780000
067900* THE FOLLOWING TABLE IS USED TO ACCUMULATE BATCH AND GRAND TOTALS06790000
068000* BY DC.                                                          06800000
068100*-----------------------------------------------------------------06810000
068200 01  DCT-IDX-MAX                 PIC S9(4)     VALUE +500  COMP   06820000
068300                                                           SYNC.  06830000
068400 01  DCT-DC-TOTAL-TBL.                                            06840000
068500     05  DCT-DC-TOTAL-TBL-ENTRY                                   06850000
068600                                 OCCURS 500                       06860000
068700                                 INDEXED BY DCT-IDX.              06870000
068800         10  DCT-STORE-NMBR      PIC  9(4).                       06880000
068900         10  DCT-PRINT-DC-SW     PIC  X.                          06890000
069000             88  DCT-PRINT-DC                  VALUE 'Y'.         06900000
069100         10  DCT-BTOT-UNIT-PRICE PIC  S9(9)V99 COMP-3.            06910000
069200         10  DCT-BTOT-EXT-PRICE  PIC  S9(9)V99 COMP-3.            06920000
069300         10  DCT-BTOT-TOTAL-QTY  PIC  S9(9)    COMP-3.            06930000
069400         10  DCT-GTOT-UNIT-PRICE PIC  S9(9)V99 COMP-3.            06940000
069500         10  DCT-GTOT-EXT-PRICE  PIC  S9(9)V99 COMP-3.            06950000
069600         10  DCT-GTOT-TOTAL-QTY  PIC  S9(9)    COMP-3.            06960000
069700                                                                  06970000
069800*-----------------------------------------------------------------06980000
069900* THE FOLLOWING AREA CONTAINS ALL THE HEADER (CONTROL BREAK) INFO 06990000
070000* FOR THE TRANSFER BEING PROCESSED.                               07000000
070100*-----------------------------------------------------------------07010000
070200 01  PREV-XFER-BREAK-FIELDS                    VALUE SPACE.       07020000
070300     05  PREV-BATCH-NMBR         PIC 9(04).                       07030000
070400     05  FILLER                  REDEFINES                        07040000
070500         PREV-BATCH-NMBR.                                         07050000
070600         10  FILLER              PIC X.                           07060000
070700         10  PREV-BATCH-NMBR-LAST3                                07070000
070800                                 PIC X(3).                        07080000
070900     05  PREV-LINE-NMBR          PIC 9(02).                       07090000
071000     05  PREV-SKU-NMBR           PIC 9(08).                       07100000
071100     05  PREV-SKU REDEFINES PREV-SKU-NMBR.                        07110000
071200         10 FILLER               PIC X(08).                       07120000
071300     05  PREV-REQ-NMBR           PIC 9(08).                       07130000
071400     05  FILLER                  REDEFINES                        07140000
071500         PREV-REQ-NMBR.                                           07150000
071600         10  FILLER              PIC X(3).                        07160000
071700         10  PREV-REQ-NMBR-LAST5 PIC X(5).                        07170000
071800     05  PREV-FILLED-DATE-MMDDYY.                                 07180000
071900         10  PREV-FILLED-DATE-MMDDYY-MM                           07190000
072000                                 PIC 9(02).                       07200000
072100         10  PREV-FILLED-DATE-MMDDYY-DD                           07210000
072200                                 PIC 9(02).                       07220000
072300         10  PREV-FILLED-DATE-MMDDYY-YY                           07230000
072400                                 PIC 9(02).                       07240000
072500     05  PREV-DC-STORE-NMBR      PIC 9(04).                       07250000
072600     05  PREV-TOTAL-QTY          PIC 9(07).                       07260000
072700     05  PREV-TOTAL-QTY-X        REDEFINES                        07270000
072800         PREV-TOTAL-QTY          PIC X(7).                        07280000
072900     05  PREV-UNIT-PRICE         PIC 9(05)V99.                    07290000
073000     05  PREV-UNIT-PRICE-X       REDEFINES                        07300000
073100         PREV-UNIT-PRICE         PIC X(7).                        07310000
073200                                                                  07320000
073300*-----------------------------------------------------------------07330000
073400* THE FOLLOWING TABLE CONTAINS ALL THE RECEIVING STORE INFO FOR   07340000
073500* THE TRANSFER BEING PROCESSED.                                   07350000
073600*-----------------------------------------------------------------07360000
073700 01  XRS-IDX-MAX                 PIC S9(4)     VALUE +2500 COMP   07370007
073800                                                           SYNC.  07380000
073900 01  XRS-XFER-RECV-STORE-TBL.                                     07390000
074000     05  XRS-XFER-RECV-STORE-TBL-ENTRY OCCURS 2500                07400007
074100                                   INDEXED BY XRS-IDX.            07410000
074200         10  XRS-RECV-STORE-FIELDS.                               07420000
074300             15  XRS-STORE-NMBR        PIC 9(04).                 07430000
074400             15  XRS-STORE-QTY         PIC 9(05).                 07440000
074500             15  XRS-STORE-QTY-X       REDEFINES                  07450000
074600                 XRS-STORE-QTY         PIC X(05).                 07460000
074700                                                                  07470000
074800*-----------------------------------------------------------------07480000
074900*  CALENDAR ROUTINE WORKING STORAGE                               07490000
075000*-----------------------------------------------------------------07500000
075100     COPY DPWS500.                                                07510000
075200                                                                  07520000
075300*-----------------------------------------------------------------07530000
075400*  ABEND ROUTINE WORKING STORAGE                                  07540000
075500*-----------------------------------------------------------------07550000
075600     COPY DPWS004.                                                07560000
075700                                                                  07570000
075800 01  ABEND-CODE                  PIC S9(04)    COMP SYNC VALUE +0.07580000
075900                                                                  07590000
076000*-----------------------------------------------------------------07600000
076100*  LOCATION MASTER TABLE                                          07610000
076200*-----------------------------------------------------------------07620000
076300                                                                  07630000
076400     EXEC SQL                                                     07640000
076500        INCLUDE XLT00010                                          07650000
076600     END-EXEC.                                                    07660000
076700                                                                  07670000
076800*-----------------------------------------------------------------07680000
076900* RECEIVING STORE CURSOR - SELECT ALL STORES THAT ARE ELIGIBLE TO 07690000
077000*                          RECEIVE CENTRAL STOCK DISTRIBUTIONS.   07700000
077100*-----------------------------------------------------------------07710000
077200                                                                  07720000
077300     EXEC SQL                                                     07730000
077400        DECLARE RECV-STORE-CSR CURSOR FOR                         07740000
077600          SELECT A.LOC_NBR                                        07760000
077700               , A.OPN_DTE                                        07770000
077800               , A.CLO_DTE                                        07780000
077900               , COALESCE(A.OPN_DTE - STRT_ORD_DAYS_QTY DAYS,     07790000
078000                          A.OPN_DTE)                              07800000
078100               , COALESCE(A.CLO_DTE - STP_ORD_DAYS_QTY DAYS,      07810000
078200                          A.CLO_DTE)                              07820000
078210               , A.LOC_10_ABBR_NM                                 07821000
078300               , A.LOC_TYP_CDE                                    07830000
078400            FROM XLT_LOC A                                        07840000
078500           WHERE A.LOC_TYP_CDE IN ('DS', 'CS', 'DC', 'RV')        07850000
078510             AND (A.FINCL_CLO_DTE > CURRENT DATE                  07851000
078520              OR A.FINCL_CLO_DTE IS NULL)                         07852000
078600           ORDER BY A.LOC_NBR                                     07860000
080700     END-EXEC.                                                    08070000
080800                                                                  08080000
082600*-----------------------------------------------------------------08260000
082700*  DB2 COMMUNICATION AREA                                         08270000
082800*-----------------------------------------------------------------08280000
082900                                                                  08290000
083000     EXEC SQL                                                     08300000
083100        INCLUDE SQLCA                                             08310000
083200     END-EXEC.                                                    08320000
083300                                                                  08330000
083400*-----------------------------------------------------------------08340000
083500*  DB2 COMMUNICATION AREA 2                                       08350000
083600*-----------------------------------------------------------------08360000
083700     COPY SQLCA2.                                                 08370000
083800                                                                  08380000
083900******************************************************************08390000
084000 PROCEDURE DIVISION.                                              08400000
084100******************************************************************08410000
084200                                                                  08420000
084300 A000-MAIN-DRIVER.                                                08430000
084400                                                                  08440000
084500     PERFORM B050-INITIALIZATION.                                 08450000
084600                                                                  08460000
084700     OPEN INPUT  CENTRAL-STK-XFER-FILE                            08470000
084800          OUTPUT MERCHANDISE-LEDGER-FILE                          08480000
084900                 SKU-RECEIPTS-FILE                                08490000
085000                 SKU-ADJUST-FILE                                  08500000
085100                 CENTRAL-STK-ERROR-REPORT                         08510000
085200                 CENTRAL-STK-DETAIL-REPORT.                       08520000
085300                                                                  08530000
085400     PERFORM Z100-READ-CENTRAL-STK-XFER.                          08540000
085500                                                                  08550000
085600     IF PS-END-OF-CENTRAL-STK-XFERS                               08560000
085700         PERFORM Z140-WRITE-ERR-RPT-HEADINGS                      08570000
085800         PERFORM Z170-WRITE-DTL-RPT-HEADINGS                      08580000
085900     ELSE                                                         08590000
086000         PERFORM Z140-WRITE-ERR-RPT-HEADINGS                      08600000
086100         PERFORM Z145-WRITE-ERR-COL-HEADINGS                      08610000
086200         PERFORM C100-START-NEW-BATCH                             08620000
086300         PERFORM C200-START-NEW-XFER                              08630000
086400         PERFORM B100-PROCESS-CENTRAL-STK-XFERS                   08640000
086500             UNTIL PS-END-OF-CENTRAL-STK-XFERS                    08650000
086600                                                                  08660000
086700         PERFORM C400-XFER-BREAK                                  08670000
086800         PERFORM C500-BATCH-BREAK                                 08680000
086900         PERFORM B200-FINAL-BREAK                                 08690000
087000     END-IF.                                                      08700000
087100                                                                  08710000
087200     WRITE CENTRAL-STK-ERR-RPT-LINE                               08720000
087300      FROM PC-END-OF-RPT-LINE                                     08730000
087400         AFTER ADVANCING 3 LINES.                                 08740000
087500                                                                  08750000
087600     WRITE CENTRAL-STK-DTL-RPT-LINE                               08760000
087700      FROM PC-END-OF-RPT-LINE                                     08770000
087800         AFTER ADVANCING 3 LINES.                                 08780000
087900                                                                  08790000
088000     PERFORM B300-DISPLAY-RECORD-COUNTS.                          08800000
088100                                                                  08810000
088200     CLOSE CENTRAL-STK-XFER-FILE                                  08820000
088300           MERCHANDISE-LEDGER-FILE                                08830000
088400           SKU-RECEIPTS-FILE                                      08840000
088500           SKU-ADJUST-FILE                                        08850000
088600           CENTRAL-STK-ERROR-REPORT                               08860000
088700           CENTRAL-STK-DETAIL-REPORT.                             08870000
088800                                                                  08880000
088900     GOBACK.                                                      08890000
089000                                                                  08900000
089100 B050-INITIALIZATION.                                             08910000
089200                                                                  08920000
089300*    *------------------------------------------------------------08930000
089400*    * GET THE CURRENT DATE.                                      08940000
089500*    *------------------------------------------------------------08950000
089600                                                                  08960000
089700     ACCEPT DPG51-SYSTEM-DATE FROM DATE.                          08970000
089800     SET DPG51-ACTUAL-CALENDAR-ONLY   TO TRUE.                    08980000
089900     MOVE DPG51-SYSTEM-DATE-YR        TO PV-DATE-MMDDYY-YY.       08990000
090000     MOVE DPG51-SYSTEM-DATE-MO        TO PV-DATE-MMDDYY-MM.       09000000
090100     MOVE DPG51-SYSTEM-DATE-DY        TO PV-DATE-MMDDYY-DD.       09010000
090200     MOVE PV-DATE-MMDDYY              TO DPG52-LK-DATE-INPUT.     09020000
090300     SET  DPG52-LK-DTE-GREG           TO TRUE.                    09030000
090400                                                                  09040000
090500     CALL PC-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53             09050000
090600                                    DPG54 DPG55 DPG56.            09060000
090700                                                                  09070000
090800     EVALUATE TRUE                                                09080000
090900         WHEN DPG54-SEVERE-ERROR                                  09090000
091000             DISPLAY '** ABEND **'                                09100000
091100             DISPLAY '** PGM = CEKUT001'                          09110000
091200             DISPLAY '** PARAGRAPH = B050-INITIALIZATION'         09120000
091300             DISPLAY '** INVALID RETURN FROM CALENDAR ROUTINE. '  09130000
091400             DISPLAY '** ERROR MESSAGE = ' DPG54-ERROR-MESSAGE    09140000
091500             DISPLAY '** DPG51 = ' DPG51                          09150000
091600             DISPLAY '** DPG52 = ' DPG52                          09160000
091700             DISPLAY '** DPG53 = ' DPG53                          09170000
091800             DISPLAY '** DPG54 = ' DPG54                          09180000
091900             MOVE +4003 TO ABEND-CODE                             09190000
092000             CALL 'ILBOABN0' USING ABEND-CODE                     09200000
092100         WHEN OTHER                                               09210000
092200             MOVE DPG55-DB2-ISO-DATE-FMT                          09220000
092300                                    TO CD-CURRENT-DATE-ISO-FMT    09230000
092400     END-EVALUATE.                                                09240000
092500                                                                  09250000
092600                                                                  09260000
092700*    *------------------------------------------------------------09270000
092800*    * BUILD THE VALID RECEIVING STORE TABLE.                     09280000
092900*    *------------------------------------------------------------09290000
093000                                                                  09300000
093100     INITIALIZE VRS-VALID-RECV-STORE-TBL.                         09310000
093200                                                                  09320000
093300     PERFORM Z800-OPEN-RECV-STORE-CSR.                            09330000
093400     PERFORM Z810-FETCH-RECV-STORE-CSR.                           09340000
093500                                                                  09350000
093600     PERFORM VARYING VRS-IDX FROM 1 BY 1                          09360000
093700             UNTIL PS-NO-MORE-RECV-STORES                         09370000
093800             OR    VRS-IDX > VRS-IDX-MAX                          09380000
093900                                                                  09390000
094000         MOVE XLT00010-LOC-NBR                                    09400000
094100                                  TO VRS-STORE-NMBR     (VRS-IDX) 09410000
094200         MOVE PV-RCT-START-DTE                                    09420000
094300                                  TO VRS-RCT-START-DATE (VRS-IDX) 09430000
094400         MOVE PV-RCT-STOP-DTE                                     09440000
094500                                  TO VRS-RCT-STOP-DATE  (VRS-IDX) 09450000
095000         MOVE XLT00010-LOC-10-ABBR-NM                             09500000
095100                                 TO VRS-CHAR10-ABBR-NAME (VRS-IDX)09510000
095200         MOVE XLT00010-LOC-TYP-CDE                                09520000
095300                                 TO VRS-TYPE-CODE        (VRS-IDX)09530000
095400         PERFORM Z810-FETCH-RECV-STORE-CSR                        09540000
095500     END-PERFORM.                                                 09550000
095600                                                                  09560000
095700     IF VRS-IDX > VRS-IDX-MAX                                     09570000
095800         MOVE +4004 TO ABEND-CODE                                 09580000
095900         DISPLAY '**  ABEND     **'                               09590000
096000         DISPLAY '**  PROGRAM   **  =  CEKUT001'                  09600000
096100         DISPLAY '**  PARAGRAPH **  =  B050-INITIALIZATION'       09610000
096200         DISPLAY                                                  09620000
096300             '**  TBL OVERFLOW ON VRS-VALID-RECV-STORE-TBL  **'   09630000
096400         CALL 'ILBOABN0' USING ABEND-CODE                         09640000
096500     END-IF.                                                      09650000
096600                                                                  09660000
096700     PERFORM Z820-CLOSE-RECV-STORE-CSR.                           09670000
096800                                                                  09680000
096900*    *------------------------------------------------------------09690000
097000*    * BUILD THE VALID DC TABLE.                                  09700000
097100*    *------------------------------------------------------------09710000
097200*                                                                 09720000
097500                                                                  09750000
097600*    *------------------------------------------------------------09760000
097700*    * INTITIALIZE THE DC TOTAL TABLE.                            09770000
097800*    *------------------------------------------------------------09780000
097900                                                                  09790000
098000     INITIALIZE DCT-DC-TOTAL-TBL.                                 09800000
098100                                                                  09810000
098200*    *------------------------------------------------------------09820000
098300*    * BUILD THE STANDARD REPORT HEADING.                         09830000
098400*    *------------------------------------------------------------09840000
098500                                                                  09850000
098600     MOVE CD-CURRENT-DATE-ISO-FMT-YY   TO DP200O-RUN-YEAR.        09860000
098700     MOVE CD-CURRENT-DATE-ISO-FMT-MM   TO DP200O-RUN-MONTH.       09870000
098800     MOVE CD-CURRENT-DATE-ISO-FMT-DD   TO DP200O-RUN-DAY.         09880000
098900                                                                  09890000
099000     ACCEPT ST-SYSTEM-TIME             FROM TIME.                 09900000
099100     MOVE ST-SYSTEM-HOUR               TO DP200O-RUN-HOUR.        09910000
099200     MOVE ST-SYSTEM-MINUTE             TO DP200O-RUN-MINUTE.      09920000
099300                                                                  09930000
099400     MOVE 'CEKUT001'                   TO DP200O-PROGRAM-NAME.    09940000
099500                                                                  09950000
099600 B100-PROCESS-CENTRAL-STK-XFERS.                                  09960000
099700                                                                  09970000
099800     IF CE004-BATCH-NMBR NOT = PREV-BATCH-NMBR                    09980000
099900         PERFORM C400-XFER-BREAK                                  09990000
100000         PERFORM C500-BATCH-BREAK                                 10000000
100100         PERFORM C100-START-NEW-BATCH                             10010000
100200         PERFORM C200-START-NEW-XFER                              10020000
100300     ELSE                                                         10030000
100400         IF CE004-XFER-BREAK-FIELDS NOT = PREV-XFER-BREAK-FIELDS  10040000
100500             PERFORM C400-XFER-BREAK                              10050000
100600             PERFORM C200-START-NEW-XFER                          10060000
100700         END-IF                                                   10070000
100800     END-IF.                                                      10080000
100900                                                                  10090000
101000*    *------------------------------------------------------------10100000
101100*    * PROCESS THE CURRENT TRANSFER RECORD.                       10110000
101200*    *------------------------------------------------------------10120000
101300                                                                  10130000
101400     PERFORM C300-PROCESS-XFER-RECORD.                            10140000
101500                                                                  10150000
101600     PERFORM Z100-READ-CENTRAL-STK-XFER.                          10160000
101700                                                                  10170000
101800 B200-FINAL-BREAK.                                                10180000
101900                                                                  10190000
102000     MOVE 'ALL'              TO DH1-BATCH-NMBR.                   10200000
102100     PERFORM Z170-WRITE-DTL-RPT-HEADINGS.                         10210000
102200     PERFORM Z193-WRITE-DTL-TOT-HEADINGS.                         10220000
102300                                                                  10230000
102400     MOVE SPACE              TO DRT-GT-GTOT-INFO.                 10240000
102500     MOVE 'GRAND TOTAL'      TO DRT-GT-GTOT-LIT.                  10250000
102600     MOVE PV-GTOT-UNIT-PRICE TO DRT-UNIT-PRICE.                   10260000
102700     MOVE PV-GTOT-EXT-PRICE  TO DRT-EXT-PRICE.                    10270000
102800     MOVE PV-GTOT-TOTAL-QTY  TO DRT-TOTAL-QTY.                    10280000
102900                                                                  10290000
103000     PERFORM Z195-WRITE-DTL-RPT-TOTAL-LINE.                       10300000
103100                                                                  10310000
103200     MOVE SPACE   TO DRT-DC-INFO.                                 10320000
103300     MOVE PC-DASH TO DRT-DC-DASH.                                 10330000
103400                                                                  10340000
103500     PERFORM VARYING DCT-IDX FROM 1 BY 1                          10350000
103600       UNTIL DCT-IDX > DCT-IDX-MAX                                10360000
103700          OR DCT-STORE-NMBR (DCT-IDX) = ZERO                      10370000
103800         MOVE DCT-STORE-NMBR (DCT-IDX)  TO DRT-DC-STORE-NMBR      10380000
103900                                                                  10390000
104000         SET VRS-IDX TO +1                                        10400000
104100         SEARCH VRS-VALID-RECV-STORE-TBL-ENTRY                    10410000
104200             AT END                                               10420000
104300                 MOVE SPACE             TO DRT-DC-CHAR10-ABBR-NAME10430000
104400                                                                  10440000
104500             WHEN VRS-STORE-NMBR (VRS-IDX) = ZERO                 10450000
104600                 MOVE SPACE             TO DRT-DC-CHAR10-ABBR-NAME10460000
104700                                                                  10470000
104800             WHEN VRS-STORE-NMBR (VRS-IDX)                        10480000
104900                                    = DCT-STORE-NMBR (DCT-IDX)    10490000
105000                 MOVE VRS-CHAR10-ABBR-NAME (VRS-IDX)              10500000
105100                                        TO DRT-DC-CHAR10-ABBR-NAME10510000
105200         END-SEARCH                                               10520000
105300                                                                  10530000
105400         MOVE DCT-GTOT-UNIT-PRICE (DCT-IDX)                       10540000
105500                                        TO DRT-UNIT-PRICE         10550000
105600         MOVE DCT-GTOT-EXT-PRICE  (DCT-IDX)                       10560000
105700                                        TO DRT-EXT-PRICE          10570000
105800         MOVE DCT-GTOT-TOTAL-QTY  (DCT-IDX)                       10580000
105900                                        TO DRT-TOTAL-QTY          10590000
106000         PERFORM Z195-WRITE-DTL-RPT-TOTAL-LINE                    10600000
106100     END-PERFORM.                                                 10610000
106200                                                                  10620000
106300 B300-DISPLAY-RECORD-COUNTS.                                      10630000
106400                                                                  10640000
106500     DISPLAY ' '.                                                 10650000
106600     DISPLAY 'CEKUT001 RECORD COUNTS:'.                           10660000
106700                                                                  10670000
106800     MOVE PV-STK-XFERS-READ TO PV-DISPLAY-COUNT.                  10680000
106900     DISPLAY 'INPUT RECORDS READ      = ' PV-DISPLAY-COUNT.       10690000
107000                                                                  10700000
107100     MOVE PV-MERCH-RECS-WR  TO PV-DISPLAY-COUNT.                  10710000
107200     DISPLAY 'MERCH RECORDS WRITTEN   = ' PV-DISPLAY-COUNT.       10720000
107300                                                                  10730000
107400     MOVE PV-RECEIPT-RECS-WR TO PV-DISPLAY-COUNT.                 10740000
107500     DISPLAY 'RECEIPT RECORDS WRITTEN = ' PV-DISPLAY-COUNT.       10750000
107600                                                                  10760000
107700     MOVE PV-ADJUST-RECS-WR TO PV-DISPLAY-COUNT.                  10770000
107800     DISPLAY 'ADJUSTM RECORDS WRITTEN = ' PV-DISPLAY-COUNT.       10780000
107900                                                                  10790000
108000                                                                  10800000
108100 C100-START-NEW-BATCH.                                            10810000
108200                                                                  10820000
108300     MOVE CE004-BATCH-NMBR TO DH1-BATCH-NMBR.                     10830000
108400                                                                  10840000
108500     INITIALIZE PV-BTOT-TOTAL-QTY                                 10850000
108600                PV-BTOT-UNIT-PRICE                                10860000
108700                PV-BTOT-EXT-PRICE.                                10870000
108800                                                                  10880000
108900      PERFORM VARYING DCT-IDX FROM 1 BY 1                         10890000
109000        UNTIL DCT-IDX > DCT-IDX-MAX                               10900000
109100          INITIALIZE DCT-PRINT-DC-SW     (DCT-IDX)                10910000
109200                     DCT-BTOT-TOTAL-QTY  (DCT-IDX)                10920000
109300                     DCT-BTOT-UNIT-PRICE (DCT-IDX)                10930000
109400                     DCT-BTOT-EXT-PRICE  (DCT-IDX)                10940000
109500      END-PERFORM.                                                10950000
109600                                                                  10960000
109700     PERFORM Z170-WRITE-DTL-RPT-HEADINGS.                         10970000
109800     PERFORM Z175-WRITE-DTL-COL-HEADINGS.                         10980000
109900                                                                  10990000
110000 C200-START-NEW-XFER.                                             11000000
110100                                                                  11010000
110200     MOVE CE004-XFER-BREAK-FIELDS TO PREV-XFER-BREAK-FIELDS.      11020000
110300     MOVE CE004-TRAN-CODE         TO PV-PREV-TRAN-CODE.           11030000
110400                                                                  11040000
110500     INITIALIZE XRS-XFER-RECV-STORE-TBL                           11050000
110600                EMT-ERROR-MESSAGE-TBL                             11060000
110700                PV-XFER-FIELDS.                                   11070000
110800                                                                  11080000
110900     SET PS-XFER-ERRORS-NOT-FOUND TO TRUE.                        11090000
111000                                                                  11100000
111100     PERFORM VARYING EIT-IDX FROM 1 BY 1                          11110000
111200       UNTIL EIT-IDX > EIT-IDX-MAX                                11120000
111300         INITIALIZE EIT-ERROR-INDICATOR (EIT-IDX)                 11130000
111400     END-PERFORM.                                                 11140000
111500                                                                  11150000
111600     IF PV-REC-SEQ-NBR = +999                                     11160000
111700         MOVE +1 TO PV-REC-SEQ-NBR                                11170000
111800     ELSE                                                         11180000
111900         ADD +1  TO PV-REC-SEQ-NBR                                11190000
112000     END-IF.                                                      11200000
112100                                                                  11210000
112200     PERFORM D100-XFER-LEVEL-EDITS.                               11220000
112300                                                                  11230000
112400*    *------------------------------------------------------------11240000
112500*    * FIND THE ENTRY FOR THE DC IN THE DC TOTAL TABLE. IF THE    11250000
112600*    * DC IS NOT FOUND, ADD IT TO THE TABLE.                      11260000
112700*    *------------------------------------------------------------11270000
112800                                                                  11280000
112900     SET DCT-IDX TO 1.                                            11290000
113000     SEARCH DCT-DC-TOTAL-TBL-ENTRY                                11300000
113100         AT END                                                   11310000
113200             MOVE +4004 TO ABEND-CODE                             11320000
113300             DISPLAY '**  ABEND     **'                           11330000
113400             DISPLAY '**  PROGRAM   **  =  CEKUT001'              11340000
113500             DISPLAY '**  PARAGRAPH **  =  C200-START-NEW-XFER'   11350000
113600             DISPLAY '**  TBL OVERFLOW ON DCT-DC-TOTAL-TBL  **'   11360000
113700             CALL 'ILBOABN0' USING ABEND-CODE                     11370000
113800                                                                  11380000
113900         WHEN DCT-STORE-NMBR (DCT-IDX) = PREV-DC-STORE-NMBR       11390000
114000             SET DCT-PRINT-DC (DCT-IDX) TO TRUE                   11400000
114100                                                                  11410000
114200         WHEN DCT-STORE-NMBR (DCT-IDX) = ZERO                     11420000
114300             MOVE PREV-DC-STORE-NMBR TO DCT-STORE-NMBR (DCT-IDX)  11430000
114400             SET DCT-PRINT-DC (DCT-IDX) TO TRUE                   11440000
114500     END-SEARCH.                                                  11450000
114600                                                                  11460000
114700*    *------------------------------------------------------------11470000
114800*    * ADD TO THE BATCH TOTALS AND GRAND TOTALS. ALSO, ADD TO THE 11480000
114900*    * BATCH AND GRAND TOTALS BY DC, WHICH ARE STORED IN THE DC   11490000
115000*    * TABLE.                                                     11500000
115100*    *------------------------------------------------------------11510000
115200                                                                  11520000
115300     IF PREV-UNIT-PRICE NUMERIC                                   11530000
115400         ADD PREV-UNIT-PRICE   TO PV-BTOT-UNIT-PRICE              11540000
115500                                  PV-GTOT-UNIT-PRICE              11550000
115600         ADD PREV-UNIT-PRICE   TO DCT-BTOT-UNIT-PRICE (DCT-IDX)   11560000
115700                                  DCT-GTOT-UNIT-PRICE (DCT-IDX)   11570000
115800     END-IF.                                                      11580000
115900                                                                  11590000
116000     IF PREV-TOTAL-QTY NUMERIC                                    11600000
116100         ADD PREV-TOTAL-QTY    TO PV-BTOT-TOTAL-QTY               11610000
116200                                  PV-GTOT-TOTAL-QTY               11620000
116300         ADD PREV-TOTAL-QTY    TO DCT-BTOT-TOTAL-QTY (DCT-IDX)    11630000
116400                                  DCT-GTOT-TOTAL-QTY (DCT-IDX)    11640000
116500     END-IF.                                                      11650000
116600                                                                  11660000
116700     ADD PV-XFER-EXT-PRICE TO PV-BTOT-EXT-PRICE                   11670000
116800                              DCT-BTOT-EXT-PRICE (DCT-IDX)        11680000
116900                              PV-GTOT-EXT-PRICE                   11690000
117000                              DCT-GTOT-EXT-PRICE (DCT-IDX).       11700000
117100                                                                  11710000
117200 C300-PROCESS-XFER-RECORD.                                        11720000
117300                                                                  11730000
117400     PERFORM D200-RECORD-LEVEL-EDITS.                             11740000
117500                                                                  11750000
117600*    *------------------------------------------------------------11760000
117700*    * ADD THE RECEIVING STORE TO THE TABLE OF ALL RECEIVING      11770000
117800*    * STORES FOR THE TRANSFER.                                   11780000
117900*    *------------------------------------------------------------11790000
118000                                                                  11800000
118100     SET XRS-IDX TO +1.                                           11810000
118200                                                                  11820000
118300     SEARCH XRS-XFER-RECV-STORE-TBL-ENTRY                         11830000
118400         AT END                                                   11840000
118500             MOVE +4004 TO ABEND-CODE                             11850000
118600             DISPLAY '**  ABEND     **'                           11860000
118700             DISPLAY '**  PROGRAM   **  =  CEKUT001'              11870000
118800             DISPLAY                                              11880000
118900                   '**  PARAGRAPH **  =  C300-PROCESS-XFER-RECORD'11890000
119000             DISPLAY                                              11900000
119100                 '**  TBL OVERFLOW ON XRS-XFER-RECV-STORE-TBL  **'11910000
119200             CALL 'ILBOABN0' USING ABEND-CODE                     11920000
119300                                                                  11930000
119400         WHEN XRS-STORE-NMBR (XRS-IDX) = ZERO                     11940000
119500             CONTINUE                                             11950000
119600     END-SEARCH.                                                  11960000
119700                                                                  11970000
119800     MOVE CE004-RECV-STORE-FIELDS                                 11980000
119900         TO XRS-RECV-STORE-FIELDS (XRS-IDX).                      11990000
120000                                                                  12000000
120100*    *------------------------------------------------------------12010000
120200*    * ADD TO THE STORE QTY TOTAL FOR THE TRANSFER.               12020000
120300*    *------------------------------------------------------------12030000
120400                                                                  12040000
120500     IF XRS-STORE-QTY (XRS-IDX) NUMERIC                           12050000
120600         ADD XRS-STORE-QTY  (XRS-IDX)                             12060000
120700             TO PV-XFER-STORE-QTY-TOT                             12070000
120800     END-IF.                                                      12080000
120900                                                                  12090000
121000 C400-XFER-BREAK.                                                 12100000
121100                                                                  12110000
121200     IF EI-INVALID-TOTAL-QTY                                      12120000
121300         CONTINUE                                                 12130000
121400     ELSE                                                         12140000
121500         IF PREV-TOTAL-QTY = PV-XFER-STORE-QTY-TOT                12150000
121600             CONTINUE                                             12160000
121700         ELSE                                                     12170000
121800             SET EI-QTY-IMBALANCE TO TRUE                         12180000
121900         END-IF                                                   12190000
122000     END-IF.                                                      12200000
122100                                                                  12210000
122200     PERFORM D800-TABLE-ERROR-MESSAGES.                           12220000
122300                                                                  12230000
122400     IF PS-XFER-ERRORS-FOUND                                      12240000
122500         PERFORM D600-CREATE-ERROR-REPORT                         12250000
122600         PERFORM D700-CREATE-DETAIL-REPORT                        12260000
122700     ELSE                                                         12270000
122800         PERFORM D300-CREATE-MERCH-LEDGER-REC                     12280000
122900         PERFORM D400-CREATE-SKU-RECEIPTS-REC                     12290000
123000         PERFORM D500-CREATE-SKU-ADJUST-REC                       12300000
123100         PERFORM D700-CREATE-DETAIL-REPORT                        12310000
123200     END-IF.                                                      12320000
123300                                                                  12330000
123400 C500-BATCH-BREAK.                                                12340000
123500                                                                  12350000
123600     PERFORM Z170-WRITE-DTL-RPT-HEADINGS.                         12360000
123700     PERFORM Z193-WRITE-DTL-TOT-HEADINGS.                         12370000
123800                                                                  12380000
123900     MOVE SPACE              TO DRT-BT-BATCH-INFO.                12390000
124000     MOVE 'BATCH'            TO DRT-BT-BATCH-LIT.                 12400000
124100     MOVE PREV-BATCH-NMBR    TO DRT-BT-BATCH-NMBR.                12410000
124200     MOVE 'TOTAL'            TO DRT-BT-TOTAL-LIT.                 12420000
124300     MOVE PV-BTOT-UNIT-PRICE TO DRT-UNIT-PRICE.                   12430000
124400     MOVE PV-BTOT-EXT-PRICE  TO DRT-EXT-PRICE.                    12440000
124500     MOVE PV-BTOT-TOTAL-QTY  TO DRT-TOTAL-QTY.                    12450000
124600                                                                  12460000
124700     PERFORM Z195-WRITE-DTL-RPT-TOTAL-LINE.                       12470000
124800                                                                  12480000
124900     MOVE SPACE   TO DRT-DC-INFO.                                 12490000
125000     MOVE PC-DASH TO DRT-DC-DASH.                                 12500000
125100                                                                  12510000
125200     PERFORM VARYING DCT-IDX FROM 1 BY 1                          12520000
125300       UNTIL DCT-IDX > DCT-IDX-MAX                                12530000
125400          OR DCT-STORE-NMBR (DCT-IDX) = ZERO                      12540000
125500         IF DCT-PRINT-DC (DCT-IDX)                                12550000
125600             MOVE DCT-STORE-NMBR (DCT-IDX)  TO DRT-DC-STORE-NMBR  12560000
125700                                                                  12570000
125800             SET VRS-IDX TO +1                                    12580000
125900             SEARCH VRS-VALID-RECV-STORE-TBL-ENTRY                12590000
126000                 AT END                                           12600000
126100                     MOVE SPACE         TO DRT-DC-CHAR10-ABBR-NAME12610000
126200                 WHEN VRS-STORE-NMBR (VRS-IDX)                    12620000
126300                                        = DCT-STORE-NMBR (DCT-IDX)12630000
126400                     MOVE VRS-CHAR10-ABBR-NAME (VRS-IDX)          12640000
126500                                        TO DRT-DC-CHAR10-ABBR-NAME12650000
126600                                                                  12660000
126700                 WHEN VRS-STORE-NMBR (VRS-IDX) = ZERO             12670000
126800                     MOVE SPACE         TO DRT-DC-CHAR10-ABBR-NAME12680000
126900             END-SEARCH                                           12690000
127000                                                                  12700000
127100             MOVE DCT-BTOT-UNIT-PRICE (DCT-IDX)                   12710000
127200                                        TO DRT-UNIT-PRICE         12720000
127300             MOVE DCT-BTOT-EXT-PRICE  (DCT-IDX)                   12730000
127400                                        TO DRT-EXT-PRICE          12740000
127500             MOVE DCT-BTOT-TOTAL-QTY  (DCT-IDX)                   12750000
127600                                        TO DRT-TOTAL-QTY          12760000
127700             PERFORM Z195-WRITE-DTL-RPT-TOTAL-LINE                12770000
127800         END-IF                                                   12780000
127900     END-PERFORM.                                                 12790000
128000                                                                  12800000
128100 D100-XFER-LEVEL-EDITS.                                           12810000
128200                                                                  12820000
128300*    *------------------------------------------------------------12830000
128400*    * EDIT THE DC BY CHECKING IT AGAINST THE TABLE OF VALID      12840000
128500*    * VALID DC'S.                                                12850000
128600*    *------------------------------------------------------------12860000
128700                                                                  12870000
128800     SET VRS-IDX TO +1.                                           12880000
128900                                                                  12890000
129000     SEARCH VRS-VALID-RECV-STORE-TBL-ENTRY                        12900000
129100         AT END                                                   12910000
129200             SET EI-INVALID-DC TO TRUE                            12920000
129300                                                                  12930000
129400         WHEN VRS-STORE-NMBR (VRS-IDX) = ZERO                     12940000
129500             SET EI-INVALID-DC TO TRUE                            12950000
129600                                                                  12960000
129700         WHEN VRS-STORE-NMBR (VRS-IDX) = PREV-DC-STORE-NMBR       12970000
129800             IF  PV-PREV-TRAN-CODE = 'C'                          12980000
129900                 CONTINUE                                         12990000
130000             ELSE                                                 13000000
130100                 IF  VRS-TYPE-CODE (VRS-IDX) = 'DC'               13010000
130200                 OR  VRS-TYPE-CODE (VRS-IDX) = 'CS'               13020000
130300                 OR  VRS-TYPE-CODE (VRS-IDX) = 'RV'               13030000
130400                     CONTINUE                                     13040000
130500                 ELSE                                             13050000
130600                     SET EI-INVALID-DC TO TRUE                    13060000
130700                 END-IF                                           13070000
130800             END-IF                                               13080000
130900     END-SEARCH.                                                  13090000
131000                                                                  13100000
131100*    *------------------------------------------------------------13110000
131200*    * EDIT THE UNIT PRICE FOR NUMERIC AND < 100,000.00.          13120016
131300*    * THE 100,000.00 LIMIT IS NECESSARY BECAUSE UNIT PRICE ON THE13130016
131400*    * MERCHANDISE LEDGER OUTPUT FILE IS PIC 9(5)V99.             13140016
131500*    *------------------------------------------------------------13150000
131600                                                                  13160000
131700     IF PREV-UNIT-PRICE NOT NUMERIC                               13170000
131800         SET EI-INVALID-UNIT-PRICE TO TRUE                        13180000
131900     ELSE                                                         13190000
132000         IF PREV-UNIT-PRICE < 100000                              13200018
132100             CONTINUE                                             13210000
132200         ELSE                                                     13220000
132300             SET EI-UNIT-PRICE-EXCEEDS-MAX TO TRUE                13230000
132400         END-IF                                                   13240000
132500     END-IF.                                                      13250000
132600                                                                  13260000
132700*    *------------------------------------------------------------13270000
132800*    * EDIT THE TOTAL QTY FOR NUMERICS.                           13280000
132900*    *------------------------------------------------------------13290000
133000                                                                  13300000
133100     IF PREV-TOTAL-QTY NOT NUMERIC                                13310000
133200         SET EI-INVALID-TOTAL-QTY TO TRUE                         13320000
133300     END-IF.                                                      13330000
133400                                                                  13340000
133500*    *------------------------------------------------------------13350000
133600*    * EDIT THE EXTENDED PRICE TO MAKE SURE IT WON'T OVERFLOW THE 13360000
133700*    * FIELD ON THE DETAIL REPORT.                                13370000
133800*    *------------------------------------------------------------13380000
133900                                                                  13390000
134000     IF  PREV-UNIT-PRICE NUMERIC                                  13400000
134100     AND PREV-TOTAL-QTY  NUMERIC                                  13410000
134200         COMPUTE PV-XFER-EXT-PRICE = PREV-UNIT-PRICE              13420000
134300                                   * PREV-TOTAL-QTY               13430000
134400         IF PV-XFER-EXT-PRICE > 999999.99                         13440000
134500             SET EI-EXT-PRICE-EXCEEDS-MAX TO TRUE                 13450000
134600         END-IF                                                   13460000
134700     END-IF.                                                      13470000
134800                                                                  13480000
134900*    *------------------------------------------------------------13490000
135000*    * EDIT THE SKU.                                              13500000
135100*    *------------------------------------------------------------13510000
135200                                                                  13520000
135300     PERFORM E100-EDIT-XLV-SKU.                                   13530000
135400                                                                  13540000
135500*    *------------------------------------------------------------13550000
135600*    * EDIT THE FILLED DATE AND DETERMINE THE FISCAL PERIOD.      13560000
135700*    *------------------------------------------------------------13570000
135800                                                                  13580000
135900     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              13590000
136000     SET DPG51-FISCAL-454-CALENDAR   TO TRUE.                     13600000
136100     SET DPG52-LK-DTE-GREG           TO TRUE.                     13610000
136200     MOVE PREV-FILLED-DATE-MMDDYY    TO DPG52-LK-DATE-INPUT.      13620000
136300                                                                  13630000
136400     CALL PC-CALENDAR-ROUTINE                                     13640000
136500         USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.               13650000
136600                                                                  13660000
136700     EVALUATE TRUE                                                13670000
136800         WHEN DPG54-DATE-INVALID                                  13680000
136900             SET EI-INVALID-FILLED-DATE TO TRUE                   13690000
137000         WHEN DPG54-SEVERE-ERROR                                  13700000
137100             DISPLAY '** ABEND **'                                13710000
137200             DISPLAY '** PGM = CEKUT001'                          13720000
137300             DISPLAY '** PARAGRAPH = D100-XFER-LEVEL-EDITS'       13730000
137400             DISPLAY '** INVALID RETURN FROM CALENDAR ROUTINE. '  13740000
137500             DISPLAY '** ERROR MESSAGE = ' DPG54-ERROR-MESSAGE    13750000
137600             DISPLAY '** DPG51 = ' DPG51                          13760000
137700             DISPLAY '** DPG52 = ' DPG52                          13770000
137800             DISPLAY '** DPG53 = ' DPG53                          13780000
137900             DISPLAY '** DPG54 = ' DPG54                          13790000
138000             MOVE +4003 TO ABEND-CODE                             13800000
138100             CALL 'ILBOABN0' USING ABEND-CODE                     13810000
138200         WHEN OTHER                                               13820000
138300             MOVE DPG56-FISCAL-PERIOD-NBR-X                       13830000
138400                                   TO PV-XFER-FISCAL-PERIOD       13840000
138500             MOVE DPG55-DB2-ISO-DATE-FMT                          13850000
138600                                   TO PV-XFER-FILLED-DATE-ISO-FMT 13860000
138700     END-EVALUATE.                                                13870000
138800                                                                  13880000
138900                                                                  13890000
139000 D200-RECORD-LEVEL-EDITS.                                         13900000
139100                                                                  13910000
139200*    *------------------------------------------------------------13920000
139300*    * EDIT THE QUANTITY FOR NUMERIC, NON-ZERO, AND < 1,000. THE  13930000
139400*    * 1,000 LIMIT IS NECESSARY BECAUSE QUANTITY ON THE           13940000
139500*    * MERCHANDISE LEDGER OUTPUT FILE IS PIC 9(3).                13950000
139600*    *------------------------------------------------------------13960000
139700                                                                  13970000
139800     IF  CE004-RECV-STORE-QTY NUMERIC                             13980000
139900         IF CE004-RECV-STORE-QTY = ZERO                           13990000
140000             SET EI-INVALID-STORE-QTY TO TRUE                     14000000
140100         ELSE                                                     14010000
140200* DMH 3/9/11 IF CE004-RECV-STORE-QTY < 1000                       14020009
140300                 CONTINUE                                         14030000
140400* DMH 3/9/11 ELSE                                                 14040009
140500* DMH 3/9/11     SET EI-STORE-QTY-EXCEEDS-MAX TO TRUE             14050009
140600* DMH 3/9/11 END-IF                                               14060014
140700         END-IF                                                   14070000
140800     ELSE                                                         14080000
140900         SET EI-INVALID-STORE-QTY TO TRUE                         14090000
141000     END-IF.                                                      14100000
141100                                                                  14110000
141200*    *------------------------------------------------------------14120000
141300*    * MAKE SURE THE RECEIVING STORE IS VALID BY CHECKING IT      14130000
141400*    * AGAINST THE TABLE OF VALID RECEIVING STORES.               14140000
141500*    *------------------------------------------------------------14150000
141600                                                                  14160000
141700     SET VRS-IDX TO +1                                            14170000
141800                                                                  14180000
141900     SEARCH VRS-VALID-RECV-STORE-TBL-ENTRY                        14190000
142000         AT END                                                   14200000
142100             SET EI-INVALID-RECV-STORE TO TRUE                    14210000
142200                                                                  14220000
142300         WHEN VRS-STORE-NMBR (VRS-IDX) = ZERO                     14230000
142400             SET EI-INVALID-RECV-STORE TO TRUE                    14240000
142500                                                                  14250000
142600         WHEN VRS-STORE-NMBR (VRS-IDX) = CE004-RECV-STORE-NMBR    14260000
142700             CONTINUE                                             14270000
142800                                                                  14280000
142900     END-SEARCH.                                                  14290000
143000                                                                  14300000
143100*    *------------------------------------------------------------14310000
143200*    * CHECK FOR DUPLICATE RECEIVING STORES.                      14320000
143300*    *------------------------------------------------------------14330000
143400                                                                  14340000
143500     SET XRS-IDX TO +1.                                           14350000
143600                                                                  14360000
143700     SEARCH XRS-XFER-RECV-STORE-TBL-ENTRY                         14370000
143800         AT END                                                   14380000
143900             CONTINUE                                             14390000
144000                                                                  14400000
144100         WHEN XRS-STORE-NMBR (XRS-IDX) = CE004-RECV-STORE-NMBR    14410000
144200             SET EI-DUP-RECV-STORE TO TRUE                        14420000
144300     END-SEARCH.                                                  14430000
144400                                                                  14440000
144500*    *------------------------------------------------------------14450000
144600*    * MAKE SURE THE FILLED DATE IS BETWEEN THE START AND STOP    14460000
144700*    * RECEIPT DATES.                                             14470000
144800*    * (NOTE THAT THIS CHECK IS DEPENDENT UPON THE FACT           14480000
144900*    * THAT VRS-IDX POINTS TO THE RECEIVING STORE. IT WAS SET     14490000
145000*    * WHEN THE RECEIVING STORE WAS EDITTED FOR VALIDITY.)        14500000
145100*    *------------------------------------------------------------14510000
145200                                                                  14520000
145300     IF EI-INVALID-FILLED-DATE                                    14530000
145400     OR EI-INVALID-RECV-STORE                                     14540000
145500         CONTINUE                                                 14550000
145600     ELSE                                                         14560000
145700         IF  (PV-XFER-FILLED-DATE-ISO-FMT                         14570000
145800                                    < VRS-RCT-START-DATE(VRS-IDX) 14580000
145900         OR   PV-XFER-FILLED-DATE-ISO-FMT                         14590000
146000                                    > VRS-RCT-STOP-DATE (VRS-IDX))14600000
146500             SET EI-NOT-IN-RCT-DATE-RANGE TO TRUE                 14650000
146600         END-IF                                                   14660000
146700     END-IF.                                                      14670000
146800                                                                  14680000
146900 D300-CREATE-MERCH-LEDGER-REC.                                    14690000
147000                                                                  14700000
147100     MOVE PC-MERCH-TRAN-CODE    TO ML019-TRANSFER-CODE.           14710000
147200     MOVE PREV-DC-STORE-NMBR                                      14720000
147300                                TO ML019-TRANSFER-FROM-STORE-9.   14730004
147400     MOVE PREV-REQ-NMBR-LAST5   TO ML019-TRANSFER-NBR.            14740000
147500     MOVE PREV-FILLED-DATE-MMDDYY-MM                              14750000
147600                                TO ML019-TRANSFER-MM.             14760000
147700     MOVE PREV-FILLED-DATE-MMDDYY-DD                              14770000
147800                                TO ML019-TRANSFER-DD.             14780000
147900     MOVE PV-XFER-FISCAL-PERIOD TO ML019-TRANSFER-KOHLS-MM.       14790000
148000                                                                  14800000
148100     MOVE PREV-UNIT-PRICE       TO ML019-TRANSFER-PER-UNT-RTL-AMT.14810000
148200     MOVE PREV-BATCH-NMBR-LAST3 TO ML019-TRANSFER-BATCH-NBR.      14820000
148300                                                                  14830000
148400     MOVE XL001-DEPT-NBR-3CH TO PV-SKUNUM-DEPT                    14840000
148500                                PV-NEW-SKU-DEPT.                  14850000
148600     MOVE XL001-SUB-CL-NBR-2CH TO PV-SKUNUM-SUBCLASS              14860000
148700                                PV-NEW-SKU-SUBCLASS.              14870000
148800     MOVE XL001-MAJ-CL-NBR-2CH TO PV-SKUNUM-CLASS                 14880000
148900                                PV-NEW-SKU-CLASS.                 14890000
149000                                                                  14900000
149100     MOVE PV-NEW-SKU-DEPT     TO ML019-TRANSFER-DEPT-NBR.         14910000
149200     MOVE PV-NEW-SKU-SUBCLASS TO ML019-TRANSFER-CLASS-NBR.        14920000
149300                                                                  14930000
149400     MOVE XL001-SKU-NBR     TO PREV-SKU-NMBR                      14940000
149500     MOVE PREV-SKU          TO ML019-SKU.                         14950000
149501                                                                  14950105
149502     MOVE XL001-ENT-ID      TO ML019-TRANSFER-ENT-ID.             14950206
149600                                                                  14960000
149700     PERFORM                                                      14970000
149800         VARYING XRS-IDX FROM 1 BY 1                              14980000
149900         UNTIL XRS-IDX > XRS-IDX-MAX                              14990000
150000            OR XRS-STORE-NMBR (XRS-IDX) = ZERO                    15000000
150100             MOVE XRS-STORE-NMBR (XRS-IDX)                        15010000
150200                                TO ML019-TRANSFER-TO-STORE-9      15020004
150210**                              \                                 15021009
150220*** DMH 3/9/11 BEGIN                                              15022009
150221*** ML CANNOT HANDLE RECORD WITH > 999 UNITS                      15022109
150230***                                                               15023009
150240             IF  XRS-STORE-QTY (XRS-IDX)   > 999                  15024009
150250                 MOVE XRS-STORE-QTY (XRS-IDX) TO PV-ML-QTY        15025009
150260                 PERFORM UNTIL PV-ML-QTY  < 1000                  15026011
150270                     MOVE  999  TO  ML019-TRANSFER-QTY            15027012
150271                     PERFORM Z110-WRITE-MERCH-LEDGER-REC          15027109
150272                     SUBTRACT 999                                 15027212
150273                         FROM PV-ML-QTY                           15027312
150274                       GIVING PV-ML-QTY                           15027412
150275                 END-PERFORM                                      15027512
150276                     MOVE  PV-ML-QTY TO ML019-TRANSFER-QTY        15027612
150277                     PERFORM Z110-WRITE-MERCH-LEDGER-REC          15027712
150280             ELSE                                                 15028009
150300                 MOVE XRS-STORE-QTY (XRS-IDX)                     15030009
150400                                TO ML019-TRANSFER-QTY             15040000
150410                 PERFORM Z110-WRITE-MERCH-LEDGER-REC              15041015
150500             END-IF                                               15050013
150510**                                                                15051009
150520*** DMH 3/9/11 END                                                15052009
150530**                                                                15053009
150600     END-PERFORM.                                                 15060000
150700                                                                  15070000
150800 D400-CREATE-SKU-RECEIPTS-REC.                                    15080000
150900                                                                  15090000
151000     MOVE XL001-ITM-NBR           TO FS036-ITM-NBR.               15100000
151100                                                                  15110000
151200     MOVE PREV-REQ-NMBR               TO FS036-PO-NBR.            15120000
151300     MOVE PV-REC-SEQ-NBR              TO FS036-RCVR-NBR.          15130000
151400     MOVE PREV-FILLED-DATE-MMDDYY-YY  TO PV-FILLED-DATE-YY.       15140000
151500     MOVE PREV-FILLED-DATE-MMDDYY-MM  TO PV-FILLED-DATE-MM.       15150000
151600     MOVE PREV-FILLED-DATE-MMDDYY-DD  TO PV-FILLED-DATE-DD.       15160000
151700     MOVE PV-FILLED-DATE              TO FS036-RCPT-DTE.          15170000
151800     MOVE PV-FILLED-DATE              TO FS036-VRFD-DTE.          15180000
151900     MOVE PREV-TOTAL-QTY              TO FS036-TOT-RCPT-QTY.      15190000
152000     MOVE PREV-BATCH-NMBR             TO FS036-BTCH-NBR.          15200000
152100     MOVE 'CEKUT001'              TO FS036-RCPT-SRC-PGM-NM.       15210000
152200                                                                  15220000
152300     PERFORM  VARYING XRS-IDX FROM 1 BY 1                         15230000
152400       UNTIL XRS-IDX > XRS-IDX-MAX                                15240000
152500       OR    XRS-STORE-NMBR (XRS-IDX) = ZERO                      15250000
152600         MOVE XRS-STORE-NMBR (XRS-IDX)                            15260000
152700                                     TO FS036-LOC-NBR             15270000
152800         MOVE XRS-STORE-QTY  (XRS-IDX)                            15280000
152900                                     TO FS036-LOC-RCPT-QTY        15290000
153000         PERFORM Z120-WRITE-SKU-RECEIPTS-REC                      15300000
153100     END-PERFORM.                                                 15310000
153200                                                                  15320000
153300 D500-CREATE-SKU-ADJUST-REC.                                      15330000
153400                                                                  15340000
153500     MOVE XL001-ITM-NBR           TO FS035-ITM-NBR.               15350000
153600                                                                  15360000
153700     MOVE PREV-DC-STORE-NMBR    TO FS035-LOC-NBR.                 15370000
153800     MOVE PC-SKU-FIELD-NUM      TO FS035-ADJ-TYP.                 15380000
153900     MOVE PC-SKU-ACTION-MINUS   TO FS035-ACTN-CDE.                15390000
154000     MOVE PREV-TOTAL-QTY        TO FS035-ADJ-QTY.                 15400000
154100     MOVE PREV-BATCH-NMBR       TO FS035-BTCH-NBR.                15410000
154200     MOVE 'CEKUT001'            TO FS035-ADJ-SRC-PGM-NM.          15420000
154300                                                                  15430000
154400     PERFORM Z130-WRITE-SKU-ADJUST-REC.                           15440000
154500                                                                  15450000
154600 D600-CREATE-ERROR-REPORT.                                        15460000
154700                                                                  15470000
154800     IF PV-ERR-RPT-LINE-COUNT > PC-XFER-LINE-LIMIT                15480000
154900         PERFORM Z140-WRITE-ERR-RPT-HEADINGS                      15490000
155000         PERFORM Z145-WRITE-ERR-COL-HEADINGS                      15500000
155100     END-IF.                                                      15510000
155200                                                                  15520000
155300     MOVE PREV-BATCH-NMBR            TO ERL-BATCH-NMBR.           15530000
155400     MOVE PREV-FILLED-DATE-MMDDYY-MM TO ERL-MONTH.                15540000
155500     MOVE PC-SLASH                   TO ERL-DATE-SLASH1.          15550000
155600     MOVE PREV-FILLED-DATE-MMDDYY-DD TO ERL-DAY.                  15560000
155700     MOVE PC-SLASH                   TO ERL-DATE-SLASH2.          15570000
155800     MOVE PREV-FILLED-DATE-MMDDYY-YY TO ERL-YEAR.                 15580000
155900     MOVE PREV-REQ-NMBR              TO ERL-PO-NMBR.              15590000
156000     MOVE PREV-SKU                   TO ERL-SKU.                  15600000
156100     MOVE PV-SKUNUM-DEPT             TO ERL-DEPT.                 15610000
156200     MOVE PV-SKUNUM-CLASS            TO ERL-CLASS.                15620000
156300     MOVE PV-SKUNUM-SUBCLASS         TO ERL-SUBCLASS.             15630000
156400     IF PREV-UNIT-PRICE NUMERIC                                   15640000
156500         MOVE PREV-UNIT-PRICE        TO ERL-UNIT-PRICE            15650000
156600     ELSE                                                         15660000
156700         MOVE PREV-UNIT-PRICE-X      TO ERL-UNIT-PRICE-X          15670000
156800     END-IF.                                                      15680000
156900                                                                  15690000
157000     IF PREV-TOTAL-QTY NUMERIC                                    15700000
157100         MOVE PREV-TOTAL-QTY         TO ERL-TOTAL-QTY             15710000
157200     ELSE                                                         15720000
157300         MOVE PREV-TOTAL-QTY-X       TO ERL-TOTAL-QTY-X           15730000
157400     END-IF.                                                      15740000
157500                                                                  15750000
157600*    *------------------------------------------------------------15760000
157700*    * THE FOLLOWING 'PERFORM UNTIL' BUILDS AND PRINTS ALL THE    15770000
157800*    * ERROR LINES FOR THE TRANSFER. THE LOOP ENDS WHEN ALL STORES15780000
157900*    * HAVE BEEN PRINTED AND ALL ERROR MESSAGES HAVE BEEN PRINTED 15790000
158000*    * AND THE RENUMBERED SKU (IF ANY) HAS BEEN PRINTED.          15800000
158100*    *------------------------------------------------------------15810000
158200     SET XRS-IDX TO 1.                                            15820000
158300     SET EMT-IDX TO 1.                                            15830000
158400     PERFORM                                                      15840000
158500       UNTIL (XRS-IDX > XRS-IDX-MAX                               15850000
158600       OR     XRS-STORE-NMBR (XRS-IDX) = ZERO)                    15860000
158700       AND   (EMT-IDX > EMT-IDX-MAX                               15870000
158800       OR     EMT-ERROR-MESSAGE (EMT-IDX) = SPACE)                15880000
158900*        *--------------------------------------------------------15890000
159000*        * THE FOLLOWING 'PERFORM UNTIL' BUILDS THE STORE         15900000
159100*        * INFORMATION FOR ONE ERROR LINE WITHIN THE TRANSFER. THE15910000
159200*        * LOOP ENDS WHEN ALL STORES HAVE BEEN PRINTED OR THE     15920000
159300*        * STORE INFORMATION ON THE LINE IS FULL.                 15930000
159400*        *--------------------------------------------------------15940000
159500         SET ERL-IDX TO 1                                         15950000
159600         PERFORM VARYING XRS-IDX FROM XRS-IDX BY 1                15960000
159700           UNTIL (XRS-IDX > XRS-IDX-MAX                           15970000
159800           OR     XRS-STORE-NMBR (XRS-IDX) = ZERO)                15980000
159900           OR     ERL-IDX > ERL-IDX-MAX                           15990000
160000             MOVE XRS-STORE-NMBR (XRS-IDX)                        16000000
160100                                   TO ERL-STORE-NBR      (ERL-IDX)16010000
160200             MOVE PC-DASH          TO ERL-STORE-QTY-DASH (ERL-IDX)16020000
160300             IF XRS-STORE-QTY (XRS-IDX) NUMERIC                   16030000
160400                 MOVE XRS-STORE-QTY (XRS-IDX)                     16040000
160500                                   TO ERL-STORE-QTY      (ERL-IDX)16050000
160600             ELSE                                                 16060000
160700                 MOVE XRS-STORE-QTY-X (XRS-IDX)                   16070000
160800                                   TO ERL-STORE-QTY-X    (ERL-IDX)16080000
160900             END-IF                                               16090000
161000             SET ERL-IDX UP BY +1                                 16100000
161100         END-PERFORM                                              16110000
161200                                                                  16120000
161300         IF EMT-IDX > EMT-IDX-MAX                                 16130000
161400             CONTINUE                                             16140000
161500         ELSE                                                     16150000
161600             MOVE EMT-ERROR-MESSAGE (EMT-IDX) TO ERL-ERROR-MESSAGE16160000
161700             SET EMT-IDX UP BY +1                                 16170000
161800         END-IF                                                   16180000
161900                                                                  16190000
162000         PERFORM Z150-WRITE-ERR-RPT-LINE                          16200000
162100         MOVE SPACE TO ERL-ERR-RPT-LINE                           16210000
162200                                                                  16220000
162300     END-PERFORM.                                                 16230000
162400                                                                  16240000
162500     PERFORM Z160-WRITE-DASH-ERR-RPT-LINE.                        16250000
162600                                                                  16260000
162700 D700-CREATE-DETAIL-REPORT.                                       16270000
162800                                                                  16280000
162900     IF PV-DTL-RPT-LINE-COUNT > PC-XFER-LINE-LIMIT                16290000
163000         PERFORM Z170-WRITE-DTL-RPT-HEADINGS                      16300000
163100         PERFORM Z175-WRITE-DTL-COL-HEADINGS                      16310000
163200     END-IF.                                                      16320000
163300                                                                  16330000
163400     MOVE PREV-FILLED-DATE-MMDDYY-MM TO DRL-MONTH.                16340000
163500     MOVE PC-SLASH                   TO DRL-DATE-SLASH1.          16350000
163600     MOVE PREV-FILLED-DATE-MMDDYY-DD TO DRL-DAY.                  16360000
163700     MOVE PC-SLASH                   TO DRL-DATE-SLASH2.          16370000
163800     MOVE PREV-FILLED-DATE-MMDDYY-YY TO DRL-YEAR.                 16380000
163900     MOVE PREV-REQ-NMBR              TO DRL-PO-NMBR.              16390000
164000     MOVE PREV-SKU                   TO DRL-SKU.                  16400000
164100     MOVE PV-SKUNUM-DEPT             TO DRL-DEPT.                 16410000
164200     MOVE PV-SKUNUM-CLASS            TO DRL-CLASS.                16420000
164300     MOVE PV-SKUNUM-SUBCLASS         TO DRL-SUBCLASS.             16430000
164400                                                                  16440000
164500     IF PREV-UNIT-PRICE NUMERIC                                   16450000
164600         MOVE PREV-UNIT-PRICE        TO DRL-UNIT-PRICE            16460000
164700     ELSE                                                         16470000
164800         MOVE PREV-UNIT-PRICE-X      TO DRL-UNIT-PRICE-X          16480000
164900     END-IF.                                                      16490000
165000                                                                  16500000
165100     IF PREV-TOTAL-QTY NUMERIC                                    16510000
165200         MOVE PREV-TOTAL-QTY         TO DRL-TOTAL-QTY             16520000
165300     ELSE                                                         16530000
165400         MOVE PREV-TOTAL-QTY-X       TO DRL-TOTAL-QTY-X           16540000
165500     END-IF.                                                      16550000
165600                                                                  16560000
165700     MOVE PV-XFER-EXT-PRICE          TO DRL-EXT-PRICE.            16570000
165800                                                                  16580000
165900     MOVE PREV-DC-STORE-NMBR         TO DRL-FROM-STORE-NBR.       16590000
166000                                                                  16600000
166100*    *------------------------------------------------------------16610000
166200*    * THE FOLLOWING 'PERFORM UNTIL' BUILDS AND PRINTS ALL THE    16620000
166300*    * DETAIL LINES FOR THE TRANSFER. THE LOOP ENDS WHEN ALL      16630000
166400*    * STORES HAVE BEEN PRINTED AND ALL ERROR MESSAGES HAVE BEEN  16640000
166500*    * PRINTED AND THE RENUMBERED SKU (IF ANY) HAS BEEN PRINTED.  16650000
166600*    *------------------------------------------------------------16660000
166700     SET XRS-IDX TO 1.                                            16670000
166800     SET EMT-IDX TO 1.                                            16680000
166900     PERFORM                                                      16690000
167000       UNTIL (XRS-IDX > XRS-IDX-MAX                               16700000
167100       OR     XRS-STORE-NMBR (XRS-IDX) = ZERO)                    16710000
167200       AND   (EMT-IDX > EMT-IDX-MAX                               16720000
167300       OR     EMT-ERROR-MESSAGE (EMT-IDX) = SPACE)                16730000
167400*        *--------------------------------------------------------16740000
167500*        * THE FOLLOWING 'PERFORM UNTIL' BUILDS THE STORE         16750000
167600*        * INFORMATION FOR ONE DETAIL LINE WITHIN THE TRANSFER.   16760000
167700*        * THE LOOP ENDS WHEN ALL STORES HAVE BEEN PRINTED OR THE 16770000
167800*        * STORE INFORMATION ON THE LINE IS FULL.                 16780000
167900*        *--------------------------------------------------------16790000
168000         SET DRL-IDX TO 1                                         16800000
168100         PERFORM VARYING XRS-IDX FROM XRS-IDX BY 1                16810000
168200           UNTIL (XRS-IDX > XRS-IDX-MAX                           16820000
168300           OR     XRS-STORE-NMBR (XRS-IDX) = ZERO)                16830000
168400           OR     DRL-IDX > DRL-IDX-MAX                           16840000
168500             MOVE XRS-STORE-NMBR (XRS-IDX)                        16850000
168600                 TO DRL-STORE-NBR (DRL-IDX)                       16860000
168700             MOVE PC-DASH                                         16870000
168800                 TO DRL-STORE-QTY-DASH (DRL-IDX)                  16880000
168900             IF XRS-STORE-QTY (XRS-IDX) NUMERIC                   16890000
169000                 MOVE XRS-STORE-QTY (XRS-IDX)                     16900000
169100                     TO DRL-STORE-QTY   (DRL-IDX)                 16910000
169200             ELSE                                                 16920000
169300                 MOVE XRS-STORE-QTY-X (XRS-IDX)                   16930000
169400                     TO DRL-STORE-QTY-X (DRL-IDX)                 16940000
169500             END-IF                                               16950000
169600             SET DRL-IDX UP BY +1                                 16960000
169700         END-PERFORM                                              16970000
169800                                                                  16980000
169900         IF EMT-IDX > EMT-IDX-MAX                                 16990000
170000             CONTINUE                                             17000000
170100         ELSE                                                     17010000
170200             MOVE EMT-ERROR-MESSAGE (EMT-IDX) TO DRL-ERROR-MESSAGE17020000
170300             SET EMT-IDX UP BY +1                                 17030000
170400         END-IF                                                   17040000
170500                                                                  17050000
170600         PERFORM Z180-WRITE-DTL-RPT-LINE                          17060000
170700         MOVE SPACE TO DRL-DTL-RPT-LINE                           17070000
170800     END-PERFORM.                                                 17080000
170900                                                                  17090000
171000     PERFORM Z190-WRITE-DASH-DTL-RPT-LINE.                        17100000
171100                                                                  17110000
171200*-----------------------------------------------------------------17120000
171300* CHECK THE ERROR INDICATORS AND TABLE ALL THE ERROR MESSAGES THAT17130000
171400* APPLY TO THIS TRANSFER.                                         17140000
171500*-----------------------------------------------------------------17150000
171600 D800-TABLE-ERROR-MESSAGES.                                       17160000
171700                                                                  17170000
171800     SET EMT-IDX TO 1.                                            17180000
171900                                                                  17190000
172000     PERFORM VARYING EIT-IDX FROM 1 BY 1                          17200000
172100       UNTIL EIT-IDX > EIT-IDX-MAX                                17210000
172200         IF EIT-ERROR-INDICATOR-ON (EIT-IDX)                      17220000
172300             SET PS-XFER-ERRORS-FOUND TO TRUE                     17230000
172400             MOVE EIT-ERROR-MESSAGE (EIT-IDX)                     17240000
172500               TO EMT-ERROR-MESSAGE (EMT-IDX)                     17250000
172600             SET EMT-IDX UP BY 1                                  17260000
172700             IF EMT-IDX > EMT-IDX-MAX                             17270000
172800                 MOVE +4004 TO ABEND-CODE                         17280000
172900                 DISPLAY '**  ABEND     **'                       17290000
173000                 DISPLAY '**  PROGRAM   **  =  CEKUT001'          17300000
173100                 DISPLAY                                          17310000
173200                  '**  PARAGRAPH **  =  D800-TABLE-ERROR-MESSAGES'17320000
173300                 DISPLAY                                          17330000
173400                  '**  TBL OVERFLOW ON EMT-ERROR-MESSAGE-TBL  **' 17340000
173500                 CALL 'ILBOABN0' USING ABEND-CODE                 17350000
173600             END-IF                                               17360000
173700         END-IF                                                   17370000
173800     END-PERFORM.                                                 17380000
173900                                                                  17390000
174000 E100-EDIT-XLV-SKU.                                               17400000
174100*                                                                 17410000
174200     MOVE 'E100-EDIT-XLV-SKU'        TO PV-ABEND-PARAGRAPH.       17420000
174300     MOVE CE004-SKU                  TO DK-SKU.                   17430000
174400                                                                  17440000
174500     INITIALIZE XL001-ITEM-COMMAREA.                              17450000
174600                                                                  17460000
174700     SET XL001-BY-NUMERIC-SKU                                     17470000
174800         XL001-SELECT-SKU                                         17480000
174900         XL001-SELECT-VND-STYL                                    17490000
175000         XL001-SELECT-SKU-STR        TO TRUE.                     17500000
175100                                                                  17510000
175200      MOVE DK-SKU                    TO XL001-KEY-SKU.            17520000
175300                                                                  17530000
175400      CALL 'XLKUT001'     USING         XL001-ITEM-COMMAREA.      17540000
175500                                                                  17550000
175600      EVALUATE TRUE                                               17560000
175700        WHEN XL001-SKU-SQLCODE   = +0                             17570000
175800             PERFORM  E100-VND-CHECK-PARA                         17580000
175900        WHEN XL001-SKU-SQLCODE   = +100                           17590000
176000          SET PS-SKU-NOT-FOUND TO TRUE                            17600000
176100          DISPLAY '*** SKU NOT FOUND ==> ' DK-SKU                 17610000
176200                                                                  17620000
176300       WHEN XL001-SKU-CONTENTION                                  17630000
176400           MOVE 'E100-SELECT-SKU-BY-SKU'   TO PV-ABEND-PARAGRAPH  17640000
176500           MOVE 'XLV-SKU '          TO PV-ABEND-STRUCTURE-1       17650000
176600           MOVE 'SKU CONTENTION'    TO PV-ABEND-OPERATION         17660000
176700           MOVE XL001-SKU-SQLCODE   TO SQLCODE                    17670000
176800           PERFORM Z900-SQL-ABEND                                 17680000
176900                                                                  17690000
177000       WHEN OTHER                                                 17700000
177100           MOVE 'E100-SELECT-SKU-BY-SKU'   TO PV-ABEND-PARAGRAPH  17710000
177200           MOVE 'XLV-SKU '          TO PV-ABEND-STRUCTURE-1       17720000
177300           MOVE 'INVALID SKU ACCESS'   TO PV-ABEND-OPERATION      17730000
177400           MOVE XL001-SKU-SQLCODE   TO SQLCODE                    17740000
177500           PERFORM Z900-SQL-ABEND                                 17750000
177600      END-EVALUATE.                                               17760000
177700                                                                  17770000
177800 E100-VND-CHECK-PARA.                                             17780000
177900                                                                  17790000
178000      EVALUATE TRUE                                               17800000
178100        WHEN XL001-VND-STYL-SQLCODE = +0                          17810000
178110             MOVE XL001-DEPT-NBR-3CH   TO PV-SKUNUM-DEPT          17811008
178130             MOVE XL001-SUB-CL-NBR-2CH TO PV-SKUNUM-SUBCLASS      17813008
178150             MOVE XL001-MAJ-CL-NBR-2CH TO PV-SKUNUM-CLASS         17815008
178200             PERFORM  E100-STR-CHECK-PARA                         17820000
178300                                                                  17830000
178400        WHEN XL001-VND-STYL-SQLCODE = +100                        17840000
178410             MOVE ZERO                 TO PV-SKUNUM-DEPT          17841008
178420                                          PV-SKUNUM-SUBCLASS      17842008
178430                                          PV-SKUNUM-CLASS         17843008
178500*         CONTINUE                                                17850008
178600                                                                  17860000
178700       WHEN XL001-VND-STYL-CONTENTION                             17870000
178800           MOVE 'E100-SELECT-VND-STYL'   TO PV-ABEND-PARAGRAPH    17880000
178900           MOVE 'XLV-VND-STYL'      TO PV-ABEND-STRUCTURE-1       17890000
179000           MOVE 'VND CONTENTION'    TO PV-ABEND-OPERATION         17900000
179100           MOVE XL001-VND-STYL-SQLCODE TO SQLCODE                 17910000
179200           PERFORM Z900-SQL-ABEND                                 17920000
179300                                                                  17930000
179400       WHEN OTHER                                                 17940000
179500           MOVE 'E100-SELECT-VND-STYL'   TO PV-ABEND-PARAGRAPH    17950000
179600           MOVE 'XLV-VND-STYL'      TO PV-ABEND-STRUCTURE-1       17960000
179700           MOVE XL001-VND-STYL-SQLCODE TO SQLCODE                 17970000
179800           MOVE 'INVALID VND ACCESS'   TO PV-ABEND-OPERATION      17980000
179900           MOVE XL001-VND-STYL-SQLCODE TO SQLCODE                 17990000
180000           PERFORM Z900-SQL-ABEND                                 18000000
180100                                                                  18010000
180200      END-EVALUATE.                                               18020000
180300                                                                  18030000
180400 E100-STR-CHECK-PARA.                                             18040000
180500                                                                  18050000
180600      EVALUATE TRUE                                               18060000
180700        WHEN XL001-SKU-STR-SQLCODE = +0                           18070000
180800             CONTINUE                                             18080000
180900                                                                  18090000
181000        WHEN XL001-SKU-STR-SQLCODE = +100                         18100000
181100            SET PS-NO-UPC-PRICE TO TRUE                           18110000
181200            MOVE 0 TO XL001-UNT-RTL-AMT                           18120000
181300                                                                  18130000
181400       WHEN XL001-SKU-STR-CONTENTION                              18140000
181500           MOVE 'E100-SELECT-SKU-STR'   TO PV-ABEND-PARAGRAPH     18150000
181600           MOVE 'XLV-SKU-STR'      TO PV-ABEND-STRUCTURE-1        18160000
181700           MOVE 'STR CONTENTION'    TO PV-ABEND-OPERATION         18170000
181800           MOVE XL001-SKU-STR-SQLCODE TO SQLCODE                  18180000
181900           PERFORM Z900-SQL-ABEND                                 18190000
182000                                                                  18200000
182100       WHEN OTHER                                                 18210000
182200           MOVE 'E100-SELECT-SKU-STR'   TO PV-ABEND-PARAGRAPH     18220000
182300           MOVE 'XLV-STR-STYL'      TO PV-ABEND-STRUCTURE-1       18230000
182400           MOVE XL001-SKU-STR-SQLCODE TO SQLCODE                  18240000
182500           MOVE 'INVALID STR ACCESS'    TO PV-ABEND-OPERATION     18250000
182600           PERFORM Z900-SQL-ABEND                                 18260000
182700                                                                  18270000
182800      END-EVALUATE.                                               18280000
182900                                                                  18290000
183000 Z100-READ-CENTRAL-STK-XFER.                                      18300000
183100                                                                  18310000
183200     READ CENTRAL-STK-XFER-FILE                                   18320000
183300     INTO CE004-CENTRAL-STK-XFER-RECORD                           18330000
183400         AT END SET PS-END-OF-CENTRAL-STK-XFERS TO TRUE.          18340000
183500                                                                  18350000
183600     IF NOT PS-END-OF-CENTRAL-STK-XFERS                           18360000
183700         ADD +1 TO PV-STK-XFERS-READ                              18370000
183800     END-IF.                                                      18380000
183900                                                                  18390000
184000 Z110-WRITE-MERCH-LEDGER-REC.                                     18400000
184100                                                                  18410000
184200     WRITE MERCHANDISE-LEDGER-RECORD                              18420000
184300         FROM ML019-TRANSFER-RECORD.                              18430000
184400     ADD +1 TO PV-MERCH-RECS-WR.                                  18440000
184500                                                                  18450000
184600 Z120-WRITE-SKU-RECEIPTS-REC.                                     18460000
184700                                                                  18470000
184800     WRITE SKU-RECEIPTS-RECORD                                    18480000
184900         FROM FS036-RECEIPT-RECORD.                               18490000
185000     ADD +1 TO PV-RECEIPT-RECS-WR.                                18500000
185100                                                                  18510000
185200 Z130-WRITE-SKU-ADJUST-REC.                                       18520000
185300                                                                  18530000
185400     WRITE SKU-ADJUST-RECORD                                      18540000
185500         FROM FS035-ADJUSTMENT-RECORD.                            18550000
185600     ADD +1 TO PV-ADJUST-RECS-WR.                                 18560000
185700                                                                  18570000
185800 Z140-WRITE-ERR-RPT-HEADINGS.                                     18580000
185900                                                                  18590000
186000     MOVE 1                     TO DP200O-REPORT-NUMBER.          18600000
186100     ADD +1                     TO PV-ERR-RPT-PAGE-COUNT.         18610000
186200     MOVE PV-ERR-RPT-PAGE-COUNT TO DP200O-PAGE-NUMBER.            18620000
186300                                                                  18630000
186400     WRITE CENTRAL-STK-ERR-RPT-LINE                               18640000
186500     FROM  DP200O-STANDRD-HEADER-200-COLS                         18650000
186600         AFTER ADVANCING PAGE.                                    18660000
186700                                                                  18670000
186800     WRITE CENTRAL-STK-ERR-RPT-LINE                               18680000
186900     FROM  EH1-ERR-RPT-HEADING-1                                  18690000
187000         AFTER ADVANCING 1 LINE.                                  18700000
187100                                                                  18710000
187200     MOVE +2 TO PV-ERR-RPT-LINE-COUNT.                            18720000
187300                                                                  18730000
187400                                                                  18740000
187500 Z145-WRITE-ERR-COL-HEADINGS.                                     18750000
187600                                                                  18760000
187700     WRITE CENTRAL-STK-ERR-RPT-LINE                               18770000
187800     FROM  EH2-ERR-RPT-HEADING-2                                  18780000
187900         AFTER ADVANCING 1 LINE.                                  18790000
188000                                                                  18800000
188100     WRITE CENTRAL-STK-ERR-RPT-LINE                               18810000
188200     FROM EH3-ERR-RPT-HEADING-3                                   18820000
188300         AFTER ADVANCING 1 LINE.                                  18830000
188400                                                                  18840000
188500     WRITE CENTRAL-STK-ERR-RPT-LINE                               18850000
188600     FROM  PC-DASH-LINE                                           18860000
188700         AFTER ADVANCING 2 LINE.                                  18870000
188800                                                                  18880000
188900     ADD +4 TO PV-ERR-RPT-LINE-COUNT.                             18890000
189000                                                                  18900000
189100                                                                  18910000
189200 Z150-WRITE-ERR-RPT-LINE.                                         18920000
189300                                                                  18930000
189400     IF PV-ERR-RPT-LINE-COUNT > PC-PAGE-LINE-LIMIT                18940000
189500         PERFORM Z140-WRITE-ERR-RPT-HEADINGS                      18950000
189600         PERFORM Z145-WRITE-ERR-COL-HEADINGS                      18960000
189700     END-IF.                                                      18970000
189800                                                                  18980000
189900     WRITE CENTRAL-STK-ERR-RPT-LINE                               18990000
190000     FROM  ERL-ERR-RPT-LINE                                       19000000
190100         AFTER ADVANCING 1 LINE.                                  19010000
190200     ADD +1 TO PV-ERR-RPT-LINE-COUNT.                             19020000
190300                                                                  19030000
190400 Z160-WRITE-DASH-ERR-RPT-LINE.                                    19040000
190500                                                                  19050000
190600     WRITE CENTRAL-STK-ERR-RPT-LINE                               19060000
190700     FROM  PC-DASH-LINE                                           19070000
190800         AFTER ADVANCING 1 LINE.                                  19080000
190900     ADD +1 TO PV-ERR-RPT-LINE-COUNT.                             19090000
191000                                                                  19100000
191100 Z170-WRITE-DTL-RPT-HEADINGS.                                     19110000
191200                                                                  19120000
191300     MOVE  2                    TO DP200O-REPORT-NUMBER.          19130000
191400     ADD  +1                    TO PV-DTL-RPT-PAGE-COUNT.         19140000
191500     MOVE PV-DTL-RPT-PAGE-COUNT TO DP200O-PAGE-NUMBER.            19150000
191600                                                                  19160000
191700     WRITE CENTRAL-STK-DTL-RPT-LINE                               19170000
191800     FROM  DP200O-STANDRD-HEADER-200-COLS                         19180000
191900         AFTER ADVANCING PAGE.                                    19190000
192000                                                                  19200000
192100     WRITE CENTRAL-STK-DTL-RPT-LINE                               19210000
192200     FROM  DH1-DTL-RPT-HEADING-1                                  19220000
192300         AFTER ADVANCING 1 LINE.                                  19230000
192400                                                                  19240000
192500     MOVE +2 TO PV-DTL-RPT-LINE-COUNT.                            19250000
192600                                                                  19260000
192700 Z175-WRITE-DTL-COL-HEADINGS.                                     19270000
192800                                                                  19280000
192900     WRITE CENTRAL-STK-DTL-RPT-LINE                               19290000
193000     FROM DH2-DTL-RPT-HEADING-2                                   19300000
193100         AFTER ADVANCING 2 LINES.                                 19310000
193200                                                                  19320000
193300     WRITE CENTRAL-STK-DTL-RPT-LINE                               19330000
193400     FROM DH3-DTL-RPT-HEADING-3                                   19340000
193500         AFTER ADVANCING 1 LINE.                                  19350000
193600                                                                  19360000
193700     WRITE CENTRAL-STK-DTL-RPT-LINE                               19370000
193800     FROM PC-DASH-LINE                                            19380000
193900         AFTER ADVANCING 2 LINES.                                 19390000
194000                                                                  19400000
194100     ADD +5 TO PV-DTL-RPT-LINE-COUNT.                             19410000
194200                                                                  19420000
194300 Z180-WRITE-DTL-RPT-LINE.                                         19430000
194400                                                                  19440000
194500     IF PV-DTL-RPT-LINE-COUNT > PC-PAGE-LINE-LIMIT                19450000
194600         PERFORM Z170-WRITE-DTL-RPT-HEADINGS                      19460000
194700         PERFORM Z175-WRITE-DTL-COL-HEADINGS                      19470000
194800     END-IF.                                                      19480000
194900                                                                  19490000
195000     WRITE CENTRAL-STK-DTL-RPT-LINE                               19500000
195100     FROM  DRL-DTL-RPT-LINE                                       19510000
195200         AFTER ADVANCING 1 LINE.                                  19520000
195300     ADD +1 TO PV-DTL-RPT-LINE-COUNT.                             19530000
195400                                                                  19540000
195500 Z190-WRITE-DASH-DTL-RPT-LINE.                                    19550000
195600                                                                  19560000
195700     WRITE CENTRAL-STK-DTL-RPT-LINE                               19570000
195800     FROM  PC-DASH-LINE                                           19580000
195900         AFTER ADVANCING 1 LINE.                                  19590000
196000     ADD +1 TO PV-DTL-RPT-LINE-COUNT.                             19600000
196100                                                                  19610000
196200 Z193-WRITE-DTL-TOT-HEADINGS.                                     19620000
196300                                                                  19630000
196400     WRITE CENTRAL-STK-DTL-RPT-LINE                               19640000
196500     FROM DTH1-DTL-RPT-TOTAL-HEADING-1                            19650000
196600         AFTER ADVANCING 2 LINES.                                 19660000
196700                                                                  19670000
196800     WRITE CENTRAL-STK-DTL-RPT-LINE                               19680000
196900     FROM DTH2-DTL-RPT-TOTAL-HEADING-2                            19690000
197000         AFTER ADVANCING 1 LINE.                                  19700000
197100                                                                  19710000
197200     ADD  +2 TO PV-DTL-RPT-LINE-COUNT.                            19720000
197300                                                                  19730000
197400 Z195-WRITE-DTL-RPT-TOTAL-LINE.                                   19740000
197500                                                                  19750000
197600     WRITE CENTRAL-STK-DTL-RPT-LINE                               19760000
197700      FROM DRT-DTL-RPT-TOTAL-LINE                                 19770000
197800         AFTER ADVANCING 2 LINES.                                 19780000
197900     ADD +2 TO PV-DTL-RPT-LINE-COUNT.                             19790000
198000                                                                  19800000
198100 Z800-OPEN-RECV-STORE-CSR.                                        19810000
198200                                                                  19820000
198300     EXEC SQL                                                     19830000
198400          OPEN RECV-STORE-CSR                                     19840000
198500     END-EXEC.                                                    19850000
198600                                                                  19860000
198700     EVALUATE TRUE                                                19870000
198800         WHEN SQLCODE = ZERO                                      19880000
198900             CONTINUE                                             19890000
199000         WHEN SQLWARN0 NOT = SPACES                               19900000
199100         WHEN SQLCODE  NOT = ZERO                                 19910000
199200             MOVE 'Z800-OPEN-RECV-STORE-CSR'                      19920000
199300                                        TO PV-ABEND-PARAGRAPH     19930000
199400             MOVE 'OPEN RECV-STORE-CSR' TO PV-ABEND-OPERATION     19940000
199500             PERFORM Z900-SQL-ABEND                               19950000
199600     END-EVALUATE.                                                19960000
199700                                                                  19970000
199800 Z810-FETCH-RECV-STORE-CSR.                                       19980000
199900                                                                  19990000
200000     EXEC SQL                                                     20000000
200100         FETCH RECV-STORE-CSR                                     20010000
200200         INTO   :XLT00010-LOC-NBR                                 20020000
200300              , :XLT00010-OPN-DTE                                 20030000
200400              , :XLT00010-CLO-DTE                                 20040000
200500              , :PV-RCT-START-DTE                                 20050001
200600              , :PV-RCT-STOP-DTE                                  20060001
200700              , :XLT00010-LOC-10-ABBR-NM                          20070000
200800              , :XLT00010-LOC-TYP-CDE                             20080000
200900     END-EXEC.                                                    20090000
201092                                                                  20109200
201100     EVALUATE TRUE                                                20110000
201200         WHEN SQLCODE = ZERO                                      20120000
201300             CONTINUE                                             20130000
201400         WHEN SQLCODE = +100                                      20140000
201500             SET PS-NO-MORE-RECV-STORES TO TRUE                   20150000
201600         WHEN SQLWARN0 NOT = SPACES                               20160000
201700         WHEN SQLCODE  NOT = ZERO                                 20170000
201800             MOVE 'Z810-FETCH-RECV-STORE-CSR'                     20180000
201900                                         TO PV-ABEND-PARAGRAPH    20190000
202000             MOVE 'FETCH RECV-STORE-CSR' TO PV-ABEND-OPERATION    20200000
202100             PERFORM Z900-SQL-ABEND                               20210000
202200     END-EVALUATE.                                                20220000
202300                                                                  20230000
202400 Z820-CLOSE-RECV-STORE-CSR.                                       20240000
202500                                                                  20250000
202600     EXEC SQL                                                     20260000
202700         CLOSE RECV-STORE-CSR                                     20270000
202800     END-EXEC.                                                    20280000
202900                                                                  20290000
203000     EVALUATE TRUE                                                20300000
203100         WHEN SQLCODE = ZERO                                      20310000
203200             CONTINUE                                             20320000
203300         WHEN SQLWARN0 NOT = SPACES                               20330000
203400         WHEN SQLCODE  NOT = ZERO                                 20340000
203500             MOVE 'Z820-CLOSE-RECV-STORE-CSR'                     20350000
203600                                         TO PV-ABEND-PARAGRAPH    20360000
203700             MOVE 'CLOSE RECV-STORE-CSR' TO PV-ABEND-OPERATION    20370000
203800             PERFORM Z900-SQL-ABEND                               20380000
203900     END-EVALUATE.                                                20390000
204000                                                                  20400000
204100 Z900-SQL-ABEND.                                                  20410000
204200                                                                  20420000
204300     MOVE SQLCODE TO PV-SQLCODE.                                  20430000
204400     DISPLAY '*** DB2 ERROR '.                                    20440000
204500     DISPLAY '*** SQLCODE   = ' PV-SQLCODE.                       20450000
204600     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 20460000
204700     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               20470000
204800     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               20480000
204900     DISPLAY '*** MESSAGE   = ' PV-DB2-OPERATION-MESSAGE-1.       20490000
205000     DISPLAY '***           = ' PV-DB2-OPERATION-MESSAGE-2.       20500000
205100     DISPLAY '***           = ' PV-DB2-OPERATION-MESSAGE-3.       20510000
205200     DISPLAY '*** TABLE 1   = ' PV-ABEND-STRUCTURE-1.             20520000
205300                                                                  20530000
205400                                                                  20540000
205500*    THE FOLLOWING COPYBOOK UTILIZES THE DB2 ABEND MODULE         20550000
205600*    DSNTIAR TO CONVERT SQLCA INTO UNDERSTANDABLE VERBAGE.        20560000
205700                                                                  20570000
205800     COPY DPPD004.                                                20580000
205900                                                                  20590000
206000     CALL 'ILBOABN0' USING ABEND-CODE.                            20600000
