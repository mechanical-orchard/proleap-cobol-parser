000100***************************************************************** 00010023
000200 IDENTIFICATION DIVISION.                                         00020023
000300***************************************************************** 00030023
000400                                                                  00040023
000500 PROGRAM-ID.             VLKUT045.                                00050023
000600 AUTHOR.                 AL PETERS.                               00060023
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070023
000800 DATE-WRITTEN            AUGUST 2006.                             00080023
000900 DATE-COMPILED.                                                   00090023
001000                                                                  00100023
001100***************************************************************** 00110023
001200*                                                               * 00120023
001300*                 FREIGHT CHARGEBACK                            * 00130023
001400*---------------------------------------------------------------* 00140023
001500* NOTE: COPYBOOKS VLRD048 AND VLRD065 MUST BE KEPT IN SYNC      * 00150023
001600*---------------------------------------------------------------* 00160023
001700*  THIS PROGRAM WILL VALIDATE THE FOLLOWING FIELDS:             * 00170023
001800*---------------------------------------------------------------* 00180023
001900*  A.)  RULE #                                                  * 00190023
002000*                                                               * 00200023
002100*  B.)  PO NUMBER - AGAINST PO LOGISTICS DOMAIN TABLE           * 00210023
002200*                                                               * 00220023
002300*  C.)  RECEIVER SEQ NBR  - AGAINST TRECEIV DOMAIN TABLE        * 00230023
002400*                                                               * 00240023
002500*  D.)  DEBIT AMOUNT - SHOULD BE GREATER THAN ZEROS AND         * 00250023
002600*                 NOT GREATER THAN 99,999.00                    * 00260023
002700*                                                               * 00270023
002800*  E.)  DC NUMBER - AGAINST STORE LOGISTICS DOMAIN TABLE        * 00280023
002900*                                                               * 00290023
003000*---------------------------------------------------------------* 00300023
003100*  IT WILL PRODUCE THE FOLLOWING OUTPUT FILES:                  * 00310023
003200*---------------------------------------------------------------* 00320023
003300*  1.) FREIGHT CHARGEBACK FILE PER DATA MAPPING DOCUMENT        * 00330023
003400*  2.) FREIGHT CONTROL MARKER FILE                              * 00340023
003500*  3.) ERROR FILE                                               * 00350023
003600*  4.) FAL STATUS FILE                                          * 00360023
003700*                                                               * 00370023
003800*---------------------------------------------------------------* 00380023
003900*  IT WILL PRODUCE THE FOLLOWING REPORT:                        * 00390023
004000*---------------------------------------------------------------* 00400023
004100*  1.) ERROR REPORT INFORMATION FILE                            * 00410023
263627*---------------------------------------------------------------* 00411024
263627* CHANGED 11/05/2021    BY JIM HUNTER      WR: CHG0263627         00412024
263627* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00413024
263627* MAKING THE CALL DYNAMIC VS STATIC.                              00414024
263627*---------------------------------------------------------------* 00415024
004200*                                                               * 00420023
004300***************************************************************** 00430023
004400 ENVIRONMENT DIVISION.                                            00440023
004500***************************************************************** 00450023
004600                                                                  00460023
004700 CONFIGURATION SECTION.                                           00470023
004800                                                                  00480023
004900 SOURCE-COMPUTER.        IBM-3090.                                00490023
005000 OBJECT-COMPUTER.        IBM-3090.                                00500023
005100                                                                  00510023
005200 INPUT-OUTPUT SECTION.                                            00520023
005300                                                                  00530023
005400 FILE-CONTROL.                                                    00540023
005500                                                                  00550023
005600     SELECT FRT-EXTRACT-FILE                                      00560023
005700         ASSIGN TO INP01.                                         00570023
005800                                                                  00580023
005900     SELECT AUDIT-LOADER-FILE                                     00590023
006000         ASSIGN TO OUT01.                                         00600023
006100                                                                  00610023
006200     SELECT AUDIT-MARKER-FILE                                     00620023
006300         ASSIGN TO OUT02.                                         00630023
006400                                                                  00640023
006500     SELECT FRT-CHGBK-ERROR-FILE                                  00650023
006600         ASSIGN TO OUT03.                                         00660023
006700                                                                  00670023
006800     SELECT FAL-STATUS-FILE                                       00680023
006900         ASSIGN TO OUT04.                                         00690023
007000                                                                  00700023
007100     SELECT ERROR-REPORT-FILE                                     00710023
007200         ASSIGN TO RPT01.                                         00720023
007300                                                                  00730023
007400******************************************************************00740023
007500 DATA DIVISION.                                                   00750023
007600******************************************************************00760023
007700                                                                  00770023
007800 FILE SECTION.                                                    00780023
007900                                                                  00790023
008000 FD  FRT-EXTRACT-FILE                                             00800023
008100     RECORDING MODE IS F                                          00810023
008200     LABEL RECORDS ARE STANDARD                                   00820023
008300     BLOCK CONTAINS 0 RECORDS.                                    00830023
008400 01  FRT-EXTRACT-RECORD               PIC  X(4069).               00840023
008500                                                                  00850023
008600 FD  AUDIT-LOADER-FILE                                            00860023
008700     RECORDING MODE IS F                                          00870023
008800     BLOCK CONTAINS 0  RECORDS.                                   00880023
008900 01  AUDIT-LOADER-RECORD             PIC  X(4000).                00890023
009000                                                                  00900023
009100 FD  AUDIT-MARKER-FILE                                            00910023
009200     RECORDING MODE IS F                                          00920023
009300     BLOCK CONTAINS 0  RECORDS.                                   00930023
009400 01  AUDIT-MARKER-RECORD             PIC  X(91).                  00940023
009500                                                                  00950023
009600 FD  FRT-CHGBK-ERROR-FILE                                         00960023
009700     RECORDING MODE IS F                                          00970023
009800     BLOCK CONTAINS 0  RECORDS.                                   00980023
009900 01  FRT-CHGBK-ERROR-RECORD          PIC  X(4104).                00990023
010000                                                                  01000023
010100 FD  FAL-STATUS-FILE                                              01010023
010200     RECORDING MODE IS F                                          01020023
010300     BLOCK CONTAINS 0  RECORDS.                                   01030023
010400 01  FAL-STATUS-RECORD               PIC  X(4104).                01040023
010500                                                                  01050023
010600 FD  ERROR-REPORT-FILE                                            01060023
010700     RECORDING MODE IS F                                          01070023
010800     BLOCK CONTAINS 0  RECORDS.                                   01080023
010900 01  ERROR-REPORT-RECORD             PIC  X(200).                 01090023
011000                                                                  01100023
011100 WORKING-STORAGE SECTION.                                         01110023
011200                                                                  01120023
011300 01  FILLER                      PIC  X(46)    VALUE              01130023
011400     '** WORKING STORAGE FOR VLKUT045 STARTS HERE **'.            01140023
011500                                                                  01150023
011600 01  DK-PO-NUMBER                    PIC  S9(9) COMP.             01160023
011700 01  DK-DC-NUMBER                    PIC  S9(4) COMP.             01170023
011800                                                                  01180023
011900 01  PV-FRTPAD-RECORD.                                            01190023
012000     05  PV-FRTPAD-FIELDS          PIC  X(4069)  VALUE SPACE.     01200023
012100                                                                  01210023
012200 01  PROGRAM-SWITCHES.                                            01220023
012300     05  END-OF-FILE-SW              PIC  X(01)    VALUE 'Y'.     01230023
012400         88  END-OF-FILE                           VALUE 'N'.     01240023
012500     05  PO-FOUND-SWITCH             PIC X(01)     VALUE 'N'.     01250023
012600         88  PO-FOUND-NO                           VALUE 'N'.     01260023
012700         88  PO-FOUND-YES                          VALUE 'Y'.     01270023
012800     05  DC-FOUND-SWITCH             PIC X(01)     VALUE 'N'.     01280023
012900         88  DC-FOUND-NO                           VALUE 'N'.     01290023
013000         88  DC-FOUND-YES                          VALUE 'Y'.     01300023
013100     05  FIRST-RULE-SWITCH           PIC X(01)     VALUE 'Y'.     01310023
013200         88  FIRST-RULE-LN                         VALUE 'N'.     01320023
013300         88  NOT-FIRST-RULE-LN                     VALUE 'Y'.     01330023
013400     05  FRT-ERROR-SWITCH            PIC X(01)     VALUE 'N'.     01340023
013500         88  FRT-ERROR-YES                         VALUE 'Y'.     01350023
013600         88  FRT-ERROR-NO                          VALUE 'N'.     01360023
013700     05  PS-DUPLICATE-SWITCH         PIC X(01)     VALUE 'N'.     01370023
013800         88  PS-DUPLICATE                          VALUE 'Y'.     01380023
013900         88  PS-NO-DUPLICATE                       VALUE 'N'.     01390023
014000     05  PS-ERROR-SW                 PIC X(01)     VALUE 'N'.     01400023
014100         88  PS-ERROR-NO                           VALUE 'N'.     01410023
014200         88  PS-ERROR-YES                          VALUE 'Y'.     01420023
014300                                                                  01430023
014400 01  PT-TEXT-TABLES.                                              01440023
014500     05  PT-TEXT-1                   PIC X(200).                  01450023
014600     05  PT-TEXT-2                   PIC X(200).                  01460023
014700     05  PT-TEXT-3                   PIC X(200).                  01470023
014800                                                                  01480023
014900 01  PC-CONSTANTS.                                                01490023
015000     05  PC-MAX-RETRIES              PIC S9(04)    VALUE +3       01500023
015100                                                   COMP SYNC.     01510023
015200     05  PC-LINE-LIMIT               PIC S9(04)    VALUE +65.     01520023
015300     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          01530023
015400                                                   'VLKUT045'.    01540023
015500     05  PC-TEXT-FLOW-PROGRAM        PIC  X(08)    VALUE          01550023
015600                                                   'RCKUT066'.    01560023
015700     05  PC-REPORT-NBR-1             PIC  9(01)    VALUE 1.       01570023
015800                                                                  01580023
015900     05  PC-COMMA                    PIC X(01)     VALUE ','.     01590023
016000     05  PC-PERIOD                   PIC X(01)     VALUE '.'.     01600023
016100                                                                  01610023
016200     05  PC-AMOUNT                   PIC  9(09)V99                01620023
016300                                         VALUE  99999.99.         01630023
016400     05  PC-MIN-AMOUNT               PIC  9(09)V99                01640023
016500                                         VALUE      1.00.         01650023
016600 01  PV-ACCUMULATOR-FIELDS.                                       01660023
016700     05  PV-FRT-CHRG-AMT-N           PIC 9(09)V99.                01670023
016800     05  PV-FRT-CHRG-AMT             PIC X(12).                   01680023
016900     05  FILLER                                                   01690023
017000         REDEFINES PV-FRT-CHRG-AMT.                               01700023
017100         10  PV-FRT-INTEGER1         PIC 9(09).                   01710023
017200         10  PV-FRT-DECIMAL          PIC X.                       01720023
017300         10  PV-FRT-INTEGER2         PIC 9(02).                   01730023
017400     05  PV-FRT-CHRG-AMT-12.                                      01740023
017500         10  PV-FRT-FIRST-2          PIC X(02).                   01750023
017600         10  PV-FRT-LAST-10          PIC X(10).                   01760023
017700******************************************************************01770023
017800     05  PV-PO-NUMBER-N              PIC 9(09)V99.                01780023
017900     05  PV-PO-NUMBER                PIC X(12).                   01790023
018000                                                                  01800023
018100     05  PV-RETRY-COUNT              PIC S9(04)  VALUE +0         01810023
018200                                                   COMP SYNC.     01820023
018300     05  PV-COMMA-COUNT              PIC S9(04)  VALUE +0         01830023
018400                                                   COMP SYNC.     01840023
018500     05  PV-PAGE-CNT                 PIC S9(04)    VALUE ZERO     01850023
018600                                                   COMP-3.        01860023
018700     05  PV-LINE-CNT                 PIC S9(04)    VALUE ZERO     01870023
018800                                                   COMP SYNC.     01880023
018900     05  PV-SEQ-NBR                  PIC S9(04)    VALUE ZERO     01890023
019000                                                   COMP SYNC.     01900023
019100     05  PV-MARKER-CNT               PIC  9(13)    VALUE ZERO.    01910023
019200     05  PV-MARKER-TRAN-AMT          PIC 9(09)V9999               01920023
019300                                                   VALUE ZERO.    01930023
019400     05  PV-TOT-MARKER-AMT           PIC 9(09)V9999               01940023
019500                                                   VALUE ZERO.    01950023
019600***** FILE NAME CONSISTS OF RUN-DATE-CN_FRGTAUDITMARK.MKR         01960023
019700*****     EXAMPLE: 20050317_FRGTAUDITMARK.MKR                     01970023
019800     05  PV-FILE-NAME.                                            01980023
019900         10  PV-CREATE-DATE           PIC  X(08) VALUE SPACES.    01990023
020000         10  PV-UNDERSCORE            PIC  X(01) VALUE '_'.       02000023
020100         10  PV-AUDTLOAD-MKR          PIC  X(17) VALUE SPACES.    02010023
020200                                                                  02020023
020300 01  PV-ABEND-FIELDS.                                             02030023
020400     05  PV-ABEND-CODE               PIC S9(04)  VALUE ZERO       02040023
020500                                                   COMP SYNC.     02050023
020600     05  PV-DB2-OPERATION-ATTEMPTED  PIC  X(30)  VALUE SPACES.    02060023
020700     05  PV-ABEND-PROGRAM             PIC X(8)   VALUE 'VLKUT045'.02070023
020800     05  PV-ABEND-PARAGRAPH           PIC X(50)  VALUE SPACES.    02080023
020900     05  PV-ABEND-OPERATION           PIC X(50)  VALUE SPACES.    02090023
021000     05  PV-ABEND-STRUCTURE-1         PIC X(8)   VALUE SPACES.    02100023
021100     05  PV-ABEND-STRUCTURE-2         PIC X(8)   VALUE SPACES.    02110023
021200     05  PV-ABEND-STRUCTURE-3         PIC X(8)   VALUE SPACES.    02120023
021300     05  PV-DB2-OPERATION-MESSAGE-1   PIC  X(79) VALUE SPACES.    02130023
021400     05  PV-SQLCODE                   PIC 9(9)   VALUE ZERO.      02140023
021500                                                                  02150023
021600 01  PV-MISC-FIELDS.                                              02160023
021700     05  PV-READ-COUNT               PIC  S9(9)     VALUE ZERO    02170023
021800                                                    COMP-3.       02180023
021900     05  PV-STATUS-WRITE-CNT         PIC   9(09)    VALUE ZERO.   02190023
022000     05  PV-ERROR-CNT                PIC   9(09)    VALUE ZERO.   02200023
022100     05  PV-BAD-REC-CNT              PIC   9(09)    VALUE ZERO.   02210023
022200     05  PV-DUP-REC-CNT              PIC   9(09)    VALUE ZERO.   02220023
022300     05  PV-GOOD-REC-CNT             PIC   9(09)    VALUE ZERO.   02230023
022400     05  PV-TOTAL-REC-CNT            PIC   9(09)    VALUE ZERO.   02240023
022500     05  PV-BAD-FRGT-AMT             PIC   9(07)V99 VALUE ZERO.   02250023
022600     05  PV-DUP-FRGT-AMT             PIC   9(07)V99 VALUE ZERO.   02260023
022700     05  PV-GOOD-FRGT-AMT            PIC   9(07)V99 VALUE ZERO.   02270023
022800     05  PV-TOTAL-FRGT-AMT           PIC   9(09)V99 VALUE ZERO.   02280023
022900     05  PV-COMMENT-FIELD.                                        02290023
023000         10  PV-COMMENT-500          PIC   X(500)   VALUE SPACE.  02300023
023100         10  PV-COMMENT-REST         PIC   X(3345)  VALUE SPACE.  02310023
023200     05  PV-ERROR                    PIC   X(19)    VALUE SPACES. 02320023
023300     05  PV-ENT-ID                   PIC  S9(09)    VALUE ZERO    02330023
023400                                                    COMP SYNC.    02340023
023500     05  PV-VEND-NAME.                                            02350023
023600         10  PV-VEND-NME             PIC X(19)     VALUE SPACE.   02360023
023700         10  PV-FILL                 PIC X(11)     VALUE SPACE.   02370023
023800     05  PV-PRINT-RECORD             PIC X(200)    VALUE SPACES.  02380023
023900     05  PV-LINE-SPACING             PIC S9(04)    VALUE ZERO     02390023
024000                                                   COMP SYNC.     02400023
024100     05  PV-CURRENT-TMST-DB2         PIC X(26)     VALUE SPACE.   02410023
024200     05  PV-CURRENT-TMST.                                         02420023
024300         10  PV-CURR-DATE.                                        02430023
024400             15  PV-CURR-DATE-CC     PIC  9(02)    VALUE ZERO.    02440023
024500             15  PV-CURR-DATE-YY     PIC  9(02)    VALUE ZERO.    02450023
024600             15  PV-CURR-DASH1       PIC  X        VALUE SPACE.   02460023
024700             15  PV-CURR-DATE-MM     PIC  9(02)    VALUE ZERO.    02470023
024800             15  PV-CURR-DASH2       PIC  X        VALUE SPACE.   02480023
024900             15  PV-CURR-DATE-DD     PIC  9(02)    VALUE ZERO.    02490023
025000             15  PV-CURR-DASH3       PIC  X        VALUE SPACE.   02500023
025100         10  PV-CURR-TIME.                                        02510023
025200             15  PV-CURR-TIME-HH     PIC  9(02)    VALUE ZERO.    02520023
025300             15  PV-CURR-TIME-P1     PIC  X        VALUE SPACE.   02530023
025400             15  PV-CURR-TIME-MM     PIC  9(02)    VALUE ZERO.    02540023
025500             15  PV-CURR-TIME-P2     PIC  X        VALUE SPACE.   02550023
025600             15  PV-CURR-TIME-SS     PIC  9(02)    VALUE ZERO.    02560023
025700             15  FILL                PIC  X(07)    VALUE SPACE.   02570023
025800                                                                  02580023
025900     05  PV-NULL-IND                 PIC  S9(4)    VALUE ZERO     02590023
026000                                                   COMP SYNC.     02600023
026100     05  PV-DB2-COUNT                PIC  S9(9)    VALUE ZERO     02610023
026200                                                   COMP-3.        02620023
026300     05  PV-DISP-NBR-C               PIC  ZZ,ZZZ,ZZ9.             02630023
026400     05  PV-DISP-DOLLARS-C           PIC  ZZZZ,ZZZ,ZZ9.99.        02640023
026500     05  PV-DISP-NBR                 PIC  ZZZZZZZ9.               02650023
026600     05  PV-DISP-DOLLARS             PIC  ZZZZZZZZZ9.99.          02660023
026700     05  PV-HOLD-REC                 PIC  X(4069) VALUE SPACES.   02670023
026800                                                                  02680023
026900     05  PV-CURR-CCYY.                                            02690023
027000         10  PV-CURR-CC              PIC  X(02)    VALUE SPACE.   02700023
027100         10  PV-CURR-YY              PIC  X(02)    VALUE SPACE.   02710023
027200                                                                  02720023
027300     05  PV-MARKER-DATE.                                          02730023
027400         10  PV-MARKER-CCYY          PIC  X(04)    VALUE SPACE.   02740023
027500         10  PV-MARKER-MM            PIC  X(02)    VALUE SPACE.   02750023
027600         10  PV-MARKER-DD            PIC  X(02)    VALUE SPACE.   02760023
027700                                                                  02770023
027800     05  PV-MARKER-TIME.                                          02780023
027900         10  PV-MARKER-HH            PIC  X(02)    VALUE SPACE.   02790023
028000         10  PV-MARKER-MN            PIC  X(02)    VALUE SPACE.   02800023
028100         10  PV-MARKER-SS            PIC  X(02)    VALUE SPACE.   02810023
028200                                                                  02820023
028300     05  PV-AUDIT-TIMESTAMP.                                      02830023
028400         10  PV-AUDIT-MM             PIC  9(02)  VALUE ZERO.      02840023
028500         10  PV-SLASH-1              PIC  X      VALUE '/'.       02850023
028600         10  PV-AUDIT-DD             PIC  9(02)  VALUE ZERO.      02860023
028700         10  PV-SLASH-2              PIC  X      VALUE '/'.       02870023
028800         10  PV-AUDIT-YY             PIC  9(02)  VALUE ZERO.      02880023
028900         10  FILLER                  PIC  X      VALUE SPACE.     02890023
029000         10  PV-AUDIT-HH             PIC  9(02)  VALUE ZERO.      02900023
029100         10  PV-COL-1                PIC  X      VALUE ':'.       02910023
029200         10  PV-AUDIT-MN             PIC  9(02)  VALUE ZERO.      02920023
029300         10  PV-COL-2                PIC  X      VALUE ':'.       02930023
029400         10  PV-AUDIT-SS             PIC  9(02)  VALUE ZERO.      02940023
029500                                                                  02950023
029510     05  PV-CNRULES.                                              02960023
029520         10  PV-RULE-01              PIC  X(02)  VALUE SPACE.     02970023
029530         10  FILLER                  PIC  X.                      02980023
029531         10  PV-RULE-02              PIC  X(02)  VALUE SPACE.     02990023
029532         10  FILLER                  PIC  X.                      03000023
029533         10  PV-RULE-03              PIC  X(02)  VALUE SPACE.     03010023
029534         10  FILLER                  PIC  X.                      03020023
029535         10  PV-RULE-04              PIC  X(02)  VALUE SPACE.     03030023
029536         10  FILLER                  PIC  X.                      03040023
029537         10  PV-RULE-05              PIC  X(02)  VALUE SPACE.     03050023
029538         10  FILLER                  PIC  X.                      03060023
029539         10  PV-RULE-06              PIC  X(02)  VALUE SPACE.     03070023
029540         10  FILLER                  PIC  X.                      03080023
029541         10  PV-RULE-07              PIC  X(02)  VALUE SPACE.     03090023
029542         10  FILLER                  PIC  X.                      03100023
029543         10  PV-RULE-08              PIC  X(02)  VALUE SPACE.     03110023
029544         10  FILLER                  PIC  X(02).                  03120023
029600******************************************************************03130023
029700*  WORK FIELDS FOR PRINTING A 200 CHARACTER REPORT.               03140023
029800******************************************************************03150023
029900     COPY DPWS200O.                                               03160023
030000                                                                  03170023
030100******************************************************************03180023
030200*  REPORT HEADINGS.                                               03190023
030300******************************************************************03200023
030400 01  HL1-HEADING-LINE-1.                                          03210023
030500     05  FILLER                  PIC  X(85)    VALUE SPACES.      03220023
030600     05  FILLER                  PIC  X(35)    VALUE              03230023
030700         'RETAIL COMPLIANCE MANAGEMENT SYSTEM'.                   03240023
030800     05  FILLER                  PIC  X(80)    VALUE SPACES.      03250023
030900                                                                  03260023
031000 01  HL2-HEADING-LINE-2.                                          03270023
031100     05  FILLER                  PIC X(87)     VALUE SPACES.      03280023
031200     05  FILLER                  PIC X(31)     VALUE              03290023
031300         'FREIGHT CHARGEBACK ERROR REPORT'.                       03300023
031400     05  FILLER                  PIC X(82)     VALUE SPACES.      03310023
031500                                                                  03320023
031600 01  HL3-HEADING-LINE-3.                                          03330023
031700     05  FILLER                  PIC X(01)     VALUE SPACE.       03340023
031800     05  FILLER                  PIC X(17)     VALUE              03350023
031900         'AUDIT TIMESTAMP: '.                                     03360023
032000     05  HL3-AUDIT-TIMESTAMP     PIC X(17)     VALUE SPACES.      03370023
032100                                                                  03380023
032200 01  HL4-HEADING-LINE-4.                                          03390023
032300     05  FILLER                  PIC X(01)     VALUE SPACE.       03400023
032400     05  FILLER                  PIC X(05)     VALUE              03410023
032500         'RULE/'.                                                 03420023
032600     05  FILLER                  PIC X(32)     VALUE SPACES.      03430023
032700     05  FILLER                  PIC X(07)     VALUE              03440023
032800         'FREIGHT'.                                               03450023
032900     05  FILLER                  PIC X(20)     VALUE SPACES.      03460023
033000     05  FILLER                  PIC X(07)     VALUE              03470023
033100         'CARRIER'.                                               03480023
033200     05  FILLER                  PIC X(04)     VALUE SPACES.      03490023
033300     05  FILLER                  PIC X(08)     VALUE              03500023
033400         'DELIVERY'.                                              03510023
033500     05  FILLER                  PIC X(04)     VALUE SPACES.      03520023
033600     05  FILLER                  PIC X(07)     VALUE              03530023
033700         'FREIGHT'.                                               03540023
033800                                                                  03550023
033900 01  HL5-HEADING-LINE-5.                                          03560023
034000     05  FILLER                  PIC X(01)     VALUE SPACE.       03570023
034100     05  FILLER                  PIC X(08)     VALUE              03580023
034200         'COMMENTS'.                                              03590023
034300     05  FILLER                  PIC X(01)     VALUE SPACE.       03600023
034400     05  FILLER                  PIC X(11)     VALUE              03610023
034500         'VENDOR NAME'.                                           03620023
034600     05  FILLER                  PIC X(19)     VALUE SPACE.       03630023
034700     05  FILLER                  PIC X(06)     VALUE              03640023
034800         'CHARGE'.                                                03650023
034900     05  FILLER                  PIC X(06)     VALUE SPACE.       03660023
035000     05  FILLER                  PIC X(02)     VALUE              03670023
035100         'PO'.                                                    03680023
035200     05  FILLER                  PIC X(05)     VALUE SPACE.       03690023
035300     05  FILLER                  PIC X(04)     VALUE              03700023
035400         'SITE'.                                                  03710023
035500     05  FILLER                  PIC X(03)     VALUE SPACE.       03720023
035600     05  FILLER                  PIC X(08)     VALUE              03730023
035700         'AUTH NBR'.                                              03740023
035800     05  FILLER                  PIC X(05)     VALUE SPACE.       03750023
035900     05  FILLER                  PIC X(07)     VALUE              03760023
036000         'ORDER #'.                                               03770023
036100     05  FILLER                  PIC X(05)     VALUE SPACE.       03780023
036200     05  FILLER                  PIC X(06)     VALUE              03790023
036300         'BILL #'.                                                03800023
036400     05  FILLER                  PIC X(01)     VALUE SPACE.       03810023
036500     05  FILLER                  PIC X(04)     VALUE              03820023
036600         'SCAC'.                                                  03830023
036700     05  FILLER                  PIC X(01)     VALUE SPACE.       03840023
036800     05  FILLER                  PIC X(10)     VALUE              03850023
036900         'FAX AUTH #'.                                            03860023
037000     05  FILLER                  PIC X(12)     VALUE SPACE.       03870023
037100     05  FILLER                  PIC X(05)     VALUE              03880023
037200         'PRO #'.                                                 03890023
037300     05  FILLER                  PIC X(08)     VALUE SPACE.       03900023
037400     05  FILLER                  PIC X(09)     VALUE              03910023
037500         'INVOICE #'.                                             03920023
037600     05  FILLER                  PIC X(03)     VALUE SPACE.       03930023
037700     05  FILLER                  PIC X(07)     VALUE              03940023
037800         'CARTONS'.                                               03950023
037900     05  FILLER                  PIC X(06)     VALUE SPACE.       03960023
038000     05  FILLER                  PIC X(06)     VALUE              03970023
038100         'WEIGHT'.                                                03980023
038200     05  FILLER                  PIC X(07)     VALUE SPACE.       03990023
038300     05  FILLER                  PIC X(11)     VALUE              04000023
038400         'CUBES ERROR'.                                           04010023
038500                                                                  04020023
038600                                                                  04030023
038700******************************************************************04040023
038800*  REPORT DETAIL LINE.                                            04050023
038900******************************************************************04060023
039000 01  DL1-DETAIL-LINE-1.                                           04070023
039100     05  FILLER                  PIC X(01)     VALUE SPACES.      04080023
039200     05  DL1-RULE                PIC X(05)     VALUE SPACES.      04090023
039300     05  FILLER                  PIC X(04)     VALUE SPACES.      04100023
039400     05  DL1-VENDOR-NAME         PIC X(19)     VALUE SPACES.      04110023
039500     05  FILLER                  PIC X(01)     VALUE SPACES.      04120023
039600     05  DL1-FRT-CHARGE          PIC ZZZ,ZZZ,ZZ9.9999-            04130023
039700                                               VALUE ZEROES.      04140023
039800     05  FILLER                  PIC X(01)     VALUE SPACES.      04150023
039900     05  DL1-PO-NBR              PIC X(09)     VALUE SPACES.      04160023
040000     05  FILLER                  PIC X(01)     VALUE SPACES.      04170023
040100     05  DL1-SITE                PIC ZZZZZ     VALUE ZEROES.      04180023
040200     05  FILLER                  PIC X(01)     VALUE SPACES.      04190023
040300     05  DL1-AUTH-NBR            PIC X(10)     VALUE SPACES.      04200023
040400     05  FILLER                  PIC X(01)     VALUE SPACES.      04210023
040500     05  DL1-ORDER-NBR           PIC X(11)     VALUE SPACES.      04220023
040600     05  FILLER                  PIC X(01)     VALUE SPACES.      04230023
040700     05  DL1-FRT-NBR             PIC X(10)     VALUE SPACES.      04240023
040800     05  FILLER                  PIC X(01)     VALUE SPACES.      04250023
040900     05  DL1-SCAC                PIC X(04)     VALUE SPACES.      04260023
041000     05  FILLER                  PIC X(01)     VALUE SPACES.      04270023
041100     05  DL1-FAX-NBR             PIC X(20)     VALUE SPACES.      04280023
041200     05  FILLER                  PIC X(01)     VALUE SPACES.      04290023
041300     05  DL1-PRO-NBR             PIC X(10)     VALUE SPACES.      04300023
041400     05  FILLER                  PIC X(01)     VALUE SPACES.      04310023
041500     05  DL1-INVOICE-NBR         PIC X(10)     VALUE SPACES.      04320023
041600     05  FILLER                  PIC X(01)     VALUE SPACES.      04330023
041700     05  DL1-CARTONS-X           PIC X(11).                       04340023
041800     05  DL1-CARTONS REDEFINES DL1-CARTONS-X   PIC ZZZ,ZZZ,ZZ9.   04350023
041900     05  FILLER                  PIC X(01)     VALUE SPACES.      04360023
042000     05  DL1-WEIGHT-X            PIC X(11).                       04370023
042100     05  DL1-WEIGHT REDEFINES DL1-WEIGHT-X    PIC ZZZ,ZZZ,ZZ9.    04380023
042200     05  FILLER                  PIC X(01)     VALUE SPACES.      04390023
042300     05  DL1-CUBES-X             PIC X(11).                       04400023
042400     05  DL1-CUBES REDEFINES DL1-CUBES-X      PIC ZZZ,ZZZ,ZZ9.    04410023
042500     05  FILLER                  PIC X(01)     VALUE SPACES.      04420023
042600     05  DL1-ERROR               PIC X(19)     VALUE SPACES.      04430023
042700                                                                  04440023
042800******************************************************************04450023
042900*  REPORT DETAIL COMMENT LINE.                                    04460023
043000******************************************************************04470023
043100 01  DL2-DETAIL-COMMENT-LINE.                                     04480023
043200     05  FILLER                  PIC X(01)     VALUE SPACES.      04490023
043300     05  DL2-COMMENT             PIC X(199)    VALUE SPACES.      04500023
043400                                                                  04510023
043500                                                                  04520023
043600 01  MISCELLANEOUS-LINES.                                         04530023
043700     05  END-OF-REPORT-LINE.                                      04540023
043800         10  FILLER                  PIC  X(90)    VALUE SPACES.  04550023
043900         10  FILLER                  PIC  X(45)    VALUE          04560023
044000             '*******   E N D   O F   R E P O R T   *******'.     04570023
044100         10  FILLER                  PIC  X(65)    VALUE SPACES.  04580023
044200     05  INVALID-RECORD-LINE.                                     04590023
044300         10  FILLER                  PIC  X(06)    VALUE 'RECORD'.04600023
044400         10  RECORD-NBR              PIC  ZZZZZZZ9.               04610023
044500         10  FILLER                  PIC  X(16).                  04620023
044600         10  FILLER                  PIC  X(45)    VALUE          04630023
044700             '*******  I N V A L I D   R E C O R D  *******'.     04640023
044800         10  FILLER                  PIC  X(125)   VALUE SPACES.  04650023
044900                                                                  04660023
045000******************************************************************04670023
045100*  COPYBOOKS.                                                     04680023
045200******************************************************************04690023
045300*                                                                 04700023
045400*----------------------------------------------------------------*04710023
045500*    NUMERIC EDIT ROUTINE LAYOUT                                  04720023
045600*----------------------------------------------------------------*04730023
045700     COPY DPWS010I.                                               04740023
045800*----------------------------------------------------------------*04750023
045900*    FREIGHT CHARGEBACK EXTRACT FILE LAYOUT                       04760023
046000*----------------------------------------------------------------*04770023
046100     COPY VLRD045.                                                04780023
046200*----------------------------------------------------------------*04790023
046300*                                                                 04800023
046400*    FREIGHT CHARGEBACK AUDIT LOADER FILE LAYOUT                  04810023
046500*----------------------------------------------------------------*04820023
046600     COPY VLRD046.                                                04830023
046700*                                                                 04840023
046800*----------------------------------------------------------------*04850023
046900*    FREIGHT CHARGEBACK AUDIT LOADER MARKER FILE LAYOUT           04860023
047000*----------------------------------------------------------------*04870023
047100     COPY VLRD047.                                                04880023
047200*                                                                 04890023
047300*----------------------------------------------------------------*04900023
047400*    FREIGHT CHARGEBACK ERROR FILE LAYOUT                         04910023
047500*----------------------------------------------------------------*04920023
047600     COPY VLRD048.                                                04930023
047700*                                                                 04940023
047800*----------------------------------------------------------------*04950023
047900*    FAL STATUS FILE LAYOUT                                       04960023
048000*----------------------------------------------------------------*04970023
048100     COPY VLRD065.                                                04980023
048200*                                                                 04990023
048300*----------------------------------------------------------------*05000023
048400*    TEXT FLOW UTILITY  COPYBOOK                                  05010023
048500*----------------------------------------------------------------*05020023
048600     COPY RCWS035.                                                05030023
048700*----------------------------------------------------------------*05040023
048800                                                                  05050023
048900                                                                  05060023
049000***************************************************************** 05070023
049100*  *** DB2 MESSAGE AREAS ****                                   * 05080023
049200***************************************************************** 05090023
049300     COPY DPWS004.                                                05100023
049400                                                                  05110023
049500*---------------------------------------------------------------* 05120023
049600*    DB2 AREA FOR TENTNME - ENTITY NAME                         * 05130023
049700*---------------------------------------------------------------* 05140023
049800     EXEC SQL                                                     05150023
049900          INCLUDE TENTNME                                         05160023
050000     END-EXEC.                                                    05170023
050100                                                                  05180023
050200*---------------------------------------------------------------* 05190023
050300*    DB2 AREA FOR TPURCHS - PURCHASE ORDER HEADER TABLE         * 05200023
050400*---------------------------------------------------------------* 05210023
050500     EXEC SQL                                                     05220023
050600          INCLUDE TPURCHS                                         05230023
050700     END-EXEC.                                                    05240023
050800                                                                  05250023
050900*---------------------------------------------------------------* 05260023
051000*    DB2 AREA FOR TRECEIV - PURCHASE ORDER RECEIVER TABLE       * 05270023
051100*---------------------------------------------------------------* 05280023
051200     EXEC SQL                                                     05290023
051300          INCLUDE TRECEIV                                         05300023
051400     END-EXEC.                                                    05310023
051500                                                                  05320023
051600*---------------------------------------------------------------* 05330023
051700*    DB2 AREA FOR XLT_LOC - DC LOCATION TABLE                   * 05340023
051800*---------------------------------------------------------------* 05350023
051900     EXEC SQL                                                     05360023
052000          INCLUDE XLT00010                                        05370023
052100     END-EXEC.                                                    05380023
052200                                                                  05390023
052210*---------------------------------------------------------------* 05400023
052220*    DB2 AREA FOR TKRPRPM - PARAMETER TABLE                     * 05410023
052230*---------------------------------------------------------------* 05420023
052240     EXEC SQL                                                     05430023
052250          INCLUDE TKRPRPM                                         05440023
052260     END-EXEC.                                                    05450023
052270                                                                  05460023
052300*---------------------------------------------------------------* 05470023
052400*    DB2 AREA FOR COMMUNICATIONS                                * 05480023
052500*---------------------------------------------------------------* 05490023
052600     EXEC SQL                                                     05500023
052700          INCLUDE SQLCA                                           05510023
052800     END-EXEC.                                                    05520023
052900                                                                  05530023
053000***************************************************************** 05540023
053100                                                                  05550023
053200 LINKAGE SECTION.                                                 05560023
053300                                                                  05570023
053400***************************************************************** 05580023
053500 PROCEDURE DIVISION.                                              05590023
053600***************************************************************** 05600023
053700                                                                  05610023
053800 0000-MAINLINE-PROCESSING.                                        05620023
053900                                                                  05630023
054000     PERFORM 1000-INITIALIZATION.                                 05640023
054100                                                                  05650023
054200     PERFORM 2000-PROCESS-EXTRACT-RECS                            05660023
054300       UNTIL END-OF-FILE.                                         05670023
054400     PERFORM 2400-BUILD-FRT-MARKER-FILE.                          05680023
054500     PERFORM 3500-PRINT-END-OF-RPT-LINE.                          05690023
054600                                                                  05700023
054700     PERFORM 8500-SHOW-COUNTERS                                   05710023
054800     PERFORM 8600-WRITE-STATUS-TOTALS.                            05720023
054900                                                                  05730023
055000     CLOSE FRT-EXTRACT-FILE                                       05740023
055100           AUDIT-LOADER-FILE                                      05750023
055200           AUDIT-MARKER-FILE                                      05760023
055300           FRT-CHGBK-ERROR-FILE                                   05770023
055400           FAL-STATUS-FILE                                        05780023
055500           ERROR-REPORT-FILE.                                     05790023
055600     STOP RUN.                                                    05800023
055700                                                                  05810023
055800 1000-INITIALIZATION.                                             05820023
055900*    DISPLAY '1000-INITIALIZATION'.                               05830023
056000******************************************************************05840023
056100*  OPEN FILES AND READ THE FIRST INPUT RECORD                    *05850023
056200******************************************************************05860023
056300                                                                  05870023
056400     OPEN INPUT  FRT-EXTRACT-FILE                                 05880023
056500          OUTPUT AUDIT-LOADER-FILE                                05890023
056600                 AUDIT-MARKER-FILE                                05900023
056700                 FRT-CHGBK-ERROR-FILE                             05910023
056800                 FAL-STATUS-FILE                                  05920023
056900                 ERROR-REPORT-FILE.                               05930023
057000                                                                  05940023
057100** GET CURRENT TIMESTAMP                                          05950023
057200                                                                  05960023
057300     EXEC SQL                                                     05970023
057400         SET :PV-CURRENT-TMST-DB2 = CURRENT TIMESTAMP             05980023
057500     END-EXEC.                                                    05990023
057600                                                                  06000023
057700     EVALUATE TRUE                                                06010023
057800         WHEN SQLCODE = ZERO                                      06020023
057900             MOVE PV-CURRENT-TMST-DB2    TO PV-CURRENT-TMST       06030023
058000             MOVE PV-CURR-DATE-CC        TO PV-CURR-CC            06040023
058100             MOVE PV-CURR-DATE-YY        TO PV-CURR-YY            06050023
058200                                                                  06060023
058300             MOVE PV-CURR-DATE-MM        TO DP200O-RUN-MONTH      06070023
058400                                            PV-AUDIT-MM           06080023
058500             MOVE PV-CURR-DATE-DD        TO DP200O-RUN-DAY        06090023
058600                                            PV-AUDIT-DD           06100023
058700             MOVE PV-CURR-DATE-YY        TO DP200O-RUN-YEAR       06110023
058800                                            PV-AUDIT-YY           06120023
058900                                                                  06130023
059000             MOVE PV-CURR-TIME-HH        TO DP200O-RUN-HOUR       06140023
059100             MOVE PV-CURR-TIME-MM        TO DP200O-RUN-MINUTE     06150023
059200                                                                  06160023
059300             MOVE PV-CURR-CCYY           TO PV-MARKER-CCYY        06170023
059400             MOVE PV-CURR-DATE-MM        TO PV-MARKER-MM          06180023
059500             MOVE PV-CURR-DATE-DD        TO PV-MARKER-DD          06190023
059600             MOVE PV-CURR-TIME-HH        TO PV-MARKER-HH          06200023
059700                                            PV-AUDIT-HH           06210023
059800             MOVE PV-CURR-TIME-MM        TO PV-MARKER-MN          06220023
059900                                            PV-AUDIT-MN           06230023
060000             MOVE PV-CURR-TIME-SS        TO PV-MARKER-SS          06240023
060100                                            PV-AUDIT-SS           06250023
060200             MOVE PV-AUDIT-TIMESTAMP TO HL3-AUDIT-TIMESTAMP       06260023
060300                                                                  06270023
060400         WHEN OTHER                                               06280023
060500             MOVE '1000-INITIALIZATION'  TO PV-ABEND-PARAGRAPH    06290023
060600             MOVE 'SET CURRENT TIMESTAMP'                         06300023
060700                                         TO PV-ABEND-OPERATION    06310023
060800             PERFORM 9900-DB2-ABEND                               06320023
060900         END-EVALUATE.                                            06330023
061000                                                                  06340023
061100     MOVE PC-CURRENT-PROGRAM-NAME                                 06350023
061200                                 TO DP200O-PROGRAM-NAME.          06360023
061300     MOVE ZERO TO PV-SEQ-NBR.                                     06370023
061400                                                                  06380023
061500     SET FIRST-RULE-LN TO TRUE.                                   06390023
061600                                                                  06400023
061610     PERFORM 1100-GET-VALID-CN-RULES.                             06410023
061620                                                                  06420023
061700     PERFORM 8000-PRINT-HEADINGS                                  06430023
061800                                                                  06440023
061900     PERFORM 7000-READ-INPUT.                                     06450023
062000                                                                  06460023
062100                                                                  06470023
062120******************************************************************06480023
062130* GET THE LIST OF VALID PREFIXES FOR THE COMPLIANDE NETWORKS      06490023
062140* REVOLUTION RULES.  THE PARM IS CURRENTLY SET UP TO GET UP       06500023
062141* TO 8 PREFIXES.                                                  06510023
062142* ADDED DMH 12/12/11                                              06520023
062150******************************************************************06530023
062160 1100-GET-VALID-CN-RULES.                                         06540023
062161                                                                  06550023
062162     MOVE  SPACES  TO  PV-CNRULES.                                06560023
062163                                                                  06570023
062164     EXEC SQL                                                     06580023
062165          SELECT   FUNC_TXT                                       06590023
062166            INTO  :KRPRPM-FUNC-TXT                                06600023
062169            FROM                                                  06610023
062170                  TKRPRPM A                                       06620023
062171            WHERE                                                 06630023
062172                  LOC_ID            =  90                         06640023
062173              AND SYS_PRC_FUNC_CDE  = 'CNRULE'                    06650023
062174              AND FUNC_PRC_STAT_CDE = 'AC'                        06660023
062175              AND INTFC_SYS_CDE     = 'CNR'                       06670023
062176              AND FUNC_BEG_TMST    <=  CURRENT TIMESTAMP          06680023
062177              AND FUNC_END_TMST    >=  CURRENT TIMESTAMP          06690023
062178     END-EXEC.                                                    06700023
062179                                                                  06710023
062180        EVALUATE TRUE                                             06720023
062181            WHEN SQLCODE = ZERO                                   06730023
062182                 MOVE  KRPRPM-FUNC-TXT                            06740023
062183                   TO  PV-CNRULES                                 06750023
062184                 DISPLAY 'CNRULE: ' PV-CNRULES                    06760023
062186            WHEN OTHER                                            06770023
062187                MOVE '1100-GET-VALID-CN-RULES'                    06780023
062188                               TO PV-ABEND-PARAGRAPH              06790023
062189                MOVE 'PARM CNRULE FROM PARM'                      06800023
062190                               TO PV-ABEND-OPERATION              06810023
062191                MOVE 'TKRPRPM' TO PV-ABEND-STRUCTURE-1            06820023
062192                MOVE SPACES    TO PV-ABEND-STRUCTURE-2            06830023
062193                PERFORM 9900-DB2-ABEND                            06840023
062194        END-EVALUATE.                                             06850023
062196                                                                  06860023
062197                                                                  06870023
062200******************************************************************06880023
062300* UNSTRING THE DATA COMING IN. IT IS COMMA DELIMITED AND THE      06890023
062400*    FIELDS NEED TO BE SEPARATED.                                 06900023
062500******************************************************************06910023
062600 1310-UNSTRING-FRTPAD.                                            06920023
062700*    DISPLAY '1310-UNSTRING-FRTPAD'.                              06930023
062800     SET PS-ERROR-NO              TO TRUE                         06940023
062900     UNSTRING PV-FRTPAD-FIELDS DELIMITED BY ','                   06950023
063000         INTO VL045-RULE-NBR                                      06960023
063100              VL045-RULE-DESC                                     06970023
063200              VL045-FREIGHT-CHRG                                  06980023
063300              VL045-PO-NBR                                        06990023
063400              VL045-CARRIER-AUTH-NBR                              07000023
063500              VL045-DELIVERY-ORDER-NBR                            07010023
063600              VL045-DC                                            07020023
063700              VL045-FAX-AUTH-NBR                                  07030023
063800              VL045-SCAC                                          07040023
063900              VL045-FREIGHT-BILL                                  07050023
064000              VL045-PRO-NBR                                       07060023
064100              VL045-INVOICE-NBR                                   07070023
064200              VL045-CARTON-CNT                                    07080023
064300              VL045-WEIGHT                                        07090023
064400              VL045-CUBES                                         07100023
064500              VL045-COMMENTS                                      07110023
064600      ON OVERFLOW                                                 07120023
064700         MOVE PV-READ-COUNT           TO PV-DISP-NBR              07130023
064800         DISPLAY 'INPUT RECORD ' PV-DISP-NBR                      07140023
064900                  ' HAS OVERFLOWED'                               07150023
065000         DISPLAY 'SKIPPING TO NEXT RECORD'                        07160023
065100         SET PS-ERROR-YES             TO TRUE                     07170023
065200     END-UNSTRING.                                                07180023
065300                                                                  07190023
065400 2000-PROCESS-EXTRACT-RECS.                                       07200023
065500                                                                  07210023
065600     INSPECT PV-FRTPAD-FIELDS                                     07220023
065700         TALLYING PV-COMMA-COUNT                                  07230023
065800         FOR ALL ','                                              07240023
065900                                                                  07250023
066000     IF PV-COMMA-COUNT NOT = 15                                   07260023
066100         MOVE PV-READ-COUNT           TO PV-DISP-NBR              07270023
066200                                         RECORD-NBR               07280023
066300         DISPLAY 'INPUT RECORD ' PV-DISP-NBR                      07290023
066400                  ' HAS NO COMMA DELIMITERS'                      07300023
066500         DISPLAY 'SKIPPING TO NEXT RECORD'                        07310023
066600         PERFORM 8300-INVALID-RECORD                              07320023
066700         SET PS-ERROR-YES             TO TRUE                     07330023
066800     END-IF                                                       07340023
066900                                                                  07350023
067000     IF PS-ERROR-NO                                               07360023
067100         PERFORM 1310-UNSTRING-FRTPAD                             07370023
067200     END-IF                                                       07380023
067300                                                                  07390023
067400     IF PS-ERROR-NO                                               07400023
067500         IF VL045-RULE-NBR = 'RULE '                              07410023
067600             CONTINUE                                             07420023
067700         END-IF                                                   07430023
067800         IF PV-FRTPAD-RECORD = LOW-VALUES OR SPACES               07440023
067900                 MOVE PV-READ-COUNT           TO PV-DISP-NBR      07450023
068000                 DISPLAY 'INPUT RECORD ' PV-DISP-NBR              07460023
068100                      ' IS ALL LOW-VALUES OR SPACES'              07470023
068200                 DISPLAY 'SKIPPING TO NEXT RECORD'                07480023
068300             SET PS-ERROR-YES         TO TRUE                     07490023
068400         END-IF                                                   07500023
068500     END-IF.                                                      07510023
068600                                                                  07520023
068700     IF PS-ERROR-NO                                               07530023
068800         PERFORM 2010-GIT-ER-DONE                                 07540023
068900     END-IF                                                       07550023
069000                                                                  07560023
069100     MOVE VL045-FRGT-CHRGBACK-RECORD TO  PV-HOLD-REC.             07570023
069200     SET FRT-ERROR-NO                                             07580023
069300         FIRST-RULE-LN                                            07590023
069400         PS-ERROR-NO                                              07600023
069500         PS-NO-DUPLICATE TO TRUE.                                 07610023
069600                                                                  07620023
069700     MOVE ZERO TO PV-ERROR-CNT                                    07630023
069800                  PV-COMMA-COUNT.                                 07640023
069900                                                                  07650023
070000*  READ ANOTHER RECORD                                            07660023
070100     PERFORM 7000-READ-INPUT.                                     07670023
070200                                                                  07680023
070300 2010-GIT-ER-DONE.                                                07690023
070400******************************************************************07700023
070500*  PROCESS THE INPUT FILE TO CREATE THE OUTPUT FILES AND REPORT  *07710023
070600*  (BY NOW YOU SHOULD HAVE A GOOD RECORD TO PROCESS)              07720023
070700******************************************************************07730023
070800                                                                  07740023
070900*    DISPLAY '2010-GIT-ER-DONE'.                                  07750023
071000                                                                  07760023
071100     MOVE VL045-FREIGHT-CHRG TO PV-FRT-CHRG-AMT                   07770023
071200                                PV-FRT-CHRG-AMT-12.               07780023
071300     MOVE PV-FRT-LAST-10     TO DP010I-UNEDITED-FIELD.            07790023
071400     MOVE 9                  TO DP010I-MAXIMUM-DIGITS.            07800023
071500     MOVE 2                  TO DP010I-MAXIMUM-DECIMALS.          07810023
071600     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     07820023
263627     CALL DP010I-NUMERIC-EDIT-ROUTINE                             07831024
263627          USING DP010I-NUMERIC-EDIT-AREA.                         07832024
071800     IF DP010I-ERROR-DETECTED                                     07840023
071900         MOVE ZERO           TO PV-FRT-CHRG-AMT-N                 07850023
072000         DISPLAY '** DP010I-ERROR-IND = ' DP010I-ERROR-IND        07860023
072100     ELSE                                                         07870023
072200         MOVE DP010I-NUMERIC-FIELD TO PV-FRT-CHRG-AMT-N           07880023
072300     END-IF.                                                      07890023
072400*                                                                 07900023
072500* VALIDATE FREIGHT CHARGE AMOUNT                                  07910023
072600     IF PV-FRT-CHRG-AMT-N = ZERO                                  07920023
072700         MOVE 'INVALID FREIGHT AMT' TO PV-ERROR                   07930023
072800         PERFORM 2100-PRINT-ERR-LINE                              07940023
072900         SET FRT-ERROR-YES         TO TRUE                        07950023
073000         ADD  1                    TO PV-ERROR-CNT                07960023
073100     END-IF                                                       07970023
073200                                                                  07980023
073300     IF PV-FRT-CHRG-AMT-N > PC-AMOUNT                             07990023
073400         MOVE 'FRT AMT GT $99,999 ' TO PV-ERROR                   08000023
073500         PERFORM 2100-PRINT-ERR-LINE                              08010023
073600         SET FRT-ERROR-YES         TO TRUE                        08020023
073700         ADD  1                    TO PV-ERROR-CNT                08030023
073800     ELSE                                                         08040023
073900         IF PV-FRT-CHRG-AMT-N < PC-MIN-AMOUNT                     08050023
074000             MOVE 'FRT AMT LT $1.00   ' TO PV-ERROR               08060023
074100             PERFORM 2100-PRINT-ERR-LINE                          08070023
074200             SET FRT-ERROR-YES     TO TRUE                        08080023
074300             ADD  1                TO PV-ERROR-CNT                08090023
074400     END-IF.                                                      08100023
074500                                                                  08110023
074600* VALIDATE RULE NUMBER                                            08120023
074610                                                                  08130023
074700**   IF VL045-RULE-NBR(1:2) = 'TR' OR 'LD'                        08140023
074701                                                                  08150023
074710     IF (VL045-RULE-NBR(1:2) = PV-RULE-01  AND                    08160023
074711         PV-RULE-01          > SPACE)            OR               08170023
074712        (VL045-RULE-NBR(1:2) = PV-RULE-02  AND                    08180023
074713         PV-RULE-02          > SPACE)            OR               08190023
074714        (VL045-RULE-NBR(1:2) = PV-RULE-03  AND                    08200023
074715         PV-RULE-03          > SPACE)            OR               08210023
074716        (VL045-RULE-NBR(1:2) = PV-RULE-04  AND                    08220023
074717         PV-RULE-04          > SPACE)            OR               08230023
074718        (VL045-RULE-NBR(1:2) = PV-RULE-05  AND                    08240023
074719         PV-RULE-05          > SPACE)            OR               08250023
074720        (VL045-RULE-NBR(1:2) = PV-RULE-06  AND                    08260023
074721         PV-RULE-06          > SPACE)            OR               08270023
074722        (VL045-RULE-NBR(1:2) = PV-RULE-07  AND                    08280023
074723         PV-RULE-07          > SPACE)            OR               08290023
074724        (VL045-RULE-NBR(1:2) = PV-RULE-08  AND                    08300023
074725         PV-RULE-08          > SPACE)                             08310023
074730                                                                  08320023
074800         CONTINUE                                                 08330023
074900     ELSE                                                         08340023
075000         MOVE 'BAD/MISSING RULE # ' TO PV-ERROR                   08350023
075100         PERFORM 2100-PRINT-ERR-LINE                              08360023
075200         SET FRT-ERROR-YES      TO TRUE                           08370023
075300         ADD  1                 TO PV-ERROR-CNT                   08380023
075400     END-IF.                                                      08390023
075500                                                                  08400023
075600     MOVE VL045-DC TO DK-DC-NUMBER.                               08410023
075700                                                                  08420023
075800     MOVE VL045-PO-NBR       TO PV-PO-NUMBER.                     08430023
075900     MOVE VL045-PO-NBR       TO DP010I-UNEDITED-FIELD.            08440023
076000     MOVE 9                  TO DP010I-MAXIMUM-DIGITS.            08450023
076100     MOVE 0                  TO DP010I-MAXIMUM-DECIMALS.          08460023
076200     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     08470023
263627     CALL DP010I-NUMERIC-EDIT-ROUTINE                             08481024
263627          USING DP010I-NUMERIC-EDIT-AREA.                         08482024
076400     IF DP010I-ERROR-DETECTED                                     08490023
076500         DISPLAY '** DP010I-ERROR-IND = ' DP010I-ERROR-IND        08500023
076600         DISPLAY '** INVALID PO NUMBER= ' PV-PO-NUMBER            08510023
076700         SET PO-FOUND-NO  TO TRUE                                 08520023
076800     ELSE                                                         08530023
076900         MOVE DP010I-NUMERIC-FIELD TO DK-PO-NUMBER                08540023
077000         SET PO-FOUND-YES          TO TRUE                        08550023
077100     END-IF.                                                      08560023
077200                                                                  08570023
077300* VALIDATE PO AND DC                                              08580023
077400     IF PO-FOUND-YES                                              08590023
077500        PERFORM 2600-VALIDATE-PO                                  08600023
077600     END-IF                                                       08610023
077700     PERFORM 2700-VALIDATE-DC.                                    08620023
077800                                                                  08630023
077900     IF (PO-FOUND-YES AND DC-FOUND-YES)                           08640023
078000       PERFORM 2800-CHECK-RECEIV                                  08650023
078100         IF PV-DB2-COUNT = ZERO                                   08660023
078200             MOVE 'NO RECVR FOUND     ' TO PV-ERROR               08670023
078300             PERFORM 2100-PRINT-ERR-LINE                          08680023
078400             SET FRT-ERROR-YES    TO TRUE                         08690023
078500             ADD  1               TO PV-ERROR-CNT                 08700023
078600         END-IF                                                   08710023
078700     END-IF.                                                      08720023
078800                                                                  08730023
078900     IF (PO-FOUND-YES AND DC-FOUND-NO)                            08740023
079000         MOVE 'DC DOES NOT EXIST  ' TO PV-ERROR                   08750023
079100         PERFORM 2100-PRINT-ERR-LINE                              08760023
079200         SET FRT-ERROR-YES        TO TRUE                         08770023
079300         ADD  1                   TO PV-ERROR-CNT                 08780023
079400     END-IF.                                                      08790023
079500                                                                  08800023
079600     IF (PO-FOUND-NO AND DC-FOUND-YES)                            08810023
079700         MOVE 'PO DOES NOT EXIST  ' TO PV-ERROR                   08820023
079800         PERFORM 2100-PRINT-ERR-LINE                              08830023
079900         SET FRT-ERROR-YES        TO TRUE                         08840023
080000         ADD  1                   TO PV-ERROR-CNT                 08850023
080100     END-IF.                                                      08860023
080200                                                                  08870023
080300     IF (PO-FOUND-NO AND DC-FOUND-NO)                             08880023
080400         MOVE 'PO/DC NOT FOUND    ' TO PV-ERROR                   08890023
080500         PERFORM 2100-PRINT-ERR-LINE                              08900023
080600         SET FRT-ERROR-YES      TO TRUE                           08910023
080700         ADD  1                 TO PV-ERROR-CNT                   08920023
080800     END-IF.                                                      08930023
080900                                                                  08940023
081000     PERFORM 2020-CHECK-FOR-NUMERIC.                              08950023
081100                                                                  08960023
081200                                                                  08970023
081300*  CREATE AUDIT ERROR RECORD (ONLY CREATE ERROR RECORD 1 TIME)    08980023
081400*  EVEN IF THERE ARE MULTIPLE ERRORS ONLY SEND 1 RECORD BACK      08990023
081500     IF PV-ERROR-CNT > ZERO                                       09000023
081600******************************** BAD REC CNT & BAD $ AMT & TOTAL  09010023
081700         ADD  1                TO PV-BAD-REC-CNT                  09020023
081800                                  PV-TOTAL-REC-CNT                09030023
081900         ADD PV-FRT-CHRG-AMT-N TO PV-BAD-FRGT-AMT                 09040023
082000                                  PV-TOTAL-FRGT-AMT               09050023
082100******************************** BAD REC CNT & BAD $ AMT & TOTAL  09060023
082200         PERFORM 2200-BUILD-AUDT-ERR-FILE                         09070023
082300         PERFORM 2250-BUILD-FAL-STATUS-FILE                       09080023
082400     END-IF.                                                      09090023
082500                                                                  09100023
082600     IF PV-HOLD-REC NOT = VL045-FRGT-CHRGBACK-RECORD              09110023
082700         SET PS-NO-DUPLICATE   TO TRUE                            09120023
082800     ELSE                                                         09130023
082900         SET PS-DUPLICATE      TO TRUE                            09140023
083000         ADD  1                TO PV-DUP-REC-CNT                  09150023
083100                                  PV-TOTAL-REC-CNT                09160023
083200         ADD PV-FRT-CHRG-AMT-N TO PV-DUP-FRGT-AMT                 09170023
083300                                  PV-TOTAL-FRGT-AMT               09180023
083400         PERFORM 2250-BUILD-FAL-STATUS-FILE                       09190023
083500     END-IF.                                                      09200023
083600                                                                  09210023
083700*  CREATE AUDIT LOADER RECORD                                     09220023
083800     IF FRT-ERROR-NO AND                                          09230023
083900         PS-NO-DUPLICATE                                          09240023
084000         ADD +1                TO PV-SEQ-NBR                      09250023
084100         PERFORM 2300-BUILD-AUDT-LOAD-FILE                        09260023
084200******************************* GOOD REC CNT & GOOD $ AMT & TOTAL 09270023
084300         ADD  1                TO PV-GOOD-REC-CNT                 09280023
084400                                  PV-TOTAL-REC-CNT                09290023
084500         ADD PV-FRT-CHRG-AMT-N TO PV-GOOD-FRGT-AMT                09300023
084600                                  PV-TOTAL-FRGT-AMT               09310023
084700******************************* GOOD REC CNT & GOOD $ AMT & TOTAL 09320023
084800         PERFORM 2250-BUILD-FAL-STATUS-FILE                       09330023
084900     END-IF.                                                      09340023
085000                                                                  09350023
085100 2020-CHECK-FOR-NUMERIC.                                          09360023
085200*    DISPLAY '2020-CHECK-FOR-NUMERIC'.                            09370023
085300******************************************************************09380023
085400*  VERIFY THAT NUMERIC FIELDS ARE NUMERIC                         09390023
085500******************************************************************09400023
085600     IF VL045-CARTON-CNT IS NUMERIC                               09410023
085700         CONTINUE                                                 09420023
085800     ELSE                                                         09430023
085900         MOVE 'INVALID CARTON CNT ' TO PV-ERROR                   09440023
086000         PERFORM 2100-PRINT-ERR-LINE                              09450023
086100         SET FRT-ERROR-YES      TO TRUE                           09460023
086200         ADD  1                 TO PV-ERROR-CNT                   09470023
086300     END-IF.                                                      09480023
086400                                                                  09490023
086500     IF VL045-WEIGHT IS NUMERIC                                   09500023
086600         CONTINUE                                                 09510023
086700     ELSE                                                         09520023
086800         MOVE 'INVALID WEIGHT     ' TO PV-ERROR                   09530023
086900         PERFORM 2100-PRINT-ERR-LINE                              09540023
087000         SET FRT-ERROR-YES      TO TRUE                           09550023
087100         ADD  1                 TO PV-ERROR-CNT                   09560023
087200     END-IF.                                                      09570023
087300                                                                  09580023
087400     IF VL045-CUBES IS NUMERIC                                    09590023
087500         CONTINUE                                                 09600023
087600     ELSE                                                         09610023
087700         MOVE 'INVALID CUBES      ' TO PV-ERROR                   09620023
087800         PERFORM 2100-PRINT-ERR-LINE                              09630023
087900         SET FRT-ERROR-YES      TO TRUE                           09640023
088000         ADD  1                 TO PV-ERROR-CNT                   09650023
088100     END-IF.                                                      09660023
088200                                                                  09670023
088300                                                                  09680023
088400 2100-PRINT-ERR-LINE.                                             09690023
088500*    DISPLAY '2100-PRINT-ERR-LINE'.                               09700023
088600******************************************************************09710023
088700*  FORMAT DETAIL LINE WITH FREIGHT AUDIT SPREADSHEET INFO,       *09720023
088800*  THEN PRINT THE DETAIL LINE.                                   *09730023
088900******************************************************************09740023
089000                                                                  09750023
089100     IF  PV-LINE-CNT > PC-LINE-LIMIT                              09760023
089200         PERFORM 8000-PRINT-HEADINGS                              09770023
089300     END-IF.                                                      09780023
089400                                                                  09790023
089500     MOVE VL045-RULE-NBR           TO DL1-RULE.                   09800023
089600     MOVE PV-VEND-NME              TO DL1-VENDOR-NAME.            09810023
089700     MOVE PV-FRT-CHRG-AMT-N        TO DL1-FRT-CHARGE.             09820023
089800     MOVE PV-PO-NUMBER             TO DL1-PO-NBR.                 09830023
089900     MOVE VL045-DC                 TO DL1-SITE.                   09840023
090000     MOVE VL045-CARRIER-AUTH-NBR   TO DL1-AUTH-NBR.               09850023
090100     MOVE VL045-DELIVERY-ORDER-NBR TO DL1-ORDER-NBR.              09860023
090200     MOVE VL045-FREIGHT-BILL       TO DL1-FRT-NBR.                09870023
090300     MOVE VL045-SCAC               TO DL1-SCAC.                   09880023
090400     MOVE VL045-FAX-AUTH-NBR       TO DL1-FAX-NBR.                09890023
090500     MOVE VL045-PRO-NBR            TO DL1-PRO-NBR.                09900023
090600     MOVE VL045-INVOICE-NBR        TO DL1-INVOICE-NBR.            09910023
090700     IF   VL045-CARTON-CNT NUMERIC                                09920023
090800         MOVE VL045-CARTON-CNT         TO DL1-CARTONS             09930023
090900     ELSE                                                         09940023
091000         MOVE VL045-CARTON-CNT         TO DL1-CARTONS-X           09950023
091100     END-IF.                                                      09960023
091200     IF   VL045-WEIGHT NUMERIC                                    09970023
091300         MOVE VL045-WEIGHT             TO DL1-WEIGHT              09980023
091400     ELSE                                                         09990023
091500         MOVE VL045-WEIGHT             TO DL1-WEIGHT-X            10000023
091600     END-IF.                                                      10010023
091700     IF   VL045-CUBES  NUMERIC                                    10020023
091800         MOVE VL045-CUBES              TO DL1-CUBES               10030023
091900     ELSE                                                         10040023
092000         MOVE VL045-CUBES              TO DL1-CUBES-X             10050023
092100     END-IF.                                                      10060023
092200     MOVE PV-ERROR                 TO DL1-ERROR.                  10070023
092300                                                                  10080023
092400     MOVE DL1-DETAIL-LINE-1 TO PV-PRINT-RECORD.                   10090023
092500     IF FIRST-RULE-LN                                             10100023
092600         MOVE +2            TO PV-LINE-SPACING                    10110023
092700         PERFORM 8200-WRITE-ERROR-RPT-LINE                        10120023
092800         SET NOT-FIRST-RULE-LN TO TRUE                            10130023
092900     ELSE                                                         10140023
093000         MOVE +1            TO PV-LINE-SPACING                    10150023
093100         PERFORM 8200-WRITE-ERROR-RPT-LINE                        10160023
093200     END-IF.                                                      10170023
093300                                                                  10180023
093400     PERFORM 2900-TEXT-FLOW-COMMENTS.                             10190023
093500                                                                  10200023
093600                                                                  10210023
093700                                                                  10220023
093800                                                                  10230023
093900 2200-BUILD-AUDT-ERR-FILE.                                        10240023
094000*    DISPLAY '2200-BUILD-AUDT-ERR-FILE'.                          10250023
094100******************************************************************10260023
094200*  BUILD OUTPUT AUDIT ERROR RECORD                               *10270023
094300******************************************************************10280023
094400                                                                  10290023
094500     INITIALIZE VL048-FRGT-AUDTERR-RECORD.                        10300023
094600     IF PV-ERROR-CNT = ZERO                                       10310023
094700         MOVE SPACES                TO VL048-ERROR-MSG            10320023
094800     ELSE                                                         10330023
094900         IF PV-ERROR-CNT = 1                                      10340023
095000             MOVE PV-ERROR          TO VL048-ERROR-MSG            10350023
095100         ELSE                                                     10360023
095200             IF PV-ERROR-CNT > 1                                  10370023
095300                 MOVE 'MULTIPLE ERRORS' TO VL048-ERROR-MSG        10380023
095400             END-IF                                               10390023
095500         END-IF                                                   10400023
095600     END-IF.                                                      10410023
095700     MOVE VL045-RULE-NBR            TO VL048-RULE-NBR.            10420023
095800     MOVE VL045-RULE-DESC           TO VL048-RULE-DESC.           10430023
095900     MOVE PV-FRT-CHRG-AMT           TO VL048-FREIGHT-CHRG.        10440023
096000     MOVE VL045-PO-NBR              TO VL048-PO-NBR.              10450023
096100     MOVE VL045-CARRIER-AUTH-NBR    TO VL048-CARRIER-AUTH-NBR.    10460023
096200     MOVE VL045-DELIVERY-ORDER-NBR  TO VL048-DELIVERY-ORDER-NBR.  10470023
096300     MOVE VL045-DC                  TO VL048-DC.                  10480023
096400     MOVE VL045-FAX-AUTH-NBR        TO VL048-FAX-AUTH-NBR.        10490023
096500     MOVE VL045-SCAC                TO VL048-SCAC.                10500023
096600     MOVE VL045-FREIGHT-BILL        TO VL048-FREIGHT-BILL.        10510023
096700     MOVE VL045-PRO-NBR             TO VL048-PRO-NBR.             10520023
096800     MOVE VL045-INVOICE-NBR         TO VL048-INVOICE-NBR.         10530023
096900     MOVE VL045-CARTON-CNT          TO VL048-CARTON-CNT.          10540023
097000     MOVE VL045-WEIGHT              TO VL048-WEIGHT.              10550023
097100     MOVE VL045-CUBES               TO VL048-CUBES.               10560023
097200     MOVE VL045-COMMENTS            TO VL048-COMMENTS.            10570023
097300     MOVE PC-COMMA                  TO VL048-COMM-1               10580023
097400                                       VL048-COMM-2               10590023
097500                                       VL048-COMM-3               10600023
097600                                       VL048-COMM-4               10610023
097700                                       VL048-COMM-5               10620023
097800                                       VL048-COMM-6               10630023
097900                                       VL048-COMM-7               10640023
098000                                       VL048-COMM-8               10650023
098100                                       VL048-COMM-9               10660023
098200                                       VL048-COMM-10              10670023
098300                                       VL048-COMM-11              10680023
098400                                       VL048-COMM-12              10690023
098500                                       VL048-COMM-13              10700023
098600                                       VL048-COMM-14              10710023
098700                                       VL048-COMM-15              10720023
098800                                       VL048-COMM-16.             10730023
098900                                                                  10740023
099000     WRITE FRT-CHGBK-ERROR-RECORD                                 10750023
099100             FROM VL048-FRGT-AUDTERR-RECORD.                      10760023
099200                                                                  10770023
099300******************************************************************10780023
099400*  BUILD OUTPUT FAL STATUS RECORD                                 10790023
099500******************************************************************10800023
099600 2250-BUILD-FAL-STATUS-FILE.                                      10810023
099700*    DISPLAY '2250-BUILD-FAL-STATUS-FILE'.                        10820023
099800                                                                  10830023
099900     INITIALIZE VL065-FAL-STATUS-RECORD.                          10840023
100000     IF PV-ERROR-CNT = ZERO                                       10850023
100100         MOVE SPACES                TO VL065-ERROR-MSG            10860023
100200     ELSE                                                         10870023
100300         IF PV-ERROR-CNT = 1                                      10880023
100400             MOVE PV-ERROR          TO VL065-ERROR-MSG            10890023
100500         ELSE                                                     10900023
100600             IF PV-ERROR-CNT > 1                                  10910023
100700                 MOVE 'MULTIPLE ERRORS'    TO VL065-ERROR-MSG     10920023
100800             END-IF                                               10930023
100900         END-IF                                                   10940023
101000     END-IF.                                                      10950023
101100     IF PS-DUPLICATE                                              10960023
101200         MOVE 'DUPLICATE RECORD'           TO VL065-ERROR-MSG     10970023
101300     END-IF.                                                      10980023
101400     MOVE VL045-RULE-NBR            TO VL065-RULE-NBR.            10990023
101500     MOVE VL045-RULE-DESC           TO VL065-RULE-DESC.           11000023
101600     MOVE PV-FRT-CHRG-AMT           TO VL065-FREIGHT-CHRG.        11010023
101700     MOVE VL045-PO-NBR              TO VL065-PO-NBR.              11020023
101800     MOVE VL045-CARRIER-AUTH-NBR    TO VL065-CARRIER-AUTH-NBR.    11030023
101900     MOVE VL045-DELIVERY-ORDER-NBR  TO VL065-DELIVERY-ORDER-NBR.  11040023
102000     MOVE VL045-DC                  TO VL065-DC.                  11050023
102100     MOVE VL045-FAX-AUTH-NBR        TO VL065-FAX-AUTH-NBR.        11060023
102200     MOVE VL045-SCAC                TO VL065-SCAC.                11070023
102300     MOVE VL045-FREIGHT-BILL        TO VL065-FREIGHT-BILL.        11080023
102400     MOVE VL045-PRO-NBR             TO VL065-PRO-NBR.             11090023
102500     MOVE VL045-INVOICE-NBR         TO VL065-INVOICE-NBR.         11100023
102600     MOVE VL045-CARTON-CNT          TO VL065-CARTON-CNT.          11110023
102700     MOVE VL045-WEIGHT              TO VL065-WEIGHT.              11120023
102800     MOVE VL045-CUBES               TO VL065-CUBES.               11130023
102900     MOVE VL045-COMMENTS            TO VL065-COMMENTS.            11140023
103000     MOVE PC-COMMA                  TO VL065-COMM-1               11150023
103100                                       VL065-COMM-2               11160023
103200                                       VL065-COMM-3               11170023
103300                                       VL065-COMM-4               11180023
103400                                       VL065-COMM-5               11190023
103500                                       VL065-COMM-6               11200023
103600                                       VL065-COMM-7               11210023
103700                                       VL065-COMM-8               11220023
103800                                       VL065-COMM-9               11230023
103900                                       VL065-COMM-10              11240023
104000                                       VL065-COMM-11              11250023
104100                                       VL065-COMM-12              11260023
104200                                       VL065-COMM-13              11270023
104300                                       VL065-COMM-14              11280023
104400                                       VL065-COMM-15              11290023
104500                                       VL065-COMM-16.             11300023
104600                                                                  11310023
104700     WRITE FAL-STATUS-RECORD                                      11320023
104800             FROM VL065-FAL-STATUS-RECORD.                        11330023
104900                                                                  11340023
105000     ADD  1                         TO PV-STATUS-WRITE-CNT.       11350023
105100                                                                  11360023
105200 2300-BUILD-AUDT-LOAD-FILE.                                       11370023
105300*    DISPLAY '2300-BUILD-AUDT-LOAD-FILE'.                         11380023
105400******************************************************************11390023
105500*  BUILD AUDIT LOAD FILE RECORD                                 * 11400023
105600******************************************************************11410023
105700                                                                  11420023
105800     INITIALIZE VL046-FRGT-AUDIT-LOADER-RECORD.                   11430023
105900     MOVE 'A'                      TO VL046-ACD-INDICATOR.        11440023
106000     MOVE PV-CURR-CCYY             TO VL046-AT-CCYY.              11450023
106100     MOVE PV-CURR-DATE-MM          TO VL046-AT-MM.                11460023
106200     MOVE PV-CURR-DATE-DD          TO VL046-AT-DD.                11470023
106300     MOVE PC-PERIOD                TO VL046-AT-PERIOD.            11480023
106400     MOVE PV-CURR-TIME-HH          TO VL046-AT-HR.                11490023
106500     MOVE PV-CURR-TIME-MM          TO VL046-AT-MIN.               11500023
106600     MOVE PV-CURR-TIME-SS          TO VL046-AT-SEC.               11510023
106700     MOVE PV-SEQ-NBR               TO VL046-SEQ-NBR.              11520023
106800     MOVE VL045-DC                 TO VL046-SITE.                 11530023
106900     MOVE DK-PO-NUMBER             TO VL046-PO-NBR.               11540023
107000     MOVE VL045-RULE-NBR           TO VL046-RULE-NBR.             11550023
107100     MOVE VL045-SCAC               TO VL046-SCAC.                 11560023
107200     MOVE SPACE                    TO VL046-FREIGHT-CHRG-SIGN.    11570023
107300     MOVE PV-FRT-CHRG-AMT-N        TO VL046-FREIGHT-CHRG.         11580023
107400     MOVE VL045-CARRIER-AUTH-NBR   TO VL046-CARRIER-AUTH-NBR.     11590023
107500     MOVE VL045-DELIVERY-ORDER-NBR TO VL046-DELIVERY-ORDER-NBR.   11600023
107600     MOVE VL045-FAX-AUTH-NBR       TO VL046-FAX-AUTH-NBR.         11610023
107700     MOVE VL045-FREIGHT-BILL       TO VL046-FREIGHT-BILL.         11620023
107800     MOVE VL045-PRO-NBR            TO VL046-PRO-NBR.              11630023
107900     MOVE VL045-INVOICE-NBR        TO VL046-INVOICE-NBR.          11640023
108000     MOVE SPACE                    TO VL046-CARTON-CNT-SIGN.      11650023
108100     MOVE VL045-CARTON-CNT         TO VL046-CARTON-CNT.           11660023
108200     MOVE SPACE                    TO VL046-WEIGHT-SIGN.          11670023
108300     MOVE VL045-WEIGHT             TO VL046-WEIGHT.               11680023
108400     MOVE SPACE                    TO VL046-CUBES-SIGN.           11690023
108500     MOVE VL045-CUBES              TO VL046-CUBES.                11700023
108600     MOVE VL045-COMMENTS           TO VL046-COMMENTS.             11710023
108700     MOVE 'X'                      TO VL046-ANCHOR-CONSTANT.      11720023
108800                                                                  11730023
108900     WRITE AUDIT-LOADER-RECORD                                    11740023
109000                  FROM VL046-FRGT-AUDIT-LOADER-RECORD.            11750023
109100     ADD +1                        TO PV-MARKER-CNT.              11760023
109200                                                                  11770023
109300 2400-BUILD-FRT-MARKER-FILE.                                      11780023
109400*    DISPLAY '2400-BUILD-FRT-MARKER-FILE'.                        11790023
109500******************************************************************11800023
109600*  BUILD FREIGHT AUDIT LOAD MARKER RECORD.                       *11810023
109610*                                                                *11820023
109620*  IF NO DATA HAD BEEN WRITTEN TO THE AUDIT LOADER FILE, THEN    *11830023
109630*  WE WILL WRITE A "NO DATA TO PROCESS" RECORD TO THAT FILE      *11840023
109631*  SO THERE IS AT LEAST 1 RECORD ON THE FILE TO BE SENT.         *11850023
109640*                                                                *11860023
109700******************************************************************11870023
109710     INITIALIZE VL047-MARKER-RECORD.                              11880023
109800                                                                  11890023
109900     IF PV-MARKER-CNT = 0                                         11900023
109910        MOVE 'NO DATA TO PROCESS' TO AUDIT-LOADER-RECORD          11910023
109912        WRITE AUDIT-LOADER-RECORD                                 11920023
109920        ADD +1 TO PV-MARKER-CNT                                   11930023
              MOVE +4050               TO RETURN-CODE                   11940023
109930     END-IF.                                                      11950023
109940                                                                  11960023
110000     MOVE PV-MARKER-DATE      TO PV-CREATE-DATE.                  11970023
110100     MOVE 'FRGTAUDITLOAD.DAT' TO PV-AUDTLOAD-MKR.                 11980023
110200     MOVE PV-FILE-NAME        TO VL047-FILE-NAME.                 11990023
110300     MOVE PV-MARKER-CNT       TO VL047-TRAN-COUNT.                12000023
110400     MOVE PV-TOT-MARKER-AMT   TO VL047-TRAN-AMT.                  12010023
110500     MOVE PV-MARKER-DATE      TO VL047-BUILD-DATE.                12020023
110600     MOVE PV-MARKER-TIME      TO VL047-BUILD-TIME.                12030023
110700     MOVE 'X'                 TO VL047-ANCHOR-CONSTANT.           12040023
110800                                                                  12050023
110900     WRITE AUDIT-MARKER-RECORD                                    12060023
111000                  FROM VL047-MARKER-RECORD.                       12070023
111100     MOVE ZERO                TO PV-MARKER-TRAN-AMT.              12080023
111200                                                                  12090023
111300 2600-VALIDATE-PO.                                                12100023
111400*    DISPLAY '2600-VALIDATE-PO'.                                  12110023
111500******************************************************************12120023
111600*  CHECK TO SEE IF PO EXISTS IN PO SYSTEM                        *12130023
111700*  IF IT DOES THEN SET A PO FOUND SWITCH                          12140023
111800******************************************************************12150023
111900                                                                  12160023
112000     PERFORM                                                      12170023
112100        WITH TEST AFTER                                           12180023
112200        VARYING PV-RETRY-COUNT                                    12190023
112300        FROM 1 BY 1                                               12200023
112400        UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                  12210023
112500           OR (SQLCODE = +0)                                      12220023
112600           OR (SQLCODE = +100))                                   12230023
112700                                                                  12240023
112800        EXEC SQL                                                  12250023
112900            SELECT  A.PO_NBR                                      12260023
113000                  , A.ENT_ID                                      12270023
113100                  , B.ENT_NAME_DESC                               12280023
113200            INTO  :PURCHS-PO-NBR                                  12290023
113300                , :PURCHS-ENT-ID                                  12300023
113400                , :ENTNME-ENT-NAME-DESC                           12310023
113500            FROM TPURCHS A                                        12320023
113600                ,TENTNME B                                        12330023
113700            WHERE A.PO_NBR         = :DK-PO-NUMBER                12340023
113800              AND A.ENT_ID         = B.ENT_ID                     12350023
113900              AND A.VER_STATUS_CDE = 'A'                          12360023
114000              AND B.TYPE_CDE       = '01'                         12370023
114100        END-EXEC                                                  12380023
114200                                                                  12390023
114300        EVALUATE TRUE                                             12400023
114400            WHEN SQLCODE = ZERO                                   12410023
114500                MOVE PURCHS-ENT-ID        TO PV-ENT-ID            12420023
114600                MOVE ENTNME-ENT-NAME-DESC TO PV-VEND-NAME         12430023
114700                SET PO-FOUND-YES          TO TRUE                 12440023
114800            WHEN SQLCODE = +100                                   12450023
114900                 SET PO-FOUND-NO          TO TRUE                 12460023
115000            WHEN OTHER                                            12470023
115100                MOVE '2600-VALIDATE-PO'                           12480023
115200                               TO PV-ABEND-PARAGRAPH              12490023
115300                MOVE 'SELECT TPURCHS'                             12500023
115400                               TO PV-ABEND-OPERATION              12510023
115500                MOVE 'TPURCHS' TO PV-ABEND-STRUCTURE-1            12520023
115600                MOVE SPACES    TO PV-ABEND-STRUCTURE-2            12530023
115700                PERFORM 9900-DB2-ABEND                            12540023
115800        END-EVALUATE                                              12550023
115900     END-PERFORM.                                                 12560023
116000                                                                  12570023
116100     IF PV-RETRY-COUNT > PC-MAX-RETRIES                           12580023
116200        MOVE '2600-VALIDATE-PO' TO PV-ABEND-PARAGRAPH             12590023
116300        MOVE 'MAX RETRIES EXCEEDED'                               12600023
116400                                TO PV-ABEND-OPERATION             12610023
116500        PERFORM 9900-DB2-ABEND                                    12620023
116600     END-IF.                                                      12630023
116700                                                                  12640023
116800 2700-VALIDATE-DC.                                                12650023
116900*    DISPLAY '2700-VALIDATE-DC'.                                  12660023
117000******************************************************************12670023
117100*  CHECK TO SEE IF DC EXISTS IN LEGECY TABLE                     *12680023
117200*  IF IT DOES THEN SET A DC FOUND SWITCH                          12690023
117300******************************************************************12700023
117400                                                                  12710023
117500     PERFORM                                                      12720023
117600        WITH TEST AFTER                                           12730023
117700        VARYING PV-RETRY-COUNT                                    12740023
117800        FROM 1 BY 1                                               12750023
117900        UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                  12760023
118000           OR (SQLCODE = +0)                                      12770023
118100           OR (SQLCODE = +100))                                   12780023
118200                                                                  12790023
118300        EXEC SQL                                                  12800023
118400            SELECT  LOC_NBR                                       12810023
118500                  , LOC_NM                                        12820023
118600            INTO    :XLT00010-LOC-NBR                             12830023
118700                  , :XLT00010-LOC-NM                              12840023
118800             FROM                                                 12850023
118900                 XLT_LOC                                          12860023
119000             WHERE LOC_TYP_CDE  = 'DC'                            12870023
119100               AND LOC_NBR      = :DK-DC-NUMBER                   12880023
119200        END-EXEC                                                  12890023
119300                                                                  12900023
119400        EVALUATE TRUE                                             12910023
119500            WHEN SQLCODE = ZERO                                   12920023
119600                SET DC-FOUND-YES  TO TRUE                         12930023
119700            WHEN SQLCODE = +100                                   12940023
119800                SET DC-FOUND-NO   TO TRUE                         12950023
119900            WHEN OTHER                                            12960023
120000                MOVE '2700-VALIDATE-DC'                           12970023
120100                               TO PV-ABEND-PARAGRAPH              12980023
120200                MOVE 'SELECT XLT_LOC'                             12990023
120300                               TO PV-ABEND-OPERATION              13000023
120400                MOVE 'XLT_LOC' TO PV-ABEND-STRUCTURE-1            13010023
120500                MOVE SPACES    TO PV-ABEND-STRUCTURE-2            13020023
120600                PERFORM 9900-DB2-ABEND                            13030023
120700        END-EVALUATE                                              13040023
120800     END-PERFORM.                                                 13050023
120900                                                                  13060023
121000     IF PV-RETRY-COUNT > PC-MAX-RETRIES                           13070023
121100        MOVE '2700-VALIDATE-DC' TO PV-ABEND-PARAGRAPH             13080023
121200        MOVE 'MAX RETRIES EXCEEDED'                               13090023
121300                                TO PV-ABEND-OPERATION             13100023
121400        PERFORM 9900-DB2-ABEND                                    13110023
121500     END-IF.                                                      13120023
121600                                                                  13130023
121700 2800-CHECK-RECEIV.                                               13140023
121800*    DISPLAY '2800-CHECK-RECEIV'.                                 13150023
121900******************************************************************13160023
122000*  CHECK TO SEE IF THERE IS A RECEIVER AGAINST THE PO FOR THE DC.*13170023
122100*  IF NOT PV-DB2-COUNT WILL BE ZERO                               13180023
122200******************************************************************13190023
122300                                                                  13200023
122400     MOVE ZERO     TO PV-DB2-COUNT.                               13210023
122500                                                                  13220023
122600        EXEC SQL                                                  13230023
122700            SELECT                                                13240023
122800                   COUNT(*)                                       13250023
122900              INTO                                                13260023
123000                   :PV-DB2-COUNT :PV-NULL-IND                     13270023
123100              FROM                                                13280023
123200                   TRECEIV                                        13290023
123300             WHERE                                                13300023
123400                   ORD_NBR          = :DK-PO-NUMBER               13310023
123500              AND (CURR_OPER_UNT_ID = :DK-DC-NUMBER OR            13320023
123600                   OPER_UNT_ID      = :DK-DC-NUMBER)              13330023
123700              AND  FCLTY_ID         = 1                           13340023
123800              AND  VER_STATUS_CDE   = 'A'                         13350023
123900              AND  STATUS_CDE       = 'VE'                        13360023
124000        END-EXEC                                                  13370023
124100                                                                  13380023
124200        EVALUATE TRUE                                             13390023
124300            WHEN SQLCODE = ZERO                                   13400023
124400            WHEN SQLCODE = +100                                   13410023
124500                CONTINUE                                          13420023
124600            WHEN OTHER                                            13430023
124700                MOVE '2800-CHECK-RECEIV'                          13440023
124800                          TO PV-ABEND-PARAGRAPH                   13450023
124900                MOVE 'SELECT TRECEIV'                             13460023
125000                          TO PV-ABEND-OPERATION                   13470023
125100                MOVE 'TRECEIV'                                    13480023
125200                          TO PV-ABEND-STRUCTURE-1                 13490023
125300                MOVE SPACES TO PV-ABEND-STRUCTURE-2               13500023
125400                PERFORM 9900-DB2-ABEND                            13510023
125500        END-EVALUATE.                                             13520023
125600                                                                  13530023
125700 2900-TEXT-FLOW-COMMENTS.                                         13540023
125800*    DISPLAY '2900-TEXT-FLOW-COMMENTS'.                           13550023
125900******************************************************************13560023
126000*  BUILD COMMENT LINES AND PRINT.                                *13570023
126100******************************************************************13580023
126200                                                                  13590023
126300     INITIALIZE RC035-DATA                                        13600023
126400                PT-TEXT-TABLES.                                   13610023
126500     MOVE VL045-COMMENTS    TO PV-COMMENT-FIELD.                  13620023
126600     MOVE PV-COMMENT-500    TO RC035-STRING.                      13630023
126700     MOVE 200               TO RC035-TARGET-SIZE.                 13640023
126800     MOVE LENGTH OF PV-COMMENT-500                                13650023
126900                            TO RC035-STRING-LENGTH.               13660023
127000     CALL PC-TEXT-FLOW-PROGRAM USING RC035-DATA.                  13670023
127100     MOVE RC035-OUT-STRING  TO PT-TEXT-TABLES.                    13680023
127200                                                                  13690023
127300     IF PT-TEXT-1 > SPACES                                        13700023
127400         IF  PV-LINE-CNT > PC-LINE-LIMIT                          13710023
127500             PERFORM 8000-PRINT-HEADINGS                          13720023
127600         END-IF                                                   13730023
127700         MOVE PT-TEXT-1               TO DL2-COMMENT              13740023
127800         MOVE DL2-DETAIL-COMMENT-LINE TO PV-PRINT-RECORD          13750023
127900         MOVE +1                      TO PV-LINE-SPACING          13760023
128000         PERFORM 8200-WRITE-ERROR-RPT-LINE                        13770023
128100     END-IF.                                                      13780023
128200                                                                  13790023
128300     IF RC035-SEGMENT-COUNT > 1                                   13800023
128400         IF  PV-LINE-CNT > PC-LINE-LIMIT                          13810023
128500             PERFORM 8000-PRINT-HEADINGS                          13820023
128600         END-IF                                                   13830023
128700         INITIALIZE DL2-COMMENT                                   13840023
128800         IF PT-TEXT-2 > SPACES                                    13850023
128900             MOVE PT-TEXT-2               TO DL2-COMMENT          13860023
129000             MOVE DL2-DETAIL-COMMENT-LINE TO PV-PRINT-RECORD      13870023
129100             MOVE +1                      TO PV-LINE-SPACING      13880023
129200             PERFORM 8200-WRITE-ERROR-RPT-LINE                    13890023
129300         ELSE                                                     13900023
129400             INITIALIZE DL2-COMMENT                               13910023
129500             IF PT-TEXT-3 > SPACES                                13920023
129600                 MOVE PT-TEXT-3           TO DL2-COMMENT          13930023
129700                 MOVE DL2-DETAIL-COMMENT-LINE                     13940023
129800                                          TO PV-PRINT-RECORD      13950023
129900                 MOVE +1                  TO PV-LINE-SPACING      13960023
130000                 PERFORM 8200-WRITE-ERROR-RPT-LINE                13970023
130100             END-IF                                               13980023
130200         END-IF                                                   13990023
130300     END-IF.                                                      14000023
130400                                                                  14010023
130500     IF PT-TEXT-1 = SPACE                                         14020023
130600         IF PV-LINE-CNT > PC-LINE-LIMIT                           14030023
130700             PERFORM 8000-PRINT-HEADINGS                          14040023
130800         END-IF                                                   14050023
130900         MOVE 'NO COMMENT LINES'          TO DL2-COMMENT          14060023
131000         MOVE DL2-DETAIL-COMMENT-LINE     TO PV-PRINT-RECORD      14070023
131100         MOVE +1                          TO PV-LINE-SPACING      14080023
131200         PERFORM 8200-WRITE-ERROR-RPT-LINE                        14090023
131300     END-IF.                                                      14100023
131400                                                                  14110023
131500 3500-PRINT-END-OF-RPT-LINE.                                      14120023
131600*    DISPLAY '3500-PRINT-END-OF-RPT-LINE'.                        14130023
131700******************************************************************14140023
131800*  THIS PARAGRAPH WILL PRINT THE 'END OF REPORT' LINE.           *14150023
131900******************************************************************14160023
132000                                                                  14170023
132100     IF  PV-LINE-CNT > PC-LINE-LIMIT                              14180023
132200         PERFORM 8000-PRINT-HEADINGS                              14190023
132300     END-IF.                                                      14200023
132400     MOVE END-OF-REPORT-LINE   TO PV-PRINT-RECORD.                14210023
132500     MOVE +2                   TO PV-LINE-SPACING.                14220023
132600     PERFORM 8200-WRITE-ERROR-RPT-LINE.                           14230023
132700                                                                  14240023
132800 7000-READ-INPUT.                                                 14250023
132900*    DISPLAY '7000-READ-INPUT'.                                   14260023
133000******************************************************************14270023
133100*  READ A FREIGHT EXTRACT RECORD.                                *14280023
133200******************************************************************14290023
133300                                                                  14300023
133400     READ FRT-EXTRACT-FILE                                        14310023
133500       INTO PV-FRTPAD-RECORD                                      14320023
133600         AT END                                                   14330023
133700           SET END-OF-FILE TO TRUE                                14340023
133800         NOT AT END                                               14350023
133900           ADD 1                      TO PV-READ-COUNT            14360023
134000     END-READ.                                                    14370023
134100                                                                  14380023
134200 8000-PRINT-HEADINGS.                                             14390023
134300*    DISPLAY '8000-PRINT-HEADINGS'.                               14400023
134400******************************************************************14410023
134500*  PRINT ALL REPORT HEADING LINES.                               *14420023
134600******************************************************************14430023
134700                                                                  14440023
134800     ADD 1                       TO PV-PAGE-CNT.                  14450023
134900                                                                  14460023
135000     MOVE PV-PAGE-CNT            TO DP200O-PAGE-NUMBER.           14470023
135100     MOVE PC-REPORT-NBR-1        TO DP200O-REPORT-NUMBER.         14480023
135200     MOVE DP200O-STANDRD-HEADER-200-COLS                          14490023
135300                                 TO PV-PRINT-RECORD.              14500023
135400     PERFORM 8100-WRITE-RPT-TOP-OF-PAGE.                          14510023
135500                                                                  14520023
135600     MOVE HL1-HEADING-LINE-1     TO PV-PRINT-RECORD.              14530023
135700     MOVE +1                     TO PV-LINE-SPACING.              14540023
135800     PERFORM 8200-WRITE-ERROR-RPT-LINE.                           14550023
135900                                                                  14560023
136000     MOVE HL2-HEADING-LINE-2     TO PV-PRINT-RECORD.              14570023
136100     MOVE +1                     TO PV-LINE-SPACING.              14580023
136200     PERFORM 8200-WRITE-ERROR-RPT-LINE.                           14590023
136300                                                                  14600023
136400     MOVE HL3-HEADING-LINE-3     TO PV-PRINT-RECORD.              14610023
136500     MOVE +2                     TO PV-LINE-SPACING.              14620023
136600     PERFORM 8200-WRITE-ERROR-RPT-LINE.                           14630023
136700                                                                  14640023
136800     MOVE HL4-HEADING-LINE-4     TO PV-PRINT-RECORD.              14650023
136900     MOVE +1                     TO PV-LINE-SPACING.              14660023
137000     PERFORM 8200-WRITE-ERROR-RPT-LINE.                           14670023
137100                                                                  14680023
137200     MOVE HL5-HEADING-LINE-5     TO PV-PRINT-RECORD.              14690023
137300     MOVE +1                     TO PV-LINE-SPACING.              14700023
137400     PERFORM 8200-WRITE-ERROR-RPT-LINE.                           14710023
137500                                                                  14720023
137600 8100-WRITE-RPT-TOP-OF-PAGE.                                      14730023
137700*    DISPLAY '8100-WRITE-RPT-TOP-OF-PAGE'.                        14740023
137800******************************************************************14750023
137900*  WRITE FIRST REPORT LINE AFTER PAGE BREAK.                     *14760023
138000******************************************************************14770023
138100                                                                  14780023
138200     WRITE ERROR-REPORT-RECORD                                    14790023
138300       FROM PV-PRINT-RECORD                                       14800023
138400         AFTER ADVANCING PAGE.                                    14810023
138500     MOVE +1             TO PV-LINE-CNT.                          14820023
138600                                                                  14830023
138700******************************************************************14840023
138800*  WRITE ERROR REPORT LINE AFTER ADVANCING LINE SPACING.         *14850023
138900******************************************************************14860023
139000 8200-WRITE-ERROR-RPT-LINE.                                       14870023
139100*     DISPLAY '8200-WRITE-ERROR-RPT-LINE'.                        14880023
139200                                                                  14890023
139300     WRITE ERROR-REPORT-RECORD                                    14900023
139400       FROM PV-PRINT-RECORD                                       14910023
139500         AFTER ADVANCING PV-LINE-SPACING.                         14920023
139600     ADD PV-LINE-SPACING TO PV-LINE-CNT.                          14930023
139700                                                                  14940023
139800******************************************************************14950023
139900*  INVALID RECORD -  NOT COMMA DELIMITED                          14960023
140000******************************************************************14970023
140100 8300-INVALID-RECORD.                                             14980023
140200*     DISPLAY '8300-INVALID-RECORD'.                              14990023
140300     INITIALIZE VL048-FRGT-AUDTERR-RECORD.                        15000023
140400     INITIALIZE VL065-FAL-STATUS-RECORD.                          15010023
140500     ADD  1                           TO PV-BAD-REC-CNT           15020023
140600                                         PV-TOTAL-REC-CNT.        15030023
140700     MOVE PV-FRTPAD-FIELDS            TO VL048-INPUT-REC          15040023
140800                                         VL065-INPUT-REC.         15050023
140900     MOVE SPACES                      TO VL048-EXTRA-SPACE        15060023
141000                                         VL065-EXTRA-SPACE.       15070023
141100     MOVE 'RECD MISSING COMMAS'       TO VL048-ERROR-MSG          15080023
141200                                         VL065-ERROR-MSG.         15090023
141300                                                                  15100023
141400     WRITE FRT-CHGBK-ERROR-RECORD                                 15110023
141500             FROM VL048-FRGT-AUDTERR-RECORD.                      15120023
141600                                                                  15130023
141700     WRITE FAL-STATUS-RECORD                                      15140023
141800             FROM VL065-FAL-STATUS-RECORD.                        15150023
141900                                                                  15160023
142000     ADD  1                         TO PV-STATUS-WRITE-CNT.       15170023
142100                                                                  15180023
142200     IF  PV-LINE-CNT > PC-LINE-LIMIT                              15190023
142300         PERFORM 8000-PRINT-HEADINGS                              15200023
142400     END-IF.                                                      15210023
142500                                                                  15220023
142600     MOVE  INVALID-RECORD-LINE      TO PV-PRINT-RECORD.           15230023
142700     WRITE ERROR-REPORT-RECORD                                    15240023
142800       FROM PV-PRINT-RECORD                                       15250023
142900         AFTER ADVANCING PV-LINE-SPACING.                         15260023
143000     ADD PV-LINE-SPACING TO PV-LINE-CNT.                          15270023
143100                                                                  15280023
143200******************************************************************15290023
143300*  SHOW RECORD COUNTS AND AMOUNTS IN SYSOUT                       15300023
143400******************************************************************15310023
143500 8500-SHOW-COUNTERS.                                              15320023
143600     DISPLAY ' *********  VLKUT045 STATISTICS *********'          15330023
143700     MOVE PV-READ-COUNT           TO PV-DISP-NBR-C                15340023
143800     DISPLAY 'RECORDS READ    = ' PV-DISP-NBR-C.                  15350023
143900     MOVE PV-STATUS-WRITE-CNT     TO PV-DISP-NBR-C.               15360023
144000     DISPLAY 'STATUS FILE CNT = ' PV-DISP-NBR-C.                  15370023
144100     MOVE PV-BAD-REC-CNT          TO PV-DISP-NBR-C                15380023
144200     DISPLAY 'BAD RECORDS     = ' PV-DISP-NBR-C.                  15390023
144300     MOVE PV-DUP-REC-CNT          TO PV-DISP-NBR-C                15400023
144400     DISPLAY 'DUP RECORDS     = ' PV-DISP-NBR-C.                  15410023
144500     MOVE PV-GOOD-REC-CNT         TO PV-DISP-NBR-C                15420023
144600     DISPLAY 'GOOD RECORDS    = ' PV-DISP-NBR-C.                  15430023
144700     MOVE PV-TOTAL-REC-CNT        TO PV-DISP-NBR-C.               15440023
144800     DISPLAY 'TOTAL RECORDS   = ' PV-DISP-NBR-C.                  15450023
144900     MOVE PV-BAD-FRGT-AMT         TO PV-DISP-DOLLARS-C.           15460023
145000     DISPLAY 'BAD FRGT AMT    = ' PV-DISP-DOLLARS-C.              15470023
145100     MOVE PV-DUP-FRGT-AMT         TO PV-DISP-DOLLARS-C.           15480023
145200     DISPLAY 'DUP FRGT AMT    = ' PV-DISP-DOLLARS-C.              15490023
145300     MOVE PV-GOOD-FRGT-AMT        TO PV-DISP-DOLLARS-C.           15500023
145400     DISPLAY 'GOOD-FRT-AMT    = ' PV-DISP-DOLLARS-C.              15510023
145500     MOVE PV-TOTAL-FRGT-AMT       TO PV-DISP-DOLLARS-C.           15520023
145600     DISPLAY 'TOTAL FRGT AMT  = ' PV-DISP-DOLLARS-C.              15530023
145700                                                                  15540023
145800******************************************************************15550023
145900*  SHOW RECORD COUNTS AND AMOUNTS IN SYSOUT                       15560023
146000******************************************************************15570023
146100 8600-WRITE-STATUS-TOTALS.                                        15580023
146200     INITIALIZE VL065-FAL-STATUS-RECORD.                          15590023
146300     INITIALIZE VL048-FRGT-AUDTERR-RECORD.                        15600023
146400     MOVE SPACES                  TO VL065-PO-NBR-X               15610023
146500                                     VL048-PO-NBR-X               15620023
146600                                     VL065-DC-X                   15630023
146700                                     VL048-DC-X                   15640023
146800                                     VL065-CARTON-CNT-X           15650023
146900                                     VL048-CARTON-CNT-X           15660023
147000                                     VL065-WEIGHT-X               15670023
147100                                     VL048-WEIGHT-X               15680023
147200                                     VL065-CUBES-X                15690023
147300                                     VL048-CUBES-X.               15700023
147400     MOVE PC-COMMA                TO VL065-COMM-17                15710023
147500                                     VL048-COMM-17                15720023
147600                                     VL065-COMM-18                15730023
147700                                     VL048-COMM-18                15740023
147800                                     VL065-COMM-19                15750023
147900                                     VL048-COMM-19.               15760023
148000     MOVE 'BAD RECORDS        '   TO VL065-TOT-LEGEND             15770023
148100                                     VL048-TOT-LEGEND.            15780023
148200     MOVE PV-BAD-REC-CNT          TO PV-DISP-NBR.                 15790023
148300     MOVE PV-DISP-NBR             TO VL065-TOT-COUNT              15800023
148400                                     VL048-TOT-COUNT.             15810023
148500     MOVE PV-BAD-FRGT-AMT         TO PV-DISP-DOLLARS.             15820023
148600     MOVE PV-DISP-DOLLARS         TO VL065-TOT-AMOUNT             15830023
148700                                     VL048-TOT-AMOUNT.            15840023
148800     WRITE FRT-CHGBK-ERROR-RECORD                                 15850023
148900             FROM VL048-FRGT-AUDTERR-RECORD.                      15860023
149000                                                                  15870023
149100     WRITE FAL-STATUS-RECORD                                      15880023
149200             FROM VL065-FAL-STATUS-RECORD.                        15890023
149300                                                                  15900023
149400     INITIALIZE VL065-FAL-STATUS-RECORD.                          15910023
149500     MOVE SPACES                  TO VL065-PO-NBR-X               15920023
149600                                     VL065-DC-X                   15930023
149700                                     VL065-CARTON-CNT-X           15940023
149800                                     VL065-WEIGHT-X               15950023
149900                                     VL065-CUBES-X.               15960023
150000     MOVE PC-COMMA                TO VL065-COMM-17                15970023
150100                                     VL065-COMM-18                15980023
150200                                     VL065-COMM-19.               15990023
150300     MOVE 'DUPLICATE RECORDS  '   TO VL065-TOT-LEGEND.            16000023
150400     MOVE PV-DUP-REC-CNT          TO PV-DISP-NBR.                 16010023
150500     MOVE PV-DISP-NBR             TO VL065-TOT-COUNT.             16020023
150600     MOVE PV-DUP-FRGT-AMT         TO PV-DISP-DOLLARS.             16030023
150700     MOVE PV-DISP-DOLLARS         TO VL065-TOT-AMOUNT.            16040023
150800     WRITE FAL-STATUS-RECORD                                      16050023
150900             FROM VL065-FAL-STATUS-RECORD.                        16060023
151000                                                                  16070023
151100     INITIALIZE VL065-FAL-STATUS-RECORD.                          16080023
151200     MOVE SPACES                  TO VL065-PO-NBR-X               16090023
151300                                     VL065-DC-X                   16100023
151400                                     VL065-CARTON-CNT-X           16110023
151500                                     VL065-WEIGHT-X               16120023
151600                                     VL065-CUBES-X.               16130023
151700     MOVE PC-COMMA                TO VL065-COMM-17                16140023
151800                                     VL065-COMM-18                16150023
151900                                     VL065-COMM-19.               16160023
152000     MOVE 'GOOD RECORDS       '   TO VL065-TOT-LEGEND.            16170023
152100     MOVE PV-GOOD-REC-CNT         TO PV-DISP-NBR.                 16180023
152200     MOVE PV-DISP-NBR             TO VL065-TOT-COUNT.             16190023
152300     MOVE PV-GOOD-FRGT-AMT        TO PV-DISP-DOLLARS.             16200023
152400     MOVE PV-DISP-DOLLARS         TO VL065-TOT-AMOUNT.            16210023
152500     WRITE FAL-STATUS-RECORD                                      16220023
152600             FROM VL065-FAL-STATUS-RECORD.                        16230023
152700                                                                  16240023
152800     INITIALIZE VL065-FAL-STATUS-RECORD.                          16250023
152900     MOVE SPACES                  TO VL065-PO-NBR-X               16260023
153000                                     VL065-DC-X                   16270023
153100                                     VL065-CARTON-CNT-X           16280023
153200                                     VL065-WEIGHT-X               16290023
153300                                     VL065-CUBES-X.               16300023
153400     MOVE PC-COMMA                TO VL065-COMM-17                16310023
153500                                     VL065-COMM-18                16320023
153600                                     VL065-COMM-19.               16330023
153700     MOVE 'TOTAL RECORDS      '   TO VL065-TOT-LEGEND.            16340023
153800     MOVE PV-TOTAL-REC-CNT        TO PV-DISP-NBR.                 16350023
153900     MOVE PV-DISP-NBR             TO VL065-TOT-COUNT.             16360023
154000     MOVE PV-TOTAL-FRGT-AMT       TO PV-DISP-DOLLARS.             16370023
154100     MOVE PV-DISP-DOLLARS         TO VL065-TOT-AMOUNT.            16380023
154200     WRITE FAL-STATUS-RECORD                                      16390023
154300             FROM VL065-FAL-STATUS-RECORD.                        16400023
154400                                                                  16410023
154500******************************************************************16420023
154600*  DB2 ABEND ROUTINE                                             *16430023
154700******************************************************************16440023
154800 9900-DB2-ABEND.                                                  16450023
154900*    DISPLAY '9900-DB2-ABEND'.                                    16460023
155000                                                                  16470023
155100     MOVE SQLCODE TO PV-SQLCODE.                                  16480023
155200     DISPLAY '*** DB2 ERROR '.                                    16490023
155300     DISPLAY '*** SQLCODE   = ' PV-SQLCODE.                       16500023
155400     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 16510023
155500     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               16520023
155600     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               16530023
155700     DISPLAY '*** MESSAGE   = ' PV-DB2-OPERATION-MESSAGE-1.       16540023
155800     DISPLAY '*** TABLE 1   = ' PV-ABEND-STRUCTURE-1.             16550023
155900                                                                  16560023
156000     IF PV-ABEND-STRUCTURE-2 > SPACES                             16570023
156100         DISPLAY '*** TABLE 2   = ' PV-ABEND-STRUCTURE-2          16580023
156200     END-IF.                                                      16590023
156300                                                                  16600023
156400     COPY DPPD004.                                                16610023
156500                                                                  16620023
156600     IF SQLCODE NOT = -911                                        16630023
156700         EXEC SQL                                                 16640023
156800              ROLLBACK                                            16650023
156900         END-EXEC                                                 16660023
157000     END-IF.                                                      16670023
157100                                                                  16680023
157200     MOVE +4013                  TO PV-ABEND-CODE.                16690023
157300     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         16700023
157400*                                                                 16710023
157500* ************************ END OF VLKUT045 ********************** 16720023
