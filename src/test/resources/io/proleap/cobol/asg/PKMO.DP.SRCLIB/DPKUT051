00001 **************                                                    06/18/91
00002  ID DIVISION.                                                     DPKUT051
00003 **************                                                       LV003
00004  PROGRAM-ID.     DPKUT051.                                           CL**2
00005  AUTHOR.         MIKE FURLICK.                                       CL**2
00006  DATE-WRITTEN.   MAY 1991.                                           CL**2
00007 *                                                                    CL**2
00008 *    THIS PROGRAM IS A SUBROUTINE THAT CONVERTS EBCDIC PACKED        CL**2
00009 *    DATA INTO BCD OR VICE VERSA.                                    CL**2
00010 *                                                                    CL**2
00011 *    THERE ARE 5 PARAMETERS REQUIRED FOR THIS SUBROUTINE.            CL**2
00012 *                                                                    CL**2
00013 *    PARM 1 = CONVERSION TYPE - 1 BYTE CHARACTER,                    CL**2
00014 *                      VALUES:  1 = EBCDIC TO BCD                    CL**2
00015 *                               2 = BCD TO EBCDIC                    CL**2
00016 *                                                                    CL**2
00017 *    PARM 2 = LENGTH OF FIELD TO BE CONVERTED - 2 BYTES PACKED.      CL**2
00018 *                                                                    CL**2
00019 *    PARM 3 = INPUT FIELD TO BE CONVERTED.                           CL**2
00020 *             IF EBCDIC TO BCD, THE INPUT IS IN DISPLAY FORMAT:      CL**2
00021 *             F1 F2 F3 F4 = 1234.                                    CL**2
00022 *             -- -- -- --   ----                                     CL**2
00023 *                                                                    CL**2
00024 *             IF BCD TO EBCDIC, THE INPUT IS PACKED, NO SIGN FORMA   CL**2
00025 *             12 34 = 2 BYTES OF PACKED, NO SIGN.                    CL**2
00026 *             -- --                                                  CL**2
00027 *                                                                    CL**2
00028 *    PARM 4 = OUTPUT FIELD WHERE CONVERTED DATA IS RETURNED.         CL**2
00029 *             IF BCD TO EBCDIC, THE OUTPUT IS IN DISPLAY FORMAT:     CL**2
00030 *             F1 F2 F3 F4 = 1234.                                    CL**2
00031 *             -- -- -- --   ----                                     CL**2
00032 *                                                                    CL**2
00033 *             IF EBCDIC TO BDC, THE OUTPUT IS PACKED, NO SIGN FORM   CL**2
00034 *             12 34 = 2 BYTES OF PACKED, NO SIGN.                    CL**2
00035 *             -- --                                                  CL**2
00036 *                                                                    CL**2
00037 *    PARM 5 = RETURN CODE - 2 BYTES CHARACTER.                       CL**2
00038 *             VALUES:  00 - SUCCESSFUL COMPLETION.                   CL**2
00039 *             VALUES:  04 - PARAMETER LENGTH NOT NUMERIC             CL**2
00040 *                           OR OUT OF RANGE.                         CL**2
00041 *             VALUES:  08 - CONVERSION TYPE NOT '1' OR '2'           CL**2
00042 *             VALUES:  12 - EBCDIC INPUT FIELD NOT NUMERIC           CL**2
00043 *             VALUES:  16 - BCD INPUT FIELD NOT NUMERIC              CL**2
00044 *                                                                    CL**2
00045  ENVIRONMENT DIVISION.                                               CL**2
00046  CONFIGURATION SECTION.                                              CL**2
00047  SOURCE-COMPUTER. IBM-3090.                                          CL**2
00048  OBJECT-COMPUTER. IBM-3090.                                          CL**2
00049 *                                                                    CL**2
00050  INPUT-OUTPUT SECTION.                                               CL**2
00051  FILE-CONTROL.                                                       CL**2
00052  DATA DIVISION.                                                      CL**2
00053  FILE SECTION.                                                       CL**2
00054  EJECT                                                               CL**2
00055  WORKING-STORAGE SECTION.                                            CL**2
00056 *                                                                    CL**2
00057  01  WORK-AREA-FOR-EBCDIC-TO-BCD.                                    CL**2
00058      05  WS-EBCDIC-1-AND-ZERO.                                       CL**2
00059          10  WS-EBCDIC-1       PIC X.                                CL**2
00060          10  WS-EBCDIC-1-ZERO  PIC X.                                CL**2
00061      05  WS-EBCDIC-1-NUMERIC  REDEFINES  WS-EBCDIC-1-AND-ZERO        CL**2
00062                                PIC 9(2).                             CL**2
00063      05  WS-EBCDIC-1-TO-BCD    PIC 9(3)  COMP-3.                     CL**2
00064      05  FILLER  REDEFINES  WS-EBCDIC-1-TO-BCD.                      CL**2
00065          10  WS-BCD-1          PIC X.                                CL**2
00066          10  WS-BCD-1-ZERO     PIC X.                                CL**2
00067 *                                                                    CL**2
00068      05  WS-EBCDIC-2-AND-ZERO.                                       CL**2
00069          10  WS-EBCDIC-2       PIC X(2).                             CL**2
00070          10  WS-EBCDIC-2-ZERO  PIC X.                                CL**2
00071      05  WS-EBCDIC-2-NUMERIC  REDEFINES  WS-EBCDIC-2-AND-ZERO        CL**2
00072                                PIC 9(3).                             CL**2
00073      05  WS-EBCDIC-2-TO-BCD    PIC 9(3)  COMP-3.                     CL**2
00074      05  FILLER  REDEFINES  WS-EBCDIC-2-TO-BCD.                      CL**2
00075          10  WS-BCD-2          PIC X.                                CL**2
00076          10  WS-BCD-2-ZERO     PIC X.                                CL**2
00077 *                                                                    CL**2
00078      05  WS-EBCDIC-3-AND-ZERO.                                       CL**2
00079          10  WS-EBCDIC-3       PIC X(3).                             CL**2
00080          10  WS-EBCDIC-3-ZERO  PIC X.                                CL**2
00081      05  WS-EBCDIC-3-NUMERIC  REDEFINES  WS-EBCDIC-3-AND-ZERO        CL**2
00082                                PIC 9(4).                             CL**2
00083      05  WS-EBCDIC-3-TO-BCD    PIC 9(5)  COMP-3.                     CL**2
00084      05  FILLER  REDEFINES  WS-EBCDIC-3-TO-BCD.                      CL**2
00085          10  WS-BCD-3          PIC XX.                               CL**2
00086          10  WS-BCD-3-ZERO     PIC X.                                CL**2
00087 *                                                                    CL**2
00088      05  WS-EBCDIC-4-AND-ZERO.                                       CL**2
00089          10  WS-EBCDIC-4       PIC X(4).                             CL**2
00090          10  WS-EBCDIC-4-ZERO  PIC X.                                CL**2
00091      05  WS-EBCDIC-4-NUMERIC  REDEFINES  WS-EBCDIC-4-AND-ZERO        CL**2
00092                                PIC 9(5).                             CL**2
00093      05  WS-EBCDIC-4-TO-BCD    PIC 9(5)  COMP-3.                     CL**2
00094      05  FILLER  REDEFINES  WS-EBCDIC-4-TO-BCD.                      CL**2
00095          10  WS-BCD-4          PIC XX.                               CL**2
00096          10  WS-BCD-4-ZERO     PIC X.                                CL**2
00097 *                                                                    CL**2
00098      05  WS-EBCDIC-5-AND-ZERO.                                       CL**2
00099          10  WS-EBCDIC-5       PIC X(5).                             CL**2
00100          10  WS-EBCDIC-5-ZERO  PIC X.                                CL**2
00101      05  WS-EBCDIC-5-NUMERIC  REDEFINES  WS-EBCDIC-5-AND-ZERO        CL**2
00102                                PIC 9(6).                             CL**2
00103      05  WS-EBCDIC-5-TO-BCD    PIC 9(7)  COMP-3.                     CL**2
00104      05  FILLER  REDEFINES  WS-EBCDIC-5-TO-BCD.                      CL**2
00105          10  WS-BCD-5          PIC X(3).                             CL**2
00106          10  WS-BCD-5-ZERO     PIC X.                                CL**2
00107 *                                                                    CL**2
00108      05  WS-EBCDIC-6-AND-ZERO.                                       CL**2
00109          10  WS-EBCDIC-6       PIC X(6).                             CL**2
00110          10  WS-EBCDIC-6-ZERO  PIC X.                                CL**2
00111      05  WS-EBCDIC-6-NUMERIC  REDEFINES  WS-EBCDIC-6-AND-ZERO        CL**2
00112                                PIC 9(7).                             CL**2
00113      05  WS-EBCDIC-6-TO-BCD    PIC 9(7)  COMP-3.                     CL**2
00114      05  FILLER  REDEFINES  WS-EBCDIC-6-TO-BCD.                      CL**2
00115          10  WS-BCD-6          PIC X(3).                             CL**2
00116          10  WS-BCD-6-ZERO     PIC X.                                CL**2
00117 *                                                                    CL**2
00118      05  WS-EBCDIC-7-AND-ZERO.                                       CL**2
00119          10  WS-EBCDIC-7       PIC X(7).                             CL**2
00120          10  WS-EBCDIC-7-ZERO  PIC X.                                CL**2
00121      05  WS-EBCDIC-7-NUMERIC  REDEFINES  WS-EBCDIC-7-AND-ZERO        CL**2
00122                                PIC 9(8).                             CL**2
00123      05  WS-EBCDIC-7-TO-BCD    PIC 9(9)  COMP-3.                     CL**2
00124      05  FILLER  REDEFINES  WS-EBCDIC-7-TO-BCD.                      CL**2
00125          10  WS-BCD-7          PIC X(4).                             CL**2
00126          10  WS-BCD-7-ZERO     PIC X.                                CL**2
00127 *                                                                    CL**2
00128      05  WS-EBCDIC-8-AND-ZERO.                                       CL**2
00129          10  WS-EBCDIC-8       PIC X(8).                             CL**2
00130          10  WS-EBCDIC-8-ZERO  PIC X.                                CL**2
00131      05  WS-EBCDIC-8-NUMERIC  REDEFINES  WS-EBCDIC-8-AND-ZERO        CL**2
00132                                PIC 9(9).                             CL**2
00133      05  WS-EBCDIC-8-TO-BCD    PIC 9(9)  COMP-3.                     CL**2
00134      05  FILLER  REDEFINES  WS-EBCDIC-8-TO-BCD.                      CL**2
00135          10  WS-BCD-8          PIC X(4).                             CL**2
00136          10  WS-BCD-8-ZERO     PIC X.                                CL**2
00137 *                                                                    CL**2
00138      05  WS-EBCDIC-9-AND-ZERO.                                       CL**2
00139          10  WS-EBCDIC-9       PIC X(9).                             CL**2
00140          10  WS-EBCDIC-9-ZERO  PIC X.                                CL**2
00141      05  WS-EBCDIC-9-NUMERIC  REDEFINES  WS-EBCDIC-9-AND-ZERO        CL**2
00142                                PIC 9(10).                            CL**2
00143      05  WS-EBCDIC-9-TO-BCD    PIC 9(11) COMP-3.                     CL**2
00144      05  FILLER  REDEFINES  WS-EBCDIC-9-TO-BCD.                      CL**2
00145          10  WS-BCD-9          PIC X(5).                             CL**2
00146          10  WS-BCD-9-ZERO     PIC X.                                CL**2
00147 *                                                                    CL**2
00148      05  WS-EBCDIC-10-AND-ZERO.                                      CL**2
00149          10  WS-EBCDIC-10      PIC X(10).                            CL**2
00150          10  WS-EBCDIC-10-ZERO PIC X.                                CL**2
00151      05  WS-EBCDIC-10-NUMERIC  REDEFINES  WS-EBCDIC-10-AND-ZERO      CL**2
00152                                PIC 9(11).                            CL**2
00153      05  WS-EBCDIC-10-TO-BCD   PIC 9(11) COMP-3.                     CL**2
00154      05  FILLER  REDEFINES  WS-EBCDIC-10-TO-BCD.                     CL**2
00155          10  WS-BCD-10         PIC X(5).                             CL**2
00156          10  WS-BCD-10-ZERO    PIC X.                                CL**2
00157 *                                                                    CL**2
00158      05  WS-EBCDIC-11-AND-ZERO.                                      CL**2
00159          10  WS-EBCDIC-11      PIC X(11).                            CL**2
00160          10  WS-EBCDIC-11-ZERO PIC X.                                CL**2
00161      05  WS-EBCDIC-11-NUMERIC  REDEFINES  WS-EBCDIC-11-AND-ZERO      CL**2
00162                                PIC 9(12).                            CL**2
00163      05  WS-EBCDIC-11-TO-BCD   PIC 9(13) COMP-3.                     CL**2
00164      05  FILLER  REDEFINES  WS-EBCDIC-11-TO-BCD.                     CL**2
00165          10  WS-BCD-11         PIC X(6).                             CL**2
00166          10  WS-BCD-11-ZERO    PIC X.                                CL**2
00167 *                                                                    CL**2
00168      05  WS-EBCDIC-12-AND-ZERO.                                      CL**2
00169          10  WS-EBCDIC-12      PIC X(12).                            CL**2
00170          10  WS-EBCDIC-12-ZERO PIC X.                                CL**2
00171      05  WS-EBCDIC-12-NUMERIC  REDEFINES  WS-EBCDIC-12-AND-ZERO      CL**2
00172                                PIC 9(13).                            CL**2
00173      05  WS-EBCDIC-12-TO-BCD   PIC 9(13) COMP-3.                     CL**2
00174      05  FILLER  REDEFINES  WS-EBCDIC-12-TO-BCD.                     CL**2
00175          10  WS-BCD-12         PIC X(6).                             CL**2
00176          10  WS-BCD-12-ZERO    PIC X.                                CL**2
00177 *                                                                    CL**2
00178      05  WS-EBCDIC-13-AND-ZERO.                                      CL**2
00179          10  WS-EBCDIC-13      PIC X(13).                            CL**2
00180          10  WS-EBCDIC-13-ZERO PIC X.                                CL**2
00181      05  WS-EBCDIC-13-NUMERIC  REDEFINES  WS-EBCDIC-13-AND-ZERO      CL**2
00182                                PIC 9(14).                            CL**2
00183      05  WS-EBCDIC-13-TO-BCD   PIC 9(15) COMP-3.                     CL**2
00184      05  FILLER  REDEFINES  WS-EBCDIC-13-TO-BCD.                     CL**2
00185          10  WS-BCD-13         PIC X(7).                             CL**2
00186          10  WS-BCD-13-ZERO    PIC X.                                CL**2
00187 *                                                                    CL**2
00188      05  WS-EBCDIC-14-AND-ZERO.                                      CL**2
00189          10  WS-EBCDIC-14      PIC X(14).                            CL**2
00190          10  WS-EBCDIC-14-ZERO PIC X.                                CL**2
00191      05  WS-EBCDIC-14-NUMERIC  REDEFINES  WS-EBCDIC-14-AND-ZERO      CL**2
00192                                PIC 9(15).                            CL**2
00193      05  WS-EBCDIC-14-TO-BCD   PIC 9(15) COMP-3.                     CL**2
00194      05  FILLER  REDEFINES  WS-EBCDIC-14-TO-BCD.                     CL**2
00195          10  WS-BCD-14         PIC X(7).                             CL**2
00196          10  WS-BCD-14-ZERO    PIC X.                                CL**2
00197 *                                                                    CL**2
00198      05  WS-EBCDIC-15-AND-ZERO.                                      CL**2
00199          10  WS-EBCDIC-15      PIC X(15).                            CL**2
00200          10  WS-EBCDIC-15-ZERO PIC X.                                CL**2
00201      05  WS-EBCDIC-15-NUMERIC  REDEFINES  WS-EBCDIC-15-AND-ZERO      CL**2
00202                                PIC 9(16).                            CL**2
00203      05  WS-EBCDIC-15-TO-BCD   PIC 9(17) COMP-3.                     CL**2
00204      05  FILLER  REDEFINES  WS-EBCDIC-15-TO-BCD.                     CL**2
00205          10  WS-BCD-15         PIC X(8).                             CL**2
00206          10  WS-BCD-15-ZERO    PIC X.                                CL**2
00207 *                                                                    CL**2
00208      05  WS-EBCDIC-16-AND-ZERO.                                      CL**2
00209          10  WS-EBCDIC-16      PIC X(16).                            CL**2
00210          10  WS-EBCDIC-16-ZERO PIC X.                                CL**2
00211      05  WS-EBCDIC-16-NUMERIC  REDEFINES  WS-EBCDIC-16-AND-ZERO      CL**2
00212                                PIC 9(17).                            CL**2
00213      05  WS-EBCDIC-16-TO-BCD   PIC 9(17) COMP-3.                     CL**2
00214      05  FILLER  REDEFINES  WS-EBCDIC-16-TO-BCD.                     CL**2
00215          10  WS-BCD-16         PIC X(8).                             CL**2
00216          10  WS-BCD-16-ZERO    PIC X.                                CL**2
00217 *                                                                    CL**2
00218  01  MISCELLANEOUS-WORK-AREA.                                        CL**2
00219      05  WS-COMP-FIELD         PIC S9(4) COMP                        CL**2
00220                                          VALUE 15.                   CL**2
00221      05  FILLER  REDEFINES  WS-COMP-FIELD.                           CL**2
00222          10  FILLER            PIC X.                                CL**2
00223          10  WS-HEX-0F         PIC X.                                CL**2
00224      05  WS-FROM-FIELD.                                              CL**3
00225          10  WS-FROM-8         PIC X(8).                             CL**3
00226          10  WS-FROM-1         PIC X.                                CL**3
00227      05  WS-TO-FIELD.                                                CL**3
00228          10  WS-TO-16          PIC X(16).                            CL**3
00229          10  WS-TO-2           PIC XX.                               CL**3
00230  EJECT                                                               CL**2
00231  LINKAGE SECTION.                                                    CL**2
00232 *                                                                    CL**2
00233 *    THE FOLLOWING ARE THE CALLING PROGRAM WORK AREAS USED           CL**2
00234 *    BY THIS SUBROUTINE.                                             CL**2
00235 *                                                                    CL**2
00236  01  LS-CONVERSION-TYPE        PIC X.                                CL**2
00237      88  EBCDIC-TO-BCD-CONVERSION        VALUE '1'.                  CL**2
00238      88  BCD-TO-EBCDIC-CONVERSION        VALUE '2'.                  CL**2
00239  01  LS-LENGTH                 PIC S9(3) COMP-3.                     CL**2
00240  01  LS-FROM-FIELD             PIC X(18).                            CL**3
00241  01  LS-TO-FIELD               PIC X(18).                            CL**3
00242  01  LS-RETURN-CODE            PIC XX.                               CL**2
00243  EJECT                                                               CL**2
00244  PROCEDURE DIVISION USING LS-CONVERSION-TYPE                         CL**2
00245                           LS-LENGTH                                  CL**2
00246                           LS-FROM-FIELD                              CL**2
00247                           LS-TO-FIELD                                CL**2
00248                           LS-RETURN-CODE.                            CL**2
00249  0000-MAINLINE.                                                      CL**2
00250 *                                                                    CL**2
00251 *    FIRST, VALIDATE INPUT PARAMETERS.                               CL**2
00252 *                                                                    CL**2
00253      IF  LS-LENGTH NOT NUMERIC                                       CL**2
00254      OR  LS-LENGTH LESS THAN 1                                       CL**2
00255      OR  LS-LENGTH GREATER THAN 18                                   CL**3
00256          MOVE '04'        TO LS-RETURN-CODE                          CL**2
00257          GOBACK.                                                     CL**2
00258 *                                                                    CL**2
00259 *    IF THE CONVERSION PARAMETER IS VALID INVOKE THE                 CL**2
00260 *    CORRECT ROUTINE, OTHERWISE, RETURN CODE = 8.                    CL**2
00261 *                                                                    CL**2
00262      MOVE '00'            TO LS-RETURN-CODE.                         CL**2
00263      IF  EBCDIC-TO-BCD-CONVERSION                                    CL**2
00264          PERFORM 1000-EBCDIC-TO-BCD                                  CL**2
00265      ELSE                                                            CL**2
00266          IF  BCD-TO-EBCDIC-CONVERSION                                CL**2
00267              PERFORM 2000-BCD-TO-EBCDIC                              CL**2
00268          ELSE                                                        CL**2
00269              MOVE '08'    TO LS-RETURN-CODE                          CL**2
00270          END-IF                                                      CL**2
00271      END-IF.                                                         CL**2
00272 *                                                                    CL**2
00273      GOBACK.                                                         CL**2
00274 *                                                                    CL**2
00275      EJECT                                                           CL**2
00276  1000-EBCDIC-TO-BCD.                                                 CL**2
00277 ****************************************************************     CL**2
00278 *                                                              *     CL**2
00279 *    THIS ROUTINE TAKES DISPLAY DATA AND CONERTS IT TO         *     CL**2
00280 *    BCD FORMAT (PACKED DECIMAL WITH THE SIGN REMOVED).        *     CL**2
00281 *                                                              *     CL**2
00282 *    CHECK THE INPUT LENGTH TO EXECUTE THE CORRECT LOGIC.      *     CL**2
00283 *                                                              *     CL**2
00284 ****************************************************************     CL**2
00285 *                                                                    CL**2
00286      IF  LS-LENGTH EQUAL 1                                           CL**2
00287          PERFORM   1001-EBCDIC-TO-BCD                                CL**2
00288      ELSE                                                            CL**2
00289      IF  LS-LENGTH EQUAL 2                                           CL**2
00290          PERFORM   1002-EBCDIC-TO-BCD                                CL**2
00291      ELSE                                                            CL**2
00292      IF  LS-LENGTH EQUAL 3                                           CL**2
00293          PERFORM   1003-EBCDIC-TO-BCD                                CL**2
00294      ELSE                                                            CL**2
00295      IF  LS-LENGTH EQUAL 4                                           CL**2
00296          PERFORM   1004-EBCDIC-TO-BCD                                CL**2
00297      ELSE                                                            CL**2
00298      IF  LS-LENGTH EQUAL 5                                           CL**2
00299          PERFORM   1005-EBCDIC-TO-BCD                                CL**2
00300      ELSE                                                            CL**2
00301      IF  LS-LENGTH EQUAL 6                                           CL**2
00302          PERFORM   1006-EBCDIC-TO-BCD                                CL**2
00303      ELSE                                                            CL**2
00304      IF  LS-LENGTH EQUAL 7                                           CL**2
00305          PERFORM   1007-EBCDIC-TO-BCD                                CL**2
00306      ELSE                                                            CL**2
00307      IF  LS-LENGTH EQUAL 8                                           CL**2
00308          PERFORM   1008-EBCDIC-TO-BCD                                CL**2
00309      ELSE                                                            CL**2
00310      IF  LS-LENGTH EQUAL 9                                           CL**2
00311          PERFORM   1009-EBCDIC-TO-BCD                                CL**2
00312      ELSE                                                            CL**2
00313      IF  LS-LENGTH EQUAL 10                                          CL**2
00314          PERFORM   1010-EBCDIC-TO-BCD                                CL**2
00315      ELSE                                                            CL**2
00316      IF  LS-LENGTH EQUAL 11                                          CL**2
00317          PERFORM   1011-EBCDIC-TO-BCD                                CL**2
00318      ELSE                                                            CL**2
00319      IF  LS-LENGTH EQUAL 12                                          CL**2
00320          PERFORM   1012-EBCDIC-TO-BCD                                CL**2
00321      ELSE                                                            CL**2
00322      IF  LS-LENGTH EQUAL 13                                          CL**2
00323          PERFORM   1013-EBCDIC-TO-BCD                                CL**2
00324      ELSE                                                            CL**2
00325      IF  LS-LENGTH EQUAL 14                                          CL**2
00326          PERFORM   1014-EBCDIC-TO-BCD                                CL**2
00327      ELSE                                                            CL**2
00328      IF  LS-LENGTH EQUAL 15                                          CL**2
00329          PERFORM   1015-EBCDIC-TO-BCD                                CL**2
00330      ELSE                                                            CL**2
00331      IF  LS-LENGTH EQUAL 16                                          CL**3
00332          PERFORM   1016-EBCDIC-TO-BCD                                CL**3
00333      ELSE                                                            CL**3
00334          PERFORM   1018-EBCDIC-TO-BCD.                               CL**3
00335 *                                                                    CL**2
00336      EJECT                                                           CL**2
00337  1001-EBCDIC-TO-BCD.                                                 CL**2
00338 ****************************************************************     CL**2
00339 *                                                              *     CL**2
00340 *    CONVERT A 1 BYTE EBCDIC FIELD TO A 1 BYTE BCD FIELD.      *     CL**2
00341 *                                                              *     CL**2
00342 ****************************************************************     CL**2
00343 *                                                                    CL**2
00344      MOVE LS-FROM-FIELD  TO  WS-EBCDIC-1.                            CL**2
00345      MOVE '0'            TO  WS-EBCDIC-1-ZERO.                       CL**2
00346 *                                                                    CL**2
00347      IF  WS-EBCDIC-1-NUMERIC NOT NUMERIC                             CL**2
00348          MOVE '12'       TO  LS-RETURN-CODE                          CL**2
00349      ELSE                                                            CL**2
00350          MOVE WS-EBCDIC-1-NUMERIC                                    CL**2
00351                          TO  WS-EBCDIC-1-TO-BCD                      CL**2
00352          MOVE WS-BCD-1   TO  LS-TO-FIELD                             CL**2
00353      END-IF.                                                         CL**2
00354 *                                                                    CL**2
00355      SKIP3                                                           CL**2
00356  1002-EBCDIC-TO-BCD.                                                 CL**2
00357 ****************************************************************     CL**2
00358 *                                                              *     CL**2
00359 *    CONVERT A 2 BYTE EBCDIC FIELD TO A 1 BYTE BCD FIELD.      *     CL**2
00360 *                                                              *     CL**2
00361 ****************************************************************     CL**2
00362 *                                                                    CL**2
00363      MOVE LS-FROM-FIELD  TO  WS-EBCDIC-2.                            CL**2
00364      MOVE '0'            TO  WS-EBCDIC-2-ZERO.                       CL**2
00365 *                                                                    CL**2
00366      IF  WS-EBCDIC-2-NUMERIC NOT NUMERIC                             CL**2
00367          MOVE '12'       TO  LS-RETURN-CODE                          CL**2
00368      ELSE                                                            CL**2
00369          MOVE WS-EBCDIC-2-NUMERIC                                    CL**2
00370                          TO  WS-EBCDIC-2-TO-BCD                      CL**2
00371          MOVE WS-BCD-2   TO  LS-TO-FIELD                             CL**2
00372      END-IF.                                                         CL**2
00373 *                                                                    CL**2
00374      SKIP3                                                           CL**2
00375  1003-EBCDIC-TO-BCD.                                                 CL**2
00376 ****************************************************************     CL**2
00377 *                                                              *     CL**2
00378 *    CONVERT A 3 BYTE EBCDIC FIELD TO A 2 BYTE BCD FIELD.      *     CL**2
00379 *                                                              *     CL**2
00380 ****************************************************************     CL**2
00381 *                                                                    CL**2
00382      MOVE LS-FROM-FIELD  TO  WS-EBCDIC-3.                            CL**2
00383      MOVE '0'            TO  WS-EBCDIC-3-ZERO.                       CL**2
00384 *                                                                    CL**2
00385      IF  WS-EBCDIC-3-NUMERIC NOT NUMERIC                             CL**2
00386          MOVE '12'       TO  LS-RETURN-CODE                          CL**2
00387      ELSE                                                            CL**2
00388          MOVE WS-EBCDIC-3-NUMERIC                                    CL**2
00389                          TO  WS-EBCDIC-3-TO-BCD                      CL**2
00390          MOVE WS-BCD-3   TO  LS-TO-FIELD                             CL**2
00391      END-IF.                                                         CL**2
00392 *                                                                    CL**2
00393      SKIP3                                                           CL**2
00394  1004-EBCDIC-TO-BCD.                                                 CL**2
00395 ****************************************************************     CL**2
00396 *                                                              *     CL**2
00397 *    CONVERT A 4 BYTE EBCDIC FIELD TO A 2 BYTE BCD FIELD.      *     CL**2
00398 *                                                              *     CL**2
00399 ****************************************************************     CL**2
00400 *                                                                    CL**2
00401      MOVE LS-FROM-FIELD  TO  WS-EBCDIC-4.                            CL**2
00402      MOVE '0'            TO  WS-EBCDIC-4-ZERO.                       CL**2
00403 *                                                                    CL**2
00404      IF  WS-EBCDIC-4-NUMERIC NOT NUMERIC                             CL**2
00405          MOVE '12'       TO  LS-RETURN-CODE                          CL**2
00406      ELSE                                                            CL**2
00407          MOVE WS-EBCDIC-4-NUMERIC                                    CL**2
00408                          TO  WS-EBCDIC-4-TO-BCD                      CL**2
00409          MOVE WS-BCD-4   TO  LS-TO-FIELD                             CL**2
00410      END-IF.                                                         CL**2
00411 *                                                                    CL**2
00412      SKIP3                                                           CL**2
00413  1005-EBCDIC-TO-BCD.                                                 CL**2
00414 ****************************************************************     CL**2
00415 *                                                              *     CL**2
00416 *    CONVERT A 5 BYTE EBCDIC FIELD TO A 3 BYTE BCD FIELD.      *     CL**2
00417 *                                                              *     CL**2
00418 ****************************************************************     CL**2
00419 *                                                                    CL**2
00420      MOVE LS-FROM-FIELD  TO  WS-EBCDIC-5.                            CL**2
00421      MOVE '0'            TO  WS-EBCDIC-5-ZERO.                       CL**2
00422 *                                                                    CL**2
00423      IF  WS-EBCDIC-5-NUMERIC NOT NUMERIC                             CL**2
00424          MOVE '12'       TO  LS-RETURN-CODE                          CL**2
00425      ELSE                                                            CL**2
00426          MOVE WS-EBCDIC-5-NUMERIC                                    CL**2
00427                          TO  WS-EBCDIC-5-TO-BCD                      CL**2
00428          MOVE WS-BCD-5   TO  LS-TO-FIELD                             CL**2
00429      END-IF.                                                         CL**2
00430 *                                                                    CL**2
00431      SKIP3                                                           CL**2
00432  1006-EBCDIC-TO-BCD.                                                 CL**2
00433 ****************************************************************     CL**2
00434 *                                                              *     CL**2
00435 *    CONVERT A 6 BYTE EBCDIC FIELD TO A 3 BYTE BCD FIELD.      *     CL**2
00436 *                                                              *     CL**2
00437 ****************************************************************     CL**2
00438 *                                                                    CL**2
00439      MOVE LS-FROM-FIELD  TO  WS-EBCDIC-6.                            CL**2
00440      MOVE '0'            TO  WS-EBCDIC-6-ZERO.                       CL**2
00441 *                                                                    CL**2
00442      IF  WS-EBCDIC-6-NUMERIC NOT NUMERIC                             CL**2
00443          MOVE '12'       TO  LS-RETURN-CODE                          CL**2
00444      ELSE                                                            CL**2
00445          MOVE WS-EBCDIC-6-NUMERIC                                    CL**2
00446                          TO  WS-EBCDIC-6-TO-BCD                      CL**2
00447          MOVE WS-BCD-6   TO  LS-TO-FIELD                             CL**2
00448      END-IF.                                                         CL**2
00449 *                                                                    CL**2
00450      SKIP3                                                           CL**2
00451  1007-EBCDIC-TO-BCD.                                                 CL**2
00452 ****************************************************************     CL**2
00453 *                                                              *     CL**2
00454 *    CONVERT A 7 BYTE EBCDIC FIELD TO A 4 BYTE BCD FIELD.      *     CL**2
00455 *                                                              *     CL**2
00456 ****************************************************************     CL**2
00457 *                                                                    CL**2
00458      MOVE LS-FROM-FIELD  TO  WS-EBCDIC-7.                            CL**2
00459      MOVE '0'            TO  WS-EBCDIC-7-ZERO.                       CL**2
00460 *                                                                    CL**2
00461      IF  WS-EBCDIC-7-NUMERIC NOT NUMERIC                             CL**2
00462          MOVE '12'       TO  LS-RETURN-CODE                          CL**2
00463      ELSE                                                            CL**2
00464          MOVE WS-EBCDIC-7-NUMERIC                                    CL**2
00465                          TO  WS-EBCDIC-7-TO-BCD                      CL**2
00466          MOVE WS-BCD-7   TO  LS-TO-FIELD                             CL**2
00467      END-IF.                                                         CL**2
00468 *                                                                    CL**2
00469      SKIP3                                                           CL**2
00470  1008-EBCDIC-TO-BCD.                                                 CL**2
00471 ****************************************************************     CL**2
00472 *                                                              *     CL**2
00473 *    CONVERT AN 8 BYTE EBCDIC FIELD TO A 4 BYTE BCD FIELD.     *     CL**2
00474 *                                                              *     CL**2
00475 ****************************************************************     CL**2
00476 *                                                                    CL**2
00477      MOVE LS-FROM-FIELD  TO  WS-EBCDIC-8.                            CL**2
00478      MOVE '0'            TO  WS-EBCDIC-8-ZERO.                       CL**2
00479 *                                                                    CL**2
00480      IF  WS-EBCDIC-8-NUMERIC NOT NUMERIC                             CL**2
00481          MOVE '12'       TO  LS-RETURN-CODE                          CL**2
00482      ELSE                                                            CL**2
00483          MOVE WS-EBCDIC-8-NUMERIC                                    CL**2
00484                          TO  WS-EBCDIC-8-TO-BCD                      CL**2
00485          MOVE WS-BCD-8   TO  LS-TO-FIELD                             CL**2
00486      END-IF.                                                         CL**2
00487 *                                                                    CL**2
00488      SKIP3                                                           CL**2
00489  1009-EBCDIC-TO-BCD.                                                 CL**2
00490 ****************************************************************     CL**2
00491 *                                                              *     CL**2
00492 *    CONVERT AN 9 BYTE EBCDIC FIELD TO A 5 BYTE BCD FIELD.     *     CL**2
00493 *                                                              *     CL**2
00494 ****************************************************************     CL**2
00495 *                                                                    CL**2
00496      MOVE LS-FROM-FIELD  TO  WS-EBCDIC-9.                            CL**2
00497      MOVE '0'            TO  WS-EBCDIC-9-ZERO.                       CL**2
00498 *                                                                    CL**2
00499      IF  WS-EBCDIC-9-NUMERIC NOT NUMERIC                             CL**2
00500          MOVE '12'       TO  LS-RETURN-CODE                          CL**2
00501      ELSE                                                            CL**2
00502          MOVE WS-EBCDIC-9-NUMERIC                                    CL**2
00503                          TO  WS-EBCDIC-9-TO-BCD                      CL**2
00504          MOVE WS-BCD-9   TO  LS-TO-FIELD                             CL**2
00505      END-IF.                                                         CL**2
00506 *                                                                    CL**2
00507      SKIP3                                                           CL**2
00508  1010-EBCDIC-TO-BCD.                                                 CL**2
00509 ****************************************************************     CL**2
00510 *                                                              *     CL**2
00511 *    CONVERT A 10 BYTE EBCDIC FIELD TO A 5 BYTE BCD FIELD.     *     CL**2
00512 *                                                              *     CL**2
00513 ****************************************************************     CL**2
00514 *                                                                    CL**2
00515      MOVE LS-FROM-FIELD  TO  WS-EBCDIC-10.                           CL**2
00516      MOVE '0'            TO  WS-EBCDIC-10-ZERO.                      CL**2
00517 *                                                                    CL**2
00518      IF  WS-EBCDIC-10-NUMERIC NOT NUMERIC                            CL**2
00519          MOVE '12'       TO  LS-RETURN-CODE                          CL**2
00520      ELSE                                                            CL**2
00521          MOVE WS-EBCDIC-10-NUMERIC                                   CL**2
00522                          TO  WS-EBCDIC-10-TO-BCD                     CL**2
00523          MOVE WS-BCD-10  TO  LS-TO-FIELD                             CL**2
00524      END-IF.                                                         CL**2
00525 *                                                                    CL**2
00526      SKIP3                                                           CL**2
00527  1011-EBCDIC-TO-BCD.                                                 CL**2
00528 ****************************************************************     CL**2
00529 *                                                              *     CL**2
00530 *    CONVERT AN 11 BYTE EBCDIC FIELD TO A 6 BYTE BCD FIELD.    *     CL**2
00531 *                                                              *     CL**2
00532 ****************************************************************     CL**2
00533 *                                                                    CL**2
00534      MOVE LS-FROM-FIELD  TO  WS-EBCDIC-11.                           CL**2
00535      MOVE '0'            TO  WS-EBCDIC-11-ZERO.                      CL**2
00536 *                                                                    CL**2
00537      IF  WS-EBCDIC-11-NUMERIC NOT NUMERIC                            CL**2
00538          MOVE '12'       TO  LS-RETURN-CODE                          CL**2
00539      ELSE                                                            CL**2
00540          MOVE WS-EBCDIC-11-NUMERIC                                   CL**2
00541                          TO  WS-EBCDIC-11-TO-BCD                     CL**2
00542          MOVE WS-BCD-11  TO  LS-TO-FIELD                             CL**2
00543      END-IF.                                                         CL**2
00544 *                                                                    CL**2
00545      SKIP3                                                           CL**2
00546  1012-EBCDIC-TO-BCD.                                                 CL**2
00547 ****************************************************************     CL**2
00548 *                                                              *     CL**2
00549 *    CONVERT A 12 BYTE EBCDIC FIELD TO A 6 BYTE BCD FIELD.     *     CL**2
00550 *                                                              *     CL**2
00551 ****************************************************************     CL**2
00552 *                                                                    CL**2
00553      MOVE LS-FROM-FIELD  TO  WS-EBCDIC-12.                           CL**2
00554      MOVE '0'            TO  WS-EBCDIC-12-ZERO.                      CL**2
00555 *                                                                    CL**2
00556      IF  WS-EBCDIC-12-NUMERIC NOT NUMERIC                            CL**2
00557          MOVE '12'       TO  LS-RETURN-CODE                          CL**2
00558      ELSE                                                            CL**2
00559          MOVE WS-EBCDIC-12-NUMERIC                                   CL**2
00560                          TO  WS-EBCDIC-12-TO-BCD                     CL**2
00561          MOVE WS-BCD-12  TO  LS-TO-FIELD                             CL**2
00562      END-IF.                                                         CL**2
00563 *                                                                    CL**2
00564      SKIP3                                                           CL**2
00565  1013-EBCDIC-TO-BCD.                                                 CL**2
00566 ****************************************************************     CL**2
00567 *                                                              *     CL**2
00568 *    CONVERT A 13 BYTE EBCDIC FIELD TO A 7 BYTE BCD FIELD.     *     CL**2
00569 *                                                              *     CL**2
00570 ****************************************************************     CL**2
00571 *                                                                    CL**2
00572      MOVE LS-FROM-FIELD  TO  WS-EBCDIC-13.                           CL**2
00573      MOVE '0'            TO  WS-EBCDIC-13-ZERO.                      CL**2
00574 *                                                                    CL**2
00575      IF  WS-EBCDIC-13-NUMERIC NOT NUMERIC                            CL**2
00576          MOVE '12'       TO  LS-RETURN-CODE                          CL**2
00577      ELSE                                                            CL**2
00578          MOVE WS-EBCDIC-13-NUMERIC                                   CL**2
00579                          TO  WS-EBCDIC-13-TO-BCD                     CL**2
00580          MOVE WS-BCD-13  TO  LS-TO-FIELD                             CL**2
00581      END-IF.                                                         CL**2
00582 *                                                                    CL**2
00583      SKIP3                                                           CL**2
00584  1014-EBCDIC-TO-BCD.                                                 CL**2
00585 ****************************************************************     CL**2
00586 *                                                              *     CL**2
00587 *    CONVERT A 14 BYTE EBCDIC FIELD TO A 7 BYTE BCD FIELD.     *     CL**2
00588 *                                                              *     CL**2
00589 ****************************************************************     CL**2
00590 *                                                                    CL**2
00591      MOVE LS-FROM-FIELD  TO  WS-EBCDIC-14.                           CL**2
00592      MOVE '0'            TO  WS-EBCDIC-14-ZERO.                      CL**2
00593 *                                                                    CL**2
00594      IF  WS-EBCDIC-14-NUMERIC NOT NUMERIC                            CL**2
00595          MOVE '12'       TO  LS-RETURN-CODE                          CL**2
00596      ELSE                                                            CL**2
00597          MOVE WS-EBCDIC-14-NUMERIC                                   CL**2
00598                          TO  WS-EBCDIC-14-TO-BCD                     CL**2
00599          MOVE WS-BCD-14  TO  LS-TO-FIELD                             CL**2
00600      END-IF.                                                         CL**2
00601 *                                                                    CL**2
00602      SKIP3                                                           CL**2
00603  1015-EBCDIC-TO-BCD.                                                 CL**2
00604 ****************************************************************     CL**2
00605 *                                                              *     CL**2
00606 *    CONVERT A 15 BYTE EBCDIC FIELD TO AN 8 BYTE BCD FIELD.    *     CL**2
00607 *                                                              *     CL**2
00608 ****************************************************************     CL**2
00609 *                                                                    CL**2
00610      MOVE LS-FROM-FIELD  TO  WS-EBCDIC-15.                           CL**2
00611      MOVE '0'            TO  WS-EBCDIC-15-ZERO.                      CL**2
00612 *                                                                    CL**2
00613      IF  WS-EBCDIC-15-NUMERIC NOT NUMERIC                            CL**2
00614          MOVE '12'       TO  LS-RETURN-CODE                          CL**2
00615      ELSE                                                            CL**2
00616          MOVE WS-EBCDIC-15-NUMERIC                                   CL**2
00617                          TO  WS-EBCDIC-15-TO-BCD                     CL**2
00618          MOVE WS-BCD-15  TO  LS-TO-FIELD                             CL**2
00619      END-IF.                                                         CL**2
00620 *                                                                    CL**2
00621      SKIP3                                                           CL**2
00622  1016-EBCDIC-TO-BCD.                                                 CL**2
00623 ****************************************************************     CL**2
00624 *                                                              *     CL**2
00625 *    CONVERT A 16 BYTE EBCDIC FIELD TO AN 8 BYTE BCD FIELD.    *     CL**2
00626 *                                                              *     CL**2
00627 ****************************************************************     CL**2
00628 *                                                                    CL**2
00629      MOVE LS-FROM-FIELD  TO  WS-EBCDIC-16.                           CL**2
00630      MOVE '0'            TO  WS-EBCDIC-16-ZERO.                      CL**2
00631 *                                                                    CL**2
00632      IF  WS-EBCDIC-16-NUMERIC NOT NUMERIC                            CL**2
00633          MOVE '12'       TO  LS-RETURN-CODE                          CL**2
00634      ELSE                                                            CL**2
00635          MOVE WS-EBCDIC-16-NUMERIC                                   CL**2
00636                          TO  WS-EBCDIC-16-TO-BCD                     CL**2
00637          MOVE WS-BCD-16  TO  LS-TO-FIELD                             CL**2
00638      END-IF.                                                         CL**2
00639 *                                                                    CL**2
00640      SKIP3                                                           CL**3
00641  1018-EBCDIC-TO-BCD.                                                 CL**3
00642 ****************************************************************     CL**3
00643 *                                                              *     CL**3
00644 *    CONVERT A 18 BYTE EBCDIC FIELD TO AN 9 BYTE BCD FIELD.    *     CL**3
00645 *    REQUIRES 2 PASSES.                                        *     CL**3
00646 *                                                              *     CL**3
00647 ****************************************************************     CL**3
00648 *                                                                    CL**3
00649      MOVE LS-FROM-FIELD  TO  WS-TO-FIELD.                            CL**3
00650      PERFORM 1016-EBCDIC-TO-BCD.                                     CL**3
00651      MOVE LS-TO-FIELD    TO  WS-FROM-8.                              CL**3
00652 *                                                                    CL**3
00653      MOVE WS-TO-2        TO  LS-FROM-FIELD.                          CL**3
00654      PERFORM 1002-EBCDIC-TO-BCD.                                     CL**3
00655      MOVE LS-TO-FIELD    TO  WS-FROM-1.                              CL**3
00656      MOVE WS-FROM-FIELD  TO  LS-TO-FIELD.                            CL**3
00657 *                                                                    CL**3
00658      EJECT                                                           CL**2
00659  2000-BCD-TO-EBCDIC.                                                 CL**2
00660 ****************************************************************     CL**2
00661 *                                                              *     CL**2
00662 *    THIS ROUTINE TAKES BCD FORMAT DATA (PACKED DECIMAL WITH   *     CL**2
00663 *    THE SIGN REMOVED) AND CONVERTS IT TO DISPLAY FORMAT.      *     CL**2
00664 *                                                              *     CL**2
00665 *    CHECK THE INPUT LENGTH TO EXECUTE THE CORRECT LOGIC.      *     CL**2
00666 *                                                              *     CL**2
00667 ****************************************************************     CL**2
00668 *                                                                    CL**2
00669      IF  LS-LENGTH EQUAL 1                                           CL**2
00670          PERFORM   2001-BCD-TO-EBCDIC                                CL**2
00671      ELSE                                                            CL**2
00672      IF  LS-LENGTH EQUAL 2                                           CL**2
00673          PERFORM   2002-BCD-TO-EBCDIC                                CL**2
00674      ELSE                                                            CL**2
00675      IF  LS-LENGTH EQUAL 3                                           CL**2
00676          PERFORM   2003-BCD-TO-EBCDIC                                CL**2
00677      ELSE                                                            CL**2
00678      IF  LS-LENGTH EQUAL 4                                           CL**2
00679          PERFORM   2004-BCD-TO-EBCDIC                                CL**2
00680      ELSE                                                            CL**2
00681      IF  LS-LENGTH EQUAL 5                                           CL**2
00682          PERFORM   2005-BCD-TO-EBCDIC                                CL**2
00683      ELSE                                                            CL**2
00684      IF  LS-LENGTH EQUAL 6                                           CL**2
00685          PERFORM   2006-BCD-TO-EBCDIC                                CL**2
00686      ELSE                                                            CL**2
00687      IF  LS-LENGTH EQUAL 7                                           CL**2
00688          PERFORM   2007-BCD-TO-EBCDIC                                CL**2
00689      ELSE                                                            CL**2
00690      IF  LS-LENGTH EQUAL 8                                           CL**2
00691          PERFORM   2008-BCD-TO-EBCDIC                                CL**2
00692      ELSE                                                            CL**2
00693      IF  LS-LENGTH EQUAL 9                                           CL**2
00694          PERFORM   2009-BCD-TO-EBCDIC                                CL**2
00695      ELSE                                                            CL**2
00696      IF  LS-LENGTH EQUAL 10                                          CL**2
00697          PERFORM   2010-BCD-TO-EBCDIC                                CL**2
00698      ELSE                                                            CL**2
00699      IF  LS-LENGTH EQUAL 11                                          CL**2
00700          PERFORM   2011-BCD-TO-EBCDIC                                CL**2
00701      ELSE                                                            CL**2
00702      IF  LS-LENGTH EQUAL 12                                          CL**2
00703          PERFORM   2012-BCD-TO-EBCDIC                                CL**2
00704      ELSE                                                            CL**2
00705      IF  LS-LENGTH EQUAL 13                                          CL**2
00706          PERFORM   2013-BCD-TO-EBCDIC                                CL**2
00707      ELSE                                                            CL**2
00708      IF  LS-LENGTH EQUAL 14                                          CL**2
00709          PERFORM   2014-BCD-TO-EBCDIC                                CL**2
00710      ELSE                                                            CL**2
00711      IF  LS-LENGTH EQUAL 15                                          CL**2
00712          PERFORM   2015-BCD-TO-EBCDIC                                CL**2
00713      ELSE                                                            CL**2
00714      IF  LS-LENGTH EQUAL 16                                          CL**3
00715          PERFORM   2016-BCD-TO-EBCDIC                                CL**3
00716      ELSE                                                            CL**3
00717          PERFORM   2018-BCD-TO-EBCDIC.                               CL**3
00718 *                                                                    CL**2
00719      EJECT                                                           CL**2
00720  2001-BCD-TO-EBCDIC.                                                 CL**2
00721 ****************************************************************     CL**2
00722 *                                                              *     CL**2
00723 *    CONVERT A 1 POSITION (1 BYTE FIELD) BCD FIELD TO          *     CL**2
00724 *    A 1 BYTE EBCDIC FIELD.                                    *     CL**2
00725 *                                                              *     CL**2
00726 ****************************************************************     CL**2
00727 *                                                                    CL**2
00728      MOVE LS-FROM-FIELD    TO  WS-BCD-1.                             CL**2
00729      MOVE WS-HEX-0F        TO  WS-BCD-1-ZERO.                        CL**2
00730 *                                                                    CL**2
00731      IF  WS-EBCDIC-1-TO-BCD NOT NUMERIC                              CL**2
00732          MOVE '16'         TO  LS-RETURN-CODE                        CL**2
00733      ELSE                                                            CL**2
00734          MOVE WS-EBCDIC-1-TO-BCD                                     CL**2
00735                            TO  WS-EBCDIC-1-NUMERIC                   CL**2
00736          MOVE WS-EBCDIC-1  TO  LS-TO-FIELD.                          CL**2
00737 *                                                                    CL**2
00738      SKIP3                                                           CL**2
00739  2002-BCD-TO-EBCDIC.                                                 CL**2
00740 ****************************************************************     CL**2
00741 *                                                              *     CL**2
00742 *    CONVERT A 2 POSITION (1 BYTE FIELD) BCD FIELD TO          *     CL**2
00743 *    A 2 BYTE EBCDIC FIELD.                                    *     CL**2
00744 *                                                              *     CL**2
00745 ****************************************************************     CL**2
00746 *                                                                    CL**2
00747      MOVE LS-FROM-FIELD    TO  WS-BCD-2.                             CL**2
00748      MOVE WS-HEX-0F        TO  WS-BCD-2-ZERO.                        CL**2
00749 *                                                                    CL**2
00750      IF  WS-EBCDIC-2-TO-BCD NOT NUMERIC                              CL**2
00751          MOVE '16'         TO  LS-RETURN-CODE                        CL**2
00752      ELSE                                                            CL**2
00753          MOVE WS-EBCDIC-2-TO-BCD                                     CL**2
00754                            TO  WS-EBCDIC-2-NUMERIC                   CL**2
00755          MOVE WS-EBCDIC-2  TO  LS-TO-FIELD.                          CL**2
00756 *                                                                    CL**2
00757      SKIP3                                                           CL**2
00758  2003-BCD-TO-EBCDIC.                                                 CL**2
00759 ****************************************************************     CL**2
00760 *                                                              *     CL**2
00761 *    CONVERT A 3 POSITION (2 BYTE FIELD) BCD FIELD TO          *     CL**2
00762 *    A 3 BYTE EBCDIC FIELD.                                    *     CL**2
00763 *                                                              *     CL**2
00764 ****************************************************************     CL**2
00765 *                                                                    CL**2
00766      MOVE LS-FROM-FIELD    TO  WS-BCD-3.                             CL**2
00767      MOVE WS-HEX-0F        TO  WS-BCD-3-ZERO.                        CL**2
00768 *                                                                    CL**2
00769      IF  WS-EBCDIC-3-TO-BCD NOT NUMERIC                              CL**2
00770          MOVE '16'         TO  LS-RETURN-CODE                        CL**2
00771      ELSE                                                            CL**2
00772          MOVE WS-EBCDIC-3-TO-BCD                                     CL**2
00773                            TO  WS-EBCDIC-3-NUMERIC                   CL**2
00774          MOVE WS-EBCDIC-3  TO  LS-TO-FIELD.                          CL**2
00775 *                                                                    CL**2
00776      SKIP3                                                           CL**2
00777  2004-BCD-TO-EBCDIC.                                                 CL**2
00778 ****************************************************************     CL**2
00779 *                                                              *     CL**2
00780 *    CONVERT A 4 POSITION (2 BYTE FIELD) BCD FIELD TO          *     CL**2
00781 *    A 4 BYTE EBCDIC FIELD.                                    *     CL**2
00782 *                                                              *     CL**2
00783 ****************************************************************     CL**2
00784 *                                                                    CL**2
00785      MOVE LS-FROM-FIELD    TO  WS-BCD-4.                             CL**2
00786      MOVE WS-HEX-0F        TO  WS-BCD-4-ZERO.                        CL**2
00787 *                                                                    CL**2
00788      IF  WS-EBCDIC-4-TO-BCD NOT NUMERIC                              CL**2
00789          MOVE '16'         TO  LS-RETURN-CODE                        CL**2
00790      ELSE                                                            CL**2
00791          MOVE WS-EBCDIC-4-TO-BCD                                     CL**2
00792                            TO  WS-EBCDIC-4-NUMERIC                   CL**2
00793          MOVE WS-EBCDIC-4  TO  LS-TO-FIELD.                          CL**2
00794 *                                                                    CL**2
00795      SKIP3                                                           CL**2
00796  2005-BCD-TO-EBCDIC.                                                 CL**2
00797 ****************************************************************     CL**2
00798 *                                                              *     CL**2
00799 *    CONVERT A 5 POSITION (3 BYTE FIELD) BCD FIELD TO          *     CL**2
00800 *    A 5 BYTE EBCDIC FIELD.                                    *     CL**2
00801 *                                                              *     CL**2
00802 ****************************************************************     CL**2
00803 *                                                                    CL**2
00804      MOVE LS-FROM-FIELD    TO  WS-BCD-5.                             CL**2
00805      MOVE WS-HEX-0F        TO  WS-BCD-5-ZERO.                        CL**2
00806 *                                                                    CL**2
00807      IF  WS-EBCDIC-5-TO-BCD NOT NUMERIC                              CL**2
00808          MOVE '16'         TO  LS-RETURN-CODE                        CL**2
00809      ELSE                                                            CL**2
00810          MOVE WS-EBCDIC-5-TO-BCD                                     CL**2
00811                            TO  WS-EBCDIC-5-NUMERIC                   CL**2
00812          MOVE WS-EBCDIC-5  TO  LS-TO-FIELD.                          CL**2
00813 *                                                                    CL**2
00814      SKIP3                                                           CL**2
00815  2006-BCD-TO-EBCDIC.                                                 CL**2
00816 ****************************************************************     CL**2
00817 *                                                              *     CL**2
00818 *    CONVERT A 6 POSITION (3 BYTE FIELD) BCD FIELD TO          *     CL**2
00819 *    A 6 BYTE EBCDIC FIELD.                                    *     CL**2
00820 *                                                              *     CL**2
00821 ****************************************************************     CL**2
00822 *                                                                    CL**2
00823      MOVE LS-FROM-FIELD    TO  WS-BCD-6.                             CL**2
00824      MOVE WS-HEX-0F        TO  WS-BCD-6-ZERO.                        CL**2
00825 *                                                                    CL**2
00826      IF  WS-EBCDIC-6-TO-BCD NOT NUMERIC                              CL**2
00827          MOVE '16'         TO  LS-RETURN-CODE                        CL**2
00828      ELSE                                                            CL**2
00829          MOVE WS-EBCDIC-6-TO-BCD                                     CL**2
00830                            TO  WS-EBCDIC-6-NUMERIC                   CL**2
00831          MOVE WS-EBCDIC-6  TO  LS-TO-FIELD.                          CL**2
00832 *                                                                    CL**2
00833      SKIP3                                                           CL**2
00834  2007-BCD-TO-EBCDIC.                                                 CL**2
00835 ****************************************************************     CL**2
00836 *                                                              *     CL**2
00837 *    CONVERT A 7 POSITION (4 BYTE FIELD) BCD FIELD TO          *     CL**2
00838 *    A 7 BYTE EBCDIC FIELD.                                    *     CL**2
00839 *                                                              *     CL**2
00840 ****************************************************************     CL**2
00841 *                                                                    CL**2
00842      MOVE LS-FROM-FIELD    TO  WS-BCD-7.                             CL**2
00843      MOVE WS-HEX-0F        TO  WS-BCD-7-ZERO.                        CL**2
00844 *                                                                    CL**2
00845      IF  WS-EBCDIC-7-TO-BCD NOT NUMERIC                              CL**2
00846          MOVE '16'         TO  LS-RETURN-CODE                        CL**2
00847      ELSE                                                            CL**2
00848          MOVE WS-EBCDIC-7-TO-BCD                                     CL**2
00849                            TO  WS-EBCDIC-7-NUMERIC                   CL**2
00850          MOVE WS-EBCDIC-7  TO  LS-TO-FIELD.                          CL**2
00851 *                                                                    CL**2
00852      SKIP3                                                           CL**2
00853  2008-BCD-TO-EBCDIC.                                                 CL**2
00854 ****************************************************************     CL**2
00855 *                                                              *     CL**2
00856 *    CONVERT AN 8 POSITION (4 BYTE FIELD) BCD FIELD TO         *     CL**2
00857 *    AN 8 BYTE EBCDIC FIELD.                                   *     CL**2
00858 *                                                              *     CL**2
00859 ****************************************************************     CL**2
00860 *                                                                    CL**2
00861      MOVE LS-FROM-FIELD    TO  WS-BCD-8.                             CL**2
00862      MOVE WS-HEX-0F        TO  WS-BCD-8-ZERO.                        CL**2
00863 *                                                                    CL**2
00864      IF  WS-EBCDIC-8-TO-BCD NOT NUMERIC                              CL**2
00865          MOVE '16'         TO  LS-RETURN-CODE                        CL**2
00866      ELSE                                                            CL**2
00867          MOVE WS-EBCDIC-8-TO-BCD                                     CL**2
00868                            TO  WS-EBCDIC-8-NUMERIC                   CL**2
00869          MOVE WS-EBCDIC-8  TO  LS-TO-FIELD.                          CL**2
00870 *                                                                    CL**2
00871      SKIP3                                                           CL**2
00872  2009-BCD-TO-EBCDIC.                                                 CL**2
00873 ****************************************************************     CL**2
00874 *                                                              *     CL**2
00875 *    CONVERT A 9 POSITION (5 BYTE FIELD) BCD FIELD TO          *     CL**2
00876 *    A 9 BYTE EBCDIC FIELD.                                    *     CL**2
00877 *                                                              *     CL**2
00878 ****************************************************************     CL**2
00879 *                                                                    CL**2
00880      MOVE LS-FROM-FIELD    TO  WS-BCD-9.                             CL**2
00881      MOVE WS-HEX-0F        TO  WS-BCD-9-ZERO.                        CL**2
00882 *                                                                    CL**2
00883      IF  WS-EBCDIC-9-TO-BCD NOT NUMERIC                              CL**2
00884          MOVE '16'         TO  LS-RETURN-CODE                        CL**2
00885      ELSE                                                            CL**2
00886          MOVE WS-EBCDIC-9-TO-BCD                                     CL**2
00887                            TO  WS-EBCDIC-9-NUMERIC                   CL**2
00888          MOVE WS-EBCDIC-9  TO  LS-TO-FIELD.                          CL**2
00889 *                                                                    CL**2
00890      SKIP3                                                           CL**2
00891  2010-BCD-TO-EBCDIC.                                                 CL**2
00892 ****************************************************************     CL**2
00893 *                                                              *     CL**2
00894 *    CONVERT A 10 POSITION (5 BYTE FIELD) BCD FIELD TO         *     CL**2
00895 *    A 10 BYTE EBCDIC FIELD.                                   *     CL**2
00896 *                                                              *     CL**2
00897 ****************************************************************     CL**2
00898 *                                                                    CL**2
00899      MOVE LS-FROM-FIELD    TO  WS-BCD-10.                            CL**2
00900      MOVE WS-HEX-0F        TO  WS-BCD-10-ZERO.                       CL**2
00901 *                                                                    CL**2
00902      IF  WS-EBCDIC-10-TO-BCD NOT NUMERIC                             CL**2
00903          MOVE '16'         TO  LS-RETURN-CODE                        CL**2
00904      ELSE                                                            CL**2
00905          MOVE WS-EBCDIC-10-TO-BCD                                    CL**2
00906                            TO  WS-EBCDIC-10-NUMERIC                  CL**2
00907          MOVE WS-EBCDIC-10 TO  LS-TO-FIELD.                          CL**2
00908 *                                                                    CL**2
00909      SKIP3                                                           CL**2
00910  2011-BCD-TO-EBCDIC.                                                 CL**2
00911 ****************************************************************     CL**2
00912 *                                                              *     CL**2
00913 *    CONVERT AN 11 POSITION (6 BYTE FIELD) BCD FIELD TO        *     CL**2
00914 *    AN 11 BYTE EBCDIC FIELD.                                  *     CL**2
00915 *                                                              *     CL**2
00916 ****************************************************************     CL**2
00917 *                                                                    CL**2
00918      MOVE LS-FROM-FIELD    TO  WS-BCD-11.                            CL**2
00919      MOVE WS-HEX-0F        TO  WS-BCD-11-ZERO.                       CL**2
00920 *                                                                    CL**2
00921      IF  WS-EBCDIC-11-TO-BCD NOT NUMERIC                             CL**2
00922          MOVE '16'         TO  LS-RETURN-CODE                        CL**2
00923      ELSE                                                            CL**2
00924          MOVE WS-EBCDIC-11-TO-BCD                                    CL**2
00925                            TO  WS-EBCDIC-11-NUMERIC                  CL**2
00926          MOVE WS-EBCDIC-11 TO  LS-TO-FIELD.                          CL**2
00927 *                                                                    CL**2
00928      SKIP3                                                           CL**2
00929  2012-BCD-TO-EBCDIC.                                                 CL**2
00930 ****************************************************************     CL**2
00931 *                                                              *     CL**2
00932 *    CONVERT A 12 POSITION (6 BYTE FIELD) BCD FIELD TO         *     CL**2
00933 *    A 12 BYTE EBCDIC FIELD.                                   *     CL**2
00934 *                                                              *     CL**2
00935 ****************************************************************     CL**2
00936 *                                                                    CL**2
00937      MOVE LS-FROM-FIELD    TO  WS-BCD-12.                            CL**2
00938      MOVE WS-HEX-0F        TO  WS-BCD-12-ZERO.                       CL**2
00939 *                                                                    CL**2
00940      IF  WS-EBCDIC-12-TO-BCD NOT NUMERIC                             CL**2
00941          MOVE '16'         TO  LS-RETURN-CODE                        CL**2
00942      ELSE                                                            CL**2
00943          MOVE WS-EBCDIC-12-TO-BCD                                    CL**2
00944                            TO  WS-EBCDIC-12-NUMERIC                  CL**2
00945          MOVE WS-EBCDIC-12 TO  LS-TO-FIELD.                          CL**2
00946 *                                                                    CL**2
00947      SKIP3                                                           CL**2
00948  2013-BCD-TO-EBCDIC.                                                 CL**2
00949 ****************************************************************     CL**2
00950 *                                                              *     CL**2
00951 *    CONVERT A 13 POSITION (7 BYTE FIELD) BCD FIELD TO         *     CL**2
00952 *    A 13 BYTE EBCDIC FIELD.                                   *     CL**2
00953 *                                                              *     CL**2
00954 ****************************************************************     CL**2
00955 *                                                                    CL**2
00956      MOVE LS-FROM-FIELD    TO  WS-BCD-13.                            CL**2
00957      MOVE WS-HEX-0F        TO  WS-BCD-13-ZERO.                       CL**2
00958 *                                                                    CL**2
00959      IF  WS-EBCDIC-13-TO-BCD NOT NUMERIC                             CL**2
00960          MOVE '16'         TO  LS-RETURN-CODE                        CL**2
00961      ELSE                                                            CL**2
00962          MOVE WS-EBCDIC-13-TO-BCD                                    CL**2
00963                            TO  WS-EBCDIC-13-NUMERIC                  CL**2
00964          MOVE WS-EBCDIC-13 TO  LS-TO-FIELD.                          CL**2
00965 *                                                                    CL**2
00966      SKIP3                                                           CL**2
00967  2014-BCD-TO-EBCDIC.                                                 CL**2
00968 ****************************************************************     CL**2
00969 *                                                              *     CL**2
00970 *    CONVERT A 14 POSITION (7 BYTE FIELD) BCD FIELD TO         *     CL**2
00971 *    A 14 BYTE EBCDIC FIELD.                                   *     CL**2
00972 *                                                              *     CL**2
00973 ****************************************************************     CL**2
00974 *                                                                    CL**2
00975      MOVE LS-FROM-FIELD    TO  WS-BCD-14.                            CL**2
00976      MOVE WS-HEX-0F        TO  WS-BCD-14-ZERO.                       CL**2
00977 *                                                                    CL**2
00978      IF  WS-EBCDIC-14-TO-BCD NOT NUMERIC                             CL**2
00979          MOVE '16'         TO  LS-RETURN-CODE                        CL**2
00980      ELSE                                                            CL**2
00981          MOVE WS-EBCDIC-14-TO-BCD                                    CL**2
00982                            TO  WS-EBCDIC-14-NUMERIC                  CL**2
00983          MOVE WS-EBCDIC-14 TO  LS-TO-FIELD.                          CL**2
00984 *                                                                    CL**2
00985      SKIP3                                                           CL**2
00986  2015-BCD-TO-EBCDIC.                                                 CL**2
00987 ****************************************************************     CL**2
00988 *                                                              *     CL**2
00989 *    CONVERT A 15 POSITION (8 BYTE FIELD) BCD FIELD TO         *     CL**2
00990 *    A 15 BYTE EBCDIC FIELD.                                   *     CL**2
00991 *                                                              *     CL**2
00992 ****************************************************************     CL**2
00993 *                                                                    CL**2
00994      MOVE LS-FROM-FIELD    TO  WS-BCD-15.                            CL**2
00995      MOVE WS-HEX-0F        TO  WS-BCD-15-ZERO.                       CL**2
00996 *                                                                    CL**2
00997      IF  WS-EBCDIC-15-TO-BCD NOT NUMERIC                             CL**2
00998          MOVE '16'         TO  LS-RETURN-CODE                        CL**2
00999      ELSE                                                            CL**2
01000          MOVE WS-EBCDIC-15-TO-BCD                                    CL**2
01001                            TO  WS-EBCDIC-15-NUMERIC                  CL**2
01002          MOVE WS-EBCDIC-15 TO  LS-TO-FIELD.                          CL**2
01003 *                                                                    CL**2
01004      SKIP3                                                           CL**2
01005  2016-BCD-TO-EBCDIC.                                                 CL**2
01006 ****************************************************************     CL**2
01007 *                                                              *     CL**2
01008 *    CONVERT A 16 POSITION (8 BYTE FIELD) BCD FIELD TO         *     CL**2
01009 *    A 16 BYTE EBCDIC FIELD.                                   *     CL**2
01010 *                                                              *     CL**2
01011 ****************************************************************     CL**2
01012 *                                                                    CL**2
01013      MOVE LS-FROM-FIELD    TO  WS-BCD-16.                            CL**2
01014      MOVE WS-HEX-0F        TO  WS-BCD-16-ZERO.                       CL**2
01015 *                                                                    CL**2
01016      IF  WS-EBCDIC-16-TO-BCD NOT NUMERIC                             CL**2
01017          MOVE '16'         TO  LS-RETURN-CODE                        CL**2
01018      ELSE                                                            CL**2
01019          MOVE WS-EBCDIC-16-TO-BCD                                    CL**2
01020                            TO  WS-EBCDIC-16-NUMERIC                  CL**2
01021          MOVE WS-EBCDIC-16 TO  LS-TO-FIELD.                          CL**2
01022 *                                                                    CL**2
01023      SKIP3                                                           CL**3
01024  2018-BCD-TO-EBCDIC.                                                 CL**3
01025 ****************************************************************     CL**3
01026 *                                                              *     CL**3
01027 *    CONVERT A 18 POSITION (9 BYTE FIELD) BCD FIELD TO         *     CL**3
01028 *    A 18 BYTE EBCDIC FIELD - REQUIRES 2 PASSES.               *     CL**3
01029 *                                                              *     CL**3
01030 ****************************************************************     CL**3
01031 *                                                                    CL**3
01032      MOVE LS-FROM-FIELD    TO  WS-FROM-FIELD.                        CL**3
01033      PERFORM 2016-BCD-TO-EBCDIC.                                     CL**3
01034      MOVE LS-TO-FIELD      TO  WS-TO-16.                             CL**3
01035 *                                                                    CL**3
01036      MOVE WS-FROM-1        TO  LS-FROM-FIELD.                        CL**3
01037      PERFORM 2002-BCD-TO-EBCDIC.                                     CL**3
01038      MOVE LS-TO-FIELD      TO  WS-TO-2.                              CL**3
01039      MOVE WS-TO-FIELD      TO  LS-TO-FIELD.                          CL**3
01040 *                                                                    CL**3
