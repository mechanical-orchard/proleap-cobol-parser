000100 IDENTIFICATION DIVISION.                                         00010000
000200******************************************************************00020000
000300*                                                                *00030000
000400* THIS IS A COPY OF DLKCS410 FOR BATCH USE                       *00040000
000500*                                                                *00050000
000600****** IMPORTANT *******                                         *00060000
000700*      ANY CHANGES MADE HERE SHOULD ALSO BE MADE IN DLKCS410     *00070000
000800*                                                                *00080000
000900* DISTRIBUTION LABOR MODULE USED TO DETERMINE IF AN ASSIGNMENT   *00090000
001000* EXISTS FOR A DC/WORK TYPE/WORK AREA.  WILL CONTROL THE         *00100000
001100* PROCESSING TO CHECK FOR THE ASSIGNMENT, MANAGE CREATING A NEW  *00110000
001200* ASSIGNMENT IF NEEDED AND THEN CONTROL THE PROCESSING FOR THE   *00120000
001300* USER ID TO ASSIGN THE USER TO THE ASSIGNMENT IN QUESTION.      *00130000
001400*                                                                *00140000
001500* THIS MODULE USES THE FOLLOWING MODULES TO COMPLETE THE         *00150000
001600* PROCESSING:                                                    *00160000
001700*     DLKUT001 - DETERMINE IF USER ID IS ACTIVE ON AN ASSIGNMENT *00170000
001800*     DLKUT002 - DETERMINE IF THERE IS AN ACTIVE ASSIGNMENT FOR  *00180000
001900*                THE DC/WORK TYPE/WORK AREA                      *00190000
002000*     DLKUT025 - ADD/END A USER TO AN ASSIGNMENT                 *00200000
002100*     DLKUT026 - CREATE A NEW ASSIGNMENT                         *00210000
002200*     XLKUT067 - USER ID MODULE (VALIDATE/RETURN TYPE AND NAME)  *00220000
002300*     XLKUP046 - MODULE TO WRITE TO EAI BUSINESS EVENT EXPORT    *00230000
002400*                TABLES (LOG A SYSTEM MOVE OF AN ASSOCIATE)      *00240000
002500*                                                                *00250000
002600******************************************************************00260000
002700                                                                  00270000
002800 PROGRAM-ID.    DLKUT410.                                         00280000
002900 AUTHOR.        JEAN KURKOWSKI.                                   00290000
003000 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00300000
003100 DATE-WRITTEN   JULY 2007.                                        00310000
003200 DATE-COMPILED.                                                   00320000
003300                                                                  00330000
003400 ENVIRONMENT DIVISION.                                            00340000
003500 CONFIGURATION SECTION.                                           00350000
003600 SOURCE-COMPUTER.        IBM-3090.                                00360000
003700 OBJECT-COMPUTER.        IBM-3090.                                00370000
003800                                                                  00380000
003900 DATA DIVISION.                                                   00390000
004000 WORKING-STORAGE SECTION.                                         00400000
004100                                                                  00410000
004200*----------------------------------------------------------------*00420000
004300*   PROGRAM SWITCHES                                             *00430000
004400*----------------------------------------------------------------*00440000
004500 01  PS-PROGRAM-SWITCHES.                                         00450000
004600                                                                  00460000
004700     05  PS-ERROR-SW                  PIC X(01) VALUE 'N'.        00470000
004800         88  PS-NO-ERROR                        VALUE 'N'.        00480000
004900         88  PS-ERROR                           VALUE 'Y'.        00490000
005000     05  PS-CALLED-MODULE-ERROR-SW    PIC X(01) VALUE 'N'.        00500000
005100         88  PS-NO-CALLED-MODULE-ERROR          VALUE 'N'.        00510000
005200         88  PS-CALLED-MODULE-ERROR             VALUE 'Y'.        00520000
005300     05  PS-CREATE-NEW-ASGMT-SW       PIC X(01) VALUE 'N'.        00530000
005400         88  PS-CREATE-NEW-ASGMT                VALUE 'N'.        00540000
005500         88  PS-DO-NOT-CREATE-NEW-ASGMT         VALUE 'Y'.        00550000
005600     05  PS-ASGMTS-MATCH-SW           PIC X(01) VALUE 'N'.        00560000
005700         88  PS-ASGMTS-DO-NOT-MATCH             VALUE 'N'.        00570000
005800         88  PS-ASGMTS-MATCH                    VALUE 'Y'.        00580000
005900     05  PS-CREATE-NEW-USER-SW        PIC X(01) VALUE 'N'.        00590000
006000         88  PS-CREATE-NEW-USER-NO              VALUE 'N'.        00600000
006100         88  PS-CREATE-NEW-USER-YES             VALUE 'Y'.        00610000
006200     05  PS-XLKUT067-CALLED-SW        PIC X(01) VALUE 'N'.        00620000
006300         88  PS-XLKUT067-CALLED-NO              VALUE 'N'.        00630000
006400         88  PS-XLKUT067-CALLED-YES             VALUE 'Y'.        00640000
006500     05  PS-USER-TABLES-CHECKED-SW    PIC X(01) VALUE 'N'.        00650000
006600         88  PS-USER-TABLES-CHECKED-NO          VALUE 'N'.        00660000
006700         88  PS-USER-TABLES-CHECKED-YES         VALUE 'Y'.        00670000
006800     05  PS-USER-FOUND-SW             PIC  X(01).                 00680000
006900         88  PS-USER-NOT-FOUND                  VALUE 'N'.        00690000
007000         88  PS-USER-IS-KOHLS                   VALUE 'K'.        00700000
007100         88  PS-USER-IS-TEMP                    VALUE 'T'.        00710000
007110     05  PS-CHECKING-MULT-ASGMT-SW    PIC X(01) VALUE 'N'.        00711000
007120         88  PS-NOT-CHECKING-MULT-ASGMT         VALUE 'N'.        00712000
007130         88  PS-CHECKING-MULT-ASGMT             VALUE 'Y'.        00713000
007140                                                                  00714000
007150*----------------------------------------------------------------*00715000
007160*   PROGRAM CONSTANTS                                            *00716000
007170*----------------------------------------------------------------*00717000
007180 01  PC-PROGRAM-CONSTANTS.                                        00718000
007190                                                                  00719000
007200     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)  VALUE 'DLKUT410'.00720000
007300                                                                  00730000
007400*----------------------------------------------------------------*00740000
007500*   PROGRAM VARIABLES                                            *00750000
007600*----------------------------------------------------------------*00760000
007700 01  PV-VARIABLES.                                                00770000
007800     05  PV-USR-LAST-NM              PIC  X(40)  VALUE SPACES.    00780000
007900     05  PV-USR-FRST-NM              PIC  X(40)  VALUE SPACES.    00790000
008000     05  PV-FUNC-TXT                 PIC  X(25)  VALUE SPACES.    00800000
008100                                                                  00810000
008200     05  PV-DISP-SQLCODE             PIC  999-   VALUE ZERO.      00820000
008300     05  PV-DISP-OPER                PIC  9999-  VALUE ZERO.      00830000
008400     05  PV-DISP-LOC-NBR             PIC  9999-  VALUE ZERO.      00840000
008500     05  PV-DISP-ASGMT1              PIC  9(09)  VALUE ZERO.      00850000
008600     05  PV-DISP-ASGMT2              PIC  9(09)  VALUE ZERO.      00860000
008700     05  PV-LOC-NBR                  PIC S9(04)  VALUE ZERO       00870000
008800                                                  COMP.           00880000
008810     05  PV-DISP-ASGMT-SEQ           PIC  9(09)  VALUE ZERO.      00881002
008820     05  PV-DISP-TEM-SEQ             PIC  9(09)  VALUE ZERO.      00882002
008900                                                                  00890000
009000     05  PV-HOLD-USR-ID              PIC  X(08)  VALUE SPACES.    00900000
009100     05  PV-HOLD-USR-TYP-CDE         PIC  X(01)  VALUE SPACES.    00910000
009200                                                                  00920000
009300     05  PV-LABOR-CURRENT-DATE       PIC  X(10).                  00930000
009400     05  PV-LABOR-CURRENT-TIME       PIC  X(08).                  00940000
009500     05  PV-LABOR-CURRENT-TIMESTAMP  PIC  X(26).                  00950000
009600     05  PV-HOLD-TIMESTAMP           PIC  X(26).                  00960000
009700                                                                  00970000
009800     05  PV-HOLD-ASGMT-START-DTE     PIC  X(10)  VALUE SPACES.    00980000
009900     05  PV-HOLD-ASGMT-NBR-TXT       PIC  X(10)  VALUE SPACES.    00990000
010000     05  PV-HOLD-ASGMT-NBR-SEQ-NBR   PIC S9(09)  COMP             01000000
010100                                                 VALUE ZEROS.     01010000
010200     05  PV-HOLD-TEM-ASGMT-SEQ-NBR   PIC S9(09)  COMP             01020000
010300                                                 VALUE ZEROS.     01030000
010400                                                                  01040000
010500     05  PV-DISPLAY-DC-NBR           PIC  99999  VALUE ZEROS.     01050000
010600     05  PV-DISPLAY-QTY-5            PIC  99999  VALUE ZEROS.     01060000
010700     05  PV-DISPLAY-TEXT             PIC  XXXXX  VALUE ZEROS.     01070000
010800                                                                  01080000
010900     05  PV-CURRENT-DATE             PIC  X(10)  VALUE SPACES.    01090000
011000     05  PV-CURRENT-DATE-R REDEFINES PV-CURRENT-DATE.             01100000
011100         10 PV-CURRENT-CC            PIC  9(02).                  01110000
011200         10 PV-CURRENT-YY            PIC  9(02).                  01120000
011300         10 FILLER                   PIC  X(01).                  01130000
011400         10 PV-CURRENT-MM            PIC  9(02).                  01140000
011500         10 FILLER                   PIC  X(01).                  01150000
011600         10 PV-CURRENT-DD            PIC  9(02).                  01160000
011700     05  PV-CURRENT-TIME             PIC  X(08)  VALUE SPACES.    01170000
011800     05  PV-CURRENT-TIME-R REDEFINES PV-CURRENT-TIME.             01180000
011900         10 PV-CURRENT-HR            PIC  9(02).                  01190000
012000         10 FILLER                   PIC  X(01).                  01200000
012100         10 PV-CURRENT-MN            PIC  9(02).                  01210000
012200         10 FILLER                   PIC  X(03).                  01220000
012300                                                                  01230000
012400     05  PV-MODULE-FAIL-MSG.                                      01240000
012500         10  FILLER                     PIC  X(12)  VALUE         01250000
012600                                        ' PARAGRAPH: '.           01260000
012700         10  PV-MODULE-PARAGRAPH        PIC  X(30)  VALUE SPACE.  01270000
012800                                                                  01280000
012900     05  PV-MSG-AREA2                    PIC  X(100) VALUE SPACE. 01290000
013000     05  PV-COMMAREA-LENGTH              PIC S9(04) COMP          01300000
013100                                                    VALUE +0.     01310000
013200     05  PV-DISPLAY-OPER                 PIC  9(04).              01320000
013300     05  PV-DISPLAY-SQLCODE              PIC  -999.               01330000
013400     05  PV-ASGMT-COUNT                  PIC S9(09)  COMP.        01340000
013500                                                                  01350000
013600*----------------------------------------------------------------*01360000
013700*    COMMAREA TO BE PASSED TO DLKUT001                            01370000
013800*----------------------------------------------------------------*01380000
013900     COPY DLWS003.                                                01390000
014000                                                                  01400000
014100*----------------------------------------------------------------*01410000
014200*    COMMAREA TO BE PASSED TO DLKUT002                            01420000
014300*----------------------------------------------------------------*01430000
014400     COPY DLWS004.                                                01440000
014500                                                                  01450000
014600*----------------------------------------------------------------*01460000
014700*    COMMAREA TO BE PASSED TO DLKUT025                            01470000
014800*----------------------------------------------------------------*01480000
014900     COPY DLWS021.                                                01490000
015000                                                                  01500000
015100*----------------------------------------------------------------*01510000
015200*    COMMAREA TO BE PASSED TO DLKUT026                            01520000
015300*----------------------------------------------------------------*01530000
015400     COPY DLWS022.                                                01540000
015500                                                                  01550000
015600*----------------------------------------------------------------*01560000
015700*    COPYBOOK USED TO ENSURE THAT ASSIGNMENT NUMBERS AND WORK     01570000
015800*    TYPES AND AREAS ARE DEFINED IN A CONSISTENT MANNER.          01580000
015900*----------------------------------------------------------------*01590000
016000     COPY DLWS011.                                                01600000
016100                                                                  01610000
016200*----------------------------------------------------------------*01620000
016300*    COMMAREA TO BE PASSED TO XLKUT067                            01630000
016400*----------------------------------------------------------------*01640000
016500***  COPY XLWS067.                                                01650000
016600                                                                  01660000
016700*----------------------------------------------------------------*01670000
016800*    COMMAREA TO BE PASSED TO XLKUP046                            01680000
016900*----------------------------------------------------------------*01690000
017000     COPY XLWS091.                                                01700000
017100                                                                  01710000
017110*----------------------------------------------------------------*01711000
017120*    COMMAREA TO BE PASSED TO DLKUT029                            01712000
017130*----------------------------------------------------------------*01713000
017140     COPY DLWS025.                                                01714000
017150                                                                  01715000
017160*----------------------------------------------------------------*01716000
017170*    COMMAREA TO BE PASSED TO DLKUT031                            01717000
017180*----------------------------------------------------------------*01718000
017190     COPY DLWS027.                                                01719000
017191                                                                  01719100
017192/    TERMINAL SIGNON INFO                                         01719200
017193     COPY DPWS026.                                                01719300
017194*    STANDARD ABEND STUFF                                         01719400
017195     COPY DPWS013.                                                01719500
017196                                                                  01719600
017197*---------------------------------------------------------------* 01719700
017198*    DCLGEN FOR DLT_RDPR_USR_LSTG                               * 01719800
017199*---------------------------------------------------------------* 01719900
017200     EXEC SQL                                                     01720000
017300         INCLUDE DLT00009                                         01730000
017400     END-EXEC.                                                    01740000
017500                                                                  01750000
017600*     XLT_USR                                                     01760000
017700     EXEC SQL                                                     01770000
017800         INCLUDE XLT00024                                         01780000
017900     END-EXEC.                                                    01790000
018000                                                                  01800000
018100*     DLT_TMP_EMP                                                 01810000
018200     EXEC SQL                                                     01820000
018300         INCLUDE DLT00002                                         01830000
018400     END-EXEC.                                                    01840000
018500                                                                  01850000
018600*----------------------------------------------------------------*01860000
018700*   DLT_ASGMT - LABOR ASSIGNMENT TABLE                            01870000
018800*----------------------------------------------------------------*01880000
018900     EXEC SQL                                                     01890000
019000         INCLUDE DLT00004                                         01900000
019100     END-EXEC.                                                    01910000
019200                                                                  01920000
019210*----------------------------------------------------------------*01921000
019220*   DLT_TEM_ASGMT - LABOR TEAM ASSIGNMENT TABLE                   01922000
019230*----------------------------------------------------------------*01923000
019240     EXEC SQL                                                     01924000
019250         INCLUDE DLT00003                                         01925000
019260     END-EXEC.                                                    01926000
019270                                                                  01927000
019280*----------------------------------------------------------------*01928000
019290*    CORP PARM TABLE                                              01929000
019300*----------------------------------------------------------------*01930000
019310     EXEC SQL                                                     01931000
019320         INCLUDE TKRPRPM                                          01932000
019330     END-EXEC.                                                    01933000
019340                                                                  01934000
019350*----------------------------------------------------------------*01935000
019360*   TUPLDER - UPLOAD ERROR TABLE                                  01936000
019370*----------------------------------------------------------------*01937000
019380     EXEC SQL                                                     01938000
019390         INCLUDE TUPLDER                                          01939000
019391     END-EXEC.                                                    01939100
019392                                                                  01939200
019393*---------------------------------------------------------------* 01939300
019394*    DB2 AREA FOR COMMUNICATIONS                                * 01939400
019395*---------------------------------------------------------------* 01939500
019396     EXEC SQL                                                     01939600
019397          INCLUDE SQLCA                                           01939700
019398     END-EXEC.                                                    01939800
019399                                                                  01939900
019400                                                                  01940000
019500 LINKAGE SECTION.                                                 01950000
019600                                                                  01960000
019700     COPY DLWS019.                                                01970000
019800                                                                  01980000
019900*----------------------------------------------------------------*01990000
020000 PROCEDURE DIVISION USING DL019-PGM-COMMAREA.                     02000000
020100                                                                  02010000
020200 0000-PROGRAM-MAINLINE.                                           02020000
020300                                                                  02030000
020400     SET DL019-SUCCESSFUL             TO TRUE.                    02040000
020500                                                                  02050000
020600***                                                               02060000
020700*** DMH - BEGIN - 6/17/10                                         02070000
020800*** REPLACE INITIALIZE STATEMENTS WITH SET/MOVE STATEMENTS        02080000
020900*** INITIALIZE DOES NOT CLEAR OUT THE DATA CONSISTENTLY           02090000
021000***                                                               02100000
021100***  INITIALIZE  PS-PROGRAM-SWITCHES                              02110000
021200***              PV-VARIABLES                                     02120000
021300     INITIALIZE  DCLDLT00009.                                     02130000
021400                                                                  02140000
021410***                                                               02141000
021420***   SET SWITCHES                                                02142000
021421***                                                               02142100
021422     SET  PS-NO-ERROR                                             02142200
021423          PS-NO-CALLED-MODULE-ERROR                               02142300
021424          PS-CREATE-NEW-ASGMT                                     02142400
021425          PS-ASGMTS-DO-NOT-MATCH                                  02142500
021426          PS-CREATE-NEW-USER-NO                                   02142600
021427          PS-XLKUT067-CALLED-NO                                   02142700
021428          PS-USER-TABLES-CHECKED-NO                               02142800
021429          PS-NOT-CHECKING-MULT-ASGMT  TO  TRUE.                   02142900
021430                                                                  02143000
021440     MOVE SPACES                      TO  PS-USER-FOUND-SW.       02144000
021450                                                                  02145000
021451***                                                               02145100
021452***   SET PROGRAM VARIABLES                                       02145200
021453***                                                               02145300
021454                                                                  02145400
021455     MOVE SPACES                 TO  PV-USR-LAST-NM               02145500
021456                                     PV-USR-FRST-NM               02145600
021457                                     PV-FUNC-TXT                  02145700
021458                                     PV-HOLD-USR-ID               02145800
021459                                     PV-HOLD-USR-TYP-CDE          02145900
021460                                     PV-LABOR-CURRENT-DATE        02146000
021461                                     PV-LABOR-CURRENT-TIME        02146100
021462                                     PV-LABOR-CURRENT-TIMESTAMP   02146200
021463                                     PV-HOLD-TIMESTAMP            02146300
021464                                     PV-HOLD-ASGMT-START-DTE      02146400
021465                                     PV-HOLD-ASGMT-NBR-TXT        02146500
021466                                     PV-CURRENT-DATE              02146600
021467                                     PV-CURRENT-TIME              02146700
021468                                     PV-MSG-AREA2                 02146800
021469                                     PV-MODULE-PARAGRAPH.         02146900
021470                                                                  02147000
021471     MOVE  ZEROES                TO  PV-DISP-SQLCODE              02147100
021472                                     PV-DISP-OPER                 02147200
021473                                     PV-DISP-LOC-NBR              02147300
021474                                     PV-DISP-ASGMT1               02147400
021475                                     PV-DISP-ASGMT2               02147500
021476                                     PV-LOC-NBR                   02147600
021477                                     PV-HOLD-ASGMT-NBR-SEQ-NBR    02147700
021478                                     PV-HOLD-TEM-ASGMT-SEQ-NBR    02147800
021479                                     PV-DISPLAY-DC-NBR            02147900
021480                                     PV-DISPLAY-QTY-5             02148000
021481                                     PV-DISPLAY-TEXT              02148100
021482                                     PV-COMMAREA-LENGTH           02148200
021483                                     PV-DISPLAY-OPER              02148300
021484                                     PV-DISPLAY-SQLCODE           02148400
021485                                     PV-ASGMT-COUNT.              02148500
021486                                                                  02148600
021487***                                                               02148700
021488*** DMH - END - 6/17/10                                           02148800
021489***                                                               02148900
021490                                                                  02149000
021500     PERFORM 7030-SELECT-TKRPRPM.                                 02150000
021510                                                                  02151000
021520     IF KRPRPM-FUNC-TXT = 'Y'                                     02152000
021521         DISPLAY ' --------------------------'                    02152100
021522         DISPLAY ' DLKUT410 START 0000- PARA '                    02152200
021523     END-IF.                                                      02152300
021524                                                                  02152400
021525     SET PS-NO-ERROR TO TRUE.                                     02152500
021526     PERFORM 1000-VALIDATE-DATA.                                  02152600
021527                                                                  02152700
021528* DMH - 12/10/08 - BEGIN                                          02152800
021529     IF  PS-ERROR                                                 02152900
021530         CONTINUE                                                 02153000
021540     ELSE                                                         02154000
021550         SET  PS-NOT-CHECKING-MULT-ASGMT  TO  TRUE                02155000
021560         PERFORM 4000-SELECT-TKRPRPM                              02156000
021570         IF  PS-CHECKING-MULT-ASGMT                               02157000
021580             PERFORM 4100-CHECK-MULT-ASGMT                        02158000
021590         END-IF                                                   02159000
021600     END-IF.                                                      02160000
021700* DMH - 12/10/08 - BEGIN                                          02170000
021800                                                                  02180000
021900     IF  PS-ERROR                                                 02190000
022000         CONTINUE                                                 02200000
022100     ELSE                                                         02210000
022200         IF  DL019-ESTABLISH-ASGMT                                02220000
022300             PERFORM 2000-ESTABLISH-ASGMT                         02230000
022400         ELSE                                                     02240000
022500             IF  DL019-ESTABLISH-TEAM                             02250000
022600                 SET DL019-INVALID-ACCESS TO TRUE                 02260000
022700                 SET PS-ERROR TO TRUE                             02270000
022800             ELSE                                                 02280000
022900                 SET DL019-INVALID-ACCESS TO TRUE                 02290000
023000                 SET PS-ERROR TO TRUE                             02300000
023100             END-IF                                               02310000
023200         END-IF                                                   02320000
023300     END-IF.                                                      02330000
023400                                                                  02340000
023500     IF  PS-ERROR                                                 02350000
023600         CONTINUE                                                 02360000
023700     ELSE                                                         02370000
023800         SET DL019-SUCCESSFUL TO TRUE                             02380000
023900     END-IF.                                                      02390000
024000                                                                  02400000
024100     PERFORM 9000-RETURN-CALL.                                    02410000
024200                                                                  02420000
024300                                                                  02430000
024400*----------------------------------------------------------------*02440000
024500*  THIS WILL PERFORM ALL OF THE VALIDATION OF THE DATA PASSED    *02450000
024600*  FROM THE CALLING PROGRAM                                      *02460000
024700*----------------------------------------------------------------*02470000
024800 1000-VALIDATE-DATA.                                              02480000
024801                                                                  02480100
024802     IF KRPRPM-FUNC-TXT = 'Y'                                     02480200
024803         DISPLAY ' DLKUT410 START 1000- PARA '                    02480300
024804                 ' SIGN ON USER:'   DL019-SIGN-ON-USR-ID          02480400
024805                 ' CREATE BY USER:' DL019-EAI-CRE-BY-USR-ID       02480500
024806                 ' PS-ERROR-SW:'    PS-ERROR-SW                   02480604
024807     END-IF.                                                      02480704
024808                                                                  02480804
024809                                                                  02480904
024810     PERFORM 1020-CHECK-DATA-EXISTS.                              02481004
024811                                                                  02481104
024820     IF  PS-ERROR                                                 02482000
024830         CONTINUE                                                 02483000
024840     ELSE                                                         02484000
024850         PERFORM 1080-CHECK-USER-IDS                              02485000
024860     END-IF.                                                      02486000
024870                                                                  02487000
024880                                                                  02488000
024890*-----------------------------------------------------------------02489000
024900*  THIS WILL VALIDATE THAT ALL OF THE REQUIRED FIELDS HAVE BEEN  *02490000
025000*  PASSED FROM THE CALLING PROGRAM                               *02500000
025100*-----------------------------------------------------------------02510000
025200 1020-CHECK-DATA-EXISTS.                                          02520000
025300                                                                  02530000
025400     IF KRPRPM-FUNC-TXT = 'Y'                                     02540000
025500         DISPLAY ' DLKUT410 START 1020- PARA '                    02550000
025510                 ' PS-ERROR-SW:'    PS-ERROR-SW                   02551004
025600     END-IF.                                                      02560000
025700                                                                  02570000
025800                                                                  02580000
025900     IF  DL019-VALID-PROCESS-CDE                                  02590000
026000         CONTINUE                                                 02600000
026100     ELSE                                                         02610000
026200         SET PS-ERROR TO TRUE                                     02620000
026300         SET DL019-PROCESS-CODE-INVALID TO TRUE                   02630000
026400     END-IF.                                                      02640000
026500                                                                  02650000
026600     IF  PS-ERROR                                                 02660000
026700         CONTINUE                                                 02670000
026800     ELSE                                                         02680000
026900         IF  DL019-VALID-COMMIT-CDE                               02690000
027000             CONTINUE                                             02700000
027100         ELSE                                                     02710000
027200             SET PS-ERROR TO TRUE                                 02720000
027300             SET DL019-COMMIT-CODE-INVALID TO TRUE                02730000
027400         END-IF                                                   02740000
027500     END-IF.                                                      02750000
027600                                                                  02760000
027700     IF  PS-ERROR                                                 02770000
027800         CONTINUE                                                 02780000
027900     ELSE                                                         02790000
028000         IF  DL019-NO-CALLING-PGM                                 02800000
028100             SET PS-ERROR TO TRUE                                 02810000
028200             SET DL019-MISSING-CALL-PROGRAM TO TRUE               02820000
028300         END-IF                                                   02830000
028400     END-IF.                                                      02840000
028500                                                                  02850000
028600     IF  PS-ERROR                                                 02860000
028700         CONTINUE                                                 02870000
028800     ELSE                                                         02880000
028900         IF  DL019-NO-SIGN-ON-USR                                 02890000
029000             SET PS-ERROR TO TRUE                                 02900000
029100             SET DL019-MISSING-SIGN-ON-USR TO TRUE                02910000
029200         END-IF                                                   02920000
029300     END-IF.                                                      02930000
029400                                                                  02940000
029500     IF  PS-ERROR                                                 02950000
029600         CONTINUE                                                 02960000
029700     ELSE                                                         02970000
029800         IF  DL019-NO-ASGMT-NBR-WRK-TYP                           02980000
029900             SET PS-ERROR TO TRUE                                 02990000
030000             SET DL019-MISSING-ASGMT-WRK-TYP TO TRUE              03000000
030100         END-IF                                                   03010000
030200     END-IF.                                                      03020000
030300                                                                  03030000
030400     IF  PS-ERROR                                                 03040000
030500         CONTINUE                                                 03050000
030600     ELSE                                                         03060000
030700         IF  DL019-ESTABLISH-ASGMT                                03070000
030800             PERFORM 1040-VALIDATE-EAI-FIELDS                     03080000
030900         ELSE                                                     03090000
031000             PERFORM 1060-VALIDATE-ETI-FIELDS                     03100000
031100         END-IF                                                   03110000
031200     END-IF.                                                      03120000
031300                                                                  03130000
031400                                                                  03140000
031500 1040-VALIDATE-EAI-FIELDS.                                        03150000
031600                                                                  03160000
031700     IF KRPRPM-FUNC-TXT = 'Y'                                     03170000
031800         DISPLAY ' DLKUT410 START 1040- PARA '                    03180000
031810                 ' PS-ERROR-SW:'    PS-ERROR-SW                   03181004
031900     END-IF.                                                      03190000
032000                                                                  03200000
032100                                                                  03210000
032200     IF  DL019-EAI-NO-WK-TYP                                      03220000
032300     OR  DL019-EAI-NO-WK-AREA                                     03230000
032400     OR  DL019-EAI-NO-DC-NBR                                      03240000
032500     OR  DL019-EAI-NO-CRE-USR                                     03250000
032600         SET PS-ERROR TO TRUE                                     03260000
032700         SET DL019-MISSING-EAI-FIELDS TO TRUE                     03270000
032800     ELSE                                                         03280000
032900         CONTINUE                                                 03290000
033000     END-IF.                                                      03300000
033100                                                                  03310000
033200     IF  PS-ERROR                                                 03320000
033300         CONTINUE                                                 03330000
033400     ELSE                                                         03340000
033500         IF  DL019-VALID-EAI-USR-TYP                              03350000
033600             CONTINUE                                             03360000
033700         ELSE                                                     03370000
033800             SET PS-ERROR TO TRUE                                 03380000
033900             SET DL019-MISSING-EAI-FIELDS TO TRUE                 03390000
034000         END-IF                                                   03400000
034100     END-IF.                                                      03410000
034200                                                                  03420000
034300                                                                  03430000
034400 1060-VALIDATE-ETI-FIELDS.                                        03440000
034500                                                                  03450000
034510     IF KRPRPM-FUNC-TXT = 'Y'                                     03451000
034520         DISPLAY ' DLKUT410 START 1060- PARA '                    03452000
034521                 ' PS-ERROR-SW:'    PS-ERROR-SW                   03452104
034530     END-IF.                                                      03453000
034540                                                                  03454000
034550                                                                  03455000
034560     IF  DL019-ETI-ASGMT-NO-STY                                   03456000
034570     OR  DL019-ETI-ASGMT-NO-STM                                   03457000
034580     OR  DL019-ETI-ASGMT-NO-STD                                   03458000
034590     OR  DL019-ETI-ASGMT-NO-NBR-TXT                               03459000
034600     OR  DL019-ETI-ASGMT-NO-SEQ-NBR                               03460000
034700     OR  DL019-ETI-NO-USR                                         03470000
034800         SET PS-ERROR TO TRUE                                     03480000
034900         SET DL019-MISSING-ETI-FIELDS TO TRUE                     03490000
035000     ELSE                                                         03500000
035100         CONTINUE                                                 03510000
035200     END-IF.                                                      03520000
035300                                                                  03530000
035400     IF  PS-ERROR                                                 03540000
035500         CONTINUE                                                 03550000
035600     ELSE                                                         03560000
035700         IF  DL019-VALID-ETI-USR-TYP                              03570000
035800             CONTINUE                                             03580000
035900         ELSE                                                     03590000
036000             SET PS-ERROR TO TRUE                                 03600000
036100             SET DL019-MISSING-ETI-FIELDS TO TRUE                 03610000
036200         END-IF                                                   03620000
036300     END-IF.                                                      03630000
036400                                                                  03640000
036500 1080-CHECK-USER-IDS.                                             03650000
036600                                                                  03660000
036700     IF KRPRPM-FUNC-TXT = 'Y'                                     03670000
036800         DISPLAY ' DLKUT410 START 1080- PARA '                    03680000
036810                 ' PS-ERROR-SW:'    PS-ERROR-SW                   03681004
036900     END-IF.                                                      03690000
037000                                                                  03700000
037100     IF  DL019-ESTABLISH-ASGMT                                    03710000
037200         MOVE DL019-EAI-CRE-BY-USR-ID TO                          03720000
037300              PV-HOLD-USR-ID                                      03730000
037400         IF  DL019-EAI-USR-IS-UNKNOWN                             03740000
037500                                                                  03750000
037600***          SET PS-NO-CALLED-MODULE-ERROR TO TRUE                03760000
037700***          SET PS-XLKUT067-CALLED-YES TO TRUE                   03770000
037800***          PERFORM 6000-CALL-XLKUT067                           03780000
037900                                                                  03790000
038000             MOVE  SPACE   TO  PS-USER-FOUND-SW                   03800000
038100             PERFORM 7100-CHECK-KOHLS-ASSOC                       03810000
038200             SET PS-USER-TABLES-CHECKED-YES  TO  TRUE             03820000
038300             MOVE PS-USER-FOUND-SW  TO  PV-HOLD-USR-TYP-CDE       03830000
038400                                                                  03840000
038500         ELSE                                                     03850000
038600             MOVE DL019-EAI-USR-TYP-CDE TO                        03860000
038700                  PV-HOLD-USR-TYP-CDE                             03870000
038800         END-IF                                                   03880000
038900     END-IF.                                                      03890000
039000                                                                  03900000
039100     IF  DL019-ESTABLISH-TEAM                                     03910000
039200         MOVE DL019-ETI-USR-ID TO                                 03920000
039300              PV-HOLD-USR-ID                                      03930000
039400         IF  DL019-ETI-USR-IS-UNKNOWN                             03940000
039500                                                                  03950000
039600***          SET PS-NO-CALLED-MODULE-ERROR TO TRUE                03960000
039700***          SET PS-XLKUT067-CALLED-YES TO TRUE                   03970000
039800***          PERFORM 6000-CALL-XLKUT067                           03980000
039900                                                                  03990000
040000             MOVE  SPACE   TO  PS-USER-FOUND-SW                   04000000
040100             PERFORM 7100-CHECK-KOHLS-ASSOC                       04010000
040200             SET PS-USER-TABLES-CHECKED-YES  TO  TRUE             04020000
040300             MOVE PS-USER-FOUND-SW  TO  PV-HOLD-USR-TYP-CDE       04030000
040400                                                                  04040000
040500         ELSE                                                     04050000
040600             MOVE DL019-ETI-USR-TYP-CDE TO                        04060000
040700                  PV-HOLD-USR-TYP-CDE                             04070000
040800         END-IF                                                   04080000
040900     END-IF.                                                      04090000
041000                                                                  04100000
041100     IF  PS-CALLED-MODULE-ERROR                                   04110000
041200         SET PS-ERROR TO TRUE                                     04120000
041300         MOVE 'DLKUT410' TO DL019-CALL-MOD-FAIL-NM                04130000
041400         SET DL019-CALLED-MODULE-FAILURE TO TRUE                  04140000
041500                                                                  04150000
041600***      MOVE 'XLKUT067' TO DL019-CALL-MOD-FAIL-NM                04160000
041700***      MOVE '1080'     TO DL019-CALL-MOD-FAIL-SQL-PARA          04170000
041800***      MOVE XL067-RETURN-CODE TO DL019-CALL-MOD-FAIL-ERR-CDE    04180000
041900***      IF  XL067-SQL-ERROR                                      04190000
042000***          PERFORM 1100-LOAD-XLKUT067-SQL-ERROR                 04200000
042100***      END-IF                                                   04210000
042200                                                                  04220000
042300     ELSE                                                         04230000
042400         IF  DL019-ESTABLISH-ASGMT                                04240000
042500             MOVE PV-HOLD-USR-TYP-CDE TO                          04250000
042600                  DL019-EAI-USR-TYP-CDE                           04260000
042700         ELSE                                                     04270000
042800             MOVE PV-HOLD-USR-TYP-CDE TO                          04280000
042900                  DL019-ETI-USR-TYP-CDE                           04290000
043000         END-IF                                                   04300000
043100     END-IF.                                                      04310000
043200                                                                  04320000
043300     IF PS-CALLED-MODULE-ERROR                                    04330000
043400         CONTINUE                                                 04340000
043500     ELSE                                                         04350000
043600         IF DL019-EAI-USR-IS-KOHLS                                04360000
043700             PERFORM 1081-CHECK-IF-NEW-USER                       04370000
043800         END-IF                                                   04380000
043900     END-IF.                                                      04390000
044000                                                                  04400000
044100 1081-CHECK-IF-NEW-USER.                                          04410000
044200                                                                  04420000
044210     IF KRPRPM-FUNC-TXT = 'Y'                                     04421000
044220         DISPLAY ' DLKUT410 START 1081- PARA '                    04422000
044221                 ' PS-ERROR-SW:'    PS-ERROR-SW                   04422104
044230     END-IF.                                                      04423000
044240                                                                  04424000
044250                                                                  04425000
044260     SET PS-CREATE-NEW-USER-YES       TO TRUE                     04426000
044270                                                                  04427000
044280*    IF  DL019-EAI-DC-NBR = 0                                     04428000
044290*        PERFORM DP026-0000-GET-LOGON-INFO                        04429000
044300*        MOVE DP026-LOCATION-NBR  TO PV-LOC-NBR                   04430000
044400*    ELSE                                                         04440000
044500*        MOVE DL019-EAI-DC-NBR    TO PV-LOC-NBR                   04450000
044600*    END-IF                                                       04460000
044700                                                                  04470000
044800     MOVE DL019-EAI-DC-NBR    TO PV-LOC-NBR.                      04480000
044900     PERFORM 7000-SELECT-RDPR-USR.                                04490000
045000                                                                  04500000
045100     IF DL019-SUCCESSFUL                                          04510000
045200       IF PS-CREATE-NEW-USER-YES                                  04520000
045300*        THE SWITCH COULD BE TURNED OFF IN PARA 7000              04530000
045400             INITIALIZE XL091-EAI-EXPORT-COMMAREA                 04540000
045500                                                                  04550000
045600         SET XL091-PC-APP-ID      TO TRUE                         04560000
045700         MOVE 'DC LABOR'          TO XL091-EVNT-OBJ-TXT           04570000
045800         MOVE 'ASSOCIATE ADD'     TO XL091-EVNT-OBJ-ACTN-TXT      04580000
045900         MOVE DL019-EAI-CRE-BY-USR-ID                             04590000
046000                                  TO XL091-CRE-BY-USR-ID          04600000
046100         MOVE 'DLKUT410'          TO XL091-CRE-PGM-NM             04610000
046200         MOVE 'N/A'               TO XL091-DTL-COPYBOOK-NM        04620000
046300                                                                  04630000
046400*        IF  DL019-EAI-DC-NBR = 0                                 04640000
046500*            PERFORM DP026-0000-GET-LOGON-INFO                    04650000
046600*            MOVE DP026-LOCATION-NBR  TO XL091-EVNT-KY-1-NBR      04660000
046700*        ELSE                                                     04670000
046800*            MOVE DL019-EAI-DC-NBR    TO XL091-EVNT-KY-1-NBR      04680000
046900*        END-IF                                                   04690000
047000                                                                  04700000
047100         MOVE DL019-EAI-DC-NBR    TO XL091-EVNT-KY-1-NBR          04710000
047200         MOVE PV-HOLD-USR-ID      TO XL091-EVNT-KY-1-TXT          04720000
047300                                                                  04730000
047400                                                                  04740000
047500***      IF  PS-XLKUT067-CALLED-YES                               04750000
047600         IF  PS-USER-TABLES-CHECKED-YES                           04760000
047700             MOVE PV-USR-LAST-NM      TO XL091-EVNT-KY-2-TXT      04770000
047800             MOVE PV-USR-FRST-NM      TO XL091-EVNT-KY-3-TXT      04780000
047900         ELSE                                                     04790000
048000             SET PS-NO-CALLED-MODULE-ERROR TO TRUE                04800000
048100             MOVE  SPACE   TO  PS-USER-FOUND-SW                   04810000
048200             PERFORM 7100-CHECK-KOHLS-ASSOC                       04820000
048300             SET PS-USER-TABLES-CHECKED-YES  TO  TRUE             04830000
048400             MOVE PS-USER-FOUND-SW  TO  PV-HOLD-USR-TYP-CDE       04840000
048500                                                                  04850000
048600***          PERFORM 6000-CALL-XLKUT067                           04860000
048700***          IF  PS-CALLED-MODULE-ERROR                           04870000
048800***              SET PS-ERROR TO TRUE                             04880000
048900***              MOVE 'XLKUT067' TO DL019-CALL-MOD-FAIL-NM        04890000
049000***              MOVE '1081'     TO DL019-CALL-MOD-FAIL-SQL-PARA  04900000
049100***              MOVE XL067-RETURN-CODE TO                        04910000
049200***                   DL019-CALL-MOD-FAIL-ERR-CDE                 04920000
049300***              SET DL019-CALLED-MODULE-FAILURE TO TRUE          04930000
049400***              IF  XL067-SQL-ERROR                              04940000
049500***                  PERFORM 1100-LOAD-XLKUT067-SQL-ERROR         04950000
049600***              END-IF                                           04960000
049700***              PERFORM 9000-RETURN-CALL                         04970000
049800***          ELSE                                                 04980000
049900***              MOVE PV-USR-LAST-NM      TO XL091-EVNT-KY-2-TXT  04990000
050000***              MOVE PV-USR-FRST-NM      TO XL091-EVNT-KY-3-TXT  05000000
050100***          END-IF                                               05010000
050200         END-IF                                                   05020000
050300                                                                  05030000
050400         SET XL091-COMMIT-UPDATE  TO TRUE                         05040000
050500         MOVE 'DLKUT410'          TO XL091-ORIG-CALLING-PGM-NM    05050000
050600                                                                  05060000
050700         PERFORM 6500-CALL-XLKUT107                               05070000
050800                                                                  05080000
050900         IF  PS-CALLED-MODULE-ERROR                               05090000
051000             SET PS-ERROR TO TRUE                                 05100000
051100             MOVE 'XLKUT107' TO DL019-CALL-MOD-FAIL-NM            05110000
051200             MOVE XL091-SQL-ERROR-PARA                            05120000
051300                             TO DL019-CALL-MOD-FAIL-SQL-PARA      05130000
051400             MOVE XL091-RETURN-CODE TO DL019-CALL-MOD-FAIL-ERR-CDE05140000
051500             SET DL019-CALLED-MODULE-FAILURE TO TRUE              05150000
051600             IF  XL091-SQL-ERROR                                  05160000
051700                 MOVE XL091-EAI-DB-SQLCODE TO                     05170000
051800                      DL019-CALL-MOD-FAIL-SQL-CDE                 05180000
051900                 MOVE XL091-SQL-ERROR-PARA TO                     05190000
052000                      DL019-CALL-MOD-FAIL-SQL-PARA                05200000
052100             END-IF                                               05210000
052200             PERFORM 9000-RETURN-CALL                             05220000
052300         END-IF                                                   05230000
052400                                                                  05240000
052500       END-IF                                                     05250000
052600     END-IF.                                                      05260000
052700                                                                  05270000
052800*1100-LOAD-XLKUT067-SQL-ERROR.                                    05280000
052900***                                                               05290000
053000***  IF  XL067-KOHLS-SQLCODE > 0                                  05300000
053100***      MOVE XL067-KOHLS-SQLCODE TO                              05310000
053200***           DL019-CALL-MOD-FAIL-SQL-CDE                         05320000
053300***      IF  XL067-KOHLS-NOT-FOUND                                05330000
053400***          MOVE XL067-KOHLS-NOT-FOUND-NBR TO                    05340000
053500***               DL019-CALL-MOD-FAIL-SQL-PARA                    05350000
053600***      ELSE                                                     05360000
053700***          IF  XL067-KOHLS-CONTENTION                           05370000
053800***              MOVE XL067-KOHLS-CONTENTION-NBR TO               05380000
053900***                   DL019-CALL-MOD-FAIL-SQL-PARA                05390000
054000***          ELSE                                                 05400000
054100***              MOVE XL067-KOHLS-ERROR-NBR TO                    05410000
054200***                   DL019-CALL-MOD-FAIL-SQL-PARA                05420000
054300***          END-IF                                               05430000
054400***      END-IF                                                   05440000
054500***  END-IF.                                                      05450000
054600***                                                               05460000
054700***  IF  XL067-TEMP-SQLCODE > 0                                   05470000
054800***      MOVE XL067-TEMP-SQLCODE TO                               05480000
054900***           DL019-CALL-MOD-FAIL-SQL-CDE                         05490000
055000***      IF  XL067-TEMP-NOT-FOUND                                 05500000
055100***          MOVE XL067-TEMP-NOT-FOUND-NBR TO                     05510000
055200***               DL019-CALL-MOD-FAIL-SQL-PARA                    05520000
055300***      ELSE                                                     05530000
055400***          IF  XL067-TEMP-CONTENTION                            05540000
055500***              MOVE XL067-TEMP-CONTENTION-NBR TO                05550000
055600***                   DL019-CALL-MOD-FAIL-SQL-PARA                05560000
055700***          ELSE                                                 05570000
055800***              MOVE XL067-TEMP-ERROR-NBR TO                     05580000
055900***                   DL019-CALL-MOD-FAIL-SQL-PARA                05590000
056000***          END-IF                                               05600000
056100***      END-IF                                                   05610000
056200***  END-IF.                                                      05620000
056300                                                                  05630000
056400*-----------------------------------------------------------------05640000
056500*  THIS WILL CONTROL THE PROCESS TO CREATE AN ASSIGNMENT IF      *05650000
056600*  NEEDED AND ALSO ATTACH THE ASSOCIATE TO AN ASSIGNMENT         *05660000
056700*-----------------------------------------------------------------05670000
056800 2000-ESTABLISH-ASGMT.                                            05680000
056900                                                                  05690000
057000     IF KRPRPM-FUNC-TXT = 'Y'                                     05700000
057100         DISPLAY ' DLKUT410 START 2000- PARA '                    05710000
057110                 ' PS-ERROR-SW:'    PS-ERROR-SW                   05711004
057200     END-IF.                                                      05720000
057300                                                                  05730000
057400                                                                  05740000
057500     PERFORM 2200-CHECK-FOR-ASGMT.                                05750000
057600                                                                  05760000
057700     PERFORM 2400-CHECK-FOR-USR-ON-ASGMT.                         05770000
057800                                                                  05780000
057900     IF  DL004-ASGMT-FOUND                                        05790000
058000     AND DL003-ASGMT-FOUND                                        05800000
058100         SET PS-ASGMTS-DO-NOT-MATCH  TO TRUE                      05810000
058200         PERFORM 2020-COMPARE-ASGMTS                              05820000
058300         IF  PS-ASGMTS-MATCH                                      05830000
058400             SET DL019-SUCCESSFUL             TO TRUE             05840000
058500             SET DL019-ESO-EXIST-ASGMT-FOUND  TO TRUE             05850000
058600             SET DL019-ESO-EMP-EXIST-ON-ASGMT TO TRUE             05860000
058700             MOVE DL003-ASGMT-START-DTE       TO                  05870000
058800                                      DL019-ESO-ASGMT-START-DTE   05880000
058900             MOVE DL003-ASGMT-NBR-TXT         TO                  05890000
059000                                      DL019-ESO-ASGMT-NBR-TXT     05900000
059100             MOVE DL003-ASGMT-NBR-SEQ-NBR     TO                  05910000
059200                                      DL019-ESO-ASGMT-NBR-SEQ-NBR 05920000
059300             PERFORM 9000-RETURN-CALL                             05930000
059400         ELSE                                                     05940000
059500             MOVE DL003-ASGMT-START-DTE       TO                  05950000
059600                                      PV-HOLD-ASGMT-START-DTE     05960000
059700             MOVE DL003-ASGMT-NBR-TXT         TO                  05970000
059800                                      PV-HOLD-ASGMT-NBR-TXT       05980000
059900             MOVE DL003-ASGMT-NBR-SEQ-NBR     TO                  05990000
060000                                      PV-HOLD-ASGMT-NBR-SEQ-NBR   06000000
060100             MOVE DL003-TEM-ASGMT-SEQ-NBR     TO                  06010000
060200                                      PV-HOLD-TEM-ASGMT-SEQ-NBR   06020000
060300             PERFORM 2600-END-FROM-ASGMT                          06030000
060400             IF  DL021-ASSOC-FOUND                                06040000
060500                 PERFORM 3200-GENERATE-S-MOVE                     06050000
060600             END-IF                                               06060000
060700             MOVE DL004-ASGMT-START-DTE       TO                  06070000
060800                                      PV-HOLD-ASGMT-START-DTE     06080000
060900             MOVE DL004-ASGMT-NBR-TXT         TO                  06090000
061000                                      PV-HOLD-ASGMT-NBR-TXT       06100000
061100             MOVE DL004-ASGMT-NBR-SEQ-NBR     TO                  06110000
061200                                      PV-HOLD-ASGMT-NBR-SEQ-NBR   06120000
061300             PERFORM 2800-ADD-TO-ASGMT                            06130000
061400             SET DL019-SUCCESSFUL             TO TRUE             06140000
061500             SET DL019-ESO-EXIST-ASGMT-FOUND  TO TRUE             06150000
061600             SET DL019-ESO-EMP-ENDADD-ASGMT   TO TRUE             06160000
061700             MOVE DL004-ASGMT-START-DTE       TO                  06170000
061800                                      DL019-ESO-ASGMT-START-DTE   06180000
061900             MOVE DL004-ASGMT-NBR-TXT         TO                  06190000
062000                                      DL019-ESO-ASGMT-NBR-TXT     06200000
062100             MOVE DL004-ASGMT-NBR-SEQ-NBR     TO                  06210000
062200                                      DL019-ESO-ASGMT-NBR-SEQ-NBR 06220000
062300             PERFORM 9000-RETURN-CALL                             06230000
062400         END-IF                                                   06240000
062500     ELSE                                                         06250000
062600         IF  DL004-ASGMT-FOUND                                    06260000
062700             MOVE DL004-ASGMT-START-DTE       TO                  06270000
062800                                      PV-HOLD-ASGMT-START-DTE     06280000
062900             MOVE DL004-ASGMT-NBR-TXT         TO                  06290000
063000                                      PV-HOLD-ASGMT-NBR-TXT       06300000
063100             MOVE DL004-ASGMT-NBR-SEQ-NBR     TO                  06310000
063200                                      PV-HOLD-ASGMT-NBR-SEQ-NBR   06320000
063300             PERFORM 2800-ADD-TO-ASGMT                            06330000
063400             SET DL019-SUCCESSFUL             TO TRUE             06340000
063500             SET DL019-ESO-EXIST-ASGMT-FOUND  TO TRUE             06350000
063600             SET DL019-ESO-EMP-NEW-TO-ASGMT   TO TRUE             06360000
063700             MOVE DL004-ASGMT-START-DTE       TO                  06370000
063800                                      DL019-ESO-ASGMT-START-DTE   06380000
063900             MOVE DL004-ASGMT-NBR-TXT         TO                  06390000
064000                                      DL019-ESO-ASGMT-NBR-TXT     06400000
064100             MOVE DL004-ASGMT-NBR-SEQ-NBR     TO                  06410000
064200                                      DL019-ESO-ASGMT-NBR-SEQ-NBR 06420000
064300             PERFORM 9000-RETURN-CALL                             06430000
064400         ELSE                                                     06440000
064500             IF  DL003-ASGMT-FOUND                                06450000
064600                 MOVE DL003-ASGMT-START-DTE   TO                  06460000
064700                                      PV-HOLD-ASGMT-START-DTE     06470000
064800                 MOVE DL003-ASGMT-NBR-TXT     TO                  06480000
064900                                      PV-HOLD-ASGMT-NBR-TXT       06490000
065000                 MOVE DL003-ASGMT-NBR-SEQ-NBR TO                  06500000
065100                                      PV-HOLD-ASGMT-NBR-SEQ-NBR   06510000
065200                 MOVE DL003-TEM-ASGMT-SEQ-NBR TO                  06520000
065300                                      PV-HOLD-TEM-ASGMT-SEQ-NBR   06530000
065400                 PERFORM 2600-END-FROM-ASGMT                      06540000
065500                 IF  DL021-ASSOC-FOUND                            06550000
065600                     PERFORM 3200-GENERATE-S-MOVE                 06560000
065700                 END-IF                                           06570000
065800                 PERFORM 3000-CREATE-NEW-ASGMT                    06580000
065900                 SET DL019-SUCCESSFUL           TO TRUE           06590000
066000                 SET DL019-ESO-NEW-ASGMT-CREATE TO TRUE           06600000
066100                 SET DL019-ESO-EMP-ENDADD-ASGMT TO TRUE           06610000
066200                 MOVE DL022-NEW-START-DTE       TO                06620000
066300                                      DL019-ESO-ASGMT-START-DTE   06630000
066400                 MOVE DL022-NEW-NBR-TXT         TO                06640000
066500                                      DL019-ESO-ASGMT-NBR-TXT     06650000
066600                 MOVE DL022-NEW-ASGMT-NBR-SEQ-NBR TO              06660000
066700                                      DL019-ESO-ASGMT-NBR-SEQ-NBR 06670000
066800                 PERFORM 9000-RETURN-CALL                         06680000
066900             ELSE                                                 06690000
067000                 PERFORM 3000-CREATE-NEW-ASGMT                    06700000
067100                 SET DL019-SUCCESSFUL           TO TRUE           06710000
067200                 SET DL019-ESO-NEW-ASGMT-CREATE TO TRUE           06720000
067300                 SET DL019-ESO-EMP-NEW-TO-ASGMT TO TRUE           06730000
067400                 MOVE DL022-NEW-START-DTE       TO                06740000
067500                                      DL019-ESO-ASGMT-START-DTE   06750000
067600                 MOVE DL022-NEW-NBR-TXT         TO                06760000
067700                                      DL019-ESO-ASGMT-NBR-TXT     06770000
067800                 MOVE DL022-NEW-ASGMT-NBR-SEQ-NBR TO              06780000
067900                                      DL019-ESO-ASGMT-NBR-SEQ-NBR 06790000
068000                 PERFORM 9000-RETURN-CALL                         06800000
068100             END-IF                                               06810000
068200         END-IF                                                   06820000
068300     END-IF.                                                      06830000
068400                                                                  06840000
068500                                                                  06850000
068600 2020-COMPARE-ASGMTS.                                             06860000
068610                                                                  06861000
068620     IF KRPRPM-FUNC-TXT = 'Y'                                     06862000
068630         DISPLAY ' DLKUT410 START 2020- PARA '                    06863000
068631                 ' PS-ERROR-SW:'    PS-ERROR-SW                   06863104
068640     END-IF.                                                      06864000
068650                                                                  06865000
068660                                                                  06866000
068670     IF  (DL003-ASGMT-START-DTE IS EQUAL TO                       06867000
068680          DL004-ASGMT-START-DTE)                                  06868000
068690     AND (DL003-ASGMT-NBR-TXT IS EQUAL TO                         06869000
068700          DL004-ASGMT-NBR-TXT)                                    06870000
068800     AND (DL003-ASGMT-NBR-SEQ-NBR IS EQUAL TO                     06880000
068900          DL004-ASGMT-NBR-SEQ-NBR)                                06890000
069000          SET PS-ASGMTS-MATCH TO TRUE                             06900000
069100     END-IF.                                                      06910000
069200                                                                  06920000
069300* THE FOLLOWING IS TO PROCES THE CALL TO DLKUT002                 06930000
069400 2200-CHECK-FOR-ASGMT.                                            06940000
069500                                                                  06950000
069600     IF KRPRPM-FUNC-TXT = 'Y'                                     06960000
069700         DISPLAY ' DLKUT410 START 2200- PARA '                    06970000
069710                 ' PS-ERROR-SW:'    PS-ERROR-SW                   06971004
069800     END-IF.                                                      06980000
069810                                                                  06981000
069820                                                                  06982000
069821*                                                                 06982103
069822*** REPLACE INITIALIZE WITH MOVE STATEMENTS                       06982203
069824*                                                                 06982403
069830*    INITIALIZE  DL004-ASGMT-COMMAREA.                            06983003
069831                                                                  06983106
069832     MOVE SPACES  TO  DL004-ACCESS-METHOD                         06983206
069836                      DL004-KEY-WK-TYP                            06983606
069838                      DL004-KEY-WK-AREA                           06983807
069839                      DL004-RETURN-CODE                           06983906
069840                      DL004-ORIG-CALLING-PGM-NM                   06984006
069841                      DL004-SQL-ERROR-PARA                        06984106
069842                      DL004-CALL-MOD-FAIL-NM                      06984206
069843                      DL004-CALL-MOD-FAIL-ERR-CDE                 06984306
069844                      DL004-ASGMT-FOUND-CODE                      06984406
069845                      DL004-ASGMT-START-DTE                       06984506
069846                      DL004-ASGMT-NBR-TXT                         06984606
069847                      DL004-ASGMT-STRT-TM                         06984706
069848                      DL004-ASGMT-CRE-BY-PGM-NM                   06984806
069849                      DL004-ASGMT-CRE-BY-USR-ID                   06984906
069850                      DL004-SQLCA                                 06985006
069851                      DL004-COMMAREA.                             06985106
069852                                                                  06985206
069853     MOVE ZEROES  TO  DL004-KEY-DC-NBR                            06985306
069854                      DL004-ASGMT-SQLCODE                         06985406
069860                      DL004-ASGMT-FOUND-QTY                       06986006
069861                      DL004-ASGMT-NBR-SEQ-NBR                     06986106
069862                      DL004-ASGMT-LAST-USD-SEQ-NBR                06986206
069863                      DL004-ASGMT-ACTV-USR-QTY.                   06986306
069864                                                                  06986406
069902     MOVE DL019-CALLING-PGM-NM        TO                          06990200
069903                                      DL004-ORIG-CALLING-PGM-NM.  06990300
069904                                                                  06990400
069905     MOVE DL019-ASGMT-NBR-WRK-TYP     TO DL004-KEY-WK-TYP         06990500
069906     MOVE DL019-EAI-WK-AREA-DESC      TO DL004-KEY-WK-AREA        06990600
069910     MOVE DL019-EAI-DC-NBR            TO DL004-KEY-DC-NBR         06991000
070000                                                                  07000000
070100     SET DL004-BY-WK-TYP-AREA-KEY     TO TRUE.                    07010000
070200     SET PS-NO-CALLED-MODULE-ERROR    TO TRUE.                    07020000
070300                                                                  07030000
070350                                                                  07035000
070400     PERFORM 6100-CALL-DLKUT002.                                  07040000
070401                                                                  07040102
070410     MOVE DL004-ASGMT-NBR-SEQ-NBR  TO  PV-DISP-ASGMT-SEQ          07041002
070430     IF KRPRPM-FUNC-TXT = 'Y'                                     07043002
070440         DISPLAY 'ASGMT-SEQ:  ' PV-DISP-ASGMT-SEQ                 07044002
070450         DISPLAY ' PS-ERROR-SW:'    PS-ERROR-SW                   07045004
070460     END-IF.                                                      07046002
070470                                                                  07047002
070500                                                                  07050000
070600     IF  PS-CALLED-MODULE-ERROR                                   07060000
070700         SET PS-ERROR TO TRUE                                     07070000
070800         MOVE 'DLKUT002' TO DL019-CALL-MOD-FAIL-NM                07080000
070900         MOVE DL004-SQL-ERROR-PARA                                07090000
071000                                TO DL019-CALL-MOD-FAIL-SQL-PARA   07100000
071100         MOVE DL004-RETURN-CODE TO DL019-CALL-MOD-FAIL-ERR-CDE    07110000
071200         SET DL019-CALLED-MODULE-FAILURE TO TRUE                  07120000
071300         IF  DL004-SQL-ERROR                                      07130000
071400             MOVE DL004-ASGMT-SQLCODE TO                          07140000
071500                  DL019-CALL-MOD-FAIL-SQL-CDE                     07150000
071600             MOVE DL004-SQL-ERROR-PARA TO                         07160000
071700                  DL019-CALL-MOD-FAIL-SQL-PARA                    07170000
071800         END-IF                                                   07180000
071900         PERFORM 9000-RETURN-CALL                                 07190000
072000     ELSE                                                         07200000
072100                                                                  07210000
072200*** DMH - 10/27/2009 - BEGIN                                      07220000
072300         IF  DL004-ASGMT-MULT-FOUND                               07230000
072400             PERFORM 4500-CALL-DLKUT031                           07240000
072500         END-IF                                                   07250000
072600*** DMH - 10/27/2009 - END                                        07260000
072700                                                                  07270000
072800     END-IF.                                                      07280000
072900                                                                  07290000
073000     IF  DL004-ASGMT-NOT-FOUND                                    07300000
073100         SET PS-CREATE-NEW-ASGMT TO TRUE                          07310000
073200     END-IF.                                                      07320000
073300                                                                  07330000
073400                                                                  07340000
073500* THE FOLLOWING IS TO PROCES THE CALL TO DLKUT001                 07350000
073600 2400-CHECK-FOR-USR-ON-ASGMT.                                     07360002
073700                                                                  07370000
073800     IF KRPRPM-FUNC-TXT = 'Y'                                     07380000
073900         DISPLAY ' DLKUT410 START 2400- PARA '                    07390000
073910                 ' PS-ERROR-SW:'    PS-ERROR-SW                   07391004
074000     END-IF.                                                      07400000
074100                                                                  07410000
074200                                                                  07420000
074300     INITIALIZE  DL003-ASGMT-COMMAREA.                            07430000
074400                                                                  07440000
074500     MOVE PV-HOLD-USR-ID           TO DL003-KEY-USER-ID.          07450000
074600     MOVE DL019-CALLING-PGM-NM     TO DL003-ORIG-CALLING-PGM-NM.  07460000
074700                                                                  07470000
074800     SET DL003-BY-USER-KEY         TO TRUE.                       07480000
074900     SET PS-NO-CALLED-MODULE-ERROR TO TRUE.                       07490000
075000                                                                  07500000
075100     PERFORM 6200-CALL-DLKUT001.                                  07510000
075200                                                                  07520000
075201                                                                  07520102
075210     IF KRPRPM-FUNC-TXT = 'Y'                                     07521002
075220         DISPLAY DL003-ASGMT-COMMAREA                             07522002
075221         DISPLAY ' PS-ERROR-SW:'    PS-ERROR-SW                   07522104
075230     END-IF.                                                      07523002
075240                                                                  07524002
075241     MOVE DL003-ASGMT-NBR-SEQ-NBR  TO  PV-DISP-ASGMT-SEQ          07524102
075242     MOVE DL003-TEM-ASGMT-SEQ-NBR  TO  PV-DISP-TEM-SEQ            07524202
075243     IF KRPRPM-FUNC-TXT = 'Y'                                     07524302
075244         DISPLAY 'ASGMT-SEQ:  ' PV-DISP-ASGMT-SEQ                 07524402
075245         DISPLAY 'TEAM-SEQ:   ' PV-DISP-TEM-SEQ                   07524502
075246         DISPLAY ' PS-ERROR-SW:'    PS-ERROR-SW                   07524604
075247     END-IF.                                                      07524702
075248                                                                  07524802
075250                                                                  07525002
075300     IF  PS-CALLED-MODULE-ERROR                                   07530000
075400         SET PS-ERROR TO TRUE                                     07540000
075500         MOVE 'DLKUT001' TO DL019-CALL-MOD-FAIL-NM                07550000
075600         MOVE DL003-SQL-ERROR-PARA                                07560000
075700                                TO DL019-CALL-MOD-FAIL-SQL-PARA   07570000
075800         MOVE DL003-RETURN-CODE TO DL019-CALL-MOD-FAIL-ERR-CDE    07580000
075900         SET DL019-CALLED-MODULE-FAILURE TO TRUE                  07590000
076000         IF  DL003-SQL-ERROR                                      07600000
076100             MOVE DL003-ASGMT-SQLCODE TO                          07610000
076200                  DL019-CALL-MOD-FAIL-SQL-CDE                     07620000
076300             MOVE DL003-SQL-ERROR-PARA TO                         07630000
076400                  DL019-CALL-MOD-FAIL-SQL-PARA                    07640000
076500         END-IF                                                   07650000
076600         PERFORM 9000-RETURN-CALL                                 07660000
076700     ELSE                                                         07670000
076800         IF  DL003-ASGMT-MULT-FOUND                               07680000
076900             SET PS-ERROR TO TRUE                                 07690000
077000             MOVE 'DLKUT001' TO DL019-CALL-MOD-FAIL-NM            07700000
077100             MOVE DL003-SQL-ERROR-PARA                            07710000
077200                                TO DL019-CALL-MOD-FAIL-SQL-PARA   07720000
077300             MOVE DL003-RETURN-CODE TO                            07730000
077400                  DL019-CALL-MOD-FAIL-ERR-CDE                     07740000
077500             SET DL019-CALLED-MODULE-FAILURE TO TRUE              07750000
077600             MOVE SPACES TO PV-MSG-AREA2                          07760000
077700             STRING ' DLKUT410 - '           DELIMITED BY SIZE    07770000
077800                    'CALLED MODULE SUCCESS'  DELIMITED BY SIZE    07780000
077900                                           INTO PV-MSG-AREA2      07790000
078000             PERFORM 9200-WRITE-TO-LOG                            07800000
078100             MOVE SPACES TO PV-MSG-AREA2                          07810000
078200             MOVE '6200-CALL-DLKUT001' TO PV-MODULE-PARAGRAPH     07820000
078300             STRING ' DLKUT410 - '           DELIMITED BY SIZE    07830000
078400                    PV-MODULE-FAIL-MSG       DELIMITED BY SIZE    07840000
078500                    ' WITH RETURN CODE - '   DELIMITED BY SIZE    07850000
078600                    DL003-RETURN-CODE        DELIMITED BY SIZE    07860000
078700                    ' BUT HAD MULT ASGMTS'   DELIMITED BY SIZE    07870000
078800                                           INTO PV-MSG-AREA2      07880000
078900             PERFORM 9200-WRITE-TO-LOG                            07890000
079000             MOVE SPACES TO PV-MSG-AREA2                          07900000
079100             MOVE DL003-ASGMT-FOUND-QTY TO                        07910000
079200                  PV-DISPLAY-QTY-5                                07920000
079300             STRING ' DLKUT410 - '           DELIMITED BY SIZE    07930000
079400                    'HAD MULT ASGMT FOR '    DELIMITED BY SIZE    07940000
079500                    'USER ID '               DELIMITED BY SIZE    07950000
079600                    DL003-KEY-USER-ID        DELIMITED BY SIZE    07960000
079700                    ' NBR ASGMTS FOUND IS '  DELIMITED BY SIZE    07970000
079800                    PV-DISPLAY-QTY-5         DELIMITED BY SIZE    07980000
079900                                           INTO PV-MSG-AREA2      07990000
080000             PERFORM 9200-WRITE-TO-LOG                            08000000
080100             PERFORM 9000-RETURN-CALL                             08010000
080200         END-IF                                                   08020000
080300     END-IF.                                                      08030000
080400                                                                  08040000
080500* THE FOLLOWING IS TO PROCESS THE CALL TO DLKUP025 TO             08050000
080600* END ASSOCIATE FROM AN ASSIGNMENT                                08060000
080700 2600-END-FROM-ASGMT.                                             08070000
080800                                                                  08080000
080900     IF KRPRPM-FUNC-TXT = 'Y'                                     08090000
081000         DISPLAY ' DLKUT410 START 2600- PARA '                    08100000
081010                 ' PS-ERROR-SW:'    PS-ERROR-SW                   08101004
081100     END-IF.                                                      08110000
081200                                                                  08120000
081300                                                                  08130000
081400     INITIALIZE DL021-ASGMT-COMMAREA.                             08140000
081500                                                                  08150000
081600     MOVE PV-HOLD-ASGMT-START-DTE TO DL021-KEY-START-DTE.         08160000
081700     MOVE PV-HOLD-ASGMT-NBR-TXT TO DL021-KEY-NBR-TXT.             08170000
081800     MOVE PV-HOLD-ASGMT-NBR-SEQ-NBR TO DL021-KEY-NBR-SEQ-NBR.     08180000
081900     MOVE PV-HOLD-TEM-ASGMT-SEQ-NBR TO                            08190000
082000                            DL021-KEY-TEM-ASGMT-SEQ-NBR.          08200000
082100     MOVE PV-HOLD-USR-ID TO DL021-KEY-ADD-BY-USER-ID              08210000
082200                            DL021-KEY-USER-ID.                    08220000
082300     MOVE PV-HOLD-USR-TYP-CDE TO DL021-KEY-USR-TYPE-CDE.          08230000
082400     MOVE PC-CURRENT-PROGRAM-NAME TO DL021-KEY-LVE-PGM-NM.        08240000
082500     MOVE DL019-CALLING-PGM-NM TO DL021-ORIG-CALLING-PGM-NM.      08250000
082600                                                                  08260000
082700     SET DL021-BY-ASGMT-NBR TO TRUE.                              08270000
082800     SET DL021-END-FROM-ASGMT TO TRUE.                            08280000
082900     SET DL021-COMMIT-UPDATE TO TRUE.                             08290000
083000     SET DL021-KEY-LVE-RSN-SMOVE TO TRUE.                         08300000
083100     SET PS-NO-CALLED-MODULE-ERROR TO TRUE.                       08310000
083200     MOVE ' END ' TO PV-DISPLAY-TEXT.                             08320000
083300                                                                  08330000
083400     PERFORM 6300-CALL-DLKUP025.                                  08340000
083500                                                                  08350000
083600     IF  PS-CALLED-MODULE-ERROR                                   08360000
083700         SET PS-ERROR TO TRUE                                     08370000
083800         MOVE 'DLKUP025' TO DL019-CALL-MOD-FAIL-NM                08380000
083900         MOVE DL021-SQL-ERROR-PARA                                08390000
084000                                TO DL019-CALL-MOD-FAIL-SQL-PARA   08400000
084100         MOVE DL021-RETURN-CODE TO DL019-CALL-MOD-FAIL-ERR-CDE    08410000
084200         SET DL019-CALLED-MODULE-FAILURE TO TRUE                  08420000
084300         IF  DL021-SQL-ERROR                                      08430000
084400             MOVE DL021-ASGMT-SQLCODE TO                          08440000
084500                  DL019-CALL-MOD-FAIL-SQL-CDE                     08450000
084600             MOVE DL021-SQL-ERROR-PARA TO                         08460000
084700                  DL019-CALL-MOD-FAIL-SQL-PARA                    08470000
084800         END-IF                                                   08480000
084900         PERFORM 9000-RETURN-CALL                                 08490000
085000     END-IF.                                                      08500000
085100                                                                  08510000
085200                                                                  08520000
085300* THE FOLLOWING IS TO PROCESS THE CALL TO DLKUP025 TO             08530000
085400* ADD ASSOCIATE TO AN ASSIGNMENT                                  08540000
085500 2800-ADD-TO-ASGMT.                                               08550000
085600                                                                  08560000
085700     IF KRPRPM-FUNC-TXT = 'Y'                                     08570000
085800         DISPLAY ' DLKUT410 START 2800- PARA '                    08580000
085810                 ' PS-ERROR-SW:'    PS-ERROR-SW                   08581004
085900     END-IF.                                                      08590000
086000                                                                  08600000
086100                                                                  08610000
086200     INITIALIZE DL021-ASGMT-COMMAREA.                             08620000
086300                                                                  08630000
086400     MOVE PV-HOLD-ASGMT-START-DTE TO DL021-KEY-START-DTE.         08640000
086500     MOVE PV-HOLD-ASGMT-NBR-TXT TO DL021-KEY-NBR-TXT.             08650000
086600     MOVE PV-HOLD-ASGMT-NBR-SEQ-NBR TO DL021-KEY-NBR-SEQ-NBR.     08660000
086700     MOVE PV-HOLD-USR-ID TO DL021-KEY-ADD-BY-USER-ID              08670000
086800                            DL021-KEY-USER-ID.                    08680000
086900     MOVE PV-HOLD-USR-TYP-CDE TO DL021-KEY-USR-TYPE-CDE.          08690000
087000     MOVE PC-CURRENT-PROGRAM-NAME TO DL021-KEY-LVE-PGM-NM.        08700000
087100     MOVE DL019-CALLING-PGM-NM TO                                 08710000
087200          DL021-ORIG-CALLING-PGM-NM.                              08720000
087300                                                                  08730000
087400     SET DL021-BY-ASGMT-NBR TO TRUE.                              08740000
087500     SET DL021-ADD-TO-ASGMT TO TRUE.                              08750000
087600     SET DL021-COMMIT-UPDATE TO TRUE.                             08760000
087700     SET PS-NO-CALLED-MODULE-ERROR TO TRUE.                       08770000
087800     MOVE ' ADD ' TO PV-DISPLAY-TEXT.                             08780000
087900                                                                  08790000
088000     PERFORM 6300-CALL-DLKUP025.                                  08800000
088100                                                                  08810000
088200     IF  PS-CALLED-MODULE-ERROR                                   08820000
088300         SET PS-ERROR TO TRUE                                     08830000
088400         MOVE 'DLKUP025' TO DL019-CALL-MOD-FAIL-NM                08840000
088500         MOVE DL021-SQL-ERROR-PARA                                08850000
088600                                TO DL019-CALL-MOD-FAIL-SQL-PARA   08860000
088700         MOVE DL021-RETURN-CODE TO DL019-CALL-MOD-FAIL-ERR-CDE    08870000
088800         SET DL019-CALLED-MODULE-FAILURE TO TRUE                  08880000
088900         IF  DL021-SQL-ERROR                                      08890000
089000             MOVE DL021-ASGMT-SQLCODE TO                          08900000
089100                  DL019-CALL-MOD-FAIL-SQL-CDE                     08910000
089200             MOVE DL021-SQL-ERROR-PARA TO                         08920000
089300                  DL019-CALL-MOD-FAIL-SQL-PARA                    08930000
089400         END-IF                                                   08940000
089500         PERFORM 9000-RETURN-CALL                                 08950000
089600     END-IF.                                                      08960000
089700                                                                  08970000
089800* THE FOLLOWING IS TO PROCESS THE CALL TO DLKUP026 TO             08980000
089900* CREATE A NEW ASSIGNMENT                                         08990000
090000 3000-CREATE-NEW-ASGMT.                                           09000000
090100                                                                  09010000
090200     IF KRPRPM-FUNC-TXT = 'Y'                                     09020000
090300         DISPLAY ' DLKUT410 START 3000- PARA '                    09030000
090310                 ' PS-ERROR-SW:'    PS-ERROR-SW                   09031004
090400     END-IF.                                                      09040000
090500                                                                  09050000
090600                                                                  09060000
090700     PERFORM 3020-GET-DATE-TIME.                                  09070000
090800                                                                  09080000
090900     MOVE PV-LABOR-CURRENT-DATE TO                                09090000
091000          DL022-NA-FLD-START-DTE.                                 09100000
091100     MOVE PV-LABOR-CURRENT-TIME TO                                09110000
091200          DL022-NA-FLD-START-TM.                                  09120000
091300     MOVE DL019-EAI-DC-NBR TO                                     09130000
091400          DL011-KEY-ASGMT-NBR-DC                                  09140000
091500          DL022-NA-FLD-DC-NBR.                                    09150000
091600     MOVE DL019-ASGMT-NBR-WRK-TYP TO                              09160000
091700          DL011-KEY-ASGMT-NBR-WRK-TYP.                            09170000
091800     MOVE DL011-KEY-ASGMT-NBR-TXT TO                              09180000
091900          DL022-NA-FLD-NBR-TXT.                                   09190000
092000     MOVE PV-HOLD-USR-ID TO                                       09200000
092100          DL022-NA-FLD-CRE-BY-USR-ID.                             09210000
092200     MOVE PV-HOLD-USR-TYP-CDE TO                                  09220000
092300          DL022-NA-FLD-USR-TYP-CDE.                               09230000
092400     MOVE DL019-CALLING-PGM-NM TO                                 09240000
092500          DL022-ORIG-CALLING-PGM-NM                               09250000
092600          DL022-NA-FLD-CRE-PGM-NM.                                09260000
092700     MOVE DL019-EAI-WK-TYP-DESC TO                                09270000
092800          DL022-NA-FLD-WK-TYP-DESC.                               09280000
092900     MOVE DL019-EAI-WK-AREA-DESC TO                               09290000
093000          DL022-NA-FLD-WK-AREA-DESC.                              09300000
093100                                                                  09310000
093200     SET DL022-CREATE-NEW-ASGMT-WTEAM TO TRUE.                    09320000
093300     SET DL022-COMMIT-UPDATE TO TRUE.                             09330000
093400     SET DL022-NO-LOG-TO-EAI-EXPORT TO TRUE.                      09340000
093500                                                                  09350000
093600     PERFORM 6400-CALL-DLKUP026.                                  09360000
093700                                                                  09370000
093800     IF  PS-CALLED-MODULE-ERROR                                   09380000
093900         SET PS-ERROR TO TRUE                                     09390000
094000         MOVE 'DLKUP026' TO DL019-CALL-MOD-FAIL-NM                09400000
094100         MOVE DL022-SQL-ERROR-PARA                                09410000
094200                                TO DL019-CALL-MOD-FAIL-SQL-PARA   09420000
094300         MOVE DL022-RETURN-CODE TO DL019-CALL-MOD-FAIL-ERR-CDE    09430000
094400         MOVE DL022-SQLCA       TO DL019-SQLCA                    09440000
094500         SET DL019-CALLED-MODULE-FAILURE TO TRUE                  09450000
094600         IF  DL022-SQL-ERROR                                      09460000
094700             MOVE DL022-ASGMT-SQLCODE TO                          09470000
094800                  DL019-CALL-MOD-FAIL-SQL-CDE                     09480000
094900             MOVE DL022-SQL-ERROR-PARA TO                         09490000
095000                  DL019-CALL-MOD-FAIL-SQL-PARA                    09500000
095100         END-IF                                                   09510000
095200         PERFORM 9000-RETURN-CALL                                 09520000
095300     END-IF.                                                      09530000
095400                                                                  09540000
095500                                                                  09550000
095600 3020-GET-DATE-TIME.                                              09560000
095700                                                                  09570000
095800     IF KRPRPM-FUNC-TXT = 'Y'                                     09580000
095900         DISPLAY ' DLKUT410 START 3020- PARA '                    09590000
095910                 ' PS-ERROR-SW:'    PS-ERROR-SW                   09591004
096000     END-IF.                                                      09600000
096100                                                                  09610000
096200                                                                  09620000
096300     EXEC SQL                                                     09630000
096400          SET  :PV-LABOR-CURRENT-DATE  =  CURRENT_DATE            09640000
096500              ,:PV-LABOR-CURRENT-TIME  =  CURRENT_TIME            09650000
096600     END-EXEC.                                                    09660000
096700                                                                  09670000
096800                                                                  09680000
096900* THE FOLLOWING IS TO PROCESS THE CALL TO XLKUT107 TO LOG AN      09690000
097000* INDIRECT CODE OF AN S (SYSTEM) MOVE FOR THE ASSOCIATE           09700000
097100 3200-GENERATE-S-MOVE.                                            09710000
097200                                                                  09720000
097300     IF KRPRPM-FUNC-TXT = 'Y'                                     09730000
097400         DISPLAY ' DLKUT410 START 3200- PARA '                    09740000
097410                 ' PS-ERROR-SW:'    PS-ERROR-SW                   09741004
097500     END-IF.                                                      09750000
097600                                                                  09760000
097700                                                                  09770000
097800     INITIALIZE XL091-EAI-EXPORT-COMMAREA.                        09780000
097900                                                                  09790000
098000     SET XL091-PC-APP-ID                                          09800000
098100         XL091-COMMIT-UPDATE TO TRUE.                             09810000
098200                                                                  09820000
098300     MOVE PC-CURRENT-PROGRAM-NAME TO XL091-CRE-PGM-NM.            09830000
098400                                                                  09840000
098500     MOVE ZEROES                  TO XL091-EVNT-KY-1-NBR          09850000
098600                                     XL091-EVNT-KY-2-NBR          09860000
098700                                     XL091-EVNT-KY-3-NBR          09870000
098800                                     XL091-EVNT-KY-4-NBR          09880000
098900                                     XL091-EVNT-KY-5-NBR.         09890000
099000                                                                  09900000
099100     MOVE SPACES                  TO XL091-EVNT-KY-1-TXT          09910000
099200                                     XL091-EVNT-KY-2-TXT          09920000
099300                                     XL091-EVNT-KY-3-TXT          09930000
099400                                     XL091-EVNT-KY-4-TXT          09940000
099500                                     XL091-EVNT-KY-5-TXT          09950000
099600                                     XL091-EVNT-KY-1-TMST         09960000
099700                                     XL091-EVNT-KY-2-TMST         09970000
099800                                     XL091-EVNT-KY-3-TMST         09980000
099900                                     XL091-EVNT-KY-4-TMST         09990000
100000                                     XL091-EVNT-KY-5-TMST.        10000000
100100                                                                  10010000
100200     MOVE 'DC LABOR'          TO XL091-EVNT-OBJ-TXT.              10020000
100300     MOVE 'INDIRECT LABOR'    TO XL091-EVNT-OBJ-ACTN-TXT.         10030000
100400     MOVE PV-HOLD-USR-ID      TO XL091-CRE-BY-USR-ID.             10040000
100500     MOVE DL019-EAI-DC-NBR    TO XL091-EVNT-KY-1-NBR.             10050000
100600***  MOVE 'SMOVE'             TO XL091-EVNT-KY-1-TXT.             10060000
100700     IF DL003-ASGMT-WK-TYP-DESC = 'RECV'                          10070000
100800         MOVE 'SRMOVE'                TO XL091-EVNT-KY-1-TXT      10080000
100900     END-IF.                                                      10090000
101000     IF DL003-ASGMT-WK-TYP-DESC = 'SHIP'                          10100000
101100         MOVE 'SSMOVE'                TO XL091-EVNT-KY-1-TXT      10110000
101200     END-IF.                                                      10120000
101300     IF DL003-ASGMT-WK-TYP-DESC = 'P2L'                           10130000
101400         MOVE 'SPMOVE'                TO XL091-EVNT-KY-1-TXT      10140000
101500     END-IF.                                                      10150000
101600     IF DL003-ASGMT-WK-TYP-DESC = 'FLAT'                          10160000
101700         MOVE 'SFMOVE'                TO XL091-EVNT-KY-1-TXT      10170000
101800     END-IF.                                                      10180000
101900     IF DL003-ASGMT-WK-TYP-DESC = 'RLABL'                         10190000
102000         MOVE 'SLMOVE'                TO XL091-EVNT-KY-1-TXT      10200000
102100     END-IF.                                                      10210000
102200     IF DL003-ASGMT-WK-TYP-DESC = 'MASTCON'                       10220000
102300         MOVE 'SMMOVE'                TO XL091-EVNT-KY-1-TXT      10230000
102400     END-IF.                                                      10240000
102500     MOVE DL021-ASSOC-TMST    TO PV-HOLD-TIMESTAMP.               10250000
102600     PERFORM 3220-GET-TIMESTAMP.                                  10260000
102700     MOVE PV-LABOR-CURRENT-TIMESTAMP TO XL091-EVNT-KY-1-TMST.     10270000
102800                                                                  10280000
102900     SET XL091-COPYBOOK-NOT-USED TO TRUE.                         10290000
103000                                                                  10300000
103100     PERFORM 6500-CALL-XLKUT107.                                  10310000
103200                                                                  10320000
103300     IF  PS-CALLED-MODULE-ERROR                                   10330000
103400         SET PS-ERROR TO TRUE                                     10340000
103500         MOVE 'XLKUT107' TO DL019-CALL-MOD-FAIL-NM                10350000
103600         MOVE XL091-SQL-ERROR-PARA                                10360000
103700                                TO DL019-CALL-MOD-FAIL-SQL-PARA   10370000
103800         MOVE XL091-RETURN-CODE TO DL019-CALL-MOD-FAIL-ERR-CDE    10380000
103900         SET DL019-CALLED-MODULE-FAILURE TO TRUE                  10390000
104000         IF  XL091-SQL-ERROR                                      10400000
104100             MOVE XL091-EAI-DB-SQLCODE TO                         10410000
104200                  DL019-CALL-MOD-FAIL-SQL-CDE                     10420000
104300             MOVE XL091-SQL-ERROR-PARA TO                         10430000
104400                  DL019-CALL-MOD-FAIL-SQL-PARA                    10440000
104500         END-IF                                                   10450000
104600         PERFORM 9000-RETURN-CALL                                 10460000
104700     END-IF.                                                      10470000
104800                                                                  10480000
104900 3220-GET-TIMESTAMP.                                              10490000
105000                                                                  10500000
105100     IF KRPRPM-FUNC-TXT = 'Y'                                     10510000
105200         DISPLAY ' DLKUT410 START 3220- PARA '                    10520000
105210                 ' PS-ERROR-SW:'    PS-ERROR-SW                   10521004
105300     END-IF.                                                      10530000
105400                                                                  10540000
105500                                                                  10550000
105600     EXEC SQL                                                     10560000
105700          SET  :PV-LABOR-CURRENT-TIMESTAMP =                      10570000
105800               (TIMESTAMP(:PV-HOLD-TIMESTAMP) - 1 SECOND)         10580000
105900     END-EXEC.                                                    10590000
106000                                                                  10600000
106100*----------------------------------------------------------------*10610000
106110*  PARM USED TO DETERMINE IF DC IS CHECKING IF AN ASSOIATE IS ON *10611000
106120*  MULTIPLE ACTIVE ASSIGNMENTS                                   *10612000
106130*  DMH ADDED - 12-10-2008                                        *10613000
106140*----------------------------------------------------------------*10614000
106150 4000-SELECT-TKRPRPM.                                             10615000
106160                                                                  10616000
106170     IF KRPRPM-FUNC-TXT = 'Y'                                     10617000
106171         DISPLAY ' DLKUT410 4000-SELECT-TKRPRPM - PARA '          10617105
106172                 ' PS-ERROR-SW:'    PS-ERROR-SW                   10617204
106173     END-IF.                                                      10617300
106174                                                                  10617400
106175     MOVE  DL019-EAI-DC-NBR  TO  KRPRPM-LOC-ID.                   10617500
106176                                                                  10617600
106177     EXEC SQL                                                     10617700
106178         SELECT                                                   10617800
106179                FUNC_TXT                                          10617900
106180          INTO                                                    10618000
106181                :PV-FUNC-TXT                                      10618100
106190          FROM  TKRPRPM                                           10619000
106191         WHERE  LOC_ID            = :DL019-EAI-DC-NBR             10619100
106192           AND  INTFC_SYS_CDE     = 'KHL'                         10619200
106193           AND  SYS_PRC_FUNC_CDE  = 'DLMLTA'                      10619300
106194           AND  FUNC_PRC_STAT_CDE = 'AC'                          10619400
106195           AND  FUNC_BEG_TMST    <= CURRENT TIMESTAMP             10619500
106196           AND  FUNC_END_TMST    >= CURRENT TIMESTAMP             10619600
106197           AND  FUNC_TXT          = 'Y'                           10619700
106198     END-EXEC.                                                    10619800
106199                                                                  10619900
106200     EVALUATE TRUE                                                10620000
106201         WHEN SQLCODE = ZERO                                      10620100
106202              SET PS-CHECKING-MULT-ASGMT  TO TRUE                 10620200
106203                                                                  10620300
106204         WHEN SQLCODE = +100                                      10620400
106205              SET PS-NOT-CHECKING-MULT-ASGMT  TO TRUE             10620500
106206                                                                  10620600
106207         WHEN SQLWARN0 NOT = SPACES                               10620700
106208         WHEN SQLCODE NOT = ZERO                                  10620800
106209              MOVE DL019-EAI-DC-NBR   TO  PV-DISPLAY-OPER         10620900
106210              DISPLAY ' DLKUT410 -'                               10621000
106211                     PV-DISPLAY-OPER         '-'                  10621100
106212                     DL019-EAI-WK-TYP-DESC   '-'                  10621200
106213                     DL019-EAI-WK-AREA-DESC  '-'                  10621300
106214                     DL019-EAI-CRE-BY-USR-ID                      10621400
106215                                                                  10621500
106216              MOVE SQLCODE          TO  PV-DISPLAY-SQLCODE        10621600
106217              DISPLAY ' DLKUT410 -'                               10621700
106218                    ' PARA: 4000 - '                              10621800
106219                    ' SQLCODE: '        PV-DISPLAY-SQLCODE        10621900
106220                    ' TKRPRPM SELECT FOR DLMLTA'                  10622000
106230               SET PS-NOT-CHECKING-MULT-ASGMT  TO TRUE            10623000
106240     END-EVALUATE.                                                10624000
106241                                                                  10624100
106242*----------------------------------------------------------------*10624200
106243* THIS SQL WILL CHECK IF AN ASSOCIATE IS ON MULTIPLE ACTIVE      *10624300
106244* ASSIGNMENTS.  IF THE ASSOCIATE IS, NEW MODULE DLKUT029 WILL BE *10624400
106245* CALLED TO END THE ASSOCIATE ON ALL OF THE ACTIVE ASSIGNMENTS   *10624500
106246* DMH ADDED - 12-10-2008                                         *10624600
106247*----------------------------------------------------------------*10624700
106248 4100-CHECK-MULT-ASGMT.                                           10624800
106249                                                                  10624900
106250     IF KRPRPM-FUNC-TXT = 'Y'                                     10625000
106251         DISPLAY ' DLKUT410 - 4100-CHECK-MULT-ASGMT - PARA '      10625106
106252                 ' PS-ERROR-SW:'    PS-ERROR-SW                   10625204
106253     END-IF.                                                      10625300
106254                                                                  10625400
106255     IF  DL019-EAI-USR-IS-KOHLS                                   10625500
106256                                                                  10625600
106257       EXEC SQL                                                   10625700
106258            SELECT  COUNT(*)                                      10625800
106259              INTO  :PV-ASGMT-COUNT                               10625900
106260              FROM  DLT_TEM_ASGMT   A                             10626000
106261                   ,DLT_ASGMT       B                             10626100
106262             WHERE  A.KOHLS_USR_ID      = :DL019-EAI-CRE-BY-USR-ID10626200
106263               AND  A.LVE_RSN_CDE       = 'N'                     10626300
106264               AND  B.ASGMT_STRT_DTE    = A.ASGMT_STRT_DTE        10626400
106265               AND  B.ASGMT_NBR_TXT     = A.ASGMT_NBR_TXT         10626500
106266               AND  B.ASGMT_NBR_SEQ_NBR = A.ASGMT_NBR_SEQ_NBR     10626600
106267               AND  B.ASGMT_STP_RSN_CDE = 'N'                     10626700
106268       END-EXEC                                                   10626800
106269                                                                  10626900
106270     ELSE                                                         10627000
106271                                                                  10627100
106272       EXEC SQL                                                   10627200
106273            SELECT  COUNT(*)                                      10627300
106274              INTO  :PV-ASGMT-COUNT                               10627400
106275              FROM  DLT_TEM_ASGMT   A                             10627500
106276                   ,DLT_ASGMT       B                             10627600
106277             WHERE  A.TMP_USR_ID        = :DL019-EAI-CRE-BY-USR-ID10627700
106278               AND  A.LVE_RSN_CDE       = 'N'                     10627800
106279               AND  B.ASGMT_STRT_DTE    = A.ASGMT_STRT_DTE        10627900
106280               AND  B.ASGMT_NBR_TXT     = A.ASGMT_NBR_TXT         10628000
106281               AND  B.ASGMT_NBR_SEQ_NBR = A.ASGMT_NBR_SEQ_NBR     10628100
106282               AND  B.ASGMT_STP_RSN_CDE = 'N'                     10628200
106283       END-EXEC                                                   10628300
106284     END-IF.                                                      10628400
106285                                                                  10628500
106286     EVALUATE TRUE                                                10628600
106287         WHEN SQLCODE = ZERO                                      10628700
106288              IF  PV-ASGMT-COUNT  >  1                            10628800
106289                  PERFORM 4200-CALL-DLKUT029                      10628900
106290              END-IF                                              10629000
106291                                                                  10629100
106292         WHEN SQLCODE = -911                                      10629200
106293         WHEN SQLCODE = -913                                      10629300
106294         WHEN SQLCODE = -904                                      10629400
106295             SET PS-ERROR                                         10629500
106296                 DL019-SQL-ERROR                                  10629600
106297                 DL019-ASGMT-CONTENTION   TO TRUE                 10629700
106298             MOVE SQLCA                   TO DL019-SQLCA          10629800
106299             MOVE SQLCODE                 TO DL019-ASGMT-SQLCODE  10629900
106300                                                                  10630000
106301              MOVE DL019-EAI-DC-NBR   TO  PV-DISPLAY-OPER         10630100
106302              DISPLAY ' DLKUT410 -'                               10630200
106303                     PV-DISPLAY-OPER         '-'                  10630300
106304                     DL019-EAI-WK-TYP-DESC   '-'                  10630400
106305                     DL019-EAI-WK-AREA-DESC  '-'                  10630500
106306                     DL019-EAI-CRE-BY-USR-ID                      10630600
106307                                                                  10630700
106308              MOVE SQLCODE          TO  PV-DISPLAY-SQLCODE        10630800
106309              DISPLAY ' DLKUT410 -'                               10630900
106310                    ' PARA: 4100 - '                              10631000
106311                    ' SQLCODE: '        PV-DISPLAY-SQLCODE        10631100
106312                    ' COUNT NUMBER OF ASSIGNMENTS FOR ASSOCIATE'  10631200
106313                                                                  10631300
106314         WHEN SQLWARN0 NOT = SPACES                               10631400
106315         WHEN SQLCODE NOT = ZERO                                  10631500
106316              SET PS-ERROR                                        10631600
106317                  DL019-SQL-ERROR          TO TRUE                10631700
106318              MOVE SQLCA                   TO DL019-SQLCA         10631800
106319              MOVE SQLCODE                 TO DL019-ASGMT-SQLCODE 10631900
106320                                                                  10632000
106321              MOVE DL019-EAI-DC-NBR   TO  PV-DISPLAY-OPER         10632100
106330              DISPLAY ' DLKUT410 -'                               10633000
106331                     PV-DISPLAY-OPER         '-'                  10633100
106332                     DL019-EAI-WK-TYP-DESC   '-'                  10633200
106333                     DL019-EAI-WK-AREA-DESC  '-'                  10633300
106334                     DL019-EAI-CRE-BY-USR-ID                      10633400
106335                                                                  10633500
106336              MOVE SQLCODE          TO  PV-DISPLAY-SQLCODE        10633600
106337              DISPLAY ' DLKUT410 -'                               10633700
106338                    ' PARA: 4100 - '                              10633800
106339                    ' SQLCODE: '        PV-DISPLAY-SQLCODE        10633900
106340                    ' COUNT NUMBER OF ASSIGNMENTS FOR ASSOCIATE'  10634000
106350                                                                  10635000
106351     END-EVALUATE.                                                10635100
106352                                                                  10635200
106353*----------------------------------------------------------------*10635300
106354* CALL MODULE DLKUT029 TO END ASSOCIATE OFF OF THE MULTIPLE      *10635400
106355* ASSIGNMENTS THAT THEY ARE CURRENTLY ON.                        *10635500
106356* DMH ADDED - 12-10-2008                                         *10635600
106357*----------------------------------------------------------------*10635700
106358 4200-CALL-DLKUT029.                                              10635800
106359                                                                  10635900
106360     IF KRPRPM-FUNC-TXT = 'Y'                                     10636000
106361         DISPLAY ' 4200-CALL-DLKUT029 - PARA '                    10636100
106362                 ' PS-ERROR-SW:'    PS-ERROR-SW                   10636204
106363     END-IF.                                                      10636300
106364                                                                  10636400
106365     INITIALIZE  DL025-ASGMT-COMMAREA.                            10636500
106366                                                                  10636600
106367     MOVE PV-HOLD-USR-ID         TO  DL025-KEY-USER-ID.           10636700
106368     MOVE DL019-CALLING-PGM-NM   TO  DL025-ORIG-CALLING-PGM-NM.   10636800
106369     MOVE DL019-EAI-WK-TYP-DESC  TO  DL025-KEY-WK-TYP.            10636900
106370     MOVE DL019-EAI-WK-AREA-DESC TO  DL025-KEY-WK-AREA.           10637000
106371     MOVE DL019-EAI-DC-NBR       TO  DL025-KEY-DC-NBR.            10637100
106372                                                                  10637200
106373     SET PS-NO-CALLED-MODULE-ERROR TO TRUE.                       10637300
106374                                                                  10637400
106375     CALL DL025-MULT-ASGMT-PGM USING DL025-ASGMT-COMMAREA.        10637500
106376                                                                  10637600
106377     EVALUATE TRUE                                                10637700
106378         WHEN DL025-SUCCESSFUL                                    10637800
106379             CONTINUE                                             10637900
106380         WHEN OTHER                                               10638000
106381             SET PS-CALLED-MODULE-ERROR TO TRUE                   10638100
106382                                                                  10638200
106383             DISPLAY ' DLKUT410 - '                               10638300
106384                    'CALLED MODULE DLKUT029 FAILED'               10638400
106385                                                                  10638500
106386             MOVE '4200-CALL-DLKUT029' TO PV-MODULE-PARAGRAPH     10638600
106387             DISPLAY ' DLKUT410 - '                               10638700
106388                    PV-MODULE-FAIL-MSG                            10638800
106389                    ' WITH RETURN CODE - '                        10638900
106390                    DL003-RETURN-CODE                             10639000
106391     END-EVALUATE.                                                10639100
106400                                                                  10640000
106401                                                                  10640100
106402*-----------------------------------------------------------------10640200
106403*  INSERT ROW INTO TUPLDER (UPLOAD ERROR) TABLE - TOO KEEP TRACK *10640300
106404*  OF WHEN MULTIPLE ASSIGNMENTS ARE OPEN FOR THE SAME WORK AREA  *10640400
106405*-----------------------------------------------------------------10640500
106406 4400-INSERT-TUPLDER.                                             10640600
106407                                                                  10640700
106408                                                                  10640800
106409     IF KRPRPM-FUNC-TXT = 'Y'                                     10640900
106410         DISPLAY ' DLKUT410 - 4400-INSERT-TUPLDER - PARA '        10641006
106411                 ' PS-ERROR-SW:'    PS-ERROR-SW                   10641104
106420     END-IF.                                                      10642000
106430                                                                  10643000
106440     MOVE DL019-EAI-DC-NBR             TO UPLDER-OPER-UNT-ID.     10644000
106441     MOVE 'F'                          TO UPLDER-UPLD-TRN-CDE.    10644100
106442     MOVE '102'                        TO UPLDER-ERR-CDE.         10644200
106443     MOVE  0                           TO UPLDER-UPLD-SEQ-NBR.    10644300
106444                                                                  10644400
106445     INITIALIZE  UPLDER-PKT-TXT.                                  10644500
106446     MOVE DL019-EAI-DC-NBR TO  PV-DISPLAY-OPER                    10644600
106447     STRING   PV-DISPLAY-OPER         ' '                         10644700
106448              PV-HOLD-USR-ID          ' '                         10644800
106449              DL019-EAI-WK-TYP-DESC   ' '                         10644900
106450              DL019-EAI-WK-AREA-DESC      DELIMITED BY SIZE       10645000
106451                                     INTO UPLDER-PKT-TXT.         10645100
106452                                                                  10645200
106453     EXEC SQL                                                     10645300
106454         INSERT                                                   10645400
106455           INTO TUPLDER                                           10645500
106456             ( OPER_UNT_ID                                        10645600
106457             , UPLD_TRN_CDE                                       10645700
106458             , ERR_CDE                                            10645800
106459             , PRC_TMST                                           10645900
106460             , UPLD_SEQ_NBR                                       10646000
106461             , PKT_TXT                                            10646100
106462             )                                                    10646200
106463             VALUES                                               10646300
106464             ( :UPLDER-OPER-UNT-ID                                10646400
106465             , :UPLDER-UPLD-TRN-CDE                               10646500
106466             , :UPLDER-ERR-CDE                                    10646600
106467             ,  CURRENT TIMESTAMP                                 10646700
106468             , :UPLDER-UPLD-SEQ-NBR                               10646800
106469             , :UPLDER-PKT-TXT                                    10646900
106470             )                                                    10647000
106471     END-EXEC.                                                    10647100
106472                                                                  10647200
106473     EVALUATE TRUE                                                10647300
106474         WHEN SQLCODE = ZERO                                      10647400
106475             CONTINUE                                             10647500
106476                                                                  10647600
106477         WHEN SQLWARN0 NOT = SPACES                               10647700
106478         WHEN SQLCODE  NOT = ZERO                                 10647800
106479                                                                  10647900
106480             MOVE DL025-KEY-DC-NBR  TO  PV-DISPLAY-OPER           10648000
106481             DISPLAY ' DLKCS410 -'                                10648100
106482                    UPLDER-PKT-TXT                                10648200
106483                                                                  10648300
106484             MOVE SQLCODE           TO  PV-DISPLAY-SQLCODE        10648400
106485             DISPLAY  ' DLKUT410 -'                               10648500
106486                   ' PARA: 4400-INSERT-TUPLDER'                   10648600
106487                   ' SQLCODE: '        PV-DISPLAY-SQLCODE         10648700
106488                                                                  10648800
106489     END-EVALUATE.                                                10648900
106490                                                                  10649000
106491                                                                  10649100
106492*----------------------------------------------------------------*10649200
106493* CALL MODULE DLKUT031 TO END MULTIPLE ASGMTS FOR DC/TYPE/AREA   *10649300
106494* DMH ADDED - 10-27-2009                                         *10649400
106495*----------------------------------------------------------------*10649500
106496 4500-CALL-DLKUT031.                                              10649600
106497                                                                  10649700
106498     IF KRPRPM-FUNC-TXT = 'Y'                                     10649800
106499         DISPLAY ' DLKUT410 - 4500-CALL-DLKUT031 - PARA'          10649906
106500                 ' PS-ERROR-SW:'    PS-ERROR-SW                   10650004
106501     END-IF.                                                      10650100
106502                                                                  10650200
106503     INITIALIZE  DL027-ASGMT-COMMAREA.                            10650300
106504                                                                  10650400
106505     MOVE DL019-CALLING-PGM-NM   TO  DL027-ORIG-CALLING-PGM-NM.   10650500
106506     MOVE DL019-EAI-WK-TYP-DESC  TO  DL027-KEY-WK-TYP.            10650600
106507     MOVE DL019-EAI-WK-AREA-DESC TO  DL027-KEY-WK-AREA.           10650700
106508     MOVE DL019-EAI-DC-NBR       TO  DL027-KEY-DC-NBR.            10650800
106509                                                                  10650900
106510     SET PS-NO-CALLED-MODULE-ERROR TO TRUE.                       10651000
106511                                                                  10651100
106520     CALL DL027-MULT-ASGMT-PGM USING DL027-ASGMT-COMMAREA.        10652000
106521                                                                  10652100
106522     EVALUATE TRUE                                                10652200
106523         WHEN DL027-SUCCESSFUL                                    10652300
106524             PERFORM 4600-CHECK-FOR-ASGMT-2ND-TIME                10652400
106525         WHEN OTHER                                               10652500
106526             SET PS-CALLED-MODULE-ERROR TO TRUE                   10652600
106527                                                                  10652700
106528             DISPLAY ' DLKUT410 - '                               10652800
106529                    'CALLED MODULE DLKUT031 FAILED'               10652900
106530                                                                  10653000
106531             MOVE '4500-CALL-DLKUT031' TO PV-MODULE-PARAGRAPH     10653100
106532             DISPLAY ' DLKUT410 - '                               10653200
106533                    PV-MODULE-FAIL-MSG                            10653300
106534                    ' WITH RETURN CODE - '                        10653400
106535                    DL003-RETURN-CODE                             10653500
106536     END-EVALUATE.                                                10653600
106537                                                                  10653700
106538                                                                  10653800
106539*-----------------------------------------------------------------10653900
106540* IF INTIALLY IT WAS FOUND THAT THERE WERE MULTIPLE ASSIGNMENTS  *10654000
106541* OPEN FOR A GIVEN DC/TYPE/AREA, DLKUT031 WAS CALLED (PARA 4500) *10654100
106542* WHEN THAT MODULE IS SUCCESSFUL - THIS PARAGRAPH IS CALL JUST   *10654200
106543* TO CHECK IF THERE IS AN ASSIGNMENT THAT MIGHT HAVE BEEN OPENED *10654300
106544* IN THE INTERUM FOR THE SAME DC/TYPE/AREA.                      *10654400
106545*-----------------------------------------------------------------10654500
106546 4600-CHECK-FOR-ASGMT-2ND-TIME.                                   10654600
106547                                                                  10654700
106548     IF KRPRPM-FUNC-TXT = 'Y'                                     10654800
106549         DISPLAY ' DLKUT410 START 4600- PARA '                    10654900
106550                 ' PS-ERROR-SW:'    PS-ERROR-SW                   10655004
106551     END-IF.                                                      10655100
106552                                                                  10655200
106553     INITIALIZE  DL004-ASGMT-COMMAREA.                            10655300
106554                                                                  10655400
106555     MOVE DL019-CALLING-PGM-NM        TO                          10655500
106556                                      DL004-ORIG-CALLING-PGM-NM.  10655600
106557                                                                  10655700
106558     MOVE DL019-ASGMT-NBR-WRK-TYP     TO DL004-KEY-WK-TYP         10655800
106559     MOVE DL019-EAI-WK-AREA-DESC      TO DL004-KEY-WK-AREA        10655900
106560     MOVE DL019-EAI-DC-NBR            TO DL004-KEY-DC-NBR         10656000
106561                                                                  10656100
106562     SET DL004-BY-WK-TYP-AREA-KEY     TO TRUE.                    10656200
106563     SET PS-NO-CALLED-MODULE-ERROR    TO TRUE.                    10656300
106564                                                                  10656400
106565     PERFORM 6100-CALL-DLKUT002.                                  10656500
106566                                                                  10656600
106567     IF  PS-CALLED-MODULE-ERROR                                   10656700
106568         SET PS-ERROR TO TRUE                                     10656800
106569         MOVE 'DLKUT002' TO DL019-CALL-MOD-FAIL-NM                10656900
106570         MOVE DL004-SQL-ERROR-PARA                                10657000
106571                                TO DL019-CALL-MOD-FAIL-SQL-PARA   10657100
106572         MOVE DL004-RETURN-CODE TO DL019-CALL-MOD-FAIL-ERR-CDE    10657200
106573         SET DL019-CALLED-MODULE-FAILURE TO TRUE                  10657300
106574         IF  DL004-SQL-ERROR                                      10657400
106575             MOVE DL004-ASGMT-SQLCODE TO                          10657500
106576                  DL019-CALL-MOD-FAIL-SQL-CDE                     10657600
106577             MOVE DL004-SQL-ERROR-PARA TO                         10657700
106578                  DL019-CALL-MOD-FAIL-SQL-PARA                    10657800
106579         END-IF                                                   10657900
106580         PERFORM 9000-RETURN-CALL                                 10658000
106581     ELSE                                                         10658100
106582         IF  DL004-ASGMT-MULT-FOUND                               10658200
106583             SET PS-ERROR TO TRUE                                 10658300
106584             MOVE 'DLKUT002' TO DL019-CALL-MOD-FAIL-NM            10658400
106585             MOVE DL004-SQL-ERROR-PARA                            10658500
106586                                TO DL019-CALL-MOD-FAIL-SQL-PARA   10658600
106587             MOVE DL004-RETURN-CODE TO                            10658700
106588                  DL019-CALL-MOD-FAIL-ERR-CDE                     10658800
106589             SET DL019-CALLED-MODULE-FAILURE TO TRUE              10658900
106590             MOVE SPACES TO PV-MSG-AREA2                          10659000
106591             STRING ' DLKUT410 - '           DELIMITED BY SIZE    10659100
106592                    'CALLED MODULE SUCCESS'  DELIMITED BY SIZE    10659200
106593                                           INTO PV-MSG-AREA2      10659300
106594             PERFORM 9200-WRITE-TO-LOG                            10659400
106595             MOVE SPACES TO PV-MSG-AREA2                          10659500
106596             MOVE '6100-CALL-DLKUT002 -B ' TO PV-MODULE-PARAGRAPH 10659600
106597             STRING ' DLKUT410 - '           DELIMITED BY SIZE    10659700
106598                    PV-MODULE-FAIL-MSG       DELIMITED BY SIZE    10659800
106599                    ' WITH RETURN CODE - '   DELIMITED BY SIZE    10659900
106600                    DL004-RETURN-CODE        DELIMITED BY SIZE    10660000
106601                    ' BUT HAD MULT ASGMTS'   DELIMITED BY SIZE    10660100
106602                                           INTO PV-MSG-AREA2      10660200
106603             PERFORM 9200-WRITE-TO-LOG                            10660300
106604             MOVE SPACES TO PV-MSG-AREA2                          10660400
106605             MOVE DL004-KEY-DC-NBR TO                             10660500
106606                  PV-DISPLAY-DC-NBR                               10660600
106607             MOVE DL004-ASGMT-FOUND-QTY TO                        10660700
106608                  PV-DISPLAY-QTY-5                                10660800
106609             STRING ' DLKUT410 - '           DELIMITED BY SIZE    10660900
106610                    'HAD MULT ASGMT FOR DC ' DELIMITED BY SIZE    10661000
106611                    PV-DISPLAY-DC-NBR        DELIMITED BY SIZE    10661100
106612                    ' FOR WORK TYPE OF '     DELIMITED BY SIZE    10661200
106613                    DL004-KEY-WK-TYP         DELIMITED BY SIZE    10661300
106614                    ' FOR WORK AREA OF '     DELIMITED BY SIZE    10661400
106615                    DL004-KEY-WK-AREA        DELIMITED BY SIZE    10661500
106616                                           INTO PV-MSG-AREA2      10661600
106617             PERFORM 9200-WRITE-TO-LOG                            10661700
106618             PERFORM 4400-INSERT-TUPLDER                          10661800
106619             PERFORM 9000-RETURN-CALL                             10661900
106620         ELSE                                                     10662000
106621             IF  DL004-ASGMT-NOT-FOUND                            10662100
106622                 SET PS-CREATE-NEW-ASGMT TO TRUE                  10662200
106623             END-IF                                               10662300
106624         END-IF                                                   10662400
106625     END-IF.                                                      10662500
106626                                                                  10662600
106627                                                                  10662700
106628*-----------------------------------------------------------------10662800
106629*  CALL XLKUT067 TO DETERMINE THE USER TYPE (KOHLS VERSUS        *10662900
106630*  TEMPORARY ASSOCIATE)                                          *10663000
106631*-----------------------------------------------------------------10663100
106640*6000-CALL-XLKUT067.                                              10664000
106650***                                                               10665000
106660***  INITIALIZE XL067-USER-COMMAREA.                              10666000
106670***  SET XL067-BY-USER-ID TO TRUE.                                10667000
106680***  SET XL067-SELECT-BOTH-USERS TO TRUE.                         10668000
106690***                                                               10669000
106700***  MOVE PV-HOLD-USR-ID TO XL067-KEY-USER-ID.                    10670000
106800***  MOVE DL019-CALLING-PGM-NM TO XL067-ORIG-CALLING-PGM-NM.      10680000
106900***                                                               10690000
107000***  CALL XL067-USER-PGM USING XL067-USER-COMMAREA.               10700000
107100***                                                               10710000
107200***  EVALUATE TRUE                                                10720000
107300***      WHEN XL067-SUCCESSFUL                                    10730000
107400***           MOVE XL067-USER-FOUND-CODE TO                       10740000
107500***                PV-HOLD-USR-TYP-CDE                            10750000
107600***      WHEN OTHER                                               10760000
107700***          SET PS-CALLED-MODULE-ERROR TO TRUE                   10770000
107800***          MOVE SPACES TO PV-MSG-AREA2                          10780000
107900***          STRING ' DLKUT410 - '           DELIMITED BY SIZE    10790000
108000***                 'CALLED MODULE FAILED'   DELIMITED BY SIZE    10800000
108100***                                        INTO PV-MSG-AREA2      10810000
108200***          PERFORM 9200-WRITE-TO-LOG                            10820000
108300***          MOVE SPACES TO PV-MSG-AREA2                          10830000
108400***          MOVE '6000-CALL-XLKUT067' TO PV-MODULE-PARAGRAPH     10840000
108500***          STRING ' DLKUT410 - '           DELIMITED BY SIZE    10850000
108600***                 PV-MODULE-FAIL-MSG       DELIMITED BY SIZE    10860000
108700***                 ' WITH RETURN CODE - '   DELIMITED BY SIZE    10870000
108800***                 XL067-RETURN-CODE        DELIMITED BY SIZE    10880000
108900***                                        INTO PV-MSG-AREA2      10890000
109000***          PERFORM 9200-WRITE-TO-LOG                            10900000
109100***  END-EVALUATE.                                                10910000
109200                                                                  10920000
109300*-----------------------------------------------------------------10930000
109400*  CALL DLKUT002 TO DETERMINE IF THERE IS AN OPEN ASSIGNMENT     *10940000
109500*  FOR THE REQUESTED DC NUMBER/WORK TYPE/WORK AREA.              *10950000
109600*-----------------------------------------------------------------10960000
109700 6100-CALL-DLKUT002.                                              10970000
109800                                                                  10980000
109900     IF KRPRPM-FUNC-TXT = 'Y'                                     10990000
110000         DISPLAY ' DLKUT410 START 6100- PARA '                    11000000
110010                 ' PS-ERROR-SW:'    PS-ERROR-SW                   11001004
110100     END-IF.                                                      11010000
110200                                                                  11020000
110300                                                                  11030000
110400     CALL DL004-USER-PGM USING DL004-ASGMT-COMMAREA.              11040000
110500                                                                  11050000
110600     EVALUATE TRUE                                                11060000
110700         WHEN DL004-SUCCESSFUL                                    11070000
110800             CONTINUE                                             11080000
110900         WHEN OTHER                                               11090000
111000             SET PS-CALLED-MODULE-ERROR TO TRUE                   11100000
111100             MOVE SPACES TO PV-MSG-AREA2                          11110000
111200             STRING ' DLKUT410 - '           DELIMITED BY SIZE    11120000
111300                    'CALLED MODULE FAILED'   DELIMITED BY SIZE    11130000
111400                                           INTO PV-MSG-AREA2      11140000
111500             PERFORM 9200-WRITE-TO-LOG                            11150000
111600             MOVE SPACES TO PV-MSG-AREA2                          11160000
111700             MOVE '6100-CALL-DLKUT002' TO PV-MODULE-PARAGRAPH     11170000
111800             STRING ' DLKUT410 - '           DELIMITED BY SIZE    11180000
111900                    PV-MODULE-FAIL-MSG       DELIMITED BY SIZE    11190000
112000                    ' WITH RETURN CODE - '   DELIMITED BY SIZE    11200000
112100                    DL004-RETURN-CODE        DELIMITED BY SIZE    11210000
112200                                           INTO PV-MSG-AREA2      11220000
112300             PERFORM 9200-WRITE-TO-LOG                            11230000
112400     END-EVALUATE.                                                11240000
112500                                                                  11250000
112600                                                                  11260000
112700*-----------------------------------------------------------------11270000
112800*  CALL DLKUT001 TO DETERMINE IF THE REQUESTED ASSOCIATE IS      *11280000
112900*  CURRENTLY ACTIVE ON AN ACTIVE ASSIGNMENT.                     *11290000
113000*-----------------------------------------------------------------11300000
113100 6200-CALL-DLKUT001.                                              11310000
113110                                                                  11311000
113120     IF KRPRPM-FUNC-TXT = 'Y'                                     11312000
113130         DISPLAY ' DLKUT410 START 6200- PARA '                    11313000
113131                 ' PS-ERROR-SW:'    PS-ERROR-SW                   11313104
113140     END-IF.                                                      11314000
113150                                                                  11315000
113160                                                                  11316000
113170     CALL DL003-USER-PGM USING DL003-ASGMT-COMMAREA.              11317000
113180                                                                  11318000
113190     EVALUATE TRUE                                                11319000
113200         WHEN DL003-SUCCESSFUL                                    11320000
113300             CONTINUE                                             11330000
113400         WHEN OTHER                                               11340000
113500             SET PS-CALLED-MODULE-ERROR TO TRUE                   11350000
113600             MOVE SPACES TO PV-MSG-AREA2                          11360000
113700             STRING ' DLKUT410 - '           DELIMITED BY SIZE    11370000
113800                    'CALLED MODULE FAILED'   DELIMITED BY SIZE    11380000
113900                                           INTO PV-MSG-AREA2      11390000
114000             PERFORM 9200-WRITE-TO-LOG                            11400000
114100             MOVE SPACES TO PV-MSG-AREA2                          11410000
114200             MOVE '6100-CALL-DLKUT002' TO PV-MODULE-PARAGRAPH     11420000
114300             STRING ' DLKUT410 - '           DELIMITED BY SIZE    11430000
114400                    PV-MODULE-FAIL-MSG       DELIMITED BY SIZE    11440000
114500                    ' WITH RETURN CODE - '   DELIMITED BY SIZE    11450000
114600                    DL003-RETURN-CODE        DELIMITED BY SIZE    11460000
114700                                           INTO PV-MSG-AREA2      11470000
114800             PERFORM 9200-WRITE-TO-LOG                            11480000
114900     END-EVALUATE.                                                11490000
115000                                                                  11500000
115100                                                                  11510000
115200*-----------------------------------------------------------------11520000
115300*  CALL DLKUP025 TO EITHER END THE ASSOCIATE FORM AN ASSIGNMENT  *11530000
115400*  OR ADD THE ASSOCIATE TO AN ASSIGNMENT.                        *11540000
115500*-----------------------------------------------------------------11550000
115600 6300-CALL-DLKUP025.                                              11560000
115700                                                                  11570000
115800     IF KRPRPM-FUNC-TXT = 'Y'                                     11580000
115900         DISPLAY ' DLKUT410 START 6300- PARA '                    11590000
115910                 ' PS-ERROR-SW:'    PS-ERROR-SW                   11591004
116000     END-IF.                                                      11600000
116010                                                                  11601000
116011                                                                  11601100
116012     IF KRPRPM-FUNC-TXT = 'Y'                                     11601200
116013         DISPLAY   DL021-ASGMT-COMMAREA                           11601300
116014         DISPLAY ' PS-ERROR-SW:'    PS-ERROR-SW                   11601404
116015     END-IF.                                                      11601500
116016                                                                  11601600
116021     MOVE DL021-KEY-NBR-SEQ-NBR       TO  PV-DISP-ASGMT-SEQ       11602102
116022     MOVE DL021-KEY-TEM-ASGMT-SEQ-NBR TO  PV-DISP-TEM-SEQ         11602202
116023     IF KRPRPM-FUNC-TXT = 'Y'                                     11602302
116024         DISPLAY 'ASGMT-SEQ:  ' PV-DISP-ASGMT-SEQ                 11602402
116025         DISPLAY 'TEAM-SEQ:   ' PV-DISP-TEM-SEQ                   11602502
116026         DISPLAY ' PS-ERROR-SW:'    PS-ERROR-SW                   11602604
116027     END-IF.                                                      11602702
116028                                                                  11602802
116029                                                                  11602900
116030     CALL DL021-USER-PGM USING DL021-ASGMT-COMMAREA.              11603000
116040                                                                  11604000
116050     EVALUATE TRUE                                                11605000
116060         WHEN DL021-SUCCESSFUL                                    11606000
116070             CONTINUE                                             11607000
116080                                                                  11608000
116090* ADDED 10/18/2007 - DMH BEGIN                                    11609000
116100         WHEN DL021-ASGMT-NOT-ACTIVE                              11610000
116200             PERFORM 6600-ESTABLISH-ASGMT-2                       11620000
116300* ADDED 10/18/2007 - DMH END                                      11630000
116400                                                                  11640000
116500         WHEN OTHER                                               11650000
116600             SET PS-CALLED-MODULE-ERROR TO TRUE                   11660000
116700             MOVE SPACES TO PV-MSG-AREA2                          11670000
116800             STRING ' DLKUT410 - '           DELIMITED BY SIZE    11680000
116900                    'CALLED MODULE FAILED'   DELIMITED BY SIZE    11690000
117000                                           INTO PV-MSG-AREA2      11700000
117100             PERFORM 9200-WRITE-TO-LOG                            11710000
117200             MOVE SPACES TO PV-MSG-AREA2                          11720000
117300             MOVE '6300-CALL-DLKUP025' TO PV-MODULE-PARAGRAPH     11730000
117400             STRING ' DLKUT410 - '           DELIMITED BY SIZE    11740000
117500                    PV-MODULE-FAIL-MSG       DELIMITED BY SIZE    11750000
117600                    ' TO '                   DELIMITED BY SIZE    11760000
117700                    PV-DISPLAY-TEXT          DELIMITED BY SIZE    11770000
117800                    ' ASSIGNMENT'            DELIMITED BY SIZE    11780000
117900                    ' WITH RETURN CODE - '   DELIMITED BY SIZE    11790000
118000                    DL021-RETURN-CODE        DELIMITED BY SIZE    11800000
118100                                           INTO PV-MSG-AREA2      11810000
118200             PERFORM 9200-WRITE-TO-LOG                            11820000
118300             MOVE SPACES TO PV-MSG-AREA2                          11830000
118400             STRING ' DLKUT410: ASGMT DL004-ASGMT-FOUND-CODE:'    11840000
118500                      DL004-ASGMT-FOUND-CODE                      11850000
118600                      '  '                                        11860000
118700                    'TEAM DL003-ASGMT-FOUND-CODE:'                11870000
118800                     DL003-ASGMT-FOUND-CODE                       11880000
118900                                             DELIMITED BY SIZE    11890000
119000                                           INTO PV-MSG-AREA2      11900000
119100             PERFORM 9200-WRITE-TO-LOG                            11910000
119200             MOVE SPACES TO PV-MSG-AREA2                          11920000
119300             STRING ' DLKUT410 - TEAM DL003-ASGMT-START-DTE:'     11930000
119400                      DL003-ASGMT-START-DTE '  '                  11940000
119500                    ' ASGMT DL004-ASGMT-START-DTE:'               11950000
119600                      DL004-ASGMT-START-DTE '  '                  11960000
119700                                             DELIMITED BY SIZE    11970000
119800                                           INTO PV-MSG-AREA2      11980000
119900             PERFORM 9200-WRITE-TO-LOG                            11990000
120000                                                                  12000000
120100             MOVE SPACES TO PV-MSG-AREA2                          12010000
120200             STRING ' DLKUT410 - TEAM DL003-ASGMT-NBR-TXT:'       12020000
120300                      DL003-ASGMT-NBR-TXT   '  '                  12030000
120400                    ' ASGMT DL004-ASGMT-NBR-TXT:'                 12040000
120500                      DL004-ASGMT-NBR-TXT '  '                    12050000
120600                                             DELIMITED BY SIZE    12060000
120700                                           INTO PV-MSG-AREA2      12070000
120800             PERFORM 9200-WRITE-TO-LOG                            12080000
120900                                                                  12090000
121000             MOVE SPACES TO PV-MSG-AREA2                          12100000
121100             MOVE DL003-ASGMT-NBR-SEQ-NBR TO PV-DISP-ASGMT1       12110000
121200             MOVE DL004-ASGMT-NBR-SEQ-NBR TO PV-DISP-ASGMT2       12120000
121300             STRING ' DLKUT410 - TEAM DL003-ASGMT-NBR-SEQ-NBR:'   12130000
121400                      PV-DISP-ASGMT1                              12140000
121500                    ' ASGMT DL003-ASGMT-NBR-SEQ-NBR:'             12150000
121600                      PV-DISP-ASGMT2                              12160000
121700                                             DELIMITED BY SIZE    12170000
121800                                           INTO PV-MSG-AREA2      12180000
121900             PERFORM 9200-WRITE-TO-LOG                            12190000
122000     END-EVALUATE.                                                12200000
122100                                                                  12210000
122200                                                                  12220000
122300*-----------------------------------------------------------------12230000
122400*  CALL DLKUP026 TO CREATE A NEW ASSIGNMENT AND ATTACH THE       *12240000
122500*  ASSOCIATE TO THE ASSIGNMENT.                                  *12250000
122600*-----------------------------------------------------------------12260000
122700 6400-CALL-DLKUP026.                                              12270000
122800                                                                  12280000
122900     IF KRPRPM-FUNC-TXT = 'Y'                                     12290000
122910         DISPLAY ' DLKUT410 START 6400- PARA '                    12291000
122911                 ' PS-ERROR-SW:'    PS-ERROR-SW                   12291104
122920     END-IF.                                                      12292000
122930                                                                  12293000
122940                                                                  12294000
122950     CALL DL022-USER-PGM USING DL022-ASGMT-COMMAREA.              12295000
122960                                                                  12296000
122970     EVALUATE TRUE                                                12297000
122980         WHEN DL022-SUCCESSFUL                                    12298000
122990             CONTINUE                                             12299000
123000         WHEN OTHER                                               12300000
123100             SET PS-CALLED-MODULE-ERROR TO TRUE                   12310000
123200             MOVE SPACES TO PV-MSG-AREA2                          12320000
123300             STRING ' DLKUT410 - '           DELIMITED BY SIZE    12330000
123400                    'CALLED MODULE FAILED'   DELIMITED BY SIZE    12340000
123500                                           INTO PV-MSG-AREA2      12350000
123600             PERFORM 9200-WRITE-TO-LOG                            12360000
123700             MOVE SPACES TO PV-MSG-AREA2                          12370000
123800             MOVE '6400-CALL-DLKUP026' TO PV-MODULE-PARAGRAPH     12380000
123900             STRING ' DLKUT410 - '           DELIMITED BY SIZE    12390000
124000                    PV-MODULE-FAIL-MSG       DELIMITED BY SIZE    12400000
124100                    ' WITH RETURN CODE - '   DELIMITED BY SIZE    12410000
124200                    DL022-RETURN-CODE        DELIMITED BY SIZE    12420000
124300                                           INTO PV-MSG-AREA2      12430000
124400             PERFORM 9200-WRITE-TO-LOG                            12440000
124500     END-EVALUATE.                                                12450000
124600                                                                  12460000
124700                                                                  12470000
124800*-----------------------------------------------------------------12480000
124900*  CALL XLKUT107 TO LOG AN INDIRECT SYSTEM MOVE TO THE EAI       *12490000
125000*  BUSINESS EVENT TABLES.                                        *12500000
125100*-----------------------------------------------------------------12510000
125200 6500-CALL-XLKUT107.                                              12520000
125300                                                                  12530000
125400     IF KRPRPM-FUNC-TXT = 'Y'                                     12540000
125500         DISPLAY ' DLKUT410 START 6500- PARA '                    12550000
125510                 ' PS-ERROR-SW:'    PS-ERROR-SW                   12551004
125600     END-IF.                                                      12560000
125700                                                                  12570000
125800                                                                  12580000
125900     CALL XL091-USER-PGM USING XL091-EAI-EXPORT-COMMAREA.         12590000
126000                                                                  12600000
126100     EVALUATE TRUE                                                12610000
126200         WHEN XL091-SUCCESSFUL                                    12620000
126300             CONTINUE                                             12630000
126400         WHEN OTHER                                               12640000
126500             SET PS-CALLED-MODULE-ERROR TO TRUE                   12650000
126600             MOVE SPACES TO PV-MSG-AREA2                          12660000
126700             STRING ' DLKUT410 - '           DELIMITED BY SIZE    12670000
126800                    'CALLED MODULE FAILED'   DELIMITED BY SIZE    12680000
126900                                           INTO PV-MSG-AREA2      12690000
127000             PERFORM 9200-WRITE-TO-LOG                            12700000
127100             MOVE SPACES TO PV-MSG-AREA2                          12710000
127200             MOVE '6500-CALL-XLKUT107' TO PV-MODULE-PARAGRAPH     12720000
127300             STRING ' DLKUT410 - '           DELIMITED BY SIZE    12730000
127400                    PV-MODULE-FAIL-MSG       DELIMITED BY SIZE    12740000
127500                    ' WITH RETURN CODE - '   DELIMITED BY SIZE    12750000
127600                    XL091-RETURN-CODE        DELIMITED BY SIZE    12760000
127700                                           INTO PV-MSG-AREA2      12770000
127800             PERFORM 9200-WRITE-TO-LOG                            12780000
127900     END-EVALUATE.                                                12790000
128000                                                                  12800000
128001                                                                  12800100
128002*-----------------------------------------------------------------12800200
128003*  THIS WILL CONTROL THE PROCESS TO CREATE AN ASSIGNMENT IF      *12800300
128004*  NEEDED AND ALSO ATTACH THE ASSOCIATE TO AN ASSIGNMENT         *12800400
128005*  THIS IS ONLY DONE IF ASSIGNMENT WAS CLOSED AFTER AQUIRING IT  *12800500
128006*  IN PARAGRAPH 2000.                                            *12800600
128007* ADDED PARAGRAPH 10/18/2007 - DMH                                12800700
128008*---------------------------------------------------------------- 12800800
128009 6600-ESTABLISH-ASGMT-2.                                          12800900
128010                                                                  12801000
128020     IF KRPRPM-FUNC-TXT = 'Y'                                     12802000
128030         DISPLAY ' DLKUT410 START 6600- PARA '                    12803000
128031                 ' PS-ERROR-SW:'    PS-ERROR-SW                   12803104
128040     END-IF.                                                      12804000
128050                                                                  12805000
128060                                                                  12806000
128070     PERFORM 2200-CHECK-FOR-ASGMT.                                12807000
128080                                                                  12808000
128090     PERFORM 2400-CHECK-FOR-USR-ON-ASGMT.                         12809000
128091                                                                  12809100
128092     IF  DL004-ASGMT-FOUND                                        12809200
128093     AND DL003-ASGMT-FOUND                                        12809300
128094         SET PS-ASGMTS-DO-NOT-MATCH  TO TRUE                      12809400
128095         PERFORM 2020-COMPARE-ASGMTS                              12809500
128096         IF  PS-ASGMTS-MATCH                                      12809600
128097             SET DL019-SUCCESSFUL             TO TRUE             12809700
128098             SET DL019-ESO-EXIST-ASGMT-FOUND  TO TRUE             12809800
128099             SET DL019-ESO-EMP-EXIST-ON-ASGMT TO TRUE             12809900
128100             MOVE DL003-ASGMT-START-DTE       TO                  12810000
128101                                      DL019-ESO-ASGMT-START-DTE   12810100
128102             MOVE DL003-ASGMT-NBR-TXT         TO                  12810200
128103                                      DL019-ESO-ASGMT-NBR-TXT     12810300
128104             MOVE DL003-ASGMT-NBR-SEQ-NBR     TO                  12810400
128105                                      DL019-ESO-ASGMT-NBR-SEQ-NBR 12810500
128106             PERFORM 9000-RETURN-CALL                             12810600
128107         ELSE                                                     12810700
128108             MOVE DL003-ASGMT-START-DTE       TO                  12810800
128109                                      PV-HOLD-ASGMT-START-DTE     12810900
128110             MOVE DL003-ASGMT-NBR-TXT         TO                  12811000
128111                                      PV-HOLD-ASGMT-NBR-TXT       12811100
128112             MOVE DL003-ASGMT-NBR-SEQ-NBR     TO                  12811200
128113                                      PV-HOLD-ASGMT-NBR-SEQ-NBR   12811300
128114             MOVE DL003-TEM-ASGMT-SEQ-NBR     TO                  12811400
128115                                      PV-HOLD-TEM-ASGMT-SEQ-NBR   12811500
128116             PERFORM 6610-END-FROM-ASGMT                          12811600
128117             IF  DL021-ASSOC-FOUND                                12811700
128118                 PERFORM 3200-GENERATE-S-MOVE                     12811800
128119             END-IF                                               12811900
128120             MOVE DL004-ASGMT-START-DTE       TO                  12812000
128121                                      PV-HOLD-ASGMT-START-DTE     12812100
128122             MOVE DL004-ASGMT-NBR-TXT         TO                  12812200
128123                                      PV-HOLD-ASGMT-NBR-TXT       12812300
128124             MOVE DL004-ASGMT-NBR-SEQ-NBR     TO                  12812400
128125                                      PV-HOLD-ASGMT-NBR-SEQ-NBR   12812500
128126             PERFORM 6620-ADD-TO-ASGMT                            12812600
128127             SET DL019-SUCCESSFUL             TO TRUE             12812700
128128             SET DL019-ESO-EXIST-ASGMT-FOUND  TO TRUE             12812800
128129             SET DL019-ESO-EMP-ENDADD-ASGMT   TO TRUE             12812900
128130             MOVE DL004-ASGMT-START-DTE       TO                  12813000
128131                                      DL019-ESO-ASGMT-START-DTE   12813100
128132             MOVE DL004-ASGMT-NBR-TXT         TO                  12813200
128133                                      DL019-ESO-ASGMT-NBR-TXT     12813300
128134             MOVE DL004-ASGMT-NBR-SEQ-NBR     TO                  12813400
128135                                      DL019-ESO-ASGMT-NBR-SEQ-NBR 12813500
128136             PERFORM 9000-RETURN-CALL                             12813600
128137         END-IF                                                   12813700
128138     ELSE                                                         12813800
128139         IF  DL004-ASGMT-FOUND                                    12813900
128140             MOVE DL004-ASGMT-START-DTE       TO                  12814000
128141                                      PV-HOLD-ASGMT-START-DTE     12814100
128142             MOVE DL004-ASGMT-NBR-TXT         TO                  12814200
128143                                      PV-HOLD-ASGMT-NBR-TXT       12814300
128144             MOVE DL004-ASGMT-NBR-SEQ-NBR     TO                  12814400
128145                                      PV-HOLD-ASGMT-NBR-SEQ-NBR   12814500
128146             PERFORM 6620-ADD-TO-ASGMT                            12814600
128147             SET DL019-SUCCESSFUL             TO TRUE             12814700
128148             SET DL019-ESO-EXIST-ASGMT-FOUND  TO TRUE             12814800
128149             SET DL019-ESO-EMP-NEW-TO-ASGMT   TO TRUE             12814900
128150             MOVE DL004-ASGMT-START-DTE       TO                  12815000
128151                                      DL019-ESO-ASGMT-START-DTE   12815100
128152             MOVE DL004-ASGMT-NBR-TXT         TO                  12815200
128153                                      DL019-ESO-ASGMT-NBR-TXT     12815300
128154             MOVE DL004-ASGMT-NBR-SEQ-NBR     TO                  12815400
128155                                      DL019-ESO-ASGMT-NBR-SEQ-NBR 12815500
128156             PERFORM 9000-RETURN-CALL                             12815600
128157         ELSE                                                     12815700
128158             IF  DL003-ASGMT-FOUND                                12815800
128159                 MOVE DL003-ASGMT-START-DTE   TO                  12815900
128160                                      PV-HOLD-ASGMT-START-DTE     12816000
128161                 MOVE DL003-ASGMT-NBR-TXT     TO                  12816100
128162                                      PV-HOLD-ASGMT-NBR-TXT       12816200
128163                 MOVE DL003-ASGMT-NBR-SEQ-NBR TO                  12816300
128164                                      PV-HOLD-ASGMT-NBR-SEQ-NBR   12816400
128165                 MOVE DL003-TEM-ASGMT-SEQ-NBR TO                  12816500
128166                                      PV-HOLD-TEM-ASGMT-SEQ-NBR   12816600
128167                 PERFORM 6610-END-FROM-ASGMT                      12816700
128168                 IF  DL021-ASSOC-FOUND                            12816800
128169                     PERFORM 3200-GENERATE-S-MOVE                 12816900
128170                 END-IF                                           12817000
128171                 PERFORM 3000-CREATE-NEW-ASGMT                    12817100
128172                 SET DL019-SUCCESSFUL           TO TRUE           12817200
128173                 SET DL019-ESO-NEW-ASGMT-CREATE TO TRUE           12817300
128174                 SET DL019-ESO-EMP-ENDADD-ASGMT TO TRUE           12817400
128175                 MOVE DL022-NEW-START-DTE       TO                12817500
128176                                      DL019-ESO-ASGMT-START-DTE   12817600
128177                 MOVE DL022-NEW-NBR-TXT         TO                12817700
128178                                      DL019-ESO-ASGMT-NBR-TXT     12817800
128179                 MOVE DL022-NEW-ASGMT-NBR-SEQ-NBR TO              12817900
128180                                      DL019-ESO-ASGMT-NBR-SEQ-NBR 12818000
128181                 PERFORM 9000-RETURN-CALL                         12818100
128182             ELSE                                                 12818200
128183                 PERFORM 3000-CREATE-NEW-ASGMT                    12818300
128184                 SET DL019-SUCCESSFUL           TO TRUE           12818400
128185                 SET DL019-ESO-NEW-ASGMT-CREATE TO TRUE           12818500
128186                 SET DL019-ESO-EMP-NEW-TO-ASGMT TO TRUE           12818600
128187                 MOVE DL022-NEW-START-DTE       TO                12818700
128188                                      DL019-ESO-ASGMT-START-DTE   12818800
128189                 MOVE DL022-NEW-NBR-TXT         TO                12818900
128190                                      DL019-ESO-ASGMT-NBR-TXT     12819000
128191                 MOVE DL022-NEW-ASGMT-NBR-SEQ-NBR TO              12819100
128192                                      DL019-ESO-ASGMT-NBR-SEQ-NBR 12819200
128193                 PERFORM 9000-RETURN-CALL                         12819300
128194             END-IF                                               12819400
128195         END-IF                                                   12819500
128196     END-IF.                                                      12819600
128197                                                                  12819700
128198                                                                  12819800
128199*---------------------------------------------------------------- 12819900
128200*   THE FOLLOWING IS TO PROCESS THE CALL TO DLKUP025 TO           12820000
128201*   END ASSOCIATE FROM AN ASSIGNMENT                              12820100
128202*  THIS IS ONLY DONE IF ASSIGNMENT WAS CLOSED AFTER AQUIRING IT  *12820200
128203*  IN PARAGRAPH 2000.                                            *12820300
128204* ADDED PARAGRAPH 10/18/2007 - DMH                                12820400
128205*---------------------------------------------------------------- 12820500
128206 6610-END-FROM-ASGMT.                                             12820600
128207                                                                  12820700
128208     IF KRPRPM-FUNC-TXT = 'Y'                                     12820800
128209         DISPLAY ' DLKUT410 START 6610- PARA '                    12820900
128210                 ' PS-ERROR-SW:'    PS-ERROR-SW                   12821004
128211     END-IF.                                                      12821100
128212                                                                  12821200
128213                                                                  12821300
128214     INITIALIZE DL021-ASGMT-COMMAREA.                             12821400
128215                                                                  12821500
128216     MOVE PV-HOLD-ASGMT-START-DTE TO DL021-KEY-START-DTE.         12821600
128217     MOVE PV-HOLD-ASGMT-NBR-TXT TO DL021-KEY-NBR-TXT.             12821700
128218     MOVE PV-HOLD-ASGMT-NBR-SEQ-NBR TO DL021-KEY-NBR-SEQ-NBR.     12821800
128219     MOVE PV-HOLD-TEM-ASGMT-SEQ-NBR TO                            12821900
128220                            DL021-KEY-TEM-ASGMT-SEQ-NBR.          12822000
128221     MOVE PV-HOLD-USR-ID TO DL021-KEY-ADD-BY-USER-ID              12822100
128222                            DL021-KEY-USER-ID.                    12822200
128223     MOVE PV-HOLD-USR-TYP-CDE TO DL021-KEY-USR-TYPE-CDE.          12822300
128224     MOVE PC-CURRENT-PROGRAM-NAME TO DL021-KEY-LVE-PGM-NM.        12822400
128225     MOVE DL019-CALLING-PGM-NM TO DL021-ORIG-CALLING-PGM-NM.      12822500
128226                                                                  12822600
128227     SET DL021-BY-ASGMT-NBR TO TRUE.                              12822700
128228     SET DL021-END-FROM-ASGMT TO TRUE.                            12822800
128229     SET DL021-COMMIT-UPDATE TO TRUE.                             12822900
128230     SET DL021-KEY-LVE-RSN-SMOVE TO TRUE.                         12823000
128231     SET PS-NO-CALLED-MODULE-ERROR TO TRUE.                       12823100
128232     MOVE ' END ' TO PV-DISPLAY-TEXT.                             12823200
128233                                                                  12823300
128234     PERFORM 6650-CALL-DLKUP025.                                  12823400
128235                                                                  12823500
128236     IF  PS-CALLED-MODULE-ERROR                                   12823600
128237         SET PS-ERROR TO TRUE                                     12823700
128238         MOVE 'DLKUP025' TO DL019-CALL-MOD-FAIL-NM                12823800
128239         MOVE DL021-SQL-ERROR-PARA                                12823900
128240                                TO DL019-CALL-MOD-FAIL-SQL-PARA   12824000
128241         MOVE DL021-RETURN-CODE TO DL019-CALL-MOD-FAIL-ERR-CDE    12824100
128242         SET DL019-CALLED-MODULE-FAILURE TO TRUE                  12824200
128243         IF  DL021-SQL-ERROR                                      12824300
128244             MOVE DL021-ASGMT-SQLCODE TO                          12824400
128245                  DL019-CALL-MOD-FAIL-SQL-CDE                     12824500
128246             MOVE DL021-SQL-ERROR-PARA TO                         12824600
128247                  DL019-CALL-MOD-FAIL-SQL-PARA                    12824700
128248         END-IF                                                   12824800
128249         PERFORM 9000-RETURN-CALL                                 12824900
128250     END-IF.                                                      12825000
128251                                                                  12825100
128252                                                                  12825200
128253*---------------------------------------------------------------- 12825300
128254*   THE FOLLOWING IS TO PROCESS THE CALL TO DLKUP025 TO           12825400
128255*   ADD ASSOCIATE TO AN ASSIGNMENT                                12825500
128256*  THIS IS ONLY DONE IF ASSIGNMENT WAS CLOSED AFTER AQUIRING IT  *12825600
128257*  IN PARAGRAPH 2000.                                            *12825700
128258* ADDED PARAGRAPH 10/18/2007 - DMH                                12825800
128259*---------------------------------------------------------------- 12825900
128260 6620-ADD-TO-ASGMT.                                               12826000
128261                                                                  12826100
128262     IF KRPRPM-FUNC-TXT = 'Y'                                     12826200
128263         DISPLAY ' DLKUT410 START 6620- PARA '                    12826300
128264                 ' PS-ERROR-SW:'    PS-ERROR-SW                   12826404
128265     END-IF.                                                      12826500
128266                                                                  12826600
128267                                                                  12826700
128268     INITIALIZE DL021-ASGMT-COMMAREA.                             12826800
128269                                                                  12826900
128270     MOVE PV-HOLD-ASGMT-START-DTE TO DL021-KEY-START-DTE.         12827000
128271     MOVE PV-HOLD-ASGMT-NBR-TXT TO DL021-KEY-NBR-TXT.             12827100
128272     MOVE PV-HOLD-ASGMT-NBR-SEQ-NBR TO DL021-KEY-NBR-SEQ-NBR.     12827200
128273     MOVE PV-HOLD-USR-ID TO DL021-KEY-ADD-BY-USER-ID              12827300
128274                            DL021-KEY-USER-ID.                    12827400
128275     MOVE PV-HOLD-USR-TYP-CDE TO DL021-KEY-USR-TYPE-CDE.          12827500
128276     MOVE PC-CURRENT-PROGRAM-NAME TO DL021-KEY-LVE-PGM-NM.        12827600
128277     MOVE DL019-CALLING-PGM-NM TO                                 12827700
128278          DL021-ORIG-CALLING-PGM-NM.                              12827800
128279                                                                  12827900
128280     SET DL021-BY-ASGMT-NBR TO TRUE.                              12828000
128281     SET DL021-ADD-TO-ASGMT TO TRUE.                              12828100
128282     SET DL021-COMMIT-UPDATE TO TRUE.                             12828200
128283     SET PS-NO-CALLED-MODULE-ERROR TO TRUE.                       12828300
128284     MOVE ' ADD ' TO PV-DISPLAY-TEXT.                             12828400
128285                                                                  12828500
128286     PERFORM 6650-CALL-DLKUP025.                                  12828600
128287                                                                  12828700
128288     IF  PS-CALLED-MODULE-ERROR                                   12828800
128289         SET PS-ERROR TO TRUE                                     12828900
128290         MOVE 'DLKUP025' TO DL019-CALL-MOD-FAIL-NM                12829000
128291         MOVE DL021-SQL-ERROR-PARA                                12829100
128292                                TO DL019-CALL-MOD-FAIL-SQL-PARA   12829200
128293         MOVE DL021-RETURN-CODE TO DL019-CALL-MOD-FAIL-ERR-CDE    12829300
128294         SET DL019-CALLED-MODULE-FAILURE TO TRUE                  12829400
128295         IF  DL021-SQL-ERROR                                      12829500
128296             MOVE DL021-ASGMT-SQLCODE TO                          12829600
128297                  DL019-CALL-MOD-FAIL-SQL-CDE                     12829700
128298             MOVE DL021-SQL-ERROR-PARA TO                         12829800
128299                  DL019-CALL-MOD-FAIL-SQL-PARA                    12829900
128300         END-IF                                                   12830000
128301         PERFORM 9000-RETURN-CALL                                 12830100
128302     END-IF.                                                      12830200
128303                                                                  12830300
128304                                                                  12830400
128305*-----------------------------------------------------------------12830500
128306*  CALL DLKUP025 TO EITHER END THE ASSOCIATE FORM AN ASSIGNMENT  *12830600
128307*  OR ADD THE ASSOCIATE TO AN ASSIGNMENT.                        *12830700
128308*  THIS IS ONLY DONE IF ASSIGNMENT WAS CLOSED AFTER AQUIRING IT  *12830800
128309*  IN PARAGRAPH 2000.                                            *12830900
128310* ADDED PARAGRAPH 10/18/2007 - DMH                                12831000
128311*-----------------------------------------------------------------12831100
128312 6650-CALL-DLKUP025.                                              12831200
128313                                                                  12831300
128314     IF KRPRPM-FUNC-TXT = 'Y'                                     12831400
128315         DISPLAY ' DLKUT410 START 6650- PARA '                    12831500
128316                 ' PS-ERROR-SW:'    PS-ERROR-SW                   12831604
128317     END-IF.                                                      12831700
128318                                                                  12831800
128319                                                                  12831900
128320     CALL DL021-USER-PGM USING DL021-ASGMT-COMMAREA.              12832000
128321                                                                  12832100
128322     EVALUATE TRUE                                                12832200
128323         WHEN DL021-SUCCESSFUL                                    12832300
128324             CONTINUE                                             12832400
128325         WHEN OTHER                                               12832500
128326             SET PS-CALLED-MODULE-ERROR TO TRUE                   12832600
128327             MOVE SPACES TO PV-MSG-AREA2                          12832700
128328             STRING ' DLKUT410 - '           DELIMITED BY SIZE    12832800
128329                    'CALLED MODULE FAILED'   DELIMITED BY SIZE    12832900
128330                                           INTO PV-MSG-AREA2      12833000
128331             PERFORM 9200-WRITE-TO-LOG                            12833100
128332             MOVE SPACES TO PV-MSG-AREA2                          12833200
128333             MOVE '6650-CALL-DLKUP025' TO PV-MODULE-PARAGRAPH     12833300
128334             STRING ' DLKUT410 - '           DELIMITED BY SIZE    12833400
128335                    PV-MODULE-FAIL-MSG       DELIMITED BY SIZE    12833500
128336                    ' TO '                   DELIMITED BY SIZE    12833600
128337                    PV-DISPLAY-TEXT          DELIMITED BY SIZE    12833700
128338                    ' ASSIGNMENT'            DELIMITED BY SIZE    12833800
128339                    ' WITH RETURN CODE - '   DELIMITED BY SIZE    12833900
128340                    DL021-RETURN-CODE        DELIMITED BY SIZE    12834000
128341                                           INTO PV-MSG-AREA2      12834100
128342             PERFORM 9200-WRITE-TO-LOG                            12834200
128343             MOVE SPACES TO PV-MSG-AREA2                          12834300
128344             STRING ' DLKUT410: ASGMT DL004-ASGMT-FOUND-CODE:'    12834400
128345                      DL004-ASGMT-FOUND-CODE                      12834500
128346                      '  '                                        12834600
128347                    'TEAM DL003-ASGMT-FOUND-CODE:'                12834700
128348                     DL003-ASGMT-FOUND-CODE                       12834800
128349                                             DELIMITED BY SIZE    12834900
128350                                           INTO PV-MSG-AREA2      12835000
128351             PERFORM 9200-WRITE-TO-LOG                            12835100
128352             MOVE SPACES TO PV-MSG-AREA2                          12835200
128353             STRING ' DLKUT410 - TEAM DL003-ASGMT-START-DTE:'     12835300
128354                      DL003-ASGMT-START-DTE '  '                  12835400
128355                    ' ASGMT DL004-ASGMT-START-DTE:'               12835500
128356                      DL004-ASGMT-START-DTE '  '                  12835600
128357                                             DELIMITED BY SIZE    12835700
128358                                           INTO PV-MSG-AREA2      12835800
128359             PERFORM 9200-WRITE-TO-LOG                            12835900
128360                                                                  12836000
128361             MOVE SPACES TO PV-MSG-AREA2                          12836100
128362             STRING ' DLKUT410 - TEAM DL003-ASGMT-NBR-TXT:'       12836200
128363                      DL003-ASGMT-NBR-TXT   '  '                  12836300
128364                    ' ASGMT DL004-ASGMT-NBR-TXT:'                 12836400
128365                      DL004-ASGMT-NBR-TXT '  '                    12836500
128366                                             DELIMITED BY SIZE    12836600
128367                                           INTO PV-MSG-AREA2      12836700
128368             PERFORM 9200-WRITE-TO-LOG                            12836800
128369                                                                  12836900
128370             MOVE SPACES TO PV-MSG-AREA2                          12837000
128371             MOVE DL003-ASGMT-NBR-SEQ-NBR TO PV-DISP-ASGMT1       12837100
128372             MOVE DL004-ASGMT-NBR-SEQ-NBR TO PV-DISP-ASGMT2       12837200
128373             STRING ' DLKUT410 - TEAM DL003-ASGMT-NBR-SEQ-NBR:'   12837300
128374                      PV-DISP-ASGMT1                              12837400
128375                    ' ASGMT DL004-ASGMT-NBR-SEQ-NBR:'             12837500
128376                      PV-DISP-ASGMT2                              12837600
128377                                             DELIMITED BY SIZE    12837700
128378                                           INTO PV-MSG-AREA2      12837800
128379             PERFORM 9200-WRITE-TO-LOG                            12837900
128380     END-EVALUATE.                                                12838000
128381                                                                  12838100
128382                                                                  12838200
128383*---------------------------------------------------------------- 12838300
128384*                                                               - 12838400
128385*---------------------------------------------------------------- 12838500
128386 7000-SELECT-RDPR-USR.                                            12838600
128387                                                                  12838700
128388     IF KRPRPM-FUNC-TXT = 'Y'                                     12838800
128389         MOVE PV-LOC-NBR  TO  PV-DISP-LOC-NBR                     12838900
128390         DISPLAY ' DLKUT410 START 7000- PARA '                    12839000
128391                 ' USER:' DL019-EAI-CRE-BY-USR-ID                 12839100
128392                 ' OPER:' PV-DISP-LOC-NBR                         12839200
128393                 ' SW:'   PS-CREATE-NEW-USER-SW                   12839300
128394                 ' PS-ERROR-SW:'    PS-ERROR-SW                   12839404
128395     END-IF.                                                      12839500
128396                                                                  12839600
128397                                                                  12839700
128398*    IF THE USER HAS NEVER BEEN A PART OF AN ASSIGNMENT,HE IS NEW 12839800
128399                                                                  12839900
128400     SET  PS-CREATE-NEW-USER-NO  TO  TRUE.                        12840000
128401                                                                  12840100
128402     MOVE DL019-EAI-CRE-BY-USR-ID  TO  DLT00009-USR-ID.           12840200
128403     MOVE PV-LOC-NBR               TO  DLT00009-LOC-NBR.          12840300
128410                                                                  12841000
128500     EXEC SQL                                                     12850000
128600     SELECT  CRE_TMST                                             12860000
128700     INTO   :DLT00009-CRE-TMST                                    12870000
128800     FROM                                                         12880000
128900         DLT_RDPR_USR_LSTG                                        12890000
129000     WHERE                                                        12900000
129100               USR_ID = :DLT00009-USR-ID                          12910000
129200          AND LOC_NBR = :DLT00009-LOC-NBR                         12920000
129300     END-EXEC.                                                    12930000
129400                                                                  12940000
129500     EVALUATE TRUE                                                12950000
129600     WHEN SQLCODE = ZERO                                          12960000
129700     WHEN SQLCODE = -811                                          12970000
129800         SET  PS-CREATE-NEW-USER-NO                               12980000
129900              DL019-SUCCESSFUL        TO  TRUE                    12990000
130000                                                                  13000000
130100         IF  KRPRPM-FUNC-TXT = 'Y'                                13010000
130200             MOVE  PV-LOC-NBR  TO  PV-DISP-LOC-NBR                13020000
130300             DISPLAY ' DLKUT410 START 7000- PARA '                13030000
130310                     ' USER:' DL019-EAI-CRE-BY-USR-ID             13031000
130320                     ' OPER:' PV-DISP-LOC-NBR                     13032000
130330                     ' SW:'   PS-CREATE-NEW-USER-SW               13033000
130340         END-IF                                                   13034000
130350                                                                  13035000
130360     WHEN SQLCODE = +100                                          13036000
130370         SET  PS-CREATE-NEW-USER-YES                              13037000
130380              DL019-SUCCESSFUL        TO  TRUE                    13038000
130390                                                                  13039000
130400         MOVE     PV-LOC-NBR  TO  PV-DISP-LOC-NBR                 13040000
130500         DISPLAY 'NEW ASSOCIATE ADD '                             13050000
130600                 'DL019-EAI-CRE-BY-USR-ID:'                       13060000
130700                  DL019-EAI-CRE-BY-USR-ID  '  '                   13070000
130800                 'PV-LOC-NBR:' PV-DISP-LOC-NBR                    13080000
130900                                                                  13090000
131000         IF  KRPRPM-FUNC-TXT = 'Y'                                13100000
131100             MOVE  PV-LOC-NBR  TO  PV-DISP-LOC-NBR                13110000
131200             DISPLAY ' DLKUT410 START 7000- PARA '                13120000
131210                     ' USER:' DL019-EAI-CRE-BY-USR-ID             13121000
131220                     ' OPER:' PV-DISP-LOC-NBR                     13122000
131230                     ' SW:'   PS-CREATE-NEW-USER-SW               13123000
131240         END-IF                                                   13124000
131250                                                                  13125000
131260     WHEN SQLCODE = -911                                          13126000
131270     WHEN SQLCODE = -913                                          13127000
131280     WHEN SQLCODE = -904                                          13128000
131290         SET PS-ERROR                                             13129000
131300             DL019-SQL-ERROR                                      13130000
131400             DL019-ASGMT-CONTENTION   TO TRUE                     13140000
131500         MOVE SQLCA                   TO DL019-SQLCA              13150000
131600         MOVE SQLCODE                 TO DL019-ASGMT-SQLCODE      13160000
131700     WHEN OTHER                                                   13170000
131800         SET PS-ERROR                                             13180000
131900             DL019-SQL-ERROR          TO TRUE                     13190000
132000         MOVE SQLCA                   TO DL019-SQLCA              13200000
132100         MOVE SQLCODE                 TO DL019-ASGMT-SQLCODE      13210000
132200     END-EVALUATE.                                                13220000
132300/                                                                 13230000
132400 7030-SELECT-TKRPRPM.                                             13240000
132500                                                                  13250000
132600     MOVE 90                          TO KRPRPM-LOC-ID.           13260000
132700                                                                  13270000
132800     EXEC SQL                                                     13280000
132810         SELECT FUNC_TXT                                          13281000
132820         INTO :KRPRPM-FUNC-TXT                                    13282000
132830         FROM                                                     13283000
132840             TKRPRPM                                              13284000
132850         WHERE                                                    13285000
132860             LOC_ID                   = :KRPRPM-LOC-ID            13286000
132870         AND INTFC_SYS_CDE            = 'DLX'                     13287000
132880         AND SYS_PRC_FUNC_CDE         = 'DLPLDI'                  13288000
132890         AND CURRENT TIMESTAMP BETWEEN                            13289000
132891             FUNC_BEG_TMST AND FUNC_END_TMST                      13289100
132892         WITH UR                                                  13289200
132893     END-EXEC.                                                    13289300
132894                                                                  13289400
132895     EVALUATE TRUE                                                13289500
132896         WHEN SQLCODE = ZERO                                      13289600
132897             CONTINUE                                             13289700
132898                                                                  13289800
132899         WHEN OTHER                                               13289900
132900                                                                  13290000
132901             MOVE SQLCODE             TO  PV-DISP-SQLCODE         13290100
132902             MOVE KRPRPM-LOC-ID       TO  PV-DISP-OPER            13290200
132903             DISPLAY ' DLKUT410 - 7030 - '                        13290300
132904                     ' SQLCODE: '         PV-DISP-SQLCODE         13290400
132905                     ' TKRPRPM - OPER 90 - DLPLDI'                13290500
132906             DISPLAY ' DLKUT410 - 7030 - '                        13290600
132907                       DL019-EST-ASGMT-INPUT-FIELDS               13290700
132908                                                                  13290800
132909     END-EVALUATE.                                                13290900
132910                                                                  13291000
132920*----------------------------------------------------------------*13292000
132930*  CHECK IF ASSOCIATE IS KOHLS - GET NAME                        *13293000
132940*----------------------------------------------------------------*13294000
132950 7100-CHECK-KOHLS-ASSOC.                                          13295000
132960                                                                  13296000
132970     IF KRPRPM-FUNC-TXT = 'Y'                                     13297000
132980         DISPLAY ' DLKUT410 START 7100- PARA '                    13298000
132981                 ' PS-ERROR-SW:'    PS-ERROR-SW                   13298104
132990     END-IF.                                                      13299000
133000                                                                  13300000
133100                                                                  13310000
133200     MOVE SPACE           TO  PS-USER-FOUND-SW.                   13320000
133300     MOVE PV-HOLD-USR-ID  TO  XLT00024-USR-ID.                    13330000
133400                                                                  13340000
133500     EXEC SQL                                                     13350000
133600         SELECT  USR_LAST_NM                                      13360000
133700               , USR_FRST_NM                                      13370000
133800           INTO  :PV-USR-LAST-NM                                  13380000
133900               , :PV-USR-FRST-NM                                  13390000
134000           FROM   XLT_USR    USR                                  13400000
134100          WHERE  USR.USR_ID       = :XLT00024-USR-ID              13410000
134200           WITH UR                                                13420000
134300     END-EXEC.                                                    13430000
134400                                                                  13440000
134500     EVALUATE TRUE                                                13450000
134600         WHEN SQLCODE = ZERO                                      13460000
134700              SET  PS-USER-IS-KOHLS   TO TRUE                     13470000
134800              DISPLAY ' DLKUT410 - 7100 - '                       13480000
134900                       XLT00024-USR-ID                            13490000
135000                       ' IS A KOHLS ASSOCIATE'                    13500000
135010                                                                  13501000
135020         WHEN SQLCODE = +100                                      13502000
135030             PERFORM 7105-TEMP-USER                               13503000
135040                                                                  13504000
135050         WHEN SQLCODE = -904                                      13505000
135060         WHEN SQLCODE = -911                                      13506000
135070         WHEN SQLCODE = -913                                      13507000
135080         WHEN SQLWARN0 NOT = SPACES                               13508000
135090              AND SQLCODE NOT = ZERO                              13509000
135100                                                                  13510000
135200             SET PS-ERROR                                         13520000
135300                 DL019-SQL-ERROR                                  13530000
135400                 DL019-ASGMT-CONTENTION                           13540000
135500                 PS-CALLED-MODULE-ERROR   TO TRUE                 13550000
135600             MOVE SQLCA                   TO DL019-SQLCA          13560000
135700             MOVE SQLCODE                 TO DL019-ASGMT-SQLCODE  13570000
135800             MOVE '7100'        TO  DL019-CALL-MOD-FAIL-SQL-PARA  13580000
135900             MOVE SQLCODE       TO  DL019-CALL-MOD-FAIL-SQL-CDE   13590000
136000                                                                  13600000
136100                                                                  13610000
136200     END-EVALUATE.                                                13620000
136300/                                                                 13630000
136400 7105-TEMP-USER.                                                  13640000
136500                                                                  13650000
136600     IF KRPRPM-FUNC-TXT = 'Y'                                     13660000
136700         DISPLAY ' DLKUT410 START 7105- PARA '                    13670000
136710                 ' PS-ERROR-SW:'    PS-ERROR-SW                   13671004
136800     END-IF.                                                      13680000
136900                                                                  13690000
137000                                                                  13700000
137100     MOVE SPACE           TO  PS-USER-FOUND-SW.                   13710000
137200     MOVE PV-HOLD-USR-ID  TO  DLT00002-TMP-USR-ID.                13720000
137300                                                                  13730000
137400     EXEC SQL                                                     13740000
137500         SELECT  FRST_NM                                          13750000
137600               , LAST_NM                                          13760000
137700          INTO  :PV-USR-FRST-NM                                   13770000
137800               ,:PV-USR-LAST-NM                                   13780000
137900          FROM   DLT_TMP_EMP                                      13790000
138000         WHERE  TMP_USR_ID       = :DLT00002-TMP-USR-ID           13800000
138100          WITH UR                                                 13810000
138200     END-EXEC                                                     13820000
138300                                                                  13830000
138400     EVALUATE TRUE                                                13840000
138500         WHEN SQLCODE = ZERO                                      13850000
138600             SET PS-USER-IS-TEMP  TO  TRUE                        13860000
138700                                                                  13870000
138800              DISPLAY ' DLKUT410 - 7105 - '                       13880000
138900                       DLT00002-TMP-USR-ID                        13890000
138910                       ' IS A TEMP ASSOCIATE'                     13891000
138920                                                                  13892000
138930         WHEN SQLCODE = +100                                      13893000
138940             SET PS-ERROR                                         13894000
138950                 PS-USER-NOT-FOUND  TO  TRUE                      13895000
138960                                                                  13896000
138970              DISPLAY ' DLKUT410 - 7105 - '                       13897000
138980                       DLT00002-TMP-USR-ID                        13898000
138990                       ' IS NOT FOUND'                            13899000
139000                                                                  13900000
139100         WHEN SQLCODE = -904                                      13910000
139200         WHEN SQLCODE = -911                                      13920000
139300         WHEN SQLCODE = -913                                      13930000
139400         WHEN SQLWARN0 NOT = SPACES                               13940000
139500              AND SQLCODE NOT = ZERO                              13950000
139600                                                                  13960000
139700             SET PS-ERROR                                         13970000
139800                 DL019-SQL-ERROR                                  13980000
139900                 DL019-ASGMT-CONTENTION                           13990000
140000                 PS-CALLED-MODULE-ERROR   TO TRUE                 14000000
140100             MOVE SQLCA                   TO DL019-SQLCA          14010000
140200             MOVE SQLCODE                 TO DL019-ASGMT-SQLCODE  14020000
140300             MOVE '7105'        TO  DL019-CALL-MOD-FAIL-SQL-PARA  14030000
140400             MOVE SQLCODE       TO  DL019-CALL-MOD-FAIL-SQL-CDE   14040000
140500                                                                  14050000
140600     END-EVALUATE.                                                14060000
140700*----------------------------------------------------------------*14070000
140800*  PREPARES INFO TO BE RETURNED TO THE 'CALLING' PROGRAM.        *14080000
140900*----------------------------------------------------------------*14090000
141000 9000-RETURN-CALL.                                                14100000
141100                                                                  14110000
141200     IF KRPRPM-FUNC-TXT = 'Y'                                     14120000
141300         DISPLAY ' DLKUT410 START 9000- PARA '                    14130000
141310                 ' PS-ERROR-SW:'    PS-ERROR-SW                   14131004
141400     END-IF.                                                      14140000
141410                                                                  14141000
141420                                                                  14142000
141430     GOBACK.                                                      14143000
141440                                                                  14144000
141450                                                                  14145000
141460 9200-WRITE-TO-LOG.                                               14146000
141470                                                                  14147000
141480     DISPLAY PV-MSG-AREA2.                                        14148000
141490/                                                                 14149000
141500*    COPY DPPD026.                                                14150000
