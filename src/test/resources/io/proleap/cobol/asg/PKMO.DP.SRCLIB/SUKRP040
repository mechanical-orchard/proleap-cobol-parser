000100***************************************************************** 00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300***************************************************************** 00030001
000400 PROGRAM-ID.             SUKRP040.                                00040001
000500 AUTHOR.                 LARRY SCHLEICHER.                        00050001
000600 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00060001
000700 DATE-WRITTEN            APRIL 2005.                              00070001
000800 DATE-COMPILED.                                                   00080001
000900***************************************************************** 00090001
001000*  THIS PROGRAM WILL CREATE THE DAILY CARTONS SCAN BASED        * 00100001
001100*  RECEIVER BY DC REPORT                                        * 00110001
001200***************************************************************** 00120001
001300 ENVIRONMENT DIVISION.                                            00130001
001400***************************************************************** 00140001
001500 CONFIGURATION SECTION.                                           00150001
001600 SOURCE-COMPUTER.        IBM-3090.                                00160001
001700 OBJECT-COMPUTER.        IBM-3090.                                00170001
001800                                                                  00180001
001900 INPUT-OUTPUT SECTION.                                            00190001
002000 FILE-CONTROL.                                                    00200001
002100*                                                                 00210055
002200     SELECT CONTROL-FILE                                          00220055
002300         ASSIGN TO SYSIN.                                         00230055
002400*                                                                 00240001
002500     SELECT REPORT-FILE                                           00250001
002600         ASSIGN TO RPT01.                                         00260001
002700*                                                                 00270001
002800     SELECT OUTPUT-FILE                                           00280046
002900         ASSIGN TO OUT01.                                         00290046
003000*                                                                 00300046
003100***************************************************************** 00310001
003200 DATA DIVISION.                                                   00320001
003300***************************************************************** 00330001
003400 FILE SECTION.                                                    00340001
003500*                                                                 00350001
003600 FD  CONTROL-FILE                                                 00360055
003700     RECORDING MODE IS F                                          00370055
003800     BLOCK CONTAINS 0 RECORDS.                                    00380055
003900 01  CONTROL-RECORD                   PIC X(080).                 00390055
004000                                                                  00400055
004100*                                                                 00410055
004200 FD  REPORT-FILE                                                  00420001
004300     RECORDING MODE IS F                                          00430001
004400     BLOCK CONTAINS 0  RECORDS.                                   00440001
004500 01  REPORT-RECORD                   PIC  X(132).                 00450001
004600*                                                                 00460001
004700 FD  OUTPUT-FILE                                                  00470046
004800     RECORDING MODE IS F                                          00480046
004900     BLOCK CONTAINS 0  RECORDS.                                   00490046
005000 01  OUTPUT-RECORD                   PIC  X(200).                 00500046
005100*                                                                 00510046
005200***************************************************************** 00520001
005300 WORKING-STORAGE SECTION.                                         00530001
005400*                                                                 00540001
005500 01  PROGRAM-SWITCHES.                                            00550001
005600     05  PS-END-P2L-CHECKIN-CURSOR-SW   PIC X(01) VALUE 'N'.      00560018
005700         88  PS-END-P2L-CHECKIN-CURSOR   VALUE 'Y'.               00570018
005800         88  PS-NOT-END-P2L-CHECKIN-CURSOR                        00580018
005900                                         VALUE 'N'.               00590018
006000     05  PS-END-OUTBOUND-CURSOR-SW      PIC X(01) VALUE 'N'.      00600007
006100         88  PS-NOT-END-OUTBOUND-CURSOR  VALUE 'N'.               00610007
006200         88  PS-END-OUTBOUND-CURSOR      VALUE 'Y'.               00620007
006300     05  PS-END-DC-CURSOR-SW            PIC X(01) VALUE 'N'.      00630007
006400         88  PS-NOT-END-DC-CURSOR        VALUE 'N'.               00640007
006500         88  PS-END-DC-CURSOR            VALUE 'Y'.               00650007
006600     05  PS-FIRST-FETCH-SW              PIC X(01) VALUE 'N'.      00660007
006700         88  PS-NOT-FIRST-FETCH          VALUE 'N'.               00670007
006800         88  PS-FIRST-FETCH              VALUE 'Y'.               00680007
006900*                                                                 00690001
007000 01  PV-PROGRAM-CONSTANTS.                                        00700001
007100     05  PC-SUKRP040                 PIC X(08) VALUE  'SUKRP040'. 00710001
007200     05  PC-REPORT-NBR               PIC X(02) VALUE '-1'.        00720001
007300*                                                                 00730001
007400 01  PV-PROGRAM-VARIABLES.                                        00740001
007500     05  PV-CONTROL-REC.                                          00750055
007600         10  PV-CONTROL-DATE         PIC X(10).                   00760055
007700         10  PV-CONTROL-FILLER       PIC X(70).                   00770055
007800     05  PV-DISP-OPER                PIC 9(04).                   00780055
007900     05  PV-DISP-COUNT               PIC 9(09)V99.                00790038
008000     05  PV-PARAGRAPH                PIC X(30) VALUE SPACE.       00800038
008100     05  PV-DB2-FUNCTION             PIC X(30) VALUE SPACE.       00810002
008200     05  PV-PAGE-COUNT               PIC S9(4) VALUE ZERO         00820001
008300                                                   COMP-3.        00830001
008400     05  PV-LINE-COUNT               PIC S9(3) VALUE ZERO         00840001
008500                                                   COMP-3.        00850001
008600     05  PV-MAX-LINE-COUNT           PIC S9(3) VALUE +60          00860001
008700                                                   COMP-3.        00870001
008800     05  PV-OUTBOUND-COUNT           PIC S9(9) COMP.              00880007
008900     05  PV-OUTBOUND-SMO             PIC S9(9) COMP.              00890007
009000     05  PV-OUTBOUND-ASN             PIC S9(9) COMP.              00900001
009100     05  PV-OUTBOUND-CPS             PIC S9(9) COMP.              00910001
009200     05  PV-DISTHD-P2L               PIC S9(9) COMP.              00920001
009300     05  PV-SULBXF-COUNT             PIC S9(9) COMP.              00930018
009400     05  PV-SULBXF-P2L               PIC S9(9) COMP.              00940018
009500     05  PV-TOT-CTNS-RECEIVED        PIC S9(9) COMP.              00950001
009600     05  PV-TOT-CTNS-CHECKIN         PIC S9(9) COMP.              00960001
009700     05  PV-TOT-CTNS-PHYSICAL        PIC S9(9) COMP.              00970001
009800     05  PV-TOT-SML                  PIC S9(9) COMP.              00980001
009900     05  PV-TOT-P2L                  PIC S9(9) COMP.              00990001
010000     05  PV-OUTBOUND-SMO-CORP        PIC S9(9) COMP.              01000001
010100     05  PV-OUTBOUND-ASN-CORP        PIC S9(9) COMP.              01010001
010200     05  PV-OUTBOUND-CPS-CORP        PIC S9(9) COMP.              01020001
010300     05  PV-DISTHD-P2L-CORP          PIC S9(9) COMP.              01030001
010400     05  PV-SULBXF-P2L-CORP          PIC S9(9) COMP.              01040001
010500     05  PV-TOT-CTNS-RECEIVED-CORP   PIC S9(9) COMP.              01050001
010600     05  PV-TOT-CTNS-CHECKIN-CORP    PIC S9(9) COMP.              01060001
010700     05  PV-TOT-CTNS-PHYSICAL-CORP   PIC S9(9) COMP.              01070001
010800     05  PV-TOT-SML-CORP             PIC S9(9) COMP.              01080001
010900     05  PV-TOT-P2L-CORP             PIC S9(9) COMP.              01090001
011000     05  PV-WORKING-PCT              PIC S9(9)V9999 COMP-3.       01100046
011100     05  PV-UCC128-PCT               PIC S9(9)V9 COMP-3.          01110046
011200     05  PV-PHYSICAL-PCT             PIC S9(9)V9 COMP-3.          01120046
011300     05  PV-SML-PCT                  PIC S9(9)V9 COMP-3.          01130046
011400     05  PV-SML-CHECKIN-PCT          PIC S9(9)V9 COMP-3.          01140046
011500     05  PV-SML-PHYSICAL-PCT         PIC S9(9)V9 COMP-3.          01150046
011600     05  PV-SML-SMOOTHING-PCT        PIC S9(9)V9 COMP-3.          01160046
011700     05  PV-P2L-SML-PCT              PIC S9(9)V9 COMP-3.          01170046
011800     05  PV-P2L-CHECKIN-PCT          PIC S9(9)V9 COMP-3.          01180046
011900     05  PV-P2L-PHYSICAL-PCT         PIC S9(9)V9 COMP-3.          01190046
012000     05  PV-TODAYS-DATE.                                          01200001
012100         10  PV-TODAYS-DATE-YY       PIC 9(02) VALUE ZERO.        01210001
012200         10  PV-TODAYS-DATE-MM       PIC 9(02) VALUE ZERO.        01220001
012300         10  PV-TODAYS-DATE-DD       PIC 9(02) VALUE ZERO.        01230001
012400     05  PV-TODAYS-TIME.                                          01240001
012500         10  PV-TODAYS-TIME-HH       PIC 9(02) VALUE ZERO.        01250001
012600         10  PV-TODAYS-TIME-MM       PIC 9(02) VALUE ZERO.        01260001
012700         10  PV-TODAYS-TIME-SS       PIC 9(02) VALUE ZERO.        01270001
012800         10  FILLER                  PIC 9(02) VALUE ZERO.        01280001
012900     05  PV-COMPARE-DATE.                                         01290001
013000         10  PV-COMPARE-DATE-CC      PIC 9(02) VALUE ZERO.        01300001
013100         10  PV-COMPARE-DATE-YY      PIC 9(02) VALUE ZERO.        01310001
013200         10  FILLER                  PIC X(01) VALUE '-'.         01320001
013300         10  PV-COMPARE-DATE-MM      PIC 9(02) VALUE ZERO.        01330001
013400         10  FILLER                  PIC X(01) VALUE '-'.         01340001
013500         10  PV-COMPARE-DATE-DD      PIC 9(02) VALUE ZERO.        01350001
013600*                                                                 01360001
013700 01  ABEND-CODE                      PIC S9(4)  VALUE +0          01370001
013800                                                 COMP SYNC.       01380001
013900*                                                                 01390001
014000******************************************************************01400001
014100*  DB2 FORMATTED MESSAGE AREA                                     01410001
014200******************************************************************01420001
014300     COPY DPWS004.                                                01430001
014400*                                                                 01440001
014500     COPY SURD059.                                                01450049
014600*                                                                 01460047
014700******************************************************************01470001
014800*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               01480001
014900******************************************************************01490001
015000     COPY DPWS132O.                                               01500001
015100*                                                                 01510001
015200 01  HEADING-LINES.                                               01520001
015300     05  HEADING-LINE-1.                                          01530001
015400         10  FILLER                  PIC  X(45)    VALUE SPACES.  01540001
015500         10  FILLER                  PIC  X(41)    VALUE          01550001
015600             'DAILY - CARTONS SCAN BASED RECEIVED BY DC'.         01560001
015700         10  FILLER                  PIC  X(46)    VALUE SPACES.  01570001
015800*                                                                 01580001
015900     05  HEADING-LINE-2.                                          01590001
016000         10  FILLER                  PIC  X(56)    VALUE SPACES.  01600001
016100         10  FILLER                  PIC  X(06)    VALUE          01610001
016200             'DATE: '.                                            01620001
016300         10  HEADING-2-FORMATTED-DTE PIC  X(10)    VALUE SPACES.  01630002
016400         10  FILLER                  PIC  X(60)    VALUE SPACES.  01640001
016500*                                                                 01650001
016600     05  HEADING-LINE-3.                                          01660001
016700         10  FILLER                  PIC  X(32)    VALUE SPACES.  01670021
016800         10  FILLER                  PIC  X(05)    VALUE          01680001
016900             'TOTAL'.                                             01690001
017000         10  FILLER                  PIC  X(06)    VALUE SPACES.  01700001
017100         10  FILLER                  PIC  X(05)    VALUE          01710001
017200             'TOTAL'.                                             01720001
017300         10  FILLER                  PIC  X(06)    VALUE SPACES.  01730001
017400         10  FILLER                  PIC  X(05)    VALUE          01740001
017500             'TOTAL'.                                             01750001
017600         10  FILLER                  PIC  X(73)    VALUE SPACES.  01760021
017700*                                                                 01770001
017800     05  HEADING-LINE-4.                                          01780001
017900         10  FILLER                  PIC  X(31)    VALUE SPACES.  01790021
018000         10  FILLER                  PIC  X(07)    VALUE          01800001
018100             'CARTONS'.                                           01810001
018200         10  FILLER                  PIC  X(04)    VALUE SPACES.  01820001
018300         10  FILLER                  PIC  X(07)    VALUE          01830001
018400             'CARTONS'.                                           01840001
018500         10  FILLER                  PIC  X(04)    VALUE SPACES.  01850001
018600         10  FILLER                  PIC  X(07)    VALUE          01860001
018700             'CARTONS'.                                           01870001
018800* DMH    10  FILLER                  PIC  X(06)    VALUE SPACES.  01880058
018900         10  FILLER                  PIC  X(05)    VALUE SPACES.  01890058
019000         10  FILLER                  PIC  X(21)    VALUE          01900001
019100             '-------------- S M L '.                             01910001
019200         10  FILLER                  PIC  X(16)    VALUE          01920001
019300             '----------------'.                                  01930001
019400         10  FILLER                  PIC  X(02)    VALUE SPACES.  01940001
019500         10  FILLER                  PIC  X(27)    VALUE          01950001
019600             '--------- P 2 L -----------'.                       01960001
019700         10  FILLER                  PIC  X        VALUE SPACE.   01970058
019800*                                                                 01980001
019900     05  HEADING-LINE-5.                                          01990001
020000         10  FILLER                  PIC  X(03)    VALUE          02000001
020100             ' DC'.                                               02010001
020200         10  FILLER                  PIC  X(28)    VALUE SPACES.  02020021
020300         10  FILLER                  PIC  X(08)    VALUE          02030001
020400             'RECEIVED'.                                          02040001
020500         10  FILLER                  PIC  X(03)    VALUE SPACES.  02050001
020600         10  FILLER                  PIC  X(07)    VALUE          02060001
020700             'CHECKIN'.                                           02070001
020800         10  FILLER                  PIC  X(04)    VALUE SPACES.  02080001
020900         10  FILLER                  PIC  X(08)    VALUE          02090001
021000             'PHYSICAL'.                                          02100001
021100* DMH    10  FILLER                  PIC  X(07)    VALUE SPACES.  02110058
021200         10  FILLER                  PIC  X(06)    VALUE SPACES.  02120058
021300         10  FILLER                  PIC  X(05)    VALUE          02130001
021400             'TOTAL'.                                             02140001
021500         10  FILLER                  PIC  X(03)    VALUE SPACES.  02150001
021600         10  FILLER                  PIC  X(07)    VALUE          02160001
021700             'CHECKIN'.                                           02170001
021800         10  FILLER                  PIC  X(02)    VALUE SPACES.  02180001
021900         10  FILLER                  PIC  X(08)    VALUE          02190001
022000             'PHYSICAL'.                                          02200001
022100         10  FILLER                  PIC  X(01)    VALUE SPACES.  02210001
022200         10  FILLER                  PIC  X(09)    VALUE          02220001
022300             'SMOOTHING'.                                         02230001
022400         10  FILLER                  PIC  X(04)    VALUE SPACES.  02240001
022500         10  FILLER                  PIC  X(05)    VALUE          02250001
022600             'TOTAL'.                                             02260001
022700         10  FILLER                  PIC  X(03)    VALUE SPACES.  02270001
022800         10  FILLER                  PIC  X(07)    VALUE          02280001
022900             'CHECKIN'.                                           02290001
023000         10  FILLER                  PIC  X(02)    VALUE SPACES.  02300001
023100         10  FILLER                  PIC  X(08)    VALUE          02310001
023200             'PHYSICAL'.                                          02320001
023300         10  FILLER                  PIC  X        VALUE SPACE.   02330058
023400*                                                                 02340001
023500 01  DETAIL-LINES.                                                02350001
023600     05  DETAIL-LINE1.                                            02360001
023700         10  DL1-OPER-UNT           PIC  Z(04)     VALUE SPACES.  02370001
023800         10  FILLER                 PIC  X(01)     VALUE SPACES.  02380001
023900         10  DL1-OPER-DESC          PIC  X(23)     VALUE SPACES.  02390001
024000         10  FILLER                 PIC  X(03)     VALUE SPACES.  02400001
024100         10  DL1-TOT-CARTN-RECVD    PIC  ZZZ,ZZ9.                 02410001
024200         10  FILLER                 PIC  X(04)     VALUE SPACES.  02420001
024300         10  DL1-TOT-CARTN-CHCKIN   PIC  ZZZ,ZZ9.                 02430001
024400         10  FILLER                 PIC  X(04)     VALUE SPACES.  02440001
024500         10  DL1-TOT-CARTN-PHYSCL   PIC  ZZZ,ZZ9.                 02450001
024600* DMH    10  FILLER                 PIC  X(06)     VALUE SPACES.  02460058
024700         10  FILLER                 PIC  X(05)     VALUE SPACES.  02470058
024800         10  DL1-SML-TOTAL          PIC  ZZZ,ZZ9.                 02480001
024900         10  FILLER                 PIC  X(03)     VALUE SPACES.  02490001
025000         10  DL1-SML-CKECKIN        PIC  ZZZ,ZZ9.                 02500001
025100         10  FILLER                 PIC  X(03)     VALUE SPACES.  02510001
025200         10  DL1-SML-PHYSICAL       PIC  ZZZ,ZZ9.                 02520001
025300         10  FILLER                 PIC  X(02)     VALUE SPACES.  02530023
025400         10  DL1-SML-SMOOTHING      PIC  ZZZ,ZZ9.                 02540001
025500         10  FILLER                 PIC  X(03)     VALUE SPACES.  02550001
025600         10  DL1-P2L-TOTAL          PIC  ZZZ,ZZ9.                 02560001
025700         10  FILLER                 PIC  X(03)     VALUE SPACES.  02570001
025800         10  DL1-P2L-CHECKIN        PIC  ZZZ,ZZ9.                 02580001
025900         10  FILLER                 PIC  X(03)     VALUE SPACES.  02590001
026000         10  DL1-P2L-PHYSICAL       PIC  ZZZ,ZZ9.                 02600001
026100         10  FILLER                  PIC  X        VALUE SPACE.   02610058
026200*                                                                 02620001
026300     05  DETAIL-LINE2.                                            02630001
026400         10  FILLER                 PIC  X(44)     VALUE SPACES.  02640046
026500         10  DL2-TOT-CRT-CHKIN-PCT  PIC  ZZZ.9.                   02650046
026600         10  FILLER                 PIC  X(06)     VALUE SPACES.  02660046
026700         10  DL2-TOT-CRT-PHYSCL-PCT PIC  ZZZ.9.                   02670046
026800* DMH    10  FILLER                 PIC  X(08)     VALUE SPACES.  02680058
026900         10  FILLER                 PIC  X(07)     VALUE SPACES.  02690058
027000         10  DL2-SML-TOTAL-PCT      PIC  ZZZ.9.                   02700046
027100         10  FILLER                 PIC  X(05)     VALUE SPACES.  02710046
027200         10  DL2-SML-CKECKIN-PCT    PIC  ZZZ.9.                   02720046
027300         10  FILLER                 PIC  X(05)     VALUE SPACES.  02730046
027400         10  DL2-SML-PHYSICAL-PCT   PIC  ZZZ.9.                   02740046
027500         10  FILLER                 PIC  X(04)     VALUE SPACES.  02750046
027600         10  DL2-SML-SMOOTHING-PCT  PIC  ZZZ.9.                   02760046
027700         10  FILLER                 PIC  X(05)     VALUE SPACES.  02770046
027800         10  DL2-P2L-TOTAL-PCT      PIC  ZZZ.9.                   02780046
027900         10  FILLER                 PIC  X(05)     VALUE SPACES.  02790046
028000         10  DL2-P2L-CHECKIN-PCT    PIC  ZZZ.9.                   02800046
028100         10  FILLER                 PIC  X(05)     VALUE SPACES.  02810046
028200         10  DL2-P2L-PHYSICAL-PCT   PIC  ZZZ.9.                   02820046
028300         10  FILLER                  PIC  X        VALUE SPACE.   02830058
028400*                                                                 02840001
028500 01  MISCELLANEOUS-LINES.                                         02850001
028600     05  END-OF-REPORT-LINE.                                      02860001
028700         10  FILLER                  PIC  X(54)    VALUE SPACES.  02870001
028800         10  FILLER                  PIC  X(44)    VALUE          02880001
028900             '  ** END OF REPORT **                       '.      02890001
029000         10  FILLER                  PIC  X(44)    VALUE SPACES.  02900001
029100*                                                                 02910001
029200*DB2 AREA FOR COMPANY CONTROL TABLE                               02920001
029300     EXEC SQL                                                     02930001
029400          INCLUDE TCOCNTL                                         02940001
029500     END-EXEC.                                                    02950001
029600*                                                                 02960001
029700*DB2 AREA FOR SUT_OTBND_CART TABLE                                02970001
029800     EXEC SQL                                                     02980001
029900          INCLUDE SUT00024                                        02990001
030000     END-EXEC.                                                    03000001
030100*                                                                 03010001
030200     EXEC SQL                                                     03020001
030300          INCLUDE TSULBXF                                         03030001
030400     END-EXEC.                                                    03040001
030500*                                                                 03050001
030600     EXEC SQL                                                     03060001
030700          INCLUDE TSHUNLO                                         03070001
030800     END-EXEC.                                                    03080001
030900*                                                                 03090001
031000     EXEC SQL                                                     03100005
031100          INCLUDE TDISTHD                                         03110005
031200     END-EXEC.                                                    03120005
031300*                                                                 03130001
031400*DB2 AREA FOR XLT_LOC                                             03140059
031500     EXEC SQL                                                     03150059
031600          INCLUDE XLT00010                                        03160059
031700     END-EXEC.                                                    03170059
031800*                                                                 03180059
031900******************************************************************03190046
032000*  COBOL DECLARATION AND DCLGEN MEMBER FOR THE DATE ATTRIBUTE     03200046
032100*  TABLE                                                          03210046
032200******************************************************************03220046
032300     EXEC SQL                                                     03230046
032400          INCLUDE TDTATTR                                         03240046
032500     END-EXEC.                                                    03250046
032600*                                                                 03260046
032700***************************************************************** 03270001
032800*  DB2 COMMUNICATION AREA                                         03280001
032900***************************************************************** 03290001
033000     EXEC SQL                                                     03300001
033100         INCLUDE SQLCA                                            03310001
033200     END-EXEC.                                                    03320001
033300                                                                  03330001
033400***************************************************************** 03340001
033500*  DB2 COMMUNICATION AREA2                                        03350001
033600***************************************************************** 03360001
033700     COPY SQLCA2.                                                 03370001
033800                                                                  03380001
033900     EXEC SQL DECLARE DC_CSR CURSOR FOR                           03390005
034000         SELECT LOC_NBR                                           03400059
034100             ,  LOC_NM                                            03410059
034200         FROM XLT_LOC                                             03420059
034300         WHERE LOC_TYP_CDE     = 'DC'                             03430059
034400           AND E_BUS_IND = 'N'                                    03440059
034500           AND (OPN_DTE   = CURRENT DATE                          03450059
034600            OR  OPN_DTE   < CURRENT DATE)                         03460059
034700           AND  CLO_DTE      = '9999-09-09'                       03470061
034800      ORDER BY  LOC_NBR                                           03480059
034900     END-EXEC.                                                    03490001
035000                                                                  03500001
035100     EXEC SQL DECLARE SUT_OTBOUND_CSR CURSOR FOR                  03510009
035200         SELECT COUNT(*)                                          03520007
035300              , ORGN_LOC_NBR                                      03530010
035400              , CART_SRC_CDE                                      03540010
035500         FROM                                                     03550007
035600              SUT_OTBND_CART                                      03560007
035700         WHERE CRE_DTE               = :COCNTL-BTCH-PRC-DTE       03570007
035800           AND CART_SRC_CDE        IN ('SMO', 'ASN', 'CPS')       03580007
035900           AND ACTV_IND             = 'Y'                         03590032
036000      GROUP BY  ORGN_LOC_NBR                                      03600010
036100              , CART_SRC_CDE                                      03610010
036200      ORDER BY  ORGN_LOC_NBR                                      03620010
036300              , CART_SRC_CDE                                      03630010
036400     END-EXEC.                                                    03640007
036500                                                                  03650018
036600     EXEC SQL DECLARE P2L_CHECKIN_CSR CURSOR FOR                  03660018
036700         SELECT COUNT(*)                                          03670018
036800            ,   B.OPER_UNT_ID                                     03680020
036900         FROM TSULBXF A                                           03690018
037000            , TSHUNLO B                                           03700018
037100         WHERE DATE(A.CRE_TMST)      = :COCNTL-BTCH-PRC-DTE       03710018
037200           AND A.SHIPT_UNT_ID        = B.SHIPT_UNT_ID             03720018
037300           AND A.CRE_TMST            = B.CRE_TMST                 03730018
037400           AND A.CART_LBL_TYP_CDE    = 'P'                        03740018
037500           AND B.ACTV_CDE            = 'A'                        03750018
037600      GROUP BY B.OPER_UNT_ID                                      03760018
037700      ORDER BY B.OPER_UNT_ID                                      03770035
037800     END-EXEC.                                                    03780018
037900***************************************************************** 03790001
038000 PROCEDURE DIVISION.                                              03800001
038100*                                                                 03810001
038200 0000-MAINLINE-PROCESSING.                                        03820001
038300******************************************************************03830001
038400**  THIS IS THE MAIN DRIVER FOR THE PROGRAM.                      03840001
038500******************************************************************03850001
038600     DISPLAY '****** STARTING SUKRP040 ******'.                   03860001
038700*                                                                 03870001
038800*OPEN FILES.                                                      03880001
038900     OPEN INPUT  CONTROL-FILE                                     03890055
039000          OUTPUT REPORT-FILE                                      03900055
039100                 OUTPUT-FILE.                                     03910046
039200*                                                                 03920001
039300     PERFORM 1000-INITIALIZATION.                                 03930001
039400*                                                                 03940001
039500     SET PS-FIRST-FETCH  TO TRUE.                                 03950006
039600     PERFORM 8000-READ-CONTROL-REC.                               03960055
039700     IF PV-CONTROL-DATE = 'DEFAULT   '                            03970055
039800         PERFORM 1100-SELECT-DATE                                 03980057
039900     ELSE                                                         03990055
040000         MOVE PV-CONTROL-DATE  TO  COCNTL-BTCH-PRC-DTE            04000055
040100     END-IF.                                                      04010055
040200     PERFORM 1200-SELECT-TDTATTR.                                 04020053
040300     PERFORM 1300-PAGE-BREAK.                                     04030053
040400     PERFORM 5000-OPEN-OUTBOUND-CSR.                              04040053
040500     PERFORM 6000-OPEN-P2L-CHECKIN-CSR.                           04050053
040600     PERFORM 2000-PROCESS-DCS.                                    04060001
040700     PERFORM 5200-CLOSE-OUTBOUND-CURSOR.                          04070053
040800     PERFORM 6200-CLOSE-P2L-CHECKIN-CURSOR.                       04080053
040900                                                                  04090001
041000*                                                                 04100001
041100     CLOSE CONTROL-FILE                                           04110055
041200           REPORT-FILE                                            04120055
041300           OUTPUT-FILE.                                           04130051
041400     GOBACK.                                                      04140001
041500*                                                                 04150001
041600******************************************************************04160001
041700 1000-INITIALIZATION.                                             04170001
041800******************************************************************04180001
041900**  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               04190001
042000******************************************************************04200001
042100                                                                  04210006
042200     ACCEPT PV-TODAYS-DATE                                        04220001
042300       FROM DATE.                                                 04230001
042400*                                                                 04240001
042500     ACCEPT PV-TODAYS-TIME                                        04250001
042600       FROM TIME.                                                 04260001
042700*                                                                 04270001
042800     MOVE PV-TODAYS-DATE-MM  TO DP132O-RUN-MONTH                  04280001
042900                                PV-COMPARE-DATE-MM.               04290001
043000     MOVE PV-TODAYS-DATE-DD  TO DP132O-RUN-DAY                    04300001
043100                                PV-COMPARE-DATE-DD.               04310001
043200     MOVE PV-TODAYS-DATE-YY  TO DP132O-RUN-YEAR                   04320001
043300                                PV-COMPARE-DATE-YY.               04330001
043400     IF PV-COMPARE-DATE-YY  >  80                                 04340001
043500         MOVE  19            TO PV-COMPARE-DATE-CC                04350001
043600     ELSE                                                         04360001
043700         MOVE  20            TO PV-COMPARE-DATE-CC                04370001
043800     END-IF.                                                      04380001
043900*                                                                 04390001
044000     MOVE PV-TODAYS-TIME-HH  TO DP132O-RUN-HOUR.                  04400001
044100     MOVE PV-TODAYS-TIME-MM  TO DP132O-RUN-MINUTE.                04410001
044200*                                                                 04420001
044300     MOVE PC-SUKRP040        TO DP132O-PROGRAM-NAME.              04430001
044400     MOVE PC-REPORT-NBR      TO DP132O-REPORT-NUMBER.             04440001
044500*                                                                 04450001
044600     MOVE +0                 TO PV-PAGE-COUNT.                    04460001
044700*                                                                 04470001
044800 1100-SELECT-DATE.                                                04480053
044900     EXEC SQL                                                     04490053
045000         SELECT BTCH_PRC_DTE                                      04500053
045100         INTO  :COCNTL-BTCH-PRC-DTE                               04510053
045200         FROM TCOCNTL                                             04520053
045300         WHERE OPER_UNT_ID   = 90                                 04530053
045400     END-EXEC.                                                    04540053
045500     EVALUATE TRUE                                                04550053
045600         WHEN SQLCODE = +0                                        04560053
045700             CONTINUE                                             04570053
045800         WHEN SQLCODE = +100                                      04580053
045900             SET PS-END-DC-CURSOR   TO TRUE                       04590053
046000         WHEN SQLCODE < ZERO                                      04600053
046100         WHEN SQLCODE > ZERO                                      04610053
046200         WHEN SQLWARN0 NOT = SPACE                                04620053
046300             MOVE '1100-SELECT-DATE'                              04630053
046400                                      TO PV-PARAGRAPH             04640053
046500             MOVE 'SELECT'            TO PV-DB2-FUNCTION          04650053
046600             PERFORM 9100-SQL-ABEND                               04660053
046700     END-EVALUATE.                                                04670053
046800                                                                  04680053
046900 1200-SELECT-TDTATTR.                                             04690053
047000******************************************************************04700053
047100*                                                                 04710053
047200     EXEC SQL                                                     04720053
047300         SELECT                                                   04730053
047400                 FSCL_YR_NBR                                      04740053
047500               , FSCL_MN_NBR                                      04750053
047600               , FSCL_WK_NBR                                      04760053
047700               , SEA_DESC                                         04770053
047800         INTO   :DTATTR-FSCL-YR-NBR                               04780053
047900               ,:DTATTR-FSCL-MN-NBR                               04790053
048000               ,:DTATTR-FSCL-WK-NBR                               04800053
048100               ,:DTATTR-SEA-DESC                                  04810053
048200         FROM TDTATTR                                             04820053
048300         WHERE KY_DTE  = :COCNTL-BTCH-PRC-DTE                     04830053
048400     END-EXEC.                                                    04840053
048500                                                                  04850053
048600     EVALUATE TRUE                                                04860053
048700         WHEN SQLCODE = +0                                        04870053
048800             CONTINUE                                             04880053
048900         WHEN SQLCODE < ZERO                                      04890053
049000         WHEN SQLCODE > ZERO                                      04900053
049100         WHEN SQLWARN0 NOT = SPACE                                04910053
049200             MOVE '1200-SELECT-TDTATTR'                           04920053
049300                                      TO PV-PARAGRAPH             04930053
049400             MOVE 'SELECT'            TO PV-DB2-FUNCTION          04940053
049500             PERFORM 9100-SQL-ABEND                               04950053
049600     END-EVALUATE.                                                04960053
049700*                                                                 04970053
049800*                                                                 04980001
049900******************************************************************04990001
050000**  WRITES REPORT HEADER LINES FOR FIRST PAGE AND ANY SUBSEQUENT  05000001
050100**  PAGES (AS NEEDED).                                            05010001
050200******************************************************************05020001
050300 1300-PAGE-BREAK.                                                 05030053
050400*                                                                 05040001
050500     ADD +1                   TO PV-PAGE-COUNT.                   05050015
050600     MOVE PV-PAGE-COUNT       TO DP132O-PAGE-NUMBER.              05060015
050700     STRING COCNTL-BTCH-PRC-DTE (6:2)                             05070021
050800            '/'                                                   05080026
050900            COCNTL-BTCH-PRC-DTE (9:2)                             05090021
051000            '/'                                                   05100026
051100            COCNTL-BTCH-PRC-DTE (1:4)                             05110021
051200                DELIMITED BY SIZE                                 05120021
051300                            INTO HEADING-2-FORMATTED-DTE.         05130021
051400*                                                                 05140001
051500     WRITE REPORT-RECORD                                          05150001
051600       FROM DP132O-STANDRD-HEADER-132-COLS                        05160001
051700         AFTER ADVANCING PAGE.                                    05170001
051800*                                                                 05180001
051900     WRITE REPORT-RECORD                                          05190001
052000       FROM HEADING-LINE-1                                        05200001
052100         AFTER ADVANCING 2 LINES.                                 05210001
052200*                                                                 05220001
052300     WRITE REPORT-RECORD                                          05230001
052400       FROM HEADING-LINE-2                                        05240001
052500         AFTER ADVANCING 1 LINE.                                  05250001
052600*                                                                 05260001
052700     WRITE REPORT-RECORD                                          05270001
052800       FROM HEADING-LINE-3                                        05280001
052900         AFTER ADVANCING 2 LINE.                                  05290001
053000*                                                                 05300001
053100     WRITE REPORT-RECORD                                          05310001
053200       FROM HEADING-LINE-4                                        05320001
053300         AFTER ADVANCING 1 LINE.                                  05330001
053400*                                                                 05340001
053500     WRITE REPORT-RECORD                                          05350001
053600       FROM HEADING-LINE-5                                        05360001
053700         AFTER ADVANCING 1 LINE.                                  05370001
053800*                                                                 05380001
053900     MOVE +6                 TO PV-LINE-COUNT.                    05390001
054000*                                                                 05400001
054100******************************************************************05410001
054200 2000-PROCESS-DCS.                                                05420001
054300     MOVE 0      TO SUT00024-ORGN-LOC-NBR.                        05430014
054400     MOVE 0      TO SHUNLO-OPER-UNT-ID.                           05440018
054500     PERFORM 7000-OPEN-DC-CURSOR.                                 05450001
054600     PERFORM UNTIL PS-END-DC-CURSOR                               05460002
054700         PERFORM 7100-FETCH-DC-CURSOR                             05470001
054800         IF PS-FIRST-FETCH                                        05480006
054900             SET PS-NOT-FIRST-FETCH TO TRUE                       05490006
055000         END-IF                                                   05500006
055100         IF PS-NOT-END-DC-CURSOR                                  05510002
055200             PERFORM 2100-SUMM-DC                                 05520001
055300             PERFORM 3000-PRINT-DETAIL-LINE                       05530001
055400             PERFORM 4000-WRITE-OUTPUT-RECORD                     05540046
055500         END-IF                                                   05550001
055600     END-PERFORM.                                                 05560001
055700     PERFORM 7200-CLOSE-DC-CURSOR.                                05570001
055800                                                                  05580001
055900     IF PV-TOT-CTNS-CHECKIN-CORP > 0 AND                          05590031
056000        PV-TOT-CTNS-RECEIVED-CORP > 0                             05600031
056100         COMPUTE PV-WORKING-PCT =                                 05610052
056200                (PV-TOT-CTNS-CHECKIN-CORP /                       05620031
056300                 PV-TOT-CTNS-RECEIVED-CORP)                       05630031
056400         COMPUTE PV-UCC128-PCT ROUNDED =                          05640052
056500                 PV-WORKING-PCT * 100                             05650052
056600     ELSE                                                         05660031
056700         MOVE 0        TO PV-UCC128-PCT                           05670031
056800     END-IF.                                                      05680031
056900                                                                  05690031
057000     IF PV-TOT-CTNS-PHYSICAL-CORP > 0 AND                         05700031
057100        PV-TOT-CTNS-RECEIVED-CORP > 0                             05710031
057200         COMPUTE PV-WORKING-PCT =                                 05720044
057300                (PV-TOT-CTNS-PHYSICAL-CORP /                      05730043
057400                 PV-TOT-CTNS-RECEIVED-CORP)                       05740031
057500         COMPUTE PV-PHYSICAL-PCT ROUNDED =                        05750044
057600                 PV-WORKING-PCT * 100                             05760044
057700     ELSE                                                         05770031
057800         MOVE 0      TO PV-PHYSICAL-PCT                           05780031
057900     END-IF.                                                      05790031
058000                                                                  05800001
058100     IF PV-TOT-SML-CORP > 0 AND                                   05810021
058200        PV-TOT-CTNS-RECEIVED-CORP > 0                             05820021
058300         COMPUTE PV-WORKING-PCT =                                 05830044
058400                (PV-TOT-SML-CORP /                                05840043
058500                 PV-TOT-CTNS-RECEIVED-CORP)                       05850021
058600         COMPUTE PV-SML-PCT ROUNDED =                             05860044
058700                 PV-WORKING-PCT * 100                             05870044
058800     ELSE                                                         05880021
058900         MOVE 0    TO PV-SML-PCT                                  05890021
059000     END-IF.                                                      05900021
059100                                                                  05910001
059200     IF PV-OUTBOUND-ASN-CORP > 0 AND                              05920021
059300        PV-TOT-SML-CORP > 0                                       05930021
059400         COMPUTE PV-WORKING-PCT =                                 05940044
059500                (PV-OUTBOUND-ASN-CORP /                           05950043
059600                 PV-TOT-SML-CORP)                                 05960021
059700         COMPUTE PV-SML-CHECKIN-PCT ROUNDED =                     05970044
059800                 PV-WORKING-PCT * 100                             05980044
059900     ELSE                                                         05990021
060000         MOVE 0    TO PV-SML-CHECKIN-PCT                          06000021
060100     END-IF.                                                      06010021
060200                                                                  06020021
060300     IF PV-OUTBOUND-CPS-CORP > 0 AND                              06030021
060400        PV-TOT-SML-CORP > 0                                       06040021
060500         COMPUTE PV-WORKING-PCT =                                 06050044
060600                (PV-OUTBOUND-CPS-CORP /                           06060043
060700                 PV-TOT-SML-CORP)                                 06070021
060800         COMPUTE PV-SML-PHYSICAL-PCT ROUNDED =                    06080044
060900                 PV-WORKING-PCT * 100                             06090044
061000     ELSE                                                         06100021
061100         MOVE 0    TO PV-SML-PHYSICAL-PCT                         06110021
061200     END-IF.                                                      06120021
061300                                                                  06130021
061400     IF PV-OUTBOUND-SMO-CORP > 0 AND                              06140021
061500        PV-TOT-SML-CORP > 0                                       06150021
061600         COMPUTE PV-WORKING-PCT =                                 06160044
061700                (PV-OUTBOUND-SMO-CORP /                           06170043
061800                 PV-TOT-SML-CORP)                                 06180021
061900         COMPUTE PV-SML-SMOOTHING-PCT ROUNDED =                   06190044
062000                 PV-WORKING-PCT * 100                             06200044
062100     ELSE                                                         06210021
062200         MOVE 0    TO PV-SML-SMOOTHING-PCT                        06220021
062300     END-IF.                                                      06230021
062400                                                                  06240021
062500     IF PV-TOT-P2L-CORP > 0 AND                                   06250021
062600        PV-TOT-CTNS-RECEIVED-CORP > 0                             06260021
062700         COMPUTE PV-WORKING-PCT =                                 06270044
062800                (PV-TOT-P2L-CORP /                                06280043
062900                 PV-TOT-CTNS-RECEIVED-CORP)                       06290021
063000         COMPUTE PV-P2L-SML-PCT ROUNDED =                         06300044
063100                 PV-WORKING-PCT * 100                             06310044
063200     ELSE                                                         06320021
063300         MOVE 0    TO PV-P2L-SML-PCT                              06330021
063400     END-IF.                                                      06340021
063500                                                                  06350021
063600     IF PV-SULBXF-P2L-CORP > 0 AND                                06360021
063700        PV-TOT-P2L-CORP > 0                                       06370021
063800         COMPUTE PV-WORKING-PCT =                                 06380044
063900                (PV-SULBXF-P2L-CORP /                             06390043
064000                 PV-TOT-P2L-CORP)                                 06400021
064100         COMPUTE PV-P2L-CHECKIN-PCT ROUNDED =                     06410044
064200                 PV-WORKING-PCT * 100                             06420044
064300     ELSE                                                         06430021
064400         MOVE 0    TO PV-P2L-CHECKIN-PCT                          06440021
064500     END-IF.                                                      06450021
064600                                                                  06460021
064700     IF PV-DISTHD-P2L-CORP > 0 AND                                06470021
064800        PV-TOT-P2L-CORP > 0                                       06480021
064900         COMPUTE PV-WORKING-PCT =                                 06490044
065000                (PV-DISTHD-P2L-CORP /                             06500043
065100                 PV-TOT-P2L-CORP)                                 06510021
065200         COMPUTE PV-P2L-PHYSICAL-PCT ROUNDED =                    06520044
065300                 PV-WORKING-PCT * 100                             06530044
065400     ELSE                                                         06540021
065500         MOVE 0    TO PV-P2L-PHYSICAL-PCT                         06550021
065600     END-IF.                                                      06560021
065700                                                                  06570001
065800     ADD +1                  TO PV-LINE-COUNT                     06580001
065900     PERFORM 3100-PRINT-CORP-DETAIL-LINE.                         06590001
066000                                                                  06600001
066100                                                                  06610001
066200*                                                                 06620001
066300 2100-SUMM-DC.                                                    06630001
066400     MOVE 0                   TO PV-OUTBOUND-ASN.                 06640015
066500     MOVE 0                   TO PV-OUTBOUND-CPS.                 06650015
066600     MOVE 0                   TO PV-OUTBOUND-SMO.                 06660015
066700     PERFORM 5100-FETCH-OUTBOUND-CURSOR                           06670054
066800         UNTIL (SUT00024-ORGN-LOC-NBR = XLT00010-LOC-NBR          06680059
066900           AND SUT00024-CART-SRC-CDE = 'ASN')                     06690033
067000            OR (SUT00024-ORGN-LOC-NBR > XLT00010-LOC-NBR)         06700059
067100            OR (SUT00024-ORGN-LOC-NBR = XLT00010-LOC-NBR          06710059
067200           AND SUT00024-CART-SRC-CDE > 'ASN') OR                  06720033
067300           PS-END-OUTBOUND-CURSOR.                                06730033
067400     IF PS-NOT-END-OUTBOUND-CURSOR AND                            06740033
067500        SUT00024-ORGN-LOC-NBR = XLT00010-LOC-NBR AND              06750059
067600        SUT00024-CART-SRC-CDE = 'ASN'                             06760033
067700         MOVE PV-OUTBOUND-COUNT   TO PV-OUTBOUND-ASN              06770033
067800     END-IF.                                                      06780014
067900     PERFORM 5100-FETCH-OUTBOUND-CURSOR                           06790054
068000         UNTIL (SUT00024-ORGN-LOC-NBR = XLT00010-LOC-NBR          06800059
068100           AND SUT00024-CART-SRC-CDE = 'CPS')                     06810033
068200            OR (SUT00024-ORGN-LOC-NBR > XLT00010-LOC-NBR)         06820059
068300            OR (SUT00024-ORGN-LOC-NBR = XLT00010-LOC-NBR          06830059
068400           AND SUT00024-CART-SRC-CDE > 'CPS') OR                  06840033
068500           PS-END-OUTBOUND-CURSOR.                                06850033
068600     IF PS-NOT-END-OUTBOUND-CURSOR AND                            06860033
068700        SUT00024-ORGN-LOC-NBR = XLT00010-LOC-NBR AND              06870059
068800        SUT00024-CART-SRC-CDE = 'CPS'                             06880033
068900         MOVE PV-OUTBOUND-COUNT   TO PV-OUTBOUND-CPS              06890033
069000     END-IF.                                                      06900014
069100     PERFORM 5100-FETCH-OUTBOUND-CURSOR                           06910053
069200         UNTIL (SUT00024-ORGN-LOC-NBR = XLT00010-LOC-NBR          06920059
069300           AND SUT00024-CART-SRC-CDE = 'SMO')                     06930033
069400            OR (SUT00024-ORGN-LOC-NBR > XLT00010-LOC-NBR)         06940059
069500            OR (SUT00024-ORGN-LOC-NBR = XLT00010-LOC-NBR          06950059
069600           AND SUT00024-CART-SRC-CDE > 'SMO') OR                  06960033
069700           PS-END-OUTBOUND-CURSOR.                                06970033
069800     IF PS-NOT-END-OUTBOUND-CURSOR AND                            06980033
069900        SUT00024-ORGN-LOC-NBR = XLT00010-LOC-NBR AND              06990059
070000        SUT00024-CART-SRC-CDE = 'SMO'                             07000033
070100         MOVE PV-OUTBOUND-COUNT   TO PV-OUTBOUND-SMO              07010033
070200     END-IF.                                                      07020014
070300     PERFORM 2200-SUM-DISTHD-P2L.                                 07030040
070400     MOVE 0    TO PV-SULBXF-P2L.                                  07040018
070500     PERFORM 6100-FETCH-P2L-CHECKIN-CURSOR                        07050053
070600         UNTIL SHUNLO-OPER-UNT-ID = XLT00010-LOC-NBR OR           07060059
070700               SHUNLO-OPER-UNT-ID > XLT00010-LOC-NBR OR           07070059
070800               PS-END-P2L-CHECKIN-CURSOR.                         07080037
070900     IF PS-NOT-END-P2L-CHECKIN-CURSOR AND                         07090037
071000        SHUNLO-OPER-UNT-ID  = XLT00010-LOC-NBR                    07100059
071100         MOVE PV-SULBXF-COUNT     TO PV-SULBXF-P2L                07110037
071200     END-IF.                                                      07120018
071300     COMPUTE PV-TOT-CTNS-RECEIVED =                               07130001
071400             PV-OUTBOUND-SMO +                                    07140001
071500             PV-OUTBOUND-ASN +                                    07150001
071600             PV-OUTBOUND-CPS +                                    07160001
071700             PV-DISTHD-P2L +                                      07170001
071800             PV-SULBXF-P2L.                                       07180001
071900     COMPUTE PV-TOT-CTNS-RECEIVED-CORP =                          07190001
072000             PV-TOT-CTNS-RECEIVED-CORP +                          07200001
072100             PV-TOT-CTNS-RECEIVED.                                07210001
072200     COMPUTE PV-OUTBOUND-SMO-CORP =                               07220001
072300             PV-OUTBOUND-SMO-CORP +                               07230001
072400             PV-OUTBOUND-SMO.                                     07240001
072500     COMPUTE PV-OUTBOUND-ASN-CORP =                               07250001
072600             PV-OUTBOUND-ASN-CORP +                               07260001
072700             PV-OUTBOUND-ASN.                                     07270001
072800     COMPUTE PV-OUTBOUND-CPS-CORP =                               07280001
072900             PV-OUTBOUND-CPS-CORP +                               07290001
073000             PV-OUTBOUND-CPS.                                     07300001
073100     COMPUTE PV-DISTHD-P2L-CORP =                                 07310001
073200             PV-DISTHD-P2L-CORP +                                 07320001
073300             PV-DISTHD-P2L.                                       07330001
073400     COMPUTE PV-SULBXF-P2L-CORP =                                 07340001
073500             PV-SULBXF-P2L-CORP +                                 07350001
073600             PV-SULBXF-P2L.                                       07360001
073700                                                                  07370001
073800     COMPUTE PV-TOT-CTNS-CHECKIN =                                07380001
073900             PV-OUTBOUND-ASN +                                    07390001
074000             PV-SULBXF-P2L.                                       07400001
074100     COMPUTE PV-TOT-CTNS-CHECKIN-CORP =                           07410001
074200             PV-TOT-CTNS-CHECKIN-CORP +                           07420001
074300             PV-TOT-CTNS-CHECKIN.                                 07430001
074400                                                                  07440001
074500     COMPUTE PV-TOT-CTNS-PHYSICAL =                               07450001
074600             PV-OUTBOUND-SMO +                                    07460001
074700             PV-OUTBOUND-CPS +                                    07470001
074800             PV-DISTHD-P2L.                                       07480001
074900     COMPUTE PV-TOT-CTNS-PHYSICAL-CORP =                          07490001
075000             PV-TOT-CTNS-PHYSICAL-CORP +                          07500001
075100             PV-TOT-CTNS-PHYSICAL.                                07510001
075200                                                                  07520001
075300     COMPUTE PV-TOT-SML =                                         07530001
075400             PV-OUTBOUND-SMO +                                    07540001
075500             PV-OUTBOUND-ASN +                                    07550001
075600             PV-OUTBOUND-CPS.                                     07560001
075700     COMPUTE PV-TOT-SML-CORP =                                    07570001
075800             PV-TOT-SML-CORP +                                    07580001
075900             PV-TOT-SML.                                          07590001
076000                                                                  07600001
076100     COMPUTE PV-TOT-P2L =                                         07610001
076200             PV-DISTHD-P2L +                                      07620001
076300             PV-SULBXF-P2L.                                       07630001
076400     COMPUTE PV-TOT-P2L-CORP =                                    07640001
076500             PV-TOT-P2L-CORP +                                    07650001
076600             PV-TOT-P2L.                                          07660001
076700                                                                  07670001
076800     IF PV-TOT-CTNS-CHECKIN > 0 AND                               07680014
076900        PV-TOT-CTNS-RECEIVED > 0                                  07690014
077000         COMPUTE PV-WORKING-PCT =                                 07700044
077100                (PV-TOT-CTNS-CHECKIN /                            07710043
077200                 PV-TOT-CTNS-RECEIVED)                            07720014
077300         COMPUTE PV-UCC128-PCT ROUNDED =                          07730044
077400                 PV-WORKING-PCT * 100                             07740044
077500     ELSE                                                         07750014
077600         MOVE 0        TO PV-UCC128-PCT                           07760014
077700     END-IF.                                                      07770014
077800                                                                  07780014
077900     IF PV-TOT-CTNS-PHYSICAL > 0 AND                              07790014
078000        PV-TOT-CTNS-RECEIVED > 0                                  07800014
078100         COMPUTE PV-WORKING-PCT =                                 07810044
078200                (PV-TOT-CTNS-PHYSICAL /                           07820043
078300                 PV-TOT-CTNS-RECEIVED)                            07830014
078400         COMPUTE PV-PHYSICAL-PCT ROUNDED =                        07840044
078500                 PV-WORKING-PCT * 100                             07850044
078600     ELSE                                                         07860014
078700         MOVE 0        TO PV-PHYSICAL-PCT                         07870014
078800     END-IF.                                                      07880014
078900                                                                  07890014
079000     IF PV-TOT-SML > 0 AND                                        07900014
079100        PV-TOT-CTNS-RECEIVED > 0                                  07910014
079200         COMPUTE PV-WORKING-PCT =                                 07920044
079300                (PV-TOT-SML /                                     07930043
079400                 PV-TOT-CTNS-RECEIVED)                            07940014
079500         COMPUTE PV-SML-PCT ROUNDED =                             07950044
079600                 PV-WORKING-PCT * 100                             07960044
079700     ELSE                                                         07970014
079800         MOVE 0        TO PV-SML-PCT                              07980014
079900     END-IF.                                                      07990014
080000                                                                  08000014
080100     IF PV-OUTBOUND-ASN > 0 AND                                   08010014
080200        PV-TOT-SML > 0                                            08020014
080300         COMPUTE PV-WORKING-PCT =                                 08030044
080400                (PV-OUTBOUND-ASN /                                08040043
080500                 PV-TOT-SML)                                      08050014
080600         COMPUTE PV-SML-CHECKIN-PCT ROUNDED =                     08060044
080700                 PV-WORKING-PCT * 100                             08070044
080800     ELSE                                                         08080014
080900         MOVE 0        TO PV-SML-CHECKIN-PCT                      08090014
081000     END-IF.                                                      08100014
081100                                                                  08110014
081200     IF PV-OUTBOUND-CPS > 0 AND                                   08120014
081300        PV-TOT-SML > 0                                            08130014
081400         COMPUTE PV-WORKING-PCT =                                 08140044
081500                (PV-OUTBOUND-CPS /                                08150043
081600                 PV-TOT-SML)                                      08160014
081700         COMPUTE PV-SML-PHYSICAL-PCT ROUNDED =                    08170044
081800                 PV-WORKING-PCT * 100                             08180044
081900     ELSE                                                         08190014
082000         MOVE 0        TO PV-SML-PHYSICAL-PCT                     08200014
082100     END-IF.                                                      08210014
082200                                                                  08220014
082300     IF PV-OUTBOUND-SMO > 0 AND                                   08230014
082400        PV-TOT-SML > 0                                            08240014
082500         COMPUTE PV-WORKING-PCT =                                 08250044
082600                (PV-OUTBOUND-SMO /                                08260043
082700                 PV-TOT-SML)                                      08270014
082800         COMPUTE PV-SML-SMOOTHING-PCT ROUNDED =                   08280044
082900                 PV-WORKING-PCT * 100                             08290044
083000     ELSE                                                         08300014
083100         MOVE 0        TO PV-SML-SMOOTHING-PCT                    08310014
083200     END-IF.                                                      08320014
083300                                                                  08330014
083400     IF PV-TOT-P2L > 0 AND                                        08340014
083500        PV-TOT-CTNS-RECEIVED > 0                                  08350014
083600         COMPUTE PV-WORKING-PCT =                                 08360044
083700                (PV-TOT-P2L /                                     08370043
083800                 PV-TOT-CTNS-RECEIVED)                            08380014
083900         COMPUTE PV-P2L-SML-PCT ROUNDED =                         08390044
084000                 PV-WORKING-PCT * 100                             08400044
084100     ELSE                                                         08410014
084200         MOVE 0        TO PV-P2L-SML-PCT                          08420014
084300     END-IF.                                                      08430014
084400                                                                  08440014
084500     IF PV-SULBXF-P2L > 0 AND                                     08450014
084600        PV-TOT-P2L > 0                                            08460014
084700         COMPUTE PV-WORKING-PCT =                                 08470044
084800                (PV-SULBXF-P2L /                                  08480043
084900                 PV-TOT-P2L)                                      08490014
085000         COMPUTE PV-P2L-CHECKIN-PCT ROUNDED =                     08500044
085100                 PV-WORKING-PCT * 100                             08510044
085200     ELSE                                                         08520014
085300         MOVE 0        TO PV-P2L-CHECKIN-PCT                      08530014
085400     END-IF.                                                      08540014
085500                                                                  08550014
085600     IF PV-DISTHD-P2L > 0 AND                                     08560014
085700        PV-TOT-P2L > 0                                            08570014
085800         COMPUTE PV-WORKING-PCT =                                 08580044
085900                (PV-DISTHD-P2L /                                  08590043
086000                 PV-TOT-P2L)                                      08600014
086100         COMPUTE PV-P2L-PHYSICAL-PCT ROUNDED =                    08610044
086200                 PV-WORKING-PCT * 100                             08620044
086300     ELSE                                                         08630014
086400         MOVE 0        TO PV-P2L-PHYSICAL-PCT                     08640014
086500     END-IF.                                                      08650014
086600                                                                  08660001
086700*                                                                 08670001
086800 2200-SUM-DISTHD-P2L.                                             08680040
086900                                                                  08690001
087000     MOVE 0      TO PV-DISTHD-P2L.                                08700001
087100                                                                  08710001
087200     EXEC SQL                                                     08720001
087300         SELECT SUM(P2L_CART_CNT)                                 08730001
087400         INTO   :PV-DISTHD-P2L                                    08740001
087500         FROM                                                     08750001
087600              TDISTHD                                             08760001
087700         WHERE OPER_UNT_ID           = :XLT00010-LOC-NBR          08770059
087800           AND DATE(CRE_TMST)        = :COCNTL-BTCH-PRC-DTE       08780003
087900           AND UCC128_DAT_USG_CDE    IN ('N','I')                 08790001
088000     END-EXEC.                                                    08800001
088100                                                                  08810001
088200     EVALUATE TRUE                                                08820001
088300         WHEN SQLCODE = +0                                        08830001
088400             CONTINUE                                             08840040
088500         WHEN SQLCODE = -305                                      08850011
088600             MOVE 0    TO PV-DISTHD-P2L                           08860011
088700         WHEN SQLCODE < ZERO                                      08870001
088800         WHEN SQLCODE > ZERO                                      08880001
088900         WHEN SQLWARN0 NOT = SPACE                                08890001
089000             MOVE '2200-SUM-DISTHD-P2L'                           08900040
089100                                      TO PV-PARAGRAPH             08910001
089200             MOVE 'SUM'               TO PV-DB2-FUNCTION          08920001
089300             PERFORM 9100-SQL-ABEND                               08930002
089400     END-EVALUATE.                                                08940001
089500*                                                                 08950001
089600******************************************************************08960001
089700 3000-PRINT-DETAIL-LINE.                                          08970001
089800*                                                                 08980001
089900     MOVE XLT00010-LOC-NBR         TO DL1-OPER-UNT.               08990059
090000     MOVE XLT00010-LOC-NM          TO DL1-OPER-DESC.              09000059
090100     MOVE PV-TOT-CTNS-RECEIVED     TO DL1-TOT-CARTN-RECVD.        09010001
090200     MOVE PV-TOT-CTNS-CHECKIN      TO DL1-TOT-CARTN-CHCKIN.       09020001
090300     MOVE PV-TOT-CTNS-PHYSICAL     TO DL1-TOT-CARTN-PHYSCL.       09030001
090400     MOVE PV-TOT-SML               TO DL1-SML-TOTAL.              09040001
090500     MOVE PV-OUTBOUND-ASN          TO DL1-SML-CKECKIN.            09050001
090600     MOVE PV-OUTBOUND-CPS          TO DL1-SML-PHYSICAL.           09060001
090700     MOVE PV-OUTBOUND-SMO          TO DL1-SML-SMOOTHING.          09070001
090800     MOVE PV-TOT-P2L               TO DL1-P2L-TOTAL.              09080001
090900     MOVE PV-SULBXF-P2L            TO DL1-P2L-CHECKIN.            09090001
091000     MOVE PV-DISTHD-P2L            TO DL1-P2L-PHYSICAL.           09100001
091100*                                                                 09110001
091200     MOVE PV-UCC128-PCT            TO DL2-TOT-CRT-CHKIN-PCT.      09120001
091300     MOVE PV-PHYSICAL-PCT          TO DL2-TOT-CRT-PHYSCL-PCT.     09130001
091400     MOVE PV-SML-PCT               TO DL2-SML-TOTAL-PCT.          09140001
091500     MOVE PV-SML-CHECKIN-PCT       TO DL2-SML-CKECKIN-PCT.        09150001
091600     MOVE PV-SML-PHYSICAL-PCT      TO DL2-SML-PHYSICAL-PCT.       09160001
091700     MOVE PV-SML-SMOOTHING-PCT     TO DL2-SML-SMOOTHING-PCT.      09170001
091800     MOVE PV-P2L-SML-PCT           TO DL2-P2L-TOTAL-PCT.          09180001
091900     MOVE PV-P2L-CHECKIN-PCT       TO DL2-P2L-CHECKIN-PCT.        09190001
092000     MOVE PV-P2L-PHYSICAL-PCT      TO DL2-P2L-PHYSICAL-PCT.       09200001
092100                                                                  09210001
092200*                                                                 09220001
092300     ADD +3 TO PV-LINE-COUNT.                                     09230023
092400     IF PV-LINE-COUNT > PV-MAX-LINE-COUNT                         09240001
092500         PERFORM 1300-PAGE-BREAK                                  09250053
092600     END-IF.                                                      09260001
092700*                                                                 09270001
092800     WRITE REPORT-RECORD                                          09280001
092900       FROM DETAIL-LINE1                                          09290001
093000         AFTER ADVANCING 2 LINE.                                  09300023
093100*                                                                 09310001
093200     WRITE REPORT-RECORD                                          09320001
093300       FROM DETAIL-LINE2                                          09330001
093400         AFTER ADVANCING 1 LINE.                                  09340001
093500*                                                                 09350001
093600*                                                                 09360001
093700******************************************************************09370001
093800 3100-PRINT-CORP-DETAIL-LINE.                                     09380001
093900*                                                                 09390001
094000     MOVE 0                         TO DL1-OPER-UNT.              09400001
094100     MOVE 'CORPORATE TOTALS'        TO DL1-OPER-DESC.             09410001
094200     MOVE PV-TOT-CTNS-RECEIVED-CORP TO DL1-TOT-CARTN-RECVD.       09420001
094300     MOVE PV-TOT-CTNS-CHECKIN-CORP  TO DL1-TOT-CARTN-CHCKIN.      09430001
094400     MOVE PV-TOT-CTNS-PHYSICAL-CORP TO DL1-TOT-CARTN-PHYSCL.      09440001
094500     MOVE PV-TOT-SML-CORP           TO DL1-SML-TOTAL.             09450001
094600     MOVE PV-OUTBOUND-ASN-CORP      TO DL1-SML-CKECKIN.           09460001
094700     MOVE PV-OUTBOUND-CPS-CORP      TO DL1-SML-PHYSICAL.          09470001
094800     MOVE PV-OUTBOUND-SMO-CORP      TO DL1-SML-SMOOTHING.         09480001
094900     MOVE PV-TOT-P2L-CORP           TO DL1-P2L-TOTAL.             09490001
095000     MOVE PV-SULBXF-P2L-CORP        TO DL1-P2L-CHECKIN.           09500001
095100     MOVE PV-DISTHD-P2L-CORP        TO DL1-P2L-PHYSICAL.          09510001
095200*                                                                 09520001
095300     MOVE PV-UCC128-PCT             TO DL2-TOT-CRT-CHKIN-PCT.     09530001
095400     MOVE PV-PHYSICAL-PCT           TO DL2-TOT-CRT-PHYSCL-PCT.    09540001
095500     MOVE PV-SML-PCT                TO DL2-SML-TOTAL-PCT.         09550001
095600     MOVE PV-SML-CHECKIN-PCT        TO DL2-SML-CKECKIN-PCT.       09560001
095700     MOVE PV-SML-PHYSICAL-PCT       TO DL2-SML-PHYSICAL-PCT.      09570001
095800     MOVE PV-SML-SMOOTHING-PCT      TO DL2-SML-SMOOTHING-PCT.     09580001
095900     MOVE PV-P2L-SML-PCT            TO DL2-P2L-TOTAL-PCT.         09590001
096000     MOVE PV-P2L-CHECKIN-PCT        TO DL2-P2L-CHECKIN-PCT.       09600001
096100     MOVE PV-P2L-PHYSICAL-PCT       TO DL2-P2L-PHYSICAL-PCT.      09610001
096200                                                                  09620001
096300*                                                                 09630001
096400     ADD +5 TO PV-LINE-COUNT.                                     09640029
096500     IF PV-LINE-COUNT > PV-MAX-LINE-COUNT                         09650001
096600         PERFORM 1300-PAGE-BREAK                                  09660053
096700     END-IF.                                                      09670001
096800*                                                                 09680001
096900     WRITE REPORT-RECORD                                          09690001
097000       FROM DETAIL-LINE1                                          09700001
097100         AFTER ADVANCING 2 LINES.                                 09710029
097200*                                                                 09720001
097300     WRITE REPORT-RECORD                                          09730001
097400       FROM DETAIL-LINE2                                          09740001
097500         AFTER ADVANCING 1 LINE.                                  09750001
097600*                                                                 09760001
097700     WRITE REPORT-RECORD                                          09770029
097800       FROM END-OF-REPORT-LINE                                    09780029
097900         AFTER ADVANCING 2 LINES.                                 09790029
098000                                                                  09800046
098100 4000-WRITE-OUTPUT-RECORD.                                        09810046
098200     MOVE XLT00010-LOC-NBR         TO SU059-OPER-UNT-ID.          09820059
098300     MOVE COCNTL-BTCH-PRC-DTE      TO SU059-DATE.                 09830046
098400     MOVE DTATTR-FSCL-YR-NBR       TO SU059-FISCAL-YEAR.          09840046
098500     MOVE DTATTR-FSCL-MN-NBR       TO SU059-FISCAL-MONTH.         09850050
098600     MOVE DTATTR-FSCL-WK-NBR       TO SU059-FISCAL-WEEK.          09860050
098700     MOVE DTATTR-SEA-DESC          TO SU059-SEASON.               09870050
098800     MOVE PV-TOT-CTNS-RECEIVED     TO SU059-TOT-CTNS-RECEIVED.    09880046
098900     MOVE PV-TOT-CTNS-CHECKIN      TO SU059-TOT-CTNS-CHECKIN.     09890046
099000     MOVE PV-TOT-CTNS-PHYSICAL     TO SU059-TOT-CTNS-PHYSICAL.    09900046
099100     MOVE PV-TOT-SML               TO SU059-TOT-SML.              09910046
099200     MOVE PV-OUTBOUND-ASN          TO SU059-OUTBOUND-ASN.         09920046
099300     MOVE PV-OUTBOUND-CPS          TO SU059-OUTBOUND-CPS.         09930046
099400     MOVE PV-OUTBOUND-SMO          TO SU059-OUTBOUND-SMO.         09940046
099500     MOVE PV-TOT-P2L               TO SU059-TOT-P2L.              09950046
099600     MOVE PV-SULBXF-P2L            TO SU059-SULBXF-P2L.           09960046
099700     MOVE PV-DISTHD-P2L            TO SU059-DISTHD-P2L.           09970046
099800     WRITE OUTPUT-RECORD                                          09980046
099900       FROM SU059-RECORD.                                         09990046
100000*                                                                 10000029
100100 5000-OPEN-OUTBOUND-CSR.                                          10010053
100200                                                                  10020001
100300     EXEC SQL                                                     10030001
100400         OPEN  SUT_OTBOUND_CSR                                    10040007
100500     END-EXEC.                                                    10050001
100600                                                                  10060001
100700     EVALUATE TRUE                                                10070001
100800         WHEN SQLCODE = +0                                        10080001
100900             SET PS-NOT-END-OUTBOUND-CURSOR TO TRUE               10090007
101000         WHEN SQLCODE < ZERO                                      10100001
101100         WHEN SQLCODE > ZERO                                      10110001
101200         WHEN SQLWARN0 NOT = SPACE                                10120001
101300             MOVE '5000-OPEN-OUTBOUND-CSR'                        10130053
101400                                      TO PV-PARAGRAPH             10140001
101500             MOVE 'OPEN'              TO PV-DB2-FUNCTION          10150001
101600             PERFORM 9100-SQL-ABEND                               10160002
101700     END-EVALUATE.                                                10170001
101800                                                                  10180001
101900 5100-FETCH-OUTBOUND-CURSOR.                                      10190053
102000                                                                  10200001
102100     EXEC SQL                                                     10210001
102200         FETCH SUT_OTBOUND_CSR                                    10220007
102300         INTO  :PV-OUTBOUND-COUNT                                 10230007
102400             , :SUT00024-ORGN-LOC-NBR                             10240007
102500             , :SUT00024-CART-SRC-CDE                             10250007
102600     END-EXEC.                                                    10260001
102700                                                                  10270001
102800     EVALUATE TRUE                                                10280001
102900         WHEN SQLCODE = +0                                        10290001
103000             CONTINUE                                             10300029
103100         WHEN SQLCODE = +100                                      10310001
103200             SET PS-END-OUTBOUND-CURSOR TO TRUE                   10320007
103300         WHEN SQLCODE < ZERO                                      10330001
103400         WHEN SQLCODE > ZERO                                      10340001
103500         WHEN SQLWARN0 NOT = SPACE                                10350001
103600             MOVE '5100-FETCH-OUTBOUND-CURSOR'                    10360053
103700                                      TO PV-PARAGRAPH             10370001
103800             MOVE 'FETCH'             TO PV-DB2-FUNCTION          10380001
103900             PERFORM 9100-SQL-ABEND                               10390002
104000     END-EVALUATE.                                                10400001
104100                                                                  10410001
104200 5200-CLOSE-OUTBOUND-CURSOR.                                      10420053
104300                                                                  10430001
104400     EXEC SQL                                                     10440001
104500         CLOSE SUT_OTBOUND_CSR                                    10450007
104600     END-EXEC.                                                    10460001
104700     EVALUATE TRUE                                                10470001
104800         WHEN SQLCODE = +0                                        10480001
104900             CONTINUE                                             10490001
105000         WHEN SQLCODE < ZERO                                      10500001
105100         WHEN SQLCODE > ZERO                                      10510001
105200         WHEN SQLWARN0 NOT = SPACE                                10520001
105300             MOVE '5200-CLOSE-OUTBOUND-CURSOR'                    10530053
105400                                      TO PV-PARAGRAPH             10540001
105500             MOVE 'CLOSE'             TO PV-DB2-FUNCTION          10550001
105600             PERFORM 9100-SQL-ABEND                               10560002
105700     END-EVALUATE.                                                10570001
105800                                                                  10580001
105900                                                                  10590018
106000 6000-OPEN-P2L-CHECKIN-CSR.                                       10600053
106100                                                                  10610018
106200     EXEC SQL                                                     10620018
106300         OPEN  P2L_CHECKIN_CSR                                    10630018
106400     END-EXEC.                                                    10640018
106500                                                                  10650018
106600     EVALUATE TRUE                                                10660018
106700         WHEN SQLCODE = +0                                        10670018
106800             SET PS-NOT-END-P2L-CHECKIN-CURSOR TO TRUE            10680018
106900         WHEN SQLCODE < ZERO                                      10690018
107000         WHEN SQLCODE > ZERO                                      10700018
107100         WHEN SQLWARN0 NOT = SPACE                                10710018
107200             MOVE '6000-OPEN-P2L-CHECKIN-CSR'                     10720053
107300                                      TO PV-PARAGRAPH             10730018
107400             MOVE 'OPEN'              TO PV-DB2-FUNCTION          10740018
107500             PERFORM 9100-SQL-ABEND                               10750018
107600     END-EVALUATE.                                                10760018
107700                                                                  10770018
107800 6100-FETCH-P2L-CHECKIN-CURSOR.                                   10780053
107900                                                                  10790018
108000     EXEC SQL                                                     10800018
108100         FETCH P2L_CHECKIN_CSR                                    10810018
108200         INTO   :PV-SULBXF-COUNT                                  10820018
108300            ,   :SHUNLO-OPER-UNT-ID                               10830018
108400     END-EXEC.                                                    10840018
108500                                                                  10850018
108600     EVALUATE TRUE                                                10860018
108700         WHEN SQLCODE = +0                                        10870018
108800             CONTINUE                                             10880039
108900         WHEN SQLCODE = +100                                      10890018
109000             SET PS-END-P2L-CHECKIN-CURSOR TO TRUE                10900018
109100         WHEN SQLCODE < ZERO                                      10910018
109200         WHEN SQLCODE > ZERO                                      10920018
109300         WHEN SQLWARN0 NOT = SPACE                                10930018
109400             MOVE '6100-FETCH-P2L-CHECKIN-CURSOR'                 10940053
109500                                      TO PV-PARAGRAPH             10950018
109600             MOVE 'FETCH'             TO PV-DB2-FUNCTION          10960018
109700             PERFORM 9100-SQL-ABEND                               10970018
109800     END-EVALUATE.                                                10980018
109900                                                                  10990018
110000 6200-CLOSE-P2L-CHECKIN-CURSOR.                                   11000053
110100                                                                  11010018
110200     EXEC SQL                                                     11020018
110300         CLOSE P2L_CHECKIN_CSR                                    11030018
110400     END-EXEC.                                                    11040018
110500     EVALUATE TRUE                                                11050018
110600         WHEN SQLCODE = +0                                        11060018
110700             CONTINUE                                             11070018
110800         WHEN SQLCODE < ZERO                                      11080018
110900         WHEN SQLCODE > ZERO                                      11090018
111000         WHEN SQLWARN0 NOT = SPACE                                11100018
111100             MOVE '6200-CLOSE-P2L-CHECKIN-CURSOR'                 11110053
111200                                      TO PV-PARAGRAPH             11120018
111300             MOVE 'CLOSE'             TO PV-DB2-FUNCTION          11130018
111400             PERFORM 9100-SQL-ABEND                               11140018
111500     END-EVALUATE.                                                11150018
111600                                                                  11160018
111700*                                                                 11170007
111800 7000-OPEN-DC-CURSOR.                                             11180007
111900                                                                  11190007
112000     EXEC SQL                                                     11200007
112100         OPEN  DC_CSR                                             11210007
112200     END-EXEC.                                                    11220007
112300                                                                  11230007
112400     EVALUATE TRUE                                                11240007
112500         WHEN SQLCODE = +0                                        11250007
112600             SET PS-NOT-END-DC-CURSOR TO TRUE                     11260007
112700         WHEN SQLCODE < ZERO                                      11270007
112800         WHEN SQLCODE > ZERO                                      11280007
112900         WHEN SQLWARN0 NOT = SPACE                                11290007
113000             MOVE '7000-OPEN-DC-CURSOR'                           11300007
113100                                      TO PV-PARAGRAPH             11310007
113200             MOVE 'OPEN'              TO PV-DB2-FUNCTION          11320007
113300             PERFORM 9100-SQL-ABEND                               11330007
113400     END-EVALUATE.                                                11340007
113500                                                                  11350007
113600 7100-FETCH-DC-CURSOR.                                            11360007
113700                                                                  11370007
113800     EXEC SQL                                                     11380007
113900         FETCH DC_CSR                                             11390007
114000          INTO :XLT00010-LOC-NBR                                  11400059
114100            ,  :XLT00010-LOC-NM                                   11410059
114200     END-EXEC.                                                    11420007
114300                                                                  11430007
114400     EVALUATE TRUE                                                11440007
114500         WHEN SQLCODE = +0                                        11450007
114600             CONTINUE                                             11460007
114700         WHEN SQLCODE = +100                                      11470007
114800             SET PS-END-DC-CURSOR   TO TRUE                       11480007
114900         WHEN SQLCODE < ZERO                                      11490007
115000         WHEN SQLCODE > ZERO                                      11500007
115100         WHEN SQLWARN0 NOT = SPACE                                11510007
115200             MOVE '7100-FETCH-DC-CURSOR'                          11520007
115300                                      TO PV-PARAGRAPH             11530007
115400             MOVE 'FETCH'             TO PV-DB2-FUNCTION          11540007
115500             PERFORM 9100-SQL-ABEND                               11550007
115600     END-EVALUATE.                                                11560007
115700                                                                  11570007
115800 7200-CLOSE-DC-CURSOR.                                            11580007
115900                                                                  11590007
116000     EXEC SQL                                                     11600007
116100         CLOSE DC_CSR                                             11610007
116200     END-EXEC.                                                    11620007
116300     EVALUATE TRUE                                                11630007
116400         WHEN SQLCODE = +0                                        11640007
116500             CONTINUE                                             11650007
116600         WHEN SQLCODE < ZERO                                      11660007
116700         WHEN SQLCODE > ZERO                                      11670007
116800         WHEN SQLWARN0 NOT = SPACE                                11680007
116900             MOVE '7200-CLOSE-DC-CURSOR'                          11690007
117000                                      TO PV-PARAGRAPH             11700007
117100             MOVE 'CLOSE'             TO PV-DB2-FUNCTION          11710007
117200             PERFORM 9100-SQL-ABEND                               11720007
117300     END-EVALUATE.                                                11730007
117400                                                                  11740007
117500 8000-READ-CONTROL-REC.                                           11750055
117600                                                                  11760055
117700     READ CONTROL-FILE INTO                                       11770055
117800           PV-CONTROL-REC                                         11780055
117900     AT END                                                       11790055
118000         CONTINUE                                                 11800055
118100     NOT AT END                                                   11810055
118200         DISPLAY 'DATE CONTROL CARD:'                             11820055
118300         DISPLAY PV-CONTROL-REC                                   11830055
118400         DISPLAY SPACES                                           11840055
118500     END-READ.                                                    11850055
118600                                                                  11860055
118700 9100-SQL-ABEND.                                                  11870007
118800     MOVE SQLCODE                     TO SQLCODE2.                11880001
118900     MOVE SQLERRD(3)                  TO SQLERRD3.                11890001
119000                                                                  11900001
119100     DISPLAY '** ABEND **         ** = SQLERROR'.                 11910001
119200     DISPLAY '** PROGRAM   ** = ' PC-SUKRP040.                    11920001
119300     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH.                   11930001
119400     DISPLAY '** OPERATION ** = ' PV-DB2-FUNCTION.                11940001
119500                                                                  11950001
119600     DISPLAY '** SQLCODE          ** = ' SQLCODE2.                11960001
119700     DISPLAY '** ROWS PROCESSED   ** = ' SQLERRD3.                11970001
119800     DISPLAY '** SQLERRM          ** = ' SQLERRM.                 11980001
119900     DISPLAY '** SQLERRMC         ** = ' SQLERRMC.                11990001
120000                                                                  12000001
120100                                                                  12010001
120200     MOVE +4013                       TO ABEND-CODE.              12020001
120300     CALL 'ILBOABN0' USING ABEND-CODE.                            12030001
