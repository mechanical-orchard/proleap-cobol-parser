000100*-----------------------*                                         00010032
000200 IDENTIFICATION DIVISION.                                         00020032
000300*-----------------------*                                         00030032
000400 PROGRAM-ID.    TRKCS102.                                         00040032
000500 AUTHOR.        LARRY SCHLEICHER - STRATAGEM.                     00050032
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060032
000700 DATE-WRITTEN.  08-17-95.                                         00070032
000800 DATE-COMPILED.                                                   00080032
000900                                                                  00090032
001000*---------------------------------------------------------------* 00100032
001100*    Y102 - LIST SHIPPING STATUS OF FREIGHT BILL OR PO.         * 00110032
001200*                                                               * 00120032
001300*    THIS PROGRAM GENERATES A LIST OF SHIPMENTS COMING INTO A   * 00130032
001400*    DISTRIBUTION CENTER BY FREIGHT BILL OR PURCHASE ORDER.     * 00140032
001500*    ONLY SHIPMENTS THAT HAVE ARRIVED IN THE PAST TWO WEEKS     * 00150032
001600*    OR HAVE NOT YET ARRIVED ARE LISTED.  SHIPMENT INFORMATION  * 00160032
001700*    MUST MATCH THE FREIGHT BILL, PURCHASE ORDER AND DESTINATION* 00170032
001800*    CRITERIA SPECIFICATION COMBINATION.  SHIPMENTS ARE LISTED  * 00180032
001900*    BY ETA FROM EARLIEST TO LATEST.                            * 00190032
002000*                                                               * 00200032
001300*  CHANGED 10/24/14 BY CHERI PARMLEY       CHG#0094517          * 00201062
001400*   EXPANDED PO# FROM 7 TO 8 DIGITS, DECREASED PRO-NBR BY 1     * 00202062
000110******************************************************************00203062
263697*---------------------------------------------------------------* 00204070
263697* CHANGED 11/08/2021    BY JIM HUNTER      WR: CHG0263697         00205070
263697* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00206070
263697* MAKING THE CALL DYNAMIC VS STATIC.                              00207070
002100*---------------------------------------------------------------* 00210032
CICS  * CHANGED 11/18/2022    BY JIM HUNTER      WR: CHG0278495         00211071
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00212071
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00213071
CICS  *-----------------------------------------------------------------00214071
002200                                                                  00220032
002300 ENVIRONMENT DIVISION.                                            00230032
002500 DATA DIVISION.                                                   00240032
002700 WORKING-STORAGE SECTION.                                         00250032
002800                                                                  00260032
002900 01  PC-PROGRAM-CONSTANTS.                                        00270032
003000     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00280032
003100                                                    'TR102A  '.   00290032
003200     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00300032
003300                                                    'TRKM102 '.   00310032
003400     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00320032
003500                                                    'TRKCS102'.   00330032
003800     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00340032
003900     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00350032
004000     05  PC-DTL-QUEUE-SEQ               PIC  9(01)  VALUE 3.      00360032
004100     05  PC-CRIT-SPEC-FORMAT            PIC  X(01)  VALUE '1'.    00370032
004200     05  PC-LIST-FORMAT                 PIC  X(01)  VALUE '2'.    00380032
004300     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +14     00390032
004400                                                    COMP SYNC.    00400032
004500     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00410032
004600                                                    COMP SYNC.    00420032
004700     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00430032
004800                                                    +1000000      00440032
004900                                                    COMP-3.       00450032
005000     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      00460032
005100                                                    COMP SYNC.    00470032
005200     05  PC-MAX-RETRIES                 PIC S9(3)    VALUE 3      00480032
005300                                                     COMP-3.      00490032
005400     05  PC-DEFAULT-DATE                PIC X(10)    VALUE        00500032
005500         '0001-01-01'.                                            00510032
005600     05  PC-DEFAULT-TIME                PIC  X(16)  VALUE         00520032
005700                                             '-00.00.00.000000'.  00530032
005800     05  PC-DEFAULT-TO-TIME             PIC  X(16)  VALUE         00540032
005900                                             '-23.59.59.999999'.  00550032
006000     05  PC-2                           PIC 9(05)    VALUE 2.     00560032
006100     05  PC-5                           PIC 9(05)    VALUE 5.     00570032
006200     05  PC-AR                          PIC X(2)     VALUE 'AR'.  00580032
006300     05  PC-D                           PIC X(2)     VALUE 'D '.  00590032
006400     05  PC-DE                          PIC X(2)     VALUE 'DE'.  00600032
006500     05  PC-DELIVERED                   PIC X(2)     VALUE '49'.  00610032
006600     05  PC-AG                          PIC X(2)     VALUE 'AG'.  00620032
006700     05  PC-DELETED                     PIC X(2)     VALUE '99'.  00630032
006800     05  PC-AF                          PIC X(2)     VALUE 'AF'.  00640032
006900     05  PC-49                          PIC X(2)     VALUE '49'.  00650032
007000     05  PC-DASH                        PIC X        VALUE  '-'.  00660032
007100     05  PC-SLASH                       PIC X(1)     VALUE '/'.   00670032
007200     05  PC-NEG-1                       PIC S9(03)   VALUE -1     00680032
007300                                                     COMP-3.      00690032
007400     05  PC-CANCELLED                   PIC X(2)     VALUE 'CA'.  00700032
007500     05  PC-COMPLETE-VALUES             PIC X(2)     VALUE SPACES.00710032
007600         88  PC-COMPLETE                             VALUES       00720032
007700             'CA' 'AC' 'AP' 'CP'.                                 00730032
007800     05  PC-ACTIVE                      PIC X(1)     VALUE 'A'.   00740032
007900     05  PC-C                           PIC X(1)     VALUE 'C'.   00750032
008000     05  PC-E                           PIC X(1)     VALUE 'E'.   00760032
008100     05  PC-I                           PIC X(1)     VALUE 'I'.   00770032
008200     05  PC-L                           PIC X(1)     VALUE 'L'.   00780032
008300     05  PC-U                           PIC X(1)     VALUE 'U'.   00790032
008400     05  PC-OCC-LIMIT                   PIC S9(3)    VALUE +999   00800032
008500                                                     COMP-3.      00810032
008600                                                                  00820032
008700 01  DK-DB2-KEYS.                                                 00830032
008800     05  DK-OPER-UNT-ID                 PIC S9(4)   COMP VALUE +0.00840032
008900     05  DK-FCLTY-ID                    PIC S9(4)   COMP VALUE +0.00850032
009000     05  DK-PRO-SCAC-ID                 PIC X(04)   VALUE SPACES. 00860032
009100     05  DK-PO-NBR                      PIC S9(9)   VALUE +0      00870032
009200                                             COMP.                00880032
009300     05  DK-DEPT-NBR                    PIC X(03)   VALUE SPACES. 00890034
009400     05  DK-PRO-NBR                     PIC X(22)   VALUE SPACES. 00900032
009500     05  DK-ETA-DTE                     PIC X(26)   VALUE SPACES. 00910032
009600     05  DK-ETA-TO-DTE                  PIC X(26)   VALUE SPACES. 00920032
009800                                                                  00930032
009900 01  PC-TSYMSG-NUMBERS.                                           00940032
010000     05  PC-TSYMSG-00008                PIC 9(5)    VALUE 00008.  00950032
010100     05  PC-TSYMSG-00009                PIC 9(5)    VALUE 00009.  00960032
010200     05  PC-TSYMSG-00050                PIC 9(5)    VALUE 00050.  00970032
010300     05  PC-TSYMSG-00069                PIC 9(5)    VALUE 00069.  00980032
010400     05  PC-TSYMSG-00070                PIC 9(5)    VALUE 00070.  00990032
010500     05  PC-TSYMSG-00101                PIC 9(5)    VALUE 00101.  01000032
010600     05  PC-TSYMSG-00279                PIC 9(5)    VALUE 00279.  01010032
010700     05  PC-TSYMSG-00302                PIC 9(5)    VALUE 00302.  01020032
010800     05  PC-TSYMSG-00336                PIC 9(5)    VALUE 00336.  01030032
010900     05  PC-TSYMSG-00985                PIC 9(5)    VALUE 00985.  01040032
011000                                                                  01050032
011100 01  PS-PROGRAM-SUBSCRIPTS.                                       01060032
011200     05  PS-SUB                         PIC S9(04)   VALUE +0     01070032
011300                                                     COMP SYNC.   01080032
011400                                                                  01090032
011500 01  PS-PROGRAM-SWITCHES.                                         01100032
011600     05  PS-ERROR-SW                    PIC X(01)    VALUE 'Y'.   01110032
011700         88  PS-NO-ERROR                             VALUE 'Y'.   01120032
011800         88  PS-ERROR                                VALUE 'N'.   01130032
011900     05  PS-COMMAREA-SW                 PIC X(01)    VALUE 'N'.   01140032
012000         88  PS-COMMAREA-VALID                       VALUE 'Y'.   01150032
012100         88  PS-COMMAREA-NOT-VALID                   VALUE 'N'.   01160032
012200     05  PS-LIST-END-SW                 PIC X(01)    VALUE 'N'.   01170032
012300         88  PS-LIST-END                             VALUE 'Y'.   01180032
012400         88  PS-NO-LIST-END                          VALUE 'N'.   01190032
012500     05  PS-CURSOR-TYPE-SW              PIC X(01)    VALUE 'X'.   01200032
012600         88  PS-PO-SCAC                              VALUE '1'.   01210032
012700         88  PS-PO                                   VALUE '2'.   01220032
012800         88  PS-SCAC                                 VALUE '3'.   01230032
012900         88  PS-OPER-PO-SCAC                         VALUE '4'.   01240032
013000         88  PS-OPER-PO                              VALUE '5'.   01250032
013100         88  PS-OPER-SCAC                            VALUE '6'.   01260032
013200         88  PS-DEPT                                 VALUE '7'.   01270032
013300         88  PS-OPER-DEPT                            VALUE '8'.   01280032
013400         88  PS-PRO-SCAC                             VALUE '9'.   01290032
013500         88  PS-OPER-PRO-SCAC                        VALUE 'A'.   01300032
013600     05  PS-END-OF-SHPTPO-SW            PIC X(01)    VALUE 'N'.   01310032
013700         88  PS-NOT-END-OF-SHPTPO-CSR                VALUE 'N'.   01320032
013800         88  PS-END-OF-SHPTPO-CSR                    VALUE 'Y'.   01330032
013900     05  PS-CSR-SW                      PIC X(01)    VALUE 'N'.   01340032
014000         88  PS-END-OF-CSR                           VALUE 'Y'.   01350032
014100         88  PS-NOT-END-OF-CSR                       VALUE 'N'.   01360032
014200     05  PS-FIRST-SW                    PIC X(01)    VALUE 'Y'.   01370032
014300         88  PS-FIRST-PROCESSED                      VALUE 'Y'.   01380032
014400         88  PS-NOT-FIRST-PROCESSED                  VALUE 'N'.   01390032
014500     05  PS-OCC-LIMIT-SW                PIC X(01)    VALUE 'N'.   01400032
014600         88  PS-OCC-LIMIT-EXCEEDED                   VALUE 'Y'.   01410032
014700         88  PS-OCC-LIMIT-NOT-EXCEEDED               VALUE 'N'.   01420032
014800     05  PS-DATA-HAS-BEEN-MOVED-SW      PIC X(01)    VALUE 'N'.   01430032
014900         88  PS-DATA-HAS-NOT-BEEN-MOVED              VALUE 'N'.   01440032
015000         88  PS-DATA-HAS-BEEN-MOVED                  VALUE 'Y'.   01450032
015200     EJECT                                                        01460032
015300 01  PV-PROGRAM-VARIABLES.                                        01470032
015400     05  PV-REMAINDER                   PIC S9(04)   VALUE +0     01480032
015500                                                     COMP SYNC.   01490032
015600     05  PV-READ-COUNT                  PIC S9(09)   VALUE +0     01500032
015700                                                     COMP-3.      01510032
015800     05  PV-TOP-ITEM                    PIC S9(09)   VALUE +0     01520032
015900                                                     COMP-3.      01530032
016000     05  PV-BOTTOM-ITEM                 PIC S9(09)   VALUE +0     01540032
016100                                                     COMP-3.      01550032
016200     05  PV-BLOCK-NUMBER                PIC S9(04)   VALUE +0     01560032
016300                                                     COMP SYNC.   01570032
016400     05  PV-CICS-RESP                   PIC S9(04)   VALUE +0     01580032
016500                                                     COMP SYNC.   01590032
016600     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)   VALUE +0     01600032
016700                                                     COMP SYNC.   01610032
016800     05  PV-LIST-ITEM-NUMBER            PIC S9(04)   VALUE +0     01620032
016900                                                     COMP SYNC.   01630032
016901     05  PV-VEND-NBR                    PIC S9(9)    VALUE ZEROS  01640032
016910                                                     COMP.        01650032
017000     05  PV-SQL-SUB                     PIC S9(4)    COMP.        01660032
017100*    05  PV-UNION-IND                   PIC X(01)    VALUE SPACES.01670032
017200     05  PV-P                           PIC X(1)     VALUE SPACES.01680032
017300     05  PV-OPER-UNIT-FCLTY.                                      01690032
017400         10  PV-OPER-UNT-ID             PIC X(04)    VALUE SPACES.01700032
017500         10  FILLER                     PIC X(01)    VALUE '-'.   01710032
017600         10  PV-FCLTY-ID                PIC X(04)    VALUE SPACES.01720032
017700     05  PV-DATE                        PIC X(10)    VALUE SPACES.01730032
017800     05  PV-ETA-DTE                     PIC X(10)    VALUE SPACES.01740032
017900     05  PV-SHIPST-PICKED-UP            PIC X(10)    VALUE SPACES.01750032
018000     05  PV-ETA-DATE-FROM               PIC X(10)    VALUE SPACE. 01760032
018200     05  PV-ETA-DATE-TO                 PIC X(10)    VALUE SPACE. 01770032
018300     05  PV-DTE.                                                  01780032
018400         10  PV-DTE-CCYY                PIC X(4)     VALUE SPACES.01790032
018500         10  FILLER                     PIC X(1)     VALUE SPACES.01800032
018600         10  PV-DTE-MM                  PIC X(2)     VALUE SPACES.01810032
018700         10  FILLER                     PIC X(1)     VALUE SPACES.01820032
018800         10  PV-DTE-DD                  PIC X(2)     VALUE SPACES.01830032
018900     05  PV-TMST.                                                 01840032
019000         10  PV-TMST-CCYY               PIC X(4)     VALUE SPACES.01850032
019100         10  FILLER                     PIC X(1)     VALUE SPACES.01860032
019200         10  PV-TMST-MM                 PIC X(2)     VALUE SPACES.01870032
019300         10  FILLER                     PIC X(1)     VALUE SPACES.01880032
019400         10  PV-TMST-DD                 PIC X(2)     VALUE SPACES.01890032
019500         10  FILLER                     PIC X(16)    VALUE SPACES.01900032
019600     05  PV-MM-DD.                                                01910032
019700         10  PV-MMDD-MM                 PIC X(2)     VALUE SPACES.01920032
019800         10  PV-MMDD-SLASH              PIC X(1)     VALUE '/'.   01930032
019900         10  PV-MMDD-DD                 PIC X(2)     VALUE SPACES.01940032
020000     05  PV-MM-DD-ETA.                                            01950032
020100         10  PV-MMDD-ETA-MM             PIC X(2)     VALUE SPACES.01960032
020200         10  PV-MMDD-ETA-SLASH          PIC X(1)     VALUE '/'.   01970032
020300         10  PV-MMDD-ETA-DD             PIC X(2)     VALUE SPACES.01980032
020400     05  PV-WINDOW-LOW-DATE.                                      01990032
020500         10  PV-WINDOW-LOW-CC           PIC XX  VALUE SPACES.     02000032
020600         10  PV-WINDOW-LOW-YY           PIC XX  VALUE SPACES.     02010032
020700         10  FILLER                     PIC X   VALUE '-'.        02020032
020800         10  PV-WINDOW-LOW-MM           PIC XX  VALUE SPACES.     02030032
020900         10  FILLER                     PIC X   VALUE '-'.        02040032
021000         10  PV-WINDOW-LOW-DD           PIC XX  VALUE SPACES.     02050032
021100                                                                  02060032
021200     05  PV-WINDOW-HIGH-DATE.                                     02070032
021300         10  PV-WINDOW-HIGH-CC          PIC XX  VALUE SPACES.     02080032
021400         10  PV-WINDOW-HIGH-YY          PIC XX  VALUE SPACES.     02090032
021500         10  FILLER                     PIC X   VALUE '-'.        02100032
021600         10  PV-WINDOW-HIGH-MM          PIC XX  VALUE SPACES.     02110032
021700         10  FILLER                     PIC X   VALUE '-'.        02120032
021800         10  PV-WINDOW-HIGH-DD          PIC XX  VALUE SPACES.     02130032
021900     05  PV-NEXT-OCC-NBR                PIC S9(03)   VALUE +0     02140032
022000                                                     COMP-3.      02150032
022400                                                                  02160032
022500 01  PV-NULLS-TABLE.                                              02170032
022600     05  PV-VHTRIP-VEH-NBR-NULL         PIC S9(04)   VALUE +0     02180032
022700                                                     COMP SYNC.   02190032
022800     05  PV-SHIPMT-TRIP-ID-NULL         PIC S9(04)   VALUE +0     02200032
022900                                                     COMP SYNC.   02210032
023200     EJECT                                                        02220032
023300*----------------------------------------------------------------*02230032
023400*  WORK AREA PASSED IN CALL TO DPKUT500                          *02240032
023500*----------------------------------------------------------------*02250032
023600                                                                  02260032
023700     COPY DPWS500.                                                02270032
023800                                                                  02280032
023900*---------------------------------------------------------------* 02290032
CICS  *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 02300071
024100*---------------------------------------------------------------* 02310032
024200                                                                  02320032
024300     COPY DPWS030.                                                02330032
CICS       COPY DPWS930.                                                02331071
024400                                                                  02340032
024500*---------------------------------------------------------------* 02350032
024600*    STANDARD COMMAREA.                                         * 02360032
024700*---------------------------------------------------------------* 02370032
024800                                                                  02380032
024900     COPY DPWS020.                                                02390032
025000     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02400032
025100                                                                  02410032
025200*---------------------------------------------------------------* 02420032
025300*    INTER-APPLICATION COMMAREA.                                * 02430032
025400*---------------------------------------------------------------* 02440032
025500                                                                  02450032
025600         10  INTER-APPL-COMM-AREA       PIC X(200).               02460032
025700     COPY TRWS001.                                                02470032
025800*---------------------------------------------------------------* 02480032
025900*    SPECIFIC COMMMAREA FOR TRKCS102.                           * 02490032
026000*---------------------------------------------------------------* 02500032
026100         10  ASC-SPECIFIC-COMMAREA.                               02510032
026200             15  ASC-LIST-KEYS.                                   02520032
026300                 20  ASC-KEY-OPER-UNT-ID             PIC S9(04)   02530032
026400                                                         COMP.    02540032
026500                 20  ASC-KEY-FCLTY-ID                PIC S9(04)   02550032
026600                                                         COMP.    02560032
026700                 20  ASC-KEY-PRO-SCAC-ID             PIC  X(04).  02570032
      *CLP 10/24/14                                                     02571062
026800                 20  ASC-KEY-PO-NBR                  PIC  9(08).  02580067
026900                 20  ASC-KEY-DEPT-NBR                PIC  9(04).  02590033
027000                 20  ASC-KEY-PRO-NBR                 PIC  X(22).  02600032
027100                 20  ASC-KEY-ETA-DTE.                             02610032
027200                     25  ASC-KEY-ETA-CCYY            PIC X(04).   02620032
027300                     25  ASC-KEY-ETA-DASH-1          PIC X(01).   02630032
027400                     25  ASC-KEY-ETA-MM              PIC X(02).   02640032
027500                     25  ASC-KEY-ETA-DASH-2          PIC X(01).   02650032
027600                     25  ASC-KEY-ETA-DD              PIC X(02).   02660032
027700                     25  ASC-KEY-ETA-TIME            PIC X(16).   02670032
027800                 20  ASC-KEY-ETA-TO-DTE.                          02680032
027900                     25  ASC-KEY-ETA-TO-CCYY         PIC X(04).   02690032
028000                     25  ASC-KEY-ETA-TO-DASH-1       PIC X(01).   02700032
028100                     25  ASC-KEY-ETA-TO-MM           PIC X(02).   02710032
028200                     25  ASC-KEY-ETA-TO-DASH-2       PIC X(01).   02720032
028300                     25  ASC-KEY-ETA-TO-DD           PIC X(02).   02730032
028400                     25  ASC-KEY-ETA-TO-TIME         PIC X(16).   02740032
028500             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                02750032
028600                 20  ASC-ITEM-ARRAY.                              02760032
028700                                                                  02770032
028800                     25  ASC-ITEM-ENTRIES OCCURS 14 TIMES.        02780032
028900                         30  ASC-LIST-ITEM-NUMBER                 02790032
029000                                                     PIC S9(09)   02800032
029100                                                         COMP-3.  02810032
029200                         30  ASC-DEPT                PIC X(04).   02820054
029201                         30  ASC-DEPT-N REDEFINES                 02821054
029202                             ASC-DEPT                PIC ZZZ9.    02822060
      *CLP 10/24/14                                                     02823062
029300                         30  ASC-PO-NBR              PIC 9(08).   02830062
029400                         30  ASC-SHIPPER-NME         PIC X(06).   02840032
029500                         30  ASC-P                   PIC X(01).   02850032
029600                         30  ASC-SCAC-CDE            PIC X(04).   02860032
029700                         30  ASC-PRO-NBR             PIC X(14).   02870032
029800                         30  ASC-LINE                PIC X(04).   02880032
029900                         30  ASC-ETA-DTE             PIC X(05).   02890032
030000                         30  ASC-VHCL-ID             PIC X(10).   02900032
030100                         30  ASC-OPER-UNIT-FCLTY     PIC X(09).   02910032
030200*                        30  ASC-UNION-IND           PIC X(01).   02920032
030300                                                                  02930032
030400                                                                  02940032
030500             15  ASC-BLK-SUB                         PIC S9(04)   02950032
030600                                                         COMP     02960032
030700                                                         SYNC.    02970032
030800             15  ASC-ITEM-SUB                        PIC S9(04)   02980032
030900                                                         COMP     02990032
031000                                                         SYNC.    03000032
031100             15  ASC-SEL-SUB                         PIC S9(04)   03010032
031200                                                         COMP.    03020032
031300             15  ASC-SEL-ITEM                        PIC S9(04)   03030032
031400                                                         COMP.    03040032
031500             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   03050032
031600                                                         COMP-3.  03060032
031700             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   03070032
031800                                                         COMP-3.  03080032
031900             15  ASC-NUMBER-OF-TS-ITEMS              PIC S9(05)   03090032
032000                                                         COMP-3.  03100032
032100             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   03110032
032200                                                         COMP-3.  03120032
032300             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   03130032
032400                                                         COMP-3.  03140032
032500             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   03150032
032600                                                         COMP-3.  03160032
032700             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   03170032
032800                                                         COMP     03180032
032900                                                         SYNC.    03190032
033000             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   03200032
033100                                                         COMP-3.  03210032
033200             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   03220032
033300                                                         COMP-3.  03230032
033400             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  03240032
033500                 88  ASC-ITEMS-LEFT-ON-DB              VALUE 'Y'. 03250032
033600                 88  ASC-NO-ITEMS-LEFT-ON-DB           VALUE 'N'. 03260032
033700             15  ASC-USE-SELECTION-QUEUE-IND         PIC  X(01).  03270032
033800                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 03280032
033900             15  ASC-DESC-LINE-IND                   PIC  X(01).  03290032
034000                 88  ASC-DESC-LINE-DONE                VALUE 'Y'. 03300032
034100             15  ASC-CORR-LINE-IND                   PIC  X(01).  03310032
034200                 88  ASC-CORR-LINE-DONE                VALUE 'Y'. 03320032
034300             15  ASC-LIST-QUEUE-NAME.                             03330032
034400                 20  ASC-LIST-TERM-ID                PIC  X(04).  03340032
034500                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   03350032
034600                                                         COMP-3.  03360032
034700                 20  ASC-LIST-SEQ                    PIC  9(01).  03370032
034800             15  ASC-SEL-QUEUE-NAME.                              03380032
034900                 20  ASC-SEL-TERM-ID                 PIC  X(04).  03390032
035000                 20  ASC-SEL-TASK-NUMBER             PIC S9(05)   03400032
035100                                                          COMP-3. 03410032
035200                 20  ASC-SEL-SEQ                     PIC  9(01).  03420032
035300             15  ASC-DTL-QUEUE-NAME.                              03430032
035400                 20  ASC-DTL-TERM-ID                 PIC  X(04).  03440032
035500                 20  ASC-DTL-TASK-NUMBER             PIC S9(05)   03450032
035600                                                         COMP-3.  03460032
035700                 20  ASC-DTL-SEQ                     PIC  9(01).  03470032
035800                                                                  03480032
035900             15  ASC-START-ITEM-REQUEST.                          03490032
036000                 20  ASC-START-ITEM-REQUEST-N        PIC  9(05).  03500032
036200     EJECT                                                        03510032
036300*---------------------------------------------------------------* 03520032
036400*    MESSAGE SELECTION TSQ B QUEUE RECORD LAYOUT.               * 03530032
036500*---------------------------------------------------------------* 03540032
036600                                                                  03550032
036700     COPY DPWS057.                                                03560032
036900     EJECT                                                        03570032
037000*---------------------------------------------------------------* 03580032
037100*    ABEND PROCESSING COPYBOOK.                                 * 03590032
037200*---------------------------------------------------------------* 03600032
037300                                                                  03610032
037400     COPY DPWS013.                                                03620032
037600     EJECT                                                        03630032
037700*---------------------------------------------------------------* 03640032
037800*    ATTRIBUTE SETTINGS COPYBOOK.                               * 03650032
037900*---------------------------------------------------------------* 03660032
038000                                                                  03670032
038100     COPY DPWS015.                                                03680032
038200                                                                  03690032
038300*---------------------------------------------------------------* 03700032
038400*    FUNCTION KEYS COPYBOOK.                                    * 03710032
038500*---------------------------------------------------------------* 03720032
038600                                                                  03730032
038700     COPY DPWS016.                                                03740032
038800                                                                  03750032
038900*---------------------------------------------------------------* 03760032
039000*    NUMERIC EDIT LAYOUT.                                       * 03770032
039100*---------------------------------------------------------------* 03780032
039200                                                                  03790032
039300     COPY DPWS010I.                                               03800032
039400     EJECT                                                        03810032
039500*---------------------------------------------------------------* 03820032
039600*    MAP LAYOUT                                                 * 03830032
039700*---------------------------------------------------------------* 03840032
039800                                                                  03850032
039900     COPY TRKM102.                                                03860032
040000                                                                  03870032
040100 01  MR-OCCURS-LAYOUT          REDEFINES  TR102AO.                03880032
040200     05  FILLER                PIC X(137).                        03890062
040300     05  MR-SCROLL-AREA OCCURS 14 TIMES.                          03900032
040400         10  MR-DEPTL          PIC S9(04) COMP.                   03910032
040500         10  MR-DEPTA          PIC  X(01).                        03920032
040600         10  MR-DEPTC          PIC  X(01).                        03930032
040700         10  MR-DEPTH          PIC  X(01).                        03940032
040800         10  MR-DEPT           PIC  X(04).                        03950058
040900                                                                  03960032
041000         10  MR-POL            PIC S9(04) COMP.                   03970032
041100         10  MR-POA            PIC  X(01).                        03980032
041200         10  MR-POC            PIC  X(01).                        03990032
041300         10  MR-POH            PIC  X(01).                        04000032
041400         10  MR-PO-X.                                             04010032
      *CLP 10/24/14                                                     04011062
041500             15  MR-PO         PIC  9(08).                        04020062
041600                                                                  04030032
041700         10  MR-SHIPPERL       PIC S9(04) COMP.                   04040032
041800         10  MR-SHIPPERA       PIC  X(01).                        04050032
041900         10  MR-SHIPPERC       PIC  X(01).                        04060032
042000         10  MR-SHIPPERH       PIC  X(01).                        04070032
042100         10  MR-SHIPPER        PIC  X(06).                        04080032
042200                                                                  04090032
042300         10  MR-PL             PIC S9(04) COMP.                   04100032
042400         10  MR-PA             PIC  X(01).                        04110032
042500         10  MR-PC             PIC  X(01).                        04120032
042600         10  MR-PH             PIC  X(01).                        04130032
042700         10  MR-P              PIC  X(01).                        04140032
042800                                                                  04150032
042900         10  MR-SCACL          PIC S9(04) COMP.                   04160032
043000         10  MR-SCACA          PIC  X(01).                        04170032
043100         10  MR-SCACC          PIC  X(01).                        04180032
043200         10  MR-SCACH          PIC  X(01).                        04190032
043300         10  MR-SCAC           PIC  X(04).                        04200032
043400                                                                  04210032
      *CLP 10/24/14                                                     04211062
043500         10  MR-PROL           PIC S9(04) COMP.                   04220032
043600         10  MR-PROA           PIC  X(01).                        04230032
043700         10  MR-PROC           PIC  X(01).                        04240032
043800         10  MR-PROH           PIC  X(01).                        04250032
043900         10  MR-PRO            PIC  X(19).                        04260062
044000                                                                  04270032
044100         10  MR-LINEL          PIC S9(04) COMP.                   04280032
044200         10  MR-LINEA          PIC  X(01).                        04290032
044300         10  MR-LINEC          PIC  X(01).                        04300032
044400         10  MR-LINEH          PIC  X(01).                        04310032
044500         10  MR-LINE           PIC  X(04).                        04320032
044600                                                                  04330032
044700         10  MR-ETAL           PIC S9(04) COMP.                   04340032
044800         10  MR-ETAA           PIC  X(01).                        04350032
044900         10  MR-ETAC           PIC  X(01).                        04360032
045000         10  MR-ETAH           PIC  X(01).                        04370032
045100         10  MR-ETA            PIC  X(05).                        04380032
045200                                                                  04390032
045300         10  MR-VEHICLL        PIC S9(04) COMP.                   04400032
045400         10  MR-VEHICLA        PIC  X(01).                        04410032
045500         10  MR-VEHICLC        PIC  X(01).                        04420032
045600         10  MR-VEHICLH        PIC  X(01).                        04430032
045700         10  MR-VEHICL         PIC  X(10).                        04440032
045800                                                                  04450032
045900         10  MR-OPER-FCLTYL    PIC S9(04) COMP.                   04460032
046000         10  MR-OPER-FCLTYA    PIC  X(01).                        04470032
046100         10  MR-OPER-FCLTYC    PIC  X(01).                        04480032
046200         10  MR-OPER-FCLTYH    PIC  X(01).                        04490032
046300         10  MR-OPER-FCLTY     PIC  X(09).                        04500032
046500     EJECT                                                        04510032
046600*---------------------------------------------------------------* 04520032
046700*    DB2 AREA FOR THE SHIPMENT TABLE                            * 04530032
046800*---------------------------------------------------------------* 04540032
046900     EXEC SQL                                                     04550032
047000          INCLUDE TSHIPMT                                         04560032
047100     END-EXEC.                                                    04570032
047200     EJECT                                                        04580032
047300*---------------------------------------------------------------* 04590032
047400*    DB2 AREA FOR THE SHIPMENT/PO ASSOCIATION TABLE             * 04600032
047500*---------------------------------------------------------------* 04610032
047600     EXEC SQL                                                     04620032
047700          INCLUDE TSHPTPO                                         04630032
047800     END-EXEC.                                                    04640032
047900                                                                  04650032
048000*---------------------------------------------------------------* 04660032
048100*    DB2 AREA FOR THE SHIPMENT STATUS TABLE                     * 04670032
048200*---------------------------------------------------------------* 04680032
048300     EXEC SQL                                                     04690032
048400          INCLUDE TSHIPST                                         04700032
048500     END-EXEC.                                                    04710032
048600                                                                  04720032
048700*---------------------------------------------------------------* 04730032
048800*    DB2 AREA FOR THE SHIPMENT STATUS TYPE TABLE                * 04740032
048900*---------------------------------------------------------------* 04750032
049000     EXEC SQL                                                     04760032
049100          INCLUDE TSHSTYP                                         04770032
049200     END-EXEC.                                                    04780032
049300                                                                  04790032
049400*---------------------------------------------------------------* 04800032
049500*    DB2 AREA FOR THE TRIP STATUS TYPE TABLE                    * 04810032
049600*---------------------------------------------------------------* 04820032
049700     EXEC SQL                                                     04830032
049800          INCLUDE TTRSTYP                                         04840032
049900     END-EXEC.                                                    04850032
050000                                                                  04860032
050100*---------------------------------------------------------------* 04870032
050200*    DB2 AREA FOR THE VEHICLE TABLE                             * 04880032
050300*---------------------------------------------------------------* 04890032
050400     EXEC SQL                                                     04900032
050500          INCLUDE TVEHICL                                         04910032
050600     END-EXEC.                                                    04920032
050700                                                                  04930032
050800*---------------------------------------------------------------* 04940032
050900*    DB2 AREA FOR THE VEHICLE TRIP TABLE                        * 04950032
051000*---------------------------------------------------------------* 04960032
051100     EXEC SQL                                                     04970032
051200          INCLUDE TVHTRIP                                         04980032
051300     END-EXEC.                                                    04990032
051400                                                                  05000032
051500*---------------------------------------------------------------* 05010032
051600*    DB2 AREA FOR THE TRIP STATUS TABLE                         * 05020032
051700*---------------------------------------------------------------* 05030032
051800     EXEC SQL                                                     05040032
051900          INCLUDE TTRIPST                                         05050032
052000     END-EXEC.                                                    05060032
052100                                                                  05070032
052200*---------------------------------------------------------------* 05080032
052300*    DB2 AREA FOR THE EXTERNAL ENTERPRISE TABLE                 * 05090032
052400*---------------------------------------------------------------* 05100032
052500     EXEC SQL                                                     05110032
052600          INCLUDE TEXTENT                                         05120032
052700     END-EXEC.                                                    05130032
052800                                                                  05140032
052900*---------------------------------------------------------------* 05150032
053000*    DB2 AREA FOR THE EXTERNAL ENTERPRISE NAME TABLE            * 05160032
053100*---------------------------------------------------------------* 05170032
053200     EXEC SQL                                                     05180032
053300          INCLUDE TENTNME                                         05190032
053400     END-EXEC.                                                    05200032
053500                                                                  05210032
053600*---------------------------------------------------------------* 05220032
053700*    DB2 AREA FOR THE FACILITY TABLE                            * 05230032
053800*---------------------------------------------------------------* 05240032
053900     EXEC SQL                                                     05250032
054000          INCLUDE TFACLTY                                         05260032
054100     END-EXEC.                                                    05270032
054200                                                                  05280032
054300*---------------------------------------------------------------* 05290032
054400*    DB2 AREA FOR THE PURCHASE ORDER TABLE                      * 05300032
054500*---------------------------------------------------------------* 05310032
054600     EXEC SQL                                                     05320032
054700          INCLUDE TPURCHS                                         05330032
054800     END-EXEC.                                                    05340032
054900                                                                  05350032
055000*---------------------------------------------------------------* 05360032
055100*    DB2 AREA FOR THE PLANNED SHIPMENT TABLE                    * 05370032
055200*---------------------------------------------------------------* 05380032
055300     EXEC SQL                                                     05390032
055400          INCLUDE TPLNSHP                                         05400032
055500     END-EXEC.                                                    05410032
055600                                                                  05420032
055700*---------------------------------------------------------------* 05430032
055800*    DB2 AREA FOR COMMUNICATIONS                                * 05440032
055900*---------------------------------------------------------------* 05450032
056000     EXEC SQL                                                     05460032
056100          INCLUDE SQLCA                                           05470032
056200     END-EXEC.                                                    05480032
056300*---------------------------------------------------------------* 05490032
056400*    CURSOR FOR THE LIST OF SHIPMENTS WHEN PRO_SCAC_ID, PRO-NBR * 05500032
056500*    AND OPER-UNIT WERE ENTERED ON THE SELECTION CRITERIA SCREEN* 05510032
056600*---------------------------------------------------------------* 05520032
056700     EXEC SQL                                                     05530032
056800          DECLARE  OPER-PO-SCAC CURSOR FOR                        05540032
056900           SELECT  DISTINCT                                       05550032
057000                   A.TRIP_ID,                                     05560032
057100                   A.SHIPT_ID,                                    05570032
057200                   A.PRO_NBR,                                     05580032
057300                   A.PRO_SCAC_ID,                                 05590032
057400*                  A.SHIPPER_NME,                                 05600032
057500                   B.PO_NBR,                                      05610032
057700                   C.OPER_UNT_ID,                                 05630032
057800                   C.FCLTY_ID,                                    05640032
057900                   D.STATUS_DTE,                                  05650032
058000                   '  ',                                          05660032
058100                   H.MANIFEST_NBR,                                05670032
058200                   A.EST_AR_TMST,                                 05680037
058210                   I.DEPT_NBR                                     05681037
058300             FROM  TSHIPMT A,                                     05690032
058400                   TSHPTPO B,                                     05700032
058500                   TTRIPST C,                                     05710032
058600                   TSHIPST D,                                     05720032
058700                   TSHSTYP E,                                     05730032
058800                   TVHTRIP H,                                     05740037
058810                   TPURCHS I                                      05741037
058900            WHERE  A.SHIPT_ID         = B.SHIPT_ID                05750032
059000              AND  A.SHIPT_ID         = D.SHIPT_ID                05760032
059100              AND  D.SHIPT_STATUS_CDE = E.SHIPT_STATUS_CDE        05770032
059200              AND  A.PRO_SCAC_ID      = :DK-PRO-SCAC-ID           05780032
059300              AND  B.PO_NBR           = :DK-PO-NBR                05790032
059400              AND  B.PO_NBR           = I.PO_NBR                  05791037
059401              AND  I.VER_STATUS_CDE   = 'A'                       05792040
059402              AND  A.TRIP_ID          = H.TRIP_ID                 05800032
059500              AND  A.TRIP_ID          = C.TRIP_ID                 05810032
059600              AND  C.OPER_UNT_ID      = :DK-OPER-UNT-ID           05820032
059700              AND  C.FCLTY_ID         = :DK-FCLTY-ID              05830032
059800              AND (A.EST_AR_TMST BETWEEN                          05840032
059900                   :DK-ETA-DTE AND                                05850032
060000                   :DK-ETA-TO-DTE)                                05860032
060100              AND  E.PRTY_CDE         < :PC-49                    05870032
060200              AND  E.PRTY_CDE =                                   05880032
060300                   (SELECT MAX (K.PRTY_CDE)                       05890032
060400                      FROM TSHIPST J,                             05900032
060500                           TSHSTYP K                              05910032
060600                     WHERE J.SHIPT_ID = A.SHIPT_ID                05920032
060700                       AND J.SHIPT_STATUS_CDE =                   05930032
060800                           K.SHIPT_STATUS_CDE)                    05940032
060910         ORDER BY  A.EST_AR_TMST, A.PRO_NBR, B.PO_NBR             05950032
061000     END-EXEC.                                                    05960032
061100                                                                  05970032
061200*---------------------------------------------------------------* 05980032
061300*    CURSOR FOR THE LIST OF SHIPMENTS WHEN PRO_SCAC_ID AND      * 05990032
061400*    PRO_NBR WAS ENTERED ON THE SELECTION CRITERIA SCREEN       * 06000032
061500*---------------------------------------------------------------* 06010032
061600     EXEC SQL                                                     06020032
061700          DECLARE  PO-SCAC CURSOR FOR                             06030032
061800           SELECT  DISTINCT                                       06040032
061900                   A.TRIP_ID,                                     06050032
062000                   A.SHIPT_ID,                                    06060032
062100                   A.PRO_NBR,                                     06070032
062200                   A.PRO_SCAC_ID,                                 06080032
062300*                  A.SHIPPER_NME,                                 06090032
062400                   B.PO_NBR,                                      06100032
062600                   C.OPER_UNT_ID,                                 06120032
062700                   C.FCLTY_ID,                                    06130032
062800                   D.STATUS_DTE,                                  06140032
062900                   '  ',                                          06150032
063000                   H.MANIFEST_NBR,                                06160032
063100                   A.EST_AR_TMST,                                 06170037
063110                   I.DEPT_NBR                                     06171037
063200             FROM  TSHIPMT A,                                     06180032
063300                   TSHPTPO B,                                     06190032
063400                   TTRIPST C,                                     06200032
063500                   TSHIPST D,                                     06210032
063600                   TSHSTYP E,                                     06220032
063700                   TVHTRIP H,                                     06230037
063710                   TPURCHS I                                      06231037
063800            WHERE  A.SHIPT_ID         = B.SHIPT_ID                06240032
063900              AND  A.SHIPT_ID         = D.SHIPT_ID                06250032
064000              AND  D.SHIPT_STATUS_CDE = E.SHIPT_STATUS_CDE        06260032
064100              AND  A.PRO_SCAC_ID      = :DK-PRO-SCAC-ID           06270032
064200              AND  B.PO_NBR           = :DK-PO-NBR                06280032
064300              AND  B.PO_NBR           = I.PO_NBR                  06281037
064301              AND  I.VER_STATUS_CDE   = 'A'                       06282040
064302              AND  A.TRIP_ID          = H.TRIP_ID                 06290032
064400              AND  A.TRIP_ID          = C.TRIP_ID                 06300032
064500              AND (A.EST_AR_TMST BETWEEN                          06310032
064600                   :DK-ETA-DTE AND                                06320032
064700                   :DK-ETA-TO-DTE)                                06330032
064800              AND  E.PRTY_CDE         < :PC-49                    06340032
064900              AND  E.PRTY_CDE =                                   06350032
065000                   (SELECT MAX (K.PRTY_CDE)                       06360032
065100                      FROM TSHIPST J,                             06370032
065200                           TSHSTYP K                              06380032
065300                     WHERE J.SHIPT_ID = A.SHIPT_ID                06390032
065400                       AND J.SHIPT_STATUS_CDE =                   06400032
065500                           K.SHIPT_STATUS_CDE)                    06410032
065610         ORDER BY  A.EST_AR_TMST, A.PRO_NBR, B.PO_NBR             06420032
065700     END-EXEC.                                                    06430032
065900/                                                                 06440032
066000*---------------------------------------------------------------* 06450032
066100*    CURSOR FOR THE LIST OF SHIPMENTS WHEN PO_NBR AND OPER-UNIT * 06460032
066200*    WERE ENTERED ON THE SELECTION CRITERIA SCREEN              * 06470032
066300*---------------------------------------------------------------* 06480032
066400     EXEC SQL                                                     06490032
066500          DECLARE  OPER-PO CURSOR FOR                             06500032
066600           SELECT  DISTINCT                                       06510032
066700                   A.TRIP_ID,                                     06520032
066800                   A.SHIPT_ID,                                    06530032
066900                   A.PRO_NBR,                                     06540032
067000                   A.PRO_SCAC_ID,                                 06550032
067100*                  A.SHIPPER_NME,                                 06560032
067200                   B.PO_NBR,                                      06570032
067400                   C.OPER_UNT_ID,                                 06590032
067500                   C.FCLTY_ID,                                    06600032
067600                   D.STATUS_DTE,                                  06610032
067700                   '  ',                                          06620032
067800                   H.MANIFEST_NBR,                                06630032
067900                   A.EST_AR_TMST,                                 06640037
067910                   I.DEPT_NBR                                     06641037
068000             FROM  TSHIPMT A,                                     06650032
068100                   TSHPTPO B,                                     06660032
068200                   TTRIPST C,                                     06670032
068300                   TSHIPST D,                                     06680032
068400                   TSHSTYP E,                                     06690032
068500                   TVHTRIP H,                                     06700037
068510                   TPURCHS I                                      06701037
068600            WHERE  B.PO_NBR           = :DK-PO-NBR                06710032
068610              AND  B.PO_NBR           = I.PO_NBR                  06711037
068700              AND  A.SHIPT_ID         = B.SHIPT_ID                06720032
068800              AND  D.SHIPT_STATUS_CDE = E.SHIPT_STATUS_CDE        06730032
068900              AND  A.SHIPT_ID         = D.SHIPT_ID                06740032
069000              AND  A.TRIP_ID          = H.TRIP_ID                 06750032
069100              AND  A.TRIP_ID          = C.TRIP_ID                 06760032
069200              AND  C.OPER_UNT_ID      = :DK-OPER-UNT-ID           06770032
069300              AND  C.FCLTY_ID         = :DK-FCLTY-ID              06780032
069310              AND  I.VER_STATUS_CDE   = 'A'                       06781040
069400              AND (A.EST_AR_TMST BETWEEN                          06790032
069500                   :DK-ETA-DTE AND                                06800032
069600                   :DK-ETA-TO-DTE)                                06810032
069700              AND  E.PRTY_CDE         < :PC-49                    06820032
069800              AND  E.PRTY_CDE =                                   06830032
069900                   (SELECT MAX (K.PRTY_CDE)                       06840032
070000                      FROM TSHIPST J,                             06850032
070100                           TSHSTYP K                              06860032
070200                     WHERE J.SHIPT_ID = A.SHIPT_ID                06870032
070300                       AND J.SHIPT_STATUS_CDE =                   06880032
070400                           K.SHIPT_STATUS_CDE)                    06890032
070510         ORDER BY  A.EST_AR_TMST, A.PRO_NBR, B.PO_NBR             06900032
070600     END-EXEC.                                                    06910032
070700/                                                                 06920032
070800*---------------------------------------------------------------* 06930032
070900*    CURSOR FOR THE LIST OF SHIPMENTS WHEN PO_NBR               * 06940032
071000*    WAS ENTERED ON THE SELECTION CRITERIA SCREEN               * 06950032
071100*---------------------------------------------------------------* 06960032
071200     EXEC SQL                                                     06970032
071300          DECLARE  PO CURSOR FOR                                  06980032
071400           SELECT  DISTINCT                                       06990032
071500                   A.TRIP_ID,                                     07000032
071600                   A.SHIPT_ID,                                    07010032
071700                   A.PRO_NBR,                                     07020032
071800                   A.PRO_SCAC_ID,                                 07030032
071900*                  A.SHIPPER_NME,                                 07040032
072000                   B.PO_NBR,                                      07050032
072200                   C.OPER_UNT_ID,                                 07070032
072300                   C.FCLTY_ID,                                    07080032
072400                   D.STATUS_DTE,                                  07090032
072500                   '  ',                                          07100032
072600                   H.MANIFEST_NBR,                                07110032
072700                   A.EST_AR_TMST,                                 07120037
072710                   I.DEPT_NBR                                     07121037
072800             FROM  TSHIPMT A,                                     07130032
072900                   TSHPTPO B,                                     07140032
073000                   TTRIPST C,                                     07150032
073100                   TSHIPST D,                                     07160032
073200                   TSHSTYP E,                                     07170032
073300                   TVHTRIP H,                                     07180037
073310                   TPURCHS I                                      07181037
073400            WHERE  B.PO_NBR           = :DK-PO-NBR                07190032
073410              AND  B.PO_NBR           = I.PO_NBR                  07191037
073500              AND  A.SHIPT_ID         = B.SHIPT_ID                07200032
073600              AND  D.SHIPT_STATUS_CDE = E.SHIPT_STATUS_CDE        07210032
073700              AND  A.SHIPT_ID         = D.SHIPT_ID                07220032
073800              AND  A.TRIP_ID          = H.TRIP_ID                 07230032
073900              AND  A.TRIP_ID          = C.TRIP_ID                 07240032
073910              AND  I.VER_STATUS_CDE   = 'A'                       07241040
074000              AND (A.EST_AR_TMST BETWEEN                          07250032
074100                   :DK-ETA-DTE AND                                07260032
074200                   :DK-ETA-TO-DTE)                                07270032
074300              AND  E.PRTY_CDE         < :PC-49                    07280032
074400              AND  E.PRTY_CDE =                                   07290032
074500                   (SELECT MAX (K.PRTY_CDE)                       07300032
074600                      FROM TSHIPST J,                             07310032
074700                           TSHSTYP K                              07320032
074800                     WHERE J.SHIPT_ID = A.SHIPT_ID                07330032
074900                       AND J.SHIPT_STATUS_CDE =                   07340032
075000                           K.SHIPT_STATUS_CDE)                    07350032
075110         ORDER BY  A.EST_AR_TMST, A.PRO_NBR, B.PO_NBR             07360032
075200     END-EXEC.                                                    07370032
075500/                                                                 07380032
075600*---------------------------------------------------------------* 07390032
075700*    CURSOR FOR THE LIST OF SHIPMENTS WHEN OPER_UNT_ID/FCLTY_ID * 07400032
075800*    AND PRO_SCAC_ID WAS ENTERED ON THE CRITERIA SCREEN         * 07410032
075900*---------------------------------------------------------------* 07420032
076000     EXEC SQL                                                     07430032
076100          DECLARE  OPER-SCAC CURSOR FOR                           07440032
076200           SELECT  DISTINCT                                       07450032
076300                   A.TRIP_ID,                                     07460032
076400                   A.SHIPT_ID,                                    07470032
076500                   A.PRO_NBR,                                     07480032
076600                   A.PRO_SCAC_ID,                                 07490032
076700*                  A.SHIPPER_NME,                                 07500032
076800                   C.OPER_UNT_ID,                                 07510032
076900                   C.FCLTY_ID,                                    07520032
077000                   D.STATUS_DTE,                                  07530032
077100                   '  ',                                          07540032
077200                   A.EST_AR_TMST                                  07550032
077300             FROM  TSHIPMT A,                                     07560032
077400                   TTRIPST C,                                     07570032
077500                   TSHIPST D,                                     07580032
077600                   TSHSTYP E                                      07590032
077700            WHERE  A.SHIPT_ID         = D.SHIPT_ID                07600032
077800              AND  D.SHIPT_STATUS_CDE = E.SHIPT_STATUS_CDE        07610032
077900              AND  A.PRO_SCAC_ID      = :DK-PRO-SCAC-ID           07620032
078000              AND  A.TRIP_ID          = C.TRIP_ID                 07630032
078100              AND  C.OPER_UNT_ID      = :DK-OPER-UNT-ID           07640032
078200              AND  C.FCLTY_ID         = :DK-FCLTY-ID              07650032
078300              AND (A.EST_AR_TMST BETWEEN                          07660032
078400                   :DK-ETA-DTE AND                                07670032
078500                   :DK-ETA-TO-DTE)                                07680032
078600              AND  E.PRTY_CDE         < :PC-49                    07690032
078700              AND  E.PRTY_CDE =                                   07700032
078800                   (SELECT MAX (K.PRTY_CDE)                       07710032
078900                      FROM TSHIPST J,                             07720032
079000                           TSHSTYP K                              07730032
079100                     WHERE J.SHIPT_ID = A.SHIPT_ID                07740032
079200                       AND J.SHIPT_STATUS_CDE =                   07750032
079300                           K.SHIPT_STATUS_CDE)                    07760032
079400*        ORDER BY  A.PRO_NBR                                      07770032
079410         ORDER BY  A.EST_AR_TMST, A.PRO_NBR                       07780032
079500     END-EXEC.                                                    07790032
079600/                                                                 07800032
079700*---------------------------------------------------------------* 07810032
079800*    CURSOR FOR THE LIST OF SHIPMENTS WHEN PRO_SCAC_ID          * 07820032
079900*    WAS ENTERED ON THE CRITERIA SCREEN                         * 07830032
080000*---------------------------------------------------------------* 07840032
080100     EXEC SQL                                                     07850032
080200          DECLARE  SCAC CURSOR FOR                                07860032
080300           SELECT  DISTINCT                                       07870032
080400                   A.TRIP_ID,                                     07880032
080500                   A.SHIPT_ID,                                    07890032
080600                   A.PRO_NBR,                                     07900032
080700                   A.PRO_SCAC_ID,                                 07910032
080800*                  A.SHIPPER_NME,                                 07920032
080900                   C.OPER_UNT_ID,                                 07930032
081000                   C.FCLTY_ID,                                    07940032
081100                   D.STATUS_DTE,                                  07950032
081200                   '  ',                                          07960032
081300                   A.EST_AR_TMST                                  07970032
081400             FROM  TSHIPMT A,                                     07980032
081500                   TTRIPST C,                                     07990032
081600                   TSHIPST D,                                     08000032
081700                   TSHSTYP E                                      08010032
081800            WHERE  A.SHIPT_ID         = D.SHIPT_ID                08020032
081900              AND  D.SHIPT_STATUS_CDE = E.SHIPT_STATUS_CDE        08030032
082000              AND  A.PRO_SCAC_ID      = :DK-PRO-SCAC-ID           08040032
082100              AND  A.TRIP_ID          = C.TRIP_ID                 08050032
082200              AND (A.EST_AR_TMST BETWEEN                          08060032
082300                   :DK-ETA-DTE AND                                08070032
082400                   :DK-ETA-TO-DTE)                                08080032
082500              AND  E.PRTY_CDE         < :PC-49                    08090032
082600              AND  E.PRTY_CDE =                                   08100032
082700                   (SELECT MAX (K.PRTY_CDE)                       08110032
082800                      FROM TSHIPST J,                             08120032
082900                           TSHSTYP K                              08130032
083000                     WHERE J.SHIPT_ID = A.SHIPT_ID                08140032
083100                       AND J.SHIPT_STATUS_CDE =                   08150032
083200                           K.SHIPT_STATUS_CDE)                    08160032
083300*        ORDER BY  A.PRO_NBR                                      08170032
083310         ORDER BY  A.EST_AR_TMST, A.PRO_NBR                       08180032
083400     END-EXEC.                                                    08190032
083600/                                                                 08200032
083700     EXEC SQL                                                     08210032
083800          DECLARE  OPER-PRO-SCAC CURSOR FOR                       08220032
083900           SELECT  DISTINCT                                       08230032
084000                   A.TRIP_ID,                                     08240032
084100                   A.SHIPT_ID,                                    08250032
084200                   A.PRO_NBR,                                     08260032
084300                   A.PRO_SCAC_ID,                                 08270032
084400*                  A.SHIPPER_NME,                                 08280032
084500                   C.OPER_UNT_ID,                                 08290032
084600                   C.FCLTY_ID,                                    08300032
084700                   D.STATUS_DTE,                                  08310032
084800                   '  ',                                          08320032
084900                   A.EST_AR_TMST                                  08330032
085000             FROM  TSHIPMT A,                                     08340032
085100                   TTRIPST C,                                     08350032
085200                   TSHIPST D,                                     08360032
085300                   TSHSTYP E                                      08370032
085400            WHERE  A.SHIPT_ID         = D.SHIPT_ID                08380032
085500              AND  D.SHIPT_STATUS_CDE = E.SHIPT_STATUS_CDE        08390032
085600              AND  A.PRO_SCAC_ID      = :DK-PRO-SCAC-ID           08400032
085700              AND  A.PRO_NBR          = :DK-PRO-NBR               08410032
085800              AND  A.TRIP_ID          = C.TRIP_ID                 08420032
085900              AND  C.OPER_UNT_ID      = :DK-OPER-UNT-ID           08430032
086000              AND  C.FCLTY_ID         = :DK-FCLTY-ID              08440032
086100              AND (A.EST_AR_TMST BETWEEN                          08450032
086200                   :DK-ETA-DTE AND                                08460032
086300                   :DK-ETA-TO-DTE)                                08470032
086400              AND  E.PRTY_CDE         < :PC-49                    08480032
086500              AND  E.PRTY_CDE =                                   08490032
086600                   (SELECT MAX (K.PRTY_CDE)                       08500032
086700                      FROM TSHIPST J,                             08510032
086800                           TSHSTYP K                              08520032
086900                     WHERE J.SHIPT_ID = A.SHIPT_ID                08530032
087000                       AND J.SHIPT_STATUS_CDE =                   08540032
087100                           K.SHIPT_STATUS_CDE)                    08550032
087200*        ORDER BY  A.PRO_NBR                                      08560032
087210         ORDER BY  A.EST_AR_TMST, A.PRO_NBR                       08570032
087300     END-EXEC.                                                    08580032
087400/                                                                 08590032
087500*---------------------------------------------------------------* 08600032
087600*    CURSOR FOR THE LIST OF SHIPMENTS WHEN PRO_SCAC_ID          * 08610032
087700*    WAS ENTERED ON THE CRITERIA SCREEN                         * 08620032
087800*---------------------------------------------------------------* 08630032
087900     EXEC SQL                                                     08640032
088000          DECLARE  PRO-SCAC CURSOR FOR                            08650032
088100           SELECT  DISTINCT                                       08660032
088200                   A.TRIP_ID,                                     08670032
088300                   A.SHIPT_ID,                                    08680032
088400                   A.PRO_NBR,                                     08690032
088500                   A.PRO_SCAC_ID,                                 08700032
088600*                  A.SHIPPER_NME,                                 08710032
088700                   C.OPER_UNT_ID,                                 08720032
088800                   C.FCLTY_ID,                                    08730032
088900                   D.STATUS_DTE,                                  08740032
089000                   '  ',                                          08750032
089100                   A.EST_AR_TMST                                  08760032
089200             FROM  TSHIPMT A,                                     08770032
089300                   TTRIPST C,                                     08780032
089400                   TSHIPST D,                                     08790032
089500                   TSHSTYP E                                      08800032
089600            WHERE  A.SHIPT_ID         = D.SHIPT_ID                08810032
089700              AND  D.SHIPT_STATUS_CDE = E.SHIPT_STATUS_CDE        08820032
089800              AND  A.PRO_SCAC_ID      = :DK-PRO-SCAC-ID           08830032
089900              AND  A.PRO_NBR          = :DK-PRO-NBR               08840032
090000              AND  A.TRIP_ID          = C.TRIP_ID                 08850032
090100              AND (A.EST_AR_TMST BETWEEN                          08860032
090200                   :DK-ETA-DTE AND                                08870032
090300                   :DK-ETA-TO-DTE)                                08880032
090400              AND  E.PRTY_CDE         < :PC-49                    08890032
090500              AND  E.PRTY_CDE =                                   08900032
090600                   (SELECT MAX (K.PRTY_CDE)                       08910032
090700                      FROM TSHIPST J,                             08920032
090800                           TSHSTYP K                              08930032
090900                     WHERE J.SHIPT_ID = A.SHIPT_ID                08940032
091000                       AND J.SHIPT_STATUS_CDE =                   08950032
091100                           K.SHIPT_STATUS_CDE)                    08960032
091200*        ORDER BY  A.PRO_NBR                                      08970032
091210         ORDER BY  A.EST_AR_TMST, A.PRO_NBR                       08980032
091300     END-EXEC.                                                    08990032
091400/                                                                 09000032
091600*---------------------------------------------------------------* 09010032
091700*    CURSOR FOR THE LIST OF SHIPMENTS WHEN DEPT                 * 09020032
091800*    WAS ENTERED ON THE CRITERIA SCREEN                         * 09030032
091900*---------------------------------------------------------------* 09040032
092000* NOTE: THE TPURCHS TABLE HAS BEEN ADDED TO THIS CURSOR TO MAKE   09050032
092100*   USE OF THE INDEX ON THE DEPT NUMBER ON THIS TABLE.            09060032
092200*---------------------------------------------------------------* 09070032
092300* NOTE2:  THE TPURCHS TABLE HAS BEEN COMMENTED OUT BECAUSE THE    09080032
092400*  CLUSTERING ON THE DEPT-NBR FIELD HAS MADE THIS INDEX UNUSEABLE.09090032
092500*  THIS TABLE CAN BE ADDED BACK IF THE ARCHIVING OF THE TPURCHS TA09100032
092600*  IS DONE.                                                       09110032
092700*---------------------------------------------------------------* 09120032
092800     EXEC SQL                                                     09130032
092900          DECLARE  DEPT CURSOR FOR                                09140032
093000           SELECT  DISTINCT                                       09150032
093100                   A.TRIP_ID,                                     09160032
093200                   A.SHIPT_ID,                                    09170032
093300                   A.PRO_NBR,                                     09180032
093400                   A.PRO_SCAC_ID,                                 09190032
093500*                  A.SHIPPER_NME,                                 09200032
093600                   B.PO_NBR,                                      09210032
093800                   C.OPER_UNT_ID,                                 09230032
093900                   C.FCLTY_ID,                                    09240032
094000                   D.STATUS_DTE,                                  09250032
094100                   '  ',                                          09260032
094200                   H.MANIFEST_NBR,                                09270032
094300                   A.EST_AR_TMST,                                 09280037
094310                   L.DEPT_NBR                                     09281037
094400             FROM  TSHIPMT A,                                     09290032
094500                   TSHPTPO B,                                     09300032
094600                   TTRIPST C,                                     09310032
094700                   TSHIPST D,                                     09320032
094800                   TSHSTYP E,                                     09330032
094900                   TVHTRIP H,                                     09340037
095000                   TPURCHS L                                      09350037
095100            WHERE  A.SHIPT_ID         = B.SHIPT_ID                09360032
095200              AND  A.SHIPT_ID         = D.SHIPT_ID                09370032
095300              AND  D.SHIPT_STATUS_CDE = E.SHIPT_STATUS_CDE        09380032
095600              AND  L.PO_NBR           = B.PO_NBR                  09410037
095610              AND  L.DEPT_NBR         = :DK-DEPT-NBR              09411042
095700              AND  A.TRIP_ID          = C.TRIP_ID                 09420032
095800              AND  A.TRIP_ID          = H.TRIP_ID                 09430032
095810              AND  L.VER_STATUS_CDE   = 'A'                       09431040
095900              AND (A.EST_AR_TMST BETWEEN                          09440032
096000                   :DK-ETA-DTE AND                                09450032
096100                   :DK-ETA-TO-DTE)                                09460032
096200              AND  E.PRTY_CDE         < :PC-49                    09470032
096300              AND  E.PRTY_CDE =                                   09480032
096400                   (SELECT MAX (K.PRTY_CDE)                       09490032
096500                      FROM TSHIPST J,                             09500032
096600                           TSHSTYP K                              09510032
096700                     WHERE J.SHIPT_ID = A.SHIPT_ID                09520032
096800                       AND J.SHIPT_STATUS_CDE =                   09530032
096900                           K.SHIPT_STATUS_CDE)                    09540032
097000*        ORDER BY  A.PRO_NBR                                      09550032
097010         ORDER BY  A.EST_AR_TMST, A.PRO_NBR                       09560032
097100     END-EXEC.                                                    09570032
097300/                                                                 09580032
097400*---------------------------------------------------------------* 09590032
097500*    CURSOR FOR THE LIST OF SHIPMENTS WHEN OPER-UNIT AND DEPT   * 09600032
097600*    WAS ENTERED ON THE CRITERIA SCREEN                         * 09610032
097700*---------------------------------------------------------------* 09620032
097800* NOTE: THE TPURCHS TABLE HAS BEEN ADDED TO THIS CURSOR TO TAKE   09630032
097900*       OF THE INDEX ON THE DEPT NUMBER ON THIS TABLE.            09640032
098000*---------------------------------------------------------------* 09650032
098100* NOTE2:  THE TPURCHS TABLE HAS BEEN COMMENTED OUT BECAUSE THE    09660032
098200*  CLUSTERING ON THE DEPT-NBR FIELD HAS MADE THIS INDEX UNUSEABLE.09670032
098300*  THIS TABLE CAN BE ADDED BACK IF THE ARCHIVING OF THE TPURCHS TA09680032
098400*  IS DONE.                                                       09690032
098500*---------------------------------------------------------------* 09700032
098600     EXEC SQL                                                     09710032
098700          DECLARE  OPER-DEPT CURSOR FOR                           09720032
098800           SELECT  DISTINCT                                       09730032
098900                   A.TRIP_ID,                                     09740032
099000                   A.SHIPT_ID,                                    09750032
099100                   A.PRO_NBR,                                     09760032
099200                   A.PRO_SCAC_ID,                                 09770032
099300*                  A.SHIPPER_NME,                                 09780032
099400                   B.PO_NBR,                                      09790032
099600                   C.OPER_UNT_ID,                                 09810032
099700                   C.FCLTY_ID,                                    09820032
099800                   D.STATUS_DTE,                                  09830032
099900                   '  ',                                          09840032
100000                   H.MANIFEST_NBR,                                09850032
100100                   A.EST_AR_TMST,                                 09860037
100110                   L.DEPT_NBR                                     09861037
100200             FROM  TSHIPMT A,                                     09870032
100300                   TSHPTPO B,                                     09880032
100400                   TTRIPST C,                                     09890032
100500                   TSHIPST D,                                     09900032
100600                   TSHSTYP E,                                     09910032
100700                   TVHTRIP H,                                     09920038
100800                   TPURCHS L                                      09930037
100900            WHERE  A.SHIPT_ID         = B.SHIPT_ID                09940032
101000              AND  A.SHIPT_ID         = D.SHIPT_ID                09950032
101100              AND  D.SHIPT_STATUS_CDE = E.SHIPT_STATUS_CDE        09960032
101400              AND  L.PO_NBR           = B.PO_NBR                  09990037
101410              AND  L.DEPT_NBR         = :DK-DEPT-NBR              09991042
101500              AND  A.TRIP_ID          = C.TRIP_ID                 10000032
101600              AND  A.TRIP_ID          = H.TRIP_ID                 10010032
101700              AND  C.OPER_UNT_ID      = :DK-OPER-UNT-ID           10020032
101800              AND  C.FCLTY_ID         = :DK-FCLTY-ID              10030032
101810              AND  L.VER_STATUS_CDE   = 'A'                       10031040
101900              AND (A.EST_AR_TMST BETWEEN                          10040032
102000                   :DK-ETA-DTE AND                                10050032
102100                   :DK-ETA-TO-DTE)                                10060032
102200              AND  E.PRTY_CDE         < :PC-49                    10070032
102300              AND  E.PRTY_CDE =                                   10080032
102400                   (SELECT MAX (K.PRTY_CDE)                       10090032
102500                      FROM TSHIPST J,                             10100032
102600                           TSHSTYP K                              10110032
102700                     WHERE J.SHIPT_ID = A.SHIPT_ID                10120032
102800                       AND J.SHIPT_STATUS_CDE =                   10130032
102900                           K.SHIPT_STATUS_CDE)                    10140032
103010         ORDER BY  A.EST_AR_TMST, A.PRO_NBR                       10150032
103100     END-EXEC.                                                    10160032
103300/                                                                 10170032
103400*---------------------------------------------------------------* 10180032
103500*    CURSOR TO RETRIEVE ALL PURCHASE ORDERS FOR A SHIPMENT      * 10190032
103600*---------------------------------------------------------------* 10200032
103700     EXEC SQL                                                     10210032
103800          DECLARE  SHPTPO-CSR CURSOR FOR                          10220032
103900           SELECT  A.PO_NBR,                                      10230032
104010                   A.VEND_NAME,                                   10250037
104020                   B.DEPT_NBR                                     10251037
104100             FROM  TSHPTPO A,                                     10260037
104110                   TPURCHS B                                      10261037
104200            WHERE  A.SHIPT_ID       = :SHIPMT-SHIPT-ID            10270037
104300              AND  A.PO_NBR         = B.PO_NBR                    10271037
104301              AND  B.VER_STATUS_CDE = 'A'                         10272040
104302         ORDER BY  1                                              10280032
104400     END-EXEC.                                                    10290032
104500/                                                                 10300032
104700 LINKAGE SECTION.                                                 10310032
104800                                                                  10320032
104900 01  DFHCOMMAREA.                                                 10330032
105000     05  FILLER                         OCCURS  1 TO 4072 TIMES   10340032
105100                                        DEPENDING ON EIBCALEN.    10350032
105200         10  FILLER                     PIC X.                    10360032
105300                                                                  10370032
105400/                                                                 10380032
105500 PROCEDURE DIVISION.                                              10390032
105600                                                                  10400032
105700 0000-MAIN-MODULE.                                                10410032
105800                                                                  10420032
105900     INITIALIZE DP030-CICS-API-FIELDS.                            10430032
106000     MOVE +1                      TO DP030-NUMBER-OF-MAPS.        10440032
106100     MOVE PC-CURRENT-MAPSET-NAME  TO DP030-MAPSET-NAME.           10450032
106200     MOVE PC-CURRENT-MAP-NAME     TO DP030-MAP-NAME (1).          10460032
106300     SET DP030-RECEIVE-APPL-MAP   TO TRUE.                        10470032
106400     MOVE LENGTH OF TR102AI       TO DP030-MAP-LENGTH (1).        10480032
106500     MOVE 'PROGRAM ENTRY CALL'    TO DP013-MESSAGE-TEXT (1).      10490032
106600     PERFORM 0001-CALL-CICS-ARCH-API.                             10500032
106700                                                                  10510032
106800     PERFORM 1000-CONTROL-PROCESSING.                             10520032
106900                                                                  10530032
107000     MOVE 'PROGRAM EXIT CALL'     TO DP013-MESSAGE-TEXT (1).      10540032
107100     PERFORM 0001-CALL-CICS-ARCH-API.                             10550032
107200                                                                  10560032
107300*----------------------------------------------------------------*10570032
107400*   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE    *10580032
107500*   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.          *10590032
107600*----------------------------------------------------------------*10600032
107700                                                                  10610032
107800 0001-CALL-CICS-ARCH-API.                                         10620032
107900                                                                  10630032
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      10640071
108100                                    DFHCOMMAREA                   10650071
108200                                    DP030-CICS-API-FIELDS         10660071
108300                                    DP020-STANDARD-COMMAREA       10670071
108400                                    TR102AI.                      10680071
108500                                                                  10690032
108600     IF  DP030-RC-CALL-SUCCESSFUL                                 10700032
108700         CONTINUE                                                 10710032
108800     ELSE                                                         10720032
108900         SET DP013-NO-ROLLBACK TO TRUE                            10730032
109000         SET DP013-XCTL-DISPLAY-RESTART TO TRUE                   10740032
109100         SET DP013-CICS-ABEND TO TRUE                             10750032
109200         MOVE 'BEFORE 0000-MAIN-MODULE' TO DP013-PARAGRAPH        10760032
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O10761071
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      10762071
109500         MOVE DP030-RETURN-CODE                                   10790032
109600                               TO DP013-MESSAGE-TEXT (3)          10800032
109700         PERFORM DP013-0000-PROCESS-ABEND                         10810032
109800     END-IF.                                                      10820032
109900                                                                  10830032
110000*----------------------------------------------------------------*10840032
110100* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *10850032
110200* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *10860032
110300*                                                                *10870032
110400* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *10880032
110500*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *10890032
110600*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *10900032
110700*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *10910032
110800*----------------------------------------------------------------*10920032
110900                                                                  10930032
111000 1000-CONTROL-PROCESSING.                                         10940032
111100                                                                  10950032
111200     EVALUATE TRUE                                                10960032
111300         WHEN DP020-NEXT-ACT-INITIAL                              10970032
111400             PERFORM 1100-PROCESS-INTER-APPL-COMM                 10980032
112000             IF  PS-COMMAREA-NOT-VALID                            10990032
112100                 SET DP020-NEXT-ACT-APPL-ERROR                    11000032
112200                               TO  TRUE                           11010032
112300             ELSE                                                 11020032
112400                 PERFORM 2050-DELETE-DETAIL-QUEUE                 11030032
112500                 PERFORM 4000-BUILD-INITIAL-PANEL                 11040032
112600             END-IF                                               11050032
112700                                                                  11060032
112800         WHEN DP020-NEXT-ACT-READ-MAP                             11070032
112900             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        11080032
113000                               TO PV-TOP-ITEM                     11090032
113100             PERFORM 2000-PROCESS-PANEL                           11100032
113200                                                                  11110032
113300         WHEN DP020-NEXT-ACT-RETURN                               11120032
113400             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        11130032
113500                               TO PV-TOP-ITEM                     11140032
113600             MOVE ZERO         TO ASC-ITEM-AT-TOP-OF-PANEL        11150032
113700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11160032
113800                                                                  11170032
113900         WHEN OTHER                                               11180032
114000             SET DP013-LOGIC-ABEND TO TRUE                        11190032
114100             SET DP013-NO-ROLLBACK TO TRUE                        11200032
114200             MOVE '1000-CONTROL-PROCESSING'                       11210032
114300                               TO  DP013-PARAGRAPH                11220032
114400             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    11230032
114500                               TO  DP013-MESSAGE-TEXT(1)          11240032
114600             PERFORM DP013-0000-PROCESS-ABEND                     11250032
114700     END-EVALUATE.                                                11260032
114800/                                                                 11270032
115000*----------------------------------------------------------------*11280032
115100* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *11290032
115200* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *11300032
115300*----------------------------------------------------------------*11310032
115400                                                                  11320032
115500 1100-PROCESS-INTER-APPL-COMM.                                    11330032
115600                                                                  11340032
115700     SET PS-COMMAREA-VALID     TO TRUE.                           11350032
115800     INITIALIZE ASC-SPECIFIC-COMMAREA.                            11360032
115900     MOVE EIBTRMID             TO ASC-DTL-TERM-ID.                11370032
116000     MOVE DP020-SRC-TASK-NUMBER                                   11380032
116100                               TO ASC-DTL-TASK-NUMBER.            11390032
116200     MOVE PC-DTL-QUEUE-SEQ     TO ASC-DTL-SEQ.                    11400032
116300     MOVE SPACE                TO ASC-START-ITEM-REQUEST.         11410032
116400     IF  TR001-DEPT = ZEROES AND                                  11420035
116500       TR001-PO-NBR = SPACES AND                                  11430032
116600         TR001-SCAC = SPACES                                      11440032
116700         SET DP020-NEXT-ACT-APPL-ERROR                            11450032
116800             PS-COMMAREA-NOT-VALID                                11460032
116900             DP020-MSG-FATAL TO TRUE                              11470032
117000         MOVE PC-TSYMSG-00985                                     11480032
117100                        TO DP020-MSG-NUMBER                       11490032
117200     ELSE                                                         11500032
117300         MOVE TR001-OPER-UNT-ID-N                                 11510032
117400                                 TO DK-OPER-UNT-ID                11520032
117500                                    ASC-KEY-OPER-UNT-ID           11530032
117600         MOVE TR001-FCLTY-ID-N   TO DK-FCLTY-ID                   11540032
117700                                    ASC-KEY-FCLTY-ID              11550032
117800         IF TR001-SCAC > SPACES                                   11560032
117900             MOVE TR001-SCAC         TO DK-PRO-SCAC-ID            11570032
118000                                        ASC-KEY-PRO-SCAC-ID       11580032
118100         END-IF                                                   11590032
118200                                                                  11600032
118300         IF TR001-PO-NBR > SPACES                                 11610032
      *CLP 10/24/14                                                     11620067
118400             MOVE TR001-PO-NBR       TO DK-PO-NBR                 11621066
118500                                        ASC-KEY-PO-NBR            11630032
118600         END-IF                                                   11640032
118700                                                                  11650032
118800         IF TR001-DEPT > ZEROES                                   11660053
118900             MOVE TR001-DEPT(2:3)    TO DK-DEPT-NBR               11670047
119000             MOVE TR001-DEPT         TO ASC-KEY-DEPT-NBR          11680034
119100         END-IF                                                   11690032
119200         IF TR001-PRO-NBR > SPACES                                11700032
119300             MOVE TR001-PRO-NBR      TO DK-PRO-NBR                11710032
119400                                        ASC-KEY-PRO-NBR           11720032
119500         END-IF                                                   11730032
119600                                                                  11740032
119700         IF (TR001-ETA-DTE    = SPACES OR LOW-VALUES) OR          11750032
119800            (TR001-ETA-TO-DTE = SPACES OR LOW-VALUES)             11760032
119900             EXEC SQL                                             11770032
120000                 SET :PV-DATE = CURRENT DATE                      11780032
120100             END-EXEC                                             11790032
120200                                                                  11800032
120400             INITIALIZE DPG51 DPG52 DPG53                         11810032
120401                        DPG54 DPG55 DPG56                         11820032
120402             MOVE PV-DATE TO DPG52-LK-DATE-INPUT                  11830032
120500             SET DPG51-ACTUAL-CALENDAR-ONLY                       11840032
120600                 DPG51-DECREMENT-DATE                             11850032
120700                 DPG52-LK-DTE-ISO-FMT TO TRUE                     11860032
120800             MOVE PC-2 TO DPG51-INCR-DECR-DAYS-9                  11870032
120900             CALL DP500-KOHLS-CALENDAR-ROUTINE                    11880032
121000                     USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56    11890032
121100             IF (DPG54-DATE-INVALID                               11900032
121200             OR  DPG54-SEVERE-ERROR)                              11910032
121300                 SET PS-ERROR                                     11920032
121400                     DP020-NEXT-ACT-APPL-ERROR                    11930032
121500                     PS-COMMAREA-NOT-VALID TO TRUE                11940032
121600                 MOVE PC-TSYMSG-00009  TO DP020-MSG-NUMBER        11950032
121700             ELSE                                                 11960032
121800                 MOVE DPG55-DB2-ISO-DATE-FMT-YR-X                 11970032
121900                                       TO ASC-KEY-ETA-CCYY        11980032
122000                 MOVE DPG55-DB2-ISO-DATE-FMT-MO-X                 11990032
122100                                       TO ASC-KEY-ETA-MM          12000032
122200                 MOVE DPG55-DB2-ISO-DATE-FMT-DY-X                 12010032
122300                                       TO ASC-KEY-ETA-DD          12020032
122400             END-IF                                               12030032
122500                                                                  12040032
122501             INITIALIZE DPG51 DPG52 DPG53                         12050032
122502                        DPG54 DPG55 DPG56                         12060032
122600             MOVE PV-DATE TO DPG52-LK-DATE-INPUT                  12070032
122800             SET DPG51-ACTUAL-CALENDAR-ONLY                       12080032
122900                 DPG51-INCREMENT-DATE                             12090032
123000                 DPG52-LK-DTE-ISO-FMT TO TRUE                     12100032
123100             MOVE PC-5 TO DPG51-INCR-DECR-DAYS-9                  12110032
123101             CALL DP500-KOHLS-CALENDAR-ROUTINE                    12120032
123102                     USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56    12130032
123400             IF (DPG54-DATE-INVALID                               12140032
123500             OR  DPG54-SEVERE-ERROR)                              12150032
123600                 SET PS-ERROR                                     12160032
123700                     DP020-NEXT-ACT-APPL-ERROR                    12170032
123800                     PS-COMMAREA-NOT-VALID TO TRUE                12180032
123900                 MOVE PC-TSYMSG-00009  TO DP020-MSG-NUMBER        12190032
124000             ELSE                                                 12200032
124100                 MOVE DPG55-DB2-ISO-DATE-FMT-YR-X                 12210032
124200                                   TO ASC-KEY-ETA-TO-CCYY         12220032
124300                 MOVE DPG55-DB2-ISO-DATE-FMT-MO-X                 12230032
124400                                   TO ASC-KEY-ETA-TO-MM           12240032
124500                 MOVE DPG55-DB2-ISO-DATE-FMT-DY-X                 12250032
124600                                   TO ASC-KEY-ETA-TO-DD           12260032
124700             END-IF                                               12270032
124800         ELSE                                                     12280032
124900             MOVE TR001-ETA-MM       TO ASC-KEY-ETA-MM            12290032
125000             MOVE TR001-ETA-DD       TO ASC-KEY-ETA-DD            12300032
125100             MOVE TR001-ETA-CCYY     TO ASC-KEY-ETA-CCYY          12310032
125200             MOVE TR001-ETA-TO-MM    TO ASC-KEY-ETA-TO-MM         12320032
125300             MOVE TR001-ETA-TO-DD    TO ASC-KEY-ETA-TO-DD         12330032
125400             MOVE TR001-ETA-TO-CCYY  TO ASC-KEY-ETA-TO-CCYY       12340032
125500         END-IF                                                   12350032
125600         MOVE PC-DEFAULT-TIME    TO ASC-KEY-ETA-TIME              12360032
125700         MOVE PC-DEFAULT-TO-TIME TO ASC-KEY-ETA-TO-TIME           12370032
125800         MOVE PC-DASH            TO ASC-KEY-ETA-DASH-1            12380032
125900                                    ASC-KEY-ETA-DASH-2            12390032
126000                                    ASC-KEY-ETA-TO-DASH-1         12400032
126100                                    ASC-KEY-ETA-TO-DASH-2         12410032
126200         MOVE ASC-KEY-ETA-DTE    TO DK-ETA-DTE                    12420032
126300         MOVE ASC-KEY-ETA-TO-DTE TO DK-ETA-TO-DTE                 12430032
126500     END-IF.                                                      12440032
126700/                                                                 12450032
126800*----------------------------------------------------------------*12460032
126900*    EDIT THE KEY ENTERED BY THE USER INTO THE KEY FIELD OF THE  *12470032
127000*    COMMAND LINE.  A VALID MESSAGE NUMBER IS THE ONLY KEY       *12480032
127100*    ACCEPTED.                                                   *12490032
127200*----------------------------------------------------------------*12500032
127300                                                                  12510032
127400 1110-EDIT-NAV-KEY.                                               12520032
127500                                                                  12530032
127600     MOVE DP020-NAV-KEY-DATA TO DP010I-UNEDITED-FIELD.            12540032
127700     MOVE PC-MSG-NUMBER-LENGTH     TO DP010I-MAXIMUM-DIGITS.      12550032
127800     MOVE ZERO                TO DP010I-MAXIMUM-DECIMALS.         12560032
127900     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     12570032
263697     CALL DP010I-NUMERIC-EDIT-ROUTINE                             12581070
263697          USING DP010I-NUMERIC-EDIT-AREA.                         12582070
128100     IF  DP010I-ERROR-DETECTED                                    12590032
128200         SET PS-ERROR TO TRUE                                     12600032
128300         SET DP020-MSG-FATAL TO TRUE                              12610032
128400         MOVE PC-TSYMSG-00302 TO DP020-MSG-NUMBER                 12620032
128500         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    12630032
128600     END-IF.                                                      12640032
128700/                                                                 12650032
128800*----------------------------------------------------------------*12660032
128900*    GET READY TO START AT THE FIRST ITEM ON THE LIST.           *12670032
129000*----------------------------------------------------------------*12680032
129100                                                                  12690032
129200 1120-PREPARE-LIST-ENTRY.                                         12700032
129400     MOVE DP057-MAX-ITEMS TO ASC-SEL-SUB.                         12710032
129500     MOVE ZERO            TO ASC-SEL-ITEM.                        12720032
129600     PERFORM 2140-GET-NEXT-MESSAGE.                               12730032
129700/                                                                 12740032
129800*----------------------------------------------------------------*12750032
129900*    RECEIVE THE MAP AND PERFORM THE APPROPRIATE PARAGRAPH BASED *12760032
130000*    ON WHAT FUNCTION KEY WAS SELECTED.                          *12770032
130100*----------------------------------------------------------------*12780032
130200                                                                  12790032
130300 2000-PROCESS-PANEL.                                              12800032
130400                                                                  12810032
130500     EVALUATE TRUE                                                12820032
130600         WHEN DP020-SRC-AID = DP016-CLEAR                         12830032
130700             MOVE ZERO TO ASC-ITEM-AT-TOP-OF-PANEL                12840032
130800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12850032
130900             PERFORM 3200-RESET-ATTRIBUTES                        12860032
131000                                                                  12870032
131100         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    12880032
131200             MOVE ASC-KEY-OPER-UNT-ID                             12890032
131300                                TO DK-OPER-UNT-ID                 12900032
131400             MOVE ASC-KEY-FCLTY-ID                                12910032
131500                                TO DK-FCLTY-ID                    12920032
131600             MOVE ASC-KEY-PRO-SCAC-ID                             12930032
131700                                TO DK-PRO-SCAC-ID                 12940032
131800             MOVE ASC-KEY-PO-NBR                                  12950032
131900                                TO DK-PO-NBR                      12960032
132000             MOVE ASC-KEY-DEPT-NBR(2:3)                           12970034
132100                                TO DK-DEPT-NBR                    12980032
132200             MOVE ASC-KEY-ETA-DTE                                 12990032
132300                                TO DK-ETA-DTE                     13000032
132400             MOVE ASC-KEY-ETA-TO-DTE                              13010032
132500                                TO DK-ETA-TO-DTE                  13020032
132600             PERFORM 2050-DELETE-DETAIL-QUEUE                     13030032
132700             PERFORM 4000-BUILD-INITIAL-PANEL                     13040032
132800             PERFORM 3200-RESET-ATTRIBUTES                        13050032
132900                                                                  13060032
133000         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             13070032
133100             IF  ASC-USE-SELECTION-QUEUE                          13080032
133200                 PERFORM 2140-GET-NEXT-MESSAGE                    13090032
133300                 IF PS-LIST-END                                   13100032
133400                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         13110032
133500                     SET PS-NO-LIST-END TO TRUE                   13120032
133600                 ELSE                                             13130032
133700                     PERFORM 2050-DELETE-DETAIL-QUEUE             13140032
133800                     PERFORM 4000-BUILD-INITIAL-PANEL             13150032
133900                 END-IF                                           13160032
134000                 PERFORM 3200-RESET-ATTRIBUTES                    13170032
134100             ELSE                                                 13180032
134200                 MOVE PC-TSYMSG-00070                             13190032
134300                                  TO DP020-MSG-NUMBER             13200032
134400                 SET DP020-MSG-INFORMATIONAL TO TRUE              13210032
134500             END-IF                                               13220032
134600                                                                  13230032
134700         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             13240032
134800             IF  ASC-USE-SELECTION-QUEUE                          13250032
134900                 PERFORM 2150-GET-PREV-MESSAGE                    13260032
135000                 IF PS-LIST-END                                   13270032
135100                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         13280032
135200                     SET PS-NO-LIST-END TO TRUE                   13290032
135300                 ELSE                                             13300032
135400                     PERFORM 2050-DELETE-DETAIL-QUEUE             13310032
135500                     PERFORM 4000-BUILD-INITIAL-PANEL             13320032
135600                 END-IF                                           13330032
135700                 PERFORM 3200-RESET-ATTRIBUTES                    13340032
135800             ELSE                                                 13350032
135900                 MOVE PC-TSYMSG-00069                             13360032
136000                                  TO DP020-MSG-NUMBER             13370032
136100                 SET DP020-MSG-INFORMATIONAL TO TRUE              13380032
136200             END-IF                                               13390032
136300                                                                  13400032
136400         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  13410032
136500             MOVE +1 TO PV-TOP-ITEM                               13420032
136600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13430032
136700             PERFORM 3200-RESET-ATTRIBUTES                        13440032
136800                                                                  13450032
136900         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   13460032
137000             PERFORM 2110-BROWSE-BACKWARD                         13470032
137100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13480032
137200             PERFORM 3200-RESET-ATTRIBUTES                        13490032
137300                                                                  13500032
137400         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   13510032
137500             PERFORM 2120-BROWSE-FORWARD                          13520032
137600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13530032
137700             PERFORM 3200-RESET-ATTRIBUTES                        13540032
137800                                                                  13550032
137900         WHEN DP020-SRC-AID = DP016-ENTER                         13560032
138000             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   13570032
138100             IF  PS-ERROR                                         13580032
138200                 CONTINUE                                         13590032
138300             ELSE                                                 13600032
138400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             13610032
138500                 PERFORM 3200-RESET-ATTRIBUTES                    13620032
138600             END-IF                                               13630032
138700                                                                  13640032
138800         WHEN OTHER                                               13650032
138900             SET DP013-NO-ROLLBACK TO TRUE                        13660032
139000             SET DP013-XCTL-DISPLAY-RESTART TO TRUE               13670032
139100             SET DP013-CICS-ABEND TO TRUE                         13680032
139200             MOVE '2100-CHECK-FUNCTION-KEY' TO DP013-PARAGRAPH    13690032
139300             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      13700032
139400                                   TO DP013-MESSAGE-TEXT (1)      13710032
139500             PERFORM DP013-0000-PROCESS-ABEND                     13720032
139600                                                                  13730032
139700     END-EVALUATE.                                                13740032
139800 EJECT                                                            13750032
139900*----------------------------------------------------------------*13760032
140000*    DELETE THE TEMPORARY STORAGE QUEUE.                         *13770032
140100*----------------------------------------------------------------*13780032
140200                                                                  13790032
140300 2050-DELETE-DETAIL-QUEUE.                                        13800032
140400                                                                  13810032
140500     EXEC CICS                                                    13820032
140600         DELETEQ TS                                               13830032
140700             QUEUE (ASC-DTL-QUEUE-NAME)                           13840032
140800             RESP  (PV-CICS-RESP)                                 13850032
140900     END-EXEC.                                                    13860032
141000                                                                  13870032
141100     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       13880032
141200        (PV-CICS-RESP = DFHRESP(QIDERR))                          13890032
141300         CONTINUE                                                 13900032
141400     ELSE                                                         13910032
141500         SET DP013-CICS-ABEND TO TRUE                             13920032
141600         SET DP013-NO-ROLLBACK TO TRUE                            13930032
141700                                                                  13940032
141800         MOVE '2050-DELETE-DETAIL-QUEUE' TO DP013-PARAGRAPH       13950032
141900         MOVE 'ERROR TRYING TO DELETE DETAIL TEMP STORAGE QUEUE'  13960032
142000                        TO DP013-MESSAGE-TEXT (1)                 13970032
142100         PERFORM DP013-0000-PROCESS-ABEND                         13980032
142200     END-IF.                                                      13990032
142300                                                                  14000032
142400     MOVE +0 TO ASC-HIGHEST-BLOCK-WRITTEN.                        14010032
142500 EJECT                                                            14020032
142600*----------------------------------------------------------------*14030032
142700*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *14040032
142800*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *14050032
142900*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *14060032
143000*    MESSAGE.                                                    *14070032
143100*----------------------------------------------------------------*14080032
143200                                                                  14090032
143300 2110-BROWSE-BACKWARD.                                            14100032
143400                                                                  14110032
143500     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    14120032
143600         GIVING PV-TOP-ITEM.                                      14130032
143700                                                                  14140032
143800     IF  PV-TOP-ITEM < +1                                         14150032
143900         MOVE +1              TO PV-TOP-ITEM                      14160032
144000*        -- TOP OF LIST --                                        14170032
144100         MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER                 14180032
144200         SET DP020-MSG-INFORMATIONAL TO TRUE                      14190032
144300     END-IF.                                                      14200032
144400                                                                  14210032
144500 EJECT                                                            14220032
144600                                                                  14230032
144700*----------------------------------------------------------------*14240032
144800*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *14250032
144900*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *14260032
145000*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *14270032
145100*----------------------------------------------------------------*14280032
145200                                                                  14290032
145300 2120-BROWSE-FORWARD.                                             14300032
145400                                                                  14310032
145500     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              14320032
145600         GIVING PV-TOP-ITEM.                                      14330032
145700     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   14340032
145800         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            14350032
145900                                   TO PV-TOP-ITEM                 14360032
146000*        -- BOTTOM OF LIST --                                     14370032
146100         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            14380032
146200         SET DP020-MSG-INFORMATIONAL                              14390032
146300                                   TO TRUE                        14400032
146400     ELSE                                                         14410032
146500         COMPUTE PV-BOTTOM-ITEM =                                 14420032
146600             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 14430032
146700         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            14440032
146800*            -- BOTTOM OF LIST --                                 14450032
146900             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            14460032
147000             SET DP020-MSG-INFORMATIONAL                          14470032
147100                                   TO TRUE                        14480032
147200         END-IF                                                   14490032
147300     END-IF.                                                      14500032
147400 EJECT                                                            14510032
147500*----------------------------------------------------------------*14520032
147600*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *14530032
147700*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *14540032
147800*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *14550032
147900*    RATHER THAN HITTING PF8 TO PAGE FORWARD TO THAT POINT.      *14560032
148000*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *14570032
148100*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *14580032
148200*----------------------------------------------------------------*14590032
148300                                                                  14600032
148400 2130-CHECK-FOR-JUMP-BROWSE.                                      14610032
148500                                                                  14620032
148600     IF ASTRTITL > ZERO                                           14630032
148700         MOVE ASTRTITI             TO ASC-START-ITEM-REQUEST      14640032
148800     ELSE                                                         14650032
148900         IF ASTRTITF = DP015-ERASE-EOF                            14660032
149000             INITIALIZE ASC-START-ITEM-REQUEST                    14670032
149100         END-IF                                                   14680032
149200     END-IF.                                                      14690032
149300                                                                  14700032
149400     SET PS-NO-ERROR               TO TRUE.                       14710032
149500     IF (ASC-START-ITEM-REQUEST = SPACE)                          14720032
149600         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            14730032
149700                                   TO PV-TOP-ITEM                 14740032
149800     ELSE                                                         14750032
149900         MOVE ASC-START-ITEM-REQUEST                              14760032
150000                                   TO DP010I-UNEDITED-FIELD       14770032
150100         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       14780032
150200         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     14790032
150300         SET DP010I-NEGATIVE-NOT-ALLOWED                          14800032
150400                                   TO TRUE                        14810032
263697         CALL DP010I-NUMERIC-EDIT-ROUTINE                         14821070
263697              USING DP010I-NUMERIC-EDIT-AREA                      14822070
150600                                                                  14830032
150700         IF  NOT DP010I-ERROR-DETECTED                            14840032
150800             MOVE DP010I-NUMERIC-FIELD                            14850032
150900                                   TO  ASC-START-ITEM-REQUEST-N   14860032
151000             IF  ASC-START-ITEM-REQUEST-N > ZERO                  14870032
151100                 IF  ASC-START-ITEM-REQUEST-N >                   14880032
151200                                          ASC-NUMBER-OF-ITEMS-READ14890032
151300                     MOVE SPACE TO ASC-START-ITEM-REQUEST         14900032
151400                     COMPUTE PV-TOP-ITEM =                        14910032
151500                             ASC-NUMBER-OF-ITEMS-READ             14920032
151600                             - PC-ITEMS-PER-PANEL + 1             14930032
151700                     IF  PV-TOP-ITEM < +1                         14940032
151800                         MOVE +1   TO PV-TOP-ITEM                 14950032
151900                         MOVE PC-TSYMSG-00070                     14960032
152000                                   TO DP020-MSG-NUMBER            14970032
152100                         SET DP020-MSG-INFORMATIONAL              14980032
152200                                   TO TRUE                        14990032
152300                     END-IF                                       15000032
152400                 ELSE                                             15010032
152500                     MOVE ASC-START-ITEM-REQUEST-N                15020032
152600                                   TO PV-TOP-ITEM                 15030032
152700                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      15040032
152800                     COMPUTE PV-BOTTOM-ITEM =                     15050032
152900                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     15060032
153000                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ15070032
153100*                        -- BOTTOM OF LIST --                     15080032
153200                         MOVE PC-TSYMSG-00070                     15090032
153300                                   TO DP020-MSG-NUMBER            15100032
153400                         SET DP020-MSG-INFORMATIONAL              15110032
153500                                   TO TRUE                        15120032
153600                     END-IF                                       15130032
153700                 END-IF                                           15140032
153800             ELSE                                                 15150032
153900*                --- VALUE OUT OF RANGE ----                      15160032
154000                 MOVE PC-TSYMSG-00101                             15170032
154100                                   TO DP020-MSG-NUMBER            15180032
154200                 MOVE -1           TO ASTRTITL                    15190032
154300                 SET DP030-SET-CURSOR-APPL-1                      15200032
154400                                   TO TRUE                        15210032
154500                 MOVE DP015-REVERSE                               15220032
154600                                   TO ASTRTITH                    15230032
154700                 MOVE DP015-RED    TO ASTRTITC                    15240032
154800                 MOVE DP015-UNP-NUM-BRT-MDT                       15250032
154900                                   TO ASTRTITA                    15260032
155000                 SET DP020-MSG-FATAL                              15270032
155100                                   TO TRUE                        15280032
155200                 SET PS-ERROR      TO TRUE                        15290032
155300             END-IF                                               15300032
155400                                                                  15310032
155500         ELSE                                                     15320032
155600             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            15330032
155700             MOVE -1               TO ASTRTITL                    15340032
155800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  15350032
155900             MOVE DP015-REVERSE    TO ASTRTITH                    15360032
156000             MOVE DP015-RED        TO ASTRTITC                    15370032
156100             MOVE DP015-UNP-NUM-BRT-MDT                           15380032
156200                                   TO ASTRTITA                    15390032
156300             SET DP020-MSG-FATAL   TO TRUE                        15400032
156400             SET PS-ERROR          TO TRUE                        15410032
156500         END-IF                                                   15420032
156600     END-IF.                                                      15430032
156700 EJECT                                                            15440032
156800                                                                  15450032
156900*----------------------------------------------------------------*15460032
157000*    GET THE NEXT MESSAGE IF A LIST OF MESSAGES IS BEING         *15470032
157100*    PROCESSED.                                                  *15480032
157200*----------------------------------------------------------------*15490032
157300                                                                  15500032
157400 2140-GET-NEXT-MESSAGE.                                           15510032
157500                                                                  15520032
157600     ADD +1                       TO ASC-SEL-SUB.                 15530032
157700     IF  ASC-SEL-SUB > DP057-MAX-ITEMS                            15540032
157800         ADD +1                   TO ASC-SEL-ITEM                 15550032
157900         MOVE +1                  TO ASC-SEL-SUB                  15560032
158000     END-IF.                                                      15570032
158100     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                15580032
158200         PERFORM 9100-READ-SEL-QUEUE                              15590032
158300         IF  DP057-ITEM (ASC-SEL-SUB) > ZERO                      15600032
158400             MOVE TR001-OPER-UNT-ID-N                             15610032
158500                                     TO DK-OPER-UNT-ID            15620032
158600                                        ASC-KEY-OPER-UNT-ID       15630032
158700             MOVE TR001-FCLTY-ID-N   TO DK-FCLTY-ID               15640032
158800                                        ASC-KEY-FCLTY-ID          15650032
158900             IF TR001-SCAC > SPACES                               15660032
159000                 MOVE TR001-SCAC         TO DK-PRO-SCAC-ID        15670032
159100                                            ASC-KEY-PRO-SCAC-ID   15680032
159200             END-IF                                               15690032
159300                                                                  15700032
159400             IF TR001-PO-NBR > SPACES                             15710032
159500*CLP 10/24/14 *                                                   15720068
159500                 MOVE TR001-PO-NBR       TO DK-PO-NBR             15721066
159600                                            ASC-KEY-PO-NBR        15730032
159700             END-IF                                               15740032
159800                                                                  15750032
159900             IF TR001-DEPT > ZEROES                               15760035
160000                 MOVE TR001-DEPT(2:3)    TO DK-DEPT-NBR           15770034
160100                 MOVE TR001-DEPT         TO ASC-KEY-DEPT-NBR      15780034
160200             END-IF                                               15790032
160300                                                                  15800032
160400             MOVE ASC-KEY-ETA-DTE    TO DK-ETA-DTE                15810032
160500             MOVE ASC-KEY-ETA-TO-DTE TO DK-ETA-TO-DTE             15820032
160600             SET DP057-INQ (ASC-SEL-SUB) TO TRUE                  15830032
160700             PERFORM 9200-REWRITE-SEL-QUEUE                       15840032
160800         ELSE                                                     15850032
160900             SUBTRACT +1 FROM ASC-SEL-SUB                         15860032
161000             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             15870032
161100             SET DP020-MSG-INFORMATIONAL TO TRUE                  15880032
161200             SET PS-LIST-END             TO TRUE                  15890032
161300         END-IF                                                   15900032
161400     ELSE                                                         15910032
161500         SUBTRACT +1 FROM ASC-SEL-ITEM                            15920032
161600         MOVE DP057-MAX-ITEMS     TO ASC-SEL-SUB                  15930032
161700         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             15940032
161800         SET DP020-MSG-INFORMATIONAL TO TRUE                      15950032
161900         SET PS-LIST-END             TO TRUE                      15960032
162000     END-IF.                                                      15970032
162100                                                                  15980032
162200*----------------------------------------------------------------*15990032
162300*    GET THE PREVIOUS MESSAGE IF A LIST OF MESSAGES IS BEING     *16000032
162400*    PROCESSED.                                                  *16010032
162500*----------------------------------------------------------------*16020032
162600                                                                  16030032
162700 2150-GET-PREV-MESSAGE.                                           16040032
162800                                                                  16050032
162900     SUBTRACT +1 FROM ASC-SEL-SUB.                                16060032
163000     IF  ASC-SEL-SUB < +1                                         16070032
163100         SUBTRACT +1 FROM ASC-SEL-ITEM                            16080032
163200         MOVE DP057-MAX-ITEMS     TO ASC-SEL-SUB                  16090032
163300     END-IF.                                                      16100032
163400                                                                  16110032
163500     IF  ASC-SEL-ITEM > ZERO                                      16120032
163600         PERFORM 9100-READ-SEL-QUEUE                              16130032
163700         MOVE TR001-OPER-UNT-ID-N                                 16140032
163800                                 TO DK-OPER-UNT-ID                16150032
163900                                    ASC-KEY-OPER-UNT-ID           16160032
164000         MOVE TR001-FCLTY-ID-N   TO DK-FCLTY-ID                   16170032
164100                                    ASC-KEY-FCLTY-ID              16180032
164200         IF TR001-SCAC > SPACES                                   16190032
164300             MOVE TR001-SCAC         TO DK-PRO-SCAC-ID            16200032
164400                                        ASC-KEY-PRO-SCAC-ID       16210032
164500         END-IF                                                   16220032
164600                                                                  16230032
164700         IF TR001-PO-NBR > SPACES                                 16240032
164800*CLP 10/24/14                                                     16250068
164800             MOVE TR001-PO-NBR       TO DK-PO-NBR                 16251066
164900                                        ASC-KEY-PO-NBR            16260032
165000         END-IF                                                   16270032
165100                                                                  16280032
165200         IF TR001-DEPT > ZEROES                                   16290035
165300             MOVE TR001-DEPT(2:3)    TO DK-DEPT-NBR               16300034
165400             MOVE TR001-DEPT         TO ASC-KEY-DEPT-NBR          16310034
165500         END-IF                                                   16320032
165600                                                                  16330032
165700         MOVE ASC-KEY-ETA-DTE        TO DK-ETA-DTE                16340032
165800         MOVE ASC-KEY-ETA-TO-DTE     TO DK-ETA-TO-DTE             16350032
165900     ELSE                                                         16360032
166000         MOVE +1                  TO ASC-SEL-ITEM                 16370032
166100                                     ASC-SEL-SUB                  16380032
166200         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             16390032
166300         SET DP020-MSG-INFORMATIONAL TO TRUE                      16400032
166400         SET PS-LIST-END             TO TRUE                      16410032
166500     END-IF.                                                      16420032
166600                                                                  16430032
166700 EJECT                                                            16440032
166800*----------------------------------------------------------------*16450032
166900*    RESET ATTRIBUTES.                                           *16460032
167000*----------------------------------------------------------------*16470032
167100                                                                  16480032
167200 3200-RESET-ATTRIBUTES.                                           16490032
167300                                                                  16500032
167400     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   16510032
167500     MOVE DP015-GREEN              TO ASTRTITC.                   16520032
167600     MOVE DP015-UNDERLINE          TO ASTRTITH.                   16530032
167700     MOVE -1                       TO ASTRTITL.                   16540032
167800     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       16550032
167900                                                                  16560032
168000 EJECT                                                            16570032
168100                                                                  16580032
168200*----------------------------------------------------------------*16590032
168300*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *16600032
168400*    INITIALIZE ALL COUNTERS AND FLAGS.                          *16610032
168500*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *16620032
168600*    DISPLAY THE PANEL TO USER.                                  *16630032
168700*----------------------------------------------------------------*16640032
168800                                                                  16650032
168900 4000-BUILD-INITIAL-PANEL.                                        16660032
169000                                                                  16670032
169100     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            16680032
169200                                 ASC-BLOCK-ENTRIES (2).           16690032
169300     MOVE +1                 TO  ASC-BLK-SUB.                     16700032
169400     SET ASC-ITEMS-LEFT-ON-DB                                     16710032
169500                             TO  TRUE.                            16720032
169600                                                                  16730032
169700     MOVE +0                 TO  ASC-ITEM-SUB                     16740032
169800                                 ASC-NUMBER-OF-ITEMS-READ         16750032
169900                                 ASC-NUMBER-OF-SELECTED-ITEMS     16760032
170000                                 ASC-HIGHEST-BLOCK-WRITTEN        16770032
170100                                 ASC-START-OF-SELECTED-RANGE      16780032
170200                                 ASC-END-OF-SELECTED-RANGE        16790032
170300                                 ASC-ITEM-AT-TOP-OF-PANEL.        16800032
170400                                                                  16810032
170500     MOVE SPACE              TO  ASC-DESC-LINE-IND                16820032
170600                                 ASC-CORR-LINE-IND.               16830032
170700                                                                  16840032
170800     PERFORM 4010-OPEN-CURSOR.                                    16850032
170900                                                                  16860032
171000     PERFORM 4300-READ-ITEMS-FROM-DB.                             16870032
171100                                                                  16880032
171200     PERFORM 4020-CLOSE-CURSOR.                                   16890032
171300                                                                  16900032
171400     MOVE +1                 TO  PV-TOP-ITEM.                     16910032
171500     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          16920032
171600         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    16930032
171700         SET DP020-MSG-FATAL   TO  TRUE                           16940032
171800         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               16950032
171900     ELSE                                                         16960032
172000         MOVE -1             TO ASTRTITL                          16970032
172100         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      16980032
172200         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     16990032
172300     END-IF.                                                      17000032
172400 EJECT                                                            17010032
172500*----------------------------------------------------------------*17020032
172600* OPEN THE CURSOR.                                               *17030032
172700*----------------------------------------------------------------*17040032
172800                                                                  17050032
172900 4010-OPEN-CURSOR.                                                17060032
173000     IF DK-OPER-UNT-ID > ZERO                                     17070032
173100         IF DK-DEPT-NBR > SPACES                                  17080032
173200             SET PS-OPER-DEPT TO TRUE                             17090032
173300         ELSE                                                     17100032
173400             IF DK-PO-NBR > ZERO   AND                            17110032
173500                DK-PRO-SCAC-ID > SPACES                           17120032
173600                 SET PS-OPER-PO-SCAC TO TRUE                      17130032
173700             ELSE                                                 17140032
173800                 IF DK-PO-NBR > ZERO                              17150032
173900                     SET PS-OPER-PO TO TRUE                       17160032
174000                 ELSE                                             17170032
174100                     IF DK-PRO-NBR > SPACES                       17180032
174200                         SET PS-OPER-PRO-SCAC TO TRUE             17190032
174300                     ELSE                                         17200032
174400                         SET PS-OPER-SCAC TO TRUE                 17210032
174500                     END-IF                                       17220032
174600                 END-IF                                           17230032
174700             END-IF                                               17240032
174800         END-IF                                                   17250032
174900     ELSE                                                         17260032
175000         IF DK-DEPT-NBR > SPACES                                  17270032
175100             SET PS-DEPT TO TRUE                                  17280032
175200         ELSE                                                     17290032
175300             IF DK-PO-NBR > ZERO   AND                            17300032
175400                DK-PRO-SCAC-ID > SPACES                           17310032
175500                 SET PS-PO-SCAC TO TRUE                           17320032
175600             ELSE                                                 17330032
175700                 IF DK-PO-NBR > ZERO                              17340032
175800                     SET PS-PO TO TRUE                            17350032
175900                 ELSE                                             17360032
176000                     IF DK-PRO-NBR > SPACES                       17370032
176100                         SET PS-PRO-SCAC TO TRUE                  17380032
176200                     ELSE                                         17390032
176300                         SET PS-SCAC TO TRUE                      17400032
176400                     END-IF                                       17410032
176500                 END-IF                                           17420032
176600             END-IF                                               17430032
176700         END-IF                                                   17440032
176800     END-IF.                                                      17450032
176900                                                                  17460032
177000     PERFORM 4011-OPEN-CURSOR.                                    17470032
177200/                                                                 17480032
177300*----------------------------------------------------------------*17490032
177400*    OPEN THE PO-SCAC CURSOR.                                    *17500032
177500*                                                                *17510032
177600*    PERFORMED BY L100-OPEN-CURSOR.                              *17520032
177700*----------------------------------------------------------------*17530032
177800                                                                  17540032
177900 4011-OPEN-CURSOR.                                                17550032
178100     EVALUATE TRUE                                                17560032
178200         WHEN PS-PO-SCAC                                          17570032
178300             EXEC SQL                                             17580032
178400                  OPEN PO-SCAC                                    17590032
178500             END-EXEC                                             17600032
178600                                                                  17610032
178700         WHEN PS-PO                                               17620032
178800             EXEC SQL                                             17630032
178900                  OPEN PO                                         17640032
179000             END-EXEC                                             17650032
179100                                                                  17660032
179200         WHEN PS-SCAC                                             17670032
179300             EXEC SQL                                             17680032
179400                  OPEN SCAC                                       17690032
179500             END-EXEC                                             17700032
179600                                                                  17710032
179700         WHEN PS-OPER-PO-SCAC                                     17720032
179800             EXEC SQL                                             17730032
179900                  OPEN OPER-PO-SCAC                               17740032
180000             END-EXEC                                             17750032
180100                                                                  17760032
180200         WHEN PS-OPER-PO                                          17770032
180300             EXEC SQL                                             17780032
180400                  OPEN OPER-PO                                    17790032
180500             END-EXEC                                             17800032
180600                                                                  17810032
180700         WHEN PS-OPER-SCAC                                        17820032
180800             EXEC SQL                                             17830032
180900                  OPEN OPER-SCAC                                  17840032
181000             END-EXEC                                             17850032
181100                                                                  17860032
181200         WHEN PS-DEPT                                             17870032
181300         WHEN PS-OPER-DEPT                                        17880032
181400             EXEC SQL                                             17890032
181500                  OPEN DEPT                                       17900032
181600             END-EXEC                                             17910032
181700                                                                  17920032
181800*        WHEN PS-OPER-DEPT                                        17930032
181900*            EXEC SQL                                             17940032
182000*                 OPEN OPER-DEPT                                  17950032
182100*            END-EXEC                                             17960032
182200                                                                  17970032
182300         WHEN PS-PRO-SCAC                                         17980032
182400             EXEC SQL                                             17990032
182500                  OPEN PRO-SCAC                                   18000032
182600             END-EXEC                                             18010032
182700                                                                  18020032
182800         WHEN PS-OPER-PRO-SCAC                                    18030032
182900             EXEC SQL                                             18040032
183000                  OPEN OPER-PRO-SCAC                              18050032
183100             END-EXEC                                             18060032
183200                                                                  18070032
183300     END-EVALUATE.                                                18080032
183400                                                                  18090032
183500     EVALUATE TRUE                                                18100032
183600         WHEN SQLCODE = ZERO                                      18110032
183700              CONTINUE                                            18120032
183800         WHEN SQLWARN0 NOT EQUAL SPACE                            18130032
183900         WHEN SQLCODE NOT EQUAL ZERO                              18140032
184000              MOVE '4011-OPEN-CURSOR'                             18150032
184100                           TO  DP013-PARAGRAPH                    18160032
184200              MOVE 'OPEN MESSAGE CURSOR'                          18170032
184300                           TO  DP013-MESSAGE-TEXT (1)             18180032
184400              MOVE SQLCA   TO  DP013-SQLCA                        18190032
184500              SET DP013-DB2-ABEND                                 18200032
184600                           TO  TRUE                               18210032
184700              PERFORM DP013-0000-PROCESS-ABEND                    18220032
184800     END-EVALUATE.                                                18230032
184900/                                                                 18240032
185200*----------------------------------------------------------------*18250032
185300* CLOSE THE CURSOR.                                              *18260032
185400*----------------------------------------------------------------*18270032
185500                                                                  18280032
185600 4020-CLOSE-CURSOR.                                               18290032
185800     EVALUATE TRUE                                                18300032
185900         WHEN PS-PO-SCAC                                          18310032
186000             EXEC SQL                                             18320032
186100                  CLOSE PO-SCAC                                   18330032
186200             END-EXEC                                             18340032
186300                                                                  18350032
186400         WHEN PS-PO                                               18360032
186500             EXEC SQL                                             18370032
186600                  CLOSE PO                                        18380032
186700             END-EXEC                                             18390032
186800                                                                  18400032
186900         WHEN PS-SCAC                                             18410032
187000             EXEC SQL                                             18420032
187100                  CLOSE SCAC                                      18430032
187200             END-EXEC                                             18440032
187300                                                                  18450032
187400         WHEN PS-OPER-PO-SCAC                                     18460032
187500             EXEC SQL                                             18470032
187600                  CLOSE OPER-PO-SCAC                              18480032
187700             END-EXEC                                             18490032
187800                                                                  18500032
187900         WHEN PS-OPER-PO                                          18510032
188000             EXEC SQL                                             18520032
188100                  CLOSE OPER-PO                                   18530032
188200             END-EXEC                                             18540032
188300                                                                  18550032
188400         WHEN PS-OPER-SCAC                                        18560032
188500             EXEC SQL                                             18570032
188600                  CLOSE OPER-SCAC                                 18580032
188700             END-EXEC                                             18590032
188800                                                                  18600032
188900         WHEN PS-DEPT                                             18610032
189000         WHEN PS-OPER-DEPT                                        18620032
189100             EXEC SQL                                             18630032
189200                  CLOSE DEPT                                      18640032
189300             END-EXEC                                             18650032
189400                                                                  18660032
189500*        WHEN PS-OPER-DEPT                                        18670032
189600*            EXEC SQL                                             18680032
189700*                 CLOSE OPER-DEPT                                 18690032
189800*            END-EXEC                                             18700032
189900                                                                  18710032
190000         WHEN PS-PRO-SCAC                                         18720032
190100             EXEC SQL                                             18730032
190200                  CLOSE PRO-SCAC                                  18740032
190300             END-EXEC                                             18750032
190400                                                                  18760032
190500         WHEN PS-OPER-PRO-SCAC                                    18770032
190600             EXEC SQL                                             18780032
190700                  CLOSE OPER-PRO-SCAC                             18790032
190800             END-EXEC                                             18800032
190900                                                                  18810032
191000     END-EVALUATE.                                                18820032
191100                                                                  18830032
191200     EVALUATE TRUE                                                18840032
191300         WHEN SQLCODE = ZERO                                      18850032
191400              CONTINUE                                            18860032
191500         WHEN SQLWARN0 NOT EQUAL SPACE                            18870032
191600         WHEN SQLCODE NOT EQUAL ZERO                              18880032
191700              MOVE '4020-CLOSE-CURSOR'                            18890032
191800                           TO  DP013-PARAGRAPH                    18900032
191900              MOVE 'CLOSE MESSAGE CURSOR'                         18910032
192000                           TO  DP013-MESSAGE-TEXT (1)             18920032
192100              MOVE SQLCA   TO  DP013-SQLCA                        18930032
192200              SET DP013-DB2-ABEND                                 18940032
192300                           TO  TRUE                               18950032
192400              PERFORM DP013-0000-PROCESS-ABEND                    18960032
192500     END-EVALUATE.                                                18970032
192600/                                                                 18980032
192800*----------------------------------------------------------------*18990032
192900*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *19000032
193000*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *19010032
193100*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *19020032
193200*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *19030032
193300*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *19040032
193400*                                                                *19050032
193500*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *19060032
193600*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *19070032
193700*    UPON INITIALIZATION.                                        *19080032
193800*----------------------------------------------------------------*19090032
193900                                                                  19100032
194000 4300-READ-ITEMS-FROM-DB.                                         19110032
194300     PERFORM                                                      19120032
194400         VARYING PV-READ-COUNT                                    19130032
194500         FROM 1 BY 1                                              19140032
194600         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    19150032
194700            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         19160032
194800                                                                  19170032
194900         SET PS-DATA-HAS-NOT-BEEN-MOVED TO TRUE                   19180032
195000         PERFORM 4310-FETCH                                       19190032
195100                                                                  19200032
195200         IF ASC-ITEMS-LEFT-ON-DB AND                              19210032
195300            PS-DATA-HAS-NOT-BEEN-MOVED                            19220032
195400             PERFORM 4390-GET-SUB                                 19230032
195500             PERFORM 4395-MOVE-DATA-TO-ASC                        19240032
195600         END-IF                                                   19250032
195700     END-PERFORM.                                                 19260032
195800                                                                  19270032
195900     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          19280032
196000         MOVE +1                       TO  ASC-BLK-SUB            19290032
196100         PERFORM 5100-WRITE-TEMP-STORAGE                          19300032
196200         ADD +1                        TO  ASC-BLK-SUB            19310032
196300         PERFORM 5100-WRITE-TEMP-STORAGE                          19320032
196400                                                                  19330032
196500         MOVE 1                        TO  ASC-BLK-SUB            19340032
196600                                           PV-BLOCK-NUMBER        19350032
196700         PERFORM 4410-READ-TEMP-STORAGE                           19360032
196800         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             19370032
196900             MOVE 2                    TO  ASC-BLK-SUB            19380032
197000                                           PV-BLOCK-NUMBER        19390032
197100             PERFORM 4410-READ-TEMP-STORAGE                       19400032
197200         END-IF                                                   19410032
197300     END-IF.                                                      19420032
197400/                                                                 19430032
197500*----------------------------------------------------------------*19440032
197600*    FETCH THE TEXT CURSOR.                                      *19450032
197700*----------------------------------------------------------------*19460032
197800                                                                  19470032
197900 4310-FETCH.                                                      19480032
198000                                                                  19490032
198100     EVALUATE TRUE                                                19500032
198200         WHEN PS-PO-SCAC                                          19510032
198300              PERFORM 4320-FETCH-PO-SCAC-CURSOR                   19520032
198400                                                                  19530032
198500         WHEN PS-PO                                               19540032
198600              PERFORM 4330-FETCH-PO-CURSOR                        19550032
198700                                                                  19560032
198800         WHEN PS-SCAC                                             19570032
198900              PERFORM 4340-FETCH-SCAC-CURSOR                      19580032
199000                                                                  19590032
199100         WHEN PS-OPER-PO-SCAC                                     19600032
199200              PERFORM 4350-FETCH-OPER-PO-SCAC-CURSOR              19610032
199300                                                                  19620032
199400         WHEN PS-OPER-PO                                          19630032
199500              PERFORM 4360-FETCH-OPER-PO-CURSOR                   19640032
199600                                                                  19650032
199700         WHEN PS-OPER-SCAC                                        19660032
199800              PERFORM 4370-FETCH-OPER-SCAC-CURSOR                 19670032
199900                                                                  19680032
200000         WHEN PS-DEPT                                             19690032
200100         WHEN PS-OPER-DEPT                                        19700032
200200              PERFORM 4380-FETCH-DEPT-CURSOR                      19710032
200300                                                                  19720032
200400*        WHEN PS-OPER-DEPT                                        19730032
200500*             PERFORM 4385-FETCH-OPER-DEPT-CURSOR                 19740032
200600                                                                  19750032
200700         WHEN PS-PRO-SCAC                                         19760032
200800             PERFORM 4387-FETCH-PRO-SCAC-CURSOR                   19770032
200900                                                                  19780032
201000         WHEN PS-OPER-PRO-SCAC                                    19790032
201100             PERFORM 4389-FETCH-OPER-PRO-SCAC-CSR                 19800032
201200                                                                  19810032
201300     END-EVALUATE.                                                19820032
201500/                                                                 19830032
201600 4320-FETCH-PO-SCAC-CURSOR.                                       19840032
201800     EXEC SQL                                                     19850032
201900          FETCH  PO-SCAC                                          19860032
202000           INTO :SHIPMT-TRIP-ID :PV-SHIPMT-TRIP-ID-NULL,          19870032
202100                :SHIPMT-SHIPT-ID,                                 19880032
202200                :SHIPMT-PRO-NBR,                                  19890032
202300                :SHIPMT-PRO-SCAC-ID,                              19900032
202400*               :SHIPMT-SHIPPER-NME,                              19910032
202500                :SHPTPO-PO-NBR,                                   19920032
202700                :TRIPST-OPER-UNT-ID,                              19940032
202800                :TRIPST-FCLTY-ID,                                 19950032
202900                :SHIPST-STATUS-DTE,                               19960032
203000                :SHSTYP-PRTY-CDE,                                 19970032
203100                :VHTRIP-MANIFEST-NBR,                             19980032
203200                :SHIPMT-EST-AR-TMST,                              19990037
203210                :PURCHS-DEPT-NBR                                  19991037
203300     END-EXEC.                                                    20000032
203400                                                                  20010032
203500     EVALUATE TRUE                                                20020032
203600         WHEN SQLCODE = ZERO                                      20030032
203700              IF PV-SHIPMT-TRIP-ID-NULL = PC-NEG-1                20040032
203800                  MOVE ZEROS     TO SHIPMT-TRIP-ID                20050032
203900              END-IF                                              20060032
204000              PERFORM 4600-SELECT-VHTRIP                          20070032
204100              PERFORM 4700-READ-PURCHS-TABLE                      20080032
204200         WHEN SQLCODE = +100                                      20090032
204300             SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                  20100032
204400                                                                  20110032
204500         WHEN SQLWARN0 NOT EQUAL SPACE                            20120032
204600         WHEN SQLCODE  NOT EQUAL ZERO                             20130032
204700              MOVE '4320-FETCH-PO-SCAC-CURSOR'                    20140032
204800                                 TO DP013-PARAGRAPH               20150032
204900              MOVE 'FETCH PO-SCAC CURSOR'                         20160032
205000                                 TO DP013-MESSAGE-TEXT (1)        20170032
205100              MOVE SQLCA         TO DP013-SQLCA                   20180032
205200              SET DP013-DB2-ABEND                                 20190032
205300                                 TO TRUE                          20200032
205400              PERFORM DP013-0000-PROCESS-ABEND                    20210032
205500     END-EVALUATE.                                                20220032
205600 EJECT                                                            20230032
205700                                                                  20240032
205800 4330-FETCH-PO-CURSOR.                                            20250032
205900                                                                  20260032
206000     EXEC SQL                                                     20270032
206100          FETCH  PO                                               20280032
206200           INTO :SHIPMT-TRIP-ID :PV-SHIPMT-TRIP-ID-NULL,          20290032
206300                :SHIPMT-SHIPT-ID,                                 20300032
206400                :SHIPMT-PRO-NBR,                                  20310032
206500                :SHIPMT-PRO-SCAC-ID,                              20320032
206600*               :SHIPMT-SHIPPER-NME,                              20330032
206700                :SHPTPO-PO-NBR,                                   20340032
206900                :TRIPST-OPER-UNT-ID,                              20360032
207000                :TRIPST-FCLTY-ID,                                 20370032
207100                :SHIPST-STATUS-DTE,                               20380032
207200                :SHSTYP-PRTY-CDE,                                 20390032
207300                :VHTRIP-MANIFEST-NBR,                             20400032
207400                :SHIPMT-EST-AR-TMST,                              20410037
207410                :PURCHS-DEPT-NBR                                  20411037
207500     END-EXEC.                                                    20420032
207600                                                                  20430032
207700     EVALUATE TRUE                                                20440032
207800         WHEN SQLCODE = ZERO                                      20450032
207900              IF PV-SHIPMT-TRIP-ID-NULL = PC-NEG-1                20460032
208000                  MOVE ZEROS     TO SHIPMT-TRIP-ID                20470032
208100              END-IF                                              20480032
208200              PERFORM 4600-SELECT-VHTRIP                          20490032
208300              PERFORM 4700-READ-PURCHS-TABLE                      20500032
208400         WHEN SQLCODE = +100                                      20510032
208500             SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                  20520032
208600                                                                  20530032
208700         WHEN SQLWARN0 NOT EQUAL SPACE                            20540032
208800         WHEN SQLCODE  NOT EQUAL ZERO                             20550032
208900              MOVE '4330-FETCH-PO-CURSOR'                         20560032
209000                                 TO DP013-PARAGRAPH               20570032
209100              MOVE 'FETCH PO CURSOR'                              20580032
209200                                 TO DP013-MESSAGE-TEXT (1)        20590032
209300              MOVE SQLCA         TO DP013-SQLCA                   20600032
209400              SET DP013-DB2-ABEND                                 20610032
209500                                 TO TRUE                          20620032
209600              PERFORM DP013-0000-PROCESS-ABEND                    20630032
209700     END-EVALUATE.                                                20640032
209800                                                                  20650032
209900 EJECT                                                            20660032
210000                                                                  20670032
210100 4340-FETCH-SCAC-CURSOR.                                          20680032
210200                                                                  20690032
210300     EXEC SQL                                                     20700032
210400          FETCH  SCAC                                             20710032
210500           INTO :SHIPMT-TRIP-ID :PV-SHIPMT-TRIP-ID-NULL,          20720032
210600                :SHIPMT-SHIPT-ID,                                 20730032
210700                :SHIPMT-PRO-NBR,                                  20740032
210800                :SHIPMT-PRO-SCAC-ID,                              20750032
210900*               :SHIPMT-SHIPPER-NME,                              20760032
211000*               :SHPTPO-PO-NBR,                                   20770032
211200                :TRIPST-OPER-UNT-ID,                              20790032
211300                :TRIPST-FCLTY-ID,                                 20800032
211400                :SHIPST-STATUS-DTE,                               20810032
211500                :SHSTYP-PRTY-CDE,                                 20820032
211600*               :VHTRIP-MANIFEST-NBR                              20830032
211700                :SHIPMT-EST-AR-TMST                               20840032
211800     END-EXEC.                                                    20850032
211900                                                                  20860032
212000     EVALUATE TRUE                                                20870032
212100         WHEN SQLCODE = ZERO                                      20880032
212200              IF PV-SHIPMT-TRIP-ID-NULL = PC-NEG-1                20890032
212300                  MOVE ZEROS     TO SHIPMT-TRIP-ID                20900032
212400              END-IF                                              20910032
212500              PERFORM 4600-SELECT-VHTRIP                          20920032
212600              PERFORM 4900-PROCESS-SHPTPO                         20930032
212700              SET PS-DATA-HAS-BEEN-MOVED TO TRUE                  20940032
212800         WHEN SQLCODE = +100                                      20950032
212900             SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                  20960032
213000                                                                  20970032
213100         WHEN SQLWARN0 NOT EQUAL SPACE                            20980032
213200         WHEN SQLCODE  NOT EQUAL ZERO                             20990032
213300              MOVE '4340-FETCH-SCAC-CURSOR'                       21000032
213400                                 TO DP013-PARAGRAPH               21010032
213500              MOVE 'FETCH SCAC CURSOR'                            21020032
213600                                 TO DP013-MESSAGE-TEXT (1)        21030032
213700              MOVE SQLCA         TO DP013-SQLCA                   21040032
213800              SET DP013-DB2-ABEND                                 21050032
213900                                 TO TRUE                          21060032
214000              PERFORM DP013-0000-PROCESS-ABEND                    21070032
214100     END-EVALUATE.                                                21080032
214200                                                                  21090032
214300                                                                  21100032
214400 4350-FETCH-OPER-PO-SCAC-CURSOR.                                  21110032
214500                                                                  21120032
214600     EXEC SQL                                                     21130032
214700          FETCH  OPER-PO-SCAC                                     21140032
214800           INTO :SHIPMT-TRIP-ID :PV-SHIPMT-TRIP-ID-NULL,          21150032
214900                :SHIPMT-SHIPT-ID,                                 21160032
215000                :SHIPMT-PRO-NBR,                                  21170032
215100                :SHIPMT-PRO-SCAC-ID,                              21180032
215200*               :SHIPMT-SHIPPER-NME,                              21190032
215300                :SHPTPO-PO-NBR,                                   21200032
215500                :TRIPST-OPER-UNT-ID,                              21220032
215600                :TRIPST-FCLTY-ID,                                 21230032
215700                :SHIPST-STATUS-DTE,                               21240032
215800                :SHSTYP-PRTY-CDE,                                 21250032
215900                :VHTRIP-MANIFEST-NBR,                             21260032
216000                :SHIPMT-EST-AR-TMST,                              21270037
216010                :PURCHS-DEPT-NBR                                  21271037
216100     END-EXEC.                                                    21280032
216200                                                                  21290032
216300     EVALUATE TRUE                                                21300032
216400         WHEN SQLCODE = ZERO                                      21310032
216500              IF PV-SHIPMT-TRIP-ID-NULL = PC-NEG-1                21320032
216600                  MOVE ZEROS     TO SHIPMT-TRIP-ID                21330032
216700              END-IF                                              21340032
216800              PERFORM 4600-SELECT-VHTRIP                          21350032
216900              PERFORM 4700-READ-PURCHS-TABLE                      21360032
217000         WHEN SQLCODE = +100                                      21370032
217100             SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                  21380032
217200                                                                  21390032
217300         WHEN SQLWARN0 NOT EQUAL SPACE                            21400032
217400         WHEN SQLCODE  NOT EQUAL ZERO                             21410032
217500              MOVE '4350-FETCH-OPER-PO-SCAC-CURSOR'               21420032
217600                                 TO DP013-PARAGRAPH               21430032
217700              MOVE 'FETCH OPER-PO-SCAC CURSOR'                    21440032
217800                                 TO DP013-MESSAGE-TEXT (1)        21450032
217900              MOVE SQLCA         TO DP013-SQLCA                   21460032
218000              SET DP013-DB2-ABEND                                 21470032
218100                                 TO TRUE                          21480032
218200              PERFORM DP013-0000-PROCESS-ABEND                    21490032
218300     END-EVALUATE.                                                21500032
218400                                                                  21510032
218500 4360-FETCH-OPER-PO-CURSOR.                                       21520032
218600                                                                  21530032
218700     EXEC SQL                                                     21540032
218800          FETCH  OPER-PO                                          21550032
218900           INTO :SHIPMT-TRIP-ID :PV-SHIPMT-TRIP-ID-NULL,          21560032
219000                :SHIPMT-SHIPT-ID,                                 21570032
219100                :SHIPMT-PRO-NBR,                                  21580032
219200                :SHIPMT-PRO-SCAC-ID,                              21590032
219300*               :SHIPMT-SHIPPER-NME,                              21600032
219400                :SHPTPO-PO-NBR,                                   21610032
219600                :TRIPST-OPER-UNT-ID,                              21630032
219700                :TRIPST-FCLTY-ID,                                 21640032
219800                :SHIPST-STATUS-DTE,                               21650032
219900                :SHSTYP-PRTY-CDE,                                 21660032
220000                :VHTRIP-MANIFEST-NBR,                             21670032
220100                :SHIPMT-EST-AR-TMST,                              21680037
220110                :PURCHS-DEPT-NBR                                  21681037
220200     END-EXEC.                                                    21690032
220300                                                                  21700032
220400     EVALUATE TRUE                                                21710032
220500         WHEN SQLCODE = ZERO                                      21720032
220600              IF PV-SHIPMT-TRIP-ID-NULL = PC-NEG-1                21730032
220700                  MOVE ZEROS     TO SHIPMT-TRIP-ID                21740032
220800              END-IF                                              21750032
220900              PERFORM 4600-SELECT-VHTRIP                          21760032
221000              PERFORM 4700-READ-PURCHS-TABLE                      21770032
221100         WHEN SQLCODE = +100                                      21780032
221200             SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                  21790032
221300                                                                  21800032
221400         WHEN SQLWARN0 NOT EQUAL SPACE                            21810032
221500         WHEN SQLCODE  NOT EQUAL ZERO                             21820032
221600              MOVE '4360-FETCH-OPER-PO-CURSOR'                    21830032
221700                                 TO DP013-PARAGRAPH               21840032
221800              MOVE 'FETCH OPER-PO CURSOR'                         21850032
221900                                 TO DP013-MESSAGE-TEXT (1)        21860032
222000              MOVE SQLCA         TO DP013-SQLCA                   21870032
222100              SET DP013-DB2-ABEND                                 21880032
222200                                 TO TRUE                          21890032
222300              PERFORM DP013-0000-PROCESS-ABEND                    21900032
222400     END-EVALUATE.                                                21910032
222500                                                                  21920032
222600                                                                  21930032
222700 4370-FETCH-OPER-SCAC-CURSOR.                                     21940032
222800                                                                  21950032
222900     EXEC SQL                                                     21960032
223000          FETCH  OPER-SCAC                                        21970032
223100           INTO :SHIPMT-TRIP-ID :PV-SHIPMT-TRIP-ID-NULL,          21980032
223200                :SHIPMT-SHIPT-ID,                                 21990032
223300                :SHIPMT-PRO-NBR,                                  22000032
223400                :SHIPMT-PRO-SCAC-ID,                              22010032
223500*               :SHIPMT-SHIPPER-NME,                              22020032
223600                :TRIPST-OPER-UNT-ID,                              22030032
223700                :TRIPST-FCLTY-ID,                                 22040032
223800                :SHIPST-STATUS-DTE,                               22050032
223900                :SHSTYP-PRTY-CDE,                                 22060032
224000                :SHIPMT-EST-AR-TMST                               22070032
224100     END-EXEC.                                                    22080032
224200                                                                  22090032
224300     EVALUATE TRUE                                                22100032
224400         WHEN SQLCODE = ZERO                                      22110032
224500              IF PV-SHIPMT-TRIP-ID-NULL = PC-NEG-1                22120032
224600                  MOVE ZEROS     TO SHIPMT-TRIP-ID                22130032
224700              END-IF                                              22140032
224800              PERFORM 4600-SELECT-VHTRIP                          22150032
224900              PERFORM 4900-PROCESS-SHPTPO                         22160032
225000              SET PS-DATA-HAS-BEEN-MOVED TO TRUE                  22170032
225100         WHEN SQLCODE = +100                                      22180032
225200             SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                  22190032
225300                                                                  22200032
225400         WHEN SQLWARN0 NOT EQUAL SPACE                            22210032
225500         WHEN SQLCODE  NOT EQUAL ZERO                             22220032
225600              MOVE '4370-FETCH-OPER-SCAC-CURSOR'                  22230032
225700                                 TO DP013-PARAGRAPH               22240032
225800              MOVE 'FETCH OPER-SCAC CURSOR'                       22250032
225900                                 TO DP013-MESSAGE-TEXT (1)        22260032
226000              MOVE SQLCA         TO DP013-SQLCA                   22270032
226100              SET DP013-DB2-ABEND                                 22280032
226200                                 TO TRUE                          22290032
226300              PERFORM DP013-0000-PROCESS-ABEND                    22300032
226400     END-EVALUATE.                                                22310032
226500                                                                  22320032
226600                                                                  22330032
226700 4380-FETCH-DEPT-CURSOR.                                          22340032
226800                                                                  22350032
226900     EXEC SQL                                                     22360032
227000          FETCH  DEPT                                             22370032
227100           INTO :SHIPMT-TRIP-ID :PV-SHIPMT-TRIP-ID-NULL,          22380032
227200                :SHIPMT-SHIPT-ID,                                 22390032
227300                :SHIPMT-PRO-NBR,                                  22400032
227400                :SHIPMT-PRO-SCAC-ID,                              22410032
227500*               :SHIPMT-SHIPPER-NME,                              22420032
227600                :SHPTPO-PO-NBR,                                   22430032
227800                :TRIPST-OPER-UNT-ID,                              22450032
227900                :TRIPST-FCLTY-ID,                                 22460032
228000                :SHIPST-STATUS-DTE,                               22470032
228100                :SHSTYP-PRTY-CDE,                                 22480032
228200                :VHTRIP-MANIFEST-NBR,                             22490032
228300                :SHIPMT-EST-AR-TMST,                              22500037
228310                :PURCHS-DEPT-NBR                                  22501037
228400     END-EXEC.                                                    22510032
228500                                                                  22520032
228600     SET PS-DATA-HAS-NOT-BEEN-MOVED TO TRUE.                      22530032
228700     EVALUATE TRUE                                                22540032
228800         WHEN SQLCODE = ZERO                                      22550032
228900             IF PS-DEPT OR                                        22560032
229000               (PS-OPER-DEPT AND                                  22570032
229100                ASC-KEY-OPER-UNT-ID = TRIPST-OPER-UNT-ID AND      22580032
229200                ASC-KEY-FCLTY-ID = TRIPST-FCLTY-ID)               22590032
229300                  IF PV-SHIPMT-TRIP-ID-NULL = PC-NEG-1            22600032
229400                      MOVE ZEROS     TO SHIPMT-TRIP-ID            22610032
229500                  END-IF                                          22620032
229600                  PERFORM 4600-SELECT-VHTRIP                      22630032
229700                  PERFORM 4700-READ-PURCHS-TABLE                  22640032
229800             ELSE                                                 22650032
229900*  BYPASS THE RECORDS WHOSE OPER-UNIT DOES NOT MATCH -            22660032
230000*  THIS CHECK WAS ADDED BECAUSE THE SQL WITH THE OPER-UNT AND FCLT22670032
230100*  FIELDS IN IT FOR THE DEPT SEARCH IS VERY INEFFICIENT.          22680032
230200                 SET PS-DATA-HAS-BEEN-MOVED TO TRUE               22690032
230300             END-IF                                               22700032
230400         WHEN SQLCODE = +100                                      22710032
230500             SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                  22720032
230600                                                                  22730032
230700         WHEN SQLWARN0 NOT EQUAL SPACE                            22740032
230800         WHEN SQLCODE  NOT EQUAL ZERO                             22750032
230900              MOVE '4380-FETCH-DEPT-CURSOR'                       22760032
231000                                 TO DP013-PARAGRAPH               22770032
231100              MOVE 'FETCH DEPT CURSOR'                            22780032
231200                                 TO DP013-MESSAGE-TEXT (1)        22790032
231300              MOVE SQLCA         TO DP013-SQLCA                   22800032
231400              SET DP013-DB2-ABEND                                 22810032
231500                                 TO TRUE                          22820032
231600              PERFORM DP013-0000-PROCESS-ABEND                    22830032
231700     END-EVALUATE.                                                22840032
231800                                                                  22850032
231900                                                                  22860032
232000 4385-FETCH-OPER-DEPT-CURSOR.                                     22870032
232100                                                                  22880032
232200     EXEC SQL                                                     22890032
232300          FETCH  OPER-DEPT                                        22900032
232400           INTO :SHIPMT-TRIP-ID :PV-SHIPMT-TRIP-ID-NULL,          22910032
232500                :SHIPMT-SHIPT-ID,                                 22920032
232600                :SHIPMT-PRO-NBR,                                  22930032
232700                :SHIPMT-PRO-SCAC-ID,                              22940032
232800*               :SHIPMT-SHIPPER-NME,                              22950032
232900                :SHPTPO-PO-NBR,                                   22960032
233100                :TRIPST-OPER-UNT-ID,                              22980032
233200                :TRIPST-FCLTY-ID,                                 22990032
233300                :SHIPST-STATUS-DTE,                               23000032
233400                :SHSTYP-PRTY-CDE,                                 23010032
233500                :VHTRIP-MANIFEST-NBR,                             23020032
233600                :SHIPMT-EST-AR-TMST,                              23030037
233610                :PURCHS-DEPT-NBR                                  23031037
233700     END-EXEC.                                                    23040032
233800                                                                  23050032
233900     EVALUATE TRUE                                                23060032
234000         WHEN SQLCODE = ZERO                                      23070032
234100              IF PV-SHIPMT-TRIP-ID-NULL = PC-NEG-1                23080032
234200                  MOVE ZEROS     TO SHIPMT-TRIP-ID                23090032
234300              END-IF                                              23100032
234400              PERFORM 4600-SELECT-VHTRIP                          23110032
234500              PERFORM 4700-READ-PURCHS-TABLE                      23120032
234600         WHEN SQLCODE = +100                                      23130032
234700             SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                  23140032
234800                                                                  23150032
234900         WHEN SQLWARN0 NOT EQUAL SPACE                            23160032
235000         WHEN SQLCODE  NOT EQUAL ZERO                             23170032
235100              MOVE '4385-FETCH-OPER-DEPT-CURSOR'                  23180032
235200                                 TO DP013-PARAGRAPH               23190032
235300              MOVE 'FETCH OPER-DEPT CURSOR'                       23200032
235400                                 TO DP013-MESSAGE-TEXT (1)        23210032
235500              MOVE SQLCA         TO DP013-SQLCA                   23220032
235600              SET DP013-DB2-ABEND                                 23230032
235700                                 TO TRUE                          23240032
235800              PERFORM DP013-0000-PROCESS-ABEND                    23250032
235900     END-EVALUATE.                                                23260032
236000                                                                  23270032
236100                                                                  23280032
236200 4387-FETCH-PRO-SCAC-CURSOR.                                      23290032
236300                                                                  23300032
236400     EXEC SQL                                                     23310032
236500          FETCH  PRO-SCAC                                         23320032
236600           INTO :SHIPMT-TRIP-ID :PV-SHIPMT-TRIP-ID-NULL,          23330032
236700                :SHIPMT-SHIPT-ID,                                 23340032
236800                :SHIPMT-PRO-NBR,                                  23350032
236900                :SHIPMT-PRO-SCAC-ID,                              23360032
237000*               :SHIPMT-SHIPPER-NME,                              23370032
237100                :TRIPST-OPER-UNT-ID,                              23380032
237200                :TRIPST-FCLTY-ID,                                 23390032
237300                :SHIPST-STATUS-DTE,                               23400032
237400                :SHSTYP-PRTY-CDE,                                 23410032
237500                :SHIPMT-EST-AR-TMST                               23420032
237600     END-EXEC.                                                    23430032
237700                                                                  23440032
237800     EVALUATE TRUE                                                23450032
237900         WHEN SQLCODE = ZERO                                      23460032
238000              IF PV-SHIPMT-TRIP-ID-NULL = PC-NEG-1                23470032
238100                  MOVE ZEROS     TO SHIPMT-TRIP-ID                23480032
238200              END-IF                                              23490032
238300              PERFORM 4600-SELECT-VHTRIP                          23500032
238400              PERFORM 4900-PROCESS-SHPTPO                         23510032
238500              SET PS-DATA-HAS-BEEN-MOVED TO TRUE                  23520032
238600         WHEN SQLCODE = +100                                      23530032
238700             SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                  23540032
238800                                                                  23550032
238900         WHEN SQLWARN0 NOT EQUAL SPACE                            23560032
239000         WHEN SQLCODE  NOT EQUAL ZERO                             23570032
239100              MOVE '4387-FETCH-PRO-SCAC-CURSOR'                   23580032
239200                                 TO DP013-PARAGRAPH               23590032
239300              MOVE 'FETCH PRO SCAC CURSOR'                        23600032
239400                                 TO DP013-MESSAGE-TEXT (1)        23610032
239500              MOVE SQLCA         TO DP013-SQLCA                   23620032
239600              SET DP013-DB2-ABEND                                 23630032
239700                                 TO TRUE                          23640032
239800              PERFORM DP013-0000-PROCESS-ABEND                    23650032
239900     END-EVALUATE.                                                23660032
240000                                                                  23670032
240100                                                                  23680032
240200 4389-FETCH-OPER-PRO-SCAC-CSR.                                    23690032
240300                                                                  23700032
240400     EXEC SQL                                                     23710032
240500          FETCH  OPER-PRO-SCAC                                    23720032
240600           INTO :SHIPMT-TRIP-ID :PV-SHIPMT-TRIP-ID-NULL,          23730032
240700                :SHIPMT-SHIPT-ID,                                 23740032
240800                :SHIPMT-PRO-NBR,                                  23750032
240900                :SHIPMT-PRO-SCAC-ID,                              23760032
241000*               :SHIPMT-SHIPPER-NME,                              23770032
241100                :TRIPST-OPER-UNT-ID,                              23780032
241200                :TRIPST-FCLTY-ID,                                 23790032
241300                :SHIPST-STATUS-DTE,                               23800032
241400                :SHSTYP-PRTY-CDE,                                 23810032
241500                :SHIPMT-EST-AR-TMST                               23820032
241600     END-EXEC.                                                    23830032
241700                                                                  23840032
241800     EVALUATE TRUE                                                23850032
241900         WHEN SQLCODE = ZERO                                      23860032
242000              IF PV-SHIPMT-TRIP-ID-NULL = PC-NEG-1                23870032
242100                  MOVE ZEROS     TO SHIPMT-TRIP-ID                23880032
242200              END-IF                                              23890032
242300              PERFORM 4600-SELECT-VHTRIP                          23900032
242400              PERFORM 4900-PROCESS-SHPTPO                         23910032
242500              SET PS-DATA-HAS-BEEN-MOVED TO TRUE                  23920032
242600         WHEN SQLCODE = +100                                      23930032
242700             SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                  23940032
242800                                                                  23950032
242900         WHEN SQLWARN0 NOT EQUAL SPACE                            23960032
243000         WHEN SQLCODE  NOT EQUAL ZERO                             23970032
243100              MOVE '4389-FETCH-OPER-PRO-SCAC-CSR'                 23980032
243200                                 TO DP013-PARAGRAPH               23990032
243300              MOVE 'FETCH OPER-PRO-SCAC CURSOR'                   24000032
243400                                 TO DP013-MESSAGE-TEXT (1)        24010032
243500              MOVE SQLCA         TO DP013-SQLCA                   24020032
243600              SET DP013-DB2-ABEND                                 24030032
243700                                 TO TRUE                          24040032
243800              PERFORM DP013-0000-PROCESS-ABEND                    24050032
243900     END-EVALUATE.                                                24060032
244000                                                                  24070032
244100 EJECT                                                            24080032
244200*----------------------------------------------------------------*24090032
244300*    GET THE CORRECT SUBSCRIPTS FOR PLACING THE TEXT LINE.       *24100032
244400*----------------------------------------------------------------*24110032
244500                                                                  24120032
244600 4390-GET-SUB.                                                    24130032
244700                                                                  24140032
244800     IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                        24150032
244900         ADD +1            TO  ASC-ITEM-SUB                       24160032
245000     ELSE                                                         24170032
245100         ADD +1            TO  ASC-BLK-SUB                        24180032
245200         MOVE +1           TO  ASC-ITEM-SUB                       24190032
245300                                                                  24200032
245400         IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY                 24210032
245500             MOVE +1       TO  ASC-BLK-SUB                        24220032
245600             PERFORM 5100-WRITE-TEMP-STORAGE                      24230032
245700             MOVE ASC-BLOCK-ENTRIES                               24240032
245800                       (PC-MAX-BLOCKS-IN-ARRAY)                   24250032
245900             TO   ASC-BLOCK-ENTRIES(ASC-BLK-SUB)                  24260032
246000             ADD +1        TO  ASC-BLK-SUB                        24270032
246100             INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)           24280032
246200         END-IF                                                   24290032
246300     END-IF.                                                      24300032
246400                                                                  24310032
246500     ADD +1            TO ASC-NUMBER-OF-ITEMS-READ.               24320032
246600     MOVE ASC-NUMBER-OF-ITEMS-READ TO ASC-LIST-ITEM-NUMBER        24330032
246700                                      (ASC-BLK-SUB                24340032
246800                                       ASC-ITEM-SUB).             24350032
246900                                                                  24360032
247000 4395-MOVE-DATA-TO-ASC.                                           24370032
247100     MOVE PURCHS-DEPT-NBR        TO ASC-DEPT-N                    24380060
247200                                   (ASC-BLK-SUB                   24390032
247300                                    ASC-ITEM-SUB).                24400032
247400                                                                  24410032
247500     MOVE SHPTPO-PO-NBR          TO ASC-PO-NBR                    24420032
247600                                   (ASC-BLK-SUB                   24430032
247700                                    ASC-ITEM-SUB).                24440032
247800                                                                  24450032
247900     IF SHIPMT-SHIPPER-NME = LOW-VALUES                           24460032
247910         MOVE SPACES                 TO ASC-SHIPPER-NME           24470032
248000                                       (ASC-BLK-SUB               24480032
248100                                        ASC-ITEM-SUB)             24490032
248101     ELSE                                                         24500032
248110         MOVE SHIPMT-SHIPPER-NME     TO ASC-SHIPPER-NME           24510032
248120                                       (ASC-BLK-SUB               24520032
248130                                        ASC-ITEM-SUB)             24530032
248140     END-IF.                                                      24540032
248200                                                                  24550032
248300     MOVE PV-P                   TO ASC-P                         24560032
248400                                   (ASC-BLK-SUB                   24570032
248500                                    ASC-ITEM-SUB).                24580032
248600     IF SHIPMT-PRO-SCAC-ID > SPACES                               24590032
248700         MOVE SHIPMT-PRO-SCAC-ID TO ASC-SCAC-CDE                  24600032
248800                                   (ASC-BLK-SUB                   24610032
248900                                    ASC-ITEM-SUB)                 24620032
249000     END-IF.                                                      24630032
249100                                                                  24640032
249200     MOVE SHIPMT-PRO-NBR         TO ASC-PRO-NBR                   24650032
249300                                   (ASC-BLK-SUB                   24660032
249400                                    ASC-ITEM-SUB).                24670032
249500                                                                  24680032
249600     MOVE VHTRIP-OWNER-SCAC-ID   TO ASC-LINE                      24690032
249700                                   (ASC-BLK-SUB                   24700032
249800                                    ASC-ITEM-SUB).                24710032
249900                                                                  24720032
250000     MOVE SHIPMT-EST-AR-TMST     TO PV-TMST.                      24730032
250100     MOVE PV-TMST-MM             TO PV-MMDD-ETA-MM.               24740032
250200     MOVE '/'                    TO PV-MMDD-ETA-SLASH.            24750032
250300     MOVE PV-TMST-DD             TO PV-MMDD-ETA-DD.               24760032
250400     MOVE PV-MM-DD-ETA           TO ASC-ETA-DTE                   24770032
250500                                   (ASC-BLK-SUB                   24780032
250600                                    ASC-ITEM-SUB).                24790032
250700                                                                  24800032
250800                                                                  24810032
250900     IF TRIPST-OPER-UNT-ID > ZEROES OR                            24820032
251000        TRIPST-FCLTY-ID     > ZEROES                              24830032
251100         MOVE TRIPST-OPER-UNT-ID TO PV-OPER-UNT-ID                24840032
251200         MOVE TRIPST-FCLTY-ID    TO PV-FCLTY-ID                   24850032
251300         MOVE PV-OPER-UNIT-FCLTY TO ASC-OPER-UNIT-FCLTY           24860032
251400                                   (ASC-BLK-SUB                   24870032
251500                                    ASC-ITEM-SUB)                 24880032
251600     END-IF.                                                      24890032
251700                                                                  24900032
251800                                                                  24910032
251900     MOVE VHTRIP-VEH-NBR         TO ASC-VHCL-ID                   24920032
252000                                   (ASC-BLK-SUB                   24930032
252100                                    ASC-ITEM-SUB).                24940032
252200                                                                  24950032
252300*    MOVE PV-UNION-IND           TO ASC-UNION-IND                 24960032
252400*                                  (ASC-BLK-SUB                   24970032
252500*                                   ASC-ITEM-SUB).                24980032
252600*----------------------------------------------------------------*24990032
252700*    FORMAT THE MAP AND DETERMINE THE CURSOR POSITION.           *25000032
252800*----------------------------------------------------------------*25010032
252900                                                                  25020032
253000 4400-MOVE-COMMAREA-TO-SCREEN.                                    25030032
253100                                                                  25040032
253200                                                                  25050032
253300     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             25060032
253400         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          25070032
253500         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          25080032
253600             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             25090032
253700                 GIVING PV-BLOCK-NUMBER                           25100032
253800                 REMAINDER PV-REMAINDER                           25110032
253900             IF  PV-REMAINDER > ZERO                              25120032
254000                 ADD +1 TO PV-BLOCK-NUMBER                        25130032
254100             END-IF                                               25140032
254200             MOVE +1    TO ASC-BLK-SUB                            25150032
254300             PERFORM 4410-READ-TEMP-STORAGE                       25160032
254400             ADD +1     TO ASC-BLK-SUB                            25170032
254500                           PV-BLOCK-NUMBER                        25180032
254600             PERFORM 4410-READ-TEMP-STORAGE                       25190032
254700     END-IF.                                                      25200032
254800     MOVE +1                       TO ASC-BLK-SUB.                25210032
254900     COMPUTE ASC-ITEM-SUB =                                       25220032
255000         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              25230032
255100         + PC-ITEMS-PER-PANEL).                                   25240032
255200                                                                  25250032
255300     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        25260032
255400         ADD +1   TO ASC-BLK-SUB                                  25270032
255500         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            25280032
255600     END-IF.                                                      25290032
255700                                                                  25300032
255800     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           25310032
255900         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                25320032
256000     PERFORM 4420-FORMAT-LIST-LINES                               25330032
256100         VARYING PS-SUB                                           25340032
256200         FROM PC-ITEMS-PER-PANEL BY -1                            25350032
256300         UNTIL PS-SUB < +1.                                       25360032
256400                                                                  25370032
256500     COMPUTE ASC-ITEMS-DISPLAYED =                                25380032
256600         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          25390032
256700     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    25400032
256800                                      ASTRTITO.                   25410032
256900     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    25420032
257000     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    25430032
257100                                                                  25440032
257200     IF  DP020-MSG-NUMBER-X = SPACE                               25450032
257300         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  25460032
257400*            --- MORE ITEMS TO DISPLAY ----                       25470032
257500             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            25480032
257600             SET DP020-MSG-INFORMATIONAL TO TRUE                  25490032
257700         END-IF                                                   25500032
257800     END-IF.                                                      25510032
257900                                                                  25520032
258000*----------------------------------------------------------------*25530032
258100*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *25540032
258200*----------------------------------------------------------------*25550032
258300                                                                  25560032
258400 4410-READ-TEMP-STORAGE.                                          25570032
258500                                                                  25580032
258600     EXEC CICS                                                    25590032
258700         READQ TS                                                 25600032
258800             QUEUE (ASC-DTL-QUEUE-NAME)                           25610032
258900             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               25620032
259000             ITEM  (PV-BLOCK-NUMBER)                              25630032
259100             RESP  (PV-CICS-RESP)                                 25640032
259200     END-EXEC.                                                    25650032
259300                                                                  25660032
259400     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       25670032
259500       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     25680032
259600         CONTINUE                                                 25690032
259700     ELSE                                                         25700032
259800         SET DP013-CICS-ABEND TO  TRUE                            25710032
259900         SET DP013-NO-ROLLBACK TO  TRUE                           25720032
260000         MOVE '4410-READ-TEMP-STORAGE'                            25730032
260100                               TO  DP013-PARAGRAPH                25740032
260200         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      25750032
260300                               TO  DP013-MESSAGE-TEXT(1)          25760032
260400         PERFORM DP013-0000-PROCESS-ABEND                         25770032
260500     END-IF.                                                      25780032
260600                                                                  25790032
260700*    SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             25800032
260800                                                                  25810032
260900     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         25820032
261000         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               25830032
261100     END-IF.                                                      25840032
261200 EJECT                                                            25850032
261300*----------------------------------------------------------------*25860032
261400*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *25870032
261500*----------------------------------------------------------------*25880032
261600                                                                  25890032
261700 4420-FORMAT-LIST-LINES.                                          25900032
261800                                                                  25910032
261900     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      25920032
262000         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                25930032
262100         MOVE SPACE              TO MR-DEPT              (PS-SUB) 25940059
262200                                    MR-PO-X              (PS-SUB) 25950059
262300                                    MR-SHIPPER           (PS-SUB) 25960032
262400                                    MR-P                 (PS-SUB) 25970032
262500                                    MR-SCAC              (PS-SUB) 25980032
262600                                    MR-PRO               (PS-SUB) 25990032
262700                                    MR-LINE              (PS-SUB) 26000032
262800                                    MR-ETA               (PS-SUB) 26010032
262900                                    MR-VEHICL            (PS-SUB) 26020032
263000                                    MR-OPER-FCLTY        (PS-SUB) 26030032
263100     ELSE                                                         26040032
263200         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           26050032
263300             MOVE ASC-DEPT-N        (ASC-BLK-SUB ASC-ITEM-SUB)    26060054
263400                                 TO MR-DEPT              (PS-SUB) 26070032
263500                                                                  26080032
263600             IF ASC-PO-NBR (ASC-BLK-SUB ASC-ITEM-SUB) = ZERO      26090032
263700                 MOVE SPACES      TO MR-PO-X              (PS-SUB)26100032
263800             ELSE                                                 26110032
263900                 MOVE ASC-PO-NBR    (ASC-BLK-SUB ASC-ITEM-SUB)    26120032
264000                                 TO MR-PO                (PS-SUB) 26130032
264100             END-IF                                               26140032
264200                                                                  26150032
264300             MOVE ASC-SHIPPER-NME (ASC-BLK-SUB ASC-ITEM-SUB)      26160032
264400                                 TO MR-SHIPPER           (PS-SUB) 26170032
264500                                                                  26180032
264600             MOVE ASC-P             (ASC-BLK-SUB ASC-ITEM-SUB)    26190032
264700                                 TO MR-P                 (PS-SUB) 26200032
264800                                                                  26210032
264900             MOVE ASC-SCAC-CDE      (ASC-BLK-SUB ASC-ITEM-SUB)    26220032
265000                                 TO MR-SCAC              (PS-SUB) 26230032
265100                                                                  26240032
265200             MOVE ASC-PRO-NBR       (ASC-BLK-SUB ASC-ITEM-SUB)    26250032
265300                                 TO MR-PRO               (PS-SUB) 26260032
265400                                                                  26270032
265500             MOVE ASC-LINE          (ASC-BLK-SUB ASC-ITEM-SUB)    26280032
265600                                 TO MR-LINE              (PS-SUB) 26290032
265700                                                                  26300032
265800             MOVE ASC-ETA-DTE       (ASC-BLK-SUB ASC-ITEM-SUB)    26310032
265900                                 TO MR-ETA               (PS-SUB) 26320032
266000                                                                  26330032
266100             MOVE ASC-VHCL-ID       (ASC-BLK-SUB ASC-ITEM-SUB)    26340032
266200                                 TO MR-VEHICL            (PS-SUB) 26350032
266300                                                                  26360032
266400             MOVE ASC-OPER-UNIT-FCLTY                             26370032
266500                (ASC-BLK-SUB ASC-ITEM-SUB)                        26380032
266600                                 TO MR-OPER-FCLTY (PS-SUB)        26390032
266700         END-IF                                                   26400032
266800     END-IF.                                                      26410032
266900     SUBTRACT +1 FROM ASC-ITEM-SUB.                               26420032
267000     IF  ASC-ITEM-SUB < + 1                                       26430032
267100         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  26440032
267200         MOVE +1                 TO ASC-BLK-SUB                   26450032
267300     END-IF.                                                      26460032
267400                                                                  26470032
267500                                                                  26480032
267600*---------------------------------------------------------------* 26490032
267700*    JOIN THE VHTRIP AND TRIPST IN ORDER TO SELECT THE VEHICLE  * 26500032
267800*    NUMBER AND OPERATING UNIT/FACILTY                          * 26510032
267900*---------------------------------------------------------------* 26520032
268000                                                                  26530032
268100 4600-SELECT-VHTRIP.                                              26540032
268200                                                                  26550032
268300     PERFORM                                                      26560032
268400         WITH TEST AFTER                                          26570032
268500         VARYING PV-SQL-SUB                                       26580032
268600         FROM 1 BY 1                                              26590032
268700         UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES             26600032
268800            OR SQLCODE = 0                                        26610032
268900            OR SQLCODE = +100                                     26620032
269000                                                                  26630032
269100         EXEC SQL                                                 26640032
269200               SELECT  A.VEH_NBR,                                 26650032
269300                       A.OWNER_SCAC_ID,                           26660032
269400                       B.OPER_UNT_ID,                             26670032
269500                       B.FCLTY_ID                                 26680032
269600                 INTO  :VHTRIP-VEH-NBR :PV-VHTRIP-VEH-NBR-NULL,   26690032
269700                       :VHTRIP-OWNER-SCAC-ID,                     26700032
269800                       :TRIPST-OPER-UNT-ID,                       26710032
269900                       :TRIPST-FCLTY-ID                           26720032
270000                 FROM  TVHTRIP A,                                 26730032
270100                       TTRIPST B,                                 26740032
270200                       TTRSTYP C                                  26750032
270300                WHERE  A.TRIP_ID         = :SHIPMT-TRIP-ID        26760032
270400                  AND  B.TRIP_ID         = :SHIPMT-TRIP-ID        26770032
270500                  AND  B.TRIP_STATUS_CDE = C.TRIP_STATUS_CDE      26780032
270600                  AND  C.PRTY_CDE        < :PC-DELETED            26790032
270700                  AND  C.PRTY_CDE =                               26800032
270800                       (SELECT MAX (E.PRTY_CDE)                   26810032
270900                          FROM TTRIPST D,                         26820032
271000                               TTRSTYP E                          26830032
271100                         WHERE D.TRIP_ID = A.TRIP_ID              26840032
271200                           AND D.TRIP_STATUS_CDE =                26850032
271300                               E.TRIP_STATUS_CDE)                 26860032
271400         END-EXEC                                                 26870032
271500                                                                  26880032
271600         EVALUATE TRUE                                            26890032
271700             WHEN SQLCODE = ZERO                                  26900032
271800              IF PV-VHTRIP-VEH-NBR-NULL = PC-NEG-1                26910032
271900                  MOVE SPACES    TO VHTRIP-VEH-NBR                26920032
272000              END-IF                                              26930032
272100*!               MOVE TRIPST-OPER-UNT-ID                          26940032
272200*!                               TO VHTRIP-OPER-UNT-ID            26950032
272300*!               MOVE TRIPST-FCLTY-ID                             26960032
272400*!                               TO VHTRIP-FCLTY-ID               26970032
272500             WHEN SQLCODE = +100                                  26980032
272600             WHEN SQLCODE = -913                                  26990032
272700             WHEN SQLCODE = -904                                  27000032
272800                  CONTINUE                                        27010032
272900                                                                  27020032
273000             WHEN SQLWARN0 NOT EQUAL SPACE                        27030032
273100             WHEN SQLCODE  NOT EQUAL ZERO                         27040032
273200                  MOVE '4600-SELECT-VEHICL'                       27050032
273300                                 TO DP013-PARAGRAPH               27060032
273400                  MOVE 'DB2 ERROR WHILE SELECTING VEHICL'         27070032
273500                                 TO DP013-MESSAGE-TEXT (1)        27080032
273600                  MOVE SQLCA     TO DP013-SQLCA                   27090032
273700                  SET DP013-DB2-ABEND                             27100032
273800                                 TO TRUE                          27110032
273900                  PERFORM DP013-0000-PROCESS-ABEND                27120032
274000         END-EVALUATE                                             27130032
274100     END-PERFORM.                                                 27140032
274200                                                                  27150032
274300     IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES AND               27160032
274400         SQLCODE NOT = 0                                          27170032
274500         MOVE '4600-SELECT-VEHICL'                                27180032
274600                                 TO DP013-PARAGRAPH               27190032
274700         MOVE 'MAX RETRIES EXCEEDED FOR SELECT'                   27200032
274800                                 TO DP013-MESSAGE-TEXT (1)        27210032
274900         MOVE SQLCA              TO DP013-SQLCA                   27220032
275000         SET DP013-DB2-ABEND     TO TRUE                          27230032
275100         PERFORM DP013-0000-PROCESS-ABEND                         27240032
275200     END-IF.                                                      27250032
275500/                                                                 27260032
275600*----------------------------------------------------------------*27270032
275700*    KEY READ FOR A SPECIFIC PURCHASE ORDER NUMBER.              *27280032
275800*----------------------------------------------------------------*27290032
275900 4700-READ-PURCHS-TABLE.                                          27300032
276200     PERFORM                                                      27310032
276300         WITH TEST AFTER                                          27320032
276400         VARYING PV-SQL-SUB                                       27330032
276500         FROM 1 BY 1                                              27340032
276600         UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES             27350032
276700            OR SQLCODE = 0                                        27360032
276800            OR SQLCODE = +100                                     27370032
276900                                                                  27380032
277000         EXEC SQL                                                 27390032
277100               SELECT  A.PO_NBR,                                  27400032
277200                       A.STATUS_CDE,                              27410032
277210                       A.ENT_ID,                                  27420032
277300                       B.DONT_SHIP_BEF_DTE,                       27430032
277400                       B.CAN_IFNOT_SHIP_DTE,                      27440032
277500                       B.EXT_CAN_DTE                              27450032
277600                 INTO  :PURCHS-PO-NBR,                            27460032
277700                       :PURCHS-STATUS-CDE,                        27470032
277710                       :PURCHS-ENT-ID,                            27480032
277800                       :PLNSHP-DONT-SHIP-BEF-DTE,                 27490032
277900                       :PLNSHP-CAN-IFNOT-SHIP-DTE,                27500032
278000                       :PLNSHP-EXT-CAN-DTE                        27510032
278100                 FROM  TPURCHS A,                                 27520032
278200                       TPLNSHP B                                  27530032
278300                WHERE  A.PO_NBR         = :SHPTPO-PO-NBR          27540032
278400                  AND  B.PO_NBR         = :SHPTPO-PO-NBR          27550032
278500                  AND  A.VER_STATUS_CDE = :PC-ACTIVE              27560032
278600                  AND  B.VER_STATUS_CDE = :PC-ACTIVE              27570032
278700         END-EXEC                                                 27580032
278800                                                                  27590032
278900         EVALUATE TRUE                                            27600032
279100             WHEN SQLCODE = ZERO                                  27610032
279110                  MOVE PURCHS-ENT-ID  TO PV-VEND-NBR              27620032
279120                  PERFORM 4800-SELECT-VDR-NAME                    27630032
279130             WHEN SQLCODE = +100                                  27640032
279131                  MOVE SHPTPO-VEND-NAME     TO SHIPMT-SHIPPER-NME 27650032
279200             WHEN SQLCODE = -913                                  27660032
279300             WHEN SQLCODE = -904                                  27670032
279400                  CONTINUE                                        27680032
279500                                                                  27690032
279600             WHEN SQLWARN0 NOT EQUAL SPACE                        27700032
279700             WHEN SQLCODE  NOT EQUAL ZERO                         27710032
279800                  MOVE '4700-READ-PO-DB'                          27720032
279900                                 TO DP013-PARAGRAPH               27730032
280000                  MOVE 'DB2 ERROR WHILE SELECTING TPURCHS'        27740032
280100                                 TO DP013-MESSAGE-TEXT (1)        27750032
280200                  MOVE SHPTPO-PO-NBR                              27760032
280300                                 TO DP013-MESSAGE-TEXT (2)        27770032
280400                  MOVE SQLCA     TO DP013-SQLCA                   27780032
280500                  SET DP013-DB2-ABEND                             27790032
280600                                 TO TRUE                          27800032
280700                  PERFORM DP013-0000-PROCESS-ABEND                27810032
280800         END-EVALUATE                                             27820032
280900     END-PERFORM.                                                 27830032
281000                                                                  27840032
281100     IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES AND               27850032
281200         SQLCODE NOT = 0                                          27860032
281300         MOVE '4700-READ-PO-DB'  TO DP013-PARAGRAPH               27870032
281400         MOVE 'MAX RETRIES EXCEEDED FOR SELECT'                   27880032
281500                                 TO DP013-MESSAGE-TEXT (1)        27890032
281600         MOVE SQLCA              TO DP013-SQLCA                   27900032
281700         SET DP013-DB2-ABEND     TO TRUE                          27910032
281800         PERFORM DP013-0000-PROCESS-ABEND                         27920032
281900     END-IF.                                                      27930032
282000                                                                  27940032
282100     IF SQLCODE = 0                                               27950032
282200         IF PURCHS-STATUS-CDE = PC-CANCELLED                      27960032
282300             MOVE PC-C           TO PV-P                          27970032
282400         ELSE                                                     27980032
282500             MOVE PURCHS-STATUS-CDE                               27990032
282600                                 TO PC-COMPLETE-VALUES            28000032
282700             IF PC-COMPLETE                                       28010032
282800                 PERFORM 4730-SELECT-PICKED-UP-DATE               28020032
282900                 IF SQLCODE = ZERO                                28030032
283000                    PERFORM 4760-SETUP-WINDOW-DT                  28040032
283100                 ELSE                                             28050032
283200                    MOVE SPACES  TO PV-P                          28060032
283300                 END-IF                                           28070032
283400             ELSE                                                 28080032
283500                 MOVE PC-I       TO PV-P                          28090032
283600             END-IF                                               28100032
283700         END-IF                                                   28110032
283800     ELSE                                                         28120032
283900         MOVE PC-U               TO PV-P                          28130032
284000     END-IF.                                                      28140032
284100                                                                  28150032
284200*----------------------------------------------------------------*28160032
284300*    RETRIEVE THE PICKED UP STATUS 'AF' FROM TSHIPST TABLE        28170032
284400*----------------------------------------------------------------*28180032
284500                                                                  28190032
284600 4730-SELECT-PICKED-UP-DATE.                                      28200032
284700                                                                  28210032
284800     PERFORM                                                      28220032
284900         WITH TEST AFTER                                          28230032
285000         VARYING PV-SQL-SUB                                       28240032
285100         FROM 1 BY 1                                              28250032
285200         UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES             28260032
285300            OR SQLCODE = 0                                        28270032
285400            OR SQLCODE = +100                                     28280032
285500                                                                  28290032
285600         EXEC SQL                                                 28300032
285700             SELECT STATUS_DTE                                    28310032
285800               INTO :PV-SHIPST-PICKED-UP                          28320032
285900               FROM TSHIPST                                       28330032
286000              WHERE SHIPT_ID         = :SHIPMT-SHIPT-ID           28340032
286100                AND SHIPT_STATUS_CDE = :PC-AF                     28350032
286200         END-EXEC                                                 28360032
286300                                                                  28370032
286400         EVALUATE TRUE                                            28380032
286500             WHEN SQLCODE = ZERO                                  28390032
286600             WHEN SQLCODE = +100                                  28400032
286700             WHEN SQLCODE = -913                                  28410032
286800             WHEN SQLCODE = -904                                  28420032
286900                  CONTINUE                                        28430032
287000                                                                  28440032
287100             WHEN SQLWARN0 NOT EQUAL SPACE                        28450032
287200             WHEN SQLCODE  NOT EQUAL ZERO                         28460032
287300                  MOVE '4730-SELECT-PICKED-UP-DATE'               28470032
287400                                 TO DP013-PARAGRAPH               28480032
287500                  MOVE 'SELECT PICK UP DATE'                      28490032
287600                                 TO DP013-MESSAGE-TEXT (1)        28500032
287700                  MOVE SQLCA     TO DP013-SQLCA                   28510032
287800                  SET DP013-DB2-ABEND                             28520032
287900                                 TO TRUE                          28530032
288000                  PERFORM DP013-0000-PROCESS-ABEND                28540032
288100         END-EVALUATE                                             28550032
288200     END-PERFORM.                                                 28560032
288300                                                                  28570032
288400     IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES AND               28580032
288500         SQLCODE NOT = 0                                          28590032
288600         MOVE '4730-SELECT-PICKED-UP-DATE'                        28600032
288700                                 TO DP013-PARAGRAPH               28610032
288800         MOVE 'MAX RETRIES EXCEEDED FOR SELECT ON TSHIPST'        28620032
288900                                 TO DP013-MESSAGE-TEXT (1)        28630032
289000         MOVE SQLCA              TO DP013-SQLCA                   28640032
289100         SET DP013-DB2-ABEND     TO TRUE                          28650032
289200         PERFORM DP013-0000-PROCESS-ABEND                         28660032
289300     END-IF.                                                      28670032
289500     EJECT                                                        28680032
289600*----------------------------------------------------------------*28690032
289700*    SETUP THE PURCHASE ORDER SHIPPED AND CANCEL DATES IN THE     28700032
289800*    SAME FORMAT AS THE ATA DATE.                                 28710032
289900*----------------------------------------------------------------*28720032
290000                                                                  28730032
290100 4760-SETUP-WINDOW-DT.                                            28740032
290200                                                                  28750032
290300     MOVE PLNSHP-DONT-SHIP-BEF-DTE                                28760032
290400                                 TO PV-WINDOW-LOW-DATE.           28770032
290500                                                                  28780032
290600     IF PLNSHP-EXT-CAN-DTE NOT = PC-DEFAULT-DATE                  28790032
290700         MOVE PLNSHP-EXT-CAN-DTE TO PV-WINDOW-HIGH-DATE           28800032
290800     ELSE                                                         28810032
290900         MOVE PLNSHP-CAN-IFNOT-SHIP-DTE                           28820032
291000                                 TO PV-WINDOW-HIGH-DATE           28830032
291100     END-IF.                                                      28840032
291200                                                                  28850032
291300     EVALUATE TRUE                                                28860032
291400         WHEN PV-SHIPST-PICKED-UP < PV-WINDOW-LOW-DATE            28870032
291500             MOVE PC-E           TO PV-P                          28880032
291600                                                                  28890032
291700         WHEN PV-SHIPST-PICKED-UP > PV-WINDOW-HIGH-DATE           28900032
291800             MOVE PC-L           TO PV-P                          28910032
291900                                                                  28920032
292000         WHEN OTHER                                               28930032
292100             MOVE SPACES         TO PV-P                          28940032
292200     END-EVALUATE.                                                28950032
292300                                                                  28960032
292301     EJECT                                                        28970032
292302*----------------------------------------------------------------*28980032
292303*    SELECT THE VENDOR ROW                                       *28990032
292304*----------------------------------------------------------------*29000032
292307 4800-SELECT-VDR-NAME.                                            29010032
292308     EXEC SQL                                                     29020032
292309          SELECT                                                  29030032
292310                ENT_NAME_DESC                                     29040032
292311          INTO                                                    29050032
292313               :ENTNME-ENT-NAME-DESC                              29060032
292315          FROM                                                    29070032
292316                TENTNME                                           29080032
292317          WHERE                                                   29090032
292318                ENT_ID = :PV-VEND-NBR AND                         29100032
292319                TYPE_CDE = '04'                                   29110032
292320     END-EXEC.                                                    29120032
292321                                                                  29130032
292322     EVALUATE TRUE                                                29140032
292323        WHEN SQLCODE = ZERO                                       29150032
292324             MOVE ENTNME-ENT-NAME-DESC TO SHIPMT-SHIPPER-NME      29160032
292325        WHEN SQLCODE = -904                                       29170032
292326        WHEN SQLCODE = -913                                       29180032
292327             CONTINUE                                             29190032
292328        WHEN SQLCODE = +100                                       29200032
292329             MOVE 'MISING'             TO SHIPMT-SHIPPER-NME      29210032
292333        WHEN SQLWARN0 NOT EQUAL SPACE                             29220032
292334        WHEN SQLCODE  NOT EQUAL ZERO                              29230032
292335            MOVE '4800-SELECT-VDR-NAME  '                         29231032
292336                               TO  DP013-PARAGRAPH                29232032
292337            MOVE 'EXTERNAL NAME TABLE'                            29233032
292338                               TO  DP013-MESSAGE-TEXT (1)         29233132
292339            MOVE SQLCA          TO DP013-SQLCA                    29233232
292340            SET PS-ERROR        TO TRUE                           29233332
292341            SET DP013-DB2-ABEND TO TRUE                           29233432
292342            PERFORM DP013-0000-PROCESS-ABEND                      29233532
292350     END-EVALUATE.                                                29233632
292360/                                                                 29233732
292400*----------------------------------------------------------------*29233832
292500*    READ ALL PURCHASE ORDERS FOR A SHIPMENT.  GO AGAINST THE    *29233932
292600*    PURCHASE ORDER DATABASE TO CHECK THE CANCELLED DATES.       *29234032
292700*----------------------------------------------------------------*29235032
292800                                                                  29236032
292900 4900-PROCESS-SHPTPO.                                             29237032
293000                                                                  29238032
293100     PERFORM 4930-OPEN-SHPTPO-CSR.                                29239032
293200     PERFORM 4960-FETCH-SHPTPO-CSR.                               29240032
293400                                                                  29250032
293500     PERFORM UNTIL PS-END-OF-SHPTPO-CSR                           29260032
293600         PERFORM 4700-READ-PURCHS-TABLE                           29270032
293700         PERFORM 4390-GET-SUB                                     29280032
293800         PERFORM 4395-MOVE-DATA-TO-ASC                            29290032
293900         PERFORM 4960-FETCH-SHPTPO-CSR                            29300032
294000     END-PERFORM.                                                 29310032
294100                                                                  29320032
294200     PERFORM 4990-CLOSE-SHPTPO-CSR.                               29330032
294300                                                                  29340032
294400*----------------------------------------------------------------*29350032
294500*    OPEN THE CURSOR FOR PROCESSING THE SHPTPO DATABASE          *29360032
294600*----------------------------------------------------------------*29370032
294700                                                                  29380032
294800 4930-OPEN-SHPTPO-CSR.                                            29390032
294900                                                                  29400032
295000     PERFORM                                                      29410032
295100         WITH TEST AFTER                                          29420032
295200         VARYING PV-SQL-SUB                                       29430032
295300         FROM 1 BY 1                                              29440032
295400         UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES             29450032
295500            OR SQLCODE = 0                                        29460032
295600            OR SQLCODE = +100                                     29470032
295700                                                                  29480032
295800         EXEC SQL                                                 29490032
295900              OPEN SHPTPO-CSR                                     29500032
296000         END-EXEC                                                 29510032
296100                                                                  29520032
296200         EVALUATE TRUE                                            29530032
296300             WHEN SQLCODE = ZERO                                  29540032
296400                  SET PS-NOT-END-OF-SHPTPO-CSR                    29550032
296500                                 TO TRUE                          29560032
296600             WHEN SQLCODE = +100                                  29570032
296700             WHEN SQLCODE = -913                                  29580032
296800             WHEN SQLCODE = -904                                  29590032
296900                  CONTINUE                                        29600032
297000                                                                  29610032
297100             WHEN SQLWARN0 NOT EQUAL SPACE                        29620032
297200             WHEN SQLCODE  NOT EQUAL ZERO                         29630032
297300                  MOVE '4930-OPEN-SHPTPO-CSR'                     29640032
297400                                 TO DP013-PARAGRAPH               29650032
297500                  MOVE 'OPEN SHPTPO CURSOR'                       29660032
297600                                 TO DP013-MESSAGE-TEXT (1)        29670032
297700                  MOVE SQLCA     TO DP013-SQLCA                   29680032
297800                  SET DP013-DB2-ABEND                             29690032
297900                                 TO TRUE                          29700032
298000                  PERFORM DP013-0000-PROCESS-ABEND                29710032
298100         END-EVALUATE                                             29720032
298200     END-PERFORM.                                                 29730032
298300                                                                  29740032
298400     IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES AND               29750032
298500         SQLCODE NOT = 0                                          29760032
298600         MOVE '4930-OPEN-SHPTPO-CSR'                              29770032
298700                                 TO DP013-PARAGRAPH               29780032
298800         MOVE 'MAX RETRIES EXCEEDED FOR OPEN CURSOR'              29790032
298900                                 TO DP013-MESSAGE-TEXT (1)        29800032
299000         MOVE SQLCA              TO DP013-SQLCA                   29810032
299100         SET DP013-DB2-ABEND     TO TRUE                          29820032
299200         PERFORM DP013-0000-PROCESS-ABEND                         29830032
299300     END-IF.                                                      29840032
299400                                                                  29850032
299500 EJECT                                                            29860032
299600*----------------------------------------------------------------*29870032
299700*    OBTAIN THE PURCHASE ORDER FOR THE SHPTPO CURSOR             *29880032
299800*----------------------------------------------------------------*29890032
299900                                                                  29900032
300000 4960-FETCH-SHPTPO-CSR.                                           29910032
300100                                                                  29920032
300200     EXEC SQL                                                     29930032
300300          FETCH  SHPTPO-CSR                                       29940032
300400           INTO :SHPTPO-PO-NBR,                                   29950032
300510                :SHPTPO-VEND-NAME,                                29970037
300520                :PURCHS-DEPT-NBR                                  29971037
300600     END-EXEC.                                                    29980032
300700                                                                  29990032
300800     EVALUATE TRUE                                                30000032
300900         WHEN SQLCODE = ZERO                                      30010032
301000              CONTINUE                                            30020032
301100         WHEN SQLCODE = +100                                      30030032
301200             SET PS-END-OF-SHPTPO-CSR                             30040032
301300                                 TO TRUE                          30050032
301400                                                                  30060032
301500         WHEN SQLWARN0 NOT EQUAL SPACE                            30070032
301600         WHEN SQLCODE  NOT EQUAL ZERO                             30080032
301700              MOVE '4960-FETCH-SHPTPO-CSR'                        30090032
301800                                 TO DP013-PARAGRAPH               30100032
301900              MOVE 'FETCH SHPTPO CURSOR'                          30110032
302000                                 TO DP013-MESSAGE-TEXT (1)        30120032
302100              MOVE SQLCA         TO DP013-SQLCA                   30130032
302200              SET DP013-DB2-ABEND                                 30140032
302300                                 TO TRUE                          30150032
302400              PERFORM DP013-0000-PROCESS-ABEND                    30160032
302500     END-EVALUATE.                                                30170032
302600                                                                  30180032
302700*----------------------------------------------------------------*30190032
302800*    CLOSE THE SHPTPO CURSOR                                     *30200032
302900*----------------------------------------------------------------*30210032
303000                                                                  30220032
303100 4990-CLOSE-SHPTPO-CSR.                                           30230032
303200                                                                  30240032
303300     PERFORM                                                      30250032
303400         WITH TEST AFTER                                          30260032
303500         VARYING PV-SQL-SUB                                       30270032
303600         FROM 1 BY 1                                              30280032
303700         UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES             30290032
303800            OR SQLCODE = 0                                        30300032
303900            OR SQLCODE = +100                                     30310032
304000                                                                  30320032
304100         EXEC SQL                                                 30330032
304200              CLOSE SHPTPO-CSR                                    30340032
304300         END-EXEC                                                 30350032
304400                                                                  30360032
304500         EVALUATE TRUE                                            30370032
304600             WHEN SQLCODE = ZERO                                  30380032
304700             WHEN SQLCODE = +100                                  30390032
304800             WHEN SQLCODE = -913                                  30400032
304900             WHEN SQLCODE = -904                                  30410032
305000                  CONTINUE                                        30420032
305100                                                                  30430032
305200             WHEN SQLWARN0 NOT EQUAL SPACE                        30440032
305300             WHEN SQLCODE  NOT EQUAL ZERO                         30450032
305400                  MOVE '4990-CLOSE-SHPTPO-CSR'                    30460032
305500                                 TO DP013-PARAGRAPH               30470032
305600                  MOVE 'CLOSE SHPTPO CURSOR'                      30480032
305700                                 TO DP013-MESSAGE-TEXT (1)        30490032
305800                  MOVE SQLCA     TO DP013-SQLCA                   30500032
305900                  SET DP013-DB2-ABEND                             30510032
306000                                 TO TRUE                          30520032
306100                  PERFORM DP013-0000-PROCESS-ABEND                30530032
306200         END-EVALUATE                                             30540032
306300     END-PERFORM.                                                 30550032
306400                                                                  30560032
306500     IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES AND               30570032
306600         SQLCODE NOT = 0                                          30580032
306700         MOVE '4990-CLOSE-SHPTPO-CSR'                             30590032
306800                                 TO DP013-PARAGRAPH               30600032
306900         MOVE 'MAX RETRIES EXCEEDED FOR CLOSE CURSOR'             30610032
307000                                 TO DP013-MESSAGE-TEXT (1)        30620032
307100         MOVE SQLCA              TO DP013-SQLCA                   30630032
307200         SET DP013-DB2-ABEND     TO TRUE                          30640032
307300         PERFORM DP013-0000-PROCESS-ABEND                         30650032
307400     END-IF.                                                      30660032
307500                                                                  30670032
307600*----------------------------------------------------------------*30680032
307700*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *30690032
307800*----------------------------------------------------------------*30700032
307900                                                                  30710032
308000 5100-WRITE-TEMP-STORAGE.                                         30720032
308100                                                                  30730032
308200     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     30740032
308300                               TO  PV-LIST-ITEM-NUMBER.           30750032
308400     COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                           30760032
308500         ASC-HIGHEST-BLOCK-WRITTEN + 1.                           30770032
308600                                                                  30780032
308700     EXEC CICS                                                    30790032
308800         WRITEQ TS                                                30800032
308900             QUEUE (ASC-DTL-QUEUE-NAME)                           30810032
309000             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               30820032
309100             ITEM  (PV-HIGHEST-BLOCK-WRITTEN)                     30830032
309200             RESP  (PV-CICS-RESP)                                 30840032
309300     END-EXEC.                                                    30850032
309400                                                                  30860032
309500     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      30870032
309600         SET DP013-CICS-ABEND                                     30880032
309700                       TO  TRUE                                   30890032
309800         SET DP013-NO-ROLLBACK                                    30900032
309900                       TO  TRUE                                   30910032
310000         MOVE '5100-WRITE-TEMP-STORAGE'                           30920032
310100                       TO  DP013-PARAGRAPH                        30930032
310200         MOVE 'ATTEMPTING TO WRITE TEMP STORAGE LIST BLOCK'       30940032
310300                       TO  DP013-MESSAGE-TEXT(1)                  30950032
310400         PERFORM DP013-0000-PROCESS-ABEND                         30960032
310500     END-IF.                                                      30970032
310600     ADD +1            TO  ASC-HIGHEST-BLOCK-WRITTEN.             30980032
310700                                                                  30990032
310800 EJECT                                                            31000032
310900*----------------------------------------------------------------*31010032
311000* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *31020032
311100*----------------------------------------------------------------*31030032
311200                                                                  31040032
311300 9100-READ-SEL-QUEUE.                                             31050032
311400     EXEC CICS                                                    31060032
311500         READQ TS                                                 31070032
311600             QUEUE (ASC-SEL-QUEUE-NAME)                           31080032
311700             INTO  (DP057-MESSAGE-SEL-REC)                        31090032
311800             ITEM  (ASC-SEL-ITEM)                                 31100032
311900             RESP  (PV-CICS-RESP)                                 31110032
312000     END-EXEC.                                                    31120032
312100                                                                  31130032
312200     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       31140032
312300         CONTINUE                                                 31150032
312400     ELSE                                                         31160032
312500         SET DP013-LOGIC-ABEND                                    31170032
312600             DP013-NO-ROLLBACK     TO TRUE                        31180032
312700         MOVE '9100-READ-SEL-QUEUE'                               31190032
312800                                   TO DP013-PARAGRAPH             31200032
312900         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   31210032
313000                                   TO DP013-MESSAGE-TEXT (1)      31220032
313100         PERFORM DP013-0000-PROCESS-ABEND                         31230032
313200     END-IF.                                                      31240032
313300*----------------------------------------------------------------*31250032
313400* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *31260032
313500*----------------------------------------------------------------*31270032
313600 9200-REWRITE-SEL-QUEUE.                                          31280032
313700     EXEC CICS                                                    31290032
313800          WRITEQ TS                                               31300032
313900              QUEUE  (ASC-SEL-QUEUE-NAME)                         31310032
314000              FROM   (DP057-MESSAGE-SEL-REC)                      31320032
314100              ITEM   (ASC-SEL-ITEM)                               31330032
314200              RESP   (PV-CICS-RESP)                               31340032
314300              REWRITE                                             31350032
314400     END-EXEC.                                                    31360032
314500                                                                  31370032
314600     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   31380032
314700         SET DP013-CICS-ABEND                                     31390032
314800             DP013-NO-ROLLBACK     TO TRUE                        31400032
314900         MOVE '9200-REWRITE-SEL-QUEUE'                            31410032
315000                                   TO DP013-PARAGRAPH             31420032
315100         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   31430032
315200                                   TO DP013-MESSAGE-TEXT (1)      31440032
315300         PERFORM DP013-0000-PROCESS-ABEND                         31450032
315400     END-IF.                                                      31460032
315500                                                                  31470032
315600 EJECT                                                            31480032
315700*----------------------------------------------------------------*31490032
315800*    ABEND PROCESSOR MODULE                                      *31500032
315900*----------------------------------------------------------------*31510032
316000                                                                  31520032
316100     COPY DPPD013.                                                31530032
