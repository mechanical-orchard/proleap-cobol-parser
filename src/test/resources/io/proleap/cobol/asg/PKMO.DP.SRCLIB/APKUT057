000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.     APKUT057.                                        00020000
000300 AUTHOR.         CHRIS KUNSTMANN IBS.                             00030000
000400 DATE-WRITTEN.   06/05/1997.                                      00040000
000500 DATE-COMPILED.                                                   00050000
000600****************************************************************  00060000
000700* COBOL 2 WITH SQL                                             *  00070000
000710*--------------------------------------------------------------*  00071000
000800*        --- SUMMARIZE IMPORT PO RECEIVING ---                 *  00080000
000900*                                                              *  00090000
001000* THIS PROGRAM RETRIEVES RECEIVING DATA FOR IMPORT PO'S AND    *  00100000
001100* SUMMARIZES IT TO 2 LEVELS. ESTIMATED COSTS AND PO SUMMARY    *  00110000
001200* DATA WILL ALSO BE COLLECTED FOR THE RECEIVING DATA.  THE     *  00120000
001300* OUTPUT DATA WILL BE STORED ON 4 OUTPUT FILES TO BE REPORTED  *  00130000
001400* BY OTHER PROGRAMS.                                           *  00140000
001500*--------------------------------------------------------------*  00150000
001600* INPUT:                                                       *  00160000
001700*  1. RELEASED PO/STORES                           (TPOSTRR)   *  00170000
001800*  2. PURCHASING ITEM                              (TPURITM)   *  00180000
001900*  3. PO VENDOR STYLE COMPONENT                    (TVSCPT)    *  00190000
002000*  4. EXTERNAL ENTERPRISE                          (TEXTENT)   *  00200000
002100*  5. EXTERNAL ENTERPRISE NAME                     (TENTNME)   *  00210000
002200*  6. PURCHASE TABLE                               (TPURCHS)   *  00220000
002300*  7. PO PLANNED SHIPMENT TABLE                    (TPLNSHP)   *  00230000
002400*  8. RECEIVING FOR IMPORT PO'S                    (APRD032)   *  00240000
002500*  9. RECEIVING SUMM BY PO LINE                    (APRD032)   *  00250000
002600*     (PREFIX IS CHANGED FROM AP032- TO POLINE-)               *  00260000
002700* 10. ELC PO TABLE                                 (TELCPO)    *  00270000
002800*                                                              *  00280000
002900* OUTPUT:                                                      *  00290000
003000*  1. IMPORT RECEIPTS SUMM BY RCVR SEQ             (APRD033)   *  00300000
003100*  2. IMPORT RECEIPTS SUMM BY PO                   (APRD033)   *  00310000
003200*  3. RECEIPTS WITH ESTIMATED VARIANCE             (APRD034)   *  00320000
003300*  4. ESTIMATED LANDED COST ERROR FILE             (APRD035)   *  00330000
003500****************************************************************  00350000
003600* CHANGE LOG:                                               *     00360000
003700*  8/25/97   INITIAL VERSION. WR4164                        *     00370000
003800*                                                           *     00380000
003900*  9/10/97 - S100: ADDED A WHERE CONDITION TO THE SELECT OF *     00390000
004000*            THE VENDOR NAME TO GET ONLY ROWS WITH A VERSION*     00400000
004100*            STATUS CODE OF 'A' ON TPURCHS.  THIS CHANGE    *     00410000
004200*            CORRECTED A PROBLEM WHERE THE SELECT WAS       *     00420000
004300*            RETURNING MORE THAN ONE ROW.                   *     00430000
004400*        BY: NANCY EILBES                     PITS#:112716  *     00440000
004500*  10/10/97  REMOVED THE ABENDS LOGIC WHEN THE PO RCPTS FILE*     00450000
004600*            OR THE PO LINES FILE IS EMPY.  NOW IT DISPLAYS *     00460000
004700*            THAT THE FILE IS EMPTY AND ENDS RATHER THEN    *     00470000
004800*            ABENDS                                         *     00480000
004900*        BY: CHRIS BOEHNLEIN                  PITS#:118171  *     00490000
005000*  10/20/97                                                 *     00500000
005100*  MODIFIED THE ELC CURSOR AND THE PO TOTAL SQL TO INCLUDE  *     00510000
005200*  ONLY PO LINES WITH STATUS OF 'AC' 'AP' 'CM' OR 'CB'.     *     00520000
005300*  THIS CORRECTS A PROBLEM WHERE CANCELLED LINES WERE BEING *     00530000
005400*  INCLUDED IN THE PO AND ELC TOTALS WHEN THEY SHOULD NOT   *     00540000
005500*  HAVE BEEN.                                               *     00550000
005600*  BY: NANCY EILBES                           WR#:4164      *     00560000
005700*                                                           *     00570000
005800*  11/17/97  ADDED CODE TO MOVE THE DEPARTMENT NUMBER FROM  *     00580000
005900*            THE AP032 TO THE AP033 LAYOUT.                 *     00590000
006000*        BY: MIKE BESKE                       WR#:4164      *     00600000
006100*                                                           *     00610000
006200*  12/10/97  ADDED CODE TO MOVE THE CLASS NUMBER FROM THE   *     00620000
006300*            AP032 TO THE AP033 LAYOUT.                     *     00630000
006400*        BY: NANCY EILBES                     WR#:4164      *     00640000
006500*                                                           *     00650000
006600*  01/30/98  ADDED CODE TO RETRIEVE THE FOB CODE FROM THE   *     00660000
006700*            PO PLANNED SHIPMENT DB2 TABLE.                 *     00670000
006800*        BY: ROBIN BERNOSKI                   WR#:6059      *     00680000
006900*                                                           *     00690000
007000*  07/27/98  ADDED AN ADDITIONAL WHERE COND TO THE SELECT IN*     00700000
007100*            S300-GET-POSTRR.  THIS CHANGE WILL SELECT ONLY *     00710000
007200*            BULK POS THAT ARE FOUND ON TPOSTRR AND NOT     *     00720000
007300*            BY-STORE POS.                                  *     00730000
007400*        BY: MIKE BESKE                       IR#:211220    *     00740000
007500*                                                           *     00750000
007600*  08/25/98  AP033 RECORD LENGTH CHANGED FROM 135 TO 150.   *     00760000
007700*            B200- ADD PERFORM S500- (NEW PARA) STATEMENT.  *     00770000
007800*            B200- CALCULATE LCL UNIT COST. MOVE LAST       *     00780000
007900*              VERIFIED DATE TO NEW AP033 FIELD.            *     00790000
008000*            C100- ADD LOGIC TO GET LAST VERIFIED DATE.     *     00800000
008100*            D100- DETERMINE LCL LOAD PCT. MOVE DATA TO 3   *     00810000
008200*              NEW AP033 FIELDS.                            *     00820000
008300*            D200- CALCULATE RECEIVING ELC COST FOR 'LCL'.  *     00830000
008400*            S100- SELECT OTB_PER_NBR & STATUS_CDE FROM     *     00840000
008500*              TPURCHS TABLE.                               *     00850000
008600*            S200- MODIFIED PO TOTALS SQL TO ALLOW FOR      *     00860000
008700*              SQLCODE = -305. HANDLE AS A NOT FOUND COND.  *     00870000
008800*            ADDED NEW S500-GET-TRIP-START PARAGRAPH TO     *     00880000
008900*              PROCESS NEW TELCPO DB2 TABLE.                *     00890000
009000*            MODIFIED ELC_CSR TO INCLUDE 'LCL' CHARGES,     *     00900000
009100*             EVEN THOUGH THE INCL_IN_ELC_IND = 'N'.        *     00910000
009200*               ( THESE SHOULD ONLY BE FOR COLBY)           *     00920000
009300*            C200-  IF AN 'LCL' IS FOUND BUT THE VENDOR     *     00930000
009400*             ISN'T COLBY, NO OUTPUT RECORD IS CREATED.     *     00940000
009500*        BY: CHRIS KUNSTMANN                  WR#:4164      *     00950000
009600*                                                           *     00960000
009700*  12/04/98  ADDED CODE TO HANDLE DIVIDE BY ZERO PROBLEM.   *     00970000
009800*        BY: L SCHALLHORN                   PITS#:254351    *     00980000
009900*                                                           *     00990000
010000*  08/01/01  ADDED 'RV' IN STATUS_CDE RELATED TO THE        *     01000000
010100*            TPURITM TABLE. THIS WAS UPDATED IN A CURSOR    *     01010000
010200*            AND A SELECT THAT USE THIS STATUS_CDE.         *     01020000
010300*        BY: ALEXIS KEIKER                  WR#: ?????      *     01030000
010400*                                                           *     01040000
010500* DATE  01/26/2005                                          *     01050000
010600*     CHANGE MADE: REPLACED PV-VENDOR-NAME WITH PV-VENDOR-  *     01060000
010700*     NBR.  REPLACED THE 88 LEVEL REFERRING TO COLBY WITH   *     01070000
010800*     AN 88 LEVEL USING THE VENDOR NUMBER 009206194.        *     01080000
010900*     MADE BY: MIKE BESKE              WR/IR #: WR28114     *     01090000
010910*                                                           *     01091000
010920* DATE  03/11/2007                                          *     01092000
010930*     CHANGE MADE: MATCH BY DC -- REPLACED THE STR_NBR = 0  *     01093000
010940*     IN THE WHERE CLAUSE OF PARAGRAPH S300-GET-POSTRR      *     01094000
010950*     WITH MTCH_LVL_CDE = 'P'.                              *     01095000
010960*     MADE BY: KRYSTEN LEARY           WR/IR #: WR21578     *     01096000
032600*                                                           *     03260000
032700* DATE  06/30/2011                                          *     03270000
032800*     CHANGE MADE: TO USE THE PO PAYMENT TERMS TO REASSIGN  *     03280000
032900*     THE OPEN ACCOUNT ALLOWANCE CHARGE CODE TO THE PURCHASE*     03290000
033000*     ORDER IN THE OUTPUT FILE,                             *     03300000
033001*     MADE BY: TOM MARTIN              WR/IR #: WR39735     *     03300100
033002*                                                           *     03300200
033003* DATE  08/24/2011                                          *     03300300
033004*     CHANGE MADE: REMOVE LOGIC USING PAYMENT TERMS         *     03300400
033005*     FOR OPEN ACCOUNTS                                     *     03300500
033006*     MADE BY: TOM MARTIN              WR/IR #: WR39735     *     03300600
033007*-----------------------------------------------------------*     03300700
033008                                                                  03300800
033009 ENVIRONMENT DIVISION.                                            03300900
033010 CONFIGURATION SECTION.                                           03301000
033011 SOURCE-COMPUTER.    IBM-3090.                                    03301100
033012 OBJECT-COMPUTER.    IBM-3090.                                    03301200
033013                                                                  03301300
033014 INPUT-OUTPUT SECTION.                                            03301400
033015 FILE-CONTROL.                                                    03301500
033016     SELECT PO-RCPTS-FILE                 ASSIGN TO UT-S-INP01.   03301600
033017     SELECT PO-LINES-FILE                 ASSIGN TO UT-S-INP02.   03301700
033018     SELECT RCVR-SEQ-SUMM-FILE            ASSIGN TO UT-S-OUT01.   03301800
033019     SELECT PO-SUMM-FILE                  ASSIGN TO UT-S-OUT02.   03301900
033020     SELECT EST-VARIANCE-FILE             ASSIGN TO UT-S-OUT03.   03302000
033021     SELECT ELC-ERROR-FILE                ASSIGN TO UT-S-OUT04.   03302100
033022                                                                  03302200
033023 DATA DIVISION.                                                   03302300
033024 FILE SECTION.                                                    03302400
033025                                                                  03302500
033026 FD  PO-RCPTS-FILE                                                03302600
033027     RECORDING MODE IS F                                          03302700
033028     LABEL RECORDS ARE STANDARD                                   03302800
033029     DATA RECORD IS PO-RCPTS-REC.                                 03302900
033030 01  PO-RCPTS-REC.                                                03303000
033031     05 FILLER                        PIC  X(100).                03303100
033032                                                                  03303200
033033 FD  PO-LINES-FILE                                                03303300
033034     RECORDING MODE IS F                                          03303400
033035     LABEL RECORDS ARE STANDARD                                   03303500
033036     DATA RECORD IS PO-LINES-REC.                                 03303600
033037 01  PO-LINES-REC.                                                03303700
033038     05 FILLER                        PIC  X(100).                03303800
033039                                                                  03303900
033040 FD  RCVR-SEQ-SUMM-FILE                                           03304000
033041     RECORDING MODE IS F                                          03304100
033042     LABEL RECORDS ARE STANDARD                                   03304200
033043     BLOCK CONTAINS 0 RECORDS                                     03304300
033044     DATA RECORD IS RCVR-SEQ-SUMM-REC.                            03304400
033045 01  RCVR-SEQ-SUMM-REC.                                           03304500
033046     05 FILLER                        PIC  X(150).                03304600
033047                                                                  03304700
033048 FD  PO-SUMM-FILE                                                 03304800
033049     RECORDING MODE IS F                                          03304900
033050     LABEL RECORDS ARE STANDARD                                   03305000
033051     BLOCK CONTAINS 0 RECORDS                                     03305100
033052     DATA RECORD IS PO-SUMM-REC.                                  03305200
033053 01  PO-SUMM-REC.                                                 03305300
033054     05 FILLER                        PIC  X(150).                03305400
033055                                                                  03305500
033056 FD  EST-VARIANCE-FILE                                            03305600
033057     RECORDING MODE IS F                                          03305700
033058     LABEL RECORDS ARE STANDARD                                   03305800
033059     BLOCK CONTAINS 0 RECORDS                                     03305900
033060     DATA RECORD IS EST-VARIANCE-REC.                             03306000
033061 01  EST-VARIANCE-REC.                                            03306100
033062     05 FILLER                        PIC  X(80).                 03306200
033063                                                                  03306300
033064 FD  ELC-ERROR-FILE                                               03306400
033065     RECORDING MODE IS F                                          03306500
033066     LABEL RECORDS ARE STANDARD                                   03306600
033067     BLOCK CONTAINS 0 RECORDS                                     03306700
033068     DATA RECORD IS ELC-ERROR-REC.                                03306800
033069 01  ELC-ERROR-REC.                                               03306900
033070     05 FILLER                        PIC  X(80).                 03307000
033071                                                                  03307100
033072 WORKING-STORAGE SECTION.                                         03307200
033073                                                                  03307300
033074 01  PC-PROGRAM-CONSTANTS.                                        03307400
033075     05  FILLER                  PIC  X(30)  VALUE                03307500
033076         '** BEGINING OF APKUT057 W/S **'.                        03307600
033077                                                                  03307700
033078     05  PC-PROGRAM-NAME         PIC  X(08)  VALUE 'APKUT057'.    03307800
033079                                                                  03307900
033080 01  PV-PROGRAM-VARIABLES.                                        03308000
033081     05  PV-HOLD-PO-NBR          PIC S9(09)       VALUE ZEROS     03308100
033082                                             COMP.                03308200
033083     05  PV-HOLD-STR-NBR         PIC  9(04)       VALUE ZEROS     03308300
033084                                             COMP.                03308400
033085     05  PV-HOLD-REC-SEQ-NBR     PIC  9(09)       VALUE ZEROS.    03308500
033086     05  PV-HOLD-AP-PRC-CDE      PIC  X           VALUE SPACE.    03308600
033087     05  PV-HOLD-FOB-CDE         PIC  X(03)       VALUE SPACE.    03308700
033088     05  PV-VENDOR-NBR           PIC  X(9)        VALUE SPACE.    03308800
033089         88  PV-VENDOR-NBR-LIFUNG           VALUE '009206194'.    03308900
033090     05  PV-TRIP-START-DATE      PIC  X(10)       VALUE SPACE.    03309000
033091     05  PV-PO-TOT-QTY           PIC S9(09)       VALUE ZEROS     03309100
033092                                             COMP.                03309200
033093     05  PV-PO-TOT-COST          PIC S9(09)V9(3)  VALUE ZEROS     03309300
033094                                             COMP-3.              03309400
033095     05  PV-PO-TOT-1ST-COST      PIC S9(09)V9(3)  VALUE ZEROS     03309500
033096                                             COMP-3.              03309600
033097     05  PV-ELC-UNT-QTY          PIC S9(09)       VALUE ZEROS     03309700
033098                                             COMP.                03309800
033099     05  PV-ELC-COST-AMT         PIC S9(09)V9(3)  VALUE ZEROS     03309900
033100                                             COMP-3.              03310000
033101     05  PV-REC-UNT-QTY          PIC S9(09)       VALUE ZEROS.    03310100
033102     05  PV-REC-ELC-COST         PIC S9(09)V9(3)  VALUE ZEROS.    03310200
033103     05  PV-REC-1ST-COST         PIC S9(09)V9(3)  VALUE ZEROS.    03310300
033104     05  PV-REC-PO-UNT-QTY       PIC S9(09)       VALUE ZEROS.    03310400
033105     05  PV-REC-PO-ELC-COST      PIC S9(09)V9(3)  VALUE ZEROS.    03310500
033106     05  PV-REC-PO-1ST-COST      PIC S9(09)V9(3)  VALUE ZEROS.    03310600
033107     05  PV-REC-VERFYD-DATE      PIC  X(10)       VALUE SPACE.    03310700
033108     05  PV-REC-LAST-VERFYD      PIC  X(10)       VALUE SPACE.    03310800
033109     05  PV-LCL-UNT-COST         PIC S999V9(5)    VALUE ZEROS.    03310900
033110     05  PV-LCL-LOAD-PCT         PIC S9V9(4)      VALUE ZEROS.    03311000
033111                                                                  03311100
033112     05  PV-PO-RCPTS-READ        PIC  9(07)       VALUE ZEROS.    03311200
033113     05  PV-PO-LINES-READ        PIC  9(07)       VALUE ZEROS.    03311300
033114     05  PV-RCVR-SEQ-WRITTEN     PIC  9(07)       VALUE ZEROS.    03311400
033115     05  PV-PO-LINE-WRITTEN      PIC  9(07)       VALUE ZEROS.    03311500
033116     05  PV-EST-VAR-WRITTEN      PIC  9(07)       VALUE ZEROS.    03311600
033117     05  PV-ERRORS-WRITTEN       PIC  9(07)       VALUE ZEROS.    03311700
033118                                                                  03311800
033119 01  PS-PROGRAM-SWITCHES.                                         03311900
033120     05  PS-END-OF-PO-RCPTS-SW   PIC X(01)        VALUE 'N'.      03312000
033121         88  END-OF-PO-RCPTS                      VALUE 'Y'.      03312100
033122     05  PS-END-OF-PO-LINES-SW   PIC X(01)        VALUE 'N'.      03312200
033123         88  END-OF-PO-LINES                      VALUE 'Y'.      03312300
033124     05  PS-FOUND-ELC-ROWS-SW    PIC X(01)        VALUE 'N'.      03312400
033125         88  NEW-ELC-ROWS                         VALUE 'N'.      03312500
033126         88  FOUND-ELC-ROWS                       VALUE 'Y'.      03312600
033127     05  PS-END-OF-ELC-CSR-SW    PIC X(01)        VALUE 'N'.      03312700
033128         88  NEW-ELC-CSR                          VALUE 'N'.      03312800
033129         88  END-OF-ELC-CSR                       VALUE 'Y'.      03312900
033130         88  EMPTY-ELC-CSR                        VALUE 'E'.      03313000
033131     05  EST-VAR-WRITE-SW        PIC X(01)        VALUE 'N'.      03313100
033132         88  EST-VAR-NOT-WROTE                    VALUE 'N'.      03313200
033133         88  EST-VAR-WROTE                        VALUE 'W'.      03313300
033134     05  PS-FILE-EMPTY           PIC X(01)        VALUE 'N'.      03313400
033135         88  FILE-EMPTY-TRUE                      VALUE 'Y'.      03313500
033136                                                                  03313600
033137*--------------------------------------------------------------*  03313700
033138* COMMUNICATIONS AREA2 FOR DB2                                 *  03313800
033139*--------------------------------------------------------------*  03313900
033140     COPY SQLCA2.                                                 03314000
033141                                                                  03314100
033142     EXEC SQL                                                     03314200
033143          INCLUDE SQLCA                                           03314300
033144     END-EXEC.                                                    03314400
033145                                                                  03314500
033146*--------------------------------------------------------------*  03314600
033147* RELEASED PO/STORES TABLE                                     *  03314700
033148*--------------------------------------------------------------*  03314800
033149     EXEC SQL                                                     03314900
033150          INCLUDE TPOSTRR                                         03315000
033151     END-EXEC.                                                    03315100
033152                                                                  03315200
033153*--------------------------------------------------------------*  03315300
033154* PO-PURCHASING ITEM TABLE                                     *  03315400
033155*--------------------------------------------------------------*  03315500
033156     EXEC SQL                                                     03315600
033157          INCLUDE TPURITM                                         03315700
033158     END-EXEC.                                                    03315800
033159                                                                  03315900
033160*--------------------------------------------------------------*  03316000
033161* PD-ESTIMATED LANDED COST PO VENDOR STYLE COMPONENT           *  03316100
033162*--------------------------------------------------------------*  03316200
033163     EXEC SQL                                                     03316300
033164          INCLUDE TVSCPT                                          03316400
033165     END-EXEC.                                                    03316500
033166                                                                  03316600
033167*--------------------------------------------------------------*  03316700
033168* EXTERNAL ENTERPRISE TABLE                                    *  03316800
033169*--------------------------------------------------------------*  03316900
033170     EXEC SQL                                                     03317000
033171          INCLUDE TEXTENT                                         03317100
033172     END-EXEC.                                                    03317200
033173                                                                  03317300
033174*--------------------------------------------------------------*  03317400
033175* EXTERNAL ENTERPRISE NAME TABLE                               *  03317500
033176*--------------------------------------------------------------*  03317600
033177     EXEC SQL                                                     03317700
033178          INCLUDE TENTNME                                         03317800
033179     END-EXEC.                                                    03317900
033180                                                                  03318000
033181*--------------------------------------------------------------*  03318100
033182* PURCHASE ORDER TABLE                                         *  03318200
033183*--------------------------------------------------------------*  03318300
033184     EXEC SQL                                                     03318400
033185          INCLUDE TPURCHS                                         03318500
033186     END-EXEC.                                                    03318600
033187                                                                  03318700
033188*--------------------------------------------------------------*  03318800
033189* PO PLANNED SHIPMENT TABLE                                    *  03318900
033190*--------------------------------------------------------------*  03319000
033191     EXEC SQL                                                     03319100
033192          INCLUDE TPLNSHP                                         03319200
033193     END-EXEC.                                                    03319300
033194                                                                  03319400
033195*--------------------------------------------------------------*  03319500
033196* ELC PO TABLE                                                 *  03319600
033197*--------------------------------------------------------------*  03319700
033198     EXEC SQL                                                     03319800
033199          INCLUDE TELCPO                                          03319900
033200     END-EXEC.                                                    03320000
033201                                                                  03320100
033202*--------------------------------------------------------------*  03320200
033203* ELC_CSR WILL RETREIVE ALL PO ALLOWANCE/CHARGE DATA AT THE PO *  03320300
033204*  LINE LEVEL. THIS DATA WILL BE MATCHED WITH THE PO LINE FILE *  03320400
033205*  (INPUT) AND WILL HELP CREATE THE 'RECEIPTS WITH EST.        *  03320500
033206*  VARIANCE FILE (OUTPUT).                                     *  03320600
033207*--------------------------------------------------------------*  03320700
033208     EXEC SQL                                                     03320800
033209       DECLARE ELC_CSR CURSOR FOR                                 03320900
033210         SELECT                                                   03321000
033211             PR.APP_PO_LNE_NBR                                    03321100
033212            ,VS.ALW_CHRG_CDE                                      03321200
033213            ,VS.CPT_CHRG_AMT                                      03321300
033214            ,SUM(PR.UNT_QTY)                                      03321400
033215            ,SUM(PR.UNT_QTY*VS.CPT_CHRG_AMT)                      03321500
033216         FROM                                                     03321600
033217             TPURITM PR                                           03321700
033218            ,TVSCPT  VS                                           03321800
033219         WHERE                                                    03321900
033220               PR.PO_NBR            = :PV-HOLD-PO-NBR             03322000
033221           AND PR.PO_NBR            = VS.PO_NBR                   03322100
033222           AND PR.VEND_STYL_NAME    = VS.VND_STYL_NM              03322200
033223           AND PR.VER_STATUS_CDE    = 'A'                         03322300
033224           AND PR.STATUS_CDE        IN ('AC','AP','CB','CM','RV') 03322400
033225           AND ( VS.INCL_IN_ELC_IND = 'Y'                         03322500
033226                OR VS.ALW_CHRG_CDE  = 'LCL' )                     03322600
033227         GROUP BY                                                 03322700
033228             PR.APP_PO_LNE_NBR                                    03322800
033229            ,VS.ALW_CHRG_CDE                                      03322900
033300            ,VS.CPT_CHRG_AMT                                      03330000
033400         ORDER BY 1                                               03340000
033500     END-EXEC.                                                    03350000
033600                                                                  03360000
033700*--------------------------------------------------------------*  03370000
033800* IMPORT PO RECEIVING AND PO EXTRACT LAYOUT                    *  03380000
033900*--------------------------------------------------------------*  03390000
034000     COPY APRD032.                                                03400000
034100                                                                  03410000
034200*--------------------------------------------------------------*  03420000
034300* IMPORT PO RECEIVING AND PO EXTRACT LAYOUT                    *  03430000
034400*--------------------------------------------------------------*  03440000
034500     COPY APRD032 REPLACING 'AP032-' BY 'POLINE-'.                03450000
034600                                                                  03460000
034700*--------------------------------------------------------------*  03470000
034800* IMPORT PO RECEIVING ACTUALS & ESTIMATE VARIANCE LAYOUT       *  03480000
034900*--------------------------------------------------------------*  03490000
035000     COPY APRD034.                                                03500000
035100                                                                  03510000
035200*--------------------------------------------------------------*  03520000
035300* IMPORT PO ESTIMATED LANDED COST ERROR LAYOUT                 *  03530000
035400*--------------------------------------------------------------*  03540000
035500     COPY APRD035.                                                03550000
035600                                                                  03560000
035700*--------------------------------------------------------------*  03570000
035800* IMPORT PO RECEIVING AND PO SUMMARY LAYOUT                    *  03580000
035900*--------------------------------------------------------------*  03590000
036000     COPY APRD033.                                                03600000
036100                                                                  03610000
036200*--------------------------------------------------------------*  03620000
036300* ABEND DATA AREAS                                             *  03630000
036400*--------------------------------------------------------------*  03640000
036500 01  ABEND-CODE                  PIC S9(04)  VALUE ZEROS          03650000
036600                                             COMP SYNC.           03660000
036700     88  AC-BAD-DATA                         VALUE +4003.         03670000
036800     88  AC-DB2-ERROR                        VALUE +4013.         03680000
036900     88  AC-DATE-ERROR                       VALUE +4019.         03690000
037000                                                                  03700000
037100 01  ABEND-AREAS.                                                 03710000
037200     05  AA-ABEND-LIT            PIC  X(40)  VALUE                03720000
037300             '*****       ABEND'.                                 03730000
037400     05  AA-PROGRAM-LIT          PIC  X(40)  VALUE                03740000
037500             '*****   PROGRAM: APKUT057'.                         03750000
037600     05  AA-PARAGRAPH-LIT.                                        03760000
037700         10  FILLER              PIC  X(17)  VALUE                03770000
037800             '***** PARAGRAPH: '.                                 03780000
037900         10  AA-PARAGRAPH-NAME   PIC  X(35)  VALUE SPACES.        03790000
038000     05  AA-MESSAGE-LINE.                                         03800000
038100         10  FILLER              PIC  X(06)  VALUE '*****'.       03810000
038200         10  AA-MESSAGE          PIC  X(127) VALUE SPACES.        03820000
038300     05  AA-DB2-ERROR-LIT        PIC  X(40)  VALUE                03830000
038400             '*****    DB2 ERROR'.                                03840000
038500     05  AA-DB2-OPERATION-LIT.                                    03850000
038600         10  FILLER              PIC  X(17)  VALUE                03860000
038700             '***** OPERATION: '.                                 03870000
038800         10  AA-DB2-OPERATION.                                    03880000
038900             15  AA-DB2-OP-1     PIC  X(25)  VALUE SPACES.        03890000
039000             15  AA-DB2-OP-2     PIC  X(25)  VALUE SPACES.        03900000
039100     05  AA-DB2-TABLE-1          PIC  X(08)  VALUE SPACES.        03910000
039200     05  AA-DB2-TABLE-2          PIC  X(08)  VALUE SPACES.        03920000
039300     05  AA-DB2-TABLE-3          PIC  X(08)  VALUE SPACES.        03930000
039400     05  AA-DB2-TABLE-4          PIC  X(08)  VALUE SPACES.        03940000
039410                                                                  03941000
039500*--------------------------------------------------------------*  03950000
039510* SQLCA FORMATTED MESSAGE AREA                                 *  03951000
039520*--------------------------------------------------------------*  03952000
039600     COPY DPWS004.                                                03960000
039610                                                                  03961000
039700 01  FILLER                      PIC  X(25)  VALUE                03970000
039800     '** END OF APKUT057 W/S **'.                                 03980000
039900                                                                  03990000
039910*--------------------------*                                      03991000
040000 PROCEDURE DIVISION.                                              04000000
040010*--------------------------*                                      04001000
040100 A100-MAIN.                                                       04010000
040200                                                                  04020000
040300     PERFORM B100-HOUSEKEEPING.                                   04030000
040500     IF NOT FILE-EMPTY-TRUE                                       04050000
040600          PERFORM B200-PROCESS-POS                                04060000
040700             UNTIL END-OF-PO-RCPTS                                04070000
040800     END-IF.                                                      04080000
041000     PERFORM B300-END-PROGRAM.                                    04100000
041200     GOBACK.                                                      04120000
041300                                                                  04130000
041500*--------------------------------------------------------------*  04150000
041600* INITIALIZATION PROCESS AND INITIAL READS FOR BOTH INPUTS.    *  04160000
041700*--------------------------------------------------------------*  04170000
041710 B100-HOUSEKEEPING.                                               04171000
041800                                                                  04180000
041900     OPEN INPUT  PO-RCPTS-FILE                                    04190000
042000                 PO-LINES-FILE                                    04200000
042100                 .                                                04210000
042200     OPEN OUTPUT RCVR-SEQ-SUMM-FILE                               04220000
042300                 PO-SUMM-FILE                                     04230000
042400                 EST-VARIANCE-FILE                                04240000
042500                 ELC-ERROR-FILE.                                  04250000
042700                                                                  04270000
042800     INITIALIZE DCLTPOSTRR                                        04280000
042900                DCLTPURITM                                        04290000
043000                DCLTVSCPT                                         04300000
043100                DCLTEXTENT                                        04310000
043200                DCLTENTNME                                        04320000
043300                DCLTPURCHS                                        04330000
043400                DCLTPLNSHP.                                       04340000
043600                                                                  04360000
043700* INITIAL READ OF PO RECEIPTS FILE.                               04370000
043800*                                                                 04380000
043900     PERFORM R100-READ-PO-RCPTS.                                  04390000
044000     IF END-OF-PO-RCPTS                                           04400000
044100        DISPLAY 'PO RECEIPTS FILE IS EMPTY '                      04410000
044200        SET FILE-EMPTY-TRUE TO TRUE                               04420000
044300     END-IF.                                                      04430000
044400                                                                  04440000
044500* INITIAL READ OF PO LINES FILE. IF THE PO RECEIPTS FILE HAS      04450000
044600*  DATA, THIS FILE SHOULD ALSO. JUST IN CASE A SORT ERROR HAS     04460000
044700*  OCCURED, WE CHECK FOR AN EMPTY FILE, AND HANDLE IT HERE.       04470000
044800*                                                                 04480000
044900     PERFORM R200-READ-PO-LINES.                                  04490000
045000     IF END-OF-PO-LINES                                           04500000
045100        DISPLAY 'PO LINE FILE IS EMPTY '                          04510000
045200        SET FILE-EMPTY-TRUE TO TRUE                               04520000
045300     END-IF.                                                      04530000
045400                                                                  04540000
045600*--------------------------------------------------------------*  04560000
045700* CONTROLS THE PROCESSING OF EACH PO:                          *  04570000
045800*                                                              *  04580000
045900*  - SET UP SAVED FIELDS, GETS VENDOR DATA, PO TOTALS, AND     *  04590000
046000*    POSTRR DATA FOR THE PO BEING PROCESSED.                   *  04600000
046100*  - ALL RECEIVING DATA FOR THIS PO IS PROCESSED, THE RECEIPTS *  04610000
046200*    ARE SUMMED BY RECEIVER SEQUENCE, AND WRITTEN.             *  04620000
046300*  - IF THE CURSOR IS EMPTY, WRITE 1 ERROR RECORD FOR THE PO,  *  04630000
046400*    AND READ THE PO LINE FILE TO POSTION AT THE NEXT PO NBR.  *  04640000
046500*    OTHERWISE, EACH ROW RETURNED IN THE CURSOR IS PROCESSED   *  04650000
046600*    FOR THE PO LINE.                                          *  04660000
046700*  - THE CURSOR IS CLOSED.                                     *  04670000
046900*--------------------------------------------------------------*  04690000
046901 B200-PROCESS-POS.                                                04690100
046910                                                                  04691000
047100* SET UP SAVED FIELDS, GETS VENDOR DATA, PO TOTALS, AND POSTRR    04710000
047200* DATA FOR THE PO BEING PROCESSED                                 04720000
047300     MOVE AP032-PO-NBR           TO PV-HOLD-PO-NBR.               04730000
047400     MOVE AP032-REC-SEQ-NBR      TO PV-HOLD-REC-SEQ-NBR.          04740000
047500     MOVE AP032-VERFYD-DATE      TO PV-REC-VERFYD-DATE            04750000
047600                                    PV-REC-LAST-VERFYD.           04760000
047700                                                                  04770000
047800     INITIALIZE PURITM-PO-LNE-NBR     PV-REC-PO-ELC-COST          04780000
047900                PV-REC-PO-UNT-QTY     PV-REC-PO-1ST-COST          04790000
048000                                      AP033-RECORD.               04800000
048100                                                                  04810000
048200     PERFORM S100-GET-VENDOR-DATA.                                04820000
048300     PERFORM S200-GET-PO-TOTALS.                                  04830000
048400     PERFORM S300-GET-POSTRR.                                     04840000
048500     PERFORM S400-GET-FOB.                                        04850000
048600     PERFORM S500-GET-TRIP-START.                                 04860000
048700                                                                  04870000
048800* ALL RECEIVING DATA FOR THIS PO IS PROCESSED, THE RECEIPTS ARE   04880000
048900* SUMMED BY RECEIVER SEQUENCE, AND WRITTEN.                       04890000
049000     PERFORM C100-PROCESS-RCVR-SEQ                                04900000
049100       UNTIL AP032-PO-NBR  >  PV-HOLD-PO-NBR                      04910000
049200       OR END-OF-PO-RCPTS.                                        04920000
049300                                                                  04930000
049400     IF AP032-PO-NBR  NOT = PV-HOLD-PO-NBR                        04940000
049500       OR END-OF-PO-RCPTS                                         04950000
049600         PERFORM D100-FORMAT-IMPORT-RCPTS                         04960000
049700* FORMAT AP033 'SUM-BY-PO' SPECIFIC FIELDS HERE                   04970000
049800         SET AP033-REC-SUM-BY-PO TO TRUE                          04980000
049900         MOVE PV-REC-PO-UNT-QTY  TO AP033-REC-TOT-QTY             04990000
050000         MOVE PV-REC-PO-ELC-COST TO AP033-REC-ELC-COST-AMT        05000000
050100         MOVE PV-REC-PO-1ST-COST TO AP033-REC-1ST-COST-AMT        05010000
050200         MOVE PV-REC-VERFYD-DATE TO AP033-FIRST-VERFYD-DATE       05020000
050300                                                                  05030000
050400         MOVE PV-REC-LAST-VERFYD TO AP033-LAST-VERFYD-DATE        05040000
050500         IF PV-LCL-LOAD-PCT = ZEROES                              05050000
050600             MOVE ZEROES         TO PV-LCL-UNT-COST               05060000
050700         ELSE                                                     05070000
050800             IF AP033-REC-TOT-QTY = ZEROES                        05080000
050900                MOVE ZEROES TO PV-LCL-UNT-COST                    05090000
051000             ELSE                                                 05100000
051100             COMPUTE PV-LCL-UNT-COST = (( AP033-REC-ELC-COST-AMT  05110000
051200                * PV-LCL-LOAD-PCT ) / AP033-REC-TOT-QTY )         05120000
051300                + .00005                                          05130000
051400            END-IF                                                05140000
051500         END-IF                                                   05150000
051600                                                                  05160000
051700         PERFORM W200-WRITE-RCPTS-BY-PO                           05170000
051800                                                                  05180000
051900         PERFORM X100-OPEN-ELC-CSR                                05190000
052000         PERFORM R300-FETCH-ELC-CSR                               05200000
052100                                                                  05210000
052200* IF END OF CURSOR OCCURS HERE, THEN THE CURSOR IS EMPTY.         05220000
052300* WRITE 1 ERROR RECORD FOR THE PO, AND READ THE PO LINE           05230000
052400* FILE UNTIL WE'RE AT THE NEXT PO NBR.  OTHERWISE, EACH ROW       05240000
052500* RETURNED IN THE CURSOR IS PROCESSED FOR THE PO LINE.            05250000
052700         IF EMPTY-ELC-CSR                                         05270000
052800             SET AP035-NO-ELC-FOR-PO   TO TRUE                    05280000
052900             INITIALIZE                   POLINE-PO-LNE-NBR       05290000
053000             PERFORM D300-FORMAT-ELC-ERROR                        05300000
053100             PERFORM                                              05310000
053200               UNTIL POLINE-PO-NBR > PV-HOLD-PO-NBR               05320000
053300               OR END-OF-PO-LINES                                 05330000
053400                 PERFORM R200-READ-PO-LINES                       05340000
053500             END-PERFORM                                          05350000
053600         ELSE                                                     05360000
053700             PERFORM C200-PROCESS-PO-LINES                        05370000
053800               UNTIL POLINE-PO-NBR > PV-HOLD-PO-NBR               05380000
053900               OR END-OF-PO-LINES                                 05390000
054000         END-IF                                                   05400000
054100                                                                  05410000
054200* THE CURSOR IS CLOSED.                                           05420000
054300         PERFORM X200-CLOSE-ELC-CSR                               05430000
054400     END-IF.                                                      05440000
054500                                                                  05450000
054700*--------------------------------------------------------------*  05470000
054800* ENDING PROCESSING: DISPLAYS COUNTS, AND CLOSES FILES.        *  05480000
054900*--------------------------------------------------------------*  05490000
054910 B300-END-PROGRAM.                                                05491000
055000                                                                  05500000
055100     DISPLAY 'PO RECEIPTS PROCESSED       = ' PV-PO-RCPTS-READ.   05510000
055200     DISPLAY 'PO LINES PROCESSED          = ' PV-PO-LINES-READ.   05520000
055300                                                                  05530000
055400     DISPLAY 'RCPTS BY RCVR SEQ WRITTEN   = ' PV-RCVR-SEQ-WRITTEN.05540000
055500     DISPLAY 'RCPTS BY PO LINE WRITTEN    = ' PV-PO-LINE-WRITTEN. 05550000
055600     DISPLAY 'RCPTS W/ EST. VAR. WRITTEN  = ' PV-EST-VAR-WRITTEN. 05560000
055700     DISPLAY 'ELC ERRORS WRITTEN          = ' PV-ERRORS-WRITTEN.  05570000
055800                                                                  05580000
055900     CLOSE PO-RCPTS-FILE                                          05590000
056000           PO-LINES-FILE                                          05600000
056100           RCVR-SEQ-SUMM-FILE                                     05610000
056200           PO-SUMM-FILE                                           05620000
056300           EST-VARIANCE-FILE                                      05630000
056400           ELC-ERROR-FILE.                                        05640000
056600                                                                  05660000
056800*--------------------------------------------------------------*  05680000
056900* CONTROLS THE PROCESSING OF RECEIPTS FOR EACH PO:             *  05690000
057000*                                                              *  05700000
057100*  - ACCUMULATES FIELDS TO THE RCVR SEQ NUMBER LEVEL, THE      *  05710000
057200*    FIRST VERIFY DATE FOR THE PO IS SAVED, AND READS THE PO   *  05720000
057300*    RECEIPTS FILE.                                            *  05730000
057400*  - AFTER ALL DATA IS ACCUMMED FOR A RCVR SEQ, THE PO RCPTS   *  05740000
057500*    BY RCVR SEQ FILE IS FORMATED AND WRITTEN.                 *  05750000
057700*--------------------------------------------------------------*  05770000
057710 C100-PROCESS-RCVR-SEQ.                                           05771000
057800                                                                  05780000
057900     ADD AP032-REC-UNT-QTY       TO PV-REC-UNT-QTY.               05790000
058000     COMPUTE PV-REC-ELC-COST = PV-REC-ELC-COST +                  05800000
058100         ( AP032-REC-ELC-COST-AMT * AP032-REC-UNT-QTY ).          05810000
058200     COMPUTE PV-REC-1ST-COST = PV-REC-1ST-COST +                  05820000
058300         ( AP032-REC-1ST-COST-AMT * AP032-REC-UNT-QTY ).          05830000
058400                                                                  05840000
058500     MOVE AP032-VERFYD-DATE      TO AP033-FIRST-VERFYD-DATE.      05850000
058600     MOVE AP032-REC-RVRSL-IND    TO AP033-REC-RVRSL-IND.          05860000
058700     MOVE AP032-DEPT-NBR         TO AP033-DEPT-NBR.               05870000
058800     MOVE AP032-CL-NBR           TO AP033-CL-NBR.                 05880000
058900     MOVE PV-HOLD-AP-PRC-CDE     TO AP033-AP-PRC-CDE.             05890000
059000     MOVE AP032-STR-NBR          TO PV-HOLD-STR-NBR.              05900000
059100                                                                  05910000
059200     IF AP032-VERFYD-DATE < PV-REC-VERFYD-DATE                    05920000
059300         MOVE AP032-VERFYD-DATE  TO PV-REC-VERFYD-DATE            05930000
059400     END-IF.                                                      05940000
059500                                                                  05950000
059600     IF AP032-VERFYD-DATE > PV-REC-LAST-VERFYD                    05960000
059700         MOVE AP032-VERFYD-DATE  TO PV-REC-LAST-VERFYD            05970000
059800     END-IF.                                                      05980000
059900                                                                  05990000
060000     PERFORM R100-READ-PO-RCPTS.                                  06000000
060100                                                                  06010000
060200     IF AP032-REC-SEQ-NBR NOT = PV-HOLD-REC-SEQ-NBR               06020000
060300       OR AP032-PO-NBR  NOT = PV-HOLD-PO-NBR                      06030000
060400       OR END-OF-PO-RCPTS                                         06040000
060500         ADD  PV-REC-UNT-QTY     TO PV-REC-PO-UNT-QTY             06050000
060600         ADD  PV-REC-ELC-COST    TO PV-REC-PO-ELC-COST            06060000
060700         ADD  PV-REC-1ST-COST    TO PV-REC-PO-1ST-COST            06070000
060800                                                                  06080000
060900         PERFORM D100-FORMAT-IMPORT-RCPTS                         06090000
061000* FORMAT AP033 'SUM-BY-SEQ-NBR' SPECIFIC FIELDS HERE              06100000
061100         SET AP033-REC-SUM-BY-SEQ-NBR                             06110000
061200                                 TO TRUE                          06120000
061300         MOVE PV-REC-UNT-QTY     TO AP033-REC-TOT-QTY             06130000
061400         MOVE PV-REC-ELC-COST    TO AP033-REC-ELC-COST-AMT        06140000
061500         MOVE PV-REC-1ST-COST    TO AP033-REC-1ST-COST-AMT        06150000
061600                                                                  06160000
061700         PERFORM W100-WRITE-RCPTS-BY-RCVR-SEQ                     06170000
061800                                                                  06180000
061900         INITIALIZE PV-REC-UNT-QTY                                06190000
062000                    PV-REC-ELC-COST                               06200000
062100                    PV-REC-1ST-COST                               06210000
062200         MOVE AP032-REC-SEQ-NBR  TO PV-HOLD-REC-SEQ-NBR           06220000
062300     END-IF.                                                      06230000
062600                                                                  06260000
062800*--------------------------------------------------------------*  06280000
063000* CONTROLS THE PROCESSING OF PO LINES FOR EACH PO:             *  06300000
063100*                                                              *  06310000
063200*  - PROCESS ALL ELC-CSR ROWS FOR A PO LINE NBR, AND WRITE TO  *  06320000
063300*    EST VAR FILE.                                             *  06330000
063400*  - IF ELC-CSR DATA IS NOT AVAILABLE FOR A PO LINE NBR, WRITE *  06340000
063500*    ERROR FILE RECORD.                                        *  06350000
063700*--------------------------------------------------------------*  06370000
063710 C200-PROCESS-PO-LINES.                                           06371000
063800                                                                  06380000
063900     PERFORM                                                      06390000
064000       UNTIL PURITM-PO-LNE-NBR > POLINE-PO-LNE-NBR                06400000
064100       OR END-OF-ELC-CSR                                          06410000
064200         IF PURITM-PO-LNE-NBR = POLINE-PO-LNE-NBR                 06420000
064300             IF VSCPT-ALW-CHRG-CDE = 'LCL'                        06430000
064400               AND NOT PV-VENDOR-NBR-LIFUNG                       06440000
064500                 NEXT SENTENCE                                    06450000
064600             ELSE                                                 06460000
064700                 PERFORM D200-FORMAT-EST-VARIANCE                 06470000
064800             END-IF                                               06480000
064900         END-IF                                                   06490000
065000         PERFORM R300-FETCH-ELC-CSR                               06500000
065100     END-PERFORM.                                                 06510000
065200                                                                  06520000
065300     IF EST-VAR-NOT-WROTE                                         06530000
065400         SET AP035-NO-ELC-FOR-LINE                                06540000
065500                                 TO TRUE                          06550000
065600         PERFORM D300-FORMAT-ELC-ERROR                            06560000
065700     END-IF.                                                      06570000
065800                                                                  06580000
065900     PERFORM R200-READ-PO-LINES.                                  06590000
066000                                                                  06600000
066300*--------------------------------------------------------------*  06630000
066400* FORMAT FIELDS ON APRD033 THAT ARE COMMON TO BOTH OUTPUT FILES*  06640000
066500*--------------------------------------------------------------*  06650000
066510 D100-FORMAT-IMPORT-RCPTS.                                        06651000
066520                                                                  06652000
066600     MOVE PV-HOLD-PO-NBR         TO AP033-PO-NBR.                 06660000
066700     MOVE PV-HOLD-REC-SEQ-NBR    TO AP033-REC-SEQ-NBR.            06670000
066800     MOVE ENTNME-ENT-NAME-DESC   TO AP033-VENDOR-NAME.            06680000
066900     MOVE EXTENT-DUN-NBR         TO AP033-VENDOR-NBR              06690000
067000                                    PV-VENDOR-NBR.                06700000
067100     MOVE PV-HOLD-FOB-CDE        TO AP033-FOB-CDE.                06710000
067200                                                                  06720000
067300     MOVE PV-PO-TOT-QTY          TO AP033-PO-TOT-QTY.             06730000
067400     MOVE PV-PO-TOT-COST         TO AP033-PO-ELC-COST-AMT.        06740000
067500     MOVE PV-PO-TOT-1ST-COST     TO AP033-PO-1ST-COST-AMT.        06750000
067600                                                                  06760000
067700     MOVE ZEROES                 TO PV-LCL-LOAD-PCT.              06770000
067800     IF PV-VENDOR-NBR-LIFUNG                                      06780000
067900         IF PV-TRIP-START-DATE = SPACES                           06790000
068000             IF PURCHS-OTB-PER-NBR <= '199811'                    06800000
068100                 MOVE 0.015      TO PV-LCL-LOAD-PCT               06810000
068200             END-IF                                               06820000
068300         ELSE                                                     06830000
068400             IF PV-TRIP-START-DATE < '1998-04-01'                 06840000
068500                 MOVE 0.015      TO PV-LCL-LOAD-PCT               06850000
068600             END-IF                                               06860000
068700         END-IF                                                   06870000
068800     END-IF.                                                      06880000
068900                                                                  06890000
069000     MOVE PV-LCL-LOAD-PCT        TO AP033-LCL-LOAD-PCT.           06900000
069100     MOVE PURCHS-STATUS-CDE      TO AP033-PO-STATUS-CDE.          06910000
069200     MOVE PURCHS-OTB-PER-NBR     TO AP033-OTB-PER-NBR.            06920000
069300                                                                  06930000
069600*--------------------------------------------------------------*  06960000
069700* FORMAT ESTIMATED VARIANCE RECORD(APRD034), WRITE IT,         *  06970000
069710* AND SET SWITCH.                                              *  06971000
069800*--------------------------------------------------------------*  06980000
069810 D200-FORMAT-EST-VARIANCE.                                        06981000
069900                                                                  06990000
070000     MOVE PV-HOLD-PO-NBR         TO AP034-PO-NBR.                 07000000
070100     MOVE POLINE-PO-LNE-NBR      TO AP034-PO-LNE-NBR.             07010000
070200     MOVE VSCPT-ALW-CHRG-CDE     TO AP034-ALW-CHRG-CDE.           07020000
070300                                                                  07030000
070400     IF VSCPT-ALW-CHRG-CDE = 'LCL'                                07040000
070500         IF PV-LCL-UNT-COST > ZEROES                              07050000
070600             COMPUTE AP034-REC-ELC-COST-AMT =                     07060000
070700                 (POLINE-REC-UNT-QTY * PV-LCL-UNT-COST) + .005    07070000
070800         ELSE                                                     07080000
070900             MOVE ZEROES         TO AP034-REC-ELC-COST-AMT        07090000
071000         END-IF                                                   07100000
071100     ELSE                                                         07110000
071200         COMPUTE AP034-REC-ELC-COST-AMT =                         07120000
071300              (POLINE-REC-UNT-QTY * VSCPT-CPT-CHRG-AMT) + .005    07130000
071400     END-IF.                                                      07140000
071500     MOVE POLINE-REC-UNT-QTY     TO AP034-REC-UNT-QTY.            07150000
071600     COMPUTE AP034-EST-ELC-COST-AMT = (PV-ELC-COST-AMT + .005).   07160000
071700     MOVE PV-ELC-UNT-QTY         TO AP034-EST-UNT-QTY.            07170000
071800     COMPUTE AP034-VAR-ELC-COST-AMT =                             07180000
071900              ( AP034-REC-ELC-COST-AMT - AP034-EST-ELC-COST-AMT). 07190000
072000     COMPUTE AP034-VAR-UNT-QTY =                                  07200000
072100              ( AP034-REC-UNT-QTY - AP034-EST-UNT-QTY ).          07210000
072200     MOVE PV-HOLD-AP-PRC-CDE     TO AP034-AP-PRC-CDE.             07220000
072300     MOVE PV-HOLD-FOB-CDE        TO AP034-FOB-CDE.                07230000
072400                                                                  07240000
072500     PERFORM W300-WRITE-EST-VARIANCE.                             07250000
072600     SET EST-VAR-WROTE           TO TRUE.                         07260000
072700                                                                  07270000
073000*--------------------------------------------------------------*  07300000
073100* FORMAT ELC ERROR RECORD(APRD035), AND WRITE IT               *  07310000
073200*--------------------------------------------------------------*  07320000
073210 D300-FORMAT-ELC-ERROR.                                           07321000
073220                                                                  07322000
073300     MOVE ENTNME-ENT-NAME-DESC   TO AP035-VENDOR-NAME.            07330000
073400     MOVE PV-HOLD-PO-NBR         TO AP035-PO-NBR.                 07340000
073500     MOVE POLINE-PO-LNE-NBR      TO AP035-PO-LNE-NBR.             07350000
073600                                                                  07360000
073700     PERFORM W400-WRITE-ELC-ERROR.                                07370000
073800                                                                  07380000
074100*--------------------------------------------------------------*  07410000
074200* READ THE IMPORT PO RECEIVING FILE                            *  07420000
074300*--------------------------------------------------------------*  07430000
074310 R100-READ-PO-RCPTS.                                              07431000
074400                                                                  07440000
074500     MOVE 'R100-READ-PO-RCPTS'  TO AA-PARAGRAPH-NAME.             07450000
074700     IF NOT END-OF-PO-RCPTS                                       07470000
074800        READ PO-RCPTS-FILE INTO AP032-RECORD                      07480000
074900          AT END  SET END-OF-PO-RCPTS TO TRUE.                    07490000
075100     IF NOT END-OF-PO-RCPTS                                       07510000
075200        ADD 1 TO PV-PO-RCPTS-READ.                                07520000
075300                                                                  07530000
075500*--------------------------------------------------------------*  07550000
075600* READ THE IMPORT PO RECEIVING BY PO LINE FILE                 *  07560000
075700*--------------------------------------------------------------*  07570000
075710 R200-READ-PO-LINES.                                              07571000
075800                                                                  07580000
075900     MOVE 'R200-READ-PO-LINES'   TO AA-PARAGRAPH-NAME.            07590000
076000                                                                  07600000
076100     IF NOT END-OF-PO-LINES                                       07610000
076200         READ PO-LINES-FILE INTO POLINE-RECORD                    07620000
076300           AT END  SET END-OF-PO-LINES TO TRUE.                   07630000
076400                                                                  07640000
076500     IF NOT END-OF-PO-LINES                                       07650000
076600         SET EST-VAR-NOT-WROTE   TO TRUE                          07660000
076700         ADD 1 TO PV-PO-LINES-READ.                               07670000
076800                                                                  07680000
077100*--------------------------------------------------------------*  07710000
077200* RETRIEVES THE ELC CURSER DATA                                *  07720000
077300* NOTE:  A NOT FOUND CONDITION:                                *  07730000
077400*        ON THE FIRST FETCH, SETS AN EMPTY CURSOR SWITCH.      *  07740000
077500*        ON ANY OTHER FETCH, SETS AN END OF CURSOR SWITCH.     *  07750000
077600*--------------------------------------------------------------*  07760000
077610 R300-FETCH-ELC-CSR.                                              07761000
077700                                                                  07770000
077800     EXEC SQL                                                     07780000
077900         FETCH   ELC_CSR                                          07790000
078000         INTO    :PURITM-PO-LNE-NBR                               07800000
078100                ,:VSCPT-ALW-CHRG-CDE                              07810000
078200                ,:VSCPT-CPT-CHRG-AMT                              07820000
078300                ,:PV-ELC-UNT-QTY                                  07830000
078400                ,:PV-ELC-COST-AMT                                 07840000
078500     END-EXEC.                                                    07850000
078600                                                                  07860000
078700     EVALUATE TRUE                                                07870000
078800         WHEN SQLCODE = ZERO                                      07880000
078900              SET FOUND-ELC-ROWS TO TRUE                          07890000
079000                                                                  07900000
079100         WHEN SQLCODE = +100                                      07910000
079200              IF FOUND-ELC-ROWS                                   07920000
079300                  SET END-OF-ELC-CSR TO TRUE                      07930000
079400              ELSE                                                07940000
079500                  SET EMPTY-ELC-CSR TO TRUE                       07950000
079600              END-IF                                              07960000
079700              INITIALIZE PURITM-PO-LNE-NBR                        07970000
079800                         VSCPT-ALW-CHRG-CDE                       07980000
079900                         VSCPT-CPT-CHRG-AMT                       07990000
080000                         PV-ELC-UNT-QTY                           08000000
080100                         PV-ELC-COST-AMT                          08010000
080200                                                                  08020000
080300         WHEN SQLWARN0 NOT = SPACES                               08030000
080400         WHEN SQLCODE  NOT = ZERO                                 08040000
080500             MOVE 'R300-FETCH-ELC-CSR'                            08050000
080600                                 TO AA-PARAGRAPH-NAME             08060000
080700             MOVE 'UNSUCCESSFUL FETCH WITH ELC_CSR'               08070000
080800                                 TO AA-DB2-OPERATION              08080000
080900             MOVE 'TPURITM'      TO AA-DB2-TABLE-1                08090000
081000             MOVE 'TVSCPT'       TO AA-DB2-TABLE-2                08100000
081100             INITIALIZE             AA-DB2-TABLE-3                08110000
081200                                    AA-DB2-TABLE-4                08120000
081300             PERFORM Z998-DB2-ABEND                               08130000
081400     END-EVALUATE.                                                08140000
081500                                                                  08150000
081800*--------------------------------------------------------------*  08180000
081900* RETRIEVES VENDOR DATA FOR PO BEING PROCESSED.                *  08190000
082000*--------------------------------------------------------------*  08200000
082010 S100-GET-VENDOR-DATA.                                            08201000
082100                                                                  08210000
082200     EXEC SQL                                                     08220000
082300         SELECT  DUN_NBR                                          08230000
082400                ,ENT_NAME_DESC                                    08240000
082500                ,PR.OTB_PER_NBR                                   08250000
082600                ,PR.STATUS_CDE                                    08260000
082700         INTO    :EXTENT-DUN-NBR                                  08270000
082800                ,:ENTNME-ENT-NAME-DESC                            08280000
082900                ,:PURCHS-OTB-PER-NBR                              08290000
083000                ,:PURCHS-STATUS-CDE                               08300000
083100         FROM    TPURCHS PR                                       08310000
083200                ,TEXTENT EX                                       08320000
083300                ,TENTNME NM                                       08330000
083400         WHERE   PR.PO_NBR   = :PV-HOLD-PO-NBR                    08340000
083500           AND   PR.ENT_ID   = EX.ENT_ID                          08350000
083600           AND   EX.ENT_ID   = NM.ENT_ID                          08360000
083700           AND   PR.VER_STATUS_CDE = 'A'                          08370000
083800           AND   NM.TYPE_CDE = '01'                               08380000
083900     END-EXEC.                                                    08390000
084000                                                                  08400000
084100     EVALUATE TRUE                                                08410000
084200         WHEN SQLCODE = ZERO                                      08420000
084300             CONTINUE                                             08430000
084400                                                                  08440000
084500         WHEN SQLCODE = +100                                      08450000
084600             MOVE 'NO VENDOR PRIMARY NAME FOUND  '                08460000
084700                                 TO ENTNME-ENT-NAME-DESC          08470000
084800             MOVE SPACES         TO EXTENT-DUN-NBR                08480000
084900                                    PURCHS-OTB-PER-NBR            08490000
085000                                    PURCHS-STATUS-CDE             08500000
085100                                                                  08510000
085200         WHEN SQLWARN0 NOT = SPACES                               08520000
085300         WHEN SQLCODE  NOT = ZERO                                 08530000
085400             MOVE 'S100-GET-VENDOR-DATA'                          08540000
085500                                 TO AA-PARAGRAPH-NAME             08550000
085600             MOVE 'UNSUCCESSFUL SELECT'                           08560000
085700                                 TO AA-DB2-OPERATION              08570000
085800             MOVE 'TPURCHS'               TO AA-DB2-TABLE-1       08580000
085900             MOVE 'TEXTENT'               TO AA-DB2-TABLE-2       08590000
086000             MOVE 'TENTNME'               TO AA-DB2-TABLE-3       08600000
086100             INITIALIZE                      AA-DB2-TABLE-4       08610000
086200             PERFORM Z998-DB2-ABEND                               08620000
086300     END-EVALUATE.                                                08630000
086400                                                                  08640000
086600*--------------------------------------------------------------*  08660000
086700* RETRIEVES SUMMARIZED DATA FOR THE PO BEING PROCESSED.        *  08670000
086800*--------------------------------------------------------------*  08680000
086810 S200-GET-PO-TOTALS.                                              08681000
086900                                                                  08690000
087000     EXEC SQL                                                     08700000
087100         SELECT  SUM(UNT_QTY)                                     08710000
087200                ,SUM(UNT_QTY * UNT_COST_AMT)                      08720000
087300                ,SUM(UNT_QTY * PRD_1ST_COST_AMT)                  08730000
087400         INTO    :PV-PO-TOT-QTY                                   08740000
087500                ,:PV-PO-TOT-COST                                  08750000
087600                ,:PV-PO-TOT-1ST-COST                              08760000
087700         FROM    TPURITM                                          08770000
087800         WHERE   PO_NBR              = :PV-HOLD-PO-NBR            08780000
087900           AND   VER_STATUS_CDE      = 'A'                        08790000
088000           AND   STATUS_CDE          IN ('AC','AP','CB','CM','RV')08800000
088100     END-EXEC.                                                    08810000
088200                                                                  08820000
088300     EVALUATE TRUE                                                08830000
088400         WHEN SQLCODE = ZERO                                      08840000
088500             CONTINUE                                             08850000
088600                                                                  08860000
088700         WHEN SQLCODE = +100                                      08870000
088800         WHEN SQLCODE = -305                                      08880000
088900             INITIALIZE PV-PO-TOT-QTY                             08890000
089000                        PV-PO-TOT-COST                            08900000
089100                        PV-PO-TOT-1ST-COST                        08910000
089200                                                                  08920000
089300         WHEN SQLWARN0 NOT = SPACES                               08930000
089400         WHEN SQLCODE  NOT = ZERO                                 08940000
089500             MOVE 'S200-GET-PO-TOTALS'                            08950000
089600                                 TO AA-PARAGRAPH-NAME             08960000
089700             MOVE 'UNSUCCESSFUL SELECT'                           08970000
089800                                 TO AA-DB2-OPERATION              08980000
089900             MOVE 'TPURITM'      TO AA-DB2-TABLE-1                08990000
090000             INITIALIZE             AA-DB2-TABLE-2                09000000
090100                                    AA-DB2-TABLE-3                09010000
090200                                    AA-DB2-TABLE-4                09020000
090300             PERFORM Z998-DB2-ABEND                               09030000
090400     END-EVALUATE.                                                09040000
090500                                                                  09050000
090700*--------------------------------------------------------------*  09070000
090800* RETRIEVES POSTRR DATA AND SETS THE PROCESSING CODE FOR THE   *  09080000
090900* PO BEING PROCESSED.                                          *  09090000
091000*--------------------------------------------------------------*  09100000
091010 S300-GET-POSTRR.                                                 09101000
091100                                                                  09110000
091200     EXEC SQL                                                     09120000
091300         SELECT  PO_NBR                                           09130000
091400         INTO    :POSTRR-PO-NBR                                   09140000
091500         FROM    TPOSTRR                                          09150000
091600         WHERE   PO_NBR       = :PV-HOLD-PO-NBR                   09160000
091700           AND   STATUS_CDE   = ' '                               09170000
091800           AND   MTCH_LVL_CDE = 'P'                               09180000
091900     END-EXEC.                                                    09190000
092000                                                                  09200000
092100     EVALUATE TRUE                                                09210000
092200         WHEN SQLCODE = ZERO                                      09220000
092300             MOVE 'M'            TO PV-HOLD-AP-PRC-CDE            09230000
092400                                                                  09240000
092500         WHEN SQLCODE = +100                                      09250000
092600             MOVE ' '            TO PV-HOLD-AP-PRC-CDE            09260000
092700                                                                  09270000
092800         WHEN SQLWARN0 NOT = SPACES                               09280000
092900         WHEN SQLCODE  NOT = ZERO                                 09290000
093000             MOVE 'S300-GET-POSTRR'                               09300000
093100                                 TO AA-PARAGRAPH-NAME             09310000
093200             MOVE 'UNSUCCESSFUL SELECT'                           09320000
093300                                 TO AA-DB2-OPERATION              09330000
093400             MOVE 'TPOSTRR'      TO AA-DB2-TABLE-1                09340000
093500             INITIALIZE             AA-DB2-TABLE-2                09350000
093600                                    AA-DB2-TABLE-3                09360000
093700                                    AA-DB2-TABLE-4                09370000
093800             PERFORM Z998-DB2-ABEND                               09380000
093900     END-EVALUATE.                                                09390000
094000                                                                  09400000
094200*--------------------------------------------------------------*  09420000
094300* RETRIEVES THE FOB CODE FOR THE PO BEING PROCESSED            *  09430000
094400*--------------------------------------------------------------*  09440000
094410 S400-GET-FOB.                                                    09441000
094500                                                                  09450000
094600     EXEC SQL                                                     09460000
094700         SELECT FOB_CDE                                           09470000
094800         INTO :PLNSHP-FOB-CDE                                     09480000
094900         FROM TPLNSHP                                             09490000
095000         WHERE PO_NBR = :PV-HOLD-PO-NBR                           09500000
095100           AND VER_STATUS_CDE = 'A'                               09510000
095200     END-EXEC.                                                    09520000
095300                                                                  09530000
095400     EVALUATE TRUE                                                09540000
095500         WHEN SQLCODE = ZERO                                      09550000
095600             MOVE PLNSHP-FOB-CDE TO PV-HOLD-FOB-CDE               09560000
095700                                                                  09570000
095800         WHEN SQLCODE = +100                                      09580000
095900         WHEN SQLWARN0 NOT = SPACES                               09590000
096000         WHEN SQLCODE NOT  = ZERO                                 09600000
096100             DISPLAY 'PO NUMBER :' PV-HOLD-PO-NBR                 09610000
096200             MOVE 'S400-GET-FOB'                                  09620000
096300                                 TO AA-PARAGRAPH-NAME             09630000
096400             MOVE 'UNSUCCESSFUL SELECT'                           09640000
096500                                 TO AA-DB2-OPERATION              09650000
096600             MOVE 'TPLNSHP'      TO AA-DB2-TABLE-1                09660000
096700             INITIALIZE             AA-DB2-TABLE-2                09670000
096800                                    AA-DB2-TABLE-3                09680000
096900                                    AA-DB2-TABLE-4                09690000
097000             PERFORM Z998-DB2-ABEND                               09700000
097100     END-EVALUATE.                                                09710000
097200                                                                  09720000
097400*--------------------------------------------------------------*  09740000
097500* RETRIEVES THE TRIP START DATE FOR THE PO BEING PROCESSED     *  09750000
097600*--------------------------------------------------------------*  09760000
097610 S500-GET-TRIP-START.                                             09761000
097700                                                                  09770000
097800     EXEC SQL                                                     09780000
097900         SELECT TRIP_STRT_DTE                                     09790000
098000         INTO :ELCPO-TRIP-STRT-DTE                                09800000
098100         FROM TELCPO                                              09810000
098200         WHERE PO_NBR = :PV-HOLD-PO-NBR                           09820000
098300     END-EXEC.                                                    09830000
098400                                                                  09840000
098500     EVALUATE TRUE                                                09850000
098600         WHEN SQLCODE = ZERO                                      09860000
098700             MOVE ELCPO-TRIP-STRT-DTE                             09870000
098800                                 TO PV-TRIP-START-DATE            09880000
098900                                                                  09890000
099000         WHEN SQLCODE = +100                                      09900000
099100             MOVE SPACES         TO PV-TRIP-START-DATE            09910000
099200         WHEN SQLWARN0 NOT = SPACES                               09920000
099300         WHEN SQLCODE NOT  = ZERO                                 09930000
099400             DISPLAY 'PO NUMBER :' PV-HOLD-PO-NBR                 09940000
099500             MOVE 'S500-GET-TRIP-START'                           09950000
099600                                 TO AA-PARAGRAPH-NAME             09960000
099700             MOVE 'UNSUCCESSFUL SELECT'                           09970000
099800                                 TO AA-DB2-OPERATION              09980000
099900             MOVE 'TELCPO '      TO AA-DB2-TABLE-1                09990000
100000             INITIALIZE             AA-DB2-TABLE-2                10000000
100100                                    AA-DB2-TABLE-3                10010000
100200                                    AA-DB2-TABLE-4                10020000
100300             PERFORM Z998-DB2-ABEND                               10030000
100400     END-EVALUATE.                                                10040000
100500                                                                  10050000
100600                                                                  10060000
100700*--------------------------------------------------------------*  10070000
100800* WRITE THE RECEIPTS SUMMED BY RECEIVER SEQUENCE RECORD.       *  10080000
100900*--------------------------------------------------------------*  10090000
100910 W100-WRITE-RCPTS-BY-RCVR-SEQ.                                    10091000
101000                                                                  10100000
101100     WRITE RCVR-SEQ-SUMM-REC FROM AP033-RECORD.                   10110000
101200     ADD 1 TO PV-RCVR-SEQ-WRITTEN.                                10120000
101300                                                                  10130000
101600*--------------------------------------------------------------*  10160000
101700* WRITE THE RECEIPTS SUMMED BY PO NUMBER RECORD.               *  10170000
101800*--------------------------------------------------------------*  10180000
101810 W200-WRITE-RCPTS-BY-PO.                                          10181000
101900                                                                  10190000
102000     WRITE PO-SUMM-REC FROM AP033-RECORD.                         10200000
102100     ADD 1 TO PV-PO-LINE-WRITTEN.                                 10210000
102200                                                                  10220000
102400*--------------------------------------------------------------*  10240000
102500* WRITE THE ESTIMATED VARIANCE RECORD.                         *  10250000
102600*--------------------------------------------------------------*  10260000
102610 W300-WRITE-EST-VARIANCE.                                         10261000
102700                                                                  10270000
102800     WRITE EST-VARIANCE-REC FROM AP034-RECORD.                    10280000
102900     ADD 1 TO PV-EST-VAR-WRITTEN.                                 10290000
103000                                                                  10300000
103200*--------------------------------------------------------------*  10320000
103300* WRITE THE ESTIMATED LANDED COST ERROR RECORD.                *  10330000
103400*--------------------------------------------------------------*  10340000
103410 W400-WRITE-ELC-ERROR.                                            10341000
103500                                                                  10350000
103600     WRITE ELC-ERROR-REC FROM AP035-RECORD.                       10360000
103700     ADD 1 TO PV-ERRORS-WRITTEN.                                  10370000
103800                                                                  10380000
104000*-------------------------------------------------------------*   10400000
104100* OPEN ELC_CSR CURSOR                                         *   10410000
104200*-------------------------------------------------------------*   10420000
104210 X100-OPEN-ELC-CSR.                                               10421000
104300                                                                  10430000
104400     EXEC SQL                                                     10440000
104500         OPEN ELC_CSR                                             10450000
104600     END-EXEC.                                                    10460000
104700                                                                  10470000
104800     EVALUATE TRUE                                                10480000
104900         WHEN SQLCODE = ZERO                                      10490000
105000             SET NEW-ELC-ROWS                                     10500000
105100                 NEW-ELC-CSR             TO TRUE                  10510000
105200                                                                  10520000
105300         WHEN SQLWARN0 NOT = SPACES                               10530000
105400         WHEN SQLCODE  NOT = ZERO                                 10540000
105500             MOVE 'X100-OPEN-ELC-CSR'                             10550000
105600                                 TO AA-PARAGRAPH-NAME             10560000
105700             MOVE 'UNSUCCESSFUL OPEN ON ELC_CSR'                  10570000
105800                                 TO AA-DB2-OPERATION              10580000
105900             MOVE 'TPURITM'      TO AA-DB2-TABLE-1                10590000
106000             MOVE 'TVSCPT'       TO AA-DB2-TABLE-2                10600000
106100             INITIALIZE             AA-DB2-TABLE-3                10610000
106200                                    AA-DB2-TABLE-4                10620000
106300             PERFORM Z998-DB2-ABEND                               10630000
106400     END-EVALUATE.                                                10640000
106500                                                                  10650000
106800*--------------------------------------------------------------*  10680000
106900* CLOSE THE ELC_CSR CURSOR                                     *  10690000
107000*--------------------------------------------------------------*  10700000
107010 X200-CLOSE-ELC-CSR.                                              10701000
107100                                                                  10710000
107200     EXEC SQL                                                     10720000
107300         CLOSE ELC_CSR                                            10730000
107400     END-EXEC.                                                    10740000
107500                                                                  10750000
107600       EVALUATE TRUE                                              10760000
107700           WHEN SQLCODE = ZERO                                    10770000
107800                CONTINUE                                          10780000
107900                                                                  10790000
108000           WHEN SQLWARN0 NOT = SPACES                             10800000
108100           WHEN SQLCODE  NOT = ZERO                               10810000
108200               MOVE 'X200-CLOSE-ELC-CSR'                          10820000
108300                                   TO AA-PARAGRAPH-NAME           10830000
108400               MOVE 'UNSUCCESSFUL CLOSE ON ELC_CSR'               10840000
108500                                   TO AA-DB2-OPERATION            10850000
108600               MOVE 'TPURITM'      TO AA-DB2-TABLE-1              10860000
108700               MOVE 'TVSCPT'       TO AA-DB2-TABLE-2              10870000
108800               INITIALIZE             AA-DB2-TABLE-3              10880000
108900                                      AA-DB2-TABLE-4              10890000
109000               PERFORM Z998-DB2-ABEND                             10900000
109100       END-EVALUATE.                                              10910000
109200                                                                  10920000
109400*--------------------------------------------------------------*  10940000
109500* ABEND ROUTINE FOR DB2 ERRORS                                 *  10950000
109600*--------------------------------------------------------------*  10960000
109610 Z998-DB2-ABEND.                                                  10961000
109700                                                                  10970000
109800     CLOSE PO-RCPTS-FILE                                          10980000
109900           PO-LINES-FILE                                          10990000
110000           RCVR-SEQ-SUMM-FILE                                     11000000
110100           PO-SUMM-FILE                                           11010000
110200           EST-VARIANCE-FILE                                      11020000
110300           ELC-ERROR-FILE.                                        11030000
110400                                                                  11040000
110500     DISPLAY AA-ABEND-LIT.                                        11050000
110600     DISPLAY AA-DB2-ERROR-LIT.                                    11060000
110700     DISPLAY AA-PROGRAM-LIT.                                      11070000
110800     DISPLAY AA-PARAGRAPH-LIT.                                    11080000
110900     DISPLAY AA-DB2-OPERATION-LIT.                                11090000
111000     DISPLAY AA-DB2-TABLE-1.                                      11100000
111100     DISPLAY AA-DB2-TABLE-2.                                      11110000
111200     DISPLAY AA-DB2-TABLE-3.                                      11120000
111300     DISPLAY AA-DB2-TABLE-4.                                      11130000
111400     DISPLAY '*****                PO = ' PV-HOLD-PO-NBR.         11140000
111500     DISPLAY '*****           PO LINE = ' AP032-PO-LNE-NBR.       11150000
111600     DISPLAY '*****          RCVR SEQ = ' PV-HOLD-REC-SEQ-NBR.    11160000
111700     SET AC-DB2-ERROR TO TRUE.                                    11170000
111800                                                                  11180000
111900     COPY DPPD004.                                                11190000
112000                                                                  11200000
112100     CALL 'ILBOABN0' USING ABEND-CODE.                            11210000
112200                                                                  11220000
