000020******************************************************************00010000
000030 IDENTIFICATION DIVISION.                                         00020000
000040******************************************************************00030000
000050*  I M P O R T A N T --- WHEN COMPILING THIS PROGRAM THE SOCKET  *00040000
000060* SWITCH ON THE 2ND COMPILE SCREEN NEEDS TO BE SET TO 'Y'.  THIS *00050000
000070* PROGRAM IS USING "EZASOKET".                                   *00060000
000080******************************************************************00070000
000090                                                                  00080000
000100 PROGRAM-ID.             SUKRF707.                                00090000
000200 AUTHOR.                 CHERI PARMLEY.                           00100000
000300 INSTALLATION.           KOHLS.                                   00110000
000400 DATE-WRITTEN            JULY 12, 2013.                           00120000
000500 DATE-COMPILED.                                                   00130000
000600                                                                  00140000
000700******************************************************************00150000
000800* THIS PROGRAM DISPLAYS THE LABEL PRINT SCREEN ON THE             00160000
000900* LRT (LASER RADIO TERMINAL) AND ACCEPTS AN F-KEY.                00170000
001000* THE ASSOCIATE CAN PRINT SML, P2L OR CENTRAL STOCK LABELS.       00180000
001000* THIS IS A CLONE OF SUKRF527 AND USED FOR THE RFID FINAL LABEL   00190000
001000* REQUEST FUNTION. OPTION 5 OFF THE UCC128 MENU                   00200000
000700******************************************************************00210000
001000* THE HEADER AND TRAILER OPTIONS WILL BE TURNED OFF FOR SOME OF   00220000
001000* THE DC'S THEY WILL BE ON THE TKPPRPM TABLE TO DETERMINE IF THEY 00230000
001000* PRINT OR NOT.                                                   00240000
001000* THIS PROGRAM WILL NOT INCLUDE ANY RFID PROCESSING               00250000
001100******************************************************************00260000
001200* 07/12/2013  CHERI PARMLEY         CRQ# 0058309                 *00270000
001300*             INITIAL VERSION                                     00280000
001500                                                                  00290000
001100******************************************************************00300019
001200* 06/24/2015  CHERI PARMLEY         CHG0120422                   *00310021
001300*             REPLACING THE MDSE_PGM_DESC to LBL_MSG_TXT          00320020
001600******************************************************************00330000
176459* 07/20/2013  JIM ARENDT            CHG0176459                   *00340023
176459*             THIS PROGRAM NEEDED TO BE COMPILED DUE TO COPYBOOK  00350023
176459*             PCWS169 CHANGING LENGTHS DUE TO RFID/EAS PROJECT.   00360023
001600******************************************************************00360124
263968* CHANGED 11/16/2021    BY JIM HUNTER      WR: CHG0263968         00362024
263968* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00363024
263968* MAKING THE CALL DYNAMIC VS STATIC.                              00364024
002160******************************************************************00370023
001700 ENVIRONMENT DIVISION.                                            00380000
001800******************************************************************00390000
001900                                                                  00400000
001910******************************************************************00410000
001920 DATA DIVISION.                                                   00420000
001930******************************************************************00430000
001940                                                                  00440000
001950******************************************************************00450000
001960 WORKING-STORAGE SECTION.                                         00460000
001970******************************************************************00470000
001980 01  CA-COMMAREA.                                                 00480000
001990     COPY SUWS001.                                                00490000
002000                                                                  00500000
002100*----------------------------------------------------------------*00510000
002200*  DB2 KEYS                                                      *00520000
002300*----------------------------------------------------------------*00530000
002400 01  DK-DB2-KEYS.                                                 00540000
002500     05  DK-TRIP-ID                      PIC  S9(09)  COMP.       00550000
002600     05  DK-USER-ID                      PIC   X(08).             00560000
002700     05  DK-BATCH-NUMBER                 PIC  S9(04)  COMP.       00570000
002800     05  DK-MANIFEST                     PIC  S9(09)  COMP.       00580000
002900     05  DK-LPMS-TRANS-ID                PIC  S9(09)  COMP.       00590000
003000     05  DK-CURR-OPER-UNT-ID             PIC  S9(04)  COMP        00600000
003100                                              VALUE +0.           00610000
003200     05  DK-BARCODE-NBR                  PIC  X(22).              00620000
003300*----------------------------------------------------------------*00630000
003400*SOCKET COMMANDS CODES NEED FOR THE TCP/IP SOCKET CALLS-EZASOKET *00640000
003500*----------------------------------------------------------------*00650000
003600     COPY DPWS081.                                                00660000
003700                                                                  00670000
003800*---------------------------------------------------------------* 00680000
003900* COPYBOOK FOR LOGISTICS DOMAIN ITEM ACCESS MODULE              * 00690000
004000*---------------------------------------------------------------* 00700000
004100     COPY XLWS001.                                                00710000
004200                                                                  00720000
004300*---------------------------------------------------------------* 00730000
004400* COPYBOOK FOR MODULE TO SECURE SEQ #'S FOR ASSIGNMENTS         * 00740000
004500*         DLKUP001                                              * 00750000
004600*---------------------------------------------------------------* 00760000
004700     COPY DLWS001.                                                00770000
004800                                                                  00780000
004900*---------------------------------------------------------------* 00790000
005000* COPYBOOK FOR WRITE DATA TO EAI EXPORT TABLE MODULE (XLKUP033) * 00800000
005100*---------------------------------------------------------------* 00810000
005200     COPY XLWS072.                                                00820000
005300*---------------------------------------------------------------* 00830000
005400* COPYBOOK TO DETERMINE CURRENT STORE ON HAND (XLKUT088)        * 00840000
005500*---------------------------------------------------------------* 00850000
005600     COPY XLWS088.                                                00860000
005700                                                                  00870000
005800*---------------------------------------------------------------* 00880000
005900     COPY SUWS050.                                                00890000
006000                                                                  00900000
006100*----------------------------------------------------------------*00910000
006200*                                                                *00920000
006300*----------------------------------------------------------------*00930000
006400 01  CONNECT-ERR.                                                 00940000
006500     05  FILLER                       PIC X(12)                   00950000
006600         VALUE ' SUKRF707 - '.                                    00960000
006700     05  FILLER                       PIC X(24)                   00970000
006800         VALUE 'CONNECT-SOCKET FAILED   '.                        00980000
006900     05  FILLER                       PIC X(9)                    00990000
007000         VALUE ' ERRNO = '.                                       01000000
007100     05  CONNECT-ERRNO                PIC 9(8).                   01010000
007200                                                                  01020000
007300                                                                  01030000
007400*----------------------------------------------------------------*01040000
007500*                                                                *01050000
007600*----------------------------------------------------------------*01060000
007700 01  RECEIVE-ERR.                                                 01070000
007800     05  FILLER                       PIC X(10)                   01080000
007900         VALUE ' SUKRF707-'.                                      01090000
008000     05  FILLER                       PIC X(17)                   01100000
008100         VALUE 'RCV CNFRM FAILED '.                               01110000
008200     05  FILLER                       PIC X(7)                    01120000
008300         VALUE ' ERRNO='.                                         01130000
008400     05  RECEIVE-RETCODE              PIC 9(10)-.                 01140000
008500     05  FILLER                       PIC X(2) VALUE SPACES.      01150000
008600     05  RECEIVE-ERRNO                PIC 9(8).                   01160000
008700     05  FILLER                       PIC X(2) VALUE SPACES.      01170000
008800     05  RECEIVE-RECEIVER             PIC 9(8).                   01180000
008900     05  FILLER                       PIC X(1) VALUE '-'.         01190000
009000     05  RECEIVE-SEQ                  PIC 9(3).                   01200000
009100     05  FILLER                       PIC X(1) VALUE '-'.         01210000
009200     05  RECEIVE-LINE                 PIC 9(4).                   01220000
009300                                                                  01230000
009400*----------------------------------------------------------------*01240000
009500*                                                                *01250000
009600*----------------------------------------------------------------*01260000
009700 01  SOCKET-SELECT-ERR.                                           01270000
009800     05  FILLER                       PIC X(10)                   01280000
009900         VALUE ' SUKRF707-'.                                      01290000
010000     05  FILLER                       PIC X(14)                   01300000
010100         VALUE 'SOCKET SELECT-'.                                  01310000
010200     05  FILLER                       PIC X(7)                    01320000
010300         VALUE '-RETCD='.                                         01330000
010400     05  SOCKET-RETCODE               PIC 9(10)-.                 01340000
010500     05  FILLER                       PIC X(2) VALUE SPACES.      01350000
010600     05  SOCKET-ERRNO                 PIC 9(8).                   01360000
010700     05  FILLER                       PIC X(2) VALUE SPACES.      01370000
010800     05  SOCKET-RECEIVER              PIC 9(8).                   01380000
010900     05  FILLER                       PIC X(1) VALUE '-'.         01390000
011000     05  SOCKET-SEQ                   PIC 9(3).                   01400000
011100     05  FILLER                       PIC X(1) VALUE '-'.         01410000
011200     05  SOCKET-LINE                  PIC 9(4).                   01420000
011300     05  FILLER                       PIC X(1) VALUE '-'.         01430000
011400     05  SOCKET-DESCR                 PIC X(20).                  01440000
011500                                                                  01450000
011600*----------------------------------------------------------------*01460000
011700*                                                                *01470000
011800*----------------------------------------------------------------*01480000
011900 01  ERROR-DETAILS.                                               01490000
012000     05  FILLER                   PIC X(12)  VALUE ' SUKRF707-'.  01500000
012100     05  FILLER                   PIC X(05)  VALUE 'PRTR-'.       01510000
012200     05  ERR-MSG-PRINTER          PIC X(03).                      01520000
012300     05  FILLER                   PIC X(01)  VALUE ' '.           01530000
012400     05  ERR-MSG-OPER             PIC 9(04).                      01540000
012500     05  FILLER                   PIC X(01)  VALUE '-'.           01550000
012600     05  ERR-MSG-PO               PIC 9(09).                      01560000
012700     05  FILLER                   PIC X(01)  VALUE '-'.           01570000
012800     05  ERR-MSG-RCVR             PIC 9(04).                      01580000
012900     05  FILLER                   PIC X(07)  VALUE '  TRIP-'.     01590000
013000     05  ERR-MSG-TRIP             PIC 9(09).                      01600000
013100     05  FILLER                   PIC X(06)  VALUE ' USER-'.      01610000
013200     05  ERR-MSG-USERID           PIC X(07).                      01620000
013300     05  FILLER                   PIC X(07)  VALUE ' BATCH-'.     01630000
013400     05  ERR-MSG-BATCH            PIC 9(04).                      01640000
013500                                                                  01650000
013600                                                                  01660000
013700                                                                  01670000
013800 01  TCP-BUF2.                                                    01680000
013900     05 TCP-BUF                          PIC  X(05)  VALUE SPACE. 01690000
014000     05 TCP-BUF-DATA                     PIC X(299)  VALUE SPACE. 01700000
014100                                                                  01710000
014200                                                                  01720000
014300*----------------------------------------------------------------*01730000
014400*  PROGRAM CONSTANTS                                             *01740000
014500*----------------------------------------------------------------*01750000
014600 01  PC-PROGRAM-CONSTANTS.                                        01760000
014700*    05  PC-COMMAREA-LENGTH          PIC S9(04)  VALUE +300 COMP. 01770000
014800     05  PV-COMMAREA-LENGTH          PIC S9(04)  VALUE +0         01780000
014900                                                       COMP SYNC. 01790000
015000     05  PV-RETRY-COUNTER            PIC S9(04)  VALUE ZERO       01800000
015100                                                    COMP SYNC.    01810000
015200     05  PC-MAX-RETRIES              PIC S9(03)  VALUE 3          01820000
015300                                               COMP-3.            01830000
015400     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)  VALUE 'SUKRF707'.01840000
015500     05  PC-SU-PRT-DISPLAY           PIC  X(04)  VALUE 'S707'.    01850000
003560     05  PC-SU-RFID-CONTROL-PGM      PIC  X(08)  VALUE 'SUKRF705'.01860000
015800     05  PC-PRTR-VALIDATION-PGM      PIC  X(08)  VALUE 'DPKCS060'.01870000
015900     05  PC-REPORT-PGM-1             PIC  X(08)  VALUE 'PCKCS126'.01880000
016000     05  PC-REPORT-PGM-2             PIC  X(08)  VALUE 'SUKRF707'.01890000
016100     05  PC-RANDOM-PGM               PIC  X(08)  VALUE 'DPKUT902'.01900000
016200                                                                  01910000
016300     05  PC-HEADER-LBL-APPL          PIC  X(03)  VALUE 'HDR'.     01920000
016400     05  PC-CARTON-LBL-APPL          PIC  X(03)  VALUE 'CRT'.     01930000
016500     05  PC-CHECK-IN-LBL-APPL        PIC  X(03)  VALUE 'CKN'.     01940000
016600     05  PC-PGYBK-LBL-APPL           PIC  X(03)  VALUE 'PBK'.     01950000
016700     05  PC-P2L-LBL-APPL             PIC  X(03)  VALUE 'P2L'.     01960000
016800     05  PC-SML-DC-LBL-APPL          PIC  X(03)  VALUE 'SMD'.     01970000
016900     05  PC-SML-STORE-LBL-APPL       PIC  X(03)  VALUE 'SMS'.     01980000
017000     05  PC-SHIP-DC-LBL-APPL         PIC  X(03)  VALUE 'SHD'.     01990000
017100     05  PC-SHIP-STORE-LBL-APPL      PIC  X(03)  VALUE 'SHS'.     02000000
017200     05  PC-USER-ID-LBL-APPL         PIC  X(03)  VALUE 'UID'.     02010000
017300     05  PC-SOCKET-INTERFACE         PIC  X(01)  VALUE 'S'.       02020000
017400     05  PC-FTP-INTERFACE            PIC  X(01)  VALUE 'F'.       02030000
017500     05  PC-CARTON                   PIC  X(20)  VALUE 'CARTON'.  02040000
017600     05  PC-CHECKIN-PRINT            PIC  X(20)  VALUE            02050000
017700         'CHECKIN PRINT       '.                                  02060000
017800                                                                  02070000
017900     05  PC-A                        PIC  X(01)  VALUE 'A'.       02080000
018000     05  PC-C                        PIC  X(01)  VALUE 'C'.       02090000
018100     05  PC-D                        PIC  X(01)  VALUE 'D'.       02100000
018200     05  PC-SPACE                    PIC  X(01)  VALUE ' '.       02110000
018300     05  PC-Q                        PIC  X(01)  VALUE 'Q'.       02120000
018400     05  PC-MGMX                     PIC  X(04)  VALUE 'MGMX'.    02130000
018500     05  PC-N                        PIC  X(01)  VALUE 'N'.       02140000
018600     05  PC-R                        PIC  X(01)  VALUE 'R'.       02150000
018700     05  PC-T                        PIC  X(01)  VALUE 'T'.       02160000
018800     05  PC-Y                        PIC  X(01)  VALUE 'Y'.       02170000
018900     05  PC-K                        PIC  X(01)  VALUE 'K'.       02180000
019000     05  PC-G                        PIC  X(01)  VALUE 'G'.       02190000
019100     05  PC-L                        PIC  X(01)  VALUE 'L'.       02200000
019200     05  PC-I                        PIC  X(01)  VALUE 'I'.       02210000
019300     05  PC-01                       PIC  X(02)  VALUE '01'.      02220000
019400     05  PC-OF                       PIC  X(04)  VALUE ' OF '.    02230000
019500     05  PC-90                       PIC  9(02)  VALUE  90.       02240000
019600     05  PC-FLAT                     PIC  X(09)  VALUE            02250000
019700                                                 'FLAT'.          02260000
019800     05  PC-0                        PIC  9(01)  VALUE  0.        02270000
019900     05  PC-1                        PIC  9(01)  VALUE  1.        02280000
020000     05  PC-2                        PIC  9(01)  VALUE  2.        02290000
020100     05  PC-3                        PIC  9(01)  VALUE  3.        02300000
020300                                                                  02310000
020500 01  PC-LABEL-TYPE.                                               02320000
020600     05  PC-CENTRAL-STOCK            PIC  X(01)  VALUE 'C'.       02330000
020700     05  PC-P2L                      PIC  X(01)  VALUE 'P'.       02340000
020800     05  PC-SML                      PIC  X(01)  VALUE 'S'.       02350000
020900                                                                  02360000
021000 01  PV-SAVE-FIELDS.                                              02370000
021100     05  PV-PREV-LABEL-TYPE          PIC  X(01)  VALUE SPACES.    02380000
021200     05  PV-PREV-INPK-CNVYB-IND      PIC  X(01)  VALUE SPACES.    02390000
021300     05  PV-PREV-AUDIT-CART-IND      PIC  X(01)  VALUE SPACES.    02400000
021400     05  PV-PREV-CART-ACTN-CDE       PIC  X(01)  VALUE SPACES.    02410000
021500     05  PV-PREV-DEST-OPER-UNT-ID    PIC  S9(4) COMP.             02420000
021600     05  PV-PREV-SKU-NBR             PIC  S9(8)V COMP-3.          02430000
021700*                                                                 02440000
021800     05  PV-PREV-PO-NBR              PIC  S9(9) COMP.             02450000
021900     05  PV-PREV-PO-LNE-NBR          PIC  S9(9) COMP.             02460000
022000     05  PV-PREV-PREPK-ID            PIC  S9(4) COMP.             02470000
022100     05  PV-PREV-OPER-UNT-ID         PIC  S9(4) COMP.             02480000
022200     05  PV-PREV-TRIP-ID             PIC  S9(9) COMP.             02490000
022300     05  PV-PREV-RCVR-SEQ-NBR        PIC  S9(9) COMP.             02500000
022400*                                                                 02510000
022500     05  PV-PREV-SULBXF-LBL-TYP-CDE  PIC  X(01)  VALUE SPACES.    02520000
022600*                                                                 02530000
022700     05  PV-TCP-EXP-LENGTH               PIC 9(08)   VALUE 05.    02540000
022800     05  PV-TCP-RET-LENGTH               PIC 9(08)   VALUE ZEROS. 02550000
022900     05  PV-TCP-REM-LENGTH               PIC 9(08)   VALUE ZEROS. 02560000
023000     05  PV-TCP-PRCSD-LENGTH             PIC 9(08)   VALUE ZEROS. 02570000
023100     05  PV-TCP-TOT-LENGTH               PIC 9(08)   VALUE ZEROS. 02580000
023200     05  PV-TCP-BUF                      PIC  X(05)  VALUE SPACES.02590000
023300 01  PC-PROGRAM-MESSAGES.                                         02600000
023400     05  PC-END-OF-SESSION-MSG           PIC  X(19)  VALUE        02610000
023500         'END OF SESSION     '.                                   02620000
023600     05  PC-INVALID-SELECTION-MSG        PIC  X(19)  VALUE        02630000
023700         'INVALID SELECTION  '.                                   02640000
023800     05  PC-INVALID-VALUE-MSG            PIC  X(19)  VALUE        02650000
023900         'INVALID VALUE      '.                                   02660000
024000     05  PC-UNRECOGNIZED-PF-KEY-MSG      PIC  X(19)  VALUE        02670000
024100         'UNRECOGNIZED PF KEY'.                                   02680000
024200     05  PC-ACCESS-NOT-ALLOWED-MSG       PIC  X(19)  VALUE        02690000
024300         'USER NOT AUTHORIZED'.                                   02700000
024400     05  PC-NON-NUMERIC-SELECTION-MSG    PIC  X(19)  VALUE        02710000
024500         'NUMERIC VALUE REQ. '.                                   02720000
024600     05  PC-TRANS-UNAVAILABLE-MSG        PIC  X(19)  VALUE        02730000
024700         'TRANS NOT AVAILABLE'.                                   02740000
024800     05  PC-CICS-ABEND-MSG               PIC  X(19)  VALUE        02750000
024900         'CICS ABEND -CALL DP'.                                   02760000
025000     05  PC-CICSAUTH-MSG                 PIC  X(19)  VALUE        02770000
025100         'CICSAUTH BAD RETURN'.                                   02780000
025200     05  PC-UNAVAIL-SELECTION-MSG        PIC X(19)   VALUE        02790000
025300         'SELECTION NOT AVAIL'.                                   02800000
025400     05  PC-INVALID-PRTR-ID              PIC X(19)   VALUE        02810000
025500         'INVALID PRINTER ID '.                                   02820000
025600     05  PC-MUST-BE-NUM-MSG              PIC X(19)   VALUE        02830000
025700         'MUST BE NUMERIC    '.                                   02840000
025800     05  PC-MUST-BE-GT-0-MSG             PIC X(19)   VALUE        02850000
025900         'MUST BE > ZERO     '.                                   02860000
026000     05  PC-INVALID-BATCH-NO             PIC X(19)   VALUE        02870000
026100         'INVALID BATCH NBR  '.                                   02880000
026200     05  PC-BATCH-NOT-FOUND              PIC X(19)   VALUE        02890000
026300         'BATCH NBR NOT FOUND'.                                   02900000
026400     05  PC-COMMUNICATION-ERROR          PIC X(19)   VALUE        02910000
026500         'COMMUNICATION ERROR'.                                   02920000
026600     05  PC-SOCKET-CALL-ERROR            PIC X(19)   VALUE        02930000
026700         'SOCKET CALL ERROR  '.                                   02940000
026800     05  PC-SOCKET-CONNECT-ERROR         PIC X(19)   VALUE        02950000
026900         'SOCKET CONNECT ERR '.                                   02960000
027000     05  PC-SOCKET-CLOSE-ERROR           PIC X(19)   VALUE        02970000
027100         'SOCKET CLOSE ERROR '.                                   02980000
027200     05  PC-SOCKET-SEND-ERROR            PIC X(19)   VALUE        02990000
027300         'SOCKET SEND ERROR  '.                                   03000000
027400     05  PC-SOCKET-RECEIVE-ERROR         PIC X(19)   VALUE        03010000
027500         'SOCKET RECEIVE ERR '.                                   03020000
027600     05  PC-BAD-TRANS-NMBR               PIC X(19)   VALUE        03030000
027700         'LPMS-TRANS NBR ERR '.                                   03040000
027800     05  PC-INVALID-PRTR-W-BTCH          PIC X(19)   VALUE        03050000
027900         'INVALID PRTR W/BTCH'.                                   03060000
028000     05  PC-LABELS-SUBMITTED             PIC X(19)   VALUE        03070000
028100         'LABELS SUBMITTED   '.                                   03080000
028200                                                                  03090000
028300                                                                  03100000
028400*----------------------------------------------------------------*03110000
028500 01  PC-LABEL-MESSAGES.                                           03120000
028600*----------------------------------------------------------------*03130000
028700     05  PC-DEFAULT-LABEL-MSG       PIC X(35) VALUE               03140000
028800                           '@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@'. 03150000
028900     05  PC-NOT-ATTACHED-RCVR-MSG   PIC X(35) VALUE               03160000
029000                           'CARTON NOT ATTACHED TO A RECEIVER  '. 03170000
029100     05  PC-NOT-FOUND-MSG           PIC X(35) VALUE               03180000
029200                           '*** NO ITEM INFO - DETAIL CHECK ***'. 03190000
029300     05  PC-FREE-ASTRY-NO-RCVR-MSG  PIC X(35) VALUE               03200000
029400                           '***FREE ASTY - CRTN NO RECEIVER ***'. 03210000
029500     05  PC-FREE-ASTRY-NO-TRIP-MSG  PIC X(35) VALUE               03220000
029600                           '***FREE ASTY - RCVR NO SCAC/TRLR***'. 03230000
029700     05  PC-DUPLICATE-SCAN-MSG      PIC X(35) VALUE               03240000
029800                           '** DUPLICATE SCAN - DETAIL CHECK **'. 03250000
029900     05  PC-DETAIL-CK-NEED-MSG      PIC X(35) VALUE               03260000
030000                           '* * * * DETAIL CHECK NEEDED * * * *'. 03270000
030100     05  PC-MISDIRECT-MSG          PIC X(35) VALUE                03280000
030200                           '* * *  M I S  -  D I R E C T * * * '. 03290000
030300     05  PC-INACT-PKSK-CRE-NEW-RCVR PIC X(35) VALUE               03300000
030400                           '** INACT PKSLP/CREATE NEW RCVR  ***'. 03310000
030500     05  PC-PKSLIP-CARTON-UNEQUAL   PIC X(35) VALUE               03320000
030600                           '** PACKSLIP/CARTON DATA UNEQUAL ***'. 03330000
030700     05  PC-CASEPK-NOT-DNLD-RECVR   PIC X(35) VALUE               03340000
030800                           '** CASEPACK NOT DNLD FOR RECVR *** '. 03350000
030900     05  PC-CASEPK-DNLD-PHYSCL      PIC X(35) VALUE               03360000
031000                           '** CASEPACK DNLD PHYSICAL LABELS***'. 03370000
031100     05  PC-FREE-ASTY-NEED-TRANS    PIC X(35) VALUE               03380000
031200                           '** FREE ASTY NEEDS TRANSCRIPTION***'. 03390000
031300     05  PC-HOLD-CRTN-TRIP-END      PIC X(35) VALUE               03400000
031400                           '** HOLD CARTON UNTIL TRLR EMPTY ***'. 03410000
031500     05  PC-UNUSABLE-128-NO-PKSLIP  PIC X(35) VALUE               03420000
031600                           '**** UNUSABLE UCC128 DATA     *****'. 03430000
031700     05  PC-TRANSC-CHECK-IN-RCVR    PIC X(35) VALUE               03440000
031800                           '** TRANSCRIBE CHECK IN RECEIVER ***'. 03450000
031900                                                                  03460000
032000                                                                  03470000
032100                                                                  03480000
032200 01  PS-PROGRAM-SWITCHES.                                         03490000
032300     05  PS-SOCKET-ERROR-SW              PIC  X(01)  VALUE 'N'.   03500000
032400         88  PS-SOCKET-ERROR                         VALUE 'Y'.   03510000
032500         88  PS-NO-SOCKET-ERROR                      VALUE 'N'.   03520000
032600     05  PS-VALID-INPUT-SW               PIC  X(01)  VALUE 'Y'.   03530000
032700         88  PS-VALID-INPUT                          VALUE 'Y'.   03540000
032800         88  PS-INVALID-INPUT                        VALUE 'N'.   03550000
032900     05  PS-VALID-TRANS-ID-SW            PIC  X(01)  VALUE 'Y'.   03560000
033000         88  PS-VALID-TRANS-ID                       VALUE 'Y'.   03570000
033100         88  PS-INVALID-TRANS-ID                     VALUE 'N'.   03580000
033200     05  PS-VALID-PRINTER-SW             PIC  X(01)  VALUE 'Y'.   03590000
033300         88  PS-VALID-PRINTER-ID                     VALUE 'Y'.   03600000
033400         88  PS-INVALID-PRINTER-ID                   VALUE 'N'.   03610000
033500     05  PS-VALID-BATCH-NUMBER-SW        PIC  X(01)  VALUE 'Y'.   03620000
033600         88  PS-VALID-BATCH-NUMBER                   VALUE 'Y'.   03630000
033700         88  PS-INVALID-BATCH-NUMBER                 VALUE 'N'.   03640000
033800     05  PS-EOF-LBL-CURSOR-SW            PIC  X(01)  VALUE 'N'.   03650000
033900         88  PS-EOF-LBL-CURSOR                       VALUE 'Y'.   03660000
034000         88  PS-NOT-EOF-LBL-CURSOR                   VALUE 'N'.   03670000
034100     05  PS-REPRINT-BATCH-SW             PIC  X(01)  VALUE 'N'.   03680000
034200         88  PS-REPRINT-BATCH                        VALUE 'Y'.   03690000
034300         88  PS-NOT-REPRINT-BATCH                    VALUE 'N'.   03700000
034400     05  PS-REPRINT-FORM-SW              PIC  X(01)  VALUE 'N'.   03710000
034500         88  PS-REPRINT-FORM                         VALUE 'Y'.   03720000
034600         88  PS-NOT-REPRINT-FORM                     VALUE 'N'.   03730000
034800     05  PS-PREPK-FORM-SW                PIC  X(01)  VALUE 'N'.   03740000
034900         88  PS-PREPK-FORM                           VALUE 'Y'.   03750000
035000         88  PS-NOT-PREPK-FORM                       VALUE 'N'.   03760000
035100     05  PS-MSG-1-SW                     PIC  X(01)  VALUE 'N'.   03770000
035200         88  PS-NO-MSG-1                             VALUE 'N'.   03780000
035300         88  PS-YES-MSG-1                            VALUE 'Y'.   03790000
035400     05  PS-MSG-2-SW                     PIC  X(01)  VALUE 'N'.   03800000
035500         88  PS-NO-MSG-2                             VALUE 'N'.   03810000
035600         88  PS-YES-MSG-2                            VALUE 'Y'.   03820000
035700     05  PS-TRANS-ID-DUP-SW              PIC  X(01)  VALUE 'Y'.   03830000
035800         88  PS-TRANS-ID-NOT-DUP                     VALUE 'N'.   03840000
035900         88  PS-TRANS-ID-DUP                         VALUE 'Y'.   03850000
036000     05  PS-SULBXF-FOUND-SW              PIC  X(01)  VALUE 'N'.   03860000
036100         88  PS-SULBXF-NOT-FOUND                     VALUE 'N'.   03870000
036200         88  PS-SULBXF-FOUND                         VALUE 'Y'.   03880000
036300*                                                                 03890000
036400     05  PS-PART-RECEIVE-SW              PIC  X(01)  VALUE 'S'.   03900000
036500         88  PS-PART-RECEIVE                         VALUE 'P'.   03910000
036600         88  PS-COMP-RECEIVE                         VALUE 'C'.   03920000
036700         88  PS-ERROR-RECEIVE                        VALUE 'E'.   03930000
036800         88  PS-START-RECEIVE                        VALUE 'S'.   03940000
036900     05  PS-AUDIT-CRTN-FOUND-SW          PIC  X(01)  VALUE 'N'.   03950000
037000         88  PS-AUDIT-CRTN-FOUND-YES                 VALUE 'Y'.   03960000
037100         88  PS-AUDIT-CRTN-FOUND-NO                  VALUE 'N'.   03970000
037300     05  PS-HEADER-DIVIDER-PRINT-SW      PIC  X(01)  VALUE 'Y'.   03980000
037400         88  PS-HEADER-DIVIDER-PRINT-YES             VALUE 'Y'.   03990000
037500         88  PS-HEADER-DIVIDER-PRINT-NO              VALUE 'N'.   04000000
037600     05  PS-TRAILER-DIVIDER-PRINT-SW     PIC  X(01)  VALUE 'Y'.   04010000
037700         88  PS-TRAILER-DIVIDER-PRINT-YES            VALUE 'Y'.   04020000
037800         88  PS-TRAILER-DIVIDER-PRINT-NO             VALUE 'N'.   04030000
038000     05  PS-RF-ID-FOUND-SW               PIC  X(01)  VALUE 'Y'.   04040000
038100         88  PS-RF-ID-FOUND-YES                      VALUE 'Y'.   04050000
038200         88  PS-RF-ID-FOUND-NO                       VALUE 'N'.   04060000
038400                                                                  04070000
038500 01  PV-PROGRAM-VARIABLES.                                        04080000
038600     05  PV-NULL-IND                     PIC S9(4)   VALUE ZERO   04090000
038700                                                     COMP SYNC.   04100000
038800     05  PV-CICS-MSG-AREA-A.                                      04110000
038900         10  FILLER                      PIC  X(01)  VALUE SPACE. 04120000
039000         10  PV-CICS-MSG-AREA-B          PIC  X(80)  VALUE SPACE. 04130000
039100     05  PV-CICS-MSG-AREA-C.                                      04140000
039200         10  PV-CICS-MSG-AREA1           PIC  X(80)  VALUE SPACE. 04150000
039300         10  PV-CICS-MSG-AREA2           PIC  X(80)  VALUE SPACE. 04160000
039400         10  PV-CICS-MSG-AREA3           PIC  X(80)  VALUE SPACE. 04170000
039500         10  PV-CICS-MSG-AREA4           PIC  X(80)  VALUE SPACE. 04180000
039600     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACES.04190000
039700     05  PV-RETCODE                      PIC  9(08)- VALUE ZERO.  04200000
039800     05  PV-ERRNO                        PIC  9(08)- VALUE ZERO.  04210000
039900     05  PV-SOCK-ID                      PIC  9(04)  VALUE ZERO.  04220000
040000     05  PV-TCPLENG                      PIC  9(08)  VALUE ZERO.  04230000
040100     05  PV-FLAG                         PIC  9(08)  VALUE ZERO.  04240000
040200     05  PV-BLANKS                PIC  X(40)  VALUE SPACES.       04250000
040300*                                                                 04260000
040400     05  PV-OTBND-CRTN                   PIC  X(22)  VALUE SPACES.04270000
040500     05  PV-OTBND-CRTN-R   REDEFINES PV-OTBND-CRTN.               04280000
040600         10  PV-OTBND-SML                PIC  9(20).              04290000
040700         10  FILLER                      PIC  9(02).              04300000
040710     05  PV-OTBND-CRTN-SULBXF            PIC  X(22)  VALUE SPACES.04310000
040720     05  PV-OTBND-CRTN-SULBXF-R   REDEFINES PV-OTBND-CRTN-SULBXF. 04320000
040730         10  PV-OTBND-SML-SULBXF         PIC  9(20).              04330000
040740         10  FILLER                      PIC  9(02).              04340000
040800*                                                                 04350000
040900     05  PV-SHIPT-UNT-ID                 PIC  X(18)  VALUE SPACES.04360000
041000     05  PV-SHIPT-UNT-ID-R REDEFINES PV-SHIPT-UNT-ID.             04370000
041100         10  FILLER                      PIC  9(13).              04380000
041200         10  PV-LAST-FIVE-DIGITS         PIC  9(05).              04390000
041300     05  PV-SHIPT-UNT-ID-18              PIC  9(18)  VALUE ZEROES.04400000
041400*                                                                 04410000
041500     05  PV-SHIPT-UNT-ID-NUM             PIC  9(18)  VALUE ZEROES.04420000
041600     05  PV-SHIPT-UNT-ID-NUM-R REDEFINES PV-SHIPT-UNT-ID-NUM.     04430000
041700         10  FILLER                      PIC  9(13).              04440000
041800         10  PV-SHIPT-UNT-14-18          PIC  9(05).              04450000
041900*                                                                 04460000
042000     05  PV-PO-NBR                       PIC  X(09)  VALUE SPACES.04470000
042100     05  PV-PO-NBR-R REDEFINES PV-PO-NBR.                         04480000
042200         10  FILLER                      PIC  9(01).              04490000
042300         10  PV-PO-NBR-7POS              PIC  9(08).              04500000
042400*                                                                 04510000
042500     05  PV-RCVR-NBR                     PIC  X(09)  VALUE SPACES.04520000
042600     05  PV-RCVR-NBR-R REDEFINES PV-RCVR-NBR.                     04530000
042700         10  FILLER                      PIC  9(06).              04540000
042800         10  PV-RCVR-NBR-3POS            PIC  9(03).              04550000
042900*                                                                 04560000
043000     05  PV-LINE-NBR                     PIC  X(09)  VALUE SPACES.04570000
043100     05  PV-LINE-NBR-R REDEFINES PV-LINE-NBR.                     04580000
043200         10  FILLER                      PIC  9(06).              04590000
043300         10  PV-PO-LINE-NBR              PIC  9(03).              04600000
043400*                                                                 04610000
043500     05  PV-LINE-RATO                    PIC  9(04).              04620000
043600     05  PV-LINE-RATO-R REDEFINES PV-LINE-RATO.                   04630000
043700         10  FILLER                      PIC  X(01).              04640000
043800         10  PV-LINE-RATO-NBR            PIC  X(03).              04650000
043900*                                                                 04660000
044000     05  PV-INPK-QTY                     PIC  X(09)  VALUE SPACES.04670000
044100     05  PV-INPK-QTY-R REDEFINES PV-INPK-QTY.                     04680000
044200         10  FILLER                      PIC  9(05).              04690000
044300         10  PV-INPK-UNIT-QTY            PIC  9(04).              04700000
044400*                                                                 04710000
044500     05  PV-OTPK-QTY                     PIC  X(09)  VALUE SPACES.04720000
044600     05  PV-OTPK-QTY-R REDEFINES PV-OTPK-QTY.                     04730000
044700         10  FILLER                      PIC  9(05).              04740000
044800         10  PV-OTPK-UNIT-QTY            PIC  9(04).              04750000
044900*                                                                 04760000
045000     05  PV-PREPK-QTY                    PIC  X(04)  VALUE SPACES.04770000
045100     05  PV-PREPK-QTY-R REDEFINES PV-PREPK-QTY.                   04780000
045200         10  PV-PREPK-UNIT-QTY           PIC  9(04).              04790000
045300*                                                                 04800000
045400     05  PV-PO-ITM-UNITS-BC           PIC X(21) VALUE SPACES.     04810000
045500     05  PV-PO-ITM-UNITS-BC-R REDEFINES PV-PO-ITM-UNITS-BC.       04820000
045600         10  PV-BC-PO-NBR-BC          PIC 9(09).                  04830000
045700         10  PV-BC-ITEM-NBR-BC        PIC 9(08).                  04840000
045800         10  PV-BC-UNITS-BC           PIC 9(04).                  04850000
045900     05  PV-PO-ITM-UNITS-NBR          PIC X(23) VALUE SPACES.     04860000
046000     05  PV-PO-ITM-UNITS-NBR-R REDEFINES PV-PO-ITM-UNITS-NBR.     04870000
046100         10  PV-BC-PO-NBR             PIC 9(09).                  04880000
046200         10  FILLER                   PIC X(01).                  04890000
046300         10  PV-BC-ITEM-NBR           PIC 9(08).                  04900000
046400         10  FILLER                   PIC X(01).                  04910000
046500         10  PV-BC-UNITS              PIC 9(04).                  04920000
046600                                                                  04930000
046700     05  PV-STORE-NBR                    PIC  9(04)  VALUE ZEROES.04940000
046800                                                                  04950000
046900     05  PV-RANDOM-NUMBER                PIC  9(09)  VALUE ZEROES.04960000
047000     05  PV-RANDOM-NUMBER-R REDEFINES  PV-RANDOM-NUMBER.          04970000
047100         10  PV-RANDOM-1-8               PIC  9(08).              04980000
047200         10  FILLER                      PIC  9(01).              04990000
047300     05  PV-LPMS-TRANS-ID                PIC  9(08)  VALUE ZEROES.05000000
047400     05  PV-LPMS-XMIT-RETURN             PIC  X(01)  VALUE SPACES.05010000
047500                                                                  05020000
047600     05  PV-TRAILER-COUNT                PIC  9(07)  VALUE ZERO.  05030000
047700*                                                                 05040000
047800     05  PV-PACKS-IN-CARTON              PIC  9(04)  VALUE ZERO.  05050000
047900     05  PV-PACKS-IN-CARTON-X REDEFINES PV-PACKS-IN-CARTON        05060000
048000                                         PIC  X(04).              05070000
048100*                                                                 05080000
048200*EXAMPLE:  (055-31)12345678   (USED ON SML LABELS).               05090000
048300     05  PV-SML-SKU-NUMBER.                                       05100000
048400         10  FILLER                      PIC  X(01)  VALUE '('.   05110000
048500         10  PV-SML-DEPT1                PIC  X(03).              05120000
048600         10  FILLER                      PIC  X(01)  VALUE '-'.   05130000
048700         10  PV-SML-CLASS-NBR1           PIC  X(02).              05140000
048800         10  FILLER                      PIC  X(01)  VALUE ')'.   05150000
048900         10  PV-SML-SKU                  PIC  9(08).              05160000
049000                                                                  05170000
049100*EXAMPLE:  12345678           (USED ON P2L LABELS).               05180000
049200     05  PV-P2L-SKU-NUMBER.                                       05190000
049300         10  FILLER                      PIC  X(02)  VALUE SPACES.05200000
049400         10  PV-P2L-SKU                  PIC  9(08).              05210000
049500                                                                  05220000
049600*EXAMPLE:  313-59             (USED ON P2L LABELS).               05230000
049700     05  PV-P2L-DEPT-CLASS.                                       05240000
049800         10  PV-P2L-DEPT1                PIC  X(03).              05250000
049900         10  FILLER                      PIC  X(01)  VALUE '-'.   05260000
050000         10  PV-P2L-CLASS-NBR1           PIC  X(02).              05270000
050100                                                                  05280000
050200*EXAMPLE:  (055-31)183        (USED ON CS LABELS).                05290000
050300     05  PV-CS-SKU-NUMBER.                                        05300000
050400         10  FILLER                      PIC  X(01)  VALUE '('.   05310000
050500         10  PV-CS-DEPT                  PIC  X(03).              05320000
050600         10  FILLER                      PIC  X(01)  VALUE '-'.   05330000
050700         10  PV-CS-CLASS-NBR             PIC  X(02).              05340000
050800         10  FILLER                      PIC  X(01)  VALUE ')'.   05350000
050900         10  PV-CS-SKU                   PIC  9(08).              05360000
051000                                                                  05370000
051100*EXAMPLE:  05531183           (USED ON CS LABELS).                05380000
051200     05  PV-CS-SKU-NBR.                                           05390000
051300         10  PV-CS-SKU-ONLY              PIC  9(08).              05400000
051400*                                                                 05410000
051500     05  PV-PO-RCVR.                                              05420000
051600         10  PV-PO-NUMBER                PIC  9(08)  VALUE ZEROES.05430000
051700         10  FILLER                      PIC  X(01)  VALUE '-'.   05440000
051800         10  PV-PO-RECEIVER              PIC  9(03)  VALUE ZEROES.05450000
051900                                                                  05460000
052000     05  PV-BARCODE.                                              05470000
052100         10  PV-PO                       PIC S9(09)  COMP.        05480000
052200         10  PV-ITEM                     PIC S9(15)V COMP-3.      05490000
052300         10  PV-OUTERPACK                PIC S9(09)  COMP.        05500000
052400*                                                                 05510000
052500     05  PV-PACK.                                                 05520000
052600         10  PV-PACK-TEXT                PIC  X(05)               05530000
052700                                         VALUE 'PACK-'.           05540000
052800         10  PV-PREPK-ID                 PIC  9(4).               05550000
052900*        10  PV-PREPK-ID                 PIC  S9(4)  COMP.        05560000
053000*                                                                 05570000
053100     05  PV-PRINTER-HOLD.                                         05580000
053200         10  PV-PRINTER-1-3              PIC  9(03).              05590000
053300         10  FILLER                      PIC  X(05).              05600000
053400*                                                                 05610000
053500     05  PV-DSPLY-PRTR                   PIC  X(06)  VALUE SPACES.05620000
053600     05  PV-DSPLY-PRTR-R REDEFINES PV-DSPLY-PRTR.                 05630000
053700         10  PV-DSPLY-DC                 PIC  X(02).              05640000
053800         10  PV-DSPLY-DASH               PIC  X(01).              05650000
053900         10  PV-DSPLY-PRTR-ID            PIC  X(03).              05660000
054000*                                                                 05670000
054100     05  PV-DISPLAY-PRTR                 PIC  X(07)  VALUE SPACES.05680000
054200     05  PV-DISPLAY-PRTR-R REDEFINES PV-DISPLAY-PRTR.             05690000
054300         10  PV-DISPLAY-NUM              PIC  X(01).              05700000
054400         10  PV-DISPLAY-DC               PIC  X(02).              05710000
054500         10  PV-DISPLAY-DASH             PIC  X(01).              05720000
054600         10  PV-DISPLAY-PRTR-ID          PIC  X(03).              05730000
054700*                                                                 05740000
054800     05  PV-DISPLAY-SKU                  PIC  9(08) VALUE ZEROES. 05750000
054900     05  PV-PRINTER-ID                   PIC  X(03)  VALUE SPACES.05760000
055000*                                                                 05770000
055100*                                                                 05780000
055200     05  PV-BATCH-NUMBER-HOLD            PIC  X(04)  VALUE SPACES.05790000
055300*    05  PV-BATCH-NUMBER-HOLD-R REDEFINES PV-BATCH-NUMBER-HOLD.   05800000
055400*        10  FILLER                      PIC  X(01).              05810000
055500*        10  PV-BATCH-NUMBER-3-POS       PIC  X(03).              05820000
055600     05  PV-BATCH-NUMBER                 PIC  X(04)  VALUE SPACES.05830000
055700     05  PV-BATCH-NUMBER-R REDEFINES PV-BATCH-NUMBER.             05840000
055800         10  PV-BATCH-NUMBER-N           PIC  9(04).              05850000
055900*                                                                 05860000
056000*                                                                 05870000
056100     05  PV-DB2-COUNT                    PIC S9(09)  VALUE +0     05880000
056200                                                     COMP-3.      05890000
056300     05  PV-DB2-COUNT-AUDIT              PIC S9(09)  VALUE +0     05900000
056400                                                     COMP-3.      05910000
056500     05  PV-CICS-RESPONSE                PIC S9(08)  VALUE ZEROS  05920000
056600                                                     COMP SYNC.   05930000
056700     05  PV-TRANSFER-PROGRAM             PIC  X(08)  VALUE SPACE. 05940000
056800     05  PV-DISPLAY-LPMS-TRAN            PIC  X(08)  VALUE SPACE. 05950000
056900     05  PV-DISPLAY-MANIFEST             PIC  X(09)  VALUE SPACE. 05960000
057000     05  PV-DISPLAY-BATCH-NO             PIC  9(04)  VALUE ZEROS. 05970000
057100     05  PV-DISPLAY-SOCK-ID              PIC  9(04)  VALUE ZEROS. 05980000
057200     05  PV-DISPLAY-FLAG                 PIC  9(08)  VALUE ZEROS. 05990000
057300     05  PV-DISPLAY-NBR-BYTES            PIC  9(08)  VALUE ZEROS. 06000000
057400     05  PV-DISPLAY-FAMILY               PIC  9(04)  VALUE ZEROS. 06010000
057500     05  PV-DISPLAY-PORT                 PIC  9(04)  VALUE ZEROS. 06020000
057600     05  PV-DISPLAY-IP-ADDR              PIC  9(08)  VALUE ZEROS. 06030000
057700     05  PV-DISPLAY-RETURN-CODE          PIC  9(08)  VALUE ZEROS. 06040000
057800     05  PV-DISPLAY-CURR-OPER            PIC  9(04)  VALUE ZEROS. 06050000
057900     05  PV-DISPLAY-EIBCALEN             PIC S9(04)  VALUE ZEROES.06060000
058000                                                                  06070000
058100     05  PV-DISPLAY-OPER                 PIC  9(04)  VALUE ZEROES.06080000
058200     05  PV-DISPLAY-TRIP                 PIC  9(09)  VALUE ZEROES.06090000
058300     05  PV-DISPLAY-BATCH                PIC  9(04)  VALUE ZEROES.06100000
058400     05  PV-DISPLAY-PO                   PIC  9(09)  VALUE ZEROES.06110000
058500     05  PV-DISPLAY-RCVR                 PIC  9(09)  VALUE ZEROES.06120000
058600     05  PV-DISPLAY-LINE                 PIC  9(09)  VALUE ZEROES.06130000
058700     05  PV-DISPLAY-DEST                 PIC  9(04)  VALUE ZEROES.06140000
058800     05  PV-DISPLAY-CRTN                 PIC  9(20)  VALUE ZEROES.06150000
058900                                                                  06160000
059000     05  PV-IP-ADDRESS.                                           06170000
059100         10  PV-IP-ADDR-NUM1             PIC 9(03).               06180000
059200             88  PV-IP-ADDR-NUM1-VALID              VALUE 1 THRU  06190000
059300                                                          255.    06200000
059400         10  PV-IP-ADDR-DOT1             PIC X(01).               06210000
059500             88  PV-IP-ADDR-DOT1-VALID              VALUE '.'.    06220000
059600         10  PV-IP-ADDR-NUM2             PIC 9(03).               06230000
059700             88  PV-IP-ADDR-NUM2-VALID              VALUE 1 THRU  06240000
059800                                                          255.    06250000
059900         10  PV-IP-ADDR-DOT2             PIC X(01).               06260000
060000             88  PV-IP-ADDR-DOT2-VALID              VALUE '.'.    06270000
060100         10  PV-IP-ADDR-NUM3             PIC 9(03).               06280000
060200             88  PV-IP-ADDR-NUM3-VALID              VALUE 1 THRU  06290000
060300                                                          255.    06300000
060400         10  PV-IP-ADDR-DOT3             PIC X(01).               06310000
060500             88  PV-IP-ADDR-DOT3-VALID              VALUE '.'.    06320000
060600         10  PV-IP-ADDR-NUM4             PIC 9(03).               06330000
060700             88  PV-IP-ADDR-NUM4-VALID              VALUE 1 THRU  06340000
060800                                                          255.    06350000
060900                                                                  06360000
061000     05  PV-HEX-FIELD.                                            06370000
061100         10  PV-HEX-FIELD-1              PIC X(01).               06380000
061200         10  PV-HEX-FIELD-2              PIC X(01).               06390000
061300         10  PV-HEX-FIELD-3              PIC X(01).               06400000
061400         10  PV-HEX-FIELD-4              PIC X(01).               06410000
061500     05  PV-HEX-FIELD-NUMBER REDEFINES PV-HEX-FIELD               06420000
061600                                         PIC 9(08)  COMP.         06430000
061700     05  PV-HEX-NUMERIC                  PIC 9(04) BINARY.        06440000
061800     05  PV-HEX-CHAR REDEFINES PV-HEX-NUMERIC.                    06450000
061900         10  PV-HEX-CHAR-1               PIC X(01).               06460000
062000         10  PV-HEX-CHAR-2               PIC X(01).               06470000
062100                                                                  06480000
062200     05 PV-CURRENT-DB2-DATE              PIC X(10)   VALUE SPACES.06490000
062300     05 PV-CURRENT-DB2-DATE-R REDEFINES PV-CURRENT-DB2-DATE.      06500000
062400         10 PV-CURRENT-CCYY              PIC  9(04).              06510000
062500         10 FILLER                       PIC  X(01).              06520000
062600         10 PV-CURRENT-MM-DD             PIC  9(05).              06530000
062700                                                                  06540000
062800     05 PV-LBL-DATE                      PIC  X(08)  VALUE SPACES.06550000
062900     05 PV-LBL-DATE-R REDEFINES PV-LBL-DATE.                      06560000
063000        10  PV-LBL-DATE-MM               PIC  X(02).              06570000
063100        10  PV-LBL-DASH1                 PIC  X(01).              06580000
063200        10  PV-LBL-DATE-DD               PIC  X(02).              06590000
063300        10  PV-LBL-DASH2                 PIC  X(01).              06600000
063400        10  PV-LBL-DATE-YY               PIC  X(02).              06610000
063500                                                                  06620000
063600     05 PV-WORK-DB2-DATE                 PIC X(10)   VALUE SPACES.06630000
063700     05 PV-WORK-DB2-DATE-R    REDEFINES PV-WORK-DB2-DATE.         06640000
063800         10 PV-WORK-CC                   PIC  9(02).              06650000
063900         10 PV-WORK-YY                   PIC  9(02).              06660000
064000         10 FILLER                       PIC  X(01).              06670000
064100         10 PV-WORK-MM                   PIC  9(02).              06680000
064200         10 FILLER                       PIC  X(01).              06690000
064300         10 PV-WORK-DD                   PIC  9(02).              06700000
064400                                                                  06710000
064500     05 PV-CURRENT-DB2-TIME              PIC  X(08)  VALUE SPACES.06720000
064600     05 PV-CURRENT-DB2-TIME-R REDEFINES PV-CURRENT-DB2-TIME.      06730000
064700         10 PV-CURRENT-HR                PIC  9(02).              06740000
064800         10 FILLER                       PIC  X(01).              06750000
064900         10 PV-CURRENT-MN                PIC  9(02).              06760000
065000         10 FILLER                       PIC  X(01).              06770000
065100         10 PV-CURRENT-SC                PIC  9(02).              06780000
065200                                                                  06790000
065300     05 PV-CURRENT-TIME.                                          06800000
065400         10 PV-CURRENT-HOUR              PIC  9(02)  VALUE ZEROES.06810000
065500         10 FILLER                       PIC  X(01)  VALUE ':'.   06820000
065600         10 PV-CURRENT-MIN               PIC  9(02)  VALUE ZEROES.06830000
065700                                                                  06840000
065800     05  PV-MAX-USER-BATCH               PIC S9(04)  VALUE ZEROES 06850000
065900                                                     COMP.        06860000
066000     05  PV-LAST-BATCH-NUMBER            PIC S9(04)  VALUE ZEROES 06870000
066100                                                     COMP.        06880000
066200     05  PV-LAST-BATCH-NO                PIC  9(03)  VALUE ZEROES.06890000
066300                                                                  06900000
066400     05  PV-DISPLAY-DOWNLOAD.                                     06910000
066500         10  PV-DISPLAY-DOWNLOAD-1       PIC  X(80)  VALUE SPACE. 06920000
066600         10  PV-DISPLAY-DOWNLOAD-2       PIC  X(80)  VALUE SPACE. 06930000
066700         10  PV-DISPLAY-DOWNLOAD-3       PIC  X(80)  VALUE SPACE. 06940000
066800     05  PV-CICS-MESSAGE-AREA            PIC  X(80)  VALUE SPACES.06950000
066900     05  PV-DB2-LABEL-COUNT              PIC S9(09)  VALUE ZEROS  06960000
067000                                                     COMP-3.      06970000
067100     05  PV-DB2-REPRINT-LBL-CNT          PIC S9(09)  VALUE ZEROS  06980000
067200                                                     COMP-3.      06990000
067300     05  PV-DB2-EXCEPT-LBL-CNT           PIC S9(09)  VALUE ZEROS  07000000
067400                                                     COMP-3.      07010000
067500     05  PV-OWNER-SCAC-ID                PIC  X(04)  VALUE SPACES.07020000
067600     05  PV-VEH-NBR                      PIC  X(10)  VALUE SPACES.07030000
067800     05  PV-PRC-MSG-CDE                  PIC  X(02)  VALUE SPACES.07040000
068000     05  PV-DC-5-CHAR-ABBR               PIC  X(05)  VALUE SPACES.07050000
068100     05  PV-DC-5-CHAR-ABBR-R REDEFINES PV-DC-5-CHAR-ABBR.         07060000
068200         10  FILLER                      PIC  X(03).              07070000
068300         10  PV-2-DIGIT-DC-ABBR          PIC  X(02).              07080000
068400                                                                  07090000
068500     05  PV-PRINTER-FORMAT.                                       07100000
068600         10  FILLER                      PIC  X(01)  VALUE '#'.   07110000
068700         10  PV-DC-PRTD-AT               PIC  X(02)  VALUE SPACES.07120000
068800         10  FILLER                      PIC  X(01)  VALUE '-'.   07130000
068900         10  PV-PRTR-ID                  PIC  X(03)  VALUE SPACES.07140000
069000                                                                  07150000
069100     05  PV-DEPT-MAJ-CLASS-CONCAT        PIC  X(35)  VALUE SPACES.07160000
069200     05  PV-PROG-SHORT-NAME              PIC  X(35)  VALUE SPACES.07170000
069300                                                                  07180000
069400     05  PV-FIRST-STORE-RCPT.                                     07190000
069500         10 PV-FIRST-STORE-RCPT-TXT-1 PIC X(12) VALUE             07200000
069600                                       '@@@@NEW@@@@@'.            07210000
069700         10 PV-FIRST-STORE-RCPT-TXT-2 PIC X(12) VALUE             07220000
069800                                       '@@@@@TO@@@@@'.            07230000
069900         10 PV-FIRST-STORE-RCPT-TXT-3 PIC X(12) VALUE             07240000
070000                                       '@@@STORE@@@@'.            07250000
070100* DISPLAY TCP BUFFER DATA                                         07260000
070200     05  PV-TCP-BUF-DATA-FORMAT.                                  07270000
070300         10  PV-TCP-BUF-DATA-FORMAT1     PIC  X(51)  VALUE SPACE. 07280000
070400         10  PV-TCP-BUF-DATA-FORMAT2     PIC  X(51)  VALUE SPACE. 07290000
070500     05  PV-2O-DIGIT-BARCODE.                                     07300000
070600         10  PV-20-SML-CONTAINER-CDE         PIC 9(02).           07310000
070700         10  PV-20-SML-PACKAGING-TYP         PIC 9(01).           07320000
070800         10  PV-20-SML-SOFTWARE-SRC          PIC 9(01).           07330000
070900         10  PV-20-SML-BC-DIVERT             PIC 9(05).           07340000
071000         10  PV-20-SML-BC-DC-ORIGIN          PIC 9(03).           07350000
071100         10  PV-20-SML-BC-MNFST-NBR          PIC 9(08).           07360000
071200                                                                  07370000
071300* WR41309-RF ID 8/30/2012  AME  BEGIN                             07380000
071400     05  PV-RFID-STORE-TXT-4     PIC X(12) VALUE '***@RFID@***'.  07390000
071500* WR41309-RF ID 8/30/2012  AME  END                               07400000
071600                                                                  07410000
071700* DMH - 10/06/04 - BEGIN                                          07420000
071800* add select parameter before recv socket command to determine if 07430000
071900* is still active                                                 07440000
072000*                                                                 07450000
072100 01  SELECT-PARMS.                                                07460000
072200     02  SELECT-NUMFDS          PIC 9(8) COMP VALUE 2.            07470000
072300     02  SELECT-TIMEOUT.                                          07480000
072400         03  SELECT-SECS        PIC 9(8) COMP VALUE 05.           07490000
072500         03  SELECT-MILLSECS    PIC 9(8) COMP VALUE 0.            07500000
072600     02  SELECT-RD-MASK         PIC X(16).                        07510000
072700     02  SELECT-WR-MASK         PIC X(16).                        07520000
072800     02  SELECT-EX-MASK         PIC X(16).                        07530000
072900     02  SELECT-RR-MASK         PIC X(16).                        07540000
073000     02  SELECT-RW-MASK         PIC X(16).                        07550000
073100     02  SELECT-RE-MASK         PIC X(16).                        07560000
073200                                                                  07570000
073300 01  CHAR-MASK.                                                   07580000
073400     02 CHAR-STRING             PIC  X(100).                      07590000
073500                                                                  07600000
073600 01  CHAR-ARRAY REDEFINES CHAR-MASK.                              07610000
073700     02  CHAR-ENTRY-TABLE OCCURS 100 TIMES.                       07620000
073800       03  CHAR-ENTRY         PIC  X.                             07630000
073900                                                                  07640000
074000 01  BIT-MASK.                                                    07650000
074100     02  BIT-ARRAY            PIC  X(16).                         07660000
074200                                                                  07670000
074300 01  BIT-FUNCTION-CODES.                                          07680000
074400     02  CTOB                 PIC  X(4) VALUE 'CTOB'.             07690000
074500     02  BTOC                 PIC  X(4) VALUE 'BTOC'.             07700000
074600                                                                  07710000
074700 01  BIT-MASK-LENGTH          PIC  9(8) COMP VALUE 100.           07720000
074800                                                                  07730000
074900 01  BITMASK-TOKEN            PIC X(16) VALUE 'TCPIPBITMASKCOBL'. 07740000
075000 01  SOCKETS                  PIC  9(8) COMP VALUE 100.           07750000
075100 01  SOCKNO                   PIC S9(8) BINARY.                   07760000
075200 01  EZRETC                   PIC S9(8) COMP.                     07770000
075600                                                                  07780000
075700                                                                  07790000
075800 01  PT-TCP-RECEIVE-TABLE.                                        07800000
075900     05  PT-TCP-RECEIVE OCCURS 5 TIMES                            07810000
076000                        INDEXED BY PT-RECEIVE-IDX.                07820000
076100         10  PT-TCP-RECEIVE-CHAR         PIC X(01).               07830000
076200                                                                  07840000
076300 01  PT-TCP-ASSEMBLE-TABLE.                                       07850000
076400     05  PT-TCP-DATA-ASSEMBLE OCCURS 5  TIMES                     07860000
076500                              INDEXED BY PT-ASSEMBLE-IDX.         07870000
076600         10  PT-TCP-DATA-CHAR            PIC X(01).               07880000
076700/                                                                 07890000
076800*----------------------------------------------------------------*07900000
076900*  RANDOM NUMBER AREA                                            *07910000
077000*----------------------------------------------------------------*07920000
077100     COPY DPWS902.                                                07930000
077200                                                                  07940000
077300*----------------------------------------------------------------*07950000
077400*  RECORD LAYOUTS FOR LABEL PRINT MGMT SYSTEM (LPMS)             *07960000
077500*----------------------------------------------------------------*07970000
077600     COPY PCWS133.                                                07980000
077700                                                                  07990000
077800*----------------------------------------------------------------*08000000
077900*  BATCH LABEL - LABEL HEADER                                    *08010000
078000*----------------------------------------------------------------*08020000
078100     COPY PCWS134.                                                08030000
078200                                                                  08040000
078300*----------------------------------------------------------------*08050000
078400*  BATCH LABEL - SML LABEL FORM                                  *08060000
078500*----------------------------------------------------------------*08070000
078600     COPY PCWS255.                                                08080000
078700                                                                  08090000
078800*----------------------------------------------------------------*08100000
078900*  BATCH LABEL - SML LABEL DATA                                  *08110000
079000*----------------------------------------------------------------*08120000
079100     COPY PCWS256.                                                08130000
079200                                                                  08140000
079300*----------------------------------------------------------------*08150000
079400*  BATCH LABEL - LABEL TRAILER                                   *08160000
079500*----------------------------------------------------------------*08170000
079600     COPY PCWS137.                                                08180000
079700                                                                  08190000
079900*----------------------------------------------------------------*08200000
080000*  DEST LABEL - P2L LABEL                                        *08210000
080100*----------------------------------------------------------------*08220000
080200     COPY PCWS169.                                                08230000
080300                                                                  08240000
080400*----------------------------------------------------------------*08250000
080500*  BATCH LABEL - CS LABEL FORM                                   *08260000
080600*----------------------------------------------------------------*08270000
080700     COPY PCWS205.                                                08280000
080800                                                                  08290000
080900*----------------------------------------------------------------*08300000
081000*  BATCH LABEL - CS LABEL DATA                                   *08310000
081100*----------------------------------------------------------------*08320000
081200     COPY PCWS189.                                                08330000
081300                                                                  08340000
081400*----------------------------------------------------------------*08350000
081500*  BATCH LABEL - MESSAGE   LABEL FORM                            *08360000
081600*----------------------------------------------------------------*08370000
081700     COPY PCWS178.                                                08380000
081800                                                                  08390000
081900*----------------------------------------------------------------*08400000
082000*  BATCH LABEL - MESSAGE LABEL DATA                              *08410000
082100*----------------------------------------------------------------*08420000
082200     COPY PCWS179.                                                08430000
082300                                                                  08440000
082400*----------------------------------------------------------------*08450000
082500*  BARCODE COPYBOOK                                              *08460000
082600*----------------------------------------------------------------*08470000
082700     COPY PCWS160.                                                08480000
082800                                                                  08490000
082900*----------------------------------------------------------------*08500000
083000*  LABEL PRINT MANAGEMENT SYSTEM - 'EZASOKET' ERROR MESSAGES     *08510000
083100*----------------------------------------------------------------*08520000
083200     COPY PCWS138.                                                08530000
083300                                                                  08540000
083400*----------------------------------------------------------------*08550000
083500*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               08560000
083600*----------------------------------------------------------------*08570000
083700     COPY DPWS013.                                                08580000
083800                                                                  08590000
083900*----------------------------------------------------------------*08600000
084000*  SENDING/RECEIVING AREA FOR THE                                *08610000
084100*  PRINTER VALIDATION ROUTING (DPKCS060)                         *08620000
084200*----------------------------------------------------------------*08630000
084300     COPY DPWS072.                                                08640000
084400                                                                  08650000
084500******************************************************************08660000
084600*    COPY BOOK FOR THE CICSAUTH SUBROUTINE                        08670000
084700******************************************************************08680000
084800*    COPY DPWS008.                                                08690000
084900*                                                                 08700000
085000******************************************************************08710000
085100*  SENDING/RECEIVING AREA FOR THE NUMERIC EDIT ROUTINE (DPKUT100) 08720000
085200******************************************************************08730000
085300     COPY DPWS010I.                                               08740000
085400                                                                  08750000
085500******************************************************************08760000
085600*  GENERATED DSECT FOR THE SUKM707 MAPSET                         08770000
085700******************************************************************08780000
085800     COPY SUKM707.                                                08790000
085900                                                                  08800000
086000******************************************************************08810000
086100*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST   08820000
086200******************************************************************08830000
086300     COPY DPWS015.                                                08840000
086400                                                                  08850000
086500*----------------------------------------------------------------*08860000
086600* HELP SCREEN COMMAREA                                            08870000
086700     COPY PCWS192.                                                08880000
086800*----------------------------------------------------------------*08890000
086900* HELP SCREEN WORK AREA                                           08900000
087000     COPY PCWS188.                                                08910000
087100                                                                  08920000
087200******************************************************************08930000
087300*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      08940000
087400******************************************************************08950000
087500     COPY DFHAID.                                                 08960000
087600                                                                  08970000
087700*----------------------------------------------------------------*08980000
087800*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE LABEL PRINT DATA  *08990000
087900*  TABLE                                                         *09000000
088000*----------------------------------------------------------------*09010000
088100     EXEC SQL                                                     09020000
088200         INCLUDE TLBPTDA                                          09030000
088300     END-EXEC.                                                    09040000
088400                                                                  09050000
088500*----------------------------------------------------------------*09060000
088600*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE LABEL TRANSACTION *09070000
088700*  HISTORY TABLE                                                 *09080000
088800*----------------------------------------------------------------*09090000
088900     EXEC SQL                                                     09100000
089000         INCLUDE TLBTKHS                                          09110000
089100     END-EXEC.                                                    09120000
089200                                                                  09130000
089300*----------------------------------------------------------------*09140000
089400*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE LABEL TRANSACTION *09150000
089500*  ID TABLE                                                      *09160000
089600*----------------------------------------------------------------*09170000
089700     EXEC SQL                                                     09180000
089800         INCLUDE TLBTKID                                          09190000
089900     END-EXEC.                                                    09200000
090000                                                                  09210000
090100*----------------------------------------------------------------*09220000
090200*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE CONTROL TABLE     *09230000
090300*----------------------------------------------------------------*09240000
090400     EXEC SQL                                                     09250000
090500         INCLUDE TCOCNTL                                          09260000
090600     END-EXEC.                                                    09270000
090700                                                                  09280000
090800*----------------------------------------------------------------*09290000
090900*  DCLGEN LAYOUT AND COBOL DECLARATION                           *09300000
091000*----------------------------------------------------------------*09310000
091100     EXEC SQL                                                     09320000
091200         INCLUDE TVHTRIP                                          09330000
091300     END-EXEC.                                                    09340000
091400                                                                  09350000
091500*----------------------------------------------------------------*09360000
091600*  DCLGEN LAYOUT AND COBOL DECLARATION FOR LOGISTICS DOMAIN       09370000
091700*  LOCATION MASTER TABLE                                          09380000
091800*----------------------------------------------------------------*09390000
091900     EXEC SQL                                                     09400000
092000         INCLUDE XLT00010                                         09410000
092100     END-EXEC.                                                    09420000
092200                                                                  09430000
092300*----------------------------------------------------------------*09440000
092400*  DCLGEN LAYOUT AND COBOL DECLARATION                           *09450000
092500*----------------------------------------------------------------*09460000
092600     EXEC SQL                                                     09470000
092700         INCLUDE TSULBXF                                          09480000
092800     END-EXEC.                                                    09490000
092900                                                                  09500000
093000*----------------------------------------------------------------*09510000
093100*  DCLGEN LAYOUT AND COBOL DECLARATION                           *09520000
093200*----------------------------------------------------------------*09530000
093300     EXEC SQL                                                     09540000
093400         INCLUDE TKRPRPM                                          09550000
093500     END-EXEC.                                                    09560000
093600                                                                  09570000
093700*----------------------------------------------------------------*09580000
093800*  DCLGEN LAYOUT AND COBOL DECLARATION  SUT_PO_AUD_REQ           *09590000
093900*----------------------------------------------------------------*09600000
094000     EXEC SQL                                                     09610000
094100         INCLUDE SUT00015                                         09620000
094200     END-EXEC.                                                    09630000
094300                                                                  09640000
094400*----------------------------------------------------------------*09650000
094500*  DCLGEN LAYOUT AND COBOL DECLARATION  AUDIT PO TABLE           *09660000
094600*----------------------------------------------------------------*09670000
094700     EXEC SQL                                                     09680000
094800         INCLUDE TSUATRN                                          09690000
094900     END-EXEC.                                                    09700000
095000                                                                  09710000
095100* WR41309-RF ID 8/30/2012  AME  BEGIN                             09720000
095200*----------------------------------------------------------------*09730000
095300*  DCLGEN LAYOUT AND COBOL DECLARATION  PROCESS MESSAGE CONTROL  *09740000
095400*  TABLE, SUT_PRC_MSG_CNTL                                       *09750000
095500*----------------------------------------------------------------*09760000
095600     EXEC SQL                                                     09770000
095700         INCLUDE SUT00094                                         09780000
095800     END-EXEC.                                                    09790000
095900                                                                  09800000
096000* WR41309-RF ID 8/30/2012  AME  end                               09810000
096100*-----------------------------------------------------------------09820000
096200* LABEL BATCH CURSOR - THIS CURSOR WILL RETRIEVE ALL THE LABEL    09830000
096300* INFORMATION FOR A GIVEN TRIP/USERID/BATCH #                     09840000
096400*-----------------------------------------------------------------09850000
096500     EXEC SQL                                                     09860000
096600          DECLARE  LABEL_CURSOR CURSOR WITH HOLD FOR              09870000
096700           SELECT  TRIP_ID                                        09880000
096800                  ,CRE_USR_ID                                     09890000
096900                  ,LBL_PRT_BTCH_ID                                09900000
097000                  ,SHIPT_UNT_ID                                   09910000
097100                  ,OPER_UNT_ID                                    09920000
097200                  ,FCLTY_ID                                       09930000
097300                  ,CRE_TMST                                       09940000
097400                  ,OWNR_SCAC_ID                                   09950000
097500                  ,VEH_NBR                                        09960000
097600                  ,RPRT_IND                                       09970000
097700                  ,SU_DUP_LBL_IND                                 09980000
097800                  ,SU_FRE_ASTRA_IND                               09990000
097900                  ,SU_MSSG_DAT_IND                                10000000
098000                  ,SU_MISDIR_IND                                  10010000
098100                  ,MISDIR_OPER_UNT_ID                             10020000
098200                  ,PO_NBR                                         10030000
098300                  ,RCVR_SEQ_NBR                                   10040000
098400                  ,PO_LNE_NBR                                     10050000
098500                  ,DEST_OPER_UNT_ID                               10060000
098600                  ,STR_NM                                         10070000
098700                  ,STR_ZN_ID                                      10080000
098800                  ,SKU_DEPT_NBR                                   10090000
098900                  ,SKU_CL_NBR                                     10100000
099000                  ,VS_NBR                                         10110000
099100                  ,OTPK_UNT_QTY                                   10120000
099200                  ,INPK_UNT_QTY                                   10130000
099300                  ,PRTR_ID                                        10140000
099400                  ,BRCDE_NBR                                      10150000
099500                  ,DC_PRTD_AT_CDE                                 10160000
099600                  ,INVLD_DAT_ERR_CDE                              10170000
099700                  ,PREPK_ID                                       10180000
099800                  ,PREPK_RATO_QTY                                 10190000
099900                  ,PREPK_UNT_QTY                                  10200000
100000                  ,CSE_PK_QTY                                     10210000
100100                  ,ODD_CART_IND                                   10220000
100200                  ,INPK_CNVYB_IND                                 10230000
100300                  ,LBL_TYP_LBL_SEQ_ID                             10240000
100400                  ,LBL_TYP_TOT_QTY                                10250000
100500                  ,MODU_DESC                                      10260000
100600                  ,ITM_NBR                                        10270000
100700                  ,DEPT_DESC                                      10280000
100800                  ,MAJ_CL_DESC                                    10290000
100900                  ,SEASET_NM                                      10300000
101000                  ,FIXT_ID                                        10310000
101100                  ,CART_LBL_TYP_CDE                               10320000
101200                  ,STRG_AREA_CDE                                  10330000
101300                  ,CART_ACTN_CDE                                  10340000
101400                  ,HNG_FOLD_SEQ_NBR                               10350000
101500                  ,BUS_AREA_ID                                    10360000
101600                  ,SKU_NBR                                        10370000
101700                  ,RTRIM(DEPT_DESC)||'/'||RTRIM(MAJ_CL_DESC)      10380000
101800                  ,EAS_TAG_IND                                    10390000
101900                  ,DOOR_ID                                        10400000
      *CLP 06/24/15 START                                               10410019
102000                  ,LBL_MSG_TXT                                    10420019
      *CLP 06/24/15 END                                                 10430019
102200                  ,PRC_MSG_CDE                                    10440000
102400             FROM  TLBPTDA                                        10450000
102500            WHERE  TRIP_ID         = :SU001-MANIFEST              10460000
102600              AND  CRE_USR_ID      = :SU001-USER-ID-USE           10470000
102700              AND  LBL_PRT_BTCH_ID = :SU001-BATCH-NO-USE          10480000
102800            ORDER  BY CRE_TMST                                    10490000
102900     END-EXEC.                                                    10500000
103000                                                                  10510000
103100                                                                  10520000
103200*----------------------------------------------------------------*10530000
103300*  COMMUNICATIONS AREA FOR DB2                                   *10540000
103400*----------------------------------------------------------------*10550000
103500     EXEC SQL                                                     10560000
103600         INCLUDE SQLCA                                            10570000
103700     END-EXEC.                                                    10580000
103800                                                                  10590000
103900                                                                  10600000
104000******************************************************************10610000
104100 LINKAGE SECTION.                                                 10620000
104200******************************************************************10630000
104300*01  DFHCOMMAREA                         PIC  X(500).             10640000
104400 01  DFHCOMMAREA.                                                 10650000
104500     05  FILLER                       OCCURS 1 TO 4072 TIMES      10660000
104600                                      DEPENDING ON EIBCALEN.      10670000
104700         10  FILLER                   PIC X.                      10680000
104800                                                                  10690000
104900******************************************************************10700000
105000 PROCEDURE DIVISION.                                              10710000
105100******************************************************************10720000
105200 0000-PROGRAM-MAINLINE.                                           10730000
105300                                                                  10740000
105400     PERFORM 1000-CHECK-COMMAREA.                                 10750000
105500                                                                  10760000
105600     PERFORM 1100-GET-SOCKET-TIMEOUT.                             10770000
105700     PERFORM 1150-LBL-DIVIDER-PRINT.                              10780000
105800                                                                  10790000
105900     MOVE LOW-VALUES                 TO SU707AI.                  10800000
106000                                                                  10810000
106100     EVALUATE TRUE                                                10820000
106200         WHEN EIBCALEN = ZERO                                     10830000
106300              IF  SU001-LBL-PRT-AT-SCAN                           10840000
106400                  MOVE SU001-USER-ID         TO  SU001-USER-ID-USE10850000
106500                  MOVE SU001-PRINTER-ID-USE  TO  PV-PRINTER-HOLD  10860000
106600                  MOVE PV-PRINTER-1-3        TO  PV-PRINTER-ID    10870000
106700                  PERFORM 2245-VALIDATE-PRINTER-ID                10880000
106800                  IF  PS-VALID-INPUT                              10890000
106900                      PERFORM 3000-GET-LABEL-INFORMATION          10900000
107000                      SET  PS-INVALID-TRANS-ID  TO  TRUE          10910000
107100                      PERFORM 4370-CREATE-TRANS-ID                10920000
107200                              UNTIL PS-VALID-TRANS-ID             10930000
107300                      PERFORM 4000-LABEL-ROUTINE                  10940000
107400                  END-IF                                          10950000
107500              ELSE                                                10960000
107600                  PERFORM 3030-GET-LAST-BATCH                     10970000
107800                  MOVE PV-LAST-BATCH-NUMBER TO  ALSTNOO           10980000
107900                  MOVE SU001-PRINTER-ID     TO  PV-PRINTER-HOLD   10990000
108000                  MOVE PV-PRINTER-1-3       TO  APRTIDO           11000000
108100                  MOVE SU001-BATCH-NUMBER   TO  ABATCHO           11010000
108200                  MOVE SU001-USER-ID        TO  AUSERO            11020000
108300                  SET SU001-PROCESS-SCREEN  TO  TRUE              11030000
108400                  PERFORM 8000-SEND-MAP                           11040000
108500                  PERFORM 8200-RETURN-TRANID                      11050000
108600              END-IF                                              11060000
108700                                                                  11070000
108800****************************************************************  11080000
108900* DPKRF278 IS THE PGM FOR THE HELP SCREEN.                        11090000
109000****************************************************************  11100000
109100         WHEN EIBTRNID = 'Z278'                                   11110000
109200             MOVE DFHCOMMAREA          TO PC192-COMMAREA          11120000
109300             MOVE PC192-HOST-SAVE-AREA TO CA-COMMAREA             11130000
109400              PERFORM 3030-GET-LAST-BATCH                         11140000
109600              MOVE PV-LAST-BATCH-NUMBER    TO  ALSTNOO            11150000
109700              MOVE -1                      TO  APRTIDL            11160000
109800              MOVE DP015-UNP-ALP-NOR-MDT   TO  APRTIDA            11170000
109900                                               ABATCHA            11180000
110000                                               AUSERA             11190000
110100              MOVE SU001-PRINTER-ID        TO  PV-PRINTER-HOLD    11200000
110200              MOVE PV-PRINTER-1-3          TO  APRTIDO            11210000
110300              MOVE SU001-BATCH-NUMBER      TO  ABATCHO            11220000
110400              MOVE SU001-USER-ID           TO  AUSERO             11230000
110500              MOVE SU001-USER-ID           TO  SU001-USER-ID-USE  11240000
110600              SET  SU001-PROCESS-SCREEN    TO  TRUE               11250000
110700             PERFORM 8000-SEND-MAP                                11260000
110800             PERFORM 8200-RETURN-TRANID                           11270000
110900                                                                  11280000
111000         WHEN EIBAID = DFHCLEAR                                   11290000
111100         WHEN SU001-INITIALIZE-SCREEN                             11300000
111200              PERFORM 3030-GET-LAST-BATCH                         11310000
111300              MOVE PV-LAST-BATCH-NUMBER    TO  ALSTNOO            11320000
111400              MOVE -1                      TO  APRTIDL            11330000
111500              MOVE DP015-UNP-ALP-NOR-MDT   TO  APRTIDA            11340000
111600                                               ABATCHA            11350000
111700                                               AUSERA             11360000
111800              MOVE SU001-PRINTER-ID        TO  PV-PRINTER-HOLD    11370000
111900              MOVE PV-PRINTER-1-3          TO  APRTIDO            11380000
112000              MOVE SU001-BATCH-NUMBER      TO  ABATCHO            11390000
112100              MOVE SU001-USER-ID           TO  AUSERO             11400000
112200              MOVE SU001-USER-ID           TO  SU001-USER-ID-USE  11410000
112300              SET  SU001-PROCESS-SCREEN    TO  TRUE               11420000
112400              PERFORM 8000-SEND-MAP                               11430000
112500              PERFORM 8200-RETURN-TRANID                          11440000
112600                                                                  11450000
112700         WHEN EIBAID = DFHPF3                                     11460000
112800             MOVE PC-SU-RFID-CONTROL-PGM TO PV-TRANSFER-PROGRAM   11470000
112900             PERFORM 2100-XCTL-TO-SELECTED-PROGRAM                11480000
113000                                                                  11490000
113100         WHEN EIBAID = DFHPF4                                     11500000
113200             SET PS-VALID-INPUT  TO  TRUE                         11510000
113300             PERFORM 2000-PROCESS-SCREEN-FIELDS                   11520000
113400                                                                  11530000
113500             IF  PS-VALID-INPUT                                   11540000
113600                 IF  PS-VALID-INPUT                               11550000
113700                     PERFORM 3000-GET-LABEL-INFORMATION           11560000
113800                     SET  PS-INVALID-TRANS-ID  TO  TRUE           11570000
113900                     PERFORM 4370-CREATE-TRANS-ID                 11580000
114000                             UNTIL PS-VALID-TRANS-ID              11590000
114100                     PERFORM 4000-LABEL-ROUTINE                   11600000
114200                     IF  PS-SOCKET-ERROR                          11610000
114300                         PERFORM 8100-SEND-DATA-ONLY              11620000
114400                         PERFORM 8200-RETURN-TRANID               11630000
114500                     ELSE                                         11640000
114600                         MOVE PC-LABELS-SUBMITTED TO AMSGLNO      11650000
114700                         IF  SU001-BATCH-NO-USE =                 11660000
114800                             SU001-BATCH-NUMBER     AND           11670000
114900                             SU001-USER-ID-USE  =                 11680000
115000                             SU001-USER-ID                        11690000
115100                             ADD  1      TO SU001-BATCH-NUMBER    11700000
115200                             MOVE ZEROES TO SU001-ROWS-INSERTED   11710000
115300                         END-IF                                   11720000
115400*                                                                 11730000
115500                         MOVE SU001-PRINTER-ID-USE  TO APRTIDO    11740000
115600                         MOVE SU001-BATCH-NO-USE                  11750000
115700                           TO PV-BATCH-NUMBER-HOLD                11760000
115900                         MOVE PV-BATCH-NUMBER-HOLD  TO ABATCHO    11770000
116000                         MOVE SU001-USER-ID-USE     TO AUSERO     11780000
116100                         PERFORM 8000-SEND-MAP                    11790000
116200                         PERFORM 8200-RETURN-TRANID               11800000
116300                     END-IF                                       11810000
116400                 ELSE                                             11820000
116500                     PERFORM 8100-SEND-DATA-ONLY                  11830000
116600                     PERFORM 8200-RETURN-TRANID                   11840000
116700                 END-IF                                           11850000
116800             ELSE                                                 11860000
116900                 PERFORM 8100-SEND-DATA-ONLY                      11870000
117000                 PERFORM 8200-RETURN-TRANID                       11880000
117100             END-IF                                               11890000
117200                                                                  11900000
117300         WHEN EIBAID = DFHENTER                                   11910000
117400              PERFORM 8100-SEND-DATA-ONLY                         11920000
117500              PERFORM 8200-RETURN-TRANID                          11930000
117600                                                                  11940000
117700         WHEN EIBAID = DFHPF1                                     11950000
117800              PERFORM 1400-HELP-SCREEN                            11960000
117900                                                                  11970000
118000         WHEN OTHER                                               11980000
118100              MOVE PC-UNRECOGNIZED-PF-KEY-MSG                     11990000
118200                                     TO AMSGLNO                   12000000
118300              PERFORM 8100-SEND-DATA-ONLY                         12010000
118400              PERFORM 8200-RETURN-TRANID                          12020000
118500     END-EVALUATE.                                                12030000
118600                                                                  12040000
118700     GOBACK.                                                      12050000
118800                                                                  12060000
118900                                                                  12070000
119000******************************************************************12080000
119100** CHECK FOR A COMMAREA UPON ENTRANCE INTO A CICS PROGRAM         12090000
119200** PASSING CONTROL BETWEEN PROGRAMS IS DONE USING A               12100000
119300** 'START', HENCE THE NEED FOR THE 'RETRIEVE' COMMAND.            12110000
119400******************************************************************12120000
119500 1000-CHECK-COMMAREA.                                             12130000
119600                                                                  12140000
119700     IF  EIBCALEN = ZERO                                          12150000
119800         MOVE LENGTH OF CA-COMMAREA TO PV-COMMAREA-LENGTH         12160000
119900         EXEC CICS                                                12170000
120000             RETRIEVE                                             12180000
120100                 INTO   (CA-COMMAREA)                             12190000
120200                 LENGTH (PV-COMMAREA-LENGTH)                      12200000
120300                 RESP   (PV-CICS-RESPONSE)                        12210000
120400         END-EXEC                                                 12220000
120500     ELSE                                                         12230000
120600         MOVE DFHCOMMAREA            TO CA-COMMAREA               12240000
120700     END-IF.                                                      12250000
120800                                                                  12260000
120900                                                                  12270000
121000*----------------------------------------------------------------*12280000
121100* SELECT SOCKET TIMEOUT FROM PARAMETER DATABASE                  *12290000
121200* DMH - 10/06/04 - BEGIN                                          12300000
121300*----------------------------------------------------------------*12310000
121400 1100-GET-SOCKET-TIMEOUT.                                         12320000
121500                                                                  12330000
121600     EXEC SQL                                                     12340000
121700          SELECT  FUNC_QTY                                        12350000
121800            INTO :KRPRPM-FUNC-QTY                                 12360000
121900            FROM  TKRPRPM                                         12370000
122000           WHERE  LOC_ID            =  90                         12380000
122100             AND  SYS_PRC_FUNC_CDE  = 'SCKTM2'                    12390000
122200             AND  FUNC_PRC_STAT_CDE = 'AC'                        12400000
122300             AND  INTFC_SYS_CDE     = 'KHL'                       12410000
122400     END-EXEC.                                                    12420000
122500                                                                  12430000
122600     EVALUATE TRUE                                                12440000
122700                                                                  12450000
122800         WHEN SQLCODE = +0                                        12460000
122900              MOVE KRPRPM-FUNC-QTY  TO  SELECT-SECS               12470000
123000                                                                  12480000
123100         WHEN SQLCODE = +100                                      12490000
123200              CONTINUE                                            12500000
123300                                                                  12510000
123400         WHEN SQLCODE = -811                                      12520000
123500         WHEN SQLCODE = -904                                      12530000
123600         WHEN SQLCODE = -913                                      12540000
123700             MOVE '1100-GET-SOCKET-TIMEOUT   '                    12550000
123800                             TO DP013-PARAGRAPH                   12560000
123900             MOVE 'SUKRF707 - GET SOCKET TIMEOUT VALUE'           12570000
124000                                   TO DP013-MESSAGE-TEXT(1)       12580000
124100             MOVE   SU001-MANIFEST TO PV-DISPLAY-MANIFEST         12590000
124200             STRING ' TRIP-'                                      12600000
124300                    PV-DISPLAY-MANIFEST                           12610000
124400                    ' USER ID-'                                   12620000
124500                    SU001-USER-ID                                 12630000
124600                    ' USER ID REQ-'                               12640000
124700                    SU001-USER-ID-USE                             12650000
124800                    ' BATCH NUMBER-'                              12660000
124900                    PV-BATCH-NUMBER-N     DELIMITED BY SIZE       12670000
125000                                 INTO DP013-MESSAGE-TEXT (2)      12680000
125100             MOVE SQLCA            TO DP013-SQLCA                 12690000
125200             MOVE 'TKRPRPM'        TO DP013-DB2-TABLE-NAME(1)     12700000
125300             SET DP013-DB2-ABEND             TO TRUE              12710000
125400             SET DP013-NO-ROLLBACK           TO TRUE              12720000
125500             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              12730000
125600             PERFORM DP014-0000-PROCESS-ABEND                     12740000
125700         WHEN SQLWARN0 NOT = SPACES                               12750000
125800         WHEN SQLCODE < +0                                        12760000
125900         WHEN SQLCODE > +0                                        12770000
126000             MOVE '1100-GET-SOCKET-TIMEOUT   '                    12780000
126100                             TO DP013-PARAGRAPH                   12790000
126200             MOVE 'SUKRF707 - GET SOCKET TIMEOUT VALUE'           12800000
126300                                   TO DP013-MESSAGE-TEXT(1)       12810000
126400             MOVE   SU001-MANIFEST TO PV-DISPLAY-MANIFEST         12820000
126500             STRING ' TRIP-'                                      12830000
126600                    PV-DISPLAY-MANIFEST                           12840000
126700                    ' USER ID-'                                   12850000
126800                    SU001-USER-ID                                 12860000
126900                    ' USER ID REQ-'                               12870000
127000                    SU001-USER-ID-USE                             12880000
127100                    ' BATCH NUMBER-'                              12890000
127200                    PV-BATCH-NUMBER-N     DELIMITED BY SIZE       12900000
127300                                 INTO DP013-MESSAGE-TEXT (2)      12910000
127400             MOVE SQLCA            TO DP013-SQLCA                 12920000
127500             MOVE 'TKRPRPM'        TO DP013-DB2-TABLE-NAME(1)     12930000
127600             SET DP013-DB2-ABEND             TO TRUE              12940000
127700             SET DP013-NO-ROLLBACK           TO TRUE              12950000
127800             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              12960000
127900             PERFORM DP014-0000-PROCESS-ABEND                     12970000
128000     END-EVALUATE.                                                12980000
128200                                                                  12990000
128300                                                                  13000000
128400*----------------------------------------------------------------*13010000
128500* check to see if header/trailer labels should print             *13020000
128700*----------------------------------------------------------------*13030000
128800 1150-LBL-DIVIDER-PRINT.                                          13040000
128900                                                                  13050000
129000     MOVE  SU001-OPER-UNT-ID   TO  KRPRPM-LOC-ID.                 13060000
129100                                                                  13070000
129200     EXEC SQL                                                     13080000
129300          SELECT  A.FUNC_TXT                                      13090000
129400               ,  B.FUNC_TXT                                      13100000
129500            INTO :PS-HEADER-DIVIDER-PRINT-SW                      13110000
129600               , :PS-TRAILER-DIVIDER-PRINT-SW                     13120000
129700            FROM  TKRPRPM A                                       13130000
129800               ,  TKRPRPM B                                       13140000
129900           WHERE  A.LOC_ID            = :KRPRPM-LOC-ID            13150000
130000             AND  A.SYS_PRC_FUNC_CDE  = 'RFDHDR'                  13160000
130100             AND  A.FUNC_PRC_STAT_CDE = 'AC'                      13170000
130200             AND  A.INTFC_SYS_CDE     = 'KHL'                     13180000
130300             AND  B.LOC_ID            = :KRPRPM-LOC-ID            13190000
130400             AND  B.SYS_PRC_FUNC_CDE  = 'RFDTRL'                  13200000
130500             AND  B.FUNC_PRC_STAT_CDE = 'AC'                      13210000
130600             AND  B.INTFC_SYS_CDE     = 'KHL'                     13220000
130700     END-EXEC.                                                    13230000
130800                                                                  13240000
130900     EVALUATE TRUE                                                13250000
131000                                                                  13260000
131100         WHEN SQLCODE = +0                                        13270000
131200              CONTINUE                                            13280000
131300                                                                  13290000
131400         WHEN SQLCODE = +100                                      13300000
131500              SET  PS-HEADER-DIVIDER-PRINT-YES                    13310000
131600                   PS-TRAILER-DIVIDER-PRINT-YES TO TRUE           13320000
131700                                                                  13330000
131800         WHEN SQLCODE = -811                                      13340000
131900         WHEN SQLCODE = -904                                      13350000
132000         WHEN SQLCODE = -913                                      13360000
132100             MOVE '1150-LBL-DIVIDER-PRINT    '                    13370000
132200                             TO DP013-PARAGRAPH                   13380000
132300             MOVE 'SUKRF707 - CHECK IF HEADER/DIVERER PRINT'      13390000
132400                                   TO DP013-MESSAGE-TEXT(1)       13400000
132500             MOVE   SU001-MANIFEST TO PV-DISPLAY-MANIFEST         13410000
132600             STRING ' TRIP-'                                      13420000
132700                    PV-DISPLAY-MANIFEST                           13430000
132800                    ' USER ID-'                                   13440000
132900                    SU001-USER-ID                                 13450000
133000                    ' USER ID REQ-'                               13460000
133100                    SU001-USER-ID-USE                             13470000
133200                    ' BATCH NUMBER-'                              13480000
133300                    PV-BATCH-NUMBER-N     DELIMITED BY SIZE       13490000
133400                                 INTO DP013-MESSAGE-TEXT (2)      13500000
133500             MOVE SQLCA            TO DP013-SQLCA                 13510000
133600             MOVE 'TKRPRPM'        TO DP013-DB2-TABLE-NAME(1)     13520000
133700             SET DP013-DB2-ABEND             TO TRUE              13530000
133800             SET DP013-NO-ROLLBACK           TO TRUE              13540000
133900             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              13550000
134000             PERFORM DP014-0000-PROCESS-ABEND                     13560000
134100         WHEN SQLWARN0 NOT = SPACES                               13570000
134200         WHEN SQLCODE < +0                                        13580000
134300         WHEN SQLCODE > +0                                        13590000
134400             MOVE '1150-LBL-DIVIDER-PRINT    '                    13600000
134500                             TO DP013-PARAGRAPH                   13610000
134600             MOVE 'SUKRF707-CHECK PRINT HEADER/TRLR LABEL'        13620000
134700                                   TO DP013-MESSAGE-TEXT(1)       13630000
134800             MOVE   SU001-MANIFEST TO PV-DISPLAY-MANIFEST         13640000
134900             STRING ' TRIP-'                                      13650000
135000                    PV-DISPLAY-MANIFEST                           13660000
135100                    ' USER ID-'                                   13670000
135200                    SU001-USER-ID                                 13680000
135300                    ' USER ID REQ-'                               13690000
135400                    SU001-USER-ID-USE                             13700000
135500                    ' BATCH NUMBER-'                              13710000
135600                    PV-BATCH-NUMBER-N     DELIMITED BY SIZE       13720000
135700                                 INTO DP013-MESSAGE-TEXT (2)      13730000
135800             MOVE SQLCA            TO DP013-SQLCA                 13740000
135900             MOVE 'TKRPRPM'        TO DP013-DB2-TABLE-NAME(1)     13750000
136000             SET DP013-DB2-ABEND             TO TRUE              13760000
136100             SET DP013-NO-ROLLBACK           TO TRUE              13770000
136200             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              13780000
136300             PERFORM DP014-0000-PROCESS-ABEND                     13790000
136400     END-EVALUATE.                                                13800000
136600                                                                  13810000
136700                                                                  13820000
136800*----------------------------------------------------------------*13830000
136900*                                                                *13840000
137000*----------------------------------------------------------------*13850000
137100 1400-HELP-SCREEN.                                                13860000
137200     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM      13870000
137300     MOVE 'SUKRF707'                  TO PC192-PROGRAM-NAME       13880000
137400     COPY PCPD188.                                                13890000
137500     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      13900000
137600     PERFORM 3200-XCTL-TO-HELP.                                   13910000
137700                                                                  13920000
137800                                                                  13930000
137900 2000-PROCESS-SCREEN-FIELDS.                                      13940000
138000                                                                  13950000
138100     PERFORM 2100-RECEIVE-MAP.                                    13960000
138200     PERFORM 2200-EDIT-INPUT.                                     13970000
138300                                                                  13980000
138400                                                                  13990000
138500 2100-RECEIVE-MAP.                                                14000000
138600                                                                  14010000
138700     EXEC CICS                                                    14020000
138800         RECEIVE MAP    ('SU707A')                                14030000
138900                 MAPSET ('SUKM707')                               14040000
139000                 RESP   (PV-CICS-RESPONSE)                        14050000
139100     END-EXEC.                                                    14060000
139200                                                                  14070000
139300     EVALUATE TRUE                                                14080000
139400         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 14090000
139500             PERFORM 2110-RECEIVE-SCREEN-FIELDS                   14100000
139600         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                14110000
139700             CONTINUE                                             14120000
139800         WHEN OTHER                                               14130000
139900            MOVE '2100-RECEIVE-MAP'      TO DP013-PARAGRAPH       14140000
140000            MOVE 'SUKRF502 - UNABLE TO RECEIVE MAP'               14150000
140100                                         TO DP013-MESSAGE-TEXT (1)14160000
140200            SET DP013-LOGIC-ABEND        TO TRUE                  14170000
140300            SET DP013-NO-ROLLBACK        TO TRUE                  14180000
140400            PERFORM 9999-WRITE-CICS-LOG-MSG                       14190000
140500     END-EVALUATE.                                                14200000
140600                                                                  14210000
140700                                                                  14220000
140800 2110-RECEIVE-SCREEN-FIELDS.                                      14230000
140900                                                                  14240000
141000     IF  APRTIDL > ZERO                                           14250000
141100         MOVE APRTIDI TO PV-PRINTER-ID                            14260000
141200     ELSE                                                         14270000
141300         IF APRTIDA = DP015-ERASE-EOF                             14280000
141400             MOVE SPACES TO PV-PRINTER-ID                         14290000
141500         END-IF                                                   14300000
141600     END-IF.                                                      14310000
141700                                                                  14320000
141800     IF  ABATCHL > ZERO                                           14330000
141900         MOVE ABATCHI TO PV-BATCH-NUMBER                          14340000
142000     ELSE                                                         14350000
142100         IF ABATCHA = DP015-ERASE-EOF                             14360000
142200             MOVE SPACES TO PV-BATCH-NUMBER                       14370000
142300         END-IF                                                   14380000
142400     END-IF.                                                      14390000
142500                                                                  14400000
142600     IF  AUSERL > ZERO                                            14410000
142700         MOVE AUSERI TO SU001-USER-ID-USE                         14420000
142800     ELSE                                                         14430000
142900         IF AUSERA = DP015-ERASE-EOF                              14440000
143000             MOVE SU001-USER-ID  TO  SU001-USER-ID-USE            14450000
143100         END-IF                                                   14460000
143200     END-IF.                                                      14470000
143300                                                                  14480000
143400                                                                  14490000
143500                                                                  14500000
143600 2200-EDIT-INPUT.                                                 14510000
143700                                                                  14520000
143800     PERFORM 2210-INIT-ATTR.                                      14530000
143900     PERFORM 2230-EDIT-INPUT.                                     14540000
144000                                                                  14550000
144100                                                                  14560000
144200*----------------------------------------------------------------*14570000
144300* RESET INITIAL ATTRTIBUTES                                      *14580000
144400*----------------------------------------------------------------*14590000
144500 2210-INIT-ATTR.                                                  14600000
144600                                                                  14610000
144700     MOVE -1                         TO APRTIDL.                  14620000
144800     MOVE DP015-UNP-ALP-NOR-MDT      TO APRTIDA                   14630000
144900                                        ABATCHA                   14640000
145000                                        AUSERA.                   14650000
145100                                                                  14660000
145200     MOVE SU001-PRINTER-ID-USE       TO PV-PRINTER-HOLD.          14670000
145300     MOVE PV-PRINTER-1-3             TO APRTIDO.                  14680000
145400     MOVE SU001-BATCH-NO-USE         TO ABATCHO.                  14690000
145500     MOVE SU001-USER-ID-USE          TO AUSERO.                   14700000
                                                                        14710000
145600     MOVE SPACES                     TO AMSGLNO.                  14720000
145700                                                                  14730000
145800                                                                  14740000
145900*----------------------------------------------------------------*14750000
146000* EDIT/VALIDATE DATA                                             *14760000
146100*----------------------------------------------------------------*14770000
146200 2230-EDIT-INPUT.                                                 14780000
146300                                                                  14790000
146400     PERFORM 2240-EDIT-PRINTER-ID.                                14800000
146500     PERFORM 2260-EDIT-BATCH-NBR.                                 14810000
146600                                                                  14820000
146700                                                                  14830000
146800*----------------------------------------------------------------*14840000
146900* VALIDATE PRINTER ID                                            *14850000
147000*----------------------------------------------------------------*14860000
147100 2240-EDIT-PRINTER-ID.                                            14870000
147200                                                                  14880000
147300     EVALUATE TRUE                                                14890000
147400         WHEN PV-PRINTER-ID = SPACES                              14900000
147500             SET PS-INVALID-INPUT        TO TRUE                  14910000
147600             MOVE DP015-UNP-NUM-BRT-MDT  TO APRTIDA               14920000
147700             MOVE -1                     TO APRTIDL               14930000
147800             MOVE PC-INVALID-PRTR-ID     TO AMSGLNO               14940000
147900         WHEN OTHER                                               14950000
148000             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              14960000
148100             MOVE PV-PRINTER-ID  TO  DP010I-UNEDITED-FIELD        14970000
148200             MOVE 03             TO  DP010I-MAXIMUM-DIGITS        14980000
148300             MOVE 0              TO  DP010I-MAXIMUM-DECIMALS      14990000
148400                                                                  15000000
263968             CALL DP010I-NUMERIC-EDIT-ROUTINE                     15011024
263968                  USING DP010I-NUMERIC-EDIT-AREA                  15012024
148600                                                                  15020000
148700             IF  DP010I-ERROR-DETECTED                            15030000
148800                 SET PS-INVALID-INPUT        TO TRUE              15040000
148900                 MOVE DP015-UNP-NUM-BRT-MDT  TO APRTIDA           15050000
149000                 MOVE -1                     TO APRTIDL           15060000
149100                 MOVE PC-MUST-BE-NUM-MSG     TO AMSGLNO           15070000
149200             ELSE                                                 15080000
149300             IF  DP010I-NUMERIC-FIELD = ZEROES                    15090000
149400                 SET PS-INVALID-INPUT        TO TRUE              15100000
149500                 MOVE DP015-UNP-NUM-BRT-MDT  TO APRTIDA           15110000
149600                 MOVE -1                     TO APRTIDL           15120000
149700                 MOVE PC-MUST-BE-GT-0-MSG    TO AMSGLNO           15130000
149800             ELSE                                                 15140000
149900                 PERFORM 2245-VALIDATE-PRINTER-ID                 15150000
150000                 IF  PS-INVALID-PRINTER-ID                        15160000
150100                     SET PS-INVALID-INPUT TO TRUE                 15170000
150200                     MOVE DP015-UNP-NUM-BRT-MDT                   15180000
150300                                             TO APRTIDA           15190000
150400                     MOVE -1                 TO APRTIDL           15200000
150500                     MOVE PC-INVALID-PRTR-ID TO AMSGLNO           15210000
150600                 ELSE                                             15220000
150700                 IF  DP072-PRTR-INTFC-FTP                         15230000
150800                     SET PS-INVALID-INPUT        TO TRUE          15240000
150900                     MOVE DP015-UNP-NUM-BRT-MDT  TO APRTIDA       15250000
151000                     MOVE -1                     TO APRTIDL       15260000
151100                     MOVE PC-INVALID-PRTR-W-BTCH TO AMSGLNO       15270000
151200                 ELSE                                             15280000
151300                     MOVE  PV-PRINTER-ID                          15290000
151400                           TO  SU001-PRINTER-ID-USE               15300000
151500                 END-IF                                           15310000
151600                 END-IF                                           15320000
151700             END-IF                                               15330000
151800             END-IF                                               15340000
151900     END-EVALUATE.                                                15350000
152000                                                                  15360000
152100                                                                  15370000
152200******************************************************************15380000
152300* VALIDATE PRINTER ID                                            *15390000
152400******************************************************************15400000
152500 2245-VALIDATE-PRINTER-ID.                                        15410000
152600                                                                  15420000
152700*** BEGIN - FOR TESTING ONLY                                      15430000
152800*    MOVE  SU001-CURR-OPER-UNT-ID  TO  PV-DISPLAY-CURR-OPER.      15440000
152900*    STRING ' SUKRF707 - '              DELIMITED BY SIZE         15450000
153000*           'SU001-CURR-OPER-UNT-ID-'   DELIMITED BY SIZE         15460000
153100*           PV-DISPLAY-CURR-OPER        DELIMITED BY SIZE         15470000
153200*           '  PRINTER-ID-'             DELIMITED BY SIZE         15480000
153300*           PV-PRINTER-ID               DELIMITED BY SIZE         15490000
153400*           '  SU001-PRINTER-ID-USE-'   DELIMITED BY SIZE         15500000
153500*           SU001-PRINTER-ID-USE        DELIMITED BY SIZE         15510000
153600*                                       INTO PV-CICS-MSG-AREA.    15520000
153700*    MOVE LENGTH OF PV-CICS-MSG-AREA                              15530000
153800*           TO PV-COMMAREA-LENGTH.                                15540000
153900*    PERFORM 9990-WRITE-CICS.                                     15550000
154000*** END - FOR TESTING ONLY                                        15560000
154100                                                                  15570000
154200     IF SU001-PRINT-AND-PEEL                                      15580000
154300        MOVE PC-REPORT-PGM-2        TO  DP072-RPT-PGM-NME         15590000
154400     ELSE                                                         15600000
154500        MOVE PC-REPORT-PGM-1        TO  DP072-RPT-PGM-NME         15610000
154600     END-IF                                                       15620000
154700                                                                  15630000
154800     MOVE PV-PRINTER-ID          TO  DP072-PRINTER-ID.            15640000
154900     MOVE PC-01                  TO  DP072-RPT-PGM-TYP-ID.        15650000
155000     MOVE SU001-CURR-OPER-UNT-ID TO  DP072-ORIGIN-OPER-UNT-ID.    15660000
155100     MOVE SU001-CURR-OPER-UNT-ID TO  DP072-OPER-UNT-ID.           15670000
155200     MOVE 1                      TO  DP072-ORIGIN-FCLTY-ID        15680000
155300                                     DP072-FCLTY-ID.              15690000
155400     SET DP072-VALIDATE          TO  TRUE.                        15700000
155500                                                                  15710000
155600     EXEC CICS                                                    15720000
155700          LINK PROGRAM  (PC-PRTR-VALIDATION-PGM)                  15730000
155800               COMMAREA (DP072-COMM-AREA)                         15740000
155900               RESP     (PV-CICS-RESPONSE)                        15750000
156000     END-EXEC                                                     15760000
156100                                                                  15770000
156200     EVALUATE TRUE                                                15780000
156300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 15790000
156400              PERFORM 2250-VALIDATE-PRINTER-SML                   15800000
156500                                                                  15810000
156600         WHEN OTHER                                               15820000
156700             SET PS-INVALID-PRINTER-ID  TO  TRUE                  15830000
156800     END-EVALUATE.                                                15840000
156900                                                                  15850000
157000                                                                  15860000
157100******************************************************************15870000
157200*  VALIDATE THE PRINTER NUMBER ENTERED ON THE SCREEN TO ENSURE   *15880000
157300*  THIS IS A VALID PRINTER AND THAT SHIPPING MANIFEST LABELS     *15890000
157400*  CAN BE PRINTED ON THIS PRINTER.                               *15900000
157500******************************************************************15910000
157600 2250-VALIDATE-PRINTER-SML.                                       15920000
157700                                                                  15930000
157800     IF  DP072-PRTR-CLUSTER-OS-RLSE-CDE  =  PC-MGMX               15940000
157900         SET  PS-INVALID-PRINTER-ID   TO TRUE                     15950000
158000     END-IF.                                                      15960000
158100                                                                  15970000
158200     IF  DP072-PRTR-PRTR-TRK-STAT-CDE    =  PC-A                  15980000
158300         CONTINUE                                                 15990000
158400     ELSE                                                         16000000
158500         SET  PS-INVALID-PRINTER-ID   TO TRUE                     16010000
158600     END-IF.                                                      16020000
158700                                                                  16030000
158800     MOVE  DP072-PRTR-IP-ADDRESS  TO  PV-IP-ADDRESS.              16040000
158900                                                                  16050000
159000                                                                  16060000
159100*----------------------------------------------------------------*16070000
159200* VALIDATE PRINTER ID                                            *16080000
159300*----------------------------------------------------------------*16090000
159400 2260-EDIT-BATCH-NBR.                                             16100000
159500                                                                  16110000
159600     EVALUATE TRUE                                                16120000
159700         WHEN PV-BATCH-NUMBER = SPACES                            16130000
159800             SET PS-INVALID-INPUT        TO TRUE                  16140000
159900             MOVE DP015-UNP-NUM-BRT-MDT  TO ABATCHA               16150000
160000             MOVE -1                     TO ABATCHL               16160000
160100             MOVE PC-INVALID-BATCH-NO    TO AMSGLNO               16170000
160200         WHEN OTHER                                               16180000
160300             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              16190000
160400             MOVE PV-BATCH-NUMBER  TO  DP010I-UNEDITED-FIELD      16200000
160500*                                                                 16210000
160700             MOVE 04               TO  DP010I-MAXIMUM-DIGITS      16220000
160800             MOVE 0                TO  DP010I-MAXIMUM-DECIMALS    16230000
160900                                                                  16240000
263968             CALL DP010I-NUMERIC-EDIT-ROUTINE                     16251024
263968                  USING DP010I-NUMERIC-EDIT-AREA                  16252024
161100                                                                  16260000
161200             IF  DP010I-ERROR-DETECTED                            16270000
161300                 SET PS-INVALID-INPUT        TO TRUE              16280000
161400                 MOVE DP015-UNP-NUM-BRT-MDT  TO ABATCHA           16290000
161500                 MOVE -1                     TO ABATCHL           16300000
161600                 MOVE PC-MUST-BE-NUM-MSG     TO AMSGLNO           16310000
161700             ELSE                                                 16320000
161800             IF  DP010I-NUMERIC-FIELD = ZEROES                    16330000
161900                 SET PS-INVALID-INPUT        TO TRUE              16340000
162000                 MOVE DP015-UNP-NUM-BRT-MDT  TO ABATCHA           16350000
162100                 MOVE -1                     TO ABATCHL           16360000
162200                 MOVE PC-MUST-BE-GT-0-MSG    TO AMSGLNO           16370000
162300             ELSE                                                 16380000
162400                 MOVE  DP010I-NUMERIC-FIELD TO PV-BATCH-NUMBER-N  16390000
162500                 PERFORM 2265-VALIDATE-BATCH-NUMBER               16400000
162600                 IF  PS-INVALID-BATCH-NUMBER                      16410000
162700                     SET PS-INVALID-INPUT     TO TRUE             16420000
162800                     MOVE DP015-UNP-NUM-BRT-MDT                   16430000
162900                                              TO ABATCHA          16440000
163000                     MOVE -1                  TO ABATCHL          16450000
163100                     MOVE PC-BATCH-NOT-FOUND  TO AMSGLNO          16460000
163200                 ELSE                                             16470000
163300                     MOVE  PV-BATCH-NUMBER-N                      16480000
163400                           TO  SU001-BATCH-NO-USE                 16490000
163500                 END-IF                                           16500000
163600             END-IF                                               16510000
163700             END-IF                                               16520000
163800     END-EVALUATE.                                                16530000
163900                                                                  16540000
164000                                                                  16550000
164100*----------------------------------------------------------------*16560000
164200* VALIDATE PRINTER ID                                            *16570000
164300*----------------------------------------------------------------*16580000
164400 2265-VALIDATE-BATCH-NUMBER.                                      16590000
164500                                                                  16600000
164600     MOVE  SU001-MANIFEST     TO  DK-TRIP-ID.                     16610000
164700     MOVE  SU001-USER-ID-USE  TO  DK-USER-ID.                     16620000
164800     MOVE  PV-BATCH-NUMBER-N  TO  DK-BATCH-NUMBER.                16630000
164900                                                                  16640000
165000     EXEC SQL                                                     16650000
165100         SELECT COUNT(*)                                          16660000
165200         INTO   :PV-DB2-COUNT                                     16670000
165300         FROM   TLBPTDA                                           16680000
165400         WHERE  TRIP_ID          = :DK-TRIP-ID                    16690000
165500           AND  CRE_USR_ID       = :DK-USER-ID                    16700000
165600           AND  LBL_PRT_BTCH_ID  = :DK-BATCH-NUMBER               16710000
165700     END-EXEC.                                                    16720000
165800                                                                  16730000
165900     EVALUATE TRUE                                                16740000
166000         WHEN SQLCODE = ZERO                                      16750000
166100             IF  PV-DB2-COUNT  >  0                               16760000
166200                 SET PS-VALID-BATCH-NUMBER  TO  TRUE              16770000
166300             ELSE                                                 16780000
166400                 SET PS-INVALID-BATCH-NUMBER  TO  TRUE            16790000
166500             END-IF                                               16800000
166600                                                                  16810000
166700         WHEN SQLCODE = +100                                      16820000
166800             SET PS-INVALID-BATCH-NUMBER  TO  TRUE                16830000
166900                                                                  16840000
167000         WHEN SQLWARN0 NOT = SPACES                               16850000
167100         WHEN SQLCODE NOT EQUAL ZERO                              16860000
167200             MOVE '2265-VALIDATE-BATCH-NUMBER'                    16870000
167300                             TO DP013-PARAGRAPH                   16880000
167400             MOVE 'SUKRF707 - VALIDATE BATCH NUMBER'              16890000
167500                             TO DP013-MESSAGE-TEXT(1)             16900000
167600             MOVE   SU001-MANIFEST TO PV-DISPLAY-MANIFEST         16910000
167700             STRING ' TRIP-'              DELIMITED BY SIZE       16920000
167800                    PV-DISPLAY-MANIFEST   DELIMITED BY SIZE       16930000
167900                    ' USER ID-'           DELIMITED BY SIZE       16940000
168000                    SU001-USER-ID         DELIMITED BY SIZE       16950000
168100                    ' USER ID REQ-'       DELIMITED BY SIZE       16960000
168200                    SU001-USER-ID-USE     DELIMITED BY SIZE       16970000
168300                    ' BATCH NUMBER-'      DELIMITED BY SIZE       16980000
168400                    PV-BATCH-NUMBER-N     DELIMITED BY SIZE       16990000
168500                             INTO DP013-MESSAGE-TEXT (2)          17000000
168600             MOVE SQLCA      TO DP013-SQLCA                       17010000
168700             MOVE 'TLBPTDA'  TO DP013-DB2-TABLE-NAME(1)           17020000
168800             SET DP013-DB2-ABEND                                  17030000
168900                             TO TRUE                              17040000
169000             SET DP013-NO-ROLLBACK                                17050000
169100                             TO TRUE                              17060000
169200             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              17070000
169300             PERFORM DP014-0000-PROCESS-ABEND                     17080000
169400     END-EVALUATE.                                                17090000
169500                                                                  17100000
169600                                                                  17110000
169700 2100-XCTL-TO-SELECTED-PROGRAM.                                   17120000
169800     SET SU001-INITIALIZE-SCREEN     TO TRUE.                     17130000
169900     MOVE PC-CURRENT-PROGRAM-NAME    TO SU001-LAST-PROGRAM.       17140000
170000                                                                  17150000
170200     MOVE LENGTH OF CA-COMMAREA     TO PV-COMMAREA-LENGTH         17160000
170300     EXEC CICS                                                    17170000
170400         XCTL                                                     17180000
170500             PROGRAM   (PV-TRANSFER-PROGRAM)                      17190000
170600             COMMAREA  (CA-COMMAREA)                              17200000
170700             LENGTH    (PV-COMMAREA-LENGTH)                       17210000
170800             RESP      (PV-CICS-RESPONSE)                         17220000
170900     END-EXEC.                                                    17230000
171000                                                                  17240000
171100     EVALUATE TRUE                                                17250000
171200         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 17260000
171300              CONTINUE                                            17270000
171400         WHEN OTHER                                               17280000
171500              MOVE '2100-XCTL-TO-SELECTED-PROGRAM'                17290000
171600                                     TO DP013-PARAGRAPH           17300000
171700              MOVE 'UNABLE TO XCTL THE FOLLOWING PROGRAM: '       17310000
171800                                     TO DP013-MESSAGE-TEXT (1)    17320000
171900              MOVE PV-TRANSFER-PROGRAM                            17330000
172000                                     TO DP013-MESSAGE-TEXT (2)    17340000
172100              SET DP013-CICS-ABEND   TO TRUE                      17350000
172200              SET DP013-NO-ROLLBACK  TO TRUE                      17360000
172300              PERFORM 9999-WRITE-CICS-LOG-MSG                     17370000
172400              MOVE PC-TRANS-UNAVAILABLE-MSG                       17380000
172500                                     TO AMSGLNO                   17390000
172600              SET SU001-PROCESS-SCREEN TO TRUE                    17400000
172700              PERFORM 8100-SEND-DATA-ONLY                         17410000
172800              PERFORM 8200-RETURN-TRANID                          17420000
172900     END-EVALUATE.                                                17430000
173000                                                                  17440000
173100                                                                  17450000
173200*----------------------------------------------------------------*17460000
173300* GET LABEL INFORMATION                                          *17470000
173400*----------------------------------------------------------------*17480000
173500 3000-GET-LABEL-INFORMATION.                                      17490000
173600     PERFORM 3005-DATE-TIME.                                      17500000
173700     PERFORM 3010-LABEL-COUNT.                                    17510000
173800     PERFORM 3015-REPRINT-COUNT.                                  17520000
173900**** PERFORM 3020-SCAC-TRAILER. there is no scac trailr per german17530000
174000     PERFORM 3025-EXCEPT-COUNT.                                   17540000
174100                                                                  17550000
174200                                                                  17560000
174300*----------------------------------------------------------------*17570000
174400* GET CURRENT DATE/TIME FROM CONTROL TABLE                       *17580000
174500*----------------------------------------------------------------*17590000
174600 3005-DATE-TIME.                                                  17600000
174700     EXEC SQL                                                     17610000
174800         SELECT  CURRENT DATE                                     17620000
174900               , CURRENT TIME                                     17630000
175000           INTO  :PV-CURRENT-DB2-DATE                             17640000
175100               , :PV-CURRENT-DB2-TIME                             17650000
175200           FROM  TCOCNTL                                          17660000
175300          WHERE  OPER_UNT_ID = 90                                 17670000
175400     END-EXEC.                                                    17680000
175500                                                                  17690000
175600     EVALUATE TRUE                                                17700000
175700         WHEN SQLCODE = ZERO                                      17710000
175800              MOVE  PV-CURRENT-HR  TO  PV-CURRENT-HOUR            17720000
175900              MOVE  PV-CURRENT-MN  TO  PV-CURRENT-MIN             17730000
176000                                                                  17740000
176100         WHEN OTHER                                               17750000
176200              MOVE '3005-DATE-TIME '                              17760000
176300                                  TO DP013-PARAGRAPH              17770000
176400              MOVE 'GET CURRENT DATE/TIME '                       17780000
176500                                  TO DP013-MESSAGE-TEXT (1)       17790000
176600              MOVE SQLCA          TO DP013-SQLCA                  17800000
176700              MOVE 'TCOCNTL'      TO DP013-DB2-TABLE-NAME (1)     17810000
176800              SET DP013-DB2-ABEND TO TRUE                         17820000
176900*             PERFORM 9999-WRITE-CICS-LOG-MSG                     17830000
177000             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              17840000
177100              PERFORM DP014-0000-PROCESS-ABEND                    17850000
177200      END-EVALUATE.                                               17860000
177300                                                                  17870000
177400                                                                  17880000
177500*----------------------------------------------------------------*17890000
177600* GET LABEL COUNT                                                *17900000
177700*----------------------------------------------------------------*17910000
177800 3010-LABEL-COUNT.                                                17920000
177900                                                                  17930000
178000     INITIALIZE PV-DB2-LABEL-COUNT.                               17940000
178100                                                                  17950000
178200     EXEC SQL                                                     17960000
178300          SELECT COUNT(*)                                         17970000
178400            INTO :PV-DB2-LABEL-COUNT                              17980000
178500            FROM TLBPTDA                                          17990000
178600            WHERE  TRIP_ID         = :SU001-MANIFEST              18000000
178700              AND  CRE_USR_ID      = :SU001-USER-ID-USE           18010000
178800              AND  LBL_PRT_BTCH_ID = :SU001-BATCH-NO-USE          18020000
178900     END-EXEC.                                                    18030000
179000                                                                  18040000
179100     EVALUATE TRUE                                                18050000
179200         WHEN SQLCODE = +0                                        18060000
179300              CONTINUE                                            18070000
179400                                                                  18080000
179500         WHEN OTHER                                               18090000
179600             MOVE   SU001-MANIFEST     TO PV-DISPLAY-MANIFEST     18100000
179700             MOVE   SU001-BATCH-NO-USE TO PV-DISPLAY-BATCH-NO     18110000
179800              STRING ' SUKRF707 - '            DELIMITED BY SIZE  18120000
179900                     'SU001-MANIFEST: '        DELIMITED BY SIZE  18130000
180000                     PV-DISPLAY-MANIFEST       DELIMITED BY SIZE  18140000
180100                     '  SU001-USER-ID-USE: '   DELIMITED BY SIZE  18150000
180200                     SU001-USER-ID-USE         DELIMITED BY SIZE  18160000
180300                     '  SU001-BATCH-NO-USE: '  DELIMITED BY SIZE  18170000
180400                      PV-DISPLAY-BATCH-NO       DELIMITED BY SIZE 18180000
180500                                           INTO PV-CICS-MSG-AREA  18190000
180600              MOVE LENGTH OF PV-CICS-MSG-AREA                     18200000
180700                     TO PV-COMMAREA-LENGTH                        18210000
180800              PERFORM 9990-WRITE-CICS                             18220000
180900                                                                  18230000
181000              MOVE '3010-LABEL-COUNT'                             18240000
181100                                  TO DP013-PARAGRAPH              18250000
181200              MOVE 'GET  LABEL COUNT'                             18260000
181300                                  TO DP013-MESSAGE-TEXT (1)       18270000
181400              MOVE SQLCA          TO DP013-SQLCA                  18280000
181500              MOVE 'TLBPTDA'      TO DP013-DB2-TABLE-NAME (1)     18290000
181600              SET DP013-DB2-ABEND TO TRUE                         18300000
181700*             PERFORM 9999-WRITE-CICS-LOG-MSG                     18310000
181800             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              18320000
181900              PERFORM DP014-0000-PROCESS-ABEND                    18330000
182000     END-EVALUATE.                                                18340000
182100                                                                  18350000
182200                                                                  18360000
182300*----------------------------------------------------------------*18370000
182400* GET REPRINT LABEL COUNT                                        *18380000
182500*----------------------------------------------------------------*18390000
182600 3015-REPRINT-COUNT.                                              18400000
182700                                                                  18410000
182800     INITIALIZE PV-DB2-REPRINT-LBL-CNT.                           18420000
182900                                                                  18430000
183000     EXEC SQL                                                     18440000
183100          SELECT COUNT(*)                                         18450000
183200            INTO :PV-DB2-REPRINT-LBL-CNT                          18460000
183300            FROM TLBPTDA                                          18470000
183400            WHERE  TRIP_ID         = :SU001-MANIFEST              18480000
183500              AND  CRE_USR_ID      = :SU001-USER-ID-USE           18490000
183600              AND  LBL_PRT_BTCH_ID = :SU001-BATCH-NO-USE          18500000
183700*LMM          AND  RPRT_IND        = :PC-R                        18510000
183800              AND  RPRT_IND        = 'Y'                          18520000
183900     END-EXEC.                                                    18530000
184000                                                                  18540000
184100     EVALUATE TRUE                                                18550000
184200         WHEN SQLCODE = +0                                        18560000
184300              CONTINUE                                            18570000
184400                                                                  18580000
184500         WHEN OTHER                                               18590000
184600             MOVE   SU001-MANIFEST     TO PV-DISPLAY-MANIFEST     18600000
184700             MOVE   SU001-BATCH-NO-USE TO PV-DISPLAY-BATCH-NO     18610000
184800              STRING ' SUKRF707 - '            DELIMITED BY SIZE  18620000
184900                     'SU001-MANIFEST: '        DELIMITED BY SIZE  18630000
185000                     PV-DISPLAY-MANIFEST       DELIMITED BY SIZE  18640000
185100                     '  SU001-USER-ID-USE: '   DELIMITED BY SIZE  18650000
185200                     SU001-USER-ID-USE         DELIMITED BY SIZE  18660000
185300                     '  SU001-BATCH-NO-USE: '  DELIMITED BY SIZE  18670000
185400                      PV-DISPLAY-BATCH-NO       DELIMITED BY SIZE 18680000
185500                                           INTO PV-CICS-MSG-AREA  18690000
185600              MOVE LENGTH OF PV-CICS-MSG-AREA                     18700000
185700                     TO PV-COMMAREA-LENGTH                        18710000
185800              PERFORM 9990-WRITE-CICS                             18720000
185900                                                                  18730000
186000              MOVE '3015-REPRINT-COUNT'                           18740000
186100                                  TO DP013-PARAGRAPH              18750000
186200              MOVE 'GET REPRINT LABEL COUNT'                      18760000
186300                                  TO DP013-MESSAGE-TEXT (1)       18770000
186400              MOVE SQLCA          TO DP013-SQLCA                  18780000
186500              MOVE 'TLBPTDA'      TO DP013-DB2-TABLE-NAME (1)     18790000
186600              SET DP013-DB2-ABEND TO TRUE                         18800000
186700*             PERFORM 9999-WRITE-CICS-LOG-MSG                     18810000
186800             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              18820000
186900              PERFORM DP014-0000-PROCESS-ABEND                    18830000
187000     END-EVALUATE.                                                18840000
187100                                                                  18850000
187200                                                                  18860000
187300*----------------------------------------------------------------*18870000
187400* GET SCAC & TRAILER NUMBER                                      *18880000
187500*----------------------------------------------------------------*18890000
187600 3020-SCAC-TRAILER.                                               18900000
187700                                                                  18910000
187800     INITIALIZE PV-OWNER-SCAC-ID                                  18920000
187900                PV-VEH-NBR.                                       18930000
188000                                                                  18940000
188100     EXEC SQL                                                     18950000
188200         SELECT OWNER_SCAC_ID                                     18960000
188300              , VEH_NBR                                           18970000
188400          INTO :PV-OWNER-SCAC-ID                                  18980000
188500              ,:PV-VEH-NBR           :PV-NULL-IND                 18990000
188600          FROM  TVHTRIP                                           19000000
188700            WHERE  TRIP_ID         = :SU001-MANIFEST              19010000
188800     END-EXEC.                                                    19020000
188900                                                                  19030000
189000     EVALUATE TRUE                                                19040000
189100         WHEN SQLCODE = +0                                        19050000
189200              CONTINUE                                            19060000
189300                                                                  19070000
189400         WHEN OTHER                                               19080000
189500             MOVE   SU001-MANIFEST     TO PV-DISPLAY-MANIFEST     19090000
189600             MOVE   SU001-BATCH-NO-USE TO PV-DISPLAY-BATCH-NO     19100000
189700              STRING ' SUKRF707 - '            DELIMITED BY SIZE  19110000
189800                     'SU001-MANIFEST: '        DELIMITED BY SIZE  19120000
189900                     PV-DISPLAY-MANIFEST       DELIMITED BY SIZE  19130000
190000                     '  SU001-USER-ID: '       DELIMITED BY SIZE  19140000
190100                     SU001-USER-ID             DELIMITED BY SIZE  19150000
190200                     '  SU001-BATCH-NO-USE: '  DELIMITED BY SIZE  19160000
190300                      PV-DISPLAY-BATCH-NO       DELIMITED BY SIZE 19170000
190400                                           INTO PV-CICS-MSG-AREA  19180000
190500              MOVE LENGTH OF PV-CICS-MSG-AREA                     19190000
190600                     TO PV-COMMAREA-LENGTH                        19200000
190700              PERFORM 9990-WRITE-CICS                             19210000
190800                                                                  19220000
190900              MOVE '3020-SCAC-TRAILER'                            19230000
191000                                  TO DP013-PARAGRAPH              19240000
191100              MOVE 'GET SCAC AND TRAILER NUMBER'                  19250000
191200                                  TO DP013-MESSAGE-TEXT (1)       19260000
191300              MOVE SQLCA          TO DP013-SQLCA                  19270000
191400              MOVE 'TLBPTDA'      TO DP013-DB2-TABLE-NAME (1)     19280000
191500              SET DP013-DB2-ABEND TO TRUE                         19290000
191600*             PERFORM 9999-WRITE-CICS-LOG-MSG                     19300000
191700             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              19310000
191800              PERFORM DP014-0000-PROCESS-ABEND                    19320000
191900     END-EVALUATE.                                                19330000
192000                                                                  19340000
192100                                                                  19350000
192200*----------------------------------------------------------------*19360000
192300* GET EXCEPTIONS COUNT                                           *19370000
192400*----------------------------------------------------------------*19380000
192500 3025-EXCEPT-COUNT.                                               19390000
192600                                                                  19400000
192700     INITIALIZE PV-DB2-EXCEPT-LBL-CNT.                            19410000
192800                                                                  19420000
192900     EXEC SQL                                                     19430000
193000          SELECT COUNT(*)                                         19440000
193100            INTO :PV-DB2-EXCEPT-LBL-CNT                           19450000
193200            FROM TLBPTDA                                          19460000
193300            WHERE  TRIP_ID            = :SU001-MANIFEST           19470000
193400              AND  CRE_USR_ID         = :SU001-USER-ID-USE        19480000
193500              AND  LBL_PRT_BTCH_ID    = :SU001-BATCH-NO-USE       19490000
193600              AND (SU_FRE_ASTRA_IND  IN ('Y', 'R', 'T')  OR       19500000
193700                   SU_MSSG_DAT_IND    = 'Y'              OR       19510000
193800                   SU_MISDIR_IND      = 'Y'              OR       19520000
193900                   SU_DUP_LBL_IND     = 'Y')                      19530000
194000     END-EXEC.                                                    19540000
194100                                                                  19550000
194200     EVALUATE TRUE                                                19560000
194300         WHEN SQLCODE = +0                                        19570000
194400              CONTINUE                                            19580000
194500                                                                  19590000
194600         WHEN OTHER                                               19600000
194700             MOVE   SU001-MANIFEST     TO PV-DISPLAY-MANIFEST     19610000
194800             MOVE   SU001-BATCH-NO-USE TO PV-DISPLAY-BATCH-NO     19620000
194900              STRING ' SUKRF707 - '            DELIMITED BY SIZE  19630000
195000                     'SU001-MANIFEST: '        DELIMITED BY SIZE  19640000
195100                     PV-DISPLAY-MANIFEST       DELIMITED BY SIZE  19650000
195200                     '  SU001-USER-ID-USE: '   DELIMITED BY SIZE  19660000
195300                     SU001-USER-ID-USE         DELIMITED BY SIZE  19670000
195400                     '  SU001-BATCH-NO-USE: '  DELIMITED BY SIZE  19680000
195500                      PV-DISPLAY-BATCH-NO       DELIMITED BY SIZE 19690000
195600                                           INTO PV-CICS-MSG-AREA  19700000
195700              MOVE LENGTH OF PV-CICS-MSG-AREA                     19710000
195800                     TO PV-COMMAREA-LENGTH                        19720000
195900              PERFORM 9990-WRITE-CICS                             19730000
196000                                                                  19740000
196100              MOVE '3025-EXCEPT-COUNT'                            19750000
196200                                  TO DP013-PARAGRAPH              19760000
196300              MOVE 'GET BATCH EXCEPTION COUNT'                    19770000
196400                                  TO DP013-MESSAGE-TEXT (1)       19780000
196500              MOVE SQLCA          TO DP013-SQLCA                  19790000
196600              MOVE 'TLBPTDA'      TO DP013-DB2-TABLE-NAME (1)     19800000
196700              SET DP013-DB2-ABEND TO TRUE                         19810000
196800*             PERFORM 9999-WRITE-CICS-LOG-MSG                     19820000
196900             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              19830000
197000              PERFORM DP014-0000-PROCESS-ABEND                    19840000
197100     END-EVALUATE.                                                19850000
197200                                                                  19860000
197300                                                                  19870000
197400*----------------------------------------------------------------*19880000
197500* GET LAST BATCH NUMBER PROCESSED                                *19890000
197600*----------------------------------------------------------------*19900000
197700 3030-GET-LAST-BATCH.                                             19910000
197800                                                                  19920000
197900     MOVE  SU001-MANIFEST    TO  DK-MANIFEST.                     19930000
198000     IF  SU001-BATCH-NO-USE  >  ZERO                              19940000
198100         MOVE  SU001-BATCH-NO-USE  TO  PV-MAX-USER-BATCH          19950000
198200     ELSE                                                         19960000
198300     IF  SU001-BATCH-NUMBER  >  ZERO                              19970000
198400         MOVE  SU001-BATCH-NUMBER  TO  PV-MAX-USER-BATCH          19980000
198500     ELSE                                                         19990000
198600         MOVE  9999                TO  PV-MAX-USER-BATCH          20000000
198700     END-IF                                                       20010000
198800     END-IF.                                                      20020000
198900                                                                  20030000
199000     EXEC SQL                                                     20040000
199100         SELECT MAX(LBL_PRT_BTCH_ID)                              20050000
199200         INTO   :PV-LAST-BATCH-NUMBER                             20060000
199300          FROM  TLBPTDA                                           20070000
199400          WHERE TRIP_ID           = :DK-MANIFEST                  20080000
199500            AND CRE_USR_ID        = :SU001-USER-ID-USE            20090000
199600            AND LBL_PRT_BTCH_ID  ^= :PV-MAX-USER-BATCH            20100000
199700     END-EXEC.                                                    20110000
199800                                                                  20120000
199900     EVALUATE TRUE                                                20130000
200000         WHEN SQLCODE = ZERO                                      20140000
200100             MOVE  PV-LAST-BATCH-NUMBER  TO  PV-LAST-BATCH-NO     20150000
200200         WHEN SQLCODE = -305                                      20160000
200300             MOVE  ZEROES  TO  PV-MAX-USER-BATCH                  20170000
200400         WHEN SQLWARN0 NOT = SPACES                               20180000
200500         WHEN SQLCODE NOT EQUAL ZERO                              20190000
200600             MOVE '3030-GET-LAST-BATCH'                           20200000
200700                             TO DP013-PARAGRAPH                   20210000
200800             MOVE                                                 20220000
200900                'SUKRF502-GET HIGHEST BATCH NUMBER FOR TRIP/USER' 20230000
201000                             TO DP013-MESSAGE-TEXT(1)             20240000
201100             MOVE SU001-MANIFEST                                  20250000
201200                             TO DP013-MESSAGE-TEXT(2)             20260000
201300             MOVE SU001-USER-ID                                   20270000
201400                             TO DP013-MESSAGE-TEXT(3)             20280000
201500             MOVE SQLCA      TO DP013-SQLCA                       20290000
201600             MOVE 'TLBPTDA'  TO DP013-DB2-TABLE-NAME(1)           20300000
201700             SET DP013-DB2-ABEND                                  20310000
201800                             TO TRUE                              20320000
201900             SET DP013-NO-ROLLBACK                                20330000
202000                             TO TRUE                              20340000
202100             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              20350000
202200             PERFORM DP014-0000-PROCESS-ABEND                     20360000
202300     END-EVALUATE.                                                20370000
202400*                                                                 20380000
202500*                                                                 20390000
202600*LMM                                                              20400000
202700*----------------------------------------------------------------*20410000
202800*  GET THE DC WHERE LABEL PRINTED AT                             *20420000
202900*----------------------------------------------------------------*20430000
203000 3040-GET-DC-PRTD-AT.                                             20440000
203100                                                                  20450000
203200     MOVE  DP072-OPER-UNT-ID         TO  DK-CURR-OPER-UNT-ID.     20460000
203300                                                                  20470000
203400     EXEC SQL                                                     20480000
203500          SELECT LOC_5_ABBR_NM                                    20490000
203600          INTO  :PV-DC-5-CHAR-ABBR                                20500000
203700          FROM   XLT_LOC                                          20510000
203800          WHERE  LOC_TYP_CDE  = 'DC'                              20520000
203900          AND    LOC_NBR   = :DK-CURR-OPER-UNT-ID                 20530000
204000     END-EXEC.                                                    20540000
204100                                                                  20550000
204200     EVALUATE TRUE                                                20560000
204300         WHEN SQLCODE = ZERO                                      20570000
204400              MOVE  PV-2-DIGIT-DC-ABBR  TO  PV-DC-PRTD-AT         20580000
204500                                                                  20590000
204600         WHEN SQLCODE = +100                                      20600000
204700              MOVE  PC-90   TO  PV-DC-PRTD-AT                     20610000
204800                                                                  20620000
204900         WHEN SQLCODE = -811                                      20630000
205000         WHEN SQLCODE = -904                                      20640000
205100         WHEN SQLCODE = -913                                      20650000
205200             CONTINUE                                             20660000
205300         WHEN SQLWARN0 NOT = SPACES                               20670000
205400         WHEN SQLCODE < +0                                        20680000
205500         WHEN SQLCODE > +0                                        20690000
205600            MOVE '3040-GET-DC-PRTD-AT' TO DP013-PARAGRAPH         20700000
205700            MOVE 'GET DC PRINTED AT'   TO DP013-MESSAGE-TEXT(1)   20710000
205800            MOVE SQLCA                 TO DP013-SQLCA             20720000
205900            MOVE 'XLT00010'            TO DP013-DB2-TABLE-NAME(1) 20730000
206000            SET  DP013-DB2-ABEND       to true                    20740000
206100             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              20750000
206200            PERFORM DP014-0000-PROCESS-ABEND                      20760000
206300     END-EVALUATE.                                                20770000
206400*                                                                 20780000
206500*                                                                 20790000
206600 3200-XCTL-TO-HELP.                                               20800000
206700                                                                  20810000
206800     MOVE LENGTH OF PC192-COMMAREA    TO PV-COMMAREA-LENGTH.      20820000
206900     SET  SU001-INITIALIZE-SCREEN     TO TRUE.                    20830000
207000     MOVE CA-COMMAREA                 TO PC192-HOST-SAVE-AREA.    20840000
207100                                                                  20850000
207200     EXEC CICS                                                    20860000
207300         XCTL                                                     20870000
207400             PROGRAM   (PV-TRANSFER-PROGRAM)                      20880000
207500             COMMAREA  (PC192-COMMAREA)                           20890000
207600             LENGTH    (PV-COMMAREA-LENGTH)                       20900000
207700             RESP      (PV-CICS-RESPONSE)                         20910000
207800     END-EXEC.                                                    20920000
207900                                                                  20930000
208000     EVALUATE TRUE                                                20940000
208100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 20950000
208200              CONTINUE                                            20960000
208300         WHEN OTHER                                               20970000
208400             MOVE '3200-XCTL-TO-HELP '                            20980000
208500                 TO DP013-PARAGRAPH                               20990000
208600             MOVE 'SUKRF707 - UNABLE TO XCTL TO PROGRAM: '        21000000
208700                 TO DP013-MESSAGE-TEXT (1)                        21010000
208800             MOVE PV-TRANSFER-PROGRAM                             21020000
208900                 TO DP013-MESSAGE-TEXT (2)                        21030000
209000             SET DP013-CICS-ABEND  TO TRUE                        21040000
209100             SET DP013-ROLLBACK TO TRUE                           21050000
209200             PERFORM 9999-WRITE-CICS-LOG-MSG                      21060000
209300             MOVE PC-TRANS-UNAVAILABLE-MSG TO AMSGLNO             21070000
209400             SET SU001-PROCESS-SCREEN TO TRUE                     21080000
209500             PERFORM 8000-SEND-MAP                                21090000
209600             PERFORM 8200-RETURN-TRANID                           21100000
209700     END-EVALUATE.                                                21110000
209800*                                                                 21120000
209900* WR41309-RF ID 8/30/2012  AME  BEGIN                             21130000
210000*----------------------------------------------------------------*21140000
210300*----------------------------------------------------------------*21150000
210400 3250-SELECT-BRCDE.                                               21160000
210500                                                                  21170000
210610      EXEC SQL                                                    21180000
210620           SELECT BRCDE_NBR                                       21190000
210630           INTO :SULBXF-BRCDE-NBR                                 21200000
210640           FROM TSULBXF                                           21210000
210651           WHERE SHIPT_UNT_ID = :LBPTDA-SHIPT-UNT-ID              21220000
210660             AND STAT_CDE   = 'A'                                 21230000
210680          WITH UR                                                 21240000
210690      END-EXEC                                                    21250000
210691                                                                  21260000
211500                                                                  21270000
211600     EVALUATE TRUE                                                21280000
211700         WHEN SQLCODE = ZERO                                      21290000
211800         when SQLCODE = -811                                      21300000
211801              SET PS-SULBXF-FOUND  TO TRUE                        21310000
212100         WHEN SQLCODE = +100                                      21320000
212200              SET PS-SULBXF-NOT-FOUND  TO TRUE                    21330000
212300         WHEN OTHER                                               21340000
212400             STRING ' SUKRF707 - '             DELIMITED BY SIZE  21350000
212500                     'PV-OTBND-SML'            DELIMITED BY SIZE  21360000
212600                      PV-OTBND-SML             DELIMITED BY SIZE  21370000
212610                                          INTO PV-CICS-MSG-AREA   21380000
212620             MOVE LENGTH OF PV-CICS-MSG-AREA                      21390000
212630                     TO PV-COMMAREA-LENGTH                        21400000
212640             PERFORM 9990-WRITE-CICS                              21410000
212650                                                                  21420000
212660             MOVE '3250-SELECT-BRCDE '                            21430000
212670                                            TO DP013-PARAGRAPH    21440000
212680             MOVE 'SUKRF707 - COUNT RD PROCESS MSGS'              21450000
212690                             TO DP013-MESSAGE-TEXT(1)             21460000
212700             MOVE   LBPTDA-OPER-UNT-ID      TO  PV-DISPLAY-OPER   21470000
212800             MOVE   LBPTDA-TRIP-ID          TO  PV-DISPLAY-TRIP   21480000
212900             MOVE   LBPTDA-LBL-PRT-BTCH-ID  TO  PV-DISPLAY-BATCH  21490000
213000             MOVE   LBPTDA-PO-NBR           TO  PV-DISPLAY-PO     21500000
213100             MOVE   LBPTDA-RCVR-SEQ-NBR     TO  PV-DISPLAY-RCVR   21510000
213200             MOVE   LBPTDA-PO-LNE-NBR       TO  PV-DISPLAY-LINE   21520000
213300             STRING 'OPER UNIT: '                                 21530000
213400                    PV-DISPLAY-OPER                               21540000
213500                    '   DK-BARCODE-NBR: '                         21550000
213600                     DK-BARCODE-NBR                               21560000
213700                    '   BATCH NO: '                               21570000
213800                    PV-DISPLAY-BATCH        DELIMITED BY SIZE     21580000
213900                                       INTO DP013-MESSAGE-TEXT(2) 21590000
214000             STRING 'TRIP ID: '                                   21600000
214100                    PV-DISPLAY-TRIP                               21610000
214200                    '   SCAC: '                                   21620000
214300                    LBPTDA-OWNR-SCAC-ID                           21630000
214400                    '   TRLR: '                                   21640000
214500                    LBPTDA-VEH-NBR          DELIMITED BY SIZE     21650000
214600                                        INTO DP013-MESSAGE-TEXT(3)21660000
214700             STRING '   OPER: '                                   21670000
214800                    PV-DISPLAY-OPER                               21680000
214900                    'PO: '                                        21690000
215000                    PV-DISPLAY-PO                                 21700000
215100                    '   RCVR: '                                   21710000
215200                    PV-DISPLAY-RCVR                               21720000
215300                    '   LINE: '                                   21730000
215400                    PV-DISPLAY-LINE         DELIMITED BY SIZE     21740000
215500                                       INTO DP013-MESSAGE-TEXT(4) 21750000
215600             MOVE SQLCA      TO DP013-SQLCA                       21760000
215700             MOVE 'TSULBXF'  TO DP013-DB2-TABLE-NAME(1)           21770000
215800             SET DP013-DB2-ABEND            TO TRUE               21780000
215900             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              21790000
216000             PERFORM DP014-0000-PROCESS-ABEND                     21800000
216100         END-EVALUATE.                                            21810000
216200                                                                  21820000
216300* WR41309-RF ID 8/30/2012  AME  END                               21830000
216310*----------------------------------------------------------------*21840000
216320* COUNT PROCESS MESSAGES THAT ARE OF A CODE TYPE 'RD' TO         *21850000
216330* DETERMINE IF '*** RF ID ****' SHOULD BE PRINTED ON THE LABEL   *21860000
216340*----------------------------------------------------------------*21870000
216350 3300-COUNT-MSG-RD.                                               21880000
216360                                                                  21890000
216380         EXEC SQL                                                 21900000
216390              SELECT PRC_MSG_CDE                                  21910000
216391         INTO   :PV-PRC-MSG-CDE                                   21920000
216392                FROM SUT_PRC_MSG_CNTL                             21930000
216393               WHERE SHIPT_UNT_ID = :SUT00094-SHIPT-UNT-ID        21940000
216394                 AND PRC_MSG_CDE  ='RD'                           21950000
216395               FETCH FIRST 1 ROW ONLY                             21960000
216396         END-EXEC                                                 21970000
216397                                                                  21980000
216398     EVALUATE TRUE                                                21990000
216399         WHEN SQLCODE = ZERO                                      22000000
216400         when SQLCODE = -811                                      22010000
216401              SET PS-RF-ID-FOUND-YES TO TRUE                      22020000
216403         WHEN SQLCODE = +100                                      22030000
216404              SET PS-RF-ID-FOUND-NO  TO TRUE                      22040000
216405         WHEN OTHER                                               22050000
216406             STRING ' SUKRF707 - '             DELIMITED BY SIZE  22060000
216407                     'PV-OTBND-SML'            DELIMITED BY SIZE  22070000
216408                      PV-OTBND-SML             DELIMITED BY SIZE  22080000
216409                                          INTO PV-CICS-MSG-AREA   22090000
216410             MOVE LENGTH OF PV-CICS-MSG-AREA                      22100000
216411                     TO PV-COMMAREA-LENGTH                        22110000
216412             PERFORM 9990-WRITE-CICS                              22120000
216413                                                                  22130000
216414             MOVE '3300-COUNT-MSG-RD'                             22140000
216415                                            TO DP013-PARAGRAPH    22150000
216416             MOVE 'SUKRF707 - COUNT RD PROCESS MSGS'              22160000
216417                             TO DP013-MESSAGE-TEXT(1)             22170000
216418             MOVE   LBPTDA-OPER-UNT-ID      TO  PV-DISPLAY-OPER   22180000
216419             MOVE   LBPTDA-TRIP-ID          TO  PV-DISPLAY-TRIP   22190000
216420             MOVE   LBPTDA-LBL-PRT-BTCH-ID  TO  PV-DISPLAY-BATCH  22200000
216421             MOVE   LBPTDA-PO-NBR           TO  PV-DISPLAY-PO     22210000
216422             MOVE   LBPTDA-RCVR-SEQ-NBR     TO  PV-DISPLAY-RCVR   22220000
216423             MOVE   LBPTDA-PO-LNE-NBR       TO  PV-DISPLAY-LINE   22230000
216424             STRING 'OPER UNIT: '                                 22240000
216425                    PV-DISPLAY-OPER                               22250000
216426                    '   DK-BARCODE-NBR: '                         22260000
216427                     DK-BARCODE-NBR                               22270000
216428                    '   BATCH NO: '                               22280000
216429                    PV-DISPLAY-BATCH        DELIMITED BY SIZE     22290000
216430                                       INTO DP013-MESSAGE-TEXT(2) 22300000
216431             STRING 'TRIP ID: '                                   22310000
216432                    PV-DISPLAY-TRIP                               22320000
216433                    '   SCAC: '                                   22330000
216434                    LBPTDA-OWNR-SCAC-ID                           22340000
216435                    '   TRLR: '                                   22350000
216436                    LBPTDA-VEH-NBR          DELIMITED BY SIZE     22360000
216437                                        INTO DP013-MESSAGE-TEXT(3)22370000
216438             STRING '   OPER: '                                   22380000
216439                    PV-DISPLAY-OPER                               22390000
216440                    'PO: '                                        22400000
216441                    PV-DISPLAY-PO                                 22410000
216442                    '   RCVR: '                                   22420000
216443                    PV-DISPLAY-RCVR                               22430000
216444                    '   LINE: '                                   22440000
216445                    PV-DISPLAY-LINE         DELIMITED BY SIZE     22450000
216446                                       INTO DP013-MESSAGE-TEXT(4) 22460000
216447             MOVE SQLCA      TO DP013-SQLCA                       22470000
216448             MOVE 'TSULBXF'  TO DP013-DB2-TABLE-NAME(1)           22480000
216449             SET DP013-DB2-ABEND            TO TRUE               22490000
216450             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              22500000
216451             PERFORM DP014-0000-PROCESS-ABEND                     22510000
216452         END-EVALUATE.                                            22520000
216453                                                                  22530000
216454* WR41309-RF ID 8/30/2012  AME  END                               22540000
216460*----------------------------------------------------------------*22550000
216500* PRINT LABEL ROUTINE                                            *22560000
216600*----------------------------------------------------------------*22570000
216700 4000-LABEL-ROUTINE.                                              22580000
216800                                                                  22590000
216900*   7/17/2006  DRS                                                22600000
217000*    IF SU001-DC-NOT-INTERFACED                                   22610000
217100*       CONTINUE                                                  22620000
217200*    ELSE                                                         22630000
217300*       PERFORM 4100-DETERMINE-EAI-CALL                           22640000
217400*    END-IF.                                                      22650000
217500*   7/17/2006  DRS                                                22660000
217600                                                                  22670000
217700     IF PS-NO-SOCKET-ERROR                                        22680000
217800        PERFORM 4300-FORMAT-IP-ADDR                               22690000
217900        PERFORM 4310-CALL-SOCKET                                  22700000
218000     END-IF.                                                      22710000
218100     IF  PS-NO-SOCKET-ERROR                                       22720000
218200         PERFORM 4320-CONNECT-SOCKET                              22730000
218300     END-IF.                                                      22740000
218400     IF  PS-NO-SOCKET-ERROR                                       22750000
218500         PERFORM 4400-BLD-HDR-REC                                 22760000
218600     END-IF.                                                      22770000
218700     IF  PS-NO-SOCKET-ERROR                                       22780000
218800         PERFORM 4500-BLD-DTL-REC                                 22790000
218900     END-IF.                                                      22800000
219000     IF  PS-NO-SOCKET-ERROR                                       22810000
219100         PERFORM 4600-BLD-TLR-REC                                 22820000
219200     END-IF.                                                      22830000
219300     IF  PS-NO-SOCKET-ERROR                                       22840000
219400         PERFORM 4340-CLOSE-SOCKET                                22850000
219500     END-IF.                                                      22860000
219600                                                                  22870000
219700     IF  PS-SOCKET-ERROR                                          22880000
219800         PERFORM 9200-SYNCPOINT-ROLLBACK                          22890000
219900         PERFORM 4730-UPDATE-TLBTKHS                              22900000
220000     END-IF.                                                      22910000
220100                                                                  22920000
220200*    SKIP EVENT PROCESSING IF A SOCKET ERROR HAS OCCURRED         22930000
220300*    OR THE EVENT HAS ALREADY BEEN RECORDED                       22940000
220400                                                                  22950000
220500     IF  PS-SOCKET-ERROR                                          22960000
220600         CONTINUE                                                 22970000
220700     ELSE                                                         22980000
220800         IF SU001-DC-NOT-INTERFACED                               22990000
220900             CONTINUE                                             23000000
221000         ELSE                                                     23010000
221100            PERFORM 4100-DETERMINE-EAI-CALL                       23020000
221200         END-IF                                                   23030000
221300     END-IF.                                                      23040000
221400                                                                  23050000
221500*----------------------------------------------------------------*23060000
221600*    FIRST THING TO OCCUR IN THE PARAGRAPH IS THE FORMATTING     *23070000
221700*    OF THE DLWS001 COMMAREA TO PASS TO DLKUP001.  DLKUP001 IS   *23080000
221800*    USED TO NUMBER EVENTS WITHIN A LABOR ASSIGNMENT.            *23090000
221900*        IF THE CALL TO DLKUP001 IS SUCCESSFUL, DO A SYNCPOINT   *23100000
222000*    AND THEN FORMAT THE XLWS072 COMMAREA TO PASS TO XLKUP033    *23110000
222100*    WHICH WILL WRITE DATA TO THE EAI EXPORT TABLES.             *23120000
222200*                                                                *23130000
222300*----------------------------------------------------------------*23140000
222400                                                                  23150000
222500 4100-DETERMINE-EAI-CALL.                                         23160000
222600                                                                  23170000
222700     INITIALIZE DL001-ASGMT-COMMAREA.                             23180000
222800                                                                  23190000
222900     SET DL001-BY-ASGMT-KEY         TO TRUE.                      23200000
223000     SET DL001-DO-NOT-COMMIT-UPDATE TO TRUE.                      23210000
223100     SET DL001-FIND-NEXT-ASGMT      TO TRUE.                      23220000
223200                                                                  23230000
223300     MOVE SU001-ASGMT-STRT-DTE TO DL001-KEY-START-DTE.            23240000
223400     MOVE SU001-ASGMT-NBR-TXT  TO DL001-KEY-NBR-TXT.              23250000
223500     MOVE SU001-ASGMT-NBR-SEQ-NBR TO DL001-KEY-NBR-SEQ-NBR.       23260000
223600                                                                  23270000
223700     MOVE 1 TO DL001-NBR-OF-NBRS-NEED-QTY.                        23280000
223800     MOVE PC-CURRENT-PROGRAM-NAME TO DL001-ORIG-CALLING-PGM-NM.   23290000
223900                                                                  23300000
224000     CALL DL001-USER-PGM USING DFHEIBLK                           23310000
224100                               DL001-COMMAREA                     23320000
224200                               DL001-ASGMT-COMMAREA.              23330000
224300                                                                  23340000
224400     IF DL001-SUCCESSFUL                                          23350000
224500        PERFORM 9100-SYNCPOINT                                    23360000
224600        IF DL001-ASGMT-NEXT-USED                                  23370000
224700           MOVE DL001-NXT-START-DTE TO  SU001-ASGMT-STRT-DTE      23380000
224800           MOVE DL001-NXT-NBR-TXT   TO  SU001-ASGMT-NBR-TXT       23390000
224900           MOVE DL001-NXT-NBR-SEQ-NBR TO                          23400000
225000                              SU001-ASGMT-NBR-SEQ-NBR             23410000
225100**??    ELSE                                                      23420000
225200**??       MOVE DL001-SEQ-START-NBR TO                            23430000
225300**??                          SU001-ASGMT-NBR-SEQ-NBR             23440000
225400        END-IF                                                    23450000
225500                                                                  23460000
225600        PERFORM 4200-CALL-XLKUP033                                23470000
225700     ELSE                                                         23480000
225800        IF DL001-ASGMT-CLOSED-RETURN                              23490000
225900           CONTINUE                                               23500000
226000        ELSE                                                      23510000
226100           SET  PS-SOCKET-ERROR         TO TRUE                   23520000
226200           STRING PC-CURRENT-PROGRAM-NAME                         23530000
226300                  ' - ERROR FROM DLKUP001 - '                     23540000
226400                  DL001-RETURN-CODE                               23550000
226500                  ' - START DATE -  '                             23560000
226600                  DL001-KEY-START-DTE                             23570000
226700                  PV-BLANKS                                       23580000
226800                  DELIMITED BY SIZE                               23590000
226900                  INTO PV-CICS-MSG-AREA                           23600000
227000           PERFORM 9990-WRITE-CICS                                23610000
227100                                                                  23620000
227200           STRING 'DL001-KEY-NBR-TXT -------> '                   23630000
227300                  DL001-KEY-NBR-TXT                               23640000
227400                  PV-BLANKS                                       23650000
227500                  DELIMITED BY SIZE                               23660000
227600                  INTO PV-CICS-MSG-AREA                           23670000
227700           PERFORM 9990-WRITE-CICS                                23680000
227800                                                                  23690000
227900           SET  DP013-OTHER-ABEND TO TRUE                         23700000
228000           SET  DP013-NO-ROLLBACK TO TRUE                         23710000
228100           MOVE '4100-DETERMINE-EAI-CALL' TO DP013-PARAGRAPH      23720000
228200           STRING PC-CURRENT-PROGRAM-NAME                         23730000
228300                  ' - ERROR FROM DLKUP001 - '                     23740000
228400                  DL001-RETURN-CODE                               23750000
228500                  ' - START DATE -  '                             23760000
228600                  DL001-KEY-START-DTE                             23770000
228700                  PV-BLANKS                                       23780000
228800                  DELIMITED BY SIZE                               23790000
228900                                       INTO DP013-MESSAGE-TEXT (1)23800000
229000           STRING 'DL001-KEY-NBR-TXT -------> '                   23810000
229100                  DL001-KEY-NBR-TXT                               23820000
229200                  PV-BLANKS                                       23830000
229300                  DELIMITED BY SIZE                               23840000
229400                                       INTO DP013-MESSAGE-TEXT (2)23850000
229500           PERFORM 9999-WRITE-CICS-LOG-MSG                        23860000
229600        END-IF                                                    23870000
229700     END-IF.                                                      23880000
229800                                                                  23890000
229900*----------------------------------------------------------------*23900000
230000*    FORMAT THE XLWS072 COMMAREA TO PASS TO XLKUP033 WHICH WILL  *23910000
230100*    WRITE DATA TO THE EAI EXPORT TABLES.                        *23920000
230200*        THE BUSINESS EVENT THAT THIS WRITES IS THE "CARTON"     *23930000
230300*    "CHECKIN PRINT" AND IT WILL WRITE ROWS TO BOTH THE SUT00037 *23940000
230400*    (SUT_BUS_EVNT_EXPRT) AND SUT00038 (SUT_BUS_EVNT_DTL) TABLES.*23950000
230500*                                                                *23960000
230600*----------------------------------------------------------------*23970000
230700                                                                  23980000
230800 4200-CALL-XLKUP033.                                              23990000
230900                                                                  24000000
231000     INITIALIZE XL072-EAI-EXPORT-COMMAREA.                        24010000
231100                                                                  24020000
231200     SET XL072-SU-APP-ID          TO TRUE.                        24030000
231300                                                                  24040000
231400     MOVE PC-CARTON               TO XL072-EVNT-OBJ-TXT.          24050000
231500     MOVE PC-CHECKIN-PRINT        TO XL072-EVNT-OBJ-ACTN-TXT.     24060000
231600     MOVE SU001-USER-ID           TO XL072-CRE-BY-USR-ID.         24070000
231700     MOVE PC-CURRENT-PROGRAM-NAME TO XL072-CRE-PGM-NM.            24080000
232100     MOVE SU001-MANIFEST          TO XL072-EVNT-KY-1-NBR.         24090000
232300                                                                  24100000
232400     EVALUATE TRUE                                                24110000
232500         WHEN SU001-BATCH-NO-USE  >  ZERO                         24120000
232600              MOVE SU001-BATCH-NO-USE TO XL072-EVNT-KY-2-NBR      24130000
232700                                                                  24140000
232800         WHEN SU001-BATCH-NUMBER >  ZERO                          24150000
232900              MOVE SU001-BATCH-NUMBER TO XL072-EVNT-KY-2-NBR      24160000
233000                                                                  24170000
233100         WHEN OTHER                                               24180000
233200              MOVE 9999 TO XL072-EVNT-KY-2-NBR                    24190000
233300                                                                  24200000
233400     END-EVALUATE.                                                24210000
233500                                                                  24220000
233600     MOVE SU001-USER-ID-USE       TO XL072-EVNT-KY-1-TXT.         24230000
233700     SET XL072-DO-NOT-COMMIT-UPDATE TO TRUE.                      24240000
233800     MOVE PC-CURRENT-PROGRAM-NAME TO XL072-ORIG-CALLING-PGM-NM.   24250000
233900                                                                  24260000
234000     SET XL072-SUWS050-COPYBOOK TO TRUE.                          24270000
234100                                                                  24280000
234200     INITIALIZE SU050-DTL-TXT-AREA.                               24290000
234300     SET SU050-CHECK-IN-LBL-PRT TO TRUE.                          24300000
234400     MOVE SU001-ASGMT-STRT-DTE  TO SU050-AB-ASGMT-STRT-DTE.       24310000
234500     MOVE SU001-ASGMT-NBR-TXT   TO SU050-AB-ASGMT-NBR-TXT.        24320000
234600     MOVE SU001-ASGMT-NBR-SEQ-NBR TO SU050-AB-ASGMT-NBR-SEQ-NBR.  24330000
234700     MOVE DL001-SEQ-START-NBR     TO SU050-AB-ASGMT-SEQ-DTL-NBR.  24340000
234800     MOVE SU001-DOOR-ID           TO SU050-AB-DOOR-NBR.           24350000
234900     MOVE SU050-DTL-TXT-AREA      TO XL072-DTL-TXT.               24360000
235000                                                                  24370000
235100     CALL XL072-USER-PGM USING DFHEIBLK                           24380000
235200                               XL072-COMMAREA                     24390000
235300                               XL072-EAI-EXPORT-COMMAREA.         24400000
235400                                                                  24410000
235500     IF XL072-SUCCESSFUL                                          24420000
235600        CONTINUE                                                  24430000
235700     ELSE                                                         24440000
235800        SET  PS-SOCKET-ERROR         TO TRUE                      24450000
235900        STRING PC-CURRENT-PROGRAM-NAME                            24460000
236000               ' - ERROR FROM XLKUP033 - '                        24470000
236100               XL072-RETURN-CODE                                  24480000
236200               ' - OBJECT TXT - '                                 24490000
236300               XL072-EVNT-OBJ-TXT                                 24500000
236400               ' - CRE USR - '                                    24510000
236500               XL072-CRE-BY-USR-ID                                24520000
236600               PV-BLANKS                                          24530000
236700               DELIMITED BY SIZE                                  24540000
236800               INTO PV-CICS-MSG-AREA                              24550000
236900        PERFORM 9990-WRITE-CICS                                   24560000
237000                                                                  24570000
237100        STRING 'OBJECT ACTN TXT ---> '                            24580000
237200               XL072-EVNT-OBJ-ACTN-TXT                            24590000
237300               ' CRE PGM - '                                      24600000
237400               XL072-CRE-PGM-NM                                   24610000
237500               PV-BLANKS                                          24620000
237600               DELIMITED BY SIZE                                  24630000
237700               INTO PV-CICS-MSG-AREA                              24640000
237800        PERFORM 9990-WRITE-CICS                                   24650000
237900                                                                  24660000
238000        SET  DP013-OTHER-ABEND TO TRUE                            24670000
238100        SET  DP013-NO-ROLLBACK TO TRUE                            24680000
238200        MOVE '4200-CALL-XLKUP033' TO DP013-PARAGRAPH              24690000
238300        PERFORM 9999-WRITE-CICS-LOG-MSG                           24700000
238400     END-IF.                                                      24710000
238500                                                                  24720000
238600                                                                  24730000
238700*----------------------------------------------------------------*24740000
238800*  THIS PARAGRAPH WILL TAKE EACH NUMERIC PORTION OF THE IP       *24750000
238900*  ADDRESS AND CONVERT EACH PORTION INTO ITS HEX VALUE.  THE     *24760000
239000*  HEX VALUE WILL THEN BE MOVED TO A FIELD WHICH WILL STACK THE  *24770000
239100*  FOUR HEX VALUES SIDE BY SIDE INTO A FIELD DEFINED AS X(04).   *24780000
239200*  THIS VALUE IS THEN WHAT IS USED BY THE SOCKETS LOGIC FOR THE  *24790000
239300*  IP ADDRESS.                                                   *24800000
239400*----------------------------------------------------------------*24810000
239500 4300-FORMAT-IP-ADDR.                                             24820000
239600                                                                  24830000
239700     MOVE PV-IP-ADDR-NUM1 TO PV-HEX-NUMERIC.                      24840000
239800     MOVE PV-HEX-CHAR-2 TO PV-HEX-FIELD-1.                        24850000
239900                                                                  24860000
240000     MOVE PV-IP-ADDR-NUM2 TO PV-HEX-NUMERIC.                      24870000
240100     MOVE PV-HEX-CHAR-2 TO PV-HEX-FIELD-2.                        24880000
240200                                                                  24890000
240300     MOVE PV-IP-ADDR-NUM3 TO PV-HEX-NUMERIC.                      24900000
240400     MOVE PV-HEX-CHAR-2 TO PV-HEX-FIELD-3.                        24910000
240500                                                                  24920000
240600     MOVE PV-IP-ADDR-NUM4 TO PV-HEX-NUMERIC.                      24930000
240700     MOVE PV-HEX-CHAR-2 TO PV-HEX-FIELD-4.                        24940000
240800                                                                  24950000
240900     MOVE PV-HEX-FIELD-NUMBER TO DP081-NAME-IP-ADDR.              24960000
241000                                                                  24970000
241100                                                                  24980000
241200*----------------------------------------------------------------*24990000
241300*  CALL SOCKET                                                   *25000000
241400*----------------------------------------------------------------*25010000
241500 4310-CALL-SOCKET.                                                25020000
241600                                                                  25030000
241700     CALL 'EZASOKET'                                              25040000
241800         USING DP081-SOCKET-CMD                                   25050000
241900               DP081-AF-INET                                      25060000
242000               DP081-SOCK-TYPE                                    25070000
242100               DP081-PROTOCOL                                     25080000
242200               DP081-ERRNO                                        25090000
242300               DP081-RETCODE.                                     25100000
242400                                                                  25110000
242500     MOVE DP081-RETCODE TO DP081-SOCK-ID.                         25120000
242600                                                                  25130000
242700     IF DP081-RETCODE < ZERO                                      25140000
242800        SET  PS-SOCKET-ERROR         TO TRUE                      25150000
242900        MOVE PC-COMMUNICATION-ERROR  TO AMSGLNO                   25160000
243000        MOVE DP015-UNP-NUM-BRT-MDT   TO APRTIDA                   25170000
243100        MOVE -1                      TO APRTIDL                   25180000
243200        MOVE PC-CURRENT-PROGRAM-NAME TO DP081-TCP-IP-PGM-NAME     25190000
243300        SET  DP081-TCP-IP-SOCKET-ERR TO TRUE                      25200000
243400        MOVE DP081-ERRNO             TO DP081-TCP-IP-ERR-NBR      25210000
243500        SET  DP013-OTHER-ABEND       TO TRUE                      25220000
243600        SET  DP013-NO-ROLLBACK       TO TRUE                      25230000
243700        MOVE '4310-CALL-SOCKET'      TO DP013-PARAGRAPH           25240000
243800        MOVE DP081-TCP-IP-LOGGING-MSG TO DP013-MESSAGE-TEXT (1)   25250000
243900        MOVE DP081-NAME-FAMILY        TO PV-DISPLAY-FAMILY        25260000
244000        MOVE DP081-NAME-PORT          TO PV-DISPLAY-PORT          25270000
244100        MOVE DP081-NAME-IP-ADDR       TO PV-DISPLAY-IP-ADDR       25280000
244200        STRING ' SUKRF707 - '            DELIMITED BY SIZE        25290000
244300               'DP081-FAMILY='           DELIMITED BY SIZE        25300000
244400               PV-DISPLAY-FAMILY         DELIMITED BY SIZE        25310000
244500               ' DP081-PORT='            DELIMITED BY SIZE        25320000
244600               PV-DISPLAY-PORT           DELIMITED BY SIZE        25330000
244700               ' DP081-IP-ADDR='         DELIMITED BY SIZE        25340000
244800               PV-DISPLAY-IP-ADDR        DELIMITED BY SIZE        25350000
244900                                    INTO DP013-MESSAGE-TEXT (2)   25360000
245000        MOVE DP081-RETCODE            TO  PV-RETCODE              25370000
245100        MOVE DP081-ERRNO              TO  PV-ERRNO                25380000
245200        STRING ' EZASOKET CONNECT -'      DELIMITED BY SIZE       25390000
245300               ' DP081-RETCODE - '        DELIMITED BY SIZE       25400000
245400               PV-RETCODE                 DELIMITED BY SIZE       25410000
245500               ' DP081-ERRNO - '          DELIMITED BY SIZE       25420000
245600               PV-ERRNO                   DELIMITED BY SIZE       25430000
245700                                     INTO DP013-MESSAGE-TEXT (3)  25440000
245800        MOVE   LBPTDA-PO-NBR           TO  PV-DISPLAY-PO          25450000
245900        MOVE   LBPTDA-RCVR-SEQ-NBR     TO  PV-DISPLAY-RCVR        25460000
246000        MOVE   LBPTDA-PO-LNE-NBR       TO  PV-DISPLAY-LINE        25470000
246100        MOVE   SU001-OPER-UNT-ID       TO  PV-DISPLAY-OPER        25480000
246200        STRING ' PRTR ID: '                DELIMITED BY SIZE      25490000
246300               SU001-PRINTER-ID-USE        DELIMITED BY SIZE      25500000
246400               '   OPER: '                 DELIMITED BY SIZE      25510000
246500               PV-DISPLAY-OPER             DELIMITED BY SIZE      25520000
246600               '   PO: '                   DELIMITED BY SIZE      25530000
246700               PV-DISPLAY-PO               DELIMITED BY SIZE      25540000
246800               '   RCVR: '                 DELIMITED BY SIZE      25550000
246900               PV-DISPLAY-RCVR             DELIMITED BY SIZE      25560000
247000                                      INTO DP013-MESSAGE-TEXT (4) 25570000
247100        PERFORM 9999-WRITE-CICS-LOG-MSG                           25580000
247200                                                                  25590000
247300*** BEGIN - FOR TESTING ONLY                                      25600000
247400*    ELSE                                                         25610000
247500*       MOVE ' SUKRF707 - CALL SOCKET SUCCESSFUL'                 25620000
247600*                                           TO PV-CICS-MSG-AREA   25630000
247700*       PERFORM 9990-WRITE-CICS                                   25640000
247800*** END - FOR TESTING ONLY                                        25650000
247900                                                                  25660000
248000     END-IF.                                                      25670000
248100                                                                  25680000
248200                                                                  25690000
248300*----------------------------------------------------------------*25700000
248400*  CONNECT THE PATH (SOCKET).                                    *25710000
248500*----------------------------------------------------------------*25720000
248600 4320-CONNECT-SOCKET.                                             25730000
248700                                                                  25740000
248800                                                                  25750000
248900     MOVE DP081-AF-INET         TO DP081-NAME-FAMILY.             25760000
249000     MOVE DP081-COM-PORT        TO DP081-NAME-PORT.               25770000
249100                                                                  25780000
249200     CALL 'EZASOKET'                                              25790000
249300         USING DP081-CONNECT-CMD                                  25800000
249400               DP081-SOCK-ID                                      25810000
249500               DP081-SOCK-NAME                                    25820000
249600               DP081-ERRNO                                        25830000
249700               DP081-RETCODE.                                     25840000
249800                                                                  25850000
249900     IF DP081-RETCODE < ZERO                                      25860000
250000        SET  PS-SOCKET-ERROR         TO TRUE                      25870000
250100        MOVE PC-COMMUNICATION-ERROR  TO AMSGLNO                   25880000
250200        MOVE DP015-UNP-NUM-BRT-MDT   TO APRTIDA                   25890000
250300        MOVE -1                      TO APRTIDL                   25900000
250400        MOVE PC-CURRENT-PROGRAM-NAME  TO DP081-TCP-IP-PGM-NAME    25910000
250500        SET  DP081-TCP-IP-CONNECT-ERR TO TRUE                     25920000
250600        MOVE DP081-ERRNO              TO DP081-TCP-IP-ERR-NBR     25930000
250700                                         CONNECT-ERRNO            25940000
250800        MOVE CONNECT-ERR              TO PV-CICS-MSG-AREA         25950000
250900                                                                  25960000
251000        PERFORM 9990-WRITE-CICS                                   25970000
251100*                                                                 25980000
251200** DMH - 3/24/05 - BEGIN                                          25990000
251300        MOVE  SPACES                  TO PV-CICS-MSG-AREA         26000000
251400        MOVE  SU001-PRINTER-ID        TO ERR-MSG-PRINTER          26010000
251500        MOVE  SU001-OPER-UNT-ID       TO ERR-MSG-OPER             26020000
251600        MOVE  SU001-PO                TO ERR-MSG-PO               26030000
251700        MOVE  SU001-RCVR-SEQ-NBR      TO ERR-MSG-RCVR             26040000
251800        MOVE  SU001-MANIFEST          TO ERR-MSG-TRIP             26050000
251900        MOVE  SU001-USER-ID           TO ERR-MSG-USERID           26060000
252000        MOVE  SU001-BATCH-NUMBER      TO ERR-MSG-BATCH            26070000
252100        MOVE  ERROR-DETAILS           TO PV-CICS-MSG-AREA         26080000
252200                                                                  26090000
252300        PERFORM 9990-WRITE-CICS                                   26100000
252400*                                                                 26110000
252500*dmh                                                              26120000
252600*dmh    SET  DP013-OTHER-ABEND        TO TRUE                     26130000
252700*dmh    SET  DP013-NO-ROLLBACK        TO TRUE                     26140000
252800*dmh    MOVE '4320-CONNECT-SOCKET'    TO DP013-PARAGRAPH          26150000
252900*dmh    MOVE DP081-TCP-IP-LOGGING-MSG TO DP013-MESSAGE-TEXT (1)   26160000
253000*dmh    MOVE DP081-NAME-FAMILY        TO PV-DISPLAY-FAMILY        26170000
253100*dmh    MOVE DP081-NAME-PORT          TO PV-DISPLAY-PORT          26180000
253200*dmh    MOVE DP081-NAME-IP-ADDR       TO PV-DISPLAY-IP-ADDR       26190000
253300*dmh    STRING ' SUKRF707 - '            DELIMITED BY SIZE        26200000
253400*dmh           'DP081-FAMILY='           DELIMITED BY SIZE        26210000
253500*dmh           PV-DISPLAY-FAMILY         DELIMITED BY SIZE        26220000
253600*dmh           ' DP081-PORT='            DELIMITED BY SIZE        26230000
253700*dmh           PV-DISPLAY-PORT           DELIMITED BY SIZE        26240000
253800*dmh           ' DP081-IP-ADDR='         DELIMITED BY SIZE        26250000
253900*dmh           PV-DISPLAY-IP-ADDR        DELIMITED BY SIZE        26260000
254000*dmh                                INTO DP013-MESSAGE-TEXT (2)   26270000
254100*dmh    MOVE DP081-RETCODE            TO  PV-RETCODE              26280000
254200*dmh    MOVE DP081-ERRNO              TO  PV-ERRNO                26290000
254300*dmh    STRING ' EZASOKET CONNECT -'      DELIMITED BY SIZE       26300000
254400*dmh           ' DP081-RETCODE - '        DELIMITED BY SIZE       26310000
254500*dmh           PV-RETCODE                 DELIMITED BY SIZE       26320000
254600*dmh           ' DP081-ERRNO - '          DELIMITED BY SIZE       26330000
254700*dmh           PV-ERRNO                   DELIMITED BY SIZE       26340000
254800*dmh                                 INTO DP013-MESSAGE-TEXT (3)  26350000
254900*dmh    MOVE   LBPTDA-PO-NBR           TO  PV-DISPLAY-PO          26360000
255000*dmh    MOVE   LBPTDA-RCVR-SEQ-NBR     TO  PV-DISPLAY-RCVR        26370000
255100*dmh    MOVE   LBPTDA-PO-LNE-NBR       TO  PV-DISPLAY-LINE        26380000
255200*dmh    MOVE   SU001-OPER-UNT-ID       TO  PV-DISPLAY-OPER        26390000
255300*dmh    STRING ' PRTR ID: '                DELIMITED BY SIZE      26400000
255400*dmh           SU001-PRINTER-ID-USE        DELIMITED BY SIZE      26410000
255500*dmh           '   OPER: '                 DELIMITED BY SIZE      26420000
255600*dmh           PV-DISPLAY-OPER             DELIMITED BY SIZE      26430000
255700*dmh           '   PO: '                   DELIMITED BY SIZE      26440000
255800*dmh           PV-DISPLAY-PO               DELIMITED BY SIZE      26450000
255900*dmh           '   RCVR: '                 DELIMITED BY SIZE      26460000
256000*dmh           PV-DISPLAY-RCVR             DELIMITED BY SIZE      26470000
256100*dmh           '   LINE: '                 DELIMITED BY SIZE      26480000
256200*dmh           PV-DISPLAY-LINE             DELIMITED BY SIZE      26490000
256300*dmh                                  INTO DP013-MESSAGE-TEXT (4) 26500000
256400*dmh    PERFORM 9999-WRITE-CICS-LOG-MSG                           26510000
256500** DMH - 3/24/05 - END                                            26520000
256600                                                                  26530000
256700*** BEGIN - FOR TESTING ONLY                                      26540000
256800*    ELSE                                                         26550000
256900*       MOVE ' SUKRF707 - CONNECT SOCKET SUCCESSFUL'              26560000
257000*                                           TO PV-CICS-MSG-AREA   26570000
257100*       PERFORM 9990-WRITE-CICS                                   26580000
257200*** END - FOR TESTING ONLY                                        26590000
257300     END-IF.                                                      26600000
257400                                                                  26610000
257500                                                                  26620000
257600*----------------------------------------------------------------*26630000
257700*  CLOSE THE SOCKET                                              *26640000
257800*----------------------------------------------------------------*26650000
257900 4340-CLOSE-SOCKET.                                               26660000
258000                                                                  26670000
258100     CALL 'EZASOKET'                                              26680000
258200         USING DP081-CLOSE-CMD                                    26690000
258300               DP081-SOCK-ID                                      26700000
258400               DP081-ERRNO                                        26710000
258500               DP081-RETCODE.                                     26720000
258600                                                                  26730000
258700     IF DP081-RETCODE < ZERO                                      26740000
258800        SET  PS-SOCKET-ERROR         TO TRUE                      26750000
258900        MOVE PC-COMMUNICATION-ERROR  TO AMSGLNO                   26760000
259000        MOVE DP015-UNP-NUM-BRT-MDT   TO APRTIDA                   26770000
259100        MOVE -1                      TO APRTIDL                   26780000
259200        MOVE PC-CURRENT-PROGRAM-NAME TO DP081-TCP-IP-PGM-NAME     26790000
259300        SET  DP081-TCP-IP-CLOSE-ERR  TO TRUE                      26800000
259400        MOVE DP081-ERRNO             TO DP081-TCP-IP-ERR-NBR      26810000
259500        SET  DP013-OTHER-ABEND       TO TRUE                      26820000
259600        SET  DP013-NO-ROLLBACK       TO TRUE                      26830000
259700        MOVE '4340-CLOSE-SOCKET'     TO DP013-PARAGRAPH           26840000
259800        MOVE DP081-TCP-IP-LOGGING-MSG TO DP013-MESSAGE-TEXT (1)   26850000
259900        MOVE DP081-NAME-FAMILY        TO PV-DISPLAY-FAMILY        26860000
260000        MOVE DP081-NAME-PORT          TO PV-DISPLAY-PORT          26870000
260100        MOVE DP081-NAME-IP-ADDR       TO PV-DISPLAY-IP-ADDR       26880000
260200        STRING ' SUKRF707 - '            DELIMITED BY SIZE        26890000
260300               'DP081-FAMILY='           DELIMITED BY SIZE        26900000
260400               PV-DISPLAY-FAMILY         DELIMITED BY SIZE        26910000
260500               ' DP081-PORT='            DELIMITED BY SIZE        26920000
260600               PV-DISPLAY-PORT           DELIMITED BY SIZE        26930000
260700               ' DP081-IP-ADDR='         DELIMITED BY SIZE        26940000
260800               PV-DISPLAY-IP-ADDR        DELIMITED BY SIZE        26950000
260900                                    INTO DP013-MESSAGE-TEXT (2)   26960000
261000        MOVE DP081-RETCODE            TO  PV-RETCODE              26970000
261100        MOVE DP081-ERRNO              TO  PV-ERRNO                26980000
261200        STRING ' EZASOKET CONNECT -'      DELIMITED BY SIZE       26990000
261300               ' DP081-RETCODE - '        DELIMITED BY SIZE       27000000
261400               PV-RETCODE                 DELIMITED BY SIZE       27010000
261500               ' DP081-ERRNO - '          DELIMITED BY SIZE       27020000
261600               PV-ERRNO                   DELIMITED BY SIZE       27030000
261700                                     INTO DP013-MESSAGE-TEXT (3)  27040000
261800        MOVE   LBPTDA-PO-NBR           TO  PV-DISPLAY-PO          27050000
261900        MOVE   LBPTDA-RCVR-SEQ-NBR     TO  PV-DISPLAY-RCVR        27060000
262000        MOVE   LBPTDA-PO-LNE-NBR       TO  PV-DISPLAY-LINE        27070000
262100        MOVE   SU001-OPER-UNT-ID       TO  PV-DISPLAY-OPER        27080000
262200        STRING ' PRTR ID: '                DELIMITED BY SIZE      27090000
262300               SU001-PRINTER-ID-USE        DELIMITED BY SIZE      27100000
262400               '   OPER: '                 DELIMITED BY SIZE      27110000
262500               PV-DISPLAY-OPER             DELIMITED BY SIZE      27120000
262600               '   PO: '                   DELIMITED BY SIZE      27130000
262700               PV-DISPLAY-PO               DELIMITED BY SIZE      27140000
262800               '   RCVR: '                 DELIMITED BY SIZE      27150000
262900               PV-DISPLAY-RCVR             DELIMITED BY SIZE      27160000
263000               '   LINE: '                 DELIMITED BY SIZE      27170000
263100               PV-DISPLAY-LINE             DELIMITED BY SIZE      27180000
263200                                      INTO DP013-MESSAGE-TEXT (4) 27190000
263300        PERFORM 9999-WRITE-CICS-LOG-MSG                           27200000
263400                                                                  27210000
263500*** BEGIN - FOR TESTING ONLY                                      27220000
263600*    ELSE                                                         27230000
263700*       MOVE ' SUKRF707 - CLOSE SOCKET SUCCESSFUL'                27240000
263800*                                           TO PV-CICS-MSG-AREA   27250000
263900*       PERFORM 9990-WRITE-CICS                                   27260000
264000*** END - FOR TESTING ONLY                                        27270000
264100                                                                  27280000
264200     END-IF.                                                      27290000
264300                                                                  27300000
264400                                                                  27310000
264500*----------------------------------------------------------------*27320000
264600*                                                                *27330000
264700*----------------------------------------------------------------*27340000
264800 4370-CREATE-TRANS-ID.                                            27350000
264900                                                                  27360000
265000     CALL PC-RANDOM-PGM USING DFHEIBLK                            27370000
265100                              DFHCOMMAREA                         27380000
265200                              DP902-RANDNBR-ROUTINE-FIELDS.       27390000
265300                                                                  27400000
265400     IF  DP902-SUCCESSFUL                                         27410000
265500         MOVE DP902-RANDOM-NUMBER    TO PV-RANDOM-NUMBER          27420000
265600         MOVE PV-RANDOM-1-8          TO PV-LPMS-TRANS-ID          27430000
265700         SET  PS-TRANS-ID-DUP        TO TRUE                      27440000
265800         PERFORM 4750-CK-TRANS-ID                                 27450000
265900                 UNTIL PS-TRANS-ID-NOT-DUP                        27460000
266000         PERFORM 4700-LABEL-HISTORY                               27470000
266100                                                                  27480000
266200     ELSE                                                         27490000
266300                                                                  27500000
266400         SET  PS-INVALID-TRANS-ID    TO TRUE                      27510000
266500         SET  PS-INVALID-INPUT       TO TRUE                      27520000
266600         MOVE DP015-UNP-NUM-BRT-MDT  TO ABATCHA                   27530000
266700         MOVE -1                     TO ABATCHL                   27540000
266800         MOVE PC-BAD-TRANS-NMBR      TO AMSGLNO                   27550000
266900         STRING ' SUKRF707 -'              DELIMITED BY SIZE      27560000
267000                ' 4370-CREATE-TRANS-ID -'  DELIMITED BY SIZE      27570000
267100                ' ERROR GENERATING RANDOM' DELIMITED BY SIZE      27580000
267200                ' NBR FOR LPMS TRANS ID'   DELIMITED BY SIZE      27590000
267300                                           INTO PV-CICS-MSG-AREA  27600000
267400         PERFORM 9990-WRITE-CICS                                  27610000
267500         MOVE   SU001-MANIFEST      TO PV-DISPLAY-MANIFEST        27620000
267600         STRING ' SUKRF707 -'              DELIMITED BY SIZE      27630000
267700                ' TRIP - '                 DELIMITED BY SIZE      27640000
267800                PV-DISPLAY-MANIFEST        DELIMITED BY SIZE      27650000
267900                '  USER ID - '             DELIMITED BY SIZE      27660000
268000                SU001-USER-ID              DELIMITED BY SIZE      27670000
268100                '  BATCH NUMBER - '        DELIMITED BY SIZE      27680000
268200                PV-BATCH-NUMBER-N          DELIMITED BY SIZE      27690000
268300                                           INTO PV-CICS-MSG-AREA  27700000
268400         PERFORM 9990-WRITE-CICS                                  27710000
268500     END-IF.                                                      27720000
268600                                                                  27730000
268700                                                                  27740000
268800*----------------------------------------------------------------*27750000
268900*                                                                *27760000
269000*----------------------------------------------------------------*27770000
269100 4400-BLD-HDR-REC.                                                27780000
269200     INITIALIZE PC133-LABEL-HDR-REC.                              27790000
269300     SET  PC133-LABEL-HDR           TO  TRUE.                     27800000
269400                                                                  27810000
269500     MOVE PV-LPMS-TRANS-ID          TO  PC133-HDR-TRANS-ID.       27820000
269600     MOVE SU001-PRINTER-ID-USE      TO  PV-PRINTER-HOLD.          27830000
269700     MOVE PV-PRINTER-1-3            TO  PC133-HDR-PRTR-ID.        27840000
269800     MOVE SPACES                    TO  PC133-HDR-LBL-TYPE.       27850000
269900     MOVE SU001-PO                  TO  PC133-HDR-PO-NBR.         27860000
270000     MOVE SU001-RCVR-SEQ-NBR        TO  PC133-HDR-RCVR-SEQ.       27870000
270100     MOVE ZEROES                    TO  PC133-HDR-STORE-NBR.      27880000
270200     MOVE SPACES                    TO  PC133-HDR-PROC-AREA.      27890000
270300                                                                  27900000
270400     INSPECT PC133-LABEL-HDR-REC REPLACING ALL                    27910000
270500         '' BY SPACES.                                           27920000
270600     INSPECT PC133-LABEL-HDR-REC REPLACING ALL                    27930000
270700         ';' BY SPACES.                                           27940000
270800     INSPECT PC133-LABEL-HDR-REC REPLACING ALL                    27950000
270900         LOW-VALUES BY SPACES.                                    27960000
271000                                                                  27970000
271100     MOVE PC133-HDR-REC-LENGTH    TO DP081-TCPLENG                27980000
271200                                     DP081-NBR-BYTES.             27990000
271300     PERFORM 5100-SEND-DATA-TO-LPMS.                              28000000
271400                                                                  28010000
271500                                                                  28020000
271600*----------------------------------------------------------------*28030000
271700* BUILD DETAIL RECORD                                            *28040000
271800*----------------------------------------------------------------*28050000
271900 4500-BLD-DTL-REC.                                                28060000
272000**GB 4/21/02 CHECK TO NOT PRINT HEADER AND FOOTER FOR PRINT & PEEL28070000
272100     IF SU001-PRINT-AND-PEEL                                      28080000
272200        CONTINUE                                                  28090000
272300     ELSE                                                         28100000
272400        MOVE  ZEROES TO PV-TRAILER-COUNT                          28110000
272500        PERFORM 4800-CREATE-HEADER-LABEL                          28120000
272600     END-IF.                                                      28130000
272700                                                                  28140000
272800     SET PS-NOT-EOF-LBL-CURSOR TO TRUE.                           28150000
272900     MOVE SPACES TO PV-PREV-LABEL-TYPE.                           28160000
273000     PERFORM 4550-OPEN-LBL-CURSOR.                                28170000
273100*INITIAL FETCH                                                    28180000
273200     PERFORM 4555-FETCH-LBL-CURSOR.                               28190000
273300*                                                                 28200000
273400     PERFORM UNTIL PS-EOF-LBL-CURSOR                              28210000
273500        IF PS-SULBXF-NOT-FOUND                                    28220000
273600           CONTINUE                                               28230000
273700        ELSE                                                      28240000
      **gb 8/15/13  - add check of audit stat                           28250000
273800           IF LBPTDA-CART-ACTN-CDE = ' '                          28260000
274800              PERFORM 5000-AUDIT-STATUS-CHECK                     28270000
274900           END-IF                                                 28280000
275100           EVALUATE TRUE                                          28290000
275200                WHEN LBPTDA-CART-LBL-TYP-CDE = 'C'                28300000
275300                WHEN LBPTDA-CART-LBL-TYP-CDE = 'E'                28310000
275400                   PERFORM 4920-CREATE-CNSTK-LABEL                28320000
275500                WHEN LBPTDA-CART-LBL-TYP-CDE = 'P'                28330000
275600                   PERFORM 4910-CREATE-P2L-LABEL                  28340000
275700                WHEN LBPTDA-CART-LBL-TYP-CDE = 'S'                28350000
275800                   PERFORM 4900-CREATE-SML-LABEL                  28360000
275900                WHEN LBPTDA-CART-LBL-TYP-CDE = 'R'                28370000
276000                   PERFORM 4915-CREATE-EC-REPURP-LBL              28380000
276100                WHEN LBPTDA-CART-LBL-TYP-CDE = 'Q'                28390000
276200                WHEN LBPTDA-CART-LBL-TYP-CDE = 'W'                28400000
276300                WHEN LBPTDA-CART-LBL-TYP-CDE = 'F'                28410000
276400                WHEN LBPTDA-CART-LBL-TYP-CDE = 'O'                28420000
276500                WHEN LBPTDA-CART-LBL-TYP-CDE = 'K'                28430000
276600                WHEN LBPTDA-CART-LBL-TYP-CDE = 'I'                28440000
276700                   PERFORM 4930-CREATE-MESSAGE-LABEL              28450000
276800           END-EVALUATE                                           28460000
276900           MOVE LBPTDA-CART-LBL-TYP-CDE TO PV-PREV-LABEL-TYPE     28470000
277000           MOVE SULBXF-CART-LBL-TYP-CDE                           28480000
277100                                  TO PV-PREV-SULBXF-LBL-TYP-CDE   28490000
277200           MOVE LBPTDA-DEST-OPER-UNT-ID                           28500000
277300                                  TO PV-PREV-DEST-OPER-UNT-ID     28510000
277400           MOVE LBPTDA-SKU-NBR                                    28520000
277500                                  TO PV-PREV-SKU-NBR              28530000
277600        END-IF                                                    28540000
277700        PERFORM 4555-FETCH-LBL-CURSOR                             28550000
277800     END-PERFORM                                                  28560000
277900                                                                  28570000
278000     PERFORM 4570-CLOSE-LBL-CURSOR.                               28580000
278100*GB 4/21/02                                                       28590000
278200     IF SU001-PRINT-AND-PEEL                                      28600000
278300        CONTINUE                                                  28610000
278400     ELSE                                                         28620000
278500        PERFORM 4810-CREATE-TRAILER-LABEL                         28630000
278600     END-IF.                                                      28640000
278700*                                                                 28650000
278800*                                                                 28660000
278900*----------------------------------------------------------------*28670000
279000* SEND HEADER LABEL                                              *28680000
279100*----------------------------------------------------------------*28690000
279200 4510-HDR-LABEL.                                                  28700000
279300     INITIALIZE PC133-LABEL-DTL-REC.                              28710000
279400     SET  PC133-LABEL-DTL           TO  TRUE.                     28720000
279500                                                                  28730000
279600     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       28740000
279700     SET  PC134-IDX-2               TO  PC134-IDX.                28750000
279800     MOVE PC134-HDR-LINE-LENGTH (PC134-IDX-2)                     28760000
279900                                    TO  PC133-DTL-LENGTH.         28770000
280000     MOVE PC134-SML-HEADER-LINE (PC134-IDX)                       28780000
280100                                    TO  PC133-DTL-DATA.           28790000
280200                                                                  28800000
280300     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    28810000
280400         '' BY SPACES.                                           28820000
280500     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    28830000
280600         ';' BY SPACES.                                           28840000
280700     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    28850000
280800         LOW-VALUES BY SPACES.                                    28860000
280900                                                                  28870000
281000******************************************************************28880000
281100* LENGTH CALCULATION:                                            *28890000
281200*       LINE LENGTH HEADER LABEL (PC134-HDR-LINE-LENGTH)         *28900000
281300*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *28910000
281400*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *28920000
281500*              PC133-DTL-LENGTH        (3 POSITIONS)             *28930000
281600*              HEX 03-END EACH DTL REC (1 POSITIONS)             *28940000
281700*              FILLER                  (6 POSITIONS)             *28950000
281800******************************************************************28960000
281900     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        28970000
282000     MOVE PC134-HDR-LINE-LENGTH (PC134-IDX-2)                     28980000
282100                                  TO PC133-DTL-REC-LENGTH.        28990000
282200     ADD  20                      TO PC133-DTL-REC-LENGTH.        29000000
282300     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                29010000
282400                                     DP081-NBR-BYTES.             29020000
282500                                                                  29030000
282600     PERFORM 5100-SEND-DATA-TO-LPMS.                              29040000
282700                                                                  29050000
282800     ADD  1  TO  PV-TRAILER-COUNT.                                29060000
282900                                                                  29070000
283000                                                                  29080000
283100*----------------------------------------------------------------*29090000
283200* OPEN LABEL CURSOR                                              *29100000
283300*----------------------------------------------------------------*29110000
283400 4550-OPEN-LBL-CURSOR.                                            29120000
283500                                                                  29130000
283600     EXEC SQL                                                     29140000
283700         OPEN LABEL_CURSOR                                        29150000
283800     END-EXEC.                                                    29160000
283900                                                                  29170000
284000     EVALUATE TRUE                                                29180000
284100         WHEN SQLCODE = +0                                        29190000
284200              SET PS-NOT-EOF-LBL-CURSOR  TO  TRUE                 29200000
284300         WHEN SQLCODE  NOT =  +0                                  29210000
284400              MOVE '4550-OPEN-LBL-CURSOR'                         29220000
284500                                  TO DP013-PARAGRAPH              29230000
284600              MOVE 'OPEN LABEL BATCH CURSOR'                      29240000
284700                                  TO DP013-MESSAGE-TEXT (1)       29250000
284800              MOVE SQLCA          TO DP013-SQLCA                  29260000
284900              MOVE 'TLBPTDA'      TO DP013-DB2-TABLE-NAME (1)     29270000
285000              SET DP013-DB2-ABEND TO TRUE                         29280000
285100*             PERFORM 9999-WRITE-CICS-LOG-MSG                     29290000
285200             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              29300000
285300              PERFORM DP014-0000-PROCESS-ABEND                    29310000
285400     END-EVALUATE.                                                29320000
285500                                                                  29330000
285600                                                                  29340000
285700*----------------------------------------------------------------*29350000
285800* FETCH LABEL CURSOR                                             *29360000
285900*----------------------------------------------------------------*29370000
286000 4555-FETCH-LBL-CURSOR.                                           29380000
286100                                                                  29390000
286200     EXEC SQL                                                     29400000
286300          FETCH LABEL_CURSOR                                      29410000
286400          INTO :LBPTDA-TRIP-ID                                    29420000
286500              ,:LBPTDA-CRE-USR-ID                                 29430000
286600              ,:LBPTDA-LBL-PRT-BTCH-ID                            29440000
286700              ,:LBPTDA-SHIPT-UNT-ID                               29450000
286800              ,:LBPTDA-OPER-UNT-ID                                29460000
286900              ,:LBPTDA-FCLTY-ID                                   29470000
287000              ,:LBPTDA-CRE-TMST                                   29480000
287100              ,:LBPTDA-OWNR-SCAC-ID                               29490000
287200              ,:LBPTDA-VEH-NBR                                    29500000
287300              ,:LBPTDA-RPRT-IND                                   29510000
287400              ,:LBPTDA-SU-DUP-LBL-IND                             29520000
287500              ,:LBPTDA-SU-FRE-ASTRA-IND                           29530000
287600              ,:LBPTDA-SU-MSSG-DAT-IND                            29540000
287700              ,:LBPTDA-SU-MISDIR-IND                              29550000
287800              ,:LBPTDA-MISDIR-OPER-UNT-ID                         29560000
287900              ,:LBPTDA-PO-NBR                                     29570000
288000              ,:LBPTDA-RCVR-SEQ-NBR                               29580000
288100              ,:LBPTDA-PO-LNE-NBR                                 29590000
288200              ,:LBPTDA-DEST-OPER-UNT-ID                           29600000
288300              ,:LBPTDA-STR-NM                                     29610000
288400              ,:LBPTDA-STR-ZN-ID                                  29620000
288500              ,:LBPTDA-SKU-DEPT-NBR                               29630000
288600              ,:LBPTDA-SKU-CL-NBR                                 29640000
288700              ,:LBPTDA-VS-NBR                                     29650000
288800              ,:LBPTDA-OTPK-UNT-QTY                               29660000
288900              ,:LBPTDA-INPK-UNT-QTY                               29670000
289000              ,:LBPTDA-PRTR-ID                                    29680000
289100              ,:LBPTDA-BRCDE-NBR                                  29690000
289200              ,:LBPTDA-DC-PRTD-AT-CDE                             29700000
289300              ,:LBPTDA-INVLD-DAT-ERR-CDE                          29710000
289400              ,:LBPTDA-PREPK-ID                                   29720000
289500              ,:LBPTDA-PREPK-RATO-QTY                             29730000
289600              ,:LBPTDA-PREPK-UNT-QTY                              29740000
289700              ,:LBPTDA-CSE-PK-QTY                                 29750000
289800              ,:LBPTDA-ODD-CART-IND                               29760000
289900              ,:LBPTDA-INPK-CNVYB-IND                             29770000
290000              ,:LBPTDA-LBL-TYP-LBL-SEQ-ID                         29780000
290100              ,:LBPTDA-LBL-TYP-TOT-QTY                            29790000
290200              ,:LBPTDA-MODU-DESC                                  29800000
290300              ,:LBPTDA-ITM-NBR                                    29810000
290400              ,:LBPTDA-DEPT-DESC                                  29820000
290500              ,:LBPTDA-MAJ-CL-DESC                                29830000
290600              ,:LBPTDA-SEASET-NM                                  29840000
290700              ,:LBPTDA-FIXT-ID                                    29850000
290800              ,:LBPTDA-CART-LBL-TYP-CDE                           29860000
290900              ,:LBPTDA-STRG-AREA-CDE                              29870000
291000              ,:LBPTDA-CART-ACTN-CDE                              29880000
291100              ,:LBPTDA-HNG-FOLD-SEQ-NBR                           29890000
291200              ,:LBPTDA-BUS-AREA-ID                                29900000
291300              ,:LBPTDA-SKU-NBR                                    29910000
291400              ,:PV-DEPT-MAJ-CLASS-CONCAT                          29920000
291500              ,:LBPTDA-EAS-TAG-IND                                29930000
291600              ,:LBPTDA-DOOR-ID                                    29940000
      *CLP 06/24/15 - START                                             29950019
291700              ,:LBPTDA-LBL-MSG-TXT                                29960019
      *CLP 06/24/15 - END                                               29970019
291900              ,:LBPTDA-PRC-MSG-CDE   :PV-NULL-IND                 29980000
292100     END-EXEC.                                                    29990000
292200                                                                  30000000
292300     EVALUATE TRUE                                                30010000
292400         WHEN SQLCODE = ZERO                                      30020000
292500             EVALUATE TRUE                                        30030000
292600               WHEN LBPTDA-CART-LBL-TYP-CDE = 'F'                 30040000
292700               WHEN LBPTDA-CART-LBL-TYP-CDE = 'I'                 30050000
292800               WHEN LBPTDA-CART-LBL-TYP-CDE = 'K'                 30060000
292900               WHEN LBPTDA-CART-LBL-TYP-CDE = 'O'                 30070000
293000               WHEN LBPTDA-CART-LBL-TYP-CDE = 'Q'                 30080000
293100               WHEN LBPTDA-CART-LBL-TYP-CDE = 'R'                 30090000
293200               WHEN LBPTDA-CART-LBL-TYP-CDE = 'W'                 30100000
293300               WHEN LBPTDA-CART-ACTN-CDE    = 'Q'                 30110000
293400                   SET  PS-SULBXF-FOUND  TO TRUE                  30120000
293500               WHEN OTHER                                         30130000
293600                   PERFORM 4556-GET-LABEL-STATUS                  30140000
293700             END-EVALUATE                                         30150000
293800*            PERFORM 4558-CALL-XLKUT-DOMAIN                       30160000
293900         WHEN SQLCODE = +100                                      30170000
294000              SET PS-EOF-LBL-CURSOR TO TRUE                       30180000
294100         WHEN SQLWARN0 NOT = +0                                   30190000
294200         WHEN SQLCODE < ZERO                                      30200000
294300         WHEN SQLCODE > ZERO                                      30210000
294400              MOVE '4555-FETCH-LBL-CURSOR'                        30220000
294500                                  TO DP013-PARAGRAPH              30230000
294600              MOVE 'FETCH LABEL BATCH CURSOR'                     30240000
294700                                  TO DP013-MESSAGE-TEXT (1)       30250000
294800              MOVE SQLCA          TO DP013-SQLCA                  30260000
294900              MOVE 'TLBPTDA'      TO DP013-DB2-TABLE-NAME (1)     30270000
295000              SET DP013-DB2-ABEND TO TRUE                         30280000
295100              SET DP013-NO-ROLLBACK                               30290000
295200                              TO TRUE                             30300000
295300*             PERFORM 9999-WRITE-CICS-LOG-MSG                     30310000
295400             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              30320000
295500              PERFORM DP014-0000-PROCESS-ABEND                    30330000
295600     END-EVALUATE.                                                30340000
295700                                                                  30350000
295800*----------------------------------------------------------------*30360000
295900* CHECK LABEL STATUS                                             *30370000
296000*----------------------------------------------------------------*30380000
296100 4556-GET-LABEL-STATUS.                                           30390000
296200     MOVE LBPTDA-BRCDE-NBR     TO DK-BARCODE-NBR                  30400000
296300     SET  PS-SULBXF-NOT-FOUND  TO TRUE                            30410000
296400                                                                  30420000
296500*    PERFORM                                                      30430000
296600*        WITH TEST AFTER                                          30440000
296700*        VARYING PV-RETRY-COUNTER                                 30450000
296800*        FROM 1 BY 1                                              30460000
296900*        UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               30470000
297000*                  OR (SQLCODE = ZERO)                            30480000
297100*                  OR (SQLCODE = +100))                           30490000
297200                                                                  30500000
297300         EXEC SQL                                                 30510000
297400              SELECT CART_LBL_TYP_CDE                             30520000
297500              INTO :SULBXF-CART-LBL-TYP-CDE                       30530000
297600              FROM TSULBXF                                        30540000
297700              WHERE BRCDE_NBR  = :DK-BARCODE-NBR                  30550000
297800                AND STAT_CDE   = 'A'                              30560000
297900                AND SHIPT_UNT_ID = :LBPTDA-SHIPT-UNT-ID           30570000
298000             WITH UR                                              30580000
298100         END-EXEC                                                 30590000
298200                                                                  30600000
298300     EVALUATE TRUE                                                30610000
298400         WHEN SQLCODE = ZERO                                      30620000
298500              SET  PS-SULBXF-FOUND  TO TRUE                       30630000
298600         WHEN SQLCODE = +100                                      30640000
298700              SET  PS-SULBXF-NOT-FOUND     TO TRUE                30650000
298800         WHEN SQLCODE = -911                                      30660000
298900         WHEN SQLCODE = -913                                      30670000
299000         WHEN SQLCODE = -904                                      30680000
299100             CONTINUE                                             30690000
299200         WHEN OTHER                                               30700000
299300             STRING ' SUKRF707 - '            DELIMITED BY SIZE   30710000
299400                     'DK-BARCODE-NBR: '        DELIMITED BY SIZE  30720000
299500                      DK-BARCODE-NBR           DELIMITED BY SIZE  30730000
299600                                          INTO PV-CICS-MSG-AREA   30740000
299700             MOVE LENGTH OF PV-CICS-MSG-AREA                      30750000
299800                     TO PV-COMMAREA-LENGTH                        30760000
299900             PERFORM 9990-WRITE-CICS                              30770000
300000                                                                  30780000
300100             MOVE '4556-GET-LABEL-STATUS'                         30790000
300200                                            TO DP013-PARAGRAPH    30800000
300300             MOVE 'SUKRF707 - GET LABEL STATUS CODE'              30810000
300400                             TO DP013-MESSAGE-TEXT(1)             30820000
300500             MOVE   LBPTDA-OPER-UNT-ID      TO  PV-DISPLAY-OPER   30830000
300600             MOVE   LBPTDA-TRIP-ID          TO  PV-DISPLAY-TRIP   30840000
300700             MOVE   LBPTDA-LBL-PRT-BTCH-ID  TO  PV-DISPLAY-BATCH  30850000
300800             MOVE   LBPTDA-PO-NBR           TO  PV-DISPLAY-PO     30860000
300900             MOVE   LBPTDA-RCVR-SEQ-NBR     TO  PV-DISPLAY-RCVR   30870000
301000             MOVE   LBPTDA-PO-LNE-NBR       TO  PV-DISPLAY-LINE   30880000
301100             STRING 'OPER UNIT: '                                 30890000
301200                    PV-DISPLAY-OPER                               30900000
301300                    '   DK-BARCODE-NBR: '                         30910000
301400                     DK-BARCODE-NBR                               30920000
301500                    '   BATCH NO: '                               30930000
301600                    PV-DISPLAY-BATCH        DELIMITED BY SIZE     30940000
301700                                       INTO DP013-MESSAGE-TEXT(2) 30950000
301800             STRING 'TRIP ID: '                                   30960000
301900                    PV-DISPLAY-TRIP                               30970000
302000                    '   SCAC: '                                   30980000
302100                    LBPTDA-OWNR-SCAC-ID                           30990000
302200                    '   TRLR: '                                   31000000
302300                    LBPTDA-VEH-NBR          DELIMITED BY SIZE     31010000
302400                                        INTO DP013-MESSAGE-TEXT(3)31020000
302500             STRING '   OPER: '                                   31030000
302600                    PV-DISPLAY-OPER                               31040000
302700                    'PO: '                                        31050000
302800                    PV-DISPLAY-PO                                 31060000
302900                    '   RCVR: '                                   31070000
303000                    PV-DISPLAY-RCVR                               31080000
303100                    '   LINE: '                                   31090000
303200                    PV-DISPLAY-LINE         DELIMITED BY SIZE     31100000
303300                                       INTO DP013-MESSAGE-TEXT(4) 31110000
303400             MOVE SQLCA      TO DP013-SQLCA                       31120000
303500             MOVE 'TSULBXF'  TO DP013-DB2-TABLE-NAME(1)           31130000
303600             SET DP013-DB2-ABEND            TO TRUE               31140000
303700             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              31150000
303800             PERFORM DP014-0000-PROCESS-ABEND                     31160000
303900         END-EVALUATE.                                            31170000
304000*    END-PERFORM.                                                 31180000
304100                                                                  31190000
304200*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        31200000
304300*              AND SQLCODE NOT = ZERO                             31210000
304400*                                                                 31220000
304500*        STRING ' SUKRF707 - '                                    31230000
304600*               'DK-BARCODE-NBR: '                                31240000
304700*                DK-BARCODE-NBR           DELIMITED BY SIZE       31250000
304800*                                          INTO PV-CICS-MSG-AREA  31260000
304900*        MOVE LENGTH OF PV-CICS-MSG-AREA                          31270000
305000*                    TO PV-COMMAREA-LENGTH                        31280000
305100*        PERFORM 9990-WRITE-CICS                                  31290000
305200*                                                                 31300000
305300*        MOVE '4556-GET-LABEL-STATUS'                             31310000
305400*                            TO DP013-PARAGRAPH                   31320000
305500*        MOVE 'SUKRF707 - GET LABEL STATUS CODE'                  31330000
305600*                            TO DP013-MESSAGE-TEXT(1)             31340000
305700*        MOVE   LBPTDA-OPER-UNT-ID          TO PV-DISPLAY-OPER    31350000
305800*        MOVE   LBPTDA-TRIP-ID              TO PV-DISPLAY-TRIP    31360000
305900*        MOVE   LBPTDA-LBL-PRT-BTCH-ID      TO PV-DISPLAY-BATCH   31370000
306000*        MOVE   LBPTDA-PO-NBR               TO PV-DISPLAY-PO      31380000
306100*        MOVE   LBPTDA-RCVR-SEQ-NBR         TO PV-DISPLAY-RCVR    31390000
306200*        MOVE   LBPTDA-PO-LNE-NBR           TO PV-DISPLAY-LINE    31400000
306300*        STRING 'OPER UNIT: '                                     31410000
306400*               PV-DISPLAY-OPER                                   31420000
306500*               '   DK-BARCODE-NBR: '                             31430000
306600*                DK-BARCODE-NBR                                   31440000
306700*               '   BATCH NO: '                                   31450000
306800*               PV-DISPLAY-BATCH        DELIMITED BY SIZE         31460000
306900*                                      INTO DP013-MESSAGE-TEXT(2) 31470000
307000*        STRING 'TRIP ID: '                                       31480000
307100*               PV-DISPLAY-TRIP                                   31490000
307200*               '   SCAC: '                                       31500000
307300*               LBPTDA-OWNR-SCAC-ID                               31510000
307400*               '   TRLR: '                                       31520000
307500*               LBPTDA-VEH-NBR          DELIMITED BY SIZE         31530000
307600*                                      INTO DP013-MESSAGE-TEXT(3) 31540000
307700*        STRING '   OPER: '                                       31550000
307800*               PV-DISPLAY-OPER                                   31560000
307900*               'PO: '                                            31570000
308000*               PV-DISPLAY-PO                                     31580000
308100*               '   RCVR: '                                       31590000
308200*               PV-DISPLAY-RCVR                                   31600000
308300*               '   LINE: '                                       31610000
308400*               PV-DISPLAY-LINE         DELIMITED BY SIZE         31620000
308500*                                      INTO DP013-MESSAGE-TEXT(4) 31630000
308600*        MOVE SQLCA      TO DP013-SQLCA                           31640000
308700*        MOVE 'TSULBXF'  TO DP013-DB2-TABLE-NAME(1)               31650000
308800*        SET DP013-DB2-ABEND                TO TRUE               31660000
308900*            SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              31670000
309000*        PERFORM DP014-0000-PROCESS-ABEND                         31680000
309100*    END-IF.                                                      31690000
309200                                                                  31700000
309300*                                                                 31710000
309400 4558-CALL-XLKUT-DOMAIN.                                          31720000
309500     INITIALIZE XL001-ITEM-COMMAREA.                              31730000
309600                                                                  31740000
309700     MOVE LBPTDA-SKU-NBR        TO XL001-KEY-SKU.                 31750000
309800                                                                  31760000
309900     SET  XL001-BY-NUMERIC-SKU                                    31770000
310000          XL001-SELECT-VND-STYL TO TRUE.                          31780000
310100                                                                  31790000
310200     CALL XL001-VSM-PGM USING  DFHEIBLK                           31800000
310300                               XL001-COMMAREA                     31810000
310400                               XL001-ITEM-COMMAREA.               31820000
310500     EVALUATE TRUE                                                31830000
310600                                                                  31840000
310700         WHEN XL001-VND-STYL-SQLCODE = +0                         31850000
310800             CONTINUE                                             31860000
310900                                                                  31870000
311000         WHEN XL001-INVALID-ACCESS                                31880000
311100             MOVE '4558-CALL-XLKUT-DOMAIN'                        31890000
311200                             TO DP013-PARAGRAPH                   31900000
311300             MOVE 'ACCESS INFO FOR XLKUT001 INCORRECT'            31910000
311400                             TO DP013-MESSAGE-TEXT (1)            31920000
311500             MOVE LBPTDA-SKU-NBR                                  31930000
311600                             TO PV-DISPLAY-SKU                    31940000
311700             MOVE PV-DISPLAY-SKU                                  31950000
311800                             TO DP013-MESSAGE-TEXT (2)            31960000
311900             MOVE SQLCA      TO DP013-SQLCA                       31970000
312000             MOVE 'XLV_SKU'  TO DP013-DB2-TABLE-NAME (1)          31980000
312100             SET DP013-DB2-ABEND to true                          31990000
312200             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              32000000
312300             PERFORM DP014-0000-PROCESS-ABEND                     32010000
312400                                                                  32020000
312500         WHEN OTHER                                               32030000
312600             MOVE '4558-CALL-XLKUT-DOMAIN'                        32040000
312700                             TO DP013-PARAGRAPH                   32050000
312800             MOVE 'UNSUCCESSFUL SELECT ON XLV_SKU'                32060000
312900                             TO DP013-MESSAGE-TEXT (1)            32070000
313000             MOVE LBPTDA-SKU-NBR                                  32080000
313100                             TO PV-DISPLAY-SKU                    32090000
313200             MOVE PV-DISPLAY-SKU                                  32100000
313300                             TO DP013-MESSAGE-TEXT (2)            32110000
313400             MOVE XL001-SKU-SQLCODE                               32120000
313500                             TO SQLCODE                           32130000
313600             MOVE SQLCA      TO DP013-SQLCA                       32140000
313700             MOVE 'XLV_SKU'  TO DP013-DB2-TABLE-NAME (1)          32150000
313800             SET DP013-DB2-ABEND                                  32160000
313900                             TO TRUE                              32170000
314000             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              32180000
314100             PERFORM DP014-0000-PROCESS-ABEND                     32190000
314200     END-EVALUATE.                                                32200000
314300*                                                                 32210000
314400*----------------------------------------------------------------*32220000
314500* BUILD SML LABEL FORM                                           *32230000
314600*----------------------------------------------------------------*32240000
314700 4559-BUILD-SML-FORM.                                             32250000
314800     INITIALIZE PC133-LABEL-DTL-REC.                              32260000
314900     SET  PC133-LABEL-DTL           TO  TRUE.                     32270000
315000                                                                  32280000
315100     IF  LBPTDA-CART-ACTN-CDE = PC-Q                              32290000
315200         MOVE SPACES                 TO  PC255-SML-BARCODE        32300000
315300         MOVE LBPTDA-BRCDE-NBR       TO  PC255-AUDIT-BARCODE      32310000
315400         IF LBPTDA-SU-FRE-ASTRA-IND =  PC-T                       32320000
315500            SET PC255-FSTY-AUDIT-YES TO TRUE                      32330000
315600         ELSE                                                     32340000
315700            SET PC255-AUDIT-HDG-YES  TO TRUE                      32350000
315800         END-IF                                                   32360000
315900                                                                  32370000
316000         MOVE '@@@@@@@@@@@@@@@@@@@@@@@@@' TO  PC255-SET           32380000
316100         MOVE '@@'                        TO PC255-MDSE-GROUP     32390000
316200         SET PC255-AUDIT-NBR-SIDE                                 32400000
316300             PC255-MFST-BOX-NO                                    32410000
316400             PC255-TRIP-HDG                                       32420000
316500             PC255-DEFLT-PRESENTATION                             32430000
316600             PC255-STR-REV-NO                                     32440000
316700             PC255-TEST-LNE-NO                                    32450000
316800             PC255-NO-ZONE-HDG                                    32460000
316900             PC255-AUDIT-YES                                      32470000
317000             PC255-FORM-NO-STORE-ON-HAND                          32480000
317100             PC255-EAS-TAG-NOT-NEEDED                             32490000
317200             PC255-OH-ZERO-NO                                     32500000
317300             PC255-FORM-NO-FIX-HDG                                32510000
317400*DMH6/30/11  PC255-FIXTURE-NO                                     32520000
317500             PC256-FIXTURE-HDG-NO                                 32530000
317600             PC255-FORM-NO-FIXTURE                                32540000
317700             PC255-FORM-NO-TEXT-1                                 32550000
317800             PC255-FORM-NO-TEXT-2                                 32560000
317900             PC255-FORM-NO-TEXT-3                                 32570000
318000             PC255-FORM-NO-TEXT-4     TO TRUE                     32580000
318100         MOVE  SPACES                 TO  PC256-FIXTURE           32590000
318200     ELSE                                                         32600000
318300                                                                  32610000
318400         MOVE '@@@@@@@@@@@@@@@@@@@@@@@@@' TO  PC255-SET           32620000
318500                                                                  32630000
318600         MOVE '@@@@@@@@@@@@@@@@@@@@' TO  PC255-SML-BARCODE        32640000
318700         SET PC255-SML-BRCD                                       32650000
318800             PC255-AUDIT-HDG-NO                                   32660000
318900             PC255-MFST-BOX-YES                                   32670000
319000             PC255-BRCD-NBR-ABOVE                                 32680000
319100             PC255-STR-REV-YES                                    32690000
319200             PC255-TEST-LNE-YES                                   32700000
319300             PC255-ZONE-HDG                                       32710000
319400             PC255-SET-HDG           TO TRUE                      32720000
319500     END-IF.                                                      32730000
319600                                                                  32740000
319700     SET PC255-CRTN-HDG                                           32750000
319800         PC255-FORM-NO-FIX-HDG          TO TRUE.                  32760000
319900*DMH6/30 PC255-FIXTURE-NO               TO TRUE.                  32770000
320000                                                                  32780000
320100*FIXTURE REVERSE IMAGE  ----  added 12/14/10 dmh                  32790000
320200*DMH6/30  LBPTDA-FIXT-ID  >  SPACES                               32800000
320300*DMH6/30  SET  PC255-FIXTURE-YES  TO  TRUE                        32810000
320400*DMH  ELSE                                                        32820000
320500*DMH6/30  SET  PC255-FIXTURE-NO   TO  TRUE                        32830000
320600*DMH  END-IF.                                                     32840000
320700                                                                  32850000
320800*PREPACK ORDERS                                                   32860000
320900     IF  LBPTDA-PREPK-ID > 0                                      32870000
321000         SET PS-PREPK-FORM              TO TRUE                   32880000
321100         SET PC255-PACK-HDG             TO TRUE                   32890000
321200         MOVE LBPTDA-PREPK-ID           TO PC255-PO-LNE-NBR       32900000
321300     ELSE                                                         32910000
321400         SET PS-NOT-PREPK-FORM          TO TRUE                   32920000
321500         SET PC255-LINE-HDG             TO TRUE                   32930000
321600         MOVE LBPTDA-PO-LNE-NBR         TO PC255-PO-LNE-NBR       32940000
321700     END-IF                                                       32950000
321800                                                                  32960000
321900*INNER PACK CONVEYABLE                                            32970000
322000     IF  LBPTDA-INPK-CNVYB-IND = 'Y'                              32980000
322100         SET PC255-FORM-INPK-BOX        TO TRUE                   32990000
322200         SET PC255-FORM-INPK-HDG        TO TRUE                   33000000
322300     ELSE                                                         33010000
322400         SET PC255-FORM-NO-INPK-BOX     TO TRUE                   33020000
322500         SET PC255-FORM-NO-UNT-HDG      TO TRUE                   33030000
322600     END-IF                                                       33040000
322700                                                                  33050000
322800*REPRINT                                                          33060000
322900     IF  PS-REPRINT-BATCH  OR                                     33070000
323000         LBPTDA-RPRT-IND  =  PC-Y                                 33080000
323100         SET PC255-FORM-REPRT-BOX       TO  TRUE                  33090000
323200         SET PC255-FORM-REPRT-FLD       TO  TRUE                  33100000
323300         SET  PS-REPRINT-FORM           TO  TRUE                  33110000
323400     ELSE                                                         33120000
323500         SET  PC255-FORM-NO-RPRT-BOX    TO  TRUE                  33130000
323600         SET  PC255-FORM-NO-RPRT-FLD    TO  TRUE                  33140000
323700         SET  PS-NOT-REPRINT-FORM       TO  TRUE                  33150000
323800     END-IF.                                                      33160000
323900***                                                               33170000
324000     MOVE LBPTDA-DC-PRTD-AT-CDE     TO  PV-DSPLY-DC.              33180000
324100     MOVE '-'                       TO  PV-DSPLY-DASH.            33190000
324200     MOVE SU001-PRINTER-ID-USE      TO  PV-DSPLY-PRTR-ID.         33200000
324300     MOVE PV-DSPLY-PRTR             TO  PC255-SML-PRTR-NBR.       33210000
324400*                                                                 33220000
324500     MOVE PV-CURRENT-DB2-DATE       TO  PV-WORK-DB2-DATE.         33230000
324600     MOVE PV-WORK-YY                TO  PV-LBL-DATE-YY.           33240000
324700     MOVE PV-WORK-MM                TO  PV-LBL-DATE-MM.           33250000
324800     MOVE PV-WORK-DD                TO  PV-LBL-DATE-DD.           33260000
324900     MOVE '-'                       TO  PV-LBL-DASH1              33270000
325000                                        PV-LBL-DASH2.             33280000
325100     MOVE PV-LBL-DATE               TO  PC255-LBL-PRT-DATE.       33290000
325200*                                                                 33300000
325300     MOVE PV-CURRENT-TIME           TO  PC255-LBL-PRT-TIME.       33310000
325400*                                                                 33320000
325500     MOVE 'CI'                      TO  PC255-FROM-APPLICATION.   33330000
325600     IF  SU001-BATCH-PRINTER                                      33340000
325700         MOVE 'BATCH'               TO  PC255-PRTR-ATTACHED       33350000
325800     ELSE                                                         33360000
325900     IF  SU001-TETHERED-PRINTER                                   33370000
326000         MOVE 'CABLE'               TO  PC255-PRTR-ATTACHED       33380000
326100     ELSE                                                         33390000
326200         MOVE 'OTHER'               TO  PC255-PRTR-ATTACHED       33400000
326300     END-IF                                                       33410000
326400     END-IF.                                                      33420000
326500     MOVE '-SML-'                   TO  PC255-LBL-DESC.           33430000
326600     MOVE PC255-LABEL-INFO-WORK     TO  PC255-LABEL-INFO.         33440000
326700*                                                                 33450000
326800                                                                  33460000
326900     SET  PC255-FORM-NO-FIXTURE     TO TRUE.                      33470000
327000                                                                  33480000
327100*REGULAR SML OR QC AUDIT BARCODE                                  33490000
327200     IF  LBPTDA-CART-ACTN-CDE = PC-Q                              33500000
327300         MOVE SPACES                 TO  PC255-SML-BARCODE        33510000
327400         MOVE LBPTDA-BRCDE-NBR       TO  PC255-AUDIT-BARCODE      33520000
327500         IF LBPTDA-SU-FRE-ASTRA-IND =  PC-T                       33530000
327600            SET PC255-FSTY-AUDIT-YES TO TRUE                      33540000
327700         ELSE                                                     33550000
327800            SET PC255-AUDIT-HDG-YES  TO TRUE                      33560000
327900         END-IF                                                   33570000
328000                                                                  33580000
328100         MOVE '@@@@@@@@@@@@@@@@@@@@@@@@@' TO  PC255-SET           33590000
328200                                                                  33600000
328300         SET PC255-AUDIT-BRCD                                     33610000
328400             PC255-OH-ZERO-NO                                     33620000
328500*DMH6/30/11  PC255-FIXTURE-NO                                     33630000
328600             PC255-MFST-BOX-NO                                    33640000
328700             PC255-AUDIT-NBR-SIDE                                 33650000
328800             PC255-TRIP-HDG                                       33660000
328900             PC255-DEFLT-PRESENTATION TO TRUE                     33670000
329000     ELSE                                                         33680000
329100                                                                  33690000
329200         MOVE '@@@@@@@@@@@@@@@@@@@@@@@@@' TO  PC255-SET           33700000
329300                                                                  33710000
329400         MOVE '@@@@@@@@@@@@@@@@@@@@' TO  PC255-SML-BARCODE        33720000
329500         SET PC255-SML-BRCD                                       33730000
329600             PC255-AUDIT-HDG-NO                                   33740000
329700             PC255-MFST-BOX-YES                                   33750000
329800             PC255-BRCD-NBR-ABOVE                                 33760000
329900             PC255-SET-HDG                   TO TRUE              33770000
330000         IF XL088-PROCESS-MSG-YES                                 33780000
330100            SET PC255-OH-ZERO-YES TO TRUE                         33790000
330200         ELSE                                                     33800000
330300            SET PC255-OH-ZERO-NO  TO TRUE                         33810000
330400         END-IF                                                   33820000
330500     END-IF.                                                      33830000
330600                                                                  33840000
330700                                                                  33850000
330800*REGULAR SML OR QC AUDIT BARCODE                                  33860000
330900     MOVE LBPTDA-CART-ACTN-CDE TO PV-PREV-AUDIT-CART-IND          33870000
331000                                                                  33880000
331100     IF LBPTDA-CART-ACTN-CDE > SPACES                             33890000
331200        MOVE LBPTDA-CART-ACTN-CDE TO PC255-AUDIT-CASI             33900000
331300     ELSE                                                         33910000
331400        MOVE '@'                  TO PC255-AUDIT-CASI             33920000
331500     END-IF                                                       33930000
331600                                                                  33940000
331700     EVALUATE LBPTDA-HNG-FOLD-SEQ-NBR                             33950000
331800        WHEN  PC-0                                                33960000
331900            SET PC255-DEFLT-PRESENTATION TO TRUE                  33970000
332000        WHEN  PC-1                                                33980000
332100            SET PC255-HANG  TO TRUE                               33990000
332200        WHEN  PC-2                                                34000000
332300            SET PC255-FOLD  TO TRUE                               34010000
332400        WHEN  OTHER                                               34020000
332500            SET PC255-DEFLT-PRESENTATION TO TRUE                  34030000
332600     END-EVALUATE                                                 34040000
332700                                                                  34050000
332800     MOVE LBPTDA-CRE-USR-ID         TO  PC255-USER-ID.            34060000
332900                                                                  34070000
333000*                                                                 34080000
333100*                                                                 34090000
333200*----------------------------------------------------------------*34100000
333300* SEND SML LABEL FORM                                            *34110000
333400*----------------------------------------------------------------*34120000
333500 4560-SEND-SML-FORM.                                              34130000
333600     INITIALIZE PC133-LABEL-DTL-REC.                              34140000
333700     SET  PC133-LABEL-DTL           TO  TRUE.                     34150000
333800                                                                  34160000
333900     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       34170000
334000     SET  PC255-IDX-2               TO  PC255-IDX.                34180000
334100     MOVE PC255-DTL-FORM-LNE-LNGTH (PC255-IDX-2)                  34190000
334200                                    TO  PC133-DTL-LENGTH.         34200000
334300     MOVE PC255-SHIP-MFST-LBL-LINE (PC255-IDX)                    34210000
334400                                    TO  PC133-DTL-DATA.           34220000
334500                                                                  34230000
334600     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    34240000
334700         '' BY SPACES.                                           34250000
334800     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    34260000
334900         ';' BY SPACES.                                           34270000
335000     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    34280000
335100         LOW-VALUES BY SPACES.                                    34290000
335200                                                                  34300000
335300******************************************************************34310000
335400* LENGTH CALCULATION:                                            *34320000
335500*       LINE LENGTH SML FORM     (PC255-DTL-FORM-LNE-LNGTH)      *34330000
335600*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *34340000
335700*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *34350000
335800*              PC133-DTL-LENGTH        (3 POSITIONS)             *34360000
335900*              HEX 03-END EACH DTL REC (1 POSITIONS)             *34370000
336000*              FILLER                  (6 POSITIONS)             *34380000
336100******************************************************************34390000
336200     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        34400000
336300     MOVE PC255-DTL-FORM-LNE-LNGTH (PC255-IDX-2)                  34410000
336400                                  TO PC133-DTL-REC-LENGTH.        34420000
336500     ADD  20                      TO PC133-DTL-REC-LENGTH.        34430000
336600     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                34440000
336700                                     DP081-NBR-BYTES.             34450000
336800                                                                  34460000
336900     PERFORM 5100-SEND-DATA-TO-LPMS.                              34470000
337000                                                                  34480000
337100     ADD  1  TO  PV-TRAILER-COUNT.                                34490000
337200*                                                                 34500000
337300*                                                                 34510000
337400*----------------------------------------------------------------*34520000
337500*  BUILD SML LABEL DATA                                          *34530000
337600*----------------------------------------------------------------*34540000
337700 4561-BUILD-SML-DATA.                                             34550000
337800*----------------------------------------------------------------*34560000
337900     INITIALIZE PC133-LABEL-DTL-REC.                              34570000
338000     SET PC133-LABEL-DTL           TO  TRUE.                      34580000
338100                                                                  34590000
338200*CRTN                                                             34600000
338300         MOVE LBPTDA-SHIPT-UNT-ID      TO  PV-SHIPT-UNT-ID-NUM    34610000
338400         MOVE PV-SHIPT-UNT-14-18       TO  PC256-CARTON-ID        34620000
338500*PO/RCVR                                                          34630000
338600         MOVE LBPTDA-PO-NBR            TO  PV-PO-NUMBER           34640000
338700         MOVE LBPTDA-RCVR-SEQ-NBR      TO  PV-PO-RECEIVER         34650000
338800         MOVE PV-PO-RCVR               TO  PC256-PO-RCVR          34660000
338900         MOVE LBPTDA-PO-LNE-NBR        TO  PC256-LINE-NBR         34670000
339000*DOOR ID                                                          34680000
339100         SET PC256-DOOR-HDG-YES        TO  TRUE                   34690000
339200         IF LBPTDA-DOOR-ID > SPACES                               34700000
339300            MOVE LBPTDA-DOOR-ID        TO PC256-DOOR-NUMBER       34710000
339400         ELSE                                                     34720000
339500            SET PC256-DOOR-NBR-NO      TO  TRUE                   34730000
339600         END-IF                                                   34740000
339700*SKU                                                              34750000
339800         IF LBPTDA-SKU-NBR > ZERO                                 34760000
339900                                                                  34770000
340000             MOVE LBPTDA-SKU-DEPT-NBR  TO PV-SML-DEPT1            34780000
340100             MOVE LBPTDA-SKU-CL-NBR TO PV-SML-CLASS-NBR1          34790000
340200             MOVE LBPTDA-SKU-NBR       TO PV-SML-SKU              34800000
340300             MOVE PV-SML-SKU-NUMBER    TO PC256-SKU               34810000
340400         ELSE                                                     34820000
340500             MOVE SPACES               TO PC256-SKU               34830000
340600         END-IF                                                   34840000
340700*STYLE                                                            34850000
340800         MOVE LBPTDA-VS-NBR            TO PC256-STYLE             34860000
340900* EAS TAG INDICATOR                                               34870000
341000         IF LBPTDA-EAS-TAG-IND  = 'Y'                             34880000
341100            SET PC256-EAS-TAG-YES TO TRUE                         34890000
341200         ELSE                                                     34900000
341300            SET PC256-EAS-TAG-NO  TO TRUE                         34910000
341400         END-IF                                                   34920000
341500*                                                                 34930000
341600*OUTER PK UNTS                                                    34940000
341700*        MOVE LBPTDA-OTPK-UNT-QTY                                 34950000
341800*                                      TO PV-OTPK-QTY             34960000
341900*        MOVE PV-OTPK-UNIT-QTY                                    34970000
342000*                                      TO PC256-OTPK-UNIT         34980000
342100                                                                  34990000
342200         SET  PS-NO-MSG-1                                         35000000
342300              PS-NO-MSG-2              TO TRUE                    35010000
342400         SET  PC256-TEXT-1-NO          TO TRUE                    35020000
342500                                                                  35030000
342600         IF  LBPTDA-SU-MSSG-DAT-IND  =  PC-Y                      35040000
342700             MOVE PC-NOT-FOUND-MSG                                35050000
342800                                       TO PC256-TEXT-1            35060000
342900             SET PS-YES-MSG-1                                     35070000
343000                 PS-YES-MSG-2  TO TRUE                            35080000
343100         ELSE                                                     35090000
343200         IF  LBPTDA-SU-DUP-LBL-IND  =  PC-Y                       35100000
343300             MOVE PC-DUPLICATE-SCAN-MSG                           35110000
343400                                       TO PC256-TEXT-1            35120000
343500             SET PS-YES-MSG-1                                     35130000
343600                 PS-YES-MSG-2  TO TRUE                            35140000
343700         ELSE                                                     35150000
343800         IF  LBPTDA-SU-FRE-ASTRA-IND  =  PC-R                     35160000
343900             MOVE PC-FREE-ASTRY-NO-RCVR-MSG                       35170000
344000                                       TO PC256-TEXT-1            35180000
344100             SET PS-YES-MSG-1                                     35190000
344200                 PS-YES-MSG-2      TO TRUE                        35200000
344300         ELSE                                                     35210000
344400         IF  LBPTDA-SU-FRE-ASTRA-IND  =  PC-T                     35220000
344500             MOVE PC-FREE-ASTRY-NO-TRIP-MSG                       35230000
344600                                       TO PC256-TEXT-1            35240000
344700             SET PS-YES-MSG-1                                     35250000
344800                 PS-YES-MSG-2      TO TRUE                        35260000
344900         END-IF                                                   35270000
345000         END-IF                                                   35280000
345100         END-IF                                                   35290000
345200         END-IF                                                   35300000
345300                                                                  35310000
345400         IF  LBPTDA-SU-FRE-ASTRA-IND  =  PC-Y                     35320000
345500             IF PS-NO-MSG-1                                       35330000
345600                 MOVE PC-FREE-ASTRY-NO-TRIP-MSG                   35340000
345700                                       TO PC256-TEXT-1            35350000
345800                 SET PS-YES-MSG-1  TO TRUE                        35360000
345900             ELSE                                                 35370000
346000             IF PS-NO-MSG-2                                       35380000
346100                 MOVE PC-FREE-ASTRY-NO-TRIP-MSG                   35390000
346200                                       TO PC256-TEXT-1            35400000
346300                 SET PS-YES-MSG-2  TO TRUE                        35410000
346400             END-IF                                               35420000
346500             END-IF                                               35430000
346600         END-IF                                                   35440000
346700                                                                  35450000
346800         IF  LBPTDA-SU-MISDIR-IND  =  PC-Y                        35460000
346900             IF PS-NO-MSG-1                                       35470000
347000                 MOVE PC-MISDIRECT-MSG                            35480000
347100                                       TO PC256-TEXT-1            35490000
347200                 SET PS-YES-MSG-1  TO TRUE                        35500000
347300             ELSE                                                 35510000
347400             IF PS-NO-MSG-2                                       35520000
347500                 MOVE PC-MISDIRECT-MSG                            35530000
347600                                       TO PC256-TEXT-1            35540000
347700                 SET PS-YES-MSG-2  TO TRUE                        35550000
347800             END-IF                                               35560000
347900             END-IF                                               35570000
348000         END-IF                                                   35580000
348100**                                                                35590000
348200        MOVE '@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@'                35600000
348300                                        TO PC256-POG-PROGRAM-NAME 35610000
      *CLP 06/24/15 START                                               35620019
348400        IF LBPTDA-LBL-MSG-TXT-TEXT > SPACES                       35630019
348500           MOVE LBPTDA-LBL-MSG-TXT-TEXT                           35640019
      *CLP 06/24/15 END                                                 35650019
348600                                        TO PC256-POG-PROGRAM-NAME 35660000
348700        ELSE                                                      35670000
348800           MOVE PV-DEPT-MAJ-CLASS-CONCAT                          35680000
348900                                    TO PC256-POG-PROGRAM-NAME     35690000
349000        END-IF                                                    35700000
              MOVE SPACES TO LBPTDA-LBL-MSG-TXT-TEXT                    35710022
349100**                                                                35720000
349200         MOVE LBPTDA-CART-ACTN-CDE TO PC256-AUDIT-IND             35730000
349300         EVALUATE LBPTDA-HNG-FOLD-SEQ-NBR                         35740000
349400            WHEN  PC-1                                            35750000
349500                SET PC256-HANG  TO TRUE                           35760000
349600            WHEN  PC-2                                            35770000
349700                SET PC256-FOLD  TO TRUE                           35780000
349800            WHEN  OTHER                                           35790000
349900                SET PC256-DEFLT-PRESENTATION TO TRUE              35800000
350000         END-EVALUATE                                             35810000
350100                                                                  35820000
350200*                                                                 35830000
350300*BARCODE                                                          35840000
350400                                                                  35850000
350500                                                                  35860000
350600      IF LBPTDA-CART-ACTN-CDE = PC-Q                              35870000
350700         SET PC256-OH-ZERO-MSG-NO                                 35880000
350800             PC256-EAS-TAG-NO                                     35890000
350900             PC256-TEXT-1-NO                                      35900000
351000             PC256-TEXT-2-NO                                      35910000
351100             PC256-TEXT-3-NO                                      35920000
351200             PC256-TEXT-4-NO      TO TRUE                         35930000
351300            MOVE LBPTDA-BRCDE-NBR    TO  PC256-AUDIT-BARCODE      35940000
351400                                         PC256-BARCODE-TEXT       35950000
351500            MOVE SPACES                                           35960000
351600                                     TO  PC256-AUDIT-FILLER       35970000
351700                                         PC256-SML-STR-NBR        35980000
351800            MOVE '@@'                TO PC256-MDSE-GROUP          35990000
351900            SET PC256-DEFLT-PRESENTATION TO TRUE                  36000000
352000                                                                  36010000
352100            IF  LBPTDA-TRIP-ID    >  ZERO                         36020000
352200                SET  PC256-TRIP-HDG   TO TRUE                     36030000
352300                MOVE LBPTDA-TRIP-ID   TO  PC256-SEASET            36040000
352400            ELSE                                                  36050000
352500                SET  PC256-SEASET-HDG-NO         TO TRUE          36060000
352600                SET  PC256-SEASET-NO             TO TRUE          36070000
352700            END-IF                                                36080000
352800                                                                  36090000
352900*PREPACK ORDERS                                                   36100000
353000           IF LBPTDA-PREPK-ID > 0                                 36110000
353100              MOVE LBPTDA-PREPK-ID       TO PC256-LINE-NBR        36120000
353200           ELSE                                                   36130000
353300              MOVE LBPTDA-PO-LNE-NBR     TO PC256-LINE-NBR        36140000
353400           END-IF                                                 36150000
353500           MOVE '@@@@'                TO PC256-OTPK-UNIT          36160000
353600                                                                  36170000
353700*INNER PACK CONVEYABLE                                            36180000
353800           IF LBPTDA-INPK-CNVYB-IND = 'Y'                         36190000
353900              MOVE LBPTDA-INPK-UNT-QTY   TO PV-INPK-QTY           36200000
354000              MOVE PV-INPK-UNIT-QTY      TO PC256-OTPK-UNIT       36210000
354100           END-IF                                                 36220000
354200      ELSE                                                        36230000
354300             MOVE  LBPTDA-BRCDE-NBR       TO  PV-2O-DIGIT-BARCODE 36240000
354400             MOVE  PV-20-SML-CONTAINER-CDE                        36250000
354500               TO  PC160-20-SML-NBR-CONTAINER-CDE                 36260000
354600             MOVE  PV-20-SML-PACKAGING-TYP                        36270000
354700               TO  PC160-20-SML-NBR-PACKAGING-TYP                 36280000
354800             MOVE  PV-20-SML-SOFTWARE-SRC                         36290000
354900               TO  PC160-20-SML-NBR-SOFTWARE-SRC                  36300000
355000             MOVE  PV-20-SML-BC-DIVERT                            36310000
355100               TO  PC160-20-SML-NBR-BC-DIVERT                     36320000
355200             MOVE  PV-20-SML-BC-DC-ORIGIN                         36330000
355300               TO  PC160-20-SML-NBR-BC-DC-ORIGIN                  36340000
355400             MOVE  PV-20-SML-BC-MNFST-NBR                         36350000
355500               TO  PC160-20-SML-NBR-BC-MNFST-NBR                  36360000
355600                                                                  36370000
355700             MOVE PC160-20-DIGIT-BARCODE-NBR TO PC256-BARCODE-TEXT36380000
355800             MOVE LBPTDA-BRCDE-NBR           TO PC256-SML-BARCODE 36390000
355900* SEASONAL SET                                                    36400000
356000         IF  LBPTDA-SEASET-NM  >  SPACES                          36410000
356100             SET  PC256-SEASET-HDG-YES TO TRUE                    36420000
356200             MOVE LBPTDA-SEASET-NM     TO  PC256-SEASET           36430000
356300         ELSE                                                     36440000
356400             SET  PC256-SEASET-HDG-NO  TO TRUE                    36450000
356500             SET  PC256-SEASET-NO      TO TRUE                    36460000
356600         END-IF                                                   36470000
356700*STORE NUMBER                                                     36480000
356800             IF LBPTDA-STR-NM   =  PC-FLAT                        36490000
356900                MOVE   ZEROES              TO  PV-STORE-NBR       36500000
357000                MOVE   PV-STORE-NBR        TO  PC256-SML-STR-NBR  36510000
357100             ELSE                                                 36520000
357200                MOVE LBPTDA-DEST-OPER-UNT-ID TO  PV-STORE-NBR     36530000
357300                MOVE PV-STORE-NBR            TO  PC256-SML-STR-NBR36540000
357400             END-IF                                               36550000
357500                                                                  36560000
357600* MERCHANDISE GROUP                                               36570000
357700             IF  LBPTDA-BUS-AREA-ID > ZEROES                      36580000
357800                 MOVE LBPTDA-BUS-AREA-ID   TO PC256-MDSE-GROUP    36590000
357900             ELSE                                                 36600000
358000                 MOVE '@@'                 TO PC256-MDSE-GROUP    36610000
358100             END-IF                                               36620000
358200                                                                  36630000
358300                                                                  36640000
358400*PREPACK ORDERS                                                   36650000
358500           IF LBPTDA-PREPK-ID > 0                                 36660000
358600              MOVE LBPTDA-PREPK-ID       TO PC256-LINE-NBR        36670000
358700           ELSE                                                   36680000
358800              MOVE LBPTDA-PO-LNE-NBR     TO PC256-LINE-NBR        36690000
358900           END-IF                                                 36700000
359000           MOVE '@@@@'                TO PC256-OTPK-UNIT          36710000
359100                                                                  36720000
359200*INNER PACK CONVEYABLE                                            36730000
359300           IF LBPTDA-INPK-CNVYB-IND = 'Y'                         36740000
359400              MOVE LBPTDA-INPK-UNT-QTY   TO PV-INPK-QTY           36750000
359500              MOVE PV-INPK-UNIT-QTY      TO PC256-OTPK-UNIT       36760000
359600           END-IF                                                 36770000
359700*                                                                 36780000
359800                                                                  36790000
359900           IF XL088-PROCESS-MSG-YES                               36800000
360000              MOVE XL088-PROCESS-MESSAGE-TXT                      36810000
360100                              TO PC256-ON-HAND-ERR-MSG            36820000
360200           ELSE                                                   36830000
360300              SET PC256-OH-ZERO-MSG-NO TO TRUE                    36840000
360400           END-IF                                                 36850000
360500                                                                  36860000
360600*   FIXTURE ID                                                    36870000
360700           IF  LBPTDA-FIXT-ID  >  SPACES                          36880000
360800               SET PC256-FIXTURE-HDG-YES TO TRUE                  36890000
360900               MOVE LBPTDA-FIXT-ID       TO  PC256-FIXTURE        36900000
361000           ELSE                                                   36910000
361100               SET  PC256-FIXTURE-HDG-NO TO TRUE                  36920000
361200               MOVE '@@@@@@@@@@'         TO  PC256-FIXTURE        36930000
361300           END-IF                                                 36940000
361400*                                                                 36950000
361500*                                                                 36960000
361600           IF XL088-PROCESS-MSG-YES AND XL088-FIRST-STORE-RCPT    36970000
361700              MOVE PV-FIRST-STORE-RCPT-TXT-1 TO PC256-TEXT-1      36980000
361800              MOVE PV-FIRST-STORE-RCPT-TXT-2 TO PC256-TEXT-2      36990000
361900              MOVE PV-FIRST-STORE-RCPT-TXT-3 TO PC256-TEXT-3      37000000
362000              SET PC256-TEXT-4-NO            TO TRUE              37010000
362100           ELSE                                                   37020000
362200              SET PC256-TEXT-1-NO                                 37030000
362300                  PC256-TEXT-2-NO                                 37040000
362400                  PC256-TEXT-3-NO                                 37050000
362500                  PC256-TEXT-4-NO            TO TRUE              37060000
362600           END-IF                                                 37070000
362700      END-IF.                                                     37080000
362800*CLP 07/19/2013                                                   37090000
362800***** NO RFID FOR THESE TYPE OF LABELS                            37100000
363000*     IF PS-RF-ID-FOUND-YES OR                                    37110000
      *        LBPTDA-PRC-MSG-CDE = 'RD'                                37120000
363100*        MOVE PV-RFID-STORE-TXT-4 TO PC256-TEXT-4                 37130000
363200*     ELSE                                                        37140000
363300*        SET PC256-TEXT-4-NO      TO TRUE                         37150000
363400*     END-IF                                                      37160000
                                                                        37170000
363300      SET PC256-TEXT-4-NO      TO TRUE.                           37180000
363600                                                                  37190000
363700      MOVE PC-01                    TO PC256-SML-LBL-QTY          37200000
363800                                                                  37210000
363900      MOVE LBPTDA-LBL-TYP-LBL-SEQ-ID                              37220000
364000                                    TO PC256-LABEL-NBR.           37230000
364100      MOVE PC-OF                    TO PC256-LABEL-OF.            37240000
364200      MOVE LBPTDA-LBL-TYP-TOT-QTY   TO PC256-TOT-LABEL.           37250000
364300                                                                  37260000
364400*                                                                 37270000
364500* SEND SML LABEL DATA                                            *37280000
364600*----------------------------------------------------------------*37290000
364700 4562-SEND-SML-DATA.                                              37300000
364800     SET  PC133-LABEL-DTL           TO  TRUE.                     37310000
364900     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       37320000
365000     SET  PC256-IDX-2               TO  PC256-IDX.                37330000
365100     MOVE PC256-DTL-DATA-LNE-LNGTH (PC256-IDX-2)                  37340000
365200                                    TO  PC133-DTL-LENGTH.         37350000
365300     MOVE PC256-SML-LABEL-LINE (PC256-IDX)                        37360000
365400                                    TO  PC133-DTL-DATA.           37370000
365500                                                                  37380000
365600     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    37390000
365700         '' BY SPACES.                                           37400000
365800     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    37410000
365900         ';' BY SPACES.                                           37420000
366000     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    37430000
366100         LOW-VALUES BY SPACES.                                    37440000
366200                                                                  37450000
366300******************************************************************37460000
366400* LENGTH CALCULATION:                                            *37470000
366500*       LINE LENGTH SML DATA     (PC256-DTL-DATA-LNE-LNGTH)      *37480000
366600*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *37490000
366700*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *37500000
366800*              PC133-DTL-LENGTH        (3 POSITIONS)             *37510000
366900*              HEX 03-END EACH DTL REC (1 POSITIONS)             *37520000
367000*              FILLER                  (6 POSITIONS)             *37530000
367100******************************************************************37540000
367200     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        37550000
367300     MOVE PC256-DTL-DATA-LNE-LNGTH (PC256-IDX-2)                  37560000
367400                                  TO PC133-DTL-REC-LENGTH.        37570000
367500     ADD  20                      TO PC133-DTL-REC-LENGTH.        37580000
367600     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                37590000
367700                                     DP081-NBR-BYTES.             37600000
367800                                                                  37610000
367900     PERFORM 5100-SEND-DATA-TO-LPMS.                              37620000
368000                                                                  37630000
368100     ADD  1  TO  PV-TRAILER-COUNT.                                37640000
368200*                                                                 37650000
368300*                                                                 37660000
368400*----------------------------------------------------------------*37670000
368500* BUILD CS LABEL FORM                                            *37680000
368600*----------------------------------------------------------------*37690000
368700 4563-BUILD-CS-FORM.                                              37700000
368800     INITIALIZE PC133-LABEL-DTL-REC.                              37710000
368900     SET  PC133-LABEL-DTL           TO  TRUE.                     37720000
369000                                                                  37730000
369100*    SET PC205-SML-BC-FORM-20                                     37740000
369200*        PC205-SML-BC-FORM-20-END   TO TRUE.                      37750000
369300                                                                  37760000
369400*ODD CRTN                                                         37770000
369500     MOVE PC205-FORM-NO-ODD-BOX                                   37780000
369600                                    TO PC205-ODD-CARTON-BOX       37790000
369700     MOVE PC205-FORM-NO-ODD-FLD                                   37800000
369800                                    TO PC205-ODD-CARTON-FIELD     37810000
369900                                                                  37820000
370000*AUDIT INDICATOR                                                  37830000
370100******** MOVE LBPTDA-CART-ACTN-CDE TO PC205-AUDIT-IND             37840000
370200** GB 8/10/05                                                     37850000
370300     IF LBPTDA-CART-ACTN-CDE > SPACES                             37860000
370400        MOVE LBPTDA-CART-ACTN-CDE TO PC205-AUDIT-IND              37870000
370500     ELSE                                                         37880000
370600        MOVE '@'                  TO PC205-AUDIT-IND              37890000
370700     END-IF                                                       37900000
370800                                                                  37910000
370900*INNER PACK CONVEYABLE                                            37920000
371000     IF  LBPTDA-INPK-CNVYB-IND = 'Y'                              37930000
371100         MOVE PC205-FORM-INPK-BOX       TO PC205-INPK-CONVY-BOX   37940000
371200     ELSE                                                         37950000
371300         MOVE PC205-FORM-NO-INPK-BOX    TO PC205-INPK-CONVY-BOX   37960000
371400     END-IF                                                       37970000
371500                                                                  37980000
371600*REPRINT                                                          37990000
371700     IF  PS-REPRINT-BATCH  OR                                     38000000
371800*LMM     LBPTDA-RPRT-IND  =  PC-R                                 38010000
371900         LBPTDA-RPRT-IND  =  PC-Y                                 38020000
372000         MOVE PC205-FORM-REPRT-BOX      TO  PC205-REPRINT-BOX     38030000
372100         MOVE PC205-FORM-REPRT-FLD      TO  PC205-REPRINT-TEXT    38040000
372200         SET  PS-REPRINT-FORM           TO  TRUE                  38050000
372300     ELSE                                                         38060000
372400         MOVE PC205-FORM-NO-RPRT-BOX    TO  PC205-REPRINT-BOX     38070000
372500         MOVE PC205-FORM-NO-RPRT-FLD    TO  PC205-REPRINT-TEXT    38080000
372600         SET  PS-NOT-REPRINT-FORM       TO  TRUE                  38090000
372700     END-IF.                                                      38100000
372800*CRTN                                                             38110000
372900     MOVE 'CRTN:'                   TO  PC205-CRTN-HDG.           38120000
373000*PRTR                                                             38130000
373100     MOVE '#'                       TO  PV-DISPLAY-NUM.           38140000
373200     MOVE LBPTDA-DC-PRTD-AT-CDE     TO  PV-DISPLAY-DC.            38150000
373300     MOVE '-'                       TO  PV-DISPLAY-DASH.          38160000
373400     MOVE SU001-PRINTER-ID-USE      TO  PV-DISPLAY-PRTR-ID.       38170000
373500     MOVE PV-DISPLAY-PRTR           TO  PC205-SML-PRTR-NBR.       38180000
373600*                                                                 38190000
373700*LABEL COUNT                                                      38200000
373800     MOVE PC205-FORM-OF             TO  PC205-LABEL-CNT.          38210000
373900     MOVE LBPTDA-LBL-TYP-TOT-QTY    TO  PC205-TOT-LBL-CNT.        38220000
374000*                                                                 38230000
374100*DATE                                                             38240000
374200     MOVE PV-CURRENT-DB2-DATE       TO  PV-WORK-DB2-DATE.         38250000
374300     MOVE PV-WORK-YY                TO  PV-LBL-DATE-YY.           38260000
374400     MOVE PV-WORK-MM                TO  PV-LBL-DATE-MM.           38270000
374500     MOVE PV-WORK-DD                TO  PV-LBL-DATE-DD.           38280000
374600     MOVE '-'                       TO  PV-LBL-DASH1              38290000
374700                                        PV-LBL-DASH2.             38300000
374800     MOVE PV-LBL-DATE               TO  PC205-LBL-PRT-DATE.       38310000
374900*TIME                                                             38320000
375000     MOVE PV-CURRENT-TIME           TO  PC205-LBL-PRT-TIME.       38330000
375100*                                                                 38340000
375200*LABEL DESC                                                       38350000
375300*    MOVE PC205-CI-CTL-STK-LBL      TO  PC205-SML-LBL-DESC.       38360000
375400*                                                                 38370000
375500*ZONE                                                             38380000
375600     IF LBPTDA-CART-LBL-TYP-CDE = 'C'                             38390000
375700        MOVE LBPTDA-STR-ZN-ID          TO  PC205-STR-ZN-ID        38400000
375800     ELSE                                                         38410000
375900        MOVE '@@@@@'                   TO  PC205-STR-ZN-ID        38420000
376000     END-IF                                                       38430000
376100*                                                                 38440000
376200*RCVR                                                             38450000
376300     MOVE LBPTDA-PO-NBR             TO  PV-PO-NUMBER.             38460000
376400     MOVE LBPTDA-RCVR-SEQ-NBR       TO  PV-PO-RECEIVER.           38470000
376500     MOVE PV-PO-RCVR                TO  PC205-PO-RCVR-NBR.        38480000
376600*                                                                 38490000
376700*LINE NUMBER                                                      38500000
376800     MOVE LBPTDA-PO-LNE-NBR         TO  PV-LINE-NBR.              38510000
376900     MOVE PV-PO-LINE-NBR            TO  PC205-PO-LNE-NBR.         38520000
377000*                                                                 38530000
377100*SKU                                                              38540000
377200     MOVE LBPTDA-SKU-DEPT-NBR       TO  PV-CS-DEPT.               38550000
377300     MOVE LBPTDA-SKU-CL-NBR         TO  PV-CS-CLASS-NBR.          38560000
377400     MOVE LBPTDA-SKU-NBR            TO  PV-CS-SKU.                38570000
377500     MOVE PV-CS-SKU-NUMBER          TO  PC205-SKU-NBR.            38580000
377600                                                                  38590000
377700*SKU FOR RDM ITEM NUMBER BARCODE                                  38600000
377800     MOVE LBPTDA-SKU-NBR            TO  PV-CS-SKU-ONLY.           38610000
377900     MOVE PV-CS-SKU-NBR             TO  PC205-ITEM-NBR-BC.        38620000
378000     MOVE PV-CS-SKU-NBR             TO  PC205-ITEM-NBR-BC-NBR.    38630000
378100*STYLE                                                            38640000
378200     MOVE LBPTDA-VS-NBR             TO  PC205-STYLE.              38650000
378300*                                                                 38660000
378400*INNER PACK UNITS                                                 38670000
378500     MOVE LBPTDA-INPK-CNVYB-IND                                   38680000
378600                                 TO  PV-PREV-INPK-CNVYB-IND       38690000
378700     IF  LBPTDA-INPK-CNVYB-IND = 'Y'                              38700000
378800         MOVE PC205-FORM-INPK-HDG                                 38710000
378900                                    TO  PC205-INPK-CONVY-TEXT     38720000
379000         MOVE LBPTDA-INPK-UNT-QTY                                 38730000
379100                                    TO  PV-INPK-QTY               38740000
379200         MOVE PV-INPK-UNIT-QTY                                    38750000
379300                                    TO  PC205-PACK-UNT            38760000
379400     ELSE                                                         38770000
379500*OUTER PK UNTS                                                    38780000
379600         MOVE PC205-FORM-OTPK-HDG                                 38790000
379700                                    TO  PC205-INPK-CONVY-TEXT     38800000
379800         MOVE LBPTDA-OTPK-UNT-QTY                                 38810000
379900                                    TO PV-OTPK-QTY                38820000
380000         MOVE PV-OTPK-UNIT-QTY                                    38830000
380100                                    TO PC205-PACK-UNT             38840000
380200     END-IF.                                                      38850000
380300*USER ID                                                          38860000
380400                                                                  38870000
380500     MOVE LBPTDA-CRE-USR-ID         TO  PC205-USER-ID.            38880000
380600                                                                  38890000
380700*reverse image store number                                       38900000
380800                                                                  38910000
380900     MOVE PC205-FORM-NO-REVRSE-STR  TO  PC205-REVERSE-STORE-BOX.  38920000
381000                                                                  38930000
381100*                                                                 38940000
381200*                                                                 38950000
381300*                                                                 38960000
381400*----------------------------------------------------------------*38970000
381500* SEND CS LABEL FORM                                             *38980000
381600*----------------------------------------------------------------*38990000
381700 4564-SEND-CS-FORM.                                               39000000
381800     INITIALIZE PC133-LABEL-DTL-REC.                              39010000
381900     SET  PC133-LABEL-DTL           TO  TRUE.                     39020000
382000                                                                  39030000
382100     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       39040000
382200     SET  PC205-IDX-2               TO  PC205-IDX.                39050000
382300     MOVE PC205-SML-FORM-LINE-LENGTH (PC205-IDX-2)                39060000
382400                                    TO  PC133-DTL-LENGTH.         39070000
382500     MOVE PC205-SHIP-MFST-LBL-LINE (PC205-IDX)                    39080000
382600                                    TO  PC133-DTL-DATA.           39090000
382700                                                                  39100000
382800     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    39110000
382900         '' BY SPACES.                                           39120000
383000     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    39130000
383100         ';' BY SPACES.                                           39140000
383200     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    39150000
383300         LOW-VALUES BY SPACES.                                    39160000
383400                                                                  39170000
383500******************************************************************39180000
383600* LENGTH CALCULATION:                                            *39190000
383700*       LINE LENGTH SML FORM     (PC205-SML-FORM-LINE-LENGTH)    *39200000
383800*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *39210000
383900*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *39220000
384000*              PC133-DTL-LENGTH        (3 POSITIONS)             *39230000
384100*              HEX 03-END EACH DTL REC (1 POSITIONS)             *39240000
384200*              FILLER                  (6 POSITIONS)             *39250000
384300******************************************************************39260000
384400     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        39270000
384500     MOVE PC205-SML-FORM-LINE-LENGTH (PC205-IDX-2)                39280000
384600                                  TO PC133-DTL-REC-LENGTH.        39290000
384700     ADD  20                      TO PC133-DTL-REC-LENGTH.        39300000
384800     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                39310000
384900                                     DP081-NBR-BYTES.             39320000
385000                                                                  39330000
385100     PERFORM 5100-SEND-DATA-TO-LPMS.                              39340000
385200                                                                  39350000
385300     ADD  1  TO  PV-TRAILER-COUNT.                                39360000
385400*                                                                 39370000
385500*                                                                 39380000
385600*----------------------------------------------------------------*39390000
385700*  BUILD CS LABEL DATA                                           *39400000
385800*----------------------------------------------------------------*39410000
385900 4565-BUILD-CS-DATA.                                              39420000
386000         INITIALIZE PC133-LABEL-DTL-REC.                          39430000
386100         SET PC133-LABEL-DTL           TO  TRUE.                  39440000
386200*CRTN                                                             39450000
386300         MOVE LBPTDA-SHIPT-UNT-ID                                 39460000
386400                                       TO  PV-SHIPT-UNT-ID        39470000
386500         MOVE PV-LAST-FIVE-DIGITS                                 39480000
386600                                       TO  PC189-CARTON-NBR       39490000
386700* GB 12/20/01 BEG                                                 39500000
386800*AUDIT INDICATOR                                                  39510000
386900         MOVE LBPTDA-CART-ACTN-CDE TO PC189-AUDIT-IND             39520000
387000* GB 12/20/01 END                                                 39530000
387100                                                                  39540000
387200*STORE NAME & NUMBER                                              39550000
387300         MOVE LBPTDA-STR-NM            TO  PC189-SML-STR-NME      39560000
387400         MOVE LBPTDA-DEST-OPER-UNT-ID  TO  PV-STORE-NBR           39570000
387500         MOVE PV-STORE-NBR             TO  PC189-SML-STR-NBR      39580000
387600* LINE NUMBER                                                     39590000
387700         MOVE LBPTDA-PO-LNE-NBR        TO  PV-LINE-NBR            39600000
387800         MOVE PV-PO-LINE-NBR           TO  PC189-LINE-NUMBER      39610000
387900*NUMBER OF LABELS                                                 39620000
388000         MOVE LBPTDA-LBL-TYP-LBL-SEQ-ID                           39630000
388100                                       TO  PC189-LABEL-NUMBER-N   39640000
388200         MOVE 1                        TO  PC189-SML-TOT-LBLS     39650000
388300*TOTAL NUMBER OF LABELS                                           39660000
388400      MOVE LBPTDA-LBL-TYP-TOT-QTY    TO  PC189-TOT-LBL-CNT.       39670000
388500*RCVR                                                             39680000
388600     MOVE LBPTDA-PO-NBR             TO  PV-PO-NUMBER.             39690000
388700     MOVE LBPTDA-RCVR-SEQ-NBR       TO  PV-PO-RECEIVER.           39700000
388800     MOVE PV-PO-RCVR                TO  PC189-PO-RCVR.            39710000
388900*SKU                                                              39720000
389000     MOVE LBPTDA-SKU-DEPT-NBR       TO  PV-CS-DEPT.               39730000
389100     MOVE LBPTDA-SKU-CL-NBR         TO  PV-CS-CLASS-NBR.          39740000
389200     MOVE LBPTDA-SKU-NBR            TO  PV-CS-SKU.                39750000
389300     MOVE PV-CS-SKU-NUMBER          TO  PC189-DEPT-CL-SKU.        39760000
389400                                                                  39770000
389500*SKU FOR RDM ITEM NUMBER BARCODE                                  39780000
389600     MOVE LBPTDA-SKU-NBR            TO  PV-CS-SKU-ONLY.           39790000
389700     MOVE PV-CS-SKU-NBR             TO  PC189-ITEM-NBR.           39800000
389800     MOVE PV-CS-SKU-NBR             TO  PC189-ITEM-NBR-BC.        39810000
389900*STYLE                                                            39820000
390000     MOVE LBPTDA-VS-NBR             TO  PC189-STYLE.              39830000
390100                                                                  39840000
390200*LABEL TYPE                                                       39850000
390300     IF LBPTDA-CART-LBL-TYP-CDE = 'C'                             39860000
390400        MOVE  PC189-CI-CTL-STK-LBL     TO  PC189-SML-LBL-DESC     39870000
390500        MOVE  PC189-ZONE-HDG-VALUE     TO  PC189-ZONE-STRG-HDG    39880000
390600        MOVE  LBPTDA-STR-ZN-ID         TO  PC189-ZONE-STRG-DESC   39890000
390700     ELSE                                                         39900000
390800     IF LBPTDA-CART-LBL-TYP-CDE = 'E'                             39910000
390900        MOVE  PC189-CI-E-COMM-LBL      TO  PC189-SML-LBL-DESC     39920000
391000        MOVE  PC189-STORAGE-HDG-VALUE  TO  PC189-ZONE-STRG-HDG    39930000
391100        IF    LBPTDA-STRG-AREA-CDE  > SPACES                      39940000
391200              MOVE LBPTDA-STRG-AREA-CDE TO PC189-ZONE-STRG-DESC   39950000
391300        ELSE                                                      39960000
391400              MOVE '@@@@@'  TO PC189-ZONE-STRG-DESC               39970000
391500        END-IF                                                    39980000
391600     END-IF                                                       39990000
391700     END-IF                                                       40000000
391800*BARCODE                                                          40010000
391900         MOVE LBPTDA-BRCDE-NBR         TO  PV-2O-DIGIT-BARCODE    40020000
392000         MOVE SPACES                   TO  PC189-SML-BC           40030000
392100                                                                  40040000
392200         MOVE  PV-20-SML-CONTAINER-CDE                            40050000
392300           TO  PC160-20-SML-CONTAINER-CDE                         40060000
392400               PC160-20-SML-NBR-CONTAINER-CDE                     40070000
392500         MOVE  PV-20-SML-PACKAGING-TYP                            40080000
392600           TO  PC160-20-SML-PACKAGING-TYP                         40090000
392700               PC160-20-SML-NBR-PACKAGING-TYP                     40100000
392800         MOVE  PV-20-SML-SOFTWARE-SRC                             40110000
392900           TO  PC160-20-SML-SOFTWARE-SRC                          40120000
393000               PC160-20-SML-NBR-SOFTWARE-SRC                      40130000
393100         MOVE  PV-20-SML-BC-DIVERT                                40140000
393200           TO  PC160-20-SML-BC-DIVERT                             40150000
393300               PC160-20-SML-NBR-BC-DIVERT                         40160000
393400         MOVE  PV-20-SML-BC-DC-ORIGIN                             40170000
393500           TO  PC160-20-SML-BC-DC-ORIGIN                          40180000
393600               PC160-20-SML-NBR-BC-DC-ORIGIN                      40190000
393700         MOVE  PV-20-SML-BC-MNFST-NBR                             40200000
393800           TO  PC160-20-SML-BC-MNFST-NBR                          40210000
393900               PC160-20-SML-NBR-BC-MNFST-NBR                      40220000
394000         MOVE PC160-20-DIGIT-BARCODE     TO PC189-SML-BC          40230000
394100         MOVE PC160-20-DIGIT-BARCODE-NBR TO PC189-SML-BC-NBR      40240000
394200                                                                  40250000
394300* 29 DIGIT BARCODE & NBR - DATA                                   40260000
394400         MOVE  LBPTDA-PO-NBR           TO PV-BC-PO-NBR-BC         40270000
394500                                          PV-BC-PO-NBR            40280000
394600         MOVE  LBPTDA-ITM-NBR          TO PV-BC-ITEM-NBR-BC       40290000
394700                                          PV-BC-ITEM-NBR          40300000
394800**GB 6/15/01 ADDED MOVE TO OTPK FROM LBPTDA RATHER                40310000
394900** THAN PC205-PACK-UNT(FORM FIELD)                                40320000
395000         MOVE LBPTDA-OTPK-UNT-QTY                                 40330000
395100                                       TO PV-OTPK-QTY             40340000
395200         MOVE PV-OTPK-UNIT-QTY         TO PV-BC-UNITS-BC          40350000
395300                                          PV-BC-UNITS             40360000
395400                                          PC189-PACK-UNT          40370000
395500*GB 6/15/01******                                                 40380000
395600*        MOVE  PC205-PACK-UNT          TO PV-BC-UNITS-BC          40390000
395700*                                         PV-BC-UNITS             40400000
395800*****************                                                 40410000
395900         MOVE  PV-PO-ITM-UNITS-NBR     TO PC189-PO-ITM-UNITS      40420000
396000         MOVE  PV-PO-ITM-UNITS-BC      TO PC189-PO-ITM-UNITS-BC   40430000
396100*                                                                 40440000
396200         SET  PS-NO-MSG-1                                         40450000
396300              PS-NO-MSG-2              TO TRUE                    40460000
396400         MOVE PC-DEFAULT-LABEL-MSG     TO PC189-ERROR-MSG-1       40470000
396500                                                                  40480000
396600         IF  LBPTDA-SU-MSSG-DAT-IND  =  PC-Y                      40490000
396700             MOVE PC-NOT-FOUND-MSG                                40500000
396800                                       TO PC189-ERROR-MSG-1       40510000
396900             SET PS-YES-MSG-1                                     40520000
397000                 PS-YES-MSG-2  TO TRUE                            40530000
397100         ELSE                                                     40540000
397200         IF  LBPTDA-SU-DUP-LBL-IND  =  PC-Y                       40550000
397300             MOVE PC-DUPLICATE-SCAN-MSG                           40560000
397400                                       TO PC189-ERROR-MSG-1       40570000
397500             SET PS-YES-MSG-1                                     40580000
397600                 PS-YES-MSG-2  TO TRUE                            40590000
397700         ELSE                                                     40600000
397800         IF  LBPTDA-SU-FRE-ASTRA-IND  =  PC-R                     40610000
397900             MOVE PC-FREE-ASTRY-NO-RCVR-MSG                       40620000
398000                                       TO PC189-ERROR-MSG-1       40630000
398100             SET PS-YES-MSG-1                                     40640000
398200                 PS-YES-MSG-2      TO TRUE                        40650000
398300         ELSE                                                     40660000
398400         IF  LBPTDA-SU-FRE-ASTRA-IND  =  PC-T                     40670000
398500             MOVE PC-FREE-ASTRY-NO-TRIP-MSG                       40680000
398600                                       TO PC189-ERROR-MSG-1       40690000
398700             SET PS-YES-MSG-1                                     40700000
398800                 PS-YES-MSG-2      TO TRUE                        40710000
398900         END-IF                                                   40720000
399000         END-IF                                                   40730000
399100         END-IF                                                   40740000
399200         END-IF                                                   40750000
399300                                                                  40760000
399400         IF  LBPTDA-SU-FRE-ASTRA-IND  =  PC-Y                     40770000
399500             IF PS-NO-MSG-1                                       40780000
399600                 MOVE PC-FREE-ASTRY-NO-TRIP-MSG                   40790000
399700                                       TO PC189-ERROR-MSG-1       40800000
399800                 SET PS-YES-MSG-1  TO TRUE                        40810000
399900             ELSE                                                 40820000
400000             IF PS-NO-MSG-2                                       40830000
400100                 MOVE PC-FREE-ASTRY-NO-TRIP-MSG                   40840000
400200                                       TO PC189-ERROR-MSG-1       40850000
400300                 SET PS-YES-MSG-2  TO TRUE                        40860000
400400             END-IF                                               40870000
400500             END-IF                                               40880000
400600         END-IF                                                   40890000
400700                                                                  40900000
400800         IF  LBPTDA-SU-MISDIR-IND  =  PC-Y                        40910000
400900             IF PS-NO-MSG-1                                       40920000
401000                 MOVE PC-MISDIRECT-MSG                            40930000
401100                                       TO PC189-ERROR-MSG-1       40940000
401200                 SET PS-YES-MSG-1  TO TRUE                        40950000
401300             ELSE                                                 40960000
401400             IF PS-NO-MSG-2                                       40970000
401500                 MOVE PC-MISDIRECT-MSG                            40980000
401600                                       TO PC189-ERROR-MSG-1       40990000
401700                 SET PS-YES-MSG-2  TO TRUE                        41000000
401800             END-IF                                               41010000
401900             END-IF                                               41020000
402000         END-IF.                                                  41030000
402100*                                                                 41040000
402200*                                                                 41050000
402300*----------------------------------------------------------------*41060000
402400* SEND CS LABEL DATA                                             *41070000
402500*----------------------------------------------------------------*41080000
402600 4566-SEND-CS-DATA.                                               41090000
402700     INITIALIZE PC133-LABEL-DTL-REC.                              41100000
402800     SET  PC133-LABEL-DTL           TO  TRUE.                     41110000
402900                                                                  41120000
403000     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       41130000
403100     SET  PC189-IDX-2               TO  PC189-IDX.                41140000
403200     MOVE PC189-SML-DATA-LINE-LENGTH (PC189-IDX-2)                41150000
403300                                    TO  PC133-DTL-LENGTH.         41160000
403400     MOVE PC189-SML-LABEL-LINE (PC189-IDX)                        41170000
403500                                    TO  PC133-DTL-DATA.           41180000
403600                                                                  41190000
403700     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    41200000
403800         '' BY SPACES.                                           41210000
403900     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    41220000
404000         ';' BY SPACES.                                           41230000
404100     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    41240000
404200         LOW-VALUES BY SPACES.                                    41250000
404300                                                                  41260000
404400******************************************************************41270000
404500* LENGTH CALCULATION:                                            *41280000
404600*       LINE LENGTH SML DATA     (PC189-SML-DATA-LINE-LENGTH)    *41290000
404700*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *41300000
404800*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *41310000
404900*              PC133-DTL-LENGTH        (3 POSITIONS)             *41320000
405000*              HEX 03-END EACH DTL REC (1 POSITIONS)             *41330000
405100*              FILLER                  (6 POSITIONS)             *41340000
405200******************************************************************41350000
405300     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        41360000
405400     MOVE PC189-SML-DATA-LINE-LENGTH (PC189-IDX-2)                41370000
405500                                  TO PC133-DTL-REC-LENGTH.        41380000
405600     ADD  20                      TO PC133-DTL-REC-LENGTH.        41390000
405700     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                41400000
405800                                     DP081-NBR-BYTES.             41410000
405900                                                                  41420000
406000     PERFORM 5100-SEND-DATA-TO-LPMS.                              41430000
406100                                                                  41440000
406200     ADD  1  TO  PV-TRAILER-COUNT.                                41450000
406300*                                                                 41460000
406400*                                                                 41470000
406500*----------------------------------------------------------------*41480000
406600* SEND P2L LABEL DATA - FOR P2L FORM & DATA ARE COMBINED         *41490000
406700*----------------------------------------------------------------*41500000
406800 4567-SEND-P2L-DATA.                                              41510000
406900                                                                  41520000
407000     INITIALIZE PC133-LABEL-DTL-REC.                              41530000
407100     SET  PC133-LABEL-DTL           TO  TRUE.                     41540000
407200                                                                  41550000
407300     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       41560000
407400     SET  PC169-IDX-2               TO  PC169-IDX.                41570000
407500     MOVE PC169-DEST-LBL-LINE-LENGTH (PC169-IDX-2)                41580000
407600                                    TO  PC133-DTL-LENGTH.         41590000
407700     MOVE PC169-P2L-DEST-LBL-LINE (PC169-IDX)                     41600000
407800                                    TO  PC133-DTL-DATA.           41610000
407900                                                                  41620000
408000     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    41630000
408100         '' BY SPACES.                                           41640000
408200     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    41650000
408300         ';' BY SPACES.                                           41660000
408400     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    41670000
408500         LOW-VALUES BY SPACES.                                    41680000
408600                                                                  41690000
408700******************************************************************41700000
408800* LENGTH CALCULATION:                                            *41710000
408900*       LINE LENGTH HEADER LABEL (PC169-DEST-LBL-LINE-LENGTH)    *41720000
409000*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *41730000
409100*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *41740000
409200*              PC133-DTL-LENGTH        (3 POSITIONS)             *41750000
409300*              HEX 03-END EACH DTL REC (1 POSITIONS)             *41760000
409400*              FILLER                  (6 POSITIONS)             *41770000
409500******************************************************************41780000
409600     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        41790000
409700     MOVE PC169-DEST-LBL-LINE-LENGTH (PC169-IDX-2)                41800000
409800                                  TO PC133-DTL-REC-LENGTH.        41810000
409900     ADD  20                      TO PC133-DTL-REC-LENGTH.        41820000
410000     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                41830000
410100                                     DP081-NBR-BYTES.             41840000
410200                                                                  41850000
410300     PERFORM 5100-SEND-DATA-TO-LPMS.                              41860000
410400                                                                  41870000
410500     ADD  1  TO  PV-TRAILER-COUNT.                                41880000
410600*                                                                 41890000
410700*                                                                 41900000
410800*----------------------------------------------------------------*41910000
410900* CLOSE LABEL CURSOR                                             *41920000
411000*----------------------------------------------------------------*41930000
411100 4570-CLOSE-LBL-CURSOR.                                           41940000
411200                                                                  41950000
411300     EXEC SQL                                                     41960000
411400         CLOSE LABEL_CURSOR                                       41970000
411500     END-EXEC.                                                    41980000
411600                                                                  41990000
411700     EVALUATE TRUE                                                42000000
411800         WHEN SQLCODE = +0                                        42010000
411900              CONTINUE                                            42020000
412000         WHEN SQLCODE  NOT =  +0                                  42030000
412100              MOVE '4570-CLOSE-LBL-CURSOR'                        42040000
412200                                  TO DP013-PARAGRAPH              42050000
412300              MOVE 'CLOSE LABEL BATCH CURSOR'                     42060000
412400                                  TO DP013-MESSAGE-TEXT (1)       42070000
412500              MOVE SQLCA          TO DP013-SQLCA                  42080000
412600              MOVE 'TLBPTDA'      TO DP013-DB2-TABLE-NAME (1)     42090000
412700              SET DP013-DB2-ABEND TO TRUE                         42100000
412800*             PERFORM 9999-WRITE-CICS-LOG-MSG                     42110000
412900             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              42120000
413000              PERFORM DP014-0000-PROCESS-ABEND                    42130000
413100     END-EVALUATE.                                                42140000
413200                                                                  42150000
413300                                                                  42160000
413400*----------------------------------------------------------------*42170000
413500* BUILD SML LABEL FORM                                           *42180000
413600*----------------------------------------------------------------*42190000
413700 4575-BUILD-MESSAGE-FORM.                                         42200000
413800     INITIALIZE PC133-LABEL-DTL-REC.                              42210000
413900     SET  PC133-LABEL-DTL           TO  TRUE.                     42220000
414000                                                                  42230000
414100*PREPACK ORDERS                                                   42240000
414200     IF  LBPTDA-PREPK-ID > 0                                      42250000
414300         SET PS-PREPK-FORM              TO TRUE                   42260000
414400         MOVE 'PACK ID:'                TO PC178-LNE-PCK-HDG      42270000
414500         MOVE 'UNITS IN PACK:'          TO PC178-PCK-UNTS-HDG     42280000
414600         MOVE 'PCKS IN OUTR PK:'        TO PC178-PKINOT-UNTS-HDG  42290000
414700         MOVE '0000'                    TO PC178-PCK-UNTS         42300000
414800     ELSE                                                         42310000
414900         SET PS-NOT-PREPK-FORM          TO TRUE                   42320000
415000         MOVE 'LINE NO:'                TO PC178-LNE-PCK-HDG      42330000
415100         MOVE '@@@@@@@@@@@@@@'          TO PC178-PCK-UNTS-HDG     42340000
415200         MOVE '@@@@@@@@@@@@@@@@'        TO PC178-PKINOT-UNTS-HDG  42350000
415300         MOVE '@@@@'                    TO PC178-PCK-UNTS         42360000
415400     END-IF                                                       42370000
415500                                                                  42380000
415600*INNER PACK CONVEYABLE                                            42390000
415700     IF  LBPTDA-INPK-CNVYB-IND = 'Y'                              42400000
415800         MOVE PC178-FORM-INPK-HDG       TO PC178-OUTPK-UNTS-HDG   42410000
415900         MOVE PC178-FORM-INPK-BOX       TO PC178-INPK-CONVY-BOX   42420000
416000     ELSE                                                         42430000
416100         MOVE PC178-FORM-OTPK-HDG       TO PC178-OUTPK-UNTS-HDG   42440000
416200         MOVE PC178-FORM-NO-INPK-BOX    TO PC178-INPK-CONVY-BOX   42450000
416300     END-IF                                                       42460000
416400                                                                  42470000
416500*REPRINT                                                          42480000
416600     IF  PS-REPRINT-BATCH  OR                                     42490000
416700         LBPTDA-RPRT-IND  =  PC-Y                                 42500000
416800         MOVE PC178-FORM-REPRT-BOX      TO  PC178-REPRINT-BOX     42510000
416900         MOVE PC178-FORM-REPRT-FLD      TO  PC178-REPRINT-TEXT    42520000
417000         SET  PS-REPRINT-FORM           TO  TRUE                  42530000
417100     ELSE                                                         42540000
417200         MOVE PC178-FORM-NO-RPRT-BOX    TO  PC178-REPRINT-BOX     42550000
417300         MOVE PC178-FORM-NO-RPRT-FLD    TO  PC178-REPRINT-TEXT    42560000
417400         SET  PS-NOT-REPRINT-FORM       TO  TRUE                  42570000
417500     END-IF.                                                      42580000
417600***                                                               42590000
417700     MOVE LBPTDA-DC-PRTD-AT-CDE     TO  PV-DSPLY-DC.              42600000
417800     MOVE '-'                       TO  PV-DSPLY-DASH.            42610000
417900     MOVE SU001-PRINTER-ID-USE      TO  PV-DSPLY-PRTR-ID.         42620000
418000     MOVE PV-DSPLY-PRTR             TO  PC178-SML-PRTR-NBR.       42630000
418100*                                                                 42640000
418200     MOVE PV-CURRENT-DB2-DATE       TO  PV-WORK-DB2-DATE.         42650000
418300     MOVE PV-WORK-YY                TO  PV-LBL-DATE-YY.           42660000
418400     MOVE PV-WORK-MM                TO  PV-LBL-DATE-MM.           42670000
418500     MOVE PV-WORK-DD                TO  PV-LBL-DATE-DD.           42680000
418600     MOVE '-'                       TO  PV-LBL-DASH1              42690000
418700                                        PV-LBL-DASH2.             42700000
418800     MOVE PV-LBL-DATE               TO  PC178-LBL-PRT-DATE.       42710000
418900*                                                                 42720000
419000     MOVE PV-CURRENT-TIME           TO  PC178-LBL-PRT-TIME.       42730000
419100*                                                                 42740000
419200     MOVE 'CI'                      TO  PC178-FROM-APPLICATION.   42750000
419300     IF  SU001-BATCH-PRINTER                                      42760000
419400         MOVE 'BATCH'               TO  PC178-PRTR-ATTACHED       42770000
419500     ELSE                                                         42780000
419600     IF  SU001-TETHERED-PRINTER                                   42790000
419700         MOVE 'CABLE'               TO  PC178-PRTR-ATTACHED       42800000
419800     ELSE                                                         42810000
419900         MOVE 'OTHER'               TO  PC178-PRTR-ATTACHED       42820000
420000     END-IF                                                       42830000
420100     END-IF.                                                      42840000
420200     MOVe '-SML-'                   TO  PC178-LBL-DESC.           42850000
420300     MOVE PC178-LABEL-INFO-WORK     TO  PC178-LABEL-INFO.         42860000
420400                                                                  42870000
420500     MOVE '@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@'                   42880000
420600                                    TO  PC178-DEPT-NAME           42890000
420700                                        PC178-STR-ON-HAND.        42900000
420800*    IF  LBPTDA-DEPT-DESC > SPACES                                42910000
420900*        MOVE LBPTDA-DEPT-DESC      TO  PC178-DEPT-NAME           42920000
421000*    ELSE                                                         42930000
421100*        MOVE '@@@@@@@@@@@@@@@@@@@@@@@@@'                         42940000
421200*                                   TO  PC178-DEPT-NAME           42950000
421300*    END-IF.                                                      42960000
421400*                                                                 42970000
421500*    IF  LBPTDA-MAJ-CL-DESC > SPACES                              42980000
421600*        MOVE LBPTDA-MAJ-CL-DESC    TO  PC178-MAJOR-CLASS         42990000
421700*    ELSE                                                         43000000
421800*        MOVE '@@@@@@@@@@@@@@@@@@@@@@@@@'                         43010000
421900*                                   TO  PC178-MAJOR-CLASS         43020000
422000*    END-IF.                                                      43030000
422100                                                                  43040000
422200     IF  LBPTDA-FIXT-ID  >  SPACES                                43050000
422300         MOVE LBPTDA-FIXT-ID        TO  PC178-FIXTURE             43060000
422400     ELSE                                                         43070000
422500         MOVE '@@@@@@@@@@'          TO  PC178-FIXTURE             43080000
422600     END-IF.                                                      43090000
422700     IF  LBPTDA-SEASET-NM  >  SPACES                              43100000
422800         MOVE LBPTDA-SEASET-NM            TO  PC178-SET           43110000
422900     ELSE                                                         43120000
423000         MOVE '@@@@@@@@@@@@@@@@@@@@@@@@@' TO  PC178-SET           43130000
423100     END-IF.                                                      43140000
423200     IF  LBPTDA-TRIP-ID    >  ZERO                                43150000
423300         MOVE LBPTDA-TRIP-ID   TO  PC178-TRIP-ID                  43160000
423400     ELSE                                                         43170000
423500         MOVE '@@@@@@@@@'      TO  PC178-TRIP-ID                  43180000
423600     END-IF.                                                      43190000
423700     MOVE LBPTDA-CRE-USR-ID         TO  PC178-USER-ID.            43200000
423800                                                                  43210000
423900     IF  LBPTDA-SU-MSSG-DAT-IND  =  PC-K                          43220000
424000         SET  PC178-STR-LNE-1-YES                                 43230000
424100              PC178-STR-LNE-2-YES                                 43240000
424200              PC178-STR-LNE-3-YES                                 43250000
424300              PC178-STR-LNE-4-YES       TO  TRUE                  43260000
424400         MOVE PC178-FORM-PRT-STORE      TO  PC178-STORE-NBR       43270000
424500     ELSE                                                         43280000
424600         SET  PC178-STR-LNE-1-NO                                  43290000
424700              PC178-STR-LNE-2-NO                                  43300000
424800              PC178-STR-LNE-3-NO                                  43310000
424900              PC178-STR-LNE-4-NO        TO  TRUE                  43320000
425000         MOVE PC178-FORM-NO-STORE       TO  PC178-STORE-NBR       43330000
425100     END-IF.                                                      43340000
425200*                                                                 43350000
425300*                                                                 43360000
425400*----------------------------------------------------------------*43370000
425500* SEND SML LABEL FORM                                            *43380000
425600*----------------------------------------------------------------*43390000
425700 4576-SEND-MESSAGE-FORM.                                          43400000
425800     INITIALIZE PC133-LABEL-DTL-REC.                              43410000
425900     SET  PC133-LABEL-DTL           TO  TRUE.                     43420000
426000                                                                  43430000
426100     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       43440000
426200     SET  PC178-IDX-2               TO  PC178-IDX.                43450000
426300     MOVE PC178-DTL-FORM-LNE-LNGTH (PC178-IDX-2)                  43460000
426400                                    TO  PC133-DTL-LENGTH.         43470000
426500     MOVE PC178-SHIP-MFST-LBL-LINE (PC178-IDX)                    43480000
426600                                    TO  PC133-DTL-DATA.           43490000
426700                                                                  43500000
426800     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    43510000
426900         '' BY SPACES.                                           43520000
427000     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    43530000
427100         ';' BY SPACES.                                           43540000
427200     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    43550000
427300         LOW-VALUES BY SPACES.                                    43560000
427400                                                                  43570000
427500******************************************************************43580000
427600* LENGTH CALCULATION:                                            *43590000
427700*       LINE LENGTH SML FORM     (PC178-DTL-FORM-LNE-LNGTH)      *43600000
427800*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *43610000
427900*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *43620000
428000*              PC133-DTL-LENGTH        (3 POSITIONS)             *43630000
428100*              HEX 03-END EACH DTL REC (1 POSITIONS)             *43640000
428200*              FILLER                  (6 POSITIONS)             *43650000
428300******************************************************************43660000
428400     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        43670000
428500     MOVE PC178-DTL-FORM-LNE-LNGTH (PC178-IDX-2)                  43680000
428600                                  TO PC133-DTL-REC-LENGTH.        43690000
428700     ADD  20                      TO PC133-DTL-REC-LENGTH.        43700000
428800     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                43710000
428900                                     DP081-NBR-BYTES.             43720000
429000                                                                  43730000
429100     PERFORM 5100-SEND-DATA-TO-LPMS.                              43740000
429200                                                                  43750000
429300     ADD  1  TO  PV-TRAILER-COUNT.                                43760000
429400*                                                                 43770000
429500*                                                                 43780000
429600*----------------------------------------------------------------*43790000
429700*  BUILD SML LABEL DATA                                          *43800000
429800*----------------------------------------------------------------*43810000
429900 4577-BUILD-MESSAGE-DATA.                                         43820000
430000         INITIALIZE PC133-LABEL-DTL-REC.                          43830000
430100         SET PC133-LABEL-DTL           TO  TRUE.                  43840000
430200*CRTN                                                             43850000
430300         MOVE LBPTDA-SHIPT-UNT-ID      TO  PC179-CARTON-ID        43860000
430400*PO/RCVR                                                          43870000
430500         MOVE LBPTDA-PO-NBR            TO  PV-PO-NUMBER           43880000
430600         MOVE LBPTDA-RCVR-SEQ-NBR      TO  PV-PO-RECEIVER         43890000
430700         MOVE PV-PO-RCVR               TO  PC179-PO-RCVR          43900000
430800         MOVE LBPTDA-PO-LNE-NBR        TO  PC179-LINE-NBR         43910000
430900*SKU                                                              43920000
431000         IF LBPTDA-SKU-NBR > ZERO                                 43930000
431100                                                                  43940000
431200             MOVE LBPTDA-SKU-DEPT-NBR  TO PV-SML-DEPT1            43950000
431300             MOVE LBPTDA-SKU-CL-NBR TO PV-SML-CLASS-NBR1          43960000
431400             MOVE LBPTDA-SKU-NBR       TO PV-SML-SKU              43970000
431500         ELSE                                                     43980000
431600             MOVE SPACES               TO PC179-SKU               43990000
431700         END-IF                                                   44000000
431800*STYLE                                                            44010000
431900         MOVE LBPTDA-VS-NBR            TO PC179-STYLE             44020000
432000*OUTER PK UNTS                                                    44030000
432100         MOVE LBPTDA-OTPK-UNT-QTY                                 44040000
432200                                       TO PV-OTPK-QTY             44050000
432300         MOVE PV-OTPK-UNIT-QTY                                    44060000
432400                                       TO PC179-OTPK-UNIT         44070000
432500                                                                  44080000
432600         SET  PS-NO-MSG-1                                         44090000
432700              PS-NO-MSG-2                                         44100000
432800              PC179-NO-PRT-SML-STR-NME                            44110000
432900              PC179-NO-PRT-SML-STR-NBR TO TRUE                    44120000
433000         MOVE PC-DEFAULT-LABEL-MSG     TO PC179-ERROR-MSG-1       44130000
433100                                          PC179-ERROR-MSG-2       44140000
433200         EVALUATE TRUE                                            44150000
433300           WHEN LBPTDA-SU-MSSG-DAT-IND  =  PC-Y                   44160000
433400             MOVE PC-NOT-FOUND-MSG                                44170000
433500                                       TO PC179-ERROR-MSG-1       44180000
433600             MOVE PC-DETAIL-CK-NEED-MSG                           44190000
433700                                       TO PC179-ERROR-MSG-2       44200000
433800             SET PS-YES-MSG-1                                     44210000
433900                 PS-YES-MSG-2  TO TRUE                            44220000
434000           WHEN LBPTDA-SU-MSSG-DAT-IND  =  PC-K                   44230000
434100             IF LBPTDA-SU-FRE-ASTRA-IND  = PC-R OR PC-T           44240000
434200                MOVE PC-INACT-PKSK-CRE-NEW-RCVR                   44250000
434300                                       TO PC179-ERROR-MSG-1       44260000
434400             ELSE                                                 44270000
434500                MOVE PC-PKSLIP-CARTON-UNEQUAL                     44280000
434600                                       TO PC179-ERROR-MSG-1       44290000
434700             END-IF                                               44300000
434800             MOVE PC-DETAIL-CK-NEED-MSG                           44310000
434900                                       TO PC179-ERROR-MSG-2       44320000
435000             SET PS-YES-MSG-1                                     44330000
435100                 PS-YES-MSG-2  TO TRUE                            44340000
435200             MOVE LBPTDA-STR-NM            TO  PC179-SML-STR-NME  44350000
435300             MOVE LBPTDA-DEST-OPER-UNT-ID  TO  PV-STORE-NBR       44360000
435400             MOVE PV-STORE-NBR             TO  PC179-SML-STR-NBR  44370000
435500           WHEN LBPTDA-SU-DUP-LBL-IND  =  PC-Y                    44380000
435600             MOVE PC-DUPLICATE-SCAN-MSG                           44390000
435700                                       TO PC179-ERROR-MSG-1       44400000
435800             MOVE PC-DETAIL-CK-NEED-MSG                           44410000
435900                                       TO PC179-ERROR-MSG-2       44420000
436000             SET PS-YES-MSG-1                                     44430000
436100                 PS-YES-MSG-2  TO TRUE                            44440000
436200           WHEN LBPTDA-SU-FRE-ASTRA-IND  =  PC-R                  44450000
436300             MOVE PC-FREE-ASTRY-NO-RCVR-MSG                       44460000
436400                                       TO PC179-ERROR-MSG-1       44470000
436500             MOVE PC-DEFAULT-LABEL-MSG                            44480000
436600                                       TO PC179-ERROR-MSG-2       44490000
436700             SET PS-YES-MSG-1                                     44500000
436800                 PS-YES-MSG-2      TO TRUE                        44510000
436900           WHEN LBPTDA-SU-FRE-ASTRA-IND  =  PC-T                  44520000
437000             MOVE PC-FREE-ASTRY-NO-TRIP-MSG                       44530000
437100                                       TO PC179-ERROR-MSG-1       44540000
437200             MOVE PC-DEFAULT-LABEL-MSG                            44550000
437300                                       TO PC179-ERROR-MSG-2       44560000
437400             SET PS-YES-MSG-1                                     44570000
437500                 PS-YES-MSG-2      TO TRUE                        44580000
437600           WHEN LBPTDA-SU-FRE-ASTRA-IND  =  PC-A                  44590000
437700             MOVE PC-HOLD-CRTN-TRIP-END                           44600000
437800                                       TO PC179-ERROR-MSG-1       44610000
437900             MOVE PC-FREE-ASTY-NEED-TRANS                         44620000
438000                                       TO PC179-ERROR-MSG-2       44630000
438100             SET PS-YES-MSG-1                                     44640000
438200                 PS-YES-MSG-2      TO TRUE                        44650000
438300           WHEN LBPTDA-SU-FRE-ASTRA-IND  =  PC-C                  44660000
438400             MOVE PC-TRANSC-CHECK-IN-RCVR                         44670000
438500                                       TO PC179-ERROR-MSG-1       44680000
438600             MOVE PC-FREE-ASTY-NEED-TRANS                         44690000
438700                                       TO PC179-ERROR-MSG-2       44700000
438800             SET PS-YES-MSG-1                                     44710000
438900                 PS-YES-MSG-2      TO TRUE                        44720000
439000           WHEN LBPTDA-SU-FRE-ASTRA-IND  =  PC-D                  44730000
439100             MOVE PC-UNUSABLE-128-NO-PKSLIP                       44740000
439200                                       TO PC179-ERROR-MSG-1       44750000
439300             MOVE PC-DEFAULT-LABEL-MSG                            44760000
439400                                       TO PC179-ERROR-MSG-2       44770000
439500             SET PS-YES-MSG-1                                     44780000
439600                 PS-YES-MSG-2      TO TRUE                        44790000
439700         END-EVALUATE                                             44800000
439800                                                                  44810000
439900         IF  LBPTDA-SU-FRE-ASTRA-IND  =  PC-Y                     44820000
440000             IF PS-NO-MSG-1                                       44830000
440100                 MOVE PC-FREE-ASTRY-NO-TRIP-MSG                   44840000
440200                                       TO PC179-ERROR-MSG-1       44850000
440300                 SET PS-YES-MSG-1  TO TRUE                        44860000
440400             ELSE                                                 44870000
440500             IF PS-NO-MSG-2                                       44880000
440600                 MOVE PC-FREE-ASTRY-NO-TRIP-MSG                   44890000
440700                                       TO PC179-ERROR-MSG-1       44900000
440800                 SET PS-YES-MSG-2  TO TRUE                        44910000
440900             END-IF                                               44920000
441000             END-IF                                               44930000
441100         END-IF                                                   44940000
441200                                                                  44950000
441300         IF  LBPTDA-SU-MISDIR-IND  =  PC-Y                        44960000
441400             IF PS-NO-MSG-1                                       44970000
441500                 MOVE PC-MISDIRECT-MSG                            44980000
441600                                       TO PC179-ERROR-MSG-1       44990000
441700                 SET PS-YES-MSG-1  TO TRUE                        45000000
441800             ELSE                                                 45010000
441900             IF PS-NO-MSG-2                                       45020000
442000                 MOVE PC-MISDIRECT-MSG                            45030000
442100                                       TO PC179-ERROR-MSG-1       45040000
442200                 SET PS-YES-MSG-2  TO TRUE                        45050000
442300             END-IF                                               45060000
442400             END-IF                                               45070000
442500         END-IF                                                   45080000
442600         EVALUATE TRUE                                            45090000
442700           WHEN  LBPTDA-SU-MSSG-DAT-IND  =  PC-G                  45100000
442800           WHEN  LBPTDA-SU-MSSG-DAT-IND  =  PC-L                  45110000
442900             MOVE PC-CASEPK-NOT-DNLD-RECVR                        45120000
443000                                       TO PC179-ERROR-MSG-2       45130000
443100             SET PS-YES-MSG-2  TO TRUE                            45140000
443200           WHEN  LBPTDA-SU-MSSG-DAT-IND  =  PC-I                  45150000
443300           WHEN  LBPTDA-SU-MSSG-DAT-IND  =  PC-N                  45160000
443400               MOVE PC-CASEPK-DNLD-PHYSCL                         45170000
443500                                         TO PC179-ERROR-MSG-2     45180000
443600               SET PS-YES-MSG-2  TO TRUE                          45190000
443700         END-EVALUATE                                             45200000
443800                                                                  45210000
443900         MOVE LBPTDA-BRCDE-NBR      TO PC179-IINFO-MSG            45220000
444000                                                                  45230000
444100         MOVE PC-01                    TO PC179-SML-LBL-QTY       45240000
444200                                                                  45250000
444300*PREPACK ORDERS                                                   45260000
444400         IF LBPTDA-ODD-CART-IND  = 'Y'                            45270000
444500            MOVE 0                     TO PC179-LINE-NBR          45280000
444600                                          PV-PREPK-QTY            45290000
444700                                          PC179-PACK-UNITS        45300000
444800                                          PC179-OTPK-PACKS        45310000
444900         ELSE                                                     45320000
445000         IF LBPTDA-PREPK-ID > 0                                   45330000
445100            MOVE LBPTDA-PREPK-ID       TO PC179-LINE-NBR          45340000
445200            MOVE LBPTDA-PREPK-UNT-QTY  TO PV-PREPK-QTY            45350000
445300            MOVE PV-PREPK-UNIT-QTY     TO PC179-PACK-UNITS        45360000
445400            MOVE LBPTDA-PREPK-RATO-QTY TO PC179-OTPK-PACKS        45370000
445500*GB 3/21/01*******************************************************45380000
445600*gb 12/8    DIVIDE LBPTDA-OTPK-UNT-QTY BY                         45390000
445700*gb 12/8                  LBPTDA-PREPK-UNT-QTY                    45400000
445800*gb 12/8                  GIVING   PV-PACKS-IN-CARTON             45410000
445900*gb 12/8    MOVE PV-PACKS-IN-CARTON-X                             45420000
446000*gb 12/8                            TO PC179-OTPK-PACKS           45430000
446100*GB END **********************************************************45440000
446200         ELSE                                                     45450000
446300            MOVE LBPTDA-PO-LNE-NBR     TO PC179-LINE-NBR          45460000
446400         END-IF                                                   45470000
446500         END-IF.                                                  45480000
446600*INNER PACK CONVEYABLE                                            45490000
446700         IF LBPTDA-INPK-CNVYB-IND = 'Y'                           45500000
446800            MOVE LBPTDA-INPK-UNT-QTY   TO PV-INPK-QTY             45510000
446900            MOVE PV-INPK-UNIT-QTY      TO PC179-OTPK-UNIT         45520000
447000         ELSE                                                     45530000
447100            MOVE LBPTDA-OTPK-UNT-QTY   TO PV-OTPK-QTY             45540000
447200            MOVE PV-OTPK-UNIT-QTY      TO PC179-OTPK-UNIT         45550000
447300         END-IF.                                                  45560000
447400*                                                                 45570000
447500         MOVE LBPTDA-LBL-TYP-LBL-SEQ-ID                           45580000
447600                                       TO PC179-LABEL-NBR.        45590000
447700         MOVE PC-OF                    TO PC179-LABEL-OF.         45600000
447800         MOVE LBPTDA-LBL-TYP-TOT-QTY   TO PC179-TOT-LABEL.        45610000
447900                                                                  45620000
448000* DEPARTMENT NAME (INSIDE OF BOX)                                 45630000
448100         MOVE PV-DEPT-MAJ-CLASS-CONCAT TO PC179-DEPT-CLASS-DESC.  45640000
448200         SET  PC179-OH-ZERO-MSG-NO     TO TRUE                    45650000
448300*        IF  LBPTDA-DEPT-DESC  >  SPACES                          45660000
448400*            MOVE LBPTDA-DEPT-DESC     TO  PC179-DEPT-DESC        45670000
448500*        ELSE                                                     45680000
448600*            MOVE '@@@@@@@@@@@@@@@@@@@@@@@@@'                     45690000
448700*                                      TO  PC179-DEPT-DESC        45700000
448800*        END-IF.                                                  45710000
448900* MAJOR CLASS (INSIDE OF BOX)                                     45720000
449000*        IF  LBPTDA-MAJ-CL-DESC  >  SPACES                        45730000
449100*            MOVE LBPTDA-MAJ-CL-DESC   TO  PC179-MAJOR-CLASS      45740000
449200*        ELSE                                                     45750000
449300*            MOVE '@@@@@@@@@@@@@@@@@@@@@@@@@'                     45760000
449400*                                      TO  PC179-MAJOR-CLASS      45770000
449500*        END-IF.                                                  45780000
449600* FIXTURE ID                                                      45790000
449700         IF  LBPTDA-FIXT-ID  >  SPACES                            45800000
449800             MOVE LBPTDA-FIXT-ID       TO  PC179-FIXTURE          45810000
449900         ELSE                                                     45820000
450000             MOVE '@@@@@@@@@@'         TO  PC179-FIXTURE          45830000
450100         END-IF.                                                  45840000
450200* SEASONAL SET                                                    45850000
450300         IF  LBPTDA-SEASET-NM  >  SPACES                          45860000
450400             MOVE LBPTDA-SEASET-NM     TO  PC179-SEASET           45870000
450500         ELSE                                                     45880000
450600             MOVE '@@@@@@@@@@@@@@@@@@@@@@@@@'                     45890000
450700                                       TO  PC179-SEASET           45900000
450800         END-IF.                                                  45910000
450900*  TRIP ID                                                        45920000
451000     IF  LBPTDA-TRIP-ID    >  ZERO                                45930000
451100         MOVE LBPTDA-TRIP-ID   TO  PC179-TRIP-ID                  45940000
451200     ELSE                                                         45950000
451300         MOVE '@@@@@@@@@'      TO  PC179-TRIP-ID                  45960000
451400     END-IF.                                                      45970000
451500                                                                  45980000
451600*                                                                 45990000
451700*----------------------------------------------------------------*46000000
451800* SEND SML LABEL DATA                                            *46010000
451900*----------------------------------------------------------------*46020000
452000 4578-SEND-MESSAGE-DATA.                                          46030000
452100     SET  PC133-LABEL-DTL           TO  TRUE.                     46040000
452200     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       46050000
452300     SET  PC179-IDX-2               TO  PC179-IDX.                46060000
452400     MOVE PC179-DTL-DATA-LNE-LNGTH (PC179-IDX-2)                  46070000
452500                                    TO  PC133-DTL-LENGTH.         46080000
452600     MOVE PC179-SML-LABEL-LINE (PC179-IDX)                        46090000
452700                                    TO  PC133-DTL-DATA.           46100000
452800                                                                  46110000
452900     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    46120000
453000         '' BY SPACES.                                           46130000
453100     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    46140000
453200         ';' BY SPACES.                                           46150000
453300     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    46160000
453400         LOW-VALUES BY SPACES.                                    46170000
453500                                                                  46180000
453600******************************************************************46190000
453700* LENGTH CALCULATION:                                            *46200000
453800*       LINE LENGTH SML DATA     (PC179-DTL-DATA-LNE-LNGTH)      *46210000
453900*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *46220000
454000*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *46230000
454100*              PC133-DTL-LENGTH        (3 POSITIONS)             *46240000
454200*              HEX 03-END EACH DTL REC (1 POSITIONS)             *46250000
454300*              FILLER                  (6 POSITIONS)             *46260000
454400******************************************************************46270000
454500     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        46280000
454600     MOVE PC179-DTL-DATA-LNE-LNGTH (PC179-IDX-2)                  46290000
454700                                  TO PC133-DTL-REC-LENGTH.        46300000
454800     ADD  20                      TO PC133-DTL-REC-LENGTH.        46310000
454900     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                46320000
455000                                     DP081-NBR-BYTES.             46330000
455100                                                                  46340000
455200     PERFORM 5100-SEND-DATA-TO-LPMS.                              46350000
455300                                                                  46360000
455400     ADD  1  TO  PV-TRAILER-COUNT.                                46370000
455500*                                                                 46380000
455600*                                                                 46390000
455700*----------------------------------------------------------------*46400000
455800* SEND TRAILER LABEL                                             *46410000
455900*----------------------------------------------------------------*46420000
456000 4590-TLR-LABEL.                                                  46430000
456100                                                                  46440000
456200     INITIALIZE PC133-LABEL-DTL-REC.                              46450000
456300     SET  PC133-LABEL-DTL           TO  TRUE.                     46460000
456400                                                                  46470000
456500     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       46480000
456600     SET  PC137-IDX-2               TO  PC137-IDX.                46490000
456700     MOVE PC137-TLR-LINE-LENGTH (PC137-IDX-2)                     46500000
456800                                    TO  PC133-DTL-LENGTH.         46510000
456900     MOVE PC137-SML-TRAILER-LABEL-LINE (PC137-IDX)                46520000
457000                                    TO  PC133-DTL-DATA.           46530000
457100                                                                  46540000
457200     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    46550000
457300         '' BY SPACES.                                           46560000
457400     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    46570000
457500         ';' BY SPACES.                                           46580000
457600     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    46590000
457700         LOW-VALUES BY SPACES.                                    46600000
457800                                                                  46610000
457900******************************************************************46620000
458000* LENGTH CALCULATION:                                            *46630000
458100*       LINE LENGTH TRAILER LBL  (PC137-TLR-LINE-LENGTH)         *46640000
458200*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *46650000
458300*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *46660000
458400*              PC133-DTL-LENGTH        (3 POSITIONS)             *46670000
458500*              HEX 03-END EACH DTL REC (1 POSITIONS)             *46680000
458600*              FILLER                  (6 POSITIONS)             *46690000
458700******************************************************************46700000
458800     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        46710000
458900     MOVE PC137-TLR-LINE-LENGTH (PC137-IDX-2)                     46720000
459000                                  TO PC133-DTL-REC-LENGTH.        46730000
459100     ADD  20                      TO PC133-DTL-REC-LENGTH.        46740000
459200     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                46750000
459300                                     DP081-NBR-BYTES.             46760000
459400                                                                  46770000
459500     PERFORM 5100-SEND-DATA-TO-LPMS.                              46780000
459600                                                                  46790000
459700     ADD  1  TO  PV-TRAILER-COUNT.                                46800000
459800                                                                  46810000
459900                                                                  46820000
460000*----------------------------------------------------------------*46830000
460100*                                                                *46840000
460200*----------------------------------------------------------------*46850000
460300 4600-BLD-TLR-REC.                                                46860000
460400                                                                  46870000
460500     INITIALIZE PC133-LABEL-TLR-REC.                              46880000
460600     SET  PC133-LABEL-TLR           TO  TRUE.                     46890000
460700                                                                  46900000
460800     MOVE PV-LPMS-TRANS-ID          TO  PC133-TLR-TRANS-ID.       46910000
460900     MOVE PV-TRAILER-COUNT          TO  PC133-TLR-RECORD-COUNT.   46920000
461000                                                                  46930000
461100     INSPECT PC133-LABEL-TLR-REC REPLACING ALL                    46940000
461200         '' BY SPACES.                                           46950000
461300     INSPECT PC133-LABEL-TLR-REC REPLACING ALL                    46960000
461400         ';' BY SPACES.                                           46970000
461500     INSPECT PC133-LABEL-TLR-REC REPLACING ALL                    46980000
461600         LOW-VALUES BY SPACES.                                    46990000
461700                                                                  47000000
461800     MOVE PC133-TLR-REC-LENGTH    TO DP081-TCPLENG                47010000
461900                                     DP081-NBR-BYTES.             47020000
462000                                                                  47030000
462100     PERFORM 5100-SEND-DATA-TO-LPMS.                              47040000
462200                                                                  47050000
462300                                                                  47060000
462400*----------------------------------------------------------------*47070000
462500* GENERATE LABEL HISTORY INFORMATION                             *47080000
462600*----------------------------------------------------------------*47090000
462700 4700-LABEL-HISTORY.                                              47100000
462800                                                                  47110000
462900     INITIALIZE  DCLTLBTKHS                                       47120000
463000                 DCLTLBTKID.                                      47130000
463100                                                                  47140000
463200     MOVE  PV-LPMS-TRANS-ID         TO LBTKHS-LBL-REQ-TRN-ID.     47150000
463300     MOVE  PC-CHECK-IN-LBL-APPL     TO LBTKHS-LBL-TYP-CDE.        47160000
463400     MOVE  SU001-USER-ID            TO LBTKHS-CRED-BY-USR-ID.     47170000
463500     MOVE  PC-CURRENT-PROGRAM-NAME  TO LBTKHS-REQ-PGM-NM.         47180000
463600     MOVE  ZEROES                   TO LBTKHS-LOC-ID.             47190000
463700     MOVE  PV-DB2-LABEL-COUNT       TO LBTKHS-LBL-PRT-QTY.        47200000
463800     ADD   2                        TO LBTKHS-LBL-PRT-QTY.        47210000
463900     MOVE  SU001-PRINTER-ID-USE     TO LBTKHS-PRTR-ID.            47220000
464000     MOVE  SU001-CURR-OPER-UNT-ID   TO LBTKHS-PRTR-OPER-UNT-ID.   47230000
464100     MOVE  SU001-FCLTY-ID           TO LBTKHS-PRTR-FCLTY-ID.      47240000
464200     MOVE  PC-SOCKET-INTERFACE      TO LBTKHS-XMIT-INTFC-CDE.     47250000
464300     MOVE  PC-A                     TO LBTKHS-XMIT-STAT-CDE.      47260000
464400     MOVE  ZERO                     TO LBTKHS-USR-LBL-ID-LEN.     47270000
464500                                                                  47280000
464600     PERFORM 4710-INSERT-TLBTKHS.                                 47290000
464700                                                                  47300000
464800     MOVE  PV-LPMS-TRANS-ID         TO LBTKID-LBL-REQ-TRN-ID.     47310000
464900     MOVE  PC-CHECK-IN-LBL-APPL     TO LBTKID-LBL-TYP-CDE.        47320000
465000     MOVE  ZEROES                   TO LBTKID-PO-NBR.             47330000
465100     MOVE  ZEROES                   TO LBTKID-RCVR-SEQ-NBR.       47340000
465200     MOVE  ZEROES                   TO LBTKID-PO-LNE-NBR.         47350000
465300     MOVE  SU001-MANIFEST           TO LBTKID-TRIP-ID.            47360000
465400     MOVE  SU001-BATCH-NO-USE       TO LBTKID-LBL-PRT-BTCH-ID.    47370000
465500     MOVE  PV-DB2-LABEL-COUNT       TO LBTKID-LBL-PRT-QTY.        47380000
465600     MOVE  2                        TO LBTKID-SEPOR-LBL-PRT-QTY.  47390000
465700                                                                  47400000
465800     PERFORM 4720-INSERT-LBTKID.                                  47410000
465900                                                                  47420000
466000     PERFORM 9100-SYNCPOINT.                                      47430000
466100                                                                  47440000
466200*----------------------------------------------------------------*47450000
466300* INSERT INTO TLBTKHS - LABEL HISTORY                            *47460000
466400*----------------------------------------------------------------*47470000
466500 4710-INSERT-TLBTKHS.                                             47480000
466600                                                                  47490000
466700     EXEC SQL                                                     47500000
466800         INSERT INTO TLBTKHS                                      47510000
466900               (LBL_REQ_TRN_ID,                                   47520000
467000                LBL_TYP_CDE,                                      47530000
467100                CRE_TMST,                                         47540000
467200                CRED_BY_USR_ID,                                   47550000
467300                REQ_PGM_NM,                                       47560000
467400                LOC_ID,                                           47570000
467500                LBL_PRT_QTY,                                      47580000
467600                PRTR_ID,                                          47590000
467700                PRTR_OPER_UNT_ID,                                 47600000
467800                PRTR_FCLTY_ID,                                    47610000
467900                XMIT_INTFC_CDE,                                   47620000
468000                XMIT_STAT_CDE,                                    47630000
468100                USR_LBL_ID)                                       47640000
468200         VALUES                                                   47650000
468300               (:LBTKHS-LBL-REQ-TRN-ID,                           47660000
468400                :LBTKHS-LBL-TYP-CDE,                              47670000
468500                CURRENT TIMESTAMP,                                47680000
468600                :LBTKHS-CRED-BY-USR-ID,                           47690000
468700                :LBTKHS-REQ-PGM-NM,                               47700000
468800                :LBTKHS-LOC-ID,                                   47710000
468900                :LBTKHS-LBL-PRT-QTY,                              47720000
469000                :LBTKHS-PRTR-ID,                                  47730000
469100                :LBTKHS-PRTR-OPER-UNT-ID,                         47740000
469200                :LBTKHS-PRTR-FCLTY-ID,                            47750000
469300                :LBTKHS-XMIT-INTFC-CDE,                           47760000
469400                :LBTKHS-XMIT-STAT-CDE,                            47770000
469500                :LBTKHS-USR-LBL-ID)                               47780000
469600     END-EXEC.                                                    47790000
469700                                                                  47800000
469800     EVALUATE TRUE                                                47810000
469900         WHEN SQLCODE = ZERO                                      47820000
470000             CONTINUE                                             47830000
470100         WHEN SQLWARN0 NOT = SPACES                               47840000
470200         WHEN SQLCODE NOT EQUAL ZERO                              47850000
470300             MOVE '4710-INSERT-TLBTKHS'                           47860000
470400                             TO DP013-PARAGRAPH                   47870000
470500             MOVE 'SUKRF707 - INSERT LABEL HISTORY'               47880000
470600                             TO DP013-MESSAGE-TEXT(1)             47890000
470700             MOVE SU001-MANIFEST                                  47900000
470800                             TO DP013-MESSAGE-TEXT(2)             47910000
470900             MOVE SQLCA      TO DP013-SQLCA                       47920000
471000             MOVE 'TLBTKHS'  TO DP013-DB2-TABLE-NAME(1)           47930000
471100             SET DP013-DB2-ABEND              TO TRUE             47940000
471200*            PERFORM 9999-WRITE-CICS-LOG-MSG                      47950000
471300             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              47960000
471400             PERFORM DP014-0000-PROCESS-ABEND                     47970000
471500     END-EVALUATE.                                                47980000
471600                                                                  47990000
471700                                                                  48000000
471800*----------------------------------------------------------------*48010000
471900* INSERT INTO TLBTKID - LABEL IDENTIFICATION                     *48020000
472000*----------------------------------------------------------------*48030000
472100 4720-INSERT-LBTKID.                                              48040000
472200                                                                  48050000
472300     EXEC SQL                                                     48060000
472400         INSERT INTO TLBTKID                                      48070000
472500               (LBL_REQ_TRN_ID,                                   48080000
472600                LBL_TYP_CDE,                                      48090000
472700                PO_NBR,                                           48100000
472800                RCVR_SEQ_NBR,                                     48110000
472900                PO_LNE_NBR,                                       48120000
473000                TRIP_ID,                                          48130000
473100                LBL_PRT_BTCH_ID,                                  48140000
473200                LBL_PRT_QTY,                                      48150000
473300                SEPOR_LBL_PRT_QTY)                                48160000
473400         VALUES                                                   48170000
473500               (:LBTKID-LBL-REQ-TRN-ID,                           48180000
473600                :LBTKID-LBL-TYP-CDE,                              48190000
473700                :LBTKID-PO-NBR,                                   48200000
473800                :LBTKID-RCVR-SEQ-NBR,                             48210000
473900                :LBTKID-PO-LNE-NBR,                               48220000
474000                :LBTKID-TRIP-ID,                                  48230000
474100                :LBTKID-LBL-PRT-BTCH-ID,                          48240000
474200                :LBTKID-LBL-PRT-QTY,                              48250000
474300                :LBTKID-SEPOR-LBL-PRT-QTY)                        48260000
474400     END-EXEC.                                                    48270000
474500                                                                  48280000
474600     EVALUATE TRUE                                                48290000
474700         WHEN SQLCODE = ZERO                                      48300000
474800             CONTINUE                                             48310000
474900         WHEN SQLWARN0 NOT = SPACES                               48320000
475000         WHEN SQLCODE NOT EQUAL ZERO                              48330000
475100             MOVE '4720-INSERT-LBTKIDS'                           48340000
475200                             TO DP013-PARAGRAPH                   48350000
475300             MOVE 'SUKRF707 - INSERT LABEL IDENTIFICATION'        48360000
475400                             TO DP013-MESSAGE-TEXT(1)             48370000
475500             MOVE SU001-MANIFEST                                  48380000
475600                             TO DP013-MESSAGE-TEXT(2)             48390000
475700             MOVE SQLCA      TO DP013-SQLCA                       48400000
475800             MOVE 'TLBTKHS'  TO DP013-DB2-TABLE-NAME(1)           48410000
475900             SET DP013-DB2-ABEND              TO TRUE             48420000
476000*            PERFORM 9999-WRITE-CICS-LOG-MSG                      48430000
476100             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              48440000
476200             PERFORM DP014-0000-PROCESS-ABEND                     48450000
476300     END-EVALUATE.                                                48460000
476400                                                                  48470000
476500                                                                  48480000
476600*----------------------------------------------------------------*48490000
476700* UPDATE TLBTKHS - LABEL HISTORY WITH RETURN ERROR               *48500000
476800*----------------------------------------------------------------*48510000
476900 4730-UPDATE-TLBTKHS.                                             48520000
477000                                                                  48530000
477100     MOVE PV-LPMS-TRANS-ID  TO  DK-LPMS-TRANS-ID.                 48540000
477200                                                                  48550000
477300     EXEC SQL                                                     48560000
477400         UPDATE TLBTKHS                                           48570000
477500         SET                                                      48580000
477600             XMIT_STAT_CDE  =  :PV-LPMS-XMIT-RETURN               48590000
477700          WHERE                                                   48600000
477800             LBL_REQ_TRN_ID  = :DK-LPMS-TRANS-ID                  48610000
477900     END-EXEC.                                                    48620000
478000                                                                  48630000
478100     EVALUATE TRUE                                                48640000
478200         WHEN SQLCODE = ZERO                                      48650000
478300              CONTINUE                                            48660000
478400                                                                  48670000
478500         WHEN OTHER                                               48680000
478600             MOVE   DK-LPMS-TRANS-ID   TO PV-DISPLAY-LPMS-TRAN    48690000
478700              STRING ' SUKRF707 - '            DELIMITED BY SIZE  48700000
478800                     'DK-LPMS-TRANS-ID: '      DELIMITED BY SIZE  48710000
478900                     PV-DISPLAY-LPMS-TRAN      DELIMITED BY SIZE  48720000
479000                     '  PV-LPMS-XMIT-RETURN: ' DELIMITED BY SIZE  48730000
479100                     PV-LPMS-XMIT-RETURN       DELIMITED BY SIZE  48740000
479200                                           INTO PV-CICS-MSG-AREA  48750000
479300              MOVE LENGTH OF PV-CICS-MSG-AREA                     48760000
479400                     TO PV-COMMAREA-LENGTH                        48770000
479500              PERFORM 9990-WRITE-CICS                             48780000
479600                                                                  48790000
479700             MOVE '4730-UPDATE-TLBTKHS'                           48800000
479800                             TO DP013-PARAGRAPH                   48810000
479900             MOVE 'SUKRF707 - UPDATE LPMS HISTORY RETURN'         48820000
480000                             TO DP013-MESSAGE-TEXT(1)             48830000
480100             MOVE PV-LPMS-TRANS-ID                                48840000
480200                             TO DP013-MESSAGE-TEXT(2)             48850000
480300             MOVE SQLCA      TO DP013-SQLCA                       48860000
480400             MOVE 'TLBTKHS'  TO DP013-DB2-TABLE-NAME(1)           48870000
480500             SET DP013-DB2-ABEND              TO TRUE             48880000
480600*            PERFORM 9999-WRITE-CICS-LOG-MSG                      48890000
480700             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              48900000
480800             PERFORM DP014-0000-PROCESS-ABEND                     48910000
480900     END-EVALUATE.                                                48920000
481000                                                                  48930000
481100                                                                  48940000
481200*----------------------------------------------------------------*48950000
481300*  GET LPMS RETURN CODE                                          *48960000
481400*----------------------------------------------------------------*48970000
481500 4740-GET-LPMS-RETURN.                                            48980000
481600                                                                  48990000
481700     SEARCH ALL PC138-SOCKET-ERRORS                               49000000
481800            AT END                                                49010000
481900                MOVE 'Z' TO  PV-LPMS-XMIT-RETURN                  49020000
482000            WHEN                                                  49030000
482100                PC138-CONFIRM-CODE(PC138-IDX)  =                  49040000
482200                PC133-CONFIRM-CODE                                49050000
482300                    MOVE PC138-XREF-CODE(PC138-IDX)               49060000
482400                      TO PV-LPMS-XMIT-RETURN.                     49070000
482500                                                                  49080000
482600                                                                  49090000
482700                                                                  49100000
482800*----------------------------------------------------------------*49110000
482900*  CHECK TO SEE IF LABEL TRANSACTION ID ALREADY EXISTS           *49120000
483000*----------------------------------------------------------------*49130000
483100 4750-CK-TRANS-ID.                                                49140000
483200                                                                  49150000
483300     MOVE PV-LPMS-TRANS-ID  TO  DK-LPMS-TRANS-ID.                 49160000
483400                                                                  49170000
483500     EXEC SQL                                                     49180000
483600          SELECT LBL_REQ_TRN_ID                                   49190000
483700          INTO  :LBTKHS-LBL-REQ-TRN-ID                            49200000
483800          FROM   TLBTKHS                                          49210000
483900          WHERE  LBL_REQ_TRN_ID  = :DK-LPMS-TRANS-ID              49220000
484000     END-EXEC.                                                    49230000
484100                                                                  49240000
484200     EVALUATE TRUE                                                49250000
484300         WHEN SQLCODE = ZERO                                      49260000
484400              ADD  1  TO  PV-LPMS-TRANS-ID                        49270000
484500              SET  PS-TRANS-ID-DUP    TO  TRUE                    49280000
484600                                                                  49290000
484700         WHEN SQLCODE = +100                                      49300000
484800             SET PS-TRANS-ID-NOT-DUP  TO  TRUE                    49310000
484900             SET PS-VALID-TRANS-ID    TO  TRUE                    49320000
485000                                                                  49330000
485100         WHEN OTHER                                               49340000
485200             MOVE   DK-LPMS-TRANS-ID   TO PV-DISPLAY-LPMS-TRAN    49350000
485300              STRING ' SUKRF707 - '            DELIMITED BY SIZE  49360000
485400                     'DK-LPMS-TRANS-ID: '      DELIMITED BY SIZE  49370000
485500                     PV-DISPLAY-LPMS-TRAN      DELIMITED BY SIZE  49380000
485600                                           INTO PV-CICS-MSG-AREA  49390000
485700              MOVE LENGTH OF PV-CICS-MSG-AREA                     49400000
485800                     TO PV-COMMAREA-LENGTH                        49410000
485900              PERFORM 9990-WRITE-CICS                             49420000
486000                                                                  49430000
486100             MOVE '4750-CK-TRANS-ID'                              49440000
486200                             TO DP013-PARAGRAPH                   49450000
486300             MOVE 'SUKRF707 - CK FOR DUP LPMS TRANS ID'           49460000
486400                             TO DP013-MESSAGE-TEXT(1)             49470000
486500             MOVE PV-LPMS-TRANS-ID                                49480000
486600                             TO DP013-MESSAGE-TEXT(2)             49490000
486700             MOVE SQLCA      TO DP013-SQLCA                       49500000
486800             MOVE 'TLBTKID'  TO DP013-DB2-TABLE-NAME(1)           49510000
486900             SET DP013-DB2-ABEND              TO TRUE             49520000
487000*            PERFORM 9999-WRITE-CICS-LOG-MSG                      49530000
487100             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              49540000
487200             PERFORM DP014-0000-PROCESS-ABEND                     49550000
487300     END-EVALUATE.                                                49560000
487400                                                                  49570000
487500*----------------------------------------------------------------*49580000
487600*  SEND HEADER LABEL                                             *49590000
487700*----------------------------------------------------------------*49600000
487800 4800-CREATE-HEADER-LABEL.                                        49610000
487900* SEND HEADER LABEL                                               49620000
488000                                                                  49630000
488100     SET  PC133-LABEL-DTL             TO TRUE.                    49640000
488200     MOVE SU001-USER-ID               TO PC134-REQUESTED-BY.      49650000
488300     IF  SU001-BATCH-NUMBER  =  SU001-BATCH-NO-USE                49660000
488400         MOVE '1X1100000100045L000000'   TO PC134-REPRINT-BOX     49670000
488500         MOVE '341100500320150@@@@@@@@@' TO PC134-REPRINT-FIELD   49680000
488600         SET  PS-NOT-REPRINT-BATCH       TO TRUE                  49690000
488700     ELSE                                                         49700000
488800         MOVE '1X1100000100045L115025'   TO PC134-REPRINT-BOX     49710000
488900         MOVE '341100500320150*REPRINT*' TO PC134-REPRINT-FIELD   49720000
489000         SET  PS-REPRINT-BATCH           TO TRUE                  49730000
489100     END-IF.                                                      49740000
489200     MOVE PV-OWNER-SCAC-ID            TO PC134-SCAC.              49750000
489300     MOVE PV-VEH-NBR                  TO PC134-TRAILER.           49760000
489400     MOVE SU001-MANIFEST              TO PC134-TRIP.              49770000
489500     MOVE SU001-BATCH-NO-USE          TO PC134-BATCH-NBR.         49780000
489600     IF  SU001-BATCH-NUMBER  =  SU001-BATCH-NO-USE                49790000
489700         MOVE PV-DB2-REPRINT-LBL-CNT  TO PC134-REPRINT-LBL-CNT    49800000
489800     ELSE                                                         49810000
489900         MOVE PV-DB2-LABEL-COUNT      TO PC134-REPRINT-LBL-CNT    49820000
490000     END-IF                                                       49830000
490100     MOVE PV-DB2-LABEL-COUNT          TO PC134-SML-LBL-CNT.       49840000
490200     MOVE SU001-PRINTER-ID-USE        TO PC134-PRINTER-ID.        49850000
490300     MOVE PV-CURRENT-MM-DD            TO PC134-SUBMIT-MMDD.       49860000
490400     MOVE PV-CURRENT-TIME             TO PC134-SUBMIT-HHMM.       49870000
490500                                                                  49880000
490600     IF  PV-DB2-EXCEPT-LBL-CNT  >  ZERO                           49890000
490700         MOVE '1X1100003300045L465050' TO PC134-EXCEPT-BOX        49900000
490800         MOVE '342200503720390EXCEPTIONS EXIST'                   49910000
490900                                       TO PC134-EXCEPT-FIELD      49920000
491000     ELSE                                                         49930000
491100         MOVE '1X1100003300045L000000' TO PC134-EXCEPT-BOX        49940000
491200         MOVE '342200503720390@@@@@@@@@@@@@@@@'                   49950000
491300                                       TO PC134-EXCEPT-FIELD      49960000
491400     END-IF.                                                      49970000
491500                                                                  49980000
491600     IF  PS-HEADER-DIVIDER-PRINT-YES                              49990000
491700         PERFORM 4510-HDR-LABEL                                   50000000
491800                 VARYING PC134-IDX FROM 1 BY 1                    50010000
491900                   UNTIL PC134-IDX > PC134-HEADER-LABEL-MAX-LN    50020000
492000                      OR PS-SOCKET-ERROR                          50030000
492100     END-IF.                                                      50040000
492200                                                                  50050000
492300*----------------------------------------------------------------*50060000
492400*  SEND TRAILER LABEL                                            *50070000
492500*----------------------------------------------------------------*50080000
492600 4810-CREATE-TRAILER-LABEL.                                       50090000
492700                                                                  50100000
492800     MOVE SU001-USER-ID              TO PC137-REQUESTED-BY.       50110000
492900     MOVE PV-OWNER-SCAC-ID           TO PC137-SCAC.               50120000
493000     MOVE PV-VEH-NBR                 TO PC137-TRAILER.            50130000
493100     MOVE SU001-MANIFEST             TO PC137-TRIP.               50140000
493200     MOVE SU001-BATCH-NO-USE         TO PC137-BATCH-NBR.          50150000
493300                                                                  50160000
493400     IF  SU001-BATCH-NUMBER  =  SU001-BATCH-NO-USE                50170000
493500         MOVE '1X1100000100045L000000'   TO PC137-REPRINT-BOX     50180000
493600         MOVE '341100500320150@@@@@@@@@' TO PC137-REPRINT-FIELD   50190000
493700         SET  PS-NOT-REPRINT-BATCH       TO TRUE                  50200000
493800     ELSE                                                         50210000
493900         MOVE '1X1100000100045L115025'   TO PC137-REPRINT-BOX     50220000
494000         MOVE '341100500320150*REPRINT*' TO PC137-REPRINT-FIELD   50230000
494100         SET  PS-REPRINT-BATCH           TO TRUE                  50240000
494200     END-IF.                                                      50250000
494300                                                                  50260000
494400     IF  PV-DB2-EXCEPT-LBL-CNT  >  ZERO                           50270000
494500         MOVE '1X1100003300045L465050' TO PC137-EXCEPT-BOX        50280000
494600         MOVE '342200503720388EXCEPTIONS EXIST'                   50290000
494700                                       TO PC137-EXCEPT-FIELD      50300000
494800     ELSE                                                         50310000
494900         MOVE '1X1100003300045L000000' TO PC137-EXCEPT-BOX        50320000
495000         MOVE '342200503720390@@@@@@@@@@@@@@@@'                   50330000
495100                                       TO PC137-EXCEPT-FIELD      50340000
495200     END-IF.                                                      50350000
495300                                                                  50360000
495400     IF  PS-TRAILER-DIVIDER-PRINT-YES                             50370000
495500         PERFORM 4590-TLR-LABEL                                   50380000
495600             VARYING PC137-IDX FROM 1 BY 1                        50390000
495700               UNTIL PC137-IDX > PC137-SML-TRAILER-LABEL-MAX-LN   50400000
495800                  OR PS-SOCKET-ERROR                              50410000
495900     END-IF.                                                      50420000
496000                                                                  50430000
496100                                                                  50440000
496200*----------------------------------------------------------------*50450000
496300*  CREATE SHIPPING MANIFEST LABEL                                *50460000
496400*----------------------------------------------------------------*50470000
496500 4900-CREATE-SML-LABEL.                                           50480000
496600*                                                                 50490000
496700*  SEND SML LABEL FORM                                            50500000
496800*                                                                 50510000
496900     IF LBPTDA-CART-ACTN-CDE = PC-Q                               50520000
497000        SET XL088-ONHND-QTY-NOT-ZERO TO TRUE                      50530000
497100     ELSE                                                         50540000
497200        PERFORM 7000-CALL-STORE-ON-HAND-MOD                       50550000
497300        PERFORM 7100-CHECK-AUDIT-CRTN                             50560000
497400     END-IF                                                       50570000
497500                                                                  50580000
497600     IF XL088-PROCESS-MSG-NO AND  PC255-OH-ZERO-NO                50590000
497700        CONTINUE                                                  50600000
497800     ELSE                                                         50610000
497900        IF XL088-PROCESS-MSG-YES AND PC255-OH-ZERO-YES            50620000
498000           CONTINUE                                               50630000
498100        ELSE                                                      50640000
498200           MOVE SPACES TO PV-PREV-LABEL-TYPE                      50650000
498300        END-IF                                                    50660000
498400     END-IF                                                       50670000
498500                                                                  50680000
498600* WR41309-RF ID 8/30/2012  AME  BEGIN                             50690000
498610     IF LBPTDA-CART-ACTN-CDE = PC-Q                               50700000
498611        PERFORM 3250-SELECT-BRCDE                                 50710000
498612        IF PS-SULBXF-FOUND                                        50720000
498614           MOVE SULBXF-BRCDE-NBR   TO PV-OTBND-CRTN-SULBXF        50730000
498630           MOVE PV-OTBND-SML-SULBXF TO SUT00094-SHIPT-UNT-ID      50740000
498631        END-IF                                                    50750000
498640     ELSE                                                         50760000
498700        MOVE LBPTDA-BRCDE-NBR  TO PV-OTBND-CRTN                   50770000
498800        MOVE PV-OTBND-SML      TO SUT00094-SHIPT-UNT-ID           50780000
498810     END-IF                                                       50790000
499000* CLP 7/19/2013                                                   50800000
498900**** PERFORM 3300-COUNT-MSG-RD                                    50810000
499100*                                                                 50820000
499200     IF PS-AUDIT-CRTN-FOUND-NO AND PC255-AUDIT-NO                 50830000
499300        CONTINUE                                                  50840000
499400     ELSE                                                         50850000
499500        IF PS-AUDIT-CRTN-FOUND-YES AND PC255-AUDIT-YES            50860000
499600           CONTINUE                                               50870000
499700        ELSE                                                      50880000
499800           MOVE SPACES TO PV-PREV-LABEL-TYPE                      50890000
499900        END-IF                                                    50900000
500000     END-IF                                                       50910000
500100                                                                  50920000
500200     IF PS-AUDIT-CRTN-FOUND-YES                                   50930000
500300        SET PC255-AUDIT-YES TO TRUE                               50940000
500400     ELSE                                                         50950000
500500        SET PC255-AUDIT-NO TO TRUE                                50960000
500600     END-IF                                                       50970000
500700                                                                  50980000
502500                                                                  50990000
502600* GB 01/4/02 WHEN PREVIOUS TYPE IS AUDIT, FORCE FORM TO BE RESENT 51000000
502700     IF LBPTDA-CART-ACTN-CDE = PV-PREV-AUDIT-CART-IND             51010000
502800        CONTINUE                                                  51020000
502900     ELSE                                                         51030000
503000        MOVE SPACES TO PV-PREV-LABEL-TYPE                         51040000
503100     END-IF                                                       51050000
503200* GB 1/04/02 END                                                  51060000
503300                                                                  51070000
503400     IF (LBPTDA-CART-LBL-TYP-CDE = PV-PREV-LABEL-TYPE) AND        51080000
503500        (SULBXF-CART-LBL-TYP-CDE = PV-PREV-SULBXF-LBL-TYP-CDE)    51090000
503600       IF PS-REPRINT-BATCH AND PS-REPRINT-FORM                    51100000
503700          IF LBPTDA-PREPK-ID > 0 AND PS-PREPK-FORM                51110000
503800             CONTINUE                                             51120000
503900          ELSE                                                    51130000
504000             PERFORM 4559-BUILD-SML-FORM                          51140000
504100             PERFORM 4560-SEND-SML-FORM                           51150000
504200                 VARYING PC255-IDX FROM 1 BY 1                    51160000
504300                 UNTIL PC255-IDX >                                51170000
504400                       PC255-SML-BATCH-LBL-MAX-LN                 51180000
504500                 OR PS-SOCKET-ERROR                               51190000
504600          END-IF                                                  51200000
504700       ELSE                                                       51210000
504800         IF LBPTDA-RPRT-IND = PC-Y AND PS-REPRINT-FORM            51220000
504900            IF LBPTDA-PREPK-ID > 0 AND PS-PREPK-FORM              51230000
505000               CONTINUE                                           51240000
505100            ELSE                                                  51250000
505200               PERFORM 4559-BUILD-SML-FORM                        51260000
505300               PERFORM 4560-SEND-SML-FORM                         51270000
505400                   VARYING PC255-IDX FROM 1 BY 1                  51280000
505500                   UNTIL PC255-IDX >                              51290000
505600                         PC255-SML-BATCH-LBL-MAX-LN               51300000
505700                   OR PS-SOCKET-ERROR                             51310000
505800            END-IF                                                51320000
505900         ELSE                                                     51330000
506000           IF LBPTDA-RPRT-IND = PC-Y                              51340000
506100               PERFORM 4559-BUILD-SML-FORM                        51350000
506200               PERFORM 4560-SEND-SML-FORM                         51360000
506300                   VARYING PC255-IDX FROM 1 BY 1                  51370000
506400                UNTIL PC255-IDX > PC255-SML-BATCH-LBL-MAX-LN      51380000
506500                        OR PS-SOCKET-ERROR                        51390000
506600           ELSE                                                   51400000
506700             IF LBPTDA-RPRT-IND NOT = PC-Y AND                    51410000
506800                 PS-REPRINT-FORM                                  51420000
506900                 PERFORM 4559-BUILD-SML-FORM                      51430000
507000                 PERFORM 4560-SEND-SML-FORM                       51440000
507100                     VARYING PC255-IDX FROM 1 BY 1                51450000
507200                       UNTIL PC255-IDX >                          51460000
507300                             PC255-SML-BATCH-LBL-MAX-LN           51470000
507400                          OR PS-SOCKET-ERROR                      51480000
507500             END-IF                                               51490000
507600           END-IF                                                 51500000
507700         END-IF                                                   51510000
507800       END-IF                                                     51520000
507900     ELSE                                                         51530000
508000        PERFORM 4559-BUILD-SML-FORM                               51540000
508100        PERFORM 4560-SEND-SML-FORM                                51550000
508200           VARYING PC255-IDX FROM 1 BY 1                          51560000
508300             UNTIL PC255-IDX > PC255-SML-BATCH-LBL-MAX-LN         51570000
508400                OR PS-SOCKET-ERROR                                51580000
508500     END-IF.                                                      51590000
508600*                                                                 51600000
508700     PERFORM 4561-BUILD-SML-DATA                                  51610000
508800     PERFORM 4562-SEND-SML-DATA                                   51620000
508900         VARYING PC256-IDX FROM 1 BY 1                            51630000
509000           UNTIL PC256-IDX > PC256-MAX-LABEL-LINES                51640000
509100              OR PS-SOCKET-ERROR.                                 51650000
509200*                                                                 51660000
509300*                                                                 51670000
509400*----------------------------------------------------------------*51680000
509500*  CREATE PACK TO LIGHT LABEL                                    *51690000
509600*----------------------------------------------------------------*51700000
509700 4910-CREATE-P2L-LABEL.                                           51710000
509800                                                                  51720000
509900     IF LBPTDA-PREPK-ID > 0                                       51730000
510000***PACK DIVIDE***                                                 51740000
510100              MOVE PC169-PK-DIVIDE-FLD                            51750000
510200                                      TO PC169-PACK-DIVIDE-FLD    51760000
510300*PACK-XXXX                                                        51770000
510400              MOVE LBPTDA-PREPK-ID                                51780000
510500                                      TO PV-PREPK-ID              51790000
510600              MOVE PV-PACK                                        51800000
510700                                      TO PC169-SKU                51810000
510800*DRIVR LINE RATIO:                                                51820000
510900              MOVE PC169-DRVR-LNE-RATIO-DESC                      51830000
511000                                      TO PC169-LNE-NO-DESC        51840000
511100              MOVE LBPTDA-PREPK-RATO-QTY                          51850000
511200                                      TO PV-LINE-RATO             51860000
511300              MOVE PV-LINE-RATO-NBR   TO PC169-LINE-NO            51870000
511400*TOT UNTS IN PACK:                                                51880000
511500              MOVE PC169-TOT-UNITS-DESC                           51890000
511600                                      TO PC169-DES-INPK-DESC      51900000
511700              MOVE LBPTDA-PREPK-UNT-QTY                           51910000
511800                                      TO PC169-DES-INPK-QTY       51920000
511900*PACKS IN CARTON:                                                 51930000
512000              MOVE PC169-PCKS-INCTN-DESC                          51940000
512100                                      TO PC169-DES-UNT-PK-DESC    51950000
512200*GB 3/21/01*******************************************************51960000
512300            DIVIDE LBPTDA-OTPK-UNT-QTY BY                         51970000
512400                          LBPTDA-PREPK-UNT-QTY                    51980000
512500                          GIVING   PV-PACKS-IN-CARTON             51990000
512600            MOVE PV-PACKS-IN-CARTON-X                             52000000
512700                                    TO PC169-DES-UNT-PK-QTY       52010000
512800*DRIVR LNE SKU:                                                   52020000
512900          MOVE PC169-DRVR-LINE-DESC                               52030000
513000                                  TO PC169-DES-DWN-SK-DESC        52040000
513100                                                                  52050000
513200          MOVE   LBPTDA-SKU-NBR                                   52060000
513300                                  TO PC169-DES-DWN-SK-QTY         52070000
513400                                                                  52080000
513500                                                                  52090000
513600          MOVE PC169-PK-DIVIDE-BOX                                52100000
513700                                  TO PC169-PACK-DIVIDE-BOX        52110000
513800                                                                  52120000
513900           MOVE LBPTDA-BRCDE-NBR      TO PC169-BC-BARCODE         52130000
514000                                         PC169-TXT-BARCODE        52140000
514100           MOVE LBPTDA-CRE-USR-ID                                 52150000
514200                                      TO PC169-USER-ID            52160000
514300*                                                                 52170000
514400           PERFORM 3040-GET-DC-PRTD-AT                            52180000
514500           MOVE LBPTDA-PRTR-ID                                    52190000
514600                                      TO PV-PRTR-ID               52200000
514700           MOVE PV-PRINTER-FORMAT     TO PC169-DES-PRINTER-ID     52210000
514800*                                                                 52220000
514900           MOVE LBPTDA-LBL-TYP-LBL-SEQ-ID                         52230000
515000                                      TO PC169-LABEL-NBR          52240000
515100           MOVE LBPTDA-LBL-TYP-TOT-QTY                            52250000
515200                                      TO PC169-TOT-LABEL          52260000
515300           MOVE PV-CURRENT-DB2-DATE   TO PV-WORK-DB2-DATE         52270000
515400           MOVE PV-WORK-YY            TO PV-LBL-DATE-YY           52280000
515500           MOVE PV-WORK-MM            TO PV-LBL-DATE-MM           52290000
515600           MOVE PV-WORK-DD            TO PV-LBL-DATE-DD           52300000
515700           MOVE '-'                   TO PV-LBL-DASH1             52310000
515800                                         PV-LBL-DASH2             52320000
515900           MOVE PV-LBL-DATE           TO PC169-LBL-PRT-DATE       52330000
516000           MOVE PV-CURRENT-TIME                                   52340000
516100                                      TO PC169-LBL-PRT-TIME       52350000
516200           MOVE PC169-LABEL-DESCRIPTION                           52360000
516300                                      TO PC169-DEST-LBL-DESC      52370000
516400*CRTN                                                             52380000
516500           MOVE LBPTDA-SHIPT-UNT-ID                               52390000
516600                                      TO PV-SHIPT-UNT-ID          52400000
516700           MOVE PV-LAST-FIVE-DIGITS                               52410000
516800                                      TO PC169-CRTN-NBR           52420000
516900*LBL SEQ                                                          52430000
517000           MOVE LBPTDA-LBL-TYP-LBL-SEQ-ID                         52440000
517100                                      TO PC169-START-CARTON-CNT-1 52450000
517200*SKU                                                              52460000
517300           MOVE LBPTDA-SKU-NBR        TO PC169-DES-DWN-SK-QTY     52470000
517400*PO RCVR                                                          52480000
517500           MOVE LBPTDA-PO-NBR                                     52490000
517600                                      TO PV-PO-NBR                52500000
517700           MOVE PV-PO-NBR-7POS                                    52510000
517800                                      TO PC169-DES-PO             52520000
517900           MOVE '-'                                               52530000
518000                                      TO PC169-DES-PO-DASH        52540000
518100           MOVE LBPTDA-RCVR-SEQ-NBR                               52550000
518200                                      TO PV-RCVR-NBR              52560000
518300           MOVE PV-RCVR-NBR-3POS                                  52570000
518400                                      TO PC169-SEQ-NO             52580000
518500*DEPT-CLASS                                                       52590000
518600           MOVE LBPTDA-SKU-DEPT-NBR                               52600000
518700                                      TO PV-P2L-DEPT1             52610000
518800           MOVE LBPTDA-SKU-CL-NBR                                 52620000
518900                                      TO PV-P2L-CLASS-NBR1        52630000
519000           MOVE PV-P2L-DEPT-CLASS                                 52640000
519100                                      TO PC169-DEPT-CLASS         52650000
519200                                                                  52660000
519300*ZONE                                                             52670000
519400           MOVE LBPTDA-STR-ZN-ID                                  52680000
519500                                      TO PC169-DES-ZONE           52690000
519600*MODULE NAME                                                      52700000
519700           MOVE LBPTDA-MODU-DESC                                  52710000
519800                                      TO PC169-MODULE-NAME        52720000
519900*****************IF NON-PREPACK ORDER*****************************52730000
520000     ELSE                                                         52740000
520100           MOVE LBPTDA-BRCDE-NBR      TO PC169-BC-BARCODE         52750000
520200                                         PC169-TXT-BARCODE        52760000
520300           MOVE LBPTDA-CRE-USR-ID                                 52770000
520400                                      TO PC169-USER-ID            52780000
520500*                                                                 52790000
520600           PERFORM 3040-GET-DC-PRTD-AT                            52800000
520700           MOVE LBPTDA-PRTR-ID                                    52810000
520800                                      TO PV-PRTR-ID               52820000
520900           MOVE PV-PRINTER-FORMAT     TO PC169-DES-PRINTER-ID     52830000
521000*                                                                 52840000
521100           MOVE LBPTDA-LBL-TYP-LBL-SEQ-ID                         52850000
521200                                      TO PC169-LABEL-NBR          52860000
521300           MOVE LBPTDA-LBL-TYP-TOT-QTY                            52870000
521400                                      TO PC169-TOT-LABEL          52880000
521500           MOVE PV-CURRENT-DB2-DATE   TO PV-WORK-DB2-DATE         52890000
521600           MOVE PV-WORK-YY            TO PV-LBL-DATE-YY           52900000
521700           MOVE PV-WORK-MM            TO PV-LBL-DATE-MM           52910000
521800           MOVE PV-WORK-DD            TO PV-LBL-DATE-DD           52920000
521900           MOVE '-'                   TO PV-LBL-DASH1             52930000
522000                                         PV-LBL-DASH2             52940000
522100           MOVE PV-LBL-DATE           TO PC169-LBL-PRT-DATE       52950000
522200           MOVE PV-CURRENT-TIME                                   52960000
522300                                      TO PC169-LBL-PRT-TIME       52970000
522400           MOVE PC169-LABEL-DESCRIPTION                           52980000
522500                                      TO PC169-DEST-LBL-DESC      52990000
522600*CRTN                                                             53000000
522700           MOVE LBPTDA-SHIPT-UNT-ID                               53010000
522800                                      TO PV-SHIPT-UNT-ID          53020000
522900           MOVE PV-LAST-FIVE-DIGITS                               53030000
523000                                      TO PC169-CRTN-NBR           53040000
523100*LBL SEQ                                                          53050000
523200           MOVE LBPTDA-LBL-TYP-LBL-SEQ-ID                         53060000
523300                                      TO PC169-START-CARTON-CNT-1 53070000
523400*SKU                                                              53080000
523500           MOVE LBPTDA-SKU-NBR                                    53090000
523600                                      TO PC169-SKU                53100000
523700*PO RCVR                                                          53110000
523800           MOVE LBPTDA-PO-NBR                                     53120000
523900                                      TO PV-PO-NBR                53130000
524000           MOVE PV-PO-NBR-7POS                                    53140000
524100                                      TO PC169-DES-PO             53150000
524200           MOVE '-'                                               53160000
524300                                      TO PC169-DES-PO-DASH        53170000
524400           MOVE LBPTDA-RCVR-SEQ-NBR                               53180000
524500                                      TO PV-RCVR-NBR              53190000
524600           MOVE PV-RCVR-NBR-3POS                                  53200000
524700                                      TO PC169-SEQ-NO             53210000
524800*DEPT-CLASS                                                       53220000
524900           MOVE LBPTDA-SKU-DEPT-NBR                               53230000
525000                                      TO PV-P2L-DEPT1             53240000
525100           MOVE LBPTDA-SKU-CL-NBR                                 53250000
525200                                      TO PV-P2L-CLASS-NBR1        53260000
525300           MOVE PV-P2L-DEPT-CLASS                                 53270000
525400                                      TO PC169-DEPT-CLASS         53280000
525500*LINE NUMBER                                                      53290000
525600           MOVE PC169-LINE-NO-DESC                                53300000
525700                                      TO PC169-LNE-NO-DESC        53310000
525800           MOVE LBPTDA-PO-LNE-NBR                                 53320000
525900                                      TO PV-LINE-NBR              53330000
526000           MOVE PV-PO-LINE-NBR                                    53340000
526100                                      TO PC169-LINE-NO            53350000
526200*INNER PACK UNITS                                                 53360000
526300       IF  LBPTDA-INPK-CNVYB-IND = 'Y'                            53370000
526400             MOVE PC169-INPK-CNVY-DESC                            53380000
526500                                        TO PC169-DES-INPK-DESC    53390000
526600             MOVE PC169-INPK-CNVY-BOX                             53400000
526700                                        TO PC169-INPK-BOX         53410000
526800             MOVE LBPTDA-INPK-UNT-QTY                             53420000
526900                                        TO PV-INPK-QTY            53430000
527000             MOVE PV-INPK-UNIT-QTY                                53440000
527100                                        TO PC169-DES-INPK-QTY     53450000
527200       ELSE                                                       53460000
527300             MOVE PC169-INNER-PACK-DESC                           53470000
527400                                        TO PC169-DES-INPK-DESC    53480000
527500             MOVE PC169-NO-INPK-CNVY-BOX                          53490000
527600                                        TO PC169-INPK-BOX         53500000
527700             MOVE LBPTDA-INPK-UNT-QTY                             53510000
527800                                        TO PV-INPK-QTY            53520000
527900             MOVE PV-INPK-UNIT-QTY                                53530000
528000                                        TO PC169-DES-INPK-QTY     53540000
528100       END-IF                                                     53550000
528200                                                                  53560000
528300*ZONE                                                             53570000
528400           MOVE LBPTDA-STR-ZN-ID                                  53580000
528500                                      TO PC169-DES-ZONE           53590000
528600*MODULE NAME                                                      53600000
528700           MOVE LBPTDA-MODU-DESC                                  53610000
528800                                      TO PC169-MODULE-NAME        53620000
528900                                                                  53630000
529000           MOVE SPACES                TO PC169-DES-UNT-PK-DESC    53640000
529100                                         PC169-DES-UNT-PK-QTY     53650000
529200                                         PC169-DES-DWN-SK-DESC    53660000
529300                                         PC169-DES-DWN-SK-QTY     53670000
529400           MOVE PC169-NO-PK-DIVIDE-BOX                            53680000
529500                                      TO PC169-PACK-DIVIDE-BOX    53690000
529600           MOVE PC169-NO-PK-DIVIDE-FLD                            53700000
529700                                      TO PC169-PACK-DIVIDE-FLD    53710000
529800     END-IF.                                                      53720000
529900*                                                                 53730000
530000* GB 12/20/01 BEG                                                 53740000
530100*AUDIT INDICATOR                                                  53750000
530200     MOVE LBPTDA-CART-ACTN-CDE TO PC169-AUDIT-IND                 53760000
530300* GB 12/20/01 END                                                 53770000
530400                                                                  53780000
530500*CLP 07/19/2013                                                   53790000
530600*    IF LBPTDA-PRC-MSG-CDE = 'RD'                                 53800000
530700*        MOVE PC169-RFID-BOX    TO PC169-LBL-RFID-BOX             53810000
530800*        MOVE PC169-RFID-FLD    TO PC169-LBL-RFID-FLD             53820000
530900*    ELSE                                                         53830000
531000*        MOVE PC169-NO-RFID-BOX TO PC169-LBL-RFID-BOX             53840000
531100*        MOVE PC169-NO-RFID-FLD TO PC169-LBL-RFID-FLD             53850000
531200*    END-IF.                                                      53860000
531000     MOVE PC169-NO-RFID-BOX TO PC169-LBL-RFID-BOX.                53870000
531100     MOVE PC169-NO-RFID-FLD TO PC169-LBL-RFID-FLD.                53880000
531300                                                                  53890000
531500     MOVE 0001  TO PC169-LBL-QTY-TO-PRT.                          53900000
531600                                                                  53910000
531700     PERFORM 4567-SEND-P2L-DATA                                   53920000
531710           VARYING PC169-IDX FROM 1 BY 1                          53930000
531720             UNTIL PC169-IDX > PC169-P2L-DEST-LBL-MAX-LN          53940000
531730                OR PS-SOCKET-ERROR.                               53950000
531740*                                                                 53960000
531750*                                                                 53970000
531760*----------------------------------------------------------------*53980000
531770*  CREATE ECOMMERCE REPURPOSE LABEL                              *53990000
531780*----------------------------------------------------------------*54000000
531790 4915-CREATE-EC-REPURP-LBL.                                       54010000
531800                                                                  54020000
531900     IF LBPTDA-PREPK-ID > 0                                       54030000
532000*PACK-XXXX                                                        54040000
532100           MOVE LBPTDA-PREPK-ID                                   54050000
532200                                      TO PV-PREPK-ID              54060000
532300           MOVE PV-PACK                                           54070000
532400                                      TO PC169-SKU                54080000
532500*LINE NUMBER                                                      54090000
532600           MOVE PC169-LINE-NO-DESC                                54100000
532700                                      TO PC169-LNE-NO-DESC        54110000
532800           MOVE ZEROES                                            54120000
532900*INNER PACK UNITS                                                 54130000
533000                                      TO PC169-LINE-NO            54140000
533100           MOVE PC169-INNER-PACK-DESC                             54150000
533200                                      TO PC169-DES-INPK-DESC      54160000
533300           MOVE PC169-NO-INPK-CNVY-BOX                            54170000
533400                                      TO PC169-INPK-BOX           54180000
533500           MOVE ZEROES                                            54190000
533600                                        TO PC169-DES-INPK-QTY     54200000
533700     ELSE                                                         54210000
533800*SKU                                                              54220000
533900           MOVE LBPTDA-SKU-NBR                                    54230000
534000                                      TO PC169-SKU                54240000
534100*LINE NUMBER                                                      54250000
534200           MOVE PC169-LINE-NO-DESC                                54260000
534300                                      TO PC169-LNE-NO-DESC        54270000
534400           MOVE LBPTDA-PO-LNE-NBR                                 54280000
534500                                      TO PV-LINE-NBR              54290000
534600           MOVE PV-PO-LINE-NBR                                    54300000
534700                                      TO PC169-LINE-NO            54310000
534800*INNER PACK UNITS                                                 54320000
534900           MOVE PC169-INNER-PACK-DESC                             54330000
535000                                      TO PC169-DES-INPK-DESC      54340000
535100           MOVE PC169-NO-INPK-CNVY-BOX                            54350000
535200                                      TO PC169-INPK-BOX           54360000
535300           MOVE LBPTDA-INPK-UNT-QTY                               54370000
535400                                      TO PV-INPK-QTY              54380000
535500           MOVE PV-INPK-UNIT-QTY                                  54390000
535600                                      TO PC169-DES-INPK-QTY       54400000
535700     END-IF                                                       54410000
535800           MOVE LBPTDA-BRCDE-NBR      TO PC169-BC-BARCODE         54420000
535900                                         PC169-TXT-BARCODE        54430000
536000           MOVE LBPTDA-CRE-USR-ID                                 54440000
536100                                      TO PC169-USER-ID            54450000
536200*                                                                 54460000
536300           PERFORM 3040-GET-DC-PRTD-AT                            54470000
536400           MOVE LBPTDA-PRTR-ID                                    54480000
536500                                      TO PV-PRTR-ID               54490000
536600           MOVE PV-PRINTER-FORMAT     TO PC169-DES-PRINTER-ID     54500000
536700*                                                                 54510000
536800           MOVE +1                                                54520000
536900                                      TO PC169-LABEL-NBR          54530000
537000           MOVE LBPTDA-LBL-TYP-TOT-QTY                            54540000
537100                                      TO PC169-TOT-LABEL          54550000
537200           MOVE PV-CURRENT-DB2-DATE   TO PV-WORK-DB2-DATE         54560000
537300           MOVE PV-WORK-YY            TO PV-LBL-DATE-YY           54570000
537400           MOVE PV-WORK-MM            TO PV-LBL-DATE-MM           54580000
537500           MOVE PV-WORK-DD            TO PV-LBL-DATE-DD           54590000
537600           MOVE '-'                   TO PV-LBL-DASH1             54600000
537700                                         PV-LBL-DASH2             54610000
537800           MOVE PV-LBL-DATE           TO PC169-LBL-PRT-DATE       54620000
537900           MOVE PV-CURRENT-TIME                                   54630000
538000                                      TO PC169-LBL-PRT-TIME       54640000
538100           MOVE PC169-LABEL-DESCRIPTION                           54650000
538200                                      TO PC169-DEST-LBL-DESC      54660000
538300*CRTN                                                             54670000
538400           MOVE LBPTDA-SHIPT-UNT-ID                               54680000
538500                                      TO PV-SHIPT-UNT-ID          54690000
538600           MOVE PV-LAST-FIVE-DIGITS                               54700000
538700                                      TO PC169-CRTN-NBR           54710000
538800*LBL SEQ                                                          54720000
538900           MOVE LBPTDA-LBL-TYP-LBL-SEQ-ID                         54730000
539000                                      TO PC169-START-CARTON-CNT-1 54740000
539100*PO RCVR                                                          54750000
539200           MOVE LBPTDA-PO-NBR                                     54760000
539300                                      TO PV-PO-NBR                54770000
539400           MOVE PV-PO-NBR-7POS                                    54780000
539500                                      TO PC169-DES-PO             54790000
539600           MOVE '-'                                               54800000
539700                                      TO PC169-DES-PO-DASH        54810000
539800           MOVE LBPTDA-RCVR-SEQ-NBR                               54820000
539900                                      TO PV-RCVR-NBR              54830000
540000           MOVE PV-RCVR-NBR-3POS                                  54840000
540100                                      TO PC169-SEQ-NO             54850000
540200*DEPT-CLASS                                                       54860000
540300           MOVE LBPTDA-SKU-DEPT-NBR                               54870000
540400                                      TO PV-P2L-DEPT1             54880000
540500           MOVE LBPTDA-SKU-CL-NBR                                 54890000
540600                                      TO PV-P2L-CLASS-NBR1        54900000
540700           MOVE PV-P2L-DEPT-CLASS                                 54910000
540800                                      TO PC169-DEPT-CLASS         54920000
540900                                                                  54930000
541000*ZONE                                                             54940000
541100           MOVE LBPTDA-STR-ZN-ID                                  54950000
541200                                      TO PC169-DES-ZONE           54960000
541300*MODULE NAME                                                      54970000
541400           MOVE LBPTDA-MODU-DESC                                  54980000
541500                                      TO PC169-MODULE-NAME        54990000
541600                                                                  55000000
541700           MOVE SPACES                TO PC169-DES-UNT-PK-DESC    55010000
541800                                         PC169-DES-UNT-PK-QTY     55020000
541900                                         PC169-DES-DWN-SK-DESC    55030000
542000                                         PC169-DES-DWN-SK-QTY     55040000
542100                                                                  55050000
542200     IF LBPTDA-SU-MSSG-DAT-IND = 'M'                              55060000
542300        MOVE PC169-PK-DIVIDE-BOX                                  55070000
542400                                  TO PC169-PACK-DIVIDE-BOX        55080000
542500        MOVE PC169-REPURP-WGHTS-MSURES                            55090000
542600                                      TO PC169-PACK-DIVIDE-FLD    55100000
542700     ELSE                                                         55110000
542800        MOVE PC169-NO-PK-DIVIDE-BOX                               55120000
542900                                      TO PC169-PACK-DIVIDE-BOX    55130000
543000        MOVE PC169-NO-PK-DIVIDE-FLD                               55140000
543100                                      TO PC169-PACK-DIVIDE-FLD    55150000
543200     END-IF                                                       55160000
543300*                                                                 55170000
543400* GB 12/20/01 BEG                                                 55180000
543500*AUDIT INDICATOR                                                  55190000
543600     MOVE LBPTDA-CART-ACTN-CDE TO PC169-AUDIT-IND                 55200000
543700* GB 12/20/01 END                                                 55210000
543800                                                                  55220000
543900                                                                  55230000
544000     MOVE 0001  TO PC169-LBL-QTY-TO-PRT.                          55240000
544100                                                                  55250000
544200     PERFORM 4567-SEND-P2L-DATA                                   55260000
544300           VARYING PC169-IDX FROM 1 BY 1                          55270000
544400             UNTIL PC169-IDX > PC169-P2L-DEST-LBL-MAX-LN          55280000
544500                OR PS-SOCKET-ERROR.                               55290000
544600*                                                                 55300000
544700*                                                                 55310000
544800*----------------------------------------------------------------*55320000
544900*  CREATE CENTRAL STOCK LABEL                                    *55330000
545000*----------------------------------------------------------------*55340000
545100 4920-CREATE-CNSTK-LABEL.                                         55350000
545200*  SEND CENTRAL STOCK LABEL FORM                                  55360000
545300*                                                                 55370000
545400     IF LBPTDA-INPK-CNVYB-IND  = PV-PREV-INPK-CNVYB-IND           55380000
545500        CONTINUE                                                  55390000
545600     ELSE                                                         55400000
545700        MOVE SPACES TO PV-PREV-LABEL-TYPE                         55410000
545800     END-IF                                                       55420000
545900                                                                  55430000
546000     IF LBPTDA-CART-LBL-TYP-CDE = PV-PREV-LABEL-TYPE              55440000
546100        IF  LBPTDA-PREPK-ID > 0                                   55450000
546200           PERFORM UNTIL PS-EOF-LBL-CURSOR                        55460000
546300                   OR PS-SOCKET-ERROR                             55470000
546400           IF PS-REPRINT-BATCH AND                                55480000
546500               PS-REPRINT-FORM                                    55490000
546600               CONTINUE                                           55500000
546700           ELSE                                                   55510000
546800*LMM       IF LBPTDA-RPRT-IND = PC-R AND                          55520000
546900           IF LBPTDA-RPRT-IND = PC-Y AND                          55530000
547000               PS-REPRINT-FORM                                    55540000
547100               CONTINUE                                           55550000
547200           ELSE                                                   55560000
547300*LMM       IF LBPTDA-RPRT-IND = PC-R                              55570000
547400           IF LBPTDA-RPRT-IND = PC-Y                              55580000
547500               PERFORM 4563-BUILD-CS-FORM                         55590000
547600               PERFORM 4564-SEND-CS-FORM                          55600000
547700                   VARYING PC205-IDX FROM 1 BY 1                  55610000
547800                     UNTIL PC205-IDX > PC205-SHIP-MFST-LBL-MAX-LN 55620000
547900                        OR PS-SOCKET-ERROR                        55630000
548000*                                                                 55640000
548100               PERFORM 4565-BUILD-CS-DATA                         55650000
548200               PERFORM 4566-SEND-CS-DATA                          55660000
548300                   VARYING PC189-IDX FROM 1 BY 1                  55670000
548400                     UNTIL PC189-IDX > PC189-MAX-LABEL-LINES      55680000
548500                        OR PS-SOCKET-ERROR                        55690000
548600           ELSE                                                   55700000
548700*LMM       IF LBPTDA-RPRT-IND NOT = PC-R AND                      55710000
548800           IF LBPTDA-RPRT-IND NOT = PC-Y AND                      55720000
548900               PS-REPRINT-FORM                                    55730000
549000               PERFORM 4563-BUILD-CS-FORM                         55740000
549100               PERFORM 4564-SEND-CS-FORM                          55750000
549200                   VARYING PC205-IDX FROM 1 BY 1                  55760000
549300                     UNTIL PC205-IDX > PC205-SHIP-MFST-LBL-MAX-LN 55770000
549400                        OR PS-SOCKET-ERROR                        55780000
549500*                                                                 55790000
549600               PERFORM 4565-BUILD-CS-DATA                         55800000
549700               PERFORM 4566-SEND-CS-DATA                          55810000
549800                   VARYING PC189-IDX FROM 1 BY 1                  55820000
549900                     UNTIL PC189-IDX > PC189-MAX-LABEL-LINES      55830000
550000                        OR PS-SOCKET-ERROR                        55840000
550100           END-IF                                                 55850000
550200           END-IF                                                 55860000
550300           END-IF                                                 55870000
550400           END-IF                                                 55880000
550500           END-PERFORM                                            55890000
550600        ELSE                                                      55900000
550700           PERFORM 4565-BUILD-CS-DATA                             55910000
550800           PERFORM 4566-SEND-CS-DATA                              55920000
550900               VARYING PC189-IDX FROM 1 BY 1                      55930000
551000                 UNTIL PC189-IDX > PC189-MAX-LABEL-LINES          55940000
551100                    OR PS-SOCKET-ERROR                            55950000
551200     ELSE                                                         55960000
551300        PERFORM 4563-BUILD-CS-FORM                                55970000
551400        PERFORM 4564-SEND-CS-FORM                                 55980000
551500           VARYING PC205-IDX FROM 1 BY 1                          55990000
551600             UNTIL PC205-IDX > PC205-SHIP-MFST-LBL-MAX-LN         56000000
551700                OR PS-SOCKET-ERROR                                56010000
551800*                                                                 56020000
551900        PERFORM 4565-BUILD-CS-DATA                                56030000
552000        PERFORM 4566-SEND-CS-DATA                                 56040000
552100            VARYING PC189-IDX FROM 1 BY 1                         56050000
552200              UNTIL PC189-IDX > PC189-MAX-LABEL-LINES             56060000
552300                 OR PS-SOCKET-ERROR                               56070000
552400        END-IF.                                                   56080000
552500*                                                                 56090000
552600*                                                                 56100000
552700*----------------------------------------------------------------*56110000
552800*  CREATE MESSAGE LABEL                                        *  56120000
552900*----------------------------------------------------------------*56130000
553000 4930-CREATE-MESSAGE-LABEL.                                       56140000
553100*  SEND MESSAGE LABEL FORM                                        56150000
553200*----------------------------------------------------------------*56160000
553300*                                                                 56170000
553400     IF LBPTDA-CART-LBL-TYP-CDE = PV-PREV-LABEL-TYPE              56180000
553500       IF PS-REPRINT-BATCH AND PS-REPRINT-FORM                    56190000
553600          IF LBPTDA-PREPK-ID > 0 AND PS-PREPK-FORM                56200000
553700             CONTINUE                                             56210000
553800          ELSE                                                    56220000
553900             PERFORM 4575-BUILD-MESSAGE-FORM                      56230000
554000             PERFORM 4576-SEND-MESSAGE-FORM                       56240000
554100                 VARYING PC178-IDX FROM 1 BY 1                    56250000
554200                 UNTIL PC178-IDX >                                56260000
554300                       PC178-SML-BATCH-LBL-MAX-LN                 56270000
554400                 OR PS-SOCKET-ERROR                               56280000
554500          END-IF                                                  56290000
554600       ELSE                                                       56300000
554700         IF LBPTDA-RPRT-IND = PC-Y AND PS-REPRINT-FORM            56310000
554800            IF LBPTDA-PREPK-ID > 0 AND PS-PREPK-FORM              56320000
554900               CONTINUE                                           56330000
555000            ELSE                                                  56340000
555100               PERFORM 4575-BUILD-MESSAGE-FORM                    56350000
555200               PERFORM 4576-SEND-MESSAGE-FORM                     56360000
555300                   VARYING PC178-IDX FROM 1 BY 1                  56370000
555400                   UNTIL PC178-IDX >                              56380000
555500                         PC178-SML-BATCH-LBL-MAX-LN               56390000
555600                   OR PS-SOCKET-ERROR                             56400000
555700            END-IF                                                56410000
555800         ELSE                                                     56420000
555900           IF LBPTDA-RPRT-IND = PC-Y                              56430000
556000               PERFORM 4575-BUILD-MESSAGE-FORM                    56440000
556100               PERFORM 4576-SEND-MESSAGE-FORM                     56450000
556200                   VARYING PC178-IDX FROM 1 BY 1                  56460000
556300                UNTIL PC178-IDX > PC178-SML-BATCH-LBL-MAX-LN      56470000
556400                        OR PS-SOCKET-ERROR                        56480000
556500           ELSE                                                   56490000
556600             IF LBPTDA-RPRT-IND NOT = PC-Y AND                    56500000
556700                 PS-REPRINT-FORM                                  56510000
556800                 PERFORM 4575-BUILD-MESSAGE-FORM                  56520000
556900                 PERFORM 4576-SEND-MESSAGE-FORM                   56530000
557000                     VARYING PC178-IDX FROM 1 BY 1                56540000
557100                       UNTIL PC178-IDX >                          56550000
557200                             PC178-SML-BATCH-LBL-MAX-LN           56560000
557300                          OR PS-SOCKET-ERROR                      56570000
557400             END-IF                                               56580000
557500           END-IF                                                 56590000
557600         END-IF                                                   56600000
557700       END-IF                                                     56610000
557800     ELSE                                                         56620000
557900        PERFORM 4575-BUILD-MESSAGE-FORM                           56630000
558000        PERFORM 4576-SEND-MESSAGE-FORM                            56640000
558100           VARYING PC178-IDX FROM 1 BY 1                          56650000
558200             UNTIL PC178-IDX > PC178-SML-BATCH-LBL-MAX-LN         56660000
558300                OR PS-SOCKET-ERROR                                56670000
558400     END-IF.                                                      56680000
558500*                                                                 56690000
558600     PERFORM 4577-BUILD-MESSAGE-DATA                              56700000
558700     PERFORM 4578-SEND-MESSAGE-DATA                               56710000
558800         VARYING PC179-IDX FROM 1 BY 1                            56720000
558900           UNTIL PC179-IDX > PC179-MAX-LABEL-LINES                56730000
559000              OR PS-SOCKET-ERROR.                                 56740000
559100*                                                                 56750000
559200*----------------------------------------------------------------*56760000
559300* CHECK AUDIT STATUS                                             *56770000
559400*----------------------------------------------------------------*56780000
559500 5000-AUDIT-STATUS-CHECK.                                         56790000
559600                                                                  56800000
           IF LBPTDA-PREPK-ID  > 0                                      56810000
559800        MOVE LBPTDA-PREPK-ID      TO SUT00015-PO-PREPK-ID         56820000
559900        MOVE +0                   TO SUT00015-PO-LNE-NBR          56830000
           ELSE                                                         56840000
559900        MOVE LBPTDA-PO-LNE-NBR    TO SUT00015-PO-LNE-NBR          56850000
559900        MOVE +0                   TO SUT00015-PO-PREPK-ID         56860000
560300     END-IF                                                       56870000
                                                                        56880000
                                                                        56890000
560400     EXEC SQL                                                     56900000
560500          SELECT AUD_STAT_CDE                                     56910000
560600          INTO  :SUT00015-AUD-STAT-CDE                            56920000
560700          FROM   SUT_PO_AUD_REQ                                   56930000
560800          WHERE  PO_NBR        = :LBPTDA-PO-NBR                   56940000
560900            AND  PO_LNE_NBR    = :SUT00015-PO-LNE-NBR             56950000
561000            AND  PO_PREPK_ID   = :SUT00015-PO-PREPK-ID            56960000
561100            AND  OPER_UNT_ID   = :LBPTDA-OPER-UNT-ID              56970000
561200**          AND  INBND_TRIP_ID = :LBPTDA-TRIP-ID                  56980000
561300            AND  RCVR_SEQ_NBR  = :LBPTDA-RCVR-SEQ-NBR             56990000
561400     END-EXEC.                                                    57000000
561500                                                                  57010000
561600     EVALUATE TRUE                                                57020000
561700         WHEN SQLCODE = ZERO                                      57030000
561800              IF SUT00015-AUD-STAT-CDE = 'P' OR 'N'               57040000
561900                 MOVE SPACE TO LBPTDA-CART-ACTN-CDE               57050000
562000                               PV-PREV-CART-ACTN-CDE              57060000
562100              ELSE                                                57070000
562200                IF SUT00015-AUD-STAT-CDE = 'F'                    57080000
562300                   MOVE 'R' TO LBPTDA-CART-ACTN-CDE               57090000
562400                               PV-PREV-CART-ACTN-CDE              57100000
562500                ELSE                                              57110000
                         IF SUT00015-AUD-STAT-CDE = 'I'                 57120000
562300                      MOVE 'U' TO LBPTDA-CART-ACTN-CDE            57130000
562400                               PV-PREV-CART-ACTN-CDE              57140000
                         ELSE                                           57150000
562600                      MOVE LBPTDA-CART-ACTN-CDE TO                57160000
562700                               PV-PREV-CART-ACTN-CDE              57170000
                         END-IF                                         57180000
562800                END-IF                                            57190000
562900              END-IF                                              57200000
563000         WHEN SQLCODE = +100                                      57210000
563100               MOVE LBPTDA-CART-ACTN-CDE TO                       57220000
563200                               PV-PREV-CART-ACTN-CDE              57230000
563300         WHEN OTHER                                               57240000
563400              STRING ' SUKRF707 - '            DELIMITED BY SIZE  57250000
563500                     'DK-BARCODE-NBR: '        DELIMITED BY SIZE  57260000
563600                      DK-BARCODE-NBR           DELIMITED BY SIZE  57270000
563700                                           INTO PV-CICS-MSG-AREA  57280000
563800              MOVE LENGTH OF PV-CICS-MSG-AREA                     57290000
563900                     TO PV-COMMAREA-LENGTH                        57300000
564000              PERFORM 9990-WRITE-CICS                             57310000
564100                                                                  57320000
564200             MOVE '5000-AUDIT-STATUS-CHECK'                       57330000
564300                             TO DP013-PARAGRAPH                   57340000
564400             MOVE 'SUKRF707 - GET LABEL STATUS CODE'              57350000
564500                             TO DP013-MESSAGE-TEXT(1)             57360000
564600             MOVE   SU001-OPER-UNT-ID       TO  PV-DISPLAY-OPER   57370000
564700             MOVE   LBPTDA-TRIP-ID          TO  PV-DISPLAY-TRIP   57380000
564800             MOVE   LBPTDA-LBL-PRT-BTCH-ID  TO  PV-DISPLAY-BATCH  57390000
564900             MOVE   LBPTDA-PO-NBR           TO  PV-DISPLAY-PO     57400000
565000             MOVE   LBPTDA-RCVR-SEQ-NBR     TO  PV-DISPLAY-RCVR   57410000
565100             MOVE   LBPTDA-PO-LNE-NBR       TO  PV-DISPLAY-LINE   57420000
565200             STRING 'OPER UNIT: '           DELIMITED BY SIZE     57430000
565300                    PV-DISPLAY-OPER         DELIMITED BY SIZE     57440000
565400                    '   DK-BARCODE-NBR: '   DELIMITED BY SIZE     57450000
565500                     DK-BARCODE-NBR         DELIMITED BY SIZE     57460000
565600                    '   BATCH NO: '         DELIMITED BY SIZE     57470000
565700                    PV-DISPLAY-BATCH        DELIMITED BY SIZE     57480000
565800                                       INTO DP013-MESSAGE-TEXT(2) 57490000
565900             STRING 'TRIP ID: '             DELIMITED BY SIZE     57500000
566000                    PV-DISPLAY-TRIP         DELIMITED BY SIZE     57510000
566100                    '   SCAC: '             DELIMITED BY SIZE     57520000
566200                    LBPTDA-OWNR-SCAC-ID     DELIMITED BY SIZE     57530000
566300                    '   TRLR: '             DELIMITED BY SIZE     57540000
566400                    LBPTDA-VEH-NBR          DELIMITED BY SIZE     57550000
566500                                       INTO DP013-MESSAGE-TEXT(3) 57560000
566600             STRING 'PO: '                  DELIMITED BY SIZE     57570000
566700                    PV-DISPLAY-PO           DELIMITED BY SIZE     57580000
566800                    '   RCVR: '             DELIMITED BY SIZE     57590000
566900                    PV-DISPLAY-RCVR         DELIMITED BY SIZE     57600000
567000                    '   LINE: '             DELIMITED BY SIZE     57610000
567100                    PV-DISPLAY-LINE         DELIMITED BY SIZE     57620000
567200                    '   OPER: '             DELIMITED BY SIZE     57630000
567300                    PV-DISPLAY-OPER         DELIMITED BY SIZE     57640000
567400                                       INTO DP013-MESSAGE-TEXT(4) 57650000
567500             MOVE SQLCA      TO DP013-SQLCA                       57660000
567600             MOVE 'SUT_PO_AUD_REQ'     TO DP013-DB2-TABLE-NAME(1) 57670000
567700             SET DP013-DB2-ABEND              TO TRUE             57680000
567800             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              57690000
567900             PERFORM DP014-0000-PROCESS-ABEND                     57700000
568000     END-EVALUATE.                                                57710000
568100*                                                                 57720000
568200*                                                                 57730000
568300*----------------------------------------------------------------*57740000
568400*  CONNECT THE PATH (SOCKET).                                    *57750000
568500*----------------------------------------------------------------*57760000
568600 5100-SEND-DATA-TO-LPMS.                                          57770000
568700                                                                  57780000
568800     MOVE LOW-VALUES              TO TCP-BUF2.                    57790000
568900     MOVE PC133-LABEL-RECORD      TO TCP-BUF2.                    57800000
569000     MOVE PC133-LABEL-RECORD      TO PV-DISPLAY-DOWNLOAD.         57810000
569100                                                                  57820000
569200*** BEGIN - FOR TESTING ONLY                                      57830000
569300*    STRING '  '                 DELIMITED BY SIZE                57840000
569400*           'SUKRF707 '          DELIMITED BY SIZE                57850000
569500*                                INTO PV-CICS-MSG-AREA.           57860000
569600*    PERFORM 9990-WRITE-CICS.                                     57870000
569700*    STRING ' '                   DELIMITED BY SIZE               57880000
569800*           PV-DISPLAY-DOWNLOAD-1 DELIMITED BY SIZE               57890000
569900*                                INTO PV-CICS-MSG-AREA.           57900000
570000*    PERFORM 9990-WRITE-CICS.                                     57910000
570100*    STRING ' '                   DELIMITED BY SIZE               57920000
570200*           PV-DISPLAY-DOWNLOAD-2 DELIMITED BY SIZE               57930000
570300*                                INTO PV-CICS-MSG-AREA.           57940000
570400*    PERFORM 9990-WRITE-CICS.                                     57950000
570500*    STRING ' '                   DELIMITED BY SIZE               57960000
570600*           PV-DISPLAY-DOWNLOAD-3 DELIMITED BY SIZE               57970000
570700*                                INTO PV-CICS-MSG-AREA.           57980000
570800*    PERFORM 9990-WRITE-CICS.                                     57990000
570900*** END - FOR TESTING ONLY                                        58000000
571000                                                                  58010000
571100*-----------------------------------------------------*           58020000
571200*                                                     *           58030000
571300*-----------------------------------------------------*           58040000
571400     CALL 'EZACIC04'                                              58050000
571500         USING DP081-TOASCII-TOKEN                                58060000
571600               TCP-BUF2                                           58070000
571700               DP081-TCPLENG.                                     58080000
571800                                                                  58090000
571900*-----------------------------------------------------*           58100000
572000*                                                     *           58110000
572100*-----------------------------------------------------*           58120000
572200*                                                                 58130000
572300*** BEGIN - FOR TESTING ONLY                                      58140000
572400*    MOVE  DP081-SOCK-ID    TO  PV-DISPLAY-SOCK-ID.               58150000
572500*    MOVE  DP081-FLAG       TO  PV-DISPLAY-FLAG.                  58160000
572600*    MOVE  DP081-NBR-BYTES  TO  PV-DISPLAY-NBR-BYTES.             58170000
572700*    STRING ' '                  DELIMITED BY SIZE                58180000
572800*           'SUKRF707-'          DELIMITED BY SIZE                58190000
572900*           'DP081-SEND-CMD-'    DELIMITED BY SIZE                58200000
573000*           DP081-SEND-CMD       DELIMITED BY SIZE                58210000
573100*           ' DP081-SOCK-ID-'    DELIMITED BY SIZE                58220000
573200*           PV-DISPLAY-SOCK-ID   DELIMITED BY SIZE                58230000
573300*           ' DP081-FLAG-'       DELIMITED BY SIZE                58240000
573400*           PV-DISPLAY-FLAG      DELIMITED BY SIZE                58250000
573500*                                INTO PV-CICS-MSG-AREA.           58260000
573600*    PERFORM 9990-WRITE-CICS.                                     58270000
573700*    STRING ' '                  DELIMITED BY SIZE                58280000
573800*           'SUKRF707-'          DELIMITED BY SIZE                58290000
573900*           ' DP081-NBR-BYTES'   DELIMITED BY SIZE                58300000
574000*           PV-DISPLAY-NBR-BYTES DELIMITED BY SIZE                58310000
574100*                                INTO PV-CICS-MSG-AREA.           58320000
574200*    PERFORM 9990-WRITE-CICS.                                     58330000
574300*** END - FOR TESTING ONLY                                        58340000
574400                                                                  58350000
574500     SET  DP081-OUT-OF-BAND-FLAG TO TRUE.                         58360000
574600                                                                  58370000
574700     CALL 'EZASOKET'                                              58380000
574800         USING DP081-SEND-CMD                                     58390000
574900               DP081-SOCK-ID                                      58400000
575000               DP081-FLAG                                         58410000
575100               DP081-NBR-BYTES                                    58420000
575200               TCP-BUF2                                           58430000
575300               DP081-ERRNO                                        58440000
575400               DP081-RETCODE.                                     58450000
575500                                                                  58460000
575600*-----------------------------------------------------*           58470000
575700*                                                     *           58480000
575800*-----------------------------------------------------*           58490000
575900                                                                  58500000
576000     IF  DP081-RETCODE < ZERO                                     58510000
576100         SET  PS-SOCKET-ERROR        TO TRUE                      58520000
576200         MOVE PC-COMMUNICATION-ERROR TO AMSGLNO                   58530000
576300         MOVE DP015-UNP-NUM-BRT-MDT  TO APRTIDA                   58540000
576400         MOVE -1                     TO APRTIDL                   58550000
576500         MOVE PC-CURRENT-PROGRAM-NAME TO DP081-TCP-IP-PGM-NAME    58560000
576600         SET  DP081-TCP-IP-SEND-TO-ERR TO TRUE                    58570000
576700         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      58580000
576800                                        RECEIVE-ERRNO             58590000
576900         MOVE DP081-RETCODE          TO RECEIVE-RETCODE           58600000
577000         MOVE SU001-PO               TO RECEIVE-RECEIVER          58610000
577100         MOVE SU001-RCVR-SEQ-NBR     TO RECEIVE-SEQ               58620000
577200         MOVE SU001-PO-LINE-NBR      TO RECEIVE-LINE              58630000
577300                                                                  58640000
577400         MOVE RECEIVE-ERR            TO PV-CICS-MSG-AREA          58650000
577500         PERFORM 9990-WRITE-CICS                                  58660000
577600                                                                  58670000
577700         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      58680000
577800         SET  DP013-OTHER-ABEND      TO TRUE                      58690000
577900         SET  DP013-ROLLBACK         TO TRUE                      58700000
578000                                                                  58710000
578100         MOVE '5100-SEND-DATA-TO-LPMS' TO DP013-PARAGRAPH         58720000
578200         MOVE DP081-TCP-IP-LOGGING-MSG TO DP013-MESSAGE-TEXT (1)  58730000
578300         MOVE DP081-NAME-FAMILY        TO PV-DISPLAY-FAMILY       58740000
578400         MOVE DP081-NAME-PORT          TO PV-DISPLAY-PORT         58750000
578500         MOVE DP081-NAME-IP-ADDR       TO PV-DISPLAY-IP-ADDR      58760000
578600         STRING ' SUKRF707 - '            DELIMITED BY SIZE       58770000
578700                'DP081-FAMILY='           DELIMITED BY SIZE       58780000
578800                PV-DISPLAY-FAMILY         DELIMITED BY SIZE       58790000
578900                ' DP081-PORT='            DELIMITED BY SIZE       58800000
579000                PV-DISPLAY-PORT           DELIMITED BY SIZE       58810000
579100                ' DP081-IP-ADDR='         DELIMITED BY SIZE       58820000
579200                PV-DISPLAY-IP-ADDR        DELIMITED BY SIZE       58830000
579300                                     INTO DP013-MESSAGE-TEXT (2)  58840000
579400         MOVE DP081-RETCODE            TO  PV-RETCODE             58850000
579500         MOVE DP081-ERRNO              TO  PV-ERRNO               58860000
579600         STRING ' EZASOKET CONNECT -'      DELIMITED BY SIZE      58870000
579700                ' DP081-RETCODE - '        DELIMITED BY SIZE      58880000
579800                PV-RETCODE                 DELIMITED BY SIZE      58890000
579900                ' DP081-ERRNO - '          DELIMITED BY SIZE      58900000
580000                PV-ERRNO                   DELIMITED BY SIZE      58910000
580100                                      INTO DP013-MESSAGE-TEXT (3) 58920000
580200        MOVE   LBPTDA-PO-NBR           TO  PV-DISPLAY-PO          58930000
580300        MOVE   LBPTDA-RCVR-SEQ-NBR     TO  PV-DISPLAY-RCVR        58940000
580400        MOVE   LBPTDA-PO-LNE-NBR       TO  PV-DISPLAY-LINE        58950000
580500        MOVE   SU001-OPER-UNT-ID       TO  PV-DISPLAY-OPER        58960000
580600        STRING ' PRTR ID: '                DELIMITED BY SIZE      58970000
580700               SU001-PRINTER-ID-USE        DELIMITED BY SIZE      58980000
580800               '   OPER: '                 DELIMITED BY SIZE      58990000
580900               PV-DISPLAY-OPER             DELIMITED BY SIZE      59000000
581000               '   PO: '                   DELIMITED BY SIZE      59010000
581100               PV-DISPLAY-PO               DELIMITED BY SIZE      59020000
581200               '   RCVR: '                 DELIMITED BY SIZE      59030000
581300               PV-DISPLAY-RCVR             DELIMITED BY SIZE      59040000
581400               '   LINE: '                 DELIMITED BY SIZE      59050000
581500               PV-DISPLAY-LINE             DELIMITED BY SIZE      59060000
581600                                      INTO DP013-MESSAGE-TEXT (4) 59070000
581700         PERFORM 9999-WRITE-CICS-LOG-MSG                          59080000
581800*                                                                 59090000
581900*** BEGIN - FOR TESTING ONLY                                      59100000
582000*    ELSE                                                         59110000
582100*        MOVE ' SUKRF707 - SEND SUCCESSFUL'                       59120000
582200*                                     TO PV-CICS-MSG-AREA         59130000
582300*        PERFORM 9990-WRITE-CICS                                  59140000
582400*        IF  PC133-LABEL-HDR                                      59150000
582500*            STRING ' SUKRF707 - '           DELIMITED BY SIZE    59160000
582600*                   PC133-HDR-PO-NBR         DELIMITED BY SIZE    59170000
582700*                   '-'                      DELIMITED BY SIZE    59180000
582800*                   PC133-HDR-RCVR-SEQ       DELIMITED BY SIZE    59190000
582900*                   '-'                      DELIMITED BY SIZE    59200000
583000*                   PC133-HDR-LINE-NBR       DELIMITED BY SIZE    59210000
583100*                   '  -  PRINTER ID-'       DELIMITED BY SIZE    59220000
583200*                   PC133-HDR-PRTR-ID        DELIMITED BY SIZE    59230000
583300*                                       INTO PV-CICS-MSG-AREA     59240000
583400*            PERFORM 9990-WRITE-CICS                              59250000
583500*        END-IF                                                   59260000
583600*** END - FOR TESTING ONLY                                        59270000
583700                                                                  59280000
583800     END-IF.                                                      59290000
583900                                                                  59300000
584000     IF SU001-PRINT-AND-PEEL                                      59310000
584100                                                                  59320000
584200        SET PS-START-RECEIVE TO TRUE                              59330000
584300        MOVE ZEROS   TO  PV-TCP-RET-LENGTH                        59340000
584400                         PV-TCP-REM-LENGTH                        59350000
584500                         PV-TCP-PRCSD-LENGTH                      59360000
584600        MOVE SPACES  TO  PT-TCP-RECEIVE-TABLE                     59370000
584700                         PT-TCP-ASSEMBLE-TABLE                    59380000
584800                                                                  59390000
584900        MOVE LOW-VALUES  TO  TCP-BUF2                             59400000
585000        MOVE 5           TO  DP081-TCPLENG                        59410000
585100                             DP081-NBR-BYTES                      59420000
585200                                                                  59430000
585300        SET  DP081-NO-FLAG  TO  TRUE                              59440000
585400        PERFORM 5200-CHECK-SOCKET-CONNECTION                      59450000
585500        IF  PS-NO-SOCKET-ERROR                                    59460000
585600            PERFORM 5401-RECEIVE-CONFIRM-FROM-LPMS                59470000
585700                UNTIL PS-COMP-RECEIVE OR                          59480000
585800                      PS-SOCKET-ERROR                             59490000
585900        END-IF                                                    59500000
586000     ELSE                                                         59510000
586100        PERFORM 5200-CHECK-SOCKET-CONNECTION                      59520000
586200        IF  PS-NO-SOCKET-ERROR                                    59530000
586300            PERFORM 5400-RECEIVE-CONFIRM-FROM-LPMS                59540000
586400        END-IF                                                    59550000
586500     END-IF.                                                      59560000
586600                                                                  59570000
586700* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 59580000
586800*  added Select socket command to check if socket connection    * 59590000
586900*  is still active.  if return code > 0 then socket is active   * 59600000
587000*  if return code = 0 socket is no longer active.               * 59610000
587100* DMH - 10/06/04 - BEGIN                                          59620000
587200* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 59630000
587300 5200-CHECK-SOCKET-CONNECTION.                                    59640000
587400                                                                  59650000
587500                                                                  59660000
587600* ZERO OUT ALL OUTPUT BIT MASKS FOR SELECT                        59670000
587700     PERFORM VARYING SOCKNO FROM 1 BY 1 UNTIL SOCKNO > SOCKETS    59680000
587800        MOVE '0' TO CHAR-ENTRY(SOCKNO)                            59690000
587900     END-PERFORM.                                                 59700000
588000     PERFORM 5210-CHAR-TO-BIT.                                    59710000
588100     MOVE BIT-MASK TO SELECT-RR-MASK.                             59720000
588200     MOVE BIT-MASK TO SELECT-RW-MASK.                             59730000
588300     MOVE BIT-MASK TO SELECT-RE-MASK.                             59740000
588400     MOVE BIT-MASK TO SELECT-EX-MASK.                             59750000
588500     MOVE BIT-MASK TO SELECT-WR-MASK.                             59760000
588600                                                                  59770000
588700* set all input bit masks for select to 1                         59780000
588800     PERFORM VARYING SOCKNO FROM 1 BY 1 UNTIL SOCKNO > SOCKETS    59790000
588900        MOVE '1' TO CHAR-ENTRY(SOCKNO)                            59800000
589000     END-PERFORM.                                                 59810000
589100     PERFORM 5210-CHAR-TO-BIT.                                    59820000
589200     MOVE BIT-MASK TO SELECT-RD-MASK.                             59830000
589300*                                                                 59840000
589400* ISSUE THE SELECT COMMAND ----------------------------           59850000
589500* SELECT WILL FLIP A BIT IN THE READ MASK TO '1' FOR ANY          59860000
589600* SOCKET THAT HAS DATA TO BE PROCESSED.                           59870000
589700*                                                                 59880000
589800                                                                  59890000
589900     MOVE 0 TO DP081-ERRNO.                                       59900000
590000     MOVE 0 TO DP081-RETCODE.                                     59910000
590100     CALL 'EZASOKET' USING DP081-SELECT-CMD                       59920000
590200         SELECT-NUMFDS SELECT-TIMEOUT                             59930000
590300         SELECT-RD-MASK SELECT-WR-MASK SELECT-EX-MASK             59940000
590400         SELECT-RR-MASK SELECT-RW-MASK SELECT-RE-MASK             59950000
590500         DP081-ERRNO DP081-RETCODE.                               59960000
590600                                                                  59970000
590700     IF DP081-RETCODE < 0                                         59980000
590800         SET  PS-SOCKET-ERROR        TO TRUE                      59990000
590900         MOVE PC-COMMUNICATION-ERROR TO AMSGLNO                   60000000
591000         MOVE DP015-UNP-NUM-BRT-MDT  TO APRTIDA                   60010000
591100         MOVE -1                     TO APRTIDL                   60020000
591200         MOVE PC-CURRENT-PROGRAM-NAME TO DP081-TCP-IP-PGM-NAME    60030000
591300         SET  DP081-TCP-IP-SEND-TO-ERR TO TRUE                    60040000
591400         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      60050000
591500                                        SOCKET-ERRNO              60060000
591600         MOVE DP081-RETCODE          TO SOCKET-RETCODE            60070000
591700         MOVE SU001-PO               TO SOCKET-RECEIVER           60080000
591800         MOVE SU001-RCVR-SEQ-NBR     TO SOCKET-SEQ                60090000
591900         MOVE SU001-PO-LINE-NBR      TO SOCKET-LINE               60100000
592000         MOVE 'SEE ERROR NO '        TO SOCKET-DESCR              60110000
592100                                                                  60120000
592200         MOVE SOCKET-SELECT-ERR      TO PV-CICS-MSG-AREA          60130000
592300         PERFORM 9990-WRITE-CICS                                  60140000
592400                                                                  60150000
592500         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      60160000
592600         SET  DP013-OTHER-ABEND      TO TRUE                      60170000
592700         SET  DP013-ROLLBACK         TO TRUE                      60180000
592800                                                                  60190000
592900         MOVE '5200-CHECK-SOCKET-CONN' TO DP013-PARAGRAPH         60200000
593000         MOVE DP081-TCP-IP-LOGGING-MSG TO DP013-MESSAGE-TEXT (1)  60210000
593100         MOVE DP081-NAME-FAMILY        TO PV-DISPLAY-FAMILY       60220000
593200         MOVE DP081-NAME-PORT          TO PV-DISPLAY-PORT         60230000
593300         MOVE DP081-NAME-IP-ADDR       TO PV-DISPLAY-IP-ADDR      60240000
593400         STRING ' SUKRF707 - '                                    60250000
593500                'DP081-FAMILY='                                   60260000
593600                PV-DISPLAY-FAMILY                                 60270000
593700                ' DP081-PORT='                                    60280000
593800                PV-DISPLAY-PORT                                   60290000
593900                ' DP081-IP-ADDR='                                 60300000
594000                PV-DISPLAY-IP-ADDR        DELIMITED BY SIZE       60310000
594100                                     INTO DP013-MESSAGE-TEXT (2)  60320000
594200         MOVE DP081-RETCODE            TO  PV-RETCODE             60330000
594300         MOVE DP081-ERRNO              TO  PV-ERRNO               60340000
594400         STRING ' EZASOKET CONNECT -'                             60350000
594500                ' DP081-RETCODE - '                               60360000
594600                PV-RETCODE                                        60370000
594700                ' DP081-ERRNO - '                                 60380000
594800                PV-ERRNO ' - '                                    60390000
594900                SOCKET-DESCR               DELIMITED BY SIZE      60400000
595000                                      INTO DP013-MESSAGE-TEXT (3) 60410000
595100        MOVE   LBPTDA-PO-NBR           TO  PV-DISPLAY-PO          60420000
595200        MOVE   LBPTDA-RCVR-SEQ-NBR     TO  PV-DISPLAY-RCVR        60430000
595300        MOVE   LBPTDA-PO-LNE-NBR       TO  PV-DISPLAY-LINE        60440000
595400        MOVE   SU001-OPER-UNT-ID       TO  PV-DISPLAY-OPER        60450000
595500        STRING ' PRTR ID: '                                       60460000
595600               SU001-PRINTER-ID-USE                               60470000
595700               '   OPER: '                                        60480000
595800               PV-DISPLAY-OPER                                    60490000
595900               '   PO: '                                          60500000
596000               PV-DISPLAY-PO                                      60510000
596100               '   RCVR: '                                        60520000
596200               PV-DISPLAY-RCVR                                    60530000
596300               '   LINE: '                                        60540000
596400               PV-DISPLAY-LINE             delimited by size      60550000
596500                                      INTO DP013-MESSAGE-TEXT (4) 60560000
596600         PERFORM 9999-WRITE-CICS-LOG-MSG                          60570000
596700     END-IF.                                                      60580000
596800                                                                  60590000
596900     IF DP081-RETCODE = 0                                         60600000
597000         SET  PS-SOCKET-ERROR        TO TRUE                      60610000
597100         MOVE PC-COMMUNICATION-ERROR TO AMSGLNO                   60620000
597200         MOVE DP015-UNP-NUM-BRT-MDT  TO APRTIDA                   60630000
597300         MOVE -1                     TO APRTIDL                   60640000
597400         MOVE PC-CURRENT-PROGRAM-NAME TO DP081-TCP-IP-PGM-NAME    60650000
597500         SET  DP081-TCP-IP-SEND-TO-ERR TO TRUE                    60660000
597600         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      60670000
597700                                        SOCKET-ERRNO              60680000
597800         MOVE DP081-RETCODE          TO SOCKET-RETCODE            60690000
597900         MOVE SU001-PO               TO SOCKET-RECEIVER           60700000
598000         MOVE SU001-RCVR-SEQ-NBR     TO SOCKET-SEQ                60710000
598100         MOVE SU001-PO-LINE-NBR      TO SOCKET-LINE               60720000
598200         MOVE 'SOCKET TIMEOUT'       TO SOCKET-DESCR              60730000
598300                                                                  60740000
598400         MOVE SOCKET-SELECT-ERR      TO PV-CICS-MSG-AREA          60750000
598500         PERFORM 9990-WRITE-CICS                                  60760000
598600                                                                  60770000
598700         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      60780000
598800         SET  DP013-OTHER-ABEND      TO TRUE                      60790000
598900         SET  DP013-ROLLBACK         TO TRUE                      60800000
599000                                                                  60810000
599100         MOVE '5200-CHECK-SOCKET-CONN' TO DP013-PARAGRAPH         60820000
599200         MOVE DP081-TCP-IP-LOGGING-MSG TO DP013-MESSAGE-TEXT (1)  60830000
599300         MOVE DP081-NAME-FAMILY        TO PV-DISPLAY-FAMILY       60840000
599400         MOVE DP081-NAME-PORT          TO PV-DISPLAY-PORT         60850000
599500         MOVE DP081-NAME-IP-ADDR       TO PV-DISPLAY-IP-ADDR      60860000
599600         STRING ' SUKRF707 - '                                    60870000
599700                'DP081-FAMILY='                                   60880000
599800                PV-DISPLAY-FAMILY                                 60890000
599900                ' DP081-PORT='                                    60900000
600000                PV-DISPLAY-PORT                                   60910000
600100                ' DP081-IP-ADDR='                                 60920000
600200                PV-DISPLAY-IP-ADDR        DELIMITED BY SIZE       60930000
600300                                     INTO DP013-MESSAGE-TEXT (2)  60940000
600400         MOVE DP081-RETCODE            TO  PV-RETCODE             60950000
600500         MOVE DP081-ERRNO              TO  PV-ERRNO               60960000
600600         STRING ' EZASOKET CONNECT -'                             60970000
600700                ' DP081-RETCODE - '                               60980000
600800                PV-RETCODE                                        60990000
600900                ' DP081-ERRNO - '                                 61000000
601000                PV-ERRNO ' - '                                    61010000
601100                SOCKET-DESCR               DELIMITED BY SIZE      61020000
601200                                      INTO DP013-MESSAGE-TEXT (3) 61030000
601300        MOVE   LBPTDA-PO-NBR           TO  PV-DISPLAY-PO          61040000
601400        MOVE   LBPTDA-RCVR-SEQ-NBR     TO  PV-DISPLAY-RCVR        61050000
601500        MOVE   LBPTDA-PO-LNE-NBR       TO  PV-DISPLAY-LINE        61060000
601600        MOVE   SU001-OPER-UNT-ID       TO  PV-DISPLAY-OPER        61070000
601700        STRING ' PRTR ID: '                                       61080000
601800               SU001-PRINTER-ID-USE                               61090000
601900               '   OPER: '                                        61100000
602000               PV-DISPLAY-OPER                                    61110000
602100               '   PO: '                                          61120000
602200               PV-DISPLAY-PO                                      61130000
602300               '   RCVR: '                                        61140000
602400               PV-DISPLAY-RCVR                                    61150000
602500               '   LINE: '                                        61160000
602600               PV-DISPLAY-LINE             delimited by size      61170000
602700                                      INTO DP013-MESSAGE-TEXT (4) 61180000
602800         PERFORM 9999-WRITE-CICS-LOG-MSG                          61190000
602900     END-IF.                                                      61200000
603000                                                                  61210000
603100***************************************************************   61220000
603200* CHAR-TO-BIT                                                 *   61230000
603300* CONVERT THE CHARACTER ARRAY TO A SELECT BIT MASK SO THAT THE*   61240000
603400* COBOL PROGRAM CAN WRITE IT.                                 *   61250000
603500***************************************************************   61260000
603600 5210-CHAR-TO-BIT.                                                61270000
603700*                                                                 61280000
603800* CHAR-TO-BIT                                                     61290000
603900* CONVERT THE CHARACTER ARRAY TO A SELECT BIT MASK SO THAT THE    61300000
604000* COBOL PROGRAM CAN WRITE IT.                                     61310000
604100*                                                                 61320000
604200     CALL 'EZACIC06' USING BITMASK-TOKEN CTOB                     61330000
604300          BIT-MASK CHAR-MASK BIT-MASK-LENGTH EZRETC               61340000
604400     IF  EZRETC < 0 THEN                                          61350000
604500         MOVE '!EZCIC06 - CTOB-EXCP ' TO PV-CICS-MSG-AREA         61360000
604600         MOVE LENGTH OF PV-CICS-MSG-AREA TO PV-COMMAREA-LENGTH    61370000
604700                                                                  61380000
604800         EXEC CICS                                                61390000
604900             WRITEQ TD                                            61400000
605000                 QUEUE   ('CSSL')                                 61410000
605100                 FROM    (PV-CICS-MSG-AREA)                       61420000
605200                 LENGTH  (PV-COMMAREA-LENGTH)                     61430000
605300                 RESP    (PV-CICS-RESPONSE)                       61440000
605400         END-EXEC                                                 61450000
605500                                                                  61460000
605600         SET  PS-SOCKET-ERROR        TO TRUE                      61470000
605700         MOVE PC-COMMUNICATION-ERROR TO AMSGLNO                   61480000
605800         MOVE DP015-UNP-NUM-BRT-MDT  TO APRTIDA                   61490000
605900         MOVE -1                     TO APRTIDL                   61500000
606000         MOVE PC-CURRENT-PROGRAM-NAME TO DP081-TCP-IP-PGM-NAME    61510000
606100         SET  DP081-TCP-IP-SEND-TO-ERR TO TRUE                    61520000
606200         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      61530000
606300                                        SOCKET-ERRNO              61540000
606400         MOVE EZRETC                 TO SOCKET-RETCODE            61550000
606500         MOVE SU001-PO               TO SOCKET-RECEIVER           61560000
606600         MOVE SU001-RCVR-SEQ-NBR     TO SOCKET-SEQ                61570000
606700         MOVE SU001-PO-LINE-NBR      TO SOCKET-LINE               61580000
606800         MOVE 'SEE RETURN CODE'      TO SOCKET-DESCR              61590000
606900                                                                  61600000
607000         MOVE SOCKET-SELECT-ERR      TO PV-CICS-MSG-AREA          61610000
607100         PERFORM 9990-WRITE-CICS                                  61620000
607200                                                                  61630000
607300         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      61640000
607400         SET  DP013-OTHER-ABEND      TO TRUE                      61650000
607500         SET  DP013-ROLLBACK         TO TRUE                      61660000
607600                                                                  61670000
607700         MOVE '5210-CHAR-TO-BIT'       TO DP013-PARAGRAPH         61680000
607800         MOVE DP081-TCP-IP-LOGGING-MSG TO DP013-MESSAGE-TEXT (1)  61690000
607900         MOVE DP081-NAME-FAMILY        TO PV-DISPLAY-FAMILY       61700000
608000         MOVE DP081-NAME-PORT          TO PV-DISPLAY-PORT         61710000
608100         MOVE DP081-NAME-IP-ADDR       TO PV-DISPLAY-IP-ADDR      61720000
608200         STRING ' SUKRF707 - '                                    61730000
608300                'DP081-FAMILY='                                   61740000
608400                PV-DISPLAY-FAMILY                                 61750000
608500                ' DP081-PORT='                                    61760000
608600                PV-DISPLAY-PORT                                   61770000
608700                ' DP081-IP-ADDR='                                 61780000
608800                PV-DISPLAY-IP-ADDR        DELIMITED BY SIZE       61790000
608900                                     INTO DP013-MESSAGE-TEXT (2)  61800000
609000         MOVE EZRETC                   TO  PV-RETCODE             61810000
609100         MOVE DP081-ERRNO              TO  PV-ERRNO               61820000
609200         STRING ' EZASOKET CONNECT -'                             61830000
609300                ' DP081-RETCODE - '                               61840000
609400                PV-RETCODE                                        61850000
609500                ' DP081-ERRNO - '                                 61860000
609600                PV-ERRNO ' - '                                    61870000
609700                SOCKET-DESCR               DELIMITED BY SIZE      61880000
609800                                      INTO DP013-MESSAGE-TEXT (3) 61890000
609900        MOVE   LBPTDA-PO-NBR           TO  PV-DISPLAY-PO          61900000
610000        MOVE   LBPTDA-RCVR-SEQ-NBR     TO  PV-DISPLAY-RCVR        61910000
610100        MOVE   LBPTDA-PO-LNE-NBR       TO  PV-DISPLAY-LINE        61920000
610200        MOVE   SU001-OPER-UNT-ID       TO  PV-DISPLAY-OPER        61930000
610300        STRING ' PRTR ID: '                                       61940000
610400               SU001-PRINTER-ID-USE                               61950000
610500               '   OPER: '                                        61960000
610600               PV-DISPLAY-OPER                                    61970000
610700               '   PO: '                                          61980000
610800               PV-DISPLAY-PO                                      61990000
610900               '   RCVR: '                                        62000000
611000               PV-DISPLAY-RCVR                                    62010000
611100               '   LINE: '                                        62020000
611200               PV-DISPLAY-LINE             delimited by size      62030000
611300                                      INTO DP013-MESSAGE-TEXT (4) 62040000
611400         PERFORM 9999-WRITE-CICS-LOG-MSG                          62050000
611500     END-IF.                                                      62060000
611600                                                                  62070000
611700* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 62080000
611800* DMH - 10/06/04 - END                                            62090000
611900                                                                  62100000
612000                                                                  62110000
612100*----------------------------------------------------------------*62120000
612200*  RECEIVE CONFIRMATION BACK FROM AL SYSTEMS THAT THEY RECEIVED  *62130000
612300*  ALL RECORDS CORRECTLY.                                        *62140000
612400*----------------------------------------------------------------*62150000
612500 5400-RECEIVE-CONFIRM-FROM-LPMS.                                  62160000
612600                                                                  62170000
612700*** BEGIN - FOR TESTING ONLY                                      62180000
612800*    MOVE ' SUKRF707 - START OF RECEIVE CONFIRM FROM LPMS'        62190000
612900*                                        TO PV-CICS-MSG-AREA.     62200000
613000*    PERFORM 9990-WRITE-CICS.                                     62210000
613100*** END - FOR TESTING ONLY                                        62220000
613200                                                                  62230000
613300                                                                  62240000
613400     MOVE LOW-VALUES  TO  TCP-BUF2.                               62250000
613500     MOVE 5           TO  DP081-TCPLENG                           62260000
613600                          DP081-NBR-BYTES.                        62270000
613700                                                                  62280000
613800     SET  DP081-NO-FLAG  TO  TRUE.                                62290000
613900                                                                  62300000
614000     CALL 'EZASOKET'                                              62310000
614100         USING DP081-RECV-CMD                                     62320000
614200               DP081-SOCK-ID                                      62330000
614300               DP081-FLAG                                         62340000
614400               DP081-NBR-BYTES                                    62350000
614500               TCP-BUF                                            62360000
614600               DP081-ERRNO                                        62370000
614700               DP081-RETCODE.                                     62380000
614800                                                                  62390000
614900*-----------------------------------------------------*           62400000
615000*                                                     *           62410000
615100*-----------------------------------------------------*           62420000
615200     CALL 'EZACIC05'                                              62430000
615300         USING DP081-TOEBCDIC-TOKEN                               62440000
615400               TCP-BUF                                            62450000
615500               DP081-TCPLENG.                                     62460000
615600                                                                  62470000
615700     IF  DP081-RETCODE < ZERO                                     62480000
615800         SET  PS-SOCKET-ERROR         TO TRUE                     62490000
615900         MOVE PC-COMMUNICATION-ERROR  TO AMSGLNO                  62500000
616000         MOVE DP015-UNP-NUM-BRT-MDT   TO APRTIDA                  62510000
616100         MOVE -1                      TO APRTIDL                  62520000
616200         MOVE PC-CURRENT-PROGRAM-NAME TO DP081-TCP-IP-PGM-NAME    62530000
616300         SET  DP081-TCP-IP-READ-ERR  TO TRUE                      62540000
616400         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      62550000
616500         SET  DP013-OTHER-ABEND      TO TRUE                      62560000
616600         SET  DP013-ROLLBACK         TO TRUE                      62570000
616700                                                                  62580000
616800         MOVE '5400-RECEIVE-CONFIRM-FROM-LPMS'                    62590000
616900                                     TO DP013-PARAGRAPH           62600000
617000         MOVE DP081-TCP-IP-LOGGING-MSG TO DP013-MESSAGE-TEXT (1)  62610000
617100         MOVE DP081-NAME-FAMILY        TO PV-DISPLAY-FAMILY       62620000
617200         MOVE DP081-NAME-PORT          TO PV-DISPLAY-PORT         62630000
617300         MOVE DP081-NAME-IP-ADDR       TO PV-DISPLAY-IP-ADDR      62640000
617400         STRING ' SUKRF707 - '            DELIMITED BY SIZE       62650000
617500                'DP081-FAMILY='           DELIMITED BY SIZE       62660000
617600                PV-DISPLAY-FAMILY         DELIMITED BY SIZE       62670000
617700                ' DP081-PORT='            DELIMITED BY SIZE       62680000
617800                PV-DISPLAY-PORT           DELIMITED BY SIZE       62690000
617900                ' DP081-IP-ADDR='         DELIMITED BY SIZE       62700000
618000                PV-DISPLAY-IP-ADDR        DELIMITED BY SIZE       62710000
618100                                     INTO DP013-MESSAGE-TEXT (2)  62720000
618200         MOVE DP081-RETCODE            TO  PV-RETCODE             62730000
618300         MOVE DP081-ERRNO              TO  PV-ERRNO               62740000
618400         STRING ' EZASOKET CONNECT -'      DELIMITED BY SIZE      62750000
618500                ' DP081-RETCODE - '        DELIMITED BY SIZE      62760000
618600                PV-RETCODE                 DELIMITED BY SIZE      62770000
618700                ' DP081-ERRNO - '          DELIMITED BY SIZE      62780000
618800                PV-ERRNO                   DELIMITED BY SIZE      62790000
618900                                      INTO DP013-MESSAGE-TEXT (3) 62800000
619000        MOVE   LBPTDA-PO-NBR           TO  PV-DISPLAY-PO          62810000
619100        MOVE   LBPTDA-RCVR-SEQ-NBR     TO  PV-DISPLAY-RCVR        62820000
619200        MOVE   LBPTDA-PO-LNE-NBR       TO  PV-DISPLAY-LINE        62830000
619300        MOVE   SU001-OPER-UNT-ID       TO  PV-DISPLAY-OPER        62840000
619400        STRING ' PRTR ID: '                DELIMITED BY SIZE      62850000
619500               SU001-PRINTER-ID-USE        DELIMITED BY SIZE      62860000
619600               '   OPER: '                 DELIMITED BY SIZE      62870000
619700               PV-DISPLAY-OPER             DELIMITED BY SIZE      62880000
619800               '   PO: '                   DELIMITED BY SIZE      62890000
619900               PV-DISPLAY-PO               DELIMITED BY SIZE      62900000
620000               '   RCVR: '                 DELIMITED BY SIZE      62910000
620100               PV-DISPLAY-RCVR             DELIMITED BY SIZE      62920000
620200               '   LINE: '                 DELIMITED BY SIZE      62930000
620300               PV-DISPLAY-LINE             DELIMITED BY SIZE      62940000
620400                                      INTO DP013-MESSAGE-TEXT (4) 62950000
620500         PERFORM 9999-WRITE-CICS-LOG-MSG                          62960000
620600                                                                  62970000
620700*** BEGIN - FOR TESTING ONLY                                      62980000
620800*    ELSE                                                         62990000
620900*        MOVE ' SUKRF707 - CONFIRM SUCCESSFUL'                    63000000
621000*                                            TO PV-CICS-MSG-AREA  63010000
621100*        PERFORM 9990-WRITE-CICS                                  63020000
621200*** END - FOR TESTING ONLY                                        63030000
621300                                                                  63040000
621400     END-IF.                                                      63050000
621500                                                                  63060000
621600*-----------------------------------------------------*           63070000
621700*                                                     *           63080000
621800*-----------------------------------------------------*           63090000
621900     MOVE TCP-BUF TO PC133-LABEL-RECORD.                          63100000
622000                                                                  63110000
622100     IF  NOT PC133-SEND-SUCCESSFUL                                63120000
622200         PERFORM 4340-CLOSE-SOCKET                                63130000
622300         MOVE PC-CURRENT-PROGRAM-NAME TO DP081-TCP-IP-PGM-NAME    63140000
622400         SET  PS-SOCKET-ERROR         TO TRUE                     63150000
622500         MOVE PC-COMMUNICATION-ERROR  TO AMSGLNO                  63160000
622600         MOVE DP015-UNP-NUM-BRT-MDT   TO APRTIDA                  63170000
622700         MOVE -1                      TO APRTIDL                  63180000
622800         SET  DP081-TCP-IP-READ-ERR  TO TRUE                      63190000
622900         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      63200000
623000                                        RECEIVE-ERRNO             63210000
623100         MOVE SU001-PO               TO RECEIVE-RECEIVER          63220000
623200         MOVE SU001-RCVR-SEQ-NBR     TO RECEIVE-SEQ               63230000
623300         MOVE SU001-PO-LINE-NBR      TO RECEIVE-LINE              63240000
623400                                                                  63250000
623500         MOVE RECEIVE-ERR            TO PV-CICS-MSG-AREA          63260000
623600         PERFORM 9990-WRITE-CICS                                  63270000
623700         STRING '  '                 DELIMITED BY SIZE            63280000
623800                PC133-LABEL-RECORD   DELIMITED BY SIZE            63290000
623900                                     INTO PV-CICS-MSG-AREA        63300000
624000         PERFORM 9990-WRITE-CICS                                  63310000
624100                                                                  63320000
624200         PERFORM 4740-GET-LPMS-RETURN                             63330000
624300                                                                  63340000
624400         EVALUATE TRUE                                            63350000
624500             WHEN  PC133-INVALID-PRINTER                          63360000
624600               STRING ' SUKRF707 -'           DELIMITED BY SIZE   63370000
624700                 PC138-MSG-INVALID-PRTR       DELIMITED BY SIZE   63380000
624800                                          INTO PV-CICS-MSG-AREA   63390000
624900             WHEN  PC133-DTL-WITHOUT-HDR                          63400000
625000               STRING ' SUKRF707 -'           DELIMITED BY SIZE   63410000
625100                 PC138-MSG-DTL-WO-HDR         DELIMITED BY SIZE   63420000
625200                                          INTO PV-CICS-MSG-AREA   63430000
625300             WHEN  PC133-TLR-WITHOUT-HDR-DTL                      63440000
625400               STRING ' SUKRF707 -'           DELIMITED BY SIZE   63450000
625500                 PC138-MSG-TLR-WO-HDR-DTL     DELIMITED BY SIZE   63460000
625600                                          INTO PV-CICS-MSG-AREA   63470000
625700             WHEN  PC133-TLR-CNT-NOT-MTCH-DTL                     63480000
625800               STRING ' SUKRF707 -'           DELIMITED BY SIZE   63490000
625900                 PC138-MSG-TLR-CNT-NOT-DTL    DELIMITED BY SIZE   63500000
626000                                          INTO PV-CICS-MSG-AREA   63510000
626100             WHEN  PC133-TRAN-IDS-NOT-MTCH                        63520000
626200               STRING ' SUKRF707 -'           DELIMITED BY SIZE   63530000
626300                 PC138-MSG-TRAN-IDS-NOT-MTCH  DELIMITED BY SIZE   63540000
626400                                          INTO PV-CICS-MSG-AREA   63550000
626500             WHEN  PC133-DTL-LNGTH-NOT-MTCH                       63560000
626600               STRING ' SUKRF707 -'           DELIMITED BY SIZE   63570000
626700                 PC138-MSG-DTL-LNGTH-NOT-MTCH DELIMITED BY SIZE   63580000
626800                                          INTO PV-CICS-MSG-AREA   63590000
626900             WHEN  PC133-DISK-ERROR                               63600000
627000               STRING ' SUKRF707 -'           DELIMITED BY SIZE   63610000
627100                 PC138-MSG-DISK-ERROR         DELIMITED BY SIZE   63620000
627200                                          INTO PV-CICS-MSG-AREA   63630000
627300             WHEN  PC133-TIMEOUT                                  63640000
627400               STRING ' SUKRF707 -'           DELIMITED BY SIZE   63650000
627500                 PC138-MSG-TIMEOUT            DELIMITED BY SIZE   63660000
627600                                          INTO PV-CICS-MSG-AREA   63670000
627700             WHEN  PC133-ADDR-NOT-FND                             63680000
627800               STRING ' SUKRF707 -'           DELIMITED BY SIZE   63690000
627900                 PC138-MSG-ADDR-NOT-FND       DELIMITED BY SIZE   63700000
628000                                          INTO PV-CICS-MSG-AREA   63710000
628100             WHEN  PC133-INVALID-PACKET                           63720000
628200               STRING ' SUKRF707 -'           DELIMITED BY SIZE   63730000
628300                 PC138-MSG-INVALID-PACKET     DELIMITED BY SIZE   63740000
628400                                          INTO PV-CICS-MSG-AREA   63750000
628500         END-EVALUATE                                             63760000
628600         PERFORM 9990-WRITE-CICS                                  63770000
628700                                                                  63780000
628800         SET  DP013-OTHER-ABEND      TO TRUE                      63790000
628900         SET  DP013-ROLLBACK         TO TRUE                      63800000
629000                                                                  63810000
629100         MOVE '5400-RECEIVE-CONFIRM-FROM-LPMS'                    63820000
629200                                     TO DP013-PARAGRAPH           63830000
629300         STRING ' SUKRF707 - '           DELIMITED BY SIZE        63840000
629400                DP081-TCP-IP-LOGGING-MSG DELIMITED BY SIZE        63850000
629500                                     INTO DP013-MESSAGE-TEXT (1)  63860000
629600         PERFORM 9999-WRITE-CICS-LOG-MSG                          63870000
629700*** BEGIN - FOR TESTING ONLY                                      63880000
629800*    ELSE                                                         63890000
629900*        MOVE ' SUKRF707 - CONFIRM SUCCESSFUL'                    63900000
630000*                                    TO PV-CICS-MSG-AREA          63910000
630100*        PERFORM 9990-WRITE-CICS                                  63920000
630200*** END - FOR TESTING ONLY                                        63930000
630300     END-IF.                                                      63940000
630400                                                                  63950000
630500*----------------------------------------------------------------*63960000
630600*  RECEIVE CONFIRMATION BACK AND PROCESS ANY PARTIAL DATA SENT   *63970000
630700*----------------------------------------------------------------*63980000
630800 5401-RECEIVE-CONFIRM-FROM-LPMS.                                  63990000
630900                                                                  64000000
631000*** BEGIN - FOR TESTING ONLY                                      64010000
631100*    MOVE ' SUKRF707 - START OF RECEIVE CONFIRM FROM LPMS'        64020000
631200*                                        TO PV-CICS-MSG-AREA.     64030000
631300*    PERFORM 9990-WRITE-CICS.                                     64040000
631400*** END - FOR TESTING ONLY                                        64050000
631500                                                                  64060000
631600                                                                  64070000
631700     CALL 'EZASOKET'                                              64080000
631800         USING DP081-RECV-CMD                                     64090000
631900               DP081-SOCK-ID                                      64100000
632000               DP081-FLAG                                         64110000
632100               DP081-NBR-BYTES                                    64120000
632200               TCP-BUF                                            64130000
632300               DP081-ERRNO                                        64140000
632400               DP081-RETCODE.                                     64150000
632500*-----------------------------------------------------*           64160000
632600*                                                     *           64170000
632700*-----------------------------------------------------*           64180000
632800     CALL 'EZACIC05'                                              64190000
632900         USING DP081-TOEBCDIC-TOKEN                               64200000
633000               TCP-BUF                                            64210000
633100               DP081-TCPLENG.                                     64220000
633200                                                                  64230000
633300     IF  DP081-RETCODE < ZERO                                     64240000
633400         SET  PS-SOCKET-ERROR         TO TRUE                     64250000
633500         MOVE PC-COMMUNICATION-ERROR  TO AMSGLNO                  64260000
633600         MOVE DP015-UNP-NUM-BRT-MDT   TO APRTIDA                  64270000
633700         MOVE -1                      TO APRTIDL                  64280000
633800         PERFORM 6000-FORMAT-ABEND                                64290000
633900*** BEGIN - FOR TESTING ONLY                                      64300000
634000*    ELSE                                                         64310000
634100*        MOVE ' SUKRF707 - CONFIRM SUCCESSFUL'                    64320000
634200*                                            TO PV-CICS-MSG-AREA  64330000
634300*        PERFORM 9990-WRITE-CICS                                  64340000
634400*** END - FOR TESTING ONLY                                        64350000
634500                                                                  64360000
634600     ELSE                                                         64370000
634700             MOVE DP081-RETCODE TO PV-TCP-RET-LENGTH              64380000
634800             IF  PV-TCP-RET-LENGTH = PV-TCP-EXP-LENGTH            64390000
634900                 SET PS-COMP-RECEIVE TO TRUE                      64400000
635000             ELSE                                                 64410000
635100                 IF  PV-TCP-RET-LENGTH > DP081-NBR-BYTES          64420000
635200                     PERFORM 4340-CLOSE-SOCKET                    64430000
635300                     INITIALIZE PV-CICS-MSG-AREA                  64440000
635400                     MOVE DP081-RETCODE TO PV-RETCODE             64450000
635500                     MOVE DP081-NBR-BYTES TO PV-TCPLENG           64460000
635600                     MOVE DP081-ERRNO   TO PV-ERRNO               64470000
635700                     STRING ' SUKRF707:'                          64480000
635800                          'SOCKET LENGTH ERROR #1'                64490000
635900                          ' RETCODE='                             64500000
636000                          PV-RETCODE                              64510000
636100                          ' DP081-NBR-BYTES='                     64520000
636200                          PV-TCPLENG                              64530000
636300                          ' ERRNO='                               64540000
636400                          PV-ERRNO                                64550000
636500                         DELIMITED BY SIZE INTO PV-CICS-MSG-AREA  64560000
636600                     PERFORM 9990-WRITE-CICS                      64570000
636700*                    BEGIN OF TRANSLATE ASCII TO EBCDIC           64580000
636800                     CALL 'EZACIC05'                              64590000
636900                         USING  DP081-TOEBCDIC-TOKEN              64600000
637000                                TCP-BUF2                          64610000
637100                                DP081-NBR-BYTES                   64620000
637200*                    END OF TRANSLATE ASCII TO EBCDIC             64630000
637300                                                                  64640000
637400                                                                  64650000
637500                     MOVE PC-CURRENT-PROGRAM-NAME TO              64660000
637600                                            DP081-TCP-IP-PGM-NAME 64670000
637700                     SET  DP081-TCP-IP-READ-ERR TO TRUE           64680000
637800                     MOVE DP081-ERRNO         TO                  64690000
637900                                             DP081-TCP-IP-ERR-NBR 64700000
638000                     SET  DP013-OTHER-ABEND   TO TRUE             64710000
638100                     SET  DP013-NO-ROLLBACK   TO TRUE             64720000
638200                     MOVE '5401-RECEIVE-CONFIRM'                  64730000
638300                         TO DP013-PARAGRAPH                       64740000
638400                     MOVE DP081-TCP-IP-LOGGING-MSG TO             64750000
638500                          DP013-MESSAGE-TEXT (1)                  64760000
638600                     PERFORM 9999-WRITE-CICS-LOG-MSG              64770000
638700                 ELSE                                             64780000
638800                     PERFORM 6100-PROCESS-PARTIAL-TCP             64790000
638900                 END-IF                                           64800000
639000             END-IF                                               64810000
639100     END-IF.                                                      64820000
639200                                                                  64830000
639300*-----------------------------------------------------*           64840000
639400*                                                     *           64850000
639500*-----------------------------------------------------*           64860000
639600     IF PS-COMP-RECEIVE                                           64870000
639700         MOVE TCP-BUF TO PC133-LABEL-RECORD                       64880000
639800                                                                  64890000
639900     IF  NOT PC133-SEND-SUCCESSFUL                                64900000
640000         PERFORM 4340-CLOSE-SOCKET                                64910000
640100         MOVE PC-CURRENT-PROGRAM-NAME TO DP081-TCP-IP-PGM-NAME    64920000
640200         SET  PS-SOCKET-ERROR         TO TRUE                     64930000
640300         MOVE PC-COMMUNICATION-ERROR  TO AMSGLNO                  64940000
640400         MOVE DP015-UNP-NUM-BRT-MDT   TO APRTIDA                  64950000
640500         MOVE -1                      TO APRTIDL                  64960000
640600         SET  DP081-TCP-IP-READ-ERR  TO TRUE                      64970000
640700         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      64980000
640800                                        RECEIVE-ERRNO             64990000
640900         MOVE SU001-PO               TO RECEIVE-RECEIVER          65000000
641000         MOVE SU001-RCVR-SEQ-NBR     TO RECEIVE-SEQ               65010000
641100         MOVE SU001-PO-LINE-NBR      TO RECEIVE-LINE              65020000
641200                                                                  65030000
641300         MOVE RECEIVE-ERR            TO PV-CICS-MSG-AREA          65040000
641400         PERFORM 9990-WRITE-CICS                                  65050000
641500         STRING '  '                 DELIMITED BY SIZE            65060000
641600                PC133-LABEL-RECORD   DELIMITED BY SIZE            65070000
641700                                     INTO PV-CICS-MSG-AREA        65080000
641800         PERFORM 9990-WRITE-CICS                                  65090000
641900                                                                  65100000
642000         PERFORM 4740-GET-LPMS-RETURN                             65110000
642100                                                                  65120000
642200         EVALUATE TRUE                                            65130000
642300             WHEN  PC133-INVALID-PRINTER                          65140000
642400               STRING ' SUKRF707 -'           DELIMITED BY SIZE   65150000
642500                 PC138-MSG-INVALID-PRTR       DELIMITED BY SIZE   65160000
642600                                          INTO PV-CICS-MSG-AREA   65170000
642700             WHEN  PC133-DTL-WITHOUT-HDR                          65180000
642800               STRING ' SUKRF707 -'           DELIMITED BY SIZE   65190000
642900                 PC138-MSG-DTL-WO-HDR         DELIMITED BY SIZE   65200000
643000                                          INTO PV-CICS-MSG-AREA   65210000
643100             WHEN  PC133-TLR-WITHOUT-HDR-DTL                      65220000
643200               STRING ' SUKRF707 -'           DELIMITED BY SIZE   65230000
643300                 PC138-MSG-TLR-WO-HDR-DTL     DELIMITED BY SIZE   65240000
643400                                          INTO PV-CICS-MSG-AREA   65250000
643500             WHEN  PC133-TLR-CNT-NOT-MTCH-DTL                     65260000
643600               STRING ' SUKRF707 -'           DELIMITED BY SIZE   65270000
643700                 PC138-MSG-TLR-CNT-NOT-DTL    DELIMITED BY SIZE   65280000
643800                                          INTO PV-CICS-MSG-AREA   65290000
643900             WHEN  PC133-TRAN-IDS-NOT-MTCH                        65300000
644000               STRING ' SUKRF707 -'           DELIMITED BY SIZE   65310000
644100                 PC138-MSG-TRAN-IDS-NOT-MTCH  DELIMITED BY SIZE   65320000
644200                                          INTO PV-CICS-MSG-AREA   65330000
644300             WHEN  PC133-DTL-LNGTH-NOT-MTCH                       65340000
644400               STRING ' SUKRF707 -'           DELIMITED BY SIZE   65350000
644500                 PC138-MSG-DTL-LNGTH-NOT-MTCH DELIMITED BY SIZE   65360000
644600                                          INTO PV-CICS-MSG-AREA   65370000
644700             WHEN  PC133-DISK-ERROR                               65380000
644800               STRING ' SUKRF707 -'           DELIMITED BY SIZE   65390000
644900                 PC138-MSG-DISK-ERROR         DELIMITED BY SIZE   65400000
645000                                          INTO PV-CICS-MSG-AREA   65410000
645100             WHEN  PC133-TIMEOUT                                  65420000
645200               STRING ' SUKRF707 -'           DELIMITED BY SIZE   65430000
645300                 PC138-MSG-TIMEOUT            DELIMITED BY SIZE   65440000
645400                                          INTO PV-CICS-MSG-AREA   65450000
645500             WHEN  PC133-ADDR-NOT-FND                             65460000
645600               STRING ' SUKRF707 -'           DELIMITED BY SIZE   65470000
645700                 PC138-MSG-ADDR-NOT-FND       DELIMITED BY SIZE   65480000
645800                                          INTO PV-CICS-MSG-AREA   65490000
645900             WHEN  PC133-INVALID-PACKET                           65500000
646000               STRING ' SUKRF707 -'           DELIMITED BY SIZE   65510000
646100                 PC138-MSG-INVALID-PACKET     DELIMITED BY SIZE   65520000
646200                                          INTO PV-CICS-MSG-AREA   65530000
646300         END-EVALUATE                                             65540000
646400         PERFORM 9990-WRITE-CICS                                  65550000
646500                                                                  65560000
646600         SET  DP013-OTHER-ABEND      TO TRUE                      65570000
646700         SET  DP013-ROLLBACK         TO TRUE                      65580000
646800                                                                  65590000
646900         MOVE '5401-RECEIVE-CONFIRM-FROM-LPMS'                    65600000
647000                                     TO DP013-PARAGRAPH           65610000
647100         STRING ' SUKRF707 - '           DELIMITED BY SIZE        65620000
647200                DP081-TCP-IP-LOGGING-MSG DELIMITED BY SIZE        65630000
647300                                     INTO DP013-MESSAGE-TEXT (1)  65640000
647400         PERFORM 9999-WRITE-CICS-LOG-MSG                          65650000
647500*** BEGIN - FOR TESTING ONLY                                      65660000
647600*    ELSE                                                         65670000
647700*        MOVE ' SUKRF707 - CONFIRM SUCCESSFUL'                    65680000
647800*                                    TO PV-CICS-MSG-AREA          65690000
647900*        PERFORM 9990-WRITE-CICS                                  65700000
648000*** END - FOR TESTING ONLY                                        65710000
648100     END-IF                                                       65720000
648200     END-IF.                                                      65730000
648300************************************                              65740000
648400 6000-FORMAT-ABEND.                                               65750000
648500         SET  PS-SOCKET-ERROR         TO TRUE                     65760000
648600         MOVE PC-CURRENT-PROGRAM-NAME TO DP081-TCP-IP-PGM-NAME    65770000
648700         SET  DP081-TCP-IP-READ-ERR  TO TRUE                      65780000
648800         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      65790000
648900         SET  DP013-OTHER-ABEND      TO TRUE                      65800000
649000         SET  DP013-ROLLBACK         TO TRUE                      65810000
649100                                                                  65820000
649200         MOVE '5401-RECEIVE-CONFIRM-FROM-LPMS'                    65830000
649300                                     TO DP013-PARAGRAPH           65840000
649400         MOVE DP081-TCP-IP-LOGGING-MSG TO DP013-MESSAGE-TEXT (1)  65850000
649500         MOVE DP081-NAME-FAMILY        TO PV-DISPLAY-FAMILY       65860000
649600         MOVE DP081-NAME-PORT          TO PV-DISPLAY-PORT         65870000
649700         MOVE DP081-NAME-IP-ADDR       TO PV-DISPLAY-IP-ADDR      65880000
649800         STRING ' SUKRF707 - '            DELIMITED BY SIZE       65890000
649900                'DP081-FAMILY='           DELIMITED BY SIZE       65900000
650000                PV-DISPLAY-FAMILY         DELIMITED BY SIZE       65910000
650100                ' DP081-PORT='            DELIMITED BY SIZE       65920000
650200                PV-DISPLAY-PORT           DELIMITED BY SIZE       65930000
650300                ' DP081-IP-ADDR='         DELIMITED BY SIZE       65940000
650400                PV-DISPLAY-IP-ADDR        DELIMITED BY SIZE       65950000
650500                                     INTO DP013-MESSAGE-TEXT (2)  65960000
650600         MOVE DP081-RETCODE            TO  PV-RETCODE             65970000
650700         MOVE DP081-ERRNO              TO  PV-ERRNO               65980000
650800         STRING ' EZASOKET CONNECT -'      DELIMITED BY SIZE      65990000
650900                ' DP081-RETCODE - '        DELIMITED BY SIZE      66000000
651000                PV-RETCODE                 DELIMITED BY SIZE      66010000
651100                ' DP081-ERRNO - '          DELIMITED BY SIZE      66020000
651200                PV-ERRNO                   DELIMITED BY SIZE      66030000
651300                                      INTO DP013-MESSAGE-TEXT (3) 66040000
651400        MOVE   LBPTDA-PO-NBR           TO  PV-DISPLAY-PO          66050000
651500        MOVE   LBPTDA-RCVR-SEQ-NBR     TO  PV-DISPLAY-RCVR        66060000
651600        MOVE   LBPTDA-PO-LNE-NBR       TO  PV-DISPLAY-LINE        66070000
651700        MOVE   SU001-OPER-UNT-ID       TO  PV-DISPLAY-OPER        66080000
651800        STRING ' PRTR ID: '                DELIMITED BY SIZE      66090000
651900               SU001-PRINTER-ID-USE        DELIMITED BY SIZE      66100000
652000               '   OPER: '                 DELIMITED BY SIZE      66110000
652100               PV-DISPLAY-OPER             DELIMITED BY SIZE      66120000
652200               '   PO: '                   DELIMITED BY SIZE      66130000
652300               PV-DISPLAY-PO               DELIMITED BY SIZE      66140000
652400               '   RCVR: '                 DELIMITED BY SIZE      66150000
652500               PV-DISPLAY-RCVR             DELIMITED BY SIZE      66160000
652600               '   LINE: '                 DELIMITED BY SIZE      66170000
652700               PV-DISPLAY-LINE             DELIMITED BY SIZE      66180000
652800                                      INTO DP013-MESSAGE-TEXT (4) 66190000
652900         PERFORM 9999-WRITE-CICS-LOG-MSG.                         66200000
653000                                                                  66210000
653100*----------------------------------------------------------------*66220000
653200*    THIS PARAGRAPH WILL BE USED WHEN WHAT IS RECEIVED VIA A     *66230000
653300*    SOCKET IS LESS THAN WHAT WAS EXPECTED TO BE RETURNED.       *66240000
653400*    THIS PARAGRAPH WILL DETERMINE IF THE PARTIAL IS A FIRST     *66250000
653500*    RECEIPT OF A NEW PACKET OR AN ADDITIONAL RECEIPT OF A       *66260000
653600*    PACKAGE AND THEN TAKE THE RECEIVED DATA AND CHARACTER BY    *66270000
653700*    CHARACTER MOVE FROM THE RECEIVED FIELD TO THE ASSEMBLE      *66280000
653800*    FIELD IN ORDER TO BUILD THE SOCKET PACKET OVER MULTIPLE     *66290000
653900*    RECEIVE COMMANDS.                                           *66300000
654000*----------------------------------------------------------------*66310000
654100                                                                  66320000
654200 6100-PROCESS-PARTIAL-TCP.                                        66330000
654300                                                                  66340000
654400     IF  PS-START-RECEIVE                                         66350000
654500         SET PS-PART-RECEIVE TO TRUE                              66360000
654600         SET PT-ASSEMBLE-IDX TO 1                                 66370000
654700         MOVE ZEROS TO PV-TCP-PRCSD-LENGTH                        66380000
654800     END-IF.                                                      66390000
654900                                                                  66400000
655000     ADD PV-TCP-RET-LENGTH TO PV-TCP-PRCSD-LENGTH.                66410000
655100                                                                  66420000
655200     IF  PV-TCP-PRCSD-LENGTH > PV-TCP-EXP-LENGTH                  66430000
655300         PERFORM 4340-CLOSE-SOCKET                                66440000
655400         INITIALIZE PV-CICS-MSG-AREA                              66450000
655500         MOVE DP081-RETCODE TO PV-RETCODE                         66460000
655600         MOVE DP081-NBR-BYTES TO PV-TCPLENG                       66470000
655700         MOVE DP081-ERRNO   TO PV-ERRNO                           66480000
655800         STRING ' SUKRF707:'                                      66490000
655900              'SOCKET TOTAL LENGTH ERROR'                         66500000
656000              ' RETCODE='                                         66510000
656100              PV-RETCODE                                          66520000
656200              ' TOTLENG='                                         66530000
656300              PV-TCP-PRCSD-LENGTH                                 66540000
656400              ' ERRNO='                                           66550000
656500              PV-ERRNO                                            66560000
656600             DELIMITED BY SIZE INTO PV-CICS-MSG-AREA              66570000
656700         PERFORM 9990-WRITE-CICS                                  66580000
656800*        BEGIN OF TRANSLATE ASCII TO EBCDIC                       66590000
656900         CALL 'EZACIC05'                                          66600000
657000             USING  DP081-TOEBCDIC-TOKEN                          66610000
657100                    TCP-BUF2                                      66620000
657200                    DP081-NBR-BYTES                               66630000
657300*        END OF TRANSLATE ASCII TO EBCDIC                         66640000
657400                                                                  66650000
657500* JUST FOR TESTING - BEGIN                                        66660000
657600*        INITIALIZE PV-CICS-MSG-AREA                              66670000
657700*        STRING ' SUKRF707:'                                      66680000
657800*             TCP-BUF2                                            66690000
657900*            DELIMITED BY SIZE INTO PV-CICS-MSG-AREA              66700000
658000*        PERFORM 9990-WRITE-CICS                                  66710000
658100* JUST FOR TESTING - END                                          66720000
658200                                                                  66730000
658300         MOVE PC-CURRENT-PROGRAM-NAME TO DP081-TCP-IP-PGM-NAME    66740000
658400         SET  DP081-TCP-IP-READ-ERR TO TRUE                       66750000
658500         MOVE DP081-ERRNO         TO DP081-TCP-IP-ERR-NBR         66760000
658600         SET  DP013-OTHER-ABEND   TO TRUE                         66770000
658700         SET  DP013-NO-ROLLBACK   TO TRUE                         66780000
658800         MOVE '6100-PROCESS-PARTIAL-TCP'                          66790000
658900             TO DP013-PARAGRAPH                                   66800000
659000         MOVE DP081-TCP-IP-LOGGING-MSG TO                         66810000
659100              DP013-MESSAGE-TEXT (1)                              66820000
659200         PERFORM 9999-WRITE-CICS-LOG-MSG                          66830000
659300     END-IF.                                                      66840000
659400                                                                  66850000
659500*  DISPLAYS ADDED TO DISPLAY A PARTIAL SOCKET RECEIVE             66860000
659600*  \/                                                             66870000
659700                                                                  66880000
659800     INITIALIZE PV-CICS-MSG-AREA.                                 66890000
659900     MOVE DP081-RETCODE TO PV-RETCODE.                            66900000
660000     MOVE DP081-NBR-BYTES TO PV-TCPLENG.                          66910000
660100     MOVE DP081-ERRNO   TO PV-ERRNO.                              66920000
660200                                                                  66930000
660300* JUST FOR TESTING - BEGIN                                        66940000
660400*    STRING ' SUKRF707:'                                          66950000
660500*         'SOCKET PARTIAL RECEIVE'                                66960000
660600*         ' RETCODE='                                             66970000
660700*         PV-RETCODE                                              66980000
660800*         ' TCPLENG='                                             66990000
660900*         PV-TCPLENG                                              67000000
661000*         ' ERRNO='                                               67010000
661100*         PV-ERRNO                                                67020000
661200*        DELIMITED BY SIZE INTO PV-CICS-MSG-AREA.                 67030000
661300*    PERFORM 9990-WRITE-CICS.                                     67040000
661400* JUST FOR TESTING - END                                          67050000
661500                                                                  67060000
661600*        BEGIN OF TRANSLATE ASCII TO EBCDIC                       67070000
661700     MOVE TCP-BUF TO PV-TCP-BUF.                                  67080000
661800     CALL 'EZACIC05'                                              67090000
661900         USING  DP081-TOEBCDIC-TOKEN                              67100000
662000                PV-TCP-BUF                                        67110000
662100                DP081-NBR-BYTES.                                  67120000
662200*        END OF TRANSLATE ASCII TO EBCDIC                         67130000
662300                                                                  67140000
662400* JUST FOR TESTING - BEGIN                                        67150000
662500*    INITIALIZE PV-CICS-MSG-AREA.                                 67160000
662600*    STRING ' SUKRF707:'                                          67170000
662700*         PV-TCP-BUF                                              67180000
662800*        DELIMITED BY SIZE INTO PV-CICS-MSG-AREA.                 67190000
662900*    PERFORM 9990-WRITE-CICS.                                     67200000
663000* JUST FOR TESTING - END                                          67210000
663100                                                                  67220000
663200*  /\                                                             67230000
663300*  DISPLAYS ADDED TO DISPLAY A PARTIAL SOCKET RECEIVE             67240000
663400                                                                  67250000
663500     MOVE TCP-BUF TO PT-TCP-RECEIVE-TABLE.                        67260000
663600                                                                  67270000
663700     PERFORM 6200-ASSEMBLE-DATA                                   67280000
663800         VARYING PT-RECEIVE-IDX FROM 1 BY 1                       67290000
663900             UNTIL PT-RECEIVE-IDX > PV-TCP-RET-LENGTH.            67300000
664000                                                                  67310000
664100     IF  PV-TCP-PRCSD-LENGTH = PV-TCP-EXP-LENGTH                  67320000
664200         SET PS-COMP-RECEIVE TO TRUE                              67330000
664300         MOVE SPACES TO TCP-BUF2                                  67340000
664400         MOVE PT-TCP-ASSEMBLE-TABLE TO TCP-BUF                    67350000
664500         MOVE PV-TCP-EXP-LENGTH TO DP081-NBR-BYTES                67360000
664600                                                                  67370000
664700* JUST FOR TESTING - BEGIN                                        67380000
664800*        INITIALIZE PV-CICS-MSG-AREA                              67390000
664900*        STRING ' SUKRF707:STRUNG DATA  '                         67400000
665000*             TCP-BUF2                                            67410000
665100*            DELIMITED BY SIZE INTO PV-CICS-MSG-AREA              67420000
665200*        PERFORM 9990-WRITE-CICS                                  67430000
665300* JUST FOR TESTING - END                                          67440000
665400                                                                  67450000
665500     ELSE                                                         67460000
665600         SUBTRACT PV-TCP-PRCSD-LENGTH FROM                        67470000
665700                  PV-TCP-EXP-LENGTH   GIVING                      67480000
665800                  PV-TCP-REM-LENGTH                               67490000
665900         MOVE PV-TCP-REM-LENGTH TO DP081-NBR-BYTES                67500000
666000                                                                  67510000
666100* JUST FOR TESTING - BEGIN                                        67520000
666200*        INITIALIZE PV-CICS-MSG-AREA                              67530000
666300*        STRING ' SUKRF707:'                                      67540000
666400*             'SOCKET GET MORE LENGTH'                            67550000
666500*             ' PRCSD='                                           67560000
666600*             PV-TCP-PRCSD-LENGTH                                 67570000
666700*             ' EXPECT='                                          67580000
666800*             PV-TCP-EXP-LENGTH                                   67590000
666900*             ' REMAIN='                                          67600000
667000*             PV-TCP-REM-LENGTH                                   67610000
667100*            DELIMITED BY SIZE INTO PV-CICS-MSG-AREA              67620000
667200*        PERFORM 9990-WRITE-CICS                                  67630000
667300* JUST FOR TESTING - END                                          67640000
667400                                                                  67650000
667500     END-IF.                                                      67660000
667600                                                                  67670000
667700                                                                  67680000
667800                                                                  67690000
667900*----------------------------------------------------------------*67700000
668000*    THIS PARAGRAPH WILL ASSEMBLE THE DATA THAT WAS RECEIVED     *67710000
668100*    WITH THE DATA RECEIVED FROM PREVIOUS RECEIVES FOR THE       *67720000
668200*    SOCKET PACKET.                                              *67730000
668300*----------------------------------------------------------------*67740000
668400                                                                  67750000
668500 6200-ASSEMBLE-DATA.                                              67760000
668600                                                                  67770000
668700     MOVE PT-TCP-RECEIVE-CHAR (PT-RECEIVE-IDX) TO                 67780000
668800          PT-TCP-DATA-CHAR (PT-ASSEMBLE-IDX).                     67790000
668900     SET PT-ASSEMBLE-IDX UP BY 1.                                 67800000
669000                                                                  67810000
669100                                                                  67820000
669200 7000-CALL-STORE-ON-HAND-MOD.                                     67830000
669300     INITIALIZE XL088-ITEM-COMMAREA.                              67840000
669400     SET  XL088-ONHAND-YES        TO TRUE                         67850000
669500     SET  XL088-PROCESS-MSG-NO    TO TRUE                         67860000
669600     MOVE LBPTDA-DEST-OPER-UNT-ID TO XL088-KEY-STR-NBR            67870000
669700     MOVE LBPTDA-OPER-UNT-ID      TO XL088-OPER-UNT-ID            67880000
669800                                                                  67890000
669900     SET XL088-BY-OTBND-CRTN TO TRUE                              67900000
670000     MOVE LBPTDA-BRCDE-NBR TO PV-OTBND-CRTN                       67910000
670100     MOVE PV-OTBND-SML     TO XL088-OTBND-CRTN                    67920000
670200     MOVE LBPTDA-PO-NBR    TO XL088-KEY-PO                        67930000
670300     MOVE LBPTDA-RCVR-SEQ-NBR TO XL088-KEY-REC-SEQ-NBR            67940000
670400                                                                  67950000
670500                                                                  67960000
670600     CALL XL088-USER-PGM USING DFHEIBLK                           67970000
670700                               XL088-COMMAREA                     67980000
670800                               XL088-ITEM-COMMAREA.               67990000
670900     EVALUATE TRUE                                                68000000
671000        WHEN XL088-SUCCESSFUL                                     68010000
671100           CONTINUE                                               68020000
671200        WHEN OTHER                                                68030000
671300           MOVE XL088-KEY-STR-NBR TO PV-DISPLAY-DEST              68040000
671400           MOVE XL088-KEY-SKU     TO PV-DISPLAY-SKU               68050000
671500           MOVE XL088-OTBND-CRTN  TO PV-DISPLAY-CRTN              68060000
671600           SET  PS-SOCKET-ERROR         TO TRUE                   68070000
671700           STRING PC-CURRENT-PROGRAM-NAME                         68080000
671800                  ' - ERROR FROM XLKUT088 - '                     68090000
671900                  XL088-RETURN-SQLCODE                            68100000
672000                  ' STORE = '                                     68110000
672100                  PV-DISPLAY-DEST                                 68120000
672200                  ' CRTN = '                                      68130000
672300                  PV-DISPLAY-CRTN                                 68140000
672400                  ' SKU  = '                                      68150000
672500                  PV-DISPLAY-SKU                                  68160000
672600                  DELIMITED BY SIZE                               68170000
672700                  INTO PV-CICS-MSG-AREA                           68180000
672800           PERFORM 9990-WRITE-CICS                                68190000
672900                                                                  68200000
673000           MOVE XL088-CRA-RET-MSG TO PV-CICS-MSG-AREA             68210000
673100           PERFORM 9990-WRITE-CICS                                68220000
673200                                                                  68230000
673300           MOVE '7000-CALL-STORE-ON-HAND-MOD '                    68240000
673400                           TO DP013-PARAGRAPH                     68250000
673500           MOVE 'SUKRF707 - CALL BALANCE ON HAND '                68260000
673600                                 TO DP013-MESSAGE-TEXT(1)         68270000
673700           MOVE   SU001-MANIFEST TO PV-DISPLAY-MANIFEST           68280000
673800           STRING ' TRIP-'                                        68290000
673900                  PV-DISPLAY-MANIFEST                             68300000
674000                  ' USER ID-'                                     68310000
674100                  SU001-USER-ID                                   68320000
674200                  ' USER ID REQ-'                                 68330000
674300                  SU001-USER-ID-USE                               68340000
674400                  ' BATCH NUMBER-'                                68350000
674500                  PV-BATCH-NUMBER-N     DELIMITED BY SIZE         68360000
674600                               INTO DP013-MESSAGE-TEXT (2)        68370000
674700           MOVE SQLCA            TO DP013-SQLCA                   68380000
674800           SET DP013-DB2-ABEND             TO TRUE                68390000
674900           SET DP013-NO-ROLLBACK           TO TRUE                68400000
675000             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              68410000
675100           PERFORM DP014-0000-PROCESS-ABEND                       68420000
675200     END-EVALUATE.                                                68430000
675300                                                                  68440000
675400                                                                  68450000
675500                                                                  68460000
675600 7100-CHECK-AUDIT-CRTN.                                           68470000
675700                                                                  68480000
675800     MOVE ZEROES          TO PV-DB2-COUNT-AUDIT.                  68490000
675900                                                                  68500000
676000     EXEC SQL                                                     68510000
676100        SELECT COUNT(*)                                           68520000
676200          INTO :PV-DB2-COUNT-AUDIT                                68530000
676300          FROM SUT_PO_AUD_REQ A                                   68540000
676400             , TSUATRN B                                          68550000
676500         WHERE A.AUD_CNTL_NBR     = B.AUD_CNTL_NBR                68560000
676600           AND B.SHIPT_UNT_ID     = :LBPTDA-SHIPT-UNT-ID          68570000
676700         WITH UR                                                  68580000
676800     END-EXEC.                                                    68590000
676900                                                                  68600000
677000                                                                  68610000
677100     EVALUATE TRUE                                                68620000
677200         WHEN SQLCODE = ZERO                                      68630000
677300           IF PV-DB2-COUNT-AUDIT > 0                              68640000
677400              SET PS-AUDIT-CRTN-FOUND-YES TO TRUE                 68650000
677500           ELSE                                                   68660000
677600              SET PS-AUDIT-CRTN-FOUND-NO  TO TRUE                 68670000
677700           END-IF                                                 68680000
677800         WHEN SQLWARN0 NOT = SPACES                               68690000
677900         WHEN SQLCODE NOT EQUAL ZERO                              68700000
678000             MOVE ' 7100-CHECK-AUDIT-CRTN '                       68710000
678100                             TO DP013-PARAGRAPH                   68720000
678200             MOVE                                                 68730000
678300                'SUKRF502-SELECT IF PROMPTED AUDIT CARTON'        68740000
678400                             TO DP013-MESSAGE-TEXT(1)             68750000
678500             MOVE SU001-MANIFEST                                  68760000
678600                             TO DP013-MESSAGE-TEXT(2)             68770000
678700             MOVE SU001-USER-ID                                   68780000
678800                             TO DP013-MESSAGE-TEXT(3)             68790000
678900             MOVE SQLCA      TO DP013-SQLCA                       68800000
679000             MOVE 'TSUATRN'  TO DP013-DB2-TABLE-NAME(1)           68810000
679100             SET DP013-DB2-ABEND                                  68820000
679200                             TO TRUE                              68830000
679300             SET DP013-NO-ROLLBACK                                68840000
679400                             TO TRUE                              68850000
679500             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              68860000
679600             PERFORM DP014-0000-PROCESS-ABEND                     68870000
679700     END-EVALUATE.                                                68880000
679800*----------------------------------------------------------------*68890000
679900*                                                                *68900000
680000*----------------------------------------------------------------*68910000
680100 8000-SEND-MAP.                                                   68920000
680200                                                                  68930000
680300     EXEC CICS                                                    68940000
680400         SEND MAP       ('SU707A')                                68950000
680500              MAPSET    ('SUKM707')                               68960000
680600              ERASE                                               68970000
680700              RESP      (PV-CICS-RESPONSE)                        68980000
680800     END-EXEC.                                                    68990000
680900                                                                  69000000
681000     EVALUATE TRUE                                                69010000
681100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 69020000
681200              CONTINUE                                            69030000
681300         WHEN OTHER                                               69040000
681400              MOVE '8000-SEND-MAP'   TO DP013-PARAGRAPH           69050000
681500              MOVE 'UNABLE TO SEND MAP'                           69060000
681600                                     TO DP013-MESSAGE-TEXT (1)    69070000
681700              SET DP013-CICS-ABEND   TO TRUE                      69080000
681800              SET DP013-NO-ROLLBACK  TO TRUE                      69090000
681900              PERFORM 9999-WRITE-CICS-LOG-MSG                     69100000
682000     END-EVALUATE.                                                69110000
682100                                                                  69120000
682200                                                                  69130000
682300*----------------------------------------------------------------*69140000
682400*                                                                *69150000
682500*----------------------------------------------------------------*69160000
682600 8100-SEND-DATA-ONLY.                                             69170000
682700                                                                  69180000
682800     EXEC CICS                                                    69190000
682900         SEND MAP       ('SU707A')                                69200000
683000              MAPSET    ('SUKM707')                               69210000
683100              CURSOR                                              69220000
683200              DATAONLY                                            69230000
683300              RESP      (PV-CICS-RESPONSE)                        69240000
683400     END-EXEC.                                                    69250000
683500                                                                  69260000
683600     EVALUATE TRUE                                                69270000
683700         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 69280000
683800              CONTINUE                                            69290000
683900         WHEN OTHER                                               69300000
684000              MOVE '8100-SEND-DATA-ONLY'                          69310000
684100                                     TO DP013-PARAGRAPH           69320000
684200              MOVE 'UNABLE TO SEND DATA'                          69330000
684300                                     TO DP013-MESSAGE-TEXT (1)    69340000
684400              SET DP013-CICS-ABEND   TO TRUE                      69350000
684500              SET DP013-NO-ROLLBACK  TO TRUE                      69360000
684600              PERFORM 9999-WRITE-CICS-LOG-MSG                     69370000
684700     END-EVALUATE.                                                69380000
684800                                                                  69390000
684900                                                                  69400000
685000*----------------------------------------------------------------*69410000
685100*                                                                *69420000
685200*----------------------------------------------------------------*69430000
685300 8200-RETURN-TRANID.                                              69440000
685400                                                                  69450000
685500*LMM                                                              69460000
685600     MOVE LENGTH OF CA-COMMAREA   TO PV-COMMAREA-LENGTH           69470000
685700     EXEC CICS                                                    69480000
685800         RETURN TRANSID   (PC-SU-PRT-DISPLAY)                     69490000
685900                COMMAREA  (CA-COMMAREA)                           69500000
686000                LENGTH    (PV-COMMAREA-LENGTH)                    69510000
686100                RESP      (PV-CICS-RESPONSE)                      69520000
686200     END-EXEC.                                                    69530000
686300                                                                  69540000
686400     EVALUATE TRUE                                                69550000
686500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 69560000
686600              CONTINUE                                            69570000
686700         WHEN OTHER                                               69580000
686800              MOVE '8200-RETURN-TRANID'                           69590000
686900                                     TO DP013-PARAGRAPH           69600000
687000              MOVE 'UNABLE TO RETURN TO TRANID'                   69610000
687100                                     TO DP013-MESSAGE-TEXT (1)    69620000
687200              SET DP013-CICS-ABEND   TO TRUE                      69630000
687300              SET DP013-NO-ROLLBACK  TO TRUE                      69640000
687400              PERFORM 9999-WRITE-CICS-LOG-MSG                     69650000
687500     END-EVALUATE.                                                69660000
687600                                                                  69670000
687700                                                                  69680000
687800 9100-SYNCPOINT.                                                  69690000
687900                                                                  69700000
688000     EXEC CICS                                                    69710000
688100         SYNCPOINT                                                69720000
688200     END-EXEC.                                                    69730000
688300                                                                  69740000
688400                                                                  69750000
688500 9200-SYNCPOINT-ROLLBACK.                                         69760000
688600                                                                  69770000
688700     EXEC CICS                                                    69780000
688800         SYNCPOINT ROLLBACK                                       69790000
688900     END-EXEC.                                                    69800000
689000                                                                  69810000
689100                                                                  69820000
689200*----------------------------------------------------------------*69830000
689300*                                                                *69840000
689400*----------------------------------------------------------------*69850000
689500 9990-WRITE-CICS.                                                 69860000
689600     MOVE LENGTH OF PV-CICS-MSG-AREA  TO  PV-COMMAREA-LENGTH.     69870000
689700                                                                  69880000
689800     EXEC CICS WRITEQ TD                                          69890000
689900                      QUEUE('CSSL')                               69900000
690000                      FROM(PV-CICS-MSG-AREA)                      69910000
690100                      LENGTH(PV-COMMAREA-LENGTH)                  69920000
690200                      RESP (PV-CICS-RESPONSE)                     69930000
690300     END-EXEC.                                                    69940000
690400                                                                  69950000
690500     MOVE SPACES TO PV-CICS-MSG-AREA.                             69960000
690600                                                                  69970000
690700                                                                  69980000
690800*----------------------------------------------------------------*69990000
690900*                                                                *70000000
691000*----------------------------------------------------------------*70010000
691100 9999-WRITE-CICS-LOG-MSG.                                         70020000
691200     MOVE PC-CURRENT-PROGRAM-NAME    TO DP013-PROGRAM.            70030000
691300     MOVE DFHEIBLK                   TO DP013-DFHEIBLK.           70040000
691400     INITIALIZE DP013-SRC-TASK-NUMBER                             70050000
691500                DP013-STACK.                                      70060000
691600                                                                  70070000
691700     EXEC CICS                                                    70080000
691800         LINK                                                     70090000
691900             PROGRAM   (DP013-NAME)                               70100000
692000             COMMAREA  (DP013-PARAMETERS)                         70110000
692100             LENGTH    (DP013-LENGTH)                             70120000
692200     END-EXEC.                                                    70130000
692300                                                                  70140000
692400                                                                  70150000
692500*----------------------------------------------------------------*70160000
692600*    ABEND PROCESSOR MODULE                                      *70170000
692700*----------------------------------------------------------------*70180000
692800                                                                  70190000
692900     COPY DPPD014.                                                70200000
693000                                                                  70210000
