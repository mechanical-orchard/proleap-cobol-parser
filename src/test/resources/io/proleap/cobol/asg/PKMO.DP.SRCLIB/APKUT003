000100 IDENTIFICATION DIVISION.                                         00010001
000200 PROGRAM-ID.     APKUT003.                                        00020001
000300 AUTHOR.         NANCY EILBES.                                    00030001
000400 DATE-WRITTEN.   SEPTEMBER 2019.                                  00040001
000500 DATE-COMPILED.                                                   00050001
000600***************************************************************   00060001
000700*    COBOL 2                                                  *   00070001
000800*     REFORMATS APRD006 FILE TO TEXT FORMAT                   *   00080001
000900*                                                             *   00090001
001000* INPUT:                                                      *   00100001
001100*  1. VERIFIED RECEIPT GL FILE       COPYBOOK APRD006         *   00110001
001200*                                                             *   00120001
001300* OUTPUT:                                                     *   00130001
001400*  1. TEXT FILE TO BE SENT TO ERP    COPYBOOK APRD014         *   00140001
001500*                                                             *   00150001
001600***************************************************************   00160001
001800*   CHANGE LOG                                                *   00180001
001900***************************************************************   00190001
001910*    DATE  02/28/2019                                         *   00191001
001920*        CHANGE MADE: INITIAL PROGRAM INSTALL                 *   00192001
001930*        MADE BY: ELENA MOZNAIM           WR/IR #: CHG0220040 *   00193001
001940*                                                             *   00194001
001950*    DATE  03/26/2019                                         *   00195001
001960*        CHANGE MADE: UPDATE CHANGE NUMBER                    *   00196001
001970*        MADE BY: GERMAN BANDA            WR/IR #: CHG0220044 *   00197001
001980*                                                             *   00198001
001990*    DATE  09/25/2019                                         *   00199001
001991*        CHANGE MADE: ADDED DATE TO THE OUTPUT FILE           *   00199101
001992*        MADE BY: ELENA MOZNAIM           WR/IR #: CHG0232028 *   00199201
001993*                                                             *   00199301
001994*    DATE  09/30/2019                                         *   00199401
001995*        CHANGE MADE: RENAMED PROGRAM TO APKUT003 AND ALL     *   00199501
001996*        COPYBOOKS, ETC. TO AP SYSTEM ID.                     *   00199601
001997*        MADE BY: NANCY EILBES            WR/IR #: CHG??????? *   00199703
002600***************************************************************   00260001
002700   EJECT                                                          00270001
002800 ENVIRONMENT DIVISION.                                            00280001
002900 CONFIGURATION SECTION.                                           00290001
003000 SOURCE-COMPUTER.    IBM-3090.                                    00300001
003100 OBJECT-COMPUTER.    IBM-3090.                                    00310001
003200                                                                  00320001
003300 INPUT-OUTPUT SECTION.                                            00330001
003400 FILE-CONTROL.                                                    00340001
003500     SELECT IN-FILE       ASSIGN TO UT-S-INP01.                   00350001
003600     SELECT OUT-FILE      ASSIGN TO UT-S-OUT01.                   00360001
003700                                                                  00370001
003800 DATA DIVISION.                                                   00380001
003900 FILE SECTION.                                                    00390001
004000                                                                  00400001
004100 FD  IN-FILE                                                      00410001
004200     RECORDING MODE IS F                                          00420001
004300     LABEL RECORDS ARE STANDARD                                   00430001
004400     BLOCK CONTAINS 0 RECORDS                                     00440001
004500     DATA RECORD IS APTRAN-IN-REC.                                00450001
004600 01  IN-REC.                                                      00460001
004700     05  FILLER                       PIC  X(50).                 00470001
004800                                                                  00480001
004900 FD  OUT-FILE                                                     00490001
005000     RECORDING MODE IS F                                          00500001
005100     LABEL RECORDS ARE STANDARD                                   00510001
005200     BLOCK CONTAINS 0 RECORDS                                     00520001
005300     DATA RECORD IS APTRAN-OUT-REC.                               00530001
005400 01  OUT-REC.                                                     00540001
005500     05  FILLER                       PIC  X(65).                 00550001
005600                                                                  00560001
005700 EJECT                                                            00570001
005800 WORKING-STORAGE SECTION.                                         00580001
005801                                                                  00580103
005810 01  PV-PROGRAM-VARIABLES.                                        00581003
005880     05  PV-COUNT-OUT          PIC  9(9)   VALUE ZEROS.           00588003
005891     05  PV-COUNT-IN           PIC  9(9)   VALUE ZEROS.           00589103
005900                                                                  00590001
006000 01  EOF-SW                           PIC X     VALUE 'N'.        00600001
006100     88  IN-EOF                                 VALUE 'Y'.        00610001
006110     88  MORE-IN-RECS                           VALUE 'N'.        00611003
006200*----------------------------------------------------------------*00620001
006300*  VERIFIED RECEIPT GL POSTING FILE RECORD LAYOUT.               *00630001
006400*----------------------------------------------------------------*00640001
007100     COPY APRD006.                                                00710001
007200                                                                  00720001
007201*----------------------------------------------------------------*00720101
007202*  VERIFIED RECEIPT GL POSTING TEXT FILE RECORD LAYOUT.          *00720201
007203*----------------------------------------------------------------*00720301
007210     COPY APRD014.                                                00721001
007220                                                                  00722001
007300*----------------------------------------------------------------*00730001
007400*  CONTROL CARD RECORD LAYOUT                                    *00740001
007500*----------------------------------------------------------------*00750001
007600 01  CONTROL-CARD-RECORD.                                         00760001
007700     05  CC-RUN-DTE.                                              00770001
007800         10  CC-RUN-DTE-CC       PIC  X(02).                      00780001
007900         10  CC-RUN-DTE-YY       PIC  X(02).                      00790001
008000         10  FILLER              PIC  X(01).                      00800001
008100         10  CC-RUN-DTE-MM       PIC  X(02).                      00810001
008200         10  FILLER              PIC  X(01).                      00820001
008300         10  CC-RUN-DTE-DD       PIC  X(02).                      00830001
008400     05  FILLER                  PIC  X(70).                      00840001
008500                                                                  00850001
008600     05  PV-RUN-DTE-CYMD.                                         00860001
008700         10  PV-RUN-DTE-CC       PIC  X(02)     VALUE SPACES.     00870001
008800         10  PV-RUN-DTE-YY       PIC  X(02)     VALUE SPACES.     00880001
008900         10  PV-RUN-DTE-MM       PIC  X(02)     VALUE SPACES.     00890001
009000         10  PV-RUN-DTE-DD       PIC  X(02)     VALUE SPACES.     00900001
009001                                                                  00900102
009010*----------------------------------------------------------------*00901002
009100*  ABEND DATA AREAS                                              *00910001
009200*----------------------------------------------------------------*00920001
009300 01  ABEND-CODE                  PIC S9(04)  VALUE ZEROS          00930001
009400                                             COMP SYNC.           00940001
009500     88  AC-INVALID-CONTROL-CARD             VALUE +4003.         00950001
009600     88  AC-OPEN-ERROR                       VALUE +4005.         00960001
009700     88  AC-CLOSE-ERROR                      VALUE +4006.         00970001
009800     88  AC-DB2-ERROR                        VALUE +4013.         00980001
009900     88  AC-UNSUCCESSFUL-SELECT              VALUE +4015.         00990001
010000     88  AC-DATE-ERROR                       VALUE +4019.         01000001
010100                                                                  01010001
010200 01  ABEND-AREAS.                                                 01020001
010300     05  AA-ABEND-LIT            PIC  X(40)  VALUE                01030001
010400             '*****       ABEND'.                                 01040001
010500     05  AA-PROGRAM-LIT          PIC  X(40)  VALUE                01050001
010600             '*****   PROGRAM: GLKUT030'.                         01060001
010700     05  AA-PARAGRAPH-LIT.                                        01070001
010800         10  FILLER              PIC  X(17)  VALUE                01080001
010900             '***** PARAGRAPH: '.                                 01090001
011000         10  AA-PARAGRAPH-NAME   PIC  X(35)  VALUE SPACES.        01100001
011100     05  AA-MESSAGE-LINE-1.                                       01110001
011200         10  FILLER              PIC  X(06)  VALUE '*****'.       01120001
011300         10  AA-MESSAGE-1        PIC  X(127) VALUE SPACES.        01130001
011400     05  AA-MESSAGE-LINE-2.                                       01140001
011500         10  FILLER              PIC  X(06)  VALUE '*****'.       01150001
011600         10  AA-MESSAGE-2        PIC  X(127) VALUE SPACES.        01160001
011700 EJECT                                                            01170001
011800 PROCEDURE DIVISION.                                              01180001
011900 A100-MAIN.                                                       01190001
012000                                                                  01200001
012100     PERFORM B100-INITIALIZE.                                     01210001
012200                                                                  01220001
012300     PERFORM B200-PROCESS                                         01230001
012400         UNTIL IN-EOF.                                            01240001
012500                                                                  01250001
012510     PERFORM B300-END-OF-JOB.                                     01251003
012520                                                                  01252003
012600     GOBACK.                                                      01260001
012700 EJECT                                                            01270001
012800*----------------------------------------------------------------*01280001
012900*    INITIALIZATION PROCESSING                                   *01290001
013100*----------------------------------------------------------------*01310001
013200 B100-INITIALIZE.                                                 01320001
013300                                                                  01330001
013400     OPEN INPUT  IN-FILE                                          01340001
013500          OUTPUT OUT-FILE.                                        01350001
013600                                                                  01360001
013700     INITIALIZE CONTROL-CARD-RECORD.                              01370001
013800                                                                  01380001
013900     ACCEPT CONTROL-CARD-RECORD.                                  01390001
014000     IF CC-RUN-DTE > SPACES                                       01400001
014100         INSPECT CC-RUN-DTE REPLACING ALL '/' BY '-'              01410001
014110         DISPLAY 'CONTROL CARD DATE = ' CC-RUN-DTE                01411003
014200     ELSE                                                         01420001
014300         MOVE 'B100-INITIALIZE'        TO AA-PARAGRAPH-NAME       01430001
014400         MOVE 'INVALID RUN DATE'       TO AA-MESSAGE-1            01440001
014500         MOVE SPACES                   TO AA-MESSAGE-2            01450001
014600         SET AC-INVALID-CONTROL-CARD   TO TRUE                    01460001
014700         PERFORM Z999-ABEND                                       01470001
014800     END-IF.                                                      01480001
014900                                                                  01490001
015000     PERFORM R100-READ-INPUT.                                     01500001
015100                                                                  01510001
015110*----------------------------------------------------------------*01511003
015120*  CONVERT EACH RECORD TO TEXT BY MOVING EACH FIELD TO OUTPUT.   *01512003
015130*----------------------------------------------------------------*01513003
015200 B200-PROCESS.                                                    01520001
015300                                                                  01530001
015400     MOVE AP006-LOC-NBR       TO  AP014-LOC-NBR-TXT.              01540002
015500     MOVE AP006-AMT-TYP-CDE   TO  AP014-AMT-TYP-CDE-TXT.          01550002
015600     IF  AP006-COST-AMT < ZERO                                    01560002
015700         MOVE '-'             TO  AP014-SIGN-TXT                  01570003
015800     ELSE                                                         01580001
015900         MOVE ' '             TO  AP014-SIGN-TXT                  01590003
016000     END-IF.                                                      01600001
016100     MOVE AP006-COST-AMT      TO  AP014-COST-AMT-TXT.             01610002
016200     MOVE AP006-PO-NBR        TO  AP014-PO-NBR-TXT.               01620002
016300     MOVE CC-RUN-DTE          TO  AP014-ACCTNG-DATE-TXT.          01630001
016400                                                                  01640001
016500     PERFORM W100-WRITE-OUTPUT.                                   01650001
016600                                                                  01660001
016700     PERFORM R100-READ-INPUT.                                     01670001
016800     EJECT                                                        01680003
016810*----------------------------------------------------------------*01681003
016820*    ENDING PROCESSING: DISPLAYS RECORD COUNTS AND CLOSE FILES.  *01682003
016840*----------------------------------------------------------------*01684003
016850 B300-END-OF-JOB.                                                 01685003
016860                                                                  01686003
016862     DISPLAY '*----------------------------------*'.              01686205
016863     DISPLAY '* PROGRAM APKUT003 RECORD COUNTS   *'.              01686305
016870     DISPLAY '*----------------------------------*'.              01687005
016890     DISPLAY '* INPUT RECORDS = ' PV-COUNT-IN.                    01689005
016892     DISPLAY '* OUTPUT RECORDS = ' PV-COUNT-OUT.                  01689205
016893     DISPLAY '*----------------------------------*'.              01689305
016895                                                                  01689503
016896     CLOSE IN-FILE                                                01689603
016897           OUT-FILE.                                              01689703
016899                                                                  01689903
016900 R100-READ-INPUT.                                                 01690001
017100                                                                  01710001
017200     READ IN-FILE INTO AP006-VERIFIED-RECEIPT-FILE                01720002
017300         AT END SET IN-EOF TO TRUE.                               01730001
017400                                                                  01740001
017410     IF MORE-IN-RECS                                              01741003
017420        ADD +1 TO PV-COUNT-IN                                     01742003
017430     END-IF.                                                      01743005
017500                                                                  01750001
017600 W100-WRITE-OUTPUT.                                               01760001
017700                                                                  01770001
017800     WRITE OUT-REC FROM AP014-TEXT-RECORD.                        01780002
017810     ADD +1 TO PV-COUNT-OUT.                                      01781003
017900                                                                  01790001
018100*----------------------------------------------------------------*01810001
018200*    ABEND ROUTINE                                               *01820001
018300*----------------------------------------------------------------*01830001
018310 Z999-ABEND.                                                      01831003
018400                                                                  01840001
018500     DISPLAY AA-ABEND-LIT.                                        01850001
018600     DISPLAY AA-PROGRAM-LIT.                                      01860001
018700     DISPLAY AA-PARAGRAPH-LIT.                                    01870001
018800     DISPLAY AA-MESSAGE-LINE-1.                                   01880001
018900     DISPLAY AA-MESSAGE-LINE-2.                                   01890001
019000                                                                  01900001
019100     CALL 'ILBOABN0' USING ABEND-CODE.                            01910001
019200                                                                  01920001
