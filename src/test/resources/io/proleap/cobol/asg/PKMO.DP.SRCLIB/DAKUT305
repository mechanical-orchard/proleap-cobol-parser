       IDENTIFICATION DIVISION.                                         00010016
       PROGRAM-ID.           DAKUT305.                                  00020099
       DATE-WRITTEN          07/11/2000.                                00030016
       DATE-COMPILED.                                                   00040016
                                                                        00050016
      ******************************************************************00060017
      *PURPOSE:  CREATE THE DA ARI ERROR REPORT EXTRACT FILE.           00070099
      *          (COMPILE - EMBEDDED SQL = ORACLE)                      00080099
      *                                                                 00090099
      *CHANGE HISTORY:                                                  00100099
W03091* DATE: 03/09/2001 MADE BY: ROD JANSSEN       WR: 99999           00110099
W03091*       DATE CHECK ISSUES - DA # 1002895175. WHY?                 00120099
W03091* DATE: 01/02/2002 MADE BY: BOB MCASEY        WR: PM00438756      00130099
0102RM*       DATE CHECK CHANGED TO USE FISCAL MONTH INSTEAD OF CALENDAR00140099
0102RM*       MONTH.                                                    00150099
22405 * 22405  05-31-2001 R JANSSEN  DAII - ASSET RECOVERY ENHANCEMENT  00160099
W30328*W30328  02-22-2006 S JACKSON  10G GATEWAY FIX FOR ALTER SESSION  00170099
S30328*S30328  02-23-2006 S JACKSON  ISSUE WITH 9999-09-09- DATE DEFN   00180099
S30328*                              MOVE AS PITS P000853786            00190099
S30328*W30021  05-15-2006 P KEBER    BYPASS THE DA NOTES CHECK FOR NEW  00191099
S30328*                              OFF INVOICE DEBIT TYPES.           00192099
8613F *8613F   07-17-2015 S BARTELT  RMS 9 REMEDIATION. CHANGED FROM    00193099
      *                              AUTO LOGON TO EXTERNAL SIGN ON     00194099
265366*265366  01-09-2022 B SCHULTZ  RECOMPILED THE PROGRAM             00195099
      ******************************************************************00200017
                                                                        00210016
       ENVIRONMENT DIVISION.                                            00220016
       CONFIGURATION SECTION.                                           00230016
       SOURCE-COMPUTER. IBM-3090.                                       00240016
       OBJECT-COMPUTER. IBM-3090.                                       00250016
                                                                        00260017
       INPUT-OUTPUT SECTION.                                            00270016
       FILE-CONTROL.                                                    00280016
                                                                        00290017
           SELECT INPUT-FILE                                            00300099
               ASSIGN TO INP01.                                         00310099
                                                                        00320099
8613F      SELECT ORACLE-LOGIN-FILE          ASSIGN TO ORALOGON.        00331099
22405                                                                   00340099
           SELECT OUTPUT-FILE                                           00350035
               ASSIGN TO OUT01.                                         00360035
                                                                        00370016
       DATA DIVISION.                                                   00380016
       FILE SECTION.                                                    00390016
                                                                        00400017
       FD  INPUT-FILE                                                   00410099
           RECORDING MODE IS F                                          00420099
           LABEL RECORDS ARE STANDARD                                   00430099
           RECORD CONTAINS 50 CHARACTERS                                00440099
           DATA RECORD IS DARD104-RECORD.                               00450099
                                                                        00460099
           COPY DARD104.                                                00470099
                                                                        00480099
8613F  FD  ORACLE-LOGIN-FILE                                            00481099
8613F      RECORDING MODE IS F                                          00482099
8613F      LABEL RECORDS ARE STANDARD                                   00483099
8613F      BLOCK CONTAINS 0 RECORDS                                     00484099
8613F      DATA RECORD IS ORACLE-LOGIN-REC.                             00485099
8613F  01  ORACLE-LOGIN-REC.                                            00486099
8613F      05  FILLER                  PIC X(80).                       00487099
22405                                                                   00650099
       FD  OUTPUT-FILE                                                  00660021
           LABEL RECORDS ARE STANDARD                                   00670000
           RECORDING MODE IS F                                          00680000
           RECORD CONTAINS 120 CHARACTERS                               00690099
           DATA RECORD IS OUTPUT-RECORD.                                00700034
                                                                        00710034
       01  OUTPUT-RECORD            PIC X(120).                         00720099
                                                                        00730000
      /*****************************************************************00740099
       WORKING-STORAGE SECTION.                                         00750016
      ******************************************************************00760017
                                                                        00770016
       01  PC-PROGRAM-CONSTANTS.                                        00780016
           05  PC-PROGRAM-NAME        PIC X(08)  VALUE 'DAKUT305'.      00790099
8613F      05  PC-AUTO-LOGON          PIC X(01)  VALUE '/'.             00791099
                                                                        00800016
        01 PV-PROGRAM-VARIABLES.                                        00810016
           05  PVP-ABEND-PARAGRAPH    PIC X(40)  VALUE SPACES.          00820052
           05  PVP-ABEND-CODE         PIC S9(04) COMP SYNC VALUE +0000. 00830052
           05  PVP-CURR-DATE          PIC X(10)  VALUE SPACES.          00840099
           05  FILLER REDEFINES PVP-CURR-DATE.                          00850099
               10  PVP-CURR-YEAR      PIC X(04).                        00860099
               10  PVP-CURR-DASH-1    PIC X(01).                        00870099
               10  PVP-CURR-MONTH     PIC X(02).                        00880099
               10  PVP-CURR-DASH-2    PIC X(01).                        00890099
               10  PVP-CURR-DAY       PIC X(02).                        00900099
W03091     05  PV-OPN-FSCL-PERIOD.                                      00910099
  |            10  PV-EDIT-YEAR       PIC X(04).                        00920099
  |            10  PV-EDIT-MONTH      PIC X(02).                        00930099
  |        05  PV-TDAALW-FSCL-PER-NUM.                                  00940099
  |            10  PV-TDAALW-YEAR     PIC 9(04).                        00950099
  |            10  PV-TDAALW-MTH      PIC 9(02).                        00960099
  |        05  PV-TDAALW-FSCL-PERIOD REDEFINES                          00970099
W03091         PV-TDAALW-FSCL-PER-NUM PIC X(06).                        00980099
22405      05  PV-EDIT-ORA-SOURCE           PIC X(04)  VALUE SPACES.    00990099
22405          88  VALID-ORACLE-CONNECT-STRING                          01000099
22405                                       VALUES 'PRD ', 'TST ',      01010099
22405                                              'LRN ', 'QA  ',      01020099
22405                                              'PRDT'.              01030099
22405          88  VALID-DEVELOPMENT-REGION VALUES 'TST ',              01040099
22405                                              'LRN ', 'QA  ',      01050099
22405                                              'PRDT'.              01060099
22405          88  ORA-PROD-REGION          VALUE 'PRD '.               01070099
8613F      05  PV-ORACLE-USERID-LEN   PIC S9(04) VALUE ZEROS.           01071099
8613F      05  PV-ORACLE-PASSWORD-LEN PIC S9(04) VALUE ZEROS.           01072099
                                                                        01080016
       01  PS-PROGRAM-SWITCHES.                                         01090016
           05  PS-DA-TRANS-LEFT-SW          PIC X(01) VALUE 'Y'.        01100021
               88  PS-NO-MORE-DA-TRANS-LEFT           VALUE 'N'.        01110021
               88  PS-MORE-DA-TRANS-LEFT              VALUE 'Y'.        01120021
           05  WS-VEND-APPROV-ERR-SW        PIC X(01) VALUE 'N'.        01130052
               88  VENDOR-APPROVAL-ERROR-FOUND        VALUE 'Y'.        01140052
22405      05  PS-INP02-DONE-SW             PIC X(01)      VALUE 'N'.   01150099
22405          88  INP02-PROCESS-COMPLETE                  VALUE 'Y'.   01160099
8613F      05  PS-ORACLE-LOGIN-EOF-SW       PIC  X    VALUE 'N'.        01161099
8613F          88  ORACLE-LOGIN-EOF                   VALUE 'Y'.        01162099
                                                                        01170016
       01  PS-PROGRAM-ACCUMUALTORS.                                     01180016
           05  PA-ROWS-FETCHED        PIC S9(13) COMP VALUE ZEROS.      01190052
           05  PA-RECORDS-WRITTEN     PIC S9(13) COMP VALUE ZEROS.      01200052
                                                                        01210016
       01  WS-MSG-TEXT                PIC X(512) VALUE SPACES.          01220052
       01  WS-MAX-SIZE                PIC S9(09) COMP VALUE 512.        01230052
       01  WS-MSG-LENGTH              PIC S9(09) COMP VALUE ZEROS.      01240052
                                                                        01250016
       01  WS-CUTOFF-MTH              PIC X(02)  VALUE SPACES.          01260099
       01  WS-CUTOFF-MTH-NUM REDEFINES                                  01270099
           WS-CUTOFF-MTH              PIC 9(02).                        01280099
                                                                        01290052
8613F  01  CC-ORACLE-CONNECTION.                                        01291099
8613F      05  CC-ORACLE-USERID       PIC X(40).                        01292099
8613F          88 CC-AUTO-LOGON                  VALUE '/'.             01293099
8613F      05  CC-ORACLE-PASSWORD     PIC X(40).                        01294099
      ******************************************************************01300032
      * DA ARI REPROT EXTRACT FILE DEFINITION...                        01310032
      ******************************************************************01320032
           COPY DARD103.                                                01330099
                                                                        01340032
      ******************************************************************01350032
      * DB2 CALL TO DAKUT304 (MODULE IS CALLED TO SELECT DB2 ROWS)      01360099
      ******************************************************************01370032
           COPY DAWS304.                                                01380099
                                                                        01390032
      ***************************************************************** 01400040
      * KOHL'S STANDARD DATE ROUTINE DEFINITIONS....                    01410040
      ***************************************************************** 01420040
           COPY DPWS500.                                                01430040
                                                                        01440040
      ******************************************************************01450020
           EXEC SQL BEGIN DECLARE SECTION END-EXEC.                     01460016
      ******************************************************************01470020
                                                                        01480016
       01  USERNAME                       PIC X(10)      VARYING.       01490016
       01  PASSWD                         PIC X(10)      VARYING.       01500016
       01  PC-ENT01-TYPE-CDE              PIC X(02)      VALUE '01'.    01510016
       01  PV-ORACLE-ID                   PIC X(1)       VALUE '/'.     01520016
       01  PV-ITMCLT-CLUSTR               PIC X(40)      VALUE SPACES.  01530007
                                                                        01540007
       01  PROG-VALUES.                                                 01550005
           05  PV-CUTOFF-DATE             PIC X(19)  VALUE SPACES.      01560084
           05  PV-CURR-DTE-MINUS-TEN      PIC X(19)  VALUE SPACES.      01570084
           05  PV-DR-ALW-NBR              PIC X(16)  VALUE SPACES.      01580097
                                                                        01590020
      ******************************************************************01600096
           EXEC SQL                                                     01610096
                VAR PV-DR-ALW-NBR         IS CHARF(16)                  01620098
           END-EXEC.                                                    01630096
                                                                        01640096
      ******************************************************************01650012
      * COBOL DECLARATION FOR TABLE TDAALW                              01660016
      ******************************************************************01670012
           EXEC SQL                                                     01680012
               INCLUDE TDAALW                                           01690012
           END-EXEC.                                                    01700005
                                                                        01710020
      ******************************************************************01720007
      * COBOL DECLARATION FOR TABLE TDANOTE                             01730007
      ******************************************************************01740007
           EXEC SQL                                                     01750007
               INCLUDE TDANOTE                                          01760007
           END-EXEC.                                                    01770007
                                                                        01780020
      ******************************************************************01790020
           EXEC SQL END DECLARE SECTION END-EXEC.                       01800006
      ******************************************************************01810020
      * ORA COMMUNICATION AREA                                          01820006
      ******************************************************************01830020
        01 SQLCA.                                                       01840031
           05  SQLCAID               PIC X(8).                          01850031
           05  SQLCABC               PIC S9(9) COMPUTATIONAL.           01860031
           05  SQLCODE               PIC S9(9) COMPUTATIONAL.           01870031
           05  SQLERRM.                                                 01880031
               49 SQLERRML           PIC S9(4) COMPUTATIONAL.           01890031
               49 SQLERRMC           PIC X(70).                         01900031
           05  SQLERRP               PIC X(8).                          01910031
           05  SQLERRD OCCURS 6 TIMES                                   01920031
                                     PIC S9(9) COMPUTATIONAL.           01930031
           05  SQLWARN.                                                 01940031
               10 SQLWARN0           PIC X(1).                          01950031
               10 SQLWARN1           PIC X(1).                          01960031
               10 SQLWARN2           PIC X(1).                          01970031
               10 SQLWARN3           PIC X(1).                          01980031
               10 SQLWARN4           PIC X(1).                          01990031
               10 SQLWARN5           PIC X(1).                          02000031
               10 SQLWARN6           PIC X(1).                          02010031
               10 SQLWARN7           PIC X(1).                          02020031
           05  SQLEXT                PIC X(8).                          02030031
                                                                        02040024
      ******************************************************************02050020
      * ORA COMMUNICATION AREA2                                         02060016
      ******************************************************************02070020
           COPY SQLCA2.                                                 02080016
                                                                        02090017
      /*****************************************************************02100099
      *FLOW:    THE MODULE SEQUENTIALLY READS THE DEBIT ALLOWANCE CURSOR02110099
      *      LOOKING FOR DAS WHICH HAVE NOT BEEN PROCESSED. (STATUS CODE02120099
      *      LESS '60') SUCCESFUL HITS ARE THEN EDITTED TO DETERMINE    02130099
      *      IF THE ROW SHOULD BE EXTRACTED TO THE DA ARI EXTRACT FILE. 02140099
      *      ALL ROWS ARE EDITTED FOR THE FOLLOWING CRITERIA.           02150099
      *                                                                 02160099
      *      1.  ALL DAS REQUIRE VENDOR NOTES. CHECK THE DEBIT ALLOWANCE02170099
      *          NOTES TABLE TDANOTE FOR AN EXISTING NOTE. GENERATE AN  02180099
      *          DA ARI RECORD IF NOT PRESENT.                          02190099
      *      2.  AGE THE DA BASED ON THE DA EFFECTIVE DATE LESS THAN    02200099
      *          THE SYSTEM DATE MINUS TEN DAYS. ERROR THE ROW IF IT    02210099
      *          QUALIFIES.                                             02220099
      *      3.  DAS MUST BE APPROVED BY THE DMM OR AP. DETERMINE IF THE02230099
      *          DA HAS BEEN APPROVED. IF IN ERROR, WRITE A RECORD TO   02240099
      *          THE EXTRACT.                                           02250099
      *                                                                 02260099
      *      SPECIAL CONSIDERATIONS MUST BE MADE FOR CUTOFF WEEK.       02270099
      *                                                                 02280099
      *      THE MAIN TABLES ARE ORACLE BASED. TO GRAB THE NECESSARY DB202290099
      *      TABLES, WE CALL THE SUB MODULE DAKUT304. WE PASS INFO TO   02300099
      *      AND FROM DAKUT304 FOR ALL DB2 RELATED ROWS TO DAKUT305.    02310099
      *                                                                 02320099
      *      TABLES USED (ORACLE)                                       02330099
      *      1.  TDAALW - DBT ALLOWANCE TABLE                           02340099
      *      2.  TDANOTE - DBT ALLOWANCE NOTES TABLE                    02350099
      *                                                                 02360099
      *      TABLES USED (DB2)                                          02370099
      *      1.  TMDSEAR - MERCHANDISE AREA TABLE                       02380099
      *      2.  TAPLAVL - APPLICATION AVAILABILITY TABLE               02390099
      *      3.  TRSPBAR - RESPONSIBILITY AREA TABLE                    02400099
      *                                                                 02410099
      ******************************************************************02420017
      ******************************************************************02430031
       PROCEDURE DIVISION.                                              02440016
      ******************************************************************02450017
                                                                        02460016
       0000-MAINLINE-LOGIC.                                             02470016
                                                                        02480016
           PERFORM 1000-INITIALIZATION                                  02490031
              THRU 1000-INITIALIZATION-EXIT.                            02500031
                                                                        02510016
           PERFORM 2000-MAIN-LOOP                                       02520031
              THRU 2000-MAIN-LOOP-EXIT                                  02530031
               UNTIL PS-NO-MORE-DA-TRANS-LEFT.                          02540016
                                                                        02550016
           PERFORM 9000-EOJ-LOGIC                                       02560031
              THRU 9000-EOJ-LOGIC-EXIT.                                 02570031
                                                                        02580016
       9999-EXIT-PROGRAM.                                               02590020
           STOP RUN.                                                    02600020
                                                                        02610020
      /*****************************************************************02620099
      * 1000-INITIALIZATION...                                          02630020
      ******************************************************************02640020
       1000-INITIALIZATION.                                             02650016
                                                                        02660021
           OPEN  INPUT INPUT-FILE                                       02670099
8613F            INPUT ORACLE-LOGIN-FILE                                02680099
                OUTPUT OUTPUT-FILE.                                     02690099
                                                                        02700016
           DISPLAY '**********************************'.                02710000
                                                                        02720031
8613F      PERFORM 1001-CONNECT-TO-ORACLE                               02721099
22405      DISPLAY '**********************************'.                02730099
   |       DISPLAY '*'.                                                 02740099
      *** ORACLE - DEFINE THE DATE/TIME FORMAT.                         03660031
W30328*    EXEC SQL                                                     03670099
W30328*     ALTER SESSION                                               03680099
W30328*           SET NLS_DATE_FORMAT = 'YYYY-MM-DD.HH24.MI.SS'         03690099
W30328*    END-EXEC.                                                    03700099
                                                                        03710010
      *** INITIALIZE VARIABLES AND COUNTERS...                          03720099
           INITIALIZE DA304-PARAMATERS.                                 03730099
           INITIALIZE DA103-DA-ARI-EXTRACT-RECORD.                      03740099
                                                                        03750039
           PERFORM 8200-READ-DATEXTR                                    03760099
              THRU 8200-READ-DATEXTR-EXIT.                              03770099
0102RM* PM00438756 -                                                    03780099
      *-- WAS ORIGINALLY USING THE FIRST 4 DIGITS OF THE                03790099
      *-- WAS DA104-OPN-FSCL-MN-DTE.  THIS WAS NOT THE FISCAL           03800099
      *-- MONTH DATE, IT WAS THE CALENDAR. CHANGED TO THE FISCAL        03810099
      *-- YEAR.  THIS ELIMINATED ERRORS WITHIN THE REPORT               03820099
0102RM*    MOVE DA104-OPN-FSCL-MN-DTE (1:4) TO PV-EDIT-YEAR.            03830099
0102RM     MOVE DA104-OPN-FSCL-YR-NBR       TO PV-EDIT-YEAR.            03840099
0102RM     MOVE DA104-OPN-FSCL-MN-NBR       TO PV-EDIT-MONTH.           03850099
0102RM     DISPLAY ' PV-OPN-FSCL-PERIOD ' PV-OPN-FSCL-PERIOD.           03860099
                                                                        03870099
      *** GET THE SYSTEM DATE FOR DATE PROCESSING IN THE EXTRACT...     03880099
           MOVE FUNCTION CURRENT-DATE (1:4)  TO PVP-CURR-YEAR.          03890099
           MOVE '-'                          TO PVP-CURR-DASH-1.        03900099
           MOVE FUNCTION CURRENT-DATE (5:2)  TO PVP-CURR-MONTH.         03910099
           MOVE '-'                          TO PVP-CURR-DASH-2.        03920099
           MOVE FUNCTION CURRENT-DATE (7:2)  TO PVP-CURR-DAY.           03930099
                                                                        03940099
      *** KOHL'S DATE ROUTINE CUTOFF DATE CALCULATIONS....              03950040
      *** 1.  CURRENT DATE MINUS 10 DAY CUTOFF CALCULATION...           03960045
           INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              03970045
           SET DPG51-ACTUAL-CALENDAR-ONLY TO TRUE.                      03980045
           SET DPG51-DECREMENT-DATE       TO TRUE.                      03990045
           SET DPG52-LK-DTE-ISO-FMT       TO TRUE.                      04000045
           MOVE 10                        TO DPG51-INCR-DECR-DAYS-9.    04010045
           MOVE PVP-CURR-DATE             TO DPG52-LK-DATE-INPUT.       04020099
                                                                        04030045
           CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                04040045
                                                   DPG52                04050045
                                                   DPG53                04060045
                                                   DPG54                04070045
                                                   DPG55                04080045
                                                   DPG56.               04090045
                                                                        04100045
           EVALUATE TRUE                                                04110045
             WHEN DPG54-SEVERE-ERROR                                    04120045
             WHEN DPG54-WARNING-ERROR                                   04130045
               DISPLAY '** ABEND - CURRENT DATE MINUS 10 DAY '          04140045
                       PC-PROGRAM-NAME ' **'                            04150045
               DISPLAY '** BAD CALL TO CALENDAR ROUTINE'                04160045
               DISPLAY DPG54-ERROR-MESSAGE                              04170045
               DISPLAY 'DPG51 INPUT PARMS: ' DPG51                      04180045
               DISPLAY 'DPG52 INPUT PARMS: ' DPG52                      04190045
               DISPLAY 'DPG53 INPUT PARMS: ' DPG53                      04200045
               DISPLAY 'DPG54 RESPONSE   : ' DPG54                      04210045
               DISPLAY '** 1000-INITIALIZATION '                        04220045
               PERFORM 9950-SQL-ERROR                                   04230045
           END-EVALUATE.                                                04240045
                                                                        04250045
           STRING DPG55-DB2-ISO-DATE-FMT DELIMITED BY SIZE              04260086
                  '.00.00.00' DELIMITED BY SIZE                         04270084
                                     INTO PV-CURR-DTE-MINUS-TEN.        04280084
                                                                        04290045
      *** 2.  FISCAL CUTOFF WEEK DATE CALCULATION.....                  04300099
           INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              04310045
           SET DPG51-FISCAL-454-CALENDAR TO TRUE.                       04320099
           SET DPG51-INCREMENT-DATE      TO TRUE.                       04330099
           SET DPG52-LK-DTE-ISO-FMT      TO TRUE.                       04340099
           MOVE 4                        TO DPG51-INCR-DECR-DAYS-9.     04350099
           MOVE DA104-OPN-FSCL-MN-DTE    TO DPG52-LK-DATE-INPUT.        04360099
                                                                        04370045
           CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                04380045
                                                   DPG52                04390045
                                                   DPG53                04400045
                                                   DPG54                04410045
                                                   DPG55                04420045
                                                   DPG56.               04430045
                                                                        04440045
           EVALUATE TRUE                                                04450045
             WHEN DPG54-SEVERE-ERROR                                    04460045
             WHEN DPG54-WARNING-ERROR                                   04470045
               DISPLAY '** ABEND - FISCAL CUTOFF WEEK DATE CALCULATION '04480045
                       PC-PROGRAM-NAME ' **'                            04490045
               DISPLAY '** BAD CALL TO CALENDAR ROUTINE'                04500045
               DISPLAY DPG54-ERROR-MESSAGE                              04510045
               DISPLAY 'DPG51 INPUT PARMS: ' DPG51                      04520045
               DISPLAY 'DPG52 INPUT PARMS: ' DPG52                      04530045
               DISPLAY 'DPG53 INPUT PARMS: ' DPG53                      04540045
               DISPLAY 'DPG54 RESPONSE   : ' DPG54                      04550045
               DISPLAY '** 1000-INITIALIZATION '                        04560045
               PERFORM 9950-SQL-ERROR                                   04570045
           END-EVALUATE.                                                04580045
                                                                        04590045
           STRING DPG55-DB2-ISO-DATE-FMT DELIMITED BY SIZE              04600086
                  '.00.00.00' DELIMITED BY SIZE                         04610084
                                     INTO PV-CUTOFF-DATE.               04620084
                                                                        04630057
      *** ORACLE - TABLE CURSOR TDAALW-INFO                             04640056
           EXEC SQL                                                     04650056
             DECLARE TDAALW_INFO CURSOR FOR                             04660056
               SELECT DR_ALW_NBR,                                       04670099
                      NVL(DEPT_NBR,'   '),                              04680099
                      NVL(SUB_CL_NBR,'  '),                             04690099
S30328*               NVL(EFF_DTE,'9999-09-09.00.00.00'),               04700099
S30328                NVL(TO_CHAR(EFF_DTE,'YYYY-MM-DD.HH24.MI.SS'),     04710099
S30328                                    '9999-09-09.00.00.00'),       04720099
                      NVL(FSCL_MN_NBR,0),                               04730099
W03091                NVL(FSCL_YR_NBR,0),                               04740099
                      NVL(STAT_CDE, '  '),                              04750099
22405                 NVL(TYP_CDE, '  '),                               04760099
                      NVL(CRE_BY_USR_ID,'        '),                    04770099
S30328*               NVL(CRE_DTE,'9999-09-09.00.00.00'),               04780099
S30328                NVL(TO_CHAR(CRE_DTE,'YYYY-MM-DD.HH24.MI.SS'),     04790099
S30328                                    '9999-09-09.00.00.00'),       04800099
                      NVL(DMM_UPD_BY_USR_ID,'        '),                04810099
S30328*               NVL(DMM_UPD_DTE,'9999-09-09.00.00.00'),           04820099
S30328                NVL(TO_CHAR(DMM_UPD_DTE,'YYYY-MM-DD.HH24.MI.SS'), 04830099
S30328                                        '9999-09-09.00.00.00'),   04840099
                      NVL(AP_UPD_BY_USR_ID,'        '),                 04850099
S30328*               NVL(AP_UPD_DTE,'9999-09-09.00.00.00'),            04860099
S30328                NVL(TO_CHAR(AP_UPD_DTE,'YYYY-MM-DD.HH24.MI.SS'),  04870099
S30328                                       '9999-09-09.00.00.00'),    04880099
                      NVL(LAST_UPD_BY_USR_ID,'        '),               04890099
S30328*               NVL(LAST_UPD_DTE,'9999-09-09.00.00.00')           04900099
S30328                NVL(TO_CHAR(LAST_UPD_DTE,'YYYY-MM-DD.HH24.MI.SS'),04910099
S30328                                       '9999-09-09.00.00.00')     04920099
               FROM TDAALW                                              04930056
               WHERE STAT_CDE < '60'                                    04940056
           END-EXEC.                                                    04950056
                                                                        04960057
      *** ORACLE - OPEN CURSOR...                                       04970031
           PERFORM 8000-OPEN-TDAALW-CURSOR                              04980031
              THRU 8000-OPEN-TDAALW-CURSOR-EXIT.                        04990031
                                                                        05000031
       1000-INITIALIZATION-EXIT.                                        05010031
           EXIT.                                                        05020031
                                                                        05030031
8613F ******************************************************************05031099
8613F * LOGONS TO ORACLE.                                              *05032099
8613F ******************************************************************05033099
8613F *    - READ THE CONTROL CARD TO GET THE CREDENTIALS AND LOGON    *05034099
8613F *    - ORACLE                                                    *05035099
8613F *----------------------------------------------------------------*05036099
8613F  1001-CONNECT-TO-ORACLE.                                          05037099
8613F      DISPLAY '**********************************'.                05038099
8613F      DISPLAY '**------ BEGIN DAKUT305 ------**'.                  05039099
8613F      DISPLAY '**********************************'.                05039199
8613F                                                                   05039299
8613F      MOVE '1001-CONNECT-TO-ORACLE'   TO PVP-ABEND-PARAGRAPH.      05039399
8613F                                                                   05039499
8613F      READ ORACLE-LOGIN-FILE INTO CC-ORACLE-CONNECTION             05039599
8613F         AT END                                                    05039699
8613F            SET ORACLE-LOGIN-EOF      TO TRUE.                     05039799
8613F                                                                   05039899
8613F      IF CC-AUTO-LOGON                                             05039999
8613F         DISPLAY PC-PROGRAM-NAME ' - AUTO LOGON TO ORACLE'         05040099
8613F         EXEC SQL                                                  05040199
8613F              CONNECT :PC-AUTO-LOGON                               05040299
8613F         END-EXEC                                                  05040399
8613F      ELSE                                                         05040499
8613F         INITIALIZE PV-ORACLE-USERID-LEN                           05040599
8613F                    PV-ORACLE-PASSWORD-LEN                         05040699
8613F         INSPECT CC-ORACLE-USERID                                  05040799
8613F                 TALLYING PV-ORACLE-USERID-LEN                     05040899
8613F                 FOR CHARACTERS BEFORE INITIAL SPACE               05040999
8613F         INSPECT CC-ORACLE-PASSWORD                                05041099
8613F                 TALLYING PV-ORACLE-PASSWORD-LEN                   05041199
8613F                 FOR CHARACTERS BEFORE INITIAL SPACE               05041299
8613F         MOVE CC-ORACLE-USERID (1:PV-ORACLE-USERID-LEN)     TO     05041399
8613F                 USERNAME-ARR                                      05041499
8613F         MOVE PV-ORACLE-USERID-LEN    TO USERNAME-LEN              05041599
8613F         MOVE CC-ORACLE-PASSWORD (1:PV-ORACLE-PASSWORD-LEN) TO     05041699
8613F                 PASSWD-ARR                                        05041799
8613F         MOVE PV-ORACLE-PASSWORD-LEN  TO PASSWD-LEN                05041899
8613F         MOVE CC-ORACLE-PASSWORD (1:PV-ORACLE-PASSWORD-LEN) TO     05041999
8613F              PASSWD-ARR                                           05042099
8613F         MOVE PV-ORACLE-PASSWORD-LEN  TO PASSWD-LEN                05042199
8613F         MOVE CC-ORACLE-USERID (1:PV-ORACLE-USERID-LEN)     TO     05042299
8613F              USERNAME-ARR                                         05042399
8613F         MOVE PV-ORACLE-USERID-LEN    TO USERNAME-LEN              05042499
8613F         MOVE CC-ORACLE-PASSWORD (1:PV-ORACLE-PASSWORD-LEN) TO     05042599
8613F              PASSWD-ARR                                           05042699
8613F         MOVE PV-ORACLE-PASSWORD-LEN  TO PASSWD-LEN                05042799
8613F         DISPLAY PC-PROGRAM-NAME  ' - LOGON TO ORACLE AS USER '    05042899
8613F              USERNAME-ARR                                         05042999
8613F         EXEC SQL                                                  05043099
8613F              CONNECT :USERNAME IDENTIFIED BY :PASSWD              05043199
8613F         END-EXEC                                                  05043299
8613F         INITIALIZE CC-ORACLE-PASSWORD                             05043399
8613F                    PASSWD                                         05043499
8613F      END-IF.                                                      05043599
8613F                                                                   05043699
8613F      IF (SQLCODE NOT = 0)                                         05043799
8613F          DISPLAY PVP-ABEND-PARAGRAPH                              05043899
8613F          PERFORM 9950-SQL-ERROR                                   05043999
8613F      END-IF.                                                      05044099
                                                                        05044199
                                                                        05045799
       EJECT                                                            05045899
      /*****************************************************************05046099
      * 2000-MAIN PROCESS LOOP.                                         05050031
      ******************************************************************05060026
       2000-MAIN-LOOP.                                                  05070031
      *** ORACLE - FETCH ROWS UNIQUE TO THE CURSOR...                   05080031
                                                                        05090031
           MOVE '2000-MAIN-LOOP' TO PVP-ABEND-PARAGRAPH.                05100052
                                                                        05110031
           EXEC SQL                                                     05120031
               FETCH TDAALW_INFO                                        05130031
                 INTO :DAALW-DR-ALW-NBR,                                05140060
                      :DAALW-DEPT-NBR,                                  05150060
                      :DAALW-SUB-CL-NBR,                                05160060
                      :DAALW-EFF-DTE,                                   05170060
                      :DAALW-FSCL-MN-NBR,                               05180060
W03091                :DAALW-FSCL-YR-NBR,                               05190099
                      :DAALW-STAT-CDE,                                  05200060
22405                 :DAALW-TYP-CDE,                                   05210099
                      :DAALW-CRE-BY-USR-ID,                             05220060
                      :DAALW-CRE-DTE,                                   05230060
                      :DAALW-DMM-UPD-BY-USR-ID,                         05240099
                      :DAALW-DMM-UPD-DTE,                               05250099
                      :DAALW-AP-UPD-BY-USR-ID,                          05260099
                      :DAALW-AP-UPD-DTE,                                05270099
                      :DAALW-LAST-UPD-BY-USR-ID,                        05280060
                      :DAALW-LAST-UPD-DTE                               05290060
           END-EXEC.                                                    05300031
                                                                        05310031
           EVALUATE TRUE                                                05320031
             WHEN SQLCODE IS EQUAL TO ZEROS                             05330031
               PERFORM 3000-EXTRACT-INFORMATION                         05340031
                  THRU 3000-EXTRACT-INFORMATION-EXIT                    05350031
             WHEN SQLCODE IS EQUAL TO 1403                              05360031
               SET PS-NO-MORE-DA-TRANS-LEFT TO TRUE                     05370032
             WHEN OTHER                                                 05380031
               DISPLAY PVP-ABEND-PARAGRAPH                              05390052
               PERFORM 9950-SQL-ERROR                                   05400031
           END-EVALUATE.                                                05410031
                                                                        05420031
       2000-MAIN-LOOP-EXIT.                                             05430031
           EXIT.                                                        05440031
                                                                        05450031
      /*****************************************************************05460099
      * 3000-EXTRACT INFORMATION...                                     05470031
      * DETERMINE IF THE DA IS IN ERROR. IF SO, GENERATE AN EXTRACT     05480060
      * RECORD.                                                         05490060
      ******************************************************************05500031
       3000-EXTRACT-INFORMATION.                                        05510031
                                                                        05520032
           MOVE '3000-EXTRACT-INFORMATION' TO PVP-ABEND-PARAGRAPH.      05530052
           ADD 1                    TO PA-ROWS-FETCHED.                 05540036
                                                                        05550032
      *** ORACLE - EDIT FOR MISSING VENDOR NOTES...                     05560037
W30021     IF NOT (DAALW-TYP-CDE = 'PR' OR 'PC' OR 'AC')                05561099
               PERFORM 4000-EDIT-VENDOR-NOTES                           05570099
                  THRU 4000-EDIT-VENDOR-NOTES-EXIT                      05580099
W30021     END-IF.                                                      05590099
                                                                        05591099
      *** ORACLE - EDIT FOR DMM AND/OR AP APPROVAL....                  05600037
           PERFORM 4100-EDIT-VEND-APPROVAL                              05610037
              THRU 4100-EDIT-VEND-APPROVAL-EXIT                         05620037
                                                                        05630037
      *** ORACLE - DATE CHECK EDITS....                                 05640037
           PERFORM 4200-EDIT-DATE-CHECKS                                05650037
              THRU 4200-EDIT-DATE-CHECKS-EXIT.                          05660051
                                                                        05670037
       3000-EXTRACT-INFORMATION-EXIT.                                   05680031
           EXIT.                                                        05690031
                                                                        05700031
      /*****************************************************************05710099
      * 4000-EDIT FOR VENDOR NOTES (TDANOTE)...                         05720037
      * DAS ARE REQUIRED TO HAVE VERBIAGE. VERIFY THAT WE HAVE A NOTE   05730060
      * FOR THE DEBIT ALLOWANCE.                                        05740037
      ******************************************************************05750037
       4000-EDIT-VENDOR-NOTES.                                          05760037
                                                                        05770037
           MOVE '4000-EDIT-VENDOR-NOTES' TO PVP-ABEND-PARAGRAPH.        05780052
                                                                        05790037
           MOVE DAALW-DR-ALW-NBR    TO PV-DR-ALW-NBR.                   05800096
                                                                        05810096
22405      IF DAALW-TYP-CDE IS EQUAL TO 'AR'                            05820099
22405          MOVE 'K'             TO DANOTE-NOTE-TYP-CDE              05830099
22405      ELSE                                                         05840099
22405          MOVE 'V'             TO DANOTE-NOTE-TYP-CDE              05850099
22405      END-IF.                                                      05860099
22405                                                                   05870099
           EXEC SQL                                                     05880084
               SELECT DR_ALW_NBR                                        05890096
                 INTO :DANOTE-DR-ALW-NBR                                05900096
               FROM TDANOTE                                             05910092
               WHERE DR_ALW_NBR = :PV-DR-ALW-NBR                        05920096
22405            AND NOTE_TYP_CDE = :DANOTE-NOTE-TYP-CDE                05930099
22405 ********   AND NOTE_TYP_CDE = 'V'                                 05940099
           END-EXEC.                                                    05950084
                                                                        05960084
           EVALUATE TRUE                                                05970037
             WHEN SQLCODE IS EQUAL TO ZEROS                             05980055
               CONTINUE                                                 05990095
             WHEN SQLCODE IS EQUAL TO 1403                              06000065
22405          IF DAALW-TYP-CDE IS EQUAL TO 'AR'                        06010099
22405            MOVE 'KOHLS NOTES REQUIRED' TO DA103-ERR-MSG-TXT       06020099
22405          ELSE                                                     06030099
                 MOVE 'MISSING VENDOR NOTES' TO DA103-ERR-MSG-TXT       06040099
22405          END-IF                                                   06050099
               PERFORM 5000-GENERATE-RECORD                             06060037
                  THRU 5000-GENERATE-RECORD-EXIT                        06070037
             WHEN OTHER                                                 06080065
               DISPLAY PVP-ABEND-PARAGRAPH                              06090065
               PERFORM 9950-SQL-ERROR                                   06100065
           END-EVALUATE.                                                06110037
                                                                        06120037
       4000-EDIT-VENDOR-NOTES-EXIT.                                     06130037
           EXIT.                                                        06140037
                                                                        06150037
      ******************************************************************06160037
      * 4100-EDIT FOR DMM AND/OR AP APPROVAL (TDAALW)                   06170037
      * DAS NEED TO BE APPROVED BY EITHER DMM OR AP.                    06180060
      ******************************************************************06190037
       4100-EDIT-VEND-APPROVAL.                                         06200037
                                                                        06210041
           MOVE '4100-EDIT-VEND-APPROVAL' TO PVP-ABEND-PARAGRAPH.       06220052
           MOVE 'N'                       TO WS-VEND-APPROV-ERR-SW.     06230052
                                                                        06240099
      *-- MOVED THE FOLLOWING CODE TO AFTER THE READ OF THE CONTROL     06250099
      *-- CARD.  SEE 1000-INITIALIZATION.                               06260099
W03091*    MOVE DA104-OPN-FSCL-MN-DTE (1:4) TO PV-EDIT-YEAR.            06270099
  |   *    MOVE DA104-OPN-FSCL-MN-NBR       TO PV-EDIT-MONTH.           06280099
  |                                                                     06290099
  |        MOVE DAALW-FSCL-YR-NBR           TO PV-TDAALW-YEAR.          06300099
  |        MOVE DAALW-FSCL-MN-NBR           TO PV-TDAALW-MTH.           06310099
  |                                                                     06320099
  |        IF PV-TDAALW-FSCL-PERIOD LESS THAN PV-OPN-FSCL-PERIOD        06330099
  |            MOVE 'DA NOT APPROVED BY DMM, MONTH IS CLOSED'           06340099
  |                                      TO DA103-ERR-MSG-TXT           06350099
  |            PERFORM 5000-GENERATE-RECORD                             06360099
  |               THRU 5000-GENERATE-RECORD-EXIT                        06370099
  |        END-IF.                                                      06380099
  |                                                                     06390099
  |   *    IF DAALW-DMM-UPD-DTE IS GREATER THAN PV-CUTOFF-DATE  AND     06400099
  |   *       DAALW-DMM-UPD-DTE NOT EQUAL '9999-09-09.00.00.00'         06410099
  |   *        MOVE 'DA NOT APPROVED BY DMM, MONTH IS CLOSED'           06420099
  |   *                                  TO DA103-ERR-MSG-TXT           06430099
  |   *        PERFORM 5000-GENERATE-RECORD                             06440099
  |   *           THRU 5000-GENERATE-RECORD-EXIT                        06450099
  |   *        MOVE 'Y'                  TO WS-VEND-APPROV-ERR-SW       06460099
  |   *    END-IF.                                                      06470099
  |   *                                                                 06480099
  |   *    IF DAALW-AP-UPD-DTE IS GREATER THAN PV-CUTOFF-DATE  AND      06490099
  |   *       DAALW-AP-UPD-DTE NOT EQUAL '9999-09-09.00.00.00' AND      06500099
  |   *       (NOT VENDOR-APPROVAL-ERROR-FOUND)                         06510099
  |   *        MOVE 'DA NOT APPROVED BY AP, MONTH IS CLOSED'            06520099
  |   *                                  TO DA103-ERR-MSG-TXT           06530099
  |   *        PERFORM 5000-GENERATE-RECORD                             06540099
  |   *           THRU 5000-GENERATE-RECORD-EXIT                        06550099
  |   *        MOVE 'Y'                  TO WS-VEND-APPROV-ERR-SW       06560099
  |   *    END-IF.                                                      06570099
W03091*                                                                 06580099
       4100-EDIT-VEND-APPROVAL-EXIT.                                    06590037
           EXIT.                                                        06600037
                                                                        06610037
      ******************************************************************06620037
      * 4200-DATE CHECK EDITS (TDAALW)                                  06630037
      ******************************************************************06640037
       4200-EDIT-DATE-CHECKS.                                           06650037
                                                                        06660052
           MOVE '4200-EDIT-DATE-CHECKS' TO PVP-ABEND-PARAGRAPH.         06670052
                                                                        06680052
W03091**** MOVE PV-CUTOFF-DATE (6:2)    TO WS-CUTOFF-MTH.               06690099
                                                                        06700099
           IF DAALW-EFF-DTE IS LESS THAN PV-CURR-DTE-MINUS-TEN OR       06710052
              DAALW-EFF-DTE IS EQUAL TO PV-CURR-DTE-MINUS-TEN           06720052
W03091****   IF DAALW-FSCL-MN-NBR IS LESS THAN (WS-CUTOFF-MTH-NUM - 1)  06730099
W03091       IF PV-TDAALW-FSCL-PERIOD LESS THAN PV-OPN-FSCL-PERIOD      06740099
               MOVE 'DA NEEDS TO BE APPROVD BEFORE PROCESSING'          06750061
                                        TO DA103-ERR-MSG-TXT            06760099
               PERFORM 5000-GENERATE-RECORD                             06770052
                  THRU 5000-GENERATE-RECORD-EXIT                        06780099
             END-IF                                                     06790099
           END-IF.                                                      06800099
                                                                        06810052
       4200-EDIT-DATE-CHECKS-EXIT.                                      06820037
           EXIT.                                                        06830037
                                                                        06840037
      /*****************************************************************06850099
      * 5000-GENERATE THE EXTRACT FILE RECORD...                        06860037
      ******************************************************************06870037
       5000-GENERATE-RECORD.                                            06880037
                                                                        06890037
           MOVE '5000-GENERATE-RECORD' TO PVP-ABEND-PARAGRAPH.          06900052
                                                                        06910037
      *** DB2 - CALL OUT TO DAKUT304 TO GET INFORMATION FOR THE EXTRACT.06920099
           MOVE DAALW-DEPT-NBR      TO DA304-DEPT-NBR.                  06930099
           MOVE DAALW-SUB-CL-NBR    TO DA304-SUB-CL-NBR.                06940099
           MOVE DAALW-EFF-DTE       TO DA304-EFF-DTE.                   06950099
           SET DA304-REG-SELECT-FOR-DAKUT305 TO TRUE.                   06960099
                                                                        06970037
           CALL 'DAKUT304'          USING DA304-PARAMATERS.             06980099
           IF DA304-BAD-CALL                                            06990099
               SET PS-NO-MORE-DA-TRANS-LEFT TO TRUE                     07000037
               DISPLAY DAALW-DEPT-NBR                                   07010099
               DISPLAY DAALW-SUB-CL-NBR                                 07020099
               DISPLAY DA304-GENERAL-ERROR-MESSAGE                      07030099
               PERFORM 9950-SQL-ERROR                                   07040041
           END-IF.                                                      07050041
                                                                        07060037
      *** MOVE INFORMATION TO THE EXTRACT FILE.. (ORACLE & DB2)         07070099
                                                                        07080099
           MOVE DAALW-DEPT-NBR             TO DA103-DEPT-NBR.           07090099
           MOVE DAALW-SUB-CL-NBR           TO DA103-SUB-CL-NBR.         07100099
           MOVE DAALW-EFF-DTE              TO DA103-EFF-DTE.            07110099
           MOVE DAALW-DR-ALW-NBR           TO DA103-DR-ALW-NBR.         07120099
           MOVE DA304-MBS-BUYER-NBR        TO DA103-BYR-NBR.            07130099
           MOVE DA304-BUYER-LAST-NAME      TO DA103-BYR-LAST-NAME.      07140099
           MOVE DA304-BUYER-FIRST-NAME     TO DA103-BYR-FIRST-NAME.     07150099
22405      MOVE DAALW-TYP-CDE              TO DA103-TYP-CDE.            07160099
                                                                        07170037
           WRITE OUTPUT-RECORD      FROM DA103-DA-ARI-EXTRACT-RECORD.   07180099
           ADD 1                    TO PA-RECORDS-WRITTEN.              07190037
                                                                        07200037
       5000-GENERATE-RECORD-EXIT.                                       07210037
           EXIT.                                                        07220037
                                                                        07230037
      /*****************************************************************07240099
      * 8000-OPEN THE TDAALW INFORMATION CURSOR...                      07250031
      ******************************************************************07260031
       8000-OPEN-TDAALW-CURSOR.                                         07270031
                                                                        07280031
           MOVE '8000-OPEN-TDAALW-CURSOR' TO PVP-ABEND-PARAGRAPH.       07290052
                                                                        07300031
           EXEC SQL                                                     07310031
               OPEN TDAALW_INFO                                         07320031
           END-EXEC.                                                    07330031
                                                                        07340031
           EVALUATE TRUE                                                07350031
             WHEN SQLCODE IS EQUAL TO ZEROS                             07360031
               CONTINUE                                                 07370031
             WHEN SQLCODE IS EQUAL TO 1403                              07380099
               SET PS-NO-MORE-DA-TRANS-LEFT TO TRUE                     07390031
             WHEN OTHER                                                 07400031
               DISPLAY PVP-ABEND-PARAGRAPH                              07410052
               PERFORM 9950-SQL-ERROR                                   07420031
           END-EVALUATE.                                                07430031
                                                                        07440031
       8000-OPEN-TDAALW-CURSOR-EXIT.                                    07450031
           EXIT.                                                        07460031
                                                                        07470031
      ******************************************************************07480031
      * 8100-CLOSE THE TDAALW CURSOR.                                   07490031
      ******************************************************************07500031
       8100-CLOSE-TDAALW-CURSOR.                                        07510031
                                                                        07520031
           MOVE '8100-CLOSE-TDAALW-INFO-CURSOR' TO PVP-ABEND-PARAGRAPH. 07530052
                                                                        07540031
           EXEC SQL                                                     07550031
               CLOSE TDAALW_INFO                                        07560031
           END-EXEC.                                                    07570031
                                                                        07580031
           EVALUATE TRUE                                                07590031
             WHEN SQLCODE IS EQUAL TO ZEROS                             07600031
               CONTINUE                                                 07610031
             WHEN OTHER                                                 07620031
               DISPLAY PVP-ABEND-PARAGRAPH                              07630052
               PERFORM 9950-SQL-ERROR                                   07640031
           END-EVALUATE.                                                07650031
                                                                        07660031
       8100-CLOSE-TDAALW-CURSOR-EXIT.                                   07670031
           EXIT.                                                        07680031
                                                                        07690031
      ******************************************************************07700099
      * 8200-READ THE DATEXTR DATE FILE.....                            07710099
      ******************************************************************07720099
       8200-READ-DATEXTR.                                               07730099
                                                                        07740099
           MOVE '8200-READ-DATEXTR' TO PVP-ABEND-PARAGRAPH.             07750099
                                                                        07760099
           INITIALIZE DARD104-RECORD.                                   07770099
                                                                        07780099
           READ INPUT-FILE NEXT                                         07790099
               AT END MOVE PVP-CURR-DATE TO DA104-OPN-FSCL-MN-DTE       07800099
                      CLOSE INPUT-FILE                                  07810099
                      OPEN INPUT INPUT-FILE.                            07820099
                                                                        07830099
       8200-READ-DATEXTR-EXIT.                                          07840099
           EXIT.                                                        07850099
                                                                        07860099
      /*****************************************************************07870099
      * 9000-END OF JOB TASKS...                                        07880031
      ******************************************************************07890018
       9000-EOJ-LOGIC.                                                  07900031
                                                                        07910031
           CLOSE INPUT-FILE                                             07920099
                 OUTPUT-FILE.                                           07940099
                                                                        07950031
      *** ORACLE - CLOSE THE CURSOR....                                 07960031
           PERFORM 8100-CLOSE-TDAALW-CURSOR                             07970031
              THRU 8100-CLOSE-TDAALW-CURSOR-EXIT.                       07980031
                                                                        07990031
           DISPLAY 'ROWS FETCHED    ' PA-ROWS-FETCHED.                  08000014
           DISPLAY 'RECORDS WRITTEN ' PA-RECORDS-WRITTEN.               08010014
                                                                        08020014
       9000-EOJ-LOGIC-EXIT.                                             08030031
           EXIT.                                                        08040031
                                                                        08050031
      ******************************************************************08170031
      * 9950-SQL ABEND ROUTINE..                                        08180031
      ******************************************************************08190031
       9950-SQL-ERROR.                                                  08200022
                                                                        08210000
           MOVE SQLCODE TO SQLCODE2.                                    08220031
           MOVE SQLERRD(3) TO SQLERRD3.                                 08230031
                                                                        08240031
           DISPLAY '** ABEND **       ** = SQLERROR'.                   08250000
           DISPLAY '** PROGRAM        ** = DAKUT305'.                   08260099
           DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  08270000
           DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  08280000
           DISPLAY '** SQLERRM        ** = ' SQLERRM.                   08290000
           DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  08300000
           DISPLAY '** SQLERRD(5)     ** = ' SQLERRD(5).                08310000
                                                                        08320000
           MOVE SPACES TO WS-MSG-TEXT.                                  08330000
                                                                        08340000
           CALL 'SQLGLM' USING WS-MSG-TEXT,                             08350000
                               WS-MAX-SIZE,                             08360000
                               WS-MSG-LENGTH.                           08370000
                                                                        08380032
           DISPLAY 'MESSAGE TEXT      ** = ' WS-MSG-TEXT.               08390000
                                                                        08400000
           MOVE +4013 TO PVP-ABEND-CODE.                                08410052
           CALL 'ILBOABN0' USING PVP-ABEND-CODE.                        08420052
