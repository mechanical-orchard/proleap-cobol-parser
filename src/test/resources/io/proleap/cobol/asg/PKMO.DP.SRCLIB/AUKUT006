000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.         AUKUT006.                                    00020000
000300 AUTHOR.             BARB ERTL.                                   00030000
000400 INSTALLATION.       KOHLS DEPARTMENT STORES.                     00040000
000500 DATE-WRITTEN.       FEBRUARY 2008.                               00050000
000600 DATE-COMPILED.                                                   00060000
000700                                                                  00070000
000800******************************************************************00080000
000900* THIS PROGRAM WILL MATCH 3RD PARTY GIFT CARD AUTHORIZATIONS     *00090000
001000* TO THE BLACKHAWK RECONCILIATION FILE.                          *00100000
001100*                                                                *00110000
001200******************************************************************00120000
001300                                                                  00130000
001400******************************************************************00140000
001500 ENVIRONMENT DIVISION.                                            00150000
001600******************************************************************00160000
001700                                                                  00170000
001800 CONFIGURATION SECTION.                                           00180000
001900                                                                  00190000
002000 SOURCE-COMPUTER.    IBM-3090.                                    00200000
002100 OBJECT-COMPUTER.    IBM-3090.                                    00210000
002200                                                                  00220000
002300 INPUT-OUTPUT SECTION.                                            00230000
002400                                                                  00240000
002500 FILE-CONTROL.                                                    00250000
002600                                                                  00260000
002700     SELECT GC-EXTRACT-FILE      ASSIGN TO INP01.                 00270000
002800     SELECT RECONCILIATION-FILE  ASSIGN TO INP02.                 00280000
002900     SELECT POSTING-FILE         ASSIGN TO OUT01.                 00290000
003000     SELECT REPORT-FILE          ASSIGN TO OUT02.                 00300000
003100                                                                  00310000
003200******************************************************************00320000
003300 DATA DIVISION.                                                   00330000
003400******************************************************************00340000
CH6602******************************************************************00341002
CH6602*  03/15/2016  CHANGES TO WRITE OUT THE RECORD THAT HAS INVALID  *00342002
CH6602*              AUTHORIZATION CODE INSEAD OF ABENDING IT.         *00343002
CH6602*              THIS PROGRAM WAS WRITING THE SPACES FOR THOSE     *00344002
CH6602*              RECORDS THAT GET  INVALID AUTHORIZATION CODE      *00344102
CH6602*              WHICH IN TURN CAUSE THE REPORT PROGRAM TO ABEND.  *00344202
CH6602*  MADE BY: COGNIZANT                        CHG0136602          *00345002
CH6602***************************************************************** 00346002
003500                                                                  00350000
003600 FILE SECTION.                                                    00360000
003700                                                                  00370000
003800 FD  GC-EXTRACT-FILE                                              00380000
003900     RECORDING MODE IS F                                          00390000
004000     BLOCK CONTAINS 0 RECORDS                                     00400000
004100     LABEL RECORDS ARE OMITTED.                                   00410000
004200                                                                  00420000
004300 01  GC-EXTRACT-RECORD            PIC  X(80).                     00430000
004400                                                                  00440000
004500 FD  RECONCILIATION-FILE                                          00450000
004600     RECORDING MODE IS F                                          00460000
004700     BLOCK CONTAINS 0 RECORDS                                     00470000
004800     LABEL RECORDS ARE OMITTED.                                   00480000
004900                                                                  00490000
005000 01  RECONCILIATION-RECORD        PIC  X(100).                    00500000
005100                                                                  00510000
005200 FD  POSTING-FILE                                                 00520000
005300     RECORDING MODE IS F                                          00530000
005400     BLOCK CONTAINS 0 RECORDS                                     00540000
005500     LABEL RECORDS ARE OMITTED.                                   00550000
005600                                                                  00560000
005700 01  POSTING-RECORD               PIC  X(150).                    00570000
005800                                                                  00580000
005900 FD  REPORT-FILE                                                  00590000
006000     RECORDING MODE IS F                                          00600000
006100     BLOCK CONTAINS 0 RECORDS                                     00610000
006200     LABEL RECORDS ARE OMITTED.                                   00620000
006300                                                                  00630000
006400 01  REPORT-RECORD                PIC  X(150).                    00640000
006500                                                                  00650000
006600 WORKING-STORAGE SECTION.                                         00660000
006700                                                                  00670000
006800******************************************************************00680000
006900*    PC-PROGRAM CONSTANTS                                        *00690000
007000******************************************************************00700000
007100 01  PC-PROGRAM-CONSTANTS.                                        00710000
007200     05  PC-PROGRAM-NAME         PIC X(08)      VALUE 'AUKUT006'. 00720000
007300                                                                  00730000
007400******************************************************************00740000
007500*    PV-PROGRAM VARIABLES                                        *00750000
007600******************************************************************00760000
007700 01  PV-PROGRAM-VARIABLES.                                        00770000
007800     05  PV-PARAGRAPH-NAME            PIC  X(30) VALUE SPACES.    00780000
007900     05  PV-OPERATION-MSG-1           PIC  X(30) VALUE SPACES.    00790000
008000     05  PV-DB2-OPERATION-ATTEMPTED   PIC  X(30) VALUE SPACES.    00800000
008100     05  PV-SAVE-CARD-NBR             PIC  X(19) VALUE SPACES.    00810000
008300     05  PV-CURRENT-DATE              PIC  X(10) VALUE SPACES.    00820000
008400                                                                  00830000
008500******************************************************************00840000
008600*    PS-PROGRAM SWITCHES                                         *00850000
008700******************************************************************00860000
008800 01  PS-PROGRAM-SWITCHES.                                         00870000
008900     05  PS-END-OF-GC-EXTRACT-FILE-SW PIC  X(01) VALUE 'N'.       00880000
009000         88  PS-END-OF-GC-EXTRACT-FILE           VALUE 'Y'.       00890000
009100                                                                  00900000
009200     05  PS-END-OF-RECON-FILE-SW      PIC  X(01) VALUE 'N'.       00910000
009300         88  PS-END-OF-RECONCILIATION-FILE       VALUE 'Y'.       00920000
009400                                                                  00930000
009500 01  ABEND-CODE                     PIC S9(04) VALUE ZERO         00940000
009600                                                  COMP.           00950000
009700                                                                  00960000
009800******************************************************************00970000
009900*    DAILY EXTRACT RECORD LAYOUT                                 *00980000
010000******************************************************************00990000
010100     COPY AURD012.                                                01000000
010200                                                                  01010000
010300******************************************************************01020000
010400*    RECONCILIATION FILE LAYOUT                                  *01030000
010500******************************************************************01040000
010600     COPY AURD011.                                                01050000
010700                                                                  01060000
010800******************************************************************01070000
010900*  RECONCILIATION DETAIL FILE LAYOUT                             *01080000
011000******************************************************************01090000
011100     COPY AURD013.                                                01100000
011200                                                                  01110000
011300******************************************************************01120000
011400*    VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004     *01130000
011500******************************************************************01140000
011600     COPY DPWS004.                                                01150000
011700                                                                  01160000
011800******************************************************************01170000
011900*    3RD PARTY GIFT CARD TRANSACTION TABLE                       *01180000
012000******************************************************************01190000
012100     EXEC SQL                                                     01200000
012200         INCLUDE GCT00002                                         01210000
012300     END-EXEC.                                                    01220000
012400******************************************************************01230000
012500*    3RD PARTY GIFT CARD RECONCILE TABLE                         *01240000
012600******************************************************************01250000
012700     EXEC SQL                                                     01260000
012800         INCLUDE GCT00001                                         01270000
012900     END-EXEC.                                                    01280000
013000******************************************************************01290000
013100*    STANDARD LAYOUT FOR THE SQL COMMUNCATIONS AREA              *01300000
013200******************************************************************01310000
013300     EXEC SQL                                                     01320000
013400         INCLUDE SQLCA                                            01330000
013500     END-EXEC.                                                    01340000
013600                                                                  01350000
013700     COPY SQLCA2.                                                 01360000
013800                                                                  01370000
013900******************************************************************01380000
014000* PROCEDURE DIVISION                                             *01390000
014100******************************************************************01400000
014200 PROCEDURE DIVISION.                                              01410000
014300                                                                  01420000
014400 0000-MAINLINE-PROCESSING.                                        01430000
014500                                                                  01440000
014600     PERFORM 1000-INITIALIZE-PROGRAM.                             01450000
014700                                                                  01460000
014800     PERFORM 2000-MATCH-INPUT-FILES                               01470000
014900       UNTIL PS-END-OF-GC-EXTRACT-FILE                            01480000
015000          OR PS-END-OF-RECONCILIATION-FILE.                       01490000
015100                                                                  01500000
015200     IF PS-END-OF-GC-EXTRACT-FILE                                 01510000
015300         PERFORM 2400-WRITE-RECONCILIATION-REC                    01520000
015400           UNTIL PS-END-OF-RECONCILIATION-FILE                    01530000
015500     END-IF.                                                      01540000
015600                                                                  01550000
015700     IF PS-END-OF-RECONCILIATION-FILE                             01560000
015800         PERFORM 2200-WRITE-EXTRACT-RECORD                        01570000
015900           UNTIL PS-END-OF-GC-EXTRACT-FILE                        01580000
016000     END-IF.                                                      01590000
016100                                                                  01600000
016200     CLOSE GC-EXTRACT-FILE                                        01610000
016300           RECONCILIATION-FILE                                    01620000
016400           POSTING-FILE                                           01630000
016500           REPORT-FILE.                                           01640000
016600                                                                  01650000
016700     GOBACK.                                                      01660000
016800                                                                  01670000
016900******************************************************************01680000
017000* 1000-INITIALIZE-PROGRAM : OPEN INPUT AND OUTPUT FILES AND      *01690000
017100* PERFORM AN INITIAL READ OF THE INPUT FILE.                     *01700000
017200******************************************************************01710000
017300 1000-INITIALIZE-PROGRAM.                                         01720000
017400                                                                  01730000
017500     OPEN INPUT  GC-EXTRACT-FILE                                  01740000
017600                 RECONCILIATION-FILE                              01750000
017700          OUTPUT POSTING-FILE                                     01760000
017800                 REPORT-FILE.                                     01770000
017900                                                                  01780000
018000     EXEC SQL                                                     01790000
018100         SELECT CURRENT DATE                                      01800000
018200           INTO :PV-CURRENT-DATE                                  01810000
018300           FROM GCT_GFT_CRD_TRN                                   01820000
018400           WITH UR                                                01830000
018500     END-EXEC.                                                    01840000
018600                                                                  01850000
018700     PERFORM 7000-READ-GC-EXTRACT-FILE.                           01860000
018800                                                                  01870000
018900     PERFORM 8000-READ-RECONCILIATION-FILE.                       01880000
019000                                                                  01890000
019100******************************************************************01900000
019200* 2000-MATCH-INPUT-FILES                                         *01910000
019300*    PROCESS THE INPUT FILE AND WRITE THE OUTPUT RECORDS         *01920000
019400*    AU012 IS THE EXTRACT, AU011 IS THE RECON                    *01930000
019500******************************************************************01940000
019600 2000-MATCH-INPUT-FILES.                                          01950000
019700                                                                  01960000
019800     IF AU012-GIFT-CARD-NBR = AU011-GIFT-CARD-NBR                 01970000
020000         MOVE SPACES TO AU013-DETAIL-TRANS                        01980000
020100         MOVE AU012-GIFT-CARD-NBR TO PV-SAVE-CARD-NBR             01990000
020300         IF AU011-RESPONSE-APPROVE                                02000000
020400             SET AU013-POSTING TO TRUE                            02010000
020500             PERFORM 3000-MOVE-RECONCILIATION-DATA                02020000
020600             WRITE POSTING-RECORD FROM AU013-DETAIL-TRANS         02030000
020700             WRITE REPORT-RECORD FROM AU013-DETAIL-TRANS          02040000
020800         ELSE                                                     02050000
020900             SET AU013-DECLINED-AUTH TO TRUE                      02060000
CH6602             PERFORM 3000-MOVE-RECONCILIATION-DATA                02061002
021000             WRITE REPORT-RECORD FROM AU013-DETAIL-TRANS          02070000
021100         END-IF                                                   02080000
021200         PERFORM 7000-READ-GC-EXTRACT-FILE                        02090000
021300         PERFORM 8000-READ-RECONCILIATION-FILE                    02100000
022600     ELSE                                                         02110000
022700         IF AU012-GIFT-CARD-NBR < AU011-GIFT-CARD-NBR             02120000
022800             MOVE SPACES TO AU013-DETAIL-TRANS                    02130000
022900             PERFORM 2200-WRITE-EXTRACT-RECORD                    02140000
023000         ELSE                                                     02150000
023100             IF AU012-GIFT-CARD-NBR > AU011-GIFT-CARD-NBR         02160000
023200                 IF AU011-GIFT-CARD-NBR = PV-SAVE-CARD-NBR        02170000
023300                     SET AU013-MULTIPLE-RECON TO TRUE             02180000
023400                     MOVE PV-CURRENT-DATE  TO AU013-PREV-RECON-DTE02190000
023500                 END-IF                                           02200000
023600                 PERFORM 2400-WRITE-RECONCILIATION-REC            02210000
023700             END-IF                                               02220000
023800         END-IF                                                   02230000
023900     END-IF.                                                      02240000
024000                                                                  02250000
024100******************************************************************02260000
024200* 2200-WRITE-EXTRACT-RECORD                                      *02270000
024300******************************************************************02280000
024400 2200-WRITE-EXTRACT-RECORD.                                       02290000
024500                                                                  02300000
024600     MOVE AU012-GIFT-CARD-NBR      TO AU013-GIFT-CARD-NBR.        02310000
024700     MOVE AU012-UPC-NBR            TO AU013-UPC.                  02320000
024800     MOVE AU012-SLS-DTE            TO AU013-SLS-DTE.              02330000
024900     MOVE AU012-STR-NBR            TO AU013-STR-NBR.              02340000
025000     MOVE AU012-RGST-ID            TO AU013-RGST-ID.              02350000
025100     MOVE AU012-TRN-NBR            TO AU013-TRN-NBR.              02360000
025200     MOVE AU012-STRT-TM            TO AU013-STRT-TM.              02370000
025300     MOVE AU012-LNE-ITM-SEQ-NBR    TO AU013-LNE-ITM-SEQ-NBR.      02380000
025400     MOVE AU012-TRANSACTION-AMT    TO AU013-TRANSACTION-AMT.      02390000
025500     MOVE SPACES                   TO AU013-PARTNER               02400000
025600                                      AU013-BLACKHAWK-TRAN-NBR    02410000
025700                                      AU013-TRN-ID                02420000
025800                                      AU013-RESPONSE-CODE         02430000
025900                                      AU013-TYPE-CODE             02440000
026000                                      AU013-APPROVAL-CDE.         02450000
026100     SET AU013-MISSING-BLACKHAWK   TO TRUE.                       02460000
026200                                                                  02470000
026300     WRITE REPORT-RECORD FROM AU013-DETAIL-TRANS.                 02480000
026400                                                                  02490000
026500     PERFORM 7000-READ-GC-EXTRACT-FILE.                           02500000
026600                                                                  02510000
026700******************************************************************02520000
026800* 2400-WRITE-RECONCILIATION-REC                                  *02530000
026900******************************************************************02540000
027000 2400-WRITE-RECONCILIATION-REC.                                   02550000
027100                                                                  02560000
027200     MOVE AU011-GIFT-CARD-NBR      TO AU013-GIFT-CARD-NBR.        02570000
027300     MOVE AU011-TRANSACTION-AMT    TO AU013-TRANSACTION-AMT.      02580000
027400                                                                  02590000
027500     IF AU013-MULTIPLE-RECON                                      02600000
027600         MOVE AU011-TRANSACTION-DATE   TO AU013-SLS-DTE           02610000
027700     ELSE                                                         02620000
027800         PERFORM 2500-CHECK-FOR-PREV-RECON                        02630000
027900         IF AU013-MULTIPLE-RECON                                  02640000
028000             MOVE GCT00002-UPC-NUMBER      TO AU013-UPC           02650000
028100             MOVE GCT00002-SLS-DTE         TO AU013-SLS-DTE       02660000
028200             MOVE GCT00002-STR-NBR         TO AU013-STR-NBR       02670000
028300             MOVE GCT00002-RGST-ID         TO AU013-RGST-ID       02680000
028400             MOVE GCT00002-TRN-NBR         TO AU013-TRN-NBR       02690000
028500             MOVE GCT00002-STRT-TM         TO AU013-STRT-TM       02700000
028600             MOVE GCT00002-LNE-ITM-SEQ-NBR TO                     02710000
028700                                             AU013-LNE-ITM-SEQ-NBR02720000
028800             MOVE GCT00001-VND-RECNCL-DTE  TO AU013-PREV-RECON-DTE02730000
028900             MOVE AU011-PARTNER-NAME       TO AU013-PARTNER       02740000
029000             MOVE SPACES              TO AU013-BLACKHAWK-TRAN-NBR 02750000
029100                                         AU013-TRN-ID             02760000
029200                                         AU013-RESPONSE-CODE      02770000
029300                                         AU013-TYPE-CODE          02780000
029400                                         AU013-APPROVAL-CDE       02790000
029500         ELSE                                                     02800000
029600             MOVE AU011-TRANSACTION-DATE   TO AU013-SLS-DTE       02810000
029700         END-IF                                                   02820000
029800     END-IF.                                                      02830000
029900                                                                  02840000
030000     WRITE REPORT-RECORD FROM AU013-DETAIL-TRANS.                 02850000
030100                                                                  02860000
030200     PERFORM 8000-READ-RECONCILIATION-FILE.                       02870000
030300                                                                  02880000
030400******************************************************************02890000
030500* 2500-CHECK-FOR-PREV-RECON                                      *02900000
030600******************************************************************02910000
030700 2500-CHECK-FOR-PREV-RECON.                                       02920000
030800                                                                  02930000
030900     EXEC SQL                                                     02940000
031000        SELECT B.VND_RECNCL_DTE                                   02950000
031100              ,A.SLS_DTE                                          02960000
031200              ,A.STR_NBR                                          02970000
031300              ,A.RGST_ID                                          02980000
031400              ,A.TRN_NBR                                          02990000
031500              ,A.STRT_TM                                          03000000
031600              ,A.LNE_ITM_SEQ_NBR                                  03010000
031700              ,A.UPC_NUMBER                                       03020000
031800          INTO  :GCT00001-VND-RECNCL-DTE                          03030000
031900               ,:GCT00002-SLS-DTE                                 03040000
032000               ,:GCT00002-STR-NBR                                 03050000
032100               ,:GCT00002-RGST-ID                                 03060000
032200               ,:GCT00002-TRN-NBR                                 03070000
032300               ,:GCT00002-STRT-TM                                 03080000
032400               ,:GCT00002-LNE-ITM-SEQ-NBR                         03090000
032500               ,:GCT00002-UPC-NUMBER                              03100000
032600          FROM  GCT_GFT_CRD_TRN A                                 03110000
032700               ,GCT_GFT_CRD_RECNCL B                              03120000
032800         WHERE A.CRD_ACCT_NBR = B.CRD_ACCT_NBR                    03130000
032900           AND A.CRD_ACCT_NBR = :AU011-GIFT-CARD-NBR              03140000
033000          WITH UR                                                 03150000
033100     END-EXEC.                                                    03160000
033200                                                                  03170000
033300     EVALUATE TRUE                                                03180000
033400         WHEN SQLCODE = +0                                        03190000
033500             SET AU013-MULTIPLE-RECON   TO TRUE                   03200000
033600         WHEN SQLCODE = +100                                      03210000
033700             SET AU013-MISSING-KOHLS TO TRUE                      03220000
033800         WHEN OTHER                                               03230000
033900             MOVE '2500-CHECK-FOR-PREV-RECON     '                03240000
034000                               TO PV-PARAGRAPH-NAME               03250000
034100             MOVE 'READ FOR PREV RECON ROW       '                03260000
034200                               TO PV-DB2-OPERATION-ATTEMPTED      03270000
034300             PERFORM 9999-SQL-ABEND                               03280000
034400     END-EVALUATE.                                                03290000
034500                                                                  03300000
034600******************************************************************03310000
034700* 3000-MOVE-RECONCILIATION-DATA                                  *03320000
034800* MOVE THE INPUT DATA VARIABLES TO THE OUTPUT DATA VARIABLES.    *03330000
034900******************************************************************03340000
035000 3000-MOVE-RECONCILIATION-DATA.                                   03350000
035100                                                                  03360000
035200     MOVE AU012-GIFT-CARD-NBR        TO AU013-GIFT-CARD-NBR.      03370000
035300     MOVE AU012-UPC-NBR              TO AU013-UPC.                03380000
035400     MOVE AU012-SLS-DTE              TO AU013-SLS-DTE.            03390000
035500     MOVE AU012-STR-NBR              TO AU013-STR-NBR.            03400000
035600     MOVE AU012-RGST-ID              TO AU013-RGST-ID.            03410000
035700     MOVE AU012-TRN-NBR              TO AU013-TRN-NBR.            03420000
035800     MOVE AU012-STRT-TM              TO AU013-STRT-TM.            03430000
035900     MOVE AU012-LNE-ITM-SEQ-NBR      TO AU013-LNE-ITM-SEQ-NBR.    03440000
036000     MOVE AU011-TRANSACTION-AMT      TO AU013-TRANSACTION-AMT.    03450000
036100     MOVE AU011-PARTNER-NAME         TO AU013-PARTNER.            03460000
036200     MOVE AU011-TRANSACTION-NBR      TO AU013-BLACKHAWK-TRAN-NBR. 03470000
036300     MOVE AU011-BLACKHAWK-IDENTIFIER TO AU013-TRN-ID.             03480000
036400     MOVE AU011-RESPONSE-CODE        TO AU013-RESPONSE-CODE.      03490000
036500     MOVE AU011-AUTH-TYPE-CODE       TO AU013-TYPE-CODE.          03500000
036600     MOVE AU011-APPROVAL-CDE         TO AU013-APPROVAL-CDE.       03510000
036700                                                                  03520000
036800******************************************************************03530000
036900* 7000-READ-GC-EXTRACT-FILE                                      *03540000
037000*    READ THE INPUT FILE AND SET THE END OF FILE SWITCH WHEN     *03550000
037100*    THERE IS NO MORE RECORDS TO READ.                           *03560000
037200******************************************************************03570000
037300 7000-READ-GC-EXTRACT-FILE.                                       03580000
037400                                                                  03590000
037500     READ GC-EXTRACT-FILE INTO AU012-DETAIL-TRANS                 03600000
037600         AT END                                                   03610000
037700             SET PS-END-OF-GC-EXTRACT-FILE TO TRUE.               03620000
037800                                                                  03630000
037900******************************************************************03640000
038000* 8000-READ-RECONCILIATION-FILE                                  *03650000
038100*    READ THE INPUT FILE AND SET THE END OF FILE SWITCH WHEN     *03660000
038200*    THERE IS NO MORE RECORDS TO READ.                           *03670000
038300******************************************************************03680000
038400 8000-READ-RECONCILIATION-FILE.                                   03690000
038500                                                                  03700000
038600     READ RECONCILIATION-FILE INTO AU011-DETAIL-TRANS             03710000
038700         AT END                                                   03720000
038800             SET PS-END-OF-RECONCILIATION-FILE TO TRUE.           03730000
038900                                                                  03740000
039000******************************************************************03750000
039100*     9999-SQL-ABEND                                             *03760000
039200* ==> PROCESSES:                                                 *03770000
039300*     -PERFORMS ABEND PROCESSING FOR SQL ERRORS.                 *03780000
039400* ==> PERFORMED FROM:                                            *03790000
039500******************************************************************03800000
039600 9999-SQL-ABEND.                                                  03810000
039700                                                                  03820000
039800     DISPLAY '9999-SQL-ABEND'.                                    03830000
039900     DISPLAY '**  ABEND     **'.                                  03840000
040000     DISPLAY '**  PROGRAM   ** = ' PC-PROGRAM-NAME.               03850000
040100     DISPLAY '**  PARAGRAPH ** = ' PV-PARAGRAPH-NAME.             03860000
040200     DISPLAY '**  OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.    03870000
040300                                                                  03880000
040400******************************************************************03890000
040500* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-   *03900000
040600* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE        *03910000
040700* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE    *03920000
040800* FORMAT.                                                        *03930000
040900******************************************************************03940000
041000     COPY DPPD004.                                                03950000
041100                                                                  03960000
041200     MOVE +4013 TO ABEND-CODE.                                    03970000
041300     CALL 'ILBOABN0' USING ABEND-CODE.                            03980000
