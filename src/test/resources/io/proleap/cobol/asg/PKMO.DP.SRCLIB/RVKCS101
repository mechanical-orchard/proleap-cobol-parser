000100*                                                                 00010059
000200*                                                                 00020059
000300*                                                                 00030059
000400 IDENTIFICATION DIVISION.                                         00040059
000500                                                                  00050059
000600 PROGRAM-ID.    RVKCS101.                                         00060059
000700 AUTHOR.        NATALIYA PALATNIK                                 00070059
000800 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00080059
000900 DATE-WRITTEN.  12-03-92.                                         00090059
001000 DATE-COMPILED.                                                   00100059
001100                                                                  00110059
001200******************************************************************00120059
001300* THIS PROGRAM IS REQUEST FOR RETURN AUTHORIZATION ORDER UPDATE.  00130059
001400*                                                                 00140059
001500* TRANSID - T101                                                  00150059
001600*                                                                 00160059
001700******************************************************************00170059
001800* 04/11/03 - RAMAKRISHNA PRASAD V, IGSI   - WR NO. 23022         *00180059
001900*    - REPLACED ALL REFERENCES TO TSK TABLE WITH XLT_SKU,        *00190059
002000*      XLT_VND_STYL TABLES                                       *00200059
002100*    - REMOVED THE LOGIC WHICH ALLOWS THE CONTROL TO PASS TO     *00210059
002200*      RVKCS113 PROGRAM                                          *00220059
002300******************************************************************00230059
002400                                                                  00240059
002500*                                                                 00250059
002600 ENVIRONMENT DIVISION.                                            00260059
002700*                                                                 00270059
002800*                                                                 00280059
002900 DATA DIVISION.                                                   00290059
003000*                                                                 00300059
003100*                                                                 00310059
003200 WORKING-STORAGE SECTION.                                         00320059
003300                                                                  00330059
003400 01  PC-PROGRAM-CONSTANTS.                                        00340059
003500     05  PC-PRT-RTV-TRANID              PIC X(04)    VALUE 'T112'.00350059
003600     05  PC-01                          PIC X(02)    VALUE '01'.  00360059
003700     05  PC-OPER-UNT-ID-FINDLAY         PIC 9(04)    VALUE 0810.  00370059
003800     05  PC-NAVIGATOR-TRAN-ID           PIC X(04)    VALUE 'Z008'.00380059
003900     05  PC-MAXIMUM-COMMAREA-LENGTH     PIC S9(04)   VALUE +4072  00390059
004000                                                     COMP SYNC.   00400059
004100     05  PC-CURRENT-MAP-NAME            PIC X(08)    VALUE        00410059
004200     'RV101A  '.                                                  00420059
004300     05  PC-CURRENT-MAPSET-NAME         PIC X(08)    VALUE        00430059
004400     'RVKM101 '.                                                  00440059
004500     05  PC-CURRENT-PROGRAM-NAME        PIC X(08)    VALUE        00450059
004600     'RVKCS101'.                                                  00460059
004700     05  PC-RTV-REPORT-PGM              PIC X(08)    VALUE        00470059
004800     'RVKCS112'.                                                  00480059
004900     05  PC-PRTR-VALIDATION-PGM         PIC X(08)    VALUE        00490059
005000     'DPKCS060'.                                                  00500059
005100     05  PC-ERASE-EOF-COMP              PIC S9(04)   VALUE +128   00510059
005200                                                     COMP SYNC.   00520059
005300     05  FILLER REDEFINES PC-ERASE-EOF-COMP.                      00530059
005400         10  FILLER                     PIC X(01).                00540059
005500         10  PC-ERASE-EOF               PIC X(01).                00550059
005600     05  PC-MAX-RETRIES                 PIC S9(3)    VALUE +3     00560059
005700                                                     COMP-3.      00570059
005800*                                                                 00580059
005900 01  PC-TSYMSG-NUMBERS.                                           00590059
006000     05  PC-TSYMSG-00005                PIC 9(5)    VALUE 00005.  00600059
006100     05  PC-TSYMSG-00007                PIC 9(5)    VALUE 00007.  00610059
006200     05  PC-TSYMSG-00008                PIC 9(5)    VALUE 00008.  00620059
006300     05  PC-TSYMSG-00045                PIC 9(5)    VALUE 00045.  00630059
006400     05  PC-TSYMSG-00059                PIC 9(5)    VALUE 00059.  00640059
006500     05  PC-TSYMSG-00070                PIC 9(5)    VALUE 00070.  00650059
006600     05  PC-TSYMSG-00148                PIC 9(5)    VALUE 00148.  00660059
006700     05  PC-TSYMSG-00746                PIC 9(5)    VALUE 00746.  00670059
006800     05  PC-TSYMSG-01114                PIC 9(5)    VALUE 01114.  00680059
006900     05  PC-TSYMSG-01115                PIC 9(5)    VALUE 01115.  00690059
007000     05  PC-TSYMSG-01116                PIC 9(5)    VALUE 01116.  00700059
007100     05  PC-TSYMSG-01117                PIC 9(5)    VALUE 01117.  00710059
007200******* 3159 = CANNOT UPDATE, LISTING HAS TO BE A CLOSED STATUS   00720059
007300     05  PC-TSYMSG-03159                PIC 9(5)    VALUE 03159.  00730059
007400     05  PC-TSYMSG-99901                PIC 9(5)    VALUE 99901.  00740059
007500*                                                                 00750059
007600 01  PM-PROGRAM-MESSAGES.                                         00760059
007700     05  PM-PROGRAM-MESSAGE-12          PIC X(78)    VALUE        00770059
007800     'INVALID NEXT APPLICATION ACTIVITY RECEIVED'.                00780059
007900     05  PM-PROGRAM-MESSAGE-22          PIC X(78)    VALUE        00790059
008000     'LOGIC ERROR IN TRYING TO READ RV     QUEUE - RESP = '.      00800059
008100     05  FILLER REDEFINES PM-PROGRAM-MESSAGE-22.                  00810059
008200         10  FILLER                     PIC X(61).                00820059
008300         10  PM-RESP-22                 PIC 9999.                 00830059
008400         10  FILLER                     PIC X(13).                00840059
008500*                                                                 00850059
008600 01  PS-PROGRAM-SUBSCRIPTS.                                       00860059
008700     05  PS-SUB                         PIC S9(04)   VALUE +0     00870059
008800                                                     COMP SYNC.   00880059
008900                                                                  00890059
009000 01  PS-PROGRAM-SWITCHES.                                         00900059
009100     05  PS-MAP-SEND-TYPE               PIC X(01)    VALUE '1'.   00910059
009200         88  PS-SEND-MAP-N-DATA-FRSET                VALUE '1'.   00920059
009300         88  PS-SEND-MAP-N-DATA-FRSET-CPOSN          VALUE '2'.   00930059
009400         88  PS-SEND-DATA-ONLY-FRSET                 VALUE '3'.   00940059
009500         88  PS-SEND-DATA-ONLY                       VALUE '4'.   00950059
009600         88  PS-SEND-DATA-ONLY-ERASEAUP              VALUE '5'.   00960059
009700         88  PS-SEND-MAP-ONLY-FRSET                  VALUE '6'.   00970059
009800     05  PS-ERROR-SW                    PIC X(01)    VALUE 'N'.   00980059
009900         88  PS-ERROR                                VALUE 'Y'.   00990059
010000         88  PS-NO-ERROR                             VALUE 'N'.   01000059
010100     05  PS-PROCESSING-SW               PIC X(01)    VALUE 'N'.   01010059
010200         88  CONTINUE-PROCESSING                     VALUE 'Y'.   01020059
010300         88  STOP-PROCESSING                         VALUE 'N'.   01030059
010400     05  PS-LOCATION-IND                PIC X(01)    VALUE ' '.   01040059
010500         88  PS-USED-LISTING-LOCATION                VALUE 'O'.   01050059
010600         88  PS-STORAGE-LOCATION                     VALUE 'S'.   01060059
010700         88  PS-EMPTY-LOCATION                       VALUE ' '.   01070059
010800     EJECT                                                        01080059
010900 01  PV-PROGRAM-VARIABLES.                                        01090059
011000     05  PV-DB2-OPER-UNT-ID             PIC S9(04)   VALUE +0     01100059
011100                                                     COMP SYNC.   01110059
011200     05  PV-PRT-LIST-TRANID             PIC  X(04)   VALUE SPACE. 01120059
011300     05  PV-COMMAREA-LENGTH             PIC S9(04)   VALUE ZERO   01130059
011400                                                     COMP SYNC.   01140059
011500     05  PV-12-DGT-DFCT-ORD-ID          PIC  9(12)   VALUE  0.    01150061
011600     05  PV-CICS-RESPONSE               PIC S9(04)   VALUE +0     01160059
011700                                                     COMP SYNC.   01170059
011800     05  PV-RESP                        PIC S9(04)   VALUE +0     01180059
011900                                                     COMP SYNC.   01190059
012000     05  PV-DB2-NULL-IND1               PIC S9(04)   VALUE +0     01200059
012100                                                     COMP SYNC.   01210059
012200     05  PV-DB2-NULL-IND2               PIC S9(04)   VALUE +0     01220059
012300                                                     COMP SYNC.   01230059
012400     05  PV-MESSAGE                     PIC X(78)    VALUE SPACES.01240059
012500     05  PV-SQL-SUB                     PIC S9(4)    COMP.        01250059
012600                                                                  01260059
012700     05  PV-RETAIL                      PIC S9(9)V99 VALUE +0     01270059
012800                                                     COMP-3.      01280059
012900     05  PV-COST                        PIC S9(9)V99 VALUE +0     01290059
013000                                                     COMP-3.      01300059
013100     05  PV-QTY                         PIC S9(7)    VALUE +0     01310059
013200                                                     COMP-3.      01320059
013300     05  PV-TOT-RETAIL                  PIC S9(9)V99 VALUE +0     01330059
013400                                                     COMP-3.      01340059
013500     05  PV-TOT-COST                    PIC S9(9)V99 VALUE +0     01350059
013600                                                     COMP-3.      01360059
013700     05  PV-TOT-QTY                     PIC S9(7)    VALUE +0     01370059
013800                                                     COMP-3.      01380059
013900                                                                  01390059
014000     05  PV-VEND-ZIP-CODE-SFX           PIC 9(09)    VALUE ZEROS. 01400059
014100     05  PV-VEND-ZIP-CODE-SFX-R         REDEFINES                 01410059
014200         PV-VEND-ZIP-CODE-SFX.                                    01420059
014300         10  PV-VEND-ZIP-CODE           PIC 9(05).                01430059
014400         10  PV-VEND-ZIP-SFX            PIC 9(04).                01440059
014500     05  PV-DFCT-ORD-ID                 PIC S9(12)   VALUE +0     01450060
014600                                                     COMP-3.      01460059
014700     05  PV-ITEMS-ON-DB2                PIC X        VALUE 'Y'.   01470059
014800             88  PV-NO-ITEMS-LEFT                    VALUE 'N'.   01480059
014900                                                                  01490059
015000*                                                                 01500059
015100     05  PV-LOC-LISTING-NBR             PIC S9(06)   VALUE +0     01510059
015200                                                     COMP-3.      01520059
015300     05  PV-LOC-STATUS-CDE              PIC X(01)    VALUE SPACE. 01530059
015400                                                                  01540059
015500     05  PV-DEPT                        PIC 9(04)    VALUE ZEROS. 01550059
015600     05  PV-DEPT-R REDEFINES PV-DEPT.                             01560059
015700         10 FILLER                      PIC X.                    01570059
015800         10 PV-DEPT-X3                  PIC X(03).                01580059
015900                                                                  01590059
016000 01  PV-DB2-DATE                        PIC X(10).                01600059
016100 01  FILLER  REDEFINES PV-DB2-DATE.                               01610059
016200     05  PV-DD-CCYY                     PIC X(4).                 01620059
016300     05  FILLER                         PIC X.                    01630059
016400         88  PV-DD-DASH1                             VALUE '-'.   01640059
016500     05  PV-DD-MM                       PIC XX.                   01650059
016600     05  FILLER                         PIC X.                    01660059
016700         88  PV-DD-DASH2                             VALUE '-'.   01670059
016800     05  PV-DD-ML                       PIC XX.                   01680059
016900*                                                                 01690059
017000 EJECT                                                            01700059
017100                                                                  01710059
017200***************************************************************** 01720059
017300*    STANDARD COMMAREA.                                           01730059
017400***************************************************************** 01740059
017500                                                                  01750059
017600     COPY DPWS020.                                                01760059
017700     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01770059
017800                                                                  01780059
017900***************************************************************** 01790059
018000*    INTER-APPLICATION COMMAREA.                                  01800059
018100***************************************************************** 01810059
018200                                                                  01820059
018300         10  INTER-APPL-COMM-AREA       PIC X(200).               01830059
018400     COPY RVWS100.                                                01840059
018500                                                                  01850059
018600***************************************************************** 01860059
018700*    SPECIFIC COMMMAREA FOR RVKCS101.                             01870059
018800***************************************************************** 01880059
018900         10  RV001-SPECIFIC-COMMAREA.                             01890059
019000             15  RV001-APPL-CURSOR-POSITION  PIC S9(04) COMP.     01900059
019100             15  RV001-RL-SUB                PIC S9(04) COMP.     01910059
019200             15  RV001-RL-ITEM               PIC S9(04) COMP.     01920059
019300             15  RV001-REQUEST-DATA.                              01930059
019400                                                                  01940059
019500                 20  RV001-DFCT-ORD-ID       PIC S9(12) COMP-3.   01950060
019600                 20  RV001-ORDER-TYPE        PIC  X(08).          01960059
019700                 20  RV001-ORDER-STATUS      PIC  X(08).          01970059
019800                 20  RV001-STATUS-DATE       PIC  X(10).          01980059
019900                 20  RV001-LOC-UPDT-SW       PIC  X(01).          01990059
020000                     88 USER-HAS-UPDATE-AUTH                      02000059
020100                                             VALUE 'Y'.           02010059
020200                     88 USER-DOSENT-HAVE-UPDATE-AUTH              02020059
020300                                             VALUE 'N'.           02030059
020400                 20  RV001-LOCATION-OLD      PIC  X(15).          02040059
020500                 20  RV001-LOCATION          PIC  X(15).          02050059
020600                 20  RV001-PRINTER           PIC  X(05).          02060059
020700                 20  RV001-BUYER             PIC  X(15).          02070059
020800                 20  RV001-VEND-NAME         PIC  X(25).          02080059
020900                 20  RV001-ENT-ID            PIC S9(09) COMP.     02090059
021000                 20  RV001-DEPT-NBR          PIC  X(03).          02100059
021100                 20  RV001-DUNS-NBR          PIC  X(09).          02110059
021200                 20  RV001-VEND-ATTN-NAME    PIC  X(25).          02120059
021300                 20  RV001-TOTAL-QTY         PIC  Z,ZZZ,ZZ9.      02130059
021400                 20  RV001-TOTAL-RETAIL      PIC  $$$$$$,$$9.99.  02140059
021500                 20  RV001-TOTAL-COST        PIC  $$$$$$,$$9.99.  02150059
021600                 20  RV001-VEND-ADDR         PIC  X(25).          02160059
021700                 20  RV001-VEND-CITY         PIC  X(15).          02170059
021800                 20  RV001-VEND-STATE        PIC  X(02).          02180059
021900                 20  RV001-VEND-ZIP-CODEX.                        02190059
022000                     25  RV001-VEND-ZIP-CODE PIC  9(05).          02200059
022100                 20  RV001-VEND-ZIP-SFXX.                         02210059
022200                     25  RV001-VEND-ZIP-SFX  PIC  9(04).          02220059
022300                 20  RV001-PHN-AREA-CODEX.                        02230059
022400                     25  RV001-PHN-AREA-CODE PIC  9(03).          02240059
022500                 20  RV001-PHN-EXCH-CODEX.                        02250059
022600                     25  RV001-PHN-EXCH-CODE PIC  9(03).          02260059
022700                 20  RV001-PHN-NBRX.                              02270059
022800                     25  RV001-PHN-NBR       PIC  9(04).          02280059
022900                 20  RV001-FAX-AREA-CODEX.                        02290059
023000                     25  RV001-FAX-AREA-CODE PIC  9(03).          02300059
023100                 20  RV001-FAX-EXCH-CODEX.                        02310059
023200                     25  RV001-FAX-EXCH-CODE PIC  9(03).          02320059
023300                 20  RV001-FAX-NBRX.                              02330059
023400                     25  RV001-FAX-NBR       PIC  9(04).          02340059
023500                 20  RV001-OPER-UNT-ID-X.                         02350059
023600                     25  RV001-OPER-UNT-ID   PIC  9(04).          02360059
023700                 20  RV001-DFCT-ORD-ID-CDE   PIC  X(01).          02370059
023800             15  RV001-ORDER-TYPE-CDE        PIC  X(01).          02380059
023900                 88  RV001-RTV-LISTING       VALUES 'R', 'D'.     02390059
024000                 88  RV001-MOS-LISTING       VALUE  'M'.          02400059
024100                 88  RV001-CALLBK-LISTING    VALUE  'C'.          02410059
024200             15  RV001-ORDER-STATUS-CDE      PIC  X(01).          02420059
024300                 88  RV001-NEW-LISTING       VALUE 'N'.           02430059
024400                 88  RV001-OPEN-LISTING      VALUE 'O'.           02440059
024500                 88  RV001-CLOSED-LISTING    VALUES 'C', 'D'.     02450059
024600                 88  RV001-PENDING-LISTING   VALUE 'P'.           02460059
024700                 88  RV001-SHIPPED-LISTING   VALUE 'S'.           02470059
024800                 88  RV001-APPROVED-LISTING  VALUE 'A'.           02480059
024900                 88  RV001-D-AND-D-LISTING   VALUE 'D'.           02490059
025000                                                                  02500059
025100             15  RV001-LIST-SWITCH           PIC  X.              02510059
025200                 88  RV001-LIST              VALUE 'Y'.           02520059
025300                 88  RV001-NO-LIST           VALUE 'N'.           02530059
025400                                                                  02540059
025500             15  RV001-VENDOR-INFO-SW        PIC  X.              02550059
025600                 88  RV001-VENDOR-INFO-ENTERED     VALUE 'Y'.     02560059
025700                 88  RV001-NO-VENDOR-INFO-ENTERED  VALUE 'N'.     02570059
025800                                                                  02580059
025900             15  RV001-TEMP-QUEU-NAME.                            02590059
026000                 20  RV001-TERM-ID           PIC  X(04).          02600059
026100                 20  RV001-TASK-NUMBER       PIC S9(07)           02610059
026200                                             COMP-3.              02620059
026300             15  RV001-SAVE-INTER-APPL-COMM  PIC  X(200).         02630059
026400             15  RV001-SAVE-TS-QUEUE         PIC  X(1100).        02640059
026500             15  FILLER                      PIC  X(62).          02650059
026600                                                                  02660059
026700***************************************************************** 02670059
026800*         LIST QUEUE RECORD LAYOUT.                               02680059
026900***************************************************************** 02690059
027000                                                                  02700059
027100     COPY RVWS101.                                                02710059
027200                                                                  02720059
027300***************************************************************** 02730059
027400*    ABEND PROCESSING COPYBOOK.                                   02740059
027500***************************************************************** 02750059
027600                                                                  02760059
027700     COPY DPWS013.                                                02770059
027800                                                                  02780059
027900***************************************************************** 02790059
028000*    MESSAGE COPYBOOK.                                            02800059
028100***************************************************************** 02810059
028200                                                                  02820059
028300     COPY DPWS006.                                                02830059
028400                                                                  02840059
028500***************************************************************** 02850059
028600*    COPYBOOK FOR THE CALL TO RACF SECURITY SUBROUTINE          * 02860059
028700***************************************************************** 02870059
028800                                                                  02880059
028900     COPY DPWS008.                                                02890059
029000                                                                  02900059
029100***************************************************************** 02910059
029200*    ATTRIBUTE SETTINGS COPYBOOK.                                 02920059
029300***************************************************************** 02930059
029400                                                                  02940059
029500     COPY DPWS015.                                                02950059
029600                                                                  02960059
029700***************************************************************** 02970059
029800*    CURRENT DATE AND TIME COPYBOOK.                              02980059
029900***************************************************************** 02990059
030000                                                                  03000059
030100     COPY DPWS017.                                                03010059
030200                                                                  03020059
030300***************************************************************** 03030059
030400*    TOGGLE FUNCTION KEY LINES COPYBOOK.                          03040059
030500***************************************************************** 03050059
030600                                                                  03060059
030700     COPY DPWS009.                                                03070059
030800                                                                  03080059
030900***************************************************************** 03090059
031000*    FUNCTION KEYS COPYBOOK.                                      03100059
031100***************************************************************** 03110059
031200                                                                  03120059
031300     COPY DPWS016.                                                03130059
031400                                                                  03140059
031500***************************************************************** 03150059
031600*    DPKUT045 COPYBOOK.                                           03160059
031700*                                                                 03170059
031800*    DATA AREA NECESSARY TO INTERACT WITH SUB-ROUTINE DPKUT045    03180059
031900*                                                                 03190059
032000*    DPKUT045 IS A UTILITY ROUTINE THAT CONVERTS THE EIBAID       03200059
032100*    CHARACTER RECEIVED FROM THE TERMINAL INTO A INTEGER VALUE    03210059
032200*    FROM 1 TO 29. THIS INTEGER VALUE IS STORED IN DP020-SRC-AID  03220059
032300*    AND IS USED TO INTERROGATE THE DP020-FUNCTION-KEY-ARRAY      03230059
032400*    TABLE IN THE STANDARD COMMAREA TO DETERMINE WHAT TO DO NEXT. 03240059
032500*    IN ADDITION DPKUT045 WILL PARSE THE SCREEN INPUT COMMAND     03250059
032600*    FIELD AND CONVERT RECOGNIZED SCREEN MANIPULATION COMMANDS    03260059
032700*    INTO THE DP020-SRC-AID EQUIVALENT.                           03270059
032800***************************************************************** 03280059
032900                                                                  03290059
033000     COPY DPWS045.                                                03300059
033100                                                                  03310059
033200******************************************************************03320059
033300*  SENDING/RECEIVING AREA FOR THE                                *03330059
033400*  PRINTER VALIDATION ROUTING (DPKCS060)                         *03340059
033500******************************************************************03350059
033600     COPY DPWS072.                                                03360059
033700                                                                  03370059
033800***************************************************************** 03380059
033900*    SYSTEM MESSAGES RECORD LAYOUT                                03390059
034000***************************************************************** 03400059
034100                                                                  03410059
034200     COPY DPRD507I.                                               03420059
034300                                                                  03430059
034400***************************************************************** 03440059
034500                                                                  03450059
034600     COPY RVWS102.                                                03460059
034700                                                                  03470059
034800***************************************************************** 03480059
034900*    STANDARD ATTENTION IDENTIFIER LIST                           03490059
035000***************************************************************** 03500059
035100                                                                  03510059
035200     COPY DFHAID.                                                 03520059
035300***************************************************************** 03530059
035400*    STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST        03540059
035500***************************************************************** 03550059
035600                                                                  03560059
035700     COPY DFHBMSCA.                                               03570059
035800                                                                  03580059
035900***************************************************************** 03590059
036000*    MAP LAYOUT                                                   03600059
036100***************************************************************** 03610059
036200                                                                  03620059
036300     COPY RVKM101.                                                03630059
036400                                                                  03640059
036500 01  MD-MAP-DATA-AREA REDEFINES RV101AO.                          03650059
036600     05  FILLER                         PIC X(1000).              03660059
036700 01  RVKM101-MAP-AREA REDEFINES MD-MAP-DATA-AREA.                 03670059
036800     05  FILLER                         PIC X(126).               03680059
036900     05  RVKM102-LOCL                   PIC S9(4) COMP.           03690059
037000     05  RVKM102-LOCA                   PIC X.                    03700059
037100     05  RVKM102-LOCC                   PIC X.                    03710059
037200     05  RVKM102-LOCH                   PIC X.                    03720059
037300     05  RVKM102-LOCI                   PIC X(10).                03730059
037400 EJECT                                                            03740059
037500***************************************************************** 03750059
037600*    DB2 AREA FOR DEFECT ORDER TABLE                              03760059
037700***************************************************************** 03770059
037800                                                                  03780059
037900     EXEC SQL                                                     03790059
038000         INCLUDE TDFCTOR                                          03800059
038100     END-EXEC.                                                    03810059
038200***************************************************************** 03820059
038300*    DB2 AREA FOR DEFECT ORDER ITEM TABLE                         03830059
038400***************************************************************** 03840059
038500                                                                  03850059
038600     EXEC SQL                                                     03860059
038700         INCLUDE TDFMEIT                                          03870059
038800     END-EXEC.                                                    03880059
038900                                                                  03890059
039000***************************************************************** 03900059
039100* DB2 AREA FOR MERCHANDISE AREA TABLE                           * 03910059
039200***************************************************************** 03920059
039300                                                                  03930059
039400     EXEC SQL                                                     03940059
039500         INCLUDE TMDSEAR                                          03950059
039600     END-EXEC.                                                    03960059
039700                                                                  03970059
039800***************************************************************** 03980059
039900* DB2 AREA FOR RESPONSIBILITY AREA TABLE                        * 03990059
040000***************************************************************** 04000059
040100                                                                  04010059
040200     EXEC SQL                                                     04020059
040300         INCLUDE TRSPBAR                                          04030059
040400     END-EXEC.                                                    04040059
040500                                                                  04050059
040600***************************************************************** 04060059
040700*    DB2 XLT_SKU TABLE                                            04070059
040800***************************************************************** 04080059
040900                                                                  04090059
041000     EXEC SQL                                                     04100059
041100         INCLUDE XLT00003                                         04110059
041200     END-EXEC.                                                    04120059
041300***************************************************************** 04130059
041400*    DB2 XLT_VND_STYL TABLE                                       04140059
041500***************************************************************** 04150059
041600                                                                  04160059
041700     EXEC SQL                                                     04170059
041800         INCLUDE XLT00004                                         04180059
041900     END-EXEC.                                                    04190059
042000***************************************************************** 04200059
042100*    DB2 STATE TABLE                                              04210059
042200***************************************************************** 04220059
042300                                                                  04230059
042400     EXEC SQL                                                     04240059
042500         INCLUDE TSTATE                                           04250059
042600     END-EXEC.                                                    04260059
042700***************************************************************** 04270059
042800*    DB2 COMMUNICATION AREA                                       04280059
042900***************************************************************** 04290059
043000                                                                  04300059
043100     EXEC SQL                                                     04310059
043200         INCLUDE SQLCA                                            04320059
043300     END-EXEC.                                                    04330059
043400                                                                  04340059
043500***************************************************************** 04350059
043600*    CURSOR DECLARE FOR TDFMEIT                                   04360059
043700***************************************************************** 04370059
043800     EXEC SQL                                                     04380059
043900          DECLARE DFCT-ITEM CURSOR                                04390059
044000          FOR SELECT SUM(RTL_COST_AMT),                           04400059
044100                     SUM(UNIT_COST_AMT),                          04410059
044200                     COUNT(*)                                     04420059
044300          FROM TDFMEIT                                            04430059
044400             WHERE                                                04440059
044500                 DFCT_ORD_ID  =  :DFCTOR-DFCT-ORD-ID              04450059
044600     END-EXEC.                                                    04460059
044700                                                                  04470059
044800***************************************************************** 04480059
044900*    CURSOR DECLARE FOR PRINTING MARKOUT LISTINGS                 04490059
045000***************************************************************** 04500059
045100     EXEC SQL                                                     04510059
045200          DECLARE MKOUT-AUTH-CURSOR CURSOR FOR                    04520059
045300              SELECT                                              04530059
045400                     DISTINCT MKOUT_ORD_ID                        04540059
045500              FROM                                                04550059
045600                     TDFMEIT                                      04560059
045700              WHERE                                               04570059
045800                      DFCT_ORD_ID  =  :DFMEIT-DFCT-ORD-ID         04580059
045900              ORDER BY                                            04590059
046000                      MKOUT_ORD_ID                                04600059
046100     END-EXEC.                                                    04610059
046200*                                                                 04620059
046300 EJECT                                                            04630059
046400*                                                                 04640059
046500 LINKAGE SECTION.                                                 04650059
046600                                                                  04660059
046700 01  DFHCOMMAREA.                                                 04670059
046800     05  FILLER                       OCCURS 1 TO 4072 TIMES      04680059
046900                                      DEPENDING ON EIBCALEN.      04690059
047000         10  FILLER                   PIC X.                      04700059
047100*                                                                 04710059
047200*                                                                 04720059
047300 PROCEDURE DIVISION.                                              04730059
047400                                                                  04740059
047500 A000-MAIN-MODULE.                                                04750059
047600                                                                  04760059
047700******************************************************************04770059
047800*    PROCESS THIS TRANSACTION IF THE COMMAREA IS VALID.           04780059
047900******************************************************************04790059
048000                                                                  04800059
048100     PERFORM DP015-0000-CHECK-COMMAREA.                           04810059
048200                                                                  04820059
048300******************************************************************04830059
048400*    DP020-SRC-RETURN-W-TRAN-ID WILL BE TRUE IF THIS PROGRAM WAS  04840059
048500*    SENT A STANDARD COMMAREA. IF NOT SET TRUE (MEANING OTHER     04850059
048600*    THAN A STANDARD COMMAREA WAS SENT TO THIS PROGRAM, THIS      04860059
048700*    PROGRAM WILL RETURN TO CICS.                                 04870059
048800******************************************************************04880059
048900     IF DP020-SRC-RETURN-W-TRAN-ID                                04890059
049000         PERFORM A100-CONTROL-PROCESSING                          04900059
049100     END-IF.                                                      04910059
049200                                                                  04920059
049300     PERFORM DP003-0000-RETURN-TO-CICS.                           04930059
049400 EJECT                                                            04940059
049500                                                                  04950059
049600******************************************************************04960059
049700*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT    04970059
049800*    COURSE OF ACTION IS FOR THIS TRANSACTION.                    04980059
049900******************************************************************04990059
050000 A100-CONTROL-PROCESSING.                                         05000059
050100                                                                  05010059
050200     EVALUATE TRUE                                                05020059
050300         WHEN DP020-NEXT-ACT-INITIAL                              05030059
050400                                                                  05040059
050500             SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 05050059
050600             SET DP020-NEXT-ACT-READ-MAP  TO TRUE                 05060059
050700             SET CONTINUE-PROCESSING      TO TRUE                 05070059
050800                                                                  05080059
050900             PERFORM A200-INITIALIZE-COMMAREA                     05090059
051000             MOVE RV100-INTER-APPL-COMMAREA TO                    05100059
051100                      RV001-SAVE-INTER-APPL-COMM                  05110059
051200                                                                  05120059
051300             PERFORM B000-BUILD-INITIAL-PANEL                     05130059
051400             IF  STOP-PROCESSING                                  05140059
051500                 MOVE DP016-PF3  TO  DP020-SRC-AID                05150059
051600                 PERFORM  D000-NAVIGATE                           05160059
051700             END-IF                                               05170059
051800         WHEN DP020-NEXT-ACT-READ-MAP                             05180059
051900             PERFORM B300-PROCESS-MAP                             05190059
052000         WHEN DP020-NEXT-ACT-RETURN                               05200059
052100             SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 05210059
052200             MOVE RV001-SAVE-INTER-APPL-COMM                      05220059
052300                               TO RV100-INTER-APPL-COMMAREA       05230059
052400             MOVE   RV001-DFCT-ORD-ID                             05240059
052500                           TO DFCTOR-DFCT-ORD-ID                  05250059
052600             PERFORM F500-OPEN-CURSOR                             05260059
052700                                                                  05270059
052800             PERFORM UNTIL  PV-NO-ITEMS-LEFT                      05280059
052900                PERFORM F600-FETCH                                05290059
053000             END-PERFORM                                          05300059
053100                                                                  05310059
053200             PERFORM F700-CLOSE-CURSOR                            05320059
053300                                                                  05330059
053400             MOVE PV-TOT-RETAIL      TO RV001-TOTAL-RETAIL        05340059
053500             MOVE PV-TOT-QTY         TO RV001-TOTAL-QTY           05350059
053600             MOVE PV-TOT-COST        TO RV001-TOTAL-COST          05360059
053700             PERFORM F200-READ-TABLE-TDFCTOR                      05370059
053800                IF SQLCODE EQUAL ZERO                             05380059
053900                   PERFORM  D160-GET-ORDER-STATUS                 05390059
054000                   SET CONTINUE-PROCESSING  TO TRUE               05400059
054100                END-IF                                            05410059
054200                                                                  05420059
054300             PERFORM B400-MOVE-COMMAREA-TO-SCREEN                 05430059
054400             PERFORM B500-EDIT-DATA-IN-COMMAREA                   05440059
054500             MOVE -1              TO    ARANAMEL                  05450059
054600             PERFORM B600-DISPLAY-PANEL                           05460059
054700*                                                                 05470059
054800         WHEN DP020-NEXT-ACT-ERROR                                05480059
054900                                                                  05490059
055000             MOVE DP020-MSG-MESSAGE   TO PV-MESSAGE               05500059
055100             IF DP020-NAV-MNEMONIC = SPACES                       05510059
055200                 MOVE SPACES          TO ANAVCMDO                 05520059
055300                 MOVE DP015-GREEN     TO ANAVCMDC                 05530059
055400                 MOVE DP015-UNDERLINE TO ANAVCMDH                 05540059
055500             ELSE                                                 05550059
055600                 MOVE DP015-RED       TO ANAVCMDC                 05560059
055700                 MOVE DP015-REVERSE   TO ANAVCMDH                 05570059
055800             END-IF                                               05580059
055900                                                                  05590059
056000             MOVE PV-MESSAGE          TO DP020-MSG-MESSAGE        05600059
056100             MOVE LOW-VALUES TO DP020-INTER-APPL-DATA-AREA        05610059
056200                                                                  05620059
056300             PERFORM B500-EDIT-DATA-IN-COMMAREA                   05630059
056400                                                                  05640059
056500             SET DP020-MSG-FATAL         TO TRUE                  05650059
056600             SET PS-ERROR                TO TRUE                  05660059
056700             SET PS-SEND-DATA-ONLY-FRSET TO TRUE                  05670059
056800                                                                  05680059
056900             MOVE -1         TO ANAVCMDL                          05690059
057000                                                                  05700059
057100             PERFORM B600-DISPLAY-PANEL                           05710059
057200                                                                  05720059
057300         WHEN OTHER                                               05730059
057400             SET DP013-LOGIC-ABEND TO TRUE                        05740059
057500             SET DP013-NO-ROLLBACK TO TRUE                        05750059
057600                                                                  05760059
057700             MOVE 'A100-CONTROL-PROCESSING' TO                    05770059
057800                  DP013-PARAGRAPH                                 05780059
057900             MOVE PM-PROGRAM-MESSAGE-12     TO                    05790059
058000                     DP013-MESSAGE-TEXT(1)                        05800059
058100                                                                  05810059
058200             PERFORM DP013-0000-PROCESS-ABEND                     05820059
058300                                                                  05830059
058400     END-EVALUATE.                                                05840059
058500 EJECT                                                            05850059
058600******************************************************************05860059
058700 A200-INITIALIZE-COMMAREA.                                        05870059
058800                                                                  05880059
058900     INITIALIZE RV001-SPECIFIC-COMMAREA.                          05890059
059000                                                                  05900059
059100 EJECT                                                            05910059
059200                                                                  05920059
059300******************************************************************05930059
059400*    CHECKS TO SEE IF THE USER IS SET UP TO HAVE ACCESS TO       *05940059
059500*  RTVLOCUPD - THIS IS THE RACF GROUP SET UP FOR THOSE WITH      *05950059
059600*  AUTHORITY TO UPDATE THE LOCATION FIELD.                       *05960059
059700******************************************************************05970059
059800 A300-RACF-ACCESS.                                                05980059
059900                                                                  05990059
060000      MOVE 'F'                           TO DP008-RESOURCE-TYPE   06000059
060100      MOVE 'RVLOCUPD'                    TO DP008-RESOURCE-NAME   06010059
060200      SET DP008-ACCESS-TYPE-USE          TO TRUE                  06020059
060300                                                                  06030059
060400      EXEC CICS                                                   06040059
060500         LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                 06050059
060600              COMMAREA (DP008-SECURITY-COMMAREA)                  06060059
060700              LENGTH (DP008-SECURITY-COMMAREA-LENGTH)             06070059
060800      END-EXEC                                                    06080059
060900                                                                  06090059
061000      IF DP008-CALL-SUCCESSFUL                                    06100059
061100         IF DP008-ACCESS-ALLOWED                                  06110059
061200             SET USER-HAS-UPDATE-AUTH  TO TRUE                    06120059
061300         ELSE                                                     06130059
061400             SET USER-DOSENT-HAVE-UPDATE-AUTH TO TRUE             06140059
061500         END-IF                                                   06150059
061600     ELSE                                                         06160059
061700         MOVE 'A300-RACF-ACCESS'                                  06170059
061800                               TO DP013-PARAGRAPH                 06180059
061900          MOVE 'UNABLE TO ACCESS CICS'                            06190059
062000                               TO DP013-MESSAGE-TEXT (1)          06200059
062100          MOVE SQLCA                 TO DP013-SQLCA               06210059
062200          SET DP013-DB2-ABEND                                     06220059
062300              DP013-XCTL-DISPLAY-RESTART                          06230059
062400                               TO TRUE                            06240059
062500          PERFORM DP013-0000-PROCESS-ABEND                        06250059
062600      END-IF.                                                     06260059
062700 EJECT                                                            06270059
062800******************************************************************06280059
062900*  PERFORMED ON THE FIRST PASS OF THIS PROGRAM.                  *06290059
063000*  PERFORMED BY  A100-CONTROL-PROCESSING                         *06300059
063100******************************************************************06310059
063200 B000-BUILD-INITIAL-PANEL.                                        06320059
063300                                                                  06330059
063400     IF  DP020-INT-APPL-FORMAT-IND  NOT EQUAL  '1'                06340059
063500         MOVE 1           TO  RV001-RL-ITEM                       06350059
063600         PERFORM F100-READ-LIST-QUEUE                             06360059
063700         MOVE RV101-RA-REQUEST-RECORD  TO RV001-SAVE-TS-QUEUE     06370059
063800         MOVE 1           TO  RV001-RL-SUB                        06380059
063900         MOVE SPACES      TO  DCLTDFCTOR                          06390059
064000         SET  RV101-INQ(RV001-RL-SUB)  TO TRUE                    06400059
064100                                                                  06410059
064200         MOVE RV101-RA-NUMBER(1)  TO   DFCTOR-DFCT-ORD-ID         06420059
064300                                       RV001-DFCT-ORD-ID          06430059
064400         SET  RV001-LIST  TO TRUE                                 06440059
064500     ELSE                                                         06450059
064600         MOVE RV100-RA-NUMBER  TO  RV001-DFCT-ORD-ID              06460059
064700         MOVE RV001-DFCT-ORD-ID  TO  DFCTOR-DFCT-ORD-ID           06470059
064800                                                                  06480059
064900         SET  RV001-NO-LIST    TO  TRUE                           06490059
065000*                                                                 06500059
065100     END-IF.                                                      06510059
065200     IF CONTINUE-PROCESSING                                       06520059
065300          SET RV001-NO-VENDOR-INFO-ENTERED                        06530059
065400                       TO TRUE                                    06540059
065500          PERFORM E100-RETRIEVE-DATA-FOR-PANEL                    06550059
065600     END-IF.                                                      06560059
065700     IF CONTINUE-PROCESSING                                       06570059
065800          PERFORM B600-DISPLAY-PANEL                              06580059
065900     END-IF.                                                      06590059
066000 EJECT                                                            06600059
066100*                                                                 06610059
066200******************************************************************06620059
066300*    PROCESS THE MAP                                             *06630059
066400*                                                                *06640059
066500******************************************************************06650059
066600 B300-PROCESS-MAP.                                                06660059
066700                                                                  06670059
066800     SET PS-SEND-DATA-ONLY-FRSET TO TRUE.                         06680059
066900                                                                  06690059
067000     PERFORM DP007-0000-GET-PANEL.                                06700059
067100                                                                  06710059
067200     IF (DP020-SRC-AID NOT = DP016-PF5)   AND                     06720059
067300        (DP020-SRC-AID NOT = DP016-CLEAR)                         06730059
067400         PERFORM C200-MOVE-SCREEN-TO-COMMAREA                     06740059
067500     END-IF.                                                      06750059
067600                                                                  06760059
067700     PERFORM C100-CHECK-LOCAL-FKEYS.                              06770059
067800 EJECT                                                            06780059
067900*                                                                 06790059
068000******************************************************************06800059
068100*    FILL THE MAP WITH THE NECESSARY DATA AND WRITE IT OUT.      *06810059
068200*                                                                *06820059
068300******************************************************************06830059
068400 B600-DISPLAY-PANEL.                                              06840059
068500                                                                  06850059
068600     PERFORM DP017-0000-GET-CURR-DATE-TIME.                       06860059
068700     MOVE DP017-EDITED-TIME-HMS                                   06870059
068800                      TO  ATIMEO.                                 06880059
068900*                                                                 06890059
069000     IF  NOT DP020-MSG-FATAL                                      06900059
069100         MOVE -1      TO  ARANAMEL                                06910059
069200     END-IF.                                                      06920059
069300                                                                  06930059
069400     IF PS-SEND-MAP-N-DATA-FRSET                                  06940059
069500         PERFORM DP002-0000-FORMAT-TITLE-LINES                    06950059
069600         PERFORM DP009-0000-LOAD-FK-LINES                         06960059
069700     END-IF.                                                      06970059
069800                                                                  06980059
069900     PERFORM DP005-0000-FORMAT-MSG-LINES.                         06990059
070000                                                                  07000059
070100     PERFORM DP008-0000-WRITE-PANEL.                              07010059
070200                                                                  07020059
070300 EJECT                                                            07030059
070400                                                                  07040059
070500 C100-CHECK-LOCAL-FKEYS.                                          07050059
070600                                                                  07060059
070700******************************************************************07070059
070800* PERFORMS THE APPROPRIATE PARAGRAPH BASED ON WHICH FUNCTION KEY  07080059
070900* THE USER HIT.                                                   07090059
071000* PERFORMED BY B300-PROCESS-MAP                                   07100059
071100******************************************************************07110059
071200                                                                  07120059
071300     EVALUATE TRUE                                                07130059
071400                                                                  07140059
071500         WHEN (DP020-FK-GO-TO-TRAN(DP020-SRC-AID) OR              07150059
071600               DP020-FK-RETURN(DP020-SRC-AID))                    07160059
071700             PERFORM D100-SETUP-INTER-APPL-COMM                   07170059
071800             PERFORM D000-NAVIGATE                                07180059
071900                                                                  07190059
072000         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     07200059
072100             MOVE SPACES  TO   ANAVCMDO                           07210059
072200                               ANAVKEYO                           07220059
072300             SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 07230059
072400             MOVE RV001-DFCT-ORD-ID  TO  DFCTOR-DFCT-ORD-ID       07240059
072500             PERFORM E100-RETRIEVE-DATA-FOR-PANEL                 07250059
072600             PERFORM B600-DISPLAY-PANEL                           07260059
072700                                                                  07270059
072800                                                                  07280059
072900         WHEN DP020-SRC-AID = DP016-ENTER                         07290059
073000             IF DP020-NAV-MNEMONIC GREATER THAN SPACES            07300059
073100                PERFORM  D000-NAVIGATE                            07310059
073200             ELSE                                                 07320059
073300                PERFORM  B500-EDIT-DATA-IN-COMMAREA               07330059
073400                PERFORM  B600-DISPLAY-PANEL                       07340059
073500             END-IF                                               07350059
073600                                                                  07360059
073700         WHEN DP020-SRC-AID = DP016-PA2                           07370059
073800             SET PS-SEND-DATA-ONLY TO TRUE                        07380059
073900                                                                  07390059
074000             MOVE -1 TO ANAVCMDL                                  07400059
074100                                                                  07410059
074200             PERFORM DP017-0000-GET-CURR-DATE-TIME                07420059
074300             PERFORM DP009-0000-LOAD-FK-LINES                     07430059
074400             PERFORM DP008-0000-WRITE-PANEL                       07440059
074500                                                                  07450059
074600         WHEN DP020-SRC-AID = DP016-CLEAR                         07460059
074700             SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 07470059
074800                                                                  07480059
074900             PERFORM B400-MOVE-COMMAREA-TO-SCREEN                 07490059
075000             PERFORM B500-EDIT-DATA-IN-COMMAREA                   07500059
075100             PERFORM B600-DISPLAY-PANEL                           07510059
075200                                                                  07520059
075300         WHEN DP020-FK-NEXT-SELECTION(DP020-SRC-AID)              07530059
075400           MOVE ZEROES  TO  PV-TOT-RETAIL                         07540059
075500                            PV-TOT-COST                           07550059
075600                            PV-TOT-QTY                            07560059
075700           IF RV001-LIST                                          07570059
075800             PERFORM D300-GET-NEXT-DFCTOR                         07580059
075900           ELSE                                                   07590059
076000             MOVE PC-TSYMSG-00070                                 07600059
076100                            TO  DP020-MSG-NUMBER                  07610059
076200             SET  DP020-MSG-INFORMATIONAL                         07620059
076300                            TO  TRUE                              07630059
076400             MOVE -1        TO  ANAVCMDL                          07640059
076500           END-IF                                                 07650059
076600             PERFORM B600-DISPLAY-PANEL                           07660059
076700*********** F15==> UPDATE HEADER                                  07670059
076800         WHEN DP020-SRC-AID = DP016-PF15                          07680059
076900                                                                  07690059
077000             PERFORM B500-EDIT-DATA-IN-COMMAREA                   07700059
077100             IF CONTINUE-PROCESSING                               07710059
077200                PERFORM G100-UPDATE-TDFCTOR                       07720059
077300                SET RV100-RECORD-UPDATED TO TRUE                  07730059
077400             END-IF                                               07740059
077500                                                                  07750059
077600             PERFORM B600-DISPLAY-PANEL                           07760059
077700                                                                  07770059
077800*********** F17==> UPDATE RETURN AUTHORIZATION INFORMATION        07780059
077900         WHEN  DP020-SRC-AID = DP016-PF17                         07790059
078000                                                                  07800059
078100             PERFORM B500-EDIT-DATA-IN-COMMAREA                   07810059
078200             IF CONTINUE-PROCESSING                               07820059
078300                 IF RV001-RTV-LISTING AND                         07830059
078400                   (RV001-CLOSED-LISTING   OR                     07840059
078500                    RV001-D-AND-D-LISTING  OR                     07850059
078600                    RV001-SHIPPED-LISTING  OR                     07860059
078700                    RV001-APPROVED-LISTING)                       07870059
078800                     PERFORM D000-NAVIGATE                        07880059
078900                 ELSE                                             07890059
079000                     MOVE -1              TO ARANAMEL             07900059
079100                     MOVE PC-TSYMSG-03159 TO DP020-MSG-NUMBER     07910059
079200                     SET DP020-MSG-FATAL  TO TRUE                 07920059
079300                     PERFORM B600-DISPLAY-PANEL                   07930059
079400                 END-IF                                           07940059
079500             ELSE                                                 07950059
079600                 PERFORM B600-DISPLAY-PANEL                       07960059
079700             END-IF                                               07970059
079800                                                                  07980059
079900*********** F18==> UPDATE DETAILS                                 07990059
080000         WHEN  DP020-FK-LOCAL-GOTO(DP020-SRC-AID)                 08000059
080100                                                                  08010059
080200             PERFORM B500-EDIT-DATA-IN-COMMAREA                   08020059
080300             IF CONTINUE-PROCESSING                               08030059
080400                 PERFORM D000-NAVIGATE                            08040059
080500             ELSE                                                 08050059
080600                 PERFORM B600-DISPLAY-PANEL                       08060059
080700             END-IF                                               08070059
080800                                                                  08080059
080900*********** F24==> PRINT LISTING                                  08090059
081000         WHEN  DP020-SRC-AID = DP016-PF24                         08100059
081100             PERFORM B500-EDIT-DATA-IN-COMMAREA                   08110059
081200             IF CONTINUE-PROCESSING                               08120059
081300                PERFORM D100-SETUP-INTER-APPL-COMM                08130059
081400                IF RV001-OPEN-LISTING                             08140059
081500                   MOVE 'OPEN LISTING....CANNOT PRINT'            08150059
081600                                        TO DP020-MSG-MESSAGE      08160059
081700                   MOVE -1              TO    ARANAMEL            08170059
081800                   SET  DP020-MSG-FATAL TO  TRUE                  08180059
081900                ELSE                                              08190059
082000                   IF RV001-RTV-LISTING                           08200059
082100                       PERFORM E400-PRINT-RTV-LISTING             08210059
082200                   END-IF                                         08220059
082300                END-IF                                            08230059
082400             END-IF                                               08240059
082500             PERFORM B600-DISPLAY-PANEL                           08250059
082600         WHEN OTHER                                               08260059
082700*            -- INVALID FUNCTION KEY --                           08270059
082800             PERFORM B500-EDIT-DATA-IN-COMMAREA                   08280059
082900             MOVE -1              TO    ARANAMEL                  08290059
083000             MOVE PC-TSYMSG-00045  TO                             08300059
083100                                    DP020-MSG-NUMBER              08310059
083200             SET DP020-MSG-FATAL TO TRUE                          08320059
083300             PERFORM B600-DISPLAY-PANEL                           08330059
083400                                                                  08340059
083500     END-EVALUATE.                                                08350059
083600 EJECT                                                            08360059
083700                                                                  08370059
083800******************************************************************08380059
083900*   MOVES SCREEN FIELDS TO THIS TRANSACTION SPECIFIC              08390059
084000*   COMMAREA IF ANYTHING WAS ENTERED ON THIS SCREEN               08400059
084100*   PERFORMED  BY B300-PROCESS-MAP.                               08410059
084200******************************************************************08420059
084300 C200-MOVE-SCREEN-TO-COMMAREA.                                    08430059
084400                                                                  08440059
084500     IF (ARANAMEL   GREATER  THAN ZERO                            08450059
084600      OR ARANAMEA   EQUAL  PC-ERASE-EOF)                          08460059
084700        MOVE  ARANAMEI   TO   RV001-VEND-ATTN-NAME                08470059
084800     END-IF.                                                      08480059
084900                                                                  08490059
085000     IF (ARVADDRL   GREATER  THAN ZERO                            08500059
085100      OR ARVADDRA   EQUAL  PC-ERASE-EOF)                          08510059
085200        MOVE  ARVADDRI   TO   RV001-VEND-ADDR                     08520059
085300     END-IF.                                                      08530059
085400                                                                  08540059
085500     IF RV001-VEND-ADDR > SPACES                                  08550059
085600        SET RV001-VENDOR-INFO-ENTERED TO TRUE                     08560059
085700     ELSE                                                         08570059
085800        SET RV001-NO-VENDOR-INFO-ENTERED TO TRUE                  08580059
085900     END-IF.                                                      08590059
086000                                                                  08600059
086100     IF (ARVCITYL   GREATER  THAN ZERO                            08610059
086200      OR ARVCITYA   EQUAL  PC-ERASE-EOF)                          08620059
086300        MOVE  ARVCITYI   TO   RV001-VEND-CITY                     08630059
086400     END-IF.                                                      08640059
086500                                                                  08650059
086600     IF (ARSTATEL   GREATER  THAN ZERO                            08660059
086700      OR ARSTATEA   EQUAL  PC-ERASE-EOF)                          08670059
086800        MOVE  ARSTATEI   TO   RV001-VEND-STATE                    08680059
086900     END-IF.                                                      08690059
087000                                                                  08700059
087100     IF (ARZIPCDL   GREATER  THAN ZERO                            08710059
087200      OR ARZIPCDA   EQUAL  PC-ERASE-EOF)                          08720059
087300        MOVE  ARZIPCDI   TO   RV001-VEND-ZIP-CODEX                08730059
087400     END-IF.                                                      08740059
087500                                                                  08750059
087600     IF (ARZIPSFL   GREATER  THAN ZERO                            08760059
087700      OR ARZIPSFA   EQUAL  PC-ERASE-EOF)                          08770059
087800        MOVE  ARZIPSFI   TO   RV001-VEND-ZIP-SFXX                 08780059
087900     END-IF.                                                      08790059
088000                                                                  08800059
088100     IF  ARPRNTRL   GREATER  THAN ZERO                            08810059
088200        MOVE  ARPRNTRI   TO   RV001-PRINTER                       08820059
088300     ELSE                                                         08830059
088400        IF  ARPRNTRA   EQUAL  PC-ERASE-EOF                        08840059
088500            MOVE SPACES  TO   RV001-PRINTER                       08850059
088600        END-IF                                                    08860059
088700     END-IF.                                                      08870059
088800                                                                  08880059
088900     IF (ARPHACDL   GREATER  THAN ZERO                            08890059
089000      OR ARPHACDA   EQUAL  PC-ERASE-EOF)                          08900059
089100        MOVE  ARPHACDI   TO   RV001-PHN-AREA-CODEX                08910059
089200     END-IF.                                                      08920059
089300                                                                  08930059
089400     IF (ARPHECDL   GREATER  THAN ZERO                            08940059
089500      OR ARPHECDA   EQUAL  PC-ERASE-EOF)                          08950059
089600        MOVE  ARPHECDI   TO   RV001-PHN-EXCH-CODEX                08960059
089700     END-IF.                                                      08970059
089800                                                                  08980059
089900     IF (ARPHNBRL   GREATER  THAN ZERO                            08990059
090000      OR ARPHNBRA   EQUAL  PC-ERASE-EOF)                          09000059
090100        MOVE  ARPHNBRI   TO   RV001-PHN-NBRX                      09010059
090200     END-IF.                                                      09020059
090300                                                                  09030059
090400     IF (ARFXACDL   GREATER  THAN ZERO                            09040059
090500      OR ARFXACDA   EQUAL  PC-ERASE-EOF)                          09050059
090600        MOVE  ARFXACDI   TO   RV001-FAX-AREA-CODEX                09060059
090700     END-IF.                                                      09070059
090800                                                                  09080059
090900     IF (ARFXECDL   GREATER  THAN ZERO                            09090059
091000      OR ARFXECDA   EQUAL  PC-ERASE-EOF)                          09100059
091100        MOVE  ARFXECDI   TO   RV001-FAX-EXCH-CODEX                09110059
091200     END-IF.                                                      09120059
091300                                                                  09130059
091400     IF (ARFXNBRL   GREATER  THAN ZERO                            09140059
091500      OR ARFXNBRA   EQUAL  PC-ERASE-EOF)                          09150059
091600        MOVE  ARFXNBRI   TO   RV001-FAX-NBRX                      09160059
091700     END-IF.                                                      09170059
091800                                                                  09180059
091900     IF ARLOCTNL   GREATER  THAN ZERO                             09190059
092000         MOVE  ARLOCTNI   TO   RV001-LOCATION                     09200059
092100     ELSE                                                         09210059
092200         IF ARLOCTNA   EQUAL  PC-ERASE-EOF                        09220059
092300             MOVE RV001-LOCATION-OLD TO RV001-LOCATION            09230059
092400         END-IF                                                   09240059
092500     END-IF.                                                      09250059
092600                                                                  09260059
092700 EJECT                                                            09270059
092800******************************************************************09280059
092900 D000-NAVIGATE.                                                   09290059
093000******************************************************************09300059
093100     COMPUTE  RV100-NUMBER-PROCESSED-ITEMS =                      09310059
093200         ((RV001-RL-ITEM - 1) * RV101-RA-MAX-ITEMS) +             09320059
093300                             RV001-RL-SUB.                        09330059
093400     MOVE RV001-DFCT-ORD-ID      TO RV100-UK-RA-NUMBER            09340059
093500                                    RV100-UK-DEBIT-NUMBER         09350059
093600                                    RV100-RA-NUMBER.              09360059
093700     MOVE RV001-PRINTER          TO RV100-PRINTER-DEST.           09370059
093800     MOVE RV001-BUYER            TO RV100-BUYER-NAME.             09380059
093900     MOVE RV001-TOTAL-COST       TO RV100-TOTAL-COST.             09390059
094000     MOVE RV001-TOTAL-RETAIL     TO RV100-TOTAL-RETAIL.           09400059
094100     MOVE RV001-VEND-NAME        TO RV100-VENDOR-NAME.            09410059
094200     MOVE RV001-ENT-ID           TO RV100-ENT-ID.                 09420059
094300     MOVE RV001-ORDER-TYPE       TO RV100-TYPE-CDE.               09430059
094400     MOVE RV001-ORDER-STATUS     TO RV100-STATUS-CDE.             09440059
094500     MOVE RV001-LOCATION         TO RV100-LOCATION.               09450059
094600     MOVE RV001-ENT-ID           TO RV100-ENT-ID.                 09460059
094700     MOVE RV001-DEPT-NBR         TO RV100-DEPT-NUMBER             09470059
094800                                                                  09480059
094900     MOVE RV100-INTER-APPL-COMMAREA TO                            09490059
095000                          RV001-SAVE-INTER-APPL-COMM.             09500059
095100                                                                  09510059
095200     PERFORM DP015-1000-START-NAVIGATOR.                          09520059
095300                                                                  09530059
095400 EJECT                                                            09540059
095500*                                                                 09550059
095600******************************************************************09560059
095700 D100-SETUP-INTER-APPL-COMM.                                      09570059
095800******************************************************************09580059
095900                                                                  09590059
096000     IF DP020-FK-RETURN(DP020-SRC-AID)                            09600059
096100                                                                  09610059
096200          IF RV001-LIST                                           09620059
096300             PERFORM  E200-WRITE-QUEUE                            09630059
096400          END-IF                                                  09640059
096500                                                                  09650059
096600         MOVE RV001-SAVE-INTER-APPL-COMM                          09660059
096700                              TO  RV100-INTER-APPL-COMMAREA       09670059
096800         MOVE DP020-INTER-APPL-FORMAT-CODE                        09680059
096900                              TO  DP020-INTER-APPL-ACKNLG-CODE    09690059
097000          PERFORM E300-RESET-INITIAL-INTER-APPL                   09700059
097100     ELSE                                                         09710059
097200                                                                  09720059
097300         MOVE RV001-DFCT-ORD-ID  TO    RV100-UK-RA-NUMBER         09730059
097400                                       RV100-UK-DEBIT-NUMBER      09740059
097500     END-IF.                                                      09750059
097600                                                                  09760059
097700 EJECT                                                            09770059
097800*                                                                 09780059
097900******************************************************************09790059
098000*  GET THE DATA FOR PANEL FROM DB2 TABLES AND MOVE IT TO SCREEN. *09800059
098100*                                                                *09810059
098200*  PERFORMED  BY  B000,D300,C100                                 *09820059
098300*                                                                *09830059
098400******************************************************************09840059
098500 E100-RETRIEVE-DATA-FOR-PANEL.                                    09850059
098600*                                                                 09860059
098700     PERFORM F200-READ-TABLE-TDFCTOR.                             09870059
098800     IF SQLCODE EQUAL ZERO                                        09880059
098900        PERFORM  D160-GET-ORDER-STATUS                            09890059
099000        SET CONTINUE-PROCESSING  TO TRUE                          09900059
099100     ELSE                                                         09910059
099200        MOVE PC-TSYMSG-00148   TO DP020-MSG-NUMBER                09920059
099300        SET STOP-PROCESSING    TO TRUE                            09930059
099400        SET DP020-MSG-FATAL    TO TRUE                            09940059
099500     END-IF.                                                      09950059
099600     IF CONTINUE-PROCESSING                                       09960059
099700        MOVE ZERO  TO   PV-VEND-ZIP-CODE-SFX                      09970059
099800        MOVE DFCTOR-DFCT-ORD-ID      TO RV001-DFCT-ORD-ID         09980059
099900        MOVE DFCTOR-DFCT-ORD-ID-CDE  TO RV001-ORDER-TYPE-CDE      09990059
100000        MOVE DFCTOR-DFCT-ORD-STAT-CDE                             10000059
100100                                     TO RV001-ORDER-STATUS-CDE    10010059
100200        MOVE DFCTOR-VENDOR-DUNS-NBR  TO RV001-DUNS-NBR            10020059
100300        MOVE DFCTOR-STATUS-CHG-DTE   TO RV001-STATUS-DATE         10030059
100400        MOVE DFCTOR-LOC-ID           TO RV001-LOCATION-OLD        10040059
100500                                        RV001-LOCATION            10050059
100600        MOVE DFCTOR-VEND-ATTN-NAME   TO RV001-VEND-ATTN-NAME      10060059
100700        MOVE DFCTOR-VEND-NAME        TO RV001-VEND-NAME           10070059
100800        MOVE DFCTOR-VEND-ADDR-DESC   TO RV001-VEND-ADDR           10080059
100900        MOVE DFCTOR-VEND-CITY-NAME   TO RV001-VEND-CITY           10090059
101000        MOVE DFCTOR-VEND-STATE-CDE   TO RV001-VEND-STATE          10100059
101100        MOVE DFCTOR-VEND-ZIP-CDE     TO PV-VEND-ZIP-CODE-SFX      10110059
101200        MOVE PV-VEND-ZIP-CODE        TO RV001-VEND-ZIP-CODE       10120059
101300        MOVE PV-VEND-ZIP-SFX         TO RV001-VEND-ZIP-SFX        10130059
101400*                                                                 10140059
101500        MOVE DFCTOR-PHN-AREA-CDE     TO RV001-PHN-AREA-CODE       10150059
101600        MOVE DFCTOR-PHN-EXCH-NBR     TO RV001-PHN-EXCH-CODE       10160059
101700        MOVE DFCTOR-PHN-NBR          TO RV001-PHN-NBR             10170059
101800*                                                                 10180059
101900        MOVE DFCTOR-FAX-PHN-AREA-CDE TO RV001-FAX-AREA-CODE       10190059
102000        MOVE DFCTOR-FAX-EXCH-NBR     TO RV001-FAX-EXCH-CODE       10200059
102100        MOVE DFCTOR-FAX-PHN-NBR      TO RV001-FAX-NBR             10210059
102200        MOVE PV-DB2-OPER-UNT-ID      TO RV001-OPER-UNT-ID         10220059
102300        IF  RV001-OPER-UNT-ID = PC-OPER-UNT-ID-FINDLAY            10230059
102400            MOVE 'U4777'   TO RV001-PRINTER                       10240059
102500        ELSE                                                      10250059
102600            MOVE '     ' TO RV001-PRINTER                         10260059
102700        END-IF                                                    10270059
102800        MOVE DFCTOR-DFCT-ORD-ID-CDE  TO RV001-DFCT-ORD-ID-CDE     10280059
102900*                                                                 10290059
103000        PERFORM F300-READ-BUYER-NAME                              10300059
103100                                                                  10310059
103200        IF SQLCODE EQUAL ZERO                                     10320059
103300        OR SQLCODE = -811                                         10330059
103400        OR SQLCODE = +100                                         10340059
103500          SET CONTINUE-PROCESSING  TO TRUE                        10350059
103600        ELSE                                                      10360059
103700           MOVE PC-TSYMSG-00148   TO DP020-MSG-NUMBER             10370059
103800           SET STOP-PROCESSING    TO TRUE                         10380059
103900           SET DP020-MSG-FATAL    TO TRUE                         10390059
104000        END-IF                                                    10400059
104100                                                                  10410059
104200        IF CONTINUE-PROCESSING                                    10420059
104300          MOVE XLT00004-ENT-ID        TO RV001-ENT-ID             10430059
104400          MOVE PV-DEPT-X3             TO RV001-DEPT-NBR           10440059
104500          IF  RSPBAR-WORKER-LAST-NAME  = SPACES                   10450059
104600          AND RSPBAR-WORKER-FIR-NAME   = SPACES                   10460059
104700              MOVE SPACES             TO RV001-BUYER              10470059
104800          ELSE                                                    10480059
104900            STRING RSPBAR-WORKER-LAST-NAME DELIMITED BY '  '      10490059
105000                   ','                     DELIMITED BY SIZE      10500059
105100                   RSPBAR-WORKER-FIR-NAME  DELIMITED BY '  '      10510059
105200            INTO RV001-BUYER                                      10520059
105300          END-IF                                                  10530059
105400                                                                  10540059
105500          PERFORM F500-OPEN-CURSOR                                10550059
105600                                                                  10560059
105700          PERFORM UNTIL  PV-NO-ITEMS-LEFT                         10570059
105800             PERFORM F600-FETCH                                   10580059
105900          END-PERFORM                                             10590059
106000                                                                  10600059
106100          PERFORM F700-CLOSE-CURSOR                               10610059
106200                                                                  10620059
106300          MOVE PV-TOT-RETAIL      TO RV001-TOTAL-RETAIL           10630059
106400          MOVE PV-TOT-QTY         TO RV001-TOTAL-QTY              10640059
106500          MOVE PV-TOT-COST        TO RV001-TOTAL-COST             10650059
106600                                                                  10660059
106700          PERFORM B400-MOVE-COMMAREA-TO-SCREEN                    10670059
106800                                                                  10680059
106900       END-IF                                                     10690059
107000           IF RV001-LIST                                          10700059
107100              MOVE RV001-SAVE-TS-QUEUE     TO                     10710059
107200                       RV101-RA-REQUEST-RECORD                    10720059
107300              SET RV101-INQ(RV001-RL-SUB) TO TRUE                 10730059
107400              MOVE RV101-RA-REQUEST-RECORD TO                     10740059
107500                       RV001-SAVE-TS-QUEUE                        10750059
107600           END-IF                                                 10760059
107700     END-IF.                                                      10770059
107800*                                                                 10780059
107900 EJECT                                                            10790059
108000******************************************************************10800059
108100*  GET THE RA ORDER STATUS DESCRIPTION FROM DEFECT ORDER STATUS  *10810059
108200*  CONTROL TABLE.                                                *10820059
108300*  PERFORMED  BY  E100-RETRIEVE-DATA-FOR-PANEL.                  *10830059
108400*                                                                *10840059
108500******************************************************************10850059
108600 D160-GET-ORDER-STATUS.                                           10860059
108700                                                                  10870059
108800     EVALUATE DFCTOR-DFCT-ORD-ID-CDE                              10880059
108900                                                                  10890059
109000         WHEN 'R'                                                 10900059
109100             MOVE 'RTV     '           TO RV001-ORDER-TYPE        10910059
109200                                                                  10920059
109300         WHEN 'D'                                                 10930059
109400             MOVE 'DEBT/DIS'           TO RV001-ORDER-TYPE        10940059
109500                                                                  10950059
109600         WHEN 'M'                                                 10960059
109700             MOVE 'MARKOUT '           TO RV001-ORDER-TYPE        10970059
109800                                                                  10980059
109900         WHEN 'C'                                                 10990059
110000             MOVE 'CALLBACK'           TO RV001-ORDER-TYPE        11000059
110100     END-EVALUATE.                                                11010059
110200                                                                  11020059
110300     EVALUATE DFCTOR-DFCT-ORD-STAT-CDE                            11030059
110400         WHEN 'N'                                                 11040059
110500             MOVE 'NEW     '           TO RV001-ORDER-STATUS      11050059
110600                                                                  11060059
110700         WHEN 'O'                                                 11070059
110800             MOVE 'OPEN    '           TO RV001-ORDER-STATUS      11080059
110900                                                                  11090059
111000         WHEN 'C'                                                 11100059
111100             MOVE 'CLOSED  '           TO RV001-ORDER-STATUS      11110059
111200                                                                  11120059
111300         WHEN 'S'                                                 11130059
111400             MOVE 'SHIPPED '           TO RV001-ORDER-STATUS      11140059
111500                                                                  11150059
111600         WHEN 'P'                                                 11160059
111700             MOVE 'PENDING '           TO RV001-ORDER-STATUS      11170059
111800                                                                  11180059
111900         WHEN 'A'                                                 11190059
112000             MOVE 'APPROVED'           TO RV001-ORDER-STATUS      11200059
112100                                                                  11210059
112200         WHEN 'D'                                                 11220059
112300             MOVE 'DEBT/DIS'           TO RV001-ORDER-STATUS      11230059
112400     END-EVALUATE.                                                11240059
112500                                                                  11250059
112600                                                                  11260059
112700 EJECT                                                            11270059
112800*                                                                 11280059
112900******************************************************************11290059
113000*  GET THE HEADER INFORMATION FROM THE DEFECT ORDER TABLE.       *11300059
113100*                                                                *11310059
113200*  PERFORMED  BY  E100-RETRIEVE-DATA-FOR-PANEL.                  *11320059
113300*                                                                *11330059
113400******************************************************************11340059
113500 F200-READ-TABLE-TDFCTOR.                                         11350059
113600*                                                                 11360059
113700     MOVE RV100-OPER-UNT-ID TO PV-DB2-OPER-UNT-ID.                11370059
113800                                                                  11380059
113900     PERFORM                                                      11390059
114000         WITH TEST AFTER                                          11400059
114100         VARYING PV-SQL-SUB                                       11410059
114200         FROM 1 BY 1                                              11420059
114300         UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES             11430059
114400            OR SQLCODE = 0                                        11440059
114500            OR SQLCODE = +100                                     11450059
114600*                                                                 11460059
114700         EXEC SQL                                                 11470059
114800              SELECT                                              11480059
114900                     DFCT_ORD_ID,                                 11490059
115000                     VENDOR_DUNS_NBR,                             11500059
115100                     VEND_ATTN_NAME,                              11510059
115200                     VEND_NAME,                                   11520059
115300                     VEND_ADDR_DESC,                              11530059
115400                     VEND_CITY_NAME,                              11540059
115500                     VEND_STATE_CDE,                              11550059
115600                     VEND_ZIP_CDE,                                11560059
115700                     PHN_AREA_CDE,                                11570059
115800                     PHN_EXCH_NBR,                                11580059
115900                     PHN_NBR,                                     11590059
116000                     FAX_PHN_AREA_CDE,                            11600059
116100                     FAX_EXCH_NBR,                                11610059
116200                     FAX_PHN_NBR,                                 11620059
116300                     OPER_UNT_ID,                                 11630059
116400                     LOC_ID,                                      11640059
116500                     STATUS_CHG_DTE,                              11650059
116600                     DFCT_ORD_ID_CDE,                             11660059
116700                     DFCT_ORD_STAT_CDE                            11670059
116800              INTO                                                11680059
116900                     :DFCTOR-DFCT-ORD-ID,                         11690059
117000                     :DFCTOR-VENDOR-DUNS-NBR,                     11700059
117100                     :DFCTOR-VEND-ATTN-NAME,                      11710059
117200                     :DFCTOR-VEND-NAME,                           11720059
117300                     :DFCTOR-VEND-ADDR-DESC,                      11730059
117400                     :DFCTOR-VEND-CITY-NAME,                      11740059
117500                     :DFCTOR-VEND-STATE-CDE,                      11750059
117600                     :DFCTOR-VEND-ZIP-CDE,                        11760059
117700                     :DFCTOR-PHN-AREA-CDE,                        11770059
117800                     :DFCTOR-PHN-EXCH-NBR,                        11780059
117900                     :DFCTOR-PHN-NBR,                             11790059
118000                     :DFCTOR-FAX-PHN-AREA-CDE,                    11800059
118100                     :DFCTOR-FAX-EXCH-NBR,                        11810059
118200                     :DFCTOR-FAX-PHN-NBR,                         11820059
118300                     :DFCTOR-OPER-UNT-ID,                         11830059
118400                     :DFCTOR-LOC-ID,                              11840059
118500                     :DFCTOR-STATUS-CHG-DTE,                      11850059
118600                     :DFCTOR-DFCT-ORD-ID-CDE,                     11860059
118700                     :DFCTOR-DFCT-ORD-STAT-CDE                    11870059
118800              FROM                                                11880059
118900                     TDFCTOR                                      11890059
119000              WHERE                                               11900059
119100                     DFCT_ORD_ID  = :DFCTOR-DFCT-ORD-ID           11910059
119200                AND  OPER_UNT_ID  = :PV-DB2-OPER-UNT-ID           11920059
119300         END-EXEC                                                 11930059
119400*                                                                 11940059
119500         EVALUATE TRUE                                            11950059
119600             WHEN SQLCODE = -904                                  11960059
119700             WHEN SQLCODE = -913                                  11970059
119800             WHEN SQLCODE = ZERO                                  11980059
119900             WHEN SQLCODE = +100                                  11990059
120000                  CONTINUE                                        12000059
120100             WHEN SQLWARN0 NOT EQUAL SPACE                        12010059
120200             WHEN SQLCODE NOT EQUAL ZERO                          12020059
120300                  MOVE 'F200-READ-DFCTOR'                         12030059
120400                               TO  DP013-PARAGRAPH                12040059
120500                  MOVE 'READ DFCTOR'                              12050059
120600                               TO  DP013-MESSAGE-TEXT (1)         12060059
120700                  MOVE SQLCA   TO  DP013-SQLCA                    12070059
120800                  SET DP013-DB2-ABEND                             12080059
120900                               TO  TRUE                           12090059
121000                  PERFORM DP013-0000-PROCESS-ABEND                12100059
121100         END-EVALUATE                                             12110059
121200     END-PERFORM.                                                 12120059
121300*                                                                 12130059
121400     IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                   12140059
121500         MOVE 'F200-READ-TABLE-TDFCTOR'                           12150059
121600                               TO  DP013-PARAGRAPH                12160059
121700         MOVE 'MAX RETRIES EXCEEDED FOR READ DFCTOR'              12170059
121800                               TO  DP013-MESSAGE-TEXT (1)         12180059
121900         MOVE SQLCA            TO  DP013-SQLCA                    12190059
122000         SET DP013-DB2-ABEND   TO  TRUE                           12200059
122100         PERFORM DP013-0000-PROCESS-ABEND                         12210059
122200     END-IF.                                                      12220059
122300*                                                                 12230059
122400*                                                                 12240059
122500 EJECT                                                            12250059
122600*                                                                 12260059
122700******************************************************************12270059
122800*  GET THE BUYER FIRST AND LAST NAME.                            *12280059
122900*                                                                *12290059
123000*  PERFORMED  BY  E100-RETRIEVE-DATA-FOR-PANEL.                  *12300059
123100*                                                                *12310059
123200******************************************************************12320059
123300 F300-READ-BUYER-NAME.                                            12330059
123400*                                                                 12340059
123500     PERFORM                                                      12350059
123600         WITH TEST AFTER                                          12360059
123700         VARYING PV-SQL-SUB                                       12370059
123800         FROM 1 BY 1                                              12380059
123900         UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES             12390059
124000            OR SQLCODE = 0                                        12400059
124100            OR SQLCODE = +100                                     12410059
124200            OR SQLCODE = -811                                     12420059
124300*                                                                 12430059
124400         EXEC SQL                                                 12440059
124500            SELECT DISTINCT                                       12450059
124600               V.DEPT_NBR                                         12460059
124700             , V.ENT_ID                                           12470059
124800             , A.OPER_UNT_ID                                      12480059
124900            INTO                                                  12490059
125000               :XLT00004-DEPT-NBR                                 12500059
125100             , :XLT00004-ENT-ID                                   12510059
125200             , :DFCTOR-OPER-UNT-ID                                12520059
125300            FROM                                                  12530059
125400               TDFCTOR A,                                         12540059
125500               TDFMEIT I,                                         12550059
125600               XLT_SKU S,                                         12560059
125700               XLT_VND_STYL V                                     12570059
125800            WHERE I.DFCT_ORD_ID   =  :DFCTOR-DFCT-ORD-ID          12580059
125900              AND I.DFCT_ORD_ID   =  A.DFCT_ORD_ID                12590059
126000              AND S.ITM_NBR       =  I.DFCT_ITEM_NBR              12600059
126100              AND S.STYL_ID       =  V.STYL_ID                    12610059
126200         END-EXEC                                                 12620059
126300*                                                                 12630059
126400         EVALUATE TRUE                                            12640059
126500             WHEN SQLCODE = -904                                  12650059
126600             WHEN SQLCODE = -913                                  12660059
126700             WHEN SQLCODE = ZERO                                  12670059
126800                  CONTINUE                                        12680059
126900             WHEN SQLCODE = +100                                  12690059
127000                  MOVE SPACES  TO RSPBAR-WORKER-LAST-NAME         12700059
127100                                  RSPBAR-WORKER-FIR-NAME          12710059
127200             WHEN SQLCODE = -811                                  12720059
127300                  MOVE 'MULTIPLE BUYERS   '                       12730059
127400                               TO RSPBAR-WORKER-LAST-NAME         12740059
127500                  MOVE 'MARKOUT LIST'                             12750059
127600                               TO RSPBAR-WORKER-FIR-NAME          12760059
127700             WHEN SQLWARN0 NOT EQUAL SPACE                        12770059
127800             WHEN SQLCODE NOT EQUAL ZERO                          12780059
127900                  MOVE 'F300-READ-BUYER-NAME'                     12790059
128000                               TO  DP013-PARAGRAPH                12800059
128100                  MOVE 'READ BUYER'                               12810059
128200                               TO  DP013-MESSAGE-TEXT (1)         12820059
128300                  MOVE SQLCA   TO  DP013-SQLCA                    12830059
128400                  SET DP013-DB2-ABEND                             12840059
128500                               TO  TRUE                           12850059
128600                  PERFORM DP013-0000-PROCESS-ABEND                12860059
128700         END-EVALUATE                                             12870059
128800     END-PERFORM.                                                 12880059
128900*                                                                 12890059
129000     IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                   12900059
129100         MOVE 'F300-READ-BUYER-NAME'                              12910059
129200                               TO  DP013-PARAGRAPH                12920059
129300         MOVE 'MAX RETRIES EXCEEDED FOR READ BUYER'               12930059
129400                               TO  DP013-MESSAGE-TEXT (1)         12940059
129500         MOVE SQLCA            TO  DP013-SQLCA                    12950059
129600         SET DP013-DB2-ABEND   TO  TRUE                           12960059
129700         PERFORM DP013-0000-PROCESS-ABEND                         12970059
129800     END-IF.                                                      12980059
129900*                                                                 12990059
130000*                                                                 13000059
130100     IF SQLCODE = +100 OR SQLCODE = -811                          13010059
130200         CONTINUE                                                 13020059
130300     ELSE                                                         13030059
130400         MOVE XLT00004-DEPT-NBR  TO  PV-DEPT                      13040059
130500         MOVE PV-DEPT(2:3)       TO  MDSEAR-DEPT-NBR              13050059
130600         PERFORM                                                  13060059
130700             WITH TEST AFTER                                      13070059
130800             VARYING PV-SQL-SUB                                   13080059
130900             FROM 1 BY 1                                          13090059
131000             UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES         13100059
131100                OR SQLCODE = 0                                    13110059
131200                OR SQLCODE = +100                                 13120059
131300                                                                  13130059
131400             EXEC SQL                                             13140059
131500                SELECT DISTINCT                                   13150059
131600                   R.WORKER_FIR_NAME,                             13160059
131700                   R.WORKER_LAST_NAME                             13170059
131800                INTO                                              13180059
131900                   :RSPBAR-WORKER-FIR-NAME,                       13190059
132000                   :RSPBAR-WORKER-LAST-NAME                       13200059
132100                FROM TMDSEAR A,                                   13210059
132200                   TRSPBAR R                                      13220059
132300                WHERE                                             13230059
132400                       A.DEPT_NBR      =  :MDSEAR-DEPT-NBR        13240059
132500                   AND A.OPERCO_NBR    =  '03'                    13250059
132600                   AND A.MDSELV_CDE    =  'DPT'                   13260059
132700                   AND A.MDSEAR_DKEY   =  R.MDSEAR_DKEY           13270059
132800                   AND R.RSPLVL_CDE    =  'BYR'                   13280059
132900                   AND R.WORKER_STRT_DTE <= CURRENT DATE          13290059
133000                   AND R.WORKER_END_DTE  >= CURRENT DATE          13300059
133100             END-EXEC                                             13310059
133200                                                                  13320059
133300             EVALUATE TRUE                                        13330059
133400                 WHEN SQLCODE = -904                              13340059
133500                 WHEN SQLCODE = -913                              13350059
133600                 WHEN SQLCODE = ZERO                              13360059
133700                 WHEN SQLCODE = +100                              13370059
133800                      CONTINUE                                    13380059
133900                 WHEN SQLWARN0 NOT EQUAL SPACE                    13390059
134000                 WHEN SQLCODE NOT EQUAL ZERO                      13400059
134100                      MOVE 'F300-READ-BUYER-NAME'                 13410059
134200                                   TO  DP013-PARAGRAPH            13420059
134300                      MOVE 'READ BUYER'                           13430059
134400                                   TO  DP013-MESSAGE-TEXT (1)     13440059
134500                      MOVE SQLCA   TO  DP013-SQLCA                13450059
134600                      SET DP013-DB2-ABEND                         13460059
134700                                   TO  TRUE                       13470059
134800                      PERFORM DP013-0000-PROCESS-ABEND            13480059
134900             END-EVALUATE                                         13490059
135000         END-PERFORM                                              13500059
135100                                                                  13510059
135200         IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES               13520059
135300             MOVE 'F300-READ-BUYER-NAME'                          13530059
135400                                   TO  DP013-PARAGRAPH            13540059
135500             MOVE 'MAX RETRIES EXCEEDED FOR READ BUYER'           13550059
135600                                   TO  DP013-MESSAGE-TEXT (1)     13560059
135700             MOVE SQLCA            TO  DP013-SQLCA                13570059
135800             SET DP013-DB2-ABEND   TO  TRUE                       13580059
135900             PERFORM DP013-0000-PROCESS-ABEND                     13590059
136000         END-IF                                                   13600059
136100     END-IF.                                                      13610059
136200*                                                                 13620059
136300 EJECT                                                            13630059
136400*                                                                 13640059
136500******************************************************************13650059
136600*  CHECKS THE STATUS OF A LOCATION                               *13660059
136700*                                                                *13670059
136800*  PERFORMED  BY  E100-RETRIEVE-DATA-FOR-PANEL.                  *13680059
136900*                                                                *13690059
137000******************************************************************13700059
137100 F400-CHECK-LOCATION.                                             13710059
137200*                                                                 13720059
137300     PERFORM                                                      13730059
137400         WITH TEST AFTER                                          13740059
137500         VARYING PV-SQL-SUB                                       13750059
137600         FROM 1 BY 1                                              13760059
137700         UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES             13770059
137800            OR SQLCODE = 0                                        13780059
137900            OR SQLCODE = +100                                     13790059
138000            OR SQLCODE = -811                                     13800059
138100*                                                                 13810059
138200         EXEC SQL                                                 13820059
138300            SELECT                                                13830059
138400                 DFCT_ORD_ID                                      13840059
138500             ,   DFCT_ORD_STAT_CDE                                13850059
138600            INTO                                                  13860059
138700               :PV-LOC-LISTING-NBR                                13870059
138800             , :PV-LOC-STATUS-CDE                                 13880059
138900            FROM                                                  13890059
139000               TDFCTOR                                            13900059
139100            WHERE   LOC_ID = :RV001-LOCATION                      13910059
139200         END-EXEC                                                 13920059
139300*                                                                 13930059
139400         EVALUATE TRUE                                            13940059
139500             WHEN SQLCODE = ZERO                                  13950059
139600             WHEN SQLCODE = +100                                  13960059
139700             WHEN SQLCODE = -811                                  13970059
139800             WHEN SQLCODE = -904                                  13980059
139900             WHEN SQLCODE = -913                                  13990059
140000                  CONTINUE                                        14000059
140100             WHEN SQLWARN0 NOT EQUAL SPACE                        14010059
140200             WHEN SQLCODE NOT EQUAL ZERO                          14020059
140300                  MOVE 'F400-CHECK-LOCATION'                      14030059
140400                               TO  DP013-PARAGRAPH                14040059
140500                  MOVE 'READ TDFCTOR FOR LOCATION STATUS'         14050059
140600                               TO  DP013-MESSAGE-TEXT (1)         14060059
140700                  MOVE SQLCA   TO  DP013-SQLCA                    14070059
140800                  SET DP013-DB2-ABEND                             14080059
140900                               TO  TRUE                           14090059
141000                  PERFORM DP013-0000-PROCESS-ABEND                14100059
141100         END-EVALUATE                                             14110059
141200     END-PERFORM.                                                 14120059
141300*                                                                 14130059
141400     IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                   14140059
141500         MOVE 'F400-CHECK-LOCATION'                               14150059
141600                               TO  DP013-PARAGRAPH                14160059
141700         MOVE 'MAX RETRIES EXCEEDED FOR READ OF TDFCTOR'          14170059
141800                               TO  DP013-MESSAGE-TEXT (1)         14180059
141900         MOVE SQLCA            TO  DP013-SQLCA                    14190059
142000         SET DP013-DB2-ABEND   TO  TRUE                           14200059
142100         PERFORM DP013-0000-PROCESS-ABEND                         14210059
142200     END-IF.                                                      14220059
142300*                                                                 14230059
142400*                                                                 14240059
142500     EVALUATE SQLCODE                                             14250059
142600         WHEN +100                                                14260059
142700             SET PS-EMPTY-LOCATION    TO TRUE                     14270059
142800                                                                  14280059
142900         WHEN -811                                                14290059
143000             SET PS-STORAGE-LOCATION  TO TRUE                     14300059
143100                                                                  14310059
143200         WHEN +0                                                  14320059
143300             IF PV-LOC-STATUS-CDE = 'O'                           14330059
143400                 SET PS-USED-LISTING-LOCATION                     14340059
143500                                      TO TRUE                     14350059
143600             ELSE                                                 14360059
143700                 SET PS-STORAGE-LOCATION TO TRUE                  14370059
143800             END-IF                                               14380059
143900     END-EVALUATE.                                                14390059
144000*                                                                 14400059
144100 EJECT                                                            14410059
144200*                                                                 14420059
144300*                                                                 14430059
144400 F500-OPEN-CURSOR.                                                14440059
144500*                                                                 14450059
144600     PERFORM                                                      14460059
144700         WITH TEST AFTER                                          14470059
144800         VARYING PV-SQL-SUB                                       14480059
144900         FROM 1 BY 1                                              14490059
145000         UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES             14500059
145100            OR SQLCODE = 0                                        14510059
145200            OR SQLCODE = +100                                     14520059
145300*                                                                 14530059
145400         EXEC SQL                                                 14540059
145500              OPEN DFCT-ITEM                                      14550059
145600         END-EXEC                                                 14560059
145700*                                                                 14570059
145800         EVALUATE TRUE                                            14580059
145900             WHEN SQLCODE = -904                                  14590059
146000             WHEN SQLCODE = -913                                  14600059
146100             WHEN SQLCODE = ZERO                                  14610059
146200             WHEN SQLCODE = +100                                  14620059
146300                  CONTINUE                                        14630059
146400             WHEN SQLWARN0 NOT EQUAL SPACE                        14640059
146500             WHEN SQLCODE NOT EQUAL ZERO                          14650059
146600                  MOVE 'F500-OPEN-CURSOR'                         14660059
146700                               TO  DP013-PARAGRAPH                14670059
146800                  MOVE 'OPEN DFCT-ITEM CURSOR'                    14680059
146900                               TO  DP013-MESSAGE-TEXT (1)         14690059
147000                  MOVE SQLCA   TO  DP013-SQLCA                    14700059
147100                  SET DP013-DB2-ABEND                             14710059
147200                               TO  TRUE                           14720059
147300                  PERFORM DP013-0000-PROCESS-ABEND                14730059
147400         END-EVALUATE                                             14740059
147500     END-PERFORM.                                                 14750059
147600*                                                                 14760059
147700     IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                   14770059
147800         MOVE 'F500-OPEN-CURSOR'                                  14780059
147900                               TO  DP013-PARAGRAPH                14790059
148000         MOVE 'MAX RETRIES EXCEEDED FOR OPEN CURSOR'              14800059
148100                               TO  DP013-MESSAGE-TEXT (1)         14810059
148200         MOVE SQLCA            TO  DP013-SQLCA                    14820059
148300         SET DP013-DB2-ABEND   TO  TRUE                           14830059
148400         PERFORM DP013-0000-PROCESS-ABEND                         14840059
148500     END-IF.                                                      14850059
148600*                                                                 14860059
148700 EJECT                                                            14870059
148800******************************************************************14880059
148900*                                                                 14890059
149000 F700-CLOSE-CURSOR.                                               14900059
149100*                                                                 14910059
149200     PERFORM                                                      14920059
149300         WITH TEST AFTER                                          14930059
149400         VARYING PV-SQL-SUB                                       14940059
149500         FROM 1 BY 1                                              14950059
149600         UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES             14960059
149700            OR SQLCODE = 0                                        14970059
149800            OR SQLCODE = +100                                     14980059
149900*                                                                 14990059
150000         EXEC SQL                                                 15000059
150100             CLOSE DFCT-ITEM                                      15010059
150200         END-EXEC                                                 15020059
150300*                                                                 15030059
150400         EVALUATE TRUE                                            15040059
150500             WHEN SQLCODE = -904                                  15050059
150600             WHEN SQLCODE = -913                                  15060059
150700             WHEN SQLCODE = ZERO                                  15070059
150800             WHEN SQLCODE = +100                                  15080059
150900                  CONTINUE                                        15090059
151000             WHEN SQLWARN0 NOT EQUAL SPACE                        15100059
151100             WHEN SQLCODE NOT EQUAL ZERO                          15110059
151200                  MOVE 'F700-CLOSE-CURSOR'                        15120059
151300                               TO  DP013-PARAGRAPH                15130059
151400                  MOVE 'CLOSE DFCT-ITEM CURSOR'                   15140059
151500                               TO  DP013-MESSAGE-TEXT (1)         15150059
151600                  MOVE SQLCA   TO  DP013-SQLCA                    15160059
151700                  SET DP013-DB2-ABEND                             15170059
151800                               TO  TRUE                           15180059
151900                  PERFORM DP013-0000-PROCESS-ABEND                15190059
152000         END-EVALUATE                                             15200059
152100     END-PERFORM.                                                 15210059
152200*                                                                 15220059
152300     IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                   15230059
152400         MOVE 'F700-CLOSE-CURSOR'                                 15240059
152500                               TO  DP013-PARAGRAPH                15250059
152600         MOVE 'MAX RETRIES EXCEEDED FOR CLOSE CURSOR'             15260059
152700                               TO  DP013-MESSAGE-TEXT (1)         15270059
152800         MOVE SQLCA            TO  DP013-SQLCA                    15280059
152900         SET DP013-DB2-ABEND   TO  TRUE                           15290059
153000         PERFORM DP013-0000-PROCESS-ABEND                         15300059
153100     END-IF.                                                      15310059
153200*                                                                 15320059
153300 EJECT                                                            15330059
153400******************************************************************15340059
153500*  FETCH THE CURSOR TO GET THE QUANTITY,RETAIL AND COST AMOUNTS  *15350059
153600*  FROM DEFECT ITEM DB2 TABLE.                                   *15360059
153700*                                                                *15370059
153800*  PERFORMED  BY  A100-CONTROL-PROCESSING.                       *15380059
153900*  PERFORMED  BY  E100-RETRIEVE-DATA-FOR-PANEL.                  *15390059
154000*                                                                *15400059
154100******************************************************************15410059
154200*                                                                 15420059
154300 F600-FETCH.                                                      15430059
154400*                                                                 15440059
154500         EXEC SQL                                                 15450059
154600              FETCH DFCT-ITEM                                     15460059
154700              INTO                                                15470059
154800                    :PV-RETAIL:PV-DB2-NULL-IND1,                  15480059
154900                    :PV-COST:PV-DB2-NULL-IND2,                    15490059
155000                    :PV-QTY                                       15500059
155100         END-EXEC                                                 15510059
155200*                                                                 15520059
155300         EVALUATE TRUE                                            15530059
155400             WHEN SQLCODE = ZERO                                  15540059
155500             WHEN SQLCODE = +100                                  15550059
155600                  CONTINUE                                        15560059
155700             WHEN SQLWARN0 NOT EQUAL SPACE                        15570059
155800             WHEN SQLCODE NOT EQUAL ZERO                          15580059
155900                  MOVE 'F600-FETCH'                               15590059
156000                               TO  DP013-PARAGRAPH                15600059
156100                  MOVE 'FETCH DFCT-ITEM CURSOR'                   15610059
156200                               TO  DP013-MESSAGE-TEXT (1)         15620059
156300                  MOVE SQLCA   TO  DP013-SQLCA                    15630059
156400                  SET DP013-DB2-ABEND                             15640059
156500                               TO  TRUE                           15650059
156600                  PERFORM DP013-0000-PROCESS-ABEND                15660059
156700         END-EVALUATE                                             15670059
156800*                                                                 15680059
156900     IF SQLCODE EQUAL +100                                        15690059
157000        SET PV-NO-ITEMS-LEFT   TO TRUE                            15700059
157100     END-IF.                                                      15710059
157200     IF SQLCODE EQUAL  ZERO                                       15720059
157300        ADD PV-RETAIL   TO   PV-TOT-RETAIL                        15730059
157400        ADD PV-COST     TO   PV-TOT-COST                          15740059
157500        ADD PV-QTY      TO   PV-TOT-QTY                           15750059
157600     END-IF.                                                      15760059
157700*                                                                 15770059
157800******************************************************************15780059
157900*    VALIDATION HAS BEEN PERFORMED.  THE CURRENT RA HEADER        15790059
158000*    CAN BE UPDATED.                                              15800059
158100*                                                                 15810059
158200*    PERFORMED BY B300.                                           15820059
158300******************************************************************15830059
158400*                                                                 15840059
158500 G100-UPDATE-TDFCTOR.                                             15850059
158600*                                                                 15860059
158700     MOVE RV001-PHN-AREA-CODE  TO  DFCTOR-PHN-AREA-CDE.           15870059
158800     MOVE RV001-PHN-EXCH-CODE  TO  DFCTOR-PHN-EXCH-NBR.           15880059
158900     MOVE RV001-PHN-NBR        TO  DFCTOR-PHN-NBR.                15890059
159000     MOVE RV001-FAX-AREA-CODE  TO  DFCTOR-FAX-PHN-AREA-CDE.       15900059
159100     MOVE RV001-FAX-EXCH-CODE  TO  DFCTOR-FAX-EXCH-NBR.           15910059
159200     MOVE RV001-FAX-NBR        TO  DFCTOR-FAX-PHN-NBR.            15920059
159300     MOVE RV001-VEND-ZIP-CODE  TO  PV-VEND-ZIP-CODE.              15930059
159400     MOVE RV001-VEND-ZIP-SFX   TO  PV-VEND-ZIP-SFX.               15940059
159500     MOVE PV-VEND-ZIP-CODE-SFX                                    15950059
159600                               TO  DFCTOR-VEND-ZIP-CDE.           15960059
159700     MOVE RV001-DFCT-ORD-ID    TO  PV-DFCT-ORD-ID.                15970059
159800     IF RV001-LOCATION = RV001-LOCATION-OLD                       15980059
159900         MOVE RV001-LOCATION-OLD                                  15990059
160000                               TO  DFCTOR-LOC-ID                  16000059
160100     ELSE                                                         16010059
160200         PERFORM A300-RACF-ACCESS                                 16020059
160300                                                                  16030059
160400         IF USER-HAS-UPDATE-AUTH                                  16040059
160500             MOVE RV001-LOCATION   TO  DFCTOR-LOC-ID              16050059
160600                                       RV001-LOCATION-OLD         16060059
160700         ELSE                                                     16070059
160800             MOVE RV001-LOCATION-OLD                              16080059
160900                                   TO  DFCTOR-LOC-ID              16090059
161000                                       RV001-LOCATION             16100059
161100             MOVE DP015-ASK-NOR-OFF                               16110059
161200                                   TO  RVKM102-LOCA               16120059
161300             MOVE DP015-BLUE       TO  RVKM102-LOCC               16130059
161400             MOVE DP015-HL-OFF     TO  RVKM102-LOCH               16140059
161500             MOVE PC-TSYMSG-01117  TO  DP020-MSG-NUMBER           16150059
161600             SET  DP020-MSG-INFORMATIONAL                         16160059
161700                                   TO  TRUE                       16170059
161800         END-IF                                                   16180059
161900     END-IF.                                                      16190059
162000                                                                  16200059
162100*                                                                 16210059
162200     PERFORM                                                      16220059
162300         WITH TEST AFTER                                          16230059
162400         VARYING PV-SQL-SUB                                       16240059
162500         FROM 1 BY 1                                              16250059
162600         UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES             16260059
162700            OR SQLCODE = 0                                        16270059
162800            OR SQLCODE = +100                                     16280059
162900*                                                                 16290059
163000         EXEC SQL                                                 16300059
163100              UPDATE                                              16310059
163200                    TDFCTOR                                       16320059
163300                SET                                               16330059
163400                    VEND_ATTN_NAME   =  :RV001-VEND-ATTN-NAME,    16340059
163500                    VEND_ADDR_DESC   =  :RV001-VEND-ADDR,         16350059
163600                    VEND_CITY_NAME   =  :RV001-VEND-CITY,         16360059
163700                    VEND_STATE_CDE   =  :RV001-VEND-STATE,        16370059
163800                    VEND_ZIP_CDE     =  :DFCTOR-VEND-ZIP-CDE,     16380059
163900                    PHN_AREA_CDE     =  :DFCTOR-PHN-AREA-CDE,     16390059
164000                    PHN_EXCH_NBR     =  :DFCTOR-PHN-EXCH-NBR,     16400059
164100                    PHN_NBR          =  :DFCTOR-PHN-NBR,          16410059
164200                    FAX_PHN_AREA_CDE =  :DFCTOR-FAX-PHN-AREA-CDE, 16420059
164300                    FAX_EXCH_NBR     =  :DFCTOR-FAX-EXCH-NBR,     16430059
164400                    FAX_PHN_NBR      =  :DFCTOR-FAX-PHN-NBR,      16440059
164500                    LOC_ID           =  :DFCTOR-LOC-ID            16450059
164600              WHERE                                               16460059
164700                    DFCT_ORD_ID      =  :PV-DFCT-ORD-ID           16470059
164800         END-EXEC                                                 16480059
164900*                                                                 16490059
165000         EVALUATE TRUE                                            16500059
165100             WHEN SQLCODE = -904                                  16510059
165200             WHEN SQLCODE = -913                                  16520059
165300             WHEN SQLCODE = +100                                  16530059
165400             WHEN SQLCODE = ZERO                                  16540059
165500                  CONTINUE                                        16550059
165600             WHEN SQLWARN0 NOT EQUAL SPACE                        16560059
165700             WHEN SQLCODE NOT EQUAL ZERO                          16570059
165800                  MOVE 'G100-UPDATE-DFCTOR'                       16580059
165900                               TO  DP013-PARAGRAPH                16590059
166000                  MOVE 'UPDATE DFCTOR'                            16600059
166100                               TO  DP013-MESSAGE-TEXT (1)         16610059
166200                  MOVE SQLCA   TO  DP013-SQLCA                    16620059
166300                  SET DP013-DB2-ABEND                             16630059
166400                               TO  TRUE                           16640059
166500                  PERFORM DP013-0000-PROCESS-ABEND                16650059
166600         END-EVALUATE                                             16660059
166700     END-PERFORM.                                                 16670059
166800*                                                                 16680059
166900     IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                   16690059
167000         MOVE 'G100-UPDATE-DFCTOR'                                16700059
167100                               TO  DP013-PARAGRAPH                16710059
167200         MOVE 'MAX RETRIES EXCEEDED FOR UPDATE DFCTOR'            16720059
167300                               TO  DP013-MESSAGE-TEXT (1)         16730059
167400         MOVE SQLCA            TO  DP013-SQLCA                    16740059
167500         SET DP013-DB2-ABEND   TO  TRUE                           16750059
167600         PERFORM DP013-0000-PROCESS-ABEND                         16760059
167700     END-IF.                                                      16770059
167800*                                                                 16780059
167900     IF  SQLCODE EQUAL ZERO                                       16790059
168000         MOVE PC-TSYMSG-00059  TO  DP020-MSG-NUMBER               16800059
168100           IF RV001-LIST                                          16810059
168200              MOVE RV001-SAVE-TS-QUEUE     TO                     16820059
168300                       RV101-RA-REQUEST-RECORD                    16830059
168400              SET RV101-UPD(RV001-RL-SUB) TO TRUE                 16840059
168500              MOVE RV101-RA-REQUEST-RECORD TO                     16850059
168600                       RV001-SAVE-TS-QUEUE                        16860059
168700           END-IF                                                 16870059
168800           SET RV100-RECORD-UPDATED  TO TRUE                      16880059
168900     ELSE                                                         16890059
169000         MOVE PC-TSYMSG-00148  TO  DP020-MSG-NUMBER               16900059
169100     END-IF.                                                      16910059
169200*                                                                 16920059
169300     SET DP020-MSG-INFORMATIONAL                                  16930059
169400                               TO  TRUE.                          16940059
169500*                                                                 16950059
169600 EJECT                                                            16960059
169700******************************************************************16970059
169800*    READ THE TEMPORARY STORAGE QUEUE THAT CONTAINS THE SELECTED  16980059
169900*    HEADERS FROM RVKCS100                                        16990059
170000*                                                                 17000059
170100*    PERFORMED BY B300, D300                                      17010059
170200******************************************************************17020059
170300*                                                                 17030059
170400 F100-READ-LIST-QUEUE.                                            17040059
170500*                                                                 17050059
170600     EXEC CICS                                                    17060059
170700         READQ TS                                                 17070059
170800         QUEUE(RV100-TSQB-QUEUE-NAME)                             17080059
170900         INTO(RV101-RA-REQUEST-RECORD)                            17090059
171000         LENGTH(RV100-TSQB-QUEUE-LENGTH)                          17100059
171100         ITEM(RV001-RL-ITEM)                                      17110059
171200         RESP(PV-RESP)                                            17120059
171300     END-EXEC.                                                    17130059
171400*                                                                 17140059
171500     IF  PV-RESP NOT EQUAL DFHRESP(NORMAL)                        17150059
171600         MOVE PV-RESP          TO  PM-RESP-22                     17160059
171700         SET DP013-LOGIC-ABEND TO  TRUE                           17170059
171800         SET DP013-NO-ROLLBACK TO  TRUE                           17180059
171900         MOVE 'F100-READ-LIST-QUEUE'                              17190059
172000                               TO  DP013-PARAGRAPH                17200059
172100         MOVE PM-PROGRAM-MESSAGE-22                               17210059
172200                               TO  DP013-MESSAGE-TEXT (1)         17220059
172300         PERFORM DP013-0000-PROCESS-ABEND                         17230059
172400     END-IF.                                                      17240059
172500*                                                                 17250059
172600 EJECT                                                            17260059
172700*                                                                 17270059
172800******************************************************************17280059
172900*    REWRITE THE TEMPORARY STORAGE QUEUE                          17290059
173000*                                                                 17300059
173100*    PERFORMED BY D100, E300                                      17310059
173200******************************************************************17320059
173300 E200-WRITE-QUEUE.                                                17330059
173400*                                                                 17340059
173500     EXEC CICS                                                    17350059
173600         WRITEQ TS                                                17360059
173700         REWRITE                                                  17370059
173800         QUEUE(RV100-TSQB-QUEUE-NAME)                             17380059
173900         FROM(RV001-SAVE-TS-QUEUE)                                17390059
174000         LENGTH(RV100-TSQB-QUEUE-LENGTH)                          17400059
174100         ITEM(RV001-RL-ITEM)                                      17410059
174200         RESP(PV-RESP)                                            17420059
174300     END-EXEC.                                                    17430059
174400*                                                                 17440059
174500     IF  PV-RESP NOT EQUAL DFHRESP(NORMAL)                        17450059
174600         MOVE PV-RESP          TO  PM-RESP-22                     17460059
174700         SET DP013-LOGIC-ABEND TO  TRUE                           17470059
174800         SET DP013-NO-ROLLBACK TO  TRUE                           17480059
174900         MOVE 'E200-WRITE-QUEUE'                                  17490059
175000                               TO  DP013-PARAGRAPH                17500059
175100         MOVE PM-PROGRAM-MESSAGE-22                               17510059
175200                               TO  DP013-MESSAGE-TEXT (1)         17520059
175300         PERFORM DP013-0000-PROCESS-ABEND                         17530059
175400     END-IF.                                                      17540059
175500*                                                                 17550059
175600 EJECT                                                            17560059
175700******************************************************************17570059
175800*    POSITION TO THE NEXT DEFECT ORDER                            17580059
175900*    IF AT END, ISSUE MESSAGE, OTHERWISE CONTINUE PROCESSING.     17590059
176000*                                                                 17600059
176100*    PERFORMED BY B300                                            17610059
176200******************************************************************17620059
176300*                                                                 17630059
176400 D300-GET-NEXT-DFCTOR.                                            17640059
176500*                                                                 17650059
176600     ADD 1                     TO  RV001-RL-SUB.                  17660059
176700     IF  RV001-RL-SUB GREATER THAN RV101-RA-MAX-ITEMS             17670059
176800         PERFORM E200-WRITE-QUEUE                                 17680059
176900         ADD 1                 TO  RV001-RL-ITEM                  17690059
177000         MOVE 1                TO  RV001-RL-SUB                   17700059
177100         PERFORM F100-READ-LIST-QUEUE                             17710059
177200         MOVE  RV101-RA-REQUEST-RECORD                            17720059
177300                               TO  RV001-SAVE-TS-QUEUE            17730059
177400     ELSE                                                         17740059
177500         MOVE RV001-SAVE-TS-QUEUE                                 17750059
177600                               TO  RV101-RA-REQUEST-RECORD        17760059
177700     END-IF.                                                      17770059
177800*                                                                 17780059
177900     IF  RV101-RA-NUMBER(RV001-RL-SUB) GREATER THAN ZEROES        17790059
178000         MOVE SPACES           TO  DCLTDFCTOR                     17800059
178100         MOVE RV101-RA-NUMBER(RV001-RL-SUB)                       17810059
178200                               TO  DFCTOR-DFCT-ORD-ID             17820059
178300         SET RV101-INQ(RV001-RL-SUB) TO TRUE                      17830059
178400         PERFORM E100-RETRIEVE-DATA-FOR-PANEL                     17840059
178500     ELSE                                                         17850059
178600         SUBTRACT 1          FROM  RV001-RL-SUB                   17860059
178700         MOVE PC-TSYMSG-00070  TO  DP020-MSG-NUMBER               17870059
178800         SET DP020-MSG-INFORMATIONAL                              17880059
178900                               TO  TRUE                           17890059
179000     END-IF.                                                      17900059
179100*                                                                 17910059
179200 EJECT                                                            17920059
179300*                                                                 17930059
179400******************************************************************17940059
179500 E300-RESET-INITIAL-INTER-APPL.                                   17950059
179600******************************************************************17960059
179700                                                                  17970059
179800         MOVE RV001-SAVE-INTER-APPL-COMM                          17980059
179900                              TO  RV100-INTER-APPL-COMMAREA.      17990059
180000         IF RV001-LIST                                            18000059
180100            IF DP020-NEXT-ACT-APPL-ERROR                          18010059
180200              MOVE RV001-SAVE-TS-QUEUE     TO                     18020059
180300                       RV101-RA-REQUEST-RECORD                    18030059
180400              SET RV101-ERR(RV001-RL-SUB) TO TRUE                 18040059
180500              MOVE RV101-RA-REQUEST-RECORD TO                     18050059
180600                       RV001-SAVE-TS-QUEUE                        18060059
180700                                                                  18070059
180800              PERFORM  E200-WRITE-QUEUE                           18080059
180900            END-IF                                                18090059
181000         END-IF.                                                  18100059
181100                                                                  18110059
181200 EJECT                                                            18120059
181300******************************************************************18130059
181400*  PRINT THE LISTING REPORT FOR RETURN TO VENDOR LISTINGS        *18140059
181500******************************************************************18150059
181600 E400-PRINT-RTV-LISTING.                                          18160059
181700                                                                  18170059
181800     MOVE RV100-INTER-APPL-COMMAREA TO  RV001-SAVE-INTER-APPL-COMM18180059
181900                                                                  18190059
182000     MOVE RV100-UK-RA-NUMBER        TO  RV102-DEFECT-ORDER-NBR.   18200059
182100     MOVE RV001-PRINTER             TO  RV102-PRINTER-DEST.       18210059
182200     MOVE RV001-BUYER               TO  RV102-BUYER-NAME.         18220059
182300     MOVE PC-CURRENT-PROGRAM-NAME   TO  RV102-PROGRAM-NAME.       18230059
182400     MOVE RV001-OPER-UNT-ID         TO  RV102-OPER-UNT-ID.        18240059
182500     MOVE 1                         TO  RV102-DFCTOR-ITEM-STATUS. 18250059
182600                                                                  18260059
182700     MOVE PC-PRT-RTV-TRANID         TO  PV-PRT-LIST-TRANID.       18270059
182800                                                                  18280059
182900     PERFORM E500-START-TRAN.                                     18290059
183000                                                                  18300059
183100 EJECT                                                            18310059
183200******************************************************************18320059
183300*  START THE PRINT TRANSACTION.                                  *18330059
183400*                                                                *18340059
183500*  PERFORMED  BY C100-CHECK-LOCAL-FKEYS.                         *18350059
183600******************************************************************18360059
183700 E500-START-TRAN.                                                 18370059
183800     MOVE   LENGTH OF RV102-SPECIFIC-COMMAREA                     18380059
183900                                 TO  PV-COMMAREA-LENGTH.          18390059
184000     EXEC CICS                                                    18400059
184100         START                                                    18410059
184200             TRANSID  (PV-PRT-LIST-TRANID)                        18420059
184300             FROM     (RV102-SPECIFIC-COMMAREA)                   18430059
184400             LENGTH   (PV-COMMAREA-LENGTH)                        18440059
184500             RESP     (PV-CICS-RESPONSE)                          18450059
184600     END-EXEC.                                                    18460059
184700                                                                  18470059
184800     IF  PV-CICS-RESPONSE = DFHRESP (NORMAL)                      18480059
184900         CONTINUE                                                 18490059
185000     ELSE                                                         18500059
185100         SET DP013-CICS-ABEND  TO TRUE                            18510059
185200         MOVE 'UNABLE TO START TRANSACTION'                       18520059
185300                        TO DP013-MESSAGE-TEXT (1)                 18530059
185400         MOVE PV-PRT-LIST-TRANID                                  18540059
185500                        TO DP013-MESSAGE-TEXT (2)                 18550059
185600         PERFORM DP013-0000-PROCESS-ABEND                         18560059
185700     END-IF.                                                      18570059
185800                                                                  18580059
185900     MOVE 'PRINT STARTED'      TO  DP020-MSG-MESSAGE.             18590059
186000     SET  DP020-MSG-INFORMATIONAL  TO TRUE.                       18600059
186100                                                                  18610059
186200 EJECT                                                            18620059
186300******************************************************************18630059
186400*  VALIDATE THE SCREEN FIELDS.                                   *18640059
186500*  PERFORMED  BY  A100-CONTROL-PROCESSING.                       *18650059
186600*  PERFORMED  BY  C100-CHECK-LOCAL-FKEYS.                        *18660059
186700******************************************************************18670059
186800 B500-EDIT-DATA-IN-COMMAREA.                                      18680059
186900                                                                  18690059
187000     SET PS-NO-ERROR TO TRUE.                                     18700059
187100     SET CONTINUE-PROCESSING  TO TRUE.                            18710059
187200                                                                  18720059
187300     EXEC CICS BIF DEEDIT                                         18730059
187400                   FIELD (RV001-VEND-ZIP-CODE)                    18740059
187500                   LENGTH(5)                                      18750059
187600     END-EXEC.                                                    18760059
187700                                                                  18770059
187800     IF  RV001-VEND-ZIP-CODE NOT NUMERIC                          18780059
187900         MOVE -1                 TO  ARZIPCDL                     18790059
188000         MOVE DP015-RED          TO  ARZIPCDC                     18800059
188100         MOVE DP015-REVERSE      TO  ARZIPCDH                     18810059
188200         MOVE PC-TSYMSG-00008    TO  DP020-MSG-NUMBER             18820059
188300         SET DP020-MSG-FATAL     TO  TRUE                         18830059
188400         SET STOP-PROCESSING     TO  TRUE                         18840059
188500     ELSE                                                         18850059
188600         IF  RV001-VEND-ZIP-CODE NOT GREATER THAN ZERO AND        18860059
188700             RV001-VENDOR-INFO-ENTERED                            18870059
188800             MOVE -1             TO  ARZIPCDL                     18880059
188900             MOVE DP015-RED      TO  ARZIPCDC                     18890059
189000             MOVE DP015-REVERSE  TO  ARZIPCDH                     18900059
189100             MOVE PC-TSYMSG-00007                                 18910059
189200                                 TO  DP020-MSG-NUMBER             18920059
189300             SET DP020-MSG-FATAL TO  TRUE                         18930059
189400             SET STOP-PROCESSING TO  TRUE                         18940059
189500         ELSE                                                     18950059
189600             MOVE DP015-GREEN    TO  ARZIPCDC                     18960059
189700             MOVE DP015-UNDERLINE                                 18970059
189800                                 TO  ARZIPCDH                     18980059
189900         END-IF                                                   18990059
190000     END-IF.                                                      19000059
190100                                                                  19010059
190200     EXEC CICS BIF DEEDIT                                         19020059
190300                   FIELD (RV001-VEND-ZIP-SFX)                     19030059
190400                   LENGTH(4)                                      19040059
190500     END-EXEC.                                                    19050059
190600                                                                  19060059
190700     IF  RV001-VEND-ZIP-SFX NOT NUMERIC                           19070059
190800         MOVE -1                 TO  ARZIPSFL                     19080059
190900         MOVE DP015-RED          TO  ARZIPSFC                     19090059
191000         MOVE DP015-REVERSE      TO  ARZIPSFH                     19100059
191100         MOVE PC-TSYMSG-00008    TO  DP020-MSG-NUMBER             19110059
191200         SET DP020-MSG-FATAL     TO  TRUE                         19120059
191300         SET STOP-PROCESSING     TO  TRUE                         19130059
191400     ELSE                                                         19140059
191500         MOVE DP015-GREEN        TO  ARZIPSFC                     19150059
191600         MOVE DP015-UNDERLINE    TO  ARZIPSFH                     19160059
191700     END-IF.                                                      19170059
191800                                                                  19180059
191900     MOVE DP015-GREEN             TO    ARVADDRC.                 19190059
192000     MOVE DP015-UNDERLINE         TO    ARVADDRH.                 19200059
192100                                                                  19210059
192200     IF  RV001-VEND-CITY NOT GREATER THAN SPACES AND              19220059
192300         RV001-VENDOR-INFO-ENTERED                                19230059
192400         MOVE -1                 TO  ARVCITYL                     19240059
192500         MOVE DP015-RED          TO  ARVCITYC                     19250059
192600         MOVE DP015-REVERSE      TO  ARVCITYH                     19260059
192700         MOVE PC-TSYMSG-00007    TO  DP020-MSG-NUMBER             19270059
192800         SET DP020-MSG-FATAL     TO  TRUE                         19280059
192900         SET STOP-PROCESSING     TO  TRUE                         19290059
193000     ELSE                                                         19300059
193100         MOVE DP015-GREEN        TO    ARVCITYC                   19310059
193200         MOVE DP015-UNDERLINE    TO    ARVCITYH                   19320059
193300     END-IF.                                                      19330059
193400                                                                  19340059
193500     EXEC CICS BIF DEEDIT                                         19350059
193600                   FIELD (RV001-PHN-AREA-CODE)                    19360059
193700                   LENGTH(3)                                      19370059
193800     END-EXEC.                                                    19380059
193900                                                                  19390059
194000     IF  RV001-PHN-AREA-CODE NOT NUMERIC                          19400059
194100         MOVE -1                 TO  ARPHACDL                     19410059
194200         MOVE DP015-RED          TO  ARPHACDC                     19420059
194300         MOVE DP015-REVERSE      TO  ARPHACDH                     19430059
194400         MOVE PC-TSYMSG-00008    TO  DP020-MSG-NUMBER             19440059
194500         SET DP020-MSG-FATAL     TO  TRUE                         19450059
194600         SET STOP-PROCESSING     TO  TRUE                         19460059
194700     ELSE                                                         19470059
194800         MOVE DP015-GREEN        TO  ARPHACDC                     19480059
194900         MOVE DP015-UNDERLINE    TO  ARPHACDH                     19490059
195000     END-IF.                                                      19500059
195100                                                                  19510059
195200     EXEC CICS BIF DEEDIT                                         19520059
195300                   FIELD (RV001-PHN-EXCH-CODE)                    19530059
195400                   LENGTH(3)                                      19540059
195500     END-EXEC.                                                    19550059
195600                                                                  19560059
195700     IF  RV001-PHN-EXCH-CODE NOT NUMERIC                          19570059
195800         MOVE -1                 TO  ARPHECDL                     19580059
195900         MOVE DP015-RED          TO  ARPHECDC                     19590059
196000         MOVE DP015-REVERSE      TO  ARPHECDH                     19600059
196100         MOVE PC-TSYMSG-00008    TO  DP020-MSG-NUMBER             19610059
196200         SET DP020-MSG-FATAL     TO  TRUE                         19620059
196300         SET STOP-PROCESSING     TO  TRUE                         19630059
196400     ELSE                                                         19640059
196500         MOVE DP015-GREEN        TO  ARPHECDC                     19650059
196600         MOVE DP015-UNDERLINE    TO  ARPHECDH                     19660059
196700     END-IF.                                                      19670059
196800                                                                  19680059
196900     EXEC CICS BIF DEEDIT                                         19690059
197000                   FIELD (RV001-PHN-NBR)                          19700059
197100                   LENGTH(4)                                      19710059
197200     END-EXEC.                                                    19720059
197300                                                                  19730059
197400     IF  RV001-PHN-NBR NOT NUMERIC                                19740059
197500         MOVE -1                 TO  ARPHNBRL                     19750059
197600         MOVE DP015-RED          TO  ARPHNBRC                     19760059
197700         MOVE DP015-REVERSE      TO  ARPHNBRH                     19770059
197800         MOVE PC-TSYMSG-00008    TO  DP020-MSG-NUMBER             19780059
197900         SET DP020-MSG-FATAL     TO  TRUE                         19790059
198000         SET STOP-PROCESSING     TO  TRUE                         19800059
198100     ELSE                                                         19810059
198200         MOVE DP015-GREEN        TO  ARPHNBRC                     19820059
198300         MOVE DP015-UNDERLINE    TO  ARPHNBRH                     19830059
198400     END-IF.                                                      19840059
198500                                                                  19850059
198600     EXEC CICS BIF DEEDIT                                         19860059
198700                   FIELD (RV001-FAX-AREA-CODE)                    19870059
198800                   LENGTH(3)                                      19880059
198900     END-EXEC.                                                    19890059
199000                                                                  19900059
199100     IF  RV001-FAX-AREA-CODE NOT NUMERIC                          19910059
199200         MOVE -1                 TO  ARFXACDL                     19920059
199300         MOVE DP015-RED          TO  ARFXACDC                     19930059
199400         MOVE DP015-REVERSE      TO  ARFXACDH                     19940059
199500         MOVE PC-TSYMSG-00008    TO  DP020-MSG-NUMBER             19950059
199600         SET DP020-MSG-FATAL     TO  TRUE                         19960059
199700         SET STOP-PROCESSING     TO  TRUE                         19970059
199800     ELSE                                                         19980059
199900         MOVE DP015-GREEN        TO  ARFXACDC                     19990059
200000         MOVE DP015-UNDERLINE    TO  ARFXACDH                     20000059
200100     END-IF.                                                      20010059
200200                                                                  20020059
200300     EXEC CICS BIF DEEDIT                                         20030059
200400                   FIELD (RV001-FAX-EXCH-CODE)                    20040059
200500                   LENGTH(3)                                      20050059
200600     END-EXEC.                                                    20060059
200700                                                                  20070059
200800     IF  RV001-FAX-EXCH-CODE NOT NUMERIC                          20080059
200900         MOVE -1                 TO  ARFXECDL                     20090059
201000         MOVE DP015-RED          TO  ARFXECDC                     20100059
201100         MOVE DP015-REVERSE      TO  ARFXECDH                     20110059
201200         MOVE PC-TSYMSG-00008    TO  DP020-MSG-NUMBER             20120059
201300         SET DP020-MSG-FATAL     TO  TRUE                         20130059
201400         SET STOP-PROCESSING     TO  TRUE                         20140059
201500     ELSE                                                         20150059
201600         MOVE DP015-GREEN        TO  ARFXECDC                     20160059
201700         MOVE DP015-UNDERLINE    TO  ARFXECDH                     20170059
201800     END-IF.                                                      20180059
201900                                                                  20190059
202000     EXEC CICS BIF DEEDIT                                         20200059
202100                   FIELD (RV001-FAX-NBR)                          20210059
202200                   LENGTH(4)                                      20220059
202300     END-EXEC.                                                    20230059
202400                                                                  20240059
202500     IF  RV001-FAX-NBR NOT NUMERIC                                20250059
202600         MOVE -1                 TO  ARFXNBRL                     20260059
202700         MOVE DP015-RED          TO  ARFXNBRC                     20270059
202800         MOVE DP015-REVERSE      TO  ARFXNBRH                     20280059
202900         MOVE PC-TSYMSG-00008    TO  DP020-MSG-NUMBER             20290059
203000         SET DP020-MSG-FATAL     TO  TRUE                         20300059
203100         SET STOP-PROCESSING     TO  TRUE                         20310059
203200     ELSE                                                         20320059
203300         MOVE DP015-GREEN        TO  ARFXNBRC                     20330059
203400         MOVE DP015-UNDERLINE    TO  ARFXNBRH                     20340059
203500     END-IF.                                                      20350059
203600                                                                  20360059
203700     IF  RV001-PRINTER         GREATER  THAN SPACES               20370059
203800         PERFORM B510-VALIDATE-PRINTER                            20380059
203900         IF  DP072-PRTR-PRTR-TRK-STAT-CDE = 'A'                   20390059
204000             CONTINUE                                             20400059
204100         ELSE                                                     20410059
204200             SET PS-ERROR                                         20420059
204300                 STOP-PROCESSING                                  20430059
204400                 DP020-MSG-FATAL      TO TRUE                     20440059
204500             MOVE PC-TSYMSG-00746     TO DP020-MSG-NUMBER         20450059
204600             MOVE DP015-UNP-ALP-BRT-OFF                           20460059
204700                                      TO ARPRNTRA                 20470059
204800             MOVE DP015-RED           TO ARPRNTRC                 20480059
204900             MOVE DP015-REVERSE       TO ARPRNTRH                 20490059
205000             MOVE -1                  TO ARPRNTRL                 20500059
205100         END-IF                                                   20510059
205200     ELSE                                                         20520059
205300         IF DP020-SRC-AID = DP016-PF24 AND                        20530059
205400             RV001-PRINTER = SPACES                               20540059
205500             MOVE PC-TSYMSG-00007     TO DP020-MSG-NUMBER         20550059
205600             MOVE DP015-RED       TO    ARPRNTRC                  20560059
205700             MOVE DP015-REVERSE   TO    ARPRNTRH                  20570059
205800             MOVE -1              TO    ARPRNTRL                  20580059
205900                                                                  20590059
206000             SET DP020-MSG-FATAL  TO   TRUE                       20600059
206100             SET STOP-PROCESSING  TO   TRUE                       20610059
206200         END-IF                                                   20620059
206300     END-IF.                                                      20630059
206400                                                                  20640059
206500                                                                  20650059
206600     IF   RV001-VEND-STATE   GREATER THAN  SPACES                 20660059
206700     PERFORM                                                      20670059
206800         WITH TEST AFTER                                          20680059
206900         VARYING PV-SQL-SUB                                       20690059
207000         FROM 1 BY 1                                              20700059
207100         UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES             20710059
207200            OR SQLCODE = 0                                        20720059
207300            OR SQLCODE = +100                                     20730059
207400*                                                                 20740059
207500         EXEC SQL                                                 20750059
207600            SELECT                                                20760059
207700                 STATE_CODE                                       20770059
207800            INTO                                                  20780059
207900                 :TSTATE-STATE-CODE                               20790059
208000            FROM TSTATE                                           20800059
208100            WHERE STATE_CODE   =  :RV001-VEND-STATE               20810059
208200         END-EXEC                                                 20820059
208300*                                                                 20830059
208400         EVALUATE TRUE                                            20840059
208500             WHEN SQLCODE = -904                                  20850059
208600             WHEN SQLCODE = -913                                  20860059
208700             WHEN SQLCODE = ZERO                                  20870059
208800             WHEN SQLCODE = +100                                  20880059
208900                  CONTINUE                                        20890059
209000             WHEN SQLWARN0 NOT EQUAL SPACE                        20900059
209100             WHEN SQLCODE NOT EQUAL ZERO                          20910059
209200                  MOVE 'B500-EDIT-DATA-IN-COMM'                   20920059
209300                               TO  DP013-PARAGRAPH                20930059
209400                  MOVE 'READ TSTATE'                              20940059
209500                               TO  DP013-MESSAGE-TEXT (1)         20950059
209600                  MOVE SQLCA   TO  DP013-SQLCA                    20960059
209700                  SET DP013-DB2-ABEND                             20970059
209800                               TO  TRUE                           20980059
209900                  PERFORM DP013-0000-PROCESS-ABEND                20990059
210000         END-EVALUATE                                             21000059
210100     END-PERFORM                                                  21010059
210200*                                                                 21020059
210300       IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                 21030059
210400         MOVE 'B500-EDIT-DATA-IN-COMM'                            21040059
210500                               TO  DP013-PARAGRAPH                21050059
210600         MOVE 'MAX RETRIES EXCEEDED FOR TSTATE'                   21060059
210700                               TO  DP013-MESSAGE-TEXT (1)         21070059
210800         MOVE SQLCA            TO  DP013-SQLCA                    21080059
210900         SET DP013-DB2-ABEND   TO  TRUE                           21090059
211000         PERFORM DP013-0000-PROCESS-ABEND                         21100059
211100       END-IF                                                     21110059
211200                                                                  21120059
211300       IF SQLCODE EQUAL ZERO                                      21130059
211400         MOVE DP015-GREEN         TO    ARSTATEC                  21140059
211500         MOVE DP015-UNDERLINE     TO    ARSTATEH                  21150059
211600       ELSE                                                       21160059
211700         MOVE PC-TSYMSG-00005                                     21170059
211800                                  TO   DP020-MSG-NUMBER           21180059
211900         MOVE DP015-RED           TO    ARSTATEC                  21190059
212000         MOVE DP015-REVERSE       TO    ARSTATEH                  21200059
212100         MOVE -1                  TO    ARSTATEL                  21210059
212200                                                                  21220059
212300         SET DP020-MSG-FATAL      TO   TRUE                       21230059
212400         SET STOP-PROCESSING      TO   TRUE                       21240059
212500       END-IF                                                     21250059
212600     ELSE                                                         21260059
212700         IF  RV001-VENDOR-INFO-ENTERED                            21270059
212800             MOVE PC-TSYMSG-00007                                 21280059
212900                                      TO   DP020-MSG-NUMBER       21290059
213000             MOVE DP015-RED           TO   ARSTATEC               21300059
213100             MOVE DP015-REVERSE       TO   ARSTATEH               21310059
213200             MOVE -1                  TO   ARSTATEL               21320059
213300             SET DP020-MSG-FATAL      TO   TRUE                   21330059
213400             SET STOP-PROCESSING      TO   TRUE                   21340059
213500         ELSE                                                     21350059
213600             MOVE DP015-GREEN         TO   ARSTATEC               21360059
213700             MOVE DP015-UNDERLINE     TO   ARSTATEH               21370059
213800         END-IF                                                   21380059
213900     END-IF.                                                      21390059
214000                                                                  21400059
214100* EDIT CHECKS FOR CHANGE OF LOCATION:                             21410059
214200*  -- CHECK TO MAKE SURE THE USER HAS THE AUTHORITY TO CHANGE IT  21420059
214300*  -- CHECK THE STATUS OF THE LISTING:  IF SHIPPED OR APPROVED, NO21430059
214400*     CHANGE CAN BE MADE                                          21440059
214500*  -- CHECK THE NEW LOCATION: IF IT IS A STORAGE LOCATION, ONLY   21450059
214600*     CLOSED OR PENDING LISTINGS CAN MOVE THERE, IF IT IS AN OPEN 21460059
214700*     LISTING LOCATION, ONLY OPEN LISTINGS CAN GO THERE.          21470059
214800*                                                                 21480059
214900     IF RV001-LOCATION-OLD = RV001-LOCATION                       21490059
215000         MOVE DP015-GREEN             TO   ARLOCTNC               21500059
215100         MOVE DP015-UNDERLINE         TO   ARLOCTNH               21510059
215200         MOVE RV001-LOCATION          TO   ARLOCTNI               21520059
215300     ELSE                                                         21530059
215400         IF RV001-SHIPPED-LISTING                                 21540059
215500         OR RV001-APPROVED-LISTING                                21550059
215600             MOVE PC-TSYMSG-01114     TO   DP020-MSG-NUMBER       21560059
215700             MOVE DP015-RED           TO   ARLOCTNC               21570059
215800             MOVE DP015-REVERSE       TO   ARLOCTNH               21580059
215900             MOVE -1                  TO   ARLOCTNL               21590059
216000             SET DP020-MSG-FATAL      TO   TRUE                   21600059
216100             SET STOP-PROCESSING      TO   TRUE                   21610059
216200         ELSE                                                     21620059
216300             IF USER-HAS-UPDATE-AUTH                              21630059
216400               PERFORM F400-CHECK-LOCATION                        21640059
216500               EVALUATE TRUE                                      21650059
216600                 WHEN PS-STORAGE-LOCATION                         21660059
216700                     IF RV001-CLOSED-LISTING                      21670059
216800                     OR RV001-PENDING-LISTING                     21680059
216900                         CONTINUE                                 21690059
217000                     ELSE                                         21700059
217100                         MOVE PC-TSYMSG-01115 TO DP020-MSG-NUMBER 21710059
217200                         MOVE DP015-RED       TO ARLOCTNC         21720059
217300                         MOVE DP015-REVERSE   TO ARLOCTNH         21730059
217400                         MOVE -1              TO ARLOCTNL         21740059
217500                         SET DP020-MSG-FATAL  TO TRUE             21750059
217600                         SET STOP-PROCESSING  TO TRUE             21760059
217700                     END-IF                                       21770059
217800                                                                  21780059
217900                 WHEN PS-USED-LISTING-LOCATION                    21790059
218000                     MOVE PC-TSYMSG-01116     TO DP020-MSG-NUMBER 21800059
218100                     MOVE PV-LOC-LISTING-NBR  TO DP020-MSG-TEXT   21810059
218200                     MOVE DP015-RED           TO ARLOCTNC         21820059
218300                     MOVE DP015-REVERSE       TO ARLOCTNH         21830059
218400                     MOVE -1                  TO ARLOCTNL         21840059
218500                     SET DP020-MSG-FATAL      TO TRUE             21850059
218600                     SET STOP-PROCESSING      TO TRUE             21860059
218700                                                                  21870059
218800                 WHEN OTHER                                       21880059
218900                     CONTINUE                                     21890059
219000               END-EVALUATE                                       21900059
219100             ELSE                                                 21910059
219200                 MOVE PC-TSYMSG-01117 TO DP020-MSG-NUMBER         21920059
219300                 MOVE DP015-RED       TO ARLOCTNC                 21930059
219400                 MOVE DP015-REVERSE   TO ARLOCTNH                 21940059
219500                 MOVE -1              TO ARLOCTNL                 21950059
219600                 SET DP020-MSG-FATAL  TO TRUE                     21960059
219700                 SET STOP-PROCESSING  TO TRUE                     21970059
219800             END-IF                                               21980059
219900         END-IF                                                   21990059
220000     END-IF.                                                      22000059
220100                                                                  22010059
220200 EJECT                                                            22020059
220300*----------------------------------------------------------------*22030059
220400*   B510-VALIDATE-PRINTER                                        *22040059
220500* CALLS DPKCS060 TO VALIDATE THE PRINTER ID                      *22050059
220600*----------------------------------------------------------------*22060059
220700 B510-VALIDATE-PRINTER.                                           22070059
220800                                                                  22080059
220900     MOVE DP020-LOCATION-NBR         TO DP072-ORIGIN-OPER-UNT-ID. 22090059
221000     MOVE DP020-LOCATION-NBR         TO DP072-OPER-UNT-ID.        22100059
221100     MOVE 1                          TO DP072-ORIGIN-FCLTY-ID     22110059
221200                                        DP072-FCLTY-ID.           22120059
221300     MOVE RV001-PRINTER              TO DP072-PRINTER-ID          22130059
221400     MOVE PC-RTV-REPORT-PGM          TO DP072-RPT-PGM-NME         22140059
221500     MOVE PC-01                      TO DP072-RPT-PGM-TYP-ID.     22150059
221600     SET DP072-VALIDATE              TO TRUE.                     22160059
221700                                                                  22170059
221800     EXEC CICS                                                    22180059
221900          LINK PROGRAM  (PC-PRTR-VALIDATION-PGM)                  22190059
222000               COMMAREA (DP072-COMM-AREA)                         22200059
222100               RESP     (PV-CICS-RESPONSE)                        22210059
222200     END-EXEC                                                     22220059
222300                                                                  22230059
222400     EVALUATE TRUE                                                22240059
222500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 22250059
222600             MOVE DP015-GREEN            TO ARPRNTRC              22260059
222700             MOVE DP015-UNDERLINE        TO ARPRNTRH              22270059
222800         WHEN OTHER                                               22280059
222900             SET PS-ERROR                                         22290059
223000                 STOP-PROCESSING                                  22300059
223100                 DP020-MSG-FATAL         TO TRUE                  22310059
223200             MOVE PC-TSYMSG-00746        TO DP020-MSG-NUMBER      22320059
223300             MOVE DP015-UNP-ALP-BRT-OFF  TO ARPRNTRA              22330059
223400             MOVE DP015-RED              TO ARPRNTRC              22340059
223500             MOVE DP015-REVERSE          TO ARPRNTRH              22350059
223600             MOVE -1                     TO ARPRNTRL              22360059
223700     END-EVALUATE.                                                22370059
223800                                                                  22380059
223900                                                                  22390059
224000*                                                                 22400059
224100******************************************************************22410059
224200*    MOVE DATA FROM THE COMMAREA TO THE SCREEN.                   22420059
224300*    PERFORMED BY  A100-CONTROL-PROCESSING.                       22430059
224400*    PERFORMED BY  C100-CHECK-LOCAL-FKEYS.                        22440059
224500*    PERFORMED BY  E100-RETRIEVE-DATA-FOR-PANEL.                  22450059
224600******************************************************************22460059
224700                                                                  22470059
224800 B400-MOVE-COMMAREA-TO-SCREEN.                                    22480059
224900     PERFORM A300-RACF-ACCESS                                     22490059
225000                                                                  22500059
225100     IF USER-HAS-UPDATE-AUTH                                      22510059
225200         MOVE DP015-UNP-ALP-NOR-OFF       TO  RVKM102-LOCA        22520059
225300         MOVE DP015-GREEN                 TO  RVKM102-LOCC        22530059
225400         MOVE DP015-UNDERLINE             TO  RVKM102-LOCH        22540059
225500     ELSE                                                         22550059
225600         MOVE DP015-ASK-NOR-OFF           TO  RVKM102-LOCA        22560059
225700         MOVE DP015-BLUE                  TO  RVKM102-LOCC        22570059
225800         MOVE DP015-HL-OFF                TO  RVKM102-LOCH        22580059
225900     END-IF                                                       22590059
226000                                                                  22600059
226100     MOVE  RV001-DFCT-ORD-ID      TO PV-12-DGT-DFCT-ORD-ID.       22610061
226200     MOVE  PV-12-DGT-DFCT-ORD-ID  TO ARRANBRO.                    22620061
226300     MOVE  RV001-ORDER-TYPE       TO ATYPEO.                      22630059
226400     MOVE  RV001-ORDER-STATUS     TO ASTATUSO.                    22640059
226500     MOVE  RV001-LOCATION         TO ARLOCTNO                     22650059
226600     MOVE  RV001-STATUS-DATE      TO ASTDATEO                     22660059
226700     MOVE  RV001-BUYER            TO ARBUYERO.                    22670059
226800     MOVE  RV001-DUNS-NBR         TO ARIVNRNO.                    22680059
226900     MOVE  RV001-VEND-NAME        TO ARIVNRDO.                    22690059
227000     MOVE  RV001-VEND-ATTN-NAME   TO ARANAMEO.                    22700059
227100     MOVE  RV001-TOTAL-QTY        TO ARTOTQTO.                    22710059
227200     MOVE  RV001-TOTAL-RETAIL     TO ARTOTRTO.                    22720059
227300     MOVE  RV001-TOTAL-COST       TO ARTOTCTO.                    22730059
227400     MOVE  RV001-VEND-ADDR        TO ARVADDRO.                    22740059
227500     MOVE  RV001-VEND-CITY        TO ARVCITYO.                    22750059
227600     MOVE  RV001-VEND-STATE       TO ARSTATEO                     22760059
227700     MOVE  RV001-VEND-ZIP-CODE    TO ARZIPCDO.                    22770059
227800     MOVE  RV001-VEND-ZIP-SFX     TO ARZIPSFO.                    22780059
227900     MOVE  RV001-PHN-AREA-CODE    TO ARPHACDO.                    22790059
228000     MOVE  RV001-PHN-EXCH-CODE    TO ARPHECDO.                    22800059
228100     MOVE  RV001-PHN-NBR          TO ARPHNBRO.                    22810059
228200     MOVE  RV001-FAX-AREA-CODE    TO ARFXACDO.                    22820059
228300     MOVE  RV001-FAX-EXCH-CODE    TO ARFXECDO.                    22830059
228400     MOVE  RV001-FAX-NBR          TO ARFXNBRO.                    22840059
228500     MOVE  RV001-PRINTER          TO ARPRNTRO.                    22850059
228600                                                                  22860059
228700 EJECT                                                            22870059
228800******************************************************************22880059
228900*    FILL IN SCREEN HEADER MODULE                                 22890059
229000******************************************************************22900059
229100                                                                  22910059
229200     COPY DPPD022.                                                22920059
229300 EJECT                                                            22930059
229400******************************************************************22940059
229500*    RETURN TO CICS MODULE                                        22950059
229600******************************************************************22960059
229700                                                                  22970059
229800     COPY DPPD003.                                                22980059
229900 EJECT                                                            22990059
230000******************************************************************23000059
230100*    FORMAT MESSAGE LINES MODULE                                  23010059
230200******************************************************************23020059
230300                                                                  23030059
230400     COPY DPPD005.                                                23040059
230500 EJECT                                                            23050059
230600******************************************************************23060059
230700*    GET PANEL MODULE                                             23070059
230800******************************************************************23080059
230900                                                                  23090059
231000     COPY DPPD007.                                                23100059
231100 EJECT                                                            23110059
231200******************************************************************23120059
231300*    WRITE PANEL MODULE                                           23130059
231400******************************************************************23140059
231500                                                                  23150059
231600     COPY DPPD008.                                                23160059
231700 EJECT                                                            23170059
231800******************************************************************23180059
231900*    TOGGLE THE FUNCTION KEY LINE MODULE                          23190059
232000******************************************************************23200059
232100                                                                  23210059
232200     COPY DPPD009.                                                23220059
232300 EJECT                                                            23230059
232400******************************************************************23240059
232500*    ABEND PROCESSOR MODULE                                       23250059
232600******************************************************************23260059
232700                                                                  23270059
232800     COPY DPPD013.                                                23280059
232900 EJECT                                                            23290059
233000******************************************************************23300059
233100*    CHECK COMMUNICATION AREA MODULE                              23310059
233200******************************************************************23320059
233300                                                                  23330059
233400     COPY DPPD015.                                                23340059
233500 EJECT                                                            23350059
233600******************************************************************23360059
233700*    UPDATE TIME AND DATE MODULE                                  23370059
233800******************************************************************23380059
233900                                                                  23390059
234000     COPY DPPD017.                                                23400059
