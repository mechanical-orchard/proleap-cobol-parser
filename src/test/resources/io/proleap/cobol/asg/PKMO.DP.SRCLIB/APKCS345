000100*-----------------------*                                         00010021
000200 IDENTIFICATION DIVISION.                                         00020021
000300*-----------------------*                                         00030021
000400 PROGRAM-ID.    APKCS345.                                         00040021
000500 AUTHOR.        MIKE BESKE.                                       00050021
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060021
000700 DATE-WRITTEN.  08-97.                                            00070021
000800 DATE-COMPILED.                                                   00080021
000900                                                                  00090021
001000*---------------------------------------------------------------* 00100021
001100*    THIS IS A COPY OF APKCS327 USED TO LIMIT THE SECURITY.     * 00110021
001200*    IT HAS BEEN RENAMED TO APKCS345.                           * 00120021
001300*---------------------------------------------------------------* 00130021
001400*    TRANID      - A345                                         * 00140021
001500*    TYPE        - CICS ARCHITECTURE MAINTENANCE - DB2          * 00150021
001600*    DESCRIPTION - INVOICE ITEM INQUIRY LIST                    * 00160021
001700*    MAPSET      - APKM345                                      * 00170021
001800*                                                               * 00180021
001900*    THIS PROGRAM GENERATES A LIST OF OF ITEMS ASSOCIATED WITH  * 00190021
002000*    AN INVOICE.                                                * 00200021
002100*                                                               * 00210021
002200*---------------------------------------------------------------* 00220021
002400* CHANGE LOG:                                                   * 00240021
002500*                                                               * 00250021
002600* DATE CHANGED: 06/05/01                                        * 00260021
002700*  CHANGE MADE: CORRECTED THE 3200-RESET-ATTRIBUTES PARAGRAPH TO* 00270021
002800*  NOT DISTINGUISH BETWEEN THE TYPE OF INVOICE (EDI, RI, ETC.). * 00280021
002900*  THIS CODE WAS NOT MODIFIED WHEN IT WAS FIRST CLONED FROM     * 00290021
003000*  POKCS074.                                                    * 00300021
003100*  MADE BY: MIKE BESKE              WR/IR #: 21576              * 00310021
003200*                                                               * 00320021
003300* DATE CHANGED: 09/20/01                                        * 00330021
003400*  CHANGE MADE: ADDED A NEW LITERAL DESCRIPTION OF THE          * 00340021
003500*               INVOICE STATUS.  THE LITERAL 'PR' AND THE       * 00350021
003600*               DESCRIPTION IS 'PENDING RVW'.  MOD PARA 4400    * 00360021
003700*  MADE BY: MIKE BESKE              WR/IR #: 20530              * 00370021
003800*                                                               * 00380021
003900* 02/25/02  CHANGED BY: MIKE BESKE              WR# 21278       * 00390023
004000*          - REPLACED THE TSK TABLE WITH TSKXREF AS PART        * 00400023
004100*            OF RETEK PROJECT PRELIM FOR AP.  (PARA 4340-)      * 00410023
004200*                                                               * 00420023
004300*   5/22/02  ADDED LABELS TO PO_NBR IN SQL WHERE JOINS OF       * 00430027
004400*            TINVOIC AND TPAYREQ IN ORDER TO DIFFERENTIATE THE  * 00440027
004500*            TABLE THE PO_NBR IS ORIGINATING FROM.              * 00450027
004600*             BY: MIKE BESKE                     WR: 23500      * 00460025
004700*                                                               * 00470025
004800*  11/04/02  COLBY DATING PROJECT.                              * 00480035
004900*            ELIMINATED TPAYREQ.  ADDED CODE TO HANDLE THE NEW  * 00490031
005000*            'PJ' STATUS CODE IN 1150- AND TO DISPLAY 'PENDNG   * 00500030
005100*            JRNL' ON THE ONLINE SCREEN.  CHANGED PAYT-REQ-SEQ- * 00510030
005200*            NBR TO PO-NBR AND INVC-ID IN 1155-.                * 00520030
005300*             BY: MIKE BESKE                     WR: 23750      * 00530030
005400*                                                               * 00540030
005500*  04/18/03  ADDED CODE FOR THE NI-SKU PROJECT.                 * 00550038
005600*            REPLACED THE USE OF CLASS AND SKU SEQ NBR BEING    * 00560038
005700*            DISPLAYED ON THE SCREEN.  NOW EITHER THE SKU FROM  * 00570038
005800*            TSKXREF OR THE RMS-PO-SKU-NBR FROM TPURITM WILL BE * 00580038
005900*            DISPLAYED.  TSKXREF WILL BE JOINED TO TPURITM IN   * 00590038
006000*            PARA 4330-.                                        * 00600038
006100*             BY: MIKE BESKE                     WR: 22557      * 00610038
006200*                                                               * 00620038
006210*  03/11/07                                                     * 00621060
006211*     MATCH BY DC -- ADDED THE FIELDS ASC-KEY-DC-NBR AND        * 00621152
006220*     PV-MTCH-LVL-CDE TO WORKING STORAGE.  IN PARAGRAPH         * 00622052
006230*     1150-GET-INVOICE-DATA, INCLUDED THE DC_NBR AND            * 00623052
006240*     MTCH_LVL_CDE IN THE SELECT STATEMENT ALONG WITH POPULATING* 00624052
006250*     THE ASC-KEY-DC-NBR AND THE PV-MTCH-LVL-CDE.  POPULATED    * 00625058
006260*     THE FIELDS AP300-DC-NBR AND AP300-MTCH-LVL-CDE IN THE     * 00626052
006261*     PARAGRAPH 2400-PREPARE-INTER-APPL-COMM.  IN PARAGRAPH     * 00626154
006263*     8800-CHECK-IF-PROCESSED, REPLACED THE STR_NBR CONDITION IN* 00626352
006264*     THE WHERE CLAUSE WITH A.MTCH_LVL_CDE = B.MTCH_LVL_CDE.    * 00626452
006265*     CHANGED THE APKM345 MAP TO INCLUDE THE DISPLAY OF THE DC  * 00626555
006266*     NUMBER AND STORE NUMBER IN THE SCREEN HEADER.  THIS       * 00626662
006271*     REQUIRED THE FOLLOWING PROGRAM ALTERATIONS:               * 00627162
006272*     1) MOVED THE ASC-KEY-DC-NBR FIELD TO THE ADCNBRO MAP FIELD* 00627262
006273*        AND THE ASC-KEY-STORE-NUMBER FIELD TO THE ASTRNBR0 MAP * 00627362
006274*        FIELD IN PARAGRAPH 4400-MOVE-COMMAREA-TO-SCREEN.       * 00627462
006276*     2) ADDED AN EXTRA 17 CHARACTERS TO THE AP345AO FILLER     * 00627664
006277*        OUTPUT.                                                * 00627764
006278*     3) CHANGED THE COMMAREA LENGTH ON THE MNEMONIC FROM 2342  * 00627862
006279*        TO 2344.                                               * 00627962
006280*     ALSO CHANGED THE APKM345 MAP TO INCLUDE THE DISPLAY OF    * 00628062
006281*     THE STORE NUMBER.                                         * 00628162
006290*     BY: KRYSTEN LEARY                  WR: 21578              * 00629062
006291* DATE  09/01/2021                                                00629165
006292*            - CHANGE CALL OF  DPKUT100  TO                     * 00629266
006293*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 00629365
006294*              MAKING THE CALL DYNAMIC VS STATIC                * 00629465
006295*     MADE BY: GERMAN BANDA            WR/IR #: CHG0261053        00629567
006296* DATE  05/02/2022                                                00629670
006297*            - CHANGE UPC LOGIC - INSTEAD OF EXCLUDING BY THE   * 00629771
006298*              RANGE OF 400000000000 TO 409999999999, USE THE   * 00629871
006299*              EDI_ORD_IND FIELD (IF 'Y' THEN INCLUDE)          * 00629971
006300*     MADE BY: JEAN KURK               WR/IR #: CHG0268204        00630071
006301* DATE  10/24/2022                                              * 00630171
006302*     ADD COPYBOOK DPWS930                                      * 00630271
006303*     CHANGE CICS ARCHITECTURE CALL TO USE DP930-CICS-ARCH-API  * 00630371
006304*     MADE BY: BOB MCASEY              WR/IR #: CHG0276864      * 00630471
006310*---------------------------------------------------------------* 00631021
006400                                                                  00640056
006500 ENVIRONMENT DIVISION.                                            00650021
006600                                                                  00660021
006700 DATA DIVISION.                                                   00670021
006800                                                                  00680021
006900 WORKING-STORAGE SECTION.                                         00690021
007000                                                                  00700021
007100 01  DK-DB2-KEYS.                                                 00710021
007200     05  DK-PO-NUMBER                   PIC S9(9)   VALUE ZERO    00720021
007300                                        COMP.                     00730021
007400     05  DK-HIGH-PO-NUMBER              PIC S9(9)   VALUE ZERO    00740021
007500                                        COMP.                     00750021
007600     05  DK-LOW-PO-NUMBER               PIC S9(9)   VALUE ZERO    00760021
007700                                        COMP.                     00770021
007800     05  DK-INVOICE-ID                  PIC  X(22)  VALUE SPACES. 00780021
007900     05  DK-HIGH-INVOICE-ID             PIC  X(22)  VALUE SPACES. 00790021
008000     05  DK-LOW-INVOICE-ID              PIC  X(22)  VALUE SPACES. 00800021
008100     05  DK-PAYT-REQ-SEQ-NBR            PIC S9(9)   VALUE ZERO    00810021
008200                                        COMP.                     00820021
008300     05  DK-DEPT-NBR                    PIC  X(3)   VALUE SPACES. 00830021
008400     05  DK-ENT-ID                      PIC S9(9)   VALUE ZERO    00840021
008500                                        COMP.                     00850021
008600 01  PC-PROGRAM-CONSTANTS.                                        00860021
008700*    05  PC-MIN-UPC                     PIC S9(15)V               00870068
008800*                                        VALUE +000400000000000   00880068
008900*                                                  COMP-3.        00890068
009000*    05  PC-MAX-UPC                     PIC S9(15)V               00900068
009100*                                        VALUE +000409999999999   00910068
009200*                                                  COMP-3.        00920068
009300     05  PC-MULTIPLE-UPC                PIC X(15)  VALUE          00930021
009400         'MORE THAN 1 UPC'.                                       00940021
009500     05  PC-NO-VENDOR-UPC               PIC X(15)  VALUE          00950021
009600         'NO VENDOR UPC  '.                                       00960021
009700     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00970021
009800                                                    'AP345A  '.   00980021
009900     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00990021
010000                                                    'APKM345 '.   01000021
010100     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         01010021
010200                                                    'APKCS345'.   01020021
010300     05  PC-LIST-QUEUE-SEQ              PIC  X      VALUE '1'.    01030021
010400     05  PC-SEL-QUEUE-SEQ-OUT           PIC  X      VALUE '3'.    01040021
010500     05  PC-DELETE                      PIC  X(02)  VALUE 'DE'.   01050021
010600     05  PC-ENTERED                     PIC  X(02)  VALUE 'EN'.   01060021
010700     05  PC-OPEN-TO-PAY                 PIC  X(02)  VALUE 'OP'.   01070021
010800     05  PC-PAID                        PIC  X(02)  VALUE 'PD'.   01080021
010900     05  PC-RECONCILED                  PIC  X(02)  VALUE 'RC'.   01090021
011000     05  PC-RELEASED                    PIC  X(02)  VALUE 'RC'.   01100021
011100     05  PC-OUT-OF-BALANCE              PIC  X(02)  VALUE 'OB'.   01110021
011200     05  PC-ITEM-IMBALANCE              PIC  X(02)  VALUE 'IB'.   01120021
011300     05  PC-ACTIVE                      PIC  X      VALUE 'A'.    01130021
011400     05  PC-TYPE-04                     PIC  XX     VALUE '04'.   01140021
011500     05  PC-TYPE-01                     PIC  XX     VALUE '01'.   01150021
011600     05  PC-EACH                        PIC  XX     VALUE 'EA'.   01160021
011700     05  PC-EDI                         PIC  X(2)   VALUE 'ED'.   01170021
011800     05  PC-RI                          PIC  X(2)   VALUE 'RI'.   01180021
011900     05  PC-PURCH-ORDER                 PIC  X      VALUE 'P'.    01190021
012000     05  PC-INQ                         PIC  X(01)  VALUE 'I'.    01200021
012100     05  PC-UPD                         PIC  X(01)  VALUE 'U'.    01210021
012200     05  PC-DEL                         PIC  X(01)  VALUE 'D'.    01220021
012300     05  PC-ERR                         PIC  X(01)  VALUE 'E'.    01230021
012310     05  PC-Y-CODE                      PIC X(01)  VALUE 'Y'.     01231068
012400     05  PC-PO-NBR-HIGH                 PIC S9(9)   VALUE         01240021
012500          +999999999                    COMP.                     01250021
012600     05  PC-PO-NBR-LOW                 PIC S9(9)   VALUE ZERO     01260021
012700                                        COMP.                     01270021
012800     05  PC-UNAPPROVED                  PIC  X(3)   VALUE 'WKS'.  01280021
012900     05  PC-ASTERICK                    PIC  X(4)   VALUE '****'. 01290021
013000     05  PC-NO-CHARGE                   PIC  X(06)  VALUE         01300021
013100                                                   '    NC'.      01310021
013200     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +11     01320021
013300                                                    COMP SYNC.    01330021
013400     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      01340021
013500                                                    COMP SYNC.    01350021
013600     05  PC-MAX-RETRIES                 PIC S9(04)  VALUE +3      01360021
013700                                                    COMP SYNC.    01370021
013800     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         01380021
013900                                                    +1000000      01390021
014000                                                    COMP-3.       01400021
014100     05  PC-LIST-NUMBER-LENGTH          PIC S9(04)  VALUE +7      01410021
014200                                                    COMP SYNC.    01420021
014300                                                                  01430057
014400     05  PC-TSYMSG-NUMBERS.                                       01440021
014500         10  PC-TSYMSG-00004            PIC  9(05)  VALUE 00004.  01450021
014600         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01460021
014700         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01470021
014800         10  PC-TSYMSG-00009            PIC  9(05)  VALUE 00009.  01480021
014900         10  PC-TSYMSG-00045            PIC  9(05)  VALUE 00045.  01490021
015000         10  PC-TSYMSG-00047            PIC  9(05)  VALUE 00047.  01500021
015100         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01510021
015200         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01520021
015300         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01530021
015400         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01540021
015500         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01550021
015600         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01560021
015700         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01570021
015800         10  PC-TSYMSG-00059            PIC  9(05)  VALUE 00059.  01580021
015900         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01590021
016000         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01600021
016100         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01610021
016200         10  PC-TSYMSG-00115            PIC  9(05)  VALUE 00115.  01620021
016300         10  PC-TSYMSG-00170            PIC  9(05)  VALUE 00170.  01630021
016400         10  PC-TSYMSG-00240            PIC  9(05)  VALUE 00240.  01640021
016500         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01650021
016600         10  PC-TSYMSG-00308            PIC  9(05)  VALUE 00308.  01660021
016700         10  PC-TSYMSG-00330            PIC  9(05)  VALUE 00330.  01670021
016800         10  PC-TSYMSG-00393            PIC  9(05)  VALUE 00393.  01680021
016900         10  PC-TSYMSG-00455            PIC  9(05)  VALUE 00455.  01690021
017000         10  PC-TSYMSG-00468            PIC  9(05)  VALUE 00468.  01700021
017100         10  PC-TSYMSG-00470            PIC  9(05)  VALUE 00470.  01710021
017200         10  PC-TSYMSG-00471            PIC  9(05)  VALUE 00471.  01720021
017300         10  PC-TSYMSG-00472            PIC  9(05)  VALUE 00472.  01730021
017400         10  PC-TSYMSG-00536            PIC  9(05)  VALUE 00536.  01740021
017500         10  PC-TSYMSG-00849            PIC  9(05)  VALUE 00849.  01750021
017600         10  PC-TSYMSG-00850            PIC  9(05)  VALUE 00850.  01760021
017700         10  PC-TSYMSG-00851            PIC  9(05)  VALUE 00851.  01770021
017800         10  PC-TSYMSG-00852            PIC  9(05)  VALUE 00852.  01780021
017900         10  PC-TSYMSG-00853            PIC  9(05)  VALUE 00853.  01790021
018000         10  PC-TSYMSG-00854            PIC  9(05)  VALUE 00854.  01800021
018100         10  PC-TSYMSG-00855            PIC  9(05)  VALUE 00855.  01810021
018200         10  PC-TSYMSG-00872            PIC  9(05)  VALUE 00872.  01820021
018300         10  PC-TSYMSG-00935            PIC  9(05)  VALUE 00935.  01830021
018400         10  PC-TSYMSG-00942            PIC  9(05)  VALUE 00942.  01840021
018500         10  PC-TSYMSG-00961            PIC  9(05)  VALUE 00961.  01850021
018600         10  PC-TSYMSG-00970            PIC  9(05)  VALUE 00970.  01860021
018700                                                                  01870056
018800 01  PS-PROGRAM-SWITCHES.                                         01880021
018900     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01890021
019000         88  PS-NO-ERROR                            VALUE 'Y'.    01900021
019100         88  PS-ERROR-ALLOW-PAGING                  VALUE 'P'.    01910021
019200         88  PS-ERROR                               VALUE 'N'.    01920021
019300     05  PS-PROBLEM-LINE-SW             PIC  X(01)  VALUE 'N'.    01930021
019400         88  PS-ERROR-ON-LINE                       VALUE '1'.    01940021
019500         88  PS-WARNING-ON-LINE                     VALUE '2'.    01950021
019600         88  PS-NO-PROBLEM-ON-LINE                  VALUE 'N'.    01960021
019700     05  PS-LINE-ERROR-SW               PIC  X(01)  VALUE 'Y'.    01970021
019800         88  PS-LINE-ERROR                          VALUE 'Y'.    01980021
019900         88  PS-NO-LINE-ERROR                       VALUE 'N'.    01990021
020000     05  PS-GO-WARNING-SW               PIC  X(01)  VALUE 'N'.    02000021
020100         88  PS-GO-WARNING                          VALUE 'Y'.    02010021
020200         88  PS-NO-WARNING                          VALUE 'N'.    02020021
020300     05  PS-LINE-WARNING-SW             PIC  X(01)  VALUE 'Y'.    02030021
020400         88  PS-LINE-WARNING                        VALUE 'Y'.    02040021
020500         88  PS-NO-LINE-WARNING                     VALUE 'N'.    02050021
020600     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    02060021
020700         88  PS-COMMAREA-VALID                      VALUE 'Y'.    02070021
020800         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    02080021
020900     05  PS-DISPLAYED-LINE-SW           PIC  X(01)  VALUE 'N'.    02090021
021000         88  PS-NON-DISPLAYED-LINE                  VALUE 'Y'.    02100021
021100         88  PS-DISPLAYED-LINE                      VALUE 'N'.    02110021
021200     05  PS-ITEM-FOUND-SW               PIC  X(01)  VALUE 'N'.    02120021
021300         88  PS-ITEM-FOUND                          VALUE 'Y'.    02130021
021400         88  PS-ITEM-NOT-FOUND                      VALUE 'N'.    02140021
021500     05  PS-START-ITEM-ERROR-SW       PIC  X        VALUE 'Y'.    02150021
021600         88  PS-NO-START-ITEM-ERROR                 VALUE 'Y'.    02160021
021700         88  PS-START-ITEM-ERROR                    VALUE 'N'.    02170021
021800                                                                  02180021
022000 01  PV-PROGRAM-VARIABLES.                                        02200021
022100     05  PV-DB2-COUNT                   PIC S9(4) COMP VALUE ZERO.02210021
022200     05  PV-PO-NBR.                                               02220021
022300         10  PV-PO-NBR-9                PIC 9(4)    VALUE  0.     02230021
022400     05 PV-PAYT-REQ-LNE-NBR             PIC S9(4)    COMP.        02240021
022500     05  PV-UPC-NBR                     PIC 9(15).                02250021
022600     05  PV-UPC-NBR-X REDEFINES PV-UPC-NBR                        02260021
022700                                        PIC X(15).                02270021
022800     05  PV-UPC-NBR-DISPLAY             PIC X(16)   VALUE SPACES. 02280021
022900     05  PV-SKU-NBR                     PIC 9(8).                 02290036
023000     05  PV-SKU-NBR-X REDEFINES PV-SKU-NBR                        02300036
023100                                        PIC X(8).                 02310036
023200     05  PV-VENDOR-STYLE                PIC X(12)   VALUE SPACES. 02320021
023300     05  PV-COLOR-CDE                   PIC X(3)    VALUE SPACES. 02330021
023400     05  PV-SIZE-CDE                    PIC X(5)    VALUE SPACES. 02340021
023500     05  PV-INVOICE-LINE                PIC 9(4)    VALUE 0.      02350021
023600     05  PV-UNIT-COST                   PIC X(9)    VALUE SPACES. 02360021
023700     05  PV-UNIT-COST-9 REDEFINES                                 02370021
023800          PV-UNIT-COST                  PIC ZZZZZ9.99.            02380021
023900     05  PV-PIECES                      PIC X(6)    VALUE SPACES. 02390021
024000     05  PV-PIECES-9 REDEFINES                                    02400021
024100          PV-PIECES                     PIC 9(6).                 02410021
024200     05  PV-APP-PO-LNE-NBR              PIC 9(4)    VALUE 0.      02420021
024300     05  PV-PO-LNE-NBR                  PIC 9(4)    VALUE 0.      02430021
024400     05  PV-TOTAL-PIECES                PIC S9(7)   VALUE +0      02440021
024500                                                    COMP SYNC.    02450021
024600     05  PV-PER-UNIT-COST               PIC S9(10)V9(3)           02460021
024700                                                    COMP-3.       02470021
024800     05  PV-PO-NBRI                     PIC S9(04)  VALUE +0      02480021
024900                                                    COMP.         02490021
025000     05  PV-WARNING-SUB                 PIC S9(04)  VALUE +0.     02500021
025100     05  PV-SUB                         PIC S9(04)  VALUE +0      02510021
025200                                                    COMP SYNC.    02520021
025300     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      02530021
025400                                                    COMP SYNC.    02540021
025500     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      02550021
025600                                                    COMP-3.       02560021
025700     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      02570021
025800                                                    COMP-3.       02580021
025900     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      02590021
026000                                                    COMP-3.       02600021
026100     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      02610021
026200                                                    COMP-3.       02620021
026300     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      02630021
026400                                                    COMP-3.       02640021
026500     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      02650021
026600                                                    COMP-3.       02660021
026700     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      02670021
026800                                                    COMP-3.       02680021
026900     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      02690021
027000                                                    COMP SYNC.    02700021
027100     05  PV-HOLD-BLOCK-NUMBER           PIC S9(04)  VALUE +0      02710021
027200                                                    COMP SYNC.    02720021
027300     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      02730021
027400                                                    COMP SYNC.    02740021
027500     05  PV-ITEM                        PIC S9(04)  VALUE +0      02750021
027600                                                    COMP SYNC.    02760021
027700     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      02770021
027800                                                    COMP SYNC.    02780021
027900     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      02790021
028000                                                    COMP SYNC.    02800021
028100     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      02810021
028200                                                    COMP SYNC.    02820021
028300     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      02830021
028400                                                    COMP SYNC.    02840021
028500     05  PV-FIRST-ERROR-ITEM            PIC 9(09)   VALUE 0.      02850021
028600     05  PV-FIRST-WARNING-ITEM          PIC 9(09)   VALUE 0.      02860021
028700     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      02870021
028800                                                    COMP SYNC.    02880021
028900     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02890021
029000                                                    COMP SYNC.    02900021
029100     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02910021
029200                                                    COMP SYNC.    02920021
029300     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      02930021
029400                                                    COMP SYNC.    02940021
029500     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      02950021
029600                                                    COMP SYNC.    02960021
029700     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      02970021
029800                                                    COMP SYNC.    02980021
029900     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      02990021
030000                                                    COMP SYNC.    03000021
030100     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      03010021
030200                                                    COMP SYNC.    03020021
030300     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      03030021
030400                                                    COMP SYNC.    03040021
030500     05  PV-DISPLAY-UNIT-COST           PIC ZZZZZ9.99.            03050021
030510     05  PV-MTCH-LVL-CDE                PIC X(01)   VALUE SPACE.  03051040
030520                                                                  03052040
030600******************************************************************03060021
030700**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **03070021
030800**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **03080021
030900**  APPLICATION-SPECIFIC COMMAREA.                              **03090021
031000******************************************************************03100021
031100 01  LQW-LIST-QUEUE-WORK-AREA.                                    03110021
031200     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  03120021
031300     05  LQW-ITEM-ENTRIES               OCCURS 11 TIMES           03130021
031400                                        INDEXED BY LQW-IDX.       03140021
031500         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)V COMP-3.       03150021
031600         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               03160021
031700         10  LQW-SELECTED-SW            PIC  X(01).               03170021
031800             88  LQW-SELECT                         VALUE 'S'.    03180021
031900             88  LQW-DESELECT                       VALUE ' '.    03190021
032000         10  LQW-ACTION                 PIC  X(01).               03200021
032100         10  LQW-PAYT-REQ-LNE-NBR       PIC S9(4)   COMP.         03210021
032200         10  LQW-PIECES-ALL.                                      03220021
032300             20  LQW-INP-PIECES         PIC X(6).                 03230021
032400             20  LQW-PIECES             PIC 9(6).                 03240021
032500         10  LQW-UNIT-COST.                                       03250021
032600             20  LQW-UNIT-COST-X        PIC X(9).                 03260021
032700             20  LQW-UNIT-COST-9        PIC 9(7)V99.              03270021
032800         10  LQW-APP-PO-LINE-NBR        PIC 9(4).                 03280021
032900         10  LQW-PO-LINE-NBR            PIC 9(4).                 03290021
033000         10  LQW-UPC-CODE               PIC X(16).                03300021
033100         10  LQW-SKU                    PIC X(8).                 03310036
033200         10  LQW-VENDOR-STYLE           PIC X(12).                03320021
033300         10  LQW-COLOR                  PIC X(3).                 03330021
033400         10  LQW-SIZE                   PIC X(5).                 03340021
033500         10  LQW-INVOICE-LINE           PIC 9(4).                 03350021
033600         10  LQW-LINE-UPDATED-SW        PIC X.                    03360021
033700         10  LQW-LINE-PROBLEM-SW        PIC X.                    03370021
033800                                                                  03380021
034100*--------------------------------------------------------------*  03410057
034200* AP SELECTION TSQ LAYOUT                                      *  03420057
034300*--------------------------------------------------------------*  03430057
034400     COPY APWS301.                                                03440021
034500                                                                  03450021
034700*--------------------------------------------------------------*  03470057
034800* MAP LAYOUT                                                   *  03480057
034900*--------------------------------------------------------------*  03490057
035100     COPY APKM345.                                                03510021
035200                                                                  03520057
035300 01  AP-OCCURS-LAYOUT                   REDEFINES  AP345AO.       03530021
035400     05  FILLER                         PIC X(198).               03540063
035500     05  AP-SCROLL-AREA                 OCCURS 11 TIMES.          03550021
035600         10  AP-SELECTL                 PIC S9(04) COMP.          03560021
035700         10  AP-SELECTA                 PIC  X(01).               03570021
035800         10  AP-SELECTC                 PIC  X(01).               03580021
035900         10  AP-SELECTH                 PIC  X(01).               03590021
036000         10  AP-SELECT                  PIC  X(01).               03600021
036100                                                                  03610021
036200         10  AP-ACTIONL                 PIC S9(04) COMP.          03620021
036300         10  AP-ACTIONA                 PIC  X(01).               03630021
036400         10  AP-ACTIONC                 PIC  X(01).               03640021
036500         10  AP-ACTIONH                 PIC  X(01).               03650021
036600         10  AP-ACTION                  PIC  X(01).               03660021
036700                                                                  03670021
036800         10  AP-PIECESL                 PIC S9(04) COMP.          03680021
036900         10  AP-PIECESA                 PIC  X(01).               03690021
037000         10  AP-PIECESC                 PIC  X(01).               03700021
037100         10  AP-PIECESH                 PIC  X(01).               03710021
037200         10  AP-PIECES                  PIC  X(6).                03720021
037300         10  AP-PIECES-9 REDEFINES                                03730021
037400             AP-PIECES                  PIC  ZZZZZZ.              03740021
037500                                                                  03750021
037600         10  AP-UNIT-COSTL              PIC S9(04) COMP.          03760021
037700         10  AP-UNIT-COSTA              PIC  X(01).               03770021
037800         10  AP-UNIT-COSTC              PIC  X(01).               03780021
037900         10  AP-UNIT-COSTH              PIC  X(01).               03790021
038000         10  AP-UNIT-COST               PIC  X(9).                03800021
038100         10  AP-UNIT-COST-9  REDEFINES                            03810021
038200             AP-UNIT-COST               PIC ZZZZZZ.ZZ.            03820021
038300                                                                  03830021
038400         10  AP-PO-LINEL                PIC S9(04) COMP.          03840021
038500         10  AP-PO-LINEA                PIC  X(01).               03850021
038600         10  AP-PO-LINEC                PIC  X(01).               03860021
038700         10  AP-PO-LINEH                PIC  X(01).               03870021
038800         10  AP-PO-LINE                 PIC  X(4).                03880021
038900         10  AP-PO-LINE-9 REDEFINES                               03890021
039000             AP-PO-LINE                 PIC  ZZZ9.                03900021
039100                                                                  03910021
039200         10  AP-UPC-CODEL               PIC S9(04) COMP.          03920021
039300         10  AP-UPC-CODEA               PIC  X(01).               03930021
039400         10  AP-UPC-CODEC               PIC  X(01).               03940021
039500         10  AP-UPC-CODEH               PIC  X(01).               03950021
039600         10  AP-UPC-CODE                PIC  X(16).               03960021
039700                                                                  03970021
039800         10  AP-SKUL                    PIC S9(04) COMP.          03980036
039900         10  AP-SKUA                    PIC  X(01).               03990036
040000         10  AP-SKUC                    PIC  X(01).               04000036
040100         10  AP-SKUH                    PIC  X(01).               04010036
040200         10  AP-SKU                     PIC  X(8).                04020036
040300                                                                  04030021
040400         10  AP-STYLEL                  PIC S9(04) COMP.          04040021
040500         10  AP-STYLEA                  PIC  X(01).               04050021
040600         10  AP-STYLEC                  PIC  X(01).               04060021
040700         10  AP-STYLEH                  PIC  X(01).               04070021
040800         10  AP-STYLE                   PIC  X(12).               04080021
040900                                                                  04090021
041000         10  AP-COLORL                  PIC S9(04) COMP.          04100021
041100         10  AP-COLORA                  PIC  X(01).               04110021
041200         10  AP-COLORC                  PIC  X(01).               04120021
041300         10  AP-COLORH                  PIC  X(01).               04130021
041400         10  AP-COLOR                   PIC  X(3).                04140021
041500                                                                  04150021
041600         10  AP-SIZEL                   PIC S9(04) COMP.          04160021
041700         10  AP-SIZEA                   PIC  X(01).               04170021
041800         10  AP-SIZEC                   PIC  X(01).               04180021
041900         10  AP-SIZEH                   PIC  X(01).               04190021
042000         10  AP-SIZE                    PIC  X(5).                04200021
042100                                                                  04210021
042200         10  AP-INVOICE-LINEL           PIC S9(04) COMP.          04220021
042300         10  AP-INVOICE-LINEA           PIC  X(01).               04230021
042400         10  AP-INVOICE-LINEC           PIC  X(01).               04240021
042500         10  AP-INVOICE-LINEH           PIC  X(01).               04250021
042600         10  AP-INVOICE-LINE            PIC  X(04).               04260021
042700         10  AP-INVOICE-LINE-9  REDEFINES                         04270021
042800             AP-INVOICE-LINE            PIC ZZZ9.                 04280021
042900                                                                  04290021
043000     05  AP-SEL-ITEML               PIC S9(04) COMP.              04300021
043100     05  AP-SEL-ITEMA               PIC  X(01).                   04310021
043200     05  AP-SEL-ITEMC               PIC  X(01).                   04320021
043300     05  AP-SEL-ITEMH               PIC  X(01).                   04330021
043400     05  AP-SEL-ITEM                PIC  X(07).                   04340021
043500     05  AP-SEL-ITEM-9      REDEFINES                             04350021
043600             AP-SEL-ITEM                PIC ZZZ,ZZ9.              04360021
043700                                                                  04370021
043900*--------------------------------------------------------------*  04390057
044000* ATTRIBUTE SETTINGS COPYBOOK.                                 *  04400057
044100*--------------------------------------------------------------*  04410057
044300     COPY DPWS015.                                                04430021
044400                                                                  04440021
044500*--------------------------------------------------------------*  04450057
044600* DATE AND TIME COPYBOOK.                                      *  04460057
044700*--------------------------------------------------------------*  04470057
044900     COPY DPWS017.                                                04490021
045000                                                                  04500021
045100*--------------------------------------------------------------*  04510057
045200* FUNCTION KEYS COPYBOOK.                                      *  04520057
045300*--------------------------------------------------------------*  04530057
045500     COPY DPWS016.                                                04550021
045600                                                                  04560021
045700*--------------------------------------------------------------*  04570057
045800* NUMERIC EDIT LAYOUT.                                         *  04580057
045900*--------------------------------------------------------------*  04590057
046100     COPY DPWS010I.                                               04610021
046200                                                                  04620057
046300*--------------------------------------------------------------*  04630057
046400* CALLING PARAMETES FOR THE LOCKING MODULE.                    *  04640057
046500*--------------------------------------------------------------*  04650057
046700     COPY DPWS044.                                                04670021
046800                                                                  04680057
046900*--------------------------------------------------------------*  04690057
047000* PARAMETERS FOR CALLING CICS ARCHITECTURE API (DPKCS030)      *  04700057
047100*--------------------------------------------------------------*  04710057
047300     COPY DPWS030.                                                04730021
047310     COPY DPWS930.                                                04731070
047400                                                                  04740057
047500*--------------------------------------------------------------*  04750057
047600* STANDARD COMMAREA.                                           *  04760057
047700*--------------------------------------------------------------*  04770057
047900     COPY DPWS020.                                                04790021
048000     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04800021
048100                                                                  04810021
048200*--------------------------------------------------------------*  04820057
048300* INTER-APPLICATION COMMAREA.                                  *  04830057
048400* APWS300 - IS THE INPUT LAYOUT THAT HAS BEEN PASSED TO THIS   *  04840057
048500*           PROGRAMMING FROM APKCS320 AND APKCS324             *  04850057
048600*         - IS ALSO THE OUTPUT LAYOUT THAT WILL BE PASSED TO   *  04860057
048700*           OTHER PROGRAMS                                     *  04870057
048800*--------------------------------------------------------------*  04880057
049000         10  INTER-APPL-COMM-AREA       PIC X(200).               04900021
049100     COPY APWS300.                                                04910021
049110                                                                  04911057
049200*--------------------------------------------------------------*  04920057
049300* THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   *  04930057
049400*--------------------------------------------------------------*  04940057
049500         10  ASC-SPECIFIC-COMMAREA.                               04950021
049600             15  ASC-INT-APPL-FORMAT-IND             PIC X.       04960021
049700                 88  ASC-INTER-APPL-CRIT-SPEC          VALUE '1'. 04970021
049800                 88  ASC-INTER-APPL-LIST               VALUE '5'. 04980021
049900             15  ASC-LIST-KEYS.                                   04990021
050000                 20  ASC-KEY-PO-NUMBER               PIC S9(9)    05000021
050100                                                     COMP.        05010021
050200                 20  ASC-KEY-INVOICE-ID              PIC  X(22).  05020021
050300                 20  ASC-KEY-DEPT-NBR                PIC  X(3).   05030021
050400                 20  ASC-KEY-ENT-ID                  PIC S9(9)    05040021
050500                                                     COMP.        05050021
050600                 20  ASC-KEY-STORE-NUMBER            PIC S9(4)    05060021
050700                                                     COMP.        05070021
050800                 20  ASC-KEY-PAYT-REQ-SEQ-NBR        PIC S9(9)    05080021
050900                                                     COMP.        05090021
051000                 20  ASC-KEY-TOTAL-PIECES            PIC S9(9)    05100021
051100                                                     COMP.        05110021
051200                 20  ASC-KEY-GRO-COST-AMT            PIC S9(9)V99 05120021
051300                                                     COMP-3.      05130021
051400                 20  ASC-KEY-INVC-TYP-CDE            PIC  X(2).   05140021
051500                 20  ASC-KEY-INVC-STATUS             PIC  X(2).   05150021
051510                 20  ASC-KEY-DC-NBR                  PIC S9(4)    05151044
051520                                                     COMP.        05152040
051600                 20  ASC-CALC-TOTAL-PIECES           PIC S9(9)    05160021
051700                                                     COMP.        05170021
051800                 20  ASC-CALC-TOTAL-COST             PIC S9(9)V99 05180021
051900                                                     COMP-3.      05190021
052000                 20  ASC-VENDOR-DESC.                             05200021
052100                     25  ASC-VENDOR-DESC-10          PIC X(10).   05210021
052200                     25  FILLER                      PIC X(20).   05220021
052300                                                                  05230021
052400             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                05240021
052500                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  05250021
052600                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   05260021
052700                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   05270021
052800                                                                  05280021
052900                 20  ASC-ITEM-ARRAY.                              05290021
053000                     25  ASC-ITEM-ENTRIES OCCURS 11 TIMES.        05300021
053100                         30  ASC-LIST-ITEM-NUMBER    PIC S9(09)   05310021
053200                                                     COMP-3.      05320021
053300                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  05330021
053400                             88  ASC-VALID-SELECT    VALUE ' '    05340021
053500                                                           'S'    05350021
053600                                                           'B'    05360021
053700                                                           'E'.   05370021
053800                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   05380021
053900                             88  ASC-TEMP-SELECT     VALUE 'S'.   05390021
054000                             88  ASC-TEMP-BEGIN      VALUE 'B'.   05400021
054100                             88  ASC-TEMP-END        VALUE 'E'.   05410021
054200                         30  ASC-SELECTED-SW         PIC  X(01).  05420021
054300                             88  ASC-NO-SELECT       VALUE ' '.   05430021
054400                             88  ASC-SELECT          VALUE 'S'.   05440021
054500                             88  ASC-BEGIN           VALUE 'B'.   05450021
054600                             88  ASC-END             VALUE 'E'.   05460021
054700                         30  ASC-ACTION              PIC  X(01).  05470021
054800                         30  ASC-PAYT-REQ-LNE-NBR    PIC S9(4)    05480021
054900                                                     COMP.        05490021
055000                         30  ASC-PIECES-ALL.                      05500021
055100                             35  ASC-INP-PIECES      PIC X(6).    05510021
055200                             35  ASC-PIECES          PIC 9(6).    05520021
055300                         30  ASC-UNIT-COST-ALL.                   05530021
055400                             35  ASC-INP-UNIT-COST   PIC X(9).    05540021
055500                             35  ASC-UNIT-COST       PIC 9(7)V99. 05550021
055600                         30  ASC-APP-PO-LNE-NBR      PIC 9(4).    05560021
055700                         30  ASC-PO-LNE-NBR          PIC 9(4).    05570021
055800                         30  ASC-UPC-CODE            PIC X(16).   05580021
055900                         30  ASC-SKU                 PIC X(8).    05590036
056000                         30  ASC-VENDOR-STYLE        PIC X(12).   05600021
056100                         30  ASC-COLOR               PIC X(3).    05610021
056200                         30  ASC-SIZE                PIC X(5).    05620021
056300                         30  ASC-INVOICE-LINE        PIC 9(4).    05630021
056400                         30  ASC-LINE-CHANGED-SW     PIC X.       05640021
056500                             88  ASC-LINE-UPDATED    VALUE 'A'.   05650021
056600                             88  ASC-LINE-CHANGED    VALUE 'Y'.   05660021
056700                             88  ASC-LINE-NOT-CHANGED             05670021
056800                                                     VALUE ' '.   05680021
056900                         30  ASC-LINE-PROBLEM-SW     PIC X.       05690021
057000                             88  ASC-LINE-WARNING    VALUE 'W'.   05700021
057100                             88  ASC-LINE-ERROR      VALUE 'E'.   05710021
057200                             88  ASC-LINE-OK         VALUE ' '.   05720021
057300                                                                  05730021
057400             15  ASC-BLK-SUB                         PIC S9(04)   05740021
057500                                                          COMP    05750021
057600                                                          SYNC.   05760021
057700             15  ASC-ITEM-SUB                        PIC S9(04)   05770021
057800                                                          COMP    05780021
057900                                                          SYNC.   05790021
058000             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   05800021
058100                                                          COMP-3. 05810021
058200             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   05820021
058300                                                          COMP-3. 05830021
058400             15  ASC-PROTECT-FIELDS-SW                PIC  X(01). 05840021
058500                 88  ASC-PROTECT-FIELDS               VALUE 'Y'.  05850021
058600                 88  ASC-PROTECT-EDI-FIELDS           VALUE 'E'.  05860021
058700                 88  ASC-PROTECT-RI-FIELDS            VALUE 'R'.  05870021
058800                 88  ASC-UNPROTECT-FIELDS             VALUE 'N'.  05880021
058900                 88  ASC-ALLOW-SELECT-ONLY            VALUE 'S'.  05890021
059000             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   05900021
059100                                                          COMP-3. 05910021
059200             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   05920021
059300                                                          COMP-3. 05930021
059400             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   05940021
059500                                                          COMP-3. 05950021
059600             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   05960021
059700                                                          COMP    05970021
059800                                                          SYNC.   05980021
059900             15  ASC-START-ITEM-REQUEST.                          05990021
060000                 20  ASC-START-ITEM-REQUEST-N        PIC 9(5).    06000021
060100             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   06010021
060200                                                          COMP-3. 06020021
060300             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   06030021
060400                                                          COMP-3. 06040021
060500             15  ASC-APPROVED-SW                     PIC  X(01).  06050021
060600                 88  ASC-APPROVED                    VALUE 'Y'.   06060021
060700                 88  ASC-UNAPPROVED                  VALUE 'N'.   06070021
060800             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  06080021
060900                 88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   06090021
061000                 88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   06100021
061100             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC  X(01).  06110021
061200                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   06120021
061300                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   06130021
061400             15  ASC-LIST-QUEUE-NAME.                             06140021
061500                 20  ASC-LIST-TERM-ID                PIC  X(04).  06150021
061600                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   06160021
061700                                                          COMP-3. 06170021
061800                 20  ASC-LIST-SEQ                    PIC  9(01).  06180021
061900             15  ASC-SEL-QUEUE-NAME-IN               PIC  X(08).  06190021
062000             15  ASC-SEL-QUEUE-NAME-OUT.                          06200021
062100                 20  ASC-SEL-TERM-ID-OUT             PIC  X(04).  06210021
062200                 20  ASC-SEL-TASK-NUMBER-OUT         PIC S9(05)   06220021
062300                                                          COMP-3. 06230021
062400                 20  ASC-SEL-SEQ-OUT                 PIC  9(01).  06240021
062500             15  ASC-UPDATE-SW                       PIC X.       06250021
062600                 88  ASC-NO-UPDATE                   VALUE ' '.   06260021
062700                 88  ASC-WARNING-GIVEN               VALUE 'W'.   06270021
062800                 88  ASC-END-WARNING-GIVEN           VALUE 'E'.   06280021
062900             15  ASC-HOLD-BLOCK-NUMBER  PIC S9(04)  COMP SYNC.    06290021
063000             15  ASC-HOLD-ITEM-NUMBER   PIC S9(09)  COMP-3.       06300021
063100             15  ASC-USE-SELECTION-QUEUE-IND                      06310021
063200                                        PIC  X(01).               06320021
063300                 88  ASC-USE-SELECTION-QUEUE        VALUE 'Y'.    06330021
063400             15  ASC-NUMBER-OF-TS-ITEMS PIC S9(05)  COMP-3.       06340021
063500             15  ASC-SEL-SUB            PIC S9(04)  COMP.         06350021
063600             15  ASC-SEL-ITEM           PIC S9(04)  COMP.         06360021
063700*        10  FILLER                                  PIC X(783).  06370021
063800                                                                  06380057
063900*--------------------------------------------------------------*  06390057
064000* ABEND PROCESSING COPYBOOK.                                   *  06400057
064100*--------------------------------------------------------------*  06410057
064300     COPY DPWS013.                                                06430021
064400                                                                  06440021
064600*--------------------------------------------------------------*  06460057
064700* DB2 AREA FOR INVOICE TABLE                                   *  06470057
064800*--------------------------------------------------------------*  06480057
064900     EXEC SQL                                                     06490021
065000          INCLUDE TINVOIC                                         06500021
065100     END-EXEC.                                                    06510021
065110                                                                  06511057
065200*--------------------------------------------------------------*  06520057
065300* DB2 AREA FOR PO STORE TABLE                                  *  06530057
065400*--------------------------------------------------------------*  06540057
065500     EXEC SQL                                                     06550021
065600          INCLUDE TPOSTRR                                         06560021
065700     END-EXEC.                                                    06570021
065710                                                                  06571057
065800*--------------------------------------------------------------*  06580057
065900* DB2 AREA FOR PAY REQUEST ITEM TABLE                          *  06590057
066000*--------------------------------------------------------------*  06600057
066100     EXEC SQL                                                     06610021
066200          INCLUDE TPREQIT                                         06620021
066300     END-EXEC.                                                    06630021
066310                                                                  06631057
066400*--------------------------------------------------------------*  06640057
066500* DB2 AREA FOR MERCHANDISE INVOICE ITEM TABLE                  *  06650057
066600*--------------------------------------------------------------*  06660057
066700     EXEC SQL                                                     06670021
066800          INCLUDE TMIITEM                                         06680021
066900     END-EXEC.                                                    06690021
066910                                                                  06691057
067000*--------------------------------------------------------------*  06700057
067100* DB2 AREA FOR VENDOR SUPPLIED INVOICE ITEM TABLE              *  06710057
067200*--------------------------------------------------------------*  06720057
067300     EXEC SQL                                                     06730021
067400          INCLUDE TVNDINV                                         06740021
067500     END-EXEC.                                                    06750021
067510                                                                  06751057
067600*--------------------------------------------------------------*  06760057
067700* DB2 AREA FOR PURCHASE ORDER TABLE                            *  06770057
067800*--------------------------------------------------------------*  06780057
067900     EXEC SQL                                                     06790021
068000          INCLUDE TPURCHS                                         06800021
068100     END-EXEC.                                                    06810021
068110                                                                  06811057
068200*--------------------------------------------------------------*  06820057
068300* PO STATUS CODE TABLE                                         *  06830057
068400*--------------------------------------------------------------*  06840057
068500     EXEC SQL                                                     06850021
068600          INCLUDE TSTATCD                                         06860021
068700     END-EXEC.                                                    06870021
068710                                                                  06871057
068800*--------------------------------------------------------------*  06880057
068900* DB2 AREA FOR PURCHASE ORDER ITEM TABLE                       *  06890057
069000*--------------------------------------------------------------*  06900057
069100     EXEC SQL                                                     06910021
069200          INCLUDE TPURITM                                         06920021
069300     END-EXEC.                                                    06930021
069301                                                                  06930157
069310*--------------------------------------------------------------*  06931057
069320* DB2 AREA FOR UPC/SKU TABLE                                   *  06932057
069330*--------------------------------------------------------------*  06933057
069400     EXEC SQL                                                     06940021
069500          INCLUDE TUPCSKU                                         06950021
069600     END-EXEC.                                                    06960021
069601                                                                  06960157
069610*--------------------------------------------------------------*  06961057
069620* DB2 AREA FOR SKU CROSS REFERENCE TABLE                       *  06962057
069630*--------------------------------------------------------------*  06963057
069700     EXEC SQL                                                     06970021
069800          INCLUDE TSKXREF                                         06980023
069900     END-EXEC.                                                    06990021
069901                                                                  06990157
069910*--------------------------------------------------------------*  06991057
069920* DB2 AREA FOR MERCHANDISE INVOICE TABLE                       *  06992057
069930*--------------------------------------------------------------*  06993057
070000     EXEC SQL                                                     07000021
070100          INCLUDE TMDINVC                                         07010021
070200     END-EXEC.                                                    07020021
070210                                                                  07021057
070300*--------------------------------------------------------------*  07030057
070400* DB2 AREA FOR EXTERNAL ENTERPRISE NAME TABLE                  *  07040057
070500*--------------------------------------------------------------*  07050057
070600     EXEC SQL                                                     07060021
070700          INCLUDE TENTNME                                         07070021
070800     END-EXEC.                                                    07080021
070810                                                                  07081057
070900*--------------------------------------------------------------*  07090057
071000* DB2 AREA FOR COMMUNICATIONS                                  *  07100057
071100*--------------------------------------------------------------*  07110057
071200     EXEC SQL                                                     07120021
071300          INCLUDE SQLCA                                           07130021
071400     END-EXEC.                                                    07140021
071500                                                                  07150021
071600*--------------------------------------------------------------*  07160057
071700* CURSOR USED TO EXTRACT ITEMS FROM THE INVOICE SYSTEM         *  07170057
071800* THAT HAVE A NULL VALUE FOR THE PO LINE NUMBER.               *  07180057
071900*--------------------------------------------------------------*  07190057
072200     EXEC SQL                                                     07220021
072300          DECLARE INVOICE-ITEM-CSR CURSOR FOR                     07230021
072400              SELECT M.PAYT_REQ_LNE_NBR,                          07240021
072500                       PAY_REQ_LNE_QTY,                           07250021
072600                       UNT_COST_AMT,                              07260021
072700                       VALUE(PO_LNE_NBR,+0)                       07270026
072800              FROM TINVOIC I,                                     07280029
072900                   TPREQIT R,                                     07290021
073000                   TMIITEM M                                      07300021
073100          WHERE I.PAYT_REQ_SEQ_NBR = M.PAYT_REQ_SEQ_NBR           07310029
073200           AND  I.PAYT_REQ_SEQ_NBR = R.PAYT_REQ_SEQ_NBR           07320029
073300           AND  M.PAYT_REQ_LNE_NBR = R.PAYT_REQ_LNE_NBR           07330021
073400           AND (I.INVC_ID          = :DK-INVOICE-ID)              07340021
073500           AND  I.PO_NBR             IS NOT NULL                  07350029
073600           AND  I.PO_NBR   BETWEEN  :DK-LOW-PO-NUMBER AND         07360029
073700                                    :DK-HIGH-PO-NUMBER            07370021
073800           ORDER BY 4                                             07380021
073900     END-EXEC.                                                    07390021
074000                                                                  07400021
074100     EXEC SQL                                                     07410021
074200          DECLARE PREQIT_CSR       CURSOR FOR                     07420021
074300                SELECT   PAY_REQ_LNE_QTY                          07430021
074400                        ,UNT_COST_AMT                             07440021
074500                FROM     TPREQIT                                  07450021
074600                WHERE    PAYT_REQ_SEQ_NBR = :DK-PAYT-REQ-SEQ-NBR  07460021
074700     END-EXEC.                                                    07470021
074710                                                                  07471057
074800*------------------------*                                        07480057
074900 LINKAGE SECTION.                                                 07490021
075000*------------------------*                                        07500057
075100 01  DFHCOMMAREA.                                                 07510021
075200     05  FILLER                         OCCURS  1 TO 4072 TIMES   07520021
075300                                        DEPENDING ON EIBCALEN.    07530021
075400         10  FILLER                     PIC X.                    07540021
075500                                                                  07550021
075600*-----------------------*                                         07560057
075700 PROCEDURE DIVISION.                                              07570021
075710*-----------------------*                                         07571057
075800*--------------------------------------------------------------*  07580057
075900* THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM.  *  07590057
076000* FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM   *  07600057
076100* PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT.  *  07610057
076200*--------------------------------------------------------------*  07620057
076300 0000-MAIN-MODULE.                                                07630021
076310                                                                  07631057
076400     INITIALIZE DP030-CICS-API-FIELDS.                            07640021
076500     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       07650021
076600     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          07660021
076700     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         07670021
076800     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       07680021
076900     MOVE LENGTH OF AP345AI        TO DP030-MAP-LENGTH (1).       07690021
077000     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     07700021
077100     SET DP030-OVERRIDE-APPL-ERROR TO TRUE.                       07710021
077200     PERFORM 0001-CALL-CICS-ARCH-API.                             07720021
077300                                                                  07730057
077400     PERFORM 1000-CONTROL-PROCESSING                              07740021
077500                                                                  07750057
077600     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     07760021
077700     PERFORM 0001-CALL-CICS-ARCH-API.                             07770021
077800                                                                  07780021
077900*--------------------------------------------------------------*  07790057
078000* THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE    *  07800057
078100* AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.          *  07810057
078200*--------------------------------------------------------------*  07820057
078300 0001-CALL-CICS-ARCH-API.                                         07830021
078310                                                                  07831057
078400     CALL DP930-CICS-ARCH-API  USING DFHEIBLK                     07840070
078500                                     DFHCOMMAREA                  07850070
078600                                     DP030-CICS-API-FIELDS        07860070
078700                                     DP020-STANDARD-COMMAREA      07870070
078800                                     AP345AI.                     07880070
078900                                                                  07890057
079000     IF  DP030-RC-CALL-SUCCESSFUL OR                              07900021
079100         DP030-RC-APPL-ERROR                                      07910021
079200         CONTINUE                                                 07920021
079300     ELSE                                                         07930021
079400         SET DP013-NO-ROLLBACK                                    07940021
079500             DP013-XCTL-DISPLAY-RESTART                           07950021
079600             DP013-CICS-ABEND      TO TRUE                        07960021
079700         MOVE 'BEFORE 0000-MAIN-MODULE'                           07970021
079800                                   TO DP013-PARAGRAPH             07980021
080010         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O08001070
080020-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      08002070
080100         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      08010021
080200         PERFORM DP013-0000-PROCESS-ABEND                         08020021
080300     END-IF.                                                      08030021
080310                                                                  08031057
080400*--------------------------------------------------------------*  08040057
080500* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT    *  08050057
080600* COURSE OF ACTION IS FOR THIS TRANSACTION.                    *  08060057
080700*                                                              *  08070057
080800* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE*  08080057
080900*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS  *  08090057
081000*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS *  08100057
081100*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS*  08110057
081200*--------------------------------------------------------------*  08120057
081400 1000-CONTROL-PROCESSING.                                         08140021
081500                                                                  08150021
081600     EVALUATE TRUE                                                08160021
081800         WHEN DP020-NEXT-ACT-INITIAL                              08180021
081900             INITIALIZE ASC-SPECIFIC-COMMAREA                     08190021
082000             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            08200021
082100                                      ASC-SEL-TERM-ID-OUT         08210021
082200             MOVE DP020-SRC-TASK-NUMBER                           08220021
082300                                   TO ASC-LIST-TASK-NUMBER        08230021
082400                                      ASC-SEL-TASK-NUMBER-OUT     08240021
082500             MOVE PC-LIST-QUEUE-SEQ                               08250021
082600                                   TO ASC-LIST-SEQ                08260021
082700                                                                  08270021
082800             MOVE PC-SEL-QUEUE-SEQ-OUT                            08280021
082900                                   TO ASC-SEL-SEQ-OUT             08290021
083000             PERFORM 1100-PROCESS-INTER-APPL-COMM                 08300021
083100             IF  PS-ERROR                                         08310021
083200                 SET DP020-MSG-FATAL                              08320021
083300                                   TO TRUE                        08330021
083400                 SET DP020-NEXT-ACT-APPL-ERROR                    08340021
083500                                   TO TRUE                        08350021
083600             ELSE                                                 08360021
083700                 PERFORM 4000-BUILD-INITIAL-PANEL                 08370021
083800             END-IF                                               08380021
083900                                                                  08390021
084000         WHEN DP020-NEXT-ACT-RETURN                               08400021
084100             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         08410021
084200             MOVE ZERO TO ASC-ITEM-AT-TOP-OF-PANEL                08420021
084300             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 08430021
084400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08440021
084500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08450021
084600                                                                  08460021
084700         WHEN DP030-RC-APPL-ERROR                                 08470021
084800             MOVE ASC-KEY-PO-NUMBER                               08480021
084900                                 TO DK-PO-NUMBER                  08490021
085000                                    DK-HIGH-PO-NUMBER             08500021
085100                                    DK-LOW-PO-NUMBER              08510021
085200             MOVE ASC-KEY-INVOICE-ID                              08520021
085300                                 TO DK-INVOICE-ID                 08530021
085400                                    DK-HIGH-INVOICE-ID            08540021
085500                                    DK-LOW-INVOICE-ID             08550021
085600             MOVE ASC-KEY-PAYT-REQ-SEQ-NBR                        08560021
085700                                 TO DK-PAYT-REQ-SEQ-NBR           08570021
085800             MOVE ASC-KEY-DEPT-NBR                                08580021
085900                                 TO DK-DEPT-NBR                   08590021
086000             MOVE ASC-KEY-ENT-ID TO DK-ENT-ID                     08600021
086100             PERFORM 2070-DELETE-LIST-QUEUE                       08610021
086200             PERFORM 1150-GET-INVOICE-DATA                        08620021
086300             PERFORM 4000-BUILD-INITIAL-PANEL                     08630021
086400                                                                  08640021
086500         WHEN DP020-NEXT-ACT-READ-MAP                             08650021
086600             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        08660021
086700                                   TO PV-TOP-ITEM                 08670021
086800             PERFORM 2000-PROCESS-PANEL                           08680021
086900                                                                  08690021
087000         WHEN OTHER                                               08700021
087100             SET DP013-LOGIC-ABEND TO TRUE                        08710021
087200             SET DP013-NO-ROLLBACK TO TRUE                        08720021
087300             MOVE '1000-CONTROL-PROCESSING'                       08730021
087400                                   TO DP013-PARAGRAPH             08740021
087500             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    08750021
087600                                   TO DP013-MESSAGE-TEXT(1)       08760021
087700             PERFORM DP013-0000-PROCESS-ABEND                     08770021
087800     END-EVALUATE.                                                08780021
087900                                                                  08790021
088100*--------------------------------------------------------------*  08810057
088200* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR  *  08820057
088300* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.            *  08830057
088400*--------------------------------------------------------------*  08840057
088600 1100-PROCESS-INTER-APPL-COMM.                                    08860021
088700                                                                  08870021
088800     MOVE SPACE             TO ASC-START-ITEM-REQUEST.            08880021
088900     MOVE AP300-INVC-ID     TO ASC-KEY-INVOICE-ID                 08890021
089000                               DK-INVOICE-ID                      08900021
089100     IF AP300-PO-NBR = ZERO                                       08910021
089200        MOVE PC-PO-NBR-HIGH TO DK-HIGH-PO-NUMBER                  08920021
089300        MOVE PC-PO-NBR-LOW  TO DK-LOW-PO-NUMBER                   08930021
089400     ELSE                                                         08940021
089500        MOVE AP300-PO-NBR   TO ASC-KEY-PO-NUMBER                  08950021
089600                               DK-HIGH-PO-NUMBER                  08960021
089700                               DK-LOW-PO-NUMBER                   08970021
089800     END-IF                                                       08980021
089900                                                                  08990021
090000                                                                  09000021
090100     MOVE DP020-INT-APPL-FORMAT-IND                               09010021
090200                                 TO ASC-INT-APPL-FORMAT-IND       09020021
090300     EVALUATE TRUE                                                09030021
090400                                                                  09040021
090500         WHEN ASC-INTER-APPL-CRIT-SPEC                            09050021
090600             IF ASC-KEY-INVOICE-ID > SPACES                       09060021
090700                 PERFORM 1150-GET-INVOICE-DATA                    09070021
090800                 IF PS-NO-ERROR                                   09080021
090900                     PERFORM 1175-GET-PO-DATA                     09090021
091000                 END-IF                                           09100021
091100             ELSE                                                 09110021
091200                 MOVE PC-TSYMSG-00849    TO DP020-MSG-NUMBER      09120021
091300                 SET DP020-MSG-FATAL                              09130021
091400                     DP020-NEXT-ACT-APPL-ERROR                    09140021
091500                     PS-ERROR            TO TRUE                  09150021
091600             END-IF                                               09160021
091700         WHEN ASC-INTER-APPL-LIST                                 09170021
091800             IF AP300-NUMBER-OF-SELECTED-ITEMS > +0               09180021
091900                 SET ASC-USE-SELECTION-QUEUE                      09190021
092000                                 TO TRUE                          09200021
092100                 MOVE AP300-NUMBER-OF-SELECTED-ITEMS              09210021
092200                                 TO ASC-NUMBER-OF-SELECTED-ITEMS  09220021
092300                 MOVE AP300-NUMBER-OF-TS-ITEMS                    09230021
092400                                 TO ASC-NUMBER-OF-TS-ITEMS        09240021
092500                 MOVE AP300-SEL-QUEUE-NAME                        09250021
092600                                 TO ASC-SEL-QUEUE-NAME-IN         09260021
092700                                                                  09270021
092800                 PERFORM 1120-PREPARE-LIST-ENTRY                  09280021
092900             ELSE                                                 09290021
093000*                -- AT LEAST ONE ITEM MUST BE SELECTED --         09300021
093100                 MOVE PC-TSYMSG-00057      TO DP020-MSG-NUMBER    09310021
093200                 SET DP020-MSG-FATAL       TO TRUE                09320021
093300                 SET PS-ERROR              TO TRUE                09330021
093400             END-IF                                               09340021
093500                                                                  09350021
093600         WHEN OTHER                                               09360021
093700*            -- ENTRY OF A FIELD REQUIRED --                      09370021
093800             MOVE PC-TSYMSG-00330      TO DP020-MSG-NUMBER        09380021
093900             SET DP020-MSG-FATAL       TO TRUE                    09390021
094000             SET PS-COMMAREA-NOT-VALID TO TRUE                    09400021
094100     END-EVALUATE.                                                09410021
094200                                                                  09420021
094400*--------------------------------------------------------------*  09440057
094500* ENTRY IS FROM A LIST.  GET THE FORMAT NUMBER FROM THE TEMP   *  09450057
094600* STORAGE QUEUE PASSED FROM THE LIST.                          *  09460057
094700*--------------------------------------------------------------*  09470057
094800 1120-PREPARE-LIST-ENTRY.                                         09480021
094900                                                                  09490021
095000     MOVE AP301-MAX-ITEMS          TO ASC-SEL-SUB.                09500021
095100     MOVE ZERO                     TO ASC-SEL-ITEM.               09510021
095200     PERFORM 2101-GET-NEXT-RECORD.                                09520021
095300                                                                  09530057
095400*--------------------------------------------------------------*  09540057
095500* VALIDATE INVOICE INFORMATION                                 *  09550057
095600*--------------------------------------------------------------*  09560057
095700 1150-GET-INVOICE-DATA.                                           09570021
095710                                                                  09571057
095800     EXEC SQL                                                     09580021
095900         SELECT                                                   09590021
096000             PAYT_REQ_SEQ_NBR,                                    09600029
096100             INVC_TYP_CDE,                                        09610021
096200             STATUS_CDE,                                          09620021
096300             ENTR_MTHD_CDE,                                       09630021
096400             GRO_COST_AMT,                                        09640021
096500             VALUE(PO_NBR,+0),                                    09650029
096600             STR_NBR,                                             09660040
096610             DC_NBR,                                              09661040
096620             MTCH_LVL_CDE                                         09662040
096700         INTO                                                     09670021
096800             :INVOIC-PAYT-REQ-SEQ-NBR,                            09680021
096900             :INVOIC-INVC-TYP-CDE,                                09690021
097000             :INVOIC-STATUS-CDE,                                  09700021
097100             :INVOIC-ENTR-MTHD-CDE,                               09710021
097200             :INVOIC-GRO-COST-AMT,                                09720021
097300             :INVOIC-PO-NBR,                                      09730029
097400             :INVOIC-STR-NBR,                                     09740040
097410             :INVOIC-DC-NBR,                                      09741040
097420             :INVOIC-MTCH-LVL-CDE                                 09742040
097500         FROM TINVOIC I                                           09750029
097600         WHERE  INVC_ID       = :DK-INVOICE-ID                    09760021
097700           AND  I.PO_NBR           IS NOT NULL                    09770029
097800           AND  I.PO_NBR  BETWEEN :DK-LOW-PO-NUMBER AND           09780029
097900                                  :DK-HIGH-PO-NUMBER              09790026
098000     END-EXEC.                                                    09800021
098100                                                                  09810021
098200     EVALUATE TRUE                                                09820021
098300         WHEN SQLCODE = ZERO                                      09830021
098400             MOVE INVOIC-PAYT-REQ-SEQ-NBR                         09840021
098500                                 TO ASC-KEY-PAYT-REQ-SEQ-NBR      09850021
098600                                    DK-PAYT-REQ-SEQ-NBR           09860021
098700             MOVE INVOIC-PO-NBR  TO DK-PO-NUMBER                  09870029
098800                                    ASC-KEY-PO-NUMBER             09880021
098900             MOVE INVOIC-STR-NBR TO ASC-KEY-STORE-NUMBER          09890021
099000             MOVE INVOIC-GRO-COST-AMT                             09900021
099100                                 TO ASC-KEY-GRO-COST-AMT          09910021
099200             MOVE INVOIC-INVC-TYP-CDE                             09920021
099300                                 TO ASC-KEY-INVC-TYP-CDE          09930021
099400             MOVE INVOIC-STATUS-CDE                               09940021
099500                                 TO ASC-KEY-INVC-STATUS           09950021
099510             MOVE INVOIC-DC-NBR  TO ASC-KEY-DC-NBR                09951040
099520             MOVE INVOIC-MTCH-LVL-CDE                             09952043
099530                                 TO PV-MTCH-LVL-CDE               09953040
099600             EVALUATE TRUE                                        09960021
099700                 WHEN INVOIC-STATUS-CDE = PC-DELETE               09970021
099800                     SET ASC-PROTECT-FIELDS      TO TRUE          09980021
099900**                   -- UPDATE NOT ALLOWED FOR THIS STATUS --     09990021
100000                     MOVE PC-TSYMSG-00170        TO               10000021
100100                          DP020-MSG-NUMBER                        10010021
100200                     SET DP020-MSG-INFORMATIONAL TO TRUE          10020021
100300                 WHEN INVOIC-ENTR-MTHD-CDE = PC-EDI               10030021
100400                     SET ASC-PROTECT-EDI-FIELDS  TO TRUE          10040021
100500                 WHEN INVOIC-INVC-TYP-CDE  = PC-RI                10050021
100600                     SET ASC-PROTECT-RI-FIELDS  TO TRUE           10060021
100700                 WHEN INVOIC-STATUS-CDE = PC-ENTERED              10070021
100800                 WHEN INVOIC-STATUS-CDE = PC-RECONCILED           10080021
100900                 WHEN INVOIC-STATUS-CDE = PC-ITEM-IMBALANCE       10090021
101000                     SET ASC-UNPROTECT-FIELDS    TO TRUE          10100021
101100                 WHEN OTHER                                       10110021
101200                     SET ASC-ALLOW-SELECT-ONLY   TO TRUE          10120021
101300**                   -- UPDATE NOT ALLOWED FOR THIS STATUS --     10130021
101400                     IF INVOIC-STATUS-CDE = PC-OUT-OF-BALANCE     10140021
101500                         MOVE PC-TSYMSG-00942    TO               10150021
101600                              DP020-MSG-NUMBER                    10160021
101700                     ELSE                                         10170021
101800                         MOVE PC-TSYMSG-00170    TO               10180021
101900                              DP020-MSG-NUMBER                    10190021
102000                     END-IF                                       10200021
102100                     SET DP020-MSG-INFORMATIONAL TO TRUE          10210021
102200             END-EVALUATE                                         10220021
102300             PERFORM 1155-GET-TOTAL-PIECES                        10230021
102400         WHEN SQLCODE = -811                                      10240021
102600* DATA PASSED IS BRINGING BACK MORE THAN ONE PO                   10260057
102800             SET PS-ERROR        TO TRUE                          10280021
102900             MOVE PC-TSYMSG-00855                                 10290021
103000                                 TO DP020-MSG-NUMBER              10300021
103100         WHEN SQLWARN0 NOT = SPACES                               10310021
103200         WHEN SQLCODE < ZERO                                      10320021
103300         WHEN SQLCODE > ZERO                                      10330021
103500* DATA PASSED THROUGH INTER-APPL DOES NOT EXIST                   10350057
103700             SET PS-ERROR        TO TRUE                          10370021
103800             MOVE PC-TSYMSG-00855                                 10380021
103900                                 TO DP020-MSG-NUMBER              10390021
104000     END-EVALUATE.                                                10400021
104100                                                                  10410057
104200*--------------------------------------------------------------*  10420057
104300* EXTRACT TOTAL PIECES FOR THE PAYT REQ SEQUENCE NUMBER        *  10430057
104400*--------------------------------------------------------------*  10440057
104500 1155-GET-TOTAL-PIECES.                                           10450021
104510                                                                  10451057
104600     EXEC SQL                                                     10460021
104700         SELECT                                                   10470021
104800             TOT_INVC_PC_QTY                                      10480021
104900         INTO :MDINVC-TOT-INVC-PC-QTY                             10490021
105000         FROM TMDINVC                                             10500021
105100         WHERE PO_NBR  = :INVOIC-PO-NBR                           10510034
105200           AND INVC_ID = :DK-INVOICE-ID                           10520034
105300     END-EXEC.                                                    10530029
105400                                                                  10540029
105500     EVALUATE TRUE                                                10550029
105600         WHEN SQLCODE = ZERO                                      10560029
105700             MOVE MDINVC-TOT-INVC-PC-QTY                          10570029
105800                                 TO ASC-KEY-TOTAL-PIECES          10580029
105900         WHEN SQLWARN0 NOT = SPACES                               10590029
106000         WHEN SQLCODE < ZERO                                      10600029
106100         WHEN SQLCODE > ZERO                                      10610029
106200             MOVE ZERO           TO ASC-KEY-TOTAL-PIECES          10620029
106300     END-EVALUATE.                                                10630029
106310                                                                  10631057
106400*--------------------------------------------------------------*  10640057
106500* VALIDATE PURCHASE ORDER INFORMATION                          *  10650057
106600*--------------------------------------------------------------*  10660057
106700 1175-GET-PO-DATA.                                                10670029
106710                                                                  10671057
106800     EXEC SQL                                                     10680029
106900         SELECT                                                   10690029
107000             DEPT_NBR,                                            10700029
107100             ENT_ID,                                              10710029
107200             STATUS_CLS                                           10720029
107300         INTO                                                     10730029
107400             :PURCHS-DEPT-NBR,                                    10740029
107500             :PURCHS-ENT-ID,                                      10750029
107600             :STATCD-STATUS-CLS                                   10760029
107700         FROM TPURCHS P,                                          10770029
107800              TSTATCD S                                           10780029
107900         WHERE (PO_NBR           = :DK-PO-NUMBER)                 10790029
108000           AND (P.STATUS_CDE     =  S.STATUS_CDE)                 10800029
108100           AND (P.VER_STATUS_CDE = :PC-ACTIVE)                    10810029
108200           AND (S.STATUS_TYP_CDE = :PC-PURCH-ORDER)               10820029
108300     END-EXEC.                                                    10830029
108400                                                                  10840029
108500     EVALUATE TRUE                                                10850029
108600         WHEN SQLCODE = ZERO                                      10860029
108700             MOVE PURCHS-DEPT-NBR                                 10870029
108800                                 TO ASC-KEY-DEPT-NBR              10880029
108900                                    DK-DEPT-NBR                   10890029
109000             MOVE PURCHS-ENT-ID  TO ASC-KEY-ENT-ID                10900029
109100                                    DK-ENT-ID                     10910029
109200             IF STATCD-STATUS-CLS = PC-UNAPPROVED                 10920029
109300                 SET ASC-UNAPPROVED                               10930029
109400                                 TO TRUE                          10940029
109500             ELSE                                                 10950029
109600                 SET ASC-APPROVED                                 10960029
109700                                 TO TRUE                          10970029
109800             END-IF                                               10980029
109900             PERFORM 1180-GET-VENDOR-DESC                         10990029
110000         WHEN SQLWARN0 NOT = SPACES                               11000029
110100         WHEN SQLCODE < ZERO                                      11010029
110200         WHEN SQLCODE > ZERO                                      11020029
110300             SET PS-ERROR        TO TRUE                          11030029
110400             MOVE PC-TSYMSG-00852                                 11040029
110500                                 TO DP020-MSG-NUMBER              11050029
110600     END-EVALUATE.                                                11060029
110700                                                                  11070057
110800*--------------------------------------------------------------*  11080057
110900* READS ENTNME TABLE TO GET VENDOR NAME                        *  11090057
111000*--------------------------------------------------------------*  11100057
111100 1180-GET-VENDOR-DESC.                                            11110029
111200                                                                  11120057
111300     EXEC SQL                                                     11130029
111400         SELECT                                                   11140029
111500             ENT_NAME_DESC                                        11150029
111600         INTO                                                     11160029
111700             :ENTNME-ENT-NAME-DESC                                11170029
111800         FROM TENTNME E                                           11180029
111900         WHERE (E.ENT_ID      = :DK-ENT-ID)                       11190029
112000           AND (E.TYPE_CDE    = :PC-TYPE-01)                      11200029
112100     END-EXEC.                                                    11210029
112200                                                                  11220029
112300     EVALUATE TRUE                                                11230029
112400         WHEN SQLCODE = ZERO                                      11240029
112500             MOVE ENTNME-ENT-NAME-DESC                            11250029
112600                             TO ASC-VENDOR-DESC                   11260029
112700         WHEN SQLCODE = +100                                      11270029
112800             MOVE SPACES         TO ASC-VENDOR-DESC               11280029
112900         WHEN SQLWARN0 NOT = SPACES                               11290029
113000         WHEN SQLCODE < ZERO                                      11300029
113100         WHEN SQLCODE > ZERO                                      11310029
113200             MOVE '1180-GET-VENDOR-DESC'                          11320029
113300                               TO DP013-PARAGRAPH                 11330029
113400             MOVE 'SELECT VENDOR DESC FROM ENT ID'                11340029
113500                                   TO DP013-MESSAGE-TEXT (1)      11350029
113600             MOVE DK-ENT-ID        TO DP013-MESSAGE-TEXT (2)      11360029
113700             MOVE SQLCA            TO DP013-SQLCA                 11370029
113800             MOVE 'TENTNME'        TO DP013-DB2-TABLE-NAME (1)    11380029
113900             SET DP013-DB2-ABEND                                  11390029
114000                 DP013-XCTL-DISPLAY-RESTART TO TRUE               11400029
114100             PERFORM DP013-0000-PROCESS-ABEND                     11410029
114200     END-EVALUATE.                                                11420029
114300                                                                  11430057
114400*--------------------------------------------------------------*  11440057
114500* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA *  11450057
114600* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT *  11460057
114700* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST*  11470057
114800* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID    *  11480057
114900* FUNCTION KEYS CAN GET THIS FAR.                              *  11490057
115000*--------------------------------------------------------------*  11500057
115200 2000-PROCESS-PANEL.                                              11520029
115300                                                                  11530029
115400     EVALUATE TRUE                                                11540029
115500         WHEN DP020-SRC-AID = DP016-CLEAR                         11550029
115600             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    11560029
115700             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   11570029
115800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11580029
115900                                                                  11590029
116000         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    11600029
116100             PERFORM 2070-DELETE-LIST-QUEUE                       11610029
116200             MOVE ASC-KEY-PO-NUMBER                               11620029
116300                                 TO DK-PO-NUMBER                  11630029
116400                                    DK-HIGH-PO-NUMBER             11640029
116500                                    DK-LOW-PO-NUMBER              11650029
116600             MOVE ASC-KEY-INVOICE-ID                              11660029
116700                                 TO DK-INVOICE-ID                 11670029
116800                                    DK-HIGH-INVOICE-ID            11680029
116900                                    DK-LOW-INVOICE-ID             11690029
117000             MOVE ASC-KEY-PAYT-REQ-SEQ-NBR                        11700029
117100                                 TO DK-PAYT-REQ-SEQ-NBR           11710029
117200             MOVE ASC-KEY-DEPT-NBR                                11720029
117300                                 TO DK-DEPT-NBR                   11730029
117400             MOVE ASC-KEY-ENT-ID TO DK-ENT-ID                     11740029
117500             PERFORM 4000-BUILD-INITIAL-PANEL                     11750029
117600                                                                  11760029
117700         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    11770029
117800             PERFORM 2140-DESELECT-ALL-ITEMS                      11780029
117900             PERFORM 3200-RESET-ATTRIBUTES                        11790029
118000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11800029
118100                                                                  11810029
118200         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  11820029
118300             PERFORM 2150-SELECT-ALL-ITEMS                        11830029
118400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   11840029
118500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11850029
118600                                                                  11860029
118700         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             11870029
118800             IF  ASC-USE-SELECTION-QUEUE                          11880029
118900                 PERFORM 2101-GET-NEXT-RECORD                     11890029
119000                 IF PS-NO-ERROR                                   11900029
119100                     PERFORM 2070-DELETE-LIST-QUEUE               11910029
119200                     PERFORM 4000-BUILD-INITIAL-PANEL             11920029
119300                 END-IF                                           11930029
119400             ELSE                                                 11940029
119500*                --- BOTTOM OF LIST ---                           11950029
119600                 MOVE PC-TSYMSG-00070                             11960029
119700                                   TO DP020-MSG-NUMBER            11970029
119800                 SET DP020-MSG-INFORMATIONAL                      11980029
119900                                   TO TRUE                        11990029
120000             END-IF                                               12000029
120100                                                                  12010029
120200         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             12020029
120300             IF  ASC-USE-SELECTION-QUEUE                          12030029
120400                 PERFORM 2102-GET-PREV-RECORD                     12040029
120500                 IF PS-NO-ERROR                                   12050029
120600                     PERFORM 2070-DELETE-LIST-QUEUE               12060029
120700                     PERFORM 4000-BUILD-INITIAL-PANEL             12070029
120800                 END-IF                                           12080029
120900             ELSE                                                 12090029
121000*                --- TOP OF LIST ---                              12100029
121100                 MOVE PC-TSYMSG-00069                             12110029
121200                                   TO DP020-MSG-NUMBER            12120029
121300                 SET DP020-MSG-INFORMATIONAL                      12130029
121400                                   TO TRUE                        12140029
121500             END-IF                                               12150029
121600                                                                  12160029
121700                                                                  12170029
121800         WHEN OTHER                                               12180029
121900             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 12190029
122000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   12200029
122100             IF  PS-NO-ERROR                                      12210029
122200                 SET DP030-CONTINUE-GO                            12220029
122300                                 TO TRUE                          12230029
122400                 PERFORM 2100-CHECK-FUNCTION-KEY                  12240029
122500             ELSE                                                 12250029
122600                 SET DP030-OVERRIDE-GO                            12260029
122700                                 TO TRUE                          12270029
122800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             12280029
122900             END-IF                                               12290029
123000     END-EVALUATE.                                                12300029
123100                                                                  12310057
123200*--------------------------------------------------------------*  12320057
123300* DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                    *  12330057
123400*--------------------------------------------------------------*  12340057
123500 2070-DELETE-LIST-QUEUE.                                          12350029
123600                                                                  12360029
123700     EXEC CICS                                                    12370029
123800         DELETEQ TS                                               12380029
123900             QUEUE (ASC-LIST-QUEUE-NAME)                          12390029
124000             RESP  (PV-CICS-RESP)                                 12400029
124100     END-EXEC.                                                    12410029
124200                                                                  12420029
124300     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       12430029
124400        (PV-CICS-RESP = DFHRESP(QIDERR))                          12440029
124500         CONTINUE                                                 12450029
124600     ELSE                                                         12460029
124700         SET DP013-CICS-ABEND      TO TRUE                        12470029
124800         SET DP013-NO-ROLLBACK     TO TRUE                        12480029
124900                                                                  12490029
125000         MOVE '2070-DELETE-LIST-QUEUE'                            12500029
125100                                   TO DP013-PARAGRAPH             12510029
125200         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    12520029
125300                                   TO DP013-MESSAGE-TEXT (1)      12530029
125400         PERFORM DP013-0000-PROCESS-ABEND                         12540029
125500     END-IF.                                                      12550029
125600                                                                  12560029
125700     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  12570029
125900                                                                  12590029
126000*--------------------------------------------------------------*  12600057
126100* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     *  12610057
126110* FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED *  12611057
126120* FROM THE CICS ARCHITECTURE API.                              *  12612057
126400*--------------------------------------------------------------*  12640057
126500 2100-CHECK-FUNCTION-KEY.                                         12650029
126510                                                                  12651057
126600     EVALUATE TRUE                                                12660029
126900* LOCAL FUNCTION 01 IS SET UP FOR THE UPDATE OF THE INVOICE       12690057
127000* LINE ITEMS.                                                     12700057
127300         WHEN DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)               12730029
127400             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 12740029
127500             IF PS-NO-ERROR                                       12750029
127600                 IF (PV-FIRST-ERROR-ITEM > ZERO) OR               12760029
127700                    (PS-ERROR)                                    12770029
127800                     SET ASC-WARNING-GIVEN                        12780029
127900                                 TO TRUE                          12790029
128000                     MOVE PC-TSYMSG-00872                         12800029
128100                                   TO DP020-MSG-NUMBER            12810029
128200                     SET DP020-MSG-WARNING                        12820029
128300                                     TO TRUE                      12830029
128400                 ELSE                                             12840029
128500                     IF ASC-NUMBER-OF-SELECTED-ITEMS = ZERO       12850029
128600*                    --- A LIST ITEM MUST BE SELECTED ---         12860029
128700                         MOVE PC-TSYMSG-00057                     12870029
128800                                 TO DP020-MSG-NUMBER              12880029
128900                         SET DP020-MSG-FATAL                      12890029
129000                             PS-ERROR    TO TRUE                  12900029
129100                     ELSE                                         12910029
129200                         PERFORM 8800-CHECK-IF-PROCESSED          12920029
129300                         IF PS-ERROR                              12930029
129400                             MOVE PC-TSYMSG-00961 TO              12940029
129500                                            DP020-MSG-NUMBER      12950029
129600                             SET DP020-MSG-FATAL                  12960029
129700                                 DP030-OVERRIDE-GO                12970029
129800                                 PS-ERROR          TO TRUE        12980029
129900                         ELSE                                     12990029
130000                             PERFORM 8000-PROCESS-UPDATE-TSQ      13000029
130100                             MOVE PC-TSYMSG-00059                 13010029
130200                                           TO DP020-MSG-NUMBER    13020029
130300                             SET DP020-MSG-INFORMATIONAL          13030029
130400                                             TO TRUE              13040029
130500                         END-IF                                   13050029
130600                     END-IF                                       13060029
130700                 END-IF                                           13070029
130800             END-IF                                               13080029
130900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13090029
131300* FOUR FUNCTIONS THAT HAVE BEEN SETUP FOR THE LOCAL GO TO ARE:    13130057
131400* 1.  DELETE INVOICE LINE ITEMS                                   13140057
131500* 2.  STORE RECN                                                  13150057
131600* 3.  PO RECN                                                     13160057
131700* 4.  DETAIL UPDATES                                              13170057
131900         WHEN DP020-FK-LOCAL-GOTO(DP020-SRC-AID)                  13190029
132000             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 13200029
132100             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   13210029
132200             IF PS-ERROR                                          13220029
132300                 SET DP030-OVERRIDE-GO                            13230029
132400                                 TO TRUE                          13240029
132500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             13250029
132600             ELSE                                                 13260029
132700                 SET DP030-CONTINUE-GO                            13270029
132800                                 TO TRUE                          13280029
132900                 PERFORM 2400-PREPARE-INTER-APPL-COMM             13290029
133000             END-IF                                               13300029
133100                                                                  13310029
133200         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  13320029
133300             MOVE +1               TO PV-TOP-ITEM                 13330029
133400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13340029
133500                                                                  13350029
133600         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   13360029
133700             PERFORM 2110-BROWSE-BACKWARD                         13370029
133800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13380029
133900                                                                  13390029
134000         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   13400029
134100             PERFORM 2120-BROWSE-FORWARD                          13410029
134200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13420029
134300                                                                  13430029
134400         WHEN DP020-SRC-AID = DP016-ENTER                         13440029
134500             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   13450029
134600             IF  PS-ERROR                                         13460029
134700                 CONTINUE                                         13470029
134800             ELSE                                                 13480029
134900                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             13490029
135000             END-IF                                               13500029
135100                                                                  13510029
135200         WHEN OTHER                                               13520029
135300             SET DP013-NO-ROLLBACK                                13530029
135400                 DP013-XCTL-DISPLAY-RESTART                       13540029
135500                 DP013-CICS-ABEND  TO TRUE                        13550029
135600             MOVE '2100-CHECK-FUNCTION-KEY'                       13560029
135700                                   TO DP013-PARAGRAPH             13570029
135800             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      13580029
135900                                   TO DP013-MESSAGE-TEXT (1)      13590029
136000             PERFORM DP013-0000-PROCESS-ABEND                     13600029
136100     END-EVALUATE.                                                13610029
136200                                                                  13620029
136210*--------------------------------------------------------------*  13621057
136220* GET THE NEXT RECORD IN THE LIST                              *  13622057
136250*--------------------------------------------------------------*  13625057
136300 2101-GET-NEXT-RECORD.                                            13630029
136400                                                                  13640029
136500     ADD +1                        TO ASC-SEL-SUB.                13650029
136600     IF  ASC-SEL-SUB > AP301-MAX-ITEMS                            13660029
136700         ADD +1                    TO ASC-SEL-ITEM                13670029
136800         MOVE +1                   TO ASC-SEL-SUB                 13680029
136900     END-IF.                                                      13690029
137000                                                                  13700029
137100     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                13710029
137200         PERFORM 9100-READ-SEL-QUEUE                              13720029
137300         IF  AP301-ITEM (ASC-SEL-SUB) > ZERO                      13730029
137400             MOVE AP301-INVC-ID          (ASC-SEL-SUB)            13740029
137500                                     TO ASC-KEY-INVOICE-ID        13750029
137600                                        DK-INVOICE-ID             13760029
137700                                                                  13770029
137800             MOVE AP301-PO-NBR           (ASC-SEL-SUB)            13780029
137900                                     TO ASC-KEY-PO-NUMBER         13790029
138000                                        DK-PO-NUMBER              13800029
138100                                                                  13810029
138200             IF ASC-KEY-INVOICE-ID > SPACES                       13820029
138300                 IF ASC-KEY-PO-NUMBER = ZERO                      13830029
138400                     MOVE PC-PO-NBR-HIGH TO DK-HIGH-PO-NUMBER     13840029
138500                     MOVE PC-PO-NBR-LOW  TO DK-LOW-PO-NUMBER      13850029
138600                 ELSE                                             13860029
138700                     MOVE ASC-KEY-PO-NUMBER                       13870029
138800                                         TO DK-HIGH-PO-NUMBER     13880029
138900                                            DK-LOW-PO-NUMBER      13890029
139000                 END-IF                                           13900029
139100                 SET AP301-INQ (ASC-SEL-SUB)                      13910029
139200                                       TO TRUE                    13920029
139300                 PERFORM 9200-REWRITE-LIST-QUEUE                  13930029
139400                 PERFORM 1150-GET-INVOICE-DATA                    13940029
139500                 IF PS-NO-ERROR                                   13950029
139600                     PERFORM 1175-GET-PO-DATA                     13960029
139700                 END-IF                                           13970029
139800             ELSE                                                 13980029
139900                 MOVE PC-TSYMSG-00849    TO DP020-MSG-NUMBER      13990029
140000                 SET DP020-MSG-FATAL                              14000029
140100                     PS-ERROR            TO TRUE                  14010029
140200             END-IF                                               14020029
140300         ELSE                                                     14030029
140400             SUBTRACT +1 FROM ASC-SEL-SUB                         14040029
140500*            --- BOTTOM OF LIST ---                               14050029
140600             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            14060029
140700             SET DP020-MSG-INFORMATIONAL                          14070029
140800                 PS-ERROR                                         14080029
140900                                   TO TRUE                        14090029
141000         END-IF                                                   14100029
141100     ELSE                                                         14110029
141200         SUBTRACT +1 FROM ASC-SEL-ITEM                            14120029
141300         MOVE AP301-MAX-ITEMS      TO ASC-SEL-SUB                 14130029
141400         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            14140029
141500         SET DP020-MSG-INFORMATIONAL                              14150029
141600             PS-ERROR                                             14160029
141700                                   TO TRUE                        14170029
141800     END-IF.                                                      14180029
141900                                                                  14190029
142010*--------------------------------------------------------------*  14201057
142020* GET THE PREVIOUS RECORD IN THE LIST                          *  14202057
142030*--------------------------------------------------------------*  14203057
142100 2102-GET-PREV-RECORD.                                            14210029
142200                                                                  14220029
142300     SUBTRACT +1 FROM ASC-SEL-SUB.                                14230029
142400     IF  ASC-SEL-SUB < +1                                         14240029
142500         SUBTRACT +1 FROM ASC-SEL-ITEM                            14250029
142600         MOVE AP301-MAX-ITEMS      TO ASC-SEL-SUB                 14260029
142700     END-IF.                                                      14270029
142800                                                                  14280029
142900     IF  ASC-SEL-ITEM > ZERO                                      14290029
143000         PERFORM 9100-READ-SEL-QUEUE                              14300029
143100         MOVE AP301-INVC-ID          (ASC-SEL-SUB)                14310029
143200                                 TO ASC-KEY-INVOICE-ID            14320029
143300                                    DK-INVOICE-ID                 14330029
143400         MOVE AP301-PO-NBR           (ASC-SEL-SUB)                14340029
143500                                 TO ASC-KEY-PO-NUMBER             14350029
143600                                    DK-PO-NUMBER                  14360029
143700         IF ASC-KEY-INVOICE-ID > SPACES                           14370029
143800             IF ASC-KEY-PO-NUMBER = ZERO                          14380029
143900                 MOVE PC-PO-NBR-HIGH TO DK-HIGH-PO-NUMBER         14390029
144000                 MOVE PC-PO-NBR-LOW  TO DK-LOW-PO-NUMBER          14400029
144100             ELSE                                                 14410029
144200                 MOVE ASC-KEY-PO-NUMBER                           14420029
144300                                     TO DK-HIGH-PO-NUMBER         14430029
144400                                        DK-LOW-PO-NUMBER          14440029
144500             END-IF                                               14450029
144600             SET AP301-INQ (ASC-SEL-SUB)                          14460029
144700                                   TO TRUE                        14470029
144800             PERFORM 9200-REWRITE-LIST-QUEUE                      14480029
144900             PERFORM 1150-GET-INVOICE-DATA                        14490029
145000             IF PS-NO-ERROR                                       14500029
145100                 PERFORM 1175-GET-PO-DATA                         14510029
145200             END-IF                                               14520029
145300         ELSE                                                     14530029
145400             MOVE PC-TSYMSG-00849    TO DP020-MSG-NUMBER          14540029
145500             SET DP020-MSG-FATAL                                  14550029
145600                 PS-ERROR            TO TRUE                      14560029
145700         END-IF                                                   14570029
145800     ELSE                                                         14580029
145900         MOVE +1                   TO ASC-SEL-ITEM                14590029
146000                                      ASC-SEL-SUB                 14600029
146100*        --- TOP OF LIST ---                                      14610029
146200         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            14620029
146300         SET DP020-MSG-INFORMATIONAL                              14630029
146400             PS-ERROR                                             14640029
146500                                   TO TRUE                        14650029
146600     END-IF.                                                      14660029
146700                                                                  14670029
147000*--------------------------------------------------------------*  14700057
147100* IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP      *  14710057
147200* ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,       *  14720057
147300* SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST    *  14730057
147400* MESSAGE.                                                     *  14740057
147500*--------------------------------------------------------------*  14750057
147700 2110-BROWSE-BACKWARD.                                            14770029
147710                                                                  14771057
147800     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    14780029
147900         GIVING PV-TOP-ITEM.                                      14790029
148000                                                                  14800057
148100     IF  ((PV-TOP-ITEM < +1)                                      14810029
148200       OR (PV-TOP-ITEM = +1))                                     14820029
148300         MOVE +1                   TO PV-TOP-ITEM                 14830029
148400*        -- TOP OF LIST --                                        14840029
148500         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            14850029
148600         SET DP020-MSG-INFORMATIONAL TO TRUE                      14860029
148700     END-IF.                                                      14870029
148800                                                                  14880029
149000*--------------------------------------------------------------*  14900057
149100* IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP       *  14910057
149200* ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO    *  14920057
149300* PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.              *  14930057
149400*--------------------------------------------------------------*  14940057
149600 2120-BROWSE-FORWARD.                                             14960029
149700                                                                  14970029
149800     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              14980029
149900         GIVING PV-TOP-ITEM.                                      14990029
150000     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   15000029
150100         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            15010029
150200                                   TO PV-TOP-ITEM                 15020029
150300*        -- BOTTOM OF LIST --                                     15030029
150400         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            15040029
150500         SET DP020-MSG-INFORMATIONAL                              15050029
150600                                   TO TRUE                        15060029
150700     ELSE                                                         15070029
150800         COMPUTE PV-BOTTOM-ITEM =                                 15080029
150900             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 15090029
151000         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            15100029
151100*            -- BOTTOM OF LIST --                                 15110029
151200             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            15120029
151300             SET DP020-MSG-INFORMATIONAL                          15130029
151400                                   TO TRUE                        15140029
151500         END-IF                                                   15150029
151600     END-IF.                                                      15160029
151700                                                                  15170057
151800*--------------------------------------------------------------*  15180057
151900* THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO     *  15190057
152000* THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.    *  15200057
152100* THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST   *  15210057
152200* RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.          *  15220057
152300* THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT      *  15230057
152400* IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.           *  15240057
152500*--------------------------------------------------------------*  15250057
152700 2130-CHECK-FOR-JUMP-BROWSE.                                      15270029
152710                                                                  15271057
152800     SET PS-NO-ERROR               TO TRUE.                       15280029
152900     IF (ASC-START-ITEM-REQUEST = SPACE)                          15290029
153000         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            15300029
153100                                   TO PV-TOP-ITEM                 15310029
153200     ELSE                                                         15320029
153300         MOVE ASC-START-ITEM-REQUEST                              15330029
153400                                   TO DP010I-UNEDITED-FIELD       15340029
153500         MOVE PC-LIST-NUMBER-LENGTH                               15350029
153600                                   TO DP010I-MAXIMUM-DIGITS       15360029
153700         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     15370029
153800         SET DP010I-NEGATIVE-NOT-ALLOWED                          15380029
153900                                   TO TRUE                        15390029
154020         CALL DP010I-NUMERIC-EDIT-ROUTINE                         15402065
154030                         USING DP010I-NUMERIC-EDIT-AREA           15403065
154100                                                                  15410029
154200         IF  NOT DP010I-ERROR-DETECTED                            15420029
154300             MOVE DP010I-NUMERIC-FIELD                            15430029
154400                                   TO  ASC-START-ITEM-REQUEST-N   15440029
154500             IF  ASC-START-ITEM-REQUEST-N > ZERO                  15450029
154600                 IF  ASC-START-ITEM-REQUEST-N >                   15460029
154700                                          ASC-NUMBER-OF-ITEMS-READ15470029
154800                     MOVE SPACE TO ASC-START-ITEM-REQUEST         15480029
154900                     COMPUTE PV-TOP-ITEM =                        15490029
155000                             ASC-NUMBER-OF-ITEMS-READ             15500029
155100                             - PC-ITEMS-PER-PANEL + 1             15510029
155200                     IF  PV-TOP-ITEM < +1                         15520029
155300                         MOVE +1   TO PV-TOP-ITEM                 15530029
155400                         MOVE PC-TSYMSG-00070                     15540029
155500                                   TO DP020-MSG-NUMBER            15550029
155600                         SET DP020-MSG-INFORMATIONAL              15560029
155700                                   TO TRUE                        15570029
155800                     END-IF                                       15580029
155900                 ELSE                                             15590029
156000                     MOVE ASC-START-ITEM-REQUEST-N                15600029
156100                                   TO PV-TOP-ITEM                 15610029
156200                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      15620029
156300                     COMPUTE PV-BOTTOM-ITEM =                     15630029
156400                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     15640029
156500                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ15650029
156600*                        -- BOTTOM OF LIST --                     15660029
156700                         MOVE PC-TSYMSG-00070                     15670029
156800                                   TO DP020-MSG-NUMBER            15680029
156900                         SET DP020-MSG-INFORMATIONAL              15690029
157000                                   TO TRUE                        15700029
157100                     END-IF                                       15710029
157200                 END-IF                                           15720029
157300             ELSE                                                 15730029
157400*                --- VALUE OUT OF RANGE ----                      15740029
157500                 MOVE PC-TSYMSG-00101                             15750029
157600                                   TO DP020-MSG-NUMBER            15760029
157700                 MOVE -1           TO ASTRTITL                    15770029
157800                 SET DP030-SET-CURSOR-APPL-1                      15780029
157900                                   TO TRUE                        15790029
158000                 MOVE DP015-REVERSE                               15800029
158100                                   TO ASTRTITH                    15810029
158200                 MOVE DP015-RED    TO ASTRTITC                    15820029
158300                 MOVE DP015-UNP-NUM-BRT-MDT                       15830029
158400                                   TO ASTRTITA                    15840029
158500                 SET DP020-MSG-FATAL                              15850029
158600                     PS-START-ITEM-ERROR                          15860029
158700                                   TO TRUE                        15870029
158800             END-IF                                               15880029
158900                                                                  15890029
159000         ELSE                                                     15900029
159100             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            15910029
159200             MOVE -1               TO ASTRTITL                    15920029
159300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  15930029
159400             MOVE DP015-REVERSE    TO ASTRTITH                    15940029
159500             MOVE DP015-RED        TO ASTRTITC                    15950029
159600             MOVE DP015-UNP-NUM-BRT-MDT                           15960029
159700                                   TO ASTRTITA                    15970029
159800             SET DP020-MSG-FATAL                                  15980029
159900                 PS-START-ITEM-ERROR                              15990029
160000                                   TO TRUE                        16000029
160100         END-IF                                                   16010029
160200     END-IF.                                                      16020029
160300                                                                  16030057
160400*--------------------------------------------------------------*  16040057
160500* IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION       *  16050057
160600* SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.          *  16060057
160700*--------------------------------------------------------------*  16070057
160800 2140-DESELECT-ALL-ITEMS.                                         16080029
160810                                                                  16081057
160900     MOVE +1                       TO ASC-BLK-SUB.                16090029
161000                                                                  16100029
161100     PERFORM 2141-CLEAR-SELECTED-INDS                             16110029
161200         VARYING ASC-ITEM-SUB                                     16120029
161300         FROM 1 BY 1                                              16130029
161400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 16140029
161500                                                                  16150029
161600     MOVE +1                       TO ASC-BLK-SUB.                16160029
161700                                                                  16170029
161800     PERFORM 5100-WRITE-TEMP-STORAGE.                             16180029
161900                                                                  16190029
162000     ADD +1                        TO ASC-BLK-SUB.                16200029
162100     PERFORM 2141-CLEAR-SELECTED-INDS                             16210029
162200         VARYING ASC-ITEM-SUB                                     16220029
162300         FROM 1 BY 1                                              16230029
162400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 16240029
162500                                                                  16250029
162600     PERFORM 5100-WRITE-TEMP-STORAGE.                             16260029
162700                                                                  16270029
162800     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               16280029
162900                                   TO PV-LIST-ITEM-NUMBER.        16290029
163000                                                                  16300029
163100     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            16310029
163200         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    16320029
163300                                                                  16330029
163400     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     16340029
163500        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      16350029
163600                                                                  16360029
163700         MOVE +1                   TO PV-BLOCK-NUMBER             16370029
163800                                                                  16380029
163900         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         16390029
164000             PV-FIRST-BLOCK-IN-ARRAY - 1                          16400029
164100                                                                  16410029
164200         PERFORM                                                  16420029
164300             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       16430029
164400                                                                  16440029
164500             PERFORM 4410-READ-TEMP-STORAGE                       16450029
164600                                                                  16460029
164700             PERFORM 2141-CLEAR-SELECTED-INDS                     16470029
164800                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 16480029
164900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          16490029
165000                                                                  16500029
165100             PERFORM 5100-WRITE-TEMP-STORAGE                      16510029
165200                                                                  16520029
165300             ADD +1                TO PV-BLOCK-NUMBER             16530029
165400                                                                  16540029
165500         END-PERFORM                                              16550029
165600                                                                  16560029
165700         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         16570029
165800             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     16580029
165900                                                                  16590029
166000         PERFORM                                                  16600029
166100             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       16610029
166200                   ASC-HIGHEST-BLOCK-WRITTEN                      16620029
166300                                                                  16630029
166400             MOVE PV-NEXT-BLOCK-IN-ARRAY                          16640029
166500                                   TO PV-BLOCK-NUMBER             16650029
166600                                                                  16660029
166700             PERFORM 4410-READ-TEMP-STORAGE                       16670029
166800                                                                  16680029
166900             PERFORM 2141-CLEAR-SELECTED-INDS                     16690029
167000                 VARYING ASC-ITEM-SUB                             16700029
167100                 FROM 1 BY 1                                      16710029
167200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          16720029
167300                                                                  16730029
167400             PERFORM 5100-WRITE-TEMP-STORAGE                      16740029
167500                                                                  16750029
167600             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      16760029
167700                                                                  16770029
167800         END-PERFORM                                              16780029
167900                                                                  16790029
168000         MOVE +1                   TO ASC-BLK-SUB                 16800029
168100         MOVE PV-FIRST-BLOCK-IN-ARRAY                             16810029
168200                                   TO PV-BLOCK-NUMBER             16820029
168300                                                                  16830029
168400         PERFORM 4410-READ-TEMP-STORAGE                           16840029
168500                                                                  16850029
168600         ADD +1                TO ASC-BLK-SUB                     16860029
168700                                  PV-BLOCK-NUMBER                 16870029
168800         PERFORM 4410-READ-TEMP-STORAGE                           16880029
168900     END-IF.                                                      16890029
169000                                                                  16900029
169100                                                                  16910029
169200     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 16920029
169300     MOVE +0                     TO ASC-START-OF-SELECTED-RANGE.  16930029
169400     MOVE +0                     TO ASC-END-OF-SELECTED-RANGE.    16940029
169500                                                                  16950029
169600     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        16960029
169700                                                                  16970029
169900*--------------------------------------------------------------*  16990057
170000* MARK EACH ITEM AS BEING NOT SELECTED.                        *  17000057
170100*--------------------------------------------------------------*  17010057
170300 2141-CLEAR-SELECTED-INDS.                                        17030029
170400                                                                  17040029
170500     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           17050029
170600             NOT EQUAL ZERO)                                      17060029
170700         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          17070029
170800             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          17080029
170900                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    17090029
171000                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  17100029
171100                                   TO TRUE                        17110029
171200             IF ASC-LINE-UPDATED (ASC-BLK-SUB ASC-ITEM-SUB)       17120029
171300                 MOVE SPACES       TO ASC-LINE-PROBLEM-SW         17130029
171400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  17140029
171500             ELSE                                                 17150029
171600                 MOVE SPACES       TO ASC-LINE-CHANGED-SW         17160029
171700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  17170029
171800                                      ASC-LINE-PROBLEM-SW         17180029
171900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  17190029
172000             END-IF                                               17200029
172100         END-IF                                                   17210029
172200     END-IF.                                                      17220029
172300                                                                  17230029
172500*--------------------------------------------------------------*  17250057
172600* IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH *  17260057
172700* FOR ALL ITEMS.                                               *  17270057
172800*--------------------------------------------------------------*  17280057
173000 2150-SELECT-ALL-ITEMS.                                           17300029
173100                                                                  17310029
173200     MOVE +1                       TO ASC-BLK-SUB.                17320029
173300                                                                  17330029
173400     PERFORM 2151-SET-SELECTED-INDS                               17340029
173500         VARYING ASC-ITEM-SUB                                     17350029
173600         FROM 1 BY 1                                              17360029
173700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 17370029
173800                                                                  17380029
173900     MOVE +1                       TO ASC-BLK-SUB.                17390029
174000                                                                  17400029
174100     PERFORM 5100-WRITE-TEMP-STORAGE.                             17410029
174200                                                                  17420029
174300     ADD +1                        TO ASC-BLK-SUB.                17430029
174400                                                                  17440029
174500     PERFORM 2151-SET-SELECTED-INDS                               17450029
174600         VARYING ASC-ITEM-SUB                                     17460029
174700         FROM 1 BY 1                                              17470029
174800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 17480029
174900                                                                  17490029
175000     PERFORM 5100-WRITE-TEMP-STORAGE.                             17500029
175100     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               17510029
175200                                   TO PV-LIST-ITEM-NUMBER.        17520029
175300                                                                  17530029
175400     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            17540029
175500         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    17550029
175600                                                                  17560029
175700     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     17570029
175800        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    17580029
175900         MOVE +1                   TO PV-BLOCK-NUMBER             17590029
176000                                                                  17600029
176100         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         17610029
176200             PV-FIRST-BLOCK-IN-ARRAY - 1                          17620029
176300                                                                  17630029
176400         PERFORM                                                  17640029
176500             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       17650029
176600                                                                  17660029
176700             PERFORM 4410-READ-TEMP-STORAGE                       17670029
176800                                                                  17680029
176900             PERFORM 2151-SET-SELECTED-INDS                       17690029
177000                 VARYING ASC-ITEM-SUB                             17700029
177100                 FROM 1 BY 1                                      17710029
177200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          17720029
177300                                                                  17730029
177400             PERFORM 5100-WRITE-TEMP-STORAGE                      17740029
177500                                                                  17750029
177600             ADD +1                TO PV-BLOCK-NUMBER             17760029
177700                                                                  17770029
177800         END-PERFORM                                              17780029
177900                                                                  17790029
178000         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         17800029
178100             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     17810029
178200                                                                  17820029
178300         PERFORM                                                  17830029
178400             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       17840029
178500                   ASC-HIGHEST-BLOCK-WRITTEN                      17850029
178600                                                                  17860029
178700             MOVE PV-NEXT-BLOCK-IN-ARRAY                          17870029
178800                                   TO PV-BLOCK-NUMBER             17880029
178900                                                                  17890029
179000             PERFORM 4410-READ-TEMP-STORAGE                       17900029
179100                                                                  17910029
179200             PERFORM 2151-SET-SELECTED-INDS                       17920029
179300                 VARYING ASC-ITEM-SUB                             17930029
179400                 FROM 1 BY 1                                      17940029
179500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          17950029
179600                                                                  17960029
179700             PERFORM 5100-WRITE-TEMP-STORAGE                      17970029
179800                                                                  17980029
179900             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      17990029
180000                                                                  18000029
180100         END-PERFORM                                              18010029
180200                                                                  18020029
180300         MOVE +1                   TO ASC-BLK-SUB                 18030029
180400         MOVE PV-FIRST-BLOCK-IN-ARRAY                             18040029
180500                                   TO PV-BLOCK-NUMBER             18050029
180600                                                                  18060029
180700         PERFORM 4410-READ-TEMP-STORAGE                           18070029
180800                                                                  18080029
180900         ADD +1                    TO PV-BLOCK-NUMBER             18090029
181000                                      ASC-BLK-SUB                 18100029
181100         PERFORM 4410-READ-TEMP-STORAGE                           18110029
181200     END-IF.                                                      18120029
181300                                                                  18130029
181400                                                                  18140029
181500     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             18150029
181600                       ASC-NUMBER-OF-SELECTED-ITEMS.              18160029
181700                                                                  18170029
181800     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        18180029
181900                                                                  18190029
182100*--------------------------------------------------------------*  18210057
182200* MARK EACH ITEM AS BEING SELECTED.                            *  18220057
182300*--------------------------------------------------------------*  18230057
182500 2151-SET-SELECTED-INDS.                                          18250029
182600                                                                  18260029
182700     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           18270029
182800             NOT EQUAL ZERO                                       18280029
182900         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             18290029
183000             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             18300029
183100                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        18310029
183200                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  18320029
183300                               TO  TRUE                           18330029
183400         END-IF                                                   18340029
183500     END-IF.                                                      18350029
183510                                                                  18351057
183520*--------------------------------------------------------------*  18352057
183530* MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    *  18353057
183531* SCREEN INTO THE COMMAREA.  ALL EDITING IS DONE IN THE COMM.  *  18353157
183540*--------------------------------------------------------------*  18354057
184000 2200-MOVE-SCREEN-TO-COMMAREA.                                    18400029
184100                                                                  18410029
184200     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             18420029
184300     MOVE +1                       TO PV-SUB.                     18430029
184400                                                                  18440057
184500     PERFORM 3100-SET-SUBSCRIPTS.                                 18450029
184600     IF  ASTRTITL > ZERO                                          18460029
184700         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          18470029
184800     ELSE                                                         18480029
184900         IF  ASTRTITF = DP015-ERASE-EOF                           18490029
185000             INITIALIZE ASC-START-ITEM-REQUEST                    18500029
185100         END-IF                                                   18510029
185200     END-IF.                                                      18520029
185300     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          18530029
185400         VARYING PV-SUB                                           18540029
185500         FROM 1 BY 1                                              18550029
185600         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      18560029
185610                                                                  18561057
185700*--------------------------------------------------------------*  18570057
185800* MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA*  18580057
185900*--------------------------------------------------------------*  18590057
186000 2210-MOVE-LINES-TO-COMMAREA.                                     18600029
186010                                                                  18601057
186100     IF  AP-SELECTL (PV-SUB) > ZERO                               18610029
186200         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             18620029
186300         MOVE AP-SELECT  (PV-SUB)                                 18630029
186400                                   TO ASC-TEMP-SELECTED-SW        18640029
186500                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      18650029
186600     ELSE                                                         18660029
186700         IF  AP-SELECTA (PV-SUB) = DP015-ERASE-EOF                18670029
186800                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     18680029
186900                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        18690029
187000                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      18700029
187100         END-IF                                                   18710029
187200     END-IF.                                                      18720029
187300     IF  AP-PIECESL (PV-SUB) > ZERO                               18730029
187400         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             18740029
187500         MOVE AP-PIECES (PV-SUB)   TO ASC-INP-PIECES              18750029
187600                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      18760029
187700         IF AP-PIECES (PV-SUB) = SPACES                           18770029
187800             SET ASC-LINE-NOT-CHANGED (ASC-BLK-SUB, ASC-ITEM-SUB) 18780029
187900                                   TO TRUE                        18790029
188000         ELSE                                                     18800029
188100             SET ASC-LINE-CHANGED (ASC-BLK-SUB, ASC-ITEM-SUB)     18810029
188200                                   TO TRUE                        18820029
188300         END-IF                                                   18830029
188400     ELSE                                                         18840029
188500         IF  AP-PIECESA (PV-SUB) = DP015-ERASE-EOF                18850029
188600             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                 18860029
188700                                 TO TRUE                          18870029
188800             MOVE SPACES         TO ASC-INP-PIECES                18880029
188900                                    (ASC-BLK-SUB, ASC-ITEM-SUB)   18890029
189000             MOVE ZEROES         TO ASC-PIECES                    18900029
189100                                    (ASC-BLK-SUB, ASC-ITEM-SUB)   18910029
189200             SET ASC-LINE-NOT-CHANGED                             18920029
189300                     (ASC-BLK-SUB, ASC-ITEM-SUB)                  18930029
189400                                 TO TRUE                          18940029
189500         END-IF                                                   18950029
189600     END-IF.                                                      18960029
189700     IF  AP-UNIT-COSTL (PV-SUB) > ZERO                            18970029
189800         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             18980029
189900         MOVE AP-UNIT-COST(PV-SUB)   TO ASC-INP-UNIT-COST         18990029
190000                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      19000029
190100         IF AP-UNIT-COST (PV-SUB) = SPACES                        19010029
190200             SET ASC-LINE-NOT-CHANGED (ASC-BLK-SUB, ASC-ITEM-SUB) 19020029
190300                                   TO TRUE                        19030029
190400         ELSE                                                     19040029
190500             SET ASC-LINE-CHANGED (ASC-BLK-SUB, ASC-ITEM-SUB)     19050029
190600                                   TO TRUE                        19060029
190700         END-IF                                                   19070029
190800     ELSE                                                         19080029
190900         IF  AP-UNIT-COSTA (PV-SUB) = DP015-ERASE-EOF             19090029
191000             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE         19100029
191100             MOVE SPACES           TO ASC-INP-UNIT-COST           19110029
191200                                     (ASC-BLK-SUB, ASC-ITEM-SUB)  19120029
191300             MOVE ZEROES           TO ASC-UNIT-COST               19130029
191400                                     (ASC-BLK-SUB, ASC-ITEM-SUB)  19140029
191500             SET ASC-LINE-NOT-CHANGED                             19150029
191600                         (ASC-BLK-SUB, ASC-ITEM-SUB)              19160029
191700                                   TO TRUE                        19170029
191800         END-IF                                                   19180029
191900     END-IF.                                                      19190029
192000     ADD +1                        TO ASC-ITEM-SUB.               19200029
192100     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        19210029
192200         ADD +1                    TO ASC-BLK-SUB                 19220029
192300         MOVE +1                   TO ASC-ITEM-SUB                19230029
192400     END-IF.                                                      19240029
192410                                                                  19241057
192500*--------------------------------------------------------------*  19250057
192600* WHEN A LOCAL AND GO FUNCTION KEY IS PRESSED THIS PARAGRAPH   *  19260057
192700* WILL MOVE ALL FIELDS NECESSARY TO THE INTER APPLICATION      *  19270057
192800* COMMAREA.                                                    *  19280057
192900*--------------------------------------------------------------*  19290057
193000 2400-PREPARE-INTER-APPL-COMM.                                    19300043
193010                                                                  19301057
193100     INITIALIZE AP300-INTER-APPL-COMMAREA.                        19310029
193200                                                                  19320029
193300     MOVE ASC-KEY-PO-NUMBER      TO AP300-PO-NBR.                 19330029
193400     MOVE ASC-KEY-INVOICE-ID     TO AP300-INVC-ID.                19340029
193500     MOVE ASC-KEY-PAYT-REQ-SEQ-NBR                                19350029
193600                                 TO AP300-REC-SEQ-NBR.            19360029
193700     MOVE ASC-KEY-STORE-NUMBER   TO AP300-STORE-NBR.              19370029
193800     MOVE ASC-KEY-DEPT-NBR       TO AP300-DEPT-NBR.               19380029
193810     MOVE ASC-KEY-DC-NBR         TO AP300-DC-NBR.                 19381040
193820     MOVE PV-MTCH-LVL-CDE        TO AP300-MTCH-LVL-IND.           19382046
193900                                                                  19390029
194000     IF ASC-NUMBER-OF-SELECTED-ITEMS > 0                          19400029
194100         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        19410029
194200                                 TO AP300-NUMBER-OF-SELECTED-ITEMS19420029
194300         PERFORM 5000-PREPARE-SEL-QUEUE                           19430029
194400     ELSE                                                         19440029
194500         MOVE 0  TO AP300-NUMBER-OF-SELECTED-ITEMS                19450029
194600         PERFORM 5000-PREPARE-SEL-QUEUE                           19460029
194700         SET ASC-NO-TSQ-UPDATE                                    19470029
194800                                 TO TRUE                          19480029
194900     END-IF.                                                      19490029
195000                                                                  19500029
195010*--------------------------------------------------------------*  19501057
195020* EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      *  19502057
195030* COMMAREA (EDITING IS NOT DONE AGAINST THE SCREEN DISPLAY).   *  19503057
195050*--------------------------------------------------------------*  19505057
195500 3000-EDIT-DATA-IN-COMMAREA.                                      19550029
195510                                                                  19551057
195600     SET PS-NO-ERROR               TO TRUE.                       19560029
195700     PERFORM 3200-RESET-ATTRIBUTES.                               19570029
195800     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     19580029
195900                                                                  19590057
196000* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              19600029
196100* EDITTING IS DONE FROM THE BOTTOM UP.                            19610029
196300     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       19630029
196400         ASC-ITEMS-DISPLAYED - 1.                                 19640029
196500     PERFORM 3100-SET-SUBSCRIPTS.                                 19650029
196600     PERFORM 3300-EDIT-SELECTIONS                                 19660029
196700         VARYING PV-SUB                                           19670029
196800         FROM PV-SUB BY -1                                        19680029
196900         UNTIL PV-SUB < +1                                        19690029
197000                                                                  19700057
197100     IF  PS-NO-ERROR                                              19710029
197200         PERFORM 3400-CHECK-RANGE-SEQUENCE                        19720029
197300     END-IF.                                                      19730029
197400                                                                  19740057
197500     IF  ((PS-NO-ERROR)                                           19750029
197600       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   19760029
197700       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    19770029
197800             PERFORM 3500-MARK-RANGE-AS-SELECTED                  19780029
197900     END-IF.                                                      19790029
198000                                                                  19800029
198200*--------------------------------------------------------------*  19820057
198300* DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM  *  19830057
198400* CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL *  19840057
198500* POSITION US IN THE 1ST BLOCK OF THE ARRAY.                   *  19850057
198600*                                                              *  19860057
198700* IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS    *  19870057
198800* IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT     *  19880057
198900* THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION   *  19890057
199000* US IN THE 2ND BLOCK OF THE ARRAY.                            *  19900057
199100*--------------------------------------------------------------*  19910057
199300 3100-SET-SUBSCRIPTS.                                             19930029
199400                                                                  19940029
199500     COMPUTE ASC-ITEM-SUB =                                       19950029
199600         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        19960029
199700                                                                  19970029
199800     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         19980029
199900         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            19990029
200000                                                                  20000029
200100         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               20010029
200200     ELSE                                                         20020029
200300         MOVE +1                     TO ASC-BLK-SUB               20030029
200400     END-IF.                                                      20040029
200410                                                                  20041057
200500*--------------------------------------------------------------*  20050057
200600* RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     *  20060057
200700*--------------------------------------------------------------*  20070057
200900 3200-RESET-ATTRIBUTES.                                           20090029
200910                                                                  20091057
201000     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   20100029
201100     MOVE DP015-GREEN              TO ASTRTITC.                   20110029
201200     MOVE DP015-UNDERLINE          TO ASTRTITH.                   20120029
201300                                                                  20130057
201400     PERFORM                                                      20140029
201500         VARYING PV-SUB                                           20150029
201600         FROM 1 BY 1                                              20160029
201700         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        20170029
201800         MOVE DP015-PRO-NOR-OFF                                   20180029
201900                               TO AP-PIECESA(PV-SUB)              20190029
202000                                  AP-UNIT-COSTA(PV-SUB)           20200029
202100         MOVE DP015-BLUE       TO AP-PIECESC (PV-SUB)             20210029
202200                                  AP-UNIT-COSTC(PV-SUB)           20220029
202300         MOVE DP015-HL-OFF     TO AP-PIECESH (PV-SUB)             20230029
202400                                  AP-UNIT-COSTH(PV-SUB)           20240029
202500         MOVE DP015-UNP-ALP-NOR-OFF                               20250029
202600                               TO AP-SELECTA (PV-SUB)             20260029
202700         MOVE DP015-GREEN      TO AP-SELECTC (PV-SUB)             20270029
202800         MOVE DP015-UNDERLINE  TO AP-SELECTH (PV-SUB)             20280029
202900     END-PERFORM.                                                 20290029
202910                                                                  20291057
203000*--------------------------------------------------------------*  20300057
203100* EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    *  20310057
203200* WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   *  20320057
203300* IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    *  20330057
203400* WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             *  20340057
203500*--------------------------------------------------------------*  20350057
203600 3300-EDIT-SELECTIONS.                                            20360029
203610                                                                  20361057
203700     EVALUATE TRUE                                                20370029
203800         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     20380029
203900             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         20390029
204000                 CONTINUE                                         20400029
204100         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         20410029
204200             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        20420029
204300                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   20430029
204400                 MOVE ASC-TEMP-SELECTED-SW                        20440029
204500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  20450029
204600                                TO ASC-SELECTED-SW                20460029
204700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  20470029
204800                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)             20480029
204900                                TO TRUE                           20490029
205000             END-IF                                               20500029
205100         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     20510029
205200                 = SPACE                                          20520029
205300             EVALUATE TRUE                                        20530029
205400                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       20540029
205500                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS20550029
205600                     MOVE SPACE TO ASC-SELECTED-SW                20560029
205700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  20570029
205800                     SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)         20580029
205900                                TO TRUE                           20590029
206000                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        20600029
206100                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    20610029
206200                     MOVE SPACE TO ASC-SELECTED-SW                20620029
206300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  20630029
206400                     SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)         20640029
206500                                TO TRUE                           20650029
206600                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          20660029
206700                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      20670029
206800                     MOVE SPACE TO ASC-SELECTED-SW                20680029
206900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  20690029
207000                     SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)         20700029
207100                                TO TRUE                           20710029
207200             END-EVALUATE                                         20720029
207300         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           20730029
207400             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            20740029
207500                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    20750029
207600             END-IF                                               20760029
207700             PERFORM 3310-EDIT-RANGE                              20770029
207800         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             20780029
207900             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            20790029
208000                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    20800029
208100             END-IF                                               20810029
208200             PERFORM 3310-EDIT-RANGE                              20820029
208300         WHEN OTHER                                               20830029
208400             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           20840029
208500             SET DP020-MSG-FATAL    TO TRUE                       20850029
208600             MOVE -1                TO AP-SELECTL (PV-SUB)        20860029
208700             SET DP030-SET-CURSOR-APPL-1                          20870029
208800                                    TO TRUE                       20880029
208900             MOVE DP015-RED         TO AP-SELECTC (PV-SUB)        20890029
209000             MOVE DP015-REVERSE     TO AP-SELECTH (PV-SUB)        20900029
209100             SET PS-ERROR TO TRUE                                 20910029
209200             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            20920029
209300                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     20930029
209400                 MOVE SPACE         TO ASC-SELECTED-SW            20940029
209500                                        (ASC-BLK-SUB ASC-ITEM-SUB)20950029
209600             END-IF                                               20960029
209700     END-EVALUATE.                                                20970029
209800                                                                  20980029
209900     IF (ASC-LINE-CHANGED (ASC-BLK-SUB ASC-ITEM-SUB))             20990029
210000         MOVE ASC-INP-PIECES (ASC-BLK-SUB ASC-ITEM-SUB)           21000029
210100                                 TO DP010I-UNEDITED-FIELD         21010029
210200         MOVE LENGTH OF ASC-INP-PIECES                            21020029
210300                                 TO DP010I-MAXIMUM-DIGITS         21030029
210400         MOVE +3                 TO DP010I-MAXIMUM-DECIMALS       21040029
210500         SET DP010I-NEGATIVE-NOT-ALLOWED                          21050029
210600                                 TO TRUE                          21060029
210720         CALL DP010I-NUMERIC-EDIT-ROUTINE                         21072065
210730                         USING DP010I-NUMERIC-EDIT-AREA           21073065
210800         IF DP010I-ERROR-DETECTED                                 21080029
210900             SET PS-ERROR        TO TRUE                          21090029
211000             SET ASC-LINE-ERROR(ASC-BLK-SUB ASC-ITEM-SUB)         21100029
211100                                 TO TRUE                          21110029
211200             SET DP020-MSG-FATAL TO TRUE                          21120029
211300             MOVE PC-TSYMSG-00008                                 21130029
211400                                 TO DP020-MSG-NUMBER              21140029
211500             MOVE DP015-UNP-NUM-BRT-OFF                           21150029
211600                                 TO AP-PIECESA (PV-SUB)           21160029
211700             MOVE DP015-RED      TO AP-PIECESC (PV-SUB)           21170029
211800             MOVE DP015-REVERSE  TO AP-PIECESH (PV-SUB)           21180029
211900             MOVE -1             TO AP-PIECESL (PV-SUB)           21190029
212000             SET DP030-SET-CURSOR-APPL-1                          21200029
212100                                 TO TRUE                          21210029
212200         ELSE                                                     21220029
212300             MOVE DP010I-NUMERIC-FIELD                            21230029
212400                                 TO ASC-PIECES                    21240029
212500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21250029
212600             IF (ASC-PIECES (ASC-BLK-SUB ASC-ITEM-SUB)            21260029
212700                     < ZERO)                                      21270029
212800                 SET PS-ERROR    TO TRUE                          21280029
212900                 SET ASC-LINE-ERROR(ASC-BLK-SUB ASC-ITEM-SUB)     21290029
213000                                 TO TRUE                          21300029
213100                 SET DP020-MSG-FATAL                              21310029
213200                                 TO TRUE                          21320029
213300                 MOVE PC-TSYMSG-00008                             21330029
213400                                 TO DP020-MSG-NUMBER              21340029
213500                 MOVE DP015-UNP-NUM-BRT-OFF                       21350029
213600                                 TO AP-PIECESA (PV-SUB)           21360029
213700                 MOVE DP015-RED  TO AP-PIECESC (PV-SUB)           21370029
213800                 MOVE DP015-REVERSE                               21380029
213900                                 TO AP-PIECESH (PV-SUB)           21390029
214000                 MOVE -1         TO AP-PIECESL (PV-SUB)           21400029
214100                 SET DP030-SET-CURSOR-APPL-1                      21410029
214200                                 TO TRUE                          21420029
214300             END-IF                                               21430029
214400         END-IF                                                   21440029
214500         MOVE ASC-INP-UNIT-COST (ASC-BLK-SUB ASC-ITEM-SUB)        21450029
214600                                 TO DP010I-UNEDITED-FIELD         21460029
214700         MOVE LENGTH OF ASC-INP-UNIT-COST                         21470029
214800                                 TO DP010I-MAXIMUM-DIGITS         21480029
214900         MOVE +3                 TO DP010I-MAXIMUM-DECIMALS       21490029
215000         SET DP010I-NEGATIVE-NOT-ALLOWED                          21500029
215100                                 TO TRUE                          21510029
215220         CALL DP010I-NUMERIC-EDIT-ROUTINE                         21522065
215230                         USING DP010I-NUMERIC-EDIT-AREA           21523065
215300         IF DP010I-ERROR-DETECTED                                 21530029
215400             SET PS-ERROR        TO TRUE                          21540029
215500             SET ASC-LINE-ERROR(ASC-BLK-SUB ASC-ITEM-SUB)         21550029
215600                                 TO TRUE                          21560029
215700             SET DP020-MSG-FATAL TO TRUE                          21570029
215800             MOVE PC-TSYMSG-00008                                 21580029
215900                                 TO DP020-MSG-NUMBER              21590029
216000             MOVE DP015-UNP-NUM-BRT-OFF                           21600029
216100                                 TO AP-UNIT-COSTA (PV-SUB)        21610029
216200             MOVE DP015-RED      TO AP-UNIT-COSTC (PV-SUB)        21620029
216300             MOVE DP015-REVERSE  TO AP-UNIT-COSTH (PV-SUB)        21630029
216400             MOVE -1             TO AP-UNIT-COSTL (PV-SUB)        21640029
216500             SET DP030-SET-CURSOR-APPL-1                          21650029
216600                                 TO TRUE                          21660029
216700         ELSE                                                     21670029
216800             MOVE DP010I-NUMERIC-FIELD                            21680029
216900                                 TO ASC-UNIT-COST                 21690029
217000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21700029
217100             IF (ASC-UNIT-COST (ASC-BLK-SUB ASC-ITEM-SUB)         21710029
217200                     < ZERO)                                      21720029
217300                 SET PS-ERROR    TO TRUE                          21730029
217400                 SET ASC-LINE-ERROR(ASC-BLK-SUB ASC-ITEM-SUB)     21740029
217500                                 TO TRUE                          21750029
217600                 SET DP020-MSG-FATAL                              21760029
217700                                 TO TRUE                          21770029
217800                 MOVE PC-TSYMSG-00008                             21780029
217900                                 TO DP020-MSG-NUMBER              21790029
218000                 MOVE DP015-UNP-NUM-BRT-OFF                       21800029
218100                                 TO AP-UNIT-COSTA (PV-SUB)        21810029
218200                 MOVE DP015-RED  TO AP-UNIT-COSTC (PV-SUB)        21820029
218300                 MOVE DP015-REVERSE                               21830029
218400                                 TO AP-UNIT-COSTH (PV-SUB)        21840029
218500                 MOVE -1         TO AP-UNIT-COSTL (PV-SUB)        21850029
218600                 SET DP030-SET-CURSOR-APPL-1                      21860029
218700                                 TO TRUE                          21870029
218800             END-IF                                               21880029
218900         END-IF                                                   21890029
219000     END-IF.                                                      21900029
219100     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 21910029
219200     SUBTRACT +1 FROM ASC-ITEM-SUB.                               21920029
219300     IF  ASC-ITEM-SUB < 1                                         21930029
219400         SUBTRACT +1 FROM ASC-BLK-SUB                             21940029
219500         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                21950029
219600     END-IF.                                                      21960029
219610                                                                  21961057
219700*--------------------------------------------------------------*  21970057
219800* IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      *  21980057
219900* RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    *  21990057
220000* ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)*  22000057
220100* THE ENDING.                                                  *  22010057
220200*--------------------------------------------------------------*  22020057
220300 3310-EDIT-RANGE.                                                 22030029
220310                                                                  22031057
220400     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                22040029
220500         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   22050029
220600             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)22060029
220700                                   TO ASC-SELECTED-SW             22070029
220800                                        (ASC-BLK-SUB ASC-ITEM-SUB)22080029
220900             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 22090029
221000         ELSE                                                     22100029
221100             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     22110029
221200                 CONTINUE                                         22120029
221300             ELSE                                                 22130029
221400*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        22140029
221500                 MOVE PC-TSYMSG-00054                             22150029
221600                                   TO DP020-MSG-NUMBER            22160029
221700                 SET DP020-MSG-FATAL                              22170029
221800                                   TO TRUE                        22180029
221900                 MOVE -1           TO AP-SELECTL (PV-SUB)         22190029
222000                 SET DP030-SET-CURSOR-APPL-1                      22200029
222100                                   TO TRUE                        22210029
222200                 MOVE DP015-RED    TO AP-SELECTC (PV-SUB)         22220029
222300                 MOVE DP015-UNDERLINE                             22230029
222400                                   TO AP-SELECTH (PV-SUB)         22240029
222500                 SET PS-ERROR      TO TRUE                        22250029
222600             END-IF                                               22260029
222700         END-IF                                                   22270029
222800     ELSE                                                         22280029
222900         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     22290029
223000             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 22300029
223100                                   TO ASC-SELECTED-SW             22310029
223200                                     (ASC-BLK-SUB ASC-ITEM-SUB)   22320029
223300             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   22330029
223400         ELSE                                                     22340029
223500             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       22350029
223600                 CONTINUE                                         22360029
223700             ELSE                                                 22370029
223800*                -- ONLY ONE END-OF-RANGE ALLOWED --              22380029
223900                 MOVE PC-TSYMSG-00055                             22390029
224000                                   TO DP020-MSG-NUMBER            22400029
224100                 SET DP020-MSG-FATAL                              22410029
224200                                   TO TRUE                        22420029
224300                 MOVE -1           TO AP-SELECTL (PV-SUB)         22430029
224400                 SET DP030-SET-CURSOR-APPL-1                      22440029
224500                                   TO TRUE                        22450029
224600                 SET PS-ERROR      TO TRUE                        22460029
224700             END-IF                                               22470029
224800         END-IF                                                   22480029
224900     END-IF.                                                      22490029
225000                                                                  22500057
225100*--------------------------------------------------------------*  22510057
225200* IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    *  22520057
225300* MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  *  22530057
225400*--------------------------------------------------------------*  22540057
225500 3400-CHECK-RANGE-SEQUENCE.                                       22550029
225510                                                                  22551057
225600     IF (ASC-START-OF-SELECTED-RANGE > ZERO)                      22560029
225700       AND (ASC-END-OF-SELECTED-RANGE > ZERO)                     22570029
225800       AND (ASC-START-OF-SELECTED-RANGE >                         22580029
225900                ASC-END-OF-SELECTED-RANGE)                        22590029
226000*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                22600029
226100         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 22610029
226200         SET DP020-MSG-FATAL TO TRUE                              22620029
226300         SET PS-ERROR TO TRUE                                     22630029
226400         PERFORM 3410-POSITION-AT-ERROR                           22640029
226500     END-IF.                                                      22650029
226510                                                                  22651057
226600*--------------------------------------------------------------*  22660057
226700* BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    *  22670057
226800* PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR *  22680057
226900* SHOULD BE POSITIONED ON A RANGE ERROR.                       *  22690057
227000*--------------------------------------------------------------*  22700057
227100 3410-POSITION-AT-ERROR.                                          22710029
227110                                                                  22711057
227200     SET DP030-SET-CURSOR-APPL-1                                  22720029
227300                                   TO TRUE.                       22730029
227400     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 22740029
227500                    - PV-TOP-ITEM + 1.                            22750029
227600     IF (PV-SUB < +1 OR > PC-ITEMS-PER-PANEL)                     22760029
227700         CONTINUE                                                 22770029
227800     ELSE                                                         22780029
227900         MOVE -1                   TO AP-SELECTL (PV-SUB)         22790029
228000         MOVE DP015-REVERSE        TO AP-SELECTH (PV-SUB)         22800029
228100         MOVE DP015-RED            TO AP-SELECTC (PV-SUB)         22810029
228200     END-IF.                                                      22820029
228300                                                                  22830058
228400     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   22840029
228500                    - PV-TOP-ITEM + 1.                            22850029
228600     IF (PV-SUB < +1 OR > PC-ITEMS-PER-PANEL)                     22860029
228700         CONTINUE                                                 22870029
228800     ELSE                                                         22880029
228900         MOVE -1                   TO AP-SELECTL (PV-SUB)         22890029
229000         MOVE DP015-REVERSE        TO AP-SELECTH (PV-SUB)         22900029
229100         MOVE DP015-RED            TO AP-SELECTC (PV-SUB)         22910029
229200     END-IF.                                                      22920029
229300                                                                  22930058
229400*--------------------------------------------------------------*  22940058
229500* WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE     *  22950058
229600* AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS     *  22960058
229700* THOSE THAT FALL IN THE RANGE AS BEING SELECTED.              *  22970058
229800*--------------------------------------------------------------*  22980058
230000 3500-MARK-RANGE-AS-SELECTED.                                     23000029
230010                                                                  23001058
230100     MOVE +1                       TO  ASC-BLK-SUB.               23010029
230200     PERFORM 3510-MARK-SELECTED-INDS                              23020029
230300         VARYING ASC-ITEM-SUB                                     23030029
230400         FROM 1 BY 1                                              23040029
230500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 23050029
230600     MOVE +1                       TO ASC-BLK-SUB.                23060029
230700     PERFORM 5100-WRITE-TEMP-STORAGE.                             23070029
230800                                                                  23080029
230900     ADD +1                        TO ASC-BLK-SUB.                23090029
231000     PERFORM 3510-MARK-SELECTED-INDS                              23100029
231100         VARYING ASC-ITEM-SUB                                     23110029
231200         FROM 1 BY 1                                              23120029
231300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 23130029
231400     PERFORM 5100-WRITE-TEMP-STORAGE.                             23140029
231500                                                                  23150029
231600     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               23160029
231700                                   TO  PV-LIST-ITEM-NUMBER.       23170029
231800     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            23180029
231900         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         23190029
232000               PC-ITEMS-PER-PANEL).                               23200029
232100                                                                  23210029
232200     MOVE ASC-START-OF-SELECTED-RANGE                             23220029
232300                                   TO PV-START-OF-SELECTED-RANGE. 23230029
232400     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            23240029
232500         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  23250029
232600               PC-ITEMS-PER-PANEL).                               23260029
232700                                                                  23270029
232800     MOVE ASC-END-OF-SELECTED-RANGE                               23280029
232900                                   TO  PV-END-OF-SELECTED-RANGE.  23290029
233000     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             23300029
233100         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    23310029
233200               PC-ITEMS-PER-PANEL).                               23320029
233300     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             23330029
233400         PV-FIRST-BLOCK-IN-ARRAY + 1.                             23340029
233500                                                                  23350029
233600     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    23360029
233700        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        23370029
233800         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         23380029
233900             PV-FIRST-BLOCK-IN-ARRAY - 1                          23390029
234000                                                                  23400029
234100         PERFORM                                                  23410029
234200             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      23420029
234300                   PV-PREV-BLOCK-IN-ARRAY                         23430029
234400             MOVE PV-FIRST-BLOCK-IN-RANGE                         23440029
234500                                   TO PV-BLOCK-NUMBER             23450029
234600             PERFORM 4410-READ-TEMP-STORAGE                       23460029
234700             PERFORM 3510-MARK-SELECTED-INDS                      23470029
234800                 VARYING ASC-ITEM-SUB                             23480029
234900                 FROM 1 BY 1                                      23490029
235000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          23500029
235100             PERFORM 5100-WRITE-TEMP-STORAGE                      23510029
235200             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     23520029
235300         END-PERFORM                                              23530029
235400                                                                  23540029
235500         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         23550029
235600             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     23560029
235700         PERFORM                                                  23570029
235800             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       23580029
235900                   PV-LAST-BLOCK-IN-RANGE                         23590029
236000             MOVE PV-NEXT-BLOCK-IN-ARRAY                          23600029
236100                                   TO PV-BLOCK-NUMBER             23610029
236200             PERFORM 4410-READ-TEMP-STORAGE                       23620029
236300             PERFORM 3510-MARK-SELECTED-INDS                      23630029
236400                 VARYING ASC-ITEM-SUB                             23640029
236500                 FROM 1 BY 1                                      23650029
236600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          23660029
236700             PERFORM 5100-WRITE-TEMP-STORAGE                      23670029
236800             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      23680029
236900         END-PERFORM                                              23690029
237000                                                                  23700029
237100         MOVE +1                   TO ASC-BLK-SUB                 23710029
237200         MOVE PV-FIRST-BLOCK-IN-ARRAY                             23720029
237300                                   TO PV-BLOCK-NUMBER             23730029
237400         PERFORM 4410-READ-TEMP-STORAGE                           23740029
237500                                                                  23750029
237600         ADD +1                    TO PV-BLOCK-NUMBER             23760029
237700                                      ASC-BLK-SUB                 23770029
237800         PERFORM 4410-READ-TEMP-STORAGE                           23780029
237900     END-IF.                                                      23790029
238000                                                                  23800029
238100     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 23810029
238200                                      ASC-END-OF-SELECTED-RANGE.  23820029
238300                                                                  23830029
238500*--------------------------------------------------------------*  23850058
238600* PROCESSES THROUGHT THE SELECTED ITEMS AND EDITS FIRST FOR    *  23860058
238700* ERRORS AND THEN FOR WARNINGS                                 *  23870058
238800*--------------------------------------------------------------*  23880058
238900 3700-EDIT-SELECTED-ITEMS.                                        23890029
238910                                                                  23891058
239000     MOVE 0                      TO PV-FIRST-ERROR-ITEM           23900029
239100                                    PV-FIRST-WARNING-ITEM         23910029
239200                                    PV-SUB.                       23920029
239300                                                                  23930029
239400     COMPUTE PV-BOTTOM-ITEM =                                     23940029
239500         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1.                    23950029
239600                                                                  23960029
239700     MOVE +1                     TO ASC-BLK-SUB.                  23970029
239800     PERFORM                                                      23980029
239900         VARYING ASC-ITEM-SUB                                     23990029
240000         FROM 1 BY 1                                              24000029
240100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                  24010029
240200                                                                  24020029
240300         IF (ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB) AND            24030029
240400             NOT ASC-LINE-UPDATED (ASC-BLK-SUB ASC-ITEM-SUB))     24040029
240500             PERFORM 3710-EDIT-ITEM                               24050029
240600         ELSE                                                     24060029
240700            IF NOT ASC-LINE-OK (ASC-BLK-SUB ASC-ITEM-SUB)         24070029
240800                SET ASC-LINE-OK (ASC-BLK-SUB ASC-ITEM-SUB)        24080029
240900                                 TO TRUE                          24090029
241000                SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)              24100029
241100                                 TO TRUE                          24110029
241200            END-IF                                                24120029
241300         END-IF                                                   24130029
241400                                                                  24140029
241500     END-PERFORM                                                  24150029
241600     MOVE +1                     TO ASC-BLK-SUB.                  24160029
241700     PERFORM 5100-WRITE-TEMP-STORAGE.                             24170029
241800                                                                  24180029
241900     ADD +1                      TO ASC-BLK-SUB.                  24190029
242000     PERFORM                                                      24200029
242100         VARYING ASC-ITEM-SUB                                     24210029
242200         FROM 1 BY 1                                              24220029
242300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                  24230029
242400                                                                  24240029
242500         IF (ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB) AND            24250029
242600             NOT ASC-LINE-UPDATED (ASC-BLK-SUB ASC-ITEM-SUB))     24260029
242700             PERFORM 3710-EDIT-ITEM                               24270029
242800         ELSE                                                     24280029
242900            IF NOT ASC-LINE-OK (ASC-BLK-SUB ASC-ITEM-SUB)         24290029
243000                SET ASC-LINE-OK (ASC-BLK-SUB ASC-ITEM-SUB)        24300029
243100                                 TO TRUE                          24310029
243200                SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)              24320029
243300                                 TO TRUE                          24330029
243400            END-IF                                                24340029
243500         END-IF                                                   24350029
243600                                                                  24360029
243700     END-PERFORM                                                  24370029
243800     PERFORM 5100-WRITE-TEMP-STORAGE.                             24380029
243900                                                                  24390029
244000     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              24400029
244100                                 TO PV-LIST-ITEM-NUMBER.          24410029
244200     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            24420029
244300         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    24430029
244400                                                                  24440029
244500     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     24450029
244600        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      24460029
244700                                                                  24470029
244800         MOVE +1                 TO PV-BLOCK-NUMBER               24480029
244900                                                                  24490029
245000         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         24500029
245100             PV-FIRST-BLOCK-IN-ARRAY - 1                          24510029
245200         PERFORM                                                  24520029
245300             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       24530029
245400                                                                  24540029
245500             PERFORM 4410-READ-TEMP-STORAGE                       24550029
245600                                                                  24560029
245700             PERFORM                                              24570029
245800                 VARYING ASC-ITEM-SUB                             24580029
245900                 FROM 1 BY 1                                      24590029
246000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          24600029
246100                                                                  24610029
246200                 IF (ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB) AND    24620029
246300                     NOT ASC-LINE-UPDATED                         24630029
246400                             (ASC-BLK-SUB ASC-ITEM-SUB))          24640029
246500                     PERFORM 3710-EDIT-ITEM                       24650029
246600                 ELSE                                             24660029
246700                    IF NOT ASC-LINE-OK (ASC-BLK-SUB ASC-ITEM-SUB) 24670029
246800                        SET ASC-LINE-OK (ASC-BLK-SUB ASC-ITEM-SUB)24680029
246900                                 TO TRUE                          24690029
247000                        SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)      24700029
247100                                 TO TRUE                          24710029
247200                    END-IF                                        24720029
247300                 END-IF                                           24730029
247400                                                                  24740029
247500             END-PERFORM                                          24750029
247600                                                                  24760029
247700             PERFORM 5100-WRITE-TEMP-STORAGE                      24770029
247800                                                                  24780029
247900             ADD +1              TO PV-BLOCK-NUMBER               24790029
248000         END-PERFORM                                              24800029
248100                                                                  24810029
248200         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         24820029
248300             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     24830029
248400                                                                  24840029
248500         PERFORM                                                  24850029
248600             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       24860029
248700                   ASC-HIGHEST-BLOCK-WRITTEN                      24870029
248800                                                                  24880029
248900             MOVE PV-NEXT-BLOCK-IN-ARRAY                          24890029
249000                                 TO PV-BLOCK-NUMBER               24900029
249100             PERFORM 4410-READ-TEMP-STORAGE                       24910029
249200             PERFORM                                              24920029
249300                 VARYING ASC-ITEM-SUB                             24930029
249400                 FROM 1 BY 1                                      24940029
249500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          24950029
249600                                                                  24960029
249700                 IF (ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB) AND    24970029
249800                     NOT ASC-LINE-UPDATED                         24980029
249900                             (ASC-BLK-SUB ASC-ITEM-SUB))          24990029
250000                     PERFORM 3710-EDIT-ITEM                       25000029
250100                 ELSE                                             25010029
250200                    IF NOT ASC-LINE-OK (ASC-BLK-SUB ASC-ITEM-SUB) 25020029
250300                        SET ASC-LINE-OK (ASC-BLK-SUB ASC-ITEM-SUB)25030029
250400                                 TO TRUE                          25040029
250500                        SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)      25050029
250600                                 TO TRUE                          25060029
250700                    END-IF                                        25070029
250800                 END-IF                                           25080029
250900                                                                  25090029
251000             END-PERFORM                                          25100029
251100                                                                  25110029
251200             PERFORM 5100-WRITE-TEMP-STORAGE                      25120029
251300                                                                  25130029
251400             ADD +1              TO PV-NEXT-BLOCK-IN-ARRAY        25140029
251500         END-PERFORM                                              25150029
251600                                                                  25160029
251700         MOVE +1                   TO ASC-BLK-SUB                 25170029
251800         MOVE PV-FIRST-BLOCK-IN-ARRAY                             25180029
251900                                 TO PV-BLOCK-NUMBER               25190029
252000         PERFORM 4410-READ-TEMP-STORAGE                           25200029
252100                                                                  25210029
252200         ADD +1                    TO PV-BLOCK-NUMBER             25220029
252300                                      ASC-BLK-SUB                 25230029
252400         PERFORM 4410-READ-TEMP-STORAGE                           25240029
252500     END-IF.                                                      25250029
252600                                                                  25260029
252800*--------------------------------------------------------------*  25280058
252900* DOES ALL EDITS ON A SELECTED ITEM                            *  25290058
253000*--------------------------------------------------------------*  25300058
253100 3710-EDIT-ITEM.                                                  25310029
253110                                                                  25311058
253200     SET ASC-LINE-OK(ASC-BLK-SUB ASC-ITEM-SUB)                    25320029
253300                                 TO TRUE.                         25330029
253400     SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                         25340029
253500                                 TO TRUE.                         25350029
253600     IF ASC-PIECES (ASC-BLK-SUB ASC-ITEM-SUB) = ZERO              25360029
253700         SET PS-LINE-ERROR       TO TRUE                          25370029
253800         SET PS-ERROR-ON-LINE    TO TRUE                          25380029
253900         SET ASC-LINE-ERROR (ASC-BLK-SUB ASC-ITEM-SUB)            25390029
254000                                 TO TRUE                          25400029
254100         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     25410029
254200                                 TO  TRUE                         25420029
254300         IF (ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)      25430029
254400               < PV-FIRST-ERROR-ITEM) OR                          25440029
254500            (PV-FIRST-ERROR-ITEM = ZERO)                          25450029
254600                                                                  25460029
254700             MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) 25470029
254800                                 TO PV-FIRST-ERROR-ITEM           25480029
254900         END-IF                                                   25490029
255000         IF ((ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)     25500029
255100                  >= PV-TOP-ITEM) AND                             25510029
255200              (ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)    25520029
255300                  <= PV-BOTTOM-ITEM))                             25530029
255400             SET PS-ERROR       TO TRUE                           25540029
255500         END-IF                                                   25550029
255600     END-IF.                                                      25560029
255700                                                                  25570029
255800*--------------------------------------------------------------*  25580058
255900* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.         *  25590058
256000*--------------------------------------------------------------*  25600058
256200 3510-MARK-SELECTED-INDS.                                         25620029
256300                                                                  25630029
256400     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         25640029
256500                                ASC-ITEM-SUB) >                   25650029
256600         ASC-START-OF-SELECTED-RANGE)                             25660029
256700     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         25670029
256800                                ASC-ITEM-SUB) =                   25680029
256900         ASC-START-OF-SELECTED-RANGE)                             25690029
257000                                                                  25700029
257100         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     25710029
257200                                    ASC-ITEM-SUB) <               25720029
257300             ASC-END-OF-SELECTED-RANGE)                           25730029
257400         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     25740029
257500                                    ASC-ITEM-SUB) =               25750029
257600             ASC-END-OF-SELECTED-RANGE)                           25760029
257700                                                                  25770029
257800             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          25780029
257900                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   25790029
258000                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   25800029
258100                               TO TRUE                            25810029
258200                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              25820029
258300                               TO TRUE                            25830029
258400                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    25840029
258500             END-IF                                               25850029
258600         END-IF                                                   25860029
258700     END-IF.                                                      25870029
258800                                                                  25880029
259000*--------------------------------------------------------------*  25900058
259100* INITIALIZE BOTH BLOCKS IN THE ARRAY.                         *  25910058
259200* INITIALIZE ALL COUNTERS AND FLAGS.                           *  25920058
259300* READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.   *  25930058
259400* DISPLAY THE PANEL TO USER.                                   *  25940058
259500*--------------------------------------------------------------*  25950058
259700 4000-BUILD-INITIAL-PANEL.                                        25970029
259800                                                                  25980029
259900     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            25990029
260000                                 ASC-BLOCK-ENTRIES (2).           26000029
260100     MOVE +1                 TO ASC-BLK-SUB.                      26010029
260200     SET ASC-ITEMS-LEFT-ON-DB                                     26020029
260300                             TO TRUE.                             26030029
260400                                                                  26040029
260500     MOVE +0                 TO ASC-ITEM-SUB                      26050029
260600                                ASC-NUMBER-OF-ITEMS-READ          26060029
260700                                ASC-NUMBER-OF-SELECTED-ITEMS      26070029
260800                                ASC-HIGHEST-BLOCK-WRITTEN         26080029
260900                                ASC-START-OF-SELECTED-RANGE       26090029
261000                                ASC-END-OF-SELECTED-RANGE         26100029
261100                                ASC-ITEM-AT-TOP-OF-PANEL.         26110029
261200                                                                  26120029
261300     PERFORM 4010-OPEN-CURSOR.                                    26130029
261400                                                                  26140029
261500     PERFORM 4300-READ-ITEMS-FROM-DB.                             26150029
261600                                                                  26160029
261700     PERFORM 4020-CLOSE-CURSOR.                                   26170029
261800                                                                  26180029
261900     MOVE +1                     TO  PV-TOP-ITEM.                 26190029
262000     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        26200029
262100                                                                  26210058
262200*--------------------------------------------------------------*  26220058
262300* OPENS THE NO PO LINE CURSOR                                  *  26230058
262400*--------------------------------------------------------------*  26240058
262600 4010-OPEN-CURSOR.                                                26260029
262610                                                                  26261058
262700     EXEC SQL                                                     26270029
262800         OPEN INVOICE-ITEM-CSR                                    26280029
262900     END-EXEC.                                                    26290029
263000                                                                  26300029
263100     EVALUATE TRUE                                                26310029
263200         WHEN SQLCODE = +0                                        26320029
263300             CONTINUE                                             26330029
263400         WHEN OTHER                                               26340029
263500              MOVE '4010-OPEN-CURSOR'                             26350029
263600                               TO DP013-PARAGRAPH                 26360029
263700              MOVE 'OPEN INVOICE-ITEM-CSR'                        26370029
263800                               TO DP013-MESSAGE-TEXT (1)          26380029
263900              MOVE SQLCA           TO DP013-SQLCA                 26390029
264000              SET DP013-DB2-ABEND                                 26400029
264100                               TO TRUE                            26410029
264200              PERFORM DP013-0000-PROCESS-ABEND                    26420029
264300     END-EVALUATE.                                                26430029
264400                                                                  26440029
264600*--------------------------------------------------------------*  26460058
264700* CLOSES EITHER THE SUB-CLASS-CSR OR THE MAJ-CLASS-CSR         *  26470058
264800*--------------------------------------------------------------*  26480058
265000 4020-CLOSE-CURSOR.                                               26500029
265010                                                                  26501058
265100     EXEC SQL                                                     26510029
265200         CLOSE INVOICE-ITEM-CSR                                   26520029
265300     END-EXEC.                                                    26530029
265500                                                                  26550029
265600*--------------------------------------------------------------*  26560058
265700* READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE     *  26570058
265800* BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,      *  26580058
265900* WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND   *  26590058
266000* BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE      *  26600058
266100* 2ND BLOCK MAKING IT AVAILABLE TO BE USED.                    *  26610058
266200*                                                              *  26620058
266300* DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE     *  26630058
266400* ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM   *  26640058
266500* UPON INITIALIZATION.                                         *  26650058
266600*--------------------------------------------------------------*  26660058
266800 4300-READ-ITEMS-FROM-DB.                                         26680029
266900                                                                  26690029
267000     PERFORM                                                      26700029
267100         VARYING PV-READ-COUNT                                    26710029
267200         FROM 1 BY 1                                              26720029
267300         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    26730029
267400            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         26740029
267500                                                                  26750029
267600         PERFORM 4310-FETCH-INVOICE-ITEMS                         26760029
267700                                                                  26770029
267800         IF  ASC-ITEMS-LEFT-ON-DB                                 26780029
267900             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                26790029
268000                 ADD +1            TO ASC-ITEM-SUB                26800029
268100             ELSE                                                 26810029
268200                 ADD +1            TO ASC-BLK-SUB                 26820029
268300                 MOVE +1           TO ASC-ITEM-SUB                26830029
268400                                                                  26840029
268500                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         26850029
268600                     MOVE +1       TO ASC-BLK-SUB                 26860029
268700                     SET ASC-BLOCK-MODIFIED (1)                   26870029
268800                                   TO TRUE                        26880029
268900                     PERFORM 5100-WRITE-TEMP-STORAGE              26890029
269000                     MOVE ASC-BLOCK-ENTRIES                       26900029
269100                               (PC-MAX-BLOCKS-IN-ARRAY)           26910029
269200                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 26920029
269300                     ADD +1        TO ASC-BLK-SUB                 26930029
269400                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   26940029
269500                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      26950029
269600                                   TO TRUE                        26960029
269700                 END-IF                                           26970029
269800             END-IF                                               26980029
269900             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    26990029
270000             MOVE ASC-NUMBER-OF-ITEMS-READ                        27000029
270100                                   TO ASC-LIST-ITEM-NUMBER        27010029
270200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  27020029
270300             MOVE MIITEM-PAYT-REQ-LNE-NBR                         27030029
270400                                 TO ASC-PAYT-REQ-LNE-NBR          27040029
270500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27050029
270600             MOVE PREQIT-PAY-REQ-LNE-QTY                          27060029
270700                                 TO ASC-PIECES                    27070029
270800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27080029
270900             MOVE ASC-PIECES (ASC-BLK-SUB ASC-ITEM-SUB)           27090029
271000                                 TO PV-PIECES-9                   27100029
271100             MOVE PV-PIECES      TO ASC-INP-PIECES                27110029
271200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27120029
271300             MOVE PREQIT-UNT-COST-AMT                             27130029
271400                                 TO ASC-UNIT-COST                 27140029
271500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27150029
271600             MOVE ASC-UNIT-COST (ASC-BLK-SUB ASC-ITEM-SUB)        27160029
271700                                 TO PV-UNIT-COST-9                27170029
271800             MOVE PV-UNIT-COST-9 TO ASC-INP-UNIT-COST             27180029
271900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27190029
272000             MOVE PV-UPC-NBR-DISPLAY                              27200029
272100                                 TO ASC-UPC-CODE                  27210029
272200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27220029
272300             MOVE PV-PO-LNE-NBR  TO ASC-PO-LNE-NBR                27230029
272400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27240029
272500             MOVE PV-APP-PO-LNE-NBR                               27250029
272600                                 TO ASC-APP-PO-LNE-NBR            27260029
272700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27270029
272800             MOVE PV-VENDOR-STYLE                                 27280029
272900                                 TO ASC-VENDOR-STYLE              27290029
273000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27300029
273100             MOVE PV-COLOR-CDE   TO ASC-COLOR                     27310029
273200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27320029
273300             MOVE PV-SIZE-CDE    TO ASC-SIZE                      27330029
273400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27340029
273500             MOVE PV-SKU-NBR-X   TO ASC-SKU                       27350036
273600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27360036
273700         END-IF                                                   27370029
273800     END-PERFORM.                                                 27380029
273900                                                                  27390029
274000     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          27400029
274100         MOVE +1               TO ASC-BLK-SUB                     27410029
274200         PERFORM 5100-WRITE-TEMP-STORAGE                          27420029
274300         ADD +1                TO ASC-BLK-SUB                     27430029
274400         PERFORM 5100-WRITE-TEMP-STORAGE                          27440029
274500                                                                  27450029
274600         MOVE 1                TO ASC-BLK-SUB                     27460029
274700                                  PV-BLOCK-NUMBER                 27470029
274800         PERFORM 4410-READ-TEMP-STORAGE                           27480029
274900         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             27490029
275000             MOVE 2            TO ASC-BLK-SUB                     27500029
275100                                  PV-BLOCK-NUMBER                 27510029
275200             PERFORM 4410-READ-TEMP-STORAGE                       27520029
275300         END-IF                                                   27530029
275400     END-IF.                                                      27540029
275500                                                                  27550058
275600*--------------------------------------------------------------*  27560058
275700* FETCH THE INVOICE ITEMS NOT ASSOCIATED TO A PO               *  27570058
275800*--------------------------------------------------------------*  27580058
276000 4310-FETCH-INVOICE-ITEMS.                                        27600029
276100                                                                  27610029
276200     EXEC SQL                                                     27620029
276300         FETCH INVOICE-ITEM-CSR                                   27630029
276400             INTO                                                 27640029
276500                 :MIITEM-PAYT-REQ-LNE-NBR,                        27650029
276600                 :PREQIT-PAY-REQ-LNE-QTY,                         27660029
276700                 :PREQIT-UNT-COST-AMT,                            27670029
276800                 :MIITEM-PO-LNE-NBR                               27680029
276900     END-EXEC.                                                    27690029
277000                                                                  27700029
277100     EVALUATE TRUE                                                27710029
277200         WHEN SQLCODE = ZERO                                      27720029
277300              MOVE MIITEM-PO-LNE-NBR                              27730029
277400                                 TO PV-PO-LNE-NBR                 27740029
277500              IF MIITEM-PO-LNE-NBR = 0                            27750029
277600                  PERFORM 4320-GET-INVOICE-DETAILS                27760029
277700              ELSE                                                27770029
277800                  PERFORM 4330-GET-PO-DETAILS                     27780029
277900              END-IF                                              27790029
278000         WHEN SQLCODE = +100                                      27800029
278100              SET ASC-NO-ITEMS-LEFT-ON-DB                         27810029
278200                                 TO TRUE                          27820029
278300         WHEN SQLWARN0 NOT EQUAL SPACE                            27830029
278400         WHEN SQLCODE NOT EQUAL ZERO                              27840029
278500              MOVE '4310-FETCH-INVOICE-ITEMS'                     27850029
278600                               TO DP013-PARAGRAPH                 27860029
278700              MOVE 'FETCH INVOICE ITEMS CSR'                      27870029
278800                               TO DP013-MESSAGE-TEXT (1)          27880029
278900              MOVE SQLCA           TO DP013-SQLCA                 27890029
279000              SET DP013-DB2-ABEND                                 27900029
279100                               TO TRUE                            27910029
279200              PERFORM DP013-0000-PROCESS-ABEND                    27920029
279300     END-EVALUATE.                                                27930029
279400                                                                  27940029
279500*--------------------------------------------------------------*  27950058
279600* GET INVOICE DETAILS FOR AN ITEM THAT DOES NOT HAVE PO ITEMS  *  27960058
279700*--------------------------------------------------------------*  27970058
279800 4320-GET-INVOICE-DETAILS.                                        27980029
279900                                                                  27990029
280000     INITIALIZE DCLTVNDINV                                        28000029
280100                                                                  28010029
280200     EXEC SQL                                                     28020029
280300         SELECT UPC_EAN_CDE,                                      28030029
280400                UPC_EAN_QUAL_CDE,                                 28040029
280500                VEND_STYL_CDE,                                    28050029
280600                COLOR_CDE,                                        28060029
280700                SIZE_CDE                                          28070036
280800          INTO :VNDINV-UPC-EAN-CDE,                               28080029
280900               :VNDINV-UPC-EAN-QUAL-CDE,                          28090029
281000               :VNDINV-VEND-STYL-CDE,                             28100029
281100               :VNDINV-COLOR-CDE,                                 28110029
281200               :VNDINV-SIZE-CDE                                   28120036
281300          FROM TVNDINV                                            28130029
281400          WHERE PAYT_REQ_SEQ_NBR = :DK-PAYT-REQ-SEQ-NBR           28140029
281500            AND PAYT_REQ_LNE_NBR = :MIITEM-PAYT-REQ-LNE-NBR       28150029
281600     END-EXEC.                                                    28160029
281610                                                                  28161058
281700     EVALUATE TRUE                                                28170029
281800         WHEN SQLCODE = ZERO                                      28180029
281900              MOVE VNDINV-UPC-EAN-CDE                             28190029
282000                                 TO PV-UPC-NBR                    28200029
282100              IF VNDINV-UPC-EAN-QUAL-CDE = 'U'                    28210029
282200                  STRING PV-UPC-NBR-X(4:1) DELIMITED BY SIZE      28220029
282300                               INTO PV-UPC-NBR-DISPLAY            28230029
282400              ELSE                                                28240029
282500                  STRING PV-UPC-NBR-X(3:2) DELIMITED BY SIZE      28250029
282600                               INTO PV-UPC-NBR-DISPLAY            28260029
282700              END-IF                                              28270029
282800              STRING PV-UPC-NBR-DISPLAY DELIMITED BY '  '         28280029
282900                  '-'                DELIMITED BY SIZE            28290029
283000                  PV-UPC-NBR-X(5:5)  DELIMITED BY SIZE            28300029
283100                  '-'                DELIMITED BY SIZE            28310029
283200                  PV-UPC-NBR-X(10:5) DELIMITED BY SIZE            28320029
283300                  '-'                DELIMITED BY SIZE            28330029
283400                  PV-UPC-NBR-X(15:1) DELIMITED BY SIZE            28340029
283500                               INTO PV-UPC-NBR-DISPLAY            28350029
283600              MOVE VNDINV-VEND-STYL-CDE                           28360029
283700                                 TO PV-VENDOR-STYLE               28370029
283800              MOVE VNDINV-COLOR-CDE                               28380029
283900                                 TO PV-COLOR-CDE                  28390029
284000              MOVE VNDINV-SIZE-CDE                                28400029
284100                                 TO PV-SIZE-CDE                   28410029
284200              MOVE SPACES        TO PV-SKU-NBR-X                  28420036
284300              MOVE ZEROES        TO PV-APP-PO-LNE-NBR             28430036
284400         WHEN SQLCODE = +100                                      28440029
284500             MOVE SPACES         TO PV-SIZE-CDE                   28450029
284600                                    PV-COLOR-CDE                  28460029
284700                                    PV-VENDOR-STYLE               28470029
284800                                    PV-SKU-NBR-X                  28480036
284900             MOVE ZEROES         TO PV-UPC-NBR                    28490029
285000                                    PV-APP-PO-LNE-NBR             28500029
285100         WHEN OTHER                                               28510029
285200              MOVE '4320-GET-INVOICE-DETAILS'                     28520029
285300                               TO DP013-PARAGRAPH                 28530029
285400              MOVE 'SELECT INVOICE DETAILS'                       28540029
285500                               TO DP013-MESSAGE-TEXT (1)          28550029
285600              MOVE SQLCA           TO DP013-SQLCA                 28560029
285700              SET DP013-DB2-ABEND                                 28570029
285800                               TO TRUE                            28580029
285900              PERFORM DP013-0000-PROCESS-ABEND                    28590029
286000     END-EVALUATE.                                                28600029
286100                                                                  28610029
286200*--------------------------------------------------------------*  28620058
286300* GET PO LINE ITEM DETAILS                                     *  28630058
286400*--------------------------------------------------------------*  28640058
286500 4330-GET-PO-DETAILS.                                             28650029
286510                                                                  28651058
286600     EXEC SQL                                                     28660029
286700         SELECT B.SKU,                                            28670036
286800                A.RMS_PO_SKU_NBR,                                 28680036
286900                A.ITM_NBR,                                        28690036
287000                A.VEND_STYL_NAME,                                 28700036
287100                A.COLOR_CDE,                                      28710036
287200                A.SIZE_CDE,                                       28720036
287300                A.APP_PO_LNE_NBR                                  28730036
287400          INTO :SKXREF-SKU,                                       28740036
287500               :PURITM-RMS-PO-SKU-NBR,                            28750036
287600               :PURITM-ITM-NBR,                                   28760036
287700               :PURITM-VEND-STYL-NAME,                            28770036
287800               :PURITM-COLOR-CDE,                                 28780036
287900               :PURITM-SIZE-CDE,                                  28790036
288000               :PURITM-APP-PO-LNE-NBR                             28800036
288100          FROM TPURITM A                                          28810036
288200              ,TSKXREF B                                          28820036
288300          WHERE A.ITM_NBR    = B.ITM_NBR                          28830036
288400           AND  A.PO_NBR     = :DK-PO-NUMBER                      28840036
288500           AND  A.PO_LNE_NBR = :MIITEM-PO-LNE-NBR                 28850036
288600           AND  A.VER_STATUS_CDE = :PC-ACTIVE                     28860036
288700     END-EXEC.                                                    28870029
288710                                                                  28871058
288800     EVALUATE TRUE                                                28880029
288900         WHEN SQLCODE = ZERO                                      28890029
289000             IF PURITM-RMS-PO-SKU-NBR = 0                         28900036
289100                MOVE SKXREF-SKU  TO PV-SKU-NBR                    28910036
289200             ELSE                                                 28920036
289300                MOVE PURITM-RMS-PO-SKU-NBR                        28930036
289400                                 TO PV-SKU-NBR                    28940036
289500             END-IF                                               28950036
289600             MOVE PURITM-VEND-STYL-NAME                           28960029
289700                                 TO PV-VENDOR-STYLE               28970029
289800             MOVE PURITM-COLOR-CDE                                28980029
289900                                 TO PV-COLOR-CDE                  28990029
290000             MOVE PURITM-SIZE-CDE                                 29000029
290100                                 TO PV-SIZE-CDE                   29010029
290200             MOVE PURITM-APP-PO-LNE-NBR                           29020029
290300                                 TO PV-APP-PO-LNE-NBR             29030029
290400             PERFORM 4340-GET-UPC-INFO                            29040029
290500             MOVE TUPCSKU-UPC-NBR TO PV-UPC-NBR                   29050029
290600         WHEN SQLCODE = +100                                      29060029
290700             MOVE SPACES         TO PV-SIZE-CDE                   29070029
290800                                    PV-COLOR-CDE                  29080029
290900                                    PV-VENDOR-STYLE               29090029
291000             MOVE ZEROES         TO PV-UPC-NBR                    29100029
291100                                    PV-APP-PO-LNE-NBR             29110029
291200                                    PV-SKU-NBR                    29120036
291300         WHEN OTHER                                               29130029
291400              MOVE '4320-GET-INVOICE-DETAILS'                     29140029
291500                               TO DP013-PARAGRAPH                 29150029
291600              MOVE 'SELECT INVOICE DETAILS'                       29160029
291700                               TO DP013-MESSAGE-TEXT (1)          29170029
291800              MOVE SQLCA           TO DP013-SQLCA                 29180029
291900              SET DP013-DB2-ABEND                                 29190029
292000                               TO TRUE                            29200029
292100              PERFORM DP013-0000-PROCESS-ABEND                    29210029
292200     END-EVALUATE.                                                29220029
292210                                                                  29221058
292300*--------------------------------------------------------------*  29230058
292400* GET THE UPC/SKU INFORMATION                                  *  29240058
292500*--------------------------------------------------------------*  29250058
292600 4340-GET-UPC-INFO.                                               29260029
292700                                                                  29270029
292800     EXEC SQL                                                     29280029
292900         SELECT DISTINCT                                          29290036
293000              A.UPC_NBR                                           29300036
293100          INTO :TUPCSKU-UPC-NBR                                   29310036
293200          FROM TUPCSKU A                                          29320036
293300         WHERE A.ITEM_NBR         = :PURITM-ITM-NBR               29330036
293310           AND A.EDI_ORD_IND      = :PC-Y-CODE                    29331068
293400*          AND (A.UPC_NBR NOT BETWEEN                             29340068
293500*              :PC-MIN-UPC AND :PC-MAX-UPC)                       29350068
293600     END-EXEC.                                                    29360029
293700                                                                  29370029
293800     EVALUATE TRUE                                                29380029
293900         WHEN SQLCODE = +0                                        29390029
294000           MOVE TUPCSKU-UPC-NBR  TO PV-UPC-NBR                    29400029
294100           STRING PV-UPC-NBR-X(3:2)  DELIMITED BY SIZE            29410029
294200                  '-'                DELIMITED BY SIZE            29420029
294300                  PV-UPC-NBR-X(5:5)  DELIMITED BY SIZE            29430029
294400                  '-'                DELIMITED BY SIZE            29440029
294500                  PV-UPC-NBR-X(10:5) DELIMITED BY SIZE            29450029
294600                  '-'                DELIMITED BY SIZE            29460029
294700                  PV-UPC-NBR-X(15:1) DELIMITED BY SIZE            29470029
294800                               INTO PV-UPC-NBR-DISPLAY            29480029
294900                                                                  29490029
295000         WHEN SQLCODE = +100                                      29500029
295100           MOVE PC-NO-VENDOR-UPC TO PV-UPC-NBR-DISPLAY            29510029
295200                                                                  29520029
295300         WHEN SQLCODE = -811                                      29530029
295400           MOVE PC-MULTIPLE-UPC  TO PV-UPC-NBR-DISPLAY            29540029
295500                                                                  29550029
295600         WHEN SQLWARN0 NOT = SPACES                               29560029
295700         WHEN SQLCODE < +0                                        29570029
295800         WHEN SQLCODE > +0                                        29580029
295900             MOVE '4340-GET-UPC-INFO'                             29590029
296000                               TO DP013-PARAGRAPH                 29600029
296100             MOVE 'SELECT UPC INFO  '                             29610029
296200                               TO DP013-MESSAGE-TEXT (1)          29620029
296300             MOVE SQLCA        TO DP013-SQLCA                     29630029
296400             MOVE 'TUPCSKU'    TO DP013-DB2-TABLE-NAME (1)        29640039
296500             MOVE '       '    TO DP013-DB2-TABLE-NAME (2)        29650039
296600             SET DP013-DB2-ABEND                                  29660029
296700                 DP013-XCTL-DISPLAY-RESTART                       29670029
296800                               TO TRUE                            29680029
296900             PERFORM DP013-0000-PROCESS-ABEND                     29690029
297000     END-EVALUATE.                                                29700029
297100                                                                  29710029
297200*--------------------------------------------------------------*  29720058
297300* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.   *  29730058
297400*--------------------------------------------------------------*  29740058
297600 4400-MOVE-COMMAREA-TO-SCREEN.                                    29760029
297610                                                                  29761058
297700     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             29770029
297800         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          29780029
297900         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          29790029
298000             MOVE +1    TO ASC-BLK-SUB                            29800029
298100             PERFORM 5100-WRITE-TEMP-STORAGE                      29810029
298200             ADD +1     TO ASC-BLK-SUB                            29820029
298300             PERFORM 5100-WRITE-TEMP-STORAGE                      29830029
298400             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             29840029
298500                 GIVING PV-BLOCK-NUMBER                           29850029
298600                 REMAINDER PV-REMAINDER                           29860029
298700             IF  PV-REMAINDER > ZERO                              29870029
298800                 ADD +1 TO PV-BLOCK-NUMBER                        29880029
298900             END-IF                                               29890029
299000             MOVE +1    TO ASC-BLK-SUB                            29900029
299100             PERFORM 4410-READ-TEMP-STORAGE                       29910029
299200             ADD +1     TO ASC-BLK-SUB                            29920029
299300                           PV-BLOCK-NUMBER                        29930029
299400             PERFORM 4410-READ-TEMP-STORAGE                       29940029
299500     END-IF.                                                      29950029
299600     MOVE +1            TO ASC-BLK-SUB.                           29960029
299700     COMPUTE ASC-ITEM-SUB =                                       29970029
299800         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              29980029
299900         + PC-ITEMS-PER-PANEL).                                   29990029
300000                                                                  30000058
300100     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        30010029
300200         ADD +1         TO ASC-BLK-SUB                            30020029
300300         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            30030029
300400     END-IF.                                                      30040029
300500                                                                  30050058
300600     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           30060029
300700         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                30070029
300800     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        30080029
300900     PERFORM 3200-RESET-ATTRIBUTES.                               30090029
301000     PERFORM 4420-FORMAT-LIST-LINES                               30100029
301100         VARYING PV-SUB                                           30110029
301200         FROM PC-ITEMS-PER-PANEL BY -1                            30120029
301300         UNTIL PV-SUB < +1.                                       30130029
301400                                                                  30140058
301500     COMPUTE ASC-ITEMS-DISPLAYED =                                30150029
301600         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          30160029
301700                                                                  30170029
301800     IF PS-NO-START-ITEM-ERROR                                    30180029
301900         MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL30190029
302000                                          ASTRTITO                30200029
302100         MOVE SPACE                    TO ASC-START-ITEM-REQUEST  30210029
302200     ELSE                                                         30220029
302300         MOVE ASC-START-ITEM-REQUEST   TO ASTRTITO                30230029
302400     END-IF.                                                      30240029
302500                                                                  30250029
302600     IF (ASC-ITEM-AT-BOT-OF-PANEL = ZERO AND                      30260029
302700         ASC-ITEM-AT-TOP-OF-PANEL = ZERO) OR                      30270029
302800         ASC-PROTECT-FIELDS                                       30280029
302900         SET DP030-SET-CURSOR-APPL-1                              30290029
303000                                   TO TRUE                        30300029
303100         MOVE -1                   TO ASTRTITL                    30310029
303200     END-IF                                                       30320029
303300                                                                  30330029
303400     IF PS-NO-ERROR                                               30340029
303500         IF ASC-ALLOW-SELECT-ONLY OR                              30350029
303600            ASC-PROTECT-FIELDS                                    30360029
303700*            -- UPDATE NOT ALLOWED FOR THIS STATUS --             30370029
303800             IF ASC-KEY-INVC-STATUS = PC-OUT-OF-BALANCE           30380029
303900                 MOVE PC-TSYMSG-00942                             30390029
304000                                 TO DP020-MSG-NUMBER              30400029
304100             ELSE                                                 30410029
304200                 MOVE PC-TSYMSG-00170                             30420029
304300                                 TO DP020-MSG-NUMBER              30430029
304400             END-IF                                               30440029
304500             SET DP020-MSG-INFORMATIONAL TO TRUE                  30450029
304600             SET PS-ERROR                TO TRUE                  30460029
304700         END-IF                                                   30470029
304800     END-IF                                                       30480029
304900                                                                  30490029
305000     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    30500029
305100     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    30510029
305200     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            30520029
305300                                   TO ASELITO.                    30530029
305400                                                                  30540029
305500     MOVE DP015-BLUE                TO ASTATUSC                   30550029
305600     EVALUATE ASC-KEY-INVC-STATUS                                 30560029
305700         WHEN 'EN'                                                30570029
305800             MOVE 'ENTERED    '     TO ASTATUSO                   30580029
305900         WHEN 'RC'                                                30590029
306000             MOVE 'RECONCILE  '     TO ASTATUSO                   30600029
306100         WHEN 'RL'                                                30610029
306200             MOVE 'RELEASED   '     TO ASTATUSO                   30620029
306300         WHEN 'OP'                                                30630029
306400             MOVE 'OPEN TO PAY'     TO ASTATUSO                   30640029
306500         WHEN 'PD'                                                30650029
306600             MOVE 'PAID       '     TO ASTATUSO                   30660029
306700         WHEN 'PJ'                                                30670029
306800             MOVE 'PENDNG JRNL'     TO ASTATUSO                   30680029
306900         WHEN 'DE'                                                30690029
307000             MOVE 'DELETED    '     TO ASTATUSO                   30700029
307100         WHEN 'PR'                                                30710029
307200             MOVE 'PENDING RVW'     TO ASTATUSO                   30720029
307300             MOVE DP015-YELLOW      TO ASTATUSC                   30730029
307400         WHEN 'OB'                                                30740029
307500             MOVE 'OUT OF BAL '     TO ASTATUSO                   30750029
307600             MOVE DP015-YELLOW      TO ASTATUSC                   30760029
307700         WHEN 'IB'                                                30770029
307800             MOVE DP015-YELLOW      TO ASTATUSC                   30780029
307900             MOVE 'ITM IMBALNC'     TO ASTATUSO                   30790029
308000     END-EVALUATE                                                 30800029
308100                                                                  30810029
308200     MOVE ASC-KEY-PO-NUMBER        TO APONBRO.                    30820029
308300     MOVE ASC-KEY-INVOICE-ID       TO AINVNBRO.                   30830029
308400     MOVE ASC-VENDOR-DESC-10       TO AVENDORO.                   30840029
308410     MOVE ASC-KEY-DC-NBR           TO ADCNBRO.                    30841049
308420     MOVE ASC-KEY-STORE-NUMBER     TO ASTRNBRO.                   30842061
308500     MOVE ASC-KEY-DEPT-NBR         TO ADEPTO.                     30850029
308600     MOVE ASC-KEY-TOTAL-PIECES     TO ATOTQTYO.                   30860029
308700     MOVE ASC-KEY-GRO-COST-AMT     TO ATOTCSTO.                   30870029
308800                                                                  30880029
308900     PERFORM 4450-SELECT-TOTAL-PIECES                             30890029
309000                                                                  30900029
309100     MOVE ASC-CALC-TOTAL-PIECES    TO ACLCQTYO.                   30910029
309200                                                                  30920029
309300     MOVE ASC-CALC-TOTAL-COST      TO ACLCCSTO.                   30930029
309400                                                                  30940029
309500     IF PV-FIRST-ERROR-ITEM > 0                                   30950029
309600         MOVE PV-FIRST-ERROR-ITEM                                 30960029
309700                                 TO DP020-MSG-TEXT                30970029
309800         SET DP020-MSG-FATAL     TO TRUE                          30980029
309900         MOVE PC-TSYMSG-00872    TO DP020-MSG-NUMBER              30990029
310000         SET DP030-SET-CURSOR-APPL-1                              31000029
310100                                 TO TRUE                          31010029
310200     ELSE                                                         31020029
310300         IF PV-FIRST-WARNING-ITEM > 0 AND ASC-NO-UPDATE           31030029
310400             MOVE PV-FIRST-WARNING-ITEM                           31040029
310500                                 TO DP020-MSG-TEXT                31050029
310600             SET DP020-MSG-WARNING                                31060029
310700                                 TO TRUE                          31070029
310800             MOVE PC-TSYMSG-00393                                 31080029
310900                                 TO DP020-MSG-NUMBER              31090029
311000             SET DP030-SET-CURSOR-APPL-1                          31100029
311100                                 TO TRUE                          31110029
311200         ELSE                                                     31120029
311300             IF ASC-KEY-TOTAL-PIECES = ASC-CALC-TOTAL-PIECES      31130029
311400                 SET DP030-SET-CURSOR-APPL-1                      31140029
311500                                 TO TRUE                          31150029
311600                 MOVE DP015-BLUE TO ATOTQTYC                      31160029
311700                                    ACLCQTYC                      31170029
311800                 MOVE DP015-HL-OFF                                31180029
311900                                 TO ATOTQTYH                      31190029
312000                                    ACLCQTYH                      31200029
312100             ELSE                                                 31210029
312200                 IF ASC-UNPROTECT-FIELDS                          31220029
312300                     MOVE DP015-YELLOW                            31230029
312400                                 TO ATOTQTYC                      31240029
312500                                    ACLCQTYC                      31250029
312600                     MOVE DP015-REVERSE                           31260029
312700                                 TO ATOTQTYH                      31270029
312800                                    ACLCQTYH                      31280029
312900                     SET DP030-SET-CURSOR-APPL-1                  31290029
313000                                   TO TRUE                        31300029
313100                     IF PS-NO-ERROR                               31310029
313200                         MOVE PC-TSYMSG-00853                     31320029
313300                                   TO DP020-MSG-NUMBER            31330029
313400                         SET DP020-MSG-WARNING                    31340029
313500                             DP030-SET-CURSOR-TRAILER             31350029
313600                                   TO TRUE                        31360029
313700                     END-IF                                       31370029
313800                 END-IF                                           31380029
313900             END-IF                                               31390029
314000             IF ASC-KEY-GRO-COST-AMT = ASC-CALC-TOTAL-COST        31400029
314100                 SET DP030-SET-CURSOR-APPL-1                      31410029
314200                                 TO TRUE                          31420029
314300                 MOVE DP015-BLUE TO ATOTCSTC                      31430029
314400                                    ACLCCSTC                      31440029
314500                 MOVE DP015-HL-OFF                                31450029
314600                                 TO ATOTCSTH                      31460029
314700                                    ACLCCSTH                      31470029
314800             ELSE                                                 31480029
314900                 IF ASC-UNPROTECT-FIELDS                          31490029
315000                     MOVE DP015-YELLOW                            31500029
315100                                 TO ATOTCSTC                      31510029
315200                                    ACLCCSTC                      31520029
315300                     MOVE DP015-REVERSE                           31530029
315400                                 TO ATOTCSTH                      31540029
315500                                    ACLCCSTH                      31550029
315600                     SET DP030-SET-CURSOR-APPL-1                  31560029
315700                                   TO TRUE                        31570029
315800                     IF PS-NO-ERROR                               31580029
315900*                        --  ITEM IMBALANCE --                    31590029
316000                         MOVE PC-TSYMSG-00935  TO DP020-MSG-NUMBER31600029
316100                         SET DP020-MSG-WARNING                    31610029
316200                             DP030-SET-CURSOR-TRAILER             31620029
316300                                   TO TRUE                        31630029
316400                     END-IF                                       31640029
316500                 END-IF                                           31650029
316600             END-IF                                               31660029
316700         END-IF                                                   31670029
316800     END-IF.                                                      31680029
316900                                                                  31690058
317000     IF  DP020-MSG-NUMBER-X = SPACE                               31700029
317100         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  31710029
317200*            --- MORE ITEMS TO DISPLAY ----                       31720029
317300             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            31730029
317400             SET DP020-MSG-INFORMATIONAL TO TRUE                  31740029
317500         END-IF                                                   31750029
317600     END-IF.                                                      31760029
317610                                                                  31761058
317700*--------------------------------------------------------------*  31770058
317800* FOR TOTAL UNIT COST, WE NEED TO GET THE WEIGHTED AVERAGE     *  31780058
317900*--------------------------------------------------------------*  31790058
318000 4450-SELECT-TOTAL-PIECES.                                        31800029
318100                                                                  31810029
318200     MOVE ASC-KEY-PAYT-REQ-SEQ-NBR                                31820029
318300                                 TO DK-PAYT-REQ-SEQ-NBR           31830029
318400     MOVE +0 TO PV-TOTAL-PIECES                                   31840029
318500                PV-PER-UNIT-COST                                  31850029
318600                ASC-CALC-TOTAL-PIECES                             31860029
318700                ASC-CALC-TOTAL-COST                               31870029
318800                                                                  31880029
318900     EXEC SQL                                                     31890029
319000         OPEN PREQIT_CSR                                          31900029
319100     END-EXEC.                                                    31910029
319200                                                                  31920029
319300     EVALUATE TRUE                                                31930029
319400         WHEN SQLCODE = +0                                        31940029
319500             CONTINUE                                             31950029
319600         WHEN OTHER                                               31960029
319700             MOVE '4450-...           '                           31970029
319800                               TO DP013-PARAGRAPH                 31980029
319900             MOVE 'OPEN CURSOR'                                   31990029
320000                               TO DP013-MESSAGE-TEXT(1)           32000029
320100             MOVE SQLCA        TO DP013-SQLCA                     32010029
320200             MOVE 'TPREQIT'    TO DP013-DB2-TABLE-NAME (1)        32020029
320300             SET DP013-DB2-ABEND                                  32030029
320400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               32040029
320500             PERFORM DP013-0000-PROCESS-ABEND                     32050029
320600     END-EVALUATE                                                 32060029
320700                                                                  32070029
320800     PERFORM UNTIL SQLCODE = +100                                 32080029
320900                                                                  32090029
321000         EXEC SQL                                                 32100029
321100             FETCH PREQIT_CSR                                     32110029
321200             INTO :PV-TOTAL-PIECES                                32120029
321300                 ,:PV-PER-UNIT-COST                               32130029
321400         END-EXEC                                                 32140029
321500                                                                  32150029
321600         EVALUATE TRUE                                            32160029
321700             WHEN SQLCODE = +0                                    32170029
321800                 ADD PV-TOTAL-PIECES TO ASC-CALC-TOTAL-PIECES     32180029
321900                 COMPUTE ASC-CALC-TOTAL-COST = ASC-CALC-TOTAL-COST32190029
322000                      + (PV-PER-UNIT-COST * PV-TOTAL-PIECES)      32200029
322100             WHEN SQLCODE = +100                                  32210029
322200                 CONTINUE                                         32220029
322300             WHEN OTHER                                           32230029
322400                 MOVE '4450-...           '                       32240029
322500                                   TO DP013-PARAGRAPH             32250029
322600                 MOVE 'FETCH CURSOR'                              32260029
322700                                   TO DP013-MESSAGE-TEXT(1)       32270029
322800                 MOVE SQLCA        TO DP013-SQLCA                 32280029
322900                 MOVE 'TPREQIT'    TO DP013-DB2-TABLE-NAME (1)    32290029
323000                 SET DP013-DB2-ABEND                              32300029
323100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           32310029
323200                 PERFORM DP013-0000-PROCESS-ABEND                 32320029
323300         END-EVALUATE                                             32330029
323400     END-PERFORM.                                                 32340029
323500                                                                  32350029
323600     EXEC SQL                                                     32360029
323700        CLOSE PREQIT_CSR                                          32370029
323800     END-EXEC.                                                    32380029
323900                                                                  32390058
324000*--------------------------------------------------------------*  32400058
324100* READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.          *  32410058
324200*--------------------------------------------------------------*  32420058
324400 4410-READ-TEMP-STORAGE.                                          32440029
324500                                                                  32450029
324600     EXEC CICS                                                    32460029
324700         READQ TS                                                 32470029
324800             QUEUE (ASC-LIST-QUEUE-NAME)                          32480029
324900             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               32490029
325000             ITEM  (PV-BLOCK-NUMBER)                              32500029
325100             RESP  (PV-CICS-RESP)                                 32510029
325200     END-EXEC.                                                    32520029
325300                                                                  32530029
325400     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       32540029
325500       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     32550029
325600         CONTINUE                                                 32560029
325700     ELSE                                                         32570029
325800         SET DP013-CICS-ABEND     TO TRUE                         32580029
325900         SET DP013-NO-ROLLBACK    TO TRUE                         32590029
326000         MOVE '4410-READ-TEMP-STORAGE'                            32600029
326100                                  TO DP013-PARAGRAPH              32610029
326200         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      32620029
326300                                  TO DP013-MESSAGE-TEXT(1)        32630029
326400         PERFORM DP013-0000-PROCESS-ABEND                         32640029
326500     END-IF.                                                      32650029
326600                                                                  32660029
326700     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             32670029
326800                                                                  32680058
326900     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         32690029
327000         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               32700029
327100     END-IF.                                                      32710029
327200                                                                  32720058
327300*--------------------------------------------------------------*  32730058
327400* PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.     *  32740058
327500*--------------------------------------------------------------*  32750058
327700 4420-FORMAT-LIST-LINES.                                          32770029
327710                                                                  32771058
327800     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      32780029
327900         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                32790029
328000         MOVE DP015-ASK-DRK-OFF  TO AP-SELECTA (PV-SUB)           32800029
328100                                    AP-PIECESA (PV-SUB)           32810029
328200                                    AP-UNIT-COSTA (PV-SUB)        32820029
328300         MOVE SPACE              TO AP-SELECT  (PV-SUB)           32830029
328400                                    AP-ACTION (PV-SUB)            32840029
328500                                    AP-PIECES (PV-SUB)            32850029
328600                                    AP-UNIT-COST (PV-SUB)         32860029
328700                                    AP-PO-LINE (PV-SUB)           32870029
328800                                    AP-UPC-CODE(PV-SUB)           32880029
328900                                    AP-SKU(PV-SUB)                32890037
329000                                    AP-STYLE(PV-SUB)              32900029
329100                                    AP-COLOR(PV-SUB)              32910029
329200                                    AP-SIZE(PV-SUB)               32920029
329300                                    AP-INVOICE-LINE(PV-SUB)       32930029
329400                                                                  32940029
329500     ELSE                                                         32950029
329600         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      32960029
329700                                                   > SPACE        32970029
329800             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 32980029
329900                                 TO AP-SELECT  (PV-SUB)           32990029
330000         ELSE                                                     33000029
330100             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      33010029
330200                                 TO AP-SELECT  (PV-SUB)           33020029
330300         END-IF                                                   33030029
330400                                                                  33040058
330500         IF  DP030-SET-CURSOR-TRAILER                             33050029
330600             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)33060029
330700                 > SPACE)                                         33070029
330800               OR (PV-SUB = 1))                                   33080029
330900                SET DP030-SET-CURSOR-APPL-1 TO TRUE               33090029
331000                MOVE -1          TO AP-SELECTL (PV-SUB)           33100029
331100             END-IF                                               33110029
331200         END-IF                                                   33120029
331300                                                                  33130058
331400         IF ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB) EQUAL PC-DEL    33140029
331500             MOVE DP015-ASK-DRK-OFF  TO AP-SELECTA (PV-SUB)       33150029
331600             MOVE DP015-PRO-NOR-OFF  TO AP-PIECESA (PV-SUB)       33160029
331700                                        AP-UNIT-COSTA (PV-SUB)    33170029
331800             MOVE DP015-BLUE         TO AP-PIECESC (PV-SUB)       33180029
331900                                        AP-UNIT-COSTC (PV-SUB)    33190029
332000         END-IF                                                   33200029
332100                                                                  33210058
332200         IF ASC-APP-PO-LNE-NBR (ASC-BLK-SUB ASC-ITEM-SUB)         33220029
332300             = ZERO AND                                           33230029
332400            ASC-PO-LNE-NBR (ASC-BLK-SUB ASC-ITEM-SUB) = ZERO      33240029
332500             MOVE PC-ASTERICK    TO AP-PO-LINE (PV-SUB)           33250029
332600         ELSE                                                     33260029
332700             IF ASC-APP-PO-LNE-NBR (ASC-BLK-SUB ASC-ITEM-SUB)     33270029
332800                 = ZERO                                           33280029
332900                 MOVE ASC-PO-LNE-NBR (ASC-BLK-SUB ASC-ITEM-SUB)   33290029
333000                                 TO AP-PO-LINE-9(PV-SUB)          33300029
333100             ELSE                                                 33310029
333200                 MOVE ASC-APP-PO-LNE-NBR                          33320029
333300                          (ASC-BLK-SUB ASC-ITEM-SUB)              33330029
333400                                 TO AP-PO-LINE-9 (PV-SUB)         33340029
333500             END-IF                                               33350029
333600         END-IF                                                   33360029
333700         MOVE ASC-ACTION           (ASC-BLK-SUB ASC-ITEM-SUB)     33370029
333800                                 TO AP-ACTION (PV-SUB)            33380029
333900         MOVE ASC-PAYT-REQ-LNE-NBR (ASC-BLK-SUB ASC-ITEM-SUB)     33390029
334000                                 TO AP-INVOICE-LINE-9 (PV-SUB)    33400029
334100         MOVE ASC-UPC-CODE (ASC-BLK-SUB ASC-ITEM-SUB)             33410029
334200                                 TO AP-UPC-CODE (PV-SUB)          33420029
334300         MOVE ASC-SKU (ASC-BLK-SUB ASC-ITEM-SUB)                  33430037
334400                                 TO AP-SKU (PV-SUB)               33440037
334500         MOVE ASC-VENDOR-STYLE (ASC-BLK-SUB ASC-ITEM-SUB)         33450029
334600                                 TO AP-STYLE (PV-SUB)             33460029
334700         MOVE ASC-COLOR (ASC-BLK-SUB ASC-ITEM-SUB)                33470029
334800                                 TO AP-COLOR (PV-SUB)             33480029
334900         MOVE ASC-SIZE (ASC-BLK-SUB ASC-ITEM-SUB)                 33490029
335000                                 TO AP-SIZE (PV-SUB)              33500029
335100         IF ASC-PIECES(ASC-BLK-SUB ASC-ITEM-SUB)                  33510029
335200             = ZERO                                               33520029
335300             MOVE ASC-PIECES                                      33530029
335400                         (ASC-BLK-SUB ASC-ITEM-SUB)               33540029
335500                                 TO AP-PIECES-9 (PV-SUB)          33550029
335600         ELSE                                                     33560029
335700             IF ASC-LINE-ERROR (ASC-BLK-SUB ASC-ITEM-SUB)         33570029
335800                 MOVE ASC-INP-PIECES (ASC-BLK-SUB ASC-ITEM-SUB)   33580029
335900                             TO AP-PIECES (PV-SUB)                33590029
336000             ELSE                                                 33600029
336100                 MOVE ASC-PIECES(ASC-BLK-SUB ASC-ITEM-SUB)        33610029
336200                                 TO AP-PIECES-9 (PV-SUB)          33620029
336300             END-IF                                               33630029
336400         END-IF                                                   33640029
336500         IF ASC-UNIT-COST(ASC-BLK-SUB ASC-ITEM-SUB)               33650029
336600             = ZERO                                               33660029
336700             IF ASC-PIECES(ASC-BLK-SUB ASC-ITEM-SUB)              33670029
336800                 = ZERO                                           33680029
336900                 MOVE ASC-UNIT-COST (ASC-BLK-SUB ASC-ITEM-SUB)    33690029
337000                                 TO AP-UNIT-COST-9 (PV-SUB)       33700029
337100             ELSE                                                 33710029
337200                 MOVE PC-NO-CHARGE TO AP-UNIT-COST(PV-SUB)        33720029
337300             END-IF                                               33730029
337400         ELSE                                                     33740029
337500             IF ASC-LINE-ERROR (ASC-BLK-SUB ASC-ITEM-SUB)         33750029
337600                 MOVE ASC-INP-UNIT-COST (ASC-BLK-SUB ASC-ITEM-SUB)33760029
337700                                 TO AP-UNIT-COST(PV-SUB)          33770029
337800             ELSE                                                 33780029
337900                 MOVE ASC-UNIT-COST (ASC-BLK-SUB ASC-ITEM-SUB)    33790029
338000                                 TO AP-UNIT-COST-9 (PV-SUB)       33800029
338100             END-IF                                               33810029
338200         END-IF                                                   33820029
338300         IF (ASC-LINE-WARNING (ASC-BLK-SUB ASC-ITEM-SUB)) AND     33830029
338400            (NOT ASC-LINE-CHANGED(ASC-BLK-SUB ASC-ITEM-SUB))      33840029
338500             MOVE DP015-YELLOW   TO AP-PIECESC (PV-SUB)           33850029
338600                                    AP-UNIT-COSTC (PV-SUB)        33860029
338700                                    AP-SELECTC (PV-SUB)           33870029
338800             MOVE DP015-REVERSE  TO AP-PIECESH (PV-SUB)           33880029
338900                                    AP-UNIT-COSTH (PV-SUB)        33890029
339000                                    AP-SELECTH (PV-SUB)           33900029
339100             SET DP030-SET-CURSOR-APPL-1                          33910029
339200                                   TO TRUE                        33920029
339300             MOVE -1               TO AP-SELECTL (PV-SUB)         33930029
339400         ELSE                                                     33940029
339500             IF ASC-LINE-CHANGED(ASC-BLK-SUB ASC-ITEM-SUB)        33950029
339600                 MOVE DP015-GREEN                                 33960029
339700                                 TO AP-PIECESC (PV-SUB)           33970029
339800                                    AP-UNIT-COSTC (PV-SUB)        33980029
339900                                    AP-SELECTC (PV-SUB)           33990029
340000                 MOVE DP015-UNDERLINE                             34000029
340100                                 TO AP-PIECESH (PV-SUB)           34010029
340200                                    AP-UNIT-COSTC (PV-SUB)        34020029
340300                                    AP-SELECTH (PV-SUB)           34030029
340400         END-IF                                                   34040029
340500         IF ASC-LINE-ERROR (ASC-BLK-SUB ASC-ITEM-SUB)             34050029
340600             SET PS-ERROR       TO TRUE                           34060029
340700             MOVE DP015-RED     TO AP-PIECESC (PV-SUB)            34070029
340800                                   AP-UNIT-COSTC (PV-SUB)         34080029
340900                                   AP-SELECTC (PV-SUB)            34090029
341000             MOVE DP015-REVERSE TO AP-PIECESH (PV-SUB)            34100029
341100                                   AP-UNIT-COSTH (PV-SUB)         34110029
341200                                   AP-SELECTH (PV-SUB)            34120029
341300             SET DP030-SET-CURSOR-APPL-1                          34130029
341400                                   TO TRUE                        34140029
341500             MOVE -1               TO AP-SELECTL (PV-SUB)         34150029
341600         END-IF                                                   34160029
341700     END-IF.                                                      34170029
341800     SUBTRACT +1 FROM ASC-ITEM-SUB                                34180029
341900     IF  ASC-ITEM-SUB < + 1                                       34190029
342000         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  34200029
342100         MOVE +1                 TO ASC-BLK-SUB                   34210029
342200     END-IF.                                                      34220029
342210                                                                  34221058
342300*--------------------------------------------------------------*  34230058
342400* IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   *  34240058
342500* RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      *  34250058
342600* ISSUE A WARNING.                                             *  34260058
342700*--------------------------------------------------------------*  34270058
342800 4430-CHECK-FOR-BEGIN-AND-END.                                    34280029
342810                                                                  34281058
342900     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       34290029
343000         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     34300029
343100*            -- NO END-OF-RANGE SPECFIED ---                      34310029
343200             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            34320029
343300             SET DP020-MSG-WARNING TO TRUE                        34330029
343400             PERFORM 4431-POSITION-AT-WARNING                     34340029
343500         END-IF                                                   34350029
343600     ELSE                                                         34360029
343700         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     34370029
343800*            -- NO BEGINNING-OF-RANGE SPECFIED ---                34380029
343900             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            34390029
344000             SET DP020-MSG-WARNING TO TRUE                        34400029
344100             PERFORM 4431-POSITION-AT-WARNING                     34410029
344200         END-IF                                                   34420029
344300     END-IF.                                                      34430029
344310                                                                  34431058
344400*--------------------------------------------------------------*  34440058
344500* ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  *  34450058
344600* DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   *  34460058
344700* IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        *  34470058
344800* POSITION THE CURSOR THERE.                                   *  34480058
344900*--------------------------------------------------------------*  34490058
345000 4431-POSITION-AT-WARNING.                                        34500029
345010                                                                  34501058
345100     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 34510029
345200                    - PV-TOP-ITEM + 1.                            34520029
345300     IF (PV-SUB < +1 OR > PC-ITEMS-PER-PANEL)                     34530029
345400         CONTINUE                                                 34540029
345500     ELSE                                                         34550029
345600         SET DP030-SET-CURSOR-APPL-1                              34560029
345700                                   TO TRUE                        34570029
345800         MOVE -1                   TO AP-SELECTL (PV-SUB)         34580029
345900         MOVE DP015-REVERSE        TO AP-SELECTH (PV-SUB)         34590029
346000         MOVE DP015-YELLOW         TO AP-SELECTC (PV-SUB)         34600029
346100     END-IF.                                                      34610029
346200                                                                  34620058
346300     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   34630029
346400                    - PV-TOP-ITEM + 1.                            34640029
346500     IF (PV-SUB < +1 OR > PC-ITEMS-PER-PANEL)                     34650029
346600         CONTINUE                                                 34660029
346700     ELSE                                                         34670029
346800         SET DP030-SET-CURSOR-APPL-1                              34680029
346900                                   TO TRUE                        34690029
347000         MOVE -1                   TO AP-SELECTL (PV-SUB)         34700029
347100         MOVE DP015-REVERSE        TO AP-SELECTH (PV-SUB)         34710029
347200         MOVE DP015-YELLOW         TO AP-SELECTC (PV-SUB)         34720029
347300     END-IF.                                                      34730029
347400                                                                  34740058
347500*--------------------------------------------------------------*  34750058
347600* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL     *  34760058
347610* SELECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE       *  34761058
347620* LAYOUT FOR THE SELECTED ITEMS QUEUE.                         *  34762058
347900*                                                              *  34790058
348000* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION   *  34800058
348100* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN  *  34810058
348200* THE ARRAY IS FULL.                                           *  34820058
348300*--------------------------------------------------------------*  34830058
348500 5000-PREPARE-SEL-QUEUE.                                          34850029
348600                                                                  34860029
348700     MOVE +1                   TO  ASC-BLK-SUB.                   34870029
348800     PERFORM 5100-WRITE-TEMP-STORAGE.                             34880029
348900     ADD +1                    TO  ASC-BLK-SUB.                   34890029
349000     PERFORM 5100-WRITE-TEMP-STORAGE.                             34900029
349100                                                                  34910029
349200     MOVE ASC-SEL-QUEUE-NAME-OUT                                  34920029
349300                               TO  AP300-SEL-QUEUE-NAME.          34930029
349400     PERFORM 6010-DELETE-SEL-QUEUE.                               34940029
349500                                                                  34950029
349600     SET ASC-UPDATE-TSQ        TO  TRUE.                          34960029
349700                                                                  34970029
349800     SET AP301-IDX             TO  1.                             34980029
349900     MOVE ZERO                 TO AP301-SELECTED-ITEMS.           34990029
350000     INITIALIZE AP301-SELECTED-ITEM-ARRAY.                        35000029
350100                                                                  35010029
350200     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           35020029
350300             VARYING PV-ITEM                                      35030029
350400             FROM 1 BY 1                                          35040029
350500             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     35050029
350600                                                                  35060029
350700     IF  AP301-IDX > 1                                            35070029
350800         ADD +1                TO AP300-NUMBER-OF-TS-ITEMS        35080029
350900                                  PV-SEL-QUEUE-ITEM               35090029
351000         PERFORM 5205-WRITE-SEL-QUEUE                             35100029
351100     END-IF.                                                      35110029
351200                                                                  35120058
351300*--------------------------------------------------------------*  35130058
351400* WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.       *  35140058
351500* REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.     *  35150058
351600*--------------------------------------------------------------*  35160058
351800 5100-WRITE-TEMP-STORAGE.                                         35180029
351810                                                                  35181058
351900     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     35190029
352000                                   TO PV-LIST-ITEM-NUMBER.        35200029
352100     COMPUTE PV-BLOCK-NUMBER =                                    35210029
352200         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    35220029
352300                                                                  35230029
352400     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             35240029
352500     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             35250029
352600         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      35260029
352700             PERFORM 5105-REWRITE-ASC-LISTQ                       35270029
352800         END-IF                                                   35280029
352900     ELSE                                                         35290029
353000         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       35300029
353100         ASC-HIGHEST-BLOCK-WRITTEN + 1                            35310029
353200         PERFORM 5110-WRITE-ASC-LISTQ                             35320029
353300         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   35330029
353400     END-IF.                                                      35340029
353500                                                                  35350029
353600     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             35360029
353610                                                                  35361058
353700*--------------------------------------------------------------*  35370058
353800* REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    *  35380058
353900* SPECIFIC COMMAREA.                                           *  35390058
354000*--------------------------------------------------------------*  35400058
354100 5105-REWRITE-ASC-LISTQ.                                          35410029
354110                                                                  35411058
354200     EXEC CICS                                                    35420029
354300         WRITEQ TS                                                35430029
354400             QUEUE (ASC-LIST-QUEUE-NAME)                          35440029
354500             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               35450029
354600             ITEM  (PV-BLOCK-NUMBER)                              35460029
354700             REWRITE                                              35470029
354800             RESP  (PV-CICS-RESP)                                 35480029
354900     END-EXEC.                                                    35490029
355000                                                                  35500029
355100     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           35510029
355200         CONTINUE                                                 35520029
355300     ELSE                                                         35530029
355400         SET DP013-CICS-ABEND            TO TRUE                  35540029
355500         SET DP013-NO-ROLLBACK           TO TRUE                  35550029
355600         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       35560029
355700         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     35570029
355800                                         TO DP013-MESSAGE-TEXT(1) 35580029
355900         PERFORM DP013-0000-PROCESS-ABEND                         35590029
356000     END-IF.                                                      35600029
356100                                                                  35610029
356200*--------------------------------------------------------------*  35620058
356300* WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      *  35630058
356400* SPECIFIC COMMAREA.                                           *  35640058
356500*--------------------------------------------------------------*  35650058
356600 5110-WRITE-ASC-LISTQ.                                            35660029
356610                                                                  35661058
356700     EXEC CICS                                                    35670029
356800         WRITEQ TS                                                35680029
356900             QUEUE (ASC-LIST-QUEUE-NAME)                          35690029
357000             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               35700029
357100             ITEM  (PV-BLOCK-NUMBER)                              35710029
357200             RESP  (PV-CICS-RESP)                                 35720029
357300     END-EXEC.                                                    35730029
357400     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      35740029
357500         SET DP013-CICS-ABEND      TO TRUE                        35750029
357600         SET DP013-NO-ROLLBACK     TO TRUE                        35760029
357700         MOVE '5110-WRITE-ASC-LISTQ'                              35770029
357800                                   TO DP013-PARAGRAPH             35780029
357900         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           35790029
358000                                   TO DP013-MESSAGE-TEXT(1)       35800029
358100         PERFORM DP013-0000-PROCESS-ABEND                         35810029
358200     END-IF.                                                      35820029
358300                                                                  35830058
358400*--------------------------------------------------------------*  35840058
358500* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED       *  35850058
358600* OBJECTS TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.     *  35860058
358700*--------------------------------------------------------------*  35870058
358900 5200-FILL-SEL-QUEUE-RECORD.                                      35890029
359000                                                                  35900029
359100     PERFORM 6112-READ-LIST-QUEUE.                                35910029
359200                                                                  35920029
359300     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       35930029
359400         PERFORM                                                  35940029
359500         VARYING LQW-IDX                                          35950029
359600         FROM 1 BY 1                                              35960029
359700         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            35970029
359800           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          35980029
359900                                                                  35990029
360000             IF  LQW-SELECT (LQW-IDX)                             36000029
360100                 ADD +1            TO AP301-SELECTED-ITEMS        36010029
360200                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              36020029
360300                                   TO AP301-ITEM (AP301-IDX)      36030029
360400                                                                  36040029
360500                 MOVE LQW-PAYT-REQ-LNE-NBR (LQW-IDX)              36050029
360600                                   TO AP301-PAYT-REQ-LNE-NBR      36060029
360700                                        (AP301-IDX)               36070029
360800                 MOVE LQW-PO-LINE-NBR (LQW-IDX)                   36080029
360900                                   TO AP301-PO-LNE-NBR            36090029
361000                                        (AP301-IDX)               36100029
361100                 MOVE SPACE        TO AP301-ACTION-SW (AP301-IDX) 36110029
361200                 SET AP301-IDX UP BY 1                            36120029
361300                 IF  AP301-IDX > AP301-MAX-ITEMS                  36130029
361400                     ADD +1      TO AP300-NUMBER-OF-TS-ITEMS      36140029
361500                                    PV-SEL-QUEUE-ITEM             36150029
361600                     PERFORM 5205-WRITE-SEL-QUEUE                 36160029
361700                     MOVE 0      TO AP301-SELECTED-ITEMS          36170029
361800                     INITIALIZE AP301-SELECTED-ITEM-ARRAY         36180029
361900                     SET AP301-IDX TO  1                          36190029
362000                 END-IF                                           36200029
362100             END-IF                                               36210029
362200         END-PERFORM                                              36220029
362300     END-IF.                                                      36230029
362400                                                                  36240029
362500*--------------------------------------------------------------*  36250058
362600* WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                 *  36260058
362700*--------------------------------------------------------------*  36270058
362900 5205-WRITE-SEL-QUEUE.                                            36290029
363000                                                                  36300029
363200     EXEC CICS                                                    36320029
363300          WRITEQ TS                                               36330029
363400              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      36340029
363500              FROM  (AP301-INVC-LIST-TS-RCRD)                     36350029
363600              ITEM  (PV-SEL-QUEUE-ITEM)                           36360029
363700              RESP  (PV-CICS-RESP)                                36370029
363800     END-EXEC.                                                    36380029
363900                                                                  36390029
364000     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          36400029
364100         CONTINUE                                                 36410029
364200     ELSE                                                         36420029
364300         SET DP013-CICS-ABEND      TO TRUE                        36430029
364400         SET DP013-NO-ROLLBACK     TO TRUE                        36440029
364500         MOVE '5205-WRITE-SEL-QUEUE'                              36450029
364600                                   TO DP013-PARAGRAPH             36460029
364700         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          36470029
364800                                   TO DP013-MESSAGE-TEXT(1)       36480029
364900         PERFORM DP013-0000-PROCESS-ABEND                         36490029
365000     END-IF.                                                      36500029
365200                                                                  36520029
365300*--------------------------------------------------------------*  36530058
365400* WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, *  36540058
365500* SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT *  36550058
365600* THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    *  36560058
365700* THE USER.                                                    *  36570058
365800*--------------------------------------------------------------*  36580058
366000 6000-REFRESH-PANEL-FROM-TEMP.                                    36600029
366100                                                                  36610029
366200     IF  ASC-UPDATE-TSQ AND                                       36620029
366300         ASC-NUMBER-OF-SELECTED-ITEMS > 0                         36630029
366400         SET ASC-NO-TSQ-UPDATE TO TRUE                            36640029
366500         MOVE ZERO                 TO PV-SAVE-ITEM                36650029
366600                                      PV-SEL-QUEUE-ITEM           36660029
366700         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        36670029
366800                                   TO PV-HOLD-SELECTED-ITEMS      36680029
366900         MOVE +1                   TO PV-ITEMS-PROCESSED          36690029
367000         PERFORM 6100-UPDATE-TSQ                                  36700029
367100             UNTIL PV-ITEMS-PROCESSED >                           36710029
367200                                     PV-HOLD-SELECTED-ITEMS       36720029
367300         PERFORM 6010-DELETE-SEL-QUEUE                            36730029
367400         INITIALIZE ASC-BLOCK-ENTRIES (1)                         36740029
367500                    ASC-BLOCK-ENTRIES (2)                         36750029
367600     END-IF.                                                      36760029
367700                                                                  36770029
367800*--------------------------------------------------------------*  36780058
367900* DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *  36790058
368000*--------------------------------------------------------------*  36800058
368200 6010-DELETE-SEL-QUEUE.                                           36820029
368300                                                                  36830029
368400     EXEC CICS                                                    36840029
368500         DELETEQ TS                                               36850029
368600             QUEUE (ASC-SEL-QUEUE-NAME-OUT)                       36860029
368700             RESP  (PV-CICS-RESP)                                 36870029
368800     END-EXEC.                                                    36880029
368900                                                                  36890029
369000     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      36900029
369100        (PV-CICS-RESP = DFHRESP(QIDERR)))                         36910029
369200         CONTINUE                                                 36920029
369300     ELSE                                                         36930029
369400         SET DP013-CICS-ABEND TO TRUE                             36940029
369500         SET DP013-NO-ROLLBACK TO TRUE                            36950029
369600         MOVE '6010-DELETE-SEL-QUEUE'                             36960029
369700                        TO DP013-PARAGRAPH                        36970029
369800         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         36980029
369900                        TO DP013-MESSAGE-TEXT (1)                 36990029
370000         PERFORM DP013-0000-PROCESS-ABEND                         37000029
370100     END-IF.                                                      37010029
370200                                                                  37020029
370300*--------------------------------------------------------------*  37030058
370400* INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.       *  37040058
370500* LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER   *  37050058
370600* TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN     *  37060058
370700* THE TEMP QUEUE.                                              *  37070058
370800*--------------------------------------------------------------*  37080058
371000 6100-UPDATE-TSQ.                                                 37100029
371100                                                                  37110029
371200     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             37120029
371300     PERFORM 6105-READ-SEL-QUEUE.                                 37130029
371400     PERFORM                                                      37140029
371500         VARYING AP301-IDX                                        37150029
371600         FROM 1 BY 1                                              37160029
371700         UNTIL ((PV-ITEMS-PROCESSED >                             37170029
371800                              PV-HOLD-SELECTED-ITEMS)             37180029
371900         OR (AP301-IDX GREATER THAN AP301-MAX-ITEMS))             37190029
372000         IF  AP301-ACTION-SW (AP301-IDX) > SPACE                  37200029
372100             PERFORM 6110-PROCESS-ITEMS                           37210029
372200         END-IF                                                   37220029
372300         ADD +1                TO PV-ITEMS-PROCESSED              37230029
372400     END-PERFORM.                                                 37240029
372500                                                                  37250029
372600     IF PV-SAVE-ITEM NOT EQUAL ZERO                               37260029
372700         PERFORM 6111-WRITE-LIST-QUEUE                            37270029
372800     END-IF.                                                      37280029
372900                                                                  37290029
373000*--------------------------------------------------------------*  37300058
373100* READ THE LIST QUEUE RECORD.                                  *  37310058
373200*--------------------------------------------------------------*  37320058
373400 6105-READ-SEL-QUEUE.                                             37340029
373500                                                                  37350029
373600     EXEC CICS                                                    37360029
373700          READQ TS                                                37370029
373800              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      37380029
373900              INTO  (AP301-INVC-LIST-TS-RCRD)                     37390029
374000              ITEM  (PV-SEL-QUEUE-ITEM)                           37400029
374100              RESP  (PV-CICS-RESP)                                37410029
374200     END-EXEC.                                                    37420029
374300                                                                  37430029
374400     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          37440029
374500         CONTINUE                                                 37450029
374600     ELSE                                                         37460029
374700         SET DP013-CICS-ABEND      TO  TRUE                       37470029
374800         SET DP013-NO-ROLLBACK     TO  TRUE                       37480029
374900         MOVE '6105-READ-SEL-QUEUE'                               37490029
375000                                   TO  DP013-PARAGRAPH            37500029
375100         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           37510029
375200                                   TO  DP013-MESSAGE-TEXT(1)      37520029
375300         PERFORM DP013-0000-PROCESS-ABEND                         37530029
375400     END-IF.                                                      37540029
375600                                                                  37560029
375700*--------------------------------------------------------------*  37570058
375800* CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT. *  37580058
375900* REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE *  37590058
376000* THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.            *  37600058
376100*--------------------------------------------------------------*  37610058
376300 6110-PROCESS-ITEMS.                                              37630029
376400                                                                  37640029
376500     COMPUTE PV-ITEM = 1 + ((AP301-ITEM (AP301-IDX) - 1)          37650029
376600                     / PC-ITEMS-PER-PANEL).                       37660029
376700                                                                  37670029
376800     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           37680029
376900         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          37690029
377000             PERFORM 6111-WRITE-LIST-QUEUE                        37700029
377100         END-IF                                                   37710029
377200         MOVE PV-ITEM          TO PV-SAVE-ITEM                    37720029
377300                                                                  37730029
377400         PERFORM 6112-READ-LIST-QUEUE                             37740029
377500         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               37750029
377600             CONTINUE                                             37760029
377700         END-IF                                                   37770029
377800     END-IF.                                                      37780029
377900                                                                  37790029
378000     COMPUTE PV-SUB = (AP301-ITEM (AP301-IDX)                     37800029
378100                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              37810029
378200     SET LQW-DESELECT (PV-SUB) TO    TRUE                         37820029
378300     MOVE LQW-SELECTED-SW (PV-SUB)                                37830029
378400                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  37840029
378500                                                                  37850029
378600     EVALUATE TRUE                                                37860029
378700         WHEN AP301-INQ (AP301-IDX)                               37870029
378800              MOVE PC-INQ    TO LQW-ACTION (PV-SUB)               37880029
378900                                                                  37890029
379000         WHEN AP301-UPD (AP301-IDX)                               37900029
379100              MOVE PC-UPD    TO LQW-ACTION (PV-SUB)               37910029
379200                                                                  37920029
379300         WHEN AP301-DEL (AP301-IDX)                               37930029
379400              MOVE PC-DEL    TO LQW-ACTION (PV-SUB)               37940029
379500                                                                  37950029
379600         WHEN AP301-ERR (AP301-IDX)                               37960029
379700              MOVE PC-ERR    TO LQW-ACTION (PV-SUB)               37970029
379800     END-EVALUATE.                                                37980029
379900                                                                  37990029
380000     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                38000029
380100                                                                  38010029
380200*--------------------------------------------------------------*  38020058
380300* WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.              *  38030058
380400*--------------------------------------------------------------*  38040058
380600 6111-WRITE-LIST-QUEUE.                                           38060029
380700                                                                  38070029
380800     EXEC CICS                                                    38080029
380900         WRITEQ TS                                                38090029
381000             QUEUE (ASC-LIST-QUEUE-NAME)                          38100029
381100             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     38110029
381200             ITEM  (PV-SAVE-ITEM)                                 38120029
381300             REWRITE                                              38130029
381400             RESP  (PV-CICS-RESP)                                 38140029
381500     END-EXEC.                                                    38150029
381600                                                                  38160029
381700     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          38170029
381800         CONTINUE                                                 38180029
381900     ELSE                                                         38190029
382000         SET DP013-CICS-ABEND  TO  TRUE                           38200029
382100         SET DP013-NO-ROLLBACK TO  TRUE                           38210029
382200         MOVE '6111-WRITE-LIST-QUEUE'                             38220029
382300                               TO  DP013-PARAGRAPH                38230029
382400         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  38240029
382500                               TO  DP013-MESSAGE-TEXT(1)          38250029
382600         PERFORM DP013-0000-PROCESS-ABEND                         38260029
382700     END-IF.                                                      38270029
382800                                                                  38280029
383000*--------------------------------------------------------------*  38300058
383100* READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA. *  38310058
383200*--------------------------------------------------------------*  38320058
383400 6112-READ-LIST-QUEUE.                                            38340029
383500                                                                  38350029
383600     EXEC CICS                                                    38360029
383700         READQ TS                                                 38370029
383800             QUEUE (ASC-LIST-QUEUE-NAME)                          38380029
383900             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     38390029
384000             ITEM  (PV-ITEM)                                      38400029
384100             RESP  (PV-CICS-RESP)                                 38410029
384200     END-EXEC.                                                    38420029
384300                                                                  38430058
384400     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          38440029
384500         CONTINUE                                                 38450029
384600     ELSE                                                         38460029
384700         SET DP013-CICS-ABEND        TO TRUE                      38470029
384800         SET DP013-NO-ROLLBACK       TO TRUE                      38480029
384900         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           38490029
385000         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    38500029
385100                                     TO DP013-MESSAGE-TEXT(1)     38510029
385200         PERFORM DP013-0000-PROCESS-ABEND                         38520029
385300     END-IF.                                                      38530029
385400                                                                  38540029
385500*--------------------------------------------------------------*  38550058
385600* PHYSICALLY LOOPS THROUGH ALL ITEMS IN THE LIST TEMP STORAGE  *  38560058
385700* QUEUE.  PERFORMS THE ADD PARAGRAPH ONCE AN ITEM IS FOUND TO  *  38570058
385800* BE SELECTED.                                                 *  38580058
385900*--------------------------------------------------------------*  38590058
386000 8000-PROCESS-UPDATE-TSQ.                                         38600029
386100                                                                  38610029
386200     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              38620029
386300                                 TO PV-LIST-ITEM-NUMBER.          38630029
386400     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            38640029
386500         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    38650029
386600                                                                  38660029
386700     MOVE +1                     TO ASC-BLK-SUB                   38670029
386800                                                                  38680029
386900     PERFORM                                                      38690029
387000         VARYING PV-BLOCK-NUMBER                                  38700029
387100         FROM 1 BY 1                                              38710029
387200         UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN        38720029
387300                                                                  38730029
387400         PERFORM 4410-READ-TEMP-STORAGE                           38740029
387500                                                                  38750029
387600         PERFORM                                                  38760029
387700             VARYING ASC-ITEM-SUB                                 38770029
387800             FROM 1 BY 1                                          38780029
387900             UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL              38790029
388000                                                                  38800029
388100             IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)             38810029
388200                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              38820029
388300                                 TO TRUE                          38830029
388400                 SET ASC-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)     38840029
388500                                 TO TRUE                          38850029
388600                 SET ASC-TEMP-NO-SELECT                           38860029
388700                                   (ASC-BLK-SUB ASC-ITEM-SUB)     38870029
388800                                 TO TRUE                          38880029
388900                 SUBTRACT +1  FROM ASC-NUMBER-OF-SELECTED-ITEMS   38890029
389000             END-IF                                               38900029
389100                                                                  38910029
389200         END-PERFORM                                              38920029
389300                                                                  38930029
389400         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      38940029
389500             PERFORM 5105-REWRITE-ASC-LISTQ                       38950029
389600         END-IF                                                   38960029
389700                                                                  38970029
389800     END-PERFORM.                                                 38980029
389900                                                                  38990029
390000     MOVE +1                     TO ASC-BLK-SUB.                  39000029
390100     MOVE PV-FIRST-BLOCK-IN-ARRAY                                 39010029
390200                                 TO PV-BLOCK-NUMBER.              39020029
390300     PERFORM 4410-READ-TEMP-STORAGE.                              39030029
390400                                                                  39040029
390500     ADD +1                      TO PV-BLOCK-NUMBER               39050029
390600                                    ASC-BLK-SUB.                  39060029
390700     PERFORM 4410-READ-TEMP-STORAGE.                              39070029
390800                                                                  39080029
390900                                                                  39090029
390910*--------------------------------------------------------------*  39091058
390920* CHECK IF THE PO/MATCH LEVEL COMBINATION HAS ALREADY BEEN     *  39092058
390930* PROCESSED.                                                   *  39093058
390950*--------------------------------------------------------------*  39095058
391000 8800-CHECK-IF-PROCESSED.                                         39100029
391100                                                                  39110029
391200     PERFORM                                                      39120029
391300         WITH TEST AFTER                                          39130029
391400         VARYING PV-RETRY-COUNTER                                 39140029
391500         FROM 1 BY 1                                              39150029
391600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               39160029
391700             OR (SQLCODE = +0))                                   39170029
391800                                                                  39180029
391900         EXEC SQL                                                 39190029
392000             SELECT COUNT(*)                                      39200029
392100               INTO :PV-DB2-COUNT                                 39210029
392200               FROM TPOSTRR A                                     39220029
392300                   ,TINVOIC B                                     39230029
392400              WHERE A.PO_NBR       = :ASC-KEY-PO-NUMBER           39240029
392500                AND A.STR_NBR      = :ASC-KEY-STORE-NUMBER        39250029
392600                AND A.STATUS_CDE   = ' '                          39260029
392700                AND B.INVC_ID      = :ASC-KEY-INVOICE-ID          39270029
392800                AND A.MTCH_LVL_CDE = B.MTCH_LVL_CDE               39280041
392900                AND B.INVC_TYP_CDE = 'RI'                         39290029
393000         END-EXEC                                                 39300029
393100                                                                  39310029
393200         EVALUATE TRUE                                            39320029
393300             WHEN SQLCODE = +0                                    39330029
393400             WHEN SQLCODE = -305                                  39340029
393500             WHEN SQLCODE = -904                                  39350029
393600             WHEN SQLCODE = -913                                  39360029
393700                  CONTINUE                                        39370029
393800                                                                  39380029
393900             WHEN SQLWARN0 NOT = SPACES                           39390029
394000             WHEN SQLCODE  NOT = ZERO                             39400029
394100                  MOVE '8800-CHECK-IF-PROCESSED'                  39410029
394200                                  TO DP013-PARAGRAPH              39420029
394300                  MOVE 'UNSUCCESSFUL SELECT COUNT'                39430029
394400                                  TO DP013-MESSAGE-TEXT (1)       39440029
394500                  MOVE SQLCA      TO DP013-SQLCA                  39450029
394600                  MOVE 'TPOSTRR ' TO DP013-DB2-TABLE-NAME (1)     39460029
394700                  MOVE 'TINVOIC ' TO DP013-DB2-TABLE-NAME (2)     39470029
394800                  SET DP013-DB2-ABEND                             39480029
394900                      DP013-XCTL-DISPLAY-RESTART                  39490029
395000                                  TO TRUE                         39500029
395100                  PERFORM DP013-0000-PROCESS-ABEND                39510029
395200         END-EVALUATE                                             39520029
395300     END-PERFORM.                                                 39530029
395400                                                                  39540029
395500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        39550029
395600         MOVE '8800-CHECK-IF-PROCESSED'                           39560029
395700                                  TO DP013-PARAGRAPH              39570029
395800         MOVE 'MAX RETRIES EXCEEDED FOR SELECT COUNT'             39580029
395900                                  TO DP013-MESSAGE-TEXT (1)       39590029
396000         MOVE SQLCA               TO DP013-SQLCA                  39600029
396100         MOVE 'TPOSTRR '          TO DP013-DB2-TABLE-NAME (1)     39610029
396200         MOVE 'TINVOIC '          TO DP013-DB2-TABLE-NAME (2)     39620029
396300         SET DP013-DB2-ABEND                                      39630029
396400             DP013-XCTL-DISPLAY-RESTART                           39640029
396500                                  TO TRUE                         39650029
396600         PERFORM DP013-0000-PROCESS-ABEND                         39660029
396700     END-IF.                                                      39670029
396800                                                                  39680029
396900     IF SQLCODE = ZERO AND PV-DB2-COUNT > ZERO                    39690029
397000         MOVE DP015-UNP-ALP-BRT-OFF                               39700029
397100                              TO APONBRA                          39710029
397200         MOVE DP015-RED       TO APONBRC                          39720029
397300         MOVE DP015-REVERSE   TO APONBRH                          39730029
397400         SET PS-ERROR         TO TRUE                             39740029
397500     END-IF.                                                      39750029
397600                                                                  39760058
397700*--------------------------------------------------------------*  39770058
397800* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.     *  39780058
397900*--------------------------------------------------------------*  39790058
398100 9100-READ-SEL-QUEUE.                                             39810029
398200                                                                  39820029
398300     EXEC CICS                                                    39830029
398400         READQ TS                                                 39840029
398500             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        39850029
398600             INTO  (AP301-INVC-LIST-TS-RCRD)                      39860029
398700             ITEM  (ASC-SEL-ITEM)                                 39870029
398800             RESP  (PV-CICS-RESP)                                 39880029
398900     END-EXEC.                                                    39890029
399000                                                                  39900029
399100     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       39910029
399200         CONTINUE                                                 39920029
399300     ELSE                                                         39930029
399400         SET DP013-LOGIC-ABEND                                    39940029
399500             DP013-NO-ROLLBACK     TO TRUE                        39950029
399600         MOVE '9100-READ-SEL-QUEUE'                               39960029
399700                                   TO DP013-PARAGRAPH             39970029
399800         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   39980029
399900                                   TO DP013-MESSAGE-TEXT (1)      39990029
400000         PERFORM DP013-0000-PROCESS-ABEND                         40000029
400100     END-IF.                                                      40010029
400200                                                                  40020029
400400*--------------------------------------------------------------*  40040058
400500* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.     *  40050058
400600*--------------------------------------------------------------*  40060058
400700 9200-REWRITE-LIST-QUEUE.                                         40070029
400800                                                                  40080029
400900     EXEC CICS                                                    40090029
401000          WRITEQ TS                                               40100029
401100              QUEUE  (ASC-SEL-QUEUE-NAME-IN)                      40110029
401200              FROM   (AP301-INVC-LIST-TS-RCRD)                    40120029
401300              ITEM   (ASC-SEL-ITEM)                               40130029
401400              RESP   (PV-CICS-RESP)                               40140029
401500              REWRITE                                             40150029
401600     END-EXEC.                                                    40160029
401700                                                                  40170029
401800     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   40180029
401900         SET DP013-CICS-ABEND                                     40190029
402000             DP013-NO-ROLLBACK     TO TRUE                        40200029
402100         MOVE '9200-REWRITE-LIST-QUEUE'                           40210029
402200                                   TO DP013-PARAGRAPH             40220029
402300         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   40230029
402400                                   TO DP013-MESSAGE-TEXT (1)      40240029
402500         PERFORM DP013-0000-PROCESS-ABEND                         40250029
402600     END-IF.                                                      40260029
402700                                                                  40270029
402900*--------------------------------------------------------------*  40290058
403000* ABEND PROCESSOR MODULE                                       *  40300058
403100*--------------------------------------------------------------*  40310058
403300     COPY DPPD013.                                                40330029
403310                                                                  40331058
403400*--------------------------------------------------------------*  40340058
403500* DATE AND TIME MODULE                                         *  40350058
403600*--------------------------------------------------------------*  40360058
403800     COPY DPPD017.                                                40380029
403900                                                                  40390058
