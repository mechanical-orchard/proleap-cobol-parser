001030******************************************************************        
001031 IDENTIFICATION DIVISION.                                                 
001032******************************************************************        
001033                                                                          
001034 PROGRAM-ID.    SUKUT179.                                                 
001035 AUTHOR.        DENISE HAHN                                               
001036 INSTALLATION.  KOHLS.                                                    
001037 DATE-WRITTEN   MAY, 2016.                                                
001038 DATE-COMPILED.                                                           
001040                                                                          
001100******************************************************************        
001200*  THIS PROGRAM READS THE EXTRACT FILE CONTAINING THE SHIPPED             
001300*  CARTONS FOR A GIVEN DATE RANGE.  CREATE BY SUKUT176                    
001301*                                                                         
001302*  EXTRACT FILE IS THEN PROCESSED BY SUKUT177 TO GET THE FOLLOWING        
001304*  FOR EACH TRIP - GET THE TRIP CONTENTS                                  
001305*      - SML#'S FROM SUT_OTBND_CART (OTBND_TRIP_ID)                       
001306*      - P2L CARTON - DETERMINE - OPEN/CLOSE TMST                         
001307*        TIMES CONVERTED TO CENTRAL TIME BASED ON PARM                    
001308*        TIMEZN - DIFFERENCE BETWEEN DC AND CENTRAL TIME                  
001309*      - CHECK WHEN THE CARTON WAS ATTACHED TO THE TRAILER                
001310*      - CHECK IF SCANNED ON OR DIVERTED TO THE TRAILER                   
001311*      - CHECK IF CARTON WAS PART OF A MASTER CONTAINER                   
001314*                                                                         
001315*  SUKUT178 WILL GET THE CARTON CONTENTS AND RECEIVER INFORMATION         
001316*                                                                         
001317*  SUKUT179 WILL CALCULATE THE TIMES BETWEEN EACH STATUS                  
001318*                                                                         
001319*  INPUT FILE IS IN SURD117 FORMAT                                        
001320*  OUTPUT FILE IS IN SURD117 FORMAT                                       
001330*  COMMA DELIMITED FILE IS IN SURD122 FORMAT                              
001400******************************************************************        
001500                                                                          
001600******************************************************************        
001700 ENVIRONMENT DIVISION.                                                    
001800******************************************************************        
001900                                                                          
002000 CONFIGURATION SECTION.                                                   
002100                                                                          
002200 SOURCE-COMPUTER.        IBM-3090.                                        
002300 OBJECT-COMPUTER.        IBM-3090.                                        
002400                                                                          
002500 INPUT-OUTPUT SECTION.                                                    
002600                                                                          
002700 FILE-CONTROL.                                                            
002800                                                                          
003300     SELECT INPUT-FILE                                                    
003400            ASSIGN TO INP01.                                              
003401                                                                          
003402     SELECT OUTPUT-FILE                                                   
003403            ASSIGN TO OUT01.                                              
003404                                                                          
003405     SELECT COMMA-DELIMITED-FILE                                          
003406            ASSIGN TO OUT02.                                              
003410                                                                          
003500******************************************************************        
003600 DATA DIVISION.                                                           
003700******************************************************************        
003800                                                                          
003900 FILE SECTION.                                                            
003910                                                                          
004000 FD  INPUT-FILE                                                           
004100     RECORDING MODE IS F                                                  
004200     LABEL RECORDS ARE STANDARD                                           
004400     BLOCK CONTAINS 0 RECORDS.                                            
004600 01  INPUT-RECORD               PIC X(550).                               
004700                                                                          
004800 FD  OUTPUT-FILE                                                          
004900     RECORDING MODE IS F                                                  
005000     LABEL RECORDS ARE STANDARD                                           
005100     BLOCK CONTAINS 0 RECORDS.                                            
005300 01  OUTPUT-RECORD              PIC X(550).                               
005470                                                                          
005480 FD  COMMA-DELIMITED-FILE                                                 
005490     RECORDING MODE IS F                                                  
005491     LABEL RECORDS ARE STANDARD                                           
005492     BLOCK CONTAINS 0 RECORDS.                                            
005493 01  COMMA-RECORD              PIC X(800).                                
005494                                                                          
005500                                                                          
005600******************************************************************        
005700 WORKING-STORAGE SECTION.                                                 
005800******************************************************************        
005801                                                                          
005810 01  DK-FIELDS.                                                           
005820     05  DK-OTBND-TRIP-ID                  PIC S9(09)  COMP.              
005821     05  DK-SHIPT-UNT-ID                   PIC S9(18)V COMP-3.            
005822     05  DK-OPER-UNT-ID                    PIC S9(04)  COMP.              
005823     05  DK-DEST-OPER-UNT-ID               PIC S9(04)  COMP.              
005830                                                                          
005840 01  PROGRAM-VARIABLES.                                                   
005841     05  PV-PARAGRAPH-NAME                  PIC  X(40).                   
005842     05  PV-DB2-OPERATION-ATTEMPTED         PIC  X(40).                   
005843*                                                                         
005844     05  PV-MESSAGE-1                       PIC  X(100).                  
005845     05  PV-MESSAGE-2                       PIC  X(100).                  
005846     05  PV-SQLCODE                         PIC  -999.                    
005847*                                                                         
005848     05  PV-FROM-TIMESTAMP                  PIC X(26).                    
005849     05  PV-FROM-TIMESTAMP-R REDEFINES PV-FROM-TIMESTAMP.                 
005850         10  PV-FROM-TMST-DATE              PIC X(10).                    
005851         10  PV-FROM-TMST-DASH1             PIC X(01).                    
005852         10  PV-FROM-TMST-TIME              PIC X(08).                    
005853         10  PV-FROM-TMST-DASH2             PIC X(01).                    
005854         10  PV-FROM-TMST-MM                PIC 9(06).                    
005855*                                                                         
005856     05  PV-TO-TIMESTAMP                    PIC X(26).                    
005857     05  PV-TO-TIMESTAMP-R REDEFINES PV-TO-TIMESTAMP.                     
005858         10  PV-TO-TMST-DATE                PIC X(10).                    
005859         10  PV-TO-TMST-DASH1               PIC X(01).                    
005860         10  PV-TO-TMST-TIME                PIC X(08).                    
005861         10  PV-TO-TMST-DASH2               PIC X(01).                    
005862         10  PV-TO-TMST-MM                  PIC 9(06).                    
005863*                                                                         
005864     05  PV-DIFF-MIN                        PIC S9(09) COMP.              
006036*                                                                         
006037     05  PV-CALC-DESCRIPTION                PIC  X(22).                   
006038     05  PV-DISP-SQLCODE                    PIC -999.                     
006039     05  PV-DISP-OPER                       PIC  Z(04).                   
006040     05  PV-DISP-DEST-OPER                  PIC  Z(04).                   
006041     05  PV-DISP-STORE                      PIC  Z(04).                   
006042     05  PV-DISP-TRIP                       PIC  Z(09).                   
006043     05  PV-DISP-SML                        PIC  9(18).                   
006044     05  PV-DISP-MSTR                       PIC  9(18).                   
006045*                                                                         
006046     05  PV-DISPLAY-COUNT                   PIC  ZZZ,ZZZ,ZZZ.             
006047     05  PV-INPUT-COUNTER                   PIC  9(09).                   
006048     05  PV-INPUT-BREAK                     PIC  9(09).                   
006049     05  PV-WRITE-COUNTER                   PIC  9(09).                   
006051                                                                          
006052 01  ABEND-CODE                      PIC S9(04)    VALUE +0               
006053                                                   COMP SYNC.             
006054 01  PROGRAM-SWITCHES.                                                    
006055     05  PS-EOF-INPUT-SW                    PIC X(01) VALUE 'N'.          
006056         88  PS-EOF-INPUT                             VALUE 'Y'.          
006057         88  PS-EOF-INPUT-NO                          VALUE 'N'.          
006064                                                                          
006263* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         
006264*                                                                         
006265* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         
006266     EXEC SQL                                                             
006267          INCLUDE SQLCA                                                   
006268     END-EXEC.                                                            
006269                                                                          
006270                                                                          
006280*-----------------------------------------------------------------        
006290* INPUT/OUTPUT FILE LAYOUT                                                
006300*-----------------------------------------------------------------        
006400     COPY SURD117.                                                        
006500                                                                          
006600*-----------------------------------------------------------------        
006700* COMMA DELIMITED FILE LAYOUT                                             
006800*-----------------------------------------------------------------        
006900     COPY SURD122.                                                        
007000                                                                          
007300*-----------------------------------------------------------------        
007500*  DB2 FORMATTED MESSAGE AREA                                             
007510*-----------------------------------------------------------------        
007700     COPY DPWS004.                                                        
007800                                                                          
018300                                                                          
018400                                                                          
018600 PROCEDURE DIVISION.                                                      
018801                                                                          
018810*-----------------------------------------------------------------        
018820*                                                                         
018840*-----------------------------------------------------------------        
018900 0000-PROGRAM-MAINLINE.                                                   
019400                                                                          
019500     PERFORM 1000-INITIALIZE.                                             
019510                                                                          
019520     DISPLAY '********************************************'               
019521             '************'.                                              
019600     IF  PS-EOF-INPUT-NO                                                  
019700         PERFORM 2000-PROCESS-FILE                                        
019800           UNTIL PS-EOF-INPUT                                             
019900     END-IF.                                                              
019910                                                                          
020000     PERFORM 9000-EOJ-ROUTINE.                                            
020113                                                                          
020131     DISPLAY '********************************************'               
020132             '************'.                                              
020140                                                                          
020200     STOP RUN.                                                            
020300                                                                          
020310                                                                          
020320*-----------------------------------------------------------------        
020330*  DO FIRST TIME PROGRAM INITIALIZATION TASKS.                            
020340*    -- OPEN INPUT FILE                                                   
020341*    -- OPEN OUTPUT FILE                                                  
020350*    -- INITIAL READ OF INPUT                                             
020361*    -- IF EMPTY FILE  - JOB FINISHES - NOTHING TO REPORT                 
020370*-----------------------------------------------------------------        
020400 1000-INITIALIZE.                                                         
021100                                                                          
021500     OPEN INPUT  INPUT-FILE                                               
021510          OUTPUT OUTPUT-FILE                                              
021520          OUTPUT COMMA-DELIMITED-FILE.                                    
021600                                                                          
021700     PERFORM 8000-READ-INPUT-REC.                                         
021710                                                                          
022001     IF  PS-EOF-INPUT                                                     
022002         MOVE 4095  TO  ABEND-CODE                                        
022003     END-IF.                                                              
022004                                                                          
022010                                                                          
025449*-----------------------------------------------------------------        
025450*  LOOP THROUGH THE RESULTS TABLE.                                        
025451*  FORMAT THE OUTPUT RECORD.  WRITE THE RECORDS THAT MEET CRITERIA.       
025452*-----------------------------------------------------------------        
025460 2000-PROCESS-FILE.                                                       
026000                                                                          
026001     MOVE ZEROES    TO  SU117-ARRIVE-TO-PRC-MIN                           
026002                        SU117-ARRIVE-TO-P2L-PKD-MIN                       
026003                        SU117-PRC-TO-P2L-PKD-MIN                          
026004                        SU117-P2L-PKD-TO-CLOSE-MIN                        
026005                        SU117-P2L-OPEN-TO-CLOSE-MIN                       
026006                        SU117-P2L-OPEN-TO-OTBND-MIN                       
026007                        SU117-P2L-CLOSE-TO-OTBND-MIN                      
026008                        SU117-ARRIVE-TO-OTBND-MIN                         
026009                        SU117-PRC-TO-OTBND-MIN                            
026010                        SU117-ARRIVE-TO-TCLOS-MIN                         
026011                        SU117-ARRIVE-TO-SHIP-MIN                          
026012                        SU117-P2L-OPEN-TO-TCLOS-MIN                       
026013                        SU117-P2L-OPEN-TO-SHIP-MIN                        
026014                        SU117-P2L-CLOSE-TO-TCLOS-MIN                      
026015                        SU117-P2L-CLOSE-TO-SHIP-MIN                       
026016                        SU117-ARRIVE-TO-MSTR-MIN                          
026017                        SU117-PRC-TO-MSTR-MIN                             
026018                        SU117-MSTR-CRE-TO-OTBND-MIN                       
026019                        SU117-MSTR-CRE-TO-TCLOS-MIN                       
026020                        SU117-MSTR-CRE-TO-SHIP-MIN                        
026021                        SU117-MSTR-FIRST-TO-OTBND-MIN                     
026022                        SU117-MSTR-FIRST-TO-TCLOS-MIN                     
026023                        SU117-MSTR-FIRST-TO-SHIP-MIN                      
026024                        SU117-MSTR-LAST-TO-OTBND-MIN                      
026025                        SU117-MSTR-LAST-TO-TCLOS-MIN                      
026026                        SU117-MSTR-LAST-TO-SHIP-MIN                       
026027                        SU117-ON-OTBND-TO-CLOS-MIN                        
026028                        SU117-ON-OTBND-TO-SHIP-MIN.                       
026029                                                                          
026031     MOVE ZEROES    TO  SU122-TRIP-OPEN-TO-CLOSE-MIN                      
026033                        SU122-TRIP-CLOSE-TO-SHIP-MIN                      
026035                        SU122-TRIP-OPEN-TO-SHIP-MIN                       
026124                        SU122-ARRIVE-TO-PRC-MIN                           
026126                        SU122-ARRIVE-TO-P2L-PKD-MIN                       
026128                        SU122-PRC-TO-P2L-PKD-MIN                          
026130                        SU122-P2L-PKD-TO-CLOSE-MIN                        
026132                        SU122-P2L-OPEN-TO-OTBND-MIN                       
026134                        SU122-P2L-OPEN-TO-CLOSE-MIN                       
026136                        SU122-P2L-CLOSE-TO-OTBND-MIN                      
026138                        SU122-ARRIVE-TO-OTBND-MIN                         
026140                        SU122-PRC-TO-OTBND-MIN                            
026142                        SU122-ARRIVE-TO-TCLOS-MIN                         
026144                        SU122-ARRIVE-TO-SHIP-MIN                          
026146                        SU122-P2L-OPEN-TO-TCLOS-MIN                       
026148                        SU122-P2L-OPEN-TO-SHIP-MIN                        
026150                        SU122-P2L-CLOSE-TO-TCLOS-MIN                      
026152                        SU122-P2L-CLOSE-TO-SHIP-MIN                       
026154                        SU122-ARRIVE-TO-MSTR-MIN                          
026156                        SU122-PRC-TO-MSTR-MIN                             
026158                        SU122-MSTR-CRE-TO-OTBND-MIN                       
026160                        SU122-MSTR-CRE-TO-TCLOS-MIN                       
026162                        SU122-MSTR-CRE-TO-SHIP-MIN                        
026164                        SU122-MSTR-FIRST-TO-OTBND-MIN                     
026166                        SU122-MSTR-FIRST-TO-TCLOS-MIN                     
026168                        SU122-MSTR-FIRST-TO-SHIP-MIN                      
026170                        SU122-MSTR-LAST-TO-OTBND-MIN                      
026172                        SU122-MSTR-LAST-TO-TCLOS-MIN                      
026174                        SU122-MSTR-LAST-TO-SHIP-MIN                       
026176                        SU122-ON-OTBND-TO-CLOS-MIN                        
026178                        SU122-ON-OTBND-TO-SHIP-MIN.                       
026179                                                                          
026180*  ARRIVAL TO PROCESS                                                     
026181*                                                                         
026182* DMH 9/01/16 BEGIN                                                       
026183     IF  SU117-REC-SEQ-ARRIVE-DTE  =  '9999-09-09'  AND                   
026184         SU117-SRC-CART-PRC-DTE    >  SPACES  AND                         
026185         SU117-SRC-CART-PRC-TM     >  SPACES                              
026186         MOVE 1                    TO  SU117-ARRIVE-TO-PRC-MIN            
026187     ELSE                                                                 
026188* DMH 9/01/16 BEGIN                                                       
026189*                                                                         
026190     IF  SU117-REC-SEQ-ARRIVE-DTE  >  SPACES  AND                         
026191         SU117-REC-SEQ-ARRIVE-TM   >  SPACES  AND                         
026192         SU117-SRC-CART-PRC-DTE    >  SPACES  AND                         
026193         SU117-SRC-CART-PRC-TM     >  SPACES                              
026194         MOVE SU117-REC-SEQ-ARRIVE-DTE  TO PV-FROM-TMST-DATE              
026195         MOVE SU117-REC-SEQ-ARRIVE-TM   TO PV-FROM-TMST-TIME              
026196         MOVE SU117-SRC-CART-PRC-DTE    TO PV-TO-TMST-DATE                
026197         MOVE SU117-SRC-CART-PRC-TM     TO PV-TO-TMST-TIME                
026198         MOVE '-'                       TO PV-FROM-TMST-DASH1             
026199                                           PV-TO-TMST-DASH1               
026200         MOVE '.'                       TO PV-FROM-TMST-DASH2             
026201                                           PV-TO-TMST-DASH2               
026202         MOVE ZEROES                    TO PV-FROM-TMST-MM                
026203                                           PV-TO-TMST-MM                  
026204         MOVE 'ARRIVE TO PROCESS     ' TO  PV-CALC-DESCRIPTION            
026205         PERFORM 3000-CALC-TIME-DIFFERENCE                                
026206         MOVE PV-DIFF-MIN          TO  SU117-ARRIVE-TO-PRC-MIN            
026207     ELSE                                                                 
026208         MOVE ZEROES               TO  SU117-ARRIVE-TO-PRC-MIN            
026209     END-IF                                                               
026210     END-IF.                                                              
026211                                                                          
026212*  ARRIVAL TO P2L/JWL PACKED                                              
026213*                                                                         
026214* DMH 9/01/16 BEGIN                                                       
026215     IF  SU117-REC-SEQ-ARRIVE-DTE  =  '9999-09-09'  AND                   
026216         SU117-PKD-IN-P2L-SML-DTE  >  SPACES AND                          
026217         SU117-PKD-IN-P2L-SML-TM   >  SPACES                              
026218         MOVE 1                    TO  SU117-ARRIVE-TO-P2L-PKD-MIN        
026219     ELSE                                                                 
026220* DMH 9/01/16 BEGIN                                                       
026221*                                                                         
026222     IF  SU117-REC-SEQ-ARRIVE-DTE  >  SPACES AND                          
026223         SU117-REC-SEQ-ARRIVE-TM   >  SPACES AND                          
026224         SU117-PKD-IN-P2L-SML-DTE  >  SPACES AND                          
026225         SU117-PKD-IN-P2L-SML-TM   >  SPACES                              
026226         MOVE SU117-REC-SEQ-ARRIVE-DTE  TO PV-FROM-TMST-DATE              
026227         MOVE SU117-REC-SEQ-ARRIVE-TM   TO PV-FROM-TMST-TIME              
026228         MOVE SU117-PKD-IN-P2L-SML-DTE  TO PV-TO-TMST-DATE                
026229         MOVE SU117-PKD-IN-P2L-SML-TM   TO PV-TO-TMST-TIME                
026230         MOVE '-'                       TO PV-FROM-TMST-DASH1             
026231                                           PV-TO-TMST-DASH1               
026232         MOVE '.'                      TO  PV-FROM-TMST-DASH2             
026233                                           PV-TO-TMST-DASH2               
026234         MOVE ZEROES                   TO  PV-FROM-TMST-MM                
026235                                           PV-TO-TMST-MM                  
026236         MOVE 'ARRIVE TO P2L/JWL     ' TO  PV-CALC-DESCRIPTION            
026237         PERFORM 3000-CALC-TIME-DIFFERENCE                                
026238         MOVE PV-DIFF-MIN          TO  SU117-ARRIVE-TO-P2L-PKD-MIN        
026239     ELSE                                                                 
026240         MOVE ZEROES               TO  SU117-ARRIVE-TO-P2L-PKD-MIN        
026241     END-IF                                                               
026242     END-IF.                                                              
026243                                                                          
026244*  PROCESSED TO P2L/JWL PACKED                                            
026245     IF  SU117-SRC-CART-PRC-DTE    >  SPACES AND                          
026246         SU117-SRC-CART-PRC-TM     >  SPACES AND                          
026247         SU117-PKD-IN-P2L-SML-DTE  >  SPACES AND                          
026248         SU117-PKD-IN-P2L-SML-TM   >  SPACES                              
026249         MOVE SU117-SRC-CART-PRC-DTE    TO PV-FROM-TMST-DATE              
026250         MOVE SU117-SRC-CART-PRC-TM     TO PV-FROM-TMST-TIME              
026251         MOVE SU117-PKD-IN-P2L-SML-DTE  TO PV-TO-TMST-DATE                
026252         MOVE SU117-PKD-IN-P2L-SML-TM   TO PV-TO-TMST-TIME                
026253         MOVE '-'                       TO PV-FROM-TMST-DASH1             
026254                                           PV-TO-TMST-DASH1               
026255         MOVE '.'                      TO  PV-FROM-TMST-DASH2             
026256                                           PV-TO-TMST-DASH2               
026257         MOVE ZEROES                   TO  PV-FROM-TMST-MM                
026258                                           PV-TO-TMST-MM                  
026259         MOVE 'PROCESSED TO P2L/JWL  ' TO  PV-CALC-DESCRIPTION            
026260         PERFORM 3000-CALC-TIME-DIFFERENCE                                
026261         MOVE PV-DIFF-MIN          TO  SU117-PRC-TO-P2L-PKD-MIN           
026262     ELSE                                                                 
026263         MOVE ZEROES               TO  SU117-PRC-TO-P2L-PKD-MIN           
026264     END-IF.                                                              
026265                                                                          
026266*  P2L/JWL PACKED TO CLOSED                                               
026267     IF  SU117-PKD-IN-P2L-SML-DTE  >  SPACES AND                          
026268         SU117-PKD-IN-P2L-SML-TM   >  SPACES AND                          
026269         SU117-SML-P2L-CLOSE-DTE   >  SPACES AND                          
026270         SU117-SML-P2L-CLOSE-TM    >  SPACES                              
026271         MOVE SU117-PKD-IN-P2L-SML-DTE  TO PV-FROM-TMST-DATE              
026272         MOVE SU117-PKD-IN-P2L-SML-TM   TO PV-FROM-TMST-TIME              
026273         MOVE SU117-SML-P2L-CLOSE-DTE   TO PV-TO-TMST-DATE                
026274         MOVE SU117-SML-P2L-CLOSE-TM    TO PV-TO-TMST-TIME                
026275         MOVE '-'                       TO PV-FROM-TMST-DASH1             
026276                                           PV-TO-TMST-DASH1               
026277         MOVE '.'                      TO  PV-FROM-TMST-DASH2             
026278                                           PV-TO-TMST-DASH2               
026279         MOVE ZEROES                   TO  PV-FROM-TMST-MM                
026280                                           PV-TO-TMST-MM                  
026281         MOVE 'P2L/JWL PACK TO CLOSED' TO  PV-CALC-DESCRIPTION            
026282         PERFORM 3000-CALC-TIME-DIFFERENCE                                
026283         MOVE PV-DIFF-MIN          TO  SU117-P2L-PKD-TO-CLOSE-MIN         
026284     ELSE                                                                 
026285         MOVE ZEROES               TO  SU117-P2L-PKD-TO-CLOSE-MIN         
026286     END-IF.                                                              
026287                                                                          
026288*  P2L/JWL OPEN TO CLOSED                                                 
026289     IF  SU117-SML-P2L-OPEN-DTE    >  SPACES AND                          
026290         SU117-SML-P2L-OPEN-TM     >  SPACES AND                          
026291         SU117-SML-P2L-CLOSE-DTE   >  SPACES AND                          
026292         SU117-SML-P2L-CLOSE-TM    >  SPACES                              
026293         MOVE SU117-SML-P2L-OPEN-DTE    TO PV-FROM-TMST-DATE              
026294         MOVE SU117-SML-P2L-OPEN-TM     TO PV-FROM-TMST-TIME              
026295         MOVE SU117-SML-P2L-CLOSE-DTE   TO PV-TO-TMST-DATE                
026296         MOVE SU117-SML-P2L-CLOSE-TM    TO PV-TO-TMST-TIME                
026297         MOVE '-'                       TO PV-FROM-TMST-DASH1             
026298                                           PV-TO-TMST-DASH1               
026299         MOVE '.'                      TO  PV-FROM-TMST-DASH2             
026300                                           PV-TO-TMST-DASH2               
026301         MOVE ZEROES                   TO  PV-FROM-TMST-MM                
026302                                           PV-TO-TMST-MM                  
026303         MOVE 'P2L/JWL OPEN TO CLOSED' TO  PV-CALC-DESCRIPTION            
026304         PERFORM 3000-CALC-TIME-DIFFERENCE                                
026305         MOVE PV-DIFF-MIN          TO  SU117-P2L-OPEN-TO-CLOSE-MIN        
026306     ELSE                                                                 
026307         MOVE ZEROES               TO  SU117-P2L-OPEN-TO-CLOSE-MIN        
026308     END-IF.                                                              
026309                                                                          
026310*  P2L/JWL OPEN TO OTBND                                                  
026311     IF  SU117-SML-P2L-OPEN-DTE    >  SPACES AND                          
026312         SU117-SML-P2L-OPEN-TM     >  SPACES AND                          
026313         SU117-SML-ON-OTBND-DTE    >  SPACES AND                          
026314         SU117-SML-ON-OTBND-TM     >  SPACES                              
026315         MOVE SU117-SML-P2L-OPEN-DTE    TO PV-FROM-TMST-DATE              
026316         MOVE SU117-SML-P2L-OPEN-TM     TO PV-FROM-TMST-TIME              
026317         MOVE SU117-SML-ON-OTBND-DTE    TO PV-TO-TMST-DATE                
026318         MOVE SU117-SML-ON-OTBND-TM     TO PV-TO-TMST-TIME                
026319         MOVE '-'                       TO PV-FROM-TMST-DASH1             
026320                                           PV-TO-TMST-DASH1               
026321         MOVE '.'                      TO  PV-FROM-TMST-DASH2             
026322                                           PV-TO-TMST-DASH2               
026323         MOVE ZEROES                   TO  PV-FROM-TMST-MM                
026324                                           PV-TO-TMST-MM                  
026325         MOVE 'P2L/JWL CLOSE TO OTBND' TO  PV-CALC-DESCRIPTION            
026326         PERFORM 3000-CALC-TIME-DIFFERENCE                                
026327         MOVE PV-DIFF-MIN        TO  SU117-P2L-OPEN-TO-OTBND-MIN          
026328     ELSE                                                                 
026329         MOVE ZEROES             TO  SU117-P2L-OPEN-TO-OTBND-MIN          
026330     END-IF.                                                              
026331                                                                          
026332*  P2L/JWL CLOSE TO OTBND                                                 
026333     IF  SU117-SML-P2L-CLOSE-DTE   >  SPACES AND                          
026334         SU117-SML-P2L-CLOSE-TM    >  SPACES AND                          
026335         SU117-SML-ON-OTBND-DTE    >  SPACES AND                          
026336         SU117-SML-ON-OTBND-TM     >  SPACES                              
026337         MOVE SU117-SML-P2L-CLOSE-DTE   TO PV-FROM-TMST-DATE              
026338         MOVE SU117-SML-P2L-CLOSE-TM    TO PV-FROM-TMST-TIME              
026339         MOVE SU117-SML-ON-OTBND-DTE    TO PV-TO-TMST-DATE                
026340         MOVE SU117-SML-ON-OTBND-TM     TO PV-TO-TMST-TIME                
026341         MOVE '-'                       TO PV-FROM-TMST-DASH1             
026342                                           PV-TO-TMST-DASH1               
026343         MOVE '.'                      TO  PV-FROM-TMST-DASH2             
026344                                           PV-TO-TMST-DASH2               
026345         MOVE ZEROES                   TO  PV-FROM-TMST-MM                
026346                                           PV-TO-TMST-MM                  
026347         MOVE 'P2L/JWL CLOSE TO OTBND' TO  PV-CALC-DESCRIPTION            
026348         PERFORM 3000-CALC-TIME-DIFFERENCE                                
026349         MOVE PV-DIFF-MIN        TO  SU117-P2L-CLOSE-TO-OTBND-MIN         
026350     ELSE                                                                 
026351         MOVE ZEROES             TO  SU117-P2L-CLOSE-TO-OTBND-MIN         
026352     END-IF.                                                              
026353                                                                          
026354*  ARRIVE TO OTBND                                                        
026355*                                                                         
026356* DMH 9/01/16 BEGIN                                                       
026357     IF  SU117-REC-SEQ-ARRIVE-DTE  =  '9999-09-09'  AND                   
026358         SU117-SML-ON-OTBND-DTE    >  SPACES AND                          
026359         SU117-SML-ON-OTBND-TM     >  SPACES                              
026360         MOVE 1                    TO  SU117-ARRIVE-TO-OTBND-MIN          
026361     ELSE                                                                 
026362* DMH 9/01/16 BEGIN                                                       
026363*                                                                         
026364     IF  SU117-REC-SEQ-ARRIVE-DTE  >  SPACES AND                          
026365         SU117-REC-SEQ-ARRIVE-TM   >  SPACES AND                          
026366         SU117-SML-ON-OTBND-DTE    >  SPACES AND                          
026367         SU117-SML-ON-OTBND-TM     >  SPACES                              
026368         MOVE SU117-REC-SEQ-ARRIVE-DTE  TO PV-FROM-TMST-DATE              
026369         MOVE SU117-REC-SEQ-ARRIVE-TM   TO PV-FROM-TMST-TIME              
026370         MOVE SU117-SML-ON-OTBND-DTE    TO PV-TO-TMST-DATE                
026371         MOVE SU117-SML-ON-OTBND-TM     TO PV-TO-TMST-TIME                
026372         MOVE '-'                       TO PV-FROM-TMST-DASH1             
026373                                           PV-TO-TMST-DASH1               
026374         MOVE '.'                      TO  PV-FROM-TMST-DASH2             
026375                                           PV-TO-TMST-DASH2               
026376         MOVE ZEROES                   TO  PV-FROM-TMST-MM                
026377                                           PV-TO-TMST-MM                  
026378         MOVE 'ARRIVE TO OTBND       ' TO  PV-CALC-DESCRIPTION            
026379         PERFORM 3000-CALC-TIME-DIFFERENCE                                
026380         MOVE PV-DIFF-MIN          TO  SU117-ARRIVE-TO-OTBND-MIN          
026381     ELSE                                                                 
026382         MOVE ZEROES               TO  SU117-ARRIVE-TO-OTBND-MIN          
026383     END-IF                                                               
026384     END-IF.                                                              
026385                                                                          
026386*  PROCESSED TO OTBND                                                     
026387     IF  SU117-SRC-CART-PRC-DTE    >  SPACES AND                          
026388         SU117-SRC-CART-PRC-TM     >  SPACES AND                          
026389         SU117-SML-ON-OTBND-DTE    >  SPACES AND                          
026390         SU117-SML-ON-OTBND-TM     >  SPACES                              
026391         MOVE SU117-SRC-CART-PRC-DTE    TO PV-FROM-TMST-DATE              
026392         MOVE SU117-SRC-CART-PRC-TM     TO PV-FROM-TMST-TIME              
026393         MOVE SU117-SML-ON-OTBND-DTE    TO PV-TO-TMST-DATE                
026394         MOVE SU117-SML-ON-OTBND-TM     TO PV-TO-TMST-TIME                
026395         MOVE '-'                       TO PV-FROM-TMST-DASH1             
026396                                           PV-TO-TMST-DASH1               
026397         MOVE '.'                      TO  PV-FROM-TMST-DASH2             
026398                                           PV-TO-TMST-DASH2               
026399         MOVE ZEROES                   TO  PV-FROM-TMST-MM                
026400                                           PV-TO-TMST-MM                  
026401         MOVE 'PROCESSED TO OTBND    ' TO  PV-CALC-DESCRIPTION            
026402         PERFORM 3000-CALC-TIME-DIFFERENCE                                
026403         MOVE PV-DIFF-MIN          TO  SU117-PRC-TO-OTBND-MIN             
026404     ELSE                                                                 
026405         MOVE ZEROES               TO  SU117-PRC-TO-OTBND-MIN             
026406     END-IF.                                                              
026407                                                                          
026408*  ARRIVE TO TRAILER CLOSE                                                
026409*                                                                         
026410* DMH 9/01/16 BEGIN                                                       
026411     IF  SU117-REC-SEQ-ARRIVE-DTE  =  '9999-09-09'  AND                   
026412         SU117-TRIP-CLOSE-TMST     >  SPACES                              
026413         MOVE 1                    TO  SU117-ARRIVE-TO-TCLOS-MIN          
026414     ELSE                                                                 
026415* DMH 9/01/16 BEGIN                                                       
026416*                                                                         
026417     IF  SU117-REC-SEQ-ARRIVE-DTE  >  SPACES AND                          
026418         SU117-REC-SEQ-ARRIVE-TM   >  SPACES AND                          
026419         SU117-TRIP-CLOSE-TMST     >  SPACES                              
026420         MOVE SU117-REC-SEQ-ARRIVE-DTE  TO PV-FROM-TMST-DATE              
026421         MOVE SU117-REC-SEQ-ARRIVE-TM   TO PV-FROM-TMST-TIME              
026422         MOVE SU117-TRIP-CLOSE-TMST     TO PV-TO-TIMESTAMP                
026423         MOVE '-'                       TO PV-FROM-TMST-DASH1             
026424         MOVE '.'                       TO PV-FROM-TMST-DASH2             
026425         MOVE ZEROES                    TO PV-FROM-TMST-MM                
026426         MOVE 'ARRIVE TO TRLR CLOSE  ' TO  PV-CALC-DESCRIPTION            
026427         PERFORM 3000-CALC-TIME-DIFFERENCE                                
026428         MOVE PV-DIFF-MIN          TO  SU117-ARRIVE-TO-TCLOS-MIN          
026429     ELSE                                                                 
026430         MOVE ZEROES               TO  SU117-ARRIVE-TO-TCLOS-MIN          
026431     END-IF                                                               
026432     END-IF.                                                              
026433                                                                          
026434*  ARRIVE TO TRAILER SHIP                                                 
026435*                                                                         
026436* DMH 9/01/16 BEGIN                                                       
026437     IF  SU117-REC-SEQ-ARRIVE-DTE  =  '9999-09-09'  AND                   
026438         SU117-TRIP-SHIP-TMST      >  SPACES                              
026439         MOVE 1                    TO  SU117-ARRIVE-TO-SHIP-MIN           
026440     ELSE                                                                 
026441* DMH 9/01/16 BEGIN                                                       
026442*                                                                         
026443     IF  SU117-REC-SEQ-ARRIVE-DTE  >  SPACES AND                          
026444         SU117-REC-SEQ-ARRIVE-TM   >  SPACES AND                          
026445         SU117-TRIP-SHIP-TMST      >  SPACES                              
026446         MOVE SU117-REC-SEQ-ARRIVE-DTE  TO PV-FROM-TMST-DATE              
026447         MOVE SU117-REC-SEQ-ARRIVE-TM   TO PV-FROM-TMST-TIME              
026448         MOVE SU117-TRIP-SHIP-TMST      TO PV-TO-TIMESTAMP                
026449         MOVE '-'                       TO PV-FROM-TMST-DASH1             
026450         MOVE '.'                       TO PV-FROM-TMST-DASH2             
026451         MOVE ZEROES                    TO PV-FROM-TMST-MM                
026452         MOVE 'ARRIVE TO TRLR SHIP   ' TO  PV-CALC-DESCRIPTION            
026453         PERFORM 3000-CALC-TIME-DIFFERENCE                                
026454         MOVE PV-DIFF-MIN          TO  SU117-ARRIVE-TO-SHIP-MIN           
026455     ELSE                                                                 
026456         MOVE ZEROES               TO  SU117-ARRIVE-TO-SHIP-MIN           
026457     END-IF                                                               
026458     END-IF.                                                              
026459                                                                          
026460*  P2L/JWL OPEN TO TRAILER CLOSE                                          
026461     IF  SU117-SML-P2L-OPEN-DTE    >  SPACES AND                          
026462         SU117-SML-P2L-OPEN-TM     >  SPACES AND                          
026463         SU117-TRIP-CLOSE-TMST     >  SPACES                              
026464         MOVE SU117-SML-P2L-OPEN-DTE    TO PV-FROM-TMST-DATE              
026465         MOVE SU117-SML-P2L-OPEN-TM     TO PV-FROM-TMST-TIME              
026466         MOVE SU117-TRIP-CLOSE-TMST     TO PV-TO-TIMESTAMP                
026467         MOVE '-'                       TO PV-FROM-TMST-DASH1             
026468         MOVE '.'                       TO PV-FROM-TMST-DASH2             
026469         MOVE ZEROES                    TO PV-FROM-TMST-MM                
026470         MOVE 'P2L/JWL OPEN-TRLR CLOS' TO  PV-CALC-DESCRIPTION            
026471         PERFORM 3000-CALC-TIME-DIFFERENCE                                
026472         MOVE PV-DIFF-MIN          TO  SU117-P2L-OPEN-TO-TCLOS-MIN        
026473     ELSE                                                                 
026474         MOVE ZEROES               TO  SU117-P2L-OPEN-TO-TCLOS-MIN        
026475     END-IF.                                                              
026476                                                                          
026477*  P2L/JWL OPEN TO TRAILER SHIP                                           
026478     IF  SU117-SML-P2L-OPEN-DTE    >  SPACES AND                          
026479         SU117-SML-P2L-OPEN-TM     >  SPACES AND                          
026480         SU117-TRIP-SHIP-TMST      >  SPACES                              
026481         MOVE SU117-SML-P2L-OPEN-DTE    TO PV-FROM-TMST-DATE              
026482         MOVE SU117-SML-P2L-OPEN-TM     TO PV-FROM-TMST-TIME              
026483         MOVE SU117-TRIP-SHIP-TMST      TO PV-TO-TIMESTAMP                
026484         MOVE '-'                       TO PV-FROM-TMST-DASH1             
026485         MOVE '.'                       TO PV-FROM-TMST-DASH2             
026486         MOVE ZEROES                    TO PV-FROM-TMST-MM                
026487         MOVE 'P2L/JWL OPEN-TRLR SHIP' TO  PV-CALC-DESCRIPTION            
026488         PERFORM 3000-CALC-TIME-DIFFERENCE                                
026489         MOVE PV-DIFF-MIN          TO  SU117-P2L-OPEN-TO-SHIP-MIN         
026490     ELSE                                                                 
026491         MOVE ZEROES               TO  SU117-P2L-OPEN-TO-SHIP-MIN         
026492     END-IF.                                                              
026493                                                                          
026494*  P2L/JWL CLOSE TO TRAILER CLOSE                                         
026495     IF  SU117-SML-P2L-CLOSE-DTE   >  SPACES AND                          
026496         SU117-SML-P2L-CLOSE-TM    >  SPACES AND                          
026497         SU117-TRIP-CLOSE-TMST     >  SPACES                              
026498         MOVE SU117-SML-P2L-CLOSE-DTE   TO PV-FROM-TMST-DATE              
026499         MOVE SU117-SML-P2L-CLOSE-TM    TO PV-FROM-TMST-TIME              
026500         MOVE SU117-TRIP-CLOSE-TMST     TO PV-TO-TIMESTAMP                
026501         MOVE '-'                       TO PV-FROM-TMST-DASH1             
026502         MOVE '.'                       TO PV-FROM-TMST-DASH2             
026503         MOVE ZEROES                    TO PV-FROM-TMST-MM                
026504         MOVE 'P2L/JWL CLOS-TRLR CLOS' TO  PV-CALC-DESCRIPTION            
026505         PERFORM 3000-CALC-TIME-DIFFERENCE                                
026506         MOVE PV-DIFF-MIN        TO  SU117-P2L-CLOSE-TO-TCLOS-MIN         
026507     ELSE                                                                 
026508         MOVE ZEROES             TO  SU117-P2L-CLOSE-TO-TCLOS-MIN         
026509     END-IF.                                                              
026510                                                                          
026511*  P2L/JWL CLOSE TO TRAILER SHIP                                          
026512     IF  SU117-SML-P2L-CLOSE-DTE   >  SPACES AND                          
026513         SU117-SML-P2L-CLOSE-TM    >  SPACES AND                          
026514         SU117-TRIP-SHIP-TMST      >  SPACES                              
026515         MOVE SU117-SML-P2L-CLOSE-DTE   TO PV-FROM-TMST-DATE              
026516         MOVE SU117-SML-P2L-CLOSE-TM    TO PV-FROM-TMST-TIME              
026517         MOVE SU117-TRIP-SHIP-TMST      TO PV-TO-TIMESTAMP                
026518         MOVE '-'                       TO PV-FROM-TMST-DASH1             
026519         MOVE '.'                       TO PV-FROM-TMST-DASH2             
026520         MOVE ZEROES                    TO PV-FROM-TMST-MM                
026521         MOVE 'P2L/JWL CLOS-TRLR SHIP' TO  PV-CALC-DESCRIPTION            
026522         PERFORM 3000-CALC-TIME-DIFFERENCE                                
026523         MOVE PV-DIFF-MIN          TO  SU117-P2L-CLOSE-TO-SHIP-MIN        
026524     ELSE                                                                 
026525         MOVE ZEROES               TO  SU117-P2L-CLOSE-TO-SHIP-MIN        
026526     END-IF.                                                              
026527                                                                          
026528*  ARRIVAL TO MASTER                                                      
026529*                                                                         
026530* DMH 9/01/16 BEGIN                                                       
026531     IF  SU117-REC-SEQ-ARRIVE-DTE  =  '9999-09-09'  AND                   
026532         SU117-SML-IN-MSTR-DTE     >  SPACES  AND                         
026533         SU117-SML-IN-MSTR-TM      >  SPACES                              
026534         MOVE 1                    TO  SU117-ARRIVE-TO-MSTR-MIN           
026535     ELSE                                                                 
026536* DMH 9/01/16 BEGIN                                                       
026537*                                                                         
026538     IF  SU117-REC-SEQ-ARRIVE-DTE  >  SPACES  AND                         
026539         SU117-REC-SEQ-ARRIVE-TM   >  SPACES  AND                         
026540         SU117-SML-IN-MSTR-DTE     >  SPACES  AND                         
026541         SU117-SML-IN-MSTR-TM      >  SPACES                              
026542         MOVE SU117-REC-SEQ-ARRIVE-DTE  TO PV-FROM-TMST-DATE              
026543         MOVE SU117-REC-SEQ-ARRIVE-TM   TO PV-FROM-TMST-TIME              
026544         MOVE SU117-SML-IN-MSTR-DTE     TO PV-TO-TMST-DATE                
026545         MOVE SU117-SML-IN-MSTR-TM      TO PV-TO-TMST-TIME                
026546         MOVE '-'                       TO PV-FROM-TMST-DASH1             
026547                                           PV-TO-TMST-DASH1               
026548         MOVE '.'                       TO PV-FROM-TMST-DASH2             
026549                                           PV-TO-TMST-DASH2               
026550         MOVE ZEROES                    TO PV-FROM-TMST-MM                
026551                                           PV-TO-TMST-MM                  
026552         MOVE 'ARRIVE TO MASTER      ' TO  PV-CALC-DESCRIPTION            
026553         PERFORM 3000-CALC-TIME-DIFFERENCE                                
026554         MOVE PV-DIFF-MIN          TO  SU117-ARRIVE-TO-MSTR-MIN           
026555     ELSE                                                                 
026556         MOVE ZEROES               TO  SU117-ARRIVE-TO-MSTR-MIN           
026557     END-IF                                                               
026558     END-IF.                                                              
026559                                                                          
026560*  PROCESSED TO MASTER                                                    
026561     IF  SU117-SRC-CART-PRC-DTE    >  SPACES  AND                         
026562         SU117-SRC-CART-PRC-TM     >  SPACES  AND                         
026563         SU117-SML-IN-MSTR-DTE     >  SPACES  AND                         
026564         SU117-SML-IN-MSTR-TM      >  SPACES                              
026565         MOVE SU117-SRC-CART-PRC-DTE    TO PV-FROM-TMST-DATE              
026566         MOVE SU117-SRC-CART-PRC-TM     TO PV-FROM-TMST-TIME              
026567         MOVE SU117-SML-IN-MSTR-DTE     TO PV-TO-TMST-DATE                
026568         MOVE SU117-SML-IN-MSTR-TM      TO PV-TO-TMST-TIME                
026569         MOVE '-'                       TO PV-FROM-TMST-DASH1             
026570                                           PV-TO-TMST-DASH1               
026571         MOVE '.'                      TO  PV-FROM-TMST-DASH2             
026572                                           PV-TO-TMST-DASH2               
026573         MOVE ZEROES                   TO  PV-FROM-TMST-MM                
026574                                           PV-TO-TMST-MM                  
026575         MOVE 'PROCESSED TO MASTER   ' TO  PV-CALC-DESCRIPTION            
026576         PERFORM 3000-CALC-TIME-DIFFERENCE                                
026577         MOVE PV-DIFF-MIN          TO  SU117-PRC-TO-MSTR-MIN              
026578     ELSE                                                                 
026579         MOVE ZEROES               TO  SU117-PRC-TO-MSTR-MIN              
026580     END-IF.                                                              
026581                                                                          
026582*  MASTER CREATE TO OUTBOUND                                              
026583     IF  SU117-MSTR-CRE-DTE        >  SPACES  AND                         
026584         SU117-MSTR-CRE-TM         >  SPACES  AND                         
026585         SU117-SML-ON-OTBND-DTE    >  SPACES  AND                         
026586         SU117-SML-ON-OTBND-TM     >  SPACES                              
026587         MOVE SU117-MSTR-CRE-DTE        TO PV-FROM-TMST-DATE              
026588         MOVE SU117-MSTR-CRE-TM         TO PV-FROM-TMST-TIME              
026589         MOVE SU117-SML-ON-OTBND-DTE    TO PV-TO-TMST-DATE                
026590         MOVE SU117-SML-ON-OTBND-TM     TO PV-TO-TMST-TIME                
026591         MOVE '-'                       TO PV-FROM-TMST-DASH1             
026592                                           PV-TO-TMST-DASH1               
026593         MOVE '.'                      TO  PV-FROM-TMST-DASH2             
026594                                           PV-TO-TMST-DASH2               
026595         MOVE ZEROES                   TO  PV-FROM-TMST-MM                
026596                                           PV-TO-TMST-MM                  
026597         MOVE 'MST CREATE TO OTBND   ' TO  PV-CALC-DESCRIPTION            
026598         PERFORM 3000-CALC-TIME-DIFFERENCE                                
026599         MOVE PV-DIFF-MIN          TO  SU117-MSTR-CRE-TO-OTBND-MIN        
026600     ELSE                                                                 
026601         MOVE ZEROES               TO  SU117-MSTR-CRE-TO-OTBND-MIN        
026602     END-IF.                                                              
026603                                                                          
026604*  MASTER CREATE TO TRAILER CLOSE                                         
026605     IF  SU117-MSTR-CRE-DTE        >  SPACES  AND                         
026606         SU117-MSTR-CRE-TM         >  SPACES  AND                         
026607         SU117-TRIP-CLOSE-TMST     >  SPACES                              
026608         MOVE SU117-MSTR-CRE-DTE        TO PV-FROM-TMST-DATE              
026609         MOVE SU117-MSTR-CRE-TM         TO PV-FROM-TMST-TIME              
026610         MOVE SU117-TRIP-CLOSE-TMST     TO PV-TO-TIMESTAMP                
026611         MOVE '-'                       TO PV-FROM-TMST-DASH1             
026612         MOVE '.'                       TO PV-FROM-TMST-DASH2             
026613         MOVE ZEROES                    TO PV-FROM-TMST-MM                
026614         MOVE 'MST CREATE TO TRLR CLO' TO  PV-CALC-DESCRIPTION            
026615         PERFORM 3000-CALC-TIME-DIFFERENCE                                
026616         MOVE PV-DIFF-MIN          TO  SU117-MSTR-CRE-TO-TCLOS-MIN        
026617     ELSE                                                                 
026618         MOVE ZEROES               TO  SU117-MSTR-CRE-TO-TCLOS-MIN        
026619     END-IF.                                                              
026620                                                                          
026621*  MASTER CREATE TO TRAILER SHIP                                          
026622     IF  SU117-MSTR-CRE-DTE        >  SPACES  AND                         
026623         SU117-MSTR-CRE-TM         >  SPACES  AND                         
026624         SU117-TRIP-SHIP-TMST      >  SPACES                              
026625         MOVE SU117-MSTR-CRE-DTE        TO PV-FROM-TMST-DATE              
026626         MOVE SU117-MSTR-CRE-TM         TO PV-FROM-TMST-TIME              
026627         MOVE SU117-TRIP-SHIP-TMST      TO PV-TO-TIMESTAMP                
026628         MOVE '-'                       TO PV-FROM-TMST-DASH1             
026629         MOVE '.'                       TO PV-FROM-TMST-DASH2             
026630         MOVE ZEROES                    TO PV-FROM-TMST-MM                
026631         MOVE 'MST CREATE TO TRLR SHP' TO  PV-CALC-DESCRIPTION            
026632         PERFORM 3000-CALC-TIME-DIFFERENCE                                
026633         MOVE PV-DIFF-MIN          TO  SU117-MSTR-CRE-TO-SHIP-MIN         
026634     ELSE                                                                 
026635         MOVE ZEROES               TO  SU117-MSTR-CRE-TO-SHIP-MIN         
026636     END-IF.                                                              
026637                                                                          
026638* MSTR FIRST TO OTBND                                                     
026639     IF  SU117-FIRST-SML-IN-MSTR-DTE > SPACES  AND                        
026640         SU117-FIRST-SML-IN-MSTR-TM  > SPACES  AND                        
026641         SU117-SML-ON-OTBND-DTE    >  SPACES  AND                         
026642         SU117-SML-ON-OTBND-TM     >  SPACES                              
026643         MOVE SU117-FIRST-SML-IN-MSTR-DTE TO PV-FROM-TMST-DATE            
026644         MOVE SU117-FIRST-SML-IN-MSTR-TM  TO PV-FROM-TMST-TIME            
026645         MOVE SU117-SML-ON-OTBND-DTE    TO PV-TO-TMST-DATE                
026646         MOVE SU117-SML-ON-OTBND-TM     TO PV-TO-TMST-TIME                
026647         MOVE '-'                       TO PV-FROM-TMST-DASH1             
026648                                           PV-TO-TMST-DASH1               
026649         MOVE '.'                       TO PV-FROM-TMST-DASH2             
026650                                           PV-TO-TMST-DASH2               
026651         MOVE ZEROES                    TO PV-FROM-TMST-MM                
026652                                           PV-TO-TMST-MM                  
026653         MOVE 'MST FIRST TO OTBND    ' TO  PV-CALC-DESCRIPTION            
026654         PERFORM 3000-CALC-TIME-DIFFERENCE                                
026655         MOVE PV-DIFF-MIN       TO  SU117-MSTR-FIRST-TO-OTBND-MIN         
026656     ELSE                                                                 
026657         MOVE ZEROES            TO  SU117-MSTR-FIRST-TO-OTBND-MIN         
026658     END-IF.                                                              
026659                                                                          
026660* MSTR FIRST TO TRLR CLOSE                                                
026661     IF  SU117-FIRST-SML-IN-MSTR-DTE > SPACES  AND                        
026662         SU117-FIRST-SML-IN-MSTR-TM  > SPACES  AND                        
026663         SU117-TRIP-CLOSE-TMST     >  SPACES                              
026664         MOVE SU117-FIRST-SML-IN-MSTR-DTE TO PV-FROM-TMST-DATE            
026665         MOVE SU117-FIRST-SML-IN-MSTR-TM  TO PV-FROM-TMST-TIME            
026666         MOVE SU117-TRIP-CLOSE-TMST     TO PV-TO-TIMESTAMP                
026667         MOVE '-'                       TO PV-FROM-TMST-DASH1             
026668         MOVE '.'                       TO PV-FROM-TMST-DASH2             
026669         MOVE ZEROES                    TO PV-FROM-TMST-MM                
026670         MOVE 'MST FIRST - TRLR CLOSE' TO  PV-CALC-DESCRIPTION            
026671         PERFORM 3000-CALC-TIME-DIFFERENCE                                
026672         MOVE PV-DIFF-MIN       TO  SU117-MSTR-FIRST-TO-TCLOS-MIN         
026673     ELSE                                                                 
026674         MOVE ZEROES            TO  SU117-MSTR-FIRST-TO-TCLOS-MIN         
026675     END-IF.                                                              
026676                                                                          
026677* MSTR FIRST TO TRLR SHIP                                                 
026678     IF  SU117-FIRST-SML-IN-MSTR-DTE > SPACES  AND                        
026679         SU117-FIRST-SML-IN-MSTR-TM  > SPACES  AND                        
026680         SU117-TRIP-SHIP-TMST      >  SPACES                              
026681         MOVE SU117-FIRST-SML-IN-MSTR-DTE TO PV-FROM-TMST-DATE            
026682         MOVE SU117-FIRST-SML-IN-MSTR-TM  TO PV-FROM-TMST-TIME            
026683         MOVE SU117-TRIP-SHIP-TMST      TO PV-TO-TIMESTAMP                
026684         MOVE '-'                       TO PV-FROM-TMST-DASH1             
026685         MOVE '.'                       TO PV-FROM-TMST-DASH2             
026686         MOVE ZEROES                    TO PV-FROM-TMST-MM                
026687         MOVE 'MST FIRST - TRLR CLOSE' TO  PV-CALC-DESCRIPTION            
026688         PERFORM 3000-CALC-TIME-DIFFERENCE                                
026689         MOVE PV-DIFF-MIN       TO  SU117-MSTR-FIRST-TO-SHIP-MIN          
026690     ELSE                                                                 
026691         MOVE ZEROES            TO  SU117-MSTR-FIRST-TO-SHIP-MIN          
026692     END-IF.                                                              
026693                                                                          
026694* MSTR LAST TO OTBND                                                      
026695     IF  SU117-LAST-SML-IN-MSTR-DTE  > SPACES  AND                        
026696         SU117-LAST-SML-IN-MSTR-TM   > SPACES  AND                        
026697         SU117-SML-ON-OTBND-DTE    >  SPACES  AND                         
026698         SU117-SML-ON-OTBND-TM     >  SPACES                              
026699         MOVE SU117-LAST-SML-IN-MSTR-DTE  TO PV-FROM-TMST-DATE            
026700         MOVE SU117-LAST-SML-IN-MSTR-TM   TO PV-FROM-TMST-TIME            
026701         MOVE SU117-SML-ON-OTBND-DTE    TO PV-TO-TMST-DATE                
026702         MOVE SU117-SML-ON-OTBND-TM     TO PV-TO-TMST-TIME                
026703         MOVE '-'                       TO PV-FROM-TMST-DASH1             
026704                                           PV-TO-TMST-DASH1               
026705         MOVE '.'                      TO  PV-FROM-TMST-DASH2             
026706                                           PV-TO-TMST-DASH2               
026707         MOVE ZEROES                   TO  PV-FROM-TMST-MM                
026708                                           PV-TO-TMST-MM                  
026709         MOVE 'MST LAST  TO OTBND    ' TO  PV-CALC-DESCRIPTION            
026710         PERFORM 3000-CALC-TIME-DIFFERENCE                                
026711         MOVE PV-DIFF-MIN       TO  SU117-MSTR-LAST-TO-OTBND-MIN          
026712     ELSE                                                                 
026713         MOVE ZEROES            TO  SU117-MSTR-LAST-TO-OTBND-MIN          
026714     END-IF.                                                              
026715                                                                          
026716* MSTR LAST TO TRLR CLOSE                                                 
026717     IF  SU117-LAST-SML-IN-MSTR-DTE  > SPACES  AND                        
026718         SU117-LAST-SML-IN-MSTR-TM   > SPACES  AND                        
026719         SU117-TRIP-CLOSE-TMST     >  SPACES                              
026720         MOVE SU117-LAST-SML-IN-MSTR-DTE  TO PV-FROM-TMST-DATE            
026721         MOVE SU117-LAST-SML-IN-MSTR-TM   TO PV-FROM-TMST-TIME            
026722         MOVE SU117-TRIP-CLOSE-TMST     TO PV-TO-TIMESTAMP                
026723         MOVE '-'                       TO PV-FROM-TMST-DASH1             
026724         MOVE '.'                       TO PV-FROM-TMST-DASH2             
026725         MOVE ZEROES                    TO PV-FROM-TMST-MM                
026726         MOVE 'MST LAST TO TRLR CLOSE' TO  PV-CALC-DESCRIPTION            
026727         PERFORM 3000-CALC-TIME-DIFFERENCE                                
026728         MOVE PV-DIFF-MIN       TO  SU117-MSTR-LAST-TO-TCLOS-MIN          
026729     ELSE                                                                 
026730         MOVE ZEROES            TO  SU117-MSTR-LAST-TO-TCLOS-MIN          
026731     END-IF.                                                              
026732                                                                          
026733* MSTR LAST TO TRLR SHIP                                                  
026734     IF  SU117-LAST-SML-IN-MSTR-DTE  > SPACES  AND                        
026735         SU117-LAST-SML-IN-MSTR-TM   > SPACES  AND                        
026736         SU117-TRIP-SHIP-TMST      >  SPACES                              
026737         MOVE SU117-LAST-SML-IN-MSTR-DTE  TO PV-FROM-TMST-DATE            
026738         MOVE SU117-LAST-SML-IN-MSTR-TM   TO PV-FROM-TMST-TIME            
026739         MOVE SU117-TRIP-SHIP-TMST      TO PV-TO-TIMESTAMP                
026740         MOVE '-'                       TO PV-FROM-TMST-DASH1             
026741         MOVE '.'                       TO PV-FROM-TMST-DASH2             
026742         MOVE ZEROES                    TO PV-FROM-TMST-MM                
026743         MOVE 'MST LAST TO TRLR SHIP ' TO  PV-CALC-DESCRIPTION            
026744         PERFORM 3000-CALC-TIME-DIFFERENCE                                
026745         MOVE PV-DIFF-MIN       TO  SU117-MSTR-LAST-TO-SHIP-MIN           
026746     ELSE                                                                 
026747         MOVE ZEROES            TO  SU117-MSTR-LAST-TO-SHIP-MIN           
026748     END-IF.                                                              
026749                                                                          
026750* SML ON MANIFESTED TO OUTBOUND - TO OUTBOUND TRAILER CLOSE               
026751     IF  SU117-SML-ON-OTBND-DTE      > SPACES  AND                        
026752         SU117-SML-ON-OTBND-TM       > SPACES  AND                        
026753         SU117-TRIP-CLOSE-TMST     >  SPACES                              
026754         MOVE SU117-SML-ON-OTBND-DTE    TO PV-FROM-TMST-DATE              
026755         MOVE SU117-SML-ON-OTBND-TM     TO PV-FROM-TMST-TIME              
026756         MOVE SU117-TRIP-CLOSE-TMST     TO PV-TO-TIMESTAMP                
026757         MOVE '-'                       TO PV-FROM-TMST-DASH1             
026758         MOVE '.'                       TO PV-FROM-TMST-DASH2             
026759         MOVE ZEROES                    TO PV-FROM-TMST-MM                
026760         MOVE 'MST LAST TO TRLR SHIP ' TO  PV-CALC-DESCRIPTION            
026761         PERFORM 3000-CALC-TIME-DIFFERENCE                                
026762         MOVE PV-DIFF-MIN       TO  SU117-ON-OTBND-TO-CLOS-MIN            
026763     ELSE                                                                 
026764         MOVE ZEROES            TO  SU117-ON-OTBND-TO-CLOS-MIN            
026765     END-IF.                                                              
026766                                                                          
026767* SML ON MANIFESTED TO OUTBOUND - TO OUTBOUND TRAILER SHIP                
026768     IF  SU117-SML-ON-OTBND-DTE      > SPACES  AND                        
026769         SU117-SML-ON-OTBND-TM       > SPACES  AND                        
026770         SU117-TRIP-SHIP-TMST      >  SPACES                              
026771         MOVE SU117-SML-ON-OTBND-DTE    TO PV-FROM-TMST-DATE              
026772         MOVE SU117-SML-ON-OTBND-TM     TO PV-FROM-TMST-TIME              
026773         MOVE SU117-TRIP-SHIP-TMST      TO PV-TO-TIMESTAMP                
026774         MOVE '-'                       TO PV-FROM-TMST-DASH1             
026775         MOVE '.'                       TO PV-FROM-TMST-DASH2             
026776         MOVE ZEROES                    TO PV-FROM-TMST-MM                
026777         MOVE 'MST LAST TO TRLR SHIP ' TO  PV-CALC-DESCRIPTION            
026778         PERFORM 3000-CALC-TIME-DIFFERENCE                                
026779         MOVE PV-DIFF-MIN       TO  SU117-ON-OTBND-TO-SHIP-MIN            
026780     ELSE                                                                 
026781         MOVE ZEROES            TO  SU117-ON-OTBND-TO-SHIP-MIN            
026782     END-IF.                                                              
026783                                                                          
026784     PERFORM 8100-WRITE-OUTPUT-RECORD.                                    
026785                                                                          
026786     PERFORM 8000-READ-INPUT-REC.                                         
026787                                                                          
026788                                                                          
026789*-----------------------------------------------------------------        
026790*  CALCULATE TIME DIFFERENCE                                              
026791*-----------------------------------------------------------------        
026792 3000-CALC-TIME-DIFFERENCE.                                               
026793                                                                          
026794     EXEC SQL                                                             
026795         SELECT                                                           
026796                TIMESTAMPDIFF                                             
026797                (4, CHAR( TIMESTAMP(:PV-TO-TIMESTAMP)    -                
026798                          TIMESTAMP(:PV-FROM-TIMESTAMP)                   
026799                        )                                                 
026800                )                                                         
026801           INTO                                                           
026802                :PV-DIFF-MIN                                              
026803           FROM SYSIBM.SYSDUMMY1                                          
026804           WITH UR                                                        
026805                                                                          
026806     END-EXEC.                                                            
026807                                                                          
026808     EVALUATE TRUE                                                        
026809         WHEN SQLCODE = ZERO                                              
026810              CONTINUE                                                    
026811                                                                          
026812         WHEN SQLWARN0 NOT = SPACES                                       
026813         WHEN SQLCODE < ZERO                                              
026814         WHEN SQLCODE > ZERO                                              
026815             MOVE SQLCODE           TO  PV-DISP-SQLCODE                   
026816             MOVE PV-INPUT-COUNTER  TO  PV-DISPLAY-COUNT                  
026817             MOVE SU117-TRIP-ID     TO  PV-DISP-TRIP                      
026818             MOVE SU117-OPER-UNT-ID TO  PV-DISP-OPER                      
026819             MOVE SU117-STORE-DEST  TO  PV-DISP-STORE                     
026820             MOVE SU117-SML-NBR     TO  PV-DISP-SML                       
026821             DISPLAY ' SUKUT179'                                          
026822                     ' SQL:'   PV-DISP-SQLCODE                            
026823                     ' TRIP:'  PV-DISP-TRIP                               
026824                     ' OPER:'  PV-DISP-OPER                               
026825                     ' STR:'   PV-DISP-STORE                              
026826                     '  SML:'  PV-DISP-SML                                
026827             DISPLAY ' SUKUT179'                                          
026828                     ' CALC:'  PV-CALC-DESCRIPTION                        
026829                     ' FROM:'  PV-FROM-TIMESTAMP                          
026830                     ' TO:'    PV-TO-TIMESTAMP                            
026831*                                                                         
026832                                                                          
026833             MOVE '3000-CALC-TIME-DIFFERENCE  '                           
026834                                 TO PV-PARAGRAPH-NAME                     
026835             MOVE 'CALCULATE TIMESTAMP DIFFERENCE '                       
026836                                 TO PV-DB2-OPERATION-ATTEMPTED            
026837             PERFORM 9100-SQL-ABEND                                       
026838     END-EVALUATE.                                                        
026840                                                                          
026900                                                                          
034297*-----------------------------------------------------------------        
034298*  READ INPUT FILE                                                        
034299*-----------------------------------------------------------------        
034300 8000-READ-INPUT-REC.                                                     
034301                                                                          
034302     READ INPUT-FILE       INTO                                           
034303           SU117-EXTRACT-RECORD                                           
034304     AT END                                                               
034305         SET PS-EOF-INPUT             TO TRUE                             
034306         DISPLAY ' SUKUT179'                                              
034307                 'END OF INPUT FILE'                                      
034308         DISPLAY SPACES                                                   
034309     NOT AT END                                                           
034310         ADD  1                 TO  PV-INPUT-COUNTER                      
034311                                    PV-INPUT-BREAK                        
034312         IF  PV-INPUT-BREAK  >  1000                                      
034313             MOVE SU117-OPER-UNT-ID TO  PV-DISP-OPER                      
034314             MOVE SU117-STORE-DEST  TO  PV-DISP-STORE                     
034315             MOVE SU117-TRIP-ID     TO  PV-DISP-TRIP                      
034317             MOVE SU117-SML-NBR     TO  PV-DISP-SML                       
034318             MOVE PV-INPUT-COUNTER  TO  PV-DISPLAY-COUNT                  
034319             DISPLAY ' SUKUT179'                                          
034320                     '  OPER:'  PV-DISP-OPER                              
034321                     '  STORE:' PV-DISP-STORE                             
034322                     '  TRIP:'  PV-DISP-TRIP                              
034323                     '  SML:'   PV-DISP-SML                               
034324                     '  CNT:'   PV-DISPLAY-COUNT                          
034325             MOVE ZEROES            TO  PV-INPUT-BREAK                    
034326        END-IF                                                            
034327     END-READ.                                                            
034328                                                                          
034329*-----------------------------------------------------------------        
034330*  WRITE THE SHIPMENT-UNIT-RECORD                                         
034331*-----------------------------------------------------------------        
034340 8100-WRITE-OUTPUT-RECORD.                                                
034400                                                                          
034600     WRITE OUTPUT-RECORD                                                  
034700      FROM SU117-EXTRACT-RECORD.                                          
034800     ADD +1 TO PV-WRITE-COUNTER.                                          
034900                                                                          
035690     PERFORM 8110-WRITE-COMMA-RECORD.                                     
035700                                                                          
035701                                                                          
035702*-----------------------------------------------------------------        
035703*  WRITE COMMA DELIMITED DETAIL RECORD                                    
035704*-----------------------------------------------------------------        
035705 8110-WRITE-COMMA-RECORD.                                                 
035706                                                                          
035724     MOVE SU117-OPER-UNT-ID        TO SU122-OPER-UNT-ID.                  
035726     MOVE SU117-STORE-DEST         TO SU122-STORE-DEST.                   
035729     MOVE SU117-TRIP-ID            TO SU122-TRIP-ID.                      
035733     MOVE SU117-TRIP-OPEN-TMST     TO SU122-TRIP-OPEN-TMST.               
035738     MOVE SU117-TRIP-CLOSE-TMST    TO SU122-TRIP-CLOSE-TMST.              
035744     MOVE SU117-TRIP-SHIP-TMST     TO SU122-TRIP-SHIP-TMST.               
035745     MOVE SU117-TRIP-OPEN-TO-CLOSE-MIN                                    
035746                                   TO SU122-TRIP-OPEN-TO-CLOSE-MIN.       
035747     MOVE SU117-TRIP-CLOSE-TO-SHIP-MIN                                    
035748                                   TO SU122-TRIP-CLOSE-TO-SHIP-MIN.       
035749     MOVE SU117-TRIP-OPEN-TO-SHIP-MIN                                     
035750                                   TO SU122-TRIP-OPEN-TO-SHIP-MIN.        
035751     MOVE SU117-SML-SRC-CDE        TO SU122-SML-SRC-CDE.                  
035752     MOVE SU117-SML-NBR            TO SU122-SML-NBR.                      
035753     MOVE SU117-SML-CRE-DTE        TO SU122-SML-CRE-DTE.                  
035754     MOVE SU117-SML-CRE-TM         TO SU122-SML-CRE-TM.                   
035755     MOVE SU117-SML-P2L-OPEN-DTE   TO SU122-SML-P2L-OPEN-DTE.             
035756     MOVE SU117-SML-P2L-OPEN-TM    TO SU122-SML-P2L-OPEN-TM.              
035757     MOVE SU117-SML-P2L-CLOSE-DTE  TO SU122-SML-P2L-CLOSE-DTE.            
035758     MOVE SU117-SML-P2L-CLOSE-TM   TO SU122-SML-P2L-CLOSE-TM.             
035759     MOVE SU117-SML-ON-OTBND-DTE   TO SU122-SML-ON-OTBND-DTE.             
035760     MOVE SU117-SML-ON-OTBND-TM    TO SU122-SML-ON-OTBND-TM.              
035761     MOVE SU117-SML-ON-OTBND-CDE   TO SU122-SML-ON-OTBND-CDE.             
035762     MOVE SU117-MSTR-SML-NBR       TO SU122-MSTR-SML-NBR.                 
035763     MOVE SU117-MSTR-CRE-DTE       TO SU122-MSTR-CRE-DTE.                 
035764     MOVE SU117-MSTR-CRE-TM        TO SU122-MSTR-CRE-TM.                  
035765     MOVE SU117-SML-IN-MSTR-DTE    TO SU122-SML-IN-MSTR-DTE.              
035766     MOVE SU117-SML-IN-MSTR-TM     TO SU122-SML-IN-MSTR-TM.               
035767     MOVE SU117-FIRST-SML-IN-MSTR-DTE                                     
035768                                   TO SU122-FIRST-SML-IN-MSTR-DTE.        
035769     MOVE SU117-FIRST-SML-IN-MSTR-TM                                      
035770                                   TO SU122-FIRST-SML-IN-MSTR-TM.         
035771     MOVE SU117-LAST-SML-IN-MSTR-DTE                                      
035772                                   TO SU122-LAST-SML-IN-MSTR-DTE.         
035773     MOVE SU117-LAST-SML-IN-MSTR-TM                                       
035774                                   TO SU122-LAST-SML-IN-MSTR-TM.          
035775     MOVE SU117-TRN-NBR            TO SU122-TRN-NBR.                      
035776     MOVE SU117-REC-SEQ-NBR        TO SU122-REC-SEQ-NBR.                  
035777     MOVE SU117-TRN-LNE-NBR        TO SU122-TRN-LNE-NBR.                  
035778     MOVE SU117-SML-UNT-QTY        TO SU122-SML-UNT-QTY.                  
035779     MOVE SU117-REC-SEQ-ARRIVE-DTE TO SU122-REC-SEQ-ARRIVE-DTE.           
035780     MOVE SU117-REC-SEQ-ARRIVE-TM  TO SU122-REC-SEQ-ARRIVE-TM.            
035781     MOVE SU117-SRC-CART-PRC-DTE   TO SU122-SRC-CART-PRC-DTE.             
035782     MOVE SU117-SRC-CART-PRC-TM    TO SU122-SRC-CART-PRC-TM.              
035783     MOVE SU117-PKD-IN-P2L-SML-DTE TO SU122-PKD-IN-P2L-SML-DTE.           
035784     MOVE SU117-PKD-IN-P2L-SML-TM  TO SU122-PKD-IN-P2L-SML-TM.            
035785     MOVE SU117-ARRIVE-TO-PRC-MIN  TO SU122-ARRIVE-TO-PRC-MIN.            
035786     MOVE SU117-ARRIVE-TO-P2L-PKD-MIN                                     
035787                                   TO SU122-ARRIVE-TO-P2L-PKD-MIN.        
035788     MOVE SU117-PRC-TO-P2L-PKD-MIN TO SU122-PRC-TO-P2L-PKD-MIN.           
035789     MOVE SU117-P2L-PKD-TO-CLOSE-MIN                                      
035790                                   TO SU122-P2L-PKD-TO-CLOSE-MIN.         
035791     MOVE SU117-P2L-OPEN-TO-CLOSE-MIN                                     
035792                                   TO SU122-P2L-OPEN-TO-CLOSE-MIN.        
035793     MOVE SU117-P2L-CLOSE-TO-OTBND-MIN                                    
035794                                   TO SU122-P2L-CLOSE-TO-OTBND-MIN.       
035795     MOVE SU117-ARRIVE-TO-OTBND-MIN                                       
035796                                   TO SU122-ARRIVE-TO-OTBND-MIN.          
035797     MOVE SU117-PRC-TO-OTBND-MIN   TO SU122-PRC-TO-OTBND-MIN.             
035798     MOVE SU117-ARRIVE-TO-TCLOS-MIN                                       
035799                                   TO SU122-ARRIVE-TO-TCLOS-MIN.          
035800     MOVE SU117-ARRIVE-TO-SHIP-MIN TO SU122-ARRIVE-TO-SHIP-MIN.           
035801     MOVE SU117-P2L-OPEN-TO-TCLOS-MIN                                     
035802                                   TO SU122-P2L-OPEN-TO-TCLOS-MIN.        
035803     MOVE SU117-P2L-OPEN-TO-SHIP-MIN                                      
035804                                   TO SU122-P2L-OPEN-TO-SHIP-MIN.         
035805     MOVE SU117-P2L-CLOSE-TO-TCLOS-MIN                                    
035806                                   TO SU122-P2L-CLOSE-TO-TCLOS-MIN.       
035807     MOVE SU117-P2L-CLOSE-TO-SHIP-MIN                                     
035808                                   TO SU122-P2L-CLOSE-TO-SHIP-MIN.        
035809     MOVE SU117-ARRIVE-TO-MSTR-MIN TO SU122-ARRIVE-TO-MSTR-MIN.           
035810     MOVE SU117-PRC-TO-MSTR-MIN    TO SU122-PRC-TO-MSTR-MIN.              
035811     MOVE SU117-MSTR-CRE-TO-OTBND-MIN                                     
035812                                   TO SU122-MSTR-CRE-TO-OTBND-MIN.        
035813     MOVE SU117-MSTR-CRE-TO-TCLOS-MIN                                     
035814                                   TO SU122-MSTR-CRE-TO-TCLOS-MIN.        
035815     MOVE SU117-MSTR-CRE-TO-SHIP-MIN                                      
035816                                   TO SU122-MSTR-CRE-TO-SHIP-MIN.         
035817     MOVE SU117-MSTR-FIRST-TO-OTBND-MIN                                   
035818                                 TO SU122-MSTR-FIRST-TO-OTBND-MIN.        
035819     MOVE SU117-MSTR-FIRST-TO-TCLOS-MIN                                   
035820                                 TO SU122-MSTR-FIRST-TO-TCLOS-MIN.        
035821     MOVE SU117-MSTR-FIRST-TO-SHIP-MIN                                    
035822                                   TO SU122-MSTR-FIRST-TO-SHIP-MIN.       
035823     MOVE SU117-MSTR-LAST-TO-OTBND-MIN                                    
035824                                   TO SU122-MSTR-LAST-TO-OTBND-MIN.       
035825     MOVE SU117-MSTR-LAST-TO-TCLOS-MIN                                    
035826                                   TO SU122-MSTR-LAST-TO-TCLOS-MIN.       
035827     MOVE SU117-MSTR-LAST-TO-SHIP-MIN                                     
035828                                   TO SU122-MSTR-LAST-TO-SHIP-MIN.        
035829     MOVE SU117-ON-OTBND-TO-CLOS-MIN                                      
035830                                   TO SU122-ON-OTBND-TO-CLOS-MIN.         
035832     MOVE SU117-ON-OTBND-TO-SHIP-MIN                                      
035833                                   TO SU122-ON-OTBND-TO-SHIP-MIN.         
035835                                                                          
035836     MOVE ','                      TO SU122-COMMA-001                     
035837                                      SU122-COMMA-002                     
035838                                      SU122-COMMA-003                     
035839                                      SU122-COMMA-004                     
035840                                      SU122-COMMA-005                     
035841                                      SU122-COMMA-006                     
035842                                      SU122-COMMA-007                     
035843                                      SU122-COMMA-008                     
035844                                      SU122-COMMA-009                     
035845                                      SU122-COMMA-010                     
035846                                      SU122-COMMA-011                     
035847                                      SU122-COMMA-012                     
035848                                      SU122-COMMA-013                     
035849                                      SU122-COMMA-014                     
035850                                      SU122-COMMA-015                     
035851                                      SU122-COMMA-016                     
035852                                      SU122-COMMA-017                     
035853                                      SU122-COMMA-018                     
035854                                      SU122-COMMA-019                     
035855                                      SU122-COMMA-020                     
035856                                      SU122-COMMA-021                     
035857                                      SU122-COMMA-022                     
035858                                      SU122-COMMA-023                     
035859                                      SU122-COMMA-024                     
035860                                      SU122-COMMA-025                     
035861                                      SU122-COMMA-026                     
035862                                      SU122-COMMA-027                     
035863                                      SU122-COMMA-028                     
035864                                      SU122-COMMA-029                     
035865                                      SU122-COMMA-030                     
035866                                      SU122-COMMA-031                     
035867                                      SU122-COMMA-032                     
035868                                      SU122-COMMA-033                     
035869                                      SU122-COMMA-034                     
035870                                      SU122-COMMA-035                     
035871                                      SU122-COMMA-036                     
035872                                      SU122-COMMA-037                     
035873                                      SU122-COMMA-038                     
035874                                      SU122-COMMA-039                     
035875                                      SU122-COMMA-040                     
035876                                      SU122-COMMA-041                     
035877                                      SU122-COMMA-042                     
035878                                      SU122-COMMA-043                     
035879                                      SU122-COMMA-044                     
035880                                      SU122-COMMA-045                     
035881                                      SU122-COMMA-046                     
035882                                      SU122-COMMA-047                     
035883                                      SU122-COMMA-048                     
035884                                      SU122-COMMA-049                     
035885                                      SU122-COMMA-050                     
035886                                      SU122-COMMA-051                     
035887                                      SU122-COMMA-052                     
035888                                      SU122-COMMA-053                     
035889                                      SU122-COMMA-054                     
035890                                      SU122-COMMA-055                     
035891                                      SU122-COMMA-056                     
035892                                      SU122-COMMA-057                     
035893                                      SU122-COMMA-058                     
035894                                      SU122-COMMA-059                     
035895                                      SU122-COMMA-060                     
035896                                      SU122-COMMA-061                     
035897                                      SU122-COMMA-062                     
035898                                      SU122-COMMA-063                     
035899                                      SU122-COMMA-064                     
035900                                      SU122-COMMA-065                     
035901                                      SU122-COMMA-066                     
035902                                      SU122-COMMA-067.                    
035903                                                                          
035904*                                                                         
035905                                                                          
035906     WRITE COMMA-RECORD                                                   
035907      FROM SU122-EXTRACT-RECORD.                                          
035908                                                                          
035909                                                                          
035910*-----------------------------------------------------------------        
035911*  CLOSE OUTPUT FILE.  CLOSE THE CURSOR.                                  
035912*-----------------------------------------------------------------        
035920 9000-EOJ-ROUTINE.                                                        
036000                                                                          
036300     CLOSE INPUT-FILE                                                     
036310           OUTPUT-FILE                                                    
036320           COMMA-DELIMITED-FILE.                                          
036400                                                                          
036410     DISPLAY SPACES.                                                      
036420     DISPLAY ' SUKUT179 '.                                                
036500     MOVE PV-INPUT-COUNTER  TO PV-DISPLAY-COUNT.                          
036601     DISPLAY 'TOTAL INPUT:   ' PV-DISPLAY-COUNT.                          
036610     MOVE PV-WRITE-COUNTER  TO PV-DISPLAY-COUNT.                          
036620     DISPLAY 'TOTAL OUTPUT:  ' PV-DISPLAY-COUNT.                          
036630     DISPLAY SPACES.                                                      
036700                                                                          
040200                                                                          
040210*-----------------------------------------------------------------        
040220*  PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL            
040230*  ERROR OR WARNING CODE OCCURS.                                          
040240*-----------------------------------------------------------------        
040300 9100-SQL-ABEND.                                                          
040800     DISPLAY '9100-SQL-ABEND'.                                            
040900     DISPLAY '** ABEND     **'.                                           
041000     DISPLAY '** PROGRAM   ** =  SUKUT179'.                               
041100     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.                      
041200     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.             
041300                                                                          
041400******************************************************************        
041500* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-            
041600* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE                 
041700* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE             
041800* FORMAT.                                                                 
041900******************************************************************        
042000     COPY DPPD004.                                                        
042100                                                                          
042200     MOVE +4013                  TO ABEND-CODE.                           
042300     CALL 'ILBOABN0' USING ABEND-CODE.                                    
042310/                                                                         
