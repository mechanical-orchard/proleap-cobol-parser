      ******************************************************************        
       IDENTIFICATION DIVISION.                                                 
      ******************************************************************        
                                                                                
       PROGRAM-ID.             INKRP139.                                        
       AUTHOR.                 JULIE SEIDLER.                                   
       INSTALLATION.           KOHLS DEPARTMENT STORES.                         
       DATE-WRITTEN            11-13-97.                                        
       DATE-COMPILED.                                                           
                                                                                
      ******************************************************************        
      *       THIS PROGRAM TAKES VERIFIED RECEIPTS FROM THE RECEIVING           
      *  SYSTEM AND REPORTS ON THEM BY PO/REC, DEPT, CLASS, STORE.              
      *       THIS PROGRAM WAS WRITTEN TO VERIFY THAT BEFORE/AFTER              
      *  RECEIPTS WERE CORRECTLY BEING PROCESSED IN A MULITPLE DC FLUSH         
      *  ENVIRONMENT.  IT WILL BE USED TO COMPARE TOTALS ON THE VERIFIED        
      *  RECEIPTS REPORT OUT OF MERCHANDISE LEDGER.                             
      *                                                                         
      *  IN ORDER TO BALANCE TO THE M/L VERIFIED RECEIPTS REPORT THE            
      *  FOLLOWING TYPES OF TRANSACTIONS ARE OMITTED:                           
      *     1) SKIP DEPARTMENTS (NOT PROCESSED BY M/L)                          
      *                                                                         
      *  CHANGES:                                                               
      *     01/05/98 WR# 99999                                                  
      *     TRANSACTIONS VERIFIED BEFORE THE CURRENT WEEK SHOULD NOT            
      *     BE REPORTED ON.  CHANGED PGM TO EXCLUDE THIS TYPE OF                
      *     TRANSACTIONS FROM THE DETAIL PART OF THE REPORT                     
      *                                                                         
      *  CHANGES:                                                               
      *     04/10/98 WR# 6041 JULIE SEIDLER                                     
      *     CHANGED DATE COMPARISON TO INCLUDE CENTURY. THIS IS PART            
      *     OF Y2K CHANGES.                                                     
      *                                                                         
      *  CHANGES:                                                               
      *     01/20/99 WR# 9999 JULIE SEIDLER                                     
      *     REMOVED LOGIC THAT CHECKS FOR CURRENT AND PRIOR WEEK.               
      *     THIS CHANGE IS A RESULT OF THE M/L SYSTEM ELIMINATING               
      *     UNJOURNALIZED PROCESSING.                                           
      *                                                                         
      *     REPORTS WILL NOW INCLUDE RECEIPTS VERIFIED BOTH THIS                
      *     WEEK AND ANY PREVIOUS WEEKS.                                        
      *                                                                         
      *     ALSO REMOVE CONSIGNMENT LOGIC.  KOHLS NO LONGER HAS                 
      *     CONSIGNMENT MERCHANDISE.                                            
      *                                                                         
      *  CHANGES:                                                               
      *     01/26/99 WR# 9999 JULIE SEIDLER                                     
      *     CHANGED VERIFIED DATE LOGIC TO BE LIKE THE LOGIC IN                 
      *     MLK130/INKUT401.  THIS CHANGE WAS NEEDED BECAUSE OF THE             
      *     ML RECEIPT CHANGE.  THIS CHANGE WILL MAKE THE                       
      *     THE FS FLUSH REPORT BALANCE TO THE ML FLUSH REPORTS.                
      *                                                                         
      *  CHANGES:                                                               
      *     05/19/99 WR# 9999 JULIE SEIDLER                                     
      *     CHANGED PROGRAM TO ONLY REPORT ON STORES DOING INVENTORY.           
      *     THIS IS PART THE THE JUNE 1999 INVENTORY PROJECT                    
      *                                                                         
      *  CHANGES:                                                               
      *     08/09/99 WR# 9999 JULIE SEIDLER                                     
      *     REMOVED REFERENCE TO DPG51-SYSTEM-DATE                              
      *                                                                         
      *  CHANGES:                                                               
      *     01/25/00 WR# 9999 TESS BESTE (LOOK FOR TB0100 TO IDENTIFY           
      *         THESE CHANGES.)                                                 
      *                                                                         
      *     1)  CORRECTED PROBLEM IN Y2K WINDOWING LOGIC THAT IS USED           
      *         WHEN DETERMINING WHETHER A RECEIPT IS A 'BEFORE' OR AN          
      *         'AFTER'.  THE WINDOWING LOGIC WAS ALWAYS CHECKING THE           
      *         YEAR OF THE VERIFIED DATE, EVEN IF IT WAS THE RECEIPT           
      *         DATE THAT WAS BEING USED.  (THE RECEIVED DATE IS USED           
      *         FOR DIRECT STORE SHIPS.  THE VERIFIED DATE IS USED FOR          
      *         EVERYTHING ELSE.)  CHANGED LOGIC TO CHECK THE YEAR OF           
      *         WHICHEVER DATE WAS ACTUALLY BEING USED.                         
      *                                                                         
      *     2)  COMMENTED OUT LOGIC THAT WAS ADDED FOR THE CHANGE MADE          
      *         ON 05/19/99 TO ONLY REPORT ON STORES DOING INVENTORY.           
      *                                                                         
RB0700*  CHANGES:                                                               
RB0700*     07/28/00 WR# 21015 RONNA BUTZ (LOOK FOR RB0700 TO IDENTIFY          
RB0700*         THESE CHANGES.)  DO NOT INCLUDE STORES THAT ARE                 
RB0700*         DOING AN ESTIMATED INVENTORY.  UNCOMMENTED THE LOGIC            
RB0700*         THAT WAS ADDED FOR THE CHANGE MADE ON 05/19/99 TO ONLY          
RB0700*         REPORT ON STORES DOING INVENTORY, AND UNCOMMENTED LOGIC         
RB0700*         CHANGED FROM 'TB0100'.  ALSO, ADDED LOGIC                       
RB0700*         TO THE TINVPAR CURSOR SO THAT THE CURSOR ONLY INCLUDES          
RB0700*         STORES THAT ARE EITHER CLOSED OR DOING A PHYSICAL               
RB0700*         INVENTORY.                                                      
RB0700*         THE REASON FOR THIS ENHANCEMENT IS BECAUSE DATA FOR             
RB0700*         ESTIMATED STORES IS NOT STORED IN THE INVENTORY LEDGER          
RB0700*         TABLES, BUT IT IS STORED IN THE MERCHANDISE LEDGER              
RB0700*         TABLES.  THE BEFORE RECEIPTS ON THIS REPORT ONLY                
RB0700*         INCLUDES DATA FOR STORES DOING A PHYSICAL INVENTORY             
RB0700*         AND IT DOES NOT INCLUDE DATA FOR STORES DOING AN                
RB0700*         ESTIMATED INVENTORY.  THE SUM OF THE BEFORE AND                 
RB0700*         AFTER RECEIPTS WILL NOT MATCH MERCHANDISE LEDGER                
RB0700*         BUT IT WILL MATCH INVENTORY LEDGER.                             
RB0201*                                                                         
RB0201******************************************************************        
RB0201*  CHANGES:                                                               
RB0201*     02/28/01 WR# 21591 RONNA BUTZ (LOOK FOR RB0201 TO IDENTIFY          
RB0201*                                                                         
RB0201*     CHANGES ARE TO HANDLE STORES THAT ARE DOING MANIFESTING.            
RB0201*     IF A STORE IS DOING MANIFESTING, THEN USE THE STORE'S               
RB0201*     PLANNED INVENTORY DATE INSTEAD OF THE DC CUTOFF DATE.               
RB0201*                                                                         
      ******************************************************************        
W21732*  CHANGES:                                                               
W21732*     01/02/03 WR# 21732 ASHOK, IGSI.                                     
W21732*                                                                         
W21732*     CHANGED THE MILTIPLE FLUSH REPORT TO PRINT SKU ALONG WITH           
W21732*     DEPT/CLASS AND REMOVED SEQ.                                         
W26600* W26600  04-05-2004 ROD JANSSEN INV LEDGER STORE EXPANSION               
R26600* W26600  06-29-2004 ROD JANSSEN INV STORE EXPANSION                      
W29908* W29908  02-05-2006 ROD JANSSEN FLUSH REPORT ABEND WHEN NOT IN AN        
W29908*                                INVENTORY PERIOD.                        
W30272* W30272  03-17-2006 ROD JANSSEN FOR MARCH 2006 INVENTORY, INCLUDE        
W30272*                                STORES WHICH ARE FUTURED DATED           
W30272*                                LOCATIONS.....                           
W28545* W28545  07-21-2006 J SELWITSCHKA / STRATAGEM                            
W28545*                                DEPARTMENT LEVEL INVENTORY.              
W28545*                                INCORPORATE INVENTORY ID.                
W33304* W33304  11-17-2008 SATHISH / INFOSYS                                    
W33304*                                HOLDING INVENTORY LEDGER OPEN            
W33304*                                CHANGES.                                 
W34557* W34557  10-10-2011 J SELWITSCHKA                                        
W34557*                                ADD DATE CHECK FOR PREVIOUS MONTH        
W34557*                                END DATE AND PLANNED INVENTORY           
W34557*                                DATE TO INCLUDE ALL STORES IN            
W34557*                                ACTIVE CYCLES.                           
W21732******************************************************************        
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER.        IBM-3090.                                        
       OBJECT-COMPUTER.        IBM-3090.                                        
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT STORE-EXTRACT-FILE                                            
               ASSIGN TO INP01.                                                 
                                                                                
           SELECT SKIP-CLASS-CARD                                               
               ASSIGN TO INP02.                                                 
                                                                                
           SELECT VERIFIED-RECEIPTS-RPT                                         
               ASSIGN TO OUT01.                                                 
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       FD  STORE-EXTRACT-FILE                                                   
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 300 CHARACTERS                                       
           DATA RECORD IS STORE-EXTRACT-RECORD.                                 
                                                                                
       01  STORE-EXTRACT-RECORD        PIC X(300).                              
                                                                                
       FD  SKIP-CLASS-CARD                                                      
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 80 CHARACTERS                                        
           DATA RECORD IS SKIP-CLASS-RECORD.                                    
                                                                                
       01  SKIP-CLASS-RECORD           PIC X(80).                               
                                                                                
       FD  VERIFIED-RECEIPTS-RPT                                                
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 132 CHARACTERS                                       
           DATA RECORD IS VERIFIED-RECEIPTS-LINE.                               
                                                                                
       01  VERIFIED-RECEIPTS-LINE      PIC X(132).                              
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
      *                                                                         
      *  FILE LAYOUT FOR STORE EXTRACT DATA                                     
      *                                                                         
                                                                                
W26600     COPY STOREEXT.                                                       
                                                                                
      *                                                                         
      *  STANDARD REPORT HEADER FOR A 132 COLUMN REPORT                         
      *                                                                         
                                                                                
           COPY DPWS132O.                                                       
                                                                                
       01  ABEND-CODE                  PIC S9(4)    VALUE ZERO                  
                                       COMP SYNC.                               
                                                                                
       01  PS-PROGRAM-SWITCHES.                                                 
           05  PS-END-OF-EXTRACT-FILE-IND                                       
                                       PIC X(1)     VALUE 'N'.                  
               88  PS-NOT-END-OF-EXTRACT-FILE       VALUE 'N'.                  
               88  PS-END-OF-EXTRACT-FILE           VALUE 'Y'.                  
RB0700     05  PS-INVENTORY-STORE-IND                                           
RB0700                                 PIC X(1)     VALUE 'N'.                  
RB0700         88  PS-FOUND-INVENTORY-STORE         VALUE 'Y'.                  
RB0700         88  PS-NOT-FOUND-INVENTORY-STORE     VALUE 'N'.                  
           05  PS-END-OF-SKIP-CLASS-CARD-IND                                    
                                       PIC X(1)     VALUE 'N'.                  
               88  PS-NOT-END-OF-SKIP-CLASS-CARD    VALUE 'N'.                  
               88  PS-END-OF-SKIP-CLASS-CARD        VALUE 'Y'.                  
           05  PS-END-OF-INVPAR-CURSOR-IND                                      
                                       PIC X(1)     VALUE 'N'.                  
               88  PS-END-OF-INVPAR-CURSOR          VALUE 'Y'.                  
           05  PS-END-OF-STR000-CURSOR-IND                                      
                                       PIC X(1)     VALUE 'N'.                  
               88  PS-END-OF-STR000-CURSOR          VALUE 'Y'.                  
           05  PS-FIRST-SKU-FOR-PO-IND  PIC X(1)     VALUE 'N'.                 
               88  PS-NOT-FIRST-SKU-FOR-PO          VALUE 'N'.                  
               88  PS-FIRST-SKU-FOR-PO              VALUE 'Y'.                  
           05  PS-FIRST-SKU-FOR-STR-IND PIC X(1)     VALUE 'N'.                 
               88  PS-NOT-FIRST-SKU-FOR-STR         VALUE 'N'.                  
               88  PS-FIRST-SKU-FOR-STR             VALUE 'Y'.                  
           05  PS-BEF-AFT-INV-IND       PIC X(1)     VALUE 'N'.                 
               88  PS-BEF-INV-TTL                   VALUE 'N'.                  
               88  PS-AFT-INV-TTL                   VALUE 'Y'.                  
           05  PS-LAST-PAGE-OF-RPT-IND  PIC X(1)     VALUE 'N'.                 
               88  PS-NOT-LAST-PAGE                 VALUE 'N'.                  
               88  PS-LAST-PAGE                     VALUE 'Y'.                  
           05  PS-FIRST-LINE-ON-RPT-IND  PIC X(1)   VALUE 'N'.                  
               88  PS-NOT-FIRST-LINE                VALUE 'N'.                  
               88  PS-FIRST-LINE                    VALUE 'Y'.                  
           05  PS-STORE-TTL-WRITTEN-IND PIC X(1)    VALUE 'N'.                  
               88  PS-STORE-TTL-NOT-WRITTEN         VALUE 'N'.                  
               88  PS-STORE-TTL-WRITTEN             VALUE 'Y'.                  
           05  PS-CLASS-TTL-WRITTEN-IND PIC X(1)    VALUE 'N'.                  
               88  PS-CLASS-TTL-NOT-WRITTEN         VALUE 'N'.                  
               88  PS-CLASS-TTL-WRITTEN             VALUE 'Y'.                  
           05  PS-DEPT-IND              PIC X(1)    VALUE 'N'.                  
               88  PS-DEPT-NOT-FOUND                VALUE 'N'.                  
               88  PS-DEPT-FOUND                    VALUE 'Y'.                  
       01  PC-PROGRAM-CONSTANTS.                                                
           05  PC-PAGE-SIZE            PIC S9(4)    VALUE +58                   
                                       COMP SYNC.                               
           05  PC-PAGE-SIZE-TTL        PIC S9(4)    VALUE +50                   
                                       COMP SYNC.                               
W26600     05  PC-SUB                  PIC S9(04) COMP VALUE ZERO.              
W26600     05  PC-SUB-INV-STR          PIC S9(04) COMP VALUE ZERO.              
           05  PC-DEFAULT-DTE          PIC X(10)    VALUE '9999-09-09'.         
                                                                                
                                                                                
       01  PV-PROGRAM-VARIABLES.                                                
           05  PV-LINE-COUNT           PIC S9(4)    VALUE +59                   
                                       COMP SYNC.                               
           05  PV-PAGE-COUNT           PIC S9(5)    VALUE ZERO                  
                                       COMP-3.                                  
R26600     05  PV-MAX-SKIP-RECS        PIC 9(5)     VALUE 99999.                
           05  PV-SAVE-TOTAL-SALES     PIC S9(11)V99                            
                                                    VALUE ZERO                  
                                       COMP-3.                                  
W26600     05  PV-SKU-BEF-RETAIL       PIC S9(11)V99                            
                                                    VALUE ZERO                  
                                       COMP-3.                                  
           05  PV-SKU-BEF-UNITS        PIC S9(11)                               
                                                    VALUE ZERO                  
                                       COMP-3.                                  
W26600     05  PV-SKU-AFT-RETAIL       PIC S9(11)V99                            
                                                    VALUE ZERO                  
                                       COMP-3.                                  
           05  PV-SKU-AFT-UNITS        PIC S9(11)                               
                                                    VALUE ZERO                  
                                       COMP-3.                                  
W26600     05  PV-STR-BEF-RETAIL       PIC S9(11)V99                            
                                                    VALUE ZERO                  
                                       COMP-3.                                  
           05  PV-STR-BEF-UNITS        PIC S9(11)                               
                                                    VALUE ZERO                  
                                       COMP-3.                                  
W26600     05  PV-STR-AFT-RETAIL       PIC S9(11)V99                            
                                                    VALUE ZERO                  
                                       COMP-3.                                  
           05  PV-STR-AFT-UNITS        PIC S9(11)                               
                                                    VALUE ZERO                  
                                       COMP-3.                                  
W26600     05  PV-CLASS-BEF-RETAIL     PIC S9(11)V99                            
                                                    VALUE ZERO                  
                                       COMP-3.                                  
           05  PV-CLASS-BEF-UNITS      PIC S9(11)                               
                                                    VALUE ZERO                  
                                       COMP-3.                                  
W26600     05  PV-CLASS-AFT-RETAIL     PIC S9(11)V99                            
                                                    VALUE ZERO                  
                                       COMP-3.                                  
           05  PV-CLASS-AFT-UNITS      PIC S9(11)                               
                                                    VALUE ZERO                  
                                       COMP-3.                                  
W26600     05  PV-DEPT-BEF-RETAIL      PIC S9(11)V99                            
                                                    VALUE ZERO                  
                                       COMP-3.                                  
           05  PV-DEPT-BEF-UNITS       PIC S9(11)                               
                                                    VALUE ZERO                  
                                       COMP-3.                                  
W26600     05  PV-DEPT-AFT-RETAIL      PIC S9(11)V99                            
                                                    VALUE ZERO                  
                                       COMP-3.                                  
           05  PV-DEPT-AFT-UNITS       PIC S9(11)                               
                                                    VALUE ZERO                  
                                       COMP-3.                                  
W26600     05  PV-GRD-BEF-RETAIL    PIC S9(11)V99                               
                                                    VALUE ZERO                  
                                       COMP-3.                                  
           05  PV-GRD-BEF-UNITS     PIC S9(11)                                  
                                                    VALUE ZERO                  
                                       COMP-3.                                  
W26600     05  PV-GRD-AFT-RETAIL    PIC S9(11)V99                               
                                                    VALUE ZERO                  
                                       COMP-3.                                  
           05  PV-GRD-AFT-UNITS     PIC S9(11)                                  
                                                    VALUE ZERO                  
                                       COMP-3.                                  
W26600     05  PV-PROC-WK-GRD-RETAIL  PIC S9(11)V99                             
                                                    VALUE ZERO                  
                                       COMP-3.                                  
           05  PV-PROC-WK-GRD-UNITS   PIC S9(11)                                
                                                    VALUE ZERO                  
                                       COMP-3.                                  
           05  PV-RPT-LINE-SEQ         PIC 9(5)     VALUE ZERO                  
                                       COMP-3.                                  
           05  PV-PREV-PO              PIC X(8)     VALUE SPACES.               
           05  PV-PREV-REC-SEQ-NBR     PIC X(9)     VALUE SPACES.               
W26600     05  PV-PREV-STORE           PIC S9(04) COMP VALUE ZERO.              
           05  PV-PREV-DEPT            PIC X(3)     VALUE SPACES.               
W21732     05  PV-PREV-SKU-NBR         PIC X(8)     VALUE SPACES.               
           05  PV-SE-CLASS.                                                     
               10  PV-SE-MJR-CLASS     PIC X(1)     VALUE SPACES.               
               10  PV-SE-SUB-CLASS     PIC X(1)     VALUE SPACES.               
               10  FILLER              PIC X(1)     VALUE SPACES.               
           05  PV-PREV-CLASS.                                                   
               10  PV-PREV-MJR-CLASS   PIC X(1)     VALUE SPACES.               
               10  PV-PREV-SUB-CLASS   PIC X(1)     VALUE SPACES.               
               10  FILLER              PIC X(1)     VALUE SPACES.               
           05  PV-SE-DEPT-SUB-CLASS.                                            
               10  PV-SE-DC-DEPT       PIC X(3)     VALUE SPACES.               
               10  PV-SE-DC-CLASS      PIC X(2)     VALUE SPACES.               
           05  PV-SE-DEPT-MJR-CLASS.                                            
               10  PV-SE-DC-DEPT-MC    PIC X(3)     VALUE SPACES.               
               10  PV-SE-DC-CLASS-MC   PIC X(1)     VALUE SPACES.               
               10  FILLER              PIC X(1)     VALUE ZEROES.               
           05  PV-2-DIGIT-CLASS.                                                
               10  PV-2-DIGIT-MJR-CLASS PIC X(1)     VALUE SPACES.              
               10  PV-2-DIGIT-SUB-CLASS PIC X(1)     VALUE SPACES.              
           05  PV-PREV-DATE-VERIFIED   PIC X(6)     VALUE SPACES.               
           05  PV-RETAIL-EXTENSION     PIC 9(8)V99  VALUE ZERO                  
                                       COMP-3.                                  
           05  PV-RETAIL-UNITS         PIC 9(6)     VALUE ZERO                  
                                       COMP-3.                                  
           05  PV-PARAGRAPH-NAME       PIC X(30)    VALUE SPACES.               
           05  PV-DB2-OPERATION-ATTEMPTED                                       
                                       PIC X(30)    VALUE SPACES.               
           05  PV-DEPT-NBR             PIC X(03) VALUE LOW-VALUES.              
                                                                                
       01  CC-SKIP-CLASS-RECORD.                                                
           05  SKIP-CLASS-NBR          PIC X(05).                               
           05  FILLER                  PIC X(75).                               
                                                                                
       01  SKIP-CLASS-TABLE.                                                    
R26600     05 SKIP-CLASS               OCCURS 99999                             
                                       INDEXED BY SKIP-IDX                      
                                       PIC X(05).                               
       01  CD-CURRENT-DATE.                                                     
           05  CD-CURRENT-YEAR         PIC 9(2)     VALUE ZERO.                 
           05  CD-CURRENT-MONTH        PIC 9(2)     VALUE ZERO.                 
           05  CD-CURRENT-DAY          PIC 9(2)     VALUE ZERO.                 
                                                                                
       01  CD-CCYYMMDD-HOLD.                                                    
           05  CD-CCYYMMDD-HOLD-CC     PIC 9(2)     VALUE ZERO.                 
           05  CD-CCYYMMDD-HOLD-YY     PIC 9(2)     VALUE ZERO.                 
           05  CD-CCYYMMDD-HOLD-MM     PIC 9(2)     VALUE ZERO.                 
           05  CD-CCYYMMDD-HOLD-DD     PIC 9(2)     VALUE ZERO.                 
                                                                                
       01  CD-1ST-WKDY.                                                         
           05  CD-1ST-WKDY-CCYY        PIC 9(4)     VALUE ZERO.                 
           05  CD-1ST-WKDY-MM          PIC 9(2)     VALUE ZERO.                 
           05  CD-1ST-WKDY-DD          PIC 9(2)     VALUE ZERO.                 
                                                                                
       01  CD-PLNDATE                  PIC X(10)    VALUE ZERO.                 
                                                                                
       01  CD-THIS-YEAR-DTE.                                                    
           05  CD-THIS-YEAR            PIC X(4).                                
           05  FILLER                  PIC X(1)     VALUE '-'.                  
           05  FILLER                  PIC X(2)     VALUE '01'.                 
           05  FILLER                  PIC X(1)     VALUE '-'.                  
           05  FILLER                  PIC X(2)     VALUE '01'.                 
                                                                                
       01  CD-DATE-WITH-DASHES.                                                 
           05  CD-CC-WITH-DASHES       PIC X(2).                                
           05  CD-YY-WITH-DASHES       PIC X(2).                                
           05  FILLER                  PIC X(1).                                
           05  CD-MM-WITH-DASHES       PIC X(2).                                
           05  FILLER                  PIC X(1).                                
           05  CD-DD-WITH-DASHES       PIC X(2).                                
                                                                                
       01  CT-CURRENT-TIME.                                                     
           05  CT-CURRENT-HOUR         PIC 9(2)     VALUE ZERO.                 
           05  CT-CURRENT-MINUTE       PIC 9(2)     VALUE ZERO.                 
           05  FILLER                  PIC 9(4)     VALUE ZERO.                 
                                                                                
       01  WS-STORE-TABLE.                                                      
W26600     05  WS-TABLE OCCURS 9999 TIMES.                                      
W26600         10  TBL-STORE-NBR           PIC S9(04) COMP.                     
               10  TBL-STORE-DC-DATE       PIC 9(8).                            
               10  TBL-STORE-DC-DATE-X REDEFINES TBL-STORE-DC-DATE.             
Y2K98              15  TBL-DC-DATE-CC      PIC 9(2).                            
                   15  TBL-DC-DATE-YY      PIC 9(2).                            
                   15  TBL-DC-DATE-MM      PIC 9(2).                            
                   15  TBL-DC-DATE-DD      PIC 9(2).                            
               10  TBL-STORE-TYPE-CODE     PIC X(2).                            
                                                                                
           COPY DPWS500.                                                        
                                                                                
       01  HL2-HEADING-LINE-2.                                                  
           05  FILLER                  PIC X(2)     VALUE SPACES.               
           05  FILLER                  PIC X(3)     VALUE SPACES.               
           05  FILLER                  PIC X(3)     VALUE SPACES.               
           05  FILLER                  PIC X(31)    VALUE SPACES.               
           05  FILLER                  PIC X(07)    VALUE SPACES.               
           05  FILLER                  PIC X(37)    VALUE                       
               '      MULTIPLE FLUSH REPORT BY PO NBR'.                         
           05  FILLER                  PIC X(45)    VALUE SPACES.               
                                                                                
       01  HL2A-HEADING-LINE-2A.                                                
           05  FILLER                  PIC X(56)    VALUE SPACES.               
           05  FILLER                  PIC X(14)    VALUE                       
               'PROCESSING WK '.                                                
           05  HL2A-1ST-WKDY           PIC 99/99/99 VALUE ZERO.                 
           05  FILLER                  PIC X(56)    VALUE SPACES.               
                                                                                
                                                                                
       01  HL3-HEADING-LINE-3.                                                  
           05  FILLER                  PIC X(29)    VALUE SPACES.               
           05  FILLER                  PIC X(06)    VALUE                       
               'VERIFY'.                                                        
           05  FILLER                  PIC X(97)    VALUE SPACES.               
                                                                                
       01  HL4-HEADING-LINE-4.                                                  
           05  FILLER                  PIC X(12)    VALUE SPACES.               
           05  FILLER                  PIC X(11)    VALUE                       
               'PO/RECEIVER'.                                                   
           05  FILLER                  PIC X(06)    VALUE SPACES.               
           05  FILLER                  PIC X(04)    VALUE                       
               'DATE'.                                                          
           05  FILLER                  PIC X(08)    VALUE SPACES.               
           05  FILLER                  PIC X(03)    VALUE                       
               'STR'.                                                           
           05  FILLER                  PIC X(01)    VALUE SPACES.               
           05  FILLER                  PIC X(07)    VALUE                       
               'STORE'.                                                         
W21732     05  FILLER                  PIC X(08)    VALUE SPACES.               
           05  FILLER                  PIC X(03)    VALUE                       
               'SKU'.                                                           
W21732     05  FILLER                  PIC X(15)    VALUE SPACES.               
           05  FILLER                  PIC X(15)    VALUE                       
               'BEFORE RECEIPTS'.                                               
W21732     05  FILLER                  PIC X(14)    VALUE SPACES.               
           05  FILLER                  PIC X(14)    VALUE                       
               'AFTER RECEIPTS'.                                                
W21732     05  FILLER                  PIC X(11)    VALUE SPACES.               
                                                                                
       01  HL5-HEADING-LINE-5.                                                  
           05  FILLER                  PIC X(41)    VALUE SPACES.               
           05  FILLER                  PIC X(03)    VALUE                       
               'NBR'.                                                           
           05  FILLER                  PIC X(01)    VALUE SPACES.               
           05  FILLER                  PIC X(08)    VALUE                       
               'DC FLUSH'.                                                      
W21732     05  FILLER                  PIC X(07)    VALUE SPACES.               
           05  FILLER                  PIC X(06)    VALUE                       
               'NUMBER'.                                                        
W21732     05  FILLER                  PIC X(12)    VALUE SPACES.               
           05  FILLER                  PIC X(12)    VALUE                       
               'RETAIL VALUE'.                                                  
W21732     05  FILLER                  PIC X(07)    VALUE SPACES.               
           05  FILLER                  PIC X(05)    VALUE                       
               'UNITS'.                                                         
W21732     05  FILLER                  PIC X(05)    VALUE SPACES.               
           05  FILLER                  PIC X(12)    VALUE                       
               'RETAIL VALUE'.                                                  
W21732     05  FILLER                  PIC X(07)    VALUE SPACES.               
           05  FILLER                  PIC X(05)    VALUE                       
               'UNITS'.                                                         
W21732     05  FILLER                  PIC X(01)    VALUE SPACES.               
                                                                                
       01  HL6-HEADING-LINE-6.                                                  
           05  FILLER                  PIC X(01)    VALUE SPACES.               
           05  FILLER                  PIC X(06)    VALUE                       
               'DEPT: '.                                                        
           05  DL-DEPT                 PIC X(03)    VALUE SPACES.               
           05  FILLER                  PIC X(122)   VALUE SPACES.               
                                                                                
       01  HL7-HEADING-LINE-7.                                                  
           05  FILLER                  PIC X(01)    VALUE SPACES.               
           05  FILLER                  PIC X(07)    VALUE                       
               'CLASS: '.                                                       
           05  DL-MJR-CLASS            PIC X(01)    VALUE SPACES.               
           05  FILLER                  PIC X(01)    VALUE '0'.                  
           05  FILLER                  PIC X(122)   VALUE SPACES.               
W21732*                                                                         
       01  DL-DETAIL-LINE.                                                      
           05  FILLER                  PIC X(09)    VALUE SPACES.               
           05  DL-PO                   PIC X(08)    VALUE ZEROES.               
           05  FILLER                  PIC X(1)     VALUE '-'.                  
           05  DL-REC-SEQ-NBR          PIC X(9)     VALUE ZEROES.               
           05  FILLER                  PIC X(1)     VALUE SPACES.               
           05  DL-DATE-VERIFIED        PIC 99/99/99 VALUE ZEROES.               
W26600     05  FILLER                  PIC X(3)     VALUE SPACES.               
W26600     05  DL-STORE                PIC Z9999    VALUE SPACES.               
           05  FILLER                  PIC X(1)     VALUE SPACES.               
           05  DL-ACTL-DC-CTOFF-MM     PIC X(2)     VALUE ZEROES.               
           05  FILLER                  PIC X(1)     VALUE '/'.                  
           05  DL-ACTL-DC-CTOFF-DD     PIC X(2)     VALUE ZEROES.               
           05  FILLER                  PIC X(1)     VALUE '/'.                  
           05  DL-ACTL-DC-CTOFF-YY     PIC X(2)     VALUE ZEROES.               
W21732     05  FILLER                  PIC X(5)     VALUE SPACES.               
           05  DL-SKU-NUMBER.                                                   
               10  DL-SKU-DEPT         PIC X(3)     VALUE ZEROES.               
W21732         10  FILLER              PIC X(1)     VALUE SPACES.               
               10  DL-SKU-CLASS        PIC X(2)     VALUE ZEROES.               
W21732     05  FILLER                  PIC X(1)     VALUE SPACES.               
W21732     05  DL-SKU-NBR              PIC X(08)                                
W21732                                              VALUE SPACES.               
W21732     05  FILLER                  PIC X(5)     VALUE SPACES.               
           05  DL-BEF-RETAIL           PIC Z,ZZZ,ZZZ.99-                        
                                                    VALUE ZEROES.               
           05  FILLER                  PIC X(4)     VALUE SPACES.               
           05  DL-BEF-UNITS            PIC ZZZ,ZZ9- VALUE ZEROES.               
W21732     05  FILLER                  PIC X(4)     VALUE SPACES.               
           05  DL-AFT-RETAIL           PIC Z,ZZZ,ZZZ.99-                        
                                                    VALUE ZEROES.               
           05  FILLER                  PIC X(4)     VALUE SPACES.               
           05  DL-AFT-UNITS            PIC ZZZ,ZZ9-                             
                                                    VALUE ZEROES.               
       01  DL2-DETAIL2-LINE.                                                    
W26600     05  FILLER                  PIC X(39)    VALUE SPACES.               
W26600     05  DL2-STORE               PIC X(5)     VALUE SPACES.               
           05  FILLER                  PIC X(1)     VALUE SPACES.               
           05  DL2-ACTL-DC-CTOFF-MM    PIC X(2)     VALUE ZEROES.               
           05  FILLER                  PIC X(1)     VALUE '/'.                  
           05  DL2-ACTL-DC-CTOFF-DD    PIC X(2)     VALUE ZEROES.               
           05  FILLER                  PIC X(1)     VALUE '/'.                  
           05  DL2-ACTL-DC-CTOFF-YY    PIC X(2)     VALUE ZEROES.               
W21732     05  FILLER                  PIC X(5)     VALUE SPACES.               
           05  DL2-SKU-NUMBER.                                                  
               10  DL2-SKU-DEPT        PIC X(3)     VALUE ZEROES.               
W21732         10  FILLER              PIC X(1)     VALUE SPACES.               
               10  DL2-SKU-CLASS       PIC X(2)     VALUE ZEROES.               
W21732     05  FILLER                  PIC X(1)     VALUE SPACES.               
W21732     05  DL2-SKU-NBR              PIC X(08)                               
W21732                                              VALUE SPACES.               
W21732     05  FILLER                  PIC X(5)     VALUE SPACES.               
           05  DL2-BEF-RETAIL          PIC Z,ZZZ,ZZZ.99-                        
                                                    VALUE ZEROES.               
           05  FILLER                  PIC X(4)     VALUE SPACES.               
           05  DL2-BEF-UNITS           PIC ZZZ,ZZ9- VALUE ZEROES.               
W21732     05  FILLER                  PIC X(4)     VALUE SPACES.               
           05  DL2-AFT-RETAIL          PIC Z,ZZZ,ZZZ.99-                        
                                                    VALUE ZEROES.               
           05  FILLER                  PIC X(4)     VALUE SPACES.               
           05  DL2-AFT-UNITS           PIC ZZZ,ZZ9-                             
                                                    VALUE ZEROES.               
W21732*                                                                         
       01  DL3-DETAIL3-LINE.                                                    
W21732     05  FILLER                  PIC X(58) VALUE SPACES.                  
           05  DL3-SKU-NUMBER.                                                  
               10  DL3-SKU-DEPT        PIC X(3)     VALUE ZEROES.               
W21732         10  FILLER              PIC X(1)     VALUE SPACES.               
               10  DL3-SKU-CLASS       PIC X(2)     VALUE ZEROES.               
W21732     05  FILLER                  PIC X(1)     VALUE SPACES.               
W21732     05  DL3-SKU-NBR             PIC X(08)                                
W21732                                              VALUE SPACES.               
W21732     05  FILLER                  PIC X(5)     VALUE SPACES.               
           05  DL3-BEF-RETAIL          PIC Z,ZZZ,ZZZ.99-                        
                                                    VALUE ZEROES.               
           05  FILLER                  PIC X(4)     VALUE SPACES.               
           05  DL3-BEF-UNITS           PIC ZZZ,ZZ9- VALUE ZEROES.               
W21732     05  FILLER                  PIC X(4)     VALUE SPACES.               
           05  DL3-AFT-RETAIL          PIC Z,ZZZ,ZZZ.99-                        
                                                    VALUE ZEROES.               
           05  FILLER                  PIC X(4)     VALUE SPACES.               
           05  DL3-AFT-UNITS           PIC ZZZ,ZZ9-                             
                                                    VALUE ZEROES.               
                                                                                
       01  DL4-DETAIL-LINE.                                                     
           05  FILLER                  PIC X(09)    VALUE SPACES.               
           05  DL4-PO                  PIC X(08)    VALUE ZEROES.               
           05  FILLER                  PIC X(1)     VALUE '-'.                  
           05  DL4-REC-SEQ-NBR         PIC X(9)     VALUE ZEROES.               
           05  FILLER                  PIC X(1)     VALUE SPACES.               
           05  DL4-DATE-VERIFIED       PIC 99/99/99 VALUE ZEROES.               
W26600     05  FILLER                  PIC X(3)     VALUE SPACES.               
W26600     05  DL4-STORE               PIC X(5)     VALUE SPACES.               
           05  FILLER                  PIC X(1)     VALUE SPACES.               
           05  DL4-ACTL-DC-CTOFF-MM    PIC X(2)     VALUE ZEROES.               
           05  FILLER                  PIC X(1)     VALUE '/'.                  
           05  DL4-ACTL-DC-CTOFF-DD    PIC X(2)     VALUE ZEROES.               
           05  FILLER                  PIC X(1)     VALUE '/'.                  
           05  DL4-ACTL-DC-CTOFF-YY    PIC X(2)     VALUE ZEROES.               
           05  FILLER                  PIC X(79)    VALUE SPACES.               
                                                                                
       01  TL-STR-TTL-LINE.                                                     
W26600     05  FILLER                  PIC X(39)    VALUE SPACES.               
W26600     05  TL-STR-NBR              PIC X(05)    VALUE SPACES.               
           05  FILLER                  PIC X(01)    VALUE SPACES.               
           05  TL-STR-NAME             PIC X(09)    VALUE                       
               'STORE TTL'.                                                     
W21732     05  FILLER                  PIC X(23)    VALUE SPACES.               
           05  TL-STR-BEF-RETAIL       PIC ZZ,ZZZ,ZZZ.99-                       
                                                    VALUE ZEROES.               
           05  FILLER                  PIC X(2)     VALUE SPACES.               
           05  TL-STR-BEF-UNITS        PIC Z,ZZZ,ZZ9-                           
                                                    VALUE ZEROES.               
W21732     05  FILLER                  PIC X(3)     VALUE SPACES.               
           05  TL-STR-AFT-RETAIL       PIC ZZ,ZZZ,ZZZ.99-                       
                                                    VALUE ZEROES.               
           05  FILLER                  PIC X(2)     VALUE SPACES.               
           05  TL-STR-AFT-UNITS        PIC Z,ZZZ,ZZ9-                           
                                                    VALUE ZEROES.               
                                                                                
       01  TL-DEPT-TTL-LINE.                                                    
           05  FILLER                  PIC X(41)    VALUE SPACES.               
           05  TL-DEPT                 PIC X(03)    VALUE SPACES.               
           05  FILLER                  PIC X(01)    VALUE SPACES.               
           05  TL-DEPT-NAME            PIC X(09)    VALUE                       
               ' DEPT TTL'.                                                     
W21732     05  FILLER                  PIC X(23)    VALUE SPACES.               
           05  TL-DEPT-BEF-RETAIL      PIC ZZ,ZZZ,ZZZ.99-                       
                                                    VALUE ZEROES.               
           05  FILLER                  PIC X(2)     VALUE SPACES.               
           05  TL-DEPT-BEF-UNITS       PIC Z,ZZZ,ZZ9-                           
                                                    VALUE ZEROES.               
W21732     05  FILLER                  PIC X(3)     VALUE SPACES.               
           05  TL-DEPT-AFT-RETAIL      PIC ZZ,ZZZ,ZZZ.99-                       
                                                    VALUE ZEROES.               
           05  FILLER                  PIC X(2)     VALUE SPACES.               
           05  TL-DEPT-AFT-UNITS       PIC Z,ZZZ,ZZ9-                           
                                                    VALUE ZEROES.               
                                                                                
       01  TL-CLASS-TTL-LINE.                                                   
           05  FILLER                  PIC X(42)    VALUE SPACES.               
           05  TL-CLASS                PIC X(01)    VALUE SPACES.               
           05  FILLER                  PIC X(02)    VALUE '0 '.                 
           05  TL-CLASS-NAME           PIC X(09)    VALUE                       
               'CLASS TTL'.                                                     
W21732     05  FILLER                  PIC X(23)    VALUE SPACES.               
           05  TL-CLASS-BEF-RETAIL     PIC ZZ,ZZZ,ZZZ.99-                       
                                                    VALUE ZEROES.               
           05  FILLER                  PIC X(2)     VALUE SPACES.               
           05  TL-CLASS-BEF-UNITS      PIC Z,ZZZ,ZZ9-                           
                                                    VALUE ZEROES.               
W21732     05  FILLER                  PIC X(3)     VALUE SPACES.               
           05  TL-CLASS-AFT-RETAIL     PIC ZZ,ZZZ,ZZZ.99-                       
                                                    VALUE ZEROES.               
           05  FILLER                  PIC X(2)     VALUE SPACES.               
           05  TL-CLASS-AFT-UNITS      PIC Z,ZZZ,ZZ9-                           
                                                    VALUE ZEROES.               
W21732*                                                                         
       01  TL-GRAND-TTL-LINE.                                                   
           05  FILLER                  PIC X(45)    VALUE SPACES.               
           05  TL-GRD-NAME             PIC X(09)    VALUE                       
               'GRAND TTL'.                                                     
W21732     05  FILLER                  PIC X(22)    VALUE SPACES.               
           05  TL-GRD-BEF-RETAIL       PIC ZZZ,ZZZ,ZZZ.99-                      
                                                    VALUE ZEROES.               
           05  FILLER                  PIC X(1)     VALUE SPACES.               
           05  TL-GRD-BEF-UNITS        PIC ZZ,ZZZ,ZZ9-                          
                                                    VALUE ZEROES.               
W21732     05  FILLER                  PIC X(2)     VALUE SPACES.               
           05  TL-GRD-AFT-RETAIL       PIC ZZZ,ZZZ,ZZZ.99-                      
                                                    VALUE ZEROES.               
           05  FILLER                  PIC X(1)     VALUE SPACES.               
           05  TL-GRD-AFT-UNITS        PIC ZZ,ZZZ,ZZ9-                          
                                                    VALUE ZEROES.               
                                                                                
       01  TL-PROC-WK-GRD-TTL-LINE.                                             
           05  FILLER                  PIC X(19)    VALUE SPACES.               
           05  FILLER                  PIC X(28)    VALUE                       
               'TOTAL RECEIPTS PROCESSED WK '.                                  
           05  TL-PROC-WK-GRD-DATE         PIC 99/99/99 VALUE ZEROES.           
           05  FILLER                  PIC X(10)    VALUE SPACES.               
           05  TL-PROC-WK-GRD-RETAIL      PIC ZZZ,ZZZ,ZZZ.99-                   
                                                    VALUE ZEROES.               
           05  FILLER                  PIC X(1)     VALUE SPACES.               
           05  TL-PROC-WK-GRD-UNITS       PIC ZZ,ZZZ,ZZ9-                       
                                                    VALUE ZEROES.               
           05  FILLER                  PIC X(40)    VALUE SPACES.               
                                                                                
W29908 01  NL-NO-REPORT-LINE.                                                   
W29908     05  FILLER                  PIC X(02) VALUE SPACES.                  
W29908     05  FILLER                  PIC X(26)                                
W29908         VALUE 'NOTHING TO REPORT'.                                       
W29908                                                                          
      ******************************************************************        
      *  DB2 ERROR MESSAGES FORMAT AREA.                                        
      ******************************************************************        
           COPY DPWS004.                                                        
     *                                                                          
     *******************************************************************        
     **  USED FOR DB2 ERRORS                                                    
     *******************************************************************        
           EXEC SQL                                                             
               INCLUDE SQLCA                                                    
           END-EXEC.                                                            
                                                                                
     *******************************************************************        
     **  LAYOUT USED FOR INVENTORY PARMS TABLE                                  
     *******************************************************************        
           EXEC SQL                                                             
               INCLUDE TINVPAR                                                  
           END-EXEC.                                                            
                                                                                
W28545******************************************************************        
W28545*  LAYOUT USED FOR INVENTORY CYCLE CONTROL TABLE                          
W28545******************************************************************        
W28545     EXEC SQL                                                             
W28545         INCLUDE TINCNTL                                                  
W28545     END-EXEC.                                                            
W28545                                                                          
W30272******************************************************************        
W30272*  LAYOUT - TDTATTR DB2 TABLE                                             
W30272******************************************************************        
W30272     EXEC SQL                                                             
W30272         INCLUDE TDTATTR                                                  
W30272     END-EXEC.                                                            
W30272                                                                          
     *******************************************************************        
     **  LAYOUT USED FOR STORE TABLE                                            
     *******************************************************************        
           EXEC SQL                                                             
W26600         INCLUDE XMT00001                                                 
           END-EXEC.                                                            
                                                                                
     *******************************************************************        
     **  SQL DB2 TINVPAR CURSOR DECLARATION                                     
     *******************************************************************        
           EXEC SQL                                                             
               DECLARE TINVPAR_CSR CURSOR FOR                                   
W26600             SELECT LOC_NBR                                               
                         ,PLND_INV_DTE                                          
                         ,ACTL_DC_CTOFF_DTE                                     
RB0201                   ,MFSTNG_IND                                            
W30272             FROM TINVPAR A,                                              
W28545                  TINCNTL C,                                              
W30272                  TDTATTR D                                               
                   WHERE ACTL_FIN_BK_DTE   = :PC-DEFAULT-DTE                    
W33304               AND A.LOC_INV_STAT_CDE = 'IN'                              
W33304               AND SCHD_PHY_CNT_CDE <> 'EI'                               
W30272               AND C.OPN_FSCL_MN_DTE = D.KY_DTE                           
W28545               AND C.ACTV_IND        = 'Y'                                
W28545               AND A.INV_ID          = C.INV_ID                           
W34557               AND ((DATE(ACTL_LDG_CTOF_TMST)                             
W34557                  BETWEEN D.FSCL_MN_BEG_DTE AND C.OPN_FSCL_MN_DTE)        
W34557                 OR (DATE(ACTL_LDG_CTOF_TMST) = PFM_END_DTE               
W34557                  AND PLND_INV_DTE BETWEEN D.FSCL_MN_BEG_DTE AND          
                                                 C.OPN_FSCL_MN_DTE))            
W26600             ORDER BY LOC_NBR                                             
                           ,PLND_INV_DTE                                        
W26600             WITH UR                                                      
           END-EXEC.                                                            
                                                                                
     *******************************************************************        
     **  SQL DB2 XMT00001 CURSOR DECLARATION                                    
     *******************************************************************        
           EXEC SQL                                                             
W26600         DECLARE XMTLOC_CSR CURSOR FOR                                    
W26600             SELECT LOC_NBR                                               
W26600                   ,LOC_TYP_CDE                                           
W26600             FROM XMT_LOC                                                 
W26600             WHERE LOC_TYP_CDE IN ('DS', 'DC', 'RV', 'CS', 'DA')          
W26600             WITH UR                                                      
           END-EXEC.                                                            
                                                                                
      /*****************************************************************        
       PROCEDURE DIVISION.                                                      
      ******************************************************************        
       0000-MAINLINE.                                                           
                                                                                
           PERFORM 1000-INITIALIZE.                                             
                                                                                
           PERFORM 2000-PROCESS-EXTRACT THRU 2000-EXIT                          
               UNTIL PS-END-OF-EXTRACT-FILE.                                    
                                                                                
           PERFORM 9000-EOJ-ROUTINE.                                            
                                                                                
           STOP RUN.                                                            
                                                                                
      ******************************************************************        
      *  OPEN FILES, FILL STANDARD REPORT HEADER FIELDS, READ THE REPORT        
      *  CONTROL FILE RECORD, READ THE ONHAND LIMIT CONTROL FILE, AND           
      *  READ THE FIRST IN STORE EXTRACT RECORD.                                
      ******************************************************************        
                                                                                
       1000-INITIALIZE.                                                         
                                                                                
           OPEN INPUT  STORE-EXTRACT-FILE                                       
                INPUT  SKIP-CLASS-CARD                                          
                OUTPUT VERIFIED-RECEIPTS-RPT.                                   
                                                                                
           INITIALIZE PV-PAGE-COUNT.                                            
           SET PS-NOT-END-OF-EXTRACT-FILE TO TRUE.                              
                                                                                
           ACCEPT CD-CURRENT-DATE FROM DATE.                                    
           MOVE CD-CURRENT-YEAR TO DP132O-RUN-YEAR.                             
           MOVE CD-CURRENT-MONTH TO DP132O-RUN-MONTH.                           
           MOVE CD-CURRENT-DAY TO DP132O-RUN-DAY.                               
           ACCEPT CT-CURRENT-TIME FROM TIME.                                    
           MOVE CT-CURRENT-HOUR TO DP132O-RUN-HOUR.                             
           MOVE CT-CURRENT-MINUTE TO DP132O-RUN-MINUTE.                         
           MOVE 'INKRP139' TO DP132O-PROGRAM-NAME.                              
           MOVE 1 TO DP132O-REPORT-NUMBER.                                      
           MOVE PC-PAGE-SIZE TO PV-LINE-COUNT.                                  
           MOVE ZERO TO PV-PAGE-COUNT.                                          
                                                                                
           PERFORM 5000-GET-CURRENT-CCYY.                                       
           INITIALIZE WS-STORE-TABLE.                                           
W26600     PERFORM 6300-PROCESS-XMT00001-CSR.                                   
                                                                                
           PERFORM 6000-PROCESS-TINVPAR-CSR.                                    
                                                                                
           INITIALIZE SKIP-CLASS-TABLE.                                         
           PERFORM 6900-PROCESS-SKIP-CLASS-CARD.                                
                                                                                
                                                                                
           PERFORM 5100-GET-1ST-WKDY.                                           
                                                                                
           PERFORM 7100-READ-EXTRACT-FILE                                       
RB0700       UNTIL                                                              
RB0700         PS-FOUND-INVENTORY-STORE                                         
RB0700         OR PS-END-OF-EXTRACT-FILE.                                       
                                                                                
RB0700     SET PS-NOT-FOUND-INVENTORY-STORE TO TRUE.                            
W29908*    IF PS-END-OF-EXTRACT-FILE                                            
W29908*        DISPLAY '** ABEND ** IN INKRP139'                                
W29908*        DISPLAY '** PARAGRAPH: 1000-INITIALIZE'                          
W29908*        DISPLAY 'WEEKLY STORE EXTRACT FILE IS EMPTY'                     
W29908*        DISPLAY '        ** OR **                  '                     
W29908*        DISPLAY 'NO STORES SETUP ON TINVPAR TO DO INVENTORY'             
W29908*        MOVE +4013 TO ABEND-CODE                                         
W29908*        CALL 'ILBOABN0' USING ABEND-CODE.                                
                                                                                
           MOVE SE-DEPT         TO PV-PREV-DEPT.                                
           MOVE SE-CLASS        TO PV-PREV-CLASS.                               
           MOVE SE-CLASS        TO PV-SE-CLASS.                                 
W26600     MOVE SE-LOC-NBR      TO PV-PREV-STORE.                               
           MOVE SE-PO           TO PV-PREV-PO.                                  
W21732     MOVE SE-SKU-NBR      TO PV-PREV-SKU-NBR.                             
           MOVE SE-REC-SEQ-NBR  TO PV-PREV-REC-SEQ-NBR.                         
           MOVE SE-DATE-VERIFIED-COUNT TO PV-PREV-DATE-VERIFIED.                
                                                                                
           SET PS-FIRST-LINE TO TRUE.                                           
           PERFORM 8100-PRINT-TITLE-LINES THRU 8100-EXIT.                       
                                                                                
           SET PS-FIRST-SKU-FOR-PO TO TRUE.                                     
           SET PS-FIRST-SKU-FOR-STR TO TRUE.                                    
           SET PS-NOT-FIRST-LINE TO TRUE.                                       
                                                                                
       2000-PROCESS-EXTRACT.                                                    
                                                                                
           MOVE SE-CLASS TO PV-SE-CLASS.                                        
                                                                                
           EVALUATE TRUE                                                        
              WHEN (PV-PREV-DEPT NOT EQUAL SE-DEPT)                             
                  PERFORM 3000-WRITE-SKU                                        
                  PERFORM 3010-WRITE-STORE-TTL                                  
                  PERFORM 3020-WRITE-CLASS-TTL                                  
                  PERFORM 3030-WRITE-DEPT-TTL                                   
                  SET PS-FIRST-SKU-FOR-PO TO TRUE                               
                  SET PS-FIRST-SKU-FOR-STR TO TRUE                              
              WHEN PV-PREV-MJR-CLASS NOT EQUAL PV-SE-MJR-CLASS                  
                  PERFORM 3000-WRITE-SKU                                        
                  PERFORM 3010-WRITE-STORE-TTL                                  
                  PERFORM 3020-WRITE-CLASS-TTL                                  
                  SET PS-FIRST-SKU-FOR-PO TO TRUE                               
                  SET PS-FIRST-SKU-FOR-STR TO TRUE                              
              WHEN (PV-PREV-PO NOT EQUAL SE-PO)                                 
                  OR PV-PREV-REC-SEQ-NBR NOT EQUAL SE-REC-SEQ-NBR               
                  PERFORM 3000-WRITE-SKU                                        
                  PERFORM 3010-WRITE-STORE-TTL                                  
                  SET PS-FIRST-SKU-FOR-PO TO TRUE                               
W26600        WHEN PV-PREV-STORE NOT EQUAL SE-LOC-NBR                           
                  PERFORM 3000-WRITE-SKU                                        
                  PERFORM 3010-WRITE-STORE-TTL                                  
                  SET PS-FIRST-SKU-FOR-STR TO TRUE                              
W21732        WHEN PV-PREV-SKU-NBR NOT EQUAL SE-SKU-NBR                         
                  PERFORM 3000-WRITE-SKU                                        
           END-EVALUATE.                                                        
                                                                                
      ******************************************************************        
      * ANYTHING VERIFIED ON OR BEFORE THE STORE'S DC CUTOFF DATE               
      * IS CONSIDERED A 'BEFORE' INVENTORY AND ANYTHING VERIFIED                
      * AFTER THE STORE'S DC CUTOFF DATE IS CONSIDERED AN 'AFTER'               
      *                                                                         
      * CERTAIN DEPARTMENT/CLASSES ARE NOT PROCESSED IN M/L LEDGER,             
      * THESE DEPARTMENTS/CLASSES IDENTIFIED IN THE CONTROL CARD                
      * INPUT WILL NOT BE INCLUDED IN THE REPORT                                
      ******************************************************************        
           MOVE SE-DEPT     TO PV-SE-DC-DEPT.                                   
           MOVE SE-DEPT     TO PV-SE-DC-DEPT-MC.                                
           MOVE PV-SE-CLASS TO PV-SE-DC-CLASS.                                  
           MOVE PV-SE-MJR-CLASS TO PV-SE-DC-CLASS-MC.                           
                                                                                
           PERFORM VARYING SKIP-IDX FROM 1 BY 1                                 
                   UNTIL SKIP-CLASS(SKIP-IDX) = PV-SE-DEPT-MJR-CLASS            
                     OR  SKIP-CLASS(SKIP-IDX) = SPACES                          
                     OR  SKIP-IDX > PV-MAX-SKIP-RECS                            
           END-PERFORM.                                                         
                                                                                
           IF SKIP-CLASS(SKIP-IDX) = PV-SE-DEPT-MJR-CLASS                       
               GO TO 2000-CONTINUE.                                             
                                                                                
      ***> CHECKS FOR 'DIRECT STORE SHIPS'                                      
JS0199     IF SE-RECEIVING-LOCATION = 'DS'                                      
JS0199         MOVE SE-DR-MM           TO CD-CCYYMMDD-HOLD-MM                   
JS0199         MOVE SE-DR-DD           TO CD-CCYYMMDD-HOLD-DD                   
JS0199         MOVE SE-DR-YY           TO CD-CCYYMMDD-HOLD-YY                   
JS0199     ELSE                                                                 
JS0199         MOVE SE-DV-MM           TO CD-CCYYMMDD-HOLD-MM                   
JS0199         MOVE SE-DV-DD           TO CD-CCYYMMDD-HOLD-DD                   
JS0199         MOVE SE-DV-YY           TO CD-CCYYMMDD-HOLD-YY                   
JS0199     END-IF.                                                              
                                                                                
           IF CD-CCYYMMDD-HOLD-YY > 80                                          
Y2K98          MOVE 19 TO CD-CCYYMMDD-HOLD-CC                                   
           ELSE                                                                 
Y2K98          MOVE 20 TO CD-CCYYMMDD-HOLD-CC.                                  
                                                                                
W26600     MOVE SE-LOC-NBR TO PC-SUB.                                           
                                                                                
           IF CD-CCYYMMDD-HOLD > TBL-STORE-DC-DATE(PC-SUB)                      
0198JS         ADD SE-RETAIL-EXTENSION TO PV-SKU-AFT-RETAIL                     
0198JS         ADD SE-RETAIL-UNITS-MARK TO PV-SKU-AFT-UNITS                     
0198JS     ELSE                                                                 
0198JS         ADD SE-RETAIL-EXTENSION TO PV-SKU-BEF-RETAIL                     
0198JS         ADD SE-RETAIL-UNITS-MARK TO PV-SKU-BEF-UNITS                     
           END-IF.                                                              
                                                                                
       2000-CONTINUE.                                                           
W26600     MOVE SE-LOC-NBR      TO PV-PREV-STORE.                               
           MOVE SE-CLASS        TO PV-PREV-CLASS.                               
           MOVE SE-DEPT         TO PV-PREV-DEPT.                                
           MOVE SE-PO           TO PV-PREV-PO.                                  
W21732     MOVE SE-SKU-NBR      TO PV-PREV-SKU-NBR.                             
           MOVE SE-REC-SEQ-NBR  TO PV-PREV-REC-SEQ-NBR.                         
           MOVE SE-DATE-VERIFIED-COUNT TO PV-PREV-DATE-VERIFIED.                
                                                                                
           PERFORM 7100-READ-EXTRACT-FILE                                       
RB0700       UNTIL                                                              
RB0700         PS-FOUND-INVENTORY-STORE                                         
RB0700         OR PS-END-OF-EXTRACT-FILE.                                       
                                                                                
RB0700     SET PS-NOT-FOUND-INVENTORY-STORE TO TRUE.                            
                                                                                
           IF PS-END-OF-EXTRACT-FILE                                            
               PERFORM 3040-TOTAL-LINE                                          
           END-IF.                                                              
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
      *  WRITE THE LINES FOR PREVIOUS SKU                                       
      ******************************************************************        
                                                                                
       3000-WRITE-SKU.                                                          
                                                                                
           INITIALIZE DL-DETAIL-LINE.                                           
                                                                                
           IF PV-LINE-COUNT > PC-PAGE-SIZE                                      
               PERFORM 8100-PRINT-TITLE-LINES THRU 8100-EXIT                    
           END-IF.                                                              
                                                                                
           IF PS-FIRST-SKU-FOR-PO AND (PV-LINE-COUNT > 10)                      
               MOVE PV-PREV-PO        TO DL-PO                                  
               MOVE PV-PREV-REC-SEQ-NBR TO DL-REC-SEQ-NBR                       
               MOVE PV-PREV-DATE-VERIFIED TO DL-DATE-VERIFIED                   
               MOVE PV-PREV-STORE     TO DL-STORE                               
               MOVE PV-PREV-STORE     TO PC-SUB                                 
               MOVE TBL-DC-DATE-MM(PC-SUB) TO DL-ACTL-DC-CTOFF-MM               
               MOVE TBL-DC-DATE-DD(PC-SUB) TO DL-ACTL-DC-CTOFF-DD               
               MOVE TBL-DC-DATE-YY(PC-SUB) TO DL-ACTL-DC-CTOFF-YY               
               MOVE PV-PREV-DEPT      TO DL-SKU-DEPT                            
W21732         MOVE PV-PREV-SKU-NBR   TO DL-SKU-NBR                             
               MOVE PV-PREV-MJR-CLASS TO PV-2-DIGIT-MJR-CLASS                   
               MOVE PV-PREV-SUB-CLASS TO PV-2-DIGIT-SUB-CLASS                   
               MOVE PV-2-DIGIT-CLASS TO DL-SKU-CLASS                            
               MOVE PV-SKU-BEF-RETAIL TO DL-BEF-RETAIL                          
               MOVE PV-SKU-BEF-UNITS  TO DL-BEF-UNITS                           
               MOVE PV-SKU-AFT-RETAIL TO DL-AFT-RETAIL                          
               MOVE PV-SKU-AFT-UNITS  TO DL-AFT-UNITS                           
               WRITE VERIFIED-RECEIPTS-LINE                                     
                   FROM DL-DETAIL-LINE                                          
                   AFTER ADVANCING 2 LINES                                      
               ADD +2 TO PV-LINE-COUNT                                          
               SET PS-NOT-FIRST-SKU-FOR-PO TO TRUE                              
               SET PS-NOT-FIRST-SKU-FOR-STR TO TRUE                             
           ELSE                                                                 
               IF PS-FIRST-SKU-FOR-STR AND (PV-LINE-COUNT > 10)                 
                   MOVE PV-PREV-STORE     TO DL2-STORE                          
                   MOVE PV-PREV-STORE     TO PC-SUB                             
                   MOVE TBL-DC-DATE-MM(PC-SUB) TO DL2-ACTL-DC-CTOFF-MM          
                   MOVE TBL-DC-DATE-DD(PC-SUB) TO DL2-ACTL-DC-CTOFF-DD          
                   MOVE TBL-DC-DATE-YY(PC-SUB) TO DL2-ACTL-DC-CTOFF-YY          
                   MOVE PV-PREV-DEPT      TO DL2-SKU-DEPT                       
W21732             MOVE PV-PREV-SKU-NBR   TO DL2-SKU-NBR                        
                   MOVE PV-PREV-MJR-CLASS TO PV-2-DIGIT-MJR-CLASS               
                   MOVE PV-PREV-SUB-CLASS TO PV-2-DIGIT-SUB-CLASS               
                   MOVE PV-2-DIGIT-CLASS  TO DL2-SKU-CLASS                      
                   MOVE PV-SKU-BEF-RETAIL TO DL2-BEF-RETAIL                     
                   MOVE PV-SKU-BEF-UNITS  TO DL2-BEF-UNITS                      
                   MOVE PV-SKU-AFT-RETAIL TO DL2-AFT-RETAIL                     
                   MOVE PV-SKU-AFT-UNITS  TO DL2-AFT-UNITS                      
                   WRITE VERIFIED-RECEIPTS-LINE                                 
                       FROM DL2-DETAIL2-LINE                                    
                       AFTER ADVANCING 2 LINES                                  
                   ADD +2 TO PV-LINE-COUNT                                      
                   SET PS-NOT-FIRST-SKU-FOR-STR TO TRUE                         
               ELSE                                                             
                   MOVE PV-PREV-DEPT      TO DL3-SKU-DEPT                       
W21732             MOVE PV-PREV-SKU-NBR   TO DL3-SKU-NBR                        
                   MOVE PV-PREV-MJR-CLASS TO PV-2-DIGIT-MJR-CLASS               
                   MOVE PV-PREV-SUB-CLASS TO PV-2-DIGIT-SUB-CLASS               
                   MOVE PV-2-DIGIT-CLASS  TO DL3-SKU-CLASS                      
                   MOVE PV-SKU-BEF-RETAIL TO DL3-BEF-RETAIL                     
                   MOVE PV-SKU-BEF-UNITS  TO DL3-BEF-UNITS                      
                   MOVE PV-SKU-AFT-RETAIL TO DL3-AFT-RETAIL                     
                   MOVE PV-SKU-AFT-UNITS  TO DL3-AFT-UNITS                      
                   WRITE VERIFIED-RECEIPTS-LINE                                 
                       FROM DL3-DETAIL3-LINE                                    
                       AFTER ADVANCING 1 LINES                                  
                   ADD +1 TO PV-LINE-COUNT                                      
                   SET PS-NOT-FIRST-SKU-FOR-PO TO TRUE                          
                   SET PS-NOT-FIRST-SKU-FOR-STR TO TRUE                         
               END-IF.                                                          
                                                                                
           ADD PV-SKU-BEF-RETAIL      TO PV-STR-BEF-RETAIL.                     
           ADD PV-SKU-BEF-UNITS       TO PV-STR-BEF-UNITS.                      
           ADD PV-SKU-AFT-RETAIL      TO PV-STR-AFT-RETAIL.                     
           ADD PV-SKU-AFT-UNITS       TO PV-STR-AFT-UNITS.                      
                                                                                
           ADD PV-SKU-BEF-RETAIL      TO PV-CLASS-BEF-RETAIL.                   
           ADD PV-SKU-BEF-UNITS       TO PV-CLASS-BEF-UNITS.                    
           ADD PV-SKU-AFT-RETAIL      TO PV-CLASS-AFT-RETAIL.                   
           ADD PV-SKU-AFT-UNITS       TO PV-CLASS-AFT-UNITS.                    
                                                                                
           ADD PV-SKU-BEF-RETAIL      TO PV-DEPT-BEF-RETAIL.                    
           ADD PV-SKU-BEF-UNITS       TO PV-DEPT-BEF-UNITS.                     
           ADD PV-SKU-AFT-RETAIL      TO PV-DEPT-AFT-RETAIL.                    
           ADD PV-SKU-AFT-UNITS       TO PV-DEPT-AFT-UNITS.                     
                                                                                
           ADD PV-SKU-BEF-RETAIL      TO PV-GRD-BEF-RETAIL.                     
           ADD PV-SKU-BEF-UNITS       TO PV-GRD-BEF-UNITS.                      
                                                                                
           ADD PV-SKU-AFT-RETAIL      TO PV-GRD-AFT-RETAIL.                     
           ADD PV-SKU-AFT-UNITS       TO PV-GRD-AFT-UNITS.                      
                                                                                
           MOVE ZERO TO PV-SKU-BEF-RETAIL.                                      
           MOVE ZERO TO PV-SKU-BEF-UNITS.                                       
           MOVE ZERO TO PV-SKU-AFT-RETAIL.                                      
           MOVE ZERO TO PV-SKU-AFT-UNITS.                                       
                                                                                
                                                                                
       3010-WRITE-STORE-TTL.                                                    
                                                                                
           INITIALIZE DL-DETAIL-LINE.                                           
           IF PV-LINE-COUNT > PC-PAGE-SIZE                                      
               PERFORM 8100-PRINT-TITLE-LINES THRU 8100-EXIT                    
           END-IF.                                                              
                                                                                
           MOVE PV-PREV-STORE     TO TL-STR-NBR.                                
           MOVE PV-STR-BEF-RETAIL TO TL-STR-BEF-RETAIL.                         
           MOVE PV-STR-BEF-UNITS  TO TL-STR-BEF-UNITS.                          
           MOVE PV-STR-AFT-RETAIL TO TL-STR-AFT-RETAIL.                         
           MOVE PV-STR-AFT-UNITS  TO TL-STR-AFT-UNITS.                          
                                                                                
           WRITE VERIFIED-RECEIPTS-LINE                                         
               FROM TL-STR-TTL-LINE                                             
               AFTER ADVANCING 1 LINES.                                         
           ADD +1 TO PV-LINE-COUNT.                                             
                                                                                
           IF PV-LINE-COUNT > (PC-PAGE-SIZE - 3)                                
               SET PS-STORE-TTL-WRITTEN TO TRUE.                                
                                                                                
           MOVE ZERO TO PV-STR-BEF-RETAIL.                                      
           MOVE ZERO TO PV-STR-BEF-UNITS.                                       
           MOVE ZERO TO PV-STR-AFT-RETAIL.                                      
           MOVE ZERO TO PV-STR-AFT-UNITS.                                       
                                                                                
       3020-WRITE-CLASS-TTL.                                                    
                                                                                
           INITIALIZE DL-DETAIL-LINE.                                           
           IF PV-LINE-COUNT > PC-PAGE-SIZE                                      
               PERFORM 8100-PRINT-TITLE-LINES THRU 8100-EXIT                    
           END-IF.                                                              
                                                                                
           MOVE PV-PREV-MJR-CLASS TO TL-CLASS.                                  
           MOVE PV-CLASS-BEF-RETAIL TO TL-CLASS-BEF-RETAIL.                     
           MOVE PV-CLASS-BEF-UNITS  TO TL-CLASS-BEF-UNITS.                      
           MOVE PV-CLASS-AFT-RETAIL TO TL-CLASS-AFT-RETAIL.                     
           MOVE PV-CLASS-AFT-UNITS  TO TL-CLASS-AFT-UNITS.                      
                                                                                
           WRITE VERIFIED-RECEIPTS-LINE                                         
               FROM TL-CLASS-TTL-LINE                                           
               AFTER ADVANCING 1 LINES.                                         
           ADD +1 TO PV-LINE-COUNT.                                             
                                                                                
           IF PV-LINE-COUNT > (PC-PAGE-SIZE - 3)                                
               SET PS-CLASS-TTL-WRITTEN TO TRUE.                                
                                                                                
           IF PV-LINE-COUNT > PC-PAGE-SIZE                                      
               PERFORM 8100-PRINT-TITLE-LINES THRU 8100-EXIT                    
               END-IF.                                                          
                                                                                
           SET PS-CLASS-TTL-NOT-WRITTEN TO TRUE.                                
                                                                                
           IF PS-NOT-END-OF-EXTRACT-FILE                                        
               IF PV-PREV-DEPT EQUAL SE-DEPT                                    
                   MOVE SE-CLASS TO PV-SE-CLASS                                 
                   MOVE PV-SE-MJR-CLASS TO DL-MJR-CLASS                         
                   WRITE VERIFIED-RECEIPTS-LINE                                 
                       FROM HL7-HEADING-LINE-7                                  
                       AFTER ADVANCING 1 LINES                                  
                   ADD +1 TO PV-LINE-COUNT                                      
               END-IF                                                           
           END-IF.                                                              
                                                                                
           MOVE ZERO TO PV-CLASS-BEF-RETAIL.                                    
           MOVE ZERO TO PV-CLASS-BEF-UNITS.                                     
           MOVE ZERO TO PV-CLASS-AFT-RETAIL.                                    
           MOVE ZERO TO PV-CLASS-AFT-UNITS.                                     
                                                                                
       3030-WRITE-DEPT-TTL.                                                     
                                                                                
           INITIALIZE DL-DETAIL-LINE                                            
           IF PV-LINE-COUNT > PC-PAGE-SIZE                                      
               PERFORM 8100-PRINT-TITLE-LINES THRU 8100-EXIT                    
           END-IF.                                                              
                                                                                
           MOVE PV-PREV-DEPT       TO TL-DEPT.                                  
           MOVE PV-DEPT-BEF-RETAIL TO TL-DEPT-BEF-RETAIL.                       
           MOVE PV-DEPT-BEF-UNITS  TO TL-DEPT-BEF-UNITS.                        
           MOVE PV-DEPT-AFT-RETAIL TO TL-DEPT-AFT-RETAIL.                       
           MOVE PV-DEPT-AFT-UNITS  TO TL-DEPT-AFT-UNITS.                        
                                                                                
           WRITE VERIFIED-RECEIPTS-LINE                                         
               FROM TL-DEPT-TTL-LINE                                            
               AFTER ADVANCING 1 LINES.                                         
           ADD +1 TO PV-LINE-COUNT.                                             
                                                                                
                                                                                
           IF PS-NOT-END-OF-EXTRACT-FILE                                        
               PERFORM 8100-PRINT-TITLE-LINES THRU 8100-EXIT                    
               MOVE SE-DEPT TO DL-DEPT                                          
               WRITE VERIFIED-RECEIPTS-LINE                                     
                   FROM HL6-HEADING-LINE-6                                      
                   AFTER ADVANCING 1 LINES                                      
               ADD +1 TO PV-LINE-COUNT                                          
               MOVE SE-CLASS TO PV-SE-CLASS                                     
               MOVE PV-SE-MJR-CLASS TO DL-MJR-CLASS                             
               WRITE VERIFIED-RECEIPTS-LINE                                     
                   FROM HL7-HEADING-LINE-7                                      
                   AFTER ADVANCING 1 LINES                                      
               ADD +1 TO PV-LINE-COUNT.                                         
                                                                                
           MOVE ZERO TO PV-DEPT-BEF-RETAIL.                                     
           MOVE ZERO TO PV-DEPT-BEF-UNITS.                                      
           MOVE ZERO TO PV-DEPT-AFT-RETAIL.                                     
           MOVE ZERO TO PV-DEPT-AFT-UNITS.                                      
                                                                                
       3040-TOTAL-LINE.                                                         
                                                                                
           PERFORM 3000-WRITE-SKU.                                              
           PERFORM 3010-WRITE-STORE-TTL.                                        
           PERFORM 3020-WRITE-CLASS-TTL.                                        
           PERFORM 3030-WRITE-DEPT-TTL.                                         
                                                                                
           SET PS-LAST-PAGE TO TRUE.                                            
           PERFORM 8100-PRINT-TITLE-LINES THRU 8100-EXIT                        
                                                                                
           MOVE PV-GRD-BEF-RETAIL      TO TL-GRD-BEF-RETAIL.                    
           MOVE PV-GRD-BEF-UNITS       TO TL-GRD-BEF-UNITS.                     
           MOVE PV-GRD-AFT-RETAIL      TO TL-GRD-AFT-RETAIL.                    
           MOVE PV-GRD-AFT-UNITS       TO TL-GRD-AFT-UNITS.                     
                                                                                
           WRITE VERIFIED-RECEIPTS-LINE                                         
               FROM TL-GRAND-TTL-LINE                                           
               AFTER ADVANCING 2 LINES.                                         
                                                                                
0198JS     DISPLAY 'CURR WK BEF RETAIL ' TL-GRD-BEF-RETAIL                      
0198JS             ' CURR WK BEF UNITS '  TL-GRD-BEF-UNITS.                     
0198JS     DISPLAY 'CURR WK AFT RETAIL ' TL-GRD-AFT-RETAIL                      
0198JS             ' CURR WK AFT UNITS '  TL-GRD-AFT-UNITS.                     
                                                                                
0198JS     COMPUTE PV-PROC-WK-GRD-RETAIL = PV-GRD-BEF-RETAIL +                  
0198JS         PV-GRD-AFT-RETAIL.                                               
0198JS     COMPUTE PV-PROC-WK-GRD-UNITS = PV-GRD-BEF-UNITS +                    
0198JS         PV-GRD-AFT-UNITS.                                                
                                                                                
           MOVE PV-PROC-WK-GRD-RETAIL TO TL-PROC-WK-GRD-RETAIL.                 
           MOVE PV-PROC-WK-GRD-UNITS  TO TL-PROC-WK-GRD-UNITS.                  
                                                                                
0198JS     DISPLAY 'GRAND TOTAL RETAIL ' TL-PROC-WK-GRD-RETAIL                  
0198JS             ' GRAND TOTAL UNITS '  TL-PROC-WK-GRD-UNITS.                 
                                                                                
           WRITE VERIFIED-RECEIPTS-LINE                                         
               FROM TL-PROC-WK-GRD-TTL-LINE                                     
               AFTER ADVANCING 2 LINES.                                         
                                                                                
       5000-GET-CURRENT-CCYY.                                                   
                                                                                
           SET DPG51-FISCAL-JAN-DEC-F2                                          
               DPG51-DO-NOT-INCR-DECR-DATE                                      
               DPG52-LK-DTE-GREG           TO TRUE.                             
                                                                                
           MOVE CD-CURRENT-MONTH TO DPG52-GREG-DATE-MO.                         
           MOVE CD-CURRENT-DAY   TO DPG52-GREG-DATE-DY.                         
           MOVE CD-CURRENT-YEAR  TO DPG52-GREG-DATE-YR.                         
                                                                                
           CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52                  
                                                   DPG53 DPG54                  
                                                   DPG55 DPG56.                 
                                                                                
           IF DPG54-DATE-INVALID                                                
               DISPLAY '** ABEND ** IN INKRP139'                                
               DISPLAY '** PARAGRAPH: 5000-GET-CURRENT-CCYY.'                   
               DISPLAY '** INVALID DATE                         '               
               DISPLAY '** CALENDAR ROUTINE ERROR MESSAGE = '                   
                           DPG54-ERROR-MESSAGE                                  
               DISPLAY '** DPG51 = ' DPG51                                      
               DISPLAY '** DPG52 = ' DPG52                                      
               DISPLAY '** DPG53 = ' DPG53                                      
               DISPLAY '** DPG54 = ' DPG54                                      
               DISPLAY '** DPG55 = ' DPG55                                      
               DISPLAY '** DPG56 = ' DPG56                                      
               MOVE +4003 TO ABEND-CODE                                         
               CALL 'ILBOABN0' USING ABEND-CODE                                 
           ELSE                                                                 
                IF DPG54-SEVERE-ERROR                                           
                    DISPLAY '** ABEND ** IN INKRP139'                           
                    DISPLAY '** INVALID RETURN FROM CALENDAR ROUTINE.'          
                    DISPLAY '** CALLED BY 5000-GET-CURRENT-CCYY.'               
                    DISPLAY '** ERROR MESSAGE = ' DPG54-ERROR-MESSAGE           
                    DISPLAY '** DPG51 = ' DPG51                                 
                    DISPLAY '** DPG52 = ' DPG52                                 
                    DISPLAY '** DPG53 = ' DPG53                                 
                    DISPLAY '** DPG54 = ' DPG54                                 
                    DISPLAY '** DPG55 = ' DPG55                                 
                    DISPLAY '** DPG56 = ' DPG56                                 
                    MOVE +4003 TO ABEND-CODE                                    
                    CALL 'ILBOABN0' USING ABEND-CODE                            
               ELSE                                                             
                   IF DPG54-WARNING-ERROR                                       
                       DISPLAY                                                  
                             '** WARNING RETURNED BY CALENDAR ROUTINE.'         
                       DISPLAY                                                  
                             '** CALLED BY 5000-GET-CURRENT-CCYY.'              
                       DISPLAY                                                  
                             '** WARNING MESSAGE = ' DPG54-ERROR-MESSAGE        
                   END-IF                                                       
               END-IF                                                           
           END-IF.                                                              
                                                                                
      *    MOVE DPG55-DB2-ISO-DATE-YR   TO CD-THIS-YEAR.                        
      *    DISPLAY 'LOOKING FOR ROWS WITH PLN INV DATE > THAN '                 
      *         CD-THIS-YEAR-DTE.                                               
      *    MOVE CD-THIS-YEAR-DTE TO CD-PLNDATE.                                 
                                                                                
       5100-GET-1ST-WKDY.                                                       
                                                                                
           INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.                      
           ACCEPT DPG52-LK-DATE-INPUT FROM SYSIN.                               
           SET DPG51-FISCAL-JAN-DEC-F2                                          
               DPG51-DO-NOT-INCR-DECR-DATE                                      
               DPG52-LK-DTE-ISO-FMT        TO TRUE.                             
                                                                                
           CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52                  
                                                   DPG53 DPG54                  
                                                   DPG55 DPG56.                 
                                                                                
           IF DPG54-DATE-INVALID                                                
               DISPLAY '** ABEND ** IN INKRP139'                                
               DISPLAY '** PARAGRAPH: 5100-GET-1ST-WKDY.'                       
               DISPLAY '** INVALID DATE                         '               
               DISPLAY '** CALENDAR ROUTINE ERROR MESSAGE = '                   
                           DPG54-ERROR-MESSAGE                                  
               DISPLAY '** DPG51 = ' DPG51                                      
               DISPLAY '** DPG52 = ' DPG52                                      
               DISPLAY '** DPG53 = ' DPG53                                      
               DISPLAY '** DPG54 = ' DPG54                                      
               DISPLAY '** DPG55 = ' DPG55                                      
               DISPLAY '** DPG56 = ' DPG56                                      
               MOVE +4003 TO ABEND-CODE                                         
               CALL 'ILBOABN0' USING ABEND-CODE                                 
           ELSE                                                                 
                IF DPG54-SEVERE-ERROR                                           
                    DISPLAY '** ABEND ** IN INKRP139'                           
                    DISPLAY '** INVALID RETURN FROM CALENDAR ROUTINE.'          
                    DISPLAY '** CALLED BY 5100-GET-1ST-WKDY.'                   
                    DISPLAY '** ERROR MESSAGE = ' DPG54-ERROR-MESSAGE           
                    DISPLAY '** DPG51 = ' DPG51                                 
                    DISPLAY '** DPG52 = ' DPG52                                 
                    DISPLAY '** DPG53 = ' DPG53                                 
                    DISPLAY '** DPG54 = ' DPG54                                 
                    DISPLAY '** DPG55 = ' DPG55                                 
                    DISPLAY '** DPG56 = ' DPG56                                 
                    MOVE +4003 TO ABEND-CODE                                    
                    CALL 'ILBOABN0' USING ABEND-CODE                            
               ELSE                                                             
                   IF DPG54-WARNING-ERROR                                       
                       DISPLAY                                                  
                             '** WARNING RETURNED BY CALENDAR ROUTINE.'         
                       DISPLAY                                                  
                             '** CALLED BY 5100-GET-1ST-WKDY.'                  
                       DISPLAY                                                  
                             '** WARNING MESSAGE = ' DPG54-ERROR-MESSAGE        
                   END-IF                                                       
               END-IF                                                           
           END-IF.                                                              
                                                                                
           MOVE DPG55-1ST-WKDY-GREG-N   TO HL2A-1ST-WKDY.                       
           MOVE DPG55-1ST-WKDY-GREG-N   TO TL-PROC-WK-GRD-DATE.                 
           MOVE DPG55-1ST-WKDY-GREG-MO  TO CD-1ST-WKDY-MM.                      
           MOVE DPG55-1ST-WKDY-GREG-DY  TO CD-1ST-WKDY-DD.                      
           MOVE DPG55-1ST-WKDY-GREG-CC-YR  TO CD-1ST-WKDY-CCYY.                 
           DISPLAY '1ST WEEK DAY: ' CD-1ST-WKDY.                                
                                                                                
      ******************************************************************        
W33304* LOAD THE WORKING STORAGE TABLE TO INCLUDE ALL OPEN STORES               
W33304* (STORES IN AN ACTIVE INVENTORY CYCLE THAT HAVE NOT FINANCIAL           
W33304* BOOKED).                                                                
      ******************************************************************        
                                                                                
       6000-PROCESS-TINVPAR-CSR.                                                
           EXEC SQL                                                             
               OPEN TINVPAR_CSR                                                 
           END-EXEC.                                                            
                                                                                
           EVALUATE SQLCODE                                                     
               WHEN +0                                                          
                   CONTINUE                                                     
               WHEN OTHER                                                       
                   MOVE 'OPEN TINVPAR CURSOR' TO                                
                       PV-DB2-OPERATION-ATTEMPTED                               
                   PERFORM 9999-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
           PERFORM 6100-FETCH-TINVPAR-TABLE.                                    
                                                                                
           PERFORM 6200-LOAD-WS-STORE-TBL                                       
                  UNTIL PS-END-OF-INVPAR-CURSOR.                                
                                                                                
           EXEC SQL                                                             
               CLOSE TINVPAR_CSR                                                
           END-EXEC.                                                            
                                                                                
           EVALUATE SQLCODE                                                     
               WHEN +0                                                          
                   CONTINUE                                                     
               WHEN OTHER                                                       
                   MOVE 'CLOSE TINVPAR CURSOR' TO                               
                       PV-DB2-OPERATION-ATTEMPTED                               
                   PERFORM 9999-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
      ******************************************************************        
      *  FETCH THE DB2 TINVPAR TABLE INTO THE DCLGEN                            
      ******************************************************************        
                                                                                
       6100-FETCH-TINVPAR-TABLE.                                                
                                                                                
           EXEC SQL                                                             
               FETCH TINVPAR_CSR                                                
W26600         INTO  :INVPAR-LOC-NBR                                            
                    ,:INVPAR-PLND-INV-DTE                                       
                    ,:INVPAR-ACTL-DC-CTOFF-DTE                                  
RB0201              ,:INVPAR-MFSTNG-IND                                         
           END-EXEC.                                                            
                                                                                
           EVALUATE SQLCODE                                                     
               WHEN +0                                                          
                   CONTINUE                                                     
               WHEN +100                                                        
                   SET PS-END-OF-INVPAR-CURSOR TO TRUE                          
               WHEN OTHER                                                       
                   MOVE '6100-FETCH-TINVPAR-TABLE'                              
                       TO PV-PARAGRAPH-NAME                                     
                   MOVE 'FETCH TINVPAR RECORD' TO                               
                       PV-DB2-OPERATION-ATTEMPTED                               
                   PERFORM 9999-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
      ******************************************************************        
      *  LOAD THE STORE DATA INTO THE WORKING STORAGE TABLE                     
      ******************************************************************        
                                                                                
       6200-LOAD-WS-STORE-TBL.                                                  
W26600     MOVE INVPAR-LOC-NBR    TO PC-SUB.                                    
                                                                                
W26600     MOVE INVPAR-LOC-NBR    TO TBL-STORE-NBR(PC-SUB).                     
RB0201     IF INVPAR-MFSTNG-IND = 'Y'                                           
RB0201         MOVE INVPAR-PLND-INV-DTE      TO CD-DATE-WITH-DASHES             
RB0201     ELSE                                                                 
RB0201         MOVE INVPAR-ACTL-DC-CTOFF-DTE TO CD-DATE-WITH-DASHES             
RB0201     END-IF.                                                              
           MOVE CD-CC-WITH-DASHES TO TBL-DC-DATE-CC(PC-SUB).                    
           MOVE CD-YY-WITH-DASHES TO TBL-DC-DATE-YY(PC-SUB).                    
           MOVE CD-MM-WITH-DASHES TO TBL-DC-DATE-MM(PC-SUB).                    
           MOVE CD-DD-WITH-DASHES TO TBL-DC-DATE-DD(PC-SUB).                    
                                                                                
                                                                                
           PERFORM 6100-FETCH-TINVPAR-TABLE.                                    
                                                                                
W26600 6300-PROCESS-XMT00001-CSR.                                               
           EXEC SQL                                                             
               OPEN XMTLOC_CSR                                                  
           END-EXEC.                                                            
                                                                                
           EVALUATE SQLCODE                                                     
               WHEN +0                                                          
                   CONTINUE                                                     
               WHEN OTHER                                                       
W26600             MOVE 'OPEN XMT00001 CURSOR' TO                               
                       PV-DB2-OPERATION-ATTEMPTED                               
                   PERFORM 9999-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
W26600     PERFORM 6400-FETCH-XMT00001-TABLE.                                   
                                                                                
           PERFORM 6500-LOAD-WS-STORE-TABLE                                     
                  UNTIL PS-END-OF-STR000-CURSOR.                                
                                                                                
           EXEC SQL                                                             
               CLOSE XMTLOC_CSR                                                 
           END-EXEC.                                                            
                                                                                
           EVALUATE SQLCODE                                                     
               WHEN +0                                                          
                   CONTINUE                                                     
               WHEN OTHER                                                       
                   MOVE 'CLOSE TINVPAR CURSOR' TO                               
                       PV-DB2-OPERATION-ATTEMPTED                               
                   PERFORM 9999-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
      ******************************************************************        
W26600*  FETCH THE DB2 XMT00001 TABLE INTO THE DCLGEN                           
      ******************************************************************        
                                                                                
W26600 6400-FETCH-XMT00001-TABLE.                                               
                                                                                
           EXEC SQL                                                             
               FETCH XMTLOC_CSR                                                 
W26600         INTO  :XMT00001-LOC-NBR                                          
W26600              ,:XMT00001-LOC-TYP-CDE                                      
           END-EXEC.                                                            
                                                                                
           EVALUATE SQLCODE                                                     
               WHEN +0                                                          
                   CONTINUE                                                     
               WHEN +100                                                        
                   SET PS-END-OF-STR000-CURSOR TO TRUE                          
               WHEN OTHER                                                       
W26600             MOVE '6400-FETCH-XMT00001-TABLE'                             
                       TO PV-PARAGRAPH-NAME                                     
W26600             MOVE 'FETCH XMT00001 RECORD' TO                              
                       PV-DB2-OPERATION-ATTEMPTED                               
                   PERFORM 9999-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
      ******************************************************************        
      *  LOAD THE STORE DATA INTO THE WORKING STORAGE TABLE                     
      ******************************************************************        
                                                                                
       6500-LOAD-WS-STORE-TABLE.                                                
W26600     MOVE XMT00001-LOC-NBR    TO PC-SUB.                                  
                                                                                
W26600     MOVE XMT00001-LOC-NBR        TO TBL-STORE-NBR(PC-SUB).               
           MOVE ZERO                    TO TBL-STORE-DC-DATE(PC-SUB).           
W26600     MOVE XMT00001-LOC-TYP-CDE    TO TBL-STORE-TYPE-CODE(PC-SUB).         
                                                                                
W26600     PERFORM 6400-FETCH-XMT00001-TABLE.                                   
                                                                                
       6900-PROCESS-SKIP-CLASS-CARD.                                            
           PERFORM 7300-READ-SKIP-CLASS-CARD.                                   
           PERFORM VARYING SKIP-IDX FROM +1 BY +1                               
             UNTIL SKIP-IDX > PV-MAX-SKIP-RECS                                  
               OR  PS-END-OF-SKIP-CLASS-CARD                                    
             IF SKIP-CLASS-NBR NUMERIC                                          
                 CONTINUE                                                       
             ELSE                                                               
                 MOVE '6900-PROCESS-SKIP-CLASS-CARD'                            
                     TO PV-PARAGRAPH-NAME                                       
                 MOVE 'READ SKIP CLASS CARD' TO                                 
                     PV-DB2-OPERATION-ATTEMPTED                                 
                 PERFORM 9999-SQL-ABEND                                         
             END-IF                                                             
             MOVE SKIP-CLASS-NBR TO SKIP-CLASS(SKIP-IDX)                        
             PERFORM 7300-READ-SKIP-CLASS-CARD                                  
             IF SKIP-IDX > PV-MAX-SKIP-RECS                                     
                 MOVE '6900-PROCESS-SKIP-CLASS-CARD'                            
                     TO PV-PARAGRAPH-NAME                                       
                 MOVE 'READ SKIP CLASS CARD' TO                                 
                     PV-DB2-OPERATION-ATTEMPTED                                 
                 PERFORM 9999-SQL-ABEND                                         
             END-IF                                                             
           END-PERFORM.                                                         
      ******************************************************************        
      *  READ A STORE EXTRACT RECORD.                                           
      ******************************************************************        
                                                                                
       7100-READ-EXTRACT-FILE.                                                  
           READ STORE-EXTRACT-FILE                                              
               INTO STORE-EXTRACT-LINE                                          
               AT END                                                           
                   SET PS-END-OF-EXTRACT-FILE TO TRUE                           
           END-READ.                                                            
                                                                                
RB0700     IF PS-NOT-END-OF-EXTRACT-FILE                                        
W26600         MOVE SE-LOC-NBR TO PC-SUB-INV-STR                                
RB0700         IF TBL-STORE-DC-DATE(PC-SUB-INV-STR) NOT ZERO                    
RB0700             SET PS-FOUND-INVENTORY-STORE TO TRUE                         
RB0700         END-IF                                                           
RB0700     END-IF.                                                              
                                                                                
      ******************************************************************        
      *  READ A M/L SKIP CLASS CONTROL CARD                                     
      ******************************************************************        
                                                                                
       7300-READ-SKIP-CLASS-CARD.                                               
           READ SKIP-CLASS-CARD                                                 
               INTO CC-SKIP-CLASS-RECORD                                        
               AT END                                                           
                   SET PS-END-OF-SKIP-CLASS-CARD TO TRUE                        
           END-READ.                                                            
                                                                                
      ******************************************************************        
      *  PRINT TITLE LINES ON THE REPORT AT EACH PAGE BREAK.  UPDATE   *        
      *  THE PAGE NUMBER.                                              *        
      ******************************************************************        
                                                                                
       8100-PRINT-TITLE-LINES.                                                  
                                                                                
           ADD 1 TO PV-PAGE-COUNT.                                              
           MOVE PV-PAGE-COUNT TO DP132O-PAGE-NUMBER.                            
                                                                                
           WRITE VERIFIED-RECEIPTS-LINE                                         
               FROM DP132O-STANDRD-HEADER-132-COLS                              
               AFTER ADVANCING PAGE.                                            
                                                                                
           WRITE VERIFIED-RECEIPTS-LINE                                         
               FROM HL2-HEADING-LINE-2                                          
               AFTER ADVANCING 2 LINES.                                         
                                                                                
           WRITE VERIFIED-RECEIPTS-LINE                                         
               FROM HL2A-HEADING-LINE-2A                                        
               AFTER ADVANCING 1 LINES.                                         
                                                                                
           WRITE VERIFIED-RECEIPTS-LINE                                         
               FROM HL3-HEADING-LINE-3                                          
               AFTER ADVANCING 1 LINE.                                          
                                                                                
           WRITE VERIFIED-RECEIPTS-LINE                                         
               FROM HL4-HEADING-LINE-4                                          
               AFTER ADVANCING 1 LINES.                                         
                                                                                
           WRITE VERIFIED-RECEIPTS-LINE                                         
               FROM HL5-HEADING-LINE-5                                          
               AFTER ADVANCING 1 LINES.                                         
                                                                                
           INITIALIZE VERIFIED-RECEIPTS-LINE.                                   
                                                                                
           WRITE VERIFIED-RECEIPTS-LINE                                         
               AFTER ADVANCING 1 LINE.                                          
                                                                                
      ******************************************************************        
      *                                                                         
      *                                                                         
      ******************************************************************        
                                                                                
           IF PS-LAST-PAGE                                                      
               GO TO 8100-CONTINUE.                                             
                                                                                
           IF PV-PREV-DEPT EQUAL SE-DEPT                                        
               MOVE PV-PREV-DEPT TO DL-DEPT                                     
               WRITE VERIFIED-RECEIPTS-LINE                                     
                   FROM HL6-HEADING-LINE-6                                      
                   AFTER ADVANCING 1 LINES                                      
           ELSE                                                                 
               GO TO 8100-CONTINUE.                                             
                                                                                
           IF PV-PREV-MJR-CLASS EQUAL PV-SE-MJR-CLASS                           
               MOVE PV-PREV-MJR-CLASS TO DL-MJR-CLASS                           
               WRITE VERIFIED-RECEIPTS-LINE                                     
                   FROM HL7-HEADING-LINE-7                                      
                   AFTER ADVANCING 1 LINES                                      
           ELSE                                                                 
               IF PV-PREV-DEPT EQUAL SE-DEPT                                    
                   IF PS-CLASS-TTL-WRITTEN                                      
                       GO TO 8100-CONTINUE                                      
                   ELSE                                                         
                       MOVE PV-PREV-MJR-CLASS TO DL-MJR-CLASS                   
                       WRITE VERIFIED-RECEIPTS-LINE                             
                           FROM HL7-HEADING-LINE-7                              
                           AFTER ADVANCING 1 LINES                              
                   END-IF                                                       
               ELSE                                                             
                   MOVE PV-PREV-MJR-CLASS TO DL-MJR-CLASS                       
                   WRITE VERIFIED-RECEIPTS-LINE                                 
                       FROM HL7-HEADING-LINE-7                                  
                       AFTER ADVANCING 1 LINES                                  
                       GO TO 8100-CONTINUE                                      
               END-IF.                                                          
                                                                                
           IF PS-FIRST-LINE                                                     
               SET PS-NOT-FIRST-LINE TO TRUE                                    
           ELSE                                                                 
               MOVE PV-PREV-PO        TO DL4-PO                                 
               MOVE PV-PREV-REC-SEQ-NBR TO DL4-REC-SEQ-NBR                      
               MOVE PV-PREV-DATE-VERIFIED TO DL4-DATE-VERIFIED                  
               MOVE PV-PREV-STORE     TO DL4-STORE                              
               MOVE PV-PREV-STORE     TO PC-SUB                                 
               MOVE TBL-DC-DATE-MM(PC-SUB) TO DL4-ACTL-DC-CTOFF-MM              
               MOVE TBL-DC-DATE-DD(PC-SUB) TO DL4-ACTL-DC-CTOFF-DD              
               MOVE TBL-DC-DATE-YY(PC-SUB) TO DL4-ACTL-DC-CTOFF-YY              
               WRITE VERIFIED-RECEIPTS-LINE                                     
                   FROM DL4-DETAIL-LINE                                         
                   AFTER ADVANCING 1 LINES.                                     
                                                                                
       8100-CONTINUE.                                                           
           MOVE 11 TO PV-LINE-COUNT.                                            
                                                                                
       8100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
      *  CLOSE ALL FILES.                                              *        
      ******************************************************************        
                                                                                
       9000-EOJ-ROUTINE.                                                        
                                                                                
W29908*** STORE TOTALS.....                                                     
W29908     IF PV-GRD-BEF-RETAIL IS EQUAL TO ZEROS     AND                       
W29908        PV-GRD-BEF-UNITS IS EQUAL TO ZEROS      AND                       
W29908        PV-GRD-AFT-RETAIL IS EQUAL TO ZEROS     AND                       
W29908        PV-GRD-AFT-UNITS IS EQUAL TO ZEROS                                
W29908         PERFORM 9100-NOTHING-TO-REPORT                                   
W29908     END-IF.                                                              
W29908                                                                          
W29908*** CLOSE FILES.....                                                      
           CLOSE STORE-EXTRACT-FILE                                             
                 VERIFIED-RECEIPTS-RPT.                                         
                                                                                
W29908******************************************************************        
W29908* 9100-NOTHING-TO-REPORT.                                                 
W29908******************************************************************        
W29908 9100-NOTHING-TO-REPORT.                                                  
W29908                                                                          
W29908     IF PV-LINE-COUNT IS GREATER THAN (PC-PAGE-SIZE - 2)                  
W29908         PERFORM 8100-PRINT-TITLE-LINES THRU 8100-EXIT                    
W29908     END-IF.                                                              
W29908                                                                          
W29908     WRITE VERIFIED-RECEIPTS-LINE                                         
W29908         FROM NL-NO-REPORT-LINE AFTER ADVANCING 2 LINE.                   
W29908                                                                          
      ******************************************************************        
      * 9999-SQL-ABEND - PERFORMS THE ABEND FOR THE PROGRAM IN THE              
      * EVENT THAT AN SQL ERROR OR WARNING CODE OCCURS.                         
      ******************************************************************        
      *                                                                         
       9999-SQL-ABEND.                                                          
                                                                                
           DISPLAY '** ABEND     **'.                                           
           DISPLAY '** PROGRAM   ** = INKRP139'.                                
           DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.                      
           DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.             
                                                                                
      ******************************************************************        
      * THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-            
      * MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE                 
      * 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE             
      * FORMAT.                                                                 
      ******************************************************************        
           COPY DPPD004.                                                        
                                                                                
           MOVE +4013 TO ABEND-CODE.                                            
           CALL 'ILBOABN0' USING ABEND-CODE.                                    
                                                                                
