000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             SUKRF708.                                00050000
000600 AUTHOR.                 CHERI PARMLEY.                           00060000
000700 INSTALLATION.           KOHLS.                                   00070000
000800 DATE-WRITTEN.           JULY 12, 2013.                           00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200* THIS PROGRAM DISPLAYS THE LABEL WARNING SCREEN (ON LRT LASER    00120000
001300* RADIO TERMINAL).  IF USER EXITS CHECK IN APPLICATION AND THERE  00130000
001400* ARE STILL LABELS TO BE PRINTED. IT IS USED IN THE UCC128 PROCESS00140000
001400* IN OPTION 5 FOR THE RFID FINAL LABEL REQUEST. THIS PROGRAM IS A 00141000
001400* CLONE OF SUKRF528.                                              00142000
001500******************************************************************00150000
001500*----------------------------------------------------------------*00151003
000510* 10/14/2013  CHERI PARMLEY  CHG0065998     TKID: TKMAF76        *00152005
000520*             ADD F1 (TRANSFER TO HELP SCREEN) LOGIC             *00153003
000560*             TAGGED AS CLP 10/14/2013                            00154003
001500*----------------------------------------------------------------*00155003
001600                                                                  00160000
001700                                                                  00170000
001800******************************************************************00180000
001900 ENVIRONMENT DIVISION.                                            00190000
002000******************************************************************00200000
002100                                                                  00210000
002200******************************************************************00220000
002300 DATA DIVISION.                                                   00230000
002400******************************************************************00240000
002500                                                                  00250000
002600******************************************************************00260000
002700 WORKING-STORAGE SECTION.                                         00270000
002800******************************************************************00280000
002900*                                                                 00290000
003000 01  CA-COMMAREA.                                                 00300000
003100     COPY SUWS001.                                                00310000
003200                                                                  00320000
      *CLP 10/14/2013 BEGIN                                             00321003
006200* HELP SCREEN COMMAREA                                            00322003
006300     COPY PCWS192.                                                00323003
006400*----------------------------------------------------------------*00324003
006500* HELP SCREEN WORK AREA                                           00325003
006600     COPY PCWS188.                                                00326003
      *CLP 10/14/2013 END                                               00327003
003300*                                                                 00330000
003400 01  PC-PROGRAM-CONSTANTS.                                        00340000
003500     05  PC-TRANID                  PIC  X(04) VALUE 'S708'.      00350000
003600*    05  PC-COMMAREA-LENGTH         PIC S9(04) VALUE +300         00360000
003700     05  PV-COMMAREA-LENGTH         PIC S9(04) VALUE +0           00370000
003800                                                     COMP SYNC.   00380000
003900                                                                  00390000
004000*****05  PC-TRAILER-STOP-PGM        PIC  X(08) VALUE 'SUKRF503'.  00400002
004000     05  PC-SU-RFID-CONTROL-PGM     PIC  X(08) VALUE 'SUKRF705'.  00401002
004100     05  PC-SU-LBL-PRT-PGM          PIC  X(08) VALUE 'SUKRF707'.  00410000
004200     05  PC-CURRENT-PROGRAM-NAME    PIC  X(08) VALUE 'SUKRF708'.  00420000
004300                                                                  00430000
004400     05  PC-UNRECOGNIZED-PF-KEY-MSG PIC  X(19) VALUE              00440000
004500                                          'UNRECOGNIZED PF KEY'.  00450000
004600     05  PC-TRANS-UNAVAILABLE-MSG   PIC  X(19) VALUE              00460000
004700                                           'TRANS NOT AVAILABLE'. 00470000
004800                                                                  00480000
004900 01  PV-PROGRAM-VARIABLES.                                        00490000
005000     05  PV-CICS-RESPONSE           PIC S9(09) VALUE ZEROS        00500000
005100                                                COMP SYNC.        00510000
005200     05  PV-TRANSFER-PROGRAM        PIC  X(08) VALUE SPACE.       00520000
005300                                                                  00530000
005400*                                                                 00540000
005500*  GENERATED DSECT FOR THE SUKM708 MAPSET                         00550001
005600*                                                                 00560000
005700     COPY SUKM708.                                                00570001
005800                                                                  00580000
005900*                                                                 00590000
006000*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               00600000
006100*                                                                 00610000
006200     COPY DPWS013.                                                00620000
006300                                                                  00630000
006400*                                                                 00640000
006500*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      00650000
006600*                                                                 00660000
006700     COPY DFHAID.                                                 00670000
006800                                                                  00680000
006900***************************************************************** 00690000
007000 LINKAGE SECTION.                                                 00700000
007100******************************************************************00710000
007200*01  DFHCOMMAREA                   PIC  X(300).                   00720000
007300 01  DFHCOMMAREA.                                                 00730000
007400     05  FILLER                       OCCURS 1 TO 4072 TIMES      00740000
007500                                      DEPENDING ON EIBCALEN.      00750000
007600         10  FILLER                   PIC X.                      00760000
007700                                                                  00770000
007800******************************************************************00780000
007900 PROCEDURE DIVISION.                                              00790000
008000******************************************************************00800000
008100 0000-PROGRAM-MAINLINE.                                           00810000
008200*LMM                                                              00820000
008300     INITIALIZE CA-COMMAREA                                       00830000
008400     MOVE DFHCOMMAREA TO CA-COMMAREA.                             00840000
008500                                                                  00850000
008600     EVALUATE TRUE                                                00860000
      *CLP 10/14/2013 BEGIN                                             00861003
061300         WHEN EIBAID = DFHPF1                                     00862003
061400              PERFORM 1200-HELP-SCREEN                            00863003
      *CLP 10/14/2013 END                                               00864003
008700         WHEN EIBAID = DFHPF4                                     00870000
008800             SET  SU001-INITIALIZE-SCREEN TO TRUE                 00880000
008900             MOVE PC-SU-LBL-PRT-PGM TO PV-TRANSFER-PROGRAM        00890000
009000             MOVE SPACES            TO SU001-TURN-PRINTER-ON-IND  00900000
009100             PERFORM 4000-XCTL-LRT-MENU                           00910000
009200                                                                  00920000
009300                                                                  00930000
      *CLP 10/14/2013 BEGIN                                             00931003
154300****************************************************************  00932003
154400* DPKRF278 IS THE PGM FOR THE HELP SCREEN.                        00933003
154500****************************************************************  00934003
154600         WHEN EIBTRNID = 'Z278'                                   00935003
154700             MOVE DFHCOMMAREA          TO PC192-COMMAREA          00936003
154800             MOVE PC192-HOST-SAVE-AREA TO CA-COMMAREA             00937003
154900             SET SU001-PROCESS-SCREEN  TO TRUE                    00938003
155700             PERFORM 8000-SEND-MAP                                00939203
155800             PERFORM 8200-RETURN-TRANID                           00939303
      *CLP 10/14/2013 END                                               00939403
                                                                        00939503
009400         WHEN SU001-INITIALIZE-SCREEN                             00940000
009500         WHEN EIBAID = DFHCLEAR                                   00950000
009600             SET SU001-PROCESS-SCREEN TO TRUE                     00960000
009700             PERFORM 8000-SEND-MAP                                00970000
009800             PERFORM 8200-RETURN-TRANID                           00980000
009900                                                                  00990000
010000                                                                  01000000
010100         WHEN EIBAID = DFHENTER                                   01010000
010200             MOVE PC-SU-RFID-CONTROL-PGM TO PV-TRANSFER-PROGRAM   01020002
010300             PERFORM 4000-XCTL-LRT-MENU                           01030000
010400                                                                  01040000
010500                                                                  01050000
010600         WHEN OTHER                                               01060000
010700             MOVE PC-UNRECOGNIZED-PF-KEY-MSG TO AMSGLNO           01070000
010800             PERFORM 8100-SEND-DATA-ONLY                          01080000
010900             PERFORM 8200-RETURN-TRANID                           01090000
011000     END-EVALUATE.                                                01100000
011100                                                                  01110000
011200     GOBACK.                                                      01120000
011300                                                                  01130000
      *CLP 10/14/2013 BEGIN                                             01131003
191600 1200-HELP-SCREEN.                                                01132003
191700     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM      01133003
191800     MOVE PC-CURRENT-PROGRAM-NAME     TO PC192-PROGRAM-NAME       01134003
191900     COPY PCPD188.                                                01135003
192000     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      01136003
192100     PERFORM 4200-XCTL-TO-HELP.                                   01137003
      *CLP 10/14/2013 END                                               01138003
                                                                        01139003
011400 4000-XCTL-LRT-MENU.                                              01140000
011500     SET SU001-INITIALIZE-SCREEN  TO TRUE.                        01150000
011600     MOVE PC-CURRENT-PROGRAM-NAME TO SU001-LAST-PROGRAM.          01160000
011700                                                                  01170000
011800*LMM                                                              01180000
011900     MOVE LENGTH OF CA-COMMAREA   TO PV-COMMAREA-LENGTH           01190000
012000     EXEC CICS                                                    01200000
012100         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    01210000
012200               COMMAREA  (CA-COMMAREA)                            01220000
012300*LMM           LENGTH    (PC-COMMAREA-LENGTH)                     01230000
012400               LENGTH    (PV-COMMAREA-LENGTH)                     01240000
012500               RESP      (PV-CICS-RESPONSE)                       01250000
012600     END-EXEC.                                                    01260000
012700                                                                  01270000
012800     EVALUATE TRUE                                                01280000
012900         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 01290000
013000             CONTINUE                                             01300000
013100         WHEN OTHER                                               01310000
013200             MOVE '4000-XCTL-TO-LRT-MENU'                         01320000
013300                 TO DP013-PARAGRAPH                               01330000
013400             MOVE 'UNABLE TO XCTL TO PROGRAM: '                   01340000
013500                 TO DP013-MESSAGE-TEXT (1)                        01350000
013600             MOVE PV-TRANSFER-PROGRAM                             01360000
013700                 TO DP013-MESSAGE-TEXT (2)                        01370000
013800             SET DP013-CICS-ABEND  TO TRUE                        01380000
013900             SET DP013-NO-ROLLBACK TO TRUE                        01390000
014000             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               01400000
014100             MOVE PC-TRANS-UNAVAILABLE-MSG TO AMSGLNO             01410000
014200             SET SU001-PROCESS-SCREEN TO TRUE                     01420000
014300             PERFORM 8000-SEND-MAP                                01430000
014400             PERFORM 8200-RETURN-TRANID                           01440000
014500     END-EVALUATE.                                                01450000
014600                                                                  01460000
      *CLP 10/14/2013 BEGIN                                             01461004
443300 4200-XCTL-TO-HELP.                                               01462004
443400                                                                  01463004
443500     MOVE LENGTH OF PC192-COMMAREA    TO PV-COMMAREA-LENGTH.      01464004
443600     SET  SU001-INITIALIZE-SCREEN     TO TRUE.                    01465004
443700     MOVE SU001-COMMON-DATA           TO PC192-HOST-SAVE-AREA.    01466004
443800                                                                  01467004
443900     EXEC CICS                                                    01468004
444000         XCTL                                                     01469004
444100             PROGRAM   (PV-TRANSFER-PROGRAM)                      01469104
444200             COMMAREA  (PC192-COMMAREA)                           01469204
444300             LENGTH    (PV-COMMAREA-LENGTH)                       01469304
444400             RESP      (PV-CICS-RESPONSE)                         01469404
444500     END-EXEC.                                                    01469504
444600                                                                  01469604
444700     EVALUATE TRUE                                                01469704
444800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 01469804
444900              CONTINUE                                            01469904
445000         WHEN OTHER                                               01470004
445100             MOVE '4200-XCTL-TO-HELP '                            01470104
445200                 TO DP013-PARAGRAPH                               01470204
445300             MOVE 'SUKRF706 - UNABLE TO XCTL TO PROGRAM: '        01470304
445400                 TO DP013-MESSAGE-TEXT (1)                        01470404
445500             MOVE PV-TRANSFER-PROGRAM                             01470504
445600                 TO DP013-MESSAGE-TEXT (2)                        01470604
445700             SET DP013-CICS-ABEND  TO TRUE                        01470704
445800             SET DP013-ROLLBACK TO TRUE                           01470804
445900             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               01470904
446000             MOVE PC-TRANS-UNAVAILABLE-MSG TO AMSGLNO             01471004
446100             SET SU001-PROCESS-SCREEN TO TRUE                     01471104
446200             PERFORM 8000-SEND-MAP                                01471204
446300             PERFORM 8200-RETURN-TRANID                           01471304
446400     END-EVALUATE.                                                01471404
      *CLP 10/14/2013 END                                               01471504
014700 8000-SEND-MAP.                                                   01472000
014800                                                                  01480000
014900     EXEC CICS                                                    01490000
015000         SEND MAP       ('SU708A')                                01500001
015100              MAPSET    ('SUKM708')                               01510001
015200              ERASE                                               01520000
015300              RESP      (PV-CICS-RESPONSE)                        01530000
015400     END-EXEC.                                                    01540000
015500                                                                  01550000
015600     EVALUATE TRUE                                                01560000
015700         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 01570000
015800             CONTINUE                                             01580000
015900         WHEN OTHER                                               01590000
016000             MOVE '8000-SEND-MAP'      TO DP013-PARAGRAPH         01600000
016100             MOVE 'UNABLE TO SEND MAP' TO DP013-MESSAGE-TEXT (1)  01610000
016200             SET DP013-CICS-ABEND      TO TRUE                    01620000
016300             SET DP013-NO-ROLLBACK     TO TRUE                    01630000
016400             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               01640000
016500     END-EVALUATE.                                                01650000
016600                                                                  01660000
016700*                                                                 01670000
016800 8100-SEND-DATA-ONLY.                                             01680000
016900                                                                  01690000
017000     EXEC CICS                                                    01700000
017100         SEND MAP       ('SU708A')                                01710001
017200              MAPSET    ('SUKM708')                               01720001
017300              CURSOR                                              01730000
017400              DATAONLY                                            01740000
017500              RESP      (PV-CICS-RESPONSE)                        01750000
017600     END-EXEC.                                                    01760000
017700                                                                  01770000
017800     EVALUATE TRUE                                                01780000
017900         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 01790000
018000             CONTINUE                                             01800000
018100         WHEN OTHER                                               01810000
018200             MOVE '8100-SEND-DATA-ONLY' TO DP013-PARAGRAPH        01820000
018300             MOVE 'UNABLE TO SEND DATA' TO DP013-MESSAGE-TEXT (1) 01830000
018400             SET DP013-CICS-ABEND       TO TRUE                   01840000
018500             SET DP013-NO-ROLLBACK      TO TRUE                   01850000
018600             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               01860000
018700     END-EVALUATE.                                                01870000
018800                                                                  01880000
018900*                                                                 01890000
019000 8200-RETURN-TRANID.                                              01900000
019100                                                                  01910000
019200*LMM                                                              01920000
019300     MOVE LENGTH OF CA-COMMAREA     TO PV-COMMAREA-LENGTH         01930000
019400     EXEC CICS                                                    01940000
019500         RETURN TRANSID  (PC-TRANID)                              01950000
019600                COMMAREA (CA-COMMAREA)                            01960000
019700*LMM            LENGTH   (PC-COMMAREA-LENGTH)                     01970000
019800                LENGTH   (PV-COMMAREA-LENGTH)                     01980000
019900                RESP     (PV-CICS-RESPONSE)                       01990000
020000     END-EXEC.                                                    02000000
020100                                                                  02010000
020200     EVALUATE TRUE                                                02020000
020300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 02030000
020400             CONTINUE                                             02040000
020500         WHEN OTHER                                               02050000
020600             MOVE '8200-RETURN-TRANIND' TO DP013-PARAGRAPH        02060000
020700             MOVE 'UNABLE TO RETURN TO TRANID'                    02070000
020800                 TO DP013-MESSAGE-TEXT (1)                        02080000
020900             SET DP013-CICS-ABEND       TO TRUE                   02090000
021000             SET DP013-NO-ROLLBACK      TO TRUE                   02100000
021100             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               02110000
021200     END-EVALUATE.                                                02120000
021300                                                                  02130000
021400 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  02140000
021500                                                                  02150000
021600     MOVE PC-CURRENT-PROGRAM-NAME  TO DP013-PROGRAM.              02160000
021700     MOVE DFHEIBLK                 TO DP013-DFHEIBLK.             02170000
021800     INITIALIZE DP013-SRC-TASK-NUMBER                             02180000
021900                DP013-STACK.                                      02190000
022000     SET DP013-LINK-RETURN TO TRUE.                               02200000
022100                                                                  02210000
022200     EXEC CICS                                                    02220000
022300         LINK                                                     02230000
022400             PROGRAM   (DP013-NAME)                               02240000
022500             COMMAREA  (DP013-PARAMETERS)                         02250000
022600             LENGTH    (DP013-LENGTH)                             02260000
022700     END-EXEC.                                                    02270000
022800                                                                  02280000
022900                                                                  02290000
023000*----------------------------------------------------------------*02300000
023100*    ABEND PROCESSOR MODULE                                      *02310000
023200*----------------------------------------------------------------*02320000
023300                                                                  02330000
023400     COPY DPPD014.                                                02340000
023500                                                                  02350000
