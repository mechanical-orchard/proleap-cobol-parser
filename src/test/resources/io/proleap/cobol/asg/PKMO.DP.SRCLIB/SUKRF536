000100******************************************************************00010099
000200 IDENTIFICATION DIVISION.                                         00020099
000300 PROGRAM-ID.             SUKRF536.                                00030099
000400 AUTHOR.                 LARRY SCHLEICHER.                        00040099
000500 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00050099
000600 DATE-WRITTEN.           DEC, 2000.                               00060099
000700 DATE-COMPILED.                                                   00070099
000800                                                                  00080099
000900*----------------------------------------------------------------*00090099
001000* THIS PROGRAM IS STARTED BY THE SUKRF515 PROGRAM.  IT IS USED    00100099
001100* TO DISPLAY INFORMATION ON THE STATUS OF AN AUDIT IMMEDIATELY    00110099
001200* AFTER ONE OF THE CARTONS OF THE AUDIT HAS BEEN AUDITED.         00120099
001300* THIS PROGRAM WILL ALSO UPDATE THE STATUS OF THE AUDIT IF IT     00130099
001400* HAS BEEN DETERMINED THAT THE AUDIT PASSED, FAILED OR IS NO      00140099
001500* LONGER NEEDED.                                                  00150099
001600*----------------------------------------------------------------*00160099
001800* 11/06/2013 DAVE WELLER CHG00????? TKID: TKMA602                 00180099
001900*            CHANGE TO SHOW QC AND RFID AUDIT USER RESULTS        00190099
002000*            BASED ON THE AUDITS PERFORMED ON THE CARTON.         00200099
002200******************************************************************00220099
002300                                                                  00230099
002400******************************************************************00240099
002500 ENVIRONMENT DIVISION.                                            00250099
002600******************************************************************00260099
002700                                                                  00270099
002800******************************************************************00280099
002900 DATA DIVISION.                                                   00290099
003000******************************************************************00300099
003100                                                                  00310099
003200******************************************************************00320099
003300 WORKING-STORAGE SECTION.                                         00330099
003400******************************************************************00340099
003500*                                                                 00350099
003600 01  CA-COMMAREA.                                                 00360099
003700                                                                  00370099
003800     COPY SUWS006.                                                00380099
003900                                                                  00390099
004000    05  CA-PROGRAM-COMMAREA.                                      00400099
004100         10 CA-PICK-ERRORS                  PIC S9(09) COMP.      00410099
004200         10 CA-PACK-ERRORS                  PIC S9(09) COMP.      00420099
004300         10 CA-TICKET-ERRORS                PIC S9(09) COMP.      00430099
004400         10 CA-AUDIT-ERROR-PCT              PIC S999V99  COMP-3.  00440099
004500         10 CA-AUDITED-UNITS                PIC S9(03) COMP-3.    00450099
004600         10 CA-TOTAL-UNITS                  PIC S9(03) COMP-3.    00460099
004700         10 CA-AUDITED-CARTONS              PIC S9(03) COMP-3.    00470099
004800         10 CA-TOTAL-CARTONS-RF             PIC S9(03) COMP-3.    00480099
004900         10 CA-AUDITED-UNITS-RF             PIC S9(03) COMP-3.    00490099
005000         10 CA-TOTAL-UNITS-RF               PIC S9(03) COMP-3.    00500099
005100         10 CA-AUDITED-CARTONS-RF           PIC S9(03) COMP-3.    00510099
005200         10 CA-TOTAL-CARTONS                PIC S9(03) COMP-3.    00520099
005300         10 CA-F3-ALLOWED-IND               PIC  X(01).           00530099
005400         10 CA-PO-STR-ERRORS                PIC  X(01).           00540099
005500         10  CA-PRTR-CNTL-IND            PIC  X(01).              00550099
005600         10  CA-TRACK-NBR                PIC  9(01).              00560099
005700         10  CA-LOGISTICS-PRINTER        PIC  X(08).              00570099
005710             88  CA-PRINT-TO-FILE             VALUE 'FILE'.       00571099
005800         10  CA-BRCDE-IND                PIC  X(08).              00580099
005900         10 CA-IP-AUDITS-SW                 PIC  X(01).           00590099
006000             88 CA-IP-AUDITS                VALUE 'Y'.            00600099
006100             88 CA-NO-IP-AUDITS             VALUE 'N'.            00610099
006200         10 CA-IP-RF-AUDITS-SW              PIC  X(01).           00620099
006300             88 CA-IP-RF-AUDITS             VALUE 'Y'.            00630099
006400             88 CA-NO-IP-RF-AUDITS          VALUE 'N'.            00640099
006500         10  CA-TOT-TCKT-ERROR-PCT       PIC S999V99  COMP-3.     00650099
006600         10  CA-TCKT-ERROR-PCT           PIC S999V99  COMP-3.     00660099
006700         10  CA-PICK-ERROR-PCT           PIC S999V99  COMP-3.     00670099
006800         10  CA-AUDIT-STATUS-SW         PIC  X(01).               00680099
006900             88  CA-AUDIT-INPROCESS            VALUE 'I'.         00690099
007000             88  CA-AUDIT-COMPLETE             VALUE 'N'.         00700099
007100             88  CA-AUDIT-FAILED               VALUE 'F'.         00710099
007200             88  CA-AUDIT-PASSED               VALUE 'P'.         00720099
007300                                                                  00730099
007400     COPY SUWS042.                                                00740099
007500                                                                  00750099
007600 01  CA-CHECK-IN-COMMAREA.                                        00760099
007700                                                                  00770099
007800*----------------------------------------------------------------*00780099
007900* COMMAREA USED WHEN LINKING FROM A CALLING PROGRAM               00790099
008000*----------------------------------------------------------------*00800099
008100     COPY SUWS001.                                                00810099
008200                                                                  00820099
008300                                                                  00830099
008400 01  CA-SUMMARY-COMMAREA.                                         00840099
008500*----------------------------------------------------------------*00850099
008600* COMMAREA USED TO PASS DATA TO AND FROM SUKCS594                 00860099
008700*----------------------------------------------------------------*00870099
008800     COPY SUWS026.                                                00880099
008900                                                                  00890099
009000*----------------------------------------------------------------*00900099
009100* COMMAREA USED TO PASS DATA TO AND FROM SUKCS763                 00910099
009200*----------------------------------------------------------------*00920099
009300     COPY SUWS047.                                                00930099
009400                                                                  00940099
009500******************************************************************00950099
009600*  SENDING/RECEIVING AREA FOR THE                                 00960099
009700*  PRINTER VALIDATION ROUTING (DPKCS060)                          00970099
009800******************************************************************00980099
009900     COPY DPWS072.                                                00990099
010000                                                                  01000099
010100                                                                  01010099
010200*----------------------------------------------------------------*01020099
010300*  DB2 KEYS                                                      *01030099
010400*----------------------------------------------------------------*01040099
010500 01  DK-DB2-KEYS.                                                 01050099
010600     05  DK-OPER-UNT-ID                  PIC  S9(4) COMP.         01060099
010700     05  DK-FCLTY-ID                     PIC  S9(4) VALUE +1      01070099
010800                                                    COMP.         01080099
010900     05  DK-AUDIT-CNTL-NBR               PIC S9(09) COMP.         01090099
011000     05  DK-PO-NBR                       PIC S9(09) COMP.         01100099
011100     05  DK-PO-LINE-NBR                  PIC S9(09) COMP.         01110099
011200     05  DK-PREPK-ID                     PIC S9(04) COMP.         01120099
011300     05  DK-SHIP-UNIT-NBR                PIC S9(18) COMP-3.       01130099
011400     05  DK-UPC-NBR                     PIC S9(15)V COMP-3.       01140099
011500     05  DK-SHIPT-UNIT-ID               PIC S9(18)V COMP-3.       01150099
011600                                                                  01160099
011700*                                                                 01170099
011800 01  SE-SYSTEM-ERROR-MESSAGE.                                     01180099
011900     05  FILLER                  PIC X(43)    VALUE               01190099
012000         'A SYSTEM ERROR HAS OCCURRED - CONTACT DP - '.           01200099
012100     05  FILLER                  PIC X(31)    VALUE               01210099
012200         'PROGRAM SUKRF510     EIBRESP = '.                       01220099
012300     05  SE-CICS-RESPONSE        PIC 9(4)     VALUE ZERO.         01230099
012400     05  FILLER                  PIC X(2)     VALUE SPACES.       01240099
012500     05  FILLER                  PIC X(14)    VALUE               01250099
012600         'ATTEMPTING TO '.                                        01260099
012700     05  SE-ATTEMPTED-ACTION     PIC X(61)    VALUE SPACES.       01270099
012800                                                                  01280099
012900*----------------------------------------------------------------*01290099
013000*  PROGRAM CONSTANTS                                             *01300099
013100*----------------------------------------------------------------*01310099
013200 01  PC-PROGRAM-CONSTANTS.                                        01320099
013300     05  PC-TRANID                  PIC  X(04)  VALUE 'S536'.     01330099
013400     05  PC-A                       PIC X(01) VALUE 'A'.          01340099
013500     05  PC-F                       PIC X(01) VALUE 'F'.          01350099
013600     05  PC-M                       PIC X(01) VALUE 'M'.          01360099
013700     05  PC-I                       PIC X(01) VALUE 'I'.          01370099
013800     05  PC-D                       PIC X(01) VALUE 'D'.          01380099
013900     05  PC-P                       PIC X(01) VALUE 'P'.          01390099
014000     05  PC-N                       PIC X(01) VALUE 'N'.          01400099
014100     05  PC-NBR-OF-RF-ERRORS-ALWD   PIC 9(02) VALUE 0.            01410099
014200     05  PC-CURRENT-PROGRAM-NAME    PIC X(08) VALUE 'SUKRF536'.   01420099
014300     05  PC-OPEN-CARTON-SCREEN      PIC X(08) VALUE 'SUKRF511'.   01430099
014400     05  PC-SUKCS594                PIC X(08) VALUE 'SUKCS594'.   01440099
014500     05  PC-SUKCS763                PIC X(08) VALUE 'SUKCS763'.   01450099
014600     05  PC-SU-CARTON-CHECK-IN-PGM  PIC X(08) VALUE 'SUKRF502'.   01460099
014700     05  PC-CARTON-CLOSE-SCREEN     PIC X(08) VALUE 'SUKRF515'.   01470099
014800     05  PC-COMMON-CARTON-CLOSE-PGM PIC X(08) VALUE 'SUKCS769'.   01480099
014900                                                                  01490099
015000     05  PC-AUDIT-COPY-PROGRAM      PIC X(08) VALUE 'SUKRF700'.   01500099
015100                                                                  01510099
015200     05  PC-REPORT-PGM              PIC X(08) VALUE               01520099
015300         'SUKRP002'.                                              01530099
015400     05  PC-PRTR-VALIDATION-PGM     PIC X(08) VALUE               01540099
015500         'DPKCS060'.                                              01550099
015600     05  PC-01                      PIC X(02) VALUE '01'.         01560099
015700                                                                  01570099
015800     05  PC-DEFAULT-TIMESTAMP       PIC X(26) VALUE               01580099
015900               '9999-09-09-09.09.09.999999'.                      01590099
016000                                                                  01600099
016100     05  PC-APCKH                   PIC X(19) VALUE               01610099
016200         '#PICK  #PACK  #TCKT'.                                   01620099
016300     05  PC-AQCSTH                  PIC X(10) VALUE               01630099
016400         'QCAUD STA:'.                                            01640099
016500     05  PC-ARFSTH                  PIC X(10) VALUE               01650099
016600         'RFAUD STA:'.                                            01660099
016700     05  PC-AQCCTLH                 PIC X(07) VALUE               01670099
016800         'QCAUD #'.                                               01680099
016900     05  PC-ARFCTLH                 PIC X(07) VALUE               01690099
017000         'RFAUD #'.                                               01700099
017100     05  PC-ARFCRLH                 PIC X(14) VALUE               01710099
017200         '#RFID UNTS ERR'.                                        01720099
017300     05  PC-AQCCRTH                 PIC X(04) VALUE               01730099
017400         'CRTN'.                                                  01740099
017500     05  PC-ARFCRTH                 PIC X(04) VALUE               01750099
017600         'CRTN'.                                                  01760099
017700     05  PC-AQCOFH                  PIC X(02) VALUE               01770099
017800         'OF'.                                                    01780099
017900     05  PC-ARFOFH                  PIC X(02) VALUE               01790099
018000         'OF'.                                                    01800099
018010     05  PC-PRINT-TO-FILE           PIC  X(04)  VALUE 'FILE'.     01801099
018020     05  PC-PRINT-TO-FILE-ERR-MSG   PIC X(19) VALUE               01802099
018030                                           'PRT-TO-FILE INVALID'. 01803099
018100                                                                  01810099
018200                                                                  01820099
018300*----------------------------------------------------------------*01830099
018400*   ERROR MESSAGES                                                01840099
018500*----------------------------------------------------------------*01850099
018600     05  PC-UNRECOGNIZED-PF-KEY-MSG PIC X(19)                     01860099
018700                                    VALUE  'UNRECOGNIZED PF KEY'. 01870099
018800     05  PC-CARTON-LEVEL-ERROR-MSG  PIC X(19)                     01880099
018900                                    VALUE  'CARTON LEVEL ERRORS'. 01890099
019000     05  PC-ENT-CONT-F3-RESTART-MSG PIC X(19)                     01900099
019100                                    VALUE  'ENT-CONT F3-RESTART'. 01910099
019200     05  PC-ENTER-TO-CONTINUE-MSG   PIC X(19)                     01920099
019300                                    VALUE  'ENTER TO CONTINUE  '. 01930099
019400     05  PC-NO-FAILED-AUDITS        PIC X(19)                     01940099
019500                                    VALUE  'NO FAILED AUDITS   '. 01950099
019600     05  PC-ENTER-THROUGH-MENU-MSG  PIC X(19)                     01960099
019700                                    VALUE  'ENTER THROUGH MENU '. 01970099
019800     05  PC-TRANS-UNAVAILABLE-MSG   PIC X(19)                     01980099
019900                                    VALUE  'TRANS NOT AVAILABLE'. 01990099
020000     05  PC-AUD-CLSD-NO-RESTART     PIC X(19)                     02000099
020100                                    VALUE  'AUD CLSD-NO RESTART'. 02010099
020200     05  PC-AUDIT-OF-Y-OR-N         PIC X(19)                     02020099
020300                                    VALUE 'AUDIT MUST = Y OR N'.  02030099
020400     05  PC-DB2-FATAL-ERROR-MSG     PIC  X(19)                    02040099
020500                                    VALUE 'DB2 ERR/HELP DESK  '.  02050099
020600     05  PC-DIRECTIVE-ERROR-MSG     PIC  X(19)                    02060099
020700                                    VALUE 'DIRCT ERR/HELP DESK'.  02070099
020800     05  PC-CCC-PARM-ERR-MSG        PIC  X(19)  VALUE             02080099
020900                                    'PARM ERROR-SUKCS769'.        02090099
021000     05  PC-CCC-DB2-ERR-MSG         PIC  X(19)  VALUE             02100099
021100                                    'DB2  ERROR-SUKCS769'.        02110099
021200     05  PC-CCC-MQ-ERR-MSG          PIC  X(19)  VALUE             02120099
021300                                    'MQ   ERROR-SUKCS769'.        02130099
021400     05  PC-CCC-OTHR-ERR-MSG        PIC  X(19)  VALUE             02140099
021500                                    'OTHR ERROR-SUKCS769'.        02150099
021600     05  PC-CCC-PGM-LINK-ERR        PIC  X(19)  VALUE             02160099
021700                                    'LINK ERR - SUKRF769'.        02170099
021800     05  PC-DIRECTIVE-NOT-SENT-MSG  PIC  X(47)   VALUE            02180099
021900              'ERROR ENCOUNTERED IN COMMON CARTON PGM SUKCS769'.  02190099
022000                                                                  02200099
022100*----------------------------------------------------------------*02210099
022200* PROGRAM SWITCHES                                               *02220099
022300*----------------------------------------------------------------*02230099
022400 01  PS-PROGRAM-SWITCHES.                                         02240099
022500     05  PS-PBS-OVERRIDE-SW              PIC  X(01)  VALUE 'N'.   02250099
022600         88  PS-PBS-OVERRIDE                         VALUE 'Y'.   02260099
022700         88  PS-NO-PBS-OVERRIDE                      VALUE 'N'.   02270099
022800     05  PS-RFID-AUDITS-FOUND-SW         PIC  X(01)  VALUE 'N'.   02280099
022900         88  PS-RFID-AUDITS-FOUND                    VALUE 'Y'.   02290099
023000         88  PS-NO-RFID-AUDITS-FOUND                 VALUE 'N'.   02300099
023100     05  PS-INTERNAL-READER-ENQ-DEQ-IND                           02310099
023200                                        PIC X(01)    VALUE 'D'.   02320099
023300         88  PS-INTERNAL-READER-ENQUEUED             VALUE 'E'.   02330099
023400         88  PS-INTERNAL-READER-DEQUEUED             VALUE 'D'.   02340099
023500     05  PS-ABEND-IND                   PIC X(01)    VALUE 'N'.   02350099
023600         88  PS-NO-ABEND-IN-PROGRESS                 VALUE 'N'.   02360099
023700         88  PS-ABEND-IN-PROGRESS                    VALUE 'Y'.   02370099
023800     05  PS-AUDIT-IS-COMPLETE-SW         PIC  X(01)  VALUE 'N'.   02380099
023900         88  PS-AUDIT-NOT-COMPLETE                   VALUE 'N'.   02390099
024000         88  PS-AUDIT-IS-COMPLETE                    VALUE 'Y'.   02400099
024100     05  PS-RF-AUDIT-IS-COMPLETE-SW      PIC  X(01)  VALUE 'N'.   02410099
024200         88  PS-RF-AUDIT-NOT-COMPLETE                VALUE 'N'.   02420099
024300         88  PS-RF-AUDIT-IS-COMPLETE                 VALUE 'Y'.   02430099
024400     05  PS-MULTIPLE-FAILS-IND           PIC  X(01)  VALUE 'N'.   02440099
024500         88  PS-MULTIPLE-FAILS                       VALUE 'Y'.   02450099
024600         88  PS-NO-MULTIPLE-FAILS                    VALUE 'N'.   02460099
024700     05  PS-VALID-INPUT-SW               PIC  X(01)  VALUE 'Y'.   02470099
024800         88  PS-VALID-INPUT                          VALUE 'Y'.   02480099
024900         88  PS-INVALID-INPUT                        VALUE 'N'.   02490099
025000     05  PS-AUDIT-SW                     PIC  X(01)  VALUE ' '.   02500099
025100         88  PS-VALID-AUDIT-NBR                      VALUE 'Y'.   02510099
025200         88  PS-INVALID-AUDIT-NBR                    VALUE 'N'.   02520099
025300     05  PS-EOC-IN-PROCESS-SW            PIC  X(01)  VALUE ' '.   02530099
025400         88  PS-EOC-IN-PROCESS                       VALUE 'Y'.   02540099
025500         88  PS-NOT-EOC-IN-PROCESS                   VALUE 'N'.   02550099
025600     05  PS-EOC-DC-PROCESS-SW            PIC  X(01)  VALUE ' '.   02560099
025700         88  PS-EOC-DC-PROCESS                       VALUE 'Y'.   02570099
025800         88  PS-NOT-EOC-DC-PROCESS                   VALUE 'N'.   02580099
025900     05  PS-PREPK-LNE-CSR-SW             PIC  X(01)  VALUE ' '.   02590099
026000         88  PS-EOC-PREPK-LNE-CSR                    VALUE 'Y'.   02600099
026100         88  PS-NOT-EOC-PREPK-LNE-CSR                VALUE 'N'.   02610099
026200     05  PS-RF-AUDIT-STATUS-SW           PIC  X(01)  VALUE 'I'.   02620099
026300         88  PS-RF-AUDIT-INPROCESS                   VALUE 'I'.   02630099
026400         88  PS-RF-AUDIT-COMPLETE                    VALUE 'N'.   02640099
026500         88  PS-RF-AUDIT-FAILED                      VALUE 'F'.   02650099
026600         88  PS-RF-AUDIT-PASSED                      VALUE 'P'.   02660099
026700     05  PS-QC-AUDIT-STATUS-SW           PIC  X(01)  VALUE 'I'.   02670099
026800         88  PS-QC-AUDIT-INPROCESS                   VALUE 'I'.   02680099
026900         88  PS-QC-AUDIT-COMPLETE                    VALUE 'N'.   02690099
027000         88  PS-QC-AUDIT-FAILED                      VALUE 'F'.   02700099
027100         88  PS-QC-AUDIT-PASSED                      VALUE 'P'.   02710099
027200     05  PS-SECOND-DIRECTIVE-SW          PIC  X(01)  VALUE ' '.   02720099
027300         88  PS-SECOND-DIRECTIVE-YES                 VALUE 'Y'.   02730099
027400         88  PS-SECOND-DIRECTIVE-NO                  VALUE 'N'.   02740099
027500     05  PS-PREPK-RF-CSR-SW              PIC  X(01)  VALUE ' '.   02750099
027600         88  PS-EOC-PREPK-RF-CSR                     VALUE 'Y'.   02760099
027700         88  PS-NOT-EOC-PREPK-RF-CSR                 VALUE 'N'.   02770099
027710     05  PS-PRINT-TO-FILE-SW             PIC  X(01)  VALUE 'N'.   02771099
027720         88  PS-PRINT-TO-FILE-YES                    VALUE 'Y'.   02772099
027730         88  PS-PRINT-TO-FILE-NO                     VALUE 'N'.   02773099
027800                                                                  02780099
027900*----------------------------------------------------------------*02790099
028000* PROGRAM VARIABLES                                              *02800099
028100*----------------------------------------------------------------*02810099
028200 01  PV-PROGRAM-VARIABLES.                                        02820099
028300     05  PV-DISP-COUNTS                  PIC 9(09).               02830099
028400     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 02840099
028500     05  PV-SYSTEM-ID.                                            02850099
028600         10  FILLER              PIC  X(04)   VALUE SPACE.        02860099
028700         10  PV-REGION-IND       PIC  X(01).                      02870099
028800             88  PV-TEST-CICS                 VALUE 'T'.          02880099
028900             88  PV-QA-CICS                   VALUE 'Q'.          02890099
029000             88  PV-PROD-CICS                 VALUE 'P'.          02900099
029100             88  PV-LEARN-CICS                VALUE 'L'.          02910099
029200         10  FILLER              PIC X(03)    VALUE SPACES.       02920099
029300     05  PV-DISPLAY-OPER                 PIC  9(4)   VALUE ZEROS. 02930099
029400     05  PV-DISPLAY-AUD-NBR              PIC  9(9)   VALUE ZEROS. 02940099
029500     05  PV-DISP-SHIPT-UNT-ID            PIC 9(18)   VALUE ZEROS. 02950099
029600     05  PV-PASSED-COUNT                 PIC S9(4)  COMP.         02960099
029700     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     02970099
029800                                                     COMP SYNC.   02980099
029900     05  PV-MESSAGE-AREA                 PIC  X(19)  VALUE SPACE. 02990099
030000     05  PV-CICS-RESPONSE                PIC S9(09)  VALUE ZEROS  03000099
030100                                                     COMP SYNC.   03010099
030200     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACE. 03020099
030300     05  PV-PBS-AUDIT-IND                PIC  X(25).              03030099
030400     05  PV-TRANSFER-PROGRAM             PIC  X(08)  VALUE SPACE. 03040099
030500     05  PV-DB2-COUNT                    PIC S9(09)  VALUE ZERO   03050099
030600                                                     COMP.        03060099
030700     05  PV-IP-AUDITS                    PIC S9(09)  VALUE ZERO   03070099
030800                                                     COMP.        03080099
030900     05  PV-PROGRAM-DATA.                                         03090099
031000         10  PV-AUDIT-IND                PIC X(01).               03100099
031100         10  PV-PROMPT-IND               PIC X(01).               03110099
031200     05  PV-OPER-UNIT-ID-X.                                       03120099
031300         10  PV-OPER-UNIT-ID             PIC 9(04).               03130099
031400     05  PV-AUDIT-NUMBER-X.                                       03140099
031500         10  PV-AUDIT-NUMBER             PIC 9(09).               03150099
031600     05  PV-TOTAL-CARTONS-X.                                      03160099
031700         10  PV-TOTAL-CARTONS            PIC ZZZ9.                03170099
031800     05  PV-AUDITED-CARTONS-X.                                    03180099
031900         10  PV-AUDITED-CARTONS          PIC ZZZ9.                03190099
032000     05  PV-TOTAL-UNITS-X.                                        03200099
032100         10  PV-TOTAL-UNITS              PIC ZZZ9.                03210099
032200     05  PV-AUDITED-UNITS-X.                                      03220099
032300         10  PV-AUDITED-UNITS            PIC ZZZ9.                03230099
032400     05  PV-AUDIT-ERR-PCT-X.                                      03240099
032500         10  PV-AUDIT-ERR-PCT            PIC ZZ9.                 03250099
032600     05  PV-AUDIT-ERR-PCT-TOT            PIC 999999.              03260099
032700     05  PV-PICK-ERRORS-X.                                        03270099
032800         10  PV-PICK-ERRORS              PIC ZZZZ9.               03280099
032900                                                                  03290099
033000     05  PV-RFID-ERRORS-X.                                        03300099
033100         10  PV-RFID-ERRORS              PIC ZZZZ9.               03310099
033200     05  PV-TICKET-ERRORS-HOLD           PIC S9(09) COMP.         03320099
033300     05  PV-RFID-TOT-ERRORS              PIC 9(4).                03330099
033400     05  PV-RFID-TOT-ERRORS-X            PIC ZZZ9.                03340099
033500     05  PV-NON-TAG-UNITS                PIC  S9(9) COMP.         03350099
033600                                                                  03360099
033700     05  PV-PACK-ERRORS-X.                                        03370099
033800         10  PV-PACK-ERRORS              PIC ZZZZ9.               03380099
033900     05  PV-TICKET-ERRORS-X.                                      03390099
034000         10  PV-TICKET-ERRORS            PIC ZZZZ9.               03400099
034100     05  PV-DISPLAY-PO-NBR               PIC S9(09).              03410099
034200     05  PV-DISPLAY-PREPK-ID             PIC S9(04).              03420099
034300     05  PV-DISPLAY-PO-LINE-NBR          PIC S9(09).              03430099
034400     05  PV-DISPLAY-RECVR                PIC S9(09).              03440099
034500     05  PV-DISPLAY-AUDIT-CNTL-NBR       PIC  9(09).              03450099
034600     05  PV-LIMIT-DAYS                   PIC S9(09) COMP.         03460099
034700     05  PV-IP-AUDITS-SW                 PIC  X(01).              03470099
034800     05  PV-CA-PICK-ERRORS               PIC S9(09) COMP.         03480099
034900     05  PV-CA-PACK-ERRORS               PIC S9(09) COMP.         03490099
035000     05  PV-CA-TICKET-ERRORS             PIC S9(09) COMP.         03500099
035100     05  PV-AUDIT-ERROR-PCT              PIC S999V99  COMP-3.     03510099
035200                                                                  03520099
035300******************************************************************03530099
035400*    COMMON CARTON CLOSE COMMUNICATION AREA                       03540099
035500******************************************************************03550099
035600     COPY SUWS091.                                                03560099
047800                                                                  04780099
047900                                                                  04790099
048000*----------------------------------------------------------------*04800099
048100*  GENERATED DSECT FOR THE SUKM536 MAPSET                         04810099
048200*----------------------------------------------------------------*04820099
048300     COPY SUKM536.                                                04830099
048400                                                                  04840099
048500*----------------------------------------------------------------*04850099
048600*  SENDING/RECEIVING AREA FOR THE NUMERIC EDIT ROUTINE (DPKUT100) 04860099
048700*----------------------------------------------------------------*04870099
048800     COPY DPWS010I.                                               04880099
048900                                                                  04890099
049000*----------------------------------------------------------------*04900099
049100*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               04910099
049200*----------------------------------------------------------------*04920099
049300     COPY DPWS013.                                                04930099
049400                                                                  04940099
049500*----------------------------------------------------------------*04950099
049600*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST   04960099
049700*----------------------------------------------------------------*04970099
049800     COPY DPWS015.                                                04980099
049900                                                                  04990099
050000*----------------------------------------------------------------*05000099
050100* HELP SCREEN COMMAREA                                            05010099
050200     COPY PCWS192.                                                05020099
050300*----------------------------------------------------------------*05030099
050400* HELP SCREEN WORK AREA                                           05040099
050500     COPY PCWS188.                                                05050099
050600                                                                  05060099
050700******************************************************************05070099
050800*  COPY BOOK CONTAINING ERROR/WARNING/INFORMATIONAL MESSAGES      05080099
050900*  TO BE DISPLAYED ON THE LRT                                     05090099
051000******************************************************************05100099
051100     COPY SUWS005.                                                05110099
051200                                                                  05120099
051300*----------------------------------------------------------------*05130099
051400*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      05140099
051500*----------------------------------------------------------------*05150099
051600     COPY DFHAID.                                                 05160099
051700                                                                  05170099
051800*---------------------------------------------------------------* 05180099
051900*    DB2 AREA FOR THE PO AUDIT REQUEST TABLE (SUT_PO_AUD_REQ)   * 05190099
052000*---------------------------------------------------------------* 05200099
052100     EXEC SQL                                                     05210099
052200         INCLUDE SUT00015                                         05220099
052300     END-EXEC.                                                    05230099
052400*---------------------------------------------------------------* 05240099
052500*    DB2 AREA FOR THE PO AUDIT PARM TABLE (SUT_PO_AUD_PARM)     * 05250099
052600*---------------------------------------------------------------* 05260099
052700     EXEC SQL                                                     05270099
052800         INCLUDE SUT00017                                         05280099
052900     END-EXEC.                                                    05290099
053000*---------------------------------------------------------------* 05300099
053100*    DB2 AREA FOR THE SHIPPING UNIT EXCEPTION TABLE             * 05310099
053200*---------------------------------------------------------------* 05320099
053300     EXEC SQL                                                     05330099
053400         INCLUDE TSUEXCP                                          05340099
053500     END-EXEC.                                                    05350099
053600                                                                  05360099
053700******************************************************************05370099
053800*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      05380099
053900*  AUDIT CONTENT TABLE (TSUAUPC)                                  05390099
054000******************************************************************05400099
054100     EXEC SQL                                                     05410099
054200         INCLUDE TSUAUPC                                          05420099
054300     END-EXEC.                                                    05430099
054400                                                                  05440099
054500******************************************************************05450099
054600*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE COMPANY CONTROL    05460099
054700*  TABLE (TCOCNTL)                                                05470099
054800******************************************************************05480099
054900     EXEC SQL                                                     05490099
055000         INCLUDE TCOCNTL                                          05500099
055100     END-EXEC.                                                    05510099
055200                                                                  05520099
055300*---------------------------------------------------------------* 05530099
055400*    DB2 AREA FOR THE RECEIVING SYSTEM PARM TABLE               * 05540099
055500*---------------------------------------------------------------* 05550099
055600     EXEC SQL                                                     05560099
055700         INCLUDE TKRPRPM                                          05570099
055800     END-EXEC.                                                    05580099
055810                                                                  05581099
055900*---------------------------------------------------------------* 05590099
056000*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      05600099
056100*  AUDIT TABLE (TSUNAUD)                                          05610099
056200*---------------------------------------------------------------* 05620099
056300     EXEC SQL                                                     05630099
056400         INCLUDE TSUNAUD                                          05640099
056500     END-EXEC.                                                    05650099
056600                                                                  05660099
056700******************************************************************05670099
056800*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      05680099
056900*  AUDIT TRANSATIONS(CARTONS) TABLE (TSUATRN)                     05690099
057000******************************************************************05700099
057100     EXEC SQL                                                     05710099
057200         INCLUDE TSUATRN                                          05720099
057300     END-EXEC.                                                    05730099
057400                                                                  05740099
057500******************************************************************05750099
057600*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE DISTRIBUTION       05760099
057700*  HEADER TABLE                                                   05770099
057800******************************************************************05780099
057900     EXEC SQL                                                     05790099
058000         INCLUDE TDISTHD                                          05800099
058100     END-EXEC.                                                    05810099
058200                                                                  05820099
058300******************************************************************05830099
058400*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE RECEIVER           05840099
058500*  ITEM TABLE                                                     05850099
058600******************************************************************05860099
058700     EXEC SQL                                                     05870099
058800         INCLUDE TRECITM                                          05880099
058900     END-EXEC.                                                    05890099
059000                                                                  05900099
059100*---------------------------------------------------------------* 05910099
059200*  COMMUNICATIONS AREA FOR DB2                                    05920099
059300*---------------------------------------------------------------* 05930099
059400     EXEC SQL                                                     05940099
059500         INCLUDE SQLCA                                            05950099
059600     END-EXEC.                                                    05960099
059700                                                                  05970099
059800     EXEC SQL                                                     05980099
059900         DECLARE IN_PROCESS_CURSOR CURSOR FOR                     05990099
060000          SELECT AUD_CNTL_NBR                                     06000099
060100          FROM   SUT_PO_AUD_REQ                                   06010099
060200          WHERE  PO_NBR         = :DK-PO-NBR                      06020099
060300            AND  PO_LNE_NBR     = :DK-PO-LINE-NBR                 06030099
060400            AND  PO_PREPK_ID    = :DK-PREPK-ID                    06040099
060500            AND  AUD_STAT_CDE   = :PC-I                           06050099
060600            AND  DAYS(CRE_TMST) > :PV-LIMIT-DAYS                  06060099
060700     END-EXEC.                                                    06070099
060800                                                                  06080099
060900     EXEC SQL                                                     06090099
061000         DECLARE IN_PROCESS_DC_CSR CURSOR FOR                     06100099
061100          SELECT AUD_CNTL_NBR                                     06110099
061200          FROM   SUT_PO_AUD_REQ                                   06120099
061300          WHERE  PO_NBR         = :DK-PO-NBR                      06130099
061400            AND  PO_LNE_NBR     = :DK-PO-LINE-NBR                 06140099
061500            AND  PO_PREPK_ID    = :DK-PREPK-ID                    06150099
061600            AND  OPER_UNT_ID    = :DK-OPER-UNT-ID                 06160099
061700            AND  AUD_STAT_CDE   = :PC-I                           06170099
061800            AND  DAYS(CRE_TMST) > :PV-LIMIT-DAYS                  06180099
061900     END-EXEC.                                                    06190099
062000                                                                  06200099
062100******************************************************************06210099
062200***CURSOR TO RETURN LINES IN A PREPK                            **06220099
062300******************************************************************06230099
062400     EXEC SQL                                                     06240099
062500         DECLARE PREPK_LNE_CSR CURSOR FOR                         06250099
062600          SELECT DISTINCT                                         06260099
062700                 ORD_LNE_NBR                                      06270099
062800          FROM  TRECITM                                           06280099
062900          WHERE ORD_NBR          =  :RECITM-ORD-NBR               06290099
063000           AND  REC_SEQ_NBR      =  :RECITM-REC-SEQ-NBR           06300099
063100           AND  PREPK_ID         =  :RECITM-PREPK-ID              06310099
063200     END-EXEC.                                                    06320099
063300                                                                  06330099
063400******************************************************************06340099
063500***CURSOR TO RETURN LINES FOR A RF PREPK                        **06350099
063600******************************************************************06360099
063700     EXEC SQL                                                     06370099
063800         DECLARE PREPK_RFLNE_CSR CURSOR FOR                       06380099
063900          SELECT DISTINCT                                         06390099
064000                 ORD_LNE_NBR                                      06400099
064100          FROM  TRECITM                                           06410099
064200          WHERE ORD_NBR          =  :RECITM-ORD-NBR               06420099
064300           AND  REC_SEQ_NBR      =  :RECITM-REC-SEQ-NBR           06430099
064400           AND  VER_STATUS_CDE   =  :PC-A                         06440099
064500     END-EXEC.                                                    06450099
064600                                                                  06460099
064700***************************************************************** 06470099
064800 LINKAGE SECTION.                                                 06480099
064900******************************************************************06490099
065000 01  DFHCOMMAREA.                                                 06500099
065100     05  FILLER                       OCCURS 1 TO 4072 TIMES      06510099
065200                                      DEPENDING ON EIBCALEN.      06520099
065300         10  FILLER                   PIC X.                      06530099
065400                                                                  06540099
065500******************************************************************06550099
065600 PROCEDURE DIVISION.                                              06560099
065700******************************************************************06570099
065800 0000-PROGRAM-MAINLINE.                                           06580099
065900                                                                  06590099
066000     MOVE DFHCOMMAREA TO CA-COMMAREA.                             06600099
066100                                                                  06610099
066200     EVALUATE TRUE                                                06620099
066300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 06630099
066400             CONTINUE                                             06640099
066500         WHEN OTHER                                               06650099
066600            MOVE '0000-PROGRAM-MAINLINE' TO DP013-PARAGRAPH       06660099
066700            MOVE 'UNABLE TO ASSIGN USER-ID'                       06670099
066800              TO DP013-MESSAGE-TEXT (1)                           06680099
066900            SET DP013-LOGIC-ABEND        TO TRUE                  06690099
067000            SET DP013-NO-ROLLBACK        TO TRUE                  06700099
067100            PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                06710099
067200     END-EVALUATE.                                                06720099
067300                                                                  06730099
067400                                                                  06740099
067500     EVALUATE TRUE                                                06750099
067600         WHEN EIBCALEN = ZERO                                     06760099
067700             MOVE PC-ENTER-THROUGH-MENU-MSG TO PV-MESSAGE-AREA    06770099
067800             PERFORM 8300-RETURN                                  06780099
067900                                                                  06790099
068000****************************************************************  06800099
068100* DPKRF278 IS THE PGM FOR THE HELP SCREEN.                        06810099
068200****************************************************************  06820099
068300         WHEN EIBTRNID = 'Z278'                                   06830099
068400             MOVE DFHCOMMAREA          TO PC192-COMMAREA          06840099
068500             MOVE PC192-HOST-SAVE-AREA TO CA-COMMAREA             06850099
068600             SET SU006-PROCESS-SCREEN  TO TRUE                    06860099
068700             PERFORM 1000-INITIALIZE                              06870099
068800             PERFORM 8000-SEND-MAP                                06880099
068900             PERFORM 8200-RETURN-TRANID                           06890099
069000                                                                  06900099
069100         WHEN SU006-INITIALIZE-SCREEN                             06910099
069200         WHEN EIBAID = DFHCLEAR                                   06920099
069300             SET SU006-PROCESS-SCREEN TO TRUE                     06930099
069400             PERFORM 1000-INITIALIZE                              06940099
069500             MOVE PC-CURRENT-PROGRAM-NAME TO SU006-LAST-PROGRAM   06950099
069600             PERFORM 8000-SEND-MAP                                06960099
069700             PERFORM 8200-RETURN-TRANID                           06970099
069800                                                                  06980099
069900         WHEN EIBAID = DFHPF3 AND                                 06990099
070000              CA-F3-ALLOWED-IND = 'Y'                             07000099
070010                                                                  07001099
070100***   CHECK IF THE AUDIT HAS BEEN CLOSED BEFORE ALLOWING THE      07010099
070200***   RESTART                                                     07020099
070210                                                                  07021099
070300             MOVE SU006-AUDIT-CNTL-NBR    TO                      07030099
070400                              DK-AUDIT-CNTL-NBR                   07040099
070500             PERFORM 2400-SELECT-AUDIT-NBR                        07050099
070600             IF SUT00015-AUD-STAT-CDE = 'F'                       07060099
070700                 INITIALIZE PV-CICS-MSG-AREA2                     07070099
070800                 STRING ' SUKRF536 - AUD CLSD-NO RESTART'         07080099
070900                        ' AUDIT= ' SU006-AUDIT-CNTL-NBR           07090099
071000                      DELIMITED BY SIZE INTO PV-CICS-MSG-AREA2    07100099
071100                 PERFORM 999A-WRITE-CSSL-MSG                      07110099
071200                 INITIALIZE PV-CICS-MSG-AREA2                     07120099
071300                 STRING ' CARTON= ' SU006-SHIP-UNIT-NBR           07130099
071400                      DELIMITED BY SIZE INTO PV-CICS-MSG-AREA2    07140099
071500                 PERFORM 999A-WRITE-CSSL-MSG                      07150099
071600                 MOVE PC-AUD-CLSD-NO-RESTART     TO AMSGLNO       07160099
071700                 MOVE 'N' TO  CA-F3-ALLOWED-IND                   07170099
071800                 PERFORM 8100-SEND-DATA-ONLY                      07180099
071900                 PERFORM 8200-RETURN-TRANID                       07190099
072000             ELSE                                                 07200099
072100                 MOVE PC-CARTON-CLOSE-SCREEN                      07210099
072200                                      TO PV-TRANSFER-PROGRAM      07220099
072300                 PERFORM 4000-XCTL-LRT-MENU                       07230099
072400             END-IF                                               07240099
072500                                                                  07250099
072600         WHEN EIBAID = DFHENTER                                   07260099
072700             SET PS-SECOND-DIRECTIVE-NO TO TRUE                   07270099
072800             IF CA-NO-IP-AUDITS                                   07280099
072810                                                                  07281099
072900*** THIS WILL CLOSE QC AUDIT                                      07290099
073000                 PERFORM 2000-CHECK-FOR-COMPLETION                07300099
073100                 PERFORM 3250-LINK-COMMON-CARTON-CLOSE            07310099
073200                                                                  07320099
073300                 MOVE SU006-PO            TO SUT00015-PO-NBR      07330099
073400                 MOVE SU006-REC-SEQ-NBR   TO                      07340099
073500                                      SUT00015-RCVR-SEQ-NBR       07350099
073600                 PERFORM 2450-SELECT-RFID-AUD                     07360099
073700                 IF SU006-QC-AND-RFID-AUD OR                      07370099
073800                    PS-RFID-AUDITS-FOUND                          07380099
073810                                                                  07381099
073900*** THIS WILL CLOSE RF AUDIT                                      07390099
074000                    PERFORM 2010-CHECK-FOR-COMPL-COMBO            07400099
074100                 END-IF                                           07410099
074110                                                                  07411099
074200*** CHECK FOR CLOSING OR QC AND RF AUDITS                         07420099
074300                 IF SU006-QC-AND-RFID-AUD                         07430099
074400                   IF PS-QC-AUDIT-INPROCESS                       07440099
074500                     IF PS-RF-AUDIT-INPROCESS                     07450099
074510                                                                  07451099
074600*** BOTH AUDITS STILL OPEN - DO NOTHING                           07460099
074700                       CONTINUE                                   07470099
074710                     ELSE                                         07471099
074711                                                                  07471199
074720*** RF AUDIT CLOSED, QC OPEN CHG TO QC AUDIT ONLY                 07472099
074730                       SET SU006-QC-AUD-ONLY TO TRUE              07473099
074740                       SET SU006-QC-AUDIT    TO TRUE              07474099
074750                     END-IF                                       07475099
074760                   ELSE                                           07476099
074770                     IF PS-RF-AUDIT-INPROCESS                     07477099
074771                                                                  07477199
074780*** QC AUDIT CLOSED, RF OPEN CHG TO RF AUDIT ONLY                 07478099
074790                       SET SU006-RFID-AUD-ONLY TO TRUE            07479099
074791                       SET SU006-RFID-AUDIT    TO TRUE            07479199
074792                       MOVE SU006-RFID-AUDIT-CNTL-NBR             07479299
074793                         TO SU006-AUDIT-CNTL-NBR                  07479399
074794                       MOVE ZERO TO SU006-RFID-AUDIT-CNTL-NBR     07479499
074795                     END-IF                                       07479599
074796                   END-IF                                         07479699
074797                 END-IF                                           07479799
074798                                                                  07479899
074799             ELSE                                                 07479999
074800               IF CA-NO-IP-RF-AUDITS                              07480099
074810                                                                  07481099
074900*** NO IN PROCESS RF AUDITS                                       07490099
075000                   MOVE SU006-PO            TO SUT00015-PO-NBR    07500099
075100                   MOVE SU006-REC-SEQ-NBR   TO                    07510099
075200                                          SUT00015-RCVR-SEQ-NBR   07520099
075300                   PERFORM 2450-SELECT-RFID-AUD                   07530099
075400                   IF SU006-RFID-AUD-ONLY                         07540099
075410                                                                  07541099
075500*** ONLY CLOSE RFID AUDIT (RFID ONLY AUDIT)                       07550099
075600                     PERFORM 2000-CHECK-FOR-COMPLETION            07560099
075700                     PERFORM 3250-LINK-COMMON-CARTON-CLOSE        07570099
075800                   ELSE                                           07580099
075810                                                                  07581099
075900*** ONLY CLOSE RFID AUDIT IN COMBO                                07590099
076000                     IF SU006-QC-AND-RFID-AUD OR                  07600099
076100                        PS-RFID-AUDITS-FOUND                      07610099
076200                        PERFORM 2010-CHECK-FOR-COMPL-COMBO        07620099
076300                     END-IF                                       07630099
076400                   END-IF                                         07640099
076500               END-IF                                             07650099
076600             END-IF                                               07660099
076700                                                                  07670099
077400             IF SU006-INSTREAM-AUDIT                              07740099
077500                 IF SU006-AUDIT-INPROCESS                         07750099
077600                     PERFORM 3100-CHECK-OPEN-CARTONS              07760099
077700                     IF PV-DB2-COUNT > 0                          07770099
077800                         SET SU006-AUDIT-POSTPONE   TO TRUE       07780099
077900                         PERFORM 3000-CLOSE-AUDIT                 07790099
078000                     END-IF                                       07800099
078100                 END-IF                                           07810099
078200                 MOVE PC-SU-CARTON-CHECK-IN-PGM                   07820099
078300                                      TO PV-TRANSFER-PROGRAM      07830099
078400                 MOVE SU006-HOST-SAVE-AREA                        07840099
078500                                      TO SU001-COMMON-DATA        07850099
078600                 MOVE SU006-ASGMT-STRT-DTE TO                     07860099
078700                                         SU001-ASGMT-STRT-DTE     07870099
078800                 MOVE SU006-ASGMT-NBR-TXT  TO                     07880099
078900                                         SU001-ASGMT-NBR-TXT      07890099
079000                 MOVE SU006-ASGMT-NBR-SEQ-NBR TO                  07900099
079100                                         SU001-ASGMT-NBR-SEQ-NBR  07910099
079200                 MOVE SU006-DOOR-ID TO SU001-DOOR-ID              07920099
079300                 PERFORM 4100-XCTL-CHECK-IN                       07930099
079400             ELSE                                                 07940099
079500                 MOVE PC-OPEN-CARTON-SCREEN                       07950099
079600                                      TO PV-TRANSFER-PROGRAM      07960099
079700                 PERFORM 4000-XCTL-LRT-MENU                       07970099
079800             END-IF                                               07980099
079900                                                                  07990099
080000         WHEN EIBAID = DFHPF1                                     08000099
080100              PERFORM 1400-HELP-SCREEN                            08010099
080200                                                                  08020099
080300         WHEN OTHER                                               08030099
080400             MOVE PC-UNRECOGNIZED-PF-KEY-MSG TO AMSGLNO           08040099
080500             PERFORM 8100-SEND-DATA-ONLY                          08050099
080600             PERFORM 8200-RETURN-TRANID                           08060099
080700     END-EVALUATE.                                                08070099
080800                                                                  08080099
080900     GOBACK.                                                      08090099
081000                                                                  08100099
081100*                                                                 08110099
081200 1000-INITIALIZE.                                                 08120099
081300*                                                                 08130099
081400     INITIALIZE CA-PROGRAM-COMMAREA.                              08140099
081500     MOVE 0 TO PV-CA-PICK-ERRORS                                  08150099
081600               PV-CA-PACK-ERRORS                                  08160099
081700               PV-CA-TICKET-ERRORS                                08170099
081800               PV-NON-TAG-UNITS                                   08180099
081900               PV-AUDIT-ERROR-PCT.                                08190099
082000     MOVE PC-CURRENT-PROGRAM-NAME TO SU006-LAST-PROGRAM.          08200099
082100     MOVE SU006-AUDIT-CNTL-NBR    TO SU026-AUDIT-NUMBER           08210099
082200                                     DK-AUDIT-CNTL-NBR.           08220099
082300     MOVE SU006-SHIP-UNIT-NBR     TO DK-SHIP-UNIT-NBR.            08230099
082400     MOVE SU006-SHIP-UNIT-NBR-X   TO ACARTONO.                    08240099
082500                                                                  08250099
082600     SET SU026-IN-PROCESS TO TRUE.                                08260099
082700     MOVE SU006-PO                TO DK-PO-NBR.                   08270099
082800     MOVE 'N'                     TO SU026-MULTIPLE-FAILURE-IND.  08280099
082900     MOVE SU006-OPER-UNT-ID       TO SU026-OPER-UNIT-ID.          08290099
083000                                                                  08300099
083100     PERFORM 7000-LINK-SUKCS594.                                  08310099
083200     IF SU006-QC-AUD-ONLY                                         08320099
083300       PERFORM 1100-INIT-QC-AUDIT                                 08330099
083400     ELSE                                                         08340099
083500       IF SU006-QC-AND-RFID-AUD                                   08350099
083510                                                                  08351099
083600*** IF THIS IS A MANUAL GENERATED AUDIT, THERE IS ONLY 1          08360099
083700*** AUDIT NUMBER USED FOR BOTH QC AND RFID AUDITING.              08370099
083800*** FOR SYSTEM GENERATED AUDIT WE NEED TO CLOSE BOTH AUDITS.      08380099
083810                                                                  08381099
083900         IF SU006-SYSTEM-GENERATED-AUDIT                          08390099
084000           PERFORM 1100-INIT-QC-AUDIT                             08400099
084100           MOVE  CA-PICK-ERRORS TO PV-CA-PICK-ERRORS              08410099
084200           MOVE  CA-PACK-ERRORS TO PV-CA-PACK-ERRORS              08420099
084300           MOVE  CA-TICKET-ERRORS TO PV-CA-TICKET-ERRORS          08430099
084400           MOVE  CA-AUDIT-ERROR-PCT TO PV-AUDIT-ERROR-PCT         08440099
084500           MOVE  CA-IP-AUDITS-SW    TO PV-IP-AUDITS-SW            08450099
084600           INITIALIZE CA-PROGRAM-COMMAREA                         08460099
084700           MOVE PV-IP-AUDITS-SW     TO CA-IP-AUDITS-SW            08470099
084800           MOVE PV-CA-PICK-ERRORS   TO CA-PICK-ERRORS             08480099
084900           MOVE PV-CA-PACK-ERRORS   TO CA-PACK-ERRORS             08490099
085000           MOVE PV-CA-TICKET-ERRORS TO CA-TICKET-ERRORS           08500099
085100           MOVE PV-AUDIT-ERROR-PCT  TO CA-AUDIT-ERROR-PCT         08510099
085200           MOVE SU006-RFID-AUDIT-CNTL-NBR                         08520099
085300                                     TO SU026-AUDIT-NUMBER        08530099
085400                                        DK-AUDIT-CNTL-NBR         08540099
085500           MOVE PC-CURRENT-PROGRAM-NAME TO SU006-LAST-PROGRAM     08550099
085600           MOVE 'N'               TO SU026-MULTIPLE-FAILURE-IND   08560099
085700           MOVE SU006-OPER-UNT-ID TO SU026-OPER-UNIT-ID           08570099
085800           PERFORM 7000-LINK-SUKCS594                             08580099
085900           PERFORM 1200-INIT-RF-AUDIT                             08590099
086000           EVALUATE SU026-AUDIT-STATUS-DESC                       08600099
086100              WHEN 'IN PROC'                                      08610099
086200                  SET PS-RF-AUDIT-INPROCESS TO TRUE               08620099
086300              WHEN 'COMPLET'                                      08630099
086400                  SET PS-RF-AUDIT-COMPLETE  TO TRUE               08640099
086500              WHEN 'FAILED '                                      08650099
086600                  SET PS-RF-AUDIT-FAILED    TO TRUE               08660099
086700              WHEN 'PASS   '                                      08670099
086800                  SET PS-RF-AUDIT-PASSED    TO TRUE               08680099
086900           END-EVALUATE                                           08690099
087000         END-IF                                                   08700099
087100       ELSE                                                       08710099
087200         PERFORM 1200-INIT-RF-AUDIT                               08720099
087300       END-IF                                                     08730099
087400     END-IF.                                                      08740099
087700                                                                  08770099
087710                                                                  08771099
087800 1100-INIT-QC-AUDIT.                                              08780099
088000                                                                  08800099
088100     MOVE SU006-AUDIT-CNTL-NBR    TO                              08810099
088200                   DK-AUDIT-CNTL-NBR.                             08820099
088300     PERFORM 2400-SELECT-AUDIT-NBR.                               08830099
088400     MOVE SU026-AUDIT-NUMBER         TO PV-AUDIT-NUMBER.          08840099
088500     MOVE SU026-TOT-TCKT-ERROR-PCT   TO CA-TOT-TCKT-ERROR-PCT.    08850099
088600     MOVE SU026-TCKT-ERROR-PCT       TO CA-TCKT-ERROR-PCT.        08860099
088700     MOVE SU026-PICK-ERROR-PCT       TO CA-PICK-ERROR-PCT.        08870099
088800                                                                  08880099
088900     MOVE PC-APCKH                   TO APCKHO.                   08890099
089000     MOVE PC-AQCCTLH                 TO AQCCTLHO.                 08900099
089100                                                                  08910099
089200     MOVE PV-AUDIT-NUMBER-X          TO AAUDITNO.                 08920099
089300     IF SU026-PACK-ERRORS > 0 OR                                  08930099
089400        SU026-PO-STR-ERROR                                        08940099
089500         MOVE 100                 TO PV-AUDIT-ERR-PCT             08950099
089600     ELSE                                                         08960099
089700         IF SU026-TOT-TCKT-ERROR-PCT > SU026-PICK-ERROR-PCT       08970099
089800             COMPUTE PV-AUDIT-ERR-PCT-TOT =                       08980099
089900                  SU026-TOT-TCKT-ERROR-PCT * 100                  08990099
090000         ELSE                                                     09000099
090100             COMPUTE PV-AUDIT-ERR-PCT-TOT =                       09010099
090200                  SU026-PICK-ERROR-PCT * 100                      09020099
090300         END-IF                                                   09030099
090400         IF PV-AUDIT-ERR-PCT-TOT > 100                            09040099
090500             MOVE 100                 TO PV-AUDIT-ERR-PCT         09050099
090600         ELSE                                                     09060099
090700             MOVE PV-AUDIT-ERR-PCT-TOT                            09070099
090800                                      TO PV-AUDIT-ERR-PCT         09080099
090900         END-IF                                                   09090099
091000     END-IF.                                                      09100099
091100     IF SU026-PO-STR-ERROR                                        09110099
091200         MOVE PC-CARTON-LEVEL-ERROR-MSG                           09120099
091300                                  TO ACRTERRO                     09130099
091400     END-IF.                                                      09140099
091500     IF SU026-PACK-ERRORS > 0                                     09150099
091600         MOVE 1.00                TO CA-AUDIT-ERROR-PCT           09160099
091700     ELSE                                                         09170099
091800         IF SU026-TCKT-ERROR-PCT  > SU026-PICK-ERROR-PCT          09180099
091900             MOVE SU026-TCKT-ERROR-PCT                            09190099
092000                                  TO CA-AUDIT-ERROR-PCT           09200099
092100         ELSE                                                     09210099
092200             MOVE SU026-PICK-ERROR-PCT                            09220099
092300                                  TO CA-AUDIT-ERROR-PCT           09230099
092400         END-IF                                                   09240099
092500     END-IF.                                                      09250099
092600                                                                  09260099
092700     MOVE SU006-AUDIT-CNTL-NBR    TO                              09270099
092800                              DK-AUDIT-CNTL-NBR.                  09280099
092900     PERFORM 2400-SELECT-AUDIT-NBR.                               09290099
093000     IF SUT00015-UNT-QTY > 0                                      09300099
093100         MOVE SU026-AUDITED-UNITS TO CA-AUDITED-UNITS             09310099
093200         MOVE SU026-TOTAL-UNITS   TO CA-TOTAL-UNITS               09320099
093300     ELSE                                                         09330099
093400                                                                  09340099
093500         MOVE ZERO                TO CA-AUDITED-UNITS             09350099
093600                                     CA-TOTAL-UNITS               09360099
093700     END-IF.                                                      09370099
093800     MOVE SU026-AUDITED-CARTONS   TO PV-AUDITED-CARTONS           09380099
093900                                     CA-AUDITED-CARTONS.          09390099
094000     MOVE PV-AUDITED-CARTONS-X    TO ACART1O.                     09400099
094100                                                                  09410099
094200     MOVE PC-AQCCRTH              TO AQCCRTHO.                    09420099
094300                                                                  09430099
094400     IF SUT00015-CART-PRMPT-CDE = 'D' OR 'F'                      09440099
094500         PERFORM 3200-SUM-CHECKED-IN-CART                         09450099
094600         MOVE PV-DB2-COUNT                                        09460099
094700                                  TO PV-TOTAL-CARTONS             09470099
094800                                     CA-TOTAL-CARTONS             09480099
094900     ELSE                                                         09490099
095000         MOVE SU026-TOTAL-CARTONS TO PV-TOTAL-CARTONS             09500099
095100                                     CA-TOTAL-CARTONS             09510099
095200     END-IF.                                                      09520099
095300                                                                  09530099
095400     MOVE PC-AQCOFH               TO AQCOFHO.                     09540099
095500                                                                  09550099
095600     MOVE PV-TOTAL-CARTONS-X      TO ACART2O.                     09560099
095700     MOVE SU026-PICK-ERRORS       TO PV-PICK-ERRORS               09570099
095800                                     CA-PICK-ERRORS.              09580099
095900     MOVE PV-PICK-ERRORS-X        TO APICKO.                      09590099
096000     MOVE SU026-PACK-ERRORS       TO PV-PACK-ERRORS               09600099
096100                                     CA-PACK-ERRORS.              09610099
096200     MOVE SU026-PO-STR-ERROR-SW   TO CA-PO-STR-ERRORS.            09620099
096300     MOVE PV-PACK-ERRORS-X        TO APACKO.                      09630099
096400     MOVE SU026-TICKET-ERRORS     TO PV-TICKET-ERRORS             09640099
096500                                     CA-TICKET-ERRORS.            09650099
096600     MOVE PV-TICKET-ERRORS-X      TO ATCKTO.                      09660099
096700                                                                  09670099
096800     MOVE SU006-AUDIT-CNTL-NBR TO DK-AUDIT-CNTL-NBR.              09680099
096900     PERFORM 8500-CHECK-FOR-IP-AUDITS.                            09690099
097000     IF PV-IP-AUDITS > 0                                          09700099
097100         SET CA-IP-AUDITS TO TRUE                                 09710099
097200                                                                  09720099
097300         MOVE PC-AQCSTH           TO AQCSTHO                      09730099
097400                                                                  09740099
097500         MOVE 'MORE IP'           TO AAUDSTAO                     09750099
097600         IF SUT00015-UNT-QTY > 0 AND                              09760099
097700           ((SUT00015-UNT-QTY = SUT00015-AUD-UNT-QTY) OR          09770099
097800            (SUT00015-UNT-QTY < SUT00015-AUD-UNT-QTY))            09780099
097900             MOVE SPACES TO PV-CICS-MSG-AREA2                     09790099
098000             STRING ' SUKRF536 - MORE IP WAS DISPLAYED'           09800099
098100                  DELIMITED BY SIZE INTO PV-CICS-MSG-AREA2        09810099
098200             PERFORM 999A-WRITE-CSSL-MSG                          09820099
098300             PERFORM 1500-DISPLAY-DATA                            09830099
098400         ELSE                                                     09840099
098500             IF SUT00015-CART-QTY = SUT00015-AUD-CART-QTY OR      09850099
098600                SUT00015-CART-QTY < SUT00015-AUD-CART-QTY         09860099
098700                 MOVE SPACES TO PV-CICS-MSG-AREA2                 09870099
098800                 STRING ' SUKRF536 - MORE IP WAS DISPLAYED'       09880099
098900                      DELIMITED BY SIZE INTO PV-CICS-MSG-AREA2    09890099
099000                 PERFORM 999A-WRITE-CSSL-MSG                      09900099
099100                 PERFORM 1500-DISPLAY-DATA                        09910099
099200             END-IF                                               09920099
099300         END-IF                                                   09930099
099400     ELSE                                                         09940099
099500         SET CA-NO-IP-AUDITS TO TRUE                              09950099
099600         PERFORM 2050-CHECK-AUDIT                                 09960099
099700         PERFORM 8400-SELECT-TKRPRPM                              09970099
099800         PERFORM 8450-SELECT-PBS-IND                              09980099
099900         IF SUT00015-PKGNG-TYP-CDE = 'PS' AND                     09990099
100000            SUT00015-CART-PRMPT-CDE NOT = 'D' AND                 10000099
100100            PV-PBS-AUDIT-IND = 'Y'                                10010099
100200             SET PS-PBS-OVERRIDE TO TRUE                          10020099
100300         ELSE                                                     10030099
100400             SET PS-NO-PBS-OVERRIDE TO TRUE                       10040099
100500         END-IF                                                   10050099
100600         IF PS-AUDIT-IS-COMPLETE                                  10060099
100700             IF CA-AUDIT-ERROR-PCT > KRPRPM-FUNC-PCT OR           10070099
100800                CA-AUDIT-ERROR-PCT = KRPRPM-FUNC-PCT OR           10080099
100900                CA-PACK-ERRORS > 0 OR                             10090099
101000                CA-PO-STR-ERRORS = 'Y'                            10100099
101100                                                                  10110099
101200                 MOVE PC-AQCSTH           TO AQCSTHO              10120099
101300                                                                  10130099
101400                 MOVE 'FAILED '           TO AAUDSTAO             10140099
101500             ELSE                                                 10150099
101600                                                                  10160099
101700                 MOVE PC-AQCSTH           TO AQCSTHO              10170099
101800                                                                  10180099
101900                 MOVE 'OKAY   '           TO AAUDSTAO             10190099
102000             END-IF                                               10200099
102100         ELSE                                                     10210099
102200             IF (CA-AUDIT-ERROR-PCT > KRPRPM-FUNC-PCT AND         10220099
102300                PS-NO-PBS-OVERRIDE) OR                            10230099
102400                (CA-AUDIT-ERROR-PCT = KRPRPM-FUNC-PCT AND         10240099
102500                PS-NO-PBS-OVERRIDE) OR                            10250099
102600                CA-PACK-ERRORS > 0 OR                             10260099
102700                CA-PO-STR-ERRORS = 'Y'                            10270099
102800                                                                  10280099
102900                 MOVE PC-AQCSTH           TO AQCSTHO              10290099
103000                                                                  10300099
103100                 MOVE 'FAILED '           TO AAUDSTAO             10310099
103200             ELSE                                                 10320099
103300                 IF SU026-AUDIT-STATUS-DESC = 'COMPLET'           10330099
103400                                                                  10340099
103500                     MOVE PC-AQCSTH           TO AQCSTHO          10350099
103600                                                                  10360099
103700                     MOVE 'OKAY   '           TO AAUDSTAO         10370099
103800                 ELSE                                             10380099
103900                                                                  10390099
104000                     MOVE PC-AQCSTH           TO AQCSTHO          10400099
104100                                                                  10410099
104200                     MOVE 'IN PROC'           TO AAUDSTAO         10420099
104300                     SET CA-IP-AUDITS         TO TRUE             10430099
104400                 END-IF                                           10440099
104500             END-IF                                               10450099
104600         END-IF                                                   10460099
104700     END-IF.                                                      10470099
104800     IF AAUDSTAO = 'FAILED ' OR                                   10480099
104900        AAUDSTAO = 'OKAY   '                                      10490099
105000                                                                  10500099
105100         MOVE PC-AQCOFH               TO AQCOFHO                  10510099
105200                                                                  10520099
105300         MOVE ACART1O                 TO ACART2O                  10530099
105400     END-IF.                                                      10540099
105500     IF (AAUDSTAO = 'FAILED ' OR                                  10550099
105600         AAUDSTAO = 'IN PROC' OR                                  10560099
105700         AAUDSTAO = 'MORE IP') AND                                10570099
105800        SU026-NO-PO-STR-ERROR                                     10580099
105900         MOVE PC-ENT-CONT-F3-RESTART-MSG TO AMSGLNO               10590099
106000         MOVE 'Y' TO  CA-F3-ALLOWED-IND                           10600099
106100     ELSE                                                         10610099
106200         MOVE PC-ENTER-TO-CONTINUE-MSG   TO AMSGLNO               10620099
106300         MOVE 'N' TO  CA-F3-ALLOWED-IND                           10630099
106400     END-IF.                                                      10640099
106500                                                                  10650099
106600     IF AAUDSTAO = 'IN PROC'                                      10660099
106700         IF SUT00015-UNT-QTY > 0 AND                              10670099
106800           ((SUT00015-UNT-QTY = SUT00015-AUD-UNT-QTY) OR          10680099
106900            (SUT00015-UNT-QTY < SUT00015-AUD-UNT-QTY))            10690099
107000             MOVE SPACES TO PV-CICS-MSG-AREA2                     10700099
107100             STRING ' SUKRF536 - STILL IN PROCESS'                10710099
107200                  DELIMITED BY SIZE INTO PV-CICS-MSG-AREA2        10720099
107300             PERFORM 999A-WRITE-CSSL-MSG                          10730099
107400             PERFORM 1500-DISPLAY-DATA                            10740099
107500         ELSE                                                     10750099
107600             IF SUT00015-CART-QTY = SUT00015-AUD-CART-QTY OR      10760099
107700                SUT00015-CART-QTY < SUT00015-AUD-CART-QTY         10770099
107800                 MOVE SPACES TO PV-CICS-MSG-AREA2                 10780099
107900                 STRING ' SUKRF536 - STILL IN PROCESS'            10790099
108000                      DELIMITED BY SIZE INTO PV-CICS-MSG-AREA2    10800099
108100                 PERFORM 999A-WRITE-CSSL-MSG                      10810099
108200                 PERFORM 1500-DISPLAY-DATA                        10820099
108300             END-IF                                               10830099
108400         END-IF                                                   10840099
108500     END-IF.                                                      10850099
108600                                                                  10860099
108700     EVALUATE SU026-AUDIT-STATUS-DESC                             10870099
108800         WHEN 'IN PROC'                                           10880099
108900              SET CA-AUDIT-INPROCESS TO TRUE                      10890099
109000         WHEN 'COMPLET'                                           10900099
109100              SET CA-AUDIT-COMPLETE  TO TRUE                      10910099
109200         WHEN 'FAILED '                                           10920099
109300              SET CA-AUDIT-FAILED    TO TRUE                      10930099
109400         WHEN 'PASS   '                                           10940099
109500              SET CA-AUDIT-PASSED    TO TRUE                      10950099
109600     END-EVALUATE.                                                10960099
109700                                                                  10970099
110400                                                                  11040099
110500 1200-INIT-RF-AUDIT.                                              11050099
110600                                                                  11060099
110700     IF SU006-QC-AND-RFID-AUD                                     11070099
110800       AND SU006-SYSTEM-GENERATED-AUDIT                           11080099
110900       MOVE SU006-RFID-AUDIT-CNTL-NBR    TO                       11090099
111000                                DK-AUDIT-CNTL-NBR                 11100099
111100     ELSE                                                         11110099
111200       MOVE SU006-AUDIT-CNTL-NBR    TO                            11120099
111300                                DK-AUDIT-CNTL-NBR                 11130099
111400     END-IF.                                                      11140099
111500     PERFORM 2400-SELECT-AUDIT-NBR.                               11150099
111600     MOVE SU026-AUDIT-NUMBER         TO PV-AUDIT-NUMBER.          11160099
111700     MOVE PC-ARFCTLH                 TO ARFCTLHO.                 11170099
111800     MOVE PV-AUDIT-NUMBER-X          TO ARFAUNMO.                 11180099
111900     IF SUT00015-UNT-QTY > 0                                      11190099
112000         MOVE SU026-AUDITED-UNITS TO CA-AUDITED-UNITS-RF          11200099
112100         MOVE SU026-TOTAL-UNITS   TO CA-TOTAL-UNITS-RF            11210099
112200     ELSE                                                         11220099
112300                                                                  11230099
112400         MOVE ZERO                TO CA-AUDITED-UNITS-RF          11240099
112500                                     CA-TOTAL-UNITS-RF            11250099
112600     END-IF.                                                      11260099
112700     MOVE PC-ARFCRTH              TO ARFCRTHO.                    11270099
112800                                                                  11280099
113700     MOVE SUT00015-CART-QTY   TO PV-TOTAL-CARTONS                 11370099
113800                                 CA-TOTAL-CARTONS-RF.             11380099
113900     MOVE SU026-AUDITED-CARTONS   TO PV-AUDITED-CARTONS           11390099
114000                                     CA-AUDITED-CARTONS-RF.       11400099
114100     MOVE PV-AUDITED-CARTONS-X    TO ARFCRT1O.                    11410099
114200     MOVE PC-ARFOFH               TO ARFOFHO.                     11420099
114300     MOVE PV-TOTAL-CARTONS-X      TO ARFCRT2O.                    11430099
114400     MOVE PC-ARFCRLH              TO ARFCRLHO.                    11440099
114500                                                                  11450099
114600     PERFORM 8500-CHECK-FOR-IP-AUDITS.                            11460099
114700      IF PV-IP-AUDITS  > 0                                        11470099
114800         SET CA-IP-RF-AUDITS TO TRUE                              11480099
114900         MOVE PC-ARFSTH           TO ARFSTHO                      11490099
115000         MOVE 'MORE IP'           TO ARFAUSTO                     11500099
115100         IF SUT00015-UNT-QTY > 0 AND                              11510099
115200           ((SUT00015-UNT-QTY = SUT00015-AUD-UNT-QTY) OR          11520099
115300            (SUT00015-UNT-QTY < SUT00015-AUD-UNT-QTY))            11530099
115400             MOVE SPACES TO PV-CICS-MSG-AREA2                     11540099
115500             STRING ' SUKRF536 - MORE IP WAS DISPLAYED'           11550099
115600                  DELIMITED BY SIZE INTO PV-CICS-MSG-AREA2        11560099
115700             PERFORM 999A-WRITE-CSSL-MSG                          11570099
115800             PERFORM 1500-DISPLAY-DATA                            11580099
115900         ELSE                                                     11590099
116000             IF SUT00015-CART-QTY = SUT00015-AUD-CART-QTY OR      11600099
116100                SUT00015-CART-QTY < SUT00015-AUD-CART-QTY         11610099
116200                 MOVE SPACES TO PV-CICS-MSG-AREA2                 11620099
116300                 STRING ' SUKRF536A- MORE IP WAS DISPLAYED'       11630099
116400                      DELIMITED BY SIZE INTO PV-CICS-MSG-AREA2    11640099
116500                 PERFORM 999A-WRITE-CSSL-MSG                      11650099
116600                 PERFORM 1500-DISPLAY-DATA                        11660099
116700             END-IF                                               11670099
116800         END-IF                                                   11680099
116900     ELSE                                                         11690099
117000         SET CA-NO-IP-RF-AUDITS TO TRUE                           11700099
117100         PERFORM 2055-CHECK-RF-AUDIT                              11710099
117200         PERFORM 8400-SELECT-TKRPRPM                              11720099
117300         PERFORM 8450-SELECT-PBS-IND                              11730099
117310                                                                  11731099
117400*** THIS IS THE NUMBER OF  UPC'S WITH ERRORS.                     11740099
117410                                                                  11741099
117500         MOVE SU026-RFID-ERRORS           TO PV-RFID-ERRORS       11750099
117600         IF PS-RF-AUDIT-IS-COMPLETE                               11760099
117700             IF SU026-RFID-ERRORS > PC-NBR-OF-RF-ERRORS-ALWD      11770099
117800                 MOVE PC-ARFSTH           TO ARFSTHO              11780099
117900                 MOVE 'FAILED '           TO ARFAUSTO             11790099
118000             ELSE                                                 11800099
118100                 MOVE PC-ARFSTH           TO ARFSTHO              11810099
118200                 MOVE 'OKAY   '           TO ARFAUSTO             11820099
118300             END-IF                                               11830099
118400         ELSE                                                     11840099
118500             IF SU026-RFID-ERRORS > PC-NBR-OF-RF-ERRORS-ALWD      11850099
118600                 MOVE PC-ARFSTH           TO ARFSTHO              11860099
118700                 MOVE 'FAILED '           TO ARFAUSTO             11870099
118800             ELSE                                                 11880099
118900                 IF SU026-AUDIT-STATUS-DESC = 'COMPLET'           11890099
119000                     MOVE PC-ARFSTH           TO ARFSTHO          11900099
119100                     MOVE 'OKAY   '           TO ARFAUSTO         11910099
119200                 ELSE                                             11920099
119300                     SET CA-IP-RF-AUDITS TO TRUE                  11930099
119400                     MOVE PC-ARFSTH           TO ARFSTHO          11940099
119500                     MOVE 'IN PROC'           TO ARFAUSTO         11950099
119600                     SET CA-IP-RF-AUDITS TO TRUE                  11960099
119700                 END-IF                                           11970099
119800             END-IF                                               11980099
119900         END-IF                                                   11990099
120000     END-IF.                                                      12000099
120100     IF ARFAUSTO = 'FAILED ' OR                                   12010099
120200        ARFAUSTO = 'OKAY   '                                      12020099
120300         MOVE PC-ARFOFH               TO ARFOFHO                  12030099
120400         MOVE ARFCRT1O                TO ARFCRT2O                 12040099
120500     END-IF.                                                      12050099
120600     IF (ARFAUSTO = 'FAILED ' OR                                  12060099
120700         ARFAUSTO = 'IN PROC' OR                                  12070099
120800         ARFAUSTO = 'MORE IP') AND                                12080099
120900        SU026-NO-PO-STR-ERROR                                     12090099
121000         MOVE PC-ENT-CONT-F3-RESTART-MSG TO AMSGLNO               12100099
121100         MOVE 'Y' TO  CA-F3-ALLOWED-IND                           12110099
121200     ELSE                                                         12120099
121300         MOVE PC-ENTER-TO-CONTINUE-MSG   TO AMSGLNO               12130099
121400         MOVE 'N' TO  CA-F3-ALLOWED-IND                           12140099
121500     END-IF.                                                      12150099
121600                                                                  12160099
121700     IF ARFAUSTO = 'IN PROC'                                      12170099
121800         IF SUT00015-UNT-QTY > 0 AND                              12180099
121900           ((SUT00015-UNT-QTY = SUT00015-AUD-UNT-QTY) OR          12190099
122000            (SUT00015-UNT-QTY < SUT00015-AUD-UNT-QTY))            12200099
122100             MOVE SPACES TO PV-CICS-MSG-AREA2                     12210099
122200             STRING ' SUKRF536 - STILL IN PROCESS'                12220099
122300                  DELIMITED BY SIZE INTO PV-CICS-MSG-AREA2        12230099
122400             PERFORM 999A-WRITE-CSSL-MSG                          12240099
122500             PERFORM 1500-DISPLAY-DATA                            12250099
122600         ELSE                                                     12260099
122700             IF SUT00015-CART-QTY = SUT00015-AUD-CART-QTY OR      12270099
122800                SUT00015-CART-QTY < SUT00015-AUD-CART-QTY         12280099
122900                 MOVE SPACES TO PV-CICS-MSG-AREA2                 12290099
123000                 STRING ' SUKRF536 - STILL IN PROCESS'            12300099
123100                      DELIMITED BY SIZE INTO PV-CICS-MSG-AREA2    12310099
123200                 PERFORM 999A-WRITE-CSSL-MSG                      12320099
123300                 PERFORM 1500-DISPLAY-DATA                        12330099
123400             END-IF                                               12340099
123500         END-IF                                                   12350099
123600     END-IF.                                                      12360099
123700                                                                  12370099
123800** FOR RFID AUDITS ANY ERRORS WILL CAUSE FAILURE                  12380099
123810                                                                  12381099
123900     IF SU026-RFID-ERRORS > PC-NBR-OF-RF-ERRORS-ALWD              12390099
124000       SET SU006-RFID-ERROR         TO TRUE                       12400099
124100     ELSE                                                         12410099
124200       SET SU006-RFID-NO-ERROR      TO TRUE                       12420099
124300     END-IF.                                                      12430099
124400                                                                  12440099
124500     MOVE SU006-SHIP-UNIT-NBR   TO DK-SHIPT-UNIT-ID.              12450099
124600     IF SU006-MANUAL-GENERATED-AUDIT                              12460099
124700       OR SU006-RFID-AUD-ONLY                                     12470099
124800       MOVE SU006-AUDIT-CNTL-NBR    TO                            12480099
124900                                DK-AUDIT-CNTL-NBR                 12490099
125000       PERFORM 2940-SUM-QC-AND-RF-QTY                             12500099
125100       PERFORM 2950-COUNT-NON-EPC-TAG-ERRS                        12510099
125200     ELSE                                                         12520099
125300       MOVE SU006-RFID-AUDIT-CNTL-NBR    TO                       12530099
125400                                DK-AUDIT-CNTL-NBR                 12540099
125500       PERFORM 2940-SUM-QC-AND-RF-QTY                             12550099
125600       PERFORM 2950-COUNT-NON-EPC-TAG-ERRS                        12560099
125700     END-IF.                                                      12570099
125710                                                                  12571099
125800***  THIS IS A CALC OF THE DIFFERENCE IN SCANNED VS RF TAGGED     12580099
125900***  QTY. IT THEN ADDS NBR OF UNITS AFFECTED BY NON-EPC           12590099
126000***  TAG ERRORS (COLOR, SIZE,STYLE) AND ADDS TO PREV QTY FOR      12600099
126100***  TOTAL NBR OF UNITS AFFECTED BY EXCEPTIONS.                   12610099
126110                                                                  12611099
126200     COMPUTE PV-RFID-TOT-ERRORS = SUAUPC-SCND-UNT-QTY -           12620099
126300                                  SUAUPC-RFID-TGD-QTY.            12630099
126400     COMPUTE PV-RFID-TOT-ERRORS = PV-NON-TAG-UNITS +              12640099
126500                                  PV-RFID-TOT-ERRORS.             12650099
126600     MOVE PV-RFID-TOT-ERRORS      TO PV-RFID-TOT-ERRORS-X.        12660099
126700     MOVE PV-RFID-TOT-ERRORS-X    TO ARFERNMO.                    12670099
126800     EVALUATE SU026-AUDIT-STATUS-DESC                             12680099
126900         WHEN 'IN PROC'                                           12690099
127000              SET CA-AUDIT-INPROCESS TO TRUE                      12700099
127100         WHEN 'COMPLET'                                           12710099
127200              SET CA-AUDIT-COMPLETE  TO TRUE                      12720099
127300         WHEN 'FAILED '                                           12730099
127400              SET CA-AUDIT-FAILED    TO TRUE                      12740099
127500         WHEN 'PASS   '                                           12750099
127600              SET CA-AUDIT-PASSED    TO TRUE                      12760099
127700     END-EVALUATE.                                                12770099
127800                                                                  12780099
127900                                                                  12790099
128030 1400-HELP-SCREEN.                                                12803099
128100     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM      12810099
128200     MOVE 'SUKRF536'                  TO PC192-PROGRAM-NAME       12820099
128300     COPY PCPD188.                                                12830099
128400     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      12840099
128500     PERFORM 4200-XCTL-TO-HELP.                                   12850099
128600                                                                  12860099
128700 1500-DISPLAY-DATA.                                               12870099
128800     MOVE SPACES TO PV-CICS-MSG-AREA2.                            12880099
128900     MOVE SUT00015-CART-QTY     TO PV-DISP-COUNTS.                12890099
129000     STRING ' CARTON QTY = ' PV-DISP-COUNTS                       12900099
129100          DELIMITED BY SIZE INTO PV-CICS-MSG-AREA2.               12910099
129200     PERFORM 999A-WRITE-CSSL-MSG.                                 12920099
129300     MOVE SPACES TO PV-CICS-MSG-AREA2.                            12930099
129400     MOVE SUT00015-UNT-QTY      TO PV-DISP-COUNTS.                12940099
129500     STRING ' UNIT QTY = ' PV-DISP-COUNTS                         12950099
129600          DELIMITED BY SIZE INTO PV-CICS-MSG-AREA2.               12960099
129700     PERFORM 999A-WRITE-CSSL-MSG.                                 12970099
129800     MOVE SPACES TO PV-CICS-MSG-AREA2.                            12980099
129900     MOVE SUT00015-AUD-CART-QTY TO PV-DISP-COUNTS.                12990099
130000     STRING ' AUDIT CARTON QTY = ' PV-DISP-COUNTS                 13000099
130100          DELIMITED BY SIZE INTO PV-CICS-MSG-AREA2.               13010099
130200     PERFORM 999A-WRITE-CSSL-MSG.                                 13020099
130300     MOVE SPACES TO PV-CICS-MSG-AREA2.                            13030099
130400     MOVE SUT00015-AUD-UNT-QTY  TO PV-DISP-COUNTS.                13040099
130500     STRING ' AUDIT UNIT QTY = ' PV-DISP-COUNTS                   13050099
130600          DELIMITED BY SIZE INTO PV-CICS-MSG-AREA2.               13060099
130700     PERFORM 999A-WRITE-CSSL-MSG.                                 13070099
130800     MOVE SPACES TO PV-CICS-MSG-AREA2.                            13080099
130900     STRING ' USER = ' SU006-USERID                               13090099
131000        DELIMITED BY SIZE INTO PV-CICS-MSG-AREA2.                 13100099
131100     PERFORM 999A-WRITE-CSSL-MSG.                                 13110099
131200     MOVE SPACES TO PV-CICS-MSG-AREA2.                            13120099
131300     STRING ' AUDIT= ' SU006-AUDIT-CNTL-NBR                       13130099
131400        DELIMITED BY SIZE INTO PV-CICS-MSG-AREA2.                 13140099
131500     PERFORM 999A-WRITE-CSSL-MSG.                                 13150099
131600     MOVE SPACES TO PV-CICS-MSG-AREA2.                            13160099
131700     STRING ' CART = ' SU006-SHIP-UNIT-NBR                        13170099
131800        DELIMITED BY SIZE INTO PV-CICS-MSG-AREA2.                 13180099
131900     PERFORM 999A-WRITE-CSSL-MSG.                                 13190099
132000                                                                  13200099
132100 2000-CHECK-FOR-COMPLETION.                                       13210099
132200                                                                  13220099
132300     MOVE SU006-OPER-UNT-ID         TO SU047-OPER-UNT-ID.         13230099
132400     MOVE 1                         TO SU047-FCLTY-ID.            13240099
132500     MOVE SU006-PO                  TO SU047-PO-NBR.              13250099
132600     MOVE SU006-REC-SEQ-NBR         TO SU047-REC-SEQ-NBR.         13260099
132700     MOVE ZEROES                    TO SU047-PO-LNE-NBR.          13270099
132800     MOVE ZEROES                    TO SU047-PREPACK-ID.          13280099
132900     MOVE 'SUKRF536'                TO SU047-CALLING-PROGRAM.     13290099
133000     MOVE ZEROES                    TO SU047-INBND-TRIP.          13300099
133100     MOVE SU006-AUDIT-CNTL-NBR      TO SU047-AUDIT-CNTL-NBR.      13310099
133200                                                                  13320099
133300     MOVE CA-TICKET-ERRORS          TO SU047-TICKET-ERRORS.       13330099
133400     IF SU006-RFID-AUDIT                                          13340099
133500       MOVE ZERO                    TO SU047-PICK-ERRORS          13350099
133600                                       SU047-PACK-ERRORS          13360099
133700                                       SU047-PO-STR-ERRORS        13370099
133800       MOVE CA-AUDITED-UNITS-RF     TO SU047-AUDITED-UNITS        13380099
133900       MOVE CA-TOTAL-UNITS-RF       TO SU047-TOTAL-UNITS          13390099
134000       MOVE CA-AUDITED-CARTONS-RF   TO SU047-AUDITED-CARTONS      13400099
134100       MOVE CA-TOTAL-CARTONS-RF     TO SU047-TOTAL-CARTONS        13410099
134200       IF SU006-RFID-ERROR                                        13420099
134300         MOVE CA-TICKET-ERRORS      TO PV-TICKET-ERRORS-HOLD      13430099
134400         MOVE 1                     TO SU047-TICKET-ERRORS        13440099
134500       END-IF                                                     13450099
134600     ELSE                                                         13460099
134700       MOVE CA-PICK-ERRORS          TO SU047-PICK-ERRORS          13470099
134800       MOVE CA-PACK-ERRORS          TO SU047-PACK-ERRORS          13480099
134900       MOVE CA-AUDITED-UNITS        TO SU047-AUDITED-UNITS        13490099
135000       MOVE CA-TOTAL-UNITS          TO SU047-TOTAL-UNITS          13500099
135100       MOVE CA-AUDITED-CARTONS      TO SU047-AUDITED-CARTONS      13510099
135200       MOVE CA-TOTAL-CARTONS        TO SU047-TOTAL-CARTONS        13520099
135300       MOVE CA-PO-STR-ERRORS        TO SU047-PO-STR-ERRORS        13530099
135400     END-IF.                                                      13540099
135500     MOVE CA-AUDIT-ERROR-PCT        TO SU047-AUDIT-ERROR-PCT.     13550099
135600     MOVE CA-TOT-TCKT-ERROR-PCT     TO SU047-TOT-TCKT-ERROR-PCT.  13560099
135700     MOVE CA-TCKT-ERROR-PCT         TO SU047-TCKT-ERROR-PCT.      13570099
135800     MOVE CA-PICK-ERROR-PCT         TO SU047-PICK-ERROR-PCT.      13580099
135900                                                                  13590099
136000     MOVE SU006-USERID              TO SU047-USER-ID.             13600099
136100                                                                  13610099
136200     PERFORM 7010-LINK-SUKCS763.                                  13620099
136300                                                                  13630099
136400     MOVE SU047-PICK-ERRORS       TO CA-PICK-ERRORS.              13640099
136500     MOVE SU047-PACK-ERRORS       TO CA-PACK-ERRORS.              13650099
136600     MOVE SU047-AUDIT-ERROR-PCT   TO CA-AUDIT-ERROR-PCT.          13660099
136700     MOVE SU047-AUDITED-UNITS     TO CA-AUDITED-UNITS.            13670099
136800     MOVE SU047-TOTAL-UNITS       TO CA-TOTAL-UNITS.              13680099
136900     MOVE SU047-AUDITED-CARTONS   TO CA-AUDITED-CARTONS.          13690099
137000     MOVE SU047-TOTAL-CARTONS     TO CA-TOTAL-CARTONS.            13700099
137100     MOVE SU047-PO-STR-ERRORS     TO CA-PO-STR-ERRORS.            13710099
137200                                                                  13720099
137300     MOVE SU047-PO-AUD-REQ-STATUS TO CA-AUDIT-STATUS-SW           13730099
137400                                     PS-QC-AUDIT-STATUS-SW.       13740099
137500                                                                  13750099
137600     MOVE SU006-AUDIT-CNTL-NBR    TO DK-AUDIT-CNTL-NBR.           13760099
137700     PERFORM 2400-SELECT-AUDIT-NBR.                               13770099
137800     IF SU047-PO-AUD-REQ-FAIL                                     13780099
137900         IF SUT00015-PKGNG-TYP-CDE = 'PP' OR 'BC' OR 'RF'         13790099
138000            PERFORM 8405-SELECT-TKRPRPM-PRC-AREA                  13800099
138100            IF SQLCODE = 0                                        13810099
138200               MOVE KRPRPM-FUNC-TXT TO DISTHD-FCSE-FCLTY-AREA-ID  13820099
138300               EVALUATE TRUE                                      13830099
138400                  WHEN SUT00015-PKGNG-TYP-CDE = 'PP'              13840099
138500                    MOVE SUT00015-PO-PREPK-ID  TO RECITM-PREPK-ID 13850099
138600                    PERFORM 3590-PROCESS-DISTHD-PREPK-UPD         13860099
138700                  WHEN SUT00015-PKGNG-TYP-CDE = 'RF'              13870099
138800                    PERFORM 3595-PROCESS-DISTRF-PREPK-UPD         13880099
138900                  WHEN OTHER                                      13890099
139000                    MOVE SUT00015-PO-LNE-NBR TO DISTHD-ORD-LNE-NBR13900099
139100                    PERFORM 3810-UPD-DISTHD-FCSE-AREA             13910099
139200               END-EVALUATE                                       13920099
139300            END-IF                                                13930099
139400         END-IF                                                   13940099
139500         PERFORM 3300-CHECK-FOR-REPORTS                           13950099
139600     END-IF.                                                      13960099
139610                                                                  13961099
139620                                                                  13962099
139700 2010-CHECK-FOR-COMPL-COMBO.                                      13970099
139800                                                                  13980099
139900** FOR COMBINED AUDITS WE WANT TO PROCESS THE RFID AUDIT          13990099
140000** WHICH IS PROCESSED SECOND AFTER QC AUDIT.                      14000099
140010                                                                  14001099
140100     IF SU006-QC-AND-RFID-AUD                                     14010099
140200       MOVE SU006-OPER-UNT-ID         TO SU047-OPER-UNT-ID        14020099
140300       MOVE 1                         TO SU047-FCLTY-ID           14030099
140400       MOVE SU006-PO                  TO SU047-PO-NBR             14040099
140500       MOVE SU006-REC-SEQ-NBR         TO SU047-REC-SEQ-NBR        14050099
140600       MOVE ZEROES                    TO SU047-PO-LNE-NBR         14060099
140700       MOVE ZEROES                    TO SU047-PREPACK-ID         14070099
140800       MOVE 'SUKRF536'                TO SU047-CALLING-PROGRAM    14080099
140900       MOVE ZEROES                    TO SU047-INBND-TRIP         14090099
141000       MOVE SU006-RFID-AUDIT-CNTL-NBR TO SU047-AUDIT-CNTL-NBR     14100099
141100                                                                  14110099
141200** PICK,PACK,ERRORS ARE NOT USED FOR RFID AUDITS.                 14120099
141300** IF THERE IS A TICKETING ERROR (MISSING RF TAG), THEN,          14130099
141400** IT WILL BE SET BELOW.                                          14140099
141410                                                                  14141099
141500       MOVE CA-TICKET-ERRORS          TO PV-TICKET-ERRORS-HOLD    14150099
141600       MOVE 0                         TO SU047-PICK-ERRORS        14160099
141700                                         SU047-PACK-ERRORS        14170099
141800                                         SU047-TICKET-ERRORS      14180099
141900       IF SU006-RFID-ERROR                                        14190099
142000         MOVE CA-TICKET-ERRORS        TO PV-TICKET-ERRORS-HOLD    14200099
142100         MOVE 1                       TO SU047-TICKET-ERRORS      14210099
142200                                         SU047-TOT-TCKT-ERROR-PCT 14220099
142300       END-IF                                                     14230099
142400       MOVE 0.00                      TO SU047-AUDIT-ERROR-PCT    14240099
142500       MOVE CA-AUDITED-UNITS-RF       TO SU047-AUDITED-UNITS      14250099
142600       MOVE CA-TOTAL-UNITS-RF         TO SU047-TOTAL-UNITS        14260099
142700       MOVE CA-AUDITED-CARTONS-RF     TO SU047-AUDITED-CARTONS    14270099
142800       MOVE CA-TOTAL-CARTONS-RF       TO SU047-TOTAL-CARTONS      14280099
142900       MOVE ZEROES                    TO SU047-TCKT-ERROR-PCT     14290099
143000                                         SU047-PICK-ERROR-PCT     14300099
143100                                         SU047-PO-STR-ERRORS      14310099
143200                                                                  14320099
143300       MOVE SU006-USERID              TO SU047-USER-ID            14330099
143400                                                                  14340099
143500       PERFORM 7010-LINK-SUKCS763                                 14350099
143600       MOVE PV-TICKET-ERRORS-HOLD   TO CA-TICKET-ERRORS           14360099
143700                                                                  14370099
144000       MOVE SU047-AUDITED-UNITS     TO CA-AUDITED-UNITS-RF        14400099
144100       MOVE SU047-TOTAL-UNITS       TO CA-TOTAL-UNITS-RF          14410099
144200       MOVE SU047-AUDITED-CARTONS   TO CA-AUDITED-CARTONS-RF      14420099
144300       MOVE SU047-TOTAL-CARTONS     TO CA-TOTAL-CARTONS-RF        14430099
144400       MOVE SU047-PO-STR-ERRORS     TO CA-PO-STR-ERRORS           14440099
144500                                                                  14450099
144700       MOVE SU047-PO-AUD-REQ-STATUS  TO CA-AUDIT-STATUS-SW        14470099
144800       MOVE SU047-PO-AUD-REQ-STATUS  TO                           14480099
144900                                 PS-RF-AUDIT-STATUS-SW            14490099
145000                                                                  14500099
145100       MOVE SU006-RFID-AUDIT-CNTL-NBR TO DK-AUDIT-CNTL-NBR        14510099
145200       PERFORM 2400-SELECT-AUDIT-NBR                              14520099
145300       IF SU047-PO-AUD-REQ-FAIL                                   14530099
145400         IF SUT00015-PKGNG-TYP-CDE = 'RF'                         14540099
145500            PERFORM 8405-SELECT-TKRPRPM-PRC-AREA                  14550099
145600            IF SQLCODE = 0                                        14560099
145700               MOVE KRPRPM-FUNC-TXT TO DISTHD-FCSE-FCLTY-AREA-ID  14570099
145800               PERFORM 3595-PROCESS-DISTRF-PREPK-UPD              14580099
146000                                                                  14600099
146100            END-IF                                                14610099
146200         END-IF                                                   14620099
146300         PERFORM 3300-CHECK-FOR-REPORTS                           14630099
146400       END-IF                                                     14640099
146500     END-IF.                                                      14650099
146600                                                                  14660099
146700       IF CA-NO-IP-AUDITS                                         14670099
146800         IF PS-QC-AUDIT-COMPLETE OR PS-QC-AUDIT-PASSED            14680099
146900            IF PS-RFID-AUDITS-FOUND                               14690099
147000               MOVE SUT00015-AUD-CNTL-NBR TO                      14700099
147100                                    SU006-RFID-AUDIT-CNTL-NBR     14710099
147200            END-IF                                                14720099
147300            SET PS-SECOND-DIRECTIVE-YES TO TRUE                   14730099
147400            PERFORM 3250-LINK-COMMON-CARTON-CLOSE                 14740099
147500         END-IF                                                   14750099
147600       END-IF.                                                    14760099
147700                                                                  14770099
147710                                                                  14771099
147800 2050-CHECK-AUDIT.                                                14780099
147900     SET PS-AUDIT-NOT-COMPLETE TO TRUE.                           14790099
148000     IF CA-TOTAL-UNITS > 0                                        14800099
148100         IF CA-TOTAL-UNITS > CA-AUDITED-UNITS                     14810099
148200             CONTINUE                                             14820099
148300         ELSE                                                     14830099
148400             SET PS-AUDIT-IS-COMPLETE TO TRUE                     14840099
148500         END-IF                                                   14850099
148600     END-IF.                                                      14860099
148700     IF CA-TOTAL-CARTONS > CA-AUDITED-CARTONS                     14870099
148800         CONTINUE                                                 14880099
148900     ELSE                                                         14890099
149000         SET PS-AUDIT-IS-COMPLETE TO TRUE                         14900099
149100     END-IF.                                                      14910099
149200     IF CA-PACK-ERRORS > 0 OR                                     14920099
149300        CA-PO-STR-ERRORS = 'Y'                                    14930099
149400         SET PS-AUDIT-IS-COMPLETE TO TRUE                         14940099
149500     END-IF.                                                      14950099
149600                                                                  14960099
149610                                                                  14961099
149700 2055-CHECK-RF-AUDIT.                                             14970099
149800     SET PS-AUDIT-NOT-COMPLETE TO TRUE.                           14980099
149900     IF CA-TOTAL-UNITS-RF > 0                                     14990099
150000         IF CA-TOTAL-UNITS-RF > CA-AUDITED-UNITS-RF               15000099
150100             CONTINUE                                             15010099
150200         ELSE                                                     15020099
150300             SET PS-RF-AUDIT-IS-COMPLETE TO TRUE                  15030099
150400         END-IF                                                   15040099
150500     END-IF.                                                      15050099
150600     IF CA-TOTAL-CARTONS-RF > CA-AUDITED-CARTONS-RF               15060099
150700         CONTINUE                                                 15070099
150800     ELSE                                                         15080099
150900         SET PS-RF-AUDIT-IS-COMPLETE TO TRUE                      15090099
151000     END-IF.                                                      15100099
151010                                                                  15101099
151100*** IF THERE ARE ANY RFID ERRORS THE ENTIRE AUDIT IS COMPLETE.    15110099
151110                                                                  15111099
151200     IF SU026-RFID-ERRORS > PC-NBR-OF-RF-ERRORS-ALWD              15120099
151300         SET PS-RF-AUDIT-IS-COMPLETE TO TRUE                      15130099
151400     END-IF.                                                      15140099
170900                                                                  17090099
170910                                                                  17091099
171000******************************************************************17100099
171100 2400-SELECT-AUDIT-NBR.                                           17110099
171200                                                                  17120099
171300     EXEC SQL                                                     17130099
171400       SELECT PO_NBR                                              17140099
171500           ,  PO_LNE_NBR                                          17150099
171600           ,  PO_PREPK_ID                                         17160099
171700           ,  OPER_UNT_ID                                         17170099
171800           ,  CART_QTY                                            17180099
171900           ,  UNT_QTY                                             17190099
172000           ,  AUD_CART_QTY                                        17200099
172100           ,  AUD_UNT_QTY                                         17210099
172200           ,  AUD_STAT_CDE                                        17220099
172300           ,  CART_PRMPT_CDE                                      17230099
172400           ,  A.PKGNG_TYP_CDE                                     17240099
172500           ,  DAYS(CRE_TMST) - (B.CK_AFT_DAY_QTY + 1)             17250099
172600           ,  B.CKD_DC_QTY                                        17260099
172700           ,  A.RCVR_SEQ_NBR                                      17270099
172800       INTO   :SUT00015-PO-NBR                                    17280099
172900           ,  :SUT00015-PO-LNE-NBR                                17290099
173000           ,  :SUT00015-PO-PREPK-ID                               17300099
173100           ,  :SUT00015-OPER-UNT-ID                               17310099
173200           ,  :SUT00015-CART-QTY                                  17320099
173300           ,  :SUT00015-UNT-QTY                                   17330099
173400           ,  :SUT00015-AUD-CART-QTY                              17340099
173500           ,  :SUT00015-AUD-UNT-QTY                               17350099
173600           ,  :SUT00015-AUD-STAT-CDE                              17360099
173700           ,  :SUT00015-CART-PRMPT-CDE                            17370099
173800           ,  :SUT00015-PKGNG-TYP-CDE                             17380099
173900           ,  :PV-LIMIT-DAYS                                      17390099
174000           ,  :SUT00017-CKD-DC-QTY                                17400099
174100           ,  :SUT00015-RCVR-SEQ-NBR                              17410099
174200       FROM   SUT_PO_AUD_REQ  A                                   17420099
174300           ,  SUT_PO_AUD_PARM B                                   17430099
174400       WHERE  A.AUD_CNTL_NBR  = :DK-AUDIT-CNTL-NBR                17440099
174500         AND  A.VND_RNKG_CDE  = B.VND_RNKG_CDE                    17450099
174600         AND  A.PKGNG_TYP_CDE = B.PKGNG_TYP_CDE                   17460099
174700         AND  A.EFF_BEG_TMST  = B.EFF_BEG_TMST                    17470099
174800     END-EXEC.                                                    17480099
174900                                                                  17490099
175000     EVALUATE TRUE                                                17500099
175100         WHEN SQLCODE = ZERO                                      17510099
175200             SET PS-VALID-AUDIT-NBR   TO TRUE                     17520099
175300                                                                  17530099
175400         WHEN SQLCODE = +100                                      17540099
175500             SET PS-INVALID-AUDIT-NBR TO TRUE                     17550099
175600                                                                  17560099
175700         WHEN SQLWARN0 NOT = SPACES                               17570099
175800         WHEN SQLCODE NOT EQUAL ZERO                              17580099
175900             MOVE '2400-SELECT-AUDIT-NBR'                         17590099
176000                                    TO DP013-PARAGRAPH            17600099
176100             MOVE 'RETRIEVE AUDIT INFO '                          17610099
176200                                    TO DP013-MESSAGE-TEXT(1)      17620099
176300             MOVE DK-AUDIT-CNTL-NBR TO PV-DISPLAY-AUDIT-CNTL-NBR  17630099
176400             STRING 'AUDIT NBR: '      DELIMITED BY SIZE          17640099
176500                 PV-DISPLAY-AUDIT-CNTL-NBR                        17650099
176600                                       DELIMITED BY SIZE          17660099
176700                           INTO DP013-MESSAGE-TEXT(2)             17670099
176800             MOVE SQLCA      TO DP013-SQLCA                       17680099
176900             MOVE 'SUT00015' TO DP013-DB2-TABLE-NAME(1)           17690099
177000             SET DP013-DB2-ABEND   TO TRUE                        17700099
177100             SET DP013-NO-ROLLBACK TO TRUE                        17710099
177200             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               17720099
177300     END-EVALUATE.                                                17730099
177400                                                                  17740099
177500******************************************************************17750099
177600 2450-SELECT-RFID-AUD.                                            17760099
177700                                                                  17770099
177800     EXEC SQL                                                     17780099
177900          SELECT AUD_CNTL_NBR                                     17790099
178000              ,  AUD_STAT_CDE                                     17800099
178100          INTO   :SUT00015-AUD-CNTL-NBR                           17810099
178200               , :SUT00015-AUD-STAT-CDE                           17820099
178300          FROM   SUT_PO_AUD_REQ                                   17830099
178400          WHERE  PO_NBR         = :SUT00015-PO-NBR                17840099
178500            AND  RCVR_SEQ_NBR   = :SUT00015-RCVR-SEQ-NBR          17850099
178600            AND  PKGNG_TYP_CDE  = 'RF'                            17860099
178700     END-EXEC.                                                    17870099
178800                                                                  17880099
178900     EVALUATE TRUE                                                17890099
179000         WHEN SQLCODE = ZERO                                      17900099
179100         WHEN SQLCODE = -811                                      17910099
179200             SET PS-RFID-AUDITS-FOUND TO TRUE                     17920099
179300         WHEN SQLCODE = +100                                      17930099
179400             SET PS-NO-RFID-AUDITS-FOUND TO TRUE                  17940099
179500         WHEN SQLWARN0 NOT = SPACES                               17950099
179600         WHEN SQLCODE NOT EQUAL ZERO                              17960099
179700             MOVE '2450-SELECT-RFID-AUD'                          17970099
179800                             TO DP013-PARAGRAPH                   17980099
179900             MOVE 'CHECK IF THERE ARE ANY FAILED AUDITS'          17990099
180000                             TO DP013-MESSAGE-TEXT(1)             18000099
180100             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 18010099
180200             STRING 'PO NBR: '         DELIMITED BY SIZE          18020099
180300                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          18030099
180400                           INTO DP013-MESSAGE-TEXT(2)             18040099
180500             MOVE DK-PO-LINE-NBR TO PV-DISPLAY-PO-LINE-NBR        18050099
180600             STRING 'PO LINE NBR: '    DELIMITED BY SIZE          18060099
180700                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          18070099
180800                           INTO DP013-MESSAGE-TEXT(3)             18080099
180900             MOVE DK-PREPK-ID    TO PV-DISPLAY-PREPK-ID           18090099
181000             STRING 'PREPACK ID: '     DELIMITED BY SIZE          18100099
181100                PV-DISPLAY-PREPK-ID    DELIMITED BY SIZE          18110099
181200                           INTO DP013-MESSAGE-TEXT(4)             18120099
181300             MOVE SQLCA      TO DP013-SQLCA                       18130099
181400             MOVE 'SUT00015' TO DP013-DB2-TABLE-NAME(1)           18140099
181500             SET DP013-DB2-ABEND   TO TRUE                        18150099
181600             SET DP013-NO-ROLLBACK TO TRUE                        18160099
181700             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               18170099
181800     END-EVALUATE.                                                18180099
181900                                                                  18190099
182000                                                                  18200099
199700 2920-SUM-RF-TGD-QTY.                                             19970099
199800     EXEC SQL                                                     19980099
199900         SELECT SUM(RFID_TGD_QTY)                                 19990099
200000          INTO :SUAUPC-RFID-TGD-QTY                               20000099
200100          FROM  TSUAUPC                                           20010099
200200          WHERE AUD_CNTL_NBR        = :DK-AUDIT-CNTL-NBR          20020099
200300            AND SHIPT_UNT_ID        = :DK-SHIPT-UNIT-ID           20030099
200400            AND SCN_TYP_CDE        <> 'E'                         20040099
200500     END-EXEC.                                                    20050099
200600                                                                  20060099
200700     EVALUATE TRUE                                                20070099
200800         WHEN SQLCODE = ZERO                                      20080099
200900             CONTINUE                                             20090099
201000                                                                  20100099
201100         WHEN SQLWARN0 NOT = SPACES                               20110099
201200         WHEN SQLCODE < ZERO                                      20120099
201300         WHEN SQLCODE > ZERO                                      20130099
201400             MOVE '2920-SUM-RF-TGD-QTY'                           20140099
201500                                   TO DP013-PARAGRAPH             20150099
201600             MOVE 'SELECT RF TGD QTY     '                        20160099
201700                                   TO DP013-MESSAGE-TEXT (1)      20170099
201800             MOVE DK-AUDIT-CNTL-NBR                               20180099
201900                                 TO PV-DISPLAY-AUDIT-CNTL-NBR     20190099
202000             MOVE PV-DISPLAY-AUDIT-CNTL-NBR                       20200099
202100                                   TO DP013-MESSAGE-TEXT (2)      20210099
202200             MOVE DK-SHIPT-UNIT-ID TO PV-DISP-SHIPT-UNT-ID        20220099
202300             MOVE PV-DISP-SHIPT-UNT-ID                            20230099
202400                                   TO DP013-MESSAGE-TEXT (3)      20240099
202500             MOVE SQLCA            TO DP013-SQLCA                 20250099
202600             MOVE 'TSUAUPC '       TO DP013-DB2-TABLE-NAME (1)    20260099
202700             SET DP013-DB2-ABEND   TO TRUE                        20270099
202800             SET DP013-NO-ROLLBACK TO TRUE                        20280099
202900             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               20290099
203000             MOVE PM-DB2-FATAL-ERROR-MSG TO AMSGLNO               20300099
203100             PERFORM 8100-SEND-DATA-ONLY                          20310099
203200             PERFORM 8200-RETURN-TRANID                           20320099
203300     END-EVALUATE.                                                20330099
203310                                                                  20331099
203320                                                                  20332099
203400 2930-SUM-QC-SCN-QTY.                                             20340099
203500     EXEC SQL                                                     20350099
203600         SELECT SUM(SCND_UNT_QTY)                                 20360099
203700          INTO :SUAUPC-SCND-UNT-QTY                               20370099
203800          FROM  TSUAUPC                                           20380099
203900          WHERE AUD_CNTL_NBR        = :DK-AUDIT-CNTL-NBR          20390099
204000            AND SHIPT_UNT_ID        = :DK-SHIPT-UNIT-ID           20400099
204100            AND SCN_TYP_CDE        <> 'E'                         20410099
204200     END-EXEC.                                                    20420099
204300                                                                  20430099
204400     EVALUATE TRUE                                                20440099
204500         WHEN SQLCODE = ZERO                                      20450099
204600             CONTINUE                                             20460099
204700                                                                  20470099
204800         WHEN SQLWARN0 NOT = SPACES                               20480099
204900         WHEN SQLCODE < ZERO                                      20490099
205000         WHEN SQLCODE > ZERO                                      20500099
205100             MOVE '2930-SUM-QC-SCN-QTY'                           20510099
205200                                   TO DP013-PARAGRAPH             20520099
205300             MOVE 'SELECT RF TGD QTY     '                        20530099
205400                                   TO DP013-MESSAGE-TEXT (1)      20540099
205500             MOVE DK-AUDIT-CNTL-NBR                               20550099
205600                                 TO PV-DISPLAY-AUDIT-CNTL-NBR     20560099
205700             MOVE PV-DISPLAY-AUDIT-CNTL-NBR                       20570099
205800                                   TO DP013-MESSAGE-TEXT (2)      20580099
205900             MOVE DK-SHIPT-UNIT-ID TO PV-DISP-SHIPT-UNT-ID        20590099
206000             MOVE PV-DISP-SHIPT-UNT-ID                            20600099
206100                                   TO DP013-MESSAGE-TEXT (3)      20610099
206200             MOVE SQLCA            TO DP013-SQLCA                 20620099
206300             MOVE 'TSUAUPC '       TO DP013-DB2-TABLE-NAME (1)    20630099
206400             SET DP013-DB2-ABEND   TO TRUE                        20640099
206500             SET DP013-NO-ROLLBACK TO TRUE                        20650099
206600             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               20660099
206700             MOVE PM-DB2-FATAL-ERROR-MSG TO AMSGLNO               20670099
206800             PERFORM 8100-SEND-DATA-ONLY                          20680099
206900             PERFORM 8200-RETURN-TRANID                           20690099
207000     END-EVALUATE.                                                20700099
207100                                                                  20710099
207110                                                                  20711099
207200 2940-SUM-QC-AND-RF-QTY.                                          20720099
207300     EXEC SQL                                                     20730099
207400         SELECT SUM(SCND_UNT_QTY)                                 20740099
207500               ,SUM(RFID_TGD_QTY)                                 20750099
207600          INTO :SUAUPC-SCND-UNT-QTY                               20760099
207700              ,:SUAUPC-RFID-TGD-QTY                               20770099
207800          FROM  TSUAUPC                                           20780099
207900          WHERE AUD_CNTL_NBR        = :DK-AUDIT-CNTL-NBR          20790099
208000            AND SHIPT_UNT_ID        = :DK-SHIPT-UNIT-ID           20800099
208100            AND SCN_TYP_CDE        <> 'E'                         20810099
208200     END-EXEC.                                                    20820099
208300                                                                  20830099
208400     EVALUATE TRUE                                                20840099
208500         WHEN SQLCODE = ZERO                                      20850099
208600             CONTINUE                                             20860099
208610                                                                  20861099
208700*** FOR THIS SITUATION TO HAPPEN THE USER MUST HAVE CLOSED        20870099
208800*** CARTON WITHOUT AUDITING ANY UPCS                              20880099
208810                                                                  20881099
208900         WHEN SQLCODE = -305                                      20890099
209000         WHEN SQLCODE = +100                                      20900099
209100             MOVE 0 TO SUAUPC-SCND-UNT-QTY                        20910099
209200             MOVE 0 TO SUAUPC-RFID-TGD-QTY                        20920099
209300                                                                  20930099
209400         WHEN SQLWARN0 NOT = SPACES                               20940099
209500         WHEN SQLCODE < ZERO                                      20950099
209600         WHEN SQLCODE > ZERO                                      20960099
209700             MOVE '2940-SUM-QC-AND-RF-QTY'                        20970099
209800                                   TO DP013-PARAGRAPH             20980099
209900             MOVE 'SELECT RF TGD QTY     '                        20990099
210000                                   TO DP013-MESSAGE-TEXT (1)      21000099
210100             MOVE DK-AUDIT-CNTL-NBR                               21010099
210200                                 TO PV-DISPLAY-AUDIT-CNTL-NBR     21020099
210300             MOVE PV-DISPLAY-AUDIT-CNTL-NBR                       21030099
210400                                   TO DP013-MESSAGE-TEXT (2)      21040099
210500             MOVE DK-SHIPT-UNIT-ID TO PV-DISP-SHIPT-UNT-ID        21050099
210600             MOVE PV-DISP-SHIPT-UNT-ID                            21060099
210700                                   TO DP013-MESSAGE-TEXT (3)      21070099
210800             MOVE SQLCA            TO DP013-SQLCA                 21080099
210900             MOVE 'TSUAUPC '       TO DP013-DB2-TABLE-NAME (1)    21090099
211000             SET DP013-DB2-ABEND   TO TRUE                        21100099
211100             SET DP013-NO-ROLLBACK TO TRUE                        21110099
211200             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               21120099
211300             MOVE PM-DB2-FATAL-ERROR-MSG TO AMSGLNO               21130099
211400             PERFORM 8100-SEND-DATA-ONLY                          21140099
211500             PERFORM 8200-RETURN-TRANID                           21150099
211600     END-EVALUATE.                                                21160099
211700                                                                  21170099
211800 2950-COUNT-NON-EPC-TAG-ERRS.                                     21180099
211900     EXEC SQL                                                     21190099
212000       SELECT SUM(B.RFID_TGD_QTY)                                 21200099
212100         INTO :PV-NON-TAG-UNITS                                   21210099
212200         FROM (SELECT DISTINCT                                    21220099
212300                     A.AUD_CNTL_NBR                               21230099
212400                    ,A.SHIPT_UNT_ID                               21240099
212500                    ,A.UPC_NBR                                    21250099
212600                    ,A.SCN_TMST                                   21260099
212700         FROM TSUEXCP A                                           21270099
212800             ,TVILNCD D                                           21280099
212900         WHERE  A.AUD_CNTL_NBR        = :DK-AUDIT-CNTL-NBR        21290099
213000           AND D.VILN_GP_SEQ_NBR  =  A.VILN_GP_SEQ_NBR            21300099
213100           AND D.VILN_GP_SEQ_NBR <> '42'                          21310099
213200           AND D.VILN_GP_CDE      = 'VA'                          21320099
213300           AND D.VILN_CTG_CDE     = 'R') C                        21330099
213400         ,TSUAUPC B                                               21340099
213500         ,TSUATRN D                                               21350099
213600                                                                  21360099
213700        WHERE B.AUD_CNTL_NBR        =  :DK-AUDIT-CNTL-NBR         21370099
213800          AND C.AUD_CNTL_NBR        =  B.AUD_CNTL_NBR             21380099
213900          AND C.SHIPT_UNT_ID        =  B.SHIPT_UNT_ID             21390099
214000          AND D.AUD_CNTL_NBR        =  B.AUD_CNTL_NBR             21400099
214100          AND D.SHIPT_UNT_ID        =  B.SHIPT_UNT_ID             21410099
214200          AND C.UPC_NBR             =  B.UPC_NBR                  21420099
214300          AND C.SCN_TMST            =  B.SCN_TMST                 21430099
214400          AND C.SCN_TMST           >=  D.UNT_AUD_STRT_TMST        21440099
214500     END-EXEC.                                                    21450099
214600                                                                  21460099
214700     EVALUATE TRUE                                                21470099
214800         WHEN SQLCODE = ZERO                                      21480099
214900             CONTINUE                                             21490099
215000         WHEN SQLCODE = +100                                      21500099
215100         WHEN SQLCODE = -305                                      21510099
215200             MOVE 0 TO PV-NON-TAG-UNITS                           21520099
215300         WHEN SQLWARN0 NOT = SPACES                               21530099
215400         WHEN SQLCODE < ZERO                                      21540099
215500         WHEN SQLCODE > ZERO                                      21550099
215600             MOVE '2950-COUNT-NON-EPC-TAG-ERRS'                   21560099
215700                                   TO DP013-PARAGRAPH             21570099
215800             MOVE 'COUNT NON TAG ERRS    '                        21580099
215900                                   TO DP013-MESSAGE-TEXT (1)      21590099
216000             MOVE DK-AUDIT-CNTL-NBR                               21600099
216100                                 TO PV-DISPLAY-AUDIT-CNTL-NBR     21610099
216200             MOVE PV-DISPLAY-AUDIT-CNTL-NBR                       21620099
216300                                   TO DP013-MESSAGE-TEXT (2)      21630099
216400             MOVE SQLCA            TO DP013-SQLCA                 21640099
216500             MOVE 'TSUAUPC '       TO DP013-DB2-TABLE-NAME (1)    21650099
216600             SET DP013-DB2-ABEND   TO TRUE                        21660099
216700             SET DP013-NO-ROLLBACK TO TRUE                        21670099
216800             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               21680099
216900             MOVE PM-DB2-FATAL-ERROR-MSG TO AMSGLNO               21690099
217000             PERFORM 8100-SEND-DATA-ONLY                          21700099
217100             PERFORM 8200-RETURN-TRANID                           21710099
217200     END-EVALUATE.                                                21720099
217300                                                                  21730099
217400******************************************************************21740099
217500 3000-CLOSE-AUDIT.                                                21750099
217600                                                                  21760099
217700*    UPDATE APPROPRIATE HOST VARIABLES                            21770099
217710                                                                  21771099
217800     MOVE SU006-AUDIT-CNTL-NBR       TO DK-AUDIT-CNTL-NBR.        21780099
217900     MOVE SU006-AUDIT-STATUS         TO SUNAUD-AUD-STAT-CDE.      21790099
218000                                                                  21800099
218100     EXEC SQL                                                     21810099
218200         UPDATE TSUNAUD                                           21820099
218300            SET  AUD_STP_TMST    = CURRENT TIMESTAMP              21830099
218400               , AUD_STAT_CDE    = :SUNAUD-AUD-STAT-CDE           21840099
218500         WHERE                                                    21850099
218600                AUD_CNTL_NBR     = :DK-AUDIT-CNTL-NBR             21860099
218700     END-EXEC.                                                    21870099
218800                                                                  21880099
218900     EVALUATE TRUE                                                21890099
219000         WHEN SQLCODE = ZERO                                      21900099
219100             CONTINUE                                             21910099
219200                                                                  21920099
219300         WHEN SQLWARN0 NOT = SPACES                               21930099
219400         WHEN SQLCODE < ZERO                                      21940099
219500         WHEN SQLCODE > ZERO                                      21950099
219600             MOVE '3000-CLOSE-AUDIT'                              21960099
219700                 TO DP013-PARAGRAPH                               21970099
219800             MOVE 'UPDATE THE STOP TIMESTAMP AND STATUS'          21980099
219900                 TO DP013-MESSAGE-TEXT (1)                        21990099
220000             MOVE SU006-AUDIT-CNTL-NBR-X                          22000099
220100                 TO DP013-MESSAGE-TEXT (2)                        22010099
220200             MOVE SQLCA            TO DP013-SQLCA                 22020099
220300             MOVE 'TSUNAUD'        TO DP013-DB2-TABLE-NAME (1)    22030099
220400             SET DP013-DB2-ABEND   TO TRUE                        22040099
220500             SET DP013-NO-ROLLBACK TO TRUE                        22050099
220600             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               22060099
220700                                                                  22070099
220800             MOVE PM-DB2-FATAL-ERROR-MSG TO AMSGLNO               22080099
220900             PERFORM 8100-SEND-DATA-ONLY                          22090099
221000             PERFORM 8200-RETURN-TRANID                           22100099
221100     END-EVALUATE.                                                22110099
221200                                                                  22120099
221300 3100-CHECK-OPEN-CARTONS.                                         22130099
221400                                                                  22140099
221500     IF SU006-QC-AND-RFID-AUD                                     22150099
221600       MOVE SU006-RFID-AUDIT-CNTL-NBR    TO DK-AUDIT-CNTL-NBR     22160099
221700     ELSE                                                         22170099
221800       MOVE SU006-AUDIT-CNTL-NBR    TO DK-AUDIT-CNTL-NBR          22180099
221900     END-IF.                                                      22190099
222000                                                                  22200099
222100     EXEC SQL                                                     22210099
222200         SELECT                                                   22220099
222300            COUNT (DISTINCT SHIPT_UNT_ID)                         22230099
222400         INTO                                                     22240099
222500            :PV-DB2-COUNT                                         22250099
222600         FROM                                                     22260099
222700                TSUATRN                                           22270099
222800         WHERE                                                    22280099
222900                AUD_CNTL_NBR     = :DK-AUDIT-CNTL-NBR             22290099
223000           AND  UNT_AUD_STAT_CDE <> 'CM'                          22300099
223100     END-EXEC.                                                    22310099
223200                                                                  22320099
223300     EVALUATE TRUE                                                22330099
223400         WHEN SQLCODE = ZERO                                      22340099
223500             CONTINUE                                             22350099
223600                                                                  22360099
223700         WHEN SQLCODE = -305                                      22370099
223800             MOVE +0                 TO PV-DB2-COUNT              22380099
223900                                                                  22390099
224000         WHEN SQLWARN0 NOT = SPACES                               22400099
224100         WHEN SQLCODE < ZERO                                      22410099
224200         WHEN SQLCODE > ZERO                                      22420099
224300             MOVE '3100-CHECK-OPEN-CARTONS'                       22430099
224400                 TO DP013-PARAGRAPH                               22440099
224500             MOVE 'SUM OF COMPLETE TSUATRN'                       22450099
224600                 TO DP013-MESSAGE-TEXT (1)                        22460099
224700             MOVE SU006-AUDIT-CNTL-NBR-X                          22470099
224800                 TO DP013-MESSAGE-TEXT (2)                        22480099
224900             MOVE SQLCA            TO DP013-SQLCA                 22490099
225000             MOVE 'TSUATRN'        TO DP013-DB2-TABLE-NAME (1)    22500099
225100             SET DP013-DB2-ABEND   TO TRUE                        22510099
225200             SET DP013-NO-ROLLBACK TO TRUE                        22520099
225300             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               22530099
225400             MOVE PM-DB2-FATAL-ERROR-MSG TO AMSGLNO               22540099
225500             PERFORM 8100-SEND-DATA-ONLY                          22550099
225600             PERFORM 8200-RETURN-TRANID                           22560099
225700     END-EVALUATE.                                                22570099
225800                                                                  22580099
225900 3200-SUM-CHECKED-IN-CART.                                        22590099
226000                                                                  22600099
226100     EXEC SQL                                                     22610099
226200         SELECT                                                   22620099
226300            COUNT (DISTINCT SHIPT_UNT_ID)                         22630099
226400         INTO                                                     22640099
226500            :PV-DB2-COUNT                                         22650099
226600         FROM                                                     22660099
226700                TSUATRN                                           22670099
226800         WHERE                                                    22680099
226900                AUD_CNTL_NBR     = :DK-AUDIT-CNTL-NBR             22690099
227000     END-EXEC.                                                    22700099
227100                                                                  22710099
227200     EVALUATE TRUE                                                22720099
227300         WHEN SQLCODE = ZERO                                      22730099
227400             CONTINUE                                             22740099
227500                                                                  22750099
227600         WHEN SQLCODE = -305                                      22760099
227700             MOVE +0                 TO PV-DB2-COUNT              22770099
227800                                                                  22780099
227900         WHEN SQLWARN0 NOT = SPACES                               22790099
228000         WHEN SQLCODE < ZERO                                      22800099
228100         WHEN SQLCODE > ZERO                                      22810099
228200             MOVE '3200-SUM-CHECKED-IN-CART'                      22820099
228300                 TO DP013-PARAGRAPH                               22830099
228400             MOVE 'COUNT TSUATRN RECORDS'                         22840099
228500                 TO DP013-MESSAGE-TEXT (1)                        22850099
228600             MOVE SU006-AUDIT-CNTL-NBR-X                          22860099
228700                 TO DP013-MESSAGE-TEXT (2)                        22870099
228800             MOVE SQLCA            TO DP013-SQLCA                 22880099
228900             MOVE 'TSUATRN'        TO DP013-DB2-TABLE-NAME (1)    22890099
229000             SET DP013-DB2-ABEND   TO TRUE                        22900099
229100             SET DP013-NO-ROLLBACK TO TRUE                        22910099
229200             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               22920099
229300             MOVE PM-DB2-FATAL-ERROR-MSG TO AMSGLNO               22930099
229400             PERFORM 8100-SEND-DATA-ONLY                          22940099
229500             PERFORM 8200-RETURN-TRANID                           22950099
229600     END-EVALUATE.                                                22960099
229700/                                                                 22970099
229800**************************************************************    22980099
229900* 3250-LINK-COMMON-CARTON-CLOSE                              *    22990099
230000*     WHEN APPLICABLE FILL IN COPYBOOK SUWS091               *    23000099
230100*                     LINK TO SUKCS769                       *    23010099
230200*                     CHECK RETURN FOR ERRORS UPON RETURN    *    23020099
230300**************************************************************    23030099
230400 3250-LINK-COMMON-CARTON-CLOSE.                                   23040099
230500                                                                  23050099
230600     INITIALIZE CCC-REQUEST-COMMUNICATION-AREA.                   23060099
230700                                                                  23070099
230800     MOVE '00'                    TO SU091-RET-CODE.              23080099
230900     MOVE PC-CURRENT-PROGRAM-NAME TO SU091-CALLING-PGM.           23090099
231000     MOVE SU006-OPER-UNT-ID       TO SU091-OPER-UNT-ID.           23100099
231100                                                                  23110099
231200     IF ( SU006-SHIP-UNIT-NBR NUMERIC )                           23120099
231300         MOVE SU006-SHIP-UNIT-NBR TO SU091-SHIPT-UNT-ID           23130099
231400     ELSE                                                         23140099
231500         MOVE ZEROS               TO SU091-SHIPT-UNT-ID           23150099
231600     END-IF.                                                      23160099
231700                                                                  23170099
231800     IF PS-SECOND-DIRECTIVE-YES                                   23180099
231900       MOVE SU006-AUDIT-CNTL-NBR    TO SU091-AUD-CNTL-NBR         23190099
232000       MOVE SU006-RFID-AUDIT-CNTL-NBR TO SU091-RFID-AUD-CNTL-NBR  23200099
232100       SET SU091-RFID-AUD-DIR-YES TO TRUE                         23210099
232200     ELSE                                                         23220099
232300       MOVE SU006-AUDIT-CNTL-NBR    TO SU091-AUD-CNTL-NBR         23230099
232400       SET SU091-RFID-AUD-DIR-NO  TO TRUE                         23240099
232500     END-IF.                                                      23250099
232600                                                                  23260099
232800     MOVE SUT00015-AUD-STAT-CDE   TO SU091-AUD-STAT-CDE.          23280099
232900                                                                  23290099
233000     IF ( SU006-SYSTEM-GENERATED-AUDIT )                          23300099
233100         SET SU091-PROMPTED-AUDIT TO TRUE                         23310099
233200     ELSE                                                         23320099
233300         IF ( SU006-MANUAL-GENERATED-AUDIT )                      23330099
233400             SET SU091-MANUAL-AUDIT TO TRUE                       23340099
233500         END-IF                                                   23350099
233600     END-IF.                                                      23360099
233700                                                                  23370099
233800     EVALUATE TRUE                                                23380099
233900         WHEN SU006-RFID-ERROR                                    23390099
234000               MOVE 'RFID ' TO SU091-AUD-FALR-STAT-RSN-NM         23400099
234100         WHEN ( CA-PICK-ERRORS   = 0 ) AND                        23410099
234200              ( CA-PACK-ERRORS   = 0 ) AND                        23420099
234300              ( CA-TICKET-ERRORS = 0 )                            23430099
234400               MOVE '     ' TO SU091-AUD-FALR-STAT-RSN-NM         23440099
234500         WHEN ( CA-PICK-ERRORS   > 0 ) AND                        23450099
234600              ( CA-PACK-ERRORS   = 0 ) AND                        23460099
234700              ( CA-TICKET-ERRORS = 0 )                            23470099
234800               MOVE 'PICK ' TO SU091-AUD-FALR-STAT-RSN-NM         23480099
234900         WHEN ( CA-PICK-ERRORS   = 0 ) AND                        23490099
235000              ( CA-PACK-ERRORS   > 0 ) AND                        23500099
235100              ( CA-TICKET-ERRORS = 0 )                            23510099
235200               MOVE 'PACK ' TO SU091-AUD-FALR-STAT-RSN-NM         23520099
235300         WHEN ( CA-PICK-ERRORS   = 0 ) AND                        23530099
235400              ( CA-PACK-ERRORS   = 0 ) AND                        23540099
235500              ( CA-TICKET-ERRORS > 0 )                            23550099
235600               MOVE 'TCKT ' TO SU091-AUD-FALR-STAT-RSN-NM         23560099
235700     END-EVALUATE.                                                23570099
235800                                                                  23580099
235900     MOVE SU006-USERID            TO SU091-ASSOC-ID.              23590099
236000                                                                  23600099
236100     EXEC CICS LINK                                               23610099
236200               PROGRAM  (PC-COMMON-CARTON-CLOSE-PGM)              23620099
236300               COMMAREA (CCC-REQUEST-COMMUNICATION-AREA)          23630099
236400               LENGTH   (LENGTH OF CCC-REQUEST-COMMUNICATION-AREA)23640099
236500               RESP     (PV-CICS-RESPONSE)                        23650099
236600     END-EXEC.                                                    23660099
236700                                                                  23670099
236800     EVALUATE TRUE                                                23680099
236900         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 23690099
237000             CONTINUE                                             23700099
237100         WHEN OTHER                                               23710099
237200             MOVE '3250-LINK-COMMON-CARTON-CLOSE'                 23720099
237300               TO DP013-PARAGRAPH                                 23730099
237400             MOVE 'BAD LINK TO PGM SUKCS769'                      23740099
237500               TO DP013-MESSAGE-TEXT (1)                          23750099
237600             SET DP013-CICS-ABEND     TO TRUE                     23760099
237700             SET DP013-NO-ROLLBACK    TO TRUE                     23770099
237800             PERFORM 999A-WRITE-CSSL-MSG                          23780099
237900             MOVE PC-CCC-PGM-LINK-ERR TO AMSGLNO                  23790099
238000             PERFORM 8100-SEND-DATA-ONLY                          23800099
238100             PERFORM 8200-RETURN-TRANID                           23810099
238200     END-EVALUATE.                                                23820099
238300                                                                  23830099
238400     IF ( SU091-SUCCESS )                                         23840099
238500         CONTINUE                                                 23850099
238600     ELSE                                                         23860099
238700         EVALUATE TRUE                                            23870099
238800            WHEN SU091-PARAMETER-ERROR                            23880099
238900                MOVE PC-CCC-PARM-ERR-MSG    TO AMSGLNO            23890099
239000            WHEN SU091-DB2-ERROR                                  23900099
239100                MOVE PC-CCC-DB2-ERR-MSG     TO AMSGLNO            23910099
239200            WHEN SU091-MQ-ERROR                                   23920099
239300                MOVE PC-CCC-MQ-ERR-MSG      TO AMSGLNO            23930099
239400            WHEN SU091-OTHER-ERROR                                23940099
239500                MOVE PC-CCC-OTHR-ERR-MSG    TO AMSGLNO            23950099
239600         END-EVALUATE                                             23960099
239700         INITIALIZE PV-CICS-MSG-AREA2                             23970099
239800         MOVE AMSGLNO TO PV-CICS-MSG-AREA2                        23980099
239900         PERFORM 999A-WRITE-CSSL-MSG                              23990099
240000         PERFORM 8100-SEND-DATA-ONLY                              24000099
240100         PERFORM 8200-RETURN-TRANID                               24010099
240200     END-IF.                                                      24020099
240300/                                                                 24030099
240400 3300-CHECK-FOR-REPORTS.                                          24040099
240500                                                                  24050099
240501     IF  SU006-PRINTER-DEST = PC-PRINT-TO-FILE                    24050199
240510         PERFORM 3360-VALIDATE-PRINT-TO-FILE                      24051099
240511         IF  PS-PRINT-TO-FILE-NO                                  24051199
240512             MOVE PC-PRINT-TO-FILE-ERR-MSG  TO  AMSGLNO           24051299
240513             PERFORM 8100-SEND-DATA-ONLY                          24051399
240514             PERFORM 8200-RETURN-TRANID                           24051499
240515         END-IF                                                   24051599
240520     ELSE                                                         24052099
240600         PERFORM 3350-VALIDATE-PRINTER                            24060099
240700         IF  DP072-PRTR-PRTR-TRK-STAT-CDE EQUAL 'A'               24070099
240800             MOVE DP072-PRTR-PRTR-CNTL-IND                        24080099
240900                                  TO  CA-PRTR-CNTL-IND            24090099
241200             MOVE DP072-PRTR-TRACK-NBR                            24120099
241300                                  TO  CA-TRACK-NBR                24130099
241400             MOVE DP072-PRTR-PRTR-BRCDE-IND                       24140099
241500                                  TO  CA-BRCDE-IND                24150099
241600         ELSE                                                     24160099
241700             MOVE PM-INVALID-PRINTER-ID-MSG TO  AMSGLNO           24170099
241800             PERFORM 8100-SEND-DATA-ONLY                          24180099
241900             PERFORM 8200-RETURN-TRANID                           24190099
242000         END-IF                                                   24200099
242010     END-IF.                                                      24201099
242100                                                                  24210099
242200     PERFORM 3400-GET-UNT-AUD-ERR-IND.                            24220099
242300     IF SU006-NO-AUD-ERR                                          24230099
242400         PERFORM 3450-CHECK-OVER-SHORT                            24240099
242500     END-IF.                                                      24250099
242600                                                                  24260099
243200                                                                  24320099
243300******************************************************************24330099
243400 3350-VALIDATE-PRINTER.                                           24340099
243500                                                                  24350099
243600     MOVE SU006-PRINTER-DEST         TO DP072-PRINTER-ID.         24360099
243700     MOVE PC-REPORT-PGM              TO DP072-RPT-PGM-NME.        24370099
243800     MOVE PC-01                      TO DP072-RPT-PGM-TYP-ID.     24380099
243900     MOVE SU006-DFLT-OPER-UNT-ID     TO DP072-ORIGIN-OPER-UNT-ID. 24390099
244000     MOVE SU006-OPER-UNT-ID          TO DP072-OPER-UNT-ID.        24400099
244100     MOVE 1                          TO DP072-ORIGIN-FCLTY-ID     24410099
244200                                        DP072-FCLTY-ID.           24420099
244300     SET DP072-VALIDATE              TO TRUE.                     24430099
244400                                                                  24440099
244500     EXEC CICS                                                    24450099
244600         LINK PROGRAM  (PC-PRTR-VALIDATION-PGM)                   24460099
244700              COMMAREA (DP072-COMM-AREA)                          24470099
244800              RESP     (PV-CICS-RESPONSE)                         24480099
244900     END-EXEC                                                     24490099
245000                                                                  24500099
245100     EVALUATE TRUE                                                24510099
245200         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 24520099
245300             CONTINUE                                             24530099
245400         WHEN OTHER                                               24540099
245500               MOVE '3350-VALIDATE-PRINTER'                       24550099
245600                                    TO DP013-PARAGRAPH            24560099
245700               MOVE PV-CICS-RESPONSE                              24570099
245800                                    TO DP013-MESSAGE-TEXT(1)      24580099
245900               SET DP013-LINK-RETURN                              24590099
246000                   DP013-CICS-ABEND                               24600099
246100                   DP013-NO-ROLLBACK TO TRUE                      24610099
246200               PERFORM DP014-0000-PROCESS-ABEND                   24620099
246300     END-EVALUATE.                                                24630099
246400                                                                  24640099
246410                                                                  24641099
246420***************************************************************** 24642099
246430* CHECK TO SEE THAT DC IS SET UP TO SEND REPORT AS A .TXT       * 24643099
246440* INSTEAD OF PRINTING TO AN ACTUAL PRINTER.                     * 24644099
246450***************************************************************** 24645099
246460 3360-VALIDATE-PRINT-TO-FILE.                                     24646099
246470                                                                  24647099
246480     SET PS-PRINT-TO-FILE-NO  TO TRUE                             24648099
246481     MOVE  SU006-OPER-UNT-ID  TO KRPRPM-LOC-ID                    24648199
246490                                                                  24649099
246491     EXEC SQL                                                     24649199
246492            SELECT  FUNC_TXT                                      24649299
246493              INTO :KRPRPM-FUNC-TXT                               24649399
246494              FROM  TKRPRPM                                       24649499
246495             WHERE  LOC_ID            = :KRPRPM-LOC-ID            24649599
246496               AND  INTFC_SYS_CDE     = 'KHL'                     24649699
246497               AND  SYS_PRC_FUNC_CDE  = 'PRTFIL'                  24649799
246498               AND  FUNC_PRC_STAT_CDE = 'AC'                      24649899
246499               AND  FUNC_BEG_TMST    <= CURRENT TIMESTAMP         24649999
246500               AND  FUNC_END_TMST    >= CURRENT TIMESTAMP         24650099
246501               AND  FUNC_TXT          = 'Y'                       24650199
246502     END-EXEC.                                                    24650299
246503                                                                  24650399
246504     IF  SQLCODE = ZERO                                           24650499
246505         SET PS-PRINT-TO-FILE-YES TO TRUE                         24650599
246506     ELSE                                                         24650699
246507     IF  SQLCODE = +100                                           24650799
246508         SET PS-PRINT-TO-FILE-NO  TO TRUE                         24650899
246509     ELSE                                                         24650999
246510         MOVE '3360-VALIDATE-PRINT-TO-FILE'                       24651099
246511                                    TO DP013-PARAGRAPH            24651199
246512         MOVE PV-CICS-RESPONSE                                    24651299
246513                                    TO DP013-MESSAGE-TEXT(1)      24651399
246514         SET DP013-LINK-RETURN                                    24651499
246515             DP013-CICS-ABEND                                     24651599
246516             DP013-NO-ROLLBACK TO TRUE                            24651699
246517         PERFORM DP014-0000-PROCESS-ABEND                         24651799
246535     END-IF.                                                      24653599
246536                                                                  24653699
246537                                                                  24653799
246538                                                                  24653899
246540******************************************************************24654099
246600 3400-GET-UNT-AUD-ERR-IND.                                        24660099
246700                                                                  24670099
246800     MOVE SU006-AUDIT-CNTL-NBR TO DK-AUDIT-CNTL-NBR.              24680099
246900                                                                  24690099
247000     EXEC SQL                                                     24700099
247100            SELECT UNT_AUD_ERR_IND                                24710099
247200            INTO   :SUATRN-UNT-AUD-ERR-IND                        24720099
247300            FROM   TSUATRN                                        24730099
247400            WHERE  AUD_CNTL_NBR   = :DK-AUDIT-CNTL-NBR            24740099
247500              AND  UNT_AUD_ERR_IND = 'Y'                          24750099
247600     END-EXEC.                                                    24760099
247700                                                                  24770099
247800     EVALUATE TRUE                                                24780099
247900       WHEN SQLCODE = ZERO                                        24790099
248000       WHEN SQLCODE = -811                                        24800099
248100           SET SU006-AUD-ERR            TO TRUE                   24810099
248200       WHEN SQLCODE = +100                                        24820099
248300           SET SU006-NO-AUD-ERR         TO TRUE                   24830099
248400       WHEN OTHER                                                 24840099
248500           MOVE '3400-GET-UNT-AUD-ERR-IND'                        24850099
248600                                         TO DP013-PARAGRAPH       24860099
248700           MOVE 'SELECT AUDIT ERRORS'  TO DP013-MESSAGE-TEXT (1)  24870099
248800           MOVE DK-AUDIT-CNTL-NBR                                 24880099
248900                                 TO PV-DISPLAY-AUDIT-CNTL-NBR     24890099
249000           MOVE PV-DISPLAY-AUDIT-CNTL-NBR                         24900099
249100                                       TO DP013-MESSAGE-TEXT (2)  24910099
249200           MOVE SQLCA                  TO DP013-SQLCA             24920099
249300           MOVE 'TSUATRN'            TO DP013-DB2-TABLE-NAME (1)  24930099
249400           SET DP013-DB2-ABEND         TO TRUE                    24940099
249500           SET DP013-NO-ROLLBACK       TO TRUE                    24950099
249600           PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                 24960099
249700                                                                  24970099
249800           MOVE PM-DB2-FATAL-ERROR-MSG TO AMSGLNO                 24980099
249900           PERFORM 8100-SEND-DATA-ONLY                            24990099
250000           PERFORM 8200-RETURN-TRANID                             25000099
250100     END-EVALUATE.                                                25010099
250200                                                                  25020099
250300 3450-CHECK-OVER-SHORT.                                           25030099
250400     EXEC SQL                                                     25040099
250500         SELECT                                                   25050099
250600                 B.VILN_GP_SEQ_NBR                                25060099
250700         INTO    :SUEXCP-VILN-GP-SEQ-NBR                          25070099
250800         FROM    TSUAUPC A                                        25080099
250900              ,  TSUEXCP B                                        25090099
251000         WHERE                                                    25100099
251100             A.AUD_CNTL_NBR       = :DK-AUDIT-CNTL-NBR            25110099
251200         AND A.AUD_CNTL_NBR       = B.AUD_CNTL_NBR                25120099
251300         AND A.SCN_TMST           = B.SCN_TMST                    25130099
251400         AND B.VILN_GP_SEQ_NBR    IN (29, 30)                     25140099
251500     END-EXEC.                                                    25150099
251600                                                                  25160099
251700     EVALUATE TRUE                                                25170099
251800       WHEN SQLCODE = ZERO                                        25180099
251900       WHEN SQLCODE = -811                                        25190099
252000           SET SU006-AUD-ERR            TO TRUE                   25200099
252100       WHEN SQLCODE = +100                                        25210099
252200           SET SU006-NO-AUD-ERR         TO TRUE                   25220099
252300       WHEN OTHER                                                 25230099
252400           MOVE '3450-CHECK-OVER-SHORT'                           25240099
252500                                         TO DP013-PARAGRAPH       25250099
252600           MOVE 'SELECT OVER/SHORTS'   TO DP013-MESSAGE-TEXT (1)  25260099
252700           MOVE DK-AUDIT-CNTL-NBR                                 25270099
252800                                 TO PV-DISPLAY-AUDIT-CNTL-NBR     25280099
252900           MOVE PV-DISPLAY-AUDIT-CNTL-NBR                         25290099
253000                                       TO DP013-MESSAGE-TEXT (2)  25300099
253100           MOVE SQLCA                  TO DP013-SQLCA             25310099
253200           MOVE 'TSUAUPC'            TO DP013-DB2-TABLE-NAME (1)  25320099
253300           MOVE 'TSUEXCP'            TO DP013-DB2-TABLE-NAME (2)  25330099
253400           SET DP013-DB2-ABEND         TO TRUE                    25340099
253500           SET DP013-NO-ROLLBACK       TO TRUE                    25350099
253600           PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                 25360099
253700                                                                  25370099
253800           MOVE PM-DB2-FATAL-ERROR-MSG TO AMSGLNO                 25380099
253900           PERFORM 8100-SEND-DATA-ONLY                            25390099
254000           PERFORM 8200-RETURN-TRANID                             25400099
254100     END-EVALUATE.                                                25410099
254200                                                                  25420099
269700******************************************************************26970099
269800 3590-PROCESS-DISTHD-PREPK-UPD.                                   26980099
269900                                                                  26990099
270000      MOVE SUT00015-PO-NBR       TO RECITM-ORD-NBR.               27000099
270100      MOVE SUT00015-RCVR-SEQ-NBR TO RECITM-REC-SEQ-NBR.           27010099
270200                                                                  27020099
270300      PERFORM 3600-OPEN-PREPK-LNE-CSR.                            27030099
270400      PERFORM 3700-FETCH-PREPK-LNE-CSR                            27040099
270500            UNTIL PS-EOC-PREPK-LNE-CSR.                           27050099
270600      PERFORM 3800-CLOSE-PREPK-LNE-CSR.                           27060099
270700                                                                  27070099
270800******************************************************************27080099
270900 3595-PROCESS-DISTRF-PREPK-UPD.                                   27090099
271000                                                                  27100099
271100      MOVE SUT00015-PO-NBR       TO RECITM-ORD-NBR.               27110099
271200      MOVE SUT00015-RCVR-SEQ-NBR TO RECITM-REC-SEQ-NBR.           27120099
271300                                                                  27130099
271400      PERFORM 3610-OPEN-PREPK-RF-CSR.                             27140099
271500      PERFORM 3710-FETCH-PREPK-RF-CSR                             27150099
271600            UNTIL PS-EOC-PREPK-RF-CSR.                            27160099
271700      PERFORM 3805-CLOSE-PREPK-RF-CSR.                            27170099
271800                                                                  27180099
271900******************************************************************27190099
272000 3600-OPEN-PREPK-LNE-CSR.                                         27200099
272100                                                                  27210099
272200     EXEC SQL                                                     27220099
272300         OPEN PREPK_LNE_CSR                                       27230099
272400     END-EXEC.                                                    27240099
272500                                                                  27250099
272600     EVALUATE TRUE                                                27260099
272700         WHEN SQLCODE = ZERO                                      27270099
272800             SET PS-NOT-EOC-PREPK-LNE-CSR TO TRUE                 27280099
272900                                                                  27290099
273000         WHEN SQLWARN0 NOT = SPACES                               27300099
273100         WHEN SQLCODE < ZERO                                      27310099
273200         WHEN SQLCODE > ZERO                                      27320099
273300             MOVE SU006-PO  TO PV-DISPLAY-PO-NBR                  27330099
273400             MOVE SU006-REC-SEQ-NBR TO PV-DISPLAY-RECVR           27340099
273500             MOVE DK-PREPK-ID       TO PV-DISPLAY-PREPK-ID        27350099
273600             MOVE '3600-OPEN-PREPK-LNE-CSR  '                     27360099
273700                                   TO DP013-PARAGRAPH             27370099
273800             MOVE 'OPEN PREPK_LNE_CSR'                            27380099
273900                                    TO DP013-MESSAGE-TEXT (1)     27390099
274000             STRING 'PO/RCVR/PCK:'    DELIMITED BY SIZE           27400099
274100             PV-DISPLAY-PO-NBR '-'     DELIMITED BY SIZE          27410099
274200             PV-DISPLAY-RECVR      '-'  DELIMITED BY SIZE         27420099
274300             PV-DISPLAY-PREPK-ID      DELIMITED BY SIZE           27430099
274400                                 INTO DP013-MESSAGE-TEXT (2)      27440099
274500             MOVE SQLCA            TO DP013-SQLCA                 27450099
274600             MOVE 'TRECITM'        TO DP013-DB2-TABLE-NAME (1)    27460099
274700             SET DP013-DB2-ABEND   TO TRUE                        27470099
274800             SET DP013-NO-ROLLBACK TO TRUE                        27480099
274900             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               27490099
275000             MOVE PM-DB2-FATAL-ERROR-MSG TO AMSGLNO               27500099
275100             PERFORM 8100-SEND-DATA-ONLY                          27510099
275200             PERFORM 8200-RETURN-TRANID                           27520099
275300     END-EVALUATE.                                                27530099
275400                                                                  27540099
275500******************************************************************27550099
275600 3610-OPEN-PREPK-RF-CSR.                                          27560099
275700                                                                  27570099
275800     EXEC SQL                                                     27580099
275900         OPEN PREPK_RFLNE_CSR                                     27590099
276000     END-EXEC.                                                    27600099
276100                                                                  27610099
276200     EVALUATE TRUE                                                27620099
276300         WHEN SQLCODE = ZERO                                      27630099
276400             SET PS-NOT-EOC-PREPK-RF-CSR TO TRUE                  27640099
276500                                                                  27650099
276600         WHEN SQLWARN0 NOT = SPACES                               27660099
276700         WHEN SQLCODE < ZERO                                      27670099
276800         WHEN SQLCODE > ZERO                                      27680099
276900             MOVE SU006-PO          TO PV-DISPLAY-PO-NBR          27690099
277000             MOVE SU006-REC-SEQ-NBR TO PV-DISPLAY-RECVR           27700099
277100             MOVE '3610-OPEN-PREPK-RF-CSR   '                     27710099
277200                                    TO DP013-PARAGRAPH            27720099
277300             MOVE 'OPEN PREPK_RFLNE_CSR'                          27730099
277400                                    TO DP013-MESSAGE-TEXT (1)     27740099
277500             STRING 'PO/RCVR: '        DELIMITED BY SIZE          27750099
277600             PV-DISPLAY-PO-NBR '-'     DELIMITED BY SIZE          27760099
277700             PV-DISPLAY-RECVR          DELIMITED BY SIZE          27770099
277800                                 INTO DP013-MESSAGE-TEXT (2)      27780099
277900             MOVE SQLCA            TO DP013-SQLCA                 27790099
278000             MOVE 'TRECITM'        TO DP013-DB2-TABLE-NAME (1)    27800099
278100             SET DP013-DB2-ABEND   TO TRUE                        27810099
278200             SET DP013-NO-ROLLBACK TO TRUE                        27820099
278300             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               27830099
278400             MOVE PM-DB2-FATAL-ERROR-MSG TO AMSGLNO               27840099
278500             PERFORM 8100-SEND-DATA-ONLY                          27850099
278600             PERFORM 8200-RETURN-TRANID                           27860099
278700     END-EVALUATE.                                                27870099
278800                                                                  27880099
278900******************************************************************27890099
279000 3700-FETCH-PREPK-LNE-CSR.                                        27900099
279100                                                                  27910099
279200     EXEC SQL                                                     27920099
279300         FETCH PREPK_LNE_CSR                                      27930099
279400         INTO  :RECITM-ORD-LNE-NBR                                27940099
279500     END-EXEC.                                                    27950099
279600                                                                  27960099
279700     EVALUATE TRUE                                                27970099
279800         WHEN SQLCODE = ZERO                                      27980099
279900            MOVE RECITM-ORD-LNE-NBR TO DISTHD-ORD-LNE-NBR         27990099
280000            PERFORM 3810-UPD-DISTHD-FCSE-AREA                     28000099
280100                                                                  28010099
280200         WHEN SQLCODE = +100                                      28020099
280300             SET PS-EOC-PREPK-LNE-CSR TO TRUE                     28030099
280400                                                                  28040099
280500         WHEN SQLWARN0 NOT = SPACES                               28050099
280600         WHEN SQLCODE < ZERO                                      28060099
280700         WHEN SQLCODE > ZERO                                      28070099
280800             MOVE SU006-PO  TO PV-DISPLAY-PO-NBR                  28080099
280900             MOVE SU006-REC-SEQ-NBR TO PV-DISPLAY-RECVR           28090099
281000             MOVE DK-PREPK-ID       TO PV-DISPLAY-PREPK-ID        28100099
281100             MOVE '3700-FETCH-PREPK-LNE-CSR '                     28110099
281200                                   TO DP013-PARAGRAPH             28120099
281300             MOVE 'FETCH OF PREPK_LNE_CSR'                        28130099
281400                                   TO DP013-MESSAGE-TEXT (1)      28140099
281500             STRING 'PO/RCVR/PCK:'    DELIMITED BY SIZE           28150099
281600             PV-DISPLAY-PO-NBR '-'  DELIMITED BY SIZE             28160099
281700             PV-DISPLAY-RECVR  '-'  DELIMITED BY SIZE             28170099
281800             PV-DISPLAY-PREPK-ID    DELIMITED BY SIZE             28180099
281900                                 INTO DP013-MESSAGE-TEXT (2)      28190099
282000             MOVE SQLCA            TO DP013-SQLCA                 28200099
282100             MOVE 'TRECITM'        TO DP013-DB2-TABLE-NAME (1)    28210099
282200             SET DP013-DB2-ABEND   TO TRUE                        28220099
282300             SET DP013-NO-ROLLBACK TO TRUE                        28230099
282400             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               28240099
282500             MOVE PM-DB2-FATAL-ERROR-MSG TO AMSGLNO               28250099
282600             PERFORM 8100-SEND-DATA-ONLY                          28260099
282700             PERFORM 8200-RETURN-TRANID                           28270099
282800     END-EVALUATE.                                                28280099
282900                                                                  28290099
283000******************************************************************28300099
283100 3710-FETCH-PREPK-RF-CSR.                                         28310099
283200                                                                  28320099
283300     EXEC SQL                                                     28330099
283400         FETCH PREPK_RFLNE_CSR                                    28340099
283500         INTO  :RECITM-ORD-LNE-NBR                                28350099
283600     END-EXEC.                                                    28360099
283700                                                                  28370099
283800     EVALUATE TRUE                                                28380099
283900         WHEN SQLCODE = ZERO                                      28390099
284000            MOVE RECITM-ORD-LNE-NBR TO DISTHD-ORD-LNE-NBR         28400099
284100            PERFORM 3810-UPD-DISTHD-FCSE-AREA                     28410099
284200                                                                  28420099
284300         WHEN SQLCODE = +100                                      28430099
284400             SET PS-EOC-PREPK-RF-CSR TO TRUE                      28440099
284500                                                                  28450099
284600         WHEN SQLWARN0 NOT = SPACES                               28460099
284700         WHEN SQLCODE < ZERO                                      28470099
284800         WHEN SQLCODE > ZERO                                      28480099
284900             MOVE SU006-PO          TO PV-DISPLAY-PO-NBR          28490099
285000             MOVE SU006-REC-SEQ-NBR TO PV-DISPLAY-RECVR           28500099
285100             MOVE '3710-FETCH-PREPK-RF-CSR '                      28510099
285200                                   TO DP013-PARAGRAPH             28520099
285300             MOVE 'FETCH OF PREPK_RFLNE_CSR'                      28530099
285400                                   TO DP013-MESSAGE-TEXT (1)      28540099
285500             STRING 'PO/RCVR:'        DELIMITED BY SIZE           28550099
285600             PV-DISPLAY-PO-NBR '-'    DELIMITED BY SIZE           28560099
285700             PV-DISPLAY-RECVR         DELIMITED BY SIZE           28570099
285800                                 INTO DP013-MESSAGE-TEXT (2)      28580099
285900             MOVE SQLCA            TO DP013-SQLCA                 28590099
286000             MOVE 'TRECITM'        TO DP013-DB2-TABLE-NAME (1)    28600099
286100             SET DP013-DB2-ABEND   TO TRUE                        28610099
286200             SET DP013-NO-ROLLBACK TO TRUE                        28620099
286300             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               28630099
286400             MOVE PM-DB2-FATAL-ERROR-MSG TO AMSGLNO               28640099
286500             PERFORM 8100-SEND-DATA-ONLY                          28650099
286600             PERFORM 8200-RETURN-TRANID                           28660099
286700     END-EVALUATE.                                                28670099
286800                                                                  28680099
286900******************************************************************28690099
287000 3800-CLOSE-PREPK-LNE-CSR.                                        28700099
287100                                                                  28710099
287200     EXEC SQL                                                     28720099
287300         CLOSE PREPK_LNE_CSR                                      28730099
287400     END-EXEC.                                                    28740099
287500                                                                  28750099
287600     EVALUATE TRUE                                                28760099
287700         WHEN SQLCODE = ZERO                                      28770099
287800             CONTINUE                                             28780099
287900                                                                  28790099
288000         WHEN SQLWARN0 NOT = SPACES                               28800099
288100         WHEN SQLCODE < ZERO                                      28810099
288200         WHEN SQLCODE > ZERO                                      28820099
288300             MOVE SU006-PO  TO PV-DISPLAY-PO-NBR                  28830099
288400             MOVE SU006-REC-SEQ-NBR TO PV-DISPLAY-RECVR           28840099
288500             MOVE DK-PREPK-ID       TO PV-DISPLAY-PREPK-ID        28850099
288600             MOVE '3800-CLOSE-PREPK-LNE-CSR '                     28860099
288700                                   TO DP013-PARAGRAPH             28870099
288800             MOVE 'CLOSE OF PREPK_LNE_CSR'                        28880099
288900                                   TO DP013-MESSAGE-TEXT (1)      28890099
289000             STRING 'PO/RCVR/PCK:'    DELIMITED BY SIZE           28900099
289100             PV-DISPLAY-PO-NBR '-'   DELIMITED BY SIZE            28910099
289200             PV-DISPLAY-RECVR       '-'  DELIMITED BY SIZE        28920099
289300             PV-DISPLAY-PREPK-ID      DELIMITED BY SIZE           28930099
289400                                 INTO DP013-MESSAGE-TEXT (2)      28940099
289500             MOVE SQLCA            TO DP013-SQLCA                 28950099
289600             MOVE 'TRECITM'        TO DP013-DB2-TABLE-NAME (1)    28960099
289700             SET DP013-DB2-ABEND   TO TRUE                        28970099
289800             SET DP013-NO-ROLLBACK TO TRUE                        28980099
289900             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               28990099
290000             MOVE PM-DB2-FATAL-ERROR-MSG TO AMSGLNO               29000099
290100             PERFORM 8100-SEND-DATA-ONLY                          29010099
290200             PERFORM 8200-RETURN-TRANID                           29020099
290300     END-EVALUATE.                                                29030099
290400                                                                  29040099
290500******************************************************************29050099
290600 3805-CLOSE-PREPK-RF-CSR.                                         29060099
290700                                                                  29070099
290800     EXEC SQL                                                     29080099
290900         CLOSE PREPK_RFLNE_CSR                                    29090099
291000     END-EXEC.                                                    29100099
291100                                                                  29110099
291200     EVALUATE TRUE                                                29120099
291300         WHEN SQLCODE = ZERO                                      29130099
291400             CONTINUE                                             29140099
291500                                                                  29150099
291600         WHEN SQLWARN0 NOT = SPACES                               29160099
291700         WHEN SQLCODE < ZERO                                      29170099
291800         WHEN SQLCODE > ZERO                                      29180099
291900             MOVE SU006-PO          TO PV-DISPLAY-PO-NBR          29190099
292000             MOVE SU006-REC-SEQ-NBR TO PV-DISPLAY-RECVR           29200099
292100             MOVE '3805-CLOSE-PREPK-RF-CSR '                      29210099
292200                                   TO DP013-PARAGRAPH             29220099
292300             MOVE 'CLOSE OF PREPK_RFLNE_CSR'                      29230099
292400                                   TO DP013-MESSAGE-TEXT (1)      29240099
292500             STRING 'PO/RCVR:'        DELIMITED BY SIZE           29250099
292600             PV-DISPLAY-PO-NBR '-'    DELIMITED BY SIZE           29260099
292700             PV-DISPLAY-RECVR         DELIMITED BY SIZE           29270099
292800                                 INTO DP013-MESSAGE-TEXT (2)      29280099
292900             MOVE SQLCA            TO DP013-SQLCA                 29290099
293000             MOVE 'TRECITM'        TO DP013-DB2-TABLE-NAME (1)    29300099
293100             SET DP013-DB2-ABEND   TO TRUE                        29310099
293200             SET DP013-NO-ROLLBACK TO TRUE                        29320099
293300             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               29330099
293400             MOVE PM-DB2-FATAL-ERROR-MSG TO AMSGLNO               29340099
293500             PERFORM 8100-SEND-DATA-ONLY                          29350099
293600             PERFORM 8200-RETURN-TRANID                           29360099
293700     END-EVALUATE.                                                29370099
293800                                                                  29380099
293900******************************************************************29390099
294000 3810-UPD-DISTHD-FCSE-AREA.                                       29400099
294100                                                                  29410099
294200     EXEC SQL                                                     29420099
294300         UPDATE TDISTHD                                           29430099
294400             SET FCSE_FCLTY_AREA_ID = :DISTHD-FCSE-FCLTY-AREA-ID  29440099
294500         WHERE  ORD_NBR             = :SU006-PO                   29450099
294600           AND  RCVR_SEQ_NBR        = :SU006-REC-SEQ-NBR          29460099
294700           AND  ORD_LNE_NBR         = :DISTHD-ORD-LNE-NBR         29470099
294800     END-EXEC.                                                    29480099
294900                                                                  29490099
295000     EVALUATE TRUE                                                29500099
295100         WHEN SQLCODE = ZERO                                      29510099
295200         WHEN SQLCODE = +100                                      29520099
295300             CONTINUE                                             29530099
295400                                                                  29540099
295500         WHEN SQLWARN0 NOT = SPACES                               29550099
295600         WHEN SQLCODE NOT EQUAL ZERO                              29560099
295700             MOVE SU006-PO           TO PV-DISPLAY-PO-NBR         29570099
295800             MOVE DISTHD-ORD-LNE-NBR TO  PV-DISPLAY-PO-LINE-NBR   29580099
295900             MOVE SU006-REC-SEQ-NBR  TO PV-DISPLAY-RECVR          29590099
296000             MOVE '3810-UPD-DISTHD-FCSE-AREA'                     29600099
296100                             TO DP013-PARAGRAPH                   29610099
296200             MOVE 'UPD DISTHD FCLTY AREA '                        29620099
296300                             TO DP013-MESSAGE-TEXT(1)             29630099
296400             STRING 'PO/RCV/LNE '      DELIMITED BY SIZE          29640099
296500                 PV-DISPLAY-PO-NBR '-'                            29650099
296600                                       DELIMITED BY SIZE          29660099
296700                 PV-DISPLAY-RECVR  '-'                            29670099
296800                                       DELIMITED BY SIZE          29680099
296900                 PV-DISPLAY-PO-LINE-NBR                           29690099
297000                                       DELIMITED BY SIZE          29700099
297100                           INTO DP013-MESSAGE-TEXT(2)             29710099
297200             MOVE SQLCA      TO DP013-SQLCA                       29720099
297300             MOVE 'TDISTHD' TO DP013-DB2-TABLE-NAME(1)            29730099
297400             SET DP013-DB2-ABEND   TO TRUE                        29740099
297500             SET DP013-NO-ROLLBACK TO TRUE                        29750099
297600             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               29760099
297700     END-EVALUATE.                                                29770099
297800                                                                  29780099
297900                                                                  29790099
298500 4000-XCTL-LRT-MENU.                                              29850099
298600     SET SU006-INITIALIZE-SCREEN     TO TRUE.                     29860099
298700     MOVE PC-CURRENT-PROGRAM-NAME TO SU006-LAST-PROGRAM.          29870099
298800                                                                  29880099
298900     MOVE LENGTH OF CA-COMMAREA    TO PV-COMMAREA-LENGTH          29890099
299000     EXEC CICS                                                    29900099
299100         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    29910099
299200               COMMAREA  (CA-COMMAREA)                            29920099
299300               LENGTH    (PV-COMMAREA-LENGTH)                     29930099
299400               RESP      (PV-CICS-RESPONSE)                       29940099
299500     END-EXEC.                                                    29950099
299600                                                                  29960099
299700     EVALUATE TRUE                                                29970099
299800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 29980099
299900             CONTINUE                                             29990099
300000         WHEN OTHER                                               30000099
300100             MOVE '4000-XCTL-TO-LRT-MENU'                         30010099
300200                 TO DP013-PARAGRAPH                               30020099
300300             MOVE 'UNABLE TO XCTL TO PROGRAM: '                   30030099
300400                 TO DP013-MESSAGE-TEXT (1)                        30040099
300500             MOVE PV-TRANSFER-PROGRAM                             30050099
300600                 TO DP013-MESSAGE-TEXT (2)                        30060099
300700             SET DP013-CICS-ABEND  TO TRUE                        30070099
300800             SET DP013-NO-ROLLBACK TO TRUE                        30080099
300900             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               30090099
301000             MOVE PC-TRANS-UNAVAILABLE-MSG TO AMSGLNO             30100099
301100             SET SU006-PROCESS-SCREEN TO TRUE                     30110099
301200             PERFORM 8000-SEND-MAP                                30120099
301300             PERFORM 8200-RETURN-TRANID                           30130099
301400     END-EVALUATE.                                                30140099
301500                                                                  30150099
301600 4100-XCTL-CHECK-IN.                                              30160099
301700     SET SU001-INITIALIZE-SCREEN     TO TRUE.                     30170099
301800     MOVE PC-CURRENT-PROGRAM-NAME TO SU001-LAST-PROGRAM.          30180099
301900                                                                  30190099
302000     MOVE LENGTH OF CA-CHECK-IN-COMMAREA                          30200099
302100                                   TO PV-COMMAREA-LENGTH          30210099
302200     EXEC CICS                                                    30220099
302300         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    30230099
302400               COMMAREA  (CA-CHECK-IN-COMMAREA)                   30240099
302500               LENGTH    (PV-COMMAREA-LENGTH)                     30250099
302600               RESP      (PV-CICS-RESPONSE)                       30260099
302700     END-EXEC.                                                    30270099
302800                                                                  30280099
302900                                                                  30290099
303000     EVALUATE TRUE                                                30300099
303100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 30310099
303200             CONTINUE                                             30320099
303300         WHEN OTHER                                               30330099
303400             MOVE '4100-XCTL-CHECK-IN'                            30340099
303500                 TO DP013-PARAGRAPH                               30350099
303600             MOVE 'UNABLE TO XCTL TO PROGRAM: '                   30360099
303700                 TO DP013-MESSAGE-TEXT (1)                        30370099
303800             MOVE PV-TRANSFER-PROGRAM                             30380099
303900                 TO DP013-MESSAGE-TEXT (2)                        30390099
304000             SET DP013-CICS-ABEND  TO TRUE                        30400099
304100             SET DP013-NO-ROLLBACK TO TRUE                        30410099
304200             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               30420099
304300             MOVE PC-TRANS-UNAVAILABLE-MSG TO AMSGLNO             30430099
304400             SET SU006-PROCESS-SCREEN TO TRUE                     30440099
304500             PERFORM 8000-SEND-MAP                                30450099
304600             PERFORM 8200-RETURN-TRANID                           30460099
304700     END-EVALUATE.                                                30470099
304800                                                                  30480099
304900*                                                                 30490099
305000 4200-XCTL-TO-HELP.                                               30500099
305100                                                                  30510099
305200     MOVE LENGTH OF PC192-COMMAREA    TO PV-COMMAREA-LENGTH.      30520099
305300     SET  SU006-INITIALIZE-SCREEN     TO TRUE.                    30530099
305400     MOVE CA-COMMAREA                 TO PC192-HOST-SAVE-AREA.    30540099
305500                                                                  30550099
305600     EXEC CICS                                                    30560099
305700         XCTL                                                     30570099
305800             PROGRAM   (PV-TRANSFER-PROGRAM)                      30580099
305900             COMMAREA  (PC192-COMMAREA)                           30590099
306000             LENGTH    (PV-COMMAREA-LENGTH)                       30600099
306100             RESP      (PV-CICS-RESPONSE)                         30610099
306200     END-EXEC.                                                    30620099
306300                                                                  30630099
306400     EVALUATE TRUE                                                30640099
306500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 30650099
306600              CONTINUE                                            30660099
306700         WHEN OTHER                                               30670099
306800             MOVE '4200-XCTL-TO-HELP '                            30680099
306900                 TO DP013-PARAGRAPH                               30690099
307000             MOVE 'SUKRF536 - UNABLE TO XCTL TO PROGRAM: '        30700099
307100                 TO DP013-MESSAGE-TEXT (1)                        30710099
307200             MOVE PV-TRANSFER-PROGRAM                             30720099
307300                 TO DP013-MESSAGE-TEXT (2)                        30730099
307400             SET DP013-CICS-ABEND  TO TRUE                        30740099
307500             SET DP013-ROLLBACK TO TRUE                           30750099
307600             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               30760099
307700             MOVE PC-TRANS-UNAVAILABLE-MSG TO AMSGLNO             30770099
307800             SET SU006-PROCESS-SCREEN TO TRUE                     30780099
307900             PERFORM 8000-SEND-MAP                                30790099
308000             PERFORM 8200-RETURN-TRANID                           30800099
308100     END-EVALUATE.                                                30810099
308200                                                                  30820099
308300                                                                  30830099
308400*----------------------------------------------------------------*30840099
308500*  LINK TO SUKCS594 TO DETERMINE IF THE AUDIT PASSED OR FAILED    30850099
308600*----------------------------------------------------------------*30860099
308700 7000-LINK-SUKCS594.                                              30870099
308800                                                                  30880099
308900     MOVE LENGTH OF CA-SUMMARY-COMMAREA                           30890099
309000                                         TO PV-COMMAREA-LENGTH.   30900099
309100                                                                  30910099
309200     EXEC CICS                                                    30920099
309300         LINK PROGRAM  (PC-SUKCS594)                              30930099
309400              COMMAREA (CA-SUMMARY-COMMAREA)                      30940099
309500              LENGTH   (PV-COMMAREA-LENGTH)                       30950099
309600              RESP     (PV-CICS-RESPONSE)                         30960099
309700     END-EXEC.                                                    30970099
309800                                                                  30980099
309900     EVALUATE TRUE                                                30990099
310000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 31000099
310100              IF  SU026-INVALID-REQUEST OR                        31010099
310200                  SU026-DB2-ERROR                                 31020099
310300                  STRING ' SUKRF536 - '        DELIMITED BY SIZE  31030099
310400                         '7000-LINK-SUKCS594 ' DELIMITED BY SIZE  31040099
310500                         ' RETURN MESSAGE - '  DELIMITED BY SIZE  31050099
310600                         SU026-AUDIT-VALIDATION-SW                31060099
310700                                               DELIMITED BY SIZE  31070099
310800                                          INTO PV-CICS-MSG-AREA   31080099
310900                  MOVE LENGTH OF PV-CICS-MSG-AREA                 31090099
311000                                            TO PV-COMMAREA-LENGTH 31100099
311100                  PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG          31110099
311200                                                                  31120099
311300                                                                  31130099
311400                  MOVE '7000-LINK-SUKCS594'                       31140099
311500                                  TO DP013-PARAGRAPH              31150099
311600                  MOVE 'LINK TO SUKCS594               '          31160099
311700                                  TO DP013-MESSAGE-TEXT(1)        31170099
311800                  STRING 'MSG - '            DELIMITED BY SIZE    31180099
311900                         SU026-AUDIT-VALIDATION-SW                31190099
312000                                             DELIMITED BY SIZE    31200099
312100                                  INTO DP013-MESSAGE-TEXT (2)     31210099
312200                  MOVE 'CHECK CSSL FOR MORE DETAIL     '          31220099
312300                                    TO DP013-MESSAGE-TEXT (3)     31230099
312400                  MOVE SQLCA     TO DP013-SQLCA                   31240099
312500                  SET DP013-DB2-ABEND                             31250099
312600                                  TO TRUE                         31260099
312700                  SET DP013-ROLLBACK                              31270099
312800                                  TO TRUE                         31280099
312900                  SET DP013-XCTL-DISPLAY-RESTART                  31290099
313000                                  TO TRUE                         31300099
313100                  PERFORM DP014-0000-PROCESS-ABEND                31310099
313200              END-IF                                              31320099
313300         WHEN OTHER                                               31330099
313400              STRING ' SUKRF536 (OTHER) -' DELIMITED BY SIZE      31340099
313500                     '7000-LINK-SUKCS594 ' DELIMITED BY SIZE      31350099
313600                     ' RETURN MESSAGE - '  DELIMITED BY SIZE      31360099
313700                     SU026-AUDIT-VALIDATION-SW                    31370099
313800                                           DELIMITED BY SIZE      31380099
313900                                      INTO PV-CICS-MSG-AREA       31390099
314000              MOVE LENGTH OF PV-CICS-MSG-AREA                     31400099
314100                                        TO PV-COMMAREA-LENGTH     31410099
314200              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              31420099
314300                                                                  31430099
314400              MOVE '7000-LINK-SUKCS594'                           31440099
314500                              TO DP013-PARAGRAPH                  31450099
314600              MOVE 'LINK TO SUKCS594               '              31460099
314700                              TO DP013-MESSAGE-TEXT(1)            31470099
314800              STRING 'MSG - '            DELIMITED BY SIZE        31480099
314900                     SU026-AUDIT-VALIDATION-SW                    31490099
315000                                         DELIMITED BY SIZE        31500099
315100                              INTO DP013-MESSAGE-TEXT (2)         31510099
315200              MOVE 'CHECK CSSL FOR MORE DETAIL     '              31520099
315300                                TO DP013-MESSAGE-TEXT (3)         31530099
315400              MOVE SQLCA     TO DP013-SQLCA                       31540099
315500              SET DP013-DB2-ABEND                                 31550099
315600                              TO TRUE                             31560099
315700              SET DP013-ROLLBACK                                  31570099
315800                              TO TRUE                             31580099
315900              SET DP013-XCTL-DISPLAY-RESTART                      31590099
316000                              TO TRUE                             31600099
316100              PERFORM DP014-0000-PROCESS-ABEND                    31610099
316200     END-EVALUATE.                                                31620099
316300                                                                  31630099
316400                                                                  31640099
316500*----------------------------------------------------------------*31650099
316600*  LINK TO SUKCS763 TO UPDATE AUDIT - PASS/FAIL/NO LONGER NEEDED  31660099
316700*----------------------------------------------------------------*31670099
316800 7010-LINK-SUKCS763.                                              31680099
316900                                                                  31690099
317000     MOVE LENGTH OF SU047-COMMAREA-REC   TO PV-COMMAREA-LENGTH.   31700099
317100                                                                  31710099
317200     EXEC CICS                                                    31720099
317300         LINK PROGRAM  (PC-SUKCS763)                              31730099
317400              COMMAREA (SU047-COMMAREA-REC)                       31740099
317500              LENGTH   (PV-COMMAREA-LENGTH)                       31750099
317600              RESP     (PV-CICS-RESPONSE)                         31760099
317700     END-EXEC.                                                    31770099
317800                                                                  31780099
317900     EVALUATE TRUE                                                31790099
318000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 31800099
318100              IF  SU047-SUCCESSFUL                                31810099
318200                  CONTINUE                                        31820099
318300              ELSE                                                31830099
318400                  STRING ' SUKRF536 - '                           31840099
318500                         '7010-LINK-SUKCS763 '                    31850099
318600                         ' RETURN MESSAGE - '                     31860099
318700                         SU047-CRA-RET-MSG     DELIMITED BY SIZE  31870099
318800                                          INTO PV-CICS-MSG-AREA   31880099
318900                  MOVE LENGTH OF PV-CICS-MSG-AREA                 31890099
319000                                            TO PV-COMMAREA-LENGTH 31900099
319100                  PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG          31910099
319200                                                                  31920099
319300                  MOVE '7010-LINK-SUKCS763' TO DP013-PARAGRAPH    31930099
319400                  MOVE 'LINK TO SUKCS763               '          31940099
319500                                  TO DP013-MESSAGE-TEXT(1)        31950099
319600                  STRING 'MSG - '                                 31960099
319700                         SU047-CRA-RET-MSG   DELIMITED BY SIZE    31970099
319800                                  INTO DP013-MESSAGE-TEXT (2)     31980099
319900                  MOVE 'CHECK CSSL FOR MORE DETAIL     '          31990099
320000                                    TO DP013-MESSAGE-TEXT (3)     32000099
320100                  MOVE SQLCA     TO DP013-SQLCA                   32010099
320200                  SET DP013-DB2-ABEND                             32020099
320300                      DP013-ROLLBACK                              32030099
320400                      DP013-XCTL-DISPLAY-RESTART                  32040099
320500                                  TO TRUE                         32050099
320600                  PERFORM DP014-0000-PROCESS-ABEND                32060099
320700              END-IF                                              32070099
320800                                                                  32080099
320900         WHEN OTHER                                               32090099
321000              STRING ' SUKRF563 (OTHER) -'                        32100099
321100                     '7010-LINK-SUKCS763 '                        32110099
321200                     ' RETURN MESSAGE - '                         32120099
321300                     SU047-CRA-RET-MSG     DELIMITED BY SIZE      32130099
321400                                      INTO PV-CICS-MSG-AREA       32140099
321500              MOVE LENGTH OF PV-CICS-MSG-AREA                     32150099
321600                                        TO PV-COMMAREA-LENGTH     32160099
321700              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              32170099
321800                                                                  32180099
321900              MOVE '7010-LINK-SUKCS763' TO DP013-PARAGRAPH        32190099
322000              MOVE 'LINK TO SUKCS763               '              32200099
322100                              TO DP013-MESSAGE-TEXT(1)            32210099
322200              STRING 'MSG - '                                     32220099
322300                     SU047-CRA-RET-MSG     DELIMITED BY SIZE      32230099
322400                              INTO DP013-MESSAGE-TEXT (2)         32240099
322500              MOVE 'CHECK CSSL FOR MORE DETAIL     '              32250099
322600                                TO DP013-MESSAGE-TEXT (3)         32260099
322700              MOVE SQLCA     TO DP013-SQLCA                       32270099
322800              SET DP013-DB2-ABEND                                 32280099
322900                  DP013-ROLLBACK                                  32290099
323000                  DP013-XCTL-DISPLAY-RESTART                      32300099
323100                              TO TRUE                             32310099
323200              PERFORM DP014-0000-PROCESS-ABEND                    32320099
323300     END-EVALUATE.                                                32330099
323400                                                                  32340099
323500*----------------------------------------------------------------*32350099
323600*  LINK TO SUKRF700 TO COPY THE AUDITED CARTON DATA TO A 100      32360099
323700*  PERCENT AUDIT                                                  32370099
323800*----------------------------------------------------------------*32380099
323900 7100-LINK-SUKRF700.                                              32390099
324000                                                                  32400099
324100     INITIALIZE SU042-COMMAREA.                                   32410099
324200     MOVE SU006-OPER-UNT-ID-X            TO SU042-OPER-UNT-ID-X.  32420099
324300     MOVE SU006-AUDIT-CNTL-NBR-X         TO SU042-AUDIT-CNTL-NBR-X32430099
324400     MOVE LENGTH OF SU042-COMMAREA       TO PV-COMMAREA-LENGTH.   32440099
324500                                                                  32450099
324600     EXEC CICS                                                    32460099
324700         LINK PROGRAM  (PC-AUDIT-COPY-PROGRAM)                    32470099
324800              COMMAREA (SU042-COMMAREA)                           32480099
324900              LENGTH   (PV-COMMAREA-LENGTH)                       32490099
325000              RESP     (PV-CICS-RESPONSE)                         32500099
325100     END-EXEC.                                                    32510099
325200                                                                  32520099
325300     EVALUATE TRUE                                                32530099
325400         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 32540099
325500              IF  SU042-INVALID-REQUEST OR                        32550099
325600                  SU042-DB2-ERROR                                 32560099
325700                  STRING ' SUKRF536 - '        DELIMITED BY SIZE  32570099
325800                         '7100-LINK-SUKRF700 ' DELIMITED BY SIZE  32580099
325900                         ' RETURN MESSAGE - '  DELIMITED BY SIZE  32590099
326000                                                                  32600099
326200                                          INTO PV-CICS-MSG-AREA   32620099
326300                  MOVE LENGTH OF PV-CICS-MSG-AREA                 32630099
326400                                            TO PV-COMMAREA-LENGTH 32640099
326500                  PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG          32650099
326600                                                                  32660099
326700                                                                  32670099
326800                  MOVE '7100-LINK-SUKRF700'                       32680099
326900                                  TO DP013-PARAGRAPH              32690099
327000                  MOVE 'LINK TO SUKRF700               '          32700099
327100                                  TO DP013-MESSAGE-TEXT(1)        32710099
327200                  STRING 'MSG - '            DELIMITED BY SIZE    32720099
327300                         SU042-VALIDATION-SW                      32730099
327400                                             DELIMITED BY SIZE    32740099
327500                                  INTO DP013-MESSAGE-TEXT (2)     32750099
327600                  MOVE 'CHECK CSSL FOR MORE DETAIL     '          32760099
327700                                    TO DP013-MESSAGE-TEXT (3)     32770099
327800                  MOVE SQLCA     TO DP013-SQLCA                   32780099
327900                  SET DP013-DB2-ABEND                             32790099
328000                                  TO TRUE                         32800099
328100                  SET DP013-ROLLBACK                              32810099
328200                                  TO TRUE                         32820099
328300                  SET DP013-XCTL-DISPLAY-RESTART                  32830099
328400                                  TO TRUE                         32840099
328500                  PERFORM DP014-0000-PROCESS-ABEND                32850099
328600              END-IF                                              32860099
328700         WHEN OTHER                                               32870099
328800              STRING ' SUKRF536 (OTHER) -' DELIMITED BY SIZE      32880099
328900                     '7100-LINK-SUKRF700 ' DELIMITED BY SIZE      32890099
329000                     ' RETURN MESSAGE - '  DELIMITED BY SIZE      32900099
329100                     SU042-VALIDATION-SW                          32910099
329200                                           DELIMITED BY SIZE      32920099
329300                                      INTO PV-CICS-MSG-AREA       32930099
329400              MOVE LENGTH OF PV-CICS-MSG-AREA                     32940099
329500                                        TO PV-COMMAREA-LENGTH     32950099
329600              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              32960099
329700                                                                  32970099
329800              MOVE '7100-LINK-SUKRF700'                           32980099
329900                              TO DP013-PARAGRAPH                  32990099
330000              MOVE 'LINK TO SUKRF700               '              33000099
330100                              TO DP013-MESSAGE-TEXT(1)            33010099
330200              STRING 'MSG - '            DELIMITED BY SIZE        33020099
330300                     SU042-VALIDATION-SW                          33030099
330400                                         DELIMITED BY SIZE        33040099
330500                              INTO DP013-MESSAGE-TEXT (2)         33050099
330600              MOVE 'CHECK CSSL FOR MORE DETAIL     '              33060099
330700                                TO DP013-MESSAGE-TEXT (3)         33070099
330800              MOVE SQLCA     TO DP013-SQLCA                       33080099
330900              SET DP013-DB2-ABEND                                 33090099
331000                              TO TRUE                             33100099
331100              SET DP013-ROLLBACK                                  33110099
331200                              TO TRUE                             33120099
331300              SET DP013-XCTL-DISPLAY-RESTART                      33130099
331400                              TO TRUE                             33140099
331500              PERFORM DP014-0000-PROCESS-ABEND                    33150099
331600     END-EVALUATE.                                                33160099
331700*                                                                 33170099
331800 8000-SEND-MAP.                                                   33180099
331900                                                                  33190099
332000     EXEC CICS                                                    33200099
332100         SEND MAP       ('SU536A')                                33210099
332200              MAPSET    ('SUKM536')                               33220099
332300              ERASE                                               33230099
332400              CURSOR                                              33240099
332500              RESP      (PV-CICS-RESPONSE)                        33250099
332600     END-EXEC.                                                    33260099
332700                                                                  33270099
332800     EVALUATE TRUE                                                33280099
332900         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 33290099
333000             CONTINUE                                             33300099
333100         WHEN OTHER                                               33310099
333200             MOVE '8000-SEND-MAP'      TO DP013-PARAGRAPH         33320099
333300             MOVE 'UNABLE TO SEND MAP' TO DP013-MESSAGE-TEXT (1)  33330099
333400             SET DP013-CICS-ABEND      TO TRUE                    33340099
333500             SET DP013-NO-ROLLBACK     TO TRUE                    33350099
333600             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               33360099
333700     END-EVALUATE.                                                33370099
333800*                                                                 33380099
333900 8100-SEND-DATA-ONLY.                                             33390099
334000                                                                  33400099
334100     EXEC CICS                                                    33410099
334200         SEND MAP       ('SU536A')                                33420099
334300              MAPSET    ('SUKM536')                               33430099
334400              CURSOR                                              33440099
334500              DATAONLY                                            33450099
334600              RESP      (PV-CICS-RESPONSE)                        33460099
334700     END-EXEC.                                                    33470099
334800                                                                  33480099
334900     EVALUATE TRUE                                                33490099
335000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 33500099
335100             CONTINUE                                             33510099
335200         WHEN OTHER                                               33520099
335300             MOVE '8100-SEND-DATA-ONLY' TO DP013-PARAGRAPH        33530099
335400             MOVE 'UNABLE TO SEND DATA' TO DP013-MESSAGE-TEXT (1) 33540099
335500             SET DP013-CICS-ABEND       TO TRUE                   33550099
335600             SET DP013-NO-ROLLBACK      TO TRUE                   33560099
335700             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               33570099
335800     END-EVALUATE.                                                33580099
335900*                                                                 33590099
336000 8200-RETURN-TRANID.                                              33600099
336100                                                                  33610099
336200     MOVE LENGTH OF CA-COMMAREA   TO PV-COMMAREA-LENGTH           33620099
336300     EXEC CICS                                                    33630099
336400         RETURN TRANSID  (PC-TRANID)                              33640099
336500                COMMAREA (CA-COMMAREA)                            33650099
336600                LENGTH   (PV-COMMAREA-LENGTH)                     33660099
336700                RESP     (PV-CICS-RESPONSE)                       33670099
336800     END-EXEC.                                                    33680099
336900                                                                  33690099
337000     EVALUATE TRUE                                                33700099
337100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 33710099
337200             CONTINUE                                             33720099
337300         WHEN OTHER                                               33730099
337400             MOVE '8200-RETURN-TRANIND' TO DP013-PARAGRAPH        33740099
337500             MOVE 'UNABLE TO RETURN TO TRANID'                    33750099
337600                 TO DP013-MESSAGE-TEXT (1)                        33760099
337700             SET DP013-CICS-ABEND       TO TRUE                   33770099
337800             SET DP013-NO-ROLLBACK      TO TRUE                   33780099
337900             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               33790099
338000     END-EVALUATE.                                                33800099
338100*                                                                 33810099
338200 8300-RETURN.                                                     33820099
338300                                                                  33830099
338400     EXEC CICS                                                    33840099
338500         SEND FROM (PV-MESSAGE-AREA)                              33850099
338600              LENGTH (19)                                         33860099
338700              ERASE                                               33870099
338800     END-EXEC.                                                    33880099
338900                                                                  33890099
339000     EXEC CICS                                                    33900099
339100         RETURN                                                   33910099
339200     END-EXEC.                                                    33920099
339300                                                                  33930099
339400 8400-SELECT-TKRPRPM.                                             33940099
339500                                                                  33950099
339600     EXEC SQL                                                     33960099
339700          SELECT FUNC_PCT                                         33970099
339800            INTO :KRPRPM-FUNC-PCT                                 33980099
339900            FROM TKRPRPM                                          33990099
340000           WHERE LOC_ID            = 90                           34000099
340100             AND INTFC_SYS_CDE     = 'AUD'                        34010099
340200             AND SYS_PRC_FUNC_CDE  = 'ERRMAX'                     34020099
340300             AND FUNC_PRC_STAT_CDE = 'AC'                         34030099
340400     END-EXEC.                                                    34040099
340500                                                                  34050099
340600     EVALUATE TRUE                                                34060099
340700         WHEN SQLCODE = ZERO                                      34070099
340800             CONTINUE                                             34080099
340900         WHEN SQLWARN0 NOT = SPACES                               34090099
341000         WHEN SQLCODE NOT EQUAL ZERO                              34100099
341100             MOVE '8400-SELECT-TKRPRPM'                           34110099
341200                             TO DP013-PARAGRAPH                   34120099
341300             MOVE SQLCA      TO DP013-SQLCA                       34130099
341400             MOVE 'TKRPRPM ' TO DP013-DB2-TABLE-NAME(1)           34140099
341500             SET DP013-DB2-ABEND                                  34150099
341600                             TO TRUE                              34160099
341700             SET DP013-NO-ROLLBACK                                34170099
341800                             TO TRUE                              34180099
341900             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               34190099
342000             SET SU026-DB2-ERROR TO TRUE                          34200099
342100     END-EVALUATE.                                                34210099
342200                                                                  34220099
342300                                                                  34230099
342400 8405-SELECT-TKRPRPM-PRC-AREA.                                    34240099
342500                                                                  34250099
342600     MOVE SU006-OPER-UNT-ID TO DK-OPER-UNT-ID                     34260099
342700                                                                  34270099
342800     EXEC SQL                                                     34280099
342900          SELECT FUNC_TXT                                         34290099
343000            INTO :KRPRPM-FUNC-TXT                                 34300099
343100            FROM TKRPRPM                                          34310099
343200           WHERE LOC_ID            = :DK-OPER-UNT-ID              34320099
343300             AND INTFC_SYS_CDE     = 'KHL'                        34330099
343400             AND SYS_PRC_FUNC_CDE  = 'PRAREA'                     34340099
343500             AND FUNC_PRC_STAT_CDE = 'AC'                         34350099
343600     END-EXEC.                                                    34360099
343700                                                                  34370099
343800     EVALUATE TRUE                                                34380099
343900         WHEN SQLCODE = ZERO                                      34390099
344000         WHEN SQLCODE = +100                                      34400099
344100             CONTINUE                                             34410099
344200         WHEN SQLWARN0 NOT = SPACES                               34420099
344300         WHEN SQLCODE NOT EQUAL ZERO                              34430099
344400             MOVE '8400-SELECT-TKRPRPM'                           34440099
344500                             TO DP013-PARAGRAPH                   34450099
344600             MOVE SQLCA      TO DP013-SQLCA                       34460099
344700             MOVE 'TKRPRPM ' TO DP013-DB2-TABLE-NAME(1)           34470099
344800             SET DP013-DB2-ABEND                                  34480099
344900                             TO TRUE                              34490099
345000             SET DP013-NO-ROLLBACK                                34500099
345100                             TO TRUE                              34510099
345200             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               34520099
345300             SET SU026-DB2-ERROR TO TRUE                          34530099
345400     END-EVALUATE.                                                34540099
345500                                                                  34550099
345600 8450-SELECT-PBS-IND.                                             34560099
345700                                                                  34570099
345800     MOVE SUT00015-OPER-UNT-ID TO DK-OPER-UNT-ID.                 34580099
345900                                                                  34590099
346000     EXEC SQL                                                     34600099
346100          SELECT FUNC_TXT                                         34610099
346200            INTO :PV-PBS-AUDIT-IND                                34620099
346300            FROM TKRPRPM                                          34630099
346400           WHERE LOC_ID            = :DK-OPER-UNT-ID              34640099
346500             AND INTFC_SYS_CDE     = 'KHL'                        34650099
346600             AND SYS_PRC_FUNC_CDE  = 'PBSAUD'                     34660099
346700             AND FUNC_PRC_STAT_CDE = 'AC'                         34670099
346800     END-EXEC.                                                    34680099
346900                                                                  34690099
347000     EVALUATE TRUE                                                34700099
347100         WHEN SQLCODE = ZERO                                      34710099
347200             CONTINUE                                             34720099
347300         WHEN SQLWARN0 NOT = SPACES                               34730099
347400         WHEN SQLCODE NOT EQUAL ZERO                              34740099
347500             MOVE '8450-SELECT-TKRPRPM'                           34750099
347600                             TO DP013-PARAGRAPH                   34760099
347700             MOVE SQLCA      TO DP013-SQLCA                       34770099
347800             MOVE 'TKRPRPM ' TO DP013-DB2-TABLE-NAME(1)           34780099
347900             SET DP013-DB2-ABEND                                  34790099
348000                             TO TRUE                              34800099
348100             SET DP013-NO-ROLLBACK                                34810099
348200                             TO TRUE                              34820099
348300             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               34830099
348400             SET SU026-DB2-ERROR TO TRUE                          34840099
348500     END-EVALUATE.                                                34850099
348600                                                                  34860099
348700 8500-CHECK-FOR-IP-AUDITS.                                        34870099
348800                                                                  34880099
348900                                                                  34890099
349000     EXEC SQL                                                     34900099
349100         SELECT  COUNT(*)                                         34910099
349200           INTO  :PV-IP-AUDITS                                    34920099
349300           FROM  TSUATRN                                          34930099
349400          WHERE  AUD_CNTL_NBR      =  :DK-AUDIT-CNTL-NBR          34940099
349500            AND  UNT_AUD_STAT_CDE  IN ('IP','PP')                 34950099
349600            AND  UNT_AUD_STRT_TMST <> '9999-09-09-09.09.09.999999'34960099
349700     END-EXEC.                                                    34970099
349800                                                                  34980099
349900                                                                  34990099
350000     EVALUATE TRUE                                                35000099
350100         WHEN SQLCODE = ZERO                                      35010099
350200             CONTINUE                                             35020099
350300         WHEN SQLCODE = -305                                      35030099
350400             MOVE +0                 TO PV-IP-AUDITS              35040099
350500         WHEN SQLWARN0 NOT = SPACES                               35050099
350600         WHEN SQLCODE NOT EQUAL ZERO                              35060099
350700             MOVE '8500-CHECK-FOR-IP-AUDITS'                      35070099
350800                             TO DP013-PARAGRAPH                   35080099
350900             MOVE SQLCA      TO DP013-SQLCA                       35090099
351000             MOVE 'TSUNAUD ' TO DP013-DB2-TABLE-NAME(1)           35100099
351100             SET DP013-DB2-ABEND                                  35110099
351200                             TO TRUE                              35120099
351300             SET DP013-NO-ROLLBACK                                35130099
351400                             TO TRUE                              35140099
351500             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               35150099
351600             SET SU026-DB2-ERROR TO TRUE                          35160099
351700     END-EVALUATE.                                                35170099
351800                                                                  35180099
352100                                                                  35210099
381100 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  38110099
381200                                                                  38120099
381300     MOVE PC-CURRENT-PROGRAM-NAME  TO DP013-PROGRAM.              38130099
381400     MOVE DFHEIBLK                 TO DP013-DFHEIBLK.             38140099
381500     INITIALIZE DP013-SRC-TASK-NUMBER                             38150099
381600                DP013-STACK.                                      38160099
381700     SET DP013-LINK-RETURN TO TRUE.                               38170099
381800                                                                  38180099
381900     EXEC CICS                                                    38190099
382000         LINK                                                     38200099
382100             PROGRAM   (DP013-NAME)                               38210099
382200             COMMAREA  (DP013-PARAMETERS)                         38220099
382300             LENGTH    (DP013-LENGTH)                             38230099
382400     END-EXEC.                                                    38240099
382500                                                                  38250099
382600 999A-WRITE-CSSL-MSG.                                             38260099
382700     MOVE LENGTH OF PV-CICS-MSG-AREA2 TO PV-COMMAREA-LENGTH.      38270099
382800     EXEC CICS                                                    38280099
382900          WRITEQ TD                                               38290099
383000           QUEUE  ('CSSL')                                        38300099
383100            FROM  (PV-CICS-MSG-AREA2)                             38310099
383200          LENGTH  (PV-COMMAREA-LENGTH)                            38320099
383300            RESP  (PV-CICS-RESPONSE)                              38330099
383400     END-EXEC.                                                    38340099
383500                                                                  38350099
383600*----------------------------------------------------------------*38360099
383700*    ABEND PROCESSOR MODULE                                      *38370099
383800*----------------------------------------------------------------*38380099
383900                                                                  38390099
384000     COPY DPPD014.                                                38400099
384100                                                                  38410099
