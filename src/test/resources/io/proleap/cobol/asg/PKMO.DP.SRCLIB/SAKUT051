000100 IDENTIFICATION DIVISION.                                         00010002
000200                                                                  00020002
000300 PROGRAM-ID.      SAKUT051.                                       00030004
000400 AUTHOR.          STEVEN NOWAK.                                   00040002
000500 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00050002
000600 DATE-WRITTEN.    07/01/09.                                       00060008
000700 DATE-COMPILED.                                                   00070002
000800                                                                  00080002
000900******************************************************************00090002
001000*  MODULE TYPE:   COBOL2 BATCH.                                   00100002
001100*                                                                 00110002
001200* THIS PROGRAM PREPARES THE TSASUM UPDATE FILE TO BE PROCESSED    00120002
001300* BY SAKUP002 UNDER THE DB2 CHECKPOINT RESTART SYSTEM.            00130002
001400*                                                                 00140002
001500* THE PROGRAM READS THE TSASUM UPDATE FILE, REFORMATS THE         00150002
001600* RECORDS AND SETS A CHECKPOINT INDICATOR ON THE RECORD BASED     00160002
001700* ON HOW CHECKPOINTS WILL BE TAKEN BY THE MAINTENANCE PROGRAM.    00170002
001800* AFTER A RECORD HAS BEEN REFORMATTED IT IS PASSED TO THE         00180002
001900* TRANSACTION PREPARATION MODULE (DPKUT900) WHICH DOES SOME MORE  00190002
002000* PROCESSING ON THE RECORDS AND WRITES THE REFORMATTED RECORDS    00200002
002100* OUT TO A SEQUENTIAL FILE.                                       00210002
002200*                                                                 00220002
002300* THE PROGRAM COMMUNICATES WITH THE TRANSACTION PREPARATION       00230002
002400* MODULE USING FUNCTION CODES (OPEN, WRITE, & CLOSE) AND CHECKS   00240002
002500* THE RETURN CODE AFTER EACH REQUEST.  IF AN INVALID RETURN CODE  00250002
002600* IS RECEIVED, ANY INFORMATION THAT MAY BE HELPFUL IN RESOLVING   00260002
002700* THE BAD RETURN CODE IS DISPLAYED ON SYSOUT AND THE PROGRAM      00270002
002800* ABENDS.                                                         00280002
002900*                                                                 00290002
003000*========================== CHANGE LOG ===========================00300002
003100*  AUTH        BY           DATE    DESCRIPTION                   00310009
003200*=================================================================00320002
003300* WR36527     TKMA409     07-01-09  CREATE PROGRAM                00330009
003400*                                                                 00340002
260107* CHG0260107  JIM HUNTER  08-19-21  ADD COPYBOOK DPWS990 TO MAKE  00341009
260107*                                   THE CALL TO DPKUT900 DYNAMIC. 00342009
003500******************************************************************00350002
003600                                                                  00360002
003700 ENVIRONMENT DIVISION.                                            00370002
003800 CONFIGURATION SECTION.                                           00380002
003900                                                                  00390002
004000 SOURCE-COMPUTER.    IBM-3090.                                    00400002
004100 OBJECT-COMPUTER.    IBM-3090.                                    00410002
004200                                                                  00420002
004300 INPUT-OUTPUT SECTION.                                            00430002
004400 FILE-CONTROL.                                                    00440002
004500                                                                  00450002
004600     SELECT UPDATE-FILE   ASSIGN TO INP01.                        00460002
004700                                                                  00470002
004800 DATA DIVISION.                                                   00480002
004900 FILE SECTION.                                                    00490002
005000                                                                  00500002
005100 FD  UPDATE-FILE                                                  00510002
005200     RECORDING MODE IS F                                          00520002
005300     BLOCK CONTAINS 0 RECORDS                                     00530002
005400     LABEL RECORDS ARE OMITTED.                                   00540002
005500                                                                  00550002
005600 01  UPDATE-REC                       PIC  X(21).                 00560005
005700                                                                  00570002
005800***************************************************************** 00580002
005900*                       WORKING STORAGE                           00590002
006000***************************************************************** 00600002
006100 WORKING-STORAGE SECTION.                                         00610002
006200                                                                  00620002
006300 01  W-START                          PIC  X(40)                  00630002
006400     VALUE 'SAKUT051 - WORKING STORAGE BEGINS HERE'.              00640004
006500                                                                  00650002
006600                                                                  00660002
006700***************************************************************** 00670002
006800*                         SWITCHES                                00680002
006900***************************************************************** 00690002
007000 01  PROGRAM-SWITCHES.                                            00700002
007100     05  PS-INPUT-UPDATE-EOF-SW       PIC  X(01) VALUE 'N'.       00710002
007200         88  PS-INPUT-UPDATE-EOF                 VALUE 'Y'.       00720002
007300     05  PS-FIRST-TRANS-READ-SW       PIC  X(01) VALUE 'Y'.       00730002
007400         88  FIRST-TRANS-READ                    VALUE 'Y'.       00740002
007500                                                                  00750002
007600******************************************************************00760002
007700*                       ACCUMULATORS                              00770002
007800******************************************************************00780002
007900 01  PROGRAM-ACCUMULATORS.                                        00790002
008000     05  PA-READ                      PIC  9(11) VALUE ZEROS.     00800002
008100     05  PA-WRITTEN                   PIC  9(11) VALUE ZEROS.     00810002
008200                                                                  00820002
008300******************************************************************00830002
008400*                           CONSTANTS                             00840002
008500******************************************************************00850002
008600 01  PROGRAM-CONSTANTS.                                           00860002
008700     05  PC-PROGRAM-NAME              PIC  X(08) VALUE 'SAKUT051'.00870004
008800                                                                  00880002
008900     05  PC-TRAN-PREP-FUNC-CODES.                                 00890002
009000         10  PC-TRAN-PREP-FUNC-OPEN   PIC  X(05) VALUE 'OPEN '.   00900002
009100         10  PC-TRAN-PREP-FUNC-WRITE  PIC  X(05) VALUE 'WRITE'.   00910002
009200         10  PC-TRAN-PREP-FUNC-CLOSE  PIC  X(05) VALUE 'CLOSE'.   00920002
009300                                                                  00930002
009400     05  PC-JOB-NAME                  PIC  X(08) VALUE 'SAK051  '.00940002
009500     05  PC-PLAN-NAME                 PIC  X(08) VALUE 'SAKUP008'.00950005
009600     05  PC-TRANS-RECORD-LENGTH       PIC S9(04) VALUE +21 COMP.  00960005
009700                                                                  00970002
009800******************************************************************00980002
009900*                          VARIABLES                              00990002
010000******************************************************************01000002
010100 01  PROGRAM-VARIABLES.                                           01010002
010200     05  PV-PARAGRAPH-NAME            PIC  X(30) VALUE SPACES.    01020002
010300     05  PV-OPERATION-MSG             PIC  X(60) VALUE SPACES.    01030002
010400     05  PV-RET-CODE                  PIC  9(04) VALUE ZEROS.     01040002
010500                                                                  01050002
010600     05  PV-CHECKPOINT-TYPE           PIC  X(01) VALUE SPACE.     01060002
010700         88  CONTROL-BREAK                       VALUE 'C'.       01070002
010800         88  LOGICAL-TRANSACTION                 VALUE 'L'.       01080002
010900         88  TIME-INTERVAL                       VALUE 'T'.       01090002
011000         88  REQUESTED-BY-PROGRAM                VALUE 'R'.       01100002
011100                                                                  01110002
011200     05  PV-HOLD-PARTN-NBR            PIC  9(04) VALUE ZERO.      01120002
011300     05  PV-HOLD-STR-NBR              PIC  9(04) VALUE ZERO.      01130002
011400     05  PV-HOLD-RGST-ID              PIC  9(04) VALUE ZERO.      01140002
011500                                                                  01150002
011600******************************************************************01160002
011700*               SYSTEM TIME AND DATE VARIABLES                    01170002
011800******************************************************************01180002
011900 01  SYS-DATE-TIME.                                               01190002
012000     05  SYS-DATE                     PIC  X(08) VALUE SPACES.    01200002
012100     05  SYS-TIME                     PIC  X(08) VALUE SPACES.    01210002
012200                                                                  01220002
012300 01  ST-BEG-TIME.                                                 01230002
012400     05  ST-BEG-HR                    PIC  9(02) VALUE ZEROS.     01240002
012500     05  FILLER                       PIC  X(01) VALUE ':'.       01250002
012600     05  ST-BEG-MN                    PIC  9(02) VALUE ZEROS.     01260002
012700                                                                  01270002
012800 01  ST-END-TIME.                                                 01280002
012900     05  ST-END-HR                    PIC  9(02) VALUE ZEROS.     01290002
013000     05  FILLER                       PIC  X(01) VALUE ':'.       01300002
013100     05  ST-END-MN                    PIC  9(02) VALUE ZEROS.     01310002
013200                                                                  01320002
013300 01  SD-EDIT-DATE.                                                01330002
013400     05  SD-MONTH                     PIC  9(02) VALUE ZEROS.     01340002
013500     05  FILLER                       PIC  X(01) VALUE '-'.       01350002
013600     05  SD-DAY                       PIC  9(02) VALUE ZEROS.     01360002
013700     05  FILLER                       PIC  X(01) VALUE '-'.       01370002
013800     05  SD-CENT                      PIC  9(02) VALUE ZEROS.     01380002
013900     05  SD-YEAR                      PIC  9(02) VALUE ZEROS.     01390002
014000                                                                  01400002
014100******************************************************************01410002
014200*                        ERROR HANDLING                           01420002
014300******************************************************************01430002
014400 01  ABEND-CODE                       PIC S9(04) VALUE ZEROS      01440002
014500                                                 COMP SYNC.       01450002
014600     88  ABEND-4002-READ-ERROR             VALUE +4002.           01460002
014700     88  ABEND-4019-CAL-SUB-ERROR          VALUE +4019.           01470002
014800                                                                  01480002
014900                                                                  01490002
015000******************************************************************01500002
015100*  TSASUM - TOTALS BY STORE REGISTER FILE                         01510002
015200******************************************************************01520002
015300     COPY SARD009.                                                01530003
015400                                                                  01540002
015500******************************************************************01550002
015600*  TRANSACTION PREPARATION MODULE LINKAGE SECTION                 01560002
015700******************************************************************01570002
260107     COPY DPWS990.                                                01580009
015900                                                                  01590002
015800     COPY DPLS000.                                                01591009
015900                                                                  01592009
016000******************************************************************01600002
016100*  SQL COMMUNICATIONS WORK AREA                                   01610002
016200******************************************************************01620002
016300     COPY SQLCA2.                                                 01630002
016400                                                                  01640002
016500                                                                  01650002
016600                                                                  01660002
016700                                                                  01670002
016800 PROCEDURE DIVISION.                                              01680002
016900******************************************************************01690002
017000* MAINLINE-PROCESSING                                             01700002
017100******************************************************************01710002
017200                                                                  01720002
017300     PERFORM A100-INITIALIZE.                                     01730002
017400                                                                  01740002
017500     PERFORM B100-PROCESS-UPDATE-INPUT-FILE                       01750002
017600       UNTIL PS-INPUT-UPDATE-EOF.                                 01760002
017700                                                                  01770002
017800     PERFORM Z990-END-OF-JOB-ROUTINE.                             01780002
017900                                                                  01790002
018000     GOBACK.                                                      01800002
018100                                                                  01810002
018200                                                                  01820002
018300******************************************************************01830002
018400* PREFORMS TASK INITIATION                                        01840002
018500******************************************************************01850002
018600 A100-INITIALIZE.                                                 01860002
018700                                                                  01870002
018800     OPEN INPUT UPDATE-FILE.                                      01880002
018900                                                                  01890002
019000     MOVE FUNCTION CURRENT-DATE TO SYS-DATE-TIME.                 01900002
019100                                                                  01910002
019200     MOVE SYS-TIME (1:2) TO ST-BEG-HR.                            01920002
019300     MOVE SYS-TIME (3:2) TO ST-BEG-MN.                            01930002
019400                                                                  01940002
019500     MOVE SYS-DATE (1:2) TO SD-CENT.                              01950002
019600     MOVE SYS-DATE (3:2) TO SD-YEAR.                              01960002
019700     MOVE SYS-DATE (5:2) TO SD-MONTH.                             01970002
019800     MOVE SYS-DATE (7:2) TO SD-DAY.                               01980002
019900                                                                  01990002
020000     PERFORM C100-ISSUE-OPEN-REQUEST.                             02000002
020100                                                                  02010002
020200     PERFORM C200-READ-UPDATE-INPUT-FILE.                         02020002
020300                                                                  02030002
020400     IF PS-INPUT-UPDATE-EOF                                       02040002
020500         MOVE 'C200-READ-UPDATE-INPUT-FILE' TO PV-PARAGRAPH-NAME  02050002
020600         MOVE '** EMPTY UPDATE FILE - NO DATA **'                 02060002
020700                                            TO PV-OPERATION-MSG   02070002
021000     END-IF.                                                      02100002
021100                                                                  02110002
021200                                                                  02120002
021300******************************************************************02130002
021400* PROCESS THE UPDATE FILE. IF A RECORD IS READ, GATHER WHATEVER   02140002
021500* OTHER DATA IS NECESSARY TO TAKE CHECKPOINTS BASED ON THE TYPE OF02150002
021600* CHECKPOINTS BEING TAKEN BY SAKUP002 AND ISSUE A WRITE REQUEST   02160002
021700* TO THE TRANSACTION PREPARATION PROGRAM.                         02170002
021800******************************************************************02180002
021900 B100-PROCESS-UPDATE-INPUT-FILE.                                  02190002
022000                                                                  02200002
022100     IF FIRST-TRANS-READ                                          02210002
022200         MOVE SA009-PARTN-NBR TO PV-HOLD-PARTN-NBR                02220003
022300         MOVE SA009-STR-NBR   TO PV-HOLD-STR-NBR                  02230003
022400         MOVE SA009-RGST-ID   TO PV-HOLD-RGST-ID                  02240003
022500         MOVE 'N'             TO PS-FIRST-TRANS-READ-SW           02250002
022600     END-IF.                                                      02260002
022700                                                                  02270002
022800     IF CONTROL-BREAK                                             02280002
022900         PERFORM C300-CKPT-BY-CNTL-BREAK                          02290002
023000     ELSE                                                         02300002
023100         IF LOGICAL-TRANSACTION                                   02310002
023200             PERFORM C400-CKPT-BY-LOGICAL-TRANS                   02320002
023300         ELSE                                                     02330002
023400             PERFORM C500-CKPT-BY-TIME-OR-REQUEST                 02340002
023500         END-IF                                                   02350002
023600     END-IF.                                                      02360002
023700                                                                  02370002
023800     PERFORM C200-READ-UPDATE-INPUT-FILE.                         02380002
023900                                                                  02390002
024000                                                                  02400002
024100******************************************************************02410002
024200* ISSUE AN 'OPEN' REQUEST TO THE TRANSACTION PREPARATION MODULE   02420002
024300******************************************************************02430002
024400 C100-ISSUE-OPEN-REQUEST.                                         02440002
024500                                                                  02450002
024600     MOVE PC-TRAN-PREP-FUNC-OPEN TO DP000-FUNC-CODE.              02460002
024700     MOVE PC-JOB-NAME            TO DP000-JOB-NAME.               02470002
024800     MOVE PC-PLAN-NAME           TO DP000-PLAN-NAME.              02480002
024900                                                                  02490002
025000     PERFORM Z100-CALL-TRANS-PREP-MODULE.                         02500002
025100                                                                  02510002
025200     MOVE DP000-CKPT-TYPE-CODE   TO PV-CHECKPOINT-TYPE.           02520002
025300                                                                  02530002
025400                                                                  02540002
025500******************************************************************02550002
025600* READ THE UPDATE INPUT FILE                                      02560002
025700******************************************************************02570002
025800 C200-READ-UPDATE-INPUT-FILE.                                     02580002
025900                                                                  02590002
026000     READ UPDATE-FILE INTO SA009-TSASUM-REC                       02600003
026100       AT END SET PS-INPUT-UPDATE-EOF TO TRUE.                    02610002
026200                                                                  02620002
026300     IF PS-INPUT-UPDATE-EOF                                       02630002
026400         CONTINUE                                                 02640002
026500     ELSE                                                         02650002
026600         ADD +1 TO PA-READ                                        02660002
026700     END-IF.                                                      02670002
026800                                                                  02680002
026900                                                                  02690002
027000******************************************************************02700002
027100* THIS ROUTINE SETS THE CHECKPOINT INDICATOR ON THE TRANSACATION  02710002
027200* RECORD "ON" IF THERE IS A CHANGE IN THE STORE NUMBER. AFTER     02720002
027300* THE TRANSACTION RECORD HAS BEEN FORMATTED, A WRITE REQUEST IS   02730002
027400* ISSUED TO THE TRANSACTION PREPARATION MODULE.                   02740002
027500*                                                                 02750002
027600* NOTE: AT THIS TIME CONTROL/LOGIC BREAK PROCESSING IS IDENTICAL. 02760002
027700******************************************************************02770002
027800 C300-CKPT-BY-CNTL-BREAK.                                         02780002
027900                                                                  02790002
028000     IF  SA009-PARTN-NBR = PV-HOLD-PARTN-NBR                      02800003
028100     AND SA009-STR-NBR   = PV-HOLD-STR-NBR                        02810003
028200     AND SA009-RGST-ID   = PV-HOLD-RGST-ID                        02820003
028300         MOVE 'N' TO DP000-CHECKPOINT-IND                         02830002
028400     ELSE                                                         02840002
028500         MOVE 'Y' TO DP000-CHECKPOINT-IND                         02850002
028600         MOVE SA009-PARTN-NBR TO PV-HOLD-PARTN-NBR                02860003
028700         MOVE SA009-STR-NBR   TO PV-HOLD-STR-NBR                  02870003
028800         MOVE SA009-RGST-ID   TO PV-HOLD-RGST-ID                  02880003
028900     END-IF.                                                      02890002
029000                                                                  02900002
029100     MOVE PC-TRANS-RECORD-LENGTH  TO DP000-TRANS-REC-LENGTH.      02910002
029200     MOVE SA009-TSASUM-REC        TO DP000-TRANS-REC.             02920003
029300     MOVE PC-TRAN-PREP-FUNC-WRITE TO DP000-FUNC-CODE.             02930002
029400     MOVE PC-JOB-NAME             TO DP000-JOB-NAME.              02940002
029500     MOVE PC-PLAN-NAME            TO DP000-PLAN-NAME.             02950002
029600                                                                  02960002
029700     PERFORM Z100-CALL-TRANS-PREP-MODULE.                         02970002
029800                                                                  02980002
029900     ADD +1 TO PA-WRITTEN.                                        02990002
030000                                                                  03000002
030100                                                                  03010002
030200******************************************************************03020002
030300* THIS ROUTINE SETS THE CHECKPOINT INDICATOR ON THE TRANSACTION   03030002
030400* RECORD "ON".  THE UPDATE PROGRAM WILL CHECK THE CHECKPOINT      03040002
030500* FREQUENCY TO KNOW WHETHER A CHECKPOINT SHOULD BE TAKEN. AFTER   03050002
030600* THE TRANSACTION RECORD HAS BEEN FORMATTED, A WRITE REQUEST IS   03060002
030700* ISSUED TO THE TRANSACTION PREPARATION MODULE.                   03070002
030800******************************************************************03080002
030900 C400-CKPT-BY-LOGICAL-TRANS.                                      03090002
031000                                                                  03100002
031100     IF  SA009-PARTN-NBR = PV-HOLD-PARTN-NBR                      03110003
031200     AND SA009-STR-NBR   = PV-HOLD-STR-NBR                        03120003
031300     AND SA009-RGST-ID   = PV-HOLD-RGST-ID                        03130003
031400         MOVE 'N' TO DP000-CHECKPOINT-IND                         03140002
031500     ELSE                                                         03150002
031600         MOVE 'Y' TO DP000-CHECKPOINT-IND                         03160002
031700         MOVE SA009-PARTN-NBR TO PV-HOLD-PARTN-NBR                03170003
031800         MOVE SA009-STR-NBR   TO PV-HOLD-STR-NBR                  03180003
031900         MOVE SA009-RGST-ID   TO PV-HOLD-RGST-ID                  03190003
032000     END-IF.                                                      03200002
032100                                                                  03210002
032200     MOVE PC-TRANS-RECORD-LENGTH  TO DP000-TRANS-REC-LENGTH.      03220002
032300     MOVE SA009-TSASUM-REC        TO DP000-TRANS-REC.             03230003
032400     MOVE PC-TRAN-PREP-FUNC-WRITE TO DP000-FUNC-CODE.             03240002
032500     MOVE PC-JOB-NAME             TO DP000-JOB-NAME.              03250002
032600     MOVE PC-PLAN-NAME            TO DP000-PLAN-NAME.             03260002
032700                                                                  03270002
032800     PERFORM Z100-CALL-TRANS-PREP-MODULE.                         03280002
032900                                                                  03290002
033000     ADD +1 TO PA-WRITTEN.                                        03300002
033100                                                                  03310002
033200                                                                  03320002
033300******************************************************************03330002
033400* THIS ROUTINE BUILDS THE TRANSACTION RECORD AND ISSUES A WRITE   03340002
033500* REQUEST TO THE TRANSACTION PREPARATION MODULE IF CHECKPOINTS ARE03350002
033600* TAKEN BY TIME INTERVAL (SECONDS) OR REQUESTED BY THE MAINTENANCE03360002
033700* PROGRAM.                                                        03370002
033800******************************************************************03380002
033900 C500-CKPT-BY-TIME-OR-REQUEST.                                    03390002
034000                                                                  03400002
034100     MOVE 'N'                     TO DP000-CHECKPOINT-IND.        03410002
034200                                                                  03420002
034300     MOVE PC-TRANS-RECORD-LENGTH  TO DP000-TRANS-REC-LENGTH.      03430002
034400     MOVE SA009-TSASUM-REC        TO DP000-TRANS-REC.             03440003
034500     MOVE PC-TRAN-PREP-FUNC-WRITE TO DP000-FUNC-CODE.             03450002
034600     MOVE PC-JOB-NAME             TO DP000-JOB-NAME.              03460002
034700     MOVE PC-PLAN-NAME            TO DP000-PLAN-NAME.             03470002
034800                                                                  03480002
034900     PERFORM Z100-CALL-TRANS-PREP-MODULE.                         03490002
035000                                                                  03500002
035100     ADD +1 TO PA-WRITTEN.                                        03510002
035200                                                                  03520002
035300                                                                  03530002
035400******************************************************************03540002
035500* ISSUE A 'CLOSE' REQUEST TO THE TRANSACTION PREPARATION MODULE   03550002
035600******************************************************************03560002
035700 C600-ISSUE-CLOSE-REQUEST.                                        03570002
035800                                                                  03580002
035900     MOVE PC-TRAN-PREP-FUNC-CLOSE TO DP000-FUNC-CODE.             03590002
036000     MOVE PC-JOB-NAME             TO DP000-JOB-NAME.              03600002
036100     MOVE PC-PLAN-NAME            TO DP000-PLAN-NAME.             03610002
036200                                                                  03620002
036300     PERFORM Z100-CALL-TRANS-PREP-MODULE.                         03630002
036400                                                                  03640002
036500                                                                  03650002
036600******************************************************************03660002
036700* VERIFY THE RETURN CODE ON THE CALLED MODULE                     03670002
036800******************************************************************03680002
036900 Z100-CALL-TRANS-PREP-MODULE.                                     03690002
037000                                                                  03700002
037100     PERFORM Z900-CALL-TRANS-PREP-MODULE.                         03710002
037200                                                                  03720002
037300     IF  DP000-GOOD-RET-CODE                                      03730002
037400         CONTINUE                                                 03740002
037500                                                                  03750002
037600     ELSE                                                         03760002
037700         MOVE 'Z100-CALL-TRANS-PREP-MODULE' TO PV-PARAGRAPH-NAME  03770002
037800         MOVE '** BAD CALL TO TRANS PREP MODULE **'               03780002
037900                                            TO PV-OPERATION-MSG   03790002
038000         MOVE DP000-RET-CODE                TO PV-RET-CODE        03800002
038100                                                                  03810002
038200         SET ABEND-4019-CAL-SUB-ERROR TO TRUE                     03820002
038300                                                                  03830002
038400         PERFORM Z200-ABEND                                       03840002
038500     END-IF.                                                      03850002
038600                                                                  03860002
038700                                                                  03870002
038800******************************************************************03880002
038900* NON-DB2 ABEND                                                   03890002
039000******************************************************************03900002
039100 Z200-ABEND.                                                      03910002
039200                                                                  03920002
039300     PERFORM Z999-CONTROLS.                                       03930002
039400                                                                  03940002
039500     DISPLAY '                     '.                             03950002
039600     DISPLAY '** ABEND           **'.                             03960002
039700     DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          03970002
039800     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        03980002
039900     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG.         03990002
040000     DISPLAY '** RETURN CODE     ** = ' PV-RET-CODE.              04000002
040100                                                                  04010002
040200     CALL 'ILBOABN0' USING ABEND-CODE.                            04020002
040300                                                                  04030002
040400                                                                  04040002
040500******************************************************************04050002
040600* PREFORMS TASK TERMINATION PROCESSING                            04060002
040700******************************************************************04070002
040800 Z990-END-OF-JOB-ROUTINE.                                         04080002
040900                                                                  04090002
041000     CLOSE UPDATE-FILE.                                           04100002
041100                                                                  04110002
041200     PERFORM C600-ISSUE-CLOSE-REQUEST.                            04120002
041300                                                                  04130002
041400     PERFORM Z999-CONTROLS.                                       04140002
041500                                                                  04150002
041600                                                                  04160002
041700******************************************************************04170002
041800* DISPLAY CONTROLS FROM THE PROGRAM                               04180002
041900******************************************************************04190002
042000 Z999-CONTROLS.                                                   04200002
042100                                                                  04210002
042200     MOVE FUNCTION CURRENT-DATE TO SYS-DATE-TIME.                 04220002
042300                                                                  04230002
042400     MOVE SYS-TIME (1:2) TO ST-END-HR.                            04240002
042500     MOVE SYS-TIME (3:2) TO ST-END-MN.                            04250002
042600                                                                  04260002
042700     DISPLAY '                    '.                              04270002
042800     DISPLAY '**********************'.                            04280002
042900     DISPLAY '   SAKUT051 CONTROLS  '.                            04290006
043000     DISPLAY '**********************'.                            04300002
043100     DISPLAY 'RUN DATE  = ' SD-EDIT-DATE.                         04310002
043200     DISPLAY 'BEG TIME  = ' ST-BEG-TIME.                          04320002
043300     DISPLAY 'END TIME  = ' ST-END-TIME.                          04330002
043400     DISPLAY '======================'.                            04340002
043500     DISPLAY 'RECORDS READ    = ' PA-READ.                        04350002
043600     DISPLAY '                  '.                                04360002
043700     DISPLAY 'RECORDS WRITTEN = ' PA-WRITTEN.                     04370002
043800     DISPLAY '                  '.                                04380002
043900                                                                  04390002
044000                                                                  04400002
044100******************************************************************04410002
044200* TRANSACTION PREPARATION MODULE CALL AND ERROR ROUTINES          04420002
044300******************************************************************04430002
044400     COPY DPPD000.                                                04440002
044500                                                                  04450002
044600                                                                  04460002
