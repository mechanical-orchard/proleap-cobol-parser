000100*************************                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*************************                                         00030000
000400 PROGRAM-ID.      MRKRP008.                                       00040000
000500 AUTHOR.          DAVID PHELPS.                                   00050000
000600 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00060000
000700 DATE-WRITTEN.    11/20/92.                                       00070000
000800 DATE-COMPILED.                                                   00080000
000900****************************************************************  00090000
001000* THIS PROGRAM WILL PRINT A SUMMARY OF THE ITEMS ORDERED FOR   *  00100000
001100* THE BUYER AND ANALYST TO REVIEW PRIOR TO APPROVAL.           *  00110000
001200****************************************************************  00120000
001300* DAVID PHELPS                                                    00130000
001400* 11/20/92 - CREATED AS NEW                                       00140000
001500****************************************************************  00150000
001600* P941020012  10/20/94 ORDERS FOR THE 01 SYSTEM DO NOT APPEAR ON  00160000
001700*      THE REPORT. BECAUSE THE SYSTEMS ARE NOW PARTITIONED THE    00170000
001800*      CHECK FOR WHICH DAY'S DATA TO USE IS NOT NEEDED. THIS LOGIC00180000
001900*      HAS BEEN REMOVED.                                          00190000
002000****************************************************************  00200000
002100* SCOTT VANG                                                      00210000
002200* 12/14/94 - CHANGED PROGRAM TO ACCEPT GROUP PRICING.             00220000
002300****************************************************************  00230000
002400* WR          12/14/94 CHANGED PROGRAM TO ACCEPT GROUP PRICING.   00240000
002500****************************************************************  00250000
002600* S MEYER WR 6041                                                 00260000
002700* 09/09/98 - CHANGED PROGRAM TO COMPLY W/ Y2K. INIT CALENDAR      00270000
002800****************************************************************  00280000
002900* A KINTOPF PM00364086                                            00290000
003000* 09/09/98 - CHANGED PROGRAM TO PROCESS FILE WITH JUST A NULL     00300000
003100*            RECORD                                               00310000
003200****************************************************************  00320000
003300* DON TOMLINSON   MR PHASE 4 NI SKU CHANGES                       00330000
003400* 04/17/2002 CHANGED FORMAT OF PV-SKU, PV-INAME, AND              00340000
003500*            PV-INAME-SKU-PREV. REMOVED PV-SKU-PREV.              00350000
003600****************************************************************  00360000
003610* IBM GLOBAL SERVICES INDIA WR# 21601 (NI-SKU PROJECT)            00361040
003620* 09/04/2002 8-DIGIT SKU IS WRITTEN INTO THE OUTPUT REPLACING     00362039
003630*            DEPARTMENT, CLASS AND SEQUENCE NUMBER.               00363040
003640****************************************************************  00364039
003700*                                                                 00370000
003800 ENVIRONMENT DIVISION.                                            00380000
003900*                                                                 00390000
004000*                                                                 00400000
004100 CONFIGURATION SECTION.                                           00410000
004200 SOURCE-COMPUTER. IBM-3090.                                       00420000
004300 OBJECT-COMPUTER. IBM-3090.                                       00430000
004400*                                                                 00440000
004500*                                                                 00450000
004600 INPUT-OUTPUT SECTION.                                            00460000
004700 FILE-CONTROL.                                                    00470000
004800                                                                  00480000
004900     SELECT ICCTL-CNTL-FILE                                       00490000
005000         ASSIGN                       TO ICCTL                    00500000
005100         ORGANIZATION IS INDEXED                                  00510000
005200         ACCESS MODE IS RANDOM                                    00520000
005300         RECORD KEY IS ICCTL-KEY                                  00530000
005400         FILE STATUS IS PV-VSAM-STATUS.                           00540000
005500                                                                  00550000
005600     SELECT HEADER-FILE                                           00560000
005700         ASSIGN                       TO ICROH                    00570000
005800         ORGANIZATION IS INDEXED                                  00580000
005900         ACCESS MODE IS DYNAMIC                                   00590000
006000         RECORD KEY IS H-ORDER-HEADER-KEY                         00600000
006100         FILE STATUS IS SC-HEADER-STATUS.                         00610000
006200                                                                  00620000
006300     SELECT DETAIL-FILE                                           00630000
006400         ASSIGN                       TO ICROD                    00640000
006500         ORGANIZATION IS INDEXED                                  00650000
006600         ACCESS MODE IS DYNAMIC                                   00660000
006700         RECORD KEY IS D-LINE-ITEM-KEY                            00670000
006800         FILE STATUS IS SC-DETAIL-STATUS.                         00680000
006900                                                                  00690000
007000     SELECT PRINT-REPORT1                                         00700000
007100         ASSIGN                       TO RPT01.                   00710000
007200                                                                  00720000
007300     SELECT PRINT-REPORT2                                         00730000
007400         ASSIGN                       TO RPT02.                   00740000
007500                                                                  00750000
007600     EJECT                                                        00760000
007700*                                                                 00770000
007800*                                                                 00780000
007900*                                                                 00790000
008000***************                                                   00800000
008100 DATA DIVISION.                                                   00810000
008200***************                                                   00820000
008300*                                                                 00830000
008400*                                                                 00840000
008500 FILE SECTION.                                                    00850000
008600                                                                  00860000
008700 FD  ICCTL-CNTL-FILE.                                             00870000
008800 01  ICCTL-CNTL-REC.                                              00880000
008900     05  ICCTL-KEY                  PIC X(21).                    00890000
009000     05  FILLER                     PIC X(379).                   00900000
009100                                                                  00910000
009200 FD  HEADER-FILE                                                  00920000
009300     DATA RECORD IS HEADER-RECORD.                                00930000
009400*                                                                 00940000
009500 01  HEADER-RECORD.                                               00950000
009600     COPY ICI085C.                                                00960043
009700     COPY ICI055C.                                                00970043
009800     COPY ICI056C.                                                00980043
009900     COPY ICI100C.                                                00990043
010000     COPY ICI090C.                                                01000043
010100                                                                  01010000
010200 FD  DETAIL-FILE                                                  01020000
010300     DATA RECORD IS ROD-RECORD.                                   01030000
010400*                                                                 01040000
010500 01  ROD-RECORD.                                                  01050000
010600     COPY ICI050C.                                                01060043
010700     COPY ICI030C.                                                01070043
010800     COPY ICI031C.                                                01080043
010900     COPY ICI095C.                                                01090043
011000                                                                  01100000
011100 FD  PRINT-REPORT1                                                01110000
011200     RECORDING MODE F                                             01120000
011300     BLOCK CONTAINS 0 RECORDS                                     01130000
011400     RECORD CONTAINS 132 CHARACTERS                               01140000
011500     LABEL RECORDS ARE OMITTED                                    01150000
011600     DATA RECORD IS PRINT-LINE1.                                  01160000
011700*                                                                 01170000
011800 01  PRINT-LINE1                                     PIC X(132).  01180000
011900                                                                  01190000
012000     EJECT                                                        01200000
012100                                                                  01210000
012200 FD  PRINT-REPORT2                                                01220000
012300     RECORDING MODE F                                             01230000
012400     BLOCK CONTAINS 0 RECORDS                                     01240000
012500     RECORD CONTAINS 132 CHARACTERS                               01250000
012600     LABEL RECORDS ARE OMITTED                                    01260000
012700     DATA RECORD IS PRINT-LINE2.                                  01270000
012800*                                                                 01280000
012900 01  PRINT-LINE2                                     PIC X(132).  01290000
013000                                                                  01300000
013100     EJECT                                                        01310000
013200*                                                                 01320000
013300 WORKING-STORAGE SECTION.                                         01330000
013400*                                                                 01340000
013500     COPY MRRD001I.                                               01350043
013600*                                                                 01360000
013700 01 SYSTEM-RECORD.                                                01370000
013800     COPY MRRD002I.                                               01380043
013900****************************************************************  01390000
014000** STANDARD HEADER LINE - KOHLS 132 COL                        *  01400000
014100****************************************************************  01410000
014200     COPY DPWS132.                                                01420043
014300****************************************************************  01430000
014400** COPYBOOKS FOR THE CALENDAR ROUTINE                          *  01440000
014500****************************************************************  01450000
014600     COPY DPWS024.                                                01460043
014700     EJECT                                                        01470000
014800****************************************************************  01480000
014900** COPYBOOKS FOR THE CALENDAR ROUTINE                          *  01490000
015000****************************************************************  01500000
015100     COPY DPWS500.                                                01510043
015200     EJECT                                                        01520000
015300*                                                                 01530000
015400 01 PV-PROGRAM-VARIABLES.                                         01540000
015500     05 PV-CALENDAR-DAYS                             PIC 9(03).   01550000
015600     05  PV-DAY-NUMBER                               PIC S9(1)    01560000
015700                                                       COMP-3.    01570000
015800     05 PV-FIRST-DATE.                                            01580000
015900          10  PV-FIRST-MO                            PIC 9(2).    01590000
016000          10  FILLER                                 PIC X(1)     01600000
016100                                                       VALUE '/'. 01610000
016200          10  PV-FIRST-DY                            PIC 9(2).    01620000
016300          10  FILLER                                 PIC X(1)     01630000
016400                                                       VALUE '/'. 01640000
016500          10  PV-FIRST-YR                            PIC 9(2).    01650000
016600          10  PV-FIRST-CC                            PIC 9(2).    01660000
016700     05 PV-DETAIL-VARIABLES.                                      01670000
016801          10  PV-SKU                                 PIC 9(08)    01680100
016802                                                      VALUE ZERO. 01681000
016900          10  PV-UPC.                                             01690000
017000              15  FILLER                             PIC X(03).   01700000
017100              15  PV-UPC-1                           PIC X(01).   01710000
017200              15  PV-UPC-2                           PIC X(05).   01720000
017300              15  PV-UPC-3                           PIC X(05).   01730000
017400              15  PV-UPC-4                           PIC X(01).   01740000
017500              15  FILLER                             PIC X(07).   01750000
017600          10  PV-STYLE                               PIC X(15).   01760000
017700          10  PV-SIZE                                PIC X(05).   01770000
017800          10  PV-COLOR                               PIC X(04).   01780000
017900          10  PV-RETAIL-PRICE                        PIC 9(6)V99. 01790000
018000          10  PV-RETAIL-QTY                          PIC X(4).    01800000
018100          10  PV-GROUP-QTY                           PIC 9(3).    01810000
018200          10  PV-GROUP-PRICE                         PIC 9(6)V99. 01820000
018300          10  PV-COST                                PIC 9(5)V99. 01830000
018400          10  PV-QTY-ORDERED                         PIC 9(6).    01840000
018500          10  PV-TOTAL-COST                          PIC 9(8)V99. 01850000
018600          10  PV-TOTAL-RETAIL                        PIC 9(8)V99. 01860000
040495*                                                                 01870000
040496 01 PV-LINE-ITEM-KEY.                                             01880000
040497     05 PV-RECORD-TYPE                               PIC X.       01890000
040498     05 PV-REF-NO.                                                01900000
040499        07 PV-REF-NO-DIGIT                           PIC X(03).   01910000
040500        07 FILLER                                    PIC X(12).   01920000
040501     05 PV-LINE-NO                                   PIC 9(5).    01930000
040502*                                                                 01940000
040503 01  PV-REF-NO-PREV                                  PIC X(15).   01950000
040504*                                                                 01960000
040510 01 PV-INAME-SKU-PREV                                PIC 9(08)    01971000
040511                                                      VALUE ZERO. 01972000
040512*                                                                 01980000
040513 01 PV-INAME.                                                     01990000
040514     05 PV-INAME-SKU                                 PIC 9(08).   02000000
040515     05 PV-INAME-SKU-X REDEFINES PV-INAME-SKU        PIC X(08).   02010000
040516     05 FILLER                                       PIC X(42).   02020000
040520*                                                                 02021000
040521 01 PV-SKU-PREV                                      PIC X(50).   02022000
040522*                                                                 02030000
040523 01 PV-SKU-CODE.                                                  02040000
040524     05 PV-SKU-STYLE                                 PIC X(15).   02050000
040525     05 FILLER                                       PIC X(1).    02060000
040526     05 PV-SKU-SIZE                                  PIC X(5).    02070000
040527     05 FILLER                                       PIC X(1).    02080000
040528     05 PV-SKU-COLOR                                 PIC X(10).   02090000
040529     05 FILLER                                       PIC X(4).    02100000
040530*                                                                 02110000
040531 01  ERROR-MESSAGES.                                              02120000
040532     05 FILLER                        PIC X(46)      VALUE        02130000
040533        'ERROR DETAIL RECORD NOT FOUND FOR REF-NO   #: '.         02140000
040534     05 ERROR-REF-NO                  PIC X(21).                  02150000
040535     05 FILLER                        PIC X(72)      VALUE SPACES.02160000
040536*                                                                 02170000
040537 01  PV-ABEND-CODE                    PIC S9(04)     VALUE +0     02180000
040538                                                     COMP SYNC.   02190000
040539     88  ABEND-4001-WRITE-ERROR                      VALUE +4001. 02200000
040540     88  ABEND-4002-READ-ERROR                       VALUE +4002. 02210000
040541     88  ABEND-4003-CTRL-CARD-ERROR                  VALUE +4003. 02220000
040542     88  ABEND-4004-TABLE-ERROR                      VALUE +4004. 02230000
040543     88  ABEND-4005-OPEN-ERROR                       VALUE +4005. 02240000
040544     88  ABEND-4006-CLOSE-ERROR                      VALUE +4006. 02250000
040545     88  ABEND-4007-SEQUENCE-ERROR                   VALUE +4007. 02260000
040546     88  ABEND-4008-DATA-ERROR                       VALUE +4008. 02270000
040547     88  ABEND-4009-KEY-DATA-ERROR                   VALUE +4009. 02280000
040550     88  ABEND-4013-DB2-ERROR                        VALUE +4013. 02310000
040551                                                                  02320000
040552 01  PV-CPU-DATE.                                                 02330000
040553     05  PV-CPU-MO                    PIC X(2).                   02340000
040554     05  FILLER                       PIC X(1)     VALUE '/'.     02350000
040555     05  PV-CPU-DY                    PIC X(2).                   02360000
040556     05  FILLER                       PIC X(1)     VALUE '/'.     02370000
040557     05  PV-CPU-FULL-YEAR             PIC X(4).                   02380000
040558                                                                  02390000
040559 01  CD-CPU-DATE.                                                 02400000
040560     05  CD-CPU-FULL-YEAR.                                        02410000
040561         10  CD-CPU-CC                PIC 9(2)     VALUE ZEROS.   02420000
040562         10  CD-CPU-YR                PIC 9(2)     VALUE ZEROS.   02430000
040563     05  CD-CPU-MO                    PIC 9(2)     VALUE ZEROS.   02440000
040564     05  CD-CPU-DY                    PIC 9(2)     VALUE ZEROS.   02450000
040565                                                                  02460000
040566******************************************************************02470000
040567 01  CD-NUMERIC-DATE REDEFINES CD-CPU-DATE.                       02480000
040568     05  CD-CPU-NUMERIC-DATE          PIC 9(8).                   02490000
040569******************************************************************02500000
040570                                                                  02510000
040571 01  CT-CPU-TIME.                                                 02520000
040572     05  CT-CPU-HR                    PIC 9(2)       VALUE ZEROS. 02530000
040573     05  CT-CPU-MIN                   PIC 9(2)       VALUE ZEROS. 02540000
040574     05  CT-CPU-SEC                   PIC 9(2)       VALUE ZEROS. 02550000
040575     05  CT-CPU-HSEC                  PIC 9(2)       VALUE ZEROS. 02560000
040576*                                                                 02570000
040577 01  END-OF-REPORT-LINE.                                          02580000
040578     05  FILLER                       PIC X(25)      VALUE        02590000
040579         ' ** END OF REPORT **     '.                             02600000
040580*                                                                 02610000
040581 01  HL-HEADING-BLANK.                                            02620000
040582     05  FILLER                       PIC X(20)      VALUE        02630000
040583         '                    '.                                  02640000
040584*                                                                 02650000
040585 01  HL-HEADING-LINE1.                                            02660000
040586*    05  FILLER                       PIC X(45)      VALUE SPACE. 02670000
040587     05  FILLER                       PIC X(12)      VALUE        02680000
040588         'SYSTEM ID : '.                                          02690000
040589     05  HL1-ID                       PIC X(02).                  02700000
040590     05  FILLER                       PIC X(31)      VALUE SPACE. 02710000
040591     05  FILLER                       PIC X(36)      VALUE        02720000
040592         'INFOREM SUGGESTED ORDER SUMMARY FOR:'.                  02730000
040593     05  FILLER                       PIC X(02)      VALUE SPACE. 02740000
040594     05  HL1-DAY                      PIC X(10).                  02750000
040595     05  FILLER                       PIC X(03)      VALUE SPACE. 02760000
040596     05  HL1-MONTH                    PIC X(09).                  02770000
040597     05  FILLER                       PIC X(01)      VALUE SPACE. 02780000
040598     05  HL1-DAY-NUM                  PIC X(02).                  02790000
040599     05  FILLER                       PIC X(02)      VALUE ', '.  02800000
040600     05  HL1-YEAR-NUM                 PIC X(04).                  02810000
040601     05  FILLER                       PIC X(13)      VALUE SPACE. 02820000
040602*                                                                 02830000
040603 01  HL-HEADING-LINE2.                                            02840000
040604     05  FILLER                       PIC X(18)      VALUE        02850000
040605         'REFERENCE NUMBER: '.                                    02860000
040606     05  HL2-REF-NO                   PIC X(15).                  02870000
040607     05  FILLER                       PIC X(11)      VALUE SPACE. 02880000
040608     05  FILLER                       PIC X(14)      VALUE        02890000
040609         'VENDOR NAME:  '.                                        02900000
040610     05  HL2-VENDOR-NAME              PIC X(25).                  02910000
040611     05  FILLER                       PIC X(08)      VALUE SPACE. 02920000
040612     05  FILLER                       PIC X(07)      VALUE        02930000
040613         'BUYER: '.                                               02940000
040614     05  HL1-BUYER-ID                 PIC X(03).                  02950000
040615     05  FILLER                       PIC X(01)      VALUE SPACE. 02960000
040616     05  HL1-BUYER-NAME               PIC X(32).                  02970000
040617*                                                                 02980000
040618 01  HL-HEADING-LINE3.                                            02990000
040619     05  FILLER                       PIC X(3)       VALUE        03000000
040620         'SKU'.                                                   03010000
040621     05  FILLER                       PIC X(08)      VALUE SPACE. 03020000
040622     05  FILLER                       PIC X(8)       VALUE        03030000
040623         'UPC CODE'.                                              03040000
040624     05  FILLER                       PIC X(8)       VALUE SPACE. 03050000
040625     05  FILLER                       PIC X(5)       VALUE        03060000
040626         'STYLE'.                                                 03070000
040627     05  FILLER                       PIC X(11)      VALUE SPACE. 03080000
040628     05  FILLER                       PIC X(4)       VALUE        03090000
040629         'SIZE'.                                                  03100000
040630     05  FILLER                       PIC X(2)       VALUE SPACE. 03110000
040631     05  FILLER                       PIC X(5)       VALUE        03120000
040632         'COLOR'.                                                 03130000
040633     05  FILLER                       PIC X(3)       VALUE SPACE. 03140000
040634     05  FILLER                       PIC X(8)       VALUE        03150000
040635         'RETAIL'.                                                03160000
040636     05  FILLER                       PIC X(3)       VALUE SPACE. 03170000
040637     05  FILLER                       PIC X(5)       VALUE        03180000
040638         'GROUP'.                                                 03190000
040639     05  FILLER                       PIC X(4)       VALUE SPACE. 03200000
040640     05  FILLER                       PIC X(6)       VALUE        03210000
040641         'RETAIL'.                                                03220000
040642     05  FILLER                       PIC X(6)       VALUE SPACE. 03230000
040643     05  FILLER                       PIC X(4)       VALUE        03240000
040644         'COST'.                                                  03250000
040645     05  FILLER                       PIC X(3)       VALUE SPACE. 03260000
040646     05  FILLER                       PIC X(11)      VALUE        03270000
040647         'QTY ORDERED'.                                           03280000
040648     05  FILLER                       PIC X(2)       VALUE SPACE. 03290000
040649     05  FILLER                       PIC X(10)      VALUE        03300000
040650         'TOTAL COST'.                                            03310000
040651     05  FILLER                       PIC X(1)       VALUE SPACE. 03320000
040652     05  FILLER                       PIC X(12)      VALUE        03330000
040653         'TOTAL RETAIL'.                                          03340000
040654     05  FILLER                       PIC X(3)       VALUE SPACE. 03350000
040655*                                                                 03360000
040659 01  DETAIL-LINE.                                                 03370000
040662     05  PRT-SKU                      PIC ZZZZZZZ9.               03391041
040663     05  FILLER                       PIC X(03)      VALUE SPACE. 03392000
040664     05  PRT-UPC.                                                 03400000
040665         10  PRT-UPC-1                PIC X(01).                  03410000
040666         10  FILLER                   PIC X(01)      VALUE '-'.   03420000
040667         10  PRT-UPC-2                PIC X(05).                  03430000
040668         10  FILLER                   PIC X(01)      VALUE '-'.   03440000
040669         10  PRT-UPC-3                PIC X(05).                  03450000
040670         10  FILLER                   PIC X(01)      VALUE '-'.   03460000
040671         10  PRT-UPC-4                PIC X(01).                  03470000
040672     05 PV-UPC1 REDEFINES PRT-UPC.                                03480000
040673         10  PRT-SPACES               PIC X(15).                  03490000
040674     05  FILLER                       PIC X(1)       VALUE SPACE. 03500000
040675     05  PRT-STYLE                    PIC X(15).                  03510000
040676     05  FILLER                       PIC X(1)       VALUE SPACE. 03520000
040677     05  PRT-SIZE                     PIC X(5).                   03530000
040678     05  FILLER                       PIC X(1)       VALUE SPACE. 03540000
040679     05  PRT-COLOR                    PIC X(4).                   03550000
040680     05  FILLER                       PIC X(1)       VALUE SPACE. 03560000
040681     05  PRT-RETAIL.                                              03570000
040682         07  PRT-RETAIL-PRICE         PIC ZZZ,ZZ9.99.             03580000
040683         07  FILLER                   PIC X(1)       VALUE SPACE. 03590000
040684         07  PRT-RETAIL-QTY           PIC X(4).                   03600000
040685     05  FILLER                       PIC X(1)       VALUE SPACE. 03610000
040686     05  PRT-GROUP.                                               03620000
040687         07  PRT-GROUP-QTY            PIC ZZ9.                    03630000
040688         07  FILLER                   PIC X(01)      VALUE        03640000
040689             '/'.                                                 03650000
040690         07  PRT-GROUP-PRICE          PIC ZZZ,ZZ9.99.             03660000
040691     05  FILLER                       PIC X(1)       VALUE SPACE. 03670000
040692     05  PRT-COST                     PIC ZZ,ZZ9.99.              03680000
040693     05  FILLER                       PIC X(1)       VALUE SPACE. 03690000
040694     05  PRT-COST-QTY                 PIC X(4).                   03700000
040695     05  FILLER                       PIC X(1)       VALUE SPACE. 03710000
040696     05  PRT-QTY-ORDERED              PIC ZZZ,ZZ9.                03720000
040697     05  FILLER                       PIC X(1)       VALUE SPACE. 03730000
040698     05  PRT-TOTAL.                                               03740000
040699         07  PRT-TOTAL-COST           PIC ZZZZ,ZZ9.99.            03750000
040700         07  FILLER                   PIC X(2)       VALUE SPACE. 03760000
040701         07  PRT-TOTAL-RETAIL         PIC ZZZZ,ZZ9.99.            03770000
040702*                                                                 03780000
040706 01  TOTAL-LINE1.                                                 03790000
040707     05  FILLER                       PIC X(22)      VALUE        03800000
040708         'TOTAL ORDER QUANTITY: '.                                03810000
040709     05  FILLER                       PIC X(01)      VALUE SPACE. 03820000
040710     05  TOTAL-ORDER-QTY-1            PIC Z,ZZZ,ZZ9.              03830000
040711     05  FILLER                       PIC X(101)     VALUE SPACE. 03840000
040712*                                                                 03850000
040713 01  TOTAL-LINE2.                                                 03860000
040714     05  FILLER                       PIC X(22)      VALUE        03870000
040715         'TOTAL EXTENDED COST:  '.                                03880000
040716     05  FILLER                       PIC X(01)      VALUE SPACE. 03890000
040717     05  TOTAL-EXT-COST               PIC Z,ZZZ,ZZ9.99.           03900000
040718     05  FILLER                       PIC X(90)      VALUE SPACE. 03910000
040719*                                                                 03920000
040720 01  TOTAL-LINE3.                                                 03930000
040721     05  FILLER                       PIC X(22)      VALUE        03940000
040722         'TOTAL EXTENDED RETAIL:'.                                03950000
040723     05  FILLER                       PIC X(01)      VALUE SPACE. 03960000
040724     05  TOTAL-EXT-RETAIL             PIC Z,ZZZ,ZZ9.99.           03970000
040725     05  FILLER                       PIC X(90)      VALUE SPACE. 03980000
040726*                                                                 03990000
040727 01  TOTAL-LINE4.                                                 04000000
040728     05  FILLER                       PIC X(22)      VALUE        04010000
040729         'MARKUP PERCENT:     '.                                  04020000
040730     05  FILLER                       PIC X(06)      VALUE SPACE. 04030000
040731     05  TOTAL-MARKUP-PER             PIC -ZZ9.99.                04040000
040732     05  FILLER                       PIC X(90)      VALUE SPACE. 04050000
040733*                                                                 04060000
040734 01  PC-PROGRAM-CONSTANTS.                                        04070000
040800     05  PC-M                         PIC X(01)      VALUE 'M'.   04080000
040900     05  PC-P                         PIC X(01)      VALUE 'P'.   04090000
041000     05  PC-U                         PIC X(01)      VALUE 'U'.   04100000
041100     05  PC-RCD-TYPE                  PIC X(03)      VALUE 'SYS'. 04110000
041200     05  PC-FIRST                     PIC X(01)      VALUE 'F'.   04120000
041300     05  PC-MAX-LINES                 PIC S9(3)      VALUE +52    04130000
041400                                                     COMP-3.      04140000
041500     05  PC-PGM-DPKUT500              PIC X(08)      VALUE        04150000
041600                                                     'DPKUT500'.  04160000
041700*                                                                 04170000
041800 01  PS-PROGRAM-SWITCHES.                                         04180000
041900     05  PS-HEADER-VALID-SWT          PIC X(01)      VALUE 'N'.   04190000
042000         88  PS-HEADER-VALID                         VALUE 'Y'.   04200000
042100     05  PS-REPORT-HEADING-SWT        PIC X(01)      VALUE 'N'.   04210000
042200         88  PS-REPORT-HEADING-VALID                 VALUE 'Y'.   04220000
042300     05  PS-HEADER-SWT                PIC X(01)      VALUE 'N'.   04230000
042400         88  PS-END-OF-HEADER                        VALUE 'Y'.   04240000
042500     05  PS-DETAIL-SWT                PIC X(01)      VALUE 'N'.   04250000
042600         88  PS-END-OF-DETAIL                        VALUE 'Y'.   04260000
042700         88  PS-FIRST-DETAIL                         VALUE 'F'.   04270000
042800     05  PS-CORP-SWT                  PIC X(01)      VALUE ' '.   04280000
042900         88  PS-CORP-REC                             VALUE 'Y'.   04290000
043000         88  PS-STORE-REC                            VALUE 'N'.   04300000
043100*                                                                 04310000
043200 01  PV-PROGRAM-VARIABLES.                                        04320000
043300     05  PV-TOTAL-LINES.                                          04330000
043400         07  PV-TOTAL-QTY             PIC S9(7).                  04340000
043500         07  PV-TOT-EXT-COST          PIC S9(9)V99.               04350000
043600         07  PV-TOT-EXT-RTL           PIC S9(9)V99.               04360000
043700         07  PV-TOT-MARKUP-PER        PIC S9(9)V99.               04370000
043800     05  PV-LINE1-CNT                 PIC S9(3)      VALUE +0     04380000
043900                                                     COMP-3.      04390000
044000     05  PV-PAGE1-CNT                 PIC 9(3)       VALUE ZEROS  04400000
044100                                                     COMP-3.      04410000
044200     05  PV-LINE2-CNT                 PIC S9(3)      VALUE +0     04420000
044300                                                     COMP-3.      04430000
044400     05  PV-PAGE2-CNT                 PIC 9(3)       VALUE ZEROS  04440000
044500                                                     COMP-3.      04450000
044600*                                                                 04460000
044700 01  SC-STATUS-CODES.                                             04470000
044800     05  PV-VSAM-STATUS               PIC X(02)      VALUE SPACE. 04480000
044900         88  PV-VSAM-SUCCESSFUL                      VALUE '00'.  04490000
045000         88  PV-VSAM-NOT-FOUND                       VALUE '23'.  04500000
045100     05  SC-DETAIL-STATUS             PIC X(02).                  04510000
045200         88  SC-DETAIL-STATUS-OK                     VALUE '00'.  04520000
045300         88  SC-DETAIL-STATUS-DUPLICATE              VALUE '22'.  04530000
045400         88  SC-DETAIL-STATUS-NOT-FOUND              VALUE '23'.  04540000
045500     05  SC-HEADER-STATUS             PIC X(02).                  04550000
045600         88  SC-HEADER-STATUS-OK                     VALUE '00'.  04560000
045700         88  SC-HEADER-STATUS-DUPLICATE              VALUE '22'.  04570000
045800         88  SC-HEADER-STATUS-NOT-FOUND              VALUE '23'.  04580000
045900*                                                                 04590000
046000*                                                                 04600000
046100****************************************************************  04610000
046200 PROCEDURE DIVISION.                                              04620000
046300****************************************************************  04630000
046400                                                                  04640000
046500****************************************************************  04650000
046600* A100-PROGRAM-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE  *  04660000
046700* PROGRAM.                                                     *  04670000
046800****************************************************************  04680000
046900                                                                  04690000
047000 A100-PROGRAM-MAINLINE.                                           04700000
047100                                                                  04710000
047200     PERFORM B100-PREPROCESSOR THRU B100-EXIT.                    04720000
047300                                                                  04730000
047400     PERFORM B200-MAINLINE THRU B200-EXIT                         04740000
047500         UNTIL PS-END-OF-HEADER.                                  04750000
047600                                                                  04760000
047700*    PERFORM D100-PRINT-ITEM-DETAIL THRU D100-EXIT.               04770000
047800                                                                  04780000
047900*    PERFORM D200-PRINT-TOTAL THRU D200-EXIT.                     04790000
048000                                                                  04800000
048100     PERFORM B300-EOF-PROCESSING THRU B300-EXIT.                  04810000
048200                                                                  04820000
048300     STOP RUN.                                                    04830000
048400                                                                  04840000
048500*A100-EXIT.                                                       04850000
048600     EJECT                                                        04860000
048700*                                                                 04870000
048800****************************************************************  04880000
048900* B100-PREPROCESSOR OPENS ALL FILES ASSOCIATED WITH THE JOB,   *  04890000
049000* READS THE FIRST RECORD OF THE HEADER FILE AND CREATES THE    *  04900000
049100* REPORT HEADINGS.                                             *  04910000
049200****************************************************************  04920000
049300 B100-PREPROCESSOR.                                               04930000
049400                                                                  04940000
049500     OPEN INPUT  HEADER-FILE                                      04950000
049600                 DETAIL-FILE                                      04960000
049700                 ICCTL-CNTL-FILE                                  04970000
049800          OUTPUT PRINT-REPORT1                                    04980000
049900                 PRINT-REPORT2.                                   04990000
050000                                                                  05000000
050100     IF  NOT PV-VSAM-SUCCESSFUL                                   05010000
050200         DISPLAY '**  ABEND  **'                                  05020000
050300         DISPLAY 'MRKRP008'                                       05030000
050400         DISPLAY                                                  05040000
050500         'I/O ICCTL  FILE OPEN ERROR'                             05050000
050600         DISPLAY 'FILE STATUS CODE = ' PV-VSAM-STATUS             05060000
050700         SET ABEND-4005-OPEN-ERROR    TO TRUE                     05070000
050800         CALL 'ILBOABN0' USING PV-ABEND-CODE                      05080000
050900     END-IF.                                                      05090000
051000                                                                  05100000
051100     IF  NOT SC-HEADER-STATUS-OK                                  05110000
051200         DISPLAY '**  ABEND  **'                                  05120000
051300         DISPLAY 'MRKRP008'                                       05130000
051400         DISPLAY                                                  05140000
051500         'I/O HEADER FILE OPEN ERROR'                             05150000
051600         DISPLAY 'FILE STATUS CODE = ' SC-HEADER-STATUS           05160000
051700         SET ABEND-4005-OPEN-ERROR    TO TRUE                     05170000
051800         CALL 'ILBOABN0' USING PV-ABEND-CODE                      05180000
051900     END-IF.                                                      05190000
052000                                                                  05200000
052100     IF  NOT SC-DETAIL-STATUS-OK                                  05210000
052200         DISPLAY '**  ABEND  **'                                  05220000
052300         DISPLAY 'MRKRP008'                                       05230000
052400         DISPLAY                                                  05240000
052500         'I/O DETAIL FILE OPEN ERROR'                             05250000
052600         DISPLAY 'FILE STATUS CODE = ' SC-DETAIL-STATUS           05260000
052700         SET ABEND-4005-OPEN-ERROR    TO TRUE                     05270000
052800         CALL 'ILBOABN0' USING PV-ABEND-CODE                      05280000
052900     END-IF.                                                      05290000
053000*                                                                 05300000
053100     ACCEPT PARAMETER-INPUT-RECORD.                               05310000
053200*                                                                 05320000
053300     IF MR001I-S-RUN-MODE = PC-P OR PC-U OR PC-M                  05330000
053400        CONTINUE                                                  05340000
053500     ELSE                                                         05350000
053600         DISPLAY '** ABEND ** IN PROGRAM MRKRP008'                05360000
053700         DISPLAY 'MRKRP008 - CONTROL-CARD ERROR = '               05370000
053800                  PARAMETER-INPUT-RECORD                          05380000
053900         MOVE +4003 TO PV-ABEND-CODE                              05390000
054000         CALL 'ILBOABN0' USING PV-ABEND-CODE                      05400000
054100     END-IF.                                                      05410000
054200                                                                  05420000
054300* ADDED SYS ID TO REPORT HEADER. SMM                              05430000
054400     MOVE MR001I-S-SYS-ID   TO S-SYS-ID                           05440000
054500                                 HL1-ID.                          05450000
054600     MOVE PC-RCD-TYPE       TO S-RCD-TYPE.                        05460000
054700     MOVE LOW-VALUES        TO S-RCD-ID.                          05470000
054800     MOVE S-KEY             TO ICCTL-KEY.                         05480000
054900*                                                                 05490000
055000 EJECT                                                            05500000
055100*                                                                 05510000
055200******************************************************************05520000
055300                                                                  05530000
055400     READ ICCTL-CNTL-FILE INTO SYSTEM-RECORD                      05540000
055500                               KEY IS ICCTL-KEY.                  05550000
055600                                                                  05560000
055700     IF PV-VSAM-SUCCESSFUL                                        05570000
055800        CONTINUE                                                  05580000
055900     ELSE                                                         05590000
056000        IF PV-VSAM-NOT-FOUND                                      05600000
056100           DISPLAY '** ABEND **'                                  05610000
056200           DISPLAY '** PROGRAM   = MRKRP008'                      05620000
056300           DISPLAY '** PARAGRAPH = B100-PREPROCESSOR'             05630000
056400           DISPLAY '** MESSAGE   = '                              05640000
056500                   'ICCTL REC NOT FOUND STAT: ' PV-VSAM-STATUS    05650000
056600           MOVE +4005           TO PV-ABEND-CODE                  05660000
056700           CALL 'ILBOABN0'      USING PV-ABEND-CODE               05670000
056800        ELSE                                                      05680000
056900           DISPLAY '** ABEND **'                                  05690000
057000           DISPLAY '** PROGRAM   = MRKRP008'                      05700000
057100           DISPLAY '** PARAGRAPH = B100-PREPROCESSOR'             05710000
057200           DISPLAY '** MESSAGE   = '                              05720000
057300                   'BAD ICCTL READ,  STATUS : ' PV-VSAM-STATUS    05730000
057400           MOVE +4005           TO PV-ABEND-CODE                  05740000
057500           CALL 'ILBOABN0'      USING PV-ABEND-CODE               05750000
057600        END-IF                                                    05760000
057700     END-IF.                                                      05770000
057800                                                                  05780000
057900     MOVE S-TNOW-DN TO PV-DAY-NUMBER.                             05790000
058000                                                                  05800000
058100     INITIALIZE PV-TOTAL-LINES.                                   05810000
058200                                                                  05820000
058300     ACCEPT CT-CPU-TIME FROM TIME.                                05830000
058400                                                                  05840000
058500********************** ##Y2K MODIFICATION ************************05850000
058600                                                                  05860000
058700     ACCEPT CD-CPU-NUMERIC-DATE FROM DATE.                        05870000
058800                                                                  05880000
058900     IF CD-CPU-YR > 80                                            05890000
059000        MOVE 19 TO CD-CPU-CC                                      05900000
059100     ELSE                                                         05910000
059200        MOVE 20 TO CD-CPU-CC                                      05920000
059300     END-IF                                                       05930000
059400*********************** END MODIFICATION *************************05940000
059500                                                                  05950000
059600     MOVE CD-NUMERIC-DATE             TO DPG51-SYSTEM-DATE.       05960000
059700     MOVE CT-CPU-HR                   TO DP132-RUN-HOUR.          05970000
059800     MOVE CT-CPU-MIN                  TO DP132-RUN-MINUTE.        05980000
059900                                                                  05990000
060000     MOVE CD-CPU-MO                   TO DP132-RUN-MONTH          06000000
060100                                         PV-CPU-MO.               06010000
060200     MOVE CD-CPU-DY                   TO DP132-RUN-DAY            06020000
060300                                         PV-CPU-DY.               06030000
060400                                                                  06040000
060500*********************** ##Y2K MODIFICATION ***********************06050000
060600     MOVE CD-CPU-FULL-YEAR            TO DP132-RUN-YEAR           06060000
060700                                         PV-CPU-FULL-YEAR.        06070000
060800************************ END MODIFICATION ************************06080000
060900                                                                  06090000
061000     MOVE 'MRKRP008'                  TO DP132-PROGRAM-NAME.      06100000
061100                                                                  06110000
061200     MOVE SPACES TO PS-HEADER-VALID-SWT.                          06120000
061300                                                                  06130000
061400     PERFORM C100-READ-HEADER-FILE THRU C100-EXIT UNTIL           06140000
061500             PS-HEADER-VALID OR PS-END-OF-HEADER.                 06150000
061600                                                                  06160000
061700     IF PS-END-OF-HEADER                                          06170000
061800          MOVE ZERO   TO H-BUYER-ID                               06180000
061900          MOVE SPACES TO H-BUYER-NAME                             06190000
062000          PERFORM C200-REPORT-HEADINGS THRU C200-EXIT             06200000
062100          PERFORM C300-ORDER-HEADINGS THRU C300-EXIT              06210000
062200          PERFORM B300-EOF-PROCESSING THRU B300-EXIT              06220000
062300          STOP RUN                                                06230000
062400     END-IF.                                                      06240000
062500                                                                  06250000
062600 B100-EXIT.                                                       06260000
062700     EJECT                                                        06270000
062800*                                                                 06280000
062900****************************************************************  06290000
063000* B200-MAINLINE. THIS MODULE CONTROLS THE PROCESSING OF THE    *  06300000
063100* PROGRAM.                                                     *  06310000
063200****************************************************************  06320000
063300                                                                  06330000
063400 B200-MAINLINE.                                                   06340000
063500                                                                  06350000
063600     MOVE SPACES            TO PS-DETAIL-SWT.                     06360000
063700                                                                  06370000
063800     MOVE SPACES            TO PS-REPORT-HEADING-SWT.             06380000
063900                                                                  06390000
064000     PERFORM C400-BUILD-KEY-DETAIL-FILE THRU C400-EXIT.           06400000
064100                                                                  06410000
064200*    DISPLAY 'PERFORM C500-READ-DETAIL'.                          06420000
064300     PERFORM C500-READ-DETAIL-FILE THRU C500-EXIT                 06430000
064400          UNTIL PS-END-OF-DETAIL.                                 06440000
064500                                                                  06450000
064600*    DISPLAY 'PERFORM D200-PRINT'.                                06460000
064700*    PERFORM D200-PRINT-TOTAL THRU D200-EXIT.                     06470000
064800                                                                  06480000
064900     MOVE SPACES TO PS-HEADER-VALID-SWT.                          06490000
065000                                                                  06500000
065100     PERFORM C100-READ-HEADER-FILE THRU C100-EXIT UNTIL           06510000
065200             PS-HEADER-VALID OR PS-END-OF-HEADER.                 06520000
065300                                                                  06530000
065400 B200-EXIT.                                                       06540000
065500     EJECT                                                        06550000
065600*                                                                 06560000
065700******************************************************************06570000
065800* B300-EOF-PROCESSING - CLOSES ALL FILES ASSOCIATED WITH THE JOB *06580000
065900******************************************************************06590000
066000                                                                  06600000
066100 B300-EOF-PROCESSING.                                             06610000
066200                                                                  06620000
066300     CLOSE HEADER-FILE                                            06630000
066400           DETAIL-FILE                                            06640000
066500           ICCTL-CNTL-FILE.                                       06650000
066600*          PRINT-REPORT.                                          06660000
066700                                                                  06670000
066800     IF  NOT SC-HEADER-STATUS-OK                                  06680000
066900         DISPLAY '**  ABEND  **'                                  06690000
067000         DISPLAY 'MRKRP008'                                       06700000
067100         DISPLAY                                                  06710000
067200         'I/O HEADER FILE CLOSE ERROR'                            06720000
067300         DISPLAY 'FILE STATUS CODE = ' SC-HEADER-STATUS           06730000
067400         SET ABEND-4006-CLOSE-ERROR   TO TRUE                     06740000
067500         CALL 'ILBOABN0' USING PV-ABEND-CODE                      06750000
067600     END-IF.                                                      06760000
067700                                                                  06770000
067800     IF  NOT SC-DETAIL-STATUS-OK                                  06780000
067900         DISPLAY '**  ABEND  **'                                  06790000
068000         DISPLAY 'MRKRP008'                                       06800000
068100         DISPLAY                                                  06810000
068200         'I/O DETAIL FILE CLOSE ERROR'                            06820000
068300         DISPLAY 'FILE STATUS CODE = ' SC-DETAIL-STATUS           06830000
068400         SET ABEND-4006-CLOSE-ERROR   TO TRUE                     06840000
068500         CALL 'ILBOABN0' USING PV-ABEND-CODE                      06850000
068600     END-IF.                                                      06860000
068700                                                                  06870000
068800     WRITE PRINT-LINE1 FROM END-OF-REPORT-LINE                    06880000
068900         AFTER ADVANCING 2.                                       06890000
069000                                                                  06900000
069100     WRITE PRINT-LINE2 FROM END-OF-REPORT-LINE                    06910000
069200         AFTER ADVANCING 2.                                       06920000
069300                                                                  06930000
069400 B300-EXIT.                                                       06940000
069500*                                                                 06950000
069600*                                                                 06960000
069700****************************************************************  06970000
069800* C100-READ-HEADER-FILE  - READS THE HEADER-FILE.              *  06980000
069900* MOVES FIELDS TO THE REPORT HEADINGS.                            06990000
070000****************************************************************  07000000
070100                                                                  07010000
070200 C100-READ-HEADER-FILE.                                           07020000
070300                                                                  07030000
070400     READ HEADER-FILE NEXT                                        07040000
070500         AT END                                                   07050000
070600             SET PS-END-OF-HEADER TO TRUE.                        07060000
070700                                                                  07070000
070800*ANNE                                                             07080000
070900     IF H-ORDER-HEADER-KEY = SPACES                               07090000
071000         SET PS-END-OF-HEADER TO TRUE                             07100000
071100     END-IF                                                       07110000
071200*ANNE                                                             07120000
071300                                                                  07130000
071400     IF PS-END-OF-HEADER                                          07140000
071500        GO TO C100-EXIT                                           07150000
071600     END-IF.                                                      07160000
071700                                                                  07170000
071800     IF H-REF-NO (15:1) = 'C'                                     07180000
071900         SET PS-CORP-REC TO TRUE                                  07190000
072000     ELSE                                                         07200000
072100         SET PS-STORE-REC TO TRUE                                 07210000
072200     END-IF.                                                      07220000
072300                                                                  07230000
072400     IF H-ORDER-HEADER-KEY =  LOW-VALUES                          07240000
072500         GO TO C100-EXIT                                          07250000
072600     END-IF.                                                      07260000
072700                                                                  07270000
072800*    IF H-DN =  PV-DAY-NUMBER                                     07280000
072900         SET PS-HEADER-VALID TO TRUE                              07290000
073000*    ELSE                                                         07300000
073100*        GO TO C100-EXIT                                          07310000
073200*    END-IF.                                                      07320000
073300                                                                  07330000
073400     MOVE H-REF-NO        TO PV-REF-NO-PREV.                      07340000
073500                                                                  07350000
073600     MOVE H-REF-NO        TO HL2-REF-NO.                          07360000
073700                                                                  07370000
073800     MOVE H-VENDOR-NAME   TO HL2-VENDOR-NAME.                     07380000
073900                                                                  07390000
074000     PERFORM C150-CALENDAR-ROUTINE THRU C150-EXIT.                07400000
074100                                                                  07410000
074200     PERFORM C200-REPORT-HEADINGS THRU C200-EXIT.                 07420000
074300                                                                  07430000
074400 C100-EXIT.                                                       07440000
074500*                                                                 07450000
074600****************************************************************  07460000
074700* C150-CALENDAR-ROUTINE-  EXECUTES THE CALENDAR ROUTINE        *  07470000
074800* WEEKNUM IS CHECKED IF GREATER THAN CURRENT THEN WORK IS FROM *  07480000
074900* THE PREVIOUS YEAR. IF WORK IS FROM THE PREVIOUS YEAR GET THE *  07490000
075000* PREVIOUS YEAR BY DOING A CALL TO THE DATE ROUTINE TO GET THE *  07500000
075100* FIRST DAY OF THE PREVIOUS YEAR. THEN INCREMENT OUT THE NUMBER*  07510000
075200* OF DAYS AND WEEKS TO GET A DAY NAME AND DATE OF THE WORK.    *  07520000
075300****************************************************************  07530000
075400                                                                  07540000
075500 C150-CALENDAR-ROUTINE.                                           07550000
075600                                                                  07560000
075700     INITIALIZE           DPG51                                   07570000
075800                          DPG52                                   07580000
075900                          DPG53                                   07590000
076000                          DPG54                                   07600000
076100                          DPG55                                   07610000
076200                          DPG56.                                  07620000
076300                                                                  07630000
076400     MOVE PV-CPU-DATE TO DPG52-LK-DATE-INPUT                      07640000
076500                                                                  07650000
076600     MOVE SPACES TO DPG51-INCREMENT-DECREMENT-FLAG.               07660000
076700     SET DPG51-FISCAL-454-CALENDAR TO TRUE                        07670000
076800     SET DPG52-LK-DTE-GREG-CC-FMT TO TRUE.                        07680000
076900                                                                  07690000
077000     CALL DP500-KOHLS-CALENDAR-ROUTINE USING   DPG51              07700000
077100                                               DPG52              07710000
077200                                               DPG53              07720000
077300                                               DPG54              07730000
077400                                               DPG55              07740000
077500                                               DPG56              07750000
077600                                                                  07760000
077700     EVALUATE TRUE                                                07770000
077800     WHEN DPG54-SEVERE-ERROR                                      07780000
077900         DISPLAY 'SEVERE ERROR IN CALENDAR ROUTINE'               07790000
078000         DISPLAY DPG54-ERROR-MESSAGE                              07800000
078100         DISPLAY 'INPUT DATE: '  DPG52-LK-DATE-INPUT              07810000
078200         SET ABEND-4008-DATA-ERROR    TO TRUE                     07820000
078300         CALL 'ILBOABN0'        USING PV-ABEND-CODE               07830000
078400     WHEN DPG54-WARNING-ERROR                                     07840000
078500         DISPLAY 'WARNING ERROR IN CALENDAR ROUTINE'              07850000
078600         DISPLAY DPG54-ERROR-MESSAGE                              07860000
078700     WHEN DPG54-NO-ERROR                                          07870000
078800         CONTINUE                                                 07880000
078900     END-EVALUATE.                                                07890000
079000                                                                  07900000
079100     MOVE  DPG56-FIRST-FD-GREG-FMT TO PV-FIRST-DATE               07910000
079200                                                                  07920000
079300     IF H-WN > DPG56-FISCAL-WEEK-NBR                              07930000
079400                                                                  07940000
079500        INITIALIZE        DPG51                                   07950000
079600                          DPG52                                   07960000
079700                          DPG53                                   07970000
079800                          DPG54                                   07980000
079900                          DPG55                                   07990000
080000                          DPG56                                   08000000
080100                                                                  08010000
080200         SET DPG51-FISCAL-454-CALENDAR TO TRUE                    08020000
080300         SET DPG52-LK-DTE-GREG-FMT TO TRUE                        08030000
080400                                                                  08040000
080500                                                                  08050000
080600         MOVE '01'                TO PV-FIRST-MO                  08060000
080700         MOVE '01'                TO PV-FIRST-DY                  08070000
080800         MOVE PV-FIRST-DATE       TO DPG52-LK-DATE-INPUT          08080000
080900                                                                  08090000
081000     CALL DP500-KOHLS-CALENDAR-ROUTINE USING   DPG51              08100000
081100                                               DPG52              08110000
081200                                               DPG53              08120000
081300                                               DPG54              08130000
081400                                               DPG55              08140000
081500                                               DPG56              08150000
081600                                                                  08160000
081700         EVALUATE TRUE                                            08170000
081800         WHEN DPG54-SEVERE-ERROR                                  08180000
081900             DISPLAY 'SEVERE ERROR IN CALENDAR ROUTINE'           08190000
082000             DISPLAY DPG54-ERROR-MESSAGE                          08200000
082100             DISPLAY 'INPUT DATE: '  DPG52-LK-DATE-INPUT          08210000
082200             SET ABEND-4008-DATA-ERROR    TO TRUE                 08220000
082300             CALL 'ILBOABN0'        USING PV-ABEND-CODE           08230000
082400         WHEN DPG54-WARNING-ERROR                                 08240000
082500             DISPLAY 'WARNING ERROR IN CALENDAR ROUTINE'          08250000
082600             DISPLAY DPG54-ERROR-MESSAGE                          08260000
082700         WHEN DPG54-NO-ERROR                                      08270000
082800             MOVE  DPG56-FIRST-FD-GREG-FMT TO PV-FIRST-DATE       08280000
082900         END-EVALUATE                                             08290000
083000     END-IF.                                                      08300000
083100                                                                  08310000
083200     INITIALIZE           DPG51                                   08320000
083300                          DPG52                                   08330000
083400                          DPG53                                   08340000
083500                          DPG54                                   08350000
083600                          DPG55                                   08360000
083700                          DPG56                                   08370000
083800                                                                  08380000
083900     SET DPG51-FISCAL-454-CALENDAR TO TRUE.                       08390000
084000     MOVE  PV-FIRST-DATE           TO DPG52-LK-DATE-INPUT.        08400000
084100                                                                  08410000
084200     COMPUTE DPG51-INCR-DECR-DAYS-9 =                             08420000
084300                            (((H-WN - 1) * 7) + H-DN - 1).        08430000
084400                                                                  08440000
084500     SET DPG52-LK-DTE-GREG-FMT TO TRUE.                           08450000
084600     SET DPG51-INCREMENT-DATE TO TRUE.                            08460000
084700                                                                  08470000
084800     CALL DP500-KOHLS-CALENDAR-ROUTINE USING   DPG51              08480000
084900                                               DPG52              08490000
085000                                               DPG53              08500000
085100                                               DPG54              08510000
085200                                               DPG55              08520000
085300                                               DPG56              08530000
085400                                                                  08540000
085500     EVALUATE TRUE                                                08550000
085600     WHEN DPG54-SEVERE-ERROR                                      08560000
085700         DISPLAY 'SEVERE ERROR IN CALENDAR ROUTINE'               08570000
085800         DISPLAY DPG54-ERROR-MESSAGE                              08580000
085900         DISPLAY 'INPUT DATE: '  DPG52-LK-DATE-INPUT              08590000
086000         SET ABEND-4008-DATA-ERROR    TO TRUE                     08600000
086100         CALL 'ILBOABN0'        USING PV-ABEND-CODE               08610000
086200     WHEN DPG54-WARNING-ERROR                                     08620000
086300         DISPLAY 'WARNING ERROR IN CALENDAR ROUTINE'              08630000
086400         DISPLAY DPG54-ERROR-MESSAGE                              08640000
086500     WHEN DPG54-NO-ERROR                                          08650000
086600         CONTINUE                                                 08660000
086700     END-EVALUATE.                                                08670000
086800                                                                  08680000
086900     MOVE DPG55-ALPHA-WEEK-DAY   TO HL1-DAY.                      08690000
087000     MOVE DPG55-ALPHA-MONTH      TO HL1-MONTH.                    08700000
087100     MOVE DPG55-GREG-DATE-DY     TO HL1-DAY-NUM.                  08710000
087200     MOVE DPG55-GREG-CC-DATE-YR  TO HL1-YEAR-NUM.                 08720000
087300                                                                  08730000
087400 C150-EXIT.                                                       08740000
087500*                                                                 08750000
087600****************************************************************  08760000
087700* C200-REPORT-HEADINGS -      WRITES THE HEADING LINES FOR THE *  08770000
087800* REPORT WHEN THERE IS A CHANGE IN REFERENCE NUMBERS OR THE    *  08780000
087900* PAGE IS FULL.                                                *  08790000
088000****************************************************************  08800000
088100                                                                  08810000
088200 C200-REPORT-HEADINGS.                                            08820000
088300                                                                  08830000
088400     MOVE H-BUYER-ID                  TO HL1-BUYER-ID             08840000
088500     MOVE H-BUYER-NAME                TO HL1-BUYER-NAME           08850000
088600                                                                  08860000
088700     IF PS-CORP-REC                                               08870000
088800         ADD +1                           TO PV-PAGE2-CNT         08880000
088900         MOVE 2                           TO DP132-REPORT-NUMBER  08890000
089000         MOVE PV-PAGE2-CNT                TO DP132-PAGE-NUMBER    08900000
089100         WRITE PRINT-LINE2 FROM DP132-STANDRD-HEADER-132-COLS     08910000
089200             AFTER ADVANCING PAGE                                 08920000
089300         WRITE PRINT-LINE2 FROM HL-HEADING-LINE1                  08930000
089400             AFTER ADVANCING 1                                    08940000
089500         MOVE 2                           TO PV-LINE2-CNT         08950000
089600     ELSE                                                         08960000
089700         ADD +1                           TO PV-PAGE1-CNT         08970000
089800         MOVE 1                           TO DP132-REPORT-NUMBER  08980000
089900         MOVE PV-PAGE1-CNT                TO DP132-PAGE-NUMBER    08990000
090000         WRITE PRINT-LINE1 FROM DP132-STANDRD-HEADER-132-COLS     09000000
090100             AFTER ADVANCING PAGE                                 09010000
090200         WRITE PRINT-LINE1 FROM HL-HEADING-LINE1                  09020000
090300             AFTER ADVANCING 1                                    09030000
090400         MOVE 2                           TO PV-LINE1-CNT         09040000
090500     END-IF.                                                      09050000
090600                                                                  09060000
090700 C200-EXIT.                                                       09070000
090800     EJECT                                                        09080000
090900*                                                                 09090000
091000****************************************************************  09100000
091100* C300-ORDER-HEADINGS. - WRITES THE ORDER HEADINGS LINES FOR   *  09110000
091200* REPORT WHEN THERE IS A CHANGE IN REFERENCE NUMBERS OR WHEN   *  09120000
091300* THE PAGE IS FULL.                                            *  09130000
091400****************************************************************  09140000
091500                                                                  09150000
091600 C300-ORDER-HEADINGS.                                             09160000
091700                                                                  09170000
091800     IF PV-LINE1-CNT > PC-MAX-LINES OR                            09180000
091900        PV-LINE2-CNT > PC-MAX-LINES                               09190000
092000         PERFORM C200-REPORT-HEADINGS THRU C200-EXIT              09200000
092100     END-IF.                                                      09210000
092200                                                                  09220000
092300     IF PS-CORP-REC                                               09230000
092400          WRITE PRINT-LINE2 FROM HL-HEADING-LINE2                 09240000
092500              AFTER ADVANCING 2                                   09250000
092600          WRITE PRINT-LINE2 FROM HL-HEADING-LINE3                 09260000
092700              AFTER ADVANCING 2                                   09270000
092800          WRITE PRINT-LINE2 FROM HL-HEADING-BLANK                 09280000
092900              AFTER ADVANCING 1                                   09290000
093000          ADD 5                            TO PV-LINE2-CNT        09300000
093100     ELSE                                                         09310000
093200          WRITE PRINT-LINE1 FROM HL-HEADING-LINE2                 09320000
093300              AFTER ADVANCING 2                                   09330000
093400          WRITE PRINT-LINE1 FROM HL-HEADING-LINE3                 09340000
093500              AFTER ADVANCING 2                                   09350000
093600          WRITE PRINT-LINE1 FROM HL-HEADING-BLANK                 09360000
093700              AFTER ADVANCING 1                                   09370000
093800          ADD 5                            TO PV-LINE1-CNT        09380000
093900     END-IF.                                                      09390000
094000                                                                  09400000
094100 C300-EXIT.                                                       09410000
094200     EJECT                                                        09420000
094300*                                                                 09430000
094400****************************************************************  09440000
094500* C400-BUILD-KEY-DETAIL-FILE. THIS MODULE WILL BUILD THE KEY   *  09450000
094600* TO ACCESS THE DETAIL FILE USING THE FIELDS FROM THE HEADER   *  09460000
094700* RECORD. THE RECORD IS STARTED AT PV-LINE-NO = 1 WHICH IS THE *  09470000
094800* FIRST RECORD UNDER THE ASSOCIATED REFERENCE NUMBER.          *  09480000
094900* THE DETAIL ID IS MADE UP OF THE FOLLOWING.                   *  09490000
095000*    PV-RECORD-TYPE        VALUE IS 'D' FOR DETAIL.            *  09500000
095100*    PV-REF-NO             VALUE IS FROM H-REF-NO.             *  09510000
095200*    PV-LINE-NO            VALUE IS '1' FOR FIRST OF GROUP.    *  09520000
095300****************************************************************  09530000
095400                                                                  09540000
095406                                                                  09546000
095500 C400-BUILD-KEY-DETAIL-FILE.                                      09550000
095600                                                                  09560000
095700     MOVE 'D'                    TO PV-RECORD-TYPE.               09570000
095800     MOVE H-REF-NO               TO PV-REF-NO.                    09580000
095900     MOVE 00001                  TO PV-LINE-NO.                   09590000
096000                                                                  09600000
096100     INITIALIZE PV-INAME-SKU.                                     09610000
096200                                                                  09620000
096300     MOVE PV-LINE-ITEM-KEY TO D-LINE-ITEM-KEY                     09630000
096400                                                                  09640000
096500     START DETAIL-FILE KEY >= D-LINE-ITEM-KEY                     09650000
096600                                                                  09660000
096700     READ DETAIL-FILE                                             09670000
096800                                                                  09680000
096900     IF   SC-DETAIL-STATUS-OK                                     09690000
097000         MOVE PC-FIRST TO PS-DETAIL-SWT                           09700000
097100     ELSE                                                         09710000
097200         SET PS-END-OF-DETAIL    TO TRUE                          09720000
097300         GO TO C400-EXIT.                                         09730000
097400                                                                  09740000
097500     MOVE INAME             TO PV-INAME.                          09750000
097600                                                                  09760000
097700     MOVE SPACES            TO PS-DETAIL-SWT.                     09770000
097800     MOVE PV-INAME-SKU      TO PV-SKU.                            09780000
097810     MOVE PV-INAME-SKU-X    TO PV-SKU-PREV.                       09781000
097900     MOVE PV-INAME-SKU      TO PV-INAME-SKU-PREV.                 09790000
098000                                                                  09800000
098100     MOVE SKU                 TO PV-SKU-CODE.                     09810000
098200     MOVE UPC                 TO PV-UPC.                          09820000
098300     MOVE PV-SKU-STYLE        TO PV-STYLE.                        09830000
098400     MOVE PV-SKU-SIZE         TO PV-SIZE.                         09840000
098500     MOVE PV-SKU-COLOR        TO PV-COLOR.                        09850000
098600     MOVE CUR-UNIT-RTL-AMT    TO PV-RETAIL-PRICE.                 09860000
098700     MOVE RTL-UNIT-MSMT       TO PV-RETAIL-QTY.                   09870000
098800     MOVE GR-QTY              TO PV-GROUP-QTY.                    09880000
098900     MOVE OQ                  TO PV-QTY-ORDERED.                  09890000
099000     MOVE GR-RTL-AMT          TO PV-GROUP-PRICE.                  09900000
099100     MOVE ICOST               TO PV-COST.                         09910000
099200                                                                  09920000
099300****************************************************************  09930000
099400*ERROR MESSAGE IF REFERENCE NUMBER AND DETAIL RECORD NOT MATCHED. 09940000
099500****************************************************************  09950000
099600     IF PV-REF-NO-PREV NOT = D-REF-NO                             09960000
099700         MOVE D-REF-NO    TO ERROR-REF-NO                         09970000
099800       IF PS-CORP-REC                                             09980000
099900         WRITE PRINT-LINE2 FROM ERROR-MESSAGES                    09990000
100000               AFTER ADVANCING 2                                  10000000
100100       ELSE                                                       10010000
100200         WRITE PRINT-LINE1 FROM ERROR-MESSAGES                    10020000
100300               AFTER ADVANCING 2                                  10030000
100400       END-IF                                                     10040000
100500         SET PS-END-OF-DETAIL  TO TRUE                            10050000
100600         GO TO C400-EXIT                                          10060000
100700     END-IF.                                                      10070000
100800                                                                  10080000
100900 C400-EXIT.                                                       10090000
101000     EJECT                                                        10100000
101100****************************************************************  10110000
101200* C500-READ-DETAIL-FILE  - THIS MODULE READS THE DETAIL FILE   *  10120000
101300* FROM THE POINT OF THE STARTED RECORD UNTIL THE REFERENCE     *  10130000
101400* NUMBER CHANGES. IF THE SKU NUMBER CHANGES THEN A DETAIL      *  10140000
101500* RECORD IS WRITTEN OUT.                                       *  10150000
101600****************************************************************  10160000
101700                                                                  10170000
101800 C500-READ-DETAIL-FILE.                                           10180000
101900                                                                  10190000
102100* DISPLAY 'C500-READ-DETAIL-FILE'.                                10210038
102200     READ DETAIL-FILE NEXT                                        10220000
102300         AT END                                                   10230000
102400            SET PS-END-OF-DETAIL    TO TRUE.                      10240000
102500                                                                  10250000
102600     IF PS-END-OF-DETAIL                                          10260000
102700         PERFORM D100-PRINT-ITEM-DETAIL THRU D100-EXIT            10270000
102800         PERFORM D200-PRINT-TOTAL THRU D200-EXIT                  10280000
102900     ELSE                                                         10290000
103000         MOVE INAME        TO PV-INAME                            10300000
103100                                                                  10310000
103200         IF PV-INAME-SKU-PREV NOT = PV-INAME-SKU                  10320000
103300             PERFORM D100-PRINT-ITEM-DETAIL THRU D100-EXIT        10330000
103310*            DISPLAY 'PREV REF NO: ' PV-REF-NO-PREV               10331038
103320*            DISPLAY 'CURR REF NO: ' D-REF-NO                     10332038
103400                                                                  10340000
103700            IF PV-REF-NO-PREV NOT = D-REF-NO                      10370000
103800                 PERFORM D200-PRINT-TOTAL THRU D200-EXIT          10380000
103900                 SET PS-END-OF-DETAIL TO TRUE                     10390000
104000                 GO TO C500-EXIT                                  10400000
104100            END-IF                                                10410000
104200                                                                  10420000
104300             MOVE INAME         TO PV-INAME                       10430000
104400             MOVE PV-INAME-SKU  TO PV-SKU                         10440000
104410             MOVE PV-INAME-SKU-X  TO PV-SKU-PREV                  10441000
104500             MOVE PV-INAME-SKU  TO PV-INAME-SKU-PREV              10450000
104600                                                                  10460000
104700             MOVE SKU           TO PV-SKU-CODE                    10470000
104800             MOVE UPC           TO PV-UPC                         10480000
104900             MOVE PV-SKU-STYLE  TO PV-STYLE                       10490000
105000             MOVE PV-SKU-SIZE   TO PV-SIZE                        10500000
105100             MOVE PV-SKU-COLOR  TO PV-COLOR                       10510000
105200             MOVE CUR-UNIT-RTL-AMT TO PV-RETAIL-PRICE             10520000
105300             MOVE RTL-UNIT-MSMT TO PV-RETAIL-QTY                  10530000
105400             MOVE GR-QTY        TO PV-GROUP-QTY                   10540000
105500             MOVE OQ            TO PV-QTY-ORDERED                 10550000
105600             MOVE GR-RTL-AMT    TO PV-GROUP-PRICE                 10560000
105700             MOVE ICOST         TO PV-COST                        10570000
105800             GO TO C500-EXIT                                      10580000
105900         END-IF                                                   10590000
106000                                                                  10600000
106100         MOVE PV-INAME-SKU  TO PV-INAME-SKU-PREV                  10610000
106200                                                                  10620000
106300         COMPUTE PV-QTY-ORDERED = PV-QTY-ORDERED + OQ             10630000
106400                                                                  10640000
106500         MOVE ICOST         TO PRT-COST                           10650000
106600         MOVE COST-UNIT-MSMT TO PRT-COST-QTY                      10660000
106700     END-IF.                                                      10670000
106800                                                                  10680000
106900 C500-EXIT.                                                       10690000
107000*                                                                 10700000
107100***************************************************************** 10710000
107200* D100-PRINT-ITEM-DETAIL - AT A CHANGE IS THE SKU NUMBER OR AT  * 10720000
107300* THE CHANGE IN REFERENCE NUMBERS A DETAIL RECORD IS WRITTEN    * 10730000
107400* OUT.                                                          * 10740000
107500***************************************************************** 10750000
107600                                                                  10760000
107700 D100-PRINT-ITEM-DETAIL.                                          10770000
107800                                                                  10780000
107900     IF PV-LINE1-CNT > PC-MAX-LINES OR                            10790000
108000        PV-LINE2-CNT > PC-MAX-LINES                               10800000
108100         PERFORM C200-REPORT-HEADINGS THRU C200-EXIT              10810000
108200         PERFORM C300-ORDER-HEADINGS THRU C300-EXIT               10820000
108300     END-IF.                                                      10830000
108400                                                                  10840000
108500     MOVE PV-INAME-SKU-PREV TO PRT-SKU.                           10850000
108600                                                                  10860000
108700     MOVE PV-RETAIL-QTY         TO PRT-RETAIL-QTY.                10870000
108800     MOVE PV-GROUP-QTY          TO PRT-GROUP-QTY.                 10880000
108900                                                                  10890000
109000     MOVE PV-SKU                TO PRT-SKU.                       10900000
109100     MOVE PV-UPC-1              TO PRT-UPC-1.                     10910000
109200     MOVE PV-UPC-2              TO PRT-UPC-2.                     10920000
109300     MOVE PV-UPC-3              TO PRT-UPC-3.                     10930000
109400     MOVE PV-UPC-4              TO PRT-UPC-4.                     10940000
109500                                                                  10950000
109600     IF PV-UPC-1 = ZEROES AND PV-UPC-2 = ZEROES AND               10960000
109700       PV-UPC-3 = ZEROES AND PV-UPC-4 = ZEROES                    10970000
109800           MOVE SPACES                TO PRT-SPACES               10980000
109900     END-IF.                                                      10990000
110000                                                                  11000000
110100     MOVE PV-STYLE              TO PRT-STYLE.                     11010000
110200     MOVE PV-SIZE               TO PRT-SIZE.                      11020000
110300     MOVE PV-COLOR              TO PRT-COLOR.                     11030000
110400     MOVE PV-RETAIL-PRICE       TO PRT-RETAIL-PRICE.              11040000
110500     MOVE PV-RETAIL-QTY         TO PRT-RETAIL-QTY.                11050000
110600     MOVE PV-GROUP-QTY          TO PRT-GROUP-QTY.                 11060000
110700     MOVE PV-GROUP-PRICE        TO PRT-GROUP-PRICE.               11070000
110800     MOVE PV-COST               TO PRT-COST.                      11080000
110900     MOVE PV-QTY-ORDERED        TO PRT-QTY-ORDERED.               11090000
111000                                                                  11100000
111100     COMPUTE PV-TOTAL-QTY = PV-TOTAL-QTY + PV-QTY-ORDERED.        11110000
111200                                                                  11120000
111300     COMPUTE PV-TOTAL-COST ROUNDED = PV-QTY-ORDERED *             11130000
111400                                                   PV-COST.       11140000
111500     MOVE PV-TOTAL-COST         TO PRT-TOTAL-COST.                11150000
111600                                                                  11160000
111700     IF PV-GROUP-PRICE > 1                                        11170000
111800         COMPUTE PV-TOTAL-RETAIL ROUNDED = (PV-GROUP-PRICE /      11180000
111900                                                   PV-GROUP-QTY)  11190000
112000         COMPUTE PV-TOTAL-RETAIL ROUNDED = (PV-TOTAL-RETAIL *     11200000
112100                                                 PV-QTY-ORDERED)  11210000
112200     ELSE                                                         11220000
112300         COMPUTE PV-TOTAL-RETAIL ROUNDED = (PV-RETAIL-PRICE *     11230000
112400                                                 PV-QTY-ORDERED)  11240000
112500     END-IF.                                                      11250000
112600                                                                  11260000
112700     MOVE PV-TOTAL-RETAIL       TO PRT-TOTAL-RETAIL.              11270000
112800                                                                  11280000
112900     IF PRT-QTY-ORDERED NOT = ZERO                                11290000
113000          IF NOT PS-REPORT-HEADING-VALID                          11300000
113100              SET PS-REPORT-HEADING-VALID TO TRUE                 11310000
113200              PERFORM C300-ORDER-HEADINGS THRU C300-EXIT          11320000
113300          END-IF                                                  11330000
113400       IF PS-CORP-REC                                             11340000
113500          WRITE PRINT-LINE2 FROM DETAIL-LINE                      11350000
113600              AFTER ADVANCING 1                                   11360000
113700          ADD 1 TO PV-LINE2-CNT                                   11370000
113800       ELSE                                                       11380000
113900          WRITE PRINT-LINE1 FROM DETAIL-LINE                      11390000
114000              AFTER ADVANCING 1                                   11400000
114100          ADD 1 TO PV-LINE1-CNT                                   11410000
114200       END-IF                                                     11420000
114300     END-IF.                                                      11430000
114400                                                                  11440000
114500     COMPUTE PV-TOT-EXT-COST = PV-TOT-EXT-COST + PV-TOTAL-COST.   11450000
114600                                                                  11460000
114700     COMPUTE PV-TOT-EXT-RTL = PV-TOT-EXT-RTL + PV-TOTAL-RETAIL.   11470000
114800                                                                  11480000
114900     MOVE ZEROES TO PV-QTY-ORDERED.                               11490000
115000                                                                  11500000
115100 D100-EXIT.                                                       11510000
115200     EJECT                                                        11520000
115300*                                                                 11530000
115400***************************************************************** 11540000
115500* D200-PRINT-TOTAL       - AT THE CHANGE IN REFERENCE NUMBERS   * 11550000
115600* THE TOTAL LINES ARE WRITTEN OUT. THESE REPRESENT THE TOTALS *   11560000
115700* FOR THE SELECTED REFERENCE NUMBER.                            * 11570000
115800***************************************************************** 11580000
115900                                                                  11590000
116000 D200-PRINT-TOTAL.                                                11600000
116100                                                                  11610000
116200     IF PV-LINE1-CNT > PC-MAX-LINES OR                            11620000
116300        PV-LINE2-CNT > PC-MAX-LINES                               11630000
116400         PERFORM C200-REPORT-HEADINGS THRU C200-EXIT              11640000
116500         PERFORM C300-ORDER-HEADINGS THRU C300-EXIT               11650000
116600     END-IF.                                                      11660000
116700                                                                  11670000
116800     IF PV-TOT-EXT-RTL = ZERO                                     11680000
116900         MOVE ZEROES TO PV-TOT-MARKUP-PER                         11690000
117000     ELSE                                                         11700000
117100         COMPUTE PV-TOT-MARKUP-PER ROUNDED = ((PV-TOT-EXT-RTL -   11710000
117200                   PV-TOT-EXT-COST ) * 100 / PV-TOT-EXT-RTL)      11720000
117300     END-IF.                                                      11730000
117400                                                                  11740000
117500     MOVE PV-TOT-EXT-COST             TO TOTAL-EXT-COST.          11750000
117600                                                                  11760000
117700* IF PV-TOT-EXT-COST NOT = ZERO                                   11770000
117800* OR PV-TOT-EXT-RTL NOT = ZERO                                    11780000
117900     MOVE PV-TOTAL-QTY TO TOTAL-ORDER-QTY-1.                      11790000
118000                                                                  11800000
118100     IF PS-CORP-REC                                               11810000
118200          WRITE PRINT-LINE2 FROM TOTAL-LINE1                      11820000
118300               AFTER ADVANCING 2                                  11830000
118400          MOVE PV-TOT-EXT-RTL                TO TOTAL-EXT-RETAIL  11840000
118500          WRITE PRINT-LINE2 FROM TOTAL-LINE2                      11850000
118600               AFTER ADVANCING 1                                  11860000
118700          MOVE PV-TOT-MARKUP-PER             TO TOTAL-MARKUP-PER  11870000
118800          WRITE PRINT-LINE2 FROM TOTAL-LINE3                      11880000
118900                AFTER ADVANCING 1                                 11890000
119000          WRITE PRINT-LINE2 FROM TOTAL-LINE4                      11900000
119100                AFTER ADVANCING 1                                 11910000
119200          ADD 7                                 TO PV-LINE2-CNT   11920000
119300     ELSE                                                         11930000
119400          WRITE PRINT-LINE1 FROM TOTAL-LINE1                      11940000
119500               AFTER ADVANCING 2                                  11950000
119600          MOVE PV-TOT-EXT-RTL                TO TOTAL-EXT-RETAIL  11960000
119700          WRITE PRINT-LINE1 FROM TOTAL-LINE2                      11970000
119800               AFTER ADVANCING 1                                  11980000
119900          MOVE PV-TOT-MARKUP-PER             TO TOTAL-MARKUP-PER  11990000
120000          WRITE PRINT-LINE1 FROM TOTAL-LINE3                      12000000
120100                AFTER ADVANCING 1                                 12010000
120200          WRITE PRINT-LINE1 FROM TOTAL-LINE4                      12020000
120300                AFTER ADVANCING 1                                 12030000
120400          ADD 7                                 TO PV-LINE1-CNT   12040000
120500     END-IF                                                       12050000
120600* END-IF.                                                         12060000
120700                                                                  12070000
120800                                                                  12080000
120900     INITIALIZE PV-TOTAL-LINES.                                   12090000
121000                                                                  12100000
121100 D200-EXIT.                                                       12110000
121200     EJECT                                                        12120000
121300*                                                                 12130000
