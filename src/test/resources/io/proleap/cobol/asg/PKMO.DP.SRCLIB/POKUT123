000100******************************************************************00010023
000200 IDENTIFICATION DIVISION.                                         00020023
000300******************************************************************00030023
000400*                                                                 00040023
000500 PROGRAM-ID.     POKUT123.                                        00050068
000600 AUTHOR.         COGNIZANT.                                       00060023
000700 INSTALLATION.   KOHLS DEPARTMENT STORES.                         00070023
000800 DATE-WRITTEN.   03/26/2010.                                      00080023
000900 DATE-COMPILED.                                                   00090023
001000                                                                  00100023
001100******************************************************************00110023
001200* -THIS PROGRAM FORMATS THE PURCHASE ORDER/RECEIPT DATA INTO     *00120023
001300*  TWO DIFFERENT FILES SEPARATED BY DELIMITER ','.               *00130023
001400*                                                                *00140023
001500* -THIS ALSO CREATES THE TRANSACTION ID,WHICH IS THE SAME FOR A  *00150023
001600*  SINGLE RUN AND WILL BE INCREMENTED BY 1 FOR SUBSEQUENT RUNS.  *00160023
001700*                                                                *00170023
001800* -THIS ALSO GENERATES THE SEQUENCE NUMBER WHICH IS A UNIQUE     *00180023
001900*  NUMBER AND SHOULD BE INCREMENTETD BY 1 FOR EACH RECORDS.      *00190023
002000******************************************************************00200023
002100*    P R O G R A M   M O D I F I C A T I O N   H I S T O  R Y    *00210023
002200*    --------------------------------------------------------    *00220023
002300*   03-26-2010  COGNIZANT       WR# 2344                         *00230025
11752A*   02-27-2017  J. JAKSE        CHANGES FOR EP UPGRADE            00231026
11752A*   06/23/2017  J SELWITSCHKA   NEW VERSION POKUT123 IS A COPY    00234068
11752A*                               OF POKUT120 WITH EP UPGRADE       00235068
11752A*                               CHANGES. CREATED BECAUSE EP       00236068
11752A*                               UPGRADE VERSION WILL BE RUNNING   00236168
11752A*                               IN PARALLEL WITH OLD VERSION.     00237068
11752A*   07/17/2017  J SELWITSCHKA   CHANGE ORDER OF ON ORDER FIELDS.  00238070
C12018*   11/14/2017  J SELWITSCHKA   BREAK OUT EARLY SHIP REPLENISHMENT00239072
C12018*                               INTO SEPARATE METRIC.             00239172
002400******************************************************************00240023
002500 ENVIRONMENT DIVISION.                                            00250023
002600******************************************************************00260023
002700                                                                  00270023
002800******************************************************************00280023
002900 CONFIGURATION SECTION.                                           00290023
003000******************************************************************00300023
003100                                                                  00310023
003200 SOURCE-COMPUTER.        IBM-3090.                                00320023
003300 OBJECT-COMPUTER.        IBM-3090.                                00330023
003400                                                                  00340023
003500******************************************************************00350023
003600 INPUT-OUTPUT SECTION.                                            00360023
003700******************************************************************00370023
003800                                                                  00380023
003900 FILE-CONTROL.                                                    00390023
004000                                                                  00400023
004100     SELECT OTB-PO-IN-FILE                                        00410023
004200         ASSIGN TO INP01.                                         00420023
004300                                                                  00430023
004400     SELECT OTB-RECT-IN-FILE                                      00440023
004500         ASSIGN TO INP02.                                         00450023
004600                                                                  00460023
004700     SELECT OTB-PO-OUT-FILE                                       00470023
004800         ASSIGN TO OUT01.                                         00480023
004900                                                                  00490023
005000     SELECT OTB-RECT-OUT-FILE                                     00500023
005100         ASSIGN TO OUT02.                                         00510023
005200                                                                  00520023
005300     SELECT TRANS-IN-FILE                                         00530023
005400         ASSIGN TO INP03.                                         00540023
005500                                                                  00550023
005600     SELECT TRANS-OUT-FILE                                        00560023
005700         ASSIGN TO OUT03.                                         00570023
005800                                                                  00580023
005900******************************************************************00590023
006000 DATA DIVISION.                                                   00600023
006100******************************************************************00610023
006200                                                                  00620023
006300******************************************************************00630023
006400 FILE SECTION.                                                    00640023
006500******************************************************************00650023
006600 FD  OTB-PO-IN-FILE                                               00660023
006700     RECORDING MODE IS F                                          00670023
006800     LABEL RECORDS ARE STANDARD                                   00680023
006900     BLOCK CONTAINS 0 RECORDS.                                    00690023
007000                                                                  00700023
007100 01  OTB-PO-IN-RECORD                       PIC X(300).           00710023
007200                                                                  00720023
007300 FD  OTB-RECT-IN-FILE                                             00730023
007400     RECORDING MODE IS F                                          00740023
007500     LABEL RECORDS ARE STANDARD                                   00750023
007600     BLOCK CONTAINS 0 RECORDS.                                    00760023
007700                                                                  00770023
007800 01  OTB-RECT-IN-RECORD                     PIC X(300).           00780067
007900                                                                  00790023
008000 FD  OTB-PO-OUT-FILE                                              00800023
008100     RECORDING MODE IS F                                          00810023
008200     LABEL RECORDS ARE STANDARD                                   00820023
008300     BLOCK CONTAINS 0 RECORDS.                                    00830023
008400                                                                  00840023
008500 01  OTB-PO-OUT-RECORD                      PIC X(300).           00850023
008600                                                                  00860023
008700 FD  OTB-RECT-OUT-FILE                                            00870023
008800     RECORDING MODE IS F                                          00880023
008900     LABEL RECORDS ARE STANDARD                                   00890023
009000     BLOCK CONTAINS 0 RECORDS.                                    00900023
009100                                                                  00910023
009200 01  OTB-RECT-OUT-RECORD                    PIC X(300).           00920067
009300                                                                  00930023
009400 FD  TRANS-IN-FILE                                                00940023
009500     RECORDING MODE IS F                                          00950023
009600     LABEL RECORDS ARE STANDARD                                   00960023
009700     BLOCK CONTAINS 0 RECORDS.                                    00970023
009800                                                                  00980023
009900 01  TRANS-IN-RECORD                        PIC X(80).            00990023
010000                                                                  01000023
010100 FD  TRANS-OUT-FILE                                               01010023
010200     RECORDING MODE IS F                                          01020023
010300     LABEL RECORDS ARE STANDARD                                   01030023
010400     BLOCK CONTAINS 0 RECORDS.                                    01040023
010500                                                                  01050023
010600 01  TRANS-OUT-RECORD                       PIC X(80).            01060023
010700                                                                  01070023
010800******************************************************************01080023
010900 WORKING-STORAGE SECTION.                                         01090023
011000******************************************************************01100023
011100                                                                  01110023
011200 01  PS-PROGRAM-SWITCHES.                                         01120023
011300     05  WS-OTB-SW                  PIC X      VALUE 'N'.         01130023
011400         88  WS-OTB-FILE-DONE                  VALUE 'Y'.         01140023
011500         88  WS-OTB-FILE-NOT-DONE              VALUE 'N'.         01150023
011600     05  WS-OTB-RECPT-SW            PIC X      VALUE 'N'.         01160023
011700         88  WS-OTB-RECPT-DONE                 VALUE 'Y'.         01170023
011800         88  WS-OTB-RECPT-NOT-DONE             VALUE 'N'.         01180023
011900     05  WS-TRANS-FILE-SW           PIC X      VALUE 'N'.         01190023
012000         88  WS-TRANS-FILE-DONE                VALUE 'Y'.         01200023
012100         88  WS-TRANS-FILE-NOT-DONE            VALUE 'N'.         01210023
012200                                                                  01220023
012300 01  PV-PROGRAM-VARIABLES.                                        01230023
012400     05  WS-OTB-OUT-RECORD          PIC X(300) VALUE SPACES.      01240023
11752A     05  WS-OUT-RECORD              PIC X(300) VALUE SPACES.      01241056
11752A     05  PV-POS1                    PIC 9(4)   VALUE ZEROES.      01242056
11752A     05  PV-POS2                    PIC 9(4)   VALUE ZEROES.      01243056
012500     05  WS-PO-READ-COUNT           PIC 9(9)   VALUE ZEROES.      01250023
012600     05  WS-PO-WRITE-COUNT          PIC 9(9)   VALUE ZEROES.      01260023
012700     05  WS-RECP-READ-COUNT         PIC 9(9)   VALUE ZEROES.      01270023
012800     05  WS-RECP-WRITE-COUNT        PIC 9(9)   VALUE ZEROES.      01280023
012900     05  WS-SPACE-CNT               PIC 9(1)   VALUE ZEROES.      01290023
013000     05  WS-START-POS               PIC 9(1)   VALUE ZEROES.      01300023
013100     05  WS-END-POS                 PIC 9(1)   VALUE ZEROES.      01310023
013200     05  WS-STRT-TRN-POS            PIC 9(1)   VALUE ZEROES.      01320023
013300     05  WS-END-TRN-POS             PIC 9(1)   VALUE ZEROES.      01330023
013400     05  WS-SEQ-NO                  PIC 9(9)   VALUE ZEROES.      01340023
013500     05  WS-SEQ-NO-TMP              PIC Z(9)   VALUE ZEROES.      01350023
013600     05  WS-TRANS-ID-TMP            PIC Z(9)   VALUE ZEROES.      01360023
013700     05  WS-TRANS-REC.                                            01370023
013800         10  WS-TRANS-ID            PIC 9(9)   VALUE ZEROES.      01380023
013900         10  WS-SEQ-ID              PIC 9(9)   VALUE ZEROES.      01390023
014000         10  FILLER                 PIC X(62)  VALUE SPACES.      01400023
11752A     05  WS-CURRENT-DATE            PIC X(21)  VALUE SPACES.      01401028
11752A     05  WS-PASTDUEREG-DLR          PIC S9(06)V9(05) VALUE ZERO.  01402029
11752A     05  WS-PASTDUEREG-CST          PIC S9(06)V9(05) VALUE ZERO.  01403029
11752A     05  WS-PASTDUERPLN-DLR         PIC S9(06)V9(05) VALUE ZERO.  01404029
11752A     05  WS-PASTDUERPLN-CST         PIC S9(06)V9(05) VALUE ZERO.  01405029
11752A     05  WS-PASTDUE-DLR             PIC S9(06)V9(05) VALUE ZERO.  01406029
11752A     05  WS-PASTDUE-CST             PIC S9(06)V9(05) VALUE ZERO.  01407029
11752A     05  WS-PASTDUEFT-DLR           PIC S9(06)V9(05) VALUE ZERO.  01408032
11752A     05  WS-PASTDUEFT-CST           PIC S9(06)V9(05) VALUE ZERO.  01409032
11752A     05  WS-CURWREG-DLR             PIC S9(06)V9(05) VALUE ZERO.  01409132
11752A     05  WS-CURWREG-CST             PIC S9(06)V9(05) VALUE ZERO.  01409232
11752A     05  WS-CURWFT-DLR              PIC S9(06)V9(05) VALUE ZERO.  01409332
11752A     05  WS-CURWFT-CST              PIC S9(06)V9(05) VALUE ZERO.  01409432
11752A     05  WS-CURWRPLN-DLR            PIC S9(06)V9(05) VALUE ZERO.  01409561
11752A     05  WS-CURWRPLN-CST            PIC S9(06)V9(05) VALUE ZERO.  01409661
11752A     05  WS-CURRECRPLN-DLR          PIC S9(06)V9(05) VALUE ZERO.  01409761
11752A     05  WS-CURRECRPLN-CST          PIC S9(06)V9(05) VALUE ZERO.  01409861
11752A     05  WS-CURRECDS-DLR            PIC S9(06)V9(05) VALUE ZERO.  01409961
11752A     05  WS-CURRECDS-CST            PIC S9(06)V9(05) VALUE ZERO.  01410061
11752A     05  WS-EARLYRECREG-DLR         PIC S9(06)V9(05) VALUE ZERO.  01410161
11752A     05  WS-EARLYRECREG-CST         PIC S9(06)V9(05) VALUE ZERO.  01411035
11752A     05  WS-EARLYRECFT-DLR          PIC S9(06)V9(05) VALUE ZERO.  01412035
11752A     05  WS-EARLYRECFT-CST          PIC S9(06)V9(05) VALUE ZERO.  01413035
11752A     05  WS-EARLYRECRPLN-DLR        PIC S9(06)V9(05) VALUE ZERO.  01414035
11752A     05  WS-EARLYRECRPLN-CST        PIC S9(06)V9(05) VALUE ZERO.  01415035
11752A     05  WS-EARLYSHIP-DLR           PIC S9(06)V9(05) VALUE ZERO.  01416035
11752A     05  WS-EARLYSHIP-CST           PIC S9(06)V9(05) VALUE ZERO.  01417035
11752A     05  WS-DIRECTSHIP-DLR          PIC S9(06)V9(05) VALUE ZERO.  01417146
11752A     05  WS-DIRECTSHIP-CST          PIC S9(06)V9(05) VALUE ZERO.  01417246
M14100                                                                  01418035
014200******************************************************************01420023
014300*  INPUT-ACTIVE PO EXTRACT RECORD LAYOUT.                         01430023
014400******************************************************************01440023
014500     COPY POWS090.                                                01450023
014600******************************************************************01460023
014700*  INPUT-RECEIPT EXTRACT RECORD LAYOUT.                           01470023
014800******************************************************************01480023
11752A*    COPY POWS091.                                                01490069
11752A     COPY POWS092.                                                01491069
015000******************************************************************01500023
015100 PROCEDURE DIVISION.                                              01510023
015200******************************************************************01520023
015300* MAIN PROCESSING PARA                                            01530023
015400******************************************************************01540023
015500                                                                  01550023
015600 0000-MAINLINE.                                                   01560023
015700                                                                  01570023
015800     DISPLAY ' '.                                                 01580023
015900     DISPLAY '******************'.                                01590023
016000     DISPLAY '* BEGIN POKUT123 *'.                                01600068
016100     DISPLAY '******************'.                                01610023
016200     DISPLAY ' '.                                                 01620023
016300                                                                  01630023
016400     PERFORM 1000-INITIALIZE.                                     01640023
016500                                                                  01650023
016600     PERFORM 2000-FORMAT-PO-PARA                                  01660023
016700        THRU 2000-EXIT  UNTIL WS-OTB-FILE-DONE.                   01670023
016800                                                                  01680023
016900     MOVE  ZEROES       TO  WS-SEQ-NO                             01690023
017000                                                                  01700023
017100     PERFORM 3000-FORMAT-RECPT-PARA                               01710023
017200        THRU 3000-EXIT  UNTIL WS-OTB-RECPT-DONE.                  01720023
017300                                                                  01730023
017400     MOVE  WS-SEQ-NO    TO  WS-SEQ-ID                             01740023
017500     WRITE TRANS-OUT-RECORD  FROM WS-TRANS-REC                    01750023
017600                                                                  01760023
017700     PERFORM 9000-END-OF-JOB.                                     01770023
017800                                                                  01780023
017900     DISPLAY ' '.                                                 01790023
018000     DISPLAY '******************'.                                01800023
018100     DISPLAY '* END   POKUT123 *'.                                01810068
018200     DISPLAY '******************'.                                01820023
018300     DISPLAY ' '.                                                 01830023
018400                                                                  01840023
018500     GOBACK.                                                      01850023
018600     EJECT                                                        01860023
018700                                                                  01870023
018800******************************************************************01880023
018900*   OPEN INPUT AND OUTPUT FILE AND PERFORM THE INITIAL READ.     *01890023
019000******************************************************************01900023
019100 1000-INITIALIZE.                                                 01910023
019200     DISPLAY '1000-INITIALIZE'.                                   01920023
019300                                                                  01930023
019400     OPEN INPUT  OTB-PO-IN-FILE                                   01940023
019500                 OTB-RECT-IN-FILE                                 01950023
019600                 TRANS-IN-FILE                                    01960023
019700          OUTPUT OTB-PO-OUT-FILE                                  01970023
019800                 OTB-RECT-OUT-FILE                                01980023
019900                 TRANS-OUT-FILE                                   01990023
020000                                                                  02000023
020100     PERFORM 1010-READ-OTB-PO-IN                                  02010023
020200        THRU 1010-EXIT.                                           02020023
020300                                                                  02030023
020400     PERFORM 1015-READ-OTB-RECPT-IN                               02040023
020500        THRU 1015-EXIT.                                           02050023
020600                                                                  02060023
020700     PERFORM 1020-READ-TRANS-IN                                   02070023
020800        THRU 1020-EXIT.                                           02080023
020900                                                                  02090023
11752A     MOVE FUNCTION CURRENT-DATE TO WS-CURRENT-DATE.               02091031
11752A                                                                  02092031
021000******************************************************************02100023
021100*   FORMAT THE PO DATA WITH DELIMITERS.                          *02110023
021200******************************************************************02120023
021300 2000-FORMAT-PO-PARA.                                             02130023
021400                                                                  02140023
021500     INITIALIZE  WS-OTB-OUT-RECORD                                02150023
021600                 WS-SPACE-CNT                                     02160023
021700                 WS-START-POS                                     02170023
021800                 WS-END-POS                                       02180023
021900                                                                  02190023
022000     ADD 01                 TO WS-SEQ-NO                          02200023
022100     MOVE WS-SEQ-NO         TO WS-SEQ-NO-TMP                      02210023
022200     MOVE WS-SEQ-NO-TMP     TO PO090-SEQ                          02220023
022300     MOVE WS-TRANS-ID-TMP   TO PO090-TRANS-ID                     02230023
022400                                                                  02240023
022500     INSPECT WS-SEQ-NO-TMP    TALLYING                            02250023
022600             WS-SPACE-CNT    FOR LEADING SPACES                   02260023
022700                                                                  02270023
022800     COMPUTE WS-START-POS = WS-SPACE-CNT  + 1                     02280023
022900     COMPUTE WS-END-POS   = 9 - WS-SPACE-CNT                      02290023
11752A* WRITE HEADER RECORD AS FIRST RECORD IN FILE                     02290128
11752A     IF WS-PO-READ-COUNT = 1                                      02290264
11752A        STRING 'TRANS_ID'           DELIMITED BY SIZE '|'         02290341
11752A               'PRODUCT_NAME'       DELIMITED BY SIZE '|'         02290441
11752A               'ORGANIZATION_NAME'  DELIMITED BY SIZE '|'         02290541
11752A               'CALENDAR_NAME'      DELIMITED BY SIZE '|'         02290641
11752A               'OOREG_CST'          DELIMITED BY SIZE '|'         02290770
11752A               'OOREG_RTL'          DELIMITED BY SIZE '|'         02291043
11752A               'OORPN_CST'          DELIMITED BY SIZE '|'         02291170
11752A               'OORPN_RTL'          DELIMITED BY SIZE '|'         02291244
11752A               'PDUE_CST'           DELIMITED BY SIZE '|'         02291370
11752A               'PDUE_RTL'           DELIMITED BY SIZE             02291470
11752A                       INTO WS-OTB-OUT-RECORD                     02291628
11752A        WRITE  OTB-PO-OUT-RECORD FROM WS-OTB-OUT-RECORD           02291728
11752A        INITIALIZE WS-OTB-OUT-RECORD                              02291828
11752A     END-IF                                                       02291928
11752A*                                                                 02292028
11752A* PO090-PASTDUEREG-DLR/CST NOW HOLDS TOTALS FOR PAST DUE          02292129
11752A* PO090-CURWREG-DLR/CST NOW HOLDS TOTALS FOR OO/FT                02293032
11752A     MOVE PO090-PASTDUEREG-DLR TO WS-PASTDUEREG-DLR               02300029
11752A     MOVE PO090-PASTDUEREG-CST TO WS-PASTDUEREG-CST               02301029
11752A     MOVE PO090-PASTDUERPLN-DLR TO WS-PASTDUERPLN-DLR             02301129
11752A     MOVE PO090-PASTDUERPLN-CST TO WS-PASTDUERPLN-CST             02301232
11752A     MOVE PO090-PASTDUEFT-DLR TO WS-PASTDUEFT-DLR                 02301332
11752A     MOVE PO090-PASTDUEFT-CST TO WS-PASTDUEFT-CST                 02301432
11752A                                                                  02301534
11752A     COMPUTE WS-PASTDUE-DLR = WS-PASTDUEREG-DLR +                 02301632
11752A                              WS-PASTDUERPLN-DLR +                02301732
11752A                              WS-PASTDUEFT-DLR                    02301832
11752A     COMPUTE WS-PASTDUE-CST = WS-PASTDUEREG-CST +                 02301932
11752A                              WS-PASTDUERPLN-CST +                02302032
11752A                              WS-PASTDUEFT-CST                    02302132
11752A                                                                  02302234
11752A     MOVE WS-PASTDUE-DLR TO PO090-PASTDUEREG-DLR                  02302332
11752A     MOVE WS-PASTDUE-CST TO PO090-PASTDUEREG-CST                  02302432
11752A                                                                  02302532
11752A     MOVE PO090-CURWREG-DLR TO WS-CURWREG-DLR                     02302632
11752A     MOVE PO090-CURWREG-CST TO WS-CURWREG-CST                     02302732
11752A     MOVE PO090-CURWFT-DLR TO WS-CURWFT-DLR                       02302832
11752A     MOVE PO090-CURWFT-CST TO WS-CURWFT-CST                       02302932
11752A                                                                  02303034
11752A     COMPUTE WS-CURWREG-DLR = WS-CURWREG-DLR +                    02303132
11752A                              WS-CURWFT-DLR                       02303232
11752A     COMPUTE WS-CURWREG-CST = WS-CURWREG-CST +                    02303332
11752A                              WS-CURWFT-CST                       02303433
11752A                                                                  02303534
11752A     MOVE WS-CURWREG-DLR TO PO090-CURWREG-DLR                     02305033
11752A     MOVE WS-CURWREG-CST TO PO090-CURWREG-CST                     02306033
11752A                                                                  02306161
11752A     MOVE PO090-CURWRPLN-DLR TO WS-CURWRPLN-DLR                   02306261
11752A     MOVE PO090-CURWRPLN-CST TO WS-CURWRPLN-CST                   02306361
11752A                                                                  02307033
11752A*    STRING  PO090-TRANS-ID(WS-STRT-TRN-POS:WS-END-TRN-POS) '|'   02310041
11752A*            PO090-SEQ(WS-START-POS:WS-END-POS) '|'               02320041
11752A     STRING  WS-CURRENT-DATE (1:14)  '|'                          02322041
023300             PO090-PRODUCT-NAME      '|'                          02330041
023400             PO090-ORGANIZATION-NAME '|'                          02340041
023500             PO090-CALENDAR-NAME     '|'                          02350041
11752A*            PO090-PASTDUEFT-DLR     '|'                          02380041
11752A*            PO090-PASTDUEFT-CST     '|'                          02390041
11752A*            PO090-PASTDUERPLN-DLR   '|'                          02400041
11752A*            PO090-PASTDUERPLN-CST   '|'                          02410041
024300             PO090-CURWREG-CST       '|'                          02430041
024200             PO090-CURWREG-DLR       '|'                          02431070
11752A*            PO090-CURWFT-DLR        '|'                          02440041
11752A*            PO090-CURWFT-CST        '|'                          02450041
024700             PO090-CURWRPLN-CST      '|'                          02470070
024600             PO090-CURWRPLN-DLR      '|'                          02471070
11752A             PO090-PASTDUEREG-CST    '|'                          02472070
11752A             PO090-PASTDUEREG-DLR                                 02473070
024800             DELIMITED BY SPACE INTO WS-OTB-OUT-RECORD            02480023
11752A*    WRITE  OTB-PO-OUT-RECORD FROM WS-OTB-OUT-RECORD.             02480157
11752A*    ADD  01                  TO  WS-PO-WRITE-COUNT               02480357
11752A     IF WS-PASTDUE-DLR        NOT = ZERO OR                       02480461
11752A        WS-PASTDUE-CST        NOT = ZERO OR                       02480561
11752A        WS-CURWREG-DLR        NOT = ZERO OR                       02480661
11752A        WS-CURWREG-CST        NOT = ZERO OR                       02480761
11752A        WS-CURWRPLN-DLR       NOT = ZERO OR                       02480861
11752A        WS-CURWRPLN-CST       NOT = ZERO                          02480961
11752A        INSPECT WS-OTB-OUT-RECORD REPLACING ALL                   02481057
11752A                '+000000.00000' BY '             '                02482057
11752A        INITIALIZE WS-OUT-RECORD                                  02483057
11752A                   PV-POS2                                        02484057
11752A        PERFORM VARYING PV-POS1 FROM 1 BY 1                       02485057
11752A           UNTIL PV-POS1 > 300                                    02486057
11752A           IF WS-OTB-OUT-RECORD (PV-POS1:1) NOT = SPACE           02487057
11752A              ADD  1 TO PV-POS2                                   02488057
11752A              MOVE WS-OTB-OUT-RECORD (PV-POS1:1)                  02489057
11752A                TO WS-OUT-RECORD (PV-POS2:1)                      02489157
11752A           END-IF                                                 02489257
11752A        END-PERFORM                                               02489357
11752A        WRITE OTB-PO-OUT-RECORD FROM WS-OUT-RECORD                02491057
11752A        ADD 01                TO  WS-PO-WRITE-COUNT               02500057
11752A     END-IF.                                                      02501057
025100                                                                  02510023
025200     PERFORM 1010-READ-OTB-PO-IN                                  02520023
025300        THRU 1010-EXIT.                                           02530023
025400 2000-EXIT.                                                       02540023
025500     EXIT.                                                        02550023
025600******************************************************************02560023
025700*   FORMAT THE RECEIPT DATA WITH DELIMITERS.                     *02570023
025800******************************************************************02580023
025900 3000-FORMAT-RECPT-PARA.                                          02590023
026000                                                                  02600023
026100     INITIALIZE  WS-OTB-OUT-RECORD                                02610054
026200                 WS-SPACE-CNT                                     02620023
026300                 WS-START-POS                                     02630023
026400                 WS-END-POS                                       02640023
026500                                                                  02650023
026600     ADD 01                 TO WS-SEQ-NO                          02660023
026700     MOVE WS-SEQ-NO         TO WS-SEQ-NO-TMP                      02670023
026800     MOVE WS-SEQ-NO-TMP     TO PO091-SEQ                          02680023
026900     MOVE WS-TRANS-ID-TMP   TO PO091-TRANS-ID                     02690023
027000                                                                  02700023
027100     INSPECT WS-SEQ-NO-TMP    TALLYING                            02710023
027200             WS-SPACE-CNT    FOR LEADING SPACES                   02720023
027300                                                                  02730023
027400     COMPUTE WS-START-POS = WS-SPACE-CNT  + 1                     02740023
027500     COMPUTE WS-END-POS   = 9 - WS-SPACE-CNT                      02750023
027600                                                                  02760023
11752A*WRITE HEADER RECORD AS FIRST RECORD IN FILE                      02761035
11752A     IF WS-RECP-READ-COUNT = 1                                    02761164
11752A        STRING 'TRANS_ID'           DELIMITED BY SIZE '|'         02761242
11752A               'PRODUCT_NAME'       DELIMITED BY SIZE '|'         02761342
11752A               'ORGANIZATION_NAME'  DELIMITED BY SIZE '|'         02761442
11752A               'CALENDAR_NAME'      DELIMITED BY SIZE '|'         02761542
11752A               'RECDS_RTL'          DELIMITED BY SIZE '|'         02761847
11752A               'RECDS_CST'          DELIMITED BY SIZE '|'         02761947
11752A               'ESHIP_RTL'          DELIMITED BY SIZE '|'         02762045
C12018               'ESHIP_CST'          DELIMITED BY SIZE '|'         02762172
C12018               'ESRPN_RTL'          DELIMITED BY SIZE '|'         02762272
C12018               'ESRPN_CST'          DELIMITED BY SIZE             02762372
029000                       INTO WS-OTB-OUT-RECORD                     02762471
029100       WRITE  OTB-RECT-OUT-RECORD FROM WS-OTB-OUT-RECORD          02762571
029200       INITIALIZE WS-OTB-OUT-RECORD                               02762671
11752A     END-IF                                                       02762771
11752A                                                                  02762871
11752A     MOVE PO091-CURRECDS-DLR   TO WS-CURRECDS-DLR                 02763363
11752A     MOVE PO091-CURRECDS-CST   TO WS-CURRECDS-CST                 02763463
11752A*                                                                 02766051
11752A     MOVE PO091-EARLYRECREG-DLR TO WS-EARLYRECREG-DLR             02767038
11752A     MOVE PO091-EARLYRECREG-CST TO WS-EARLYRECREG-CST             02768038
11752A     MOVE PO091-EARLYRECFT-DLR TO WS-EARLYRECFT-DLR               02769038
11752A     MOVE PO091-EARLYRECFT-CST TO WS-EARLYRECFT-CST               02769238
11752A     MOVE PO091-EARLYRECRPLN-DLR TO WS-EARLYRECRPLN-DLR           02769338
11752A     MOVE PO091-EARLYRECRPLN-CST TO WS-EARLYRECRPLN-CST           02769438
11752A                                                                  02769535
11752A     COMPUTE WS-EARLYSHIP-DLR = WS-EARLYRECREG-DLR +              02769638
11752A                               WS-EARLYRECFT-DLR  +               02769773
11752A                               WS-EARLYRECRPLN-DLR                02769873
11752A     COMPUTE WS-EARLYSHIP-CST = WS-EARLYRECREG-CST +              02769938
11752A                               WS-EARLYRECFT-CST  +               02770073
11752A                               WS-EARLYRECRPLN-CST                02770173
11752A                                                                  02770935
11752A     MOVE WS-EARLYSHIP-DLR TO PO091-EARLYRECREG-DLR               02771038
11752A     MOVE WS-EARLYSHIP-CST TO PO091-EARLYRECREG-CST               02771138
11752A                                                                  02771235
11752A*    STRING  PO091-TRANS-ID(WS-STRT-TRN-POS:WS-END-TRN-POS) '|'   02772042
11752A*            PO091-SEQ(WS-START-POS:WS-END-POS) '|'               02780042
11752A     STRING  WS-CURRENT-DATE (1:14)  '|'                          02781042
027900             PO091-PRODUCT-NAME      '|'                          02790042
028000             PO091-ORGANIZATION-NAME '|'                          02800042
028100             PO091-CALENDAR-NAME     '|'                          02810042
11752A*            PO091-CURRECREG-DLR     '|'                          02820042
11752A*            PO091-CURRECREG-CST     '|'                          02830042
11752A*            PO091-CURRECFT-DLR      '|'                          02840042
11752A*            PO091-CURRECFT-CST      '|'                          02850042
11752A*            PO091-CURRECRPLN-DLR    '|'                          02860065
11752A*            PO091-CURRECRPLN-CST    '|'                          02860165
11752A             PO091-CURRECDS-DLR      '|'                          02861050
11752A             PO091-CURRECDS-CST      '|'                          02862050
11752A             PO091-EARLYRECREG-DLR   '|'                          02880048
C12018             PO091-EARLYRECREG-CST   '|'                          02890072
11752A*            PO091-EARLYRECFT-DLR    '|'                          02900042
11752A*            PO091-EARLYRECFT-CST    '|'                          02910042
C12018             PO091-EARLYRECRPLN-DLR  '|'                          02920072
C12018             PO091-EARLYRECRPLN-CST                               02930072
029400             DELIMITED BY SPACE INTO WS-OTB-OUT-RECORD.           02940055
11752A*    WRITE  OTB-RECT-OUT-RECORD FROM WS-OTB-OUT-RECORD.           02940157
11752A*    ADD  01              TO  WS-RECP-WRITE-COUNT.                02940357
11752A     IF WS-CURRECDS-DLR       NOT = ZERO OR                       02940665
11752A        WS-CURRECDS-CST       NOT = ZERO OR                       02940761
11752A        WS-EARLYSHIP-DLR      NOT = ZERO OR                       02940861
C12018        WS-EARLYSHIP-CST      NOT = ZERO OR                       02940972
C12018        WS-EARLYRECRPLN-DLR   NOT = ZERO OR                       02941072
C12018        WS-EARLYRECRPLN-CST   NOT = ZERO                          02941172
11752A        INSPECT WS-OTB-OUT-RECORD REPLACING ALL                   02941271
11752A                '+000000.00000' BY '             '                02942057
11752A        INITIALIZE WS-OUT-RECORD                                  02943057
11752A                   PV-POS2                                        02944057
11752A        PERFORM VARYING PV-POS1 FROM 1 BY 1                       02945057
11752A           UNTIL PV-POS1 > 300                                    02946057
11752A           IF WS-OTB-OUT-RECORD (PV-POS1:1) NOT = SPACE           02947057
11752A              ADD  1 TO PV-POS2                                   02948057
11752A              MOVE WS-OTB-OUT-RECORD (PV-POS1:1)                  02949057
11752A                TO WS-OUT-RECORD (PV-POS2:1)                      02949157
11752A           END-IF                                                 02949257
11752A        END-PERFORM                                               02949357
11752A        WRITE OTB-RECT-OUT-RECORD FROM WS-OUT-RECORD              02951057
11752A        ADD 01            TO  WS-RECP-WRITE-COUNT                 02960057
11752A     END-IF.                                                      02961057
029700                                                                  02970023
029800     PERFORM 1015-READ-OTB-RECPT-IN                               02980023
029900        THRU 1015-EXIT.                                           02990023
030000 3000-EXIT.                                                       03000023
030100     EXIT.                                                        03010023
030200******************************************************************03020023
030300*   READ ACTIVE PO FILE                                           03030023
030400******************************************************************03040023
030500 1010-READ-OTB-PO-IN.                                             03050023
030600                                                                  03060023
030700     INITIALIZE POWS090-RECORD                                    03070023
030800     READ OTB-PO-IN-FILE  INTO POWS090-RECORD                     03080023
030900        AT END                                                    03090023
031000           SET WS-OTB-FILE-DONE  TO TRUE                          03100023
031100        NOT AT END                                                03110023
031200            ADD  01              TO  WS-PO-READ-COUNT.            03120023
031300 1010-EXIT.                                                       03130023
031400     EXIT.                                                        03140023
031500******************************************************************03150023
031600*   READ RECEIPT FILE                                             03160023
031700******************************************************************03170023
031800 1015-READ-OTB-RECPT-IN.                                          03180023
031900                                                                  03190023
032000     INITIALIZE POWS091-RECORD                                    03200023
032100     READ OTB-RECT-IN-FILE INTO POWS091-RECORD                    03210023
032200        AT END                                                    03220023
032300           SET WS-OTB-RECPT-DONE TO TRUE                          03230023
032400        NOT AT END                                                03240023
032500            ADD  01              TO  WS-RECP-READ-COUNT.          03250023
032600 1015-EXIT.                                                       03260023
032700     EXIT.                                                        03270023
032800******************************************************************03280023
032900*   1.READ TRANSACTION ID FILE                                    03290023
033000*   2.GENERATE THE CURRENT RUN TRANSACTION ID AND WRITE INTO      03300023
033100*     THE TRANSACTION FILE.                                       03310023
033200******************************************************************03320023
033300 1020-READ-TRANS-IN.                                              03330023
033400                                                                  03340023
033500     INITIALIZE WS-TRANS-ID                                       03350023
033600     READ TRANS-IN-FILE INTO WS-TRANS-REC                         03360023
033700        AT END                                                    03370023
033800           SET WS-TRANS-FILE-DONE  TO TRUE                        03380023
033900        NOT AT END                                                03390023
034000           ADD 01  TO        WS-TRANS-ID                          03400023
034100           MOVE WS-TRANS-ID        TO WS-TRANS-ID-TMP             03410023
034200           INSPECT WS-TRANS-ID-TMP  TALLYING                      03420023
034300                   WS-SPACE-CNT    FOR LEADING SPACES             03430023
034400                                                                  03440023
034500           COMPUTE WS-STRT-TRN-POS = WS-SPACE-CNT  + 1            03450023
034600           COMPUTE WS-END-TRN-POS  = 9 - WS-SPACE-CNT.            03460023
034700                                                                  03470023
034800 1020-EXIT.                                                       03480023
034900     EXIT.                                                        03490023
035000******************************************************************03500023
035100*  CLOSE ALL OPEN FILES.                                          03510023
035200******************************************************************03520023
035300 9000-END-OF-JOB.                                                 03530023
035400                                                                  03540023
035500     CLOSE OTB-PO-IN-FILE                                         03550023
035600           OTB-RECT-IN-FILE                                       03560023
035700           OTB-PO-OUT-FILE                                        03570023
035800           OTB-RECT-OUT-FILE                                      03580023
035900           TRANS-IN-FILE                                          03590023
036000           TRANS-OUT-FILE.                                        03600023
036100                                                                  03610023
036200     DISPLAY ' '.                                                 03620023
036300     DISPLAY '****************************************'.          03630023
036400     DISPLAY '   POKUT123 OUTPUT REC COUNTS:'.                    03640068
036500     DISPLAY ' '.                                                 03650023
036600     DISPLAY '   PO READ  COUNT     :' WS-PO-READ-COUNT.          03660023
036700     DISPLAY '   PO WRITE COUNT     :' WS-PO-WRITE-COUNT.         03670023
036800     DISPLAY '   RECPT READ  COUNT  :' WS-RECP-READ-COUNT.        03680023
036900     DISPLAY '   RECPT WRITE COUNT  :' WS-RECP-WRITE-COUNT.       03690023
037000     DISPLAY '****************************************'.          03700023
037100                                                                  03710023
