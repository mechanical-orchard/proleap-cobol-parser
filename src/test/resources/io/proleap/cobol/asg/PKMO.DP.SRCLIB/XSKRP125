000100*----------------------------------------------------------       00000200
000200 IDENTIFICATION DIVISION.                                         00000300
000300*----------------------------------------------------------       00000400
000400 PROGRAM-ID.    XSKRP125.                                         00000501
000500 AUTHOR.        CHERI PARMLEY.                                    00000601
000600 DATE-WRITTEN.  MAY 4, 2010.                                      00000701
000700                                                                  00000800
000800*----------------------------------------------------------       00000900
000900*            REBATE FORM INTEGRITY CHECK                          00001001
001000*----------------------------------------------------------       00001100
001010* THIS PROGRAM WILL PERFORM THE NECESSARY BUSINESS EVENT          00002000
001020* INTEGRITY CHECK FOR THE REBATE FORMS.                           00003001
001124*                                                                 00004000
001125*----------------------------------------------------------       00005000
001126* HISTORY LOG:                                                    00006000
001127*                                                                 00007000
001128*----------------------------------------------------------       00008000
001129* DATE:       08/13/2010                                          00009035
001130* WR/IR#:     WR38172                                             00010035
001131* PROGRAMMER: CHERI PARMLEY                                       00020035
001140* DESCRIPTION: IF LEADING SPACE IN TEXT AND ALL ELSE SAME         00030037
001140*              THIS IS A MATCH.                                   00031037
010511*----------------------------------------------------------       00032058
010511* DATE:       01/05/2011                                          00041058
010511* WR/IR#:     PKE5631                                             00042058
010511* PROGRAMMER: CHERI PARMLEY                                       00043058
010511* DESCRIPTION: SET RETURN CODE TO 04 EACH TIME RECORD IS          00044058
010511*              WRITTEN TO REPORT OR FILE.  LEFT JUSTIFY TEXT      00045058
010511*              AND THEN COMPARE LINE, PUNCTUATION IS INCLUDED.    00046058
001160*----------------------------------------------------------       00050000
001170 ENVIRONMENT DIVISION.                                            00060000
001180*----------------------------------------------------------       00070000
001190 CONFIGURATION SECTION.                                           00080000
001200 SOURCE-COMPUTER. IBM-3090.                                       00090000
001300 OBJECT-COMPUTER. IBM-3090.                                       00100000
001400                                                                  00110000
001500 INPUT-OUTPUT SECTION.                                            00120000
001600                                                                  00130000
001700 FILE-CONTROL.                                                    00140000
004900     SELECT CONTROL-CARD                                          00150000
005000         ASSIGN TO INP00.                                         00151000
                                                                        00152000
004900     SELECT PROMO-EXTRACT-FILE                                    00153000
005000         ASSIGN TO INP01.                                         00154000
                                                                        00155000
004900     SELECT DOMAIN-EXTRACT-FILE                                   00156000
005000         ASSIGN TO INP02.                                         00157000
                                                                        00159000
004900     SELECT ERROR-FILE                                            00160000
005000         ASSIGN TO OUT01.                                         00170000
                                                                        00180000
004900     SELECT REPORT-FILE                                           00190000
005000         ASSIGN TO RPT01.                                         00200000
                                                                        00201000
001900*----------------------------------------------------------       00202000
002000 DATA DIVISION.                                                   00203000
002100*----------------------------------------------------------       00204000
002200 FILE SECTION.                                                    00205000
002300                                                                  00206000
008000 FD  PROMO-EXTRACT-FILE                                           00207000
008100     RECORDING MODE IS F                                          00208000
008200     LABEL RECORDS ARE OMITTED                                    00209000
008300     RECORD CONTAINS 160 CHARACTERS                               00210033
008400     DATA RECORD IS PROMO-EVNT-RECORD.                            00220000
008500 01  PROMO-EVNT-REC              PIC X(160).                      00230033
008600                                                                  00240000
008000 FD  DOMAIN-EXTRACT-FILE                                          00250000
008100     RECORDING MODE IS F                                          00260000
008200     LABEL RECORDS ARE OMITTED                                    00270000
008300     RECORD CONTAINS 160 CHARACTERS                               00280033
008400     DATA RECORD IS DOMAIN-EVNT-RECORD.                           00290000
008500 01  DOMAIN-EVNT-REC              PIC X(160).                     00300033
006500                                                                  00310000
       FD  CONTROL-CARD                                                 00320000
           RECORDING MODE F                                             00330000
           BLOCK CONTAINS 0 RECORDS                                     00340000
           LABEL RECORDS ARE OMITTED                                    00350000
           DATA RECORD IS CONTROL-CARD-RECORD.                          00360000
       01  CONTROL-CARD-RECORD             PIC X(080).                  00370000
                                                                        00380000
       FD  REPORT-FILE                                                  00390000
           RECORDING MODE F                                             00400000
           BLOCK CONTAINS 0 RECORDS                                     00401000
           LABEL RECORDS ARE OMITTED                                    00402000
009600     RECORD CONTAINS 132 CHARACTERS                               00403000
           DATA RECORD IS REPORT-RECORD.                                00404000
       01  REPORT-RECORD                   PIC X(132).                  00405000
                                                                        00406000
       FD  ERROR-FILE                                                   00407000
           RECORDING MODE F                                             00408000
           BLOCK CONTAINS 0 RECORDS                                     00409000
           LABEL RECORDS ARE OMITTED                                    00410000
           DATA RECORD IS DIFFERENCES-RECORD.                           00410100
       01  DIFFERENCES-RECORD              PIC X(160).                  00410234
                                                                        00410300
002500*---------------------------------------------------------        00410400
002600                                                                  00410500
002700 WORKING-STORAGE SECTION.                                         00410600
002800*---------------------------------------------------------        00410700
003500* PC- PROGRAM CONSTANTS                                           00410800
003600*----------------------------------------------------------       00410900
003700 01  PC-PROGRAM-CONSTANTS.                                        00411000
003800     05  PC-PROGRAM-NAME              PIC X(08) VALUE 'XSKRP125'. 00412001
003900     05  PC-MAX-RETRIES               PIC S9(04) VALUE +5 COMP.   00413000
004000                                                                  00414000
097700 01  CD-CPU-DATE.                                                 00415000
097800     03  CD-CPU-YEAR             PIC 99.                          00416000
097900     03  CD-CPU-MONTH            PIC 99.                          00417000
098000     03  CD-CPU-DAY              PIC 99.                          00418000
098100                                                                  00419000
098200 01  CD-CPU-DATE-CC.                                              00420000
098300     03  CD-CPU-CENT             PIC 99.                          00430000
098400     03  CD-CPU-YYMMDD           PIC 9(6).                        00440000
                                                                        00450000
084800 01  PC-REPORT-NO                PIC  9(5)          VALUE 00001.  00460000
                                                                        00470000
011200 01  CT-CPU-TIME.                                                 00480000
011300     03  CT-HOUR                 PIC 99.                          00490000
011400     03  CT-MINUTE               PIC 99.                          00500000
011500     03  FILLER                  PIC 9(4).                        00501000
      *----------------------------------------------------------       00501100
      **PROGRAM                                                         00501200
      *----------------------------------------------------------       00501300
       01  PC-PROGRAM-COUNTER.                                          00501400
           05  PC-RECORD-COUNT                 PIC S9(09) VALUE ZEROS   00501500
                                                          COMP-3.       00501600
           05  PC-PROMO-EXTRACT-RECS-READ      PIC 9(09) VALUE ZEROS.   00501700
           05  PC-DOMAIN-EXTRACT-RECS-READ     PIC 9(09) VALUE ZEROS.   00501800
           05  PC-ERROR-RECORD-WRITTEN         PIC 9(09) VALUE ZEROS.   00501900
           05  PC-ERROR-REPORT-WRITTEN         PIC 9(09) VALUE ZEROS.   00502000
           05  PC-ERROR-REPORT-WRITTEN-LINE    PIC 9(09) VALUE ZEROS.   00502155
           05  PC-PAGE-CNT                     PIC 9(09) VALUE ZEROS.   00502255
004100*----------------------------------------------------------       00502355
004200* PS- PROGRAM SWITCHES                                            00502455
004300*----------------------------------------------------------       00502555
004400 01  PS-PROGRAM-SWITCHES.                                         00502655
004500     05  PS-EOF-PROMO-EXTRACT-SW          PIC X(01)  VALUE SPACE. 00502755
004600         88  PS-EOF-PROMO                        VALUE 'Y'.       00502855
004600         88  PS-NOT-EOF-PROMO                    VALUE 'N'.       00502955
004800                                                                  00503055
004500     05  PS-EOF-DOMAIN-EXTRACT-SW         PIC X(01)  VALUE SPACE. 00503155
004600         88  PS-EOF-DOMAIN                       VALUE 'Y'.       00504000
004600         88  PS-NOT-EOF-DOMAIN                   VALUE 'N'.       00505000
004800                                                                  00506000
004500     05  PS-NEW-RECORD-SW                 PIC X(01)  VALUE SPACE. 00507000
004600         88  PS-NEW-RECORD                       VALUE 'Y'.       00508000
004600         88  PS-NOT-NEW-RECORD                   VALUE 'N'.       00509000
004800                                                                  00510000
010511     05  WS-END-OF-VALUE-SW               PIC X(01)  VALUE 'N'.   00511058
010511         88  WS-END-OF-VALUE                     VALUE 'Y'.       00512058
004900*----------------------------------------------------------       00520000
      *    CONTROL-CARD-LAYOUT.                                         00530000
004900*----------------------------------------------------------       00540000
       01  CONTROL-CARD-LAYOUT.                                         00550000
           05  CC-START-POINT                  PIC 9(05) VALUE ZEROS.   00560000
           05  FILLER                          PIC X(01) VALUE SPACES.  00570000
           05  CC-READ-FREQUENCY               PIC 9(05) VALUE ZEROS.   00580000
           05  FILLER                          PIC X(69) VALUE SPACES.  00580100
004900*----------------------------------------------------------       00580200
005000* PV- PROGRAM VARIABLES                                           00580300
005100*----------------------------------------------------------       00580400
005200 01 PV-PROGRAM-VARIABLES.                                         00580500
013800    05  ABEND-CODE              PIC S9(4)  VALUE ZEROS COMP SYNC. 00580600
005500    05  PV-SQL-SUB                    PIC S9(4)  VALUE +0 COMP.   00580700
005600    05  PV-MAX-OFFSET-DTE             PIC 9(08)  VALUE 0.         00580800
005800    05  PV-ACTION-CODE                PIC X(01).                  00582000
005810        88  PV-INSERT-DATA                       VALUE 'I'.       00583000
005820        88  PV-UPDATE-DATA                       VALUE 'U'.       00584000
                                                                        00585000
006000    05  PV-RECORD-COUNT               PIC 9(05) VALUE ZEROS.      00586000
006000    05  PV-LD-STATUS-CDE              PIC X(02).                  00587000
006100        88  PV-NO-ERROR                          VALUE '00'.      00588000
006200        88  PV-CRITICAL-ERROR                    VALUE '01'.      00589000
006300        88  PV-NOT-CRITICAL-ERROR                VALUE '02'.      00590000
007000                                                                  00600000
           05  PS-ERROR-FOUND-SW               PIC X(01) VALUE 'N'.     00610000
               88  PS-ERROR-FOUND                        VALUE 'Y'.     00620000
               88  PS-ERROR-NOT-FOUND                    VALUE 'N'.     00630000
                                                                        00640000
007100    05  PV-STRT-PARM.                                             00650000
007200        10  PV-STRT-DTE-CC            PIC X(02).                  00660000
007200        10  PV-STRT-DTE-YY            PIC X(02).                  00670000
007400        10  PV-STRT-DTE-MM            PIC X(02).                  00680000
007600        10  PV-STRT-DTE-DD            PIC X(02).                  00690000
007400        10  FILLER                    PIC X.                      00700000
007400        10  PV-DECREMENT              PIC X(02).                  00710000
007400        10  FILLER                    PIC X(69).                  00720000
007700                                                                  00730000
007100    05  PV-PROMO-STRT-DTE           PIC X(10).                    00740000
007100    05  PV-PROMO-END-DTE            PIC X(10).                    00750000
                                                                        00760000
008600    05  PV-PROMO-KEY.                                             00770000
008700        10  PV-PM-PROMO-INTFC-ID          PIC 9(10).              00780019
008700        10  PV-PM-MDSE-LNE-ID             PIC 9(10).              00790000
008700        10  PV-PM-REBT-FM-ID              PIC 9(10).              00800002
008700        10  PV-PM-LNE-NBR                 PIC 9(03).              00800102
                                                                        00810000
008600    05  PV-DOMAIN-KEY.                                            00820000
008700        10  PV-XS-PROMO-INTFC-ID          PIC 9(10).              00830019
008700        10  PV-XS-MDSE-LNE-ID             PIC 9(10).              00831000
008700        10  PV-XS-REBT-FM-ID              PIC 9(10).              00832001
008700        10  PV-XS-LNE-NBR                 PIC 9(03).              00832102
                                                                        00833000
008600    05  PV-AD-EVNT-END-DTE-TM.                                    00834000
008700        10  PV-AD-EVNT-END-DTE.                                   00835000
008800            15  PV-AD-EVNT-DTE-TM2-CCYY   PIC X(04).              00836000
008900            15  FILLER                    PIC X(01).              00837000
009000            15  PV-AD-EVNT-DTE-TM2-MM     PIC X(02).              00838000
009100            15  FILLER                    PIC X(01).              00839000
009200            15  PV-AD-EVNT-DTE-TM2-DD     PIC X(02).              00840000
009300        10  PV-AD-EVNT-END-TM             PIC X(16).              00850000
009400                                                                  00860000
008600    05  PV-PROMO-SOURCE              PIC X(27) VALUE              00870013
              'DATA SOURCE IS THE PROMO DB'.                            00880012
                                                                        00890000
008600    05  PV-PROMO-NF                  PIC X(31) VALUE              00900036
              'RECORD NOT FOUND IN PROMO TABLE'.                        00910035
                                                                        00920000
008600    05  PV-DOMAIN-SOURCE             PIC X(31) VALUE              00930013
              'DATA SOURCE IS THE XS DOMAIN DB'.                        00940012
                                                                        00950000
008600    05  PV-DOMAIN-NF                  PIC X(31) VALUE             00960013
              'RECORD NOT FOUND IN XS DOMAIN  '.                        00970035
                                                                        00980000
002100    05  PM-FM-TEXT                     PIC  X(41)  VALUE SPACE.   00980137
                                                                        00980437
010511 01  LEFT-JUST-TABLE.                                             00980558
010511     05  WS-SUB1                      PIC 9(02)   VALUE ZERO.     00980658
010511     05  WS-SUB2                      PIC 9(02)   VALUE ZERO.     00980758
010511     05  WS-SUB3                      PIC 9(02)   VALUE 42.       00980858
010511*    ******************************************                   00980958
010511*    *  LEFT JUST PM065-FM-TXT AND XS122-FM-TXT                   00981058
010511*    ******************************************                   00981158
010511     05  WS-FROM-TXT-VALUE            PIC X(42)   VALUE SPACES.   00981258
010511     05  WS-FROM-TXT-VALUE-JUST REDEFINES WS-FROM-TXT-VALUE       00981358
010511                                      PIC X       OCCURS 42.      00981458
010511     05  WS-TO-TXT-VALUE              PIC X(42)   VALUE SPACES.   00981558
010511     05  WS-TO-TXT-VALUE-JUST REDEFINES WS-TO-TXT-VALUE           00981658
010511                                      PIC X       OCCURS 42.      00981758
010511     05  WS-PM-TXT-VALUE              PIC X(42)   VALUE SPACES.   00981858
010511     05  WS-XS-TXT-VALUE              PIC X(42)   VALUE SPACES.   00981958
                                                                        00982551
       01  PV-PM-TOTAL-RECORD.                                          00982600
           05 PV-PM-BUSINESS-EVNT-ID           PIC 9(03) VALUE ZERO.    00982700
           05 PV-PM-ACTION-CDE                 PIC X(01) VALUE 'T'.     00982800
           05 PV-PM-TOTAL-NBR-OF-RECS          PIC 9(11) VALUE ZERO.    00982900
                                                                        00983000
       01  PV-XS-TOTAL-RECORD.                                          00983100
           05 PV-XS-BUSINESS-EVNT-ID           PIC 9(03) VALUE ZERO.    00983200
           05 PV-XS-ACTION-CDE                 PIC X(01) VALUE 'T'.     00983300
           05 PV-XS-TOTAL-NBR-OF-RECS          PIC 9(11) VALUE ZERO.    00983400
                                                                        00983500
000700 01  ERROR-RECORD                    PIC X(258) VALUE SPACES.     00983600
                                                                        00983700
042800     COPY DPWS132O.                                               00984000
042900                                                                  00985000
                                                                        00986000
043100 01  DR-HEAD2.                                                    00987000
043200     05  FILLER                 PIC X(41)    VALUE SPACES.        00988000
043300     05  DR-TITLE               PIC X(55)    VALUE                00989000
043400      'INTEGRITY CHECK PROGRAM  - REBATES         '.              00990006
                                                                        00990100
043500                                                                  00990200
043100 01  DR-HEAD3.                                                    00990300
043200     05  FILLER                 PIC X(03)    VALUE                00990400
            'KEY'.                                                      00990500
043200     05  FILLER                 PIC X(32)    VALUE SPACES.        00990611
043200     05  FILLER                 PIC X(10)    VALUE                00990700
            'FIELD NAME'.                                               00990800
043200     05  FILLER                 PIC X(12)    VALUE SPACES.        00990909
043200     05  FILLER                 PIC X(05)    VALUE                00991000
            'VALUE'.                                                    00992000
043200     05  FILLER                 PIC X(39)    VALUE SPACES.        00993016
043200     05  FILLER                 PIC X(16)    VALUE                00993100
            'SOURCE / MESSAGE'.                                         00993200
043200     05  FILLER                 PIC X(35)    VALUE SPACES.        00993300
043500                                                                  00993400
043100 01  DR-HEAD5.                                                    00993500
043200     05  FILLER                 PIC X(132)   VALUE ALL '='.       00993600
                                                                        00993700
000700 01  REPORT-DETAIL.                                               00993800
000800   05 PROMO-RPT-INFO.                                             00993900
000800      10 PROMO-EVNT-KEY              PIC X(33)    VALUE SPACES.   00994011
 00800      10 FILLER                      PIC X(2)     VALUE SPACES.   00995015
 00800      10 PROMO-RPT-DATA-NAME         PIC X(20)    VALUE SPACES.   00996000
 00800      10 FILLER                      PIC X(2)     VALUE SPACES.   00996115
 00800      10 PROMO-RPT-DATA-VALUE        PIC X(42)    VALUE SPACES.   00996212
 00800      10 FILLER                      PIC X(2)     VALUE SPACES.   00996315
000800   05 REPORT-NOTES                   PIC X(31)    VALUE SPACES.   00996415
010900*----------------------------------------------------------       00996500
011000* DOMAIN REBATE RECORD LAYOUT                                     00996603
011100*----------------------------------------------------------       00996700
011200     COPY XSRD122.                                                00996803
011800                                                                  00996900
004900*----------------------------------------------------------       00997000
005000* PROMO REBATE   COPY BOOK.                                       00997103
005100*----------------------------------------------------------       00997200
           COPY PMRD065.                                                00997320
011800                                                                  00999500
030310                                                                  00999600
031400*----------------------------------------------------------       00999700
031500 PROCEDURE DIVISION.                                              00999800
032100*----------------------------------------------------------       00999900
032200 0000-MAINLINE.                                                   01000000
128200     ACCEPT CD-CPU-DATE FROM DATE.                                01000100
128300     IF CD-CPU-YEAR > 80                                          01000200
128400         MOVE 19 TO CD-CPU-CENT                                   01000300
128500     ELSE                                                         01001000
128600         MOVE 20 TO CD-CPU-CENT.                                  01010000
128700     MOVE CD-CPU-DATE TO CD-CPU-YYMMDD.                           01020000
128800                                                                  01030000
128900     ACCEPT CT-CPU-TIME FROM TIME.                                01040000
032300                                                                  01050000
032400     PERFORM 1000-INITIALIZATION.                                 01060000
032500                                                                  01070000
032600     PERFORM 2000-PROCESS-EXTRACT-DATA                            01080000
032700             UNTIL PS-EOF-DOMAIN                                  01090000
032700                OR PS-EOF-PROMO.                                  01100000
                                                                        01110000
           PERFORM 3000-PROCESS-EXTRA-RECORDS                           01120000
032700             UNTIL PS-EOF-DOMAIN                                  01130000
032700               AND PS-EOF-PROMO.                                  01140000
035000                                                                  01150000
035100     PERFORM 9999-WRAPUP.                                         01160000
035200                                                                  01170000
035500     GOBACK.                                                      01180000
035700                                                                  01190000
035701*0000-EXIT.                                                       01200000
035702 EJECT.                                                           01210000
035703                                                                  01220000
035800*----------------------------------------------------------       01230000
035900* 1000-INITIALIZATION.                                            01240000
036000*     INTIALIZES OR MOVES ANY VARIABLES BEFORE IT WILL            01250000
036100*     UPDATE OR INSERT A RECORD.                                  01260000
036200*----------------------------------------------------------       01270000
036300 1000-INITIALIZATION.                                             01280000
                                                                        01290000
132408     MOVE CD-CPU-YEAR  TO DP132O-RUN-YEAR.                        01300000
132409     MOVE CD-CPU-MONTH TO DP132O-RUN-MONTH.                       01310000
132410     MOVE CD-CPU-DAY   TO DP132O-RUN-DAY.                         01320000
132420     MOVE CT-HOUR    TO DP132O-RUN-HOUR.                          01330000
132430     MOVE CT-MINUTE  TO DP132O-RUN-MINUTE.                        01340000
132440     MOVE 'XSKRP125' TO DP132O-PROGRAM-NAME.                      01350002
132450     MOVE 1          TO DP132O-REPORT-NUMBER.                     01360000
           SET PS-NOT-EOF-PROMO TO TRUE.                                01370000
           SET PS-NOT-EOF-DOMAIN TO TRUE.                               01380000
026600     OPEN INPUT  PROMO-EXTRACT-FILE                               01390000
026600                 DOMAIN-EXTRACT-FILE                              01400000
026600                 CONTROL-CARD                                     01410000
026600          OUTPUT ERROR-FILE                                       01420000
026600                 REPORT-FILE.                                     01430000
                                                                        01440000
           PERFORM 1100-PRINT-HEADINGS.                                 01450026
           PERFORM 1200-READ-CONTROL-CARD.                              01460026
           READ DOMAIN-EXTRACT-FILE INTO PV-XS-TOTAL-RECORD             01470000
           READ PROMO-EXTRACT-FILE INTO PV-PM-TOTAL-RECORD              01480000
                                                                        01490000
           IF PV-PM-TOTAL-NBR-OF-RECS NOT EQUAL TO                      01500000
              PV-XS-TOTAL-NBR-OF-RECS                                   01510000
             MOVE 1 TO CC-START-POINT                                   01520000
             MOVE 1 TO CC-READ-FREQUENCY                                01530000
           END-IF.                                                      01540000
                                                                        01550000
           PERFORM 6400-READ-PROMO-EXTRACT CC-START-POINT TIMES.        01560028
           PERFORM 6500-READ-DOMAIN-EXTRACT  CC-START-POINT TIMES.      01570028
                                                                        01580000
056500                                                                  01590000
037240*1100-EXIT.                                                       01600000
037250 EJECT.                                                           01610000
037251                                                                  01620000
      ***************************************************************** 01621026
      **PRINT HEADINGS                                                  01622026
      ***************************************************************** 01623026
       1100-PRINT-HEADINGS.                                             01624026
           ADD 1 TO PC-PAGE-CNT.                                        01625026
           MOVE PC-PAGE-CNT TO DP132O-PAGE-NUMBER.                      01626026
010511     MOVE ZEROS TO PC-ERROR-REPORT-WRITTEN                        01627058
010511                   PC-ERROR-REPORT-WRITTEN-LINE.                  01627158
                                                                        01628026
491700     WRITE REPORT-RECORD                                          01629026
491800         FROM DP132O-STANDRD-HEADER-132-COLS                      01629126
491900         AFTER ADVANCING PAGE.                                    01629226
           ADD +1                       TO PC-ERROR-REPORT-WRITTEN.     01629326
                                                                        01629426
491700     WRITE REPORT-RECORD                                          01629526
491800         FROM DR-HEAD2                                            01629626
491900         AFTER ADVANCING 1 LINE.                                  01629726
           ADD +1                       TO PC-ERROR-REPORT-WRITTEN.     01629826
                                                                        01629926
491700     WRITE REPORT-RECORD                                          01630026
491800         FROM DR-HEAD3                                            01630126
491900         AFTER ADVANCING 2 LINE.                                  01630226
           ADD +2                       TO PC-ERROR-REPORT-WRITTEN.     01630326
                                                                        01630426
491700     WRITE REPORT-RECORD                                          01630526
491800         FROM DR-HEAD5                                            01630626
491900         AFTER ADVANCING 1 LINE.                                  01630726
                                                                        01630826
           ADD +1                       TO PC-ERROR-REPORT-WRITTEN.     01630926
                                                                        01631026
      ***************************************************************** 01631126
      **READ CONTROL CARD FOR FREQUENCY OF COMPARE                      01631226
      ***************************************************************** 01631326
       1200-READ-CONTROL-CARD.                                          01631426
                                                                        01631526
           READ CONTROL-CARD INTO CONTROL-CARD-LAYOUT.                  01631626
                                                                        01631726
       EJECT.                                                           01631826
037260*----------------------------------------------------------       01632000
037300* 2000-PROCESS-EXTRACT-DATA.                                      01640000
032800* THIS SECTION COMPARES RECORDS ON THE SOR REBATE CHANGE FILE &   01641001
032900* XS DOMAIN REBATE EXTRACT FILE. IF KEYS MATCH, PROGRAM LOOKS AT  01642001
032900* DETAIL FIELDS AND CHECKS THAT THEY MATCH, DIFFERENCES ARE       01643001
033000* REPORTED. IF THE KEY DOES NOT APPEAR ON ONE FILE,               01644001
033010* BUT IS ON THE OTHER FILE THEN AN APPROPRIATE MESSAGE WILL BE    01645001
033100* WRITTEN TO THE ERROR FILE, ALONG WITH THE DATA THAT WAS ON      01646001
033200* THE CORRESPONDING FILES. AT ANY TIME THERE IS A WRITE TO THE    01647029
010511* ERROR FILE OR THE REPORT AN EMAIL WILL BE GENERATED.            01648058
037800*----------------------------------------------------------       01690000
037900 2000-PROCESS-EXTRACT-DATA.                                       01700000
                                                                        01710000
           IF PM065-INCTV-PROMO-INTFC-ID  = XS122-INCTV-PROMO-INTFC-ID  01720019
             IF PM065-MDSE-SELN-SEQ-NBR   = XS122-MDSE-SELN-SEQ-NBR     01730021
               IF PM065-REBT-FM-ID        = XS122-REBT-FM-ID            01740041
                  IF PM065-FM-LNE-NBR     = XS122-FM-LNE-NBR            01741041
                       PERFORM 2100-COMPARE-FIELDS                      01790748
                       PERFORM 6500-READ-DOMAIN-EXTRACT                 01790948
                               CC-READ-FREQUENCY TIMES                  01791048
                       PERFORM 6400-READ-PROMO-EXTRACT                  01791148
                               CC-READ-FREQUENCY TIMES                  01791248
                  ELSE                                                  01791402
                     IF PM065-FM-LNE-NBR   > XS122-FM-LNE-NBR           01791602
                         MOVE PV-PROMO-NF    TO REPORT-NOTES            01791735
                         MOVE PV-DOMAIN-KEY  TO PROMO-EVNT-KEY          01791807
 00800                   MOVE SPACES         TO PROMO-RPT-DATA-NAME     01791907
 00800                   MOVE SPACES         TO PROMO-RPT-DATA-VALUE    01792007
                         PERFORM 4000-WRITE-ERROR-REPORT                01792126
                         MOVE XS122-REBT-FORM-RECORD TO ERROR-RECORD    01792207
                         PERFORM 4100-WRITE-ERROR-RECORD                01792326
                         PERFORM 6500-READ-DOMAIN-EXTRACT               01792428
                     ELSE                                               01792507
                         MOVE PV-DOMAIN-NF TO REPORT-NOTES              01792635
                         MOVE PV-PROMO-KEY  TO PROMO-EVNT-KEY           01792707
 00800                   MOVE SPACES         TO PROMO-RPT-DATA-NAME     01792807
 00800                   MOVE SPACES         TO PROMO-RPT-DATA-VALUE    01792907
                         PERFORM 4000-WRITE-ERROR-REPORT                01793026
                         MOVE PM065-REBT-FORM-RECORD    TO ERROR-RECORD 01793107
                         PERFORM 4100-WRITE-ERROR-RECORD                01793226
                         PERFORM 6400-READ-PROMO-EXTRACT                01793328
                     END-IF                                             01793407
      *################                                                 01794002
               ELSE                                                     01800000
                IF PM065-REBT-FM-ID > XS122-REBT-FM-ID                  01810001
                    MOVE PV-PROMO-NF    TO REPORT-NOTES                 01820035
                    MOVE PV-DOMAIN-KEY  TO PROMO-EVNT-KEY               01830000
 00800              MOVE SPACES         TO PROMO-RPT-DATA-NAME          01840000
 00800              MOVE SPACES         TO PROMO-RPT-DATA-VALUE         01850000
                    PERFORM 4000-WRITE-ERROR-REPORT                     01860026
                    MOVE XS122-REBT-FORM-RECORD TO ERROR-RECORD         01870002
                    PERFORM 4100-WRITE-ERROR-RECORD                     01880026
                    PERFORM 6500-READ-DOMAIN-EXTRACT                    01890028
                ELSE                                                    01891000
                    MOVE PV-DOMAIN-NF TO REPORT-NOTES                   01892035
                    MOVE PV-PROMO-KEY  TO PROMO-EVNT-KEY                01893000
 00800              MOVE SPACES         TO PROMO-RPT-DATA-NAME          01894000
 00800              MOVE SPACES         TO PROMO-RPT-DATA-VALUE         01895000
                    PERFORM 4000-WRITE-ERROR-REPORT                     01896026
                    MOVE PM065-REBT-FORM-RECORD      TO ERROR-RECORD    01897002
                    PERFORM 4100-WRITE-ERROR-RECORD                     01898026
                    PERFORM 6400-READ-PROMO-EXTRACT                     01899028
                END-IF                                                  01900000
               END-IF                                                   01900100
            ELSE                                                        01900218
               IF PM065-MDSE-SELN-SEQ-NBR >  XS122-MDSE-SELN-SEQ-NBR    01900322
                    MOVE PV-PROMO-NF    TO REPORT-NOTES                 01900735
                    MOVE PV-DOMAIN-KEY  TO PROMO-EVNT-KEY               01900800
 00800              MOVE SPACES         TO PROMO-RPT-DATA-NAME          01900900
 00800              MOVE SPACES         TO PROMO-RPT-DATA-VALUE         01901000
                    PERFORM 4000-WRITE-ERROR-REPORT                     01901126
                    MOVE XS122-REBT-FORM-RECORD TO ERROR-RECORD         01901202
                    PERFORM 4100-WRITE-ERROR-RECORD                     01901326
                    PERFORM 6500-READ-DOMAIN-EXTRACT                    01901428
               ELSE                                                     01901500
                    MOVE PV-DOMAIN-NF TO REPORT-NOTES                   01901935
                    MOVE PV-PROMO-KEY  TO PROMO-EVNT-KEY                01902022
                    MOVE SPACES         TO PROMO-RPT-DATA-NAME          01902122
                    MOVE SPACES         TO PROMO-RPT-DATA-VALUE         01902222
                    PERFORM 4000-WRITE-ERROR-REPORT                     01902326
                    MOVE PM065-REBT-FORM-RECORD      TO ERROR-RECORD    01902422
                    PERFORM 4100-WRITE-ERROR-RECORD                     01902526
                    PERFORM 6400-READ-PROMO-EXTRACT                     01902628
               END-IF                                                   01902722
             END-IF                                                     01902822
           ELSE                                                         01902922
            IF PM065-REBT-PROMO-ID  > XS122-REBT-PROMO-ID               01903022
                 MOVE PV-PROMO-NF    TO REPORT-NOTES                    01903235
                 MOVE PV-DOMAIN-KEY  TO PROMO-EVNT-KEY                  01903322
                    MOVE SPACES         TO PROMO-RPT-DATA-NAME          01903422
                    MOVE SPACES         TO PROMO-RPT-DATA-VALUE         01903522
                                                                        01903622
                 PERFORM 4000-WRITE-ERROR-REPORT                        01903726
                 MOVE XS122-REBT-FORM-RECORD TO ERROR-RECORD            01903822
                 PERFORM 4100-WRITE-ERROR-RECORD                        01903926
                 PERFORM 6500-READ-DOMAIN-EXTRACT                       01904028
            ELSE                                                        01904122
                 MOVE PV-DOMAIN-NF TO REPORT-NOTES                      01904335
                 MOVE PV-PROMO-KEY  TO PROMO-EVNT-KEY                   01904422
                    MOVE SPACES         TO PROMO-RPT-DATA-NAME          01904522
                    MOVE SPACES         TO PROMO-RPT-DATA-VALUE         01904622
                 PERFORM 4000-WRITE-ERROR-REPORT                        01904726
                 MOVE PM065-REBT-FORM-RECORD      TO ERROR-RECORD       01904822
                 PERFORM 4100-WRITE-ERROR-RECORD                        01904926
                 PERFORM 6400-READ-PROMO-EXTRACT                        01905028
            END-IF                                                      01905122
           END-IF.                                                      01905222
                                                                        01905322
038000                                                                  01905422
038110*2000-EXIT.                                                       01905522
038200 EJECT.                                                           01905622
                                                                        01905722
038300*------------------------------------------------------           01905822
038400* 2100-COMPARE-FIELDS.                                            01906000
038500*     COMPARES THE EXTRACT FILES AND NOTES ANY DIFFERENCES        01907000
038600*------------------------------------------------------           01908000
038210                                                                  01909000
054400 2100-COMPARE-FIELDS.                                             01910000
                                                                        01914043
           MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY.             01920000
036600     IF PM065-BUSINESS-EVNT-ID NOT EQUAL XS122-BUSINESS-EVNT-ID   01930004
              MOVE 'PM065-BUSINESS-EVNT-ID' TO PROMO-RPT-DATA-NAME      01940004
              MOVE PM065-BUSINESS-EVNT-ID   TO PROMO-RPT-DATA-VALUE     01941004
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              01942000
              MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY           01943000
              PERFORM 4000-WRITE-ERROR-REPORT                           01943126
              MOVE 'XS122-BUSINESS-EVNT-ID' TO PROMO-RPT-DATA-NAME      01943204
              MOVE XS122-BUSINESS-EVNT-ID   TO PROMO-RPT-DATA-VALUE     01943304
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             01943400
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           01943500
              PERFORM 4000-WRITE-ERROR-REPORT                           01943626
              SET PS-ERROR-FOUND     TO TRUE                            01943700
           END-IF.                                                      01943800
                                                                        01943900
036600     IF PM065-REBT-PROMO-ID    NOT EQUAL XS122-REBT-PROMO-ID      01944004
              MOVE 'PM065-REBT-PROMO-ID '   TO PROMO-RPT-DATA-NAME      01945004
              MOVE PM065-REBT-PROMO-ID      TO PROMO-RPT-DATA-VALUE     01946004
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              01947000
              MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY           01948000
              PERFORM 4000-WRITE-ERROR-REPORT                           01949026
              MOVE 'XS122-REBT-PROMO-ID '   TO PROMO-RPT-DATA-NAME      01950004
              MOVE XS122-REBT-PROMO-ID      TO PROMO-RPT-DATA-VALUE     01960004
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             01970000
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           01980000
              PERFORM 4000-WRITE-ERROR-REPORT                           01990026
              SET PS-ERROR-FOUND     TO TRUE                            02000000
           END-IF.                                                      02010000
                                                                        02020000
036600     IF PM065-MDSE-SELN-SEQ-NBR  NOT EQUAL TO                     02030023
              XS122-MDSE-SELN-SEQ-NBR                                   02040023
              MOVE 'PM065-MDSE-SELN-SEQ-NBR ' TO PROMO-RPT-DATA-NAME    02050023
              MOVE PM065-MDSE-SELN-SEQ-NBR    TO PROMO-RPT-DATA-VALUE   02060023
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              02070000
              MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY           02080000
              PERFORM 4000-WRITE-ERROR-REPORT                           02090026
              MOVE 'XS122-MDSE-SELN-SEQ-NBR '  TO PROMO-RPT-DATA-NAME   02100023
              MOVE XS122-MDSE-SELN-SEQ-NBR     TO PROMO-RPT-DATA-VALUE  02110023
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             02120000
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           02120100
              PERFORM 4000-WRITE-ERROR-REPORT                           02120226
              SET PS-ERROR-FOUND     TO TRUE                            02120300
           END-IF.                                                      02120400
                                                                        02120500
036600     IF PM065-REBT-FM-ID    NOT EQUAL XS122-REBT-FM-ID            02120604
              MOVE 'PM065-REBT-FM-ID  '   TO PROMO-RPT-DATA-NAME        02120704
              MOVE PM065-REBT-FM-ID       TO PROMO-RPT-DATA-VALUE       02120805
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              02120900
              MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY           02121000
              PERFORM 4000-WRITE-ERROR-REPORT                           02122026
              MOVE 'XS122-REBT-FM-ID   '  TO PROMO-RPT-DATA-NAME        02123004
              MOVE XS122-REBT-FM-ID        TO PROMO-RPT-DATA-VALUE      02124004
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             02125000
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           02126000
              PERFORM 4000-WRITE-ERROR-REPORT                           02127026
              SET PS-ERROR-FOUND     TO TRUE                            02128000
           END-IF.                                                      02129000
                                                                        02130000
036600     IF PM065-FM-SECT-TYP-CDE NOT EQUAL XS122-FM-SECT-TYP-CDE     02130104
              MOVE 'PM065-FM-SECT-TYP-CDE'   TO PROMO-RPT-DATA-NAME     02130204
              MOVE PM065-FM-SECT-TYP-CDE  TO PROMO-RPT-DATA-VALUE       02130304
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              02130400
              MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY           02130500
              PERFORM 4000-WRITE-ERROR-REPORT                           02130626
              MOVE 'XS122-FM-SECT-TYP-CDE'  TO PROMO-RPT-DATA-NAME      02130704
              MOVE XS122-FM-SECT-TYP-CDE     TO PROMO-RPT-DATA-VALUE    02130804
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             02130900
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           02131000
              PERFORM 4000-WRITE-ERROR-REPORT                           02131126
              SET PS-ERROR-FOUND     TO TRUE                            02131200
           END-IF.                                                      02131300
                                                                        02131400
036600     IF PM065-FM-LNE-TYP-CDE   NOT EQUAL XS122-FM-LNE-TYP-CDE     02131504
              MOVE 'PM065-FM-LNE-TYP-CDE'   TO PROMO-RPT-DATA-NAME      02131604
              MOVE PM065-FM-LNE-TYP-CDE   TO PROMO-RPT-DATA-VALUE       02131704
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              02131800
              MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY           02131900
              PERFORM 4000-WRITE-ERROR-REPORT                           02132026
              MOVE 'XS122-FM-LNE-TYP-CDE'  TO PROMO-RPT-DATA-NAME       02132104
              MOVE XS122-FM-LNE-TYP-CDE   TO PROMO-RPT-DATA-VALUE       02132204
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             02132300
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           02132400
              PERFORM 4000-WRITE-ERROR-REPORT                           02132526
              SET PS-ERROR-FOUND     TO TRUE                            02132600
           END-IF.                                                      02132700
                                                                        02132800
036600     IF PM065-FM-LNE-NBR  NOT EQUAL XS122-FM-LNE-NBR              02132904
              MOVE 'PM065-FM-LNE-NBR ' TO PROMO-RPT-DATA-NAME           02133004
              MOVE PM065-FM-LNE-NBR    TO PROMO-RPT-DATA-VALUE          02133104
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              02133200
              MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY           02133300
              PERFORM 4000-WRITE-ERROR-REPORT                           02133426
              MOVE 'XS122-FM-LNE-NBR ' TO PROMO-RPT-DATA-NAME           02133504
              MOVE XS122-FM-LNE-NBR  TO PROMO-RPT-DATA-VALUE            02133604
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             02133700
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           02133800
              PERFORM 4000-WRITE-ERROR-REPORT                           02133926
              SET PS-ERROR-FOUND     TO TRUE                            02134000
           END-IF.                                                      02135000
                                                                        02136000
036600     IF PM065-EFF-END-TMST NOT EQUAL XS122-EFF-END-TMST           02137043
              MOVE 'PM065-EFF-END-TMST' TO PROMO-RPT-DATA-NAME          02138043
              MOVE PM065-EFF-END-TMST  TO PROMO-RPT-DATA-VALUE          02139043
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              02140043
              MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY           02150043
              PERFORM 4000-WRITE-ERROR-REPORT                           02160043
              MOVE 'XS122-EFF-END-TMST' TO PROMO-RPT-DATA-NAME          02170043
              MOVE XS122-EFF-END-TMST TO PROMO-RPT-DATA-VALUE           02180043
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             02190043
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           02200043
              PERFORM 4000-WRITE-ERROR-REPORT                           02210043
              SET PS-ERROR-FOUND     TO TRUE                            02220043
           END-IF.                                                      02220143
                                                                        02220200
010511*    ****************************************                     02223858
010511*    * LEFT JUSTIFY PM TEXT                                       02223958
010511*    ****************************************                     02224058
010511     IF PM065-FM-TXT NOT = SPACE                                  02224158
010511         MOVE PM065-FM-TXT TO WS-FROM-TXT-VALUE                   02224258
010511         MOVE 1 TO WS-SUB1                                        02224458
010511                   WS-SUB2                                        02224558
010511         INITIALIZE WS-TO-TXT-VALUE                               02224658
010511         MOVE 'N' TO WS-END-OF-VALUE-SW                           02224758
010511         PERFORM 3100-LEFT-JUST-TXT                               02225058
010511            UNTIL WS-SUB1 > WS-SUB3                               02225158
010511               OR WS-END-OF-VALUE                                 02225258
010511         MOVE WS-TO-TXT-VALUE TO WS-PM-TXT-VALUE                  02225358
010511      ELSE                                                        02225558
010511         MOVE SPACE TO WS-PM-TXT-VALUE                            02225658
010511      END-IF.                                                     02225758
010511*    ****************************************                     02225858
010511*    * LEFT JUSTIFY XS TEXT                                       02225958
010511*    ****************************************                     02226058
010511     IF XS122-FM-TXT NOT = SPACE                                  02226158
010511         MOVE XS122-FM-TXT TO WS-FROM-TXT-VALUE                   02226258
010511         MOVE 1 TO WS-SUB1                                        02226458
010511                   WS-SUB2                                        02226558
010511         INITIALIZE WS-TO-TXT-VALUE                               02226658
010511         MOVE 'N' TO WS-END-OF-VALUE-SW                           02226758
010511         PERFORM 3100-LEFT-JUST-TXT                               02227058
010511            UNTIL WS-SUB1 > WS-SUB3                               02227158
010511               OR WS-END-OF-VALUE                                 02227258
010511         MOVE WS-TO-TXT-VALUE TO WS-XS-TXT-VALUE                  02227358
010511      ELSE                                                        02227558
010511         MOVE SPACE TO WS-XS-TXT-VALUE                            02227658
010511      END-IF.                                                     02227758
010511                                                                  02227858
010511     IF WS-PM-TXT-VALUE NOT EQUAL WS-XS-TXT-VALUE                 02227958
010511         MOVE 'PM065-FM-TXT    '      TO PROMO-RPT-DATA-NAME      02228058
010511         MOVE PM065-FM-TXT            TO PROMO-RPT-DATA-VALUE     02228158
010511         MOVE PV-PROMO-SOURCE         TO REPORT-NOTES             02228258
010511         MOVE PV-PROMO-KEY            TO PROMO-EVNT-KEY           02228358
010511         PERFORM 4000-WRITE-ERROR-REPORT                          02228458
010511         MOVE 'XS122-FM-TXT    '      TO PROMO-RPT-DATA-NAME      02228558
010511         MOVE XS122-FM-TXT            TO PROMO-RPT-DATA-VALUE     02228658
010511         MOVE PV-DOMAIN-SOURCE        TO REPORT-NOTES             02228758
010511         MOVE PV-DOMAIN-KEY           TO PROMO-EVNT-KEY           02228858
010511         PERFORM 4000-WRITE-ERROR-REPORT                          02228958
010511         SET PS-ERROR-FOUND     TO TRUE                           02229058
010511     END-IF.                                                      02229358
                                                                        02229400
036600     IF PM065-STAT-CDE   NOT EQUAL XS122-STAT-CDE                 02229504
              MOVE 'PM065-STAT-CDE  ' TO PROMO-RPT-DATA-NAME            02229604
              MOVE PM065-STAT-CDE     TO PROMO-RPT-DATA-VALUE           02229704
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              02229800
              MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY           02229900
              PERFORM 4000-WRITE-ERROR-REPORT                           02230026
              MOVE 'XS122-STAT-CDE  ' TO PROMO-RPT-DATA-NAME            02230104
              MOVE XS122-STAT-CDE   TO PROMO-RPT-DATA-VALUE             02230204
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             02230300
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           02230400
              PERFORM 4000-WRITE-ERROR-REPORT                           02230526
              SET PS-ERROR-FOUND     TO TRUE                            02230600
           END-IF.                                                      02231000
                                                                        02246300
           IF  PS-ERROR-FOUND                                           02246400
037200        IF PM065-LAST-UPD-TMST > XS122-LAST-UPD-TMST              02246504
                 PERFORM 4010-FORMAT-ERROR-RECORD                       02246626
                 PERFORM 4100-WRITE-ERROR-RECORD                        02246726
                 SET PS-ERROR-NOT-FOUND     TO TRUE                     02246800
              END-IF                                                    02246900
           END-IF.                                                      02247000
054500                                                                  02248000
056900 2100-EXIT.                                                       02249000
057000     EXIT.                                                        02250000
043600 EJECT.                                                           02260000
043610                                                                  02270000
      ******************************************************************02293000
      **COMPARES FIELDS BETWEEN FILES TO SEE IF ANY DIFFERENCES EXIST   02300000
      ******************************************************************02310000
       3000-PROCESS-EXTRA-RECORDS.                                      02320000
                                                                        02330000
           IF  PS-NOT-EOF-PROMO                                         02340000
               INITIALIZE REPORT-DETAIL                                 02350000
               MOVE PV-DOMAIN-NF            TO REPORT-NOTES             02360035
               MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY          02370000
               PERFORM 4000-WRITE-ERROR-REPORT                          02380026
               MOVE PM065-REBT-FORM-RECORD TO ERROR-RECORD              02390004
               PERFORM 4100-WRITE-ERROR-RECORD                          02400026
               PERFORM 6400-READ-PROMO-EXTRACT                          02410028
           END-IF.                                                      02420000
                                                                        02430000
           IF  PS-NOT-EOF-DOMAIN                                        02440000
               INITIALIZE REPORT-DETAIL                                 02450000
               MOVE PV-PROMO-NF              TO REPORT-NOTES            02460035
               MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY          02470000
               PERFORM 4000-WRITE-ERROR-REPORT                          02480026
               MOVE XS122-REBT-FORM-RECORD TO ERROR-RECORD              02490004
               PERFORM 4100-WRITE-ERROR-RECORD                          02500026
               PERFORM 6500-READ-DOMAIN-EXTRACT                         02510028
           END-IF.                                                      02520000
                                                                        02530000
056900 3000-EXIT.                                                       02540000
057000     EXIT.                                                        02550000
                                                                        02560000
                                                                        02561951
010511******************************************************************02562058
010511*  LEFT JUSTIFY TEXT                                              02562159
010511******************************************************************02562258
010511 3100-LEFT-JUST-TXT.                                              02562358
010511     IF WS-FROM-TXT-VALUE-JUST (WS-SUB1) > SPACE                  02562458
010511         MOVE 'Y' TO WS-END-OF-VALUE-SW                           02562558
010511         MOVE 1 TO WS-SUB2                                        02562658
010511         PERFORM 3200-MOVE-LEFT-JUST-TXT                          02562758
010511            UNTIL WS-SUB1 > WS-SUB3                               02562858
010511     ELSE                                                         02562958
010511         ADD 1 TO WS-SUB1                                         02563058
010511     END-IF.                                                      02563158
010511                                                                  02563258
010511******************************************************************02563358
010511*  MOVE LEFT JUSTIFY TEXT                                         02563458
010511******************************************************************02563558
010511 3200-MOVE-LEFT-JUST-TXT.                                         02563658
010511     MOVE WS-FROM-TXT-VALUE-JUST (WS-SUB1) TO                     02563758
010511          WS-TO-TXT-VALUE-JUST (WS-SUB2).                         02563858
010511     ADD 1 TO WS-SUB1                                             02563958
010511              WS-SUB2.                                            02564058
010511                                                                  02564158
      ***************************************************************** 02564226
      **WRITE ERROR REPORT                                              02564326
      ***************************************************************** 02564426
       4000-WRITE-ERROR-REPORT.                                         02564526
           IF PC-ERROR-REPORT-WRITTEN > 66                              02564626
              PERFORM 1100-PRINT-HEADINGS                               02564726
           ELSE                                                         02564826
              WRITE REPORT-RECORD FROM REPORT-DETAIL                    02564926
              INITIALIZE REPORT-DETAIL                                  02565026
010511        ADD +1 TO PC-ERROR-REPORT-WRITTEN-LINE                    02565158
           END-IF.                                                      02565226
                                                                        02565326
      ***************************************************************** 02565426
      **FORMAT ERROR-RECORD                                             02565526
      ***************************************************************** 02565626
       4010-FORMAT-ERROR-RECORD.                                        02565726
           MOVE PM065-REBT-FORM-RECORD TO ERROR-RECORD.                 02565826
                                                                        02565926
      ***************************************************************** 02566026
      **WRITE ERROR RECORD                                              02566126
      ***************************************************************** 02566226
       4100-WRITE-ERROR-RECORD.                                         02566326
           WRITE DIFFERENCES-RECORD FROM ERROR-RECORD.                  02566426
           ADD +1  TO PC-ERROR-RECORD-WRITTEN.                          02567026
       EJECT.                                                           02571000
                                                                        02571128
      ***************************************************************** 02572028
      **READ PROMO  EXTRACT FILE                                        02573028
      ***************************************************************** 02574028
       6400-READ-PROMO-EXTRACT.                                         02575028
           IF  PS-NOT-EOF-PROMO                                         02576028
               READ PROMO-EXTRACT-FILE INTO PM065-REBT-FORM-RECORD      02577028
                    AT END                                              02578028
                       SET PS-EOF-PROMO TO TRUE                         02579028
               END-READ                                                 02579128
           END-IF.                                                      02579228
                                                                        02579328
           IF  PS-NOT-EOF-PROMO                                         02579428
               ADD +1                  TO PC-PROMO-EXTRACT-RECS-READ    02579528
               MOVE PM065-INCTV-PROMO-INTFC-ID TO PV-PM-PROMO-INTFC-ID  02579628
               MOVE PM065-MDSE-SELN-SEQ-NBR    TO PV-PM-MDSE-LNE-ID     02579728
               MOVE PM065-REBT-FM-ID           TO PV-PM-REBT-FM-ID      02579828
               MOVE PM065-FM-LNE-NBR           TO PV-PM-LNE-NBR         02579928
           END-IF.                                                      02580028
                                                                        02580128
       EJECT.                                                           02580228
      ***************************************************************** 02580328
      **READ XS EXTRACT FILE                                            02580428
      ***************************************************************** 02580528
       6500-READ-DOMAIN-EXTRACT.                                        02580628
           IF  PS-NOT-EOF-DOMAIN                                        02580728
               READ DOMAIN-EXTRACT-FILE INTO XS122-REBT-FORM-RECORD     02580828
                    AT END                                              02580928
                       SET PS-EOF-DOMAIN TO TRUE                        02581028
               END-READ                                                 02581128
           END-IF.                                                      02581228
                                                                        02581328
           IF  PS-NOT-EOF-DOMAIN                                        02581428
               ADD +1              TO PC-DOMAIN-EXTRACT-RECS-READ       02581528
               MOVE XS122-INCTV-PROMO-INTFC-ID TO PV-XS-PROMO-INTFC-ID  02581628
               MOVE XS122-MDSE-SELN-SEQ-NBR    TO PV-XS-MDSE-LNE-ID     02581728
               MOVE XS122-REBT-FM-ID           TO PV-XS-REBT-FM-ID      02581828
               MOVE XS122-FM-LNE-NBR           TO PV-XS-LNE-NBR         02581928
           END-IF.                                                      02582028
                                                                        02582128
       EJECT.                                                           02582228
                                                                        02582328
059800*----------------------------------------------------------       02583000
059900* 9999-WRAPUP.                                                    02590000
010511*     CLOSE FILES                                                 02600058
010511*     CHECK IF ERROR, IF SO SET RETURN CODE                       02610058
060000*----------------------------------------------------------       02630000
060100 9999-WRAPUP.                                                     02640000
026600     CLOSE PROMO-EXTRACT-FILE                                     02650000
026600           DOMAIN-EXTRACT-FILE                                    02660000
026600           ERROR-FILE                                             02670000
026600           REPORT-FILE.                                           02680000
                                                                        02690000
010511     IF  PC-ERROR-RECORD-WRITTEN > 0 OR                           02700058
010511         PC-ERROR-REPORT-WRITTEN-LINE > 0                         02701058
               MOVE 04               TO RETURN-CODE                     02710000
           END-IF.                                                      02720000
060500                                                                  02750000
060710*9999-EXIT.                                                       02760000
