000100***************************************************************** 00001000
000200 IDENTIFICATION DIVISION.                                         00002000
000300***************************************************************** 00003000
000400 PROGRAM-ID.    CEKUT054.                                         00004000
000500 AUTHOR.        CHERI PARMLEY.                                    00005000
000600 INSTALLATION.  KOHLS.                                            00006000
000700 DATE-WRITTEN   MAY 2016.                                         00007000
000800 DATE-COMPILED.                                                   00008000
000900******************************************************************00009000
001000*  THIS PROGRAM WILL TAKE THE DUPLICATE FILE CREATED IN          *00009100
001100*  CEKUT053 (AFTER SORTED TO GET RID OF DUPS) AND WILL           *00009200
001100*  COMPARE TO THE CONTAINER ITEM FILE. IF DUPLICATE CONTAINER    *00009300
001100*  IS ON THE CONTAINER ITEM FILE, WRITE IT TO A DUPLICATE FILE   *00009400
001100*  OTHERWISE NON DUPLICATE DATA GOES TO THE GOOD FILE.           *00009500
001100*                                                                *00009600
001100*  01/09/2020  JEAN KURK                                         *00009700
001100*              RENAME FROM WMKUT054 TO CEKUT054                  *00009800
001100******************************************************************00009900
001200* CHANGE DESCRIPTION                                              00010000
001300******************************************************************00010100
001900*                                                                 00010200
001300******************************************************************00010300
001400***************************************************************** 00011000
001500 ENVIRONMENT DIVISION.                                            00012000
001600 INPUT-OUTPUT SECTION.                                            00013000
001700                                                                  00014000
001800 FILE-CONTROL.                                                    00015000
001900                                                                  00016000
002000     SELECT CARTON-DUP-FILE                                       00017000
002010         ASSIGN TO INP01.                                         00018000
002100                                                                  00019000
002110     SELECT CARTON-ITEM-FILE                                      00019100
002120         ASSIGN TO INP02.                                         00019200
002130                                                                  00019300
002140     SELECT DUP-ERROR-FILE                                        00019400
002150         ASSIGN TO OUT01.                                         00019500
002160                                                                  00019600
002140     SELECT EXTRACT-FILE                                          00019700
002150         ASSIGN TO OUT02.                                         00019800
002160                                                                  00019900
002200***************************************************************** 00020000
002300 DATA DIVISION.                                                   00021000
002400***************************************************************** 00022000
002500 FILE SECTION.                                                    00023000
002600                                                                  00024000
002700 FD  CARTON-DUP-FILE                                              00025000
002900     RECORDING MODE IS F                                          00026000
003000     LABEL RECORDS ARE STANDARD                                   00027000
003100     RECORD CONTAINS 91                                           00028000
003200     BLOCK CONTAINS 0 RECORDS                                     00029000
003300     DATA RECORD IS CONTAINER-RECORD.                             00029100
003000                                                                  00029200
003300 01  CARTON-RECORD                PIC X(91).                      00029300
003700                                                                  00029400
003710 FD  CARTON-ITEM-FILE                                             00029500
003700     RECORDING MODE IS F                                          00029600
003800     LABEL RECORDS ARE STANDARD                                   00029700
003900     RECORD CONTAINS 107                                          00029800
004000     BLOCK CONTAINS 0 RECORDS                                     00029900
004100     DATA RECORD IS ITEM-RECORD.                                  00030000
003750                                                                  00031000
003760 01  ITEM-RECORD                  PIC X(107).                     00032000
003770                                                                  00033000
003800                                                                  00034000
003810 FD  DUP-ERROR-FILE                                               00035000
003700     RECORDING MODE IS F                                          00036000
003800     LABEL RECORDS ARE STANDARD                                   00037000
003900     RECORD CONTAINS 107                                          00037100
004000     BLOCK CONTAINS 0 RECORDS                                     00037200
004100     DATA RECORD IS DUP-RECORD.                                   00037300
003850                                                                  00037400
003860 01  DUP-RECORD                   PIC X(107).                     00037500
003870                                                                  00037600
003810 FD  EXTRACT-FILE                                                 00037700
003700     RECORDING MODE IS F                                          00037800
003800     LABEL RECORDS ARE STANDARD                                   00037900
003900     RECORD CONTAINS 107                                          00038000
004000     BLOCK CONTAINS 0 RECORDS                                     00039000
004100     DATA RECORD IS EXTRACT-RECORD.                               00040000
003850                                                                  00040100
003860 01  EXTRACT-RECORD               PIC X(107).                     00040200
003880                                                                  00040300
003900***************************************************************** 00040400
004000 WORKING-STORAGE SECTION.                                         00040500
004100                                                                  00040600
004200 01  PS-PROGRAM-SWITCHES.                                         00040700
004300     05  PS-EOF-INPUT1-SW             PIC X(01)  VALUE 'N'.       00040800
004400         88  PS-EOF-INPUT1-YES                   VALUE 'Y'.       00040900
004500         88  PS-EOF-INPUT1-NO                    VALUE 'N'.       00041000
004510     05  PS-EOF-INPUT2-SW             PIC X(01)  VALUE 'N'.       00042000
004520         88  PS-EOF-INPUT2-YES                   VALUE 'Y'.       00043000
004530         88  PS-EOF-INPUT2-NO                    VALUE 'N'.       00044000
004600                                                                  00045000
004700 01  PC-PROGRAM-CONSTANTS.                                        00046000
004800     05  PC-PROGRAM-NAME              PIC  X(08) VALUE 'CEKUT054'.00047000
005000                                                                  00048000
005100 01  PV-PROGRAM-VARIABLES.                                        00049000
005900     05  PV-RECORDS-READ-1            PIC  9(09) VALUE  0.        00050000
005910     05  PV-RECORDS-READ-2            PIC  9(09) VALUE  0.        00051000
006000     05  PV-RECORDS-GOOD-WRITTEN      PIC  9(09) VALUE  0.        00052000
006000     05  PV-RECORDS-BAD-WRITTEN       PIC  9(09) VALUE  0.        00053000
006700     05  PV-SQLCODE                   PIC  S9(9) VALUE +0.        00054000
006800     05  PV-DISP-SQLCODE              PIC ZZZZZZ9-.               00055000
006900                                                                  00056000
007000                                                                  00057000
007100 01  PV-ABEND-FIELDS.                                             00058000
007200     05  PV-ABEND-CODE                PIC  S9(4) VALUE +0         00059000
007300                                                 COMP SYNC.       00059100
007400     05  PV-ABEND-PROGRAM             PIC  X(08) VALUE 'CEKUT054'.00059200
007500     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    00059300
007600     05  PV-ABEND-OPERATION           PIC  X(50) VALUE SPACES.    00059400
007700     05  PV-ABEND-TABLE               PIC  X(12) VALUE SPACES.    00059500
007900     05  PV-DB2-OPERATION-MESSAGE-1   PIC  X(79) VALUE SPACES.    00059600
008000     05  PV-DB2-OPERATION-MESSAGE-2   PIC  X(79) VALUE SPACES.    00059700
008100     05  PV-DB2-OPERATION-MESSAGE-3   PIC  X(79) VALUE SPACES.    00059800
008200                                                                  00059900
009206     COPY CERD024.                                                00060000
009300                                                                  00061000
009500     COPY CERD025.                                                00062000
009600                                                                  00063000
010800***************************************************************** 00064000
010900 PROCEDURE DIVISION.                                              00065000
011000***************************************************************** 00066000
011100     DISPLAY '**** BEGINNING CEKUT054 ****'.                      00067000
011200     DISPLAY ' '.                                                 00068000
011300                                                                  00069000
011400     OPEN INPUT  CARTON-DUP-FILE                                  00069100
011401                 CARTON-ITEM-FILE                                 00069200
011410          OUTPUT DUP-ERROR-FILE                                   00069300
011410                 EXTRACT-FILE.                                    00069400
011500                                                                  00069500
011600     PERFORM 1000-READ-CARTON-INPUT.                              00069600
011610     PERFORM 1100-READ-CARTON-ITEMS.                              00069700
011700                                                                  00069800
012100     PERFORM 2000-PROCESS-INPUT-FILE                              00069900
012200       UNTIL PS-EOF-INPUT1-YES AND                                00070000
012210             PS-EOF-INPUT2-YES.                                   00071000
012300                                                                  00072000
012310     CLOSE CARTON-DUP-FILE                                        00073000
012320           CARTON-ITEM-FILE                                       00074000
012330           DUP-ERROR-FILE                                         00075000
012330           EXTRACT-FILE.                                          00076000
012500                                                                  00077000
012600     DISPLAY ' INPUT CARTON RECS      = ' PV-RECORDS-READ-1.      00078000
012610     DISPLAY ' INPUT CARTON ITEM RECS = ' PV-RECORDS-READ-2.      00079000
012700     DISPLAY ' DUP RECORDS WRITTEN    = ' PV-RECORDS-BAD-WRITTEN. 00080000
012700     DISPLAY ' GOOD RECORDS WRITTEN   = ' PV-RECORDS-GOOD-WRITTEN.00081000
012800     DISPLAY ' '.                                                 00082000
012900     DISPLAY '****  END OF  CEKUT054  ****'.                      00083000
013000                                                                  00084000
013100     GOBACK.                                                      00085000
013200                                                                  00086000
013300                                                                  00087000
013400***************************************************************** 00088000
013500*  READ A CARTON RECORD                                           00089000
013600***************************************************************** 00089100
013700 1000-READ-CARTON-INPUT.                                          00089200
013800                                                                  00089300
013900     MOVE '1000-READ-CARTON-INPUT  ' TO PV-ABEND-PARAGRAPH.       00089400
014000                                                                  00089500
014010     INITIALIZE CE024-CONTAINER-UPLOAD-RECORD.                    00089600
014020                                                                  00089700
014100     READ CARTON-DUP-FILE                                         00089800
014200          INTO CE024-CONTAINER-UPLOAD-RECORD                      00089900
014300            AT END                                                00090000
014400               SET PS-EOF-INPUT1-YES TO TRUE                      00091000
014900     END-READ.                                                    00092000
015000                                                                  00093000
015010     IF PS-EOF-INPUT1-YES                                         00094000
015020        CONTINUE                                                  00095000
015030     ELSE                                                         00096000
015040        ADD +1 TO PV-RECORDS-READ-1                               00097000
015050     END-IF.                                                      00098000
015100                                                                  00099000
015101***************************************************************** 00099100
015102*  READ CARTON ITEMS                                              00099200
015103***************************************************************** 00099300
015104 1100-READ-CARTON-ITEMS.                                          00099400
015105                                                                  00099500
015106     MOVE '1100-READ-CARTON-ITEMS  ' TO PV-ABEND-PARAGRAPH.       00099600
015107                                                                  00099700
015108     INITIALIZE CE025-BOL-CONTAINER-ITEM-REC.                     00099800
015109                                                                  00099900
015110     READ CARTON-ITEM-FILE                                        00100000
015111          INTO CE025-BOL-CONTAINER-ITEM-REC                       00101000
015112            AT END                                                00102000
015113               SET PS-EOF-INPUT2-YES TO TRUE                      00103000
015114     END-READ.                                                    00104000
015115                                                                  00105000
015116     IF PS-EOF-INPUT2-YES                                         00106000
015117        CONTINUE                                                  00107000
015118     ELSE                                                         00108000
015119        ADD +1 TO PV-RECORDS-READ-2                               00109000
015120     END-IF.                                                      00109100
015130                                                                  00109200
015200***************************************************************** 00109300
015300*                                                               * 00109400
015400***************************************************************** 00109500
015500 2000-PROCESS-INPUT-FILE.                                         00109600
015700     MOVE '2000-PROCESS-INPUT-FILE ' TO PV-ABEND-PARAGRAPH.       00109700
015600                                                                  00109800
015010     IF PS-EOF-INPUT1-YES                                         00109900
015116       AND PS-EOF-INPUT2-NO                                       00110000
016102         PERFORM 3100-WRITE-GOOD-RECORDS                          00111000
016110         PERFORM 1100-READ-CARTON-ITEMS                           00112000
015800     END-IF.                                                      00113000
015800                                                                  00114000
015116     IF PS-EOF-INPUT2-YES                                         00115000
015116       AND PS-EOF-INPUT1-NO                                       00116000
      *        END OF ITEMS - CAN END                                   00117000
               SET PS-EOF-INPUT1-YES TO TRUE                            00118000
015800     END-IF.                                                      00119000
015800                                                                  00119100
015010     IF PS-EOF-INPUT1-NO                                          00119200
015116       AND PS-EOF-INPUT2-NO                                       00119300
015500        PERFORM 2001-PROCESS-INPUT-FILE                           00119400
015800     END-IF.                                                      00119500
015800                                                                  00119600
015400***************************************************************** 00119700
016200                                                                  00119800
015400***************************************************************** 00119900
015500 2001-PROCESS-INPUT-FILE.                                         00120000
015700     MOVE '2001-PROCESS-INPUT-FILE ' TO PV-ABEND-PARAGRAPH.       00121000
015600                                                                  00122000
      *    CONTAINER ON ITEM < CONTAINER DUP FILE                       00123000
015900     IF CE025-CONTAINER-ID < CE024-CONTAINER-ID                   00124000
027600         PERFORM 3100-WRITE-GOOD-RECORDS                          00125000
016020         PERFORM 1100-READ-CARTON-ITEMS                           00126000
016030     ELSE                                                         00127000
015900         IF CE025-CONTAINER-ID > CE024-CONTAINER-ID               00128000
013700             PERFORM 1000-READ-CARTON-INPUT                       00129000
016091         ELSE                                                     00130000
      *            CONTAINERS ARE EQUAL                                 00131000
021900             PERFORM 2100-WRITE-DUP-ERROR                         00132000
016020             PERFORM 1100-READ-CARTON-ITEMS                       00133000
               END-IF                                                   00134000
016140     END-IF.                                                      00135000
016200                                                                  00136000
021600***************************************************************** 00137000
021700*                                                                 00138000
021800***************************************************************** 00139000
021900 2100-WRITE-DUP-ERROR.                                            00140000
022000                                                                  00141000
022010     WRITE DUP-RECORD FROM                                        00142000
022020         CE025-BOL-CONTAINER-ITEM-REC                             00143000
022030     END-WRITE.                                                   00144000
024400     ADD +1                 TO PV-RECORDS-BAD-WRITTEN.            00145000
                                                                        00146000
      *    SET SWITCH FOR E-MAIL NOTIFICATION OF ERRORS.                00147000
027200                                                                  00148000
027300***************************************************************** 00149000
027400*                                                                 00150000
027500***************************************************************** 00151000
027600 3100-WRITE-GOOD-RECORDS.                                         00152000
027700                                                                  00153000
027800     WRITE EXTRACT-RECORD FROM                                    00154000
027900         CE025-BOL-CONTAINER-ITEM-REC                             00155000
028000     END-WRITE.                                                   00156000
028100     ADD +1                 TO PV-RECORDS-GOOD-WRITTEN.           00157000
028200                                                                  00158000
