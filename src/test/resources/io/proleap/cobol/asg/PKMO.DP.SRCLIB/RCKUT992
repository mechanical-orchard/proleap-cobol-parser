000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300 PROGRAM-ID.             RCKUT992.                                00030000
000400 AUTHOR.                 RON KRIER.                               00040000
000500 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00050000
000600 DATE-WRITTEN.           FEBRUARY, 2017.                          00060000
000700 DATE-COMPILED.                                                   00070000
000800***************************************************************** 00080000
000900*  THIS PROGRAM WILL PULL IN A FILE FROM INVENTORY CONTROL      * 00090000
001000*  OF DATA THAT THEY WANT VERIFIED RECEIVERS CREATED FOR.       * 00100000
001100*  THIS PROGRAM WILL TAKE IN THE INPUT, GET SOME ADDITIONAL     * 00110000
001200*  INFO AND THEN WRITE OUT TO ONE OF NINE OUTPUT FILES BASED    * 00120000
001300*  ON THE DC NUMBER.  COPYBOOK FOR THE OUTPUT IS RCRD097.       * 00130000
001400*  THE OUTPUT FILES WOULD BE RUN 1 BY 1 THRU PROGRAM RCKUP992   * 00140000
001500*  TO CREATE THE NECESSARY RECEIVERS.                           * 00150000
001600***************************************************************** 00160000
007100 ENVIRONMENT DIVISION.                                            00710000
007200 CONFIGURATION SECTION.                                           00720000
007300                                                                  00730000
007400 SOURCE-COMPUTER.        IBM-3090.                                00740000
007500 OBJECT-COMPUTER.        IBM-3090.                                00750000
007600                                                                  00760000
007700***************************************************************** 00770000
007800 INPUT-OUTPUT SECTION.                                            00780000
007900                                                                  00790000
008000 FILE-CONTROL.                                                    00800000
008100                                                                  00810000
008200     SELECT INPUT-FILE                                            00820000
008300         ASSIGN TO INP01.                                         00830000
008400                                                                  00840000
008500     SELECT OUT-FILE-DC810                                        00850000
008600         ASSIGN TO OUT01.                                         00860000
008700                                                                  00870000
008800     SELECT OUT-FILE-DC830                                        00880000
008900         ASSIGN TO OUT02.                                         00890000
009000                                                                  00900000
009100     SELECT OUT-FILE-DC840                                        00910000
009200         ASSIGN TO OUT03.                                         00920000
009300                                                                  00930000
009310     SELECT OUT-FILE-DC855                                        00931000
009320         ASSIGN TO OUT04.                                         00932000
009330                                                                  00933000
009340     SELECT OUT-FILE-DC860                                        00934000
009350         ASSIGN TO OUT05.                                         00935000
009360                                                                  00936000
009370     SELECT OUT-FILE-DC865                                        00937000
009380         ASSIGN TO OUT06.                                         00938000
009390                                                                  00939000
009391     SELECT OUT-FILE-DC875                                        00939100
009392         ASSIGN TO OUT07.                                         00939200
009393                                                                  00939300
009394     SELECT OUT-FILE-DC885                                        00939400
009395         ASSIGN TO OUT08.                                         00939500
009396                                                                  00939600
009397     SELECT OUT-FILE-DC890                                        00939700
009398         ASSIGN TO OUT09.                                         00939800
009399                                                                  00939908
009400     SELECT OUT-FILE-EFC806                                       00940008
009401         ASSIGN TO OUT10.                                         00940108
009402                                                                  00940208
009403     SELECT OUT-FILE-EFC816                                       00940308
009404         ASSIGN TO OUT11.                                         00940408
009405                                                                  00940508
009406     SELECT OUT-FILE-EFC826                                       00940608
009407         ASSIGN TO OUT12.                                         00940708
009408                                                                  00940808
009409     SELECT OUT-FILE-EFC836                                       00940908
009410         ASSIGN TO OUT13.                                         00941008
009411                                                                  00941108
009412     SELECT OUT-FILE-EFC870                                       00941208
009413         ASSIGN TO OUT14.                                         00941308
009414                                                                  00941408
009415     SELECT OUT-FILE-LFC858                                       00941508
009416         ASSIGN TO OUT15.                                         00941609
009417                                                                  00941708
009418     SELECT OUT-FILE-LFC868                                       00941808
009419         ASSIGN TO OUT16.                                         00941909
009420                                                                  00942008
009421     SELECT OUT-FILE-LFC878                                       00942108
009422         ASSIGN TO OUT17.                                         00942209
009423                                                                  00942308
009424     SELECT OUT-FILE-LFC888                                       00942408
009425         ASSIGN TO OUT18.                                         00942509
009426                                                                  00942610
009427     SELECT OUT-FILE-DC895                                        00942710
009428         ASSIGN TO OUT19.                                         00942810
009429                                                                  00942912
009430     SELECT OUT-FILE-EFC813                                       00943012
009431         ASSIGN TO OUT20.                                         00943112
009432                                                                  00943212
009440***************************************************************** 00944012
009500 DATA DIVISION.                                                   00950000
009600***************************************************************** 00960000
009700 FILE SECTION.                                                    00970000
009800                                                                  00980000
009900 FD  INPUT-FILE                                                   00990000
010000     RECORDING MODE IS F                                          01000000
010100     BLOCK CONTAINS 0  RECORDS.                                   01010000
010200 01  INPUT-RECORD                    PIC X(80).                   01020005
010300                                                                  01030000
010400 FD  OUT-FILE-DC810                                               01040000
010500     RECORDING MODE IS F                                          01050000
010600     BLOCK CONTAINS 0  RECORDS.                                   01060000
010700 01  OUT-FILE-DC810-RECORD           PIC X(150).                  01070000
010800                                                                  01080000
010900 FD  OUT-FILE-DC830                                               01090000
011000     RECORDING MODE IS F                                          01100000
011100     BLOCK CONTAINS 0  RECORDS.                                   01110000
011200 01  OUT-FILE-DC830-RECORD           PIC X(150).                  01120000
011300                                                                  01130000
011400 FD  OUT-FILE-DC840                                               01140000
011500     RECORDING MODE IS F                                          01150000
011600     BLOCK CONTAINS 0  RECORDS.                                   01160000
011700 01  OUT-FILE-DC840-RECORD           PIC X(150).                  01170000
011800                                                                  01180000
011810 FD  OUT-FILE-DC855                                               01181000
011820     RECORDING MODE IS F                                          01182000
011830     BLOCK CONTAINS 0  RECORDS.                                   01183000
011840 01  OUT-FILE-DC855-RECORD           PIC X(150).                  01184000
011850                                                                  01185000
011860 FD  OUT-FILE-DC860                                               01186000
011870     RECORDING MODE IS F                                          01187000
011880     BLOCK CONTAINS 0  RECORDS.                                   01188000
011890 01  OUT-FILE-DC860-RECORD           PIC X(150).                  01189000
011891                                                                  01189100
011892 FD  OUT-FILE-DC865                                               01189200
011893     RECORDING MODE IS F                                          01189300
011894     BLOCK CONTAINS 0  RECORDS.                                   01189400
011895 01  OUT-FILE-DC865-RECORD           PIC X(150).                  01189500
011896                                                                  01189600
011897 FD  OUT-FILE-DC875                                               01189700
011898     RECORDING MODE IS F                                          01189800
011899     BLOCK CONTAINS 0  RECORDS.                                   01189900
011900 01  OUT-FILE-DC875-RECORD           PIC X(150).                  01190000
011901                                                                  01190100
011902 FD  OUT-FILE-DC885                                               01190200
011903     RECORDING MODE IS F                                          01190300
011904     BLOCK CONTAINS 0  RECORDS.                                   01190400
011905 01  OUT-FILE-DC885-RECORD           PIC X(150).                  01190500
011906                                                                  01190600
011907 FD  OUT-FILE-DC890                                               01190700
011908     RECORDING MODE IS F                                          01190800
011909     BLOCK CONTAINS 0  RECORDS.                                   01190900
011910 01  OUT-FILE-DC890-RECORD           PIC X(150).                  01191000
011911                                                                  01191108
011912 FD  OUT-FILE-EFC806                                              01191208
011913     RECORDING MODE IS F                                          01191308
011914     BLOCK CONTAINS 0  RECORDS.                                   01191408
011915 01  OUT-FILE-EFC806-RECORD          PIC X(150).                  01191508
011916                                                                  01191608
011917 FD  OUT-FILE-EFC816                                              01191708
011918     RECORDING MODE IS F                                          01191808
011919     BLOCK CONTAINS 0  RECORDS.                                   01191908
011920 01  OUT-FILE-EFC816-RECORD          PIC X(150).                  01192008
011921                                                                  01192108
011922 FD  OUT-FILE-EFC826                                              01192208
011923     RECORDING MODE IS F                                          01192308
011924     BLOCK CONTAINS 0  RECORDS.                                   01192408
011925 01  OUT-FILE-EFC826-RECORD          PIC X(150).                  01192508
011926                                                                  01192608
011927 FD  OUT-FILE-EFC836                                              01192708
011928     RECORDING MODE IS F                                          01192808
011929     BLOCK CONTAINS 0  RECORDS.                                   01192908
011930 01  OUT-FILE-EFC836-RECORD          PIC X(150).                  01193008
011931                                                                  01193108
011932 FD  OUT-FILE-EFC870                                              01193208
011933     RECORDING MODE IS F                                          01193308
011934     BLOCK CONTAINS 0  RECORDS.                                   01193408
011935 01  OUT-FILE-EFC870-RECORD          PIC X(150).                  01193508
011936                                                                  01193608
011937 FD  OUT-FILE-LFC858                                              01193708
011938     RECORDING MODE IS F                                          01193808
011939     BLOCK CONTAINS 0  RECORDS.                                   01193908
011940 01  OUT-FILE-LFC858-RECORD          PIC X(150).                  01194008
011941                                                                  01194108
011942 FD  OUT-FILE-LFC868                                              01194208
011943     RECORDING MODE IS F                                          01194308
011944     BLOCK CONTAINS 0  RECORDS.                                   01194408
011945 01  OUT-FILE-LFC868-RECORD          PIC X(150).                  01194508
011946                                                                  01194608
011947 FD  OUT-FILE-LFC878                                              01194708
011948     RECORDING MODE IS F                                          01194808
011949     BLOCK CONTAINS 0  RECORDS.                                   01194908
011950 01  OUT-FILE-LFC878-RECORD          PIC X(150).                  01195008
011951                                                                  01195108
011952 FD  OUT-FILE-LFC888                                              01195208
011953     RECORDING MODE IS F                                          01195308
011954     BLOCK CONTAINS 0  RECORDS.                                   01195408
011955 01  OUT-FILE-LFC888-RECORD          PIC X(150).                  01195508
011956                                                                  01195610
011957 FD  OUT-FILE-DC895                                               01195710
011958     RECORDING MODE IS F                                          01195810
011959     BLOCK CONTAINS 0  RECORDS.                                   01195910
011960 01  OUT-FILE-DC895-RECORD          PIC X(150).                   01196010
011961                                                                  01196112
011962 FD  OUT-FILE-EFC813                                              01196212
011963     RECORDING MODE IS F                                          01196312
011964     BLOCK CONTAINS 0  RECORDS.                                   01196412
011965 01  OUT-FILE-EFC813-RECORD         PIC X(150).                   01196512
011966                                                                  01196612
011970***************************************************************** 01197010
012000 WORKING-STORAGE SECTION.                                         01200000
012100                                                                  01210000
012200 01  PROGRAM-SWITCHES.                                            01220000
012300     05  PS-EOF-INPUT-SW              PIC X(01) VALUE 'N'.        01230000
012400         88  PS-EOF-INPUT                       VALUE 'Y'.        01240000
012500         88  PS-NOT-EOF-INPUT                   VALUE 'N'.        01250000
012600     05  PS-VALID-PO-SW               PIC X(01) VALUE 'N'.        01260002
012700         88  PS-VALID-PO                        VALUE 'Y'.        01270002
012800         88  PS-NOT-VALID-PO                    VALUE 'N'.        01280002
012810     05  PS-VALID-PO-LINE-SW          PIC X(01) VALUE 'N'.        01281002
012820         88  PS-VALID-PO-LINE                   VALUE 'Y'.        01282002
012830         88  PS-NOT-VALID-PO-LINE               VALUE 'N'.        01283002
012900     05  PS-VALID-SKU-SW              PIC X(01) VALUE 'N'.        01290000
013000         88  PS-VALID-SKU                       VALUE 'Y'.        01300000
013100         88  PS-NOT-VALID-SKU                   VALUE 'N'.        01310000
013110     05  PS-VALID-STORE-SW            PIC X(01) VALUE 'N'.        01311012
013120         88  PS-VALID-STORE                     VALUE 'Y'.        01312012
013130         88  PS-NOT-VALID-STORE                 VALUE 'N'.        01313012
013200     05  PS-LOCATION-DS-SW            PIC X(01) VALUE 'N'.        01320000
013300         88  PS-LOCATION-DS                     VALUE 'Y'.        01330000
013400         88  PS-LOCATION-DS-NO                  VALUE 'N'.        01340000
013500     05  PS-IT-EXISTS-SW              PIC X(01) VALUE 'N'.        01350000
013600         88  PS-IT-EXISTS                       VALUE 'Y'.        01360000
013700         88  PS-IT-EXISTS-NO                    VALUE 'N'.        01370000
013800     05  PS-CLEAN-EXISTS-SW           PIC X(01) VALUE 'N'.        01380000
013900         88  PS-CLEAN-EXISTS                    VALUE 'Y'.        01390000
014000         88  PS-CLEAN-EXISTS-NO                 VALUE 'N'.        01400000
014100     05  PS-END-OF-PO-CSR-SW          PIC X(01) VALUE 'N'.        01410000
014200         88  PS-END-OF-PO-CSR                   VALUE 'Y'.        01420000
014300                                                                  01430000
014400 01  PC-PROGRAM-CONSTANTS.                                        01440000
014500     05  PC-RCKUT992                 PIC X(08) VALUE              01450000
014600                                               'RCKUT992'.        01460000
014700     05  PC-DEFAULT-TMST             PIC X(26)  VALUE             01470000
014800                                    '9999-09-09-09.09.09.999999'. 01480000
014900     05  PC-SLASH                    PIC X(01) VALUE '/'.         01490000
015000     05  PC-DASH                     PIC X(01) VALUE '-'.         01500000
015100                                                                  01510000
015200                                                                  01520000
015300 01  PV-PROGRAM-VARIABLES.                                        01530000
015400                                                                  01540000
015500     05  PV-INBD-CART-CNT             PIC S9(09) COMP VALUE ZERO. 01550000
015600     05  PV-OTBD-CART-CNT             PIC S9(09) COMP VALUE ZERO. 01560000
015700     05  PV-INBD-SHPD-QTY             PIC S9(09) COMP VALUE ZERO. 01570000
015800     05  PV-OTBD-SHPD-QTY             PIC S9(09) COMP VALUE ZERO. 01580000
015900     05  PV-NO-CHECKIN-CNT            PIC S9(09) COMP VALUE ZERO. 01590000
016000     05  PV-NO-CHECKIN-QTY            PIC S9(09) COMP VALUE ZERO. 01600000
016100                                                                  01610000
016203     05  PV-READ-COUNT                PIC 9(09)  VALUE ZERO.      01620300
016204     05  PV-READ-COUNT-2              PIC 9(09)  VALUE ZERO.      01620404
016205     05  PV-WRITE-810-COUNT           PIC 9(09)  VALUE ZERO.      01620500
016206     05  PV-WRITE-830-COUNT           PIC 9(09)  VALUE ZERO.      01620600
016207     05  PV-WRITE-840-COUNT           PIC 9(09)  VALUE ZERO.      01620700
016208     05  PV-WRITE-855-COUNT           PIC 9(09)  VALUE ZERO.      01620800
016209     05  PV-WRITE-860-COUNT           PIC 9(09)  VALUE ZERO.      01620900
016210     05  PV-WRITE-865-COUNT           PIC 9(09)  VALUE ZERO.      01621000
016211     05  PV-WRITE-875-COUNT           PIC 9(09)  VALUE ZERO.      01621100
016212     05  PV-WRITE-885-COUNT           PIC 9(09)  VALUE ZERO.      01621200
016213     05  PV-WRITE-890-COUNT           PIC 9(09)  VALUE ZERO.      01621300
016214     05  PV-WRITE-806-COUNT           PIC 9(09)  VALUE ZERO.      01621408
016215     05  PV-WRITE-816-COUNT           PIC 9(09)  VALUE ZERO.      01621508
016216     05  PV-WRITE-826-COUNT           PIC 9(09)  VALUE ZERO.      01621608
016217     05  PV-WRITE-836-COUNT           PIC 9(09)  VALUE ZERO.      01621708
016218     05  PV-WRITE-870-COUNT           PIC 9(09)  VALUE ZERO.      01621808
016219     05  PV-WRITE-858-COUNT           PIC 9(09)  VALUE ZERO.      01621908
016220     05  PV-WRITE-868-COUNT           PIC 9(09)  VALUE ZERO.      01622008
016221     05  PV-WRITE-878-COUNT           PIC 9(09)  VALUE ZERO.      01622108
016222     05  PV-WRITE-888-COUNT           PIC 9(09)  VALUE ZERO.      01622208
016223     05  PV-WRITE-895-COUNT           PIC 9(09)  VALUE ZERO.      01622310
016224     05  PV-WRITE-813-COUNT           PIC 9(09)  VALUE ZERO.      01622412
016225     05  PV-WRITE-COUNT-INTRANSIT     PIC 9(09)  VALUE ZERO.      01622512
016226     05  PV-WRITE-COUNT-ADJUST        PIC 9(09)  VALUE ZERO.      01622612
016227     05  PV-NOT-DS-LOCATION-CNT       PIC 9(09)  VALUE ZERO.      01622712
016228     05  PV-INTRANSIT-EXISTS-CNT      PIC 9(09)  VALUE ZERO.      01622812
016229     05  PV-INVALID-PO-COUNT          PIC 9(09)  VALUE ZERO.      01622912
016230     05  PV-INVALID-PO-LINE-COUNT     PIC 9(09)  VALUE ZERO.      01623012
016231     05  PV-INVALID-DC-COUNT          PIC 9(09)  VALUE ZERO.      01623112
016232     05  PV-INVALID-STORE-COUNT       PIC 9(09)  VALUE ZERO.      01623212
016233                                                                  01623312
016234     05  PV-SQLCODE                  PIC 9(09) VALUE ZERO.        01623412
016235     05  PV-DISP-SQLCODE             PIC -999.                    01623512
016240     05  PV-NULL-IND                    PIC S9(04)  VALUE ZEROS   01624000
016250                                                    COMP SYNC.    01625000
016260     05  PV-NULL-IND-1                  PIC S9(04)  VALUE ZEROS   01626000
016270                                                    COMP SYNC.    01627000
016280                                                                  01628000
016290 01  PV-ABEND-FIELDS.                                             01629000
016300     05  PV-ABEND-CODE               PIC S9(4) VALUE +0           01630000
016400                                               COMP SYNC.         01640000
016500     05  PV-ABEND-PROGRAM            PIC X(08) VALUE 'RCKUT992'.  01650000
016600     05  PV-ABEND-PARAGRAPH          PIC X(50) VALUE SPACES.      01660000
016700     05  PV-ABEND-OPERATION          PIC X(50) VALUE SPACES.      01670000
016800     05  PV-ABEND-STRUCTURE-1        PIC X(08) VALUE SPACES.      01680000
016900     05  PV-DB2-OPERATION-MESSAGE-1  PIC X(79) VALUE SPACES.      01690000
017000     05  PV-DB2-OPERATION-MESSAGE-2  PIC X(79) VALUE SPACES.      01700000
017100     05  PV-DB2-OPERATION-MESSAGE-3  PIC X(79) VALUE SPACES.      01710000
017200     05  PV-DB2-OPERATION-MESSAGE-4  PIC X(79) VALUE SPACES.      01720000
017300     05  PV-DB2-TABLE-NAME-1         PIC X(08) VALUE SPACES.      01730000
017400     05  PV-DB2-TABLE-NAME-2         PIC X(08) VALUE SPACES.      01740000
017500                                                                  01750000
017600     05  PV-DISPLAY-OPER             PIC  9(04) VALUE ZEROES.     01760000
017700     05  PV-DISPLAY-SQLCODE          PIC  9(03)- VALUE ZEROES.    01770000
017800     05  PV-DB2-TABLE-NAME1          PIC  X(15) VALUE SPACES.     01780000
017900                                                                  01790000
018000     05  PV-DISPLAY-FETCH-COUNT1     PIC ZZZ,ZZZ,ZZ9.             01800000
018100     05  PV-DISPLAY-FETCH-COUNT2     PIC ZZZ,ZZZ,ZZ9.             01810000
018200     05  PV-DISPLAY-READ-COUNT1      PIC ZZZ,ZZZ,ZZ9.             01820000
018300     05  PV-DISPLAY-READ-COUNT2      PIC ZZZ,ZZZ,ZZ9.             01830000
018400     05  PV-DISPLAY-WRITE-COUNT      PIC ZZZ,ZZZ,ZZ9.             01840000
018500     05  PV-DISPLAY-PERCENT1         PIC ZZZ.99.                  01850000
018600     05  PV-DISPLAY-PERCENT2         PIC ZZZ.                     01860000
018700     05  PV-DISP-PO                  PIC Z(09).                   01870000
018800     05  PV-DISP-RCVR                PIC 9999.                    01880000
018900     05  PV-DISP-LOC-NBR             PIC 9999.                    01890000
019000     05  PV-DISP-LINE                PIC 9999.                    01900000
019100     05  PV-DISP-SKU                 PIC 9(08).                   01910000
019200     05  PV-DISP-INTR-UPC            PIC Z(15).                   01920000
019300                                                                  01930000
019400     05  PV-DEPT-NBR                 PIC X(04).                   01940000
019500     05  PV-DEPT-NM                  PIC X(20).                   01950000
019600     05  PV-SKU-DESC                 PIC X(30).                   01960000
019700                                                                  01970000
019800     05  PV-PREV-PO-NBR              PIC 9(08)      VALUE ZEROS.  01980002
019810     05  PV-PREV-PO-LNE-NBR          PIC S9(4) COMP VALUE ZEROES. 01981004
019820     05  PV-PREV-STORE-NBR           PIC 9(04)      VALUE ZEROS.  01982012
019900     05  PV-SHIPPED-TMST             PIC X(26).                   01990000
020000     05  PV-UNLOADED-TMST            PIC X(26).                   02000000
020100     05  PV-FROM-TMST.                                            02010000
020200         10  PV-FROM-TMST-DATE       PIC X(10).                   02020000
020300         10  PV-FROM-FILLER1         PIC X(01)   VALUE '-'.       02030000
020400         10  PV-FROM-TMST-TIME       PIC X(08).                   02040000
020500         10  PV-FROM-FILLER2         PIC X(07)   VALUE '.000000'. 02050000
020600     05  PV-TO-TMST.                                              02060000
020700         10  PV-TO-TMST-DATE         PIC X(10).                   02070000
020800         10  PV-TO-FILLER1           PIC X(01)   VALUE '-'.       02080000
020900         10  PV-TO-TMST-TIME         PIC X(08).                   02090000
021000         10  PV-TO-FILLER2           PIC X(07)   VALUE '.000000'. 02100000
021200                                                                  02120000
021300 01  IR-INPUT-RECORD.                                             02130000
021400     05  IR-PO-NBR                   PIC  9(8)      VALUE ZEROES. 02140000
021500     05  FILLER                      PIC  X(1)      VALUE SPACES. 02150000
021501     05  IR-PO-LINE-NBR              PIC  9(3)      VALUE ZEROES. 02150101
021502     05  FILLER                      PIC  X(1)      VALUE SPACES. 02150201
021510     05  IR-SKU-NBR                  PIC  9(8)      VALUE ZEROES. 02151000
021520     05  FILLER                      PIC  X(1)      VALUE SPACES. 02152000
021600     05  IR-STORE-NBR                PIC  9(4)      VALUE ZEROES. 02160000
021601     05  FILLER                      PIC  X(1)      VALUE SPACES. 02160101
021602     05  IR-QTY                      PIC  9(4)      VALUE ZEROS.  02160201
021610     05  FILLER                      PIC  X(1)      VALUE SPACES. 02161000
021620     05  IR-DC-NBR                   PIC  9(3)      VALUE ZEROES. 02162001
021700     05  FILLER                      PIC  X(45)     VALUE SPACES. 02170001
022600                                                                  02260000
027400                                                                  02740000
027500 01  DK-DB-KEYS.                                                  02750000
027700     05  DK-PO-NBR                   PIC S9(9) COMP VALUE ZEROES. 02770000
027710     05  DK-PO-LINE-NBR              PIC S9(9) COMP VALUE ZEROES. 02771001
027800     05  DK-SKU-NBR                  PIC S9(8)V COMP-3.           02780001
027900     05  DK-LOC-NBR                  PIC S9(4) COMP.              02790012
028400                                                                  02840000
028500******************************************************************02850000
028600* OUTPUT RECEIPT RECORD LAYOUT                                    02860000
028700******************************************************************02870000
028800     COPY RCRD097.                                                02880000
028900                                                                  02890000
029500******************************************************************02950000
029600*  USED FOR DB2 ERROR MESSAGE BUILDING                            02960000
029700******************************************************************02970000
029800     COPY DPWS004.                                                02980000
029900                                                                  02990000
030000******************************************************************03000000
030100*   DB2 SQL COMMUNICATION AREA                                    03010000
030200******************************************************************03020000
030300     EXEC SQL                                                     03030000
030400          INCLUDE SQLCA                                           03040000
030500     END-EXEC.                                                    03050000
030600                                                                  03060000
030700*---------------------------------------------------------------* 03070000
030800*  TPURCHS                                                        03080000
030900*---------------------------------------------------------------* 03090000
031000     EXEC SQL                                                     03100000
031100         INCLUDE TPURCHS                                          03110000
031200     END-EXEC.                                                    03120000
031300                                                                  03130000
031400*---------------------------------------------------------------* 03140000
031500*  TPURITM                                                        03150000
031600*---------------------------------------------------------------* 03160000
031700     EXEC SQL                                                     03170000
031800         INCLUDE TPURITM                                          03180000
031900     END-EXEC.                                                    03190000
032000                                                                  03200000
032100*---------------------------------------------------------------* 03210012
032200*  XLT_LOC                                                        03220012
032300*---------------------------------------------------------------* 03230012
032400     EXEC SQL                                                     03240012
032500         INCLUDE XLT00010                                         03250012
032600     END-EXEC.                                                    03260012
032700                                                                  03270012
045000                                                                  04500000
045200******************************************************************04520000
045300 PROCEDURE DIVISION.                                              04530000
045400     DISPLAY '**** START OF RCKUT992 ****'.                       04540000
045500                                                                  04550000
045600*OPEN FILES.                                                      04560000
045700     OPEN INPUT  INPUT-FILE.                                      04570000
045800     OPEN OUTPUT OUT-FILE-DC810.                                  04580000
045900     OPEN OUTPUT OUT-FILE-DC830.                                  04590000
046000     OPEN OUTPUT OUT-FILE-DC840.                                  04600000
046010     OPEN OUTPUT OUT-FILE-DC855.                                  04601000
046020     OPEN OUTPUT OUT-FILE-DC860.                                  04602000
046030     OPEN OUTPUT OUT-FILE-DC865.                                  04603000
046040     OPEN OUTPUT OUT-FILE-DC875.                                  04604000
046050     OPEN OUTPUT OUT-FILE-DC885.                                  04605000
046060     OPEN OUTPUT OUT-FILE-DC890.                                  04606000
046070     OPEN OUTPUT OUT-FILE-EFC806.                                 04607008
046080     OPEN OUTPUT OUT-FILE-EFC816.                                 04608008
046090     OPEN OUTPUT OUT-FILE-EFC826.                                 04609008
046091     OPEN OUTPUT OUT-FILE-EFC836.                                 04609108
046092     OPEN OUTPUT OUT-FILE-EFC870.                                 04609208
046093     OPEN OUTPUT OUT-FILE-LFC858.                                 04609308
046094     OPEN OUTPUT OUT-FILE-LFC868.                                 04609408
046095     OPEN OUTPUT OUT-FILE-LFC878.                                 04609508
046096     OPEN OUTPUT OUT-FILE-LFC888.                                 04609608
046097     OPEN OUTPUT OUT-FILE-DC895.                                  04609710
046098     OPEN OUTPUT OUT-FILE-EFC813.                                 04609812
046100                                                                  04610000
046600     SET   PS-NOT-EOF-INPUT       TO  TRUE.                       04660000
046700                                                                  04670000
046800     PERFORM 1000-INITIALIZATION.                                 04680000
046900                                                                  04690000
047000     PERFORM 2000-PROCESS-INPUT                                   04700000
047100       UNTIL PS-EOF-INPUT.                                        04710000
047200                                                                  04720000
047300                                                                  04730000
047400     DISPLAY '***'                                                04740000
047500     DISPLAY '*** INPUT COUNT           :  ' PV-READ-COUNT        04750000
047600     DISPLAY '*** '                                               04760000
047700     DISPLAY '*** OUTPUT FILE 810 COUNT  :  '                     04770001
047800             PV-WRITE-810-COUNT                                   04780001
047900     DISPLAY '*** '                                               04790001
048000     DISPLAY '*** OUTPUT FILE 830 COUNT  :  '                     04800001
048100             PV-WRITE-830-COUNT                                   04810001
048200     DISPLAY '*** '                                               04820001
048300     DISPLAY '*** OUTPUT FILE 840 COUNT  :  '                     04830001
048400             PV-WRITE-840-COUNT                                   04840001
048500     DISPLAY '*** '                                               04850001
048600     DISPLAY '*** OUTPUT FILE 855 COUNT  :  '                     04860001
048700             PV-WRITE-855-COUNT                                   04870001
048800     DISPLAY '*** '                                               04880001
048900     DISPLAY '*** OUTPUT FILE 860 COUNT  :  '                     04890001
049000             PV-WRITE-860-COUNT                                   04900001
049100     DISPLAY '*** '                                               04910001
049110     DISPLAY '*** OUTPUT FILE 865 COUNT  :  '                     04911001
049120             PV-WRITE-865-COUNT                                   04912001
049130     DISPLAY '*** '                                               04913001
049140     DISPLAY '*** OUTPUT FILE 875 COUNT  :  '                     04914001
049150             PV-WRITE-875-COUNT                                   04915001
049160     DISPLAY '*** '                                               04916001
049170     DISPLAY '*** OUTPUT FILE 885 COUNT  :  '                     04917001
049180             PV-WRITE-885-COUNT                                   04918001
049190     DISPLAY '*** '                                               04919001
049191     DISPLAY '*** OUTPUT FILE 890 COUNT  :  '                     04919101
049192             PV-WRITE-890-COUNT                                   04919201
049193     DISPLAY '*** '                                               04919308
049194     DISPLAY '*** OUTPUT FILE 806 COUNT  :  '                     04919408
049195             PV-WRITE-806-COUNT                                   04919508
049196     DISPLAY '*** '                                               04919608
049197     DISPLAY '*** OUTPUT FILE 816 COUNT  :  '                     04919708
049198             PV-WRITE-816-COUNT                                   04919808
049199     DISPLAY '*** '                                               04919908
049200     DISPLAY '*** OUTPUT FILE 826 COUNT  :  '                     04920008
049201             PV-WRITE-826-COUNT                                   04920108
049202     DISPLAY '*** '                                               04920208
049203     DISPLAY '*** OUTPUT FILE 836 COUNT  :  '                     04920308
049204             PV-WRITE-836-COUNT                                   04920408
049205     DISPLAY '*** '                                               04920508
049206     DISPLAY '*** OUTPUT FILE 870 COUNT  :  '                     04920608
049207             PV-WRITE-870-COUNT                                   04920708
049208     DISPLAY '*** '                                               04920808
049209     DISPLAY '*** OUTPUT FILE 858 COUNT  :  '                     04920908
049210             PV-WRITE-858-COUNT                                   04921008
049211     DISPLAY '*** '                                               04921108
049212     DISPLAY '*** OUTPUT FILE 868 COUNT  :  '                     04921208
049213             PV-WRITE-868-COUNT                                   04921308
049214     DISPLAY '*** '                                               04921408
049215     DISPLAY '*** OUTPUT FILE 878 COUNT  :  '                     04921508
049216             PV-WRITE-878-COUNT                                   04921608
049217     DISPLAY '*** '                                               04921708
049218     DISPLAY '*** OUTPUT FILE 888 COUNT  :  '                     04921808
049219             PV-WRITE-888-COUNT                                   04921908
049220     DISPLAY '*** '                                               04922010
049221     DISPLAY '*** OUTPUT FILE 895 COUNT  :  '                     04922110
049222             PV-WRITE-895-COUNT                                   04922210
049223     DISPLAY '*** '                                               04922312
049224     DISPLAY '*** OUTPUT FILE 813 COUNT  :  '                     04922412
049225             PV-WRITE-813-COUNT                                   04922512
049226     DISPLAY '*** '                                               04922612
049227     DISPLAY '*** INVALID PO COUNT       :  '                     04922712
049228             PV-INVALID-PO-COUNT                                  04922812
049229     DISPLAY '*** '                                               04922912
049230     DISPLAY '*** INVALID PO LINE COUNT  :  '                     04923012
049231             PV-INVALID-PO-LINE-COUNT                             04923112
049232     DISPLAY '*** '                                               04923212
049233     DISPLAY '*** INVALID STORE COUNT    :  '                     04923314
049234             PV-INVALID-STORE-COUNT                               04923414
049235     DISPLAY '*** '                                               04923514
049236     DISPLAY '*** INVALID DC NBR COUNT   :  '                     04923614
049237             PV-INVALID-DC-COUNT                                  04923714
049239     DISPLAY '*** '                                               04923914
049240                                                                  04924010
049300*CLOSE FILES.                                                     04930000
049400     CLOSE INPUT-FILE.                                            04940000
049420     CLOSE OUT-FILE-DC810.                                        04942001
049430     CLOSE OUT-FILE-DC830.                                        04943001
049440     CLOSE OUT-FILE-DC840.                                        04944001
049450     CLOSE OUT-FILE-DC855.                                        04945001
049460     CLOSE OUT-FILE-DC860.                                        04946001
049470     CLOSE OUT-FILE-DC865.                                        04947001
049480     CLOSE OUT-FILE-DC875.                                        04948001
049490     CLOSE OUT-FILE-DC885.                                        04949001
049491     CLOSE OUT-FILE-DC890.                                        04949101
049492     CLOSE OUT-FILE-EFC806.                                       04949208
049493     CLOSE OUT-FILE-EFC816.                                       04949308
049494     CLOSE OUT-FILE-EFC826.                                       04949408
049495     CLOSE OUT-FILE-EFC836.                                       04949508
049496     CLOSE OUT-FILE-EFC870.                                       04949608
049497     CLOSE OUT-FILE-LFC858.                                       04949708
049498     CLOSE OUT-FILE-LFC868.                                       04949808
049499     CLOSE OUT-FILE-LFC878.                                       04949908
049500     CLOSE OUT-FILE-LFC888.                                       04950008
049600     CLOSE OUT-FILE-DC895.                                        04960010
049700     CLOSE OUT-FILE-EFC813.                                       04970012
049710                                                                  04971020
049720     IF  PV-INVALID-PO-COUNT > 0                                  04972020
049730     OR  PV-INVALID-PO-LINE-COUNT > 0                             04973020
049740     OR  PV-INVALID-STORE-COUNT > 0                               04974020
049750     OR  PV-INVALID-DC-COUNT > 0                                  04975020
049760         MOVE 4008 TO RETURN-CODE                                 04976020
049770     END-IF.                                                      04977020
049800                                                                  04980000
049900     GOBACK.                                                      04990000
050000                                                                  05000000
050100******************************************************************05010000
050200*  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               *05020000
050300******************************************************************05030000
050400 1000-INITIALIZATION.                                             05040000
050500     DISPLAY '1000-INITIALIZE '.                                  05050000
050600                                                                  05060000
050700     EXEC SQL                                                     05070000
050800          SELECT                                                  05080000
050900                 CURRENT TIMESTAMP                                05090000
051000               , CURRENT TIMESTAMP + 1 MINUTE                     05100000
051100            INTO :PV-SHIPPED-TMST                                 05110000
051200               , :PV-UNLOADED-TMST                                05120000
051300            FROM SYSIBM.SYSDUMMY1                                 05130000
051400     END-EXEC.                                                    05140000
051500                                                                  05150000
051600     PERFORM 7000-READ-INPUT.                                     05160000
051700                                                                  05170000
051800                                                                  05180000
051900******************************************************************05190000
052000**  READ INPUT-FILE, VALIDATE IF DATA IS TO BE PROCESSED TO       05200000
052100**  OUPUT FILE AND IF SO, THEN PROCESS.  IF NOT, JUST READ        05210000
052200**  NEXT RECORD.                                                  05220000
052300******************************************************************05230000
052400 2000-PROCESS-INPUT.                                              05240000
052500                                                                  05250000
052600     DISPLAY 'INPUT RECORD BEING PROCESSED: '.                    05260000
052700     DISPLAY IR-INPUT-RECORD.                                     05270000
052800                                                                  05280000
052900     MOVE IR-PO-NBR               TO  DK-PO-NBR                   05290001
052910                                      RC097-PO-NBR.               05291001
053000     MOVE IR-PO-LINE-NBR          TO  DK-PO-LINE-NBR              05300001
053010                                      RC097-PO-LNE-NBR.           05301001
053100     MOVE IR-SKU-NBR              TO  DK-SKU-NBR                  05310001
053110                                      RC097-SKU-NBR.              05311001
053200     MOVE IR-STORE-NBR            TO  DK-LOC-NBR                  05320012
053210                                      RC097-STR-NBR.              05321012
053300     MOVE IR-QTY                  TO  RC097-AP-VERIFY-QTY         05330001
053310                                      RC097-MANIFEST-QTY          05331001
053320                                      RC097-TO-VERIFY-QTY.        05332001
053400     MOVE IR-DC-NBR               TO  RC097-OPER-UNIT.            05340001
053500     MOVE 'AP'                    TO  RC097-REC-TYP-CDE.          05350002
053600     MOVE 'TKMA236'               TO  RC097-CRE-UID.              05360002
053610     MOVE 'RPK'                   TO  RC097-RCVG-CLERK-INIT-ID.   05361002
053700                                                                  05370000
053800     IF  PV-PREV-PO-NBR = IR-PO-NBR                               05380002
053900         CONTINUE                                                 05390002
053910     ELSE                                                         05391002
053920         SET PS-NOT-VALID-PO TO TRUE                              05392002
054000         PERFORM 4000-GET-PO-INFO                                 05400002
054010         MOVE IR-PO-NBR TO PV-PREV-PO-NBR                         05401002
054020     END-IF.                                                      05402002
054100                                                                  05410000
054110     IF  PS-VALID-PO                                              05411002
054410         SET PS-NOT-VALID-PO-LINE TO TRUE                         05441006
054500         PERFORM 4500-GET-LINE-INFO                               05450006
054530     END-IF.                                                      05453002
054540                                                                  05454012
054541     IF  PV-PREV-STORE-NBR = IR-STORE-NBR                         05454112
054542         IF  PV-PREV-STORE-NBR = 0                                05454214
054543             SET PS-NOT-VALID-STORE TO TRUE                       05454314
054544             PERFORM 4600-CHECK-STORE-NBR                         05454412
054545             MOVE IR-STORE-NBR TO PV-PREV-STORE-NBR               05454512
054546         ELSE                                                     05454612
054547             CONTINUE                                             05454712
054548         END-IF                                                   05454812
054549     ELSE                                                         05454912
054550         SET PS-NOT-VALID-STORE TO TRUE                           05455014
054551         PERFORM 4600-CHECK-STORE-NBR                             05455112
054552         MOVE IR-STORE-NBR TO PV-PREV-STORE-NBR                   05455212
054560     END-IF.                                                      05456012
054600                                                                  05460000
054610     IF  PS-NOT-VALID-PO                                          05461002
054620         ADD +1 TO PV-INVALID-PO-COUNT                            05462004
054630     ELSE                                                         05463002
054640         IF  PS-NOT-VALID-PO-LINE                                 05464002
054650             ADD +1 TO PV-INVALID-PO-LINE-COUNT                   05465004
054660         ELSE                                                     05466002
054661             IF  PS-NOT-VALID-STORE                               05466112
054663                 ADD +1 TO PV-INVALID-STORE-COUNT                 05466312
054664                 DISPLAY 'INVALID STORE NUMBER: ' IR-STORE-NBR    05466418
054665                         ' FOR PO: ' IR-PO-NBR                    05466518
054666                         ' FOR LINE: ' IR-PO-LINE-NBR             05466618
054667             ELSE                                                 05466712
054670                 PERFORM 8000-WRITE-OUTPUT                        05467012
054671             END-IF                                               05467112
054680         END-IF                                                   05468002
054690     END-IF.                                                      05469002
054691                                                                  05469102
054700     PERFORM 7000-READ-INPUT.                                     05470000
054800                                                                  05480012
074100 4000-GET-PO-INFO.                                                07410001
074200                                                                  07420000
074300     MOVE '4000-GET-PO-INFO'                                      07430001
074400         TO PV-ABEND-PARAGRAPH.                                   07440000
074500     MOVE 'SELECT TPURCHS'                                        07450001
074600         TO PV-ABEND-OPERATION.                                   07460000
074700                                                                  07470000
074800     EXEC SQL                                                     07480000
074900          SELECT PKGNG_CDE                                        07490001
075000          INTO  :PURCHS-PKGNG-CDE                                 07500001
075100          FROM   TPURCHS                                          07510001
075200          WHERE  PO_NBR            = :DK-PO-NBR                   07520001
075300           AND   VER_STATUS_CDE    = 'A'                          07530001
075900          WITH UR                                                 07590000
076000     END-EXEC.                                                    07600000
076100                                                                  07610000
076200     EVALUATE TRUE                                                07620000
076300         WHEN SQLCODE = ZERO                                      07630000
076400         WHEN SQLCODE = -811                                      07640000
076410             SET PS-VALID-PO TO TRUE                              07641002
076500             MOVE PURCHS-PKGNG-CDE TO RC097-PKGNG-CDE             07650001
076600             IF RC097-PKGNG-CDE = 'M' OR 'I'                      07660007
076700                MOVE 'B' TO RC097-PKGNG-CDE                       07670007
076800             END-IF                                               07680007
076980         WHEN SQLCODE = +100                                      07698000
076990             DISPLAY 'INVALID PO NUMBER: ' IR-PO-NBR              07699001
076991             MOVE 'XX' TO RC097-PKGNG-CDE                         07699101
077000         WHEN SQLWARN0 NOT = SPACE                                07700000
077100         WHEN SQLCODE < ZERO                                      07710000
077200         WHEN SQLCODE > ZERO                                      07720000
077210             DISPLAY 'ABEND INFO - KEY DATA'                      07721000
077220             DISPLAY 'PO NUMBER IS:  '  IR-PO-NBR                 07722001
077400             MOVE  SQLCODE               TO PV-DISP-SQLCODE       07740000
077500             DISPLAY 'SQL CODE IS: ' PV-DISP-SQLCODE              07750000
077600             PERFORM 9900-DB2-ABEND                               07760000
077900     END-EVALUATE.                                                07790000
078000                                                                  07800000
078010 4500-GET-LINE-INFO.                                              07801001
078020                                                                  07802001
078030     MOVE '4500-GET-LINE-INFO'                                    07803001
078040         TO PV-ABEND-PARAGRAPH.                                   07804001
078050     MOVE 'SELECT TPURITM'                                        07805001
078060         TO PV-ABEND-OPERATION.                                   07806001
078070                                                                  07807001
078080     EXEC SQL                                                     07808001
078090          SELECT PO_LNE_NBR                                       07809002
078091          INTO  :PURITM-PO-LNE-NBR                                07809102
078092          FROM   TPURITM                                          07809202
078093          WHERE  PO_NBR            = :DK-PO-NBR                   07809301
078094           AND   PO_LNE_NBR        = :DK-PO-LINE-NBR              07809401
078095           AND   RMS_PO_SKU_NBR    = :DK-SKU-NBR                  07809503
078096           AND   VER_STATUS_CDE    = 'A'                          07809601
078097          WITH UR                                                 07809701
078098     END-EXEC.                                                    07809801
078099                                                                  07809901
078100     EVALUATE TRUE                                                07810001
078101         WHEN SQLCODE = ZERO                                      07810101
078102         WHEN SQLCODE = -811                                      07810201
078103             SET PS-VALID-PO-LINE TO TRUE                         07810302
078104         WHEN SQLCODE = +100                                      07810401
078105             DISPLAY 'INVALID SKU/LINE COMBO'                     07810502
078106             DISPLAY 'PO NUMBER:   ' IR-PO-NBR                    07810602
078107             DISPLAY 'SKU NUMBER:  ' IR-SKU-NBR                   07810702
078108             DISPLAY 'LINE NUMBER: ' IR-PO-LINE-NBR               07810802
078110         WHEN SQLWARN0 NOT = SPACE                                07811001
078111         WHEN SQLCODE < ZERO                                      07811101
078112         WHEN SQLCODE > ZERO                                      07811201
078113             DISPLAY 'ABEND INFO - KEY DATA'                      07811301
078114             DISPLAY 'PO NUMBER IS:  '  IR-PO-NBR                 07811401
078115             MOVE  SQLCODE               TO PV-DISP-SQLCODE       07811501
078116             DISPLAY 'SQL CODE IS: ' PV-DISP-SQLCODE              07811601
078117             PERFORM 9900-DB2-ABEND                               07811701
078118     END-EVALUATE.                                                07811801
078119                                                                  07811901
078120 4600-CHECK-STORE-NBR.                                            07812012
078121                                                                  07812112
078122     MOVE '4600-CHECK-STORE-NBR'                                  07812213
078123         TO PV-ABEND-PARAGRAPH.                                   07812312
078124     MOVE 'SELECT XLT_LOC'                                        07812412
078125         TO PV-ABEND-OPERATION.                                   07812512
078126                                                                  07812612
078127     EXEC SQL                                                     07812712
078128          SELECT LOC_NBR                                          07812812
078129               , OPN_DTE                                          07812912
078130               , CLO_DTE                                          07813012
078131          INTO  :XLT00010-LOC-NBR                                 07813112
078132               ,:XLT00010-OPN-DTE                                 07813212
078133               ,:XLT00010-CLO-DTE                                 07813312
078134          FROM   XLT_LOC                                          07813412
078135          WHERE  LOC_NBR           = :DK-LOC-NBR                  07813512
078136            AND  LOC_TYP_CDE       IN ('DS','CS','RV')            07813619
078137          WITH UR                                                 07813712
078138     END-EXEC.                                                    07813812
078139                                                                  07813912
078140     EVALUATE TRUE                                                07814012
078141         WHEN SQLCODE = ZERO                                      07814112
078143             SET PS-VALID-STORE TO TRUE                           07814312
078148         WHEN SQLCODE = +100                                      07814812
078149             CONTINUE                                             07814918
078153         WHEN SQLWARN0 NOT = SPACE                                07815312
078154         WHEN SQLCODE < ZERO                                      07815412
078155         WHEN SQLCODE > ZERO                                      07815512
078156             DISPLAY 'ABEND INFO - KEY DATA'                      07815612
078157             DISPLAY 'PO NUMBER IS: '  IR-PO-NBR                  07815712
078158                     ' FOR LINE: ' IR-PO-LINE-NBR                 07815812
078159                     ' FOR STORE: ' IR-STORE-NBR                  07815912
078160             MOVE  SQLCODE               TO PV-DISP-SQLCODE       07816012
078161             DISPLAY 'SQL CODE IS: ' PV-DISP-SQLCODE              07816112
078162             PERFORM 9900-DB2-ABEND                               07816212
078163     END-EVALUATE.                                                07816312
078164                                                                  07816412
078170******************************************************************07817012
078200*                                                                *07820000
078300******************************************************************07830000
078400 7000-READ-INPUT.                                                 07840000
078500                                                                  07850000
078600     READ INPUT-FILE                                              07860000
078700     INTO IR-INPUT-RECORD                                         07870000
078800        AT END                                                    07880000
078900           SET  PS-EOF-INPUT  TO TRUE.                            07890000
079000                                                                  07900000
079100     IF  PS-EOF-INPUT                                             07910000
079200         NEXT SENTENCE                                            07920000
079300     ELSE                                                         07930000
079400         ADD 1 TO  PV-READ-COUNT                                  07940000
079500         ADD 1 TO  PV-READ-COUNT-2                                07950000
079600         IF  PV-READ-COUNT-2 = 500                                07960000
079700             DISPLAY 'READ COUNT:'                                07970000
079800                     PV-READ-COUNT                                07980000
079900             MOVE ZEROES  TO PV-READ-COUNT-2                      07990000
080000         END-IF                                                   08000000
080100     END-IF.                                                      08010000
080200                                                                  08020000
080300                                                                  08030000
080400******************************************************************08040000
080500*                                                                *08050000
080600******************************************************************08060000
080700 8000-WRITE-OUTPUT.                                               08070004
080800                                                                  08080000
080810     IF  RC097-OPER-UNIT = 810                                    08081002
080900         WRITE OUT-FILE-DC810-RECORD                              08090002
081000          FROM RC097-ITEM-REC                                     08100002
081100         ADD +1 TO PV-WRITE-810-COUNT                             08110002
081200     ELSE                                                         08120002
081210     IF  RC097-OPER-UNIT = 830                                    08121002
081220         WRITE OUT-FILE-DC830-RECORD                              08122002
081230          FROM RC097-ITEM-REC                                     08123002
081240         ADD +1 TO PV-WRITE-830-COUNT                             08124002
081250     ELSE                                                         08125002
081260     IF  RC097-OPER-UNIT = 840                                    08126002
081270         WRITE OUT-FILE-DC840-RECORD                              08127002
081280          FROM RC097-ITEM-REC                                     08128002
081290         ADD +1 TO PV-WRITE-840-COUNT                             08129002
081291     ELSE                                                         08129102
081292     IF  RC097-OPER-UNIT = 855                                    08129202
081293         WRITE OUT-FILE-DC855-RECORD                              08129302
081294          FROM RC097-ITEM-REC                                     08129402
081295         ADD +1 TO PV-WRITE-855-COUNT                             08129502
081296     ELSE                                                         08129602
081297     IF  RC097-OPER-UNIT = 860                                    08129702
081298         WRITE OUT-FILE-DC860-RECORD                              08129802
081299          FROM RC097-ITEM-REC                                     08129902
081300         ADD +1 TO PV-WRITE-860-COUNT                             08130002
081301     ELSE                                                         08130102
081302     IF  RC097-OPER-UNIT = 865                                    08130202
081303         WRITE OUT-FILE-DC865-RECORD                              08130302
081304          FROM RC097-ITEM-REC                                     08130402
081305         ADD +1 TO PV-WRITE-865-COUNT                             08130502
081306     ELSE                                                         08130602
081307     IF  RC097-OPER-UNIT = 875                                    08130702
081308         WRITE OUT-FILE-DC875-RECORD                              08130802
081309          FROM RC097-ITEM-REC                                     08130902
081310         ADD +1 TO PV-WRITE-875-COUNT                             08131002
081311     ELSE                                                         08131102
081312     IF  RC097-OPER-UNIT = 885                                    08131202
081313         WRITE OUT-FILE-DC885-RECORD                              08131302
081314          FROM RC097-ITEM-REC                                     08131402
081315         ADD +1 TO PV-WRITE-885-COUNT                             08131502
081316     ELSE                                                         08131602
081317     IF  RC097-OPER-UNIT = 890                                    08131702
081318         WRITE OUT-FILE-DC890-RECORD                              08131802
081319          FROM RC097-ITEM-REC                                     08131902
081320         ADD +1 TO PV-WRITE-890-COUNT                             08132002
081321     ELSE                                                         08132108
081322     IF  RC097-OPER-UNIT = 806                                    08132208
081323         WRITE OUT-FILE-EFC806-RECORD                             08132308
081324          FROM RC097-ITEM-REC                                     08132408
081325         ADD +1 TO PV-WRITE-806-COUNT                             08132508
081326     ELSE                                                         08132608
081327     IF  RC097-OPER-UNIT = 816                                    08132708
081328         WRITE OUT-FILE-EFC816-RECORD                             08132808
081329          FROM RC097-ITEM-REC                                     08132908
081330         ADD +1 TO PV-WRITE-816-COUNT                             08133008
081331     ELSE                                                         08133108
081332     IF  RC097-OPER-UNIT = 826                                    08133208
081333         WRITE OUT-FILE-EFC826-RECORD                             08133308
081334          FROM RC097-ITEM-REC                                     08133408
081335         ADD +1 TO PV-WRITE-826-COUNT                             08133508
081336     ELSE                                                         08133608
081337     IF  RC097-OPER-UNIT = 836                                    08133708
081338         WRITE OUT-FILE-EFC836-RECORD                             08133808
081339          FROM RC097-ITEM-REC                                     08133908
081340         ADD +1 TO PV-WRITE-836-COUNT                             08134008
081341     ELSE                                                         08134108
081342     IF  RC097-OPER-UNIT = 870                                    08134208
081343         WRITE OUT-FILE-EFC870-RECORD                             08134308
081344          FROM RC097-ITEM-REC                                     08134408
081345         ADD +1 TO PV-WRITE-870-COUNT                             08134508
081346     ELSE                                                         08134608
081347     IF  RC097-OPER-UNIT = 858                                    08134708
081348         WRITE OUT-FILE-LFC858-RECORD                             08134808
081349          FROM RC097-ITEM-REC                                     08134908
081350         ADD +1 TO PV-WRITE-858-COUNT                             08135008
081351     ELSE                                                         08135108
081352     IF  RC097-OPER-UNIT = 868                                    08135208
081353         WRITE OUT-FILE-LFC868-RECORD                             08135308
081354          FROM RC097-ITEM-REC                                     08135408
081355         ADD +1 TO PV-WRITE-868-COUNT                             08135508
081356     ELSE                                                         08135608
081357     IF  RC097-OPER-UNIT = 878                                    08135708
081358         WRITE OUT-FILE-LFC878-RECORD                             08135808
081359          FROM RC097-ITEM-REC                                     08135908
081360         ADD +1 TO PV-WRITE-878-COUNT                             08136008
081361     ELSE                                                         08136108
081362     IF  RC097-OPER-UNIT = 888                                    08136208
081363         WRITE OUT-FILE-LFC888-RECORD                             08136308
081364          FROM RC097-ITEM-REC                                     08136408
081365         ADD +1 TO PV-WRITE-888-COUNT                             08136508
081366     ELSE                                                         08136610
081367     IF  RC097-OPER-UNIT = 895                                    08136710
081368         WRITE OUT-FILE-DC895-RECORD                              08136810
081369          FROM RC097-ITEM-REC                                     08136910
081370         ADD +1 TO PV-WRITE-895-COUNT                             08137010
081371     ELSE                                                         08137112
081372     IF  RC097-OPER-UNIT = 813                                    08137212
081373         WRITE OUT-FILE-EFC813-RECORD                             08137315
081374          FROM RC097-ITEM-REC                                     08137412
081375         ADD +1 TO PV-WRITE-813-COUNT                             08137512
081376     ELSE                                                         08137612
081377         DISPLAY 'INVALID OPER UNIT: ' IR-DC-NBR                  08137712
081378         DISPLAY 'FOR PO NBR:        ' IR-PO-NBR                  08137812
081379         ADD +1 TO PV-INVALID-DC-COUNT                            08137912
081380     END-IF.                                                      08138012
081390                                                                  08139012
083300******************************************************************08330000
083400*  ABEND ROUTINE                                                 *08340000
083500******************************************************************08350000
083600 9900-DB2-ABEND.                                                  08360000
083700                                                                  08370000
083800     MOVE SQLCODE TO PV-SQLCODE.                                  08380000
083900     DISPLAY '*** DB2 ERROR '.                                    08390000
084000     DISPLAY '*** SQLCODE   = ' PV-SQLCODE.                       08400000
084100     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 08410000
084200     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               08420000
084300     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               08430000
084400     DISPLAY '*** MESSAGE   = ' PV-DB2-OPERATION-MESSAGE-1.       08440000
084500     DISPLAY '***           = ' PV-DB2-OPERATION-MESSAGE-2.       08450000
084600     DISPLAY '*** TABLE 1   = ' PV-DB2-TABLE-NAME-1.              08460000
084700     DISPLAY '*** TABLE 2   = ' PV-DB2-TABLE-NAME-2.              08470000
084800                                                                  08480000
084900     COPY DPPD004.                                                08490000
085000                                                                  08500000
085100     MOVE +4013 TO PV-ABEND-CODE.                                 08510000
085200     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         08520000
085300                                                                  08530000
086500******************************************************************08650000
086600*                 E N D   O F   P R O G R A M                    *08660000
086700******************************************************************08670000
