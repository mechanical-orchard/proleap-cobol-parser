000200 IDENTIFICATION DIVISION.                                         00020017
000300                                                                  00030017
000400 PROGRAM-ID.    TRKCS154.                                         00040019
000500 AUTHOR.        MARGARET MORRISON.                                00050019
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060017
000700 DATE-WRITTEN.  12-30-97.                                         00070019
000800 DATE-COMPILED.                                                   00080017
000900******************************************************************00090017
001000*    Y154 - ADD/UPDATE/DELETE POE CODES                          *00100019
001100*                                                                *00110017
001200*    THIS PROGRAM ALLOWS THE USER TO ADD/UPDATE/DELETE POE       *00120019
001300*    CODES.  ALL FIELDS ARE REQUIRED AND MUST BE ENTERED ON THE  *00130019
001400*    ADD FUNCTION.                                               *00140017
001500******************************************************************00150017
CICS  * CHANGED 11/21/2022    BY JIM HUNTER      WR: CHG0278495                 
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL                
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.               
CICS  *-----------------------------------------------------------------        
001600                                                                  00160017
001700 ENVIRONMENT DIVISION.                                            00170017
001800                                                                  00180017
001900 DATA DIVISION.                                                   00190017
002000                                                                  00200017
002100 WORKING-STORAGE SECTION.                                         00210017
002200                                                                  00220017
002300 01  DK-DB2-KEYS.                                                 00230017
002600     05  DK-POE-CODE                    PIC  X(03)  VALUE SPACE.  00260017
002710     05  DK-ENT-NAME                    PIC  X(04)  VALUE SPACE.          
002720     05  DK-ENT-ID                      PIC  S9(9)  COMP.                 
002800     05  DK-STAT-CDE                    PIC  X(01)  VALUE SPACE.  00280017
002810     05  DK-POE-STAT-CDE                PIC  X(01)  VALUE SPACE.          
002900     05  DK-FUNC-CDE                    PIC  X(01)  VALUE SPACE.  00290017
002910     05  DK-POE-STD-EDI-CDE             PIC  X(04)  VALUE SPACE.          
003000                                                                  00300017
003100 01  PC-PROGRAM-CONSTANTS.                                        00310017
003200     05  PC-CURRENT-MAP-NAME      PIC  X(08)  VALUE  'TR154A  '.  00320019
003300     05  PC-CURRENT-MAPSET-NAME   PIC  X(08)  VALUE  'TRKM154 '.  00330019
003400     05  PC-CURRENT-PROGRAM-NAME  PIC  X(08)  VALUE  'TRKCS154'.  00340019
003500     05  PC-MAX-RETRIES           PIC S9(04)  VALUE  +3           00350017
003600                                              COMP.               00360017
003700     05  PC-MAX-LOCK-RETRIES      PIC S9(04)  VALUE  +3           00370017
003800                                              COMP.               00380017
003900     05  PC-MAX-MSG-VAR           PIC S9(04)  VALUE +1            00390017
004000                                              COMP.               00400017
004100     05  PC-UPD-VSAM              PIC  X(01)  VALUE 'Y'.          00410017
004200     05  PC-PRIMARY               PIC XX      VALUE '01'.         00420017
004300     05  PC-A                     PIC  X(01)  VALUE 'A'.          00430017
004400     05  PC-I                     PIC  X(01)  VALUE 'I'.          00440017
004401     05  PC-M                     PIC  X(01)  VALUE 'M'.          00440017
004410     05  PC-N                     PIC  X(01)  VALUE 'N'.          00440017
004411     05  PC-O                     PIC  X(01)  VALUE 'O'.          00440017
004420     05  PC-Y                     PIC  X(01)  VALUE 'Y'.          00440017
004500     05  PC-MSG-VAR-SYMBOLIC      PIC  X(04)  VALUE '&VAR'.       00450017
004510                                                                          
004600     05  PC-TSYMSG-NUMBERS.                                       00460017
004700         10  PC-TSYMSG-00004      PIC  9(05)  VALUE  00004.       00470017
004710*             -  PRESS F2 TO CONFIRM REQUEST                              
004800         10  PC-TSYMSG-00034      PIC  9(05)  VALUE  00034.       00480017
004810*             -  ADD SUCCESSFUL                                           
004820         10  PC-TSYMSG-00050      PIC  9(05)  VALUE  00050.               
004830*             -  NO LIST ITEMS WERE FOUND FOR                             
004840*                THE CRITERIA SPECIFIED                                   
005100         10  PC-TSYMSG-00057      PIC  9(05)  VALUE  00057.       00510017
005101*             -  A LIST ITEM MUST BE SELECTED                             
005102*                FOR THIS FUNCTION                                        
005200         10  PC-TSYMSG-00059      PIC  9(05)  VALUE  00059.       00520017
005201*             -  UPDATE(S) SUCCESSFUL                                     
005300         10  PC-TSYMSG-00069      PIC  9(05)  VALUE  00069.       00530017
005310*             -  TOP OF LIST                                              
005400         10  PC-TSYMSG-00070      PIC  9(05)  VALUE  00070.       00540017
005410*             -  BOTTOM OF LIST                                           
005600         10  PC-TSYMSG-00115      PIC  9(05)  VALUE  00115.       00560017
005610*             -  DELETE SUCCESSFUL                                        
005700         10  PC-TSYMSG-00116      PIC  9(05)  VALUE  00116.       00570017
005710*             -  CANNOT DELETE - RECORD DOES NOT EXIST                    
005900         10  PC-TSYMSG-00223      PIC  9(05)  VALUE  00223.       00590017
005910*             -  PREVIOUS OBJECT HAS BEEN ADDED                           
006400         10  PC-TSYMSG-01450      PIC  9(05)  VALUE  01450.       00640017
006401*             -  CODE IS INVALID                                          
006410         10  PC-TSYMSG-01452      PIC  9(05)  VALUE  01452.       00640017
006420*             -  THE PORT CODE IS INVALID                                 
006500         10  PC-TSYMSG-01644      PIC  9(05)  VALUE  01644.       00650017
006510*             -  CODE IS INACTIVE                                         
006520         10  PC-TSYMSG-01646      PIC  9(05)  VALUE  01646.               
006530*             -  SELECTED CODE IS ALREADY ACTIVE                          
006540                                                                          
006600     05  PC-INTER-APPL-CODES.                                     00660017
007000         10  PC-INTER-APPL-LIST-UPD   PIC X(01)  VALUE '4'.       00700017
007100         10  PC-INTER-APPL-LIST-DEL   PIC X(01)  VALUE '5'.       00710017
007200         10  PC-INTER-APPL-LIST-COPY  PIC X(01)  VALUE '7'.       00720017
007300                                                                  00730017
007400 01  PS-PROGRAM-SWITCHES.                                         00740017
007500     05  PS-ERROR-SW              PIC  X(01)  VALUE  'N'.         00750017
007600         88  PS-ERROR                         VALUE  'Y'.         00760017
007700         88  PS-NO-ERROR                      VALUE  'N'.         00770017
007800     05  PS-COMMAREA-SW           PIC X(01)   VALUE 'N'.          00780017
007900         88  PS-COMMAREA-VALID                VALUE 'Y'.          00790017
008000         88  PS-COMMAREA-NOT-VALID            VALUE 'N'.          00800017
008100     05  PS-LIST-END-SW           PIC X(01)   VALUE 'N'.          00810017
008200         88  PS-LIST-END                      VALUE 'Y'.          00820017
008300         88  PS-NO-LIST-END                   VALUE 'N'.          00830017
008400                                                                  00840017
008500 01  PV-PROGRAM-VARIABLES.                                        00850017
008600     05  PV-CICS-RESPONSE         PIC S9(04)  VALUE +0            00860017
008700                                              COMP SYNC.          00870017
008800     05  PV-RETRY-COUNTER         PIC S9(04)  VALUE +0            00880017
008900                                              COMP SYNC.          00890017
009000     05  PV-LOCK-RETRY-COUNTER    PIC S9(04)  VALUE +0            00900017
009100                                              COMP SYNC.          00910017
009200     05  PV-MSG-VAR-CNT           PIC S9(04)  VALUE +0            00920017
009300                                              COMP SYNC.          00930017
009400     05  PV-DISPLAY-TASK          PIC 9(05).                      00940017
009500                                                                  00950017
009600***************************************************************** 00960017
009700*  RECORD LAYOUT FOR THE POE CODE SELECTION TEMP STORAGE QUEUE. * 00970019
009900***************************************************************** 00990017
010000                                                                  01000017
010100     COPY TRWS023.                                                01010019
010200                                                                  01020017
010300 EJECT                                                            01030017
010400******************************************************************01040017
010500*    CALLING PARAMETERS FOR LOCKING MODULE DPKCS044              *01050017
010600******************************************************************01060017
010700                                                                  01070017
010800     COPY DPWS044.                                                01080017
010900 EJECT                                                            01090017
011000******************************************************************01100017
011100*    MAP LAYOUT                                                  *01110017
011200******************************************************************01120017
011300                                                                  01130017
011400     COPY TRKM154.                                                01140019
011500                                                                  01150017
011600                                                                  01160017
011700     EJECT                                                        01170017
011800******************************************************************01180017
011900*    ATTRIBUTE SETTINGS COPYBOOK.                                *01190017
012000******************************************************************01200017
012100                                                                  01210017
012200     COPY DPWS015.                                                01220017
012300                                                                  01230017
012400******************************************************************01240017
012500*    FUNCTION KEYS COPYBOOK                                      *01250017
012600******************************************************************01260017
012700                                                                  01270017
012800     COPY DPWS016.                                                01280017
012900 EJECT                                                            01290017
013000***************************************************************** 01300017
CICS  *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 01310017
013200***************************************************************** 01320017
013300     COPY DPWS030.                                                01330017
CICS       COPY DPWS930.                                                01330017
013400 EJECT                                                            01340017
013500***************************************************************** 01350017
013600*    STANDARD COMMAREA.                                         * 01360017
013700***************************************************************** 01370017
013800                                                                  01380017
013900     COPY DPWS020.                                                01390017
014000     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01400017
014100                                                                  01410017
014200***************************************************************** 01420017
014300*    INTER-APPLICATION COMMAREA.                                * 01430017
014400***************************************************************** 01440017
014500                                                                  01450017
014600         10  INTER-APPL-COMM-AREA PIC X(200).                     01460017
014700     COPY TRWS022.                                                01470019
014800***************************************************************** 01480017
014900*    SPECIFIC COMMMAREA FOR TRKCS154.                           * 01490020
015000***************************************************************** 01500017
015100         10  ASC-SPECIFIC-COMMAREA.                               01510017
015200             15  ASC-FORMAT-IND                 PIC  X(01).       01520017
015300                 88  ASC-ADD-POE                        VALUE '1'.01530020
015400                 88  ASC-UPD-POE                   VALUE '2', '4'.01540020
015500                 88  ASC-DEL-POE                        VALUE '3'.01550020
015600                 88  ASC-UPD-FROM-LIST                  VALUE '4'.01560017
015700                 88  ASC-DEL-FROM-LIST                  VALUE '5'.01570017
015800                 88  ASC-ADD-FROM-LIST                  VALUE '6'.01580017
015900             15  ASC-ADD-COMPLETE-SW            PIC  X(01).       01590017
016000                 88  ASC-ADD-COMPLETE                   VALUE 'Y'.01600017
016100                 88  ASC-ADD-PENDING                    VALUE 'N'.01610017
016200             15  ASC-UPD-COMPLETE-SW            PIC  X(01).       01620017
016300                 88  ASC-UPD-COMPLETE                   VALUE 'Y'.01630017
016400                 88  ASC-UPD-PENDING                    VALUE 'N'.01640017
016500             15  ASC-DEL-COMPLETE-SW            PIC  X(01).       01650017
016600                 88  ASC-DEL-COMPLETE                   VALUE 'Y'.01660017
016700                 88  ASC-DEL-PENDING                    VALUE 'N'.01670017
017100             15  ASC-POE-CODE                   PIC  X(03).       01710020
017110             15  ASC-POE-CODE-DESC              PIC  X(30).       01711020
017200             15  ASC-POE-CITY-NAME              PIC  X(30).       01720020
017300             15  ASC-POE-STATE-CODE             PIC  X(02).       01730020
017400             15  ASC-DCONSLR-SCAC               PIC  X(04).       01740020
017500             15  ASC-DCONSLR-NAME               PIC  X(30).       01750020
017600             15  ASC-DCONSLR-ENT-ID             PIC  S9(9).       01760020
018200             15  ASC-POE-STD-EDI-CDE            PIC  X(04).       01820020
018201             15  ASC-ALLOWED-ON-PO              PIC  X(01).               
018210             15  ASC-TRIP-TYP-CDE               PIC  X(01).               
018300             15  ASC-IATA-CDE                   PIC  X(03).               
018800             15  ASC-POE-CODE-IND               PIC  X(01).       01880017
018900                 88  ASC-VALID-POE-CODE        VALUE 'Y'.         01890017
019000                 88  ASC-INACTIVE-POE-CODE     VALUE 'I'.         01900017
019100                 88  ASC-INVALID-POE-CODE      VALUE 'N'.         01910017
019500             15  ASC-USE-SELECTION-QUEUE-IND PIC  X(01).          01950017
019600                 88  ASC-USE-SEL-QUEUE         VALUE 'Y'.         01960017
019700             15  ASC-LIST-QUEUE-NAME.                             01970017
019800                 20  ASC-LIST-TERM-ID                PIC  X(04).  01980017
019900                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   01990017
020000                                                          COMP-3. 02000017
020100                 20  ASC-LIST-SEQ                    PIC  9(01).  02010017
020200             15  ASC-NUMBER-OF-SELECTED-ITEMS                     02020017
020300                                            PIC S9(09) COMP-3.    02030017
020400             15  ASC-NUMBER-OF-TS-ITEMS     PIC S9(05) COMP-3.    02040017
020500             15  ASC-SEL-QUEUE-NAME.                              02050017
020600                 20  ASC-SEL-TERM-ID        PIC X(04).            02060017
020700                 20  ASC-SEL-TASK           PIC S9(05) COMP-3.    02070017
020800                 20  ASC-SEL-SEQ            PIC 9(01).            02080017
020900             15  ASC-SEL-SUB                PIC S9(04) COMP.      02090017
021000             15  ASC-SEL-ITEM               PIC S9(04) COMP.      02100017
021100     EJECT                                                        02110017
021200******************************************************************02120017
021300*    ABEND PROCESSING COPYBOOK.                                  *02130017
021400******************************************************************02140017
021500                                                                  02150017
021600     COPY DPWS013.                                                02160017
021700                                                                  02170017
021900******************************************************************02190017
022000*    DB2 AREA FOR TEXTENT TABLE                                  *02200017
022100******************************************************************02210017
022200     EXEC SQL                                                     02220017
022300          INCLUDE TEXTENT                                         02230017
022400     END-EXEC.                                                    02240017
022500                                                                  02250017
022600******************************************************************02260017
022700*    DB2 AREA FOR ENTERPRISE TABLE                               *02270017
022800******************************************************************02280017
022900     EXEC SQL                                                     02290017
023000          INCLUDE TENTNME                                         02300017
023100     END-EXEC.                                                    02310017
023200                                                                  02320017
024000******************************************************************02400017
024100*    DB2 AREA FOR TRANSPORATION PORT OF ENTRY (POE) TABLE        *02410020
024200******************************************************************02420017
024300     EXEC SQL                                                     02430017
024400          INCLUDE TIMPOE                                          02440017
024500     END-EXEC.                                                    02450017
024600                                                                  02460017
025500******************************************************************02550017
025600*    DB2 AREA FOR AUDIT POE TABLE                                *02560020
025700******************************************************************02570017
025800     EXEC SQL                                                     02580017
025900          INCLUDE TAUPOE                                          02590020
026000     END-EXEC.                                                    02600017
026100                                                                  02610017
026200******************************************************************02620017
026300*    DB2 AREA FOR COMMUNICATIONS                                 *02630017
026400******************************************************************02640017
026500     EXEC SQL                                                     02650017
026600          INCLUDE SQLCA                                           02660017
026700     END-EXEC.                                                    02670017
026800                                                                  02680017
026900 EJECT                                                            02690017
027000 LINKAGE SECTION.                                                 02700017
027100                                                                  02710017
027200 01  DFHCOMMAREA.                                                 02720017
027300     05  FILLER                         OCCURS  1 TO 4072 TIMES   02730017
027400                                        DEPENDING ON EIBCALEN.    02740017
027500         10  FILLER                     PIC  X(01).               02750017
027600                                                                  02760017
027700                                                                  02770017
027800 PROCEDURE DIVISION.                                              02780017
027900***************************************************************** 02790017
028000** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 02800017
028100** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 02810017
028200** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 02820017
028300**                                                             ** 02830017
028400** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 02840017
028500** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 02850017
028600***************************************************************** 02860017
028700 0000-MAIN-MODULE.                                                02870017
028800     INITIALIZE DP030-CICS-API-FIELDS.                            02880017
028900     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       02890017
029000     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          02900017
029100     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         02910017
029200     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       02920017
029300     MOVE LENGTH OF TR154AI        TO DP030-MAP-LENGTH (1).       02930019
029400     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     02940017
029500     PERFORM 0001-CALL-CICS-ARCH-API.                             02950017
029600                                                                  02960017
029700     PERFORM 1000-CONTROL-PROCESSING.                             02970017
029800                                                                  02980017
029900     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     02990017
030000     PERFORM 0001-CALL-CICS-ARCH-API.                             03000017
030100                                                                  03010017
030200 0001-CALL-CICS-ARCH-API.                                         03020017
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                              
030400                                    DFHCOMMAREA                           
030500                                    DP030-CICS-API-FIELDS                 
030600                                    DP020-STANDARD-COMMAREA               
030700                                    TR154AI.                              
030800                                                                  03080017
030900     IF  DP030-RC-CALL-SUCCESSFUL                                 03090017
031000         CONTINUE                                                 03100017
031100     ELSE                                                         03110017
031200         SET DP013-NO-ROLLBACK                                    03120017
031300             DP013-XCTL-DISPLAY-RESTART                           03130017
031400             DP013-CICS-ABEND      TO TRUE                        03140017
031500         MOVE 'BEFORE 0000-MAIN-MODULE'                           03150017
031600                                   TO DP013-PARAGRAPH             03160017
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O03170017
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      03180017
031900         MOVE DP030-RETURN-CODE                                   03190017
032000                                   TO DP013-MESSAGE-TEXT (3)      03200017
032100         PERFORM DP013-0000-PROCESS-ABEND                         03210017
032200     END-IF.                                                      03220017
032300 EJECT                                                            03230017
032400******************************************************************03240017
032500*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *03250017
032600*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *03260017
032700******************************************************************03270017
032800                                                                  03280017
032900 1000-CONTROL-PROCESSING.                                         03290017
033000                                                                  03300017
033100     EVALUATE TRUE                                                03310017
033200         WHEN DP020-NEXT-ACT-INITIAL                              03320017
033300             INITIALIZE ASC-SPECIFIC-COMMAREA                     03330017
033310             PERFORM 7500-MOVE-TR022-TO-ASC                               
033320             MOVE DP020-INT-APPL-FORMAT-IND TO ASC-FORMAT-IND             
035500             PERFORM 1100-PROCESS-INTER-APPL-COMM                 03550017
035600             PERFORM 4000-BUILD-INITIAL-PANEL                     03560017
035700             IF ASC-ADD-POE                                               
035800                 CONTINUE                                                 
035900             ELSE                                                         
036000                 PERFORM 3000-EDIT-DATA-IN-COMMAREA                       
036100             END-IF                                                       
036200                                                                          
036300         WHEN DP020-NEXT-ACT-READ-MAP                             03630017
036400             PERFORM 2000-PROCESS-PANEL                           03640017
036500             PERFORM 7580-MOVE-COMMAREA-TO-SCREEN                 03650017
036600                                                                  03660017
036700         WHEN DP020-NEXT-ACT-RETURN                               03670017
036800             PERFORM 7580-MOVE-COMMAREA-TO-SCREEN                 03680017
036900                                                                  03690017
037000         WHEN OTHER                                               03700017
037100             SET DP013-LOGIC-ABEND                                03710017
037200                 DP013-NO-ROLLBACK TO TRUE                        03720017
037300             MOVE '1000-CONTROL-PROCESSING'                       03730017
037400                                   TO DP013-PARAGRAPH             03740017
037500             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   03750017
037600                                   TO DP013-MESSAGE-TEXT(1)       03760017
037700             MOVE DP020-NEXT-APPL-ACTIVITY                        03770017
037800                                   TO DP013-MESSAGE-TEXT(2)       03780017
037900             PERFORM DP013-0000-PROCESS-ABEND                     03790017
038000     END-EVALUATE.                                                03800017
038100                                                                  03810017
038200******************************************************************03820017
038300*    DETERMINE THE KEY OF THE OBJECT TO BE UPDATED BASED ON THE  *03830017
038400*    INTER-APPLICATION FORMAT CODE.                              *03840017
038500*                                                                *03850017
038600*    PERFORM SPECIFIC VALIDATIONS FOR EACH "MODE" AND BASED      *03860017
038700*    ON WHERE THE PROGRAM WAS INITIATED FROM.                    *03870017
038800******************************************************************03880017
038900 1100-PROCESS-INTER-APPL-COMM.                                    03890017
039000                                                                  03900017
039100     SET PS-COMMAREA-VALID         TO TRUE.                       03910017
039200                                                                  03920017
039500     EVALUATE DP020-INT-APPL-FORMAT-IND                           03950017
039510                                                                          
039600* PERFORM PRE-EDITS WHEN UPDATING, COMING FROM A LIST SCREEN      03960017
039700* PERFORM PRE-EDITS WHEN DELETING, COMING FROM A LIST SCREEN      03970017
039800         WHEN PC-INTER-APPL-LIST-UPD                              03980017
039900         WHEN PC-INTER-APPL-LIST-DEL                              03990017
040000             IF TR022-NUMBER-OF-SELECTED-ITEMS  = 0               04000021
040100                 SET DP020-NEXT-ACT-APPL-ERROR                    04010017
040200                     DP030-OVERRIDE-GO                            04020017
040300                     DP020-MSG-WARNING                            04030017
040400                     PS-ERROR                                     04040017
040500                     PS-COMMAREA-NOT-VALID   TO TRUE              04050017
040700                 MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER         04070017
040900             ELSE                                                 04090017
041000                 SET ASC-USE-SEL-QUEUE                            04100017
041100                     DP030-SET-CURSOR-APPL-1 TO TRUE              04110017
041300                 MOVE TR022-NUMBER-OF-SELECTED-ITEMS              04130021
041400                                   TO ASC-NUMBER-OF-SELECTED-ITEMS04140017
041500                 MOVE TR022-NUMBER-OF-TS-ITEMS                    04150021
041600                                   TO ASC-NUMBER-OF-TS-ITEMS      04160017
041700                 MOVE TR022-SEL-QUEUE-NAME                        04170021
041800                                   TO ASC-SEL-QUEUE-NAME          04180017
041900                 PERFORM 1120-PREPARE-LIST-ENTRY                  04190017
042000             END-IF                                               04200017
042100                                                                  04210017
042200             IF  PS-NO-ERROR                                      04220017
042300                  MOVE DP015-HL-OFF         TO APOECODH           04230021
042310                                               AEDICODH                   
042320                                               ADCNSLCH                   
042400                  MOVE DP015-PRO-NOR-OFF    TO APOECODA           04240021
042410                                               AEDICODA                   
042420                                               ADCNSLCA                   
042500                  MOVE DP015-BLUE           TO APOECODC           04250021
042510                                               AEDICODC                   
042520                                               ADCNSLCC                   
042600                                                                  04260017
046400               IF ASC-UPD-FROM-LIST                                       
046410                   MOVE -1               TO AIATACDL                      
046500                   SET ASC-UPD-PENDING   TO TRUE                          
046700               ELSE                                                       
046800                   MOVE PC-TSYMSG-00004  TO DP020-MSG-NUMBER              
047000                   SET ASC-DEL-PENDING                                    
047100                       DP020-MSG-INFORMATIONAL TO TRUE                    
047300               END-IF                                                     
047400             END-IF                                                       
059600     END-EVALUATE.                                                        
059700                                                                          
059800 1120-PREPARE-LIST-ENTRY.                                                 
059900                                                                          
060000     MOVE TR023-MAX-ITEMS          TO ASC-SEL-SUB.                        
060100     MOVE ZERO                     TO ASC-SEL-ITEM.                       
060200                                                                          
060300     PERFORM 2140-GET-NEXT-POE-CODE.                                      
060400                                                                          
062400******************************************************************06240017
062500* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*06250017
062600* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*06260017
062700* EDITS.                                                         *06270017
062800******************************************************************06280017
062900 2000-PROCESS-PANEL.                                              06290017
063000                                                                  06300017
063100     EVALUATE TRUE                                                06310017
063200                                                                  06320017
063300         WHEN DP020-SRC-AID = DP016-CLEAR                         06330017
063400             PERFORM 7580-MOVE-COMMAREA-TO-SCREEN                 06340017
063500             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   06350017
063600                                                                  06360017
063700         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    06370017
063702             MOVE TR022-POE-CODE        TO ASC-POE-CODE                   
063703                                           DK-POE-CODE                    
063706             MOVE TR022-POE-STD-EDI-CDE TO ASC-POE-STD-EDI-CDE            
063707                                           DK-POE-STD-EDI-CDE             
063708             MOVE TR022-DCONSLR-ENT-ID  TO ASC-DCONSLR-ENT-ID             
063709                                           DK-ENT-ID                      
063710             PERFORM 4100-SELECT-POE                                      
063711                                                                          
063712             IF ASC-VALID-POE-CODE AND                                    
063713                IMPOE-STAT-CDE = PC-I                                     
063714                 SET  ASC-DEL-COMPLETE   TO TRUE                          
063715             END-IF                                                       
063720                                                                          
063800             IF ASC-DEL-COMPLETE                                          
063900                 MOVE PC-TSYMSG-00116 TO DP020-MSG-NUMBER                 
064100                 SET DP020-MSG-FATAL                                      
064200                     PS-ERROR         TO TRUE                             
064400             ELSE                                                         
064500                 SET DP030-CONTINUE-GO TO TRUE                            
064700                 PERFORM 7100-INACTIVATE-POE                      06470022
064800                 PERFORM 7000-DEL-POE-CODE                        06480022
064900             END-IF                                               06490017
065000                                                                  06500017
065100         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     06510017
067450             SET TR022-RECORD-UPDATED    TO TRUE                          
067451             PERFORM 3200-RESET-ATTRIBUTES                                
067460             MOVE -1                     TO APOECODL              06746023
067470             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06747017
067480             MOVE ZEROES                 TO DP020-MSG-NUMBER      07111099
067490             MOVE DP020-INT-APPL-FORMAT-IND TO ASC-FORMAT-IND     06749017
067491             PERFORM 1100-PROCESS-INTER-APPL-COMM                         
067492                                                                          
067507             IF ASC-DCONSLR-SCAC > SPACES OR                              
067508                ASC-DCONSLR-SCAC = SPACES                                 
067510                 MOVE ASC-DCONSLR-SCAC     TO DK-ENT-NAME (1:4)           
067512                 PERFORM 4330-SELECT-ENTNME                               
067514                 IF ENTNME-ENT-NAME-DESC = SPACES OR                      
067515                    ASC-DCONSLR-SCAC = SPACES OR                          
067516                    ASC-DCONSLR-SCAC = LOW-VALUES                         
067517                     MOVE SPACES         TO ASC-DCONSLR-NAME              
067518                 ELSE                                                     
067519                     MOVE ENTNME-ENT-ID     TO ASC-DCONSLR-ENT-ID         
067520                     MOVE ENTNME-ENT-NAME-DESC TO ASC-DCONSLR-NAME        
067521                 END-IF                                                   
067522             MOVE ASC-DCONSLR-NAME      TO ADCNSLNO                       
067523             END-IF                                                       
067524             PERFORM 4000-BUILD-INITIAL-PANEL                             
067527                                                                          
067800         WHEN OTHER                                               06780017
067900             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 06790017
068000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   06800017
068100             IF  PS-NO-ERROR                                      06810017
068200                 PERFORM 2100-CHECK-FUNCTION-KEY                  06820017
068300                 SET DP030-CONTINUE-GO TO TRUE                    06830017
068400             ELSE                                                 06840017
068500                 SET DP030-OVERRIDE-GO TO TRUE                    06850017
068600             END-IF                                               06860017
068700     END-EVALUATE.                                                06870017
068800                                                                  06880017
068900 EJECT                                                            06890017
069000******************************************************************06900017
069100** ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     **06910017
069200** FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED **06920017
069300** FROM THE CICS ARCHITECTURE API.                              **06930017
069400******************************************************************06940017
069500 2100-CHECK-FUNCTION-KEY.                                                 
069510                                                                          
069600     EVALUATE TRUE                                                        
069700         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)                      
069710             MOVE ASC-POE-CODE        TO DK-POE-CODE                     9
069722             MOVE ASC-POE-STD-EDI-CDE TO DK-POE-STD-EDI-CDE               
069724             MOVE ASC-DCONSLR-ENT-ID  TO DK-ENT-ID                        
069730             PERFORM 4100-SELECT-POE                                     9
069750             IF ASC-VALID-POE-CODE                                       9
069770                IF IMPOE-STAT-CDE = PC-A                                 9
069780                    SET ASC-ADD-COMPLETE TO TRUE                         9
069790                END-IF                                                   9
069792             END-IF                                                      9
069793                                                                         9
069794             IF NOT ASC-ADD-COMPLETE                                     9
069795                IF DK-POE-STAT-CDE = PC-I                                9
069796                    PERFORM 6010-ADD-INACTIVE-POE                        9
069797                ELSE                                                     9
069798                    PERFORM 5000-ADD-POE-CODE                            9
069799                END-IF                                                   9
069800                SET ASC-ADD-COMPLETE  TO TRUE                            9
069801*THE POE CODE HAS BEEN ADDED                                              
069805                MOVE PC-TSYMSG-00034  TO DP020-MSG-NUMBER                9
069806                SET ASC-ADD-POE TO TRUE                                  9
069807                MOVE +1 TO TR022-NUMBER-OF-TS-ITEMS                      9
069808                PERFORM 3200-RESET-ATTRIBUTES                            9
069809                PERFORM 7550-MOVE-ASC-TO-TR022                            
069818                SET DP020-MSG-INFORMATIONAL TO TRUE                      9
069819                PERFORM 2110-PREPARE-INTER-APPL-COMM                     9
069820             ELSE                                                        9
069821                 MOVE PC-TSYMSG-00223  TO DP020-MSG-NUMBER               9
069822             END-IF                                                      9
069830                                                                          
071400         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)                      
071500             PERFORM 6000-UPDATE-POE                                      
071600             SET ASC-UPD-COMPLETE  TO TRUE                                
071800*THE POE CODE HAS BEEN UPDATED                                            
071900             MOVE PC-TSYMSG-00059  TO DP020-MSG-NUMBER                    
072000             SET DP020-MSG-INFORMATIONAL TO TRUE                          
072200             PERFORM 2110-PREPARE-INTER-APPL-COMM                         
072400                                                                          
072500         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)                      
072520             MOVE ASC-POE-CODE        TO DK-POE-CODE                     9
072521             MOVE ASC-POE-STD-EDI-CDE TO DK-POE-STD-EDI-CDE               
072522             MOVE ASC-DCONSLR-ENT-ID  TO DK-ENT-ID                        
072530             PERFORM 4100-SELECT-POE                                      
072550             IF ASC-INVALID-POE-CODE OR                                   
072560                ASC-VALID-POE-CODE                                        
072561                 IF IMPOE-STAT-CDE = PC-I AND                             
072562                    NOT ASC-DEL-COMPLETE                                  
072563                     SET PS-ERROR                                         
072564                         DP020-MSG-FATAL   TO TRUE                        
072565                     MOVE PC-TSYMSG-00116  TO DP020-MSG-NUMBER            
072566                 ELSE                                                     
072600                     PERFORM 7000-DEL-POE-CODE                            
072700                     SET ASC-DEL-COMPLETE  TO TRUE                        
072800*THE POE CODE HAS BEEN DELETED                                            
072900                     MOVE PC-TSYMSG-00115                                 
072910                                    TO DP020-MSG-NUMBER                   
073000                     SET DP020-MSG-INFORMATIONAL TO TRUE                  
073200                     PERFORM 2110-PREPARE-INTER-APPL-COMM                 
073320                 END-IF                                                   
073324             END-IF                                                       
073325                                                                          
073400         WHEN DP020-SRC-AID = DP016-ENTER                                 
073500             CONTINUE                                                     
073600                                                                          
073700         WHEN OTHER                                                       
073800             SET DP013-NO-ROLLBACK                                        
073900                 DP013-XCTL-DISPLAY-RESTART                               
074000                 DP013-CICS-ABEND  TO TRUE                                
074100             MOVE '2100-CHECK-FUNCTION-KEY'                               
074200                                   TO DP013-PARAGRAPH                     
074300             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'              
074400                                   TO DP013-MESSAGE-TEXT (1)              
074500             PERFORM DP013-0000-PROCESS-ABEND                             
074600     END-EVALUATE.                                                        
074700 EJECT                                                                    
074701                                                                          
074800******************************************************************       7
074900** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **       7
075000** INTER-APPLICATION COMMAREA.                                  **       7
075100******************************************************************       7
075200 2110-PREPARE-INTER-APPL-COMM.                                           7
075210                                                                          
075300      MOVE ASC-POE-CODE          TO TR022-POE-CODE.                      6
075400      MOVE DK-POE-STAT-CDE       TO TR022-STAT-CDE.                      3
075500      MOVE ASC-POE-CODE-DESC     TO TR022-POE-CODE-DESC.                 3
075600                                                                  07560017
075800******************************************************************07580017
075900*     GET THE NEXT MESSAGE IF A LIST OF MESSAGES IS BEING         07590017
076000*     PROCESSED.                                                  07600017
076100******************************************************************07610017
076300  2140-GET-NEXT-POE-CODE.                                         07630023
076400                                                                  07640017
076500      ADD +1                       TO ASC-SEL-SUB.                07650017
076510                                                                          
076600      IF  ASC-SEL-SUB > TR023-MAX-ITEMS                           07660023
076700          ADD +1                   TO ASC-SEL-ITEM                07670017
076800          MOVE +1                  TO ASC-SEL-SUB                 07680017
076900      END-IF.                                                     07690017
076910                                                                          
077000      IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS               07700017
077100          PERFORM 9100-READ-SEL-QUEUE                             07710017
077200          IF  TR023-ITEM (ASC-SEL-SUB) > ZERO                     07720023
077300              MOVE TR023-POE-CODE (ASC-SEL-SUB)                   07730023
077400                              TO ASC-POE-CODE                     07740023
077410              MOVE TR023-POE-STD-EDI-CDE (ASC-SEL-SUB)                    
077420                              TO ASC-POE-STD-EDI-CDE                      
077430              MOVE TR023-POE-NAME (ASC-SEL-SUB)                           
077440                              TO ASC-POE-CODE-DESC                        
077450              MOVE TR023-POE-CITY-NAME (ASC-SEL-SUB)                      
077460                              TO ASC-POE-CITY-NAME                        
077470              MOVE TR023-POE-STATE-CODE (ASC-SEL-SUB)                     
077480                              TO ASC-POE-STATE-CODE                       
077490              MOVE TR023-DCONSLR-SCAC (ASC-SEL-SUB)                       
077491                              TO ASC-DCONSLR-SCAC                         
077492              MOVE TR023-DCONSLR-ENT-ID (ASC-SEL-SUB)                     
077493                              TO ASC-DCONSLR-ENT-ID                       
077494              MOVE TR023-ALLOWED-ON-PO (ASC-SEL-SUB)                      
077495                              TO ASC-ALLOWED-ON-PO                        
077496              MOVE TR023-TRIP-TYP-CDE (ASC-SEL-SUB)                       
077497                              TO ASC-TRIP-TYP-CDE                         
077498              MOVE TR023-IATA-CDE (ASC-SEL-SUB)                           
077499                              TO ASC-IATA-CDE                             
077500              SET TR023-INQ (ASC-SEL-SUB) TO TRUE                 07750023
077800              PERFORM 9200-REWRITE-SEL-QUEUE                      07780017
077900          ELSE                                                    07790017
078000              SUBTRACT +1 FROM ASC-SEL-SUB                        07800017
078100*            --- BOTTOM OF LIST ---                               07810017
078200              MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER            07820017
078300              SET DP020-MSG-INFORMATIONAL TO TRUE                 07830017
078400              SET PS-LIST-END             TO TRUE                 07840017
078500          END-IF                                                  07850017
078600      ELSE                                                        07860017
078700          SUBTRACT +1 FROM ASC-SEL-ITEM                           07870017
078800          MOVE TR023-MAX-ITEMS     TO ASC-SEL-SUB                 07880023
078900          MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER            07890017
079000          SET DP020-MSG-INFORMATIONAL TO TRUE                     07900017
079100          SET PS-LIST-END             TO TRUE                     07910017
079200      END-IF.                                                     07920017
079300                                                                  07930017
079400******************************************************************07940017
079500*     GET THE PREVIOUS MESSAGE IF A LIST OF MESSAGES IS BEING    *07950017
079600*     PROCESSED.                                                 *07960017
079700******************************************************************07970017
079900  2150-GET-PREV-POE-CODE.                                         07990023
080000                                                                  08000017
080100      SUBTRACT +1 FROM ASC-SEL-SUB.                               08010017
080110                                                                          
080200      IF  ASC-SEL-SUB < +1                                        08020017
080300          SUBTRACT +1 FROM ASC-SEL-ITEM                           08030017
080400          MOVE TR023-MAX-ITEMS     TO ASC-SEL-SUB                 08040023
080500      END-IF.                                                     08050017
080600                                                                  08060017
080700      IF  ASC-SEL-ITEM > ZERO                                     08070017
080800          PERFORM 9100-READ-SEL-QUEUE                             08080017
080900          MOVE TR023-POE-CODE (ASC-SEL-SUB)                       08090023
081000              TO ASC-POE-CODE                                     08100023
081100          MOVE TR023-POE-NAME (ASC-SEL-SUB)                       08110023
081200              TO ASC-POE-CODE-DESC                                08120023
081500          MOVE TR023-POE-CITY-NAME (ASC-SEL-SUB)                  08150023
081600              TO ASC-POE-CITY-NAME                                08160023
081610          MOVE TR023-POE-STATE-CODE (ASC-SEL-SUB)                 08161023
081620              TO ASC-POE-STATE-CODE                               08162023
081900          MOVE TR023-DCONSLR-ENT-ID (ASC-SEL-SUB)                 08190023
082000              TO ASC-DCONSLR-ENT-ID                               08200023
082700          MOVE TR023-POE-STD-EDI-CDE (ASC-SEL-SUB)                08270023
082800              TO ASC-POE-STD-EDI-CDE                              08280023
082810          MOVE TR023-ALLOWED-ON-PO (ASC-SEL-SUB)                          
082820              TO ASC-ALLOWED-ON-PO                                        
082830          MOVE TR023-TRIP-TYP-CDE (ASC-SEL-SUB)                           
082840              TO ASC-TRIP-TYP-CDE                                         
082850          MOVE TR023-IATA-CDE (ASC-SEL-SUB)                               
082860              TO ASC-IATA-CDE                                             
082900      ELSE                                                        08290017
083000          MOVE +1                  TO ASC-SEL-ITEM                08300017
083100                                      ASC-SEL-SUB                 08310017
083200*        --- TOP OF LIST ---                                      08320017
083300          MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER            08330017
083400          SET DP020-MSG-INFORMATIONAL TO TRUE                     08340017
083500          SET PS-LIST-END             TO TRUE                     08350017
083600      END-IF.                                                     08360017
083800/                                                                 08380017
084300******************************************************************08430017
084400* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*08440017
084500* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *08450017
084600* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *08460017
084700******************************************************************08470017
084900 2200-MOVE-SCREEN-TO-COMMAREA.                                    08490017
085000                                                                  08500017
085010     IF  APOECODL > ZERO                                          08501023
085020         MOVE APOECODI             TO ASC-POE-CODE                08502023
085040     ELSE                                                         08504023
085050         IF  APOECODF = DP015-ERASE-EOF                           08505023
085060             MOVE SPACE            TO ASC-POE-CODE                08506023
085080         END-IF                                                   08508023
085090     END-IF.                                                      08509023
085091                                                                  08509123
085900     IF  AEDICODL > ZERO                                          08590017
086000         MOVE AEDICODI             TO ASC-POE-STD-EDI-CDE         08600023
086200     ELSE                                                         08620017
086300         IF  AEDICODF = DP015-ERASE-EOF                           08630017
086400             MOVE SPACE            TO ASC-POE-STD-EDI-CDE         08640023
086600         END-IF                                                   08660017
086700     END-IF.                                                      08670017
086800                                                                  08680017
086801     IF  ADCNSLCL > ZERO                                          09050023
086802         MOVE ADCNSLCI             TO ASC-DCONSLR-SCAC            09060023
086803     ELSE                                                         09080017
086804         IF  ADCNSLCF = DP015-ERASE-EOF                           09090023
086805             MOVE SPACE            TO ASC-DCONSLR-SCAC            09100023
086806         END-IF                                                   09120017
086807     END-IF.                                                      09130017
086808                                                                  09140017
086810     IF  AIATACDL > ZERO                                          08590017
086820         MOVE AIATACDI             TO ASC-IATA-CDE                08600023
086830     ELSE                                                         08620017
086840         IF  AIATACDF = DP015-ERASE-EOF                           08630017
086850             MOVE SPACE            TO ASC-IATA-CDE                08640023
086860         END-IF                                                   08660017
086870     END-IF.                                                      08670017
086880                                                                  08680017
086900     IF  APOECTYL > ZERO                                          08690023
087000         MOVE APOECTYI             TO ASC-POE-CITY-NAME           08700023
087100     ELSE                                                         08710017
087200         IF  APOECTYF = DP015-ERASE-EOF                           08720023
087300             MOVE SPACE            TO ASC-POE-CITY-NAME           08730023
087400         END-IF                                                   08740017
087500     END-IF.                                                      08750017
087600                                                                  08760017
087800     IF  APOESTAL > ZERO                                          08780023
087900         MOVE APOESTAI             TO ASC-POE-STATE-CODE          08790023
088000     ELSE                                                         08800023
088100         IF  APOESTAF = DP015-ERASE-EOF                           08810023
088200             MOVE SPACE            TO ASC-POE-STATE-CODE          08820023
088300         END-IF                                                   08830023
088400     END-IF.                                                      08840023
088500                                                                  08850023
089500     IF  APOEDESL > ZERO                                          08950023
089600         MOVE APOEDESI             TO ASC-POE-CODE-DESC           08960023
089800     ELSE                                                         08980017
089900         IF  APOEDESF = DP015-ERASE-EOF                           08990023
090000             MOVE SPACE            TO ASC-POE-CODE-DESC           09000023
090200         END-IF                                                   09020017
090300     END-IF.                                                      09030017
090400                                                                  09040017
090410     IF  ATRPTYPL > ZERO                                          08950023
090420         MOVE ATRPTYPI             TO ASC-TRIP-TYP-CDE            08960023
090430     ELSE                                                         08980017
090440         IF  ATRPTYPF = DP015-ERASE-EOF                           08990023
090450             MOVE SPACE            TO ASC-TRIP-TYP-CDE            09000023
090460         END-IF                                                   09020017
090470     END-IF.                                                      09030017
090480                                                                  09040017
090490     IF  AALWDPOL > ZERO                                          09050023
090491         MOVE AALWDPOI             TO ASC-ALLOWED-ON-PO           09060023
090492     ELSE                                                         09080017
090493         IF  AALWDPOF = DP015-ERASE-EOF                           09090023
090494             MOVE SPACE            TO ASC-ALLOWED-ON-PO           09100023
090495         END-IF                                                   09120017
090496     END-IF.                                                      09130017
090497                                                                  09140017
093600******************************************************************09360017
093700* PERFORM EDITS ON EACH FIELD ENTERED BY THE USER.  IF AN ERROR  *09370017
093800* IS FOUND THE CURSOR IS POSITIONED AT THAT FIELD AND AN         *09380017
093900* APPROPRIATE ERROR MESSAGE IS DISPLAYED.                        *09390017
094000******************************************************************09400017
094200 3000-EDIT-DATA-IN-COMMAREA.                                      09420017
094210                                                                          
094300     PERFORM 3200-RESET-ATTRIBUTES.                               09430017
094400                                                                  09440017
094500     EVALUATE TRUE                                                09450017
094510         WHEN ASC-DEL-FROM-LIST                                           
094520           PERFORM 3100-DEL-FROM-LIST                                     
094530                                                                          
094600         WHEN ASC-UPD-POE                                         09460020
104800           PERFORM 3110-UPD-POE                                           
104820                                                                          
107600         WHEN ASC-DEL-POE                                                 
107610           PERFORM 3105-DEL-POE                                           
109200                                                                          
109300         WHEN ASC-ADD-POE                                                 
109500           IF TR022-NUMBER-OF-TS-ITEMS < +1                               
109510               PERFORM 3115-ADD-POE-NO-ITEMS                              
109520           ELSE                                                           
109530               PERFORM 3120-ADD-POE-WITH-ITEMS                            
109540           END-IF                                                         
109600                                                                          
157700         WHEN ASC-UPD-POE                                         15770021
157800             CONTINUE                                             15780017
157900                                                                  15790017
158000         WHEN ASC-UPD-FROM-LIST                                   15800017
158100             PERFORM 3130-UPD-FROM-LIST                                   
170000                                                                  17000017
170100         WHEN ASC-ADD-FROM-LIST                                           
170200             PERFORM 3140-ADD-FROM-LIST                                   
183300     END-EVALUATE.                                                18330017
183400                                                                  18340017
183500     IF DP020-MSG-NUMBER > SPACES                                 18350017
183600        CONTINUE                                                  18360017
183700     ELSE                                                         18370017
183800       SET DP030-SET-CURSOR-APPL-1   TO TRUE                      18380017
183810       IF ASC-UPD-POE                                                     
183820           MOVE -1                   TO AIATACDL                          
183830       ELSE                                                               
183900           MOVE -1                   TO APOECODL                          
183910       END-IF                                                             
184000     END-IF.                                                      18400017
184100                                                                  18410017
184202 3100-DEL-FROM-LIST.                                                      
184204                                                                          
184236     IF ASC-DCONSLR-SCAC > SPACES OR                                      
184237        ASC-DCONSLR-SCAC = SPACES                                         
184239         MOVE ASC-DCONSLR-SCAC      TO DK-ENT-NAME (1:4)                  
184240                                                                          
184241         PERFORM 4330-SELECT-ENTNME                                       
184242                                                                          
184243         IF ENTNME-ENT-NAME-DESC = SPACES OR                              
184244            ASC-DCONSLR-SCAC = SPACES OR                                  
184245            ASC-DCONSLR-SCAC = LOW-VALUES                                 
184246             PERFORM 8055-DCONSLR-INVALID-ERROR                           
184257         ELSE                                                             
184258             PERFORM 8062-DCONSLR-VALID-BL                                
184263         END-IF                                                           
184264         MOVE ASC-DCONSLR-NAME      TO ADCNSLNO                           
184265     END-IF.                                                              
184266                                                                          
184316 3105-DEL-POE.                                                            
184317                                                                          
184318     MOVE ASC-POE-CODE       TO DK-POE-CODE.                              
184319     MOVE ASC-POE-CODE-DESC  TO APOEDESO.                                 
184320     IF ASC-POE-CODE-DESC = SPACE                                         
184321         PERFORM 8000-POE-CODE-INVALID-ERROR                              
184322     END-IF.                                                              
184323                                                                          
184324 3110-UPD-POE.                                                            
184325                                                                          
184350     IF ASC-ALLOWED-ON-PO = PC-N OR                                       
184351        ASC-ALLOWED-ON-PO = PC-Y                                          
184352         PERFORM 8070-ALLOWED-ON-PO-VALID                                 
184353     ELSE                                                                 
184354         PERFORM 8065-ALLOWED-ON-PO-INVALID-ERR                           
184355     END-IF.                                                              
184356                                                                          
184357     IF ASC-TRIP-TYP-CDE = PC-A OR                                        
184358        ASC-TRIP-TYP-CDE = PC-O OR                                        
184359        ASC-TRIP-TYP-CDE = PC-M                                           
184360         PERFORM 8080-TRIP-TYP-CDE-VALID                                  
184361     ELSE                                                                 
184362         PERFORM 8075-TRIP-TYP-CDE-INVALID-ERR                            
184363     END-IF.                                                              
184364                                                                          
184365     IF ASC-POE-CODE-DESC = SPACES                                        
184366         PERFORM 8045-POE-NAME-INVALID-ERROR                              
184367     ELSE                                                                 
184368         PERFORM 8050-POE-NAME-VALID                                      
184369     END-IF.                                                              
184370                                                                          
184371     IF ASC-POE-STATE-CODE = SPACES                                       
184372         PERFORM 8035-POE-STATE-INVALID-ERROR                             
184373     ELSE                                                                 
184374         PERFORM 8040-POE-STATE-VALID                                     
184375     END-IF.                                                              
184376                                                                          
184377     IF ASC-POE-CITY-NAME = SPACES                                        
184378         PERFORM 8025-POE-CITY-INVALID-ERROR                              
184379     ELSE                                                                 
184380         PERFORM 8030-POE-CITY-VALID                                      
184381     END-IF.                                                              
184382                                                                          
184389     IF ASC-IATA-CDE > SPACES OR                                          
184390        ASC-IATA-CDE = SPACES                                             
184393         PERFORM 8090-IATA-CDE-VALID                                      
184394     END-IF.                                                              
184395                                                                          
184396     IF ASC-DCONSLR-SCAC > SPACES OR                                      
184397        ASC-DCONSLR-SCAC = SPACES                                         
184398         MOVE ASC-DCONSLR-SCAC      TO DK-ENT-NAME (1:4)                  
184399         PERFORM 4330-SELECT-ENTNME                                       
184400         MOVE ENTNME-ENT-ID         TO ASC-DCONSLR-ENT-ID                 
184401         MOVE ENTNME-ENT-NAME-DESC  TO ASC-DCONSLR-NAME                   
184402                                       ADCNSLNO                           
184403     END-IF.                                                              
184426                                                                          
184427 3115-ADD-POE-NO-ITEMS.                                                   
184428                                                                          
184430     MOVE ASC-ALLOWED-ON-PO TO TR022-ALLOWED-ON-PO.                       
184431     IF ASC-ALLOWED-ON-PO = PC-N OR                                       
184432        ASC-ALLOWED-ON-PO = PC-Y                                          
184433         PERFORM 8070-ALLOWED-ON-PO-VALID                                 
184434     ELSE                                                                 
184435         PERFORM 8065-ALLOWED-ON-PO-INVALID-ERR                           
184436     END-IF.                                                              
184437                                                                          
184438     MOVE ASC-TRIP-TYP-CDE TO TR022-TRIP-TYP-CDE.                         
184439     IF ASC-TRIP-TYP-CDE = PC-A OR                                        
184440        ASC-TRIP-TYP-CDE = PC-O OR                                        
184441        ASC-TRIP-TYP-CDE = PC-M                                           
184442         PERFORM 8080-TRIP-TYP-CDE-VALID                                  
184443     ELSE                                                                 
184444         PERFORM 8075-TRIP-TYP-CDE-INVALID-ERR                            
184445     END-IF.                                                              
184446                                                                          
184447     MOVE ASC-POE-CODE-DESC TO TR022-POE-CODE-DESC.                       
184448     IF ASC-POE-CODE-DESC = SPACES                                        
184449         PERFORM 8045-POE-NAME-INVALID-ERROR                              
184450     ELSE                                                                 
184451         PERFORM 8050-POE-NAME-VALID                                      
184452     END-IF.                                                              
184453                                                                          
184454     MOVE ASC-POE-STATE-CODE TO TR022-POE-STATE-CODE.                     
184455     IF ASC-POE-STATE-CODE = SPACES                                       
184456         PERFORM 8035-POE-STATE-INVALID-ERROR                             
184457     ELSE                                                                 
184458         PERFORM 8040-POE-STATE-VALID                                     
184459     END-IF.                                                              
184460                                                                          
184461     MOVE ASC-POE-CITY-NAME TO TR022-POE-CITY-NAME.                       
184462     IF ASC-POE-CITY-NAME = SPACES                                        
184463         PERFORM 8025-POE-CITY-INVALID-ERROR                              
184464     ELSE                                                                 
184465         PERFORM 8030-POE-CITY-VALID                                      
184466     END-IF.                                                              
184467                                                                          
184475     MOVE ASC-IATA-CDE TO TR022-IATA-CDE.                                 
184476     IF ASC-IATA-CDE > SPACES OR                                          
184477        ASC-IATA-CDE = SPACES                                             
184478         PERFORM 8090-IATA-CDE-VALID                                      
184479     END-IF.                                                              
184480                                                                          
184481     IF ASC-DCONSLR-SCAC > SPACES OR                                      
184482        ASC-DCONSLR-SCAC = SPACES                                         
184483         MOVE ASC-DCONSLR-SCAC      TO DK-ENT-NAME (1:4)                  
184484         PERFORM 4330-SELECT-ENTNME                                       
184485                                                                          
184486             IF ENTNME-ENT-NAME-DESC = SPACES OR                          
184487                ASC-DCONSLR-SCAC = SPACES OR                              
184488                ASC-DCONSLR-SCAC = LOW-VALUES                             
184489                 PERFORM 8055-DCONSLR-INVALID-ERROR                       
184490             ELSE                                                         
184492                 MOVE ENTNME-ENT-ID TO TR022-DCONSLR-ENT-ID               
184493                                       ASC-DCONSLR-ENT-ID                 
184494                 MOVE ENTNME-ENT-NAME-DESC TO ASC-DCONSLR-NAME            
184497                 MOVE DP015-GREEN     TO ADCNSLCC                         
184498                 MOVE DP015-UNDERLINE TO ADCNSLCH                         
184499             END-IF                                                       
184500         MOVE ASC-DCONSLR-NAME      TO ADCNSLNO                           
184501     END-IF.                                                              
184502                                                                          
184503     MOVE ASC-POE-STD-EDI-CDE TO TR022-POE-STD-EDI-CDE.                   
184504     IF ASC-POE-STD-EDI-CDE = SPACES                                      
184505         PERFORM 8015-EDI-CODE-INVALID-ERROR                              
184506     ELSE                                                                 
184508         MOVE DP015-GREEN            TO AEDICODC                          
184509         MOVE DP015-UNDERLINE        TO AEDICODH                          
184510     END-IF.                                                              
184511                                                                          
184512     IF  ASC-POE-CODE > SPACE                                             
184513          MOVE ASC-POE-CODE        TO DK-POE-CODE                        9
184514                                      TR022-POE-CODE                      
184515          MOVE ASC-POE-STD-EDI-CDE TO DK-POE-STD-EDI-CDE                  
184516                                      TR022-POE-STD-EDI-CDE               
184517          MOVE ASC-DCONSLR-ENT-ID  TO DK-ENT-ID                           
184518                                      TR022-DCONSLR-ENT-ID                
184519          PERFORM 4100-SELECT-POE                                         
184520          IF ASC-VALID-POE-CODE                                           
184521             IF IMPOE-STAT-CDE = PC-I                                     
184522                 SET PS-NO-ERROR TO TRUE                                  
184523                 MOVE ZEROES     TO  APOECODL                             
184524                                     AEDICODL                             
184525                                     ADCNSLCL                             
184526                                     AIATACDL                             
184527                                     APOECTYL                             
184528                                     APOESTAL                             
184529                                     APOEDESL                             
184530                                     ATRPTYPL                             
184531                                     AALWDPOL                             
184532                 PERFORM 3200-RESET-ATTRIBUTES                            
184533                 PERFORM 3300-OVERLAY-ADD-DATA                            
184534                 MOVE +1 TO TR022-NUMBER-OF-TS-ITEMS                      
184535                 SET DP030-SET-CURSOR-APPL-1 TO TRUE                      
184538             END-IF                                                       
184539          ELSE                                                            
184540              MOVE DP015-UNDERLINE  TO APOECODH                           
184541          END-IF                                                          
184542     ELSE                                                                 
184543         PERFORM 8000-POE-CODE-INVALID-ERROR                              
184544     END-IF.                                                              
184545                                                                          
184546 3120-ADD-POE-WITH-ITEMS.                                                 
184550                                                                          
184552     IF ASC-ALLOWED-ON-PO = PC-N OR                                       
184553        ASC-ALLOWED-ON-PO = PC-Y                                          
184554         PERFORM 8072-ALLOWED-ON-PO-VALID-BL                              
184555     ELSE                                                                 
184556         PERFORM 8065-ALLOWED-ON-PO-INVALID-ERR                           
184557     END-IF.                                                              
184558                                                                          
184559     IF ASC-TRIP-TYP-CDE = PC-A OR                                        
184560        ASC-TRIP-TYP-CDE = PC-O OR                                        
184561        ASC-TRIP-TYP-CDE = PC-M                                           
184562         PERFORM 8082-TRIP-TYP-CDE-VALID-BL                               
184563     ELSE                                                                 
184564         PERFORM 8075-TRIP-TYP-CDE-INVALID-ERR                            
184565     END-IF.                                                              
184566                                                                          
184567     IF ASC-POE-CODE-DESC = SPACES                                        
184568         PERFORM 8045-POE-NAME-INVALID-ERROR                              
184569     ELSE                                                                 
184570         PERFORM 8052-POE-NAME-VALID-BL                                   
184571     END-IF.                                                              
184572                                                                          
184573     IF ASC-POE-STATE-CODE = SPACES                                       
184574         PERFORM 8035-POE-STATE-INVALID-ERROR                             
184575     ELSE                                                                 
184576         PERFORM 8042-POE-STATE-VALID-BL                                  
184577     END-IF.                                                              
184578                                                                          
184579     IF ASC-POE-CITY-NAME = SPACES                                        
184582         PERFORM 8025-POE-CITY-INVALID-ERROR                              
184583     ELSE                                                                 
184584         PERFORM 8032-POE-CITY-VALID-BL                                   
184585     END-IF.                                                              
184586                                                                          
184587     IF ASC-IATA-CDE > SPACES OR                                          
184588        ASC-IATA-CDE = SPACES                                             
184590         PERFORM 8092-IATA-CDE-VALID-BL                                   
184591     END-IF.                                                              
184592                                                                          
184599     IF ASC-DCONSLR-SCAC > SPACES OR                                      
184600        ASC-DCONSLR-SCAC = SPACES                                         
184601         MOVE ASC-DCONSLR-SCAC      TO DK-ENT-NAME (1:4)                  
184602         PERFORM 4330-SELECT-ENTNME                                       
184603                                                                          
184604         IF ENTNME-ENT-NAME-DESC = SPACES OR                              
184605            ASC-DCONSLR-SCAC = SPACES OR                                  
184606            ASC-DCONSLR-SCAC = LOW-VALUES                                 
184607             PERFORM 8055-DCONSLR-INVALID-ERROR                           
184608         ELSE                                                             
184609             PERFORM 8062-DCONSLR-VALID-BL                                
184610         END-IF                                                           
184611         MOVE ASC-DCONSLR-NAME      TO ADCNSLNO                           
184612     END-IF.                                                              
184613                                                                          
184614     IF ASC-POE-STD-EDI-CDE = SPACES                                      
184615         PERFORM 8015-EDI-CODE-INVALID-ERROR                              
184616     ELSE                                                                 
184617         PERFORM 8022-EDI-CODE-VALID-BL                                   
184618     END-IF.                                                              
184619                                                                          
184620     IF  ASC-POE-CODE > SPACE OR                                          
184621         ASC-POE-CODE = SPACE                                             
184622          MOVE ASC-POE-CODE        TO DK-POE-CODE                        9
184623          MOVE ASC-POE-STD-EDI-CDE TO DK-POE-STD-EDI-CDE                  
184624          MOVE ASC-DCONSLR-ENT-ID  TO DK-ENT-ID                           
184625          PERFORM 4100-SELECT-POE                                         
184626          IF ASC-INVALID-POE-CODE OR                                      
184627             ASC-POE-CODE = SPACE                                         
184628              PERFORM 8000-POE-CODE-INVALID-ERROR                         
184629          ELSE                                                            
184630              MOVE DP015-HL-OFF  TO APOECODH                              
184631          END-IF                                                          
184632     ELSE                                                                 
184633         PERFORM 8000-POE-CODE-INVALID-ERROR                              
184634     END-IF.                                                              
184635                                                                          
184636                                                                          
184637 3130-UPD-FROM-LIST.                                                      
184638                                                                          
184639     IF ASC-DCONSLR-SCAC > SPACES OR                                      
184640        ASC-DCONSLR-SCAC = SPACES                                         
184641         MOVE ASC-DCONSLR-SCAC      TO DK-ENT-NAME (1:4)                  
184642         PERFORM 4330-SELECT-ENTNME                                       
184643         IF ENTNME-ENT-NAME-DESC = SPACES OR                              
184644            ASC-DCONSLR-SCAC = SPACES OR                                  
184645            ASC-DCONSLR-SCAC = LOW-VALUES                                 
184646             PERFORM 8055-DCONSLR-INVALID-ERROR                           
184647         ELSE                                                             
184648             PERFORM 8060-DCONSLR-VALID                                   
184649         END-IF                                                           
184650         MOVE ASC-DCONSLR-NAME      TO ADCNSLNO                           
184651     END-IF.                                                              
184652                                                                          
184653 3140-ADD-FROM-LIST.                                                      
184654                                                                          
184655     MOVE TR022-POE-CODE        TO ASC-POE-CODE                           
184656                                   DK-POE-CODE.                           
184657     MOVE TR022-POE-STD-EDI-CDE TO ASC-POE-STD-EDI-CDE                    
184658                                   DK-POE-STD-EDI-CDE.                    
184659     MOVE TR022-DCONSLR-ENT-ID  TO ASC-DCONSLR-ENT-ID                     
184660                                   DK-ENT-ID.                             
184661     PERFORM 4100-SELECT-POE.                                             
184662                                                                          
184663     IF ASC-INVALID-POE-CODE OR                                           
184664        DK-POE-CODE = SPACES                                              
184665         PERFORM 8000-POE-CODE-INVALID-ERROR                              
184666     ELSE                                                                 
184667         PERFORM 8005-POE-CODE-VALID                                      
184668     END-IF.                                                              
184669                                                                          
184670     IF ASC-INACTIVE-POE-CODE                                             
184671         PERFORM 8010-POE-CODE-INACTIVE-ERROR                             
184672         MOVE SPACES TO IMPOE-POE-NM                                      
184673     END-IF.                                                              
184674                                                                          
184675     MOVE ASC-POE-CITY-NAME        TO APOEDESO.                           
184676     MOVE ASC-POE-STATE-CODE       TO APOESTAO.                           
184677     MOVE ASC-POE-CODE-DESC        TO APOEDESO.                           
184678                                                                          
184679     MOVE DP015-BLUE               TO APOECODC                            
184680                                      AEDICODC                            
184681                                      ADCNSLCC.                           
184682     MOVE DP015-GREEN              TO APOEDESC                            
184683                                      AIATACDC                            
184684                                      APOECTYC                            
184685                                      APOESTAC                            
184686                                      APOEDESC                            
184687                                      ATRPTYPC                            
184688                                      AALWDPOC.                           
184689     MOVE DP015-PRO-NOR-OFF        TO APOECODA                            
184690                                      AEDICODA                            
184691                                      ADCNSLCA.                           
184692     MOVE DP015-UNP-ALP-NOR-OFF    TO AIATACDA                            
184693                                      APOECTYA                            
184694                                      APOESTAA                            
184695                                      APOEDESA                            
184696                                      ATRPTYPA                            
184697                                      AALWDPOA.                           
184698     MOVE DP015-UNDERLINE          TO AIATACDH                            
184699                                      APOECTYH                            
184700                                      APOESTAH                            
184701                                      APOEDESH                            
184702                                      ATRPTYPH                            
184703                                      AALWDPOH.                           
184710     SET ASC-ADD-POE               TO TRUE.                               
184711                                                                          
184712 3200-RESET-ATTRIBUTES.                                                   
184713                                                                          
184714     EVALUATE TRUE                                                18440017
184720         WHEN ASC-ADD-COMPLETE                                    18450017
184800             MOVE DP015-PRO-NOR-OFF        TO APOECODA            18580017
184900                                              AEDICODA            18490017
184901                                              ADCNSLCA            18670021
184902                                              AIATACDA                    
184910                                              APOECTYA            18640021
184911                                              APOESTAA            18661021
184920                                              APOEDESA            18610017
184930                                              ATRPTYPA                    
184940                                              AALWDPOA                    
184960             MOVE DP015-BLUE               TO APOECODC            18590017
185000                                              AEDICODC            18500017
185001                                              ADCNSLCC            18680021
185002                                              AIATACDC                    
185010                                              APOECTYC            18650021
185011                                              APOESTAC            18662021
185020                                              APOEDESC            18620017
185030                                              ATRPTYPC                    
185040                                              AALWDPOC                    
185060             MOVE DP015-HL-OFF             TO APOECODH            18600017
185100                                              AEDICODH            18510017
185110                                              ADCNSLCH            18690021
185200                                              AIATACDH                    
186600                                              APOECTYH            18660021
186630                                              APOESTAH            18663021
186640                                              APOEDESH            18630017
186650                                              ATRPTYPH                    
186660                                              AALWDPOH                    
187300*            SET ASC-ADD-PENDING TO TRUE                          18730017
187400                                                                  18740017
187500         WHEN ASC-ADD-POE                                         18750021
187600             IF TR022-NUMBER-OF-TS-ITEMS = ZERO                   18760021
188100                 MOVE DP015-GREEN              TO APOECODC        18810017
188101                                                  AEDICODC        18780017
188102                                                  ADCNSLCC        18820021
188103                                                  AIATACDC                
188104                                                  APOECTYC        18790021
188110                                                  APOESTAC        18811021
188120                                                  APOEDESC                
188130                                                  ATRPTYPC                
188140                                                  AALWDPOC                
188400                 MOVE DP015-UNDERLINE          TO APOECODH        18840021
188410                                                  AEDICODH                
188420                                                  ADCNSLCH                
188500                 SET DP030-SET-CURSOR-APPL-1   TO TRUE            18850017
188700             ELSE                                                 18870017
188800                 MOVE DP015-BLUE               TO APOECODC        18960017
189000                                                  AEDICODC        18900017
189001                                                  ADCNSLCC        18980021
189002                                                  AIATACDC                
189010                                                  APOECTYC        18920021
189020                                                  APOESTAC        18940021
189030                                                  APOEDESC                
189031                                                  ATRPTYPC                
189032                                                  AALWDPOC                
189300                 MOVE DP015-HL-OFF             TO APOECTYH        18930021
189410                                                  AIATACDH                
189500                                                  APOESTAH        18950021
189700                                                  APOECODH        18970017
189800                                                  APOEDESH                
189810                                                  ATRPTYPH                
189820                                                  AALWDPOH                
190200                 SET DP030-SET-CURSOR-APPL-1   TO TRUE            19020017
190300             END-IF                                               19030017
190400                                                                  19040017
190500             IF TR022-NUMBER-OF-TS-ITEMS > ZERO                   19050021
190501                 MOVE DP015-BLUE               TO APOECODC        19190017
190510                                                  AEDICODC        19130017
190511                                                  ADCNSLCC        19220021
190520                                                  AIATACDC                
190600                                                  APOECTYC        19060021
190610                                                  APOESTAC        19090021
190611                                                  APOEDESC                
190612                                                  ATRPTYPC                
190613                                                  AALWDPOC                
190622                 MOVE DP015-PRO-NOR-OFF        TO APOECODA        19180017
190630                                                  AEDICODA        19120017
190631                                                  ADCNSLCA        19210021
190640                                                  AIATACDA                
190700                                                  APOECTYA        19070021
190710                                                  APOESTAA        19100021
190711                                                  APOEDESA                
190712                                                  ATRPTYPA                
190713                                                  AALWDPOA                
190730                 MOVE DP015-HL-OFF             TO APOECODH        19200017
190740                                                  AEDICODH        19140017
190741                                                  ADCNSLCH        19230021
190750                                                  AIATACDH                
190800                                                  APOECTYH        19080021
191100                                                  APOESTAH        19110021
191200                                                  APOEDESH        19270021
191300                                                  ATRPTYPH                
191400                                                  AALWDPOH                
193000             END-IF                                               19300017
193100                                                                  19310017
193200         WHEN ASC-UPD-POE                                         19320021
193210             MOVE DP015-BLUE               TO APOECODC            19430017
193211                                              AEDICODC                    
193212                                              ADCNSLCC                    
193220             MOVE DP015-GREEN              TO AIATACDC                    
193230                                              APOECTYC            19490021
193240                                              APOESTAC            19502021
193241                                              APOEDESC            19460017
193242                                              ATRPTYPC                    
193243                                              AALWDPOC                    
193260             MOVE DP015-PRO-NOR-OFF        TO APOECODA            19420017
193270                                              AEDICODA                    
193280                                              ADCNSLCA                    
193300             MOVE DP015-UNP-ALP-NOR-OFF    TO AIATACDA            19330017
193410                                              APOECTYA            19480021
193420                                              APOESTAA            19501021
193421                                              APOEDESA            19450017
193422                                              ATRPTYPA                    
193423                                              AALWDPOA                    
193440             MOVE DP015-HL-OFF             TO APOECODH            22341099
193450                                              AEDICODH                    
193460                                              ADCNSLCH                    
193500             MOVE DP015-UNDERLINE          TO AIATACDH            19350017
195000                                              APOECTYH            19500021
195030                                              APOESTAH            19503021
195040                                              APOEDESH            19470017
195050                                              ATRPTYPH                    
195060                                              AALWDPOH                    
195800             SET DP030-SET-CURSOR-APPL-1   TO TRUE                19580017
195900                                                                          
196000         WHEN ASC-DEL-POE                                         19600021
196100         WHEN ASC-DEL-FROM-LIST                                   19610017
196200             MOVE DP015-PRO-NOR-OFF        TO APOECODA            19620021
196300                                              AEDICODA            19680017
196301                                              ADCNSLCA            19710021
196310                                              AIATACDA                    
196400                                              APOECTYA            19640021
196500                                              APOESTAA            19650021
196600                                              APOEDESA            19630021
196700                                              ATRPTYPA                    
196800                                              AALWDPOA                    
197300             MOVE DP015-HL-OFF             TO APOECODH            19730021
197400                                              AEDICODH            19770017
197401                                              ADCNSLCH            19810021
197410                                              AIATACDH                    
197500                                              APOECTYH            19750021
197600                                              APOESTAH            19760021
198000                                              APOEDESH            19800017
198010                                              ATRPTYPH                    
198020                                              AALWDPOH                    
198300             MOVE DP015-BLUE               TO APOECODC            19830021
198310                                              AEDICODC            19890017
198311                                              ADCNSLCC            19920021
198320                                              AIATACDC                    
198700                                              APOECTYC            19870021
198800                                              APOESTAC            19880021
198900                                              APOEDESC            19840021
199000                                              ATRPTYPC                    
199100                                              AALWDPOC                    
199300                                                                          
199400             MOVE PC-TSYMSG-00004  TO DP020-MSG-NUMBER            19940017
199600             SET ASC-DEL-PENDING                                  19960017
199700                 DP020-MSG-INFORMATIONAL TO TRUE                          
199837             MOVE ASC-POE-CODE        TO DK-POE-CODE                      
199840             MOVE ASC-POE-STD-EDI-CDE TO DK-POE-STD-EDI-CDE               
199842             MOVE ASC-DCONSLR-ENT-ID  TO DK-ENT-ID                        
199844             PERFORM 4100-SELECT-POE                                      
199845             IF ASC-INVALID-POE-CODE OR                                   
199846                ASC-VALID-POE-CODE                                        
199847                IF IMPOE-STAT-CDE = PC-I                                  
199848                    SET PS-ERROR                                          
199849                        DP020-MSG-FATAL   TO TRUE                         
199850                    MOVE PC-TSYMSG-00116  TO DP020-MSG-NUMBER             
199851                END-IF                                                    
199852             END-IF                                                       
199860                                                                          
202700         WHEN OTHER                                                       
202701             MOVE DP015-PRO-NOR-OFF        TO APOECODA                    
202702                                              AEDICODA                    
202703                                              ADCNSLCA                    
202704                                              AIATACDA                    
202705                                              APOECTYA                    
202706                                              APOESTAA                    
202707                                              APOEDESA                    
202708                                              ATRPTYPA                    
202709                                              AALWDPOA                    
202711             MOVE DP015-BLUE               TO APOECODC                    
202712                                              AEDICODC                    
202713                                              ADCNSLCC                    
202714                                              AIATACDC                    
202715                                              APOECTYC                    
202716                                              APOESTAC                    
202717                                              APOEDESC                    
202718                                              ATRPTYPC                    
202719                                              AALWDPOC                    
202721             MOVE DP015-HL-OFF             TO APOECODH                    
202722                                              AEDICODH                    
202723                                              AIATACDH                    
202724                                              ADCNSLCH                    
202725                                              APOECTYH                    
202726                                              APOESTAH                    
202727                                              APOEDESH                    
202728                                              ATRPTYPH                    
202729                                              AALWDPOH                    
202810     END-EVALUATE.                                                        
202811                                                                          
202812 3300-OVERLAY-ADD-DATA.                                                   
202813                                                                          
202816     MOVE ZEROES                TO DP020-MSG-NUMBER.                      
202817                                                                          
202818     MOVE IMPOE-POE-CDE         TO ASC-POE-CODE                           
202819                                   APOECODO.                              
202820     MOVE IMPOE-POE-STD-EDI-CDE TO ASC-POE-STD-EDI-CDE                    
202821                                   AEDICODO.                              
202822     MOVE IMPOE-STD-IATA-CDE    TO ASC-IATA-CDE                           
202823                                   AIATACDO.                              
202824     MOVE IMPOE-POE-CTY-NM      TO ASC-POE-CITY-NAME                      
202825                                   APOECTYO.                              
202826     MOVE IMPOE-POE-ST-CDE      TO ASC-POE-STATE-CODE                     
202827                                   APOESTAO.                              
202828     MOVE IMPOE-POE-NM          TO ASC-POE-CODE-DESC                      
202829                                   APOEDESO.                              
202830     MOVE IMPOE-TRIP-TYP-CDE    TO ASC-TRIP-TYP-CDE                       
202831                                   ATRPTYPO.                              
202832     MOVE IMPOE-PO-ASGMT-ALWD-IND TO ASC-ALLOWED-ON-PO                    
202833                                   AALWDPOO.                              
202834                                                                          
202835     MOVE DP015-BLUE            TO APOECODC                               
202836                                   AEDICODC                               
202837                                   ADCNSLCC                               
202838                                   AIATACDC                               
202839                                   APOECTYC                               
202840                                   APOESTAC                               
202841                                   APOEDESC                               
202842                                   ATRPTYPC                               
202843                                   AALWDPOC.                              
202845     MOVE DP015-PRO-NOR-OFF     TO APOECODA                               
202846                                   AEDICODA                               
202847                                   ADCNSLCA                               
202848                                   AIATACDA                               
202849                                   APOECTYA                               
202850                                   APOESTAA                               
202851                                   APOEDESA                               
202852                                   ATRPTYPA                               
202853                                   AALWDPOA.                              
202855     MOVE DP015-HL-OFF          TO APOECODH                               
202856                                   AEDICODH                               
202857                                   ADCNSLCH                               
202858                                   AIATACDH                               
202859                                   APOECTYH                               
202860                                   APOESTAH                               
202861                                   APOEDESH                               
202862                                   ATRPTYPH                               
202863                                   AALWDPOH.                              
202870                                                                          
202885     MOVE IMPOE-DCONSLR-ENT-ID TO ASC-DCONSLR-ENT-ID                      
202887                                  DK-ENT-ID.                              
202888                                                                          
202889     PERFORM 4331-SELECT-ENTNME-ENT.                                      
202890                                                                          
202891     MOVE EXTENT-SCAC-CDE       TO ASC-DCONSLR-SCAC.                      
202892                                                                          
202893     MOVE ENTNME-ENT-NAME-DESC  TO ADCNSLNO                               
202894                                   ASC-DCONSLR-NAME.                      
202895                                                                          
202896     MOVE DP015-PRO-NOR-OFF     TO ADCNSLCA.                              
202897     MOVE DP015-BLUE            TO ADCNSLCC.                              
202898     MOVE DP015-HL-OFF          TO ADCNSLCH.                              
202899                                                                          
202911     MOVE IMPOE-POE-CDE         TO ASC-POE-CODE                           
202912                                   DK-POE-CODE                            
202913                                   APOECODO.                              
202914     MOVE DP015-PRO-NOR-OFF     TO APOECODA.                              
202915     MOVE DP015-BLUE            TO APOECODC.                              
202916     MOVE DP015-HL-OFF          TO APOECODH.                              
202917                                                                          
202919     PERFORM 4100-SELECT-POE.                                             
202920                                                                          
202921     IF ASC-INVALID-POE-CODE OR                                           
202922        DK-POE-CODE = SPACE                                               
202923         PERFORM 8000-POE-CODE-INVALID-ERROR                              
202935     ELSE                                                                 
202936         MOVE DP015-BLUE               TO APOECODC                        
202937         MOVE DP015-BLUE               TO APOEDESC                        
202938         MOVE DP015-PRO-NOR-OFF        TO APOECODA                        
202939         MOVE DP015-PRO-NOR-OFF        TO APOEDESA                        
202940         MOVE DP015-HL-OFF             TO APOECODH                        
202941         MOVE DP015-HL-OFF             TO APOEDESH                        
202942     END-IF.                                                              
202943                                                                          
202944     IF ASC-INACTIVE-POE-CODE                                             
202945         PERFORM 8010-POE-CODE-INACTIVE-ERROR                             
202956     END-IF.                                                              
202957                                                                          
202960******************************************************************20290017
203000* GET THE NEXT AVAILABLE MESSAGE NUMBER, MOVE IT TO THE SCREEN   *20300017
203100* AND POSITION THE CURSOR FOR THE INITIAL PANEL.                 *20310017
203200******************************************************************20320017
203400 4000-BUILD-INITIAL-PANEL.                                        20340017
203500                                                                  20350017
203510     IF ASC-DEL-POE                                                       
203520         PERFORM 4005-DEL-POE                                             
203521     END-IF.                                                              
203530                                                                          
203600     IF ASC-UPD-POE                                               20360021
203800         PERFORM 4010-UPD-POE                                             
203900     END-IF.                                                              
210100                                                                          
210200     IF ASC-ADD-POE AND                                                   
210300        TR022-NUMBER-OF-TS-ITEMS > ZERO                                   
210400         PERFORM 4020-ADD-POE                                             
210500     END-IF.                                                              
229400                                                                          
229500     IF ASC-ADD-POE                                                       
229600       IF TR022-NUMBER-OF-TS-ITEMS = ZERO                                 
229610           PERFORM 4030-ADD-POE-NO-RECORDS                                
229620       ELSE                                                               
229630           PERFORM 4040-ADD-POE-WITH-RECORDS                              
229631       END-IF                                                             
229640     END-IF.                                                              
245500                                                                          
245547     IF ASC-DEL-FROM-LIST                                                 
245548         MOVE DP015-PRO-NOR-OFF        TO APOECODA                        
245549                                          AEDICODA                        
245550                                          ADCNSLCA                        
245551                                          AIATACDA                        
245552                                          APOECTYA                        
245553                                          APOESTAA                        
245554                                          APOEDESA                        
245555                                          ATRPTYPA                        
245556                                          AALWDPOA                        
245558         MOVE DP015-HL-OFF             TO APOECODH                        
245559                                          AEDICODH                        
245560                                          ADCNSLCH                        
245561                                          AIATACDH                        
245562                                          APOECTYH                        
245563                                          APOESTAH                        
245564                                          APOEDESH                        
245565                                          ATRPTYPH                        
245566                                          AALWDPOH                        
245568         MOVE DP015-BLUE               TO APOECODC                        
245569                                          AEDICODC                        
245570                                          ADCNSLCC                        
245571                                          AIATACDC                        
245572                                          APOECTYC                        
245573                                          APOESTAC                        
245574                                          APOEDESC                        
245575                                          ATRPTYPC                        
245576                                          AALWDPOC                        
245593     END-IF.                                                              
245594                                                                          
245700     PERFORM 7580-MOVE-COMMAREA-TO-SCREEN.                                
246900                                                                          
246902 4005-DEL-POE.                                                            
246903                                                                          
246938     MOVE ASC-POE-CODE        TO DK-POE-CODE                              
246939                                 APOECODO                                 
246943     MOVE ASC-POE-STD-EDI-CDE TO DK-POE-STD-EDI-CDE                       
246944                                 AEDICODO                                 
246945     MOVE ASC-DCONSLR-ENT-ID  TO DK-ENT-ID                                
246946                                 ADCNSLCO                                 
246947                                                                          
246948     IF ASC-POE-CODE > SPACES OR                                          
246949        ASC-POE-CODE = SPACES                                             
246950         PERFORM 4100-SELECT-POE                                          
246963     END-IF.                                                              
246964                                                                          
246965     MOVE ASC-POE-CODE-DESC  TO APOEDESO.                                 
246970                                                                          
247000 4010-UPD-POE.                                                            
247010                                                                          
247102                                                                          
247110     MOVE ASC-POE-CODE       TO APOECODO.                                 
249400     MOVE ASC-POE-CODE-DESC  TO APOEDESO.                                 
249500     MOVE ASC-POE-CITY-NAME  TO APOECTYO.                                 
249600     MOVE ASC-POE-STATE-CODE TO APOESTAO.                                 
249610     MOVE ASC-POE-CODE-DESC  TO APOEDESO.                                 
249620     MOVE ASC-IATA-CDE       TO AIATACDO.                                 
249630     MOVE ASC-TRIP-TYP-CDE   TO ATRPTYPO.                                 
249640     MOVE ASC-ALLOWED-ON-PO  TO AALWDPOO.                                 
249800                                                                          
249900 4020-ADD-POE.                                                            
249910                                                                          
250010     MOVE ASC-POE-CODE        TO DK-POE-CODE                              
250011                                 TR022-POE-CODE.                          
250013     MOVE ASC-POE-STD-EDI-CDE TO DK-POE-STD-EDI-CDE                       
250014                                 TR022-POE-STD-EDI-CDE.                   
250015     MOVE ASC-DCONSLR-ENT-ID  TO DK-ENT-ID                                
250016                                 TR022-DCONSLR-ENT-ID.                    
250072     PERFORM 4100-SELECT-POE.                                             
250073                                                                          
250080     IF ASC-INVALID-POE-CODE                                              
250081         PERFORM 8000-POE-CODE-INVALID-ERROR                              
250099     ELSE                                                                 
250100         PERFORM 8005-POE-CODE-VALID                                      
250106     END-IF.                                                              
250108                                                                          
250109     MOVE ASC-POE-STD-EDI-CDE TO TR022-POE-STD-EDI-CDE.                   
250120     IF ASC-POE-STD-EDI-CDE = SPACES                                      
250130         PERFORM 8015-EDI-CODE-INVALID-ERROR                              
250650     ELSE                                                                 
250651         PERFORM 8020-EDI-CODE-VALID                                      
250680     END-IF.                                                              
250690                                                                          
250691     IF ASC-DCONSLR-SCAC > SPACES OR                                      
250692        ASC-DCONSLR-SCAC = SPACES                                         
250693         MOVE ASC-DCONSLR-SCAC      TO DK-ENT-NAME (1:4)                  
250694         PERFORM 4330-SELECT-ENTNME                                       
250695         IF ENTNME-ENT-NAME-DESC = SPACES OR                              
250696            ASC-DCONSLR-SCAC = SPACES OR                                  
250697            ASC-DCONSLR-SCAC = LOW-VALUES                                 
250698             PERFORM 8055-DCONSLR-INVALID-ERROR                           
250699         ELSE                                                             
250700             PERFORM 8060-DCONSLR-VALID                                   
250701         END-IF                                                           
250702         MOVE ASC-DCONSLR-NAME         TO ADCNSLNO                        
250703     END-IF.                                                              
250704                                                                          
250705     MOVE ASC-IATA-CDE TO TR022-IATA-CDE.                                 
250706     IF ASC-IATA-CDE > SPACES OR                                          
250707        ASC-IATA-CDE = SPACES                                             
250712         PERFORM 8090-IATA-CDE-VALID                                      
250713     END-IF.                                                              
250714                                                                          
250715     MOVE ASC-POE-CITY-NAME TO TR022-POE-CITY-NAME.                       
250717     IF ASC-POE-CITY-NAME = SPACES                                        
250718         PERFORM 8025-POE-CITY-INVALID-ERROR                              
250719     ELSE                                                                 
250720         PERFORM 8030-POE-CITY-VALID                                      
250721     END-IF.                                                              
250722                                                                          
250723     MOVE ASC-POE-STATE-CODE TO TR022-POE-STATE-CODE.                     
250725     IF ASC-POE-STATE-CODE = SPACES                                       
250726         PERFORM 8035-POE-STATE-INVALID-ERROR                             
250727     ELSE                                                                 
250728         PERFORM 8040-POE-STATE-VALID                                     
250729     END-IF.                                                              
250730                                                                          
250731     MOVE ASC-POE-CODE-DESC TO TR022-POE-CODE-DESC.                       
250733     IF ASC-POE-CODE-DESC = SPACES                                        
250734         PERFORM 8045-POE-NAME-INVALID-ERROR                              
250735     ELSE                                                                 
250736         PERFORM 8050-POE-NAME-VALID                                      
250737     END-IF.                                                              
250738                                                                          
250739     MOVE ASC-TRIP-TYP-CDE TO TR022-TRIP-TYP-CDE.                         
250740     IF ASC-TRIP-TYP-CDE = PC-A OR                                        
250741        ASC-TRIP-TYP-CDE = PC-O OR                                        
250742        ASC-TRIP-TYP-CDE = PC-M                                           
250743         PERFORM 8080-TRIP-TYP-CDE-VALID                                  
250744     ELSE                                                                 
250745         PERFORM 8075-TRIP-TYP-CDE-INVALID-ERR                            
250746     END-IF.                                                              
250747                                                                          
250748     MOVE ASC-ALLOWED-ON-PO TO TR022-ALLOWED-ON-PO.                       
250749     IF ASC-ALLOWED-ON-PO = PC-N OR                                       
250750        ASC-ALLOWED-ON-PO = PC-Y                                          
250751         PERFORM 8070-ALLOWED-ON-PO-VALID                                 
250752     ELSE                                                                 
250753         PERFORM 8065-ALLOWED-ON-PO-INVALID-ERR                           
250754     END-IF.                                                              
250755                                                                          
250771 4030-ADD-POE-NO-RECORDS.                                                 
250772                                                                          
250773     MOVE DP015-GREEN              TO APOECODC                            
250774                                      AEDICODC                            
250775                                      ADCNSLCC                            
250776                                      AIATACDC                            
250777                                      APOECTYC                            
250778                                      APOESTAC                            
250779                                      APOEDESC                            
250780                                      ATRPTYPC                            
250781                                      AALWDPOC.                           
250783     MOVE DP015-UNP-ALP-NOR-OFF    TO APOECODA                            
250784                                      AEDICODA                            
250785                                      ADCNSLCA                            
250786                                      AIATACDA                            
250787                                      APOECTYA                            
250788                                      APOESTAA                            
250789                                      APOEDESA                            
250790                                      ATRPTYPA                            
250791                                      AALWDPOA.                           
250793     MOVE DP015-UNDERLINE          TO APOECODH                            
250794                                      AEDICODH                            
250795                                      ADCNSLCH                            
250796                                      AIATACDH                            
250797                                      APOECTYH                            
250798                                      APOESTAH                            
250799                                      APOEDESH                            
250800                                      ATRPTYPH                            
250801                                      AALWDPOH.                           
250803     MOVE -1                       TO APOECODL.                           
250804     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                               
250805                                                                          
250806 4040-ADD-POE-WITH-RECORDS.                                               
250810                                                                          
250828     IF DP015-RED = APOECODC                                              
250829         CONTINUE                                                         
250830     ELSE                                                                 
250831         MOVE DP015-PRO-NOR-OFF      TO APOECODA                          
250832         MOVE DP015-BLUE             TO APOECODC                          
250833         MOVE DP015-HL-OFF           TO APOECODH                          
250834     END-IF.                                                              
250835                                                                          
250836     IF DP015-RED = AEDICODC                                              
250837         CONTINUE                                                         
250838     ELSE                                                                 
250839         MOVE DP015-PRO-NOR-OFF      TO AEDICODA                          
250840         MOVE DP015-BLUE             TO AEDICODC                          
250841         MOVE DP015-HL-OFF           TO AEDICODH                          
250842     END-IF.                                                              
250843                                                                          
250844     IF DP015-RED = ADCNSLCC                                              
250845         CONTINUE                                                         
250846     ELSE                                                                 
250847         MOVE DP015-PRO-NOR-OFF      TO ADCNSLCA                          
250848         MOVE DP015-BLUE             TO ADCNSLCC                          
250849         MOVE DP015-HL-OFF           TO ADCNSLCH                          
250850     END-IF.                                                              
250851                                                                          
250852     IF DP015-RED = AIATACDC                                              
250853         CONTINUE                                                         
250854     ELSE                                                                 
250855         MOVE DP015-PRO-NOR-OFF      TO AIATACDA                          
250856         MOVE DP015-BLUE             TO AIATACDC                          
250857         MOVE DP015-HL-OFF           TO AIATACDH                          
250858     END-IF.                                                              
250859                                                                          
250860     IF DP015-RED = APOECTYC                                              
250861         CONTINUE                                                         
250862     ELSE                                                                 
250863         MOVE DP015-PRO-NOR-OFF      TO APOECTYA                          
250864         MOVE DP015-BLUE             TO APOECTYC                          
250865         MOVE DP015-HL-OFF           TO APOECTYH                          
250866     END-IF.                                                              
250867                                                                          
250868     IF DP015-RED = APOESTAC                                              
250869         CONTINUE                                                         
250870     ELSE                                                                 
250871         MOVE DP015-PRO-NOR-OFF      TO APOESTAA                          
250872         MOVE DP015-BLUE             TO APOESTAC                          
250873         MOVE DP015-HL-OFF           TO APOESTAH                          
250874     END-IF.                                                              
250875                                                                          
250876     IF DP015-RED = APOEDESC                                              
250877         CONTINUE                                                         
250878     ELSE                                                                 
250879         MOVE DP015-PRO-NOR-OFF      TO APOEDESA                          
250880         MOVE DP015-BLUE             TO APOEDESC                          
250881         MOVE DP015-HL-OFF           TO APOEDESH                          
250882     END-IF.                                                              
250883                                                                          
250884     IF DP015-RED = ATRPTYPC                                              
250885         CONTINUE                                                         
250886     ELSE                                                                 
250887         MOVE DP015-PRO-NOR-OFF      TO ATRPTYPA                          
250888         MOVE DP015-BLUE             TO ATRPTYPC                          
250889         MOVE DP015-HL-OFF           TO ATRPTYPH                          
250890     END-IF.                                                              
250891                                                                          
250892     IF DP015-RED = AALWDPOC                                              
250893         CONTINUE                                                         
250894     ELSE                                                                 
250895         MOVE DP015-PRO-NOR-OFF      TO AALWDPOA                          
250896         MOVE DP015-BLUE             TO AALWDPOC                          
250897         MOVE DP015-HL-OFF           TO AALWDPOH                          
250898     END-IF.                                                              
250899                                                                          
250901 4100-SELECT-POE.                                                         
250902                                                                          
250910     EXEC SQL                                                             
251000         SELECT  A.POE_CDE                                                
251001               , A.DCONSLR_ENT_ID                                         
251002               , A.POE_STD_EDI_CDE                                        
251003               , A.POE_CTY_NM                                             
251010               , A.POE_ST_CDE                                             
251020               , A.POE_NM                                                 
251030               , A.STAT_CDE                                               
251040               , A.TRIP_TYP_CDE                                           
251050               , A.PO_ASGMT_ALWD_IND                                      
251060               , A.STD_IATA_CDE                                           
251100            INTO :IMPOE-POE-CDE                                           
251101               , :IMPOE-DCONSLR-ENT-ID                                    
251102               , :IMPOE-POE-STD-EDI-CDE                                   
251103               , :IMPOE-POE-CTY-NM                                        
251110               , :IMPOE-POE-ST-CDE                                        
251120               , :IMPOE-POE-NM                                            
251130               , :IMPOE-STAT-CDE                                          
251140               , :IMPOE-TRIP-TYP-CDE                                      
251150               , :IMPOE-PO-ASGMT-ALWD-IND                                 
251160               , :IMPOE-STD-IATA-CDE                                      
251200             FROM TIMPOE A                                                
251300             WHERE A.POE_CDE         = :DK-POE-CODE                       
251400               AND A.STAT_CDE        IN (:PC-A, :PC-I)                    
251410               AND A.POE_STD_EDI_CDE = :DK-POE-STD-EDI-CDE                
251420               AND A.DCONSLR_ENT_ID  = :DK-ENT-ID                         
251500     END-EXEC                                                             
251600                                                                          
251700         EVALUATE TRUE                                                    
251800             WHEN SQLCODE = ZERO                                          
251810             WHEN SQLCODE = -811                                          
251900                 SET ASC-VALID-POE-CODE     TO TRUE                       
252800             WHEN SQLCODE = +100                                          
252900                 SET ASC-INVALID-POE-CODE   TO TRUE                       
253200             WHEN OTHER                                                   
253300                 MOVE '4100-SELECT-POE    '                               
253400                                   TO DP013-PARAGRAPH                     
253500                 MOVE 'SQL ERROR SELECTING POE NAME    '                  
253600                                   TO DP013-MESSAGE-TEXT (1)              
253700                 MOVE SQLCA        TO DP013-SQLCA                         
253800                 MOVE 'TIMPOE  '   TO DP013-DB2-TABLE-NAME (1)            
253900                 SET DP013-DB2-ABEND                                      
254000                     DP013-XCTL-DISPLAY-RESTART TO TRUE                   
254100                 PERFORM DP013-0000-PROCESS-ABEND                         
254200      END-EVALUATE.                                                       
254300                                                                          
254400 EJECT                                                                    
264200                                                                          
264300 4330-SELECT-ENTNME.                                                      
264400                                                                  26440017
264500     EXEC SQL                                                     26450017
264600         SELECT A.ENT_ID,                                         26460017
264700                A.ENT_NAME_DESC                                   26470017
264800            INTO :ENTNME-ENT-ID,                                  26480017
264900                 :ENTNME-ENT-NAME-DESC                            26490017
265000             FROM TENTNME A,                                      26500017
265100                  TEXTENT B                                       26510017
265200             WHERE A.ENT_ID = B.ENT_ID                            26520017
265300               AND B.SCAC_CDE LIKE :DK-ENT-NAME                   26530017
265400               AND A.TYPE_CDE = :PC-PRIMARY                       26540017
265500     END-EXEC                                                     26550017
265600                                                                  26560017
265700         EVALUATE TRUE                                            26570017
265800             WHEN SQLCODE = ZERO                                  26580017
265900             WHEN SQLCODE = -811                                  26590017
266000                 CONTINUE                                         26600017
266100             WHEN SQLCODE = +100                                  26610017
266200                 SET PS-ERROR                                     26620017
266300                        DP020-MSG-FATAL   TO TRUE                 26630017
266400                 MOVE ZEROES TO ENTNME-ENT-ID                     26640017
266500                 MOVE SPACES TO ENTNME-ENT-NAME-DESC              26650017
266600                 CONTINUE                                         26660017
266700             WHEN OTHER                                           26670017
266800                 MOVE '4330-SELECT-ENTNME'                        26680017
266900                                   TO DP013-PARAGRAPH             26690017
267000                 MOVE 'SQL ERROR SELECTING ENTNME NAME'           26700017
267100                                   TO DP013-MESSAGE-TEXT (1)      26710017
267200                 MOVE SQLCA        TO DP013-SQLCA                 26720017
267300                 MOVE 'TENTNME '   TO DP013-DB2-TABLE-NAME (1)    26730017
267400                 SET DP013-DB2-ABEND                              26740017
267500                     DP013-XCTL-DISPLAY-RESTART TO TRUE           26750017
267600                 PERFORM DP013-0000-PROCESS-ABEND                 26760017
267700         END-EVALUATE.                                            26770017
267800                                                                  26780017
268020 EJECT                                                            26800017
268030                                                                          
268040 4331-SELECT-ENTNME-ENT.                                                  
268050                                                                          
268060     EXEC SQL                                                             
268070         SELECT B.SCAC_CDE                                                
268071              , A.ENT_ID                                                  
268080              , A.ENT_NAME_DESC                                           
268090            INTO :EXTENT-SCAC-CDE,                                        
268091                 :ENTNME-ENT-ID,                                          
268092                 :ENTNME-ENT-NAME-DESC                                    
268093             FROM TENTNME A,                                              
268094                  TEXTENT B                                               
268095             WHERE A.ENT_ID = B.ENT_ID                                    
268096               AND A.ENT_ID = :DK-ENT-ID                                  
268097               AND A.TYPE_CDE = :PC-PRIMARY                               
268098     END-EXEC                                                             
268099                                                                          
268100         EVALUATE TRUE                                                    
268101             WHEN SQLCODE = ZERO                                          
268102             WHEN SQLCODE = -811                                          
268103                 CONTINUE                                                 
268104             WHEN SQLCODE = +100                                          
268108                 MOVE SPACES TO EXTENT-SCAC-CDE                           
268109                 MOVE SPACES TO ENTNME-ENT-NAME-DESC                      
268110                 CONTINUE                                                 
268111             WHEN OTHER                                                   
268112                 MOVE '4331-SELECT-ENTNME-ENT'                            
268113                                   TO DP013-PARAGRAPH                     
268114                 MOVE 'SQL ERROR SELECTING ENTNME NAME'                   
268115                                   TO DP013-MESSAGE-TEXT (1)              
268116                 MOVE SQLCA        TO DP013-SQLCA                         
268117                 MOVE 'TENTNME '   TO DP013-DB2-TABLE-NAME (1)            
268118                 SET DP013-DB2-ABEND                                      
268119                     DP013-XCTL-DISPLAY-RESTART TO TRUE                   
268120                 PERFORM DP013-0000-PROCESS-ABEND                         
268121         END-EVALUATE.                                                    
268122                                                                          
269900 EJECT                                                            26990017
270000******************************************************************27000017
270100* CREATE THE PORT OF ENTRY CODE ON THE TIMPOE TABLE.             *27010025
270200******************************************************************27020017
270300 5000-ADD-POE-CODE.                                               27030025
270400                                                                          
270500     MOVE PC-A    TO DK-POE-STAT-CDE.                                     
270600                                                                          
270900     PERFORM 5100-UPDATE-POE-CODE.                                27090025
271000                                                                  27100017
271100     IF  ASC-USE-SEL-QUEUE                                        27110017
271200         PERFORM 5200-UPDATE-SELECTION-QUEUE                      27120017
271300     END-IF.                                                      27130017
271310                                                                          
271400******************************************************************27140017
271500* INSERT A ROW INTO THE TIMPOE TABLE.                            *27150025
271600******************************************************************27160017
271700 5100-UPDATE-POE-CODE.                                            27170025
271800                                                                  27180017
271801     PERFORM 7570-MOVE-ASC-TO-IMPOE.                                      
272600     MOVE PC-A                 TO IMPOE-STAT-CDE.                 27260025
272700     MOVE PC-I                 TO DK-STAT-CDE.                    27270025
272800                                                                  27280017
272900     EXEC SQL                                                     27290017
273000       UPDATE TIMPOE                                                      
273100         SET  POE_STD_EDI_CDE   = :IMPOE-POE-STD-EDI-CDE                  
273110            , POE_CDE           = :IMPOE-POE-CDE                          
273120            , POE_NM            = :IMPOE-POE-NM                           
273200            , POE_CTY_NM        = :IMPOE-POE-CTY-NM                       
273210            , POE_ST_CDE        = :IMPOE-POE-ST-CDE                       
273400            , DCONSLR_ENT_ID    = :IMPOE-DCONSLR-ENT-ID                   
273700            , STAT_CDE          = :IMPOE-STAT-CDE                         
273710            , LAST_UPD_TMST     = CURRENT TIMESTAMP                       
273720            , LAST_UPD_USR_ID   = :IMPOE-LAST-UPD-USR-ID                  
273730            , TRIP_TYP_CDE      = :IMPOE-TRIP-TYP-CDE                     
273740            , PO_ASGMT_ALWD_IND = :IMPOE-PO-ASGMT-ALWD-IND                
273750            , STD_IATA_CDE      = :IMPOE-STD-IATA-CDE                     
273800       WHERE  POE_CDE         = :IMPOE-POE-CDE                            
273900         AND  STAT_CDE        = :DK-STAT-CDE                              
273910         AND  POE_STD_EDI_CDE = :IMPOE-POE-STD-EDI-CDE                    
273920         AND  DCONSLR_ENT_ID  = :IMPOE-DCONSLR-ENT-ID                     
274000     END-EXEC.                                                            
274100                                                                  27410017
274200                                                                  27420017
274300     EVALUATE TRUE                                                27430017
274400         WHEN SQLCODE = ZERO                                      27440017
274410         WHEN SQLCODE = -811                                      27440017
274500             MOVE 'U'    TO DK-FUNC-CDE                           27450017
274600             PERFORM 6200-UPDATE-AUDIT-POE-CODE                   27460023
274700             CONTINUE                                             27470017
274800         WHEN SQLCODE = +100                                      27480017
274900         WHEN SQLCODE = -803                                      27490017
275000             PERFORM 6010-ADD-INACTIVE-POE                        27500025
275100         WHEN SQLWARN0 NOT = SPACES                               27510017
275200         WHEN SQLCODE < ZERO                                      27520017
275300         WHEN SQLCODE > ZERO                                      27530017
275400             MOVE '5100-UDPATE-POE-CODE'                          27540025
275500                               TO DP013-PARAGRAPH                 27550017
275600             MOVE 'UPDATE A ROW INTO THE POE CODE TABLE'          27560025
275700                               TO DP013-MESSAGE-TEXT(1)           27570017
275800             MOVE SQLCA        TO DP013-SQLCA                     27580017
275900             MOVE 'TIMPOE'     TO DP013-DB2-TABLE-NAME (1)        27590025
276000             SET DP013-DB2-ABEND                                  27600017
276100                 DP013-XCTL-DISPLAY-RESTART TO TRUE               27610017
276200             PERFORM DP013-0000-PROCESS-ABEND                     27620017
276300     END-EVALUATE.                                                27630017
276400 EJECT                                                            27640017
276500                                                                  27650017
276600 5200-UPDATE-SELECTION-QUEUE.                                     27660017
276700                                                                  27670017
276800     PERFORM 9100-READ-SEL-QUEUE.                                 27680017
276900                                                                  27690017
277000     IF  ASC-DEL-COMPLETE                                         27700017
277100         SET TR023-DEL (ASC-SEL-SUB) TO TRUE                      27710023
277300         SET TR022-RECORD-UPDATED TO TRUE                         27730023
277700         MOVE 'A'           TO TR022-STAT-CDE                     27770023
277701         PERFORM 7560-MOVE-ASC-TO-TR023                                   
277800     ELSE                                                         27780017
277900         SET TR023-UPD (ASC-SEL-SUB) TO TRUE                      27790023
277910         PERFORM 7550-MOVE-ASC-TO-TR022                                   
277920         PERFORM 7560-MOVE-ASC-TO-TR023                                   
279700     END-IF.                                                      27970017
279800                                                                  27980017
279900     PERFORM 9200-REWRITE-SEL-QUEUE.                              27990017
280000                                                                  28000017
280100 6000-UPDATE-POE.                                                 28010023
280200                                                                  28020017
280300     MOVE 'A'                      TO DK-POE-STAT-CDE.                    
281000     PERFORM 6100-UPDATE-POE-CODE.                                28100025
281100     IF  ASC-USE-SEL-QUEUE                                        28110017
281200          PERFORM 5200-UPDATE-SELECTION-QUEUE                             
281300     END-IF.                                                      28130017
281400                                                                  28140017
281500 6010-ADD-INACTIVE-POE.                                           28150025
281600                                                                  28160017
281900     MOVE 'I'                      TO DK-STAT-CDE.                28190017
282000     MOVE 'A'                      TO DK-POE-STAT-CDE.                    
282100                                                                          
282200     PERFORM 6100-UPDATE-POE-CODE.                                28220025
282300                                                                  28230017
282400     IF ASC-POE-CODE-DESC = SPACE                                 28240025
282500         MOVE IMPOE-POE-NM  TO                                    28250025
282600             ASC-POE-CODE-DESC                                    28260025
282700             APOEDESO                                             28270025
282800     END-IF.                                                      28280017
282810                                                                  28281025
283500     IF  ASC-USE-SEL-QUEUE                                        28350017
283600         PERFORM 5200-UPDATE-SELECTION-QUEUE                      28360017
283700     END-IF.                                                      28370017
283800                                                                  28380017
283900******************************************************************28390017
284000* UPDATE A ROW IN THE TIMPOE TABLE.                              *28400025
284100******************************************************************28410017
284200 6100-UPDATE-POE-CODE.                                            28420025
284300                                                                  28430017
284301     PERFORM 7570-MOVE-ASC-TO-IMPOE.                                      
285100     MOVE 'A' TO DK-STAT-CDE.                                     28510025
285200                                                                  28520017
285300     EXEC SQL                                                     28530017
285400       UPDATE TIMPOE                                              28540025
285500         SET  POE_STD_EDI_CDE   = :IMPOE-POE-STD-EDI-CDE                  
285510            , POE_CDE           = :IMPOE-POE-CDE                          
285520            , POE_NM            = :IMPOE-POE-NM                           
285600            , POE_CTY_NM        = :IMPOE-POE-CTY-NM                       
285700            , POE_ST_CDE        = :IMPOE-POE-ST-CDE                       
285800            , DCONSLR_ENT_ID    = :IMPOE-DCONSLR-ENT-ID                   
285900            , LAST_UPD_TMST     = CURRENT TIMESTAMP                       
286000            , LAST_UPD_USR_ID   = :IMPOE-LAST-UPD-USR-ID                  
286010            , TRIP_TYP_CDE      = :IMPOE-TRIP-TYP-CDE                     
286020            , PO_ASGMT_ALWD_IND = :IMPOE-PO-ASGMT-ALWD-IND                
286030            , STD_IATA_CDE      = :IMPOE-STD-IATA-CDE                     
286210       WHERE  POE_CDE         = :IMPOE-POE-CDE                            
286220         AND  STAT_CDE        = :DK-STAT-CDE                              
286230         AND  POE_STD_EDI_CDE = :IMPOE-POE-STD-EDI-CDE                    
286240         AND  DCONSLR_ENT_ID  = :IMPOE-DCONSLR-ENT-ID                     
286300     END-EXEC.                                                    28630017
286400                                                                  28640017
286500     EVALUATE TRUE                                                28650017
286600         WHEN SQLCODE = ZERO                                      28660017
286610         WHEN SQLCODE = -811                                      28660017
286700             MOVE 'U' TO DK-FUNC-CDE                              28670017
286800             PERFORM 6200-UPDATE-AUDIT-POE-CODE                   28680023
286900             CONTINUE                                             28690017
287000         WHEN SQLCODE = +100                                      28700017
287100             PERFORM 6150-INSERT-POE-CODE                         28710025
287200         WHEN SQLWARN0 NOT = SPACES                               28720017
287300         WHEN SQLCODE < ZERO                                      28730017
287400         WHEN SQLCODE > ZERO                                      28740017
287500             MOVE '6100-UPDATE-POE-CODE'                          28750025
287600                               TO DP013-PARAGRAPH                 28760017
287700             MOVE 'UPDATE A ROW INTO THE POE CODE TABLE'          28770025
287800                               TO DP013-MESSAGE-TEXT(1)           28780017
287900             MOVE SQLCA        TO DP013-SQLCA                     28790017
288000             MOVE 'TIMPOE'     TO DP013-DB2-TABLE-NAME (1)        28800025
288100             SET DP013-DB2-ABEND                                  28810017
288200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               28820017
288300             PERFORM DP013-0000-PROCESS-ABEND                     28830017
288400     END-EVALUATE.                                                28840017
288600                                                                  28860017
288700******************************************************************28870017
288800* INSERT A ROW IN THE TIMPOE TABLE.                              *28880025
288900******************************************************************28890017
289000 6150-INSERT-POE-CODE.                                            28900025
289100                                                                  28910017
289101     PERFORM 7570-MOVE-ASC-TO-IMPOE.                                      
290000                                                                  29000017
290100     EXEC SQL                                                     29010017
290200                                                                  29020017
290300       INSERT INTO TIMPOE                                         29030025
290400             ( POE_CDE                                            29040025
290410              ,DCONSLR_ENT_ID                                     29041025
290500              ,POE_STD_EDI_CDE                                    29050025
290510              ,POE_NM                                             29051025
290600              ,POE_CTY_NM                                         29060025
290700              ,POE_ST_CDE                                         29070025
291100              ,STAT_CDE                                           29110017
291200              ,LAST_UPD_TMST                                      29120017
291300              ,LAST_UPD_USR_ID                                    29130017
291310              ,TRIP_TYP_CDE                                               
291320              ,PO_ASGMT_ALWD_IND                                          
291330              ,STD_IATA_CDE)                                              
291400       VALUES                                                     29140017
291500            ( :IMPOE-POE-CDE                                      29150025
291510            , :IMPOE-DCONSLR-ENT-ID                               29151025
291600            , :IMPOE-POE-STD-EDI-CDE                              29160025
291610            , :IMPOE-POE-NM                                       29161025
291700            , :IMPOE-POE-CTY-NM                                   29170025
291710            , :IMPOE-POE-ST-CDE                                   29171025
292200            , :PC-A                                               29220017
292300            ,  CURRENT TIMESTAMP                                  29230017
292400            , :IMPOE-LAST-UPD-USR-ID                              29240025
292410            , :IMPOE-TRIP-TYP-CDE                                         
292420            , :IMPOE-PO-ASGMT-ALWD-IND                                    
292430            , :IMPOE-STD-IATA-CDE)                                        
292500                                                                  29250017
292600     END-EXEC.                                                    29260017
292700                                                                  29270017
292800     EVALUATE TRUE                                                29280017
292900         WHEN SQLCODE = ZERO                                      29290017
293000             CONTINUE                                             29300017
293100         WHEN SQLWARN0 NOT = SPACES                               29310017
293200         WHEN SQLCODE < ZERO                                      29320017
293300         WHEN SQLCODE > ZERO                                      29330017
293400             MOVE '6150-INSERT-POE-CODE'                          29340025
293500                               TO DP013-PARAGRAPH                 29350017
293600             MOVE 'UPDATE A ROW INTO THE POE CODE TABLE'          29360025
293700                               TO DP013-MESSAGE-TEXT(1)           29370017
293800             MOVE SQLCA        TO DP013-SQLCA                     29380017
293900             MOVE 'TIMPOE'     TO DP013-DB2-TABLE-NAME (1)        29390025
294000             SET DP013-DB2-ABEND                                  29400017
294100                 DP013-XCTL-DISPLAY-RESTART TO TRUE               29410017
294200             PERFORM DP013-0000-PROCESS-ABEND                     29420017
294300     END-EVALUATE.                                                29430017
294400                                                                  29440017
294500******************************************************************29450017
294600* INSERT A ROW IN THE POE AUDIT TABLE.                           *29460022
294700******************************************************************29470017
294800 6200-UPDATE-AUDIT-POE-CODE.                                      29480022
294900                                                                  29490017
294910     MOVE TR022-POE-CODE        TO AUPOE-POE-CDE.                 29491023
294920     MOVE TR022-POE-CODE-DESC   TO AUPOE-POE-NM.                  29492023
295200     MOVE TR022-POE-CITY-NAME   TO AUPOE-POE-CTY-NM.              29520023
295210     MOVE TR022-POE-STATE-CODE  TO AUPOE-POE-ST-CDE.              29521023
295300     MOVE TR022-DCONSLR-ENT-ID  TO AUPOE-DCONSLR-ENT-ID.          29530023
295600     MOVE TR022-POE-STD-EDI-CDE TO AUPOE-POE-STD-EDI-CDE.         29560023
295601     MOVE TR022-IATA-CDE        TO AUPOE-STD-IATA-CDE.                    
295602     MOVE TR022-TRIP-TYP-CDE    TO AUPOE-TRIP-TYP-CDE.                    
295603     MOVE TR022-ALLOWED-ON-PO   TO AUPOE-PO-ASGMT-ALWD-IND.               
295604                                                                          
295700     MOVE DP020-USERID          TO AUPOE-LAST-UPD-USR-ID.                 
295800     MOVE DK-STAT-CDE           TO AUPOE-STAT-CDE.                        
295900     MOVE DK-FUNC-CDE           TO AUPOE-AUD-FUNC-CDE.                    
296000                                                                  29600017
296010     PERFORM 7550-MOVE-ASC-TO-TR022.                                      
296020                                                                          
296100     EXEC SQL                                                     29610017
296200       INSERT INTO TAUPOE                                         29620023
296300             ( POE_CDE                                            29630023
296310              ,DCONSLR_ENT_ID                                     29631023
296400              ,POE_STD_EDI_CDE                                    29640023
296410              ,POE_NM                                             29641023
296500              ,POE_CTY_NM                                         29650023
296600              ,POE_ST_CDE                                         29660023
297000              ,STAT_CDE                                           29700017
297100              ,LAST_UPD_TMST                                      29710017
297200              ,LAST_UPD_USR_ID                                    29720017
297300              ,AUD_FUNC_CDE                                       29730017
297310              ,TRIP_TYP_CDE                                               
297320              ,PO_ASGMT_ALWD_IND                                          
297330              ,STD_IATA_CDE)                                              
297400       VALUES                                                     29740017
297500            (:AUPOE-POE-CDE,                                      29750023
297510             :AUPOE-DCONSLR-ENT-ID,                               29751023
297600             :AUPOE-POE-STD-EDI-CDE,                              29760023
297610             :AUPOE-POE-NM,                                       29761023
297700             :AUPOE-POE-CTY-NM,                                   29770023
297800             :AUPOE-POE-ST-CDE,                                   29780023
298200             :AUPOE-STAT-CDE,                                     29820023
298300              CURRENT TIMESTAMP,                                  29830017
298400             :AUPOE-LAST-UPD-USR-ID,                              29840023
298500             :AUPOE-AUD-FUNC-CDE,                                 29850023
298510             :AUPOE-TRIP-TYP-CDE,                                         
298520             :AUPOE-PO-ASGMT-ALWD-IND,                                    
298530             :AUPOE-STD-IATA-CDE)                                         
298600     END-EXEC.                                                    29860017
298700                                                                  29870017
298800     EVALUATE TRUE                                                29880017
298900         WHEN SQLCODE = ZERO                                      29890017
299000             CONTINUE                                             29900017
299100         WHEN SQLWARN0 NOT = SPACES                               29910017
299200         WHEN SQLCODE < ZERO                                      29920017
299300         WHEN SQLCODE > ZERO                                      29930017
299400             MOVE '6200-UPDATE-AUDIT-POE-CODE'                    29940023
299500                               TO DP013-PARAGRAPH                 29950017
299600             MOVE 'UPDATE A ROW INTO AUDIT POE TABLE     '        29960023
299700                               TO DP013-MESSAGE-TEXT(1)           29970017
299800             MOVE SQLCA        TO DP013-SQLCA                     29980017
299900             MOVE 'TAUPOE'     TO DP013-DB2-TABLE-NAME (1)        29990023
300000             SET DP013-DB2-ABEND                                  30000017
300100                 DP013-XCTL-DISPLAY-RESTART TO TRUE               30010017
300200             PERFORM DP013-0000-PROCESS-ABEND                     30020017
300300     END-EVALUATE.                                                30030017
300400                                                                  30040017
300500 7000-DEL-POE-CODE.                                               30050022
300600                                                                          
300800     MOVE 'I'                      TO DK-POE-STAT-CDE.            30080022
301000     MOVE 'A'                      TO DK-STAT-CDE.                30100017
301100     MOVE 'D'                      TO DK-FUNC-CDE.                30110017
301200                                                                  30120017
301300     PERFORM 6200-UPDATE-AUDIT-POE-CODE.                          30130022
301400     PERFORM 7100-INACTIVATE-POE.                                 30140022
301500                                                                  30150017
301600     MOVE PC-TSYMSG-00115          TO DP020-MSG-NUMBER.           30160017
301700     SET DP020-MSG-INFORMATIONAL                                  30170017
301800         ASC-DEL-COMPLETE          TO TRUE.                       30180017
301900                                                                  30190017
302000     IF  ASC-USE-SEL-QUEUE                                        30200017
302100         PERFORM 5200-UPDATE-SELECTION-QUEUE                      30210017
302200     END-IF.                                                      30220017
302300                                                                  30230017
302500******************************************************************30250017
302600* INACTIVATE A ROW IN THE TIMPOE TABLE.                          *30260022
302700******************************************************************30270017
302800 7100-INACTIVATE-POE.                                             30280022
302900                                                                  30290017
303000     MOVE TR022-POE-CODE        TO IMPOE-POE-CDE.                         
303001     MOVE TR022-POE-STD-EDI-CDE TO IMPOE-POE-STD-EDI-CDE.                 
303002     MOVE TR022-DCONSLR-ENT-ID  TO IMPOE-DCONSLR-ENT-ID.                  
303010     MOVE DP020-USERID          TO IMPOE-LAST-UPD-USR-ID.                 
303100                                                                          
303200     EXEC SQL                                                             
303300       UPDATE TIMPOE                                                      
303400         SET  STAT_CDE         = :PC-I                                    
303500            , LAST_UPD_TMST = CURRENT TIMESTAMP                           
303600            , LAST_UPD_USR_ID = :IMPOE-LAST-UPD-USR-ID                    
303700       WHERE  POE_CDE         = :IMPOE-POE-CDE                            
303710         AND  POE_STD_EDI_CDE = :IMPOE-POE-STD-EDI-CDE                    
303720         AND  DCONSLR_ENT_ID  = :IMPOE-DCONSLR-ENT-ID                     
303800     END-EXEC.                                                            
303900                                                                          
304000     EVALUATE TRUE                                                        
304100         WHEN SQLCODE = ZERO                                      30410017
304110         WHEN SQLCODE = -811                                      30410017
304200             CONTINUE                                             30420017
304300         WHEN SQLWARN0 NOT = SPACES                               30430017
304400         WHEN SQLCODE < ZERO                                      30440017
304500         WHEN SQLCODE > ZERO                                      30450017
304600             MOVE '7100-INACTIVATE-POE'                           30460022
304700                               TO DP013-PARAGRAPH                 30470017
304800             MOVE 'UPDATE A ROW INTO THE POE CODE TABLE'          30480022
304900                               TO DP013-MESSAGE-TEXT(1)           30490017
305000             MOVE SQLCA        TO DP013-SQLCA                     30500017
305100             MOVE 'TIMPOE'     TO DP013-DB2-TABLE-NAME (1)        30510022
305200             SET DP013-DB2-ABEND                                  30520017
305300                 DP013-XCTL-DISPLAY-RESTART TO TRUE               30530017
305400             PERFORM DP013-0000-PROCESS-ABEND                     30540017
305500     END-EVALUATE.                                                30550017
305600 EJECT                                                            30560017
305700                                                                          
305701******************************************************************        
305702* MOVE INTER-APPLICATION COMM AREA FIELDS TO COMM AREA FIELDS.   *        
305703******************************************************************        
305710 7500-MOVE-TR022-TO-ASC.                                                  
305711                                                                          
305712     MOVE TR022-POE-CODE            TO ASC-POE-CODE.                      
305713     MOVE TR022-POE-CODE-DESC       TO ASC-POE-CODE-DESC.                 
305714     MOVE TR022-POE-CITY-NAME       TO ASC-POE-CITY-NAME.                 
305715     MOVE TR022-POE-STATE-CODE      TO ASC-POE-STATE-CODE.                
305716     MOVE TR022-DCONSLR-SCAC        TO ASC-DCONSLR-SCAC.                  
305717     MOVE TR022-DCONSLR-NAME        TO ASC-DCONSLR-NAME.                  
305718     MOVE TR022-DCONSLR-ENT-ID      TO ASC-DCONSLR-ENT-ID.                
305719     MOVE TR022-POE-STD-EDI-CDE     TO ASC-POE-STD-EDI-CDE.               
305720     MOVE TR022-IATA-CDE            TO ASC-IATA-CDE.                      
305721     MOVE TR022-TRIP-TYP-CDE        TO ASC-TRIP-TYP-CDE.                  
305722     MOVE TR022-ALLOWED-ON-PO       TO ASC-ALLOWED-ON-PO.                 
305723                                                                          
305724******************************************************************        
305725* MOVE COMM AREA FIELDS TO INTER-APPLICATION COMM AREA FIELDS.   *        
305726******************************************************************        
305727 7550-MOVE-ASC-TO-TR022.                                                  
305728                                                                          
305729     MOVE ASC-POE-CODE              TO TR022-POE-CODE.                    
305730     MOVE ASC-POE-CODE-DESC         TO TR022-POE-CODE-DESC.               
305731     MOVE ASC-POE-CITY-NAME         TO TR022-POE-CITY-NAME.               
305732     MOVE ASC-POE-STATE-CODE        TO TR022-POE-STATE-CODE.              
305733     MOVE ASC-DCONSLR-SCAC          TO TR022-DCONSLR-SCAC.                
305734     MOVE ASC-DCONSLR-NAME          TO TR022-DCONSLR-NAME.                
305735     MOVE ASC-DCONSLR-ENT-ID        TO TR022-DCONSLR-ENT-ID.              
305736     MOVE ASC-POE-STD-EDI-CDE       TO TR022-POE-STD-EDI-CDE.             
305737     MOVE ASC-IATA-CDE              TO TR022-IATA-CDE.                    
305738     MOVE ASC-TRIP-TYP-CDE          TO TR022-TRIP-TYP-CDE.                
305739     MOVE ASC-ALLOWED-ON-PO         TO TR022-ALLOWED-ON-PO.               
305740                                                                          
305741******************************************************************        
305742* MOVE COMM AREA FIELDS TO SELECTION TEMP STORAGE QUEUE FIELDS.  *        
305743******************************************************************        
305744 7560-MOVE-ASC-TO-TR023.                                                  
305745                                                                          
305748     MOVE ASC-POE-CODE-DESC   TO                                          
305749                              TR023-POE-NAME (ASC-SEL-SUB).               
305750     MOVE ASC-POE-CITY-NAME   TO                                          
305751                              TR023-POE-CITY-NAME (ASC-SEL-SUB).          
305752     MOVE ASC-POE-STATE-CODE  TO                                          
305753                              TR023-POE-STATE-CODE (ASC-SEL-SUB).         
305754     MOVE ASC-DCONSLR-SCAC    TO                                          
305755                              TR023-DCONSLR-SCAC (ASC-SEL-SUB).           
305756     MOVE ASC-DCONSLR-ENT-ID  TO                                          
305757                              TR023-DCONSLR-ENT-ID (ASC-SEL-SUB).         
305758     MOVE ASC-POE-STD-EDI-CDE TO                                          
305759                              TR023-POE-STD-EDI-CDE (ASC-SEL-SUB).        
305760     MOVE ASC-IATA-CDE        TO                                          
305761                              TR023-IATA-CDE (ASC-SEL-SUB).               
305762     MOVE ASC-TRIP-TYP-CDE    TO                                          
305763                              TR023-TRIP-TYP-CDE (ASC-SEL-SUB).           
305764     MOVE ASC-ALLOWED-ON-PO   TO                                          
305765                              TR023-ALLOWED-ON-PO (ASC-SEL-SUB).          
305766                                                                          
305767******************************************************************        
305768* MOVE COMM AREA FIELDS TO SELECTION POE TABLE FIELDS.           *        
305769******************************************************************        
305770 7570-MOVE-ASC-TO-IMPOE.                                                  
305771                                                                          
305772     MOVE ASC-POE-CODE         TO IMPOE-POE-CDE.                          
305773     MOVE ASC-POE-CODE-DESC    TO IMPOE-POE-NM.                           
305774     MOVE ASC-POE-CITY-NAME    TO IMPOE-POE-CTY-NM.                       
305775     MOVE ASC-POE-STATE-CODE   TO IMPOE-POE-ST-CDE.                       
305776     MOVE ASC-DCONSLR-ENT-ID   TO IMPOE-DCONSLR-ENT-ID.                   
305777     MOVE ASC-POE-STD-EDI-CDE  TO IMPOE-POE-STD-EDI-CDE.                  
305778     MOVE ASC-IATA-CDE         TO IMPOE-STD-IATA-CDE.                     
305779     MOVE ASC-TRIP-TYP-CDE     TO IMPOE-TRIP-TYP-CDE.                     
305780     MOVE ASC-ALLOWED-ON-PO    TO IMPOE-PO-ASGMT-ALWD-IND.                
305781     MOVE DP020-USERID         TO IMPOE-LAST-UPD-USR-ID.                  
305782                                                                          
305783******************************************************************        
305784*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *        
305785******************************************************************        
305786 7580-MOVE-COMMAREA-TO-SCREEN.                                            
305787                                                                          
305788     MOVE ASC-POE-CODE             TO APOECODO.                           
305789     MOVE ASC-POE-CODE-DESC        TO APOEDESO.                           
305790     MOVE ASC-POE-CITY-NAME        TO APOECTYO.                           
305791     MOVE ASC-POE-STATE-CODE       TO APOESTAO.                           
305792     MOVE ASC-DCONSLR-SCAC         TO ADCNSLCO.                           
305793     MOVE ASC-DCONSLR-NAME         TO ADCNSLNO.                           
305794     MOVE ASC-POE-STD-EDI-CDE      TO AEDICODO.                           
305795     MOVE ASC-IATA-CDE             TO AIATACDO.                           
305796     MOVE ASC-TRIP-TYP-CDE         TO ATRPTYPO.                           
305797     MOVE ASC-ALLOWED-ON-PO        TO AALWDPOO.                           
305798                                                                          
305799******************************************************************        
305800* INVALID PORT OF ENTRY (POE) CODE ERROR ROUTINE (1452).         *        
305801*           **  THE PORT CODE IS INVALID  **                     *        
305802******************************************************************        
305803 8000-POE-CODE-INVALID-ERROR.                                             
305804                                                                          
305805     SET PS-ERROR                                                         
305806         DP020-MSG-FATAL         TO TRUE.                                 
305807     MOVE PC-TSYMSG-01452        TO DP020-MSG-NUMBER.                     
305808     MOVE DP015-UNP-ALP-BRT-OFF  TO APOECODA.                             
305809     MOVE DP015-RED              TO APOECODC.                             
305810     MOVE DP015-REVERSE          TO APOECODH.                             
305811     MOVE -1                     TO APOECODL.                             
305812     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                                 
305813     MOVE SPACES                 TO IMPOE-POE-NM.                         
305814                                                                          
305815******************************************************************        
305817* NO LIST ITEMS FOUND   ERROR ROUTINE (00050).                   *        
305818*   **  NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED **   *        
305819******************************************************************        
305820 8002-POE-CODE-NO-LIST-ERROR.                                             
305821                                                                          
305822     SET PS-ERROR                                                         
305823         DP020-MSG-FATAL         TO TRUE.                                 
305824     MOVE PC-TSYMSG-00050        TO DP020-MSG-NUMBER.                     
305825     MOVE DP015-UNP-ALP-BRT-OFF  TO APOECODA.                             
305826     MOVE DP015-RED              TO APOECODC.                             
305827     MOVE DP015-REVERSE          TO APOECODH.                             
305828     MOVE -1                     TO APOECODL.                             
305829     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                                 
305830                                                                          
305831******************************************************************        
305832* SET ATTRIBUTES FOR VALID POE CODE.                             *        
305834******************************************************************        
305835 8005-POE-CODE-VALID.                                                     
305836                                                                          
305837     MOVE DP015-GREEN              TO APOECODC.                           
305838     MOVE DP015-BLUE               TO APOEDESC.                           
305839     MOVE DP015-UNP-ALP-BRT-OFF    TO APOECODA.                           
305840     MOVE DP015-PRO-NOR-OFF        TO APOEDESA.                           
305841     MOVE DP015-HL-OFF             TO APOEDESH.                           
305842                                                                          
305843******************************************************************        
305844* INACTIVE PORT OF ENTRY (POE) CODE ERROR ROUTINE (1644).        *        
305845*           **  CODE IS INACTIVE  **                             *        
305846******************************************************************        
305847 8010-POE-CODE-INACTIVE-ERROR.                                            
305848                                                                          
305849     SET PS-ERROR                                                         
305850         DP020-MSG-FATAL         TO TRUE.                                 
305851     MOVE PC-TSYMSG-01644        TO DP020-MSG-NUMBER.                     
305852     MOVE DP015-UNP-ALP-BRT-OFF  TO APOECODA.                             
305853     MOVE DP015-RED              TO APOECODC.                             
305854     MOVE DP015-REVERSE          TO APOECODH.                             
305855     MOVE -1                     TO APOECODL.                             
305856     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                                 
305857     MOVE SPACES                 TO IMPOE-POE-NM.                         
305858                                                                          
305859******************************************************************        
305860* SELECTED POE CODE IS ALREADY ACTIVE ERROR ROUTINE (1646).      *        
305861*           **  SELECTED CODE IS ALREADY ACTIVE  **              *        
305862******************************************************************        
305863 8012-POE-CODE-ALREADY-ACT-ERR.                                           
305864                                                                          
305865     SET PS-ERROR                                                         
305866         DP020-MSG-FATAL         TO TRUE.                                 
305867     MOVE PC-TSYMSG-01646        TO DP020-MSG-NUMBER.                     
305868     MOVE DP015-UNP-ALP-BRT-OFF  TO APOECODA.                             
305869     MOVE DP015-RED              TO APOECODC.                             
305870     MOVE DP015-REVERSE          TO APOECODH.                             
305871     MOVE -1                     TO APOECODL.                             
305872     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                                 
305873     MOVE SPACES                 TO IMPOE-POE-NM.                         
305874                                                                          
305875******************************************************************        
305876* INVALID POE STD EDI CODE ERROR ROUTINE (1450).                 *        
305877*           **  CODE IS INVALID   **                             *        
305878******************************************************************        
305879 8015-EDI-CODE-INVALID-ERROR.                                             
305880                                                                          
305881     SET PS-ERROR                                                         
305882         DP020-MSG-FATAL         TO TRUE.                                 
305883     MOVE PC-TSYMSG-01450        TO DP020-MSG-NUMBER.                     
305884     MOVE DP015-UNP-ALP-BRT-OFF  TO AEDICODA.                             
305885     MOVE DP015-RED              TO AEDICODC.                             
305886     MOVE DP015-REVERSE          TO AEDICODH.                             
305887     MOVE -1                     TO AEDICODL.                             
305888     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                                 
305889                                                                          
305890******************************************************************        
305891* SET ATTRIBUTES FOR VALID EDI CODE.                             *        
305892******************************************************************        
305893 8020-EDI-CODE-VALID.                                                     
305894                                                                          
305898     MOVE DP015-BLUE             TO AEDICODC.                             
305899     MOVE DP015-HL-OFF           TO AEDICODH.                             
305900                                                                          
305901******************************************************************        
305902* SET ATTRIBUTES FOR DISPLAY ONLY OF EDI CODE.                   *        
305903******************************************************************        
305904 8022-EDI-CODE-VALID-BL.                                                  
305905                                                                          
305906     MOVE DP015-BLUE             TO AEDICODC.                             
305907     MOVE DP015-HL-OFF           TO AEDICODH.                             
305908                                                                          
305909******************************************************************        
305910* INVALID POE CITY ERROR ROUTINE (1450).                         *        
305911*           **  CODE IS INVALID   **                             *        
305912******************************************************************        
305913 8025-POE-CITY-INVALID-ERROR.                                             
305914                                                                          
305915     SET PS-ERROR                                                         
305916         DP020-MSG-FATAL         TO TRUE.                                 
305917     MOVE PC-TSYMSG-01450        TO DP020-MSG-NUMBER.                     
305918     MOVE DP015-UNP-ALP-BRT-OFF  TO APOECTYA.                             
305919     MOVE DP015-RED              TO APOECTYC.                             
305920     MOVE DP015-REVERSE          TO APOECTYH.                             
305921     MOVE -1                     TO APOECTYL.                             
305922     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                                 
305923                                                                          
305924******************************************************************        
305925* SET ATTRIBUTES FOR VALID POE CITY NAME.                        *        
305926******************************************************************        
305927 8030-POE-CITY-VALID.                                                     
305928                                                                          
305929     MOVE DP015-GREEN            TO APOECTYC.                             
305930     MOVE DP015-UNDERLINE        TO APOECTYH.                             
305931                                                                          
305932******************************************************************        
305933* SET ATTRIBUTES FOR DISPLAY ONLY OF POE CITY NAME.              *        
305934******************************************************************        
305935 8032-POE-CITY-VALID-BL.                                                  
305936                                                                          
305937     MOVE DP015-BLUE             TO APOECTYC.                             
305938     MOVE DP015-HL-OFF           TO APOECTYH.                             
305939                                                                          
305940******************************************************************        
305941* INVALID POE STATE ERROR ROUTINE (1450).                        *        
305942*           **  CODE IS INVALID   **                             *        
305943******************************************************************        
305944 8035-POE-STATE-INVALID-ERROR.                                            
305945                                                                          
305946     SET PS-ERROR                                                         
305947         DP020-MSG-FATAL         TO TRUE.                                 
305948     MOVE PC-TSYMSG-01450        TO DP020-MSG-NUMBER.                     
305949     MOVE DP015-UNP-ALP-BRT-OFF  TO APOESTAA.                             
305950     MOVE DP015-RED              TO APOESTAC.                             
305951     MOVE DP015-REVERSE          TO APOESTAH.                             
305952     MOVE -1                     TO APOESTAL.                             
305953     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                                 
305954                                                                          
305955******************************************************************        
305956* SET ATTRIBUTES FOR VALID POE STATE CODE.                       *        
305957******************************************************************        
305958 8040-POE-STATE-VALID.                                                    
305959                                                                          
305960     MOVE DP015-GREEN            TO APOESTAC.                             
305961     MOVE DP015-UNDERLINE        TO APOESTAH.                             
305962                                                                          
305963******************************************************************        
305964* SET ATTRIBUTES FOR DISPLAY ONLY OF POE STATE CODE.             *        
305965******************************************************************        
305966 8042-POE-STATE-VALID-BL.                                                 
305967                                                                          
305968     MOVE DP015-BLUE             TO APOESTAC.                             
305969     MOVE DP015-HL-OFF           TO APOESTAH.                             
305970                                                                          
305971******************************************************************        
305972* INVALID POE NAME ERROR ROUTINE (1450).                         *        
305973*           **  CODE IS INVALID   **                             *        
305974******************************************************************        
305975 8045-POE-NAME-INVALID-ERROR.                                             
305976                                                                          
305977     SET PS-ERROR                                                         
305978         DP020-MSG-FATAL         TO TRUE.                                 
305979     MOVE PC-TSYMSG-01450        TO DP020-MSG-NUMBER.                     
305980     MOVE DP015-UNP-ALP-BRT-OFF  TO APOEDESA.                             
305981     MOVE DP015-RED              TO APOEDESC.                             
305982     MOVE DP015-REVERSE          TO APOEDESH.                             
305983     MOVE -1                     TO APOEDESL.                             
305984     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                                 
305985                                                                          
305986******************************************************************        
305987* SET ATTRIBUTES FOR VALID POE NAME.                             *        
305988******************************************************************        
305989 8050-POE-NAME-VALID.                                                     
305990                                                                          
305991     MOVE DP015-GREEN            TO APOEDESC.                             
305992     MOVE DP015-UNDERLINE        TO APOEDESH.                             
305993                                                                          
305994******************************************************************        
305995* SET ATTRIBUTES FOR DISPLAY ONLY OF POE NAME.                   *        
305996******************************************************************        
305997 8052-POE-NAME-VALID-BL.                                                  
305998                                                                          
305999     MOVE DP015-BLUE             TO APOEDESC.                             
306000     MOVE DP015-HL-OFF           TO APOEDESH.                             
306001                                                                          
306002******************************************************************        
306003* INVALID DECONSOLIDATOR ERROR ROUTINE (1450).                   *        
306004*           **  CODE IS INVALID   **                             *        
306005******************************************************************        
306006 8055-DCONSLR-INVALID-ERROR.                                              
306007                                                                          
306008     SET PS-ERROR                                                         
306009         DP020-MSG-FATAL         TO TRUE.                                 
306010     MOVE PC-TSYMSG-01450        TO DP020-MSG-NUMBER.                     
306011     MOVE SPACES                 TO ASC-DCONSLR-NAME.                     
306012     MOVE DP015-UNP-ALP-BRT-OFF  TO ADCNSLCA.                             
306013     MOVE DP015-RED              TO ADCNSLCC.                             
306014     MOVE DP015-REVERSE          TO ADCNSLCH.                             
306015     MOVE -1                     TO ADCNSLCL.                             
306016     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                                 
306017                                                                          
306018******************************************************************        
306019* SET ATTRIBUTES FOR VALID DECONSOLIDATOR.                       *        
306020******************************************************************        
306021 8060-DCONSLR-VALID.                                                      
306022                                                                          
306023     MOVE ENTNME-ENT-ID          TO ASC-DCONSLR-ENT-ID.                   
306024     MOVE ENTNME-ENT-NAME-DESC   TO ASC-DCONSLR-NAME.                     
306027     MOVE DP015-BLUE             TO ADCNSLCC.                             
306029     MOVE DP015-HL-OFF           TO ADCNSLCH.                             
306030                                                                          
306031******************************************************************        
306032* SET ATTRIBUTES FOR DISPLAY ONLY OF DECONSOLIDATOR.             *        
306033******************************************************************        
306034 8062-DCONSLR-VALID-BL.                                                   
306035                                                                          
306036     MOVE ENTNME-ENT-ID          TO ASC-DCONSLR-ENT-ID.                   
306037     MOVE ENTNME-ENT-NAME-DESC   TO ASC-DCONSLR-NAME.                     
306038     MOVE DP015-BLUE             TO ADCNSLCC.                             
306039     MOVE DP015-HL-OFF           TO ADCNSLCH.                             
306040                                                                          
306041******************************************************************        
306042* INVALID ALLOWED ON PO INDICATOR ERROR ROUTINE (1450).          *        
306043*           **  CODE IS INVALID   **                             *        
306044******************************************************************        
306045 8065-ALLOWED-ON-PO-INVALID-ERR.                                          
306046                                                                          
306047     SET PS-ERROR                                                         
306048         DP020-MSG-FATAL         TO TRUE.                                 
306049     MOVE PC-TSYMSG-01450        TO DP020-MSG-NUMBER.                     
306050     MOVE DP015-UNP-ALP-BRT-OFF  TO AALWDPOA.                             
306051     MOVE DP015-RED              TO AALWDPOC.                             
306052     MOVE DP015-REVERSE          TO AALWDPOH.                             
306053     MOVE -1                     TO AALWDPOL.                             
306054     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                                 
306055                                                                          
306056******************************************************************        
306057* SET ATTRIBUTES FOR VALID ALLOWED ON PO INDICATOR.              *        
306058******************************************************************        
306059 8070-ALLOWED-ON-PO-VALID.                                                
306060                                                                          
306061     MOVE DP015-GREEN            TO AALWDPOC.                             
306062     MOVE DP015-UNDERLINE        TO AALWDPOH.                             
306063                                                                          
306064******************************************************************        
306065* SET ATTRIBUTES FOR DISPLAY ONLY OF ALLOWED ON PO INDICATOR.    *        
306066******************************************************************        
306067 8072-ALLOWED-ON-PO-VALID-BL.                                             
306068                                                                          
306069     MOVE DP015-BLUE             TO AALWDPOC.                             
306070     MOVE DP015-HL-OFF           TO AALWDPOH.                             
306071                                                                          
306072******************************************************************        
306073* INVALID TRIP TYPE CODE ERROR ROUTINE (1450).                   *        
306074*           **  CODE IS INVALID   **                             *        
306075******************************************************************        
306076 8075-TRIP-TYP-CDE-INVALID-ERR.                                           
306077                                                                          
306078     SET PS-ERROR                                                         
306079         DP020-MSG-FATAL         TO TRUE.                                 
306080     MOVE PC-TSYMSG-01450        TO DP020-MSG-NUMBER.                     
306081     MOVE DP015-UNP-ALP-BRT-OFF  TO ATRPTYPA.                             
306082     MOVE DP015-RED              TO ATRPTYPC.                             
306083     MOVE DP015-REVERSE          TO ATRPTYPH.                             
306084     MOVE -1                     TO ATRPTYPL.                             
306085     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                                 
306086                                                                          
306087******************************************************************        
306088* SET ATTRIBUTES FOR VALID TRIP TYPE CODE.                       *        
306089******************************************************************        
306090 8080-TRIP-TYP-CDE-VALID.                                                 
306091                                                                          
306092     MOVE DP015-GREEN            TO ATRPTYPC.                             
306093     MOVE DP015-UNDERLINE        TO ATRPTYPH.                             
306094                                                                          
306095******************************************************************        
306096* SET ATTRIBUTES FOR DISPLAY ONLY OF TRIP TYPE CODE.             *        
306097******************************************************************        
306098 8082-TRIP-TYP-CDE-VALID-BL.                                              
306099                                                                          
306100     MOVE DP015-BLUE             TO ATRPTYPC.                             
306101     MOVE DP015-HL-OFF           TO ATRPTYPH.                             
306102                                                                          
306118******************************************************************        
306119* SET ATTRIBUTES FOR VALID IATA CODE.                            *        
306120******************************************************************        
306121 8090-IATA-CDE-VALID.                                                     
306122                                                                          
306123     MOVE DP015-GREEN            TO AIATACDC.                             
306124     MOVE DP015-UNDERLINE        TO AIATACDH.                             
306125                                                                          
306126******************************************************************        
306127* SET ATTRIBUTES FOR DISPLAY ONLY OF IATA CODE.                  *        
306128******************************************************************        
306129 8092-IATA-CDE-VALID-BL.                                                  
306130                                                                          
306131     MOVE DP015-BLUE             TO AIATACDC.                             
306132     MOVE DP015-HL-OFF           TO AIATACDH.                             
306133/                                                                         
306134******************************************************************30580017
306135*    READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE     *30590017
306140******************************************************************30600017
306200 9100-READ-SEL-QUEUE.                                             30620017
306300                                                                  30630017
306400     EXEC CICS                                                    30640017
306500         READQ TS                                                 30650017
306600             QUEUE (ASC-SEL-QUEUE-NAME)                           30660017
306700             INTO  ( TR023-POE-SEL-REC )                          30670025
306800             ITEM  (ASC-SEL-ITEM)                                 30680017
306900             RESP  (PV-CICS-RESPONSE)                             30690017
307000     END-EXEC.                                                    30700017
307100                                                                  30710017
307200     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       30720017
307300         CONTINUE                                                 30730017
307400     ELSE                                                         30740017
307500         SET DP013-LOGIC-ABEND                                    30750017
307600             DP013-NO-ROLLBACK     TO TRUE                        30760017
307700         MOVE '9100-READ-SEL-QUEUE'                               30770017
307800                                   TO DP013-PARAGRAPH             30780017
307900         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   30790017
308000                                   TO DP013-MESSAGE-TEXT (1)      30800017
308100         MOVE ASC-SEL-TASK         TO PV-DISPLAY-TASK             30810017
308200         STRING 'QUEUE ID: '                                      30820017
308300                ASC-SEL-TERM-ID                                   30830017
308400                ' '                                               30840017
308500                PV-DISPLAY-TASK                                   30850017
308600                ' '                                               30860017
308700                ASC-SEL-SEQ DELIMITED BY SIZE                     30870017
308800                               INTO DP013-MESSAGE-TEXT (2)        30880017
308900         PERFORM DP013-0000-PROCESS-ABEND                         30890017
309000     END-IF.                                                      30900017
309200/                                                                 30920017
309300******************************************************************30930017
309400*    UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE     *30940017
309500******************************************************************30950017
309600 9200-REWRITE-SEL-QUEUE.                                          30960017
309700                                                                  30970017
309800     EXEC CICS                                                    30980017
309900          WRITEQ TS                                               30990017
310000              QUEUE  (ASC-SEL-QUEUE-NAME)                         31000017
310100              FROM   (TR023-POE-SEL-REC)                          31010023
310200              ITEM   (ASC-SEL-ITEM)                               31020017
310300              RESP   (PV-CICS-RESPONSE)                           31030017
310400              REWRITE                                             31040017
310500     END-EXEC.                                                    31050017
310600                                                                  31060017
310700     IF  PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                   31070017
310800         SET DP013-CICS-ABEND                                     31080017
310900             DP013-NO-ROLLBACK     TO TRUE                        31090017
311000         MOVE '9200-REWRITE-SEL-QUEUE'                            31100017
311100                                   TO DP013-PARAGRAPH             31110017
311200         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   31120017
311300                                   TO DP013-MESSAGE-TEXT (1)      31130017
311400         PERFORM DP013-0000-PROCESS-ABEND                         31140017
311500     END-IF.                                                      31150017
311600                                                                  31160017
311700******************************************************************31170017
311800*    ABEND PROCESSOR MODULE                                      *31180017
311900******************************************************************31190017
312000                                                                  31200017
312100     COPY DPPD013.                                                31210017
312200                                                                  31220017
312300******************************************************************31230017
312400*    LINK TO CICS OBJECT LOCKING MODULE                          *31240017
312500******************************************************************31250017
312600                                                                  31260017
312700     COPY DPPD044.                                                31270017
