       IDENTIFICATION DIVISION.                                         00040000
                                                                        00050000
       PROGRAM-ID.    MLKRP205.                                         00060000
       AUTHOR.        TESS BESTE.                                       00070000
       INSTALLATION.  KOHLS DEPARTMENT STORES.                          00080000
       DATE-WRITTEN.  06/26/1998.                                       00090000
       DATE-COMPILED.                                                   00100000
                                                                                
      ******************************************************************00110000
      * THIS PROGRAM READS THE STORE INVENTORY REPORT EXTRACT FILE      00120000
      * SUMMED TO DEPARTMENT/STORE LEVEL, AND CREATES THE DEPARTMENT    00130000
      * STORE INVENTORY REPORT.                                         00130000
      *                                                                 00130000
      * TOTALS BY STORE ARE PRINTED AT THE DEPARTMENT, BUYER, DMA,      00140000
      * GMA, AND COMPANY LEVELS. AN ALL-STORE TOTAL IS ALSO PRINTED     00140000
      * AT EACH LEVEL.                                                  00130000
      *                                                                 00160000
      * THIS PROGRAM WAS COPIED FROM THE OLD SUMMARIZED INVENTORY       00160000
      * AND GROSS MARGIN REPORT PROGRAM, MLKRP040, AND MODIFIED.        00160000
      *                                                                 00160000
      *CHANGE HISTORY:                                                          
      * WR/PROJ DATE       PGMR        DESCRIPTION OF CHANGES                   
      * ------- ---------- ----------- --------------------------------         
WR5701*   DATE : 01/09/99       CHANGE ID : WR5701     WHO :TKMA372             
WR5701* REASON FOR CHANGE : 'NET PURCHASES' COLUMN OBSOLETED.                   
WR5701* REPLACED WITH 'RECEIPTS' AND 'PURCHASE ADJ' COST & RETAIL.              
WR5701* INCREASED REPORT SIZE TO 175 BYTE.                                      
WR9999*   DATE : 03/01/99       CHANGE ID : WR9999     WHO :TKMA372             
WR9999* REASON FOR CHANGE : ADD STORE NUMBER TO REPORT IN FIRST COLUMN          
WR9999* JUST PRIOR TO STORE 10-DIGIT NAME.                                      
      *                                                                         
W26603* W26603  03-08-2004 ROD JANSSEN MERCH LEDGER STORE EXPANSION             
C14666* CRQ000000014666    07-10-2012 J SELWITSCHKA                             
C14666*                    REVISE SHRINK ACCRUAL RATE PROCESS.                  
C14666*                    CHANGES MADE TO SHOW SHORTAGE SHRINK                 
C14666*                    PERCENTAGE WITH 2 POSITIONS TO THE RIGHT             
C14666*                    OF THE DECIMAL POINT.                                
222725* CHG0222725        04-29-2019                                   *        
222725*                      CHANGES MADE TO PICK ONLY THE BUYER       *        
222725*                      CREATED  UNDER 'DPT' IN TMDSEAR TABLE     *        
      ******************************************************************        
                                                                        00180000
       ENVIRONMENT DIVISION.                                            00660000
       CONFIGURATION SECTION.                                           00690000
       SOURCE-COMPUTER.        IBM-3090.                                00710000
       OBJECT-COMPUTER.        IBM-3090.                                00720000
       INPUT-OUTPUT SECTION.                                            00750000
       FILE-CONTROL.                                                    00770000
                                                                        00780000
           SELECT STR-INV-EXTRACT-FILE                                  00790000
               ASSIGN TO INP01.                                         00800000
                                                                        00810300
           SELECT  STR-INV-DTE-FILE                                     00810400
               ASSIGN TO INP02.                                         00810500
                                                                        00810600
           SELECT STR-INV-REPORT-FILE                                   00810700
               ASSIGN TO RPT01.                                         00811000
                                                                        00870000
       DATA DIVISION.                                                   00900000
       FILE SECTION.                                                    00930000
                                                                        00940000
       FD  STR-INV-EXTRACT-FILE                                         00950000
           RECORDING MODE IS F                                          00960000
           LABEL RECORDS ARE STANDARD                                   00970000
           BLOCK CONTAINS 0 RECORDS.                                    00990000
                                                                        01000000
W26603 01  STR-INV-EXTRACT-RECORD           PIC X(93).                  01000100
                                                                        01000200
       FD  STR-INV-DTE-FILE                                                     
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS.                                            
                                                                                
       01  STR-INV-DTE-RECORD               PIC X(80).                          
                                                                                
       FD  STR-INV-REPORT-FILE                                          01001700
           RECORDING MODE IS F                                          01001800
           LABEL RECORDS ARE STANDARD                                   01001900
           BLOCK CONTAINS 0 RECORDS.                                    01002000
                                                                        01002100
WR5701 01  STR-INV-REPORT-RECORD            PIC X(175).                 01003000
                                                                        01170000
       WORKING-STORAGE SECTION.                                         01190000
      ***************************************************************   01270000
      * RECORD LAYOUT FOR STORE INVENTORY REPORT EXTRACT RECORD.        01280000
      ***************************************************************   01290000
                                                                        01300000
           COPY MLRD109.                                                01310000
                                                                        01320000
      ****************************************************************          
      * RECORD LAYOUT FOR STORE INVENTORY REPORT DATE RECORD.                   
      ****************************************************************          
                                                                                
           COPY MLRD115.                                                        
                                                                                
      ***************************************************************   01270000
      *    150 CHARACTER STANDARD HEADER.                               01280000
      ***************************************************************   01290000
                                                                        01300000
      *    COPY DPWS150O.                                               01310000
                                                                        01320000
      ***************************************************************   01330000
      *    WORKING STORAGE AREA FOR THE NAME REFORMATTER                01340000
      *    ROUTINE DPPD024.                                             01350000
      ***************************************************************   01360000
                                                                        01370000
           COPY DPWS024.                                                01380000
                                                                        01390000
      ******************************************************************        
      *  VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004                
      ******************************************************************        
                                                                                
           COPY DPWS004.                                                        
                                                                                
WR5701 01  DP175O-STANDRD-HEADER-175-COLS.                                      
WR5701     05  DP175O-LASER-NEW-PAGE-INDICATR    PIC X(02) VALUE SPACE.         
WR5701     05  DP175O-RUN-DATE.                                                 
WR5701         10  DP175O-RUN-MONTH              PIC 9(02) VALUE ZERO.          
WR5701         10  FILLER                        PIC X(01) VALUE '/'.           
WR5701         10  DP175O-RUN-DAY                PIC 9(02) VALUE ZERO.          
WR5701         10  FILLER                        PIC X(01) VALUE '/'.           
WR5701         10  DP175O-RUN-YEAR               PIC 9(02) VALUE ZERO.          
WR5701     05  FILLER                            PIC X(02) VALUE SPACE.         
WR5701     05  DP175O-RUN-TIME.                                                 
WR5701         10  DP175O-RUN-HOUR               PIC 9(02) VALUE ZERO.          
WR5701         10  FILLER                        PIC X(01) VALUE ':'.           
WR5701         10  DP175O-RUN-MINUTE             PIC 9(02) VALUE ZERO.          
WR5701     05  FILLER                            PIC X(47) VALUE SPACE.         
WR5701     05  FILLER                            PIC X(45)                      
WR5701         VALUE 'K O H L S   D E P A R T M E N T   S T O R E S'.           
WR5701     05  FILLER                            PIC X(42) VALUE SPACE.         
WR5701     05  DP175O-PROGRAM-NAME               PIC X(08) VALUE SPACE.         
WR5701     05  FILLER                            PIC X(01) VALUE '-'.           
WR5701     05  DP175O-REPORT-NUMBER              PIC 9(01) VALUE ZERO.          
WR5701     05  FILLER                            PIC X(02) VALUE SPACE.         
WR5701     05  FILLER                            PIC X(05) VALUE 'PAGE'.        
WR5701     05  DP175O-PAGE-NUMBER                PIC ZZZZ9 VALUE ZERO.          
WR5701                                                                          
       01  PH2-PAGE-HEADING-2.                                          04110000
WR5701     05  FILLER                       PIC X(49)     VALUE SPACE.  04120000
           05  FILLER                       PIC X(55)     VALUE         04130000
           '           DEPARTMENT STORE INVENTORY REPORT FOR FISCAL'.   04140000
           05  FILLER                       PIC X(01)     VALUE SPACE.  04150000
           05  PH2-FSCL-MN-NM               PIC X(09)     VALUE SPACE.  04160000
           05  FILLER                       PIC X(01)     VALUE SPACE.  04170000
           05  PH2-FSCL-YR-NBR              PIC X(04)     VALUE SPACE.  04180000
WR5701     03  FILLER                       PIC X(56)     VALUE SPACE.  04220000
                                                                        04240000
       01  PH3-PAGE-HEADING-3.                                          04250000
WR5701     05  FILLER                       PIC X(83)     VALUE SPACE.  04260000
           05  FILLER                       PIC X(05)     VALUE         04270000
                                                          '($000'.      04280000
           05  FILLER                       PIC X(01)     VALUE QUOTE.  04290000
           05  FILLER                       PIC X(02)     VALUE         04300000
                                                          'S)'.         04310000
WR5701     05  FILLER                       PIC X(84)     VALUE SPACE.  04320000
                                                                        04330000
       01  SH1-SUB-HEADING-1.                                           05280000
           05  FILLER                       PIC X(10)     VALUE         05290000
           'COMPANY:  '.                                                05300000
           05  FILLER                       PIC X(23)     VALUE         05310000
           'KOHLS DEPARTMENT STORES'.                                   05320000
WR5701     05  FILLER                       PIC X(142)    VALUE SPACE.  05330000
                                                                        05340000
       01  SH2-SUB-HEADING-2.                                           05350000
           05  FILLER                       PIC X(10)     VALUE         05360000
                                                           'DIVISION: '.05370000
           05  FILLER                       PIC X         VALUE SPACE.          
           05  SH2-DIVISION                 PIC X(02)     VALUE SPACE.  05380000
WR5701     05  FILLER                       PIC X(162)    VALUE SPACE.  05390000
                                                                        05400000
       01  SH3-SUB-HEADING-3.                                           05410000
           05  FILLER                       PIC X(10)     VALUE         05420000
                                                           'MANAGER:  '.05430000
           05  FILLER                       PIC X         VALUE SPACE.          
           05  SH3-MANAGER-NBR              PIC X(02)     VALUE SPACE.  05440000
           05  FILLER                       PIC X(01)     VALUE SPACE.  05450000
           05  SH3-MANAGER-NAME             PIC X(20)     VALUE SPACE.  05460000
WR5701     05  FILLER                       PIC X(141)    VALUE SPACE.  05470000
                                                                        05480000
       01  SH4-SUB-HEADING-4.                                           05490000
           05  FILLER                       PIC X(10)     VALUE         05500000
                                                           'BUYER:    '.05510000
           05  SH4-BYR-NBR                  PIC X(03)     VALUE SPACE.  05520000
           05  FILLER                       PIC X(01)     VALUE SPACE.  05530000
           05  SH4-BUYER-NAME               PIC X(20)     VALUE SPACE.  05540000
WR5701     05  FILLER                       PIC X(141)    VALUE SPACE.  05550000
                                                                        05560000
       01  SH5-SUB-HEADING-5.                                           05570000
           05  FILLER                       PIC X(10)     VALUE         05580000
                                                           'DEPT:     '.05590000
           05  SH5-DEPT-NBR                 PIC X(03)     VALUE SPACE.  05600000
           05  FILLER                       PIC X(01)     VALUE SPACE.  05610000
           05  SH5-DEPT-DESC                PIC X(20)     VALUE SPACE.  05620000
WR5701     05  FILLER                       PIC X(141)    VALUE SPACE.  05630000
                                                                        05640000
WR5701 01  DH1-DETAIL-HEADING-1.                                        02000000
WR9999     05  FILLER                       PIC X(19)     VALUE SPACE.  02010000
           05  FILLER                       PIC X(09)     VALUE         02020000
                                                'BEGINNING'.            02030000
WR9999     05  FILLER                       PIC X(20)     VALUE SPACE.  02040000
           05  FILLER                       PIC X(08)     VALUE         02050000
                                                'PURCHASE'.             02050000
WR9999     05  FILLER                       PIC X(12)     VALUE SPACE.  02070000
           05  FILLER                       PIC X(09)     VALUE         02080000
                                                'TRANSFERS'.            02090000
WR9999     05  FILLER                       PIC X(06)     VALUE SPACE.  02100000
C14666     05  FILLER                       PIC X(25)     VALUE         02110000
C14666                                      '------------------------ '.02120000
           05  FILLER                       PIC X(06)     VALUE         02140000
                                                'RETAIL'.               02150000
           05  FILLER                       PIC X(01)     VALUE SPACE.  02160000
           05  FILLER                       PIC X(10)     VALUE         02170000
                                                'REDUCTIONS'.           02180000
           05  FILLER                       PIC X(01)     VALUE SPACE.  02190000
C14666     05  FILLER                       PIC X(27)     VALUE         02200000
C14666                                    '---------------------------'.02210000
           05  FILLER                       PIC X(05)     VALUE SPACE.  02220000
           05  FILLER                       PIC X(09)     VALUE         02230000
                                                'MONTH END'.            02240000
           05  FILLER                       PIC X(09)     VALUE SPACE.  02250000
                                                                        02260000
WR5701 01  DH2-DETAIL-HEADING-2.                                        02270000
WR9999     05  FILLER                       PIC X(03)     VALUE SPACE.  02280000
WR9999     05  FILLER                       PIC X(09)     VALUE         02290000
WR9999                                          'STORE    '.            02300000
           05  FILLER                       PIC X(07)     VALUE SPACE.  02310000
           05  FILLER                       PIC X(10)     VALUE         02320000
                                                'INVENTORY'.            02330000
           05  FILLER                       PIC X(06)     VALUE SPACE.  02340000
           05  FILLER                       PIC X(08)     VALUE         02350000
                                                'RECEIPTS'.             02360000
WR9999     05  FILLER                       PIC X(04)     VALUE SPACE.  02380000
           05  FILLER                       PIC X(11)     VALUE         02400000
                                                'ADJUSTMENTS'.                  
WR9999     05  FILLER                       PIC X(08)     VALUE SPACE.  02410000
           05  FILLER                       PIC X(11)     VALUE         02410000
                                                'IN         '.          02420000
WR9999     05  FILLER                       PIC X(03)     VALUE         02410000
                                                'OUT'.                  02420000
           05  FILLER                       PIC X(09)     VALUE SPACE.  02430000
           05  FILLER                       PIC X(10)     VALUE         02440000
                                                'SALES    %'.           02450000
C14666     05  FILLER                       PIC X(05)     VALUE SPACE.  02490000
C14666     05  FILLER                       PIC X(13)     VALUE         02500000
C14666                                          'SHRINKAGE   %'.        02510000
C14666     05  FILLER                       PIC X(08)     VALUE SPACE.  02550000
           05  FILLER                       PIC X(14)     VALUE         02560000
                                                'MARKDOWNS    %'.       02570000
           05  FILLER                       PIC X(09)     VALUE SPACE.  02610000
           05  FILLER                       PIC X(05)     VALUE         02620000
                                                'TOTAL'.                02630000
           05  FILLER                       PIC X(05)     VALUE SPACE.  02640000
           05  FILLER                       PIC X(14)     VALUE         02650000
                                                'INVENTORY    %'.       02660000
           05  FILLER                       PIC X(05)     VALUE SPACE.  02700000
                                                                        05900606
WR9999 01  SV-STORE-NBR.                                                02730000
W26603     05  SV-STORE-NBR-NUM             PIC S9(5).                  02730000
WR9999                                                                  02730000
WR9999 01  SV-STORE-NBR-XXX.                                            02730000
W26603     05  SV-STORE-NBR-2-4             PIC  9(5).                  02730000
WR9999                                                                  02730000
                                                                        02710000
WR9999* ADD 5 BYTES FOR STORE NBR/SPACE. BORROW FROM FILLER             02710000
       01  DL-DETAIL-LINE.                                              02720000
WR9999     05  FILLER                       PIC X(01)     VALUE SPACE.  02780000
WR9999     05  DL-STORE-NBR                 PIC Z9999     VALUE ZEROS.  02730000
WR9999     05  FILLER                       PIC X(01)     VALUE SPACE.  02780000
           05  DL-STORE-NAME                PIC X(10)     VALUE SPACE.  02730000
           05  FILLER                       PIC X(01)     VALUE SPACE.  02780000
           05  DL-BGN-INVENTORY             PIC ZZ,ZZZ,ZZZ.Z-           02740000
                                                          VALUE ZERO.   02750000
           05  FILLER                       PIC X(01)     VALUE SPACE.  02780000
WR5701     05  DL-RECEIPTS                  PIC ZZ,ZZZ,ZZZ.Z-           02760000
WR5701                                                    VALUE ZERO.   02770000
WR9999*    05  FILLER                       PIC X(01)     VALUE SPACE.  02780000
WR5701     05  DL-PURCHASE-ADJ              PIC ZZ,ZZZ,ZZZ.Z-           02760000
WR5701                                                    VALUE ZERO.   02770000
WR9999*    05  FILLER                       PIC X(01)     VALUE SPACE.  02780000
           05  DL-TRANSFERS-IN              PIC ZZ,ZZZ,ZZZ.Z            02790000
                                                          VALUE ZERO.   02800000
WR9999*    05  FILLER                       PIC X(01)     VALUE SPACE.  02810000
           05  DL-TRANSFERS-OUT             PIC ZZ,ZZZ,ZZZ.Z            02930000
                                                          VALUE ZERO.   02830000
           05  FILLER                       PIC X(01)     VALUE SPACE.  02840000
           05  DL-SALES                     PIC ZZ,ZZZ,ZZZ.Z-           02850000
                                                          VALUE ZERO.   02860000
           05  FILLER                       PIC X(01)     VALUE SPACE.  02840000
           05  DL-SALES-PCT                 PIC ZZ.Z-     VALUE ZERO.   02870000
WR9999*    05  DL-SHRINK                    PIC Z,ZZZ,ZZZ.Z-            02880000
WR9999     05  DL-SHRINK                    PIC   ZZZ,ZZZ.Z-            02880000
                                                          VALUE ZERO.   02890000
           05  FILLER                       PIC X(01)     VALUE SPACE.  02840000
C14666     05  DL-SHRINK-PCT                PIC ZZ.ZZ-    VALUE ZERO.   02910000
           05  FILLER                       PIC X(01)     VALUE SPACE.  02840000
           05  DL-MARKDOWNS                 PIC ZZ,ZZZ,ZZZ.Z-           02920000
                                                          VALUE ZERO.   02930000
           05  FILLER                       PIC X(02)     VALUE SPACE.  02840000
           05  DL-MARKDOWN-PCT              PIC ZZ.Z-     VALUE ZERO.   02940000
           05  FILLER                       PIC X(01)     VALUE SPACE.  02840000
           05  DL-RED-TOTAL                 PIC ZZ,ZZZ,ZZZ.Z-           02950000
                                                          VALUE ZERO.   02960000
           05  FILLER                       PIC X(01)     VALUE SPACE.  02970000
           05  DL-MTH-END-INV               PIC ZZ,ZZZ,ZZZ.Z-           02980000
                                                          VALUE ZERO.   02990000
           05  FILLER                       PIC X(01)     VALUE SPACE.  02970000
           05  DL-END-INV-PCT               PIC ZZZ.Z-    VALUE ZERO.   03000000
      *                                                                 03130000
       01  TL-TOTAL-LINE.                                               06120000
WR9999     05  FILLER                       PIC X(05)     VALUE SPACE.  06130000
WR9999     05  FILLER                       PIC X(08)     VALUE                 
                                                           '   TOTAL'.          
C14666     05  FILLER                       PIC X(04)     VALUE SPACE.  06160000
           05  TL-BGN-INVENTORY             PIC ZZZ,ZZZ,ZZ9.9-          06170000
                                                          VALUE ZERO.   06180000
           05  FILLER                       PIC X(01)     VALUE SPACE.  06160000
WR5701     05  TL-RECEIPTS                  PIC ZZ,ZZZ,ZZ9.9-           06190000
WR5701                                                    VALUE ZERO.   06200000
WR9999*    05  FILLER                       PIC X(01)     VALUE SPACE.  06210000
WR5701     05  TL-PURCHASE-ADJ              PIC ZZ,ZZZ,ZZ9.9-           06190000
WR5701                                                    VALUE ZERO.   06200000
WR9999*    05  FILLER                       PIC X(01)     VALUE SPACE.  06210000
           05  TL-TRANSFERS-IN              PIC ZZ,ZZZ,ZZ9.9            06220000
                                                          VALUE ZERO.   06230000
WR9999*    05  FILLER                       PIC X(01)     VALUE SPACE.  06240000
           05  TL-TRANSFERS-OUT             PIC ZZ,ZZZ,ZZ9.9            06250000
                                                          VALUE ZERO.   06260000
           05  FILLER                       PIC X(01)     VALUE SPACE.  06270000
           05  TL-SALES                     PIC ZZ,ZZZ,ZZ9.9-           06280000
                                                          VALUE ZERO.   06290000
           05  FILLER                       PIC X(01)     VALUE SPACE.  06270000
           05  TL-SALES-PCT                 PIC ZZ.Z-     VALUE ZERO.   06300000
      *    05  FILLER                       PIC X(01)     VALUE SPACE.  06270000
WR9999*    05  TL-SHRINK                    PIC Z,ZZZ,ZZ9.9-            06310000
WR9999*                                                   VALUE ZERO.   06320000
WR9999     05  TL-SHRINK                    PIC   ZZZ,ZZ9.9-            06310000
WR9999                                                    VALUE ZERO.   06320000
           05  FILLER                       PIC X(01)     VALUE SPACE.  06330000
C14666     05  TL-SHRINK-PCT                PIC ZZ.ZZ-    VALUE ZERO.   06340000
           05  FILLER                       PIC X(01)     VALUE SPACE.  06330000
           05  TL-MARKDOWNS                 PIC ZZ,ZZZ,ZZ9.9-           06350000
                                                          VALUE ZERO.   06360000
           05  FILLER                       PIC X(02)     VALUE SPACE.  06330000
           05  TL-MARKDOWN-PCT              PIC ZZ.Z-     VALUE ZERO.   06370000
           05  FILLER                       PIC X(01)     VALUE SPACE.  06330000
           05  TL-RED-TOTAL                 PIC ZZ,ZZZ,ZZ9.9-           06380000
                                                          VALUE ZERO.   06390000
      *    05  FILLER                       PIC X(01)     VALUE SPACE.  06330000
           05  TL-MTH-END-INV               PIC ZZZ,ZZZ,ZZ9.9-          06400000
                                                          VALUE ZERO.   06410000
           05  FILLER                       PIC X(01)     VALUE SPACE.  06420000
           05  TL-END-INV-PCT               PIC ZZ.Z-     VALUE ZERO.   06430000
           05  FILLER                       PIC X(01)     VALUE SPACE.  06420000
                                                                        06440000
       01  ER-END-OF-REPORT-LINE.                                       MLKRP054
           05  FILLER                       PIC  X(21)    VALUE         MLKRP054
                                                '*** END OF REPORT ***'.MLKRP054
      ******************************************************************        
      * THE FOLLOWING TABLE HOLDS THE STORE INFORMATION FOR ALL STORES          
      * TO BE REPORTED.  IT IS USED TO DRIVE THE PRINTING OF THE STORE          
      * DETAIL LINES SO THAT ALL VALID STORES WILL BE REPORTED, EVEN            
      * IF THEY HAVE NO DOLLARS ON LEDGER.                                      
      *                                                                         
      * STORE NUMBER IS THE SUBSCRIPT INTO THE TABLE.                           
      ******************************************************************        
                                                                                
       01  ST-STORE-TABLE.                                              05900107
W26603     05  ST-STORE-ENTRY               OCCURS 9999.                05900207
               10  ST-STR-NBR               PIC S9(04) COMP.            05900307
               10  ST-TYPE-CODE             PIC  X(02).                 05900406
               10  ST-ABBR-NAME             PIC  X(10).                 05900506
                                                                                
      ******************************************************************        
      * THE FOLLOWING TABLES HOLD THE STORE TOTALS FOR EACH REPORTING           
      * LEVEL.                                                                  
      *                                                                         
      * STORE NUMBER IS THE SUBSCRIPT INTO THESE TABLES.                        
      ******************************************************************        
                                                                                
       01  DT-DEPT-TOTALS.                                              03140000
W26603     05  DT-STORE-ENTRY               OCCURS 9999 TIMES.          03150000
               10  DT-STORE-TOTALS                        COMP-3.       03190000
W26603             15  DT-BEG-INV-RTL-AMT   PIC S9(13)V99.              03200006
W26603             15  DT-RCPT-RTL-AMT      PIC S9(13)V99.              03210006
W26603             15  DT-PADJ-RTL-AMT      PIC S9(13)V99.              03210006
W26603             15  DT-XFER-IN-RTL-AMT   PIC S9(13)V99.              03220006
W26603             15  DT-XFER-OUT-RTL-AMT  PIC S9(13)V99.              03230006
W26603             15  DT-SLS-RTL-AMT       PIC S9(13)V99.              03240006
W26603             15  DT-SHNK-RTL-AMT      PIC S9(13)V99.              03250006
W26603             15  DT-MKDN-RTL-AMT      PIC S9(13)V99.              03260006
W26603             15  DT-END-INV-RTL-AMT   PIC S9(13)V99.              03270006
                                                                        03290000
       01  BT-BUYER-TOTALS.                                             03291001
W26603     05  BT-STORE-ENTRY               OCCURS 9999 TIMES.          03292001
               10  BT-STORE-TOTALS                        COMP-3.       03296001
W26603             15  BT-BEG-INV-RTL-AMT   PIC S9(13)V99.              03297001
W26603             15  BT-RCPT-RTL-AMT      PIC S9(13)V99.              03298001
W26603             15  BT-PADJ-RTL-AMT      PIC S9(13)V99.              03298001
W26603             15  BT-XFER-IN-RTL-AMT   PIC S9(13)V99.              03299001
W26603             15  BT-XFER-OUT-RTL-AMT  PIC S9(13)V99.              03299101
W26603             15  BT-SLS-RTL-AMT       PIC S9(13)V99.              03299201
W26603             15  BT-SHNK-RTL-AMT      PIC S9(13)V99.              03299301
W26603             15  BT-MKDN-RTL-AMT      PIC S9(13)V99.              03299401
W26603             15  BT-END-INV-RTL-AMT   PIC S9(13)V99.              03299501
                                                                        03299701
       01  MT-MANAGER-TOTALS.                                           03299801
W26603     05  MT-STORE-ENTRY               OCCURS 9999 TIMES.          03299901
               10  MT-STORE-TOTALS                        COMP-3.       03300301
W26603             15  MT-BEG-INV-RTL-AMT   PIC S9(13)V99.              03300401
W26603             15  MT-RCPT-RTL-AMT      PIC S9(13)V99.              03300501
W26603             15  MT-PADJ-RTL-AMT      PIC S9(13)V99.              03300501
W26603             15  MT-XFER-IN-RTL-AMT   PIC S9(13)V99.              03300601
W26603             15  MT-XFER-OUT-RTL-AMT  PIC S9(13)V99.              03300701
W26603             15  MT-SLS-RTL-AMT       PIC S9(13)V99.              03300801
W26603             15  MT-SHNK-RTL-AMT      PIC S9(13)V99.              03300901
W26603             15  MT-MKDN-RTL-AMT      PIC S9(13)V99.              03301001
W26603             15  MT-END-INV-RTL-AMT   PIC S9(13)V99.              03301101
                                                                        03301301
       01  DVT-DIVISION-TOTALS.                                         03302000
W26603     05  DVT-STORE-ENTRY              OCCURS 9999 TIMES.          03310000
               10  DVT-STORE-TOTALS                       COMP-3.       03350000
W26603             15  DVT-BEG-INV-RTL-AMT  PIC S9(13)V99.              03360000
W26603             15  DVT-RCPT-RTL-AMT     PIC S9(13)V99.              03370000
W26603             15  DVT-PADJ-RTL-AMT     PIC S9(13)V99.              03370000
W26603             15  DVT-XFER-IN-RTL-AMT  PIC S9(13)V99.              03380000
W26603             15  DVT-XFER-OUT-RTL-AMT PIC S9(13)V99.              03390000
W26603             15  DVT-SLS-RTL-AMT      PIC S9(13)V99.              03400000
W26603             15  DVT-SHNK-RTL-AMT     PIC S9(13)V99.              03410000
W26603             15  DVT-MKDN-RTL-AMT     PIC S9(13)V99.              03420000
W26603             15  DVT-END-INV-RTL-AMT  PIC S9(13)V99.              03430000
                                                                        03450000
       01  FT-FINAL-TOTALS.                                             03451001
W26603     05  FT-STORE-ENTRY               OCCURS 9999 TIMES.          03452001
               10  FT-FINAL-STORE-TOTALS                  COMP-3.       03456001
W26603             15  FT-BEG-INV-RTL-AMT   PIC S9(13)V99.              03457001
W26603             15  FT-RCPT-RTL-AMT      PIC S9(13)V99.              03458001
W26603             15  FT-PADJ-RTL-AMT      PIC S9(13)V99.              03458001
W26603             15  FT-XFER-IN-RTL-AMT   PIC S9(13)V99.              03459001
W26603             15  FT-XFER-OUT-RTL-AMT  PIC S9(13)V99.              03459101
W26603             15  FT-SLS-RTL-AMT       PIC S9(13)V99.              03459201
W26603             15  FT-SHNK-RTL-AMT      PIC S9(13)V99.              03459301
W26603             15  FT-MKDN-RTL-AMT      PIC S9(13)V99.              03459401
W26603             15  FT-END-INV-RTL-AMT   PIC S9(13)V99.              03459501
                                                                        03459701
      ******************************************************************        
      * THE FOLLOWING TABLE HOLDS THE STORE TOTALS FOR THE REPORT               
      * LEVEL THAT IS CURRENTLY BEING PRINTED.                                  
      *                                                                         
      * STORE NUMBER IS THE SUBSCRIPT INTO THE TABLE.                           
      ******************************************************************        
                                                                                
       01  CT-CURRENT-TOTALS.                                           01810000
W26603     05  CT-STORE-ENTRY               OCCURS 9999 TIMES.          01930000
               10  CT-STORE-TOTALS                        COMP-3.       01890000
W26603             15  CT-BEG-INV-RTL-AMT   PIC S9(13)V99.              01900000
W26603             15  CT-RCPT-RTL-AMT      PIC S9(13)V99.              01910000
W26603             15  CT-PADJ-RTL-AMT      PIC S9(13)V99.              01910000
W26603             15  CT-XFER-IN-RTL-AMT   PIC S9(13)V99.              01920000
W26603             15  CT-XFER-OUT-RTL-AMT  PIC S9(13)V99.              01930000
W26603             15  CT-SLS-RTL-AMT       PIC S9(13)V99.              01940000
W26603             15  CT-SHNK-RTL-AMT      PIC S9(13)V99.              01950000
W26603             15  CT-MKDN-RTL-AMT      PIC S9(13)V99.              01960000
W26603             15  CT-END-INV-RTL-AMT   PIC S9(13)V99.              01970000
                                                                        01990000
      ******************************************************************        
      * THE FOLLOWING FIELDS HOLD THE ALL-STORE TOTALS OF EACH RETAIL           
      * AMOUNT FOR THE REPORT LEVEL THAT IS CURRENTLY BEING PRINTED.            
      *                                                                         
      * THEY ARE USED TO PRINT THE ALL-STORE TOTALS FOR THE REPORT              
      * LEVEL.                                                                  
      ******************************************************************        
                                                                                
       01  PT-PAGE-TOTALS                                 COMP-3.       04590007
W26603     05  PT-BEG-INV-RTL-AMT           PIC S9(13)V99 VALUE ZERO.   04600007
W26603     05  PT-RCPT-RTL-AMT              PIC S9(13)V99 VALUE ZERO.   04610007
W26603     05  PT-PADJ-RTL-AMT              PIC S9(13)V99 VALUE ZERO.   04610007
W26603     05  PT-XFER-IN-RTL-AMT           PIC S9(13)V99 VALUE ZERO.   04620007
W26603     05  PT-XFER-OUT-RTL-AMT          PIC S9(13)V99 VALUE ZERO.   04630007
W26603     05  PT-SLS-RTL-AMT               PIC S9(13)V99 VALUE ZERO.   04640007
W26603     05  PT-SHNK-RTL-AMT              PIC S9(13)V99 VALUE ZERO.   04650007
W26603     05  PT-MKDN-RTL-AMT              PIC S9(13)V99 VALUE ZERO.   04660007
W26603     05  PT-END-INV-RTL-AMT           PIC S9(13)V99 VALUE ZERO.   04670007
                                                                        04680000
      ******************************************************************        
      * THE FOLLOWING FIELDS HOLD THE ALL-STORE TOTALS OF SALES AND             
      * INVENTORY FOR EACH REPORT LEVEL.                                        
      *                                                                         
      * THEY ARE USED TO CALCULATE THE SALES PERCENT AND MONTH END              
      * INVENTORY PERCENT FOR EACH REPORT LEVEL.                                
      ******************************************************************        
                                                                                
       01  AT-ALL-STORES-TOTALS                           COMP-3.       05970000
W26603     05  AT-DEPT-SLS-RTL-AMT          PIC S9(13)V99 VALUE ZERO.   05980000
W26603     05  AT-DEPT-END-INV-RTL-AMT      PIC S9(13)V99 VALUE ZERO.   05990000
W26603     05  AT-BYR-SLS-RTL-AMT           PIC S9(13)V99 VALUE ZERO.   06000000
W26603     05  AT-BYR-END-INV-RTL-AMT       PIC S9(13)V99 VALUE ZERO.   06010000
W26603     05  AT-DMA-SLS-RTL-AMT           PIC S9(13)V99 VALUE ZERO.   06020000
W26603     05  AT-DMA-END-INV-RTL-AMT       PIC S9(13)V99 VALUE ZERO.   06030000
W26603     05  AT-GMA-SLS-RTL-AMT           PIC S9(13)V99 VALUE ZERO.   06040000
W26603     05  AT-GMA-END-INV-RTL-AMT       PIC S9(13)V99 VALUE ZERO.   06050000
W26603     05  AT-CO-SLS-RTL-AMT            PIC S9(13)V99 VALUE ZERO.   06060000
W26603     05  AT-CO-END-INV-RTL-AMT        PIC S9(13)V99 VALUE ZERO.   06070000
W26603     05  AT-DC-END-INV-RTL-AMT        PIC S9(13)V99 VALUE ZERO.   06080000
W26603     05  AT-CURR-SLS-RTL-AMT          PIC S9(13)V99 VALUE ZERO.   06090000
W26603     05  AT-CURR-END-INV-RTL-AMT      PIC S9(13)V99 VALUE ZERO.   06100000
                                                                        06110000
       01  PC-PROGRAM-CONSTANTS.                                                
           05  PC-MDSELV-CDE-DPT            PIC  X(03)    VALUE 'DPT'.  03970000
           05  PC-RSPLVL-CDE-BYR            PIC  X(03)    VALUE 'BYR'.  03980000
           05  PC-RSPLVL-CDE-DMM            PIC  X(03)    VALUE 'DMM'.  03990000
           05  PC-OPERCO-NBR                PIC  X(02)    VALUE '03'.   04000000
           05  PC-APLSYS-CDE                PIC  X(02)    VALUE 'ML'.   04010000
W26603     05  PC-STORE-TABLES-MAX          PIC S9(04) COMP             05900907
W26603                                                    VALUE +9999.  05901007
           05  PC-LINES-PER-PAGE            PIC S9(04) COMP             05900907
                                                          VALUE +47.    05901007
                                                                        04100000
       01  PS-PROGRAM-SWITCHES.                                         04340000
           05  PS-END-OF-STR-CSR-SW         PIC X         VALUE 'N'.    04340105
               88  PS-END-OF-STR-CSR                      VALUE 'Y'.    04340205
           05  PS-END-OF-EXTRACT-SW         PIC X         VALUE 'N'.    04340300
               88 PS-END-OF-EXTRACT                       VALUE 'Y'.    04340400
               88 PS-NOT-END-OF-EXTRACT                   VALUE 'N'.    04340400
015900     05  PS-END-OF-STR-INV-DTE-FILE-SW PIC X        VALUE 'N'.            
016000         88 PS-END-OF-STR-INV-DTE-FILE              VALUE 'Y'.            
           05  PS-BREAK-SW                  PIC 9(01)     VALUE 0.      04430000
               88  PS-DEPT-BREAK                          VALUE 1.      04440000
               88  PS-BYR-BREAK                           VALUE 2.      04450000
               88  PS-DMA-BREAK                           VALUE 3.      04460000
               88  PS-GMA-BREAK                           VALUE 4.      04470000
               88  PS-COMPANY-BREAK                       VALUE 5.      04480000
                                                                        04520000
       01  PROGRAM-VARIABLES.                                           04830000
           05  PV-PAGE-COUNTER              PIC S9(05) COMP-3           03840000
                                                          VALUE ZERO.   03850000
           05  PV-LINE-COUNTER              PIC S9(04) COMP SYNC        03860000
                                                          VALUE ZERO.   03870000
W26603     05  PV-STR-NBR                   PIC 9(05)    VALUE ZERO.    04831002
           05  PV-PARAGRAPH-NAME            PIC X(30)     VALUE SPACE.  05100000
           05  PV-DB2-OPER-ATTEMPTED        PIC X(30)     VALUE SPACE.  05110000
           05  PV-ABEND-CODE                PIC S9(04) COMP SYNC        06690000
                                                          VALUE ZERO.   06690000
                                                                        05160000
       01  SPL-SPECIAL-LINES.                                           05750000
           05  FILLER                       PIC X(23)     VALUE         05760000
           '*** DEPT *** TOTALS    '.                                   05770000
           05  FILLER                       PIC X(23)     VALUE         05780000
           '*** BUYER *** TOTALS   '.                                   05790000
           05  FILLER                       PIC X(23)     VALUE         05800000
           '*** MANAGER *** TOTALS '.                                   05810000
           05  FILLER                       PIC X(23)     VALUE         05930000
           '*** DIVISION *** TOTALS'.                                   05830000
           05  FILLER                       PIC X(23)     VALUE         05840000
           '*** COMPANY *** TOTALS '.                                   05850000
                                                                        05860000
       01  FILLER REDEFINES SPL-SPECIAL-LINES.                          05870000
           05  SPL-SPECIAL-ENTRIES OCCURS 5 TIMES.                      05880000
               10  SPL-SPECIAL-LINE         PIC X(23).                  05890000
                                                                        05900000
       01  SP-SAVE-PREVIOUS.                                            05220106
           05  SP-GMA-NBR                   PIC X(02)     VALUE ZERO.   05220206
           05  SP-DMA-NBR                   PIC X(02)     VALUE ZERO.   05220306
           05  SP-BYR-NBR                   PIC X(03)     VALUE ZERO.   05220406
           05  SP-DEPT-NBR                  PIC X(03)     VALUE ZERO.   05220506
                                                                        05220606
       01  SS-SUBSCRIPTS.                                               05220702
           05  SS-STR-NBR                   PIC S9(04) COMP SYNC        05220802
                                                          VALUE ZERO.   05221002
       01  STM-SYSTEM-TIME.                                             05910000
           05  STM-HR                       PIC 9(02)     VALUE ZERO.   05920000
           05  STM-MM                       PIC 9(02)     VALUE ZERO.   05930000
           05  STM-SS                       PIC 9(02)     VALUE ZERO.   05940000
           05  FILLER                       PIC 9(02)     VALUE ZERO.   05950000
                                                                                
       01  STD-SYSTEM-DATE.                                             05230000
           05  STD-YY                       PIC 9(02)     VALUE ZERO.   05240000
           05  STD-MM                       PIC 9(02)     VALUE ZERO.   05250000
           05  STD-DD                       PIC 9(02)     VALUE ZERO.   05260000
                                                                        06520000
      ***************************************************************   06780000
      * STORE TABLE                                                     06790000
      ***************************************************************   06800000
                                                                        06810000
           EXEC SQL                                                     06930000
W26603         INCLUDE XMT00001                                         06830000
           END-EXEC.                                                    06840000
                                                                        06850000
      ******************************************************************06940000
      *  DATE ATTRIBUTE TABLE                                           06960000
      ******************************************************************06970000
                                                                        06980000
           EXEC SQL                                                     06990000
               INCLUDE TDTATTR                                          07000000
           END-EXEC.                                                    07010000
                                                                        07020000
      ******************************************************************06940000
      *  MERCHANDISE AREA TABLE                                         06960000
      ******************************************************************06970000
                                                                        06980000
           EXEC SQL                                                     06990000
               INCLUDE TMDSEAR                                          07000000
           END-EXEC.                                                    07010000
                                                                        07020000
      ******************************************************************07030000
      *  RESPONSIBILITY AREA TABLE                                      07050000
      ******************************************************************07060000
                                                                        07070000
           EXEC SQL                                                     07080000
               INCLUDE TRSPBAR                                          07090000
           END-EXEC.                                                    07100000
                                                                        07110000
      ***************************************************************   07210000
      * DB2 COMMUNICATION AREA                                      *   07220000
      ***************************************************************   07230000
                                                                        07240000
           EXEC SQL                                                     07250000
               INCLUDE SQLCA                                            07260000
           END-EXEC.                                                    07270000
                                                                        07280000
      ***************************************************************   07290000
      *    STORE TABLE CURSOR                                           07300000
      ***************************************************************   07310000
                                                                        07320000
           EXEC SQL                                                     07330000
               DECLARE STR-CSR CURSOR FOR                               07340005
W26603             SELECT LOC_NBR                                       07350006
W26603                   ,LOC_TYP_CDE                                   07360006
W26603                   ,LOC_10_ABBR_NM                                07380006
W26603             FROM XMT_LOC                                         07400005
W26603             WHERE LOC_TYP_CDE IN ('DC','DS','RV','CS','DA')      07402005
W26603               AND (FINCL_CLO_DTE > :ML115-EXTRACT-DTE OR         07403005
W26603                    FINCL_CLO_DTE IS NULL)                        07403005
W26603             ORDER BY LOC_NBR                                             
W26603             WITH UR                                                      
           END-EXEC.                                                    07430000
                                                                        07450002
       PROCEDURE DIVISION.                                              07710000
       1000-MAIN-MODULE.                                                07730000
                                                                        07740000
           OPEN INPUT  STR-INV-EXTRACT-FILE                             07920100
                       STR-INV-DTE-FILE                                 07920300
                OUTPUT STR-INV-REPORT-FILE.                             07921000
                                                                        07930000
           PERFORM 1100-INIT.                                           07940000
                                                                        07970000
           PERFORM 7000-READ-EXTRACT.                                   08110000
                                                                                
           IF PS-END-OF-EXTRACT                                                 
               PERFORM 3150-PRINT-PAGE-HEADINGS                                 
               PERFORM 3650-WRITE-END-OF-REPORT-LINE                    22250000
           ELSE                                                                 
               PERFORM 2250-BEGIN-NEW-DEPT                                      
               PERFORM 2350-BEGIN-NEW-BYR                                       
               PERFORM 2450-BEGIN-NEW-DMA                                       
               PERFORM 2550-BEGIN-NEW-GMA                                       
                                                                                
               PERFORM 2000-PROCESS-EXTRACT                             08120000
                  UNTIL PS-END-OF-EXTRACT                               08130000
                                                                        08140000
               PERFORM 2200-DEPT-BREAK                                  12840000
               PERFORM 2300-BYR-BREAK                                           
               PERFORM 2400-DMA-BREAK                                           
               PERFORM 2500-GMA-BREAK                                   12850000
               PERFORM 2600-CO-BREAK                                    09310000
                                                                                
               PERFORM 3650-WRITE-END-OF-REPORT-LINE                    22250000
           END-IF.                                                              
                                                                        09350000
           CLOSE STR-INV-EXTRACT-FILE                                   09380000
                 STR-INV-DTE-FILE                                       09390100
                 STR-INV-REPORT-FILE.                                   09391000
                                                                        08300000
           STOP RUN.                                                    08310000
                                                                        08320000
                                                                        08321000
       1100-INIT.                                                       08330000
                                                                        08420000
      *    SET THE CURRENT DATE AND TIME AND THE REPORT NUMBER IN THE           
      *    STANDARD REPORT HEADING.                                             
                                                                                
           ACCEPT STD-SYSTEM-DATE FROM DATE.                            08450000
           ACCEPT STM-SYSTEM-TIME FROM TIME.                            08470000
                                                                        08490000
           MOVE STD-MM     TO DP175O-RUN-MONTH.                         08500000
           MOVE STD-DD     TO DP175O-RUN-DAY.                           08510000
           MOVE STD-YY     TO DP175O-RUN-YEAR.                          08520000
           MOVE STM-HR     TO DP175O-RUN-HOUR.                          08530000
           MOVE STM-MM     TO DP175O-RUN-MINUTE.                        08540000
           MOVE 'MLKRP205' TO DP175O-PROGRAM-NAME.                      08550000
           MOVE 1          TO DP175O-REPORT-NUMBER.                     08560000
                                                                        08570000
      *    SET THE FISCAL MONTH NAME AND FISCAL YEAR NUMBER IN THE              
      *    REPORT HEADING.                                                      
                                                                                
056300     PERFORM 7100-READ-STR-INV-DTE-FILE.                                  
056400                                                                          
056500     IF PS-END-OF-STR-INV-DTE-FILE                                        
056600         DISPLAY '** ABEND **'                                            
056700         DISPLAY '** PROGRAM MLKRP205 **'                                 
056800         DISPLAY '** PARAGRAPH 1100-INIT'                                 
056900         DISPLAY '** STORE INVENTORY REPORT DATE FILE IS EMPTY.'          
057000         MOVE +4003 TO PV-ABEND-CODE                                      
057100         PERFORM 9999-ABEND                                               
057200     END-IF.                                                              
057300                                                                          
           MOVE ML115-EXTRACT-DTE TO DTATTR-KY-DTE.                             
                                                                                
           PERFORM 8050-GET-DATE-ATTRIBUTES.                                    
                                                                                
           MOVE DTATTR-FSCL-YR-NBR TO PH2-FSCL-YR-NBR.                          
           MOVE DTATTR-FSCL-MN-NM  TO PH2-FSCL-MN-NM.                           
                                                                                
      *    INITIALIZE THE STORE TOTALS TABLES.                                  
                                                                                
           INITIALIZE DT-DEPT-TOTALS                                    03140000
                      BT-BUYER-TOTALS                                   03291001
                      MT-MANAGER-TOTALS                                 03299801
                      DVT-DIVISION-TOTALS                               03302000
                      FT-FINAL-TOTALS.                                  03451001
                                                                        08610000
      *    LOAD THE STORE TABLE.                                        09310102
                                                                        09310202
           PERFORM 8100-OPEN-STR-CSR.                                   09310305
                                                                        09310402
           PERFORM 9300-FETCH-STR-CSR.                                  09310505
                                                                        09310602
           PERFORM UNTIL PS-END-OF-STR-CSR                              09310707
W26603         MOVE XMT00001-LOC-NBR   TO PV-STR-NBR                    09311107
               MOVE PV-STR-NBR         TO SS-STR-NBR                    09311407
                                                                                
               IF SS-STR-NBR > PC-STORE-TABLES-MAX                      09310907
                   MOVE +4004 TO PV-ABEND-CODE                          09312707
                   DISPLAY '** ABEND'                                   09312807
                   DISPLAY '** PROGRAM    = MLKRP205'                   09312907
                   DISPLAY '** PARAGRAPH  = 1100-INIT'                  09313007
                   DISPLAY '** TABLE OVERFLOW ON ST-STORE-TABLE.'       09313107
                   CALL 'ILBOABN0'  USING PV-ABEND-CODE                 09314007
               END-IF                                                   09314407
                                                                                
               MOVE PV-STR-NBR         TO ST-STR-NBR   (SS-STR-NBR)     09311407
W26603         MOVE XMT00001-LOC-TYP-CDE TO ST-TYPE-CODE (SS-STR-NBR)   09311607
W26603         MOVE XMT00001-LOC-10-ABBR-NM                             09311807
                                       TO ST-ABBR-NAME (SS-STR-NBR)     09311907
               PERFORM 9300-FETCH-STR-CSR                               09312007
           END-PERFORM.                                                 09312107
                                                                        09314507
           PERFORM 8300-CLOSE-STR-CSR.                                  09315007
                                                                        09330000
      *    MISCELLANEOUS                                                        
                                                                        09331000
           MOVE +20 TO DP024-FLNAME-LENGTH.                             08640000
                                                                        08650000
                                                                        09331000
       2000-PROCESS-EXTRACT.                                            11960000
                                                                        11970000
      *    CHECK FOR BREAKS.                                                    
                                                                                
           IF ML109-GMA-NBR NOT =  SP-GMA-NBR                           12830006
               PERFORM 2200-DEPT-BREAK                                  12840000
               PERFORM 2300-BYR-BREAK                                           
               PERFORM 2400-DMA-BREAK                                           
               PERFORM 2500-GMA-BREAK                                   12850000
           ELSE                                                         12860000
               IF ML109-DMA-NBR NOT = SP-DMA-NBR                        12880006
                   PERFORM 2200-DEPT-BREAK                              12890000
                   PERFORM 2300-BYR-BREAK                                       
                   PERFORM 2400-DMA-BREAK                               12900000
               ELSE                                                     12910000
                   IF ML109-BYR-NBR NOT = SP-BYR-NBR                    12930006
                       PERFORM 2200-DEPT-BREAK                          12940000
                       PERFORM 2300-BYR-BREAK                           12950000
                   ELSE                                                 12960000
                       IF ML109-DEPT-NBR NOT = SP-DEPT-NBR              12930006
                           PERFORM 2200-DEPT-BREAK                      12970000
                       END-IF                                           12980000
                   END-IF                                               12980000
               END-IF                                                   13000000
           END-IF.                                                      13020000
                                                                                
           IF ML109-STR-NBR NOT = ZERO                                          
               PERFORM 2100-ACCUMULATE-DETAIL                           12350006
           END-IF.                                                              
                                                                                
           PERFORM 7000-READ-EXTRACT.                                   12510000
                                                                        12520006
                                                                        12521006
       2100-ACCUMULATE-DETAIL.                                          13040000
                                                                        13160000
           MOVE ML109-STR-NBR       TO PV-STR-NBR.                      12230106
           MOVE PV-STR-NBR          TO SS-STR-NBR.                      12230206
                                                                        12231006
           ADD  ML109-BEG-INV-RTL-AMT                                   13170006
                                    TO DT-BEG-INV-RTL-AMT  (SS-STR-NBR).13180006
           ADD  ML109-SLS-RTL-AMT   TO DT-SLS-RTL-AMT      (SS-STR-NBR).13210006
           ADD  ML109-MKDN-RTL-AMT  TO DT-MKDN-RTL-AMT     (SS-STR-NBR).13220006
           ADD  ML109-XFER-IN-RTL-AMT                                   13230006
                                    TO DT-XFER-IN-RTL-AMT  (SS-STR-NBR).13231006
           ADD  ML109-XFER-OUT-RTL-AMT                                  13240006
                                    TO DT-XFER-OUT-RTL-AMT (SS-STR-NBR).13250006
WR5701     ADD  ML109-RCPT-RTL-AMT  TO DT-RCPT-RTL-AMT     (SS-STR-NBR).13340006
WR5701     ADD  ML109-PADJ-RTL-AMT  TO DT-PADJ-RTL-AMT     (SS-STR-NBR).13350006
WR5701     ADD  ML109-MKUP-RTL-AMT  TO DT-PADJ-RTL-AMT     (SS-STR-NBR).13360006
           ADD  ML109-SHNK-RTL-AMT  TO DT-SHNK-RTL-AMT     (SS-STR-NBR).13370006
           ADD  ML109-INV-ADJ-RTL-AMT                                   13380006
                                    TO DT-SHNK-RTL-AMT     (SS-STR-NBR).13381006
           ADD  ML109-END-INV-RTL-AMT                                   13390006
                                     TO DT-END-INV-RTL-AMT (SS-STR-NBR).13400006
                                                                        13510000
           ADD  ML109-SLS-RTL-AMT    TO AT-DEPT-SLS-RTL-AMT.            13570006
                                                                        13580006
           IF ST-TYPE-CODE (SS-STR-NBR) = 'DC' OR 'CS' OR 'RV' OR 'DA'  13810006
               ADD ML109-END-INV-RTL-AMT TO AT-DC-END-INV-RTL-AMT       13930006
           ELSE                                                         13830006
               ADD ML109-END-INV-RTL-AMT TO AT-DEPT-END-INV-RTL-AMT     13840006
           END-IF.                                                      13890006
                                                                        13920006
                                                                        13921006
       2200-DEPT-BREAK.                                                 14070000
                                                                        14080000
           SET PS-DEPT-BREAK            TO TRUE.                        14150000
                                                                        14160000
           MOVE DT-DEPT-TOTALS          TO CT-CURRENT-TOTALS.           14170000
           MOVE AT-DEPT-SLS-RTL-AMT     TO AT-CURR-SLS-RTL-AMT.         14180000
           MOVE AT-DEPT-END-INV-RTL-AMT TO AT-CURR-END-INV-RTL-AMT.     14190000
                                                                        14200000
           PERFORM 3000-PRINT-STORE-LINES.                              14210006
                                                                        14250000
      *    ADD THE DEPARTMENT STORE TOTALS TO THE BUYER STORE TOTALS.           
                                                                                
           PERFORM VARYING SS-STR-NBR FROM 1 BY 1                               
             UNTIL SS-STR-NBR > PC-STORE-TABLES-MAX                             
                                                                                
               IF ST-STR-NBR (SS-STR-NBR) NOT = ZERO                            
                   ADD DT-BEG-INV-RTL-AMT   (SS-STR-NBR)                13180006
                    TO BT-BEG-INV-RTL-AMT   (SS-STR-NBR)                13180006
                                                                                
                   ADD DT-SLS-RTL-AMT       (SS-STR-NBR)                13210006
                    TO BT-SLS-RTL-AMT       (SS-STR-NBR)                13210006
                                                                                
                   ADD DT-MKDN-RTL-AMT      (SS-STR-NBR)                13220006
                    TO BT-MKDN-RTL-AMT      (SS-STR-NBR)                13220006
                                                                                
                   ADD DT-XFER-IN-RTL-AMT   (SS-STR-NBR)                13231006
                    TO BT-XFER-IN-RTL-AMT   (SS-STR-NBR)                13231006
                                                                                
                   ADD DT-XFER-OUT-RTL-AMT  (SS-STR-NBR)                13250006
                    TO BT-XFER-OUT-RTL-AMT  (SS-STR-NBR)                13250006
                                                                                
WR5701             ADD DT-RCPT-RTL-AMT      (SS-STR-NBR)                13340006
WR5701              TO BT-RCPT-RTL-AMT      (SS-STR-NBR)                13340006
                                                                                
WR5701             ADD DT-PADJ-RTL-AMT      (SS-STR-NBR)                13340006
WR5701              TO BT-PADJ-RTL-AMT      (SS-STR-NBR)                13340006
                                                                                
                   ADD DT-SHNK-RTL-AMT      (SS-STR-NBR)                13370006
                    TO BT-SHNK-RTL-AMT      (SS-STR-NBR)                13370006
                                                                                
                   ADD DT-END-INV-RTL-AMT   (SS-STR-NBR)                13400006
                    TO BT-END-INV-RTL-AMT   (SS-STR-NBR)                13400006
                END-IF                                                          
                                                                                
           END-PERFORM.                                                         
                                                                                
      *    ADD THE DEPARTMENT ALL-STORE TOTALS TO THE BUYER                     
      *    ALL-STORE TOTALS.                                                    
                                                                                
           ADD AT-DEPT-SLS-RTL-AMT     TO AT-BYR-SLS-RTL-AMT.           13570006
           ADD AT-DEPT-END-INV-RTL-AMT TO AT-BYR-END-INV-RTL-AMT.       13840006
                                                                                
           IF PS-NOT-END-OF-EXTRACT                                     04340400
               PERFORM 2250-BEGIN-NEW-DEPT                                      
           END-IF.                                                              
                                                                                
                                                                                
       2250-BEGIN-NEW-DEPT.                                                     
                                                                                
           MOVE ML109-DEPT-NBR TO SP-DEPT-NBR.                          12230006
                                                                                
           INITIALIZE DT-DEPT-TOTALS                                    14260006
                      AT-DEPT-SLS-RTL-AMT                               14280000
                      AT-DEPT-END-INV-RTL-AMT.                          14290007
                                                                                
           MOVE SP-DEPT-NBR    TO SH5-DEPT-NBR.                         12640000
                                                                                
           PERFORM 8600-GET-DEPT-DESC.                                  12630000
           MOVE MDSEAR-DESC    TO SH5-DEPT-DESC.                        12650000
                                                                        12660000
                                                                        14310000
       2300-BYR-BREAK.                                                  14320000
                                                                        14330000
           SET PS-BYR-BREAK             TO TRUE.                        14400000
                                                                        14410000
           MOVE BT-BUYER-TOTALS         TO CT-CURRENT-TOTALS.           14420000
           MOVE AT-BYR-SLS-RTL-AMT      TO AT-CURR-SLS-RTL-AMT.         14430000
           MOVE AT-BYR-END-INV-RTL-AMT  TO AT-CURR-END-INV-RTL-AMT.     14440000
                                                                        14450000
           PERFORM 3000-PRINT-STORE-LINES.                              14460006
                                                                        14500000
      *    ADD THE BUYER STORE TOTALS TO THE DMA (MANAGER) STORE TOTALS.        
                                                                                
           PERFORM VARYING SS-STR-NBR FROM 1 BY 1                               
             UNTIL SS-STR-NBR > PC-STORE-TABLES-MAX                             
                                                                                
               IF ST-STR-NBR (SS-STR-NBR) NOT = ZERO                            
                   ADD BT-BEG-INV-RTL-AMT   (SS-STR-NBR)                13180006
                    TO MT-BEG-INV-RTL-AMT   (SS-STR-NBR)                13180006
                                                                                
                   ADD BT-SLS-RTL-AMT       (SS-STR-NBR)                13210006
                    TO MT-SLS-RTL-AMT       (SS-STR-NBR)                13210006
                                                                                
                   ADD BT-MKDN-RTL-AMT      (SS-STR-NBR)                13220006
                    TO MT-MKDN-RTL-AMT      (SS-STR-NBR)                13220006
                                                                                
                   ADD BT-XFER-IN-RTL-AMT   (SS-STR-NBR)                13231006
                    TO MT-XFER-IN-RTL-AMT   (SS-STR-NBR)                13231006
                                                                                
                   ADD BT-XFER-OUT-RTL-AMT  (SS-STR-NBR)                13250006
                    TO MT-XFER-OUT-RTL-AMT  (SS-STR-NBR)                13250006
                                                                                
WR5701             ADD BT-RCPT-RTL-AMT      (SS-STR-NBR)                13340006
WR5701              TO MT-RCPT-RTL-AMT      (SS-STR-NBR)                13340006
                                                                                
WR5701             ADD BT-PADJ-RTL-AMT      (SS-STR-NBR)                13340006
WR5701              TO MT-PADJ-RTL-AMT      (SS-STR-NBR)                13340006
                                                                                
                   ADD BT-SHNK-RTL-AMT      (SS-STR-NBR)                13370006
                    TO MT-SHNK-RTL-AMT      (SS-STR-NBR)                13370006
                                                                                
                   ADD BT-END-INV-RTL-AMT   (SS-STR-NBR)                13400006
                    TO MT-END-INV-RTL-AMT   (SS-STR-NBR)                13400006
                END-IF                                                          
                                                                                
           END-PERFORM.                                                         
                                                                                
      *    ADD THE BUYER ALL-STORE TOTALS TO THE DMA (MANAGER)                  
      *    ALL-STORE TOTALS.                                                    
                                                                                
           ADD AT-BYR-SLS-RTL-AMT     TO AT-DMA-SLS-RTL-AMT             13570006
           ADD AT-BYR-END-INV-RTL-AMT TO AT-DMA-END-INV-RTL-AMT         13840006
                                                                                
           IF PS-NOT-END-OF-EXTRACT                                     04340400
               PERFORM 2350-BEGIN-NEW-BYR                                       
           END-IF.                                                              
                                                                                
                                                                                
       2350-BEGIN-NEW-BYR.                                                      
                                                                                
           MOVE ML109-BYR-NBR           TO SP-BYR-NBR.                  12220006
                                                                                
           INITIALIZE BT-BUYER-TOTALS                                   14510006
                      AT-BYR-SLS-RTL-AMT                                14530007
                      AT-BYR-END-INV-RTL-AMT.                           14530007
                                                                        14560000
                                                                                
           MOVE SP-BYR-NBR              TO SH4-BYR-NBR.                 12680006
                                                                                
           PERFORM 8400-GET-BUYER-NAME.                                 12670000
           MOVE RSPBAR-WORKER-FIR-NAME  TO DP024-FNAME.                 12690000
           MOVE RSPBAR-WORKER-LAST-NAME TO DP024-LNAME.                 12700000
           PERFORM DP024-0000-FORMAT-NAME.                              12710000
           MOVE DP024-FLNAME            TO SH4-BUYER-NAME.              12720000
                                                                        12730000
                                                                        14560000
       2400-DMA-BREAK.                                                  14570000
                                                                        14580000
           SET PS-DMA-BREAK             TO TRUE.                        14650000
                                                                        14660000
           MOVE MT-MANAGER-TOTALS       TO CT-CURRENT-TOTALS.           14670000
           MOVE AT-DMA-SLS-RTL-AMT      TO AT-CURR-SLS-RTL-AMT.         14680000
           MOVE AT-DMA-END-INV-RTL-AMT  TO AT-CURR-END-INV-RTL-AMT.     14690000
                                                                        14700000
           PERFORM 3000-PRINT-STORE-LINES.                              14710006
                                                                        14750000
      *    ADD THE DMA (MANAGER) STORE TOTALS TO THE                            
      *    GMA (DIVISION) STORE TOTALS.                                         
                                                                                
           PERFORM VARYING SS-STR-NBR FROM 1 BY 1                               
             UNTIL SS-STR-NBR > PC-STORE-TABLES-MAX                             
                                                                                
               IF ST-STR-NBR (SS-STR-NBR) NOT = ZERO                            
                   ADD MT-BEG-INV-RTL-AMT   (SS-STR-NBR)                13180006
                    TO DVT-BEG-INV-RTL-AMT  (SS-STR-NBR)                13180006
                                                                                
                   ADD MT-SLS-RTL-AMT       (SS-STR-NBR)                13210006
                    TO DVT-SLS-RTL-AMT      (SS-STR-NBR)                13210006
                                                                                
                   ADD MT-MKDN-RTL-AMT      (SS-STR-NBR)                13220006
                    TO DVT-MKDN-RTL-AMT     (SS-STR-NBR)                13220006
                                                                                
                   ADD MT-XFER-IN-RTL-AMT   (SS-STR-NBR)                13231006
                    TO DVT-XFER-IN-RTL-AMT  (SS-STR-NBR)                13231006
                                                                                
                   ADD MT-XFER-OUT-RTL-AMT  (SS-STR-NBR)                13250006
                    TO DVT-XFER-OUT-RTL-AMT (SS-STR-NBR)                13250006
                                                                                
WR5701             ADD MT-RCPT-RTL-AMT      (SS-STR-NBR)                13340006
WR5701              TO DVT-RCPT-RTL-AMT     (SS-STR-NBR)                13340006
                                                                                
WR5701             ADD MT-PADJ-RTL-AMT      (SS-STR-NBR)                13340006
WR5701              TO DVT-PADJ-RTL-AMT     (SS-STR-NBR)                13340006
                                                                                
                   ADD MT-SHNK-RTL-AMT      (SS-STR-NBR)                13370006
                    TO DVT-SHNK-RTL-AMT     (SS-STR-NBR)                13370006
                                                                                
                   ADD MT-END-INV-RTL-AMT   (SS-STR-NBR)                13400006
                    TO DVT-END-INV-RTL-AMT  (SS-STR-NBR)                13400006
                END-IF                                                          
                                                                                
           END-PERFORM.                                                         
                                                                                
      *    ADD THE DMA (MANAGER) ALL-STORE TOTALS TO THE                        
      *    GMA (DIVISION) ALL-STORE TOTALS.                                     
                                                                                
           ADD AT-DMA-SLS-RTL-AMT     TO AT-GMA-SLS-RTL-AMT             13570006
           ADD AT-DMA-END-INV-RTL-AMT TO AT-GMA-END-INV-RTL-AMT         13840006
                                                                                
           IF PS-NOT-END-OF-EXTRACT                                     04340400
               PERFORM 2450-BEGIN-NEW-DMA                                       
           END-IF.                                                              
                                                                                
                                                                                
       2450-BEGIN-NEW-DMA.                                                      
                                                                                
           MOVE ML109-DMA-NBR           TO SP-DMA-NBR.                  12210006
                                                                                
           INITIALIZE MT-MANAGER-TOTALS                                 14760006
                      AT-DMA-SLS-RTL-AMT                                14780000
                      AT-DMA-END-INV-RTL-AMT.                           14790007
                                                                        14810000
           MOVE SP-DMA-NBR              TO SH3-MANAGER-NBR.             12750000
                                                                                
           PERFORM 8500-GET-DMM-NAME.                                   12740000
           MOVE RSPBAR-WORKER-FIR-NAME  TO DP024-FNAME.                 12760000
           MOVE RSPBAR-WORKER-LAST-NAME TO DP024-LNAME.                 12770000
           PERFORM DP024-0000-FORMAT-NAME.                              12780000
           MOVE DP024-FLNAME            TO SH3-MANAGER-NAME.            12790000
                                                                        12800000
                                                                        14810000
       2500-GMA-BREAK.                                                  14930000
                                                                        14890000
           SET PS-GMA-BREAK            TO TRUE.                         14900000
                                                                        14910000
           MOVE DVT-DIVISION-TOTALS    TO CT-CURRENT-TOTALS.            14920000
           MOVE AT-GMA-SLS-RTL-AMT     TO AT-CURR-SLS-RTL-AMT.          14930000
           MOVE AT-GMA-END-INV-RTL-AMT TO AT-CURR-END-INV-RTL-AMT.      14940000
                                                                        14950000
           PERFORM 3000-PRINT-STORE-LINES.                              14960006
                                                                        15000000
      *    ADD THE GMA (DIVISION) STORE TOTALS TO THE                           
      *    COMPANY STORE TOTALS.                                                
                                                                                
           PERFORM VARYING SS-STR-NBR FROM 1 BY 1                               
             UNTIL SS-STR-NBR > PC-STORE-TABLES-MAX                             
                                                                                
               IF ST-STR-NBR (SS-STR-NBR) NOT = ZERO                            
                   ADD DVT-BEG-INV-RTL-AMT  (SS-STR-NBR)                13180006
                    TO FT-BEG-INV-RTL-AMT   (SS-STR-NBR)                13180006
                                                                                
                   ADD DVT-SLS-RTL-AMT      (SS-STR-NBR)                13210006
                    TO FT-SLS-RTL-AMT       (SS-STR-NBR)                13210006
                                                                                
                   ADD DVT-MKDN-RTL-AMT     (SS-STR-NBR)                13220006
                    TO FT-MKDN-RTL-AMT      (SS-STR-NBR)                13220006
                                                                                
                   ADD DVT-XFER-IN-RTL-AMT  (SS-STR-NBR)                13231006
                    TO FT-XFER-IN-RTL-AMT   (SS-STR-NBR)                13231006
                                                                                
                   ADD DVT-XFER-OUT-RTL-AMT (SS-STR-NBR)                13250006
                    TO FT-XFER-OUT-RTL-AMT  (SS-STR-NBR)                13250006
                                                                                
WR5701             ADD DVT-RCPT-RTL-AMT     (SS-STR-NBR)                13340006
WR5701              TO FT-RCPT-RTL-AMT      (SS-STR-NBR)                13340006
                                                                                
WR5701             ADD DVT-PADJ-RTL-AMT     (SS-STR-NBR)                13340006
WR5701              TO FT-PADJ-RTL-AMT      (SS-STR-NBR)                13340006
                                                                                
                   ADD DVT-SHNK-RTL-AMT     (SS-STR-NBR)                13370006
                    TO FT-SHNK-RTL-AMT      (SS-STR-NBR)                13370006
                                                                                
                   ADD DVT-END-INV-RTL-AMT  (SS-STR-NBR)                13400006
                    TO FT-END-INV-RTL-AMT   (SS-STR-NBR)                13400006
                END-IF                                                          
                                                                                
           END-PERFORM.                                                         
                                                                                
      *    ADD THE GMA (DIVISION) ALL-STORE TOTALS TO THE                       
      *    COMPANY ALL-STORE TOTALS.                                            
                                                                                
           ADD AT-GMA-SLS-RTL-AMT     TO AT-CO-SLS-RTL-AMT              13570006
           ADD AT-GMA-END-INV-RTL-AMT TO AT-CO-END-INV-RTL-AMT          13840006
                                                                                
           IF PS-NOT-END-OF-EXTRACT                                     04340400
               PERFORM 2550-BEGIN-NEW-GMA                                       
           END-IF.                                                              
                                                                                
                                                                                
       2550-BEGIN-NEW-GMA.                                                      
                                                                                
           MOVE ML109-GMA-NBR  TO SP-GMA-NBR.                           12200006
                                                                                
           INITIALIZE DVT-DIVISION-TOTALS                               15010006
                      AT-GMA-SLS-RTL-AMT                                15030000
                      AT-GMA-END-INV-RTL-AMT.                           15040007
                                                                                
           MOVE SP-GMA-NBR     TO SH2-DIVISION.                         12810006
                                                                        15060000
                                                                        15060000
       2600-CO-BREAK.                                                   15070000
                                                                        15140000
           SET PS-COMPANY-BREAK       TO TRUE.                          15150000
                                                                        15160000
           MOVE FT-FINAL-TOTALS       TO CT-CURRENT-TOTALS.             15170000
           MOVE AT-CO-SLS-RTL-AMT     TO AT-CURR-SLS-RTL-AMT.           15180000
           MOVE AT-CO-END-INV-RTL-AMT TO AT-CURR-END-INV-RTL-AMT.       15190000
                                                                        15200000
           PERFORM 3000-PRINT-STORE-LINES.                              15210006
                                                                        15250000
                                                                        15270000
       3000-PRINT-STORE-LINES.                                          15280000
                                                                        15330000
           PERFORM 3100-PRINT-HEADINGS.                                 15340000
                                                                        15350000
           INITIALIZE  PT-PAGE-TOTALS.                                  15360007
                                                                        15380000
           PERFORM                                                      15410007
               VARYING SS-STR-NBR FROM 1 BY 1                           15411007
                 UNTIL SS-STR-NBR > PC-STORE-TABLES-MAX                 15420007
               IF ST-STR-NBR (SS-STR-NBR) = ZERO                                
                   CONTINUE                                                     
               ELSE                                                             
                   PERFORM 3200-PRINT-A-STORE                           15410007
               END-IF                                                           
           END-PERFORM.                                                         
                                                                        15421007
           PERFORM 3300-PRINT-PAGE-TOTALS.                              15430007
                                                                        15440000
                                                                        15470000
       3100-PRINT-HEADINGS.                                             18720000
                                                                        18730000
           PERFORM 3150-PRINT-PAGE-HEADINGS.                                    
                                                                                
           IF PS-COMPANY-BREAK                                          19020000
               WRITE STR-INV-REPORT-RECORD                              19030000
                   FROM SH1-SUB-HEADING-1                               19040000
                   AFTER ADVANCING 2 LINES                              19050000
           END-IF.                                                      19060000
                                                                        19070000
           IF PS-DEPT-BREAK                                             19080000
           OR PS-BYR-BREAK                                              19090000
           OR PS-DMA-BREAK                                              19100000
           OR PS-GMA-BREAK                                              19110000
               WRITE STR-INV-REPORT-RECORD                              19120000
                   FROM SH2-SUB-HEADING-2                               19130000
                   AFTER ADVANCING 2 LINES                              19140000
           END-IF.                                                      19150000
                                                                        19160000
           IF PS-DEPT-BREAK                                             19170000
           OR PS-BYR-BREAK                                              19180000
           OR PS-DMA-BREAK                                              19190000
               WRITE STR-INV-REPORT-RECORD                              19200000
                   FROM SH3-SUB-HEADING-3                               19210000
                   AFTER ADVANCING 1 LINE                               19220000
           END-IF.                                                      19230000
                                                                        19240000
           IF PS-DEPT-BREAK                                             19250000
           OR PS-BYR-BREAK                                              19260000
               WRITE STR-INV-REPORT-RECORD                              19270000
                   FROM SH4-SUB-HEADING-4                               19280000
                   AFTER ADVANCING 1 LINE                               19290000
           END-IF.                                                      19300000
                                                                        19310000
           IF PS-DEPT-BREAK                                             19320000
               WRITE STR-INV-REPORT-RECORD                              19330000
                   FROM SH5-SUB-HEADING-5                               19340000
                   AFTER ADVANCING 1 LINE                               19350000
           END-IF.                                                      19360000
                                                                        19370000
           WRITE STR-INV-REPORT-RECORD                                  19500000
               FROM DH1-DETAIL-HEADING-1                                19510000
               AFTER ADVANCING 2 LINES.                                 19520000
                                                                        19530000
           WRITE STR-INV-REPORT-RECORD                                  19540000
               FROM DH2-DETAIL-HEADING-2                                19550000
               AFTER ADVANCING 1 LINE.                                  19560000
                                                                        19570000
           INITIALIZE STR-INV-REPORT-RECORD.                            19580000
           WRITE STR-INV-REPORT-RECORD                                  19590000
               AFTER ADVANCING 1 LINE.                                  19600000
                                                                        19610000
           INITIALIZE PV-LINE-COUNTER.                                  19620000
                                                                        19630000
                                                                        20160000
       3150-PRINT-PAGE-HEADINGS.                                                
                                                                                
           ADD  1               TO PV-PAGE-COUNTER.                     18870000
           MOVE PV-PAGE-COUNTER TO DP175O-PAGE-NUMBER.                  18880000
                                                                        18890000
           WRITE STR-INV-REPORT-RECORD                                  18900000
               FROM DP175O-STANDRD-HEADER-175-COLS                      18910000
               AFTER ADVANCING PAGE.                                    18920000
                                                                        18930000
           WRITE STR-INV-REPORT-RECORD                                  18940000
               FROM PH2-PAGE-HEADING-2                                  18950000
               AFTER ADVANCING 1 LINE.                                  18960000
                                                                        18970000
           WRITE STR-INV-REPORT-RECORD                                  18980000
               FROM PH3-PAGE-HEADING-3                                  18990000
               AFTER ADVANCING 1 LINE.                                  19000000
                                                                        19010000
                                                                        19010000
       3200-PRINT-A-STORE.                                              15490007
                                                                        15500000
      ***************************************************************   15510000
      *    PRINT A DETAIL LINE FOR EACH STORE IN THE STORE TABLE.       15520007
      *    ACCUMULATE THE PAGE TOTALS FOR ALL STORES.                   15530007
      ***************************************************************   15600000
                                                                        15680000
WR9999      MOVE ST-STR-NBR         (SS-STR-NBR) TO SV-STORE-NBR-NUM.   15730007
WR9999      MOVE SV-STORE-NBR-NUM                TO SV-STORE-NBR-2-4.   15900007
WR9999      MOVE SV-STORE-NBR-2-4                TO DL-STORE-NBR.       02730000
WR9999                                                                  02730000
            MOVE ST-ABBR-NAME       (SS-STR-NBR) TO DL-STORE-NAME.      15730007
                                                                        15900007
            COMPUTE DL-BGN-INVENTORY ROUNDED =                          15910007
                CT-BEG-INV-RTL-AMT  (SS-STR-NBR) / 1000.                15920007
                                                                        15970000
WR5701      COMPUTE DL-RECEIPTS      ROUNDED =                          15950007
WR5701          CT-RCPT-RTL-AMT     (SS-STR-NBR) / 1000.                15960007
                                                                        15970000
WR5701      COMPUTE DL-PURCHASE-ADJ  ROUNDED =                          15950007
WR5701          CT-PADJ-RTL-AMT     (SS-STR-NBR) / 1000.                15960007
                                                                        15970000
            COMPUTE DL-TRANSFERS-IN  ROUNDED =                          15990007
                CT-XFER-IN-RTL-AMT  (SS-STR-NBR) / 1000.                16000007
                                                                        16010000
            COMPUTE DL-TRANSFERS-OUT ROUNDED =                          16030007
                CT-XFER-OUT-RTL-AMT (SS-STR-NBR) / 1000.                16040007
                                                                        16050000
            COMPUTE DL-SALES         ROUNDED =                          16070007
                CT-SLS-RTL-AMT      (SS-STR-NBR) / 1000.                16080007
                                                                        16090000
            COMPUTE DL-SHRINK        ROUNDED =                          16160007
                CT-SHNK-RTL-AMT     (SS-STR-NBR) / 1000.                16170007
                                                                        16180000
            COMPUTE DL-MARKDOWNS     ROUNDED =                          16200007
                CT-MKDN-RTL-AMT     (SS-STR-NBR) / 1000.                16210007
                                                                        16220000
            COMPUTE DL-MTH-END-INV   ROUNDED =                          16240007
                CT-END-INV-RTL-AMT  (SS-STR-NBR) / 1000.                16250007
                                                                        16260000
            COMPUTE DL-RED-TOTAL     ROUNDED =                          16270007
                (CT-SLS-RTL-AMT  (SS-STR-NBR)                           16280007
               + CT-SHNK-RTL-AMT (SS-STR-NBR)                           16280007
               + CT-MKDN-RTL-AMT (SS-STR-NBR))   / 1000.                16290007
                                                                        16300000
            IF AT-CURR-SLS-RTL-AMT NOT = ZERO                           16310007
                COMPUTE DL-SALES-PCT ROUNDED =                          16320007
                    (CT-SLS-RTL-AMT (SS-STR-NBR) * 100) /               16330007
                     AT-CURR-SLS-RTL-AMT                                16340007
                    ON SIZE ERROR INITIALIZE DL-SALES-PCT               16350007
            ELSE                                                        16370007
                INITIALIZE DL-SALES-PCT                                 16380007
            END-IF.                                                     16390007
                                                                        16400000
            IF CT-SLS-RTL-AMT (SS-STR-NBR) NOT = ZERO                   16410007
                COMPUTE DL-SHRINK-PCT ROUNDED =                         16420007
                    (CT-SHNK-RTL-AMT (SS-STR-NBR) * 100) /              16430007
                     CT-SLS-RTL-AMT (SS-STR-NBR)                        16440007
                    ON SIZE ERROR INITIALIZE DL-SHRINK-PCT              16450007
            ELSE                                                        16470007
                INITIALIZE DL-SHRINK-PCT                                16480007
            END-IF.                                                     16490007
                                                                        16500000
            IF CT-SLS-RTL-AMT (SS-STR-NBR) NOT = ZERO                   16510007
                COMPUTE DL-MARKDOWN-PCT ROUNDED =                       16520007
                    (CT-MKDN-RTL-AMT(SS-STR-NBR) * 100) /               16530007
                     CT-SLS-RTL-AMT(SS-STR-NBR)                         16540007
                    ON SIZE ERROR INITIALIZE DL-MARKDOWN-PCT            16550007
           ELSE                                                         16570007
               INITIALIZE DL-MARKDOWN-PCT                               16580007
           END-IF.                                                      16590007
                                                                        16610000
           IF ST-TYPE-CODE (SS-STR-NBR) = 'DC' OR 'CS' OR 'RV' OR 'DA'  16630007
               INITIALIZE DL-END-INV-PCT                                16650007
           ELSE                                                         16660007
               IF AT-CURR-END-INV-RTL-AMT NOT = ZERO                    16680007
                   COMPUTE DL-END-INV-PCT ROUNDED =                     16690007
                       (CT-END-INV-RTL-AMT(SS-STR-NBR) * 100) /         16700007
                        AT-CURR-END-INV-RTL-AMT                         16710007
                       ON SIZE ERROR INITIALIZE DL-END-INV-PCT          16720007
               ELSE                                                     16740007
                   INITIALIZE DL-END-INV-PCT                            16750007
               END-IF                                                   16760007
           END-IF.                                                      16780007
                                                                        16790000
           PERFORM 3400-PRINT-A-LINE.                                   16800007
                                                                        16810000
           ADD CT-BEG-INV-RTL-AMT  (SS-STR-NBR) TO PT-BEG-INV-RTL-AMT.  16930007
WR5701     ADD CT-RCPT-RTL-AMT     (SS-STR-NBR) TO PT-RCPT-RTL-AMT.     16840007
WR5701     ADD CT-PADJ-RTL-AMT     (SS-STR-NBR) TO PT-PADJ-RTL-AMT.     16840007
           ADD CT-XFER-IN-RTL-AMT  (SS-STR-NBR) TO PT-XFER-IN-RTL-AMT.  16860007
           ADD CT-XFER-OUT-RTL-AMT (SS-STR-NBR) TO PT-XFER-OUT-RTL-AMT. 16880007
           ADD CT-SLS-RTL-AMT      (SS-STR-NBR) TO PT-SLS-RTL-AMT.      16900007
           ADD CT-SHNK-RTL-AMT     (SS-STR-NBR) TO PT-SHNK-RTL-AMT.     16920007
           ADD CT-MKDN-RTL-AMT     (SS-STR-NBR) TO PT-MKDN-RTL-AMT.     16940007
           ADD CT-END-INV-RTL-AMT  (SS-STR-NBR) TO PT-END-INV-RTL-AMT.  16960007
                                                                        16990000
                                                                        17020006
       3300-PRINT-PAGE-TOTALS.                                          17030007
                                                                        17040000
      ***************************************************************   17050000
      *    PRINT THE 'ALL STORES' TOTALS AT THE END OF THE PAGE.        17060007
      ***************************************************************   17090000
                                                                        17100000
           COMPUTE TL-BGN-INVENTORY ROUNDED =                           17140000
               PT-BEG-INV-RTL-AMT     / 1000.                           17150007
                                                                        17200000
WR5701     COMPUTE TL-RECEIPTS      ROUNDED =                           17180000
WR5701         PT-RCPT-RTL-AMT        / 1000.                           17190007
                                                                        17200000
WR5701     COMPUTE TL-PURCHASE-ADJ  ROUNDED =                           17180000
WR5701         PT-PADJ-RTL-AMT        / 1000.                           17190007
                                                                        17200000
           COMPUTE TL-TRANSFERS-IN  ROUNDED =                           17220000
               PT-XFER-IN-RTL-AMT     / 1000.                           17230007
                                                                        17240000
           COMPUTE TL-TRANSFERS-OUT ROUNDED =                           17260000
               PT-XFER-OUT-RTL-AMT    / 1000.                           17270007
                                                                        17280000
           COMPUTE TL-SALES         ROUNDED =                           17300000
               PT-SLS-RTL-AMT         / 1000.                           17310007
                                                                        17320000
           COMPUTE TL-SHRINK        ROUNDED =                           17340000
               PT-SHNK-RTL-AMT        / 1000.                           17350007
                                                                        17360000
           COMPUTE TL-MARKDOWNS     ROUNDED =                           17380000
                   PT-MKDN-RTL-AMT    / 1000.                           17390007
                                                                        17400000
           COMPUTE TL-MTH-END-INV   ROUNDED =                           17420000
                   PT-END-INV-RTL-AMT / 1000.                           17430007
                                                                        17440000
           COMPUTE TL-RED-TOTAL     ROUNDED =                           17470000
                   (PT-SLS-RTL-AMT                                      17480007
                  + PT-SHNK-RTL-AMT                                     17480007
                  + PT-MKDN-RTL-AMT)  / 1000.                           17490007
                                                                        17500000
           INITIALIZE TL-SALES-PCT                                      17510000
                      TL-END-INV-PCT.                                   17520000
                                                                        17530000
           COMPUTE TL-SHRINK-PCT ROUNDED =                              17540000
               (PT-SHNK-RTL-AMT * 100) / PT-SLS-RTL-AMT                 17550007
               ON SIZE ERROR                                            17560000
                   INITIALIZE TL-SHRINK-PCT.                            17570000
                                                                        17580000
           COMPUTE TL-MARKDOWN-PCT ROUNDED =                            17590000
               (PT-MKDN-RTL-AMT * 100) / PT-SLS-RTL-AMT                 17600007
               ON SIZE ERROR                                            17610000
                   INITIALIZE TL-MARKDOWN-PCT.                          17620000
                                                                        17630000
           PERFORM 3500-WRITE-TOTAL-LINE.                               17640000
                                                                        17650000
           PERFORM 3600-WRITE-SPECIAL-LINE.                             17720007
                                                                        17730007
                                                                        17740007
       3400-PRINT-A-LINE.                                               22370000
                                                                        22440000
           IF PV-LINE-COUNTER > PC-LINES-PER-PAGE                       22450000
               PERFORM 3100-PRINT-HEADINGS                              22460000
           END-IF.                                                      22470000
                                                                        22480000
           WRITE STR-INV-REPORT-RECORD                                  22490000
               FROM DL-DETAIL-LINE                                      22500000
               AFTER ADVANCING 1 LINE.                                  22510000
                                                                        22520000
           ADD 1 TO PV-LINE-COUNTER.                                    22530000
                                                                        22540000
                                                                        22540000
       3500-WRITE-TOTAL-LINE.                                           22250000
                                                                        22320000
           WRITE STR-INV-REPORT-RECORD                                  22330000
               FROM TL-TOTAL-LINE                                       22340000
               AFTER ADVANCING 2 LINES.                                 22350000
                                                                        22360000
                                                                        22360000
       3600-WRITE-SPECIAL-LINE.                                         22550000
                                                                        22620000
           WRITE STR-INV-REPORT-RECORD                                  22630000
               FROM SPL-SPECIAL-LINE (PS-BREAK-SW)                      17690007
               AFTER ADVANCING 2 LINES.                                 22640000
                                                                        22650000
           INITIALIZE STR-INV-REPORT-RECORD                             22660000
                                                                        22670000
           WRITE STR-INV-REPORT-RECORD                                  22680000
               AFTER ADVANCING 1 LINE.                                  22690000
                                                                        22700000
                                                                        22700000
       3650-WRITE-END-OF-REPORT-LINE.                                   22250000
                                                                        22320000
           WRITE STR-INV-REPORT-RECORD                                  22330000
               FROM ER-END-OF-REPORT-LINE                               MLKRP054
               AFTER ADVANCING 3 LINES.                                 22350000
                                                                        22360000
                                                                        22360000
       7000-READ-EXTRACT.                                               23040100
                                                                        23040200
           READ STR-INV-EXTRACT-FILE                                    23040300
               INTO ML109-STR-INV-EXTRACT-REC                           23040300
               AT END SET PS-END-OF-EXTRACT TO TRUE.                    23040400
                                                                        23040600
                                                                        23040700
135000 7100-READ-STR-INV-DTE-FILE.                                              
135100                                                                          
135200     READ STR-INV-DTE-FILE                                                
135300         INTO ML115-STR-INV-DTE-REC                                       
135400         AT END SET PS-END-OF-STR-INV-DTE-FILE TO TRUE.                   
135500                                                                          
135600                                                                          
       8050-GET-DATE-ATTRIBUTES.                                                
                                                                                
           EXEC SQL                                                             
                SELECT                                                          
                    FSCL_YR_NBR                                                 
                   ,FSCL_MN_NM                                                  
                INTO                                                            
                    :DTATTR-FSCL-YR-NBR                                         
                   ,:DTATTR-FSCL-MN-NM                                          
                FROM                                                            
                    TDTATTR                                                     
                WHERE                                                           
                    KY_DTE = :DTATTR-KY-DTE                                     
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   CONTINUE                                                     
               WHEN OTHER                                                       
                   DISPLAY 'DTATTR-KY-DTE: ' DTATTR-KY-DTE                      
                   MOVE    '8050-GET-DATE-ATTRIBUTES'                           
                                                TO PV-PARAGRAPH-NAME            
                   MOVE    'SELECT ROW FROM TDTATTR'                            
                                                TO PV-DB2-OPER-ATTEMPTED        
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8100-OPEN-STR-CSR.                                               23042105
                                                                        23042202
           EXEC SQL                                                     23042302
                OPEN STR-CSR                                            23042405
           END-EXEC.                                                    23042502
                                                                        23042602
           EVALUATE TRUE                                                23042702
               WHEN SQLCODE = ZERO                                      23042802
                   CONTINUE                                             23042902
               WHEN OTHER                                               23043002
                   MOVE '8100-OPEN-STR-CSR'     TO PV-PARAGRAPH-NAME    23043105
                   MOVE 'OPEN STR-CSR'          TO PV-DB2-OPER-ATTEMPTED23043305
                   PERFORM 9998-SQL-ABEND                               23043502
           END-EVALUATE.                                                23043602
                                                                        23043702
                                                                        23043802
       9300-FETCH-STR-CSR.                                              23043905
                                                                        23044002
           EXEC SQL                                                     23044102
               FETCH                                                    23044202
                   STR-CSR                                              23044305
               INTO                                                     23044402
W26603             :XMT00001-LOC-NBR                                    23044502
W26603            ,:XMT00001-LOC-TYP-CDE                                23044606
W26603            ,:XMT00001-LOC-10-ABBR-NM                             23044706
           END-EXEC.                                                    23044806
                                                                        23044906
           EVALUATE TRUE                                                23045006
               WHEN SQLCODE = ZERO                                      23045106
                   CONTINUE                                             23045206
               WHEN SQLCODE = +100                                      23045306
                   SET PS-END-OF-STR-CSR TO TRUE                        23045406
               WHEN OTHER                                               23045506
                   MOVE '9300-FETCH-STR-CSR'    TO PV-PARAGRAPH-NAME    23045606
                   MOVE 'FETCH STR-CSR'         TO PV-DB2-OPER-ATTEMPTED23045806
                   PERFORM 9998-SQL-ABEND                               23045906
           END-EVALUATE.                                                23046006
                                                                        23046106
                                                                        23046206
       8300-CLOSE-STR-CSR.                                              23046306
                                                                        23046406
           EXEC SQL                                                     23046506
               CLOSE STR-CSR                                            23046606
           END-EXEC.                                                    23046706
                                                                        23046806
           EVALUATE TRUE                                                23046906
               WHEN SQLCODE = ZERO                                      23047006
                   CONTINUE                                             23047106
               WHEN OTHER                                               23047206
                   MOVE '8300-CLOSE-STR-CSR'    TO PV-PARAGRAPH-NAME    23047306
                   MOVE 'CLOSE STR-CSR'         TO PV-DB2-OPER-ATTEMPTED23047506
                   PERFORM 9998-SQL-ABEND                               23047606
           END-EVALUATE.                                                23047706
                                                                        23047806
                                                                        23047906
       8400-GET-BUYER-NAME.                                             20170000
                                                                        20180000
           EXEC SQL                                                     20290000
                SELECT  B.WORKER_LAST_NAME                              20330000
                      , B.WORKER_FIR_NAME                               20340000
                  INTO :RSPBAR-WORKER-LAST-NAME                         20360000
                      ,:RSPBAR-WORKER-FIR-NAME                          20370000
                  FROM  TMDSEAR A                                       20380000
                      , TRSPBAR B                                       20390000
                 WHERE  A.OPERCO_NBR  = :PC-OPERCO-NBR                  20440000
                   AND  A.DEPT_NBR    = :SP-DEPT-NBR                    20420000
                   AND  A.BYR_NBR     = :SP-BYR-NBR                     20410000
222725             AND  A.MDSELV_CDE  = 'DPT'                                   
                   AND  B.RSPLVL_CDE  = :PC-RSPLVL-CDE-BYR              20430000
                   AND  A.MDSEAR_DKEY =  B.MDSEAR_DKEY                  20460000
                   AND  :ML115-EXTRACT-DTE                              07403005
                            BETWEEN B.WORKER_STRT_DTE                   20490000
                                AND B.WORKER_END_DTE                    20500000
           END-EXEC.                                                    20540000
                                                                        20550000
           EVALUATE TRUE                                                20560000
               WHEN SQLCODE = ZERO                                      20570000
                   CONTINUE                                             20600000
               WHEN SQLCODE = +100                                      20610000
                   MOVE 'NOT FOUND' TO  RSPBAR-WORKER-FIR-NAME          20650000
                   MOVE SPACE       TO  RSPBAR-WORKER-LAST-NAME         20660000
               WHEN OTHER                                               20670000
                   MOVE '8400-GET-BUYER-NAME'   TO PV-PARAGRAPH-NAME    20680000
                   MOVE 'SELECT ROW FROM TRSPBAR'                       20700000
                                                TO PV-DB2-OPER-ATTEMPTED20710000
                   PERFORM 9998-SQL-ABEND                               20720000
           END-EVALUATE.                                                20730000
                                                                        20760000
                                                                        20860000
       8500-GET-DMM-NAME.                                               20870000
                                                                        20930000
           EXEC SQL                                                     21030000
                SELECT  B.WORKER_LAST_NAME                              21060000
                     ,  B.WORKER_FIR_NAME                               21070000
                  INTO :RSPBAR-WORKER-LAST-NAME                         21090000
                      ,:RSPBAR-WORKER-FIR-NAME                          21100000
                  FROM  TMDSEAR A                                       21110000
                      , TRSPBAR B                                       21120000
                 WHERE  A.DMA_NBR     = :SP-DMA-NBR                     21140000
                   AND  B.RSPLVL_CDE  = :PC-RSPLVL-CDE-DMM              21150000
                   AND  A.OPERCO_NBR  = :PC-OPERCO-NBR                  21160000
                   AND  A.MDSEAR_DKEY =  B.MDSEAR_DKEY                  21180000
                   AND  :ML115-EXTRACT-DTE                              07403005
                            BETWEEN B.WORKER_STRT_DTE                   21210000
                                AND B.WORKER_END_DTE                    21220000
           END-EXEC.                                                    21260000
                                                                        21270000
           EVALUATE TRUE                                                21280000
               WHEN SQLCODE = ZERO                                      21290000
                   CONTINUE                                             21320000
               WHEN SQLCODE = +100                                      21330000
                   MOVE 'NOT FOUND' TO  RSPBAR-WORKER-FIR-NAME          21370000
                   MOVE SPACE       TO  RSPBAR-WORKER-LAST-NAME         21380000
               WHEN OTHER                                               21390000
                   MOVE '8500-GET-DMM-NAME'     TO PV-PARAGRAPH-NAME    21400000
                   MOVE 'SELECT ROW FROM TRSPBAR'                       21420000
                                                TO PV-DB2-OPER-ATTEMPTED21430000
                   PERFORM 9998-SQL-ABEND                               21440000
           END-EVALUATE.                                                21450000
                                                                        21480000
                                                                        21560000
       8600-GET-DEPT-DESC.                                              21580000
                                                                        21670000
           EXEC SQL                                                     21750000
               SELECT   DISTINCT MDSEAR_DESC                            21760000
                 INTO   :MDSEAR-DESC                                    21780000
                 FROM   TMDSEAR                                         21800000
                WHERE   OPERCO_NBR  = :PC-OPERCO-NBR                    21840000
                  AND   DEPT_NBR    = :SP-DEPT-NBR                      21930000
                  AND   MDSELV_CDE  = :PC-MDSELV-CDE-DPT                21830000
                  AND  :ML115-EXTRACT-DTE                               07403005
                            BETWEEN STRT_DTE AND END_DTE                21910000
           END-EXEC.                                                    21930000
                                                                        21940000
           EVALUATE TRUE                                                21950000
               WHEN SQLCODE = ZERO                                      21960000
                   CONTINUE                                             21990000
               WHEN SQLCODE = +100                                      22000000
                   MOVE 'NOT FOUND' TO MDSEAR-DESC                      22040000
               WHEN OTHER                                               22050000
                   MOVE '8600-GET-DEPT-DESC'    TO PV-PARAGRAPH-NAME    22060000
                   MOVE 'SELECT DEPARTMENT ROW ON TMDSEAR'              22080000
                                                TO PV-DB2-OPER-ATTEMPTED22090000
                   DISPLAY 'DEPT NUMBER = ' SP-DEPT-NBR                 22100000
                   PERFORM 9998-SQL-ABEND                               22110000
           END-EVALUATE.                                                22120000
                                                                        22150000
                                                                        22240000
      * DPPD024 COMBINES SEPARATE FIRST AND LAST NAME FIELDS INTO ONE  *23048006
      * FIRST/LAST NAME FIELD.                                         *23048106
                                                                        23049306
           COPY DPPD024.                                                23048306
                                                                        23048406
       9998-SQL-ABEND.                                                  23060007
                                                                        23070007
           MOVE +4013 TO PV-ABEND-CODE.                                 23080007
           DISPLAY '** ABEND      = SQLERROR'.                          23090007
           DISPLAY '** PROGRAM    = MLKRP205'.                          23100007
           DISPLAY '** PARAGRAPH  = ' PV-PARAGRAPH-NAME.                23110007
           DISPLAY '** OPERATION  = ' PV-DB2-OPER-ATTEMPTED.            23120007
                                                                        23130007
      *    THE FOLLOWING COPYBOOK UTILIZES THE DB2 ABEND MODULE         23140007
      *    DSNTIAR TO CONVERT SQLCA INTO UNDERSTANDABLE VERBAGE.        23150007
           COPY DPPD004.                                                23160007
                                                                        23170007
           PERFORM 9999-ABEND.                                                  
                                                                                
                                                                                
       9999-ABEND.                                                              
                                                                                
           CALL 'ILBOABN0'  USING PV-ABEND-CODE.                        23180007
