000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    SUKCS587.                                         00040000
000500 AUTHOR.        LARRY SCHLEICHER.                                 00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  DEC, 2001.                                        00070000
000800 DATE-COMPILED.                                                   00080000
000900*----------------------------------------------------------------*00090000
001000*    S587 - SYSTEM GENERATED AUDITS CRITERIA SPECIFICATION       *00100000
001100*                                                                *00110000
001200*    THIS PROGRAM ALLOWS THE USER TO ENTER DATA TO BE USED BY    *00120000
001300*    SUBSEQUENT PROGRAMS TO CREATE A LIST OR TO BRING UP A       *00130000
001400*    DETAIL SCREEN.  THE PACKAGE INFO, THE PO INFO, THE VENDOR   *00140000
001500*    INFO OR THE AUDIT NUMBER ARE ENTERED.  THE ENTERED FIELDS   *00150000
001600*    ARE VALIDATED.  RACF IS CHECKED TO DETERMINE IF THE         *00160000
001700*    OPERATOR IS AUTHORIZED TO GO TO THE MAINTENANCE SCREENS.    *00170000
001800*----------------------------------------------------------------*00180000
001500*    CHANGES                                                     *00181000
      *    MADE BY: SHOBHIT BAIJAL       PR#5148D                      *00182000
      *    DATE:    10/15/2013                                         *00183000
      *                                                                *00184000
      *    NEW PACKAGING TYPE 'RF' WAS ADDED TO BE ABLE TO FIND RFID   *00185000
      *    ONLY AUDITS. CHANGES CAN BE FOUND WITH *SB 10/15/13         *00186000
      *                                                                *00187000
001600*----------------------------------------------------------------*00188000
263968* CHANGED 11/15/2021    BY JIM HUNTER      WR: CHG0263968         00189108
263968* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00189208
263968* MAKING THE CALL DYNAMIC VS STATIC.                              00189308
001130*                                                                 00189409
001110* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00189509
001120* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00189609
263968*---------------------------------------------------------------* 00189708
001900                                                                  00190000
002000                                                                  00200000
002100                                                                  00210000
002200 ENVIRONMENT DIVISION.                                            00220000
002300                                                                  00230000
002400 DATA DIVISION.                                                   00240000
002500                                                                  00250000
002600 WORKING-STORAGE SECTION.                                         00260000
002700*                                                                 00270000
002800 01  PC-PROGRAM-CONSTANTS.                                        00280000
002900     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +14     00290000
003000                                                    COMP SYNC.    00300000
003100     05  PC-LIST-QUEUE-SEQ         PIC  9(01)  VALUE 1.           00310000
003200     05  PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE 2.           00320000
003300     05  PC-LIST-FORMAT            PIC  X(01)  VALUE '2'.         00330000
003400     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE  'SU587A  '. 00340000
003500     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE  'SUKM587 '. 00350000
003600     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE  'SUKCS587'. 00360000
003700     05  PC-CALENDAR-MODULE        PIC  X(08)  VALUE  'DPKUT500'. 00370000
003800     05  PC-MAX-DATE               PIC  X(10)  VALUE '9999-09-09'.00380000
003900     05  PC-ALL-DISTRIB-CNTRS      PIC  X(30)  VALUE              00390000
004000                   'ALL DISTRIBUTION CENTERS'.                    00400000
004100     05  PC-INQ                         PIC  X(03)  VALUE 'INQ'.  00410000
004200     05  PC-UPD                         PIC  X(03)  VALUE 'UPD'.  00420000
004300     05  PC-DEL                         PIC  X(03)  VALUE 'DEL'.  00430000
004400     05  PC-ERR                         PIC  X(03)  VALUE 'ERR'.  00440000
004500     05  PC-DFLT-PKG-TYPE               PIC  X(02)  VALUE 'AL'.   00450000
004600     05  PC-DFLT-PROC-STAT              PIC  X(01)  VALUE 'A'.    00460000
004700****************************************************************  00470000
004800* MESSAGES                                                     *  00480000
004900****************************************************************  00490000
005000* 00005 - INVALID VALUE                                        *  00500000
005100* 00007 - REQUIRED ENTRY                                          00510000
005200* 00008 - MUST BE NUMERIC                                         00520000
005300* 00009 - INVALID DATE                                            00530000
005400* 00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION          00540000
005500* 00069 - TOP OF LIST                                             00550000
005600* 00070 - BOTTOM OF LIST                                          00560000
005700* 00588 - INVALID DEPARTMENT NUMBER                               00570000
005800* 02221 - PULL CREATE -FROM DATE- MUST BE PRIOR TO THE -TO DATE-  00580000
005900* 01202 - THE HIGHLIGHTED FIELDS ARE MUTUALLY EXCLUSIVE (ENTER ON 00590000
006000* 02572 - INVALID VALUE - OPER UNIT ID MUST BE A DC LOCATION      00600000
006100* 02850 - INVALID VENDOR ID                                       00610000
006200* 02858 - INVALID PURCHASE ORDER NUMBER                           00620000
006300* 02912 - ONE OF THE FOUR AUDIT LIST CRITERIA MUST BE SPECIFIED*  00630000
006400****************************************************************  00640000
006500*                                                                 00650000
006600     05  PC-TSYMSG-NUMBERS.                                       00660000
006700         10  PC-TSYMSG-00005       PIC  9(05)  VALUE  00005.      00670000
006800         10  PC-TSYMSG-00007       PIC  9(05)  VALUE  00007.      00680000
006900         10  PC-TSYMSG-00008       PIC  9(05)  VALUE  00008.      00690000
007000         10  PC-TSYMSG-00009       PIC  9(05)  VALUE  00009.      00700000
007100         10  PC-TSYMSG-00057       PIC  9(05)  VALUE  00057.      00710000
007200         10  PC-TSYMSG-00069       PIC  9(05)  VALUE  00069.      00720000
007300         10  PC-TSYMSG-00070       PIC  9(05)  VALUE  00070.      00730000
007400         10  PC-TSYMSG-00588       PIC  9(05)  VALUE  00588.      00740000
007500         10  PC-TSYMSG-02221       PIC  9(05)  VALUE  02221.      00750000
007600         10  PC-TSYMSG-01202       PIC  9(05)  VALUE  01202.      00760000
007700         10  PC-TSYMSG-02572       PIC  9(05)  VALUE  02572.      00770000
007800         10  PC-TSYMSG-02850       PIC  9(05)  VALUE  02850.      00780000
007900         10  PC-TSYMSG-02858       PIC  9(05)  VALUE  02858.      00790000
008000         10  PC-TSYMSG-02912       PIC  9(05)  VALUE  02912.      00800000
008100         10  PC-TSYMSG-02918       PIC  9(05)  VALUE  02918.      00810000
008200*                                                                 00820000
008300/                                                                 00830000
008400 01  DK-DB2-KEYS.                                                 00840000
008500     05  DK-ENT-ID                    PIC S9(09) COMP VALUE +0.   00850000
008600     05  DK-ENT-NAME-DESC             PIC  X(30) VALUE SPACES.    00860000
008700     05  DK-DEPT                      PIC  X(03) VALUE SPACES.    00870000
008800     05  DK-OPER-UNIT                 PIC S9(04) COMP VALUE +0.   00880000
008900     05  DK-PO-NBR                    PIC S9(09) COMP VALUE +0.   00890000
009000     05  DK-REC-SEQ-NBR               PIC S9(09) COMP VALUE +0.   00900000
009100                                                                  00910000
009200*----------------------------------------------------------------*00920000
009300*   PROGRAM VARIABLES                                            *00930000
009400*----------------------------------------------------------------*00940000
009500 01  PV-PROGRAM-VARIABLES.                                        00950000
009600                                                                  00960000
009700     05  PV-SUB                         PIC S9(04)  VALUE +0      00970000
009800                                                    COMP SYNC.    00980000
009900     05  PV-CHECK-SUB                   PIC S9(04)  VALUE +0      00990000
010000                                                    COMP SYNC.    01000000
010100     05  PV-FROM-DATE-HOLD.                                       01010000
010200         10  PV-FROM-YY            PIC  9(04)  VALUE ZEROES.      01020000
010300         10  PV-FROM-MM            PIC  9(02)  VALUE ZEROES.      01030000
010400         10  PV-FROM-DD            PIC  9(02)  VALUE ZEROES.      01040000
010500                                                                  01050000
010600     05  PV-TO-DATE-HOLD.                                         01060000
010700         10  PV-TO-YY              PIC  9(04)  VALUE ZEROES.      01070000
010800         10  PV-TO-MM              PIC  9(02)  VALUE ZEROES.      01080000
010900         10  PV-TO-DD              PIC  9(02)  VALUE ZEROES.      01090000
011000                                                                  01100000
011100     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01110000
011200                                                    COMP SYNC.    01120000
011300     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      01130000
011400                                                    COMP-3.       01140000
011500     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      01150000
011600                                                    COMP-3.       01160000
011700     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01170000
011800                                                    COMP-3.       01180000
011900     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01190000
012000                                                    COMP-3.       01200000
012100     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      01210000
012200                                                    COMP-3.       01220000
012300     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01230000
012400                                                    COMP SYNC.    01240000
012500     05  PV-ITEM                        PIC S9(04)  VALUE +0      01250000
012600                                                    COMP SYNC.    01260000
012700     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01270000
012800                                                    COMP SYNC.    01280000
012900     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01290000
013000                                                    COMP SYNC.    01300000
013100     05  PV-VENDOR-DESC                 PIC  X(30).               01310000
013200     05  PV-ENT-ID.                                               01320000
013300         20  PV-ENT-ID-N                PIC  9(09).               01330000
013400     05  PV-ENTRY-FLAGS.                                          01340000
013500         10  PV-GROUP1-FLAG             PIC X(01).                01350000
013600         10  PV-GROUP2-FLAG             PIC X(01).                01360000
013700         10  PV-GROUP3-FLAG             PIC X(01).                01370000
013800         10  PV-GROUP4-FLAG             PIC X(01).                01380000
013900     05  PV-ENTRY-CHECKER REDEFINES PV-ENTRY-FLAGS.               01390000
014000         10  PV-CHECKER                 PIC X(04).                01400000
014100             88  PV-VALID-COMBOS  VALUES                          01410000
014200                                  'NNNN',                         01420000
014300                                  'YNNN',                         01430000
014400                                  'NYNN',                         01440000
014500                                  'NNYN',                         01450000
014600                                  'NNNY'.                         01460000
014700     05  PV-CHECKER-TBL REDEFINES PV-ENTRY-CHECKER.               01470000
014800         10  PV-CHECK-TBL-FLAG OCCURS 4 TIMES                     01480000
014900                                        PIC X(01).                01490000
015000******************************************************************01500000
015100**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **01510000
015200**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **01520000
015300**  APPLICATION-SPECIFIC COMMAREA.                              **01530000
015400******************************************************************01540000
015500 01  LQW-LIST-QUEUE-WORK-AREA.                                    01550000
015600     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  01560000
015700     05  LQW-ITEM-ENTRIES               OCCURS 14 TIMES           01570000
015800                                        INDEXED BY LQW-IDX.       01580000
015900         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       01590000
016000         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               01600000
016100         10  LQW-SELECTED-SW            PIC  X(01).               01610000
016200             88  LQW-SELECT                         VALUE 'S'.    01620000
016300             88  LQW-DESELECT                       VALUE ' '.    01630000
016400         10  LQW-ACTION                 PIC  X(03).               01640000
016500         10  LQW-LINE-ENT-ID            PIC S9(09)  COMP.         01650000
016600         10  LQW-VENDOR-NAME            PIC  X(30).               01660000
016700*----------------------------------------------------------------*01670000
016800*   SWITCHES                                                     *01680000
016900*----------------------------------------------------------------*01690000
017000 01  PS-PROGRAM-SWITCHES.                                         01700000
017100     05  PS-ERROR-SW               PIC  X(01)  VALUE  'N'.        01710000
017200         88  PS-ERROR                          VALUE  'Y'.        01720000
017300         88  PS-NO-ERROR                       VALUE  'N'.        01730000
017400     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01740000
017500         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01750000
017600         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01760000
017700     05  PS-LIST-END-SW                 PIC  X(01)  VALUE 'N'.    01770000
017800         88  PS-LIST-END                            VALUE 'Y'.    01780000
017900         88  PS-NO-LIST-END                         VALUE 'N'.    01790000
018000     05  PS-DATE-ERROR-SW          PIC  X(01)  VALUE  'N'.        01800000
018100         88  PS-DATE-ERROR                     VALUE  'Y'.        01810000
018200         88  PS-NO-DATE-ERROR                  VALUE  'N'.        01820000
018300     05  PS-NUM-ERROR-SW           PIC  X(01)  VALUE  'N'.        01830000
018400         88  PS-NUM-ERROR                      VALUE  'Y'.        01840000
018500         88  PS-NO-NUM-ERROR                   VALUE  'N'.        01850000
018600     05  PS-ENT-ID-FOUND-SW        PIC  X(01)  VALUE  'N'.        01860000
018700         88  PS-ENT-ID-FOUND                   VALUE  'Y'.        01870000
018800         88  PS-NO-ENT-ID-FOUND                VALUE  'N'.        01880000
018900     05  PS-PO-FOUND-SW            PIC  X(01)  VALUE  'N'.        01890000
019000         88  PS-PO-FOUND                       VALUE  'Y'.        01900000
019100         88  PS-NO-PO-FOUND                    VALUE  'N'.        01910000
019200     05  PS-DEPT-FOUND-SW          PIC  X(01)  VALUE  'N'.        01920000
019300         88  PS-DEPT-FOUND                     VALUE  'Y'.        01930000
019400         88  PS-NO-DEPT-FOUND                  VALUE  'N'.        01940000
019500     05  PS-ACCESS-SW              PIC  X(01)  VALUE  'N'.        01950000
019600         88  PS-ACCESS-ALLOWED                 VALUE  'Y'.        01960000
019700         88  PS-ACCESS-NOT-ALLOWED             VALUE  'N'.        01970000
019800     05  PS-OPER-UNIT-FOUND-SW     PIC  X(01)  VALUE  'N'.        01980000
019900         88  PS-OPER-UNIT-FOUND                VALUE  'Y'.        01990000
020000         88  PS-OPER-UNIT-NOT-FOUND            VALUE  'N'.        02000000
020100                                                                  02010000
020200 01  PM-PROGRAM-MESSAGES.                                         02020000
020300     05  PM-ABEND-INFO-A.                                         02030000
020400         10  FILLER                PIC X(15)   VALUE              02040000
020500                                   'DP020-SRC-AID: '.             02050000
020600         10  PM-A-SRC-AID          PIC X(02)   VALUE  SPACE.      02060000
020700         10  FILLER                PIC X(19)   VALUE              02070000
020800                                   '. DP020-FK-ACTION: '.         02080000
020900         10  PM-A-FK-ACTION        PIC X(01)   VALUE  SPACE.      02090000
021000         10  FILLER                PIC X(22)   VALUE              02100000
021100                                   '. DP020-FK-DISPN-IND: '.      02110000
021200         10  PM-A-FK-DISPN         PIC X(01)   VALUE  SPACE.      02120000
021300         10  FILLER                PIC X(01)   VALUE '.'.         02130000
021400         10  FILLER                PIC X(19)   VALUE SPACE.       02140000
021500                                                                  02150000
021600                                                                  02160000
021700*---------------------------------------------------------------* 02170000
021800* SELECTON QUEUE LAYOUT                                         * 02180000
021900*---------------------------------------------------------------* 02190000
022000     COPY SUWS019.                                                02200000
022100                                                                  02210000
022200*----------------------------------------------------------------*02220000
022300*    MAP LAYOUT                                                  *02230000
022400*----------------------------------------------------------------*02240000
022500                                                                  02250000
022600     COPY SUKM587.                                                02260000
022700     EJECT                                                        02270000
022800*----------------------------------------------------------------*02280000
022900*    CALENDAR ROUTINE                                            *02290000
023000*----------------------------------------------------------------*02300000
023100     COPY DPWS500.                                                02310000
023200                                                                  02320000
023300*----------------------------------------------------------------*02330000
023400*    ATTRIBUTE SETTINGS COPYBOOK.                                *02340000
023500*----------------------------------------------------------------*02350000
023600                                                                  02360000
023700     COPY DPWS015.                                                02370000
023800                                                                  02380000
023900*----------------------------------------------------------------*02390000
024000*    FUNCTION KEYS COPYBOOK                                      *02400000
024100*----------------------------------------------------------------*02410000
024200                                                                  02420000
024300     COPY DPWS016.                                                02430000
024400                                                                  02440000
024500*----------------------------------------------------------------*02450000
024600**  SECURITY SUBROUTINE PARAMETERS                                02460000
024700*----------------------------------------------------------------*02470000
024800     COPY DPWS008.                                                02480000
024900                                                                  02490000
025000*    AUDIT MASTER                                                 02500000
025100     EXEC SQL                                                     02510000
025200          INCLUDE TSUNAUD                                         02520000
025300     END-EXEC.                                                    02530000
025400*----------------------------------------------------------------*02540000
025500*    DB2 DCLGEN FOR THE EXTERNAL ENTERPRISE TABLE                 02550000
025600*----------------------------------------------------------------*02560000
025700     EXEC SQL                                                     02570000
025800          INCLUDE TEXTENT                                         02580000
025900     END-EXEC.                                                    02590000
026000*----------------------------------------------------------------*02600000
026100*    DB2 DCLGEN FOR THE ENTERPRISE NAME TABLE                     02610000
026200*----------------------------------------------------------------*02620000
026300     EXEC SQL                                                     02630000
026400          INCLUDE TENTNME                                         02640000
026500     END-EXEC.                                                    02650000
026600                                                                  02660000
026700*---------------------------------------------------------------* 02670000
026800*  DCLGEN FOR THE DB2 DEPARTMENT TABLE                            02680000
026900*---------------------------------------------------------------* 02690000
027000     EXEC SQL                                                     02700000
027100         INCLUDE TVNDDPT                                          02710000
027200     END-EXEC.                                                    02720000
027300*----------------------------------------------------------------*02730000
027400*    DB2 DCLGEN FOR THE MERCHANDISE AREA TABLE                    02740000
027500*----------------------------------------------------------------*02750000
027600     EXEC SQL                                                     02760000
027700          INCLUDE TMDSEAR                                         02770000
027800     END-EXEC.                                                    02780000
027900                                                                  02790000
028700*---------------------------------------------------------------* 02870000
028800*    DB2 AREA FOR THE PURCHASE ORDER TABLE                      * 02880000
028900*---------------------------------------------------------------* 02890000
029000     EXEC SQL                                                     02900000
029100          INCLUDE TPURCHS                                         02910000
029200     END-EXEC.                                                    02920000
029300                                                                  02930000
028700*---------------------------------------------------------------* 02931000
028800*    DB2 AREA FOR THE LOCATION TABLE                            * 02932000
028900*---------------------------------------------------------------* 02933000
029000     EXEC SQL                                                     02934000
029100          INCLUDE XLT00010                                        02935000
029200     END-EXEC.                                                    02936000
029300                                                                  02937000
029400*----------------------------------------------------------------*02940000
029500*    DB2 SQL COMMUNICATION AREA                                   02950000
029600*----------------------------------------------------------------*02960000
029700     EXEC SQL                                                     02970000
029800          INCLUDE SQLCA                                           02980000
029900     END-EXEC.                                                    02990000
030000                                                                  03000000
030100******************************************************************03010000
030200** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **03020000
030300** SUB-ROUTINE (DPKUT100).                                      **03030000
030400******************************************************************03040000
030500     COPY DPWS010I.                                               03050000
030600 EJECT                                                            03060000
030700******************************************************************03070000
030900** PARAMETERS FOR CALLING CICS ARCHITECTURE API                 **03090009
031000******************************************************************03100000
031100     COPY DPWS030.                                                03110000
031100     COPY DPWS930.                                                03111009
031200 EJECT                                                            03120000
031300***************************************************************** 03130000
031400*    STANDARD COMMAREA.                                           03140000
031500***************************************************************** 03150000
031600                                                                  03160000
031700     COPY DPWS020.                                                03170000
031800     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                03180000
031900                                                                  03190000
032000*---------------------------------------------------------------* 03200000
032100* INTER-APPLICATION COMMAREA.                                   * 03210000
032200*   SUWS017 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 03220000
032300*             THIS LIST PROGRAMMING FOR LOCAL-FUNC-01(SUKCS579).* 03230000
032400*   SUWS018 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 03240000
032500*             THIS LIST PROGRAMMING FOR                        .* 03250000
032600*   SUWS023 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 03260000
032700*             THIS LIST PROGRAMMING FOR LOCAL-FUNC-03(SUKCS589).* 03270000
032800*---------------------------------------------------------------* 03280000
032900                                                                  03290000
033000         10  INTER-APPL-COMM-AREA PIC X(200).                     03300000
033100     COPY SUWS017.                                                03310000
033200     COPY SUWS018.                                                03320000
033300     COPY SUWS023.                                                03330000
033400                                                                  03340000
033500***************************************************************** 03350000
033600*    SPECIFIC COMMMAREA FOR SUKCS587.                             03360000
033700***************************************************************** 03370000
033800         10  ASC-SPECIFIC-COMMAREA.                               03380000
033900             15  ASC-PACKAGING-TYPE              PIC  X(02).      03390000
034000             15  ASC-PROCESS-STATUS              PIC  X(01).      03400000
034100             15  ASC-PACKAGE-OPER-UNIT-ID.                        03410000
034200                 20  ASC-PACKAGE-OPER-UNIT-ID-N  PIC  9(04).      03420000
034300             15  ASC-PKG-FROM-REQ-DTE-MM.                         03430000
034400                 20  ASC-PKG-FROM-REQ-DTE-MM-N   PIC  9(02).      03440000
034500             15  ASC-PKG-FROM-REQ-DTE-DD.                         03450000
034600                 20  ASC-PKG-FROM-REQ-DTE-DD-N   PIC  9(02).      03460000
034700             15  ASC-PKG-FROM-REQ-DTE-YY.                         03470000
034800                 20  ASC-PKG-FROM-REQ-DTE-YY-N   PIC  9(04).      03480000
034900             15  ASC-PKG-TO-REQ-DTE-MM.                           03490000
035000                 20  ASC-PKG-TO-REQ-DTE-MM-N     PIC  9(02).      03500000
035100             15  ASC-PKG-TO-REQ-DTE-DD.                           03510000
035200                 20  ASC-PKG-TO-REQ-DTE-DD-N     PIC  9(02).      03520000
035300             15  ASC-PKG-TO-REQ-DTE-YY.                           03530000
035400                 20  ASC-PKG-TO-REQ-DTE-YY-N     PIC  9(04).      03540000
035500             15  ASC-PO.                                          03550000
035600                 20  ASC-PO-N                    PIC  Z(09).      03560000
035700             15  ASC-RECVR-SEQ-NBR.                               03570000
035800                 20  ASC-RECVR-SEQ-NBR-N         PIC  Z(03).      03580000
035900             15  ASC-PO-OPER-UNIT-ID.                             03590000
036000                 20  ASC-PO-OPER-UNIT-ID-N       PIC  Z(04).      03600000
036100             15  ASC-VENDOR-DESC                 PIC  X(30).      03610000
036200             15  ASC-ENT-ID.                                      03620000
036300                 20  ASC-ENT-ID-N                PIC  Z(09).      03630000
036400             15  ASC-DEPT-NBR.                                    03640000
036500                 20  ASC-DEPT-NBR-N              PIC  9(04).      03650000
036600             15  ASC-DEPT-NBR-X-4 REDEFINES ASC-DEPT-NBR.         03660000
036700                 20  FILLER                  PIC  X(01).          03670000
036800                 20  ASC-DEPT-NBR-X-3        PIC  X(03).          03680000
036900             15  ASC-VENDOR-OPER-UNIT-ID.                         03690000
037000                 20  ASC-VENDOR-OPER-UNIT-ID-N   PIC  Z(04).      03700000
037100             15  ASC-VEN-FROM-REQ-DTE-MM.                         03710000
037200                 20  ASC-VEN-FROM-REQ-DTE-MM-N   PIC  9(02).      03720000
037300             15  ASC-VEN-FROM-REQ-DTE-DD.                         03730000
037400                 20  ASC-VEN-FROM-REQ-DTE-DD-N   PIC  9(02).      03740000
037500             15  ASC-VEN-FROM-REQ-DTE-YY.                         03750000
037600                 20  ASC-VEN-FROM-REQ-DTE-YY-N   PIC  9(04).      03760000
037700             15  ASC-VEN-TO-REQ-DTE-MM.                           03770000
037800                 20  ASC-VEN-TO-REQ-DTE-MM-N     PIC  9(02).      03780000
037900             15  ASC-VEN-TO-REQ-DTE-DD.                           03790000
038000                 20  ASC-VEN-TO-REQ-DTE-DD-N     PIC  9(02).      03800000
038100             15  ASC-VEN-TO-REQ-DTE-YY.                           03810000
038200                 20  ASC-VEN-TO-REQ-DTE-YY-N     PIC  9(04).      03820000
038300             15  ASC-AUDIT-NUMBER.                                03830000
038400                 20  ASC-AUDIT-NUMBER-N          PIC  Z(09).      03840000
038500             15  ASC-DEPT-DESC                   PIC  X(30).      03850000
038600             15  ASC-FUNCTION                    PIC  X.          03860000
038700                 88  ASC-VNDR-LST-FUNC           VALUE '1'.       03870000
038800*                                                                 03880000
038900*-----------------------------------------------------------------03890000
039000             15  ASC-LIST-QUEUE-NAME.                             03900000
039100                 20  ASC-LIST-TERM-ID         PIC  X(04).         03910000
039200                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  03920000
039300                 20  ASC-LIST-SEQ             PIC  9(01).         03930000
039400             15  ASC-START-ITEM-REQUEST.                          03940000
039500                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         03950000
039600                                                                  03960000
039700             15  ASC-SEL-SUB                  PIC S9(4) COMP.     03970000
039800             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     03980000
039900             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          03990000
040000                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 04000000
040100             15  ASC-SEL-QUEUE-NAME.                              04010000
040200                 20  ASC-SEL-TERM-ID          PIC  X(04).         04020000
040300                 20  ASC-SEL-TASK-NUMBER      PIC S9(05) COMP-3.  04030000
040400                 20  ASC-SEL-SEQ              PIC  9(01).         04040000
040500             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  04050000
040600             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   04060000
040700                                                          COMP-3. 04070000
040800             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   04080000
040900                                                          COMP-3. 04090000
041000             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC  X(01).  04100000
041100                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   04110000
041200                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   04120000
041300             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                04130000
041400                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  04140000
041500                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   04150000
041600                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   04160000
041700             15  FILLER                              PIC  X(2679).04170000
041800                                                                  04180000
041900     EJECT                                                        04190000
042000*----------------------------------------------------------------*04200000
042100*    ABEND PROCESSING COPYBOOK.                                  *04210000
042200*----------------------------------------------------------------*04220000
042300                                                                  04230000
042400     COPY DPWS013.                                                04240000
042500                                                                  04250000
042600                                                                  04260000
042700 EJECT                                                            04270000
042800 LINKAGE SECTION.                                                 04280000
042900                                                                  04290000
043000 01  DFHCOMMAREA.                                                 04300000
043100     05  FILLER                         OCCURS  1 TO 4072 TIMES   04310000
043200                                        DEPENDING ON EIBCALEN.    04320000
043300         10  FILLER                     PIC X.                    04330000
043400                                                                  04340000
043500                                                                  04350000
043600 PROCEDURE DIVISION.                                              04360000
043700***************************************************************** 04370000
043800** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 04380000
043900** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 04390000
044000** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 04400000
044100**                                                             ** 04410000
044200** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 04420000
044300** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 04430000
044400***************************************************************** 04440000
044500 0000-MAIN-MODULE.                                                04450000
044600     INITIALIZE DP030-CICS-API-FIELDS.                            04460000
044700     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       04470000
044800     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          04480000
044900     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         04490000
045000     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       04500000
045100     MOVE LENGTH OF SU587AI        TO DP030-MAP-LENGTH (1).       04510000
045200     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     04520000
045300     PERFORM 0001-CALL-CICS-ARCH-API.                             04530000
045400*                                                                 04540000
045500     PERFORM 1000-CONTROL-PROCESSING                              04550000
045600*                                                                 04560000
045700     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     04570000
045800     PERFORM 0001-CALL-CICS-ARCH-API.                             04580000
045900                                                                  04590000
046000 0001-CALL-CICS-ARCH-API.                                         04600000
046100*    CALL 'DPKCS030' USING DFHEIBLK                               04610009
046100     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      04611009
046200                           DFHCOMMAREA                            04620000
046300                           DP030-CICS-API-FIELDS                  04630000
046400                           DP020-STANDARD-COMMAREA                04640000
046500                           SU587AI.                               04650000
046600*                                                                 04660000
046700     IF  DP030-RC-CALL-SUCCESSFUL                                 04670000
046800         CONTINUE                                                 04680000
046900     ELSE                                                         04690000
047000         SET DP013-NO-ROLLBACK                                    04700000
047100             DP013-XCTL-DISPLAY-RESTART                           04710000
047200             DP013-CICS-ABEND      TO TRUE                        04720000
047300         MOVE 'BEFORE 0000-MAIN-MODULE'                           04730000
047400                                   TO DP013-PARAGRAPH             04740000
047500*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX04750009
047600*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      04760009
047500         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O04761009
047600-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      04762009
047700         MOVE DP030-RETURN-CODE                                   04770000
047800                                   TO DP013-MESSAGE-TEXT (3)      04780000
047900         PERFORM DP013-0000-PROCESS-ABEND                         04790000
048000     END-IF.                                                      04800000
048100 EJECT                                                            04810000
048200*----------------------------------------------------------------*04820000
048300*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *04830000
048400*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *04840000
048500*----------------------------------------------------------------*04850000
048600                                                                  04860000
048700 1000-CONTROL-PROCESSING.                                         04870000
048800                                                                  04880000
048900     EVALUATE TRUE                                                04890000
049000         WHEN DP020-NEXT-ACT-INITIAL                              04900000
049100             INITIALIZE ASC-SPECIFIC-COMMAREA                     04910000
049200             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            04920000
049300                                      ASC-SEL-TERM-ID             04930000
049400             MOVE DP020-SRC-TASK-NUMBER                           04940000
049500                                   TO ASC-LIST-TASK-NUMBER        04950000
049600                                      ASC-SEL-TASK-NUMBER         04960000
049700             MOVE PC-LIST-QUEUE-SEQ                               04970000
049800                                   TO ASC-LIST-SEQ                04980000
049900             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 04990000
050000             PERFORM 1100-PROCESS-INTER-APPL-COMM                 05000000
050100***-----$TEMPLATE NOTE$-------------------------------------------05010000
050200*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,05020000
050300*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  05030000
050400*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.05040000
050500***---------------------------------------------------------------05050000
050600             IF  PS-COMMAREA-NOT-VALID                            05060000
050700                 SET DP020-NEXT-ACT-APPL-ERROR                    05070000
050800                                   TO TRUE                        05080000
050900             ELSE                                                 05090000
051000                 PERFORM 4000-BUILD-INITIAL-PANEL                 05100000
051100                 PERFORM 3200-RESET-ATTRIBUTES                    05110000
051200             END-IF                                               05120000
051300                                                                  05130000
051400         WHEN DP020-NEXT-ACT-READ-MAP                             05140000
051500             PERFORM 2000-FKEY-PROCESSING                         05150000
051600                                                                  05160000
051700         WHEN DP020-NEXT-ACT-RETURN                               05170000
051800             IF  ASC-VNDR-LST-FUNC                                05180000
051900                 MOVE SU017-VENDOR-DESC  TO  PV-VENDOR-DESC       05190000
052000                 MOVE SU017-ENT-ID       TO  PV-ENT-ID-N          05200000
052100                 INITIALIZE ASC-SPECIFIC-COMMAREA                 05210000
052200                 PERFORM 4000-BUILD-INITIAL-PANEL                 05220000
052300                 PERFORM 3200-RESET-ATTRIBUTES                    05230000
052400                 MOVE PV-VENDOR-DESC     TO  ASC-VENDOR-DESC      05240000
052500                                             AVNDNAMO             05250000
052600                 MOVE PV-ENT-ID-N        TO  ASC-ENT-ID           05260000
052700                                             AVNDIDO              05270000
052800             ELSE                                                 05280000
052900                 INITIALIZE ASC-SPECIFIC-COMMAREA                 05290000
053000                 PERFORM 4000-BUILD-INITIAL-PANEL                 05300000
053100                 PERFORM 3200-RESET-ATTRIBUTES                    05310000
053200             END-IF                                               05320000
053300                                                                  05330000
053400         WHEN OTHER                                               05340000
053500             SET DP013-LOGIC-ABEND                                05350000
053600                 DP013-NO-ROLLBACK TO TRUE                        05360000
053700             MOVE '1000-CONTROL-PROCESSING'                       05370000
053800                                   TO  DP013-PARAGRAPH            05380000
053900             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   05390000
054000                                   TO  DP013-MESSAGE-TEXT(1)      05400000
054100             MOVE DP020-NEXT-APPL-ACTIVITY                        05410000
054200                                   TO DP013-MESSAGE-TEXT(2)       05420000
054300             PERFORM DP013-0000-PROCESS-ABEND                     05430000
054400     END-EVALUATE.                                                05440000
054500                                                                  05450000
054600 1100-PROCESS-INTER-APPL-COMM.                                    05460000
054700                                                                  05470000
054800     SET PS-COMMAREA-VALID         TO TRUE.                       05480000
054900     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     05490000
055000                                                                  05500000
055100     IF  DP020-INT-APPL-FORMAT-IND =  PC-LIST-FORMAT              05510000
055200       IF SU018-NUMBER-OF-SELECTED-ITEMS > 0                      05520000
055300                                                                  05530000
055400         SET ASC-USE-SELECTION-QUEUE   TO TRUE                    05540000
055500         MOVE SU018-NUMBER-OF-TS-ITEMS TO ASC-NUMBER-OF-TS-ITEMS  05550000
055600         MOVE SU018-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME      05560000
055700         PERFORM 1120-PREPARE-LIST-ENTRY                          05570000
055800       ELSE                                                       05580000
055900           MOVE PC-TSYMSG-00057       TO DP020-MSG-NUMBER         05590000
056000           SET  PS-COMMAREA-NOT-VALID TO TRUE                     05600000
056100       END-IF                                                     05610000
056200     END-IF.                                                      05620000
056300                                                                  05630000
056400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*05640000
056500 1120-PREPARE-LIST-ENTRY.                                         05650000
056600                                                                  05660000
056700     MOVE SU019-MAX-ITEMS          TO ASC-SEL-SUB.                05670000
056800     MOVE ZERO                     TO ASC-SEL-ITEM.               05680000
056900     PERFORM 1130-GET-NEXT-RECORD.                                05690000
057000                                                                  05700000
057100*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*05710000
057200*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*05720000
057300*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*05730000
057400 1130-GET-NEXT-RECORD.                                            05740000
057500                                                                  05750000
057600     ADD +1                       TO ASC-SEL-ITEM.                05760000
057700     MOVE +1                      TO ASC-SEL-SUB.                 05770000
057800                                                                  05780000
057900*    PERFORM 9100-READ-SEL-QUEUE.                                 05790000
058000                                                                  05800000
058100                                                                  05810000
058200*----------------------------------------------------------------*05820000
058300* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*05830000
058400* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*05840000
058500* EDITS.                                                         *05850000
058600*----------------------------------------------------------------*05860000
058700                                                                  05870000
058800 2000-FKEY-PROCESSING.                                            05880000
058900                                                                  05890000
059000     EVALUATE TRUE                                                05900000
059100                                                                  05910000
059200         WHEN DP020-SRC-AID = DP016-CLEAR                         05920000
059300             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   05930000
059400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 05940000
059500*F5 - REFRESH                                                     05950000
059600         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     05960000
059700             INITIALIZE ASC-SPECIFIC-COMMAREA                     05970000
059800             PERFORM 4000-BUILD-INITIAL-PANEL                     05980000
059900             PERFORM 3200-RESET-ATTRIBUTES                        05990000
060000                                                                  06000000
060100         WHEN OTHER                                               06010000
060200             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 06020000
060300             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   06030000
060400             IF  PS-NO-ERROR                                      06040000
060500                 SET DP030-CONTINUE-GO TO TRUE                    06050000
060600                 PERFORM 2100-CHECK-FUNCTION-KEY                  06060000
060700             ELSE                                                 06070000
060800                 SET DP030-OVERRIDE-GO TO TRUE                    06080000
060900             END-IF                                               06090000
061000     END-EVALUATE.                                                06100000
061100******************************************************************06110000
061200** ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     **06120000
061300** FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED **06130000
061400** FROM THE CICS ARCHITECTURE API.                              **06140000
061500******************************************************************06150000
061600 2100-CHECK-FUNCTION-KEY.                                         06160000
061700     EVALUATE TRUE                                                06170000
061800         WHEN DP020-SRC-AID = DP016-ENTER                         06180000
061900             CONTINUE                                             06190000
062000                                                                  06200000
062100* F17 - VENDOR LIST  (LOCAL-FUNC-01) (SUKCS579)                   06210000
062200*                                                                 06220000
062300         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              06230000
062400             IF ASC-VENDOR-DESC = SPACES OR                       06240000
062500                ASC-VENDOR-DESC = '*'                             06250000
062600                 SET PS-ERROR                                     06260000
062700                     DP020-MSG-FATAL   TO TRUE                    06270000
062800                 MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER        06280000
062900                 MOVE DP015-UNP-ALP-BRT-OFF                       06290000
063000                                       TO AVNDNAMA                06300000
063100                 MOVE DP015-RED        TO AVNDNAMC                06310000
063200                 MOVE DP015-REVERSE    TO AVNDNAMH                06320000
063300                 MOVE -1               TO AVNDNAML                06330000
063400                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              06340000
063500                 SET DP030-OVERRIDE-GO       TO TRUE              06350000
063600             ELSE                                                 06360000
063700                 SET  ASC-VNDR-LST-FUNC  TO  TRUE                 06370000
063800                 PERFORM 2110-PREPARE-INTER-APPL-COMM             06380000
063900                 PERFORM 5000-PREPARE-SEL-QUEUE                   06390000
064000             END-IF                                               06400000
064100                                                                  06410000
064200* F18 - MANUAL AUDIT CRIT SPEC (LOCAL-FUNC-02) (SUKCS588)         06420000
064300*                                                                 06430000
064400         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              06440000
064500             CONTINUE                                             06450000
064600                                                                  06460000
064700* F23 - AUDIT LIST  (LOCAL-FUNC-03) (SUKCS589)                    06470000
064800*                                                                 06480000
064900         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              06490000
065000             EVALUATE TRUE                                        06500000
065100                                                                  06510000
065200*  FOR AUDIT LIST FUNCTION THE PACKAGING TYPE IS REQUIRED UNLESS  06520000
065300*  THE AUDIT NUMBER IS SPECIFIED                                  06530000
065400                                                                  06540000
065500                WHEN  ASC-PACKAGING-TYPE = SPACES   AND           06550000
065600                     (ASC-AUDIT-NUMBER-N         = ZEROES OR      06560000
065700                      ASC-AUDIT-NUMBER           = SPACES)        06570000
065800                      SET  PS-ERROR                               06580000
065900                           DP020-MSG-FATAL TO TRUE                06590000
066000                      MOVE PC-TSYMSG-00007                        06600000
066100                                   TO DP020-MSG-NUMBER            06610000
066200                      MOVE DP015-UNP-ALP-BRT-OFF                  06620000
066300                                            TO APKGTYPA           06630000
066400                      MOVE DP015-RED        TO APKGTYPC           06640000
066500                      MOVE DP015-REVERSE    TO APKGTYPH           06650000
066600                      MOVE -1               TO APKGTYPL           06660000
066700                      SET  DP030-SET-CURSOR-APPL-1 TO TRUE        06670000
066800                      SET  DP030-OVERRIDE-GO       TO TRUE        06680000
066900                                                                  06690000
067000*  FOR AUDIT LIST FUNCTION THE PROCESS STATUS IS REQUIRED UNLESS  06700000
067100*  THE AUDIT NUMBER IS SPECIFIED                                  06710000
067200                                                                  06720000
067300                WHEN  ASC-PROCESS-STATUS = SPACES   AND           06730000
067400                     (ASC-AUDIT-NUMBER-N         = ZEROES  OR     06740000
067500                      ASC-AUDIT-NUMBER           = SPACES)        06750000
067600                      SET  PS-ERROR                               06760000
067700                           DP020-MSG-FATAL TO TRUE                06770000
067800                      MOVE PC-TSYMSG-00007                        06780000
067900                                   TO DP020-MSG-NUMBER            06790000
068000                      MOVE DP015-UNP-ALP-BRT-OFF                  06800000
068100                                            TO APRCSTAA           06810000
068200                      MOVE DP015-RED        TO APRCSTAC           06820000
068300                      MOVE DP015-REVERSE    TO APRCSTAH           06830000
068400                      MOVE -1               TO APRCSTAL           06840000
068500                      SET  DP030-SET-CURSOR-APPL-1 TO TRUE        06850000
068600                      SET  DP030-OVERRIDE-GO       TO TRUE        06860000
068700                                                                  06870000
068800*  FOR AUDIT LIST FUNCTION AT 1 OF THE 4 LIST CRITERIA MUST BE    06880000
068900*  SPECIFIED                                                      06890000
069000                                                                  06900000
069100                WHEN (ASC-PACKAGE-OPER-UNIT-ID-N = ZEROES  OR     06910000
069200                      ASC-PACKAGE-OPER-UNIT-ID   = SPACES) AND    06920000
069300                     (ASC-PO-N             = ZEROES  OR           06930000
069400                      ASC-PO               = SPACES)       AND    06940000
069500                     (ASC-ENT-ID-N         = ZEROES  OR           06950000
069600                      ASC-ENT-ID           = SPACES)       AND    06960000
069700                     (ASC-VENDOR-DESC            = SPACES) AND    06970000
069800                     (ASC-AUDIT-NUMBER-N   = ZEROES OR            06980000
069900                      ASC-AUDIT-NUMBER     = SPACES)              06990000
070000                      SET  PS-ERROR                               07000000
070100                           DP020-MSG-FATAL TO TRUE                07010000
070200                      MOVE PC-TSYMSG-02912                        07020000
070300                                   TO DP020-MSG-NUMBER            07030000
070400                      MOVE DP015-UNP-ALP-BRT-OFF                  07040000
070500                                            TO AOPRUNTA           07050000
070600                      MOVE DP015-RED        TO AOPRUNTC           07060000
070700                      MOVE DP015-REVERSE    TO AOPRUNTH           07070000
070800                                                                  07080000
070900                      MOVE DP015-UNP-ALP-BRT-OFF                  07090000
071000                                            TO APOA               07100000
071100                      MOVE DP015-RED        TO APOC               07110000
071200                      MOVE DP015-REVERSE    TO APOH               07120000
071300                                                                  07130000
071400                      MOVE DP015-UNP-ALP-BRT-OFF                  07140000
071500                                            TO AVNDNAMA           07150000
071600                      MOVE DP015-RED        TO AVNDNAMC           07160000
071700                      MOVE DP015-REVERSE    TO AVNDNAMH           07170000
071800                                                                  07180000
071900                      MOVE DP015-UNP-ALP-BRT-OFF                  07190000
072000                                            TO AVNDIDA            07200000
072100                      MOVE DP015-RED        TO AVNDIDC            07210000
072200                      MOVE DP015-REVERSE    TO AVNDIDH            07220000
072300                                                                  07230000
072400                      MOVE DP015-UNP-ALP-BRT-OFF                  07240000
072500                                            TO AAUDNBRA           07250000
072600                      MOVE DP015-RED        TO AAUDNBRC           07260000
072700                      MOVE DP015-REVERSE    TO AAUDNBRH           07270000
072800                                                                  07280000
072900                      MOVE -1               TO AOPRUNTL           07290000
073000                      SET  DP030-SET-CURSOR-APPL-1 TO TRUE        07300000
073100                      SET  DP030-OVERRIDE-GO       TO TRUE        07310000
073200                                                                  07320000
073300*  FOR AUDIT LIST FUNCTION IF REQUESTING LIST FOR A SPECIFIC      07330000
073400*  DEPARTMENT - VENDOR ID IS REQUIRED                             07340000
073500                                                                  07350000
073600                WHEN ASC-DEPT-NBR > SPACES AND                    07360000
073700                     ASC-ENT-ID = SPACES                          07370000
073800                     SET  PS-ERROR                                07380000
073900                          DP020-MSG-FATAL TO TRUE                 07390000
074000                     MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER     07400000
074100                     MOVE DP015-UNP-ALP-BRT-OFF                   07410000
074200                                           TO AVNDIDA             07420000
074300                     MOVE DP015-RED        TO AVNDIDC             07430000
074400                     MOVE DP015-REVERSE    TO AVNDIDH             07440000
074500                     MOVE -1               TO AVNDIDL             07450000
074600                     SET  DP030-SET-CURSOR-APPL-1 TO TRUE         07460000
074700                     SET  DP030-OVERRIDE-GO       TO TRUE         07470000
074800                                                                  07480000
074900                WHEN OTHER                                        07490000
075000                     PERFORM 2110-PREPARE-INTER-APPL-COMM         07500000
075100                     SET SU023-SYSTEM TO TRUE                     07510000
075200             END-EVALUATE                                         07520000
075300                                                                  07530000
075400* F14 - AUDIT DETAIL (LOCAL-FUNC-04) (SUKCS590)                   07540000
075500         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              07550000
075600             PERFORM 2110-PREPARE-INTER-APPL-COMM                 07560000
075610             SET SU023-SYSTEM TO TRUE                             07561000
075700                                                                  07570000
075800         WHEN OTHER                                               07580000
075900             SET DP013-NO-ROLLBACK                                07590000
076000                 DP013-XCTL-DISPLAY-RESTART                       07600000
076100                 DP013-CICS-ABEND  TO TRUE                        07610000
076200             MOVE '2100-CHECK-FUNCTION-KEY'                       07620000
076300                                   TO DP013-PARAGRAPH             07630000
076400             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      07640000
076500                                   TO DP013-MESSAGE-TEXT (1)      07650000
076600             MOVE 'OR CODE MISSING FROM THIS PROGRAM TO PROCESS:' 07660000
076700                                   TO DP013-MESSAGE-TEXT (2)      07670000
076800             MOVE DP020-SRC-AID    TO PM-A-SRC-AID                07680000
076900             MOVE DP020-FK-ACTION (DP020-SRC-AID)                 07690000
077000                                   TO PM-A-FK-ACTION              07700000
077100             MOVE DP020-FK-DISPN-IND (DP020-SRC-AID)              07710000
077200                                   TO PM-A-FK-DISPN               07720000
077300             MOVE PM-ABEND-INFO-A  TO DP013-MESSAGE-TEXT (3)      07730000
077400             MOVE 'REVIEW PFKEYS SETUP FOR THIS MNEMONIC.'        07740000
077500                                   TO DP013-MESSAGE-TEXT (4)      07750000
077600             PERFORM DP013-0000-PROCESS-ABEND                     07760000
077700     END-EVALUATE.                                                07770000
077800                                                                  07780000
077900*----------------------------------------------------------------*07790000
078000* CHECK TO SEE IF USER HAS RACF AUTHORIZATION                     07800000
078100*----------------------------------------------------------------*07810000
078200 2105-RACF-ACCESS.                                                07820000
078300                                                                  07830000
078400      SET DP008-RSRC-TYPE-FUNC           TO TRUE                  07840000
078500      SET DP008-ACCESS-TYPE-USE          TO TRUE                  07850000
078600                                                                  07860000
078700      EXEC CICS                                                   07870000
078800         LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                 07880000
078900              COMMAREA (DP008-SECURITY-COMMAREA)                  07890000
079000              LENGTH (DP008-SECURITY-COMMAREA-LENGTH)             07900000
079100      END-EXEC                                                    07910000
079200                                                                  07920000
079300      IF DP008-CALL-SUCCESSFUL                                    07930000
079400         IF DP008-ACCESS-ALLOWED                                  07940000
079500             SET PS-ACCESS-ALLOWED TO TRUE                        07950000
079600         ELSE                                                     07960000
079700             SET PS-ACCESS-NOT-ALLOWED TO TRUE                    07970000
079800         END-IF                                                   07980000
079900     ELSE                                                         07990000
080000         MOVE '2105-RACF-ACCESS'                                  08000000
080100                               TO DP013-PARAGRAPH                 08010000
080200          MOVE 'UNABLE TO ACCESS CICS'                            08020000
080300                               TO DP013-MESSAGE-TEXT (1)          08030000
080400          MOVE SQLCA                 TO DP013-SQLCA               08040000
080500          SET DP013-DB2-ABEND                                     08050000
080600              DP013-XCTL-DISPLAY-RESTART                          08060000
080700                               TO TRUE                            08070000
080800          PERFORM DP013-0000-PROCESS-ABEND                        08080000
080900      END-IF.                                                     08090000
081000                                                                  08100000
081100******************************************************************08110000
081200** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **08120000
081300** INTER-APPLICATION COMMAREA.                                  **08130000
081400******************************************************************08140000
081500 2110-PREPARE-INTER-APPL-COMM.                                    08150000
081600                                                                  08160000
081700     EVALUATE TRUE                                                08170000
081800*WHEN F17 PRESSED                                                 08180000
081900       WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)                08190000
082000         INITIALIZE SU017-INTER-APPL-COMMAREA                     08200000
082100         MOVE ASC-ENT-ID-N          TO SU017-ENT-ID               08210000
082200         MOVE ASC-DEPT-NBR-N        TO SU017-DEPT-NBR             08220000
082300         MOVE ASC-VENDOR-DESC       TO SU017-VENDOR-DESC          08230000
082400         MOVE ASC-DEPT-DESC         TO SU017-DEPT-DESC            08240000
082500                                                                  08250000
082600*WHEN F23 PRESSED                                                 08260000
082700       WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)                08270000
082800         INITIALIZE SU023-INTER-APPL-COMMAREA                     08280000
082900         MOVE ASC-PACKAGING-TYPE       TO SU023-PACKAGING-TYPE    08290000
083000         MOVE ASC-PROCESS-STATUS       TO SU023-PROCESS-STATUS    08300000
083100*        MOVE ASC-PO-N                 TO SU023-PO                08310000
083200         MOVE DK-PO-NBR                TO SU023-PO                08320000
083300         MOVE DK-REC-SEQ-NBR           TO SU023-RECEIVER-SEQ      08330000
083400         MOVE ASC-VENDOR-DESC          TO SU023-VENDOR-NAME       08340000
083500         MOVE DK-ENT-ID                TO SU023-ENT-ID            08350000
083600         MOVE ASC-DEPT-NBR-N           TO SU023-DEPT-NBR          08360000
083700                                                                  08370000
083800         EVALUATE TRUE                                            08380000
083900           WHEN ASC-PACKAGE-OPER-UNIT-ID NOT = SPACES             08390000
084000              MOVE ASC-PACKAGE-OPER-UNIT-ID                       08400000
084100                                        TO SU023-OPER-UNIT-ID     08410000
084200           WHEN ASC-PO-OPER-UNIT-ID      > SPACES                 08420000
084300              MOVE ASC-PO-OPER-UNIT-ID-N                          08430000
084400                                        TO SU023-OPER-UNIT-ID     08440000
084500           WHEN ASC-VENDOR-OPER-UNIT-ID  > SPACES                 08450000
084600              MOVE ASC-VENDOR-OPER-UNIT-ID-N                      08460000
084700                                        TO SU023-OPER-UNIT-ID     08470000
084800         END-EVALUATE                                             08480000
084900                                                                  08490000
085000         IF ASC-VEN-FROM-REQ-DTE-MM-N > SPACES                    08500000
085100             MOVE ASC-VEN-FROM-REQ-DTE-MM-N                       08510000
085200                                        TO SU023-FROM-DATE-MM     08520000
085300             MOVE ASC-VEN-FROM-REQ-DTE-DD-N                       08530000
085400                                        TO SU023-FROM-DATE-DD     08540000
085500             MOVE ASC-VEN-FROM-REQ-DTE-YY-N                       08550000
085600                                        TO SU023-FROM-DATE-YY     08560000
085700             MOVE ASC-VEN-TO-REQ-DTE-MM-N                         08570000
085800                                        TO SU023-TO-DATE-MM       08580000
085900             MOVE ASC-VEN-TO-REQ-DTE-DD-N                         08590000
086000                                        TO SU023-TO-DATE-DD       08600000
086100             MOVE ASC-VEN-TO-REQ-DTE-YY-N                         08610000
086200                                        TO SU023-TO-DATE-YY       08620000
086300         ELSE                                                     08630000
086400             MOVE ASC-PKG-FROM-REQ-DTE-MM-N                       08640000
086500                                        TO SU023-FROM-DATE-MM     08650000
086600             MOVE ASC-PKG-FROM-REQ-DTE-DD-N                       08660000
086700                                        TO SU023-FROM-DATE-DD     08670000
086800             MOVE ASC-PKG-FROM-REQ-DTE-YY-N                       08680000
086900                                        TO SU023-FROM-DATE-YY     08690000
087000             MOVE ASC-PKG-TO-REQ-DTE-MM-N                         08700000
087100                                        TO SU023-TO-DATE-MM       08710000
087200             MOVE ASC-PKG-TO-REQ-DTE-DD-N                         08720000
087300                                        TO SU023-TO-DATE-DD       08730000
087400             MOVE ASC-PKG-TO-REQ-DTE-YY-N                         08740000
087500                                        TO SU023-TO-DATE-YY       08750000
087600         END-IF                                                   08760000
087700         MOVE ASC-AUDIT-NUMBER-N    TO SU023-AUDIT-NBR            08770000
087800                                                                  08780000
087900*WHEN F14 PRESSED                                                 08790000
088000       WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)                08800000
088100         INITIALIZE SU023-INTER-APPL-COMMAREA                     08810000
088200         MOVE ASC-AUDIT-NUMBER-N    TO SU023-AUDIT-NBR            08820000
088210         MOVE ASC-PACKAGING-TYPE    TO SU023-PACKAGING-TYPE       08821000
088220         MOVE ASC-PROCESS-STATUS    TO SU023-PROCESS-STATUS       08822000
088300                                                                  08830000
088400     END-EVALUATE.                                                08840000
088500 EJECT                                                            08850000
088600*----------------------------------------------------------------*08860000
088700* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*08870000
088800* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *08880000
088900* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *08890000
089000*----------------------------------------------------------------*08900000
089100                                                                  08910000
089200 2200-MOVE-SCREEN-TO-COMMAREA.                                    08920000
089300                                                                  08930000
089400     IF  APKGTYPL > ZERO                                          08940000
089500         MOVE APKGTYPI             TO ASC-PACKAGING-TYPE          08950000
089600     ELSE                                                         08960000
089700         IF  APKGTYPF = DP015-ERASE-EOF                           08970000
089800             MOVE SPACE            TO ASC-PACKAGING-TYPE          08980000
089900         END-IF                                                   08990000
090000     END-IF.                                                      09000000
090100                                                                  09010000
090200     IF  APRCSTAL > ZERO                                          09020000
090300         MOVE APRCSTAI             TO ASC-PROCESS-STATUS          09030000
090400     ELSE                                                         09040000
090500         IF  APRCSTAF = DP015-ERASE-EOF                           09050000
090600             MOVE SPACE            TO ASC-PROCESS-STATUS          09060000
090700         END-IF                                                   09070000
090800     END-IF.                                                      09080000
090900                                                                  09090000
091000     IF  AOPRUNTL > ZERO                                          09100000
091100         MOVE AOPRUNTI             TO ASC-PACKAGE-OPER-UNIT-ID    09110000
091200     ELSE                                                         09120000
091300         IF  AOPRUNTF = DP015-ERASE-EOF                           09130000
091400             MOVE SPACE            TO ASC-PACKAGE-OPER-UNIT-ID    09140000
091500                                      AOPRDSCO                    09150000
091600         ELSE                                                     09160000
091700             IF ASC-PACKAGE-OPER-UNIT-ID = SPACES                 09170000
091800                 MOVE SPACE       TO  AOPRDSCO                    09180000
091900             END-IF                                               09190000
092000         END-IF                                                   09200000
092100     END-IF.                                                      09210000
092200                                                                  09220000
092300     IF  AREQFMML > ZERO                                          09230000
092400         MOVE AREQFMMI             TO ASC-PKG-FROM-REQ-DTE-MM     09240000
092500     ELSE                                                         09250000
092600         IF  AREQFMMF = DP015-ERASE-EOF                           09260000
092700             MOVE SPACE            TO ASC-PKG-FROM-REQ-DTE-MM     09270000
092800         END-IF                                                   09280000
092900     END-IF.                                                      09290000
093000                                                                  09300000
093100     IF  AREQFDDL > ZERO                                          09310000
093200         MOVE AREQFDDI             TO ASC-PKG-FROM-REQ-DTE-DD     09320000
093300     ELSE                                                         09330000
093400         IF  AREQFDDF = DP015-ERASE-EOF                           09340000
093500             MOVE SPACE            TO ASC-PKG-FROM-REQ-DTE-DD     09350000
093600         END-IF                                                   09360000
093700     END-IF.                                                      09370000
093800                                                                  09380000
093900     IF  AREQFYYL > ZERO                                          09390000
094000         MOVE AREQFYYI             TO ASC-PKG-FROM-REQ-DTE-YY     09400000
094100     ELSE                                                         09410000
094200         IF  AREQFYYF = DP015-ERASE-EOF                           09420000
094300             MOVE SPACE            TO ASC-PKG-FROM-REQ-DTE-YY     09430000
094400         END-IF                                                   09440000
094500     END-IF.                                                      09450000
094600                                                                  09460000
094700     IF  AREQTMML > ZERO                                          09470000
094800         MOVE AREQTMMI             TO ASC-PKG-TO-REQ-DTE-MM       09480000
094900     ELSE                                                         09490000
095000         IF  AREQTMMF = DP015-ERASE-EOF                           09500000
095100             MOVE SPACE            TO ASC-PKG-TO-REQ-DTE-MM       09510000
095200         END-IF                                                   09520000
095300     END-IF.                                                      09530000
095400                                                                  09540000
095500     IF  AREQTDDL > ZERO                                          09550000
095600         MOVE AREQTDDI             TO ASC-PKG-TO-REQ-DTE-DD       09560000
095700     ELSE                                                         09570000
095800         IF  AREQTDDF = DP015-ERASE-EOF                           09580000
095900             MOVE SPACE            TO ASC-PKG-TO-REQ-DTE-DD       09590000
096000         END-IF                                                   09600000
096100     END-IF.                                                      09610000
096200                                                                  09620000
096300     IF  AREQTYYL > ZERO                                          09630000
096400         MOVE AREQTYYI             TO ASC-PKG-TO-REQ-DTE-YY       09640000
096500     ELSE                                                         09650000
096600         IF  AREQTYYF = DP015-ERASE-EOF                           09660000
096700             MOVE SPACE            TO ASC-PKG-TO-REQ-DTE-YY       09670000
096800         END-IF                                                   09680000
096900     END-IF.                                                      09690000
097000                                                                  09700000
097100     IF  APOL     > ZERO                                          09710000
097200         MOVE APOI                 TO ASC-PO                      09720000
097300     ELSE                                                         09730000
097400         IF  APOF     = DP015-ERASE-EOF                           09740000
097500             MOVE SPACE            TO ASC-PO                      09750000
097600         END-IF                                                   09760000
097700     END-IF.                                                      09770000
097800                                                                  09780000
097900     IF  ARECSEQL > ZERO                                          09790000
098000         MOVE ARECSEQI             TO ASC-RECVR-SEQ-NBR           09800000
098100     ELSE                                                         09810000
098200         IF  ARECSEQF = DP015-ERASE-EOF                           09820000
098300             MOVE SPACE            TO ASC-RECVR-SEQ-NBR           09830000
098400         END-IF                                                   09840000
098500     END-IF.                                                      09850000
098600                                                                  09860000
098700     IF  APOOPERL > ZERO                                          09870000
098800         MOVE APOOPERI             TO ASC-PO-OPER-UNIT-ID         09880000
098900     ELSE                                                         09890000
099000         IF  APOOPERF = DP015-ERASE-EOF                           09900000
099100             MOVE SPACE            TO ASC-PO-OPER-UNIT-ID         09910000
099200                                      APOOPDSO                    09920000
099300         ELSE                                                     09930000
099400             IF ASC-PO-OPER-UNIT-ID = SPACES                      09940000
099500                 MOVE SPACE        TO APOOPDSO                    09950000
099600             END-IF                                               09960000
099700         END-IF                                                   09970000
099800     END-IF.                                                      09980000
099900                                                                  09990000
100000     IF  AVNDNAML > ZERO                                          10000000
100100         MOVE AVNDNAMI             TO ASC-VENDOR-DESC             10010000
100200                                      DK-ENT-NAME-DESC            10020000
100300     ELSE                                                         10030000
100400         IF  AVNDNAMF = DP015-ERASE-EOF                           10040000
100500             MOVE SPACE            TO ASC-VENDOR-DESC             10050000
100600         END-IF                                                   10060000
100700     END-IF.                                                      10070000
100800                                                                  10080000
100900     IF  AVNDIDL  > ZERO                                          10090000
101000         MOVE AVNDIDI              TO ASC-ENT-ID                  10100000
101100     ELSE                                                         10110000
101200         IF  AVNDIDF  = DP015-ERASE-EOF                           10120000
101300             MOVE SPACE            TO ASC-ENT-ID                  10130000
101400         END-IF                                                   10140000
101500     END-IF.                                                      10150000
101600                                                                  10160000
101700     IF  ADEPTL   > ZERO                                          10170000
101800         MOVE ADEPTI               TO ASC-DEPT-NBR                10180000
101900     ELSE                                                         10190000
102000         IF  ADEPTF   = DP015-ERASE-EOF                           10200000
102100             MOVE SPACE            TO ASC-DEPT-NBR                10210000
102200         END-IF                                                   10220000
102300     END-IF.                                                      10230000
102400                                                                  10240000
102500     IF  AVNOPERL > ZERO                                          10250000
102600         MOVE AVNOPERI             TO ASC-VENDOR-OPER-UNIT-ID     10260000
102700     ELSE                                                         10270000
102800         IF  AVNOPERF = DP015-ERASE-EOF                           10280000
102900             MOVE SPACE            TO ASC-VENDOR-OPER-UNIT-ID     10290000
103000                                      AVNOPDSO                    10300000
103100         ELSE                                                     10310000
103200             IF ASC-VENDOR-OPER-UNIT-ID = SPACE                   10320000
103300                 MOVE SPACE        TO AVNOPDSO                    10330000
103400             END-IF                                               10340000
103500         END-IF                                                   10350000
103600     END-IF.                                                      10360000
103700                                                                  10370000
103800     IF  AVRQFMML > ZERO                                          10380000
103900         MOVE AVRQFMMI             TO ASC-VEN-FROM-REQ-DTE-MM     10390000
104000     ELSE                                                         10400000
104100         IF  AVRQFMMF = DP015-ERASE-EOF                           10410000
104200             MOVE SPACE            TO ASC-VEN-FROM-REQ-DTE-MM     10420000
104300         END-IF                                                   10430000
104400     END-IF.                                                      10440000
104500                                                                  10450000
104600     IF  AVRQFDDL > ZERO                                          10460000
104700         MOVE AVRQFDDI             TO ASC-VEN-FROM-REQ-DTE-DD     10470000
104800     ELSE                                                         10480000
104900         IF  AVRQFDDF = DP015-ERASE-EOF                           10490000
105000             MOVE SPACE            TO ASC-VEN-FROM-REQ-DTE-DD     10500000
105100         END-IF                                                   10510000
105200     END-IF.                                                      10520000
105300                                                                  10530000
105400     IF  AVRQFYYL > ZERO                                          10540000
105500         MOVE AVRQFYYI             TO ASC-VEN-FROM-REQ-DTE-YY     10550000
105600     ELSE                                                         10560000
105700         IF  AVRQFYYF = DP015-ERASE-EOF                           10570000
105800             MOVE SPACE            TO ASC-VEN-FROM-REQ-DTE-YY     10580000
105900         END-IF                                                   10590000
106000     END-IF.                                                      10600000
106100                                                                  10610000
106200     IF  AVRQTMML > ZERO                                          10620000
106300         MOVE AVRQTMMI             TO ASC-VEN-TO-REQ-DTE-MM       10630000
106400     ELSE                                                         10640000
106500         IF  AVRQTMMF = DP015-ERASE-EOF                           10650000
106600             MOVE SPACE            TO ASC-VEN-TO-REQ-DTE-MM       10660000
106700         END-IF                                                   10670000
106800     END-IF.                                                      10680000
106900                                                                  10690000
107000     IF  AVRQTDDL > ZERO                                          10700000
107100         MOVE AVRQTDDI             TO ASC-VEN-TO-REQ-DTE-DD       10710000
107200     ELSE                                                         10720000
107300         IF  AVRQTDDF = DP015-ERASE-EOF                           10730000
107400             MOVE SPACE            TO ASC-VEN-TO-REQ-DTE-DD       10740000
107500         END-IF                                                   10750000
107600     END-IF.                                                      10760000
107700                                                                  10770000
107800     IF  AVRQTYYL > ZERO                                          10780000
107900         MOVE AVRQTYYI             TO ASC-VEN-TO-REQ-DTE-YY       10790000
108000     ELSE                                                         10800000
108100         IF  AVRQTYYF = DP015-ERASE-EOF                           10810000
108200             MOVE SPACE            TO ASC-VEN-TO-REQ-DTE-YY       10820000
108300         END-IF                                                   10830000
108400     END-IF.                                                      10840000
108500                                                                  10850000
108600     IF  AAUDNBRL > ZERO                                          10860000
108700         MOVE AAUDNBRI             TO ASC-AUDIT-NUMBER            10870000
108800     ELSE                                                         10880000
108900         IF  AAUDNBRF = DP015-ERASE-EOF                           10890000
109000             MOVE SPACE            TO ASC-AUDIT-NUMBER            10900000
109100         END-IF                                                   10910000
109200     END-IF.                                                      10920000
109300                                                                  10930000
109400*----------------------------------------------------------------*10940000
109500* ENSURE THE DATA IS CORRECT.  NOTE THAT IN A CRITERIA SPECIFI-  *10950000
109600* CATION SCREEN ONLY MINIMAL EDITS ARE DONE.  EDITS RELATED TO   *10960000
109700* A SPECIFIC SCREEN THAT THE USER IS GOING TO (LOCAL-GO) ARE DONE*10970000
109800* IN THE DESTINATION PROGRAM, NOT HERE.                          *10980000
109900*----------------------------------------------------------------*10990000
110000                                                                  11000000
110100 3000-EDIT-DATA-IN-COMMAREA.                                      11010000
110200     PERFORM 3200-RESET-ATTRIBUTES.                               11020000
110300     IF  ASC-AUDIT-NUMBER > SPACE                                 11030000
110400         MOVE ASC-AUDIT-NUMBER     TO DP010I-UNEDITED-FIELD       11040000
110500         MOVE LENGTH OF ASC-AUDIT-NUMBER TO DP010I-MAXIMUM-DIGITS 11050000
110600         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     11060000
110700         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  11070000
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         11081008
263968              USING DP010I-NUMERIC-EDIT-AREA                      11082008
110900         IF  DP010I-ERROR-DETECTED                                11090000
111000             SET PS-ERROR                                         11100000
111100                 DP020-MSG-FATAL   TO TRUE                        11110000
111200             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            11120000
111300             MOVE DP015-UNP-ALP-BRT-OFF                           11130000
111400                                   TO AAUDNBRA                    11140000
111500             MOVE DP015-RED        TO AAUDNBRC                    11150000
111600             MOVE DP015-REVERSE    TO AAUDNBRH                    11160000
111700             MOVE -1               TO AAUDNBRL                    11170000
111800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  11180000
111900         ELSE                                                     11190000
112000             MOVE DP010I-NUMERIC-FIELD                            11200000
112100                                   TO ASC-AUDIT-NUMBER-N          11210000
112200                                      SUNAUD-AUD-CNTL-NBR         11220000
112300             MOVE ASC-AUDIT-NUMBER TO AAUDNBRO                    11230000
112400             PERFORM 7000-SELECT-TSUNAUD                          11240000
112500             IF SQLCODE = +100                                    11250000
112600                 SET PS-ERROR                                     11260000
112700                     DP020-MSG-FATAL   TO TRUE                    11270000
112800                 MOVE PC-TSYMSG-02918  TO DP020-MSG-NUMBER        11280000
112900                 MOVE DP015-UNP-ALP-BRT-OFF                       11290000
113000                                       TO AAUDNBRA                11300000
113100                 MOVE DP015-RED        TO AAUDNBRC                11310000
113200                 MOVE DP015-REVERSE    TO AAUDNBRH                11320000
113300                 MOVE -1               TO AAUDNBRL                11330000
113400                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              11340000
113500             END-IF                                               11350000
113600         END-IF                                                   11360000
113700       ELSE                                                       11370000
113800         IF DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)                11380000
113900             SET PS-ERROR                                         11390000
114000                 DP020-MSG-FATAL   TO TRUE                        11400000
114100             MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER            11410000
114200             MOVE DP015-UNP-ALP-BRT-OFF                           11420000
114300                                   TO AAUDNBRA                    11430000
114400             MOVE DP015-RED        TO AAUDNBRC                    11440000
114500             MOVE DP015-REVERSE    TO AAUDNBRH                    11450000
114600             MOVE -1               TO AAUDNBRL                    11460000
114700             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  11470000
114800         END-IF                                                   11480000
114900     END-IF.                                                      11490000
115000                                                                  11500000
115100     IF  ASC-VEN-TO-REQ-DTE-YY > SPACE                            11510000
115200         MOVE ASC-VEN-TO-REQ-DTE-YY TO DP010I-UNEDITED-FIELD      11520000
115300         MOVE LENGTH OF ASC-VEN-TO-REQ-DTE-YY                     11530000
115400                                   TO DP010I-MAXIMUM-DIGITS       11540000
115500         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     11550000
115600         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  11560000
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         11571008
263968              USING DP010I-NUMERIC-EDIT-AREA                      11572008
115800         IF  DP010I-ERROR-DETECTED                                11580000
115900             SET PS-ERROR                                         11590000
116000                 PS-NUM-ERROR                                     11600000
116100                 DP020-MSG-FATAL   TO TRUE                        11610000
116200             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            11620000
116300             MOVE DP015-UNP-ALP-BRT-OFF                           11630000
116400                                   TO AVRQTYYA                    11640000
116500             MOVE DP015-RED        TO AVRQTYYC                    11650000
116600             MOVE DP015-REVERSE    TO AVRQTYYH                    11660000
116700             MOVE -1               TO AVRQTYYL                    11670000
116800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  11680000
116900         ELSE                                                     11690000
117000             MOVE DP010I-NUMERIC-FIELD                            11700000
117100                                   TO ASC-VEN-TO-REQ-DTE-YY-N     11710000
117200             MOVE ASC-VEN-TO-REQ-DTE-YY TO AVRQTYYO               11720000
117300         END-IF                                                   11730000
117400     END-IF.                                                      11740000
117500                                                                  11750000
117600     IF  ASC-VEN-TO-REQ-DTE-DD > SPACE                            11760000
117700         MOVE ASC-VEN-TO-REQ-DTE-DD TO DP010I-UNEDITED-FIELD      11770000
117800         MOVE LENGTH OF ASC-VEN-TO-REQ-DTE-DD                     11780000
117900                                   TO DP010I-MAXIMUM-DIGITS       11790000
118000         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     11800000
118100         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  11810000
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         11821008
263968              USING DP010I-NUMERIC-EDIT-AREA                      11822008
118300         IF  DP010I-ERROR-DETECTED                                11830000
118400             SET PS-ERROR                                         11840000
118500                 PS-NUM-ERROR                                     11850000
118600                 DP020-MSG-FATAL   TO TRUE                        11860000
118700             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            11870000
118800             MOVE DP015-UNP-ALP-BRT-OFF                           11880000
118900                                   TO AVRQTDDA                    11890000
119000             MOVE DP015-RED        TO AVRQTDDC                    11900000
119100             MOVE DP015-REVERSE    TO AVRQTDDH                    11910000
119200             MOVE -1               TO AVRQTDDL                    11920000
119300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  11930000
119400         ELSE                                                     11940000
119500             MOVE DP010I-NUMERIC-FIELD                            11950000
119600                                   TO ASC-VEN-TO-REQ-DTE-DD-N     11960000
119700             MOVE ASC-VEN-TO-REQ-DTE-DD TO AVRQTDDO               11970000
119800         END-IF                                                   11980000
119900     END-IF.                                                      11990000
120000                                                                  12000000
120100     IF  ASC-VEN-TO-REQ-DTE-MM > SPACE                            12010000
120200         MOVE ASC-VEN-TO-REQ-DTE-MM TO DP010I-UNEDITED-FIELD      12020000
120300         MOVE LENGTH OF ASC-VEN-TO-REQ-DTE-MM                     12030000
120400                                   TO DP010I-MAXIMUM-DIGITS       12040000
120500         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     12050000
120600         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  12060000
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         12071008
263968              USING DP010I-NUMERIC-EDIT-AREA                      12072008
120800         IF  DP010I-ERROR-DETECTED                                12080000
120900             SET PS-ERROR                                         12090000
121000                 PS-NUM-ERROR                                     12100000
121100                 DP020-MSG-FATAL   TO TRUE                        12110000
121200             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            12120000
121300             MOVE DP015-UNP-ALP-BRT-OFF                           12130000
121400                                   TO AVRQTMMA                    12140000
121500             MOVE DP015-RED        TO AVRQTMMC                    12150000
121600             MOVE DP015-REVERSE    TO AVRQTMMH                    12160000
121700             MOVE -1               TO AVRQTMML                    12170000
121800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  12180000
121900         ELSE                                                     12190000
122000             MOVE DP010I-NUMERIC-FIELD                            12200000
122100                                   TO ASC-VEN-TO-REQ-DTE-MM-N     12210000
122200             MOVE ASC-VEN-TO-REQ-DTE-MM TO AVRQTMMO               12220000
122300         END-IF                                                   12230000
122400     END-IF.                                                      12240000
122500                                                                  12250000
122600     IF  ASC-VEN-FROM-REQ-DTE-YY > SPACE                          12260000
122700         MOVE ASC-VEN-FROM-REQ-DTE-YY TO     DP010I-UNEDITED-FIELD12270000
122800         MOVE LENGTH OF ASC-VEN-FROM-REQ-DTE-YY                   12280000
122900                                   TO DP010I-MAXIMUM-DIGITS       12290000
123000         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     12300000
123100         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  12310000
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         12321008
263968              USING DP010I-NUMERIC-EDIT-AREA                      12322008
123300         IF  DP010I-ERROR-DETECTED                                12330000
123400             SET PS-ERROR                                         12340000
123500                 PS-NUM-ERROR                                     12350000
123600                 DP020-MSG-FATAL   TO TRUE                        12360000
123700             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            12370000
123800             MOVE DP015-UNP-ALP-BRT-OFF                           12380000
123900                                   TO AVRQFYYA                    12390000
124000             MOVE DP015-RED        TO AVRQFYYC                    12400000
124100             MOVE DP015-REVERSE    TO AVRQFYYH                    12410000
124200             MOVE -1               TO AVRQFYYL                    12420000
124300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  12430000
124400         ELSE                                                     12440000
124500             MOVE DP010I-NUMERIC-FIELD                            12450000
124600                               TO ASC-VEN-FROM-REQ-DTE-YY-N       12460000
124700             MOVE ASC-VEN-FROM-REQ-DTE-YY TO AVRQFYYO             12470000
124800         END-IF                                                   12480000
124900     END-IF.                                                      12490000
125000                                                                  12500000
125100     IF  ASC-VEN-FROM-REQ-DTE-DD > SPACE                          12510000
125200         MOVE ASC-VEN-FROM-REQ-DTE-DD TO     DP010I-UNEDITED-FIELD12520000
125300         MOVE LENGTH OF ASC-VEN-FROM-REQ-DTE-DD                   12530000
125400                                   TO DP010I-MAXIMUM-DIGITS       12540000
125500         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     12550000
125600         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  12560000
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         12571008
263968              USING DP010I-NUMERIC-EDIT-AREA                      12572008
125800         IF  DP010I-ERROR-DETECTED                                12580000
125900             SET PS-ERROR                                         12590000
126000                 PS-NUM-ERROR                                     12600000
126100                 DP020-MSG-FATAL   TO TRUE                        12610000
126200             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            12620000
126300             MOVE DP015-UNP-ALP-BRT-OFF                           12630000
126400                                   TO AVRQFDDA                    12640000
126500             MOVE DP015-RED        TO AVRQFDDC                    12650000
126600             MOVE DP015-REVERSE    TO AVRQFDDH                    12660000
126700             MOVE -1               TO AVRQFDDL                    12670000
126800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  12680000
126900         ELSE                                                     12690000
127000             MOVE DP010I-NUMERIC-FIELD                            12700000
127100                               TO ASC-VEN-FROM-REQ-DTE-DD-N       12710000
127200             MOVE ASC-VEN-FROM-REQ-DTE-DD TO AVRQFDDO             12720000
127300         END-IF                                                   12730000
127400     END-IF.                                                      12740000
127500                                                                  12750000
127600     IF  ASC-VEN-FROM-REQ-DTE-MM > SPACE                          12760000
127700         MOVE ASC-VEN-FROM-REQ-DTE-MM TO     DP010I-UNEDITED-FIELD12770000
127800         MOVE LENGTH OF ASC-VEN-FROM-REQ-DTE-MM                   12780000
127900                                   TO DP010I-MAXIMUM-DIGITS       12790000
128000         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     12800000
128100         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  12810000
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         12821008
263968              USING DP010I-NUMERIC-EDIT-AREA                      12822008
128300         IF  DP010I-ERROR-DETECTED                                12830000
128400             SET PS-ERROR                                         12840000
128500                 PS-NUM-ERROR                                     12850000
128600                 DP020-MSG-FATAL   TO TRUE                        12860000
128700             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            12870000
128800             MOVE DP015-UNP-ALP-BRT-OFF                           12880000
128900                                   TO AVRQFMMA                    12890000
129000             MOVE DP015-RED        TO AVRQFMMC                    12900000
129100             MOVE DP015-REVERSE    TO AVRQFMMH                    12910000
129200             MOVE -1               TO AVRQFMML                    12920000
129300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  12930000
129400         ELSE                                                     12940000
129500             MOVE DP010I-NUMERIC-FIELD                            12950000
129600                               TO ASC-VEN-FROM-REQ-DTE-MM-N       12960000
129700             MOVE ASC-VEN-FROM-REQ-DTE-MM TO AVRQFMMO             12970000
129800         END-IF                                                   12980000
129900     END-IF.                                                      12990000
130000                                                                  13000000
130100     IF  ASC-VEN-FROM-REQ-DTE-MM = SPACE AND                      13010000
130200        (ASC-VEN-FROM-REQ-DTE-DD > SPACE OR                       13020000
130300         ASC-VEN-FROM-REQ-DTE-YY > SPACE)                         13030000
130400         SET PS-ERROR                                             13040000
130500             DP020-MSG-FATAL   TO TRUE                            13050000
130600         MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER                13060000
130700         MOVE DP015-UNP-ALP-BRT-OFF                               13070000
130800                               TO AVRQFMMA                        13080000
130900         MOVE DP015-RED        TO AVRQFMMC                        13090000
131000         MOVE DP015-REVERSE    TO AVRQFMMH                        13100000
131100         MOVE -1               TO AVRQFMML                        13110000
131200         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      13120000
131300     END-IF.                                                      13130000
131400                                                                  13140000
131500     IF  ASC-VEN-FROM-REQ-DTE-DD = SPACE AND                      13150000
131600        (ASC-VEN-FROM-REQ-DTE-MM > SPACE OR                       13160000
131700         ASC-VEN-FROM-REQ-DTE-YY > SPACE)                         13170000
131800         SET PS-ERROR                                             13180000
131900             DP020-MSG-FATAL   TO TRUE                            13190000
132000         MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER                13200000
132100         MOVE DP015-UNP-ALP-BRT-OFF                               13210000
132200                               TO AVRQFDDA                        13220000
132300         MOVE DP015-RED        TO AVRQFDDC                        13230000
132400         MOVE DP015-REVERSE    TO AVRQFDDH                        13240000
132500         MOVE -1               TO AVRQFDDL                        13250000
132600         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      13260000
132700     END-IF.                                                      13270000
132800                                                                  13280000
132900     IF  ASC-VEN-FROM-REQ-DTE-YY = SPACE AND                      13290000
133000        (ASC-VEN-FROM-REQ-DTE-DD > SPACE OR                       13300000
133100         ASC-VEN-FROM-REQ-DTE-MM > SPACE)                         13310000
133200         SET PS-ERROR                                             13320000
133300             DP020-MSG-FATAL   TO TRUE                            13330000
133400         MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER                13340000
133500         MOVE DP015-UNP-ALP-BRT-OFF                               13350000
133600                               TO AVRQFYYA                        13360000
133700         MOVE DP015-RED        TO AVRQFYYC                        13370000
133800         MOVE DP015-REVERSE    TO AVRQFYYH                        13380000
133900         MOVE -1               TO AVRQFYYL                        13390000
134000         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      13400000
134100     END-IF.                                                      13410000
134200                                                                  13420000
134300     IF  ASC-VEN-TO-REQ-DTE-MM = SPACE AND                        13430000
134400        (ASC-VEN-TO-REQ-DTE-DD > SPACE OR                         13440000
134500         ASC-VEN-TO-REQ-DTE-YY > SPACE)                           13450000
134600         SET PS-ERROR                                             13460000
134700             DP020-MSG-FATAL   TO TRUE                            13470000
134800         MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER                13480000
134900         MOVE DP015-UNP-ALP-BRT-OFF                               13490000
135000                               TO AVRQTMMA                        13500000
135100         MOVE DP015-RED        TO AVRQTMMC                        13510000
135200         MOVE DP015-REVERSE    TO AVRQTMMH                        13520000
135300         MOVE -1               TO AVRQTMML                        13530000
135400         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      13540000
135500     END-IF.                                                      13550000
135600                                                                  13560000
135700     IF  ASC-VEN-TO-REQ-DTE-DD = SPACE AND                        13570000
135800        (ASC-VEN-TO-REQ-DTE-MM > SPACE OR                         13580000
135900         ASC-VEN-TO-REQ-DTE-YY > SPACE)                           13590000
136000         SET PS-ERROR                                             13600000
136100             DP020-MSG-FATAL   TO TRUE                            13610000
136200         MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER                13620000
136300         MOVE DP015-UNP-ALP-BRT-OFF                               13630000
136400                               TO AVRQTDDA                        13640000
136500         MOVE DP015-RED        TO AVRQTDDC                        13650000
136600         MOVE DP015-REVERSE    TO AVRQTDDH                        13660000
136700         MOVE -1               TO AVRQTDDL                        13670000
136800         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      13680000
136900     END-IF.                                                      13690000
137000                                                                  13700000
137100     IF  ASC-VEN-TO-REQ-DTE-YY = SPACE AND                        13710000
137200        (ASC-VEN-TO-REQ-DTE-DD > SPACE OR                         13720000
137300         ASC-VEN-TO-REQ-DTE-MM > SPACE)                           13730000
137400         SET PS-ERROR                                             13740000
137500             DP020-MSG-FATAL   TO TRUE                            13750000
137600         MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER                13760000
137700         MOVE DP015-UNP-ALP-BRT-OFF                               13770000
137800                               TO AVRQTYYA                        13780000
137900         MOVE DP015-RED        TO AVRQTYYC                        13790000
138000         MOVE DP015-REVERSE    TO AVRQTYYH                        13800000
138100         MOVE -1               TO AVRQTYYL                        13810000
138200         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      13820000
138300     END-IF.                                                      13830000
138400                                                                  13840000
138500     IF (ASC-VEN-FROM-REQ-DTE-MM > SPACE AND                      13850000
138600         ASC-VEN-FROM-REQ-DTE-DD > SPACE AND                      13860000
138700         ASC-VEN-FROM-REQ-DTE-YY > SPACE) AND                     13870000
138800        (ASC-VEN-TO-REQ-DTE-YY = SPACE AND                        13880000
138900         ASC-VEN-TO-REQ-DTE-DD = SPACE AND                        13890000
139000         ASC-VEN-TO-REQ-DTE-MM = SPACE)                           13900000
139100         SET PS-ERROR                                             13910000
139200             DP020-MSG-FATAL   TO TRUE                            13920000
139300         MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER                13930000
139400         MOVE DP015-UNP-ALP-BRT-OFF                               13940000
139500                               TO AVRQTMMA                        13950000
139600         MOVE DP015-RED        TO AVRQTMMC                        13960000
139700         MOVE DP015-REVERSE    TO AVRQTMMH                        13970000
139800         MOVE DP015-UNP-ALP-BRT-OFF                               13980000
139900                               TO AVRQTDDA                        13990000
140000         MOVE DP015-RED        TO AVRQTDDC                        14000000
140100         MOVE DP015-REVERSE    TO AVRQTDDH                        14010000
140200         MOVE DP015-UNP-ALP-BRT-OFF                               14020000
140300                               TO AVRQTYYA                        14030000
140400         MOVE DP015-RED        TO AVRQTYYC                        14040000
140500         MOVE DP015-REVERSE    TO AVRQTYYH                        14050000
140600         MOVE -1               TO AVRQTMML                        14060000
140700         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      14070000
140800     END-IF.                                                      14080000
140900                                                                  14090000
141000     IF (ASC-VEN-TO-REQ-DTE-MM > SPACE AND                        14100000
141100         ASC-VEN-TO-REQ-DTE-DD > SPACE AND                        14110000
141200         ASC-VEN-TO-REQ-DTE-YY > SPACE) AND                       14120000
141300        (ASC-VEN-FROM-REQ-DTE-YY = SPACE AND                      14130000
141400         ASC-VEN-FROM-REQ-DTE-DD = SPACE AND                      14140000
141500         ASC-VEN-FROM-REQ-DTE-MM = SPACE)                         14150000
141600         SET PS-ERROR                                             14160000
141700             DP020-MSG-FATAL   TO TRUE                            14170000
141800         MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER                14180000
141900         MOVE DP015-UNP-ALP-BRT-OFF                               14190000
142000                               TO AVRQFMMA                        14200000
142100         MOVE DP015-RED        TO AVRQFMMC                        14210000
142200         MOVE DP015-REVERSE    TO AVRQFMMH                        14220000
142300         MOVE DP015-UNP-ALP-BRT-OFF                               14230000
142400                               TO AVRQFDDA                        14240000
142500         MOVE DP015-RED        TO AVRQFDDC                        14250000
142600         MOVE DP015-REVERSE    TO AVRQFDDH                        14260000
142700         MOVE DP015-UNP-ALP-BRT-OFF                               14270000
142800                               TO AVRQFYYA                        14280000
142900         MOVE DP015-RED        TO AVRQFYYC                        14290000
143000         MOVE DP015-REVERSE    TO AVRQFYYH                        14300000
143100         MOVE -1               TO AVRQFMML                        14310000
143200         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      14320000
143300     END-IF.                                                      14330000
143400                                                                  14340000
143500     IF  ASC-VEN-FROM-REQ-DTE-MM > SPACE AND                      14350000
143600         ASC-VEN-FROM-REQ-DTE-DD > SPACE AND                      14360000
143700         ASC-VEN-FROM-REQ-DTE-YY > SPACE AND                      14370000
143800         ASC-VEN-TO-REQ-DTE-MM > SPACE AND                        14380000
143900         ASC-VEN-TO-REQ-DTE-DD > SPACE AND                        14390000
144000         ASC-VEN-TO-REQ-DTE-YY > SPACE                            14400000
144100         MOVE ASC-VEN-FROM-REQ-DTE-MM  TO  PV-FROM-MM             14410000
144200         MOVE ASC-VEN-FROM-REQ-DTE-DD  TO  PV-FROM-DD             14420000
144300         MOVE ASC-VEN-FROM-REQ-DTE-YY  TO  PV-FROM-YY             14430000
144400         MOVE ASC-VEN-TO-REQ-DTE-MM    TO  PV-TO-MM               14440000
144500         MOVE ASC-VEN-TO-REQ-DTE-DD    TO  PV-TO-DD               14450000
144600         MOVE ASC-VEN-TO-REQ-DTE-YY    TO  PV-TO-YY               14460000
144700         SET PS-NO-DATE-ERROR TO TRUE                             14470000
144800         PERFORM 3140-VALIDATE-FROM-TO                            14480000
144900         IF PS-DATE-ERROR                                         14490000
145000             MOVE DP015-UNP-ALP-BRT-OFF  TO AVRQFMMA              14500000
145100                                            AVRQFDDA              14510000
145200                                            AVRQFYYA              14520000
145300                                            AVRQTMMA              14530000
145400                                            AVRQTDDA              14540000
145500                                            AVRQTYYA              14550000
145600             MOVE DP015-RED              TO AVRQFMMC              14560000
145700                                            AVRQFDDC              14570000
145800                                            AVRQFYYC              14580000
145900                                            AVRQTMMC              14590000
146000                                            AVRQTDDC              14600000
146100                                            AVRQTYYC              14610000
146200             MOVE DP015-REVERSE          TO AVRQFMMH              14620000
146300                                            AVRQFDDH              14630000
146400                                            AVRQFYYH              14640000
146500                                            AVRQTMMH              14650000
146600                                            AVRQTDDH              14660000
146700                                            AVRQTYYH              14670000
146800             MOVE -1                     TO AVRQFMML              14680000
146900         END-IF                                                   14690000
147000     END-IF.                                                      14700000
147100                                                                  14710000
147200     IF  ASC-VENDOR-OPER-UNIT-ID > SPACE                          14720000
147300         IF  ASC-VENDOR-OPER-UNIT-ID NOT EQUAL 'ALL ' AND         14730000
147400             ASC-VENDOR-OPER-UNIT-ID NOT EQUAL ' ALL'             14740000
147500             MOVE ASC-VENDOR-OPER-UNIT-ID TO DP010I-UNEDITED-FIELD14750000
147600             MOVE LENGTH OF ASC-VENDOR-OPER-UNIT-ID               14760000
147700                                       TO DP010I-MAXIMUM-DIGITS   14770000
147800             MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS 14780000
147900             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              14790000
263968             CALL DP010I-NUMERIC-EDIT-ROUTINE                     14801008
263968                  USING DP010I-NUMERIC-EDIT-AREA                  14802008
148100             IF  DP010I-ERROR-DETECTED                            14810000
148200                 SET PS-ERROR                                     14820000
148300                     DP020-MSG-FATAL   TO TRUE                    14830000
148400                 MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER        14840000
148500                 MOVE DP015-UNP-ALP-BRT-OFF                       14850000
148600                                       TO AVNOPERA                14860000
148700                 MOVE DP015-RED        TO AVNOPERC                14870000
148800                 MOVE DP015-REVERSE    TO AVNOPERH                14880000
148900                 MOVE -1               TO AVNOPERL                14890000
149000                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              14900000
149100             ELSE                                                 14910000
149200                 MOVE DP010I-NUMERIC-FIELD                        14920000
149300                                   TO ASC-VENDOR-OPER-UNIT-ID-N   14930000
149400                                      DK-OPER-UNIT                14940000
149500                 MOVE ASC-VENDOR-OPER-UNIT-ID TO AVNOPERO         14950000
149600                 SET PS-OPER-UNIT-NOT-FOUND TO TRUE               14960000
149700                 PERFORM 3100-VALIDATE-OPER-UNIT                  14970000
149800                 IF PS-OPER-UNIT-NOT-FOUND                        14980000
149900                     SET PS-ERROR                                 14990000
150000                         DP020-MSG-FATAL   TO TRUE                15000000
150100                     MOVE PC-TSYMSG-02572  TO DP020-MSG-NUMBER    15010000
150200                     MOVE DP015-UNP-ALP-BRT-OFF                   15020000
150300                                           TO AVNOPERA            15030000
150400                     MOVE DP015-RED        TO AVNOPERC            15040000
150500                     MOVE DP015-REVERSE    TO AVNOPERH            15050000
150600                     MOVE -1               TO AVNOPERL            15060000
150700                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          15070000
150800                 ELSE                                             15080000
150900                     MOVE XLT00010-LOC-NM     TO AVNOPDSO         15090000
151000                 END-IF                                           15100000
151100             END-IF                                               15110000
151200         ELSE                                                     15120000
151300             MOVE PC-ALL-DISTRIB-CNTRS TO AVNOPDSO                15130000
151400         END-IF                                                   15140000
151500     END-IF.                                                      15150000
151600                                                                  15160000
151700     IF  ASC-ENT-ID > SPACE                                       15170000
151800         MOVE ASC-ENT-ID           TO DP010I-UNEDITED-FIELD       15180000
151900         MOVE LENGTH OF ASC-ENT-ID TO DP010I-MAXIMUM-DIGITS       15190000
152000         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     15200000
152100         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  15210000
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         15221008
263968              USING DP010I-NUMERIC-EDIT-AREA                      15222008
152300         IF  DP010I-ERROR-DETECTED                                15230000
152400             SET PS-ERROR                                         15240000
152500                 DP020-MSG-FATAL   TO TRUE                        15250000
152600             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            15260000
152700             MOVE DP015-UNP-ALP-BRT-OFF                           15270000
152800                                   TO AVNDIDA                     15280000
152900             MOVE DP015-RED        TO AVNDIDC                     15290000
153000             MOVE DP015-REVERSE    TO AVNDIDH                     15300000
153100             MOVE -1               TO AVNDIDL                     15310000
153200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  15320000
153300         ELSE                                                     15330000
153400             MOVE DP010I-NUMERIC-FIELD                            15340000
153500                                   TO ASC-ENT-ID-N                15350000
153600                                      DK-ENT-ID                   15360000
153700*            MOVE ASC-ENT-ID       TO AVNDIDO                     15370000
153800             MOVE ASC-ENT-ID-N     TO AVNDIDO                     15380000
153900             PERFORM 3110-VALIDATE-ENT-ID                         15390000
154000             IF PS-NO-ENT-ID-FOUND                                15400000
154100                 SET PS-ERROR                                     15410000
154200                     DP020-MSG-FATAL   TO TRUE                    15420000
154300                 MOVE PC-TSYMSG-02850  TO DP020-MSG-NUMBER        15430000
154400                 MOVE DP015-UNP-ALP-BRT-OFF                       15440000
154500                                       TO AVNDIDA                 15450000
154600                 MOVE DP015-RED        TO AVNDIDC                 15460000
154700                 MOVE DP015-REVERSE    TO AVNDIDH                 15470000
154800                 MOVE -1               TO AVNDIDL                 15480000
154900                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              15490000
155000             END-IF                                               15500000
155100         END-IF                                                   15510000
155200     END-IF.                                                      15520000
155300                                                                  15530000
155400     IF  ASC-DEPT-NBR > SPACE                                     15540000
155500         IF  ASC-ENT-ID = SPACE                                   15550000
155600             SET PS-ERROR                                         15560000
155700                 DP020-MSG-FATAL   TO TRUE                        15570000
155800             MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER            15580000
155900             MOVE DP015-UNP-ALP-BRT-OFF                           15590000
156000                                   TO AVNDIDA                     15600000
156100             MOVE DP015-RED        TO AVNDIDC                     15610000
156200             MOVE DP015-REVERSE    TO AVNDIDH                     15620000
156300             MOVE -1               TO AVNDIDL                     15630000
156400             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  15640000
156500         ELSE                                                     15650000
156600             MOVE ASC-DEPT-NBR         TO DP010I-UNEDITED-FIELD   15660000
156700             MOVE LENGTH OF ASC-DEPT-NBR TO DP010I-MAXIMUM-DIGITS 15670000
156800             MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS 15680000
156900             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              15690000
263968             CALL DP010I-NUMERIC-EDIT-ROUTINE                     15701008
263968                  USING DP010I-NUMERIC-EDIT-AREA                  15702008
157100             IF  DP010I-ERROR-DETECTED                            15710000
157200                 SET PS-ERROR                                     15720000
157300                     DP020-MSG-FATAL   TO TRUE                    15730000
157400                 MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER        15740000
157500                 MOVE DP015-UNP-ALP-BRT-OFF                       15750000
157600                                       TO ADEPTA                  15760000
157700                 MOVE DP015-RED        TO ADEPTC                  15770000
157800                 MOVE DP015-REVERSE    TO ADEPTH                  15780000
157900                 MOVE -1               TO ADEPTL                  15790000
158000                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              15800000
158100             ELSE                                                 15810000
158200                 MOVE DP010I-NUMERIC-FIELD                        15820000
158300                                       TO ASC-DEPT-NBR-N          15830000
158400                 MOVE ASC-DEPT-NBR-N   TO ADEPTO                  15840000
158500                 MOVE ASC-DEPT-NBR(2:3)  TO DK-DEPT               15850000
158600                 PERFORM 3120-VALIDATE-DEPT                       15860000
158700                 IF PS-NO-DEPT-FOUND                              15870000
158800                     SET PS-ERROR                                 15880000
158900                         DP020-MSG-FATAL   TO TRUE                15890000
159000                     MOVE PC-TSYMSG-00588  TO DP020-MSG-NUMBER    15900000
159100                     MOVE DP015-UNP-ALP-BRT-OFF                   15910000
159200                                           TO ADEPTA              15920000
159300                     MOVE DP015-RED        TO ADEPTC              15930000
159400                     MOVE DP015-REVERSE    TO ADEPTH              15940000
159500                     MOVE -1               TO ADEPTL              15950000
159600                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          15960000
159700                 END-IF                                           15970000
159800             END-IF                                               15980000
159900         END-IF                                                   15990000
160000     END-IF.                                                      16000000
160100                                                                  16010000
160200     IF  ASC-PO-OPER-UNIT-ID > SPACE                              16020000
160300         IF  ASC-PO-OPER-UNIT-ID NOT EQUAL 'ALL ' AND             16030000
160400             ASC-PO-OPER-UNIT-ID NOT EQUAL ' ALL'                 16040000
160500             MOVE ASC-PO-OPER-UNIT-ID  TO DP010I-UNEDITED-FIELD   16050000
160600             MOVE LENGTH OF ASC-PO-OPER-UNIT-ID                   16060000
160700                                       TO DP010I-MAXIMUM-DIGITS   16070000
160800             MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS 16080000
160900             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              16090000
263968             CALL DP010I-NUMERIC-EDIT-ROUTINE                     16101008
263968                  USING DP010I-NUMERIC-EDIT-AREA                  16102008
161100             IF  DP010I-ERROR-DETECTED                            16110000
161200                 SET PS-ERROR                                     16120000
161300                     DP020-MSG-FATAL   TO TRUE                    16130000
161400                 MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER        16140000
161500                 MOVE DP015-UNP-ALP-BRT-OFF                       16150000
161600                                       TO APOOPERA                16160000
161700                 MOVE DP015-RED        TO APOOPERC                16170000
161800                 MOVE DP015-REVERSE    TO APOOPERH                16180000
161900                 MOVE -1               TO APOOPERL                16190000
162000                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              16200000
162100             ELSE                                                 16210000
162200                 MOVE DP010I-NUMERIC-FIELD                        16220000
162300                                       TO ASC-PO-OPER-UNIT-ID-N   16230000
162400                                          DK-OPER-UNIT            16240000
162500                 MOVE ASC-PO-OPER-UNIT-ID TO APOOPERO             16250000
162600                 SET PS-OPER-UNIT-NOT-FOUND TO TRUE               16260000
162700                 PERFORM 3100-VALIDATE-OPER-UNIT                  16270000
162800                 IF PS-OPER-UNIT-NOT-FOUND                        16280000
162900                     SET PS-ERROR                                 16290000
163000                         DP020-MSG-FATAL   TO TRUE                16300000
163100                     MOVE PC-TSYMSG-02572  TO DP020-MSG-NUMBER    16310000
163200                     MOVE DP015-UNP-ALP-BRT-OFF                   16320000
163300                                           TO APOOPERA            16330000
163400                     MOVE DP015-RED        TO APOOPERC            16340000
163500                     MOVE DP015-REVERSE    TO APOOPERH            16350000
163600                     MOVE -1               TO APOOPERL            16360000
163700                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          16370000
163800                 ELSE                                             16380000
150900                     MOVE XLT00010-LOC-NM     TO APOOPDSO         16381000
164000                 END-IF                                           16400000
164100             END-IF                                               16410000
164200         ELSE                                                     16420000
164300             MOVE PC-ALL-DISTRIB-CNTRS    TO APOOPDSO             16430000
164400         END-IF                                                   16440000
164500     END-IF.                                                      16450000
164600                                                                  16460000
164700     IF  ASC-RECVR-SEQ-NBR > SPACE                                16470000
164800         MOVE ASC-RECVR-SEQ-NBR    TO DP010I-UNEDITED-FIELD       16480000
164900         MOVE LENGTH OF ASC-RECVR-SEQ-NBR TO DP010I-MAXIMUM-DIGITS16490000
165000         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     16500000
165100         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  16510000
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         16521008
263968              USING DP010I-NUMERIC-EDIT-AREA                      16522008
165300         IF  DP010I-ERROR-DETECTED                                16530000
165400             SET PS-ERROR                                         16540000
165500                 DP020-MSG-FATAL   TO TRUE                        16550000
165600             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            16560000
165700             MOVE DP015-UNP-ALP-BRT-OFF                           16570000
165800                                   TO ARECSEQA                    16580000
165900             MOVE DP015-RED        TO ARECSEQC                    16590000
166000             MOVE DP015-REVERSE    TO ARECSEQH                    16600000
166100             MOVE -1               TO ARECSEQL                    16610000
166200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  16620000
166300         ELSE                                                     16630000
166400             MOVE DP010I-NUMERIC-FIELD                            16640000
166500                                   TO ASC-RECVR-SEQ-NBR-N         16650000
166600                                      DK-REC-SEQ-NBR              16660000
166700             MOVE ASC-RECVR-SEQ-NBR TO ARECSEQO                   16670000
166800         END-IF                                                   16680000
166900     END-IF.                                                      16690000
167000                                                                  16700000
167100     IF  ASC-PO > SPACE                                           16710000
167200         MOVE ASC-PO               TO DP010I-UNEDITED-FIELD       16720000
167300         MOVE LENGTH OF ASC-PO TO DP010I-MAXIMUM-DIGITS           16730000
167400         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     16740000
167500         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  16750000
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         16761008
263968              USING DP010I-NUMERIC-EDIT-AREA                      16762008
167700         IF  DP010I-ERROR-DETECTED                                16770000
167800             SET PS-ERROR                                         16780000
167900                 DP020-MSG-FATAL   TO TRUE                        16790000
168000             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            16800000
168100             MOVE DP015-UNP-ALP-BRT-OFF                           16810000
168200                                   TO APOA                        16820000
168300             MOVE DP015-RED        TO APOC                        16830000
168400             MOVE DP015-REVERSE    TO APOH                        16840000
168500             MOVE -1               TO APOL                        16850000
168600             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  16860000
168700         ELSE                                                     16870000
168800             MOVE DP010I-NUMERIC-FIELD                            16880000
168900                                   TO ASC-PO-N                    16890000
169000                                      DK-PO-NBR                   16900000
169100             MOVE ASC-PO           TO APOO                        16910000
169200             PERFORM 3130-VALIDATE-PO                             16920000
169300             IF PS-NO-PO-FOUND                                    16930000
169400                 SET PS-ERROR                                     16940000
169500                     DP020-MSG-FATAL   TO TRUE                    16950000
169600                 MOVE PC-TSYMSG-02858  TO DP020-MSG-NUMBER        16960000
169700                 MOVE DP015-UNP-ALP-BRT-OFF                       16970000
169800                                       TO APOA                    16980000
169900                 MOVE DP015-RED        TO APOC                    16990000
170000                 MOVE DP015-REVERSE    TO APOH                    17000000
170100                 MOVE -1               TO APOL                    17010000
170200                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              17020000
170300             END-IF                                               17030000
170400         END-IF                                                   17040000
170500     END-IF.                                                      17050000
170600*                                                                 17060000
170700     IF  ASC-PKG-TO-REQ-DTE-YY > SPACE                            17070000
170800         MOVE ASC-PKG-TO-REQ-DTE-YY TO DP010I-UNEDITED-FIELD      17080000
170900         MOVE LENGTH OF ASC-PKG-TO-REQ-DTE-YY                     17090000
171000                                   TO DP010I-MAXIMUM-DIGITS       17100000
171100         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     17110000
171200         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  17120000
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         17131008
263968              USING DP010I-NUMERIC-EDIT-AREA                      17132008
171400         IF  DP010I-ERROR-DETECTED                                17140000
171500             SET PS-ERROR                                         17150000
171600                 PS-NUM-ERROR                                     17160000
171700                 DP020-MSG-FATAL   TO TRUE                        17170000
171800             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            17180000
171900             MOVE DP015-UNP-ALP-BRT-OFF                           17190000
172000                                   TO AREQTYYA                    17200000
172100             MOVE DP015-RED        TO AREQTYYC                    17210000
172200             MOVE DP015-REVERSE    TO AREQTYYH                    17220000
172300             MOVE -1               TO AREQTYYL                    17230000
172400             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  17240000
172500         ELSE                                                     17250000
172600             MOVE DP010I-NUMERIC-FIELD                            17260000
172700                                   TO ASC-PKG-TO-REQ-DTE-YY-N     17270000
172800             MOVE ASC-PKG-TO-REQ-DTE-YY TO AREQTYYO               17280000
172900         END-IF                                                   17290000
173000     END-IF.                                                      17300000
173100*                                                                 17310000
173200     IF  ASC-PKG-TO-REQ-DTE-DD > SPACE                            17320000
173300         MOVE ASC-PKG-TO-REQ-DTE-DD TO DP010I-UNEDITED-FIELD      17330000
173400         MOVE LENGTH OF ASC-PKG-TO-REQ-DTE-DD                     17340000
173500                                   TO DP010I-MAXIMUM-DIGITS       17350000
173600         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     17360000
173700         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  17370000
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         17381008
263968              USING DP010I-NUMERIC-EDIT-AREA                      17382008
173900         IF  DP010I-ERROR-DETECTED                                17390000
174000             SET PS-ERROR                                         17400000
174100                 PS-NUM-ERROR                                     17410000
174200                 DP020-MSG-FATAL   TO TRUE                        17420000
174300             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            17430000
174400             MOVE DP015-UNP-ALP-BRT-OFF                           17440000
174500                                   TO AREQTDDA                    17450000
174600             MOVE DP015-RED        TO AREQTDDC                    17460000
174700             MOVE DP015-REVERSE    TO AREQTDDH                    17470000
174800             MOVE -1               TO AREQTDDL                    17480000
174900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  17490000
175000         ELSE                                                     17500000
175100             MOVE DP010I-NUMERIC-FIELD                            17510000
175200                                   TO ASC-PKG-TO-REQ-DTE-DD-N     17520000
175300             MOVE ASC-PKG-TO-REQ-DTE-DD TO AREQTDDO               17530000
175400         END-IF                                                   17540000
175500     END-IF.                                                      17550000
175600*                                                                 17560000
175700     IF  ASC-PKG-TO-REQ-DTE-MM > SPACE                            17570000
175800         MOVE ASC-PKG-TO-REQ-DTE-MM TO DP010I-UNEDITED-FIELD      17580000
175900         MOVE LENGTH OF ASC-PKG-TO-REQ-DTE-MM                     17590000
176000                                   TO DP010I-MAXIMUM-DIGITS       17600000
176100         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     17610000
176200         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  17620000
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         17631008
263968              USING DP010I-NUMERIC-EDIT-AREA                      17632008
176400         IF  DP010I-ERROR-DETECTED                                17640000
176500             SET PS-ERROR                                         17650000
176600                 PS-NUM-ERROR                                     17660000
176700                 DP020-MSG-FATAL   TO TRUE                        17670000
176800             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            17680000
176900             MOVE DP015-UNP-ALP-BRT-OFF                           17690000
177000                                   TO AREQTMMA                    17700000
177100             MOVE DP015-RED        TO AREQTMMC                    17710000
177200             MOVE DP015-REVERSE    TO AREQTMMH                    17720000
177300             MOVE -1               TO AREQTMML                    17730000
177400             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  17740000
177500         ELSE                                                     17750000
177600             MOVE DP010I-NUMERIC-FIELD                            17760000
177700                                   TO ASC-PKG-TO-REQ-DTE-MM-N     17770000
177800             MOVE ASC-PKG-TO-REQ-DTE-MM TO AREQTMMO               17780000
177900         END-IF                                                   17790000
178000     END-IF.                                                      17800000
178100*                                                                 17810000
178200     IF  ASC-PKG-FROM-REQ-DTE-YY > SPACE                          17820000
178300         MOVE ASC-PKG-FROM-REQ-DTE-YY TO     DP010I-UNEDITED-FIELD17830000
178400         MOVE LENGTH OF ASC-PKG-FROM-REQ-DTE-YY                   17840000
178500                                   TO DP010I-MAXIMUM-DIGITS       17850000
178600         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     17860000
178700         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  17870000
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         17881008
263968              USING DP010I-NUMERIC-EDIT-AREA                      17882008
178900         IF  DP010I-ERROR-DETECTED                                17890000
179000             SET PS-ERROR                                         17900000
179100                 PS-NUM-ERROR                                     17910000
179200                 DP020-MSG-FATAL   TO TRUE                        17920000
179300             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            17930000
179400             MOVE DP015-UNP-ALP-BRT-OFF                           17940000
179500                                   TO AREQFYYA                    17950000
179600             MOVE DP015-RED        TO AREQFYYC                    17960000
179700             MOVE DP015-REVERSE    TO AREQFYYH                    17970000
179800             MOVE -1               TO AREQFYYL                    17980000
179900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  17990000
180000         ELSE                                                     18000000
180100             MOVE DP010I-NUMERIC-FIELD                            18010000
180200                               TO ASC-PKG-FROM-REQ-DTE-YY-N       18020000
180300             MOVE ASC-PKG-FROM-REQ-DTE-YY TO AREQFYYO             18030000
180400         END-IF                                                   18040000
180500     END-IF.                                                      18050000
180600*                                                                 18060000
180700     IF  ASC-PKG-FROM-REQ-DTE-DD > SPACE                          18070000
180800         MOVE ASC-PKG-FROM-REQ-DTE-DD TO     DP010I-UNEDITED-FIELD18080000
180900         MOVE LENGTH OF ASC-PKG-FROM-REQ-DTE-DD                   18090000
181000                                   TO DP010I-MAXIMUM-DIGITS       18100000
181100         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     18110000
181200         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  18120000
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         18131008
263968              USING DP010I-NUMERIC-EDIT-AREA                      18132008
181400         IF  DP010I-ERROR-DETECTED                                18140000
181500             SET PS-ERROR                                         18150000
181600                 PS-NUM-ERROR                                     18160000
181700                 DP020-MSG-FATAL   TO TRUE                        18170000
181800             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            18180000
181900             MOVE DP015-UNP-ALP-BRT-OFF                           18190000
182000                                   TO AREQFDDA                    18200000
182100             MOVE DP015-RED        TO AREQFDDC                    18210000
182200             MOVE DP015-REVERSE    TO AREQFDDH                    18220000
182300             MOVE -1               TO AREQFDDL                    18230000
182400             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  18240000
182500         ELSE                                                     18250000
182600             MOVE DP010I-NUMERIC-FIELD                            18260000
182700                                 TO ASC-PKG-FROM-REQ-DTE-DD-N     18270000
182800             MOVE ASC-PKG-FROM-REQ-DTE-DD TO AREQFDDO             18280000
182900         END-IF                                                   18290000
183000     END-IF.                                                      18300000
183100*                                                                 18310000
183200     IF  ASC-PKG-FROM-REQ-DTE-MM > SPACE                          18320000
183300         MOVE ASC-PKG-FROM-REQ-DTE-MM TO     DP010I-UNEDITED-FIELD18330000
183400         MOVE LENGTH OF ASC-PKG-FROM-REQ-DTE-MM                   18340000
183500                                   TO DP010I-MAXIMUM-DIGITS       18350000
183600         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     18360000
183700         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  18370000
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         18381008
263968              USING DP010I-NUMERIC-EDIT-AREA                      18382008
183900         IF  DP010I-ERROR-DETECTED                                18390000
184000             SET PS-ERROR                                         18400000
184100                 PS-NUM-ERROR                                     18410000
184200                 DP020-MSG-FATAL   TO TRUE                        18420000
184300             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            18430000
184400             MOVE DP015-UNP-ALP-BRT-OFF                           18440000
184500                                   TO AREQFMMA                    18450000
184600             MOVE DP015-RED        TO AREQFMMC                    18460000
184700             MOVE DP015-REVERSE    TO AREQFMMH                    18470000
184800             MOVE -1               TO AREQFMML                    18480000
184900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  18490000
185000         ELSE                                                     18500000
185100             MOVE DP010I-NUMERIC-FIELD                            18510000
185200                               TO ASC-PKG-FROM-REQ-DTE-MM-N       18520000
185300             MOVE ASC-PKG-FROM-REQ-DTE-MM TO AREQFMMO             18530000
185400         END-IF                                                   18540000
185500     END-IF.                                                      18550000
185600                                                                  18560000
185700     IF  ASC-PKG-FROM-REQ-DTE-MM = SPACE AND                      18570000
185800        (ASC-PKG-FROM-REQ-DTE-DD > SPACE OR                       18580000
185900         ASC-PKG-FROM-REQ-DTE-YY > SPACE)                         18590000
186000         SET PS-ERROR                                             18600000
186100             DP020-MSG-FATAL   TO TRUE                            18610000
186200         MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER                18620000
186300         MOVE DP015-UNP-ALP-BRT-OFF                               18630000
186400                               TO AREQFMMA                        18640000
186500         MOVE DP015-RED        TO AREQFMMC                        18650000
186600         MOVE DP015-REVERSE    TO AREQFMMH                        18660000
186700         MOVE -1               TO AREQFMML                        18670000
186800         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      18680000
186900     END-IF.                                                      18690000
187000                                                                  18700000
187100     IF  ASC-PKG-FROM-REQ-DTE-DD = SPACE AND                      18710000
187200        (ASC-PKG-FROM-REQ-DTE-MM > SPACE OR                       18720000
187300         ASC-PKG-FROM-REQ-DTE-YY > SPACE)                         18730000
187400         SET PS-ERROR                                             18740000
187500             DP020-MSG-FATAL   TO TRUE                            18750000
187600         MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER                18760000
187700         MOVE DP015-UNP-ALP-BRT-OFF                               18770000
187800                               TO AREQFDDA                        18780000
187900         MOVE DP015-RED        TO AREQFDDC                        18790000
188000         MOVE DP015-REVERSE    TO AREQFDDH                        18800000
188100         MOVE -1               TO AREQFDDL                        18810000
188200         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      18820000
188300     END-IF.                                                      18830000
188400                                                                  18840000
188500     IF  ASC-PKG-FROM-REQ-DTE-YY = SPACE AND                      18850000
188600        (ASC-PKG-FROM-REQ-DTE-DD > SPACE OR                       18860000
188700         ASC-PKG-FROM-REQ-DTE-MM > SPACE)                         18870000
188800         SET PS-ERROR                                             18880000
188900             DP020-MSG-FATAL   TO TRUE                            18890000
189000         MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER                18900000
189100         MOVE DP015-UNP-ALP-BRT-OFF                               18910000
189200                               TO AREQFYYA                        18920000
189300         MOVE DP015-RED        TO AREQFYYC                        18930000
189400         MOVE DP015-REVERSE    TO AREQFYYH                        18940000
189500         MOVE -1               TO AREQFYYL                        18950000
189600         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      18960000
189700     END-IF.                                                      18970000
189800                                                                  18980000
189900     IF  ASC-PKG-TO-REQ-DTE-MM = SPACE AND                        18990000
190000        (ASC-PKG-TO-REQ-DTE-DD > SPACE OR                         19000000
190100         ASC-PKG-TO-REQ-DTE-YY > SPACE)                           19010000
190200         SET PS-ERROR                                             19020000
190300             DP020-MSG-FATAL   TO TRUE                            19030000
190400         MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER                19040000
190500         MOVE DP015-UNP-ALP-BRT-OFF                               19050000
190600                               TO AREQTMMA                        19060000
190700         MOVE DP015-RED        TO AREQTMMC                        19070000
190800         MOVE DP015-REVERSE    TO AREQTMMH                        19080000
190900         MOVE -1               TO AREQTMML                        19090000
191000         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      19100000
191100     END-IF.                                                      19110000
191200                                                                  19120000
191300     IF  ASC-PKG-TO-REQ-DTE-DD = SPACE AND                        19130000
191400        (ASC-PKG-TO-REQ-DTE-MM > SPACE OR                         19140000
191500         ASC-PKG-TO-REQ-DTE-YY > SPACE)                           19150000
191600         SET PS-ERROR                                             19160000
191700             DP020-MSG-FATAL   TO TRUE                            19170000
191800         MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER                19180000
191900         MOVE DP015-UNP-ALP-BRT-OFF                               19190000
192000                               TO AREQTDDA                        19200000
192100         MOVE DP015-RED        TO AREQTDDC                        19210000
192200         MOVE DP015-REVERSE    TO AREQTDDH                        19220000
192300         MOVE -1               TO AREQTDDL                        19230000
192400         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      19240000
192500     END-IF.                                                      19250000
192600                                                                  19260000
192700     IF  ASC-PKG-TO-REQ-DTE-YY = SPACE AND                        19270000
192800        (ASC-PKG-TO-REQ-DTE-DD > SPACE OR                         19280000
192900         ASC-PKG-TO-REQ-DTE-MM > SPACE)                           19290000
193000         SET PS-ERROR                                             19300000
193100             DP020-MSG-FATAL   TO TRUE                            19310000
193200         MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER                19320000
193300         MOVE DP015-UNP-ALP-BRT-OFF                               19330000
193400                               TO AREQTYYA                        19340000
193500         MOVE DP015-RED        TO AREQTYYC                        19350000
193600         MOVE DP015-REVERSE    TO AREQTYYH                        19360000
193700         MOVE -1               TO AREQTYYL                        19370000
193800         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      19380000
193900     END-IF.                                                      19390000
194000                                                                  19400000
194100     IF (ASC-PKG-FROM-REQ-DTE-MM > SPACE AND                      19410000
194200         ASC-PKG-FROM-REQ-DTE-DD > SPACE AND                      19420000
194300         ASC-PKG-FROM-REQ-DTE-YY > SPACE) AND                     19430000
194400        (ASC-PKG-TO-REQ-DTE-YY = SPACE AND                        19440000
194500         ASC-PKG-TO-REQ-DTE-DD = SPACE AND                        19450000
194600         ASC-PKG-TO-REQ-DTE-MM = SPACE)                           19460000
194700         SET PS-ERROR                                             19470000
194800             DP020-MSG-FATAL   TO TRUE                            19480000
194900         MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER                19490000
195000         MOVE DP015-UNP-ALP-BRT-OFF                               19500000
195100                               TO AREQTMMA                        19510000
195200         MOVE DP015-RED        TO AREQTMMC                        19520000
195300         MOVE DP015-REVERSE    TO AREQTMMH                        19530000
195400         MOVE DP015-UNP-ALP-BRT-OFF                               19540000
195500                               TO AREQTDDA                        19550000
195600         MOVE DP015-RED        TO AREQTDDC                        19560000
195700         MOVE DP015-REVERSE    TO AREQTDDH                        19570000
195800         MOVE DP015-UNP-ALP-BRT-OFF                               19580000
195900                               TO AREQTYYA                        19590000
196000         MOVE DP015-RED        TO AREQTYYC                        19600000
196100         MOVE DP015-REVERSE    TO AREQTYYH                        19610000
196200         MOVE -1               TO AREQTMML                        19620000
196300         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      19630000
196400     END-IF.                                                      19640000
196500                                                                  19650000
196600     IF (ASC-PKG-TO-REQ-DTE-MM > SPACE AND                        19660000
196700         ASC-PKG-TO-REQ-DTE-DD > SPACE AND                        19670000
196800         ASC-PKG-TO-REQ-DTE-YY > SPACE) AND                       19680000
196900        (ASC-PKG-FROM-REQ-DTE-YY = SPACE AND                      19690000
197000         ASC-PKG-FROM-REQ-DTE-DD = SPACE AND                      19700000
197100         ASC-PKG-FROM-REQ-DTE-MM = SPACE)                         19710000
197200         SET PS-ERROR                                             19720000
197300             DP020-MSG-FATAL   TO TRUE                            19730000
197400         MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER                19740000
197500         MOVE DP015-UNP-ALP-BRT-OFF                               19750000
197600                               TO AREQFMMA                        19760000
197700         MOVE DP015-RED        TO AREQFMMC                        19770000
197800         MOVE DP015-REVERSE    TO AREQFMMH                        19780000
197900         MOVE DP015-UNP-ALP-BRT-OFF                               19790000
198000                               TO AREQFDDA                        19800000
198100         MOVE DP015-RED        TO AREQFDDC                        19810000
198200         MOVE DP015-REVERSE    TO AREQFDDH                        19820000
198300         MOVE DP015-UNP-ALP-BRT-OFF                               19830000
198400                               TO AREQFYYA                        19840000
198500         MOVE DP015-RED        TO AREQFYYC                        19850000
198600         MOVE DP015-REVERSE    TO AREQFYYH                        19860000
198700         MOVE -1               TO AREQFMML                        19870000
198800         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      19880000
198900     END-IF.                                                      19890000
199000                                                                  19900000
199100     IF  ASC-PKG-FROM-REQ-DTE-MM > SPACE AND                      19910000
199200         ASC-PKG-FROM-REQ-DTE-DD > SPACE AND                      19920000
199300         ASC-PKG-FROM-REQ-DTE-YY > SPACE AND                      19930000
199400         ASC-PKG-TO-REQ-DTE-MM > SPACE AND                        19940000
199500         ASC-PKG-TO-REQ-DTE-DD > SPACE AND                        19950000
199600         ASC-PKG-TO-REQ-DTE-YY > SPACE                            19960000
199700         MOVE ASC-PKG-FROM-REQ-DTE-MM  TO  PV-FROM-MM             19970000
199800         MOVE ASC-PKG-FROM-REQ-DTE-DD  TO  PV-FROM-DD             19980000
199900         MOVE ASC-PKG-FROM-REQ-DTE-YY  TO  PV-FROM-YY             19990000
200000         MOVE ASC-PKG-TO-REQ-DTE-MM    TO  PV-TO-MM               20000000
200100         MOVE ASC-PKG-TO-REQ-DTE-DD    TO  PV-TO-DD               20010000
200200         MOVE ASC-PKG-TO-REQ-DTE-YY    TO  PV-TO-YY               20020000
200300         SET PS-NO-DATE-ERROR TO TRUE                             20030000
200400         PERFORM 3140-VALIDATE-FROM-TO                            20040000
200500         IF PS-DATE-ERROR                                         20050000
200600             MOVE DP015-UNP-ALP-BRT-OFF  TO AREQFMMA              20060000
200700                                            AREQFDDA              20070000
200800                                            AREQFYYA              20080000
200900                                            AREQTMMA              20090000
201000                                            AREQTDDA              20100000
201100                                            AREQTYYA              20110000
201200             MOVE DP015-RED              TO AREQFMMC              20120000
201300                                            AREQFDDC              20130000
201400                                            AREQFYYC              20140000
201500                                            AREQTMMC              20150000
201600                                            AREQTDDC              20160000
201700                                            AREQTYYC              20170000
201800             MOVE DP015-REVERSE          TO AREQFMMH              20180000
201900                                            AREQFDDH              20190000
202000                                            AREQFYYH              20200000
202100                                            AREQTMMH              20210000
202200                                            AREQTDDH              20220000
202300                                            AREQTYYH              20230000
202400             MOVE -1                     TO AREQFMML              20240000
202500         END-IF                                                   20250000
202600     END-IF.                                                      20260000
202700                                                                  20270000
202800     IF  ASC-PACKAGE-OPER-UNIT-ID NOT EQUAL SPACE AND             20280000
202900         ASC-PACKAGE-OPER-UNIT-ID NOT EQUAL 'ALL ' AND            20290000
203000         ASC-PACKAGE-OPER-UNIT-ID NOT EQUAL ' ALL'                20300000
203100         MOVE ASC-PACKAGE-OPER-UNIT-ID TO DP010I-UNEDITED-FIELD   20310000
203200         MOVE LENGTH OF ASC-PACKAGE-OPER-UNIT-ID                  20320000
203300                                   TO DP010I-MAXIMUM-DIGITS       20330000
203400         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     20340000
203500         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  20350000
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         20361008
263968              USING DP010I-NUMERIC-EDIT-AREA                      20362008
203700         IF  DP010I-ERROR-DETECTED                                20370000
203800             SET PS-ERROR                                         20380000
203900                 DP020-MSG-FATAL   TO TRUE                        20390000
204000             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            20400000
204100             MOVE DP015-UNP-ALP-BRT-OFF                           20410000
204200                                   TO AOPRUNTA                    20420000
204300             MOVE DP015-RED        TO AOPRUNTC                    20430000
204400             MOVE DP015-REVERSE    TO AOPRUNTH                    20440000
204500             MOVE -1               TO AOPRUNTL                    20450000
204600             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  20460000
204700         ELSE                                                     20470000
204800             MOVE DP010I-NUMERIC-FIELD                            20480000
204900                                   TO ASC-PACKAGE-OPER-UNIT-ID-N  20490000
205000                                      DK-OPER-UNIT                20500000
205100             MOVE ASC-PACKAGE-OPER-UNIT-ID TO AOPRUNTO            20510000
205200             SET PS-OPER-UNIT-NOT-FOUND TO TRUE                   20520000
205300             PERFORM 3100-VALIDATE-OPER-UNIT                      20530000
205400             IF PS-OPER-UNIT-NOT-FOUND                            20540000
205500                 SET PS-ERROR                                     20550000
205600                     DP020-MSG-FATAL   TO TRUE                    20560000
205700                 MOVE PC-TSYMSG-02572  TO DP020-MSG-NUMBER        20570000
205800                 MOVE DP015-UNP-ALP-BRT-OFF                       20580000
205900                                       TO AOPRUNTA                20590000
206000                 MOVE DP015-RED        TO AOPRUNTC                20600000
206100                 MOVE DP015-REVERSE    TO AOPRUNTH                20610000
206200                 MOVE -1               TO AOPRUNTL                20620000
206300                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              20630000
206400             ELSE                                                 20640000
150900                 MOVE XLT00010-LOC-NM     TO AOPRDSCO             20641000
206600             END-IF                                               20660000
206700         END-IF                                                   20670000
206800     END-IF.                                                      20680000
206900                                                                  20690000
207000     IF  ASC-PROCESS-STATUS > SPACE                               20700000
207100         IF ASC-PROCESS-STATUS = 'P' OR                           20710000
207200            ASC-PROCESS-STATUS = 'F' OR                           20720000
207300            ASC-PROCESS-STATUS = 'I' OR                           20730000
207400            ASC-PROCESS-STATUS = 'N' OR                           20740000
207500            ASC-PROCESS-STATUS = 'A'                              20750000
207600             CONTINUE                                             20760000
207700         ELSE                                                     20770000
207800             SET PS-ERROR                                         20780000
207900                 DP020-MSG-FATAL   TO TRUE                        20790000
208000             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            20800000
208100             MOVE DP015-UNP-ALP-BRT-OFF                           20810000
208200                                   TO APRCSTAA                    20820000
208300             MOVE DP015-RED        TO APRCSTAC                    20830000
208400             MOVE DP015-REVERSE    TO APRCSTAH                    20840000
208500             MOVE -1               TO APRCSTAL                    20850000
208600             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  20860000
208700         END-IF                                                   20870000
208800     END-IF.                                                      20880000
208900                                                                  20890000
209000     IF  ASC-PACKAGING-TYPE > SPACE                               20900000
209100         IF ASC-PACKAGING-TYPE = 'BC' OR                          20910000
209200            ASC-PACKAGING-TYPE = 'PP' OR                          20920000
209300            ASC-PACKAGING-TYPE = 'PS' OR                          20930000
      *SB 10/15/13 - BEGIN PR#5148D                                     20930100
209300            ASC-PACKAGING-TYPE = 'RF' OR                          20931000
      *SB 10/15/13 - END PR#5148D                                       20932000
209400            ASC-PACKAGING-TYPE = 'AL'                             20940000
209500             CONTINUE                                             20950000
209600         ELSE                                                     20960000
209700             SET PS-ERROR                                         20970000
209800                 DP020-MSG-FATAL   TO TRUE                        20980000
209900             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            20990000
210000             MOVE DP015-UNP-ALP-BRT-OFF                           21000000
210100                                   TO APKGTYPA                    21010000
210200             MOVE DP015-RED        TO APKGTYPC                    21020000
210300             MOVE DP015-REVERSE    TO APKGTYPH                    21030000
210400             MOVE -1               TO APKGTYPL                    21040000
210500             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  21050000
210600         END-IF                                                   21060000
210700     END-IF.                                                      21070000
210800                                                                  21080000
210900     MOVE ALL 'N'                     TO PV-ENTRY-FLAGS           21090000
211000                                                                  21100000
211100                                                                  21110000
211200     IF ASC-PACKAGE-OPER-UNIT-ID NOT EQUAL SPACES                 21120000
211300         MOVE 'Y'                     TO PV-GROUP1-FLAG           21130000
211400     END-IF                                                       21140000
211500                                                                  21150000
211600     IF  ASC-PO > SPACE                                           21160000
211700         MOVE 'Y'                     TO PV-GROUP2-FLAG           21170000
211800     END-IF                                                       21180000
211900                                                                  21190000
212000     IF ASC-VENDOR-DESC > SPACES OR ASC-ENT-ID > SPACES           21200000
212100         MOVE 'Y'                     TO PV-GROUP3-FLAG           21210000
212200     END-IF                                                       21220000
212300                                                                  21230000
212400     IF  ASC-AUDIT-NUMBER > SPACE                                 21240000
212500         MOVE 'Y'                     TO PV-GROUP4-FLAG           21250000
212600     END-IF                                                       21260000
212700                                                                  21270000
212800     IF NOT PV-VALID-COMBOS                                       21280000
212900         PERFORM VARYING PV-CHECK-SUB FROM 1 BY 1                 21290000
213000             UNTIL PV-CHECK-SUB > 4                               21300000
213100             IF PV-CHECK-TBL-FLAG (PV-CHECK-SUB) = 'Y'            21310000
213200                 EVALUATE PV-CHECK-SUB                            21320000
213300                 WHEN 1                                           21330000
213400                     MOVE DP015-UNP-ALP-BRT-OFF                   21340000
213500                                TO AOPRUNTA                       21350000
213600                     MOVE DP015-RED        TO AOPRUNTC            21360000
213700                     MOVE DP015-REVERSE    TO AOPRUNTH            21370000
213800                     MOVE -1               TO AOPRUNTL            21380000
213900                 WHEN 2                                           21390000
214000                     MOVE DP015-UNP-ALP-BRT-OFF                   21400000
214100                                           TO APOA                21410000
214200                     MOVE DP015-RED        TO APOC                21420000
214300                     MOVE DP015-REVERSE    TO APOH                21430000
214400                     MOVE -1               TO APOL                21440000
214500                 WHEN 3                                           21450000
214600                     MOVE DP015-UNP-ALP-BRT-OFF                   21460000
214700                                           TO AVNDNAMA            21470000
214800                                              AVNDIDA             21480000
214900                     MOVE DP015-RED        TO AVNDNAMC            21490000
215000                                              AVNDIDC             21500000
215100                     MOVE DP015-REVERSE    TO AVNDNAMH            21510000
215200                                              AVNDIDH             21520000
215300                     MOVE -1               TO AVNDNAML            21530000
215400                                              AVNDIDL             21540000
215500                 WHEN 4                                           21550000
215600                     MOVE DP015-UNP-ALP-BRT-OFF                   21560000
215700                                           TO AAUDNBRA            21570000
215800                     MOVE DP015-RED        TO AAUDNBRC            21580000
215900                     MOVE DP015-REVERSE    TO AAUDNBRH            21590000
216000                     MOVE -1               TO AAUDNBRL            21600000
216100                 END-EVALUATE                                     21610000
216200             END-IF                                               21620000
216300         END-PERFORM                                              21630000
216400                                                                  21640000
216500          SET PS-ERROR                                            21650000
216600              DP020-MSG-FATAL   TO TRUE                           21660000
216700          MOVE PC-TSYMSG-01202  TO DP020-MSG-NUMBER               21670000
216800          SET DP030-SET-CURSOR-APPL-1 TO TRUE                     21680000
216900     END-IF.                                                      21690000
217000*                                                                 21700000
217100*                                                                 21710000
217200     IF  PS-NO-ERROR                                              21720000
217300         MOVE -1                   TO APKGTYPL                    21730000
217400         SET DP030-SET-CURSOR-APPL-1                              21740000
217500                                   TO TRUE                        21750000
217600     END-IF.                                                      21760000
217700                                                                  21770000
217800*----------------------------------------------------------------*21780000
217900* CHECK IF OPER UNIT IS VALID                                    *21790000
218000*----------------------------------------------------------------*21800000
218100 3100-VALIDATE-OPER-UNIT.                                         21810000
218200                                                                  21820000
218300     EXEC SQL                                                     21830000
218400        SELECT                                                    21840000
218500             LOC_NM                                               21850000
218600          INTO                                                    21860000
218700             :XLT00010-LOC-NM                                     21870000
218800          FROM  XLT_LOC                                           21880000
218900        WHERE  LOC_TYP_CDE    = 'DC'                              21890000
219000          AND  LOC_NBR        = :DK-OPER-UNIT                     21900000
219100***       AND  E_BUS_IND      = 'N'                               21910000
219200          AND  OPN_DTE        < CURRENT DATE + 1 DAY              21920000
219200          AND  CLO_DTE        = :PC-MAX-DATE                      21921000
219700     END-EXEC.                                                    21970000
219800                                                                  21980000
219900     EVALUATE TRUE                                                21990000
220000         WHEN SQLCODE = ZERO                                      22000000
220100             SET PS-OPER-UNIT-FOUND TO TRUE                       22010000
220200         WHEN SQLCODE = +100                                      22020000
220300             SET PS-OPER-UNIT-NOT-FOUND TO TRUE                   22030000
220400                                                                  22040000
220500         WHEN SQLWARN0 NOT = SPACES                               22050000
220600         WHEN SQLCODE < +0                                        22060000
220700         WHEN SQLCODE > ZERO                                      22070000
220800             MOVE '3100-VALIDATE-OPER-UNIT'                       22080000
220900                             TO DP013-PARAGRAPH                   22090000
221000             MOVE 'SELECT OPER UNIT'                              22100000
221100                             TO DP013-MESSAGE-TEXT (1)            22110000
221200             MOVE SQLCA      TO DP013-SQLCA                       22120000
221300             MOVE 'XLT_LOC'  TO DP013-DB2-TABLE-NAME (1)          22130000
221400             SET DP013-DB2-ABEND   TO TRUE                        22140000
221600             SET DP013-XCTL-DISPLAY-RESTART TO TRUE               22160000
221800             PERFORM DP013-0000-PROCESS-ABEND                     22180000
221900     END-EVALUATE.                                                22190000
222000*----------------------------------------------------------------*22200000
222100* CHECK IF ENT ID IS VALID                                       *22210000
222200*----------------------------------------------------------------*22220000
222300 3110-VALIDATE-ENT-ID.                                            22230000
222400                                                                  22240000
222500     EXEC SQL                                                     22250000
222600          SELECT ENT_NAME_DESC                                    22260000
222700            INTO :ENTNME-ENT-NAME-DESC                            22270000
222800            FROM TEXTENT A                                        22280000
222900                ,TENTNME B                                        22290000
223000           WHERE A.ENT_ID      = :DK-ENT-ID                       22300000
223100             AND A.ENT_ID = B.ENT_ID                              22310000
223200             AND A.STATUS_CDE  = 'A'                              22320000
223300             AND B.TYPE_CDE    = '01'                             22330000
P40473           WITH UR                                                22331007
223400     END-EXEC.                                                    22340000
223500                                                                  22350000
223600     EVALUATE TRUE                                                22360000
223700         WHEN SQLCODE = +0                                        22370000
223800         WHEN SQLCODE = -811                                      22380000
223900             SET PS-ENT-ID-FOUND TO TRUE                          22390000
224000             MOVE ENTNME-ENT-NAME-DESC                            22400000
224100                               TO ASC-VENDOR-DESC                 22410000
224200                                  AVNDNAMO                        22420000
224300         WHEN SQLCODE = +100                                      22430000
224400             SET PS-NO-ENT-ID-FOUND TO TRUE                       22440000
224500             MOVE ALL '?'      TO ASC-VENDOR-DESC                 22450000
224600                                  AVNDNAMO                        22460000
224700         WHEN SQLWARN0 NOT = SPACES                               22470000
224800         WHEN SQLCODE < +0                                        22480000
224900         WHEN SQLCODE > +0                                        22490000
225000             MOVE '3110-VALIDATE-ENT-ID'                          22500000
225100                             TO DP013-PARAGRAPH                   22510000
225200             MOVE 'SELECT SCAC CODE'                              22520000
225300                             TO DP013-MESSAGE-TEXT (1)            22530000
225400             MOVE SQLCA      TO DP013-SQLCA                       22540000
225500             MOVE 'TEXTENT'  TO DP013-DB2-TABLE-NAME (1)          22550000
225600             SET DP013-DB2-ABEND                                  22560000
225700                             TO TRUE                              22570000
225800             SET DP013-XCTL-DISPLAY-RESTART                       22580000
225900                             TO TRUE                              22590000
226000             PERFORM DP013-0000-PROCESS-ABEND                     22600000
226100     END-EVALUATE.                                                22610000
226200                                                                  22620000
226300 3120-VALIDATE-DEPT.                                              22630000
226400                                                                  22640000
226500     EXEC SQL                                                     22650000
226600         SELECT A.ENT_ID                                          22660000
226700             ,  B.MDSEAR_DESC                                     22670000
226800          INTO  :VNDDPT-ENT-ID                                    22680000
226900             ,  :MDSEAR-DESC                                      22690000
227000          FROM  TVNDDPT A                                         22700000
227100             ,  TMDSEAR B                                         22710000
227200          WHERE A.ENT_ID         = :DK-ENT-ID                     22720000
227300           AND  A.DEPT_NBR       = :DK-DEPT                       22730000
227400            AND A.DEPT_NBR       = B.DEPT_NBR                     22740000
227500            AND B.MDSELV_CDE     = 'DPT'                          22750000
227600            AND B.OPERCO_NBR     = '03'                           22760000
227700            AND (B.STRT_DTE     <= CURRENT DATE AND               22770000
227800                 B.END_DTE       > CURRENT DATE)                  22780000
227900     END-EXEC.                                                    22790000
228000                                                                  22800000
228100     EVALUATE TRUE                                                22810000
228200         WHEN SQLCODE = +0                                        22820000
228300             SET PS-DEPT-FOUND TO TRUE                            22830000
228400                                                                  22840000
228500         WHEN SQLCODE = +100                                      22850000
228600             SET PS-NO-DEPT-FOUND TO TRUE                         22860000
228700                                                                  22870000
228800         WHEN SQLWARN0 NOT = SPACE                                22880000
228900         WHEN SQLCODE < +0                                        22890000
229000         WHEN SQLCODE > +0                                        22900000
229100             MOVE '3120-VALIDATE-DEPT'                            22910000
229200                             TO DP013-PARAGRAPH                   22920000
229300             MOVE 'VALIDATE THE DEPT NUMBER'                      22930000
229400                             TO DP013-MESSAGE-TEXT (1)            22940000
229500             MOVE SQLCA      TO DP013-SQLCA                       22950000
229600             MOVE 'TVNDDPT'  TO DP013-DB2-TABLE-NAME (1)          22960000
229700             MOVE 'TMDSEAR'  TO DP013-DB2-TABLE-NAME (1)          22970000
229800             SET DP013-DB2-ABEND                                  22980000
229900                             TO TRUE                              22990000
230000             SET DP013-XCTL-DISPLAY-RESTART                       23000000
230100                             TO TRUE                              23010000
230200             PERFORM DP013-0000-PROCESS-ABEND                     23020000
230300     END-EVALUATE.                                                23030000
230400                                                                  23040000
230500 3130-VALIDATE-PO.                                                23050000
230600                                                                  23060000
230700     EXEC SQL                                                     23070000
230800        SELECT PO_NBR                                             23080000
230900            ,  VER_NBR                                            23090000
231000            ,  VER_STATUS_CDE                                     23100000
231100            ,  PO_TYP_CDE                                         23110000
231200            ,  PKGNG_CDE                                          23120000
231300         INTO :PURCHS-PO-NBR                                      23130000
231400            , :PURCHS-VER-NBR                                     23140000
231500            , :PURCHS-VER-STATUS-CDE                              23150000
231600            , :PURCHS-PO-TYP-CDE                                  23160000
231700            , :PURCHS-PKGNG-CDE                                   23170000
231800         FROM TPURCHS                                             23180000
231900        WHERE PO_NBR           = :DK-PO-NBR                       23190000
232000          AND VER_STATUS_CDE   = 'A'                              23200000
232100     END-EXEC.                                                    23210000
232200                                                                  23220000
232300     EVALUATE TRUE                                                23230000
232400         WHEN SQLCODE = +0                                        23240000
232500             SET PS-PO-FOUND TO TRUE                              23250000
232600                                                                  23260000
232700         WHEN SQLCODE = +100                                      23270000
232800             SET PS-NO-PO-FOUND TO TRUE                           23280000
232900                                                                  23290000
233000         WHEN SQLWARN0 NOT = SPACE                                23300000
233100         WHEN SQLCODE < +0                                        23310000
233200         WHEN SQLCODE > +0                                        23320000
233300             MOVE '3130-VALIDATE-PO'                              23330000
233400                             TO DP013-PARAGRAPH                   23340000
233500             MOVE 'VALIDATE THE PO NUMBER'                        23350000
233600                             TO DP013-MESSAGE-TEXT (1)            23360000
233700             MOVE SQLCA      TO DP013-SQLCA                       23370000
233800             MOVE 'TPURCHS'  TO DP013-DB2-TABLE-NAME (1)          23380000
233900             SET DP013-DB2-ABEND                                  23390000
234000                             TO TRUE                              23400000
234100             SET DP013-XCTL-DISPLAY-RESTART                       23410000
234200                             TO TRUE                              23420000
234300             PERFORM DP013-0000-PROCESS-ABEND                     23430000
234400     END-EVALUATE.                                                23440000
234500                                                                  23450000
234600*-----------------------------------------------------------------23460000
234700*  VALIDATE CREATE FROM AND TO DATES                              23470000
234800*-----------------------------------------------------------------23480000
234900 3140-VALIDATE-FROM-TO.                                           23490000
235000                                                                  23500000
235100     IF  PV-TO-DATE-HOLD  >=  PV-FROM-DATE-HOLD                   23510000
235200         CONTINUE                                                 23520000
235300     ELSE                                                         23530000
235400         IF PS-NUM-ERROR                                          23540000
235500             CONTINUE                                             23550000
235600         ELSE                                                     23560000
235700             SET PS-ERROR                                         23570000
235800                 PS-DATE-ERROR                                    23580000
235900                 DP020-MSG-FATAL         TO TRUE                  23590000
236000             MOVE PC-TSYMSG-02221        TO DP020-MSG-NUMBER      23600000
236100             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  23610000
236200         END-IF                                                   23620000
236300     END-IF.                                                      23630000
236400                                                                  23640000
236500     IF  PS-NO-ERROR                                              23650000
236600         INITIALIZE DPG51 DPG52 DPG53                             23660000
236700                    DPG54 DPG55 DPG56                             23670000
236800         SET  DPG51-ACTUAL-CALENDAR-ONLY                          23680000
236900              DPG51-DO-NOT-INCR-DECR-DATE                         23690000
237000                                    TO TRUE                       23700000
237100*            'CCYYMMDD'                                           23710000
237200         SET  DPG52-LK-DTE-ISO                                    23720000
237300                                    TO TRUE                       23730000
237400         MOVE PV-FROM-DATE-HOLD     TO DPG52-LK-DATE-INPUT        23740000
237500         CALL PC-CALENDAR-MODULE USING DPG51 DPG52 DPG53          23750000
237600                                       DPG54 DPG55 DPG56          23760000
237700         IF (DPG54-DATE-INVALID  OR                               23770000
237800             DPG54-SEVERE-ERROR)                                  23780000
237900             SET PS-ERROR                                         23790000
238000                 PS-DATE-ERROR                                    23800000
238100                 DP020-MSG-FATAL       TO TRUE                    23810000
238200             MOVE PC-TSYMSG-00009      TO DP020-MSG-NUMBER        23820000
238300             SET DP030-SET-CURSOR-APPL-1                          23830000
238400                                       TO TRUE                    23840000
238500         END-IF                                                   23850000
238600                                                                  23860000
238700         INITIALIZE DPG51 DPG52 DPG53                             23870000
238800                    DPG54 DPG55 DPG56                             23880000
238900         SET  DPG51-ACTUAL-CALENDAR-ONLY                          23890000
239000              DPG51-DO-NOT-INCR-DECR-DATE                         23900000
239100                                    TO TRUE                       23910000
239200*            'CCYYMMDD'                                           23920000
239300             SET  DPG52-LK-DTE-ISO                                23930000
239400                                    TO TRUE                       23940000
239500         MOVE PV-TO-DATE-HOLD       TO DPG52-LK-DATE-INPUT        23950000
239600         CALL PC-CALENDAR-MODULE USING DPG51 DPG52 DPG53          23960000
239700                                       DPG54 DPG55 DPG56          23970000
239800         IF (DPG54-DATE-INVALID                                   23980000
239900         OR  DPG54-SEVERE-ERROR)                                  23990000
240000             SET PS-ERROR                                         24000000
240100                 PS-DATE-ERROR                                    24010000
240200                 DP020-MSG-FATAL       TO TRUE                    24020000
240300             MOVE PC-TSYMSG-00009      TO DP020-MSG-NUMBER        24030000
240400             SET DP030-SET-CURSOR-APPL-1                          24040000
240500                                       TO TRUE                    24050000
240600         END-IF                                                   24060000
240700     END-IF.                                                      24070000
240800                                                                  24080000
240900                                                                  24090000
241000******************************************************************24100000
241100** MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS ON THE **24110000
241200** MAP.                                                         **24120000
241300******************************************************************24130000
241400 3200-RESET-ATTRIBUTES.                                           24140000
241500     MOVE DP015-UNP-ALP-NOR-MDT    TO APKGTYPA                    24150000
241600                                      APRCSTAA                    24160000
241700     MOVE DP015-UNP-ALP-NOR-OFF    TO AOPRUNTA                    24170000
241800                                      AREQFMMA                    24180000
241900                                      AREQFDDA                    24190000
242000                                      AREQFYYA                    24200000
242100                                      AREQTMMA                    24210000
242200                                      AREQTDDA                    24220000
242300                                      AREQTYYA                    24230000
242400                                      APOA                        24240000
242500                                      ARECSEQA                    24250000
242600                                      APOOPERA                    24260000
242700                                      AVNDNAMA                    24270000
242800                                      AVNDIDA                     24280000
242900                                      ADEPTA                      24290000
243000                                      AVNOPERA                    24300000
243100                                      AVRQFMMA                    24310000
243200                                      AVRQFDDA                    24320000
243300                                      AVRQFYYA                    24330000
243400                                      AVRQTMMA                    24340000
243500                                      AVRQTDDA                    24350000
243600                                      AVRQTYYA                    24360000
243700                                      AAUDNBRA.                   24370000
243800     MOVE DP015-GREEN              TO APKGTYPC                    24380000
243900                                      APRCSTAC                    24390000
244000                                      AOPRUNTC                    24400000
244100                                      AREQFMMC                    24410000
244200                                      AREQFDDC                    24420000
244300                                      AREQFYYC                    24430000
244400                                      AREQTMMC                    24440000
244500                                      AREQTDDC                    24450000
244600                                      AREQTYYC                    24460000
244700                                      APOC                        24470000
244800                                      ARECSEQC                    24480000
244900                                      APOOPERC                    24490000
245000                                      AVNDNAMC                    24500000
245100                                      AVNDIDC                     24510000
245200                                      ADEPTC                      24520000
245300                                      AVNOPERC                    24530000
245400                                      AVRQFMMC                    24540000
245500                                      AVRQFDDC                    24550000
245600                                      AVRQFYYC                    24560000
245700                                      AVRQTMMC                    24570000
245800                                      AVRQTDDC                    24580000
245900                                      AVRQTYYC                    24590000
246000                                      AAUDNBRC.                   24600000
246100     MOVE DP015-UNDERLINE          TO APKGTYPH                    24610000
246200                                      APRCSTAH                    24620000
246300                                      AOPRUNTH                    24630000
246400                                      AREQFMMH                    24640000
246500                                      AREQFDDH                    24650000
246600                                      AREQFYYH                    24660000
246700                                      AREQTMMH                    24670000
246800                                      AREQTDDH                    24680000
246900                                      AREQTYYH                    24690000
247000                                      APOH                        24700000
247100                                      ARECSEQH                    24710000
247200                                      APOOPERH                    24720000
247300                                      AVNDNAMH                    24730000
247400                                      AVNDIDH                     24740000
247500                                      ADEPTH                      24750000
247600                                      AVNOPERH                    24760000
247700                                      AVRQFMMH                    24770000
247800                                      AVRQFDDH                    24780000
247900                                      AVRQFYYH                    24790000
248000                                      AVRQTMMH                    24800000
248100                                      AVRQTDDH                    24810000
248200                                      AVRQTYYH                    24820000
248300                                      AAUDNBRH.                   24830000
248400*                                                                 24840000
248500*----------------------------------------------------------------*24850000
248600*  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *24860000
248700*  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *24870000
248800*  IT HERE.                                                      *24880000
248900*----------------------------------------------------------------*24890000
249000 4000-BUILD-INITIAL-PANEL.                                        24900000
249100     SET DP030-SET-CURSOR-APPL-1   TO TRUE                        24910000
249200     MOVE -1                       TO APKGTYPL.                   24920000
249300     MOVE SPACES                   TO ASC-PACKAGING-TYPE          24930000
249400                                      ASC-PROCESS-STATUS          24940000
249500                                      ASC-PACKAGE-OPER-UNIT-ID    24950000
249600                                      ASC-PKG-FROM-REQ-DTE-MM     24960000
249700                                      ASC-PKG-FROM-REQ-DTE-DD     24970000
249800                                      ASC-PKG-FROM-REQ-DTE-YY     24980000
249900                                      ASC-PKG-TO-REQ-DTE-MM       24990000
250000                                      ASC-PKG-TO-REQ-DTE-DD       25000000
250100                                      ASC-PKG-TO-REQ-DTE-YY       25010000
250200                                      ASC-PO                      25020000
250300                                      ASC-RECVR-SEQ-NBR           25030000
250400                                      ASC-PO-OPER-UNIT-ID         25040000
250500                                      ASC-VENDOR-DESC             25050000
250600                                      ASC-ENT-ID                  25060000
250700                                      ASC-DEPT-NBR                25070000
250800                                      ASC-VENDOR-OPER-UNIT-ID     25080000
250900                                      ASC-VEN-FROM-REQ-DTE-MM     25090000
251000                                      ASC-VEN-FROM-REQ-DTE-DD     25100000
251100                                      ASC-VEN-FROM-REQ-DTE-YY     25110000
251200                                      ASC-VEN-TO-REQ-DTE-MM       25120000
251300                                      ASC-VEN-TO-REQ-DTE-DD       25130000
251400                                      ASC-VEN-TO-REQ-DTE-YY       25140000
251500                                      ASC-AUDIT-NUMBER.           25150000
251600                                                                  25160000
251700     MOVE PC-DFLT-PKG-TYPE         TO APKGTYPO                    25170000
251800                                      ASC-PACKAGING-TYPE.         25180000
251900     MOVE PC-DFLT-PROC-STAT        TO APRCSTAO                    25190000
252000                                      ASC-PROCESS-STATUS.         25200000
252100*                                                                 25210000
252200*----------------------------------------------------------------*25220000
252300*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *25230000
252400*----------------------------------------------------------------*25240000
252500 4400-MOVE-COMMAREA-TO-SCREEN.                                    25250000
252600     EVALUATE TRUE                                                25260000
252700         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     25270000
252800                                                                  25280000
252900            INITIALIZE ASC-PACKAGING-TYPE                         25290000
253000            MOVE ASC-PACKAGING-TYPE       TO APKGTYPO             25300000
253100                                                                  25310000
253200            INITIALIZE ASC-PROCESS-STATUS                         25320000
253300            MOVE ASC-PROCESS-STATUS       TO APRCSTAO             25330000
253400                                                                  25340000
253500            INITIALIZE ASC-PACKAGE-OPER-UNIT-ID                   25350000
253600            MOVE ASC-PACKAGE-OPER-UNIT-ID TO AOPRUNTO             25360000
253700                                                                  25370000
253800            INITIALIZE ASC-PKG-FROM-REQ-DTE-MM                    25380000
253900            MOVE ASC-PKG-FROM-REQ-DTE-MM  TO AREQFMMO             25390000
254000                                                                  25400000
254100            INITIALIZE ASC-PKG-FROM-REQ-DTE-DD                    25410000
254200            MOVE ASC-PKG-FROM-REQ-DTE-DD  TO AREQFDDO             25420000
254300                                                                  25430000
254400            INITIALIZE ASC-PKG-FROM-REQ-DTE-YY                    25440000
254500            MOVE ASC-PKG-FROM-REQ-DTE-YY  TO AREQFYYO             25450000
254600                                                                  25460000
254700            INITIALIZE  ASC-PKG-TO-REQ-DTE-MM                     25470000
254800            MOVE  ASC-PKG-TO-REQ-DTE-MM   TO AREQTMMO             25480000
254900                                                                  25490000
255000            INITIALIZE  ASC-PKG-TO-REQ-DTE-DD                     25500000
255100            MOVE  ASC-PKG-TO-REQ-DTE-DD   TO AREQTDDO             25510000
255200                                                                  25520000
255300            INITIALIZE  ASC-PKG-TO-REQ-DTE-YY                     25530000
255400            MOVE  ASC-PKG-TO-REQ-DTE-YY   TO AREQTYYO             25540000
255500                                                                  25550000
255600            INITIALIZE  ASC-PO                                    25560000
255700            MOVE  ASC-PO                  TO APOO                 25570000
255800                                                                  25580000
255900            INITIALIZE  ASC-RECVR-SEQ-NBR                         25590000
256000            MOVE  ASC-RECVR-SEQ-NBR       TO ARECSEQO             25600000
256100                                                                  25610000
256200            INITIALIZE  ASC-PO-OPER-UNIT-ID                       25620000
256300            MOVE  ASC-PO-OPER-UNIT-ID     TO APOOPERO             25630000
256400                                                                  25640000
256500            INITIALIZE  ASC-VENDOR-DESC                           25650000
256600            MOVE  ASC-VENDOR-DESC         TO AVNDNAMO             25660000
256700                                                                  25670000
256800            INITIALIZE  ASC-ENT-ID-N                              25680000
256900            MOVE  ASC-ENT-ID-N            TO AVNDIDO              25690000
257000                                                                  25700000
257100            INITIALIZE  ASC-DEPT-NBR                              25710000
257200            MOVE  ASC-DEPT-NBR            TO ADEPTO               25720000
257300                                                                  25730000
257400            INITIALIZE  ASC-VENDOR-OPER-UNIT-ID                   25740000
257500            MOVE  ASC-VENDOR-OPER-UNIT-ID TO AVNOPERO             25750000
257600                                                                  25760000
257700            INITIALIZE  ASC-VEN-FROM-REQ-DTE-MM                   25770000
257800            MOVE  ASC-VEN-FROM-REQ-DTE-MM TO AVRQFMMO             25780000
257900                                                                  25790000
258000            INITIALIZE  ASC-VEN-FROM-REQ-DTE-DD                   25800000
258100            MOVE  ASC-VEN-FROM-REQ-DTE-DD TO AVRQFDDO             25810000
258200                                                                  25820000
258300            INITIALIZE  ASC-VEN-FROM-REQ-DTE-YY                   25830000
258400            MOVE  ASC-VEN-FROM-REQ-DTE-YY TO AVRQFYYO             25840000
258500                                                                  25850000
258600            INITIALIZE  ASC-VEN-TO-REQ-DTE-MM                     25860000
258700            MOVE  ASC-VEN-TO-REQ-DTE-MM   TO AVRQTMMO             25870000
258800                                                                  25880000
258900            INITIALIZE  ASC-VEN-TO-REQ-DTE-DD                     25890000
259000            MOVE  ASC-VEN-TO-REQ-DTE-DD   TO AVRQTDDO             25900000
259100                                                                  25910000
259200            INITIALIZE  ASC-VEN-TO-REQ-DTE-YY                     25920000
259300            MOVE  ASC-VEN-TO-REQ-DTE-YY   TO AVRQTYYO             25930000
259400                                                                  25940000
259500            INITIALIZE  ASC-AUDIT-NUMBER                          25950000
259600            MOVE  ASC-AUDIT-NUMBER        TO AAUDNBRO             25960000
259700     END-EVALUATE.                                                25970000
259800                                                                  25980000
259900                                                                  25990000
260000 5000-PREPARE-SEL-QUEUE.                                          26000000
260100                                                                  26010000
260200     MOVE ASC-SEL-QUEUE-NAME  TO  SU017-SEL-QUEUE-NAME.           26020000
260300                                                                  26030000
260400     PERFORM 6010-DELETE-SEL-QUEUE.                               26040000
260500                                                                  26050000
260600     PERFORM 5205-WRITE-SEL-QUEUE.                                26060000
260700                                                                  26070000
260800                                                                  26080000
260900 5205-WRITE-SEL-QUEUE.                                            26090000
261000                                                                  26100000
261100     EXEC CICS                                                    26110000
261200          WRITEQ TS                                               26120000
261300              QUEUE (ASC-SEL-QUEUE-NAME)                          26130000
261400              FROM  (SU017-INTER-APPL-COMMAREA)                   26140000
261500              ITEM  (PV-SEL-QUEUE-ITEM)                           26150000
261600              RESP  (PV-CICS-RESP)                                26160000
261700     END-EXEC.                                                    26170000
261800                                                                  26180000
261900     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          26190000
262000         CONTINUE                                                 26200000
262100     ELSE                                                         26210000
262200         SET DP013-CICS-ABEND      TO TRUE                        26220000
262300         SET DP013-NO-ROLLBACK     TO TRUE                        26230000
262400         MOVE '5205-WRITE-SEL-QUEUE'                              26240000
262500                                   TO DP013-PARAGRAPH             26250000
262600         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          26260000
262700                                   TO DP013-MESSAGE-TEXT(1)       26270000
262800         PERFORM DP013-0000-PROCESS-ABEND                         26280000
262900     END-IF.                                                      26290000
263000                                                                  26300000
263100                                                                  26310000
263200******************************************************************26320000
263300** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **26330000
263400** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **26340000
263500** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **26350000
263600** THE USER.                                                    **26360000
263700******************************************************************26370000
263800 6000-REFRESH-PANEL-FROM-TEMP.                                    26380000
263900     IF  ASC-UPDATE-TSQ                                           26390000
264000         SET ASC-NO-TSQ-UPDATE TO TRUE                            26400000
264100         MOVE ZERO                 TO PV-SAVE-ITEM                26410000
264200                                      PV-SEL-QUEUE-ITEM           26420000
264300         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        26430000
264400                                   TO PV-HOLD-SELECTED-ITEMS      26440000
264500         MOVE +1                   TO PV-ITEMS-PROCESSED          26450000
264600         PERFORM 6100-UPDATE-TSQ                                  26460000
264700             UNTIL PV-ITEMS-PROCESSED >                           26470000
264800                                     PV-HOLD-SELECTED-ITEMS       26480000
264900         PERFORM 6010-DELETE-SEL-QUEUE                            26490000
265000         INITIALIZE ASC-BLOCK-ENTRIES (1)                         26500000
265100                    ASC-BLOCK-ENTRIES (2)                         26510000
265200     END-IF.                                                      26520000
265300                                                                  26530000
265400                                                                  26540000
265500*----------------------------------------------------------------*26550000
265600*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *26560000
265700*----------------------------------------------------------------*26570000
265800 6010-DELETE-SEL-QUEUE.                                           26580000
265900                                                                  26590000
266000     EXEC CICS                                                    26600000
266100         DELETEQ TS                                               26610000
266200             QUEUE (ASC-SEL-QUEUE-NAME)                           26620000
266300             RESP  (PV-CICS-RESP)                                 26630000
266400     END-EXEC.                                                    26640000
266500*                                                                 26650000
266600     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      26660000
266700        (PV-CICS-RESP = DFHRESP(QIDERR)))                         26670000
266800         CONTINUE                                                 26680000
266900     ELSE                                                         26690000
267000         SET DP013-CICS-ABEND TO TRUE                             26700000
267100         SET DP013-NO-ROLLBACK TO TRUE                            26710000
267200         MOVE '6010-DELETE-SEL-QUEUE'                             26720000
267300                        TO DP013-PARAGRAPH                        26730000
267400         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         26740000
267500                        TO DP013-MESSAGE-TEXT (1)                 26750000
267600         PERFORM DP013-0000-PROCESS-ABEND                         26760000
267700     END-IF.                                                      26770000
267800                                                                  26780000
267900*----------------------------------------------------------------*26790000
268000*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *26800000
268100*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *26810000
268200*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *26820000
268300*    THE TEMP QUEUE.                                             *26830000
268400*----------------------------------------------------------------*26840000
268500                                                                  26850000
268600 6100-UPDATE-TSQ.                                                 26860000
268700                                                                  26870000
268800     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             26880000
268900     PERFORM 6105-READ-SEL-QUEUE.                                 26890000
269000                                                                  26900000
269100                                                                  26910000
269200*----------------------------------------------------------------*26920000
269300*    READ THE LIST QUEUE RECORD.                                 *26930000
269400*----------------------------------------------------------------*26940000
269500                                                                  26950000
269600 6105-READ-SEL-QUEUE.                                             26960000
269700                                                                  26970000
269800     EXEC CICS                                                    26980000
269900          READQ TS                                                26990000
270000              QUEUE (ASC-SEL-QUEUE-NAME)                          27000000
270100              INTO  (SU019-SELECT-RECORD)                         27010000
270200              ITEM  (PV-SEL-QUEUE-ITEM)                           27020000
270300              RESP  (PV-CICS-RESP)                                27030000
270400     END-EXEC.                                                    27040000
270500*                                                                 27050000
270600     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          27060000
270700         CONTINUE                                                 27070000
270800     ELSE                                                         27080000
270900         SET DP013-CICS-ABEND      TO  TRUE                       27090000
271000         SET DP013-NO-ROLLBACK     TO  TRUE                       27100000
271100         MOVE '6105-READ-SEL-QUEUE'                               27110000
271200                                   TO  DP013-PARAGRAPH            27120000
271300         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           27130000
271400                                   TO  DP013-MESSAGE-TEXT(1)      27140000
271500         PERFORM DP013-0000-PROCESS-ABEND                         27150000
271600     END-IF.                                                      27160000
271700/                                                                 27170000
271800 7000-SELECT-TSUNAUD.                                             27180000
271900                                                                  27190000
272000     EXEC SQL                                                     27200000
272100        SELECT AUD_CNTL_NBR                                       27210000
272200         INTO :SUNAUD-AUD-CNTL-NBR                                27220000
272300         FROM TSUNAUD                                             27230000
272400        WHERE AUD_CNTL_NBR     = :SUNAUD-AUD-CNTL-NBR             27240000
272500     END-EXEC.                                                    27250000
272600                                                                  27260000
272700     EVALUATE TRUE                                                27270000
272800         WHEN SQLCODE = +0                                        27280000
272900         WHEN SQLCODE = +100                                      27290000
273000             CONTINUE                                             27300000
273100                                                                  27310000
273200         WHEN SQLWARN0 NOT = SPACE                                27320000
273300         WHEN SQLCODE < +0                                        27330000
273400         WHEN SQLCODE > +0                                        27340000
273500             MOVE '7000-SELECT-TSUNAUD'                           27350000
273600                             TO DP013-PARAGRAPH                   27360000
273700             MOVE 'VALIDATE THE AUDIT NUMBER'                     27370000
273800                             TO DP013-MESSAGE-TEXT (1)            27380000
273900             MOVE SQLCA      TO DP013-SQLCA                       27390000
274000             MOVE 'TSUNAUD'  TO DP013-DB2-TABLE-NAME (1)          27400000
274100             SET DP013-DB2-ABEND                                  27410000
274200                             TO TRUE                              27420000
274300             SET DP013-XCTL-DISPLAY-RESTART                       27430000
274400                             TO TRUE                              27440000
274500             PERFORM DP013-0000-PROCESS-ABEND                     27450000
274600     END-EVALUATE.                                                27460000
274700                                                                  27470000
274800                                                                  27480000
274900*----------------------------------------------------------------*27490000
275000*    ABEND PROCESSOR MODULE                                      *27500000
275100*----------------------------------------------------------------*27510000
275200                                                                  27520000
275300     COPY DPPD013.                                                27530000
