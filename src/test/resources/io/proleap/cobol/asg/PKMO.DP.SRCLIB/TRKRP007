000100 IDENTIFICATION DIVISION.                                         00010012
000200                                                                  00020012
000300 PROGRAM-ID.             TRKRP007.                                00030012
000400 AUTHOR.                 TAMARA KOLTUN.                           00040012
000500 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00050012
000600 DATE-WRITTEN            08/23/96.                                00060012
000700 DATE-COMPILED.                                                   00070012
000800                                                                  00080012
000900***************************************************               00090012
001000*  THIS PROGRAM CREATES A TRAILER STATUS REPORT.  *               00100012
001100***************************************************               00110012
001200                                                                  00120012
001300 ENVIRONMENT DIVISION.                                            00130012
001400 INPUT-OUTPUT SECTION.                                            00140012
001500                                                                  00150012
001600 FILE-CONTROL.                                                    00160012
001700                                                                  00170012
001800     SELECT TRAILER-STATUS-REPORT    ASSIGN TO RPT01.             00180012
001900                                                                  00190012
002000                                                                  00200012
002100 DATA DIVISION.                                                   00210012
002200                                                                  00220012
002300 FILE SECTION.                                                    00230012
002400 FD  TRAILER-STATUS-REPORT                                        00240012
002500     RECORDING MODE IS F                                          00250012
002600     LABEL RECORDS ARE STANDARD                                   00260012
002700     BLOCK CONTAINS 0 RECORDS.                                    00270012
002800                                                                  00280012
002900 01  TRAILER-STATUS-RECORD          PIC X(132).                   00290012
003000                                                                  00300012
003100 WORKING-STORAGE SECTION.                                         00310012
003200 01  PS-SWITCHES.                                                 00320012
003300     05  PS-EOD-SW                   PIC  X(03)    VALUE 'N'.     00330012
003400         88  PS-EOD                                VALUE 'Y'.     00340012
003500         88  PS-NOT-EOD                            VALUE 'N'.     00350012
003600     05  PS-FIRST-PAGE-SW            PIC  X(03)    VALUE 'Y'.     00360012
003700         88  PS-FIRST-PAGE                         VALUE 'Y'.     00370012
003800         88  PS-NOT-FIRST-PAGE                     VALUE 'N'.     00380012
003900     05  PS-DUP-FOUND-SW             PIC  X(03)    VALUE 'N'.     00390012
004000         88  PS-DUP-FOUND                          VALUE 'Y'.     00400012
004100         88  PS-NO-DUP-FOUND                       VALUE 'N'.     00410012
004200     05  PS-SHOULD-BE-REPORTED-SW    PIC  X(03)    VALUE 'N'.     00420012
004300         88  PS-SHOULD-BE-REPORTED                 VALUE 'Y'.     00430012
004400         88  PS-SHOULD-NOT-BE-REPORTED             VALUE 'N'.     00440012
004500                                                                  00450012
004600 01  CD-CPU-DATE.                                                 00460012
004700     03  CD-YEAR                     PIC  9(02)    VALUE ZERO.    00470012
004800     03  CD-MONTH                    PIC  9(02)    VALUE ZERO.    00480012
004900     03  CD-DAY                      PIC  9(02)    VALUE ZERO.    00490012
005000                                                                  00500012
005100 01  CD-CPU-DATE-MDY.                                             00510012
005200     03  CD-MM                       PIC  9(02)    VALUE ZERO.    00520012
005300     03  CD-DD                       PIC  9(02)    VALUE ZERO.    00530012
005400     03  CD-YY                       PIC  9(02)    VALUE ZERO.    00540012
005500                                                                  00550012
005600 01  DT-DATE.                                                     00560012
005700     03  DT-CC                       PIC  9(02)    VALUE ZERO.    00570012
005800     03  DT-YEAR                     PIC  9(02)    VALUE ZERO.    00580012
005900     03  FILLER                      PIC  X(01)    VALUE SPACE.   00590012
006000     03  DT-MONTH                    PIC  9(02)    VALUE ZERO.    00600012
006100     03  FILLER                      PIC  X(01)    VALUE SPACE.   00610012
006200     03  DT-DAY                      PIC  9(02)    VALUE ZERO.    00620012
006300                                                                  00630012
006400 01  VD-VARIFIED-DATE.                                            00640012
006500     03  VD-MONTH                    PIC  9(02)    VALUE ZERO.    00650012
006600     03  VD-DAY                      PIC  9(02)    VALUE ZERO.    00660012
006700     03  VD-YEAR                     PIC  9(02)    VALUE ZERO.    00670012
006800                                                                  00680012
006900 01  TM-TIME.                                                     00690012
007000     03  DT-HOURS                    PIC  9(02)    VALUE ZERO.    00700012
007100     03  FILLER                      PIC  X(01)    VALUE SPACE.   00710012
007200     03  DT-MINUTES                  PIC  9(02)    VALUE ZERO.    00720012
007300     03  FILLER                      PIC  X(01)    VALUE SPACE.   00730012
007400     03  DT-SECONDS                  PIC  9(02)    VALUE ZERO.    00740012
007500                                                                  00750012
007600 01  VT-VARIFIED-TIME.                                            00760012
007700     03  VT-HOURS                    PIC  9(02)    VALUE ZERO.    00770012
007800     03  VT-MINUTES                  PIC  9(02)    VALUE ZERO.    00780012
007900                                                                  00790012
008000 01  CT-CPU-TIME.                                                 00800012
008100     03  CT-HOUR                     PIC  9(02)    VALUE ZERO.    00810012
008200     03  CT-MINUTE                   PIC  9(02)    VALUE ZERO.    00820012
008300     03  FILLER                      PIC  9(04)    VALUE ZERO.    00830012
008400                                                                  00840012
008500 01  CT-CPU-TIME-4.                                               00850012
008600     03  CT-HH                       PIC  9(02)    VALUE ZERO.    00860012
008700     03  CT-MM                       PIC  9(02)    VALUE ZERO.    00870012
008800                                                                  00880012
008900 01  PC-PROGRAM-CONSTANTS.                                        00890012
009000     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          00900012
009100                                          'TRKRP007'.             00910012
009200                                                                  00920012
009300     05  PC-SLASH                    PIC  X(01)    VALUE '/'.     00930012
009400     05  PC-LINE-LIMIT               PIC S9(04)    VALUE +60      00940012
009500                                                   COMP SYNC.     00950012
009600     05  PC-1                        PIC  9(02)    VALUE 1.       00960012
009700     05  PC-DEFAULT-DTE              PIC  X(10)    VALUE          00970012
009800                                      '01/01/0001'.               00980012
009900     05  PC-DEFAULT-TME              PIC  X(05)    VALUE          00990012
010000                                      '00.00'.                    01000012
010100 01  PV-PROGRAM-VARIABLES.                                        01010012
010200     05  PV-NULL-IND                     PIC S9(04)  VALUE ZERO   01020012
010300                                                     COMP SYNC.   01030012
010400     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     01040012
010500                                                   COMP SYNC.     01050012
010600     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  01060012
010700     05  PV-LINE-COUNT               PIC S9(04)    VALUE +80      01070012
010800                                                   COMP SYNC.     01080012
010900     05  PV-PAGE-COUNT               PIC S9(04)    VALUE ZERO     01090012
011000                                                   COMP SYNC.     01100012
011100     05  PV-TRAILER-COUNT            PIC S9(04)    VALUE 0        01110012
011200                                                   COMP SYNC.     01120012
011210     05 PV-VE-COUNT                  PIC S9(04)    VALUE 0        01121021
011220                                                   COMP SYNC.     01122021
011230     05 PV-NON-VE-COUNT              PIC S9(04)    VALUE 0        01123021
011240                                                   COMP SYNC.     01124021
011250     05 PV-0-RCVR-COUNT              PIC S9(04)    VALUE 0        01125021
011260                                                   COMP SYNC.     01126021
011300     05  PV-SAVE-LOC                 PIC  9(03)    VALUE 999.     01130012
011400     05  PV-ARRIVAL-DTE              PIC  X(10)   VALUE SPACE.    01140012
011410     05  PV-ENROUTE-UID              PIC  X(08)   VALUE SPACE.    01141041
011500 01  TC-TRAILER-CURSOR-RTN-AREA.                                  01150012
011600     05 TC-TRIP-ID                   PIC S9(09)   VALUE ZERO      01160012
011700                                                  COMP.           01170012
011800     05 TC-OWNER-SCAC                PIC  X(04)   VALUE SPACE.    01180012
011900     05 TC-VEH-NBR                   PIC  X(10)   VALUE SPACE.    01190012
012000     05 TC-TRIP-STAT-CDE             PIC  X(02)   VALUE SPACE.    01200012
012100     05 TC-ARRIVAL-DTE               PIC  X(10)   VALUE SPACE.    01210012
012200     05 TC-ARRIVAL-TIME              PIC  X(08)   VALUE SPACE.    01220012
012210     05 TC-ARRIVAL-UID               PIC  X(08)   VALUE SPACE.    01221018
012300     05 TC-OPER-UNT-ID               PIC S9(04)   VALUE ZERO      01230012
012400                                                  COMP.           01240012
012500     05 TC-FCLTY-ID                  PIC S9(04)   VALUE ZERO      01250012
012600                                                  COMP.           01260012
012700     05 TC-FCLTY-AREA-ID             PIC  X(06)   VALUE SPACE.    01270012
012800                                                                  01280012
012900     COPY DPWS500.                                                01290012
013000                                                                  01300012
013100     COPY DPWS132O.                                               01310012
013200                                                                  01320012
013300 01  HL1-HEADING-LINE-1.                                          01330012
013400     05  FILLER                      PIC  X(31)    VALUE SPACES.  01340039
013500     05  FILLER                      PIC  X(71)    VALUE          01350041
013510     'TRAILER STATUS REPORT-ARRIVED NOT UNLOADED STATUS FOR AT LEA01351040
013520-        'ST 72 HOURS'.                                           01352040
013800     05  FILLER                      PIC  X(30)    VALUE SPACES.  01380041
013900                                                                  01390012
014000 01  HL2-HEADING-LINE-2.                                          01400012
014100     05  FILLER                      PIC  X(01)    VALUE SPACES.  01410012
014200     05  FILLER                      PIC  X(13)    VALUE          01420012
014300                                              'OPER UNIT ID:'.    01430012
014400     05  FILLER                      PIC  X(03)    VALUE SPACES.  01440012
014500     05  HL2-OPER-UNIT-ID            PIC  Z(02)9   VALUE ZEROS.   01450012
014600     05  FILLER                      PIC  X(01)    VALUE SPACES.  01460012
014700     05  HL2-OPER-UNIT-DESC          PIC  X(25)    VALUE SPACES.  01470012
014800     05  FILLER                      PIC  X(86)    VALUE SPACES.  01480045
014900                                                                  01490012
015000 01  HL3-HEADING-LINE-3.                                          01500012
015100     05  FILLER                      PIC  X(22)    VALUE SPACES.  01510039
015200     05  FILLER                      PIC  X(04)    VALUE          01520012
015300                                                  'TRIP'.         01530012
015400     05  FILLER                      PIC  X(04)    VALUE SPACES.  01540043
015500     05  FILLER                      PIC  X(08)    VALUE          01550039
015600                                                  'ENROUTE'.      01560039
015700     05  FILLER                      PIC  X(02)    VALUE SPACES.  01570044
015800     05  FILLER                      PIC  X(25)    VALUE          01580012
015900                              '-------- ARRIVAL --------'.        01590012
016000     05  FILLER                      PIC  X(02)    VALUE SPACES.  01600039
016100     05  FILLER                      PIC  X(25)    VALUE          01610012
016200                              '---- BEGIN UNLOADING ----'.        01620012
016300     05  FILLER                      PIC  X(07)    VALUE SPACES.  01630044
016400     05  FILLER                      PIC  X(04)    VALUE          01640012
016500                                                  '# VE'.         01650012
016600     05  FILLER                      PIC  X(07)    VALUE SPACES.  01660035
016700     05  FILLER                      PIC  X(08)    VALUE          01670012
016800                                                  '# NON-VE'.     01680012
016810     05  FILLER                      PIC  X(05)    VALUE SPACES.  01681029
016820     05  FILLER                      PIC  X(08)    VALUE          01682021
016830                                                  'SHPMT PO'.     01683039
016900     05  FILLER                      PIC  X(01)    VALUE SPACES.  01690039
017000                                                                  01700012
017100 01  HL4-HEADING-LINE-4.                                          01710012
017200     05  FILLER                      PIC  X(04)    VALUE 'SCAC'.  01720016
017210     05  FILLER                      PIC  X(02)    VALUE SPACES.  01721017
017300     05  FILLER                      PIC  X(07)    VALUE          01730012
017400                                                  'TRAILER'.      01740012
017500     05  FILLER                      PIC  X(10)    VALUE SPACES.  01750017
017600     05  FILLER                      PIC  X(02)    VALUE          01760012
017700                                                  'ID'.           01770012
017800     05  FILLER                      PIC  X(05)    VALUE SPACES.  01780043
017900     05  FILLER                      PIC  X(06)    VALUE          01790039
018000                                                  'USERID'.       01800039
018100     05  FILLER                      PIC  X(07)    VALUE SPACE.   01810043
018500     05  FILLER                      PIC  X(21)    VALUE          01850012
018600                              'DATE    TIME  USERID '.            01860042
018700     05  FILLER                      PIC  X(06)    VALUE SPACES.  01870039
018800     05  FILLER                      PIC  X(21)    VALUE          01880012
018900                              'DATE    TIME  USERID '.            01890042
019000     05  FILLER                      PIC  X(06)    VALUE SPACES.  01900039
019100     05  FILLER                      PIC  X(09)    VALUE          01910012
019200                                                  'RECEIVERS'.    01920012
019300     05  FILLER                      PIC  X(04)    VALUE SPACES.  01930012
019400     05  FILLER                      PIC  X(09)    VALUE          01940012
019500                                                  'RECEIVERS'.    01950012
019510     05  FILLER                      PIC  X(04)    VALUE SPACES.  01951021
019520     05  FILLER                      PIC  X(08)    VALUE          01952039
019530                                                  'NO RCVR#'.     01953039
019600     05  FILLER                      PIC  X(01)    VALUE SPACES.  01960039
019700                                                                  01970012
019800 01  DL1-DETAIL-LINE-1.                                           01980012
020000     05  DL1-DELVRY-SCAC             PIC  X(04)    VALUE SPACES.  02000012
020100     05  FILLER                      PIC  X(02)    VALUE SPACES.  02010012
020200     05  DL1-TRAILER                 PIC  X(10)    VALUE ZERO.    02020012
020300     05  FILLER                      PIC  X(02)    VALUE SPACES.  02030012
020400     05  DL1-TRIP-ID                 PIC  Z(10)    VALUE ZERO.    02040012
020700     05  FILLER                      PIC  X(02)    VALUE SPACES.  02070027
020710     05  DL1-ENROUTE-USERID          PIC  X(08)    VALUE SPACES.  02071039
020720     05  FILLER                      PIC  X(02)    VALUE SPACES.  02072039
020800     05  DL1-ARRIVAL-DTE             PIC  X(16)    VALUE ZERO.    02080012
020900     05  FILLER                      PIC  X(01)    VALUE SPACES.  02090039
021000     05  DL1-ARRIVAL-USERID          PIC  X(08)    VALUE SPACES.  02100017
021100     05  FILLER                      PIC  X(02)    VALUE SPACES.  02110012
021200     05  DL1-UNLOAD-DTE              PIC  X(16)    VALUE ZERO.    02120012
021300     05  FILLER                      PIC  X(01)    VALUE SPACES.  02130039
021400     05  DL1-UNLOAD-USERID           PIC  X(08)    VALUE ZEROES.  02140027
021500     05  FILLER                      PIC  X(02)    VALUE SPACES.  02150039
021600     05  DL1-VE-CNT                  PIC  ZZZ,ZZZ,ZZ9             02160037
021700                                                   VALUE ZEROES.  02170027
021800     05  FILLER                      PIC  X(02)    VALUE SPACES.  02180012
021900     05  DL1-NON-VE-CNT              PIC  ZZZ,ZZZ,ZZ9             02190037
021910                                                   VALUE ZEROES.  02191027
022000     05  FILLER                      PIC  X(02)    VALUE SPACES.  02200021
022010     05  DL1-0-RCVR-CNT              PIC  ZZZ,ZZZ,ZZ9             02201037
022020                                                   VALUE ZEROES.  02202027
022100     05  FILLER                      PIC  X(01)    VALUE SPACES.  02210039
022200                                                                  02220012
022300 01  BL-BLANK-LINE                   PIC  X(132)   VALUE SPACES.  02230012
022400                                                                  02240012
022500 01  TL1-TOTAL-LINE.                                              02250012
022600     05  FILLER                      PIC  X(01)    VALUE SPACES.  02260012
022700     05  FILLER                      PIC  X(19)    VALUE          02270012
022800                                          'TOTAL TRAILERS PER '.  02280012
022900     05  TL1-OPER-UNIT-DESC          PIC  X(25)    VALUE SPACES.  02290012
023000     05  FILLER                      PIC  X(03)    VALUE ':  '.   02300012
023100     05  TL1-TRAILER-COUNT           PIC  Z(03)9   VALUE ZEROS.   02310012
023200                                                                  02320012
023300 01  PR-PRINT-NO-DETAIL.                                          02330012
023400     05  FILLER                      PIC X(01)  VALUE SPACES.     02340012
023500     05  FILLER                      PIC X(35)  VALUE             02350012
023600         '*** THERE WAS NO DATA TO REPORT ON '.                   02360012
023700     05  FILLER                      PIC X(24)  VALUE             02370012
023800         'FOR THIS TIME PERIOD ***'.                              02380012
023900                                                                  02390012
024000 01  PR-PRINT-FINAL.                                              02400012
024100     05  FILLER                      PIC X(53)  VALUE SPACES.     02410012
024200     05  FILLER                      PIC X(21)  VALUE             02420012
024300         '*** END OF REPORT ***'.                                 02430012
024400                                                                  02440012
024500     COPY DPWS004.                                                02450012
024600                                                                  02460012
024700*---------------------------------------------------------------* 02470012
024800*    DB2 AREA FOR TVHTRIP                                       * 02480012
024900*---------------------------------------------------------------* 02490012
025000     EXEC SQL                                                     02500012
025100          INCLUDE TVHTRIP                                         02510012
025200     END-EXEC.                                                    02520012
025300*---------------------------------------------------------------* 02530012
025400*    DB2 AREA FOR TTRIPST                                       * 02540012
025500*---------------------------------------------------------------* 02550012
025600     EXEC SQL                                                     02560012
025700          INCLUDE TTRIPST                                         02570012
025800     END-EXEC.                                                    02580012
025900*---------------------------------------------------------------* 02590012
026000*    DB2 AREA FOR TTRSTYP                                       * 02600012
026100*---------------------------------------------------------------* 02610012
026200     EXEC SQL                                                     02620012
026300          INCLUDE TTRSTYP                                         02630012
026400     END-EXEC.                                                    02640012
026500*---------------------------------------------------------------* 02650012
026600*    DB2 AREA FOR TVEHICL                                       * 02660012
026700*---------------------------------------------------------------* 02670012
026800     EXEC SQL                                                     02680012
026900          INCLUDE TVEHICL                                         02690012
027000     END-EXEC.                                                    02700012
027100*---------------------------------------------------------------* 02710012
027200*    DB2 AREA FOR TFACLTY                                       * 02720012
027300*---------------------------------------------------------------* 02730012
027400     EXEC SQL                                                     02740012
027500          INCLUDE TFACLTY                                         02750012
027600     END-EXEC.                                                    02760012
027700*---------------------------------------------------------------* 02770012
027800*    DB2 AREA FOR XLT00010 -- XLT_LOC                           * 02780012
027900*---------------------------------------------------------------* 02790012
028000     EXEC SQL                                                     02800012
028100          INCLUDE XLT00010                                        02810012
028200     END-EXEC.                                                    02820012
028300*---------------------------------------------------------------* 02830012
028400*    DB2 AREA FOR COMMUNICATIONS                                * 02840012
028500*---------------------------------------------------------------* 02850012
028600     EXEC SQL                                                     02860012
028700          INCLUDE SQLCA                                           02870012
028800     END-EXEC.                                                    02880012
028900*---------------------------------------------------------------* 02890012
029000*    CURSOR TO GET DUPLICATE SHIPMENTS                          * 02900012
029100*---------------------------------------------------------------* 02910012
029200     EXEC SQL                                                     02920012
029300         DECLARE TRAILER_CSR CURSOR FOR                           02930012
029400             SELECT A.TRIP_ID,                                    02940012
029500                    A.OWNER_SCAC_ID,                              02950012
029600                    A.VEH_NBR,                                    02960012
029700                    B.TRIP_STATUS_CDE,                            02970012
029800                    B.STATUS_DTE,                                 02980012
029900                    B.STATUS_TME,                                 02990012
029910                    B.STATUS_UID,                                 02991018
030000                    B.OPER_UNT_ID,                                03000012
030100                    B.FCLTY_ID,                                   03010012
030200                    B.FCLTY_AREA_ID                               03020012
030300             FROM TVHTRIP A,                                      03030012
030400                  TTRIPST B,                                      03040012
030500                  TTRSTYP C,                                      03050012
030600                  TVEHICL D,                                      03060012
030700                  XLT_LOC E                                       03070012
030800             WHERE A.TRIP_ID         = B.TRIP_ID                  03080012
030900               AND B.TRIP_STATUS_CDE = C.TRIP_STATUS_CDE          03090012
031000               AND D.CURR_TRIP_ID    = A.TRIP_ID                  03100012
031100               AND C.PRTY_CDE      IN ('50', '60')                03110012
031200               AND E.LOC_NBR         = B.OPER_UNT_ID              03120012
031300               AND E.LOC_TYP_CDE     = 'DC'                       03130012
031400               AND B.STATUS_DTE      < :PV-ARRIVAL-DTE            03140012
031500               AND C.PRTY_CDE        =                            03150012
031600                  (SELECT MAX(E.PRTY_CDE)                         03160012
031700                    FROM TTRIPST D,                               03170012
031800                         TTRSTYP E                                03180012
031900                    WHERE D.TRIP_ID         = A.TRIP_ID           03190012
032000                      AND D.TRIP_STATUS_CDE = E.TRIP_STATUS_CDE)  03200012
032100               ORDER BY 8, 9, 2, 3                                03210019
032110                WITH UR                                           03211028
032200     END-EXEC.                                                    03220012
032300                                                                  03230012
032400***************************************************************** 03240012
032500 PROCEDURE DIVISION.                                              03250012
032600***************************************************************** 03260012
032700                                                                  03270012
032800 0000-MAINLINE.                                                   03280012
032900***************************************************************** 03290012
033000*  THIS PARAGRAPH DRIVES THE PROGRAM.                           * 03300012
033100***************************************************************** 03310012
033200     PERFORM 1000-INITIALIZE.                                     03320012
033300                                                                  03330012
033400     PERFORM 2000-MAIN-PROCESS                                    03340012
033500           UNTIL  PS-EOD                                          03350012
033600                                                                  03360012
033700     PERFORM 2515-PRINT-TOTAL-LINE  THRU 2515-EXIT.               03370012
033800                                                                  03380012
033900     PERFORM 9000-END-PROCESS THRU 9000-EXIT.                     03390012
034000                                                                  03400012
034100     PERFORM 9100-CLOSE-CURSOR        THRU 9100-EXIT.             03410012
034200                                                                  03420012
034300     CLOSE  TRAILER-STATUS-REPORT.                                03430012
034400 0000-EXIT.  STOP RUN.                                            03440012
034500                                                                  03450012
034600 1000-INITIALIZE.                                                 03460012
034700     OPEN  OUTPUT TRAILER-STATUS-REPORT.                          03470012
034800                                                                  03480012
034900     ACCEPT CD-CPU-DATE FROM DATE.                                03490012
035000     ACCEPT CT-CPU-TIME FROM TIME.                                03500012
035100                                                                  03510012
035200     PERFORM 1200-INITIALIZE-HEADINGS  THRU 1200-EXIT.            03520012
035300     PERFORM 6999-PRINT-HEADINGS       THRU 6999-EXIT.            03530012
035400     INITIALIZE DPG51 DPG52 DPG53                                 03540012
035500                DPG54 DPG55 DPG56.                                03550012
035600     MOVE CD-CPU-DATE                TO DPG51-SYSTEM-DATE         03560012
035700                                                                  03570012
035800     SET DPG51-ACTUAL-CALENDAR-ONLY  TO TRUE.                     03580012
035900     SET DPG51-DECREMENT-DATE        TO TRUE.                     03590012
036000     SET DPG52-LK-DTE-GREG           TO TRUE.                     03600012
036100     MOVE 3                          TO DPG51-INCR-DECR-DAYS-9.   03610012
036200                                                                  03620012
036300     MOVE CD-YEAR                    TO CD-YY.                    03630012
036400     MOVE CD-MONTH                   TO CD-MM.                    03640012
036500     MOVE CD-DAY                     TO CD-DD.                    03650012
036600     MOVE CD-CPU-DATE-MDY            TO DPG52-LK-DATE-INPUT.      03660012
036700     CALL DP500-KOHLS-CALENDAR-ROUTINE                            03670012
036800         USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.               03680012
036900                                                                  03690012
037000     MOVE DPG55-DB2-ISO-DATE-FMT     TO PV-ARRIVAL-DTE.           03700012
037100     DISPLAY 'DATE MINUS 3 DAYS = ' PV-ARRIVAL-DTE.               03710012
037200     PERFORM 1300-OPEN-CURSOR          THRU 1300-EXIT.            03720012
037300                                                                  03730012
037400 1000-EXIT.  EXIT.                                                03740012
037500                                                                  03750012
037600 1200-INITIALIZE-HEADINGS.                                        03760012
037700***************************************************************** 03770012
037800*  INITIALIZE REPORT HEADINGS                                   * 03780012
037900***************************************************************** 03790012
038000     MOVE CD-YEAR                TO DP132O-RUN-YEAR.              03800012
038100     MOVE CD-MONTH               TO DP132O-RUN-MONTH.             03810012
038200     MOVE CD-DAY                 TO DP132O-RUN-DAY.               03820012
038300     MOVE CT-HOUR                TO DP132O-RUN-HOUR.              03830012
038400     MOVE CT-MINUTE              TO DP132O-RUN-MINUTE.            03840012
038500     MOVE 'TRKRP007'             TO DP132O-PROGRAM-NAME.          03850012
038600     MOVE 1                      TO DP132O-REPORT-NUMBER.         03860012
038700 1200-EXIT.   EXIT.                                               03870012
038800                                                                  03880012
038900                                                                  03890012
039000 1300-OPEN-CURSOR.                                                03900012
039100     EXEC SQL                                                     03910012
039200         OPEN TRAILER_CSR                                         03920012
039300     END-EXEC.                                                    03930012
039400                                                                  03940012
039500     EVALUATE TRUE                                                03950012
039600         WHEN SQLWARN0 NOT = SPACE                                03960012
039700         WHEN SQLCODE < ZERO                                      03970012
039800         WHEN SQLCODE > ZERO                                      03980012
039900              DISPLAY '** ABEND ** IN TRKRP007'                   03990012
040000              DISPLAY 'PARAGRAPH:  1300-OPEN-CURSOR'              04000012
040100              DISPLAY 'MESSAGE:  SQL ERROR OPENING TRAILER_CSR'   04010012
040200              PERFORM 9999-SQL-ERROR  THRU 9999-EXIT              04020012
040300         WHEN SQLCODE = ZERO                                      04030012
040400             CONTINUE                                             04040012
040500     END-EVALUATE.                                                04050012
040600 1300-EXIT.  EXIT.                                                04060012
040700                                                                  04070012
040800 2000-MAIN-PROCESS.                                               04080012
040900     PERFORM 2100-FETCH-TRAILER-CURSOR  THRU 2100-EXIT.           04090012
041000     EVALUATE TRUE                                                04100012
041100        WHEN PS-EOD                                               04110012
041200             CONTINUE                                             04120012
041300        WHEN PS-NOT-EOD                                           04130012
041400            PERFORM 2400-GET-BEG-UNLOADING-DTE  THRU 2400-EXIT    04140012
041401            PERFORM 2405-GET-ENROUTE-UID                          04140141
041410            PERFORM 2410-COUNT-VE-RCVRS                           04141021
041420            PERFORM 2420-COUNT-NON-VE-RCVRS                       04142023
041430            PERFORM 2430-COUNT-0-RCVR-RCVRS                       04143023
041500            PERFORM 2500-PRINT-REPORT          THRU 2500-EXIT     04150012
041600     END-EVALUATE.                                                04160012
041700 2000-EXIT.   EXIT.                                               04170012
041800                                                                  04180012
041900 2100-FETCH-TRAILER-CURSOR.                                       04190012
042000     EXEC SQL                                                     04200012
042100          FETCH TRAILER_CSR                                       04210012
042200           INTO :TC-TRIP-ID                                       04220012
042300               ,:TC-OWNER-SCAC                                    04230012
042400               ,:TC-VEH-NBR   :PV-NULL-IND                        04240012
042500               ,:TC-TRIP-STAT-CDE                                 04250012
042600               ,:TC-ARRIVAL-DTE                                   04260012
042700               ,:TC-ARRIVAL-TIME                                  04270012
042710               ,:TC-ARRIVAL-UID                                   04271018
042800               ,:TC-OPER-UNT-ID                                   04280012
042900               ,:TC-FCLTY-ID                                      04290012
043000               ,:TC-FCLTY-AREA-ID                                 04300012
043100     END-EXEC.                                                    04310012
043200                                                                  04320012
043300     EVALUATE TRUE                                                04330012
043400         WHEN SQLCODE = +0                                        04340012
043500             IF PV-NULL-IND < +0                                  04350012
043600                MOVE 'NO VEHICLE'       TO TC-VEH-NBR             04360012
043700             END-IF                                               04370012
043800                                                                  04380012
043900         WHEN SQLCODE = +100                                      04390012
044000              SET  PS-EOD         TO TRUE                         04400012
044100              MOVE SPACES         TO FACLTY-FCLTY-NME             04410012
044200                                                                  04420012
044300         WHEN OTHER                                               04430012
044400            DISPLAY '** ABEND ** IN TRKRP007'                     04440012
044500            DISPLAY 'PARAGRAPH:  2100-FETCH-TRAILER-CURSOR'       04450012
044600            DISPLAY 'MESSAGE:  SQL ERROR FETCHING TRAILER_CSR'    04460012
044700            PERFORM 9999-SQL-ERROR  THRU 9999-EXIT                04470012
044800     END-EVALUATE.                                                04480012
044900                                                                  04490012
045000 2100-EXIT.    EXIT.                                              04500012
045100                                                                  04510012
045200 2400-GET-BEG-UNLOADING-DTE.                                      04520012
045300     EXEC SQL                                                     04530012
045400          SELECT STATUS_DTE,                                      04540012
045500                 STATUS_TME,                                      04550022
045510                 STATUS_UID                                       04551022
045600           INTO :TRIPST-STATUS-DTE,                               04560012
045700                :TRIPST-STATUS-TME,                               04570018
045710                :TRIPST-STATUS-UID                                04571018
045800           FROM  TTRIPST                                          04580012
045900           WHERE TRIP_ID         = :TC-TRIP-ID                    04590012
046000             AND TRIP_STATUS_CDE = 'UG'                           04600012
046010            WITH UR                                               04601028
046100     END-EXEC.                                                    04610012
046200                                                                  04620012
046300     EVALUATE TRUE                                                04630012
046400         WHEN SQLCODE = +0                                        04640012
046500              CONTINUE                                            04650012
046600                                                                  04660012
046700         WHEN SQLCODE = +100                                      04670012
046800              MOVE SPACES              TO TRIPST-STATUS-DTE       04680012
046900              MOVE SPACES              TO TRIPST-STATUS-TME       04690012
046910              MOVE SPACES              TO TRIPST-STATUS-UID       04691018
047000         WHEN OTHER                                               04700012
047100             DISPLAY '** ABEND ** IN TRKRP007'                    04710012
047200             DISPLAY 'PARAGRAPH:2400-GET-BEG-UNLOADING-DTE'       04720012
047300             DISPLAY 'MESSAGE:  SQL ERROR SELECTING FROM TTRIPST' 04730012
047400             PERFORM 9999-SQL-ERROR    THRU 9999-EXIT             04740012
047500     END-EVALUATE.                                                04750012
047600 2400-EXIT.    EXIT.                                              04760012
047700                                                                  04770012
047701 2405-GET-ENROUTE-UID.                                            04770141
047702     EXEC SQL                                                     04770241
047703          SELECT STATUS_UID                                       04770341
047708           INTO :PV-ENROUTE-UID                                   04770842
047709           FROM  TTRIPST                                          04770941
047710           WHERE TRIP_ID         = :TC-TRIP-ID                    04771041
047711             AND TRIP_STATUS_CDE = 'EN'                           04771142
047712            WITH UR                                               04771241
047713     END-EXEC.                                                    04771341
047714                                                                  04771441
047715     EVALUATE TRUE                                                04771541
047716         WHEN SQLCODE = +0                                        04771641
047717              CONTINUE                                            04771741
047718                                                                  04771841
047719         WHEN SQLCODE = +100                                      04771941
047720              MOVE SPACES              TO PV-ENROUTE-UID          04772041
047723         WHEN OTHER                                               04772341
047724             DISPLAY '** ABEND ** IN TRKRP007'                    04772441
047725             DISPLAY 'PARAGRAPH:2405-GET-ENROUTE-UID      '       04772541
047726             DISPLAY 'MESSAGE:  SQL ERROR SELECTING FROM TTRIPST' 04772641
047727             PERFORM 9999-SQL-ERROR    THRU 9999-EXIT             04772741
047728     END-EVALUATE.                                                04772841
047729 2410-COUNT-VE-RCVRS.                                             04772921
047730                                                                  04773021
047731     MOVE ZEROES  TO  PV-VE-COUNT.                                04773121
047732                                                                  04773221
047733     EXEC SQL                                                     04773321
047734          SELECT COUNT(*)                                         04773421
047735            INTO :PV-VE-COUNT                                     04773521
047736           FROM                                                   04773621
047737          (SELECT DISTINCT                                        04773721
047738                 C.ORD_NBR                                        04773821
047739               , C.REC_SEQ_NBR                                    04773921
047740               , C.STATUS_CDE                                     04774021
047741            FROM TSHIPMT A                                        04774121
047742               , TSHPTPO B                                        04774221
047743               , TRECEIV C                                        04774321
047744          WHERE A.TRIP_ID      =  :TC-TRIP-ID                     04774421
047745            AND A.SHIPT_ID     =  B.SHIPT_ID                      04774521
047746            AND B.PO_NBR       =  C.ORD_NBR                       04774621
047747            AND B.REC_SEQ_NBR  =  C.REC_SEQ_NBR                   04774721
047748            AND C.STATUS_CDE   = 'VE'                             04774821
047749          ) AS T1                                                 04774921
047750          WITH UR                                                 04775028
047751     END-EXEC.                                                    04775121
047752                                                                  04775221
047753     EVALUATE TRUE                                                04775321
047754         WHEN SQLCODE = +0                                        04775421
047755              CONTINUE                                            04775521
047756                                                                  04775621
047757         WHEN SQLCODE = +100                                      04775721
047758         WHEN SQLCODE = -305                                      04775821
047759              MOVE ZEROES              TO PV-VE-COUNT             04775921
047760         WHEN OTHER                                               04776021
047761             DISPLAY '** ABEND ** IN TRKRP007'                    04776121
047762             DISPLAY 'PARAGRAPH:2410-COUNT-VE-RCVRS       '       04776221
047763             DISPLAY 'MESSAGE:  SQL ERROR SELECTING FROM TTRIPST' 04776321
047764             PERFORM 9999-SQL-ERROR    THRU 9999-EXIT             04776421
047765     END-EVALUATE.                                                04776521
047766                                                                  04776621
047767                                                                  04776721
047768 2420-COUNT-NON-VE-RCVRS.                                         04776821
047769                                                                  04776921
047770     MOVE ZEROES  TO  PV-NON-VE-COUNT.                            04777021
047771                                                                  04777121
047772     EXEC SQL                                                     04777221
047773          SELECT COUNT(*)                                         04777321
047774            INTO :PV-NON-VE-COUNT                                 04777421
047775           FROM                                                   04777521
047776          (SELECT DISTINCT                                        04777621
047777                 C.ORD_NBR                                        04777721
047778               , C.REC_SEQ_NBR                                    04777821
047779               , C.STATUS_CDE                                     04777921
047780            FROM TSHIPMT A                                        04778021
047781               , TSHPTPO B                                        04778121
047782               , TRECEIV C                                        04778221
047783          WHERE A.TRIP_ID      =  :TC-TRIP-ID                     04778321
047784            AND A.SHIPT_ID     =  B.SHIPT_ID                      04778421
047785            AND B.PO_NBR       =  C.ORD_NBR                       04778521
047786            AND B.REC_SEQ_NBR  =  C.REC_SEQ_NBR                   04778621
047787            AND NOT C.STATUS_CDE   = 'VE'                         04778721
047788          ) AS T1                                                 04778821
047789          WITH UR                                                 04778928
047790     END-EXEC.                                                    04779021
047791                                                                  04779121
047792     EVALUATE TRUE                                                04779221
047793         WHEN SQLCODE = +0                                        04779321
047794              CONTINUE                                            04779421
047795                                                                  04779521
047796         WHEN SQLCODE = +100                                      04779621
047797         WHEN SQLCODE = -305                                      04779721
047798              MOVE ZEROES              TO PV-NON-VE-COUNT         04779821
047799         WHEN OTHER                                               04779921
047800             DISPLAY '** ABEND ** IN TRKRP007'                    04780021
047801             DISPLAY 'PARAGRAPH:2420-COUNT-NON-VE-RCVRS   '       04780121
047802             DISPLAY 'MESSAGE:  SQL ERROR SELECTING FROM TTRIPST' 04780221
047803             PERFORM 9999-SQL-ERROR    THRU 9999-EXIT             04780321
047804     END-EVALUATE.                                                04780421
047805                                                                  04780521
047806                                                                  04780621
047807 2430-COUNT-0-RCVR-RCVRS.                                         04780724
047808                                                                  04780821
047809     MOVE ZEROES  TO  PV-0-RCVR-COUNT.                            04780921
047810                                                                  04781021
047811     EXEC SQL                                                     04781121
047812          SELECT COUNT(*)                                         04781221
047813            INTO :PV-0-RCVR-COUNT                                 04781321
047814           FROM                                                   04781421
047815          (SELECT DISTINCT                                        04781521
047816                 B.PO_NBR                                         04781621
047817               , B.REC_SEQ_NBR                                    04781721
047818            FROM TSHIPMT A                                        04781821
047819               , TSHPTPO B                                        04781921
047820          WHERE A.TRIP_ID      =  :TC-TRIP-ID                     04782021
047821            AND A.SHIPT_ID     =  B.SHIPT_ID                      04782121
047822            AND B.REC_SEQ_NBR  =  0                               04782221
047823          ) AS T1                                                 04782321
047824          WITH UR                                                 04782428
047825     END-EXEC.                                                    04782521
047826                                                                  04782621
047827     EVALUATE TRUE                                                04782721
047828         WHEN SQLCODE = +0                                        04782821
047829              CONTINUE                                            04782921
047830                                                                  04783021
047831         WHEN SQLCODE = +100                                      04783121
047832         WHEN SQLCODE = -305                                      04783221
047833              MOVE ZEROES              TO PV-0-RCVR-COUNT         04783321
047834         WHEN OTHER                                               04783421
047835             DISPLAY '** ABEND ** IN TRKRP007'                    04783521
047836             DISPLAY 'PARAGRAPH:420-COUNT-0-RCVR-RCVRS    '       04783621
047837             DISPLAY 'MESSAGE:  SQL ERROR SELECTING FROM TTRIPST' 04783721
047838             PERFORM 9999-SQL-ERROR    THRU 9999-EXIT             04783821
047839     END-EVALUATE.                                                04783921
047840                                                                  04784021
047841                                                                  04784121
047850 2500-PRINT-REPORT.                                               04785012
047900                                                                  04790012
048000     IF  TC-OPER-UNT-ID      = PV-SAVE-LOC                        04800012
048100         PERFORM 2510-PRINT-DETAIL-LINE THRU 2510-EXIT            04810012
048200     ELSE                                                         04820012
048300         IF PV-TRAILER-COUNT NOT = 0                              04830012
048400             PERFORM 2515-PRINT-TOTAL-LINE  THRU 2515-EXIT        04840012
048500             PERFORM 9000-END-PROCESS THRU 9000-EXIT              04850012
048600         END-IF                                                   04860012
048700         MOVE 0   TO PV-TRAILER-COUNT                             04870012
048800         PERFORM 2520-GET-FCLTY-ID-NAME THRU 2520-EXIT            04880012
048900         IF PS-FIRST-PAGE                                         04890012
049000             SET PS-NOT-FIRST-PAGE TO TRUE                        04900012
049100         ELSE                                                     04910012
049200             MOVE 0                TO PV-PAGE-COUNT               04920012
049300             PERFORM 6999-PRINT-HEADINGS    THRU 6999-EXIT        04930012
049400         END-IF                                                   04940012
049500         PERFORM 7000-PRINT-HEADINGS    THRU 7000-EXIT            04950012
049600         PERFORM 2510-PRINT-DETAIL-LINE THRU 2510-EXIT            04960012
049700         MOVE TC-OPER-UNT-ID    TO  PV-SAVE-LOC                   04970012
049800     END-IF.                                                      04980012
049900 2500-EXIT.   EXIT.                                               04990012
050000                                                                  05000012
050100 2510-PRINT-DETAIL-LINE.                                          05010012
050200                                                                  05020012
050300     ADD 1 TO PV-TRAILER-COUNT                                    05030012
050400                                                                  05040012
050500     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            05050012
050600         PERFORM 6999-PRINT-HEADINGS   THRU 6999-EXIT             05060012
050700         PERFORM 7000-PRINT-HEADINGS    THRU 7000-EXIT            05070012
050800     END-IF.                                                      05080012
050900                                                                  05090012
051000      MOVE TC-TRIP-ID              TO    DL1-TRIP-ID              05100020
051100      MOVE TC-OWNER-SCAC           TO    DL1-DELVRY-SCAC          05110012
051200      MOVE TC-VEH-NBR              TO    DL1-TRAILER              05120013
051300      STRING TC-ARRIVAL-DTE                                       05130012
051400             ' '                                                  05140012
051500             TC-ARRIVAL-TIME                                      05150012
051600          DELIMITED BY SIZE                                       05160012
051700          INTO DL1-ARRIVAL-DTE                                    05170012
051800      END-STRING                                                  05180012
051900      STRING TRIPST-STATUS-DTE                                    05190012
052000             ' '                                                  05200012
052100             TRIPST-STATUS-TME                                    05210012
052200         DELIMITED BY SIZE                                        05220012
052300         INTO DL1-UNLOAD-DTE                                      05230012
052400      END-STRING                                                  05240012
052401                                                                  05240118
052410      MOVE TC-ARRIVAL-UID          TO    DL1-ARRIVAL-USERID       05241018
052420      MOVE TRIPST-STATUS-UID       TO    DL1-UNLOAD-USERID        05242019
052421      MOVE PV-ENROUTE-UID          TO    DL1-ENROUTE-USERID       05242141
052422                                                                  05242241
052430      MOVE PV-VE-COUNT             TO    DL1-VE-CNT               05243021
052450      MOVE PV-NON-VE-COUNT         TO    DL1-NON-VE-CNT           05245021
052470      MOVE PV-0-RCVR-COUNT         TO    DL1-0-RCVR-CNT           05247021
052500                                                                  05250012
052600      WRITE  TRAILER-STATUS-RECORD                                05260012
052700        FROM DL1-DETAIL-LINE-1                                    05270012
052800          AFTER ADVANCING 1 LINE.                                 05280012
052900                                                                  05290012
053000     ADD 1                      TO PV-LINE-COUNT.                 05300012
053100 2510-EXIT.   EXIT.                                               05310012
053200                                                                  05320012
053300 2515-PRINT-TOTAL-LINE.                                           05330012
053400     MOVE HL2-OPER-UNIT-DESC TO TL1-OPER-UNIT-DESC                05340012
053500     MOVE PV-TRAILER-COUNT   TO TL1-TRAILER-COUNT                 05350012
053600     WRITE  TRAILER-STATUS-RECORD                                 05360012
053700        FROM TL1-TOTAL-LINE                                       05370012
053800          AFTER ADVANCING 2 LINE.                                 05380012
053900     ADD 2                      TO PV-LINE-COUNT.                 05390012
054000 2515-EXIT.   EXIT.                                               05400012
054100                                                                  05410012
054200 2520-GET-FCLTY-ID-NAME.                                          05420012
054300          EXEC SQL                                                05430012
054400            SELECT  FCLTY_ID                                      05440012
054500                   ,FCLTY_NME                                     05450012
054600              INTO :FACLTY-FCLTY-ID                               05460012
054700                   ,:FACLTY-FCLTY-NME                             05470012
054800               FROM  TFACLTY                                      05480012
054900              WHERE  OPER_UNT_ID = :TC-OPER-UNT-ID                05490012
055000                AND  FCLTY_ID    = :TC-FCLTY-ID                   05500012
055010               WITH UR                                            05501028
055100          END-EXEC                                                05510012
055200                                                                  05520012
055300          EVALUATE TRUE                                           05530012
055400              WHEN SQLCODE = +0                                   05540012
055500                MOVE TC-OPER-UNT-ID    TO HL2-OPER-UNIT-ID        05550012
055600                MOVE FACLTY-FCLTY-NME  TO HL2-OPER-UNIT-DESC      05560012
055700              WHEN SQLCODE = +100                                 05570012
055800              WHEN SQLCODE = -904                                 05580012
055900              WHEN SQLCODE = -913                                 05590012
056000                  CONTINUE                                        05600012
056100                                                                  05610012
056200              WHEN SQLWARN0 NOT = SPACES                          05620012
056300              WHEN SQLCODE < +0                                   05630012
056400              WHEN SQLCODE > +0                                   05640012
056500                   DISPLAY '** ABEND ** IN TRKRP007'              05650012
056600                   DISPLAY 'PARAGRAPH:2520-GET-FCLTY-ID-NAME'     05660012
056700                   DISPLAY                                        05670012
056800                  'MESSAGE:  SQL ERROR SELECTING FROM TFACLTY'    05680012
056900                   PERFORM 9999-SQL-ERROR   THRU 9999-EXIT        05690012
057000          END-EVALUATE.                                           05700012
057100 2520-EXIT.   EXIT.                                               05710012
057200 6999-PRINT-HEADINGS.                                             05720012
057300***************************************************************** 05730012
057400*  HEADING ROUTINE.                                             * 05740012
057500***************************************************************** 05750012
057600     ADD 1                       TO PV-PAGE-COUNT.                05760012
057700     MOVE PV-PAGE-COUNT          TO DP132O-PAGE-NUMBER.           05770012
057800                                                                  05780012
057900     WRITE TRAILER-STATUS-RECORD                                  05790012
058000       FROM DP132O-STANDRD-HEADER-132-COLS                        05800012
058100         AFTER ADVANCING PAGE.                                    05810012
058200                                                                  05820012
058300     WRITE TRAILER-STATUS-RECORD                                  05830012
058400       FROM HL1-HEADING-LINE-1                                    05840012
058500         AFTER ADVANCING 2 LINES.                                 05850012
058600     MOVE 3                   TO PV-LINE-COUNT.                   05860012
058700 6999-EXIT.   EXIT.                                               05870012
058800                                                                  05880012
058900 7000-PRINT-HEADINGS.                                             05890012
059000     WRITE TRAILER-STATUS-RECORD                                  05900012
059100       FROM HL2-HEADING-LINE-2                                    05910012
059200         AFTER ADVANCING 2 LINES                                  05920012
059300                                                                  05930012
059400     WRITE TRAILER-STATUS-RECORD                                  05940012
059500       FROM HL3-HEADING-LINE-3                                    05950012
059600         AFTER ADVANCING 2 LINES.                                 05960012
059700                                                                  05970012
059800     WRITE TRAILER-STATUS-RECORD                                  05980012
059900       FROM HL4-HEADING-LINE-4                                    05990012
060000         AFTER ADVANCING 1 LINE.                                  06000012
060100                                                                  06010012
060200     WRITE TRAILER-STATUS-RECORD                                  06020012
060300       FROM BL-BLANK-LINE                                         06030012
060400         AFTER ADVANCING 1 LINE.                                  06040012
060500                                                                  06050012
060600     ADD  6                   TO PV-LINE-COUNT.                   06060012
060700 7000-EXIT.   EXIT.                                               06070012
060800                                                                  06080012
060900 9000-END-PROCESS.                                                06090012
061000***************************************************************** 06100012
061100*  CLOSE FILES.                                                   06110012
061200***************************************************************** 06120012
061300                                                                  06130012
061400     WRITE TRAILER-STATUS-RECORD                                  06140012
061500       FROM PR-PRINT-FINAL                                        06150012
061600         AFTER ADVANCING 3 LINES.                                 06160012
061700                                                                  06170012
061800 9000-EXIT.  EXIT.                                                06180012
061900                                                                  06190012
062000 9100-CLOSE-CURSOR .                                              06200012
062100     EXEC SQL                                                     06210012
062200         CLOSE TRAILER_CSR                                        06220012
062300     END-EXEC.                                                    06230012
062400                                                                  06240012
062500     EVALUATE TRUE                                                06250012
062600         WHEN SQLWARN0 NOT = SPACE                                06260012
062700         WHEN SQLCODE < ZERO                                      06270012
062800         WHEN SQLCODE > ZERO                                      06280012
062900             DISPLAY '** ABEND ** IN TRKRP007'                    06290012
063000             DISPLAY 'PARAGRAPH:9100-CLOSE-CURSOR'                06300012
063100             DISPLAY 'MESSAGE:  SQL ERROR CLOSING TRAILER_CSR'    06310012
063200             PERFORM 9999-SQL-ERROR    THRU 9999-EXIT             06320012
063300         WHEN SQLCODE = ZERO                                      06330012
063400             CONTINUE                                             06340012
063500     END-EVALUATE.                                                06350012
063600                                                                  06360012
063700 9100-EXIT.  EXIT.                                                06370012
063800                                                                  06380012
063900 9999-SQL-ERROR.                                                  06390012
064000                                                                  06400012
064100     COPY DPPD004.                                                06410012
064200                                                                  06420012
064300     MOVE +4013 TO PV-ABEND-CODE.                                 06430012
064400     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         06440012
064500 9999-EXIT.   EXIT.                                               06450012
064600                                                                  06460012
