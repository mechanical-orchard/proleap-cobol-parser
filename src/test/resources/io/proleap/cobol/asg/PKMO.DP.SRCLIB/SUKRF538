000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300 PROGRAM-ID.             SUKRF538.                                00030000
000400 AUTHOR.                 LARRY SCHLEICHER.                        00040000
000500 INSTALLATION.           KOHLS.                                   00050000
000600 DATE-WRITTEN.           JUNE, 1996.                              00060000
000700 DATE-COMPILED.                                                   00070000
000800                                                                  00080000
000900******************************************************************00090000
001000* THIS PROGRAM DISPLAYS THE CARTON AUDIT STATUS SCREEN ON THE     00100000
001100* LRT (LASER RADIO TERMINAL).  IT WILL ACCEPT THE ENTRY OF THE    00110000
001200* CARTON NUMBER OR THE AUDIT NUMBER.                              00120000
001300******************************************************************00130000
001500*---------------------------------------------------------------* 00140000
000510* 11/26/2013  VENKATESH SHANMUGAM 5148D     TKID: TKMAHH5       * 00150000
000520*             ADDED A LOGIC TO DISPLAY THE STATUS OF THE CARTON * 00160000
000560*             FOR RFID AUDIT AND COMBINED AUDIT ALONG WITH QC   * 00170000
      *             AUIDT. THE CARTON STATUS FOR THE COMBINED AUDIT   * 00180000
      *             WILL THE OUTCOME OF THE QC AND RFID STATUS        * 00190000
      *             ASSCOAITED WITH IT.                               * 00200000
000000*             CHANGES TAGGED VSH 11/26/2013                     * 00210000
000510* 01/30/2014  SHOBHIT BAIJAL      5148D     TKID: TKMALR7       * 00220000
000520*             REMOVED LOOKUP OF TSUATRN TABLE AFTER LOOKING UP  * 00230000
000560*             SUT_PO_AUD_REQ FOR AUDIT.                         * 00240000
000000*             CHANGES TAGGED SB  01/30/2014                     * 00250000
001500*---------------------------------------------------------------* 00260000
176459*07/12/2017 JIM ARENDT   CHG0176459                             * 00270093
176459*ADDED CODE TO PROGRAM FOR THE 'RFID TAG YOUR STORE/ SHORT-TERM * 00280093
176459*SOLUTION' PROJECT.                                             * 00290093
263968*---------------------------------------------------------------* 00291095
263968* CHANGED 11/16/2021    BY JIM HUNTER      WR: CHG0263968         00292095
263968* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00293095
263968* MAKING THE CALL DYNAMIC VS STATIC.                              00294095
263968*---------------------------------------------------------------* 00295095
001400******************************************************************00300000
001500 ENVIRONMENT DIVISION.                                            00310000
001600 DATA DIVISION.                                                   00320000
001700******************************************************************00330000
001800******************************************************************00340000
001900 WORKING-STORAGE SECTION.                                         00350000
002000*----------------------------------------------------------------*00360000
002100*  DB2 KEYS                                                      *00370000
002200*----------------------------------------------------------------*00380000
002300 01  DK-DB2-KEYS.                                                 00390000
002400     05  DK-CTN                          PIC S9(18)V COMP-3.      00400000
002500     05  DK-BRCDE-NBR                    PIC  X(22).              00410000
002600     05  DK-AUDIT-CNTL-NBR               PIC S9(09) COMP.         00420000
002700     05  DK-PO                           PIC  S9(09)  COMP.       00430000
002800     05  DK-PO-LNE-NBR                   PIC  S9(09)  COMP.       00440000
002900     05  DK-PO-PREPK-ID                  PIC  S9(04)  COMP.       00450000
      *VSH 11/26/2013 BEGIN - PR5148D                                   00460000
           05  DK-PO-PREPK-ID-RF               PIC  S9(04)  COMP.       00470000
      *VSH 10/26/2013 END - PR5148D                                     00480000
003000     05  DK-RCVR-SEQ-NBR                 PIC  S9(09)  COMP.       00490000
003100     05  DK-OPER-UNT-ID                  PIC  S9(04)  COMP.       00500000
003200     05  DK-PO-DRIVER-LINE               PIC S9(09)  COMP.        00510000
003300                                                                  00520000
003400*----------------------------------------------------------------*00530000
003500*  PROGRAM CONSTANTS                                             *00540000
003600*----------------------------------------------------------------*00550000
003700 01  PC-PROGRAM-CONSTANTS.                                        00560000
003800     05  PC-TRANID                       PIC  X(04)  VALUE 'S538'.00570000
003900     05  PC-RECV                         PIC  X(04)  VALUE 'RECV'.00580000
004000     05  PC-0                            PIC  X(01)  VALUE '0'.   00590000
004100     05  PC-4                            PIC  X(01)  VALUE '4'.   00600000
004200     05  PC-5                            PIC  X(01)  VALUE '5'.   00610000
004300     05  PC-M                            PIC  X(01)  VALUE 'M'.   00620000
004400     05  PC-D                            PIC  X(01)  VALUE 'D'.   00630000
176459     05  PC-P                            PIC  X(01)  VALUE 'P'.   00640093
004500     05  PC-I                            PIC  X(01)  VALUE 'I'.   00650000
004600     05  PC-18                           PIC S9(04)  VALUE 18     00660000
004700                                                     COMP SYNC.   00670000
004800     05  PC-20                           PIC S9(04)  VALUE 20     00680000
004900                                                     COMP SYNC.   00690000
005000     05  PC-9-0                          PIC S9(09)  VALUE 0      00700000
005100                                                     COMP SYNC.   00710000
005200     05  PC-FKEYS                        PIC X(19)   VALUE        00720000
005300                                         'F9 - CHECK IN      '.   00730000
005510     05  PC-LINE-3-OK                    PIC X(16)   VALUE        00740000
005520                                           '#####   #  ##   '.    00750000
005600     05  PC-LINE-4-OK                    PIC X(19)   VALUE        00760000
005700                                        '  ##   ##  ###     '.    00770000
005800     05  PC-LINE-5-OK                    PIC X(19)   VALUE        00780000
005900                                        '  ##   ##  # ##    '.    00790000
006000     05  PC-LINE-6-OK                    PIC X(19)   VALUE        00800000
006100                                        '   #####   #  ##   '.    00810000
006200     05  PC-LINE-3-FAIL                  PIC X(16)   VALUE        00820000
006300                                           '########        '.    00830000
006400     05  PC-LINE-4-FAIL                  PIC X(19)   VALUE        00840000
006500                                        '   ##              '.    00850000
006600     05  PC-LINE-5-FAIL                  PIC X(19)   VALUE        00860000
006700                                        '   ####            '.    00870000
006800     05  PC-LINE-6-FAIL                  PIC X(19)   VALUE        00880000
006900                                        '   ##              '.    00890000
007000     05  PC-LINE-3-UN                    PIC X(16)   VALUE        00900000
007100                                           '   @@   @@      '.    00910000
007200     05  PC-LINE-4-UN                    PIC X(19)   VALUE        00920000
007300                                        '      @@   @@      '.    00930000
007400     05  PC-LINE-5-UN                    PIC X(19)   VALUE        00940000
007500                                        '      @@   @@      '.    00950000
007600     05  PC-LINE-6-UN                    PIC X(19)   VALUE        00960000
007700                                        '      @@@@@@@      '.    00970000
007800*                                                                 00980000
007900     05  PC-LINE-4-UN-QC                 PIC X(19)   VALUE        00990000
008000                                        '      @@ Q @@      '.    01000000
008100     05  PC-LINE-3-PER                   PIC X(16)   VALUE        01010000
008200                                           '        /       '.    01020000
008300     05  PC-LINE-4-PER                   PIC X(19)   VALUE        01030000
008400                                        '    0    /         '.    01040000
008500     05  PC-LINE-5-PER                   PIC X(19)   VALUE        01050000
008600                                        '       /   0       '.    01060000
008700     05  PC-LINE-6-PER                   PIC X(19)   VALUE        01070000
008800                                        '     /             '.    01080000
008900     05  PC-LINE-3-NOTF                  PIC X(16)   VALUE        01090000
009000                                           '  CARTON DATA   '.    01100000
009100     05  PC-LINE-4-NOTF                  PIC X(19)   VALUE        01110000
009200                                        '      NOT FOUND    '.    01120000
009300     05  PC-LINE-5-NOTF                  PIC X(19)   VALUE        01130000
009400                                        '                   '.    01140000
009500     05  PC-LINE-6-NOTF                  PIC X(19)   VALUE        01150000
009600                                        '                   '.    01160000
009700     05  PC-LINE-3-NOPKSL                PIC X(16)   VALUE        01170000
009800                                        'CANNOT DETERMINE'.       01180000
009900     05  PC-LINE-4-NOPKSL                PIC X(19)   VALUE        01190000
010000                                        '      STATUS       '.    01200000
010100     05  PC-LINE-5-NOPKSL                PIC X(19)   VALUE        01210000
010200                                        '   NOT ATTACHED    '.    01220000
010210     05  PC-LINE-6-NOPKSL                PIC X(19)   VALUE        01230000
010220                                        '    TO PACKSLIP    '.    01240000
010230     05  PC-CCC-PGM-LINK-ERR             PIC  X(19)  VALUE        01250000
010240         'LINK ERR - SUKCS769'.                                   01260000
010241     05  PC-RFID-MSG-1                   PIC X(19)   VALUE        01270000
010242                                        '&&&&&&&&&&&&&&&&&&&'.    01280000
010243     05  PC-RFID-MSG-2                   PIC X(19)   VALUE        01290000
010244                                        '&& RF ID NEEDED  &&'.    01300000
176459     05  PC-EAS-MSG-3                    PIC X(19)   VALUE        01310093
176459                                        '&& EAS TAG NEEDED&&'.    01320093
176459     05  PC-RF-EAS-MSG-4                 PIC X(19)   VALUE        01330093
176459                                        '&&EAS/RFID NEEDED&&'.    01340093
010250                                                                  01350000
010260*----------------------------------------------------------------*01360000
010270* PROGRAM NAMES                                                  *01370000
010280*----------------------------------------------------------------*01380000
010290     05  PC-CURRENT-PROGRAM-NAME    PIC  X(08)  VALUE 'SUKRF538'. 01390000
010300     05  PC-SU-MENU-PGM             PIC  X(08)  VALUE 'SUKRF500'. 01400000
010400     05  PC-SU-TRAILER-PGM          PIC  X(08)  VALUE 'SUKRF501'. 01410000
010500     05  PC-SU-SHIP-CODE-PGM        PIC  X(08)  VALUE 'SUKRF502'. 01420000
010600     05  PC-TRIP-START-PGM          PIC  X(08)  VALUE 'SUKRF529'. 01430000
010700     05  PC-LOCATION-MODULE         PIC  X(08)  VALUE 'XLKUT071'. 01440000
010800     05  PC-COMMON-CARTON-CLOSE-PGM PIC  X(08)  VALUE 'SUKCS769'. 01450000
010900                                                                  01460000
011000*----------------------------------------------------------------*01470000
011100* ERROR MESSAGES                                                 *01480000
011200*----------------------------------------------------------------*01490000
011300     05  PC-DB2-DATABASE-ERROR-MSG  PIC X(19) VALUE               01500000
011400                                           'DB2 ACCESS ERROR   '. 01510000
011500     05  PC-CARTON-NOT-FOUND-MSG    PIC X(19) VALUE               01520000
011600                                           'CARTON NOT FOUND   '. 01530000
011700     05  PC-CARTON-NOT              PIC X(16) VALUE               01540000
011800                                              'CARTON NOT      '. 01550000
011900     05  PC-CARTON-CHECKED-IN       PIC X(19) VALUE               01560000
012000                                           '   CHECKED IN      '. 01570000
012100     05  PC-MANUAL-AUDIT            PIC X(16) VALUE               01580000
012200                                              'MANUAL AUDIT    '. 01590000
012300     05  PC-PROCEDURES-APPLY        PIC X(19) VALUE               01600000
012400                                           ' PROCEDURES APPLY  '. 01610000
012500     05  PC-TO-THIS-CARTON          PIC X(19) VALUE               01620000
012600                                           '  TO THIS CARTON   '. 01630000
012700     05  PC-AUDIT-NOT-FOUND-MSG     PIC X(19) VALUE               01640000
012800                                           'AUDIT NOT FOUND    '. 01650000
012900     05  PC-UNRECOGNIZED-PF-KEY-MSG PIC X(19) VALUE               01660000
013000                                           'UNRECOGNIZED PF KEY'. 01670000
013100     05  PC-ENTER-THROUGH-MENU-MSG  PIC X(19) VALUE               01680000
013200                                           'ENTER THROUGH MENU '. 01690000
013300     05  PC-TRANS-UNAVAILABLE-MSG   PIC X(19) VALUE               01700000
013400                                           'TRANS NOT AVAILABLE'. 01710000
013500     05  PC-PLS-ENT-FLD-MSG         PIC X(19) VALUE               01720000
013600                                           'PLEASE ENTER FIELD '. 01730000
013700     05  PC-SCAN-KEY-MSG            PIC X(19) VALUE               01740000
013800                                           'SCAN/KEY CTN/AUDIT#'. 01750000
013900     05  PC-MUST-BE-NUM-MSG         PIC X(19) VALUE               01760000
014000                                           'MUST BE NUMERIC    '. 01770000
014100     05  PC-MUST-BE-GT-0-MSG        PIC X(19) VALUE               01780000
014200                                           'MUST BE > ZERO     '. 01790000
014300     05  PC-FIRST-1-NOT-0-MSG       PIC X(19) VALUE               01800000
014400                                           'FIRST DIGIT NOT 0  '. 01810000
014500                                                                  01820000
014600*----------------------------------------------------------------*01830000
014700*  PROGRAM SWITCHES                                              *01840000
014800*----------------------------------------------------------------*01850000
014900 01  PS-PROGRAM-SWITCHES.                                         01860000
015000     05  PS-PRE-PACK-ID-SW               PIC  X(01)  VALUE 'N'.   01870000
015100         88  PS-PRE-PACK-ID                          VALUE 'Y'.   01880000
015200         88  PS-NO-PRE-PACK-ID                       VALUE 'N'.   01890000
015300     05  PS-OPER-IS-ECOMM-DC-SW          PIC  X(01)  VALUE 'N'.   01900000
015400         88  PS-OPER-NOT-ECOMM-DC                    VALUE 'N'.   01910000
015500         88  PS-OPER-IS-ECOMM-DC                     VALUE 'Y'.   01920000
015600     05  PS-ERROR-SW                     PIC  X(01)  VALUE  'N'.  01930000
015700         88  PS-ERROR                                VALUE  'Y'.  01940000
015800         88  PS-NO-ERROR                             VALUE  'N'.  01950000
015900     05  PS-CARTON-DATA-NOT-FOUND-SW     PIC  X(01)  VALUE 'N'.   01960000
016000         88  PS-CARTON-DATA-NOT-FOUND                VALUE 'Y'.   01970000
016100         88  PS-CARTON-DATA-IS-FOUND                 VALUE 'N'.   01980000
016200     05  PS-VALID-INPUT-SW               PIC  X(01)  VALUE 'Y'.   01990000
016300         88  PS-VALID-INPUT                          VALUE 'Y'.   02000000
016400         88  PS-INVALID-INPUT                        VALUE 'N'.   02010000
016500     05  PS-AUDIT-NBR-IND                PIC  X(01)  VALUE 'N'.   02020000
016600         88  PS-AUDIT-NBR-NOT-EXISTS                 VALUE 'N'.   02030000
016700         88  PS-AUDIT-NBR-EXISTS                     VALUE 'Y'.   02040000
      *VSH 11/26/2013 BEGIN - PR5148D                                   02050000
           05  PS-RF-AUDIT-NBR-IND             PIC  X(01)  VALUE 'N'.   02060000
               88  PS-RF-AUDIT-NBR-NOT-EXISTS              VALUE 'N'.   02070000
               88  PS-RF-AUDIT-NBR-EXISTS                  VALUE 'Y'.   02080000
      *VSH 10/26/2013 END - PR5148D                                     02090000
016800     05  PS-NOT-FOUND-SW                 PIC  X(01)  VALUE 'Y'.   02100000
016900         88  PS-FOUND                                VALUE 'Y'.   02110000
017000         88  PS-NOT-FOUND                            VALUE 'N'.   02120000
017100     05  PS-NOT-MANUAL-AUDIT-SW          PIC  X(01)  VALUE 'N'.   02130000
017200         88  PS-MANUAL-AUDIT                         VALUE 'Y'.   02140000
017300         88  PS-NOT-MANUAL-AUDIT                     VALUE 'N'.   02150000
017400     05  PS-SCANNED-DATA-IND             PIC  X(01)  VALUE 'Y'.   02160000
017500         88  PS-NOT-SCANNED-DATA                     VALUE 'N'.   02170000
017600         88  PS-SCANNED-DATA                         VALUE 'Y'.   02180000
017700     05  PS-CARTON-EXISTS-SW             PIC  X(01)  VALUE 'N'.   02190000
017800         88  PS-CARTON-EXISTS                        VALUE 'Y'.   02200000
017900         88  PS-CARTON-DOESNT-EXIST                  VALUE 'N'.   02210000
018000     05  PS-DISTRO-EXISTS-SW             PIC  X(01)  VALUE 'N'.   02220000
018100         88  PS-DISTRO-EXISTS                        VALUE 'Y'.   02230000
018200         88  PS-DISTRO-DOESNT-EXIST                  VALUE 'N'.   02240000
018300     05  PS-PACKSLIP-EXISTS-SW           PIC  X(01)  VALUE 'N'.   02250000
018400         88  PS-PACKSLIP-EXISTS                      VALUE 'Y'.   02260000
018500         88  PS-PACKSLIP-DOESNT-EXIST                VALUE 'N'.   02270000
018600     05  PS-ATTACHED-TO-PKSLIP-SW        PIC  X(01)  VALUE 'Y'.   02280000
018700         88  PS-ATTACHED-TO-PKSLIP                   VALUE 'Y'.   02290000
018800         88  PS-NOT-ATTACHED-TO-PKSLIP               VALUE 'N'.   02300000
018900     05  PS-CARTON-CHECKED-IN-SW         PIC  X(01)  VALUE ' '.   02310000
019000         88  PS-CARTON-CHECKED-IN                    VALUE 'Y'.   02320000
019100         88  PS-CARTON-NOT-CHECKED-IN                VALUE 'N'.   02330000
019200     05  PS-100-PERCENT-SW               PIC  X(01)  VALUE 'N'.   02340000
019300         88  PS-100-PERCENT                          VALUE 'Y'.   02350000
019400         88  PS-NOT-100-PERCENT                      VALUE 'N'.   02360000
019500     05  PS-TRNGLE-TRANS-SW              PIC  X(01)  VALUE 'N'.   02370000
019600         88  PS-TRNGLE-TRANS                         VALUE 'Y'.   02380000
019700         88  PS-NOT-TRNGLE-TRANS                     VALUE 'N'.   02390000
019800     05  PS-SELECTED-CARTON-SW           PIC  X(01)  VALUE 'N'.   02400000
019810         88  PS-SELECTED-CARTON-YES                  VALUE 'Y'.   02410000
019820         88  PS-SELECTED-CARTON-NO                   VALUE 'N'.   02420000
019821     05  PS-RFID-DIRECTIVE-SW            PIC  X(01)  VALUE 'N'.   02430000
019822         88  PS-RFID-DIRECTIVE-YES                   VALUE 'Y'.   02440000
019823         88  PS-RFID-DIRECTIVE-NO                    VALUE 'N'.   02450000
      *VSH 11/26/2013 BEGIN - PR5148D                                   02460000
           05  ASC-TBL-CART-COMBINED           PIC  X(01)  VALUE 'N'.   02470000
               88 ASC-COMBINED-YES                         VALUE 'Y'.   02480000
               88 ASC-COMBINED-NO                          VALUE 'N'.   02490000
      *VSH 10/26/2013 END - PR5148D                                     02500000
176459     05  PS-RFID-ON-LABEL-SW             PIC  X(01)  VALUE 'N'.   02510093
176459         88  PS-RFID-ON-LABEL-YES                    VALUE 'Y'.   02520093
176459         88  PS-RFID-ON-LABEL-NO                     VALUE 'N'.   02530093
176459     05  PS-RFID-FAILED-SW               PIC  X(01)  VALUE 'N'.   02540093
176459         88  PS-RFID-FAILED-YES                      VALUE 'Y'.   02550093
176459         88  PS-RFID-FAILED-NO                       VALUE 'N'.   02560093
019830                                                                  02570000
019840*----------------------------------------------------------------*02580000
019850*  PROGRAM VARIABLES                                             *02590000
019860*----------------------------------------------------------------*02600000
019870 01  PV-PROGRAM-VARIABLES.                                        02610000
019880     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     02620000
019890                                                     COMP SYNC.   02630000
019900     05  PV-AUDIT-MSG.                                            02640000
      *VSH 11/26/2013 BEGIN - PR5148D                                   02650000
               10  PV-AUDIT-NM                 PIC X(03).               02660000
               10  FILLER                      PIC X(01) VALUE ':'.     02670000
               10  PV-AUDIT-MSG-NBR            PIC 9(09).               02680000
               10  FILLER                      PIC X(01) VALUE '-'.     02690000
               10  PV-AUDIT-STATUS             PIC X(01).               02700000
      *VSH 10/26/2013 END - PR5148D                                     02710000
020300     05  PV-CTN-REDEF                    PIC 9(18).               02720000
020400     05  PV-CTN-REDEF-X REDEFINES PV-CTN-REDEF PIC X(18).         02730000
020500     05  PV-PO-REDEF                     PIC 9(09).               02740000
020600     05  PV-PO-REDEF-X REDEFINES PV-PO-REDEF PIC X(09).           02750000
020700     05  PV-RECEIVER-REDEF               PIC 9(09).               02760000
020800     05  PV-RECEIVER-REDEF-X REDEFINES PV-RECEIVER-REDEF          02770000
020900                                         PIC X(09).               02780000
021000     05  PV-PO-LINE-REDEF                PIC 9(09).               02790000
021100     05  PV-PO-LINE-REDEF-X REDEFINES PV-PO-LINE-REDEF            02800000
021200                                         PIC X(09).               02810000
021300     05  PV-REC-SEQ-REDEF                PIC 9(09).               02820000
021400     05  PV-REC-SEQ-REDEF-X REDEFINES PV-REC-SEQ-REDEF            02830000
021500                                         PIC X(09).               02840000
021600     05  PC-SML-BARCODE                  PIC 9(18) VALUE ZEROS.   02850000
021700     05  PC-SML-BARCODE-R         REDEFINES PC-SML-BARCODE        02860000
021800                                         PIC  X(18).              02870000
021900     05  PV-MESSAGE-AREA                 PIC  X(19)  VALUE SPACE. 02880000
022000     05  PV-CICS-RESPONSE                PIC S9(09)  VALUE ZEROS  02890000
022100                                                     COMP SYNC.   02900000
022200     05  PV-TRANSFER-PROGRAM             PIC  X(08)  VALUE SPACE. 02910000
022300     05  PV-CHAR-COUNT                   PIC S9(04)  VALUE ZEROS  02920000
022400                                                     COMP SYNC.   02930000
022500                                                                  02940000
022600     05  PV-DISPLAY-CARTON               PIC  9(18) VALUE ZEROES. 02950000
022700     05  PV-DISP-AUDIT-CNTL-NBR          PIC  9(09) VALUE ZEROES. 02960000
022800     05  PV-DISPLAY-OPER-UNT-ID          PIC  9(04) VALUE ZEROES. 02970000
022900     05  PV-PROGRAM-DATA.                                         02980000
023000         10  PV-CTN.                                              02990000
023100             15  PV-CTN-FIRST-DIGIT      PIC  X(01).              03000000
023200             15  PV-CTN-LAST-17          PIC  X(17).              03010000
023300             15  PV-CTN-FILLER           PIC  X(04).              03020000
023400         10  FILLER REDEFINES PV-CTN.                             03030000
023500             15  PV-CTN-SCAN-00          PIC  X(02).              03040000
023600             15  PV-CTN-SCAN-THIRD-DGT   PIC  X(01).              03050000
023700             15  PV-CTN-SCAN-LAST-17     PIC  X(17).              03060000
023800             15  PV-CTN-SCAN-LAST-2      PIC  X(02).              03070000
023900         10  FILLER REDEFINES PV-CTN.                             03080000
024000             15  PV-CTN-SCAN-00          PIC  X(02).              03090000
024100             15  PV-CTN-SCAN-LAST-18     PIC  X(18).              03100000
024200             15  PV-CTN-SCAN-LST-2       PIC  X(02).              03110000
024300                                                                  03120000
024400     05  PV-SUB1                         PIC S9(4) COMP SYNC.     03130000
024500     05  PV-SUB2                         PIC S9(4) COMP SYNC.     03140000
024600                                                                  03150000
024700     05  PV-INPUT-FIELD                  PIC X(22).               03160000
024800     05  FILLER REDEFINES PV-INPUT-FIELD.                         03170000
024900         10  PV-INPUT-BYTES OCCURS 22 TIMES.                      03180000
025000             15  PV-IN-BYTE              PIC X(01).               03190000
025100                                                                  03200000
025200     05  PV-OUTPUT-FIELD                 PIC X(22).               03210000
025300     05  FILLER REDEFINES PV-OUTPUT-FIELD.                        03220000
025400         10  PV-OUTPUT-BYTE OCCURS 22 TIMES.                      03230000
025500             15  PV-OUT-BYTE             PIC X(01).               03240000
      *VSH 11/26/2013 BEGIN - PR5148D                                   03250000
           05  ASC-RF-AUD-CNTL-NBR             PIC  S9(9) COMP.         03260000
           05  ASC-RF-AUD-STAT-CDE             PIC   X(1).              03270000
           05  ASC-AUD-CNTL-NBR                PIC  S9(9) COMP.         03280000
           05  ASC-AUD-STAT-CDE                PIC   X(1).              03290000
           05  ASC-RF-AUD-TYP-CDE              PIC   X(1).              03300000
           05  ASC-AUD-TYP-CDE                 PIC   X(1).              03310000
      *VSH 10/26/2013 END - PR5148D                                     03320000
025600*                                                                 03330000
025700                                                                  03340000
025800*----------------------------------------------------------------*03350000
025900*  GENERATED DSECT FOR THE SUKM538 MAPSET                         03360000
026000*----------------------------------------------------------------*03370000
026100     COPY SUKM538.                                                03380000
026200                                                                  03390000
026300* HELP SCREEN COMMAREA                                            03400000
026400     COPY PCWS192.                                                03410000
026500* HELP SCREEN WORK AREA                                           03420000
026600     COPY PCWS188.                                                03430000
026700                                                                  03440000
026800*----------------------------------------------------------------*03450000
026900*  SENDING/RECEIVING AREA FOR THE NUMERIC EDIT ROUTINE (DPKUT100) 03460000
027000*----------------------------------------------------------------*03470000
027100     COPY DPWS010I.                                               03480000
027200                                                                  03490000
027300*----------------------------------------------------------------*03500000
027400*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST   03510000
027500*----------------------------------------------------------------*03520000
027600     COPY DPWS015.                                                03530000
027700                                                                  03540000
027800*----------------------------------------------------------------*03550000
027900*  WORKING STORAGE AREA FOR NON-ARCHITECTURE PROGRAMS             03560000
028000*----------------------------------------------------------------*03570000
028100     COPY DPWS026.                                                03580000
028200                                                                  03590000
028300*----------------------------------------------------------------*03600000
028400*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      03610000
028500*----------------------------------------------------------------*03620000
028600     COPY DFHAID.                                                 03630000
028700                                                                  03640000
028800*----------------------------------------------------------------*03650000
028900 01  CA-COMMAREA.                                                 03660000
029000*----------------------------------------------------------------*03670000
029100*  COMMAREA LAYOUT FOR THE PACK BY STORE AUDIT PROJECT           *03680000
029200*----------------------------------------------------------------*03690000
029300     COPY SUWS001.                                                03700000
029400                                                                  03710000
029500*----------------------------------------------------------------*03720000
029600*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               03730000
029700*----------------------------------------------------------------*03740000
029800     COPY DPWS013.                                                03750000
029900                                                                  03760000
030000*----------------------------------------------------------------*03770000
030100*  LOCATION MODULE ACCESS COPYBOOK.                               03780000
030110*----------------------------------------------------------------*03790000
030120     COPY XLWS071.                                                03800000
030130                                                                  03810000
030140*----------------------------------------------------------------*03820000
030150 01  CA-COMMAREA-CRTN-AUD.                                        03830000
030160*----------------------------------------------------------------*03840000
030170*  COMMAREA LAYOUT FOR THE PACK BY STORE AUDIT PROJECT           *03850000
030180*----------------------------------------------------------------*03860000
030190     COPY SUWS006.                                                03870000
030200                                                                  03880000
030300******************************************************************03890000
030400*  COPY BOOK CONTAINING ERROR/WARNING/INFORMATIONAL MESSAGES      03900000
030500*  TO BE DISPLAYED ON THE LRT                                     03910000
030600******************************************************************03920000
030700     COPY SUWS005.                                                03930000
030800                                                                  03940000
030900*----------------------------------------------------------------*03950000
031000* COMMAREA USED TO PASS DATA TO AND FROM SUKCS769                 03960000
031100* COMMON CARTON CLOSE MODULE FOR SENDING DIRECTIVES               03970000
031200*----------------------------------------------------------------*03980000
031300     COPY SUWS091.                                                03990000
031400                                                                  04000000
176459*----------------------------------------------------------------*04010093
176459*  RECORD LAYOUTS FOR RFID DETERMINATION MODULE                   04020093
176459*----------------------------------------------------------------*04030093
176459     COPY SUWS093.                                                04040093
                                                                        04050058
031500*----------------------------------------------------------------*04060000
031600*  DCLGEN LAYOUT AND COBOL DECLARATION                           *04070000
031700*----------------------------------------------------------------*04080000
031800     EXEC SQL                                                     04090000
031900         INCLUDE TRECITM                                          04100000
032000     END-EXEC.                                                    04110000
032100                                                                  04120000
032200*---------------------------------------------------------------* 04130000
032300*    DB2 AREA FOR THE SHIPPING UNIT AUDIT TRANSACTION TABLE     * 04140000
032400*---------------------------------------------------------------* 04150000
032500     EXEC SQL                                                     04160000
032600         INCLUDE TSUATRN                                          04170000
032700     END-EXEC.                                                    04180000
032800*----------------------------------------------------------------*04190000
032900*  DCLGEN LAYOUT AND COBOL DECLARATION                           *04200000
033000*----------------------------------------------------------------*04210000
033100     EXEC SQL                                                     04220000
033200         INCLUDE TSULBXF                                          04230000
033300     END-EXEC.                                                    04240000
033400                                                                  04250000
033500*----------------------------------------------------------------*04260000
033600*  DCLGEN LAYOUT AND COBOL DECLARATION                           *04270000
033700*----------------------------------------------------------------*04280000
033800     EXEC SQL                                                     04290000
033900         INCLUDE TDISTHD                                          04300000
034000     END-EXEC.                                                    04310000
034100                                                                  04320000
034200*---------------------------------------------------------------* 04330000
034300*    DB2 AREA FOR THE PO AUDIT EXC TABLE (SUT_PO_AUD_EXC)       * 04340000
034400*---------------------------------------------------------------* 04350000
034500     EXEC SQL                                                     04360000
034600         INCLUDE SUT00014                                         04370000
034700     END-EXEC.                                                    04380000
034800*---------------------------------------------------------------* 04390000
034900*    DB2 AREA FOR THE PO AUDIT REQUEST TABLE (SUT_PO_AUD_REQ)   * 04400000
035000*---------------------------------------------------------------* 04410000
035100     EXEC SQL                                                     04420000
035200         INCLUDE SUT00015                                         04430000
035300     END-EXEC.                                                    04440000
035400*----------------------------------------------------------------*04450000
035500*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPMENT UNIT      04460000
035600*  LOCATION TABLE                                                 04470000
035700*----------------------------------------------------------------*04480000
035800     EXEC SQL                                                     04490000
035900         INCLUDE TSHUNLO                                          04500000
036000     END-EXEC.                                                    04510000
036100                                                                  04520000
036200*----------------------------------------------------------------*04530000
036300*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      04540000
036400*  TABLE                                                          04550000
036500*----------------------------------------------------------------*04560000
036600     EXEC SQL                                                     04570000
036700         INCLUDE TSHPUNT                                          04580000
036800     END-EXEC.                                                    04590000
036900                                                                  04600000
037000*----------------------------------------------------------------*04610000
037100*  DCLGEN LAYOUT AND COBOL DECLARATION                           *04620000
037200*----------------------------------------------------------------*04630000
037300     EXEC SQL                                                     04640000
037400         INCLUDE TRECEIV                                          04650000
037500     END-EXEC.                                                    04660000
037600                                                                  04670000
037700*----------------------------------------------------------------*04680000
037800*  DCLGEN LAYOUT AND COBOL DECLARATION                           *04690000
037900*----------------------------------------------------------------*04700000
038000     EXEC SQL                                                     04710000
038100         INCLUDE TPKSLIP                                          04720000
038200     END-EXEC.                                                    04730000
038300                                                                  04740000
038400*----------------------------------------------------------------*04750000
038500*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE INBOUND EDI PACKSLI04760000
038600*  VENDOR SHIPMENT UNIT ASSOCIATION TABLE                         04770000
038700*----------------------------------------------------------------*04780000
038800     EXEC SQL                                                     04790000
038900         INCLUDE TINPKSU                                          04800000
039000     END-EXEC.                                                    04810000
039100                                                                  04820000
039210*----------------------------------------------------------------*04830000
039220*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SUT_CART_DIRV_TRKG 04840000
039230*  CARTON DIRECTIVE TRACKING TABLE                                04850000
039240*----------------------------------------------------------------*04860000
039250     EXEC SQL                                                     04870000
039260         INCLUDE SUT00102                                         04880000
039270     END-EXEC.                                                    04890000
039280                                                                  04900000
039290*----------------------------------------------------------------*04910000
039300*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT UPC  04920000
039400*  TABLE                                                          04930000
039500*----------------------------------------------------------------*04940000
039600     EXEC SQL                                                     04950000
039700         INCLUDE TSHUUPC                                          04960000
039800     END-EXEC.                                                    04970000
039900                                                                  04980000
040000*----------------------------------------------------------------*04990000
040100*  COMMUNICATIONS AREA FOR DB2                                    05000000
040200*----------------------------------------------------------------*05010000
040300     EXEC SQL                                                     05020000
040400         INCLUDE SQLCA                                            05030000
040500     END-EXEC.                                                    05040000
040600***************************************************************** 05050000
040700 LINKAGE SECTION.                                                 05060000
040800******************************************************************05070000
040900 01  DFHCOMMAREA.                                                 05080000
041000     05  FILLER                       OCCURS 1 TO 4072 TIMES      05090000
041100                                      DEPENDING ON EIBCALEN.      05100000
041200         10  FILLER                   PIC X.                      05110000
041300                                                                  05120000
041400******************************************************************05130000
041500 PROCEDURE DIVISION.                                              05140000
041600******************************************************************05150000
041700 0000-PROGRAM-MAINLINE.                                           05160000
041800                                                                  05170000
041900     MOVE DFHCOMMAREA TO CA-COMMAREA.                             05180000
042000                                                                  05190000
042100     EVALUATE TRUE                                                05200000
042200         WHEN EIBCALEN = ZERO                                     05210000
042300             MOVE PC-ENTER-THROUGH-MENU-MSG TO PV-MESSAGE-AREA    05220000
042400             PERFORM 8300-RETURN                                  05230000
042500                                                                  05240000
042600         WHEN EIBTRNID = 'Z278'                                   05250000
042700             MOVE DFHCOMMAREA         TO PC192-COMMAREA           05260000
042800             MOVE PC192-HOST-SAVE-AREA                            05270000
042900                                      TO CA-COMMAREA              05280000
043000             SET SU001-PROCESS-SCREEN TO TRUE                     05290000
043100             MOVE PC192-HOST-SAVE-MAP TO SU538AO                  05300000
043200             PERFORM 1000-INITIALIZE                              05310000
043300             PERFORM 8000-SEND-MAP                                05320000
043400             PERFORM 8200-RETURN-TRANID                           05330000
043500                                                                  05340000
043600         WHEN SU001-INITIALIZE-SCREEN                             05350000
043700         WHEN EIBAID = DFHCLEAR                                   05360000
043800             SET SU001-PROCESS-SCREEN TO TRUE                     05370000
043900             PERFORM 1000-INITIALIZE                              05380000
044000             PERFORM 8000-SEND-MAP                                05390000
044100             PERFORM 8200-RETURN-TRANID                           05400000
044200                                                                  05410000
044300         WHEN EIBAID = DFHENTER                                   05420000
044400             SET PS-VALID-INPUT TO TRUE                           05430000
044500             PERFORM 2000-PROCESS-SCREEN-FIELDS                   05440000
044600                                                                  05450000
044610             PERFORM 3670-CHECK-CURRENT-DIRECTIVE                 05460000
044700             EVALUATE TRUE                                        05470000
044800                 WHEN PS-INVALID-INPUT                            05480000
044900                     PERFORM 1000-INITIALIZE                      05490000
045000                     PERFORM 8000-SEND-MAP                        05500000
045100                     PERFORM 8200-RETURN-TRANID                   05510000
045200                                                                  05520000
045300                 WHEN PS-MANUAL-AUDIT                             05530000
045400                     MOVE SPACES                   TO AMSGLNO     05540000
045500                     MOVE PC-MANUAL-AUDIT          TO ALINE3O     05550000
045600                     MOVE PC-PROCEDURES-APPLY      TO ALINE4O     05560000
045700                     MOVE PC-TO-THIS-CARTON        TO ALINE5O     05570000
045800                     MOVE SPACES                   TO ALINE6O     05580000
045801                     MOVE SPACES                   TO ALINE7O     05590000
046000                 WHEN PS-NOT-ATTACHED-TO-PKSLIP                   05600000
046100                     MOVE SPACES                   TO AMSGLNO     05610000
046200                     MOVE PC-LINE-3-NOPKSL         TO ALINE3O     05620000
046300                     MOVE PC-LINE-4-NOPKSL         TO ALINE4O     05630000
046400                     MOVE PC-LINE-5-NOPKSL         TO ALINE5O     05640000
046500                     MOVE PC-LINE-6-NOPKSL         TO ALINE6O     05650000
046600                                                                  05660000
046700                 WHEN PS-CARTON-DATA-NOT-FOUND                    05670000
046800                     MOVE SPACES                   TO AMSGLNO     05680000
046900                     MOVE PC-LINE-3-NOTF           TO ALINE3O     05690000
047000                     MOVE PC-LINE-4-NOTF           TO ALINE4O     05700000
047100                     MOVE PC-LINE-5-NOTF           TO ALINE5O     05710000
047200                     MOVE PC-LINE-6-NOTF           TO ALINE6O     05720000
047300                                                                  05730000
047400                 WHEN PS-CARTON-NOT-CHECKED-IN                    05740000
047500                     MOVE SPACES                   TO AMSGLNO     05750000
047600                     MOVE PC-CARTON-NOT            TO ALINE3O     05760000
047700                     MOVE PC-CARTON-CHECKED-IN     TO ALINE4O     05770000
047800                     MOVE SPACES                   TO ALINE5O     05780000
047900                                                      ALINE6O     05790000
048000                 WHEN PS-CARTON-DOESNT-EXIST                      05800000
048100                     IF PS-AUDIT-NBR-NOT-EXISTS AND               05810000
      *VSH 11/26/2013 BEGIN - PR5148D                                   05820000
                              PS-RF-AUDIT-NBR-NOT-EXISTS                05830000
      *VSH 10/26/2013 END - PR5148D                                     05840000
048200                         MOVE PC-AUDIT-NOT-FOUND-MSG  TO AMSGLNO  05850000
048300                         MOVE SPACES         TO ALINE3O           05860000
048400                                                ALINE4O           05870000
048500                                                ALINE5O           05880000
048600                                                ALINE6O           05890000
048700                     ELSE                                         05900000
048800                         MOVE PC-CARTON-NOT-FOUND-MSG TO AMSGLNO  05910000
048900                         MOVE SPACES         TO ALINE3O           05920000
049000                                                ALINE4O           05930000
049100                                                ALINE5O           05940000
049200                                                ALINE6O           05950000
049300                     END-IF                                       05960000
049400                                                                  05970000
049500                 WHEN PS-AUDIT-NBR-EXISTS AND                     05980000
      *VSH 11/26/2013 BEGIN - PR5148D                                   05990000
                            PS-RF-AUDIT-NBR-NOT-EXISTS                  06000000
                                                                        06010000
                         MOVE 'QC'             TO PV-AUDIT-NM           06020000
    10                   MOVE ASC-AUD-CNTL-NBR TO PV-AUDIT-MSG-NBR      06030000
                         MOVE ASC-AUD-STAT-CDE TO PV-AUDIT-STATUS       06040000
    20                   MOVE PV-AUDIT-MSG   TO AMSGLNO                 06050000
      *VSH 10/26/2013 END - PR5148D                                     06060000
                                                                        06070000
049530                   EVALUATE TRUE                                  06080000
049540                       WHEN ASC-AUD-STAT-CDE = 'P'                06090000
049550                           MOVE PC-LINE-3-OK   TO ALINE3O         06100000
049560                           MOVE PC-LINE-4-OK   TO ALINE4O         06110000
049570                           MOVE PC-LINE-5-OK   TO ALINE5O         06120000
049580                           MOVE PC-LINE-6-OK   TO ALINE6O         06130000
049590                                                                  06140000
049600                       WHEN ASC-AUD-STAT-CDE = 'N'                06150000
049700                           PERFORM 3700-LINK-COMMON-CARTON-CLOSE  06160000
049800                           MOVE PC-LINE-3-OK   TO ALINE3O         06170000
049900                           MOVE PC-LINE-4-OK   TO ALINE4O         06180000
050000                           MOVE PC-LINE-5-OK   TO ALINE5O         06190000
050100                           MOVE PC-LINE-6-OK   TO ALINE6O         06200000
050200                                                                  06210000
050300                       WHEN ASC-AUD-STAT-CDE = 'F'                06220000
050400                           MOVE PC-LINE-3-FAIL TO ALINE3O         06230000
050500                           MOVE PC-LINE-4-FAIL TO ALINE4O         06240000
050600                           MOVE PC-LINE-5-FAIL TO ALINE5O         06250000
050700                           MOVE PC-LINE-6-FAIL TO ALINE6O         06260000
050800                                                                  06270000
050900                       WHEN ASC-AUD-STAT-CDE = 'I'                06280000
051000                           SET PS-SELECTED-CARTON-NO TO TRUE      06290000
051010                           PERFORM 3600-SELECT-TSUATRN            06300000
051020                           IF PS-SELECTED-CARTON-NO               06310000
051030                              MOVE PC-LINE-3-UN   TO ALINE3O      06320000
051040                              MOVE PC-LINE-4-UN   TO ALINE4O      06330000
051050                              MOVE PC-LINE-5-UN   TO ALINE5O      06340000
051060                              MOVE PC-LINE-6-UN   TO ALINE6O      06350000
051070                           ELSE                                   06360000
051080                              MOVE PC-LINE-3-UN    TO ALINE3O     06370000
051090                              MOVE PC-LINE-4-UN-QC TO ALINE4O     06380000
051100                              MOVE PC-LINE-5-UN    TO ALINE5O     06390000
051200                              MOVE PC-LINE-6-UN    TO ALINE6O     06400000
051300                           END-IF                                 06410000
051400                   END-EVALUATE                                   06420000
                                                                        06430000
      *VSH 11/26/2013 BEGIN - PR5148D                                   06440000
     0                 WHEN PS-RF-AUDIT-NBR-EXISTS AND                  06450000
                            PS-AUDIT-NBR-NOT-EXISTS                     06460000
                         MOVE 'RF'             TO PV-AUDIT-NM           06470000
    10                   MOVE ASC-RF-AUD-CNTL-NBR TO PV-AUDIT-MSG-NBR   06480000
                         MOVE ASC-RF-AUD-STAT-CDE TO PV-AUDIT-STATUS    06490000
    20                   MOVE PV-AUDIT-MSG   TO AMSGL1O                 06500000
                                                                        06510000
049530                   EVALUATE TRUE                                  06520000
049540                       WHEN ASC-RF-AUD-STAT-CDE = 'P'             06530000
049550                           MOVE PC-LINE-3-OK   TO ALINE3O         06540000
049560                           MOVE PC-LINE-4-OK   TO ALINE4O         06550000
049570                           MOVE PC-LINE-5-OK   TO ALINE5O         06560000
049580                           MOVE PC-LINE-6-OK   TO ALINE6O         06570000
049590                                                                  06580000
049600                       WHEN ASC-RF-AUD-STAT-CDE = 'N'             06590000
049700                           PERFORM 3700-LINK-COMMON-CARTON-CLOSE  06600000
049800                           MOVE PC-LINE-3-OK   TO ALINE3O         06610000
049900                           MOVE PC-LINE-4-OK   TO ALINE4O         06620000
050000                           MOVE PC-LINE-5-OK   TO ALINE5O         06630000
050100                           MOVE PC-LINE-6-OK   TO ALINE6O         06640000
050200                                                                  06650000
050300                       WHEN ASC-RF-AUD-STAT-CDE = 'F'             06660000
050400                           MOVE PC-LINE-3-FAIL TO ALINE3O         06670000
050500                           MOVE PC-LINE-4-FAIL TO ALINE4O         06680000
050600                           MOVE PC-LINE-5-FAIL TO ALINE5O         06690000
050700                           MOVE PC-LINE-6-FAIL TO ALINE6O         06700000
050800                                                                  06710000
050900                       WHEN ASC-RF-AUD-STAT-CDE = 'I'             06720000
051030                              MOVE PC-LINE-3-UN   TO ALINE3O      06730000
051040                              MOVE PC-LINE-4-UN   TO ALINE4O      06740000
051050                              MOVE PC-LINE-5-UN   TO ALINE5O      06750000
051060                              MOVE PC-LINE-6-UN   TO ALINE6O      06760000
051400                   END-EVALUATE                                   06770000
                                                                        06780000
049500                 WHEN PS-AUDIT-NBR-EXISTS AND                     06790000
                            PS-RF-AUDIT-NBR-EXISTS                      06800000
                                                                        06810000
                         MOVE 'RF'             TO PV-AUDIT-NM           06820000
    10                   MOVE ASC-RF-AUD-CNTL-NBR TO PV-AUDIT-MSG-NBR   06830000
                         MOVE ASC-RF-AUD-STAT-CDE TO PV-AUDIT-STATUS    06840000
    20                   MOVE PV-AUDIT-MSG   TO AMSGL1O                 06850000
                                                                        06860000
                         MOVE 'QC'             TO PV-AUDIT-NM           06870000
    10                   MOVE ASC-AUD-CNTL-NBR TO PV-AUDIT-MSG-NBR      06880000
                         MOVE ASC-AUD-STAT-CDE TO PV-AUDIT-STATUS       06890000
    20                   MOVE PV-AUDIT-MSG   TO AMSGLNO                 06900000
                                                                        06910000
049530                   EVALUATE TRUE                                  06920000
049540                       WHEN ASC-AUD-STAT-CDE = 'P' AND            06930000
                                  ASC-RF-AUD-STAT-CDE = 'P'             06940000
049550                           MOVE PC-LINE-3-OK   TO ALINE3O         06950000
049560                           MOVE PC-LINE-4-OK   TO ALINE4O         06960000
049570                           MOVE PC-LINE-5-OK   TO ALINE5O         06970000
049580                           MOVE PC-LINE-6-OK   TO ALINE6O         06980000
049590                                                                  06990000
049600                       WHEN ((ASC-AUD-STAT-CDE = 'P' AND          07000000
                                  ASC-RF-AUD-STAT-CDE = 'N') OR         07010000
049600                            (ASC-AUD-STAT-CDE = 'N' AND           07020000
                                  ASC-RF-AUD-STAT-CDE = 'P') OR         07030000
049600                            (ASC-AUD-STAT-CDE = 'N' AND           07040000
                                  ASC-RF-AUD-STAT-CDE = 'N'))           07050000
                                  IF ASC-AUD-STAT-CDE = 'N'             07060000
                                     MOVE ASC-AUD-CNTL-NBR TO           07070000
                                          SUT00015-AUD-CNTL-NBR         07080000
                                     MOVE ASC-AUD-STAT-CDE TO           07090000
                                          SUT00015-AUD-STAT-CDE         07100000
                                  ELSE                                  07110000
                                    IF  ASC-RF-AUD-STAT-CDE = 'N'       07120000
                                        MOVE ASC-RF-AUD-CNTL-NBR TO     07130000
                                             SUT00015-AUD-CNTL-NBR      07140000
                                        MOVE ASC-RF-AUD-STAT-CDE TO     07150000
                                             SUT00015-AUD-STAT-CDE      07160000
                                    END-IF                              07170000
                                  END-IF                                07180000
049700                           PERFORM 3700-LINK-COMMON-CARTON-CLOSE  07190000
049800                           MOVE PC-LINE-3-OK   TO ALINE3O         07200000
049900                           MOVE PC-LINE-4-OK   TO ALINE4O         07210000
050000                           MOVE PC-LINE-5-OK   TO ALINE5O         07220000
050100                           MOVE PC-LINE-6-OK   TO ALINE6O         07230000
050200                                                                  07240000
050300                       WHEN ((ASC-AUD-STAT-CDE = 'F' AND          07250000
                                  ASC-RF-AUD-STAT-CDE = 'F') OR         07260000
                                  (ASC-AUD-STAT-CDE = 'F' AND           07270000
                                  ASC-RF-AUD-STAT-CDE = 'P') OR         07280000
                                  (ASC-AUD-STAT-CDE = 'P' AND           07290000
                                  ASC-RF-AUD-STAT-CDE = 'F') OR         07300000
                                  (ASC-AUD-STAT-CDE = 'I' AND           07310000
                                  ASC-RF-AUD-STAT-CDE = 'F') OR         07320000
                                  (ASC-AUD-STAT-CDE = 'F' AND           07330000
                                  ASC-RF-AUD-STAT-CDE = 'I'))           07340000
050400                           MOVE PC-LINE-3-FAIL TO ALINE3O         07350000
050500                           MOVE PC-LINE-4-FAIL TO ALINE4O         07360000
050600                           MOVE PC-LINE-5-FAIL TO ALINE5O         07370000
050700                           MOVE PC-LINE-6-FAIL TO ALINE6O         07380000
050800                                                                  07390000
050900                       WHEN ((ASC-AUD-STAT-CDE = 'I' AND          07400000
                                  ASC-RF-AUD-STAT-CDE = 'P') OR         07410000
                                  (ASC-AUD-STAT-CDE = 'P' AND           07420000
                                  ASC-RF-AUD-STAT-CDE = 'I') OR         07430000
                                  (ASC-AUD-STAT-CDE = 'I' AND           07440000
                                  ASC-RF-AUD-STAT-CDE = 'I'))           07450000
051000                           SET PS-SELECTED-CARTON-NO TO TRUE      07460000
051030                              MOVE PC-LINE-3-UN   TO ALINE3O      07470000
051040                              MOVE PC-LINE-4-UN   TO ALINE4O      07480000
051050                              MOVE PC-LINE-5-UN   TO ALINE5O      07490000
051060                              MOVE PC-LINE-6-UN   TO ALINE6O      07500000
                         END-EVALUATE                                   07510000
      *VSH 10/26/2013 END - PR5148D                                     07520000
051500                 WHEN OTHER                                       07530000
051600                     IF PS-100-PERCENT                            07540000
051700                       MOVE PC-LINE-3-PER  TO ALINE3O             07550000
051800                       MOVE PC-LINE-4-PER  TO ALINE4O             07560000
051900                       MOVE PC-LINE-5-PER  TO ALINE5O             07570000
052000                       MOVE PC-LINE-6-PER  TO ALINE6O             07580000
052100                     ELSE                                         07590000
052200                       MOVE PC-LINE-3-OK   TO ALINE3O             07600000
052300                       MOVE PC-LINE-4-OK   TO ALINE4O             07610000
052400                       MOVE PC-LINE-5-OK   TO ALINE5O             07620000
052500                       MOVE PC-LINE-6-OK   TO ALINE6O             07630000
052600                     END-IF                                       07640000
052800             END-EVALUATE                                         07650000
176459                                                                  07660093
176459             MOVE SPACES             TO ALINE7O                   07670093
176459                                        ALINE8O                   07680093
176459                                        ALINE9O                   07690093
176459                                                                  07700093
176459             IF PS-CARTON-CHECKED-IN AND PS-NOT-MANUAL-AUDIT      07710094
176459                PERFORM 2530-CHECK-RFID                           07720093
176459             END-IF                                               07730093
176459                                                                  07740093
052900             PERFORM 1000-INITIALIZE                              07750000
053000             PERFORM 8000-SEND-MAP                                07760000
053100             PERFORM 8200-RETURN-TRANID                           07770000
053200                                                                  07780000
053300         WHEN EIBAID = DFHPF3                                     07790000
053400             MOVE SU001-LAST-PROGRAM  TO PV-TRANSFER-PROGRAM      07800000
053500             PERFORM 4000-XCTL-LRT-MENU                           07810000
053600                                                                  07820000
053700         WHEN EIBAID = DFHPF9                                     07830000
053800             MOVE PC-TRIP-START-PGM   TO PV-TRANSFER-PROGRAM      07840000
053900             PERFORM 4000-XCTL-LRT-MENU                           07850000
054000                                                                  07860000
054100         WHEN EIBAID = DFHPF1                                     07870000
054200             PERFORM 2100-RECEIVE-MAP                             07880000
054300             MOVE SU538AO             TO PC192-HOST-SAVE-MAP      07890091
054400             PERFORM 1200-HELP-SCREEN                             07900000
054500                                                                  07910000
054600         WHEN OTHER                                               07920000
054700             MOVE -1                         TO ACARTNL           07930000
054800             MOVE PC-UNRECOGNIZED-PF-KEY-MSG TO AMSGLNO           07940000
054900             PERFORM 8100-SEND-DATA-ONLY                          07950000
055000             PERFORM 8200-RETURN-TRANID                           07960000
055100     END-EVALUATE.                                                07970000
055200                                                                  07980000
055300     GOBACK.                                                      07990000
055400                                                                  08000000
055500                                                                  08010000
055600 1000-INITIALIZE.                                                 08020000
055700                                                                  08030000
055800     IF SU001-LAST-PROGRAM = PC-SU-SHIP-CODE-PGM                  08040000
055900         MOVE  SPACES    TO  AFKEYO                               08050000
056000     ELSE                                                         08060000
056100         MOVE  PC-FKEYS  TO  AFKEYO                               08070000
056200     END-IF.                                                      08080000
056300     MOVE -1                     TO ACARTNL.                      08090000
056400                                                                  08100000
056500                                                                  08110000
056600 1200-HELP-SCREEN.                                                08120000
056700     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM      08130000
056800     MOVE 'SUKRF538'                  TO PC192-PROGRAM-NAME       08140000
056900     COPY PCPD188.                                                08150000
057000     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      08160000
057100     MOVE CA-COMMAREA                 TO PC192-HOST-SAVE-AREA     08170000
057200     PERFORM 8250-XCTL-TO-HELP.                                   08180000
057300                                                                  08190000
057400                                                                  08200000
057500 2000-PROCESS-SCREEN-FIELDS.                                      08210000
057600                                                                  08220000
057700     PERFORM 2100-RECEIVE-MAP.                                    08230000
057800     PERFORM 2200-EDIT-INPUT.                                     08240000
057900                                                                  08250000
058000                                                                  08260000
058100 2100-RECEIVE-MAP.                                                08270000
058200                                                                  08280000
058300     EXEC CICS                                                    08290000
058400         RECEIVE MAP    ('SU538A')                                08300000
058500                 MAPSET ('SUKM538')                               08310000
058600                 RESP   (PV-CICS-RESPONSE)                        08320000
058700     END-EXEC.                                                    08330000
058800                                                                  08340000
058900     EVALUATE TRUE                                                08350000
059000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 08360000
059100             PERFORM 2110-RECEIVE-SCREEN-FIELDS                   08370000
059200         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                08380000
059300             CONTINUE                                             08390000
059400         WHEN OTHER                                               08400000
059500            MOVE '2100-RECEIVE-MAP'      TO DP013-PARAGRAPH       08410000
059600            MOVE 'SUKRF538 - UNABLE TO RECEIVE MAP'               08420000
059700                                         TO DP013-MESSAGE-TEXT (1)08430000
059800            SET DP013-LOGIC-ABEND        TO TRUE                  08440000
059900            SET DP013-ROLLBACK           TO TRUE                  08450000
060000            PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                08460000
060100            MOVE PM-DB2-FATAL-ERROR-MSG TO AMSGLNO                08470000
060200            PERFORM 8100-SEND-DATA-ONLY                           08480000
060300            PERFORM 8200-RETURN-TRANID                            08490000
060400     END-EVALUATE.                                                08500000
060500                                                                  08510000
060600                                                                  08520000
060700 2110-RECEIVE-SCREEN-FIELDS.                                      08530000
060800                                                                  08540000
060900     IF  ACARTNL > ZERO                                           08550000
061000         IF ACARTNI = LOW-VALUES                                  08560000
061010             MOVE SPACES TO PV-CTN                                08570000
061020         ELSE                                                     08580000
061030             MOVE ACARTNI TO PV-CTN                               08590000
061040         END-IF                                                   08600000
061050     ELSE                                                         08610000
061060         IF ACARTNA = DP015-ERASE-EOF                             08620000
061070             MOVE SPACES TO PV-CTN                                08630000
061080         END-IF                                                   08640000
061090     END-IF.                                                      08650000
061100                                                                  08660000
061200                                                                  08670000
061300                                                                  08680000
061400 2200-EDIT-INPUT.                                                 08690000
061500     IF PV-CTN = LOW-VALUES                                       08700000
061600        SET PS-INVALID-INPUT        TO TRUE                       08710000
061700        MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA                    08720000
061800        MOVE -1                     TO ACARTNL                    08730000
061900        MOVE PC-SCAN-KEY-MSG        TO AMSGLNO                    08740000
062000        PERFORM 8000-SEND-MAP                                     08750000
062010        PERFORM 8200-RETURN-TRANID                                08760000
062020     END-IF                                                       08770000
062030                                                                  08780000
062040     MOVE 0 TO PV-CHAR-COUNT.                                     08790000
062050     SET SU001-GOOD-CHECK-DIGIT TO TRUE.                          08800000
062060     INSPECT PV-CTN TALLYING PV-CHAR-COUNT FOR CHARACTERS         08810000
062070                 BEFORE INITIAL SPACE.                            08820000
062080                                                                  08830000
062090     PERFORM 2210-INIT-ATTR.                                      08840000
062100                                                                  08850080
062200     PERFORM DP026-0000-GET-LOGON-INFO.                           08860000
062300     MOVE DP026-LOCATION-NBR  TO  DK-OPER-UNT-ID.                 08870000
062400     SET PS-OPER-NOT-ECOMM-DC TO TRUE.                            08880000
062500     PERFORM 2260-CHECK-IF-E-COMM.                                08890000
062600     IF PS-OPER-IS-ECOMM-DC                                       08900000
062700         SET PS-MANUAL-AUDIT TO TRUE                              08910000
062800     ELSE                                                         08920000
062900         IF PV-CHAR-COUNT = 22                                    08930000
063000             PERFORM 2250-EDIT-BARCODE                            08940000
063100         ELSE                                                     08950000
063200             PERFORM 2230-EDIT-CTN                                08960000
063300         END-IF                                                   08970000
063400     END-IF.                                                      08980000
063500                                                                  08990000
063600                                                                  09000000
063700 2210-INIT-ATTR.                                                  09010000
063800                                                                  09020000
063900     MOVE DP015-UNP-ALP-NOR-MDT      TO ACARTNA.                  09030000
064000                                                                  09040000
064100                                                                  09050000
064200     IF PV-CHAR-COUNT = 22                                        09060000
064300         MOVE PV-CTN (3:20)  TO ACARTNO                           09070000
064400     ELSE                                                         09080000
064500         MOVE PV-CTN         TO ACARTNO                           09090000
064600     END-IF.                                                      09100000
064700     MOVE SPACES         TO AMSGLNO.                              09110000
064800                                                                  09120000
064900                                                                  09130000
065000 2230-EDIT-CTN.                                                   09140000
065100     EVALUATE TRUE                                                09150000
065200         WHEN PV-CTN = SPACES                                     09160000
065300             SET PS-INVALID-INPUT        TO TRUE                  09170000
065400             MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA               09180000
065500             MOVE -1                     TO ACARTNL               09190000
065600             MOVE PC-SCAN-KEY-MSG        TO AMSGLNO               09200000
065700         WHEN PV-CHAR-COUNT = PC-18 AND                           09210000
065800            ((PV-CTN-FIRST-DIGIT NOT =  PC-0) AND                 09220000
065900             (PV-CTN-FIRST-DIGIT NOT =  PC-4) AND                 09230000
066000             (PV-CTN-FIRST-DIGIT NOT =  PC-5)                     09240000
066100            )                                                     09250000
066200             SET PS-INVALID-INPUT        TO TRUE                  09260000
066300             MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA               09270000
066400             MOVE -1                     TO ACARTNL               09280000
066500             MOVE PC-FIRST-1-NOT-0-MSG   TO AMSGLNO               09290000
066600         WHEN OTHER                                               09300000
066700             SET DP010I-NEGATIVE-NOT-ALLOWED                      09310000
066800                 PS-NOT-SCANNED-DATA TO TRUE                      09320000
066900             IF PV-CHAR-COUNT = PC-18                             09330000
067000                 MOVE PV-CTN-LAST-17      TO DP010I-UNEDITED-FIELD09340000
067100             ELSE                                                 09350000
067200                 IF PV-CHAR-COUNT < PC-18                         09360000
067300                     MOVE PV-CTN          TO DP010I-UNEDITED-FIELD09370000
067400                 ELSE                                             09380000
067500                     MOVE PV-CTN-SCAN-LAST-17                     09390000
067600                                          TO DP010I-UNEDITED-FIELD09400000
067700                     SET PS-SCANNED-DATA TO TRUE                  09410000
067800                 END-IF                                           09420000
067900             END-IF                                               09430000
068000             MOVE 17     TO DP010I-MAXIMUM-DIGITS                 09440000
068100             MOVE 0      TO DP010I-MAXIMUM-DECIMALS               09450000
068200                                                                  09460000
263968             CALL DP010I-NUMERIC-EDIT-ROUTINE                     09471095
263968                  USING DP010I-NUMERIC-EDIT-AREA                  09472095
068400                                                                  09480000
068500             IF  DP010I-ERROR-DETECTED                            09490000
068600                 SET PS-INVALID-INPUT        TO TRUE              09500000
068700                 MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA           09510000
068800                 MOVE -1                     TO ACARTNL           09520000
068900                 MOVE PC-MUST-BE-NUM-MSG     TO AMSGLNO           09530000
069000             ELSE                                                 09540000
069100                 IF DP010I-NUMERIC-FIELD = ZEROES                 09550000
069200                     SET PS-INVALID-INPUT        TO TRUE          09560000
069300                     MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA       09570000
069400                     MOVE -1                     TO ACARTNL       09580000
069500                     MOVE PC-MUST-BE-GT-0-MSG    TO AMSGLNO       09590000
069600                 ELSE                                             09600000
069700                     COMPUTE PV-CTN-REDEF      ROUNDED =          09610000
069800                        DP010I-NUM-FIELD-17-DIG-0-DEC * 1         09620000
069900                     EVALUATE TRUE                                09630000
070000                         WHEN PV-CHAR-COUNT = PC-20               09640000
070100                            IF PV-CTN-SCAN-THIRD-DGT  = PC-4      09650000
070200                               SET PS-TRNGLE-TRANS  TO TRUE       09660000
070300                               MOVE PV-CTN-SCAN-LAST-18 TO        09670000
070400                                                   PV-CTN-REDEF   09680000
070500                            END-IF                                09690000
070600                         WHEN PV-CHAR-COUNT = PC-18               09700000
070700                            IF (PV-CTN-FIRST-DIGIT  = PC-4 OR     09710000
070800                                PV-CTN-FIRST-DIGIT  = PC-5)       09720000
070900                               SET PS-TRNGLE-TRANS  TO TRUE       09730000
071000                               MOVE PV-CTN  TO PV-CTN-REDEF       09740000
071100                            END-IF                                09750000
071200                     END-EVALUATE                                 09760000
071300                     MOVE PV-CTN-REDEF          TO ACARTNO        09770000
071400                     PERFORM 2240-CHECK-TABLES                    09780000
071500                 END-IF                                           09790000
071600             END-IF                                               09800000
071700     END-EVALUATE.                                                09810000
071800                                                                  09820000
071900                                                                  09830000
072000 2240-CHECK-TABLES.                                               09840000
072100                                                                  09850000
072200     MOVE PV-CTN-REDEF TO DK-CTN.                                 09860000
072300     PERFORM 3000-SELECT-SULBXF.                                  09870000
072400                                                                  09880000
072500     IF PS-CARTON-DOESNT-EXIST                                    09890000
072600         MOVE DK-CTN              TO PC-SML-BARCODE               09900000
072700         MOVE SPACES              TO DK-BRCDE-NBR                 09910000
072800         MOVE '00'                TO DK-BRCDE-NBR (1:2)           09920000
072900         MOVE PC-SML-BARCODE-R    TO DK-BRCDE-NBR (3:18)          09930000
072910         MOVE DK-BRCDE-NBR        TO SUT00102-BRCDE-NBR           09940000
073000         PERFORM 3100-SELECT-BY-BARCODE                           09950000
073100         IF PS-CARTON-EXISTS                                      09960080
073200             MOVE SULBXF-SHIPT-UNT-ID                             09970000
073300                                  TO DK-CTN                       09980000
073400             PERFORM 3500-SELECT-SHUNLO                           09990000
073500             IF PS-CARTON-CHECKED-IN                              10000000
073600                 PERFORM 3200-SELECT-AUDIT-INFO                   10010000
073700             END-IF                                               10020000
073800         ELSE                                                     10030000
073900             PERFORM 3297-SELECT-TSHPUNT                          10040000
074000             IF PS-CARTON-EXISTS                                  10050000
074100                 PERFORM 3500-SELECT-SHUNLO                       10060000
074200                 IF PS-CARTON-NOT-CHECKED-IN                      10070000
074300                     PERFORM 3220-SELECT-TPKSLIP                  10080000
074400                     IF PS-PACKSLIP-EXISTS AND                    10090000
074500                        PKSLIP-REC-SEQ-NBR > 0                    10100000
074600                         MOVE PKSLIP-REC-SEQ-NBR                  10110000
074700                             TO DK-RCVR-SEQ-NBR                   10120000
074800                         PERFORM 3240-SELECT-TSHUUPC              10130000
074900                         PERFORM 3260-SELECT-TRECEIV              10140000
075000                         IF RECEIV-PACK-BY-ST-IND = 'Y'           10150000
075100                             SET PS-CARTON-NOT-CHECKED-IN TO TRUE 10160000
075200                         ELSE                                     10170000
075300                             MOVE SHUUPC-TRN-NBR   TO DK-PO       10180000
075400                             IF RECEIV-PKGNG-CDE = PC-M OR PC-I   10190000
075500                                 PERFORM 3280-DETERMINE-PREPACK-ID10200000
075600                                 IF PS-NO-PRE-PACK-ID             10210000
075700                                    SET PS-DISTRO-DOESNT-EXIST    10220000
075800                                              TO TRUE             10230000
075900                                 ELSE                             10240000
076000                                     MOVE RECITM-PREPK-ID         10250000
076100                                                  TO DK-PO-LNE-NBR10260000
076200                                     PERFORM 3299-SELECT-TDISTHD  10270000
076300                                 END-IF                           10280000
076400                             ELSE                                 10290000
076500                                 MOVE SHUUPC-TRN-LNE-NBR          10300000
076600                                                  TO DK-PO-LNE-NBR10310000
076700                                 PERFORM 3298-SELECT-TDISTHD      10320000
076800                             END-IF                               10330000
076900                             IF PS-DISTRO-EXISTS                  10340000
077000                               IF DISTHD-TOT-CART-CNT > 0 AND     10350000
077100                                  DISTHD-UCC128-DAT-USG-CDE = 'U' 10360000
077200                                   SET PS-CARTON-NOT-CHECKED-IN   10370000
077300                                                   TO TRUE        10380000
077400                               ELSE                               10390000
077500                                   SET PS-MANUAL-AUDIT TO TRUE    10400000
077600                               END-IF                             10410000
077700                             ELSE                                 10420000
077800                                 SET PS-CARTON-DATA-NOT-FOUND     10430000
077900                                                  TO TRUE         10440000
078000                             END-IF                               10450000
078100                         END-IF                                   10460000
078200                     ELSE                                         10470000
078300                         IF PS-NOT-ATTACHED-TO-PKSLIP             10480000
078400                             CONTINUE                             10490000
078500                         ELSE                                     10500000
078600                             SET PS-CARTON-DATA-NOT-FOUND TO TRUE 10510000
078700                         END-IF                                   10520000
078800                     END-IF                                       10530000
078900                 ELSE                                             10540000
079000                     SET PS-MANUAL-AUDIT TO TRUE                  10550000
079100                 END-IF                                           10560000
079200             ELSE                                                 10570000
079300                 PERFORM 3300-CHECK-IF-AUDIT-NUMBER               10580000
079400             END-IF                                               10590000
079500         END-IF                                                   10600000
079600     ELSE                                                         10610000
079700         MOVE DK-CTN              TO PC-SML-BARCODE               10620000
079800         MOVE SPACES              TO DK-BRCDE-NBR                 10630000
079900         MOVE '00'                TO DK-BRCDE-NBR (1:2)           10640000
080000         MOVE PC-SML-BARCODE-R    TO DK-BRCDE-NBR (3:18)          10650000
080100         IF DK-BRCDE-NBR = SULBXF-BRCDE-NBR                       10660000
080200             SET PS-MANUAL-AUDIT TO TRUE                          10670000
080201             MOVE DK-BRCDE-NBR TO SUT00102-BRCDE-NBR              10680000
080210             PERFORM 3670-CHECK-CURRENT-DIRECTIVE                 10690000
080300         ELSE                                                     10700000
080400             MOVE SULBXF-SHIPT-UNT-ID                             10710000
080500                                  TO DK-CTN                       10720000
080600             PERFORM 3500-SELECT-SHUNLO                           10730000
080700             IF PS-CARTON-CHECKED-IN                              10740000
080800                 PERFORM 3200-SELECT-AUDIT-INFO                   10750000
080900             END-IF                                               10760000
081000         END-IF                                                   10770000
081100     END-IF.                                                      10780000
081200                                                                  10790000
081300 2250-EDIT-BARCODE.                                               10800000
081400     IF PV-CTN = SPACES                                           10810000
081500         SET PS-INVALID-INPUT        TO TRUE                      10820000
081600         MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA                   10830000
081700         MOVE -1                     TO ACARTNL                   10840000
081800         MOVE PC-SCAN-KEY-MSG        TO AMSGLNO                   10850000
081900     ELSE                                                         10860000
082000         PERFORM 2300-EDIT-SERIAL-SHIP-CODE                       10870000
082100         IF PS-NO-ERROR                                           10880000
082200             PERFORM 3100-SELECT-BY-BARCODE                       10890000
082300             IF PS-CARTON-EXISTS                                  10900000
082400                 MOVE SULBXF-SHIPT-UNT-ID                         10910000
082500                                      TO SHPUNT-SHIPT-UNT-ID      10920000
082600                                         DK-CTN                   10930000
082700                 PERFORM 3500-SELECT-SHUNLO                       10940000
082800                 IF PS-CARTON-CHECKED-IN                          10950000
082900                     PERFORM 3200-SELECT-AUDIT-INFO               10960000
083000                 END-IF                                           10970000
083100             ELSE                                                 10980000
083200                 SET PS-CARTON-DATA-NOT-FOUND TO TRUE             10990000
083300             END-IF                                               11000000
083400         ELSE                                                     11010000
083500             SET PS-INVALID-INPUT         TO TRUE                 11020000
083600         END-IF                                                   11030000
083700     END-IF.                                                      11040000
083800                                                                  11050000
083900*                                                                 11060000
084000 2260-CHECK-IF-E-COMM.                                            11070000
084100                                                                  11080000
084110     INITIALIZE XL071-COMMAREA-REC.                               11090000
084120     MOVE DK-OPER-UNT-ID     TO XL071-LOCATION-NUMBER.            11100000
084130                                                                  11110000
084140     CALL PC-LOCATION-MODULE  USING DFHEIBLK                      11120000
084150                                    XL071-COMMAREA                11130000
084160                                    XL071-COMMAREA-REC.           11140000
084170                                                                  11150000
084180     IF XL071-NO-ERRORS                                           11160000
084190          IF XL071-LOC-TYP-CDE = 'DC' AND                         11170000
084191             XL071-E-BUS-IND   = 'Y'                              11180000
084192                 SET PS-OPER-IS-ECOMM-DC TO TRUE                  11190000
084193          END-IF                                                  11200000
084194     ELSE                                                         11210000
084195         IF XL071-BAD-DB2-RETURN                                  11220000
084196             MOVE '2260-CHECK-IF-E-COMM'  TO DP013-PARAGRAPH      11230000
084197             MOVE 'SUKRF538 - CHECK IF DC OPER IS ECOMM'          11240000
084198                                         TO DP013-MESSAGE-TEXT(1) 11250000
084199             MOVE DK-OPER-UNT-ID         TO PV-DISPLAY-OPER-UNT-ID11260000
084200             MOVE PV-DISPLAY-OPER-UNT-ID TO DP013-MESSAGE-TEXT(2) 11270000
084300             MOVE SQLCA      TO DP013-SQLCA                       11280000
084400             MOVE 'XLT_LOC'  TO DP013-DB2-TABLE-NAME(1)           11290000
084500             SET DP013-DB2-ABEND  TO TRUE                         11300000
084600             SET DP013-ROLLBACK   TO TRUE                         11310000
084700             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              11320000
084800             PERFORM DP014-0000-PROCESS-ABEND                     11330000
084900         END-IF                                                   11340000
085000     END-IF.                                                      11350000
085100                                                                  11360000
085200 2300-EDIT-SERIAL-SHIP-CODE.                                      11370000
085300                                                                  11380000
085400     MOVE PV-CTN              TO PV-INPUT-FIELD.                  11390000
085500     MOVE SPACES              TO PV-OUTPUT-FIELD.                 11400000
085600     MOVE +22                 TO PV-SUB2.                         11410000
085700                                                                  11420000
085800     PERFORM                                                      11430000
085900       VARYING PV-SUB1 FROM 22 BY -1                              11440000
086000         UNTIL PV-SUB1 = ZERO OR PS-ERROR                         11450000
086100                                                                  11460000
086200         IF PV-IN-BYTE (PV-SUB1) > SPACES                         11470000
086300             IF PV-IN-BYTE (PV-SUB1) NUMERIC                      11480000
086400                 MOVE PV-IN-BYTE (PV-SUB1)                        11490000
086500                   TO PV-OUT-BYTE (PV-SUB2)                       11500000
086600                 SUBTRACT 1 FROM PV-SUB2                          11510000
086700             ELSE                                                 11520000
086800                 SET PS-INVALID-INPUT        TO TRUE              11530000
086900                 MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA           11540000
087000                 MOVE -1                     TO ACARTNL           11550000
087100                 MOVE PC-MUST-BE-NUM-MSG     TO AMSGLNO           11560000
087200             END-IF                                               11570000
087300         END-IF                                                   11580000
087400                                                                  11590000
087500     END-PERFORM.                                                 11600000
087600                                                                  11610000
087700     IF PS-NO-ERROR                                               11620000
087800         INSPECT PV-OUTPUT-FIELD                                  11630000
087900           REPLACING ALL SPACES BY ZEROES                         11640000
088000                                                                  11650000
088100         MOVE PV-OUTPUT-FIELD TO DK-BRCDE-NBR                     11660000
088200     END-IF.                                                      11670000
088300                                                                  11680000
176459******************************************************************11690093
176459* CHECK SUKUT149 ROUTINE TO SEE IF ITS A VALID RFID CARTON       *11700093
176459******************************************************************11710093
176459 2530-CHECK-RFID.                                                 11720093
176459                                                                  11730093
176459     INITIALIZE SU093-ITEM-COMMAREA.                              11740093
176459     SET SU093-RFID-KOHL-DPT-IN-STR-NO TO TRUE.                   11750093
176459     SET SU093-RFID-KOHL-DEPT-SUBCL-NO TO TRUE.                   11760093
176459     SET SU093-VNDR-DPT-RFID-COMPLI-NO TO TRUE.                   11770093
176459     SET SU093-VNDR-DPT-RFID-TAGS-NO   TO TRUE.                   11780093
176459     SET SU093-DC-DEPT-TAGS-NO         TO TRUE.                   11790093
176459     SET SU093-DC-USE-RFID-CART-LBL-NO TO TRUE.                   11800093
176459     SET SU093-RFID-DC-AUTO-CONVEYR-NO TO TRUE.                   11810093
176459     SET SU093-DPT-STR-P2L-FIRST-NO    TO TRUE.                   11820093
176459     SET SU093-CHECK-IN                TO TRUE.                   11830093
176459                                                                  11840093
176459     IF SULBXF-CART-LBL-TYP-CDE = PC-P                            11850093
176459***** IT'S P2L                                                    11860093
176459         SET SU093-CHECK-BY-DEPT-SUBCLS-YES TO TRUE               11870093
176459         SET SU093-CHECK-BY-DEPT-IN-STR-NO  TO TRUE               11880093
176459         SET SU093-RFID-STR-CHK-NEEDED-NO   TO TRUE               11890093
176459         SET SU093-CHECK-BY-DC              TO TRUE               11900093
176459         MOVE SULBXF-SHIPT-UNT-ID       TO SU093-KEY-CARTON-ID    11910093
176459         MOVE RECEIV-OPER-UNT-ID        TO SU093-KEY-OPER-UNT-ID  11920093
176459     ELSE                                                         11930093
176459         SET SU093-CHECK-BY-DEPT-SUBCLS-YES TO TRUE               11940093
176459         SET SU093-CHECK-BY-DEPT-IN-STR-YES TO TRUE               11950093
176459         SET SU093-RFID-STR-CHK-NEEDED-YES  TO TRUE               11960093
176459         SET SU093-CHECK-BY-DC              TO TRUE               11970093
176459         MOVE SULBXF-SHIPT-UNT-ID      TO SU093-KEY-CARTON-ID     11980093
176459         MOVE RECEIV-OPER-UNT-ID       TO SU093-KEY-OPER-UNT-ID   11990093
176459         MOVE SULBXF-DEST-OPER-UNT-ID  TO SU093-KEY-DEST-LOC      12000093
176459     END-IF.                                                      12010093
176459                                                                  12020093
176459     CALL SU093-RFID-PGM       USING DFHEIBLK                     12030093
176459                                     SU093-COMMAREA               12040093
176459                                     SU093-ITEM-COMMAREA.         12050093
176459                                                                  12060093
176459     EVALUATE TRUE                                                12070093
176459       WHEN SU093-SUCCESSFUL                                      12080093
176459           IF SU093-RFID-IND = 'Y'                                12090093
176459              PERFORM 2540-SET-RFID-FOR-PRINT                     12100093
176459              IF PS-RFID-ON-LABEL-YES                             12110093
176459                 MOVE PC-RFID-MSG-1           TO ALINE7O          12120093
176459                                                 ALINE9O          12130093
176459                 EVALUATE TRUE                                    12140093
176459                    WHEN SU093-PRINT-RFID-EAS                     12150093
176459                         MOVE PC-RF-EAS-MSG-4 TO ALINE8O          12160093
176459                    WHEN SU093-PRINT-RFID                         12170093
176459                         MOVE PC-RFID-MSG-2   TO ALINE8O          12180093
176459                    WHEN SU093-PRINT-EAS                          12190093
176459                         MOVE PC-EAS-MSG-3    TO ALINE8O          12200093
176459                    WHEN OTHER                                    12210093
176459                         MOVE SPACES          TO ALINE7O          12220093
176459                                                 ALINE9O          12230093
176459                 END-EVALUATE                                     12240093
176459              END-IF                                              12250093
176459           END-IF                                                 12260093
176459                                                                  12270093
176459       WHEN OTHER                                                 12280093
176459           CONTINUE                                               12290093
176459                                                                  12300093
176459     END-EVALUATE.                                                12310093
176459                                                                  12320093
176459******************************************************************12330093
176459* ONCE COMING BACK FROM ROUTINE AND YOU KNOW IT'S RFID YOU       *12340093
176459* STILL NEED TO CHECK THE FOLLOWING SWITCHES TO DETERMINE IF     *12350093
176459* RFID IS PRINTED ON THE LABEL                                   *12360093
176459******************************************************************12370093
176459 2540-SET-RFID-FOR-PRINT.                                         12380093
176459                                                                  12390093
176459     SET PS-RFID-ON-LABEL-NO TO TRUE.                             12400093
176459                                                                  12410093
176459     IF SU093-VNDR-DPT-RFID-COMPLI-YES                            12420093
176459*      MEANS NO RFID ON LABELS                                    12430093
176459         SET PS-RFID-ON-LABEL-NO TO TRUE                          12440093
176459     ELSE                                                         12450093
176459        IF  SU093-VNDR-DPT-RFID-TAGS-YES                          12460093
176459        AND SU093-DC-DEPT-TAGS-NO                                 12470093
176459*         MEANS NO RFID ON LABELS                                 12480093
176459            SET PS-RFID-ON-LABEL-NO  TO TRUE                      12490093
176459        ELSE                                                      12500093
176459            IF  SU093-VNDR-DPT-RFID-TAGS-NO                       12510093
176459            AND SU093-DC-DEPT-TAGS-YES                            12520093
176459*             MEANS YES TO RFID ON LABELS                         12530093
176459                SET PS-RFID-ON-LABEL-YES TO TRUE                  12540093
176459            ELSE                                                  12550093
176459                IF  SU093-VNDR-DPT-RFID-TAGS-NO                   12560093
176459                AND SU093-DC-DEPT-TAGS-NO                         12570093
176459*                 MEANS NO RFID ON LABELS                         12580093
176459                    SET PS-RFID-ON-LABEL-NO TO TRUE               12590093
176459                ELSE                                              12600093
176459                    IF  SU093-VNDR-DPT-RFID-TAGS-YES              12610093
176459                    AND SU093-DC-DEPT-TAGS-YES                    12620093
176459                        SET PS-RFID-ON-LABEL-NO TO TRUE           12630093
176459                    END-IF                                        12640093
176459                END-IF                                            12650093
176459            END-IF                                                12660093
176459        END-IF                                                    12670093
176459     END-IF.                                                      12680093
176459*CHERI  08/08/17                                                  12690094
176459*     WHEN RFID IS SET TO NO SHOULD NOT DISPLAY RFID ON THE SCREEN12700093
176459     IF PS-RFID-ON-LABEL-NO                                       12710093
176459        IF SU093-PRINT-EAS OR SU093-PRINT-RFID-EAS                12720093
176459           SET PS-RFID-ON-LABEL-YES TO TRUE                       12730093
176459        END-IF                                                    12740093
176459     END-IF.                                                      12750093
176459                                                                  12760093
176459******************************************************************12770093
088400 3000-SELECT-SULBXF.                                              12780000
088500                                                                  12790000
088600     EXEC SQL                                                     12800000
088700         SELECT SHIPT_UNT_ID                                      12810000
088800             ,  BRCDE_NBR                                         12820000
176459             ,  DEST_OPER_UNT_ID                                  12830093
176459             ,  CART_LBL_TYP_CDE                                  12840093
088900         INTO   :SULBXF-SHIPT-UNT-ID                              12850000
089000             ,  :SULBXF-BRCDE-NBR                                 12860000
176459             ,  :SULBXF-DEST-OPER-UNT-ID                          12870093
176459             ,  :SULBXF-CART-LBL-TYP-CDE                          12880093
089100         FROM   TSULBXF                                           12890000
089200         WHERE  SHIPT_UNT_ID   = :DK-CTN                          12900000
089300     END-EXEC.                                                    12910000
089400                                                                  12920000
089500     EVALUATE TRUE                                                12930000
089600         WHEN SQLCODE = ZERO                                      12940000
089700         WHEN SQLCODE = -811                                      12950000
089800            SET PS-CARTON-EXISTS TO TRUE                          12960000
089810            MOVE SULBXF-BRCDE-NBR TO SUT00102-BRCDE-NBR           12970000
089900         WHEN SQLCODE = +100                                      12980000
090000              SET PS-CARTON-DOESNT-EXIST TO TRUE                  12990000
090100         WHEN SQLWARN0 NOT = SPACES                               13000000
090200         WHEN SQLCODE NOT EQUAL ZERO                              13010000
090300             MOVE '3000-SELECT-SULBXF'                            13020000
090400                             TO DP013-PARAGRAPH                   13030000
090500             MOVE 'SUKRF538 - CHECK VALID CARTON'                 13040000
090600                             TO DP013-MESSAGE-TEXT(1)             13050000
090700             MOVE DK-CTN     TO PV-CTN-REDEF                      13060000
090800             MOVE PV-CTN-REDEF-X TO DP013-MESSAGE-TEXT(2)         13070000
090900             MOVE SQLCA      TO DP013-SQLCA                       13080000
091000             MOVE 'TSULBXF'  TO DP013-DB2-TABLE-NAME(1)           13090000
091100             SET DP013-DB2-ABEND                                  13100000
091200                             TO TRUE                              13110000
091300             SET DP013-ROLLBACK                                   13120000
091400                             TO TRUE                              13130000
091500             SET DP013-XCTL-DISPLAY-RESTART                       13140000
091600                             TO TRUE                              13150000
091700             PERFORM DP014-0000-PROCESS-ABEND                     13160000
091800     END-EVALUATE.                                                13170000
091900                                                                  13180000
092000                                                                  13190000
092100 3100-SELECT-BY-BARCODE.                                          13200000
092200                                                                  13210000
092300     EXEC SQL                                                     13220000
092400         SELECT SHIPT_UNT_ID                                      13230000
176459              , DEST_OPER_UNT_ID                                  13240093
176459              , CART_LBL_TYP_CDE                                  13250093
092500         INTO   :SULBXF-SHIPT-UNT-ID                              13260000
176459              , :SULBXF-DEST-OPER-UNT-ID                          13270093
176459              , :SULBXF-CART-LBL-TYP-CDE                          13280093
092600         FROM   TSULBXF                                           13290000
092700         WHERE  BRCDE_NBR      = :DK-BRCDE-NBR                    13300000
092800     END-EXEC.                                                    13310000
092900                                                                  13320000
093000     EVALUATE TRUE                                                13330000
093100         WHEN SQLCODE = ZERO                                      13340000
093200            SET PS-CARTON-EXISTS TO TRUE                          13350000
093300         WHEN SQLCODE = +100                                      13360000
093400              SET PS-CARTON-DOESNT-EXIST TO TRUE                  13370000
093500         WHEN SQLWARN0 NOT = SPACES                               13380000
093600         WHEN SQLCODE NOT EQUAL ZERO                              13390000
093700             MOVE '3100-SELECT-BY-BARCODE'                        13400000
093800                             TO DP013-PARAGRAPH                   13410000
093900             MOVE 'SUKRF538 - CHECK VALID CARTON'                 13420000
094000                             TO DP013-MESSAGE-TEXT(1)             13430000
094100             MOVE DK-BRCDE-NBR                                    13440000
094200                             TO DP013-MESSAGE-TEXT(2)             13450000
094300             MOVE ACARTNI                                         13460000
094400                             TO DP013-MESSAGE-TEXT(3)             13470000
094500             MOVE SQLCA      TO DP013-SQLCA                       13480000
094600             MOVE 'TSULBXF'  TO DP013-DB2-TABLE-NAME(1)           13490000
094700             SET DP013-DB2-ABEND                                  13500000
094800                             TO TRUE                              13510000
094900             SET DP013-ROLLBACK                                   13520000
095000                             TO TRUE                              13530000
095100             SET DP013-XCTL-DISPLAY-RESTART                       13540000
095200                             TO TRUE                              13550000
095300             PERFORM DP014-0000-PROCESS-ABEND                     13560000
095400     END-EVALUATE.                                                13570000
095500                                                                  13580000
095600 3200-SELECT-AUDIT-INFO.                                          13590000
095700                                                                  13600000
095800     PERFORM 3220-SELECT-TPKSLIP.                                 13610000
095900     IF PS-PACKSLIP-EXISTS AND                                    13620000
096000        PKSLIP-REC-SEQ-NBR > 0                                    13630000
096100         MOVE PKSLIP-REC-SEQ-NBR TO DK-RCVR-SEQ-NBR               13640000
096200         PERFORM 3240-SELECT-TSHUUPC                              13650000
096300         PERFORM 3260-SELECT-TRECEIV                              13660000
096400         MOVE RECEIV-OPER-UNT-ID     TO DK-OPER-UNT-ID            13670000
096500         MOVE SHUUPC-TRN-NBR   TO DK-PO                           13680000
096600         IF RECEIV-PACK-BY-ST-IND = 'Y'                           13690000
096700             MOVE 0   TO DK-PO-LNE-NBR                            13700000
096800                         DK-PO-PREPK-ID                           13710000
096900         ELSE                                                     13720000
097000             IF RECEIV-PKGNG-CDE = PC-M OR PC-I                   13730000
097100                 PERFORM 3280-DETERMINE-PREPACK-ID                13740000
097200                 IF PS-NO-PRE-PACK-ID                             13750000
097300                     SET PS-CARTON-DATA-NOT-FOUND TO TRUE         13760000
097400                 ELSE                                             13770000
097500                     MOVE 0           TO DK-PO-LNE-NBR            13780000
097600                     MOVE RECITM-PREPK-ID                         13790000
097700                                      TO DK-PO-PREPK-ID           13800000
097800                 END-IF                                           13810000
097900             ELSE                                                 13820000
098000                 MOVE SHUUPC-TRN-LNE-NBR                          13830000
098100                                  TO DK-PO-LNE-NBR                13840000
098200                 MOVE 0           TO DK-PO-PREPK-ID               13850000
098300             END-IF                                               13860000
098400         END-IF                                                   13870000
098500         IF PS-CARTON-DATA-NOT-FOUND                              13880000
098600             CONTINUE                                             13890000
098700         ELSE                                                     13900000
098800             PERFORM 3290-SELECT-AUDIT                            13910000
      *VSH 11/26/2013 BEGIN - PR5148D                                   13920000
                   MOVE -9999 TO DK-PO-PREPK-ID-RF                      13930000
                   PERFORM 3292-SELECT-RFID-AUDIT                       13940000
                   IF PS-AUDIT-NBR-NOT-EXISTS AND                       13950000
                      PS-RF-AUDIT-NBR-NOT-EXISTS                        13960000
099000                 PERFORM 3295-SELECT-EXCEPTION                    13970000
099000                 PERFORM 3296-SELECT-EXCEPTION-RF                 13980000
                       IF ASC-COMBINED-YES                              13990000
                           IF ASC-RF-AUD-TYP-CDE = 'A' AND              14000000
                              ASC-AUD-TYP-CDE = 'A'                     14010000
                              SET PS-100-PERCENT TO TRUE                14020000
                           ELSE                                         14030000
                              IF ASC-RF-AUD-TYP-CDE = 'A' OR            14040000
                                 ASC-AUD-TYP-CDE = 'A'                  14050000
                                 SET PS-100-PERCENT TO TRUE             14060000
                              END-IF                                    14070000
      *VSH 10/26/2013 END - PR5148D                                     14080000
099300                     END-IF                                       14090000
                       END-IF                                           14100000
099400             END-IF                                               14110000
099500         END-IF                                                   14120000
099600     ELSE                                                         14130000
099700         IF PS-NOT-ATTACHED-TO-PKSLIP                             14140000
099800             CONTINUE                                             14150000
099900         ELSE                                                     14160000
100000             SET PS-CARTON-DATA-NOT-FOUND TO TRUE                 14170000
100100         END-IF                                                   14180000
100200     END-IF.                                                      14190000
100300                                                                  14200000
100400******************************************************************14210000
100500* 3220-SELECT-TPKSLIP.                                            14220000
100600*    GET THE PO NUMBER FROM THE PACKSLIP TABLE                    14230000
100700******************************************************************14240000
100800 3220-SELECT-TPKSLIP.                                             14250000
100900                                                                  14260000
101000     EXEC SQL                                                     14270000
101100        SELECT  A.PO_NBR                                          14280000
101200              , B.REC_SEQ_NBR                                     14290000
101300              , B.STR_DEST_NBR                                    14300000
101400          INTO  :INPKSU-PO-NBR                                    14310000
101500              , :PKSLIP-REC-SEQ-NBR                               14320000
101600              , :PKSLIP-STR-DEST-NBR                              14330000
101700          FROM  TINPKSU A                                         14340000
101800              , TPKSLIP B                                         14350000
101900          WHERE A.SHIPT_UNT_ID      = :DK-CTN                     14360000
102000            AND A.PO_NBR            = B.PO_NBR                    14370000
102100            AND A.SEQ_NBR           = B.SEQ_NBR                   14380000
102200            AND B.VER_STAT_CDE      = 'A'                         14390000
102300     END-EXEC.                                                    14400000
102400                                                                  14410000
102500     EVALUATE TRUE                                                14420000
102600         WHEN SQLCODE = ZERO                                      14430000
102700              SET PS-PACKSLIP-EXISTS TO TRUE                      14440000
102800         WHEN SQLCODE = +100                                      14450000
102900              SET PS-NOT-ATTACHED-TO-PKSLIP TO TRUE               14460000
103000         WHEN SQLWARN0 NOT = SPACES                               14470000
103100         WHEN SQLCODE NOT EQUAL ZERO                              14480000
103200             MOVE '3220-SELECT-TPKSLIP'                           14490000
103300                             TO DP013-PARAGRAPH                   14500000
103400             MOVE 'SUKRF538 - SELECT PACKSLIP'                    14510000
103500                             TO DP013-MESSAGE-TEXT(1)             14520000
103600             MOVE DK-CTN     TO PV-CTN-REDEF                      14530000
103700             MOVE PV-CTN-REDEF-X TO DP013-MESSAGE-TEXT(2)         14540000
103800             MOVE SQLCA      TO DP013-SQLCA                       14550000
103900             MOVE 'TINPKSU'  TO DP013-DB2-TABLE-NAME(1)           14560000
104000             MOVE 'TPKSLIP'  TO DP013-DB2-TABLE-NAME(2)           14570000
104100             SET DP013-DB2-ABEND                                  14580000
104200                             TO TRUE                              14590000
104300             SET DP013-ROLLBACK                                   14600000
104400                             TO TRUE                              14610000
104500             SET DP013-XCTL-DISPLAY-RESTART                       14620000
104600                             TO TRUE                              14630000
104700             PERFORM DP014-0000-PROCESS-ABEND                     14640000
104800     END-EVALUATE.                                                14650000
104900******************************************************************14660000
105000* 3240-SELECT-TSHUUPC.                                            14670000
105100*    GET THE PO NUMBER FROM THE SHIPPING UNIT UPC TABLE           14680000
105200******************************************************************14690000
105300 3240-SELECT-TSHUUPC.                                             14700000
105400     EXEC SQL                                                     14710000
105500        SELECT  TRN_NBR                                           14720000
105600              , TRN_LNE_NBR                                       14730000
105700          INTO  :SHUUPC-TRN-NBR                                   14740000
105800              , :SHUUPC-TRN-LNE-NBR                               14750000
105900          FROM  TSHUUPC                                           14760000
106000          WHERE SHIPT_UNT_ID      = :DK-CTN                       14770000
106100     END-EXEC.                                                    14780000
106200                                                                  14790000
106300     EVALUATE TRUE                                                14800000
106400         WHEN SQLCODE = ZERO                                      14810000
106500         WHEN SQLCODE = -811                                      14820000
106600              CONTINUE                                            14830000
106700         WHEN SQLWARN0 NOT = SPACES                               14840000
106800         WHEN SQLCODE NOT EQUAL ZERO                              14850000
106900             MOVE '3240-SELECT-TSHUUPC'                           14860000
107000                             TO DP013-PARAGRAPH                   14870000
107100             MOVE 'SELECT PO AND LINE'                            14880000
107200                             TO DP013-MESSAGE-TEXT(1)             14890000
107300             MOVE DK-CTN     TO PV-CTN-REDEF                      14900000
107400             MOVE PV-CTN-REDEF-X TO DP013-MESSAGE-TEXT(2)         14910000
107500             MOVE SHUUPC-TRN-NBR                                  14920000
107600                             TO DP013-MESSAGE-TEXT(2)             14930000
107700             MOVE SQLCA      TO DP013-SQLCA                       14940000
107800             MOVE 'TSHUUPC'  TO DP013-DB2-TABLE-NAME(1)           14950000
107900             SET DP013-DB2-ABEND                                  14960000
108000                             TO TRUE                              14970000
108100             SET DP013-NO-ROLLBACK                                14980000
108200                             TO TRUE                              14990000
108300             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               15000000
108400             MOVE PM-DB2-FATAL-ERROR-MSG TO AMSGLNO               15010000
108500             PERFORM 8100-SEND-DATA-ONLY                          15020000
108600             PERFORM 8200-RETURN-TRANID                           15030000
108700     END-EVALUATE.                                                15040000
108800                                                                  15050000
108900 3260-SELECT-TRECEIV.                                             15060000
109000                                                                  15070000
109100     EXEC SQL                                                     15080000
109200         SELECT DISTINCT                                          15090000
109300                OPER_UNT_ID                                       15100000
109400              , PACK_BY_ST_IND                                    15110000
109500              , PKGNG_CDE                                         15120000
109600         INTO   :RECEIV-OPER-UNT-ID                               15130000
109700              , :RECEIV-PACK-BY-ST-IND                            15140000
109800              , :RECEIV-PKGNG-CDE                                 15150000
109900          FROM  TRECEIV                                           15160000
110000          WHERE ORD_NBR           = :INPKSU-PO-NBR                15170000
110100            AND REC_SEQ_NBR       = :PKSLIP-REC-SEQ-NBR           15180000
110200            AND VER_STATUS_CDE    = 'A'                           15190000
110300     END-EXEC.                                                    15200000
110400*                                                                 15210000
110500     EVALUATE TRUE                                                15220000
110600         WHEN SQLCODE = ZERO                                      15230000
110700             CONTINUE                                             15240000
110800         WHEN SQLWARN0 NOT = SPACES                               15250000
110900         WHEN SQLCODE NOT EQUAL ZERO                              15260000
111000             MOVE '3260-SELECT-TRECEIV'                           15270000
111100                             TO DP013-PARAGRAPH                   15280000
111200             MOVE 'SUKRF538 - SELECT TRECEIV'                     15290000
111300                             TO DP013-MESSAGE-TEXT(1)             15300000
111400             MOVE INPKSU-PO-NBR          TO PV-PO-REDEF           15310000
111500             MOVE PV-PO-REDEF-X TO DP013-MESSAGE-TEXT(2)          15320000
111600             MOVE PKSLIP-REC-SEQ-NBR     TO PV-RECEIVER-REDEF     15330000
111700             MOVE PV-RECEIVER-REDEF-X TO DP013-MESSAGE-TEXT(3)    15340000
111800             MOVE ACARTNI             TO DP013-MESSAGE-TEXT(4)    15350000
111900             MOVE SQLCA      TO DP013-SQLCA                       15360000
112000             MOVE 'TRECEIV'  TO DP013-DB2-TABLE-NAME(1)           15370000
112100             SET DP013-DB2-ABEND                                  15380000
112200                             TO TRUE                              15390000
112300             SET DP013-ROLLBACK                                   15400000
112400                             TO TRUE                              15410000
112500             SET DP013-XCTL-DISPLAY-RESTART                       15420000
112600                             TO TRUE                              15430000
112700             PERFORM DP014-0000-PROCESS-ABEND                     15440000
112800     END-EVALUATE.                                                15450000
112900                                                                  15460000
113000 3280-DETERMINE-PREPACK-ID.                                       15470000
113100                                                                  15480000
113200     EXEC SQL                                                     15490000
113300          SELECT DISTINCT                                         15500000
113400                 D.PREPK_ID                                       15510000
113500          INTO  :RECITM-PREPK-ID                                  15520000
113600          FROM   TSHUUPC A                                        15530000
113700               , TINPKSU B                                        15540000
113800               , TPKSLIP C                                        15550000
113900               , TRECITM D                                        15560000
114000               , TDISTHD E                                        15570000
114100          WHERE A.SHIPT_UNT_ID = :DK-CTN                          15580000
114200          AND  A.SHIPT_UNT_ID = B.SHIPT_UNT_ID                    15590000
114300          AND  B.PO_NBR       = C.PO_NBR                          15600000
114400          AND  B.SEQ_NBR      = C.SEQ_NBR                         15610000
114500          AND  C.VER_STAT_CDE = 'A'                               15620000
114600          AND  C.PO_NBR       = D.ORD_NBR                         15630000
114700          AND  C.REC_SEQ_NBR  = D.REC_SEQ_NBR                     15640000
114800          AND  C.REC_SEQ_NBR  = :DK-RCVR-SEQ-NBR                  15650000
114900          AND  A.TRN_LNE_NBR  = D.ORD_LNE_NBR                     15660000
115000          AND  E.ORD_NBR      = C.PO_NBR                          15670000
115100          AND  E.RCVR_SEQ_NBR = C.REC_SEQ_NBR                     15680000
115200          AND  E.ORD_LNE_NBR  = D.ORD_LNE_NBR                     15690000
115300          AND  E.TOT_CART_CNT > 0                                 15700000
115400     END-EXEC.                                                    15710000
115500                                                                  15720000
115600     EVALUATE TRUE                                                15730000
115700         WHEN SQLCODE = ZERO                                      15740000
115800             SET PS-PRE-PACK-ID TO TRUE                           15750000
115900         WHEN SQLCODE = +100                                      15760000
116000             SET PS-NO-PRE-PACK-ID TO TRUE                        15770000
116100         WHEN SQLWARN0 NOT = SPACES                               15780000
116200         WHEN SQLCODE NOT EQUAL ZERO                              15790000
116300             MOVE '3280-DETERMINE-PREPACK-ID'                     15800000
116400                             TO DP013-PARAGRAPH                   15810000
116500             MOVE 'SUKRF538 - DETERMINE PACK ID'                  15820000
116600                             TO DP013-MESSAGE-TEXT(1)             15830000
116700                                                                  15840000
116800             MOVE DK-CTN     TO PV-CTN-REDEF                      15850000
116900             MOVE PV-CTN-REDEF-X TO DP013-MESSAGE-TEXT(2)         15860000
117000             MOVE DK-RCVR-SEQ-NBR        TO PV-REC-SEQ-REDEF      15870000
117100             MOVE PV-REC-SEQ-REDEF-X TO DP013-MESSAGE-TEXT(3)     15880000
117200             MOVE SQLCA      TO DP013-SQLCA                       15890000
117300             MOVE 'TSHUUPC'  TO DP013-DB2-TABLE-NAME(1)           15900000
117400             MOVE 'TINPKSU'  TO DP013-DB2-TABLE-NAME(2)           15910000
117500             MOVE 'TPKSLIP'  TO DP013-DB2-TABLE-NAME(3)           15920000
117600             MOVE 'TRECITM'  TO DP013-DB2-TABLE-NAME(4)           15930000
117700             SET DP013-DB2-ABEND                                  15940000
117800                             TO TRUE                              15950000
117900             SET DP013-ROLLBACK                                   15960000
118000                             TO TRUE                              15970000
118100             SET DP013-XCTL-DISPLAY-RESTART                       15980000
118200                             TO TRUE                              15990000
118300             PERFORM DP014-0000-PROCESS-ABEND                     16000000
118400     END-EVALUATE.                                                16010000
118500                                                                  16020000
118600 3290-SELECT-AUDIT.                                               16030000
118700     EXEC SQL                                                     16040000
118800         SELECT  AUD_CNTL_NBR                                     16050000
118900            ,    AUD_STAT_CDE                                     16060000
119000           INTO  :SUT00015-AUD-CNTL-NBR                           16070000
119100            ,    :SUT00015-AUD-STAT-CDE                           16080000
119200           FROM  SUT_PO_AUD_REQ                                   16090000
119300          WHERE  PO_NBR            =  :DK-PO                      16100000
119400            AND  PO_LNE_NBR        =  :DK-PO-LNE-NBR              16110000
119500            AND  PO_PREPK_ID       =  :DK-PO-PREPK-ID             16120000
119600            AND  RCVR_SEQ_NBR      =  :DK-RCVR-SEQ-NBR            16130000
119700     END-EXEC.                                                    16140000
119800                                                                  16150000
119900     EVALUATE TRUE                                                16160000
120000         WHEN SQLCODE = ZERO                                      16170000
      *VSH 11/26/2013 BEGIN - PR5148D                                   16180000
      *SB  01/30/2014 BEGIN - PR5148D                                   16190000
      *            MOVE SUT00015-AUD-CNTL-NBR TO SUATRN-AUD-CNTL-NBR    16200000
120100             SET PS-AUDIT-NBR-EXISTS TO TRUE                      16210000
                   MOVE SUT00015-AUD-CNTL-NBR TO ASC-AUD-CNTL-NBR       16220000
                   MOVE SUT00015-AUD-STAT-CDE TO ASC-AUD-STAT-CDE       16230000
      *            PERFORM 3290A-SELECT-TSUATRN                         16240000
      *SB  01/30/2014 END   - PR5148D                                   16250000
      *VSH 10/26/2013 BEGIN - PR5148D                                   16260000
120200         WHEN SQLCODE = +100                                      16270000
120300             SET PS-AUDIT-NBR-NOT-EXISTS TO TRUE                  16280000
      *VSH 10/26/2013 END - PR5148D                                     16290000
120400         WHEN SQLWARN0 NOT = SPACES                               16300000
120500         WHEN SQLCODE < ZERO                                      16310000
120600         WHEN SQLCODE > ZERO                                      16320000
120700             MOVE '3290-SELECT-AUDIT'                             16330000
120800                 TO DP013-PARAGRAPH                               16340000
120900             MOVE 'SELECT OF AUDIT REQ TABLE'                     16350000
121000                 TO DP013-MESSAGE-TEXT (1)                        16360000
121100             MOVE DK-PO                  TO PV-PO-REDEF           16370000
121200             MOVE PV-PO-REDEF-X TO DP013-MESSAGE-TEXT(2)          16380000
121300             MOVE DK-RCVR-SEQ-NBR        TO PV-RECEIVER-REDEF     16390000
121400             MOVE PV-RECEIVER-REDEF-X TO DP013-MESSAGE-TEXT(3)    16400000
121500             MOVE SQLCA            TO DP013-SQLCA                 16410000
121600             MOVE 'SUT00014'       TO DP013-DB2-TABLE-NAME (1)    16420000
121700             SET DP013-DB2-ABEND   TO TRUE                        16430000
121800             SET DP013-NO-ROLLBACK TO TRUE                        16440000
121900             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               16450000
122000             MOVE PC-DB2-DATABASE-ERROR-MSG TO AMSGLNO            16460000
122100             MOVE -1                     TO  ACARTNL              16470000
122200             PERFORM 8100-SEND-DATA-ONLY                          16480000
122300             PERFORM 8200-RETURN-TRANID                           16490000
122400     END-EVALUATE.                                                16500000
122500                                                                  16510000
      *VSH 10/26/2013 BEGIN - PR5148D                                   16520000
       3290A-SELECT-TSUATRN.                                            16530000
                                                                        16540000
           EXEC SQL                                                     16550000
               SELECT AUD_CNTL_NBR                                      16560000
                 INTO :SUATRN-AUD-CNTL-NBR                              16570000
                 FROM TSUATRN                                           16580000
                WHERE AUD_CNTL_NBR      = :SUATRN-AUD-CNTL-NBR          16590000
                  AND SHIPT_UNT_ID      = :DK-CTN                       16600000
           END-EXEC.                                                    16610000
                                                                        16620000
158200     EVALUATE TRUE                                                16630000
158300         WHEN SQLCODE = ZERO                                      16640000
120100             SET PS-AUDIT-NBR-EXISTS TO TRUE                      16650000
                   MOVE SUT00015-AUD-CNTL-NBR TO ASC-AUD-CNTL-NBR       16660000
                   MOVE SUT00015-AUD-STAT-CDE TO ASC-AUD-STAT-CDE       16670000
159500         WHEN SQLCODE = +100                                      16680000
120300             SET PS-AUDIT-NBR-NOT-EXISTS TO TRUE                  16690000
159900         WHEN SQLWARN0 NOT = SPACES                               16700000
160000         WHEN SQLCODE NOT EQUAL ZERO                              16710000
160100             MOVE '3290A-SELECT-TSUATRN'                          16720000
160200                             TO DP013-PARAGRAPH                   16730000
160300             MOVE 'THE CARTON IS INVALID'                         16740000
160400                             TO DP013-MESSAGE-TEXT(1)             16750000
160500             MOVE SUATRN-SHIPT-UNT-ID                             16760000
160600                             TO DP013-MESSAGE-TEXT(2)             16770000
160700             MOVE SQLCA      TO DP013-SQLCA                       16780000
160800             MOVE 'TSUATRN'  TO DP013-DB2-TABLE-NAME(1)           16790000
160900             SET DP013-DB2-ABEND                                  16800000
161000                             TO TRUE                              16810000
161100             SET DP013-NO-ROLLBACK                                16820000
161200                             TO TRUE                              16830000
161300             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               16840000
161400             MOVE PC-DB2-DATABASE-ERROR-MSG TO AMSGLNO            16850000
122100             MOVE -1                     TO  ACARTNL              16860000
161500             PERFORM 8100-SEND-DATA-ONLY                          16870000
161600             PERFORM 8200-RETURN-TRANID                           16880000
161700     END-EVALUATE.                                                16890000
                                                                        16900000
       3292-SELECT-RFID-AUDIT.                                          16910000
           EXEC SQL                                                     16920000
               SELECT  AUD_CNTL_NBR                                     16930000
                  ,    AUD_STAT_CDE                                     16940000
                 INTO  :SUT00015-AUD-CNTL-NBR                           16950000
                  ,    :SUT00015-AUD-STAT-CDE                           16960000
                 FROM  SUT_PO_AUD_REQ                                   16970000
                WHERE  PO_NBR            =  :DK-PO                      16980000
                  AND  PO_PREPK_ID       =  :DK-PO-PREPK-ID-RF          16990000
                  AND  RCVR_SEQ_NBR      =  :DK-RCVR-SEQ-NBR            17000000
           END-EXEC.                                                    17010000
                                                                        17020000
           EVALUATE TRUE                                                17030000
               WHEN SQLCODE = ZERO                                      17040000
      *SB  01/30/2014 BEGIN - PR5148D                                   17050000
                   SET PS-RF-AUDIT-NBR-EXISTS TO TRUE                   17060000
                   IF  PS-AUDIT-NBR-EXISTS                              17070000
                       SET ASC-COMBINED-YES TO TRUE                     17080000
                   END-IF                                               17090000
                   MOVE SUT00015-AUD-CNTL-NBR TO ASC-RF-AUD-CNTL-NBR    17100000
                   MOVE SUT00015-AUD-STAT-CDE TO ASC-RF-AUD-STAT-CDE    17110000
      *            MOVE SUT00015-AUD-CNTL-NBR TO SUATRN-AUD-CNTL-NBR    17120000
      *            PERFORM 3292A-SELECT-TSUATRN                         17130000
      *SB  01/30/2014 END   - PR5148D                                   17140000
               WHEN SQLCODE = +100                                      17150000
                   SET PS-RF-AUDIT-NBR-NOT-EXISTS TO TRUE               17160000
               WHEN SQLWARN0 NOT = SPACES                               17170000
               WHEN SQLCODE < ZERO                                      17180000
               WHEN SQLCODE > ZERO                                      17190000
                   MOVE '3292-SELECT-RFID-AUDIT'                        17200000
                       TO DP013-PARAGRAPH                               17210000
                   MOVE 'SELECT OF AUDIT REQ TABLE'                     17220000
                       TO DP013-MESSAGE-TEXT (1)                        17230000
                   MOVE DK-PO                  TO PV-PO-REDEF           17240000
                   MOVE PV-PO-REDEF-X TO DP013-MESSAGE-TEXT(2)          17250000
                   MOVE DK-RCVR-SEQ-NBR        TO PV-RECEIVER-REDEF     17260000
                   MOVE PV-RECEIVER-REDEF-X TO DP013-MESSAGE-TEXT(3)    17270000
                   MOVE SQLCA            TO DP013-SQLCA                 17280000
                   MOVE 'SUT00014'       TO DP013-DB2-TABLE-NAME (1)    17290000
                   SET DP013-DB2-ABEND   TO TRUE                        17300000
                   SET DP013-NO-ROLLBACK TO TRUE                        17310000
                   PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               17320000
                   MOVE PC-DB2-DATABASE-ERROR-MSG TO AMSGLNO            17330000
                   MOVE -1                     TO  ACARTNL              17340000
                   PERFORM 8100-SEND-DATA-ONLY                          17350000
                   PERFORM 8200-RETURN-TRANID                           17360000
           END-EVALUATE.                                                17370000
                                                                        17380000
       3292A-SELECT-TSUATRN.                                            17390000
                                                                        17400000
           EXEC SQL                                                     17410000
               SELECT AUD_CNTL_NBR                                      17420000
                 INTO :SUATRN-AUD-CNTL-NBR                              17430000
                 FROM TSUATRN                                           17440000
                WHERE AUD_CNTL_NBR      = :SUATRN-AUD-CNTL-NBR          17450000
                  AND SHIPT_UNT_ID      = :DK-CTN                       17460000
           END-EXEC.                                                    17470000
                                                                        17480000
158200     EVALUATE TRUE                                                17490000
158300         WHEN SQLCODE = ZERO                                      17500000
                   SET PS-RF-AUDIT-NBR-EXISTS TO TRUE                   17510000
                   IF  PS-AUDIT-NBR-EXISTS                              17520000
                       SET ASC-COMBINED-YES TO TRUE                     17530000
                   END-IF                                               17540000
                   MOVE SUT00015-AUD-CNTL-NBR TO ASC-RF-AUD-CNTL-NBR    17550000
                   MOVE SUT00015-AUD-STAT-CDE TO ASC-RF-AUD-STAT-CDE    17560000
159500         WHEN SQLCODE = +100                                      17570000
120300             SET PS-RF-AUDIT-NBR-NOT-EXISTS TO TRUE               17580000
159900         WHEN SQLWARN0 NOT = SPACES                               17590000
160000         WHEN SQLCODE NOT EQUAL ZERO                              17600000
160100             MOVE '3292A-SELECT-TSUATRN'                          17610000
160200                             TO DP013-PARAGRAPH                   17620000
160300             MOVE 'THE CARTON IS INVALID'                         17630000
160400                             TO DP013-MESSAGE-TEXT(1)             17640000
160500             MOVE SUATRN-SHIPT-UNT-ID                             17650000
160600                             TO DP013-MESSAGE-TEXT(2)             17660000
160700             MOVE SQLCA      TO DP013-SQLCA                       17670000
160800             MOVE 'TSUATRN'  TO DP013-DB2-TABLE-NAME(1)           17680000
160900             SET DP013-DB2-ABEND                                  17690000
161000                             TO TRUE                              17700000
161100             SET DP013-NO-ROLLBACK                                17710000
161200                             TO TRUE                              17720000
161300             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               17730000
                   MOVE PC-DB2-DATABASE-ERROR-MSG TO AMSGLNO            17740000
                   MOVE -1                     TO  ACARTNL              17750000
161500             PERFORM 8100-SEND-DATA-ONLY                          17760000
161600             PERFORM 8200-RETURN-TRANID                           17770000
161700     END-EVALUATE.                                                17780000
                                                                        17790000
      *VSH 10/26/2013 END - PR5148D                                     17800000
000000 3295-SELECT-EXCEPTION.                                           17810000
000000     EXEC SQL                                                     17820000
122800          SELECT AUD_TYP_CDE                                      17830000
122900          INTO   :SUT00014-AUD-TYP-CDE                            17840000
123000          FROM   SUT_PO_AUD_EXC                                   17850000
123100          WHERE  PO_NBR            =  :DK-PO                      17860000
123200            AND  PO_LNE_NBR        =  :DK-PO-LNE-NBR              17870000
123300            AND  PO_PREPK_ID       =  :DK-PO-PREPK-ID             17880000
123400            AND  OPER_UNT_ID       =  :DK-OPER-UNT-ID             17890000
123500     END-EXEC.                                                    17900000
123600                                                                  17910000
123700     EVALUATE TRUE                                                17920000
123800         WHEN SQLCODE = ZERO                                      17930000
      *VSH 11/26/2013 BEGIN - PR5148D                                   17940000
                   MOVE SUT00014-AUD-TYP-CDE TO ASC-AUD-TYP-CDE         17950000
      *VSH 10/26/2013 END - PR5148D                                     17960000
124000         WHEN SQLCODE = +100                                      17970000
124100             MOVE SPACES TO SUT00014-AUD-TYP-CDE                  17980000
124200         WHEN SQLWARN0 NOT = SPACES                               17990000
124300         WHEN SQLCODE < ZERO                                      18000000
124400         WHEN SQLCODE > ZERO                                      18010000
124500             MOVE '3295-SELECT-EXCEPTION'                         18020000
124600                 TO DP013-PARAGRAPH                               18030000
124700             MOVE 'SELECT OF AUDIT EXC TABLE'                     18040000
124800                 TO DP013-MESSAGE-TEXT (1)                        18050000
124900             MOVE DK-PO                  TO PV-PO-REDEF           18060000
125000             MOVE PV-PO-REDEF-X TO DP013-MESSAGE-TEXT(2)          18070000
125100             MOVE DK-RCVR-SEQ-NBR        TO PV-RECEIVER-REDEF     18080000
125200             MOVE PV-RECEIVER-REDEF-X TO DP013-MESSAGE-TEXT(3)    18090000
125300             MOVE SQLCA            TO DP013-SQLCA                 18100000
125400             MOVE 'SUT00014'       TO DP013-DB2-TABLE-NAME (1)    18110000
125500             SET DP013-DB2-ABEND   TO TRUE                        18120000
125600             SET DP013-NO-ROLLBACK TO TRUE                        18130000
125700             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               18140000
125800             MOVE PC-DB2-DATABASE-ERROR-MSG TO AMSGLNO            18150000
125900             MOVE -1                     TO  ACARTNL              18160000
126000             PERFORM 8100-SEND-DATA-ONLY                          18170000
126100             PERFORM 8200-RETURN-TRANID                           18180000
126200     END-EVALUATE.                                                18190000
126300                                                                  18200000
000000 3296-SELECT-EXCEPTION-RF.                                        18210000
000000     EXEC SQL                                                     18220000
122800          SELECT AUD_TYP_CDE                                      18230000
122900          INTO   :SUT00014-AUD-TYP-CDE                            18240000
123000          FROM   SUT_PO_AUD_EXC                                   18250000
123100          WHERE  PO_NBR            =  :DK-PO                      18260000
123200            AND  PO_LNE_NBR        =  :DK-PO-LNE-NBR              18270000
123300            AND  PO_PREPK_ID       =  :DK-PO-PREPK-ID-RF          18280000
123400            AND  OPER_UNT_ID       =  :DK-OPER-UNT-ID             18290000
123500     END-EXEC.                                                    18300000
123600                                                                  18310000
123700     EVALUATE TRUE                                                18320000
123800         WHEN SQLCODE = ZERO                                      18330000
      *VSH 11/26/2013 BEGIN - PR5148D                                   18340000
                   MOVE SUT00014-AUD-TYP-CDE TO ASC-RF-AUD-TYP-CDE      18350000
                   IF ASC-AUD-TYP-CDE NOT = SPACES                      18360000
                      SET ASC-COMBINED-YES TO TRUE                      18370000
                   END-IF                                               18380000
      *VSH 10/26/2013 END - PR5148D                                     18390000
124000         WHEN SQLCODE = +100                                      18400000
124100             MOVE SPACES TO SUT00014-AUD-TYP-CDE                  18410000
124200         WHEN SQLWARN0 NOT = SPACES                               18420000
124300         WHEN SQLCODE < ZERO                                      18430000
124400         WHEN SQLCODE > ZERO                                      18440000
124500             MOVE '3295-SELECT-EXCEPTION'                         18450000
124600                 TO DP013-PARAGRAPH                               18460000
124700             MOVE 'SELECT OF AUDIT EXC TABLE'                     18470000
124800                 TO DP013-MESSAGE-TEXT (1)                        18480000
124900             MOVE DK-PO                  TO PV-PO-REDEF           18490000
125000             MOVE PV-PO-REDEF-X TO DP013-MESSAGE-TEXT(2)          18500000
125100             MOVE DK-RCVR-SEQ-NBR        TO PV-RECEIVER-REDEF     18510000
125200             MOVE PV-RECEIVER-REDEF-X TO DP013-MESSAGE-TEXT(3)    18520000
125300             MOVE SQLCA            TO DP013-SQLCA                 18530000
125400             MOVE 'SUT00014'       TO DP013-DB2-TABLE-NAME (1)    18540000
125500             SET DP013-DB2-ABEND   TO TRUE                        18550000
125600             SET DP013-NO-ROLLBACK TO TRUE                        18560000
125700             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               18570000
125800             MOVE PC-DB2-DATABASE-ERROR-MSG TO AMSGLNO            18580000
125900             MOVE -1                     TO  ACARTNL              18590000
126000             PERFORM 8100-SEND-DATA-ONLY                          18600000
126100             PERFORM 8200-RETURN-TRANID                           18610000
126200     END-EVALUATE.                                                18620000
126300                                                                  18630000
126400 3297-SELECT-TSHPUNT.                                             18640000
126500                                                                  18650000
126600     EXEC SQL                                                     18660000
126700         SELECT SHIPT_UNT_ID                                      18670000
126800         INTO   :SHPUNT-SHIPT-UNT-ID                              18680000
126900         FROM   TSHPUNT                                           18690000
127000         WHERE  SHIPT_UNT_ID   = :DK-CTN                          18700000
127100     END-EXEC.                                                    18710000
127200                                                                  18720000
127300     EVALUATE TRUE                                                18730000
127400         WHEN SQLCODE = ZERO                                      18740000
127500            SET PS-CARTON-EXISTS TO TRUE                          18750000
127600         WHEN SQLCODE = +100                                      18760000
127700              SET PS-CARTON-DOESNT-EXIST TO TRUE                  18770000
127800         WHEN SQLWARN0 NOT = SPACES                               18780000
127900         WHEN SQLCODE < ZERO                                      18790000
128000         WHEN SQLCODE > ZERO                                      18800000
128100             MOVE '3297-SELECT-TSHPUNT'                           18810000
128200                 TO DP013-PARAGRAPH                               18820000
128300             MOVE 'SELECT OF AUDIT EXC TABLE'                     18830000
128400                 TO DP013-MESSAGE-TEXT (1)                        18840000
128500             MOVE DK-CTN     TO PV-CTN-REDEF                      18850000
128600             MOVE PV-CTN-REDEF-X TO DP013-MESSAGE-TEXT(2)         18860000
128700             MOVE SQLCA            TO DP013-SQLCA                 18870000
128800             MOVE 'TSHPUNT '       TO DP013-DB2-TABLE-NAME (1)    18880000
128900             SET DP013-DB2-ABEND   TO TRUE                        18890000
129000             SET DP013-NO-ROLLBACK TO TRUE                        18900000
129100             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               18910000
129200             MOVE PC-DB2-DATABASE-ERROR-MSG TO AMSGLNO            18920000
129300             MOVE -1                     TO  ACARTNL              18930000
129400             PERFORM 8100-SEND-DATA-ONLY                          18940000
129500             PERFORM 8200-RETURN-TRANID                           18950000
129600     END-EVALUATE.                                                18960000
129700                                                                  18970000
129800 3298-SELECT-TDISTHD.                                             18980000
129900                                                                  18990000
130000     EXEC SQL                                                     19000000
130100         SELECT  TOT_CART_CNT                                     19010000
130200              ,  OTPK_UNT_QTY                                     19020000
130300              ,  UCC128_DAT_USG_CDE                               19030000
130400           INTO  :DISTHD-TOT-CART-CNT                             19040000
130500              ,  :DISTHD-OTPK-UNT-QTY                             19050000
130600              ,  :DISTHD-UCC128-DAT-USG-CDE                       19060000
130700           FROM  TDISTHD                                          19070000
130800          WHERE  ORD_NBR         = :DK-PO                         19080000
130900            AND  RCVR_SEQ_NBR    = :DK-RCVR-SEQ-NBR               19090000
131000            AND  ORD_LNE_NBR     = :DK-PO-LNE-NBR                 19100000
131100     END-EXEC.                                                    19110000
131200                                                                  19120000
131300     EVALUATE TRUE                                                19130000
131400         WHEN SQLCODE = ZERO                                      19140000
131500            SET PS-DISTRO-EXISTS TO TRUE                          19150000
131600         WHEN SQLCODE = +100                                      19160000
131700              SET PS-DISTRO-DOESNT-EXIST TO TRUE                  19170000
131800         WHEN SQLWARN0 NOT = SPACES                               19180000
131900         WHEN SQLCODE < ZERO                                      19190000
132000         WHEN SQLCODE > ZERO                                      19200000
132100             MOVE '3298-SELECT-TDISTHD'                           19210000
132200                 TO DP013-PARAGRAPH                               19220000
132300             MOVE 'SELECT OF DISTRO FOR PO, LINE'                 19230000
132400                 TO DP013-MESSAGE-TEXT (1)                        19240000
132500             MOVE DK-PO                  TO PV-PO-REDEF           19250000
132600             MOVE PV-PO-REDEF-X TO DP013-MESSAGE-TEXT(2)          19260000
132700             MOVE DK-RCVR-SEQ-NBR        TO PV-RECEIVER-REDEF     19270000
132800             MOVE PV-RECEIVER-REDEF-X TO DP013-MESSAGE-TEXT(3)    19280000
132900             MOVE DK-PO-LNE-NBR          TO PV-PO-LINE-REDEF      19290000
133000             MOVE PV-PO-LINE-REDEF-X  TO DP013-MESSAGE-TEXT(4)    19300000
133100             MOVE SQLCA            TO DP013-SQLCA                 19310000
133200             MOVE 'TDISTHD '       TO DP013-DB2-TABLE-NAME (1)    19320000
133300             SET DP013-DB2-ABEND   TO TRUE                        19330000
133400             SET DP013-NO-ROLLBACK TO TRUE                        19340000
133500             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               19350000
133600             MOVE PC-DB2-DATABASE-ERROR-MSG TO AMSGLNO            19360000
133700             MOVE -1                     TO  ACARTNL              19370000
133800             PERFORM 8100-SEND-DATA-ONLY                          19380000
133900             PERFORM 8200-RETURN-TRANID                           19390000
134000     END-EVALUATE.                                                19400000
134100                                                                  19410000
134200                                                                  19420000
134300 3299-SELECT-TDISTHD.                                             19430000
134400     EXEC SQL                                                     19440000
134500         SELECT  TOT_CART_CNT                                     19450000
134600              ,  OTPK_UNT_QTY                                     19460000
134700           INTO  :DISTHD-TOT-CART-CNT                             19470000
134800              ,  :DISTHD-OTPK-UNT-QTY                             19480000
134900           FROM  TDISTHD                                          19490000
135000          WHERE  ORD_NBR           = :DK-PO                       19500000
135100            AND  RCVR_SEQ_NBR      = :DK-RCVR-SEQ-NBR             19510000
135200            AND  ORD_LNE_NBR       = :DK-PO-LNE-NBR               19520000
135300            AND  PREPK_LNE_PRC_CDE = :PC-D                        19530000
135400     END-EXEC.                                                    19540000
135500                                                                  19550000
135600     EVALUATE TRUE                                                19560000
135700         WHEN SQLCODE = ZERO                                      19570000
135800            SET PS-DISTRO-EXISTS TO TRUE                          19580000
135900         WHEN SQLCODE = +100                                      19590000
136000              SET PS-DISTRO-DOESNT-EXIST TO TRUE                  19600000
136100         WHEN SQLWARN0 NOT = SPACES                               19610000
136200         WHEN SQLCODE < ZERO                                      19620000
136300         WHEN SQLCODE > ZERO                                      19630000
136400             MOVE '3299-SELECT-TDISTHD'                           19640000
136500                 TO DP013-PARAGRAPH                               19650000
136600             MOVE 'SELECT OF DISTRO FOR PO, LINE'                 19660000
136700                 TO DP013-MESSAGE-TEXT (1)                        19670000
136800             MOVE DK-PO                  TO PV-PO-REDEF           19680000
136900             MOVE PV-PO-REDEF-X TO DP013-MESSAGE-TEXT(2)          19690000
137000             MOVE DK-RCVR-SEQ-NBR        TO PV-RECEIVER-REDEF     19700000
137100             MOVE PV-RECEIVER-REDEF-X TO DP013-MESSAGE-TEXT(3)    19710000
137200             MOVE DK-PO-LNE-NBR          TO PV-PO-LINE-REDEF      19720000
137300             MOVE PV-PO-LINE-REDEF-X  TO DP013-MESSAGE-TEXT(4)    19730000
137400             MOVE SQLCA            TO DP013-SQLCA                 19740000
137500             MOVE 'TDISTHD '       TO DP013-DB2-TABLE-NAME (1)    19750000
137600             SET DP013-DB2-ABEND   TO TRUE                        19760000
137700             SET DP013-NO-ROLLBACK TO TRUE                        19770000
137800             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               19780000
137900             MOVE PC-DB2-DATABASE-ERROR-MSG TO AMSGLNO            19790000
138000             MOVE -1                     TO  ACARTNL              19800000
138100             PERFORM 8100-SEND-DATA-ONLY                          19810000
138200             PERFORM 8200-RETURN-TRANID                           19820000
138300     END-EVALUATE.                                                19830000
138400                                                                  19840000
138500                                                                  19850000
138600 3300-CHECK-IF-AUDIT-NUMBER.                                      19860000
138700                                                                  19870000
138800     MOVE PV-CTN                     TO DP010I-UNEDITED-FIELD.    19880000
138900     MOVE 9                          TO DP010I-MAXIMUM-DIGITS.    19890000
139000     MOVE 0                          TO DP010I-MAXIMUM-DECIMALS.  19900000
139100     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     19910000
139200                                                                  19920000
263968     CALL DP010I-NUMERIC-EDIT-ROUTINE                             19931095
263968          USING DP010I-NUMERIC-EDIT-AREA.                         19932095
139400                                                                  19940000
139500     IF  DP010I-ERROR-DETECTED                                    19950000
139600         SET PS-INVALID-INPUT        TO TRUE                      19960000
139700         MOVE PC-CARTON-NOT-FOUND-MSG                             19970000
139800                                     TO AMSGLNO                   19980000
139900         MOVE -1                     TO ACARTNL                   19990000
140000     ELSE                                                         20000000
140100         MOVE DP010I-NUMERIC-FIELD   TO DK-AUDIT-CNTL-NBR         20010000
140200         PERFORM 3400-VALIDATE-AUDIT-NBR                          20020000
140300     END-IF.                                                      20030000
140400                                                                  20040000
140500 EJECT                                                            20050000
140600****************************************************************  20060000
140700* 3400-VALIDATE-AUDIT-NBR                                      *  20070000
140800*      CHECK THE USER ENTERED AUDIT CONTROL NUMBER - VALIDATE  *  20080000
140900*      EXISTENCE BY GETTING THE AUDIT STATUS                   *  20090000
141000****************************************************************  20100000
141100 3400-VALIDATE-AUDIT-NBR.                                         20110000
141200                                                                  20120000
141300     EXEC SQL                                                     20130000
141400         SELECT  AUD_CNTL_NBR                                     20140000
141500            ,    AUD_STAT_CDE                                     20150000
141600           INTO  :SUT00015-AUD-CNTL-NBR                           20160000
141700            ,    :SUT00015-AUD-STAT-CDE                           20170000
141800           FROM  SUT_PO_AUD_REQ                                   20180000
141900          WHERE  AUD_CNTL_NBR      =  :DK-AUDIT-CNTL-NBR          20190000
142000     END-EXEC.                                                    20200000
142100                                                                  20210000
142200     EVALUATE TRUE                                                20220000
142300         WHEN SQLCODE = ZERO                                      20230000
142400             SET PS-AUDIT-NBR-EXISTS TO TRUE                      20240000
142500             SET PS-CARTON-EXISTS TO TRUE                         20250000
142600         WHEN SQLCODE = +100                                      20260000
142700             SET PS-AUDIT-NBR-NOT-EXISTS TO TRUE                  20270000
142800             SET PS-CARTON-DOESNT-EXIST TO TRUE                   20280000
142900         WHEN SQLWARN0 NOT = SPACES                               20290000
143000         WHEN SQLCODE < ZERO                                      20300000
143100         WHEN SQLCODE > ZERO                                      20310000
143200             MOVE '3400-VALIDATE-AUDIT-NBR.'                      20320000
143300                 TO DP013-PARAGRAPH                               20330000
143400             MOVE 'SELECT OF TSUNAUD TABLE'                       20340000
143500                 TO DP013-MESSAGE-TEXT (1)                        20350000
143600             MOVE DK-AUDIT-CNTL-NBR TO PV-DISP-AUDIT-CNTL-NBR     20360000
143700             MOVE PV-DISP-AUDIT-CNTL-NBR                          20370000
143800                 TO DP013-MESSAGE-TEXT (2)                        20380000
143900             MOVE SQLCA            TO DP013-SQLCA                 20390000
144000             MOVE 'TSUNAUD'        TO DP013-DB2-TABLE-NAME (1)    20400000
144100             SET DP013-DB2-ABEND   TO TRUE                        20410000
144200             SET DP013-NO-ROLLBACK TO TRUE                        20420000
144300             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               20430000
144400             MOVE PC-DB2-DATABASE-ERROR-MSG TO AMSGLNO            20440000
144500             MOVE -1                     TO  ACARTNL              20450000
144600             PERFORM 8100-SEND-DATA-ONLY                          20460000
144700             PERFORM 8200-RETURN-TRANID                           20470000
144800     END-EVALUATE.                                                20480000
144900                                                                  20490000
145000 3500-SELECT-SHUNLO.                                              20500000
145100                                                                  20510000
145200     EXEC SQL                                                     20520000
145300         SELECT  SHIPT_UNT_ID                                     20530000
145400         INTO   :SHPUNT-SHIPT-UNT-ID                              20540000
145500         FROM   TSHUNLO                                           20550000
145600         WHERE  SHIPT_UNT_ID   = :DK-CTN                          20560000
145700           AND  SCN_LOC_ID     = :PC-RECV                         20570000
145800     END-EXEC.                                                    20580000
145900                                                                  20590000
146000     EVALUATE TRUE                                                20600000
146100         WHEN SQLCODE = ZERO                                      20610000
146200         WHEN SQLCODE = -811                                      20620000
146300            SET PS-CARTON-CHECKED-IN TO TRUE                      20630000
146400         WHEN SQLCODE = +100                                      20640000
146500              SET PS-CARTON-NOT-CHECKED-IN TO TRUE                20650000
146600         WHEN SQLWARN0 NOT = SPACES                               20660000
146700         WHEN SQLCODE < ZERO                                      20670000
146800         WHEN SQLCODE > ZERO                                      20680000
146900             MOVE '3500-SELECT-SHUNLO'                            20690000
147000                 TO DP013-PARAGRAPH                               20700000
147100             MOVE 'SELECT OF TSHUNLO TABLE'                       20710000
147200                                   TO DP013-MESSAGE-TEXT (1)      20720000
147300             MOVE DK-CTN           TO PV-CTN-REDEF                20730000
147400             MOVE PV-CTN-REDEF-X   TO DP013-MESSAGE-TEXT(2)       20740000
147500             MOVE SQLCA            TO DP013-SQLCA                 20750000
147600             MOVE 'TSHUNLO'        TO DP013-DB2-TABLE-NAME (1)    20760000
147700             SET DP013-DB2-ABEND   TO TRUE                        20770000
147800             SET DP013-NO-ROLLBACK TO TRUE                        20780000
147900             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               20790000
148000             MOVE PC-DB2-DATABASE-ERROR-MSG TO AMSGLNO            20800000
148100             MOVE -1                     TO  ACARTNL              20810000
148200             PERFORM 8100-SEND-DATA-ONLY                          20820000
148300             PERFORM 8200-RETURN-TRANID                           20830000
148400     END-EVALUATE.                                                20840000
148500                                                                  20850000
148600 EJECT                                                            20860000
148700******************************************************************20870000
148800**SELECT TO DETERMINE IF THE CARTON SCANNED FOR STATUS IS ONE OF *20880000
148900**THE CARTONS SELECTED FOR AUDIT                                 *20890000
149000******************************************************************20900000
149100 3600-SELECT-TSUATRN.                                             20910000
149200                                                                  20920000
149300     EXEC SQL                                                     20930000
149400         SELECT  TRN_NBR                                          20940000
149500         INTO   :SUATRN-TRN-NBR                                   20950000
149600         FROM   TSUATRN                                           20960000
149700         WHERE  AUD_CNTL_NBR   = :SUT00015-AUD-CNTL-NBR           20970000
149800           AND  SHIPT_UNT_ID   = :DK-CTN                          20980000
149900     END-EXEC.                                                    20990000
150000                                                                  21000000
150100     EVALUATE TRUE                                                21010000
150200         WHEN SQLCODE = ZERO                                      21020000
150210         WHEN SQLCODE = -811                                      21030000
150220              SET PS-SELECTED-CARTON-YES TO TRUE                  21040000
150230         WHEN SQLCODE = +100                                      21050000
150240              SET PS-SELECTED-CARTON-NO TO TRUE                   21060000
150250         WHEN SQLWARN0 NOT = SPACES                               21070000
150260         WHEN SQLCODE < ZERO                                      21080000
150270         WHEN SQLCODE > ZERO                                      21090000
150280             MOVE '3600-SELECT-TSUATRN'                           21100000
150290                 TO DP013-PARAGRAPH                               21110000
150300             MOVE 'SELECT OF TSUATRN TABLE'                       21120000
150301                                   TO DP013-MESSAGE-TEXT (1)      21130000
150302             MOVE DK-CTN           TO PV-CTN-REDEF                21140000
150303             MOVE PV-CTN-REDEF-X   TO DP013-MESSAGE-TEXT(2)       21150000
150304             MOVE SQLCA            TO DP013-SQLCA                 21160000
150305             MOVE 'TSUATRN'        TO DP013-DB2-TABLE-NAME (1)    21170000
150306             SET DP013-DB2-ABEND   TO TRUE                        21180000
150307             SET DP013-NO-ROLLBACK TO TRUE                        21190000
150308             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               21200000
150309             MOVE PC-DB2-DATABASE-ERROR-MSG TO AMSGLNO            21210000
150310             MOVE -1                     TO  ACARTNL              21220000
150311             PERFORM 8100-SEND-DATA-ONLY                          21230000
150312             PERFORM 8200-RETURN-TRANID                           21240000
150313     END-EVALUATE.                                                21250000
150314                                                                  21260000
150315 EJECT                                                            21270000
150316                                                                  21280000
150317 3670-CHECK-CURRENT-DIRECTIVE.                                    21290000
150318*    DISPLAY '3670-CHECK-CURRENT-DIRECTIVE'                       21300093
150319*    DISPLAY 'SUT00102-BRCDE-NBR ' SUT00102-BRCDE-NBR             21310093
150320     SET PS-RFID-DIRECTIVE-NO TO TRUE.                            21320000
150322                                                                  21330000
150323     EXEC SQL                                                     21340000
150324         SELECT DT1.DIRV_RSN_CDE                                  21350000
150325         INTO  :SUT00102-DIRV-RSN-CDE                             21360000
150326         FROM   SUT_CART_DIRV_TRKG  DT1                           21370000
150327         WHERE  DT1.BRCDE_NBR    =  :SUT00102-BRCDE-NBR           21380000
150328           AND  DT1.CRE_TMST =                                    21390000
150329                   (                                              21400000
150330                    SELECT MAX(DT2.CRE_TMST)                      21410000
150331                    FROM   SUT_CART_DIRV_TRKG  DT2                21420000
150332                    WHERE  DT2.BRCDE_NBR     =  DT1.BRCDE_NBR     21430000
150333                   )                                              21440000
150334     END-EXEC                                                     21450000
150335     EVALUATE TRUE                                                21460000
150336         WHEN SQLCODE = ZERO                                      21470000
150337         WHEN SQLCODE = -811                                      21480000
150338*             DISPLAY 'SQLCODE'  SQLCODE                          21490093
150339*             DISPLAY 'DIRV-RSN-CDE' SUT00102-DIRV-RSN-CDE        21500093
150340              IF SUT00102-DIRV-RSN-CDE = 'RFD'                    21510000
150341                 SET PS-RFID-DIRECTIVE-YES TO TRUE                21520000
150342              END-IF                                              21530000
150343*             DISPLAY 'PS-RFID-DIRECTIVE-SW=' PS-RFID-DIRECTIVE-SW21540093
150344         WHEN SQLCODE = +100                                      21550000
150345*             DISPLAY 'SQLCODE'  SQLCODE                          21560093
150346              SET PS-RFID-DIRECTIVE-NO  TO TRUE                   21570000
150347         WHEN SQLWARN0 NOT = SPACES                               21580000
150348         WHEN SQLCODE < ZERO                                      21590000
150349         WHEN SQLCODE > ZERO                                      21600000
150350             MOVE '3670-CHECK-CURRENT-DIRECTIVE'                  21610000
150351                 TO DP013-PARAGRAPH                               21620000
150352             MOVE 'SELECT OF SUT_CART_DIRV_TRKG '                 21630000
150353                                   TO DP013-MESSAGE-TEXT (1)      21640000
150354             MOVE DK-BRCDE-NBR     TO DP013-MESSAGE-TEXT(2)       21650000
150355             MOVE SQLCA            TO DP013-SQLCA                 21660000
150356             MOVE 'SUT_CART_DIRV'  TO DP013-DB2-TABLE-NAME (1)    21670000
150357             SET DP013-DB2-ABEND   TO TRUE                        21680000
150358             SET DP013-NO-ROLLBACK TO TRUE                        21690000
150359             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               21700000
150360             MOVE PC-DB2-DATABASE-ERROR-MSG TO AMSGLNO            21710000
150361             MOVE -1                     TO  ACARTNL              21720000
150362             PERFORM 8100-SEND-DATA-ONLY                          21730000
150363             PERFORM 8200-RETURN-TRANID                           21740000
150364     END-EVALUATE.                                                21750000
150365                                                                  21760000
150371**************************************************************    21770044
150367* 3700-LINK-COMMON-CARTON-CLOSE                              *    21780000
150368*     WHEN APPLICABLE FILL IN COPYBOOK SUWS091               *    21790000
150369*                     LINK TO SUKCS769                       *    21800000
150370*                     CHECK RETURN FOR ERRORS UPON RETURN    *    21810000
150371**************************************************************    21820000
150372 3700-LINK-COMMON-CARTON-CLOSE.                                   21830000
150373                                                                  21840000
150374     INITIALIZE CCC-REQUEST-COMMUNICATION-AREA.                   21850000
150375                                                                  21860000
150376     MOVE '00'                    TO SU091-RET-CODE.              21870000
150377     MOVE PC-CURRENT-PROGRAM-NAME TO SU091-CALLING-PGM.           21880000
150378     MOVE DP026-LOCATION-NBR      TO SU091-OPER-UNT-ID.           21890000
150379                                                                  21900000
150380     MOVE ZEROS                   TO SU091-SHIPT-UNT-ID           21910000
150381                                                                  21920000
150382     MOVE SUT00015-AUD-CNTL-NBR   TO SU091-AUD-CNTL-NBR.          21930000
150383     MOVE SUT00015-AUD-STAT-CDE   TO SU091-AUD-STAT-CDE.          21940000
150384                                                                  21950000
150385     SET SU091-PROMPTED-AUDIT TO TRUE                             21960000
150386                                                                  21970000
150387     MOVE DP026-USERID            TO SU091-ASSOC-ID.              21980000
150388                                                                  21990000
150389     EXEC CICS LINK                                               22000000
150390               PROGRAM  (PC-COMMON-CARTON-CLOSE-PGM)              22010000
150391               COMMAREA (CCC-REQUEST-COMMUNICATION-AREA)          22020000
150392               LENGTH   (LENGTH OF CCC-REQUEST-COMMUNICATION-AREA)22030000
150393               RESP     (PV-CICS-RESPONSE)                        22040000
150394     END-EXEC.                                                    22050000
150395                                                                  22060000
150396     EVALUATE TRUE                                                22070000
150397         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 22080000
150398             CONTINUE                                             22090000
150399         WHEN OTHER                                               22100000
150400             MOVE '3700-LINK-COMMON-CARTON-CLOSE'                 22110000
150401               TO DP013-PARAGRAPH                                 22120000
150402             MOVE 'BAD LINK TO PGM SUKCS769'                      22130000
150403               TO DP013-MESSAGE-TEXT (1)                          22140000
150404             SET DP013-CICS-ABEND     TO TRUE                     22150000
150405             SET DP013-NO-ROLLBACK    TO TRUE                     22160000
150406             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               22170000
150407             MOVE PC-CCC-PGM-LINK-ERR TO AMSGLNO                  22180000
150408             PERFORM 8100-SEND-DATA-ONLY                          22190000
150409             PERFORM 8200-RETURN-TRANID                           22200000
150410     END-EVALUATE.                                                22210000
150411                                                                  22220000
150412******************************************************************22230000
150413******************************************************************22240000
150414 4000-XCTL-LRT-MENU.                                              22250000
150420     SET SU001-INITIALIZE-SCREEN  TO TRUE.                        22260000
150500                                                                  22270000
150600     MOVE LENGTH OF CA-COMMAREA   TO PV-COMMAREA-LENGTH           22280000
150700     EXEC CICS                                                    22290000
150800         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    22300000
150900               COMMAREA  (CA-COMMAREA)                            22310000
151000               LENGTH    (PV-COMMAREA-LENGTH)                     22320000
151100               RESP      (PV-CICS-RESPONSE)                       22330000
151200     END-EXEC.                                                    22340000
151300                                                                  22350000
151400     EVALUATE TRUE                                                22360000
151500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 22370000
151600             CONTINUE                                             22380000
151700         WHEN OTHER                                               22390000
151800             MOVE '4000-XCTL-TO-LRT-MENU'                         22400000
151900                 TO DP013-PARAGRAPH                               22410000
152000             MOVE 'SUKRF538 - UNABLE TO XCTL TO PROGRAM: '        22420000
152100                 TO DP013-MESSAGE-TEXT (1)                        22430000
152200             MOVE PV-TRANSFER-PROGRAM                             22440000
152300                 TO DP013-MESSAGE-TEXT (2)                        22450000
152400             SET DP013-CICS-ABEND  TO TRUE                        22460000
152500             SET DP013-ROLLBACK TO TRUE                           22470000
152600             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               22480000
152700             MOVE PC-TRANS-UNAVAILABLE-MSG TO AMSGLNO             22490000
152800             SET SU001-PROCESS-SCREEN TO TRUE                     22500000
152900             PERFORM 8000-SEND-MAP                                22510000
153000             PERFORM 8200-RETURN-TRANID                           22520000
153100     END-EVALUATE.                                                22530000
153200                                                                  22540000
153300                                                                  22550000
153400*----------------------------------------------------------------*22560000
153500*                                                                *22570000
153600*----------------------------------------------------------------*22580000
153700 8000-SEND-MAP.                                                   22590000
153800                                                                  22600000
153900     EXEC CICS                                                    22610000
154000         SEND MAP       ('SU538A')                                22620000
154100              MAPSET    ('SUKM538')                               22630000
154200              ERASE                                               22640000
154300              CURSOR                                              22650000
154400              RESP      (PV-CICS-RESPONSE)                        22660000
154500     END-EXEC.                                                    22670000
154600                                                                  22680000
154700     EVALUATE TRUE                                                22690000
154800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 22700000
154900             CONTINUE                                             22710000
155000         WHEN OTHER                                               22720000
155100             MOVE '8000-SEND-MAP'      TO DP013-PARAGRAPH         22730000
155200             MOVE 'SUKRF538 - UNABLE TO SEND MAP'                 22740000
155300                                       TO DP013-MESSAGE-TEXT (1)  22750000
155400             SET DP013-CICS-ABEND      TO TRUE                    22760000
155500             SET DP013-ROLLBACK        TO TRUE                    22770000
155600             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               22780000
155700             MOVE PM-DB2-FATAL-ERROR-MSG TO AMSGLNO               22790000
155800             PERFORM 8100-SEND-DATA-ONLY                          22800000
155900             PERFORM 8200-RETURN-TRANID                           22810000
156000     END-EVALUATE.                                                22820000
156100                                                                  22830000
156200 8100-SEND-DATA-ONLY.                                             22840000
156300                                                                  22850000
156400     EXEC CICS                                                    22860000
156500         SEND MAP       ('SU538A')                                22870000
156600              MAPSET    ('SUKM538')                               22880000
156700              CURSOR                                              22890000
156800              DATAONLY                                            22900000
156900              RESP      (PV-CICS-RESPONSE)                        22910000
157000     END-EXEC.                                                    22920000
157100                                                                  22930000
157200     EVALUATE TRUE                                                22940000
157300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 22950000
157400             CONTINUE                                             22960000
157500         WHEN OTHER                                               22970000
157600             MOVE '8100-SEND-DATA-ONLY' TO DP013-PARAGRAPH        22980000
157700             MOVE 'SUKRF538 - UNABLE TO SEND DATA'                22990000
157800                                        TO DP013-MESSAGE-TEXT (1) 23000000
157900             SET DP013-CICS-ABEND       TO TRUE                   23010000
158000             SET DP013-ROLLBACK         TO TRUE                   23020000
158100             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               23030000
158200     END-EVALUATE.                                                23040000
158300                                                                  23050000
158400 8200-RETURN-TRANID.                                              23060000
158500                                                                  23070000
158600     MOVE LENGTH OF CA-COMMAREA  TO PV-COMMAREA-LENGTH            23080000
158700     EXEC CICS                                                    23090000
158800         RETURN TRANSID  (PC-TRANID)                              23100000
158900                COMMAREA (CA-COMMAREA)                            23110000
159000                LENGTH   (PV-COMMAREA-LENGTH)                     23120000
159100                RESP     (PV-CICS-RESPONSE)                       23130000
159200     END-EXEC.                                                    23140000
159300                                                                  23150000
159400     EVALUATE TRUE                                                23160000
159500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 23170000
159600             CONTINUE                                             23180000
159700         WHEN OTHER                                               23190000
159800             MOVE '8200-RETURN-TRANIND' TO DP013-PARAGRAPH        23200000
159900             MOVE 'SUKRF538 - UNABLE TO RETURN TO TRANID'         23210000
160000                 TO DP013-MESSAGE-TEXT (1)                        23220000
160100             SET DP013-CICS-ABEND       TO TRUE                   23230000
160200             SET DP013-ROLLBACK         TO TRUE                   23240000
160300             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               23250000
160400     END-EVALUATE.                                                23260000
160500                                                                  23270000
160600*                                                                 23280000
160700 8250-XCTL-TO-HELP.                                               23290000
160800                                                                  23300000
160900     MOVE LENGTH OF PC192-COMMAREA    TO PV-COMMAREA-LENGTH       23310000
161000                                                                  23320000
161100     EXEC CICS                                                    23330000
161200         XCTL                                                     23340000
161300             PROGRAM   (PV-TRANSFER-PROGRAM)                      23350000
161400             COMMAREA  (PC192-COMMAREA)                           23360000
161500             LENGTH    (PV-COMMAREA-LENGTH)                       23370000
161600             RESP      (PV-CICS-RESPONSE)                         23380000
161700     END-EXEC.                                                    23390000
161800                                                                  23400000
161900     EVALUATE TRUE                                                23410000
162000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 23420000
162100              CONTINUE                                            23430000
162200         WHEN OTHER                                               23440000
162300             MOVE '8250-XCTL-TO-HELP' TO DP013-PARAGRAPH          23450000
162400             MOVE 'PCKRF730 - UNABLE TO XCTL TO PROGRAM: '        23460000
162500                                      TO DP013-MESSAGE-TEXT (1)   23470000
162600             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   23480000
162700             SET DP013-CICS-ABEND                                 23490000
162800                 DP013-ROLLBACK       TO TRUE                     23500000
162900             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               23510000
163000             MOVE PC-TRANS-UNAVAILABLE-MSG                        23520000
163100                                      TO AMSGLNO                  23530000
163200             SET SU001-PROCESS-SCREEN TO TRUE                     23540000
163300             MOVE -1                  TO ACARTNL                  23550000
163400             PERFORM 8000-SEND-MAP                                23560000
163500             PERFORM 8200-RETURN-TRANID                           23570000
163600     END-EVALUATE.                                                23580000
163700*                                                                 23590000
163800 8300-RETURN.                                                     23600000
163900                                                                  23610000
164000     EXEC CICS                                                    23620000
164100         SEND FROM (PV-MESSAGE-AREA)                              23630000
164200              LENGTH (19)                                         23640000
164300              ERASE                                               23650000
164400     END-EXEC.                                                    23660000
164500                                                                  23670000
164600     EXEC CICS                                                    23680000
164700         RETURN                                                   23690000
164800     END-EXEC.                                                    23700000
164900                                                                  23710000
165000                                                                  23720000
165100 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  23730000
165200                                                                  23740000
165300     MOVE PC-CURRENT-PROGRAM-NAME  TO DP013-PROGRAM.              23750000
165400     MOVE DFHEIBLK                 TO DP013-DFHEIBLK.             23760000
165500     INITIALIZE DP013-SRC-TASK-NUMBER                             23770000
165600                DP013-STACK.                                      23780000
165700     SET DP013-LINK-RETURN TO TRUE.                               23790000
165800                                                                  23800000
165900     EXEC CICS                                                    23810000
166000         LINK                                                     23820000
166100             PROGRAM   (DP013-NAME)                               23830000
166200             COMMAREA  (DP013-PARAMETERS)                         23840000
166300             LENGTH    (DP013-LENGTH)                             23850000
166400     END-EXEC.                                                    23860000
166500                                                                  23870000
166600*----------------------------------------------------------------*23880000
166700*    GET LOGON INFORMATION FOR NON-ARCHITECTURE PROGRAMS         *23890000
166800*----------------------------------------------------------------*23900000
166900                                                                  23910000
167000     COPY DPPD026.                                                23920000
167100*----------------------------------------------------------------*23930000
167200*    ABEND PROCESSOR MODULE                                      *23940000
167300*----------------------------------------------------------------*23950000
167400                                                                  23960000
167500     COPY DPPD014.                                                23970000
167600                                                                  23980000
