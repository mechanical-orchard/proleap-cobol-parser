000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.   TRKUT250.                                          00050000
000600 AUTHOR.       THERESE RAMSEYER.                                  00060000
000700 INSTALLATION. KOHLS DEPARTMENT STORES.                           00070000
000800 DATE-WRITTEN. OCTOBER, 1998.                                     00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200*  THIS PROGRAM EDITS THE CONTAINER DELIVERY DATA.               *00120000
001300*  THE INPUT FOR THIS PROGRAM CONSISTS OF 5 DIFFERENT RECORD TYPES00130000
001400*  THAT MAY BE PRESENT ON A FILE.                                 00140000
001500*  DPU = SENT AFTER THE DELIVERY ORDER IS RECEIVED FROM THE       00150000
001600*        DECONSOLIDATOR WHO ACKNOWLEDGES RECEIPT OF DOP.          00160000
001700*  DLV = SENT AFTER THE CONTAINER OR SHIPMENT IS PICKED UP BY     00170000
001800*        THE DECONSOLIDATOR.                                      00180000
001900*  DVN = SENT AFTER THE CONTAINER OR SHIPMENT IS DEVANNED.        00190000
002000*  CRP = SENT AFTER THE CONTAINER OR SHIPMENT IS READY FOR        00200000
002100*        PICK UP BY DECONSOLIDATOR.                               00210000
002200*  RTN = SENT AFTER THE CONTAINER HAS BEEN RETURNED BY THE        00220000
002300*        DECONSOLIDATOR TO THE DOCK.                              00230000
002400*                                                                 00240000
002500*  EACH OF THE 5 RECORD TYPES MAY BE ANY TRANSACTION TYPE:        00250000
002600*            (A) ADD, (D) DELETE OR (C) CHANGE.                   00260000
002700*                                                                 00270000
002800*  THE KEY FIELDS ARE: CONTAINER ID AND PO NUMBER                 00280000
003000*                                                                 00300000
003100*  A PROCESS SEQUENCE NUMBER IS ASSIGNED TO EACH RECORD. THIS     00310000
003200*  NUMBER WILL BE REFLECTED IN THE LOAD PROGRAM ON EACH CONTAINER 00320000
003300*  RECORD. THIS WAY, THE ERROR EXTRACT CAN BE SORTED AND ALL OF   00330000
003400*  THE ERROR/WARNING MESSAGES WILL BE INCLUDED TOGETHER FOR EACH  00340000
003500*  CONTAINER RECORD WHETHER IT CAME FROM THE EDIT PROGRAM OR THE  00350000
003600*  LOAD.                                                          00360000
003700*  DATES ARE CHECKED FOR VALIDITY BY CALLING THE KOHL'S CALENDAR  00370000
003800*  ROUTINE DPKUT500.                                              00380000
003900*  TIME FIELDS ARE GENERALLY ONLY EDITED FOR VALIDITY IF THEY ARE 00390000
004000*  SENT. MOST ARE NOT REQUIRED SINCE IT IS NECESSARY TO USE A     00400000
004100*  DEFAULT TIME WHEN UPDATING AND DEFAULT DATE AND TIME WHEN      00410000
004200*  DELETING.                                                      00420000
004300*  EACH RECORD TYPE IS INDEPENDENT OF EACH OTHER. NO ONE TYPE     00430000
004400*  OF RECORD IS REQUIRED BEFORE THE PROCESSING OF ANOTHER.        00440000
004500*                                                                 00450000
      * ****************************************************************00451007
      * CHANGE DESCRIPTION                                              00452006
      * ****************************************************************00453006
      * DATE  07/01/2010                                                00454006
      *  CHANGE MADE: ADDED THE NEW RECORD TYPE 'ARVDCN' WHICH WOULD    00455007
      *  CONTAIN INFORMATION PERTAINING TO THE ARRIVAL OF CONTAINERS AT 00456007
      *  THE DECONSOLIDATOR. THIS IS BEING DONE AS PART OF THE IMPORT   00457007
      *  REPLENISHMENT PROJECT 2010.                                    00457107
      * MADE BY: MONIKA SACHDEVA         TKID: TKMAW78                  00458006
      * CHANGES TAGGED AS MS 07/01/2010                                 00459007
004600******************************************************************00460000
004700******************************************************************00470000
004800 ENVIRONMENT DIVISION.                                            00480000
004900******************************************************************00490000
005000                                                                  00500000
005100 CONFIGURATION SECTION.                                           00510000
005200                                                                  00520000
005300 SOURCE-COMPUTER.        IBM-3090.                                00530000
005400 OBJECT-COMPUTER.        IBM-3090.                                00540000
005500                                                                  00550000
005600 INPUT-OUTPUT SECTION.                                            00560000
005700                                                                  00570000
005800 FILE-CONTROL.                                                    00580000
005900                                                                  00590000
006000     SELECT TR018-DELIVERY-FILE                                   00600000
006100         ASSIGN TO INP01.                                         00610000
006200                                                                  00620000
006300     SELECT TR028-UPDATE-DELIVERY-FILE                            00630000
006400         ASSIGN TO OUT01.                                         00640000
006500                                                                  00650000
006600     SELECT TR251-DELIVERY-ERROR-FILE                             00660000
006700         ASSIGN TO OUT02.                                         00670000
006800                                                                  00680000
006900     SELECT TR018-DELIVERY-TURNAROUND-FILE                        00690000
007000         ASSIGN TO OUT03.                                         00700000
007100                                                                  00710000
007200******************************************************************00720000
007300 DATA DIVISION.                                                   00730000
007400******************************************************************00740000
007500                                                                  00750000
007600 FILE SECTION.                                                    00760000
007700                                                                  00770000
007800 FD  TR018-DELIVERY-FILE                                          00780000
007900     RECORDING MODE IS F                                          00790000
008000     LABEL RECORDS ARE STANDARD                                   00800000
008100     BLOCK CONTAINS 0 RECORDS.                                    00810000
008200                                                                  00820000
008300 01  TR018-DELIVERY-RECORD            PIC X(300).                 00830000
008400                                                                  00840000
008500 FD  TR028-UPDATE-DELIVERY-FILE                                   00850000
008600     RECORDING MODE IS F                                          00860000
008700     LABEL RECORDS ARE STANDARD                                   00870000
008800     BLOCK CONTAINS 0 RECORDS.                                    00880000
008900                                                                  00890000
009000 01  TR028-UPDATE-DELIVERY-RECORD     PIC X(300).                 00900000
009100                                                                  00910000
009200 FD  TR251-DELIVERY-ERROR-FILE                                    00920000
009300     RECORDING MODE IS F                                          00930000
009400     LABEL RECORDS ARE STANDARD                                   00940000
009500     BLOCK CONTAINS 0 RECORDS.                                    00950000
009600                                                                  00960000
009700 01  TR251-DELIVERY-ERROR-RECORD      PIC X(508).                 00970000
009800                                                                  00980000
009900 FD  TR018-DELIVERY-TURNAROUND-FILE                               00990000
010000     RECORDING MODE IS F                                          01000000
010100     LABEL RECORDS ARE STANDARD                                   01010000
010200     BLOCK CONTAINS 0 RECORDS.                                    01020000
010300                                                                  01030000
010400 01  TR018-DELIVERY-TURNAROUND-REC    PIC X(300).                 01040000
010500                                                                  01050000
010600******************************************************************01060000
010700 WORKING-STORAGE SECTION.                                         01070000
010800******************************************************************01080000
010900                                                                  01090000
011000******************************************************************01100000
011100*  DB2 FORMATTED MESSAGE AREA                                     01110000
011200******************************************************************01120000
011300     COPY DPWS004.                                                01130000
011400                                                                  01140000
011500******************************************************************01150000
011600*  COMMUNICATIONS AREA FOR DB2                                    01160000
011700******************************************************************01170000
011800     EXEC SQL                                                     01180000
011900          INCLUDE SQLCA                                           01190000
012000     END-EXEC.                                                    01200000
012100                                                                  01210000
012200******************************************************************01220000
012300*  DB2 TABLE DECLARATION -  TPURCHS                               01230000
012400*      (TPURCHS)                                                  01240000
012500******************************************************************01250000
012600     EXEC SQL                                                     01260000
012700          INCLUDE TPURCHS                                         01270000
012800     END-EXEC.                                                    01280000
012900                                                                  01290000
013000******************************************************************01300000
013100*  DB2 TABLE DECLARATION -  ENTERPRISE NAME TABLE.                01310000
013200*      (TENTNME)                                                  01320000
013300******************************************************************01330000
013400     EXEC SQL                                                     01340000
013500          INCLUDE TENTNME                                         01350000
013600     END-EXEC.                                                    01360000
013700                                                                  01370000
013800******************************************************************01380000
013900*  DB2 TABLE DECLARATION - PORT OF ENTRY TABLE                    01390000
014000*      (TIMPOE)                                                   01400000
014100******************************************************************01410000
014200     EXEC SQL                                                     01420000
014300          INCLUDE TIMPOE                                          01430000
014400     END-EXEC.                                                    01440000
014500                                                                  01450000
014600******************************************************************01460000
014700*  DB2 TABLE DECLARATION - TR-PO TRACKING CONTAINER TRACKING      01470000
014800*      (TIMPOE)                                                   01480000
014900******************************************************************01490000
015000     EXEC SQL                                                     01500000
015100          INCLUDE TIMCNTK                                         01510000
015200     END-EXEC.                                                    01520000
015300                                                                  01530000
015400******************************************************************01540000
015500*  DB2 TABLE DECLARATION - TR-PO TRACKING CONTAINER PO            01550000
015600*      (TIMPOE)                                                   01560000
015700******************************************************************01570000
015800     EXEC SQL                                                     01580000
015900          INCLUDE TIMCNPO                                         01590000
016000     END-EXEC.                                                    01600000
016100                                                                  01610000
016200******************************************************************01620000
016300*  CONTAINER DELIVERY DATA LAYOUT                                 01630000
016400******************************************************************01640000
016500     COPY TRRD018.                                                01650000
016600*    COPY TRRD018A.                                               01660000
016700 EJECT                                                            01670000
016800******************************************************************01680000
016900*  EDITED CONTAINER DELIVERY DATA LAYOUT                          01690000
017000******************************************************************01700000
017100     COPY TRRD028.                                                01710000
017200 EJECT                                                            01720000
017300******************************************************************01730000
017400*  DELIVERY REPORT RECORD LAYOUT - EXTRACT FOR THE ERROR REPORT. *01740000
017500*  IT IS USED TO FORMAT THE ERROR RECORDS.  THEY ARE THEN        *01750000
017600*  WRITTEN TO AN OUTPUT FILE.  THE ERRORS WILL BE COMBINED WITH  *01760000
017700*  ERRORS FROM PROGRAM TRKUP255 AND WILL LATER BE USED AS INPUT  *01770000
017800*  TO THE ERROR REPORT PROGRAM WHICH WILL CREATE AN ERROR REPORT *01780000
017900*  OF BOOKING RECORDS.                                           *01790000
018000******************************************************************01800000
018100     COPY TRRD251.                                                01810000
018200 EJECT                                                            01820000
018300                                                                  01830000
018400     COPY DPWS500.                                                01840000
018500 EJECT                                                            01850000
018600                                                                  01860000
018700                                                                  01870000
018800 01  ABEND-CODE                      PIC S9(04)    VALUE +0       01880000
018900                                                   COMP SYNC.     01890000
019000 01  PA-PROGRAM-ACCUMULATORS.                                     01900000
019100     05  PA-TOTALS.                                               01910000
019200         10 PA-TOTAL-INPUT-READ       PIC  S9(09)  VALUE +0       01920000
019300                                                     COMP-3.      01930000
019400         10 PA-TOTAL-EDI-REC-READ     PIC  S9(13)  VALUE +0       01940000
019500                                                     COMP-3.      01950000
019600         10 PA-TOT-DELY-RECS-ADD      PIC  S9(13)  VALUE +0       01960000
019700                                                     COMP-3.      01970000
019800         10 PA-TOT-DELY-RECS-DELETE   PIC  S9(13)  VALUE +0       01980000
019900                                                     COMP-3.      01990000
020000         10 PA-TOT-DELY-RECS-CHANGE   PIC  S9(13)  VALUE +0       02000000
020100                                                     COMP-3.      02010000
020200         10 PA-TOTAL-WARN-COUNT       PIC  S9(13)  VALUE +0       02020000
020300                                                     COMP-3.      02030000
020400                                                                  02040000
020500 01  PS-PROGRAM-SWITCHES.                                         02050000
020600     05  PS-END-OF-DELIVERIES-SW       PIC  X(01)    VALUE 'N'.   02060000
020700         88  PS-END-OF-DELIVERIES                    VALUE 'Y'.   02070000
020800         88  PS-END-OF-DELIVERIES-NO                 VALUE 'N'.   02080000
020900     05  PS-VALID-REC-TYP-CDE-SW       PIC  X(01)    VALUE 'N'.   02090000
021000         88  PS-VALID-REC-TYP-CDE                    VALUE 'Y'.   02100000
021100         88  PS-VALID-REC-TYP-CDE-NO                 VALUE 'N'.   02110000
021200     05  PS-VALID-TRN-TYP-SW           PIC  X(01)    VALUE 'N'.   02120000
021300         88  PS-VALID-TRN-TYP                        VALUE 'Y'.   02130000
021400         88  PS-VALID-TRN-TYP-NO                     VALUE 'N'.   02140000
021500     05  PS-GOOD-RECORD-SW             PIC  X(01)    VALUE 'N'.   02150000
021600         88  PS-GOOD-RECORD                          VALUE 'Y'.   02160000
021700         88  PS-GOOD-RECORD-NO                       VALUE 'N'.   02170000
021800     05  PS-EDIT-ERROR-SW              PIC  X(01)    VALUE 'N'.   02180000
021900         88  PS-EDIT-ERROR                           VALUE 'Y'.   02190000
022000         88  PS-EDIT-ERROR-NO                        VALUE 'N'.   02200000
022100     05  PS-ENTNME-SW                  PIC X(01)     VALUE 'Y'.   02210000
022200         88  PS-VALID-ENTNME                         VALUE 'Y'.   02220000
022300         88  PS-INVALID-ENTNME                       VALUE 'N'.   02230000
022400     05  PS-WRITE-THIS-EDI-SW          PIC  X(01)    VALUE 'N'.   02240000
022500         88  PS-WRITE-THIS-EDI                       VALUE 'Y'.   02250000
022600         88  PS-WRITE-THIS-EDI-NO                    VALUE 'N'.   02260000
022700     05 PS-PO-ACTIVE-ON-MAINFRAME-SW   PIC  X(01)    VALUE 'N'.   02270000
022800         88  PS-PO-ACTIVE-ON-MAINFRAME               VALUE 'Y'.   02280000
022900         88  PS-PO-ACTIVE-ON-MAINFRAME-NO            VALUE 'N'.   02290000
022910     05 PS-PO-FOUND-ON-MAINFRAME-SW    PIC  X(01)    VALUE 'N'.   02291000
022920         88  PS-PO-FOUND-ON-MAINFRAME                VALUE 'Y'.   02292000
022930         88  PS-PO-FOUND-ON-MAINFRAME-NO             VALUE 'N'.   02293000
023000     05  PS-CNTK-FOUND-SW              PIC  X(01)    VALUE 'N'.   02300000
023100         88  PS-CNTK-FOUND                           VALUE 'Y'.   02310000
023200         88  PS-CNTK-FOUND-NO                        VALUE 'N'.   02320000
023210     05  PS-CNTK-DUPLICATE-SW          PIC  X(01)    VALUE 'N'.   02321000
023220         88  PS-CNTK-DUPLICATE                       VALUE 'Y'.   02322000
023230         88  PS-CNTK-DUPLICATE-NO                    VALUE 'N'.   02323000
023300     05  PS-PO-EXISTS-ON-TIMCNPO-SW    PIC  X(01)    VALUE 'N'.   02330000
023400         88  PS-PO-EXISTS-ON-TIMCNPO                 VALUE 'Y'.   02340000
023500         88  PS-PO-EXISTS-ON-TIMCNPO-NO              VALUE 'N'.   02350000
023600     05  PS-WROTE-A-TURN-AROUND-SW     PIC  X(01)    VALUE 'N'.   02360000
023700         88 PS-WROTE-A-TURN-AROUND                   VALUE 'Y'.   02370000
023800         88 PS-WROTE-A-TURN-AROUND-NO                VALUE 'N'.   02380000
023900                                                                  02390000
024000 01  PC-PROGRAM-CONSTANTS.                                        02400000
024100     05  PC-CURRENT-PROGRAM-NAME     PIC X(08)     VALUE          02410000
024200         'TRKUT250'.                                              02420000
024300     05  PC-01                       PIC X(02)     VALUE '01'.    02430000
024400     05  PC-10                       PIC X(02)     VALUE '10'.    02440000
024500     05  PC-11                       PIC X(02)     VALUE '11'.    02450000
024600     05  PC-19                       PIC X(02)     VALUE '19'.    02460000
024700     05  PC-20                       PIC X(02)     VALUE '20'.    02470000
024800     05  PC-21                       PIC X(02)     VALUE '21'.    02480000
024900     05  PC-22                       PIC X(02)     VALUE '22'.    02490000
025000     05  PC-98                       PIC X(02)     VALUE '98'.    02500000
025100     05  PC-99                       PIC X(02)     VALUE '99'.    02510000
025200     05  PC-A                        PIC X(01)     VALUE 'A'.     02520000
025300     05  PC-B                        PIC X(01)     VALUE 'B'.     02530000
025400     05  PC-C                        PIC X(01)     VALUE 'C'.     02540000
025500     05  PC-D                        PIC X(01)     VALUE 'D'.     02550000
025600     05  PC-E                        PIC X(01)     VALUE 'E'.     02560000
025700     05  PC-M                        PIC X(01)     VALUE 'M'.     02570000
025800     05  PC-O                        PIC X(01)     VALUE 'O'.     02580000
025900     05  PC-Z                        PIC X(01)     VALUE 'Z'.     02590000
026000     05  PC-A0                       PIC X(02)     VALUE 'A0'.    02600000
026100     05  PC-CFS                      PIC X(03)     VALUE 'CFS'.   02610000
026200     05  PC-CY                       PIC X(02)     VALUE 'CY'.    02620000
026300                                                                  02630000
026400     05  PC-ISA                      PIC X(03)     VALUE 'ISA'.   02640000
026500     05  PC-CTT                      PIC X(03)     VALUE 'CTT'.   02650000
026600     05  PC-IEA                      PIC X(03)     VALUE 'IEA'.   02660000
026700     05  PC-DPU                      PIC X(06)     VALUE 'DPU   '.02670000
026800     05  PC-DLV                      PIC X(06)     VALUE 'DLV   '.02680000
026900     05  PC-DVN                      PIC X(06)     VALUE 'DVN   '.02690000
027000     05  PC-CRP                      PIC X(06)     VALUE 'CRP   '.02700000
027100     05  PC-RTN                      PIC X(06)     VALUE 'RTN   '.02710000
027200     05  PC-DPURDD                   PIC X(06)     VALUE 'DPURDD'.02720000
027300     05  PC-DLVRDD                   PIC X(06)     VALUE 'DLVRDD'.02730000
027400     05  PC-DVNRDD                   PIC X(06)     VALUE 'DVNRDD'.02740000
027500     05  PC-CRPRDD                   PIC X(06)     VALUE 'CRPRDD'.02750000
027600     05  PC-RTNRDD                   PIC X(06)     VALUE 'RTNRDD'.02760000
      * MS 07/01/2010                                                   02760207
           05  PC-ARVDCN                   PIC X(06)     VALUE 'ARVDCN'.02761007
           05  PC-ARVDRD                   PIC X(06)     VALUE 'ARVDRD'.02762007
027700                                                                  02770000
027800     05  PC-WARNING                  PIC X(03)     VALUE 'WRN'.   02780000
027900     05  PC-ERROR                    PIC X(03)     VALUE 'ERR'.   02790000
028000     05  PC-EMPTY                    PIC X(03)     VALUE 'EMT'.   02800000
028100     05  PC-HDR                      PIC X(06)     VALUE 'HDR   '.02810000
028200     05  PC-HEADER1                  PIC X(03)     VALUE 'HD1'.   02820000
028300     05  PC-HEADER2                  PIC X(03)     VALUE 'HD2'.   02830000
028400     05  PC-EDI                      PIC X(03)     VALUE 'EDI'.   02840000
028500     05  PC-DASH                     PIC X(01)     VALUE '-'.     02850000
028600     05  PC-DEFAULT-NINES-TMST       PIC X(26)     VALUE          02860000
028700                                     '9999-09-09-00.00.00.000000'.02870000
028800     05  PC-DEFAULT-TMST             PIC X(26)     VALUE          02880000
028900                                     '0001-01-01-00.00.00.000000'.02890000
029000     05  PC-DEFAULT-DTE              PIC X(08)     VALUE          02900000
029100                                     '00010101'.                  02910000
029200     05  PC-DEFAULT-DATE             PIC X(08)     VALUE          02920000
029300                                     '00010101'.                  02930000
029400     05  PC-DEFAULT-TIME             PIC X(04)     VALUE          02940000
029500                                     '0000'.                      02950000
029600     05  PC-MAX-RETRIES              PIC S9(03)    VALUE +5       02960000
029700                                                     COMP-3.      02970000
029800     05  PC-DAYS-TO-DECREMENT        PIC 9(02)     VALUE 7.       02980000
029900                                                                  02990000
030000 01  PV-PROGRAM-VARIABLES.                                        03000000
030100     05  PV-POE-NAME                 PIC X(30)     VALUE SPACES.  03010000
030200     05  PV-PREV-POE-CDE             PIC X(04)     VALUE SPACES.  03020000
030300     05  PV-VEND-ID-QUAL             PIC X(02)     VALUE SPACES.  03030000
030400     05  PV-VEND-ID                  PIC X(15)     VALUE SPACES.  03040000
030500     05  PV-CONTNR-ID                PIC X(12)     VALUE SPACES.  03050000
030700     05  PV-PO-NBR                   PIC S9(9)     VALUE +0       03070000
030800                                                   COMP.          03080000
030900     05  PV-PROCESS-SEQ-NBR          PIC S9(06)    VALUE +0       03090000
031000                                                   COMP.          03100000
031100                                                                  03110000
031200     05  PV-HOLD-TURN-ISA-WRITTEN    PIC X(300)    VALUE SPACES.  03120000
031300                                                                  03130000
031400     05  PV-HOLD-TURNAROUND-OUT      PIC X(300)    VALUE SPACES.  03140000
031500                                                                  03150000
031600     05  PV-HOLD-TR018-REC.                                       03160000
031700         10  FILLER                  PIC X(96)     VALUE SPACES.  03170000
031800         10  FILLER                  PIC X(39)     VALUE SPACES.  03180000
031900         10  PV-HOLD-TR018-DPU-TURN-CRE-DTE                       03190000
032000                                     PIC X(08)     VALUE SPACES.  03200000
032100         10  PV-HOLD-TR018-DPU-TURN-CRE-TM                        03210000
032200                                     PIC X(04)     VALUE SPACES.  03220000
032300         10  FILLER                  PIC X(153)    VALUE SPACES.  03230000
032400                                                                  03240000
032500     05  PV-ENT-ID                   PIC S9(09)    VALUE ZEROES   03250000
032600                                                   COMP.          03260000
032700                                                                  03270000
032800     05  PV-HOLD-LAST-REC-TYP        PIC X(03)     VALUE SPACES.  03280000
032900                                                                  03290000
033000     05  PV-EVAL-TRN-TYP-CDE         PIC X(01).                   03300000
033100         88  TRN-TYP-ADD                           VALUE 'A'.     03310000
033200         88  TRN-TYP-CHG                           VALUE 'C'.     03320000
033300         88  TRN-TYP-DEL                           VALUE 'D'.     03330000
033400                                                                  03340000
033500     05  PV-EVAL-REC-TYP-CDE         PIC X(06).                   03350000
033600         88  REC-TYP-DPU                           VALUE 'DPU   '.03360000
033700         88  REC-TYP-DLV                           VALUE 'DLV   '.03370000
033800         88  REC-TYP-DVN                           VALUE 'DVN   '.03380000
033900         88  REC-TYP-CRP                           VALUE 'CRP   '.03390000
034000         88  REC-TYP-RTN                           VALUE 'RTN   '.03400000
034100         88  REC-TYP-DPURDD                        VALUE 'DPURDD'.03410000
034200         88  REC-TYP-DLVRDD                        VALUE 'DLVRDD'.03420000
034300         88  REC-TYP-DVNRDD                        VALUE 'DVNRDD'.03430000
034400         88  REC-TYP-CRPRDD                        VALUE 'CRPRDD'.03440000
034500         88  REC-TYP-RTNRDD                        VALUE 'RTNRDD'.03450000
      * MS 07/01/2010                                                   03450110
               88  REC-TYP-ARVDCN                        VALUE 'ARVDCN'.03451010
               88  REC-TYP-ARVDRD                        VALUE 'ARVDRD'.03452010
034600                                                                  03460000
034700     05  PV-CHECK-REC-TYP-CDE        PIC X(06).                   03470000
034800         88  VALID-REC-TYP-CDE                     VALUE 'DPU   ',03480000
034900                                                         'DLV   ',03490000
035000                                                         'DVN   ',03500000
035100                                                         'CRP   ',03510000
035200                                                         'RTN   ',03520000
035300                                                         'IEA   ',03530000
035400                                                         'ISA   '.03540000
035500                                                                  03550000
035600     05  PV-REC-CHECK                PIC  X(03)  VALUE SPACES.    03560000
035700         88  EDI-RECORD                            VALUE 'IEA',   03570000
035800                                                         'CTT',   03580000
035900                                                         'ISA'.   03590000
036000         88  EDI-IEA-RECORD                        VALUE 'IEA'.   03600000
036100         88  EDI-CTT-RECORD                        VALUE 'CTT'.   03610000
036200         88  EDI-ISA-RECORD                        VALUE 'ISA'.   03620000
036300                                                                  03630000
036400     05  PV-HOLD-ISA-RECORD.                                      03640000
036500         10  FILLER                  PIC X(32)     VALUE SPACES.  03650000
036600         10  PV-ISA-VEND-ID-QUAL     PIC X(02)     VALUE SPACES.  03660000
036700         10  FILLER                  PIC X(01)     VALUE SPACES.  03670000
036800         10  PV-ISA-VEND-ID          PIC X(15)     VALUE SPACES.  03680000
036900         10  FILLER                  PIC X(20)     VALUE SPACES.  03690000
037000         10  PV-ISA-CONSOL-TRNS-DTE  PIC X(06)     VALUE SPACES.  03700000
037100         10  FILLER                  PIC X(01)     VALUE SPACES.  03710000
037200         10  PV-ISA-CONSOL-TRNS-TM   PIC X(04)     VALUE SPACES.  03720000
037300         10  FILLER                  PIC X(09)     VALUE SPACES.  03730000
037400         10  PV-ISA-CONSOL-FIL-ID    PIC X(09)     VALUE SPACES.  03740000
037500         10  FILLER                  PIC X(201)    VALUE SPACES.  03750000
037600                                                                  03760000
037700     05  PV-HOLD-IEA-RECORD.                                      03770000
037800         10  FILLER                  PIC X(300)    VALUE SPACES.  03780000
037900                                                                  03790000
038000     05  PV-TURN-ISA-WRITTEN         PIC X(300)    VALUE SPACES.  03800000
038100                                                                  03810000
038200     05  PV-TMST                     PIC X(26)     VALUE SPACES.  03820000
038300     05  PV-HOLD-TMST                PIC X(26)     VALUE SPACES.  03830000
038400     05  PV-CURRENT-TMST             PIC X(26)     VALUE SPACES.  03840000
038500     05  PV-RETRY-COUNTER            PIC S9(04)    VALUE +0       03850000
038600                                                    COMP SYNC.    03860000
038700                                                                  03870000
038800     05  PV-FORMAT-TMST.                                          03880000
038900         10  PV-FORMAT-TMST-DTE.                                  03890000
039000             15  PV-FORMAT-TMST-DTE-CY  PIC X(04)  VALUE SPACES.  03900000
039100             15  PV-FORMAT-TMST-DTE-D1  PIC X(01)  VALUE '-'.     03910000
039200             15  PV-FORMAT-TMST-DTE-MM  PIC X(02)  VALUE SPACES.  03920000
039300             15  PV-FORMAT-TMST-DTE-D2  PIC X(01)  VALUE '-'.     03930000
039400             15  PV-FORMAT-TMST-DTE-DD  PIC X(02)  VALUE SPACES.  03940000
039500             15  PV-FORMAT-TMST-DTE-D3  PIC X(01)  VALUE '-'.     03950000
039600         10  PV-FORMAT-TMST-TM.                                   03960000
039700             15  PV-FORMAT-TMST-TM-HH   PIC X(02)  VALUE SPACES.  03970000
039800             15  PV-FORMAT-TMST-TM-D1   PIC X(01)  VALUE '.'.     03980000
039900             15  PV-FORMAT-TMST-TM-MM   PIC X(02)  VALUE SPACES.  03990000
040000             15  PV-FORMAT-TMST-TM-D2   PIC X(10)  VALUE          04000000
040100                                                     '.00.000000'.04010000
040200     05  PV-FORMAT-DYDT.                                          04020000
040300         10  PV-FORMAT-DYDT-DTE-CY  PIC X(04)  VALUE SPACES.      04030000
040400         10  PV-FORMAT-DYDT-DTE-D1  PIC X(01)  VALUE '-'.         04040000
040500         10  PV-FORMAT-DYDT-DTE-MM  PIC X(02)  VALUE SPACES.      04050000
040600         10  PV-FORMAT-DYDT-DTE-D2  PIC X(01)  VALUE '-'.         04060000
040700         10  PV-FORMAT-DYDT-DTE-DD  PIC X(02)  VALUE SPACES.      04070000
040800         10  PV-FORMAT-DYDT-DTE-D3  PIC X(01)  VALUE '-'.         04080000
040900         10  PV-FORMAT-DYDT-TM-HH   PIC X(02)  VALUE SPACES.      04090000
041000         10  PV-FORMAT-DYDT-TM-D1   PIC X(01)  VALUE '.'.         04100000
041100         10  PV-FORMAT-DYDT-TM-MM   PIC X(02)  VALUE SPACES.      04110000
041200         10  PV-FORMAT-DYDT-TM-D2   PIC X(10)  VALUE '.00.000000'.04120000
041300                                                                  04130000
041400     05  PV-REFORMAT-TMST.                                        04140000
041500         10  PV-REFORMAT-TMST-DTE.                                04150000
041600             15  PV-REFORMAT-TMST-DTE-CY  PIC X(04)  VALUE SPACES.04160000
041700             15  PV-REFORMAT-TMST-DTE-MM  PIC X(02)  VALUE SPACES.04170000
041800             15  PV-REFORMAT-TMST-DTE-DD  PIC X(02)  VALUE SPACES.04180000
041900         10  PV-REFORMAT-TMST-TM.                                 04190000
042000             15  PV-REFORMAT-TMST-TM-HH   PIC X(02)  VALUE SPACES.04200000
042100             15  PV-REFORMAT-TMST-TM-MM   PIC X(02)  VALUE SPACES.04210000
042200                                                                  04220000
042300     05  PV-HDR-CONSOL-TRNS-DTE.                                  04230000
042400         10  PV-HDR-CONSOL-TRNS-DTE-CC    PIC X(02)  VALUE SPACES.04240000
042500         10  PV-HDR-CONSOL-TRNS-DTE-REST  PIC X(06)  VALUE SPACES.04250000
042600                                                                  04260000
042700                                                                  04270000
042800******************************************************************04280000
042900*  CURSOR DECLARATION TO SELECT POE NAME FROM TIMPOE TABLE.       04290000
043000*                                                                 04300000
043100******************************************************************04310000
043200                                                                  04320000
043300     EXEC SQL                                                     04330000
043400         DECLARE POE-CSR CURSOR FOR                               04340000
043500             SELECT POE_NM                                        04350000
043600             FROM   TIMPOE                                        04360000
043700             WHERE  POE_STD_EDI_CDE =                             04370000
043800                             :TR018-DPU-POE-STD-EDI-CDE AND       04380000
043900                    STAT_CDE        = 'A'                         04390000
044000     END-EXEC.                                                    04400000
044100                                                                  04410000
044200******************************************************************04420000
044300 LINKAGE SECTION.                                                 04430000
044400******************************************************************04440000
044500                                                                  04450000
044600******************************************************************04460000
044700 PROCEDURE DIVISION.                                              04470000
044800******************************************************************04480000
044900******************************************************************04490000
045000*  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM.  *04500000
045100******************************************************************04510000
045200 0000-PROGRAM-MAINLINE.                                           04520000
045300                                                                  04530000
045400     PERFORM 1000-INITIALIZE.                                     04540000
045500                                                                  04550000
045600     PERFORM 2000-PROCESS-DELIVERY-RECORDS                        04560000
045700         UNTIL PS-END-OF-DELIVERIES.                              04570000
045800                                                                  04580000
045900     PERFORM 8000-EOJ-ROUTINE.                                    04590000
046000     STOP RUN.                                                    04600000
046100                                                                  04610000
046200******************************************************************04620000
046300*  OPENS INPUT AND OUTPUT FILES AND PERFORMS OTHER BEGINNING OF  *04630000
046400*  JOB PROCESSES - PRIMING READ, INITIALIZATION, EMPTY FILE ETC. *04640000
046500******************************************************************04650000
046600 1000-INITIALIZE.                                                 04660000
046700                                                                  04670000
046800     OPEN INPUT TR018-DELIVERY-FILE                               04680000
046900         OUTPUT TR028-UPDATE-DELIVERY-FILE                        04690000
047000                TR251-DELIVERY-ERROR-FILE                         04700000
047100                TR018-DELIVERY-TURNAROUND-FILE.                   04710000
047200                                                                  04720000
047300     INITIALIZE TR028-REC-TYP-DPU                                 04730000
047400                TR251-RECORD                                      04740000
047500                TR251-REC-TYP-HDR.                                04750000
047600                                                                  04760000
047700     PERFORM 3000-RESET-SWITCHES.                                 04770000
047800                                                                  04780000
047900     MOVE PC-IEA TO PV-HOLD-LAST-REC-TYP.                         04790000
048000                                                                  04800000
048100     PERFORM 6000-READ-DELIVERY-RECORD                            04810000
048200         UNTIL PS-GOOD-RECORD OR PS-END-OF-DELIVERIES.            04820000
048300     SET PS-GOOD-RECORD-NO TO TRUE.                               04830000
048400                                                                  04840000
048500     IF PS-END-OF-DELIVERIES                                      04850000
048600         MOVE PC-EMPTY       TO TR251-ERROR-TYPE                  04860000
048700     END-IF.                                                      04870000
048800                                                                  04880000
048900 EJECT                                                            04890000
049000******************************************************************04900000
049100* MAIN PROCESSING / EDIT PARAGRAPH.                              *04910000
049200*                                                                *04920000
049300*  IN THIS PARAGRAPH, A CHECK IS PERFORMED TO MAKE SURE THE      *04930000
049400*  RECORD HAS A VALID TRANSACTION TYP AND RECORD TYP.  IF NOT,   *04940000
049500*  AN ERROR RECORD IS WRITTEN OUR IMMEDIATELY.                   *04950000
049600*  IF EITHER IS NOT SENT OR INVALID, THE RECORD IS WRITTEN OUT TO 04960000
049700*  ERROR REPORT AND THE PROCESSING PASSES TO THE NEXT RECORD.    *04970000
049800*  WHEN TRAN TYPE, RECORD TYPE, ARE PRESENT AND VALID, THE       *04980000
049900*  THE PROCESSING WILL                                           *04990000
050000*  PASS THRU ALL OF THE EDITS BEFORE READING THE NEXT RECORD.    *05000000
050100*  THIS IS DONE TO TRY TO CATCH ALL OF THE ERRORS ON THE FIRST   *05010000
050200*  TIME THROUGH THE PROGRAM.                                     *05020000
050300*                                                                *05030000
050400******************************************************************05040000
                                                                        05040115
      * MS 07/01/2010                                                   05041015
      * ADDED PROCESSING FOR THE RECORD TYPE ARVDCN AND ARVDRD.         05042015
                                                                        05043015
050500 2000-PROCESS-DELIVERY-RECORDS.                                   05050000
050600                                                                  05060000
050700     PERFORM 3150-CHECK-VALID-TRN-REC-TYP.                        05070000
050800                                                                  05080000
050900     IF (PS-VALID-REC-TYP-CDE AND PS-VALID-TRN-TYP)               05090000
051000                                                                  05100000
051100         EVALUATE TR018-DPU-REC-TYP-CDE                           05110000
051200                                                                  05120000
051300            WHEN PC-DPU                                           05130000
051400                PERFORM 3200-EDIT-KEYS-LIKE-FIELDS                05140000
051500                PERFORM 3400-EDIT-DPU-FIELDS                      05150000
051600            WHEN PC-DLV                                           05160000
051700                PERFORM 3200-EDIT-KEYS-LIKE-FIELDS                05170000
051800                PERFORM 3600-EDIT-DLV-FIELDS                      05180000
                  WHEN PC-ARVDCN                                        05181007
                      PERFORM 3200-EDIT-KEYS-LIKE-FIELDS                05182001
                      PERFORM 3950-EDIT-ARVDCN-FIELDS                   05183007
051900            WHEN PC-DVN                                           05190000
052000                PERFORM 3200-EDIT-KEYS-LIKE-FIELDS                05200000
052100                PERFORM 3700-EDIT-DVN-FIELDS                      05210000
052200            WHEN PC-CRP                                           05220000
052300                PERFORM 3200-EDIT-KEYS-LIKE-FIELDS                05230000
052400                PERFORM 3800-EDIT-CRP-FIELDS                      05240000
052500            WHEN PC-RTN                                           05250000
052600                PERFORM 3200-EDIT-KEYS-LIKE-FIELDS                05260000
052700                PERFORM 3900-EDIT-RTN-FIELDS                      05270000
052800            WHEN PC-DPURDD                                        05280000
052900            WHEN PC-DLVRDD                                        05290000
                  WHEN PC-ARVDRD                                        05291007
053000            WHEN PC-DVNRDD                                        05300000
053100            WHEN PC-CRPRDD                                        05310000
053200            WHEN PC-RTNRDD                                        05320000
053300                PERFORM 4000-PROCESS-RECYCLE-RECORD               05330000
053400                                                                  05340000
053500         END-EVALUATE                                             05350000
053600     END-IF.                                                      05360000
053700                                                                  05370000
053800     PERFORM 6000-READ-DELIVERY-RECORD                            05380000
053900                UNTIL PS-GOOD-RECORD OR PS-END-OF-DELIVERIES.     05390000
054000                                                                  05400000
054100     SET   PS-GOOD-RECORD-NO            TO TRUE.                  05410000
054200                                                                  05420000
054300                                                                  05430000
054400 EJECT                                                            05440000
054500******************************************************************05450000
054600* RESET SWITCHES.                                                *05460000
054700******************************************************************05470000
054800 3000-RESET-SWITCHES.                                             05480000
054900                                                                  05490000
055000     SET PS-EDIT-ERROR-NO             TO TRUE.                    05500000
055100                                                                  05510000
055200 EJECT                                                            05520000
055300******************************************************************05530000
055400* CHECK TO MAKE SURE THAT THE RECORD TYPES TO BE EDITED ARE      *05540000
055500* DPU, DLV, DVN CRP OR RTN AND THAT THE TRASACTION TYPES ARE     *05550000
055600* EITHER A, C OR D. SETS TWO SWITCHES AND CONTINUES EDITING.     *05560000
055700******************************************************************05570000
                                                                        05571015
      * MS 07/01/2010                                                   05572015
      * ADDED THE PROCESSING FOR ARVDCN AND ARVDRD RECORDS.             05573015
                                                                        05574015
055800 3150-CHECK-VALID-TRN-REC-TYP.                                    05580000
055900                                                                  05590000
056000     MOVE TR018-DPU-REC-TYP-CDE           TO PV-EVAL-REC-TYP-CDE. 05600000
056100                                                                  05610000
056200     EVALUATE TRUE                                                05620000
056300                                                                  05630000
056400        WHEN REC-TYP-DPU                                          05640000
056500        WHEN REC-TYP-DLV                                          05650000
              WHEN REC-TYP-ARVDCN                                       05651007
056600        WHEN REC-TYP-DVN                                          05660000
056700        WHEN REC-TYP-CRP                                          05670000
056800        WHEN REC-TYP-RTN                                          05680000
056900        WHEN REC-TYP-DPURDD                                       05690000
057000        WHEN REC-TYP-DLVRDD                                       05700000
              WHEN REC-TYP-ARVDRD                                       05701007
057100        WHEN REC-TYP-DVNRDD                                       05710000
057200        WHEN REC-TYP-CRPRDD                                       05720000
057300        WHEN REC-TYP-RTNRDD                                       05730000
057400             SET PS-VALID-REC-TYP-CDE          TO TRUE            05740000
057500        WHEN OTHER                                                05750000
057600             SET PS-VALID-REC-TYP-CDE-NO       TO TRUE            05760000
057700             MOVE 'RECORD TYPE'            TO TR251-DATA-IN-ERROR 05770000
057800             MOVE TR018-DPU-REC-TYP-CDE    TO TR251-DATA-VALUE    05780000
057900                                           TR251-REC-TYP-DPU-CDE  05790000
058000             MOVE PC-ERROR                 TO TR251-ERROR-TYPE    05800000
058100             MOVE 'INVALID REC TYPE'       TO TR251-ERROR-MSG     05810000
058200             SET PS-EDIT-ERROR             TO TRUE                05820000
058300             PERFORM 6190-MOVES-FOR-ERROR-REC                     05830000
058400             PERFORM 6200-WRITE-ERROR-REPORT                      05840000
058500     END-EVALUATE.                                                05850000
058600                                                                  05860000
058700     MOVE TR018-DPU-TRN-TYP            TO PV-EVAL-TRN-TYP-CDE     05870000
058800                                                                  05880000
058900     EVALUATE TRUE                                                05890000
059000                                                                  05900000
059100        WHEN TRN-TYP-ADD                                          05910000
059200             SET PS-VALID-TRN-TYP              TO TRUE            05920000
059300             ADD +1 TO PA-TOT-DELY-RECS-ADD                       05930000
059400        WHEN TRN-TYP-CHG                                          05940000
059500             SET PS-VALID-TRN-TYP              TO TRUE            05950000
059600             ADD +1 TO PA-TOT-DELY-RECS-CHANGE                    05960000
059700        WHEN TRN-TYP-DEL                                          05970000
059800             SET PS-VALID-TRN-TYP              TO TRUE            05980000
059900             ADD +1 TO PA-TOT-DELY-RECS-DELETE                    05990000
060000        WHEN OTHER                                                06000000
060100             SET PS-VALID-TRN-TYP-NO           TO TRUE            06010000
060200             MOVE 'TRAN TYPE'              TO TR251-DATA-IN-ERROR 06020000
060300             MOVE TR018-DPU-TRN-TYP        TO TR251-DATA-VALUE    06030000
060400             MOVE PC-ERROR                 TO TR251-ERROR-TYPE    06040000
060500             MOVE 'INVALID TRAN TYPE'      TO TR251-ERROR-MSG     06050000
060600             PERFORM 6190-MOVES-FOR-ERROR-REC                     06060000
060700             PERFORM 6200-WRITE-ERROR-REPORT                      06070000
060800     END-EVALUATE.                                                06080000
060900                                                                  06090000
061000 EJECT                                                            06100000
061100******************************************************************06110000
061200* EDIT THE KEY FIELDS AND FIELDS THAT ARE PRESENT ON ALL 5       *06120000
061300* RECORD TYPES - DPU, DLV, DVN, CRP AND RTN.                     *06130000
061400******************************************************************06140000
061500 3200-EDIT-KEYS-LIKE-FIELDS.                                      06150000
061600                                                                  06160000
061700     IF TR018-DPU-CONTNR-ID EQUAL SPACES                          06170000
061800         MOVE 'CONTAINER ID'           TO TR251-DATA-IN-ERROR     06180000
061900         MOVE TR018-DPU-CONTNR-ID      TO TR251-DATA-VALUE        06190000
062000         MOVE PC-ERROR                 TO TR251-ERROR-TYPE        06200000
062100         SET PS-EDIT-ERROR             TO TRUE                    06210000
062200         MOVE 'CONTAINER NOT SENT'     TO TR251-ERROR-MSG         06220000
062300         PERFORM 6190-MOVES-FOR-ERROR-REC                         06230000
062400         PERFORM 6200-WRITE-ERROR-REPORT                          06240000
062500     ELSE                                                         06250000
062600         MOVE TR018-DPU-CONTNR-ID      TO TR028-DPU-CONTNR-ID     06260000
062700     END-IF.                                                      06270000
062800                                                                  06280000
062900     EVALUATE TRUE                                                06290000
063000                                                                  06300000
063100       WHEN TR018-DPU-PO-NBR   NOT NUMERIC                        06310000
063200       WHEN TR018-DPU-PO-NBR   EQUAL ZEROES                       06320000
063300         MOVE 'PO NUMBER'              TO TR251-DATA-IN-ERROR     06330000
063400         MOVE TR018-DPU-PO-NBR         TO TR251-DATA-VALUE        06340000
063500         MOVE PC-ERROR                 TO TR251-ERROR-TYPE        06350000
063600         SET PS-EDIT-ERROR             TO TRUE                    06360000
063700         MOVE 'PO NUMBER NOT SENT'     TO TR251-ERROR-MSG         06370000
063800         IF TR018-DPU-PO-NBR   NOT NUMERIC                        06380000
063900           IF TR018-DPU-PO-NBR EQUAL SPACES                       06390000
064000            CONTINUE                                              06400000
064100           ELSE                                                   06410000
064200            MOVE 'PO NUMBER INVALD '   TO TR251-ERROR-MSG         06420000
064300           END-IF                                                 06430000
064400         END-IF                                                   06440000
064500         PERFORM 6190-MOVES-FOR-ERROR-REC                         06450000
064600         PERFORM 6200-WRITE-ERROR-REPORT                          06460000
064700                                                                  06470000
064800       WHEN OTHER                                                 06480000
064810         MOVE TR018-DPU-PO-NBR       TO TR028-DPU-PO-NBR          06481000
064900         IF TR018-DPU-TRN-TYP EQUAL PC-D                          06490000
065000           CONTINUE                                               06500000
065100         ELSE                                                     06510000
065200           PERFORM 7110-SELECT-TPURCHS                            06520000
065310           IF PS-PO-ACTIVE-ON-MAINFRAME                           06531000
065400             CONTINUE                                             06540000
065500           ELSE                                                   06550000
065600             MOVE 'PO NUMBER'            TO TR251-DATA-IN-ERROR   06560000
065700             MOVE TR018-DPU-PO-NBR       TO TR251-DATA-VALUE      06570000
065800             MOVE PC-WARNING             TO TR251-ERROR-TYPE      06580000
065810             IF PS-PO-FOUND-ON-MAINFRAME                          06581000
065811               MOVE 'PO NOT ACTIVE OR APPROVED ON MAINFRAME'      06581100
065812                                           TO TR251-ERROR-MSG     06581200
065820             ELSE                                                 06582000
065830               MOVE 'PO NOT ON MAINFRAME'  TO TR251-ERROR-MSG     06583000
066010             END-IF                                               06601000
066100             PERFORM 6190-MOVES-FOR-ERROR-REC                     06610000
066200             PERFORM 6200-WRITE-ERROR-REPORT                      06620000
066330           END-IF                                                 06633000
066400         END-IF                                                   06640000
066500                                                                  06650000
066600     END-EVALUATE                                                 06660000
066700                                                                  06670000
066900     MOVE TR018-DPU-EXTL-REF-NBR   TO TR028-DPU-EXTL-REF-NBR.     06690000
067000                                                                  06700000
068300     IF TR018-DPU-TRN-TYP EQUAL PC-D                              06830000
068400         MOVE TR018-DPU-IMPRT-VEH-NM  TO TR028-DPU-IMPRT-VEH-NM   06840000
068500     ELSE                                                         06850000
068600      IF TR018-DPU-IMPRT-VEH-NM  EQUAL SPACES                     06860000
068700       MOVE 'VESSEL NAME'             TO TR251-DATA-IN-ERROR      06870000
068800       MOVE TR018-DPU-IMPRT-VEH-NM    TO TR251-DATA-VALUE         06880000
068900       MOVE PC-WARNING                TO TR251-ERROR-TYPE         06890000
069000       MOVE 'DATA NOT SENT'           TO TR251-ERROR-MSG          06900000
069100       PERFORM 6190-MOVES-FOR-ERROR-REC                           06910000
069200       PERFORM 6200-WRITE-ERROR-REPORT                            06920000
069300      ELSE                                                        06930000
069400       MOVE TR018-DPU-IMPRT-VEH-NM    TO TR028-DPU-IMPRT-VEH-NM   06940000
069500      END-IF                                                      06950000
069600     END-IF.                                                      06960000
069700                                                                  06970000
069800     IF TR018-DPU-TRN-TYP EQUAL PC-D                              06980000
069900        CONTINUE                                                  06990000
070000     ELSE                                                         07000000
070100        IF TR018-DPU-POE-STD-EDI-CDE = PV-PREV-POE-CDE            07010000
070200           CONTINUE                                               07020000
070300        ELSE                                                      07030000
070400           PERFORM 3210-EDIT-POE                                  07040000
070500        END-IF                                                    07050000
070600     END-IF.                                                      07060000
070700                                                                  07070000
070800******************************************************************07080000
070900                                                                  07090000
071000 3210-EDIT-POE.                                                   07100000
071100                                                                  07110000
071200     IF TR018-DPU-POE-STD-EDI-CDE = SPACES OR                     07120000
071300        TR018-DPU-POE-STD-EDI-CDE = LOW-VALUES OR                 07130000
071400        TR018-DPU-POE-STD-EDI-CDE = ZEROES                        07140000
071500            PERFORM 3220-POE-NOT-SENT                             07150000
071600     ELSE                                                         07160000
071700        PERFORM 7300-OPEN-POE-CURSOR                              07170000
071800        PERFORM 7310-FETCH-POE-CURSOR                             07180000
071900        IF SQLCODE = 0 AND IMPOE-POE-NM NOT = SPACES              07190000
072000           MOVE IMPOE-POE-NM   TO PV-POE-NAME                     07200000
072100           MOVE TR018-DPU-POE-STD-EDI-CDE                         07210000
072200                               TO PV-PREV-POE-CDE                 07220000
072300        ELSE                                                      07230000
072400           MOVE TR018-DPU-POE-STD-EDI-CDE                         07240000
072500                               TO PV-POE-NAME                     07250000
072600           PERFORM 3230-POE-NOT-FOUND                             07260000
072700        END-IF                                                    07270000
072800        PERFORM 7320-CLOSE-POE-CURSOR                             07280000
072900     END-IF.                                                      07290000
073000                                                                  07300000
073100***************************************************************** 07310000
073200* POE - WARNING - POE NOT SENT                                    07320000
073300***************************************************************** 07330000
073400                                                                  07340000
073500 3220-POE-NOT-SENT.                                               07350000
073600                                                                  07360000
073700     MOVE 'PORT OF ENTRY'       TO TR251-DATA-IN-ERROR.           07370000
073800     MOVE TR018-DPU-POE-STD-EDI-CDE                               07380000
073900                                TO TR251-DATA-VALUE.              07390000
074000     MOVE PC-WARNING            TO TR251-ERROR-TYPE.              07400000
074100     ADD +1                     TO PA-TOTAL-WARN-COUNT.           07410000
074200     MOVE 'POE CODE NOT SENT'   TO TR251-ERROR-MSG.               07420000
074300     PERFORM 6190-MOVES-FOR-ERROR-REC.                            07430000
074400     PERFORM 6200-WRITE-ERROR-REPORT.                             07440000
074500                                                                  07450000
074600***************************************************************** 07460000
074700* POE - WARNING - POE NOT FOUND                                   07470000
074800***************************************************************** 07480000
074900 3230-POE-NOT-FOUND.                                              07490000
075000                                                                  07500000
075100     MOVE PC-E                  TO TR251-RPT-TYP.                 07510000
075200     MOVE 'PORT OF ENTRY'       TO TR251-DATA-IN-ERROR.           07520000
075300     MOVE TR018-DPU-POE-STD-EDI-CDE                               07530000
075400                                TO TR251-DATA-VALUE.              07540000
075500     MOVE PC-WARNING            TO TR251-ERROR-TYPE.              07550000
075600     ADD +1                     TO PA-TOTAL-WARN-COUNT.           07560000
075700     MOVE 'POE CODE NOT ON MAINFRAME'                             07570000
075800                                TO TR251-ERROR-MSG.               07580000
075900     PERFORM 6190-MOVES-FOR-ERROR-REC.                            07590000
076000     PERFORM 6200-WRITE-ERROR-REPORT.                             07600000
076100                                                                  07610000
076200 EJECT                                                            07620000
076300******************************************************************07630000
076400* EDIT THE FIELDS THAT ARE PRESENT ON THE DPU RECORD TYPE ONLY.  *07640000
076500******************************************************************07650000
076600 3400-EDIT-DPU-FIELDS.                                            07660000
076700                                                                  07670000
076800      MOVE PV-POE-NAME       TO  TR028-DPU-POE-NM.                07680000
076900                                                                  07690000
077000      IF TR018-DPU-TRN-TYP EQUAL PC-D                             07700000
077100          MOVE TR018-DPU-DCONSLR-SCAC-ID TO                       07710000
077200                                 TR028-DPU-DCONSLR-SCAC-ID        07720000
077300      ELSE                                                        07730000
077400          IF TR018-DPU-DCONSLR-SCAC-ID EQUAL SPACES               07740000
077500              MOVE 'DCONSLR SCAC ID'     TO TR251-DATA-IN-ERROR   07750000
077600              MOVE TR018-DPU-DCONSLR-SCAC-ID TO TR251-DATA-VALUE  07760000
077700              MOVE PC-WARNING            TO TR251-ERROR-TYPE      07770000
077800              MOVE 'DECONSOLIDATOR SCAC CODE NOT SENT'            07780000
077900                                         TO TR251-ERROR-MSG       07790000
078000                                 TR028-DPU-DCONSLR-SCAC-ID        07800000
078100              PERFORM 6190-MOVES-FOR-ERROR-REC                    07810000
078200              PERFORM 6200-WRITE-ERROR-REPORT                     07820000
078300          ELSE                                                    07830000
078400              MOVE TR018-DPU-DCONSLR-SCAC-ID TO                   07840000
078500                                     TR028-DPU-DCONSLR-SCAC-ID    07850000
078600          END-IF                                                  07860000
078700      END-IF.                                                     07870000
078800                                                                  07880000
078900      IF TR018-DPU-TRN-TYP EQUAL PC-D                             07890000
079000           MOVE TR018-DPU-DELY-ORD-RCVD-DTE TO                    07900000
079100                TR028-DPU-DELY-ORD-RCVD-DTE                       07910000
079200           MOVE TR018-DPU-DELY-ORD-RCVD-TM  TO                    07920000
079300                TR028-DPU-DELY-ORD-RCVD-TM                        07930000
079400      ELSE                                                        07940000
079500        IF TR018-DPU-DELY-ORD-RCVD-DTE EQUAL SPACES               07950000
079600          MOVE 'DELY ORD RCV DT'        TO TR251-DATA-IN-ERROR    07960000
079700          MOVE TR018-DPU-DELY-ORD-RCVD-DTE TO TR251-DATA-VALUE    07970000
079800          MOVE PC-ERROR                 TO TR251-ERROR-TYPE       07980000
079900          SET PS-EDIT-ERROR             TO TRUE                   07990000
080000          MOVE 'DATA NOT SENT'          TO TR251-ERROR-MSG        08000000
080100          PERFORM 6190-MOVES-FOR-ERROR-REC                        08010000
080200          PERFORM 6200-WRITE-ERROR-REPORT                         08020000
080300        ELSE                                                      08030000
080400          PERFORM 5610-CHK-DELY-ORD-RCVD-DTE-TM                   08040000
080500        END-IF                                                    08050000
080600      END-IF.                                                     08060000
080700                                                                  08070000
080800      IF PS-EDIT-ERROR-NO                                         08080000
080900         MOVE TR018-DPU-TRN-TYP       TO TR028-DPU-TRN-TYP        08090000
081000         MOVE TR018-DPU-REC-TYP-CDE   TO TR028-DPU-REC-TYP-CDE    08100000
081100         MOVE TR018-DPU-SEQ-NBR       TO TR028-DPU-SEQ-NBR        08110000
081200         MOVE TR018-DPU-3RD-PARTY-CDE TO TR028-DPU-3RD-PARTY-CDE  08120000
081300         MOVE TR018-DPU-FILE-ID       TO TR028-DPU-FILE-ID        08130000
081400         MOVE TR018-DPU-ENT-ID        TO TR028-DPU-DAT-SRC-ENT-ID 08140000
081500         MOVE PV-PROCESS-SEQ-NBR      TO TR028-DPU-PROCESS-SEQ-NBR08150000
081600         MOVE TR018-DPU-CONTNR-ID     TO PV-CONTNR-ID             08160000
081700         MOVE TR018-DPU-PO-NBR        TO PV-PO-NBR                08170000
082000         PERFORM 7000-SELECT-TIMCNTK                              08200000
082100         IF PS-CNTK-FOUND                                         08210000
082200             PERFORM 6400-WRITE-EDIT-EXTRACT                      08220000
082300         ELSE                                                     08230000
082400             PERFORM 4100-PROCESS-TURNAROUND-RECORD               08240000
082500         END-IF                                                   08250000
082600         INITIALIZE TR028-REC-TYP-DPU                             08260000
082700      END-IF.                                                     08270000
082800                                                                  08280000
082900 EJECT                                                            08290000
083000******************************************************************08300000
083100* EDIT THE FIELDS THAT ARE PRESENT ON THE DLV RECORD TYPE ONLY.  *08310000
083200******************************************************************08320000
083300 3600-EDIT-DLV-FIELDS.                                            08330000
083400                                                                  08340000
083500      MOVE PV-POE-NAME       TO  TR028-DLV-POE-NM.                08350000
083600                                                                  08360000
083700      IF TR018-DLV-TRN-TYP EQUAL PC-D                             08370000
083800          MOVE TR018-DLV-DCONSLR-SCAC-ID TO                       08380000
083900                                 TR028-DLV-DCONSLR-SCAC-ID        08390000
084000      ELSE                                                        08400000
084100          IF TR018-DLV-DCONSLR-SCAC-ID EQUAL SPACES               08410000
084200              MOVE 'DCONSLR SCAC ID '      TO TR251-DATA-IN-ERROR 08420000
084300              MOVE TR018-DLV-DCONSLR-SCAC-ID TO TR251-DATA-VALUE  08430000
084400              MOVE PC-WARNING              TO TR251-ERROR-TYPE    08440000
084500              MOVE 'DECONSOLIDATOR SCAC CODE NOT SENT'            08450000
084600                                           TO TR251-ERROR-MSG     08460000
084700              PERFORM 6190-MOVES-FOR-ERROR-REC                    08470000
084800              PERFORM 6200-WRITE-ERROR-REPORT                     08480000
084900          ELSE                                                    08490000
085000              MOVE TR018-DLV-DCONSLR-SCAC-ID TO                   08500000
085100                                     TR028-DLV-DCONSLR-SCAC-ID    08510000
085200          END-IF                                                  08520000
085300      END-IF.                                                     08530000
085400                                                                  08540000
085500      IF TR018-DLV-TRN-TYP EQUAL PC-D                             08550000
085600           MOVE TR018-DLV-CONTNR-PCKUP-DTE TO                     08560000
085700                TR028-DLV-CONTNR-PCKUP-DTE                        08570000
085800           MOVE TR018-DLV-CONTNR-PCKUP-TM  TO                     08580000
085900                TR028-DLV-CONTNR-PCKUP-TM                         08590000
086000      ELSE                                                        08600000
086100        IF TR018-DLV-CONTNR-PCKUP-DTE EQUAL SPACES                08610000
086200          MOVE 'CONTNR PCKUP DT'        TO TR251-DATA-IN-ERROR    08620000
086300          MOVE TR018-DLV-CONTNR-PCKUP-DTE TO TR251-DATA-VALUE     08630000
086400          MOVE PC-ERROR                 TO TR251-ERROR-TYPE       08640000
086500          SET PS-EDIT-ERROR             TO TRUE                   08650000
086600          MOVE 'DATA NOT SENT'          TO TR251-ERROR-MSG        08660000
086700          PERFORM 6190-MOVES-FOR-ERROR-REC                        08670000
086800          PERFORM 6200-WRITE-ERROR-REPORT                         08680000
086900        ELSE                                                      08690000
087000          PERFORM 5630-CHK-CONTNR-PCKUP-DTE-TM                    08700000
087100        END-IF                                                    08710000
087200      END-IF.                                                     08720000
087300                                                                  08730000
087400      IF PS-EDIT-ERROR-NO                                         08740000
087500         MOVE TR018-DLV-TRN-TYP       TO TR028-DLV-TRN-TYP        08750000
087600         MOVE TR018-DLV-REC-TYP-CDE   TO TR028-DLV-REC-TYP-CDE    08760000
087700         MOVE TR018-DLV-SEQ-NBR       TO TR028-DLV-SEQ-NBR        08770000
087800         MOVE TR018-DLV-3RD-PARTY-CDE TO TR028-DLV-3RD-PARTY-CDE  08780000
087900         MOVE PV-PROCESS-SEQ-NBR      TO TR028-DLV-PROCESS-SEQ-NBR08790000
088000         MOVE TR018-DLV-FILE-ID       TO TR028-DLV-FILE-ID        08800000
088100         MOVE TR018-DLV-ENT-ID        TO TR028-DLV-DAT-SRC-ENT-ID 08810000
088200         MOVE TR018-DLV-CONTNR-ID   TO PV-CONTNR-ID               08820000
088300         MOVE TR018-DLV-PO-NBR      TO PV-PO-NBR                  08830000
088600         PERFORM 7000-SELECT-TIMCNTK                              08860000
088700         IF PS-CNTK-FOUND                                         08870000
088800             PERFORM 6400-WRITE-EDIT-EXTRACT                      08880000
088900         ELSE                                                     08890000
089000             PERFORM 4100-PROCESS-TURNAROUND-RECORD               08900000
089100         END-IF                                                   08910000
089200         INITIALIZE TR028-REC-TYP-DPU                             08920000
089300      END-IF.                                                     08930000
089400                                                                  08940000
089500 EJECT                                                            08950000
089600******************************************************************08960000
089700* EDIT THE FIELDS THAT ARE PRESENT ON THE DVN RECORD TYPE ONLY.  *08970000
089800******************************************************************08980000
089900 3700-EDIT-DVN-FIELDS.                                            08990000
090000                                                                  09000000
090100      MOVE PV-POE-NAME       TO  TR028-DVN-POE-NM.                09010000
090200                                                                  09020000
090300      IF TR018-DVN-TRN-TYP EQUAL PC-D                             09030000
090400          MOVE TR018-DVN-DCONSLR-SCAC-ID TO                       09040000
090500                                 TR028-DVN-DCONSLR-SCAC-ID        09050000
090600      ELSE                                                        09060000
090700          IF TR018-DVN-DCONSLR-SCAC-ID EQUAL SPACES               09070000
090800              MOVE 'DCONSLR SCAC ID'       TO TR251-DATA-IN-ERROR 09080000
090900              MOVE TR018-DVN-DCONSLR-SCAC-ID TO TR251-DATA-VALUE  09090000
091000              MOVE PC-ERROR                TO TR251-ERROR-TYPE    09100000
091100              MOVE 'DECONSOLIDATOR SCAC CODE NOT SENT'            09110000
091200                                           TO TR251-ERROR-MSG     09120000
091300              PERFORM 6190-MOVES-FOR-ERROR-REC                    09130000
091400              PERFORM 6200-WRITE-ERROR-REPORT                     09140000
091500          ELSE                                                    09150000
091600              MOVE TR018-DVN-DCONSLR-SCAC-ID TO                   09160000
091700                                     TR028-DVN-DCONSLR-SCAC-ID    09170000
091800          END-IF                                                  09180000
091900      END-IF.                                                     09190000
092000                                                                  09200000
092100      IF TR018-DVN-TRN-TYP EQUAL PC-D                             09210000
092200           MOVE TR018-DVN-CONTNR-DEVAN-DTE TO                     09220000
092300                TR028-DVN-CONTNR-DEVAN-DTE                        09230000
092400           MOVE TR018-DVN-CONTNR-DEVAN-TM  TO                     09240000
092500                TR028-DVN-CONTNR-DEVAN-TM                         09250000
092600      ELSE                                                        09260000
092700        IF TR018-DVN-CONTNR-DEVAN-DTE EQUAL SPACES                09270000
092800          MOVE 'CONTNR DEVAN DT'        TO TR251-DATA-IN-ERROR    09280000
092900          MOVE TR018-DVN-CONTNR-DEVAN-DTE TO TR251-DATA-VALUE     09290000
093000          MOVE PC-ERROR                 TO TR251-ERROR-TYPE       09300000
093100          SET PS-EDIT-ERROR             TO TRUE                   09310000
093200          MOVE 'DATA NOT SENT'          TO TR251-ERROR-MSG        09320000
093300          PERFORM 6190-MOVES-FOR-ERROR-REC                        09330000
093400          PERFORM 6200-WRITE-ERROR-REPORT                         09340000
093500        ELSE                                                      09350000
093600          PERFORM 5640-CHK-CONTNR-DEVAN-DTE-TM                    09360000
093700        END-IF                                                    09370000
093800      END-IF.                                                     09380000
093900                                                                  09390000
094000      IF PS-EDIT-ERROR-NO                                         09400000
094100         MOVE TR018-DVN-TRN-TYP       TO TR028-DVN-TRN-TYP        09410000
094200         MOVE TR018-DVN-REC-TYP-CDE   TO TR028-DVN-REC-TYP-CDE    09420000
094300         MOVE TR018-DVN-SEQ-NBR       TO TR028-DVN-SEQ-NBR        09430000
094400         MOVE TR018-DVN-3RD-PARTY-CDE TO TR028-DVN-3RD-PARTY-CDE  09440000
094500         MOVE PV-PROCESS-SEQ-NBR      TO TR028-DVN-PROCESS-SEQ-NBR09450000
094510         MOVE TR018-DVN-FILE-ID       TO TR028-DVN-FILE-ID        09451000
094520         MOVE TR018-DVN-ENT-ID        TO TR028-DVN-DAT-SRC-ENT-ID 09452000
094530         MOVE TR018-DVN-CONTNR-ID     TO PV-CONTNR-ID             09453000
094540         MOVE TR018-DVN-PO-NBR        TO PV-PO-NBR                09454000
094570         PERFORM 7000-SELECT-TIMCNTK                              09457000
094580         IF PS-CNTK-FOUND                                         09458000
094590             PERFORM 6400-WRITE-EDIT-EXTRACT                      09459000
094600         ELSE                                                     09460000
094700             PERFORM 4100-PROCESS-TURNAROUND-RECORD               09470000
094800         END-IF                                                   09480000
094900         INITIALIZE TR028-REC-TYP-DPU                             09490000
095000      END-IF.                                                     09500000
095100                                                                  09510000
095200 EJECT                                                            09520000
095300******************************************************************09530000
095400* EDIT THE FIELDS THAT ARE PRESENT ON THE CRP RECORD TYPE ONLY.  *09540000
095500******************************************************************09550000
095600 3800-EDIT-CRP-FIELDS.                                            09560000
095700                                                                  09570000
095800      MOVE PV-POE-NAME       TO  TR028-CRP-POE-NM.                09580000
095900                                                                  09590000
096000      IF TR018-CRP-TRN-TYP EQUAL PC-D                             09600000
096100          MOVE TR018-CRP-DCONSLR-SCAC-ID TO                       09610000
096200                                 TR028-CRP-DCONSLR-SCAC-ID        09620000
096300      ELSE                                                        09630000
096400          IF TR018-CRP-DCONSLR-SCAC-ID EQUAL SPACES               09640000
096500              MOVE 'DCONSLR SCAC ID'       TO TR251-DATA-IN-ERROR 09650000
096600              MOVE TR018-CRP-DCONSLR-SCAC-ID TO TR251-DATA-VALUE  09660000
096700              MOVE PC-ERROR                TO TR251-ERROR-TYPE    09670000
096800              MOVE 'DECONSOLIDATOR SCAC CODE NOT SENT'            09680000
096900                                           TO TR251-ERROR-MSG     09690000
097000              PERFORM 6190-MOVES-FOR-ERROR-REC                    09700000
097100              PERFORM 6200-WRITE-ERROR-REPORT                     09710000
097200          ELSE                                                    09720000
097300              MOVE TR018-CRP-DCONSLR-SCAC-ID TO                   09730000
097400                                     TR028-CRP-DCONSLR-SCAC-ID    09740000
097500          END-IF                                                  09750000
097600      END-IF.                                                     09760000
097700                                                                  09770000
097800      IF TR018-CRP-TRN-TYP EQUAL PC-D                             09780000
097900           MOVE TR018-CRP-FRGT-RLSE-DTE TO                        09790000
098000                TR028-CRP-FRGT-RLSE-DTE                           09800000
098100           MOVE TR018-CRP-FRGT-RLSE-TM  TO                        09810000
098200                TR028-CRP-FRGT-RLSE-TM                            09820000
098300      ELSE                                                        09830000
098400        IF TR018-CRP-FRGT-RLSE-DTE EQUAL SPACES                   09840000
098500          MOVE 'FRGT RLSE DT'           TO TR251-DATA-IN-ERROR    09850000
098600          MOVE TR018-CRP-FRGT-RLSE-DTE  TO TR251-DATA-VALUE       09860000
098700          MOVE PC-ERROR                 TO TR251-ERROR-TYPE       09870000
098800          SET PS-EDIT-ERROR             TO TRUE                   09880000
098900          MOVE 'DATA NOT SENT'          TO TR251-ERROR-MSG        09890000
099000          PERFORM 6190-MOVES-FOR-ERROR-REC                        09900000
099100          PERFORM 6200-WRITE-ERROR-REPORT                         09910000
099200        ELSE                                                      09920000
099300          PERFORM 5650-CHK-FRGT-RLSE-DTE-TM                       09930000
099400        END-IF                                                    09940000
099500      END-IF.                                                     09950000
099600                                                                  09960000
099700      IF PS-EDIT-ERROR-NO                                         09970000
099800         MOVE TR018-CRP-TRN-TYP       TO TR028-CRP-TRN-TYP        09980000
099900         MOVE TR018-CRP-REC-TYP-CDE   TO TR028-CRP-REC-TYP-CDE    09990000
100000         MOVE TR018-CRP-SEQ-NBR       TO TR028-CRP-SEQ-NBR        10000000
100100         MOVE TR018-CRP-3RD-PARTY-CDE TO TR028-CRP-3RD-PARTY-CDE  10010000
100200         MOVE PV-PROCESS-SEQ-NBR      TO TR028-CRP-PROCESS-SEQ-NBR10020000
100300         MOVE TR018-CRP-FILE-ID       TO TR028-CRP-FILE-ID        10030000
100400         MOVE TR018-CRP-ENT-ID        TO TR028-CRP-DAT-SRC-ENT-ID 10040000
100500         MOVE TR018-CRP-CONTNR-ID     TO PV-CONTNR-ID             10050000
100600         MOVE TR018-CRP-PO-NBR        TO PV-PO-NBR                10060000
100900         PERFORM 7000-SELECT-TIMCNTK                              10090000
101000         IF PS-CNTK-FOUND                                         10100000
101100             PERFORM 6400-WRITE-EDIT-EXTRACT                      10110000
101200         ELSE                                                     10120000
101300             PERFORM 4100-PROCESS-TURNAROUND-RECORD               10130000
101400         END-IF                                                   10140000
101500         INITIALIZE TR028-REC-TYP-DPU                             10150000
101600         INITIALIZE TR028-REC-TYP-DPU                             10160000
101700      END-IF.                                                     10170000
101800                                                                  10180000
101900 EJECT                                                            10190000
102000******************************************************************10200000
102100* EDIT THE FIELDS THAT ARE PRESENT ON THE RTN RECORD TYPE ONLY.  *10210000
102200******************************************************************10220000
102300 3900-EDIT-RTN-FIELDS.                                            10230000
102400                                                                  10240000
102500      MOVE PV-POE-NAME       TO  TR028-RTN-POE-NM.                10250000
102600                                                                  10260000
102700      IF TR018-RTN-TRN-TYP EQUAL PC-D                             10270000
102800          MOVE TR018-RTN-DCONSLR-SCAC-ID                          10280007
102900                             TO  TR028-RTN-DCONSLR-SCAC-ID        10290007
103000      ELSE                                                        10300000
103100          IF TR018-RTN-DCONSLR-SCAC-ID EQUAL SPACES               10310000
103200              MOVE 'DCONSLR SCAC ID'        TO TR251-DATA-IN-ERROR10320007
103300              MOVE TR018-RTN-DCONSLR-SCAC-ID TO TR251-DATA-VALUE  10330000
103400              MOVE PC-ERROR                  TO TR251-ERROR-TYPE  10340007
103500              MOVE 'DECONSOLIDATOR SCAC CODE NOT SENT'            10350000
103600                                             TO TR251-ERROR-MSG   10360007
103700              PERFORM 6190-MOVES-FOR-ERROR-REC                    10370000
103800              PERFORM 6200-WRITE-ERROR-REPORT                     10380000
103900          ELSE                                                    10390000
104000              MOVE TR018-RTN-DCONSLR-SCAC-ID TO                   10400000
104100                                     TR028-RTN-DCONSLR-SCAC-ID    10410000
104200          END-IF                                                  10420000
104300      END-IF.                                                     10430000
104400                                                                  10440000
104500      IF TR018-DVN-TRN-TYP EQUAL PC-D                             10450000
104600           MOVE TR018-RTN-CONTNR-RETURN-DTE TO                    10460000
104700                TR028-RTN-CONTNR-RETURN-DTE                       10470000
104800           MOVE TR018-RTN-CONTNR-RETURN-TM  TO                    10480000
104900                TR028-RTN-CONTNR-RETURN-TM                        10490000
105000      ELSE                                                        10500000
105100        IF TR018-RTN-CONTNR-RETURN-DTE EQUAL SPACES               10510000
105200          MOVE 'CONTNR RETURN DATE'     TO TR251-DATA-IN-ERROR    10520000
105300          MOVE TR018-RTN-CONTNR-RETURN-DTE                        10530000
105400                                   TO TR251-DATA-VALUE            10540000
105500          MOVE PC-ERROR                 TO TR251-ERROR-TYPE       10550000
105600          SET PS-EDIT-ERROR             TO TRUE                   10560000
105700          MOVE 'DATA NOT SENT'          TO TR251-ERROR-MSG        10570000
105800          PERFORM 6190-MOVES-FOR-ERROR-REC                        10580000
105900          PERFORM 6200-WRITE-ERROR-REPORT                         10590000
106000        ELSE                                                      10600000
106100          PERFORM 5660-CHK-CONTNR-RETURN-DTE-TM                   10610000
106200        END-IF                                                    10620000
106300      END-IF.                                                     10630000
106400                                                                  10640000
106500      IF PS-EDIT-ERROR-NO                                         10650000
106600         MOVE TR018-RTN-TRN-TYP       TO TR028-RTN-TRN-TYP        10660000
106700         MOVE TR018-RTN-REC-TYP-CDE   TO TR028-RTN-REC-TYP-CDE    10670000
106800         MOVE TR018-RTN-SEQ-NBR       TO TR028-RTN-SEQ-NBR        10680000
106900         MOVE TR018-RTN-3RD-PARTY-CDE TO TR028-RTN-3RD-PARTY-CDE  10690000
107000         MOVE PV-PROCESS-SEQ-NBR      TO TR028-RTN-PROCESS-SEQ-NBR10700000
107100         MOVE TR018-RTN-FILE-ID       TO TR028-RTN-FILE-ID        10710000
107200         MOVE TR018-RTN-ENT-ID        TO TR028-RTN-DAT-SRC-ENT-ID 10720000
107300         MOVE TR018-RTN-CONTNR-ID     TO PV-CONTNR-ID             10730000
107400         MOVE TR018-RTN-PO-NBR        TO PV-PO-NBR                10740000
107700         PERFORM 7000-SELECT-TIMCNTK                              10770000
107800         IF PS-CNTK-FOUND                                         10780000
107900             PERFORM 6400-WRITE-EDIT-EXTRACT                      10790000
108000         ELSE                                                     10800000
108100             PERFORM 4100-PROCESS-TURNAROUND-RECORD               10810000
108200         END-IF                                                   10820000
108300         INITIALIZE TR028-REC-TYP-DPU                             10830000
108400      END-IF.                                                     10840000
                                                                        10840107
      * MS 07/01/2010 BEG                                               10840210
                                                                        10840310
      * ADDED NEW PARA 3950 FOR PROCESSING OF ARVDCN TYPE OF RECORDS.   10840415
                                                                        10840507
       3950-EDIT-ARVDCN-FIELDS.                                         10842001
                                                                        10842207
            MOVE PV-POE-NAME                     TO TR028-ARVDCN-POE-NM.10843007
                                                                        10843107
            IF TR018-ARVDCN-TRN-TYP EQUAL PC-D                          10844001
               MOVE TR018-ARVDCN-DCONSLR-SCAC-ID TO                     10845001
                          TR028-ARVDCN-DCONSLR-SCAC-ID                  10846001
            ELSE                                                        10847001
               IF TR018-ARVDCN-DCONSLR-SCAC-ID EQUAL SPACES             10848001
                  MOVE 'DCONSLR SCAC ID'         TO TR251-DATA-IN-ERROR 10849007
                  MOVE TR018-ARVDCN-DCONSLR-SCAC-ID                     10849107
                                                 TO TR251-DATA-VALUE    10849207
                  MOVE PC-WARNING                TO TR251-ERROR-TYPE    10849307
                  MOVE 'DECONSOLIDATOR SCAC CODE NOT SENT'              10849407
                                                 TO TR251-ERROR-MSG     10849507
                                            TR028-ARVDCN-DCONSLR-SCAC-ID10849607
                  PERFORM 6190-MOVES-FOR-ERROR-REC                      10849707
                  PERFORM 6200-WRITE-ERROR-REPORT                       10849807
               ELSE                                                     10849907
                  MOVE TR018-ARVDCN-DCONSLR-SCAC-ID  TO                 10850007
                            TR028-ARVDCN-DCONSLR-SCAC-ID                10850107
               END-IF                                                   10850207
            END-IF.                                                     10850307
                                                                        10850407
            IF TR018-ARVDCN-TRN-TYP EQUAL PC-D                          10850507
                  MOVE TR018-ARVDCN-ARRIVE-DECON-DTE TO                 10850607
                       TR028-ARVDCN-ARRIVE-DECON-DTE                    10850707
                  MOVE TR018-ARVDCN-ARRIVE-DECON-TM  TO                 10850807
                       TR028-ARVDCN-ARRIVE-DECON-TM                     10850907
            ELSE                                                        10851007
               IF TR018-ARVDCN-ARRIVE-DECON-DTE EQUAL SPACES            10851107
                  MOVE 'DECON ARRIVD DT'          TO TR251-DATA-IN-ERROR10851216
                  MOVE TR018-ARVDCN-ARRIVE-DECON-DTE TO TR251-DATA-VALUE10851307
                  MOVE PC-ERROR                   TO TR251-ERROR-TYPE   10851407
                  SET PS-EDIT-ERROR               TO TRUE               10851507
                  MOVE 'DATA NOT SENT'            TO TR251-ERROR-MSG    10851607
                  PERFORM 6190-MOVES-FOR-ERROR-REC                      10851707
                  PERFORM 6200-WRITE-ERROR-REPORT                       10851807
               ELSE                                                     10851907
                  PERFORM 5635-CHK-ARRIVE-DECON-DTE-TM                  10852007
               END-IF                                                   10852107
            END-IF.                                                     10852207
            IF PS-EDIT-ERROR-NO                                         10852307
               MOVE TR018-ARVDCN-TRN-TYP       TO TR028-ARVDCN-TRN-TYP  10852407
               MOVE TR018-ARVDCN-REC-TYP-CDE   TO                       10852507
                                                TR028-ARVDCN-REC-TYP-CDE10852607
               MOVE TR018-ARVDCN-SEQ-NBR       TO TR028-ARVDCN-SEQ-NBR  10852707
               MOVE TR018-ARVDCN-3RD-PARTY-CDE TO                       10852807
                                              TR028-ARVDCN-3RD-PARTY-CDE10852907
               MOVE TR018-ARVDCN-FILE-ID       TO TR028-ARVDCN-FILE-ID  10853007
               MOVE TR018-ARVDCN-ENT-ID        TO                       10853107
                                             TR028-ARVDCN-DAT-SRC-ENT-ID10853207
               MOVE PV-PROCESS-SEQ-NBR         TO                       10853307
                                            TR028-ARVDCN-PROCESS-SEQ-NBR10853407
               MOVE TR018-ARVDCN-CONTNR-ID     TO PV-CONTNR-ID          10853507
               MOVE TR018-ARVDCN-PO-NBR        TO PV-PO-NBR             10853607
               PERFORM 7000-SELECT-TIMCNTK                              10853707
               IF PS-CNTK-FOUND                                         10853807
                  PERFORM 6400-WRITE-EDIT-EXTRACT                       10853907
               ELSE                                                     10854007
                  PERFORM 4100-PROCESS-TURNAROUND-RECORD                10854101
               END-IF                                                   10854201
               INITIALIZE TR028-REC-TYP-DPU                             10854301
            END-IF.                                                     10854407
                                                                        10854507
      * MS 07/01/2010 END                                               10854607
108500                                                                  10855001
108600 EJECT                                                            10860000
108700******************************************************************10870000
108800* PROCESS THE RECYCLE REOCRDS FORM CONTAINER DELETE PROCESSING.  *10880000
108900* IF THE CONTAINER HAS BEEN RE-ADDED SEND THE RECORD THRU TO THE *10890000
109000* LOAD PROGRAM OTHERWISE RECYCLE (TURNAROUND) THE RECORD FOR THE *10900000
109100* NEXT RUN.                                                      *10910000
109200******************************************************************10920000
                                                                        10920115
      * MS 07/01/2010                                                   10921015
      * ADDED PROCESSING FOR THE RECORD TYPE ARVDRD                     10922015
                                                                        10923015
109300 4000-PROCESS-RECYCLE-RECORD.                                     10930000
109400                                                                  10940000
109500      PERFORM 7300-OPEN-POE-CURSOR.                               10950000
109600      PERFORM 7310-FETCH-POE-CURSOR.                              10960000
109700      IF SQLCODE = 0 AND IMPOE-POE-NM NOT = SPACES                10970000
109800          MOVE IMPOE-POE-NM            TO PV-POE-NAME             10980000
109900          MOVE TR018-DPU-POE-STD-EDI-CDE                          10990000
110000                                       TO PV-PREV-POE-CDE         11000000
110100      ELSE                                                        11010000
110200          MOVE TR018-DPU-POE-STD-EDI-CDE                          11020000
110300                                       TO PV-POE-NAME             11030000
110400      END-IF.                                                     11040000
110500      PERFORM 7320-CLOSE-POE-CURSOR.                              11050000
110600      EVALUATE TR018-DPU-REC-TYP-CDE                              11060000
110700        WHEN PC-DPURDD                                            11070000
110800            MOVE PV-POE-NAME           TO TR028-DPURD-POE-NM      11080000
110900            MOVE TR018-DPURD-CONTNR-ID TO TR028-DPURD-CONTNR-ID   11090000
111000            MOVE TR018-DPURD-PO-NBR    TO TR028-DPURD-PO-NBR      11100000
111100                                          PV-PO-NBR               11110000
111200            MOVE TR018-DPURD-EXTL-REF-NBR                         11120000
111300                                       TO TR028-DPURD-EXTL-REF-NBR11130000
111400            MOVE TR018-DPURD-IMPRT-VEH-NM                         11140000
111500                                       TO TR028-DPURD-IMPRT-VEH-NM11150000
111600            MOVE TR018-DPURD-DCONSLR-SCAC-ID   TO                 11160000
111700                                     TR028-DPURD-DCONSLR-SCAC-ID  11170000
111800            MOVE TR018-DPURD-DELY-ORD-RCVD-DTE TO                 11180000
111900                                     TR028-DPURD-DELY-ORD-RCVD-DTE11190000
112000            MOVE TR018-DPURD-DELY-ORD-RCVD-TM  TO                 11200000
112100                                     TR028-DPURD-DELY-ORD-RCVD-TM 11210000
112200            MOVE TR018-DPURD-TRN-TYP   TO TR028-DPURD-TRN-TYP     11220000
112300            MOVE TR018-DPURD-REC-TYP-CDE                          11230000
112400                                       TO TR028-DPURD-REC-TYP-CDE 11240000
112500            MOVE TR018-DPURD-SEQ-NBR   TO TR028-DPURD-SEQ-NBR     11250000
112600            MOVE TR018-DPURD-3RD-PARTY-CDE     TO                 11260000
112700                                     TR028-DPURD-3RD-PARTY-CDE    11270000
112800            MOVE PV-PROCESS-SEQ-NBR    TO                         11280000
112900                                     TR028-DPURD-PROCESS-SEQ-NBR  11290000
113000            MOVE TR018-DPURD-FILE-ID  TO TR028-DPURD-FILE-ID      11300000
113100            MOVE TR018-DPURD-ENT-ID TO TR028-DPURD-DAT-SRC-ENT-ID 11310000
113200        WHEN PC-DLVRDD                                            11320000
113300            MOVE PV-POE-NAME           TO TR028-DLVRD-POE-NM      11330000
113400            MOVE TR018-DLVRD-CONTNR-ID TO TR028-DLVRD-CONTNR-ID   11340000
113500            MOVE TR018-DLVRD-PO-NBR    TO TR028-DLVRD-PO-NBR      11350000
113600            MOVE TR018-DLVRD-EXTL-REF-NBR                         11360000
113700                                       TO TR028-DLVRD-EXTL-REF-NBR11370000
113800            MOVE TR018-DLVRD-IMPRT-VEH-NM                         11380000
113900                                       TO TR028-DLVRD-IMPRT-VEH-NM11390000
114000            MOVE TR018-DLVRD-DCONSLR-SCAC-ID   TO                 11400000
114100                                     TR028-DLVRD-DCONSLR-SCAC-ID  11410000
114200            MOVE TR018-DLVRD-CONTNR-PCKUP-DTE  TO                 11420000
114300                                     TR028-DLVRD-CONTNR-PCKUP-DTE 11430000
114400            MOVE TR018-DLVRD-CONTNR-PCKUP-TM   TO                 11440000
114500                                     TR028-DLVRD-CONTNR-PCKUP-TM  11450000
114600                                                                  11460000
114700            MOVE TR018-DLVRD-TRN-TYP   TO TR028-DLVRD-TRN-TYP     11470000
114800            MOVE TR018-DLVRD-REC-TYP-CDE                          11480000
114900                                       TO TR028-DLV-REC-TYP-CDE   11490000
115000            MOVE TR018-DLVRD-SEQ-NBR   TO TR028-DLVRD-SEQ-NBR     11500000
115100            MOVE TR018-DLVRD-3RD-PARTY-CDE     TO                 11510000
115200                                     TR028-DLVRD-3RD-PARTY-CDE    11520000
115300            MOVE PV-PROCESS-SEQ-NBR    TO                         11530000
115400                                     TR028-DLVRD-PROCESS-SEQ-NBR  11540000
115500            MOVE TR018-DLVRD-FILE-ID  TO TR028-DLVRD-FILE-ID      11550000
115510            MOVE TR018-DLVRD-ENT-ID TO TR028-DLVRD-DAT-SRC-ENT-ID 11551000
              WHEN PC-ARVDRD                                            11551407
                  MOVE PV-POE-NAME            TO TR028-ARVDRD-POE-NM    11551601
                  MOVE TR018-ARVDRD-CONTNR-ID TO TR028-ARVDRD-CONTNR-ID 11551701
                  MOVE TR018-ARVDRD-PO-NBR    TO TR028-ARVDRD-PO-NBR    11551801
                                                 PV-PO-NBR              11551901
                  MOVE TR018-ARVDRD-EXTL-REF-NBR                        11552001
                                            TO TR028-ARVDRD-EXTL-REF-NBR11552101
                  MOVE TR018-ARVDRD-IMPRT-VEH-NM                        11552201
                                            TO TR028-ARVDRD-IMPRT-VEH-NM11552301
                  MOVE TR018-ARVDRD-DCONSLR-SCAC-ID   TO                11552401
                                            TR028-ARVDRD-DCONSLR-SCAC-ID11552501
                  MOVE TR018-ARVDRD-ARRIVE-DECON-DTE  TO                11552607
                                           TR028-ARVDRD-ARRIVE-DECON-DTE11552701
                  MOVE TR018-ARVDRD-ARRIVE-DECON-TM   TO                11552807
                                           TR028-ARVDRD-ARRIVE-DECON-TM 11552901
                  MOVE TR018-ARVDRD-TRN-TYP TO TR028-ARVDRD-TRN-TYP     11553007
                  MOVE TR018-ARVDRD-REC-TYP-CDE                         11553101
                                            TO TR028-ARVDRD-REC-TYP-CDE 11553201
                  MOVE TR018-ARVDRD-SEQ-NBR TO TR028-ARVDRD-SEQ-NBR     11553307
                  MOVE TR018-ARVDRD-3RD-PARTY-CDE TO                    11553407
                                            TR028-ARVDRD-3RD-PARTY-CDE  11553501
                  MOVE PV-PROCESS-SEQ-NBR   TO                          11553607
                                          TR028-ARVDRD-PROCESS-SEQ-NBR  11553701
                  MOVE TR018-ARVDRD-FILE-ID TO TR028-ARVDRD-FILE-ID     11553807
                  MOVE TR018-ARVDRD-ENT-ID  TO                          11553907
                                             TR028-ARVDRD-DAT-SRC-ENT-ID11554007
115520        WHEN PC-DVNRDD                                            11554201
115530            MOVE PV-POE-NAME           TO TR028-DVNRD-POE-NM      11554307
115540            MOVE TR018-DVNRD-CONTNR-ID TO TR028-DVNRD-CONTNR-ID   11554400
115550            MOVE TR018-DVNRD-PO-NBR    TO TR028-DVNRD-PO-NBR      11555007
115560            MOVE TR018-DVNRD-EXTL-REF-NBR                         11556000
115570                                       TO TR028-DVNRD-EXTL-REF-NBR11557007
115580            MOVE TR018-DVNRD-IMPRT-VEH-NM                         11558000
115590                                       TO TR028-DVNRD-IMPRT-VEH-NM11559000
115600            MOVE TR018-DVNRD-DCONSLR-SCAC-ID   TO                 11560000
115700                                     TR028-DVNRD-DCONSLR-SCAC-ID  11570000
115800            MOVE TR018-DVNRD-CONTNR-DEVAN-DTE  TO                 11580000
115900                                     TR028-DVNRD-CONTNR-DEVAN-DTE 11590000
116000            MOVE TR018-DVNRD-CONTNR-DEVAN-TM   TO                 11600000
116100                                     TR028-DVNRD-CONTNR-DEVAN-TM  11610000
116200                                                                  11620000
116300            MOVE TR018-DVNRD-TRN-TYP   TO TR028-DVNRD-TRN-TYP     11630000
116400            MOVE TR018-DVNRD-REC-TYP-CDE                          11640000
116500                                       TO TR028-DVN-REC-TYP-CDE   11650000
116600            MOVE TR018-DVNRD-SEQ-NBR   TO TR028-DVNRD-SEQ-NBR     11660000
116700            MOVE TR018-DVNRD-3RD-PARTY-CDE       TO               11670000
116800                                     TR028-DVNRD-3RD-PARTY-CDE    11680000
116900            MOVE PV-PROCESS-SEQ-NBR    TO                         11690000
117000                                     TR028-DVNRD-PROCESS-SEQ-NBR  11700000
117100            MOVE TR018-DVNRD-FILE-ID  TO TR028-DVNRD-FILE-ID      11710000
117200            MOVE TR018-DVNRD-ENT-ID TO TR028-DVNRD-DAT-SRC-ENT-ID 11720000
117300        WHEN PC-CRPRDD                                            11730000
117400            MOVE PV-POE-NAME           TO TR028-CRPRD-POE-NM      11740000
117500            MOVE TR018-CRPRD-CONTNR-ID TO TR028-CRPRD-CONTNR-ID   11750000
117600            MOVE TR018-CRPRD-PO-NBR    TO TR028-CRPRD-PO-NBR      11760000
117700            MOVE TR018-CRPRD-EXTL-REF-NBR                         11770000
117800                                       TO TR028-CRPRD-EXTL-REF-NBR11780000
117900            MOVE TR018-CRPRD-IMPRT-VEH-NM                         11790000
118000                                       TO TR028-CRPRD-IMPRT-VEH-NM11800000
118100            MOVE TR018-CRPRD-DCONSLR-SCAC-ID   TO                 11810000
118200                                     TR028-CRPRD-DCONSLR-SCAC-ID  11820000
118300            MOVE TR018-CRPRD-FRGT-RLSE-DTE     TO                 11830000
118400                                     TR028-CRPRD-FRGT-RLSE-DTE    11840000
118500            MOVE TR018-CRPRD-FRGT-RLSE-TM      TO                 11850000
118600                                     TR028-CRPRD-FRGT-RLSE-TM     11860000
118700                                                                  11870000
118800            MOVE TR018-CRPRD-TRN-TYP   TO TR028-CRPRD-TRN-TYP     11880000
118900            MOVE TR018-CRPRD-REC-TYP-CDE       TO                 11890000
119000                                     TR028-CRPRD-REC-TYP-CDE      11900000
119100            MOVE TR018-CRPRD-SEQ-NBR   TO TR028-CRPRD-SEQ-NBR     11910000
119200            MOVE TR018-CRPRD-3RD-PARTY-CDE     TO                 11920000
119300                                     TR028-CRPRD-3RD-PARTY-CDE    11930000
119400            MOVE PV-PROCESS-SEQ-NBR    TO                         11940000
119500                                     TR028-CRPRD-PROCESS-SEQ-NBR  11950000
119600        WHEN PC-RTNRDD                                            11960000
119700            MOVE PV-POE-NAME           TO TR028-RTNRD-POE-NM      11970000
119800            MOVE TR018-RTNRD-CONTNR-ID TO TR028-RTNRD-CONTNR-ID   11980000
119900            MOVE TR018-RTNRD-PO-NBR    TO TR028-RTNRD-PO-NBR      11990000
120000            MOVE TR018-RTNRD-EXTL-REF-NBR                         12000000
120100                                       TO TR028-RTNRD-EXTL-REF-NBR12010000
120200            MOVE TR018-RTNRD-IMPRT-VEH-NM                         12020000
120300                                       TO TR028-RTNRD-IMPRT-VEH-NM12030000
120400            MOVE TR018-RTNRD-DCONSLR-SCAC-ID   TO                 12040000
120500                                     TR028-RTNRD-DCONSLR-SCAC-ID  12050000
120600            MOVE TR018-RTNRD-CONTNR-RETURN-DTE TO                 12060000
120700                                     TR028-RTNRD-CONTNR-RETURN-DTE12070000
120800            MOVE TR018-RTNRD-CONTNR-RETURN-TM  TO                 12080000
120900                                     TR028-RTNRD-CONTNR-RETURN-TM 12090000
121000                                                                  12100000
121100            MOVE TR018-RTNRD-TRN-TYP   TO TR028-RTNRD-TRN-TYP     12110000
121200            MOVE TR018-RTNRD-REC-TYP-CDE                          12120000
121300                                       TO TR028-RTNRD-REC-TYP-CDE 12130000
121400            MOVE TR018-RTNRD-SEQ-NBR   TO TR028-RTNRD-SEQ-NBR     12140000
121500            MOVE TR018-RTNRD-3RD-PARTY-CDE     TO                 12150000
121600                                     TR028-RTNRD-3RD-PARTY-CDE    12160000
121700            MOVE PV-PROCESS-SEQ-NBR    TO                         12170000
121800                                     TR028-RTNRD-PROCESS-SEQ-NBR  12180000
121900            MOVE TR018-RTNRD-FILE-ID  TO TR028-RTNRD-FILE-ID      12190000
122000            MOVE TR018-RTNRD-ENT-ID TO TR028-RTNRD-DAT-SRC-ENT-ID 12200000
122100      END-EVALUATE.                                               12210000
122200                                                                  12220000
122300      MOVE TR018-DPURD-CONTNR-ID       TO PV-CONTNR-ID.           12230000
122400      MOVE TR018-DPURD-PO-NBR          TO PV-PO-NBR.              12240000
122600      PERFORM 7000-SELECT-TIMCNTK.                                12260000
122700      IF PS-CNTK-FOUND                                            12270000
122800          PERFORM 6400-WRITE-EDIT-EXTRACT                         12280000
122900      ELSE                                                        12290000
123000          PERFORM 4100-PROCESS-TURNAROUND-RECORD                  12300000
123100      END-IF.                                                     12310000
123200                                                                  12320000
123300      INITIALIZE TR028-REC-TYP-DPU.                               12330000
123400                                                                  12340000
123500******************************************************************12350000
123600* PROCESS TURNAROUND RECORD.                                     *12360000
123700******************************************************************12370000
123800 4100-PROCESS-TURNAROUND-RECORD.                                  12380000
123900                                                                  12390000
123910      IF PS-CNTK-DUPLICATE                                        12391000
123911        MOVE PC-E                  TO TR251-RPT-TYP               12391100
123912        MOVE TR018-DPU-TRN-TYP     TO TR251-TRN-TYP               12391200
123913        MOVE 'CONTNR ID   '        TO TR251-DATA-IN-ERROR         12391300
123914        MOVE SPACES                TO TR251-DATA-VALUE            12391400
123915        MOVE PC-ERROR              TO TR251-ERROR-TYPE            12391500
123916        MOVE 'DUPLICATE CONTAINER/PO - NOT PROCESSED'             12391600
123917                                   TO TR251-ERROR-MSG             12391700
123918        MOVE TR018-DPU-TRN-TYP     TO TR028-DPU-TRN-TYP           12391800
123919        MOVE TR018-DPU-REC-TYP-CDE TO TR028-DPU-REC-TYP-CDE       12391900
123920        MOVE TR018-DPU-SEQ-NBR     TO TR028-DPU-SEQ-NBR           12392000
123921        MOVE TR018-DPU-3RD-PARTY-CDE                              12392100
123922                                   TO TR028-DPU-3RD-PARTY-CDE     12392200
123923        PERFORM 6190-MOVES-FOR-ERROR-REC                          12392300
123924        PERFORM 6200-WRITE-ERROR-REPORT                           12392400
123925      ELSE                                                        12392500
123927        PERFORM 4120-CONTAINER-NOT-FOUND-ERROR                    12392700
123929      END-IF.                                                     12392900
123930                                                                  12393000
123940                                                                  12394000
124100      IF PV-HOLD-ISA-RECORD   NOT =  PV-TURN-ISA-WRITTEN          12410000
124200          MOVE PV-HOLD-ISA-RECORD      TO PV-HOLD-TURNAROUND-OUT  12420000
124300                                          PV-TURN-ISA-WRITTEN     12430000
124400          PERFORM 6500-WRITE-TURNAROUND-RECORD                    12440000
124500          SET PS-WROTE-A-TURN-AROUND  TO TRUE                     12450000
124600      END-IF.                                                     12460000
124700                                                                  12470000
124800      IF PV-HOLD-TR018-DPU-TURN-CRE-DTE = SPACES                  12480000
124900          PERFORM 7100-SET-CURRENT-TMST                           12490000
125000          PERFORM 5730-REFORMAT-CURRENT-TMST                      12500000
125100          MOVE PV-HOLD-TR018-REC                                  12510000
125200                                       TO TR018-REC-TYP-DPU       12520000
125300          MOVE PV-REFORMAT-TMST-DTE    TO TR018-DPU-TURN-CRE-DTE  12530000
125400          MOVE PV-REFORMAT-TMST-TM     TO TR018-DPU-TURN-CRE-TM   12540000
125500          MOVE TR018-REC-TYP-DPU       TO PV-HOLD-TURNAROUND-OUT  12550000
125600          PERFORM 6500-WRITE-TURNAROUND-RECORD                    12560000
125700      ELSE                                                        12570000
125800          MOVE PV-HOLD-TR018-REC       TO PV-HOLD-TURNAROUND-OUT  12580000
125900          PERFORM 6500-WRITE-TURNAROUND-RECORD                    12590000
126000      END-IF.                                                     12600000
126100                                                                  12610000
126200                                                                  12620000
126300******************************************************************12630000
126400* PROCESS CONTAINER NOT FOUND ERROR.                             *12640000
126500******************************************************************12650000
126600 4120-CONTAINER-NOT-FOUND-ERROR.                                  12660000
126700                                                                  12670000
126720     MOVE PC-E                     TO TR251-RPT-TYP.              12672000
126730     MOVE TR018-DPU-TRN-TYP        TO TR251-TRN-TYP.              12673000
126740     MOVE 'CONTNR ID   '           TO TR251-DATA-IN-ERROR.        12674000
126750     MOVE SPACES                   TO TR251-DATA-VALUE            12675000
126760     MOVE PC-ERROR                 TO TR251-ERROR-TYPE.           12676000
126770                                                                  12677000
126780*    *********************************************************    12678000
126790*    * WHICH ERROR MESSAGE?                                  *    12679000
126791*    *  WE KNOW NO CONTAINER EXISTS FOR CONT/PO COMBO.  NOW  *    12679100
126792*    *  DETERMINE IF A CONTAINER EXISTS AT ALL FOR THIS PO.  *    12679200
126796*    *********************************************************    12679600
126797     SET PS-PO-EXISTS-ON-TIMCNPO-NO TO TRUE.                      12679700
126798     PERFORM 7450-SELECT-TIMCNPO.                                 12679800
126799                                                                  12679900
126800     IF PS-PO-EXISTS-ON-TIMCNPO                                   12680000
126802       MOVE 'NO CONTAINER MANIFEST FOR CONT/PO - NOT PROCESSED'   12680200
126803                                   TO TR251-ERROR-MSG             12680300
126805     ELSE                                                         12680500
126806       MOVE 'NO CONTAINER MANIFESTS FOR PO NBR - NOT PROCESSED'   12680600
126807                                   TO TR251-ERROR-MSG             12680700
126808     END-IF.                                                      12680800
126809*    *********************************************************    12680900
129200                                                                  12920000
129300     MOVE TR018-DPU-TRN-TYP        TO TR028-DPU-TRN-TYP.          12930000
129400     MOVE TR018-DPU-REC-TYP-CDE    TO TR028-DPU-REC-TYP-CDE.      12940000
129500     MOVE TR018-DPU-SEQ-NBR        TO TR028-DPU-SEQ-NBR.          12950000
129600     MOVE TR018-DPU-3RD-PARTY-CDE  TO TR028-DPU-3RD-PARTY-CDE.    12960000
129700     PERFORM 6190-MOVES-FOR-ERROR-REC.                            12970000
129800     PERFORM 6200-WRITE-ERROR-REPORT.                             12980000
129900                                                                  12990000
130000 EJECT                                                            13000000
130100******************************************************************13010000
130200* INITIALIZE THE ERROR FIELDS FROM TRRD251.                      *13020000
130300******************************************************************13030000
130400 5450-INITIALIZE-ERROR-FIELDS.                                    13040000
130500                                                                  13050000
130600      INITIALIZE      TR251-RPT-TYP                               13060000
130700                      TR251-TRN-TYP                               13070000
130800                      TR251-CONTNR-ID                             13080000
130900                      TR251-DATA-IN-ERROR                         13090000
131000                      TR251-DATA-VALUE-NUM                        13100000
131100                      TR251-DATA-VALUE                            13110000
131200                      TR251-ERROR-TYPE                            13120000
131300                      TR251-ERROR-MSG                             13130000
131400                      TR251-REC-TYP-DPU.                          13140000
131500                                                                  13150000
131600 EJECT                                                            13160000
131700******************************************************************13170000
131800* CHECK THE INPUT DELY ORD RVCD DATE WITH THE CALENDAR ROUTINE   *13180000
131900* TO BE SURE THE DATE IS VALID, THEN EDIT THE TM FIELD IF SENT.  *13190000
132000******************************************************************13200000
132100 5610-CHK-DELY-ORD-RCVD-DTE-TM.                                   13210000
132200                                                                  13220000
132300     INITIALIZE   DPG51 DPG52 DPG53                               13230000
132400                  DPG54 DPG55 DPG56.                              13240000
132500                                                                  13250000
132600     SET DPG52-LK-DTE-ISO              TO TRUE.                   13260000
132700     MOVE TR018-DPU-DELY-ORD-RCVD-DTE  TO                         13270000
132800            DPG52-LK-DATE-INPUT.                                  13280000
132900     MOVE PC-A0                           TO DPG51-CALENDAR-TYPE. 13290000
133000                                                                  13300000
133100     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    13310000
133200                                             DPG54 DPG55 DPG56.   13320000
133300                                                                  13330000
133400     EVALUATE TRUE                                                13340000
133500         WHEN DPG54-SEVERE-ERROR                                  13350000
133600         WHEN DPG54-WARNING-ERROR                                 13360000
133700            MOVE 'DELY ORD RCV DT'       TO TR251-DATA-IN-ERROR   13370000
133800            MOVE TR018-DPU-DELY-ORD-RCVD-DTE TO TR251-DATA-VALUE  13380000
133900            MOVE PC-ERROR                TO TR251-ERROR-TYPE      13390000
134000            SET PS-EDIT-ERROR            TO TRUE                  13400000
134100            MOVE 'INVALID DATE'          TO TR251-ERROR-MSG       13410000
134200            PERFORM 6190-MOVES-FOR-ERROR-REC                      13420000
134300            PERFORM 6200-WRITE-ERROR-REPORT                       13430000
134400         WHEN OTHER                                               13440000
134500            MOVE TR018-DPU-DELY-ORD-RCVD-DTE TO                   13450000
134600                   TR028-DPU-DELY-ORD-RCVD-DTE                    13460000
134700     END-EVALUATE.                                                13470000
134800                                                                  13480000
134900         IF TR018-DPU-DELY-ORD-RCVD-TM EQUAL SPACES OR            13490000
135000            TR018-DPU-DELY-ORD-RCVD-TM EQUAL ZEROES               13500000
135100              MOVE ZEROES TO TR028-DPU-DELY-ORD-RCVD-TM           13510000
135200         ELSE                                                     13520000
135300             IF TR018-DPU-DELY-ORD-RCVD-TM (1:1) = SPACES OR      13530000
135400                TR018-DPU-DELY-ORD-RCVD-TM (2:1) = SPACES OR      13540000
135500                TR018-DPU-DELY-ORD-RCVD-TM (3:1) = SPACES OR      13550000
135600                TR018-DPU-DELY-ORD-RCVD-TM (4:1) = SPACES         13560000
135700                 MOVE 'DELY-ORD RCV TM' TO TR251-DATA-IN-ERROR    13570000
135800                 MOVE TR018-DPU-DELY-ORD-RCVD-TM  TO              13580000
135900                        TR251-DATA-VALUE                          13590000
136000                 MOVE PC-WARNING           TO TR251-ERROR-TYPE    13600000
136100                 MOVE 'INVALID TIME'       TO TR251-ERROR-MSG     13610000
136200                 MOVE ZEROES       TO TR028-DPU-DELY-ORD-RCVD-TM  13620000
136300                 PERFORM 6190-MOVES-FOR-ERROR-REC                 13630000
136400                 PERFORM 6200-WRITE-ERROR-REPORT                  13640000
136500             ELSE                                                 13650000
136600                 IF TR018-DPU-DELY-ORD-RCVD-TM (1:2) < '24' AND   13660000
136700                    TR018-DPU-DELY-ORD-RCVD-TM (3:2) < '60'       13670000
136800                     MOVE TR018-DPU-DELY-ORD-RCVD-TM  TO          13680000
136900                          TR028-DPU-DELY-ORD-RCVD-TM              13690000
137000                 ELSE                                             13700000
137100                     MOVE 'DELY-ORD RCV TM' TO TR251-DATA-IN-ERROR13710000
137200                     MOVE TR018-DPU-DELY-ORD-RCVD-TM  TO          13720000
137300                            TR251-DATA-VALUE                      13730000
137400                     MOVE PC-WARNING        TO TR251-ERROR-TYPE   13740000
137500                     MOVE 'INVALID TIME'    TO TR251-ERROR-MSG    13750000
137600                     MOVE ZEROES   TO TR028-DPU-DELY-ORD-RCVD-TM  13760000
137700                     PERFORM 6190-MOVES-FOR-ERROR-REC             13770000
137800                     PERFORM 6200-WRITE-ERROR-REPORT              13780000
137900                 END-IF                                           13790000
138000              END-IF                                              13800000
138100         END-IF.                                                  13810000
138200                                                                  13820000
138300 EJECT                                                            13830000
138400******************************************************************13840000
138500* CHECK INPUT CONTNR PCKUP DATE WITH A CALENDAR ROUTINE TO MAKE  *13850000
138600* SURE THE DATE IS VALID, THEN EDIT THE TIME IF IT WAS SENT.     *13860000
138700******************************************************************13870000
138800 5630-CHK-CONTNR-PCKUP-DTE-TM.                                    13880000
138900                                                                  13890000
139000     INITIALIZE   DPG51 DPG52 DPG53                               13900000
139100                  DPG54 DPG55 DPG56.                              13910000
139200                                                                  13920000
139300     SET DPG52-LK-DTE-ISO              TO TRUE.                   13930000
139400     MOVE TR018-DLV-CONTNR-PCKUP-DTE   TO                         13940000
139500            DPG52-LK-DATE-INPUT.                                  13950000
139600     MOVE PC-A0                           TO DPG51-CALENDAR-TYPE. 13960000
139700                                                                  13970000
139800     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    13980000
139900                                             DPG54 DPG55 DPG56.   13990000
140000                                                                  14000000
140100     EVALUATE TRUE                                                14010000
140200         WHEN DPG54-SEVERE-ERROR                                  14020000
140300         WHEN DPG54-WARNING-ERROR                                 14030000
140400            MOVE 'CONTNR PCKUP DT'       TO TR251-DATA-IN-ERROR   14040000
140500            MOVE TR018-DLV-CONTNR-PCKUP-DTE TO TR251-DATA-VALUE   14050000
140600            MOVE PC-ERROR                TO TR251-ERROR-TYPE      14060000
140700            SET PS-EDIT-ERROR            TO TRUE                  14070000
140800            MOVE 'INVALID DATE'          TO TR251-ERROR-MSG       14080000
140900            PERFORM 6190-MOVES-FOR-ERROR-REC                      14090000
141000            PERFORM 6200-WRITE-ERROR-REPORT                       14100000
141100         WHEN OTHER                                               14110000
141200            MOVE TR018-DLV-CONTNR-PCKUP-DTE  TO                   14120000
141300                   TR028-DLV-CONTNR-PCKUP-DTE                     14130000
141400     END-EVALUATE.                                                14140000
141500                                                                  14150000
141600         IF TR018-DLV-CONTNR-PCKUP-TM  EQUAL SPACES OR            14160000
141700            TR018-DLV-CONTNR-PCKUP-TM EQUAL ZEROES                14170000
141800              MOVE ZEROES TO TR028-DLV-CONTNR-PCKUP-TM            14180000
141900         ELSE                                                     14190000
142000             IF TR018-DLV-CONTNR-PCKUP-TM (1:1) = SPACES OR       14200000
142100                TR018-DLV-CONTNR-PCKUP-TM (2:1) = SPACES OR       14210000
142200                TR018-DLV-CONTNR-PCKUP-TM (3:1) = SPACES OR       14220000
142300                TR018-DLV-CONTNR-PCKUP-TM (4:1) = SPACES          14230000
142400                 MOVE 'CONTNR PCKUP TM'  TO TR251-DATA-IN-ERROR   14240000
142500                 MOVE TR018-DLV-CONTNR-PCKUP-TM    TO             14250000
142600                        TR251-DATA-VALUE                          14260000
142700                 MOVE PC-WARNING           TO TR251-ERROR-TYPE    14270000
142800                 MOVE 'INVALID TIME'       TO TR251-ERROR-MSG     14280000
142900                 MOVE ZEROES      TO TR028-DLV-CONTNR-PCKUP-TM    14290000
143000                 PERFORM 6190-MOVES-FOR-ERROR-REC                 14300000
143100                 PERFORM 6200-WRITE-ERROR-REPORT                  14310000
143200             ELSE                                                 14320000
143300                IF TR018-DLV-CONTNR-PCKUP-TM (1:2) < '24' AND     14330000
143400                   TR018-DLV-CONTNR-PCKUP-TM (3:2) < '60'         14340000
143500                    MOVE TR018-DLV-CONTNR-PCKUP-TM   TO           14350000
143600                          TR028-DLV-CONTNR-PCKUP-TM               14360000
143700                ELSE                                              14370000
143800                    MOVE 'CONTNR PCKUP TM'         TO             14380000
143900                           TR251-DATA-IN-ERROR                    14390000
144000                    MOVE TR018-DLV-CONTNR-PCKUP-TM TO             14400000
144100                           TR251-DATA-VALUE                       14410000
144200                    MOVE PC-WARNING       TO TR251-ERROR-TYPE     14420000
144300                    MOVE 'INVALID TIME'   TO TR251-ERROR-MSG      14430000
144400                    MOVE ZEROES  TO TR028-DLV-CONTNR-PCKUP-TM     14440000
144500                    PERFORM 6190-MOVES-FOR-ERROR-REC              14450000
144600                    PERFORM 6200-WRITE-ERROR-REPORT               14460000
144700                END-IF                                            14470000
144800              END-IF                                              14480000
144900         END-IF.                                                  14490000
145000                                                                  14500000
                                                                        14500110
      * MS 07/01/2010 BEG                                               14500210
                                                                        14500310
      * CHECK FOR THE DATE AND TIME FOR THE ARRIVAL AT DECONSOLIDATOR.  14500410
                                                                        14500510
       5635-CHK-ARRIVE-DECON-DTE-TM.                                    14501007
                                                                        14501207
           INITIALIZE   DPG51 DPG52 DPG53                               14502001
                        DPG54 DPG55 DPG56.                              14503001
           SET DPG52-LK-DTE-ISO                 TO TRUE.                14504007
           MOVE TR018-ARVDCN-ARRIVE-DECON-DTE   TO                      14505001
                DPG52-LK-DATE-INPUT.                                    14506001
           MOVE PC-A0                           TO DPG51-CALENDAR-TYPE. 14507001
                                                                        14507107
           CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    14508001
                                                   DPG54 DPG55 DPG56.   14509001
           EVALUATE TRUE                                                14509101
                                                                        14509207
               WHEN DPG54-SEVERE-ERROR                                  14509301
               WHEN DPG54-WARNING-ERROR                                 14509401
                  MOVE 'DECON ARRIVD DT'        TO TR251-DATA-IN-ERROR  14509517
                  MOVE TR018-ARVDCN-ARRIVE-DECON-DTE TO TR251-DATA-VALUE14509601
                  MOVE PC-ERROR                 TO TR251-ERROR-TYPE     14509707
                  SET PS-EDIT-ERROR             TO TRUE                 14509807
                  MOVE 'INVALID DATE'           TO TR251-ERROR-MSG      14509907
                  PERFORM 6190-MOVES-FOR-ERROR-REC                      14510001
                  PERFORM 6200-WRITE-ERROR-REPORT                       14510101
               WHEN OTHER                                               14510201
                  MOVE TR018-ARVDCN-ARRIVE-DECON-DTE TO                 14510307
                         TR028-ARVDCN-ARRIVE-DECON-DTE                  14510401
                                                                        14510507
           END-EVALUATE.                                                14510601
                                                                        14510707
           IF TR018-ARVDCN-ARRIVE-DECON-TM EQUAL SPACES OR              14510801
              TR018-ARVDCN-ARRIVE-DECON-TM EQUAL ZEROES                 14510901
              MOVE ZEROES TO TR028-ARVDCN-ARRIVE-DECON-TM               14511001
           ELSE                                                         14511101
              IF TR018-ARVDCN-ARRIVE-DECON-TM (1:1) = SPACES OR         14511201
                 TR018-ARVDCN-ARRIVE-DECON-TM (2:1) = SPACES OR         14511301
                 TR018-ARVDCN-ARRIVE-DECON-TM (3:1) = SPACES OR         14512001
                 TR018-ARVDCN-ARRIVE-DECON-TM (4:1) = SPACES            14512101
                 MOVE 'DECON ARRIVD TM'  TO TR251-DATA-IN-ERROR         14512217
                 MOVE TR018-ARVDCN-ARRIVE-DECON-TM TO                   14512307
                      TR251-DATA-VALUE                                  14512401
                 MOVE PC-WARNING         TO TR251-ERROR-TYPE            14512507
                 MOVE 'INVALID TIME'     TO TR251-ERROR-MSG             14512607
                 MOVE ZEROES             TO TR028-ARVDCN-ARRIVE-DECON-TM14512707
                 PERFORM 6190-MOVES-FOR-ERROR-REC                       14512801
                 PERFORM 6200-WRITE-ERROR-REPORT                        14512901
              ELSE                                                      14513401
                 IF TR018-ARVDCN-ARRIVE-DECON-TM (1:2) < '24' AND       14513501
                    TR018-ARVDCN-ARRIVE-DECON-TM (3:2) < '60'           14513601
                    MOVE TR018-ARVDCN-ARRIVE-DECON-TM   TO              14513701
                         TR028-ARVDCN-ARRIVE-DECON-TM                   14513801
                 ELSE                                                   14513901
                    MOVE 'DECON ARRIVD TM'  TO TR251-DATA-IN-ERROR      14514017
                    MOVE TR018-ARVDCN-ARRIVE-DECON-TM   TO              14514107
                         TR251-DATA-VALUE                               14514201
                    MOVE PC-WARNING      TO TR251-ERROR-TYPE            14514301
                    MOVE 'INVALID TIME'  TO TR251-ERROR-MSG             14514401
                    MOVE ZEROES   TO TR028-ARVDCN-ARRIVE-DECON-TM       14514501
                    PERFORM 6190-MOVES-FOR-ERROR-REC                    14514601
                    PERFORM 6200-WRITE-ERROR-REPORT                     14514701
                 END-IF                                                 14514801
              END-IF                                                    14514901
           END-IF.                                                      14515001
                                                                        14515107
      * MS 07/01/2010 END                                               14515207
145100 EJECT                                                            14516000
145200******************************************************************14520000
145300* CHECK INPUT DEVAN DATE WITH A CALENDAR ROUTINE TO MAKE         *14530000
145400* SURE THE DATE IS VALID, THEN EDIT THE TIME IF IT WAS SENT.     *14540000
145500******************************************************************14550000
145600 5640-CHK-CONTNR-DEVAN-DTE-TM.                                    14560000
145700     INITIALIZE   DPG51 DPG52 DPG53                               14570000
145800                  DPG54 DPG55 DPG56.                              14580000
145900                                                                  14590000
146000     SET DPG52-LK-DTE-ISO              TO TRUE.                   14600000
146100     MOVE TR018-DVN-CONTNR-DEVAN-DTE   TO                         14610000
146200            DPG52-LK-DATE-INPUT.                                  14620000
146300     MOVE PC-A0                           TO DPG51-CALENDAR-TYPE. 14630000
146400                                                                  14640000
146500     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    14650000
146600                                             DPG54 DPG55 DPG56.   14660000
146700                                                                  14670000
146800     EVALUATE TRUE                                                14680000
146900         WHEN DPG54-SEVERE-ERROR                                  14690000
147000         WHEN DPG54-WARNING-ERROR                                 14700000
147100            MOVE 'CONTNR DEVAN DT'       TO TR251-DATA-IN-ERROR   14710000
147200            MOVE TR018-DVN-CONTNR-DEVAN-DTE TO TR251-DATA-VALUE   14720000
147300            MOVE PC-ERROR                TO TR251-ERROR-TYPE      14730000
147400            SET PS-EDIT-ERROR            TO TRUE                  14740000
147500            MOVE 'INVALID DATE'          TO TR251-ERROR-MSG       14750000
147600            PERFORM 6190-MOVES-FOR-ERROR-REC                      14760000
147700            PERFORM 6200-WRITE-ERROR-REPORT                       14770000
147800         WHEN OTHER                                               14780000
147900            MOVE TR018-DVN-CONTNR-DEVAN-DTE  TO                   14790000
148000                   TR028-DVN-CONTNR-DEVAN-DTE                     14800000
148100     END-EVALUATE.                                                14810000
148200                                                                  14820000
148300         IF TR018-DVN-CONTNR-DEVAN-TM  EQUAL SPACES OR            14830000
148400            TR018-DVN-CONTNR-DEVAN-TM EQUAL ZEROES                14840000
148500              MOVE ZEROES TO TR028-DVN-CONTNR-DEVAN-TM            14850000
148600         ELSE                                                     14860000
148700             IF TR018-DVN-CONTNR-DEVAN-TM (1:1) = SPACES OR       14870000
148800                TR018-DVN-CONTNR-DEVAN-TM (2:1) = SPACES OR       14880000
148900                TR018-DVN-CONTNR-DEVAN-TM (3:1) = SPACES OR       14890000
149000                TR018-DVN-CONTNR-DEVAN-TM (4:1) = SPACES          14900000
149100                 MOVE 'CONTNR DEVAN TM'  TO TR251-DATA-IN-ERROR   14910000
149200                 MOVE TR018-DVN-CONTNR-DEVAN-TM    TO             14920000
149300                        TR251-DATA-VALUE                          14930000
149400                 MOVE PC-WARNING           TO TR251-ERROR-TYPE    14940000
149500                 MOVE 'INVALID TIME'       TO TR251-ERROR-MSG     14950000
149600                 MOVE ZEROES      TO TR028-DVN-CONTNR-DEVAN-TM    14960000
149700                 PERFORM 6190-MOVES-FOR-ERROR-REC                 14970000
149800                 PERFORM 6200-WRITE-ERROR-REPORT                  14980000
149900             ELSE                                                 14990000
150000                 IF TR018-DVN-CONTNR-DEVAN-TM (1:2) < '24' AND    15000000
150100                    TR018-DVN-CONTNR-DEVAN-TM (3:2) < '60'        15010000
150200                     MOVE TR018-DVN-CONTNR-DEVAN-TM   TO          15020000
150300                           TR028-DVN-CONTNR-DEVAN-TM              15030000
150400                 ELSE                                             15040000
150500                     MOVE 'CONTNR DEVAN TM' TO TR251-DATA-IN-ERROR15050000
150600                     MOVE TR018-DVN-CONTNR-DEVAN-TM    TO         15060000
150700                            TR251-DATA-VALUE                      15070000
150800                     MOVE PC-WARNING      TO TR251-ERROR-TYPE     15080000
150900                     MOVE 'INVALID TIME'  TO TR251-ERROR-MSG      15090000
151000                     MOVE ZEROES   TO TR028-DVN-CONTNR-DEVAN-TM   15100000
151100                     PERFORM 6190-MOVES-FOR-ERROR-REC             15110000
151200                     PERFORM 6200-WRITE-ERROR-REPORT              15120000
151300                 END-IF                                           15130000
151400              END-IF                                              15140000
151500         END-IF.                                                  15150000
151600                                                                  15160000
151700 EJECT                                                            15170000
151800******************************************************************15180000
151900* CHECK FRGT RLSE   DATE WITH A CALENDAR ROUTINE TO MAKE         *15190000
152000* SURE THE DATE IS VALID, THEN EDIT THE TIME IF IT WAS SENT.     *15200000
152100******************************************************************15210000
152200 5650-CHK-FRGT-RLSE-DTE-TM.                                       15220000
152300     INITIALIZE   DPG51 DPG52 DPG53                               15230000
152400                  DPG54 DPG55 DPG56.                              15240000
152500                                                                  15250000
152600     SET DPG52-LK-DTE-ISO              TO TRUE.                   15260000
152700     MOVE TR018-CRP-FRGT-RLSE-DTE   TO                            15270000
152800            DPG52-LK-DATE-INPUT.                                  15280000
152900     MOVE PC-A0                           TO DPG51-CALENDAR-TYPE. 15290000
153000                                                                  15300000
153100     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    15310000
153200                                             DPG54 DPG55 DPG56.   15320000
153300                                                                  15330000
153400     EVALUATE TRUE                                                15340000
153500         WHEN DPG54-SEVERE-ERROR                                  15350000
153600         WHEN DPG54-WARNING-ERROR                                 15360000
153700            MOVE 'FRGT RLSE DT'          TO TR251-DATA-IN-ERROR   15370000
153800            MOVE TR018-CRP-FRGT-RLSE-DTE TO TR251-DATA-VALUE      15380000
153900            MOVE PC-ERROR                TO TR251-ERROR-TYPE      15390000
154000            SET PS-EDIT-ERROR            TO TRUE                  15400000
154100            MOVE 'INVALID DATE'          TO TR251-ERROR-MSG       15410000
154200            PERFORM 6190-MOVES-FOR-ERROR-REC                      15420000
154300            PERFORM 6200-WRITE-ERROR-REPORT                       15430000
154400         WHEN OTHER                                               15440000
154500            MOVE TR018-CRP-FRGT-RLSE-DTE  TO                      15450000
154600                   TR028-CRP-FRGT-RLSE-DTE                        15460000
154700     END-EVALUATE.                                                15470000
154800                                                                  15480000
154900         IF TR018-CRP-FRGT-RLSE-TM  EQUAL SPACES OR               15490000
155000            TR018-CRP-FRGT-RLSE-TM EQUAL ZEROES                   15500000
155100              MOVE ZEROES TO TR028-CRP-FRGT-RLSE-TM               15510000
155200         ELSE                                                     15520000
155300             IF TR018-CRP-FRGT-RLSE-TM (1:1) = SPACES OR          15530000
155400                TR018-CRP-FRGT-RLSE-TM (2:1) = SPACES OR          15540000
155500                TR018-CRP-FRGT-RLSE-TM (3:1) = SPACES OR          15550000
155600                TR018-CRP-FRGT-RLSE-TM (4:1) = SPACES             15560000
155700                 MOVE 'FRGT RLSE TM'   TO TR251-DATA-IN-ERROR     15570000
155800                 MOVE TR018-CRP-FRGT-RLSE-TM    TO                15580000
155900                        TR251-DATA-VALUE                          15590000
156000                 MOVE PC-WARNING         TO TR251-ERROR-TYPE      15600000
156100                 MOVE 'INVALID TIME'     TO TR251-ERROR-MSG       15610000
156200                 MOVE ZEROES      TO TR028-CRP-FRGT-RLSE-TM       15620000
156300                 PERFORM 6190-MOVES-FOR-ERROR-REC                 15630000
156400                 PERFORM 6200-WRITE-ERROR-REPORT                  15640000
156500             ELSE                                                 15650000
156600                 IF TR018-CRP-FRGT-RLSE-TM (1:2) < '24' AND       15660000
156700                    TR018-CRP-FRGT-RLSE-TM (3:2) < '60'           15670000
156800                     MOVE TR018-CRP-FRGT-RLSE-TM   TO             15680000
156900                           TR028-CRP-FRGT-RLSE-TM                 15690000
157000                 ELSE                                             15700000
157100                     MOVE 'FRGT RLSE TM' TO TR251-DATA-IN-ERROR   15710000
157200                     MOVE TR018-CRP-FRGT-RLSE-TM    TO            15720000
157300                           TR251-DATA-VALUE                       15730000
157400                     MOVE PC-WARNING      TO TR251-ERROR-TYPE     15740000
157500                     MOVE 'INVALID TIME'  TO TR251-ERROR-MSG      15750000
157600                     MOVE ZEROES      TO TR028-CRP-FRGT-RLSE-TM   15760000
157700                     PERFORM 6190-MOVES-FOR-ERROR-REC             15770000
157800                     PERFORM 6200-WRITE-ERROR-REPORT              15780000
157900                 END-IF                                           15790000
158000              END-IF                                              15800000
158100         END-IF.                                                  15810000
158200                                                                  15820000
158300 EJECT                                                            15830000
158400******************************************************************15840000
158500* CHECK CONTNR RETURN DATE WITH A CALENDAR ROUTINE TO MAKE       *15850000
158600* SURE THE DATE IS VALID, THEN EDIT THE TIME IF IT WAS SENT.     *15860000
158700******************************************************************15870000
158800 5660-CHK-CONTNR-RETURN-DTE-TM.                                   15880000
158900     INITIALIZE   DPG51 DPG52 DPG53                               15890000
159000                  DPG54 DPG55 DPG56.                              15900000
159100                                                                  15910000
159200     SET DPG52-LK-DTE-ISO              TO TRUE.                   15920000
159300     MOVE TR018-RTN-CONTNR-RETURN-DTE   TO                        15930000
159400            DPG52-LK-DATE-INPUT.                                  15940000
159500     MOVE PC-A0                           TO DPG51-CALENDAR-TYPE. 15950000
159600                                                                  15960000
159700     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    15970000
159800                                             DPG54 DPG55 DPG56.   15980000
159900                                                                  15990000
160000     EVALUATE TRUE                                                16000000
160100         WHEN DPG54-SEVERE-ERROR                                  16010000
160200         WHEN DPG54-WARNING-ERROR                                 16020000
160300            MOVE 'CONTNR RETURN DT'      TO TR251-DATA-IN-ERROR   16030000
160400            MOVE TR018-RTN-CONTNR-RETURN-DTE                      16040000
160500                               TO TR251-DATA-VALUE                16050000
160600            MOVE PC-ERROR                TO TR251-ERROR-TYPE      16060000
160700            SET PS-EDIT-ERROR            TO TRUE                  16070000
160800            MOVE 'INVALID DATE'          TO TR251-ERROR-MSG       16080000
160900            PERFORM 6190-MOVES-FOR-ERROR-REC                      16090000
161000            PERFORM 6200-WRITE-ERROR-REPORT                       16100000
161100         WHEN OTHER                                               16110000
161200            MOVE TR018-RTN-CONTNR-RETURN-DTE  TO                  16120000
161300                   TR028-RTN-CONTNR-RETURN-DTE                    16130000
161400     END-EVALUATE.                                                16140000
161500                                                                  16150000
161600         IF TR018-RTN-CONTNR-RETURN-TM  EQUAL SPACES OR           16160000
161700            TR018-RTN-CONTNR-RETURN-TM EQUAL ZEROES               16170000
161800              MOVE ZEROES TO TR028-RTN-CONTNR-RETURN-TM           16180000
161900         ELSE                                                     16190000
162000             IF TR018-RTN-CONTNR-RETURN-TM (1:1) = SPACES OR      16200000
162100                TR018-RTN-CONTNR-RETURN-TM (2:1) = SPACES OR      16210000
162200                TR018-RTN-CONTNR-RETURN-TM (3:1) = SPACES OR      16220000
162300                TR018-RTN-CONTNR-RETURN-TM (4:1) = SPACES         16230000
162400                 MOVE 'CONTNR RETURN TM' TO TR251-DATA-IN-ERROR   16240000
162500                 MOVE TR018-RTN-CONTNR-RETURN-TM    TO            16250000
162600                        TR251-DATA-VALUE                          16260000
162700                 MOVE PC-WARNING           TO TR251-ERROR-TYPE    16270000
162800                 MOVE 'INVALID TIME'       TO TR251-ERROR-MSG     16280000
162900                 MOVE ZEROES     TO TR028-RTN-CONTNR-RETURN-TM    16290000
163000                 PERFORM 6190-MOVES-FOR-ERROR-REC                 16300000
163100                 PERFORM 6200-WRITE-ERROR-REPORT                  16310000
163200             ELSE                                                 16320000
163300                 IF TR018-RTN-CONTNR-RETURN-TM (1:2) < '24' AND   16330000
163400                    TR018-RTN-CONTNR-RETURN-TM (3:2) < '60'       16340000
163500                     MOVE TR018-RTN-CONTNR-RETURN-TM   TO         16350000
163600                           TR028-RTN-CONTNR-RETURN-TM             16360000
163700                 ELSE                                             16370000
163800                     MOVE 'CONTNR RETURN TM' TO                   16380000
163900                            TR251-DATA-IN-ERROR                   16390000
164000                     MOVE TR018-RTN-CONTNR-RETURN-TM    TO        16400000
164100                            TR251-DATA-VALUE                      16410000
164200                     MOVE PC-WARNING      TO TR251-ERROR-TYPE     16420000
164300                     MOVE 'INVALID TIME'  TO TR251-ERROR-MSG      16430000
164400                     MOVE ZEROES TO TR028-RTN-CONTNR-RETURN-TM    16440000
164500                     PERFORM 6190-MOVES-FOR-ERROR-REC             16450000
164600                     PERFORM 6200-WRITE-ERROR-REPORT              16460000
164700                 END-IF                                           16470000
164800              END-IF                                              16480000
164900         END-IF.                                                  16490000
165000                                                                  16500000
165100 EJECT                                                            16510000
165200******************************************************************16520000
165300* REFORMAT CURRENT TIMESTAMP.                                    *16530000
165400******************************************************************16540000
165500 5730-REFORMAT-CURRENT-TMST.                                      16550000
165600                                                                  16560000
165700     MOVE PV-CURRENT-TMST (1:4) TO                                16570000
165800                      PV-REFORMAT-TMST-DTE-CY.                    16580000
165900     MOVE PV-CURRENT-TMST (6:2) TO                                16590000
166000                      PV-REFORMAT-TMST-DTE-MM.                    16600000
166100     MOVE PV-CURRENT-TMST (9:2) TO                                16610000
166200                      PV-REFORMAT-TMST-DTE-DD.                    16620000
166300     MOVE PV-CURRENT-TMST (12:2) TO                               16630000
166400                      PV-REFORMAT-TMST-TM-HH.                     16640000
166500     MOVE PV-CURRENT-TMST (15:2) TO                               16650000
166600                      PV-REFORMAT-TMST-TM-MM.                     16660000
166700                                                                  16670000
166800 EJECT                                                            16680000
166900******************************************************************16690000
167000* READ A RECORD FROM THE DELIVERY ORDER FILE.                    *16700000
167100******************************************************************16710000
167200 6000-READ-DELIVERY-RECORD.                                       16720000
167300                                                                  16730000
167400                                                                  16740000
167500     READ TR018-DELIVERY-FILE                                     16750000
167600         INTO TR018-REC-TYP-DPU                                   16760000
167700         AT END                                                   16770000
167800           SET PS-END-OF-DELIVERIES TO TRUE.                      16780000
167810                                                                  16781000
167811     EVALUATE TRUE                                                16781100
167812                                                                  16781200
167813       WHEN PS-END-OF-DELIVERIES                                  16781300
167814         CONTINUE                                                 16781400
167815                                                                  16781500
167816       WHEN OTHER                                                 16781600
167817                                                                  16781700
167818         SET PS-EDIT-ERROR-NO         TO TRUE                     16781800
167819         SET PS-WRITE-THIS-EDI-NO     TO TRUE                     16781900
167820         ADD +1                       TO PA-TOTAL-INPUT-READ      16782000
167821         ADD +1                       TO PV-PROCESS-SEQ-NBR       16782100
167822         MOVE TR018-REC-TYP-DPU (1:3) TO PV-REC-CHECK             16782200
167823                                                                  16782300
167824         EVALUATE TRUE                                            16782500
167825                                                                  16782600
167826             WHEN EDI-RECORD                                      16782700
167827                                                                  16782800
167828                 ADD +1        TO PA-TOTAL-EDI-REC-READ           16783000
167829                 SET PS-GOOD-RECORD-NO TO TRUE                    16783100
167830                                                                  16783200
167831                 IF EDI-ISA-RECORD                                16783300
167832                   MOVE TR018-REC-TYP-DPU                         16783400
167833                                       TO PV-HOLD-ISA-RECORD      16783500
167834                   PERFORM 6040-CHECK-IEA-RECORD                  16783600
167835                   SET PS-WROTE-A-TURN-AROUND-NO  TO TRUE         16783700
167836                   PERFORM 6035-PROCESS-ISA-RECORD                16783800
167837                 END-IF                                           16783900
167838                                                                  16784000
167839                 IF EDI-IEA-RECORD                                16784100
167840                   MOVE TR018-REC-TYP-DPU                         16784200
167841                                       TO PV-HOLD-IEA-RECORD      16784300
167842                 END-IF                                           16784400
167843                                                                  16784500
167844                 MOVE TR018-REC-TYP-DPU (1:3)                     16784600
167845                                      TO PV-HOLD-LAST-REC-TYP     16784700
167846                                                                  16784800
167847             WHEN OTHER                                           16784900
167848                 SET PS-GOOD-RECORD TO TRUE                       16785100
167849                 PERFORM 6050-CHECK-TURN-DTE                      16785200
167850                                                                  16785300
167851         END-EVALUATE                                             16785400
167852                                                                  16785500
167853         MOVE TR018-REC-TYP-DPU       TO PV-HOLD-TR018-REC        16785600
167854                                                                  16785700
167855     END-EVALUATE.                                                16785800
167856                                                                  16785900
167857 EJECT                                                            16786000
167858***************************************************************** 16786100
167859* PROCESS THE ISA RECORD TO OBTAIN HEADER RECORD FIELDS.        * 16786200
167860***************************************************************** 16786300
167870 6035-PROCESS-ISA-RECORD.                                         16787000
167880                                                                  16788000
167890                                                                  16789000
167900      MOVE PV-ISA-VEND-ID-QUAL  TO PV-VEND-ID-QUAL.               16790000
168000      MOVE PV-ISA-VEND-ID       TO PV-VEND-ID.                    16800000
168100      MOVE PC-HEADER1           TO TR251-ERROR-TYPE.              16810000
168200      MOVE PC-HDR               TO TR251-REC-TYP-HDR-CDE.         16820000
168300      MOVE PC-01                TO TR251-HDR-SEQ-NBR.             16830000
168400      MOVE PV-PROCESS-SEQ-NBR   TO TR251-PROCESS-SEQ-NBR.         16840000
168500                                                                  16850000
168600      MOVE SPACES               TO TR251-DATA-IN-ERROR            16860000
168700                                   TR251-CONTNR-ID                16870000
168800                                   TR251-DATA-VALUE               16880000
168900                                   TR251-TRN-TYP                  16890000
169000                                   TR251-ERROR-MSG.               16900000
169100                                                                  16910000
169200      MOVE TR018-DPU-ENT-ID     TO PV-ENT-ID                      16920000
169300                                   TR251-DAT-SRC-ENT-ID.          16930000
169400      PERFORM 7292-SELECT-TENTNME.                                16940000
169500      IF PS-VALID-ENTNME                                          16950000
169600          MOVE ENTNME-ENT-NAME-DESC TO TR251-HDR-CONSOL-ENTNME    16960000
169700      ELSE                                                        16970000
169800          MOVE SPACES               TO TR251-HDR-CONSOL-ENTNME    16980000
169900      END-IF.                                                     16990000
170000                                                                  17000000
170100      MOVE PV-ISA-CONSOL-TRNS-DTE  TO PV-HDR-CONSOL-TRNS-DTE-REST.17010000
170200                                                                  17020000
170300      IF PV-ISA-CONSOL-TRNS-DTE (1:2) EQUAL PC-98 OR PC-99        17030000
170400          MOVE PC-19 TO PV-HDR-CONSOL-TRNS-DTE-CC                 17040000
170500      ELSE                                                        17050000
170600          MOVE PC-20 TO PV-HDR-CONSOL-TRNS-DTE-CC                 17060000
170700      END-IF.                                                     17070000
170800                                                                  17080000
170900      MOVE PV-HDR-CONSOL-TRNS-DTE   TO TR251-HDR-CONSOL-TRNS-DTE. 17090000
171000                                                                  17100000
171100      MOVE PV-ISA-CONSOL-TRNS-TM    TO TR251-HDR-CONSOL-TRNS-TM.  17110000
171200      MOVE PV-ISA-CONSOL-FIL-ID     TO TR251-HDR-CONSOL-FIL-ID.   17120000
171300                                                                  17130000
171400      PERFORM 7100-SET-CURRENT-TMST.                              17140000
171500      PERFORM 5730-REFORMAT-CURRENT-TMST.                         17150000
171600      MOVE PV-REFORMAT-TMST-DTE     TO TR251-HDR-LOAD-DTE.        17160000
171700      MOVE PV-REFORMAT-TMST-TM      TO TR251-HDR-LOAD-TM.         17170000
171800      MOVE PC-E          TO TR251-RPT-TYP.                        17180000
171900      PERFORM 6201-WRITE-ERROR-REPORT-HDR.                        17190000
172000                                                                  17200000
172100      MOVE PC-HEADER2               TO TR251-ERROR-TYPE.          17210000
172200      MOVE PV-PROCESS-SEQ-NBR       TO TR251-PROCESS-SEQ-NBR.     17220000
172300      MOVE TR018-DPU-ENT-ID         TO TR251-DAT-SRC-ENT-ID.      17230000
172400      MOVE PC-D          TO TR251-RPT-TYP.                        17240000
172500      PERFORM 6201-WRITE-ERROR-REPORT-HDR.                        17250000
172600                                                                  17260000
172700      MOVE TR018-REC-TYP-DPU (1:3)  TO TR028-DPU-REC-TYP-CDE.     17270000
172800      MOVE PV-PROCESS-SEQ-NBR       TO TR028-DPU-PROCESS-SEQ-NBR. 17280000
172900      MOVE TR018-DPU-FILE-ID        TO TR028-DPU-FILE-ID.         17290000
173000      MOVE TR018-DPU-ENT-ID         TO TR028-DPU-DAT-SRC-ENT-ID.  17300000
173100      PERFORM 6401-WRITE-EDIT-EXTRACT-ISA.                        17310000
173200      INITIALIZE TR028-REC-TYP-DPU.                               17320000
173300      INITIALIZE TR251-RECORD.                                    17330000
173400      INITIALIZE TR251-REC-TYP-HDR.                               17340000
173500                                                                  17350000
173600                                                                  17360000
173700 EJECT                                                            17370000
173800***************************************************************** 17380000
173900* CHECK TO SEE IF PREVIOUS RECORD WAS AN IEA RECORD.            * 17390000
174000***************************************************************** 17400000
174100 6040-CHECK-IEA-RECORD.                                           17410000
174200                                                                  17420000
174300     IF PV-HOLD-LAST-REC-TYP   = PC-IEA                           17430000
174400         IF PS-WROTE-A-TURN-AROUND                                17440000
174500            MOVE PV-HOLD-IEA-RECORD  TO PV-HOLD-TURNAROUND-OUT    17450000
174600            PERFORM 6500-WRITE-TURNAROUND-RECORD                  17460000
174700         END-IF                                                   17470000
174800     ELSE                                                         17480000
174900         MOVE PC-EDI         TO TR251-ERROR-TYPE                  17490000
175000         MOVE 'NO IEA RECORD - CALL PROGRAMMING'                  17500000
175100                             TO TR251-ERROR-MSG                   17510000
175200         MOVE SPACES         TO TR251-REC-TYP-DPU                 17520000
175300                                TR251-DATA-IN-ERROR               17530000
175400                                TR251-CONTNR-ID                   17540000
175500                                TR251-DATA-VALUE                  17550000
175600                                TR251-TRN-TYP                     17560000
175700         MOVE PV-PROCESS-SEQ-NBR TO TR251-PROCESS-SEQ-NBR         17570000
175800         MOVE TR018-DPU-ENT-ID   TO TR251-DAT-SRC-ENT-ID          17580000
175900         PERFORM 6205-WRITE-ERROR-REPORT-IEA                      17590000
176000     END-IF.                                                      17600000
176100                                                                  17610000
176200 EJECT                                                            17620000
176300***************************************************************** 17630000
176400* CHECK TO SEE IF THE INPUT RECORD IS FROM THE PRIOR TURNOVER   * 17640000
176500* FILE AND NEEDS TO BE PROCESSED OR BYPASSED.                   * 17650000
176600***************************************************************** 17660000
176700 6050-CHECK-TURN-DTE.                                             17670000
176800                                                                  17680000
176900     IF TR018-DPU-TURN-CRE-DTE = SPACES                           17690000
177000         CONTINUE                                                 17700000
177100     ELSE                                                         17710000
177200         PERFORM 7100-SET-CURRENT-TMST                            17720000
177300         PERFORM 5730-REFORMAT-CURRENT-TMST                       17730000
177400         PERFORM 6060-CHECK-TURNOVER-CRE-DTE                      17740000
177500         IF TR018-DPU-TURN-CRE-DTE GREATER THAN OR EQUAL TO       17750000
177600            DPG55-DB2-ISO-DATE                                    17760000
177700             CONTINUE                                             17770000
177800         ELSE                                                     17780000
177900             IF TR018-DPU-TURN-CRE-DTE LESS THAN                  17790000
178000                DPG55-DB2-ISO-DATE                                17800000
178100                 SET PS-GOOD-RECORD-NO TO TRUE                    17810000
178200             END-IF                                               17820000
178300         END-IF                                                   17830000
178400     END-IF.                                                      17840000
178500                                                                  17850000
178600                                                                  17860000
178700******************************************************************17870000
178800* CHECK THE INPUT TURNOVER CREATE DATE TO DETERMINE IF THIS      *17880000
178900* RECORD SHOULD BE PROCESSED OR BYPASSED.                        *17890000
179000******************************************************************17900000
179100 6060-CHECK-TURNOVER-CRE-DTE.                                     17910000
179200                                                                  17920000
179300     INITIALIZE   DPG51 DPG52 DPG53                               17930000
179400                  DPG54 DPG55 DPG56.                              17940000
179500                                                                  17950000
179600     SET DPG52-LK-DTE-ISO              TO TRUE.                   17960000
179700     SET DPG51-DECREMENT-DATE          TO TRUE.                   17970000
179800     MOVE PV-REFORMAT-TMST-DTE         TO DPG52-LK-DATE-INPUT.    17980000
179900     MOVE PC-DAYS-TO-DECREMENT         TO DPG51-INCR-DECR-DAYS-9. 17990000
180000     MOVE PC-A0                        TO DPG51-CALENDAR-TYPE.    18000000
180100                                                                  18010000
180200     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    18020000
180300                                             DPG54 DPG55 DPG56.   18030000
180400                                                                  18040000
180500     EVALUATE TRUE                                                18050000
180600         WHEN DPG54-SEVERE-ERROR                                  18060000
180700         WHEN DPG54-DATE-INVALID                                  18070000
180800             MOVE TR018-DPU-TRN-TYP       TO TR251-TRN-TYP        18080000
180900             MOVE 'TURNAROUND PROC'       TO TR251-DATA-IN-ERROR  18090000
181000             MOVE PV-REFORMAT-TMST-DTE    TO TR251-DATA-VALUE     18100000
181100             MOVE PC-WARNING              TO TR251-ERROR-TYPE     18110000
181200             MOVE 'BAD CALL TO CALANDER ROUTINE'                  18120000
181300                                          TO TR251-ERROR-MSG      18130000
181400             PERFORM 6190-MOVES-FOR-ERROR-REC                     18140000
181500             PERFORM 6200-WRITE-ERROR-REPORT                      18150000
181600     END-EVALUATE.                                                18160000
181700                                                                  18170000
181800                                                                  18180000
181900 EJECT                                                            18190000
182000***************************************************************** 18200000
182100* SETUP THE ERROR RECORD PRIOR TO WRITING OUT TO THE ERROR FILE.* 18210000
182200***************************************************************** 18220000
                                                                        18221015
      * MS 07/01/2010                                                   18222015
      * ADDED PROCESSING FOR THE RECORD TYPE ARVDCN AND ARVDRD.         18223015
                                                                        18224015
182300 6190-MOVES-FOR-ERROR-REC.                                        18230000
182400                                                                  18240000
182500*    ************************************************************ 18250000
182600*    * KEY FIELDS AND OTHERS COMMON TO ALL RECORDS.             * 18260000
182700*    ************************************************************ 18270000
182800     MOVE PC-E                     TO TR251-RPT-TYP.              18280000
182900     MOVE TR018-DPU-TRN-TYP        TO TR251-TRN-TYP.              18290000
183000     MOVE PV-PROCESS-SEQ-NBR       TO TR251-PROCESS-SEQ-NBR.      18300000
183100     MOVE TR018-DPU-ENT-ID         TO TR251-DAT-SRC-ENT-ID.       18310000
183200     MOVE TR018-DPU-REC-TYP-CDE    TO TR251-REC-TYP-DPU-CDE.      18320000
183300     MOVE TR018-DPU-SEQ-NBR        TO TR251-DPU-SEQ-NBR.          18330000
183400     MOVE TR018-DPU-3RD-PARTY-CDE  TO TR251-DPU-3RD-PARTY-CDE.    18340000
183500     MOVE TR018-DPU-CONTNR-ID      TO TR251-CONTNR-ID.            18350000
183600     MOVE TR018-DPU-PO-NBR         TO TR251-PO-NBR.               18360000
183700     MOVE TR018-DPU-EXTL-REF-NBR   TO TR251-EXTL-REF-NBR.         18370000
183800     MOVE TR018-DPU-IMPRT-VEH-NM   TO TR251-DPU-IMPRT-VEH-NM.     18380000
183900     MOVE TR018-DPU-DCONSLR-SCAC-ID                               18390000
184000                                   TO TR251-DCONSLR-SCAC-ID.      18400000
184100     MOVE PV-POE-NAME              TO TR251-POE-NM.               18410000
184200                                                                  18420000
184300     EVALUATE TR018-DPU-REC-TYP-CDE                               18430000
184400       WHEN PC-DPU                                                18440000
184500       WHEN PC-DPURDD                                             18450000
184600         MOVE TR018-DPU-DELY-ORD-RCVD-DTE TO                      18460000
184700                TR251-DPU-DELY-ORD-RCVD-DTE                       18470000
184800         IF TR018-DPU-DELY-ORD-RCVD-TM EQUAL SPACES OR ZEROES     18480000
184900             MOVE ZEROES TO TR251-DPU-DELY-ORD-RCVD-TM            18490000
185000         ELSE                                                     18500000
185100             MOVE TR018-DPU-DELY-ORD-RCVD-TM  TO                  18510000
185200                   TR251-DPU-DELY-ORD-RCVD-TM                     18520000
185300         END-IF                                                   18530000
185400                                                                  18540000
185500       WHEN PC-DLV                                                18550000
185600       WHEN PC-DLVRDD                                             18560000
185700         MOVE TR018-DLV-CONTNR-PCKUP-DTE  TO                      18570000
185800                TR251-DLV-CONTNR-PCKUP-DTE                        18580000
185900         IF TR018-DLV-CONTNR-PCKUP-TM EQUAL SPACES OR ZEROES      18590000
186000             MOVE ZEROES TO TR251-DLV-CONTNR-PCKUP-TM             18600000
186100         ELSE                                                     18610000
186200             MOVE TR018-DLV-CONTNR-PCKUP-TM TO                    18620000
186300                   TR251-DLV-CONTNR-PCKUP-TM                      18630000
186400         END-IF                                                   18640000
186500                                                                  18650000
             WHEN PC-ARVDCN                                             18651007
             WHEN PC-ARVDRD                                             18652001
               MOVE TR018-ARVDCN-ARRIVE-DECON-DTE  TO                   18653001
                      TR251-ARVDCN-ARRIVE-DECON-DTE                     18654001
               IF TR018-ARVDCN-ARRIVE-DECON-TM EQUAL SPACES OR ZEROES   18655001
                   MOVE ZEROES TO TR251-ARVDCN-ARRIVE-DECON-TM          18656001
               ELSE                                                     18657001
                   MOVE TR018-ARVDCN-ARRIVE-DECON-TM TO                 18658001
                         TR251-ARVDCN-ARRIVE-DECON-TM                   18659001
               END-IF                                                   18659107
186600       WHEN PC-DVN                                                18660000
186700       WHEN PC-DVNRDD                                             18670000
186800         MOVE TR018-DVN-CONTNR-DEVAN-DTE  TO                      18680000
186900                TR251-DVN-CONTNR-DEVAN-DTE                        18690000
187000         IF TR018-DVN-CONTNR-DEVAN-TM EQUAL SPACES OR ZEROES      18700000
187100             MOVE ZEROES TO TR251-DVN-CONTNR-DEVAN-TM             18710000
187200         ELSE                                                     18720000
187300             MOVE TR018-DVN-CONTNR-DEVAN-TM TO                    18730000
187400                   TR251-DVN-CONTNR-DEVAN-TM                      18740000
187500         END-IF                                                   18750000
187600                                                                  18760000
187700       WHEN PC-CRP                                                18770000
187800       WHEN PC-CRPRDD                                             18780000
187900         MOVE TR018-CRP-FRGT-RLSE-DTE     TO                      18790000
188000                TR251-CRP-FRGT-RLSE-DTE                           18800000
188100         IF TR018-CRP-FRGT-RLSE-TM EQUAL SPACES OR ZEROES         18810000
188200             MOVE ZEROES TO TR251-CRP-FRGT-RLSE-TM                18820000
188300         ELSE                                                     18830000
188400             MOVE TR018-CRP-FRGT-RLSE-TM  TO                      18840000
188500                   TR251-CRP-FRGT-RLSE-TM                         18850000
188600         END-IF                                                   18860000
188700                                                                  18870000
188800       WHEN PC-RTN                                                18880000
188900       WHEN PC-RTNRDD                                             18890000
189000         MOVE TR018-RTN-CONTNR-RETURN-DTE  TO                     18900000
189100                TR251-RTN-CONTNR-RETURN-DTE                       18910000
189200         IF TR018-RTN-CONTNR-RETURN-TM EQUAL SPACES OR ZEROES     18920000
189300             MOVE ZEROES TO TR251-RTN-CONTNR-RETURN-TM            18930000
189400         ELSE                                                     18940000
189500             MOVE TR018-RTN-CONTNR-RETURN-TM  TO                  18950000
189600                   TR251-RTN-CONTNR-RETURN-TM                     18960000
189700         END-IF                                                   18970000
189800     END-EVALUATE.                                                18980000
189900                                                                  18990000
190000 EJECT                                                            19000000
190100***************************************************************** 19010000
190200* SETUP THE ERROR RECORD PRIOR TO WRITING OUT TO THE ERROR FILE.* 19020000
190300***************************************************************** 19030000
190400 6200-WRITE-ERROR-REPORT.                                         19040000
190500                                                                  19050000
190600       MOVE PC-E                          TO TR251-RPT-TYP.       19060000
190700       MOVE TR018-DPU-CONTNR-ID           TO TR251-CONTNR-ID.     19070000
190800       MOVE TR018-DPU-EXTL-REF-NBR        TO TR251-EXTL-REF-NBR.  19080000
190900       MOVE TR018-DPU-PO-NBR              TO TR251-PO-NBR.        19090000
191000                                                                  19100000
191100       WRITE TR251-DELIVERY-ERROR-RECORD FROM                     19110000
191200             TR251-RECORD.                                        19120000
191300                                                                  19130000
191400       PERFORM 5450-INITIALIZE-ERROR-FIELDS.                      19140000
191500                                                                  19150000
191600 EJECT                                                            19160000
191700***************************************************************** 19170000
191800* SETUP THE ERROR RECORD PRIOR TO WRITING THE HEADER RECORD.    * 19180000
191900* THE DIFFERENCE BETWEEN THIS PARA AND 6200 IS THAT THIS DOES   * 19190000
192000* NOT INITIALIZE THE ERROR RECORD SO THE ORIGINAL ISA RECORD    * 19200000
192100* READ FROM INPUT CAN BE PASSED TO THE EXTRACT RECORD.          * 19210000
192200***************************************************************** 19220000
192300 6201-WRITE-ERROR-REPORT-HDR.                                     19230000
192400                                                                  19240000
192500       WRITE TR251-DELIVERY-ERROR-RECORD FROM                     19250000
192600             TR251-RECORD.                                        19260000
192700                                                                  19270000
192800 EJECT                                                            19280000
192900***************************************************************** 19290000
193000* SETUP THE ERROR RECORD PRIOR TO WRITING OUT TO THE ERROR FILE.* 19300000
193100***************************************************************** 19310000
193200 6205-WRITE-ERROR-REPORT-IEA.                                     19320000
193300                                                                  19330000
193400       MOVE PC-E      TO TR251-RPT-TYP.                           19340000
193500                                                                  19350000
193600       WRITE TR251-DELIVERY-ERROR-RECORD FROM                     19360000
193700             TR251-RECORD.                                        19370000
193800                                                                  19380000
193900       PERFORM 5450-INITIALIZE-ERROR-FIELDS.                      19390000
194000                                                                  19400000
194100 EJECT                                                            19410000
194200***************************************************************** 19420000
194300* SETUP THE EDITED UPDATE RECORD PRIOR TO WRITING TO THE UPDATE * 19430000
194400* FILE THAT WILL BE PASSED TO PROGRAM TRKUP255.                 * 19440000
194500***************************************************************** 19450000
194600 6400-WRITE-EDIT-EXTRACT.                                         19460000
194700                                                                  19470000
194800     WRITE TR028-UPDATE-DELIVERY-RECORD FROM                      19480000
194900           TR028-REC-TYP-DPU.                                     19490000
195000                                                                  19500000
195100     INITIALIZE TR028-REC-TYP-DPU.                                19510000
195200                                                                  19520000
195300 EJECT                                                            19530000
195400***************************************************************** 19540000
195500* WRITE THE EXTRACT RECORD FROM THE INPUT RECORD THAT WAS READ  * 19550000
195600* INTO THE WORKING STORAGE VARIABLE PV-HOLD-ISA-RECORD. THIS IS * 19560000
195700* ONLY EXECUTED TO PASS THE ISA RECORD TO THE EXTRACT FILE.     * 19570000
195800* THIS PARA ALSO INITIALIZES THE ERROR RECORD BECAUSE ALL OF THE* 19580000
195900* ISA RECORD WRITING WILL HAVE BEEN DONE AND THE FIELDS WILL BE * 19590000
196000* READY FOR THE NEXT RECORD.                                    * 19600000
196100***************************************************************** 19610000
196200 6401-WRITE-EDIT-EXTRACT-ISA.                                     19620000
196300                                                                  19630000
196400     MOVE TR018-REC-TYP-DPU  TO TR028-REC-TYP-DPU.                19640000
196500                                                                  19650000
196600     WRITE TR028-UPDATE-DELIVERY-RECORD FROM                      19660000
196700           TR028-REC-TYP-DPU.                                     19670000
196800                                                                  19680000
196900     INITIALIZE TR028-REC-TYP-DPU.                                19690000
197000                                                                  19700000
197100 EJECT                                                            19710000
197200***************************************************************** 19720000
197300* WRITE A RECORD TO THE TURNAROUND FILE.  THIS FILE WILL BE     * 19730000
197400* SORTED WITH THE INPUT FILE INTO THE NEXT EDIT RUN.            * 19740000
197500***************************************************************** 19750000
197600 6500-WRITE-TURNAROUND-RECORD.                                    19760000
197700                                                                  19770000
197800     WRITE TR018-DELIVERY-TURNAROUND-REC FROM                     19780000
197900                               PV-HOLD-TURNAROUND-OUT.            19790000
198000     INITIALIZE  PV-HOLD-TURNAROUND-OUT.                          19800000
198100                                                                  19810000
198200 EJECT                                                            19820000
198300******************************************************************19830000
198400* JOIN IMPORT CONTAINER MANIFEST TABLE (TIMCNTK) TO CONTAINER PO *19840000
198500* TABLE (TIMCNPO).                                               *19850000
198600******************************************************************19860000
198700 7000-SELECT-TIMCNTK.                                             19870000
198800                                                                  19880000
198810                                                                  19881000
198820     SET PS-CNTK-FOUND-NO          TO TRUE.                       19882000
198830     SET PS-CNTK-DUPLICATE-NO      TO TRUE.                       19883000
198840                                                                  19884000
198900     PERFORM                                                      19890000
199000         WITH TEST AFTER                                          19900000
199100         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     19910000
199200         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            19920000
199300                 SQLCODE = ZERO                     OR            19930000
199310                 SQLCODE = -811                     OR            19931000
199400                 SQLCODE = +100                                   19940000
199500                                                                  19950000
199600         EXEC SQL                                                 19960000
199700             SELECT A.CONTNR_ID                                   19970000
199800              INTO :IMCNTK-CONTNR-ID                              19980000
199900               FROM TIMCNTK A                                     19990000
200000                  , TIMCNPO B                                     20000000
200100              WHERE B.PO_NBR           = :PV-PO-NBR               20010000
200200                AND B.CONTNR_ID        = :PV-CONTNR-ID            20020000
200400                AND A.CONTNR_ID        = B.CONTNR_ID              20040000
200500                AND A.CONTNR_SEQ_NBR   = B.CONTNR_SEQ_NBR         20050000
200600         END-EXEC                                                 20060000
200700                                                                  20070000
200800         EVALUATE TRUE                                            20080000
200900             WHEN SQLCODE = ZERO                                  20090000
201000                 SET PS-CNTK-FOUND TO TRUE                        20100000
201100                                                                  20110000
201200             WHEN SQLCODE = +100                                  20120000
201300                 SET PS-CNTK-FOUND-NO TO TRUE                     20130000
201301                                                                  20130100
201310             WHEN SQLCODE = -811                                  20131000
201320                 SET PS-CNTK-DUPLICATE TO TRUE                    20132000
201400                                                                  20140000
201500             WHEN SQLCODE = -904                                  20150000
201600             WHEN SQLCODE = -913                                  20160000
201700                 CONTINUE                                         20170000
201800                                                                  20180000
201900             WHEN OTHER                                           20190000
202000                 DISPLAY '**************************************' 20200000
202100                 DISPLAY '** ABEND                            **' 20210000
202200                 DISPLAY '** PROGRAM = TRKUT250               **' 20220000
202300                 DISPLAY '** PARAGRAPH = 7000-SELECT-TIMCNTK  **' 20230000
202400                 DISPLAY '** SELECT TIMCNTK                   **' 20240000
202500                 DISPLAY '**************************************' 20250000
202600                 DISPLAY '** CONTNR ID          '                 20260000
202700                                    TR018-DPU-CONTNR-ID           20270000
203000                 DISPLAY '** PO NBR              '                20300000
203100                                    TR018-DPU-PO-NBR              20310000
203200                 DISPLAY '**************************************' 20320000
203300                 PERFORM 9100-SQL-ABEND                           20330000
203400         END-EVALUATE                                             20340000
203500     END-PERFORM.                                                 20350000
203600                                                                  20360000
203700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    20370000
203800         (SQLCODE NOT = ZERO  AND                                 20380000
203810          SQLCODE NOT = -811  AND                                 20381000
203900          SQLCODE NOT = +100)                                     20390000
204000                                                                  20400000
204100         DISPLAY '****************************************'       20410000
204200         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       20420000
204300         DISPLAY '** SELECT FROM TIMCNTK                **'       20430000
204400         DISPLAY '** PARAGRAPH = 7000-SELECT-TIMCNTK    **'       20440000
204500                 DISPLAY '** CONTNR ID          '                 20450000
204600                                    TR018-DPU-CONTNR-ID           20460000
204900                 DISPLAY '** PO NBR              '                20490000
205000                                    TR018-DPU-PO-NBR              20500000
205100         DISPLAY '****************************************'       20510000
205200         PERFORM 9100-SQL-ABEND                                   20520000
205300     END-IF.                                                      20530000
205400                                                                  20540000
205500 EJECT                                                            20550000
205600******************************************************************20560000
205700* SET THE CURRENT TIMESTAMP.                                     *20570000
205800******************************************************************20580000
205900 7100-SET-CURRENT-TMST.                                           20590000
206000                                                                  20600000
206100          EXEC SQL                                                20610000
206200              SET :PV-CURRENT-TMST = CURRENT TIMESTAMP            20620000
206300          END-EXEC                                                20630000
206400                                                                  20640000
206500         EVALUATE TRUE                                            20650000
206600             WHEN SQLCODE = ZERO                                  20660000
206700                 CONTINUE                                         20670000
206800                                                                  20680000
206900             WHEN SQLWARN0 NOT EQUAL SPACE                        20690000
207000             WHEN SQLCODE NOT EQUAL ZERO                          20700000
207100                 DISPLAY '**************************************' 20710000
207200                 DISPLAY '** ABEND                            **' 20720000
207300                 DISPLAY '** PROGRAM = TRKUT250               **' 20730000
207400                 DISPLAY '** PARAGRAPH = 7100-SET-CURRENT-TMST**' 20740000
207500                 DISPLAY '** SET CURRENT TIMESTAMP            **' 20750000
207600                 DISPLAY '** CURRENT TMST   = ' PV-CURRENT-TMST   20760000
207700                 DISPLAY '**************************************' 20770000
207800                 PERFORM 9100-SQL-ABEND                           20780000
207900         END-EVALUATE.                                            20790000
208000                                                                  20800000
208100 EJECT                                                            20810000
208200****************************************************************  20820000
208300* SELECT TPURCHS                                                  20830000
208400****************************************************************  20840000
208500                                                                  20850000
208600 7110-SELECT-TPURCHS.                                             20860000
208700                                                                  20870000
208800     SET  PS-PO-ACTIVE-ON-MAINFRAME-NO   TO TRUE                  20880000
208810     SET  PS-PO-FOUND-ON-MAINFRAME-NO    TO TRUE                  20881000
208900     MOVE TR018-DPU-PO-NBR  TO PURCHS-PO-NBR                      20890000
209000                                                                  20900000
209100     PERFORM                                                      20910000
209200         WITH TEST AFTER                                          20920000
209300         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     20930000
209400         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            20940000
209500                 SQLCODE = ZERO                     OR            20950000
209600                 SQLCODE = +100                                   20960000
209700                                                                  20970000
209800         EXEC SQL                                                 20980000
209900             SELECT PO_NBR,                                       20990000
210000                    STATUS_CDE                                    21000000
210100              INTO :PURCHS-PO-NBR,                                21010000
210200                   :PURCHS-STATUS-CDE                             21020000
210300               FROM TPURCHS                                       21030000
210400              WHERE PO_NBR           = :PURCHS-PO-NBR AND         21040000
210500                    VER_STATUS_CDE   = 'A'                        21050000
210600         END-EXEC                                                 21060000
210700                                                                  21070000
210800         EVALUATE TRUE                                            21080000
210900             WHEN SQLCODE = ZERO                                  21090000
210910                SET PS-PO-FOUND-ON-MAINFRAME TO TRUE              21091000
211000                IF PURCHS-STATUS-CDE = 'AC' OR 'AP'               21100000
211100                   SET PS-PO-ACTIVE-ON-MAINFRAME TO TRUE          21110000
211200                END-IF                                            21120000
211300             WHEN SQLCODE = +100                                  21130000
211400                CONTINUE                                          21140000
211500             WHEN SQLWARN0 NOT EQUAL SPACE                        21150000
211600             WHEN SQLCODE NOT EQUAL ZERO                          21160000
211700                 DISPLAY '**************************************' 21170000
211800                 DISPLAY '** ABEND                              ' 21180000
211900                 DISPLAY '** PROGRAM = TRKUT250                 ' 21190000
212000                 DISPLAY '** PARAGRAPH = 7110-SELECT-TPURCHS    ' 21200000
212100                 DISPLAY '** PO NUMBER = ' PURCHS-PO-NBR          21210000
212200                 DISPLAY '** SELECT FROM TPURCHS                ' 21220000
212300                 DISPLAY '**************************************' 21230000
212400                 PERFORM 9100-SQL-ABEND                           21240000
212500         END-EVALUATE                                             21250000
212600     END-PERFORM.                                                 21260000
212700                                                                  21270000
212800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    21280000
212900         (SQLCODE NOT = ZERO AND                                  21290000
213000             SQLCODE NOT = +100)                                  21300000
213100         DISPLAY '****************************************'       21310000
213200         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO   '       21320000
213300         DISPLAY '** SELECT FROM TPURCHS                  '       21330000
213400         DISPLAY '** PO NUMBER = ' PURCHS-PO-NBR                  21340000
213500         DISPLAY '** PARAGRAPH = 7110-SELECT-TPURCHS      '       21350000
213600         DISPLAY '****************************************'       21360000
213700         PERFORM 9100-SQL-ABEND                                   21370000
213800     END-IF.                                                      21380000
213900******************************************************************21390000
214000* SELECT THE CONSOLIDATOR ENTERPRISE NAME FOR HEADER RECORD.     *21400000
214100******************************************************************21410000
214200 7292-SELECT-TENTNME.                                             21420000
214300                                                                  21430000
214400     PERFORM                                                      21440000
214500         WITH TEST AFTER                                          21450000
214600         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     21460000
214700         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            21470000
214800                 SQLCODE = ZERO                     OR            21480000
214900                 SQLCODE = +100                                   21490000
215000                                                                  21500000
215100         EXEC SQL                                                 21510000
215200             SELECT DISTINCT                                      21520000
215300                    A.ENT_NAME_DESC                               21530000
215400              INTO :ENTNME-ENT-NAME-DESC                          21540000
215500               FROM TENTNME  A                                    21550000
215600              WHERE A.ENT_ID              = :PV-ENT-ID            21560000
215700                AND A.TYPE_CDE            = '01'                  21570000
215800         END-EXEC                                                 21580000
215900                                                                  21590000
216000         EVALUATE TRUE                                            21600000
216100             WHEN SQLCODE = ZERO                                  21610000
216200             WHEN SQLCODE = -811                                  21620000
216300                 SET PS-VALID-ENTNME   TO TRUE                    21630000
216400                                                                  21640000
216500             WHEN SQLCODE = +100                                  21650000
216600                 SET PS-INVALID-ENTNME TO TRUE                    21660000
216700                                                                  21670000
216800             WHEN SQLCODE = -904                                  21680000
216900             WHEN SQLCODE = -913                                  21690000
217000                 CONTINUE                                         21700000
217100                                                                  21710000
217200             WHEN SQLWARN0 NOT EQUAL SPACE                        21720000
217300             WHEN SQLCODE NOT EQUAL ZERO                          21730000
217400                 DISPLAY '**************************************' 21740000
217500                 DISPLAY '** ABEND                            **' 21750000
217600                 DISPLAY '** PROGRAM = TRKUT250               **' 21760000
217700                 DISPLAY '** PARAGRAPH = 7292-SELECT-TENTNME  **' 21770000
217800                 DISPLAY '** SELECT CONSOLIDATOR NAME         **' 21780000
217900                 DISPLAY '** FROM ISA RECORD.                 **' 21790000
218000                 DISPLAY '** VEND ID      = ' PV-VEND-ID          21800000
218100                 DISPLAY '** VEND ID QUAL = ' PV-VEND-ID-QUAL     21810000
218200                 DISPLAY '**************************************' 21820000
218300                 PERFORM 9100-SQL-ABEND                           21830000
218400         END-EVALUATE                                             21840000
218500     END-PERFORM.                                                 21850000
218600                                                                  21860000
218700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    21870000
218800         (SQLCODE NOT = ZERO    AND                               21880000
218900             SQLCODE NOT = +100 AND                               21890000
219000             SQLCODE NOT = -811)                                  21900000
219100         DISPLAY '****************************************'       21910000
219200         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       21920000
219300         DISPLAY '** SELECT FROM TENTNME                **'       21930000
219400         DISPLAY '** PARAGRAPH = 7292-SELECT-TENTNME    **'       21940000
219500         DISPLAY '** VEND ID      = ' PV-VEND-ID                  21950000
219600         DISPLAY '** VEND ID QUAL = ' PV-VEND-ID-QUAL             21960000
219700         DISPLAY '****************************************'       21970000
219800         PERFORM 9100-SQL-ABEND                                   21980000
219900     END-IF.                                                      21990000
220000                                                                  22000000
220100 EJECT                                                            22010000
220200******************************************************************22020000
220300* OPEN POE CURSOR                                                 22030000
220400******************************************************************22040000
220500 7300-OPEN-POE-CURSOR.                                            22050000
220600     EXEC SQL                                                     22060000
220700         OPEN POE-CSR                                             22070000
220800     END-EXEC.                                                    22080000
220900                                                                  22090000
221000     EVALUATE TRUE                                                22100000
221100        WHEN SQLWARN0 NOT EQUAL SPACE                             22110000
221200        WHEN SQLCODE NOT EQUAL ZERO                               22120000
221300           DISPLAY '** ABEND **'                                  22130000
221400           DISPLAY '** PROGRAM = TRKUP250 **'                     22140000
221500           DISPLAY '** PARAGRAPH = 7300-OPEN-POE-CURSOR**'        22150000
221600           DISPLAY '** CONTNR-ID = ' TR018-DPU-CONTNR-ID          22160000
221800           DISPLAY '**    PO-NBR = ' TR018-DPU-PO-NBR             22180000
221900           PERFORM 9100-SQL-ABEND                                 22190000
222000     END-EVALUATE.                                                22200000
222100                                                                  22210000
222200****************************************************************  22220000
222300* FETCH POE CURSOR                                                22230000
222400****************************************************************  22240000
222500 7310-FETCH-POE-CURSOR.                                           22250000
222600     EXEC SQL                                                     22260000
222700         FETCH POE-CSR                                            22270000
222800              INTO :IMPOE-POE-NM                                  22280000
222900     END-EXEC.                                                    22290000
223000     EVALUATE TRUE                                                22300000
223100        WHEN SQLCODE = ZERO                                       22310000
223200        WHEN SQLCODE = +100                                       22320000
223300           CONTINUE                                               22330000
223400        WHEN SQLWARN0 NOT EQUAL SPACE                             22340000
223500        WHEN SQLCODE NOT EQUAL ZERO                               22350000
223600           DISPLAY '** ABEND **'                                  22360000
223700           DISPLAY '** PROGRAM = TRKUP250 **'                     22370000
223800           DISPLAY '** PARAGRAPH = 7310-FETCH-POE-CURSOR**'       22380000
223900           DISPLAY '** CONTNR-ID = ' TR018-DPU-CONTNR-ID          22390000
224100           DISPLAY '**    PO-NBR = ' TR018-DPU-PO-NBR             22410000
224200           PERFORM 9100-SQL-ABEND                                 22420000
224300     END-EVALUATE.                                                22430000
224400                                                                  22440000
224500******************************************************************22450000
224600* CLOSE POE CURSOR                                                22460000
224700******************************************************************22470000
224800 7320-CLOSE-POE-CURSOR.                                           22480000
224900     EXEC SQL                                                     22490000
225000       CLOSE POE-CSR                                              22500000
225100     END-EXEC.                                                    22510000
225200                                                                  22520000
225300     EVALUATE TRUE                                                22530000
225400        WHEN SQLWARN0 NOT EQUAL SPACE                             22540000
225500        WHEN SQLCODE NOT EQUAL ZERO                               22550000
225600           DISPLAY '** ABEND **'                                  22560000
225700           DISPLAY '** PROGRAM = TRKUP250 **'                     22570000
225800           DISPLAY '** PARAGRAPH = 7320-CLOSE-POE-CURSOR**'       22580000
225900           DISPLAY '** CONTNR-ID = ' TR018-DPU-CONTNR-ID          22590000
226100           DISPLAY '**    PO-NBR = ' TR018-DPU-PO-NBR             22610000
226200           PERFORM 9100-SQL-ABEND                                 22620000
226300     END-EVALUATE.                                                22630000
226400                                                                  22640000
226500 EJECT                                                            22650000
226600******************************************************************22660000
226700* SELECT TIMCNPO WHERE PO = CUSTOMS PO TO SEE IF CONTAINER EXISTS 22670000
226800******************************************************************22680000
226900 7450-SELECT-TIMCNPO.                                             22690000
227000                                                                  22700000
227100     MOVE TR018-DPU-PO-NBR TO IMCNPO-PO-NBR.                      22710000
227200                                                                  22720000
227300     PERFORM                                                      22730000
227400         WITH TEST AFTER                                          22740000
227500         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     22750000
227600         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            22760000
227700                 SQLCODE = ZERO                     OR            22770000
227800                 SQLCODE = +100                     OR            22780000
227900                 SQLCODE = -811                                   22790000
228000                                                                  22800000
228100         EXEC SQL                                                 22810000
228200             SELECT  DISTINCT                                     22820000
228300                     A.CONTNR_ID                                  22830000
228400               INTO :IMCNPO-CONTNR-ID                             22840000
228500               FROM  TIMCNPO  A                                   22850000
228600              WHERE  A.PO_NBR        = :IMCNPO-PO-NBR             22860000
228700         END-EXEC                                                 22870000
228800                                                                  22880000
228900         EVALUATE TRUE                                            22890000
229000             WHEN SQLCODE = ZERO                                  22900000
229100             WHEN SQLCODE = -811                                  22910000
229200                 SET PS-PO-EXISTS-ON-TIMCNPO TO TRUE              22920000
229300                                                                  22930000
229400             WHEN SQLCODE = +100                                  22940000
229500                 CONTINUE                                         22950000
229600                                                                  22960000
229700             WHEN SQLCODE = -904                                  22970000
229800             WHEN SQLCODE = -913                                  22980000
229900                 CONTINUE                                         22990000
230000                                                                  23000000
230100             WHEN OTHER                                           23010000
230200                 DISPLAY '**************************************' 23020000
230300                 DISPLAY '** ABEND                            **' 23030000
230400                 DISPLAY '** PROGRAM = TRKUT250               **' 23040000
230500                 DISPLAY '** PARAGRAPH = 7450-SELECT-TIMCNPO  **' 23050000
230600                 DISPLAY '** PO NUMBER   =' TR018-DPU-PO-NBR      23060000
230700                 DISPLAY '**************************************' 23070000
230800                 PERFORM 9100-SQL-ABEND                           23080000
230900         END-EVALUATE                                             23090000
231000     END-PERFORM.                                                 23100000
231100                                                                  23110000
231200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    23120000
231300            (SQLCODE NOT = ZERO AND                               23130000
231400             SQLCODE NOT = +100 AND                               23140000
231500             SQLCODE NOT = -811)                                  23150000
231600         DISPLAY '****************************************'       23160000
231700         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       23170000
231800         DISPLAY '** PROGRAM = TRKUT250                 **'       23180000
231900         DISPLAY '** PARAGRAPH = 7450-SELECT-TIMCNPO    **'       23190000
232000         DISPLAY '** PO NUMBER   =' TR018-DPU-PO-NBR              23200000
232100         DISPLAY '****************************************'       23210000
232200         PERFORM 9100-SQL-ABEND                                   23220000
232300     END-IF.                                                      23230000
232400                                                                  23240000
232500 EJECT                                                            23250000
232600******************************************************************23260000
232700* CLOSE THE INPUT AND OUTPUT FILES AND DISPLAY MISCELLANEOUS     *23270000
232800* JOB SUMMARY INFORMATION.                                       *23280000
232900* THE LAST RECORD ON THE FILE MUST BE AN EDI IEA RECORD.  IF IT  *23290000
233000* IS NOT, CALL THE EDI GROUP AND HAVE THEM CHECK THE INBOUND     *23300000
233100* TRANSMISSION.  IF ONE RECORD IS EVEN 1 BYTE TOO LONG, THE EDI  *23310000
233200* TRANSLATOR STOPS TRANSLATING AND ENDS AS IF NOTHING WENT WRONG.*23320000
233300* NO RETURN CODE OR MESSAGE IS SENT.                             *23330000
233400******************************************************************23340000
233500 8000-EOJ-ROUTINE.                                                23350000
233600                                                                  23360000
233700     IF TR251-ERROR-TYPE = PC-EMPTY                               23370000
233800         CONTINUE                                                 23380000
233900     ELSE                                                         23390000
234000         PERFORM 6040-CHECK-IEA-RECORD                            23400000
234100     END-IF.                                                      23410000
234200                                                                  23420000
234300     CLOSE TR018-DELIVERY-FILE                                    23430000
234400           TR028-UPDATE-DELIVERY-FILE                             23440000
234500           TR018-DELIVERY-TURNAROUND-FILE                         23450000
234600           TR251-DELIVERY-ERROR-FILE.                             23460000
234700                                                                  23470000
234800     DISPLAY '**********************************'.                23480000
234900     DISPLAY '** TRKUT250 SUMMARY **'.                            23490000
235000     DISPLAY 'TOTAL DELY INPUT RECS  = ' PA-TOTAL-INPUT-READ.     23500000
235100     DISPLAY 'TOTAL EDI RECS         = ' PA-TOTAL-EDI-REC-READ.   23510000
235200     DISPLAY 'TOTAL DELY ADD RECS    = ' PA-TOT-DELY-RECS-ADD.    23520000
235300     DISPLAY 'TOTAL DELY CHG RECS    = ' PA-TOT-DELY-RECS-CHANGE. 23530000
235400     DISPLAY 'TOTAL DELY DEL RECS    = ' PA-TOT-DELY-RECS-DELETE. 23540000
235500     DISPLAY '**********************************'.                23550000
235600                                                                  23560000
235700 EJECT                                                            23570000
235800******************************************************************23580000
235900* PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    *23590000
236000* ERROR OR WARNING CODE OCCURS.                                  *23600000
236100******************************************************************23610000
236200 9100-SQL-ABEND.                                                  23620000
236300******************************************************************23630000
236400* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-   *23640000
236500* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE        *23650000
236600* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE    *23660000
236700* FORMAT.                                                        *23670000
236800******************************************************************23680000
236900                                                                  23690000
237000     COPY DPPD004.                                                23700000
237100                                                                  23710000
237200     DISPLAY 'CONTNR ID          '  TR018-DPU-CONTNR-ID.          23720000
237300     DISPLAY 'PO NUMBER          '  TR018-DPU-PO-NBR.             23730000
237500     MOVE +4013 TO ABEND-CODE.                                    23750000
237600     CALL 'ILBOABN0' USING ABEND-CODE.                            23760000
237700                                                                  23770000
