000010******************************************************************00001071
000020* THIS TEST VERSION HAS CHANGES FOR E-COMMERCE LABEL             *00002071
000030* ALSO CHANGES FOR NEW P2L SYSTEMS                               *00003071
000040******************************************************************00004071
000050*  I M P O R T A N T --- WHEN COMPILING THIS PROGRAM THE SOCKET  *00005071
000060* SWITCH ON THE 2ND COMPILE SCREEN NEEDS TO BE SET TO 'Y'.  THIS *00006071
000070* PROGRAM IS USING "EZASOKET".                                   *00007071
000080******************************************************************00008071
000090                                                                  00009071
000100*-----------------------*                                         00010071
000110 IDENTIFICATION DIVISION.                                         00011071
000120*-----------------------*                                         00012071
000130 PROGRAM-ID.    PCKCS701.                                         00013071
000140 AUTHOR.        DENISE HAHN.                                      00014071
000150 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00015071
000160 DATE-WRITTEN.  05-28-98.                                         00016071
000170 DATE-COMPILED.                                                   00017071
000180                                                                  00018071
000190*---------------------------------------------------------------* 00019071
000200* - - - -  I M P O R T A N T - - - - -                          * 00020071
000210*  REMOVE THE HARDCODE - TKMA408 CODE REPLACE IT WITH THE *??   * 00021071
000220*  CODE LINES --- THESE WERE NEEDED JUST FOR TESTING            * 00022071
000230*  THESE LINES PREVENT WRITING TO P2L                           * 00023071
000240* - - - -  I M P O R T A N T - - - - -                          * 00024071
000250*---------------------------------------------------------------* 00025071
000260* - - - -  I M P O R T A N T - - - - -                          * 00026071
000270*  REMOVE THE HARDCODE - TKMA408 CODE REPLACE IT WITH THE *==   * 00027071
000280*  CODE LINES --- THESE WERE NEEDED JUST FOR TESTING            * 00028071
000290* - - - -  I M P O R T A N T - - - - -                          * 00029071
000300*---------------------------------------------------------------* 00030071
000310*    E701 - P2L/CASEPACK CREATE LABEL LIST.                     * 00031071
000320*                                                               * 00032071
000330*    THIS PROGRAM GENERATES A LIST OF LINES FOR A GIVEN         * 00033071
000340*    PO/RECEIVER. BASED ON THE OPTIONS ENTEFED ON THE CRITERIA  * 00034071
000350*    SPECIFICATION SCREEN, THIS PROGRAM WILL BE ABLE TO         * 00035071
000360*    DETERMINE HOW MANY FULL CASE DISTRIBUTIONS CAN BE DONE     * 00036071
000370*    BY STORE, CREATE THE STORE SHIPPING MANIFEST -OR- PIGGYBACK* 00037071
000380*    LABELS FOR THOSE CARTONS AND CREATE THE P2L LABELS FOR THE * 00038071
000390*    REMAINING CARTONS WHICH MEED TO BE PROCESSED IN THE P2L    * 00039071
000400*    SYSTEM, AND DOWNLOAD THE INFORMATION TO THE P2L SYSTEM.    * 00040071
000410*                                                               * 00041071
000411* 06/07/2013  SHOBHIT BAIJAL           TKID: TKMALR7            * 00041171
000412*             MODIFIED FOR THE RFID PROJECT #5148B. THIS CHANGE * 00041271
000413*             IS TO REPLACE THE TABLE TKRPRPM WITH THE NEW RFID * 00041371
000414*             TABLE RIT_RFID_VRFN.                              * 00041471
000415*             CHANGES TAGGED AS SB 06/07/13 PR5148B             * 00041571
000416*---------------------------------------------------------------* 00041671
000417* DATE  11/04/2021                                                00041771
000418*            - CHANGE CALL OF 'DPKUT100' TO                     * 00041871
000419*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 00041971
000420*              MAKING THE CALL DYNAMIC VS STATIC                * 00042071
000421*     MADE BY: GERMAN BANDA            WR/IR #: CHG0264232        00042171
000422*-----------------------------------------------------------------00042271
000423* DATE  11/07/2022                                              * 00042371
000424*            - ADD COPYBOOK DPWS930                             * 00042471
000425*              CHANGE CALL TO DPWS030 FROM STATIC TO            * 00042571
000426*              DYNAMIC.                                         * 00042671
000427*     MADE BY: BOB MCASEY              WR/IR #: CHG0277910      * 00042771
000428*-----------------------------------------------------------------00042871
000429                                                                  00042971
000430 ENVIRONMENT DIVISION.                                            00043071
000431                                                                  00043171
000432 DATA DIVISION.                                                   00043271
000433                                                                  00043371
000434 WORKING-STORAGE SECTION.                                         00043471
000435                                                                  00043571
000436 01  DK-DB2-KEYS.                                                 00043671
000437     05  DK-CORPORATE              PIC S9(04) COMP VALUE +90.     00043771
000438     05  DK-OPER-UNT-ID            PIC S9(04) COMP VALUE +0.      00043871
000439     05  DK-OPER-UNT-ID-2          PIC S9(04) COMP VALUE +0.      00043971
000440     05  DK-OPER-UNT-ID-3          PIC S9(04) COMP VALUE +0.      00044071
000450     05  DK-OPER-UNT-ID-4          PIC S9(04) COMP VALUE +0.      00045071
000460     05  DK-LABOR-OPER             PIC S9(04) COMP VALUE +0.      00046071
000470     05  DK-FCLTY-ID               PIC S9(04) COMP VALUE +0.      00047071
000480     05  DK-P2L-MOD                PIC S9(04) COMP VALUE +0.      00048071
000490     05  DK-PO-NBR                 PIC S9(09) COMP VALUE +0.      00049071
000500     05  DK-REC-SEQ-NBR            PIC S9(09) COMP VALUE +0.      00050071
000510     05  DK-LINE-NBR               PIC S9(09) COMP VALUE +0.      00051071
000520     05  DK-LINE-NBR-2             PIC S9(09) COMP VALUE +0.      00052071
000530     05  DK-PRTR-ID                PIC S9(04) COMP VALUE +0.      00053071
000540     05  DK-WORK-ORD-SEQ-NBR       PIC S9(04) COMP VALUE ZEROS.   00054071
000550     05  DK-INNR-PACK-QTY          PIC S9(04) COMP VALUE +0.      00055071
000560     05  DK-CLASS                  PIC  X(02)      VALUE ZEROS.   00056071
000570     05  DK-DEPT-2                 PIC  X(03)      VALUE ZEROS.   00057071
000580     05  DK-CLASS-2                PIC  X(02)      VALUE ZEROS.   00058071
000590     05  DK-PREPK-ID               PIC S9(04) COMP VALUE ZEROS.   00059071
000600     05  DK-ITEM-NBR               PIC S9(15)V COMP-3.            00060071
000610                                                                  00061071
000620     05  DK-CURRENT-TIMESTAMP      PIC X(26)   VALUE SPACES.      00062071
000630                                                                  00063071
000640                                                                  00064071
000650 01  PC-PROGRAM-CONSTANTS.                                        00065071
000660     05  PC-SPACE                       PIC  X(01)  VALUE ' '.    00066071
000670     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00067071
000680                                                    'PC701A  '.   00068071
000690     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00069071
000700                                                    'PCKM701 '.   00070071
000701     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00070171
000702                                                    'PCKCS701'.   00070271
000703     05  PC-LABEL-PROGRAM                PIC  X(08)  VALUE        00070371
000704                                                    'PCKCS191'.   00070471
000705     05  PC-UCC128-LBL-CALC              PIC  X(08)  VALUE        00070571
000706                                                    'PCKCS719'.   00070671
000707     05  PC-AUDIT-RTN                    PIC  X(08)  VALUE        00070771
000708                                                    'RCKCS290'.   00070871
000709     05  PC-CONTAINER-UPD-TRAN           PIC  X(04)  VALUE        00070971
000710                                                    'I210'.       00071071
000720     05  PC-AUTOVE-DETERMIN-PGM          PIC  X(08)  VALUE        00072071
000730                                                    'RCKUT127'.   00073071
000740     05  PC-TMKCS520                     PIC X(08)   VALUE        00074071
000750                                                    'TMKCS520'.   00075071
000760     05  PC-FKEY-MODULE                  PIC X(08) VALUE          00076071
000770                                                     'RCKUT126'.  00077071
000780     05  PC-FKEY-MODULE-LENGTH           PIC S9(04) VALUE  +400   00078071
000790                                                    COMP SYNC.    00079071
000800                                                                  00080071
000810     05  PC-LINE-DOWNLOAD-TO-QNX-IND PIC  X(01)  VALUE SPACE.     00081071
000820         88  PC-LINE-DOWNLOADED-TO-QNX           VALUE 'Y'.       00082071
000830                                                                  00083071
000840     05  PC-BANK1-IP-ADDR                PIC  X(15)  VALUE        00084071
000850         '128.009.222.083'.                                       00085071
000860     05  PC-BANK2-IP-ADDR                PIC  X(15)  VALUE        00086071
000870         '128.009.222.084'.                                       00087071
000880     05  PC-BANKT-IP-ADDR                PIC  X(15)  VALUE        00088071
000890         '128.009.170.068'.                                       00089071
000900     05  PC-BANK1-SRVR-NBR               PIC  X(03)  VALUE '001'. 00090071
000910     05  PC-BANK2-SRVR-NBR               PIC  X(03)  VALUE '002'. 00091071
000920     05  PC-BANK3-SRVR-NBR               PIC  X(03)  VALUE '003'. 00092071
000930     05  PC-BANK4-SRVR-NBR               PIC  X(03)  VALUE '999'. 00093071
000940                                                                  00094071
000950     05  PC-PGBK-LABEL-PRTR        PIC  X(01)  VALUE  'P'.        00095071
000960     05  PC-PGBK-LABEL-PRTR-SYSTEC PIC  X(01)  VALUE  'R'.        00096071
000970     05  PC-PGBK-LABEL-PRTR-TRACE  PIC  X(01)  VALUE  'T'.        00097071
000980     05  PC-SHIP-MFST-PRTR-SYSTEC  PIC  X(01)  VALUE  'M'.        00098071
000990     05  PC-SHIP-MFST-PRTR         PIC  X(01)  VALUE  'S'.        00099071
001000     05  PC-SHIP-MFST-PRTR-LOG     PIC  X(01)  VALUE  'L'.        00100071
001010     05  PC-REPORT-PGM-1           PIC  X(08)  VALUE 'PCKCS126'.  00101071
001020     05  PC-REPORT-PGM-2           PIC  X(08)  VALUE 'PCKCS123'.  00102071
001030                                                                  00103071
001040     05  PC-DEFAULT-TIMESTAMP      PIC  X(26)  VALUE              00104071
001050                                  '9999-09-09-09.09.09.999999'.   00105071
001060     05  PC-DEFAULT-DTE            PIC  X(10)  VALUE              00106071
001070                                  '9999-09-09'.                   00107071
001080     05  PC-DEFAULT-TM             PIC  X(08)  VALUE              00108071
001090                                  '01.01.01'.                     00109071
001100                                                                  00110071
001110     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00111071
001120     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00112071
001130     05  PC-CRIT-SPEC-FORMAT            PIC  X(01)  VALUE '1'.    00113071
001140     05  PC-LIST-FORMAT                 PIC  X(01)  VALUE '2'.    00114071
001150                                                                  00115071
001160     05  PC-P2L-CASE-DESC               PIC  X(10)  VALUE         00116071
001170                                                    'P2L/CASE  '. 00117071
001180     05  PC-P2L-LBL-DESC                PIC  X(10)  VALUE         00118071
001190                                                    'P2L LBL   '. 00119071
001200     05  PC-CASE-LBL-DESC               PIC  X(10)  VALUE         00120071
001210                                                    'CASE LBL  '. 00121071
001220     05  PC-SHUFFLED-DESC               PIC  X(08)  VALUE         00122071
001230                                                    'SHUFFLED'.   00123071
001240     05  PC-BY-STORE-DESC               PIC  X(08)  VALUE         00124071
001250                                                    'BY STORE'.   00125071
001260     05  PC-NOT-APPL-DESC               PIC  X(08)  VALUE         00126071
001270                                                    'N/A     '.   00127071
001280                                                                  00128071
001290     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +10     00129071
001300                                                    COMP SYNC.    00130071
001310     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00131071
001320                                                    COMP SYNC.    00132071
001330     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00133071
001340                                                    +1000000      00134071
001350                                                    COMP-3.       00135071
001360     05  PC-MAX-RETRIES                 PIC S9(04)  VALUE  +2.    00136071
001370     05  PC-SEMI-COLON                  PIC  X(01)  VALUE ';'.    00137071
001380     05  PC-SEMI-COLON-2                PIC  X(01)  VALUE ''.    00138071
001390     05  PC-SEMI-COLON-3                PIC  X(01)  VALUE X'3B'.  00139071
001400     05  PC-INQ                         PIC  X(03)  VALUE 'INQ'.  00140071
001410     05  PC-UPD                         PIC  X(03)  VALUE 'UPD'.  00141071
001420     05  PC-DEL                         PIC  X(03)  VALUE 'DEL'.  00142071
001430     05  PC-ERR                         PIC  X(03)  VALUE 'ERR'.  00143071
001440                                                                  00144071
001450     05  PC-MGMX                        PIC  X(04)  VALUE 'MGMX'. 00145071
001460     05  PC-SPACES                      PIC  X(22)  VALUE SPACES. 00146071
001470                                                                  00147071
001480     05  PC-A                           PIC  X(01)  VALUE 'A'.    00148071
001490     05  PC-B                           PIC  X(01)  VALUE 'B'.    00149071
001500     05  PC-D                           PIC  X(01)  VALUE 'D'.    00150071
001510     05  PC-F                           PIC  X(01)  VALUE 'F'.    00151071
001520     05  PC-I                           PIC  X(01)  VALUE 'I'.    00152071
001530     05  PC-N                           PIC  X(01)  VALUE 'N'.    00153071
001540     05  PC-M                           PIC  X(01)  VALUE 'M'.    00154071
001550     05  PC-P                           PIC X(01)   VALUE 'P'.    00155071
001560     05  PC-R                           PIC X(01)   VALUE 'R'.    00156071
001570     05  PC-U                           PIC X(01)   VALUE 'U'.    00157071
001580     05  PC-X                           PIC X(01)   VALUE 'X'.    00158071
001590     05  PC-Y                           PIC X(01)   VALUE 'Y'.    00159071
001600                                                                  00160071
001610     05  PC-ONE                         PIC  9(01)  VALUE 1.      00161071
001620     05  PC-TWO                         PIC  9(01)  VALUE 2.      00162071
001630     05  PC-01                          PIC  X(02)  VALUE '01'.   00163071
001640     05  PC-001                         PIC  X(03)  VALUE '001'.  00164071
001650     05  PC-0001                        PIC  9(04)  VALUE 0001.   00165071
001660     05  PC-ZEROES                      PIC S9(03)  VALUE  +0.    00166071
001670     05  PC-PRTR-VALIDATION-PGM    PIC  X(08)  VALUE 'DPKCS060'.  00167071
001680                                                                  00168071
001690     05  PC-TRBL-CODE-525            PIC S9(04) COMP VALUE 525.   00169071
001700     05  PC-TROUBLE-WTR              PIC  X(08) VALUE 'TMKCS521'. 00170071
001710     05  PC-TROUBLE-LENGTH           PIC S9(04) COMP VALUE +600.  00171071
001720                                                                  00172071
001730     05  PC-P2L-PROCESSOR            PIC  X(04) VALUE 'P2L '.     00173071
001740     05  PC-DOWNLOADED-STATUS        PIC  X(01) VALUE 'D'.        00174071
001750     05  PC-READY-TO-POST-STATUS     PIC  X(01) VALUE 'N'.        00175071
001760     05  PC-TBL-MAX-SIZE             PIC  9(02) VALUE 60.         00176071
001770     05  PC-OPERCO-NBR               PIC  X(02) VALUE '03'.       00177071
001780     05  PC-NEW-TROUBLE              PIC  X(01) VALUE 'N'.        00178071
001790     05  PC-IN-PROCESS-TROUBLE       PIC  X(01) VALUE 'I'.        00179071
001800     05  PC-INNER-PREPACK            PIC  X(06) VALUE 'INPRPK'.   00180071
001810     05  PC-MULTI-SKU                PIC  X(06) VALUE 'MLTSKU'.   00181071
001820     05  PC-SINGLE-SKU               PIC  X(06) VALUE 'SGLSKU'.   00182071
001830     05  PC-CASEPACK                 PIC  X(06) VALUE 'CASEPK'.   00183071
001840     05  PC-BULK                     PIC  X(06) VALUE 'BULK  '.   00184071
001850                                                                  00185071
001860* MAP HEADINGS                                                    00186071
001870     05  PC-PACK-HDG-2               PIC  X(08) VALUE 'PACK ID '. 00187071
001880     05  PC-SKU-HDG-2                PIC  X(08) VALUE '  SKU   '. 00188071
001890     05  PC-RATIO-HDG-2              PIC  X(04) VALUE ' RAT'.     00189071
001900     05  PC-INPK-HDG-1               PIC  X(04) VALUE '  IN'.     00190071
001910     05  PC-INPK-HDG-2               PIC  X(04) VALUE ' PAK'.     00191071
001920                                                                  00192071
001930     05  PC-PREPK-P2L-DWNLD          PIC  X(01) VALUE 'D'.        00193071
001940     05  PC-PREPK-NOT-DWNLD          PIC  X(01) VALUE 'P'.        00194071
001950     05  PC-NON-PREPK                PIC  X(01) VALUE 'N'.        00195071
001960                                                                  00196071
001970     05  PC-USE-UCC128               PIC X(19)  VALUE             00197071
001980                                     'USING UCC128 DATA  '.       00198071
001990     05  PC-IGNORE-UCC128            PIC X(19)  VALUE             00199071
002000                                     'IGNORE UCC128 DATA '.       00200071
002010     05  PC-NO-UCC128-AVAIL          PIC X(19)  VALUE             00201071
002020                                     'NO UCC128 DATA     '.       00202071
002030     05  PC-CASE-PROCESS-ONLY      PIC X(01)   VALUE 'C'.         00203071
002040                                                                  00204071
002050*----------------------------------------------------------------*00205071
002060*  SYSTEM MESSAGES                                               *00206071
002070*----------------------------------------------------------------*00207071
002080*   00005 - INVALID VALUE                                        *00208071
002090*   00007 - REQUIRED ENTRY                                       *00209071
002100*   00008 - MUST BE NUMERIC                                      *00210071
002110*   00045 - INVALID FUNCTION KEY                                 *00211071
002120*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *00212071
002130*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *00213071
002140*   00052 - END OF RANGE PRECEDES START OF RANGE                 *00214071
002150*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *00215071
002160*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *00216071
002170*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *00217071
002180*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *00218071
002190*   00069 - TOP OF LIST                                          *00219071
002200*   00070 - BOTTOM OF LIST                                       *00220071
002210*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *00221071
002220*   00115 - DELETE SUCCESSFUL                                    *00222071
002230*   00116 - CANNOT DELETE - RECORD DOES NOT EXIST                *00223071
002240*   00172 - NOTHING WAS REQUESTED TO BE DELETED                  *00224071
002250*   00279 - MORE ITEMS TO dISPLAY                                *00225071
002260*   00354 - DELETE PENDING - PRESS PF2 TO CONFIRM                *00226071
002270*   00551 - WAIT 15 SECONDS;RETRY FUNCTION AGAIN; IF UNSUCCESSFUL*00227071
002280*   00746 - INVALID PRINTER DESTINATION                          *00228071
002290*   00828 - CANNOT DELETE, RECEIVER OR RECEIPT ITEM HAS BEEN VER *00229071
002300*   00831 - INVALID COMBINATION OF FIELDS ENTERED FOR CHOSEN FUNC*00230071
002310*   00984 - DATABASE IS BUSY, TRY AGAIN IN A FEW MINUTES         *00231071
002320*   01000 = OUTER PACK MUST BE DIVISIBLE BY THE INNER PACK       *00232071
002330*   01563 = PRINTER ID MUST BE ENTERED FOR THIS SELECTION        *00233071
002340*   01730 - PO/RECEIVER HAS NOT BEEN ARRIVED                     *00234071
002350*   01731 - INVALID PACK-TO-LIGHT MODULE FOR DC                  *00235071
002360*   01756 - PO/RCVR CAN'T BE PROCESSED - RCVR LEVEL TROUBLE EXIST*00236071
002370*   01758 - STORE ALLOCATIONS NOT A MULTIPLE OF INNER PACK - F2  *00237071
002380*   01759 - STORE ALLOCATIONS NOT A MULTIPLE OF OUTER PACK       *00238071
002390*   01760 - PROCESS QTY AND TRANSCRIPTION QTY DO NOT MATCH       *00239071
002400*   01766 - COMMUNICATION ERROR TO P2L - LINES UP TO THIS POINT AR00240071
002410*   01767 - DATABASE BUSY, TRY AGAIN - LINES UP TO THIS POINT ARE*00241071
002420*   01768 - THIS LINE HAS BEEN PREVIOUSLY PROCESSED              *00242071
002430*   01769 - RECEIPT ITEM(S) IN TROUBLE STATUS - UNABLE TO PROCESS*00243071
002440*   01770 - SELECTED LINE(S) HAVE BEEN SUCCESSFULLY PROCESSED    *00244071
002450*   01771 - LINE(S) PROCESSED, LABELS REQUESTED, TROUBLE CREATED *00245071
002460*   01790 - PIGGYBACK LABELS CANNOT BE PRINTED IN A SHUFFLED SEQ *00246071
002470*   01791 - DOWNLOAD TO P2L COMPLETE, LABEL PRINT FAILED, TRY TO *00247071
002480*   01792 - LINE PROCESSING COMPLETE, LABEL PRINT FAILED, TRY TO *00248071
002490*   01805 - CANNOT DELETE, FULLCASE UNITS FOR ITEM HAVE BEEN CONF*00249071
002500*   01812 - CASEPACK QUANTITY CANNOT BE GREATER THAN 15 FOR PIGGY*00250071
002510*   01815 - LINE CANNOT BE PROCESSED - DC/RTV QUANTITY NOT VARIA *00251071
002520*   01833 - INNER PACK QUANTITY MUST BE GREATER THAN 1 TO BE CON *00252071
002530*   01852 - YOU DO NOT HAVE AUTHORITY TO DELETE BECAUSE OF PACK  *00253071
002540*   01897 - P2L CANNOT BE RESENT - LINE IS VERFYD, P2L COMPLETE  *00254071
002550*   01898 - SELECTED LINE(S) HAVE BEEN SUCCESSFULLY RE-SENT TO   *00255071
002560*   01999 - CARTON COUNT MUST BE GREATER THAN 1 WHEN AN ODD QTY  *00256071
002570*   02000 - ODD QUANTITY MUST BE A DIVISIBLE BY INNER PACK CONVEY*00257071
002580*   02001 - ODD QUANTITY CANNOT BE GREATER THAN 15 FOR PIGGYBACK *00258071
002590*   02045 - ODD CARTON QTY CANNOT BE ALLOCATED TO A STORE -      *00259071
002600*   02424 = PGYBK PRTRS CANNOT BE USED FOR PRE-PACK TYPE I OR M  *00260071
002610*   02445 = OUTER PK MUST BE MULTIPLE OF RATIO FOR PRE-PACK I/M  *00261071
002620*   02446 = ODD CRTN MUST BE MULTIPLE OF RATIO FOR PRE-PACK I/M  *00262071
002630*   02448 = USE PRE-PACK DTL LST TO VIEW DISTRO FOR PREPK I/M    *00263071
002640*   02449 = ONLY ONE LINE CAN BE SELECTED FOR PREPACK DTL LIST   *00264071
002650*   02450 = PREPK DTL LST IS USED FOR PRE-PACK I/M ONLY          *00265071
002660*   02458 = P2L ERROR, CHECK IF LINE LAUNCHED IN P2L             *00266071
002670*   02462 = CANNOT PROCESS PRE-PACK - PRE-PACK HAS CENTRAL STOCK *00267071
002680*   02469 = OUTER PACK MUST BE DIVISIBLE BY THE DRIVER LINE RATIO 00268071
002690*   02480 = PREPK HAS AN ALLOCATION NOT A MULT OF RATIO           00269071
002700*   02496 = INVALID FUNCTION - UCC128 DATA IS UNAVAILABLE         00270071
002710*   02497 = F2 CONFIRM - IGNORE UCC128 DATA                       00271071
002720*   02498 - INVALID FUNCTION-THIS LINE IS NOT USING UCC128 DATA   00272071
002730*   02501 - IGNORE UCC128 DATA SUCCESSFUL                         00273071
002740*   02502 - ERROR - LINE HAS CARTON RECORD FOR MULTIPLE LINES     00274071
002750*   02508 - CANNOT REPRT LBL FOR LINES PROCESSED USING UCC128     00275071
002760*   02509 - CARTONS CKED IN FOR PO/RCVR/LNE - F2 TO CONFIRM DELETE00276071
002770*   02519 - ERROR IN CREATING VIRTUAL LABELS - CONTACT SUPERVISOR 00277071
002780*   02520 - UNABLE TO PROCESS AS CASEPACK, LINE(S) HAVE P2L ALLOCA00278071
002790*   02528 - PO/RCVR/LINE CANT BE PROCESSED - LINE IS NOT TRANSCRIB00279071
002800*   02529 - ERROR - PREPACK HAS CARTON RECORD(S) THAT CONTAIN LINE00280071
002810*   02538 - NO P2L MODULES DEFINED FOR DC - PROCESS CASEPACK ONLY 00281071
002820*   02540 - UNABLE TO PROCESS LINE - LINE HAS BEEN LAUNCHED IN P2L00282071
002830*   02545 - CANNOT PROCESS PRE-PACK - PRE-PACK HAS E-COMM ALLOC   00283071
002840*   02890 - PRE-PACK RATIO MUST BE GREATER THAN ZERO              00284071
002850*   02945 - CANT USE INNER-PACK CONVEY OPTION WHEN USING UCC-128  00285071
002860*   02972 - CARTONS HAVE BEEN CHECKED IN FOR PO/RCVR LINE MUST BE 00286071
002870*           RECLAIMED                                             00287071
002880*   02973 - CARTONS DIVERTED/LOADED ON TRAILER FOR PO/RCVR/LNE -  00288071
002890*           MUST BE RECLAIMED                                     00289071
002900*   02994 - UNABLE TO SEND MORE THAN &VAR CARTONS TO P2L -        00290071
002910*           SYSTEM CONSTRAINT                                     00291071
002920*   03190 - YOU DO NOT HAVE AUTHORITY TO IGNORE UCC128   -        00292071
002930*   03191 - AUTO VE PURCHASE ORDER - NL OPTION INVALID WITH       00293071
002940*         - FULLCASE ALLOCATIONS                                  00294071
002950*   03253 - CANT DELETE CASEPACK; INITIALLY WAS DOWNLOADED BY &DC 00295071
002960*   03342 - CANNOT PROCESS CASEPACK SPLIT FOR AN AP RECEIVER      00296071
002970*   03350 - CARTONS SCANNED ONTO OUTBND TRLR - MUST SCAN OFF      00297071
002980*   03356 - CANNOT PROCESS AS P2l-all allocations dc/rtv locations00298071
002990*   03392 - PO/RCVR CAN'T BE PROCESSED - PACK 99 EXISTS           00299071
003000*   03398 - CANT DOWNLD PHY LABELS - ATTACHED TO DUMMY TRIP       00300071
003010*   03402 - CANT DOWNLD PHY LABELS - TRAILER IS NOT ARRIVED       00301071
003020*   03409 - ACTIVE CARTONS FOR LINE/PACK CANNOT DELETE           E00302071
003030*   03410 - UNABLE TO PROCESS - LINES HAVE BEEN VERIFIED  F5 REFRE00303071
003040*   03598 - sign on oper and receiver oper must match             00304071
003050*   99901 - INVALID COMMAND WAS ENTERED                          *00305071
003060*   99910 - YOU DO NOT HAVE SECURITY CLEARANCE FOR THE REQUESTED *00306071
003070*----------------------------------------------------------------*00307071
003080 01  PC-TSYMSG-NUMBERS.                                           00308071
003090     10  PC-TSYMSG-00005                PIC  9(05)  VALUE 00005.  00309071
003100     10  PC-TSYMSG-00007                PIC  9(05)  VALUE 00007.  00310071
003110     10  PC-TSYMSG-00008                PIC  9(05)  VALUE 00008.  00311071
003120     10  PC-TSYMSG-00045                PIC  9(05)  VALUE 00045.  00312071
003130     10  PC-TSYMSG-00050                PIC  9(05)  VALUE 00050.  00313071
003140     10  PC-TSYMSG-00051                PIC  9(05)  VALUE 00051.  00314071
003150     10  PC-TSYMSG-00052                PIC  9(05)  VALUE 00052.  00315071
003160     10  PC-TSYMSG-00053                PIC  9(05)  VALUE 00053.  00316071
003170     10  PC-TSYMSG-00054                PIC  9(05)  VALUE 00054.  00317071
003180     10  PC-TSYMSG-00055                PIC  9(05)  VALUE 00055.  00318071
003190     10  PC-TSYMSG-00057                PIC  9(05)  VALUE 00057.  00319071
003200     10  PC-TSYMSG-00069                PIC  9(05)  VALUE 00069.  00320071
003210     10  PC-TSYMSG-00070                PIC  9(05)  VALUE 00070.  00321071
003220     10  PC-TSYMSG-00101                PIC  9(05)  VALUE 00101.  00322071
003230     10  PC-TSYMSG-00115                PIC  9(05)  VALUE 00115.  00323071
003240     10  PC-TSYMSG-00116                PIC  9(05)  VALUE 00116.  00324071
003250     10  PC-TSYMSG-00172                PIC  9(05)  VALUE 00172.  00325071
003260     10  PC-TSYMSG-00279                PIC  9(05)  VALUE 00279.  00326071
003270     10  PC-TSYMSG-00354                PIC  9(05)  VALUE 00354.  00327071
003280     10  PC-TSYMSG-00551                PIC  9(05)  VALUE 00551.  00328071
003290     10  PC-TSYMSG-00746                PIC  9(05)  VALUE 00746.  00329071
003300     10  PC-TSYMSG-00828                PIC  9(05)  VALUE 00828.  00330071
003310     10  PC-TSYMSG-00831                PIC  9(05)  VALUE 00831.  00331071
003320     10  PC-TSYMSG-00886                PIC  9(05)  VALUE 00886.  00332071
003330     10  PC-TSYMSG-00984                PIC  9(05)  VALUE 00984.  00333071
003340     10  PC-TSYMSG-01000                PIC  9(05)  VALUE 01000.  00334071
003350     10  PC-TSYMSG-01563                PIC  9(05)  VALUE 01563.  00335071
003360     10  PC-TSYMSG-01730                PIC  9(05)  VALUE 01730.  00336071
003370     10  PC-TSYMSG-01731                PIC  9(05)  VALUE 01731.  00337071
003380     10  PC-TSYMSG-01756                PIC  9(05)  VALUE 01756.  00338071
003390     10  PC-TSYMSG-01758                PIC  9(05)  VALUE 01758.  00339071
003400     10  PC-TSYMSG-01759                PIC  9(05)  VALUE 01759.  00340071
003410     10  PC-TSYMSG-01760                PIC  9(05)  VALUE 01760.  00341071
003420     10  PC-TSYMSG-01766                PIC  9(05)  VALUE 01766.  00342071
003430     10  PC-TSYMSG-01767                PIC  9(05)  VALUE 01767.  00343071
003440     10  PC-TSYMSG-01768                PIC  9(05)  VALUE 01768.  00344071
003450     10  PC-TSYMSG-01769                PIC  9(05)  VALUE 01769.  00345071
003460     10  PC-TSYMSG-01770                PIC  9(05)  VALUE 01770.  00346071
003470     10  PC-TSYMSG-01771                PIC  9(05)  VALUE 01771.  00347071
003480     10  PC-TSYMSG-01790                PIC  9(05)  VALUE 01790.  00348071
003490     10  PC-TSYMSG-01791                PIC  9(05)  VALUE 01791.  00349071
003500     10  PC-TSYMSG-01792                PIC  9(05)  VALUE 01792.  00350071
003510     10  PC-TSYMSG-01805                PIC  9(05)  VALUE 01805.  00351071
003520     10  PC-TSYMSG-01812                PIC  9(05)  VALUE 01812.  00352071
003530     10  PC-TSYMSG-01815                PIC  9(05)  VALUE 01815.  00353071
003540     10  PC-TSYMSG-01833                PIC  9(05)  VALUE 01833.  00354071
003550     10  PC-TSYMSG-01852                PIC  9(05)  VALUE 01852.  00355071
003560     10  PC-TSYMSG-01857                PIC  9(05)  VALUE 01857.  00356071
003570     10  PC-TSYMSG-01897                PIC  9(05)  VALUE 01897.  00357071
003580     10  PC-TSYMSG-01898                PIC  9(05)  VALUE 01898.  00358071
003590     10  PC-TSYMSG-01999                PIC  9(05)  VALUE 01999.  00359071
003600     10  PC-TSYMSG-02000                PIC  9(05)  VALUE 02000.  00360071
003610     10  PC-TSYMSG-02001                PIC  9(05)  VALUE 02001.  00361071
003620     10  PC-TSYMSG-02045                PIC  9(05)  VALUE 02045.  00362071
003630     10  PC-TSYMSG-02424                PIC  9(05)  VALUE 02424.  00363071
003640     10  PC-TSYMSG-02445                PIC  9(05)  VALUE 02445.  00364071
003650     10  PC-TSYMSG-02446                PIC  9(05)  VALUE 02446.  00365071
003660     10  PC-TSYMSG-02448                PIC  9(05)  VALUE 02448.  00366071
003670     10  PC-TSYMSG-02449                PIC  9(05)  VALUE 02449.  00367071
003680     10  PC-TSYMSG-02450                PIC  9(05)  VALUE 02450.  00368071
003690     10  PC-TSYMSG-02458                PIC  9(05)  VALUE 02458.  00369071
003700     10  PC-TSYMSG-02462                PIC  9(05)  VALUE 02462.  00370071
003710     10  PC-TSYMSG-02469                PIC  9(05)  VALUE 02469.  00371071
003720     10  PC-TSYMSG-02480                PIC  9(05)  VALUE 02480.  00372071
003730     10  PC-TSYMSG-02496                PIC  9(05)  VALUE 02496.  00373071
003740     10  PC-TSYMSG-02497                PIC  9(05)  VALUE 02497.  00374071
003750     10  PC-TSYMSG-02498                PIC  9(05)  VALUE 02498.  00375071
003760     10  PC-TSYMSG-02501                PIC  9(05)  VALUE 02501.  00376071
003770     10  PC-TSYMSG-02502                PIC  9(05)  VALUE 02502.  00377071
003780     10  PC-TSYMSG-02508                PIC  9(05)  VALUE 02508.  00378071
003790     10  PC-TSYMSG-02509                PIC  9(05)  VALUE 02509.  00379071
003800     10  PC-TSYMSG-02519                PIC  9(05)  VALUE 02519.  00380071
003810     10  PC-TSYMSG-02520                PIC  9(05)  VALUE 02520.  00381071
003820     10  PC-TSYMSG-02528                PIC  9(05)  VALUE 02528.  00382071
003830     10  PC-TSYMSG-02529                PIC  9(05)  VALUE 02529.  00383071
003840     10  PC-TSYMSG-02538                PIC  9(05)  VALUE 02538.  00384071
003850     10  PC-TSYMSG-02540                PIC  9(05)  VALUE 02540.  00385071
003860     10  PC-TSYMSG-02545                PIC  9(05)  VALUE 02545.  00386071
003870     10  PC-TSYMSG-02890                PIC  9(05)  VALUE 02890.  00387071
003880     10  PC-TSYMSG-02945                PIC  9(05)  VALUE 02945.  00388071
003890     10  PC-TSYMSG-02972                PIC  9(05)  VALUE 02972.  00389071
003900     10  PC-TSYMSG-02973                PIC  9(05)  VALUE 02973.  00390071
003910     10  PC-TSYMSG-02994                PIC  9(05)  VALUE 02994.  00391071
003920     10  PC-TSYMSG-03043                PIC  9(05)  VALUE 03043.  00392071
003930     10  PC-TSYMSG-03190                PIC  9(05)  VALUE 03190.  00393071
003940     10  PC-TSYMSG-03191                PIC  9(05)  VALUE 03191.  00394071
003950     10  PC-TSYMSG-03253                PIC  9(05)  VALUE 03253.  00395071
003960     10  PC-TSYMSG-03342                PIC  9(05)  VALUE 03342.  00396071
003970     10  PC-TSYMSG-03350                PIC  9(05)  VALUE 03350.  00397071
003980     10  PC-TSYMSG-03356                PIC  9(05)  VALUE 03356.  00398071
003990     10  PC-TSYMSG-03392                PIC  9(05)  VALUE 03392.  00399071
004000     10  PC-TSYMSG-03398                PIC  9(05)  VALUE 03398.  00400071
004010     10  PC-TSYMSG-03402                PIC  9(05)  VALUE 03402.  00401071
004020     10  PC-TSYMSG-03404                PIC  9(05)  VALUE 03404.  00402071
004030     10  PC-TSYMSG-03409                PIC  9(05)  VALUE 03409.  00403071
004040     10  PC-TSYMSG-03410                PIC  9(05)  VALUE 03410.  00404071
004050     10  PC-TSYMSG-03554                PIC  9(05)  VALUE 03554.  00405071
004060     10  PC-TSYMSG-03598                PIC  9(05)  VALUE 03598.  00406071
004070     10  PC-TSYMSG-99901                PIC  9(05)  VALUE 99901.  00407071
004080     10  PC-TSYMSG-99910                PIC  9(05)  VALUE 99910.  00408071
004090                                                                  00409071
004100                                                                  00410071
004110*----------------------------------------------------------------*00411071
004120 01  PS-PROGRAM-SWITCHES.                                         00412071
004130     05  PS-ERROR-SW                    PIC  X(01)  VALUE  'N'.   00413071
004140         88  PS-NO-ERROR                            VALUE  'N'.   00414071
004150         88  PS-ERROR                               VALUE  'Y'.   00415071
004160     05  PS-BLOCK-ERROR-SW              PIC  X(01)  VALUE  'N'.   00416071
004170         88  PS-NO-BLOCK-ERROR                      VALUE  'N'.   00417071
004180         88  PS-BLOCK-ERROR                         VALUE  'Y'.   00418071
004190     05  PS-LIST-END-SW                 PIC  X(01)  VALUE  'N'.   00419071
004200         88  PS-LIST-END                            VALUE  'Y'.   00420071
004210         88  PS-NO-LIST-END                         VALUE  'N'.   00421071
004220     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE  'N'.   00422071
004230         88  PS-COMMAREA-VALID                      VALUE  'Y'.   00423071
004240         88  PS-COMMAREA-NOT-VALID                  VALUE  'N'.   00424071
004250     05  PS-DELETE-SW                   PIC  X(01)  VALUE  'N'.   00425071
004260         88  PS-DELETE-ALLOWED                      VALUE  'Y'.   00426071
004270         88  PS-DELETE-NOT-ALLOWED                  VALUE  'N'.   00427071
004280     05  PS-INGR-UCC128-SW              PIC  X(01)  VALUE  'N'.   00428071
004290         88  PS-INGR-UCC128-ALLOWED                 VALUE  'Y'.   00429071
004300         88  PS-INGR-UCC128-NOT-ALLOWED             VALUE  'N'.   00430071
004310     05  PS-IGNORE-UCC128-SW            PIC  X(01)  VALUE  'N'.   00431071
004320         88  PS-IGNORE-UCC128-ALLOWED               VALUE  'Y'.   00432071
004330         88  PS-IGNORE-UCC128-NOT-ALLOW             VALUE  'N'.   00433071
004340     05  PS-LINE-USING-UCC128-SW        PIC  X(01)  VALUE  'Y'.   00434071
004350         88  PS-LINE-USING-UCC128                   VALUE  'Y'.   00435071
004360         88  PS-LINE-NOT-USING-UCC128               VALUE  'N'.   00436071
004370     05  PS-EOF-LBL-XREF-CSR-SW         PIC  X(01)  VALUE  'N'.   00437071
004380         88  PS-EOF-LBL-XREF-CSR                    VALUE  'Y'.   00438071
004390         88  PS-NOT-EOF-LBL-XREF-CSR                VALUE  'N'.   00439071
004400     05  PS-EOF-DC-RTV-CURSOR-SW        PIC  X(01)  VALUE  'N'.   00440071
004410         88  PS-EOF-DC-RTV-CURSOR                   VALUE  'Y'.   00441071
004420         88  PS-NOT-EOF-DC-RTV-CURSOR               VALUE  'N'.   00442071
004430     05  PS-EOF-TRECDIS-CURSOR-SW       PIC  X(01)  VALUE  'N'.   00443071
004440         88  PS-EOF-TRECDIS-CURSOR                  VALUE  'Y'.   00444071
004450         88  PS-NOT-EOF-TRECDIS-CURSOR              VALUE  'N'.   00445071
004460     05  PS-EOF-UPDATE-CARTN-CSR-SW     PIC  X(01)  VALUE  'N'.   00446071
004470         88  PS-EOF-UPDATE-CARTN-CSR                VALUE  'Y'.   00447071
004480         88  PS-NOT-EOF-UPDATE-CARTN-CSR            VALUE  'N'.   00448071
004490     05  PS-EOF-P2L-RESEND-CSR-SW       PIC  X(01)  VALUE  'N'.   00449071
004500         88  PS-EOF-P2L-RESEND-CSR                  VALUE  'Y'.   00450071
004510         88  PS-NOT-P2L-RESEND-CSR                  VALUE  'N'.   00451071
004520     05  PS-DISTHD-RECORD-FOUND-SW      PIC  X(01)  VALUE  'N'.   00452071
004530         88  PS-DISTHD-RECORD-FOUND                 VALUE  'Y'.   00453071
004540         88  PS-NOT-DISTHD-RECORD-FOUND             VALUE  'N'.   00454071
004550     05  PS-PRINTER-ERROR-SW            PIC  X(01)  VALUE  'N'.   00455071
004560         88  PS-PRINTER-ERROR                       VALUE  'Y'.   00456071
004570     05  PS-SOCKET-INITIALIZED-SW       PIC  X(01)  VALUE  'N'.   00457071
004580         88  PS-SOCKET-INITIALIZED-YES              VALUE  'Y'.   00458071
004590         88  PS-SOCKET-INITIALIZED-NO               VALUE  'N'.   00459071
004600     05  PS-INV-STORE-LOADED-SW          PIC  X(01)  VALUE ' '.   00460071
004610         88  PS-INV-STORES-LOADED                    VALUE 'L'.   00461071
004620     05  PS-VALID-STORE-SW               PIC  X(01)  VALUE ' '.   00462071
004630         88  PS-VALID-STORE                          VALUE 'V'.   00463071
004640         88  PS-INVALID-STORE                        VALUE 'I'.   00464071
004650         88  PS-CHECK-STORE                          VALUE ' '.   00465071
004660     05  PS-EOF-RECDIS-STR-CURSR-YSW    PIC  X(01)  VALUE  'N'.   00466071
004670         88  PS-EOF-RECDIS-STR-CURSR-YES            VALUE  'Y'.   00467071
004680         88  PS-EOF-RECDIS-STR-CURSR-NO             VALUE  'N'.   00468071
004690     05  PS-CENTRAL-STOCK-SW            PIC  X(01)  VALUE  'N'.   00469071
004700         88  PS-CENTRAL-STOCK-YES                   VALUE  'Y'.   00470071
004710         88  PS-CENTRAL-STOCK-NO                    VALUE  'N'.   00471071
004720     05  PS-LABEL-SELECTION-SW          PIC  X(01)  VALUE  ' '.   00472071
004730         88  PS-LABEL-SELECTION-P2L                 VALUE  'P'.   00473071
004740         88  PS-LABEL-SELECTION-SML                 VALUE  'C'.   00474071
004750         88  PS-LABEL-SELECTION-BOTH                VALUE  'B'.   00475071
004760     05  PS-FREIGHT-BILL-SW             PIC  X(01)  VALUE 'N'.    00476071
004770         88  PS-FREIGHT-BILL-FOUND                  VALUE 'Y'.    00477071
004780         88  PS-NO-FREIGHT-BILL                     VALUE 'N'.    00478071
004790     05  PS-VERIFY-MODULE-SW            PIC X(01)   VALUE 'N'.    00479071
004800         88  PS-DONT-SUBMIT-E200                    VALUE 'N'.    00480071
004810         88  PS-DO-SUBMIT-E200                      VALUE 'Y'.    00481071
004820     05  PS-DELETE-SW                   PIC X(01)   VALUE 'N'.    00482071
004830         88  PS-DONT-DELETE                         VALUE 'N'.    00483071
004840         88  PS-DO-DELETE                           VALUE 'Y'.    00484071
004850     05  PS-EOF-RECDIS-CURSOR-SW        PIC  X(01)  VALUE  'N'.   00485071
004860         88  PS-EOF-RECDIS-CURSOR-YES               VALUE  'Y'.   00486071
004870         88  PS-EOF-RECDIS-CURSOR-NO                VALUE  'N'.   00487071
004880     05  PS-LINE-DOWNLOAD-SW            PIC  X(01)  VALUE  'N'.   00488071
004890         88  PS-LINE-PREV-DOWNLOAD                  VALUE  'Y'.   00489071
004900         88  PS-LINE-NOT-PREV-DOWNLOAD              VALUE  'N'.   00490071
004910     05  PS-LINE-SELECTION-SW           PIC  X(01)  VALUE  'N'.   00491071
004920         88  PS-LINE-SELECTED                       VALUE  'Y'.   00492071
004930         88  PS-LINE-NOT-SELECTED                   VALUE  'N'.   00493071
004940     05  PS-DC-RTV-STORE-ALLOCATION-SW  PIC  X(01)  VALUE  'N'.   00494071
004950         88  PS-DC-RTV-STORE-ALLOCATION             VALUE  'Y'.   00495071
004960         88  PS-DC-RTV-NOT-STORE-ALLOCATION         VALUE  'N'.   00496071
004970     05  PS-EDIT-PASS-SW                PIC  X(01)  VALUE  '0'.   00497071
004980         88  PS-ANY-EDIT                            VALUE  '0'.   00498071
004990         88  PS-INITIAL-EDIT                        VALUE  '1'.   00499071
005000         88  PS-EDIT-BEFORE-MOVE                    VALUE  '2'.   00500071
005010     05  PS-DC-RTV-DISTRO-ERROR-SW      PIC  X(01)  VALUE  'N'.   00501071
005020         88  PS-DC-RTV-DISTRO-ERROR                 VALUE  'Y'.   00502071
005030         88  PS-DC-RTV-DISTRO-ERROR-NO              VALUE  'N'.   00503071
005040     05  PS-SOFT-ABORT-ERROR-SW         PIC  X(01)  VALUE  'N'.   00504071
005050         88  PS-SOFT-ABORT-ERROR                    VALUE  'Y'.   00505071
005060         88  PS-NO-SOFT-ABORT-ERROR                 VALUE  'N'.   00506071
005070     05  PS-OUTER-PK-DEST-SW            PIC  X(01)  VALUE  ' '.   00507071
005080         88  PS-OUTER-PK-FROM-SKU                   VALUE  'S'.   00508071
005090         88  PS-OUTER-PK-FROM-CRIT                  VALUE  'C'.   00509071
005100     05  PS-INSERT-UPDATE-SW            PIC  X(01)  VALUE  ' '.   00510071
005110         88  PS-DISTHD-INSERT                       VALUE  'I'.   00511071
005120         88  PS-DISTHD-UPDATE                       VALUE  'U'.   00512071
005130     05  PS-LINE-PROCESSED-SW           PIC  X(01)  VALUE  'N'.   00513071
005140         88  PS-LINE-PROCESSED-AS-SPLIT             VALUE  'Y'.   00514071
005150         88  PS-LINE-NOT-PROCESSED-SPLIT            VALUE  'N'.   00515071
005160     05  PS-EOF-ODD-FCSE-CSR-SW         PIC  X(01)  VALUE  'N'.   00516071
005170         88  PS-EOF-ODD-FCSE-CSR                    VALUE  'Y'.   00517071
005180         88  PS-NOT-EOF-ODD-FCSE-CSR                VALUE  'N'.   00518071
005190     05  PS-ODD-CARTON-USE-SW           PIC  X(01)  VALUE  'N'.   00519071
005200         88  PS-USE-ODD-CARTON-FCSE                 VALUE  'F'.   00520071
005210         88  PS-USE-ODD-CARTON-INPK                 VALUE  'I'.   00521071
005220         88  PS-USE-ODD-CARTON-NONE                 VALUE  'N'.   00522071
005230     05  PS-ODD-CARTON-INPK-USED-SW     PIC  X(01)  VALUE  'N'.   00523071
005240         88  PS-ODD-CARTON-INPK-NOT-USED            VALUE  'N'.   00524071
005250         88  PS-ODD-CARTON-INPK-COMPLETE            VALUE  'Y'.   00525071
005260     05  PS-FULLCASES-USED-SW           PIC  X(01)  VALUE  'N'.   00526071
005270         88  PS-FULLCASES-ALL-NOT-USED              VALUE  'N'.   00527071
005280         88  PS-FULLCASES-ALL-USED                  VALUE  'Y'.   00528071
005290     05  PS-NEW-PRE-PK-ID-SW            PIC  X(01)  VALUE  'N'.   00529071
005300         88  PS-NOT-NEW-PRE-PK-ID                   VALUE  'N'.   00530071
005310         88  PS-NEW-PRE-PK-ID                       VALUE  'Y'.   00531071
005320     05  PS-PREPK-LINES-LEFT-SW         PIC  X(01)  VALUE  'N'.   00532071
005330         88  PS-PREPK-LINES-LEFT                    VALUE  'N'.   00533071
005340         88  PS-NO-PREPK-LINES-LEFT                 VALUE  'Y'.   00534071
005350     05  PS-OTHER-PREPK-LINES-SW        PIC  X(01)  VALUE  'N'.   00535071
005360         88  PS-NOT-OTHER-PREPK-LINES               VALUE  'N'.   00536071
005370         88  PS-OTHER-PREPK-LINES                   VALUE  'Y'.   00537071
005380     05  PS-RATIO-ALLOCATION-ERRO-SW    PIC  X(01)  VALUE  'N'.   00538071
005390         88  PS-NOT-RATIO-ALLOC-ERROR               VALUE  'N'.   00539071
005400         88  PS-RATIO-ALLOCATION-ERROR              VALUE  'Y'.   00540071
005410     05  PS-UCC128-CRTN-MLT-LNE-SW      PIC  X(01)  VALUE  'N'.   00541071
005420         88  PS-UCC128-CRTN-MLT-LNE-NO              VALUE  'N'.   00542071
005430         88  PS-UCC128-CRTN-MLT-LNE                 VALUE  'Y'.   00543071
005440     05  PS-DISTDT-VALID-INSERT-SW      PIC  X(01)  VALUE  'N'.   00544071
005450         88  PS-DISTDT-INVALID-INSERT               VALUE  'N'.   00545071
005460         88  PS-DISTDT-VALID-INSERT                 VALUE  'Y'.   00546071
005470     05  PS-SOCKET-SW                    PIC  X(01)  VALUE 'N'.   00547071
005480         88  PS-SOCKET-OPEN                          VALUE 'Y'.   00548071
005490         88  PS-SOCKET-CLOSED                        VALUE 'N'.   00549071
005500     05  PS-P2L-FUNCTION-SW              PIC  X(01)  VALUE ' '.   00550071
005510         88  PS-P2L-HEADER                           VALUE 'A'.   00551071
005520         88  PS-P2L-DISTRO-DETAIL                    VALUE 'B'.   00552071
005530         88  PS-P2L-DISTRO-TRAILER                   VALUE 'C'.   00553071
005540         88  PS-P2L-CARTON-DETAIL                    VALUE 'D'.   00554071
005550         88  PS-P2L-CARTON-TRAILER                   VALUE 'E'.   00555071
005560         88  PS-P2L-DISTRO-DELETE                    VALUE 'F'.   00556071
005570     05  PS-DISPLAY-CSSL-SW              PIC  X(01)  VALUE 'N'.   00557071
005580         88  PS-DISPLAY-CSSL-YES                     VALUE 'Y'.   00558071
005590         88  PS-DISPLAY-CSSL-NO                      VALUE 'N'.   00559071
005600     05  PS-ITEMS-LEFT-INDICATOR         PIC  X(01).              00560071
005610         88  PS-ITEMS-LEFT-ON-DB                     VALUE 'Y'.   00561071
005620         88  PS-NO-ITEMS-LEFT-ON-DB                  VALUE 'N'.   00562071
005630     05  PS-MANIFEST-DC-FOUND-SW      PIC  X(01)  VALUE 'N'.      00563071
005640         88  PS-MANIFEST-DC-FOUND                 VALUE 'Y'.      00564071
005650         88  PS-MANIFEST-DC-NOT-FND               VALUE 'N'.      00565071
005660     05  PS-BLND-RECV-SIMPL-LOC-SW    PIC  X(01)  VALUE 'N'.      00566071
005670         88  PS-BLND-RECV-SIMPL-LOC-FND           VALUE 'Y'.      00567071
005680         88  PS-BLND-RECV-SIMPL-LOC-NOT-FND       VALUE 'N'.      00568071
005690     05  PS-CS-ECOMMERCE-LINE-SW      PIC  X(01)  VALUE 'N'.      00569071
005700         88  PS-CS-ECOMMERCE-LINE-YES             VALUE 'Y'.      00570071
005710         88  PS-CS-ECOMMERCE-LINE-NO              VALUE 'N'.      00571071
005720     05  PS-RCLM-LBL-DC-FOUND-SW      PIC  X(01)  VALUE 'N'.      00572071
005730         88  PS-RCLM-LBL-DC-FOUND                 VALUE 'Y'.      00573071
005740         88  PS-RCLM-LBL-DC-NOT-FND               VALUE 'N'.      00574071
005750     05  PS-AUTO-STRT-WRK-ORDER-SW    PIC  X(01)  VALUE 'N'.      00575071
005760         88  PS-AUTO-STRT-WRK-ORDER               VALUE 'Y'.      00576071
005770         88  PS-AUTO-STRT-WRK-ORDER-NO            VALUE 'N'.      00577071
005780     05  PS-EOF-MOD-CURSOR-INT        PIC  X(01)  VALUE  'N'.     00578071
005790         88  PS-EOF-MOD-CURSOR                    VALUE  'Y'.     00579071
005800         88  PS-NOT-EOF-MOD-CURSOR                VALUE  'N'.     00580071
005810     05  PS-CRITERIA-CHANGE-SW        PIC  X(01)  VALUE  'N'.     00581071
005820         88  PS-CRITERIA-CHANGE                   VALUE  'Y'.     00582071
005830         88  PS-NO-CRITERIA-CHANGE                VALUE  'N'.     00583071
005840     05  PS-REFRESH-DONE-SW           PIC  X(01)  VALUE  'N'.     00584071
005850         88  PS-REFRESH-DONE                      VALUE  'Y'.     00585071
005860         88  PS-REFRESH-NOT-DONE                  VALUE  'N'.     00586071
005870                                                                  00587071
005880     05  PS-DC-ON-WMOS-SW             PIC  X(01)  VALUE 'N'.      00588071
005890         88  PS-DC-ON-WMOS-YES                    VALUE 'Y'.      00589071
005900         88  PS-DC-ON-WMOS-NO                     VALUE 'N'.      00590071
005910                                                                  00591071
005920     05  PS-LABOR-NEXT-SEQ-SW         PIC  X(01)  VALUE  'N'.     00592071
005930         88  PS-LABOR-NEXT-SEQ-YES                VALUE  'Y'.     00593071
005940         88  PS-LABOR-NEXT-SEQ-NO                 VALUE  'N'.     00594071
005950     05  PS-LABOR-LOGGING-LEVEL-SW    PIC  X(01)  VALUE  ' '.     00595071
005951         88  PS-LABOR-LOG-HEADER                  VALUE  'H'.     00595171
005952         88  PS-LABOR-LOG-PHY-LBL                 VALUE  'P'.     00595271
005953     05  PS-LABOR-HAVE-DUMMY-TK-SW    PIC  X(01)  VALUE  'N'.     00595371
005954         88  PS-LABOR-HAVE-DUMMY-TK-YES           VALUE  'Y'.     00595471
005955         88  PS-LABOR-HAVE-DUMMY-TK-NO            VALUE  'N'.     00595571
005956     05  PS-LABOR-USE-DUMMY-ASGMT-SW  PIC  X(01)  VALUE  'N'.     00595671
005957         88  PS-LABOR-USE-DUMMY-ASGMT-YES         VALUE  'Y'.     00595771
005958         88  PS-LABOR-USE-DUMMY-ASGMT-NO          VALUE  'N'.     00595871
005959     05  PS-LABOR-PHY-LBL-SML-SW      pic  X(01)  VALUE  'N'.     00595971
005960         88  PS-LABOR-PHY-LBL-SML-YES             VALUE  'Y'.     00596071
005970         88  PS-LABOR-PHY-LBL-SML-NO              VALUE  'N'.     00597071
005980     05  PS-LABOR-PHY-LBL-P2L-SW      pic  X(01)  VALUE  'N'.     00598071
005990         88  PS-LABOR-PHY-LBL-P2L-YES             VALUE  'Y'.     00599071
006000         88  PS-LABOR-PHY-LBL-P2L-NO              VALUE  'N'.     00600071
006010                                                                  00601071
006020     05  PS-DUMMY-TRIP-SW             PIC  X(01)  VALUE  'N'.     00602071
006030         88  PS-DUMMY-TRIP-YES                    VALUE  'Y'.     00603071
006040         88  PS-DUMMY-TRIP-NO                     VALUE  'N'.     00604071
006050     05  PS-TRAILER-ARRIVED-SW        PIC  X(01)  VALUE  'N'.     00605071
006060         88  PS-TRAILER-ARRIVED-YES               VALUE  'Y'.     00606071
006070         88  PS-TRAILER-ARRIVED-NO                VALUE  'N'.     00607071
006080     05  PS-CHECK-FOR-MULT-ASGMT-SW   PIC  X(01)  VALUE  'N'.     00608071
006090         88  PS-CHECK-FOR-MULT-ASGMT              VALUE  'Y'.     00609071
006100         88  PS-CHECK-FOR-MULT-ASGMT-NO           VALUE  'N'.     00610071
006110     05  PS-DC-RFID-SW                   PIC  X(01)  VALUE 'N'.   00611071
006120         88  PS-DC-RFID-YES                          VALUE 'Y'.   00612071
006130         88  PS-DC-RFID-NO                           VALUE 'N'.   00613071
006140     05  PS-RFID-DRTVE-CREATE-SW         PIC  X(01)  VALUE 'N'.   00614071
006150         88  ps-RFID-DRTVE-CREATE                    VALUE 'Y'.   00615071
006160         88  PS-RFID-DRTVE-DELETE                    VALUE 'N'.   00616071
006161     05  PS-INPK-CNVY-1-VALID-SW         PIC  X(01)  VALUE 'N'.   00616171
006162         88  PS-INPK-CNVY-1-VALID                    VALUE 'Y'.   00616271
006163         88  PS-INPK-CNVY-1-NOT-VALID                VALUE 'N'.   00616371
006164                                                                  00616471
006165                                                                  00616571
006166*----------------------------------------------------------------*00616671
006167 01  PV-PROGRAM-VARIABLES.                                        00616771
006168                                                                  00616871
006169     05  PV-PPCBEF-QTY           PIC  S9(9)   COMP.               00616971
006170     05  PV-PPCAFT-QTY           PIC  S9(9)   COMP.               00617071
006180     05  PV-ZERO-SUP-VAR         PIC  Z(09)   VALUE ZEROES.       00618071
006190     05  PV-FCSE-AREA-ID         PIC  X(06)   VALUE SPACE.        00619071
006200     05  PV-SOCKET-ONE           PIC  9(04)   VALUE 1 BINARY.     00620071
006210     05  PV-SOCKET-TWO           PIC  9(04)   VALUE 2 BINARY.     00621071
006220     05  PV-SOCKET-RETCODE       PIC S9(08)   VALUE +0.           00622071
006230     05  PV-SOCKET-ERRNO         PIC  9(08)   VALUE ZEROES.       00623071
006240                                                                  00624071
006250     05  PV-DSPLY-OPER           PIC  9(04)   VALUE ZEROES.       00625071
006260     05  PV-DSPLY-PO             PIC  9(09)   VALUE ZEROES.       00626071
006270     05  PV-DSPLY-RCVR           PIC  9(04)   VALUE ZEROES.       00627071
006280     05  PV-DSPLY-LNE            PIC  9(04)   VALUE ZEROES.       00628071
006290     05  PV-DSPLY-PACK           PIC  9(04)   VALUE ZEROES.       00629071
006300     05  PV-DSPLY-SKU            PIC  9(08)   VALUE ZEROES.       00630071
006310     05  PV-USER-ID              PIC  X(08)   VALUE SPACES.       00631071
006320     05  PV-ZERO-SUP-OTPK        PIC  Z(04)   VALUE ZEROES.       00632071
006330                                                                  00633071
006340     05  PV-BAR-CODE                     PIC  X(22) VALUE ZEROES. 00634071
006350     05  PV-BAR-CODE-N  REDEFINES  PV-BAR-CODE.                   00635071
006360         10 FILLER                       PIC  9(02).              00636071
006370         10 PV-BAR-CODE-OTBND            PIC  9(18).              00637071
006380         10 FILLER                       PIC  9(02).              00638071
006390                                                                  00639071
006400                                                                  00640071
006410     05  PV-SYSTEM-ID.                                            00641071
006420         10  FILLER              PIC  X(04)  VALUE SPACE.         00642071
006430         10  PV-REGION-IND       PIC  X(01).                      00643071
006440             88  PV-TEST-CICS                VALUE 'T'.           00644071
006450             88  PV-QA-CICS                  VALUE 'Q'.           00645071
006460             88  PV-PROD-CICS                VALUE 'P'.           00646071
006470             88  PV-LEARN-CICS               VALUE 'L'.           00647071
006480         10  FILLER              PIC  X(03)  VALUE SPACES.        00648071
006490                                                                  00649071
006500     05  PV-CONFIRM-TIMESTAMP      PIC X(26)   VALUE SPACES.      00650071
006510                                                                  00651071
006520     05  PV-NULL-IND                    PIC S9(04)  VALUE ZEROS   00652071
006530                                                    COMP SYNC.    00653071
006540     05  PV-NULL-IND-2                  PIC S9(04)  VALUE ZEROS   00654071
006550                                                    COMP SYNC.    00655071
006560     05  PV-NULL-IND-3                  PIC S9(04)  VALUE ZEROS   00656071
006570                                                    COMP SYNC.    00657071
006580     05  PV-DB2-TROUBLE-COUNT           PIC S9(09)  VALUE ZEROS   00658071
006590                                                    COMP-3.       00659071
006600     05  PV-UCC128-COUNT                PIC S9(09)  COMP.         00660071
006610                                                                  00661071
006620     05  PV-DB2-FREIGHT-COUNT           PIC S9(09)  VALUE ZEROS   00662071
006630                                                    COMP-3.       00663071
006640     05  PV-TROUBLE-COUNT               PIC S9(09)  COMP.         00664071
006650     05  PV-PREPK-99-COUNT              PIC S9(09)  COMP.         00665071
006660     05  PV-CHECK-IN-COUNT              PIC S9(09)  COMP.         00666071
006670     05  PV-DC-P2L-MODULE-COUNT         PIC S9(09)  COMP.         00667071
006680     05  PV-RECDIS-COUNT                PIC S9(09)  COMP.         00668071
006690     05  PV-DB2-RDM-LOC-COUNT           PIC S9(09)  COMP.         00669071
006700     05  PV-DISTDT-ODD-CNT-FCSE         PIC S9(09)  COMP.         00670071
006710     05  PV-DISTDT-ODD-CNT-INPK         PIC S9(09)  COMP.         00671071
006720     05  PV-TROUBLE-DETAIL.                                       00672071
006730         10  PV-TROUBLE-DETAIL-1        PIC  X(50)  VALUE SPACE.  00673071
006740         10  PV-TROUBLE-DETAIL-2        PIC  X(50)  VALUE SPACE.  00674071
006750         10  PV-TROUBLE-DETAIL-3        PIC  X(50)  VALUE SPACE.  00675071
006760         10  PV-TROUBLE-DETAIL-4        PIC  X(50)  VALUE SPACE.  00676071
006770         10  PV-TROUBLE-DETAIL-5        PIC  X(50)  VALUE SPACE.  00677071
006780     05  PV-DEPT-NUMBER                 PIC  X(03).               00678071
006790     05  PV-ENT-ID                      PIC S9(09)  COMP.         00679071
006800     05  PV-INHOUSE-VNDR-NBR            PIC  S9(3)V COMP-3.       00680071
006810     05  PV-DISPLAY-STORE-ZONE.                                   00681071
006820         10  FILLER                     PIC  X(01)  VALUE '('.    00682071
006830         10  PV-DFLT-STR-ZN-ID          PIC  X(05).               00683071
006840         10  FILLER                     PIC  X(01)  VALUE ')'.    00684071
006850     05  PV-PROCESS-QTY                 PIC  9(05)  VALUE ZEROES. 00685071
006860     05  PV-TRANSCRIBE-SUM              PIC S9(09)  COMP.         00686071
006870     05  PV-VERIFIED-SUM                PIC S9(09)  COMP.         00687071
006880     05  PV-LINE-STATUS                 PIC  X(06).               00688071
006890     05  PV-TYPE-CODE                   PIC  X(02).               00689071
006900         88  PV-TYPE-CENTRAL-STOCK                  VALUE 'CS'.   00690071
006910     05  PV-DC-RTV-TYPE-CODE            PIC  X(02).               00691071
006920     05  PV-DC-RTV-EXPT-CNT             PIC S9(09)  COMP.         00692071
006930     05  PV-STR-COUNT                   PIC S9(09)  COMP.         00693071
006940     05  PV-DC-BOUND-EXPT-CNT           PIC S9(09)  COMP.         00694071
006950     05  PV-CS-BOUND-UNTS               PIC S9(09)  COMP.         00695071
006960     05  PV-CS-BOUND-CTNS               PIC S9(09)  COMP.         00696071
006970     05  PV-RTV-BOUND-EXPT-CNT          PIC S9(09)  COMP.         00697071
006980     05  PV-DC-RTV-ROWS-RETRIEVED       PIC S9(09)  VALUE ZEROES. 00698071
006990                                                                  00699071
007000     05  PV-DISPLAY-STORE-COUNT         PIC Z(03)9.               00700071
007010     05  PV-DISPLAY-ITM-QTY             PIC Z(03)9.               00701071
007020     05  PV-EXPTED-ITM-QTY              PIC S9(09)  COMP.         00702071
007030     05  PV-EXPTED-QTY-LESS-ODD         PIC S9(09)  COMP.         00703071
007040     05  PV-STR-NBR                     PIC S9(04)  COMP.         00704071
007050     05  PV-NBR-OF-STORES               PIC S9(09)  COMP.         00705071
007060     05  PV-QUOTIENT                    PIC S9(09)  COMP.         00706071
007070     05  PV-P2L-QUOTIENT                PIC S9(09)  COMP.         00707071
007080     05  PV-EXPT-REMAINDER              PIC S9(09)  COMP.         00708071
007090     05  PV-P2L-INPK-QUOTIENT           PIC S9(09)  COMP.         00709071
007100     05  PV-P2L-REMAINDER               PIC S9(09)  COMP.         00710071
007110     05  PV-INPK-QUOTIENT               PIC S9(09)  COMP.         00711071
007120     05  PV-INPK-REMAINDER              PIC S9(09)  COMP.         00712071
007130     05  PV-OTPK-QUOTIENT               PIC S9(09)  COMP.         00713071
007140     05  PV-OTPK-REMAINDER              PIC S9(09)  COMP.         00714071
007150     05  PV-FCSE-INPK-REMAINDER         PIC S9(09)  COMP.         00715071
007160     05  PV-CARTON-COUNT-LESS-ODD       PIC  9(04)  COMP.         00716071
007170     05  PV-FULL-CASE-SHIP-TOTAL        PIC S9(09)  COMP.         00717071
007180     05  PV-FULLCASE-SPLIT-UNITS        PIC S9(09)  COMP.         00718071
007190     05  PV-ALLOC-AFTER-ODD-CARTON      PIC S9(09)  COMP.         00719071
007200     05  PV-INPK-SHIP-LNE-TOTAL         PIC S9(09)  COMP.         00720071
007210     05  PV-SHIP-LNE-TOTAL              PIC S9(09)  COMP.         00721071
007220     05  PV-P2L-LNE-TOTAL               PIC S9(09)  COMP          00722071
007230                                        VALUE ZEROES.             00723071
007240     05  PV-CARTON-CNT-LESS-ODD         PIC S9(09)  COMP.         00724071
007250     05  PV-ODD-FULLCASE                PIC S9(09)  COMP.         00725071
007260     05  PV-ODD-REMAINDER               PIC S9(09)  COMP.         00726071
007270     05  PV-TOT-REMAINDER               PIC S9(09)  COMP.         00727071
007280     05  PV-SHIP-LNE-CNT                PIC S9(09)  COMP.         00728071
007290     05  PV-P2L-LNE-CNT                 PIC S9(09)  COMP.         00729071
007300     05  PV-OUT-ANSWER                  PIC S9(09)  COMP.         00730071
007310     05  PV-OUT-REMAINDER               PIC S9(09)  COMP.         00731071
007320     05  PV-ANSWER                      PIC S9(09)  COMP.         00732071
007330                                                                  00733071
007340     05  PV-STR-P2L-UNT-QTY             PIC S9(09)  COMP.         00734071
007350     05  PV-STR-FCSE-UNT-QTY            PIC S9(09)  COMP.         00735071
007360     05  PV-STR-INPK-UNT-QTY            PIC S9(09)  COMP.         00736071
007370     05  PV-STR-ACTL-UNT-QTY            PIC S9(09)  COMP.         00737071
007380     05  PV-FCSE-INPK-COMBINED          PIC S9(04)  COMP.         00738071
007390                                                                  00739071
007400     05  PV-P2L-UNITS                   PIC S9(09)  VALUE ZEROES. 00740071
007410                                                                  00741071
007420     05  PV-SUB                         PIC S9(04)  VALUE +0      00742071
007430                                                    COMP SYNC.    00743071
007440     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      00744071
007450                                                    COMP SYNC.    00745071
007460     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      00746071
007470                                                    COMP-3.       00747071
007480     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      00748071
007490                                                    COMP-3.       00749071
007500     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      00750071
007510                                                    COMP-3.       00751071
007520     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      00752071
007530                                                    COMP-3.       00753071
007540     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      00754071
007550                                                    COMP-3.       00755071
007560     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      00756071
007570                                                    COMP-3.       00757071
007580     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      00758071
007590                                                    COMP SYNC.    00759071
007600     05  PV-ORIGINAL-BLOCK              PIC S9(04)  VALUE +0      00760071
007610                                                    COMP SYNC.    00761071
007620     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      00762071
007630                                                    COMP SYNC.    00763071
007640     05  PV-CICS-RESP-DISPLAY           PIC S9(04)  VALUE +0.     00764071
007650     05  PV-ITEM                        PIC S9(04)  VALUE +0      00765071
007660                                                    COMP SYNC.    00766071
007670     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      00767071
007680                                                    COMP SYNC.    00768071
007690     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      00769071
007700                                                    COMP SYNC.    00770071
007710     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      00771071
007720                                                    COMP SYNC.    00772071
007730     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      00773071
007740                                                    COMP SYNC.    00774071
007750     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      00775071
007760                                                    COMP SYNC.    00776071
007770     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      00777071
007780                                                    COMP SYNC.    00778071
007790     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      00779071
007800                                                    COMP SYNC.    00780071
007810     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      00781071
007820                                                    COMP SYNC.    00782071
007830     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      00783071
007840                                                    COMP SYNC.    00784071
007850     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      00785071
007860                                                    COMP SYNC.    00786071
007870     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      00787071
007880                                                    COMP SYNC.    00788071
007890     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      00789071
007900                                                    COMP SYNC.    00790071
007910                                                                  00791071
007920     05  PV-IN-OUT-PK-RESULT            PIC S9(04) VALUE ZEROES.  00792071
007930     05  PV-IN-OUT-REMAINDER            PIC S9(04) VALUE ZEROES.  00793071
007940     05  PV-ODD-IN-PK-RESULT            PIC S9(04) VALUE ZEROES.  00794071
007950     05  PV-ODD-IN-REMAINDER            PIC S9(04) VALUE ZEROES.  00795071
007960     05  PV-OPER-UNT-ID-HOLD            PIC S9(04) COMP.          00796071
007970     05  PV-MODU-NBR-HOLD               PIC S9(04) COMP.          00797071
007980     05  PV-SHIPT-UNT-ID                PIC S9(18).               00798071
007990                                                                  00799071
008000     05  PV-IP-ADDRESS.                                           00800071
008010         10  PV-IP-ADDR-NUM1             PIC 9(03).               00801071
008020             88  PV-IP-ADDR-NUM1-VALID              VALUE 1 THRU  00802071
008030                                                          255.    00803071
008040         10  PV-IP-ADDR-DOT1             PIC X(01).               00804071
008050             88  PV-IP-ADDR-DOT1-VALID              VALUE '.'.    00805071
008060         10  PV-IP-ADDR-NUM2             PIC 9(03).               00806071
008070             88  PV-IP-ADDR-NUM2-VALID              VALUE 1 THRU  00807071
008080                                                          255.    00808071
008090         10  PV-IP-ADDR-DOT2             PIC X(01).               00809071
008100             88  PV-IP-ADDR-DOT2-VALID              VALUE '.'.    00810071
008110         10  PV-IP-ADDR-NUM3             PIC 9(03).               00811071
008120             88  PV-IP-ADDR-NUM3-VALID              VALUE 1 THRU  00812071
008130                                                          255.    00813071
008140         10  PV-IP-ADDR-DOT3             PIC X(01).               00814071
008150             88  PV-IP-ADDR-DOT3-VALID              VALUE '.'.    00815071
008160         10  PV-IP-ADDR-NUM4             PIC 9(03).               00816071
008170             88  PV-IP-ADDR-NUM4-VALID              VALUE 1 THRU  00817071
008180                                                          255.    00818071
008190                                                                  00819071
008200     05  PV-HEX-FIELD.                                            00820071
008210         10  PV-HEX-FIELD-1              PIC X(01).               00821071
008220         10  PV-HEX-FIELD-2              PIC X(01).               00822071
008230         10  PV-HEX-FIELD-3              PIC X(01).               00823071
008240         10  PV-HEX-FIELD-4              PIC X(01).               00824071
008250     05  PV-HEX-FIELD-NUMBER REDEFINES PV-HEX-FIELD               00825071
008260                                         PIC 9(08)  COMP.         00826071
008270     05  PV-HEX-NUMERIC                  PIC 9(04) BINARY.        00827071
008280     05  PV-HEX-CHAR REDEFINES PV-HEX-NUMERIC.                    00828071
008290         10  PV-HEX-CHAR-1               PIC X(01).               00829071
008300         10  PV-HEX-CHAR-2               PIC X(01).               00830071
008310                                                                  00831071
008320     05  PV-PREVIOUS-MOD                 PIC  9(03)  VALUE ZEROES.00832071
008330     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACE. 00833071
008340     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 00834071
008350     05  PV-CICS-MSG-HOLD.                                        00835071
008360         10  FILLER                      PIC  X(01)  VALUE SPACE. 00836071
008370         10  PV-CICS-MSG-DATA            PIC  X(79)  VALUE SPACE. 00837071
008380     05  PV-CICS-MSG-HOLD2.                                       00838071
008390         10  FILLER                      PIC  X(01)  VALUE SPACE. 00839071
008400         10  PV-CICS-MSG-DATA2           PIC  X(99)  VALUE SPACE. 00840071
008410                                                                  00841071
008420     05  PV-CICS-MSG-HOLD3.                                       00842071
008430         10  FILLER                      PIC  X(01)  VALUE SPACE. 00843071
008440         10  FILLER                      PIC  X(11)  VALUE        00844071
008450                                         ' PO/RCVR - '.           00845071
008460         10  PV-HOLD3-PO                 PIC  Z(09).              00846071
008470         10  FILLER                      PIC  X(01)  VALUE '-'.   00847071
008480         10  PV-HOLD3-RCVR               PIC  9(04).              00848071
008490         10  FILLER                      PIC  X(11)  VALUE        00849071
008500                                         '    LINE - '.           00850071
008510         10  PV-HOLD3-LINE               PIC  Z(04).              00851071
008520         10  FILLER                      PIC  X(59)  VALUE SPACE. 00852071
008530                                                                  00853071
008540     05  PV-CICS-152-RECORD.                                      00854071
008550         10  PV-CICS-1-99                PIC  X(99)  VALUE SPACE. 00855071
008560         10  PV-CICS-100-152             PIC  X(99)  VALUE SPACE. 00856071
008570     05  PV-CALLING-PARAGRAPH            PIC  X(152) VALUE SPACE. 00857071
008580     05  PV-MESSAGE-AREA                 PIC  X(19)  VALUE SPACE. 00858071
008590     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     00859071
008600                                                     COMP SYNC.   00860071
008610     05  PV-P2L-CARTON-NBR               PIC  9(04).              00861071
008620                                                                  00862071
008630     05  PV-PO-NBR-X.                                             00863071
008640         10  PV-PO-NBR                   PIC  9(09).              00864071
008650     05  PV-PO-NBR-REDEF  REDEFINES PV-PO-NBR-X.                  00865071
008660         10  FILLER                      PIC  X(01).              00866071
008670         10  PV-PO-NBR-8                 PIC  X(08).              00867071
008680     05  PV-REC-SEQ-NBR-X.                                        00868071
008690         10  PV-REC-SEQ-NBR              PIC  9(09).              00869071
008700     05  PV-REC-SEQ-NBR-REDEF  REDEFINES PV-REC-SEQ-NBR-X.        00870071
008710         10  FILLER                      PIC  X(06).              00871071
008720         10  PV-REC-SEQ-NBR-3            PIC  X(03).              00872071
008730     05  PV-REC-SEQ-NBR-REDEF2 REDEFINES PV-REC-SEQ-NBR-X.        00873071
008740         10  FILLER                      PIC  X(07).              00874071
008750         10  PV-REC-SEQ-NBR-2            PIC  X(02).              00875071
008760     05  PV-PO-LINE-NBR-X.                                        00876071
008770         10  PV-PO-LINE-NBR              PIC  9(04).              00877071
008780     05  PV-PREPK-ID-8-POS               PIC  9(08)  VALUE ZEROES.00878071
008790     05  PV-SKU                          PIC  9(08)  VALUE ZEROES.00879071
008800     05  PV-MODULE-X.                                             00880071
008810         10  PV-MODULE                   PIC  9(03).              00881071
008820     05  PV-CARTON-COUNT-X.                                       00882071
008830         10  PV-CARTON-COUNT             PIC  9(04).              00883071
008840     05  PV-INNER-PACK-QTY-X.                                     00884071
008850         10  PV-INNER-PACK-QTY           PIC  9(04).              00885071
008860     05  PV-OUTER-PACK-QTY-X.                                     00886071
008870         10  PV-OUTER-PACK-QTY           PIC  9(04)               00887071
008880                                         VALUE ZEROES.            00888071
008890     05  PV-IN-PAK-CONVEY                PIC  X(01).              00889071
008900     05  PV-LBL-TYP                      PIC  X(01).              00890071
008910         88  PV-LBL-TYP-SML                  VALUE 'S'.           00891071
008920         88  PV-LBL-TYP-PGYBK                VALUE 'P'.           00892071
008930         88  PV-LBL-TYP-NO-PRINT             VALUE 'X'.           00893071
008940     05  PV-LNE-PROCESS-QTY-X.                                    00894071
008950         10  PV-LNE-PROCESS-QTY          PIC  9(05).              00895071
008960     05  PV-TRANSCRIBE-QTY-X.                                     00896071
008970         10  PV-TRANSCRIBE-QTY           PIC  9(05).              00897071
008980     05  PV-P2L-UNIT-CNT                 PIC  9(04) VALUE ZEROES. 00898071
008990     05  PV-P2L-UNITS-AFTER-ODD          PIC  9(04) VALUE ZEROES. 00899071
009000     05  PV-P2L-LABEL-CNT-X.                                      00900071
009010         10  PV-P2L-LABEL-CNT            PIC  9(04).              00901071
009020     05  PV-SML-LABEL-CNT-X.                                      00902071
009030         10  PV-SML-LABEL-CNT            PIC  9(04).              00903071
009040     05  PV-SML-FCSE-LBL-CNT-X.                                   00904071
009050         10  PV-SML-FCSE-LBL-CNT         PIC  9(04).              00905071
009060     05  PV-SML-INPK-LBL-CNT-X.                                   00906071
009070         10  PV-SML-INPK-LBL-CNT         PIC  9(04).              00907071
009080     05  PV-DISPLAY-STORE-CNT            PIC  Z(03)9.             00908071
009090     05  PV-DISPLAY-ITEM-QTY             PIC  Z(03)9.             00909071
009100     05  PV-EXPECTED-ITM-QTY             PIC  Z(03)9.             00910071
009110     05  PV-P2L-DIVERT-CDE               PIC  X(04).              00911071
009120     05  PV-VEND-STYL-NAME               PIC  X(15).              00912071
009130     05  PV-SKU-DESC                     PIC  X(19).              00913071
009140     05  PV-SIZE-DESC                    PIC  X(05).              00914071
009150     05  PV-COLOR-DESC                   PIC  X(04).              00915071
009160     05  PV-ITM-NBR                      PIC S9(15)  COMP-3.      00916071
009170     05  PV-LNE-CRE-LBL-OPT              PIC  X(01).              00917071
009180         88  PV-LNE-CRE-P2L-LBL                      VALUE 'P'.   00918071
009190         88  PV-LNE-CRE-BOTH-LBL                     VALUE 'B'.   00919071
009200         88  PV-LNE-CRE-SML-LBL                      VALUE 'C'.   00920071
009210     05  PV-CREATE-LABEL-OPTION    PIC  X(01)  VALUE SPACE.       00921071
009220         88 PV-VALID-LABEL-OPT                 VALUE 'B' 'P'      00922071
009230                                                     'C'.         00923071
009240         88 PV-CASEPACK-SHIP-ONLY              VALUE 'C'.         00924071
009250     05  PV-PRINT-ORDER            PIC  X(01)  VALUE SPACE.       00925071
009260         88 PV-VALID-PRINT-ORDER        VALUE 'R' 'S' 'D'.        00926071
009270     05  PV-UCC128-OPTION          PIC  X(01)  VALUE SPACE.       00927071
009280         88 PV-VALID-UCC128-OPTION             VALUE 'Y' 'N' 'I'. 00928071
009290     05  PV-LNE-FCSE-AREA                PIC  X(06).              00929071
009300     05  PV-UNIT-RETAIL                  PIC  9(06)V99.           00930071
009310     05  PV-STR-CNT                      PIC  9(03)  VALUE ZEROS. 00931071
009320     05  PV-STR-CNT-X  REDEFINES  PV-STR-CNT                      00932071
009330                                         PIC  X(03).              00933071
009340     05  PV-STR-RECS-SENT                PIC  9(03)  VALUE ZEROS. 00934071
009350     05  PV-DIST-ACTL-ALLOC-DUMMY-VALUE  PIC S9(09)  VALUE +0     00935071
009360                                                     COMP SYNC.   00936071
009370     05  PV-ERROR-ORD-NBR                PIC  9(08)  VALUE ZEROS. 00937071
009380     05  PV-ERROR-RCVR-SEQ-NBR           PIC  9(04)  VALUE ZEROS. 00938071
009390     05  PV-ERROR-ORD-LNE-NBR            PIC  9(04)  VALUE ZEROS. 00939071
009400                                                                  00940071
009410     05  PV-FULLCASE-CENTRAL-STK-X.                               00941071
009420         10  PV-FULLCASE-CENTRAL-STK     PIC  9(04).              00942071
009430     05  PV-FULLCASE-REMAINDER-X.                                 00943071
009440         10  PV-FULLCASE-REMAINDER       PIC  9(04).              00944071
009450     05  PV-FULLCASE-NOT-CENTRAL-STK-X.                           00945071
009460         10  PV-FULLCASE-NOT-CENTRAL-STK PIC  9(04).              00946071
009470     05  PV-INPK-NOT-CENTRAL-STK-X.                               00947071
009480         10  PV-INPK-NOT-CENTRAL-STK     PIC  9(04).              00948071
009490                                                                  00949071
009500     05  PV-TOTAL-FULLCASE-X.                                     00950071
009510         10  PV-TOTAL-FULLCASE           PIC  9(04).              00951071
009520     05  PV-TOTAL-P2L-X.                                          00952071
009530         10  PV-TOTAL-P2L                PIC  9(04).              00953071
009540     05  PV-TOTAL-INPK-X.                                         00954071
009550         10  PV-TOTAL-INPK               PIC  9(04).              00955071
009560                                                                  00956071
009570     05  PV-SHP-PRTR-CLUSTER-NBR         PIC S9(04)  VALUE ZERO.  00957071
009580     05  PV-SHP-PRTR-ID-ADDR             PIC  X(15)  VALUE SPACES.00958071
009590     05  PV-SHP-PRTR-OS-RLSE-CDE         PIC  X(15)  VALUE SPACES.00959071
009600     05  PV-SHP-DATA-XFER-MODE-ID        PIC  X(02)  VALUE SPACES.00960071
009610     05  PV-SHP-XMIT-INTFC-CDE           PIC  X(01)  VALUE SPACE. 00961071
009620     05  PV-SHP-PRTR-TYP-CDE             PIC  X(08)  VALUE SPACE. 00962071
009630     05  PV-PGYBK-PRTR-CLUSTER-NBR       PIC S9(04)  VALUE ZERO.  00963071
009640     05  PV-PGYBK-PRTR-ID-ADDR           PIC  X(15)  VALUE SPACES.00964071
009650     05  PV-PGYBK-PRTR-OS-RLSE-CDE       PIC  X(15)  VALUE SPACES.00965071
009660     05  PV-PGYBK-DATA-XFER-MODE-ID      PIC  X(02)  VALUE SPACES.00966071
009670     05  PV-PGYBK-XMIT-INTFC-CDE         PIC  X(01)  VALUE SPACE. 00967071
009680     05  PV-PGYBK-PRTR-TYP-CDE           PIC  X(01)  VALUE SPACE. 00968071
009690     05  PV-SUM-DTL-FCSE-SPLT-UNT-QTY    PIC S9(09)  COMP.        00969071
009700     05  PV-SUM-DTL-INPK-SPLT-UNT-QTY    PIC S9(09)  COMP.        00970071
009710     05  PV-SUM-DTL-FCSE-ACTL-UNT-QTY    PIC S9(09)  COMP.        00971071
009720                                                                  00972071
009730     05  PV-ITEMS-HOLD                   PIC S9(03)  COMP-3.      00973071
009740     05  PV-ITEMS-DIFF                   PIC S9(03)  COMP-3.      00974071
009750     05  PV-INVALID-STORE-ENTRIES        PIC  9(02).              00975071
009760                                                                  00976071
009770     05  PV-CARTON-COUNT-CALC            PIC  9(04).              00977071
009780     05  PV-CARTON-COUNT-REM             PIC  9(04).              00978071
009790     05  PV-WORK-VENDOR-NAME.                                     00979071
009800         10  FILLER                      PIC X(01) VALUE '('.     00980071
009810         10  PV-VENDOR-NAME              PIC X(16).               00981071
009820         10  FILLER                      PIC X(01) VALUE ')'.     00982071
009830                                                                  00983071
009840     05  PV-SIN-ADDR-1                   PIC 9(08) COMP VALUE 0.  00984071
009850     05  PV-SIN-ADDR-2                   PIC 9(08) COMP VALUE 0.  00985071
009860     05  PV-SIN-ADDR-ZERO                PIC 9(08) COMP VALUE 0.  00986071
009870     05  PV-CREATE-TMST-DATE             PIC X(10).               00987071
009880     05  PV-SOFT-ABORT-MSG.                                       00988071
009890         10  FILLER            PIC X(12) VALUE ' PCKCS701 - '.    00989071
009900         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       00990071
009910         10  PV-SOFT-SQLCODE   PIC ZZ9-.                          00991071
009920         10  FILLER            PIC X(07) VALUE ' PARA: '.         00992071
009930         10  PV-SOFT-PARAGRAPH PIC X(30).                         00993071
009940         10  PV-SOFT-MSG       PIC X(18).                         00994071
009950                                                                  00995071
009960     05 PV-CURRENT-DB2-DATE              PIC X(10)   VALUE SPACES.00996071
009970     05 PV-CURRENT-DB2-DATE-R REDEFINES PV-CURRENT-DB2-DATE.      00997071
009980         10 PV-CURRENT-CCYY              PIC  9(04).              00998071
009990         10 FILLER                       PIC  X(01).              00999071
010000         10 PV-CURRENT-MM-DD             PIC  9(05).              01000071
010010                                                                  01001071
010020     05  PV-RECDIS-FCSE-EQUAL-CNT       PIC S9(09)  VALUE ZEROS   01002071
010030                                                    COMP-3.       01003071
010040     05  PV-ODD-CARTON-UNT-QTY           PIC S9(09)  COMP.        01004071
010050     05  PV-ODD-RECDIS-DIFF              PIC S9(09)  COMP.        01005071
010060     05  PV-ODD-RECDIS-CTNS              PIC S9(09)  COMP.        01006071
010070     05  PV-ODD-RECDIS-REMAINDER         PIC S9(09)  COMP.        01007071
010080     05  PV-ODD-CARTON-INPK-TOTAL        PIC S9(09)  COMP.        01008071
010090     05  PV-ODD-CARTON-INPK-USED         PIC S9(09)  COMP.        01009071
010100     05  PV-ODD-RECDIS-STR-NBR           PIC  S9(4)  COMP.        01010071
010110     05  PV-ODD-RECDIS-EXPTED-ITM-QTY    PIC  S9(9)  COMP.        01011071
010120     05  PV-FULLCASE-ODD-CART-OVER       PIC S9(09)  COMP.        01012071
010130     05  PV-FULLCASE-ODD-UNT-OVER        PIC S9(09)  COMP.        01013071
010140     05  PV-FULLCASE-ODD-COUNT           PIC S9(09)  COMP.        01014071
010150     05  PV-EDIT-OPER-FCLTY.                                      01015071
010160         10  PV-EDIT-OPER                PIC  9(04).              01016071
010170         10  FILLER                      PIC  X(01) VALUE '-'.    01017071
010180         10  PV-EDIT-FCLTY               PIC  9(04).              01018071
010190     05  PV-EDIT-PO-RCVR.                                         01019071
010200         10  PV-EDIT-PO                  PIC  9(08).              01020071
010210         10  FILLER                      PIC  X(01) VALUE '-'.    01021071
010220         10  PV-EDIT-RCVR                PIC  9(03).              01022071
010230     05  PV-PREV-PREPK-ID                PIC S9(04) VALUE ZEROES. 01023071
010240     05  PV-DSPLY-PREPK.                                          01024071
010250         10  FILLER                      PIC  X(03) VALUE 'PK-'.  01025071
010260         10  PV-DSPLY-PREPK-ID           PIC  9(04) VALUE ZEROES. 01026071
010270     05  PV-PACKS-IN-CRTN                PIC S9(06) VALUE ZEROES. 01027071
010280     05  PV-OUTER-RATIO-QTY              PIC  9(06) VALUE ZEROES. 01028071
010290     05  PV-OUTER-RATIO-REMAIN           PIC  9(06) VALUE ZEROES. 01029071
010300     05  PV-ODD-CRTN-RATIO-QTY           PIC  9(06) VALUE ZEROES. 01030071
010310     05  PV-ODD-CRTN-RATIO-REMAIN        PIC  9(06) VALUE ZEROES. 01031071
010320     05  PV-PREPK-ID                     PIC  9(04) VALUE ZEROES. 01032071
010330     05  PV-PRPK-REC-ORD-LNE-NBR         PIC  S9(9) COMP.         01033071
010340     05  PV-PRPK-REC-INNR-PACK-QTY       PIC  S9(4) COMP.         01034071
010350     05  PV-PRPK-REC-OPER-UNT-ID         PIC  S9(4) COMP.         01035071
010360     05  PV-PRPK-REC-FCLTY-ID            PIC  S9(4) COMP.         01036071
010370     05  PV-PRPK-REC-STATUS-CDE          PIC   X(2).              01037071
010380     05  PV-PRPK-REC-PKSL-ITM-QTY        PIC  S9(9) COMP.         01038071
010390     05  PV-PRPK-REC-DTL-CK-ITM-QTY      PIC  S9(9) COMP.         01039071
010400     05  PV-PRPK-REC-PREPK-ID            PIC  S9(4) COMP.         01040071
010410     05  PV-PRPK-REC-PREPK-RATO-QTY      PIC  S9(4) COMP.         01041071
010420     05  PV-PRPK-REC-CASE-PACK-QTY       PIC  S9(4) COMP.         01042071
010430     05  PV-TOT-PREPK-UNTS               PIC  S9(9) COMP.         01043071
010440     05  PV-TOT-PREPK-INPK-UNTS          PIC  S9(9) COMP.         01044071
010450                                                                  01045071
010460     05  PV-OUTER-PK-RATIO               PIC  S9(4) COMP.         01046071
010470     05  PV-P2L-SPLT-UNT-QTY-RATIO       PIC  S9(9) COMP.         01047071
010480     05  PV-P2L-SPLT-UNT-QTY-REM         PIC  S9(9) COMP.         01048071
010490     05  PV-FCSE-SPLT-UNT-QTY-RATIO      PIC  S9(9) COMP.         01049071
010500     05  PV-FCSE-SPLT-UNT-QTY-REM        PIC  S9(9) COMP.         01050071
010510     05  PV-INPK-SPLT-UNT-QTY-RATIO      PIC  S9(9) COMP.         01051071
010520     05  PV-INPK-SPLT-UNT-QTY-REM        PIC  S9(9) COMP.         01052071
010530     05  PV-FCSE-ACTL-UNT-QTY-RATIO      PIC  S9(9) COMP.         01053071
010540     05  PV-FCSE-ACTL-UNT-QTY-REM        PIC  S9(9) COMP.         01054071
010550     05  PV-EXPTED-ITM-QTY-RATIO         PIC  S9(9) COMP.         01055071
010560     05  PV-EXPTED-ITM-QTY-REM           PIC  S9(9) COMP.         01056071
010570     05  PV-ACTL-ALLOC-QTY-RATIO         PIC  S9(9) COMP.         01057071
010580     05  PV-ACTL-ALLOC-QTY-REM           PIC  S9(9) COMP.         01058071
010590                                                                  01059071
010600     05  PV-OUTER-PK-PREPK               PIC  S9(4) COMP.         01060071
010610     05  PV-P2L-SPLT-UNT-QTY-PREPK       PIC  S9(9) COMP.         01061071
010620     05  PV-FCSE-SPLT-UNT-QTY-PREPK      PIC  S9(9) COMP.         01062071
010630     05  PV-INPK-SPLT-UNT-QTY-PREPK      PIC  S9(9) COMP.         01063071
010640     05  PV-FCSE-ACTL-UNT-QTY-PREPK      PIC  S9(9) COMP.         01064071
010650     05  PV-EXPTED-ITM-QTY-PREPK         PIC  S9(9) COMP.         01065071
010660     05  PV-ACTL-ALLOC-QTY-PREPK         PIC  S9(9) COMP.         01066071
010670     05  PV-PREPK-CNTL-STK-COUNT         PIC  S9(9) COMP.         01067071
010680     05  PV-PREPK-E-COMM-COUNT           PIC  S9(9) COMP.         01068071
010690                                                                  01069071
010700     05  PV-UCC128-CRTN-CNT             PIC S9(09)  COMP.         01070071
010710     05  PV-UCC128-TOT-UNTS             PIC S9(09)  COMP.         01071071
010720     05  PV-UCC128-TOT-OTPK-QTYS        PIC S9(09)  COMP.         01072071
010730     05  PV-UCC128-OTPK-QTY             PIC S9(09)V COMP-3.       01073071
010740     05  PV-AUTO-SELECT-LINES           PIC S9(09)  COMP.         01074071
010750     05  PV-UCC128-PO-NBR               PIC S9(09) COMP VALUE +0. 01075071
010760     05  PV-UCC128-REC-SEQ-NBR          PIC S9(09) COMP VALUE +0. 01076071
010770     05  PV-UCC128-LINES-PER-CRTN       PIC S9(09)V COMP-3.       01077071
010780                                                                  01078071
010790     05  PV-DISPLAY-PO-NBR              PIC  9(08) VALUE ZEROES.  01079071
010800     05  PV-DISPLAY-RCVR-SEQ-NBR        PIC  9(04) VALUE ZEROES.  01080071
010810     05  PV-DISPLAY-LNE-NBR             PIC  9(04) VALUE ZEROES.  01081071
010820     05  PV-DISPLAY-OPER                PIC  9(04) VALUE ZEROES.  01082071
010830     05  PV-DISPLAY-FCLTY               PIC  9(04) VALUE ZEROES.  01083071
010840     05  PV-DISPLAY-TASK-NBR            PIC  9(07) VALUE ZEROES.  01084071
010850     05  PV-DISPLAY-ITEM-NBR            PIC  9(15) VALUE ZEROES.  01085071
010860     05  PV-DISPLAY-ACTIVITY            PIC  X(10) VALUE SPACES.  01086071
010870     05  PV-DISPLAY-FKEY                PIC  X(05) VALUE SPACES.  01087071
010880     05  PV-DISPLAY-LABOR-ASGMTS        PIC  9(04) VALUE ZEROES.  01088071
010890     05  PV-DISPLAY-SQLCODE             PIC -9(03).               01089071
010900                                                                  01090071
010910     05  PV-LABOR-ASGMT-STRT-DTE        PIC  X(10).               01091071
010920     05  PV-LABOR-ASGMT-NBR-TXT         PIC  X(10).               01092071
010930     05  PV-LABOR-ASGMT-NBR-SEQ-NBR     PIC S9(09) COMP.          01093071
010940     05  PV-LABOR-SEQ-START-NBR         PIC S9(09) COMP.          01094071
010950     05  PV-LABOR-DUMMY-TK              PIC  X(08).               01095071
010960     05  PV-LABOR-USER-ID               PIC  X(08).               01096071
010970     05  PV-LABOR-CURRENT-DATE          PIC  X(10).               01097071
010980     05  PV-LABOR-CURRENT-TIME          PIC  X(08).               01098071
010990     05  PV-LABOR-P2L-UNITS             PIC S9(09)  COMP.         01099071
011000     05  PV-LABOR-FCSE-UNITS            PIC S9(09)  COMP.         01100071
011010     05  PV-LABOR-INPK-UNITS            PIC S9(09)  COMP.         01101071
011020     05  PV-LABOR-SML-UNITS             PIC S9(09)  COMP.         01102071
011030                                                                  01103071
011040     05  PV-ASGMT-COUNT                 PIC S9(09)  COMP.         01104071
011050                                                                  01105071
011060     05  PV-HANG-COUNT                  PIC S9(09)  COMP.         01106071
011070     05  PV-FOLD-COUNT                  PIC S9(09)  COMP.         01107071
011080     05  PV-COMMODITY-COUNT             PIC S9(09)  COMP.         01108071
011090     05  PV-OTHER-COUNT                 PIC S9(09)  COMP.         01109071
011100     05  PV-P2L-ZONE                    PIC X(14).                01110071
011110         88 PV-COMMODITY                 VALUE 'COMMODITY     '.  01111071
011111         88 PV-HANG-FOLD                 VALUE 'HANG/FOLD     '.  01111171
011112         88 PV-HANG-COMMODITY            VALUE 'HANG/COMMODITY'.  01111271
011113                                                                  01111371
011114     05   PV-P2LMOD-OPER-UNT-ID            PIC  S9(4) COMP.       01111471
011115     05   PV-DISTDT-ORD-NBR                PIC  S9(9) COMP.       01111571
011116     05   PV-RECDIS-ORD-NBR                PIC  S9(9) COMP.       01111671
011117     05   PV-TRBNTF-PO-NBR                 PIC  S9(9) COMP.       01111771
011118     05   PV-RECITM-ORD-NBR                PIC  S9(9) COMP.       01111871
011119     05   PV-PKSLIP-PO-NBR                 PIC  S9(9) COMP.       01111971
011120                                                                  01112071
011130     05   PV-SYS-TRAIL-CODE     PIC  X(3).                        01113071
011131     05   PV-LABEL-DESGNTN      PIC  X(3).                        01113171
011132     05   PV-HAZ-SKU-NBR        PIC  S9(8)V COMP-3.               01113271
011133                                                                  01113371
011134                                                                  01113471
011135 01  SELECT-PARMS.                                                01113571
011136     02  SELECT-NUMFDS          PIC 9(8) COMP VALUE 2.            01113671
011137     02  SELECT-TIMEOUT.                                          01113771
011138         03  SELECT-SECS        PIC 9(8) COMP VALUE 05.           01113871
011139         03  SELECT-MILLSECS    PIC 9(8) COMP VALUE 0.            01113971
011140     02  SELECT-RD-MASK         PIC X(16).                        01114071
011150     02  SELECT-WR-MASK         PIC X(16).                        01115071
011160     02  SELECT-EX-MASK         PIC X(16).                        01116071
011170     02  SELECT-RR-MASK         PIC X(16).                        01117071
011180     02  SELECT-RW-MASK         PIC X(16).                        01118071
011190     02  SELECT-RE-MASK         PIC X(16).                        01119071
011200                                                                  01120071
011210 01  CHAR-MASK.                                                   01121071
011220     02 CHAR-STRING             PIC  X(100).                      01122071
011230                                                                  01123071
011240 01  CHAR-ARRAY REDEFINES CHAR-MASK.                              01124071
011250     02  CHAR-ENTRY-TABLE OCCURS 100 TIMES.                       01125071
011260       03  CHAR-ENTRY         PIC  X.                             01126071
011270                                                                  01127071
011280 01  BIT-MASK.                                                    01128071
011290     02  BIT-ARRAY            PIC  X(16).                         01129071
011300                                                                  01130071
011310 01  BIT-FUNCTION-CODES.                                          01131071
011320     02  CTOB                 PIC  X(4) VALUE 'CTOB'.             01132071
011330     02  BTOC                 PIC  X(4) VALUE 'BTOC'.             01133071
011340                                                                  01134071
011350 01  BIT-MASK-LENGTH          PIC  9(8) COMP VALUE 100.           01135071
011360                                                                  01136071
011370 01  BITMASK-TOKEN            PIC X(16) VALUE 'TCPIPBITMASKCOBL'. 01137071
011380 01  SOCKETS                  PIC  9(8) COMP VALUE 100.           01138071
011390 01  SOCKNO                   PIC S9(8) BINARY.                   01139071
011400 01  EZRETC                   PIC S9(8) COMP.                     01140071
011410                                                                  01141071
011420*----------------------------------------------------------------*01142071
011430* VALID P2L STORE # TABLE - DC (DISTRIBUTION CENTER)             *01143071
011440*                           RV (RETURN TO VENDOR)                *01144071
011450*----------------------------------------------------------------*01145071
011460 01 TBL-INVALID-STORES.                                           01146071
011470    05 TBL-INVALID-STORE-ENTRY  OCCURS 100 TIMES                  01147071
011480                                INDEXED BY STORE-INX.             01148071
011490       10 TBL-STORE-NBR         PIC X(04).                        01149071
011500       10 TBL-STORE-NBR-NUM REDEFINES TBL-STORE-NBR               01150071
011510                                PIC 9(04).                        01151071
011520                                                                  01152071
011530*-----------------------------------------------------------------01153071
011540* PACK-TO-LIGHT MODULE TABLE                                      01154071
011550*-----------------------------------------------------------------01155071
011560 01  PMT-P2L-MODULE-TABLE.                                        01156071
011570     15 FILLER  OCCURS 05 TIMES                                   01157071
011580                INDEXED BY PMT-MOD-IDX.                           01158071
011590        20 PMT-MODULE       PIC  9(03) VALUE ZEROES.              01159071
011600                                                                  01160071
011610                                                                  01161071
011620*----------------------------------------------------------------*01162071
011630 01  ST-SYSTEM-TIME-DATE-AREA.                                    01163071
011640     05  ST-ABSTIME                      PIC S9(16)  VALUE +0     01164071
011650                                                     COMP SYNC.   01165071
011660     05  ST-SYSTEM-TIME.                                          01166071
011670         10  ST-HHMMSS-FORMAT            PIC  X(08)  VALUE SPACE. 01167071
011680         10  FILLER  REDEFINES  ST-HHMMSS-FORMAT.                 01168071
011690             15  ST-SYSTEM-HOUR-X        PIC  X(02).              01169071
011700             15  ST-SYSTEM-HOUR  REDEFINES  ST-SYSTEM-HOUR-X      01170071
011710                                         PIC  9(02).              01171071
011720             15  FILLER                  PIC  X(01).              01172071
011730             15  ST-SYSTEM-MINUTE        PIC  X(02).              01173071
011740             15  FILLER                  PIC  X(01).              01174071
011750             15  ST-SYSTEM-SECOND        PIC  X(02).              01175071
011760     05  SD-SYSTEM-DATE.                                          01176071
011770         10  SD-MMDDYY-FORMAT            PIC  X(08)  VALUE SPACE. 01177071
011780         10  FILLER  REDEFINES  SD-MMDDYY-FORMAT.                 01178071
011790             15  SD-SYSTEM-MONTH         PIC  X(02).              01179071
011800             15  FILLER                  PIC  X(01).              01180071
011810             15  SD-SYSTEM-DAY           PIC  X(02).              01181071
011820             15  FILLER                  PIC  X(01).              01182071
011830             15  SD-SYSTEM-YEAR          PIC  X(02).              01183071
011840         10  FILLER                      PIC  X(02)  VALUE SPACE. 01184071
011850     05  FILLER  REDEFINES  SD-SYSTEM-DATE.                       01185071
011860         10  FILLER                      PIC  X(06).              01186071
011870         10  SD-SYSTEM-CENTURY-YEAR      PIC  9(04).              01187071
011880     05  SD-YYYY-FORMAT                  PIC S9(09)  VALUE +0     01188071
011890                                                     COMP.        01189071
011900                                                                  01190071
011910*----------------------------------------------------------------*01191071
011920*----------------------------------------------------------------*01192071
011930 01  SEND-ERR.                                                    01193071
011940     05  FILLER                       PIC X(21)                   01194071
011950         VALUE IS 'SENDTO SOCKET FAILED '.                        01195071
011960     05  FILLER                       PIC X(6)                    01196071
011970         VALUE IS 'ERRNO='.                                       01197071
011980     05  SEND-RETCODE                 PIC 9(10).                  01198071
011990     05  FILLER                       PIC X(1) VALUE SPACES.      01199071
012000     05  SEND-ERRNO                   PIC 9(8).                   01200071
012010     05  FILLER                       PIC X(1) VALUE SPACES.      01201071
012020     05  SEND-RECEIVER                PIC 9(8).                   01202071
012030     05  FILLER                       PIC X(1) VALUE '-'.         01203071
012040     05  SEND-SEQ                     PIC 9(3).                   01204071
012050     05  FILLER                       PIC X(1) VALUE '-'.         01205071
012060     05  SEND-LINE                    PIC 9(4).                   01206071
012070                                                                  01207071
012080*----------------------------------------------------------------*01208071
012090*----------------------------------------------------------------*01209071
012100 01  CONNECT-ERR.                                                 01210071
012110     05  FILLER                       PIC X(24)                   01211071
012120         VALUE IS 'CONNECT-SOCKET FAILED   '.                     01212071
012130     05  FILLER                       PIC X(9)                    01213071
012140         VALUE IS ' ERRNO = '.                                    01214071
012150     05  CONNECT-ERRNO                PIC 9(8).                   01215071
012160                                                                  01216071
012170*----------------------------------------------------------------*01217071
012180*----------------------------------------------------------------*01218071
012190 01  RECEIVE-ERR.                                                 01219071
012200     05  FILLER                       PIC X(14)                   01220071
012210         VALUE IS 'RCV CNFM FAIL-'.                               01221071
012220     05  FILLER                       PIC X(4)                    01222071
012230         VALUE IS 'ERR='.                                         01223071
012240     05  RECEIVE-RETCODE              PIC 9(10).                  01224071
012250     05  FILLER                       PIC X(1) VALUE SPACES.      01225071
012260     05  RECEIVE-ERRNO                PIC 9(8).                   01226071
012270     05  FILLER                       PIC X(1) VALUE SPACES.      01227071
012280     05  RECEIVE-RECEIVER             PIC 9(8).                   01228071
012290     05  FILLER                       PIC X(1) VALUE '-'.         01229071
012300     05  RECEIVE-SEQ                  PIC 9(3).                   01230071
012310     05  FILLER                       PIC X(1) VALUE '-'.         01231071
012320     05  RECEIVE-LINE                 PIC 9(4).                   01232071
012330     05  FILLER                       PIC X(6) VALUE ' PARA-'.    01233071
012340     05  RECEIVE-PARA                 PIC X(4).                   01234071
012350     05  FILLER                       PIC X(9) VALUE ' P2L ERR-'. 01235071
012360     05  RECEIVE-P2L-ERR              PIC X(3).                   01236071
012370                                                                  01237071
012380*----------------------------------------------------------------*01238071
012390*----------------------------------------------------------------*01239071
012400 01  TCP-BUF2.                                                    01240071
012410     05 TCP-BUF                          PIC  X(50)  VALUE SPACE. 01241071
012420     05 TCP-BUF-DATA                     PIC X(102)  VALUE SPACE. 01242071
012430     05 TCP-BUF-DATA-2                   PIC X(100)  VALUE SPACE. 01243071
012440 01  TCP-BUF-AREA.                                                01244071
012450     05  TCP-BUF-ALL                     PIC X(50) VALUE SPACES.  01245071
012460     05  TCP-BUF-ONE REDEFINES TCP-BUF-ALL                        01246071
012470                OCCURS 50 TIMES          PIC  X(01).              01247071
012480 01  PV-BUFFER-SUB                    PIC 9(08) BINARY VALUE ZERO.01248071
012490                                                                  01249071
012500                                                                  01250071
012600*----------------------------------------------------------------*01260071
012700*   THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.    *01270071
012710*   THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE            *01271071
012720*   APPLICATION-SPECIFIC COMMAREA.                               *01272071
012730*----------------------------------------------------------------*01273071
012740 01  LQW-LIST-QUEUE-WORK-AREA.                                    01274071
012750     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  01275071
012760     05  LQW-ITEM-ENTRIES               OCCURS 10 TIMES           01276071
012770                                        INDEXED BY LQW-IDX.       01277071
012780         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP.         01278071
012790         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               01279071
012800         10  LQW-SELECTED-SW            PIC  X(01).               01280071
012810             88  LQW-SELECT                         VALUE 'S'.    01281071
012820             88  LQW-DESELECT                       VALUE ' '.    01282071
012830         10  LQW-ACTION                 PIC  X(01).               01283071
012840             88  LQW-DEL                            VALUE 'D'.    01284071
012850             88  LQW-INQ                            VALUE 'I'.    01285071
012860             88  LQW-UPD                            VALUE 'U'.    01286071
012870             88  LQW-ERR                            VALUE 'E'.    01287071
012880         10  LQW-PO-RCVR-LINE           PIC  X(04).               01288071
012890         10  LQW-SKU                    PIC  9(08) COMP.          01289071
012900         10  LQW-MODULE                 PIC  X(03).               01290071
012910         10  LQW-CARTON-CNT-X.                                    01291071
012920             15  LQW-CARTON-CNT         PIC  9(04).               01292071
012930         10  LQW-INNER-PACK-X.                                    01293071
012940             15  LQW-INNER-PACK         PIC  9(04).               01294071
012950         10  LQW-OUTER-PACK-X.                                    01295071
012960             88  LQW-MLT-OTPK-UCC128                VALUE 'MLT '. 01296071
012970             15  LQW-OUTER-PACK         PIC  9(04).               01297071
012980         10  LQW-IN-PACK-CONVY          PIC  X(01).               01298071
012990             88  LQW-IN-PAK-CONVEY-NO               VALUE 'N'.    01299071
013000             88  LQW-IN-PAK-CONVEY-YES              VALUE 'Y'.    01300071
013010         10  LQW-LABEL-TYPE             PIC  X(01).               01301071
013020             88  LQW-LBL-TYP-VALID VALUE  'N' 'P' 'S' 'X' 'U'.    01302071
013030             88  LQW-SHUFFLED-SML                  VALUE 'S'.     01303071
013040             88  LQW-STORE-SML                     VALUE 'R'.     01304071
013050             88  LQW-STORE-PGYBK                   VALUE 'P'.     01305071
013060             88  LQW-LNE-DO-NOT-PRT-LBL            VALUE 'X'.     01306071
013070             88  LQW-LBL-TYP-NONE                  VALUE 'N'.     01307071
013080             88  LQW-LBL-TYP-UCC128                VALUE 'U'.     01308071
013090         10  LQW-PROCESS-QTY            PIC  9(05) COMP-3.        01309071
013100         10  LQW-TRANSCRIB-QTY          PIC  9(05) COMP-3.        01310071
013110         10  LQW-P2L-LBL-CNT            PIC  9(04) COMP.          01311071
013120         10  LQW-SHP-LBL-CNT            PIC  9(04) COMP.          01312071
013130         10  LQW-SML-FCSE-LBL-CNT       PIC  9(04) COMP.          01313071
013140         10  LQW-SML-INPK-LBL-CNT       PIC  9(04) COMP.          01314071
013150         10  LQW-LINE-STATUS            PIC  X(04).               01315071
013160         10  LQW-DISPLAY-STORE-CNT      PIC  9(04) COMP.          01316071
013170         10  LQW-DISPLAY-ITM-CNT        PIC  9(04) COMP.          01317071
013180         10  LQW-EXPTD-ITM-QTY          PIC  9(08) COMP.          01318071
013190         10  LQW-LNE-CRE-LBL-OPT        PIC  X(01).               01319071
013200             88  LQW-LNE-CRE-P2L-LBL               VALUE 'P'.     01320071
013210             88  LQW-LNE-CRE-BOTH-LBL              VALUE 'B'.     01321071
013220             88  LQW-LNE-CRE-SML-LBL               VALUE 'C'.     01322071
013230         10  LQW-LNE-FCSE-AREA          PIC  X(06).               01323071
013240         10  LQW-ODD-CARTON             PIC  9(02).               01324071
013250         10  LQW-P2L-DIVERT-CDE         PIC X(04).                01325071
013260         10  LQW-SOCKET-NBR             PIC 9(01).                01326071
013270         10  LQW-RESEND-P2L-SW          PIC X(01).                01327071
013280             88  LQW-RESEND-P2L-YES                VALUE 'Y'.     01328071
013290         10  LQW-P2L-HILITE-SW          PIC X(01).                01329071
013300             88  LQW-P2L-RESEND-HILITE-NO          VALUE 'N'.     01330071
013310             88  LQW-P2L-RESEND-HILITE-YES         VALUE 'Y'.     01331071
013320         10  LQW-ODD-CRTN-USE-SW        PIC  X(01).               01332071
013330             88  LQW-ODD-CRTN-FCSE                 VALUE 'F'.     01333071
013340             88  LQW-ODD-CRTN-INPK                 VALUE 'I'.     01334071
013350             88  LQW-ODD-CRTN-P2L                  VALUE 'P'.     01335071
013360             88  LQW-ODD-CRTN-NONE                 VALUE 'N'.     01336071
013370         10  LQW-FCSE-ODD-USED-SW       PIC  X(01).               01337071
013380             88  LQW-FCSE-ODD-CRTN-NOT-USED        VALUE 'N'.     01338071
013390             88  LQW-FCSE-ODD-CRTN-USED            VALUE 'Y'.     01339071
013400         10  LQW-INPK-ODD-USED-SW    PIC  X(01).                  01340071
013410             88  LQW-INPK-ODD-CRTN-NOT-USED        VALUE 'N'.     01341071
013420             88  LQW-INPK-ODD-CTRN-USED            VALUE 'Y'.     01342071
013430         10  LQW-TBL-INPK-QTY           PIC  9(04) COMP-3.        01343071
013440         10  LQW-UPDATE-SW              PIC  X(01).               01344071
013450             88  LQW-NO-UPDATE                     VALUE 'N'.     01345071
013460             88  LQW-UPDATE-OK                     VALUE 'Y'.     01346071
013470         10  LQW-CRE-LBL-UPDATE-SW      PIC  X(01).               01347071
013480             88  LQW-CRE-LBL-NO-UPDT               VALUE 'N'.     01348071
013490             88  LQW-CRE-LBL-UPDT                  VALUE 'Y'.     01349071
013500         10  LQW-LINE-ERROR-SW          PIC  X(01).               01350071
013510             88  LQW-NO-LINE-ERROR                 VALUE ' '.     01351071
013520             88  LQW-QTY-ERROR-YES                 VALUE 'A'.     01352071
013530             88  LQW-TROUBLE-ERROR                 VALUE 'B'.     01353071
013540             88  LQW-DOWNLOADED                    VALUE 'C'.     01354071
013550             88  LQW-DISTRO-ERROR                  VALUE 'D'.     01355071
013560             88  LQW-LNE-TROUBLE-YES               VALUE 'E'.     01356071
013570             88  LQW-LNE-BAD-INPK-Y                VALUE 'F'.     01357071
013580             88  LQW-LNE-BAD-OTPK-Y                VALUE 'G'.     01358071
013590             88  LQW-LNE-BAD-ODD-Y                 VALUE 'H'.     01359071
013600             88  LQW-PREPK-CNTL-STK                VALUE 'I'.     01360071
013610             88  LQW-PREPK-E-COMM                  VALUE 'J'.     01361071
013620             88  LQW-LNE-DC-RTV-OTPK               VALUE 'K'.     01362071
013630         10  LQW-PROTECT-SW             PIC  X(01).               01363071
013640             88  LQW-PROTECTED                     VALUE 'Y'.     01364071
013650             88  LQW-NOT-PROTECTED                 VALUE 'N'.     01365071
013660         10  LQW-P2L-DOWNLOADED-SW      PIC  X(01).               01366071
013670             88  LQW-LNE-DOWNLOADED-YES            VALUE 'Y'.     01367071
013680             88  LQW-LNE-DOWNLOADED-NO             VALUE 'N'.     01368071
013690         10  LQW-PPC-EXISTS-SW          PIC  X(01).               01369071
013700             88  LQW-PPC-EXISTS                    VALUE 'Y'.     01370071
013710             88  LQW-NOT-PPC-EXISTS                VALUE 'N'.     01371071
013720         10  LQW-HILITE-SW              PIC  X(01).               01372071
013730             88  LQW-HILITE-LNE-ST                 VALUE 'Y'.     01373071
013740             88  LQW-NOT-HILITE-LNE-ST             VALUE 'N'.     01374071
013750         10  LQW-CS-BOUND-UNTS          PIC  9(09)   COMP.        01375071
013760         10  LQW-DC-BOUND-UNTS          PIC  9(09)   COMP.        01376071
013770         10  LQW-RTV-BOUND-UNTS         PIC  9(09)   COMP.        01377071
013780         10  LQW-CS-BOUND-CTNS          PIC  9(09)   COMP.        01378071
013790         10  LQW-PREPK-ID               PIC  S9(4)   COMP.        01379071
013800         10  LQW-PREPK-RATIO            PIC  S9(4)   COMP.        01380071
013810         10  LQW-PACKS-IN-CRTN          PIC  S9(4)   COMP.        01381071
013820         10  LQW-LNE-UCC128-DATA-IND    PIC  X(01).               01382071
013830             88  LQW-LNE-UCC128-YES                VALUE 'Y'.     01383071
013840             88  LQW-LNE-UCC128-NO                 VALUE 'N'.     01384071
013850             88  LQW-LNE-UCC128-IGNORE             VALUE 'I'.     01385071
013860         10  LQW-LNE-UCC128-ERROR       PIC  X(01).               01386071
013870             88  LQW-LNE-UCC128-CRTN-MLT-LNES      VALUE 'A'.     01387071
013880         10  LQW-P2L-VENDOR             PIC  X(01).               01388071
013890             88  LQW-P2L-DYNAPACK                  VALUE 'D' ' '. 01389071
013900             88  LQW-P2L-PCC                       VALUE 'L'.     01390071
013910             88  LQW-P2L-THEOPACK                  VALUE 'T'.     01391071
013911         10  LQW-ITM-NBR                PIC  9(15)   COMP.        01391171
013912         10  LQW-HAZ-CODE               PIC  X(03).               01391271
013913         10  LQW-CLASS                  PIC  X(02).               01391371
013914         10  LQW-SUBCLASS               PIC  X(02).               01391471
013915         10  LQW-UCC128-USABLE-DATA     PIC  X(01).               01391571
013916             88  LQW-UCC128-USABLE-YES            VALUE 'Y'.      01391671
013917             88  LQW-UCC128-USABLE-NO             VALUE 'N'.      01391771
013918         10  LQW-P2L-ALS-VC-SW       PIC  X(01).                  01391871
013919             88  LQW-P2L-ALS-3-DIGIT-STR          VALUE '3'.      01391971
013920             88  LQW-P2L-ALS-4-DIGIT-STR          VALUE '4'.      01392071
013930                                                                  01393071
013940*---------------------------------------------------------------* 01394071
013950*                                                               * 01395071
013960*---------------------------------------------------------------* 01396071
013970     COPY PCWS121.                                                01397071
013980                                                                  01398071
013990                                                                  01399071
014000*---------------------------------------------------------------* 01400071
014010* RECORD LAYOUTS FOR DATA SENT TO NEW P2L SYSTEMS               * 01401071
014020*        LTP - PCC LIGHTENING PICK                              * 01402071
014030*        THP - THEOTEK - THEOPACK                               * 01403071
014040*---------------------------------------------------------------* 01404071
014050     COPY PCWS184.                                                01405071
014060                                                                  01406071
014070                                                                  01407071
014080*---------------------------------------------------------------* 01408071
014090*  RECORD LAYOUT TO PASS DATA TO LABEL PRINT ROUTINE            * 01409071
014100*  (PCKCS191)                                                   * 01410071
014110*---------------------------------------------------------------* 01411071
014120     COPY PCWS126.                                                01412071
014130                                                                  01413071
014140                                                                  01414071
014150*---------------------------------------------------------------* 01415071
014160* RECORD LAYOUT TO PASS DATA TO UCC128 LABEL CALC/CREATE ROUTINE* 01416071
014170*  (PCKCS719)                                                   * 01417071
014180*---------------------------------------------------------------* 01418071
014190     COPY PCWS166.                                                01419071
014200                                                                  01420071
014300                                                                  01430071
014310*---------------------------------------------------------------* 01431071
014320*  RECORD LAYOUT FOR THE LIST SELECTION TEMP STORAGE QUEUE.     * 01432071
014330*---------------------------------------------------------------* 01433071
014340     COPY PCWS016.                                                01434071
014350                                                                  01435071
014360                                                                  01436071
014370*---------------------------------------------------------------* 01437071
014380*  RECORD LAYOUT FOR THE LIST SELECTION TEMP STORAGE QUEUE.     * 01438071
014390*---------------------------------------------------------------* 01439071
014400     COPY SUWS004.                                                01440071
014410                                                                  01441071
014420                                                                  01442071
014430*---------------------------------------------------------------* 01443071
014440*  RECORD LAYOUT FOR THE LIST SELECTION TEMP STORAGE QUEUE.     * 01444071
014450*---------------------------------------------------------------* 01445071
014460     COPY RCWS013.                                                01446071
014470                                                                  01447071
014480                                                                  01448071
014490*---------------------------------------------------------------* 01449071
014500*  RECORD LAYOUT FOR THE LIST SELECTION TEMP STORAGE QUEUE.     * 01450071
014510*---------------------------------------------------------------* 01451071
014520     COPY RCWS816.                                                01452071
014530                                                                  01453071
014540                                                                  01454071
014550*---------------------------------------------------------------* 01455071
014560*  SELECTION QUEUE LAYOUT FOR PRE-PACK DETAIL LIST              * 01456071
014570*---------------------------------------------------------------* 01457071
014580     COPY RCWS801.                                                01458071
014590                                                                  01459071
014600                                                                  01460071
014610*----------------------------------------------------------------*01461071
014620*  COPYBOOK USED TO START WORK ORDERS                             01462071
014630*  (PCUT027)                                                      01463071
014640*----------------------------------------------------------------*01464071
014650     COPY PCWS027.                                                01465071
014660/                                                                 01466071
014670*----------------------------------------------------------------*01467071
014680*  COPYBOOK USED TO FOR ITEM ACCESS MODULE                        01468071
014690*  (XLKUT001)                                                     01469071
014700*----------------------------------------------------------------*01470071
014710     COPY XLWS001.                                                01471071
014720/                                                                 01472071
014730*-----------------------------------------------------------------01473071
014740* COMMAREA FOR XLKUT086 - PERM PRICE MODULE                       01474071
014750*-----------------------------------------------------------------01475071
014760     COPY XLWS086.                                                01476071
014770                                                                  01477071
014780******************************************************************01478071
014790*    COMMAREA COPYBOOK FOR AUTOVE PARM CHECK MODULE               01479071
014800******************************************************************01480071
014810     COPY RCWS040.                                                01481071
014820                                                                  01482071
014830******************************************************************01483071
014840*    COMMAREA COPYBOOK FOR PO-RCVR TRKNG MODULE                   01484071
014850******************************************************************01485071
014860     COPY RCWS071.                                                01486071
014870                                                                  01487071
014880*---------------------------------------------------------------* 01488071
014890*  SOCKET COMMANDS CODES NEED FOR THE TCP/IP SOCKET CALLS       * 01489071
014900*---------------------------------------------------------------* 01490071
014910*    COPY DPWS080.   USED FOR OLD SOCKET                          01491071
014920     COPY DPWS081.                                                01492071
014930                                                                  01493071
014940                                                                  01494071
014950*---------------------------------------------------------------* 01495071
014960*  Commarea used by program DLKUP001 to get the next sequence   * 01496071
014970*  number for the purpose of numbering detail business events.  * 01497071
014980*  DC Labor - WR-24630 - 1/23/04 DMH                            * 01498071
014990*---------------------------------------------------------------* 01499071
015000     COPY DLWS001.                                                01500071
015010                                                                  01501071
015020*---------------------------------------------------------------* 01502071
015030*  Commarea used by program DLKUT001 to determine if an         * 01503071
015040*  Associate is already associated to an open assignment.       * 01504071
015050*  DC Labor - WR-24630 - 1/23/04 DMH                            * 01505071
015060*---------------------------------------------------------------* 01506071
015070     COPY DLWS003.                                                01507071
015080                                                                  01508071
015090*---------------------------------------------------------------* 01509071
015100*  Commarea used by program DLKUP003 to insert new assignments  * 01510071
015110*  into the DL assignment database.                             * 01511071
015120*  DC Labor - WR-24630 - 1/23/04 DMH                            * 01512071
015130*---------------------------------------------------------------* 01513071
015140     COPY DLWS007.                                                01514071
015150                                                                  01515071
015160*---------------------------------------------------------------* 01516071
015170*  COMMAREA USED BY PROGRAM DLKUT028 TO END USER IF ON MULTIPLE * 01517071
015180*  ACTIVE ASSIGNMENTS                                           * 01518071
015190* 12/10/2008 - DMH                                              * 01519071
015200*---------------------------------------------------------------* 01520071
015210     COPY DLWS024.                                                01521071
015220                                                                  01522071
015230*---------------------------------------------------------------* 01523071
015240*  Copybook used to consistently format the assignment fields   * 01524071
015250*  within the DL programs.                                      * 01525071
015260*  DC Labor - WR-24630 - 1/23/04 DMH                            * 01526071
015270*---------------------------------------------------------------* 01527071
015271     COPY DLWS011.                                                01527171
015272                                                                  01527271
015273*---------------------------------------------------------------* 01527371
015274*  Commarea used by program XLKUP033 to write data to the EAI   * 01527471
015275*  export tables within the logistics domain.                   * 01527571
015276*  DC Labor - WR-24630 - 1/23/04 DMH                            * 01527671
015277*---------------------------------------------------------------* 01527771
015278     COPY XLWS072.                                                01527871
015279                                                                  01527971
015280*---------------------------------------------------------------* 01528071
015290*  Copybook used by program XLKUP033 to define the data         * 01529071
015300*  elements in the DLT_TXT and xxT_BUS_EVNT_DTL tables          * 01530071
015310*  (the EAI export tables within the logistics domain)          * 01531071
015320*  DC Labor - WR-24630 - 1/23/04 DMH                            * 01532071
015330*---------------------------------------------------------------* 01533071
015340     COPY PCWS242.                                                01534071
015350                                                                  01535071
015360                                                                  01536071
015370*---------------------------------------------------------------* 01537071
015380*  COPYBOOK USED TO CALL F-KEY ELIGIBILITY MODULE TO DETERMINE  * 01538071
015390*  RACF                                                           01539071
015400*---------------------------------------------------------------* 01540071
015410     COPY RCWS039.                                                01541071
015420                                                                  01542071
015430                                                                  01543071
015440*---------------------------------------------------------------* 01544071
015450*  COPYBOOK USED TO CARTON BY CARTON DIRECTIVE SEND MODULE      * 01545071
015460*  RACF                                                           01546071
015470*---------------------------------------------------------------* 01547071
015480     COPY SUWS095.                                                01548071
015490                                                                  01549071
015500                                                                  01550071
015510*----------------------------------------------------------------*01551071
015520**  SECURITY SUBROUTINE PARAMETERS                                01552071
015530*----------------------------------------------------------------*01553071
015540     COPY DPWS008.                                                01554071
015550                                                                  01555071
015560                                                                  01556071
015570*---------------------------------------------------------------* 01557071
015580*    MAP LAYOUT                                                 * 01558071
015590*---------------------------------------------------------------* 01559071
015600                                                                  01560071
015610     COPY PCKM701.                                                01561071
015620                                                                  01562071
015630 01  MR-OCCURS-LAYOUT                   REDEFINES  PC701AO.       01563071
015640     05  FILLER                         PIC X(315).               01564071
015650     05  MR-SCROLL-AREA                 OCCURS 10 TIMES.          01565071
015660         10  MR-SELECTL                 PIC S9(04) COMP.          01566071
015670         10  MR-SELECTA                 PIC  X(01).               01567071
015680         10  MR-SELECTC                 PIC  X(01).               01568071
015690         10  MR-SELECTH                 PIC  X(01).               01569071
015700         10  MR-SELECTI                 PIC  X(01).               01570071
015710                                                                  01571071
015720         10  MR-ACTIONL                 PIC S9(04) COMP.          01572071
015730         10  MR-ACTIONA                 PIC  X(01).               01573071
015740         10  MR-ACTIONC                 PIC  X(01).               01574071
015750         10  MR-ACTIONH                 PIC  X(01).               01575071
015760         10  MR-ACTION                  PIC  X(01).               01576071
015770                                                                  01577071
015780         10  MR-PO-LINEL                PIC S9(04) COMP.          01578071
015790         10  MR-PO-LINEA                PIC  X(01).               01579071
015800         10  MR-PO-LINEC                PIC  X(01).               01580071
015810         10  MR-PO-LINEH                PIC  X(01).               01581071
015820         10  MR-PO-LINE                 PIC  Z(04).               01582071
015830                                                                  01583071
015840         10  MR-SKUL                    PIC S9(04) COMP.          01584071
015850         10  MR-SKUA                    PIC  X(01).               01585071
015860         10  MR-SKUC                    PIC  X(01).               01586071
015870         10  MR-SKUH                    PIC  X(01).               01587071
015880         10  MR-SKU                     PIC  X(08).               01588071
015890                                                                  01589071
015900         10  MR-CARTON-CNTL             PIC S9(04) COMP.          01590071
015910         10  MR-CARTON-CNTA             PIC  X(01).               01591071
015920         10  MR-CARTON-CNTC             PIC  X(01).               01592071
015930         10  MR-CARTON-CNTH             PIC  X(01).               01593071
015940         10  MR-CARTON-CNT              PIC  Z(04).               01594071
015950                                                                  01595071
015960         10  MR-OUTER-PACKL             PIC S9(04) COMP.          01596071
015970         10  MR-OUTER-PACKA             PIC  X(01).               01597071
015980         10  MR-OUTER-PACKC             PIC  X(01).               01598071
015990         10  MR-OUTER-PACKH             PIC  X(01).               01599071
016000         10  MR-OUTER-PACK              PIC  X(04).               01600071
016010                                                                  01601071
016020         10  MR-INNER-PACKL             PIC S9(04) COMP.          01602071
016030         10  MR-INNER-PACKA             PIC  X(01).               01603071
016040         10  MR-INNER-PACKC             PIC  X(01).               01604071
016050         10  MR-INNER-PACKH             PIC  X(01).               01605071
016060         10  MR-INNER-PACK              PIC  Z(04).               01606071
016070                                                                  01607071
016080         10  MR-MODL                    PIC S9(04) COMP.          01608071
016090         10  MR-MODA                    PIC  X(01).               01609071
016100         10  MR-MODC                    PIC  X(01).               01610071
016110         10  MR-MODH                    PIC  X(01).               01611071
016120         10  MR-MOD                     PIC  Z(03).               01612071
016130                                                                  01613071
016140         10  MR-CRE-LBL-OPTL            PIC S9(04) COMP.          01614071
016150         10  MR-CRE-LBL-OPTA            PIC  X(01).               01615071
016160         10  MR-CRE-LBL-OPTC            PIC  X(01).               01616071
016170         10  MR-CRE-LBL-OPTH            PIC  X(01).               01617071
016180         10  MR-CRE-LBL-OPT             PIC  X(01).               01618071
016190                                                                  01619071
016200         10  MR-LBL-TYPEL               PIC S9(04) COMP.          01620071
016210         10  MR-LBL-TYPEA               PIC  X(01).               01621071
016220         10  MR-LBL-TYPEC               PIC  X(01).               01622071
016230         10  MR-LBL-TYPEH               PIC  X(01).               01623071
016240         10  MR-LBL-TYPE                PIC  X(01).               01624071
016250                                                                  01625071
016260         10  MR-IN-PCK-CONVYL           PIC S9(04) COMP.          01626071
016270         10  MR-IN-PCK-CONVYA           PIC  X(01).               01627071
016280         10  MR-IN-PCK-CONVYC           PIC  X(01).               01628071
016290         10  MR-IN-PCK-CONVYH           PIC  X(01).               01629071
016300         10  MR-IN-PCK-CONVY            PIC  X(01).               01630071
016310                                                                  01631071
016320         10  MR-ODD-CARTONL             PIC S9(04) COMP.          01632071
016330         10  MR-ODD-CARTONA             PIC  X(01).               01633071
016340         10  MR-ODD-CARTONC             PIC  X(01).               01634071
016350         10  MR-ODD-CARTONH             PIC  X(01).               01635071
016360         10  MR-ODD-CARTON              PIC  Z(02).               01636071
016370                                                                  01637071
016380         10  MR-CSEPK-AREAL             PIC S9(04) COMP.          01638071
016390         10  MR-CSEPK-AREAA             PIC  X(01).               01639071
016400         10  MR-CSEPK-AREAC             PIC  X(01).               01640071
016410         10  MR-CSEPK-AREAH             PIC  X(01).               01641071
016420         10  MR-CSEPK-AREA              PIC  X(06).               01642071
016430                                                                  01643071
016440         10  MR-PROCESS-QTYL            PIC S9(04) COMP.          01644071
016450         10  MR-PROCESS-QTYA            PIC  X(01).               01645071
016460         10  MR-PROCESS-QTYC            PIC  X(01).               01646071
016470         10  MR-PROCESS-QTYH            PIC  X(01).               01647071
016480         10  MR-PROCESS-QTY             PIC  ZZZZ9.               01648071
016490                                                                  01649071
016500         10  MR-TRANSCRIB-QTYL          PIC S9(04) COMP.          01650071
016510         10  MR-TRANSCRIB-QTYA          PIC  X(01).               01651071
016520         10  MR-TRANSCRIB-QTYC          PIC  X(01).               01652071
016530         10  MR-TRANSCRIB-QTYH          PIC  X(01).               01653071
016540         10  MR-TRANSCRIB-QTY           PIC  ZZZZ9.               01654071
016550                                                                  01655071
016560         10  MR-P2L-LBL-CNTL            PIC S9(04) COMP.          01656071
016570         10  MR-P2L-LBL-CNTA            PIC  X(01).               01657071
016580         10  MR-P2L-LBL-CNTC            PIC  X(01).               01658071
016590         10  MR-P2L-LBL-CNTH            PIC  X(01).               01659071
016600         10  MR-P2L-LBL-CNT             PIC  ZZZ9.                01660071
016610                                                                  01661071
016620         10  MR-SHP-LBL-CNTL            PIC S9(04) COMP.          01662071
016630         10  MR-SHP-LBL-CNTA            PIC  X(01).               01663071
016640         10  MR-SHP-LBL-CNTC            PIC  X(01).               01664071
016650         10  MR-SHP-LBL-CNTH            PIC  X(01).               01665071
016660         10  MR-SHP-LBL-CNT             PIC  ZZZ9.                01666071
016670                                                                  01667071
016680         10  MR-LINE-STATUSL            PIC S9(04) COMP.          01668071
016690         10  MR-LINE-STATUSA            PIC  X(01).               01669071
016700         10  MR-LINE-STATUSC            PIC  X(01).               01670071
016710         10  MR-LINE-STATUSH            PIC  X(01).               01671071
016720         10  MR-LINE-STATUS             PIC  X(04).               01672071
016730                                                                  01673071
016740     05  FILLER                         PIC  X(12).               01674071
016750                                                                  01675071
016760*---------------------------------------------------------------* 01676071
016770*    ATTRIBUTE SETTINGS COPYBOOK.                               * 01677071
016780*---------------------------------------------------------------* 01678071
016790                                                                  01679071
016800     COPY DPWS015.                                                01680071
016810                                                                  01681071
016820*---------------------------------------------------------------* 01682071
016830*    FUNCTION KEYS COPYBOOK.                                    * 01683071
016840*---------------------------------------------------------------* 01684071
016850                                                                  01685071
016860     COPY DPWS016.                                                01686071
016870                                                                  01687071
016880*---------------------------------------------------------------* 01688071
016890*    NUMERIC EDIT LAYOUT.                                       * 01689071
016900*---------------------------------------------------------------* 01690071
016910                                                                  01691071
016920     COPY DPWS010I.                                               01692071
016930                                                                  01693071
016940*----------------------------------------------------------------*01694071
016950*  SENDING/RECEIVING AREA FOR THE                                *01695071
016960*  PRINTER VALIDATION ROUTING (DPKCS060)                         *01696071
016970*----------------------------------------------------------------*01697071
016980     COPY DPWS072.                                                01698071
016990                                                                  01699071
017000                                                                  01700071
017010*---------------------------------------------------------------* 01701071
017020*    PARAMETERS FOR CALLING CICS ARCHITECTURE API (DPKCS030).   * 01702071
017030*---------------------------------------------------------------* 01703071
017040     COPY DPWS030.                                                01704071
017050     COPY DPWS930.                                                01705071
017060                                                                  01706071
017070                                                                  01707071
017080*---------------------------------------------------------------* 01708071
017090*  RECORD LAYOUTS FOR THE TROUBLE CREATION ROUTINE                01709071
017100*---------------------------------------------------------------* 01710071
017110     COPY TMWS500.                                                01711071
017120                                                                  01712071
017130                                                                  01713071
017140*---------------------------------------------------------------* 01714071
017150*  DISTRIBUTION RECORD LAYOUTS FOR RECORDS BEING SENT FROM        01715071
017160*  THE MAINFRAME TO THE QNX BOX DRIVING THE PACK TO LIGHT         01716071
017170*  SYSTEM.  THIS LAYOUT IS BEING USED FOR THE DOWNLOAD TO         01717071
017180*  OUR WINCHESTER & MENOMONEE FALLS FACILITIES. (4 DIGIT STORE)   01718071
017190*  DMH 7/01/04                                                    01719071
017200*---------------------------------------------------------------* 01720071
017210     COPY PCWS053.                                                01721071
017220                                                                  01722071
017230                                                                  01723071
017240*---------------------------------------------------------------* 01724071
017250*  RECORD LAYOUTS FOR THE RECEIVING AUDIT ROUTINE                 01725071
017260*---------------------------------------------------------------* 01726071
017270     COPY RCWS031.                                                01727071
017280                                                                  01728071
017290                                                                  01729071
017300*---------------------------------------------------------------* 01730071
017310*  HEADER RECORD LAYOUT FOR THE DISTRIBUTION REQUEST ON THE       01731071
017320*  QNX BOX DRIVING THE PACK TO LIGHT SYSTEM.                      01732071
017330*  MENO FALLS & WINCHESTER FACILITIES                             01733071
017340*---------------------------------------------------------------* 01734071
017350     COPY PCWS002.                                                01735071
017360                                                                  01736071
017370                                                                  01737071
017380*---------------------------------------------------------------* 01738071
017390*    STANDARD COMMAREA.                                         * 01739071
017400*---------------------------------------------------------------* 01740071
017410     COPY DPWS020.                                                01741071
017420     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01742071
017430                                                                  01743071
017440*---------------------------------------------------------------* 01744071
017450* INTER-APPLICATION COMMAREA.                                   * 01745071
017460*   PCWS120 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 01746071
017470*             SPEC SCREEN.                                      * 01747071
017480*   PCWS122 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 01748071
017490*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 01749071
017500*   RCWS012 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 01750071
017510*             THIS LIST PROGRAMMING FOR A TRBLLIST FUNCTION.    * 01751071
017520*   RCWS800 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 01752071
017530*             THIS LIST PROGRAMMING FOR A PKDTLST FUNCTION.     * 01753071
017540*   PCWS000 -                                                   * 01754071
017550*                                                               * 01755071
017560*   SUWS003 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 01756071
017570*             THIS LIST PROGRAMMING FOR A CRTNASGN FUNCTION.    * 01757071
017580*   RCWS815 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 01758071
017590*             THIS LIST PROGRAMMING FROM RCVNG SIMPLIFICATION  *  01759071
017600*---------------------------------------------------------------* 01760071
017610                                                                  01761071
017620         10  INTER-APPL-COMM-AREA       PIC X(200).               01762071
017630     COPY PCWS120.                                                01763071
017640     COPY PCWS122.                                                01764071
017650     COPY RCWS012.                                                01765071
017660     COPY PCWS000.                                                01766071
017670     COPY RCWS015.                                                01767071
017680     COPY RCWS800.                                                01768071
017690     COPY SUWS003.                                                01769071
017700     COPY RCWS815.                                                01770071
017710*---------------------------------------------------------------* 01771071
017720*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 01772071
017730*---------------------------------------------------------------* 01773071
017740         10  ASC-SPECIFIC-COMMAREA.                               01774071
017750             15  ASC-PO-NBR                   PIC S9(09) COMP.    01775071
017760             15  ASC-REC-SEQ-NBR              PIC S9(09) COMP.    01776071
017770             15  ASC-OPER-UNT-ID              PIC S9(04) COMP.    01777071
017780                 88  ASC-MENOMONEE-FALLS-DC       VALUE  85.      01778071
017790                 88  ASC-TEST-AT-CORPORATE-DC     VALUE  90.      01779071
017800                 88  ASC-FINDLAY-DC               VALUE 810.      01780071
017810                 88  ASC-WINCHESTER-DC            VALUE 830.      01781071
017820             15  ASC-FCLTY-ID                 PIC S9(04) COMP.    01782071
017830             15  ASC-CURR-OPER-UNT-ID         PIC S9(04) COMP.    01783071
017840             15  ASC-CURR-FCLTY-ID            PIC S9(04) COMP.    01784071
017850             15  ASC-SML-P2L-PRTR-ID          PIC  X(08).         01785071
017860                 88  ASC-DO-NOT-PRINT-SML         VALUE 'NL'.     01786071
017870             15  ASC-SML-P2L-PRTR-ID-N REDEFINES                  01787071
017880                 ASC-SML-P2L-PRTR-ID          PIC  9(08).         01788071
017890             15  FILLER  REDEFINES  ASC-SML-P2L-PRTR-ID.          01789071
017900                 20  FILLER                   PIC  X(05).         01790071
017910                 20  ASC-SML-P2L-PRTR-ID-3    PIC  X(03).         01791071
017920             15  ASC-PGYBCK-PRTR-ID           PIC  X(08).         01792071
017930                 88  ASC-DO-NOT-PRINT-PGYBK       VALUE 'NL'.     01793071
017940             15  ASC-PGYBCK-PRTR-ID-N  REDEFINES                  01794071
017950                 ASC-PGYBCK-PRTR-ID           PIC  9(08).         01795071
017960             15  ASC-MODU-NBR                 PIC S9(04).         01796071
017970             15  ASC-DFLT-STR-ZN-ID           PIC  X(05).         01797071
017980             15  ASC-CART-CNT                 PIC S9(09) COMP.    01798071
017990             15  ASC-INPK-UNT-QTY             PIC S9(04) COMP.    01799071
018000             15  ASC-OTPK-UNT-QTY             PIC S9(04) COMP.    01800071
018010             15  ASC-CRE-LBL-IND              PIC  X(01).         01801071
018020                 88  ASC-CRE-BOTH-LBL             VALUE 'B'.      01802071
018030                 88  ASC-CRE-P2L-LBL              VALUE 'P'.      01803071
018040                 88  ASC-CRE-SML-LBL              VALUE 'C'.      01804071
018050             15  ASC-LBL-PRT-ORDER            PIC  X(01).         01805071
018060                 88  ASC-LBL-PRT-SHUFFLED         VALUE 'S'.      01806071
018070                 88  ASC-LBL-PRT-STR-ORD          VALUE 'R'.      01807071
018080                 88  ASC-LBL-PRT-DOOR-SEQ         VALUE 'D'.      01808071
018090             15  ASC-SPEC-INST-DESC           PIC  X(05).         01809071
018100             15  ASC-PO-LINE-NBR              PIC S9(04) COMP.    01810071
018110             15  ASC-CONFIRM-TROUBLE-SW       PIC  X(01).         01811071
018120                 88  ASC-CONFIRM-IGNORE       VALUE 'I'.          01812071
018130                 88  ASC-CONFIRM-IGNORE-NO    VALUE 'U'.          01813071
018140                 88  ASC-CONFIRM-DELETE       VALUE 'D'.          01814071
018150                 88  ASC-CONFIRM-TROUBLE-YES  VALUE 'Y'.          01815071
018160                 88  ASC-CONFIRM-TROUBLE-NO   VALUE 'N' ' '.      01816071
018170                 88  ASC-CONFIRM-DELETE-NO    VALUE ' '.          01817071
018180             15  ASC-PO-RCVR-DOWNLOAD-SW      PIC  X(01).         01818071
018190                 88  ASC-PO-RCVR-DWNLD-P2L-Y  VALUE 'Y'.          01819071
018200                 88  ASC-PO-RCVR-DWNLD-P2L-N  VALUE 'N'.          01820071
018210             15  ASC-PO-RCVR-TROUBLE-SW       PIC  X(01).         01821071
018220                 88  ASC-PO-RCVR-TROUBLE-YES  VALUE 'Y'.          01822071
018230                 88  ASC-PO-RCVR-TROUBLE-NO   VALUE 'N'.          01823071
018240             15  ASC-INVALID-INPK-SW          PIC  X(01).         01824071
018250                 88  ASC-INVALID-INPK-YES     VALUE 'Y'.          01825071
018260                 88  ASC-VALID-INPK-YES       VALUE 'N'.          01826071
018270             15  ASC-INVALID-OTPK-SW          PIC  X(01).         01827071
018280                 88  ASC-INVALID-OTPK-ODD     VALUE 'O'.          01828071
018290                 88  ASC-INVALID-OTPK-YES     VALUE 'Y'.          01829071
018300                 88  ASC-VALID-OTPK-YES       VALUE 'N'.          01830071
018310                 88  ASC-INVALID-DV-RTV-OTPK  VALUE 'D'.          01831071
018320             15  ASC-INVALID-PREPK-CSTK-SW    PIC  X(01).         01832071
018330                 88  ASC-INVALID-PREPK-CSTK-Y VALUE 'Y'.          01833071
018340                 88  ASC-INVALID-PREPK-CSTK-N VALUE 'N'.          01834071
018350                 88  ASC-INVALID-PREPK-E-COMM VALUE 'E'.          01835071
018360             15  ASC-DPT-NBR                  PIC  X(03).         01836071
018370             15  ASC-SEASET-SHRT-NME          PIC  X(05).         01837071
018380             15  ASC-INHOUSE-VNDR-NBR         PIC S9(03) COMP-3.  01838071
018390             15  ASC-P2L-SRVR-IP-ADDR         PIC  X(15).         01839071
018400                                                                  01840071
018410             15  ASC-BLK-SUB                  PIC S9(04)  COMP    01841071
018420                                                          SYNC.   01842071
018430             15  ASC-ITEM-SUB                 PIC S9(04)  COMP    01843071
018440                                                          SYNC.   01844071
018450             15  ASC-SEL-SUB                  PIC S9(4)   COMP.   01845071
018460             15  ASC-SEL-ITEM                 PIC S9(4)   COMP.   01846071
018470             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09)  COMP.   01847071
018480             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09)  COMP.   01848071
018490             15  ASC-ITEMS-DISPLAYED          PIC S9(03)  COMP.   01849071
018500             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09)  COMP.   01850071
018510             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09)  COMP.   01851071
018520             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04)  COMP    01852071
018530                                                          SYNC.   01853071
018540             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09)  COMP.   01854071
018550             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09)  COMP.   01855071
018560             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         01856071
018570                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   01857071
018580                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   01858071
018590             15  ASC-LIST-QUEUE-NAME.                             01859071
018600                 20  ASC-LIST-TERM-ID         PIC  X(04).         01860071
018610                 20  ASC-LIST-TASK-NUMBER     PIC S9(05)  COMP-3. 01861071
018620                 20  ASC-LIST-SEQ             PIC  9(01).         01862071
018630             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09)  COMP-3. 01863071
018640             15  ASC-SEL-QUEUE-NAME.                              01864071
018650                 20  ASC-SEL-TERM-ID          PIC  X(04).         01865071
018660                 20  ASC-SEL-TASK-NUMBER      PIC S9(05)  COMP-3. 01866071
018670                 20  ASC-SEL-SEQ              PIC  9(01).         01867071
018680                                                                  01868071
018690             15  ASC-PREV-SEL-QUEUE-NAME      PIC  X(08).         01869071
018700             15  ASC-SEL-QUEUE-NAME-LST       PIC  X(08).         01870071
018710             15  ASC-CURSOR-SW                PIC  X(01).         01871071
018720                 88  ASC-PO-ALL-LN-CSR               VALUE 'A'.   01872071
018730                 88  ASC-PO-ONE-LN-CSR               VALUE 'O'.   01873071
018740                 88  ASC-PRE-PACK-CSR                VALUE 'P'.   01874071
018750             15  ASC-START-ITEM-REQUEST.                          01875071
018760                 20  ASC-START-ITEM-REQUEST-N PIC 9(05).          01876071
018770             15  ASC-USE-SELECTION-QUEUE-IND  PIC X(1).           01877071
018780                 88  ASC-USE-SELECTION-QUEUE         VALUE 'Y'.   01878071
018790             15  ASC-SELECTION-QUEUE-SW       PIC X(1).           01879071
018800                 88  ASC-TROUBLE-QUEUE               VALUE 'Y'.   01880071
018810                 88  ASC-DISTRO-QUEUE                VALUE 'D'.   01881071
018820                 88  ASC-PREPK-QUEUE                 VALUE 'P'.   01882071
018830                 88  ASC-OTHER-QUEUE                 VALUE 'N'.   01883071
018840                 88  ASC-CARTON-QUEUE                VALUE 'C'.   01884071
018850             15  ASC-FCSE-AREA-ID             PIC X(06).          01885071
018860             15  ASC-PRT-HEAD-FOOT            PIC X(01).          01886071
018870                 88  ASC-YES-HEAD-FOOT               VALUE 'Y'.   01887071
018880                 88  ASC-NO-HEAD-FOOT                VALUE 'N'.   01888071
018890             15  ASC-DC-PRTD-AT               PIC X(02).          01889071
018900             15  ASC-PKGNG-CD                 PIC X(01).          01890071
018910                 88  ASC-PRE-PACK-ORDER           VALUE 'I', 'M'. 01891071
018920                 88  ASC-INNER-PREPK              VALUE 'I'.      01892071
018930                 88  ASC-MULTI-SKU-PREPK          VALUE 'M'.      01893071
018940                 88  ASC-SINGLE-SKU-PREPK         VALUE 'S'.      01894071
018950                 88  ASC-CASEPACK                 VALUE 'C'.      01895071
018960                 88  ASC-BULK-PACK                VALUE 'B'.      01896071
018970             15  ASC-DSPLY-PKGNG-CD           PIC X(01).          01897071
018980                 88  ASC-DSP-PRE-PACK-ORDER       VALUE 'I', 'M'. 01898071
018990                 88  ASC-DSP-INNER-PREPK          VALUE 'I'.      01899071
019000                 88  ASC-DSP-MULTI-SKU-PREPK      VALUE 'M'.      01900071
019010                 88  ASC-DSP-SINGLE-SKU-PREPK     VALUE 'S'.      01901071
019020                 88  ASC-DSP-CASEPACK             VALUE 'C'.      01902071
019030                 88  ASC-DSP-BULK-PACK            VALUE 'B'.      01903071
019040             15  ASC-UCC128-AVAIL-IND         PIC X(01).          01904071
019050                 88  ASC-UCC128-AVAIL-YES         VALUE 'Y'.      01905071
019060                 88  ASC-UCC128-AVAIL-NO          VALUE 'N'.      01906071
019070             15  ASC-USE-UCC128-IND           PIC X(01).          01907071
019080                 88  ASC-USE-UCC128-YES           VALUE 'Y'.      01908071
019090                 88  ASC-USE-UCC128-NO            VALUE 'N'.      01909071
019100                 88  ASC-USE-UCC128-IGNORE        VALUE 'I'.      01910071
019110             15  ASC-UCC128-ERROR-SW          PIC  X(01).         01911071
019120                 88  ASC-UCC128-ERROR-NO      VALUE 'A'.          01912071
019130                 88  ASC-UCC128-MLT-LNE-YES   VALUE 'B'.          01913071
019140                 88  ASC-UCC128-DWNLD-YES     VALUE 'C'.          01914071
019150                 88  ASC-UCC128-PREPK-RATIO   VALUE 'D'.          01915071
019160             15  ASC-2ND-CONFIRM-DEL-SW       PIC X(01).          01916071
019170                 88  ASC-2ND-CONFIRM-DEL      VALUE 'D'.          01917071
019180                 88  ASC-2ND-CONFIRM-DEL-NO   VALUE ' '.          01918071
019190             15  ASC-2ND-CONFIRM-NEEDED-SW    PIC X(01).          01919071
019200                 88  ASC-2ND-CONFIRM-NEED     VALUE 'Y'.          01920071
019210                 88  ASC-2ND-CONFIRM-NEED-NO  VALUE 'N'.          01921071
019220                 88  ASC-2ND-CONFIRM-UNKNOWN  VALUE ' '.          01922071
019230             15  ASC-AUTOVE-PARM-SW           PIC  X(01).         01923071
019240                 88  ASC-AUTOVE-PARM-YES      VALUE  'Y'.         01924071
019250                 88  ASC-AUTOVE-PARM-NO       VALUE  'N'.         01925071
019260             15  ASC-IGNR-UCC128-AUTH-SW      PIC  X(01).         01926071
019270                 88  ASC-IGNR-UCC128-AUTH-YES VALUE  'Y'.         01927071
019280                 88  ASC-IGNR-UCC128-AUTH-NO  VALUE  'N'.         01928071
019290             15  ASC-DC-INTERFC-LABOR-SW      PIC  X(01).         01929071
019300                 88  ASC-DC-INTERFC-LABOR-YES      VALUE  'Y'.    01930071
019310                 88  ASC-DC-INTERFC-LABOR-NO       VALUE  'N'.    01931071
019320             15  ASC-ASSOC-LABOR-ASGMT-SW     PIC  X(01).         01932071
019330                 88  ASC-ASSOC-LABOR-ASGMT-YES     VALUE  'Y'.    01933071
019340                 88  ASC-ASSOC-LABOR-ASGMT-NO      VALUE  'N'.    01934071
019350             15  ASC-P2L-PCC-DOWNLOAD-SW      PIC  X(01).         01935071
019360                 88  ASC-P2L-PCC-DOWNLOAD-YES      VALUE  'Y'.    01936071
019370                 88  ASC-P2L-PCC-DOWNLOAD-NO       VALUE  'N'.    01937071
019380             15  ASC-P2L-AL-DOWNLOAD-SW       PIC  X(01).         01938071
019390                 88  ASC-P2L-AL-DOWNLOAD-YES       VALUE  'Y'.    01939071
019400                 88  ASC-P2L-AL-DOWNLOAD-NO        VALUE  'N'.    01940071
019500             15  ASC-RECLAIM-DC-SW            PIC  X(01).         01950071
019510                 88  ASC-RECLAIM-DC-YES            VALUE 'Y'.     01951071
019520                 88  ASC-RECLAIM-DC-NO             VALUE 'N'.     01952071
019530             15  ASC-CHECK-FOR-MULT-ASGMT-SW  PIC  X(01).         01953071
019540                 88  ASC-CHECK-FOR-MULT-ASGMT      VALUE 'Y'.     01954071
019550                 88  ASC-CHECK-FOR-MULT-ASGMT-NO   VALUE 'N'.     01955071
019560             15  ASC-TRIP-ARRIVE-DATE        PIC  X(10).          01956071
019570             15  ASC-TRIP-ARRIVE-DATE-R                           01957071
019580                 REDEFINES ASC-TRIP-ARRIVE-DATE.                  01958071
019590                 20  ASC-TRIP-ARRIVE-CCYY    PIC  X(04).          01959071
019600                 20  ASC-TRIP-ARRIVE-DASH1   PIC  X(01).          01960071
019601                 20  ASC-TRIP-ARRIVE-MM      PIC  X(02).          01960171
019602                 20  ASC-TRIP-ARRIVE-DASH2   PIC  X(01).          01960271
019603                 20  ASC-TRIP-ARRIVE-DD      PIC  X(02).          01960371
019604             15  ASC-AUTO-CONVEY-LVL-SW       PIC  X(03).         01960471
019605                 88  ASC-AUTO-CONVEY-NO-CRTNS      VALUE 'NNE'.   01960571
019606                 88  ASC-AUTO-CONVEY-EXCPT-CRTNS   VALUE 'EXC'.   01960671
019607                 88  ASC-AUTO-CONVEY-ALL-CRTNS     VALUE 'ALL'.   01960771
019608             15  ASC-HAZ-FACILITY-SW          PIC  X(01).         01960871
019609                 88  ASC-HAZ-FACILITY-YES          VALUE 'Y'.     01960971
019610                 88  ASC-HAZ-FACILITY-NO           VALUE 'N'.     01961071
019611             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                01961171
019612                                                                  01961271
019613                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  01961371
019614                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   01961471
019615                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   01961571
019616                                                                  01961671
019617                 20  ASC-ITEM-ARRAY.                              01961771
019618                     25  ASC-ITEM-ENTRIES OCCURS 10 TIMES.        01961871
019619                         30  ASC-LIST-ITEM-NUMBER                 01961971
019620                                                     PIC S9(09)   01962071
019630                                                     COMP.        01963071
019640                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  01964071
019650                             88  ASC-VALID-SELECT    VALUE ' '    01965071
019660                                                           'S'    01966071
019670                                                           'B'    01967071
019680                                                           'E'.   01968071
019690                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   01969071
019700                             88  ASC-TEMP-SELECT     VALUE 'S'.   01970071
019710                             88  ASC-TEMP-BEGIN      VALUE 'B'.   01971071
019720                             88  ASC-TEMP-END        VALUE 'E'.   01972071
019730                         30  ASC-SELECTED-SW         PIC  X(01).  01973071
019740                             88  ASC-NO-SELECT       VALUE ' '.   01974071
019750                             88  ASC-SELECT          VALUE 'S'.   01975071
019760                             88  ASC-BEGIN           VALUE 'B'.   01976071
019770                             88  ASC-END             VALUE 'E'.   01977071
019780                         30  ASC-ACTION              PIC  X(01).  01978071
019790                             88  ASC-DEL  VALUE 'D'.              01979071
019800                             88  ASC-INQ  VALUE 'I'.              01980071
019810                             88  ASC-UPD  VALUE 'U'.              01981071
019820                             88  ASC-ERR  VALUE 'E'.              01982071
019830                         30  ASC-PO-LNE-NBR-X.                    01983071
019840                             35  ASC-PO-LNE-NBR      PIC  9(04).  01984071
019850                         30  ASC-SKU                 PIC  9(08)   01985071
019860                                                          COMP.   01986071
019870                         30  ASC-MODULE-X.                        01987071
019880                             35  ASC-MODULE          PIC  9(03).  01988071
019890                         30  ASC-CARTON-COUNT-X.                  01989071
019900                             35  ASC-CARTON-COUNT    PIC  9(04).  01990071
019910                         30  ASC-INNER-PACK-QTY-X.                01991071
019920                             35  ASC-INNER-PACK-QTY  PIC  9(04).  01992071
019930                         30  ASc-OUTER-PACK-QTY-X.                01993071
019940                             88  ASC-MLT-OTPK-UCC128 VALUE 'MLT '.01994071
019950                             35  ASC-OUTER-PACK-QTY  PIC  9(04).  01995071
019960                         30  ASC-IN-PAK-CONVEY       PIC  X(01).  01996071
019970                             88  ASC-IN-PAK-CONVEY-NO  VALUE 'N'. 01997071
019980                             88  ASC-IN-PAK-CONVEY-YES VALUE 'Y'. 01998071
019990                             88  ASC-IN-PAK-CNVY-VALID VALUE      01999071
020000                                                     'Y' 'N'.     02000071
020010                         30  ASC-LBL-TYP             PIC  X(01).  02001071
020020                             88  ASC-LBL-TYP-VALID   VALUE        02002071
020030                                        'N' 'P' 'S' 'U' 'X'.      02003071
020040                             88  ASC-LBL-TYP-P2L-VALID VALUE      02004071
020050                                                     'N' 'U' 'X'. 02005071
020060                             88  ASC-LBL-TYP-PGYBK   VALUE 'P'.   02006071
020070                             88  ASC-LBL-TYP-SML     VALUE 'S'.   02007071
020080                             88  ASC-LBL-TYP-NONE    VALUE 'N'.   02008071
020090                             88  ASC-LBL-TYP-UCC128  VALUE 'U'.   02009071
020100                             88  ASC-SHUFFLED-SML    VALUE 'S'.   02010071
020110                             88  ASC-STORE-SML       VALUE 'R'.   02011071
020120                             88  ASC-DOOR-SML        VALUE 'D'.   02012071
020130                             88  ASC-STORE-PGYBK     VALUE 'P'.   02013071
020140                             88  ASC-LNE-DO-NOT-PRT-LBL           02014071
020150                                                     VALUE 'X'.   02015071
020160                         30  ASC-PROCESS-QTY         PIC  9(05)   02016071
020170                                                     COMP-3.      02017071
020180                         30  ASC-TRANSCRIBE-QTY      PIC  9(05)   02018071
020190                                                     COMP-3.      02019071
020200                         30  ASC-P2L-LABEL-CNT       PIC  9(04)   02020071
020210                                                     COMP.        02021071
020220                         30  ASC-SML-LABEL-CNT       PIC  9(04)   02022071
020230                                                     COMP.        02023071
020240                         30  ASC-SML-FCSE-LBL-CNT    PIC  9(04)   02024071
020250                                                     COMP.        02025071
020260                         30  ASC-SML-INPK-LBL-CNT    PIC  9(04)   02026071
020270                                                     COMP.        02027071
020280                         30  ASC-LINE-STATUS         PIC  X(04).  02028071
020290                         30  ASC-DISPLAY-STORE-CNT   PIC 9(04)    02029071
020300                                                     COMP.        02030071
020310                         30  ASC-DISPLAY-ITM-QTY     PIC 9(04)    02031071
020320                                                     COMP.        02032071
020330                         30  ASC-EXPTD-ITM-QTY       PIC 9(08)    02033071
020340                                                     COMP.        02034071
020350                         30  ASC-LNE-CRE-LBL-OPT     PIC X(01).   02035071
020360                             88 ASC-LNE-CRE-LBL-OPT-VALID         02036071
020370                                              VALUE 'P' 'B' 'C'.  02037071
020380                             88 ASC-LNE-CRE-P2L-LBL  VALUE 'P'.   02038071
020390                             88 ASC-LNE-CRE-BOTH-LBL VALUE 'B'.   02039071
020400                             88 ASC-LNE-CRE-SML-LBL  VALUE 'C'.   02040071
020410                         30  ASC-LNE-FCSE-AREA       PIC X(06).   02041071
020420                         30  ASC-ODD-CARTON-X.                    02042071
020430                             35  ASC-ODD-CARTON      PIC 9(02).   02043071
020440                         30  ASC-P2L-DIVERT-CDE      PIC X(04).   02044071
020450                         30  ASC-SOCKET-NBR          PIC 9(01).   02045071
020460                         30  ASC-RESEND-P2L-SW       PIC X(01).   02046071
020470                             88  ASC-RESEND-P2L-NO   VALUE 'N'.   02047071
020480                             88  ASC-RESEND-P2L-YES  VALUE 'Y'.   02048071
020490                         30  ASC-P2L-HILITE-SW       PIC X(01).   02049071
020500                             88  ASC-P2L-RESEND-HILITE-NO         02050071
020510                                                     VALUE 'N'.   02051071
020520                             88  ASC-P2L-RESEND-HILITE-YES        02052071
020530                                                     VALUE 'Y'.   02053071
020540                         30  ASC-ODD-CRTN-USE-SW     PIC  X(01).  02054071
020550                             88  ASC-ODD-CRTN-FCSE   VALUE 'F'.   02055071
020560                             88  ASC-ODD-CRTN-INPK   VALUE 'I'.   02056071
020570                             88  ASC-ODD-CRTN-P2L    VALUE 'P'.   02057071
020580                             88  ASC-ODD-CRTN-NONE   VALUE 'N'.   02058071
020590                         30  ASC-FCSE-ODD-USED-SW    PIC  X(01).  02059071
020600                             88  ASC-FCSE-ODD-CRTN-NOT-USED       02060071
020610                                                     VALUE 'N'.   02061071
020620                             88  ASC-FCSE-ODD-CRTN-USED           02062071
020630                                                     VALUE 'Y'.   02063071
020640                         30  ASC-INPK-ODD-USED-SW    PIC  X(01).  02064071
020650                             88  ASC-INPK-ODD-CRTN-NOT-USED       02065071
020660                                                     VALUE 'N'.   02066071
020670                             88  ASC-INPK-ODD-CTRN-USED           02067071
020680                                                     VALUE 'Y'.   02068071
020690                         30  ASC-TBL-INPK-QTY        PIC  9(04)   02069071
020700                                                     COMP-3.      02070071
020710                         30  ASC-UPDATE-SW           PIC  X(01).  02071071
020720                             88  ASC-NO-UPDATE       VALUE 'N'.   02072071
020730                             88  ASC-UPDATE-OK       VALUE 'Y'.   02073071
020740                         30  ASC-CRE-LBL-UPDATE      PIC  X(01).  02074071
020750                             88  ASC-CRE-LBL-NO-UPDT VALUE 'N'.   02075071
020760                             88  ASC-CRE-LBL-UPDT    VALUE 'Y'.   02076071
020770                                                                  02077071
020780                         30  ASC-LINE-ERROR-SW       PIC  X(01).  02078071
020790                             88  ASC-NO-LINE-ERROR   VALUE ' '.   02079071
020800                             88  ASC-QTY-ERROR-YES   VALUE 'A'.   02080071
020810                             88  ASC-TROUBLE-ERROR   VALUE 'B'.   02081071
020820                             88  ASC-DOWNLOADED      VALUE 'C'.   02082071
020830                             88  ASC-DISTRO-ERROR    VALUE 'D'.   02083071
020840                             88  ASC-LNE-TROUBLE-YES VALUE 'E'.   02084071
020850                             88  ASC-LNE-BAD-INPK-Y  VALUE 'F'.   02085071
020860                             88  ASC-LNE-BAD-OTPK-Y  VALUE 'G'.   02086071
020870                             88  ASC-LNE-BAD-ODD-Y   VALUE 'H'.   02087071
020880                             88  ASC-PREPK-CNTL-STK  VALUE 'I'.   02088071
020890                             88  ASC-PREPK-E-COMM    VALUE 'J'.   02089071
020900                             88  ASC-LNE-DC-RTV-OTPK VALUE 'K'.   02090071
020910                                                                  02091071
020920                                                                  02092071
020930                         30  ASC-PROTECT-SW          PIC  X(01).  02093071
020940                             88  ASC-PROTECTED       VALUE 'Y'.   02094071
020950                             88  ASC-NOT-PROTECTED   VALUE 'N'.   02095071
020960                         30  ASC-P2L-DOWNLOADED-SW   PIC  X(01).  02096071
020970                             88  ASC-LNE-DOWNLOADED-YES VALUE 'Y'.02097071
020980                             88  ASC-LNE-DOWNLOADED-NO  VALUE 'N'.02098071
020990                         30  ASC-PPC-EXISTS-SW       PIC  X(01).  02099071
021000                             88  ASC-PPC-EXISTS         VALUE 'Y'.02100071
021010                             88  ASC-NOT-PPC-EXISTS     VALUE 'N'.02101071
021020                         30  ASC-HILITE-SW     PIC  X(01).        02102071
021030                             88  ASC-HILITE-LNE-ST      VALUE 'Y'.02103071
021040                             88  ASC-NOT-HILITE-LNE-ST  VALUE 'N'.02104071
021050                         30  ASC-CS-BOUND-UNTS       PIC  9(09)   02105071
021060                                                     COMP.        02106071
021070                         30  ASC-DC-BOUND-UNTS       PIC  9(09)   02107071
021080                                                     COMP.        02108071
021090                         30  ASC-RTV-BOUND-UNTS      PIC  9(09)   02109071
021100                                                     COMP.        02110071
021110                         30  ASC-CS-BOUND-CTNS       PIC  9(09)   02111071
021120                                                     COMP.        02112071
021130                         30  ASC-PREPK-ID            PIC S9(04)   02113071
021140                                                     COMP.        02114071
021150                         30  ASC-PREPK-RATIO         PIC S9(04)   02115071
021160                                                     COMP.        02116071
021170                         30  ASC-PACKS-IN-CRTN       PIC S9(04)   02117071
021180                                                     COMP.        02118071
021190                         30  ASC-LNE-UCC128-DATA-IND PIC  X(01).  02119071
021200                             88  ASC-LNE-UCC128-YES     VALUE 'Y'.02120071
021210                             88  ASC-LNE-UCC128-NO      VALUE 'N'.02121071
021220                             88  ASC-LNE-UCC128-IGNORE  VALUE 'I'.02122071
021230                         30  ASC-LNE-UCC128-ERROR    PIC  X(01).  02123071
021240                             88  ASC-LNE-UCC128-CRTN-MLT-LNES     02124071
021250                                                     VALUE 'A'.   02125071
021260                         30  ASC-P2L-VENDOR          PIC  X(01).  02126071
021270                             88  ASC-P2L-DYNAPACK  VALUE 'D' ' '. 02127071
021280                             88  ASC-P2L-PCC       VALUE 'L'.     02128071
021290                             88  ASC-P2L-THEOPACK  VALUE 'T'.     02129071
021300                         30  ASC-ITM-NBR             PIC 9(15)    02130071
021310                                                         comp.    02131071
021320                         30  ASC-HAZ-CODE            PIC X(03).   02132071
021330                         30  ASC-CLASS               PIC X(02).   02133071
021340                         30  ASC-SUBCLASS            PIC X(02).   02134071
021350                         30  ASC-UCC128-USABLE-DATA  PIC  X(01).  02135071
021360                             88  ASC-UCC128-USABLE-YES            02136071
021370                                                  VALUE 'Y'.      02137071
021380                             88  ASC-UCC128-USABLE-NO             02138071
021390                                                  VALUE 'N'.      02139071
021400                         30  ASC-P2L-ALS-VC-SW       PIC  X(01).  02140071
021410                             88  ASC-P2L-ALS-3-DIGIT-STR          02141071
021420                                                  VALUE '3'.      02142071
021430                             88  ASC-P2L-ALS-4-DIGIT-STR          02143071
021440                                                  VALUE '4'.      02144071
021450                                                                  02145071
021460             15  ASC-P2L-ZONE                        PIC X(02).   02146071
021470                 88 ASC-COMMODITY                      VALUE 'CM'.02147071
021480                 88 ASC-HANG-FOLD                      VALUE 'HF'.02148071
021490                 88 ASC-HANG-COMMODITY                 VALUE 'HC'.02149071
021500             15  ASC-HANGER-IND                      PIC X(01).   02150071
021510                 88 ASC-HANGER-AGREEMENT               VALUE 'Y'. 02151071
021520             15  ASC-SEASET-HIGHLIGHT-SW      PIC  X(01).         02152071
021521                 88  ASC-SEASET-YELLOW               VALUE 'Y'.   02152171
021522                 88  ASC-SEASET-BLUE                 VALUE ' '.   02152271
021523             15  FILLER                              PIC X(80).   02152371
021524                                                                  02152471
021525*---------------------------------------------------------------* 02152571
021526*    ABEND PROCESSING COPYBOOK.                                 * 02152671
021527*---------------------------------------------------------------* 02152771
021528                                                                  02152871
021529     COPY DPWS013.                                                02152971
021530                                                                  02153071
021540                                                                  02154071
021550*---------------------------------------------------------------* 02155071
021560*                                                                 02156071
021570*---------------------------------------------------------------* 02157071
021580 01  PT-MSG-TABLE.                                                02158071
021590     05  PT-MESSAGES OCCURS 20 TIMES INDEXED BY PT-MSG-IDX.       02159071
021600         10  PT-MSG.                                              02160071
021700             15 PT-MESSAGE               PIC X(52).               02170071
021710             15 FILLER                   PIC X(2).                02171071
021720             15 PT-TASK                  PIC 9(07).               02172071
021730                                                                  02173071
021740                                                                  02174071
021750*---------------------------------------------------------------* 02175071
021760*    RC - TROUBLE NOTIFICATION TABLE                            * 02176071
021770*---------------------------------------------------------------* 02177071
021780     EXEC SQL                                                     02178071
021790          INCLUDE TTRBNTF                                         02179071
021800     END-EXEC.                                                    02180071
021810                                                                  02181071
021820*---------------------------------------------------------------* 02182071
021830*    RC - TROUBLE REASON CODES TABLE                            * 02183071
021840*---------------------------------------------------------------* 02184071
021850     EXEC SQL                                                     02185071
021860          INCLUDE TTRBRSN                                         02186071
021870     END-EXEC.                                                    02187071
021880                                                                  02188071
021890*---------------------------------------------------------------* 02189071
021900*    RC - TROUBLE REASON PROGRAM TABLE                          * 02190071
021910*---------------------------------------------------------------* 02191071
021920     EXEC SQL                                                     02192071
021930          INCLUDE TTRBRCN                                         02193071
021940     END-EXEC.                                                    02194071
021950                                                                  02195071
021960*-----------------------------------------------------------------02196071
021970*  SQL AND COBOL DECLARATIONS FOR THE RECEIVER TABLE (TRECEIV)    02197071
021980*-----------------------------------------------------------------02198071
021990     EXEC SQL                                                     02199071
022000          INCLUDE TRECEIV                                         02200071
022010     END-EXEC.                                                    02201071
022020                                                                  02202071
022030                                                                  02203071
022040*---------------------------------------------------------------* 02204071
022050*    RC - RECEIPT ITEM TABLE                                    * 02205071
022060*---------------------------------------------------------------* 02206071
022070     EXEC SQL                                                     02207071
022080          INCLUDE TRECITM                                         02208071
022090     END-EXEC.                                                    02209071
022100                                                                  02210071
022110*---------------------------------------------------------------* 02211071
022120*    PO - PURCHASE ITEM TABLE                                   * 02212071
022130*---------------------------------------------------------------* 02213071
022140     EXEC SQL                                                     02214071
022150          INCLUDE TPURITM                                         02215071
022160     END-EXEC.                                                    02216071
022170                                                                  02217071
022180*---------------------------------------------------------------* 02218071
022190*    PO - PURCHASE ORDER TABLE                                  * 02219071
022200*---------------------------------------------------------------* 02220071
022210     EXEC SQL                                                     02221071
022220          INCLUDE TPURCHS                                         02222071
022230     END-EXEC.                                                    02223071
022240                                                                  02224071
022250*---------------------------------------------------------------* 02225071
022260*    RC-RECEIPT DISTRIBUTION                                    * 02226071
022270*---------------------------------------------------------------* 02227071
022280     EXEC SQL                                                     02228071
022290          INCLUDE TRECDIS                                         02229071
022300     END-EXEC.                                                    02230071
022310                                                                  02231071
022320*---------------------------------------------------------------* 02232071
022330*    EX-VENDOR DEPARTMENT (EXTERNAL ENTERPRISE)                 * 02233071
022340*---------------------------------------------------------------* 02234071
022350     EXEC SQL                                                     02235071
022360          INCLUDE TVNDDPT                                         02236071
022370     END-EXEC.                                                    02237071
022380                                                                  02238071
022390*---------------------------------------------------------------* 02239071
022400*      -SKU TABLE                                               * 02240071
022410*---------------------------------------------------------------* 02241071
022420     EXEC SQL                                                     02242071
022430          INCLUDE TSK                                             02243071
022440     END-EXEC.                                                    02244071
022450                                                                  02245071
022460*---------------------------------------------------------------* 02246071
022470*    DC-DISTRIBUTION TRANSACTION HEADER                         * 02247071
022480*---------------------------------------------------------------* 02248071
022490     EXEC SQL                                                     02249071
022500          INCLUDE TDISTHD                                         02250071
022510     END-EXEC.                                                    02251071
022520                                                                  02252071
022530*---------------------------------------------------------------* 02253071
022540*    DC-DISTRIBUTION TRANSACTION DETAIL                         * 02254071
022550*---------------------------------------------------------------* 02255071
022560     EXEC SQL                                                     02256071
022570          INCLUDE TDISTDT                                         02257071
022580     END-EXEC.                                                    02258071
022590                                                                  02259071
022600*----------------------------------------------------------------*02260071
022610*  DCLGEN LAYOUT AND COBOL DECLARATION FOR LOGISTICS DOMAIN       02261071
022620*  LOCATION MASTER TABLE (XLT_LOC)                                02262071
022630*----------------------------------------------------------------*02263071
022640     EXEC SQL                                                     02264071
022650          INCLUDE xlt00010                                        02265071
022660     END-EXEC.                                                    02266071
022670                                                                  02267071
022680                                                                  02268071
022690*-----------------------------------------------------------------02269071
022700*  SQL AND COBOL DECLARATIONS FOR THE PC-PACK-TO-LIGHT MODULE     02270071
022710*-----------------------------------------------------------------02271071
022720     EXEC SQL                                                     02272071
022730          INCLUDE TP2LMOD                                         02273071
022740     END-EXEC.                                                    02274071
022750                                                                  02275071
022760                                                                  02276071
022770*---------------------------------------------------------------* 02277071
022780*    DB2 AREA FOR TSHIPMT - SHIPMENT TABLE                      * 02278071
022790*---------------------------------------------------------------* 02279071
022800     EXEC SQL                                                     02280071
022900          INCLUDE TSHIPMT                                         02290071
023000     END-EXEC.                                                    02300071
023100                                                                  02310071
023110                                                                  02311071
023120*---------------------------------------------------------------* 02312071
023130*    DB2 AREA FOR TSHPTPO - SHIPMENT PO TABLE                   * 02313071
023140*---------------------------------------------------------------* 02314071
023150     EXEC SQL                                                     02315071
023160          INCLUDE TSHPTPO                                         02316071
023170     END-EXEC.                                                    02317071
023180                                                                  02318071
023190                                                                  02319071
023200*---------------------------------------------------------------* 02320071
023210*    DB2 AREA FOR TFLAREA - FACILITY AREA TABLE                 * 02321071
023220*---------------------------------------------------------------* 02322071
023230     EXEC SQL                                                     02323071
023240          INCLUDE TFLAREA                                         02324071
023250     END-EXEC.                                                    02325071
023260                                                                  02326071
023270                                                                  02327071
023280*---------------------------------------------------------------* 02328071
023290*    DB2 AREA FOR TENTNME - EX-EXTERNAL ENTERPRISE NAME         * 02329071
023300*---------------------------------------------------------------* 02330071
023310     EXEC SQL                                                     02331071
023320          INCLUDE TENTNME                                         02332071
023330     END-EXEC.                                                    02333071
023340                                                                  02334071
023350                                                                  02335071
023360*---------------------------------------------------------------* 02336071
023370*    DB2 AREA FOR TCOCNTL - COMPANY CONTROL TABLE               * 02337071
023380*---------------------------------------------------------------* 02338071
023390     EXEC SQL                                                     02339071
023400          INCLUDE TCOCNTL                                         02340071
023410     END-EXEC.                                                    02341071
023420                                                                  02342071
023430                                                                  02343071
023440*---------------------------------------------------------------* 02344071
023450*  TPKSLIP - RC-PACK SLIP TABLE                                 * 02345071
023460*---------------------------------------------------------------* 02346071
023470     EXEC SQL                                                     02347071
023480          INCLUDE TPKSLIP                                         02348071
023490     END-EXEC.                                                    02349071
023500                                                                  02350071
023510                                                                  02351071
023520*---------------------------------------------------------------* 02352071
023530*  TINPKSU - SU-INBOUND EDI PACKLIST/VENDOR SHIPMENT UNIT ASSOC * 02353071
023540*---------------------------------------------------------------* 02354071
023550     EXEC SQL                                                     02355071
023560          INCLUDE TINPKSU                                         02356071
023570     END-EXEC.                                                    02357071
023580                                                                  02358071
023590                                                                  02359071
023600*---------------------------------------------------------------* 02360071
023610*  TSHUUPC -  SU-SHIPMENT UNIT/UPC ASSOCIATION                  * 02361071
023620*---------------------------------------------------------------* 02362071
023630     EXEC SQL                                                     02363071
023640          INCLUDE TSHUUPC                                         02364071
023650     END-EXEC.                                                    02365071
023660                                                                  02366071
023670                                                                  02367071
023680*================================================================*02368071
023690* SU-VIRTUAL LABEL DATA                                          *02369071
023700*================================================================*02370071
023710     EXEC SQL                                                     02371071
023720          INCLUDE TLBVRDA                                         02372071
023730     END-EXEC.                                                    02373071
023740                                                                  02374071
023750*================================================================*02375071
023760* SU-LABEL CROSS REFERENCE                                       *02376071
023770*================================================================*02377071
023780     EXEC SQL                                                     02378071
023790          INCLUDE TSULBXF                                         02379071
023800     END-EXEC.                                                    02380071
023810                                                                  02381071
023820*================================================================*02382071
023830*   -PARAMETER TABLE                                              02383071
023840*================================================================*02384071
023850     EXEC SQL                                                     02385071
023860          INCLUDE TKRPRPM                                         02386071
023870     END-EXEC.                                                    02387071
023880                                                                  02388071
023890*----------------------------------------------------------------*02389071
023900*  DCLGEN FOR RIT_RFID_VRFN                                       02390071
023910*----------------------------------------------------------------*02391071
023920     EXEC SQL                                                     02392071
023930         INCLUDE RIT00000                                         02393071
023940     END-EXEC.                                                    02394071
023950                                                                  02395071
023960*---------------------------------------------------------------* 02396071
023970*================================================================*02397071
023971*   -SHIPPING UNIT TABLE                                          02397171
023972*================================================================*02397271
023973     EXEC SQL                                                     02397371
023974          INCLUDE TSHPUNT                                         02397471
023975     END-EXEC.                                                    02397571
023976                                                                  02397671
023977*================================================================*02397771
023978*   -CARTON DIVERT TABLE                                          02397871
023979*================================================================*02397971
023980     EXEC SQL                                                     02398071
023990          INCLUDE TSUCRDV                                         02399071
024000     END-EXEC.                                                    02400071
024010                                                                  02401071
024020*================================================================*02402071
024030*   -SHIPPING UNIT LOCATION TABLE                                 02403071
024040*================================================================*02404071
024050     EXEC SQL                                                     02405071
024060          INCLUDE TSHUNLO                                         02406071
024070     END-EXEC.                                                    02407071
024080                                                                  02408071
024090*================================================================*02409071
024100*   -OUTBOUND SHIPPING UNIT LOCATION TABLE (SUT_OTBND_LOC)        02410071
024110*================================================================*02411071
024120     EXEC SQL                                                     02412071
024130          INCLUDE SUT00027                                        02413071
024140     END-EXEC.                                                    02414071
024150                                                                  02415071
024160*================================================================*02416071
024170*   -OUTBOUND SHIPT UNIT TABLE (SUT_OTBND_CART)                   02417071
024180*================================================================*02418071
024190     EXEC SQL                                                     02419071
024200          INCLUDE SUT00024                                        02420071
024210     END-EXEC.                                                    02421071
024220                                                                  02422071
024230*================================================================*02423071
024240*   -OUTBOUND SHIPT UNIT UPC TABLE (SUT_OTBND_UPC)                02424071
024250*================================================================*02425071
024260     EXEC SQL                                                     02426071
024270          INCLUDE SUT00028                                        02427071
024280     END-EXEC.                                                    02428071
024290                                                                  02429071
024300*-----------------------------------------------------------------02430071
024310*  SQL AND COBOL DECLARATIONS FOR THE MB-MERCHANDISE AREA TABLE   02431071
024320*-----------------------------------------------------------------02432071
024330     EXEC SQL                                                     02433071
024340          INCLUDE TMDSEAR                                         02434071
024350     END-EXEC.                                                    02435071
024360                                                                  02436071
024370                                                                  02437071
024380*-----------------------------------------------------------------02438071
024390*  SQL AND COBOL DECLARATIONS FOR THE MB-MERCHANDISE DEPT TABLE   02439071
024400*-----------------------------------------------------------------02440071
024410     EXEC SQL                                                     02441071
024420          INCLUDE TMDSEDP                                         02442071
024430     END-EXEC.                                                    02443071
024440                                                                  02444071
024450                                                                  02445071
024460*================================================================*02446071
024470*   -SEASONAL SET                                                 02447071
024480*================================================================*02448071
024490     EXEC SQL                                                     02449071
024500          INCLUDE TSEASET                                         02450071
024510     END-EXEC.                                                    02451071
024520                                                                  02452071
024530*================================================================*02453071
024540*   - INBOUND TRIP DOOR TABLE      (SUT_INBD_TRIP_DOOR)           02454071
024550*================================================================*02455071
024560     EXEC SQL                                                     02456071
024570          INCLUDE SUT00040                                        02457071
024580     END-EXEC.                                                    02458071
024590                                                                  02459071
024600*================================================================*02460071
024610*   - VH TRIP                      (TVHTRIP)                      02461071
024620*================================================================*02462071
024630     EXEC SQL                                                     02463071
024640          INCLUDE TVHTRIP                                         02464071
024650     END-EXEC.                                                    02465071
024660                                                                  02466071
024670*================================================================*02467071
024680*   - TRIP STATUS                  (TRIPST)                       02468071
024690*================================================================*02469071
024700     EXEC SQL                                                     02470071
024710          INCLUDE TTRIPST                                         02471071
024720     END-EXEC.                                                    02472071
024730                                                                  02473071
024740* JAK 04/2007 - ADD WST00008/9/10                                 02474071
024750***************************************************************** 02475071
024760*  SQL AND COBOL DECLARATIONS FOR WST_INTGRTN_TYP                 02476071
024770***************************************************************** 02477071
024780     EXEC SQL                                                     02478071
024790          INCLUDE WST00008                                        02479071
024800     END-EXEC.                                                    02480071
024810***************************************************************** 02481071
024820*  SQL AND COBOL DECLARATIONS FOR WST_ATTR_DEFN                   02482071
024830***************************************************************** 02483071
024840     EXEC SQL                                                     02484071
024850          INCLUDE WST00009                                        02485071
024860     END-EXEC.                                                    02486071
024870***************************************************************** 02487071
024880*  SQL AND COBOL DECLARATIONS FOR WST_ATTR_ELEM                   02488071
024890***************************************************************** 02489071
024891     EXEC SQL                                                     02489171
024892          INCLUDE WST00010                                        02489271
024893     END-EXEC.                                                    02489371
024894                                                                  02489471
024895*---------------------------------------------------------------* 02489571
024896*  TUPLDER - UPLOAD ERROR TABLE                                 * 02489671
024897*---------------------------------------------------------------* 02489771
024898     EXEC SQL                                                     02489871
024899          INCLUDE TUPLDER                                         02489971
024900     END-EXEC.                                                    02490071
024901                                                                  02490171
024902*---------------------------------------------------------------* 02490271
024903*  DLT_ASGMT - LABOR ASSIGNMENT TABLE                           * 02490371
024904*---------------------------------------------------------------* 02490471
024905     EXEC SQL                                                     02490571
024906          INCLUDE DLT00004                                        02490671
024907     END-EXEC.                                                    02490771
024908                                                                  02490871
024909*---------------------------------------------------------------* 02490971
024910*  DLT_TEM_ASGMT - LABOR TEAM ASSIGNMENT TABLE                 *  02491071
024911*---------------------------------------------------------------* 02491171
024912     EXEC SQL                                                     02491271
024913          INCLUDE DLT00003                                        02491371
024914     END-EXEC.                                                    02491471
024915                                                                  02491571
024916*---------------------------------------------------------------* 02491671
024917*  XLT_SKU                                                     *  02491771
024918*---------------------------------------------------------------* 02491871
024919     EXEC SQL                                                     02491971
024920          INCLUDE XLT00003                                        02492071
024921     END-EXEC.                                                    02492171
024922                                                                  02492271
024923*---------------------------------------------------------------* 02492371
024924*  XLT_VND_STYL                                                *  02492471
024925*---------------------------------------------------------------* 02492571
024926     EXEC SQL                                                     02492671
024927          INCLUDE XLT00004                                        02492771
024928     END-EXEC.                                                    02492871
024929                                                                  02492971
024930*---------------------------------------------------------------* 02493071
024931*  XLT_HAZDS_MTRL_SKU                                          *  02493171
024932*---------------------------------------------------------------* 02493271
024933     EXEC SQL                                                     02493371
024934          INCLUDE XLT00042                                        02493471
024935     END-EXEC.                                                    02493571
024936                                                                  02493671
024937*---------------------------------------------------------------* 02493771
024938*    DB2 AREA FOR COMMUNICATIONS                                * 02493871
024939*---------------------------------------------------------------* 02493971
024940     EXEC SQL                                                     02494071
024941          INCLUDE SQLCA                                           02494171
024942     END-EXEC.                                                    02494271
024943                                                                  02494371
024944                                                                  02494471
024945*---------------------------------------------------------------* 02494571
024946*   PO/RECEIVER CURSOR PULLS ALL "LINES" OF THE PO              * 02494671
024947*---------------------------------------------------------------* 02494771
024948     EXEC SQL                                                     02494871
024949          DECLARE PO_ALL_LN_CSR CURSOR FOR                        02494971
024950              SELECT A.ORD_LNE_NBR                                02495071
024951                    ,A.INNR_PACK_QTY                              02495171
024952                    ,A.OPER_UNT_ID                                02495271
024953                    ,A.FCLTY_ID                                   02495371
024954                    ,B.SKU_SEQ_NBR                                02495471
024955                    ,A.STATUS_CDE                                 02495571
024956                    ,A.PKSL_ITM_QTY                               02495671
024957                    ,A.DTL_CK_ITM_QTY                             02495771
024958                    ,A.PREPK_ID                                   02495871
024959                    ,A.CASE_PACK_QTY                              02495971
024960                    ,B.ITM_NBR                                    02496071
024970                FROM TRECITM A                                    02497071
024980                    ,TPURITM B                                    02498071
024990               WHERE A.ORD_NBR           = :ASC-PO-NBR            02499071
025000                 AND A.REC_SEQ_NBR       = :ASC-REC-SEQ-NBR       02500071
025010                 AND A.ORD_NBR           = B.PO_NBR               02501071
025020                 AND A.ORD_LNE_NBR       = B.APP_PO_LNE_NBR       02502071
025030                 AND A.VER_STATUS_CDE    = 'A'                    02503071
025040                 AND A.PO_VER_NBR        = B.VER_NBR              02504071
025050          ORDER BY                                                02505071
025060                A.ORD_LNE_NBR                                     02506071
025070     END-EXEC.                                                    02507071
025080                                                                  02508071
025090                                                                  02509071
025100*---------------------------------------------------------------* 02510071
025110*   PO/RECEIVER CURSOR ONLY LINE SPECIFIED                      * 02511071
025120*---------------------------------------------------------------* 02512071
025130     EXEC SQL                                                     02513071
025140          DECLARE PO_ONE_LN_CSR CURSOR FOR                        02514071
025150              SELECT A.ORD_LNE_NBR                                02515071
025160                    ,A.INNR_PACK_QTY                              02516071
025170                    ,A.OPER_UNT_ID                                02517071
025180                    ,A.FCLTY_ID                                   02518071
025190                    ,B.SKU_SEQ_NBR                                02519071
025200                    ,A.STATUS_CDE                                 02520071
025210                    ,A.PKSL_ITM_QTY                               02521071
025220                    ,A.DTL_CK_ITM_QTY                             02522071
025230                    ,A.PREPK_ID                                   02523071
025240                    ,A.CASE_PACK_QTY                              02524071
025250                    ,B.ITM_NBR                                    02525071
025260                FROM TRECITM A                                    02526071
025270                    ,TPURITM B                                    02527071
025280               WHERE A.ORD_NBR           = :ASC-PO-NBR            02528071
025290                 AND A.REC_SEQ_NBR       = :ASC-REC-SEQ-NBR       02529071
025300                 AND A.ORD_LNE_NBR       = :ASC-PO-LINE-NBR       02530071
025310                 AND A.ORD_NBR           = B.PO_NBR               02531071
025320                 AND A.ORD_LNE_NBR       = B.APP_PO_LNE_NBR       02532071
025330                 AND A.VER_STATUS_CDE    = 'A'                    02533071
025340                 AND A.PO_VER_NBR        = B.VER_NBR              02534071
025350          ORDER BY                                                02535071
025360                A.ORD_LNE_NBR                                     02536071
025370     END-EXEC.                                                    02537071
025380                                                                  02538071
025390                                                                  02539071
025400*---------------------------------------------------------------* 02540071
025410* PO/RECEIVER CURSOR PULLS ALL "LINES" OF THE PO - FOR PRE-PACKS* 02541071
025420*---------------------------------------------------------------* 02542071
025430     EXEC SQL                                                     02543071
025440          DECLARE PRE_PACK_CSR CURSOR FOR                         02544071
025450              SELECT A.ORD_LNE_NBR                                02545071
025460                    ,A.INNR_PACK_QTY                              02546071
025470                    ,A.OPER_UNT_ID                                02547071
025480                    ,A.FCLTY_ID                                   02548071
025490                    ,B.SKU_SEQ_NBR                                02549071
025500                    ,A.STATUS_CDE                                 02550071
025510                    ,A.PKSL_ITM_QTY                               02551071
025520                    ,A.DTL_CK_ITM_QTY                             02552071
025530                    ,A.PREPK_ID                                   02553071
025540                    ,A.PREPK_RATO_QTY                             02554071
025550                    ,A.CASE_PACK_QTY                              02555071
025560                    ,B.ITM_NBR                                    02556071
025570                FROM TRECITM A                                    02557071
025580                    ,TPURITM B                                    02558071
025590               WHERE A.ORD_NBR           = :ASC-PO-NBR            02559071
025600                 AND A.REC_SEQ_NBR       = :ASC-REC-SEQ-NBR       02560071
025610                 AND A.ORD_NBR           = B.PO_NBR               02561071
025620                 AND A.ORD_LNE_NBR       = B.APP_PO_LNE_NBR       02562071
025630                 AND A.VER_STATUS_CDE    = 'A'                    02563071
025640                 AND A.PO_VER_NBR        = B.VER_NBR              02564071
025650                 AND A.PREPK_DRV_LNE_CDE = 'A'                    02565071
025660          ORDER BY                                                02566071
025670                A.PREPK_ID                                        02567071
025680               ,A.PREPK_RATO_QTY DESC                             02568071
025690               ,A.ORD_LNE_NBR                                     02569071
025700     END-EXEC.                                                    02570071
025710                                                                  02571071
025720                                                                  02572071
025730*---------------------------------------------------------------* 02573071
025740*   DC/RTV CURSOR                                               * 02574071
025750*---------------------------------------------------------------* 02575071
025760     EXEC SQL                                                     02576071
025770          DECLARE DC_RTV_CSR CURSOR FOR                           02577071
025780              SELECT LOC_TYP_CDE,SUM(EXPTED_ITM_QTY)              02578071
025790                FROM  TRECDIS A                                   02579071
025800                     ,XLT_LOC B                                   02580071
025810                WHERE A.ORD_NBR        = :ASC-PO-NBR              02581071
025820                  AND A.REC_SEQ_NBR    = :ASC-REC-SEQ-NBR         02582071
025830                  AND A.ORD_LNE_NBR    = :ASC-PO-LINE-NBR         02583071
025840                  AND A.STR_NBR        = B.LOC_NBR                02584071
025850                  AND A.EXPTED_ITM_QTY > 0                        02585071
025860                  AND B.LOC_TYP_CDE   IN ('DC', 'RV')             02586071
025870                GROUP BY LOC_TYP_CDE                              02587071
025880     END-EXEC.                                                    02588071
025890                                                                  02589071
025900                                                                  02590071
025910*---------------------------------------------------------------* 02591071
025920*   TRECDIS CURSOR - DETERMINE P2L & SHIP LABEL QTYS            * 02592071
025930*---------------------------------------------------------------* 02593071
025940     EXEC SQL                                                     02594071
025950          DECLARE TRECDIS_CSR CURSOR FOR                          02595071
025960              SELECT  A.STR_NBR                                   02596071
025970                     ,A.EXPTED_ITM_QTY                            02597071
025980                     ,B.LOC_TYP_CDE                               02598071
025990                FROM  TRECDIS A                                   02599071
026000                     ,XLT_LOC B                                   02600071
026010               WHERE  A.ORD_NBR        = :ASC-PO-NBR              02601071
026020                 AND  A.REC_SEQ_NBR    = :ASC-REC-SEQ-NBR         02602071
026030                 AND  A.ORD_LNE_NBR    = :ASC-PO-LINE-NBR         02603071
026040                 AND  A.EXPTED_ITM_QTY > 0                        02604071
026050                 AND  A.STR_NBR        = B.LOC_NBR                02605071
026060            GROUP BY  A.STR_NBR                                   02606071
026070                     ,A.EXPTED_ITM_QTY                            02607071
026080                     ,B.LOC_TYP_CDE                               02608071
026090     END-EXEC.                                                    02609071
026100                                                                  02610071
026110                                                                  02611071
026120*---------------------------------------------------------------* 02612071
026130*                                                               * 02613071
026140*---------------------------------------------------------------* 02614071
026150     EXEC SQL                                                     02615071
026160          DECLARE RECDIS_CURSOR CURSOR FOR                        02616071
026170              SELECT  STR_NBR,                                    02617071
026180                      EXPTED_ITM_QTY                              02618071
026190                FROM  TRECDIS B                                   02619071
026200               WHERE  (ORD_NBR           =  :DK-PO-NBR            02620071
026210                 AND   ORD_LNE_NBR       =  :DK-LINE-NBR          02621071
026220                 AND   REC_SEQ_NBR       =  :DK-REC-SEQ-NBR)      02622072
026230            ORDER BY  STR_NBR                                     02623076
026250     END-EXEC.                                                    02625071
026260                                                                  02626071
026270                                                                  02627071
026280*---------------------------------------------------------------* 02628071
026290*                                                               * 02629071
026300*---------------------------------------------------------------* 02630071
026310     EXEC SQL                                                     02631071
026320          DECLARE TSTR_CURSOR CURSOR FOR                          02632071
026330              SELECT  LOC_NBR,                                    02633071
026340                      LOC_TYP_CDE                                 02634071
026350                FROM  XLT_LOC                                     02635071
026360               WHERE  (LOC_TYP_CDE       =  'DC'                  02636071
026370                 OR    LOC_TYP_CDE       =  'RV')                 02637071
026380            ORDER BY  LOC_NBR                                     02638071
026390     END-EXEC.                                                    02639071
026400                                                                  02640071
026410                                                                  02641071
026420*---------------------------------------------------------------* 02642071
026430* THIS CURSOR IS USED ONLY FOR CREATE LABEL OPTION = B (SML/P2L)* 02643071
026440* THIS CURSOR WILL GIVE YOU THE STORES THAT HAVE QUANTITIES     * 02644071
026450* ALLOCATED TO THEM AND WILL ORDER THE STORES DO THAT THE       * 02645071
026460* CENTRAL STOCK (TYPE_CODE = 'CS') LOCATIONS ARE FIRST.         * 02646071
026470*---------------------------------------------------------------* 02647071
026480     EXEC SQL                                                     02648071
026490          DECLARE TRECDIS_TSTR_CURSR CURSOR FOR                   02649071
026500              SELECT  A.STR_NBR,                                  02650071
026510                      B.LOC_TYP_CDE,                              02651071
026520                      A.EXPTED_ITM_QTY                            02652071
026530                FROM  TRECDIS A,                                  02653071
026540                      XLT_LOC B                                   02654071
026550               WHERE  (A.ORD_NBR         =  :DK-PO-NBR            02655071
026560                 AND   A.ORD_LNE_NBR     =  :DK-LINE-NBR          02656071
026570                 AND   A.REC_SEQ_NBR     =  :DK-REC-SEQ-NBR       02657071
026580                 AND   A.STR_NBR         =  B.LOC_NBR)            02658071
026590            ORDER BY  B.LOC_TYP_CDE,                              02659071
026600                      A.STR_NBR                                   02660071
026610     END-EXEC.                                                    02661071
026620                                                                  02662071
026630                                                                  02663071
026640*---------------------------------------------------------------* 02664071
026650* THIS CURSOR IS USED ONLY FOR P2L RESEND OPTION                * 02665071
026660*---------------------------------------------------------------* 02666071
026670     EXEC SQL                                                     02667071
026680          DECLARE DISTDT_P2LRSND_CSR CURSOR FOR                   02668071
026690              SELECT  A.ORD_NBR,                                  02669071
026700                      A.RCVR_SEQ_NBR,                             02670071
026800                      A.ORD_LNE_NBR,                              02680071
026900                      A.STR_NBR,                                  02690071
027000                      A.P2L_SPLT_UNT_QTY                          02700071
027010                FROM  TDISTDT A                                   02701071
027020                     ,XLT_LOC B                                   02702071
027030               WHERE   A.ORD_NBR         =  :DK-PO-NBR            02703071
027040                 AND   A.ORD_LNE_NBR     =  :DK-LINE-NBR          02704071
027050                 AND   A.RCVR_SEQ_NBR    =  :DK-REC-SEQ-NBR       02705071
027060                 AND   A.STR_NBR         =  B.LOC_NBR             02706071
027070                 AND   LOC_TYP_CDE  NOT IN ('DC','RV')            02707071
027080            ORDER BY  A.STR_NBR                                   02708071
027090     END-EXEC.                                                    02709071
027100                                                                  02710071
027110                                                                  02711071
027120*---------------------------------------------------------------* 02712071
027130*   ODD FCSE CURSOR - DETERMINE ODD CARTON FCSE USE             * 02713071
027140*---------------------------------------------------------------* 02714071
027150     EXEC SQL                                                     02715071
027160          DECLARE ODD_FCSE_CSR CURSOR FOR                         02716071
027170              SELECT  A.STR_NBR                                   02717071
027180                     ,A.EXPTED_ITM_QTY                            02718071
027190                FROM  TRECDIS A                                   02719071
027200               WHERE  A.ORD_NBR        = :ASC-PO-NBR              02720071
027210                 AND  A.REC_SEQ_NBR    = :ASC-REC-SEQ-NBR         02721071
027220                 AND  A.ORD_LNE_NBR    = :ASC-PO-LINE-NBR         02722071
027230                 AND  A.EXPTED_ITM_QTY > :PV-ODD-CARTON-UNT-QTY   02723071
027240     END-EXEC.                                                    02724071
027250                                                                  02725071
027260                                                                  02726071
027270*---------------------------------------------------------------* 02727071
027280* PREPACK CURSOR FOR LINES FOR A SPECIFIC PULL THAT WERE NOT    * 02728071
027290* USED AS THE DRIVER/PROCESS LINE                               * 02729071
027300*---------------------------------------------------------------* 02730071
027310     EXEC SQL                                                     02731071
027320          DECLARE PRE_PACK_LNE_CSR CURSOR FOR                     02732071
027330              SELECT A.ORD_LNE_NBR                                02733071
027340                    ,A.INNR_PACK_QTY                              02734071
027350                    ,A.OPER_UNT_ID                                02735071
027360                    ,A.FCLTY_ID                                   02736071
027370                    ,A.STATUS_CDE                                 02737071
027380                    ,A.PKSL_ITM_QTY                               02738071
027390                    ,A.DTL_CK_ITM_QTY                             02739071
027400                    ,A.PREPK_ID                                   02740071
027410                    ,A.PREPK_RATO_QTY                             02741071
027420                    ,A.CASE_PACK_QTY                              02742071
027430                    ,B.ITM_NBR                                    02743071
027440                FROM TRECITM A                                    02744071
027450                    ,TPURITM B                                    02745071
027460               WHERE A.ORD_NBR           = :DK-PO-NBR             02746071
027470                 AND A.REC_SEQ_NBR       = :DK-REC-SEQ-NBR        02747071
027480                 AND A.PREPK_ID          = :DK-PREPK-ID           02748071
027490                 AND A.ORD_LNE_NBR      <> :DK-LINE-NBR           02749071
027500                 AND A.ORD_NBR           = B.PO_NBR               02750071
027510                 AND A.ORD_LNE_NBR       = B.APP_PO_LNE_NBR       02751071
027520                 AND A.VER_STATUS_CDE    = 'A'                    02752071
027530                 AND A.PO_VER_NBR        = B.VER_NBR              02753071
027540          ORDER BY                                                02754071
027550                A.ORD_LNE_NBR                                     02755071
027560     END-EXEC.                                                    02756071
027570                                                                  02757071
027580                                                                  02758071
027590*---------------------------------------------------------------* 02759071
027600* PREPACK - DELETE CURSOR                                       * 02760071
027610*---------------------------------------------------------------* 02761071
027620     EXEC SQL                                                     02762071
027630          DECLARE PRE_PACK_DEL_CSR CURSOR FOR                     02763071
027640              SELECT A.ORD_LNE_NBR                                02764071
027650                FROM TRECITM A                                    02765071
027660                    ,TPURITM B                                    02766071
027670               WHERE A.ORD_NBR          = :DK-PO-NBR              02767071
027680                 AND A.ORD_NBR          = B.PO_NBR                02768071
027690                 AND A.PREPK_ID         = :DK-PREPK-ID            02769071
027700                 AND A.ORD_LNE_NBR     <> :DK-LINE-NBR            02770071
027710                 AND A.REC_SEQ_NBR      = :DK-REC-SEQ-NBR         02771071
027720                 AND A.ORD_LNE_NBR      = B.APP_PO_LNE_NBR        02772071
027730                 AND A.VER_STATUS_CDE   = 'A'                     02773071
027740                 AND A.PO_VER_NBR       = B.VER_NBR               02774071
027750          ORDER BY                                                02775071
027760                A.ORD_LNE_NBR                                     02776071
027770     END-EXEC.                                                    02777071
027780                                                                  02778071
027790                                                                  02779071
027800*---------------------------------------------------------------* 02780071
027810* DELETE - XREF CURSOR                                          * 02781071
027820*---------------------------------------------------------------* 02782071
027830     EXEC SQL                                                     02783071
027840          DECLARE LBL_XREF_CSR CURSOR FOR                         02784071
027850              SELECT A.BRCDE_NBR                                  02785071
027860                   , A.CART_LBL_TYP_CDE                           02786071
027870                FROM TLBVRDA A                                    02787071
027880               WHERE A.PO_NBR           = :DK-PO-NBR              02788071
027890                 AND A.PO_LNE_NBR       = :DK-LINE-NBR-2          02789071
027900                 AND A.RCVR_SEQ_NBR     = :DK-REC-SEQ-NBR         02790071
027910                 AND A.PREPK_ID         = :DK-PREPK-ID            02791071
027920          ORDER BY                                                02792071
027930                A.BRCDE_NBR                                       02793071
027940     END-EXEC.                                                    02794071
027950                                                                  02795071
027960                                                                  02796071
027970*---------------------------------------------------------------* 02797071
027980* CARTON CURSON FOR SELECTING FROM SUT_OTBND_UPC                * 02798071
027990* AND UPDATING SUT_OTBND_CART.                                    02799071
028000*---------------------------------------------------------------* 02800071
028010     EXEC SQL                                                     02801071
028020          DECLARE UPDATE_CARTON_CSR CURSOR FOR                    02802071
028030              SELECT DISTINCT                                     02803071
028040                     A.SHIPT_UNT_ID                               02804071
028050              FROM  SUT_OTBND_UPC A                               02805071
028060                   ,SUT_OTBND_CART B                              02806071
028070              WHERE A.TRN_NBR      =  :DK-PO-NBR                  02807071
028080                AND A.RCVR_SEQ_NBR =  :DK-REC-SEQ-NBR             02808071
028090                AND A.TRN_LNE_NBR  =  :DK-LINE-NBR                02809071
028100                AND A.SHIPT_UNT_ID =  B.SHIPT_UNT_ID              02810071
028110                AND B.CART_SRC_CDE =   'CPS'                      02811071
028120     END-EXEC.                                                    02812071
028130                                                                  02813071
028140                                                                  02814071
028150*-----------------------------------------------------------------02815071
028160* PACK-TO-LIGHT MODULE CURSOR - THIS CURSOR WILL RETRIEVE P2L     02816071
028170* MODULES FOR A GIVEN STORE ZONE.                                 02817071
028180*-----------------------------------------------------------------02818071
028190     EXEC SQL                                                     02819071
028200          DECLARE  MODULE_CURSOR CURSOR FOR                       02820071
028210           SELECT  DISTINCT D.MODU_NBR                            02821071
028220             FROM  TP2LMOD D                                      02822071
028230            WHERE  D.OPER_UNT_ID    = :PV-OPER-UNT-ID-HOLD        02823071
028240              AND  D.DFLT_STR_ZN_ID = :ASC-DFLT-STR-ZN-ID         02824071
028250            ORDER  BY 1                                           02825071
028260     END-EXEC.                                                    02826071
028270                                                                  02827071
028280                                                                  02828071
028290*---------------------------------------------------------------* 02829071
028300                                                                  02830071
028310 LINKAGE SECTION.                                                 02831071
028320                                                                  02832071
028330 01  DFHCOMMAREA.                                                 02833071
028340     05  FILLER                         OCCURS  1 TO 4072 TIMES   02834071
028350                                        DEPENDING ON EIBCALEN.    02835071
028360         10  FILLER                     PIC X.                    02836071
028370                                                                  02837071
028380                                                                  02838071
028390 PROCEDURE DIVISION.                                              02839071
028400******************************************************************02840071
028410**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **02841071
028420**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **02842071
028430**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **02843071
028440******************************************************************02844071
028450 0000-MAIN-MODULE.                                                02845071
028460     INITIALIZE DP030-CICS-API-FIELDS.                            02846071
028470     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       02847071
028480     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          02848071
028490     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         02849071
028500     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       02850071
028510     MOVE LENGTH OF PC701AI        TO DP030-MAP-LENGTH (1).       02851071
028520     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     02852071
028530     PERFORM 0001-CALL-CICS-ARCH-API.                             02853071
028540                                                                  02854071
028550     PERFORM 1000-CONTROL-PROCESSING                              02855071
028560                                                                  02856071
028570     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     02857071
028580     PERFORM 0001-CALL-CICS-ARCH-API.                             02858071
028590                                                                  02859071
028600******************************************************************02860071
028610**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **02861071
028620**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **02862071
028630******************************************************************02863071
028640 0001-CALL-CICS-ARCH-API.                                         02864071
028650*    CALL 'DPKCS030' USING DFHEIBLK                               02865071
028660     CALL DP930-CICS-ARCH-API                                     02866071
028670                     USING DFHEIBLK                               02867071
028680                           DFHCOMMAREA                            02868071
028690                           DP030-CICS-API-FIELDS                  02869071
028700                           DP020-STANDARD-COMMAREA                02870071
028710                           PC701AI.                               02871071
028720                                                                  02872071
028730     IF  DP030-RC-CALL-SUCCESSFUL                                 02873071
028740         CONTINUE                                                 02874071
028750     ELSE                                                         02875071
028760         SET DP013-NO-ROLLBACK                                    02876071
028770             DP013-XCTL-DISPLAY-RESTART                           02877071
028780             DP013-CICS-ABEND      TO TRUE                        02878071
028790         MOVE '0001-CALL-CICS-ARCH-API'                           02879071
028800                                   TO DP013-PARAGRAPH             02880071
028810*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX02881071
028820*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      02882071
028830         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O02883071
028840-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      02884071
028850         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      02885071
028860         PERFORM DP013-0000-PROCESS-ABEND                         02886071
028870     END-IF.                                                      02887071
028880                                                                  02888071
028890                                                                  02889071
028900*----------------------------------------------------------------*02890071
028910* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *02891071
028920* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *02892071
028930*                                                                *02893071
028940* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *02894071
028950*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *02895071
028960*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *02896071
028970*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *02897071
028980*----------------------------------------------------------------*02898071
028990 1000-CONTROL-PROCESSING.                                         02899071
029000                                                                  02900071
029010     PERFORM 1050-CHECK-CSSL-DISPLAY.                             02901071
029020     PERFORM 1055-GET-SOCKET-TIMEOUT-PARM.                        02902071
029030                                                                  02903071
029040     IF  PS-DISPLAY-CSSL-YES                                      02904071
029050         INITIALIZE  PV-CICS-MSG-AREA2                            02905071
029060         MOVE DP020-SRC-TASK-NUMBER  TO  PV-DISPLAY-TASK-NBR      02906071
029070         MOVE ASC-PO-NBR             TO  PV-DISPLAY-PO-NBR        02907071
029080         MOVE ASC-REC-SEQ-NBR        TO  PV-DISPLAY-RCVR-SEQ-NBR  02908071
029090         MOVE DP020-LOCATION-NBR     TO  PV-DISPLAY-OPER          02909071
029100         EVALUATE TRUE                                            02910071
029110             WHEN DP020-NEXT-ACT-INITIAL                          02911071
029120                  MOVE 'INITIAL   '    TO  PV-DISPLAY-ACTIVITY    02912071
029130                  MOVE ZEROES          TO  PV-DISPLAY-PO-NBR      02913071
029140                                           PV-DISPLAY-RCVR-SEQ-NBR02914071
029150             WHEN DP020-NEXT-ACT-ERROR                            02915071
029160                  MOVE 'ERROR     '    TO  PV-DISPLAY-ACTIVITY    02916071
029170             WHEN DP020-NEXT-ACT-NAV-ERROR                        02917071
029180                  MOVE 'NAV-ERROR '    TO  PV-DISPLAY-ACTIVITY    02918071
029190             WHEN DP020-NEXT-ACT-APPL-ERROR                       02919071
029200                  MOVE 'APPL-ERROR'    TO  PV-DISPLAY-ACTIVITY    02920071
029210             WHEN DP020-NEXT-ACT-RETURN                           02921071
029220                  MOVE 'RETURN    '    TO  PV-DISPLAY-ACTIVITY    02922071
029230             WHEN DP020-NEXT-ACT-READ-MAP                         02923071
029240                  MOVE 'READ-MAP  '    TO  PV-DISPLAY-ACTIVITY    02924071
029250         END-EVALUATE                                             02925071
029260         EVALUATE TRUE                                            02926071
029270             WHEN DP020-SRC-AID = DP016-ENTER                     02927071
029280                  MOVE 'ENTER'    TO  PV-DISPLAY-FKEY             02928071
029290             WHEN DP020-SRC-AID = DP016-PA1                       02929071
029300                  MOVE 'PA1  '    TO  PV-DISPLAY-FKEY             02930071
029310             WHEN DP020-SRC-AID = DP016-PA2                       02931071
029320                  MOVE 'PA2  '    TO  PV-DISPLAY-FKEY             02932071
029330             WHEN DP020-SRC-AID = DP016-PA3                       02933071
029340                  MOVE 'PA3  '    TO  PV-DISPLAY-FKEY             02934071
029350             WHEN DP020-SRC-AID = DP016-CLEAR                     02935071
029360                  MOVE 'CLEAR'    TO  PV-DISPLAY-FKEY             02936071
029370             WHEN DP020-SRC-AID = DP016-PF1                       02937071
029380                  MOVE 'PF1  '    TO  PV-DISPLAY-FKEY             02938071
029390             WHEN DP020-SRC-AID = DP016-PF2                       02939071
029400                  MOVE 'PF2  '    TO  PV-DISPLAY-FKEY             02940071
029410             WHEN DP020-SRC-AID = DP016-PF3                       02941071
029420                  MOVE 'PF3  '    TO  PV-DISPLAY-FKEY             02942071
029430             WHEN DP020-SRC-AID = DP016-PF4                       02943071
029440                  MOVE 'PF4  '    TO  PV-DISPLAY-FKEY             02944071
029450             WHEN DP020-SRC-AID = DP016-PF5                       02945071
029460                  MOVE 'PF5  '    TO  PV-DISPLAY-FKEY             02946071
029470             WHEN DP020-SRC-AID = DP016-PF6                       02947071
029480                  MOVE 'PF6  '    TO  PV-DISPLAY-FKEY             02948071
029490             WHEN DP020-SRC-AID = DP016-PF7                       02949071
029500                  MOVE 'PF7  '    TO  PV-DISPLAY-FKEY             02950071
029510             WHEN DP020-SRC-AID = DP016-PF8                       02951071
029520                  MOVE 'PF8  '    TO  PV-DISPLAY-FKEY             02952071
029530             WHEN DP020-SRC-AID = DP016-PF9                       02953071
029540                  MOVE 'PF9  '    TO  PV-DISPLAY-FKEY             02954071
029550             WHEN DP020-SRC-AID = DP016-PF10                      02955071
029560                  MOVE 'PF10 '    TO  PV-DISPLAY-FKEY             02956071
029570             WHEN DP020-SRC-AID = DP016-PF11                      02957071
029580                  MOVE 'PF11 '    TO  PV-DISPLAY-FKEY             02958071
029590             WHEN DP020-SRC-AID = DP016-PF12                      02959071
029600                  MOVE 'PF12 '    TO  PV-DISPLAY-FKEY             02960071
029610             WHEN DP020-SRC-AID = DP016-PF13                      02961071
029620                  MOVE 'PF13 '    TO  PV-DISPLAY-FKEY             02962071
029630             WHEN DP020-SRC-AID = DP016-PF14                      02963071
029640                  MOVE 'PF14 '    TO  PV-DISPLAY-FKEY             02964071
029650             WHEN DP020-SRC-AID = DP016-PF15                      02965071
029660                  MOVE 'PF15 '    TO  PV-DISPLAY-FKEY             02966071
029670             WHEN DP020-SRC-AID = DP016-PF16                      02967071
029680                  MOVE 'PF16 '    TO  PV-DISPLAY-FKEY             02968071
029690             WHEN DP020-SRC-AID = DP016-PF17                      02969071
029700                  MOVE 'PF17 '    TO  PV-DISPLAY-FKEY             02970071
029710             WHEN DP020-SRC-AID = DP016-PF18                      02971071
029720                  MOVE 'PF18 '    TO  PV-DISPLAY-FKEY             02972071
029730             WHEN DP020-SRC-AID = DP016-PF19                      02973071
029740                  MOVE 'PF19 '    TO  PV-DISPLAY-FKEY             02974071
029750             WHEN DP020-SRC-AID = DP016-PF20                      02975071
029760                  MOVE 'PF20 '    TO  PV-DISPLAY-FKEY             02976071
029770             WHEN DP020-SRC-AID = DP016-PF21                      02977071
029780                  MOVE 'PF21 '    TO  PV-DISPLAY-FKEY             02978071
029790             WHEN DP020-SRC-AID = DP016-PF22                      02979071
029800                  MOVE 'PF22 '    TO  PV-DISPLAY-FKEY             02980071
029810             WHEN DP020-SRC-AID = DP016-PF23                      02981071
029820                  MOVE 'PF23 '    TO  PV-DISPLAY-FKEY             02982071
029830             WHEN DP020-SRC-AID = DP016-PF24                      02983071
029840                  MOVE 'PF24 '    TO  PV-DISPLAY-FKEY             02984071
029850         END-EVALUATE                                             02985071
029860         STRING  ' PCKCS701-'              DELIMITED BY SIZE      02986071
029870                 PV-DISPLAY-OPER           DELIMITED BY SIZE      02987071
029880                 ' TERM-'                  DELIMITED BY SIZE      02988071
029890                 DP020-TERM-ID             DELIMITED BY SIZE      02989071
029900                 ' USER-'                  DELIMITED BY SIZE      02990071
029910                 DP020-USERID              DELIMITED BY SIZE      02991071
029920                 ' TASK-'                  DELIMITED BY SIZE      02992071
029930                 PV-DISPLAY-TASK-NBR       DELIMITED BY SIZE      02993071
029940                 ' FKEY-'                  DELIMITED BY SIZE      02994071
029950                 PV-DISPLAY-FKEY           DELIMITED BY SIZE      02995071
029960                 ' ACT-'                   DELIMITED BY SIZE      02996071
029970                 PV-DISPLAY-ACTIVITY       DELIMITED BY SIZE      02997071
029980                 ' PO-'                    DELIMITED BY SIZE      02998071
029990                 PV-DISPLAY-PO-NBR         DELIMITED BY SIZE      02999071
030000                 '-'                       DELIMITED BY SIZE      03000071
030010                 PV-DISPLAY-RCVR-SEQ-NBR   DELIMITED BY SIZE      03001071
030020                                      INTO PV-CICS-MSG-AREA2      03002071
030030         MOVE LENGTH OF PV-CICS-MSG-AREA2                         03003071
030040           TO PV-COMMAREA-LENGTH                                  03004071
030050         EXEC CICS                                                03005071
030060              WRITEQ TD                                           03006071
030070               QUEUE  ('CSSL')                                    03007071
030080                FROM  (PV-CICS-MSG-AREA2)                         03008071
030090              LENGTH  (PV-COMMAREA-LENGTH)                        03009071
030100                RESP  (PV-CICS-RESP)                              03010071
030110         END-EXEC                                                 03011071
030120     END-IF                                                       03012071
030130                                                                  03013071
030140     EVALUATE TRUE                                                03014071
030150         WHEN DP020-NEXT-ACT-INITIAL                              03015071
030160             INITIALIZE ASC-SPECIFIC-COMMAREA                     03016071
030170             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            03017071
030180                                      ASC-SEL-TERM-ID             03018071
030190             MOVE DP020-SRC-TASK-NUMBER                           03019071
030200                                   TO ASC-LIST-TASK-NUMBER        03020071
030210                                      ASC-SEL-TASK-NUMBER         03021071
030220             MOVE PC-LIST-QUEUE-SEQ                               03022071
030230                                   TO ASC-LIST-SEQ                03023071
030240             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 03024071
030250             PERFORM 1100-PROCESS-INTER-APPL-COMM                 03025071
030260         IF  PS-DISPLAY-CSSL-YES                                  03026071
030270             INITIALIZE  PV-CICS-MSG-AREA2                        03027071
030280             MOVE DP020-SRC-TASK-NUMBER  TO  PV-DISPLAY-TASK-NBR  03028071
030290             MOVE ASC-PO-NBR         TO  PV-DISPLAY-PO-NBR        03029071
030300             MOVE ASC-REC-SEQ-NBR    TO  PV-DISPLAY-RCVR-SEQ-NBR  03030071
030310             EVALUATE TRUE                                        03031071
030320                 WHEN DP020-NEXT-ACT-INITIAL                      03032071
030330                      MOVE 'INITIAL   ' TO PV-DISPLAY-ACTIVITY    03033071
030340                 WHEN DP020-NEXT-ACT-ERROR                        03034071
030350                      MOVE 'ERROR     ' TO PV-DISPLAY-ACTIVITY    03035071
030360                 WHEN DP020-NEXT-ACT-NAV-ERROR                    03036071
030370                      MOVE 'NAV-ERROR ' TO PV-DISPLAY-ACTIVITY    03037071
030380                 WHEN DP020-NEXT-ACT-APPL-ERROR                   03038071
030390                      MOVE 'APPL-ERROR' TO PV-DISPLAY-ACTIVITY    03039071
030400                 WHEN DP020-NEXT-ACT-RETURN                       03040071
030410                      MOVE 'RETURN    ' TO PV-DISPLAY-ACTIVITY    03041071
030420                 WHEN DP020-NEXT-ACT-READ-MAP                     03042071
030430                      MOVE 'READ-MAP  ' TO PV-DISPLAY-ACTIVITY    03043071
030440             END-EVALUATE                                         03044071
030450             EVALUATE TRUE                                        03045071
030460                 WHEN DP020-SRC-AID = DP016-ENTER                 03046071
030470                      MOVE 'ENTER'    TO  PV-DISPLAY-FKEY         03047071
030480                 WHEN DP020-SRC-AID = DP016-PA1                   03048071
030490                      MOVE 'PA1  '    TO  PV-DISPLAY-FKEY         03049071
030500                 WHEN DP020-SRC-AID = DP016-PA2                   03050071
030510                      MOVE 'PA2  '    TO  PV-DISPLAY-FKEY         03051071
030520                 WHEN DP020-SRC-AID = DP016-PA3                   03052071
030530                      MOVE 'PA3  '    TO  PV-DISPLAY-FKEY         03053071
030540                 WHEN DP020-SRC-AID = DP016-CLEAR                 03054071
030550                      MOVE 'CLEAR'    TO  PV-DISPLAY-FKEY         03055071
030560                 WHEN DP020-SRC-AID = DP016-PF1                   03056071
030570                      MOVE 'PF1  '    TO  PV-DISPLAY-FKEY         03057071
030580                 WHEN DP020-SRC-AID = DP016-PF2                   03058071
030590                      MOVE 'PF2  '    TO  PV-DISPLAY-FKEY         03059071
030600                 WHEN DP020-SRC-AID = DP016-PF3                   03060071
030610                      MOVE 'PF3  '    TO  PV-DISPLAY-FKEY         03061071
030620                 WHEN DP020-SRC-AID = DP016-PF4                   03062071
030630                      MOVE 'PF4  '    TO  PV-DISPLAY-FKEY         03063071
030640                 WHEN DP020-SRC-AID = DP016-PF5                   03064071
030650                      MOVE 'PF5  '    TO  PV-DISPLAY-FKEY         03065071
030660                 WHEN DP020-SRC-AID = DP016-PF6                   03066071
030670                      MOVE 'PF6  '    TO  PV-DISPLAY-FKEY         03067071
030680                 WHEN DP020-SRC-AID = DP016-PF7                   03068071
030690                      MOVE 'PF7  '    TO  PV-DISPLAY-FKEY         03069071
030700                 WHEN DP020-SRC-AID = DP016-PF8                   03070071
030710                      MOVE 'PF8  '    TO  PV-DISPLAY-FKEY         03071071
030720                 WHEN DP020-SRC-AID = DP016-PF9                   03072071
030730                      MOVE 'PF9  '    TO  PV-DISPLAY-FKEY         03073071
030740                 WHEN DP020-SRC-AID = DP016-PF10                  03074071
030750                      MOVE 'PF10 '    TO  PV-DISPLAY-FKEY         03075071
030760                 WHEN DP020-SRC-AID = DP016-PF11                  03076071
030770                      MOVE 'PF11 '    TO  PV-DISPLAY-FKEY         03077071
030780                 WHEN DP020-SRC-AID = DP016-PF12                  03078071
030790                      MOVE 'PF12 '    TO  PV-DISPLAY-FKEY         03079071
030800                 WHEN DP020-SRC-AID = DP016-PF13                  03080071
030810                      MOVE 'PF13 '    TO  PV-DISPLAY-FKEY         03081071
030820                 WHEN DP020-SRC-AID = DP016-PF14                  03082071
030830                      MOVE 'PF14 '    TO  PV-DISPLAY-FKEY         03083071
030840                 WHEN DP020-SRC-AID = DP016-PF15                  03084071
030850                      MOVE 'PF15 '    TO  PV-DISPLAY-FKEY         03085071
030860                 WHEN DP020-SRC-AID = DP016-PF16                  03086071
030870                      MOVE 'PF16 '    TO  PV-DISPLAY-FKEY         03087071
030880                 WHEN DP020-SRC-AID = DP016-PF17                  03088071
030890                      MOVE 'PF17 '    TO  PV-DISPLAY-FKEY         03089071
030900                 WHEN DP020-SRC-AID = DP016-PF18                  03090071
030910                      MOVE 'PF18 '    TO  PV-DISPLAY-FKEY         03091071
030920                 WHEN DP020-SRC-AID = DP016-PF19                  03092071
030930                      MOVE 'PF19 '    TO  PV-DISPLAY-FKEY         03093071
030940                 WHEN DP020-SRC-AID = DP016-PF20                  03094071
030950                      MOVE 'PF20 '    TO  PV-DISPLAY-FKEY         03095071
030960                 WHEN DP020-SRC-AID = DP016-PF21                  03096071
030970                      MOVE 'PF21 '    TO  PV-DISPLAY-FKEY         03097071
030980                 WHEN DP020-SRC-AID = DP016-PF22                  03098071
030990                      MOVE 'PF22 '    TO  PV-DISPLAY-FKEY         03099071
031000                 WHEN DP020-SRC-AID = DP016-PF23                  03100071
031010                      MOVE 'PF23 '    TO  PV-DISPLAY-FKEY         03101071
031020                 WHEN DP020-SRC-AID = DP016-PF24                  03102071
031030                      MOVE 'PF24 '    TO  PV-DISPLAY-FKEY         03103071
031040             END-EVALUATE                                         03104071
031050             MOVE DP020-LOCATION-NBR  TO  PV-DISPLAY-OPER         03105071
031060             STRING  ' PCKCS701-'                                 03106071
031070                     PV-DISPLAY-OPER                              03107071
031080                     ' TERM-'                                     03108071
031090                     DP020-TERM-ID                                03109071
031100                     ' USER-'                                     03110071
031110                     DP020-USERID                                 03111071
031120                     ' TASK-'                                     03112071
031130                     PV-DISPLAY-TASK-NBR                          03113071
031140                     ' FKEY-'                                     03114071
031150                     PV-DISPLAY-FKEY                              03115071
031160                     ' ACT-'                                      03116071
031170                     PV-DISPLAY-ACTIVITY                          03117071
031180                     ' PO-'                                       03118071
031190                     PV-DISPLAY-PO-NBR                            03119071
031200                     '-'                                          03120071
031210                     PV-DISPLAY-RCVR-SEQ-NBR                      03121071
031220                                           DELIMITED BY SIZE      03122071
031230                                      INTO PV-CICS-MSG-AREA2      03123071
031240             MOVE LENGTH OF PV-CICS-MSG-AREA2                     03124071
031250               TO PV-COMMAREA-LENGTH                              03125071
031260             EXEC CICS                                            03126071
031270                  WRITEQ TD                                       03127071
031280                   QUEUE  ('CSSL')                                03128071
031290                    FROM  (PV-CICS-MSG-AREA2)                     03129071
031300                  LENGTH  (PV-COMMAREA-LENGTH)                    03130071
031310                    RESP  (PV-CICS-RESP)                          03131071
031320             END-EXEC                                             03132071
031330         END-IF                                                   03133071
031340***-----$TEMPLATE NOTE$-------------------------------------------03134071
031350*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,03135071
031360*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  03136071
031370*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.03137071
031380***---------------------------------------------------------------03138071
031390             IF  PS-COMMAREA-NOT-VALID                            03139071
031400                 SET DP020-NEXT-ACT-APPL-ERROR                    03140071
031410                                   TO TRUE                        03141071
031420             ELSE                                                 03142071
031430                 PERFORM 4000-BUILD-INITIAL-PANEL                 03143071
031440             END-IF                                               03144071
031450                                                                  03145071
031460         WHEN DP020-NEXT-ACT-READ-MAP                             03146071
031470             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        03147071
031480                                   TO PV-TOP-ITEM                 03148071
031490             SET PS-ANY-EDIT       TO TRUE                        03149071
031500             PERFORM 2000-PROCESS-PANEL                           03150071
031510                                                                  03151071
031520         WHEN DP020-NEXT-ACT-RETURN                               03152071
031530             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        03153071
031540                                   TO PV-TOP-ITEM                 03154071
031550             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    03155071
031560             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 03156071
031570             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 03157071
031580                                                                  03158071
031590         WHEN OTHER                                               03159071
031600             SET DP013-LOGIC-ABEND TO TRUE                        03160071
031610             SET DP013-NO-ROLLBACK TO TRUE                        03161071
031620             MOVE '1000-CONTROL-PROCESSING'                       03162071
031630                                   TO DP013-PARAGRAPH             03163071
031640             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    03164071
031650                                   TO DP013-MESSAGE-TEXT(1)       03165071
031660             PERFORM DP013-0000-PROCESS-ABEND                     03166071
031670                                                                  03167071
031680     END-EVALUATE.                                                03168071
031690                                                                  03169071
031700                                                                  03170071
031710*----------------------------------------------------------------*03171071
031720* DETERMINE PROGRAM SHOULD DISPLAY ENTRIES IN CSSL LOG SHOWING   *03172071
031730* USER ID/TASK #/FUNCTION KEY USED                                03173071
031740*----------------------------------------------------------------*03174071
031750 1050-CHECK-CSSL-DISPLAY.                                         03175071
031760                                                                  03176071
031770     MOVE DP020-LOCATION-NBR TO  DK-CORPORATE.                    03177071
031780                                                                  03178071
031790     EXEC SQL                                                     03179071
031800          SELECT  FUNC_TXT                                        03180071
031810            INTO :KRPRPM-FUNC-TXT                                 03181071
031820            FROM  TKRPRPM                                         03182071
031830           WHERE  LOC_ID            = :DK-CORPORATE               03183071
031840             AND  SYS_PRC_FUNC_CDE  = 'CSCSSL'                    03184071
031850     END-EXEC.                                                    03185071
031860                                                                  03186071
031870     EVALUATE TRUE                                                03187071
031880                                                                  03188071
031890         WHEN SQLCODE = +0                                        03189071
031900              IF  KRPRPM-FUNC-TXT  = 'Y'                          03190071
031910                  SET  PS-DISPLAY-CSSL-YES  TO  TRUE              03191071
031920              ELSE                                                03192071
031930                  SET  PS-DISPLAY-CSSL-NO   TO  TRUE              03193071
031940              END-IF                                              03194071
031950                                                                  03195071
031960         WHEN SQLCODE = +100                                      03196071
031970              SET  PS-DISPLAY-CSSL-NO       TO  TRUE              03197071
031980                                                                  03198071
031990         WHEN SQLCODE = -811                                      03199071
032000         WHEN SQLCODE = -904                                      03200071
032010         WHEN SQLCODE = -913                                      03201071
032020              MOVE SQLCODE                   TO PV-SOFT-SQLCODE   03202071
032030              MOVE '1050-CHECK-CSSL-DISPLAY' TO PV-SOFT-PARAGRAPH 03203071
032040              MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2 03204071
032050              MOVE LENGTH OF PV-CICS-MSG-AREA2                    03205071
032060                TO PV-COMMAREA-LENGTH                             03206071
032070              EXEC CICS                                           03207071
032080                   WRITEQ TD                                      03208071
032090                    QUEUE  ('CSSL')                               03209071
032100                     FROM  (PV-CICS-MSG-AREA2)                    03210071
032110                   LENGTH  (PV-COMMAREA-LENGTH)                   03211071
032120                     RESP  (PV-CICS-RESP)                         03212071
032130              END-EXEC                                            03213071
032140                                                                  03214071
032150         WHEN SQLWARN0 NOT = SPACES                               03215071
032160         WHEN SQLCODE < +0                                        03216071
032170         WHEN SQLCODE > +0                                        03217071
032180              MOVE '1050-CHECK-CSSL-DISPLAY'                      03218071
032190                                 TO DP013-PARAGRAPH               03219071
032200              MOVE 'CHECK IF SHOULD DISPLAY INFO IN CSSL'         03220071
032210                                 TO DP013-MESSAGE-TEXT (1)        03221071
032220              MOVE SQLCA         TO DP013-SQLCA                   03222071
032230              MOVE 'TKRPRPM'     TO DP013-DB2-TABLE-NAME (1)      03223071
032240              SET DP013-DB2-ABEND                                 03224071
032250                  DP013-XCTL-DISPLAY-RESTART                      03225071
032260                                 TO TRUE                          03226071
032270              PERFORM DP013-0000-PROCESS-ABEND                    03227071
032280     END-EVALUATE.                                                03228071
032290                                                                  03229071
032300                                                                  03230071
032310*----------------------------------------------------------------*03231071
032320* SELECT SOCKET TIMEOUT FROM PARAMETER DATABASE                  *03232071
032330*----------------------------------------------------------------*03233071
032340 1055-GET-SOCKET-TIMEOUT-PARM.                                    03234071
032350                                                                  03235071
032360     MOVE 90                 TO  DK-CORPORATE.                    03236071
032370                                                                  03237071
032380     EXEC SQL                                                     03238071
032390          SELECT  FUNC_QTY                                        03239071
032400            INTO :KRPRPM-FUNC-QTY                                 03240071
032410            FROM  TKRPRPM                                         03241071
032420           WHERE  LOC_ID            = :DK-CORPORATE               03242071
032430             AND  SYS_PRC_FUNC_CDE  = 'SCKTM1'                    03243071
032440             AND  FUNC_PRC_STAT_CDE = 'AC'                        03244071
032450             AND  INTFC_SYS_CDE     = 'KHL'                       03245071
032460     END-EXEC.                                                    03246071
032470                                                                  03247071
032480     EVALUATE TRUE                                                03248071
032490                                                                  03249071
032500         WHEN SQLCODE = +0                                        03250071
032510              MOVE KRPRPM-FUNC-QTY  TO  SELECT-SECS               03251071
032520                                                                  03252071
032530         WHEN SQLCODE = +100                                      03253071
032540              CONTINUE                                            03254071
032550                                                                  03255071
032560         WHEN SQLCODE = -811                                      03256071
032570         WHEN SQLCODE = -904                                      03257071
032580         WHEN SQLCODE = -913                                      03258071
032590              MOVE SQLCODE                   TO PV-SOFT-SQLCODE   03259071
032600              MOVE '1055-GET-SOCKET-TIMEOUT' TO PV-SOFT-PARAGRAPH 03260071
032610              MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2 03261071
032620              MOVE LENGTH OF PV-CICS-MSG-AREA2                    03262071
032630                TO PV-COMMAREA-LENGTH                             03263071
032640              EXEC CICS                                           03264071
032650                   WRITEQ TD                                      03265071
032660                    QUEUE  ('CSSL')                               03266071
032670                     FROM  (PV-CICS-MSG-AREA2)                    03267071
032680                   LENGTH  (PV-COMMAREA-LENGTH)                   03268071
032690                     RESP  (PV-CICS-RESP)                         03269071
032700              END-EXEC                                            03270071
032710                                                                  03271071
032720         WHEN SQLWARN0 NOT = SPACES                               03272071
032730         WHEN SQLCODE < +0                                        03273071
032740         WHEN SQLCODE > +0                                        03274071
032750              MOVE '1055-GET-SOCKET-TIMEOUT-PARM'                 03275071
032760                                 TO DP013-PARAGRAPH               03276071
032770              MOVE 'GET SOCKET TIMEOUT SECONDS VALUE    '         03277071
032780                                 TO DP013-MESSAGE-TEXT (1)        03278071
032790              MOVE SQLCA         TO DP013-SQLCA                   03279071
032800              MOVE 'TKRPRPM'     TO DP013-DB2-TABLE-NAME (1)      03280071
032810              SET DP013-DB2-ABEND                                 03281071
032820                  DP013-XCTL-DISPLAY-RESTART                      03282071
032830                                 TO TRUE                          03283071
032840              PERFORM DP013-0000-PROCESS-ABEND                    03284071
032850     END-EVALUATE.                                                03285071
032860                                                                  03286071
032870                                                                  03287071
032880                                                                  03288071
032890                                                                  03289071
032900                                                                  03290071
033000*----------------------------------------------------------------*03300071
033010* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *03301071
033020* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *03302071
033030*----------------------------------------------------------------*03303071
033040 1100-PROCESS-INTER-APPL-COMM.                                    03304071
033050                                                                  03305071
033051     SET PS-COMMAREA-VALID         TO TRUE.                       03305171
033052     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     03305271
033053     IF  DP020-INT-APPL-FORMAT-IND =  PC-CRIT-SPEC-FORMAT         03305371
033054         MOVE PC120-PO-NBR         TO ASC-PO-NBR                  03305471
033055         MOVE PC120-REC-SEQ-NBR    TO ASC-REC-SEQ-NBR             03305571
033056         MOVE PC120-OPER-UNT-ID    TO ASC-OPER-UNT-ID             03305671
033057         MOVE PC120-FCLTY-ID       TO ASC-FCLTY-ID                03305771
033058         MOVE PC120-CURR-OPER-UNT-ID                              03305871
033059                                   TO ASC-CURR-OPER-UNT-ID        03305971
033060         MOVE PC120-CURR-FCLTY-ID  TO ASC-CURR-FCLTY-ID           03306071
033070         MOVE PC120-SML-P2L-PRTR-ID                               03307071
033080                                   TO ASC-SML-P2L-PRTR-ID         03308071
033090         MOVE PC120-PGYBCK-PRTR-ID TO ASC-PGYBCK-PRTR-ID          03309071
033100         MOVE PC120-MODU-NBR       TO ASC-MODU-NBR                03310071
033110         MOVE PC120-DFLT-STR-ZN-ID TO ASC-DFLT-STR-ZN-ID          03311071
033120         MOVE PC120-CART-CNT       TO ASC-CART-CNT                03312071
033130         MOVE PC120-INPK-UNT-QTY   TO ASC-INPK-UNT-QTY            03313071
033140         MOVE PC120-OTPK-UNT-QTY   TO ASC-OTPK-UNT-QTY            03314071
033150         MOVE PC120-CRE-LBL-IND    TO ASC-CRE-LBL-IND             03315071
033160         MOVE PC120-FCSE-PROCESS-AREA                             03316071
033170                                   TO ASC-FCSE-AREA-ID            03317071
033180         MOVE PC120-PRT-HEAD-FOOT  TO ASC-PRT-HEAD-FOOT           03318071
033190         MOVE PC120-DC-PRTD-AT     TO ASC-DC-PRTD-AT              03319071
033200         MOVE PC120-PKGNG-CD       TO ASC-PKGNG-CD                03320071
033210         MOVE PC120-DSPLY-PKGNG-CD TO ASC-DSPLY-PKGNG-CD          03321071
033220         MOVE PC120-LBL-PRT-ORDER  TO ASC-LBL-PRT-ORDER           03322071
033230         MOVE PC120-SPEC-INST-DESC TO ASC-SPEC-INST-DESC          03323071
033240         MOVE PC120-PO-LINE-NBR    TO ASC-PO-LINE-NBR             03324071
033250         MOVE PC120-UCC128-DATA-AVAIL-SW                          03325071
033260                                   TO ASC-UCC128-AVAIL-IND        03326071
033270         MOVE PC120-USE-UCC128-DATA-SW                            03327071
033280                                   TO ASC-USE-UCC128-IND          03328071
033290         IF  ASC-PRE-PACK-ORDER                                   03329071
033300             SET  ASC-PRE-PACK-CSR   TO  TRUE                     03330071
033310         ELSE                                                     03331071
033320         IF  ASC-PO-LINE-NBR  > +0                                03332071
033330             SET  ASC-PO-ONE-LN-CSR  TO  TRUE                     03333071
033340         ELSE                                                     03334071
033350             SET  ASC-PO-ALL-LN-CSR  TO  TRUE                     03335071
033360         END-IF                                                   03336071
033370         END-IF                                                   03337071
033380         SET  PS-CRITERIA-CHANGE TO  TRUE                         03338071
033390         MOVE PC120-AUTOVE-DC-SW TO ASC-AUTOVE-PARM-SW            03339071
033400         MOVE PC120-TRIP-ARRIVE-DATE to  ASC-TRIP-ARRIVE-DATE     03340071
033410     END-IF.                                                      03341071
033420                                                                  03342071
033430     IF  DP020-INT-APPL-FORMAT-IND =  PC-LIST-FORMAT              03343071
033440       IF RC815-NUMBER-OF-SELECTED-ITEMS > 0                      03344071
033450                                                                  03345071
033460         MOVE RC815-OPER-UNT-ID        TO ASC-CURR-OPER-UNT-ID    03346071
033470                                          ASC-OPER-UNT-ID         03347071
033480         MOVE RC815-FCLTY-ID           TO ASC-CURR-FCLTY-ID       03348071
033490                                          ASC-FCLTY-ID            03349071
033500                                                                  03350071
033510         SET ASC-USE-SELECTION-QUEUE   TO TRUE                    03351071
033520         MOVE RC815-NUMBER-OF-TS-ITEMS TO ASC-NUMBER-OF-TS-ITEMS  03352071
033530         MOVE RC815-SEL-QUEUE-NAME     TO ASC-PREV-SEL-QUEUE-NAME 03353071
033540                                                                  03354071
033550         PERFORM 1120-PREPARE-LIST-ENTRY                          03355071
033560                                                                  03356071
033570         SET  PS-NO-CRITERIA-CHANGE    TO TRUE                    03357071
033580         MOVE  SPACE                   TO ASC-UCC128-AVAIL-IND    03358071
033590         PERFORM 4304-CHECK-UCC128-DATA                           03359071
033600                                                                  03360071
033610         IF  ASC-PRE-PACK-ORDER                                   03361071
033620             SET  ASC-PRE-PACK-CSR   TO  TRUE                     03362071
033630         ELSE                                                     03363071
033640             SET  ASC-PO-ALL-LN-CSR  TO  TRUE                     03364071
033650         END-IF                                                   03365071
033660       ELSE                                                       03366071
033670         MOVE PC-TSYMSG-00057       TO DP020-MSG-NUMBER           03367071
033680         SET  PS-COMMAREA-NOT-VALID TO TRUE                       03368071
033690       END-IF                                                     03369071
033700     END-IF.                                                      03370071
033710                                                                  03371071
033720*----------------------------------------------------------------*03372071
033730 1120-PREPARE-LIST-ENTRY.                                         03373071
033740                                                                  03374071
033750     MOVE RC816-MAX-ITEMS          TO ASC-SEL-SUB.                03375071
033760     MOVE ZERO                     TO ASC-SEL-ITEM.               03376071
033770     PERFORM 1130-GET-NEXT-RECORD.                                03377071
033780                                                                  03378071
033790*----------------------------------------------------------------*03379071
033800*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*03380071
033810*----------------------------------------------------------------*03381071
033820 1130-GET-NEXT-RECORD.                                            03382071
033830                                                                  03383071
033840     ADD +1                       TO ASC-SEL-SUB.                 03384071
033850                                                                  03385071
033860     IF  ASC-SEL-SUB > RC816-MAX-ITEMS                            03386071
033870         ADD +1                   TO ASC-SEL-ITEM                 03387071
033880         MOVE +1                  TO ASC-SEL-SUB                  03388071
033890     END-IF.                                                      03389071
033900                                                                  03390071
033910     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                03391071
033920         PERFORM 9105-READ-SEL-QUEUE-LST                          03392071
033930         IF  RC816-ITEM (ASC-SEL-SUB) > ZERO                      03393071
033940             MOVE RC816-PO-NBR     (ASC-SEL-SUB)                  03394071
033950                                       TO ASC-PO-NBR              03395071
033960             MOVE RC816-RCVR-NBR    (ASC-SEL-SUB)                 03396071
033970                                       TO ASC-REC-SEQ-NBR         03397071
033980             MOVE RC816-PKG-CODE  (ASC-SEL-SUB)                   03398071
033990                                       TO ASC-PKGNG-CD            03399071
034000                                          ASC-DSPLY-PKGNG-CD      03400071
034010                                                                  03401071
034020             SET RC816-INQ (ASC-SEL-SUB)                          03402071
034030                                  TO TRUE                         03403071
034040             PERFORM 1150-CHECK-AUTOVE-DC                         03404071
034050             PERFORM 9205-REWRITE-SEL-QUEUE-LST                   03405071
034060                                                                  03406071
034070             SET  PS-NO-CRITERIA-CHANGE TO TRUE                   03407071
034080             MOVE  SPACE                TO ASC-UCC128-AVAIL-IND   03408071
034090             PERFORM 4304-CHECK-UCC128-DATA                       03409071
034100         ELSE                                                     03410071
034110             SUBTRACT +1 FROM ASC-SEL-SUB                         03411071
034120             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             03412071
034130             SET DP020-MSG-INFORMATIONAL                          03413071
034140                 PS-LIST-END             TO TRUE                  03414071
034150         END-IF                                                   03415071
034160     ELSE                                                         03416071
034170         SUBTRACT +1 FROM ASC-SEL-ITEM                            03417071
034180         MOVE RC816-MAX-ITEMS     TO ASC-SEL-SUB                  03418071
034190         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             03419071
034200             SET DP020-MSG-INFORMATIONAL                          03420071
034210                 PS-LIST-END             TO TRUE                  03421071
034220     END-IF.                                                      03422071
034230                                                                  03423071
034240/                                                                 03424071
034250 1150-CHECK-AUTOVE-DC.                                            03425071
034260     INITIALIZE RC040-FIELDS.                                     03426071
034270     MOVE ASC-PO-NBR               TO RC040-PO-NBR                03427071
034280     MOVE ASC-REC-SEQ-NBR          TO RC040-PO-RCVR               03428071
034290     SET RC040-RCVR-EXISTS         TO TRUE                        03429071
034300                                                                  03430071
034310     MOVE DP020-LOCATION-NBR       TO RC040-SIGNON-LOCATION.      03431071
034320     MOVE PC-CURRENT-PROGRAM-NAME  TO RC040-CALLING-PROGRAM.      03432071
034330                                                                  03433071
034340     CALL RC040-AUTOVE-CHECK-PGM USING  DFHEIBLK                  03434071
034350                                        RC040-COMMAREA            03435071
034360                                        RC040-FIELDS.             03436071
034370                                                                  03437071
034380     EVALUATE TRUE                                                03438071
034390         WHEN RC040-SUCCESSFUL                                    03439071
034400            IF RC040-AUTO-VE-YES                                  03440071
034410               SET ASC-AUTOVE-PARM-YES TO TRUE                    03441071
034420            ELSE                                                  03442071
034430               SET ASC-AUTOVE-PARM-NO TO TRUE                     03443071
034440            END-IF                                                03444071
034450         WHEN RC040-DATABASE-BUSY                                 03445071
034460              MOVE ASC-OPER-UNT-ID   TO  PV-DISPLAY-OPER          03446071
034470              MOVE ASC-FCLTY-ID      TO  PV-DISPLAY-FCLTY         03447071
034480              MOVE ASC-PO-NBR        TO  PV-DISPLAY-PO-NBR        03448071
034490              MOVE ASC-REC-SEQ-NBR   TO  PV-DISPLAY-RCVR-SEQ-NBR  03449071
034500              INITIALIZE PV-CICS-MSG-AREA                         03450071
034510              STRING ' PCKCS701-1150- '                           03451071
034520                      PV-DISPLAY-OPER   '-'                       03452071
034530                      PV-DISPLAY-PO-NBR '-'                       03453071
034540                      PV-DISPLAY-RCVR-SEQ-NBR ' - '               03454071
034550                     ' - CONTENTION'            DELIMITED BY SIZE 03455071
034560                                           INTO PV-CICS-MSG-AREA2 03456071
034570               MOVE LENGTH OF PV-CICS-MSG-AREA2                   03457071
034580                                             TO PV-COMMAREA-LENGTH03458071
034590               EXEC CICS                                          03459071
034600                    WRITEQ TD                                     03460071
034610                     QUEUE  ('CSSL')                              03461071
034620                      FROM  (PV-CICS-MSG-AREA2)                   03462071
034630                    LENGTH  (PV-COMMAREA-LENGTH)                  03463071
034640                      RESP  (PV-CICS-RESP)                        03464071
034650               END-EXEC                                           03465071
034660                                                                  03466071
034670               MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER        03467071
034680               SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE            03468071
034690               PERFORM 9900-SOFT-ABORT                            03469071
034700                                                                  03470071
034710         WHEN OTHER                                               03471071
034720              MOVE ASC-OPER-UNT-ID   TO  PV-DISPLAY-OPER          03472071
034730              MOVE ASC-FCLTY-ID      TO  PV-DISPLAY-FCLTY         03473071
034740              MOVE ASC-PO-NBR        TO  PV-DISPLAY-PO-NBR        03474071
034750              MOVE ASC-REC-SEQ-NBR   TO  PV-DISPLAY-RCVR-SEQ-NBR  03475071
034760              INITIALIZE PV-CICS-MSG-AREA                         03476071
034770              STRING ' PCKCS701-1150- '                           03477071
034780                      PV-DISPLAY-OPER   '-'                       03478071
034790                      PV-DISPLAY-FCLTY  '-'                       03479071
034800                      PV-DISPLAY-PO-NBR '-'                       03480071
034810                      PV-DISPLAY-RCVR-SEQ-NBR ' - '               03481071
034820                     ' - INVALID SQLCODE'       DELIMITED BY SIZE 03482071
034830                                           INTO PV-CICS-MSG-AREA2 03483071
034840               MOVE LENGTH OF PV-CICS-MSG-AREA2                   03484071
034850                                             TO PV-COMMAREA-LENGTH03485071
034860               EXEC CICS                                          03486071
034870                    WRITEQ TD                                     03487071
034880                     QUEUE  ('CSSL')                              03488071
034890                      FROM  (PV-CICS-MSG-AREA2)                   03489071
034900                    LENGTH  (PV-COMMAREA-LENGTH)                  03490071
034910                      RESP  (PV-CICS-RESP)                        03491071
034920               END-EXEC                                           03492071
034930                                                                  03493071
034940              INITIALIZE PV-CICS-MSG-AREA                         03494071
034950              STRING ' PCKCS701-1150- '                           03495071
034960                      RC040-CRA-RET-MSG         DELIMITED BY SIZE 03496071
034970                                           INTO PV-CICS-MSG-AREA2 03497071
034980               MOVE LENGTH OF PV-CICS-MSG-AREA2                   03498071
034990                                             TO PV-COMMAREA-LENGTH03499071
035000               EXEC CICS                                          03500071
035010                    WRITEQ TD                                     03501071
035020                     QUEUE  ('CSSL')                              03502071
035030                      FROM  (PV-CICS-MSG-AREA2)                   03503071
035040                    LENGTH  (PV-COMMAREA-LENGTH)                  03504071
035050                      RESP  (PV-CICS-RESP)                        03505071
035060               END-EXEC                                           03506071
035070                                                                  03507071
035080               MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER        03508071
035090               SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE            03509071
035100               PERFORM 9900-SOFT-ABORT                            03510071
035110                                                                  03511071
035120               MOVE '1150-CHECK-AUTOVE-DC '                       03512071
035130                                TO DP013-PARAGRAPH                03513071
035140               MOVE 'CHECK AUTO VE DC LOCATION'                   03514071
035150                                TO DP013-MESSAGE-TEXT (1)         03515071
035160               STRING  PV-DISPLAY-OPER   '-'                      03516071
035170                       PV-DISPLAY-FCLTY  '-'                      03517071
035180                       PV-DISPLAY-PO-NBR '-'                      03518071
035190                       PV-DISPLAY-RCVR-SEQ-NBR ' - '              03519071
035200                      ' - INVALID SQLCODE'      DELIMITED BY SIZE 03520071
035210                              INTO DP013-MESSAGE-TEXT (2)         03521071
035220               STRING  RC040-CRA-RET-MSG        DELIMITED BY SIZE 03522071
035230                              INTO DP013-MESSAGE-TEXT (3)         03523071
035240               MOVE RC040-SQLCA       TO DP013-SQLCA              03524071
035250               MOVE 'TKRPRPM '  TO DP013-DB2-TABLE-NAME (1)       03525071
035260               SET DP013-DB2-ABEND                                03526071
035270                   DP013-XCTL-DISPLAY-RESTART                     03527071
035280                                    TO TRUE                       03528071
035290               PERFORM DP013-0000-PROCESS-ABEND                   03529071
035300     END-EVALUATE.                                                03530071
035310                                                                  03531071
035320                                                                  03532071
035330*----------------------------------------------------------------*03533071
035340*  CHECK TO SEE IF DC SHOULD BE SENDING DATA TO PACK-TO-LIGHT    *03534071
035350*  USUALLY THIS WILL BE YES.  WILL BE SET TO NO DURING UPGRADES, *03535071
035360*  SYSTEM PROBLEMS.  QA AND LEARNING WILL ALWAYS BE NO.          *03536071
035370*----------------------------------------------------------------*03537071
035380 1160-CHECK-P2L-DOWNLOAD.                                         03538071
035390                                                                  03539071
035400      MOVE DP020-LOCATION-NBR  TO  KRPRPM-LOC-ID.                 03540071
035410                                                                  03541071
035420     EXEC SQL                                                     03542071
035430          SELECT FUNC_TXT                                         03543071
035440          INTO  :KRPRPM-FUNC-TXT                                  03544071
035450          FROM   TKRPRPM                                          03545071
035460          WHERE  SYS_PRC_FUNC_CDE  = 'P2LPCC'                     03546071
035470            AND  LOC_ID            = :KRPRPM-LOC-ID               03547071
035480            AND  INTFC_SYS_CDE     = 'KHL'                        03548071
035490            AND  FUNC_PRC_STAT_CDE = 'AC'                         03549071
035500            AND  FUNC_TXT          = 'Y'                          03550071
035510     END-EXEC.                                                    03551071
035520                                                                  03552071
035530     EVALUATE TRUE                                                03553071
035540         WHEN SQLCODE = ZERO                                      03554071
035550              SET  ASC-P2L-PCC-DOWNLOAD-YES  TO  TRUE             03555071
035560                                                                  03556071
035570         WHEN SQLCODE = +100                                      03557071
035580              SET  ASC-P2L-PCC-DOWNLOAD-NO  TO  TRUE              03558071
035590                                                                  03559071
035600         WHEN SQLCODE = -904                                      03560071
035610         WHEN SQLCODE = -911                                      03561071
035620         WHEN SQLCODE = -913                                      03562071
035630             SET  ASC-P2L-PCC-DOWNLOAD-NO  TO  TRUE               03563071
035640             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   03564071
035650             MOVE '1160-CHECK-P2L-   P2LPCC' TO PV-SOFT-PARAGRAPH 03565071
035660             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 03566071
035670             MOVE LENGTH OF PV-CICS-MSG-AREA2                     03567071
035680               TO PV-COMMAREA-LENGTH                              03568071
035690             EXEC CICS                                            03569071
035700                  WRITEQ TD                                       03570071
035710                   QUEUE  ('CSSL')                                03571071
035720                    FROM  (PV-CICS-MSG-AREA2)                     03572071
035730                  LENGTH  (PV-COMMAREA-LENGTH)                    03573071
035740                    RESP  (PV-CICS-RESP)                          03574071
035750             END-EXEC                                             03575071
035760             PERFORM 9900-SOFT-ABORT                              03576071
035770                                                                  03577071
035780         WHEN SQLWARN0 NOT = SPACES                               03578071
035790         WHEN SQLCODE NOT EQUAL ZERO                              03579071
035800              SET  ASC-P2L-PCC-DOWNLOAD-NO  TO  TRUE              03580071
035810              MOVE '1160-CHECK-P2L-DOWNLOAD'                      03581071
035820                                   TO DP013-PARAGRAPH             03582071
035830              MOVE 'CHECK P2L TO PCC DOWNLOAD  '                  03583071
035840                                   TO DP013-MESSAGE-TEXT (1)      03584071
035850              MOVE SQLCA           TO DP013-SQLCA                 03585071
035860              MOVE 'TKRPRPM'       TO DP013-DB2-TABLE-NAME (2)    03586071
035870              SET DP013-DB2-ABEND  TO TRUE                        03587071
035880              PERFORM DP013-0000-PROCESS-ABEND                    03588071
035890     END-EVALUATE.                                                03589071
035900                                                                  03590071
035910     IF   PS-DISPLAY-CSSL-YES                                     03591071
035920        INITIALIZE                       PV-CICS-MSG-DATA2        03592071
035930        INITIALIZE                       PV-CICS-MSG-HOLD2        03593071
035940        INITIALIZE                       PV-CICS-MSG-AREA2        03594071
035950        STRING ' DOWNLOAD TO P2L PCC -'                           03595071
035960               ASC-P2L-PCC-DOWNLOAD-SW   DELIMITED BY SIZE        03596071
035970                                    INTO PV-CICS-MSG-AREA2        03597071
035980        MOVE LENGTH OF PV-CICS-MSG-AREA2                          03598071
035990                                      TO PV-COMMAREA-LENGTH       03599071
036000        EXEC CICS                                                 03600071
036010            WRITEQ TD                                             03601071
036020                QUEUE   ('CSSL')                                  03602071
036030                FROM    (PV-CICS-MSG-AREA2)                       03603071
036040                LENGTH  (PV-COMMAREA-LENGTH)                      03604071
036050                RESP    (PV-CICS-RESP)                            03605071
036060        END-EXEC                                                  03606071
036070     END-IF.                                                      03607071
036080                                                                  03608071
036090                                                                  03609071
036100     EXEC SQL                                                     03610071
036110          SELECT FUNC_TXT                                         03611071
036120          INTO  :KRPRPM-FUNC-TXT                                  03612071
036130          FROM   TKRPRPM                                          03613071
036140          WHERE  SYS_PRC_FUNC_CDE  = 'P2LAL'                      03614071
036150            AND  LOC_ID            = :KRPRPM-LOC-ID               03615071
036160            AND  INTFC_SYS_CDE     = 'KHL'                        03616071
036170            AND  FUNC_PRC_STAT_CDE = 'AC'                         03617071
036180            AND  FUNC_TXT          = 'Y'                          03618071
036190     END-EXEC.                                                    03619071
036200                                                                  03620071
036210     EVALUATE TRUE                                                03621071
036220         WHEN SQLCODE = ZERO                                      03622071
036230              SET  ASC-P2L-AL-DOWNLOAD-YES  TO  TRUE              03623071
036240                                                                  03624071
036250         WHEN SQLCODE = +100                                      03625071
036260              SET  ASC-P2L-AL-DOWNLOAD-NO  TO  TRUE               03626071
036270                                                                  03627071
036280         WHEN SQLCODE = -904                                      03628071
036290         WHEN SQLCODE = -911                                      03629071
036300         WHEN SQLCODE = -913                                      03630071
036310             SET  ASC-P2L-AL-DOWNLOAD-NO     TO  TRUE             03631071
036320             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   03632071
036330             MOVE '1160-CHECK-P2L-   P2LAL ' TO PV-SOFT-PARAGRAPH 03633071
036340             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 03634071
036350             MOVE LENGTH OF PV-CICS-MSG-AREA2                     03635071
036360               TO PV-COMMAREA-LENGTH                              03636071
036370             EXEC CICS                                            03637071
036380                  WRITEQ TD                                       03638071
036390                   QUEUE  ('CSSL')                                03639071
036400                    FROM  (PV-CICS-MSG-AREA2)                     03640071
036410                  LENGTH  (PV-COMMAREA-LENGTH)                    03641071
036420                    RESP  (PV-CICS-RESP)                          03642071
036430             END-EXEC                                             03643071
036440             PERFORM 9900-SOFT-ABORT                              03644071
036450                                                                  03645071
036460         WHEN SQLWARN0 NOT = SPACES                               03646071
036470         WHEN SQLCODE NOT EQUAL ZERO                              03647071
036480              SET  ASC-P2L-AL-DOWNLOAD-NO  TO  TRUE               03648071
036490              MOVE '1160-CHECK-P2L-DOWNLOAD'                      03649071
036500                                   TO DP013-PARAGRAPH             03650071
036510              MOVE 'CHECK P2L TO AL DOWNLOAD  '                   03651071
036520                                   TO DP013-MESSAGE-TEXT (1)      03652071
036530              MOVE SQLCA           TO DP013-SQLCA                 03653071
036540              MOVE 'TKRPRPM'       TO DP013-DB2-TABLE-NAME (2)    03654071
036550              SET DP013-DB2-ABEND  TO TRUE                        03655071
036560              PERFORM DP013-0000-PROCESS-ABEND                    03656071
036570     END-EVALUATE.                                                03657071
036580                                                                  03658071
036590     IF   PS-DISPLAY-CSSL-YES                                     03659071
036600        INITIALIZE                       PV-CICS-MSG-DATA2        03660071
036610        INITIALIZE                       PV-CICS-MSG-HOLD2        03661071
036620        INITIALIZE                       PV-CICS-MSG-AREA2        03662071
036630        STRING ' DOWNLOAD TO P2L AL -'                            03663071
036640               ASC-P2L-AL-DOWNLOAD-SW   DELIMITED BY SIZE         03664071
036650                                    INTO PV-CICS-MSG-AREA2        03665071
036660        MOVE LENGTH OF PV-CICS-MSG-AREA2                          03666071
036670                                      TO PV-COMMAREA-LENGTH       03667071
036680        EXEC CICS                                                 03668071
036690            WRITEQ TD                                             03669071
036700                QUEUE   ('CSSL')                                  03670071
036710                FROM    (PV-CICS-MSG-AREA2)                       03671071
036720                LENGTH  (PV-COMMAREA-LENGTH)                      03672071
036730                RESP    (PV-CICS-RESP)                            03673071
036740        END-EXEC                                                  03674071
036750     END-IF.                                                      03675071
036760                                                                  03676071
036770                                                                  03677071
036780*----------------------------------------------------------------*03678071
036790* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *03679071
036800* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *03680071
036810* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *03681071
036820* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *03682071
036830* FUNCTION KEYS CAN GET THIS FAR.                                *03683071
036840*----------------------------------------------------------------*03684071
036850 2000-PROCESS-PANEL.                                              03685071
036860                                                                  03686071
036870     EVALUATE TRUE                                                03687071
036880         WHEN DP020-SRC-AID = DP016-CLEAR                         03688071
036890             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    03689071
036900             PERFORM 3200-RESET-ATTRIBUTES                        03690071
036910             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03691071
036920             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 03692071
036930                                                                  03693071
036940         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    03694071
036950             MOVE ASC-OPER-UNT-ID      TO DK-OPER-UNT-ID          03695071
036960             MOVE ASC-FCLTY-ID         TO DK-FCLTY-ID             03696071
036970             MOVE ASC-PO-NBR           TO DK-PO-NBR               03697071
036980             MOVE ASC-PO-LINE-NBR      TO DK-LINE-NBR             03698071
036990             MOVE ASC-REC-SEQ-NBR      TO DK-REC-SEQ-NBR          03699071
037000             PERFORM 2050-DELETE-LIST-QUEUE                       03700071
037010             PERFORM 4000-BUILD-INITIAL-PANEL                     03701071
037020             SET  ASC-CONFIRM-DELETE-NO                           03702071
037030                  ASC-2ND-CONFIRM-DEL-NO                          03703071
037040                  ASC-2ND-CONFIRM-UNKNOWN TO TRUE                 03704071
037050                                                                  03705071
037060         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             03706071
037070           IF  ASC-USE-SELECTION-QUEUE                            03707071
037080               PERFORM 1130-GET-NEXT-RECORD                       03708071
037090               IF PS-LIST-END                                     03709071
037100                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN           03710071
037110                   SET PS-NO-LIST-END TO TRUE                     03711071
037120               ELSE                                               03712071
037130                   PERFORM 2050-DELETE-LIST-QUEUE                 03713071
037140                   MOVE PC-ITEMS-PER-PANEL TO ASC-ITEMS-DISPLAYED 03714071
037150                   PERFORM 3200-RESET-ATTRIBUTES                  03715071
037160                   SET PS-CRITERIA-CHANGE TO TRUE                 03716071
037170                   IF  ASC-PRE-PACK-ORDER                         03717071
037180                       SET  ASC-PRE-PACK-CSR   TO  TRUE           03718071
037190                   ELSE                                           03719071
037200                       SET  ASC-PO-ALL-LN-CSR  TO  TRUE           03720071
037210                   END-IF                                         03721071
037220                     PERFORM 4000-BUILD-INITIAL-PANEL             03722071
037230                 END-IF                                           03723071
037240           ELSE                                                   03724071
037250               PERFORM 4400-MOVE-COMMAREA-TO-SCREEN               03725071
037260*              --- BOTTOM OF LIST ---                             03726071
037270               MOVE PC-TSYMSG-00070                               03727071
037280                                 TO DP020-MSG-NUMBER              03728071
037290               SET DP020-MSG-INFORMATIONAL                        03729071
037300                                 TO TRUE                          03730071
037310           END-IF                                                 03731071
037320                                                                  03732071
037330         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    03733071
037340             PERFORM 2140-DESELECT-ALL-ITEMS                      03734071
037350             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 03735071
037360                                                                  03736071
037370         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  03737071
037380             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 03738071
037390             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03739071
037400             PERFORM 2150-SELECT-ALL-ITEMS                        03740071
037410             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 03741071
037420                                                                  03742071
037430         WHEN OTHER                                               03743071
037440             IF  ASC-NUMBER-OF-ITEMS-READ  =  0                   03744071
037450                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             03745071
037460                 SET DP030-OVERRIDE-GO  TO TRUE                   03746071
037470             ELSE                                                 03747071
037480                 PERFORM 2010-CHECK-CICS-NETWORK                  03748071
037490                 PERFORM 1160-CHECK-P2L-DOWNLOAD                  03749071
037500                                                                  03750071
037600                 PERFORM 2200-MOVE-SCREEN-TO-COMMAREA             03760071
037610                 PERFORM 3200-RESET-ATTRIBUTES                    03761071
037620                 SET  PS-INITIAL-EDIT  TO  TRUE                   03762071
037630                                                                  03763071
037640                 IF PS-NO-ERROR                                   03764071
037650                     SET DP030-CONTINUE-GO  TO TRUE               03765071
037660                     PERFORM 2060-CHECK-WMOS                      03766071
037670                 END-IF                                           03767071
037680                 IF PS-NO-ERROR                                   03768071
037690                     PERFORM 3000-EDIT-DATA-IN-COMMAREA           03769071
037700                 END-IF                                           03770071
037710                                                                  03771071
037720                 IF  PS-NO-ERROR                                  03772071
037730                     SET DP030-CONTINUE-GO  TO TRUE               03773071
037731                     PERFORM 2100-CHECK-FUNCTION-KEY              03773171
037732                 ELSE                                             03773271
037733                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         03773371
037734                     SET DP030-OVERRIDE-GO  TO TRUE               03773471
037735                 END-IF                                           03773571
037736             END-IF                                               03773671
037737     END-EVALUATE.                                                03773771
037738                                                                  03773871
037739                                                                  03773971
037740*----------------------------------------------------------------*03774071
037750*  DETERMINE WHAT CICS NETWORK YOU ARE WORKING IN                *03775071
037760*----------------------------------------------------------------*03776071
037770 2010-CHECK-CICS-NETWORK.                                         03777071
037780                                                                  03778071
037790      EXEC CICS                                                   03779071
037800          ASSIGN                                                  03780071
037810              APPLID(PV-SYSTEM-ID)                                03781071
037820              USERID (PV-USER-ID)                                 03782071
037830      END-EXEC.                                                   03783071
037840                                                                  03784071
037850                                                                  03785071
037860*----------------------------------------------------------------*03786071
037870*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *03787071
037880*----------------------------------------------------------------*03788071
037890 2050-DELETE-LIST-QUEUE.                                          03789071
037900     EXEC CICS                                                    03790071
037910         DELETEQ TS                                               03791071
037920             QUEUE (ASC-LIST-QUEUE-NAME)                          03792071
037930             RESP  (PV-CICS-RESP)                                 03793071
037940     END-EXEC.                                                    03794071
037950                                                                  03795071
037960     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       03796071
037970        (PV-CICS-RESP = DFHRESP(QIDERR))                          03797071
037980         CONTINUE                                                 03798071
037990     ELSE                                                         03799071
038000         SET DP013-CICS-ABEND      TO TRUE                        03800071
038010         SET DP013-NO-ROLLBACK     TO TRUE                        03801071
038020                                                                  03802071
038030         MOVE '2050-DELETE-LIST-QUEUE'                            03803071
038040                                   TO DP013-PARAGRAPH             03804071
038050         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    03805071
038060                                   TO DP013-MESSAGE-TEXT (1)      03806071
038070         PERFORM DP013-0000-PROCESS-ABEND                         03807071
038080     END-IF.                                                      03808071
038090                                                                  03809071
038100     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  03810071
038110                                                                  03811071
038120                                                                  03812071
038130*----------------------------------------------------------------*03813071
038140* If the following is selected, then check to see if the DC       03814071
038150* is downloading to WMOS.  If it is, then this function is        03815071
038160* not allowed:                                                    03816071
038170*       F24 - FUNC-02     F23 - FUNC-06                           03817071
038180*----------------------------------------------------------------*03818071
038190 2060-CHECK-WMOS.                                                 03819071
038200                                                                  03820071
038210                                                                  03821071
038220     IF   DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)                  03822071
038230       OR DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)                  03823071
038240         PERFORM 2061-GET-CURR-TMST                               03824071
038241         MOVE ASC-OPER-UNT-ID            TO DK-OPER-UNT-ID        03824171
038242         PERFORM 2062-CHECK-DC-WMOS                               03824271
038243         IF PS-DC-ON-WMOS-YES                                     03824371
038244             MOVE PC-TSYMSG-03554      TO DP020-MSG-NUMBER        03824471
038245             SET DP020-MSG-FATAL       TO TRUE                    03824571
038246             MOVE -1                   TO MR-SELECTL (1)          03824671
038247             SET DP030-SET-CURSOR-APPL-1                          03824771
038248                                       TO TRUE                    03824871
038249             SET PS-ERROR              TO TRUE                    03824971
038250             SET ASC-NO-TSQ-UPDATE TO TRUE                        03825071
038251         END-IF                                                   03825171
038252     END-IF.                                                      03825271
038253                                                                  03825371
038254                                                                  03825471
038255 2061-GET-CURR-TMST.                                              03825571
038256                                                                  03825671
038257         EXEC SQL                                                 03825771
038258             SET :DK-CURRENT-TIMESTAMP = CURRENT TIMESTAMP        03825871
038259         END-EXEC.                                                03825971
038260                                                                  03826071
038270                                                                  03827071
038271 2062-CHECK-DC-WMOS.                                              03827171
038272                                                                  03827271
038273     EXEC SQL                                                     03827371
038274          SELECT   A.INTGRTN_TYP_DESC                             03827471
038275            INTO  :WST00008-INTGRTN-TYP-DESC                      03827571
038276            FROM                                                  03827671
038277                  WST_INTGRTN_TYP  A                              03827771
038278               ,  WST_ATTR_DEFN    B                              03827871
038279               ,  WST_ATTR_ELEM    C                              03827971
038280               ,  WST_ATTR_ELEM    D                              03828071
038281               ,  WST_ATTR_ELEM    E                              03828171
038282            WHERE                                                 03828271
038283                  A.INTGRTN_TYP_CDE   = 'WMOSON'                  03828371
038284              AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE         03828471
038285              AND B.ATTR_DEFN_SEQ_NBR = 1                         03828571
038286              AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE         03828671
038287              AND C.ATTR_DEFN_SEQ_NBR = 1                         03828771
038288              AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE         03828871
038289              AND D.ATTR_DEFN_SEQ_NBR = 2                         03828971
038290              AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE         03829071
038291              AND E.ATTR_DEFN_SEQ_NBR = 3                         03829171
038292              AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR       03829271
038293              AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR       03829371
038294              AND C.ATTR_ELEM_NBR     = :DK-OPER-UNT-ID           03829471
038295              AND E.ATTR_ELEM_TMST   <= :DK-CURRENT-TIMESTAMP     03829571
038296     END-EXEC.                                                    03829671
038297                                                                  03829771
038298     EVALUATE TRUE                                                03829871
038299         WHEN SQLCODE = ZERO                                      03829971
038300             SET PS-DC-ON-WMOS-YES      TO TRUE                   03830071
038301         WHEN OTHER                                               03830171
038302             SET PS-DC-ON-WMOS-NO       TO TRUE                   03830271
038303     END-EVALUATE.                                                03830371
038304                                                                  03830471
038305                                                                  03830571
038306*----------------------------------------------------------------*03830671
038307* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*03830771
038308* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *03830871
038309* CICS ARCHITECTURE API.                                         *03830971
038310*----------------------------------------------------------------*03831071
038311 2100-CHECK-FUNCTION-KEY.                                         03831171
038312                                                                  03831271
038313     EVALUATE TRUE                                                03831371
038314                                                                  03831471
038315* F17 - STORE LIST      (LOCAL-FUNC-04)                           03831571
038316* F24 - LABEL REPRINT   (LOCAL-FUNC-02)                           03831671
038317                                                                  03831771
038318         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              03831871
038319         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              03831971
038320             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              03832071
038321                 INITIALIZE PC122-INTER-APPL-COMMAREA             03832171
038322                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                03832271
038323                                TO PC122-NUMBER-OF-SELECTED-ITEMS 03832371
038324                 MOVE ASC-SEL-QUEUE-NAME                          03832471
038325                                TO PC122-SEL-QUEUE-NAME           03832571
038326                 MOVE ASC-OPER-UNT-ID                             03832671
038327                                TO PC122-OPER-UNT-ID              03832771
038328                 MOVE ASC-FCLTY-ID                                03832871
038329                                TO PC122-FCLTY-ID                 03832971
038330                 MOVE ASC-CURR-OPER-UNT-ID                        03833071
038340                                TO PC122-CURR-OPER-UNT-ID         03834071
038350                 MOVE ASC-CURR-FCLTY-ID                           03835071
038360                                TO PC122-CURR-FCLTY-ID            03836071
038370                 MOVE ASC-PO-NBR                                  03837071
038380                                TO PC122-PO-NBR                   03838071
038390                 MOVE ASC-REC-SEQ-NBR                             03839071
038400                                TO PC122-REC-SEQ-NBR              03840071
038410                 MOVE ASC-DPT-NBR                                 03841071
038420                                TO PC122-DPT-NBR                  03842071
038430                 MOVE ASC-SML-P2L-PRTR-ID                         03843071
038440                                TO PC122-SML-P2L-PRTR-ID          03844071
038450                 MOVE ASC-PGYBCK-PRTR-ID                          03845071
038460                                TO PC122-PGYBCK-PRTR-ID           03846071
038470                 MOVE ASC-DC-PRTD-AT                              03847071
038480                                TO PC122-DC-PRTD-AT               03848071
038490                 MOVE ASC-PKGNG-CD                                03849071
038500                                TO PC122-PKGNG-CD                 03850071
038510                 MOVE ASC-DSPLY-PKGNG-CD                          03851071
038520                                TO PC122-DSPLY-PKGNG-CD           03852071
038530                 MOVE ASC-TRIP-ARRIVE-DATE                        03853071
038540                                TO PC122-TRIP-ARRIVE-DATE         03854071
038550                 PERFORM 4320-GET-DISTR-HEADER                    03855071
038560                 IF  DISTHD-SPC-INSTR-DESC  >  SPACES             03856071
038570                     MOVE DISTHD-SPC-INSTR-DESC                   03857071
038580                                TO PC122-DFLT-STR-ZN-ID           03858071
038590                 ELSE                                             03859071
038600                 IF  ASC-SPEC-INST-DESC  >  SPACES                03860071
038610                     MOVE ASC-SPEC-INST-DESC                      03861071
038620                                TO PC122-DFLT-STR-ZN-ID           03862071
038630                 ELSE                                             03863071
038640                     MOVE ASC-DFLT-STR-ZN-ID                      03864071
038650                                TO PC122-DFLT-STR-ZN-ID           03865071
038660                 END-IF                                           03866071
038670                 END-IF                                           03867071
038680                 MOVE ASC-CRE-LBL-IND                             03868071
038690                                TO PC122-CRE-LBL-IND              03869071
038700                 MOVE ASC-PRT-HEAD-FOOT                           03870071
038710                                TO PC122-P2L-PRT-HDR-SW           03871071
038720                 MOVE ASC-LBL-PRT-ORDER                           03872071
038730                                TO  PC122-LBL-PRT-ORDER           03873071
038740                 SET ASC-OTHER-QUEUE  TO  TRUE                    03874071
038750                 PERFORM 5000-PREPARE-SEL-QUEUE                   03875071
038760             ELSE                                                 03876071
038770                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             03877071
038780                 SET DP030-OVERRIDE-GO                            03878071
038790                                   TO TRUE                        03879071
038800                 MOVE PC-TSYMSG-00057                             03880071
038810                                   TO DP020-MSG-NUMBER            03881071
038820                 SET DP020-MSG-WARNING                            03882071
038830                                   TO TRUE                        03883071
038840             END-IF                                               03884071
038850*                                                                 03885071
038860* F18 - TROUBLE LIST                                              03886071
038870*                                                                 03887071
038880         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              03888071
038890             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              03889071
038900                 SET ASC-TROUBLE-QUEUE  TO  TRUE                  03890071
038910                 PERFORM 5002-PREPARE-SEL-QUEUE-TRBL              03891071
038920             ELSE                                                 03892071
038930                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             03893071
038940                 SET DP030-OVERRIDE-GO                            03894071
038950                                   TO TRUE                        03895071
038960                 MOVE PC-TSYMSG-00057                             03896071
038970                                   TO DP020-MSG-NUMBER            03897071
038980                 SET DP020-MSG-WARNING                            03898071
038990                                   TO TRUE                        03899071
039000             END-IF                                               03900071
039010                                                                  03901071
039020*                                                                 03902071
039030* F22 - DISTRO                                                    03903071
039040*                                                                 03904071
039050         WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)              03905071
039060             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              03906071
039070                 SET ASC-DISTRO-QUEUE  TO  TRUE                   03907071
039080                  INITIALIZE RC015-INTER-APPL-COMMAREA            03908071
039090                  MOVE ASC-NUMBER-OF-SELECTED-ITEMS               03909071
039100                                 TO RC015-NUMBER-OF-SELECTED-ITEMS03910071
039110                  MOVE ASC-PO-NBR                                 03911071
039120                                 TO RC015-PO-NBR                  03912071
039130                  MOVE ASC-REC-SEQ-NBR                            03913071
039140                                 TO RC015-REC-SEQ-NBR             03914071
039150                  MOVE ASC-OPER-UNT-ID                            03915071
039160                                 TO RC015-OPER-UNT-ID             03916071
039170                  MOVE ASC-FCLTY-ID                               03917071
039180                                 TO RC015-FCLTY-ID                03918071
039190                 PERFORM 5003-PREPARE-SEL-QUEUE-DISTRO            03919071
039200             ELSE                                                 03920071
039210                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             03921071
039220                 SET DP030-OVERRIDE-GO                            03922071
039230                                   TO TRUE                        03923071
039240                 MOVE PC-TSYMSG-00057                             03924071
039250                                   TO DP020-MSG-NUMBER            03925071
039260                 SET DP020-MSG-WARNING                            03926071
039270                                   TO TRUE                        03927071
039280             END-IF                                               03928071
039290*                                                                 03929071
039300* F19 - PCKDTLST (PRE-PACK DETAIL LIST)                           03930071
039310*                                                                 03931071
039320         WHEN DP020-FK-LOCAL-FUNC-09 (DP020-SRC-AID)              03932071
039330             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              03933071
039340                 SET ASC-PREPK-QUEUE   TO  TRUE                   03934071
039350                 IF  ASC-NUMBER-OF-SELECTED-ITEMS  >  1           03935071
039360                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         03936071
039370                     SET DP030-OVERRIDE-GO  TO  TRUE              03937071
039380                     MOVE PC-TSYMSG-02449   TO  DP020-MSG-NUMBER  03938071
039390                     SET DP020-MSG-WARNING  TO  TRUE              03939071
039400                 ELSE                                             03940071
039410                      PERFORM 5004-PREPARE-SEL-QUEUE-PKDTLST      03941071
039420                 END-IF                                           03942071
039430             ELSE                                                 03943071
039440                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             03944071
039450                 SET DP030-OVERRIDE-GO                            03945071
039460                                   TO TRUE                        03946071
039470                 MOVE PC-TSYMSG-00057                             03947071
039480                                   TO DP020-MSG-NUMBER            03948071
039490                 SET DP020-MSG-WARNING                            03949071
039500                                   TO TRUE                        03950071
039510             END-IF                                               03951071
039520     END-EVALUATE.                                                03952071
039530                                                                  03953071
039540     EVALUATE TRUE                                                03954071
039550                                                                  03955071
039560* DELETE                                                          03956071
039570                                                                  03957071
039580         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              03958071
039590             SET PS-DELETE-NOT-ALLOWED  TO  TRUE                  03959071
039600             PERFORM 2105-RACF-ACCESS                             03960071
039610             IF  PS-DELETE-NOT-ALLOWED                            03961071
039620                 PERFORM 2180-CHECK-LINES-CSPK-ONLY               03962071
039630                     VARYING PV-ITEM FROM 1 BY 1                  03963071
039640                       UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN  03964071
039650                          OR PS-LINE-PROCESSED-AS-SPLIT           03965071
039660                 IF  PS-LINE-PROCESSED-AS-SPLIT                   03966071
039670                     SET  PS-DELETE-NOT-ALLOWED  TO  TRUE         03967071
039680                 ELSE                                             03968071
039690                     SET  PS-DELETE-ALLOWED      TO  TRUE         03969071
039700                 END-IF                                           03970071
039710             END-IF                                               03971071
039720                                                                  03972071
039730             IF  PS-DELETE-NOT-ALLOWED                            03973071
039740                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             03974071
039750                 MOVE PC-TSYMSG-01852      TO DP020-MSG-NUMBER    03975071
039760                 SET DP020-MSG-FATAL       TO TRUE                03976071
039770                 MOVE -1                   TO MR-SELECTL (1)      03977071
039780                 SET DP030-SET-CURSOR-APPL-1                      03978071
039790                                           TO TRUE                03979071
039800                 SET PS-ERROR              TO TRUE                03980071
039810                 SET ASC-NO-TSQ-UPDATE TO TRUE                    03981071
039820             END-IF                                               03982071
039830                                                                  03983071
039840             IF  PS-DELETE-ALLOWED                                03984071
039850                 IF  ASC-OPER-UNT-ID  =  ASC-CURR-OPER-UNT-ID     03985071
039860                     CONTINUE                                     03986071
039870                 ELSE                                             03987071
039880                     SET  PS-DELETE-NOT-ALLOWED  TO  TRUE         03988071
039890                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         03989071
039900                     MOVE ASC-CURR-OPER-UNT-ID TO DP020-MSG-TEXT  03990071
039910                     MOVE PC-TSYMSG-03253  TO DP020-MSG-NUMBER    03991071
039920                     SET DP020-MSG-FATAL   TO TRUE                03992071
039930                     MOVE -1               TO MR-SELECTL (1)      03993071
039940                     SET DP030-SET-CURSOR-APPL-1                  03994071
039950                         PS-ERROR                                 03995071
039960                         ASC-NO-TSQ-UPDATE TO TRUE                03996071
039970                 END-IF                                           03997071
039980             END-IF                                               03998071
039990                                                                  03999071
040000             IF  PS-DELETE-ALLOWED                                04000071
040010                 IF  ASC-NUMBER-OF-SELECTED-ITEMS = ZERO  AND     04001071
040020                     PS-DELETE-ALLOWED                            04002071
040030                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         04003071
040040                     MOVE PC-TSYMSG-00172  TO DP020-MSG-NUMBER    04004071
040050                     SET DP020-MSG-FATAL   TO TRUE                04005071
040060                     MOVE -1               TO MR-SELECTL (1)      04006071
040070                     SET DP030-SET-CURSOR-APPL-1                  04007071
040080                                           TO TRUE                04008071
040090                     SET PS-ERROR          TO TRUE                04009071
040100                     SET ASC-NO-TSQ-UPDATE TO TRUE                04010071
040110                 ELSE                                             04011071
040120                     SET ASC-CONFIRM-DELETE  TO  TRUE             04012071
040130                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         04013071
040140                     MOVE PC-TSYMSG-00354  TO DP020-MSG-NUMBER    04014071
040150                     SET DP020-MSG-FATAL   TO TRUE                04015071
040160                     MOVE -1               TO MR-SELECTL (1)      04016071
040170                     SET DP030-SET-CURSOR-APPL-1                  04017071
040180                                           TO  TRUE               04018071
040190                     SET PS-ERROR          TO TRUE                04019071
040200                     SET ASC-NO-TSQ-UPDATE TO TRUE                04020071
040210                 END-IF                                           04021071
040220             END-IF                                               04022071
040230                                                                  04023071
040240* PRINT & RELEASE                                                 04024071
040250* F23 - PRINT & RELEASE (LOCAL-FUNC-06)                           04025071
040260                                                                  04026071
040270         WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)              04027071
040280             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              04028071
040290                 SET PS-SOCKET-INITIALIZED-NO  TO  TRUE           04029071
040300                                                                  04030071
040400               IF ASC-PO-RCVR-DWNLD-P2L-N                         04040071
040410                 IF  ASC-DC-INTERFC-LABOR-YES   AND               04041071
040420                     ASC-ASSOC-LABOR-ASGMT-YES                    04042071
040430                     SET  PS-LABOR-LOG-HEADER  TO  TRUE           04043071
040440                     PERFORM 3630-SEND-LABOR-TO-EAI               04044071
040450                 END-IF                                           04045071
040460                                                                  04046071
040470                 PERFORM 4600-PROCESS-PRINT-RELEASE               04047071
040480                     VARYING PV-ITEM  FROM 1 BY 1                 04048071
040490                     UNTIL PV-ITEM >  ASC-HIGHEST-BLOCK-WRITTEN   04049071
040491                        OR PS-SOFT-ABORT-ERROR                    04049171
040492                 IF  PS-SOCKET-INITIALIZED-YES                    04049271
040493                     PERFORM 4655-CLOSE-SOCKET                    04049371
040494                 END-IF                                           04049471
040495                 SET  PS-EDIT-BEFORE-MOVE  TO  TRUE               04049571
040496                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             04049671
040497               ELSE                                               04049771
040498                                                                  04049871
040499                 PERFORM 4600-PROCESS-PRINT-RELEASE               04049971
040500                     VARYING PV-ITEM  FROM 1 BY 1                 04050071
040501                     UNTIL PV-ITEM >  ASC-HIGHEST-BLOCK-WRITTEN   04050171
040502                        OR PS-SOFT-ABORT-ERROR                    04050271
040503                 IF  PS-SOCKET-INITIALIZED-YES                    04050371
040504                     PERFORM 4655-CLOSE-SOCKET                    04050471
040505                 END-IF                                           04050571
040506                 SET  PS-EDIT-BEFORE-MOVE  TO  TRUE               04050671
040507                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             04050771
040508               END-IF                                             04050871
040509             ELSE                                                 04050971
040510                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             04051071
040520                 SET DP030-OVERRIDE-GO                            04052071
040530                                   TO TRUE                        04053071
040540                 MOVE PC-TSYMSG-00057                             04054071
040550                                   TO DP020-MSG-NUMBER            04055071
040560                 SET DP020-MSG-WARNING                            04056071
040570                                   TO TRUE                        04057071
040580             END-IF                                               04058071
040590                                                                  04059071
040600* P2L RESEND                                                      04060071
040610                                                                  04061071
040620         WHEN DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)              04062071
040630             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              04063071
040640                 SET PS-SOCKET-INITIALIZED-NO  TO  TRUE           04064071
040650                 PERFORM 5300-PROCESS-P2L-RESEND                  04065071
040660                     VARYING PV-ITEM  FROM 1 BY 1                 04066071
040670                     UNTIL PV-ITEM >  ASC-HIGHEST-BLOCK-WRITTEN   04067071
040680                        OR PS-SOFT-ABORT-ERROR                    04068071
040690                 IF  PS-SOCKET-INITIALIZED-YES                    04069071
040700                     PERFORM 4655-CLOSE-SOCKET                    04070071
040710                 END-IF                                           04071071
040720                 SET  PS-EDIT-BEFORE-MOVE  TO  TRUE               04072071
040730                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             04073071
040740             ELSE                                                 04074071
040750                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             04075071
040760                 SET DP030-OVERRIDE-GO                            04076071
040770                                   TO TRUE                        04077071
040780                 MOVE PC-TSYMSG-00057                             04078071
040790                                   TO DP020-MSG-NUMBER            04079071
040800                 SET DP020-MSG-WARNING                            04080071
040810                                   TO TRUE                        04081071
040820             END-IF                                               04082071
040830                                                                  04083071
040840* IGNORE UCC128 DATA - F20 - LOCAL-FUNC-10                        04084071
040850                                                                  04085071
040860         WHEN DP020-FK-LOCAL-FUNC-10 (DP020-SRC-AID)              04086071
040870              IF  ASC-UCC128-AVAIL-YES                            04087071
040880                  SET PS-IGNORE-UCC128-ALLOWED   TO  TRUE         04088071
040890              ELSE                                                04089071
040900                  SET PS-IGNORE-UCC128-NOT-ALLOW TO  TRUE         04090071
040910              END-IF                                              04091071
040920                                                                  04092071
040930             IF  PS-IGNORE-UCC128-NOT-ALLOW                       04093071
040940                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             04094071
040950                 MOVE PC-TSYMSG-02496      TO DP020-MSG-NUMBER    04095071
040960                 SET DP020-MSG-FATAL       TO TRUE                04096071
040970                 MOVE -1                   TO MR-SELECTL (1)      04097071
040980                 SET DP030-SET-CURSOR-APPL-1                      04098071
040990                                           TO TRUE                04099071
041000                 SET PS-ERROR              TO TRUE                04100071
041010                 SET ASC-NO-TSQ-UPDATE TO TRUE                    04101071
041020             END-IF                                               04102071
041030                                                                  04103071
041040             IF  PS-IGNORE-UCC128-ALLOWED                         04104071
041050                 IF  ASC-NUMBER-OF-SELECTED-ITEMS = ZERO  AND     04105071
041060                     PS-IGNORE-UCC128-ALLOWED                     04106071
041070                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         04107071
041080                     MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER    04108071
041090                     SET DP020-MSG-FATAL   TO TRUE                04109071
041100                     MOVE -1               TO MR-SELECTL (1)      04110071
041110                     SET DP030-SET-CURSOR-APPL-1                  04111071
041120                                           TO TRUE                04112071
041130                     SET PS-ERROR          TO TRUE                04113071
041140                     SET ASC-NO-TSQ-UPDATE TO TRUE                04114071
041150                 ELSE                                             04115071
041160                     SET ASC-CONFIRM-IGNORE  TO  TRUE             04116071
041170                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         04117071
041180                     MOVE PC-TSYMSG-02497  TO DP020-MSG-NUMBER    04118071
041190                     SET DP020-MSG-FATAL   TO TRUE                04119071
041200                     MOVE -1               TO MR-SELECTL (1)      04120071
041210                     SET DP030-SET-CURSOR-APPL-1                  04121071
041220                                           TO  TRUE               04122071
041230                     SET PS-ERROR          TO TRUE                04123071
041240                     SET ASC-NO-TSQ-UPDATE TO TRUE                04124071
041250                 END-IF                                           04125071
041260             END-IF                                               04126071
041270                                                                  04127071
041280* F2-CONFIRM TROUBLE CREATE  -OR- DELETE -OR- IGNORE UCC128       04128071
041290                                                                  04129071
041300         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    04130071
041310             IF  ASC-CONFIRM-TROUBLE-YES                          04131071
041320                 SET PS-SOCKET-INITIALIZED-NO  TO  TRUE           04132071
041330                 PERFORM 4600-PROCESS-PRINT-RELEASE               04133071
041340                     VARYING PV-ITEM  FROM 1 BY 1                 04134071
041350                     UNTIL PV-ITEM >  ASC-HIGHEST-BLOCK-WRITTEN   04135071
041360                        OR PS-SOFT-ABORT-ERROR                    04136071
041370                 IF  PS-SOCKET-INITIALIZED-YES                    04137071
041380                     PERFORM 4655-CLOSE-SOCKET                    04138071
041390                 END-IF                                           04139071
041400                 SET  PS-EDIT-BEFORE-MOVE  TO  TRUE               04140071
041410                 IF  PS-NO-SOFT-ABORT-ERROR                       04141071
041420                     PERFORM 3000-EDIT-DATA-IN-COMMAREA           04142071
041430                 END-IF                                           04143071
041440                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             04144071
041450             END-IF                                               04145071
041460                                                                  04146071
041470             IF  ASC-CONFIRM-DELETE                               04147071
041480             PERFORM 2105-RACF-ACCESS                             04148071
041490                 IF  PS-DELETE-NOT-ALLOWED                        04149071
041500                     PERFORM 2180-CHECK-LINES-CSPK-ONLY           04150071
041510                     VARYING PV-ITEM FROM 1 BY 1                  04151071
041520                       UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN  04152071
041530                          OR PS-LINE-PROCESSED-AS-SPLIT           04153071
041540                     IF  PS-LINE-PROCESSED-AS-SPLIT               04154071
041550                         SET  PS-DELETE-NOT-ALLOWED  TO  TRUE     04155071
041560                     ELSE                                         04156071
041570                         SET  PS-DELETE-ALLOWED      TO  TRUE     04157071
041580                     END-IF                                       04158071
041590                 END-IF                                           04159071
041600                                                                  04160071
041610                 IF  PS-DELETE-NOT-ALLOWED                        04161071
041620                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         04162071
041630                     MOVE PC-TSYMSG-01852  TO DP020-MSG-NUMBER    04163071
041640                     SET DP020-MSG-FATAL   TO TRUE                04164071
041650                     MOVE -1               TO MR-SELECTL (1)      04165071
041660                     SET DP030-SET-CURSOR-APPL-1                  04166071
041670                                           TO TRUE                04167071
041680                     SET PS-ERROR          TO TRUE                04168071
041690                     SET ASC-NO-TSQ-UPDATE TO TRUE                04169071
041700                 END-IF                                           04170071
041710                                                                  04171071
041720                 IF  PS-DELETE-ALLOWED                            04172071
041730                     IF  ASC-NUMBER-OF-SELECTED-ITEMS = ZERO  AND 04173071
041740                         PS-DELETE-ALLOWED                        04174071
041750                         MOVE PC-TSYMSG-00172  TO DP020-MSG-NUMBER04175071
041760                         SET DP020-MSG-FATAL   TO TRUE            04176071
041770                         MOVE -1               TO MR-SELECTL (1)  04177071
041780                         SET DP030-SET-CURSOR-APPL-1              04178071
041790                                               TO TRUE            04179071
041800                         SET PS-ERROR          TO TRUE            04180071
041810                         SET ASC-NO-TSQ-UPDATE TO TRUE            04181071
041820                     ELSE                                         04182071
041830                     IF  ASC-2ND-CONFIRM-NEED  AND                04183071
041840                         ASC-2ND-CONFIRM-DEL-NO                   04184071
041850                            SET ASC-CONFIRM-DELETE                04185071
041860                                ASC-2ND-CONFIRM-DEL  TO  TRUE     04186071
041870                            PERFORM 4400-MOVE-COMMAREA-TO-SCREEN  04187071
041880                            MOVE PC-TSYMSG-02509 TO               04188071
041890                                              DP020-MSG-NUMBER    04189071
041900                            SET DP020-MSG-FATAL   TO TRUE         04190071
042000                            MOVE -1           TO MR-SELECTL (1)   04200071
042100                            SET DP030-SET-CURSOR-APPL-1           04210071
042110                                                  TO  TRUE        04211071
042120                            SET PS-ERROR          TO TRUE         04212071
042130                            SET ASC-NO-TSQ-UPDATE TO TRUE         04213071
042140                     ELSE                                         04214071
042150                          IF ASC-RECLAIM-DC-YES    AND            04215071
042160                             ASC-2ND-CONFIRM-NEED                 04216071
042170                             SET ASC-CONFIRM-DELETE-NO TO TRUE    04217071
042180                             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN 04218071
042190                             MOVE PC-TSYMSG-02972 TO              04219071
042200                                               DP020-MSG-NUMBER   04220071
042210                             SET DP020-MSG-FATAL   TO TRUE        04221071
042220                             MOVE -1           TO MR-SELECTL (1)  04222071
042230                             SET DP030-SET-CURSOR-APPL-1          04223071
042240                                                   TO  TRUE       04224071
042250                             SET PS-ERROR          TO TRUE        04225071
042260                             SET ASC-NO-TSQ-UPDATE TO TRUE        04226071
042270                          ELSE                                    04227071
042280                             PERFORM 4500-DELETE-DISTRIBUTION     04228071
042290                             VARYING PV-ITEM  FROM 1 BY 1         04229071
042300                             UNTIL PV-ITEM >                      04230071
042310                                         ASC-HIGHEST-BLOCK-WRITTEN04231071
042320                                OR PS-SOFT-ABORT-ERROR            04232071
042330                                OR PS-ERROR                       04233071
042340                             IF  PS-SOCKET-INITIALIZED-YES        04234071
042350                                 PERFORM 4655-CLOSE-SOCKET        04235071
042360                             END-IF                               04236071
042370                             SET  PS-INITIAL-EDIT                 04237071
042380                                  ASC-PO-RCVR-DWNLD-P2L-N         04238071
042390                                  ASC-2ND-CONFIRM-UNKNOWN         04239071
042400                                  ASC-2ND-CONFIRM-DEL-NO          04240071
042410                                                        TO TRUE   04241071
042420                             IF  PS-NO-SOFT-ABORT-ERROR           04242071
042430                                 PERFORM                          04243071
042440                                     3000-EDIT-DATA-IN-COMMAREA   04244071
042450                             END-IF                               04245071
042460                         END-IF                                   04246071
042470                     END-IF                                       04247071
042480                     END-IF                                       04248071
042490                 END-IF                                           04249071
042500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             04250071
042510             END-IF                                               04251071
042520                                                                  04252071
042530             IF  ASC-CONFIRM-IGNORE                               04253071
042540                 SET PS-LINE-USING-UCC128  TO  TRUE               04254071
042550                 PERFORM 2190-CHECK-LINES-USING-UCC128            04255071
042560                 VARYING PV-ITEM FROM 1 BY 1                      04256071
042570                   UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN      04257071
042580                      OR PS-LINE-NOT-USING-UCC128                 04258071
042590                 IF  PS-LINE-NOT-USING-UCC128                     04259071
042600                     SET  PS-IGNORE-UCC128-NOT-ALLOW  TO  TRUE    04260071
042610                 ELSE                                             04261071
042620                     SET  PS-IGNORE-UCC128-ALLOWED    TO  TRUE    04262071
042630                 END-IF                                           04263071
042640                                                                  04264071
042650                 IF  PS-IGNORE-UCC128-NOT-ALLOW                   04265071
042660                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         04266071
042670                     MOVE PC-TSYMSG-02498  TO DP020-MSG-NUMBER    04267071
042680                     SET DP020-MSG-FATAL   TO TRUE                04268071
042690                     MOVE -1               TO MR-SELECTL (1)      04269071
042700                     SET DP030-SET-CURSOR-APPL-1                  04270071
042710                                           TO TRUE                04271071
042720                     SET PS-ERROR          TO TRUE                04272071
042730                     SET ASC-NO-TSQ-UPDATE TO TRUE                04273071
042740                 END-IF                                           04274071
042750                                                                  04275071
042760                 IF  PS-IGNORE-UCC128-ALLOWED                     04276071
042770                     IF  ASC-NUMBER-OF-SELECTED-ITEMS = ZERO      04277071
042780                         MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER04278071
042790                         SET DP020-MSG-FATAL   TO TRUE            04279071
042800                         MOVE -1               TO MR-SELECTL (1)  04280071
042810                         SET DP030-SET-CURSOR-APPL-1              04281071
042820                                               TO TRUE            04282071
042830                         SET PS-ERROR          TO TRUE            04283071
042840                         SET ASC-NO-TSQ-UPDATE TO TRUE            04284071
042850                     ELSE                                         04285071
042860                         PERFORM 7420-IGNORE-UCC128-DATA          04286071
042870                         VARYING PV-ITEM  FROM 1 BY 1             04287071
042880                         UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN04288071
042890                            OR PS-SOFT-ABORT-ERROR                04289071
042900                            OR PS-ERROR                           04290071
042910                         SET  PS-INITIAL-EDIT                     04291071
042920                              ASC-PO-RCVR-DWNLD-P2L-N  TO  TRUE   04292071
042930                         IF  PS-NO-SOFT-ABORT-ERROR               04293071
042940                             PERFORM 3000-EDIT-DATA-IN-COMMAREA   04294071
042950                         END-IF                                   04295071
042960                     END-IF                                       04296071
042970                 END-IF                                           04297071
042980                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             04298071
042990             END-IF                                               04299071
043000                                                                  04300071
043010             IF PS-NO-ERROR                                       04301071
043020               IF  ASC-CONFIRM-TROUBLE-NO  OR                     04302071
043030                   ASC-CONFIRM-IGNORE-NO                          04303071
043040                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN           04304071
043050                   SET  PS-ERROR DP020-MSG-FATAL TO TRUE          04305071
043060                   MOVE PC-TSYMSG-00045  TO DP020-MSG-NUMBER      04306071
043070               END-IF                                             04307071
043080             END-IF                                               04308071
043090                                                                  04309071
043100             IF  ASC-2ND-CONFIRM-NEED                             04310071
043110                 CONTINUE                                         04311071
043120             ELSE                                                 04312071
043130             SET  ASC-CONFIRM-DELETE-NO                           04313071
043140                  ASC-CONFIRM-IGNORE-NO   TO  TRUE                04314071
043150             END-IF                                               04315071
043160                                                                  04316071
043170*                                                                 04317071
043180* F14 - CRTNASGN (CARTON ASSIGNED)                                04318071
043190*                                                                 04319071
043200         WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)              04320071
043210             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              04321071
043220                 SET ASC-CARTON-QUEUE  TO  TRUE                   04322071
043230                  INITIALIZE SU003-INTER-APPL-COMMAREA            04323071
043240                  MOVE ASC-NUMBER-OF-SELECTED-ITEMS               04324071
043250                                 TO SU003-NUMBER-OF-SELECTED-ITEMS04325071
043260                  MOVE ASC-PO-NBR                                 04326071
043270                                 TO SU003-PO-NBR                  04327071
043280                  MOVE ASC-REC-SEQ-NBR                            04328071
043290                                 TO SU003-REC-SEQ-NBR             04329071
043300                  MOVE ASC-OPER-UNT-ID                            04330071
043310                                 TO SU003-OPER-UNT-ID             04331071
043320                  MOVE ASC-FCLTY-ID                               04332071
043330                                 TO SU003-FCLTY-ID                04333071
043340                  MOVE ASC-PKGNG-CD                               04334071
043350                                 TO SU003-PKGNG-CD                04335071
043360                 PERFORM 5001-PREPARE-SEL-QUEUE-CRTN              04336071
043370             ELSE                                                 04337071
043380                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             04338071
043390                 SET DP030-OVERRIDE-GO                            04339071
043400                                   TO TRUE                        04340071
043410                 MOVE PC-TSYMSG-00057                             04341071
043420                                   TO DP020-MSG-NUMBER            04342071
043430                 SET DP020-MSG-WARNING                            04343071
043440                                   TO TRUE                        04344071
043450             END-IF                                               04345071
043460* F6-FIRST PAGE                                                   04346071
043470                                                                  04347071
043480         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  04348071
043490             MOVE +1               TO PV-TOP-ITEM                 04349071
043500             PERFORM 3200-RESET-ATTRIBUTES                        04350071
043510             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   04351071
043520             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 04352071
043530                                                                  04353071
043540             IF  ASC-CONFIRM-DELETE                               04354071
043550                 MOVE  PC-TSYMSG-00354 TO  DP020-MSG-NUMBER       04355071
043560                 SET DP020-MSG-FATAL   TO  TRUE                   04356071
043570                 MOVE -1               TO  MR-SELECTL(1)          04357071
043580                 SET DP030-SET-CURSOR-APPL-1                      04358071
043590                                       TO  TRUE                   04359071
043600                 SET PS-ERROR          TO TRUE                    04360071
043610                 SET ASC-NO-TSQ-UPDATE TO TRUE                    04361071
043620             END-IF                                               04362071
043630                                                                  04363071
043640             IF  PS-UCC128-CRTN-MLT-LNE                           04364071
043650                 SET DP020-MSG-FATAL                              04365071
043660                     ASC-UCC128-MLT-LNE-YES  TO  TRUE             04366071
043670                 MOVE PC-TSYMSG-02502 TO  DP020-MSG-NUMBER        04367071
043680             END-IF                                               04368071
043690                                                                  04369071
043700* F7-PREVIOUS PAGE                                                04370071
043710                                                                  04371071
043720         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   04372071
043730             PERFORM 3200-RESET-ATTRIBUTES                        04373071
043740             MOVE -1               TO  MR-SELECTL(1)              04374071
043750             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   04375071
043760             PERFORM 2110-BROWSE-BACKWARD                         04376071
043770             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 04377071
043780                                                                  04378071
043790             IF  ASC-CONFIRM-DELETE                               04379071
043800                 MOVE  PC-TSYMSG-00354 TO  DP020-MSG-NUMBER       04380071
043810                 SET DP020-MSG-FATAL   TO  TRUE                   04381071
043820                 MOVE -1               TO  MR-SELECTL(1)          04382071
043830                 SET DP030-SET-CURSOR-APPL-1                      04383071
043840                                       TO  TRUE                   04384071
043850                 SET PS-ERROR          TO TRUE                    04385071
043860                 SET ASC-NO-TSQ-UPDATE TO TRUE                    04386071
043870             END-IF                                               04387071
043880                                                                  04388071
043890             IF  PS-UCC128-CRTN-MLT-LNE                           04389071
043900                 SET DP020-MSG-FATAL                              04390071
043910                     ASC-UCC128-MLT-LNE-YES  TO  TRUE             04391071
043920                 MOVE PC-TSYMSG-02502 TO  DP020-MSG-NUMBER        04392071
043930             END-IF                                               04393071
043940                                                                  04394071
043950                                                                  04395071
043960* F8-NEXT PAGE                                                    04396071
043970                                                                  04397071
043980         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   04398071
043990             PERFORM 3200-RESET-ATTRIBUTES                        04399071
044000             MOVE -1               TO  MR-SELECTL(1)              04400071
044010             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   04401071
044020             PERFORM 2120-BROWSE-FORWARD                          04402071
044030             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 04403071
044040                                                                  04404071
044050             IF  ASC-CONFIRM-DELETE                               04405071
044060                 MOVE  PC-TSYMSG-00354 TO  DP020-MSG-NUMBER       04406071
044070                 SET DP020-MSG-FATAL   TO  TRUE                   04407071
044080                 MOVE -1               TO  MR-SELECTL(1)          04408071
044090                 SET DP030-SET-CURSOR-APPL-1                      04409071
044100                                       TO  TRUE                   04410071
044110                 SET PS-ERROR          TO TRUE                    04411071
044120                 SET ASC-NO-TSQ-UPDATE TO TRUE                    04412071
044130             END-IF                                               04413071
044140                                                                  04414071
044150             IF  PS-UCC128-CRTN-MLT-LNE                           04415071
044160                 SET DP020-MSG-FATAL                              04416071
044170                     ASC-UCC128-MLT-LNE-YES  TO  TRUE             04417071
044180                 MOVE PC-TSYMSG-02502 TO  DP020-MSG-NUMBER        04418071
044190             END-IF                                               04419071
044200                                                                  04420071
044210* ENTER                                                           04421071
044220                                                                  04422071
044230         WHEN DP020-SRC-AID = DP016-ENTER                         04423071
044240             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   04424071
044250             IF  PS-ERROR                                         04425071
044260                 SET  PS-ANY-EDIT  TO  TRUE                       04426071
044270                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             04427071
044280             ELSE                                                 04428071
044290                 PERFORM 3200-RESET-ATTRIBUTES                    04429071
044300                 SET  PS-ANY-EDIT  TO  TRUE                       04430071
044310                 PERFORM 3000-EDIT-DATA-IN-COMMAREA               04431071
044320                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             04432071
044330             END-IF                                               04433071
044340                                                                  04434071
044350             IF  ASC-CONFIRM-DELETE                               04435071
044360                 MOVE  PC-TSYMSG-00354 TO  DP020-MSG-NUMBER       04436071
044370                 SET DP020-MSG-FATAL   TO  TRUE                   04437071
044380                 MOVE -1               TO  MR-SELECTL(1)          04438071
044390                 SET DP030-SET-CURSOR-APPL-1                      04439071
044400                                       TO  TRUE                   04440071
044410                 SET PS-ERROR          TO TRUE                    04441071
044420                 SET ASC-NO-TSQ-UPDATE TO TRUE                    04442071
044430             END-IF                                               04443071
044440                                                                  04444071
044450             IF  PS-UCC128-CRTN-MLT-LNE                           04445071
044460                 SET DP020-MSG-FATAL                              04446071
044470                     ASC-UCC128-MLT-LNE-YES  TO  TRUE             04447071
044480                 MOVE PC-TSYMSG-02502 TO  DP020-MSG-NUMBER        04448071
044490             END-IF                                               04449071
044500                                                                  04450071
044510* F24 - LOCAL FUNC 02                                             04451071
044520* F18 - LOCAL FUNC 03                                             04452071
044530* F17 - LOCAL FUNC 04                                             04453071
044540* F22 - LOCAL FUNC 07                                             04454071
044550* F19 - LOCAL FUNC 09                                             04455071
044560                                                                  04456071
044570         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              04457071
044580         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              04458071
044590         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              04459071
044600         WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)              04460071
044610         WHEN DP020-FK-LOCAL-FUNC-09 (DP020-SRC-AID)              04461071
044620              CONTINUE                                            04462071
044630                                                                  04463071
044640* OTHER                                                           04464071
044650                                                                  04465071
044660         WHEN OTHER                                               04466071
044670             SET DP013-NO-ROLLBACK                                04467071
044680                 DP013-XCTL-DISPLAY-RESTART                       04468071
044690                 DP013-CICS-ABEND  TO TRUE                        04469071
044700             MOVE '2100-CHECK-FUNCTION-KEY'                       04470071
044710                                   TO DP013-PARAGRAPH             04471071
044720             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      04472071
044730                                   TO DP013-MESSAGE-TEXT (1)      04473071
044740             PERFORM DP013-0000-PROCESS-ABEND                     04474071
044750     END-EVALUATE.                                                04475071
044760                                                                  04476071
044770                                                                  04477071
044780*----------------------------------------------------------------*04478071
044790* CHECK TO SEE IF USER HAS RACF AUTHORIZATION FOR DELETE FUNCTION*04479071
044800*----------------------------------------------------------------*04480071
044810 2105-RACF-ACCESS.                                                04481071
044820                                                                  04482071
044830      SET DP008-RSRC-TYPE-FUNC           TO TRUE                  04483071
044840      MOVE 'PCP2LDEL'                    TO DP008-FUNCTION-NAME   04484071
044850      SET DP008-ACCESS-TYPE-USE          TO TRUE                  04485071
044860                                                                  04486071
044870      EXEC CICS                                                   04487071
044880         LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                 04488071
044890              COMMAREA (DP008-SECURITY-COMMAREA)                  04489071
044900              LENGTH (DP008-SECURITY-COMMAREA-LENGTH)             04490071
044910      END-EXEC                                                    04491071
044920                                                                  04492071
044930      IF DP008-CALL-SUCCESSFUL                                    04493071
044940         IF DP008-ACCESS-ALLOWED                                  04494071
044950             SET PS-DELETE-ALLOWED TO TRUE                        04495071
044960         ELSE                                                     04496071
044970             SET PS-DELETE-NOT-ALLOWED TO TRUE                    04497071
044980         END-IF                                                   04498071
044990     ELSE                                                         04499071
045000         MOVE '2105-RACF-ACCESS'                                  04500071
045010                               TO DP013-PARAGRAPH                 04501071
045020          MOVE 'UNABLE TO ACCESS CICS'                            04502071
045030                               TO DP013-MESSAGE-TEXT (1)          04503071
045040          MOVE SQLCA                 TO DP013-SQLCA               04504071
045050          SET DP013-DB2-ABEND                                     04505071
045060              DP013-XCTL-DISPLAY-RESTART                          04506071
045070                               TO TRUE                            04507071
045080          PERFORM DP013-0000-PROCESS-ABEND                        04508071
045090      END-IF.                                                     04509071
045100                                                                  04510071
045110                                                                  04511071
045120                                                                  04512071
045130*----------------------------------------------------------------*04513071
045140* CHECK TO SEE IF USER HAS RACF AUTHORIZATION FOR DELETE FUNCTION*04514071
045150*----------------------------------------------------------------*04515071
045160 2106-LINK-FKEY-MODULE.                                           04516071
045170                                                                  04517071
045180     INITIALIZE                RC039-FIELDS.                      04518071
045190     MOVE DP020-LOCATION-NBR TO RC039-SIGNON-LOCATION.            04519071
045200     MOVE ASC-OPER-UNT-ID    TO RC039-OPER-UNT-ID.                04520071
045210     MOVE ASC-FCLTY-ID       TO RC039-FCLTY-ID                    04521071
045220     MOVE ASC-PO-NBR         TO RC039-PO-NBR.                     04522071
045230     MOVE ASC-REC-SEQ-NBR    TO RC039-REC-SEQ-NBR.                04523071
045240                                                                  04524071
045250     MOVE DP020-USERID      TO RC039-USER-ID.                     04525071
045260     MOVE 'PCKCS701'        TO RC039-PROGRAM-NAME.                04526071
045270     SET RC039-FUNC-PHY-LBL TO TRUE.                              04527071
045280                                                                  04528071
045290     EXEC CICS                                                    04529071
045300          LINK PROGRAM (PC-FKEY-MODULE)                           04530071
045310          COMMAREA (RC039-FIELDS)                                 04531071
045320          LENGTH (PC-FKEY-MODULE-LENGTH)                          04532071
045330          RESP (PV-CICS-RESP)                                     04533071
045340     END-EXEC.                                                    04534071
045350                                                                  04535071
045360                                                                  04536071
045370     EVALUATE TRUE                                                04537071
045380         WHEN RC039-SUCCESSFUL                                    04538071
045390             IF RC039-FUNCTION-YES                                04539071
045400                SET  PS-INGR-UCC128-ALLOWED TO  TRUE              04540071
045410             ELSE                                                 04541071
045420                SET  PS-INGR-UCC128-NOT-ALLOWED TO TRUE           04542071
045430             END-IF                                               04543071
045440         WHEN OTHER                                               04544071
045450             INITIALIZE  PV-CICS-MSG-AREA2                        04545071
045460             MOVE RC039-PO-NBR                                    04546071
045470               TO  PV-DISPLAY-PO-NBR                              04547071
045480             MOVE RC039-REC-SEQ-NBR                               04548071
045490               TO  PV-DISPLAY-RCVR-SEQ-NBR                        04549071
045500             STRING ' PCKCS701 - '   DELIMITED BY SIZE            04550071
045510           '2106-LINK-FKEY-MODULE '  DELIMITED BY SIZE            04551071
045520                    ' PURCH ORD '    DELIMITED BY SIZE            04552071
045530                 PV-DISPLAY-PO-NBR   DELIMITED BY SIZE            04553071
045540                    'RCVR  -'        DELIMITED BY SIZE            04554071
045550            PV-DISPLAY-RCVR-SEQ-NBR  DELIMITED BY SIZE            04555071
045560                    'ERROR IND '     DELIMITED BY SIZE            04556071
045570               RC039-SUCCESS-IND     DELIMITED BY SIZE            04557071
045580                                 INTO PV-CICS-MSG-AREA2           04558071
045590             MOVE LENGTH OF PV-CICS-MSG-AREA2                     04559071
045600               TO PV-COMMAREA-LENGTH                              04560071
045610             EXEC CICS                                            04561071
045620                  WRITEQ TD                                       04562071
045630                   QUEUE  ('CSSL')                                04563071
045640                    FROM  (PV-CICS-MSG-AREA2)                     04564071
045650                  LENGTH  (PV-COMMAREA-LENGTH)                    04565071
045660                    RESP  (PV-CICS-RESP)                          04566071
045670             END-EXEC                                             04567071
045680                                                                  04568071
045690             MOVE '2106-LINK-FKEY-MODULE '                        04569071
045700                                  TO DP013-PARAGRAPH              04570071
045710             MOVE 'UNABLE TO ACCESS CICS'                         04571071
045720                                  TO DP013-MESSAGE-TEXT (1)       04572071
045730             MOVE SQLCA                 TO DP013-SQLCA            04573071
045740             SET DP013-DB2-ABEND                                  04574071
045750                 DP013-XCTL-DISPLAY-RESTART                       04575071
045760                                  TO TRUE                         04576071
045770             PERFORM DP013-0000-PROCESS-ABEND                     04577071
045780      END-EVALUATE.                                               04578071
045790                                                                  04579071
045800 2107-GET-BEFORE-PRICE-CHG-DAYS.                                  04580071
045810      EXEC SQL                                                    04581071
045820          SELECT FUNC_QTY                                         04582071
045830            INTO  :PV-PPCBEF-QTY                                  04583071
045840            FROM TKRPRPM                                          04584071
045850           WHERE SYS_PRC_FUNC_CDE = 'PPCBEF'                      04585071
045860             WITH UR                                              04586071
045870      END-EXEC.                                                   04587071
045880                                                                  04588071
045890      EVALUATE TRUE                                               04589071
045900          WHEN SQLCODE = +0                                       04590071
046000              continue                                            04600071
046010          WHEN SQLCODE = +100                                     04601071
046020              CONTINUE                                            04602071
046030          WHEN OTHER                                              04603071
046040              SET PS-ERROR    TO TRUE                             04604071
046050              MOVE '2107-GET-BEFORE-PRICE-CHG-DAYS'               04605071
046060                  TO DP013-PARAGRAPH                              04606071
046070              MOVE 'CHECKING PARM TABLE' TO DP013-MESSAGE-TEXT (1)04607071
046080              MOVE SQLCA   TO DP013-SQLCA                         04608071
046090              MOVE 'TKRPRPM ' TO DP013-DB2-TABLE-NAME (1)         04609071
046100              SET DP013-DB2-ABEND                                 04610071
046110                  DP013-XCTL-DISPLAY-RESTART TO TRUE              04611071
046120              PERFORM DP013-0000-PROCESS-ABEND                    04612071
046130      END-EVALUATE.                                               04613071
046140                                                                  04614071
046150 2108-GET-AFTER-PRICE-CHG-DAYS.                                   04615071
046160      EXEC SQL                                                    04616071
046170          SELECT FUNC_QTY                                         04617071
046180            INTO  :PV-PPCAFT-QTY                                  04618071
046190            FROM TKRPRPM                                          04619071
046200           WHERE SYS_PRC_FUNC_CDE = 'PPCAFT'                      04620071
046210             WITH UR                                              04621071
046220      END-EXEC.                                                   04622071
046230                                                                  04623071
046240      EVALUATE TRUE                                               04624071
046250          WHEN SQLCODE = +0                                       04625071
046260              continue                                            04626071
046270          WHEN SQLCODE = +100                                     04627071
046280              CONTINUE                                            04628071
046290          WHEN OTHER                                              04629071
046300              SET PS-ERROR    TO TRUE                             04630071
046310              MOVE '2108-GET-AFTER-PRICE-CHG-DAYS'                04631071
046320                  TO DP013-PARAGRAPH                              04632071
046330              MOVE 'CHECKING PARM TABLE' TO DP013-MESSAGE-TEXT (1)04633071
046340              MOVE SQLCA   TO DP013-SQLCA                         04634071
046350              MOVE 'TKRPRPM ' TO DP013-DB2-TABLE-NAME (1)         04635071
046360              SET DP013-DB2-ABEND                                 04636071
046370                  DP013-XCTL-DISPLAY-RESTART TO TRUE              04637071
046380              PERFORM DP013-0000-PROCESS-ABEND                    04638071
046390      END-EVALUATE.                                               04639071
046400                                                                  04640071
046410                                                                  04641071
046420                                                                  04642071
046430*----------------------------------------------------------------*04643071
046440*----------------------------------------------------------------*04644071
046450*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *04645071
046460*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *04646071
046470*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *04647071
046480*    MESSAGE.                                                    *04648071
046490*----------------------------------------------------------------*04649071
046500 2110-BROWSE-BACKWARD.                                            04650071
046510     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    04651071
046520         GIVING PV-TOP-ITEM.                                      04652071
046530                                                                  04653071
046540     IF  ((PV-TOP-ITEM < +1)                                      04654071
046550       OR (PV-TOP-ITEM = +1))                                     04655071
046560         MOVE +1                   TO PV-TOP-ITEM                 04656071
046570*        -- TOP OF LIST --                                        04657071
046580         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            04658071
046590         SET DP020-MSG-INFORMATIONAL TO TRUE                      04659071
046600     END-IF.                                                      04660071
046610                                                                  04661071
046620                                                                  04662071
046630*----------------------------------------------------------------*04663071
046640*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *04664071
046650*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *04665071
046660*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *04666071
046670*----------------------------------------------------------------*04667071
046680 2120-BROWSE-FORWARD.                                             04668071
046690                                                                  04669071
046700     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              04670071
046710         GIVING PV-TOP-ITEM.                                      04671071
046720     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   04672071
046730         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            04673071
046740                                   TO PV-TOP-ITEM                 04674071
046750*        -- BOTTOM OF LIST --                                     04675071
046760         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            04676071
046770         SET DP020-MSG-INFORMATIONAL                              04677071
046780                                   TO TRUE                        04678071
046790     ELSE                                                         04679071
046800         COMPUTE PV-BOTTOM-ITEM =                                 04680071
046810             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 04681071
046820         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            04682071
046830*            -- BOTTOM OF LIST --                                 04683071
046840             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            04684071
046850             SET DP020-MSG-INFORMATIONAL                          04685071
046860                                   TO TRUE                        04686071
046870         END-IF                                                   04687071
046880     END-IF.                                                      04688071
046890                                                                  04689071
046900                                                                  04690071
046910*----------------------------------------------------------------*04691071
046920*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *04692071
046930*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *04693071
046940*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *04694071
046950*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *04695071
046960*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *04696071
046970*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *04697071
046980*----------------------------------------------------------------*04698071
046990 2130-CHECK-FOR-JUMP-BROWSE.                                      04699071
047000     SET PS-NO-ERROR               TO TRUE.                       04700071
047010     IF (ASC-START-ITEM-REQUEST = SPACE)                          04701071
047020         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            04702071
047030                                   TO PV-TOP-ITEM                 04703071
047040     ELSE                                                         04704071
047050         MOVE ASC-START-ITEM-REQUEST                              04705071
047060                                   TO DP010I-UNEDITED-FIELD       04706071
047070         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     04707071
047080         MOVE LENGTH OF ASC-START-ITEM-REQUEST                    04708071
047090                                 TO DP010I-MAXIMUM-DIGITS         04709071
047100         SET DP010I-NEGATIVE-NOT-ALLOWED                          04710071
047110                                   TO TRUE                        04711071
047120         CALL DP010I-NUMERIC-EDIT-ROUTINE                         04712071
047130                         USING DP010I-NUMERIC-EDIT-AREA           04713071
047140                                                                  04714071
047150         IF  NOT DP010I-ERROR-DETECTED                            04715071
047160             MOVE DP010I-NUMERIC-FIELD                            04716071
047170                                   TO  ASC-START-ITEM-REQUEST-N   04717071
047180             IF  ASC-START-ITEM-REQUEST-N > ZERO                  04718071
047190                 IF  ASC-START-ITEM-REQUEST-N >                   04719071
047200                                          ASC-NUMBER-OF-ITEMS-READ04720071
047210                     MOVE SPACE TO ASC-START-ITEM-REQUEST         04721071
047220                     COMPUTE PV-TOP-ITEM =                        04722071
047230                             ASC-NUMBER-OF-ITEMS-READ             04723071
047240                             - PC-ITEMS-PER-PANEL + 1             04724071
047250                     IF  PV-TOP-ITEM < +1                         04725071
047260                         MOVE +1   TO PV-TOP-ITEM                 04726071
047270                         MOVE PC-TSYMSG-00070                     04727071
047280                                   TO DP020-MSG-NUMBER            04728071
047290                         SET DP020-MSG-INFORMATIONAL              04729071
047300                                   TO TRUE                        04730071
047310                     ELSE                                         04731071
047320                         MOVE  PV-TOP-ITEM                        04732071
047330                           TO  ASC-START-ITEM-REQUEST-N           04733071
047340                     END-IF                                       04734071
047350                 ELSE                                             04735071
047360                     MOVE ASC-START-ITEM-REQUEST-N                04736071
047370                                   TO PV-TOP-ITEM                 04737071
047380                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      04738071
047390                     COMPUTE PV-BOTTOM-ITEM =                     04739071
047400                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     04740071
047410                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ04741071
047420                         SUBTRACT  PV-TOP-ITEM                    04742071
047430                             FROM  ASC-NUMBER-OF-ITEMS-READ       04743071
047440                           GIVING  ASC-ITEMS-DISPLAYED            04744071
047450                         MOVE  ASC-NUMBER-OF-ITEMS-READ           04745071
047460                           TO  PV-BOTTOM-ITEM                     04746071
047470*                        -- BOTTOM OF LIST --                     04747071
047480                         MOVE PC-TSYMSG-00070                     04748071
047490                                   TO DP020-MSG-NUMBER            04749071
047500                         SET DP020-MSG-INFORMATIONAL              04750071
047510                                   TO TRUE                        04751071
047520                     END-IF                                       04752071
047530                 END-IF                                           04753071
047540             ELSE                                                 04754071
047550*                --- VALUE OUT OF RANGE ----                      04755071
047560                 MOVE PC-TSYMSG-00101                             04756071
047570                                   TO DP020-MSG-NUMBER            04757071
047580                 MOVE -1           TO ASTRTITL                    04758071
047590                 SET DP030-SET-CURSOR-APPL-1                      04759071
047600                                   TO TRUE                        04760071
047610                 MOVE DP015-REVERSE                               04761071
047620                                   TO ASTRTITH                    04762071
047630                 MOVE DP015-RED    TO ASTRTITC                    04763071
047640                 MOVE DP015-UNP-NUM-BRT-MDT                       04764071
047650                                   TO ASTRTITA                    04765071
047660                 SET DP020-MSG-FATAL                              04766071
047670                                   TO TRUE                        04767071
047680                 SET PS-ERROR      TO TRUE                        04768071
047690             END-IF                                               04769071
047700                                                                  04770071
047710         ELSE                                                     04771071
047720             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            04772071
047730             MOVE -1               TO ASTRTITL                    04773071
047740             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  04774071
047750             MOVE DP015-REVERSE    TO ASTRTITH                    04775071
047760             MOVE DP015-RED        TO ASTRTITC                    04776071
047770             MOVE DP015-UNP-NUM-BRT-MDT                           04777071
047780                                   TO ASTRTITA                    04778071
047790             SET DP020-MSG-FATAL   TO TRUE                        04779071
047800             SET PS-ERROR          TO TRUE                        04780071
047810         END-IF                                                   04781071
047820     END-IF.                                                      04782071
047830                                                                  04783071
047840                                                                  04784071
047850*----------------------------------------------------------------*04785071
047860*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *04786071
047870*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *04787071
047880*----------------------------------------------------------------*04788071
047890 2140-DESELECT-ALL-ITEMS.                                         04789071
047900     MOVE +1                       TO ASC-BLK-SUB.                04790071
047910                                                                  04791071
047920     PERFORM 2141-CLEAR-SELECTED-INDS                             04792071
047930         VARYING ASC-ITEM-SUB                                     04793071
047940         FROM 1 BY 1                                              04794071
047950         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 04795071
047960                                                                  04796071
047970     ADD +1                        TO ASC-BLK-SUB.                04797071
047980                                                                  04798071
047990     PERFORM 2141-CLEAR-SELECTED-INDS                             04799071
048000         VARYING ASC-ITEM-SUB                                     04800071
048010         FROM 1 BY 1                                              04801071
048020         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 04802071
048030                                                                  04803071
048040     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               04804071
048050                                   TO PV-LIST-ITEM-NUMBER.        04805071
048060                                                                  04806071
048070     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            04807071
048080         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    04808071
048090                                                                  04809071
048100     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     04810071
048110        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      04811071
048120         MOVE +1                   TO ASC-BLK-SUB                 04812071
048130                                                                  04813071
048140         PERFORM 5100-WRITE-TEMP-STORAGE                          04814071
048150         MOVE +2                   TO ASC-BLK-SUB                 04815071
048160         PERFORM 5100-WRITE-TEMP-STORAGE                          04816071
048170         MOVE +1                   TO ASC-BLK-SUB                 04817071
048180                                                                  04818071
048190         MOVE +1                   TO PV-BLOCK-NUMBER             04819071
048200                                                                  04820071
048210         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         04821071
048220             PV-FIRST-BLOCK-IN-ARRAY - 1                          04822071
048230                                                                  04823071
048240         PERFORM                                                  04824071
048250             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       04825071
048260                                                                  04826071
048270             PERFORM 4410-READ-TEMP-STORAGE                       04827071
048280                                                                  04828071
048290             PERFORM 2141-CLEAR-SELECTED-INDS                     04829071
048300                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 04830071
048310                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          04831071
048320                                                                  04832071
048330             PERFORM 5100-WRITE-TEMP-STORAGE                      04833071
048340                                                                  04834071
048350             ADD +1                TO PV-BLOCK-NUMBER             04835071
048360                                                                  04836071
048370         END-PERFORM                                              04837071
048380                                                                  04838071
048390         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         04839071
048400             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     04840071
048410                                                                  04841071
048420         PERFORM                                                  04842071
048430             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       04843071
048440                   ASC-HIGHEST-BLOCK-WRITTEN                      04844071
048450                                                                  04845071
048460             MOVE PV-NEXT-BLOCK-IN-ARRAY                          04846071
048470                                   TO PV-BLOCK-NUMBER             04847071
048480                                                                  04848071
048490             PERFORM 4410-READ-TEMP-STORAGE                       04849071
048500                                                                  04850071
048510             PERFORM 2141-CLEAR-SELECTED-INDS                     04851071
048520                 VARYING ASC-ITEM-SUB                             04852071
048530                 FROM 1 BY 1                                      04853071
048540                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          04854071
048550                                                                  04855071
048560             PERFORM 5100-WRITE-TEMP-STORAGE                      04856071
048570                                                                  04857071
048580             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      04858071
048590                                                                  04859071
048600         END-PERFORM                                              04860071
048610                                                                  04861071
048620         MOVE PV-FIRST-BLOCK-IN-ARRAY                             04862071
048630                                   TO PV-BLOCK-NUMBER             04863071
048640                                                                  04864071
048650         PERFORM 4410-READ-TEMP-STORAGE                           04865071
048660     END-IF.                                                      04866071
048670                                                                  04867071
048680                                                                  04868071
048690     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 04869071
048700     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.04870071
048710     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  04871071
048720                                                                  04872071
048730     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        04873071
048740                                                                  04874071
048750                                                                  04875071
048760*----------------------------------------------------------------*04876071
048770*    MARK EACH ITEM AS BEING NOT SELECTED.                       *04877071
048780*----------------------------------------------------------------*04878071
048790 2141-CLEAR-SELECTED-INDS.                                        04879071
048800                                                                  04880071
048810     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           04881071
048820             NOT EQUAL ZERO                                       04882071
048830         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          04883071
048840             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          04884071
048850                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    04885071
048860                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  04886071
048870                                   TO TRUE                        04887071
048880         END-IF                                                   04888071
048890     END-IF.                                                      04889071
048900                                                                  04890071
048910                                                                  04891071
048920*----------------------------------------------------------------*04892071
048930*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *04893071
048940*  FOR ALL ITEMS.                                                *04894071
048950*----------------------------------------------------------------*04895071
048960 2150-SELECT-ALL-ITEMS.                                           04896071
048970                                                                  04897071
048980     MOVE +1                       TO ASC-BLK-SUB.                04898071
048990                                                                  04899071
049000     PERFORM 2151-SET-SELECTED-INDS                               04900071
049010         VARYING ASC-ITEM-SUB                                     04901071
049020         FROM 1 BY 1                                              04902071
049030         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 04903071
049040                                                                  04904071
049050     ADD +1                        TO ASC-BLK-SUB.                04905071
049060                                                                  04906071
049070     PERFORM 2151-SET-SELECTED-INDS                               04907071
049080         VARYING ASC-ITEM-SUB                                     04908071
049090         FROM 1 BY 1                                              04909071
049100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 04910071
049110                                                                  04911071
049120     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               04912071
049130                                   TO PV-LIST-ITEM-NUMBER.        04913071
049140                                                                  04914071
049150     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            04915071
049160         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    04916071
049170                                                                  04917071
049180     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            04918071
049190         MOVE +1                   TO ASC-BLK-SUB                 04919071
049200                                                                  04920071
049210         PERFORM 5100-WRITE-TEMP-STORAGE                          04921071
049220         MOVE +2                   TO ASC-BLK-SUB                 04922071
049230         PERFORM 5100-WRITE-TEMP-STORAGE                          04923071
049240         MOVE +1                   TO ASC-BLK-SUB                 04924071
049250         MOVE +1                   TO PV-BLOCK-NUMBER             04925071
049260     END-IF.                                                      04926071
049270                                                                  04927071
049280     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     04928071
049290        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    04929071
049300         MOVE +1                   TO ASC-BLK-SUB                 04930071
049310                                                                  04931071
049320         PERFORM 5100-WRITE-TEMP-STORAGE                          04932071
049330         MOVE +2                   TO ASC-BLK-SUB                 04933071
049340         PERFORM 5100-WRITE-TEMP-STORAGE                          04934071
049350         MOVE +1                   TO ASC-BLK-SUB                 04935071
049360         MOVE +1                   TO PV-BLOCK-NUMBER             04936071
049370                                                                  04937071
049380         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         04938071
049390             PV-FIRST-BLOCK-IN-ARRAY - 1                          04939071
049400                                                                  04940071
049410         PERFORM                                                  04941071
049420             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       04942071
049430                                                                  04943071
049440             PERFORM 4410-READ-TEMP-STORAGE                       04944071
049450                                                                  04945071
049460             PERFORM 2151-SET-SELECTED-INDS                       04946071
049470                 VARYING ASC-ITEM-SUB                             04947071
049480                 FROM 1 BY 1                                      04948071
049490                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          04949071
049500                                                                  04950071
049510             PERFORM 5100-WRITE-TEMP-STORAGE                      04951071
049520                                                                  04952071
049530             ADD +1                TO PV-BLOCK-NUMBER             04953071
049540                                                                  04954071
049550         END-PERFORM                                              04955071
049560                                                                  04956071
049570         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         04957071
049580             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     04958071
049590                                                                  04959071
049600         PERFORM                                                  04960071
049610             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       04961071
049620                   ASC-HIGHEST-BLOCK-WRITTEN                      04962071
049630                                                                  04963071
049640             MOVE PV-NEXT-BLOCK-IN-ARRAY                          04964071
049650                                   TO PV-BLOCK-NUMBER             04965071
049660                                                                  04966071
049670             PERFORM 4410-READ-TEMP-STORAGE                       04967071
049680                                                                  04968071
049690             PERFORM 2151-SET-SELECTED-INDS                       04969071
049700                 VARYING ASC-ITEM-SUB                             04970071
049710                 FROM 1 BY 1                                      04971071
049720                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          04972071
049730                                                                  04973071
049740             PERFORM 5100-WRITE-TEMP-STORAGE                      04974071
049750                                                                  04975071
049760             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      04976071
049770                                                                  04977071
049780         END-PERFORM                                              04978071
049790                                                                  04979071
049800         MOVE PV-FIRST-BLOCK-IN-ARRAY                             04980071
049810                                   TO PV-BLOCK-NUMBER             04981071
049820                                                                  04982071
049830         PERFORM 4410-READ-TEMP-STORAGE                           04983071
049840     END-IF.                                                      04984071
049850                                                                  04985071
049860                                                                  04986071
049870     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             04987071
049880                       ASC-NUMBER-OF-SELECTED-ITEMS.              04988071
049890                                                                  04989071
049900     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        04990071
049910                                                                  04991071
049920                                                                  04992071
049930*----------------------------------------------------------------*04993071
049940*    MARK EACH ITEM AS BEING SELECTED.                           *04994071
049950*----------------------------------------------------------------*04995071
049960 2151-SET-SELECTED-INDS.                                          04996071
049970     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           04997071
049980             NOT EQUAL ZERO                                       04998071
049990         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             04999071
050000             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             05000071
050010                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        05001071
050020                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  05002071
050030                               TO  TRUE                           05003071
050040         END-IF                                                   05004071
050050     END-IF.                                                      05005071
050060                                                                  05006071
050070                                                                  05007071
050080*----------------------------------------------------------------*05008071
050090*                                                                *05009071
050100*----------------------------------------------------------------*05010071
050110 2160-GET-NEXT-RECORD.                                            05011071
050120     ADD +1                       TO ASC-SEL-SUB.                 05012071
050130     IF  ASC-SEL-SUB > PC121-MAX-ITEMS                            05013071
050140         ADD +1                   TO ASC-SEL-ITEM                 05014071
050150         MOVE +1                  TO ASC-SEL-SUB                  05015071
050160     END-IF.                                                      05016071
050170     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                05017071
050180         PERFORM 9100-READ-SEL-QUEUE                              05018071
050190     ELSE                                                         05019071
050200         SUBTRACT +1 FROM ASC-SEL-ITEM                            05020071
050210         MOVE PC121-MAX-ITEMS     TO ASC-SEL-SUB                  05021071
050220         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             05022071
050230         SET DP020-MSG-INFORMATIONAL TO TRUE                      05023071
050240     END-IF.                                                      05024071
050250                                                                  05025071
050260******************************************************************05026071
050270** GET THE MESSAGE NUMBER (KEY) OF THE PREVIOUS SELECTED        **05027071
050280** OBJECT FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.          **05028071
050290******************************************************************05029071
050300 2170-GET-PREV-RECORD.                                            05030071
050310     SUBTRACT +1 FROM ASC-SEL-SUB.                                05031071
050320     IF  ASC-SEL-SUB < +1                                         05032071
050330         SUBTRACT +1 FROM ASC-SEL-ITEM                            05033071
050340         MOVE PC121-MAX-ITEMS      TO ASC-SEL-SUB                 05034071
050350     END-IF.                                                      05035071
050360                                                                  05036071
050370     IF  ASC-SEL-ITEM > ZERO                                      05037071
050380         PERFORM 9100-READ-SEL-QUEUE                              05038071
050390     ELSE                                                         05039071
050400         MOVE +1                   TO ASC-SEL-ITEM                05040071
050410                                      ASC-SEL-SUB                 05041071
050420*        --- TOP OF LIST ---                                      05042071
050430         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            05043071
050440         SET DP020-MSG-INFORMATIONAL                              05044071
050450                                   TO TRUE                        05045071
050460     END-IF.                                                      05046071
050470                                                                  05047071
050480                                                                  05048071
050490*----------------------------------------------------------------*05049071
050500* IF LINES SELECTED FOR DELETE ARE CASEPACK ONLY ALLOW DELETE    *05050071
050510*----------------------------------------------------------------*05051071
050520 2180-CHECK-LINES-CSPK-ONLY.                                      05052071
050530     SET PS-LINE-NOT-PROCESSED-SPLIT  TO  TRUE.                   05053071
050540                                                                  05054071
050550     MOVE +1                          TO ASC-BLK-SUB.             05055071
050560     PERFORM 5100-WRITE-TEMP-STORAGE.                             05056071
050570     ADD +1                           TO ASC-BLK-SUB.             05057071
050580     PERFORM 5100-WRITE-TEMP-STORAGE.                             05058071
050590                                                                  05059071
050600     PERFORM 6112-READ-LIST-QUEUE.                                05060071
050610                                                                  05061071
050620     PERFORM                                                      05062071
050630     VARYING LQW-IDX  FROM 1 BY 1                                 05063071
050640       UNTIL LQW-IDX  >  PC-ITEMS-PER-PANEL         OR            05064071
050650             LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO  OR            05065071
050660             PS-LINE-PROCESSED-AS-SPLIT                           05066071
050670         IF  LQW-SELECT (LQW-IDX)                                 05067071
050680             IF  LQW-P2L-LBL-CNT (LQW-IDX)  >  ZERO  AND          05068071
050690                 LQW-P2L-DYNAPACK (LQW-IDX)                       05069071
050700                 SET  PS-LINE-PROCESSED-AS-SPLIT  TO  TRUE        05070071
050710             END-IF                                               05071071
050720         END-IF                                                   05072071
050730     END-PERFORM.                                                 05073071
050740                                                                  05074071
050750     MOVE  PV-ITEM          TO  PV-SAVE-ITEM.                     05075071
050760     PERFORM 6111-WRITE-LIST-QUEUE.                               05076071
050770                                                                  05077071
050780     MOVE +1   TO  ASC-BLK-SUB.                                   05078071
050790     PERFORM 4410-READ-TEMP-STORAGE.                              05079071
050800                                                                  05080071
050810     ADD  +1   TO  ASC-BLK-SUB                                    05081071
050820                   PV-BLOCK-NUMBER.                               05082071
050830     PERFORM 4410-READ-TEMP-STORAGE.                              05083071
050840                                                                  05084071
050850                                                                  05085071
050860*----------------------------------------------------------------*05086071
050870* CHECK TO SEE IF LINES SELECTED TO IGNORE UCC128 DATA ARE       *05087071
050880* CURRENTLY USING UCC128 DATA                                    *05088071
050890*----------------------------------------------------------------*05089071
050900 2190-CHECK-LINES-USING-UCC128.                                   05090071
050910     SET PS-LINE-USING-UCC128         TO  TRUE.                   05091071
050920                                                                  05092071
050930     MOVE +1                          TO ASC-BLK-SUB.             05093071
050940     PERFORM 5100-WRITE-TEMP-STORAGE.                             05094071
050950     ADD +1                           TO ASC-BLK-SUB.             05095071
050960     PERFORM 5100-WRITE-TEMP-STORAGE.                             05096071
050970                                                                  05097071
050980     PERFORM 6112-READ-LIST-QUEUE.                                05098071
050990                                                                  05099071
051000     PERFORM                                                      05100071
051010     VARYING LQW-IDX  FROM 1 BY 1                                 05101071
051020       UNTIL LQW-IDX  >  PC-ITEMS-PER-PANEL         OR            05102071
051030             LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO  OR            05103071
051040             PS-LINE-NOT-USING-UCC128                             05104071
051050         IF  LQW-SELECT (LQW-IDX)                                 05105071
051060             IF  LQW-LNE-UCC128-YES (LQW-IDX)                     05106071
051070                 CONTINUE                                         05107071
051080             ELSE                                                 05108071
051090                 SET  PS-LINE-NOT-USING-UCC128  TO  TRUE          05109071
051100             END-IF                                               05110071
051110         END-IF                                                   05111071
051120     END-PERFORM.                                                 05112071
051130                                                                  05113071
051140     MOVE  PV-ITEM          TO  PV-SAVE-ITEM.                     05114071
051150     PERFORM 6111-WRITE-LIST-QUEUE.                               05115071
051160                                                                  05116071
051170     MOVE +1   TO  ASC-BLK-SUB.                                   05117071
051180     PERFORM 4410-READ-TEMP-STORAGE.                              05118071
051190                                                                  05119071
051200     ADD  +1   TO  ASC-BLK-SUB                                    05120071
051210                   PV-BLOCK-NUMBER.                               05121071
051220     PERFORM 4410-READ-TEMP-STORAGE.                              05122071
051230                                                                  05123071
051240                                                                  05124071
051250*----------------------------------------------------------------*05125071
051260*  MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE     *05126071
051270*  SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM.  *05127071
051280*----------------------------------------------------------------*05128071
051290 2200-MOVE-SCREEN-TO-COMMAREA.                                    05129071
051300                                                                  05130071
051310     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             05131071
051320     MOVE +1                       TO PV-SUB.                     05132071
051330                                                                  05133071
051340     PERFORM 3100-SET-SUBSCRIPTS.                                 05134071
051350                                                                  05135071
051360     IF  ASTRTITL > ZERO                                          05136071
051370         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          05137071
051380     ELSE                                                         05138071
051390         IF  ASTRTITF = DP015-ERASE-EOF                           05139071
051400             INITIALIZE ASC-START-ITEM-REQUEST                    05140071
051410         END-IF                                                   05141071
051420     END-IF.                                                      05142071
051430                                                                  05143071
051440     IF  MDEST1L > ZERO                                           05144071
051450         MOVE MDEST1I          TO ASC-SML-P2L-PRTR-ID             05145071
051460     ELSE                                                         05146071
051470         IF  MDEST1F = DP015-ERASE-EOF                            05147071
051480             MOVE  SPACES      TO ASC-SML-P2L-PRTR-ID             05148071
051490         END-IF                                                   05149071
051500     END-IF.                                                      05150071
051510                                                                  05151071
051520     IF  MDEST2L > ZERO                                           05152071
051530         MOVE MDEST2I          TO ASC-PGYBCK-PRTR-ID              05153071
051540     ELSE                                                         05154071
051550         IF  MDEST2F = DP015-ERASE-EOF                            05155071
051560             MOVE  SPACES      TO ASC-PGYBCK-PRTR-ID              05156071
051570         END-IF                                                   05157071
051580     END-IF.                                                      05158071
051590                                                                  05159071
051600     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          05160071
051610         VARYING PV-SUB                                           05161071
051620         FROM 1 BY 1                                              05162071
051630         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      05163071
051640                                                                  05164071
051650                                                                  05165071
051660                                                                  05166071
051670*----------------------------------------------------------------*05167071
051680*  MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA *05168071
051690*----------------------------------------------------------------*05169071
051700 2210-MOVE-LINES-TO-COMMAREA.                                     05170071
051710*                                                                 05171071
051720*** SELECT FIELD                                                  05172071
051730*                                                                 05173071
051740     IF  MR-SELECTL (PV-SUB) > ZERO                               05174071
051750         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             05175071
051760         MOVE MR-SELECTI (PV-SUB)  TO ASC-TEMP-SELECTED-SW        05176071
051770                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      05177071
051780     ELSE                                                         05178071
051790         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                05179071
051800             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE         05180071
051810             MOVE SPACE        TO ASC-TEMP-SELECTED-SW            05181071
051820                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      05182071
051830         END-IF                                                   05183071
051840     END-IF.                                                      05184071
051850                                                                  05185071
051860     SET  PS-LINE-NOT-SELECTED  TO  TRUE.                         05186071
051870                                                                  05187071
051880     IF  ASC-TEMP-SELECT (ASC-BLK-SUB, ASC-ITEM-SUB)  OR          05188071
051890         ASC-TEMP-BEGIN  (ASC-BLK-SUB, ASC-ITEM-SUB)  OR          05189071
051900         ASC-TEMP-END    (ASC-BLK-SUB, ASC-ITEM-SUB)              05190071
051910         SET  PS-LINE-SELECTED  TO  TRUE.                         05191071
051920                                                                  05192071
051930     PERFORM 2215-MOVE-FIELDS-TO-COMMAREA.                        05193071
051940                                                                  05194071
051950     ADD +1                        TO ASC-ITEM-SUB.               05195071
051960     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        05196071
051970         IF  ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     05197071
051980             COMPUTE PV-BLOCK-NUMBER  =                           05198071
051990                1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /         05199071
052000                    PC-ITEMS-PER-PANEL                            05200071
052010             PERFORM 5105-REWRITE-ASC-LISTQ                       05201071
052020         END-IF                                                   05202071
052030         ADD +1                    TO ASC-BLK-SUB                 05203071
052040         MOVE +1                   TO ASC-ITEM-SUB                05204071
052050     ELSE                                                         05205071
052060     IF  PV-SUB = ASC-ITEMS-DISPLAYED                             05206071
052070         IF  ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     05207071
052080             COMPUTE PV-BLOCK-NUMBER  =                           05208071
052090                1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /         05209071
052100                    PC-ITEMS-PER-PANEL                            05210071
052110             PERFORM 5105-REWRITE-ASC-LISTQ                       05211071
052120         END-IF                                                   05212071
052130     END-IF.                                                      05213071
052140                                                                  05214071
052150                                                                  05215071
052160*----------------------------------------------------------------*05216071
052170*                                                                *05217071
052180*----------------------------------------------------------------*05218071
052190 2215-MOVE-FIELDS-TO-COMMAREA.                                    05219071
052200*                                                                 05220071
052210*** MODULE NUMBER                                                 05221071
052220*                                                                 05222071
052230     IF  MR-MODL (PV-SUB) > ZERO                                  05223071
052240         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             05224071
052250         MOVE MR-MOD (PV-SUB) TO ASC-MODULE-X                     05225071
052260                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      05226071
052270         MOVE ASC-MODULE-X (ASC-BLK-SUB ASC-ITEM-SUB) TO          05227071
052280                                    DP010I-UNEDITED-FIELD         05228071
052290         MOVE LENGTH OF ASC-MODULE                                05229071
052300                                 TO DP010I-MAXIMUM-DIGITS         05230071
052310         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       05231071
052320         SET DP010I-NEGATIVE-NOT-ALLOWED                          05232071
052330                                 TO TRUE                          05233071
052340         CALL DP010I-NUMERIC-EDIT-ROUTINE                         05234071
052350                         USING DP010I-NUMERIC-EDIT-AREA           05235071
052360             IF  DP010I-ERROR-DETECTED                            05236071
052370                 CONTINUE                                         05237071
052380             ELSE                                                 05238071
052390                 MOVE DP010I-NUMERIC-FIELD                        05239071
052400                   TO ASC-MODULE (ASC-BLK-SUB ASC-ITEM-SUB)       05240071
052410                      MR-MOD (PV-SUB)                             05241071
052420             END-IF                                               05242071
052430     ELSE                                                         05243071
052440         IF  MR-MODA (PV-SUB) = DP015-ERASE-EOF                   05244071
052450             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE         05245071
052460             MOVE ZEROES       TO ASC-MODULE                      05246071
052470                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      05247071
052480         END-IF                                                   05248071
052490     END-IF.                                                      05249071
052500*                                                                 05250071
052510*** CARTON COUNT                                                  05251071
052520*                                                                 05252071
052530     IF  MR-CARTON-CNTL (PV-SUB) > ZERO                           05253071
052540         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             05254071
052550         MOVE MR-CARTON-CNT (PV-SUB) TO ASC-CARTON-COUNT-X        05255071
052560                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      05256071
052570         MOVE ASC-CARTON-COUNT-X(ASC-BLK-SUB ASC-ITEM-SUB) TO     05257071
052580                                    DP010I-UNEDITED-FIELD         05258071
052590         MOVE LENGTH OF ASC-CARTON-COUNT                          05259071
052600                                 TO DP010I-MAXIMUM-DIGITS         05260071
052610         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       05261071
052620         SET DP010I-NEGATIVE-NOT-ALLOWED                          05262071
052630                                 TO TRUE                          05263071
052640         CALL DP010I-NUMERIC-EDIT-ROUTINE                         05264071
052650                         USING DP010I-NUMERIC-EDIT-AREA           05265071
052660             IF  DP010I-ERROR-DETECTED                            05266071
052670                 CONTINUE                                         05267071
052680             ELSE                                                 05268071
052690                 MOVE DP010I-NUMERIC-FIELD                        05269071
052700                                     TO ASC-CARTON-COUNT          05270071
052710                                       (ASC-BLK-SUB ASC-ITEM-SUB) 05271071
052720                                        MR-CARTON-CNT (PV-SUB)    05272071
052730             END-IF                                               05273071
052740     ELSE                                                         05274071
052750         IF  MR-CARTON-CNTA (PV-SUB) = DP015-ERASE-EOF            05275071
052760             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE         05276071
052770             MOVE ZEROES       TO ASC-CARTON-COUNT                05277071
052780                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      05278071
052790         END-IF                                                   05279071
052800     END-IF.                                                      05280071
052810*                                                                 05281071
052820*** INNER PACK QUANTITY                                           05282071
052830*                                                                 05283071
052840     IF  MR-INNER-PACKL (PV-SUB) > ZERO                           05284071
052850         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             05285071
052860         MOVE MR-INNER-PACK (PV-SUB) TO ASC-INNER-PACK-QTY-X      05286071
052870                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      05287071
052880         MOVE ASC-INNER-PACK-QTY-X(ASC-BLK-SUB ASC-ITEM-SUB)      05288071
052890           TO  DP010I-UNEDITED-FIELD                              05289071
052900         MOVE LENGTH OF ASC-INNER-PACK-QTY                        05290071
052910                                 TO DP010I-MAXIMUM-DIGITS         05291071
052920         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       05292071
052930         SET DP010I-NEGATIVE-NOT-ALLOWED                          05293071
052940                                 TO TRUE                          05294071
052950         CALL DP010I-NUMERIC-EDIT-ROUTINE                         05295071
052960                         USING DP010I-NUMERIC-EDIT-AREA           05296071
052970         IF  DP010I-ERROR-DETECTED                                05297071
052980             CONTINUE                                             05298071
052990         ELSE                                                     05299071
053000             MOVE DP010I-NUMERIC-FIELD                            05300071
053010               TO ASC-INNER-PACK-QTY (ASC-BLK-SUB ASC-ITEM-SUB)   05301071
053020                  MR-INNER-PACK (PV-SUB)                          05302071
053030         END-IF                                                   05303071
053040     ELSE                                                         05304071
053050         IF  MR-INNER-PACKA (PV-SUB) = DP015-ERASE-EOF            05305071
053060             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE         05306071
053070             MOVE SPACE        TO ASC-INNER-PACK-QTY-X            05307071
053080                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      05308071
053090         END-IF                                                   05309071
053100     END-IF.                                                      05310071
053110*                                                                 05311071
053120*** OUTER PACK QUANTITY                                           05312071
053130*                                                                 05313071
053140     IF  ASC-MLT-OTPK-UCC128 (ASC-BLK-SUB ASC-ITEM-SUB) AND       05314071
053150         ASC-LNE-UCC128-YES  (ASC-BLK-SUB ASC-ITEM-SUB)           05315071
053160         MOVE ASC-OUTER-PACK-QTY-X (ASC-BLK-SUB ASC-ITEM-SUB)     05316071
053170                             TO  MR-OUTER-PACK (PV-SUB)           05317071
053180     ELSE                                                         05318071
053190     IF  MR-OUTER-PACKL (PV-SUB) > ZERO                           05319071
053200         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             05320071
053210         MOVE MR-OUTER-PACK (PV-SUB) TO ASC-OUTER-PACK-QTY-X      05321071
053220                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      05322071
053230         MOVE ASC-OUTER-PACK-QTY-X (ASC-BLK-SUB ASC-ITEM-SUB)     05323071
053240                                 TO DP010I-UNEDITED-FIELD         05324071
053250         MOVE LENGTH OF ASC-OUTER-PACK-QTY                        05325071
053260                                 TO DP010I-MAXIMUM-DIGITS         05326071
053270         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       05327071
053280         SET DP010I-NEGATIVE-NOT-ALLOWED                          05328071
053290                                 TO TRUE                          05329071
053300         CALL DP010I-NUMERIC-EDIT-ROUTINE                         05330071
053310                         USING DP010I-NUMERIC-EDIT-AREA           05331071
053320             IF  DP010I-ERROR-DETECTED                            05332071
053330                 CONTINUE                                         05333071
053340             ELSE                                                 05334071
053350                 MOVE DP010I-NUMERIC-FIELD                        05335071
053360                                     TO ASC-OUTER-PACK-QTY        05336071
053370                                       (ASC-BLK-SUB ASC-ITEM-SUB) 05337071
053380                                        PV-ZERO-SUP-OTPK          05338071
053390                 MOVE PV-ZERO-SUP-OTPK                            05339071
053400                                     TO MR-OUTER-PACK (PV-SUB)    05340071
053410             END-IF                                               05341071
053420     ELSE                                                         05342071
053430         IF  MR-OUTER-PACKA (PV-SUB) = DP015-ERASE-EOF            05343071
053440             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE         05344071
053450             MOVE ZERO         TO ASC-OUTER-PACK-QTY-X            05345071
053460                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      05346071
053470         END-IF                                                   05347071
053480     END-IF                                                       05348071
053490     END-IF.                                                      05349071
053500*                                                                 05350071
053510*** RECALCULATE PACKS IN CARTON                                   05351071
053520*                                                                 05352071
053530     IF  ASC-OUTER-PACK-QTY (ASC-BLK-SUB, ASC-ITEM-SUB) > 0 AND   05353071
053540         ASC-PREPK-RATIO    (ASC-BLK-SUB, ASC-ITEM-SUB) > 0       05354071
053550         DIVIDE  ASC-OUTER-PACK-QTY (ASC-BLK-SUB, ASC-ITEM-SUB)   05355071
053560             BY  ASC-PREPK-RATIO    (ASC-BLK-SUB, ASC-ITEM-SUB)   05356071
053570         GIVING  ASC-PACKS-IN-CRTN  (ASC-BLK-SUB, ASC-ITEM-SUB)   05357071
053580     END-IF.                                                      05358071
053590*                                                                 05359071
053600*** INNER PACK CONVEYABLE INDICATOR                               05360071
053610*                                                                 05361071
053620     IF  MR-IN-PCK-CONVYL (PV-SUB) > ZERO                         05362071
053630         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             05363071
053640         MOVE MR-IN-PCK-CONVY (PV-SUB) TO ASC-IN-PAK-CONVEY       05364071
053650                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      05365071
053660     END-IF.                                                      05366071
053670*                                                                 05367071
053680*** LABEL TYPE                                                    05368071
053690*                                                                 05369071
053700     IF  MR-LBL-TYPEL (PV-SUB) > ZERO                             05370071
053710         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             05371071
053720         MOVE MR-LBL-TYPE (PV-SUB) TO ASC-LBL-TYP                 05372071
053730                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      05373071
053740     END-IF.                                                      05374071
053750*                                                                 05375071
053760*** CREATE LABEL OPTION BY LINE                                   05376071
053770*                                                                 05377071
053780     IF  MR-CRE-LBL-OPTL (PV-SUB) > ZERO                          05378071
053790         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             05379071
053800         MOVE MR-CRE-LBL-OPT (PV-SUB) TO ASC-LNE-CRE-LBL-OPT      05380071
053810                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      05381071
053820     END-IF.                                                      05382071
053830*                                                                 05383071
053840*** OUTER PACK QUANTITY                                           05384071
053850*                                                                 05385071
053860     IF  MR-ODD-CARTONL (PV-SUB) > ZERO                           05386071
053870         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             05387071
053880         MOVE MR-ODD-CARTON (PV-SUB) TO ASC-ODD-CARTON-X          05388071
053890                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      05389071
053900         MOVE ASC-ODD-CARTON-X (ASC-BLK-SUB ASC-ITEM-SUB)         05390071
053910                                 TO DP010I-UNEDITED-FIELD         05391071
053920         MOVE LENGTH OF ASC-ODD-CARTON                            05392071
053930                                 TO DP010I-MAXIMUM-DIGITS         05393071
053940         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       05394071
053950         SET DP010I-NEGATIVE-NOT-ALLOWED                          05395071
053960                                 TO TRUE                          05396071
053970         CALL DP010I-NUMERIC-EDIT-ROUTINE                         05397071
053980                         USING DP010I-NUMERIC-EDIT-AREA           05398071
053990             IF  DP010I-ERROR-DETECTED                            05399071
054000                 CONTINUE                                         05400071
054010             ELSE                                                 05401071
054020                 MOVE DP010I-NUMERIC-FIELD                        05402071
054030                                     TO ASC-ODD-CARTON            05403071
054040                                       (ASC-BLK-SUB ASC-ITEM-SUB) 05404071
054050                                        MR-ODD-CARTON (PV-SUB)    05405071
054060             END-IF                                               05406071
054070     ELSE                                                         05407071
054080         IF  MR-ODD-CARTONA (PV-SUB) = DP015-ERASE-EOF            05408071
054090             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE         05409071
054100             MOVE ZERO         TO ASC-ODD-CARTON-X                05410071
054110                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      05411071
054120         END-IF                                                   05412071
054130     END-IF.                                                      05413071
054140*                                                                 05414071
054150*** CASEPACK PROCESS AREA                                         05415071
054160*                                                                 05416071
054170     IF  MR-CSEPK-AREAL (PV-SUB) > ZERO                           05417071
054180         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             05418071
054190         MOVE MR-CSEPK-AREA (PV-SUB) TO ASC-LNE-FCSE-AREA         05419071
054200                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      05420071
054210     ELSE                                                         05421071
054220     IF  MR-CSEPK-AREAA (PV-SUB) = DP015-ERASE-EOF                05422071
054230         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             05423071
054240         MOVE SPACES                 TO ASC-LNE-FCSE-AREA         05424071
054250                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      05425071
054260     END-IF                                                       05426071
054270     END-IF.                                                      05427071
054280                                                                  05428071
054290                                                                  05429071
054300*----------------------------------------------------------------*05430071
054310*  EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE       *05431071
054320*  COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY).  *05432071
054330*----------------------------------------------------------------*05433071
054340 3000-EDIT-DATA-IN-COMMAREA.                                      05434071
054350     SET PS-NO-ERROR                                              05435071
054360         ASC-PO-RCVR-DWNLD-P2L-N                                  05436071
054370         ASC-PO-RCVR-TROUBLE-NO                                   05437071
054380         ASC-VALID-INPK-YES                                       05438071
054390         ASC-VALID-OTPK-YES                                       05439071
054400         ASC-UCC128-ERROR-NO                                      05440071
054410         ASC-INVALID-PREPK-CSTK-N TO TRUE.                        05441071
054420                                                                  05442071
054430     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     05443071
054440*                                                                 05444071
054450*  VALIDATE PRINTER ID'S                                          05445071
054460*                                                                 05446071
054470                                                                  05447071
054480     INITIALIZE  PV-SHP-PRTR-CLUSTER-NBR                          05448071
054490                 PV-SHP-PRTR-ID-ADDR                              05449071
054500                 PV-SHP-PRTR-OS-RLSE-CDE                          05450071
054510                 PV-SHP-DATA-XFER-MODE-ID                         05451071
054520                 PV-PGYBK-PRTR-CLUSTER-NBR                        05452071
054530                 PV-PGYBK-PRTR-ID-ADDR                            05453071
054540                 PV-PGYBK-PRTR-OS-RLSE-CDE                        05454071
054550                 PV-PGYBK-DATA-XFER-MODE-ID.                      05455071
054560                                                                  05456071
054570     IF  DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)  OR               05457071
054580         DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)  OR               05458071
054590         DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)  OR               05459071
054600         DP020-FK-LOCAL-FUNC-09 (DP020-SRC-AID)  OR               05460071
054610         DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)  OR               05461071
054620         DP020-FK-LOCAL-FUNC-10 (DP020-SRC-AID)  OR               05462071
054630         DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)  OR               05463071
054640         DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)  OR               05464071
054650         DP020-FK-PREV-PAGE(DP020-SRC-AID)       OR               05465071
054660         DP020-FK-NEXT-PAGE(DP020-SRC-AID)       OR               05466071
054670        (DP020-FK-CONFIRM (DP020-SRC-AID) AND                     05467071
054680         ASC-CONFIRM-DELETE)                                      05468071
054690         CONTINUE                                                 05469071
054700     ELSE                                                         05470071
054710     IF  ASC-SML-P2L-PRTR-ID = SPACES  AND                        05471071
054720         ASC-PGYBCK-PRTR-ID > SPACES   AND                        05472071
054730         (ASC-CRE-SML-LBL OR ALBLOPTI = 'C')                      05473071
054740         CONTINUE                                                 05474071
054750     ELSE                                                         05475071
054760     IF  ASC-SML-P2L-PRTR-ID = SPACES                             05476071
054770         SET PS-ERROR                                             05477071
054780         DP020-MSG-FATAL       TO TRUE                            05478071
054790         MOVE PC-TSYMSG-01563      TO DP020-MSG-NUMBER            05479071
054800         MOVE DP015-UNP-ALP-BRT-OFF                               05480071
054810                                   TO MDEST1A                     05481071
054820         MOVE DP015-RED            TO MDEST1C                     05482071
054830         MOVE DP015-REVERSE        TO MDEST1H                     05483071
054840         MOVE -1                   TO MDEST1L                     05484071
054850         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      05485071
054860     ELSE                                                         05486071
054870     IF  ASC-DO-NOT-PRINT-SML                                     05487071
054880         CONTINUE                                                 05488071
054890     ELSE                                                         05489071
054900         MOVE ASC-SML-P2L-PRTR-ID TO DP072-PRINTER-ID             05490071
054910         MOVE PC-REPORT-PGM-1     TO DP072-RPT-PGM-NME            05491071
054920         PERFORM 3010-VALIDATE-PRINTER                            05492071
054930         IF  PS-NO-ERROR                                          05493071
054940             PERFORM 3020-VALIDATE-PRINTER-ID-SML                 05494071
054950             MOVE  DP072-PRTR-CLUSTER-NBR                         05495071
054960                                   TO PV-SHP-PRTR-CLUSTER-NBR     05496071
054970             MOVE  DP072-PRTR-IP-ADDRESS                          05497071
054980                                   TO PV-SHP-PRTR-ID-ADDR         05498071
054990             MOVE  DP072-PRTR-CLUSTER-OS-RLSE-CDE                 05499071
055000                                   TO PV-SHP-PRTR-OS-RLSE-CDE     05500071
055010             MOVE  DP072-PRTR-DATA-XFER-MODE-ID                   05501071
055020                                   TO PV-SHP-DATA-XFER-MODE-ID    05502071
055030             MOVE  DP072-XMIT-INTFC-CDE                           05503071
055040                                   TO PV-SHP-XMIT-INTFC-CDE       05504071
055050             MOVE  DP072-PRTR-TYP-CDE                             05505071
055060                                   TO PV-SHP-PRTR-TYP-CDE         05506071
055070         END-IF                                                   05507071
055080     END-IF                                                       05508071
055090     END-IF                                                       05509071
055100     END-IF                                                       05510071
055110     END-IF.                                                      05511071
055120                                                                  05512071
055130                                                                  05513071
055140*-----------------------------------------------------------------05514071
055150* IF PIGGYBACK LABEL PRINTER ID IS ENTERED - VALIDATE             05515071
055160*-----------------------------------------------------------------05516071
055170     IF  PS-NO-ERROR                                              05517071
055180         IF  ASC-DO-NOT-PRINT-PGYBK                               05518071
055190             CONTINUE                                             05519071
055200         ELSE                                                     05520071
055210         IF  ASC-PGYBCK-PRTR-ID > SPACES                          05521071
055220             IF  ASC-PRE-PACK-ORDER                               05522071
055230                 SET  PS-ERROR                                    05523071
055240                      DP020-MSG-FATAL  TO TRUE                    05524071
055250                 MOVE PC-TSYMSG-02424  TO DP020-MSG-NUMBER        05525071
055260                 MOVE DP015-UNP-ALP-BRT-OFF                       05526071
055270                                       TO MDEST2A                 05527071
055280                 MOVE DP015-RED        TO MDEST2C                 05528071
055290                                          MPKGCDC                 05529071
055300                 MOVE DP015-REVERSE    TO MDEST2H                 05530071
055310                 MOVE -1               TO MDEST2L                 05531071
055320                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              05532071
055330             ELSE                                                 05533071
055340                 MOVE ASC-PGYBCK-PRTR-ID TO DP072-PRINTER-ID      05534071
055350                 MOVE PC-REPORT-PGM-2    TO DP072-RPT-PGM-NME     05535071
055360                 PERFORM 3010-VALIDATE-PRINTER                    05536071
055370                 IF  PS-NO-ERROR                                  05537071
055380                     PERFORM 3030-VALIDATE-PRINTER-ID-PGBK        05538071
055390                 MOVE  DP072-PRTR-CLUSTER-NBR                     05539071
055400                                   TO PV-PGYBK-PRTR-CLUSTER-NBR   05540071
055410                 MOVE  DP072-PRTR-IP-ADDRESS                      05541071
055420                                   TO PV-PGYBK-PRTR-ID-ADDR       05542071
055430                 MOVE  DP072-PRTR-CLUSTER-OS-RLSE-CDE             05543071
055440                                   TO PV-PGYBK-PRTR-OS-RLSE-CDE   05544071
055450                 MOVE  DP072-PRTR-DATA-XFER-MODE-ID               05545071
055460                                   TO PV-PGYBK-DATA-XFER-MODE-ID  05546071
055470                 MOVE  DP072-XMIT-INTFC-CDE                       05547071
055480                                   TO PV-PGYBK-XMIT-INTFC-CDE     05548071
055490                 MOVE  DP072-PRTR-TYP-CDE                         05549071
055500                                   TO PV-PGYBK-PRTR-TYP-CDE       05550071
055510             END-IF                                               05551071
055520         END-IF                                                   05552071
055530         END-IF                                                   05553071
055540     END-IF.                                                      05554071
055550                                                                  05555071
055560     IF PS-NO-ERROR                                               05556071
055570        IF  DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)  OR            05557071
055580            DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)  OR            05558071
055590            DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)  OR            05559071
055600            DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)  OR            05560071
055610            DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)  OR            05561071
055620            DP020-FK-LOCAL-FUNC-09 (DP020-SRC-AID)                05562071
055630              CONTINUE                                            05563071
055640        ELSE                                                      05564071
055650           PERFORM 3002-EDIT-COMMAREA-SCREEN-TOP                  05565071
055660           IF PS-CRITERIA-CHANGE AND                              05566071
055670              PS-NO-ERROR AND                                     05567071
055680              PS-REFRESH-NOT-DONE                                 05568071
055690                MOVE ASC-OPER-UNT-ID      TO DK-OPER-UNT-ID       05569071
055700                MOVE ASC-FCLTY-ID         TO DK-FCLTY-ID          05570071
055710                MOVE ASC-PO-NBR           TO DK-PO-NBR            05571071
055720                MOVE ASC-PO-LINE-NBR      TO DK-LINE-NBR          05572071
055730                MOVE ASC-REC-SEQ-NBR      TO DK-REC-SEQ-NBR       05573071
055740                PERFORM 2050-DELETE-LIST-QUEUE                    05574071
055750                PERFORM 4000-BUILD-INITIAL-PANEL                  05575071
055760                SET  ASC-CONFIRM-DELETE-NO                        05576071
055770                     ASC-2ND-CONFIRM-DEL-NO                       05577071
055780                     ASC-2ND-CONFIRM-UNKNOWN                      05578071
055790                     PS-REFRESH-DONE       TO TRUE                05579071
055800           END-IF                                                 05580071
055810     END-IF                                                       05581071
055820*----------------------------------------------------------------*05582071
055830* IF PREPACK ORDER (PACKAGING TYPE = M OR I), USER WILL NOT      *05583071
055840* BE ABLE TO USE LOCAL-FUNC-07 (F22-DISTRO) THEY WILL NEED TO    *05584071
055850* USE LOCAL-FUNC-09 (F19-PCKDTLLST)                              *05585071
055860*----------------------------------------------------------------*05586071
055870     IF  DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)  AND              05587071
055880         PS-NO-ERROR                             AND              05588071
055890         ASC-PRE-PACK-ORDER                                       05589071
055900             SET PS-ERROR                                         05590071
055910             DP020-MSG-FATAL       TO TRUE                        05591071
055920             MOVE PC-TSYMSG-02448  TO DP020-MSG-NUMBER            05592071
055930             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  05593071
055940             MOVE -1               TO MR-SELECTL (1)              05594071
055950     END-IF.                                                      05595071
055960                                                                  05596071
055970     IF  DP020-FK-LOCAL-FUNC-09 (DP020-SRC-AID)  AND              05597071
055980         PS-NO-ERROR                             AND              05598071
055990         NOT ASC-PRE-PACK-ORDER                                   05599071
056000             SET PS-ERROR                                         05600071
056010             DP020-MSG-FATAL       TO TRUE                        05601071
056020             MOVE PC-TSYMSG-02450  TO DP020-MSG-NUMBER            05602071
056030             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  05603071
056040             MOVE -1               TO MR-SELECTL (1)              05604071
056050     END-IF.                                                      05605071
056060                                                                  05606071
056070     IF  DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)  AND              05607071
056080         PS-NO-ERROR                                              05608071
056090         PERFORM 3600-CHECK-DC-LABOR                              05609071
056100     END-IF.                                                      05610071
056200                                                                  05620071
056201     IF  DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)  AND              05620171
056202         PS-NO-ERROR                             AND              05620271
056203         PS-CHECK-FOR-MULT-ASGMT                 AND              05620371
056204         ASC-DC-INTERFC-LABOR-YES                AND              05620471
056205         ASC-CHECK-FOR-MULT-ASGMT                                 05620571
056206         MOVE DP020-USERID  TO  PV-LABOR-USER-ID                  05620671
056207         PERFORM 3603-CHECK-MULT-ASGMT                            05620771
056208         IF  PV-ASGMT-COUNT  >  1                                 05620871
056209             PERFORM 3605-CALL-DLKUT028                           05620971
056210         END-IF                                                   05621071
056211     END-IF.                                                      05621171
056212                                                                  05621271
056213     IF  DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)  AND              05621371
056214         PS-NO-ERROR                             AND              05621471
056215         ASC-DC-INTERFC-LABOR-YES                                 05621571
056216         MOVE DP020-USERID  TO  PV-LABOR-USER-ID                  05621671
056217         PERFORM 3610-CHECK-LABOR-ASGMT                           05621771
056218     END-IF.                                                      05621871
056219                                                                  05621971
056220                                                                  05622071
056230                                                                  05623071
056240*-----------------------------------------------------------------05624071
056250* IF RECEIVER IS AN "ap" RECEIVER DO NOT ALLOW CASEPACK TO BE RUN 05625071
056260*-----------------------------------------------------------------05626071
056270     IF  DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)  AND              05627071
056280         PS-NO-ERROR                                              05628071
056290         PERFORM 3700-CHECK-RECEIVER-TYPE                         05629071
056300     END-IF.                                                      05630071
056400                                                                  05640071
056410                                                                  05641071
056420                                                                  05642071
056430*-----------------------------------------------------------------05643071
056440* IF user sign on oper does not match the Curr oper on the RCVR   05644071
056450* display message 3598                                            05645071
056460*      F15 - Ignore UCC128     - Local-func-10                    05646071
056470*      F16 - Casepack Delete   - Local-func-01                    05647071
056480*      F23 - Casepack Download - Local-func-06                    05648071
056490*-----------------------------------------------------------------05649071
056500     IF  (DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)  OR              05650071
056501          DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)  OR              05650171
056502          DP020-FK-LOCAL-FUNC-10 (DP020-SRC-AID))  AND            05650271
056503         PS-NO-ERROR                                              05650371
056504         perform 3720-CHECK-CURR-OPER                             05650471
056505     END-IF.                                                      05650571
056506                                                                  05650671
056507                                                                  05650771
056508*-----------------------------------------------------------------05650871
056509* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              05650971
056510* EDITTING IS DONE FROM THE BOTTOM UP.                            05651071
056520*-----------------------------------------------------------------05652071
056521     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       05652171
056522         ASC-ITEMS-DISPLAYED - 1.                                 05652271
056523     PERFORM 3100-SET-SUBSCRIPTS.                                 05652371
056524                                                                  05652471
056525     PERFORM 3040-CHECK-RCVR-ARRIVED                              05652571
056526                                                                  05652671
056527     IF  PS-NO-ERROR                                              05652771
056528         PERFORM 3005-EDIT-COMMAREA-BLOCKS.                       05652871
056529                                                                  05652971
056530*-----------------------------------------------------------------05653071
056540* AFTER ALL LINE EDITING HAS BEEN COMPLETED, AND NO ERRORS HAVE   05654071
056550* BEEN FOUND, AND F23-FUNCTION, CALL DLKUP001 MODULE TO GET THE   05655071
056560* NEXT ASSIGNMENT SEQUENCE NUMBER.                                05656071
056570*-----------------------------------------------------------------05657071
056580     IF  DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)  AND              05658071
056590         PS-NO-ERROR                             AND              05659071
056600         ASC-DC-INTERFC-LABOR-YES                AND              05660071
056610         ASC-ASSOC-LABOR-ASGMT-YES                                05661071
056620         SET  PS-LABOR-LOG-HEADER  TO  TRUE                       05662071
056630         PERFORM 3620-GET-LABOR-SEQ-NBR                           05663071
056640     END-IF.                                                      05664071
056650                                                                  05665071
056660     IF  PS-NO-ERROR                                              05666071
056670         PERFORM 3400-CHECK-RANGE-SEQUENCE                        05667071
056680     END-IF.                                                      05668071
056690                                                                  05669071
056700     IF  ((PS-NO-ERROR)                                           05670071
056800       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   05680071
056810       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    05681071
056820             PERFORM 3500-MARK-RANGE-AS-SELECTED                  05682071
056830     END-IF.                                                      05683071
056840                                                                  05684071
056850                                                                  05685071
056860 3002-EDIT-COMMAREA-SCREEN-TOP.                                   05686071
056870                                                                  05687071
056880* CREATE LABEL OPTION                                             05688071
056890     IF  ALBLOPTL  > ZERO                                         05689071
056900         MOVE ALBLOPTI              TO ASC-CRE-LBL-IND            05690071
056910         SET PS-CRITERIA-CHANGE    TO TRUE                        05691071
056920         MOVE ASC-CRE-LBL-IND  TO  PV-CREATE-LABEL-OPTION         05692071
056930         IF  PV-VALID-LABEL-OPT                                   05693071
056940             CONTINUE                                             05694071
056950         ELSE                                                     05695071
056960             SET PS-ERROR                                         05696071
056970                 DP020-MSG-FATAL   TO TRUE                        05697071
056980             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            05698071
056990             MOVE DP015-UNP-ALP-BRT-OFF                           05699071
057000                                   TO ALBLOPTA                    05700071
057010             MOVE DP015-RED        TO ALBLOPTC                    05701071
057020             MOVE DP015-REVERSE    TO ALBLOPTH                    05702071
057030             MOVE -1               TO ALBLOPTL                    05703071
057040             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  05704071
057050         END-IF                                                   05705071
057060     ELSE                                                         05706071
057070         MOVE ASC-CRE-LBL-IND  TO  PV-CREATE-LABEL-OPTION         05707071
057080         IF  PV-VALID-LABEL-OPT                                   05708071
057090             CONTINUE                                             05709071
057100         ELSE                                                     05710071
057110             SET PS-ERROR                                         05711071
057120                 DP020-MSG-FATAL   TO TRUE                        05712071
057130             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            05713071
057140             MOVE DP015-UNP-ALP-BRT-OFF                           05714071
057150                                   TO ALBLOPTA                    05715071
057160             MOVE DP015-RED        TO ALBLOPTC                    05716071
057170             MOVE DP015-REVERSE    TO ALBLOPTH                    05717071
057180             MOVE -1               TO ALBLOPTL                    05718071
057190             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  05719071
057200         END-IF                                                   05720071
057210     END-IF                                                       05721071
057220                                                                  05722071
057230* LABEL PRINT ORDER                                               05723071
057240     IF PS-NO-ERROR                                               05724071
057250      IF  AORDERL  > ZERO                                         05725071
057260          MOVE AORDERI              TO ASC-LBL-PRT-ORDER          05726071
057270          SET PS-CRITERIA-CHANGE    TO TRUE                       05727071
057280          MOVE ASC-LBL-PRT-ORDER  TO  PV-PRINT-ORDER              05728071
057290            IF  PV-VALID-PRINT-ORDER                              05729071
057300                CONTINUE                                          05730071
057310            ELSE                                                  05731071
057320                SET PS-ERROR                                      05732071
057330                    DP020-MSG-FATAL   TO TRUE                     05733071
057340                MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER         05734071
057350                MOVE DP015-UNP-ALP-BRT-OFF                        05735071
057360                                      TO AORDERA                  05736071
057370                MOVE DP015-RED        TO AORDERC                  05737071
057380                MOVE DP015-REVERSE    TO AORDERH                  05738071
057390                MOVE -1               TO AORDERL                  05739071
057400                SET DP030-SET-CURSOR-APPL-1 TO TRUE               05740071
057410            END-IF                                                05741071
057420      ELSE                                                        05742071
057430          MOVE ASC-LBL-PRT-ORDER  TO  PV-PRINT-ORDER              05743071
057440          IF  PV-VALID-PRINT-ORDER                                05744071
057450              CONTINUE                                            05745071
057460          ELSE                                                    05746071
057470              SET PS-ERROR                                        05747071
057480                  DP020-MSG-FATAL   TO TRUE                       05748071
057490              MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER           05749071
057500              MOVE DP015-UNP-ALP-BRT-OFF                          05750071
057510                                    TO AORDERA                    05751071
057520              MOVE DP015-RED        TO AORDERC                    05752071
057530              MOVE DP015-REVERSE    TO AORDERH                    05753071
057540              MOVE -1               TO AORDERL                    05754071
057550              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 05755071
057560          END-IF                                                  05756071
057570      END-IF                                                      05757071
057580     END-IF.                                                      05758071
057590                                                                  05759071
057600* PRINT HEADER/FOOTER                                             05760071
057610     IF  PS-NO-ERROR                                              05761071
057620       IF  AHDRFTL > ZERO                                         05762071
057630           MOVE AHDRFTI              TO ASC-PRT-HEAD-FOOT         05763071
057640       ELSE                                                       05764071
057650           IF  AHDRFTF = DP015-ERASE-EOF                          05765071
057660               MOVE SPACES           TO ASC-PRT-HEAD-FOOT         05766071
057670           END-IF                                                 05767071
057680       END-IF                                                     05768071
057690                                                                  05769071
057700       IF  ASC-PRT-HEAD-FOOT  >  SPACES                           05770071
057710           IF  ASC-YES-HEAD-FOOT                                  05771071
057720               CONTINUE                                           05772071
057730           ELSE                                                   05773071
057740           IF  ASC-NO-HEAD-FOOT                                   05774071
057750               IF  ASC-CRE-P2L-LBL                                05775071
057760                   CONTINUE                                       05776071
057770               ELSE                                               05777071
057780                   SET PS-CRITERIA-CHANGE    TO TRUE              05778071
057790                   SET PS-ERROR                                   05779071
057800                       DP020-MSG-FATAL   TO TRUE                  05780071
057810                   MOVE PC-TSYMSG-01857  TO DP020-MSG-NUMBER      05781071
057820                   MOVE DP015-UNP-ALP-BRT-OFF                     05782071
057830                                         TO AHDRFTA               05783071
057840                   MOVE DP015-RED        TO AHDRFTC               05784071
057850                   MOVE DP015-REVERSE    TO AHDRFTH               05785071
057860                   MOVE -1               TO AHDRFTL               05786071
057870                   SET DP030-SET-CURSOR-APPL-1 TO TRUE            05787071
057880               END-IF                                             05788071
057890           ELSE                                                   05789071
057900               SET PS-CRITERIA-CHANGE    TO TRUE                  05790071
057910               SET PS-ERROR                                       05791071
057920                   DP020-MSG-FATAL       TO TRUE                  05792071
057930               MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER      05793071
057940               MOVE DP015-UNP-ALP-BRT-OFF                         05794071
057950                                         TO AHDRFTA               05795071
057960               MOVE DP015-RED            TO AHDRFTC               05796071
057970               MOVE DP015-REVERSE        TO AHDRFTH               05797071
057980               MOVE -1                   TO AHDRFTL               05798071
057990               SET DP030-SET-CURSOR-APPL-1 TO TRUE                05799071
058000           END-IF                                                 05800071
058010           END-IF                                                 05801071
058020       ELSE                                                       05802071
058030           SET PS-CRITERIA-CHANGE    TO TRUE                      05803071
058040           SET PS-ERROR                                           05804071
058050               DP020-MSG-FATAL       TO TRUE                      05805071
058060           MOVE PC-TSYMSG-00007      TO DP020-MSG-NUMBER          05806071
058070           MOVE DP015-UNP-ALP-BRT-OFF                             05807071
058080                                     TO AHDRFTA                   05808071
058090           MOVE DP015-RED            TO AHDRFTC                   05809071
058100           MOVE DP015-REVERSE        TO AHDRFTH                   05810071
058110           MOVE -1                   TO AHDRFTL                   05811071
058120           SET DP030-SET-CURSOR-APPL-1 TO TRUE                    05812071
058130       END-IF                                                     05813071
058140     END-IF.                                                      05814071
058150                                                                  05815071
058160* CASEPACK PROCESS AREA                                           05816071
058170     IF PS-NO-ERROR                                               05817071
058180       IF  MCSEPKL > ZERO                                         05818071
058190           MOVE MCSEPKI               TO ASC-FCSE-AREA-ID         05819071
058200           PERFORM 3376-CHECK-FCLTY-AREA-ASC                      05820071
058210           SET PS-CRITERIA-CHANGE    TO TRUE                      05821071
058220       ELSE                                                       05822071
058230           IF  MCSEPKF = DP015-ERASE-EOF                          05823071
058240               MOVE SPACES            TO ASC-FCSE-AREA-ID         05824071
058250           END-IF                                                 05825071
058260       END-IF                                                     05826071
058270     END-IF.                                                      05827071
058280* P2L MODULE NUMBER                                               05828071
058290     IF PS-NO-ERROR                                               05829071
058300       IF  AP2LMODL > ZERO                                        05830071
058310           IF (AP2LMODI > SPACES)  AND (AP2LMODI > ZEROES)        05831071
058320               PERFORM 3333-CHECK-MOD-NUMERIC-ASC                 05832071
058330               SET PS-CRITERIA-CHANGE    TO TRUE                  05833071
058340               IF PS-NO-ERROR                                     05834071
058350                  PERFORM 3321-VERIFY-MOD-NBR-ASC                 05835071
058360               END-IF                                             05836071
058370           ELSE                                                   05837071
058380               MOVE ZEROES           TO ASC-MODU-NBR              05838071
058390           END-IF                                                 05839071
058400       ELSE                                                       05840071
058410         IF  AP2LMODF  = DP015-ERASE-EOF                          05841071
058420             MOVE ZEROES           TO ASC-MODU-NBR                05842071
058430             SET PS-CRITERIA-CHANGE    TO TRUE                    05843071
058440         END-IF                                                   05844071
058450       END-IF                                                     05845071
058460     END-IF                                                       05846071
058470                                                                  05847071
058480* USE UCC128 DATA (Y/N)                                           05848071
058490     IF PS-NO-ERROR                                               05849071
058500       IF ASC-AUTOVE-PARM-NO                                      05850071
058510         IF  A128YNL > ZERO                                       05851071
058520             MOVE A128YNI              TO ASC-USE-UCC128-IND      05852071
058530             SET PS-CRITERIA-CHANGE    TO TRUE                    05853071
058540             MOVE ASC-USE-UCC128-IND   TO PV-UCC128-OPTION        05854071
058550             IF  PV-VALID-UCC128-OPTION                           05855071
058560                 CONTINUE                                         05856071
058570             ELSE                                                 05857071
058580                 SET PS-ERROR                                     05858071
058590                     DP020-MSG-FATAL   TO TRUE                    05859071
058600                 MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER        05860071
058610                 MOVE DP015-UNP-ALP-BRT-OFF                       05861071
058620                                       TO A128YNA                 05862071
058630                 MOVE DP015-RED        TO A128YNC                 05863071
058640                 MOVE DP015-REVERSE    TO A128YNH                 05864071
058650                 MOVE -1               TO A128YNL                 05865071
058660                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              05866071
058670             END-IF                                               05867071
058680         ELSE                                                     05868071
058690             MOVE ASC-USE-UCC128-IND   TO PV-UCC128-OPTION        05869071
058700             IF  PV-VALID-UCC128-OPTION                           05870071
058710                 CONTINUE                                         05871071
058720             ELSE                                                 05872071
058730                 SET PS-ERROR                                     05873071
058740                     DP020-MSG-FATAL   TO TRUE                    05874071
058750                 MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER        05875071
058760                 MOVE DP015-UNP-ALP-BRT-OFF                       05876071
058770                                       TO A128YNA                 05877071
058780                 MOVE DP015-RED        TO A128YNC                 05878071
058790                 MOVE DP015-REVERSE    TO A128YNH                 05879071
058800                 MOVE -1               TO A128YNL                 05880071
058810                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              05881071
058820             END-IF                                               05882071
058830         END-IF                                                   05883071
058840       END-IF                                                     05884071
058850     END-IF                                                       05885071
058860* CARTON COUNT                                                    05886071
058870     IF PS-NO-ERROR                                               05887071
058880       IF  MCTNCNTL > ZERO                                        05888071
058890           IF (MCTNCNTI > SPACES)  AND (MCTNCNTI > ZEROES)        05889071
058900               PERFORM 3334A-CHECK-CART-CNT-NUMERIC               05890071
058910           END-IF                                                 05891071
058920       ELSE                                                       05892071
058930         IF  MCTNCNTF  = DP015-ERASE-EOF                          05893071
058940             MOVE ZEROES           TO ASC-MODU-NBR                05894071
058950             SET PS-CRITERIA-CHANGE    TO TRUE                    05895071
058960         END-IF                                                   05896071
058970       END-IF                                                     05897071
058980     END-IF                                                       05898071
058990                                                                  05899071
059000* SPECIAL INSTRUCTIONS                                            05900071
059010     IF PS-NO-ERROR                                               05901071
059020       IF  MINSTRL > ZERO                                         05902071
059030           MOVE MINSTRI              TO ASC-SPEC-INST-DESC        05903071
059040       END-IF                                                     05904071
059050     END-IF.                                                      05905071
059060                                                                  05906071
059070*----------------------------------------------------------------*05907071
059080*   3005-EDIT-COMMAREA-BLOCKS                                    *05908071
059090*----------------------------------------------------------------*05909071
059100 3005-EDIT-COMMAREA-BLOCKS.                                       05910071
059110     MOVE +1                       TO PV-BLOCK-NUMBER.            05911071
059120     MOVE +1                       TO ASC-BLK-SUB.                05912071
059130     MOVE PC-ITEMS-PER-PANEL       TO ASC-ITEM-SUB.               05913071
059140                                                                  05914071
059150     COMPUTE PV-BLOCK-NUMBER  =                                   05915071
059160        1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /                 05916071
059170            PC-ITEMS-PER-PANEL.                                   05917071
059180                                                                  05918071
059190     MOVE  PV-BLOCK-NUMBER         TO PV-ORIGINAL-BLOCK.          05919071
059200                                                                  05920071
059210     EVALUATE TRUE                                                05921071
059220         WHEN PS-EDIT-BEFORE-MOVE                                 05922071
059230                                                                  05923071
059240              COMPUTE PV-ITEMS-HOLD  =                            05924071
059250                  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +           05925071
059260                  PC-ITEMS-PER-PANEL - 1                          05926071
059270                                                                  05927071
059280              IF  PV-ITEMS-HOLD  >  ASC-NUMBER-OF-ITEMS-READ      05928071
059290                  SUBTRACT  ASC-NUMBER-OF-ITEMS-READ              05929071
059300                      FROM  PV-ITEMS-HOLD                         05930071
059310                    GIVING  PV-ITEMS-DIFF                         05931071
059320                  SUBTRACT  PV-ITEMS-DIFF                         05932071
059330                      FROM  PC-ITEMS-PER-PANEL                    05933071
059340                    GIVING  PV-ITEMS-HOLD                         05934071
059350                  MOVE  PV-ITEMS-HOLD  TO  PV-SUB                 05935071
059360                                           ASC-ITEM-SUB           05936071
059370                                           ASC-ITEMS-DISPLAYED    05937071
059380              ELSE                                                05938071
059390                  MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB             05939071
059400                  MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB       05940071
059410              END-IF                                              05941071
059420              PERFORM 3300-EDIT-SELECTIONS                        05942071
059430                  VARYING PV-SUB                                  05943071
059440                     FROM PV-SUB BY -1                            05944071
059450                    UNTIL PV-SUB < +1                             05945071
059460                                                                  05946071
059470              MOVE +1               TO ASC-BLK-SUB                05947071
059480              PERFORM 5105-REWRITE-ASC-LISTQ                      05948071
059490                                                                  05949071
059500                                                                  05950071
059510         WHEN OTHER                                               05951071
059520             PERFORM                                              05952071
059530               UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN  05953071
059540                  OR PS-ERROR                                     05954071
059550                  OR PS-BLOCK-ERROR                               05955071
059560                                                                  05956071
059570                     COMPUTE PV-ITEMS-HOLD  =                     05957071
059580                     ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +        05958071
059590                     PC-ITEMS-PER-PANEL - 1                       05959071
059600                                                                  05960071
059610                 IF  PV-ITEMS-HOLD  >  ASC-NUMBER-OF-ITEMS-READ   05961071
059620                     SUBTRACT  ASC-NUMBER-OF-ITEMS-READ           05962071
059630                         FROM  PV-ITEMS-HOLD                      05963071
059640                       GIVING  PV-ITEMS-DIFF                      05964071
059650                     SUBTRACT  PV-ITEMS-DIFF                      05965071
059660                         FROM  PC-ITEMS-PER-PANEL                 05966071
059670                       GIVING  PV-ITEMS-HOLD                      05967071
059680                     MOVE  PV-ITEMS-HOLD  TO  PV-SUB              05968071
059690                                              ASC-ITEM-SUB        05969071
059700                                              ASC-ITEMS-DISPLAYED 05970071
059710                 ELSE                                             05971071
059720                     MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB          05972071
059730                     MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB    05973071
059740                 END-IF                                           05974071
059750                 PERFORM 3300-EDIT-SELECTIONS                     05975071
059760                     VARYING PV-SUB                               05976071
059770                        FROM PV-SUB BY -1                         05977071
059780                       UNTIL PV-SUB < +1                          05978071
059790                                                                  05979071
059800                 MOVE +1               TO ASC-BLK-SUB             05980071
059810                                                                  05981071
059820                 PERFORM 5105-REWRITE-ASC-LISTQ                   05982071
059830                                                                  05983071
059840                 MOVE +1                TO ASC-BLK-SUB            05984071
059850                                                                  05985071
059860                 IF  PS-BLOCK-ERROR                               05986071
059870                     SET  PS-ERROR     TO TRUE                    05987071
059880                     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)    05988071
059890                                       TO PV-TOP-ITEM             05989071
059900                 ELSE                                             05990071
059910                     ADD  +1            TO PV-BLOCK-NUMBER        05991071
059920                     IF  PV-BLOCK-NUMBER >                        05992071
059930                         ASC-HIGHEST-BLOCK-WRITTEN                05993071
059940                         MOVE +2        TO ASC-BLK-SUB            05994071
059950                         PERFORM 4410-READ-TEMP-STORAGE           05995071
059960                         MOVE +1        TO ASC-BLK-SUB            05996071
059970                     ELSE                                         05997071
059980                         PERFORM 4410-READ-TEMP-STORAGE           05998071
059990                         ADD  +1        TO PV-BLOCK-NUMBER        05999071
060000                         MOVE +2        TO ASC-BLK-SUB            06000071
060010                         PERFORM 4410-READ-TEMP-STORAGE           06001071
060020                         SUBTRACT +1  FROM PV-BLOCK-NUMBER        06002071
060030                         MOVE +1        TO ASC-BLK-SUB            06003071
060040                     END-IF                                       06004071
060050                 END-IF                                           06005071
060060             END-PERFORM                                          06006071
060070                                                                  06007071
060080             IF  PV-ORIGINAL-BLOCK  = +1    OR                    06008071
060090                 PS-ERROR                   OR                    06009071
060100                 PS-BLOCK-ERROR                                   06010071
060110                 CONTINUE                                         06011071
060120             ELSE                                                 06012071
060130                 MOVE +1                 TO PV-BLOCK-NUMBER       06013071
060140                 MOVE +1                 TO ASC-BLK-SUB           06014071
060150                 MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB          06015071
060160                 MOVE PC-ITEMS-PER-PANEL TO ASC-ITEMS-DISPLAYED   06016071
060170                 PERFORM 4410-READ-TEMP-STORAGE                   06017071
060180                                                                  06018071
060190                 PERFORM                                          06019071
060200                     UNTIL PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK    06020071
060210                        OR PS-ERROR                               06021071
060220                        OR PS-BLOCK-ERROR                         06022071
060230                                                                  06023071
060240                     COMPUTE PV-ITEMS-HOLD  =                     06024071
060250                         ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +    06025071
060260                         PC-ITEMS-PER-PANEL - 1                   06026071
060270                                                                  06027071
060280                     IF  PV-ITEMS-HOLD > ASC-NUMBER-OF-ITEMS-READ 06028071
060290                         SUBTRACT  ASC-NUMBER-OF-ITEMS-READ       06029071
060300                            FROM  PV-ITEMS-HOLD                   06030071
060310                           GIVING  PV-ITEMS-DIFF                  06031071
060320                         SUBTRACT  PV-ITEMS-DIFF                  06032071
060330                             FROM  PC-ITEMS-PER-PANEL             06033071
060340                           GIVING  PV-ITEMS-HOLD                  06034071
060350                         MOVE  PV-ITEMS-HOLD TO PV-SUB            06035071
060360                                                 ASC-ITEM-SUB     06036071
060370                                               ASC-ITEMS-DISPLAYED06037071
060380                     ELSE                                         06038071
060390                         MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB      06039071
060400                         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB06040071
060410                     END-IF                                       06041071
060420                     PERFORM 3300-EDIT-SELECTIONS                 06042071
060430                         VARYING PV-SUB                           06043071
060440                            FROM PV-SUB BY -1                     06044071
060450                           UNTIL PV-SUB < +1                      06045071
060460                                                                  06046071
060470                     MOVE +1               TO ASC-BLK-SUB         06047071
060480                                                                  06048071
060490                     PERFORM 5105-REWRITE-ASC-LISTQ               06049071
060500                                                                  06050071
060510                     MOVE +1                TO ASC-BLK-SUB        06051071
060520                                                                  06052071
060530                     IF  PS-BLOCK-ERROR                           06053071
060540                         SET  PS-ERROR     TO TRUE                06054071
060550                         MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)06055071
060560                                           TO PV-TOP-ITEM         06056071
060570                     ELSE                                         06057071
060580                         ADD  +1            TO PV-BLOCK-NUMBER    06058071
060590                         IF  PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK  06059071
060600                             MOVE +2        TO ASC-BLK-SUB        06060071
060610                             PERFORM 4410-READ-TEMP-STORAGE       06061071
060620                             MOVE +1        TO ASC-BLK-SUB        06062071
060630                         ELSE                                     06063071
060640                             PERFORM 4410-READ-TEMP-STORAGE       06064071
060650                             ADD  +1        TO PV-BLOCK-NUMBER    06065071
060660                             MOVE +2        TO ASC-BLK-SUB        06066071
060670                             PERFORM 4410-READ-TEMP-STORAGE       06067071
060680                             SUBTRACT +1  FROM PV-BLOCK-NUMBER    06068071
060690                             MOVE +1        TO ASC-BLK-SUB        06069071
060700                         END-IF                                   06070071
060710                     END-IF                                       06071071
060720                 END-PERFORM                                      06072071
060730             END-IF                                               06073071
060740     END-EVALUATE.                                                06074071
060750                                                                  06075071
060760                                                                  06076071
060770*----------------------------------------------------------------*06077071
060780*   3010-VALIDATE-PRINTER                                        *06078071
060790* CALLS DPKCS060 TO VALIDATE THE PRINTER ID                      *06079071
060800*----------------------------------------------------------------*06080071
060810 3010-VALIDATE-PRINTER.                                           06081071
060820                                                                  06082071
060830     MOVE PC-01                      TO DP072-RPT-PGM-TYP-ID.     06083071
060840     MOVE DP020-LOCATION-NBR         TO DP072-ORIGIN-OPER-UNT-ID. 06084071
060850     MOVE DP020-LOCATION-NBR         TO DP072-OPER-UNT-ID.        06085071
060860     MOVE 1                          TO DP072-ORIGIN-FCLTY-ID     06086071
060870                                        DP072-FCLTY-ID.           06087071
060880     SET DP072-VALIDATE              TO TRUE.                     06088071
060890                                                                  06089071
060900     EXEC CICS                                                    06090071
060910          LINK PROGRAM  (PC-PRTR-VALIDATION-PGM)                  06091071
060920               COMMAREA (DP072-COMM-AREA)                         06092071
060930               RESP     (PV-CICS-RESP)                            06093071
060940     END-EXEC                                                     06094071
060950                                                                  06095071
060960     EVALUATE TRUE                                                06096071
060970         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     06097071
060980              CONTINUE                                            06098071
060990         WHEN OTHER                                               06099071
061000             SET PS-ERROR                                         06100071
061010                 DP020-MSG-FATAL       TO TRUE                    06101071
061020             MOVE PC-TSYMSG-00746      TO DP020-MSG-NUMBER        06102071
061030             IF  DP072-RPT-PGM-NME = PC-REPORT-PGM-1              06103071
061040                 MOVE DP015-UNP-ALP-BRT-OFF                       06104071
061050                                       TO MDEST1A                 06105071
061060                 MOVE DP015-RED        TO MDEST1C                 06106071
061070                 MOVE DP015-REVERSE    TO MDEST1H                 06107071
061080                 MOVE -1               TO MDEST1L                 06108071
061090             ELSE                                                 06109071
061100                 MOVE DP015-UNP-ALP-BRT-OFF                       06110071
061110                                       TO MDEST2A                 06111071
061120                 MOVE DP015-RED        TO MDEST2C                 06112071
061130                 MOVE DP015-REVERSE    TO MDEST2H                 06113071
061140                 MOVE -1               TO MDEST2L                 06114071
061150             END-IF                                               06115071
061160             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06116071
061170     END-EVALUATE.                                                06117071
061180                                                                  06118071
061190                                                                  06119071
061200*----------------------------------------------------------------*06120071
061210*  VALIDATE THE PRINTER NUMBER ENTERED ON THE SCREEN TO ENSURE   *06121071
061220*  THIS IS A VALID PRINTER AND THAT SHIPPING MANIFEST LABELS     *06122071
061230*  CAN BE PRINTED ON THIS PRINTER.                               *06123071
061240*----------------------------------------------------------------*06124071
061250 3020-VALIDATE-PRINTER-ID-SML.                                    06125071
061260                                                                  06126071
061270     IF  DP072-PRTR-CLUSTER-OS-RLSE-CDE  = PC-MGMX                06127071
061280         SET  PS-PRINTER-ERROR                                    06128071
061290              PS-ERROR                                            06129071
061300              DP020-MSG-FATAL         TO TRUE                     06130071
061310         MOVE PC-TSYMSG-00746         TO DP020-MSG-NUMBER         06131071
061320         MOVE DP015-UNP-ALP-BRT-MDT   TO MDEST1A                  06132071
061330         MOVE DP015-RED               TO MDEST1C                  06133071
061340         MOVE DP015-REVERSE           TO MDEST1H                  06134071
061350         MOVE -1                      TO MDEST1L                  06135071
061360         SET DP030-SET-CURSOR-APPL-1  TO TRUE                     06136071
061370     END-IF.                                                      06137071
061380                                                                  06138071
061390     IF  DP072-PRTR-PRTR-TRK-STAT-CDE    = PC-A                   06139071
061400         CONTINUE                                                 06140071
061410     ELSE                                                         06141071
061420         SET  PS-PRINTER-ERROR                                    06142071
061430              PS-ERROR                                            06143071
061440              DP020-MSG-FATAL         TO TRUE                     06144071
061450         MOVE PC-TSYMSG-00746         TO DP020-MSG-NUMBER         06145071
061460         MOVE DP015-UNP-ALP-BRT-MDT   TO MDEST1A                  06146071
061470         MOVE DP015-RED               TO MDEST1C                  06147071
061480         MOVE DP015-REVERSE           TO MDEST1H                  06148071
061490         MOVE -1                      TO MDEST1L                  06149071
061500         SET DP030-SET-CURSOR-APPL-1  TO TRUE                     06150071
061510     END-IF.                                                      06151071
061520                                                                  06152071
061530                                                                  06153071
061540*----------------------------------------------------------------*06154071
061550*  VALIDATE THE PRINTER NUMBER ENTERED ON THE SCREEN TO ENSURE   *06155071
061560*  THIS IS A VALID PRINTER AND THAT PIGGYBACK LABELS CAN BE      *06156071
061570*  PRINTED ON THIS PRINTER.                                      *06157071
061580*----------------------------------------------------------------*06158071
061590 3030-VALIDATE-PRINTER-ID-PGBK.                                   06159071
061600                                                                  06160071
061610     IF  DP072-PRTR-PRTR-TRK-STAT-CDE    = PC-A                   06161071
061620         CONTINUE                                                 06162071
061630     ELSE                                                         06163071
061640         SET  PS-PRINTER-ERROR                                    06164071
061650              PS-ERROR                                            06165071
061660              DP020-MSG-FATAL         TO TRUE                     06166071
061670         MOVE PC-TSYMSG-00746         TO DP020-MSG-NUMBER         06167071
061680         MOVE DP015-UNP-ALP-BRT-MDT   TO MDEST2A                  06168071
061690         MOVE DP015-RED               TO MDEST2C                  06169071
061700         MOVE DP015-REVERSE           TO MDEST2H                  06170071
061710         MOVE -1                      TO MDEST2L                  06171071
061720         SET DP030-SET-CURSOR-APPL-1  TO TRUE                     06172071
061730     END-IF.                                                      06173071
061740                                                                  06174071
061750                                                                  06175071
061760*----------------------------------------------------------------*06176071
061770*  CHECK TO SEE IF A RECEIVER HAS BEEN ARRIVED                   *06177071
061780*----------------------------------------------------------------*06178071
061790 3040-CHECK-RCVR-ARRIVED.                                         06179071
061800                                                                  06180071
061810     EXEC SQL                                                     06181071
061820         SELECT REC_TMST                                          06182071
061830           INTO :RECEIV-REC-TMST                                  06183071
061840           FROM TRECEIV                                           06184071
061850          WHERE ORD_NBR      =  :ASC-PO-NBR                       06185071
061860            AND REC_SEQ_NBR  =  :ASC-REC-SEQ-NBR                  06186071
061870     END-EXEC                                                     06187071
061880                                                                  06188071
061890     EVALUATE TRUE                                                06189071
061900         WHEN SQLCODE = +0                                        06190071
061910              CONTINUE                                            06191071
061920         WHEN SQLCODE = -904                                      06192071
061930         WHEN SQLCODE = -911                                      06193071
061940         WHEN SQLCODE = -913                                      06194071
061950             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    06195071
061960             MOVE '3040-CHECK-RCVR-ARRIVED' TO PV-SOFT-PARAGRAPH  06196071
061970             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  06197071
061980             MOVE LENGTH OF PV-CICS-MSG-AREA2                     06198071
061990               TO PV-COMMAREA-LENGTH                              06199071
062000             EXEC CICS                                            06200071
062010                  WRITEQ TD                                       06201071
062020                   QUEUE  ('CSSL')                                06202071
062030                    FROM  (PV-CICS-MSG-AREA2)                     06203071
062040                  LENGTH  (PV-COMMAREA-LENGTH)                    06204071
062050                    RESP  (PV-CICS-RESP)                          06205071
062060             END-EXEC                                             06206071
062070             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          06207071
062080             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              06208071
062090             PERFORM 9900-SOFT-ABORT                              06209071
062100         WHEN OTHER                                               06210071
062110              MOVE '3040-CHECK-RCVR-ARRIVED'                      06211071
062120                               TO DP013-PARAGRAPH                 06212071
062130              MOVE 'CHECK IF PO/RCVR ARRIVED '                    06213071
062140                               TO DP013-MESSAGE-TEXT (1)          06214071
062150              MOVE SQLCA       TO DP013-SQLCA                     06215071
062160              MOVE 'TRECEIV '  TO DP013-DB2-TABLE-NAME (1)        06216071
062170              SET DP013-DB2-ABEND                                 06217071
062180                  DP013-XCTL-DISPLAY-RESTART                      06218071
062190                                   TO TRUE                        06219071
062200                  PERFORM DP013-0000-PROCESS-ABEND                06220071
062210     END-EVALUATE.                                                06221071
062220                                                                  06222071
062230                                                                  06223071
062240*----------------------------------------------------------------*06224071
062250*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *06225071
062260*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*06226071
062270*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *06227071
062280*                                                                *06228071
062290*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *06229071
062300*    IN A BLOCK, RE-CALCULATE THE SUBSCRIPT BY SUBTRACTING OUT   *06230071
062310*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *06231071
062320*    US IN THE 2ND BLOCK OF THE ARRAY.                           *06232071
062330*----------------------------------------------------------------*06233071
062340 3100-SET-SUBSCRIPTS.                                             06234071
062350     COMPUTE ASC-ITEM-SUB =                                       06235071
062360         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        06236071
062370                                                                  06237071
062380     IF  ASC-ITEM-SUB  < +1                                       06238071
062390         MOVE +1                      TO ASC-ITEM-SUB.            06239071
062400                                                                  06240071
062410     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         06241071
062420         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            06242071
062430                                                                  06243071
062440         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               06244071
062450     ELSE                                                         06245071
062460         MOVE +1                     TO ASC-BLK-SUB               06246071
062470     END-IF.                                                      06247071
062480                                                                  06248071
062490                                                                  06249071
062500*----------------------------------------------------------------*06250071
062510*  RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.      *06251071
062520*----------------------------------------------------------------*06252071
062530 3200-RESET-ATTRIBUTES.                                           06253071
062540     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA                    06254071
062550                                      MDEST1A                     06255071
062560                                      MDEST2A                     06256071
062570                                      ALBLOPTA                    06257071
062580                                      AHDRFTA                     06258071
062590                                      AORDERA                     06259071
062600                                      MCSEPKA                     06260071
062610                                      A128YNA                     06261071
062620                                      MINSTRA                     06262071
062630                                      MCTNCNTA                    06263071
062640                                      AP2LMODA.                   06264071
062650     MOVE DP015-GREEN              TO ASTRTITC                    06265071
062660                                      MDEST1C                     06266071
062670                                      MDEST2C                     06267071
062680                                      ALBLOPTC                    06268071
062690                                      AHDRFTC                     06269071
062700                                      AORDERC                     06270071
062710                                      MCSEPKC                     06271071
062720                                      A128YNC                     06272071
062730                                      MINSTRC                     06273071
062740                                      MCTNCNTC                    06274071
062750                                      AP2LMODC.                   06275071
062760     MOVE DP015-UNDERLINE          TO ASTRTITH                    06276071
062770                                      MDEST1H                     06277071
062780                                      MDEST2H                     06278071
062790                                      AHDRFTH                     06279071
062800                                      AORDERH                     06280071
062810                                      ALBLOPTH                    06281071
062820                                      MCSEPKH                     06282071
062830                                      A128YNH                     06283071
062840                                      MINSTRH                     06284071
062850                                      MCTNCNTH                    06285071
062860                                      AP2LMODH.                   06286071
062870     MOVE DP015-BLUE               TO MPKGCDC                     06287071
062880                                      ASEASETC.                   06288071
062890                                                                  06289071
062900     PERFORM                                                      06290071
062910         VARYING PV-SUB                                           06291071
062920         FROM 1 BY 1                                              06292071
062930         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        06293071
062940             IF  (MR-SELECTA (PV-SUB) = DP015-ASK-DRK-OFF  AND    06294071
062950                  MR-SELECTH (PV-SUB) = DP015-HL-OFF)             06295071
062960                 CONTINUE                                         06296071
062970             ELSE                                                 06297071
062980             IF  PV-SUB  >  ASC-ITEMS-DISPLAYED  AND              06298071
062990                 NOT DP020-FK-PREV-PAGE(DP020-SRC-AID)            06299071
063000                 CONTINUE                                         06300071
063010             ELSE                                                 06301071
063020                 MOVE DP015-UNP-ALP-NOR-OFF                       06302071
063030                                   TO MR-SELECTA (PV-SUB)         06303071
063040                                      MR-MODA (PV-SUB)            06304071
063050                                      MR-CARTON-CNTA (PV-SUB)     06305071
063060                                      MR-INNER-PACKA (PV-SUB)     06306071
063070                                      MR-OUTER-PACKA (PV-SUB)     06307071
063080                                      MR-IN-PCK-CONVYA (PV-SUB)   06308071
063090                                      MR-LBL-TYPEA (PV-SUB)       06309071
063100                                      MR-CRE-LBL-OPTA (PV-SUB)    06310071
063110                                      MR-CSEPK-AREAA (PV-SUB)     06311071
063120                                      MR-ODD-CARTONA (PV-SUB)     06312071
063130               MOVE DP015-PRO-NOR-MDT                             06313071
063140                                   TO MR-PO-LINEA (PV-SUB)        06314071
063150                                      MR-SKUA (PV-SUB)            06315071
063160                                      MR-PROCESS-QTYA (PV-SUB)    06316071
063170                                      MR-TRANSCRIB-QTYA (PV-SUB)  06317071
063180                                      MR-P2L-LBL-CNTA (PV-SUB)    06318071
063190                                      MR-SHP-LBL-CNTA (PV-SUB)    06319071
063200                                      MR-LINE-STATUSA (PV-SUB)    06320071
063210                 MOVE DP015-GREEN  TO MR-SELECTC (PV-SUB)         06321071
063220                                      MR-MODC (PV-SUB)            06322071
063230                                      MR-CARTON-CNTC (PV-SUB)     06323071
063240                                      MR-INNER-PACKC (PV-SUB)     06324071
063250                                      MR-OUTER-PACKC (PV-SUB)     06325071
063260                                      MR-IN-PCK-CONVYC (PV-SUB)   06326071
063270                                      MR-LBL-TYPEC (PV-SUB)       06327071
063280                                      MR-CRE-LBL-OPTC (PV-SUB)    06328071
063290                                      MR-CSEPK-AREAC (PV-SUB)     06329071
063300                                      MR-ODD-CARTONC (PV-SUB)     06330071
063310                 MOVE DP015-BLUE   TO MR-PROCESS-QTYC (PV-SUB)    06331071
063320                                      MR-TRANSCRIB-QTYC (PV-SUB)  06332071
063330                                      MR-ACTIONC (PV-SUB)         06333071
063340                 MOVE DP015-UNDERLINE                             06334071
063350                                   TO MR-SELECTH (PV-SUB)         06335071
063360                                      MR-MODH (PV-SUB)            06336071
063370                                      MR-CARTON-CNTH (PV-SUB)     06337071
063380                                      MR-INNER-PACKH (PV-SUB)     06338071
063390                                      MR-OUTER-PACKH (PV-SUB)     06339071
063400                                      MR-IN-PCK-CONVYH (PV-SUB)   06340071
063410                                      MR-LBL-TYPEH (PV-SUB)       06341071
063420                                      MR-CRE-LBL-OPTH (PV-SUB)    06342071
063430                                      MR-CSEPK-AREAH (PV-SUB)     06343071
063440                                      MR-ODD-CARTONH (PV-SUB)     06344071
063450                 MOVE DP015-HL-OFF                                06345071
063460                                   TO MR-TRANSCRIB-QTYH(PV-SUB)   06346071
063470                                      MR-PROCESS-QTYH(PV-SUB)     06347071
063480                                      MR-SKUH(PV-SUB)             06348071
063490         END-IF                                                   06349071
063500         END-IF                                                   06350071
063510     END-PERFORM.                                                 06351071
063520                                                                  06352071
063530                                                                  06353071
063540*----------------------------------------------------------------*06354071
063550*  EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS     *06355071
063560*  WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'    *06356071
063570*  IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR     *06357071
063580*  WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.              *06358071
063590*----------------------------------------------------------------*06359071
063600 3300-EDIT-SELECTIONS.                                            06360071
063610     IF  DP020-NEXT-ACT-RETURN                                    06361071
063620         MOVE  SPACES                TO  PV-LINE-STATUS           06362071
063630         SET  ASC-UPDATE-OK(ASC-BLK-SUB ASC-ITEM-SUB)             06363071
063640              ASC-NOT-PROTECTED(ASC-BLK-SUB ASC-ITEM-SUB)         06364071
063650                                     TO TRUE.                     06365071
063660     EVALUATE TRUE                                                06366071
063670         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     06367071
063680             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         06368071
063690                 CONTINUE                                         06369071
063700         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         06370071
063710             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        06371071
063720                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   06372071
063730                 MOVE ASC-TEMP-SELECTED-SW                        06373071
063740                                      (ASC-BLK-SUB ASC-ITEM-SUB)  06374071
063750                                TO ASC-SELECTED-SW                06375071
063760                                      (ASC-BLK-SUB ASC-ITEM-SUB)  06376071
063770             END-IF                                               06377071
063780         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     06378071
063790                 = SPACE                                          06379071
063800             EVALUATE TRUE                                        06380071
063810                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       06381071
063820                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS06382071
063830                     MOVE SPACE TO ASC-SELECTED-SW                06383071
063840                                      (ASC-BLK-SUB ASC-ITEM-SUB)  06384071
063850                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        06385071
063860                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    06386071
063870                     MOVE SPACE TO ASC-SELECTED-SW                06387071
063880                                      (ASC-BLK-SUB ASC-ITEM-SUB)  06388071
063890                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          06389071
063900                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      06390071
063910                     MOVE SPACE TO ASC-SELECTED-SW                06391071
063920                                      (ASC-BLK-SUB ASC-ITEM-SUB)  06392071
063930             END-EVALUATE                                         06393071
063940         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           06394071
063950             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            06395071
063960                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    06396071
063970             END-IF                                               06397071
063980             PERFORM 3310-EDIT-RANGE                              06398071
063990         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             06399071
064000             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            06400071
064010                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    06401071
064020             END-IF                                               06402071
064030             PERFORM 3310-EDIT-RANGE                              06403071
064040         WHEN OTHER                                               06404071
064050             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           06405071
064060             SET DP020-MSG-FATAL    TO TRUE                       06406071
064070             MOVE -1                TO MR-SELECTL (PV-SUB)        06407071
064080             SET DP030-SET-CURSOR-APPL-1                          06408071
064090                                    TO TRUE                       06409071
064100             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        06410071
064110             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        06411071
064120             SET PS-ERROR TO TRUE                                 06412071
064130             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            06413071
064140                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     06414071
064150                 MOVE SPACE         TO ASC-SELECTED-SW            06415071
064160                                        (ASC-BLK-SUB ASC-ITEM-SUB)06416071
064170             END-IF                                               06417071
064180     END-EVALUATE.                                                06418071
064190                                                                  06419071
064200     IF  DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID) OR                06420071
064210         DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)                   06421071
064220         CONTINUE                                                 06422071
064230     ELSE                                                         06423071
064240         PERFORM 3305-EDIT-LINES                                  06424071
064250     END-IF.                                                      06425071
064260*                                                                 06426071
064270**send error when pack deleted and there are no distributions     06427071
064280*                                                                 06428071
064290     IF DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)                    06429071
064300        IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)                  06430071
064310           IF ASC-TRANSCRIBE-QTY                                  06431071
064320                  (ASC-BLK-SUB ASC-ITEM-SUB) = 0                  06432071
064330                 MOVE PC-TSYMSG-03043 TO DP020-MSG-NUMBER         06433071
064340                 SET DP020-MSG-FATAL  TO TRUE                     06434071
064350                 MOVE -1              TO MR-SELECTL(PV-SUB)       06435071
064360                 SET DP030-SET-CURSOR-APPL-1                      06436071
064370                                      TO TRUE                     06437071
064380                 MOVE DP015-RED       TO MR-SKUC(PV-SUB)          06438071
064390                 MOVE DP015-REVERSE   TO MR-SKUH(PV-SUB)          06439071
064400                 SET PS-ERROR                                     06440071
064410                     PS-BLOCK-ERROR   TO  TRUE                    06441071
064420           END-IF                                                 06442071
064430        END-IF                                                    06443071
064440     END-IF.                                                      06444071
064450                                                                  06445071
064460                                                                  06446071
064470     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 06447071
064480     SUBTRACT +1 FROM ASC-ITEM-SUB.                               06448071
064490     IF  ASC-ITEM-SUB < 1                                         06449071
064500         SUBTRACT +1 FROM ASC-BLK-SUB                             06450071
064510         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                06451071
064520     END-IF.                                                      06452071
064530                                                                  06453071
064540                                                                  06454071
064550*----------------------------------------------------------------*06455071
064560*  EDIT SELECTED LINES                                           *06456071
064570*----------------------------------------------------------------*06457071
064580 3305-EDIT-LINES.                                                 06458071
064590                                                                  06459071
064600     MOVE  ZEROES  TO  PV-DC-BOUND-EXPT-CNT                       06460071
064610                       PV-RTV-BOUND-EXPT-CNT.                     06461071
064620                                                                  06462071
064630                                                                  06463071
064640* RE-CHECK LINE-STATUS                                            06464071
064650                                                                  06465071
064660     MOVE  ASC-PO-LNE-NBR (ASC-BLK-SUB ASC-ITEM-SUB)              06466071
064670           TO  ASC-PO-LINE-NBR.                                   06467071
064680                                                                  06468071
064690     SET  ASC-UPDATE-OK  (ASC-BLK-SUB ASC-ITEM-SUB)               06469071
064700          ASC-NOT-PROTECTED (ASC-BLK-SUB ASC-ITEM-SUB)            06470071
064710          ASC-NO-LINE-ERROR (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE.   06471071
064720                                                                  06472071
064730     PERFORM 3350-CHECK-LINE-STATUS.                              06473071
064740                                                                  06474071
064750     EVALUATE TRUE                                                06475071
064760         WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)              06476071
064770              IF  ASC-LNE-CRE-P2L-LBL (ASC-BLK-SUB ASC-ITEM-SUB)  06477071
064780                  PERFORM 3355-CHECK-TRANSCRIBED                  06478071
064790              END-IF                                              06479071
064800     END-EVALUATE.                                                06480071
064810                                                                  06481071
064820     EVALUATE TRUE                                                06482071
064830         WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)              06483071
064840              IF  ASC-LNE-CRE-P2L-LBL (ASC-BLK-SUB ASC-ITEM-SUB)  06484071
064850                  IF  ASC-LINE-STATUS (ASC-BLK-SUB ASC-ITEM-SUB)  06485071
064860                      = ('DCBD' OR 'DCRT' OR 'RTV ')              06486071
064870                       MOVE PC-TSYMSG-03356 TO DP020-MSG-NUMBER   06487071
064880                       SET DP020-MSG-FATAL  TO TRUE               06488071
064890                       MOVE -1              TO MR-SELECTL(PV-SUB) 06489071
064900                       SET DP030-SET-CURSOR-APPL-1                06490071
064910                                            TO TRUE               06491071
064920                       MOVE DP015-RED       TO MR-SKUC(PV-SUB)    06492071
064930                       MOVE DP015-REVERSE   TO MR-SKUH(PV-SUB)    06493071
064940                       SET PS-ERROR                               06494071
064950                           PS-BLOCK-ERROR   TO  TRUE              06495071
064960                  END-IF                                          06496071
064970              END-IF                                              06497071
064980     END-EVALUATE.                                                06498071
064990                                                                  06499071
065000     EVALUATE TRUE                                                06500071
065010         WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)              06501071
065020              IF  NOT ASC-LBL-TYP-UCC128                          06502071
065030                      (ASC-BLK-SUB ASC-ITEM-SUB)  AND             06503071
065040                  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)           06504071
065050                  SET PS-DUMMY-TRIP-NO  TO  TRUE                  06505071
065060                  PERFORM 3357-CHECK-DUMMY-TRIP                   06506071
065070                  IF  PS-DUMMY-TRIP-YES                           06507071
065080                       MOVE PC-TSYMSG-03398 TO DP020-MSG-NUMBER   06508071
065090                       SET DP020-MSG-FATAL  TO TRUE               06509071
065100                       MOVE -1              TO MR-SELECTL(PV-SUB) 06510071
065110                       SET DP030-SET-CURSOR-APPL-1                06511071
065120                                            TO TRUE               06512071
065130                       MOVE DP015-RED       TO MR-SKUC(PV-SUB)    06513071
065140                       MOVE DP015-REVERSE   TO MR-SKUH(PV-SUB)    06514071
065150                       SET PS-ERROR                               06515071
065160                           PS-BLOCK-ERROR   TO  TRUE              06516071
065170                  ELSE                                            06517071
065180                  IF  PS-DUMMY-TRIP-NO       AND                  06518071
065190                      PS-TRAILER-ARRIVED-NO                       06519071
065200                       MOVE PC-TSYMSG-03402 TO DP020-MSG-NUMBER   06520071
065210                       SET DP020-MSG-FATAL  TO TRUE               06521071
065220                       MOVE -1              TO MR-SELECTL(PV-SUB) 06522071
065230                       SET DP030-SET-CURSOR-APPL-1                06523071
065240                                            TO TRUE               06524071
065250                       MOVE DP015-RED       TO MR-SKUC(PV-SUB)    06525071
065260                       MOVE DP015-REVERSE   TO MR-SKUH(PV-SUB)    06526071
065270                       SET PS-ERROR                               06527071
065280                           PS-BLOCK-ERROR   TO  TRUE              06528071
065290                  END-IF                                          06529071
065300                  END-IF                                          06530071
065310              END-IF                                              06531071
065320     END-EVALUATE.                                                06532071
065330                                                                  06533071
065340     EVALUATE TRUE                                                06534071
065350         WHEN  DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)             06535071
065360         WHEN  DP020-SRC-AID = DP016-ENTER                        06536071
065370               IF  ASC-NOT-PROTECTED(ASC-BLK-SUB ASC-ITEM-SUB)    06537071
065380                   PERFORM 3360-CHECK-LBL-CREATE-OPT              06538071
065390               END-IF                                             06539071
065400     END-EVALUATE.                                                06540071
065500                                                                  06550071
065600     EVALUATE TRUE                                                06560071
065700         WHEN  DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)             06570071
065800         WHEN  DP020-SRC-AID = DP016-ENTER                        06580071
065810               IF  ASC-NOT-PROTECTED(ASC-BLK-SUB ASC-ITEM-SUB) AND06581071
065820                      (ASC-LNE-CRE-P2L-LBL                        06582071
065830                           (ASC-BLK-SUB ASC-ITEM-SUB)  OR         06583071
065840                       ASC-LNE-CRE-BOTH-LBL                       06584071
065850                           (ASC-BLK-SUB ASC-ITEM-SUB))            06585071
065860                   PERFORM 3365-CHECK-DC-P2L-MODULES              06586071
065870               END-IF                                             06587071
065880     END-EVALUATE.                                                06588071
065890                                                                  06589071
065900     EVALUATE TRUE                                                06590071
065910         WHEN  DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)             06591071
065920               IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)  AND     06592071
065930                   ASC-PRE-PACK-ORDER                             06593071
065940                   IF  ASC-PREPK-RATIO(ASC-BLK-SUB ASC-ITEM-SUB)  06594071
065950                           >  0                                   06595071
065960                           CONTINUE                               06596071
065970                   ELSE                                           06597071
065980                       MOVE PC-TSYMSG-02890 TO DP020-MSG-NUMBER   06598071
065990                       SET DP020-MSG-FATAL  TO TRUE               06599071
066000                       MOVE -1              TO MR-SELECTL(PV-SUB) 06600071
066010                       SET DP030-SET-CURSOR-APPL-1                06601071
066020                                            TO TRUE               06602071
066030                       MOVE DP015-RED       TO MR-SKUC(PV-SUB)    06603071
066040                       MOVE DP015-REVERSE   TO MR-SKUH(PV-SUB)    06604071
066050                       SET PS-ERROR                               06605071
066060                           PS-BLOCK-ERROR   TO  TRUE              06606071
066070                   END-IF                                         06607071
066080               END-IF                                             06608071
066090     END-EVALUATE.                                                06609071
066100                                                                  06610071
066200     IF  ASC-LNE-CRE-P2L-LBL (ASC-BLK-SUB ASC-ITEM-SUB)           06620071
066210         MOVE  ZEROES  TO  ASC-ODD-CARTON                         06621071
066220                           (ASC-BLK-SUB ASC-ITEM-SUB)             06622071
066230     END-IF.                                                      06623071
066231                                                                  06623171
066232******************************************************************06623271
066233* added check for asc-protected (lines that have been downloaded) 06623371
066234* to continue and NOT reset swithches                             06623471
066235******************************************************************06623571
066236                                                                  06623671
066237     IF  ASC-PROTECTED(ASC-BLK-SUB ASC-ITEM-SUB)                  06623771
066238         CONTINUE                                                 06623871
066239     ELSE                                                         06623971
066240                                                                  06624071
066250         IF  ASC-LBL-TYP-PGYBK(ASC-BLK-SUB ASC-ITEM-SUB) AND      06625071
066260             ASC-DO-NOT-PRINT-PGYBK                               06626071
066270                 SET  ASC-LNE-DO-NOT-PRT-LBL                      06627071
066280                     (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE           06628071
066290         ELSE                                                     06629071
066300         IF  ASC-LBL-TYP-SML(ASC-BLK-SUB ASC-ITEM-SUB) AND        06630071
066310             ASC-DO-NOT-PRINT-SML                                 06631071
066320                 SET  ASC-LNE-DO-NOT-PRT-LBL                      06632071
066330                     (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE           06633071
066340         ELSE                                                     06634071
066350         IF  ASC-STORE-SML(ASC-BLK-SUB ASC-ITEM-SUB) AND          06635071
066360             ASC-DO-NOT-PRINT-SML                                 06636071
066370                 SET  ASC-LNE-DO-NOT-PRT-LBL                      06637071
066380                     (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE           06638071
066390         ELSE                                                     06639071
066400         IF  ASC-LBL-TYP-NONE(ASC-BLK-SUB ASC-ITEM-SUB) AND       06640071
066410             ASC-DO-NOT-PRINT-SML                                 06641071
066420                 SET  ASC-LNE-DO-NOT-PRT-LBL                      06642071
066430                     (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE           06643071
066440         END-IF                                                   06644071
066450         END-IF                                                   06645071
066460         END-IF                                                   06646071
066470         END-IF                                                   06647071
066480     END-IF                                                       06648071
066490                                                                  06649071
066500     EVALUATE TRUE                                                06650071
066510         WHEN  DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)             06651071
066520               IF  ASC-NOT-PROTECTED(ASC-BLK-SUB ASC-ITEM-SUB) AND06652071
066530                   ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)      06653071
066540                   PERFORM 3330-CHECK-LBL-CREATE-FLDS             06654071
066550               END-IF                                             06655071
066560     END-EVALUATE.                                                06656071
066570                                                                  06657071
066580     EVALUATE TRUE                                                06658071
066590         WHEN  DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)             06659071
066600               IF  ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)      06660071
066610                   PERFORM 3330-CHECK-LBL-CREATE-FLDS             06661071
066620               END-IF                                             06662071
066630     END-EVALUATE.                                                06663071
066640                                                                  06664071
066650     IF  PS-NO-ERROR                                              06665071
066660         PERFORM 3340-CHECK-REST-OF-LINE.                         06666071
066670                                                                  06667071
066680     EVALUATE TRUE                                                06668071
066690         WHEN  DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)             06669071
066700               SET ASC-P2L-RESEND-HILITE-NO                       06670071
066710                   (ASC-BLK-SUB ASC-ITEM-SUB)  TO  TRUE           06671071
066720               IF  PS-NO-ERROR                                    06672071
066730                   PERFORM 3380-CHECK-P2L-RESEND                  06673071
066740               END-IF                                             06674071
066750     END-EVALUATE.                                                06675071
066760                                                                  06676071
066770     EVALUATE TRUE                                                06677071
066780         WHEN  DP020-FK-LOCAL-FUNC-10 (DP020-SRC-AID)             06678071
066790            IF ASC-AUTOVE-PARM-YES                                06679071
066800               SET ASC-IGNR-UCC128-AUTH-NO  TO TRUE               06680071
066810               IF  ASC-LNE-UCC128-YES (ASC-BLK-SUB ASC-ITEM-SUB)  06681071
066820                 IF ASC-UCC128-AVAIL-NO                           06682071
066830                    CONTINUE                                      06683071
066840                 ELSE                                             06684071
066850                                                                  06685071
066860                 IF  ASC-PROCESS-QTY (ASC-BLK-SUB ASC-ITEM-SUB)   06686071
066870                     LESS THAN                                    06687071
066880                     ASC-TRANSCRIBE-QTY (ASC-BLK-SUB ASC-ITEM-SUB)06688071
066890                     OR                                           06689071
066900                     ASC-PROCESS-QTY (ASC-BLK-SUB ASC-ITEM-SUB)   06690071
066910                     GREATER THAN                                 06691071
066920                     ASC-TRANSCRIBE-QTY (ASC-BLK-SUB ASC-ITEM-SUB)06692071
066930                    CONTINUE                                      06693071
066940                                                                  06694071
066950                 ELSE                                             06695071
066960                    PERFORM 2106-LINK-FKEY-MODULE                 06696071
066970                    IF PS-INGR-UCC128-NOT-ALLOWED                 06697071
066980                       MOVE PC-TSYMSG-03190  TO DP020-MSG-NUMBER  06698071
066990                       SET DP020-MSG-FATAL       TO TRUE          06699071
067000                       MOVE -1                   TO MR-SELECTL (1)06700071
067010                       SET DP030-SET-CURSOR-APPL-1                06701071
067020                                                 TO TRUE          06702071
067030                       SET PS-ERROR              TO TRUE          06703071
067040                       SET ASC-NO-TSQ-UPDATE TO TRUE              06704071
067050                    ELSE                                          06705071
067060                       SET ASC-IGNR-UCC128-AUTH-YES TO TRUE       06706071
067070                    END-IF                                        06707071
067080                 END-IF                                           06708071
067090                 END-IF                                           06709071
067100               END-IF                                             06710071
067110            END-IF                                                06711071
067120     END-EVALUATE.                                                06712071
067130                                                                  06713071
067140     EVALUATE TRUE                                                06714071
067150         WHEN  DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)             06715071
067160              IF  ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)       06716071
067170                IF ASC-AUTOVE-PARM-YES AND                        06717071
067180                   ASC-LNE-DO-NOT-PRT-LBL                         06718071
067190                             (ASC-BLK-SUB ASC-ITEM-SUB) AND       06719071
067200                   ASC-SML-LABEL-CNT                              06720071
067210                     (ASC-BLK-SUB ASC-ITEM-SUB) > 0               06721071
067220                      MOVE PC-TSYMSG-03191  TO DP020-MSG-NUMBER   06722071
067230                      SET DP020-MSG-FATAL       TO TRUE           06723071
067240                      MOVE -1                   TO MR-SELECTL (1) 06724071
067250                      SET DP030-SET-CURSOR-APPL-1                 06725071
067260                                                TO TRUE           06726071
067270                      SET PS-ERROR              TO TRUE           06727071
067280                      SET ASC-NO-TSQ-UPDATE TO TRUE               06728071
067290                END-IF                                            06729071
067300              END-IF                                              06730071
067310     END-EVALUATE.                                                06731071
067320                                                                  06732071
067330*----------------------------------------------------------------*06733071
067340*  IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A       *06734071
067350*  RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1     *06735071
067360*  ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) *06736071
067370*  THE ENDING.                                                   *06737071
067380*----------------------------------------------------------------*06738071
067390 3310-EDIT-RANGE.                                                 06739071
067400     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                06740071
067410         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   06741071
067420             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)06742071
067430                                   TO ASC-SELECTED-SW             06743071
067440                                        (ASC-BLK-SUB ASC-ITEM-SUB)06744071
067450             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 06745071
067460         ELSE                                                     06746071
067470             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     06747071
067480                 CONTINUE                                         06748071
067490             ELSE                                                 06749071
067500*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        06750071
067510                 MOVE PC-TSYMSG-00054                             06751071
067520                                   TO DP020-MSG-NUMBER            06752071
067530                 SET DP020-MSG-FATAL                              06753071
067540                                   TO TRUE                        06754071
067550                 MOVE -1           TO MR-SELECTL (PV-SUB)         06755071
067560                 SET DP030-SET-CURSOR-APPL-1                      06756071
067570                                   TO TRUE                        06757071
067580                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         06758071
067590                 MOVE DP015-UNDERLINE                             06759071
067600                                   TO MR-SELECTH (PV-SUB)         06760071
067610                 SET PS-ERROR      TO TRUE                        06761071
067620             END-IF                                               06762071
067630         END-IF                                                   06763071
067640     ELSE                                                         06764071
067650         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     06765071
067660             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 06766071
067670                                   TO ASC-SELECTED-SW             06767071
067680                                     (ASC-BLK-SUB ASC-ITEM-SUB)   06768071
067690             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   06769071
067700         ELSE                                                     06770071
067710             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       06771071
067720                 CONTINUE                                         06772071
067730             ELSE                                                 06773071
067740*                -- ONLY ONE END-OF-RANGE ALLOWED --              06774071
067750                 MOVE PC-TSYMSG-00055                             06775071
067760                                   TO DP020-MSG-NUMBER            06776071
067770                 SET DP020-MSG-FATAL                              06777071
067780                                   TO TRUE                        06778071
067790                 MOVE -1           TO MR-SELECTL (PV-SUB)         06779071
067800                 SET DP030-SET-CURSOR-APPL-1                      06780071
067810                                   TO TRUE                        06781071
067820                 SET PS-ERROR      TO TRUE                        06782071
067830             END-IF                                               06783071
067840         END-IF                                                   06784071
067850     END-IF.                                                      06785071
067860                                                                  06786071
067870                                                                  06787071
067880*----------------------------------------------------------------*06788071
067890* VERIFY THAT THE MODULE NUMBER IS VALID                         *06789071
067900*----------------------------------------------------------------*06790071
067910 3320-VERIFY-MODULE-NBR.                                          06791071
067920     MOVE  ASC-OPER-UNT-ID  TO  PV-OPER-UNT-ID-HOLD.              06792071
067930     MOVE  ASC-MODULE (ASC-BLK-SUB ASC-ITEM-SUB)                  06793071
067940                            TO  PV-MODU-NBR-HOLD.                 06794071
067950                                                                  06795071
067960     EXEC SQL                                                     06796071
067970         SELECT OPER_UNT_ID                                       06797071
067980               ,DIVERT_CDE                                        06798071
067990               ,SRVR_IP_ADDR                                      06799071
068000               ,P2L_SFWR_VND_ID                                   06800071
068010               ,P2L_SFWR_VC_NBR                                   06801071
068020           INTO :P2LMOD-OPER-UNT-ID                               06802071
068030               ,:P2LMOD-DIVERT-CDE                                06803071
068040               ,:P2LMOD-SRVR-IP-ADDR                              06804071
068050               ,:P2LMOD-P2L-SFWR-VND-ID                           06805071
068060               ,:P2LMOD-P2L-SFWR-VC-NBR                           06806071
068070           FROM TP2LMOD                                           06807071
068080          WHERE OPER_UNT_ID    = :PV-OPER-UNT-ID-HOLD             06808071
068090            AND MODU_NBR       = :PV-MODU-NBR-HOLD                06809071
068100     END-EXEC                                                     06810071
068110                                                                  06811071
068120     EVALUATE TRUE                                                06812071
068130         WHEN SQLCODE = +0                                        06813071
068140             MOVE P2LMOD-DIVERT-CDE                               06814071
068150               TO ASC-P2L-DIVERT-CDE(ASC-BLK-SUB ASC-ITEM-SUB)    06815071
068160             MOVE P2LMOD-SRVR-IP-ADDR  TO  PV-IP-ADDRESS          06816071
068170             PERFORM 4635-FORMAT-IP-ADDR                          06817071
068180                                                                  06818071
068190             IF  PV-SIN-ADDR-1  =  PV-SIN-ADDR-ZERO               06819071
068200                 MOVE DP081-NAME-IP-ADDR  TO  PV-SIN-ADDR-1       06820071
068210                 MOVE PC-ONE         TO  ASC-SOCKET-NBR           06821071
068220                                    (ASC-BLK-SUB ASC-ITEM-SUB)    06822071
068230             ELSE                                                 06823071
068240             IF  PV-SIN-ADDR-1  >  PV-SIN-ADDR-ZERO               06824071
068250                 IF  DP081-NAME-IP-ADDR  =  PV-SIN-ADDR-1         06825071
068260                     MOVE PC-ONE     TO  ASC-SOCKET-NBR           06826071
068270                                      (ASC-BLK-SUB ASC-ITEM-SUB)  06827071
068280                 ELSE                                             06828071
068290                     MOVE DP081-NAME-IP-ADDR TO  PV-SIN-ADDR-2    06829071
068300                     MOVE PC-TWO     TO  ASC-SOCKET-NBR           06830071
068310                                      (ASC-BLK-SUB ASC-ITEM-SUB)  06831071
068320                 END-IF                                           06832071
068330             ELSE                                                 06833071
068340                  MOVE DP081-NAME-IP-ADDR   TO  PV-SIN-ADDR-2     06834071
068350                  MOVE PC-TWO        TO  ASC-SOCKET-NBR           06835071
068360                                      (ASC-BLK-SUB ASC-ITEM-SUB)  06836071
068370             END-IF                                               06837071
068380             END-IF                                               06838071
068390             MOVE P2LMOD-P2L-SFWR-VND-ID                          06839071
068400                                     TO  ASC-P2L-VENDOR           06840071
068410                                      (ASC-BLK-SUB ASC-ITEM-SUB)  06841071
068420                                                                  06842071
068430             IF  P2LMOD-P2L-SFWR-VND-ID = 'DNP'                   06843071
068440                 IF  P2LMOD-P2L-SFWR-VC-NBR > 0                   06844071
068450                     SET ASC-P2L-ALS-4-DIGIT-STR                  06845071
068460                         (ASC-BLK-SUB ASC-ITEM-SUB)               06846071
068470                     TO TRUE                                      06847071
068480                 ELSE                                             06848071
068490                     SET ASC-P2L-ALS-3-DIGIT-STR                  06849071
068500                         (ASC-BLK-SUB ASC-ITEM-SUB)               06850071
068510                     TO TRUE                                      06851071
068520                 END-IF                                           06852071
068530             ELSE                                                 06853071
068540                 MOVE SPACE TO ASC-P2L-ALS-VC-SW                  06854071
068550                         (ASC-BLK-SUB ASC-ITEM-SUB)               06855071
068560             END-IF                                               06856071
068570                                                                  06857071
068580         WHEN SQLCODE = +100                                      06858071
068590             SET PS-ERROR                                         06859071
068600                 DP020-MSG-FATAL                                  06860071
068610                 PS-BLOCK-ERROR  TO  TRUE                         06861071
068620             MOVE PC-TSYMSG-01731        TO DP020-MSG-NUMBER      06862071
068630             MOVE DP015-UNP-ALP-BRT-OFF  TO MR-MODA (PV-SUB)      06863071
068640             MOVE DP015-RED              TO MR-MODC (PV-SUB)      06864071
068650             MOVE DP015-REVERSE          TO MR-MODH (PV-SUB)      06865071
068660             MOVE -1                     TO MR-MODL (PV-SUB)      06866071
068670             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06867071
068680         WHEN SQLCODE = -904                                      06868071
068690         WHEN SQLCODE = -911                                      06869071
068700         WHEN SQLCODE = -913                                      06870071
068710                                                                  06871071
068720             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    06872071
068730             MOVE '3320-VERIFY-MODULE-NBR'  TO PV-SOFT-PARAGRAPH  06873071
068740             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  06874071
068750             MOVE LENGTH OF PV-CICS-MSG-AREA2                     06875071
068760               TO PV-COMMAREA-LENGTH                              06876071
068770             EXEC CICS                                            06877071
068780                  WRITEQ TD                                       06878071
068790                   QUEUE  ('CSSL')                                06879071
068800                    FROM  (PV-CICS-MSG-AREA2)                     06880071
068810                  LENGTH  (PV-COMMAREA-LENGTH)                    06881071
068820                    RESP  (PV-CICS-RESP)                          06882071
068830             END-EXEC                                             06883071
068840                                                                  06884071
068850             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          06885071
068860             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              06886071
068870             PERFORM 9900-SOFT-ABORT                              06887071
068880         WHEN OTHER                                               06888071
068890              MOVE '3320-VERIFY-MODULE-NBR'                       06889071
068900                               TO DP013-PARAGRAPH                 06890071
068910              MOVE 'VERIFY MODULE NBR VALID '                     06891071
068920                               TO DP013-MESSAGE-TEXT (1)          06892071
068930              MOVE SQLCA       TO DP013-SQLCA                     06893071
068940              MOVE 'TP2LMOD '  TO DP013-DB2-TABLE-NAME (1)        06894071
068950              SET DP013-DB2-ABEND                                 06895071
068960                  DP013-XCTL-DISPLAY-RESTART                      06896071
068970                                   TO TRUE                        06897071
068980                  PERFORM DP013-0000-PROCESS-ABEND                06898071
068990     END-EVALUATE.                                                06899071
069000                                                                  06900071
069010                                                                  06901071
069020*----------------------------------------------------------------*06902071
069030* VERIFY THAT THE MODULE NUMBER IS VALID                         *06903071
069040*----------------------------------------------------------------*06904071
069050 3321-VERIFY-MOD-NBR-ASC.                                         06905071
069060     MOVE  ASC-OPER-UNT-ID  TO  PV-OPER-UNT-ID-HOLD.              06906071
069070     MOVE  ASC-MODU-NBR     TO  PV-MODU-NBR-HOLD.                 06907071
069080                                                                  06908071
069090                                                                  06909071
069100     EXEC SQL                                                     06910071
069110         SELECT OPER_UNT_ID                                       06911071
069120           INTO :P2LMOD-OPER-UNT-ID                               06912071
069130           FROM TP2LMOD                                           06913071
069140          WHERE OPER_UNT_ID    = :PV-OPER-UNT-ID-HOLD             06914071
069150            AND MODU_NBR       = :PV-MODU-NBR-HOLD                06915071
069160     END-EXEC                                                     06916071
069170                                                                  06917071
069180     EVALUATE TRUE                                                06918071
069190         WHEN SQLCODE = +0                                        06919071
069200             CONTINUE                                             06920071
069210         WHEN SQLCODE = +100                                      06921071
069220             SET PS-ERROR                                         06922071
069230             DP020-MSG-FATAL       TO TRUE                        06923071
069240             MOVE PC-TSYMSG-01731      TO DP020-MSG-NUMBER        06924071
069250             MOVE DP015-UNP-ALP-BRT-OFF                           06925071
069260                                       TO AP2LMODA                06926071
069270             MOVE DP015-RED            TO AP2LMODC                06927071
069280             MOVE DP015-REVERSE        TO AP2LMODH                06928071
069290             MOVE -1                   TO AP2LMODL                06929071
069300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06930071
069310         WHEN SQLCODE = +100                                      06931071
069320         WHEN SQLCODE = -904                                      06932071
069330         WHEN SQLCODE = -911                                      06933071
069340         WHEN SQLCODE = -913                                      06934071
069350             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    06935071
069360             MOVE '3321-VERIFY-MOD-ASC   '  TO PV-SOFT-PARAGRAPH  06936071
069370             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  06937071
069380             MOVE LENGTH OF PV-CICS-MSG-AREA2                     06938071
069390               TO PV-COMMAREA-LENGTH                              06939071
069400             EXEC CICS                                            06940071
069410                  WRITEQ TD                                       06941071
069420                   QUEUE  ('CSSL')                                06942071
069430                    FROM  (PV-CICS-MSG-AREA2)                     06943071
069440                  LENGTH  (PV-COMMAREA-LENGTH)                    06944071
069450                    RESP  (PV-CICS-RESP)                          06945071
069460             END-EXEC                                             06946071
069470             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          06947071
069480             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              06948071
069490             PERFORM 9900-SOFT-ABORT                              06949071
069500         WHEN OTHER                                               06950071
069510              MOVE '3321-VERIFY-MODULE-ASC'                       06951071
069520                               TO DP013-PARAGRAPH                 06952071
069530              MOVE 'VERIFY MODULE NBR VALID '                     06953071
069540                               TO DP013-MESSAGE-TEXT (1)          06954071
069550              MOVE SQLCA       TO DP013-SQLCA                     06955071
069560              MOVE 'TP2LMOD '  TO DP013-DB2-TABLE-NAME (1)        06956071
069570              SET DP013-DB2-ABEND                                 06957071
069580                  DP013-XCTL-DISPLAY-RESTART                      06958071
069590                                   TO TRUE                        06959071
069600                  PERFORM DP013-0000-PROCESS-ABEND                06960071
069610     END-EVALUATE.                                                06961071
069620                                                                  06962071
069630                                                                  06963071
069640*----------------------------------------------------------------*06964071
069650* CHECK THE MAXIMUM NUMBER OF CARTONS ALLOWED TO BE SENT TO PCC  *06965071
069660*----------------------------------------------------------------*06966071
069670 3321-CHECK-P2L-LIMIT.                                            06967071
069680                                                                  06968071
069690     EXEC SQL                                                     06969071
069700          SELECT FUNC_QTY                                         06970071
069800          INTO  :KRPRPM-FUNC-QTY                                  06980071
069810          FROM   TKRPRPM                                          06981071
069820          WHERE  SYS_PRC_FUNC_CDE  = 'P2LMAX'                     06982071
069830            AND  LOC_ID            = :PV-OPER-UNT-ID-HOLD         06983071
069840            AND  INTFC_SYS_CDE     = 'PCC'                        06984071
069850            AND  FUNC_PRC_STAT_CDE = 'AC'                         06985071
069860     END-EXEC.                                                    06986071
069870                                                                  06987071
069880                                                                  06988071
069890     EVALUATE TRUE                                                06989071
069900         WHEN SQLCODE = ZERO                                      06990071
069910              IF  ASC-P2L-LABEL-CNT (ASC-BLK-SUB ASC-ITEM-SUB)    06991071
069920                  >   KRPRPM-FUNC-QTY                             06992071
069930                  SET PS-ERROR                                    06993071
069940                      DP020-MSG-FATAL                             06994071
069950                      PS-BLOCK-ERROR TO TRUE                      06995071
069960                  MOVE KRPRPM-FUNC-QTY   TO PV-ZERO-SUP-VAR       06996071
069970                  MOVE PV-ZERO-SUP-VAR   TO DP020-MSG-TEXT        06997071
069980                  MOVE PC-TSYMSG-02994   TO DP020-MSG-NUMBER      06998071
069990                  MOVE DP015-UNP-ALP-BRT-OFF                      06999071
070000                                         TO MR-SELECTA(PV-SUB)    07000071
070010                  MOVE DP015-RED         TO MR-SELECTC (PV-SUB)   07001071
070020                                            MR-CARTON-CNT(PV-SUB) 07002071
070030                                            MR-P2L-LBL-CNT(PV-SUB)07003071
070040                  MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)   07004071
070050                                            MR-CARTON-CNT(PV-SUB) 07005071
070060                                            MR-P2L-LBL-CNT(PV-SUB)07006071
070070                  MOVE -1                TO MR-SELECTL (PV-SUB)   07007071
070080                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             07008071
070090              END-IF                                              07009071
070100         WHEN SQLCODE = +100                                      07010071
070110             CONTINUE                                             07011071
070120         WHEN SQLCODE = -904                                      07012071
070130         WHEN SQLCODE = -911                                      07013071
070140         WHEN SQLCODE = -913                                      07014071
070150             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   07015071
070160             MOVE '3321-CHECK-P2L-LIMIT    ' TO PV-SOFT-PARAGRAPH 07016071
070170             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 07017071
070180             MOVE LENGTH OF PV-CICS-MSG-AREA2                     07018071
070190               TO PV-COMMAREA-LENGTH                              07019071
070200             EXEC CICS                                            07020071
070210                  WRITEQ TD                                       07021071
070220                   QUEUE  ('CSSL')                                07022071
070230                    FROM  (PV-CICS-MSG-AREA2)                     07023071
070240                  LENGTH  (PV-COMMAREA-LENGTH)                    07024071
070250                    RESP  (PV-CICS-RESP)                          07025071
070260             END-EXEC                                             07026071
070270              PERFORM 9900-SOFT-ABORT                             07027071
070280         WHEN SQLWARN0 NOT = SPACES                               07028071
070290         WHEN SQLCODE NOT EQUAL ZERO                              07029071
070300              MOVE '3321-CHECK-P2L-LIMIT      '                   07030071
070310                                   TO DP013-PARAGRAPH             07031071
070320              MOVE 'CHECK P2L CARTON LIMIT '                      07032071
070330                                   TO DP013-MESSAGE-TEXT (1)      07033071
070340              MOVE SQLCA           TO DP013-SQLCA                 07034071
070350              MOVE 'TKRPRPM'       TO DP013-DB2-TABLE-NAME (2)    07035071
070360              SET DP013-DB2-ABEND  TO TRUE                        07036071
070370              PERFORM DP013-0000-PROCESS-ABEND                    07037071
070380     END-EVALUATE.                                                07038071
070390                                                                  07039071
070400                                                                  07040071
070410*----------------------------------------------------------------*07041071
070420* GET P2L SYSTEM VENDOR FOR INITIAL BUILD                        *07042071
070430*----------------------------------------------------------------*07043071
070440 3325-GET-P2L-SFWR-VNDR.                                          07044071
070450     MOVE  ASC-OPER-UNT-ID  TO  DK-OPER-UNT-ID-4.                 07045071
070460     MOVE  ASC-MODULE (ASC-BLK-SUB ASC-ITEM-SUB)                  07046071
070470                            TO  DK-P2L-MOD.                       07047071
070480                                                                  07048071
070490     EXEC SQL                                                     07049071
070500         SELECT OPER_UNT_ID                                       07050071
070510               ,DIVERT_CDE                                        07051071
070520               ,SRVR_IP_ADDR                                      07052071
070530               ,P2L_SFWR_VND_ID                                   07053071
070540               ,P2L_SFWR_VC_NBR                                   07054071
070550           INTO :P2LMOD-OPER-UNT-ID                               07055071
070560               ,:P2LMOD-DIVERT-CDE                                07056071
070570               ,:P2LMOD-SRVR-IP-ADDR                              07057071
070580               ,:P2LMOD-P2L-SFWR-VND-ID                           07058071
070590               ,:P2LMOD-P2L-SFWR-VC-NBR                           07059071
070600           FROM TP2LMOD                                           07060071
070610          WHERE OPER_UNT_ID    = :DK-OPER-UNT-ID-4                07061071
070620            AND MODU_NBR       = :DK-P2L-MOD                      07062071
070630     END-EXEC                                                     07063071
070640                                                                  07064071
070650     EVALUATE TRUE                                                07065071
070660         WHEN SQLCODE = +0                                        07066071
070670             MOVE P2LMOD-P2L-SFWR-VND-ID                          07067071
070680                                     TO  ASC-P2L-VENDOR           07068071
070690                                      (ASC-BLK-SUB ASC-ITEM-SUB)  07069071
070700                                                                  07070071
070710             IF  P2LMOD-P2L-SFWR-VND-ID = 'DNP'                   07071071
070720                 IF  P2LMOD-P2L-SFWR-VC-NBR > 0                   07072071
070730                     SET ASC-P2L-ALS-4-DIGIT-STR                  07073071
070740                         (ASC-BLK-SUB ASC-ITEM-SUB)               07074071
070750                     TO TRUE                                      07075071
070760                 ELSE                                             07076071
070770                     SET ASC-P2L-ALS-3-DIGIT-STR                  07077071
070780                         (ASC-BLK-SUB ASC-ITEM-SUB)               07078071
070790                     TO TRUE                                      07079071
070800                 END-IF                                           07080071
070810             ELSE                                                 07081071
070820                 MOVE SPACE TO ASC-P2L-ALS-VC-SW                  07082071
070830                         (ASC-BLK-SUB ASC-ITEM-SUB)               07083071
070840             END-IF                                               07084071
070850                                                                  07085071
070860         WHEN SQLCODE = +100                                      07086071
070870             SET  ASC-P2L-DYNAPACK (ASC-BLK-SUB ASC-ITEM-SUB)     07087071
070880                                     TO TRUE                      07088071
070890                                                                  07089071
070900         WHEN SQLCODE = -904                                      07090071
070910         WHEN SQLCODE = -911                                      07091071
070920         WHEN SQLCODE = -913                                      07092071
070930                                                                  07093071
070940             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    07094071
070950             MOVE '3325-GET-P2L-SFWR-VNDR'  TO PV-SOFT-PARAGRAPH  07095071
070960             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  07096071
070970             MOVE LENGTH OF PV-CICS-MSG-AREA2                     07097071
070980               TO PV-COMMAREA-LENGTH                              07098071
070990             EXEC CICS                                            07099071
071000                  WRITEQ TD                                       07100071
071010                   QUEUE  ('CSSL')                                07101071
071020                    FROM  (PV-CICS-MSG-AREA2)                     07102071
071030                  LENGTH  (PV-COMMAREA-LENGTH)                    07103071
071040                    RESP  (PV-CICS-RESP)                          07104071
071050             END-EXEC                                             07105071
071060                                                                  07106071
071070             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          07107071
071080             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              07108071
071090             PERFORM 9900-SOFT-ABORT                              07109071
071100         WHEN OTHER                                               07110071
071110              MOVE '3325-GET-P2L-SFWR-VNDR'                       07111071
071120                               TO DP013-PARAGRAPH                 07112071
071130              MOVE 'INITIAL BUILD           '                     07113071
071140                               TO DP013-MESSAGE-TEXT (1)          07114071
071150              MOVE SQLCA       TO DP013-SQLCA                     07115071
071160              MOVE 'TP2LMOD '  TO DP013-DB2-TABLE-NAME (1)        07116071
071170              SET DP013-DB2-ABEND                                 07117071
071180                  DP013-XCTL-DISPLAY-RESTART                      07118071
071190                                   TO TRUE                        07119071
071200                  PERFORM DP013-0000-PROCESS-ABEND                07120071
071210     END-EVALUATE.                                                07121071
071220                                                                  07122071
071230                                                                  07123071
071240*-----------------------------------------------------------------07124071
071250* LABEL OPTION REQUIRED FIELDS:                                  *07125071
071260*      B - P2L & CASEPACK                                        *07126071
071270*          MODULE, CARTON COUNT, INNER PACK, OUTER PACK          *07127071
071280*      P - P2L ONLY                                              *07128071
071290*          MODULE, CARTON COUNT, INNER PACK                      *07129071
071300*      C - CASEPACK ONLY                                         *07130071
071310*          MODULE, CARTON COUNT, INNER PACK, OUTER PACK          *07131071
071320*-----------------------------------------------------------------07132071
071330 3330-CHECK-LBL-CREATE-FLDS.                                      07133071
071340     IF  ASC-LNE-CRE-BOTH-LBL (ASC-BLK-SUB ASC-ITEM-SUB)          07134071
071350         IF  ASC-MODULE-X (ASC-BLK-SUB ASC-ITEM-SUB)              07135071
071360                                        =  SPACE      OR          07136071
071370             ASC-MODULE-X (ASC-BLK-SUB ASC-ITEM-SUB)              07137071
071380                                        =  ZEROES     OR          07138071
071390             ASC-MODULE-X (ASC-BLK-SUB ASC-ITEM-SUB)              07139071
071400                                        =  LOW-VALUES             07140071
071410                 IF  ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)   07141071
071420                     MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER   07142071
071430                     SET DP020-MSG-FATAL    TO TRUE               07143071
071440                     MOVE -1                TO MR-MODL(PV-SUB)    07144071
071450                     SET DP030-SET-CURSOR-APPL-1                  07145071
071460                                            TO TRUE               07146071
071470                     MOVE DP015-RED     TO MR-MODC (PV-SUB)       07147071
071480                     MOVE DP015-REVERSE TO MR-MODH (PV-SUB)       07148071
071490                     SET PS-ERROR                                 07149071
071500                         PS-BLOCK-ERROR  TO  TRUE                 07150071
071510                 END-IF                                           07151071
071520         ELSE                                                     07152071
071530             PERFORM 3332-CHECK-MOD-NUMERIC                       07153071
071540         END-IF                                                   07154071
071550         IF  ASC-CARTON-COUNT-X (ASC-BLK-SUB ASC-ITEM-SUB)        07155071
071560                                        =  SPACE      OR          07156071
071570             ASC-CARTON-COUNT-X (ASC-BLK-SUB ASC-ITEM-SUB)        07157071
071580                                        =  ZEROES     OR          07158071
071590             ASC-CARTON-COUNT-X (ASC-BLK-SUB ASC-ITEM-SUB)        07159071
071600                                        =  LOW-VALUES             07160071
071610                 IF  ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)   07161071
071620                     MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER   07162071
071630                     SET DP020-MSG-FATAL    TO TRUE               07163071
071640                     MOVE -1            TO MR-CARTON-CNTL(PV-SUB) 07164071
071650                     SET DP030-SET-CURSOR-APPL-1                  07165071
071660                                        TO TRUE                   07166071
071670                     MOVE DP015-RED    TO MR-CARTON-CNTC (PV-SUB) 07167071
071680                     MOVE DP015-REVERSE TO MR-CARTON-CNTH(PV-SUB) 07168071
071690                     SET PS-ERROR                                 07169071
071700                         PS-BLOCK-ERROR  TO  TRUE                 07170071
071710                END-IF                                            07171071
071720         ELSE                                                     07172071
071730             PERFORM 3334-CHECK-CART-CNT-NUMERIC                  07173071
071740         END-IF                                                   07174071
071750                                                                  07175071
071760         IF  ASC-PRE-PACK-ORDER                                   07176071
071770             CONTINUE                                             07177071
071780         ELSE                                                     07178071
071790             IF  ASC-INNER-PACK-QTY-X (ASC-BLK-SUB ASC-ITEM-SUB)  07179071
071800                                        =  SPACE      OR          07180071
071810                 ASC-INNER-PACK-QTY-X (ASC-BLK-SUB ASC-ITEM-SUB)  07181071
071820                                        =  ZEROES     OR          07182071
071830                 ASC-INNER-PACK-QTY-X (ASC-BLK-SUB ASC-ITEM-SUB)  07183071
071840                                        =  LOW-VALUES             07184071
071850                 IF  ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)   07185071
071860                     MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER   07186071
071870                     SET DP020-MSG-FATAL    TO TRUE               07187071
071880                     MOVE -1            TO MR-INNER-PACKL(PV-SUB) 07188071
071890                     SET DP030-SET-CURSOR-APPL-1                  07189071
071900                                        TO TRUE                   07190071
071910                     MOVE DP015-RED TO MR-INNER-PACKC (PV-SUB)    07191071
071920                     MOVE DP015-REVERSE TO MR-INNER-PACKH(PV-SUB) 07192071
071930                     SET PS-ERROR                                 07193071
071940                         PS-BLOCK-ERROR  TO  TRUE                 07194071
071950                 END-IF                                           07195071
071960             ELSE                                                 07196071
071970                 PERFORM 3336-CHECK-IN-PACK-NUMERIC               07197071
071980             END-IF                                               07198071
071990         END-IF                                                   07199071
072000                                                                  07200071
072010         IF  ASC-OUTER-PACK-QTY-X (ASC-BLK-SUB ASC-ITEM-SUB)      07201071
072020                                        =  SPACE      OR          07202071
072030             ASC-OUTER-PACK-QTY-X (ASC-BLK-SUB ASC-ITEM-SUB)      07203071
072040                                        =  ZEROES     OR          07204071
072050             ASC-OUTER-PACK-QTY-X (ASC-BLK-SUB ASC-ITEM-SUB)      07205071
072060                                        =  LOW-VALUES             07206071
072070                 IF  ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)   07207071
072080                     MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER   07208071
072090                     SET DP020-MSG-FATAL    TO TRUE               07209071
072100                     MOVE -1            TO MR-OUTER-PACKL(PV-SUB) 07210071
072110                     SET DP030-SET-CURSOR-APPL-1                  07211071
072120                                            TO TRUE               07212071
072130                     MOVE DP015-RED TO MR-OUTER-PACKC (PV-SUB)    07213071
072140                     MOVE DP015-REVERSE TO MR-OUTER-PACKH(PV-SUB) 07214071
072150                     SET PS-ERROR                                 07215071
072160                         PS-BLOCK-ERROR  TO  TRUE                 07216071
072170                END-IF                                            07217071
072180         ELSE                                                     07218071
072190             PERFORM 3338-CHECK-OUT-PACK-NUMERIC                  07219071
072200             IF  ASC-PRE-PACK-ORDER  AND                          07220071
072210                 PS-NO-ERROR                                      07221071
072220                 PERFORM 3337-CHECK-OUTER-MULT-RATIO              07222071
072230             END-IF                                               07223071
072240         END-IF                                                   07224071
072250     END-IF.                                                      07225071
072260                                                                  07226071
072270     IF  ASC-LNE-CRE-P2L-LBL (ASC-BLK-SUB ASC-ITEM-SUB)           07227071
072280         IF  ASC-MODULE-X (ASC-BLK-SUB ASC-ITEM-SUB)              07228071
072290                                        =  SPACE      OR          07229071
072300             ASC-MODULE-X (ASC-BLK-SUB ASC-ITEM-SUB)              07230071
072310                                        =  ZEROES     OR          07231071
072320             ASC-MODULE-X (ASC-BLK-SUB ASC-ITEM-SUB)              07232071
072330                                        =  LOW-VALUES             07233071
072340                 IF  ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)   07234071
072350                     MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER   07235071
072360                     SET DP020-MSG-FATAL    TO TRUE               07236071
072370                     MOVE -1                TO MR-MODL(PV-SUB)    07237071
072380                     SET DP030-SET-CURSOR-APPL-1                  07238071
072390                                        TO TRUE                   07239071
072400                     MOVE DP015-RED     TO MR-MODC (PV-SUB)       07240071
072410                     MOVE DP015-REVERSE TO MR-MODH (PV-SUB)       07241071
072420                     SET PS-ERROR                                 07242071
072430                         PS-BLOCK-ERROR  TO  TRUE                 07243071
072440                 END-IF                                           07244071
072450         ELSE                                                     07245071
072460             PERFORM 3332-CHECK-MOD-NUMERIC                       07246071
072470         END-IF                                                   07247071
072480         IF  ASC-CARTON-COUNT-X (ASC-BLK-SUB ASC-ITEM-SUB)        07248071
072490                                        =  SPACE      OR          07249071
072500             ASC-CARTON-COUNT-X (ASC-BLK-SUB ASC-ITEM-SUB)        07250071
072510                                        =  ZEROES     OR          07251071
072520             ASC-CARTON-COUNT-X (ASC-BLK-SUB ASC-ITEM-SUB)        07252071
072530                                        =  LOW-VALUES             07253071
072540                 IF  ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)   07254071
072550                     MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER   07255071
072560                     SET DP020-MSG-FATAL    TO TRUE               07256071
072570                     MOVE -1            TO MR-CARTON-CNTL(PV-SUB) 07257071
072580                     SET DP030-SET-CURSOR-APPL-1                  07258071
072590                                        TO TRUE                   07259071
072600                     MOVE DP015-RED     TO MR-CARTON-CNTC(PV-SUB) 07260071
072610                     MOVE DP015-REVERSE TO MR-CARTON-CNTH(PV-SUB) 07261071
072620                     SET PS-ERROR                                 07262071
072630                         PS-BLOCK-ERROR  TO  TRUE                 07263071
072640                 END-IF                                           07264071
072650         ELSE                                                     07265071
072660             PERFORM 3334-CHECK-CART-CNT-NUMERIC                  07266071
072670         END-IF                                                   07267071
072680                                                                  07268071
072690         IF  ASC-PRE-PACK-ORDER                                   07269071
072700             IF  ASC-OUTER-PACK-QTY-X (ASC-BLK-SUB ASC-ITEM-SUB)  07270071
072710                                        =  SPACE      OR          07271071
072720                 ASC-OUTER-PACK-QTY-X (ASC-BLK-SUB ASC-ITEM-SUB)  07272071
072730                                        =  ZEROES     OR          07273071
072740                 ASC-OUTER-PACK-QTY-X (ASC-BLK-SUB ASC-ITEM-SUB)  07274071
072750                                        =  LOW-VALUES             07275071
072760                 IF  ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)   07276071
072770                     MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER   07277071
072780                     SET DP020-MSG-FATAL    TO TRUE               07278071
072790                     MOVE -1            TO MR-OUTER-PACKL(PV-SUB) 07279071
072800                     SET DP030-SET-CURSOR-APPL-1                  07280071
072810                                            TO TRUE               07281071
072820                     MOVE DP015-RED TO MR-OUTER-PACKC (PV-SUB)    07282071
072830                     MOVE DP015-REVERSE TO MR-OUTER-PACKH(PV-SUB) 07283071
072840                     SET PS-ERROR                                 07284071
072850                         PS-BLOCK-ERROR  TO  TRUE                 07285071
072860                 END-IF                                           07286071
072870             ELSE                                                 07287071
072880                 PERFORM 3338-CHECK-OUT-PACK-NUMERIC              07288071
072890                 IF  PS-NO-ERROR                                  07289071
072900                     PERFORM 3337-CHECK-OUTER-MULT-RATIO          07290071
072910                 END-IF                                           07291071
072920             END-IF                                               07292071
072930         ELSE                                                     07293071
072940             IF  ASC-INNER-PACK-QTY-X (ASC-BLK-SUB ASC-ITEM-SUB)  07294071
072950                                        =  SPACE      OR          07295071
072960                 ASC-INNER-PACK-QTY-X (ASC-BLK-SUB ASC-ITEM-SUB)  07296071
072970                                        =  ZEROES     OR          07297071
072980                 ASC-INNER-PACK-QTY-X (ASC-BLK-SUB ASC-ITEM-SUB)  07298071
072990                                        =  LOW-VALUES             07299071
073000                 IF  ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)   07300071
073010                     MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER   07301071
073020                     SET DP020-MSG-FATAL    TO TRUE               07302071
073030                     MOVE -1            TO MR-INNER-PACKL(PV-SUB) 07303071
073040                     SET DP030-SET-CURSOR-APPL-1                  07304071
073050                                        TO TRUE                   07305071
073060                     MOVE DP015-RED     TO MR-INNER-PACKC(PV-SUB) 07306071
073070                     MOVE DP015-REVERSE TO MR-INNER-PACKH(PV-SUB) 07307071
073080                     SET PS-ERROR                                 07308071
073090                         PS-BLOCK-ERROR  TO  TRUE                 07309071
073100                 END-IF                                           07310071
073110             ELSE                                                 07311071
073120                 PERFORM 3336-CHECK-IN-PACK-NUMERIC               07312071
073130             END-IF                                               07313071
073140         END-IF                                                   07314071
073150     END-IF.                                                      07315071
073160                                                                  07316071
073170     IF  ASC-CRE-SML-LBL                                          07317071
073180         IF  ASC-CARTON-COUNT-X (ASC-BLK-SUB ASC-ITEM-SUB)        07318071
073190                                        =  SPACE      OR          07319071
073200             ASC-CARTON-COUNT-X (ASC-BLK-SUB ASC-ITEM-SUB)        07320071
073210                                        =  ZEROES     OR          07321071
073220             ASC-CARTON-COUNT-X (ASC-BLK-SUB ASC-ITEM-SUB)        07322071
073230                                        =  LOW-VALUES             07323071
073240                 IF  ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)   07324071
073250                     MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER   07325071
073260                     SET DP020-MSG-FATAL    TO TRUE               07326071
073270                     MOVE -1            TO MR-CARTON-CNTL(PV-SUB) 07327071
073280                     SET DP030-SET-CURSOR-APPL-1                  07328071
073290                                        TO TRUE                   07329071
073300                     MOVE DP015-RED     TO MR-CARTON-CNTC(PV-SUB) 07330071
073310                     MOVE DP015-REVERSE TO MR-CARTON-CNTH(PV-SUB) 07331071
073320                     SET PS-ERROR                                 07332071
073330                         PS-BLOCK-ERROR  TO  TRUE                 07333071
073340                 END-IF                                           07334071
073350         ELSE                                                     07335071
073360             PERFORM 3334-CHECK-CART-CNT-NUMERIC                  07336071
073370         END-IF                                                   07337071
073380                                                                  07338071
073390         IF  ASC-PRE-PACK-ORDER                                   07339071
073400             CONTINUE                                             07340071
073410         ELSE                                                     07341071
073420             IF  ASC-INNER-PACK-QTY-X (ASC-BLK-SUB ASC-ITEM-SUB)  07342071
073430                                        =  SPACE      OR          07343071
073440                 ASC-INNER-PACK-QTY-X (ASC-BLK-SUB ASC-ITEM-SUB)  07344071
073450                                        =  ZEROES     OR          07345071
073460                 ASC-INNER-PACK-QTY-X (ASC-BLK-SUB ASC-ITEM-SUB)  07346071
073470                                        =  LOW-VALUES             07347071
073480                 IF  ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)   07348071
073490                     MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER   07349071
073500                     SET DP020-MSG-FATAL    TO TRUE               07350071
073510                     MOVE -1            TO MR-INNER-PACKL(PV-SUB) 07351071
073520                     SET DP030-SET-CURSOR-APPL-1                  07352071
073530                                        TO TRUE                   07353071
073540                     MOVE DP015-RED     TO MR-INNER-PACKC(PV-SUB) 07354071
073550                     MOVE DP015-REVERSE TO MR-INNER-PACKH(PV-SUB) 07355071
073560                     SET PS-ERROR                                 07356071
073570                         PS-BLOCK-ERROR  TO  TRUE                 07357071
073580                 END-IF                                           07358071
073590             ELSE                                                 07359071
073600                 PERFORM 3336-CHECK-IN-PACK-NUMERIC               07360071
073610             END-IF                                               07361071
073620         END-IF                                                   07362071
073630                                                                  07363071
073640         IF  ASC-OUTER-PACK-QTY-X (ASC-BLK-SUB ASC-ITEM-SUB)      07364071
073650                                        =  SPACE      OR          07365071
073660             ASC-OUTER-PACK-QTY-X (ASC-BLK-SUB ASC-ITEM-SUB)      07366071
073670                                        =  ZEROES     OR          07367071
073680             ASC-OUTER-PACK-QTY-X (ASC-BLK-SUB ASC-ITEM-SUB)      07368071
073690                                        =  LOW-VALUES             07369071
073700                 IF  ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)   07370071
073710                     MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER   07371071
073720                     SET DP020-MSG-FATAL    TO TRUE               07372071
073730                     MOVE -1            TO MR-OUTER-PACKL(PV-SUB) 07373071
073740                     SET DP030-SET-CURSOR-APPL-1                  07374071
073750                                        TO TRUE                   07375071
073760                     MOVE DP015-RED     TO MR-OUTER-PACKC(PV-SUB) 07376071
073770                     MOVE DP015-REVERSE TO MR-OUTER-PACKH(PV-SUB) 07377071
073780                     SET PS-ERROR                                 07378071
073790                         PS-BLOCK-ERROR  TO  TRUE                 07379071
073800                 END-IF                                           07380071
073810         ELSE                                                     07381071
073820             PERFORM 3338-CHECK-OUT-PACK-NUMERIC                  07382071
073830             IF  ASC-PRE-PACK-ORDER  AND                          07383071
073840                 PS-NO-ERROR                                      07384071
073850                 PERFORM 3337-CHECK-OUTER-MULT-RATIO              07385071
073860             END-IF                                               07386071
073870         END-IF                                                   07387071
073880     END-IF.                                                      07388071
073890                                                                  07389071
073900     IF  ASC-LNE-CRE-SML-LBL (ASC-BLK-SUB ASC-ITEM-SUB)           07390071
073910         IF  ASC-P2L-LABEL-CNT (ASC-BLK-SUB ASC-ITEM-SUB)         07391071
073920                                        >  ZEROES                 07392071
073930             IF  ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       07393071
073940                 MOVE PC-TSYMSG-02520  TO DP020-MSG-NUMBER        07394071
073950                 SET DP020-MSG-FATAL   TO TRUE                    07395071
073960                 MOVE -1               TO MR-CRE-LBL-OPTL(PV-SUB) 07396071
073970                 SET DP030-SET-CURSOR-APPL-1                      07397071
073980                                       TO TRUE                    07398071
073990                 MOVE DP015-RED        TO MR-CRE-LBL-OPTC(PV-SUB) 07399071
074000                 MOVE DP015-REVERSE    TO MR-CRE-LBL-OPTH(PV-SUB) 07400071
074010                 SET PS-ERROR                                     07401071
074020                     PS-BLOCK-ERROR    TO TRUE                    07402071
074030             END-IF                                               07403071
074040         END-IF                                                   07404071
074050     END-IF.                                                      07405071
074060                                                                  07406071
074070                                                                  07407071
074080*-----------------------------------------------------------------07408071
074090*   CHECK MODULE NUMBER FOR NUMERIC                               07409071
074100*-----------------------------------------------------------------07410071
074110 3332-CHECK-MOD-NUMERIC.                                          07411071
074120     IF  ASC-MODULE-X (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES         07412071
074130         MOVE ASC-MODULE-X (ASC-BLK-SUB ASC-ITEM-SUB) TO          07413071
074140                                    DP010I-UNEDITED-FIELD         07414071
074150         MOVE LENGTH OF ASC-MODULE                                07415071
074160                                 TO DP010I-MAXIMUM-DIGITS         07416071
074170         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       07417071
074180         SET DP010I-NEGATIVE-NOT-ALLOWED                          07418071
074190                                 TO TRUE                          07419071
074200             CALL DP010I-NUMERIC-EDIT-ROUTINE                     07420071
074210                         USING DP010I-NUMERIC-EDIT-AREA           07421071
074220             IF  DP010I-ERROR-DETECTED                            07422071
074230                 SET PS-ERROR                                     07423071
074240                     DP020-MSG-FATAL                              07424071
074250                     PS-BLOCK-ERROR  TO  TRUE                     07425071
074260                 MOVE PC-TSYMSG-00008                             07426071
074270                                     TO DP020-MSG-NUMBER          07427071
074280                 MOVE DP015-UNP-ALP-BRT-OFF                       07428071
074290                                     TO MR-MODA (PV-SUB)          07429071
074300                 MOVE DP015-RED      TO MR-MODC (PV-SUB)          07430071
074310                 MOVE DP015-REVERSE  TO MR-MODH (PV-SUB)          07431071
074320                 MOVE -1             TO MR-MODL (PV-SUB)          07432071
074330                 SET DP030-SET-CURSOR-APPL-1                      07433071
074340                                     TO TRUE                      07434071
074350             ELSE                                                 07435071
074360                 MOVE DP010I-NUMERIC-FIELD                        07436071
074370                                     TO ASC-MODULE                07437071
074380                                       (ASC-BLK-SUB ASC-ITEM-SUB) 07438071
074390                                        MR-MOD (PV-SUB)           07439071
074400             END-IF                                               07440071
074410     END-IF.                                                      07441071
074420                                                                  07442071
074430                                                                  07443071
074440*-----------------------------------------------------------------07444071
074450*   CHECK MODULE NUMBER FOR NUMERIC                               07445071
074460*-----------------------------------------------------------------07446071
074470 3333-CHECK-MOD-NUMERIC-ASC.                                      07447071
074480      MOVE AP2LMODI  TO DP010I-UNEDITED-FIELD                     07448071
074490                                 DP010I-UNEDITED-FIELD            07449071
074500      MOVE LENGTH OF AP2LMODI                                     07450071
074510                              TO DP010I-MAXIMUM-DIGITS            07451071
074520      MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS          07452071
074530      SET DP010I-NEGATIVE-NOT-ALLOWED                             07453071
074540                              TO TRUE                             07454071
074550         CALL DP010I-NUMERIC-EDIT-ROUTINE                         07455071
074560                         USING DP010I-NUMERIC-EDIT-AREA           07456071
074570          IF  DP010I-ERROR-DETECTED                               07457071
074580              SET PS-ERROR                                        07458071
074590                  DP020-MSG-FATAL                                 07459071
074600                  PS-BLOCK-ERROR  TO  TRUE                        07460071
074610              MOVE PC-TSYMSG-00008                                07461071
074620                                  TO DP020-MSG-NUMBER             07462071
074630              MOVE DP015-UNP-ALP-BRT-OFF                          07463071
074640                                  TO AP2LMODA                     07464071
074650              MOVE DP015-RED      TO AP2LMODC                     07465071
074660              MOVE DP015-REVERSE  TO AP2LMODH                     07466071
074670              MOVE -1             TO AP2LMODL                     07467071
074680              SET DP030-SET-CURSOR-APPL-1                         07468071
074690                                  TO TRUE                         07469071
074700          ELSE                                                    07470071
074710              MOVE DP010I-NUMERIC-FIELD                           07471071
074720                                  TO ASC-MODU-NBR                 07472071
074730          END-IF.                                                 07473071
074740                                                                  07474071
074750                                                                  07475071
074760*-----------------------------------------------------------------07476071
074770*   CHECK CARTON COUNT FOR NUMERIC                                07477071
074780*-----------------------------------------------------------------07478071
074790 3334-CHECK-CART-CNT-NUMERIC.                                     07479071
074800     IF ASC-CARTON-COUNT-X (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES    07480071
074810        MOVE ASC-CARTON-COUNT-X (ASC-BLK-SUB ASC-ITEM-SUB) TO     07481071
074820                                    DP010I-UNEDITED-FIELD         07482071
074830         MOVE LENGTH OF ASC-CARTON-COUNT                          07483071
074840                                 TO DP010I-MAXIMUM-DIGITS         07484071
074850         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       07485071
074860         SET DP010I-NEGATIVE-NOT-ALLOWED                          07486071
074870                                 TO TRUE                          07487071
074880             CALL DP010I-NUMERIC-EDIT-ROUTINE                     07488071
074890                         USING DP010I-NUMERIC-EDIT-AREA           07489071
074900             IF  DP010I-ERROR-DETECTED                            07490071
074910                 SET PS-ERROR                                     07491071
074920                     DP020-MSG-FATAL                              07492071
074930                     PS-BLOCK-ERROR  TO  TRUE                     07493071
074940                 MOVE PC-TSYMSG-00008                             07494071
074950                                     TO DP020-MSG-NUMBER          07495071
074960                 MOVE DP015-UNP-ALP-BRT-OFF                       07496071
074970                                     TO MR-CARTON-CNTA (PV-SUB)   07497071
074980                 MOVE DP015-RED      TO MR-CARTON-CNTC (PV-SUB)   07498071
074990                 MOVE DP015-REVERSE  TO MR-CARTON-CNTH (PV-SUB)   07499071
075000                 MOVE -1             TO MR-CARTON-CNTL (PV-SUB)   07500071
075010                 SET DP030-SET-CURSOR-APPL-1                      07501071
075020                                     TO TRUE                      07502071
075030             ELSE                                                 07503071
075040                 MOVE DP010I-NUMERIC-FIELD                        07504071
075050                                     TO ASC-CARTON-COUNT          07505071
075060                                       (ASC-BLK-SUB ASC-ITEM-SUB) 07506071
075070                                        MR-CARTON-CNT (PV-SUB)    07507071
075080             END-IF                                               07508071
075090     END-IF.                                                      07509071
075100                                                                  07510071
075110                                                                  07511071
075120*-----------------------------------------------------------------07512071
075130*   CHECK CARTON COUNT FOR NUMERIC                                07513071
075140*-----------------------------------------------------------------07514071
075150 3334A-CHECK-CART-CNT-NUMERIC.                                    07515071
075160         MOVE MCTNCNTI  TO DP010I-UNEDITED-FIELD                  07516071
075170                                    DP010I-UNEDITED-FIELD         07517071
075180         MOVE LENGTH OF MCTNCNTI                                  07518071
075190                                 TO DP010I-MAXIMUM-DIGITS         07519071
075200         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       07520071
075210         SET DP010I-NEGATIVE-NOT-ALLOWED                          07521071
075220                               TO TRUE                            07522071
075230             CALL DP010I-NUMERIC-EDIT-ROUTINE                     07523071
075240                         USING DP010I-NUMERIC-EDIT-AREA           07524071
075250             IF  DP010I-ERROR-DETECTED                            07525071
075260                 SET PS-ERROR                                     07526071
075270                     DP020-MSG-FATAL                              07527071
075280                     PS-BLOCK-ERROR  TO  TRUE                     07528071
075290                 MOVE PC-TSYMSG-00008                             07529071
075300                                     TO DP020-MSG-NUMBER          07530071
075310                 MOVE DP015-UNP-ALP-BRT-OFF                       07531071
075320                                     TO MR-CARTON-CNTA (PV-SUB)   07532071
075330                 MOVE DP015-RED      TO MR-CARTON-CNTC (PV-SUB)   07533071
075340                 MOVE DP015-REVERSE  TO MR-CARTON-CNTH (PV-SUB)   07534071
075350                 MOVE -1             TO MR-CARTON-CNTL (PV-SUB)   07535071
075360                 SET DP030-SET-CURSOR-APPL-1                      07536071
075370                                     TO TRUE                      07537071
075380             ELSE                                                 07538071
075390                 MOVE DP010I-NUMERIC-FIELD                        07539071
075400                                     TO ASC-CART-CNT              07540071
075410             END-IF.                                              07541071
075420                                                                  07542071
075430                                                                  07543071
075440*----------------------------------------------------------------*07544071
075450*   CHECK ODD CARTON QUANTITY IS MULTIPLE OF PREPACK RATIO       *07545071
075460*----------------------------------------------------------------*07546071
075470 3335-CHECK-ODD-MULT-RATIO.                                       07547071
075480     DIVIDE  ASC-ODD-CARTON (ASC-BLK-SUB ASC-ITEM-SUB)            07548071
075490         BY  ASC-PREPK-RATIO (ASC-BLK-SUB ASC-ITEM-SUB)           07549071
075500     GIVING  PV-ODD-CRTN-RATIO-QTY                                07550071
075510     REMAINDER PV-ODD-CRTN-RATIO-REMAIN.                          07551071
075520                                                                  07552071
075530     IF  PV-ODD-CRTN-RATIO-REMAIN  >  0                           07553071
075540         SET PS-ERROR                                             07554071
075550             DP020-MSG-FATAL                                      07555071
075560             PS-BLOCK-ERROR          TO  TRUE                     07556071
075570         MOVE PC-TSYMSG-02446        TO DP020-MSG-NUMBER          07557071
075580         MOVE DP015-UNP-ALP-BRT-OFF  TO MR-ODD-CARTONA (PV-SUB)   07558071
075590         MOVE DP015-RED              TO MR-ODD-CARTONC (PV-SUB)   07559071
075600         MOVE DP015-REVERSE          TO MR-ODD-CARTONH (PV-SUB)   07560071
075610         MOVE -1                     TO MR-ODD-CARTONL (PV-SUB)   07561071
075620         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      07562071
075630     END-IF.                                                      07563071
075640                                                                  07564071
075650                                                                  07565071
075660*-----------------------------------------------------------------07566071
075670*   CHECK INNER PACK QUANTITY FOR NUMERIC                         07567071
075680*-----------------------------------------------------------------07568071
075690 3336-CHECK-IN-PACK-NUMERIC.                                      07569071
075700     IF  ASC-INNER-PACK-QTY-X                                     07570071
075710        (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES                       07571071
075720         MOVE ASC-INNER-PACK-QTY-X(ASC-BLK-SUB ASC-ITEM-SUB)      07572071
075730           TO  DP010I-UNEDITED-FIELD                              07573071
075740         MOVE LENGTH OF ASC-INNER-PACK-QTY                        07574071
075750                                 TO DP010I-MAXIMUM-DIGITS         07575071
075760         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       07576071
075770         SET DP010I-NEGATIVE-NOT-ALLOWED                          07577071
075780                                 TO TRUE                          07578071
075790         CALL DP010I-NUMERIC-EDIT-ROUTINE                         07579071
075800                         USING DP010I-NUMERIC-EDIT-AREA           07580071
075810         IF  PS-NO-ERROR                                          07581071
075820             IF  DP010I-ERROR-DETECTED                            07582071
075830                 SET PS-ERROR                                     07583071
075840                     DP020-MSG-FATAL                              07584071
075850                     PS-BLOCK-ERROR  TO  TRUE                     07585071
075860                 MOVE PC-TSYMSG-00008                             07586071
075870                                     TO DP020-MSG-NUMBER          07587071
075880                 MOVE DP015-UNP-ALP-BRT-OFF                       07588071
075890                                     TO MR-INNER-PACKA (PV-SUB)   07589071
075900                 MOVE DP015-RED      TO MR-INNER-PACKC (PV-SUB)   07590071
075910                 MOVE DP015-REVERSE  TO MR-INNER-PACKH (PV-SUB)   07591071
075920                 MOVE -1             TO MR-INNER-PACKL (PV-SUB)   07592071
075930                 SET DP030-SET-CURSOR-APPL-1                      07593071
075940                                     TO TRUE                      07594071
075950             ELSE                                                 07595071
075960                 MOVE DP010I-NUMERIC-FIELD                        07596071
075970                                     TO ASC-INNER-PACK-QTY        07597071
075980                                       (ASC-BLK-SUB ASC-ITEM-SUB) 07598071
075990                                        MR-INNER-PACK (PV-SUB)    07599071
076000             END-IF                                               07600071
076010         END-IF                                                   07601071
076020     END-IF.                                                      07602071
076030                                                                  07603071
076040                                                                  07604071
076050*----------------------------------------------------------------*07605071
076060*   CHECK OUTER PACK QUANTITY IS MULTIPLE OF PREPACK RATIO       *07606071
076070*----------------------------------------------------------------*07607071
076080 3337-CHECK-OUTER-MULT-RATIO.                                     07608071
076090                                                                  07609071
076100     IF  ASC-MLT-OTPK-UCC128 (ASC-BLK-SUB ASC-ITEM-SUB)           07610071
076110         CONTINUE                                                 07611071
076120     ELSE                                                         07612071
076130     IF  ASC-OUTER-PACK-QTY-X                                     07613071
076140        (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES                       07614071
076150         DIVIDE  ASC-OUTER-PACK-QTY (ASC-BLK-SUB ASC-ITEM-SUB)    07615071
076160             BY  ASC-PREPK-RATIO    (ASC-BLK-SUB ASC-ITEM-SUB)    07616071
076170         GIVING  PV-OUTER-RATIO-QTY                               07617071
076180         REMAINDER PV-OUTER-RATIO-REMAIN                          07618071
076190                                                                  07619071
076200         IF  PV-OUTER-RATIO-REMAIN  >  0                          07620071
076210             SET PS-ERROR                                         07621071
076220                 DP020-MSG-FATAL                                  07622071
076230                 PS-BLOCK-ERROR      TO  TRUE                     07623071
076240             MOVE PC-TSYMSG-02445    TO DP020-MSG-NUMBER          07624071
076250             MOVE DP015-UNP-ALP-BRT-OFF                           07625071
076260                                     TO MR-OUTER-PACKA (PV-SUB)   07626071
076270             MOVE DP015-RED          TO MR-OUTER-PACKC (PV-SUB)   07627071
076280             MOVE DP015-REVERSE      TO MR-OUTER-PACKH (PV-SUB)   07628071
076290             MOVE -1                 TO MR-OUTER-PACKL (PV-SUB)   07629071
076300             SET DP030-SET-CURSOR-APPL-1                          07630071
076310                                     TO TRUE                      07631071
076320         END-IF                                                   07632071
076330     END-IF                                                       07633071
076340     END-IF.                                                      07634071
076350                                                                  07635071
076360                                                                  07636071
076370*-----------------------------------------------------------------07637071
076380*   CHECK OUTER PACK QUANTITY FOR NUMERIC                         07638071
076390*-----------------------------------------------------------------07639071
076400 3338-CHECK-OUT-PACK-NUMERIC.                                     07640071
076410     IF  ASC-MLT-OTPK-UCC128 (ASC-BLK-SUB ASC-ITEM-SUB) AND       07641071
076420         ASC-LNE-UCC128-YES  (ASC-BLK-SUB ASC-ITEM-SUB)           07642071
076430         MOVE ASC-OUTER-PACK-QTY-X (ASC-BLK-SUB ASC-ITEM-SUB)     07643071
076440                             TO  MR-OUTER-PACK (PV-SUB)           07644071
076450     ELSE                                                         07645071
076460     IF  ASC-OUTER-PACK-QTY-X                                     07646071
076470        (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES                       07647071
076480         MOVE ASC-OUTER-PACK-QTY-X (ASC-BLK-SUB ASC-ITEM-SUB)     07648071
076490                                 TO DP010I-UNEDITED-FIELD         07649071
076500         MOVE LENGTH OF ASC-OUTER-PACK-QTY                        07650071
076510                                 TO DP010I-MAXIMUM-DIGITS         07651071
076520         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       07652071
076530         SET DP010I-NEGATIVE-NOT-ALLOWED                          07653071
076540                                 TO TRUE                          07654071
076550             CALL DP010I-NUMERIC-EDIT-ROUTINE                     07655071
076551                         USING DP010I-NUMERIC-EDIT-AREA           07655171
076552             IF  DP010I-ERROR-DETECTED                            07655271
076553                 SET PS-ERROR                                     07655371
076554                     DP020-MSG-FATAL                              07655471
076555                     PS-BLOCK-ERROR  TO  TRUE                     07655571
076556                 MOVE PC-TSYMSG-00008                             07655671
076557                                     TO DP020-MSG-NUMBER          07655771
076558                 MOVE DP015-UNP-ALP-BRT-OFF                       07655871
076559                                     TO MR-OUTER-PACKA (PV-SUB)   07655971
076560                 MOVE DP015-RED      TO MR-OUTER-PACKC (PV-SUB)   07656071
076570                 MOVE DP015-REVERSE  TO MR-OUTER-PACKH (PV-SUB)   07657071
076580                 MOVE -1             TO MR-OUTER-PACKL (PV-SUB)   07658071
076590                 SET DP030-SET-CURSOR-APPL-1                      07659071
076600                                     TO TRUE                      07660071
076610             ELSE                                                 07661071
076620                 MOVE DP010I-NUMERIC-FIELD                        07662071
076630                                     TO ASC-OUTER-PACK-QTY        07663071
076640                                       (ASC-BLK-SUB ASC-ITEM-SUB) 07664071
076650                                        PV-ZERO-SUP-OTPK          07665071
076660                 MOVE PV-ZERO-SUP-OTPK                            07666071
076670                                     TO MR-OUTER-PACK (PV-SUB)    07667071
076680             END-IF                                               07668071
076690     END-IF                                                       07669071
076700     END-IF.                                                      07670071
076710                                                                  07671071
076720                                                                  07672071
076730*-----------------------------------------------------------------07673071
076740*   CHECK ODD CARTON QUANTITY FOR NUMERIC                         07674071
076750*-----------------------------------------------------------------07675071
076760 3339-CHECK-ODD-CART-NUMERIC.                                     07676071
076770     IF  ASC-ODD-CARTON-X                                         07677071
076780        (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES                       07678071
076790         MOVE ASC-ODD-CARTON-X (ASC-BLK-SUB ASC-ITEM-SUB)         07679071
076800                                 TO DP010I-UNEDITED-FIELD         07680071
076810         MOVE LENGTH OF ASC-ODD-CARTON (ASC-BLK-SUB ASC-ITEM-SUB) 07681071
076820                                 TO DP010I-MAXIMUM-DIGITS         07682071
076830         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       07683071
076840         SET DP010I-NEGATIVE-NOT-ALLOWED                          07684071
076850                                 TO TRUE                          07685071
076860             CALL DP010I-NUMERIC-EDIT-ROUTINE                     07686071
076870                         USING DP010I-NUMERIC-EDIT-AREA           07687071
076880             IF  DP010I-ERROR-DETECTED                            07688071
076890                 SET PS-ERROR                                     07689071
076900                     DP020-MSG-FATAL                              07690071
076910                     PS-BLOCK-ERROR  TO  TRUE                     07691071
076920                 MOVE PC-TSYMSG-00008                             07692071
076930                                     TO DP020-MSG-NUMBER          07693071
076940                 MOVE DP015-UNP-ALP-BRT-OFF                       07694071
076950                                     TO MR-ODD-CARTONA (PV-SUB)   07695071
076960                 MOVE DP015-RED      TO MR-ODD-CARTONC (PV-SUB)   07696071
076970                 MOVE DP015-REVERSE  TO MR-ODD-CARTONH (PV-SUB)   07697071
076980                 MOVE -1             TO MR-ODD-CARTONL (PV-SUB)   07698071
076990                 SET DP030-SET-CURSOR-APPL-1                      07699071
077000                                     TO TRUE                      07700071
077010             ELSE                                                 07701071
077020                 MOVE DP010I-NUMERIC-FIELD                        07702071
077030                                     TO ASC-ODD-CARTON            07703071
077040                                       (ASC-BLK-SUB ASC-ITEM-SUB) 07704071
077050                                        MR-ODD-CARTON (PV-SUB)    07705071
077060             END-IF                                               07706071
077070     END-IF.                                                      07707071
077080                                                                  07708071
077090     IF  PS-NO-ERROR                                              07709071
077100         IF ASC-ODD-CARTON                                        07710071
077110            (ASC-BLK-SUB ASC-ITEM-SUB) > ZEROES                   07711071
077120             IF  ASC-CARTON-COUNT                                 07712071
077130                 (ASC-BLK-SUB ASC-ITEM-SUB) > 1                   07713071
077140                 IF  ASC-PRE-PACK-ORDER                           07714071
077150                     PERFORM 3335-CHECK-ODD-MULT-RATIO            07715071
077160                 END-IF                                           07716071
077170              ELSE                                                07717071
077180                 SET PS-ERROR                                     07718071
077190                     DP020-MSG-FATAL                              07719071
077200                     PS-BLOCK-ERROR TO TRUE                       07720071
077210                 MOVE PC-TSYMSG-01999    TO DP020-MSG-NUMBER      07721071
077220                 MOVE DP015-UNP-ALP-BRT-OFF                       07722071
077230                                     TO MR-ODD-CARTONA (PV-SUB)   07723071
077240                 MOVE DP015-RED      TO MR-ODD-CARTONC (PV-SUB)   07724071
077250                 MOVE DP015-REVERSE  TO MR-ODD-CARTONH (PV-SUB)   07725071
077260                 MOVE -1             TO MR-ODD-CARTONL (PV-SUB)   07726071
077270                 SET DP030-SET-CURSOR-APPL-1                      07727071
077280                                     TO TRUE                      07728071
077290             END-IF                                               07729071
077300         ELSE                                                     07730071
077310         IF  ASC-ODD-CARTON                                       07731071
077320             (ASC-BLK-SUB ASC-ITEM-SUB) = ZEROES                  07732071
077330             SET  ASC-ODD-CRTN-NONE                               07733071
077340                 (ASC-BLK-SUB ASC-ITEM-SUB)                       07734071
077350                  ASC-BLOCK-MODIFIED (ASC-BLK-SUB)  TO  TRUE      07735071
077360         END-IF                                                   07736071
077370         END-IF                                                   07737071
077380     END-IF.                                                      07738071
077390                                                                  07739071
077400                                                                  07740071
077410*-----------------------------------------------------------------07741071
077420*                                                                 07742071
077430*-----------------------------------------------------------------07743071
077440 3340-CHECK-REST-OF-LINE.                                         07744071
077450      PERFORM 3332-CHECK-MOD-NUMERIC.                             07745071
077460      PERFORM 3339-CHECK-ODD-CART-NUMERIC.                        07746071
077470                                                                  07747071
077480*-----------------------------------------------------------------07748071
077490*     IS THIS A VALID MODULE FOR DC                               07749071
077500*-----------------------------------------------------------------07750071
077510     IF  PS-NO-ERROR                                              07751071
077520         IF  ASC-LNE-CRE-SML-LBL (ASC-BLK-SUB ASC-ITEM-SUB)  OR   07752071
077530             DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)          OR   07753071
077540             DP020-FK-LOCAL-FUNC-10 (DP020-SRC-AID)          OR   07754071
077550             DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)          OR   07755071
077560             DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)          OR   07756071
077570             DP020-FK-LOCAL-FUNC-09 (DP020-SRC-AID)          OR   07757071
077580             DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)          OR   07758071
077590             DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)               07759071
077600             CONTINUE                                             07760071
077610         ELSE                                                     07761071
077620         IF  ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)  AND      07762071
077630             ASC-MODULE-X (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES  AND07763071
077640             ASC-MODULE   (ASC-BLK-SUB ASC-ITEM-SUB) > ZEROES     07764071
077650             PERFORM 3320-VERIFY-MODULE-NBR                       07765071
077660         END-IF                                                   07766071
077670     END-IF.                                                      07767071
077680                                                                  07768071
077690*-----------------------------------------------------------------07769071
077700     IF  PS-NO-ERROR                                              07770071
077710          PERFORM 3334-CHECK-CART-CNT-NUMERIC                     07771071
077720     END-IF.                                                      07772071
077730     IF  PS-NO-ERROR                                              07773071
077740          PERFORM 3336-CHECK-IN-PACK-NUMERIC                      07774071
077750     END-IF.                                                      07775071
077760     IF  PS-NO-ERROR                                              07776071
077770         IF  DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)  or           07777071
077780            (DP020-FK-CONFIRM (DP020-SRC-AID) AND                 07778071
077790             ASC-CONFIRM-DELETE)                                  07779071
077800             CONTINUE                                             07780071
077810         ELSE                                                     07781071
077820             PERFORM 3338-CHECK-OUT-PACK-NUMERIC                  07782071
077830         END-IF                                                   07783071
077840     END-IF.                                                      07784071
077850                                                                  07785071
077860*-----------------------------------------------------------------07786071
077870*   IF CREATE LABEL OPTION = 'B' OR 'C' AND                       07787071
077880*      OUTER PACK > 1                   AND                       07788071
077881*      CARTON COUNT  =  0                                         07788171
077882*         CALCULATE NUMBER OF CARTONS.                            07788271
077883* NOTE - THIS WOULD OCCUR IF SCREEN ORIGINALLY P2L ONLY AND       07788371
077884*        LINE HAS BEEN CHANGED TO 'B' OR 'C'                      07788471
077885*-----------------------------------------------------------------07788571
077886                                                                  07788671
077887     IF  ASC-LNE-CRE-BOTH-LBL(ASC-BLK-SUB ASC-ITEM-SUB)  OR       07788771
077888         ASC-LNE-CRE-SML-LBL(ASC-BLK-SUB ASC-ITEM-SUB)            07788871
077889         IF  ASC-OUTER-PACK-QTY(ASC-BLK-SUB ASC-ITEM-SUB) > 1 AND 07788971
077890             ASC-CARTON-COUNT(ASC-BLK-SUB ASC-ITEM-SUB)  =  0     07789071
077900                 MOVE  ZEROES  TO  PV-CARTON-COUNT-CALC           07790071
077910                                   PV-CARTON-COUNT-REM            07791071
077920                 DIVIDE  ASC-TRANSCRIBE-QTY                       07792071
077930                         (ASC-BLK-SUB ASC-ITEM-SUB)               07793071
077940                     BY  ASC-OUTER-PACK-QTY                       07794071
077950                         (ASC-BLK-SUB ASC-ITEM-SUB)               07795071
077960                 GIVING  PV-CARTON-COUNT-CALC                     07796071
077970                 REMAINDER PV-CARTON-COUNT-REM                    07797071
077980                 END-DIVIDE                                       07798071
077990                                                                  07799071
078000             IF  PV-CARTON-COUNT-REM  >  +0                       07800071
078010                 CONTINUE                                         07801071
078020             ELSE                                                 07802071
078030                 MOVE PV-CARTON-COUNT-CALC                        07803071
078040                   TO ASC-CARTON-COUNT (ASC-BLK-SUB ASC-ITEM-SUB) 07804071
078050             END-IF                                               07805071
078060         END-IF                                                   07806071
078070     END-IF.                                                      07807071
078080                                                                  07808071
078090                                                                  07809071
078100*-----------------------------------------------------------------07810071
078110*   CALCULATE PROCESS QUANTITY                                    07811071
078120*-----------------------------------------------------------------07812071
078130     IF  ASC-LNE-UCC128-YES (ASC-BLK-SUB ASC-ITEM-SUB)            07813071
078140         CONTINUE                                                 07814071
078150     ELSE                                                         07815071
078160         MOVE  ZEROES            TO  PV-PROCESS-QTY               07816071
078170                                     ASC-PROCESS-QTY              07817071
078180                                    (ASC-BLK-SUB ASC-ITEM-SUB)    07818071
078190                                     MR-PROCESS-QTY (PV-SUB)      07819071
078200     END-IF.                                                      07820071
078210                                                                  07821071
078220     IF  ASC-LNE-UCC128-YES (ASC-BLK-SUB ASC-ITEM-SUB)            07822071
078230         CONTINUE                                                 07823071
078240     ELSE                                                         07824071
078250     IF  PS-NO-ERROR                                              07825071
078260         IF  ASC-CARTON-COUNT                                     07826071
078270             (ASC-BLK-SUB ASC-ITEM-SUB)  >  +0  AND               07827071
078280             ASC-OUTER-PACK-QTY                                   07828071
078290             (ASC-BLK-SUB ASC-ITEM-SUB)  >  +0                    07829071
078300             MULTIPLY  ASC-CARTON-COUNT                           07830071
078310                       (ASC-BLK-SUB ASC-ITEM-SUB)                 07831071
078320                   BY  ASC-OUTER-PACK-QTY                         07832071
078330                       (ASC-BLK-SUB ASC-ITEM-SUB)                 07833071
078340               GIVING  PV-PROCESS-QTY                             07834071
078350              MOVE  PV-PROCESS-QTY    TO  ASC-PROCESS-QTY         07835071
078360                                       (ASC-BLK-SUB ASC-ITEM-SUB) 07836071
078370                                          MR-PROCESS-QTY (PV-SUB) 07837071
078380              IF  ASC-LNE-CRE-P2L-LBL(ASC-BLK-SUB ASC-ITEM-SUB)   07838071
078390                  MOVE  ZEROS         TO  ASC-PROCESS-QTY         07839071
078400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 07840071
078410                                          MR-PROCESS-QTY (PV-SUB) 07841071
078420              END-IF                                              07842071
078430         END-IF                                                   07843071
078440     END-IF                                                       07844071
078450     END-IF.                                                      07845071
078460                                                                  07846071
078470     IF  ASC-LNE-UCC128-YES (ASC-BLK-SUB ASC-ITEM-SUB)            07847071
078480         CONTINUE                                                 07848071
078490     ELSE                                                         07849071
078500     IF  PS-NO-ERROR                                              07850071
078510         IF  ASC-ODD-CARTON                                       07851071
078520             (ASC-BLK-SUB ASC-ITEM-SUB)  >  +0  AND               07852071
078530             ASC-CARTON-COUNT                                     07853071
078540             (ASC-BLK-SUB ASC-ITEM-SUB)  >  +0  AND               07854071
078550             ASC-OUTER-PACK-QTY                                   07855071
078560             (ASC-BLK-SUB ASC-ITEM-SUB)  >  +0                    07856071
078570             SUBTRACT  1  FROM  ASC-CARTON-COUNT                  07857071
078580                                (ASC-BLK-SUB ASC-ITEM-SUB)        07858071
078590                          GIVING PV-CARTON-COUNT-LESS-ODD         07859071
078600             MULTIPLY  PV-CARTON-COUNT-LESS-ODD                   07860071
078610                   BY  ASC-OUTER-PACK-QTY                         07861071
078620                       (ASC-BLK-SUB ASC-ITEM-SUB)                 07862071
078630               GIVING  PV-PROCESS-QTY                             07863071
078640              ADD   ASC-ODD-CARTON (ASC-BLK-SUB ASC-ITEM-SUB)     07864071
078650                                      TO  PV-PROCESS-QTY          07865071
078660              MOVE  PV-PROCESS-QTY    TO  ASC-PROCESS-QTY         07866071
078670                                       (ASC-BLK-SUB ASC-ITEM-SUB) 07867071
078680                                          MR-PROCESS-QTY (PV-SUB) 07868071
078690              IF  ASC-LNE-CRE-P2L-LBL(ASC-BLK-SUB ASC-ITEM-SUB)   07869071
078700                  MOVE  ZEROS         TO  ASC-PROCESS-QTY         07870071
078710                                       (ASC-BLK-SUB ASC-ITEM-SUB) 07871071
078720                                          MR-PROCESS-QTY (PV-SUB) 07872071
078730              END-IF                                              07873071
078740         END-IF                                                   07874071
078750     END-IF                                                       07875071
078760     END-IF.                                                      07876071
078770                                                                  07877071
078780     IF  PS-DISTHD-RECORD-FOUND                                   07878071
078790         IF  ASC-LNE-UCC128-YES (ASC-BLK-SUB ASC-ITEM-SUB)        07879071
078800             CONTINUE                                             07880071
078810         ELSE                                                     07881071
078820         IF  DISTHD-TOT-CART-CNT  >  ZEROES  AND                  07882071
078830             DISTHD-FCSE-CART-CNT =  ZEROES  AND                  07883071
078840             DISTHD-INPK-CART-CNT =  ZEROES  AND                  07884071
078850             DISTHD-P2L-CART-CNT  =  DISTHD-TOT-CART-CNT          07885071
078860             MOVE  ZEROS          TO  ASC-PROCESS-QTY             07886071
078870                                      (ASC-BLK-SUB ASC-ITEM-SUB)  07887071
078880                                       MR-PROCESS-QTY (PV-SUB)    07888071
078890         END-IF                                                   07889071
078900         END-IF                                                   07890071
078910     END-IF.                                                      07891071
078920                                                                  07892071
078930*----------------------------------------------------------------*07893071
078940* -- IF PO IS BEING PROCESSED AS "ALL P2L" IGNORE PROCESS QTY.   *07894071
078950* -- IF LINE PREVIOUSLY PROCESSED AS "ALL P2L" IGNORE PROCESS QTY*07895071
078960*----------------------------------------------------------------*07896071
078970                                                                  07897071
078980     IF  ASC-LNE-CRE-P2L-LBL (ASC-BLK-SUB ASC-ITEM-SUB)  OR       07898071
078990         DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)  OR               07899071
079000         DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)  OR               07900071
079010         (DP020-FK-CONFIRM (DP020-SRC-AID) AND ASC-CONFIRM-DELETE)07901071
079020         CONTINUE                                                 07902071
079030     ELSE                                                         07903071
079040     IF  PS-DISTHD-RECORD-FOUND              AND                  07904071
079050         DISTHD-PRC-AREA-MODU-ID  >  SPACES  AND                  07905071
079060         DISTHD-TOT-CART-CNT      >  ZEROES  AND                  07906071
079070         DISTHD-FCSE-CART-CNT     =  ZEROES  AND                  07907071
079080         DISTHD-INPK-CART-CNT     =  ZEROES  AND                  07908071
079090         DISTHD-P2L-CART-CNT      =  DISTHD-TOT-CART-CNT          07909071
079100         CONTINUE                                                 07910071
079110     ELSE                                                         07911071
079120     IF  PS-NO-ERROR  AND                                         07912071
079130         (ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)  OR          07913071
079140          ASC-NOT-PROTECTED (ASC-BLK-SUB ASC-ITEM-SUB))           07914071
079150         IF  ASC-CARTON-COUNT (ASC-BLK-SUB ASC-ITEM-SUB) >  +0    07915071
079160             IF (ASC-PROCESS-QTY (ASC-BLK-SUB ASC-ITEM-SUB) =     07916071
079170                 ASC-TRANSCRIBE-QTY (ASC-BLK-SUB ASC-ITEM-SUB)) OR07917071
079180                 DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)  OR       07918071
079190                 DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)  OR       07919071
079200                 DP020-FK-LOCAL-FUNC-09 (DP020-SRC-AID)  OR       07920071
079210                 DP020-FK-LOCAL-FUNC-10 (DP020-SRC-AID)  OR       07921071
079220                 (DP020-FK-CONFIRM (DP020-SRC-AID)                07922071
079230                           AND ASC-CONFIRM-IGNORE)                07923071
079240                 CONTINUE                                         07924071
079250             ELSE                                                 07925071
079260                 MOVE DP015-RED     TO MR-PROCESS-QTYC (PV-SUB)   07926071
079270                                       MR-TRANSCRIB-QTYC (PV-SUB) 07927071
079280                 MOVE -1            TO MR-CARTON-CNTL (PV-SUB)    07928071
079290                 SET  ASC-QTY-ERROR-YES                           07929071
079300                 (ASC-BLK-SUB ASC-ITEM-SUB)  TO  TRUE             07930071
079310                 IF  ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)   07931071
079320                     SET PS-BLOCK-ERROR      TO  TRUE             07932071
079330                 END-IF                                           07933071
079340             END-IF                                               07934071
079350         END-IF                                                   07935071
079360     END-IF.                                                      07936071
079370                                                                  07937071
079380*-----------------------------------------------------------------07938071
079390* RE-CALCULATE LABEL COUNT                                       *07939071
079400* VALIDATE STORE ALLOCATION AGAINST THE INNER PACK               *07940071
079410* VALIDATE STORE ALLOCATION AGAINST THE OUTER PACK--CASEPACK ONLY*07941071
079420* NOTE -  THESE ARE THE LABEL COUNTS THAT APPEAR ON THE SCREEN   *07942071
079430*-----------------------------------------------------------------07943071
079440     IF  PS-NO-ERROR                                              07944071
079450         IF  ASC-LBL-TYP-UCC128    (ASC-BLK-SUB ASC-ITEM-SUB) AND 07945071
079460             ASC-UCC128-AVAIL-YES                             AND 07946071
079470             ASC-LNE-UCC128-IGNORE (ASC-BLK-SUB ASC-ITEM-SUB)     07947071
079480                 SET ASC-LNE-UCC128-YES                           07948071
079490                     (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE           07949071
079500         END-IF                                                   07950071
079510     END-IF.                                                      07951071
079520                                                                  07952071
079530     IF  PS-NO-ERROR                                              07953071
079540       IF  ASC-CARTON-COUNT (ASC-BLK-SUB ASC-ITEM-SUB)  >  +0 OR  07954071
079550           ASC-LNE-UCC128-YES(ASC-BLK-SUB ASC-ITEM-SUB)           07955071
079560         EVALUATE TRUE                                            07956071
079570         WHEN  DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)             07957071
079580         WHEN  DP020-FK-CONFIRM (DP020-SRC-AID)                   07958071
079590         WHEN  DP020-SRC-AID = DP016-ENTER                        07959071
079600               IF  ASC-NO-LINE-ERROR (ASC-BLK-SUB ASC-ITEM-SUB)   07960071
079610                   MOVE  ZEROES  TO  PV-TOT-REMAINDER             07961071
079620                                     PV-FCSE-INPK-REMAINDER       07962071
079630                                                                  07963071
079640               IF  (PS-NOT-DISTHD-RECORD-FOUND)   OR              07964071
079650                   (PS-DISTHD-RECORD-FOUND              AND       07965071
079660                    DISTHD-PRC-AREA-MODU-ID  =  SPACES  AND       07966071
079670                    DISTHD-TOT-CART-CNT      =  ZEROES  AND       07967071
079680                    DISTHD-FCSE-CART-CNT     =  ZEROES  AND       07968071
079690                    DISTHD-INPK-CART-CNT     =  ZEROES  AND       07969071
079700                    DISTHD-P2L-CART-CNT      =  ZEROES)           07970071
079710                                                                  07971071
079720                   IF  ASC-LNE-CRE-BOTH-LBL                       07972071
079730                       (ASC-BLK-SUB ASC-ITEM-SUB)                 07973071
079740                       IF  ASC-LNE-UCC128-YES                     07974071
079750                           (ASC-BLK-SUB ASC-ITEM-SUB)             07975071
079760                           IF  (ASC-SML-LABEL-CNT                 07976071
079770                                  (ASC-BLK-SUB ASC-ITEM-SUB)      07977071
079780                                >  ZEROES     OR                  07978071
079790                                ASC-P2L-LABEL-CNT                 07979071
079800                                  (ASC-BLK-SUB ASC-ITEM-SUB)      07980071
079810                                >  ZEROES)  AND                   07981071
079820                               (ASC-LINE-STATUS                   07982071
079830                                  (ASC-BLK-SUB ASC-ITEM-SUB)      07983071
079840                                >  SPACES   AND                   07984071
079850                                ASC-LINE-STATUS                   07985071
079860                                  (ASC-BLK-SUB ASC-ITEM-SUB)      07986071
079870                                NOT =  'PRPK' )                   07987071
079880                               MOVE  ASC-SML-LABEL-CNT            07988071
079890                                     (ASC-BLK-SUB ASC-ITEM-SUB)   07989071
079900                                 TO  PV-SHIP-LNE-TOTAL            07990071
080000                               MOVE  ASC-SML-FCSE-LBL-CNT         08000071
080010                                     (ASC-BLK-SUB ASC-ITEM-SUB)   08001071
080020                                 TO  PV-FULL-CASE-SHIP-TOTAL      08002071
080030                               MOVE  ASC-SML-INPK-LBL-CNT         08003071
080040                                     (ASC-BLK-SUB ASC-ITEM-SUB)   08004071
080050                                 TO  PV-INPK-SHIP-LNE-TOTAL       08005071
080060                               MOVE  ASC-P2L-LABEL-CNT            08006071
080070                                     (ASC-BLK-SUB ASC-ITEM-SUB)   08007071
080080                                 TO  PV-P2L-LNE-TOTAL             08008071
080090                           ELSE                                   08009071
080100*----------------------------------------------------------------*08010071
080110*  gb code to only call pckcs719  for selected line***11/13/02    08011071
080120*---------------------------------------------------------------**08012071
080130                             IF  ASC-LINE-STATUS                  08013071
080140                                      (ASC-BLK-SUB ASC-ITEM-SUB)  08014071
080150                                      NOT EQUAL  'VRFD'           08015071
080160                                 PERFORM 7300-UCC128-LBL-CNT      08016071
080170                             END-IF                               08017071
080180*----------------------------------------------------------------*08018071
080190*  gb code to only call pckcs719  for selected line***11/13/02    08019071
080200*----------------------------------------------------------------*08020071
080210                           END-IF                                 08021071
080220                       ELSE                                       08022071
080230                           PERFORM 4345-GET-LABEL-COUNT           08023071
080240                       END-IF                                     08024071
080250                           IF  PS-SOFT-ABORT-ERROR                08025071
080260                               NEXT SENTENCE                      08026071
080270                           ELSE                                   08027071
080280                           IF  ASC-VALID-INPK-YES  AND            08028071
080290                               ASC-VALID-OTPK-YES                 08029071
080300                               MOVE  PV-SHIP-LNE-TOTAL            08030071
080310                                 TO  ASC-SML-LABEL-CNT            08031071
080320                                     (ASC-BLK-SUB ASC-ITEM-SUB)   08032071
080330                                     MR-SHP-LBL-CNT (PV-SUB)      08033071
080340                               MOVE  PV-FULL-CASE-SHIP-TOTAL      08034071
080350                                 TO  ASC-SML-FCSE-LBL-CNT         08035071
080360                                     (ASC-BLK-SUB ASC-ITEM-SUB)   08036071
080370                               MOVE  PV-INPK-SHIP-LNE-TOTAL       08037071
080380                                 TO  ASC-SML-INPK-LBL-CNT         08038071
080390                                     (ASC-BLK-SUB ASC-ITEM-SUB)   08039071
080400                               MOVE  PV-P2L-LNE-TOTAL             08040071
080410                                 TO  ASC-P2L-LABEL-CNT            08041071
080420                                     (ASC-BLK-SUB ASC-ITEM-SUB)   08042071
080430                                     MR-P2L-LBL-CNT (PV-SUB)      08043071
080440                          END-IF                                  08044071
080450                          END-IF                                  08045071
080460                   END-IF                                         08046071
080470                   IF  ASC-LNE-CRE-P2L-LBL                        08047071
080480                       (ASC-BLK-SUB ASC-ITEM-SUB)                 08048071
080490                       MOVE  ZEROES                               08049071
080500                         TO  ASC-SML-LABEL-CNT                    08050071
080510                                 (ASC-BLK-SUB ASC-ITEM-SUB)       08051071
080520                             MR-SHP-LBL-CNT (PV-SUB)              08052071
080530                       MOVE  ZEROES                               08053071
080540                         TO  ASC-SML-FCSE-LBL-CNT                 08054071
080550                                 (ASC-BLK-SUB ASC-ITEM-SUB)       08055071
080560                       MOVE  ZEROES                               08056071
080570                         TO  ASC-SML-INPK-LBL-CNT                 08057071
080580                                 (ASC-BLK-SUB ASC-ITEM-SUB)       08058071
080590                       MOVE  ASC-CARTON-COUNT                     08059071
080600                                 (ASC-BLK-SUB ASC-ITEM-SUB)       08060071
080610                         TO  ASC-P2L-LABEL-CNT                    08061071
080620                                 (ASC-BLK-SUB ASC-ITEM-SUB)       08062071
080630                             MR-P2L-LBL-CNT (PV-SUB)              08063071
080640                                                                  08064071
080650                   END-IF                                         08065071
080660                   IF  ASC-LNE-CRE-SML-LBL                        08066071
080670                       (ASC-BLK-SUB ASC-ITEM-SUB)                 08067071
080680                       IF  ASC-LNE-UCC128-YES                     08068071
080690                           (ASC-BLK-SUB ASC-ITEM-SUB)             08069071
080700                           IF  (ASC-SML-LABEL-CNT                 08070071
080710                                  (ASC-BLK-SUB ASC-ITEM-SUB)      08071071
080720                                >  ZEROES     OR                  08072071
080730                                ASC-P2L-LABEL-CNT                 08073071
080740                                  (ASC-BLK-SUB ASC-ITEM-SUB)      08074071
080750                                >  ZEROES)  AND                   08075071
080760                                ASC-LINE-STATUS                   08076071
080770                                  (ASC-BLK-SUB ASC-ITEM-SUB)      08077071
080780                                >  SPACES                         08078071
080790                               MOVE  ASC-SML-LABEL-CNT            08079071
080800                                     (ASC-BLK-SUB ASC-ITEM-SUB)   08080071
080810                                 TO  PV-SHIP-LNE-TOTAL            08081071
080820                               MOVE  ASC-SML-FCSE-LBL-CNT         08082071
080830                                     (ASC-BLK-SUB ASC-ITEM-SUB)   08083071
080840                                 TO  PV-FULL-CASE-SHIP-TOTAL      08084071
080850                               MOVE  ASC-SML-INPK-LBL-CNT         08085071
080860                                     (ASC-BLK-SUB ASC-ITEM-SUB)   08086071
080870                                 TO  PV-INPK-SHIP-LNE-TOTAL       08087071
080880                               MOVE  ASC-P2L-LABEL-CNT            08088071
080890                                     (ASC-BLK-SUB ASC-ITEM-SUB)   08089071
080900                                 TO  PV-P2L-LNE-TOTAL             08090071
080910                           ELSE                                   08091071
080920                               PERFORM 7300-UCC128-LBL-CNT        08092071
080930                           END-IF                                 08093071
080940                       ELSE                                       08094071
080950                           PERFORM 4345-GET-LABEL-COUNT           08095071
080960                       END-IF                                     08096071
080970                           IF  PS-SOFT-ABORT-ERROR                08097071
080980                               NEXT SENTENCE                      08098071
080990                           ELSE                                   08099071
081000                           IF  ASC-VALID-INPK-YES  AND            08100071
081010                               ASC-VALID-OTPK-YES                 08101071
081020                               MOVE  PV-SHIP-LNE-TOTAL            08102071
081030                                 TO  ASC-SML-LABEL-CNT            08103071
081040                                     (ASC-BLK-SUB ASC-ITEM-SUB)   08104071
081050                                     MR-SHP-LBL-CNT (PV-SUB)      08105071
081060                               MOVE  PV-FULL-CASE-SHIP-TOTAL      08106071
081070                                 TO  ASC-SML-FCSE-LBL-CNT         08107071
081080                                     (ASC-BLK-SUB ASC-ITEM-SUB)   08108071
081090                               MOVE  PV-INPK-SHIP-LNE-TOTAL       08109071
081100                                 TO  ASC-SML-INPK-LBL-CNT         08110071
081110                                     (ASC-BLK-SUB ASC-ITEM-SUB)   08111071
081120                               MOVE  PV-P2L-LNE-TOTAL             08112071
081130                                 TO  ASC-P2L-LABEL-CNT            08113071
081140                                     (ASC-BLK-SUB ASC-ITEM-SUB)   08114071
081150                                     MR-P2L-LBL-CNT (PV-SUB)      08115071
081160                           ELSE                                   08116071
081170                           IF  ASC-INVALID-OTPK-YES  AND          08117071
081180                               ASC-LNE-BAD-OTPK-Y                 08118071
081190                               (ASC-BLK-SUB ASC-ITEM-SUB)         08119071
081200                               SET  PS-ERROR                      08120071
081210                                    DP020-MSG-FATAL TO TRUE       08121071
081220                               MOVE PC-TSYMSG-01759               08122071
081230                                 TO DP020-MSG-NUMBER              08123071
081240                           END-IF                                 08124071
081250                                                                  08125071
081260                           IF  ASC-INVALID-DV-RTV-OTPK  AND       08126071
081270                               ASC-LNE-DC-RTV-OTPK                08127071
081280                               (ASC-BLK-SUB ASC-ITEM-SUB)         08128071
081290                               SET  PS-ERROR                      08129071
081300                                    DP020-MSG-FATAL TO TRUE       08130071
081310                               MOVE PC-TSYMSG-01815               08131071
081320                                 TO DP020-MSG-NUMBER              08132071
081330                           END-IF                                 08133071
081340                                                                  08134071
081350                           IF  ASC-INVALID-OTPK-ODD  AND          08135071
081360                               ASC-LNE-BAD-ODD-Y                  08136071
081370                               (ASC-BLK-SUB ASC-ITEM-SUB)         08137071
081380                               SET  PS-ERROR                      08138071
081390                                    DP020-MSG-FATAL TO TRUE       08139071
081400                               MOVE PC-TSYMSG-02045               08140071
081410                                 TO DP020-MSG-NUMBER              08141071
081420                           END-IF                                 08142071
081430                       END-IF                                     08143071
081440                       END-IF                                     08144071
081450                   END-IF                                         08145071
081460                   IF  PS-DISTHD-RECORD-FOUND              AND    08146071
081470                       DISTHD-PRC-AREA-MODU-ID  >  SPACES  AND    08147071
081480                       DISTHD-TOT-CART-CNT      >  ZEROES  AND    08148071
081490                       DISTHD-FCSE-CART-CNT     =  ZEROES  AND    08149071
081500                       DISTHD-INPK-CART-CNT     =  ZEROES  AND    08150071
081510                       DISTHD-P2L-CART-CNT =  DISTHD-TOT-CART-CNT 08151071
081520                           MOVE  ZEROES                           08152071
081530                             TO  ASC-SML-LABEL-CNT                08153071
081540                                     (ASC-BLK-SUB ASC-ITEM-SUB)   08154071
081550                                 MR-SHP-LBL-CNT (PV-SUB)          08155071
081560                           MOVE  ZEROES                           08156071
081570                             TO  ASC-SML-FCSE-LBL-CNT             08157071
081580                                     (ASC-BLK-SUB ASC-ITEM-SUB)   08158071
081590                           MOVE  ZEROES                           08159071
081600                             TO  ASC-SML-INPK-LBL-CNT             08160071
081610                                     (ASC-BLK-SUB ASC-ITEM-SUB)   08161071
081620                           MOVE  ASC-CARTON-COUNT                 08162071
081630                                     (ASC-BLK-SUB ASC-ITEM-SUB)   08163071
081640                             TO  ASC-P2L-LABEL-CNT                08164071
081650                                     (ASC-BLK-SUB ASC-ITEM-SUB)   08165071
081660                                 MR-P2L-LBL-CNT (PV-SUB)          08166071
081670                   END-IF                                         08167071
081680                                                                  08168071
081690               ELSE                                               08169071
081700                   MOVE  DISTHD-FCSE-CART-CNT                     08170071
081710                     TO  ASC-SML-FCSE-LBL-CNT                     08171071
081720                                   (ASC-BLK-SUB ASC-ITEM-SUB)     08172071
081730                   MOVE  DISTHD-INPK-CART-CNT                     08173071
081740                     TO  ASC-SML-INPK-LBL-CNT                     08174071
081750                                   (ASC-BLK-SUB ASC-ITEM-SUB)     08175071
081760                   ADD   DISTHD-FCSE-CART-CNT                     08176071
081770                         DISTHD-INPK-CART-CNT                     08177071
081780                         GIVING  ASC-SML-LABEL-CNT                08178071
081790                                     (ASC-BLK-SUB ASC-ITEM-SUB)   08179071
081800                   MOVE  ASC-SML-LABEL-CNT                        08180071
081810                                     (ASC-BLK-SUB ASC-ITEM-SUB)   08181071
081820                     TO  MR-SHP-LBL-CNT (PV-SUB)                  08182071
081830                   MOVE  DISTHD-P2L-CART-CNT                      08183071
081840                     TO  ASC-P2L-LABEL-CNT                        08184071
081850                                   (ASC-BLK-SUB ASC-ITEM-SUB)     08185071
081860                         MR-P2L-LBL-CNT (PV-SUB)                  08186071
081870               END-IF                                             08187071
081880                                                                  08188071
081890               END-IF                                             08189071
081900         END-EVALUATE                                             08190071
081910       END-IF                                                     08191071
081920     END-IF.                                                      08192071
081930                                                                  08193071
081940     IF  PS-NO-ERROR                                              08194071
081950         IF  ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)   and           08195071
081960             ASC-P2L-PCC(ASC-BLK-SUB ASC-ITEM-SUB)  and           08196071
081970             ASC-P2L-LABEL-CNT(ASC-BLK-SUB ASC-ITEM-SUB) > +0     08197071
081980             EVALUATE TRUE                                        08198071
081990                 WHEN  DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)     08199071
082000                 WHEN  DP020-SRC-AID = DP016-ENTER                08200071
082010                       MOVE  ASC-OPER-UNT-ID                      08201071
082020                         TO PV-OPER-UNT-ID-HOLD                   08202071
082030                       PERFORM 3321-CHECK-P2L-LIMIT               08203071
082040             END-EVALUATE                                         08204071
082050         END-IF                                                   08205071
082060     END-IF.                                                      08206071
082070                                                                  08207071
082080     IF  PS-SOFT-ABORT-ERROR  OR                                  08208071
082090         DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID) OR                08209071
082100         DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID) OR                08210071
082110         DP020-FK-LOCAL-FUNC-09 (DP020-SRC-AID) OR                08211071
082120         DP020-FK-LOCAL-FUNC-10 (DP020-SRC-AID) OR                08212071
082130         DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID) OR                08213071
082140         (DP020-FK-CONFIRM (DP020-SRC-AID)                        08214071
082150                   AND ASC-CONFIRM-DELETE)      OR                08215071
082160         (DP020-FK-CONFIRM (DP020-SRC-AID)                        08216071
082170                   AND ASC-CONFIRM-IGNORE)                        08217071
082180         NEXT SENTENCE                                            08218071
082190     ELSE                                                         08219071
082200     IF  ASC-QTY-ERROR-YES (ASC-BLK-SUB ASC-ITEM-SUB)  AND        08220071
082210         ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)               08221071
082220             SET  PS-ERROR                                        08222071
082230                  DP020-MSG-WARNING                               08223071
082240                  PS-BLOCK-ERROR  TO  TRUE                        08224071
082250             MOVE PC-TSYMSG-01760  TO DP020-MSG-NUMBER            08225071
082260     END-IF                                                       08226071
082270     END-IF.                                                      08227071
082280                                                                  08228071
082290*-----------------------------------------------------------------08229071
082300* VERIFY THAT OUTERPACK QTY IS DIVISIBLE BY INNERPACK QTY        *08230071
082310*-----------------------------------------------------------------08231071
082320     IF  PS-SOFT-ABORT-ERROR  OR                                  08232071
082330         ASC-LNE-CRE-P2L-LBL (ASC-BLK-SUB ASC-ITEM-SUB) OR        08233071
082340         DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)         OR        08234071
082350         (DP020-FK-CONFIRM (DP020-SRC-AID)                        08235071
082360                   AND ASC-CONFIRM-DELETE)                        08236071
082370         CONTINUE                                                 08237071
082380     ELSE                                                         08238071
082390     IF  DISTHD-PRC-AREA-MODU-ID  >  SPACES  AND                  08239071
082400         DISTHD-TOT-CART-CNT      >  ZEROES  AND                  08240071
082410         DISTHD-FCSE-CART-CNT     =  ZEROES  AND                  08241071
082420         DISTHD-INPK-CART-CNT     =  ZEROES  AND                  08242071
082430         DISTHD-P2L-CART-CNT      =  DISTHD-TOT-CART-CNT          08243071
082440         CONTINUE                                                 08244071
082450     ELSE                                                         08245071
082460     IF  PS-NO-ERROR  AND                                         08246071
082470         ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)               08247071
082480         IF  ASC-CARTON-COUNT (ASC-BLK-SUB ASC-ITEM-SUB) >  +0    08248071
082490             PERFORM 4365-VERIFY-INNER-OUTER-PACK                 08249071
082500         END-IF                                                   08250071
082510     END-IF                                                       08251071
082520     END-IF                                                       08252071
082530     END-IF.                                                      08253071
082540                                                                  08254071
082550*-----------------------------------------------------------------08255071
082560* VERIFY THAT ODD CARTON QTY IS DIVISIBLE BY INNERPACK QTY       *08256071
082570*-----------------------------------------------------------------08257071
082580     IF  PS-SOFT-ABORT-ERROR  OR                                  08258071
082590         ASC-LNE-CRE-P2L-LBL (ASC-BLK-SUB ASC-ITEM-SUB) OR        08259071
082600         DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)         OR        08260071
082610         DP020-FK-CONFIRM (DP020-SRC-AID)                         08261071
082620         CONTINUE                                                 08262071
082630     ELSE                                                         08263071
082640     IF  DISTHD-PRC-AREA-MODU-ID  >  SPACES  AND                  08264071
082650         DISTHD-TOT-CART-CNT      >  ZEROES  AND                  08265071
082660         DISTHD-FCSE-CART-CNT     =  ZEROES  AND                  08266071
082670         DISTHD-INPK-CART-CNT     =  ZEROES  AND                  08267071
082680         DISTHD-P2L-CART-CNT      =  DISTHD-TOT-CART-CNT          08268071
082690         CONTINUE                                                 08269071
082700     ELSE                                                         08270071
082710     IF  PS-NO-ERROR  AND                                         08271071
082720         ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)               08272071
082730         IF  ASC-ODD-CARTON (ASC-BLK-SUB ASC-ITEM-SUB) >  +0      08273071
082740             PERFORM 4366-VERIFY-ODD-INNER-PACK                   08274071
082750         END-IF                                                   08275071
082760     END-IF                                                       08276071
082770     END-IF                                                       08277071
082780     END-IF.                                                      08278071
082790                                                                  08279071
082800*-----------------------------------------------------------------08280071
082810* VALIDATE INNER-PACK CONVEYABLE INDICATOR                       *08281071
082820*-----------------------------------------------------------------08282071
082830     IF  PS-SOFT-ABORT-ERROR   OR                                 08283071
082840         DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)  OR               08284071
082850         ASC-PROTECTED (ASC-BLK-SUB ASC-ITEM-SUB)                 08285071
082860         CONTINUE                                                 08286071
082870     ELSE                                                         08287071
082880     IF  PS-NO-ERROR                                              08288071
082890         IF  ASC-IN-PAK-CNVY-VALID(ASC-BLK-SUB ASC-ITEM-SUB)      08289071
082900             CONTINUE                                             08290071
082910         ELSE                                                     08291071
082920             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           08292071
082930             SET DP020-MSG-FATAL    TO TRUE                       08293071
082940             MOVE -1                TO MR-IN-PCK-CONVYL(PV-SUB)   08294071
082950             SET DP030-SET-CURSOR-APPL-1                          08295071
082960                                    TO TRUE                       08296071
082970             MOVE DP015-RED         TO MR-IN-PCK-CONVYC(PV-SUB)   08297071
082980             MOVE DP015-REVERSE     TO MR-IN-PCK-CONVYH(PV-SUB)   08298071
082990             SET PS-ERROR                                         08299071
083000                 PS-BLOCK-ERROR  TO  TRUE                         08300071
083010         END-IF                                                   08301071
083020     END-IF                                                       08302071
083030     END-IF.                                                      08303071
083040                                                                  08304071
083050     IF  PS-SOFT-ABORT-ERROR   OR                                 08305071
083060         DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)  OR               08306071
083070         ASC-PROTECTED (ASC-BLK-SUB ASC-ITEM-SUB)                 08307071
083080         CONTINUE                                                 08308071
083090     ELSE                                                         08309071
083100     IF  PS-NO-ERROR                                              08310071
083110       EVALUATE TRUE                                              08311071
083120         WHEN ASC-IN-PAK-CONVEY-NO (ASC-BLK-SUB ASC-ITEM-SUB)     08312071
083130             CONTINUE                                             08313071
083140         WHEN ASC-IN-PAK-CONVEY-YES (ASC-BLK-SUB ASC-ITEM-SUB)    08314071
083150              IF (ASC-LNE-CRE-SML-LBL                             08315071
083160                      (ASC-BLK-SUB ASC-ITEM-SUB) OR               08316071
083170                  ASC-LNE-CRE-BOTH-LBL                            08317071
083180                      (ASC-BLK-SUB ASC-ITEM-SUB)) AND             08318071
083190                 ASC-INNER-PACK-QTY (ASC-BLK-SUB ASC-ITEM-SUB) > 108319071
083200                 CONTINUE                                         08320071
083210              ELSE                                                08321071
083220                  PERFORM 3343-CHECK-INPK-CNVY-1-VALID            08322071
083230                  IF  PS-INPK-CNVY-1-VALID                        08323071
083240                      CONTINUE                                    08324071
083250                  ELSE                                            08325071
083260                      MOVE PC-TSYMSG-01833 TO DP020-MSG-NUMBER    08326071
083270                      SET DP020-MSG-FATAL  TO TRUE                08327071
083280                      MOVE -1          TO MR-IN-PCK-CONVYL(PV-SUB)08328071
083290                      SET DP030-SET-CURSOR-APPL-1                 08329071
083291                                       TO TRUE                    08329171
083292                      MOVE DP015-RED TO MR-IN-PCK-CONVYC (PV-SUB) 08329271
083293                      MOVE DP015-REVERSE                          08329371
083294                                     TO MR-IN-PCK-CONVYH (PV-SUB) 08329471
083295                      SET PS-ERROR                                08329571
083296                          PS-BLOCK-ERROR  TO  TRUE                08329671
083297                  END-IF                                          08329771
083298              END-IF                                              08329871
083299       END-EVALUATE                                               08329971
083300     END-IF                                                       08330071
083310     END-IF.                                                      08331071
083320                                                                  08332071
083330*-----------------------------------------------------------------08333071
083340* VALIDATE LABEL TYPE-INDICATOR                                  *08334071
083350*-----------------------------------------------------------------08335071
083360     IF  PS-SOFT-ABORT-ERROR                            OR        08336071
083370         ASC-CRE-LBL-NO-UPDT (ASC-BLK-SUB ASC-ITEM-SUB)  OR       08337071
083380         ASC-PROTECTED (ASC-BLK-SUB ASC-ITEM-SUB)                 08338071
083390         CONTINUE                                                 08339071
083400     ELSE                                                         08340071
083410     IF  PS-NO-ERROR                                              08341071
083420         IF (ASC-LNE-CRE-P2L-LBL (ASC-BLK-SUB ASC-ITEM-SUB) AND   08342071
083430             ASC-LBL-TYP-P2L-VALID(ASC-BLK-SUB ASC-ITEM-SUB)) OR  08343071
083440            (ASC-LNE-CRE-BOTH-LBL (ASC-BLK-SUB ASC-ITEM-SUB) AND  08344071
083450             ASC-LBL-TYP-VALID(ASC-BLK-SUB ASC-ITEM-SUB))     OR  08345071
083460            (ASC-LNE-CRE-SML-LBL (ASC-BLK-SUB ASC-ITEM-SUB) AND   08346071
083470             ASC-LBL-TYP-VALID(ASC-BLK-SUB ASC-ITEM-SUB))         08347071
083480             IF  ASC-LBL-TYP-PGYBK (ASC-BLK-SUB ASC-ITEM-SUB)     08348071
083490               EVALUATE TRUE                                      08349071
083500                 WHEN  ASC-OUTER-PACK-QTY                         08350071
083510                     (ASC-BLK-SUB ASC-ITEM-SUB)  >  15  AND       08351071
083520                       ASC-IN-PAK-CONVEY-NO                       08352071
083530                     (ASC-BLK-SUB ASC-ITEM-SUB)         AND       08353071
083540                      ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB) 08354071
083550                     MOVE PC-TSYMSG-01812 TO DP020-MSG-NUMBER     08355071
083560                     SET DP020-MSG-FATAL  TO TRUE                 08356071
083570                     MOVE -1              TO MR-LBL-TYPEL(PV-SUB) 08357071
083580                     SET DP030-SET-CURSOR-APPL-1                  08358071
083590                                          TO TRUE                 08359071
083600                     MOVE DP015-RED       TO MR-LBL-TYPEC(PV-SUB) 08360071
083610                     MOVE DP015-REVERSE   TO MR-LBL-TYPEH(PV-SUB) 08361071
083620                     SET PS-ERROR                                 08362071
083630                         PS-BLOCK-ERROR  TO  TRUE                 08363071
083640                 WHEN  ASC-INNER-PACK-QTY                         08364071
083650                     (ASC-BLK-SUB ASC-ITEM-SUB)  >  15  AND       08365071
083660                       ASC-IN-PAK-CONVEY-YES                      08366071
083670                     (ASC-BLK-SUB ASC-ITEM-SUB)         AND       08367071
083680                      ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB) 08368071
083690                     MOVE PC-TSYMSG-01812 TO DP020-MSG-NUMBER     08369071
083700                     SET DP020-MSG-FATAL  TO TRUE                 08370071
083710                     MOVE -1              TO MR-LBL-TYPEL(PV-SUB) 08371071
083720                     SET DP030-SET-CURSOR-APPL-1                  08372071
083730                                          TO TRUE                 08373071
083740                     MOVE DP015-RED       TO MR-LBL-TYPEC(PV-SUB) 08374071
083750                     MOVE DP015-REVERSE   TO MR-LBL-TYPEH(PV-SUB) 08375071
083760                     SET PS-ERROR                                 08376071
083770                         PS-BLOCK-ERROR  TO  TRUE                 08377071
083780                 WHEN  ASC-ODD-CARTON                             08378071
083790                     (ASC-BLK-SUB ASC-ITEM-SUB)  >  15  AND       08379071
083800                      ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB) 08380071
083810                     MOVE PC-TSYMSG-02001 TO DP020-MSG-NUMBER     08381071
083820                     SET DP020-MSG-FATAL  TO TRUE                 08382071
083830                     MOVE -1              TO MR-LBL-TYPEL(PV-SUB) 08383071
083840                     SET DP030-SET-CURSOR-APPL-1                  08384071
083850                                          TO TRUE                 08385071
083860                     MOVE DP015-RED       TO MR-LBL-TYPEC(PV-SUB) 08386071
083870                     MOVE DP015-REVERSE   TO MR-LBL-TYPEH(PV-SUB) 08387071
083880                     SET PS-ERROR                                 08388071
083890                         PS-BLOCK-ERROR  TO  TRUE                 08389071
083900               END-EVALUATE                                       08390071
083910             END-IF                                               08391071
083920         ELSE                                                     08392071
083930             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           08393071
083940             SET DP020-MSG-FATAL    TO TRUE                       08394071
083950             MOVE -1                TO MR-LBL-TYPEL (PV-SUB)      08395071
083960             SET DP030-SET-CURSOR-APPL-1                          08396071
083970                                    TO TRUE                       08397071
083980             MOVE DP015-RED         TO MR-LBL-TYPEC (PV-SUB)      08398071
083990             MOVE DP015-REVERSE     TO MR-LBL-TYPEH (PV-SUB)      08399071
084000             SET PS-ERROR                                         08400071
084010                 PS-BLOCK-ERROR  TO  TRUE                         08401071
084020         END-IF                                                   08402071
084030     END-IF.                                                      08403071
084040                                                                  08404071
084050     IF  ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)  AND         08405071
084060         ASC-LNE-UCC128-CRTN-MLT-LNES                             08406071
084070                          (ASC-BLK-SUB ASC-ITEM-SUB)  AND         08407071
084080         ASC-LNE-UCC128-YES   (ASC-BLK-SUB ASC-ITEM-SUB)          08408071
084090             SET  ASC-UCC128-MLT-LNE-YES  TO TRUE                 08409071
084100     ELSE                                                         08410071
084200                                                                  08420071
084210* trouble function                                                08421071
084220                                                                  08422071
084230     IF  PS-SOFT-ABORT-ERROR                     OR               08423071
084240         DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)  OR               08424071
084250         DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)  OR               08425071
084260         DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)  OR               08426071
084270         DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)  OR               08427071
084280         DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)  OR               08428071
084290         DP020-FK-LOCAL-FUNC-09 (DP020-SRC-AID)  OR               08429071
084300         DP020-FK-PREV-PAGE(DP020-SRC-AID)       OR               08430071
084310         DP020-FK-NEXT-PAGE(DP020-SRC-AID)       OR               08431071
084320         DP020-SRC-AID = DP016-ENTER             OR               08432071
084330        (DP020-FK-CONFIRM (DP020-SRC-AID) AND                     08433071
084340         ASC-CONFIRM-DELETE)                                      08434071
084350         CONTINUE                                                 08435071
084360     ELSE                                                         08436071
084370     IF  PS-NO-ERROR                                              08437071
084380         IF (ASC-LBL-TYP (ASC-BLK-SUB ASC-ITEM-SUB) = 'S'  OR     08438071
084390             ASC-LBL-TYP (ASC-BLK-SUB ASC-ITEM-SUB) = 'R') AND    08439071
084400             ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)           08440071
084410             IF  ASC-DO-NOT-PRINT-SML                             08441071
084420                 MOVE PC-TSYMSG-01563   TO DP020-MSG-NUMBER       08442071
084430                 SET DP020-MSG-FATAL    TO TRUE                   08443071
084440                 MOVE -1                TO MDEST1L                08444071
084450                 SET DP030-SET-CURSOR-APPL-1                      08445071
084460                                        TO TRUE                   08446071
084470                 MOVE DP015-RED         TO MR-LBL-TYPEC (PV-SUB)  08447071
084480                                           MDEST1C                08448071
084490                 MOVE DP015-REVERSE     TO MR-LBL-TYPEH (PV-SUB)  08449071
084500                                           MDEST1H                08450071
084510                 SET PS-ERROR                                     08451071
084520                     PS-BLOCK-ERROR  TO  TRUE                     08452071
084530             END-IF                                               08453071
084540         ELSE                                                     08454071
084550         IF  ASC-LBL-TYP (ASC-BLK-SUB ASC-ITEM-SUB) = 'P'  AND    08455071
084560             ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)           08456071
084570             IF  ASC-DO-NOT-PRINT-PGYBK                           08457071
084580                 MOVE PC-TSYMSG-01563   TO DP020-MSG-NUMBER       08458071
084590                 SET DP020-MSG-FATAL    TO TRUE                   08459071
084600                 MOVE -1                TO MDEST2L                08460071
084610                 SET DP030-SET-CURSOR-APPL-1                      08461071
084620                                        TO TRUE                   08462071
084630                 MOVE DP015-RED         TO MR-LBL-TYPEC (PV-SUB)  08463071
084640                                           MDEST2C                08464071
084650                 MOVE DP015-REVERSE     TO MR-LBL-TYPEH (PV-SUB)  08465071
084660                                           MDEST2H                08466071
084670                 SET PS-ERROR                                     08467071
084680                     PS-BLOCK-ERROR  TO  TRUE                     08468071
084690             ELSE                                                 08469071
084700             IF  ASC-PGYBCK-PRTR-ID  >  SPACE                     08470071
084710                 CONTINUE                                         08471071
084720             ELSE                                                 08472071
084730                 MOVE PC-TSYMSG-01563   TO DP020-MSG-NUMBER       08473071
084740                 SET DP020-MSG-FATAL    TO TRUE                   08474071
084750                 MOVE -1                TO MDEST2L                08475071
084760                 SET DP030-SET-CURSOR-APPL-1                      08476071
084770                                        TO TRUE                   08477071
084780                 MOVE DP015-RED         TO MR-LBL-TYPEC (PV-SUB)  08478071
084790                                           MDEST2C                08479071
084800                 MOVE DP015-REVERSE     TO MR-LBL-TYPEH (PV-SUB)  08480071
084810                                           MDEST2H                08481071
084820                 SET PS-ERROR                                     08482071
084830                     PS-BLOCK-ERROR  TO  TRUE                     08483071
084840             END-IF                                               08484071
084850             END-IF                                               08485071
084860         END-IF                                                   08486071
084870     END-IF                                                       08487071
084880     END-IF                                                       08488071
084890     END-IF.                                                      08489071
084900                                                                  08490071
085000*-----------------------------------------------------------------08500071
085100* DELETE FUNCTION - IF UCC128 DATA WAS USED AND ANY CARTONS HAVE  08510071
085110* ALREADY BEEN CHECKED IN 2ND CONFIRM IS NECESSARY                08511071
085120*-----------------------------------------------------------------08512071
085130     IF  DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)                   08513071
085140         IF  ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)      AND   08514071
085150            (ASC-LNE-UCC128-YES (ASC-BLK-SUB ASC-ITEM-SUB)  OR    08515071
085160             ASC-LBL-TYP-SML(ASC-BLK-SUB ASC-ITEM-SUB))     AND   08516071
085170             PS-DISTHD-RECORD-FOUND                         AND   08517071
085180             ASC-LINE-STATUS (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES  08518071
085190             PERFORM 3345-COUNT-CHECK-IN                          08519071
085200         END-IF                                                   08520071
085210     END-IF.                                                      08521071
085220                                                                  08522071
085230*-----------------------------------------------------------------08523071
085240* IF INNERPACK CONVEYABLE AND QUANTITY = 1 CHECK TO SEE IF THAT   08524071
085250* IS BEING ALLOWED.  THIS IS GENERALLY DONE WHEN PROCESSING       08525071
085260* PATIO FURNITURE IN THE SPRING.                                  08526071
085270*-----------------------------------------------------------------08527071
085271 3343-CHECK-INPK-CNVY-1-VALID.                                    08527171
085272                                                                  08527271
085273     SET  PS-INPK-CNVY-1-NOT-VALID    TO  TRUE.                   08527371
085274                                                                  08527471
085275     EXEC SQL                                                     08527571
085276          SELECT  A.FUNC_TXT                                      08527671
085277            INTO  :PS-INPK-CNVY-1-VALID-SW                        08527771
085278            FROM   TKRPRPM A                                      08527871
085279           WHERE  A.LOC_ID            =  90                       08527971
085280             AND  A.INTFC_SYS_CDE     = 'KHL'                     08528071
085281             AND  A.SYS_PRC_FUNC_CDE  = 'INCVY1'                  08528171
085282             AND  a.FUNC_BEG_TMST    <=  CURRENT TIMESTAMP        08528271
085283             AND  a.FUNC_END_TMST    >=  CURRENT TIMESTAMP        08528371
085284     END-EXEC.                                                    08528471
085285                                                                  08528571
085286     EVALUATE TRUE                                                08528671
085287                                                                  08528771
085288         WHEN SQLCODE = +0                                        08528871
085289              continue                                            08528971
085290         WHEN SQLCODE = +100                                      08529071
085300              SET  PS-INPK-CNVY-1-NOT-VALID   TO  TRUE            08530071
085310                                                                  08531071
085311         WHEN SQLCODE = -904                                      08531171
085312         WHEN SQLCODE = -911                                      08531271
085313         WHEN SQLCODE = -913                                      08531371
085314              MOVE SQLCODE                   TO PV-SOFT-SQLCODE   08531471
085315              MOVE '3343-CHECK-INPK-CNVY-1-VALID'                 08531571
085316                                             TO PV-SOFT-PARAGRAPH 08531671
085317              MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2 08531771
085318              MOVE LENGTH OF PV-CICS-MSG-AREA2                    08531871
085319                TO PV-COMMAREA-LENGTH                             08531971
085320              EXEC CICS                                           08532071
085321                   WRITEQ TD                                      08532171
085322                    QUEUE  ('CSSL')                               08532271
085323                     FROM  (PV-CICS-MSG-AREA2)                    08532371
085324                   LENGTH  (PV-COMMAREA-LENGTH)                   08532471
085325                     RESP  (PV-CICS-RESP)                         08532571
085326              END-EXEC                                            08532671
085327             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          08532771
085328             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              08532871
085329             PERFORM 9900-SOFT-ABORT                              08532971
085330                                                                  08533071
085331         WHEN SQLWARN0 NOT = SPACES                               08533171
085332         WHEN SQLCODE < +0                                        08533271
085333         WHEN SQLCODE > +0                                        08533371
085334              MOVE '3343-CHECK-INPK-CNVY-1-VALID'                 08533471
085335                                 TO DP013-PARAGRAPH               08533571
085336              MOVE 'CHECK IF INPK CNVY 1 VALID             '      08533671
085337                                 TO DP013-MESSAGE-TEXT (1)        08533771
085338              MOVE SQLCA         TO DP013-SQLCA                   08533871
085339              MOVE 'TKRPRPM'     TO DP013-DB2-TABLE-NAME (1)      08533971
085340              SET DP013-DB2-ABEND                                 08534071
085341                  DP013-XCTL-DISPLAY-RESTART                      08534171
085342                                 TO TRUE                          08534271
085343              PERFORM DP013-0000-PROCESS-ABEND                    08534371
085344     END-EVALUATE.                                                08534471
085345                                                                  08534571
085346                                                                  08534671
085347*-----------------------------------------------------------------08534771
085348* CHECK TO SEE IF CARTONS ALREADY CHECKED IN FOR DELETE           08534871
085349*-----------------------------------------------------------------08534971
085350 3345-COUNT-CHECK-IN.                                             08535071
085351     MOVE  ZEROES  TO  DK-LINE-NBR                                08535171
085352                       DK-PREPK-ID.                               08535271
085353     MOVE ASC-PO-LNE-NBR (ASC-BLK-SUB ASC-ITEM-SUB)               08535371
085354                   TO  DK-LINE-NBR.                               08535471
085355     MOVE ASC-PREPK-ID (ASC-BLK-SUB ASC-ITEM-SUB)                 08535571
085356                   TO  DK-PREPK-ID.                               08535671
085357     MOVE  ZEROES  TO  PV-CHECK-IN-COUNT.                         08535771
085358                                                                  08535871
085359     IF  ASC-PRE-PACK-ORDER                                       08535971
085360         EXEC SQL                                                 08536071
085370             SELECT COUNT(*)                                      08537071
085380               INTO :PV-CHECK-IN-COUNT                            08538071
085390               FROM TLBVRDA                                       08539071
085400              WHERE PO_NBR   =  :ASC-PO-NBR                       08540071
085410                AND RCVR_SEQ_NBR = :ASC-REC-SEQ-NBR               08541071
085420                AND PREPK_ID   = :DK-PREPK-ID                     08542071
085430                AND LBL_ASG_IND = 'Y'                             08543071
085440                AND EXISTS                                        08544071
085450                 (SELECT *                                        08545071
085460                  FROM TLBVRDA A                                  08546071
085470                     , TSULBXF B                                  08547071
085480                    WHERE                                         08548071
085490                    A.BRCDE_NBR  = B.BRCDE_NBR                    08549071
085500                    AND PO_NBR   =  :ASC-PO-NBR                   08550071
085510                    AND RCVR_SEQ_NBR = :ASC-REC-SEQ-NBR           08551071
085520                    AND PREPK_ID   = :DK-PREPK-ID)                08552071
085530         END-EXEC                                                 08553071
085540     ELSE                                                         08554071
085550         EXEC SQL                                                 08555071
085560             SELECT COUNT(*)                                      08556071
085570               INTO :PV-CHECK-IN-COUNT                            08557071
085580               FROM TLBVRDA                                       08558071
085590              WHERE PO_NBR   =  :ASC-PO-NBR                       08559071
085600                AND RCVR_SEQ_NBR = :ASC-REC-SEQ-NBR               08560071
085610                AND PO_LNE_NBR = :DK-LINE-NBR                     08561071
085620                AND LBL_ASG_IND = 'Y'                             08562071
085630                AND EXISTS                                        08563071
085640                 (SELECT *                                        08564071
085650                  FROM TLBVRDA A                                  08565071
085660                     , TSULBXF B                                  08566071
085670                    WHERE                                         08567071
085680                    A.BRCDE_NBR  = B.BRCDE_NBR                    08568071
085690                    AND PO_NBR   =  :ASC-PO-NBR                   08569071
085700                    AND RCVR_SEQ_NBR = :ASC-REC-SEQ-NBR           08570071
085710                    AND PO_LNE_NBR = :DK-LINE-NBR)                08571071
085720         END-EXEC                                                 08572071
085730     END-IF.                                                      08573071
085740                                                                  08574071
085750     EVALUATE TRUE                                                08575071
085760         WHEN SQLCODE = +0                                        08576071
085770             CONTINUE                                             08577071
085780         WHEN SQLCODE = -904                                      08578071
085790         WHEN SQLCODE = -911                                      08579071
085800         WHEN SQLCODE = -913                                      08580071
085810             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    08581071
085820             MOVE '3345-COUNT-CHECK-IN'     TO PV-SOFT-PARAGRAPH  08582071
085830             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  08583071
085840             MOVE LENGTH OF PV-CICS-MSG-AREA2                     08584071
085850               TO PV-COMMAREA-LENGTH                              08585071
085860             EXEC CICS                                            08586071
085870                  WRITEQ TD                                       08587071
085880                   QUEUE  ('CSSL')                                08588071
085890                    FROM  (PV-CICS-MSG-AREA2)                     08589071
085900                  LENGTH  (PV-COMMAREA-LENGTH)                    08590071
085910                    RESP  (PV-CICS-RESP)                          08591071
085920             END-EXEC                                             08592071
085930             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          08593071
085940             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              08594071
085950             PERFORM 9900-SOFT-ABORT                              08595071
085960         WHEN SQLWARN0 NOT = SPACES                               08596071
085970         WHEN SQLCODE < ZERO                                      08597071
085980         WHEN SQLCODE > ZERO                                      08598071
085990             MOVE '3345-COUNT-CHECK-IN'                           08599071
086000                               TO DP013-PARAGRAPH                 08600071
086010             MOVE 'CHECK IF PO/RECEIVER IN TROUBLE'               08601071
086020                               TO DP013-MESSAGE-TEXT (1)          08602071
086030             MOVE SQLCA        TO DP013-SQLCA                     08603071
086040             MOVE 'TLBVRDA'    TO DP013-DB2-TABLE-NAME (1)        08604071
086050             SET DP013-DB2-ABEND                                  08605071
086060                 DP013-XCTL-DISPLAY-RESTART                       08606071
086070                               TO TRUE                            08607071
086080             PERFORM DP013-0000-PROCESS-ABEND                     08608071
086090     END-EVALUATE.                                                08609071
086100                                                                  08610071
086110     IF  PV-CHECK-IN-COUNT  >  +0  and                            08611071
086120         ASC-RECLAIM-DC-YES                                       08612071
086130                                                                  08613071
086140         SET  ASC-2ND-CONFIRM-NEED     TO  TRUE                   08614071
086150         MOVE PC-TSYMSG-02972          TO  DP020-MSG-NUMBER       08615071
086160         SET DP020-MSG-FATAL           TO  TRUE                   08616071
086170         MOVE -1                       TO  MDEST2L                08617071
086180         SET DP030-SET-CURSOR-APPL-1   TO  TRUE                   08618071
086190         MOVE DP015-RED                TO  MR-PO-LINEC (PV-SUB)   08619071
086200         MOVE DP015-REVERSE            TO  MR-PO-LINEH (PV-SUB)   08620071
086210         SET PS-ERROR                                             08621071
086220             PS-BLOCK-ERROR  TO  TRUE                             08622071
086230                                                                  08623071
086240     ELSE                                                         08624071
086250         IF  ASC-PRE-PACK-ORDER                                   08625071
086260             PERFORM 3346-CHECKED-IN-CARTONS                      08626071
086270         ELSE                                                     08627071
086280             PERFORM 3347-CHECKED-IN-CARTONS                      08628071
086290         END-IF                                                   08629071
086300         IF PS-ERROR                                              08630071
086310             SET  ASC-2ND-CONFIRM-NEED     TO TRUE                08631071
086320             SET DP020-MSG-FATAL           TO TRUE                08632071
086330             MOVE -1                       TO MDEST2L             08633071
086340             SET DP030-SET-CURSOR-APPL-1   TO TRUE                08634071
086350             MOVE DP015-RED                TO MR-PO-LINEC (PV-SUB)08635071
086360             MOVE DP015-REVERSE            TO MR-PO-LINEH (PV-SUB)08636071
086370             SET PS-ERROR                                         08637071
086380                 PS-BLOCK-ERROR  TO  TRUE                         08638071
086390         ELSE                                                     08639071
086400             SET  ASC-2ND-CONFIRM-NEED-NO  TO  TRUE               08640071
086410         END-IF                                                   08641071
086420     END-IF.                                                      08642071
086430                                                                  08643071
086440*----------------------------------------------------------------*08644071
086450*  CHECK IF THERE LINES SELECTED FOR DELETE THAT ARE CHECKED IN   08645071
086460*----------------------------------------------------------------*08646071
086470 3346-CHECKED-IN-CARTONS.                                         08647071
086480                                                                  08648071
086490     EXEC SQL                                                     08649071
086500       SELECT DISTINCT (B.SHIPT_UNT_ID)                           08650071
086510         INTO :SUT00024-SHIPT-UNT-ID                              08651071
086520         FROM SUT_OTBND_UPC A                                     08652071
086530            , SUT_OTBND_CART B                                    08653071
086540            , TRECITM C                                           08654071
086550        WHERE  A.SHIPT_UNT_ID     = B.SHIPT_UNT_ID                08655071
086560          AND  A.TRN_NBR            = :ASC-PO-NBR                 08656071
086570          AND  A.RCVR_SEQ_NBR       = :ASC-REC-SEQ-NBR            08657071
086580          AND  A.TRN_NBR            = C.ORD_NBR                   08658071
086590          AND  A.RCVR_SEQ_NBR       = C.REC_SEQ_NBR               08659071
086600          AND  A.TRN_LNE_NBR        = C.ORD_LNE_NBR               08660071
086610          AND  C.PREPK_ID           = :DK-PREPK-ID                08661071
086620          AND  B.CART_SRC_CDE       = 'ASN'                       08662071
086630          AND  B.ACTV_IND           = 'Y'                         08663071
086640     END-EXEC.                                                    08664071
086650                                                                  08665071
086660     EVALUATE TRUE                                                08666071
086670         WHEN SQLCODE = ZERO                                      08667071
086680         WHEN SQLCODE = -811                                      08668071
086690              MOVE  PC-TSYMSG-03409  TO  DP020-MSG-NUMBER         08669071
086700              SET DP020-MSG-INFORMATIONAL                         08670071
086710                  PS-ERROR                                        08671071
086720                  PS-SOFT-ABORT-ERROR       TO TRUE               08672071
086730         WHEN SQLCODE = +100                                      08673071
086740              CONTINUE                                            08674071
086750         WHEN SQLCODE = -904                                      08675071
086760         WHEN SQLCODE = -911                                      08676071
086770         WHEN SQLCODE = -913                                      08677071
086780                                                                  08678071
086790              MOVE SQLCODE                   TO PV-SOFT-SQLCODE   08679071
086800              MOVE '3346-CHECKED-IN-CARTONS' TO PV-SOFT-PARAGRAPH 08680071
086810              MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2 08681071
086820              MOVE LENGTH OF PV-CICS-MSG-AREA2                    08682071
086830                TO PV-COMMAREA-LENGTH                             08683071
086840              EXEC CICS                                           08684071
086850                  WRITEQ TD                                       08685071
086860                   QUEUE  ('CSSL')                                08686071
086870                    FROM  (PV-CICS-MSG-AREA2)                     08687071
086880                  LENGTH  (PV-COMMAREA-LENGTH)                    08688071
086890                    RESP  (PV-CICS-RESP)                          08689071
086900              END-EXEC                                            08690071
086910              MOVE  PC-TSYMSG-00551  TO  DP020-MSG-NUMBER         08691071
086920              PERFORM 9900-SOFT-ABORT                             08692071
086930                                                                  08693071
086940         WHEN SQLWARN0 NOT = SPACES                               08694071
086950         WHEN SQLCODE NOT EQUAL ZERO                              08695071
086960              MOVE '3346-CHECKED-IN-CARTONS'                      08696071
086970                                   TO DP013-PARAGRAPH             08697071
086980              MOVE 'SELECT FOR DIVERTED CARTONS '                 08698071
086990                                   TO DP013-MESSAGE-TEXT (1)      08699071
087000              MOVE SQLCA           TO DP013-SQLCA                 08700071
087010              MOVE 'SUT_OTBND_UPC' TO DP013-DB2-TABLE-NAME (1)    08701071
087020              MOVE 'SUT_OTBND_CART' TO DP013-DB2-TABLE-NAME (2)   08702071
087030              MOVE 'TRECITM'       TO DP013-DB2-TABLE-NAME (3)    08703071
087040              SET DP013-DB2-ABEND  TO TRUE                        08704071
087050              PERFORM DP013-0000-PROCESS-ABEND                    08705071
087060     END-EVALUATE.                                                08706071
087070                                                                  08707071
087080 3347-CHECKED-IN-CARTONS.                                         08708071
087090                                                                  08709071
087100     EXEC SQL                                                     08710071
087110       SELECT DISTINCT (B.SHIPT_UNT_ID)                           08711071
087120         INTO :SUT00024-SHIPT-UNT-ID                              08712071
087130         FROM SUT_OTBND_UPC A                                     08713071
087140            , SUT_OTBND_CART B                                    08714071
087150        WHERE  A.SHIPT_UNT_ID     = B.SHIPT_UNT_ID                08715071
087160          AND  A.TRN_NBR            = :ASC-PO-NBR                 08716071
087170          AND  A.RCVR_SEQ_NBR       = :ASC-REC-SEQ-NBR            08717071
087180          AND  A.TRN_LNE_NBR        = :DK-LINE-NBR                08718071
087190          AND  B.CART_SRC_CDE       =  'ASN'                      08719071
087200          AND  B.ACTV_IND           = 'Y'                         08720071
087210     END-EXEC.                                                    08721071
087220                                                                  08722071
087230     EVALUATE TRUE                                                08723071
087240         WHEN SQLCODE = ZERO                                      08724071
087250         WHEN SQLCODE = -811                                      08725071
087260              MOVE  PC-TSYMSG-03409  TO  DP020-MSG-NUMBER         08726071
087270              SET DP020-MSG-INFORMATIONAL                         08727071
087280                  PS-ERROR                                        08728071
087290                  PS-SOFT-ABORT-ERROR       TO TRUE               08729071
087300         WHEN SQLCODE = +100                                      08730071
087310              CONTINUE                                            08731071
087320         WHEN SQLCODE = -904                                      08732071
087330         WHEN SQLCODE = -911                                      08733071
087340         WHEN SQLCODE = -913                                      08734071
087350                                                                  08735071
087360              MOVE SQLCODE                   TO PV-SOFT-SQLCODE   08736071
087370              MOVE '3347-CHECKED-IN-CARTONS' TO PV-SOFT-PARAGRAPH 08737071
087380              MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2 08738071
087390              MOVE LENGTH OF PV-CICS-MSG-AREA2                    08739071
087400                TO PV-COMMAREA-LENGTH                             08740071
087410              EXEC CICS                                           08741071
087420                  WRITEQ TD                                       08742071
087430                   QUEUE  ('CSSL')                                08743071
087440                    FROM  (PV-CICS-MSG-AREA2)                     08744071
087450                  LENGTH  (PV-COMMAREA-LENGTH)                    08745071
087460                    RESP  (PV-CICS-RESP)                          08746071
087470              END-EXEC                                            08747071
087480              MOVE  PC-TSYMSG-00551  TO  DP020-MSG-NUMBER         08748071
087490              PERFORM 9900-SOFT-ABORT                             08749071
087500                                                                  08750071
087510         WHEN SQLWARN0 NOT = SPACES                               08751071
087520         WHEN SQLCODE NOT EQUAL ZERO                              08752071
087530              MOVE '3347-CHECKED-IN-CARTONS'                      08753071
087540                                   TO DP013-PARAGRAPH             08754071
087550              MOVE 'SELECT FOR DIVERTED CARTONS '                 08755071
087560                                   TO DP013-MESSAGE-TEXT (1)      08756071
087570              MOVE SQLCA           TO DP013-SQLCA                 08757071
087580              MOVE 'SUT_OTBND_UPC' TO DP013-DB2-TABLE-NAME (1)    08758071
087590              MOVE 'SUT_OTBND_CART' TO DP013-DB2-TABLE-NAME (2)   08759071
087600              MOVE 'TRECITM'       TO DP013-DB2-TABLE-NAME (3)    08760071
087610              SET DP013-DB2-ABEND  TO TRUE                        08761071
087620              PERFORM DP013-0000-PROCESS-ABEND                    08762071
087630     END-EVALUATE.                                                08763071
087640                                                                  08764071
087650                                                                  08765071
087660*----------------------------------------------------------------*08766071
087670* CHECK WHETHER DC IS CAPABLE OF HANDLING HAZMAT ITEMS           *08767071
087680*----------------------------------------------------------------*08768071
087690 3348-CHK-WTHR-HAZFACLTY.                                         08769071
087700                                                                  08770071
087710     MOVE ASC-OPER-UNT-ID  TO  DK-OPER-UNT-ID.                    08771071
087711                                                                  08771171
087712     EXEC SQL                                                     08771271
087713          SELECT  FUNC_TXT                                        08771371
087714            INTO :ASC-HAZ-FACILITY-SW                             08771471
087715            FROM  TKRPRPM                                         08771571
087716           WHERE  LOC_ID            = :DK-OPER-UNT-ID             08771671
087717             AND  INTFC_SYS_CDE     = 'KHL'                       08771771
087718             AND  SYS_PRC_FUNC_CDE  = 'P2LHAZ'                    08771871
087719             AND  FUNC_PRC_STAT_CDE = 'AC'                        08771971
087720             AND  FUNC_BEG_TMST    <=  CURRENT TIMESTAMP          08772071
087721             AND  FUNC_END_TMST    >=  CURRENT TIMESTAMP          08772171
087722           WITH UR                                                08772271
087723     END-EXEC.                                                    08772371
087724                                                                  08772471
087725     EVALUATE TRUE                                                08772571
087726                                                                  08772671
087727         WHEN SQLCODE = +0                                        08772771
087728              CONTINUE                                            08772871
087729                                                                  08772971
087730         WHEN SQLCODE = +100                                      08773071
087731              SET  ASC-HAZ-FACILITY-NO   TO  TRUE                 08773171
087732                                                                  08773271
087733         WHEN SQLCODE = -904                                      08773371
087734         WHEN SQLCODE = -913                                      08773471
087735              MOVE SQLCODE                   TO PV-SOFT-SQLCODE   08773571
087736              MOVE '3348-CHK-WTHR-HAZFACLTY' TO PV-SOFT-PARAGRAPH 08773671
087737              MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2 08773771
087738              MOVE LENGTH OF PV-CICS-MSG-AREA2                    08773871
087739                TO PV-COMMAREA-LENGTH                             08773971
087740              EXEC CICS                                           08774071
087741                   WRITEQ TD                                      08774171
087742                    QUEUE  ('CSSL')                               08774271
087743                     FROM  (PV-CICS-MSG-AREA2)                    08774371
087744                   LENGTH  (PV-COMMAREA-LENGTH)                   08774471
087745                     RESP  (PV-CICS-RESP)                         08774571
087746              END-EXEC                                            08774671
087747                                                                  08774771
087748         WHEN SQLWARN0 NOT = SPACES                               08774871
087749         WHEN SQLCODE < +0                                        08774971
087750         WHEN SQLCODE > +0                                        08775071
087751              MOVE '3348-CHK-WTHR-HAZFACLTY'                      08775171
087752                                 TO DP013-PARAGRAPH               08775271
087753              MOVE 'CHECK WHTHR DC IS HAZMAT CAPABLE'             08775371
087754                                 TO DP013-MESSAGE-TEXT (1)        08775471
087755              MOVE SQLCA         TO DP013-SQLCA                   08775571
087756              MOVE 'TKRPRPM'     TO DP013-DB2-TABLE-NAME (1)      08775671
087757              SET DP013-DB2-ABEND                                 08775771
087758                  DP013-XCTL-DISPLAY-RESTART                      08775871
087759                                 TO TRUE                          08775971
087760              PERFORM DP013-0000-PROCESS-ABEND                    08776071
087761     END-EVALUATE.                                                08776171
087762                                                                  08776271
087763                                                                  08776371
087764*-----------------------------------------------------------------08776471
087765*                                                                 08776571
087766*-----------------------------------------------------------------08776671
087767 3350-CHECK-LINE-STATUS.                                          08776771
087768                                                                  08776871
087769     PERFORM 4140-OPEN-ONE-LN-CURSOR.                             08776971
087770     PERFORM 4145-FETCH-ONE-LN-CSR.                               08777071
087780     PERFORM 4150-CLOSE-ONE-LN-CURSOR.                            08778071
087790                                                                  08779071
087800     MOVE  SPACES                TO  PV-LINE-STATUS               08780071
087810     PERFORM 4315-GET-LINE-STATUS                                 08781071
087820                                                                  08782071
087830     MOVE  PV-LINE-STATUS        TO ASC-LINE-STATUS               08783071
087840                                    (ASC-BLK-SUB ASC-ITEM-SUB).   08784071
087850                                                                  08785071
087860                                                                  08786071
087870*-----------------------------------------------------------------08787071
087880*                                                                 08788071
087890*-----------------------------------------------------------------08789071
087900 3355-CHECK-TRANSCRIBED.                                          08790071
087910                                                                  08791071
087920     MOVE ASC-PO-LNE-NBR (ASC-BLK-SUB ASC-ITEM-SUB)               08792071
087930                   TO  DK-LINE-NBR.                               08793071
087940     MOVE  ZEROES  TO  PV-RECDIS-COUNT.                           08794071
087950     MOVE  ZEROES  TO  PV-RECDIS-ORD-NBR.                         08795071
087960                                                                  08796071
087970     EXEC SQL                                                     08797071
087980         SELECT ORD_NBR                                           08798071
087990           INTO :PV-RECDIS-ORD-NBR                                08799071
088000           FROM TRECDIS                                           08800071
088001          WHERE ORD_NBR      =  :ASC-PO-NBR                       08800171
088002            AND REC_SEQ_NBR  =  :ASC-REC-SEQ-NBR                  08800271
088003            AND ORD_LNE_NBR  =  :DK-LINE-NBR                      08800371
088004          FETCH FIRST 1 ROW ONLY                                  08800471
088005     END-EXEC                                                     08800571
088006                                                                  08800671
088007     EVALUATE TRUE                                                08800771
088008         WHEN SQLCODE = +0                                        08800871
088009         WHEN SQLCODE = +100                                      08800971
088010             CONTINUE                                             08801071
088020         WHEN SQLCODE = -904                                      08802071
088030         WHEN SQLCODE = -911                                      08803071
088040         WHEN SQLCODE = -913                                      08804071
088050             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    08805071
088060             MOVE '3355-CHECK-TRANSCRIBED'  TO PV-SOFT-PARAGRAPH  08806071
088070             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  08807071
088080             MOVE LENGTH OF PV-CICS-MSG-AREA2                     08808071
088090               TO PV-COMMAREA-LENGTH                              08809071
088100             EXEC CICS                                            08810071
088110                  WRITEQ TD                                       08811071
088120                   QUEUE  ('CSSL')                                08812071
088130                    FROM  (PV-CICS-MSG-AREA2)                     08813071
088140                  LENGTH  (PV-COMMAREA-LENGTH)                    08814071
088150                    RESP  (PV-CICS-RESP)                          08815071
088160             END-EXEC                                             08816071
088170             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          08817071
088180             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              08818071
088190             PERFORM 9900-SOFT-ABORT                              08819071
088200         WHEN SQLWARN0 NOT = SPACES                               08820071
088210         WHEN SQLCODE < ZERO                                      08821071
088220         WHEN SQLCODE > ZERO                                      08822071
088230             MOVE '3355-CHECK-TRANSCRIBED'                        08823071
088240                               TO DP013-PARAGRAPH                 08824071
088250             MOVE 'COUNT NUMBER OF RECDIS ROWS    '               08825071
088260                               TO DP013-MESSAGE-TEXT (1)          08826071
088270             MOVE SQLCA        TO DP013-SQLCA                     08827071
088280             MOVE 'TRECDIS'    TO DP013-DB2-TABLE-NAME (1)        08828071
088290             SET DP013-DB2-ABEND                                  08829071
088300                 DP013-XCTL-DISPLAY-RESTART                       08830071
088310                               TO TRUE                            08831071
088320             PERFORM DP013-0000-PROCESS-ABEND                     08832071
088330     END-EVALUATE.                                                08833071
088340                                                                  08834071
088350     IF  PV-RECDIS-ORD-NBR  >  +0                                 08835071
088360         CONTINUE                                                 08836071
088370     ELSE                                                         08837071
088380         IF  ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)           08838071
088390             MOVE PC-TSYMSG-02528   TO DP020-MSG-NUMBER           08839071
088400             SET DP020-MSG-FATAL    TO TRUE                       08840071
088410             MOVE -1                TO MR-SELECTL(PV-SUB)         08841071
088420             SET DP030-SET-CURSOR-APPL-1                          08842071
088430                                    TO TRUE                       08843071
088440             MOVE DP015-RED         TO MR-MODC (PV-SUB)           08844071
088450             MOVE DP015-REVERSE     TO MR-MODH (PV-SUB)           08845071
088460             SET PS-ERROR                                         08846071
088470                 PS-BLOCK-ERROR      TO  TRUE                     08847071
088480         END-IF                                                   08848071
088490     END-IF.                                                      08849071
088500                                                                  08850071
088510                                                                  08851071
088520*-----------------------------------------------------------------08852071
088530*                                                                 08853071
088540*-----------------------------------------------------------------08854071
088550 3357-CHECK-DUMMY-TRIP.                                           08855071
088560                                                                  08856071
088570     EXEC SQL                                                     08857071
088580         SELECT C.VEH_NBR                                         08858071
088590               ,C.TRIP_ID                                         08859071
088600           INTO :VHTRIP-VEH-NBR  :PV-NULL-IND-3                   08860071
088610               ,:VHTRIP-TRIP-ID                                   08861071
088620           FROM TSHPTPO A                                         08862071
088630               ,TSHIPMT B                                         08863071
088640               ,TVHTRIP C                                         08864071
088650          WHERE A.PO_NBR       =  :ASC-PO-NBR                     08865071
088660            AND A.REC_SEQ_NBR  =  :ASC-REC-SEQ-NBR                08866071
088670            AND A.SHIPT_ID     =  B.SHIPT_ID                      08867071
088680            AND B.TRIP_ID      =  C.TRIP_ID                       08868071
088690            AND A.PRIM_SHIPT_IND = 'Y'                            08869071
088700     END-EXEC                                                     08870071
088710                                                                  08871071
088720     EVALUATE TRUE                                                08872071
088730         WHEN SQLCODE = +0                                        08873071
088740             IF  PV-NULL-IND-3  =  -1                             08874071
088750                 SET PS-DUMMY-TRIP-YES  TO  TRUE                  08875071
088760             ELSE                                                 08876071
088770                 PERFORM 3358-CHECK-TRAILER-ARRIVED               08877071
088780             END-IF                                               08878071
088790         WHEN SQLCODE = -904                                      08879071
088800         WHEN SQLCODE = -911                                      08880071
088810         WHEN SQLCODE = -913                                      08881071
088820             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    08882071
088830             MOVE '3357-DUMMY-TRIP'         TO PV-SOFT-PARAGRAPH  08883071
088840             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  08884071
088850             MOVE LENGTH OF PV-CICS-MSG-AREA2                     08885071
088860               TO PV-COMMAREA-LENGTH                              08886071
088870             EXEC CICS                                            08887071
088880                  WRITEQ TD                                       08888071
088890                   QUEUE  ('CSSL')                                08889071
088900                    FROM  (PV-CICS-MSG-AREA2)                     08890071
088910                  LENGTH  (PV-COMMAREA-LENGTH)                    08891071
088920                    RESP  (PV-CICS-RESP)                          08892071
088930             END-EXEC                                             08893071
088940             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          08894071
088950             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              08895071
088960             PERFORM 9900-SOFT-ABORT                              08896071
088970         WHEN SQLWARN0 NOT = SPACES                               08897071
088980         WHEN SQLCODE < ZERO                                      08898071
088990         WHEN SQLCODE > ZERO                                      08899071
089000             MOVE '3357-CHECK-DUMMY-TRIP '                        08900071
089010                               TO DP013-PARAGRAPH                 08901071
089020             MOVE 'CHECK DUMMY TRIP               '               08902071
089030                               TO DP013-MESSAGE-TEXT (1)          08903071
089040             MOVE SQLCA        TO DP013-SQLCA                     08904071
089050             MOVE 'TSHPTPO'    TO DP013-DB2-TABLE-NAME (1)        08905071
089060             MOVE 'TSHIPMT'    TO DP013-DB2-TABLE-NAME (2)        08906071
089070             MOVE 'TVHTRIP'    TO DP013-DB2-TABLE-NAME (3)        08907071
089080             SET DP013-DB2-ABEND                                  08908071
089090                 DP013-XCTL-DISPLAY-RESTART                       08909071
089100                               TO TRUE                            08910071
089110             PERFORM DP013-0000-PROCESS-ABEND                     08911071
089120     END-EVALUATE.                                                08912071
089130                                                                  08913071
089140                                                                  08914071
089150 3358-CHECK-TRAILER-ARRIVED.                                      08915071
089160     SET  PS-TRAILER-ARRIVED-NO   TO  TRUE                        08916071
089170                                                                  08917071
089180     EXEC SQL                                                     08918071
089190         SELECT  TRIP_STATUS_CDE                                  08919071
089200               , STATUS_DTE                                       08920071
089210           INTO :TRIPST-TRIP-STATUS-CDE                           08921071
089220              , :TRIPST-STATUS-DTE                                08922071
089230           FROM  TTRIPST                                          08923071
089240          WHERE  TRIP_ID          =  :VHTRIP-TRIP-ID              08924071
089250            AND  TRIP_STATUS_CDE  =  'AR'                         08925071
089260     END-EXEC                                                     08926071
089270                                                                  08927071
089280     EVALUATE TRUE                                                08928071
089290         WHEN SQLCODE = +0                                        08929071
089300              SET  PS-TRAILER-ARRIVED-YES TO TRUE                 08930071
089310              MOVE TRIPST-STATUS-DTE TO ASC-TRIP-ARRIVE-DATE      08931071
089320         WHEN SQLCODE = +100                                      08932071
089330              SET  PS-TRAILER-ARRIVED-NO  TO TRUE                 08933071
089340              MOVE '9999-99-99'           TO ASC-TRIP-ARRIVE-DATE 08934071
089350         WHEN SQLCODE = -904                                      08935071
089360         WHEN SQLCODE = -911                                      08936071
089370         WHEN SQLCODE = -913                                      08937071
089380              MOVE '9999-99-99'           TO ASC-TRIP-ARRIVE-DATE 08938071
089390             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    08939071
089400             MOVE '3358-CHECK-ARRIVED'      TO PV-SOFT-PARAGRAPH  08940071
089410             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  08941071
089420             MOVE LENGTH OF PV-CICS-MSG-AREA2                     08942071
089430               TO PV-COMMAREA-LENGTH                              08943071
089440             EXEC CICS                                            08944071
089450                  WRITEQ TD                                       08945071
089460                   QUEUE  ('CSSL')                                08946071
089470                    FROM  (PV-CICS-MSG-AREA2)                     08947071
089480                  LENGTH  (PV-COMMAREA-LENGTH)                    08948071
089490                    RESP  (PV-CICS-RESP)                          08949071
089500             END-EXEC                                             08950071
089510             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          08951071
089520             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              08952071
089530             PERFORM 9900-SOFT-ABORT                              08953071
089540         WHEN SQLWARN0 NOT = SPACES                               08954071
089550         WHEN SQLCODE < ZERO                                      08955071
089560         WHEN SQLCODE > ZERO                                      08956071
089570             MOVE '3358-CHECK-ARRIVED    '                        08957071
089580                               TO DP013-PARAGRAPH                 08958071
089590             MOVE 'CHECK IF TRAILER ARRIVED       '               08959071
089600                               TO DP013-MESSAGE-TEXT (1)          08960071
089610             MOVE SQLCA        TO DP013-SQLCA                     08961071
089620             MOVE 'TTRIPST'    TO DP013-DB2-TABLE-NAME (1)        08962071
089630             SET DP013-DB2-ABEND                                  08963071
089640                 DP013-XCTL-DISPLAY-RESTART                       08964071
089650                               TO TRUE                            08965071
089660             PERFORM DP013-0000-PROCESS-ABEND                     08966071
089670     END-EVALUATE.                                                08967071
089680                                                                  08968071
089690                                                                  08969071
089700*----------------------------------------------------------------*08970071
089710* VALIDATE LABEL CREATE OPTION BY LINE FIELD                     *08971071
089720*----------------------------------------------------------------*08972071
089730 3360-CHECK-LBL-CREATE-OPT.                                       08973071
089740     IF  ASC-LNE-CRE-LBL-OPT-VALID (ASC-BLK-SUB ASC-ITEM-SUB)     08974071
089750         PERFORM 3370-VALIDATE-CSEPK-AREA                         08975071
089760     ELSE                                                         08976071
089770         IF  ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)           08977071
089780             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           08978071
089790             SET DP020-MSG-FATAL    TO TRUE                       08979071
089800             MOVE -1                TO MR-CRE-LBL-OPTL(PV-SUB)    08980071
089810             SET DP030-SET-CURSOR-APPL-1                          08981071
089820                                    TO TRUE                       08982071
089830             MOVE DP015-RED         TO MR-CRE-LBL-OPTC (PV-SUB)   08983071
089840             MOVE DP015-REVERSE     TO MR-CRE-LBL-OPTH(PV-SUB)    08984071
089850             SET PS-ERROR                                         08985071
089860                 PS-BLOCK-ERROR      TO  TRUE                     08986071
089870         END-IF                                                   08987071
089880     END-IF.                                                      08988071
089890                                                                  08989071
089900                                                                  08990071
089910*----------------------------------------------------------------*08991071
089920* VALIDATE DC IS SET UP TO PROCESS P2L                           *08992071
089930*----------------------------------------------------------------*08993071
089940 3365-CHECK-DC-P2L-MODULES.                                       08994071
089950                                                                  08995071
089960     MOVE ASC-OPER-UNT-ID  TO  DK-OPER-UNT-ID-4.                  08996071
089970     MOVE PC-0001          TO  DK-FCLTY-ID.                       08997071
089980     MOVE ZEROES           TO  PV-P2LMOD-OPER-UNT-ID              08998071
089990                                                                  08999071
090000     EXEC SQL                                                     09000071
090001         SELECT  OPER_UNT_ID                                      09000171
090002           INTO  :PV-P2LMOD-OPER-UNT-ID                           09000271
090003           FROM  TP2LMOD                                          09000371
090004          WHERE  OPER_UNT_ID = :DK-OPER-UNT-ID-4                  09000471
090005            AND  FCLTY_ID    = :DK-FCLTY-ID                       09000571
090006          FETCH FIRST 1 ROW ONLY                                  09000671
090007     END-EXEC.                                                    09000771
090008                                                                  09000871
090009     EVALUATE TRUE                                                09000971
090010         WHEN SQLCODE = +0                                        09001071
090020         WHEN SQLCODE = +100                                      09002071
090030              IF  ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)      09003071
090040                  IF  PV-P2LMOD-OPER-UNT-ID   >  0                09004071
090050                      CONTINUE                                    09005071
090060                  ELSE                                            09006071
090070                      INITIALIZE  PV-CICS-MSG-AREA2               09007071
090080                      STRING ' PCKCS701 - ' DELIMITED BY SIZE     09008071
090090                             ' 3365-CHECK-DC-P2L-MODULES '        09009071
090100                                            DELIMITED BY SIZE     09010071
090110                                          INTO PV-CICS-MSG-AREA2  09011071
090120                      MOVE LENGTH OF PV-CICS-MSG-AREA2            09012071
090130                        TO PV-COMMAREA-LENGTH                     09013071
090140                      EXEC CICS                                   09014071
090150                           WRITEQ TD                              09015071
090160                            QUEUE  ('CSSL')                       09016071
090170                             FROM  (PV-CICS-MSG-AREA2)            09017071
090180                           LENGTH  (PV-COMMAREA-LENGTH)           09018071
090190                             RESP  (PV-CICS-RESP)                 09019071
090200                      END-EXEC                                    09020071
090210                      INITIALIZE  PV-CICS-MSG-AREA2               09021071
090220                      MOVE DK-OPER-UNT-ID-4                       09022071
090230                        TO  PV-DISPLAY-OPER                       09023071
090240                      MOVE DK-FCLTY-ID                            09024071
090250                        TO  PV-DISPLAY-FCLTY                      09025071
090260                      STRING ' PCKCS701 - '   DELIMITED BY SIZE   09026071
090270                             ' OPER-'         DELIMITED BY SIZE   09027071
090280                             PV-DISPLAY-OPER  DELIMITED BY SIZE   09028071
090290                             ' FCLTY-'        DELIMITED BY SIZE   09029071
090300                             PV-DISPLAY-FCLTY DELIMITED BY SIZE   09030071
090310                                          INTO PV-CICS-MSG-AREA2  09031071
090320                      MOVE LENGTH OF PV-CICS-MSG-AREA2            09032071
090330                        TO PV-COMMAREA-LENGTH                     09033071
090340                      EXEC CICS                                   09034071
090350                           WRITEQ TD                              09035071
090360                            QUEUE  ('CSSL')                       09036071
090370                             FROM  (PV-CICS-MSG-AREA2)            09037071
090380                           LENGTH  (PV-COMMAREA-LENGTH)           09038071
090390                             RESP  (PV-CICS-RESP)                 09039071
090400                      END-EXEC                                    09040071
090410                      MOVE PC-TSYMSG-02538   TO DP020-MSG-NUMBER  09041071
090420                      SET DP020-MSG-FATAL    TO TRUE              09042071
090430                      MOVE -1          TO MR-CRE-LBL-OPTL(PV-SUB) 09043071
090440                      SET DP030-SET-CURSOR-APPL-1                 09044071
090450                                             TO TRUE              09045071
090460                      MOVE DP015-RED  TO MR-CRE-LBL-OPTC (PV-SUB) 09046071
090470                      MOVE DP015-REVERSE                          09047071
090480                                      TO MR-CRE-LBL-OPTH(PV-SUB)  09048071
090490                      SET PS-ERROR                                09049071
090500                          PS-BLOCK-ERROR     TO  TRUE             09050071
090510                  END-IF                                          09051071
090520              END-IF                                              09052071
090530         WHEN SQLWARN0 NOT = +0                                   09053071
090540         WHEN SQLCODE < +0                                        09054071
090550         WHEN SQLCODE > +0                                        09055071
090560              MOVE '3365-CHECK-DC-P2L-MODULES'                    09056071
090570                              TO DP013-PARAGRAPH                  09057071
090580              MOVE 'UNSUCCESSFUL COUNT FOR DC P2L MODULES'        09058071
090590                              TO DP013-MESSAGE-TEXT (1)           09059071
090600              MOVE SQLCA      TO DP013-SQLCA                      09060071
090610              MOVE 'TP2LMOD ' TO DP013-DB2-TABLE-NAME (1)         09061071
090620              SET DP013-DB2-ABEND                                 09062071
090630                  DP013-XCTL-DISPLAY-RESTART  TO  TRUE            09063071
090640          PERFORM DP013-0000-PROCESS-ABEND                        09064071
090650     END-EVALUATE.                                                09065071
090660                                                                  09066071
090670                                                                  09067071
090680*----------------------------------------------------------------*09068071
090690* VALIDATE CASEPACK PROCESS AREA                                 *09069071
090700*----------------------------------------------------------------*09070071
090710 3370-VALIDATE-CSEPK-AREA.                                        09071071
090720                                                                  09072071
090730     IF  ASC-LNE-CRE-BOTH-LBL (ASC-BLK-SUB ASC-ITEM-SUB) OR       09073071
090740         ASC-LNE-CRE-SML-LBL (ASC-BLK-SUB ASC-ITEM-SUB)           09074071
090750         IF  ASC-LNE-FCSE-AREA(ASC-BLK-SUB ASC-ITEM-SUB) > SPACE  09075071
090760             PERFORM 3375-CHECK-FCLTY-AREA                        09076071
090770         SET ASC-CRE-LBL-UPDT  (ASC-BLK-SUB ASC-ITEM-SUB)         09077071
090780             TO TRUE                                              09078071
090790         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             09079071
090800             IF  ASC-LBL-TYP-NONE (ASC-BLK-SUB ASC-ITEM-SUB)      09080071
090810                 IF  ASC-PGYBCK-PRTR-ID  >  SPACES  AND           09081071
090820                     ASC-LBL-PRT-STR-ORD                          09082071
090830                     SET  ASC-LBL-TYP-PGYBK                       09083071
090840                          (ASC-BLK-SUB ASC-ITEM-SUB)              09084071
090850                          ASC-CRE-LBL-UPDT                        09085071
090860                          (ASC-BLK-SUB ASC-ITEM-SUB)              09086071
090870                                           TO TRUE                09087071
090880                 ELSE                                             09088071
090890                     SET  ASC-LBL-TYP-SML                         09089071
090900                          (ASC-BLK-SUB ASC-ITEM-SUB)              09090071
090910                          ASC-CRE-LBL-UPDT                        09091071
090920                          (ASC-BLK-SUB ASC-ITEM-SUB)              09092071
090930                                           TO TRUE                09093071
090940                 END-IF                                           09094071
090950             END-IF                                               09095071
090960         ELSE                                                     09096071
090970         IF  ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)           09097071
090980             MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER           09098071
090990             SET DP020-MSG-FATAL    TO TRUE                       09099071
091000             MOVE -1                TO MR-CSEPK-AREAL(PV-SUB)     09100071
091010             SET DP030-SET-CURSOR-APPL-1                          09101071
091020                                    TO TRUE                       09102071
091030             MOVE DP015-RED         TO MR-CSEPK-AREAC (PV-SUB)    09103071
091040             MOVE DP015-REVERSE     TO MR-CSEPK-AREAH(PV-SUB)     09104071
091050             SET PS-ERROR                                         09105071
091060                 PS-BLOCK-ERROR      TO  TRUE                     09106071
091070         END-IF                                                   09107071
091080         END-IF                                                   09108071
091090     ELSE                                                         09109071
091100     IF  ASC-LNE-CRE-P2L-LBL (ASC-BLK-SUB ASC-ITEM-SUB)           09110071
091110         IF  ASC-LNE-FCSE-AREA(ASC-BLK-SUB ASC-ITEM-SUB) > SPACE  09111071
091120             PERFORM 3375-CHECK-FCLTY-AREA                        09112071
091130         END-IF                                                   09113071
091140                                                                  09114071
091150         IF  ASC-LBL-TYP-NONE (ASC-BLK-SUB ASC-ITEM-SUB)          09115071
091160             IF  ASC-DO-NOT-PRINT-SML  OR                         09116071
091170                 ASC-DO-NOT-PRINT-PGYBK                           09117071
091180                 SET ASC-LNE-DO-NOT-PRT-LBL                       09118071
091190                     (ASC-BLK-SUB ASC-ITEM-SUB)  TO  TRUE         09119071
091200             END-IF                                               09120071
091210         END-IF                                                   09121071
091220                                                                  09122071
091230         SET ASC-IN-PAK-CONVEY-NO (ASC-BLK-SUB ASC-ITEM-SUB)      09123071
091240             TO TRUE                                              09124071
091250         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             09125071
091260     END-IF                                                       09126071
091270     END-IF.                                                      09127071
091280                                                                  09128071
091290                                                                  09129071
091300*----------------------------------------------------------------*09130071
091310* VALIDATE FULLCASE PROCESS AREA AGAINST 'TFLAREA' TABLE         *09131071
091320*----------------------------------------------------------------*09132071
091330 3375-CHECK-FCLTY-AREA.                                           09133071
091340     IF  ASC-TEST-AT-CORPORATE-DC                                 09134071
091350         MOVE ASC-CURR-OPER-UNT-ID  TO DK-OPER-UNT-ID-2           09135071
091360     ELSE                                                         09136071
091370         MOVE ASC-OPER-UNT-ID       TO DK-OPER-UNT-ID-2           09137071
091380     END-IF.                                                      09138071
091390                                                                  09139071
091400     MOVE  ASC-FCLTY-ID             TO DK-FCLTY-ID.               09140071
091410     MOVE ASC-LNE-FCSE-AREA(ASC-BLK-SUB ASC-ITEM-SUB)             09141071
091420       TO PV-FCSE-AREA-ID.                                        09142071
091430                                                                  09143071
091440     EXEC SQL                                                     09144071
091450          SELECT FCLTY_AREA_ID                                    09145071
091460           INTO :FLAREA-FCLTY-AREA-ID                             09146071
091470           FROM  TFLAREA                                          09147071
091480          WHERE  OPER_UNT_ID       = :DK-OPER-UNT-ID-2            09148071
091490            AND  FCLTY_ID          = :DK-FCLTY-ID                 09149071
091500            AND  FCLTY_LOC_TYP_CDE = 'PA'                         09150071
091510            AND  FCLTY_AREA_ID     = :PV-FCSE-AREA-ID             09151071
091520     END-EXEC.                                                    09152071
091530                                                                  09153071
091540     EVALUATE TRUE                                                09154071
091550         WHEN SQLCODE = +0                                        09155071
091560              CONTINUE                                            09156071
091570         WHEN SQLCODE = +100                                      09157071
091580              IF  ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)      09158071
091590                  MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER        09159071
091600                  SET  DP020-MSG-FATAL TO TRUE                    09160071
091610                  MOVE -1              TO MR-CSEPK-AREAL(PV-SUB)  09161071
091620                  SET  DP030-SET-CURSOR-APPL-1                    09162071
091630                                       TO TRUE                    09163071
091640                  MOVE DP015-RED       TO MR-CSEPK-AREAC (PV-SUB) 09164071
091650                  MOVE DP015-REVERSE   TO MR-CSEPK-AREAH(PV-SUB)  09165071
091660                  SET  PS-ERROR                                   09166071
091670                       PS-BLOCK-ERROR  TO  TRUE                   09167071
091680              END-IF                                              09168071
091690         WHEN SQLCODE = -904                                      09169071
091700         WHEN SQLCODE = -911                                      09170071
091710         WHEN SQLCODE = -913                                      09171071
091720                                                                  09172071
091730             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    09173071
091740             MOVE '3375-CHECK-FCLTY-AREA'   TO PV-SOFT-PARAGRAPH  09174071
091750             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  09175071
091760             MOVE LENGTH OF PV-CICS-MSG-AREA2                     09176071
091770               TO PV-COMMAREA-LENGTH                              09177071
091780             EXEC CICS                                            09178071
091790                  WRITEQ TD                                       09179071
091800                   QUEUE  ('CSSL')                                09180071
091810                    FROM  (PV-CICS-MSG-AREA2)                     09181071
091820                  LENGTH  (PV-COMMAREA-LENGTH)                    09182071
091830                    RESP  (PV-CICS-RESP)                          09183071
091840             END-EXEC                                             09184071
091850                                                                  09185071
091860              MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER         09186071
091870              SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE             09187071
091880              PERFORM 9900-SOFT-ABORT                             09188071
091890         WHEN OTHER                                               09189071
091900              MOVE '3375-CHECK-FCLTY-AREA '                       09190071
091910                               TO DP013-PARAGRAPH                 09191071
091920              MOVE 'VALIDATE PROCESS AREA   '                     09192071
091930                               TO DP013-MESSAGE-TEXT (1)          09193071
091940              MOVE SQLCA       TO DP013-SQLCA                     09194071
091950              MOVE 'TFLAREA '  TO DP013-DB2-TABLE-NAME (1)        09195071
091960              SET DP013-DB2-ABEND                                 09196071
091970                  DP013-XCTL-DISPLAY-RESTART                      09197071
091980                                   TO TRUE                        09198071
091990                  PERFORM DP013-0000-PROCESS-ABEND                09199071
092000     END-EVALUATE.                                                09200071
092010                                                                  09201071
092020                                                                  09202071
092030*----------------------------------------------------------------*09203071
092040* VALIDATE FULLCASE PROCESS AREA AGAINST 'TFLAREA' TABLE         *09204071
092050*----------------------------------------------------------------*09205071
092060 3376-CHECK-FCLTY-AREA-ASC.                                       09206071
092070     IF  ASC-TEST-AT-CORPORATE-DC                                 09207071
092080         MOVE ASC-CURR-OPER-UNT-ID  TO DK-OPER-UNT-ID-2           09208071
092090     ELSE                                                         09209071
092100         MOVE ASC-OPER-UNT-ID       TO DK-OPER-UNT-ID-2           09210071
092110     END-IF.                                                      09211071
092120                                                                  09212071
092130     MOVE  ASC-FCLTY-ID             TO DK-FCLTY-ID.               09213071
092140     MOVE ASC-FCSE-AREA-ID          TO PV-FCSE-AREA-ID.           09214071
092150                                                                  09215071
092160     EXEC SQL                                                     09216071
092170          SELECT FCLTY_AREA_ID                                    09217071
092180           INTO :FLAREA-FCLTY-AREA-ID                             09218071
092190           FROM  TFLAREA                                          09219071
092200          WHERE  OPER_UNT_ID       = :DK-OPER-UNT-ID-2            09220071
092210            AND  FCLTY_ID          = :DK-FCLTY-ID                 09221071
092220            AND  FCLTY_LOC_TYP_CDE = 'PA'                         09222071
092230            AND  FCLTY_AREA_ID     = :PV-FCSE-AREA-ID             09223071
092240     END-EXEC.                                                    09224071
092250                                                                  09225071
092260     EVALUATE TRUE                                                09226071
092270         WHEN SQLCODE = +0                                        09227071
092280              CONTINUE                                            09228071
092290         WHEN SQLCODE = +100                                      09229071
092300             SET PS-ERROR                                         09230071
092310             DP020-MSG-FATAL       TO TRUE                        09231071
092320             MOVE PC-TSYMSG-01731      TO DP020-MSG-NUMBER        09232071
092330             MOVE DP015-UNP-ALP-BRT-OFF                           09233071
092340                                       TO MCSEPKA                 09234071
092350             MOVE DP015-RED            TO MCSEPKC                 09235071
092360             MOVE DP015-REVERSE        TO MCSEPKH                 09236071
092370             MOVE -1                   TO MCSEPKL                 09237071
092380             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  09238071
092390         WHEN SQLCODE = -904                                      09239071
092400         WHEN SQLCODE = -911                                      09240071
092410         WHEN SQLCODE = -913                                      09241071
092420             MOVE SQLCODE                     TO PV-SOFT-SQLCODE  09242071
092430             MOVE '3376-CHECK-FCLTY-AREA-ASC' TO PV-SOFT-PARAGRAPH09243071
092440             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  09244071
092450             MOVE LENGTH OF PV-CICS-MSG-AREA2                     09245071
092460               TO PV-COMMAREA-LENGTH                              09246071
092470             EXEC CICS                                            09247071
092480                  WRITEQ TD                                       09248071
092490                   QUEUE  ('CSSL')                                09249071
092500                    FROM  (PV-CICS-MSG-AREA2)                     09250071
092510                  LENGTH  (PV-COMMAREA-LENGTH)                    09251071
092520                    RESP  (PV-CICS-RESP)                          09252071
092530             END-EXEC                                             09253071
092540              MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER         09254071
092550              SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE             09255071
092560              PERFORM 9900-SOFT-ABORT                             09256071
092570         WHEN OTHER                                               09257071
092580              MOVE '3376-CHECK-FCLTY-AREA-ASC'                    09258071
092590                               TO DP013-PARAGRAPH                 09259071
092600              MOVE 'VALIDATE PROCESS AREA   '                     09260071
092610                               TO DP013-MESSAGE-TEXT (1)          09261071
092620              MOVE SQLCA       TO DP013-SQLCA                     09262071
092630              MOVE 'TFLAREA '  TO DP013-DB2-TABLE-NAME (1)        09263071
092640              SET DP013-DB2-ABEND                                 09264071
092650                  DP013-XCTL-DISPLAY-RESTART                      09265071
092660                                   TO TRUE                        09266071
092670                  PERFORM DP013-0000-PROCESS-ABEND                09267071
092680     END-EVALUATE.                                                09268071
092690                                                                  09269071
092700                                                                  09270071
092710*----------------------------------------------------------------*09271071
092720*  CHECK TO SEE IF LINE CAN BE RESENT TO P2L                     *09272071
092730*    - LINE NOT VERIFIED        - LINE NOT P2L PROCESSED         *09273071
092740*    - LINE MUST HAVE ALREADY BEEN SENT DOWN ONCE                *09274071
092750*----------------------------------------------------------------*09275071
092760 3380-CHECK-P2L-RESEND.                                           09276071
092770     IF  ASC-RESEND-P2L-NO (ASC-BLK-SUB ASC-ITEM-SUB)             09277071
092780         IF  ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)           09278071
092790             MOVE PC-TSYMSG-01897 TO DP020-MSG-NUMBER             09279071
092800             SET  DP020-MSG-FATAL TO TRUE                         09280071
092810             MOVE -1              TO MR-SELECTL(PV-SUB)           09281071
092820             SET ASC-P2L-RESEND-HILITE-YES                        09282071
092830                 (ASC-BLK-SUB ASC-ITEM-SUB)  TO  TRUE             09283071
092840             SET  DP030-SET-CURSOR-APPL-1                         09284071
092850                                  TO TRUE                         09285071
092860             SET  PS-BLOCK-ERROR  TO  TRUE                        09286071
092870         END-IF                                                   09287071
092880     END-IF.                                                      09288071
092890                                                                  09289071
092900                                                                  09290071
092910*----------------------------------------------------------------*09291071
092920*  IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,     *09292071
092930*  MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.   *09293071
092940*----------------------------------------------------------------*09294071
092950 3400-CHECK-RANGE-SEQUENCE.                                       09295071
092960     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       09296071
092970       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      09297071
092980       AND  ASC-START-OF-SELECTED-RANGE >                         09298071
092990                                         ASC-END-OF-SELECTED-RANGE09299071
093000*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                09300071
093010         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 09301071
093020         SET DP020-MSG-FATAL TO TRUE                              09302071
093030         SET PS-ERROR TO TRUE                                     09303071
093040         PERFORM 3410-POSITION-AT-ERROR                           09304071
093050     END-IF.                                                      09305071
093060                                                                  09306071
093070                                                                  09307071
093080*----------------------------------------------------------------*09308071
093090*  BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE     *09309071
093100*  PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR  *09310071
093110*  SHOULD BE POSITIONED ON A RANGE ERROR.                        *09311071
093120*----------------------------------------------------------------*09312071
093130 3410-POSITION-AT-ERROR.                                          09313071
093140     SET DP030-SET-CURSOR-APPL-1                                  09314071
093150                                   TO TRUE.                       09315071
093160     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 09316071
093170                    - PV-TOP-ITEM + 1.                            09317071
093180     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      09318071
093190         CONTINUE                                                 09319071
093200     ELSE                                                         09320071
093210         MOVE -1                   TO MR-SELECTL (PV-SUB)         09321071
093220         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         09322071
093230         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         09323071
093240     END-IF.                                                      09324071
093250                                                                  09325071
093260     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   09326071
093270                    - PV-TOP-ITEM + 1.                            09327071
093280     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      09328071
093290         CONTINUE                                                 09329071
093300     ELSE                                                         09330071
093310         MOVE -1                   TO MR-SELECTL (PV-SUB)         09331071
093320         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         09332071
093330         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         09333071
093340     END-IF.                                                      09334071
093350                                                                  09335071
093360                                                                  09336071
093370*----------------------------------------------------------------*09337071
093380*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *09338071
093390*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *09339071
093400*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *09340071
093410*----------------------------------------------------------------*09341071
093420 3500-MARK-RANGE-AS-SELECTED.                                     09342071
093430     MOVE +1                       TO  ASC-BLK-SUB.               09343071
093440     PERFORM 3510-MARK-SELECTED-INDS                              09344071
093450         VARYING ASC-ITEM-SUB                                     09345071
093460         FROM 1 BY 1                                              09346071
093470         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 09347071
093480                                                                  09348071
093490     ADD +1                        TO ASC-BLK-SUB.                09349071
093500     PERFORM 3510-MARK-SELECTED-INDS                              09350071
093510         VARYING ASC-ITEM-SUB                                     09351071
093520         FROM 1 BY 1                                              09352071
093530         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 09353071
093540                                                                  09354071
093550     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               09355071
093560                                   TO  PV-LIST-ITEM-NUMBER.       09356071
093570     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            09357071
093580         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         09358071
093590               PC-ITEMS-PER-PANEL).                               09359071
093600                                                                  09360071
093610     MOVE ASC-START-OF-SELECTED-RANGE                             09361071
093620                                   TO PV-START-OF-SELECTED-RANGE. 09362071
093630     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            09363071
093640         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  09364071
093650               PC-ITEMS-PER-PANEL).                               09365071
093660                                                                  09366071
093670     MOVE ASC-END-OF-SELECTED-RANGE                               09367071
093680                                   TO  PV-END-OF-SELECTED-RANGE.  09368071
093690     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             09369071
093700         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    09370071
093710               PC-ITEMS-PER-PANEL).                               09371071
093720     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             09372071
093730         PV-FIRST-BLOCK-IN-ARRAY + 1.                             09373071
093740                                                                  09374071
093750     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    09375071
093760        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        09376071
093770         MOVE +1                   TO ASC-BLK-SUB                 09377071
093780         PERFORM 5100-WRITE-TEMP-STORAGE                          09378071
093790         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         09379071
093800             PV-FIRST-BLOCK-IN-ARRAY - 1                          09380071
093810                                                                  09381071
093820         PERFORM                                                  09382071
093830             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      09383071
093840                   PV-PREV-BLOCK-IN-ARRAY                         09384071
093850             MOVE PV-FIRST-BLOCK-IN-RANGE                         09385071
093860                                   TO PV-BLOCK-NUMBER             09386071
093870             PERFORM 4410-READ-TEMP-STORAGE                       09387071
093880             PERFORM 3510-MARK-SELECTED-INDS                      09388071
093890                 VARYING ASC-ITEM-SUB                             09389071
093900                 FROM 1 BY 1                                      09390071
093910                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          09391071
093920             PERFORM 5100-WRITE-TEMP-STORAGE                      09392071
093930             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     09393071
093940         END-PERFORM                                              09394071
093950                                                                  09395071
093960         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         09396071
093970             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     09397071
093980         PERFORM                                                  09398071
093990             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       09399071
094000                   PV-LAST-BLOCK-IN-RANGE                         09400071
094010             MOVE PV-NEXT-BLOCK-IN-ARRAY                          09401071
094020                                   TO PV-BLOCK-NUMBER             09402071
094030             PERFORM 4410-READ-TEMP-STORAGE                       09403071
094040             PERFORM 3510-MARK-SELECTED-INDS                      09404071
094050                 VARYING ASC-ITEM-SUB                             09405071
094060                 FROM 1 BY 1                                      09406071
094070                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          09407071
094080             PERFORM 5100-WRITE-TEMP-STORAGE                      09408071
094090             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      09409071
094100         END-PERFORM                                              09410071
094110                                                                  09411071
094120         MOVE PV-FIRST-BLOCK-IN-ARRAY                             09412071
094130                                   TO PV-BLOCK-NUMBER             09413071
094140         PERFORM 4410-READ-TEMP-STORAGE                           09414071
094150     END-IF.                                                      09415071
094160                                                                  09416071
094170     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 09417071
094180                                      ASC-END-OF-SELECTED-RANGE.  09418071
094190                                                                  09419071
094200                                                                  09420071
094210*----------------------------------------------------------------*09421071
094220* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *09422071
094230*----------------------------------------------------------------*09423071
094240 3510-MARK-SELECTED-INDS.                                         09424071
094250                                                                  09425071
094260     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         09426071
094270                                ASC-ITEM-SUB) >                   09427071
094280         ASC-START-OF-SELECTED-RANGE)                             09428071
094290     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         09429071
094300                                ASC-ITEM-SUB) =                   09430071
094310         ASC-START-OF-SELECTED-RANGE)                             09431071
094320                                                                  09432071
094330         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     09433071
094340                                    ASC-ITEM-SUB) <               09434071
094350             ASC-END-OF-SELECTED-RANGE)                           09435071
094360         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     09436071
094370                                    ASC-ITEM-SUB) =               09437071
094380             ASC-END-OF-SELECTED-RANGE)                           09438071
094390                                                                  09439071
094400             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          09440071
094410                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   09441071
094420                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   09442071
094430                               TO TRUE                            09443071
094440                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              09444071
094450                               TO TRUE                            09445071
094460                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    09446071
094470             END-IF                                               09447071
094480         END-IF                                                   09448071
094490     END-IF.                                                      09449071
094500                                                                  09450071
094510                                                                  09451071
094520*----------------------------------------------------------------*09452071
094530* DMH - 1/23/04 - LABOR - BEGIN                                  *09453071
094540* DETERMINE DC IS INTERFACING WITH THE DC LABOR SYSTEM           *09454071
094550*----------------------------------------------------------------*09455071
094560 3600-CHECK-DC-LABOR.                                             09456071
094570                                                                  09457071
094580     MOVE ASC-OPER-UNT-ID    TO  DK-LABOR-OPER.                   09458071
094590     SET  PS-CHECK-FOR-MULT-ASGMT-NO  TO  TRUE.                   09459071
094600                                                                  09460071
094610     EXEC SQL                                                     09461071
094620          SELECT  A.FUNC_TXT                                      09462071
094630                 ,B.FUNC_TXT                                      09463071
094640            INTO  :KRPRPM-FUNC-TXT                                09464071
094650                 ,:PS-CHECK-FOR-MULT-ASGMT-SW                     09465071
094660            FROM   TKRPRPM A                                      09466071
094670                 , TKRPRPM B                                      09467071
094680           WHERE  A.LOC_ID            = :DK-LABOR-OPER            09468071
094690             AND  A.INTFC_SYS_CDE     = 'DLX'                     09469071
094700             AND  A.SYS_PRC_FUNC_CDE  = 'DLLBIN'                  09470071
094710             AND  B.LOC_ID            =  A.LOC_ID                 09471071
094720             AND  B.INTFC_SYS_CDE     = 'KHL'                     09472071
094730             AND  B.SYS_PRC_FUNC_CDE  = 'DLMLTA'                  09473071
094740             AND  B.FUNC_PRC_STAT_CDE = 'AC'                      09474071
094750             AND  B.FUNC_BEG_TMST    <=  CURRENT TIMESTAMP        09475071
094751             AND  B.FUNC_END_TMST    >=  CURRENT TIMESTAMP        09475171
094752     END-EXEC.                                                    09475271
094753                                                                  09475371
094754     EVALUATE TRUE                                                09475471
094755                                                                  09475571
094756         WHEN SQLCODE = +0                                        09475671
094757              IF  KRPRPM-FUNC-TXT  = 'Y'                          09475771
094758                  SET  ASC-DC-INTERFC-LABOR-YES TO  TRUE          09475871
094759              ELSE                                                09475971
094760                  SET  ASC-DC-INTERFC-LABOR-NO  TO  TRUE          09476071
094770              END-IF                                              09477071
094780                                                                  09478071
094790              IF  PS-CHECK-FOR-MULT-ASGMT                         09479071
094800                  SET ASC-CHECK-FOR-MULT-ASGMT  TO  TRUE          09480071
094810              ELSE                                                09481071
094820                  SET ASC-CHECK-FOR-MULT-ASGMT-NO  TO  TRUE       09482071
094830              END-IF                                              09483071
094840                                                                  09484071
094850         WHEN SQLCODE = +100                                      09485071
094851              SET  ASC-DC-INTERFC-LABOR-NO                        09485171
094852                   ASC-CHECK-FOR-MULT-ASGMT-NO  TO  TRUE          09485271
094853                                                                  09485371
094854         WHEN SQLCODE = -904                                      09485471
094855         WHEN SQLCODE = -911                                      09485571
094856         WHEN SQLCODE = -913                                      09485671
094857              MOVE SQLCODE                   TO PV-SOFT-SQLCODE   09485771
094858              MOVE '3600-CHECK-DC-LABOR'     TO PV-SOFT-PARAGRAPH 09485871
094859              MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2 09485971
094860              MOVE LENGTH OF PV-CICS-MSG-AREA2                    09486071
094870                TO PV-COMMAREA-LENGTH                             09487071
094880              EXEC CICS                                           09488071
094890                   WRITEQ TD                                      09489071
094900                    QUEUE  ('CSSL')                               09490071
094910                     FROM  (PV-CICS-MSG-AREA2)                    09491071
094920                   LENGTH  (PV-COMMAREA-LENGTH)                   09492071
094930                     RESP  (PV-CICS-RESP)                         09493071
094940              END-EXEC                                            09494071
094950             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          09495071
094960             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              09496071
094970             PERFORM 9900-SOFT-ABORT                              09497071
094980                                                                  09498071
094990         WHEN SQLWARN0 NOT = SPACES                               09499071
095000         WHEN SQLCODE < +0                                        09500071
095010         WHEN SQLCODE > +0                                        09501071
095020              MOVE '3600-CHECK-DC-LABOR'                          09502071
095030                                 TO DP013-PARAGRAPH               09503071
095040              MOVE 'CHECK IF INTERFACE WITH DC LABOR SYSTEM'      09504071
095050                                 TO DP013-MESSAGE-TEXT (1)        09505071
095060              MOVE SQLCA         TO DP013-SQLCA                   09506071
095070              MOVE 'TKRPRPM'     TO DP013-DB2-TABLE-NAME (1)      09507071
095080              SET DP013-DB2-ABEND                                 09508071
095090                  DP013-XCTL-DISPLAY-RESTART                      09509071
095100                                 TO TRUE                          09510071
095110              PERFORM DP013-0000-PROCESS-ABEND                    09511071
095120     END-EVALUATE.                                                09512071
095130                                                                  09513071
095140                                                                  09514071
095150*----------------------------------------------------------------*09515071
095160* THIS SQL WILL CHECK IF AN ASSOCIATE IS ON MULTIPLE ACTIVE      *09516071
095170* ASSIGNMENTS.  IF THE ASSOCIATE IS, NEW MODULE DLKUT028 WILL BE *09517071
095180* CALLED TO END THE ASSOCIATE ON ALL OF THE ACTIVE ASSIGNMENTS   *09518071
095190* DMH ADDED - 12-10-2008                                         *09519071
095200*----------------------------------------------------------------*09520071
095210 3603-CHECK-MULT-ASGMT.                                           09521071
095220                                                                  09522071
095230     EXEC SQL                                                     09523071
095240          SELECT  COUNT(*)                                        09524071
095241            INTO  :PV-ASGMT-COUNT                                 09524171
095242            FROM  DLT_TEM_ASGMT   A                               09524271
095243                 ,DLT_ASGMT       B                               09524371
095244           WHERE  A.KOHLS_USR_ID      = :PV-LABOR-USER-ID         09524471
095245             AND  A.LVE_RSN_CDE       = 'N'                       09524571
095246             AND  B.ASGMT_STRT_DTE    = A.ASGMT_STRT_DTE          09524671
095247             AND  B.ASGMT_NBR_TXT     = A.ASGMT_NBR_TXT           09524771
095248             AND  B.ASGMT_NBR_SEQ_NBR = A.ASGMT_NBR_SEQ_NBR       09524871
095249             AND  B.ASGMT_STP_RSN_CDE = 'N'                       09524971
095250     END-EXEC.                                                    09525071
095251                                                                  09525171
095252     EVALUATE TRUE                                                09525271
095253         WHEN SQLCODE = ZERO                                      09525371
095254              CONTINUE                                            09525471
095255                                                                  09525571
095256         WHEN SQLCODE = -911                                      09525671
095257         WHEN SQLCODE = -913                                      09525771
095258         WHEN SQLCODE = -904                                      09525871
095259                                                                  09525971
095260              MOVE SQLCODE                   TO PV-SOFT-SQLCODE   09526071
095261              MOVE '3603-CHECK-MULT-ASGMT'   TO PV-SOFT-PARAGRAPH 09526171
095262              MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2 09526271
095263              MOVE LENGTH OF PV-CICS-MSG-AREA2                    09526371
095264                TO PV-COMMAREA-LENGTH                             09526471
095265              EXEC CICS                                           09526571
095266                   WRITEQ TD                                      09526671
095267                    QUEUE  ('CSSL')                               09526771
095268                     FROM  (PV-CICS-MSG-AREA2)                    09526871
095269                   LENGTH  (PV-COMMAREA-LENGTH)                   09526971
095270                     RESP  (PV-CICS-RESP)                         09527071
095271              END-EXEC                                            09527171
095272                                                                  09527271
095273              MOVE SPACES TO PV-CICS-MSG-AREA2                    09527371
095274              MOVE ASC-PO-NBR        TO PV-DISPLAY-PO-NBR         09527471
095275              MOVE ASC-REC-SEQ-NBR   TO PV-DISPLAY-RCVR-SEQ-NBR   09527571
095276              MOVE ASC-OPER-UNT-ID   TO PV-DISPLAY-OPER           09527671
095277              STRING ' PCKCS701 -'                                09527771
095278                     PV-DISPLAY-OPER    '-'                       09527871
095279                     PV-DISPLAY-PO-NBR  '-'                       09527971
095280                     PV-DISPLAY-RCVR-SEQ-NBR '-'                  09528071
095281                     PV-LABOR-USER-ID        DELIMITED BY SIZE    09528171
095282                                        INTO PV-CICS-MSG-AREA2    09528271
095283              MOVE LENGTH OF PV-CICS-MSG-AREA2                    09528371
095284                TO PV-COMMAREA-LENGTH                             09528471
095285               EXEC CICS                                          09528571
095286                    WRITEQ TD                                     09528671
095287                     QUEUE  ('CSSL')                              09528771
095288                      FROM  (PV-CICS-MSG-AREA2)                   09528871
095289                    LENGTH  (PV-COMMAREA-LENGTH)                  09528971
095290                      RESP  (PV-CICS-RESP)                        09529071
095291              END-EXEC                                            09529171
095292                                                                  09529271
095293             MOVE SPACES TO PV-CICS-MSG-AREA2                     09529371
095294             MOVE SQLCODE          TO  PV-DISPLAY-SQLCODE         09529471
095295             STRING ' PCKCS701 -'                                 09529571
095296                  ' PARA: 3603 - '                                09529671
095297                  ' SQLCODE: '                                    09529771
095298                    PV-DISPLAY-SQLCODE                            09529871
095299                    ' COUNT NUMBER OF ASSIGNMENTS FOR ASSOCIATE'  09529971
095300                                       DELIMITED BY SIZE          09530071
095301                                  INTO PV-CICS-MSG-AREA2          09530171
095302             MOVE LENGTH OF PV-CICS-MSG-AREA2                     09530271
095303               TO PV-COMMAREA-LENGTH                              09530371
095304             EXEC CICS                                            09530471
095305                  WRITEQ TD                                       09530571
095306                   QUEUE  ('CSSL')                                09530671
095307                    FROM  (PV-CICS-MSG-AREA2)                     09530771
095308                  LENGTH  (PV-COMMAREA-LENGTH)                    09530871
095309                    RESP  (PV-CICS-RESP)                          09530971
095310             END-EXEC                                             09531071
095311                                                                  09531171
095312             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          09531271
095313             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              09531371
095314             PERFORM 9900-SOFT-ABORT                              09531471
095315                                                                  09531571
095316         WHEN SQLWARN0 NOT = SPACES                               09531671
095317         WHEN SQLCODE NOT = ZERO                                  09531771
095318              MOVE SQLCODE                   TO PV-SOFT-SQLCODE   09531871
095319              MOVE '3603-CHECK-MULT-ASGMT'   TO PV-SOFT-PARAGRAPH 09531971
095320              MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2 09532071
095321              MOVE LENGTH OF PV-CICS-MSG-AREA2                    09532171
095322                TO PV-COMMAREA-LENGTH                             09532271
095323              EXEC CICS                                           09532371
095324                   WRITEQ TD                                      09532471
095325                    QUEUE  ('CSSL')                               09532571
095326                     FROM  (PV-CICS-MSG-AREA2)                    09532671
095327                   LENGTH  (PV-COMMAREA-LENGTH)                   09532771
095328                     RESP  (PV-CICS-RESP)                         09532871
095329              END-EXEC                                            09532971
095330                                                                  09533071
095331              MOVE SPACES TO PV-CICS-MSG-AREA2                    09533171
095332              MOVE ASC-PO-NBR        TO PV-DISPLAY-PO-NBR         09533271
095333              MOVE ASC-REC-SEQ-NBR   TO PV-DISPLAY-RCVR-SEQ-NBR   09533371
095334              MOVE ASC-OPER-UNT-ID   TO PV-DISPLAY-OPER           09533471
095335              STRING ' PCKCS701 -'                                09533571
095336                     PV-DISPLAY-OPER   '-'                        09533671
095337                     PV-DISPLAY-PO-NBR '-'                        09533771
095338                     PV-DISPLAY-RCVR-SEQ-NBR '-'                  09533871
095339                     PV-LABOR-USER-ID        DELIMITED BY SIZE    09533971
095340                                        INTO PV-CICS-MSG-AREA2    09534071
095341              MOVE LENGTH OF PV-CICS-MSG-AREA2                    09534171
095342                TO PV-COMMAREA-LENGTH                             09534271
095343              EXEC CICS                                           09534371
095344                   WRITEQ TD                                      09534471
095345                    QUEUE  ('CSSL')                               09534571
095346                     FROM  (PV-CICS-MSG-AREA2)                    09534671
095347                   LENGTH  (PV-COMMAREA-LENGTH)                   09534771
095348                     RESP  (PV-CICS-RESP)                         09534871
095349              END-EXEC                                            09534971
095350                                                                  09535071
095351              MOVE SPACES TO PV-CICS-MSG-AREA2                    09535171
095352              MOVE SQLCODE          TO  PV-DISPLAY-SQLCODE        09535271
095353              STRING ' PCKCS701 -'                                09535371
095354                 ' PARA: 3603 - '                                 09535471
095355                 ' SQLCODE: '                                     09535571
095356                   PV-DISPLAY-SQLCODE                             09535671
095357                   ' COUNT NUMBER OF ASSIGNMENTS FOR ASSOCIATE'   09535771
095358                                        DELIMITED BY SIZE         09535871
095359                                   INTO PV-CICS-MSG-AREA2         09535971
095360             MOVE LENGTH OF PV-CICS-MSG-AREA2                     09536071
095361               TO PV-COMMAREA-LENGTH                              09536171
095362              EXEC CICS                                           09536271
095363                   WRITEQ TD                                      09536371
095364                    QUEUE  ('CSSL')                               09536471
095365                     FROM  (PV-CICS-MSG-AREA2)                    09536571
095366                   LENGTH  (PV-COMMAREA-LENGTH)                   09536671
095367                     RESP  (PV-CICS-RESP)                         09536771
095368              END-EXEC                                            09536871
095369                                                                  09536971
095370              MOVE '3603-CHECK-MULT-ASGMT'                        09537071
095371                                 TO DP013-PARAGRAPH               09537171
095372              MOVE 'COUNT NUMBER OF ACTIVE ASSIGNMENTS'           09537271
095373                                 TO DP013-MESSAGE-TEXT (1)        09537371
095374              MOVE SQLCA         TO DP013-SQLCA                   09537471
095375              MOVE 'TKRPRPM'     TO DP013-DB2-TABLE-NAME (1)      09537571
095376              SET DP013-DB2-ABEND                                 09537671
095377                  DP013-XCTL-DISPLAY-RESTART                      09537771
095378                                 TO TRUE                          09537871
095379              PERFORM DP013-0000-PROCESS-ABEND                    09537971
095380                                                                  09538071
095381     END-EVALUATE.                                                09538171
095382                                                                  09538271
095383                                                                  09538371
095384*----------------------------------------------------------------*09538471
095385* CALL MODULE DLKUT028 TO END ASSOCIATE OFF OF THE MULTIPLE      *09538571
095386* ASSIGNMENTS THAT THEY ARE CURRENTLY ON.                        *09538671
095387* DMH ADDED - 12-10-2008                                         *09538771
095388*----------------------------------------------------------------*09538871
095389 3605-CALL-DLKUT028.                                              09538971
095390                                                                  09539071
095391     INITIALIZE  DL024-ASGMT-COMMAREA.                            09539171
095392                                                                  09539271
095393     MOVE PV-LABOR-USER-ID        TO  DL024-KEY-USER-ID.          09539371
095394     MOVE PC-CURRENT-PROGRAM-NAME TO  DL024-ORIG-CALLING-PGM-NM.  09539471
095395     SET  DL011-RLABL-WRK-TYP     TO  TRUE.                       09539571
095396     MOVE DL011-KEY-WK-TYP        TO  DL024-KEY-WK-TYP.           09539671
095397     MOVE DL011-RLABL-WRK-AREA    TO  DL024-KEY-WK-AREA.          09539771
095398     MOVE ASC-OPER-UNT-ID         TO  DL024-KEY-DC-NBR.           09539871
095399                                                                  09539971
095400     CALL DL024-MULT-ASGMT-PGM USING DFHEIBLK                     09540071
095401                                     DL024-COMMAREA               09540171
095402                                     DL024-ASGMT-COMMAREA.        09540271
095403                                                                  09540371
095404     EVALUATE TRUE                                                09540471
095405         WHEN DL024-SUCCESSFUL                                    09540571
095406             CONTINUE                                             09540671
095407         WHEN OTHER                                               09540771
095408              MOVE ASC-OPER-UNT-ID   TO  PV-DISPLAY-OPER          09540871
095409              MOVE ASC-PO-NBR        TO  PV-DISPLAY-PO-NBR        09540971
095410              MOVE ASC-REC-SEQ-NBR   TO  PV-DISPLAY-RCVR-SEQ-NBR  09541071
095411              MOVE DL024-ASGMT-SQLCODE                            09541171
095412                                     TO  PV-DISPLAY-SQLCODE       09541271
095413              INITIALIZE PV-CICS-MSG-AREA2                        09541371
095414              STRING ' PCKCS701-3605- '                           09541471
095415                      PV-DISPLAY-OPER   '-'                       09541571
095416                      PV-DISPLAY-PO-NBR '-'                       09541671
095417                      PV-DISPLAY-RCVR-SEQ-NBR ' - '               09541771
095418                      DP020-USERID ' - '                          09541871
095419                     'SQLCODE=' PV-DISPLAY-SQLCODE                09541971
095420                     ' - RETURN CODE=' DL024-RETURN-CODE          09542071
095421                                                DELIMITED BY SIZE 09542171
095422                                           INTO PV-CICS-MSG-AREA2 09542271
095423               MOVE LENGTH OF PV-CICS-MSG-AREA2                   09542371
095424                                             TO PV-COMMAREA-LENGTH09542471
095425               EXEC CICS                                          09542571
095426                    WRITEQ TD                                     09542671
095427                     QUEUE  ('CSSL')                              09542771
095428                      FROM  (PV-CICS-MSG-AREA2)                   09542871
095429                    LENGTH  (PV-COMMAREA-LENGTH)                  09542971
095430                      RESP  (PV-CICS-RESP)                        09543071
095431               END-EXEC                                           09543171
095432                                                                  09543271
095433              INITIALIZE PV-CICS-MSG-AREA2                        09543371
095434              STRING ' PCKCS701-' DL024-MULT-ASGMT-PGM            09543471
095435                      ' -- ' DL024-CALL-MOD-FAIL-SQL-PARA         09543571
095436                      ' -- ' DL024-CALL-MOD-FAIL-NM               09543671
095437                      ' -- ' DL024-CALL-MOD-FAIL-ERR-CDE          09543771
095438                                                DELIMITED BY SIZE 09543871
095439                                           INTO PV-CICS-MSG-AREA2 09543971
095440               MOVE LENGTH OF PV-CICS-MSG-AREA2                   09544071
095441                                             TO PV-COMMAREA-LENGTH09544171
095442               EXEC CICS                                          09544271
095443                    WRITEQ TD                                     09544371
095444                     QUEUE  ('CSSL')                              09544471
095445                      FROM  (PV-CICS-MSG-AREA2)                   09544571
095446                    LENGTH  (PV-COMMAREA-LENGTH)                  09544671
095447                      RESP  (PV-CICS-RESP)                        09544771
095448               END-EXEC                                           09544871
095449                                                                  09544971
095450               MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER        09545071
095451               SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE            09545171
095452               PERFORM 9900-SOFT-ABORT                            09545271
095453                                                                  09545371
095454     END-EVALUATE.                                                09545471
095455                                                                  09545571
095456                                                                  09545671
095457*-----------------------------------------------------------------09545771
095458*  INSERT ROW INTO TUPLDER (UPLOAD ERROR) TABLE - TOO KEEP TRACK *09545871
095459*  OF WHEN MULTIPLE ASSIGNMENTS ARE OPEN FOR THE SAME WORK AREA  *09545971
095460*-----------------------------------------------------------------09546071
095461 3607-INSERT-TUPLDER.                                             09546171
095462                                                                  09546271
095463     MOVE ASC-OPER-UNT-ID              TO UPLDER-OPER-UNT-ID.     09546371
095464     MOVE 'F'                          TO UPLDER-UPLD-TRN-CDE.    09546471
095465     MOVE '101'                        TO UPLDER-ERR-CDE.         09546571
095466     MOVE  0                           TO UPLDER-UPLD-SEQ-NBR.    09546671
095467                                                                  09546771
095468     INITIALIZE  UPLDER-PKT-TXT.                                  09546871
095469     MOVE ASC-OPER-UNT-ID  TO  PV-DISPLAY-OPER                    09546971
095470     STRING   PV-DISPLAY-OPER         ' '                         09547071
095471              PV-LABOR-USER-ID        ' '                         09547171
095472              DL011-KEY-WK-TYP        ' '                         09547271
095473              DL011-RLABL-WRK-AREA    ' '                         09547371
095474             'CASEPACK SPLIT'             DELIMITED BY SIZE       09547471
095475                                     INTO UPLDER-PKT-TXT.         09547571
095476                                                                  09547671
095477     EXEC SQL                                                     09547771
095478         INSERT                                                   09547871
095479           INTO TUPLDER                                           09547971
095480             ( OPER_UNT_ID                                        09548071
095481             , UPLD_TRN_CDE                                       09548171
095482             , ERR_CDE                                            09548271
095483             , PRC_TMST                                           09548371
095484             , UPLD_SEQ_NBR                                       09548471
095485             , PKT_TXT                                            09548571
095486             )                                                    09548671
095487             VALUES                                               09548771
095488             ( :UPLDER-OPER-UNT-ID                                09548871
095489             , :UPLDER-UPLD-TRN-CDE                               09548971
095490             , :UPLDER-ERR-CDE                                    09549071
095491             ,  CURRENT TIMESTAMP                                 09549171
095492             , :UPLDER-UPLD-SEQ-NBR                               09549271
095493             , :UPLDER-PKT-TXT                                    09549371
095494             )                                                    09549471
095495     END-EXEC.                                                    09549571
095496                                                                  09549671
095497     EVALUATE TRUE                                                09549771
095498         WHEN SQLCODE = ZERO                                      09549871
095499             CONTINUE                                             09549971
095500                                                                  09550071
095501         WHEN SQLCODE = -904                                      09550171
095502         WHEN SQLCODE = -911                                      09550271
095503         WHEN SQLCODE = -913                                      09550371
095504              MOVE SQLCODE                   TO PV-SOFT-SQLCODE   09550471
095505              MOVE '3607-INSERT-TUPLDER'     TO PV-SOFT-PARAGRAPH 09550571
095506              MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2 09550671
095507              MOVE LENGTH OF PV-CICS-MSG-AREA2                    09550771
095508                TO PV-COMMAREA-LENGTH                             09550871
095509               EXEC CICS                                          09550971
095510                    WRITEQ TD                                     09551071
095511                     QUEUE  ('CSSL')                              09551171
095512                      FROM  (PV-CICS-MSG-AREA2)                   09551271
095513                    LENGTH  (PV-COMMAREA-LENGTH)                  09551371
095514                      RESP  (PV-CICS-RESP)                        09551471
095515               END-EXEC                                           09551571
095516                                                                  09551671
095517             MOVE SPACES TO PV-CICS-MSG-AREA2                     09551771
095518             MOVE DL024-KEY-DC-NBR  TO  PV-DISPLAY-OPER           09551871
095519             STRING ' PCKCS701 -'                                 09551971
095520                    PV-DISPLAY-OPER                               09552071
095521                    UPLDER-PKT-TXT           DELIMITED BY SIZE    09552171
095522                                        INTO PV-CICS-MSG-AREA2    09552271
095523             MOVE LENGTH OF PV-CICS-MSG-AREA2                     09552371
095524               TO PV-COMMAREA-LENGTH                              09552471
095525                                                                  09552571
095526             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          09552671
095527             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              09552771
095528             PERFORM 9900-SOFT-ABORT                              09552871
095529                                                                  09552971
095530         WHEN OTHER                                               09553071
095531                                                                  09553171
095532             MOVE SPACES TO PV-CICS-MSG-AREA2                     09553271
095533             MOVE DL024-KEY-DC-NBR  TO  PV-DISPLAY-OPER           09553371
095534             STRING ' PCKCS701 -'                                 09553471
095535                    PV-DISPLAY-OPER                               09553571
095536                    UPLDER-PKT-TXT           DELIMITED BY SIZE    09553671
095537                                        INTO PV-CICS-MSG-AREA2    09553771
095538             MOVE LENGTH OF PV-CICS-MSG-AREA2                     09553871
095539               TO PV-COMMAREA-LENGTH                              09553971
095540               EXEC CICS                                          09554071
095541                    WRITEQ TD                                     09554171
095542                     QUEUE  ('CSSL')                              09554271
095543                      FROM  (PV-CICS-MSG-AREA2)                   09554371
095544                    LENGTH  (PV-COMMAREA-LENGTH)                  09554471
095545                      RESP  (PV-CICS-RESP)                        09554571
095546               END-EXEC                                           09554671
095547                                                                  09554771
095548             MOVE SPACES TO PV-CICS-MSG-AREA2                     09554871
095549             MOVE SQLCODE           TO  PV-DISPLAY-SQLCODE        09554971
095550             STRING ' PCKCS701 -'                                 09555071
095551                   ' PARA: 3607-INSERT-TUPLDER'                   09555171
095552                   ' SQLCODE: '        PV-DISPLAY-SQLCODE         09555271
095553                                       DELIMITED BY SIZE          09555371
095554                                  INTO PV-CICS-MSG-AREA2          09555471
095555             MOVE LENGTH OF PV-CICS-MSG-AREA2                     09555571
095556               TO PV-COMMAREA-LENGTH                              09555671
095557               EXEC CICS                                          09555771
095558                    WRITEQ TD                                     09555871
095559                     QUEUE  ('CSSL')                              09555971
095560                      FROM  (PV-CICS-MSG-AREA2)                   09556071
095561                    LENGTH  (PV-COMMAREA-LENGTH)                  09556171
095562                      RESP  (PV-CICS-RESP)                        09556271
095563               END-EXEC                                           09556371
095564                                                                  09556471
095565              MOVE '3607-INSERT-TUPLDER'                          09556571
095566                                 TO DP013-PARAGRAPH               09556671
095567              MOVE 'INSERT TUPLDER RECORD'                        09556771
095568                                 TO DP013-MESSAGE-TEXT (1)        09556871
095569              MOVE SQLCA         TO DP013-SQLCA                   09556971
095570              MOVE 'TUPLDER'     TO DP013-DB2-TABLE-NAME (1)      09557071
095571              SET DP013-DB2-ABEND                                 09557171
095572                  DP013-XCTL-DISPLAY-RESTART                      09557271
095573                                 TO TRUE                          09557371
095574              PERFORM DP013-0000-PROCESS-ABEND                    09557471
095575     END-EVALUATE.                                                09557571
095576                                                                  09557671
095577                                                                  09557771
095578*----------------------------------------------------------------*09557871
095579* IF DC IS INTERFACING WITH THE DC LABOR SYSTEM, CHECK TO SEE    *09557971
095580* IF THE ASSOCIATE IS CURRENTLY ACTIVE ON A LABOR ASSIGNMENT.    *09558071
095581*----------------------------------------------------------------*09558171
095582 3610-CHECK-LABOR-ASGMT.                                          09558271
095583                                                                  09558371
095584     INITIALIZE  DL003-ASGMT-COMMAREA.                            09558471
095585     SET   DL003-BY-USER-KEY  TO  TRUE.                           09558571
095586     MOVE  PV-LABOR-USER-ID   TO  DL003-KEY-USER-ID.              09558671
095587     MOVE PC-CURRENT-PROGRAM-NAME                                 09558771
095588                              TO  DL003-ORIG-CALLING-PGM-NM.      09558871
095589                                                                  09558971
095590     CALL DL003-USER-PGM USING DFHEIBLK                           09559071
095591                               DL003-COMMAREA                     09559171
095592                               DL003-ASGMT-COMMAREA               09559271
095593                                                                  09559371
095594     EVALUATE TRUE                                                09559471
095595         WHEN DL003-SUCCESSFUL                                    09559571
095596             EVALUATE TRUE                                        09559671
095597                 WHEN DL003-ASGMT-FOUND                           09559771
095598                      SET ASC-ASSOC-LABOR-ASGMT-YES  TO TRUE      09559871
095599                                                                  09559971
095600                      MOVE DL003-ASGMT-START-DTE                  09560071
095601                                 TO  PV-LABOR-ASGMT-STRT-DTE      09560171
095602                      MOVE DL003-ASGMT-NBR-TXT                    09560271
095603                                 TO  PV-LABOR-ASGMT-NBR-TXT       09560371
095604                      MOVE DL003-ASGMT-NBR-SEQ-NBR                09560471
095605                                 TO  PV-LABOR-ASGMT-NBR-SEQ-NBR   09560571
095606                                                                  09560671
095607                 WHEN DL003-ASGMT-NOT-FOUND                       09560771
095608                      IF  PS-LABOR-LOG-PHY-LBL                    09560871
095609                          PERFORM 3670-CREATE-DL-DUMMY-ASGMT      09560971
095610                      ELSE                                        09561071
095611                          SET ASC-ASSOC-LABOR-ASGMT-NO            09561171
095612                                     TO TRUE                      09561271
095613                          MOVE ASC-OPER-UNT-ID                    09561371
095614                                     TO PV-DISPLAY-OPER           09561471
095615                          MOVE ASC-PO-NBR                         09561571
095616                                     TO  PV-DISPLAY-PO-NBR        09561671
095617                          MOVE ASC-REC-SEQ-NBR                    09561771
095618                                     TO  PV-DISPLAY-RCVR-SEQ-NBR  09561871
095619                          STRING ' PCKCS701-3610- '               09561971
095620                                 PV-DISPLAY-OPER   '-'            09562071
095621                                 PV-DISPLAY-PO-NBR '-'            09562171
095622                                 PV-DISPLAY-RCVR-SEQ-NBR ' - '    09562271
095623                                 DL003-KEY-USER-ID ' - '          09562371
095624                                 'NO ACTIVE ASSIGNMENT'           09562471
095625                                                DELIMITED BY SIZE 09562571
095626                                           INTO PV-CICS-MSG-AREA2 09562671
095627                          MOVE LENGTH OF PV-CICS-MSG-AREA2        09562771
095628                                             TO PV-COMMAREA-LENGTH09562871
095629                          EXEC CICS                               09562971
095630                               WRITEQ TD                          09563071
095640                                QUEUE  ('CSSL')                   09564071
095650                                 FROM  (PV-CICS-MSG-AREA2)        09565071
095660                               LENGTH  (PV-COMMAREA-LENGTH)       09566071
095670                                 RESP  (PV-CICS-RESP)             09567071
095680                          END-EXEC                                09568071
095690                      END-IF                                      09569071
095700                                                                  09570071
095710                                                                  09571071
095720                 WHEN DL003-ASGMT-MULT-FOUND                      09572071
095730                      SET ASC-ASSOC-LABOR-ASGMT-YES TO TRUE       09573071
095740                      MOVE DL003-ASGMT-START-DTE                  09574071
095750                                 TO  PV-LABOR-ASGMT-STRT-DTE      09575071
095760                      MOVE DL003-ASGMT-NBR-TXT                    09576071
095770                                 TO  PV-LABOR-ASGMT-NBR-TXT       09577071
095780                      MOVE DL003-ASGMT-NBR-SEQ-NBR                09578071
095790                                 TO  PV-LABOR-ASGMT-NBR-SEQ-NBR   09579071
095800                                                                  09580071
095810                      MOVE ASC-OPER-UNT-ID                        09581071
095820                                     TO PV-DISPLAY-OPER           09582071
095830                      MOVE ASC-PO-NBR                             09583071
095840                                     TO  PV-DISPLAY-PO-NBR        09584071
095850                      MOVE ASC-REC-SEQ-NBR                        09585071
095860                                     TO  PV-DISPLAY-RCVR-SEQ-NBR  09586071
095870                      MOVE DL003-ASGMT-FOUND-QTY                  09587071
095880                                     TO  PV-DISPLAY-LABOR-ASGMTS  09588071
095890                      INITIALIZE PV-CICS-MSG-AREA                 09589071
095900                      STRING ' PCKCS701-3610- '                   09590071
095910                              PV-DISPLAY-OPER   '-'               09591071
095920                              PV-DISPLAY-PO-NBR '-'               09592071
095930                              PV-DISPLAY-RCVR-SEQ-NBR ' - '       09593071
095940                              DL003-KEY-USER-ID ' - '             09594071
095950                              'ASGMTS='                           09595071
095960                              PV-DISPLAY-LABOR-ASGMTS             09596071
095970                                                DELIMITED BY SIZE 09597071
095980                                           INTO PV-CICS-MSG-AREA2 09598071
095990                      MOVE LENGTH OF PV-CICS-MSG-AREA2            09599071
096000                                             TO PV-COMMAREA-LENGTH09600071
096010                      EXEC CICS                                   09601071
096020                           WRITEQ TD                              09602071
096030                            QUEUE  ('CSSL')                       09603071
096040                             FROM  (PV-CICS-MSG-AREA2)            09604071
096050                           LENGTH  (PV-COMMAREA-LENGTH)           09605071
096060                             RESP  (PV-CICS-RESP)                 09606071
096070                      END-EXEC                                    09607071
096080                                                                  09608071
096090                      INITIALIZE PV-CICS-MSG-AREA2                09609071
096100                      STRING ' PCKCS701-' DL003-USER-PGM          09610071
096110                             ' -- ' DL003-SQL-ERROR-PARA          09611071
096120                             ' -- ' DL003-CALL-MOD-FAIL-NM        09612071
096130                             ' -- ' DL003-CALL-MOD-FAIL-ERR-CDE   09613071
096140                                                DELIMITED BY SIZE 09614071
096150                                           INTO PV-CICS-MSG-AREA2 09615071
096160                      MOVE LENGTH OF PV-CICS-MSG-AREA2            09616071
096170                                             TO PV-COMMAREA-LENGTH09617071
096180                      EXEC CICS                                   09618071
096190                           WRITEQ TD                              09619071
096200                            QUEUE  ('CSSL')                       09620071
096210                             FROM  (PV-CICS-MSG-AREA2)            09621071
096220                           LENGTH  (PV-COMMAREA-LENGTH)           09622071
096230                             RESP  (PV-CICS-RESP)                 09623071
096240                     END-EXEC                                     09624071
096250                                                                  09625071
096260                                                                  09626071
096270             END-EVALUATE                                         09627071
096280                                                                  09628071
096290         WHEN DL003-SQL-CONTENTION                                09629071
096300              SET ASC-ASSOC-LABOR-ASGMT-NO  TO TRUE               09630071
096310              MOVE ASC-OPER-UNT-ID   TO PV-DISPLAY-OPER           09631071
096320              MOVE ASC-PO-NBR        TO  PV-DISPLAY-PO-NBR        09632071
096330              MOVE ASC-REC-SEQ-NBR   TO  PV-DISPLAY-RCVR-SEQ-NBR  09633071
096340              MOVE DL003-ASGMT-SQLCODE                            09634071
096350                                     TO  PV-DISPLAY-SQLCODE       09635071
096360              INITIALIZE PV-CICS-MSG-AREA                         09636071
096370              STRING ' PCKCS701-3610- '                           09637071
096380                      PV-DISPLAY-OPER   '-'                       09638071
096390                      PV-DISPLAY-PO-NBR '-'                       09639071
096400                      PV-DISPLAY-RCVR-SEQ-NBR ' - '               09640071
096410                      DL003-KEY-USER-ID ' - '                     09641071
096420                     'SQLCODE=' PV-DISPLAY-SQLCODE                09642071
096430                     ' - CONTENTION'            DELIMITED BY SIZE 09643071
096440                                           INTO PV-CICS-MSG-AREA2 09644071
096450               MOVE LENGTH OF PV-CICS-MSG-AREA2                   09645071
096460                                             TO PV-COMMAREA-LENGTH09646071
096470               EXEC CICS                                          09647071
096480                    WRITEQ TD                                     09648071
096490                     QUEUE  ('CSSL')                              09649071
096500                      FROM  (PV-CICS-MSG-AREA2)                   09650071
096510                    LENGTH  (PV-COMMAREA-LENGTH)                  09651071
096520                      RESP  (PV-CICS-RESP)                        09652071
096530               END-EXEC                                           09653071
096540                                                                  09654071
096550               INITIALIZE PV-CICS-MSG-AREA2                       09655071
096560               STRING ' PCKCS701-' DL003-USER-PGM                 09656071
096570                      ' -- ' DL003-SQL-ERROR-PARA                 09657071
096580                      ' -- ' DL003-CALL-MOD-FAIL-NM               09658071
096590                      ' -- ' DL003-CALL-MOD-FAIL-ERR-CDE          09659071
096600                                                DELIMITED BY SIZE 09660071
096610                                           INTO PV-CICS-MSG-AREA2 09661071
096620               MOVE LENGTH OF PV-CICS-MSG-AREA2                   09662071
096630                                             TO PV-COMMAREA-LENGTH09663071
096640               EXEC CICS                                          09664071
096650                    WRITEQ TD                                     09665071
096660                     QUEUE  ('CSSL')                              09666071
096670                      FROM  (PV-CICS-MSG-AREA2)                   09667071
096680                    LENGTH  (PV-COMMAREA-LENGTH)                  09668071
096690                      RESP  (PV-CICS-RESP)                        09669071
096700              END-EXEC                                            09670071
096710                                                                  09671071
096720               MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER        09672071
096730               SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE            09673071
096740               PERFORM 9900-SOFT-ABORT                            09674071
096750                                                                  09675071
096760         WHEN DL003-SQL-ERROR                                     09676071
096770              SET ASC-ASSOC-LABOR-ASGMT-NO  TO TRUE               09677071
096780              MOVE ASC-OPER-UNT-ID   TO PV-DISPLAY-OPER           09678071
096790              MOVE ASC-PO-NBR        TO  PV-DISPLAY-PO-NBR        09679071
096800              MOVE ASC-REC-SEQ-NBR   TO  PV-DISPLAY-RCVR-SEQ-NBR  09680071
096810              MOVE DL003-ASGMT-SQLCODE                            09681071
096820                                     TO  PV-DISPLAY-SQLCODE       09682071
096830              INITIALIZE PV-CICS-MSG-AREA                         09683071
096840              STRING ' PCKCS701-3610- '                           09684071
096850                      PV-DISPLAY-OPER   '-'                       09685071
096860                      PV-DISPLAY-PO-NBR '-'                       09686071
096870                      PV-DISPLAY-RCVR-SEQ-NBR ' - '               09687071
096880                      DL003-KEY-USER-ID ' - '                     09688071
096890                     'SQLCODE=' PV-DISPLAY-SQLCODE                09689071
096900                     ' - SQL ERROR'             DELIMITED BY SIZE 09690071
096910                                           INTO PV-CICS-MSG-AREA2 09691071
096920               MOVE LENGTH OF PV-CICS-MSG-AREA2                   09692071
096930                                             TO PV-COMMAREA-LENGTH09693071
096940               EXEC CICS                                          09694071
096950                    WRITEQ TD                                     09695071
096960                     QUEUE  ('CSSL')                              09696071
096970                      FROM  (PV-CICS-MSG-AREA2)                   09697071
096980                    LENGTH  (PV-COMMAREA-LENGTH)                  09698071
096990                      RESP  (PV-CICS-RESP)                        09699071
097000               END-EXEC                                           09700071
097010                                                                  09701071
097020               INITIALIZE PV-CICS-MSG-AREA2                       09702071
097030               STRING ' PCKCS701-' DL003-USER-PGM                 09703071
097040                      ' -- ' DL003-SQL-ERROR-PARA                 09704071
097050                      ' -- ' DL003-CALL-MOD-FAIL-NM               09705071
097060                      ' -- ' DL003-CALL-MOD-FAIL-ERR-CDE          09706071
097070                                                DELIMITED BY SIZE 09707071
097080                                           INTO PV-CICS-MSG-AREA2 09708071
097090               MOVE LENGTH OF PV-CICS-MSG-AREA2                   09709071
097100                                             TO PV-COMMAREA-LENGTH09710071
097110               EXEC CICS                                          09711071
097120                    WRITEQ TD                                     09712071
097130                     QUEUE  ('CSSL')                              09713071
097140                      FROM  (PV-CICS-MSG-AREA2)                   09714071
097150                    LENGTH  (PV-COMMAREA-LENGTH)                  09715071
097160                      RESP  (PV-CICS-RESP)                        09716071
097170              END-EXEC                                            09717071
097180                                                                  09718071
097190               MOVE  PC-TSYMSG-00551  TO  DP020-MSG-NUMBER        09719071
097200               SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE            09720071
097210               PERFORM 9900-SOFT-ABORT                            09721071
097220                                                                  09722071
097230         WHEN DL003-CALLED-MODULE-FAILURE                         09723071
097240              SET ASC-ASSOC-LABOR-ASGMT-NO  TO TRUE               09724071
097250              MOVE ASC-OPER-UNT-ID   TO PV-DISPLAY-OPER           09725071
097260              MOVE ASC-PO-NBR        TO  PV-DISPLAY-PO-NBR        09726071
097270              MOVE ASC-REC-SEQ-NBR   TO  PV-DISPLAY-RCVR-SEQ-NBR  09727071
097280              MOVE DL003-ASGMT-SQLCODE                            09728071
097290                                     TO  PV-DISPLAY-SQLCODE       09729071
097300              INITIALIZE PV-CICS-MSG-AREA                         09730071
097310              STRING ' PCKCS701-3610- '                           09731071
097320                      PV-DISPLAY-OPER   '-'                       09732071
097330                      PV-DISPLAY-PO-NBR '-'                       09733071
097340                      PV-DISPLAY-RCVR-SEQ-NBR ' - '               09734071
097350                      DL003-KEY-USER-ID ' - '                     09735071
097360                     'SQLCODE=' PV-DISPLAY-SQLCODE                09736071
097370                     ' - CALL FAILED'           DELIMITED BY SIZE 09737071
097380                                           INTO PV-CICS-MSG-AREA2 09738071
097390               MOVE LENGTH OF PV-CICS-MSG-AREA2                   09739071
097400                                             TO PV-COMMAREA-LENGTH09740071
097410               EXEC CICS                                          09741071
097420                    WRITEQ TD                                     09742071
097430                     QUEUE  ('CSSL')                              09743071
097440                      FROM  (PV-CICS-MSG-AREA2)                   09744071
097450                    LENGTH  (PV-COMMAREA-LENGTH)                  09745071
097460                      RESP  (PV-CICS-RESP)                        09746071
097470               END-EXEC                                           09747071
097480                                                                  09748071
097490               INITIALIZE PV-CICS-MSG-AREA2                       09749071
097500               STRING ' PCKCS701-' DL003-USER-PGM                 09750071
097510                      ' -- ' DL003-SQL-ERROR-PARA                 09751071
097520                      ' -- ' DL003-CALL-MOD-FAIL-NM               09752071
097530                      ' -- ' DL003-CALL-MOD-FAIL-ERR-CDE          09753071
097540                                                DELIMITED BY SIZE 09754071
097550                                           INTO PV-CICS-MSG-AREA2 09755071
097560               MOVE LENGTH OF PV-CICS-MSG-AREA2                   09756071
097570                                             TO PV-COMMAREA-LENGTH09757071
097580               EXEC CICS                                          09758071
097590                    WRITEQ TD                                     09759071
097600                     QUEUE  ('CSSL')                              09760071
097610                      FROM  (PV-CICS-MSG-AREA2)                   09761071
097620                    LENGTH  (PV-COMMAREA-LENGTH)                  09762071
097630                      RESP  (PV-CICS-RESP)                        09763071
097640              END-EXEC                                            09764071
097650                                                                  09765071
097660               MOVE  PC-TSYMSG-00551  TO  DP020-MSG-NUMBER        09766071
097670               SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE            09767071
097680               PERFORM 9900-SOFT-ABORT                            09768071
097690                                                                  09769071
097700         WHEN DL003-INVALID-ACCESS                                09770071
097710              SET ASC-ASSOC-LABOR-ASGMT-NO  TO TRUE               09771071
097720              MOVE ASC-OPER-UNT-ID   TO PV-DISPLAY-OPER           09772071
097730              MOVE ASC-PO-NBR        TO  PV-DISPLAY-PO-NBR        09773071
097740              MOVE ASC-REC-SEQ-NBR   TO  PV-DISPLAY-RCVR-SEQ-NBR  09774071
097750              MOVE DL003-ASGMT-SQLCODE                            09775071
097760                                     TO  PV-DISPLAY-SQLCODE       09776071
097770              INITIALIZE PV-CICS-MSG-AREA                         09777071
097780              STRING ' PCKCS701-3610- '                           09778071
097790                      PV-DISPLAY-OPER   '-'                       09779071
097800                      PV-DISPLAY-PO-NBR '-'                       09780071
097810                      PV-DISPLAY-RCVR-SEQ-NBR ' - '               09781071
097820                      DL003-KEY-USER-ID ' - '                     09782071
097830                     'SQLCODE=' PV-DISPLAY-SQLCODE                09783071
097840                     ' - INVALID ACCESS'        DELIMITED BY SIZE 09784071
097850                                           INTO PV-CICS-MSG-AREA2 09785071
097860               MOVE LENGTH OF PV-CICS-MSG-AREA2                   09786071
097870                                             TO PV-COMMAREA-LENGTH09787071
097880               EXEC CICS                                          09788071
097890                    WRITEQ TD                                     09789071
097900                     QUEUE  ('CSSL')                              09790071
097910                      FROM  (PV-CICS-MSG-AREA2)                   09791071
097920                    LENGTH  (PV-COMMAREA-LENGTH)                  09792071
097930                      RESP  (PV-CICS-RESP)                        09793071
097940               END-EXEC                                           09794071
097950                                                                  09795071
097960               INITIALIZE PV-CICS-MSG-AREA2                       09796071
097970               STRING ' PCKCS701-' DL003-USER-PGM                 09797071
097980                      ' -- ' DL003-SQL-ERROR-PARA                 09798071
097990                      ' -- ' DL003-CALL-MOD-FAIL-NM               09799071
098000                      ' -- ' DL003-CALL-MOD-FAIL-ERR-CDE          09800071
098010                                                DELIMITED BY SIZE 09801071
098020                                           INTO PV-CICS-MSG-AREA2 09802071
098030               MOVE LENGTH OF PV-CICS-MSG-AREA2                   09803071
098040                                             TO PV-COMMAREA-LENGTH09804071
098050               EXEC CICS                                          09805071
098060                    WRITEQ TD                                     09806071
098070                     QUEUE  ('CSSL')                              09807071
098080                      FROM  (PV-CICS-MSG-AREA2)                   09808071
098090                    LENGTH  (PV-COMMAREA-LENGTH)                  09809071
098100                      RESP  (PV-CICS-RESP)                        09810071
098110              END-EXEC                                            09811071
098120                                                                  09812071
098130               MOVE  PC-TSYMSG-00551  TO  DP020-MSG-NUMBER        09813071
098140               SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE            09814071
098150               PERFORM 9900-SOFT-ABORT                            09815071
098160                                                                  09816071
098170         WHEN OTHER                                               09817071
098180              SET ASC-ASSOC-LABOR-ASGMT-NO  TO TRUE               09818071
098190              MOVE ASC-OPER-UNT-ID   TO  PV-DISPLAY-OPER          09819071
098200              MOVE ASC-PO-NBR        TO  PV-DISPLAY-PO-NBR        09820071
098210              MOVE ASC-REC-SEQ-NBR   TO  PV-DISPLAY-RCVR-SEQ-NBR  09821071
098220              MOVE DL003-ASGMT-SQLCODE                            09822071
098230                                     TO  PV-DISPLAY-SQLCODE       09823071
098240              INITIALIZE PV-CICS-MSG-AREA                         09824071
098250              STRING ' PCKCS701-3610- '                           09825071
098260                      PV-DISPLAY-OPER   '-'                       09826071
098270                      PV-DISPLAY-PO-NBR '-'                       09827071
098280                      PV-DISPLAY-RCVR-SEQ-NBR ' - '               09828071
098290                      DL003-KEY-USER-ID ' - '                     09829071
098300                     'SQLCODE=' PV-DISPLAY-SQLCODE                09830071
098310                     ' - OTHER - '                                09831071
098320                      DL003-RETURN-CODE         DELIMITED BY SIZE 09832071
098330                                           INTO PV-CICS-MSG-AREA2 09833071
098340               MOVE LENGTH OF PV-CICS-MSG-AREA2                   09834071
098350                                             TO PV-COMMAREA-LENGTH09835071
098360               EXEC CICS                                          09836071
098370                    WRITEQ TD                                     09837071
098380                     QUEUE  ('CSSL')                              09838071
098390                      FROM  (PV-CICS-MSG-AREA2)                   09839071
098400                    LENGTH  (PV-COMMAREA-LENGTH)                  09840071
098410                      RESP  (PV-CICS-RESP)                        09841071
098420               END-EXEC                                           09842071
098430                                                                  09843071
098440               MOVE  PC-TSYMSG-00551  TO  DP020-MSG-NUMBER        09844071
098450               SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE            09845071
098460               PERFORM 9900-SOFT-ABORT                            09846071
098470                                                                  09847071
098480     END-EVALUATE.                                                09848071
098490                                                                  09849071
098500                                                                  09850071
098510*----------------------------------------------------------------*09851071
098520* IF DC IS INTERFACING WITH THE DC LABOR SYSTEM, AND ASSOCIATE   *09852071
098530* IS CURRENTLY ACTIVE ON A LABOR ASSIGNMENT, GET THE NEXT NEXT   *09853071
098540* SEQUENCE NUMBER FOR THE LABOR SYSTEM.                          *09854071
098550*----------------------------------------------------------------*09855071
098560 3620-GET-LABOR-SEQ-NBR.                                          09856071
098570                                                                  09857071
098580     INITIALIZE DL001-ASGMT-COMMAREA.                             09858071
098590     SET DL001-BY-ASGMT-KEY                                       09859071
098600         DL001-COMMIT-UPDATE                                      09860071
098610         DL001-FIND-NEXT-ASGMT    TO TRUE.                        09861071
098620                                                                  09862071
098630     IF  PS-LABOR-USE-DUMMY-ASGMT-YES                             09863071
098640         MOVE DL007-NEW-START-DTE     TO DL001-KEY-START-DTE      09864071
098650         MOVE DL007-NEW-NBR-TXT       TO DL001-KEY-NBR-TXT        09865071
098660         MOVE DL007-NEW-ASGMT-NBR-SEQ-NBR                         09866071
098670                                      TO DL001-KEY-NBR-SEQ-NBR    09867071
098680     ELSE                                                         09868071
098690         MOVE DL003-ASGMT-START-DTE   TO DL001-KEY-START-DTE      09869071
098700         MOVE DL003-ASGMT-NBR-TXT     TO DL001-KEY-NBR-TXT        09870071
098710         MOVE DL003-ASGMT-NBR-SEQ-NBR TO DL001-KEY-NBR-SEQ-NBR    09871071
098720     END-IF.                                                      09872071
098730                                                                  09873071
098740     IF  PS-LABOR-LOG-PHY-LBL                                     09874071
098750         IF  LQW-P2L-LBL-CNT (LQW-IDX)  >  0  AND                 09875071
098760             LQW-SHP-LBL-CNT (LQW-IDX)  >  0                      09876071
098770             MOVE +2              TO DL001-NBR-OF-NBRS-NEED-QTY   09877071
098780         ELSE                                                     09878071
098790             MOVE +1              TO DL001-NBR-OF-NBRS-NEED-QTY   09879071
098800         END-IF                                                   09880071
098810     ELSE                                                         09881071
098820         MOVE +1                  TO DL001-NBR-OF-NBRS-NEED-QTY   09882071
098830     END-IF                                                       09883071
098840     MOVE PC-CURRENT-PROGRAM-NAME TO DL001-ORIG-CALLING-PGM-NM.   09884071
098850                                                                  09885071
098860     CALL DL001-USER-PGM USING DFHEIBLK                           09886071
098870                              DL001-COMMAREA                      09887071
098880                              DL001-ASGMT-COMMAREA.               09888071
098890                                                                  09889071
098900     EVALUATE TRUE                                                09890071
098910         WHEN DL001-SUCCESSFUL                                    09891071
098920              IF DL001-ASGMT-NEXT-USED                            09892071
098930                 SET  PS-LABOR-NEXT-SEQ-YES  TO  TRUE             09893071
098940                 MOVE DL001-NXT-START-DTE                         09894071
098950                                   TO PV-LABOR-ASGMT-STRT-DTE     09895071
098960                 MOVE DL001-NXT-NBR-TXT                           09896071
098970                                   TO PV-LABOR-ASGMT-NBR-TXT      09897071
098980                 MOVE DL001-NXT-NBR-SEQ-NBR                       09898071
098990                                   TO PV-LABOR-ASGMT-NBR-SEQ-NBR  09899071
099000                 MOVE DL001-SEQ-START-NBR                         09900071
099010                                   TO PV-LABOR-SEQ-START-NBR      09901071
099020              ELSE                                                09902071
099030                 SET  PS-LABOR-NEXT-SEQ-NO   TO  TRUE             09903071
099040                 MOVE DL001-SEQ-START-NBR                         09904071
099050                                   TO PV-LABOR-SEQ-START-NBR      09905071
099060              END-IF                                              09906071
099070                                                                  09907071
099080         WHEN OTHER                                               09908071
099090              SET  PS-LABOR-NEXT-SEQ-NO   TO  TRUE                09909071
099100              MOVE ASC-OPER-UNT-ID   TO  PV-DISPLAY-OPER          09910071
099110              MOVE ASC-PO-NBR        TO  PV-DISPLAY-PO-NBR        09911071
099120              MOVE ASC-REC-SEQ-NBR   TO  PV-DISPLAY-RCVR-SEQ-NBR  09912071
099130              MOVE DL001-ASGMT-SQLCODE                            09913071
099140                                     TO  PV-DISPLAY-SQLCODE       09914071
099150              INITIALIZE PV-CICS-MSG-AREA2                        09915071
099160              STRING ' PCKCS701-3620- '                           09916071
099170                      PV-DISPLAY-OPER   '-'                       09917071
099180                      PV-DISPLAY-PO-NBR '-'                       09918071
099190                      PV-DISPLAY-RCVR-SEQ-NBR ' - '               09919071
099200                      DP020-USERID ' - '                          09920071
099210                     'SQLCODE=' PV-DISPLAY-SQLCODE                09921071
099220                     ' - RETURN CODE=' DL001-RETURN-CODE          09922071
099230                                                DELIMITED BY SIZE 09923071
099240                                           INTO PV-CICS-MSG-AREA2 09924071
099250               MOVE LENGTH OF PV-CICS-MSG-AREA2                   09925071
099260                                             TO PV-COMMAREA-LENGTH09926071
099270               EXEC CICS                                          09927071
099280                    WRITEQ TD                                     09928071
099290                     QUEUE  ('CSSL')                              09929071
099300                      FROM  (PV-CICS-MSG-AREA2)                   09930071
099310                    LENGTH  (PV-COMMAREA-LENGTH)                  09931071
099320                      RESP  (PV-CICS-RESP)                        09932071
099330               END-EXEC                                           09933071
099340                                                                  09934071
099350              INITIALIZE PV-CICS-MSG-AREA2                        09935071
099360              STRING ' PCKCS701-' DL001-USER-PGM                  09936071
099370                      ' -- ' DL001-SQL-ERROR-PARA                 09937071
099380                      ' -- ' DL001-CALL-MOD-FAIL-NM               09938071
099390                      ' -- ' DL001-CALL-MOD-FAIL-ERR-CDE          09939071
099400                                                DELIMITED BY SIZE 09940071
099410                                           INTO PV-CICS-MSG-AREA2 09941071
099420               MOVE LENGTH OF PV-CICS-MSG-AREA2                   09942071
099430                                             TO PV-COMMAREA-LENGTH09943071
099440               EXEC CICS                                          09944071
099450                    WRITEQ TD                                     09945071
099460                     QUEUE  ('CSSL')                              09946071
099470                      FROM  (PV-CICS-MSG-AREA2)                   09947071
099480                    LENGTH  (PV-COMMAREA-LENGTH)                  09948071
099490                      RESP  (PV-CICS-RESP)                        09949071
099500               END-EXEC                                           09950071
099510                                                                  09951071
099520               MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER        09952071
099530               SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE            09953071
099540               PERFORM 9900-SOFT-ABORT                            09954071
099550                                                                  09955071
099560     END-EVALUATE.                                                09956071
099570                                                                  09957071
099580                                                                  09958071
099590*----------------------------------------------------------------*09959071
099600* SEND DATA TO EAI EXPORT DATABASE FOR LABOR SYSTEM              *09960071
099610*----------------------------------------------------------------*09961071
099620 3630-SEND-LABOR-TO-EAI.                                          09962071
099630                                                                  09963071
099640     PERFORM 3640-GET-TRIP-ID.                                    09964071
099650     PERFORM 3650-GET-DOOR-ID.                                    09965071
099660                                                                  09966071
099670     INITIALIZE XL072-EAI-EXPORT-COMMAREA.                        09967071
099680     SET XL072-PC-APP-ID                                          09968071
099690         XL072-DO-NOT-COMMIT-UPDATE TO TRUE.                      09969071
099700                                                                  09970071
099710                                                                  09971071
099720     MOVE PC-CURRENT-PROGRAM-NAME TO XL072-CRE-PGM-NM.            09972071
099730                                                                  09973071
099740     MOVE ZEROES                  TO XL072-EVNT-KY-1-NBR          09974071
099750                                     XL072-EVNT-KY-2-NBR          09975071
099760                                     XL072-EVNT-KY-3-NBR          09976071
099770                                     XL072-EVNT-KY-4-NBR          09977071
099780                                     XL072-EVNT-KY-5-NBR.         09978071
099790     MOVE SPACES                  TO XL072-EVNT-KY-1-TXT          09979071
099800                                     XL072-EVNT-KY-2-TXT          09980071
099810                                     XL072-EVNT-KY-3-TXT          09981071
099820                                     XL072-EVNT-KY-4-TXT          09982071
099830                                     XL072-EVNT-KY-5-TXT          09983071
099840                                     XL072-EVNT-KY-1-TMST         09984071
099850                                     XL072-EVNT-KY-2-TMST         09985071
099860                                     XL072-EVNT-KY-3-TMST         09986071
099870                                     XL072-EVNT-KY-4-TMST         09987071
099880                                     XL072-EVNT-KY-5-TMST.        09988071
099890                                                                  09989071
099900     IF  PS-LABOR-LOG-PHY-LBL                                     09990071
099910         MOVE 'CARTON'            TO XL072-EVNT-OBJ-TXT           09991071
099920         MOVE 'NON UCC PRINT'     TO XL072-EVNT-OBJ-ACTN-TXT      09992071
099930         MOVE DP020-USERID        TO XL072-CRE-BY-USR-ID          09993071
099940         MOVE ASC-PO-NBR          TO XL072-EVNT-KY-1-NBR          09994071
099950         MOVE ASC-REC-SEQ-NBR     TO XL072-EVNT-KY-2-NBR          09995071
099960         MOVE LQW-PO-RCVR-LINE (LQW-IDX)                          09996071
099970                                  TO XL072-EVNT-KY-3-NBR          09997071
099980         MOVE SHIPMT-TRIP-ID      TO XL072-EVNT-KY-4-NBR          09998071
099990     ELSE                                                         09999071
100000         MOVE 'PO DOWNLOAD'       TO XL072-EVNT-OBJ-TXT           10000071
100010         MOVE 'DOWNLOAD PROCESS'  TO XL072-EVNT-OBJ-ACTN-TXT      10001071
100020         MOVE DP020-USERID        TO XL072-CRE-BY-USR-ID          10002071
100030         MOVE ASC-PO-NBR          TO XL072-EVNT-KY-1-NBR          10003071
100040         MOVE ASC-REC-SEQ-NBR     TO XL072-EVNT-KY-2-NBR          10004071
100050         MOVE SHIPMT-TRIP-ID      TO XL072-EVNT-KY-3-NBR          10005071
100060     END-IF.                                                      10006071
100070                                                                  10007071
100080     INITIALIZE PC242-DTL-TXT-AREA.                               10008071
100090                                                                  10009071
100100     IF  PS-LABOR-LOG-PHY-LBL                                     10010071
100110         SET PC242-NON-UCC-LBL-PRT      TO TRUE                   10011071
100120         MOVE PV-LABOR-ASGMT-STRT-DTE                             10012071
100130                                   TO PC242-AD-ASGMT-STRT-DTE     10013071
100140         MOVE PV-LABOR-ASGMT-NBR-TXT                              10014071
100150                                   TO PC242-AD-ASGMT-NBR-TXT      10015071
100160         MOVE PV-LABOR-ASGMT-NBR-SEQ-NBR                          10016071
100170                                   TO PC242-AD-ASGMT-NBR-SEQ-NBR  10017071
100180         MOVE PV-LABOR-SEQ-START-NBR                              10018071
100190                                   TO PC242-AD-ASGMT-SEQ-DTL-NBR  10019071
100200         MOVE SUT00040-DOOR-ID     TO PC242-AD-DOOR-NBR           10020071
100210         MOVE ASC-PKGNG-CD         TO PC242-AD-PACK-TYPE-CDE      10021071
100220         MOVE PV-LABOR-DUMMY-TK    TO PC242-AD-DUMMY-USER-ID      10022071
100230                                                                  10023071
100240         IF  PS-LABOR-PHY-LBL-P2L-YES                             10024071
100250             SET  PC242-AD-CRTN-TO-P2L  TO  TRUE                  10025071
100260             MOVE  ZEROES          TO PC242-AD-CRTN-DEST-LOC-NBR  10026071
100270             PERFORM 3637-GET-P2L-DESC                            10027071
100280             MOVE P2LMOD-MODU-DESC TO PC242-AD-P2L-MODU-DESC      10028071
100290             MOVE  ASC-DFLT-STR-ZN-ID                             10029071
100300                                   TO PC242-AD-STR-ZN-ID          10030071
100310             MOVE  ZEROES          TO PC242-AD-CRSDCK-LABEL-QTY   10031071
100320                                      PC242-AD-CRSDCK-UNIT-QTY    10032071
100330             MOVE  LQW-P2L-LBL-CNT (LQW-IDX)                      10033071
100340                                   TO PC242-AD-P2L-LABEL-QTY      10034071
100350                                                                  10035071
100360             IF  ASC-PRE-PACK-ORDER                               10036071
100370                 PERFORM 3638-P2L-UNIT-CNT-PREPK                  10037071
100380             ELSE                                                 10038071
100390                 PERFORM 3633-P2L-UNIT-CNT                        10039071
100400             END-IF                                               10040071
100410                                                                  10041071
100420             MOVE  PV-LABOR-P2L-UNITS                             10042071
100430                                   TO PC242-AD-P2L-UNIT-QTY       10043071
100440         END-IF                                                   10044071
100450                                                                  10045071
100460         IF  PS-LABOR-PHY-LBL-SML-YES                             10046071
100470                                                                  10047071
100480             MOVE  LQW-PO-RCVR-LINE(LQW-IDX)                      10048071
100490                                   TO DK-LINE-NBR                 10049071
100500                                                                  10050071
100510             PERFORM 3635-SML-DEST-NBR                            10051071
100520             MOVE  SPACES          TO PC242-AD-P2L-MODU-DESC      10052071
100530             MOVE  ASC-DFLT-STR-ZN-ID                             10053071
100540                                   TO PC242-AD-STR-ZN-ID          10054071
100550             MOVE  LQW-SHP-LBL-CNT (LQW-IDX)                      10055071
100560                                   TO PC242-AD-CRSDCK-LABEL-QTY   10056071
100570                                                                  10057071
100580             IF  ASC-PRE-PACK-ORDER                               10058071
100590                 PERFORM 3639-SML-UNIT-CNT-PREPK                  10059071
100600             ELSE                                                 10060071
100610                 PERFORM 3634-SML-UNIT-CNT                        10061071
100620             END-IF                                               10062071
100630                                                                  10063071
100640             ADD    PV-LABOR-FCSE-UNITS                           10064071
100650               TO   PV-LABOR-INPK-UNITS                           10065071
100660             GIVING PV-LABOR-SML-UNITS                            10066071
100670                                      PC242-AD-CRSDCK-UNIT-QTY    10067071
100680             MOVE  ZEROES          TO PC242-AD-P2L-LABEL-QTY      10068071
100690                                      PC242-AD-P2L-UNIT-QTY       10069071
100700         END-IF                                                   10070071
100710                                                                  10071071
100720     ELSE                                                         10072071
100730         SET  PC242-DOWNLOAD-PO-PROCESS  TO TRUE                  10073071
100740         MOVE PV-LABOR-ASGMT-STRT-DTE                             10074071
100750                                   TO PC242-AA-ASGMT-STRT-DTE     10075071
100760         MOVE PV-LABOR-ASGMT-NBR-TXT                              10076071
100770                                   TO PC242-AA-ASGMT-NBR-TXT      10077071
100780         MOVE PV-LABOR-ASGMT-NBR-SEQ-NBR                          10078071
100790                                   TO PC242-AA-ASGMT-NBR-SEQ-NBR  10079071
100800         MOVE PV-LABOR-SEQ-START-NBR                              10080071
100810                                   TO PC242-AA-ASGMT-SEQ-DTL-NBR  10081071
100820         MOVE SUT00040-DOOR-ID     TO PC242-AA-DOOR-NBR           10082071
100830         MOVE ASC-PKGNG-CD         TO PC242-AA-PACK-TYPE-CDE      10083071
100840     END-IF.                                                      10084071
100850                                                                  10085071
100860                                                                  10086071
100870     SET  XL072-PCWS242-COPYBOOK   TO TRUE.                       10087071
100880     MOVE PC242-DTL-TXT-AREA       TO XL072-DTL-TXT.              10088071
100890                                                                  10089071
100900     CALL XL072-USER-PGM USING DFHEIBLK                           10090071
100910                              XL072-COMMAREA                      10091071
100920                              XL072-EAI-EXPORT-COMMAREA.          10092071
100930                                                                  10093071
100940     EVALUATE TRUE                                                10094071
100950         WHEN XL072-SUCCESSFUL                                    10095071
100960              CONTINUE                                            10096071
100970         WHEN OTHER                                               10097071
100980              MOVE ASC-OPER-UNT-ID   TO  PV-DISPLAY-OPER          10098071
100990              MOVE ASC-PO-NBR        TO  PV-DISPLAY-PO-NBR        10099071
101000              MOVE ASC-REC-SEQ-NBR   TO  PV-DISPLAY-RCVR-SEQ-NBR  10100071
101010              MOVE XL072-EAI-DB-SQLCODE                           10101071
101020                                     TO  PV-DISPLAY-SQLCODE       10102071
101030              INITIALIZE PV-CICS-MSG-AREA2                        10103071
101040              STRING ' PCKCS701-3630- '                           10104071
101050                      PV-DISPLAY-OPER   '-'                       10105071
101060                      PV-DISPLAY-PO-NBR '-'                       10106071
101070                      PV-DISPLAY-RCVR-SEQ-NBR ' - '               10107071
101080                      DP020-USERID ' - '                          10108071
101090                     'SQLCODE=' PV-DISPLAY-SQLCODE                10109071
101100                     ' - RETURN CODE=' XL072-RETURN-CODE          10110071
101110                     ' - ' PS-LABOR-LOGGING-LEVEL-SW              10111071
101120                     ' - ' PS-LABOR-PHY-LBL-P2L-SW                10112071
101130                     ' - ' PS-LABOR-PHY-LBL-SML-SW                10113071
101140                                                DELIMITED BY SIZE 10114071
101150                                           INTO PV-CICS-MSG-AREA2 10115071
101160               MOVE LENGTH OF PV-CICS-MSG-AREA2                   10116071
101170                                             TO PV-COMMAREA-LENGTH10117071
101180               EXEC CICS                                          10118071
101190                    WRITEQ TD                                     10119071
101200                     QUEUE  ('CSSL')                              10120071
101210                      FROM  (PV-CICS-MSG-AREA2)                   10121071
101220                    LENGTH  (PV-COMMAREA-LENGTH)                  10122071
101230                      RESP  (PV-CICS-RESP)                        10123071
101240               END-EXEC                                           10124071
101250                                                                  10125071
101260              INITIALIZE PV-CICS-MSG-AREA2                        10126071
101270              STRING ' PCKCS701-' XL072-USER-PGM                  10127071
101280                      ' -- ' XL072-SQL-ERROR-PARA                 10128071
101290                      ' -- ' XL072-CALL-MOD-FAIL-NM               10129071
101300                      ' -- ' XL072-CALL-MOD-FAIL-ERR-CDE          10130071
101310                                                DELIMITED BY SIZE 10131071
101320                                           INTO PV-CICS-MSG-AREA2 10132071
101330               MOVE LENGTH OF PV-CICS-MSG-AREA2                   10133071
101340                                             TO PV-COMMAREA-LENGTH10134071
101350               EXEC CICS                                          10135071
101360                    WRITEQ TD                                     10136071
101370                     QUEUE  ('CSSL')                              10137071
101380                      FROM  (PV-CICS-MSG-AREA2)                   10138071
101390                    LENGTH  (PV-COMMAREA-LENGTH)                  10139071
101400                      RESP  (PV-CICS-RESP)                        10140071
101410               END-EXEC                                           10141071
101420                                                                  10142071
101430              INITIALIZE PV-CICS-MSG-AREA2                        10143071
101440              STRING ' PCKCS701-' XL072-USER-PGM                  10144071
101450                      ' -- ' XL072-SQLCA                          10145071
101460                                                DELIMITED BY SIZE 10146071
101470                                           INTO PV-CICS-MSG-AREA2 10147071
101480               MOVE LENGTH OF PV-CICS-MSG-AREA2                   10148071
101490                                             TO PV-COMMAREA-LENGTH10149071
101500               EXEC CICS                                          10150071
101510                    WRITEQ TD                                     10151071
101520                     QUEUE  ('CSSL')                              10152071
101530                      FROM  (PV-CICS-MSG-AREA2)                   10153071
101540                    LENGTH  (PV-COMMAREA-LENGTH)                  10154071
101550                      RESP  (PV-CICS-RESP)                        10155071
101560               END-EXEC                                           10156071
101570                                                                  10157071
101580               MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER        10158071
101590               SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE            10159071
101600               PERFORM 9900-SOFT-ABORT                            10160071
101610                                                                  10161071
101620     END-EVALUATE.                                                10162071
101630                                                                  10163071
101640                                                                  10164071
101650 3633-P2L-UNIT-CNT.                                               10165071
101660                                                                  10166071
101670     EXEC SQL                                                     10167071
101680         SELECT SUM(P2L_SPLT_UNT_QTY)                             10168071
101690           INTO :PV-LABOR-P2L-UNITS :PV-NULL-IND-2                10169071
101700           FROM TDISTDT                                           10170071
101710          WHERE ORD_NBR       = :DK-PO-NBR                        10171071
101720            AND RCVR_SEQ_NBR  = :DK-REC-SEQ-NBR                   10172071
101730            AND ORD_LNE_NBR   = :DK-LINE-NBR                      10173071
101740            AND P2L_SPLT_UNT_QTY  >  0                            10174071
101750     END-EXEC.                                                    10175071
101760                                                                  10176071
101770     EVALUATE TRUE                                                10177071
101780         WHEN SQLCODE = +0                                        10178071
101790             IF  PV-NULL-IND-2  =  -1                             10179071
101800                 MOVE ZEROES  TO  PV-LABOR-P2L-UNITS              10180071
101810             END-IF                                               10181071
101820         WHEN SQLCODE = -904                                      10182071
101830         WHEN SQLCODE = -911                                      10183071
101840         WHEN SQLCODE = -913                                      10184071
101850             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    10185071
101860             MOVE '3633-P2L-UNIT-CNT    '   TO PV-SOFT-PARAGRAPH  10186071
101870             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  10187071
101880             MOVE LENGTH OF PV-CICS-MSG-AREA2                     10188071
101890               TO PV-COMMAREA-LENGTH                              10189071
101900             EXEC CICS                                            10190071
101910                  WRITEQ TD                                       10191071
101920                   QUEUE  ('CSSL')                                10192071
101930                    FROM  (PV-CICS-MSG-AREA2)                     10193071
101940                  LENGTH  (PV-COMMAREA-LENGTH)                    10194071
101950                    RESP  (PV-CICS-RESP)                          10195071
101960             END-EXEC                                             10196071
101970             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          10197071
101980             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              10198071
101990             PERFORM 9900-SOFT-ABORT                              10199071
102000         WHEN SQLWARN0 NOT = SPACES                               10200071
102010         WHEN SQLCODE < ZERO                                      10201071
102020         WHEN SQLCODE > ZERO                                      10202071
102030             MOVE '3633-P2L-UNIT-CNT    '                         10203071
102040                               TO DP013-PARAGRAPH                 10204071
102050             MOVE DK-PO-NBR      TO  PV-DSPLY-PO                  10205071
102060             MOVE DK-REC-SEQ-NBR TO  PV-DSPLY-RCVR                10206071
102070             MOVE DK-LINE-NBR    TO  PV-DSPLY-LNE                 10207071
102080             STRING  ' PO/RCVR/LNE - ' DELIMITED BY SIZE          10208071
102090                     PV-DSPLY-PO       DELIMITED BY SIZE          10209071
102100                     '-'               DELIMITED BY SIZE          10210071
102110                     PV-DSPLY-RCVR     DELIMITED BY SIZE          10211071
102120                     '-'               DELIMITED BY SIZE          10212071
102130                     PV-DSPLY-LNE      DELIMITED BY SIZE          10213071
102140                             INTO DP013-MESSAGE-TEXT (1)          10214071
102150             MOVE 'CHECK IF UCC128 DATA AVAIL BY LINE'            10215071
102160                               TO DP013-MESSAGE-TEXT (2)          10216071
102170             MOVE SQLCA        TO DP013-SQLCA                     10217071
102180             MOVE 'TDISTDT'    TO DP013-DB2-TABLE-NAME (1)        10218071
102190             SET DP013-DB2-ABEND                                  10219071
102200                 DP013-XCTL-DISPLAY-RESTART                       10220071
102210                               TO TRUE                            10221071
102220             PERFORM DP013-0000-PROCESS-ABEND                     10222071
102230     END-EVALUATE.                                                10223071
102240                                                                  10224071
102250                                                                  10225071
102260 3634-SML-UNIT-CNT.                                               10226071
102270                                                                  10227071
102280     EXEC SQL                                                     10228071
102290         SELECT SUM(FCSE_SPLT_UNT_QTY)                            10229071
102300               ,SUM(INPK_SPLT_UNT_QTY)                            10230071
102310           INTO :PV-LABOR-FCSE-UNITS                              10231071
102320               ,:PV-LABOR-INPK-UNITS                              10232071
102330           FROM TDISTDT                                           10233071
102340          WHERE ORD_NBR       = :DK-PO-NBR                        10234071
102350            AND RCVR_SEQ_NBR  = :DK-REC-SEQ-NBR                   10235071
102360            AND ORD_LNE_NBR   = :DK-LINE-NBR                      10236071
102370     END-EXEC.                                                    10237071
102380                                                                  10238071
102390     EVALUATE TRUE                                                10239071
102400         WHEN SQLCODE = +0                                        10240071
102410              CONTINUE                                            10241071
102420         WHEN SQLCODE = -904                                      10242071
102430         WHEN SQLCODE = -911                                      10243071
102440         WHEN SQLCODE = -913                                      10244071
102450             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    10245071
102460             MOVE '3634-SML-UNIT-CNT    '   TO PV-SOFT-PARAGRAPH  10246071
102470             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  10247071
102480             MOVE LENGTH OF PV-CICS-MSG-AREA2                     10248071
102490               TO PV-COMMAREA-LENGTH                              10249071
102500             EXEC CICS                                            10250071
102510                  WRITEQ TD                                       10251071
102520                   QUEUE  ('CSSL')                                10252071
102530                    FROM  (PV-CICS-MSG-AREA2)                     10253071
102540                  LENGTH  (PV-COMMAREA-LENGTH)                    10254071
102550                    RESP  (PV-CICS-RESP)                          10255071
102560             END-EXEC                                             10256071
102570             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          10257071
102580             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              10258071
102590             PERFORM 9900-SOFT-ABORT                              10259071
102600         WHEN SQLWARN0 NOT = SPACES                               10260071
102610         WHEN SQLCODE < ZERO                                      10261071
102620         WHEN SQLCODE > ZERO                                      10262071
102630             MOVE '3634-SML-UNIT-CNT    '                         10263071
102640                               TO DP013-PARAGRAPH                 10264071
102650             MOVE DK-PO-NBR      TO  PV-DSPLY-PO                  10265071
102660             MOVE DK-REC-SEQ-NBR TO  PV-DSPLY-RCVR                10266071
102670             MOVE DK-LINE-NBR    TO  PV-DSPLY-LNE                 10267071
102680             STRING  ' PO/RCVR/LNE - ' DELIMITED BY SIZE          10268071
102690                     PV-DSPLY-PO       DELIMITED BY SIZE          10269071
102700                     '-'               DELIMITED BY SIZE          10270071
102710                     PV-DSPLY-RCVR     DELIMITED BY SIZE          10271071
102720                     '-'               DELIMITED BY SIZE          10272071
102730                     PV-DSPLY-LNE      DELIMITED BY SIZE          10273071
102740                             INTO DP013-MESSAGE-TEXT (1)          10274071
102750             MOVE 'CHECK IF UCC128 DATA AVAIL BY LINE'            10275071
102760                               TO DP013-MESSAGE-TEXT (2)          10276071
102770             MOVE SQLCA        TO DP013-SQLCA                     10277071
102780             MOVE 'TDISTDT'    TO DP013-DB2-TABLE-NAME (1)        10278071
102790             SET DP013-DB2-ABEND                                  10279071
102800                 DP013-XCTL-DISPLAY-RESTART                       10280071
102810                               TO TRUE                            10281071
102820             PERFORM DP013-0000-PROCESS-ABEND                     10282071
102830     END-EVALUATE.                                                10283071
102840                                                                  10284071
102850                                                                  10285071
102860 3635-SML-DEST-NBR.                                               10286071
102870                                                                  10287071
102880     EXEC SQL                                                     10288071
102890         SELECT STR_NBR                                           10289071
102900           INTO :DISTDT-STR-NBR                                   10290071
102910           FROM TDISTDT                                           10291071
102920          WHERE ORD_NBR             = :DK-PO-NBR                  10292071
102930            AND RCVR_SEQ_NBR        = :DK-REC-SEQ-NBR             10293071
102940            AND ORD_LNE_NBR         = :DK-LINE-NBR                10294071
102950            AND (INPK_SPLT_UNT_QTY  >  0  OR                      10295071
102960                 FCSE_SPLT_UNT_QTY  >  0)                         10296071
102970     END-EXEC.                                                    10297071
102980                                                                  10298071
102990     EVALUATE TRUE                                                10299071
103000         WHEN SQLCODE = +0                                        10300071
103010             SET  PC242-AD-CRTN-TO-LOC  TO  TRUE                  10301071
103020             MOVE DISTDT-STR-NBR  TO PC242-AD-CRTN-DEST-LOC-NBR   10302071
103030                                                                  10303071
103040         WHEN SQLCODE = -811                                      10304071
103050             SET  PC242-AD-CRTN-TO-MULT-LOC  TO  TRUE             10305071
103060             MOVE DISTDT-STR-NBR  TO PC242-AD-CRTN-DEST-LOC-NBR   10306071
103070                                                                  10307071
103080         WHEN SQLCODE = -904                                      10308071
103090         WHEN SQLCODE = -911                                      10309071
103100         WHEN SQLCODE = -913                                      10310071
103110             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    10311071
103120             MOVE '3635-SML-DEST-NBR    '   TO PV-SOFT-PARAGRAPH  10312071
103130             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  10313071
103140             MOVE LENGTH OF PV-CICS-MSG-AREA2                     10314071
103150               TO PV-COMMAREA-LENGTH                              10315071
103160             EXEC CICS                                            10316071
103170                  WRITEQ TD                                       10317071
103180                   QUEUE  ('CSSL')                                10318071
103190                    FROM  (PV-CICS-MSG-AREA2)                     10319071
103200                  LENGTH  (PV-COMMAREA-LENGTH)                    10320071
103210                    RESP  (PV-CICS-RESP)                          10321071
103220             END-EXEC                                             10322071
103230             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          10323071
103240             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              10324071
103250             PERFORM 9900-SOFT-ABORT                              10325071
103260         WHEN SQLWARN0 NOT = SPACES                               10326071
103270         WHEN SQLCODE < ZERO                                      10327071
103280         WHEN SQLCODE > ZERO                                      10328071
103290             MOVE '3635-SML-DEST-NBR    '                         10329071
103300                               TO DP013-PARAGRAPH                 10330071
103310             MOVE DK-PO-NBR      TO  PV-DSPLY-PO                  10331071
103320             MOVE DK-REC-SEQ-NBR TO  PV-DSPLY-RCVR                10332071
103330             MOVE DK-LINE-NBR    TO  PV-DSPLY-LNE                 10333071
103340             STRING  ' PO/RCVR/LNE - ' DELIMITED BY SIZE          10334071
103350                     PV-DSPLY-PO       DELIMITED BY SIZE          10335071
103360                     '-'               DELIMITED BY SIZE          10336071
103370                     PV-DSPLY-RCVR     DELIMITED BY SIZE          10337071
103380                     '-'               DELIMITED BY SIZE          10338071
103390                     PV-DSPLY-LNE      DELIMITED BY SIZE          10339071
103400                             INTO DP013-MESSAGE-TEXT (1)          10340071
103410             MOVE 'CHECK IF UCC128 DATA AVAIL BY LINE'            10341071
103420                               TO DP013-MESSAGE-TEXT (2)          10342071
103430             MOVE SQLCA        TO DP013-SQLCA                     10343071
103440             MOVE 'TDISTDT'    TO DP013-DB2-TABLE-NAME (1)        10344071
103450             SET DP013-DB2-ABEND                                  10345071
103460                 DP013-XCTL-DISPLAY-RESTART                       10346071
103470                               TO TRUE                            10347071
103480             PERFORM DP013-0000-PROCESS-ABEND                     10348071
103490     END-EVALUATE.                                                10349071
103500                                                                  10350071
103510 3637-GET-P2L-DESC.                                               10351071
103520                                                                  10352071
103530     MOVE LQW-MODULE (LQW-IDX)  TO  P2LMOD-MODU-NBR.              10353071
103540     MOVE ASC-OPER-UNT-ID       TO  P2LMOD-OPER-UNT-ID.           10354071
103550                                                                  10355071
103560     EXEC SQL                                                     10356071
103570          SELECT  MODU_DESC                                       10357071
103580            INTO :P2LMOD-MODU-DESC                                10358071
103590            FROM  TP2LMOD                                         10359071
103600           WHERE  OPER_UNT_ID   = :P2LMOD-OPER-UNT-ID             10360071
103610             AND  MODU_NBR      = :P2LMOD-MODU-NBR                10361071
103620     END-EXEC.                                                    10362071
103630                                                                  10363071
103640     EVALUATE TRUE                                                10364071
103650         WHEN SQLCODE = +0                                        10365071
103660              CONTINUE                                            10366071
103670                                                                  10367071
103680         WHEN SQLWARN0 NOT = SPACE                                10368071
103690         WHEN SQLCODE < +0                                        10369071
103700         WHEN SQLCODE > +0                                        10370071
103710              MOVE ASC-OPER-UNT-ID   TO  PV-DISPLAY-OPER          10371071
103720              MOVE ASC-PO-NBR        TO  PV-DISPLAY-PO-NBR        10372071
103730              MOVE ASC-REC-SEQ-NBR   TO  PV-DISPLAY-RCVR-SEQ-NBR  10373071
103740              MOVE SQLCODE           TO  PV-DISPLAY-SQLCODE       10374071
103750              INITIALIZE PV-CICS-MSG-AREA2                        10375071
103760              sTRING ' PCKCS701-3637- '                           10376071
103770                      PV-DISPLAY-OPER   '-'                       10377071
103780                      PV-DISPLAY-PO-NBR '-'                       10378071
103790                      PV-DISPLAY-RCVR-SEQ-NBR ' - '               10379071
103800                      DP020-USERID ' - '                          10380071
103810                     'SQLCODE=' PV-DISPLAY-SQLCODE                10381071
103820                                                DELIMITED BY SIZE 10382071
103830                                           INTO PV-CICS-MSG-AREA2 10383071
103840               MOVE LENGTH OF PV-CICS-MSG-AREA2                   10384071
103850                                             TO PV-COMMAREA-LENGTH10385071
103860               EXEC CICS                                          10386071
103870                    WRITEQ TD                                     10387071
103880                     QUEUE  ('CSSL')                              10388071
103890                      FROM  (PV-CICS-MSG-AREA2)                   10389071
103900                    LENGTH  (PV-COMMAREA-LENGTH)                  10390071
103910                      RESP  (PV-CICS-RESP)                        10391071
103920               END-EXEC                                           10392071
103930                                                                  10393071
103940               MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER        10394071
103950               SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE            10395071
103960               PERFORM 9900-SOFT-ABORT                            10396071
103970                                                                  10397071
103980     END-EVALUATE.                                                10398071
103990                                                                  10399071
104000 3638-P2L-UNIT-CNT-PREPK.                                         10400071
104010                                                                  10401071
104020     EXEC SQL                                                     10402071
104030         SELECT SUM(A.P2L_SPLT_UNT_QTY)                           10403071
104040           INTO :PV-LABOR-P2L-UNITS :PV-NULL-IND-2                10404071
104050           FROM TDISTDT A                                         10405071
104060              , TRECITM B                                         10406071
104070          WHERE A.ORD_NBR       = :DK-PO-NBR                      10407071
104080            AND A.RCVR_SEQ_NBR  = :DK-REC-SEQ-NBR                 10408071
104090            AND A.P2L_SPLT_UNT_QTY  >  0                          10409071
104100            AND B.ORD_NBR       = A.ORD_NBR                       10410071
104110            AND B.ORD_LNE_NBR   = A.ORD_LNE_NBR                   10411071
104120            AND B.REC_SEQ_NBR   = A.RCVR_SEQ_NBR                  10412071
104130            AND B.PREPK_ID      = :DK-PREPK-ID                    10413071
104140     END-EXEC.                                                    10414071
104150                                                                  10415071
104160     EVALUATE TRUE                                                10416071
104170         WHEN SQLCODE = +0                                        10417071
104180             IF  PV-NULL-IND-2  =  -1                             10418071
104190                 MOVE ZEROES  TO  PV-LABOR-P2L-UNITS              10419071
104200             END-IF                                               10420071
104210         WHEN SQLCODE = -904                                      10421071
104220         WHEN SQLCODE = -911                                      10422071
104230         WHEN SQLCODE = -913                                      10423071
104240             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    10424071
104250             MOVE '3638-P2L-UNIT-CNT-PREPK' TO PV-SOFT-PARAGRAPH  10425071
104260             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  10426071
104270             MOVE LENGTH OF PV-CICS-MSG-AREA2                     10427071
104280               TO PV-COMMAREA-LENGTH                              10428071
104290             EXEC CICS                                            10429071
104300                  WRITEQ TD                                       10430071
104310                   QUEUE  ('CSSL')                                10431071
104320                    FROM  (PV-CICS-MSG-AREA2)                     10432071
104330                  LENGTH  (PV-COMMAREA-LENGTH)                    10433071
104340                    RESP  (PV-CICS-RESP)                          10434071
104350             END-EXEC                                             10435071
104360             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          10436071
104370             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              10437071
104380             PERFORM 9900-SOFT-ABORT                              10438071
104390         WHEN SQLWARN0 NOT = SPACES                               10439071
104400         WHEN SQLCODE < ZERO                                      10440071
104410         WHEN SQLCODE > ZERO                                      10441071
104420             MOVE '3638-P2L-UNIT-CNT-PREPK'                       10442071
104430                               TO DP013-PARAGRAPH                 10443071
104440             MOVE DK-PO-NBR      TO  PV-DSPLY-PO                  10444071
104450             MOVE DK-REC-SEQ-NBR TO  PV-DSPLY-RCVR                10445071
104460             MOVE DK-LINE-NBR    TO  PV-DSPLY-LNE                 10446071
104470             STRING  ' PO/RCVR/LNE - ' DELIMITED BY SIZE          10447071
104480                     PV-DSPLY-PO       DELIMITED BY SIZE          10448071
104490                     '-'               DELIMITED BY SIZE          10449071
104500                     PV-DSPLY-RCVR     DELIMITED BY SIZE          10450071
104510                     '-'               DELIMITED BY SIZE          10451071
104520                     PV-DSPLY-LNE      DELIMITED BY SIZE          10452071
104530                             INTO DP013-MESSAGE-TEXT (1)          10453071
104540             MOVE 'CHECK IF UCC128 DATA AVAIL BY LINE'            10454071
104550                               TO DP013-MESSAGE-TEXT (2)          10455071
104560             MOVE SQLCA        TO DP013-SQLCA                     10456071
104570             MOVE 'TDISTDT'    TO DP013-DB2-TABLE-NAME (1)        10457071
104580             SET DP013-DB2-ABEND                                  10458071
104590                 DP013-XCTL-DISPLAY-RESTART                       10459071
104600                               TO TRUE                            10460071
104610             PERFORM DP013-0000-PROCESS-ABEND                     10461071
104620     END-EVALUATE.                                                10462071
104630                                                                  10463071
104640                                                                  10464071
104650 3639-SML-UNIT-CNT-PREPK.                                         10465071
104660                                                                  10466071
104670     EXEC SQL                                                     10467071
104680         SELECT SUM(A.FCSE_SPLT_UNT_QTY)                          10468071
104690               ,SUM(A.INPK_SPLT_UNT_QTY)                          10469071
104700           INTO :PV-LABOR-FCSE-UNITS                              10470071
104710               ,:PV-LABOR-INPK-UNITS                              10471071
104720           FROM TDISTDT A                                         10472071
104730              , TRECITM B                                         10473071
104740          WHERE A.ORD_NBR       = :DK-PO-NBR                      10474071
104750            AND A.RCVR_SEQ_NBR  = :DK-REC-SEQ-NBR                 10475071
104760            AND B.ORD_NBR       = A.ORD_NBR                       10476071
104770            AND B.ORD_LNE_NBR   = A.ORD_LNE_NBR                   10477071
104780            AND B.REC_SEQ_NBR   = A.RCVR_SEQ_NBR                  10478071
104790            AND B.PREPK_ID      = :DK-PREPK-ID                    10479071
104800     END-EXEC.                                                    10480071
104810                                                                  10481071
104820     EVALUATE TRUE                                                10482071
104830         WHEN SQLCODE = +0                                        10483071
104840              CONTINUE                                            10484071
104850         WHEN SQLCODE = -904                                      10485071
104860         WHEN SQLCODE = -911                                      10486071
104870         WHEN SQLCODE = -913                                      10487071
104880             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    10488071
104890             MOVE '3639-SML-UNIT-CNT-PREPK' TO PV-SOFT-PARAGRAPH  10489071
104900             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  10490071
104910             MOVE LENGTH OF PV-CICS-MSG-AREA2                     10491071
104920               TO PV-COMMAREA-LENGTH                              10492071
104930             EXEC CICS                                            10493071
104940                  WRITEQ TD                                       10494071
104950                   QUEUE  ('CSSL')                                10495071
104960                    FROM  (PV-CICS-MSG-AREA2)                     10496071
104970                  LENGTH  (PV-COMMAREA-LENGTH)                    10497071
104980                    RESP  (PV-CICS-RESP)                          10498071
104990             END-EXEC                                             10499071
105000             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          10500071
105010             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              10501071
105020             PERFORM 9900-SOFT-ABORT                              10502071
105030         WHEN SQLWARN0 NOT = SPACES                               10503071
105040         WHEN SQLCODE < ZERO                                      10504071
105050         WHEN SQLCODE > ZERO                                      10505071
105060             MOVE '3639-SML-UNIT-CNT-PREPK'                       10506071
105070                               TO DP013-PARAGRAPH                 10507071
105080             MOVE DK-PO-NBR      TO  PV-DSPLY-PO                  10508071
105090             MOVE DK-REC-SEQ-NBR TO  PV-DSPLY-RCVR                10509071
105100             MOVE DK-LINE-NBR    TO  PV-DSPLY-LNE                 10510071
105110             STRING  ' PO/RCVR/LNE - ' DELIMITED BY SIZE          10511071
105120                     PV-DSPLY-PO       DELIMITED BY SIZE          10512071
105130                     '-'               DELIMITED BY SIZE          10513071
105140                     PV-DSPLY-RCVR     DELIMITED BY SIZE          10514071
105150                     '-'               DELIMITED BY SIZE          10515071
105160                     PV-DSPLY-LNE      DELIMITED BY SIZE          10516071
105170                             INTO DP013-MESSAGE-TEXT (1)          10517071
105180             MOVE 'CHECK IF UCC128 DATA AVAIL BY LINE'            10518071
105190                               TO DP013-MESSAGE-TEXT (2)          10519071
105200             MOVE SQLCA        TO DP013-SQLCA                     10520071
105210             MOVE 'TDISTDT'    TO DP013-DB2-TABLE-NAME (1)        10521071
105220             SET DP013-DB2-ABEND                                  10522071
105230                 DP013-XCTL-DISPLAY-RESTART                       10523071
105240                               TO TRUE                            10524071
105250             PERFORM DP013-0000-PROCESS-ABEND                     10525071
105260     END-EVALUATE.                                                10526071
105270                                                                  10527071
105280                                                                  10528071
105290                                                                  10529071
105300 3640-GET-TRIP-ID.                                                10530071
105310     MOVE  ASC-PO-NBR        TO  DK-PO-NBR.                       10531071
105320     MOVE  ASC-REC-SEQ-NBR   TO  DK-REC-SEQ-NBR.                  10532071
105330                                                                  10533071
105340     EXEC SQL                                                     10534071
105350          SELECT  DISTINCT                                        10535071
105360                  B.TRIP_ID                                       10536071
105370            INTO :SHIPMT-TRIP-ID                                  10537071
105380            FROM  TSHPTPO A                                       10538071
105390                 ,TSHIPMT B                                       10539071
105400           WHERE  A.PO_NBR      = :DK-PO-NBR                      10540071
105410             AND  A.REC_SEQ_NBR = :DK-REC-SEQ-NBR                 10541071
105420             AND  A.SHIPT_ID    =  B.SHIPT_ID                     10542071
105430     END-EXEC                                                     10543071
105440                                                                  10544071
105450     EVALUATE TRUE                                                10545071
105460         WHEN SQLCODE = +0                                        10546071
105470         WHEN SQLCODE = -811                                      10547071
105480              CONTINUE                                            10548071
105490                                                                  10549071
105500         WHEN SQLWARN0 NOT = SPACE                                10550071
105510         WHEN SQLCODE < +0                                        10551071
105520         WHEN SQLCODE > +0                                        10552071
105530              MOVE ASC-OPER-UNT-ID   TO  PV-DISPLAY-OPER          10553071
105540              MOVE ASC-PO-NBR        TO  PV-DISPLAY-PO-NBR        10554071
105550              MOVE ASC-REC-SEQ-NBR   TO  PV-DISPLAY-RCVR-SEQ-NBR  10555071
105560              MOVE SQLCODE           TO  PV-DISPLAY-SQLCODE       10556071
105570              INITIALIZE PV-CICS-MSG-AREA2                        10557071
105580              STRING ' PCKCS701-3640- '                           10558071
105590                      PV-DISPLAY-OPER   '-'                       10559071
105600                      PV-DISPLAY-PO-NBR '-'                       10560071
105610                      PV-DISPLAY-RCVR-SEQ-NBR ' - '               10561071
105620                      DP020-USERID ' - '                          10562071
105630                     'SQLCODE=' PV-DISPLAY-SQLCODE                10563071
105640                                                DELIMITED BY SIZE 10564071
105650                                           INTO PV-CICS-MSG-AREA2 10565071
105660               MOVE LENGTH OF PV-CICS-MSG-AREA2                   10566071
105670                                             TO PV-COMMAREA-LENGTH10567071
105680               EXEC CICS                                          10568071
105690                    WRITEQ TD                                     10569071
105700                     QUEUE  ('CSSL')                              10570071
105710                      FROM  (PV-CICS-MSG-AREA2)                   10571071
105720                    LENGTH  (PV-COMMAREA-LENGTH)                  10572071
105730                      RESP  (PV-CICS-RESP)                        10573071
105740               END-EXEC                                           10574071
105750                                                                  10575071
105760               MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER        10576071
105770               SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE            10577071
105780               PERFORM 9900-SOFT-ABORT                            10578071
105790                                                                  10579071
105800     END-EVALUATE.                                                10580071
105810                                                                  10581071
105820                                                                  10582071
105830 3650-GET-DOOR-ID.                                                10583071
105840                                                                  10584071
105850     EXEC SQL                                                     10585071
105860          SELECT  A.DOOR_ID                                       10586071
105870            INTO :SUT00040-DOOR-ID                                10587071
105880            FROM  SUT_INBD_TRIP_DOOR A                            10588071
105890           WHERE  A.TRIP_ID  =  :SHIPMT-TRIP-ID                   10589071
105900             AND  A.CRE_TMST  IN                                  10590071
105910                  (SELECT  MAX(B.CRE_TMST)                        10591071
105920                     FROM  SUT_INBD_TRIP_DOOR B                   10592071
105930                    WHERE  A.TRIP_ID  =  B.TRIP_ID)               10593071
105940     END-EXEC                                                     10594071
105950                                                                  10595071
105960     EVALUATE TRUE                                                10596071
105970         WHEN SQLCODE = +0                                        10597071
105980              CONTINUE                                            10598071
105990                                                                  10599071
106000         WHEN SQLCODE = +100                                      10600071
106010              MOVE SPACES  TO  SUT00040-DOOR-ID                   10601071
106020                                                                  10602071
106030         WHEN SQLWARN0 NOT = SPACE                                10603071
106040         WHEN SQLCODE < +0                                        10604071
106050         WHEN SQLCODE > +0                                        10605071
106060              MOVE ASC-OPER-UNT-ID   TO  PV-DISPLAY-OPER          10606071
106070              MOVE ASC-PO-NBR        TO  PV-DISPLAY-PO-NBR        10607071
106080              MOVE ASC-REC-SEQ-NBR   TO  PV-DISPLAY-RCVR-SEQ-NBR  10608071
106090              MOVE SQLCODE           TO  PV-DISPLAY-SQLCODE       10609071
106100              INITIALIZE PV-CICS-MSG-AREA2                        10610071
106110              STRING ' PCKCS701-3650- '                           10611071
106120                      PV-DISPLAY-OPER   '-'                       10612071
106130                      PV-DISPLAY-PO-NBR '-'                       10613071
106140                      PV-DISPLAY-RCVR-SEQ-NBR ' - '               10614071
106150                      DP020-USERID ' - '                          10615071
106160                     'SQLCODE=' PV-DISPLAY-SQLCODE                10616071
106170                                                DELIMITED BY SIZE 10617071
106180                                           INTO PV-CICS-MSG-AREA2 10618071
106190               MOVE LENGTH OF PV-CICS-MSG-AREA2                   10619071
106200                                             TO PV-COMMAREA-LENGTH10620071
106210               EXEC CICS                                          10621071
106220                    WRITEQ TD                                     10622071
106230                     QUEUE  ('CSSL')                              10623071
106240                      FROM  (PV-CICS-MSG-AREA2)                   10624071
106250                    LENGTH  (PV-COMMAREA-LENGTH)                  10625071
106260                      RESP  (PV-CICS-RESP)                        10626071
106270               END-EXEC                                           10627071
106280                                                                  10628071
106290               MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER        10629071
106300               SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE            10630071
106310               PERFORM 9900-SOFT-ABORT                            10631071
106320                                                                  10632071
106330     END-EVALUATE.                                                10633071
106340                                                                  10634071
106350                                                                  10635071
106360*----------------------------------------------------------------*10636071
106370* GET DUMMY LABOR TK - USED FOR PHYSICAL LABELS                  *10637071
106380*----------------------------------------------------------------*10638071
106390 3660-GET-DUMMY-LABOR-TK.                                         10639071
106400                                                                  10640071
106410     MOVE ASC-OPER-UNT-ID    TO  DK-LABOR-OPER.                   10641071
106420                                                                  10642071
106430     EXEC SQL                                                     10643071
106440          SELECT  FUNC_TXT                                        10644071
106450            INTO :KRPRPM-FUNC-TXT                                 10645071
106460            FROM  TKRPRPM                                         10646071
106470           WHERE  LOC_ID            = :DK-LABOR-OPER              10647071
106480             AND  INTFC_SYS_CDE     = 'DLX'                       10648071
106490             AND  SYS_PRC_FUNC_CDE  = 'DLPLDU'                    10649071
106500     END-EXEC.                                                    10650071
106510                                                                  10651071
106520     EVALUATE TRUE                                                10652071
106530                                                                  10653071
106540         WHEN SQLCODE = +0                                        10654071
106550              MOVE  KRPRPM-FUNC-TXT  TO  PV-LABOR-DUMMY-TK        10655071
106560              SET  PS-LABOR-HAVE-DUMMY-TK-YES  TO  TRUE           10656071
106570                                                                  10657071
106580         WHEN SQLCODE = -904                                      10658071
106590         WHEN SQLCODE = -911                                      10659071
106600         WHEN SQLCODE = -913                                      10660071
106610              MOVE SQLCODE                   TO PV-SOFT-SQLCODE   10661071
106620              MOVE '3660-GET-DUMMY-LABOR-TK' TO PV-SOFT-PARAGRAPH 10662071
106630              MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2 10663071
106640              MOVE LENGTH OF PV-CICS-MSG-AREA2                    10664071
106650                TO PV-COMMAREA-LENGTH                             10665071
106660              EXEC CICS                                           10666071
106670                   WRITEQ TD                                      10667071
106680                    QUEUE  ('CSSL')                               10668071
106690                     FROM  (PV-CICS-MSG-AREA2)                    10669071
106700                   LENGTH  (PV-COMMAREA-LENGTH)                   10670071
106710                     RESP  (PV-CICS-RESP)                         10671071
106720              END-EXEC                                            10672071
106730             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          10673071
106740             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              10674071
106750             PERFORM 9900-SOFT-ABORT                              10675071
106760                                                                  10676071
106770         WHEN SQLWARN0 NOT = SPACES                               10677071
106780         WHEN SQLCODE < +0                                        10678071
106790         WHEN SQLCODE > +0                                        10679071
106800              MOVE '3660-GET-DUMMY-LABOR-TK'                      10680071
106810                                 TO DP013-PARAGRAPH               10681071
106820              MOVE 'GET DUMMY LABOR TK FOR PHYSICAL LABELS '      10682071
106830                                 TO DP013-MESSAGE-TEXT (1)        10683071
106840              MOVE SQLCA         TO DP013-SQLCA                   10684071
106850              MOVE 'TKRPRPM'     TO DP013-DB2-TABLE-NAME (1)      10685071
106860              SET DP013-DB2-ABEND                                 10686071
106870                  DP013-XCTL-DISPLAY-RESTART                      10687071
106880                                 TO TRUE                          10688071
106890              PERFORM DP013-0000-PROCESS-ABEND                    10689071
106900     END-EVALUATE.                                                10690071
106910                                                                  10691071
106920                                                                  10692071
106930*----------------------------------------------------------------*10693071
106940* IF PHYSICAL LABELS AND DUMMY USER IS NOT PART OF ACTIVE        *10694071
106950* DL LABOR ASSIGNMENT - CALL MODULE TO CREATE NEW ASSIGMENT      *10695071
106960*----------------------------------------------------------------*10696071
106970 3670-CREATE-DL-DUMMY-ASGMT.                                      10697071
106980                                                                  10698071
106990     SET  DL007-CREATE-NEW-ASGMT-WTEAM                            10699071
107000          DL007-COMMIT-UPDATE                                     10700071
107010          DL007-NO-LOG-TO-EAI-EXPORT                              10701071
107020          DL007-USR-IS-TMP              TO  TRUE.                 10702071
107030                                                                  10703071
107040     PERFORM 3680-GET-LABOR-DATE-TIME.                            10704071
107050     MOVE PV-LABOR-CURRENT-DATE   TO  DL007-NA-FLD-START-DTE.     10705071
107060     MOVE PV-LABOR-CURRENT-TIME   TO  DL007-NA-FLD-START-TM.      10706071
107070                                                                  10707071
107080     MOVE ASC-OPER-UNT-ID         TO  DL011-KEY-ASGMT-NBR-DC.     10708071
107090     SET  DL011-AN-RLABL-WRK-TYP  TO  TRUE.                       10709071
107100     MOVE DL011-KEY-ASGMT-NBR-TXT TO  DL007-NA-FLD-NBR-TXT.       10710071
107110                                                                  10711071
107120     MOVE PV-LABOR-DUMMY-TK       TO  DL007-NA-FLD-CRE-BY-USR-ID. 10712071
107130                                                                  10713071
107140     MOVE PC-CURRENT-PROGRAM-NAME TO  DL007-NA-FLD-CRE-PGM-NM     10714071
107150                                      DL007-ORIG-CALLING-PGM-NM.  10715071
107160                                                                  10716071
107170     SET  DL011-RLABL-WRK-TYP     TO  TRUE.                       10717071
107180     MOVE DL011-KEY-WK-TYP        TO  DL007-NA-FLD-WK-TYP-DESC.   10718071
107190                                                                  10719071
107200     MOVE PV-LABOR-DUMMY-TK       TO  DL011-RL-WRK-AREA-USER-ID.  10720071
107210     MOVE DL011-RLABL-WRK-AREA    TO  DL007-NA-FLD-WK-AREA-DESC.  10721071
107220                                                                  10722071
107230     MOVE ASC-OPER-UNT-ID         TO  DL007-NA-FLD-DC-NBR.        10723071
107240                                                                  10724071
107250     CALL DL007-USER-PGM USING DFHEIBLK                           10725071
107260                               DL007-COMMAREA                     10726071
107270                               DL007-ASGMT-COMMAREA.              10727071
107280                                                                  10728071
107290     EVALUATE TRUE                                                10729071
107300         WHEN DL007-SUCCESSFUL                                    10730071
107310              SET  ASC-ASSOC-LABOR-ASGMT-YES                      10731071
107320                   PS-LABOR-USE-DUMMY-ASGMT-YES TO TRUE           10732071
107330              MOVE DL007-NEW-START-DTE          TO                10733071
107340                   PV-LABOR-ASGMT-STRT-DTE                        10734071
107350              MOVE DL007-NEW-NBR-TXT            TO                10735071
107360                   PV-LABOR-ASGMT-NBR-TXT                         10736071
107370              MOVE DL007-NEW-ASGMT-NBR-SEQ-NBR  TO                10737071
107380                   PV-LABOR-ASGMT-NBR-SEQ-NBR                     10738071
107390                                                                  10739071
107400         WHEN OTHER                                               10740071
107410              MOVE ASC-OPER-UNT-ID   TO  PV-DISPLAY-OPER          10741071
107420              MOVE ASC-PO-NBR        TO  PV-DISPLAY-PO-NBR        10742071
107430              MOVE ASC-REC-SEQ-NBR   TO  PV-DISPLAY-RCVR-SEQ-NBR  10743071
107440              MOVE DL007-ASGMT-SQLCODE                            10744071
107450                                     TO  PV-DISPLAY-SQLCODE       10745071
107460              INITIALIZE PV-CICS-MSG-AREA2                        10746071
107470              STRING ' PCKCS701-3670- '                           10747071
107480                      PV-DISPLAY-OPER   '-'                       10748071
107490                      PV-DISPLAY-PO-NBR '-'                       10749071
107500                      PV-DISPLAY-RCVR-SEQ-NBR ' - '               10750071
107510                      DP020-USERID ' - '                          10751071
107520                      PV-LABOR-DUMMY-TK ' - '                     10752071
107530                     'SQLCODE=' PV-DISPLAY-SQLCODE                10753071
107540                     ' - RETURN CODE=' DL007-RETURN-CODE          10754071
107550                                                DELIMITED BY SIZE 10755071
107560                                           INTO PV-CICS-MSG-AREA2 10756071
107570               MOVE LENGTH OF PV-CICS-MSG-AREA2                   10757071
107580                                             TO PV-COMMAREA-LENGTH10758071
107590               EXEC CICS                                          10759071
107600                    WRITEQ TD                                     10760071
107610                     QUEUE  ('CSSL')                              10761071
107620                      FROM  (PV-CICS-MSG-AREA2)                   10762071
107630                    LENGTH  (PV-COMMAREA-LENGTH)                  10763071
107640                      RESP  (PV-CICS-RESP)                        10764071
107650               END-EXEC                                           10765071
107660                                                                  10766071
107670              INITIALIZE PV-CICS-MSG-AREA2                        10767071
107680              STRING ' PCKCS701-' DL007-USER-PGM                  10768071
107690                      ' -- ' DL007-SQL-ERROR-PARA                 10769071
107700                      ' -- ' DL007-CALL-MOD-FAIL-NM               10770071
107710                      ' -- ' DL007-CALL-MOD-FAIL-ERR-CDE          10771071
107720                                                DELIMITED BY SIZE 10772071
107730                                           INTO PV-CICS-MSG-AREA2 10773071
107740               MOVE LENGTH OF PV-CICS-MSG-AREA2                   10774071
107750                                             TO PV-COMMAREA-LENGTH10775071
107760               EXEC CICS                                          10776071
107770                    WRITEQ TD                                     10777071
107780                     QUEUE  ('CSSL')                              10778071
107790                      FROM  (PV-CICS-MSG-AREA2)                   10779071
107800                    LENGTH  (PV-COMMAREA-LENGTH)                  10780071
107810                      RESP  (PV-CICS-RESP)                        10781071
107820               END-EXEC                                           10782071
107830                                                                  10783071
107840              INITIALIZE PV-CICS-MSG-AREA2                        10784071
107850              STRING ' PCKCS701-' DL007-USER-PGM                  10785071
107860                      ' DL007-NA-FLD-WK-TYP-DESC='                10786071
107870                      DL007-NA-FLD-WK-TYP-DESC                    10787071
107880                                                DELIMITED BY SIZE 10788071
107890                                           INTO PV-CICS-MSG-AREA2 10789071
107900               MOVE LENGTH OF PV-CICS-MSG-AREA2                   10790071
107910                                             TO PV-COMMAREA-LENGTH10791071
107920               EXEC CICS                                          10792071
107930                    WRITEQ TD                                     10793071
107940                     QUEUE  ('CSSL')                              10794071
107950                      FROM  (PV-CICS-MSG-AREA2)                   10795071
107960                    LENGTH  (PV-COMMAREA-LENGTH)                  10796071
107970                      RESP  (PV-CICS-RESP)                        10797071
107980               END-EXEC                                           10798071
107990                                                                  10799071
108000                                                                  10800071
108010              INITIALIZE PV-CICS-MSG-AREA2                        10801071
108020              STRING ' PCKCS701-' DL007-USER-PGM                  10802071
108030                      ' DL007-NA-FLD-WK-AREA-DESC='               10803071
108040                      DL007-NA-FLD-WK-AREA-DESC                   10804071
108050                                                DELIMITED BY SIZE 10805071
108060                                           INTO PV-CICS-MSG-AREA2 10806071
108070               MOVE LENGTH OF PV-CICS-MSG-AREA2                   10807071
108080                                             TO PV-COMMAREA-LENGTH10808071
108090               EXEC CICS                                          10809071
108100                    WRITEQ TD                                     10810071
108110                     QUEUE  ('CSSL')                              10811071
108120                      FROM  (PV-CICS-MSG-AREA2)                   10812071
108130                    LENGTH  (PV-COMMAREA-LENGTH)                  10813071
108140                      RESP  (PV-CICS-RESP)                        10814071
108150               END-EXEC                                           10815071
108160                                                                  10816071
108170               MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER        10817071
108180               SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE            10818071
108190               PERFORM 9900-SOFT-ABORT                            10819071
108200                                                                  10820071
108210     END-EVALUATE.                                                10821071
108220                                                                  10822071
108230                                                                  10823071
108240                                                                  10824071
108250 3680-GET-LABOR-DATE-TIME.                                        10825071
108260                                                                  10826071
108270     EXEC SQL                                                     10827071
108280          SET  :PV-LABOR-CURRENT-DATE  =  CURRENT_DATE            10828071
108290              ,:PV-LABOR-CURRENT-TIME  =  CURRENT_TIME            10829071
108300     END-EXEC.                                                    10830071
108310                                                                  10831071
108320                                                                  10832071
108330*----------------------------------------------------------------*10833071
108340*    CHECK RECEIVER TYPE.  IF RECEIVER IS AN "ap" RECEIVER       *10834071
108350*    CASEPACK CANNOT BE RUN.                                     *10835071
108360*----------------------------------------------------------------*10836071
108370 3700-CHECK-RECEIVER-TYPE.                                        10837071
108380                                                                  10838071
108390     MOVE ASC-PO-NBR         TO  RECEIV-ORD-NBR.                  10839071
108400     MOVE ASC-REC-SEQ-NBR    TO  RECEIV-REC-SEQ-NBR.              10840071
108410                                                                  10841071
108420     EXEC SQL                                                     10842071
108430          SELECT  REC_TYP_CDE                                     10843071
108440                , DATE(REC_TMST)                                  10844071
108450                , GOH_IND                                         10845071
108460            INTO :RECEIV-REC-TYP-CDE                              10846071
108470               , :ASC-TRIP-ARRIVE-DATE                            10847071
108480               , :ASC-HANGER-IND                                  10848071
108490            FROM  TRECEIV                                         10849071
108500           WHERE  ORD_NBR           = :RECEIV-ORD-NBR             10850071
108510             AND  REC_SEQ_NBR       = :RECEIV-REC-SEQ-NBR         10851071
108520     END-EXEC.                                                    10852071
108530                                                                  10853071
108540     EVALUATE TRUE                                                10854071
108550                                                                  10855071
108560         WHEN SQLCODE = +0                                        10856071
108570              IF  RECEIV-REC-TYP-CDE  = 'AP'                      10857071
108580                  MOVE  PC-TSYMSG-03342  TO  DP020-MSG-NUMBER     10858071
108590                  SET  PS-ERROR                   TO TRUE         10859071
108600              END-IF                                              10860071
108610              IF  RECEIV-REC-TYP-CDE  = 'CR'                      10861071
108620                  MOVE  PC-TSYMSG-03404  TO  DP020-MSG-NUMBER     10862071
108630                  SET  PS-ERROR                   TO TRUE         10863071
108640              END-IF                                              10864071
108650                                                                  10865071
108660         WHEN SQLCODE = -904                                      10866071
108670         WHEN SQLCODE = -911                                      10867071
108680         WHEN SQLCODE = -913                                      10868071
108690              MOVE SQLCODE                   TO PV-SOFT-SQLCODE   10869071
108700              MOVE '3700-CHECK-RECEIVER-TYP' TO PV-SOFT-PARAGRAPH 10870071
108710              MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2 10871071
108720              MOVE LENGTH OF PV-CICS-MSG-AREA2                    10872071
108730                TO PV-COMMAREA-LENGTH                             10873071
108740              EXEC CICS                                           10874071
108750                   WRITEQ TD                                      10875071
108760                    QUEUE  ('CSSL')                               10876071
108770                     FROM  (PV-CICS-MSG-AREA2)                    10877071
108780                   LENGTH  (PV-COMMAREA-LENGTH)                   10878071
108790                     RESP  (PV-CICS-RESP)                         10879071
108800              END-EXEC                                            10880071
108810             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          10881071
108820             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              10882071
108830             PERFORM 9900-SOFT-ABORT                              10883071
108840                                                                  10884071
108850         WHEN SQLWARN0 NOT = SPACES                               10885071
108860         WHEN SQLCODE < +0                                        10886071
108870         WHEN SQLCODE > +0                                        10887071
108880              MOVE '3700-CHECK-RECEIVER-TYPE'                     10888071
108890                                 TO DP013-PARAGRAPH               10889071
108900              MOVE 'GET RECEIVER TYPE CODE                 '      10890071
108910                                 TO DP013-MESSAGE-TEXT (1)        10891071
108920              MOVE SQLCA         TO DP013-SQLCA                   10892071
108930              MOVE 'TRECEIV'     TO DP013-DB2-TABLE-NAME (1)      10893071
108940              SET DP013-DB2-ABEND                                 10894071
108950                  DP013-XCTL-DISPLAY-RESTART                      10895071
108960                                 TO TRUE                          10896071
108970              PERFORM DP013-0000-PROCESS-ABEND                    10897071
108980     END-EVALUATE.                                                10898071
108990                                                                  10899071
109000                                                                  10900071
109100*----------------------------------------------------------------*10910071
109110*    CHECK curr oper on receiver - if it does not match the user *10911071
109120*    sign on oper - cannot process casepack split                *10912071
109130*----------------------------------------------------------------*10913071
109140 3720-CHECK-CURR-OPER.                                            10914071
109150                                                                  10915071
109160     MOVE ASC-PO-NBR         TO  RECEIV-ORD-NBR.                  10916071
109170     MOVE ASC-REC-SEQ-NBR    TO  RECEIV-REC-SEQ-NBR.              10917071
109180                                                                  10918071
109181     EXEC SQL                                                     10918171
109182          SELECT  CURR_OPER_UNT_ID                                10918271
109183                , DATE(REC_TMST)                                  10918371
109184            INTO :RECEIV-CURR-OPER-UNT-ID                         10918471
109185               , :ASC-TRIP-ARRIVE-DATE                            10918571
109186            FROM  TRECEIV                                         10918671
109187           WHERE  ORD_NBR           = :RECEIV-ORD-NBR             10918771
109188             AND  REC_SEQ_NBR       = :RECEIV-REC-SEQ-NBR         10918871
109189     END-EXEC.                                                    10918971
109190                                                                  10919071
109191     EVALUATE TRUE                                                10919171
109192                                                                  10919271
109193         WHEN SQLCODE = +0                                        10919371
109194              IF  RECEIV-CURR-OPER-UNT-ID = DP020-LOCATION-NBR    10919471
109195                  CONTINUE                                        10919571
109196              ELSE                                                10919671
109197                 MOVE  PC-TSYMSG-03598                            10919771
109198                                         TO  DP020-MSG-NUMBER     10919871
109199                 MOVE  RECEIV-CURR-OPER-UNT-ID                    10919971
109200                                         TO  DP020-MSG-TEXT       10920071
109201                 SET  PS-ERROR               TO TRUE              10920171
109202              END-IF                                              10920271
109203                                                                  10920371
109204         WHEN SQLCODE = -904                                      10920471
109205         WHEN SQLCODE = -911                                      10920571
109206         WHEN SQLCODE = -913                                      10920671
109207              MOVE SQLCODE                   TO PV-SOFT-SQLCODE   10920771
109208              MOVE '3720-CHECK-CURR-OPER'    TO PV-SOFT-PARAGRAPH 10920871
109209              MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2 10920971
109210              MOVE LENGTH OF PV-CICS-MSG-AREA2                    10921071
109220                TO PV-COMMAREA-LENGTH                             10922071
109221              EXEC CICS                                           10922171
109222                   WRITEQ TD                                      10922271
109223                    QUEUE  ('CSSL')                               10922371
109224                     FROM  (PV-CICS-MSG-AREA2)                    10922471
109225                   LENGTH  (PV-COMMAREA-LENGTH)                   10922571
109226                     RESP  (PV-CICS-RESP)                         10922671
109227              END-EXEC                                            10922771
109228             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          10922871
109229             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              10922971
109230             PERFORM 9900-SOFT-ABORT                              10923071
109231                                                                  10923171
109232         WHEN SQLWARN0 NOT = SPACES                               10923271
109233         WHEN SQLCODE < +0                                        10923371
109234         WHEN SQLCODE > +0                                        10923471
109235              MOVE '3720-CHECK-CURR-OPER'                         10923571
109236                                 TO DP013-PARAGRAPH               10923671
109237              MOVE 'GET RECEIVER CURRENT OPER UNIT ID      '      10923771
109238                                 TO DP013-MESSAGE-TEXT (1)        10923871
109239              MOVE SQLCA         TO DP013-SQLCA                   10923971
109240              MOVE 'TRECEIV'     TO DP013-DB2-TABLE-NAME (1)      10924071
109241              SET DP013-DB2-ABEND                                 10924171
109242                  DP013-XCTL-DISPLAY-RESTART                      10924271
109243                                 TO TRUE                          10924371
109244              PERFORM DP013-0000-PROCESS-ABEND                    10924471
109245     END-EVALUATE.                                                10924571
109246                                                                  10924671
109247                                                                  10924771
109248*----------------------------------------------------------------*10924871
109249*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *10924971
109250*    INITIALIZE ALL COUNTERS AND FLAGS.                          *10925071
109251*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *10925171
109252*    DISPLAY THE PANEL TO USER.                                  *10925271
109253*----------------------------------------------------------------*10925371
109254 4000-BUILD-INITIAL-PANEL.                                        10925471
109255                                                                  10925571
109256     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            10925671
109257                                 ASC-BLOCK-ENTRIES (2).           10925771
109258     MOVE +1                 TO ASC-BLK-SUB.                      10925871
109259     SET PS-ITEMS-LEFT-ON-DB                                      10925971
109260                             TO TRUE.                             10926071
109270                                                                  10927071
109280     MOVE +0                 TO ASC-ITEM-SUB                      10928071
109290                                ASC-NUMBER-OF-ITEMS-READ          10929071
109300                                ASC-NUMBER-OF-SELECTED-ITEMS      10930071
109310                                ASC-HIGHEST-BLOCK-WRITTEN         10931071
109320                                ASC-START-OF-SELECTED-RANGE       10932071
109330                                ASC-END-OF-SELECTED-RANGE         10933071
109340                                ASC-ITEM-AT-TOP-OF-PANEL.         10934071
109350                                                                  10935071
109360     PERFORM 4050-CHECK-TROUBLE.                                  10936071
109370                                                                  10937071
109380     PERFORM 4055-CHECK-PREPK-99.                                 10938071
109390                                                                  10939071
109400     IF  PS-NO-ERROR                                              10940071
109410         PERFORM 4060-GET-DEPARTMENT.                             10941071
109420                                                                  10942071
109430     IF  PS-NO-ERROR                                              10943071
109440         PERFORM 4065-SELECT-STORE-ZONE.                          10944071
109450*-------------------------------------------------                10945071
109460*   CHECK IF DC IS SET UP FOR HAZARDOUS FREIGHT                   10946071
109470*--------------------------------------------------               10947071
109480     IF  PS-NO-ERROR                                              10948071
109490         PERFORM 3348-CHK-WTHR-HAZFACLTY                          10949071
109500     END-IF.                                                      10950071
109501                                                                  10950171
109502                                                                  10950271
109503*-----------------------------------------------------------------10950371
109504*                                                                 10950471
109505*** CHECK HOW DC IS PROCESSING P2L FREIGHT                        10950571
109506***       HANG/FOLD   (COMBINE ZONES: CHILD, MENS,JRS, WOMEN)     10950671
109507***       HANG/COMMODITY                                          10950771
109508***       COMMODITY                                               10950871
109509*** IF HANG/FOLD OR HANG/COMMODITY THE DEFAULT STORE ZONE TO      10950971
109510*** TO BE DISPLAYED WOULD BE FOR WHATEVER ZONE WOULD HAVE THE     10951071
109520*** MOST LINES:                                                   10952071
109530*** EX: RECEIVER HAS 5 LINES.  3 LINES ARE HANG  2 LINES ARE FOLD 10953071
109540***     THE DEFAULT STORE ZONE WOULD BE HANG                      10954071
109541*                                                                 10954171
109542*   1.  COUNT THE NUMBER OF RCVR LINES WITH HANG PRESENTATION     10954271
109543*   2.  COUNT THE NUMBER OF RCVR LINES WITH FOLD PRESENTATION     10954371
109544*   3.  COUNT THE NUMBER OF RCVR LINES WITH OTHER PRESENTATION    10954471
109545*   4.  GET GOH_IND (GOODS ON HAND FROM RECEIVER)                 10954571
109546*       Y=VENDOR HANG AGREEMENT   N=NO VENDOR HANG AGREEMENT      10954671
109547*                                                                 10954771
109548*   IF DC IS PROCESSING P2L AS HANG/FOLD  AND                     10954871
109549*      STORE ZONE FOR RECEIVER = CHILD, JRS, MENS, WOMEN          10954971
109550*          IF GOH-IND = Y    ADD OTHER-COUNT TO HANG-COUNT        10955071
109551*          IF GOH-IND = N    ADD OTHER-COUNT TO FOLD-COUNT        10955171
109552*      IF HANG-COUNT >  FOLD-COUNT =====  STORE-ZONE HANG         10955271
109553*         ELSE                                                    10955371
109554*      STORE-ZONE FOR P2L WILL BE FOLD                            10955471
109555*                                                                 10955571
109556* ELSE                                                            10955671
109557*                                                                 10955771
109558*   IF DC IS PROCESSING P2L AS HANG/COMMODITY AND                 10955871
109559*      STORE ZONE FOR RECEIVER = CHILD, JRS, MENS, WOMEN          10955971
109560*          IF GOH-IND = Y    ADD OTHER-COUNT TO HANG-COUNT        10956071
109561*          IF GOH-IND = N    ADD OTHER-COUNT TO COMMODITY-COUNT   10956171
109562*      IF HANG-COUNT >  COMMODITY-COUNT =====  STORE-ZONE HANG    10956271
109563*         ELSE                                                    10956371
109564*      STORE-ZONE FOR P2L WILL BE COMMODITY                       10956471
109565*                                                                 10956571
109566*-----------------------------------------------------------------10956671
109567*                                                                 10956771
109568*** HOW IS DC PROCESSING P2L FREIGHT                              10956871
109569*                                                                 10956971
109570     IF  PS-NO-ERROR                                              10957071
109571         PERFORM 4076-CHECK-P2L-ZONES                             10957171
109572     END-IF.                                                      10957271
109573                                                                  10957371
109574*                                                                 10957471
109575*** IS THE STORE ZONE ONE OF THE ZONES BEING PROCESSED AS H/F     10957571
109576*                                                                 10957671
109577     IF  PS-NO-ERROR                                              10957771
109578         IF  ASC-HANG-FOLD       OR                               10957871
109579             ASC-HANG-COMMODITY                                   10957971
109580             PERFORM 4077-CHECK-HANG-FOLD                         10958071
109581         END-IF                                                   10958171
109582     END-IF.                                                      10958271
109583                                                                  10958371
109584*                                                                 10958471
109585*** COUNT THE NUMBER OF LINES ON THE RCVR WITH HANG PRESENTATION  10958571
109586*                                                                 10958671
109587     IF  PS-NO-ERROR                                              10958771
109588         IF  ASC-HANG-FOLD       OR                               10958871
109589             ASC-HANG-COMMODITY                                   10958971
109590             PERFORM 4078-COUNT-HANG                              10959071
109591         END-IF                                                   10959171
109592     END-IF.                                                      10959271
109593                                                                  10959371
109594*                                                                 10959471
109595*** COUNT THE NUMBER OF LINES ON THE RCVR WITH FOLD PRESENTATION  10959571
109596*                                                                 10959671
109597     IF  PS-NO-ERROR                                              10959771
109598         IF  ASC-HANG-FOLD                                        10959871
109599             PERFORM 4079-COUNT-FOLD                              10959971
109600         END-IF                                                   10960071
109601     END-IF.                                                      10960171
109602                                                                  10960271
109603*                                                                 10960371
109604*** COUNT THE NUMBER OF LINES ON THE RCVR BY COMMODITY NOT HANG   10960471
109605*                                                                 10960571
109606     IF  PS-NO-ERROR                                              10960671
109607         IF  ASC-HANG-COMMODITY                                   10960771
109608             PERFORM 4080-COUNT-COMMODITY                         10960871
109609         END-IF                                                   10960971
109610     END-IF.                                                      10961071
109611                                                                  10961171
109612*                                                                 10961271
109613*** COUNT THE NUMBER OF LINES ON THE RCVR NOT H/F PRESENTATION    10961371
109614*                                                                 10961471
109615     IF  PS-NO-ERROR                                              10961571
109616         IF  ASC-HANG-FOLD                                        10961671
109617             PERFORM 4081-COUNT-OTHER                             10961771
109618         END-IF                                                   10961871
109619     END-IF.                                                      10961971
109620                                                                  10962071
109621*                                                                 10962171
109622* DC PROCESSING P2L AS HANG/FOLD                                  10962271
109623* VENDOR HANGER AGREEMENT (GOH-IND = Y) ADD OTHER TO HANG-COUNT   10962371
109624*                                                                 10962471
109625* DC PROCESSING P2L AS HANG/FOLD                                  10962571
109626* VENDOR HANGER AGREEMENT (GOH-IND = N) ADD OTHER TO FOLD-COUNT   10962671
109627*                                                                 10962771
109628     IF  PS-NO-ERROR                                              10962871
109629         IF  ASC-HANG-FOLD                                        10962971
109630             IF  ASC-HANGER-AGREEMENT                             10963071
109631                 ADD  PV-OTHER-COUNT  TO  PV-HANG-COUNT           10963171
109632                 MOVE ZEROES          TO  PV-OTHER-COUNT          10963271
109633             ELSE                                                 10963371
109634                 ADD  PV-OTHER-COUNT  TO  PV-FOLD-COUNT           10963471
109635                 MOVE ZEROES          TO  PV-OTHER-COUNT          10963571
109636             END-IF                                               10963671
109637         END-IF                                                   10963771
109638     END-IF.                                                      10963871
109639                                                                  10963971
109640*                                                                 10964071
109650* DC PROCESSING P2L AS HANG/COMMODITY                             10965071
109651* VENDOR HANGER AGREEMENT (GOH-IND = Y) ADD OTHER TO HANG-COUNT   10965171
109652*                                                                 10965271
109653     IF  PS-NO-ERROR                                              10965371
109654         IF  ASC-HANG-COMMODITY                                   10965471
109655             IF  ASC-HANGER-AGREEMENT                             10965571
109656                 ADD  PV-OTHER-COUNT  TO  PV-HANG-COUNT           10965671
109657                 MOVE ZEROES          TO  PV-OTHER-COUNT          10965771
109658             END-IF                                               10965871
109659         END-IF                                                   10965971
109660     END-IF.                                                      10966071
109661                                                                  10966171
109662*                                                                 10966271
109663***  IF  DC IS PROCESSING P2L AS HANG/FOLD                        10966371
109664***       IF  HANG-COUNT >=  FOLD COUNT                           10966471
109665***           STORE ZONE WILL BE "HANG"                           10966571
109666***       OHERWISE                                                10966671
109667***           STORE ZONE WILL BE "FOLD"                           10966771
109668*                                                                 10966871
109669     IF  PS-NO-ERROR                                              10966971
109670         IF  ASC-HANG-FOLD                                        10967071
109671                                                                  10967171
109672             IF  PV-HANG-COUNT  >  PV-FOLD-COUNT  OR              10967271
109673                 PV-HANG-COUNT  =  PV-FOLD-COUNT                  10967371
109674                 MOVE  'HANG'  TO  ASC-DFLT-STR-ZN-ID             10967471
109675                                   PC120-DFLT-STR-ZN-ID           10967571
109676             ELSE                                                 10967671
109677                 MOVE  'FOLD'  TO  ASC-DFLT-STR-ZN-ID             10967771
109678                                   PC120-DFLT-STR-ZN-ID           10967871
109679             END-IF                                               10967971
109680         END-IF                                                   10968071
109690     END-IF.                                                      10969071
109700                                                                  10970071
109701*                                                                 10970171
109702***  IF  DC IS PROCESSING P2L AS HANG/COMMODITY                   10970271
109703***       IF  HANG-COUNT >=  COMMODITY COUNT                      10970371
109704***           STORE ZONE WILL BE "HANG"                           10970471
109705***       OHERWISE                                                10970571
109706***           STORE ZONE WILL BE COMMODITY                        10970671
109707*                                                                 10970771
109708     IF  PS-NO-ERROR                                              10970871
109709         IF  ASC-HANG-COMMODITY                                   10970971
109710             IF  PV-HANG-COUNT  >  PV-COMMODITY-COUNT  OR         10971071
109711                 PV-HANG-COUNT  =  PV-COMMODITY-COUNT             10971171
109712                 MOVE  'HANG'  TO  ASC-DFLT-STR-ZN-ID             10971271
109713             END-IF                                               10971371
109714         END-IF                                                   10971471
109715     END-IF.                                                      10971571
109716                                                                  10971671
109717                                                                  10971771
109718     IF  PS-NO-ERROR                                              10971871
109719         PERFORM 4070-CHECK-SEASET-ITEM.                          10971971
109720                                                                  10972071
109721     IF  PS-NO-ERROR                                              10972171
109722         PERFORM 4086-CHECK-DC-DIRECTIVES.                        10972271
109723                                                                  10972371
109724     IF  PS-NO-ERROR                                              10972471
109725         PERFORM 4506A-CHECK-FOR-RECLAIM-LBL.                     10972571
109726                                                                  10972671
109727*-----------------------------------------------------------------10972771
109728* FIND P2L MODULE NUMBERS FOR THE DEFAULT STORE ZONE              10972871
109729*-----------------------------------------------------------------10972971
109730     IF  PS-NO-ERROR                                              10973071
109731         PERFORM 4090-GET-P2L-MODULES                             10973171
109732         MOVE PMT-MODULE(1)  TO  MMOD1O                           10973271
109733         MOVE PMT-MODULE(2)  TO  MMOD2O                           10973371
109734         MOVE PMT-MODULE(3)  TO  MMOD3O                           10973471
109735         MOVE PMT-MODULE(4)  TO  MMOD4O                           10973571
109736         MOVE PMT-MODULE(5)  TO  MMOD5O                           10973671
109737     END-IF                                                       10973771
109738                                                                  10973871
109739                                                                  10973971
109740     IF  PS-NO-ERROR AND PS-NO-CRITERIA-CHANGE                    10974071
109741         PERFORM 4304-CHECK-UCC128-DATA.                          10974171
109742                                                                  10974271
109743     IF  PS-NO-ERROR AND PS-NO-CRITERIA-CHANGE                    10974371
109744         PERFORM 8210-PROCESS-DC-DEFAULTS.                        10974471
109745                                                                  10974571
109746     IF  PS-NO-ERROR                                              10974671
109747         PERFORM 4110-OPEN-CURSOR.                                10974771
109748                                                                  10974871
109749     IF  PS-NO-ERROR                                              10974971
109750         PERFORM 4300-READ-ITEMS-FROM-DB.                         10975071
109760                                                                  10976071
109770     IF  PS-NO-ERROR                                              10977071
109780         PERFORM 4120-CLOSE-CURSOR.                               10978071
109790                                                                  10979071
109800     IF  PS-NO-ERROR                                              10980071
109900         MOVE +1                   TO  PV-TOP-ITEM                10990071
109910         IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                      10991071
109920             SET DP020-MSG-FATAL   TO  TRUE                       10992071
109930             MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER           10993071
109940             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10994071
109950             PERFORM                                              10995071
109960                 VARYING PV-SUB                                   10996071
109970                 FROM 1 BY 1                                      10997071
109980                 UNTIL PV-SUB > PC-ITEMS-PER-PANEL                10998071
109990                       MOVE DP015-ASK-DRK-OFF                     10999071
110000                                 TO MR-SELECTA (PV-SUB)           11000071
110010                                    MR-PROCESS-QTYA (PV-SUB)      11001071
110020                                    MR-TRANSCRIB-QTYA (PV-SUB)    11002071
110030                                    MR-P2L-LBL-CNTA (PV-SUB)      11003071
110040                                    MR-SHP-LBL-CNTA (PV-SUB)      11004071
110050                                    MR-MODA (PV-SUB)              11005071
110060                                    MR-CARTON-CNTA (PV-SUB)       11006071
110070                                    MR-INNER-PACKA (PV-SUB)       11007071
110080                                    MR-OUTER-PACKA (PV-SUB)       11008071
110090                                    MR-IN-PCK-CONVYA (PV-SUB)     11009071
110100                                    MR-LBL-TYPEA (PV-SUB)         11010071
110110                                    MR-CRE-LBL-OPTA(PV-SUB)       11011071
110120                                    MR-CSEPK-AREAA(PV-SUB)        11012071
110130                                    MR-ODD-CARTONA (PV-SUB)       11013071
110140                       MOVE DP015-HL-OFF                          11014071
110150                                 TO MR-SELECTH (PV-SUB)           11015071
110160                                    MR-MODH (PV-SUB)              11016071
110170                                    MR-CARTON-CNTH (PV-SUB)       11017071
110180                                    MR-INNER-PACKH (PV-SUB)       11018071
110190                                    MR-OUTER-PACKH (PV-SUB)       11019071
110200                                    MR-IN-PCK-CONVYH (PV-SUB)     11020071
110210                                    MR-LBL-TYPEH (PV-SUB)         11021071
110220                                    MR-CRE-LBL-OPTH (PV-SUB)      11022071
110230                                    MR-CSEPK-AREAH (PV-SUB)       11023071
110240                                    MR-ODD-CARTONH (PV-SUB)       11024071
110250                                                                  11025071
110260                       MOVE SPACE                                 11026071
110270                                 TO MR-SELECTI (PV-SUB)           11027071
110280                                    MR-ACTION (PV-SUB)            11028071
110290                                    MR-SKU (PV-SUB)               11029071
110300                                    MR-OUTER-PACK (PV-SUB)        11030071
110310                                    MR-IN-PCK-CONVY (PV-SUB)      11031071
110320                                    MR-LBL-TYPE (PV-SUB)          11032071
110330                                    MR-CRE-LBL-OPT (PV-SUB)       11033071
110340                                    MR-CSEPK-AREA (PV-SUB)        11034071
110350                                    MR-LINE-STATUS (PV-SUB)       11035071
110360                                                                  11036071
110370                       MOVE ZEROES                                11037071
110380                                 TO MR-PO-LINE (PV-SUB)           11038071
110390                                    MR-MOD (PV-SUB)               11039071
110400                                    MR-CARTON-CNT (PV-SUB)        11040071
110410                                    MR-INNER-PACK (PV-SUB)        11041071
110420                                    MR-PROCESS-QTY (PV-SUB)       11042071
110430                                    MR-TRANSCRIB-QTY (PV-SUB)     11043071
110440                                    MR-P2L-LBL-CNT (PV-SUB)       11044071
110450                                    MR-SHP-LBL-CNT (PV-SUB)       11045071
110460                                    MR-ODD-CARTON (PV-SUB)        11046071
110470             END-PERFORM                                          11047071
110480         ELSE                                                     11048071
110490             MOVE -1               TO ALBLOPTL                    11049071
110500             SET DP030-SET-CURSOR-APPL-1                          11050071
110510                                   TO TRUE                        11051071
110520             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11052071
110530             IF  PS-UCC128-CRTN-MLT-LNE                           11053071
110540                 SET DP020-MSG-FATAL                              11054071
110550                     ASC-UCC128-MLT-LNE-YES  TO  TRUE             11055071
110560                 MOVE PC-TSYMSG-02502 TO  DP020-MSG-NUMBER        11056071
110570             END-IF                                               11057071
110580         END-IF                                                   11058071
110590     END-IF.                                                      11059071
110600                                                                  11060071
110610*----------------------------------------------------------------*11061071
110620* AUTO SELECT LINE IF PROCESSING USING UCC128 DATA               *11062071
110630*----------------------------------------------------------------*11063071
110640 4020-AUTO-SELECT-LINES.                                          11064071
110650                                                                  11065071
110660     MOVE +1                       TO ASC-BLK-SUB.                11066071
110670                                                                  11067071
110680     PERFORM 4021-SET-AUTO-SELECT-INDS                            11068071
110690         VARYING ASC-ITEM-SUB                                     11069071
110700         FROM 1 BY 1                                              11070071
110710         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 11071071
110720                                                                  11072071
110730     ADD +1                        TO ASC-BLK-SUB.                11073071
110740                                                                  11074071
110750     PERFORM 4021-SET-AUTO-SELECT-INDS                            11075071
110760         VARYING ASC-ITEM-SUB                                     11076071
110770         FROM 1 BY 1                                              11077071
110780         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 11078071
110790                                                                  11079071
110800     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               11080071
110810                                   TO PV-LIST-ITEM-NUMBER.        11081071
110820                                                                  11082071
110830     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            11083071
110840         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    11084071
110850                                                                  11085071
110860     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            11086071
110870         MOVE +1                   TO ASC-BLK-SUB                 11087071
110880                                                                  11088071
110890         PERFORM 5100-WRITE-TEMP-STORAGE                          11089071
110900         MOVE +2                   TO ASC-BLK-SUB                 11090071
110910         PERFORM 5100-WRITE-TEMP-STORAGE                          11091071
110920         MOVE +1                   TO ASC-BLK-SUB                 11092071
110930         MOVE +1                   TO PV-BLOCK-NUMBER             11093071
110940     END-IF.                                                      11094071
110950                                                                  11095071
110960     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     11096071
110970        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    11097071
110980         MOVE +1                   TO ASC-BLK-SUB                 11098071
110990                                                                  11099071
111000         PERFORM 5100-WRITE-TEMP-STORAGE                          11100071
111010         MOVE +2                   TO ASC-BLK-SUB                 11101071
111020         PERFORM 5100-WRITE-TEMP-STORAGE                          11102071
111030         MOVE +1                   TO ASC-BLK-SUB                 11103071
111040         MOVE +1                   TO PV-BLOCK-NUMBER             11104071
111050                                                                  11105071
111060         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         11106071
111070             PV-FIRST-BLOCK-IN-ARRAY - 1                          11107071
111080                                                                  11108071
111090         PERFORM                                                  11109071
111100             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       11110071
111110                                                                  11111071
111120             PERFORM 4410-READ-TEMP-STORAGE                       11112071
111130                                                                  11113071
111140             PERFORM 4021-SET-AUTO-SELECT-INDS                    11114071
111150                 VARYING ASC-ITEM-SUB                             11115071
111160                 FROM 1 BY 1                                      11116071
111170                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          11117071
111180                                                                  11118071
111190             PERFORM 5100-WRITE-TEMP-STORAGE                      11119071
111200                                                                  11120071
111210             ADD +1                TO PV-BLOCK-NUMBER             11121071
111220                                                                  11122071
111230         END-PERFORM                                              11123071
111240                                                                  11124071
111250         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         11125071
111260             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     11126071
111270                                                                  11127071
111280         PERFORM                                                  11128071
111290             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       11129071
111300                   ASC-HIGHEST-BLOCK-WRITTEN                      11130071
111310                                                                  11131071
111320             MOVE PV-NEXT-BLOCK-IN-ARRAY                          11132071
111330                                   TO PV-BLOCK-NUMBER             11133071
111340                                                                  11134071
111350             PERFORM 4410-READ-TEMP-STORAGE                       11135071
111360                                                                  11136071
111370             PERFORM 4021-SET-AUTO-SELECT-INDS                    11137071
111380                 VARYING ASC-ITEM-SUB                             11138071
111390                 FROM 1 BY 1                                      11139071
111400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          11140071
111410                                                                  11141071
111420             PERFORM 5100-WRITE-TEMP-STORAGE                      11142071
111430                                                                  11143071
111440             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      11144071
111450                                                                  11145071
111460         END-PERFORM                                              11146071
111470                                                                  11147071
111480         MOVE PV-FIRST-BLOCK-IN-ARRAY                             11148071
111490                                   TO PV-BLOCK-NUMBER             11149071
111500                                                                  11150071
111510         PERFORM 4410-READ-TEMP-STORAGE                           11151071
111520     END-IF.                                                      11152071
111530                                                                  11153071
111540                                                                  11154071
111550     MOVE PV-AUTO-SELECT-LINES  TO                                11155071
111560                       ASC-NUMBER-OF-SELECTED-ITEMS.              11156071
111570                                                                  11157071
111580                                                                  11158071
111590*----------------------------------------------------------------*11159071
111600*    MARK EACH ITEM AS BEING SELECTED.                           *11160071
111610*----------------------------------------------------------------*11161071
111620 4021-SET-AUTO-SELECT-INDS.                                       11162071
111630     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)  > 0      11163071
111640         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)     AND     11164071
111650             ASC-NOT-PROTECTED(ASC-BLK-SUB ASC-ITEM-SUB)  AND     11165071
111660             ASC-NO-LINE-ERROR(ASC-BLK-SUB ASC-ITEM-SUB)          11166071
111670                 SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)         11167071
111680                     ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)    11168071
111690                     ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              11169071
111700                                   TO  TRUE                       11170071
111710                 ADD  1  TO  PV-AUTO-SELECT-LINES                 11171071
111720         END-IF                                                   11172071
111730     END-IF.                                                      11173071
111740                                                                  11174071
111750                                                                  11175071
111760                                                                  11176071
111770                                                                  11177071
111780*----------------------------------------------------------------*11178071
111790* CHECK TO SEE IF PO/RECEIVER IS IN TROUBLE                      *11179071
111800*----------------------------------------------------------------*11180071
111810 4050-CHECK-TROUBLE.                                              11181071
111820                                                                  11182071
111830     MOVE  ZEROES  TO  PV-TRBNTF-PO-NBR.                          11183071
111840                                                                  11184071
111850     EXEC SQL                                                     11185071
111860        SELECT A.PO_NBR                                           11186071
111870          INTO :PV-TRBNTF-PO-NBR                                  11187071
111880          FROM TTRBNTF A                                          11188071
111890              ,TTRBRSN C                                          11189071
111900         WHERE A.PO_NBR       =  :ASC-PO-NBR                      11190071
111910           AND A.REC_SEQ_NBR  =  :ASC-REC-SEQ-NBR                 11191071
111920           AND A.RESOLVED_IND IN ('N','I','R')                    11192071
111930           AND A.TRBL_RSN_CDE = C.TRBL_RSN_CDE                    11193071
111940           AND C.NOTIF_IND    =  'T'                              11194071
111950           AND NOT EXISTS                                         11195071
111960              ( SELECT *                                          11196071
111970                FROM  TTRBRCN B                                   11197071
111980                WHERE B.RPT_PGM_NM  = 'PCKCS701'                  11198071
111990                  AND A.TRBL_RSN_CDE  =  B.TRBL_RSN_CDE )         11199071
112000          FETCH FIRST 1 ROW ONLY                                  11200071
112010     END-EXEC                                                     11201071
112020                                                                  11202071
112030                                                                  11203071
112040     EVALUATE TRUE                                                11204071
112050         WHEN SQLCODE = +0                                        11205071
112060         WHEN SQLCODE = +100                                      11206071
112070             CONTINUE                                             11207071
112080         WHEN SQLCODE = -904                                      11208071
112090         WHEN SQLCODE = -911                                      11209071
112100         WHEN SQLCODE = -913                                      11210071
112110                                                                  11211071
112120             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    11212071
112130             MOVE '4050-CHECK-TROUBLE'      TO PV-SOFT-PARAGRAPH  11213071
112140             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  11214071
112150             MOVE LENGTH OF PV-CICS-MSG-AREA2                     11215071
112160               TO PV-COMMAREA-LENGTH                              11216071
112170             EXEC CICS                                            11217071
112180                  WRITEQ TD                                       11218071
112190                   QUEUE  ('CSSL')                                11219071
112200                    FROM  (PV-CICS-MSG-AREA2)                     11220071
112210                  LENGTH  (PV-COMMAREA-LENGTH)                    11221071
112220                    RESP  (PV-CICS-RESP)                          11222071
112230             END-EXEC                                             11223071
112240                                                                  11224071
112250             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          11225071
112260             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              11226071
112270             PERFORM 9900-SOFT-ABORT                              11227071
112280         WHEN SQLWARN0 NOT = SPACES                               11228071
112290         WHEN SQLCODE < ZERO                                      11229071
112300         WHEN SQLCODE > ZERO                                      11230071
112310             MOVE '4050-CHECK-TROUBLE'                            11231071
112320                               TO DP013-PARAGRAPH                 11232071
112330             MOVE 'CHECK IF PO/RECEIVER IN TROUBLE'               11233071
112340                               TO DP013-MESSAGE-TEXT (1)          11234071
112350             MOVE SQLCA        TO DP013-SQLCA                     11235071
112360             MOVE 'TTRBNTF'    TO DP013-DB2-TABLE-NAME (1)        11236071
112370             SET DP013-DB2-ABEND                                  11237071
112380                 DP013-XCTL-DISPLAY-RESTART                       11238071
112390                               TO TRUE                            11239071
112400             PERFORM DP013-0000-PROCESS-ABEND                     11240071
112410     END-EVALUATE.                                                11241071
112420                                                                  11242071
112430     IF  PV-TRBNTF-PO-NBR  >  +0                                  11243071
112440         SET PS-ERROR                                             11244071
112450             DP020-NEXT-ACT-APPL-ERROR                            11245071
112460             DP020-MSG-FATAL       TO TRUE                        11246071
112470         MOVE PC-TSYMSG-01756      TO DP020-MSG-NUMBER            11247071
112480         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      11248071
112490     END-IF.                                                      11249071
112500                                                                  11250071
112510                                                                  11251071
112520*----------------------------------------------------------------*11252071
112530* CHECK TO SEE IF THERE ARE LINES FOR THE RECEIVER THAT ARE      *11253071
112540* ATTACHED TO PREPACK 99.                                        *11254071
112550* WHEN LINES ARE PART OF PREPACK 99, THIS MEANS THAT THERE WERE  *11255071
112560* LINES ON THE PACKSLIP THAT WERE NOT PART OF A PREPACK AT       *11256071
112570* TRANSCRIPTION TIME.  CANNOT PROCESS ORDER UNTIL LINES ARE      *11257071
112580* ASSIGNED TO VALID PREPACK.                                     *11258071
112590*----------------------------------------------------------------*11259071
112600 4055-CHECK-PREPK-99.                                             11260071
112610                                                                  11261071
112620     MOVE ZEROES  TO  PV-RECITM-ORD-NBR.                          11262071
112630                                                                  11263071
112640     EXEC SQL                                                     11264071
112650        SELECT A.ORD_NBR                                          11265071
112660          INTO :PV-RECITM-ORD-NBR                                 11266071
112670          FROM TRECITM A                                          11267071
112680              ,TPURITM B                                          11268071
112690         WHERE A.ORD_NBR           =  :ASC-PO-NBR                 11269071
112700           AND A.REC_SEQ_NBR       =  :ASC-REC-SEQ-NBR            11270071
112710           AND A.ORD_NBR           =  B.PO_NBR                    11271071
112720           AND A.ORD_LNE_NBR       =  B.APP_PO_LNE_NBR            11272071
112730           AND A.VER_STATUS_CDE    =  'A'                         11273071
112740           AND A.PO_VER_NBR        =  B.VER_NBR                   11274071
112750           AND A.PREPK_ID          =  99                          11275071
112760          FETCH FIRST 1 ROW ONLY                                  11276071
112770     END-EXEC                                                     11277071
112780                                                                  11278071
112790                                                                  11279071
112800     EVALUATE TRUE                                                11280071
112801         WHEN SQLCODE = +0                                        11280171
112802         WHEN SQLCODE = +100                                      11280271
112803             CONTINUE                                             11280371
112804         WHEN SQLCODE = -904                                      11280471
112805         WHEN SQLCODE = -911                                      11280571
112806         WHEN SQLCODE = -913                                      11280671
112807                                                                  11280771
112808             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    11280871
112809             MOVE '4055-CHECK-PREPK-99'     TO PV-SOFT-PARAGRAPH  11280971
112810             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  11281071
112820             MOVE LENGTH OF PV-CICS-MSG-AREA2                     11282071
112830               TO PV-COMMAREA-LENGTH                              11283071
112840             EXEC CICS                                            11284071
112850                  WRITEQ TD                                       11285071
112860                   QUEUE  ('CSSL')                                11286071
112870                    FROM  (PV-CICS-MSG-AREA2)                     11287071
112880                  LENGTH  (PV-COMMAREA-LENGTH)                    11288071
112890                    RESP  (PV-CICS-RESP)                          11289071
112900             END-EXEC                                             11290071
112910                                                                  11291071
112920             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          11292071
112930             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              11293071
112940             PERFORM 9900-SOFT-ABORT                              11294071
112950         WHEN SQLWARN0 NOT = SPACES                               11295071
112960         WHEN SQLCODE < ZERO                                      11296071
112970         WHEN SQLCODE > ZERO                                      11297071
112980              MOVE ASC-PO-NBR       TO  PV-DISPLAY-PO-NBR         11298071
112990              MOVE ASC-REC-SEQ-NBR  TO  PV-DISPLAY-RCVR-SEQ-NBR   11299071
113000              STRING                                              11300071
113010                 PV-DISPLAY-PO-NBR                                11301071
113020                 '-'                                              11302071
113030                 PV-DISPLAY-RCVR-SEQ-NBR   DELIMITED BY SIZE      11303071
113040                                      INTO DP013-MESSAGE-TEXT (2) 11304071
113050             MOVE '4055-CHECK-PREPK-99'                           11305071
113060                               TO DP013-PARAGRAPH                 11306071
113070             MOVE 'CHECK FOR PREPACK 99 '                         11307071
113080                               TO DP013-MESSAGE-TEXT (1)          11308071
113090             MOVE SQLCA        TO DP013-SQLCA                     11309071
113100             MOVE 'TRECITM'    TO DP013-DB2-TABLE-NAME (1)        11310071
113110             MOVE 'TPURITM'    TO DP013-DB2-TABLE-NAME (2)        11311071
113120             SET DP013-DB2-ABEND                                  11312071
113130                 DP013-XCTL-DISPLAY-RESTART                       11313071
113140                               TO TRUE                            11314071
113150             PERFORM DP013-0000-PROCESS-ABEND                     11315071
113160     END-EVALUATE.                                                11316071
113170                                                                  11317071
113180     IF  PV-RECITM-ORD-NBR >  +0                                  11318071
113190         SET PS-ERROR                                             11319071
113200             DP020-NEXT-ACT-APPL-ERROR                            11320071
113210             DP020-MSG-FATAL       TO TRUE                        11321071
113220         MOVE PC-TSYMSG-03392    TO DP020-MSG-NUMBER              11322071
113230         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      11323071
113240     END-IF.                                                      11324071
113250                                                                  11325071
113260                                                                  11326071
113270*----------------------------------------------------------------*11327071
113280* GET DEPARTMENT FOR PO/RECEIVER TO DISPLAY ON SCREEN            *11328071
113290* GET IN-HOUSE VENDOR NUMBER                                     *11329071
113300*----------------------------------------------------------------*11330071
113310 4060-GET-DEPARTMENT.                                             11331071
113320     EXEC SQL                                                     11332071
113330         SELECT A.DEPT_NBR                                        11333071
113340               ,A.ENT_ID                                          11334071
113350               ,B.INHOUSE_NBR                                     11335071
113360           INTO :PV-DEPT-NUMBER,                                  11336071
113370                :PV-ENT-ID,                                       11337071
113380                :PV-INHOUSE-VNDR-NBR                              11338071
113390           FROM TPURCHS A                                         11339071
113400               ,TVNDDPT B                                         11340071
113410          WHERE A.PO_NBR         =  :ASC-PO-NBR                   11341071
113420            AND A.VER_STATUS_CDE =  'A'                           11342071
113430            AND A.ENT_ID         =  B.ENT_ID                      11343071
113440            AND A.DEPT_NBR       =  B.DEPT_NBR                    11344071
113450     END-EXEC                                                     11345071
113460                                                                  11346071
113470     EVALUATE TRUE                                                11347071
113480         WHEN SQLCODE = +0                                        11348071
113490             MOVE  PV-DEPT-NUMBER       TO  ASC-DPT-NBR           11349071
113500             MOVE  PV-INHOUSE-VNDR-NBR  TO  ASC-INHOUSE-VNDR-NBR  11350071
113510         WHEN SQLCODE = +100                                      11351071
113520             MOVE  ZEROES          TO  ASC-DPT-NBR                11352071
113530         WHEN SQLCODE = -904                                      11353071
113540         WHEN SQLCODE = -911                                      11354071
113550         WHEN SQLCODE = -913                                      11355071
113560                                                                  11356071
113570             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    11357071
113580             MOVE '4060-GET-DEPARTMENT'     TO PV-SOFT-PARAGRAPH  11358071
113590             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  11359071
113600             MOVE LENGTH OF PV-CICS-MSG-AREA2                     11360071
113610               TO PV-COMMAREA-LENGTH                              11361071
113620             EXEC CICS                                            11362071
113630                  WRITEQ TD                                       11363071
113640                   QUEUE  ('CSSL')                                11364071
113650                    FROM  (PV-CICS-MSG-AREA2)                     11365071
113660                  LENGTH  (PV-COMMAREA-LENGTH)                    11366071
113670                    RESP  (PV-CICS-RESP)                          11367071
113680             END-EXEC                                             11368071
113690                                                                  11369071
113700             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          11370071
113710             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              11371071
113720             PERFORM 9900-SOFT-ABORT                              11372071
113730         WHEN SQLWARN0 NOT = SPACES                               11373071
113740         WHEN SQLCODE < ZERO                                      11374071
113750         WHEN SQLCODE > ZERO                                      11375071
113760             MOVE '4060-GET-DEPARTMENT'                           11376071
113770                               TO DP013-PARAGRAPH                 11377071
113780             MOVE 'GET DEPARTMENT FOR PO/RECEIVER '               11378071
113790                               TO DP013-MESSAGE-TEXT (1)          11379071
113800             MOVE SQLCA        TO DP013-SQLCA                     11380071
113810             MOVE 'TPURCHS'    TO DP013-DB2-TABLE-NAME (1)        11381071
113820             SET DP013-DB2-ABEND                                  11382071
113830                 DP013-XCTL-DISPLAY-RESTART                       11383071
113840                               TO TRUE                            11384071
113850             PERFORM DP013-0000-PROCESS-ABEND                     11385071
113860     END-EVALUATE.                                                11386071
113870                                                                  11387071
113880                                                                  11388071
113890*-----------------------------------------------------------------11389071
113900* SELECT STORE ZONE TO BE DISPLAYED ON THE SCREEN                 11390071
113910*-----------------------------------------------------------------11391071
113920 4065-SELECT-STORE-ZONE.                                          11392071
113930         EXEC SQL                                                 11393071
113940             SELECT C.STR_ZN_ID                                   11394071
113950               INTO :MDSEDP-STR-ZN-ID                             11395071
113960               FROM TPURCHS A,                                    11396071
113970                    TMDSEAR B,                                    11397071
113980                    TMDSEDP C                                     11398071
113990              WHERE A.PO_NBR         = :ASC-PO-NBR                11399071
114000                AND A.VER_STATUS_CDE = 'A'                        11400071
114010                AND A.DEPT_NBR       = B.DEPT_NBR                 11401071
114020                AND B.MDSELV_CDE     = 'DPT'                      11402071
114030                AND B.OPERCO_NBR     = '03'                       11403071
114040                AND (B.STRT_DTE     <= CURRENT DATE  AND          11404071
114050                     B.END_DTE      >  CURRENT DATE)              11405071
114060                AND B.MDSEAR_DKEY    = C.MDSEAR_DKEY              11406071
114070         END-EXEC                                                 11407071
114080                                                                  11408071
114090                                                                  11409071
114100         EVALUATE TRUE                                            11410071
114110             WHEN SQLCODE = +0                                    11411071
114120                  MOVE  MDSEDP-STR-ZN-ID                          11412071
114130                            TO    ASC-DFLT-STR-ZN-ID              11413071
114140             WHEN SQLCODE = +100                                  11414071
114150                  MOVE  SPACES TO ASC-DFLT-STR-ZN-ID              11415071
114160             WHEN OTHER                                           11416071
114170                  MOVE '4065-SELECT-STORE-ZONE'                   11417071
114180                                   TO DP013-PARAGRAPH             11418071
114190                  MOVE 'SELECT STORE ZONE DISPLY'                 11419071
114200                                   TO DP013-MESSAGE-TEXT (1)      11420071
114210                  MOVE SQLCA       TO DP013-SQLCA                 11421071
114220                  MOVE 'TMDSEDP '  TO DP013-DB2-TABLE-NAME (1)    11422071
114230                  SET DP013-DB2-ABEND                             11423071
114240                      DP013-XCTL-DISPLAY-RESTART                  11424071
114250                                   TO TRUE                        11425071
114260                  PERFORM DP013-0000-PROCESS-ABEND                11426071
114270         END-EVALUATE.                                            11427071
114280                                                                  11428071
114290                                                                  11429071
114300                                                                  11430071
114310*----------------------------------------------------------------*11431071
114320*   4070-CHECK-SEASET-ITEM                                       *11432071
114330* CHECKS FOR SEASONAL SET ITEMS                                  *11433071
114340*----------------------------------------------------------------*11434071
114350 4070-CHECK-SEASET-ITEM.                                          11435071
114360                                                                  11436071
114370     SET  ASC-SEASET-BLUE       TO  TRUE.                         11437071
114380                                                                  11438071
114390     EXEC SQL                                                     11439071
114400        SELECT                                                    11440071
114410            A.SEASET_YR                                           11441071
114420           ,A.SEASET_SHRT_NM                                      11442071
114430           ,B.SEASET_NM                                           11443071
114440       INTO                                                       11444071
114450           :PURCHS-SEASET-YR                                      11445071
114460          ,:PURCHS-SEASET-SHRT-NM                                 11446071
114470          ,:SEASET-SEASET-NM                                      11447071
114480        FROM                                                      11448071
114490            TPURCHS A                                             11449071
114500          , TSEASET B                                             11450071
114510        WHERE PO_NBR         = :ASC-PO-NBR                        11451071
114520          AND A.SEASET_YR      = B.SEASET_YR                      11452071
114530          AND A.SEASET_SHRT_NM = B.SEASET_SHRT_NM                 11453071
114540          AND A.VER_STATUS_CDE = 'A'                              11454071
114550     END-EXEC.                                                    11455071
114560                                                                  11456071
114570     EVALUATE TRUE                                                11457071
114580     WHEN SQLCODE = ZERO                                          11458071
114590     WHEN SQLCODE = -811                                          11459071
114600         PERFORM 4075-CHECK-DIVERT-NUMBER                         11460071
114610     WHEN SQLCODE = +100                                          11461071
114620         MOVE SPACES TO ASC-SEASET-SHRT-NME                       11462071
114630     END-EVALUATE.                                                11463071
114640                                                                  11464071
114650 4075-CHECK-DIVERT-NUMBER.                                        11465071
114660*----------------------------------------------------------------*11466071
114670*  CHECK THE SEASONAL SET DIVERT NUMBER                           11467071
114680*----------------------------------------------------------------*11468071
114690     EXEC SQL                                                     11469071
114700        SELECT                                                    11470071
114710            STR_RLSE_END_DTE                                      11471071
114720           ,DIVERT_PFX_NBR                                        11472071
114730        INTO                                                      11473071
114740           :SEASET-STR-RLSE-END-DTE                               11474071
114750          ,:SEASET-DIVERT-PFX-NBR                                 11475071
114760        FROM                                                      11476071
114770            TSEASET                                               11477071
114780        WHERE SEASET_YR       = :PURCHS-SEASET-YR                 11478071
114790          AND SEASET_SHRT_NM  = :PURCHS-SEASET-SHRT-NM            11479071
114800          AND SEASET_STAT_CDE = :PC-A                             11480071
114810     END-EXEC.                                                    11481071
114820                                                                  11482071
114830     EVALUATE TRUE                                                11483071
114840     WHEN SQLCODE = ZERO                                          11484071
114850     WHEN SQLCODE = -811                                          11485071
114860         PERFORM 4080-GET-CURRENT-DATE                            11486071
114870         PERFORM 4085-COMPARE-RELEASE-DATE                        11487071
114880     WHEN SQLCODE = +100                                          11488071
114890         CONTINUE                                                 11489071
114900     END-EVALUATE.                                                11490071
114910                                                                  11491071
114920                                                                  11492071
114930*----------------------------------------------------------------*11493071
114940* CHECK TO SEE HOW THE DC IS PROCESSING PACK-TO-LIGHT FREIGHT    *11494071
114950*        HANG/FOLD -OR- HANG/COMMODITY -OR- COMMODITY            *11495071
114960*----------------------------------------------------------------*11496071
114970 4076-CHECK-P2L-ZONES.                                            11497071
114980                                                                  11498071
114990     MOVE  ASC-OPER-UNT-ID  TO  DK-OPER-UNT-ID.                   11499071
115000                                                                  11500071
115010     EXEC SQL                                                     11501071
115011          SELECT  FUNC_TXT                                        11501171
115012            INTO :PV-P2L-ZONE                                     11501271
115013            FROM  TKRPRPM                                         11501371
115014           WHERE  LOC_ID            = :DK-OPER-UNT-ID             11501471
115015             AND  SYS_PRC_FUNC_CDE  = 'P2LZON'                    11501571
115016             AND  INTFC_SYS_CDE     = 'KHL'                       11501671
115017             AND  FUNC_PRC_STAT_CDE = 'AC'                        11501771
115018             AND  FUNC_BEG_TMST    <=  CURRENT TIMESTAMP          11501871
115019             AND  FUNC_END_TMST    >=  CURRENT TIMESTAMP          11501971
115020     END-EXEC                                                     11502071
115021                                                                  11502171
115022     EVALUATE TRUE                                                11502271
115023         WHEN SQLCODE = +0                                        11502371
115024              IF  PV-HANG-FOLD                                    11502471
115025                  SET  ASC-HANG-FOLD       TO  TRUE               11502571
115026              ELSE                                                11502671
115027              IF  PV-HANG-COMMODITY                               11502771
115028                  SET  ASC-HANG-COMMODITY  TO  TRUE               11502871
115029              ELSE                                                11502971
115030                  SET  ASC-COMMODITY       TO  TRUE               11503071
115031              END-IF                                              11503171
115032              END-IF                                              11503271
115033         WHEN SQLCODE = +100                                      11503371
115034              SET  ASC-COMMODITY     TO  TRUE                     11503471
115035         WHEN OTHER                                               11503571
115036              MOVE '4076-CHECK-P2L-ZONES'                         11503671
115037                               TO DP013-PARAGRAPH                 11503771
115038              MOVE 'CHECK P2L ZONE SETUP    '                     11503871
115039                               TO DP013-MESSAGE-TEXT (1)          11503971
115040              MOVE SQLCA       TO DP013-SQLCA                     11504071
115041              MOVE 'TKRPRPM '  TO DP013-DB2-TABLE-NAME (1)        11504171
115042              SET DP013-DB2-ABEND                                 11504271
115043                  DP013-XCTL-DISPLAY-RESTART                      11504371
115044                               TO TRUE                            11504471
115045              PERFORM DP013-0000-PROCESS-ABEND                    11504571
115046     END-EVALUATE.                                                11504671
115047                                                                  11504771
115048                                                                  11504871
115049*----------------------------------------------------------------*11504971
115050* CHECK TO SEE IF THE DEFAULT STORE ZONE IS ONE OF THE ZONES     *11505071
115051* SETUP FOR HANG/FOLD OR HANG/COMMODITY                          *11505171
115052* DMH ADDED 6/26/12                                              *11505271
115053*----------------------------------------------------------------*11505371
115054 4077-CHECK-HANG-FOLD.                                            11505471
115055                                                                  11505571
115056     EXEC SQL                                                     11505671
115057          SELECT                                                  11505771
115058                   E.ATTR_ELEM_TXT  AS STORE_ZONE                 11505871
115059            INTO :WST00010-ATTR-ELEM-TXT                          11505971
115060            FROM                                                  11506071
115061                   WST_INTGRTN_TYP  A                             11506171
115062               ,   WST_ATTR_DEFN    B                             11506271
115063               ,   WST_ATTR_ELEM    C                             11506371
115064               ,   WST_ATTR_ELEM    D                             11506471
115065               ,   WST_ATTR_ELEM    E                             11506571
115066               ,   WST_ATTR_ELEM    F                             11506671
115067               ,   WST_ATTR_ELEM    G                             11506771
115068            WHERE                                                 11506871
115069                  A.INTGRTN_TYP_CDE   = 'P2LHNGFLD'               11506971
115070              AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE         11507071
115071              AND B.ATTR_DEFN_SEQ_NBR = 1                         11507171
115072              AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE         11507271
115073              AND C.ATTR_DEFN_SEQ_NBR = 1                         11507371
115074              AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE         11507471
115075              AND D.ATTR_DEFN_SEQ_NBR = 2                         11507571
115076              AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE         11507671
115077              AND E.ATTR_DEFN_SEQ_NBR = 3                         11507771
115078              AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE         11507871
115079              AND F.ATTR_DEFN_SEQ_NBR = 4                         11507971
115080              AND B.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE         11508071
115081              AND G.ATTR_DEFN_SEQ_NBR = 5                         11508171
115082              AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR       11508271
115083              AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR       11508371
115084              AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR       11508471
115085              AND C.ATTR_ELEM_SEQ_NBR = G.ATTR_ELEM_SEQ_NBR       11508571
115086              AND C.ATTR_ELEM_NBR     =  90                       11508671
115087              AND D.ATTR_ELEM_TXT     = 'P2L'                     11508771
115088              AND F.ATTR_ELEM_TMST   <=  CURRENT TIMESTAMP        11508871
115089              AND G.ATTR_ELEM_TMST   >=  CURRENT TIMESTAMP        11508971
115090              AND E.ATTR_ELEM_TXT     = :ASC-DFLT-STR-ZN-ID       11509071
115091     END-EXEC.                                                    11509171
115092                                                                  11509271
115093     EVALUATE TRUE                                                11509371
115094         WHEN SQLCODE = +0                                        11509471
115095              CONTINUE                                            11509571
115096         WHEN SQLCODE = +100                                      11509671
115097              SET  ASC-COMMODITY     TO  TRUE                     11509771
115098         WHEN OTHER                                               11509871
115099              MOVE '4077-CHECK-HANG-FOLD'                         11509971
115100                               TO DP013-PARAGRAPH                 11510071
115101              MOVE 'CHECK IF STR ZNE SETUP FOR HANG/FOLD'         11510171
115102                               TO DP013-MESSAGE-TEXT (1)          11510271
115103              MOVE SQLCA       TO DP013-SQLCA                     11510371
115104              MOVE 'WST00010'  TO DP013-DB2-TABLE-NAME (1)        11510471
115105              SET DP013-DB2-ABEND                                 11510571
115106                  DP013-XCTL-DISPLAY-RESTART                      11510671
115107                               TO TRUE                            11510771
115108              PERFORM DP013-0000-PROCESS-ABEND                    11510871
115109                                                                  11510971
115110     END-EVALUATE.                                                11511071
115111                                                                  11511171
115112                                                                  11511271
115113*----------------------------------------------------------------*11511371
115114* CHECK TO SEE WHICH ZONE HAS MORE LINES.  THAT WILL BECOME THE  *11511471
115115* DEFAULT FOR THIS ORDER  --- COUNTS THE NUMBER OF HANG LINES    *11511571
115116* DMH ADDED 6/26/12                                              *11511671
115117*----------------------------------------------------------------*11511771
115118 4078-COUNT-HANG.                                                 11511871
115119                                                                  11511971
115120     MOVE  ASC-REC-SEQ-NBR  TO  DK-REC-SEQ-NBR.                   11512071
115121                                                                  11512171
115122     EXEC SQL                                                     11512271
115123          SELECT COUNT(*)                                         11512371
115124            INTO :PV-HANG-COUNT                                   11512471
115125            FROM TRECITM A                                        11512571
115126                ,TPURITM B                                        11512671
115127                ,XLT_SKU C                                        11512771
115128                ,XLT_VND_STYL D                                   11512871
115129           WHERE A.ORD_NBR           = :ASC-PO-NBR                11512971
115130             AND A.REC_SEQ_NBR       = :DK-REC-SEQ-NBR            11513071
115131             AND A.ORD_NBR           = B.PO_NBR                   11513171
115132             AND A.ORD_LNE_NBR       = B.APP_PO_LNE_NBR           11513271
115133             AND A.VER_STATUS_CDE    = 'A'                        11513371
115134             AND A.PO_VER_NBR        = B.VER_NBR                  11513471
115135             AND B.ITM_NBR           = C.ITM_NBR                  11513571
115136             AND C.STYL_ID           = D.STYL_ID                  11513671
115137             AND D.HNG_FOLD_DESC     = 'HANG'                     11513771
115138     END-EXEC.                                                    11513871
115139                                                                  11513971
115140     EVALUATE TRUE                                                11514071
115141         WHEN SQLCODE = +0                                        11514171
115142              CONTINUE                                            11514271
115143         WHEN SQLCODE = +100                                      11514371
115144              MOVE ZERO              TO  PV-HANG-COUNT            11514471
115145         WHEN OTHER                                               11514571
115146              MOVE  ASC-PO-NBR       TO PV-DISPLAY-PO-NBR         11514671
115147              MOVE  ASC-REC-SEQ-NBR  TO PV-DISPLAY-RCVR-SEQ-NBR   11514771
115148              MOVE '4078-COUNT-HANG     '                         11514871
115149                               TO DP013-PARAGRAPH                 11514971
115150              MOVE 'COUNT THE NUMBER OF LINE FOR HANG   '         11515071
115151                               TO DP013-MESSAGE-TEXT (1)          11515171
115152              STRING PV-DISPLAY-PO-NBR '-'                        11515271
115153                     PV-DISPLAY-RCVR-SEQ-NBR                      11515371
115154                                  DELIMITED BY SIZE               11515471
115155                             INTO DP013-MESSAGE-TEXT (2)          11515571
115156              MOVE SQLCA       TO DP013-SQLCA                     11515671
115157              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)        11515771
115158              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (2)        11515871
115159              MOVE 'XLT00003'  TO DP013-DB2-TABLE-NAME (3)        11515971
115160              MOVE 'XLT00004'  TO DP013-DB2-TABLE-NAME (3)        11516071
115161              SET DP013-DB2-ABEND                                 11516171
115162                  DP013-XCTL-DISPLAY-RESTART                      11516271
115163                               TO TRUE                            11516371
115164              PERFORM DP013-0000-PROCESS-ABEND                    11516471
115165                                                                  11516571
115166     END-EVALUATE.                                                11516671
115167                                                                  11516771
115168                                                                  11516871
115169*----------------------------------------------------------------*11516971
115170* CHECK TO SEE WHICH ZONE HAS MORE LINES.  THAT WILL BECOME THE  *11517071
115171* DEFAULT FOR THIS ORDER  --- COUNTS THE NUMBER OF FOLD LINES    *11517171
115172* DMH ADDED 6/26/12                                              *11517271
115173*----------------------------------------------------------------*11517371
115174 4079-COUNT-FOLD.                                                 11517471
115175                                                                  11517571
115176     MOVE  ASC-REC-SEQ-NBR  TO  DK-REC-SEQ-NBR.                   11517671
115177                                                                  11517771
115178     EXEC SQL                                                     11517871
115179          SELECT COUNT(*)                                         11517971
115180            INTO :PV-FOLD-COUNT                                   11518071
115181            FROM TRECITM A                                        11518171
115182                ,TPURITM B                                        11518271
115183                ,XLT_SKU C                                        11518371
115184                ,XLT_VND_STYL D                                   11518471
115185           WHERE A.ORD_NBR           = :ASC-PO-NBR                11518571
115186             AND A.REC_SEQ_NBR       = :DK-REC-SEQ-NBR            11518671
115187             AND A.ORD_NBR           = B.PO_NBR                   11518771
115188             AND A.ORD_LNE_NBR       = B.APP_PO_LNE_NBR           11518871
115189             AND A.VER_STATUS_CDE    = 'A'                        11518971
115190             AND A.PO_VER_NBR        = B.VER_NBR                  11519071
115191             AND B.ITM_NBR           = C.ITM_NBR                  11519171
115192             AND C.STYL_ID           = D.STYL_ID                  11519271
115193             AND D.HNG_FOLD_DESC     = 'FOLD'                     11519371
115194     END-EXEC.                                                    11519471
115195                                                                  11519571
115196     EVALUATE TRUE                                                11519671
115197         WHEN SQLCODE = +0                                        11519771
115198              CONTINUE                                            11519871
115199         WHEN SQLCODE = +100                                      11519971
115200              MOVE ZERO              TO  PV-HANG-COUNT            11520071
115201         WHEN OTHER                                               11520171
115202              MOVE  ASC-PO-NBR      TO  PV-DISPLAY-PO-NBR         11520271
115203              MOVE  ASC-REC-SEQ-NBR TO  PV-DISPLAY-RCVR-SEQ-NBR   11520371
115204              MOVE '4079-COUNT-FOLD     '                         11520471
115205                               TO DP013-PARAGRAPH                 11520571
115206              MOVE 'COUNT THE NUMBER OF LINE FOR FOLD   '         11520671
115207                               TO DP013-MESSAGE-TEXT (1)          11520771
115208              STRING PV-DISPLAY-PO-NBR '-'                        11520871
115209                     PV-DISPLAY-RCVR-SEQ-NBR                      11520971
115210                                  DELIMITED BY SIZE               11521071
115211                             INTO DP013-MESSAGE-TEXT (2)          11521171
115212              MOVE SQLCA       TO DP013-SQLCA                     11521271
115213              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)        11521371
115214              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (2)        11521471
115215              MOVE 'XLT00003'  TO DP013-DB2-TABLE-NAME (3)        11521571
115216              MOVE 'XLT00004'  TO DP013-DB2-TABLE-NAME (3)        11521671
115217              SET DP013-DB2-ABEND                                 11521771
115218                  DP013-XCTL-DISPLAY-RESTART                      11521871
115219                               TO TRUE                            11521971
115220              PERFORM DP013-0000-PROCESS-ABEND                    11522071
115221                                                                  11522171
115222     END-EVALUATE.                                                11522271
115223                                                                  11522371
115224                                                                  11522471
115225*----------------------------------------------------------------*11522571
115226* CHECK TO SEE WHICH ZONE HAS MORE LINES.  THAT WILL BECOME THE  *11522671
115227* DEFAULT FOR THIS ORDER  --- COUNTS THE NUMBER OF <> HANG LINES *11522771
115228*----------------------------------------------------------------*11522871
115229 4080-COUNT-COMMODITY.                                            11522971
115230                                                                  11523071
115231     MOVE  ASC-REC-SEQ-NBR  TO  DK-REC-SEQ-NBR.                   11523171
115232                                                                  11523271
115233     EXEC SQL                                                     11523371
115234          SELECT COUNT(*)                                         11523471
115235            INTO :PV-COMMODITY-COUNT                              11523571
115236            FROM TRECITM A                                        11523671
115237                ,TPURITM B                                        11523771
115238                ,XLT_SKU C                                        11523871
115239                ,XLT_VND_STYL D                                   11523971
115240           WHERE A.ORD_NBR           = :ASC-PO-NBR                11524071
115241             AND A.REC_SEQ_NBR       = :DK-REC-SEQ-NBR            11524171
115242             AND A.ORD_NBR           = B.PO_NBR                   11524271
115243             AND A.ORD_LNE_NBR       = B.APP_PO_LNE_NBR           11524371
115244             AND A.VER_STATUS_CDE    = 'A'                        11524471
115245             AND A.PO_VER_NBR        = B.VER_NBR                  11524571
115246             AND B.ITM_NBR           = C.ITM_NBR                  11524671
115247             AND C.STYL_ID           = D.STYL_ID                  11524771
115248             AND D.HNG_FOLD_DESC    <> 'HANG'                     11524871
115249     END-EXEC.                                                    11524971
115250                                                                  11525071
115251     EVALUATE TRUE                                                11525171
115252         WHEN SQLCODE = +0                                        11525271
115253              CONTINUE                                            11525371
115254         WHEN SQLCODE = +100                                      11525471
115255              MOVE ZERO              TO  PV-HANG-COUNT            11525571
115256         WHEN OTHER                                               11525671
115257              MOVE  ASC-PO-NBR      TO  PV-DISPLAY-PO-NBR         11525771
115258              MOVE  ASC-REC-SEQ-NBR TO  PV-DISPLAY-RCVR-SEQ-NBR   11525871
115259              MOVE '4080-COUNT-COMMODITY'                         11525971
115260                               TO DP013-PARAGRAPH                 11526071
115261              MOVE 'COUNT THE NUMBER OF LINE FOR COMMODITY'       11526171
115262                               TO DP013-MESSAGE-TEXT (1)          11526271
115263              STRING PV-DISPLAY-PO-NBR '-'                        11526371
115264                     PV-DISPLAY-RCVR-SEQ-NBR                      11526471
115265                                  DELIMITED BY SIZE               11526571
115266                             INTO DP013-MESSAGE-TEXT (2)          11526671
115267              MOVE SQLCA       TO DP013-SQLCA                     11526771
115268              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)        11526871
115269              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (2)        11526971
115270              MOVE 'XLT00003'  TO DP013-DB2-TABLE-NAME (3)        11527071
115271              MOVE 'XLT00004'  TO DP013-DB2-TABLE-NAME (3)        11527171
115272              SET DP013-DB2-ABEND                                 11527271
115273                  DP013-XCTL-DISPLAY-RESTART                      11527371
115274                               TO TRUE                            11527471
115275              PERFORM DP013-0000-PROCESS-ABEND                    11527571
115276                                                                  11527671
115277     END-EVALUATE.                                                11527771
115278                                                                  11527871
115279                                                                  11527971
115280*----------------------------------------------------------------*11528071
115281* CHECK TO SEE HOW MANY LINES HAVE SOMETHING OTHER THAN HANG OR  *11528171
115282* FOLD                                                           *11528271
115283*----------------------------------------------------------------*11528371
115284 4081-COUNT-OTHER.                                                11528471
115285                                                                  11528571
115286     MOVE  ASC-REC-SEQ-NBR  TO  DK-REC-SEQ-NBR.                   11528671
115287                                                                  11528771
115288     EXEC SQL                                                     11528871
115289          SELECT COUNT(*)                                         11528971
115290            INTO :PV-OTHER-COUNT                                  11529071
115291            FROM TRECITM A                                        11529171
115292                ,TPURITM B                                        11529271
115293                ,XLT_SKU C                                        11529371
115294                ,XLT_VND_STYL D                                   11529471
115295           WHERE A.ORD_NBR            =  :ASC-PO-NBR              11529571
115296             AND A.REC_SEQ_NBR        =  :DK-REC-SEQ-NBR          11529671
115297             AND A.ORD_NBR            =  B.PO_NBR                 11529771
115298             AND A.ORD_LNE_NBR        =  B.APP_PO_LNE_NBR         11529871
115299             AND A.VER_STATUS_CDE     =  'A'                      11529971
115300             AND A.PO_VER_NBR         =  B.VER_NBR                11530071
115301             AND B.ITM_NBR            =  C.ITM_NBR                11530171
115302             AND C.STYL_ID            =  D.STYL_ID                11530271
115303             AND NOT D.HNG_FOLD_DESC IN ('FOLD', 'HANG')          11530371
115304     END-EXEC.                                                    11530471
115305                                                                  11530571
115306     EVALUATE TRUE                                                11530671
115307         WHEN SQLCODE = +0                                        11530771
115308              CONTINUE                                            11530871
115309         WHEN SQLCODE = +100                                      11530971
115310              MOVE ZERO              TO  PV-HANG-COUNT            11531071
115311         WHEN OTHER                                               11531171
115312              MOVE  ASC-PO-NBR      TO  PV-DISPLAY-PO-NBR         11531271
115313              MOVE  ASC-REC-SEQ-NBR TO  PV-DISPLAY-RCVR-SEQ-NBR   11531371
115314              MOVE '4081-COUNT-OTHER    '                         11531471
115315                               TO DP013-PARAGRAPH                 11531571
115316              MOVE 'COUNT THE NUMBER OF LINE NOT HANG OR FOLD'    11531671
115317                               TO DP013-MESSAGE-TEXT (1)          11531771
115318              STRING PV-DISPLAY-PO-NBR '-'                        11531871
115319                     PV-DISPLAY-RCVR-SEQ-NBR                      11531971
115320                                  DELIMITED BY SIZE               11532071
115321                             INTO DP013-MESSAGE-TEXT (2)          11532171
115322              MOVE SQLCA       TO DP013-SQLCA                     11532271
115323              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)        11532371
115324              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (2)        11532471
115325              MOVE 'XLT00003'  TO DP013-DB2-TABLE-NAME (3)        11532571
115326              MOVE 'XLT00004'  TO DP013-DB2-TABLE-NAME (3)        11532671
115327              SET DP013-DB2-ABEND                                 11532771
115328                  DP013-XCTL-DISPLAY-RESTART                      11532871
115329                               TO TRUE                            11532971
115330              PERFORM DP013-0000-PROCESS-ABEND                    11533071
115331                                                                  11533171
115332     END-EVALUATE.                                                11533271
115333                                                                  11533371
115334                                                                  11533471
115335*----------------------------------------------------------------*11533571
115336*  CHECK THE RELEASE ENDING DATE WITH THE CURRENT DATE            11533671
115337*----------------------------------------------------------------*11533771
115338 4085-COMPARE-RELEASE-DATE.                                       11533871
115339                                                                  11533971
115340     SET  ASC-SEASET-BLUE       TO  TRUE.                         11534071
115350     MOVE PURCHS-SEASET-SHRT-NM TO ASC-SEASET-SHRT-NME.           11535071
115360                                                                  11536071
115370     IF  PURCHS-SEASET-SHRT-NM  = 'T & T' or                      11537071
115380         PURCHS-SEASET-SHRT-NM  = 'T&T'                           11538071
115390         MOVE PURCHS-SEASET-SHRT-NM TO ASC-SEASET-SHRT-NME        11539071
115400         SET  ASC-SEASET-YELLOW     TO TRUE                       11540071
115410     ELSE                                                         11541071
115411         IF PV-CURRENT-DB2-DATE > SEASET-STR-RLSE-END-DTE         11541171
115412             SET  ASC-SEASET-BLUE     TO TRUE                     11541271
115413         ELSE                                                     11541371
115414             IF  SEASET-DIVERT-PFX-NBR  >  0                      11541471
115415                 SET  ASC-SEASET-YELLOW   TO TRUE                 11541571
115416             ELSE                                                 11541671
115417                 SET  ASC-SEASET-BLUE     TO TRUE                 11541771
115418             END-IF                                               11541871
115419         END-IF                                                   11541971
115420     END-IF.                                                      11542071
115421                                                                  11542171
115422                                                                  11542271
115423 4080-GET-CURRENT-DATE.                                           11542371
115424*----------------------------------------------------------------*11542471
115425* GET CURRENT DATE/TIME FROM CONTROL TABLE                       *11542571
115426*----------------------------------------------------------------*11542671
115427     EXEC SQL                                                     11542771
115428         SELECT  CURRENT DATE                                     11542871
115429           INTO  :PV-CURRENT-DB2-DATE                             11542971
115430           FROM  TCOCNTL                                          11543071
115431          WHERE  OPER_UNT_ID = 90                                 11543171
115432     END-EXEC.                                                    11543271
115433                                                                  11543371
115434     EVALUATE TRUE                                                11543471
115435         WHEN SQLCODE = ZERO                                      11543571
115436              CONTINUE                                            11543671
115437         WHEN OTHER                                               11543771
115438              MOVE '4080-GET-CURRENT-DATE'                        11543871
115439                                  TO DP013-PARAGRAPH              11543971
115440              MOVE 'SELECT ON TCOCNTL'                            11544071
115441                                  TO DP013-MESSAGE-TEXT (1)       11544171
115442              MOVE SQLCA          TO DP013-SQLCA                  11544271
115443              MOVE 'TCOCNTL'      TO DP013-DB2-TABLE-NAME (1)     11544371
115444              SET DP013-DB2-ABEND TO TRUE                         11544471
115445              SET DP013-XCTL-DISPLAY-RESTART                      11544571
115446                                  TO TRUE                         11544671
115447              PERFORM DP013-0000-PROCESS-ABEND                    11544771
115448     END-EVALUATE.                                                11544871
115449/                                                                 11544971
115450*----------------------------------------------------------------*11545071
115460* CHECK IF DC IS SENDING DIRECTIVES AND AT WHAT LEVEL            *11546071
115470* NNE - NONE  EXC-EXCEPTIONS ONLY ALL- ALL CARTONS               *11547071
115480*----------------------------------------------------------------*11548071
115481 4086-CHECK-DC-DIRECTIVES.                                        11548171
115482                                                                  11548271
115483                                                                  11548371
115484     EXEC SQL                                                     11548471
115485        SELECT                                                    11548571
115486            FUNC_TXT                                              11548671
115487        INTO                                                      11548771
115488            :KRPRPM-FUNC-TXT                                      11548871
115489        FROM                                                      11548971
115490            TKRPRPM                                               11549071
115491        WHERE SYS_PRC_FUNC_CDE = 'AUTOCY'                         11549171
115492          AND LOC_ID            = :DK-OPER-UNT-ID                 11549271
115493          AND CURRENT TIMESTAMP > FUNC_BEG_TMST                   11549371
115494     END-EXEC.                                                    11549471
115495                                                                  11549571
115496     EVALUATE TRUE                                                11549671
115497                                                                  11549771
115498         WHEN SQLCODE = +0                                        11549871
115499              MOVE KRPRPM-FUNC-TXT  TO  ASC-AUTO-CONVEY-LVL-SW    11549971
115500                                                                  11550071
115501         WHEN SQLCODE = +100                                      11550171
115502              MOVE 'NNE'    TO KRPRPM-FUNC-TXT                    11550271
115503                                                                  11550371
115504         WHEN SQLCODE = -811                                      11550471
115505         WHEN SQLCODE = -904                                      11550571
115506         WHEN SQLCODE = -913                                      11550671
115507              MOVE SQLCODE                   TO PV-SOFT-SQLCODE   11550771
115508              MOVE '4086-CHECK-DC-DIRECTIV'  TO PV-SOFT-PARAGRAPH 11550871
115509              MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2 11550971
115510              MOVE LENGTH OF PV-CICS-MSG-AREA2                    11551071
115511                TO PV-COMMAREA-LENGTH                             11551171
115512              EXEC CICS                                           11551271
115513                   WRITEQ TD                                      11551371
115514                    QUEUE  ('CSSL')                               11551471
115515                     FROM  (PV-CICS-MSG-AREA2)                    11551571
115516                   LENGTH  (PV-COMMAREA-LENGTH)                   11551671
115517                     RESP  (PV-CICS-RESP)                         11551771
115518              END-EXEC                                            11551871
115519                                                                  11551971
115520         WHEN SQLWARN0 NOT = SPACES                               11552071
115521         WHEN SQLCODE < +0                                        11552171
115522         WHEN SQLCODE > +0                                        11552271
115523              MOVE '4086-CHECK-DC-DIRECTIVES'                     11552371
115524                                 TO DP013-PARAGRAPH               11552471
115525              MOVE 'CHECK PARM DC SENDING DIRECTIVES    '         11552571
115526                                 TO DP013-MESSAGE-TEXT (1)        11552671
115527              MOVE SQLCA         TO DP013-SQLCA                   11552771
115528              MOVE 'TKRPRPM'     TO DP013-DB2-TABLE-NAME (1)      11552871
115529              SET DP013-DB2-ABEND                                 11552971
115530                  DP013-XCTL-DISPLAY-RESTART                      11553071
115531                                 TO TRUE                          11553171
115532              PERFORM DP013-0000-PROCESS-ABEND                    11553271
115533     END-EVALUATE.                                                11553371
115534                                                                  11553471
115535                                                                  11553571
115536*----------------------------------------------------------------*11553671
115537* CHECK IF DC IS SENDING DIRECTIVES for RFID                     *11553771
115538*----------------------------------------------------------------*11553871
115539 4087-CHECK-RFID-DIRECTIVES.                                      11553971
115540                                                                  11554071
115541     EXEC SQL                                                     11554171
115542         SELECT A.DC_LOC_NBR                                      11554271
115543           INTO :RIT00000-DC-LOC-NBR                              11554371
115544           FROM RIT_RFID_VRFN  A                                  11554471
115545          WHERE A.DC_LOC_NBR    = :DK-OPER-UNT-ID                 11554571
115546            AND A.STR_NBR       = 0                               11554671
115547            AND A.DEPT_NBR      = 0                               11554771
115548            AND A.SUB_CL_NBR    = 0                               11554871
115549            AND A.RFID_LVL_CDE  = 'RFIDDC'                        11554971
115550            AND A.EFF_STRT_TMST <= CURRENT_TIMESTAMP              11555071
115551            AND A.EFF_END_TMST   > CURRENT_TIMESTAMP              11555171
115552         WITH UR                                                  11555271
115553     END-EXEC.                                                    11555371
115554                                                                  11555471
115555                                                                  11555571
115556     EVALUATE TRUE                                                11555671
115557         WHEN SQLCODE = ZERO                                      11555771
115558              SET PS-DC-RFID-YES TO TRUE                          11555871
115559         WHEN SQLCODE = +100                                      11555971
115560              SET PS-DC-RFID-NO TO TRUE                           11556071
115570         WHEN SQLWARN0 NOT = SPACES                               11557071
115571         WHEN SQLCODE < +0                                        11557171
115572         WHEN SQLCODE > +0                                        11557271
115573              MOVE '4087-CHECK-RFID-DIRECTIV'                     11557371
115574                                 TO DP013-PARAGRAPH               11557471
115575              MOVE 'CHECK PARM DC SENDING DIRECTIVES    '         11557571
115576                                 TO DP013-MESSAGE-TEXT (1)        11557671
115577              MOVE SQLCA         TO DP013-SQLCA                   11557771
115578              MOVE 'TKRPRPM'     TO DP013-DB2-TABLE-NAME (1)      11557871
115579              SET DP013-DB2-ABEND                                 11557971
115580                  DP013-XCTL-DISPLAY-RESTART                      11558071
115590                                 TO TRUE                          11559071
115600              PERFORM DP013-0000-PROCESS-ABEND                    11560071
115610     END-EVALUATE.                                                11561071
115620                                                                  11562071
115630                                                                  11563071
115631*----------------------------------------------------------------*11563171
115632*  OPEN A CURSOR TO SELECT ALL THE P2L MODULES FOR A GIVEN       *11563271
115633*  DEFAULT STORE ZONE                                            *11563371
115634*----------------------------------------------------------------*11563471
115635 4090-GET-P2L-MODULES.                                            11563571
115636                                                                  11563671
115637     INITIALIZE PMT-P2L-MODULE-TABLE.                             11563771
115638                                                                  11563871
115639     SET PMT-MOD-IDX TO PC-ZEROES.                                11563971
115640                                                                  11564071
115641     MOVE  ASC-OPER-UNT-ID  TO  PV-OPER-UNT-ID-HOLD.              11564171
115642                                                                  11564271
115643     PERFORM 4092-OPEN-MOD-CURSOR.                                11564371
115644     PERFORM 4094-FETCH-MOD-CURSOR.                               11564471
115645                                                                  11564571
115646     PERFORM UNTIL PS-EOF-MOD-CURSOR                              11564671
115647         IF  P2LMOD-MODU-NBR = PV-MODU-NBR-HOLD                   11564771
115648             CONTINUE                                             11564871
115649         ELSE                                                     11564971
115650             SET PMT-MOD-IDX UP BY +1                             11565071
115651             MOVE P2LMOD-MODU-NBR  TO                             11565171
115652                             PMT-MODULE (PMT-MOD-IDX)             11565271
115653             MOVE P2LMOD-MODU-NBR  TO PV-MODU-NBR-HOLD            11565371
115654         END-IF                                                   11565471
115655         IF  PMT-MOD-IDX =  5                                     11565571
115656             SET PS-EOF-MOD-CURSOR TO TRUE                        11565671
115657         ELSE                                                     11565771
115658             PERFORM 4094-FETCH-MOD-CURSOR                        11565871
115659         END-IF                                                   11565971
115660     END-PERFORM                                                  11566071
115670                                                                  11567071
115680     PERFORM 4096-CLOSE-MOD-CURSOR.                               11568071
115690                                                                  11569071
115700                                                                  11570071
115710*----------------------------------------------------------------*11571071
115720*  THIS PROCEDURE WILL OPEN THE MODULE (P2L MODULE) CURSOR        11572071
115730*----------------------------------------------------------------*11573071
115740 4092-OPEN-MOD-CURSOR.                                            11574071
115750                                                                  11575071
115760     EXEC SQL                                                     11576071
115770         OPEN MODULE_CURSOR                                       11577071
115780     END-EXEC.                                                    11578071
115790                                                                  11579071
115800     EVALUATE TRUE                                                11580071
115810         WHEN SQLCODE = +0                                        11581071
115820              SET PS-NOT-EOF-MOD-CURSOR  TO  TRUE                 11582071
115830         WHEN SQLCODE  NOT =  +0                                  11583071
115840              MOVE '4092-OPEN-MOD-CURSOR'                         11584071
115850                                  TO DP013-PARAGRAPH              11585071
115860              MOVE 'OPEN P2L MODULE CURSOR'                       11586071
115870                                  TO DP013-MESSAGE-TEXT (1)       11587071
115880              MOVE SQLCA          TO DP013-SQLCA                  11588071
115890              MOVE 'TP2LMOD'      TO DP013-DB2-TABLE-NAME (1)     11589071
115900              SET DP013-DB2-ABEND TO TRUE                         11590071
115910              SET DP013-XCTL-DISPLAY-RESTART                      11591071
115920                                  TO TRUE                         11592071
115930              PERFORM DP013-0000-PROCESS-ABEND                    11593071
115940     END-EVALUATE.                                                11594071
115950                                                                  11595071
115960                                                                  11596071
115970*----------------------------------------------------------------*11597071
115980*  THIS PROCEDURE WILL FETCH THE MODULE (P2L MODULE) CURSOR       11598071
115990*----------------------------------------------------------------*11599071
116000 4094-FETCH-MOD-CURSOR.                                           11600071
116010                                                                  11601071
116020     EXEC SQL                                                     11602071
116030          FETCH MODULE_CURSOR                                     11603071
116040          INTO :P2LMOD-MODU-NBR                                   11604071
116050     END-EXEC.                                                    11605071
116060                                                                  11606071
116070     EVALUATE TRUE                                                11607071
116080         WHEN SQLCODE = ZERO                                      11608071
116090              CONTINUE                                            11609071
116100         WHEN SQLCODE = +100                                      11610071
116110              SET PS-EOF-MOD-CURSOR TO TRUE                       11611071
116120         WHEN SQLWARN0 NOT = +0                                   11612071
116130         WHEN SQLCODE < ZERO                                      11613071
116140         WHEN SQLCODE > ZERO                                      11614071
116150              MOVE '4094-FETCH-MOD-CURSOR'                        11615071
116160                                  TO DP013-PARAGRAPH              11616071
116170              MOVE 'FETCH P2L MODULE CURSOR'                      11617071
116180                                  TO DP013-MESSAGE-TEXT (1)       11618071
116190              MOVE SQLCA          TO DP013-SQLCA                  11619071
116200              MOVE 'TPTLMOD'      TO DP013-DB2-TABLE-NAME (1)     11620071
116210              SET DP013-DB2-ABEND TO TRUE                         11621071
116220              SET DP013-XCTL-DISPLAY-RESTART                      11622071
116230                                  TO TRUE                         11623071
116240              PERFORM DP013-0000-PROCESS-ABEND                    11624071
116250     END-EVALUATE.                                                11625071
116260                                                                  11626071
116270                                                                  11627071
116280*----------------------------------------------------------------*11628071
116290*  THIS PROCEDURE WILL CLOSE THE MODULE (P2L MODULE) CURSOR       11629071
116300*----------------------------------------------------------------*11630071
116310 4096-CLOSE-MOD-CURSOR.                                           11631071
116320                                                                  11632071
116330     EXEC SQL                                                     11633071
116340         CLOSE MODULE_CURSOR                                      11634071
116350     END-EXEC.                                                    11635071
116360                                                                  11636071
116370     EVALUATE TRUE                                                11637071
116380         WHEN SQLCODE = +0                                        11638071
116390              CONTINUE                                            11639071
116400         WHEN SQLCODE  NOT =  +0                                  11640071
116410              MOVE '4096-CLOSE-MOD-CURSOR'                        11641071
116420                                  TO DP013-PARAGRAPH              11642071
116430              MOVE 'CLOSE P2L MODULE CURSOR'                      11643071
116440                                  TO DP013-MESSAGE-TEXT (1)       11644071
116450              MOVE SQLCA          TO DP013-SQLCA                  11645071
116460              MOVE 'TP2LMOD'      TO DP013-DB2-TABLE-NAME (1)     11646071
116470              SET DP013-DB2-ABEND TO TRUE                         11647071
116480              SET DP013-XCTL-DISPLAY-RESTART                      11648071
116490                                  TO TRUE                         11649071
116500              PERFORM DP013-0000-PROCESS-ABEND                    11650071
116510     END-EVALUATE.                                                11651071
116520                                                                  11652071
116530                                                                  11653071
116540*----------------------------------------------------------------*11654071
116550* OPEN THE CURSOR.                                               *11655071
116560*   IN THIS PARTICULAR APPLICATION ONE OF 2 DIFFERENT CURSORS    *11656071
116570*   WILL BE OPENED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *11657071
116580*   USER.                                                        *11658071
116590*----------------------------------------------------------------*11659071
116600 4110-OPEN-CURSOR.                                                11660071
116610     EVALUATE TRUE                                                11661071
116620         WHEN ASC-PRE-PACK-CSR                                    11662071
116630              PERFORM 4200-OPEN-PRE-PK-CURSOR                     11663071
116640                                                                  11664071
116650         WHEN ASC-PO-ALL-LN-CSR                                   11665071
116660              PERFORM 4125-OPEN-ALL-LN-CURSOR                     11666071
116670                                                                  11667071
116680         WHEN ASC-PO-ONE-LN-CSR                                   11668071
116690              PERFORM 4140-OPEN-ONE-LN-CURSOR                     11669071
116700                                                                  11670071
116710     END-EVALUATE.                                                11671071
116720                                                                  11672071
116730                                                                  11673071
116740*----------------------------------------------------------------*11674071
116750*    FETCH CURSOR                                                *11675071
116760*----------------------------------------------------------------*11676071
116770 4115-FETCH.                                                      11677071
116780                                                                  11678071
116790     EVALUATE TRUE                                                11679071
116800                                                                  11680071
116810         WHEN ASC-PRE-PACK-CSR                                    11681071
116820             SET  PS-NOT-NEW-PRE-PK-ID  TO  TRUE                  11682071
116830             PERFORM 4205-FETCH-PRE-PK-CSR                        11683071
116840               UNTIL PS-NEW-PRE-PK-ID  OR                         11684071
116850                     PS-NO-ITEMS-LEFT-ON-DB                       11685071
116860                                                                  11686071
116870         WHEN ASC-PO-ALL-LN-CSR                                   11687071
116880             PERFORM 4130-FETCH-ALL-LN-CSR                        11688071
116890                                                                  11689071
116900         WHEN ASC-PO-ONE-LN-CSR                                   11690071
116910             PERFORM 4145-FETCH-ONE-LN-CSR                        11691071
116920                                                                  11692071
116930     END-EVALUATE.                                                11693071
116940                                                                  11694071
116950     IF PS-NO-ITEMS-LEFT-ON-DB                                    11695071
116960        CONTINUE                                                  11696071
116970     ELSE                                                         11697071
116980        EVALUATE TRUE                                             11698071
116990            WHEN PURITM-SKU-SEQ-NBR = '000'                       11699071
117000                 MOVE '00000000' TO PV-SKU                        11700071
117010            WHEN PURITM-SKU-SEQ-NBR = '999'                       11701071
117020                 MOVE '99999999' TO PV-SKU                        11702071
117030            WHEN OTHER                                            11703071
117040                 PERFORM 4250-CALL-XLKUT001                       11704071
117050        END-EVALUATE                                              11705071
117060     END-IF.                                                      11706071
117070                                                                  11707071
117080*----------------------------------------------------------------*11708071
117090* CLOSE THE CURSOR.                                              *11709071
117100*   IN THIS PARTICULAR APPLICATION ONE OF 2 DIFFERENT CURSORS    *11710071
117110*   WILL BE CLOSED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *11711071
117120*   USER.                                                        *11712071
117130*----------------------------------------------------------------*11713071
117140 4120-CLOSE-CURSOR.                                               11714071
117150     EVALUATE TRUE                                                11715071
117160                                                                  11716071
117170         WHEN ASC-PRE-PACK-CSR                                    11717071
117180              PERFORM 4210-CLOSE-PRE-PK-CURSOR                    11718071
117190                                                                  11719071
117200         WHEN ASC-PO-ALL-LN-CSR                                   11720071
117210              PERFORM 4135-CLOSE-ALL-LN-CURSOR                    11721071
117220                                                                  11722071
117230         WHEN ASC-PO-ONE-LN-CSR                                   11723071
117240              PERFORM 4150-CLOSE-ONE-LN-CURSOR                    11724071
117250                                                                  11725071
117260     END-EVALUATE.                                                11726071
117270                                                                  11727071
117280                                                                  11728071
117290 4125-OPEN-ALL-LN-CURSOR.                                         11729071
117300     MOVE 'CURSOR:  PO-ALL-LN-CSR'                                11730071
117310                       TO DP013-MESSAGE-TEXT (2).                 11731071
117320     EXEC SQL                                                     11732071
117330          OPEN PO_ALL_LN_CSR                                      11733071
117340     END-EXEC.                                                    11734071
117350                                                                  11735071
117360     EVALUATE TRUE                                                11736071
117370         WHEN SQLCODE = ZERO                                      11737071
117380             CONTINUE                                             11738071
117390         WHEN SQLCODE = -904                                      11739071
117400         WHEN SQLCODE = -911                                      11740071
117410         WHEN SQLCODE = -913                                      11741071
117420                                                                  11742071
117430             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    11743071
117440             MOVE '4125-OPEN-ALL-LN-CURSOR' TO PV-SOFT-PARAGRAPH  11744071
117450             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  11745071
117460             MOVE LENGTH OF PV-CICS-MSG-AREA2                     11746071
117470               TO PV-COMMAREA-LENGTH                              11747071
117480             EXEC CICS                                            11748071
117490                  WRITEQ TD                                       11749071
117500                   QUEUE  ('CSSL')                                11750071
117510                    FROM  (PV-CICS-MSG-AREA2)                     11751071
117520                  LENGTH  (PV-COMMAREA-LENGTH)                    11752071
117530                    RESP  (PV-CICS-RESP)                          11753071
117540             END-EXEC                                             11754071
117550                                                                  11755071
117560             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          11756071
117570             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              11757071
117580             PERFORM 9900-SOFT-ABORT                              11758071
117590         WHEN SQLWARN0 NOT = SPACES                               11759071
117600         WHEN SQLCODE < ZERO                                      11760071
117610         WHEN SQLCODE > ZERO                                      11761071
117620             MOVE '4125-OPEN-ALL-LN-CURSOR'                       11762071
117630                               TO DP013-PARAGRAPH                 11763071
117640             MOVE 'OPEN SYSTEM MESSAGE CURSOR - '                 11764071
117650                               TO DP013-MESSAGE-TEXT (1)          11765071
117660             MOVE SQLCA        TO DP013-SQLCA                     11766071
117670             MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (1)        11767071
117680             MOVE 'TPURITM '   TO DP013-DB2-TABLE-NAME (2)        11768071
117690             SET DP013-DB2-ABEND                                  11769071
117700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               11770071
117710             PERFORM DP013-0000-PROCESS-ABEND                     11771071
117720     END-EVALUATE.                                                11772071
117730                                                                  11773071
117740                                                                  11774071
117750*----------------------------------------------------------------*11775071
117760*    FETCH CURSOR                                                *11776071
117770*----------------------------------------------------------------*11777071
117780 4130-FETCH-ALL-LN-CSR.                                           11778071
117790     MOVE 'CURSOR:  PO-ALL-LN-CSR'                                11779071
117800                       TO DP013-MESSAGE-TEXT (2).                 11780071
117810     EXEC SQL                                                     11781071
117820          FETCH PO_ALL_LN_CSR                                     11782071
117830           INTO :RECITM-ORD-LNE-NBR                               11783071
117840              , :RECITM-INNR-PACK-QTY                             11784071
117850              , :RECITM-OPER-UNT-ID                               11785071
117860              , :RECITM-FCLTY-ID                                  11786071
117870              , :PURITM-SKU-SEQ-NBR                               11787071
117880              , :RECITM-STATUS-CDE                                11788071
117890              , :RECITM-PKSL-ITM-QTY                              11789071
117900              , :RECITM-DTL-CK-ITM-QTY                            11790071
117910              , :RECITM-PREPK-ID                                  11791071
117920              , :RECITM-CASE-PACK-QTY                             11792071
117930              , :PURITM-ITM-NBR                                   11793071
117940     END-EXEC.                                                    11794071
117950                                                                  11795071
117960     EVALUATE TRUE                                                11796071
117970         WHEN SQLCODE = ZERO                                      11797071
117980              MOVE  RECITM-ORD-LNE-NBR  TO  ASC-PO-LINE-NBR       11798071
117990         WHEN SQLCODE = +100                                      11799071
118000         SET PS-NO-ITEMS-LEFT-ON-DB                               11800071
118010                                   TO TRUE                        11801071
118020         WHEN SQLCODE = -904                                      11802071
118030         WHEN SQLCODE = -911                                      11803071
118040         WHEN SQLCODE = -913                                      11804071
118050                                                                  11805071
118060             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    11806071
118070             MOVE '4130-FETCH-ALL-LN-CSR'   TO PV-SOFT-PARAGRAPH  11807071
118080             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  11808071
118090             MOVE LENGTH OF PV-CICS-MSG-AREA2                     11809071
118100               TO PV-COMMAREA-LENGTH                              11810071
118110             EXEC CICS                                            11811071
118120                  WRITEQ TD                                       11812071
118130                   QUEUE  ('CSSL')                                11813071
118140                    FROM  (PV-CICS-MSG-AREA2)                     11814071
118150                  LENGTH  (PV-COMMAREA-LENGTH)                    11815071
118160                    RESP  (PV-CICS-RESP)                          11816071
118170             END-EXEC                                             11817071
118180                                                                  11818071
118190             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          11819071
118200             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              11820071
118210             PERFORM 9900-SOFT-ABORT                              11821071
118220         WHEN SQLWARN0 NOT = SPACE                                11822071
118230         WHEN SQLCODE NOT = ZERO                                  11823071
118240              MOVE ASC-PO-LINE-NBR                                11824071
118250                                TO DP013-MESSAGE-TEXT (3)         11825071
118260              MOVE '4130-FETCH-ALL-LN-CSR'                        11826071
118270                               TO DP013-PARAGRAPH                 11827071
118280              MOVE 'FETCH RECITM/PURITM CURSOR'                   11828071
118290                               TO DP013-MESSAGE-TEXT (1)          11829071
118300              MOVE SQLCA       TO DP013-SQLCA                     11830071
118310              SET DP013-DB2-ABEND                                 11831071
118320                               TO TRUE                            11832071
118330              PERFORM DP013-0000-PROCESS-ABEND                    11833071
118340     END-EVALUATE.                                                11834071
118350                                                                  11835071
118360*----------------------------------------------------------------*11836071
118370*                                                                *11837071
118380*----------------------------------------------------------------*11838071
118390 4135-CLOSE-ALL-LN-CURSOR.                                        11839071
118400     MOVE 'CURSOR:  PO-ALL-LN-CSR'                                11840071
118410                       TO DP013-MESSAGE-TEXT (2).                 11841071
118420     EXEC SQL                                                     11842071
118430          CLOSE PO_ALL_LN_CSR                                     11843071
118440     END-EXEC.                                                    11844071
118450                                                                  11845071
118460     EVALUATE TRUE                                                11846071
118470         WHEN SQLCODE = ZERO                                      11847071
118480             CONTINUE                                             11848071
118490         WHEN SQLCODE = -904                                      11849071
118500         WHEN SQLCODE = -911                                      11850071
118510         WHEN SQLCODE = -913                                      11851071
118520                                                                  11852071
118530             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   11853071
118540             MOVE '4135-CLOSE-ALL-LN-CURSOR' TO PV-SOFT-PARAGRAPH 11854071
118550             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 11855071
118560             MOVE LENGTH OF PV-CICS-MSG-AREA2                     11856071
118570               TO PV-COMMAREA-LENGTH                              11857071
118580             EXEC CICS                                            11858071
118590                  WRITEQ TD                                       11859071
118600                   QUEUE  ('CSSL')                                11860071
118610                    FROM  (PV-CICS-MSG-AREA2)                     11861071
118620                  LENGTH  (PV-COMMAREA-LENGTH)                    11862071
118630                    RESP  (PV-CICS-RESP)                          11863071
118640             END-EXEC                                             11864071
118650                                                                  11865071
118660             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          11866071
118670             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              11867071
118680             PERFORM 9900-SOFT-ABORT                              11868071
118690         WHEN SQLWARN0 NOT = SPACES                               11869071
118700         WHEN SQLCODE < ZERO                                      11870071
118710         WHEN SQLCODE > ZERO                                      11871071
118720             MOVE '4135-CLOSE-ALL-LN-CURSOR'                      11872071
118730                               TO DP013-PARAGRAPH                 11873071
118740             MOVE 'CLOSE CURSOR                '                  11874071
118750                               TO DP013-MESSAGE-TEXT (1)          11875071
118760             MOVE SQLCA        TO DP013-SQLCA                     11876071
118770             MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (1)        11877071
118780             MOVE 'TPURITM '   TO DP013-DB2-TABLE-NAME (2)        11878071
118790             SET DP013-DB2-ABEND                                  11879071
118800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               11880071
118810             PERFORM DP013-0000-PROCESS-ABEND                     11881071
118820     END-EVALUATE.                                                11882071
118830                                                                  11883071
118840                                                                  11884071
118850*----------------------------------------------------------------*11885071
118860*                                                                *11886071
118870*----------------------------------------------------------------*11887071
118880 4140-OPEN-ONE-LN-CURSOR.                                         11888071
118890     MOVE 'CURSOR:  PO-ONE-LN-CSR'                                11889071
118900                       TO DP013-MESSAGE-TEXT (2).                 11890071
118910     EXEC SQL                                                     11891071
118920          OPEN PO_ONE_LN_CSR                                      11892071
118930     END-EXEC.                                                    11893071
118940                                                                  11894071
118950                                                                  11895071
118960     EVALUATE TRUE                                                11896071
118970         WHEN SQLCODE = ZERO                                      11897071
118980             CONTINUE                                             11898071
118990         WHEN SQLCODE = -904                                      11899071
119000         WHEN SQLCODE = -911                                      11900071
119010         WHEN SQLCODE = -913                                      11901071
119020                                                                  11902071
119030             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   11903071
119040             MOVE '4140-OPEN-ONE-LN-CURSOR'  TO PV-SOFT-PARAGRAPH 11904071
119050             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 11905071
119060             MOVE LENGTH OF PV-CICS-MSG-AREA2                     11906071
119070               TO PV-COMMAREA-LENGTH                              11907071
119080             EXEC CICS                                            11908071
119090                  WRITEQ TD                                       11909071
119100                   QUEUE  ('CSSL')                                11910071
119110                    FROM  (PV-CICS-MSG-AREA2)                     11911071
119120                  LENGTH  (PV-COMMAREA-LENGTH)                    11912071
119130                    RESP  (PV-CICS-RESP)                          11913071
119140             END-EXEC                                             11914071
119150                                                                  11915071
119160             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          11916071
119170             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              11917071
119180             PERFORM 9900-SOFT-ABORT                              11918071
119190         WHEN SQLWARN0 NOT = SPACES                               11919071
119200         WHEN SQLCODE < ZERO                                      11920071
119210         WHEN SQLCODE > ZERO                                      11921071
119220             MOVE '4140-OPEN-ONE-LN-CURSOR'                       11922071
119230                               TO DP013-PARAGRAPH                 11923071
119240             MOVE 'OPEN SYSTEM MESSAGE CURSOR - '                 11924071
119250                               TO DP013-MESSAGE-TEXT (1)          11925071
119260             MOVE SQLCA        TO DP013-SQLCA                     11926071
119270             MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (1)        11927071
119280             MOVE 'TPURITM '   TO DP013-DB2-TABLE-NAME (2)        11928071
119290             SET DP013-DB2-ABEND            TO TRUE               11929071
119300             PERFORM DP013-0000-PROCESS-ABEND                     11930071
119310     END-EVALUATE.                                                11931071
119320                                                                  11932071
119330                                                                  11933071
119340*----------------------------------------------------------------*11934071
119350*    FETCH CURSOR                                                *11935071
119360*----------------------------------------------------------------*11936071
119370 4145-FETCH-ONE-LN-CSR.                                           11937071
119380      MOVE 'CURSOR:  PO-RCVR-ONE-LN-CSR'                          11938071
119390                        TO DP013-MESSAGE-TEXT (2).                11939071
119400      EXEC SQL                                                    11940071
119410         FETCH PO_ONE_LN_CSR                                      11941071
119420          INTO :RECITM-ORD-LNE-NBR                                11942071
119430             , :RECITM-INNR-PACK-QTY                              11943071
119440             , :RECITM-OPER-UNT-ID                                11944071
119450             , :RECITM-FCLTY-ID                                   11945071
119460             , :PURITM-SKU-SEQ-NBR                                11946071
119470             , :RECITM-STATUS-CDE                                 11947071
119480             , :RECITM-PKSL-ITM-QTY                               11948071
119490             , :RECITM-DTL-CK-ITM-QTY                             11949071
119500             , :RECITM-PREPK-ID                                   11950071
119510             , :RECITM-CASE-PACK-QTY                              11951071
119520             , :PURITM-ITM-NBR                                    11952071
119530      END-EXEC.                                                   11953071
119540                                                                  11954071
119550     EVALUATE TRUE                                                11955071
119560         WHEN SQLCODE = ZERO                                      11956071
119570              MOVE  RECITM-ORD-LNE-NBR  TO  ASC-PO-LINE-NBR       11957071
119580         WHEN SQLCODE = +100                                      11958071
119590         SET PS-NO-ITEMS-LEFT-ON-DB                               11959071
119600                                   TO TRUE                        11960071
119610         WHEN SQLCODE = -904                                      11961071
119620         WHEN SQLCODE = -911                                      11962071
119630         WHEN SQLCODE = -913                                      11963071
119640                                                                  11964071
119650             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   11965071
119660             MOVE '4145-FETCH-ONE-LN-CSR'    TO PV-SOFT-PARAGRAPH 11966071
119670             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 11967071
119680             MOVE LENGTH OF PV-CICS-MSG-AREA2                     11968071
119690               TO PV-COMMAREA-LENGTH                              11969071
119700             EXEC CICS                                            11970071
119710                  WRITEQ TD                                       11971071
119720                   QUEUE  ('CSSL')                                11972071
119730                    FROM  (PV-CICS-MSG-AREA2)                     11973071
119740                  LENGTH  (PV-COMMAREA-LENGTH)                    11974071
119750                    RESP  (PV-CICS-RESP)                          11975071
119760             END-EXEC                                             11976071
119770                                                                  11977071
119780             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          11978071
119790             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              11979071
119800             PERFORM 9900-SOFT-ABORT                              11980071
119810         WHEN SQLWARN0 NOT = SPACE                                11981071
119820         WHEN SQLCODE NOT = ZERO                                  11982071
119830              MOVE '4145-FETCH-ONE-LN-CSR'                        11983071
119840                               TO DP013-PARAGRAPH                 11984071
119850              MOVE 'FETCH RECITM/PURITM CURSOR'                   11985071
119860                               TO DP013-MESSAGE-TEXT (1)          11986071
119870              MOVE SQLCA       TO DP013-SQLCA                     11987071
119880              SET DP013-DB2-ABEND                                 11988071
119890                               TO TRUE                            11989071
119900              PERFORM DP013-0000-PROCESS-ABEND                    11990071
119910     END-EVALUATE.                                                11991071
119920                                                                  11992071
119930                                                                  11993071
119940*----------------------------------------------------------------*11994071
119950*                                                                *11995071
119960*----------------------------------------------------------------*11996071
119970 4150-CLOSE-ONE-LN-CURSOR.                                        11997071
119980     MOVE 'CURSOR:  ASC-PO-ONE-LN-CSR'                            11998071
119990                       TO DP013-MESSAGE-TEXT (2)                  11999071
120000     EXEC SQL                                                     12000071
120010          CLOSE PO_ONE_LN_CSR                                     12001071
120020     END-EXEC                                                     12002071
120030                                                                  12003071
120040     EVALUATE TRUE                                                12004071
120050         WHEN SQLCODE = ZERO                                      12005071
120060             CONTINUE                                             12006071
120070         WHEN SQLCODE = -904                                      12007071
120080         WHEN SQLCODE = -911                                      12008071
120090         WHEN SQLCODE = -913                                      12009071
120100                                                                  12010071
120110             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   12011071
120120             MOVE '4150-CLOSE-ONE-LN-CURSOR' TO PV-SOFT-PARAGRAPH 12012071
120130             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 12013071
120140             MOVE LENGTH OF PV-CICS-MSG-AREA2                     12014071
120150               TO PV-COMMAREA-LENGTH                              12015071
120160             EXEC CICS                                            12016071
120170                  WRITEQ TD                                       12017071
120180                   QUEUE  ('CSSL')                                12018071
120190                    FROM  (PV-CICS-MSG-AREA2)                     12019071
120200                  LENGTH  (PV-COMMAREA-LENGTH)                    12020071
120210                    RESP  (PV-CICS-RESP)                          12021071
120220             END-EXEC                                             12022071
120230                                                                  12023071
120240             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          12024071
120250             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              12025071
120260             PERFORM 9900-SOFT-ABORT                              12026071
120270         WHEN SQLWARN0 NOT = SPACES                               12027071
120280         WHEN SQLCODE < ZERO                                      12028071
120290         WHEN SQLCODE > ZERO                                      12029071
120300             MOVE '4150-CLOSE-ONE-LN-CURSOR'                      12030071
120310                               TO DP013-PARAGRAPH                 12031071
120320             MOVE 'CLOSE CURSOR                '                  12032071
120330                               TO DP013-MESSAGE-TEXT (1)          12033071
120340             MOVE SQLCA        TO DP013-SQLCA                     12034071
120350             MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (1)        12035071
120360             MOVE 'TPURITM '   TO DP013-DB2-TABLE-NAME (2)        12036071
120370             SET DP013-DB2-ABEND            TO TRUE               12037071
120380             PERFORM DP013-0000-PROCESS-ABEND                     12038071
120390     END-EVALUATE.                                                12039071
120400                                                                  12040071
120410                                                                  12041071
120420*----------------------------------------------------------------*12042071
120430*                                                                *12043071
120440*----------------------------------------------------------------*12044071
120450 4155-OPEN-DC-RTV-CURSOR.                                         12045071
120460      EXEC SQL                                                    12046071
120470           OPEN DC_RTV_CSR                                        12047071
120480      END-EXEC                                                    12048071
120490                                                                  12049071
120500     EVALUATE TRUE                                                12050071
120510         WHEN SQLCODE = ZERO                                      12051071
120520             CONTINUE                                             12052071
120530         WHEN SQLCODE = -904                                      12053071
120540         WHEN SQLCODE = -911                                      12054071
120550         WHEN SQLCODE = -913                                      12055071
120560                                                                  12056071
120570             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   12057071
120580             MOVE '4155-OPEN-DC-RTV-CURSOR'  TO PV-SOFT-PARAGRAPH 12058071
120590             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 12059071
120600             MOVE LENGTH OF PV-CICS-MSG-AREA2                     12060071
120610               TO PV-COMMAREA-LENGTH                              12061071
120620             EXEC CICS                                            12062071
120630                  WRITEQ TD                                       12063071
120640                   QUEUE  ('CSSL')                                12064071
120650                    FROM  (PV-CICS-MSG-AREA2)                     12065071
120660                  LENGTH  (PV-COMMAREA-LENGTH)                    12066071
120670                    RESP  (PV-CICS-RESP)                          12067071
120680             END-EXEC                                             12068071
120690                                                                  12069071
120700             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          12070071
120710             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              12071071
120720             PERFORM 9900-SOFT-ABORT                              12072071
120730         WHEN SQLWARN0 NOT = SPACES                               12073071
120740         WHEN SQLCODE < ZERO                                      12074071
120750         WHEN SQLCODE > ZERO                                      12075071
120760             MOVE '4155-OPEN-DC-RTV-CURSOR'                       12076071
120770                               TO DP013-PARAGRAPH                 12077071
120780             MOVE 'OPEN SYSTEM MESSAGE CURSOR - '                 12078071
120790                               TO DP013-MESSAGE-TEXT (1)          12079071
120800             MOVE 'CURSOR:  DC-RTV-CURSOR           '             12080071
120810                               TO DP013-MESSAGE-TEXT (2)          12081071
120820             MOVE SQLCA        TO DP013-SQLCA                     12082071
120830             MOVE 'TRECDIS '   TO DP013-DB2-TABLE-NAME (1)        12083071
120840             MOVE 'XLT_LOC '   TO DP013-DB2-TABLE-NAME (2)        12084071
120850             SET DP013-DB2-ABEND            TO TRUE               12085071
120860             PERFORM DP013-0000-PROCESS-ABEND                     12086071
120870     END-EVALUATE.                                                12087071
120880                                                                  12088071
120890                                                                  12089071
120900*----------------------------------------------------------------*12090071
121000*                                                                *12100071
121010*----------------------------------------------------------------*12101071
121020 4160-FETCH-DC-RTV-CURSOR.                                        12102071
121030     EXEC SQL                                                     12103071
121040          FETCH DC_RTV_CSR                                        12104071
121050           INTO :PV-DC-RTV-TYPE-CODE                              12105071
121060              , :PV-DC-RTV-EXPT-CNT                               12106071
121070     END-EXEC.                                                    12107071
121080                                                                  12108071
121090     EVALUATE TRUE                                                12109071
121100         WHEN SQLCODE = ZERO                                      12110071
121110              ADD  1  TO  PV-DC-RTV-ROWS-RETRIEVED                12111071
121120              IF  PV-DC-RTV-TYPE-CODE  = 'DC'                     12112071
121130                  MOVE  PV-DC-RTV-EXPT-CNT                        12113071
121140                    TO  PV-DC-BOUND-EXPT-CNT                      12114071
121150              END-IF                                              12115071
121160              IF  PV-DC-RTV-TYPE-CODE  = 'RV'                     12116071
121170                  MOVE  PV-DC-RTV-EXPT-CNT                        12117071
121180                    TO  PV-RTV-BOUND-EXPT-CNT                     12118071
121190              END-IF                                              12119071
121200         WHEN SQLCODE = +100                                      12120071
121210             SET PS-EOF-DC-RTV-CURSOR  TO TRUE                    12121071
121220         WHEN SQLCODE = -904                                      12122071
121230         WHEN SQLCODE = -911                                      12123071
121240         WHEN SQLCODE = -913                                      12124071
121250                                                                  12125071
121260             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   12126071
121270             MOVE '4160-FETCH-DC-RTV-CURSOR' TO PV-SOFT-PARAGRAPH 12127071
121280             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 12128071
121290             MOVE LENGTH OF PV-CICS-MSG-AREA2                     12129071
121300               TO PV-COMMAREA-LENGTH                              12130071
121310             EXEC CICS                                            12131071
121320                  WRITEQ TD                                       12132071
121330                   QUEUE  ('CSSL')                                12133071
121340                    FROM  (PV-CICS-MSG-AREA2)                     12134071
121350                  LENGTH  (PV-COMMAREA-LENGTH)                    12135071
121360                    RESP  (PV-CICS-RESP)                          12136071
121370             END-EXEC                                             12137071
121380                                                                  12138071
121390             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          12139071
121400             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              12140071
121410             PERFORM 9900-SOFT-ABORT                              12141071
121420         WHEN SQLWARN0 NOT = SPACE                                12142071
121430         WHEN SQLCODE NOT = ZERO                                  12143071
121440              MOVE '4160-FETCH-DC-RTV-CURSOR'                     12144071
121450                               TO DP013-PARAGRAPH                 12145071
121460              MOVE 'FETCH RECITM/PURITM CURSOR'                   12146071
121470                               TO DP013-MESSAGE-TEXT (1)          12147071
121480              MOVE 'CURSOR:  DC-RTV-CURSOR       '                12148071
121490                               TO DP013-MESSAGE-TEXT (2)          12149071
121500              MOVE SQLCA       TO DP013-SQLCA                     12150071
121510              SET DP013-DB2-ABEND                                 12151071
121520                               TO TRUE                            12152071
121530              PERFORM DP013-0000-PROCESS-ABEND                    12153071
121540     END-EVALUATE.                                                12154071
121550                                                                  12155071
121560                                                                  12156071
121570*----------------------------------------------------------------*12157071
121580*                                                                *12158071
121590*----------------------------------------------------------------*12159071
121600 4165-CLOSE-DC-RTV-CURSOR.                                        12160071
121610     EXEC SQL                                                     12161071
121620          CLOSE DC_RTV_CSR                                        12162071
121630     END-EXEC                                                     12163071
121640                                                                  12164071
121650     EVALUATE TRUE                                                12165071
121660         WHEN SQLCODE = ZERO                                      12166071
121670             CONTINUE                                             12167071
121680         WHEN SQLCODE = -904                                      12168071
121690         WHEN SQLCODE = -911                                      12169071
121700         WHEN SQLCODE = -913                                      12170071
121710                                                                  12171071
121720             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   12172071
121730             MOVE '4165-CLOSE-DC-RTV-CURSOR' TO PV-SOFT-PARAGRAPH 12173071
121740             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 12174071
121750             MOVE LENGTH OF PV-CICS-MSG-AREA2                     12175071
121760               TO PV-COMMAREA-LENGTH                              12176071
121770             EXEC CICS                                            12177071
121780                  WRITEQ TD                                       12178071
121790                   QUEUE  ('CSSL')                                12179071
121800                    FROM  (PV-CICS-MSG-AREA2)                     12180071
121810                  LENGTH  (PV-COMMAREA-LENGTH)                    12181071
121820                    RESP  (PV-CICS-RESP)                          12182071
121830             END-EXEC                                             12183071
121840                                                                  12184071
121850             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          12185071
121860             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              12186071
121870             PERFORM 9900-SOFT-ABORT                              12187071
121880         WHEN SQLWARN0 NOT = SPACES                               12188071
121890         WHEN SQLCODE < ZERO                                      12189071
121900         WHEN SQLCODE > ZERO                                      12190071
121910             MOVE '4165-CLOSE-DC-RTV-CURSOR'                      12191071
121920                               TO DP013-PARAGRAPH                 12192071
121930             MOVE 'CLOSE SYSTEM MESSAGE CURSOR '                  12193071
121940                               TO DP013-MESSAGE-TEXT (1)          12194071
121950             MOVE 'CURSOR:  TDC-RTV-CURSOR'                       12195071
121960                               TO DP013-MESSAGE-TEXT (2)          12196071
121970             MOVE SQLCA        TO DP013-SQLCA                     12197071
121980             MOVE 'TRECDIS '   TO DP013-DB2-TABLE-NAME (1)        12198071
121990             MOVE 'TSRT000 '   TO DP013-DB2-TABLE-NAME (2)        12199071
122000             SET DP013-DB2-ABEND                                  12200071
122010                 DP013-XCTL-DISPLAY-RESTART TO TRUE               12201071
122020             PERFORM DP013-0000-PROCESS-ABEND                     12202071
122030     END-EVALUATE.                                                12203071
122040                                                                  12204071
122050                                                                  12205071
122060*----------------------------------------------------------------*12206071
122070*                                                                *12207071
122080*----------------------------------------------------------------*12208071
122090 4170-OPEN-TRECDIS-CURSOR.                                        12209071
122100      EXEC SQL                                                    12210071
122110           OPEN TRECDIS_CSR                                       12211071
122120      END-EXEC                                                    12212071
122130                                                                  12213071
122140     EVALUATE TRUE                                                12214071
122150         WHEN SQLCODE = ZERO                                      12215071
122160             CONTINUE                                             12216071
122170         WHEN SQLCODE = -904                                      12217071
122180         WHEN SQLCODE = -911                                      12218071
122190         WHEN SQLCODE = -913                                      12219071
122200                                                                  12220071
122210             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   12221071
122220             MOVE '4170-OPEN-TRECDIS-CURSOR' TO PV-SOFT-PARAGRAPH 12222071
122230             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 12223071
122240             MOVE LENGTH OF PV-CICS-MSG-AREA2                     12224071
122250               TO PV-COMMAREA-LENGTH                              12225071
122260             EXEC CICS                                            12226071
122270                  WRITEQ TD                                       12227071
122280                   QUEUE  ('CSSL')                                12228071
122290                    FROM  (PV-CICS-MSG-AREA2)                     12229071
122300                  LENGTH  (PV-COMMAREA-LENGTH)                    12230071
122310                    RESP  (PV-CICS-RESP)                          12231071
122320             END-EXEC                                             12232071
122330                                                                  12233071
122340             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          12234071
122350             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              12235071
122360             PERFORM 9900-SOFT-ABORT                              12236071
122370         WHEN SQLWARN0 NOT = SPACES                               12237071
122380         WHEN SQLCODE < ZERO                                      12238071
122390         WHEN SQLCODE > ZERO                                      12239071
122400             MOVE '4170-OPEN-TRECDIS-CURSOR'                      12240071
122410                               TO DP013-PARAGRAPH                 12241071
122420             MOVE 'OPEN REC DISTRIBUTION CURSOR - '               12242071
122430                               TO DP013-MESSAGE-TEXT (1)          12243071
122440             MOVE 'CURSOR:  DC-RTV-CURSOR           '             12244071
122450                               TO DP013-MESSAGE-TEXT (2)          12245071
122460             MOVE SQLCA        TO DP013-SQLCA                     12246071
122470             MOVE 'TRECDIS '   TO DP013-DB2-TABLE-NAME (1)        12247071
122480             SET DP013-DB2-ABEND                                  12248071
122490                 DP013-XCTL-DISPLAY-RESTART TO TRUE               12249071
122500             PERFORM DP013-0000-PROCESS-ABEND                     12250071
122510     END-EVALUATE.                                                12251071
122520                                                                  12252071
122530                                                                  12253071
122540*----------------------------------------------------------------*12254071
122550*                                                                *12255071
122560*----------------------------------------------------------------*12256071
122570 4175-FETCH-TRECDIS-CURSOR.                                       12257071
122580     EXEC SQL                                                     12258071
122590          FETCH TRECDIS_CSR                                       12259071
122600           INTO :PV-STR-NBR                                       12260071
122610              , :PV-EXPTED-ITM-QTY                                12261071
122620              , :PV-TYPE-CODE                                     12262071
122630     END-EXEC.                                                    12263071
122640                                                                  12264071
122650     EVALUATE TRUE                                                12265071
122660         WHEN SQLCODE = ZERO                                      12266071
122670                                                                  12267071
122680              IF  ASC-LNE-CRE-SML-LBL (ASC-BLK-SUB ASC-ITEM-SUB)  12268071
122690                                                                  12269071
122700                  PERFORM 4351-CALCULATE-LBL-QTY-SML              12270071
122710              ELSE                                                12271071
122720                  PERFORM 4350-CALCULATE-LBL-QTY                  12272071
122730              END-IF                                              12273071
122740              IF  ASC-LNE-CRE-BOTH-LBL                            12274071
122750                      (ASC-BLK-SUB ASC-ITEM-SUB)   AND            12275071
122760                  (PV-TYPE-CODE  =  'DC'  OR                      12276071
122770                   PV-TYPE-CODE  =  'RV')                         12277071
122780                  PERFORM 4353-CK-DC-RTV-OTPK-DISTRO              12278071
122790              END-IF                                              12279071
122800              IF  ASC-LNE-CRE-SML-LBL (ASC-BLK-SUB ASC-ITEM-SUB)  12280071
122810                  PERFORM 4360-CK-OTPK-EXPTD-ITEM                 12281071
122820              END-IF                                              12282071
122830         WHEN SQLCODE = -904                                      12283071
122840         WHEN SQLCODE = -911                                      12284071
122850         WHEN SQLCODE = -913                                      12285071
122860                                                                  12286071
122870             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   12287071
122880             MOVE '4175-FETCH-TRECDIS-CURSOR'                     12288071
122890                                             TO PV-SOFT-PARAGRAPH 12289071
122900             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 12290071
122910             MOVE LENGTH OF PV-CICS-MSG-AREA2                     12291071
122920               TO PV-COMMAREA-LENGTH                              12292071
122930             EXEC CICS                                            12293071
122940                  WRITEQ TD                                       12294071
122950                   QUEUE  ('CSSL')                                12295071
122960                    FROM  (PV-CICS-MSG-AREA2)                     12296071
122970                  LENGTH  (PV-COMMAREA-LENGTH)                    12297071
122980                    RESP  (PV-CICS-RESP)                          12298071
122990             END-EXEC                                             12299071
123000                                                                  12300071
123010             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          12301071
123020             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              12302071
123030             PERFORM 9900-SOFT-ABORT                              12303071
123040         WHEN SQLCODE = +100                                      12304071
123050             SET PS-EOF-TRECDIS-CURSOR  TO TRUE                   12305071
123060         WHEN SQLWARN0 NOT = SPACE                                12306071
123070         WHEN SQLCODE NOT = ZERO                                  12307071
123080              MOVE '4175-FETCH-TRECDIS-CURSOR'                    12308071
123090                               TO DP013-PARAGRAPH                 12309071
123100              MOVE 'FETCH REC DISTRIBUTION CURSOR'                12310071
123110                               TO DP013-MESSAGE-TEXT (1)          12311071
123120              MOVE 'CURSOR:  TRECDIS-CURSOR      '                12312071
123130                               TO DP013-MESSAGE-TEXT (2)          12313071
123140              MOVE SQLCA       TO DP013-SQLCA                     12314071
123150              SET DP013-DB2-ABEND                                 12315071
123160                               TO TRUE                            12316071
123170              PERFORM DP013-0000-PROCESS-ABEND                    12317071
123180     END-EVALUATE.                                                12318071
123190                                                                  12319071
123200                                                                  12320071
123210*----------------------------------------------------------------*12321071
123220*                                                                *12322071
123230*----------------------------------------------------------------*12323071
123240 4180-CLOSE-TRECDIS-CURSOR.                                       12324071
123250     EXEC SQL                                                     12325071
123260          CLOSE TRECDIS_CSR                                       12326071
123270     END-EXEC                                                     12327071
123280                                                                  12328071
123290     EVALUATE TRUE                                                12329071
123300         WHEN SQLCODE = ZERO                                      12330071
123310             CONTINUE                                             12331071
123320         WHEN SQLCODE = -904                                      12332071
123330         WHEN SQLCODE = -911                                      12333071
123340         WHEN SQLCODE = -913                                      12334071
123350                                                                  12335071
123360             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   12336071
123370             MOVE '4180-CLOSE-TRECDIS-CURSOR'                     12337071
123380                                             TO PV-SOFT-PARAGRAPH 12338071
123390             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 12339071
123400             MOVE LENGTH OF PV-CICS-MSG-AREA2                     12340071
123410               TO PV-COMMAREA-LENGTH                              12341071
123420             EXEC CICS                                            12342071
123430                  WRITEQ TD                                       12343071
123440                   QUEUE  ('CSSL')                                12344071
123450                    FROM  (PV-CICS-MSG-AREA2)                     12345071
123460                  LENGTH  (PV-COMMAREA-LENGTH)                    12346071
123470                    RESP  (PV-CICS-RESP)                          12347071
123480             END-EXEC                                             12348071
123490                                                                  12349071
123500             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          12350071
123510             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              12351071
123520             PERFORM 9900-SOFT-ABORT                              12352071
123530         WHEN SQLWARN0 NOT = SPACES                               12353071
123540         WHEN SQLCODE < ZERO                                      12354071
123550         WHEN SQLCODE > ZERO                                      12355071
123560             MOVE '4180-CLOSE-TRECDIS-CURSOR'                     12356071
123570                               TO DP013-PARAGRAPH                 12357071
123580             MOVE 'CLOSE REC DISTRIBUTION CURSOR '                12358071
123590                               TO DP013-MESSAGE-TEXT (1)          12359071
123600             MOVE 'CURSOR:  TDC-RTV-CURSOR'                       12360071
123610                               TO DP013-MESSAGE-TEXT (2)          12361071
123620             MOVE SQLCA        TO DP013-SQLCA                     12362071
123630             MOVE 'TRECDIS '   TO DP013-DB2-TABLE-NAME (1)        12363071
123640             SET DP013-DB2-ABEND                                  12364071
123650                 DP013-XCTL-DISPLAY-RESTART TO TRUE               12365071
123660             PERFORM DP013-0000-PROCESS-ABEND                     12366071
123670     END-EVALUATE.                                                12367071
123680                                                                  12368071
123690                                                                  12369071
123700*----------------------------------------------------------------*12370071
123710* PRE-PACK ORDER - OPEN CURSOR                                   *12371071
123720*----------------------------------------------------------------*12372071
123730 4200-OPEN-PRE-PK-CURSOR.                                         12373071
123740     MOVE 'CURSOR:  PRE-PACK-CSR'                                 12374071
123750                       TO DP013-MESSAGE-TEXT (2).                 12375071
123760     EXEC SQL                                                     12376071
123770          OPEN PRE_PACK_CSR                                       12377071
123780     END-EXEC.                                                    12378071
123790                                                                  12379071
123800     EVALUATE TRUE                                                12380071
123810         WHEN SQLCODE = ZERO                                      12381071
123820             CONTINUE                                             12382071
123830         WHEN SQLCODE = -904                                      12383071
123840         WHEN SQLCODE = -911                                      12384071
123850         WHEN SQLCODE = -913                                      12385071
123860                                                                  12386071
123870             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    12387071
123880             MOVE '4200-OPEN-PRE-PK-CURSOR' TO PV-SOFT-PARAGRAPH  12388071
123890             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  12389071
123900             MOVE LENGTH OF PV-CICS-MSG-AREA2                     12390071
123910               TO PV-COMMAREA-LENGTH                              12391071
123920             EXEC CICS                                            12392071
123930                  WRITEQ TD                                       12393071
123940                   QUEUE  ('CSSL')                                12394071
123950                    FROM  (PV-CICS-MSG-AREA2)                     12395071
123960                  LENGTH  (PV-COMMAREA-LENGTH)                    12396071
123970                    RESP  (PV-CICS-RESP)                          12397071
123980             END-EXEC                                             12398071
123990                                                                  12399071
124000             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          12400071
124010             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              12401071
124020             PERFORM 9900-SOFT-ABORT                              12402071
124030         WHEN SQLWARN0 NOT = SPACES                               12403071
124040         WHEN SQLCODE < ZERO                                      12404071
124050         WHEN SQLCODE > ZERO                                      12405071
124060             MOVE '4200-OPEN-PRE-PK-CURSOR'                       12406071
124070                               TO DP013-PARAGRAPH                 12407071
124080             MOVE 'OPEN SYSTEM MESSAGE CURSOR - '                 12408071
124090                               TO DP013-MESSAGE-TEXT (1)          12409071
124100             MOVE SQLCA        TO DP013-SQLCA                     12410071
124110             MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (1)        12411071
124120             MOVE 'TPURITM '   TO DP013-DB2-TABLE-NAME (2)        12412071
124130             SET DP013-DB2-ABEND                                  12413071
124140                 DP013-XCTL-DISPLAY-RESTART TO TRUE               12414071
124150             PERFORM DP013-0000-PROCESS-ABEND                     12415071
124160     END-EVALUATE.                                                12416071
124170                                                                  12417071
124180                                                                  12418071
124190*----------------------------------------------------------------*12419071
124200* PRE-PACK ORDER - FETCH CURSOR                                  *12420071
124210*----------------------------------------------------------------*12421071
124220 4205-FETCH-PRE-PK-CSR.                                           12422071
124230     MOVE 'CURSOR:  PRE-PACK-CSR'                                 12423071
124240                       TO DP013-MESSAGE-TEXT (2).                 12424071
124250                                                                  12425071
124260     SET  PS-NOT-NEW-PRE-PK-ID  TO  TRUE.                         12426071
124270                                                                  12427071
124280     EXEC SQL                                                     12428071
124290          FETCH PRE_PACK_CSR                                      12429071
124300           INTO :RECITM-ORD-LNE-NBR                               12430071
124310              , :RECITM-INNR-PACK-QTY                             12431071
124320              , :RECITM-OPER-UNT-ID                               12432071
124330              , :RECITM-FCLTY-ID                                  12433071
124340              , :PURITM-SKU-SEQ-NBR                               12434071
124350              , :RECITM-STATUS-CDE                                12435071
124360              , :RECITM-PKSL-ITM-QTY                              12436071
124370              , :RECITM-DTL-CK-ITM-QTY                            12437071
124380              , :RECITM-PREPK-ID                                  12438071
124390              , :RECITM-PREPK-RATO-QTY                            12439071
124400              , :RECITM-CASE-PACK-QTY                             12440071
124410              , :PURITM-ITM-NBR                                   12441071
124420     END-EXEC.                                                    12442071
124430                                                                  12443071
124440     EVALUATE TRUE                                                12444071
124450         WHEN SQLCODE = ZERO                                      12445071
124460              MOVE  RECITM-ORD-LNE-NBR  TO  ASC-PO-LINE-NBR       12446071
124470              IF  RECITM-PREPK-ID  =  PV-PREV-PREPK-ID            12447071
124480                  SET  PS-NOT-NEW-PRE-PK-ID  TO  TRUE             12448071
124490              ELSE                                                12449071
124500                  MOVE RECITM-PREPK-ID       TO  PV-PREV-PREPK-ID 12450071
124510                  SET  PS-NEW-PRE-PK-ID      TO  TRUE             12451071
124520              END-IF                                              12452071
124530                                                                  12453071
124540             PERFORM 4215-CHECK-DWNLD-DRIVER                      12454071
124550                                                                  12455071
124560         WHEN SQLCODE = +100                                      12456071
124570         SET PS-NO-ITEMS-LEFT-ON-DB                               12457071
124580                                   TO TRUE                        12458071
124590         WHEN SQLCODE = -904                                      12459071
124600         WHEN SQLCODE = -911                                      12460071
124610         WHEN SQLCODE = -913                                      12461071
124620                                                                  12462071
124630             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    12463071
124640             MOVE '4205-FETCH-PRE-PK-CSR'   TO PV-SOFT-PARAGRAPH  12464071
124650             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  12465071
124660             MOVE LENGTH OF PV-CICS-MSG-AREA2                     12466071
124670               TO PV-COMMAREA-LENGTH                              12467071
124680             EXEC CICS                                            12468071
124690                  WRITEQ TD                                       12469071
124700                   QUEUE  ('CSSL')                                12470071
124710                    FROM  (PV-CICS-MSG-AREA2)                     12471071
124720                  LENGTH  (PV-COMMAREA-LENGTH)                    12472071
124730                    RESP  (PV-CICS-RESP)                          12473071
124740             END-EXEC                                             12474071
124750                                                                  12475071
124760             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          12476071
124770             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              12477071
124780             PERFORM 9900-SOFT-ABORT                              12478071
124790         WHEN SQLWARN0 NOT = SPACE                                12479071
124800         WHEN SQLCODE NOT = ZERO                                  12480071
124810              MOVE ASC-PO-LINE-NBR                                12481071
124820                                TO DP013-MESSAGE-TEXT (3)         12482071
124830              MOVE '4205-FETCH-PRE-PK-CSR'                        12483071
124840                               TO DP013-PARAGRAPH                 12484071
124850              MOVE 'FETCH RECITM/PURITM CURSOR'                   12485071
124860                               TO DP013-MESSAGE-TEXT (1)          12486071
124870              MOVE SQLCA       TO DP013-SQLCA                     12487071
124880              SET DP013-DB2-ABEND                                 12488071
124890                               TO TRUE                            12489071
124900              PERFORM DP013-0000-PROCESS-ABEND                    12490071
124910     END-EVALUATE.                                                12491071
124920                                                                  12492071
124930*----------------------------------------------------------------*12493071
124940* PRE-PACK ORDER - CLOSE CURSOR                                  *12494071
124950*----------------------------------------------------------------*12495071
124960 4210-CLOSE-PRE-PK-CURSOR.                                        12496071
124970     MOVE 'CURSOR:  PRE-PACK-CSR'                                 12497071
124980                       TO DP013-MESSAGE-TEXT (2).                 12498071
124990     EXEC SQL                                                     12499071
125000          CLOSE PRE_PACK_CSR                                      12500071
125010     END-EXEC.                                                    12501071
125020                                                                  12502071
125030     EVALUATE TRUE                                                12503071
125040         WHEN SQLCODE = ZERO                                      12504071
125050             CONTINUE                                             12505071
125060         WHEN SQLCODE = -904                                      12506071
125070         WHEN SQLCODE = -911                                      12507071
125080         WHEN SQLCODE = -913                                      12508071
125090                                                                  12509071
125100             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   12510071
125110             MOVE '4210-CLOSE-PRE-PK-CURSOR' TO PV-SOFT-PARAGRAPH 12511071
125120             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 12512071
125130             MOVE LENGTH OF PV-CICS-MSG-AREA2                     12513071
125140               TO PV-COMMAREA-LENGTH                              12514071
125150             EXEC CICS                                            12515071
125160                  WRITEQ TD                                       12516071
125170                   QUEUE  ('CSSL')                                12517071
125180                    FROM  (PV-CICS-MSG-AREA2)                     12518071
125190                  LENGTH  (PV-COMMAREA-LENGTH)                    12519071
125200                    RESP  (PV-CICS-RESP)                          12520071
125210             END-EXEC                                             12521071
125220                                                                  12522071
125230             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          12523071
125240             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              12524071
125250             PERFORM 9900-SOFT-ABORT                              12525071
125260         WHEN SQLWARN0 NOT = SPACES                               12526071
125270         WHEN SQLCODE < ZERO                                      12527071
125280         WHEN SQLCODE > ZERO                                      12528071
125290             MOVE '4210-CLOSE-PRE-PK-CURSOR'                      12529071
125300                               TO DP013-PARAGRAPH                 12530071
125310             MOVE 'CLOSE CURSOR                '                  12531071
125320                               TO DP013-MESSAGE-TEXT (1)          12532071
125330             MOVE SQLCA        TO DP013-SQLCA                     12533071
125340             MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (1)        12534071
125350             MOVE 'TPURITM '   TO DP013-DB2-TABLE-NAME (2)        12535071
125360             SET DP013-DB2-ABEND                                  12536071
125370                 DP013-XCTL-DISPLAY-RESTART TO TRUE               12537071
125380             PERFORM DP013-0000-PROCESS-ABEND                     12538071
125390     END-EVALUATE.                                                12539071
125400                                                                  12540071
125410*----------------------------------------------------------------*12541071
125420* THE PROCESS TO DETERMINE PREPACK DRIVER LINE WAS CHANGED TO    *12542071
125430* USE THE DRIVER LINE ON TRECITM.                                *12543071
125440* THIS PROCESS HAS BEEN ADDED FOR ORDERS THAT WERE PREVIOUSLY    *12544071
125450* DOWNLOADED TO ENSURE THAT THE SAME DRIVER LINE WAS SELECTED.   *12545071
125460* DMH - 12/03/2004 -begin                                        *12546071
125470*----------------------------------------------------------------*12547071
125480 4215-CHECK-DWNLD-DRIVER.                                         12548071
125490                                                                  12549071
125500     EXEC SQL                                                     12550071
125510          SELECT  ORD_LNE_NBR                                     12551071
125520                 ,PREPK_LNE_PRC_CDE                               12552071
125530            INTO  :DISTHD-ORD-LNE-NBR                             12553071
125540                 ,:DISTHD-PREPK-LNE-PRC-CDE                       12554071
125550            FROM  TDISTHD                                         12555071
125560            WHERE ORD_NBR          = :ASC-PO-NBR                  12556071
125570              AND RCVR_SEQ_NBR     = :ASC-REC-SEQ-NBR             12557071
125580              AND ORD_LNE_NBR      = :ASC-PO-LINE-NBR             12558071
125590              AND TOT_CART_CNT     > 0                            12559071
125600              AND  CRE_USR_ID NOT IN ('TRLRUNLD','HOTCMPLT')      12560071
125610     END-EXEC.                                                    12561071
125620                                                                  12562071
125630     EVALUATE TRUE                                                12563071
125640         WHEN SQLCODE = ZERO                                      12564071
125650              IF  DISTHD-PREPK-LNE-PRC-CDE  = 'D'                 12565071
125660                  CONTINUE                                        12566071
125670              ELSE                                                12567071
125680                  PERFORM 4220-FIND-ORIG-DWNLD-DRIVER             12568071
125690              END-IF                                              12569071
125700                                                                  12570071
125710         WHEN SQLCODE = +100                                      12571071
125720              CONTINUE                                            12572071
125730                                                                  12573071
125740         WHEN SQLCODE = -904                                      12574071
125750         WHEN SQLCODE = -911                                      12575071
125760         WHEN SQLCODE = -913                                      12576071
125770             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   12577071
125780             MOVE '4215-CHECK-DWNLD-DRIVER'  TO PV-SOFT-PARAGRAPH 12578071
125790             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 12579071
125800             MOVE LENGTH OF PV-CICS-MSG-AREA2                     12580071
125810               TO PV-COMMAREA-LENGTH                              12581071
125820             EXEC CICS                                            12582071
125830                  WRITEQ TD                                       12583071
125840                   QUEUE  ('CSSL')                                12584071
125850                    FROM  (PV-CICS-MSG-AREA2)                     12585071
125860                  LENGTH  (PV-COMMAREA-LENGTH)                    12586071
125870                    RESP  (PV-CICS-RESP)                          12587071
125880             END-EXEC                                             12588071
125890             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          12589071
125900             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              12590071
125910             PERFORM 9900-SOFT-ABORT                              12591071
125920         WHEN SQLWARN0 NOT = SPACES                               12592071
125930         WHEN SQLCODE  NOT = ZERO                                 12593071
125940             MOVE '4215-CHECK-DWNLD-DRIVER'                       12594071
125950                                 TO DP013-PARAGRAPH               12595071
125960             MOVE 'UNSUCCESSFUL SELECT OF TDISTHD'                12596071
125970                                 TO DP013-MESSAGE-TEXT (1)        12597071
125980             MOVE SQLCA         TO DP013-SQLCA                    12598071
125990             MOVE 'TDISTHD'     TO DP013-DB2-TABLE-NAME (1)       12599071
126000             SET DP013-DB2-ABEND                                  12600071
126010                 DP013-XCTL-DISPLAY-RESTART                       12601071
126020                                 TO TRUE                          12602071
126030                                                                  12603071
126040             PERFORM DP013-0000-PROCESS-ABEND                     12604071
126050     END-EVALUATE.                                                12605071
126060                                                                  12606071
126070                                                                  12607071
126080 4220-FIND-ORIG-DWNLD-DRIVER.                                     12608071
126090                                                                  12609071
126100     EXEC SQL                                                     12610071
126110          SELECT  A.ORD_LNE_NBR                                   12611071
126120               ,  A.INNR_PACK_QTY                                 12612071
126130               ,  A.OPER_UNT_ID                                   12613071
126140               ,  A.FCLTY_ID                                      12614071
126150               ,  B.SKU_SEQ_NBR                                   12615071
126160               ,  A.STATUS_CDE                                    12616071
126170               ,  A.PKSL_ITM_QTY                                  12617071
126180               ,  A.DTL_CK_ITM_QTY                                12618071
126190               ,  A.PREPK_ID                                      12619071
126200               ,  A.PREPK_RATO_QTY                                12620071
126210               ,  A.CASE_PACK_QTY                                 12621071
126220               ,  B.ITM_NBR                                       12622071
126230            INTO :RECITM-ORD-LNE-NBR                              12623071
126240               , :RECITM-INNR-PACK-QTY                            12624071
126250               , :RECITM-OPER-UNT-ID                              12625071
126260               , :RECITM-FCLTY-ID                                 12626071
126270               , :PURITM-SKU-SEQ-NBR                              12627071
126280               , :RECITM-STATUS-CDE                               12628071
126290               , :RECITM-PKSL-ITM-QTY                             12629071
126300               , :RECITM-DTL-CK-ITM-QTY                           12630071
126310               , :RECITM-PREPK-ID                                 12631071
126320               , :RECITM-PREPK-RATO-QTY                           12632071
126330               , :RECITM-CASE-PACK-QTY                            12633071
126340               , :PURITM-ITM-NBR                                  12634071
126350                FROM TRECITM A                                    12635071
126360                    ,TPURITM B                                    12636071
126370                    ,TDISTHD C                                    12637071
126380               WHERE A.ORD_NBR           = :ASC-PO-NBR            12638071
126390                 AND A.REC_SEQ_NBR       = :ASC-REC-SEQ-NBR       12639071
126400                 AND A.ORD_NBR           = B.PO_NBR               12640071
126410                 AND A.ORD_LNE_NBR       = B.APP_PO_LNE_NBR       12641071
126420                 AND A.VER_STATUS_CDE    = 'A'                    12642071
126430                 AND A.PO_VER_NBR        = B.VER_NBR              12643071
126440                                                                  12644071
126450                 AND A.ORD_NBR           = C.ORD_NBR              12645071
126460                 AND A.REC_SEQ_NBR       = C.RCVR_SEQ_NBR         12646071
126470                 AND A.ORD_LNE_NBR       = C.ORD_LNE_NBR          12647071
126480                 AND C.PREPK_LNE_PRC_CDE = 'D'                    12648071
126490                 AND A.PREPK_ID          = :RECITM-PREPK-ID       12649071
126500     END-EXEC.                                                    12650071
126510                                                                  12651071
126520     EVALUATE TRUE                                                12652071
126530         WHEN SQLCODE = ZERO                                      12653071
126540              MOVE  RECITM-ORD-LNE-NBR  TO  ASC-PO-LINE-NBR       12654071
126550                                                                  12655071
126560         WHEN SQLCODE = +100                                      12656071
126570              CONTINUE                                            12657071
126580                                                                  12658071
126590         WHEN SQLCODE = -904                                      12659071
126600         WHEN SQLCODE = -911                                      12660071
126610         WHEN SQLCODE = -913                                      12661071
126620             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   12662071
126630             MOVE '4220-FIND-ORIG-DWNLD-DRI' TO PV-SOFT-PARAGRAPH 12663071
126640             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 12664071
126650             MOVE LENGTH OF PV-CICS-MSG-AREA2                     12665071
126660               TO PV-COMMAREA-LENGTH                              12666071
126670             EXEC CICS                                            12667071
126680                  WRITEQ TD                                       12668071
126690                   QUEUE  ('CSSL')                                12669071
126700                    FROM  (PV-CICS-MSG-AREA2)                     12670071
126710                  LENGTH  (PV-COMMAREA-LENGTH)                    12671071
126720                    RESP  (PV-CICS-RESP)                          12672071
126730             END-EXEC                                             12673071
126740             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          12674071
126750             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              12675071
126760             PERFORM 9900-SOFT-ABORT                              12676071
126770         WHEN SQLWARN0 NOT = SPACES                               12677071
126780         WHEN SQLCODE  NOT = ZERO                                 12678071
126790             MOVE '4220-FIND-ORIG-DWNLD-DRIVER'                   12679071
126800                                 TO DP013-PARAGRAPH               12680071
126810             MOVE 'UNSUCCESSFUL SELECT OF TDISTHD'                12681071
126820                                 TO DP013-MESSAGE-TEXT (1)        12682071
126830             MOVE SQLCA         TO DP013-SQLCA                    12683071
126840             MOVE 'TDISTHD'     TO DP013-DB2-TABLE-NAME (1)       12684071
126850             SET DP013-DB2-ABEND                                  12685071
126860                 DP013-XCTL-DISPLAY-RESTART                       12686071
126870                                 TO TRUE                          12687071
126880                                                                  12688071
126890             PERFORM DP013-0000-PROCESS-ABEND                     12689071
126900     END-EVALUATE.                                                12690071
126910                                                                  12691071
126920                                                                  12692071
126930*----------------------------------------------------------------*12693071
126940 4250-CALL-XLKUT001.                                              12694071
126950                                                                  12695071
126960     INITIALIZE XL001-ITEM-COMMAREA.                              12696071
126970                                                                  12697071
126980     MOVE PURITM-ITM-NBR              TO XL001-KEY-ITM-NBR        12698071
126990                                                                  12699071
127000     SET  XL001-BY-ITEM                                           12700071
127010          XL001-SELECT-SKU                                        12701071
127020          XL001-SELECT-VND-STYL       TO TRUE                     12702071
127030                                                                  12703071
127040     CALL XL001-VSM-PGM USING  DFHEIBLK                           12704071
127050                               XL001-COMMAREA                     12705071
127060                               XL001-ITEM-COMMAREA.               12706071
127070     EVALUATE TRUE                                                12707071
127080         WHEN XL001-SUCCESSFUL                                    12708071
127090             MOVE XL001-SKU-NBR TO PV-SKU                         12709071
127100**XL001-OUTR-PACK-QTY                                             12710071
127110**XL001-MAJ-CL-NBR-2CH                                            12711071
127120**XL001-SUB-CL-NBR-2CH                                            12712071
127130         WHEN XL001-SQL-ERROR                                     12713071
127140              IF XL001-VND-STYL-CONTENTION OR                     12714071
127150                 XL001-SKU-CONTENTION                             12715071
127160                 MOVE XL001-SKU-SQLCODE TO PV-SOFT-SQLCODE        12716071
127170                 MOVE '4250-CALL-XLKUT001 ' TO PV-SOFT-PARAGRAPH  12717071
127180                 MOVE 'TABLE CONTENTION' TO PV-SOFT-MSG           12718071
127190                 MOVE PV-SOFT-ABORT-MSG  TO PV-CICS-MSG-AREA2     12719071
127200                 MOVE LENGTH OF PV-CICS-MSG-AREA2                 12720071
127210                                        TO PV-COMMAREA-LENGTH     12721071
127220                 EXEC CICS                                        12722071
127230                      WRITEQ TD                                   12723071
127240                       QUEUE  ('CSSL')                            12724071
127250                        FROM  (PV-CICS-MSG-AREA2)                 12725071
127260                      LENGTH  (PV-COMMAREA-LENGTH)                12726071
127270                        RESP  (PV-CICS-RESP)                      12727071
127280                 END-EXEC                                         12728071
127290                 MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER      12729071
127300                 SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE          12730071
127310                 PERFORM 9900-SOFT-ABORT                          12731071
127320              ELSE                                                12732071
127330                  IF XL001-VND-STYL-NOT-FOUND OR                  12733071
127340                     XL001-SKU-NOT-FOUND                          12734071
127350                    MOVE XL001-SKU-SQLCODE TO PV-SOFT-SQLCODE     12735071
127360                    MOVE '4250-CALL-XLKUT001'                     12736071
127370                                            TO PV-SOFT-PARAGRAPH  12737071
127380                    MOVE '  ITEM NOT FOUND  '  TO PV-SOFT-MSG     12738071
127390                    MOVE PV-SOFT-ABORT-MSG TO PV-CICS-MSG-AREA2   12739071
127400                    MOVE LENGTH OF PV-CICS-MSG-AREA2              12740071
127410                                        TO PV-COMMAREA-LENGTH     12741071
127420                    EXEC CICS                                     12742071
127430                         WRITEQ TD                                12743071
127440                          QUEUE  ('CSSL')                         12744071
127450                           FROM  (PV-CICS-MSG-AREA2)              12745071
127460                         LENGTH  (PV-COMMAREA-LENGTH)             12746071
127470                           RESP  (PV-CICS-RESP)                   12747071
127480                    END-EXEC                                      12748071
127490                  END-IF                                          12749071
127500              END-IF                                              12750071
127510                   MOVE SPACE           TO  PV-SOFT-MSG           12751071
127520                   INITIALIZE         PV-CICS-MSG-AREA2           12752071
127530                   MOVE ASC-PO-NBR       TO  PV-DSPLY-PO          12753071
127540                   MOVE ASC-REC-SEQ-NBR  TO  PV-DSPLY-RCVR        12754071
127550                  MOVE ASC-PO-LNE-NBR (ASC-BLK-SUB ASC-ITEM-SUB)  12755071
127560                                     TO  PV-DSPLY-LNE             12756071
127570                   MOVE PURITM-ITM-NBR                            12757071
127580                                     TO  PV-DISPLAY-ITEM-NBR      12758071
127590               STRING ' PCKCS701 -'            DELIMITED BY SIZE  12759071
127600                      ' PO/RCVR/LNE - '        DELIMITED BY SIZE  12760071
127610                      PV-DSPLY-PO              DELIMITED BY SIZE  12761071
127620                      '-'                      DELIMITED BY SIZE  12762071
127630                      PV-DSPLY-RCVR            DELIMITED BY SIZE  12763071
127640                      '-'                      DELIMITED BY SIZE  12764071
127650                      PV-DSPLY-LNE             DELIMITED BY SIZE  12765071
127660                      '   ITEM NUMBER - '      DELIMITED BY SIZE  12766071
127670                      PV-DISPLAY-ITEM-NBR      DELIMITED BY SIZE  12767071
127680                                           INTO PV-CICS-MSG-AREA  12768071
127690                MOVE LENGTH OF PV-CICS-MSG-AREA2                  12769071
127700                   TO PV-COMMAREA-LENGTH                          12770071
127710                 EXEC CICS                                        12771071
127720                      WRITEQ TD                                   12772071
127730                       QUEUE  ('CSSL')                            12773071
127740                        FROM  (PV-CICS-MSG-AREA2)                 12774071
127750                      LENGTH  (PV-COMMAREA-LENGTH)                12775071
127760                        RESP  (PV-CICS-RESP)                      12776071
127770                 END-EXEC                                         12777071
127780                                                                  12778071
127790         WHEN OTHER                                               12779071
127800                  MOVE XL001-SKU-SQLCODE TO PV-SOFT-SQLCODE       12780071
127810                  MOVE '4250-CALL-XLKUT001'                       12781071
127820                                          TO PV-SOFT-PARAGRAPH    12782071
127830                  MOVE ' INVALID ACCESS   '  TO PV-SOFT-MSG       12783071
127840                  MOVE PV-SOFT-ABORT-MSG TO PV-CICS-MSG-AREA2     12784071
127850                  MOVE LENGTH OF PV-CICS-MSG-AREA2                12785071
127860                                      TO PV-COMMAREA-LENGTH       12786071
127870                  EXEC CICS                                       12787071
127880                       WRITEQ TD                                  12788071
127890                        QUEUE  ('CSSL')                           12789071
127900                         FROM  (PV-CICS-MSG-AREA2)                12790071
127910                       LENGTH  (PV-COMMAREA-LENGTH)               12791071
127920                         RESP  (PV-CICS-RESP)                     12792071
127930                  END-EXEC                                        12793071
127940                                                                  12794071
127950                 MOVE SPACE           TO  PV-SOFT-MSG             12795071
127960                 INITIALIZE         PV-CICS-MSG-AREA2             12796071
127970                 MOVE ASC-PO-NBR       TO  PV-DSPLY-PO            12797071
127980                 MOVE ASC-REC-SEQ-NBR  TO  PV-DSPLY-RCVR          12798071
127990                MOVE ASC-PO-LNE-NBR (ASC-BLK-SUB ASC-ITEM-SUB)    12799071
128000                                   TO  PV-DSPLY-LNE               12800071
128010                 MOVE PURITM-ITM-NBR                              12801071
128020                                   TO  PV-DISPLAY-ITEM-NBR        12802071
128030             STRING ' PCKCS701 -'            DELIMITED BY SIZE    12803071
128040                    ' PO/RCVR/LNE - '        DELIMITED BY SIZE    12804071
128050                    PV-DSPLY-PO              DELIMITED BY SIZE    12805071
128060                    '-'                      DELIMITED BY SIZE    12806071
128070                    PV-DSPLY-RCVR            DELIMITED BY SIZE    12807071
128080                    '-'                      DELIMITED BY SIZE    12808071
128090                    PV-DSPLY-LNE             DELIMITED BY SIZE    12809071
128100                    '   ITEM NUMBER - '      DELIMITED BY SIZE    12810071
128110                    PV-DISPLAY-ITEM-NBR      DELIMITED BY SIZE    12811071
128120                                         INTO PV-CICS-MSG-AREA    12812071
128130              MOVE LENGTH OF PV-CICS-MSG-AREA2                    12813071
128140                 TO PV-COMMAREA-LENGTH                            12814071
128150               EXEC CICS                                          12815071
128160                    WRITEQ TD                                     12816071
128170                     QUEUE  ('CSSL')                              12817071
128180                      FROM  (PV-CICS-MSG-AREA2)                   12818071
128190                    LENGTH  (PV-COMMAREA-LENGTH)                  12819071
128200                      RESP  (PV-CICS-RESP)                        12820071
128210               END-EXEC                                           12821071
128220              MOVE '4250-CALL-XLKUT001'                           12822071
128230                               TO DP013-PARAGRAPH                 12823071
128240              MOVE 'CALL ITEM MODULE  '                           12824071
128250                               TO DP013-MESSAGE-TEXT (1)          12825071
128260              MOVE XL001-SQLCA TO DP013-SQLCA                     12826071
128270              SET DP013-DB2-ABEND                                 12827071
128280                  DP013-XCTL-DISPLAY-RESTART                      12828071
128290                                   TO TRUE                        12829071
128300                  PERFORM DP013-0000-PROCESS-ABEND                12830071
128310                                                                  12831071
128320     END-EVALUATE.                                                12832071
128330*----------------------------------------------------------------*12833071
128340                                                                  12834071
128350*----------------------------------------------------------------*12835071
128360*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *12836071
128370*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *12837071
128380*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *12838071
128390*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *12839071
128400*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *12840071
128410*                                                                *12841071
128420*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *12842071
128430*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *12843071
128440*    UPON INITIALIZATION.                                        *12844071
128450*----------------------------------------------------------------*12845071
128460 4300-READ-ITEMS-FROM-DB.                                         12846071
128470                                                                  12847071
128480     PERFORM                                                      12848071
128490         VARYING PV-READ-COUNT                                    12849071
128500         FROM 1 BY 1                                              12850071
128510         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    12851071
128520            OR (PS-NO-ITEMS-LEFT-ON-DB)                           12852071
128530            OR (PS-SOFT-ABORT-ERROR))                             12853071
128540                                                                  12854071
128550         PERFORM 4115-FETCH                                       12855071
128560         IF  PS-NO-SOFT-ABORT-ERROR                               12856071
128570           IF  PS-ITEMS-LEFT-ON-DB                                12857071
128580             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                12858071
128590                 ADD +1            TO ASC-ITEM-SUB                12859071
128600             ELSE                                                 12860071
128610                 ADD +1            TO ASC-BLK-SUB                 12861071
128620                 MOVE +1           TO ASC-ITEM-SUB                12862071
128630                                                                  12863071
128640                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         12864071
128650                     MOVE +1       TO ASC-BLK-SUB                 12865071
128660                     SET ASC-BLOCK-MODIFIED (1)                   12866071
128670                                   TO TRUE                        12867071
128680                     PERFORM 5100-WRITE-TEMP-STORAGE              12868071
128690                     MOVE ASC-BLOCK-ENTRIES                       12869071
128700                               (PC-MAX-BLOCKS-IN-ARRAY)           12870071
128710                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 12871071
128720                     ADD +1        TO ASC-BLK-SUB                 12872071
128730                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   12873071
128740                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      12874071
128750                                   TO TRUE                        12875071
128760                 END-IF                                           12876071
128770             END-IF                                               12877071
128780                                                                  12878071
128790             IF  ASC-UCC128-AVAIL-YES                             12879071
128800                 PERFORM 4303-UCC128-BY-LINE                      12880071
128810             ELSE                                                 12881071
128820                 SET  ASC-LNE-UCC128-NO                           12882071
128830                          (ASC-BLK-SUB ASC-ITEM-SUB)  TO TRUE     12883071
128840             END-IF                                               12884071
128850                                                                  12885071
128860             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    12886071
128870             MOVE ASC-NUMBER-OF-ITEMS-READ                        12887071
128880                                   TO ASC-LIST-ITEM-NUMBER        12888071
128890                                      (ASC-BLK-SUB ASC-ITEM-SUB)  12889071
128900                                                                  12890071
128910             SET  ASC-UPDATE-OK       (ASC-BLK-SUB ASC-ITEM-SUB)  12891071
128920                  ASC-NOT-PROTECTED   (ASC-BLK-SUB ASC-ITEM-SUB)  12892071
128930                                         TO TRUE                  12893071
128940                                                                  12894071
128950             MOVE SPACES                 TO  ASC-ACTION           12895071
128960                                       (ASC-BLK-SUB ASC-ITEM-SUB) 12896071
128970                                                                  12897071
128980             MOVE RECITM-ORD-LNE-NBR     TO  ASC-PO-LNE-NBR       12898071
128990                                       (ASC-BLK-SUB ASC-ITEM-SUB) 12899071
129000                                                                  12900071
129010             MOVE RECITM-INNR-PACK-QTY   TO  ASC-TBL-INPK-QTY     12901071
129020                                       (ASC-BLK-SUB ASC-ITEM-SUB) 12902071
129030             MOVE PURITM-ITM-NBR         TO  ASC-ITM-NBR          12903071
129040                                       (ASC-BLK-SUB ASC-ITEM-SUB) 12904071
129050             MOVE XL001-MAJ-CL-NBR-2CH   TO  ASC-CLASS            12905071
129060                                       (ASC-BLK-SUB ASC-ITEM-SUB) 12906071
129070             MOVE XL001-SUB-CL-NBR-2CH   TO  ASC-SUBCLASS         12907071
129080                                       (ASC-BLK-SUB ASC-ITEM-SUB) 12908071
129090                                                                  12909071
129100             MOVE PV-SKU                 TO  ASC-SKU              12910071
129110                                       (ASC-BLK-SUB ASC-ITEM-SUB) 12911071
129120                                                                  12912071
129130             IF  ASC-MODU-NBR  >  +0                              12913071
129140                 MOVE ASC-MODU-NBR       TO  ASC-MODULE           12914071
129150                                       (ASC-BLK-SUB ASC-ITEM-SUB) 12915071
129160                 PERFORM 3325-GET-P2L-SFWR-VNDR                   12916071
129170             ELSE                                                 12917071
129180                 MOVE ZEROES             TO  ASC-MODULE           12918071
129190                                       (ASC-BLK-SUB ASC-ITEM-SUB) 12919071
129200             END-IF                                               12920071
129210                                                                  12921071
129220* DISPLAY CARTON COUNT                                            12922071
129230                                                                  12923071
129240             IF  ASC-LNE-UCC128-YES (ASC-BLK-SUB ASC-ITEM-SUB) AND12924071
129250                 PV-UCC128-CRTN-CNT  >  0                         12925071
129260                 MOVE PV-UCC128-CRTN-CNT TO ASC-CARTON-COUNT      12926071
129270                                       (ASC-BLK-SUB ASC-ITEM-SUB) 12927071
129280             ELSE                                                 12928071
129290             IF  ASC-CART-CNT  >  +0                              12929071
129300                 MOVE ASC-CART-CNT       TO  ASC-CARTON-COUNT     12930071
129310                                       (ASC-BLK-SUB ASC-ITEM-SUB) 12931071
129320             ELSE                                                 12932071
129330                 MOVE ZEROES             TO  ASC-CARTON-COUNT     12933071
129340                                       (ASC-BLK-SUB ASC-ITEM-SUB) 12934071
129350             END-IF                                               12935071
129360             END-IF                                               12936071
129370                                                                  12937071
129380* DISPLAY INNER PACK                                              12938071
129390                                                                  12939071
129400             IF  ASC-INPK-UNT-QTY  >  +0                          12940071
129410                 MOVE ASC-INPK-UNT-QTY   TO  ASC-INNER-PACK-QTY   12941071
129420                                       (ASC-BLK-SUB ASC-ITEM-SUB) 12942071
129430             ELSE                                                 12943071
129440                 MOVE RECITM-INNR-PACK-QTY                        12944071
129450                                         TO  ASC-INNER-PACK-QTY   12945071
129460                                       (ASC-BLK-SUB ASC-ITEM-SUB) 12946071
129470             END-IF                                               12947071
129480                                                                  12948071
129490             IF  ASC-INNER-PACK-QTY (ASC-BLK-SUB ASC-ITEM-SUB) = 012949071
129500                 MOVE  1  TO  ASC-INNER-PACK-QTY                  12950071
129510                              (ASC-BLK-SUB ASC-ITEM-SUB)          12951071
129520             END-IF                                               12952071
129530                                                                  12953071
129540* DISPLAY OUTER PACK                                              12954071
129550                                                                  12955071
129560             IF  ASC-LNE-UCC128-YES (ASC-BLK-SUB ASC-ITEM-SUB)    12956071
129570                 IF  PV-UCC128-TOT-OTPK-QTYS  =  1                12957071
129580                     MOVE PV-UCC128-OTPK-QTY                      12958071
129590                                    TO ASC-OUTER-PACK-QTY         12959071
129600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 12960071
129610                 END-IF                                           12961071
129620             END-IF                                               12962071
129630             IF  ASC-OTPK-UNT-QTY  >  +0                          12963071
129640                 MOVE  ASC-OTPK-UNT-QTY  TO  ASC-OUTER-PACK-QTY   12964071
129650                                       (ASC-BLK-SUB ASC-ITEM-SUB) 12965071
129660                 SET PS-OUTER-PK-FROM-CRIT TO  TRUE               12966071
129670             ELSE                                                 12967071
129680             IF  ASC-PRE-PACK-ORDER                               12968071
129690                 COMPUTE ASC-OUTER-PACK-QTY                       12969071
129700                         (ASC-BLK-SUB ASC-ITEM-SUB)  =            12970071
129710                         RECITM-CASE-PACK-QTY  *                  12971071
129720                         RECITM-PREPK-RATO-QTY                    12972071
129730             ELSE                                                 12973071
129740                 IF RECITM-CASE-PACK-QTY = 0                      12974071
129750                    MOVE  +1  TO  ASC-OUTER-PACK-QTY              12975071
129760                                       (ASC-BLK-SUB ASC-ITEM-SUB) 12976071
129770                 ELSE                                             12977071
129780                    MOVE RECITM-CASE-PACK-QTY                     12978071
129790                                     TO ASC-OUTER-PACK-QTY        12979071
129800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 12980071
129810                 END-IF                                           12981071
129820                 SET PS-OUTER-PK-FROM-SKU TO TRUE                 12982071
129830             END-IF                                               12983071
129840             END-IF                                               12984071
129850                                                                  12985071
129860             IF  ASC-PRE-PACK-ORDER                               12986071
129870                 MOVE RECITM-PREPK-ID    TO  ASC-PREPK-ID         12987071
129880                                       (ASC-BLK-SUB ASC-ITEM-SUB) 12988071
129890                 MOVE RECITM-PREPK-RATO-QTY                       12989071
129900                                         TO  ASC-PREPK-RATIO      12990071
130000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 13000071
130010                                             ASC-INNER-PACK-QTY   13001071
130020                                       (ASC-BLK-SUB ASC-ITEM-SUB) 13002071
130030                 MOVE RECITM-CASE-PACK-QTY                        13003071
130040                                         TO  ASC-PACKS-IN-CRTN    13004071
130050                                       (ASC-BLK-SUB ASC-ITEM-SUB) 13005071
130060             ELSE                                                 13006071
130070                 MOVE ZEROES             TO  ASC-PREPK-ID         13007071
130080                                       (ASC-BLK-SUB ASC-ITEM-SUB) 13008071
130090                                             ASC-PREPK-RATIO      13009071
130100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 13010071
130110                                             ASC-PACKS-IN-CRTN    13011071
130120                                       (ASC-BLK-SUB ASC-ITEM-SUB) 13012071
130130             END-IF                                               13013071
130140                                                                  13014071
130150             EVALUATE TRUE                                        13015071
130160                 WHEN DP020-NEXT-ACT-INITIAL                      13016071
130170                 WHEN DP020-FK-REFRESH (DP020-SRC-AID)            13017071
130180                 WHEN PS-CRITERIA-CHANGE                          13018071
130190                      SET  ASC-IN-PAK-CONVEY-NO                   13019071
130200                      (ASC-BLK-SUB ASC-ITEM-SUB)  TO  TRUE        13020071
130210             END-EVALUATE                                         13021071
130220                                                                  13022071
130230             MOVE  SPACES                TO  PV-LINE-STATUS       13023071
130240             MOVE  ZEROES         TO  ASC-ODD-CARTON              13024071
130250                                       (ASC-BLK-SUB ASC-ITEM-SUB) 13025071
130260                                                                  13026071
130270             SET ASC-NOT-PPC-EXISTS (ASC-BLK-SUB ASC-ITEM-SUB)    13027071
130280                 ASC-NOT-HILITE-LNE-ST                            13028071
130290                                    (ASC-BLK-SUB ASC-ITEM-SUB)    13029071
130300                                     TO  TRUE                     13030071
130310             IF  PS-NO-SOFT-ABORT-ERROR                           13031071
130320                 MOVE PURITM-ITM-NBR   TO DK-ITEM-NBR             13032071
130330                 PERFORM 4370-DETERMINE-IF-PPC                    13033071
130340             END-IF                                               13034071
130350                                                                  13035071
130360             PERFORM 4315-GET-LINE-STATUS                         13036071
130370                                                                  13037071
130380             IF  PS-DISTHD-RECORD-FOUND                           13038071
130390                 IF  DISTHD-UCC128-DAT-USG-CDE = PC-U             13039071
130400                     SET  ASC-LNE-UCC128-YES                      13040071
130410                          (ASC-BLK-SUB ASC-ITEM-SUB)  TO  TRUE    13041071
130420                 ELSE                                             13042071
130430                 IF  DISTHD-UCC128-DAT-USG-CDE = PC-I             13043071
130440                     SET  ASC-LNE-UCC128-IGNORE                   13044071
130450                          (ASC-BLK-SUB ASC-ITEM-SUB)  TO  TRUE    13045071
130460                                                                  13046071
130470                 ELSE                                             13047071
130480                     IF  DISTHD-UCC128-DAT-USG-CDE = PC-N         13048071
130490                         SET  ASC-LNE-UCC128-NO                   13049071
130500                          (ASC-BLK-SUB ASC-ITEM-SUB)  TO  TRUE    13050071
130510                 END-IF                                           13051071
130520                                                                  13052071
130530                 END-IF                                           13053071
130540                 END-IF                                           13054071
130550                 IF  DISTHD-PRC-AREA-MODU-ID  =  SPACES  AND      13055071
130560                     DISTHD-TOT-CART-CNT      =  ZEROES  AND      13056071
130570                     DISTHD-P2L-CART-CNT      =  ZEROES  AND      13057071
130580                     DISTHD-FCSE-CART-CNT     =  ZEROES  AND      13058071
130590                     DISTHD-INPK-CART-CNT     =  ZEROES           13059071
130600                         MOVE  ASC-CRE-LBL-IND                    13060071
130610                                  TO  ASC-LNE-CRE-LBL-OPT         13061071
130620                                       (ASC-BLK-SUB ASC-ITEM-SUB) 13062071
130630                         MOVE  ASC-FCSE-AREA-ID                   13063071
130640                                  TO  ASC-LNE-FCSE-AREA           13064071
130650                                       (ASC-BLK-SUB ASC-ITEM-SUB) 13065071
130660                 ELSE                                             13066071
130670                 IF  DISTHD-CRE-LBL-OPT-CDE  >  SPACES            13067071
130680                     MOVE  DISTHD-CRE-LBL-OPT-CDE                 13068071
130690                                  TO  ASC-LNE-CRE-LBL-OPT         13069071
130700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 13070071
130710                 ELSE                                             13071071
130720                 IF  DISTHD-P2L-CART-CNT  =  ZEROES               13072071
130730                     SET  ASC-LNE-CRE-SML-LBL                     13073071
130740                         (ASC-BLK-SUB ASC-ITEM-SUB)  TO  TRUE     13074071
130750                 ELSE                                             13075071
130760                 IF  DISTHD-FCSE-CART-CNT  =  ZEROES  AND         13076071
130770                     DISTHD-INPK-CART-CNT  =  ZEROES              13077071
130780                     SET  ASC-LNE-CRE-P2L-LBL                     13078071
130790                         (ASC-BLK-SUB ASC-ITEM-SUB)  TO  TRUE     13079071
130800                 ELSE                                             13080071
130810                     SET  ASC-LNE-CRE-BOTH-LBL                    13081071
130820                         (ASC-BLK-SUB ASC-ITEM-SUB)  TO  TRUE     13082071
130830                 END-IF                                           13083071
130840                 END-IF                                           13084071
130850                 END-IF                                           13085071
130860                 MOVE  DISTHD-ODD-CART-UNT-QTY                    13086071
130870                                  TO  ASC-ODD-CARTON              13087071
130880                                       (ASC-BLK-SUB ASC-ITEM-SUB) 13088071
130890                 IF  DISTHD-ODD-CART-UNT-QTY  >  ZERO             13089071
130900                     MOVE  ZEROES  TO  PV-DISTDT-ODD-CNT-FCSE     13090071
130910                                       PV-DISTDT-ODD-CNT-INPK     13091071
130920                     PERFORM 4317-ODD-CART-USE                    13092071
130930                     IF  PV-DISTDT-ODD-CNT-FCSE > ZERO            13093071
130940                         SET ASC-ODD-CRTN-FCSE                    13094071
130950                             (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE   13095071
130960                     ELSE                                         13096071
130970                     IF  PV-DISTDT-ODD-CNT-INPK > ZERO            13097071
130980                         SET ASC-ODD-CRTN-INPK                    13098071
130990                             (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE   13099071
131000                     ELSE                                         13100071
131010                         SET ASC-ODD-CRTN-P2L                     13101071
131020                             (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE   13102071
131030                     END-IF                                       13103071
131040                     END-IF                                       13104071
131050                 ELSE                                             13105071
131060                 SET   ASC-ODD-CRTN-NONE                          13106071
131070                       (ASC-BLK-SUB ASC-ITEM-SUB)  TO TRUE        13107071
131080                 END-IF                                           13108071
131090                 MOVE  DISTHD-FCSE-FCLTY-AREA-ID                  13109071
131100                                  TO  ASC-LNE-FCSE-AREA           13110071
131110                                       (ASC-BLK-SUB ASC-ITEM-SUB) 13111071
131120                 END-IF                                           13112071
131130             ELSE                                                 13113071
131140                 MOVE  ZEROES     TO  ASC-ODD-CARTON              13114071
131150                                       (ASC-BLK-SUB ASC-ITEM-SUB) 13115071
131160                 SET   ASC-ODD-CRTN-NONE                          13116071
131170                       (ASC-BLK-SUB ASC-ITEM-SUB)  TO TRUE        13117071
131180                 MOVE  ASC-CRE-LBL-IND                            13118071
131190                                  TO  ASC-LNE-CRE-LBL-OPT         13119071
131200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 13120071
131210                 MOVE  ASC-FCSE-AREA-ID                           13121071
131220                                  TO  ASC-LNE-FCSE-AREA           13122071
131230                                       (ASC-BLK-SUB ASC-ITEM-SUB) 13123071
131240             END-IF                                               13124071
131250                                                                  13125071
131260             MOVE  PV-LINE-STATUS        TO ASC-LINE-STATUS       13126071
131270                                       (ASC-BLK-SUB ASC-ITEM-SUB) 13127071
131280                                                                  13128071
131290** LABEL TYPE                                                     13129071
131300             IF ASC-LNE-CRE-P2L-LBL     (ASC-BLK-SUB ASC-ITEM-SUB)13130071
131310                 IF  PS-DISTHD-RECORD-FOUND                       13131071
131320                     IF  DISTHD-PRC-AREA-MODU-ID  =  SPACES  AND  13132071
131330                         DISTHD-TOT-CART-CNT      =  ZEROES  AND  13133071
131340                         DISTHD-P2L-CART-CNT      =  ZEROES  AND  13134071
131350                         DISTHD-FCSE-CART-CNT     =  ZEROES  AND  13135071
131360                         DISTHD-INPK-CART-CNT     =  ZEROES       13136071
131370                         IF  ASC-LNE-UCC128-YES                   13137071
131380                             (ASC-BLK-SUB ASC-ITEM-SUB)  AND      13138071
131390                             ASC-UCC128-AVAIL-YES                 13139071
131400                             SET ASC-LBL-TYP-UCC128               13140071
131410                                 (ASC-BLK-SUB ASC-ITEM-SUB)       13141071
131420                                                   TO TRUE        13142071
131430                         ELSE                                     13143071
131440                         IF ASC-DO-NOT-PRINT-SML OR               13144071
131450                             ASC-DO-NOT-PRINT-PGYBK               13145071
131460                             SET ASC-LNE-DO-NOT-PRT-LBL           13146071
131470                                 (ASC-BLK-SUB ASC-ITEM-SUB)       13147071
131480                                                   TO TRUE        13148071
131490                         ELSE                                     13149071
131500                             SET ASC-LBL-TYP-NONE                 13150071
131510                                 (ASC-BLK-SUB ASC-ITEM-SUB)       13151071
131520                                                   TO TRUE        13152071
131530                         END-IF                                   13153071
131540                         END-IF                                   13154071
131550                     ELSE                                         13155071
131560                         MOVE  DISTHD-FCSE-LBL-TYP-CDE            13156071
131570                           TO  ASC-LBL-TYP                        13157071
131580                              (ASC-BLK-SUB ASC-ITEM-SUB)          13158071
131590                         IF  DISTHD-FCSE-LBL-TYP-CDE  =  SPACE    13159071
131600                             MOVE PC-N                            13160071
131610                               TO ASC-LBL-TYP                     13161071
131620                                  (ASC-BLK-SUB ASC-ITEM-SUB)      13162071
131630                         END-IF                                   13163071
131640                     END-IF                                       13164071
131650                                                                  13165071
131660                 ELSE                                             13166071
131670                     IF  ASC-LNE-UCC128-YES                       13167071
131680                         (ASC-BLK-SUB ASC-ITEM-SUB)  AND          13168071
131690                         ASC-UCC128-AVAIL-YES                     13169071
131700                         SET ASC-LBL-TYP-UCC128                   13170071
131710                             (ASC-BLK-SUB ASC-ITEM-SUB)           13171071
131720                                                   TO TRUE        13172071
131730                     ELSE                                         13173071
131740                     IF ASC-DO-NOT-PRINT-SML OR                   13174071
131750                         ASC-DO-NOT-PRINT-PGYBK                   13175071
131760                         SET ASC-LNE-DO-NOT-PRT-LBL               13176071
131770                             (ASC-BLK-SUB ASC-ITEM-SUB)           13177071
131780                                               TO TRUE            13178071
131790                     ELSE                                         13179071
131800                         SET ASC-LBL-TYP-NONE                     13180071
131810                             (ASC-BLK-SUB ASC-ITEM-SUB)           13181071
131820                                               TO TRUE            13182071
131830                     END-IF                                       13183071
131840                     END-IF                                       13184071
131850                 END-IF                                           13185071
131860                                                                  13186071
131870                SET ASC-IN-PAK-CONVEY-NO(ASC-BLK-SUB ASC-ITEM-SUB)13187071
131880                                       TO TRUE                    13188071
131890             END-IF                                               13189071
131900             IF  ASC-LNE-CRE-BOTH-LBL(ASC-BLK-SUB ASC-ITEM-SUB) OR13190071
131910                 ASC-LNE-CRE-SML-LBL (ASC-BLK-SUB ASC-ITEM-SUB)   13191071
131920                 IF  PS-DISTHD-RECORD-FOUND                       13192071
131930                     IF  DISTHD-PRC-AREA-MODU-ID  =  SPACES  AND  13193071
131940                         DISTHD-TOT-CART-CNT      =  ZEROES  AND  13194071
131950                         DISTHD-P2L-CART-CNT      =  ZEROES  AND  13195071
131960                         DISTHD-FCSE-CART-CNT     =  ZEROES  AND  13196071
131970                         DISTHD-INPK-CART-CNT     =  ZEROES       13197071
131980                         IF  ASC-LNE-UCC128-YES                   13198071
131990                             (ASC-BLK-SUB ASC-ITEM-SUB)  AND      13199071
132000                             ASC-UCC128-AVAIL-YES                 13200071
132010                             SET ASC-LBL-TYP-UCC128               13201071
132020                                 (ASC-BLK-SUB ASC-ITEM-SUB)       13202071
132030                                 ASC-CRE-LBL-UPDT                 13203071
132040                                 (ASC-BLK-SUB ASC-ITEM-SUB)       13204071
132050                                                   TO TRUE        13205071
132060                         ELSE                                     13206071
132070                         IF  ASC-DO-NOT-PRINT-SML  OR             13207071
132080                             ASC-DO-NOT-PRINT-PGYBK               13208071
132090                             SET  ASC-LNE-DO-NOT-PRT-LBL          13209071
132100                                  (ASC-BLK-SUB ASC-ITEM-SUB)      13210071
132110                                  ASC-CRE-LBL-UPDT                13211071
132120                                  (ASC-BLK-SUB ASC-ITEM-SUB)      13212071
132130                                                   TO TRUE        13213071
132140                         ELSE                                     13214071
132150                         IF  ASC-PGYBCK-PRTR-ID  >  SPACES  AND   13215071
132160                             ASC-LBL-PRT-STR-ORD                  13216071
132170                             SET  ASC-LBL-TYP-PGYBK               13217071
132180                                  (ASC-BLK-SUB ASC-ITEM-SUB)      13218071
132190                                  ASC-CRE-LBL-UPDT                13219071
132200                                  (ASC-BLK-SUB ASC-ITEM-SUB)      13220071
132210                                                   TO TRUE        13221071
132220                         ELSE                                     13222071
132230                             SET  ASC-LBL-TYP-SML                 13223071
132240                                  (ASC-BLK-SUB ASC-ITEM-SUB)      13224071
132250                                  ASC-CRE-LBL-UPDT                13225071
132260                                  (ASC-BLK-SUB ASC-ITEM-SUB)      13226071
132270                                                   TO TRUE        13227071
132280                         END-IF                                   13228071
132290                         END-IF                                   13229071
132300                         END-IF                                   13230071
132310                     ELSE                                         13231071
132320                         MOVE  DISTHD-FCSE-LBL-TYP-CDE            13232071
132330                           TO  ASC-LBL-TYP                        13233071
132340                              (ASC-BLK-SUB ASC-ITEM-SUB)          13234071
132350                     END-IF                                       13235071
132360                 ELSE                                             13236071
132370                     IF  ASC-LNE-UCC128-YES                       13237071
132380                         (ASC-BLK-SUB ASC-ITEM-SUB)  AND          13238071
132390                         ASC-UCC128-AVAIL-YES                     13239071
132400                         SET ASC-LBL-TYP-UCC128                   13240071
132410                             (ASC-BLK-SUB ASC-ITEM-SUB)           13241071
132420                             ASC-CRE-LBL-UPDT                     13242071
132430                             (ASC-BLK-SUB ASC-ITEM-SUB)           13243071
132440                                                   TO TRUE        13244071
132450                     ELSE                                         13245071
132460                     IF  ASC-DO-NOT-PRINT-SML  OR                 13246071
132470                         ASC-DO-NOT-PRINT-PGYBK                   13247071
132480                         SET  ASC-LNE-DO-NOT-PRT-LBL              13248071
132490                             (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE   13249071
132500                     ELSE                                         13250071
132510                     IF  ASC-PGYBCK-PRTR-ID  >  SPACES  AND       13251071
132520                         ASC-LBL-PRT-STR-ORD                      13252071
132530                         SET  ASC-LBL-TYP-PGYBK                   13253071
132540                             (ASC-BLK-SUB ASC-ITEM-SUB)           13254071
132550                              ASC-CRE-LBL-UPDT                    13255071
132560                              (ASC-BLK-SUB ASC-ITEM-SUB)          13256071
132570                                               TO TRUE            13257071
132580                     ELSE                                         13258071
132590                         SET  ASC-LBL-TYP-SML                     13259071
132600                              (ASC-BLK-SUB ASC-ITEM-SUB)          13260071
132610                              ASC-CRE-LBL-UPDT                    13261071
132620                              (ASC-BLK-SUB ASC-ITEM-SUB)          13262071
132630                                               TO TRUE            13263071
132640                     END-IF                                       13264071
132650                     END-IF                                       13265071
132660                     END-IF                                       13266071
132670                 END-IF                                           13267071
132680             END-IF                                               13268071
132690                                                                  13269071
132700             IF  PS-NO-SOFT-ABORT-ERROR                           13270071
132710                 PERFORM 4310-GET-TRANSCRIBE                      13271071
132720             END-IF                                               13272071
132730             IF  RECITM-STATUS-CDE  = 'VE'                        13273071
132740                 MOVE  PV-VERIFIED-SUM   TO  ASC-TRANSCRIBE-QTY   13274071
132750                                       (ASC-BLK-SUB ASC-ITEM-SUB) 13275071
132760             ELSE                                                 13276071
132770                 MOVE  PV-TRANSCRIBE-SUM TO  ASC-TRANSCRIBE-QTY   13277071
132780                                       (ASC-BLK-SUB ASC-ITEM-SUB) 13278071
132790             END-IF                                               13279071
132800                                                                  13280071
132810             MOVE  PV-TRANSCRIBE-SUM    TO  ASC-EXPTD-ITM-QTY     13281071
132820                                       (ASC-BLK-SUB ASC-ITEM-SUB) 13282071
132830             IF  ASC-LNE-CRE-P2L-LBL (ASC-BLK-SUB ASC-ITEM-SUB) OR13283071
132840                 ASC-PROTECTED (ASC-BLK-SUB ASC-ITEM-SUB)         13284071
132850                 CONTINUE                                         13285071
132860             ELSE                                                 13286071
132870             IF  ASC-TRANSCRIBE-QTY                               13287071
132880                 (ASC-BLK-SUB ASC-ITEM-SUB) > +0  AND             13288071
132890                 ASC-OUTER-PACK-QTY                               13289071
132900                 (ASC-BLK-SUB ASC-ITEM-SUB) > +0  AND             13290071
132910                 ASC-CARTON-COUNT                                 13291071
132920                 (ASC-BLK-SUB ASC-ITEM-SUB) = +0                  13292071
132930                 PERFORM 4312-CALC-CARTON-CNT                     13293071
132940             END-IF                                               13294071
132950             END-IF                                               13295071
132960                                                                  13296071
132970             IF  ASC-LNE-UCC128-YES                               13297071
132980                     (ASC-BLK-SUB ASC-ITEM-SUB)                   13298071
132990                 MOVE PV-UCC128-TOT-UNTS   TO  PV-PROCESS-QTY     13299071
133000                 IF  PS-DISTHD-RECORD-FOUND                       13300071
133010                     IF  DISTHD-FCSE-CART-CNT  =  ZEROES  AND     13301071
133020                         DISTHD-INPK-CART-CNT  =  ZEROES  AND     13302071
133030                         DISTHD-P2L-CART-CNT   >  ZEROES  AND     13303071
133040                         DISTHD-P2L-CART-CNT   =                  13304071
133050                                         DISTHD-TOT-CART-CNT      13305071
133060                         MOVE  PV-PROCESS-QTY TO ASC-PROCESS-QTY  13306071
133070                                       (ASC-BLK-SUB ASC-ITEM-SUB) 13307071
133080                                                                  13308071
133090                     ELSE                                         13309071
133100                     IF  DISTHD-FCSE-CART-CNT  =  ZEROES  AND     13310071
133110                         DISTHD-INPK-CART-CNT  =  ZEROES  AND     13311071
133120                         DISTHD-P2L-CART-CNT   =  ZEROES          13312071
133130                         MOVE  PV-PROCESS-QTY TO ASC-PROCESS-QTY  13313071
133140                                       (ASC-BLK-SUB ASC-ITEM-SUB) 13314071
133150                     ELSE                                         13315071
133160                         MOVE DISTHD-CAL-UNT-PRCD-QTY             13316071
133170                                           TO  PV-PROCESS-QTY     13317071
133180                         MOVE  PV-PROCESS-QTY TO ASC-PROCESS-QTY  13318071
133190                                       (ASC-BLK-SUB ASC-ITEM-SUB) 13319071
133200                     END-IF                                       13320071
133210                     END-IF                                       13321071
133220                 ELSE                                             13322071
133230                     MOVE  PV-PROCESS-QTY  TO  ASC-PROCESS-QTY    13323071
133240                                       (ASC-BLK-SUB ASC-ITEM-SUB) 13324071
133250                 END-IF                                           13325071
133260             ELSE                                                 13326071
133270             IF  ASC-CARTON-COUNT (ASC-BLK-SUB ASC-ITEM-SUB)      13327071
133280                                            > +0  AND             13328071
133290                 ASC-OUTER-PACK-QTY (ASC-BLK-SUB ASC-ITEM-SUB)    13329071
133300                                            > +0                  13330071
133310                     MULTIPLY  ASC-CARTON-COUNT                   13331071
133320                              (ASC-BLK-SUB ASC-ITEM-SUB)          13332071
133330                           BY  ASC-OUTER-PACK-QTY                 13333071
133340                              (ASC-BLK-SUB ASC-ITEM-SUB)          13334071
133350                       GIVING  PV-PROCESS-QTY                     13335071
133360                                                                  13336071
133370             IF  ASC-ODD-CARTON                                   13337071
133380                 (ASC-BLK-SUB ASC-ITEM-SUB) > +0 AND              13338071
133390                 ASC-CARTON-COUNT                                 13339071
133400                 (ASC-BLK-SUB ASC-ITEM-SUB) > +0 AND              13340071
133410                 ASC-OUTER-PACK-QTY                               13341071
133420                 (ASC-BLK-SUB ASC-ITEM-SUB) > +0                  13342071
133430                 SUBTRACT 1 FROM ASC-CARTON-COUNT                 13343071
133440                                    (ASC-BLK-SUB ASC-ITEM-SUB)    13344071
133450                              GIVING PV-CARTON-COUNT-LESS-ODD     13345071
133460                 MULTIPLY PV-CARTON-COUNT-LESS-ODD                13346071
133470                       BY ASC-OUTER-PACK-QTY                      13347071
133480                           (ASC-BLK-SUB ASC-ITEM-SUB)             13348071
133490                   GIVING PV-PROCESS-QTY                          13349071
133500                  ADD ASC-ODD-CARTON (ASC-BLK-SUB ASC-ITEM-SUB)   13350071
133510                                          TO PV-PROCESS-QTY       13351071
133520             END-IF                                               13352071
133530                                                                  13353071
133540                 IF  PS-DISTHD-RECORD-FOUND           AND         13354071
133550                     DISTHD-FCSE-CART-CNT  =  ZEROES  AND         13355071
133560                     DISTHD-INPK-CART-CNT  =  ZEROES  AND         13356071
133570                     DISTHD-P2L-CART-CNT   >  ZEROES  AND         13357071
133580                     DISTHD-P2L-CART-CNT = DISTHD-TOT-CART-CNT    13358071
133590                     MOVE  ZEROES  TO  PV-PROCESS-QTY             13359071
133600                 END-IF                                           13360071
133610                 MOVE  PV-PROCESS-QTY    TO  ASC-PROCESS-QTY      13361071
133620                                       (ASC-BLK-SUB ASC-ITEM-SUB) 13362071
133630             ELSE                                                 13363071
133640             IF  ASC-CART-CNT      >  +0  AND                     13364071
133650                 ASC-OTPK-UNT-QTY  >  +0  AND                     13365071
133660                 (ASC-LNE-UCC128-NO (ASC-BLK-SUB ASC-ITEM-SUB) OR 13366071
133670                  ASC-LNE-UCC128-IGNORE(ASC-BLK-SUB ASC-ITEM-SUB))13367071
133680                 MULTIPLY  ASC-CART-CNT  BY  ASC-OTPK-UNT-QTY     13368071
133690                   GIVING  PV-PROCESS-QTY                         13369071
133700                 MOVE  PV-PROCESS-QTY    TO  ASC-PROCESS-QTY      13370071
133710                                       (ASC-BLK-SUB ASC-ITEM-SUB) 13371071
133720             ELSE                                                 13372071
133730             IF  ASC-LNE-UCC128-YES (ASC-BLK-SUB ASC-ITEM-SUB)    13373071
133740                 MOVE  PV-PROCESS-QTY    TO  ASC-PROCESS-QTY      13374071
133750                                       (ASC-BLK-SUB ASC-ITEM-SUB) 13375071
133760             ELSE                                                 13376071
133770                 MOVE  ZEROES            TO  ASC-PROCESS-QTY      13377071
133780                                       (ASC-BLK-SUB ASC-ITEM-SUB) 13378071
133790             END-IF                                               13379071
133800             END-IF                                               13380071
133810             END-IF                                               13381071
133820             END-IF                                               13382071
133830                                                                  13383071
133840             IF  PV-PROCESS-QTY  =  +0  AND                       13384071
133850                 ASC-CARTON-COUNT                                 13385071
133860                 (ASC-BLK-SUB ASC-ITEM-SUB) >  +0                 13386071
133870                 IF  DISTHD-FCSE-CART-CNT  =  ZEROES  AND         13387071
133880                     DISTHD-INPK-CART-CNT  =  ZEROES  AND         13388071
133890                     DISTHD-P2L-CART-CNT   >  ZEROES  AND         13389071
133900                     DISTHD-P2L-CART-CNT = DISTHD-TOT-CART-CNT    13390071
134000                     CONTINUE                                     13400071
134010                 ELSE                                             13401071
134020                     MOVE  PV-TRANSCRIBE-SUM TO  ASC-PROCESS-QTY  13402071
134030                                       (ASC-BLK-SUB ASC-ITEM-SUB) 13403071
134040                 END-IF                                           13404071
134050             END-IF                                               13405071
134060                                                                  13406071
134070             IF ASC-CARTON-COUNT (ASC-BLK-SUB ASC-ITEM-SUB) > +0  13407071
134080                  AND                                             13408071
134090                ASC-LNE-UCC128-YES (ASC-BLK-SUB ASC-ITEM-SUB)     13409071
134100               IF ((ASC-PROCESS-QTY (ASC-BLK-SUB ASC-ITEM-SUB)    13410071
134110                   NOT EQUAL                                      13411071
134120                  ASC-TRANSCRIBE-QTY (ASC-BLK-SUB ASC-ITEM-SUB))  13412071
134130                                                 OR               13413071
134140                  (ASC-LNE-UCC128-CRTN-MLT-LNES                   13414071
134150                     (ASC-BLK-SUB ASC-ITEM-SUB)) OR               13415071
134160                  (ASC-LNE-DC-RTV-OTPK (ASC-BLK-SUB ASC-ITEM-SUB))13416071
134170                                                 OR               13417071
134180                  (ASC-LNE-BAD-INPK-Y (ASC-BLK-SUB ASC-ITEM-SUB)) 13418071
134190                                                 OR               13419071
134200                  (ASC-LNE-BAD-OTPK-Y (ASC-BLK-SUB ASC-ITEM-SUB)))13420071
134210                       SET ASC-UCC128-USABLE-NO                   13421071
134220                            (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE    13422071
134230               END-IF                                             13423071
134240             END-IF                                               13424071
134250                                                                  13425071
134260             IF  ASC-CARTON-COUNT                                 13426071
134270                 (ASC-BLK-SUB ASC-ITEM-SUB) >  +0                 13427071
134280                 IF  ASC-PROCESS-QTY (ASC-BLK-SUB ASC-ITEM-SUB) = 13428071
134290                     ASC-TRANSCRIBE-QTY(ASC-BLK-SUB ASC-ITEM-SUB) 13429071
134300                     OR DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)    13430071
134400                     OR DP020-FK-LOCAL-FUNC-09 (DP020-SRC-AID)    13440071
134410                     OR DP020-FK-LOCAL-FUNC-10 (DP020-SRC-AID)    13441071
134420                         CONTINUE                                 13442071
134430                 ELSE                                             13443071
134440                 IF  ASC-LNE-CRE-P2L-LBL(ASC-BLK-SUB ASC-ITEM-SUB)13444071
134450                         CONTINUE                                 13445071
134460                 ELSE                                             13446071
134470                         SET ASC-QTY-ERROR-YES                    13447071
134480                             (ASC-BLK-SUB ASC-ITEM-SUB)           13448071
134490                          TO TRUE                                 13449071
134500                 END-IF                                           13450071
134510                 END-IF                                           13451071
134520                                                                  13452071
134530                 IF  ASC-OUTER-PACK-QTY(ASC-BLK-SUB ASC-ITEM-SUB) 13453071
134540                                       =  ZEROES    AND           13454071
134550                     ASC-CARTON-COUNT(ASC-BLK-SUB ASC-ITEM-SUB)   13455071
134560                                       =  ZEROES                  13456071
134570                     MOVE  ZEROES     TO  ASC-P2L-LABEL-CNT       13457071
134580                                       (ASC-BLK-SUB ASC-ITEM-SUB) 13458071
134590                                                                  13459071
134600                     MOVE  ZEROES     TO  ASC-SML-LABEL-CNT       13460071
134610                                       (ASC-BLK-SUB ASC-ITEM-SUB) 13461071
134620                 ELSE                                             13462071
134630                     SET ASC-VALID-INPK-YES                       13463071
134640                         ASC-VALID-OTPK-YES  TO TRUE              13464071
134650                     MOVE  ZEROES  TO  PV-SHIP-LNE-CNT            13465071
134660                                       PV-P2L-LNE-CNT             13466071
134670                     IF  ASC-NO-LINE-ERROR                        13467071
134680                             (ASC-BLK-SUB ASC-ITEM-SUB)           13468071
134690                         IF  (ASC-SML-LABEL-CNT                   13469071
134700                                  (ASC-BLK-SUB ASC-ITEM-SUB)      13470071
134710                              >  ZEROES     OR                    13471071
134720                              ASC-P2L-LABEL-CNT                   13472071
134730                                  (ASC-BLK-SUB ASC-ITEM-SUB)      13473071
134740                              >  ZEROES)                          13474071
134750                             CONTINUE                             13475071
134760                         ELSE                                     13476071
134770                           IF  ASC-LNE-UCC128-YES                 13477071
134780                               (ASC-BLK-SUB ASC-ITEM-SUB)         13478071
134790                               PERFORM 7300-UCC128-LBL-CNT        13479071
134800                           ELSE                                   13480071
134810                               PERFORM 4345-GET-LABEL-COUNT       13481071
134820                           END-IF                                 13482071
134830                             IF  ASC-INVALID-INPK-YES             13483071
134840                                 SET ASC-LNE-BAD-INPK-Y           13484071
134850                                     (ASC-BLK-SUB ASC-ITEM-SUB)   13485071
134860                                  TO TRUE                         13486071
134870                             END-IF                               13487071
134880                             IF  ASC-INVALID-OTPK-YES             13488071
134890                                 SET ASC-LNE-BAD-OTPK-Y           13489071
134900                                     (ASC-BLK-SUB ASC-ITEM-SUB)   13490071
134910                                  TO TRUE                         13491071
134920                             END-IF                               13492071
134930                             IF  ASC-INVALID-OTPK-ODD             13493071
134940                                 SET ASC-LNE-BAD-ODD-Y            13494071
134950                                     (ASC-BLK-SUB ASC-ITEM-SUB)   13495071
134960                                  TO TRUE                         13496071
134970                             END-IF                               13497071
134980                             IF  ASC-VALID-INPK-YES  AND          13498071
134990                                 ASC-VALID-OTPK-YES               13499071
135000                                 MOVE  PV-SHIP-LNE-TOTAL          13500071
135010                                   TO  ASC-SML-LABEL-CNT          13501071
135020                                       (ASC-BLK-SUB ASC-ITEM-SUB) 13502071
135030                                 MOVE  PV-P2L-LNE-TOTAL           13503071
135040                                   TO  ASC-P2L-LABEL-CNT          13504071
135050                                       (ASC-BLK-SUB ASC-ITEM-SUB) 13505071
135060                             END-IF                               13506071
135070                         END-IF                                   13507071
135080                     ELSE                                         13508071
135090                                                                  13509071
135100                     IF  ASC-PRE-PACK-ORDER  AND                  13510071
135110                         ASC-LNE-UCC128-YES                       13511071
135120                               (ASC-BLK-SUB ASC-ITEM-SUB)         13512071
135130                         PERFORM 7300-UCC128-LBL-CNT              13513071
135140                     END-IF                                       13514071
135150                     END-IF                                       13515071
135160                 END-IF                                           13516071
135170             END-IF                                               13517071
135180           IF  ASC-PRE-PACK-ORDER                                 13518071
135190               IF ASC-NO-LINE-ERROR (ASC-BLK-SUB ASC-ITEM-SUB)    13519071
135200                  MOVE ASC-PO-NBR       TO  DK-PO-NBR             13520071
135210                  MOVE ASC-REC-SEQ-NBR  TO  DK-REC-SEQ-NBR        13521071
135220                  MOVE ASC-PREPK-ID (ASC-BLK-SUB ASC-ITEM-SUB)    13522071
135230                                        TO  DK-PREPK-ID           13523071
135240                  PERFORM 8200-CHECK-FOR-CNTL-STK                 13524071
135250                  IF  PV-PREPK-CNTL-STK-COUNT  > 0                13525071
135260                      SET  ASC-PREPK-CNTL-STK                     13526071
135270                           (ASC-BLK-SUB ASC-ITEM-SUB)             13527071
135280                                        TO  TRUE                  13528071
135290                      MOVE 'CSTK'       TO  ASC-LINE-STATUS       13529071
135300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 13530071
135310                  ELSE                                            13531071
135320                  PERFORM 8205-CHECK-FOR-E-COMM                   13532071
135330                  END-IF                                          13533071
135340               END-IF                                             13534071
135350             END-IF                                               13535071
135360                                                                  13536071
135370           IF  ASC-HAZ-FACILITY-YES                               13537071
135380               PERFORM 8230-CHECK-IF-ITEM-HAZMAT                  13538071
135390           ELSE                                                   13539071
135400               MOVE SPACES        TO ASC-HAZ-CODE                 13540071
135410                                    (ASC-BLK-SUB ASC-ITEM-SUB)    13541071
135420           END-IF                                                 13542071
135430                                                                  13543071
135431           END-IF                                                 13543171
135432         END-IF                                                   13543271
135433     END-PERFORM.                                                 13543371
135434                                                                  13543471
135435     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          13543571
135436         MOVE +1               TO ASC-BLK-SUB                     13543671
135437         PERFORM 5100-WRITE-TEMP-STORAGE                          13543771
135438         ADD +1                TO ASC-BLK-SUB                     13543871
135439         PERFORM 5100-WRITE-TEMP-STORAGE                          13543971
135440                                                                  13544071
135450         MOVE 1                TO ASC-BLK-SUB                     13545071
135460                                  PV-BLOCK-NUMBER                 13546071
135470         PERFORM 4410-READ-TEMP-STORAGE                           13547071
135480         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             13548071
135490             MOVE 2            TO ASC-BLK-SUB                     13549071
135500                                  PV-BLOCK-NUMBER                 13550071
135510             PERFORM 4410-READ-TEMP-STORAGE                       13551071
135520         END-IF                                                   13552071
135530     END-IF.                                                      13553071
135540                                                                  13554071
135550                                                                  13555071
135560*----------------------------------------------------------------*13556071
135570*  CHECK TO SEE IF THERE IS UCC128 DATA AVAILABLE FOR LINE       *13557071
135580*----------------------------------------------------------------*13558071
135590 4303-UCC128-BY-LINE.                                             13559071
135600                                                                  13560071
135610     MOVE  ASC-PO-NBR                   TO  DK-PO-NBR.            13561071
135620     MOVE  ASC-REC-SEQ-NBR              TO  DK-REC-SEQ-NBR.       13562071
135630     MOVE  RECITM-ORD-LNE-NBR           TO  DK-LINE-NBR.          13563071
135640                                                                  13564071
135650     EXEC SQL                                                     13565071
135660         SELECT COUNT(DISTINCT C.SHIPT_UNT_ID)                    13566071
135670           INTO :PV-UCC128-CRTN-CNT                               13567071
135680           FROM TPKSLIP A                                         13568071
135690               ,TINPKSU B                                         13569071
135700               ,TSHUUPC C                                         13570071
135710          WHERE A.PO_NBR        = :DK-PO-NBR                      13571071
135720            AND A.REC_SEQ_NBR   = :DK-REC-SEQ-NBR                 13572071
135730            AND A.VER_STAT_CDE  = 'A'                             13573071
135740            AND A.PKSL_STAT_CDE = 'AC'                            13574071
135750            AND B.PO_NBR        = A.PO_NBR                        13575071
135760            AND B.SEQ_NBR       = A.SEQ_NBR                       13576071
135770            AND C.SHIPT_UNT_ID  = B.SHIPT_UNT_ID                  13577071
135780            AND C.TRN_NBR       = A.PO_NBR                        13578071
135790            AND C.TRN_LNE_NBR   = :DK-LINE-NBR                    13579071
135800     END-EXEC.                                                    13580071
135810                                                                  13581071
135820     EVALUATE TRUE                                                13582071
135830         WHEN SQLCODE = +0                                        13583071
135840              IF  PV-UCC128-CRTN-CNT  >  0                        13584071
135850                  PERFORM 4303B-UCC128-BY-LINE                    13585071
135860                  IF  ASC-UCC128-AVAIL-YES  AND                   13586071
135870                      ASC-USE-UCC128-YES                          13587071
135880                      SET  ASC-LNE-UCC128-YES                     13588071
135890                           (ASC-BLK-SUB ASC-ITEM-SUB)  TO  TRUE   13589071
135900                                                                  13590071
135910                      IF  ASC-PRE-PACK-ORDER                      13591071
135920                          CONTINUE                                13592071
135930                      ELSE                                        13593071
135940                                                                  13594071
135950                          PERFORM 4307-CHECK-CRTN-MLT-LNES        13595071
135960                          IF  PV-UCC128-LINES-PER-CRTN  >  1      13596071
135970                              SET ASC-LNE-UCC128-CRTN-MLT-LNES    13597071
135980                                  (ASC-BLK-SUB ASC-ITEM-SUB)      13598071
135990                                  ASC-UCC128-MLT-LNE-YES          13599071
136000                                                       TO  TRUE   13600071
136010                          END-IF                                  13601071
136020                      END-IF                                      13602071
136030                  ELSE                                            13603071
136040                  IF  ASC-UCC128-AVAIL-YES  AND                   13604071
136050                      ASC-USE-UCC128-IGNORE                       13605071
136060                      SET  ASC-LNE-UCC128-IGNORE                  13606071
136070                           (ASC-BLK-SUB ASC-ITEM-SUB)  TO  TRUE   13607071
136080                  END-IF                                          13608071
136090                  END-IF                                          13609071
136100                  IF  PV-UCC128-CRTN-CNT  >  0 AND                13610071
136110                      LQW-LNE-UCC128-YES (LQW-IDX)                13611071
136120                      IF  ((LQW-PROCESS-QTY (LQW-IDX) NOT =       13612071
136130                            LQW-TRANSCRIB-QTY (LQW-IDX))  OR      13613071
136140                       (LQW-LNE-UCC128-CRTN-MLT-LNES (LQW-IDX)) OR13614071
136150                       (LQW-LNE-DC-RTV-OTPK (LQW-IDX)) OR         13615071
136160                       (LQW-LNE-BAD-INPK-Y (LQW-IDX)) OR          13616071
136170                       (LQW-LNE-BAD-OTPK-Y (LQW-IDX)))            13617071
136180                          SET LQW-UCC128-USABLE-NO (LQW-IDX)      13618071
136190                                        TO TRUE                   13619071
136200                      END-IF                                      13620071
136210                  END-IF                                          13621071
136220              ELSE                                                13622071
136230                  CONTINUE                                        13623071
136240              END-IF                                              13624071
136250         WHEN SQLCODE = -305                                      13625071
136260                 SET  ASC-LNE-UCC128-NO                           13626071
136270                          (ASC-BLK-SUB ASC-ITEM-SUB)  TO TRUE     13627071
136280         WHEN SQLCODE = -904                                      13628071
136290         WHEN SQLCODE = -911                                      13629071
136300         WHEN SQLCODE = -913                                      13630071
136310             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    13631071
136320             MOVE '4303-UCC128-BY-LINE  '   TO PV-SOFT-PARAGRAPH  13632071
136330             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  13633071
136340             MOVE LENGTH OF PV-CICS-MSG-AREA2                     13634071
136350               TO PV-COMMAREA-LENGTH                              13635071
136360             EXEC CICS                                            13636071
136370                  WRITEQ TD                                       13637071
136380                   QUEUE  ('CSSL')                                13638071
136390                    FROM  (PV-CICS-MSG-AREA2)                     13639071
136400                  LENGTH  (PV-COMMAREA-LENGTH)                    13640071
136410                    RESP  (PV-CICS-RESP)                          13641071
136420             END-EXEC                                             13642071
136430             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          13643071
136440             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              13644071
136450             PERFORM 9900-SOFT-ABORT                              13645071
136460         WHEN SQLWARN0 NOT = SPACES                               13646071
136470         WHEN SQLCODE < ZERO                                      13647071
136480         WHEN SQLCODE > ZERO                                      13648071
136490             MOVE '4303-UCC128-BY-LINE  '                         13649071
136500                               TO DP013-PARAGRAPH                 13650071
136510             MOVE DK-PO-NBR      TO  PV-DSPLY-PO                  13651071
136520             MOVE DK-REC-SEQ-NBR TO  PV-DSPLY-RCVR                13652071
136530             MOVE DK-LINE-NBR    TO  PV-DSPLY-LNE                 13653071
136540             STRING  ' PO/RCVR/LNE - ' DELIMITED BY SIZE          13654071
136550                     PV-DSPLY-PO       DELIMITED BY SIZE          13655071
136560                     '-'               DELIMITED BY SIZE          13656071
136570                     PV-DSPLY-RCVR     DELIMITED BY SIZE          13657071
136580                     '-'               DELIMITED BY SIZE          13658071
136590                     PV-DSPLY-LNE      DELIMITED BY SIZE          13659071
136600                             INTO DP013-MESSAGE-TEXT (1)          13660071
136610             MOVE 'CHECK IF UCC128 DATA AVAIL BY LINE'            13661071
136620                               TO DP013-MESSAGE-TEXT (2)          13662071
136630             MOVE SQLCA        TO DP013-SQLCA                     13663071
136640             MOVE 'TPKSLIP'    TO DP013-DB2-TABLE-NAME (1)        13664071
136650             MOVE 'TINPKSU'    TO DP013-DB2-TABLE-NAME (2)        13665071
136660             MOVE 'TSHUUPC'    TO DP013-DB2-TABLE-NAME (3)        13666071
136670             SET DP013-DB2-ABEND                                  13667071
136680                 DP013-XCTL-DISPLAY-RESTART                       13668071
136690                               TO TRUE                            13669071
136700             PERFORM DP013-0000-PROCESS-ABEND                     13670071
136710     END-EVALUATE.                                                13671071
136720                                                                  13672071
136730                                                                  13673071
136740 4303B-UCC128-BY-LINE.                                            13674071
136750                                                                  13675071
136760     EXEC SQL                                                     13676071
136770         SELECT SUM(C.SHPD_QTY)                                   13677071
136780               ,COUNT(DISTINCT C.SHPD_QTY)                        13678071
136790           INTO :PV-UCC128-TOT-UNTS                               13679071
136800               ,:PV-UCC128-TOT-OTPK-QTYS                          13680071
136810           FROM TPKSLIP A                                         13681071
136820               ,TINPKSU B                                         13682071
136830               ,TSHUUPC C                                         13683071
136840          WHERE A.PO_NBR        = :DK-PO-NBR                      13684071
136850            AND A.REC_SEQ_NBR   = :DK-REC-SEQ-NBR                 13685071
136860            AND A.VER_STAT_CDE  = 'A'                             13686071
136870            AND A.PKSL_STAT_CDE = 'AC'                            13687071
136880            AND B.PO_NBR        = A.PO_NBR                        13688071
136890            AND B.SEQ_NBR       = A.SEQ_NBR                       13689071
136900            AND C.SHIPT_UNT_ID  = B.SHIPT_UNT_ID                  13690071
136910            AND C.TRN_NBR       = A.PO_NBR                        13691071
136920            AND C.TRN_LNE_NBR   = :DK-LINE-NBR                    13692071
136930     END-EXEC.                                                    13693071
136940                                                                  13694071
136950     EVALUATE TRUE                                                13695071
136960         WHEN SQLCODE = +0                                        13696071
136970              CONTINUE                                            13697071
136980         WHEN SQLCODE = -305                                      13698071
136990                 SET  ASC-LNE-UCC128-NO                           13699071
137000                          (ASC-BLK-SUB ASC-ITEM-SUB)  TO TRUE     13700071
137010         WHEN SQLCODE = -904                                      13701071
137020         WHEN SQLCODE = -911                                      13702071
137030         WHEN SQLCODE = -913                                      13703071
137040             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    13704071
137050             MOVE '4303B-UCC128-BY-LINE '   TO PV-SOFT-PARAGRAPH  13705071
137060             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  13706071
137070             MOVE LENGTH OF PV-CICS-MSG-AREA2                     13707071
137080               TO PV-COMMAREA-LENGTH                              13708071
137090             EXEC CICS                                            13709071
137100                  WRITEQ TD                                       13710071
137110                   QUEUE  ('CSSL')                                13711071
137120                    FROM  (PV-CICS-MSG-AREA2)                     13712071
137130                  LENGTH  (PV-COMMAREA-LENGTH)                    13713071
137140                    RESP  (PV-CICS-RESP)                          13714071
137150             END-EXEC                                             13715071
137160             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          13716071
137170             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              13717071
137180             PERFORM 9900-SOFT-ABORT                              13718071
137190         WHEN SQLWARN0 NOT = SPACES                               13719071
137200         WHEN SQLCODE < ZERO                                      13720071
137210         WHEN SQLCODE > ZERO                                      13721071
137220             MOVE '4303B-UCC128-BY-LINE '                         13722071
137230                               TO DP013-PARAGRAPH                 13723071
137240             MOVE DK-PO-NBR      TO  PV-DSPLY-PO                  13724071
137250             MOVE DK-REC-SEQ-NBR TO  PV-DSPLY-RCVR                13725071
137260             MOVE DK-LINE-NBR    TO  PV-DSPLY-LNE                 13726071
137270             STRING  ' PO/RCVR/LNE - ' DELIMITED BY SIZE          13727071
137280                     PV-DSPLY-PO       DELIMITED BY SIZE          13728071
137290                     '-'               DELIMITED BY SIZE          13729071
137300                     PV-DSPLY-RCVR     DELIMITED BY SIZE          13730071
137310                     '-'               DELIMITED BY SIZE          13731071
137320                     PV-DSPLY-LNE      DELIMITED BY SIZE          13732071
137330                             INTO DP013-MESSAGE-TEXT (1)          13733071
137340             MOVE 'CHECK IF UCC128 DATA AVAIL BY LINE'            13734071
137350                               TO DP013-MESSAGE-TEXT (2)          13735071
137360             MOVE SQLCA        TO DP013-SQLCA                     13736071
137370             MOVE 'TPKSLIP'    TO DP013-DB2-TABLE-NAME (1)        13737071
137380             MOVE 'TINPKSU'    TO DP013-DB2-TABLE-NAME (2)        13738071
137390             MOVE 'TSHUUPC'    TO DP013-DB2-TABLE-NAME (3)        13739071
137400             SET DP013-DB2-ABEND                                  13740071
137410                 DP013-XCTL-DISPLAY-RESTART                       13741071
137420                               TO TRUE                            13742071
137430             PERFORM DP013-0000-PROCESS-ABEND                     13743071
137440     END-EVALUATE.                                                13744071
137450                                                                  13745071
137460                                                                  13746071
137470*----------------------------------------------------------------*13747071
137480*  CHECK TO SEE IF THERE IS UCC128 DATA AVAILABLE FOR LINE       *13748071
137490*  LQW AREA - AFTER DELETE                                       *13749071
137500*----------------------------------------------------------------*13750071
137510 4303-UCC128-BY-LINE-LQW.                                         13751071
137520                                                                  13752071
137530     MOVE  ASC-PO-NBR                   TO  DK-PO-NBR.            13753071
137540     MOVE  ASC-REC-SEQ-NBR              TO  DK-REC-SEQ-NBR.       13754071
137550     MOVE  LQW-PO-RCVR-LINE (LQW-IDX)   TO  DK-LINE-NBR.          13755071
137560                                                                  13756071
137570     EXEC SQL                                                     13757071
137580         SELECT COUNT(DISTINCT C.SHIPT_UNT_ID)                    13758071
137590           INTO :PV-UCC128-CRTN-CNT                               13759071
137600           FROM TPKSLIP A                                         13760071
137610               ,TINPKSU B                                         13761071
137620               ,TSHUUPC C                                         13762071
137630          WHERE A.PO_NBR        = :DK-PO-NBR                      13763071
137640            AND A.REC_SEQ_NBR   = :DK-REC-SEQ-NBR                 13764071
137650            AND A.VER_STAT_CDE  = 'A'                             13765071
137660            AND A.PKSL_STAT_CDE = 'AC'                            13766071
137670            AND B.PO_NBR        = A.PO_NBR                        13767071
137680            AND B.SEQ_NBR       = A.SEQ_NBR                       13768071
137690            AND C.SHIPT_UNT_ID  = B.SHIPT_UNT_ID                  13769071
137700            AND C.TRN_NBR       = A.PO_NBR                        13770071
137710            AND C.TRN_LNE_NBR   = :DK-LINE-NBR                    13771071
137720     END-EXEC.                                                    13772071
137730                                                                  13773071
137740     EVALUATE TRUE                                                13774071
137750         WHEN SQLCODE = +0                                        13775071
137760              IF  PV-UCC128-CRTN-CNT  >  0                        13776071
137770                  PERFORM 4303B-UCC128-BY-LINE-LQW                13777071
137780                  IF  ASC-UCC128-AVAIL-YES  AND                   13778071
137790                      ASC-USE-UCC128-YES                          13779071
137800                      SET  LQW-LNE-UCC128-YES (LQW-IDX) TO TRUE   13780071
137810                                                                  13781071
137820                      IF  ASC-PRE-PACK-ORDER                      13782071
137830                          CONTINUE                                13783071
137840                      ELSE                                        13784071
137850                                                                  13785071
137860                          PERFORM 4307-CHECK-CRTN-MLT-LNES        13786071
137870                          IF  PV-UCC128-LINES-PER-CRTN  >  1      13787071
137880                              SET LQW-LNE-UCC128-CRTN-MLT-LNES    13788071
137890                                  (LQW-IDX)                       13789071
137900                              ASC-UCC128-MLT-LNE-YES              13790071
137910                                                       TO  TRUE   13791071
137920                          END-IF                                  13792071
137930                      END-IF                                      13793071
137940                  ELSE                                            13794071
137950                  IF  ASC-UCC128-AVAIL-YES  AND                   13795071
137960                      ASC-USE-UCC128-IGNORE                       13796071
137970                      SET  LQW-LNE-UCC128-IGNORE                  13797071
137980                           (LQW-IDX)                   TO  TRUE   13798071
137990                  END-IF                                          13799071
138000                  END-IF                                          13800071
138010                                                                  13801071
138020              ELSE                                                13802071
138030                  CONTINUE                                        13803071
138040              END-IF                                              13804071
138050         WHEN SQLCODE = -305                                      13805071
138060                 SET  LQW-LNE-UCC128-NO (LQW-IDX)  TO  TRUE       13806071
138070         WHEN SQLCODE = -904                                      13807071
138080         WHEN SQLCODE = -911                                      13808071
138090         WHEN SQLCODE = -913                                      13809071
138100             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    13810071
138110             MOVE '4303-UCC128-BY-LINE-LQW' TO PV-SOFT-PARAGRAPH  13811071
138120             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  13812071
138130             MOVE LENGTH OF PV-CICS-MSG-AREA2                     13813071
138140               TO PV-COMMAREA-LENGTH                              13814071
138150             EXEC CICS                                            13815071
138160                  WRITEQ TD                                       13816071
138170                   QUEUE  ('CSSL')                                13817071
138180                    FROM  (PV-CICS-MSG-AREA2)                     13818071
138190                  LENGTH  (PV-COMMAREA-LENGTH)                    13819071
138200                    RESP  (PV-CICS-RESP)                          13820071
138210             END-EXEC                                             13821071
138220             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          13822071
138230             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              13823071
138240             PERFORM 9900-SOFT-ABORT                              13824071
138250         WHEN SQLWARN0 NOT = SPACES                               13825071
138260         WHEN SQLCODE < ZERO                                      13826071
138270         WHEN SQLCODE > ZERO                                      13827071
138280             MOVE '4303-UCC128-BY-LINE-LQW'                       13828071
138290                               TO DP013-PARAGRAPH                 13829071
138300             MOVE DK-PO-NBR      TO  PV-DSPLY-PO                  13830071
138310             MOVE DK-REC-SEQ-NBR TO  PV-DSPLY-RCVR                13831071
138320             MOVE DK-LINE-NBR    TO  PV-DSPLY-LNE                 13832071
138330             STRING  ' PO/RCVR/LNE - ' DELIMITED BY SIZE          13833071
138340                     PV-DSPLY-PO       DELIMITED BY SIZE          13834071
138350                     '-'               DELIMITED BY SIZE          13835071
138360                     PV-DSPLY-RCVR     DELIMITED BY SIZE          13836071
138370                     '-'               DELIMITED BY SIZE          13837071
138380                     PV-DSPLY-LNE      DELIMITED BY SIZE          13838071
138390                             INTO DP013-MESSAGE-TEXT (1)          13839071
138400             MOVE 'CHECK IF UCC128 DATA AVAIL BY LINE'            13840071
138410                               TO DP013-MESSAGE-TEXT (2)          13841071
138420             MOVE SQLCA        TO DP013-SQLCA                     13842071
138430             MOVE 'TPKSLIP'    TO DP013-DB2-TABLE-NAME (1)        13843071
138440             MOVE 'TINPKSU'    TO DP013-DB2-TABLE-NAME (2)        13844071
138450             MOVE 'TSHUUPC'    TO DP013-DB2-TABLE-NAME (3)        13845071
138460             SET DP013-DB2-ABEND                                  13846071
138470                 DP013-XCTL-DISPLAY-RESTART                       13847071
138480                               TO TRUE                            13848071
138490             PERFORM DP013-0000-PROCESS-ABEND                     13849071
138500     END-EVALUATE.                                                13850071
138510                                                                  13851071
138520                                                                  13852071
138530 4303B-UCC128-BY-LINE-LQW.                                        13853071
138540                                                                  13854071
138550     EXEC SQL                                                     13855071
138560         SELECT SUM(C.SHPD_QTY)                                   13856071
138570               ,COUNT(DISTINCT C.SHPD_QTY)                        13857071
138580           INTO :PV-UCC128-TOT-UNTS                               13858071
138590               ,:PV-UCC128-TOT-OTPK-QTYS                          13859071
138600           FROM TPKSLIP A                                         13860071
138610               ,TINPKSU B                                         13861071
138620               ,TSHUUPC C                                         13862071
138630          WHERE A.PO_NBR        = :DK-PO-NBR                      13863071
138640            AND A.REC_SEQ_NBR   = :DK-REC-SEQ-NBR                 13864071
138650            AND A.VER_STAT_CDE  = 'A'                             13865071
138660            AND A.PKSL_STAT_CDE = 'AC'                            13866071
138670            AND B.PO_NBR        = A.PO_NBR                        13867071
138680            AND B.SEQ_NBR       = A.SEQ_NBR                       13868071
138690            AND C.SHIPT_UNT_ID  = B.SHIPT_UNT_ID                  13869071
138700            AND C.TRN_NBR       = A.PO_NBR                        13870071
138710            AND C.TRN_LNE_NBR   = :DK-LINE-NBR                    13871071
138720     END-EXEC.                                                    13872071
138730                                                                  13873071
138740     EVALUATE TRUE                                                13874071
138750         WHEN SQLCODE = +0                                        13875071
138760              CONTINUE                                            13876071
138770         WHEN SQLCODE = -305                                      13877071
138780                 SET  LQW-LNE-UCC128-NO (LQW-IDX)  TO  TRUE       13878071
138790         WHEN SQLCODE = -904                                      13879071
138800         WHEN SQLCODE = -911                                      13880071
138810         WHEN SQLCODE = -913                                      13881071
138820             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   13882071
138830             MOVE '4303B-UCC128-BY-LINE-LQW' TO PV-SOFT-PARAGRAPH 13883071
138840             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 13884071
138850             MOVE LENGTH OF PV-CICS-MSG-AREA2                     13885071
138860               TO PV-COMMAREA-LENGTH                              13886071
138870             EXEC CICS                                            13887071
138880                  WRITEQ TD                                       13888071
138890                   QUEUE  ('CSSL')                                13889071
138900                    FROM  (PV-CICS-MSG-AREA2)                     13890071
138910                  LENGTH  (PV-COMMAREA-LENGTH)                    13891071
138920                    RESP  (PV-CICS-RESP)                          13892071
138930             END-EXEC                                             13893071
138940             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          13894071
138950             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              13895071
138960             PERFORM 9900-SOFT-ABORT                              13896071
138970         WHEN SQLWARN0 NOT = SPACES                               13897071
138980         WHEN SQLCODE < ZERO                                      13898071
138990         WHEN SQLCODE > ZERO                                      13899071
139000             MOVE '4303B-UCC128-BY-LINE-LQW'                      13900071
139010                               TO DP013-PARAGRAPH                 13901071
139020             MOVE DK-PO-NBR      TO  PV-DSPLY-PO                  13902071
139030             MOVE DK-REC-SEQ-NBR TO  PV-DSPLY-RCVR                13903071
139040             MOVE DK-LINE-NBR    TO  PV-DSPLY-LNE                 13904071
139050             STRING  ' PO/RCVR/LNE - ' DELIMITED BY SIZE          13905071
139060                     PV-DSPLY-PO       DELIMITED BY SIZE          13906071
139070                     '-'               DELIMITED BY SIZE          13907071
139080                     PV-DSPLY-RCVR     DELIMITED BY SIZE          13908071
139090                     '-'               DELIMITED BY SIZE          13909071
139100                     PV-DSPLY-LNE      DELIMITED BY SIZE          13910071
139110                             INTO DP013-MESSAGE-TEXT (1)          13911071
139120             MOVE 'CHECK IF UCC128 DATA AVAIL BY LINE'            13912071
139130                               TO DP013-MESSAGE-TEXT (2)          13913071
139140             MOVE SQLCA        TO DP013-SQLCA                     13914071
139150             MOVE 'TPKSLIP'    TO DP013-DB2-TABLE-NAME (1)        13915071
139160             MOVE 'TINPKSU'    TO DP013-DB2-TABLE-NAME (2)        13916071
139170             MOVE 'TSHUUPC'    TO DP013-DB2-TABLE-NAME (3)        13917071
139180             SET DP013-DB2-ABEND                                  13918071
139190                 DP013-XCTL-DISPLAY-RESTART                       13919071
139200                               TO TRUE                            13920071
139210             PERFORM DP013-0000-PROCESS-ABEND                     13921071
139220     END-EVALUATE.                                                13922071
139230                                                                  13923071
139240*----------------------------------------------------------------*13924071
139250* CHECK TO SEE IF THERE IS UCC128 DATA FOR THE PO/RCVR ENTERED   *13925071
139260*----------------------------------------------------------------*13926071
139270 4304-CHECK-UCC128-DATA.                                          13927071
139280                                                                  13928071
139290     MOVE ZEROES  TO  PV-PKSLIP-PO-NBR.                           13929071
139300                                                                  13930071
139400     EXEC SQL                                                     13940071
139410          SELECT  A.PO_NBR                                        13941071
139420            INTO  :PV-PKSLIP-PO-NBR                               13942071
139421            FROM  TPKSLIP A                                       13942171
139422                 ,TINPKSU B                                       13942271
139423                 ,TSHUUPC C                                       13942371
139424           WHERE  A.PO_NBR         = :ASC-PO-NBR                  13942471
139425             AND  A.REC_SEQ_NBR    = :ASC-REC-SEQ-NBR             13942571
139426             AND  A.VER_STAT_CDE   = 'A'                          13942671
139427             AND  A.PKSL_STAT_CDE  = 'AC'                         13942771
139428             AND  B.PO_NBR         = A.PO_NBR                     13942871
139429             AND  B.SEQ_NBR        = A.SEQ_NBR                    13942971
139430             AND  C.SHIPT_UNT_ID   = B.SHIPT_UNT_ID               13943071
139440             AND  C.TRN_NBR        = B.PO_NBR                     13944071
139450             AND  C.TRN_LNE_NBR    > 0                            13945071
139460             AND  C.SHPD_QTY       > 0                            13946071
139470          FETCH FIRST 1 ROW ONLY                                  13947071
139480     END-EXEC.                                                    13948071
139490                                                                  13949071
139500     EVALUATE TRUE                                                13950071
139510         WHEN SQLCODE = ZERO                                      13951071
139520              IF  PV-PKSLIP-PO-NBR >  0                           13952071
139530                  SET  ASC-UCC128-AVAIL-YES                       13953071
139540                       ASC-USE-UCC128-YES   TO TRUE               13954071
139550              ELSE                                                13955071
139560                  SET  ASC-UCC128-AVAIL-NO                        13956071
139570                       ASC-USE-UCC128-NO    TO TRUE               13957071
139580              END-IF                                              13958071
139590         WHEN SQLCODE = +100                                      13959071
139600              SET  ASC-UCC128-AVAIL-NO                            13960071
139610                   ASC-USE-UCC128-NO    TO TRUE                   13961071
139620         WHEN SQLWARN0 NOT = SPACES                               13962071
139630         WHEN SQLCODE < ZERO                                      13963071
139640         WHEN SQLCODE > ZERO                                      13964071
139650              MOVE '4304-CHECK-UCC128-DATA  '                     13965071
139660                              TO DP013-PARAGRAPH                  13966071
139670              MOVE 'CHECK TO SEE IF THERE IS UCC128 DATA'         13967071
139680                              TO DP013-MESSAGE-TEXT (1)           13968071
139690              MOVE SQLCA      TO DP013-SQLCA                      13969071
139700              MOVE 'TPKSLIP ' TO DP013-DB2-TABLE-NAME (1)         13970071
139710              MOVE 'TINPKSU ' TO DP013-DB2-TABLE-NAME (1)         13971071
139720              MOVE 'TSHUUPC ' TO DP013-DB2-TABLE-NAME (1)         13972071
139730              SET DP013-DB2-ABEND                                 13973071
139740                  DP013-XCTL-DISPLAY-RESTART  TO  TRUE            13974071
139750          PERFORM DP013-0000-PROCESS-ABEND                        13975071
139760     END-EVALUATE.                                                13976071
139770                                                                  13977071
139780                                                                  13978071
139790                                                                  13979071
139800*----------------------------------------------------------------*13980071
139810* CHECK IF LINE HAS A CARTON THAT IS FOR MULTIPLE LINES          *13981071
139820*----------------------------------------------------------------*13982071
139830                                                                  13983071
139840 4307-CHECK-CRTN-MLT-LNES.                                        13984071
139850                                                                  13985071
139860     EXEC SQL                                                     13986071
139870          SELECT COUNT(DISTINCT D.TRN_LNE_NBR)                    13987071
139880            INTO :PV-UCC128-LINES-PER-CRTN                        13988071
139890            FROM TPKSLIP A                                        13989071
139900                ,TINPKSU B                                        13990071
139910                ,TSHUUPC C                                        13991071
139920                ,TSHUUPC D                                        13992071
139930           WHERE A.PO_NBR        = :DK-PO-NBR                     13993071
139940             AND A.REC_SEQ_NBR   = :DK-REC-SEQ-NBR                13994071
139950             AND A.VER_STAT_CDE  = 'A'                            13995071
139960             AND A.PKSL_STAT_CDE = 'AC'                           13996071
139970             AND B.PO_NBR        = A.PO_NBR                       13997071
139980             AND B.SEQ_NBR       = A.SEQ_NBR                      13998071
139990             AND C.SHIPT_UNT_ID  = B.SHIPT_UNT_ID                 13999071
140000             AND C.TRN_NBR       = B.PO_NBR                       14000071
140010             AND C.TRN_LNE_NBR   = :DK-LINE-NBR                   14001071
140020             AND D.SHIPT_UNT_ID  = C.SHIPT_UNT_ID                 14002071
140030             AND D.TRN_NBR       = B.PO_NBR                       14003071
140040     END-EXEC.                                                    14004071
140050                                                                  14005071
140060     EVALUATE TRUE                                                14006071
140070         WHEN SQLCODE = +0                                        14007071
140080             CONTINUE                                             14008071
140090         WHEN SQLCODE = -904                                      14009071
140100         WHEN SQLCODE = -911                                      14010071
140110         WHEN SQLCODE = -913                                      14011071
140120             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   14012071
140130             MOVE '4307-CHECK-CRTN-MLT-LNES' TO PV-SOFT-PARAGRAPH 14013071
140140             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 14014071
140150             MOVE LENGTH OF PV-CICS-MSG-AREA2                     14015071
140160               TO PV-COMMAREA-LENGTH                              14016071
140170             EXEC CICS                                            14017071
140180                  WRITEQ TD                                       14018071
140190                   QUEUE  ('CSSL')                                14019071
140200                    FROM  (PV-CICS-MSG-AREA2)                     14020071
140210                  LENGTH  (PV-COMMAREA-LENGTH)                    14021071
140220                    RESP  (PV-CICS-RESP)                          14022071
140230             END-EXEC                                             14023071
140240             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          14024071
140250             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              14025071
140260             PERFORM 9900-SOFT-ABORT                              14026071
140270         WHEN SQLWARN0 NOT = SPACES                               14027071
140280         WHEN SQLCODE < ZERO                                      14028071
140290         WHEN SQLCODE > ZERO                                      14029071
140300             MOVE '4307-CHECK-CRTN-MLT-LNES'                      14030071
140310                               TO DP013-PARAGRAPH                 14031071
140320             MOVE DK-PO-NBR      TO  PV-DSPLY-PO                  14032071
140330             MOVE DK-REC-SEQ-NBR TO  PV-DSPLY-RCVR                14033071
140340             MOVE DK-LINE-NBR    TO  PV-DSPLY-LNE                 14034071
140350             STRING  ' PO/RCVR/LNE - ' DELIMITED BY SIZE          14035071
140360                     PV-DSPLY-PO       DELIMITED BY SIZE          14036071
140370                     '-'               DELIMITED BY SIZE          14037071
140380                     PV-DSPLY-RCVR     DELIMITED BY SIZE          14038071
140390                     '-'               DELIMITED BY SIZE          14039071
140400                     PV-DSPLY-LNE      DELIMITED BY SIZE          14040071
140410                             INTO DP013-MESSAGE-TEXT (1)          14041071
140420             MOVE 'CHECK IF CARTON FOR MLT LINES     '            14042071
140430                               TO DP013-MESSAGE-TEXT (2)          14043071
140440             MOVE SQLCA        TO DP013-SQLCA                     14044071
140450             MOVE 'TPKSLIP'    TO DP013-DB2-TABLE-NAME (1)        14045071
140460             MOVE 'TINPKSU'    TO DP013-DB2-TABLE-NAME (2)        14046071
140470             MOVE 'TSHUUPC'    TO DP013-DB2-TABLE-NAME (3)        14047071
140480             SET DP013-DB2-ABEND                                  14048071
140490                 DP013-XCTL-DISPLAY-RESTART                       14049071
140500                               TO TRUE                            14050071
140510             PERFORM DP013-0000-PROCESS-ABEND                     14051071
140520     END-EVALUATE.                                                14052071
140530                                                                  14053071
140540                                                                  14054071
140550                                                                  14055071
140560*----------------------------------------------------------------*14056071
140570*    GET TRANSCRIBED QUANTITY                                    *14057071
140580*----------------------------------------------------------------*14058071
140590 4310-GET-TRANSCRIBE.                                             14059071
140600     EXEC SQL                                                     14060071
140610        SELECT  SUM(EXPTED_ITM_QTY)                               14061071
140620               ,SUM(AP_VERIFY_ITM_QTY)                            14062071
140630          INTO :PV-TRANSCRIBE-SUM                                 14063071
140640               ,:PV-VERIFIED-SUM                                  14064071
140650          FROM  TRECDIS                                           14065071
140660      WHERE ORD_NBR        = :ASC-PO-NBR                          14066071
140670        AND REC_SEQ_NBR    = :ASC-REC-SEQ-NBR                     14067071
140680        AND ORD_LNE_NBR    = :RECITM-ORD-LNE-NBR                  14068071
140690     END-EXEC.                                                    14069071
140700                                                                  14070071
140710     EVALUATE TRUE                                                14071071
140720         WHEN SQLCODE = +0                                        14072071
140730             CONTINUE                                             14073071
140740                                                                  14074071
140750         WHEN SQLCODE = +100                                      14075071
140760         WHEN SQLCODE = -305                                      14076071
140770             MOVE ZEROES TO PV-TRANSCRIBE-SUM                     14077071
140780         WHEN SQLCODE = -904                                      14078071
140790         WHEN SQLCODE = -911                                      14079071
140800         WHEN SQLCODE = -913                                      14080071
140810                                                                  14081071
140820             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   14082071
140830             MOVE '4310-GET-TRANSCRIBE'      TO PV-SOFT-PARAGRAPH 14083071
140840             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 14084071
140850             MOVE LENGTH OF PV-CICS-MSG-AREA2                     14085071
140860               TO PV-COMMAREA-LENGTH                              14086071
140870             EXEC CICS                                            14087071
140880                  WRITEQ TD                                       14088071
140890                   QUEUE  ('CSSL')                                14089071
140900                    FROM  (PV-CICS-MSG-AREA2)                     14090071
140910                  LENGTH  (PV-COMMAREA-LENGTH)                    14091071
140920                    RESP  (PV-CICS-RESP)                          14092071
140930             END-EXEC                                             14093071
140940                                                                  14094071
140950             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          14095071
140960             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              14096071
140970             PERFORM 9900-SOFT-ABORT                              14097071
140980         WHEN SQLWARN0 NOT = SPACE                                14098071
140990         WHEN SQLCODE < +0                                        14099071
141000         WHEN SQLCODE > +0                                        14100071
141010             MOVE '4310-GET-TRANSCRIBE'                           14101071
141020                             TO DP013-PARAGRAPH                   14102071
141030             MOVE 'SELECT ON TRECDIS'                             14103071
141040                             TO DP013-MESSAGE-TEXT (1)            14104071
141050             MOVE SQLCA      TO DP013-SQLCA                       14105071
141060             MOVE 'TRECDIS'  TO DP013-DB2-TABLE-NAME (1)          14106071
141070             SET DP013-DB2-ABEND                                  14107071
141080                             TO TRUE                              14108071
141090             SET DP013-XCTL-DISPLAY-RESTART                       14109071
141100                             TO TRUE                              14110071
141110             PERFORM DP013-0000-PROCESS-ABEND                     14111071
141120     END-EVALUATE.                                                14112071
141130                                                                  14113071
141140                                                                  14114071
141150*----------------------------------------------------------------*14115071
141160* CALCULATE NUMBER OF CARTONS                                    *14116071
141170*----------------------------------------------------------------*14117071
141180 4312-CALC-CARTON-CNT.                                            14118071
141190     MOVE  ZEROES  TO  PV-CARTON-COUNT-CALC                       14119071
141200                       PV-CARTON-COUNT-REM.                       14120071
141210                                                                  14121071
141220     IF  ASC-OUTER-PACK-QTY (ASC-BLK-SUB ASC-ITEM-SUB) > 1        14122071
141230         DIVIDE  ASC-TRANSCRIBE-QTY (ASC-BLK-SUB ASC-ITEM-SUB)    14123071
141240             BY  ASC-OUTER-PACK-QTY (ASC-BLK-SUB ASC-ITEM-SUB)    14124071
141250         GIVING  PV-CARTON-COUNT-CALC                             14125071
141260                 REMAINDER PV-CARTON-COUNT-REM                    14126071
141270         END-DIVIDE                                               14127071
141280                                                                  14128071
141290         IF  PV-CARTON-COUNT-REM  >  +0                           14129071
141300             CONTINUE                                             14130071
141310         ELSE                                                     14131071
141320             MOVE PV-CARTON-COUNT-CALC                            14132071
141330               TO ASC-CARTON-COUNT (ASC-BLK-SUB ASC-ITEM-SUB)     14133071
141340         END-IF                                                   14134071
141350                                                                  14135071
141360     ELSE                                                         14136071
141370                                                                  14137071
141380     IF  ASC-OUTER-PACK-QTY (ASC-BLK-SUB ASC-ITEM-SUB) = 1  AND   14138071
141390         PS-OUTER-PK-FROM-CRIT                                    14139071
141400         DIVIDE  ASC-TRANSCRIBE-QTY (ASC-BLK-SUB ASC-ITEM-SUB)    14140071
141410             BY  ASC-OUTER-PACK-QTY (ASC-BLK-SUB ASC-ITEM-SUB)    14141071
141420         GIVING  PV-CARTON-COUNT-CALC                             14142071
141430                 REMAINDER PV-CARTON-COUNT-REM                    14143071
141440         END-DIVIDE                                               14144071
141450                                                                  14145071
141460         IF  PV-CARTON-COUNT-REM  >  +0                           14146071
141470             CONTINUE                                             14147071
141480         ELSE                                                     14148071
141490             MOVE PV-CARTON-COUNT-CALC                            14149071
141500               TO ASC-CARTON-COUNT (ASC-BLK-SUB ASC-ITEM-SUB)     14150071
141510         END-IF                                                   14151071
141520     ELSE                                                         14152071
141530         CONTINUE                                                 14153071
141540     END-IF                                                       14154071
141550     END-IF.                                                      14155071
141560                                                                  14156071
141570*----------------------------------------------------------------*14157071
141580*    DETERMINE LINE STATUS                                       *14158071
141590*----------------------------------------------------------------*14159071
141600 4315-GET-LINE-STATUS.                                            14160071
141610     IF  RECITM-STATUS-CDE  = 'VE'                                14161071
141620         MOVE  'VRFD'            TO  PV-LINE-STATUS               14162071
141630         SET  ASC-NO-UPDATE  (ASC-BLK-SUB ASC-ITEM-SUB)           14163071
141640              ASC-PROTECTED  (ASC-BLK-SUB ASC-ITEM-SUB)           14164071
141650                                 TO TRUE                          14165071
141660     END-IF.                                                      14166071
141670                                                                  14167071
141680     PERFORM 4320-GET-DISTR-HEADER                                14168071
141690                                                                  14169071
141700     IF  PS-DISTHD-RECORD-FOUND                                   14170071
141710         IF  DISTHD-TOT-CART-CNT  >  0  AND                       14171071
141720             DISTHD-CRE-LBL-OPT-CDE  =  'C'                       14172071
141730             SET ASC-RESEND-P2L-NO (ASC-BLK-SUB ASC-ITEM-SUB)     14173071
141740                                                          TO TRUE 14174071
141750         ELSE                                                     14175071
141760         IF  DISTHD-TOT-CART-CNT  >  0  AND                       14176071
141770             DISTHD-P2L-CART-CNT  =  0                            14177071
141780             SET ASC-RESEND-P2L-NO (ASC-BLK-SUB ASC-ITEM-SUB)     14178071
141790                                                          TO TRUE 14179071
141800         ELSE                                                     14180071
141810         IF  DISTHD-RSLTS-RCVD-TMST NOT = PC-DEFAULT-TIMESTAMP OR 14181071
141820             RECITM-STATUS-CDE  = 'VE'                            14182071
141830             SET ASC-RESEND-P2L-NO (ASC-BLK-SUB ASC-ITEM-SUB)     14183071
141840                                                          TO TRUE 14184071
141850         ELSE                                                     14185071
141860         IF  DISTHD-TOT-CART-CNT  =  0                            14186071
141870             SET ASC-RESEND-P2L-NO (ASC-BLK-SUB ASC-ITEM-SUB)     14187071
141880                                                          TO TRUE 14188071
141890         ELSE                                                     14189071
141900             SET ASC-RESEND-P2L-YES(ASC-BLK-SUB ASC-ITEM-SUB)     14190071
141910                                                          TO TRUE 14191071
141920         END-IF                                                   14192071
141930         END-IF                                                   14193071
141940         END-IF                                                   14194071
141950         END-IF                                                   14195071
141960     ELSE                                                         14196071
141970         SET ASC-RESEND-P2L-NO (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE 14197071
141980     END-IF.                                                      14198071
141990                                                                  14199071
142000     IF  (PV-LINE-STATUS  >  SPACES)  OR                          14200071
142010         (PS-SOFT-ABORT-ERROR AND PS-NOT-RATIO-ALLOC-ERROR)       14201071
142020         CONTINUE                                                 14202071
142030     ELSE                                                         14203071
142040     IF  PS-DISTHD-RECORD-FOUND                                   14204071
142050         PERFORM 4340-EVALUATE-STAT-CODE                          14205071
142060     ELSE                                                         14206071
142070        MOVE SPACES                    TO  PV-LINE-STATUS.        14207071
142080                                                                  14208071
142090                                                                  14209071
142100     IF  PS-NO-SOFT-ABORT-ERROR                                   14210071
142110         PERFORM 4330-CHECK-TROUBLE                               14211071
142120     END-IF.                                                      14212071
142130                                                                  14213071
142140     IF  PV-LINE-STATUS  >  SPACES  OR                            14214071
142150         PS-SOFT-ABORT-ERROR                                      14215071
142160         CONTINUE                                                 14216071
142170     ELSE                                                         14217071
142180         PERFORM 4335-CHECK-DC-RTV                                14218071
142190     END-IF.                                                      14219071
142200                                                                  14220071
142210     MOVE PV-DC-BOUND-EXPT-CNT                                    14221071
142220       TO ASC-DC-BOUND-UNTS (ASC-BLK-SUB ASC-ITEM-SUB).           14222071
142230     MOVE PV-RTV-BOUND-EXPT-CNT                                   14223071
142240       TO ASC-RTV-BOUND-UNTS (ASC-BLK-SUB ASC-ITEM-SUB).          14224071
142250                                                                  14225071
142260                                                                  14226071
142270     IF  PS-SOFT-ABORT-ERROR                                      14227071
142280             CONTINUE                                             14228071
142290     ELSE                                                         14229071
142300     IF  PV-LINE-STATUS  >  SPACES                                14230071
142400         IF  PV-LINE-STATUS  =  'VRFD'                            14240071
142500             CONTINUE                                             14250071
142510         ELSE                                                     14251071
142520             PERFORM 4325-BY-OLD-OR-UPLOADED                      14252071
142530         END-IF                                                   14253071
142540     END-IF                                                       14254071
142550     END-IF.                                                      14255071
142560                                                                  14256071
142570     IF  PS-DISTHD-RECORD-FOUND                                   14257071
142580         IF  DISTHD-PRCG-STAT-CDE  =  'D'                         14258071
142590             IF (DISTHD-CART-DWNLD-USR-ID  =  SPACES          AND 14259071
142600                 DISTHD-CRE-USR-ID         =  SPACES          AND 14260071
142610                 DISTHD-SYS-CRE-CDE        =  SPACES          AND 14261071
142620                 DISTHD-PRC-AREA-MODU-ID   =  SPACES          AND 14262071
142630                 DISTHD-SPC-INSTR-DESC     =  SPACES          AND 14263071
142640                 DISTHD-TOT-CART-CNT       =  ZEROES          AND 14264071
142650                 DISTHD-FCSE-CART-CNT      =  ZEROES          AND 14265071
142660                 DISTHD-P2L-CART-CNT       =  ZEROES          AND 14266071
142670                 DISTHD-INPK-CART-CNT      =  ZEROES          AND 14267071
142680                 DISTHD-INPK-UNT-QTY       =  ZEROES          AND 14268071
142690                 DISTHD-OTPK-UNT-QTY       =  ZEROES          AND 14269071
142700                 DISTHD-CART-DWNLD-DTE     =  PC-DEFAULT-DTE  AND 14270071
142710                 DISTHD-CART-DWNLD-TM      =  PC-DEFAULT-TM)      14271071
142720                 CONTINUE                                         14272071
142730             ELSE                                                 14273071
142740               IF  PS-INITIAL-EDIT                                14274071
142750                   SET  ASC-PROTECTED (ASC-BLK-SUB ASC-ITEM-SUB)  14275071
142760                        ASC-DOWNLOADED (ASC-BLK-SUB ASC-ITEM-SUB) 14276071
142770                                   TO TRUE                        14277071
142780               END-IF                                             14278071
142790             END-IF                                               14279071
142800         END-IF                                                   14280071
142810     END-IF.                                                      14281071
142820                                                                  14282071
142830     IF  PV-LINE-STATUS  >  SPACES                                14283071
142840         CONTINUE                                                 14284071
142850     ELSE                                                         14285071
142860     IF  ASC-PRE-PACK-ORDER                                       14286071
142870            MOVE ASC-PO-NBR           TO  DK-PO-NBR               14287071
142880            MOVE ASC-REC-SEQ-NBR      TO  DK-REC-SEQ-NBR          14288071
142890            MOVE RECITM-PREPK-ID      TO  DK-PREPK-ID             14289071
142900            PERFORM 8200-CHECK-FOR-CNTL-STK                       14290071
142910            IF  PV-PREPK-CNTL-STK-COUNT  > 0                      14291071
142920                SET  ASC-PREPK-CNTL-STK                           14292071
142930                     (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE           14293071
142940                IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)         14294071
142950                     SET ASC-INVALID-PREPK-CSTK-Y                 14295071
142960                                      TO  TRUE                    14296071
142970                END-IF                                            14297071
142980                MOVE 'CSTK'           TO  PV-LINE-STATUS          14298071
142990            ELSE                                                  14299071
143000            PERFORM 8205-CHECK-FOR-E-COMM                         14300071
143010                 IF  PV-PREPK-E-COMM-COUNT  > 0                   14301071
143020                     CONTINUE                                     14302071
143030                 ELSE                                             14303071
143040                     MOVE 'PRPK'           TO  PV-LINE-STATUS     14304071
143050                 END-IF                                           14305071
143060           END-IF                                                 14306071
143070                                                                  14307071
143080     END-IF.                                                      14308071
143090                                                                  14309071
143100                                                                  14310071
143200*----------------------------------------------------------------*14320071
143210*  DETERMINE ODD CARTON USE IF LINE ALREADY DOWNLOADED           *14321071
143220*----------------------------------------------------------------*14322071
143230 4317-ODD-CART-USE.                                               14323071
143240                                                                  14324071
143250     EXEC SQL                                                     14325071
143260         SELECT COUNT(*)                                          14326071
143270           INTO :PV-DISTDT-ODD-CNT-FCSE                           14327071
143280           FROM TDISTDT                                           14328071
143290          WHERE ORD_NBR      = :ASC-PO-NBR                        14329071
143300            AND RCVR_SEQ_NBR = :ASC-REC-SEQ-NBR                   14330071
143310            AND ORD_LNE_NBR  = :ASC-PO-LINE-NBR                   14331071
143320            AND ODD_CART_IND = :PC-F                              14332071
143330          FETCH FIRST 1 ROW ONLY                                  14333071
143340     END-EXEC.                                                    14334071
143350                                                                  14335071
143360     EVALUATE TRUE                                                14336071
143370         WHEN SQLCODE = +0                                        14337071
143380             CONTINUE                                             14338071
143390         WHEN SQLCODE = -904                                      14339071
143400         WHEN SQLCODE = -911                                      14340071
143410         WHEN SQLCODE = -913                                      14341071
143420             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    14342071
143430             MOVE '4317-ODD-CART-USE - 1'   TO PV-SOFT-PARAGRAPH  14343071
143440             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  14344071
143450             MOVE LENGTH OF PV-CICS-MSG-AREA2                     14345071
143460               TO PV-COMMAREA-LENGTH                              14346071
143470             EXEC CICS                                            14347071
143480                  WRITEQ TD                                       14348071
143490                   QUEUE  ('CSSL')                                14349071
143500                    FROM  (PV-CICS-MSG-AREA2)                     14350071
143510                  LENGTH  (PV-COMMAREA-LENGTH)                    14351071
143520                    RESP  (PV-CICS-RESP)                          14352071
143530             END-EXEC                                             14353071
143540             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          14354071
143550             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              14355071
143560             PERFORM 9900-SOFT-ABORT                              14356071
143570         WHEN SQLWARN0 NOT = SPACES                               14357071
143580         WHEN SQLCODE < ZERO                                      14358071
143590         WHEN SQLCODE > ZERO                                      14359071
143600             MOVE '4317-ODD-CART-USE - 1'                         14360071
143610                               TO DP013-PARAGRAPH                 14361071
143620             MOVE 'CHECK IF ODD CARTON USE IS FCSE'               14362071
143630                               TO DP013-MESSAGE-TEXT (1)          14363071
143640             MOVE SQLCA        TO DP013-SQLCA                     14364071
143650             MOVE 'TDISTDT'    TO DP013-DB2-TABLE-NAME (1)        14365071
143660             SET DP013-DB2-ABEND                                  14366071
143670                 DP013-XCTL-DISPLAY-RESTART                       14367071
143680                               TO TRUE                            14368071
143690             PERFORM DP013-0000-PROCESS-ABEND                     14369071
143700     END-EVALUATE.                                                14370071
143710                                                                  14371071
143720     EXEC SQL                                                     14372071
143730         SELECT COUNT(*)                                          14373071
143740           INTO :PV-DISTDT-ODD-CNT-INPK                           14374071
143750           FROM TDISTDT                                           14375071
143760          WHERE ORD_NBR      = :ASC-PO-NBR                        14376071
143770            AND RCVR_SEQ_NBR = :ASC-REC-SEQ-NBR                   14377071
143780            AND ORD_LNE_NBR  = :ASC-PO-LINE-NBR                   14378071
143790            AND ODD_CART_IND = :PC-I                              14379071
143800          FETCH FIRST 1 ROW ONLY                                  14380071
143810     END-EXEC.                                                    14381071
143820                                                                  14382071
143830     EVALUATE TRUE                                                14383071
143840         WHEN SQLCODE = +0                                        14384071
143850             CONTINUE                                             14385071
143860         WHEN SQLCODE = -904                                      14386071
143870         WHEN SQLCODE = -911                                      14387071
143880         WHEN SQLCODE = -913                                      14388071
143890             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    14389071
143900             MOVE '4317-ODD-CART-USE - 2'   TO PV-SOFT-PARAGRAPH  14390071
143910             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  14391071
143920             MOVE LENGTH OF PV-CICS-MSG-AREA2                     14392071
143930               TO PV-COMMAREA-LENGTH                              14393071
143940             EXEC CICS                                            14394071
143950                  WRITEQ TD                                       14395071
143960                   QUEUE  ('CSSL')                                14396071
143970                    FROM  (PV-CICS-MSG-AREA2)                     14397071
143980                  LENGTH  (PV-COMMAREA-LENGTH)                    14398071
143990                    RESP  (PV-CICS-RESP)                          14399071
144000             END-EXEC                                             14400071
144010             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          14401071
144020             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              14402071
144030             PERFORM 9900-SOFT-ABORT                              14403071
144040         WHEN SQLWARN0 NOT = SPACES                               14404071
144050         WHEN SQLCODE < ZERO                                      14405071
144060         WHEN SQLCODE > ZERO                                      14406071
144070             MOVE '4317-ODD-CART-USE - 2'                         14407071
144080                               TO DP013-PARAGRAPH                 14408071
144090             MOVE 'CHECK IF ODD CARTON USE IS INPK'               14409071
144100                               TO DP013-MESSAGE-TEXT (1)          14410071
144110             MOVE SQLCA        TO DP013-SQLCA                     14411071
144120             MOVE 'TDISTDT'    TO DP013-DB2-TABLE-NAME (1)        14412071
144130             SET DP013-DB2-ABEND                                  14413071
144140                 DP013-XCTL-DISPLAY-RESTART                       14414071
144150                               TO TRUE                            14415071
144160             PERFORM DP013-0000-PROCESS-ABEND                     14416071
144170     END-EVALUATE.                                                14417071
144180                                                                  14418071
144190*----------------------------------------------------------------*14419071
144200*  GET DISTRIBUTION HEADER                                       *14420071
144210*----------------------------------------------------------------*14421071
144220 4320-GET-DISTR-HEADER.                                           14422071
144230     SET PS-NOT-DISTHD-RECORD-FOUND TO TRUE.                      14423071
144240                                                                  14424071
144250     EXEC SQL                                                     14425071
144260          SELECT  SYS_CRE_CDE                                     14426071
144270                 ,RSLTS_RCVD_TMST                                 14427071
144280                 ,PRCG_STAT_CDE                                   14428071
144290                 ,TOT_CART_CNT                                    14429071
144300                 ,PRC_AREA_MODU_ID                                14430071
144310                 ,P2L_CART_CNT                                    14431071
144320                 ,FCSE_CART_CNT                                   14432071
144330                 ,FCSE_LBL_TYP_CDE                                14433071
144340                 ,FCSE_CNFRMN_TMST                                14434071
144350                 ,TOT_CART_CNT                                    14435071
144360                 ,INPK_UNT_QTY                                    14436071
144370                 ,INPK_CNVYB_IND                                  14437071
144380                 ,OTPK_UNT_QTY                                    14438071
144390                 ,CART_DWNLD_USR_ID                               14439071
144400                 ,CRE_USR_ID                                      14440071
144410                 ,SPC_INSTR_DESC                                  14441071
144420                 ,INPK_CART_CNT                                   14442071
144430                 ,CART_DWNLD_DTE                                  14443071
144440                 ,CART_DWNLD_TM                                   14444071
144450                 ,FCSE_CNFRMN_PGM_ID                              14445071
144460                 ,CRE_LBL_OPT_CDE                                 14446071
144470                 ,FCSE_FCLTY_AREA_ID                              14447071
144480                 ,DATE(CRE_TMST)                                  14448071
144490                 ,ODD_CART_UNT_QTY                                14449071
144500                 ,CAL_UNT_PRCD_QTY                                14450071
144510                 ,UCC128_DAT_USG_CDE                              14451071
144520                 ,PHY_LBL_PRC_CNT                                 14452071
144530                 ,VRTL_LBL_PRC_CNT                                14453071
144540            INTO  :DISTHD-SYS-CRE-CDE                             14454071
144550                 ,:DISTHD-RSLTS-RCVD-TMST                         14455071
144560                 ,:DISTHD-PRCG-STAT-CDE                           14456071
144570                 ,:DISTHD-TOT-CART-CNT                            14457071
144580                 ,:DISTHD-PRC-AREA-MODU-ID                        14458071
144590                 ,:DISTHD-P2L-CART-CNT                            14459071
144600                 ,:DISTHD-FCSE-CART-CNT                           14460071
144610                 ,:DISTHD-FCSE-LBL-TYP-CDE                        14461071
144620                 ,:DISTHD-FCSE-CNFRMN-TMST                        14462071
144630                 ,:DISTHD-TOT-CART-CNT                            14463071
144640                 ,:DISTHD-INPK-UNT-QTY                            14464071
144650                 ,:DISTHD-INPK-CNVYB-IND                          14465071
144660                 ,:DISTHD-OTPK-UNT-QTY                            14466071
144670                 ,:DISTHD-CART-DWNLD-USR-ID                       14467071
144680                 ,:DISTHD-CRE-USR-ID                              14468071
144690                 ,:DISTHD-SPC-INSTR-DESC                          14469071
144700                 ,:DISTHD-INPK-CART-CNT                           14470071
144710                 ,:DISTHD-CART-DWNLD-DTE                          14471071
144720                 ,:DISTHD-CART-DWNLD-TM                           14472071
144730                 ,:DISTHD-FCSE-CNFRMN-PGM-ID                      14473071
144740                 ,:DISTHD-CRE-LBL-OPT-CDE                         14474071
144750                 ,:DISTHD-FCSE-FCLTY-AREA-ID                      14475071
144760                 ,:PV-CREATE-TMST-DATE                            14476071
144770                 ,:DISTHD-ODD-CART-UNT-QTY                        14477071
144780                 ,:DISTHD-CAL-UNT-PRCD-QTY                        14478071
144790                 ,:DISTHD-UCC128-DAT-USG-CDE                      14479071
144800                 ,:DISTHD-PHY-LBL-PRC-CNT                         14480071
144810                 ,:DISTHD-VRTL-LBL-PRC-CNT                        14481071
144820            FROM  TDISTHD                                         14482071
144830            WHERE ORD_NBR          = :ASC-PO-NBR                  14483071
144840              AND RCVR_SEQ_NBR     = :ASC-REC-SEQ-NBR             14484071
144850              AND ORD_LNE_NBR      = :ASC-PO-LINE-NBR             14485071
144860     END-EXEC.                                                    14486071
144870                                                                  14487071
144880     EVALUATE TRUE                                                14488071
144890         WHEN SQLCODE = ZERO                                      14489071
144900             SET PS-DISTHD-RECORD-FOUND  TO  TRUE                 14490071
144910             IF  DISTHD-TOT-CART-CNT  >  ZEROES                   14491071
144920                 MOVE DISTHD-TOT-CART-CNT                         14492071
144930                   TO ASC-CARTON-COUNT (ASC-BLK-SUB ASC-ITEM-SUB) 14493071
144940             END-IF                                               14494071
144950             IF  DISTHD-INPK-UNT-QTY  >  ZEROES                   14495071
144960                 MOVE DISTHD-INPK-UNT-QTY                         14496071
144970                   TO ASC-INNER-PACK-QTY(ASC-BLK-SUB ASC-ITEM-SUB)14497071
144980             END-IF                                               14498071
144990             IF  DISTHD-INPK-CNVYB-IND  >  SPACES                 14499071
145000                 MOVE DISTHD-INPK-CNVYB-IND                       14500071
145010                   TO ASC-IN-PAK-CONVEY                           14501071
145020                      (ASC-BLK-SUB ASC-ITEM-SUB)                  14502071
145030             END-IF                                               14503071
145040                                                                  14504071
145050             IF  DISTHD-CRE-LBL-OPT-CDE  >  SPACES                14505071
145060                 MOVE DISTHD-CRE-LBL-OPT-CDE                      14506071
145070                   TO ASC-LNE-CRE-LBL-OPT                         14507071
145080                      (ASC-BLK-SUB ASC-ITEM-SUB)                  14508071
145090             END-IF                                               14509071
145100             IF  DISTHD-FCSE-FCLTY-AREA-ID  >  SPACES             14510071
145110                 MOVE DISTHD-FCSE-FCLTY-AREA-ID                   14511071
145120                   TO ASC-LNE-FCSE-AREA                           14512071
145130                      (ASC-BLK-SUB ASC-ITEM-SUB)                  14513071
145140             END-IF                                               14514071
145150                                                                  14515071
145160             IF  DISTHD-ODD-CART-UNT-QTY  >  ZEROES               14516071
145170                 MOVE DISTHD-ODD-CART-UNT-QTY                     14517071
145180                   TO ASC-ODD-CARTON                              14518071
145190                      (ASC-BLK-SUB ASC-ITEM-SUB)                  14519071
145200             END-IF                                               14520071
145210                                                                  14521071
145220             IF  ASC-IN-PAK-CONVEY (ASC-BLK-SUB ASC-ITEM-SUB)     14522071
145230                 >  SPACE                                         14523071
145240                 CONTINUE                                         14524071
145250             ELSE                                                 14525071
145260                 SET ASC-IN-PAK-CONVEY-NO                         14526071
145270                     (ASC-BLK-SUB ASC-ITEM-SUB)  TO  TRUE         14527071
145280             END-IF                                               14528071
145290             IF  DISTHD-OTPK-UNT-QTY  >  ZEROES                   14529071
145300                 MOVE DISTHD-OTPK-UNT-QTY                         14530071
145310                   TO ASC-OUTER-PACK-QTY(ASC-BLK-SUB ASC-ITEM-SUB)14531071
145320             END-IF                                               14532071
145330             IF  DISTHD-UCC128-DAT-USG-CDE  =  'U'  AND           14533071
145340                 DISTHD-OTPK-UNT-QTY  =  ZEROES                   14534071
145350                 SET  ASC-MLT-OTPK-UCC128                         14535071
145360                      (ASC-BLK-SUB ASC-ITEM-SUB)  TO  TRUE        14536071
145370             END-IF                                               14537071
145380             IF (DISTHD-RSLTS-RCVD-TMST = PC-DEFAULT-TIMESTAMP AND14538071
145390                DISTHD-FCSE-CNFRMN-TMST = PC-DEFAULT-TIMESTAMP AND14539071
145400                DISTHD-PRC-AREA-MODU-ID = SPACES)                 14540071
145410                 CONTINUE                                         14541071
145420             ELSE                                                 14542071
145430                 SET  ASC-NO-UPDATE  (ASC-BLK-SUB ASC-ITEM-SUB)   14543071
145440                      ASC-PROTECTED  (ASC-BLK-SUB ASC-ITEM-SUB)   14544071
145450                                         TO TRUE                  14545071
145460             END-IF                                               14546071
145470             IF  DISTHD-TOT-CART-CNT      =  ZEROES AND           14547071
145480                 DISTHD-PRC-AREA-MODU-ID  = SPACES                14548071
145490                 CONTINUE                                         14549071
145500             ELSE                                                 14550071
145510                 MOVE  DISTHD-TOT-CART-CNT                        14551071
145520                   TO  ASC-CARTON-COUNT(ASC-BLK-SUB ASC-ITEM-SUB) 14552071
145530                 MOVE  DISTHD-P2L-CART-CNT                        14553071
145540                   TO  ASC-P2L-LABEL-CNT(ASC-BLK-SUB ASC-ITEM-SUB)14554071
145550                 ADD  DISTHD-FCSE-CART-CNT                        14555071
145560                      DISTHD-INPK-CART-CNT                        14556071
145570                      GIVING PV-FCSE-INPK-COMBINED                14557071
145580                 MOVE  PV-FCSE-INPK-COMBINED                      14558071
145590                   TO  ASC-SML-LABEL-CNT(ASC-BLK-SUB ASC-ITEM-SUB)14559071
145600                                                                  14560071
145610                 IF  ASC-MODULE(ASC-BLK-SUB ASC-ITEM-SUB)         14561071
145620                         > SPACES   AND                           14562071
145630                     ASC-MODULE(ASC-BLK-SUB ASC-ITEM-SUB)         14563071
145640                         > ZEROES   AND                           14564071
145650                     ASC-MODULE(ASC-BLK-SUB ASC-ITEM-SUB)         14565071
145660                         > LOW-VALUES                             14566071
145670                                                                  14567071
145680                     IF PS-CRITERIA-CHANGE                        14568071
145690                          MOVE  DISTHD-PRC-AREA-MODU-ID           14569071
145700                          TO  ASC-MODULE(ASC-BLK-SUB ASC-ITEM-SUB)14570071
145710                     END-IF                                       14571071
145720                 ELSE                                             14572071
145730                     MOVE  DISTHD-PRC-AREA-MODU-ID                14573071
145740                       TO  ASC-MODULE(ASC-BLK-SUB ASC-ITEM-SUB)   14574071
145750                 END-IF                                           14575071
145760                                                                  14576071
145770                 IF  PS-INITIAL-EDIT                              14577071
145780                     IF DISTHD-CART-DWNLD-USR-ID  = SPACE AND     14578071
145790                        DISTHD-CRE-USR-ID         = SPACE AND     14579071
145800                        DISTHD-SYS-CRE-CDE        = SPACE AND     14580071
145810                        DISTHD-PRC-AREA-MODU-ID   = SPACE AND     14581071
145820                        DISTHD-FCSE-LBL-TYP-CDE   = SPACE AND     14582071
145830                        DISTHD-SPC-INSTR-DESC     = SPACE AND     14583071
145840                        DISTHD-INPK-CNVYB-IND     = SPACE AND     14584071
145850                        DISTHD-FCSE-CNFRMN-PGM-ID = SPACE AND     14585071
145860                        DISTHD-TOT-CART-CNT       = ZERO  AND     14586071
145870                        DISTHD-FCSE-CART-CNT      = ZERO  AND     14587071
145880                        DISTHD-P2L-CART-CNT       = ZERO  AND     14588071
145890                        DISTHD-INPK-CART-CNT      = ZERO  AND     14589071
145900                        DISTHD-INPK-UNT-QTY       = ZERO  AND     14590071
145910                        DISTHD-OTPK-UNT-QTY       = ZERO          14591071
145920                        CONTINUE                                  14592071
145930                     ELSE                                         14593071
145940                     SET ASC-LNE-DOWNLOADED-YES                   14594071
145950                         (ASC-BLK-SUB ASC-ITEM-SUB)  TO  TRUE     14595071
145960                     IF  ASC-TEMP-SELECT                          14596071
145970                        (ASC-BLK-SUB ASC-ITEM-SUB)                14597071
145980                        SET ASC-PO-RCVR-DWNLD-P2L-Y  TO TRUE      14598071
145990                     END-IF                                       14599071
146000                     END-IF                                       14600071
146010                 END-IF                                           14601071
146020                                                                  14602071
146030                 IF  DP020-NEXT-ACT-INITIAL  OR                   14603071
146040                     DP020-FK-REFRESH (DP020-SRC-AID)             14604071
146050                     IF  DISTHD-FCSE-LBL-TYP-CDE  > SPACES        14605071
146060                         MOVE  DISTHD-FCSE-LBL-TYP-CDE            14606071
146070                           TO  ASC-LBL-TYP                        14607071
146080                               (ASC-BLK-SUB ASC-ITEM-SUB)         14608071
146090                     END-IF                                       14609071
146100                     IF  DISTHD-FCSE-LBL-TYP-CDE  = SPACES        14610071
146110                         MOVE  'N'                                14611071
146120                           TO  ASC-LBL-TYP                        14612071
146130                               (ASC-BLK-SUB ASC-ITEM-SUB)         14613071
146140                     END-IF                                       14614071
146150                 END-IF                                           14615071
146160                 IF  ASC-LBL-TYP(ASC-BLK-SUB ASC-ITEM-SUB) = 'R'  14616071
146170                     MOVE  'S'                                    14617071
146180                       TO  ASC-LBL-TYP(ASC-BLK-SUB ASC-ITEM-SUB)  14618071
146190                 END-IF                                           14619071
146200             END-IF                                               14620071
146210             IF  PV-LINE-STATUS  =  'OPRC'                        14621071
146220                 MOVE  ZEROES  TO  ASC-OUTER-PACK-QTY             14622071
146230                                   (ASC-BLK-SUB ASC-ITEM-SUB)     14623071
146240                 MOVE  PC-N    TO  ASC-LBL-TYP                    14624071
146250                                   (ASC-BLK-SUB ASC-ITEM-SUB)     14625071
146260             END-IF                                               14626071
146270         WHEN SQLCODE = +100                                      14627071
146280                 SET ASC-LNE-DOWNLOADED-NO                        14628071
146290                         (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE       14629071
146300                 MOVE  PC-DEFAULT-DTE  TO  PV-CREATE-TMST-DATE    14630071
146310         WHEN SQLCODE = -904                                      14631071
146320         WHEN SQLCODE = -911                                      14632071
146330         WHEN SQLCODE = -913                                      14633071
146340                                                                  14634071
146350             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   14635071
146360             MOVE '4320-GET-DISTR-HEADER'    TO PV-SOFT-PARAGRAPH 14636071
146370             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 14637071
146380             MOVE LENGTH OF PV-CICS-MSG-AREA2                     14638071
146390               TO PV-COMMAREA-LENGTH                              14639071
146400             EXEC CICS                                            14640071
146410                  WRITEQ TD                                       14641071
146420                   QUEUE  ('CSSL')                                14642071
146430                    FROM  (PV-CICS-MSG-AREA2)                     14643071
146440                  LENGTH  (PV-COMMAREA-LENGTH)                    14644071
146450                    RESP  (PV-CICS-RESP)                          14645071
146460             END-EXEC                                             14646071
146470                                                                  14647071
146480             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          14648071
146490             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              14649071
146500             PERFORM 9900-SOFT-ABORT                              14650071
146510         WHEN SQLWARN0 NOT = SPACES                               14651071
146520         WHEN SQLCODE  NOT = ZERO                                 14652071
146530             MOVE '4320-GET-DISTR-HEADER'                         14653071
146540                                 TO DP013-PARAGRAPH               14654071
146550             MOVE 'UNSUCCESSFUL SELECT OF TDISTHD'                14655071
146560                                 TO DP013-MESSAGE-TEXT (1)        14656071
146570             MOVE SQLCA         TO DP013-SQLCA                    14657071
146580             MOVE 'TDISTHD'     TO DP013-DB2-TABLE-NAME (1)       14658071
146590             SET DP013-DB2-ABEND                                  14659071
146600                 DP013-XCTL-DISPLAY-RESTART                       14660071
146610                                 TO TRUE                          14661071
146620                                                                  14662071
146630             PERFORM DP013-0000-PROCESS-ABEND                     14663071
146640     END-EVALUATE.                                                14664071
146650                                                                  14665071
146660                                                                  14666071
146670*----------------------------------------------------------------*14667071
146680*                                                                *14668071
146690*----------------------------------------------------------------*14669071
146700 4325-BY-OLD-OR-UPLOADED.                                         14670071
146710     IF  DISTHD-SYS-CRE-CDE  =  'P'                               14671071
146720         MOVE 'OPRC'                   TO  PV-LINE-STATUS         14672071
146730         SET  ASC-NO-UPDATE  (ASC-BLK-SUB ASC-ITEM-SUB)           14673071
146740              ASC-PROTECTED  (ASC-BLK-SUB ASC-ITEM-SUB)           14674071
146750                                        TO TRUE                   14675071
146760     END-IF.                                                      14676071
146770                                                                  14677071
146780                                                                  14678071
146790*----------------------------------------------------------------*14679071
146800*                                                                *14680071
146810*----------------------------------------------------------------*14681071
146820 4330-CHECK-TROUBLE.                                              14682071
146830     EXEC SQL                                                     14683071
146840           SELECT   B.TRBL_SHT_DESC                               14684071
146850             INTO  :TRBRSN-TRBL-SHT-DESC                          14685071
146860             FROM   TTRBNTF A                                     14686071
146870                   ,TTRBRSN B                                     14687071
146880            WHERE   A.PO_NBR         = :ASC-PO-NBR                14688071
146890              AND   A.REC_SEQ_NBR    = :ASC-REC-SEQ-NBR           14689071
146900              AND ((A.PO_LNE_NBR     = :ASC-PO-LINE-NBR           14690071
146910              AND   B.TRBL_LVL_IND  <> :PC-M)                     14691071
146920               OR  (A.PREPK_ID       = :RECITM-PREPK-ID           14692071
146930              AND   B.TRBL_LVL_IND   = :PC-M))                    14693071
146940              AND   A.RESOLVED_IND  NOT IN (:PC-A)                14694071
146950              AND   A.TRBL_RSN_CDE   = B.TRBL_RSN_CDE             14695071
146960              AND   B.NOTIF_IND    =  'T'                         14696071
146970     END-EXEC.                                                    14697071
146980                                                                  14698071
146990     EVALUATE TRUE                                                14699071
147000         WHEN SQLCODE = +0                                        14700071
147010         WHEN SQLCODE = -811                                      14701071
147020             IF  PV-LINE-STATUS >  SPACES                         14702071
147030                 NEXT SENTENCE                                    14703071
147040             ELSE                                                 14704071
147050                 MOVE  TRBRSN-TRBL-SHT-DESC  TO  PV-LINE-STATUS   14705071
147060                 SET  ASC-NO-UPDATE  (ASC-BLK-SUB ASC-ITEM-SUB)   14706071
147070                      ASC-PROTECTED  (ASC-BLK-SUB ASC-ITEM-SUB)   14707071
147080                      ASC-TROUBLE-ERROR (ASC-BLK-SUB ASC-ITEM-SUB)14708071
147090                                             TO TRUE              14709071
147100             END-IF                                               14710071
147110             IF  ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       14711071
147120                 SET ASC-PO-RCVR-TROUBLE-YES  TO TRUE             14712071
147130             END-IF                                               14713071
147140                 SET ASC-LNE-TROUBLE-YES                          14714071
147150                     (ASC-BLK-SUB ASC-ITEM-SUB)  TO TRUE          14715071
147160             IF  ASC-CART-CNT  >  +0                              14716071
147170                 MOVE ZEROES       TO  ASC-CARTON-COUNT           14717071
147180                                       (ASC-BLK-SUB ASC-ITEM-SUB) 14718071
147190             END-IF                                               14719071
147200         WHEN SQLCODE = +100                                      14720071
147210              CONTINUE                                            14721071
147220         WHEN SQLCODE = -904                                      14722071
147230         WHEN SQLCODE = -911                                      14723071
147240         WHEN SQLCODE = -913                                      14724071
147250                                                                  14725071
147260             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   14726071
147270             MOVE '4330-CHECK-TROUBLE'       TO PV-SOFT-PARAGRAPH 14727071
147280             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 14728071
147290             MOVE LENGTH OF PV-CICS-MSG-AREA2                     14729071
147300               TO PV-COMMAREA-LENGTH                              14730071
147310             EXEC CICS                                            14731071
147320                  WRITEQ TD                                       14732071
147330                   QUEUE  ('CSSL')                                14733071
147340                    FROM  (PV-CICS-MSG-AREA2)                     14734071
147350                  LENGTH  (PV-COMMAREA-LENGTH)                    14735071
147360                    RESP  (PV-CICS-RESP)                          14736071
147370             END-EXEC                                             14737071
147380                                                                  14738071
147390             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          14739071
147400             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              14740071
147410             PERFORM 9900-SOFT-ABORT                              14741071
147420         WHEN SQLWARN0 NOT = SPACES                               14742071
147430         WHEN SQLCODE  NOT = ZERO                                 14743071
147440             MOVE '4330-CHECK-TROUBLE'                            14744071
147450                                  TO DP013-PARAGRAPH              14745071
147460              MOVE 'UNSUCCESSFUL SELECT OF TROUBLE'               14746071
147470                                  TO DP013-MESSAGE-TEXT (1)       14747071
147480              MOVE SQLCA         TO DP013-SQLCA                   14748071
147490              MOVE 'TTRBNTF'     TO DP013-DB2-TABLE-NAME (1)      14749071
147500              MOVE 'TTRBRSN'     TO DP013-DB2-TABLE-NAME (2)      14750071
147510              SET DP013-DB2-ABEND                                 14751071
147520                  DP013-XCTL-DISPLAY-RESTART                      14752071
147530                                  TO TRUE                         14753071
147540                                                                  14754071
147550              PERFORM DP013-0000-PROCESS-ABEND                    14755071
147560      END-EVALUATE.                                               14756071
147570                                                                  14757071
147580                                                                  14758071
147590*----------------------------------------------------------------*14759071
147600*                                                                *14760071
147610*----------------------------------------------------------------*14761071
147620 4335-CHECK-DC-RTV.                                               14762071
147630     PERFORM 4155-OPEN-DC-RTV-CURSOR.                             14763071
147640                                                                  14764071
147650     SET  PS-NOT-EOF-DC-RTV-CURSOR TO  TRUE                       14765071
147660     MOVE ZEROES  TO  PV-DC-RTV-ROWS-RETRIEVED                    14766071
147670                      PV-DC-BOUND-EXPT-CNT                        14767071
147680                      PV-RTV-BOUND-EXPT-CNT                       14768071
147690                                                                  14769071
147700     IF  PS-NO-ERROR                                              14770071
147710         PERFORM 4160-FETCH-DC-RTV-CURSOR                         14771071
147720           UNTIL PS-EOF-DC-RTV-CURSOR                             14772071
147730              OR PS-ERROR                                         14773071
147740     END-IF.                                                      14774071
147750                                                                  14775071
147760     SET PS-DC-RTV-NOT-STORE-ALLOCATION  TO  TRUE.                14776071
147770     MOVE  ZEROES  TO  PV-STR-COUNT.                              14777071
147780                                                                  14778071
147790     IF  PS-NO-ERROR                                              14779071
147800         IF  PV-DC-RTV-ROWS-RETRIEVED  >  +0                      14780071
147810             PERFORM 4337-DC-RTV-AND-STORE                        14781071
147820         END-IF                                                   14782071
147830                                                                  14783071
147840         IF  PV-DC-RTV-ROWS-RETRIEVED  >  +0  AND                 14784071
147850             PV-STR-COUNT  >  0               AND                 14785071
147860             PS-DC-RTV-STORE-ALLOCATION                           14786071
147870             CONTINUE                                             14787071
147880         ELSE                                                     14788071
147890         IF  PV-DC-RTV-ROWS-RETRIEVED  =  +1                      14789071
147900             IF  PV-DC-RTV-TYPE-CODE  =  'DC'                     14790071
147910                 MOVE  'DCBD'             TO  PV-LINE-STATUS      14791071
147920                 IF ASC-AUTOVE-PARM-NO                            14792071
147930                    SET  ASC-NO-UPDATE(ASC-BLK-SUB ASC-ITEM-SUB)  14793071
147940                         ASC-PROTECTED(ASC-BLK-SUB ASC-ITEM-SUB)  14794071
147950                                           TO TRUE                14795071
147960                    IF  ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)14796071
147970                        SET  ASC-PO-RCVR-DWNLD-P2L-Y  TO  TRUE    14797071
147980                    END-IF                                        14798071
147990                    SET ASC-LNE-DOWNLOADED-YES                    14799071
148000                        (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE        14800071
148010                 END-IF                                           14801071
148020             ELSE                                                 14802071
148030                 MOVE  'RTV '            TO  PV-LINE-STATUS       14803071
148040                 IF ASC-AUTOVE-PARM-NO                            14804071
148050                    SET  ASC-NO-UPDATE(ASC-BLK-SUB ASC-ITEM-SUB)  14805071
148060                         ASC-PROTECTED(ASC-BLK-SUB ASC-ITEM-SUB)  14806071
148070                                            TO TRUE               14807071
148080                    IF  ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)14808071
148090                        SET  ASC-PO-RCVR-DWNLD-P2L-Y  TO  TRUE    14809071
148100                    END-IF                                        14810071
148110                    SET ASC-LNE-DOWNLOADED-YES                    14811071
148120                       (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE         14812071
148130                 END-IF                                           14813071
148140             END-IF                                               14814071
148150         ELSE                                                     14815071
148160         IF  PV-DC-RTV-ROWS-RETRIEVED  >  +1                      14816071
148170                 MOVE  'DCRT'           TO  PV-LINE-STATUS        14817071
148180                 IF ASC-AUTOVE-PARM-NO                            14818071
148190                    SET  ASC-NO-UPDATE(ASC-BLK-SUB ASC-ITEM-SUB)  14819071
148200                         ASC-PROTECTED(ASC-BLK-SUB ASC-ITEM-SUB)  14820071
148210                                        TO TRUE                   14821071
148220                    IF  ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB) 14822071
148230                        SET  ASC-PO-RCVR-DWNLD-P2L-Y  TO  TRUE    14823071
148240                    END-IF                                        14824071
148250                    SET ASC-LNE-DOWNLOADED-YES                    14825071
148260                        (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE        14826071
148270                 END-IF                                           14827071
148280         END-IF                                                   14828071
148290         END-IF                                                   14829071
148300     END-IF.                                                      14830071
148310                                                                  14831071
148320     IF  PS-NO-SOFT-ABORT-ERROR                                   14832071
148330         PERFORM 4165-CLOSE-DC-RTV-CURSOR                         14833071
148340     END-IF.                                                      14834071
148350                                                                  14835071
148360                                                                  14836071
148370*----------------------------------------------------------------*14837071
148380* CHECK TO SEE IF OTHER STORES ARE ON THE ALLOCATION ALONG WITH  *14838071
148390* DC & RTV BOUND                                                 *14839071
148400*----------------------------------------------------------------*14840071
148410 4337-DC-RTV-AND-STORE.                                           14841071
148420                                                                  14842071
148430     MOVE  ZEROES  TO  PV-RECDIS-ORD-NBR.                         14843071
148440     MOVE  ZEROES  TO  PV-STR-COUNT.                              14844071
148450                                                                  14845071
148451     EXEC SQL                                                     14845171
148452          SELECT A.ORD_NBR                                        14845271
148453            INTO :PV-RECDIS-ORD-NBR                               14845371
148454            FROM TRECDIS A                                        14845471
148455                ,XLT_LOC B                                        14845571
148456           WHERE A.ORD_NBR         =  :ASC-PO-NBR                 14845671
148457             AND A.REC_SEQ_NBR     =  :ASC-REC-SEQ-NBR            14845771
148458             AND A.ORD_LNE_NBR     =  :ASC-PO-LINE-NBR            14845871
148459             AND A.STR_NBR         = B.LOC_NBR                    14845971
148460             AND A.EXPTED_ITM_QTY  > 0                            14846071
148470             AND B.LOC_TYP_CDE NOT IN ('DC','RV')                 14847071
148480          FETCH FIRST 1 ROW ONLY                                  14848071
148490     END-EXEC.                                                    14849071
148500                                                                  14850071
148510     EVALUATE TRUE                                                14851071
148520         WHEN SQLCODE = ZERO                                      14852071
148530              SET PS-DC-RTV-STORE-ALLOCATION  TO  TRUE            14853071
148540              IF  PV-RECDIS-ORD-NBR  > 0                          14854071
148550                  MOVE  1  TO  PV-STR-COUNT                       14855071
148560              END-IF                                              14856071
148570         WHEN SQLCODE = +100                                      14857071
148580              MOVE  ZEROES  TO  PV-STR-COUNT                      14858071
148590         WHEN SQLCODE = -904                                      14859071
148600         WHEN SQLCODE = -911                                      14860071
148610         WHEN SQLCODE = -913                                      14861071
148620                                                                  14862071
148630             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   14863071
148640             MOVE '4337-DC-RTV-AND-STORE'    TO PV-SOFT-PARAGRAPH 14864071
148650             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 14865071
148660             MOVE LENGTH OF PV-CICS-MSG-AREA2                     14866071
148670               TO PV-COMMAREA-LENGTH                              14867071
148680             EXEC CICS                                            14868071
148690                  WRITEQ TD                                       14869071
148700                   QUEUE  ('CSSL')                                14870071
148710                    FROM  (PV-CICS-MSG-AREA2)                     14871071
148720                  LENGTH  (PV-COMMAREA-LENGTH)                    14872071
148730                    RESP  (PV-CICS-RESP)                          14873071
148740             END-EXEC                                             14874071
148750                                                                  14875071
148760             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          14876071
148770             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              14877071
148780             PERFORM 9900-SOFT-ABORT                              14878071
148790         WHEN SQLWARN0 NOT = SPACE                                14879071
148800         WHEN SQLCODE NOT = ZERO                                  14880071
148810              MOVE '4337-DC-RTV-AND-STORE'                        14881071
148820                               TO DP013-PARAGRAPH                 14882071
148830              MOVE 'CHECK DC/RTV AND STORES ALLOCATION'           14883071
148840                               TO DP013-MESSAGE-TEXT (1)          14884071
148850              MOVE SQLCA       TO DP013-SQLCA                     14885071
148860              SET DP013-DB2-ABEND                                 14886071
148870                               TO TRUE                            14887071
148880              PERFORM DP013-0000-PROCESS-ABEND                    14888071
148890     END-EVALUATE.                                                14889071
148900                                                                  14890071
148910                                                                  14891071
148920*----------------------------------------------------------------*14892071
148930*                                                                *14893071
148940*----------------------------------------------------------------*14894071
148950 4340-EVALUATE-STAT-CODE.                                         14895071
148960     IF  DISTHD-PRCG-STAT-CDE  =  'E'                             14896071
148970         MOVE  'ERR '                    TO  PV-LINE-STATUS       14897071
148980     ELSE                                                         14898071
148990     IF  DISTHD-PRCG-STAT-CDE  =  'R'                             14899071
149000         MOVE  'RDY '                    TO  PV-LINE-STATUS       14900071
149010     ELSE                                                         14901071
149020     IF  DISTHD-PRCG-STAT-CDE  =  'P'                             14902071
149030         MOVE  'PVFD'                    TO  PV-LINE-STATUS       14903071
149040         SET  ASC-NO-UPDATE  (ASC-BLK-SUB ASC-ITEM-SUB)           14904071
149050              ASC-PROTECTED  (ASC-BLK-SUB ASC-ITEM-SUB)           14905071
149060                                         TO TRUE                  14906071
149070     ELSE                                                         14907071
149080     IF  DISTHD-PRCG-STAT-CDE  =  'F'                             14908071
149090         MOVE  'NPRO'                    TO  PV-LINE-STATUS       14909071
149100     ELSE                                                         14910071
149110     IF  DISTHD-PRCG-STAT-CDE  =  'V'                             14911071
149120         MOVE  'PVFD'                    TO  PV-LINE-STATUS       14912071
149130         SET  ASC-NO-UPDATE  (ASC-BLK-SUB ASC-ITEM-SUB)           14913071
149140              ASC-PROTECTED  (ASC-BLK-SUB ASC-ITEM-SUB)           14914071
149150                                         TO TRUE                  14915071
149160     ELSE                                                         14916071
149170     IF  DISTHD-PRCG-STAT-CDE  =  'D'                             14917071
149180         IF  ASC-PPC-EXISTS (ASC-BLK-SUB ASC-ITEM-SUB)            14918071
149190             MOVE  'DWPP'                TO  PV-LINE-STATUS       14919071
149200         ELSE                                                     14920071
149210         IF  DISTHD-P2L-CART-CNT      =  ZEROES                   14921071
149220             IF  DISTHD-TOT-CART-CNT      =  ZEROES  AND          14922071
149230                 DISTHD-INPK-UNT-QTY      =  ZEROES  AND          14923071
149240                 DISTHD-OTPK-UNT-QTY      =  ZEROES               14924071
149250                 MOVE  SPACES                TO  PV-LINE-STATUS   14925071
149260                 SET  ASC-UPDATE-OK(ASC-BLK-SUB ASC-ITEM-SUB)     14926071
149270                      ASC-NOT-PROTECTED(ASC-BLK-SUB ASC-ITEM-SUB) 14927071
149280                                         TO TRUE                  14928071
149290             ELSE                                                 14929071
149300                 MOVE  'FCRD'            TO  PV-LINE-STATUS       14930071
149310             END-IF                                               14931071
149320         ELSE                                                     14932071
149330             MOVE  'DNLD'                TO  PV-LINE-STATUS       14933071
149340         END-IF                                                   14934071
149350         END-IF                                                   14935071
149360     ELSE                                                         14936071
149370     IF  DISTHD-PRCG-STAT-CDE  =  'I'                             14937071
149380         MOVE  'SPND'                    TO  PV-LINE-STATUS       14938071
149390     ELSE                                                         14939071
149400     IF  DISTHD-PRCG-STAT-CDE  =  'C'                             14940071
149410         MOVE  'CNCL'                    TO  PV-LINE-STATUS       14941071
149420     ELSE                                                         14942071
149430     IF  DISTHD-PRCG-STAT-CDE  =  'B'                             14943071
149440         IF  DISTHD-RSLTS-RCVD-TMST  NOT = PC-DEFAULT-TIMESTAMP   14944071
149450             MOVE  'P2PR'                TO  PV-LINE-STATUS       14945071
149460         ELSE                                                     14946071
149470         IF  DISTHD-FCSE-CNFRMN-TMST  NOT = PC-DEFAULT-TIMESTAMP  14947071
149480             MOVE  'FCPR'                TO  PV-LINE-STATUS       14948071
149490         END-IF                                                   14949071
149500     ELSE                                                         14950071
149510* BAD RATIO                                                       14951071
149520     IF  DISTHD-PRCG-STAT-CDE  =  'A'                             14952071
149530         MOVE  'BRAT'                    TO  PV-LINE-STATUS       14953071
149540     ELSE                                                         14954071
149550* NOT ARRIVED                                                     14955071
149560     IF  DISTHD-PRCG-STAT-CDE  =  'G'                             14956071
149570         MOVE  'NARV'                    TO  PV-LINE-STATUS       14957071
149580                                                                  14958071
149590     ELSE                                                         14959071
149600* OPEN SYSTEM AUDIT (3/28/04 dmh)                                 14960071
149610     IF  DISTHD-PRCG-STAT-CDE  =  'H'                             14961071
149620         MOVE  'AUDT'                    TO  PV-LINE-STATUS       14962071
149630                                                                  14963071
149640     ELSE                                                         14964071
149650* NOT MANIFESTED                                                  14965071
149660     IF  DISTHD-PRCG-STAT-CDE  =  'J'                             14966071
149670         MOVE  'NACT'                    TO  PV-LINE-STATUS       14967071
149680                                                                  14968071
149690     END-IF.                                                      14969071
149700                                                                  14970071
149710* confirmation suspended audit                                    14971071
149720     IF  DISTHD-PRCG-STAT-CDE  =  'K'                             14972071
149730         MOVE  'C AU'                    TO  PV-LINE-STATUS       14973071
149740                                                                  14974071
149750     END-IF.                                                      14975071
149760                                                                  14976071
149770* confirmation suspended trouble                                  14977071
149780     IF  DISTHD-PRCG-STAT-CDE  =  'L'                             14978071
149790         MOVE  'C TR'                    TO  PV-LINE-STATUS       14979071
149800                                                                  14980071
149810     END-IF.                                                      14981071
149820                                                                  14982071
149830* protect screen fields for dummy rows created for tdisthd        14983071
149840     IF  DISTHD-CRE-USR-ID  =  'TRLRUNLD' OR                      14984071
149850         DISTHD-CRE-USR-ID  =  'HOTCMPLT'                         14985071
149860         SET  ASC-NO-UPDATE  (ASC-BLK-SUB ASC-ITEM-SUB)           14986071
149870              ASC-PROTECTED  (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE   14987071
149880     END-IF.                                                      14988071
149890                                                                  14989071
149900                                                                  14990071
149910*----------------------------------------------------------------*14991071
149920*                                                                *14992071
149930*----------------------------------------------------------------*14993071
149940 4345-GET-LABEL-COUNT.                                            14994071
149950     PERFORM 4170-OPEN-TRECDIS-CURSOR.                            14995071
149960                                                                  14996071
149970     SET  PS-NOT-EOF-TRECDIS-CURSOR  TO  TRUE.                    14997071
149980     MOVE  ZEROES  TO  PV-SHIP-LNE-TOTAL                          14998071
149990                       PV-P2L-LNE-TOTAL                           14999071
150000                       PV-P2L-QUOTIENT                            15000071
150010                       PV-FULL-CASE-SHIP-TOTAL                    15001071
150020                       PV-INPK-SHIP-LNE-TOTAL                     15002071
150030                       PV-TOT-REMAINDER                           15003071
150040                       PV-FCSE-INPK-REMAINDER                     15004071
150050                       PV-TOT-REMAINDER.                          15005071
150060                                                                  15006071
150070     IF  PS-NO-SOFT-ABORT-ERROR                                   15007071
150080         SET  ASC-FCSE-ODD-CRTN-NOT-USED                          15008071
150090              (ASC-BLK-SUB ASC-ITEM-SUB)  TO  TRUE                15009071
150100         MOVE  ASC-PO-NBR       TO  DK-PO-NBR                     15010071
150110         MOVE  ASC-REC-SEQ-NBR  TO  DK-REC-SEQ-NBR                15011071
150120         MOVE  ASC-PO-LNE-NBR (ASC-BLK-SUB ASC-ITEM-SUB)          15012071
150130                                TO  DK-LINE-NBR                   15013071
150140                                                                  15014071
150150*                                                                 15015071
150160* IF ODD-CARTON > = OUTER PACK                                    15016071
150170*    DETERMINE THE NUMBER OF FULL CASE WITHIN ODD & REMAINDER     15017071
150180*  EX:  OUTER PACK = 12                                           15018071
150190*       ODD CARTON = 27                                           15019071
150200*       ODD FULL CASE = 2  ODD REMAINDER = 3                      15020071
150210*                                                                 15021071
150220                                                                  15022071
150230                  MOVE ZEROES  TO  PV-FCSE-INPK-REMAINDER         15023071
150240                                   PV-ODD-FULLCASE                15024071
150250                                   PV-ODD-REMAINDER               15025071
150260                                   PV-ODD-CARTON-INPK-TOTAL       15026071
150270                                   PV-ALLOC-AFTER-ODD-CARTON      15027071
150280                                                                  15028071
150290                  IF ASC-ODD-CARTON                               15029071
150300                      (ASC-BLK-SUB ASC-ITEM-SUB) > 0 AND          15030071
150310                      ASC-OUTER-PACK-QTY                          15031071
150320                      (ASC-BLK-SUB ASC-ITEM-SUB) > 0              15032071
150330                      DIVIDE ASC-ODD-CARTON                       15033071
150340                             (ASC-BLK-SUB ASC-ITEM-SUB)           15034071
150350                          BY ASC-OUTER-PACK-QTY                   15035071
150360                             (ASC-BLK-SUB ASC-ITEM-SUB)           15036071
150370                      GIVING PV-ODD-FULLCASE                      15037071
150380                             REMAINDER PV-ODD-REMAINDER           15038071
150390                  END-IF                                          15039071
150400                                                                  15040071
150410*  IF ODD-CARTON AND INNER-PACK CONVEYABLE DETERMINE IF CARTON    15041071
150420*  WILL BE USED AS FULLCASE OF BY INNERPACK                       15042071
150430                                                                  15043071
150440                  SET PS-USE-ODD-CARTON-NONE TO TRUE              15044071
150450                  IF ASC-ODD-CARTON                               15045071
150460                      (ASC-BLK-SUB ASC-ITEM-SUB) > 0              15046071
150470                      MOVE ASC-ODD-CARTON                         15047071
150480                            (ASC-BLK-SUB ASC-ITEM-SUB)            15048071
150490                        TO PV-ODD-CARTON-UNT-QTY                  15049071
150500                      MOVE ASC-OUTER-PACK-QTY                     15050071
150510                            (ASC-BLK-SUB ASC-ITEM-SUB)            15051071
150520                        TO PV-OUTER-PACK-QTY                      15052071
150530                      MOVE ASC-INNER-PACK-QTY                     15053071
150540                            (ASC-BLK-SUB ASC-ITEM-SUB)            15054071
150550                        TO PV-INNER-PACK-QTY                      15055071
150560                      PERFORM 4850-ODD-CARTON-INPK-FCSE           15056071
150570                  END-IF                                          15057071
150580                                                                  15058071
150590*  IF ODD-CARTON, INNER-PACK CONVEYABLE INNER PACKS TO BE USED    15059071
150600*  DETERMINE NUMBER OF INNER-PACKS IN ODD-CARTON.                 15060071
150610                                                                  15061071
150620                  SET PS-ODD-CARTON-INPK-NOT-USED TO TRUE         15062071
150630                  MOVE ZEROES TO PV-ODD-CARTON-INPK-TOTAL         15063071
150640                                   PV-ODD-CARTON-INPK-USED        15064071
150650                  IF ASC-ODD-CARTON                               15065071
150660                      (ASC-BLK-SUB ASC-ITEM-SUB) > 0 AND          15066071
150670                      ASC-IN-PAK-CONVEY-YES                       15067071
150680                      (ASC-BLK-SUB ASC-ITEM-SUB) AND              15068071
150690                      PS-USE-ODD-CARTON-INPK                      15069071
150700                      DIVIDE PV-ODD-CARTON-UNT-QTY                15070071
150710                          BY PV-INNER-PACK-QTY                    15071071
150720                      GIVING PV-ODD-CARTON-INPK-TOTAL             15072071
150730                  END-IF                                          15073071
150740                                                                  15074071
150750*** ODD CARTON > 0 AND LINE PROCESSED AS FULLCASE ('C')           15075071
150760*** CARTON MUST BE PROCESSED AS FULLCASE OR INPK                  15076071
150770                                                                  15077071
150780         IF  ASC-ODD-CARTON                                       15078071
150790             (ASC-BLK-SUB ASC-ITEM-SUB) > 0 AND                   15079071
150800             ASC-LNE-CRE-SML-LBL                                  15080071
150810             (ASC-BLK-SUB ASC-ITEM-SUB)     AND                   15081071
150820             PS-USE-ODD-CARTON-NONE                               15082071
150830             SET  ASC-LNE-BAD-ODD-Y                               15083071
150840                  (ASC-BLK-SUB ASC-ITEM-SUB)                      15084071
150850                  ASC-INVALID-OTPK-ODD      TO  TRUE              15085071
150860         END-IF                                                   15086071
150870                                                                  15087071
150880****                                                              15088071
150890         PERFORM 4175-FETCH-TRECDIS-CURSOR                        15089071
150900           UNTIL PS-EOF-TRECDIS-CURSOR                            15090071
150910              OR PS-SOFT-ABORT-ERROR                              15091071
150920     END-IF.                                                      15092071
150930                                                                  15093071
150940*** IF  BAD ODD CARTON FOR FULLCASE  DO NOT DISPLAY CALCULATED    15094071
150950*** CARTON COUNTS                                                 15095071
150960                                                                  15096071
150970     IF  ASC-LNE-CRE-SML-LBL (ASC-BLK-SUB ASC-ITEM-SUB)  AND      15097071
150980         ASC-LNE-BAD-ODD-Y (ASC-BLK-SUB ASC-ITEM-SUB)    AND      15098071
150990         ASC-ODD-CARTON (ASC-BLK-SUB ASC-ITEM-SUB)  >  0          15099071
151000         MOVE ZEROES  TO  PV-SHIP-LNE-TOTAL                       15100071
151010                          PV-FULL-CASE-SHIP-TOTAL                 15101071
151020                          PV-INPK-SHIP-LNE-TOTAL                  15102071
151030     END-IF.                                                      15103071
151040                                                                  15104071
151050     IF  PS-NO-SOFT-ABORT-ERROR                                   15105071
151060         IF  ASC-OUTER-PACK-QTY (ASC-BLK-SUB ASC-ITEM-SUB) > 0    15106071
151070             IF  ASC-ODD-CARTON                                   15107071
151080                 (ASC-BLK-SUB ASC-ITEM-SUB) > 0  AND              15108071
151090                                                                  15109071
151100                 NOT ASC-ODD-CRTN-FCSE                            15110071
151110                     (ASC-BLK-SUB ASC-ITEM-SUB)  AND              15111071
151120                 NOT ASC-ODD-CRTN-INPK                            15112071
151130                     (ASC-BLK-SUB ASC-ITEM-SUB)  AND              15113071
151140                 NOT ASC-LNE-CRE-SML-LBL                          15114071
151150                     (ASC-BLK-SUB ASC-ITEM-SUB)                   15115071
151160                                                                  15116071
151170                 SET  ASC-ODD-CRTN-P2L                            15117071
151180                      (ASC-BLK-SUB ASC-ITEM-SUB)  TO  TRUE        15118071
151190             END-IF                                               15119071
151200             IF  ASC-ODD-CRTN-P2L                                 15120071
151210                 (ASC-BLK-SUB ASC-ITEM-SUB)                       15121071
151220                 SUBTRACT ASC-ODD-CARTON                          15122071
151230                          (ASC-BLK-SUB ASC-ITEM-SUB)              15123071
151240                     FROM PV-TOT-REMAINDER                        15124071
151250                   GIVING PV-P2L-UNITS-AFTER-ODD                  15125071
151260                 IF PV-P2L-UNITS-AFTER-ODD > 0                    15126071
151270                     DIVIDE  PV-P2L-UNITS-AFTER-ODD               15127071
151280                         BY  ASC-OUTER-PACK-QTY                   15128071
151290                             (ASC-BLK-SUB ASC-ITEM-SUB)           15129071
151300                     GIVING  PV-P2L-QUOTIENT ROUNDED              15130071
151310                     ADD 1 TO PV-P2L-QUOTIENT                     15131071
151320                 END-IF                                           15132071
151330                 IF PV-P2L-UNITS-AFTER-ODD = 0                    15133071
151340                     ADD 1 TO PV-P2L-QUOTIENT                     15134071
151350                 END-IF                                           15135071
151360             ELSE                                                 15136071
151370                 DIVIDE  PV-TOT-REMAINDER                         15137071
151380                     BY  ASC-OUTER-PACK-QTY                       15138071
151390                         (ASC-BLK-SUB ASC-ITEM-SUB)               15139071
151400                 GIVING  PV-P2L-QUOTIENT                          15140071
151410                 REMAINDER PV-P2L-REMAINDER                       15141071
151420                 END-DIVIDE                                       15142071
151430                                                                  15143071
151440                 IF  PV-P2L-REMAINDER  >  0  AND                  15144071
151450                     ASC-IN-PAK-CONVEY-YES                        15145071
151460                         (ASC-BLK-SUB ASC-ITEM-SUB)               15146071
151470                     DIVIDE  PV-P2L-REMAINDER                     15147071
151480                         BY  ASC-INNER-PACK-QTY                   15148071
151490                             (ASC-BLK-SUB ASC-ITEM-SUB)           15149071
151500                     GIVING  PV-P2L-INPK-QUOTIENT                 15150071
151510                     END-DIVIDE                                   15151071
151520                     ADD  PV-P2L-INPK-QUOTIENT                    15152071
151530                      TO  PV-P2L-QUOTIENT                         15153071
151540                 END-IF                                           15154071
151550                                                                  15155071
151560             END-IF                                               15156071
151570         ELSE                                                     15157071
151580             MOVE  ZEROES  TO  PV-P2L-QUOTIENT                    15158071
151590         END-IF                                                   15159071
151600     END-IF.                                                      15160071
151610                                                                  15161071
151620     IF  ASC-LNE-CRE-P2L-LBL (ASC-BLK-SUB ASC-ITEM-SUB)           15162071
151630         MOVE  ASC-CARTON-COUNT (ASC-BLK-SUB ASC-ITEM-SUB)        15163071
151640           TO  PV-P2L-LNE-TOTAL                                   15164071
151650               PV-P2L-QUOTIENT                                    15165071
151660         MOVE  ZEROES  TO  PV-SHIP-LNE-TOTAL                      15166071
151670                           PV-FULL-CASE-SHIP-TOTAL                15167071
151680                           PV-INPK-SHIP-LNE-TOTAL                 15168071
151690     END-IF.                                                      15169071
151700                                                                  15170071
151710                                                                  15171071
151720     IF  PS-NO-SOFT-ABORT-ERROR                                   15172071
151730         MOVE  PV-P2L-QUOTIENT          TO  PV-P2L-LNE-TOTAL      15173071
151740         MOVE PV-TOT-REMAINDER          TO  PV-STR-P2L-UNT-QTY    15174071
151750                                                                  15175071
151760         MOVE  PV-P2L-LNE-TOTAL         TO  ASC-P2L-LABEL-CNT     15176071
151770                                       (ASC-BLK-SUB ASC-ITEM-SUB) 15177071
151780         MOVE  PV-SHIP-LNE-TOTAL        TO  ASC-SML-LABEL-CNT     15178071
151790                                       (ASC-BLK-SUB ASC-ITEM-SUB) 15179071
151800         MOVE  PV-FULL-CASE-SHIP-TOTAL  TO  ASC-SML-FCSE-LBL-CNT  15180071
151810                                       (ASC-BLK-SUB ASC-ITEM-SUB) 15181071
151820         MOVE  PV-INPK-SHIP-LNE-TOTAL   TO  ASC-SML-INPK-LBL-CNT  15182071
151830                                       (ASC-BLK-SUB ASC-ITEM-SUB) 15183071
151840                                                                  15184071
151850         PERFORM 4180-CLOSE-TRECDIS-CURSOR                        15185071
151860     END-IF.                                                      15186071
151870                                                                  15187071
151880                                                                  15188071
151890*----------------------------------------------------------------*15189071
151900*  CALCULATE NUMBER OF SHIPPING LABELS & P2L LABELS              *15190071
151910*----------------------------------------------------------------*15191071
151920 4350-CALCULATE-LBL-QTY.                                          15192071
151930     SET  PS-FULLCASES-ALL-NOT-USED  TO  TRUE.                    15193071
151940     MOVE  ZEROES  TO  PV-STR-P2L-UNT-QTY                         15194071
151950                       PV-STR-FCSE-UNT-QTY                        15195071
151960                       PV-STR-INPK-UNT-QTY                        15196071
151970                       PV-STR-ACTL-UNT-QTY                        15197071
151980                       PV-FCSE-INPK-REMAINDER.                    15198071
151990                                                                  15199071
152000     IF  ASC-ODD-CARTON (ASC-BLK-SUB ASC-ITEM-SUB) > 0            15200071
152010         SUBTRACT  1                                              15201071
152020             FROM  ASC-CARTON-COUNT (ASC-BLK-SUB ASC-ITEM-SUB)    15202071
152030           GIVING  PV-CARTON-COUNT-LESS-ODD                       15203071
152040     ELSE                                                         15204071
152050          MOVE ZEROES                                             15205071
152060            TO PV-CARTON-COUNT-LESS-ODD                           15206071
152070     END-IF.                                                      15207071
152080                                                                  15208071
152090     IF  ASC-ODD-CARTON (ASC-BLK-SUB ASC-ITEM-SUB)  >  0  AND     15209071
152100         PV-FULL-CASE-SHIP-TOTAL >=                               15210071
152110         ASC-CARTON-COUNT (ASC-BLK-SUB ASC-ITEM-SUB)              15211071
152120             SET PS-FULLCASES-ALL-USED  TO  TRUE                  15212071
152130     END-IF.                                                      15213071
152140                                                                  15214071
152150     IF  ASC-ODD-CARTON (ASC-BLK-SUB ASC-ITEM-SUB) > 0  AND       15215071
152160         PV-EXPTED-ITM-QTY  >=                                    15216071
152170         ASC-ODD-CARTON (ASC-BLK-SUB ASC-ITEM-SUB)  AND           15217071
152180         ASC-FCSE-ODD-CRTN-NOT-USED (ASC-BLK-SUB ASC-ITEM-SUB)    15218071
152190             ADD  1  TO  PV-SHIP-LNE-TOTAL                        15219071
152200                         PV-FULL-CASE-SHIP-TOTAL                  15220071
152210             SET  ASC-FCSE-ODD-CRTN-USED                          15221071
152220                          (ASC-BLK-SUB ASC-ITEM-SUB)              15222071
152230                  ASC-ODD-CRTN-FCSE                               15223071
152240                          (ASC-BLK-SUB ASC-ITEM-SUB)              15224071
152250                  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)     TO TRUE     15225071
152260             SUBTRACT ASC-ODD-CARTON (ASC-BLK-SUB ASC-ITEM-SUB)   15226071
152270                 FROM PV-EXPTED-ITM-QTY                           15227071
152280     END-IF.                                                      15228071
152290                                                                  15229071
152300*                                                                 15230071
152310* DETERMINE IF ALLOCATION CAN BE FILLED BY FULLCASE.              15231071
152320*                                                                 15232071
152330                                                                  15233071
152340     IF PS-FULLCASES-ALL-NOT-USED  AND                            15234071
152350        ASC-OUTER-PACK-QTY (ASC-BLK-SUB ASC-ITEM-SUB) > 0  and    15235071
152360        PV-EXPTED-ITM-QTY  >  0                                   15236071
152370         DIVIDE  PV-EXPTED-ITM-QTY                                15237071
152380             BY  ASC-OUTER-PACK-QTY (ASC-BLK-SUB ASC-ITEM-SUB)    15238071
152390         GIVING  PV-QUOTIENT                                      15239071
152400                 REMAINDER PV-EXPT-REMAINDER                      15240071
152410         END-DIVIDE                                               15241071
152420     ELSE                                                         15242071
152430         MOVE  ZEROES  TO  PV-QUOTIENT                            15243071
152440         MOVE  PV-EXPTED-ITM-QTY  TO  PV-EXPT-REMAINDER           15244071
152450     END-IF.                                                      15245071
152460                                                                  15246071
152470     IF  ASC-ODD-CARTON (ASC-BLK-SUB ASC-ITEM-SUB) > 0  AND       15247071
152480         PV-QUOTIENT       >=  PV-ODD-FULLCASE   AND              15248071
152490         PV-EXPT-REMAINDER  =  PV-ODD-REMAINDER  AND              15249071
152500         ASC-FCSE-ODD-CRTN-NOT-USED (ASC-BLK-SUB ASC-ITEM-SUB)    15250071
152510                                                                  15251071
152520         SUBTRACT  PV-ODD-FULLCASE                                15252071
152530             FROM  PV-QUOTIENT                                    15253071
152540           GIVING  PV-QUOTIENT                                    15254071
152550                                                                  15255071
152560         MULTIPLY  PV-QUOTIENT                                    15256071
152570               BY  ASC-OUTER-PACK-QTY (ASC-BLK-SUB ASC-ITEM-SUB)  15257071
152580           GIVING  PV-STR-FCSE-UNT-QTY                            15258071
152590                                                                  15259071
152600         ADD 1  TO  PV-QUOTIENT                                   15260071
152610         ADD  ASC-ODD-CARTON (ASC-BLK-SUB ASC-ITEM-SUB)           15261071
152620          TO  PV-STR-FCSE-UNT-QTY                                 15262071
152630         ADD  PV-QUOTIENT  TO  PV-SHIP-LNE-TOTAL                  15263071
152640                               PV-FULL-CASE-SHIP-TOTAL            15264071
152650         MOVE  ZEROES  TO  PV-EXPT-REMAINDER                      15265071
152660         SET  ASC-FCSE-ODD-CRTN-USED                              15266071
152670              (ASC-BLK-SUB ASC-ITEM-SUB)                          15267071
152680              ASC-ODD-CRTN-FCSE                                   15268071
152690              (ASC-BLK-SUB ASC-ITEM-SUB)                          15269071
152700              ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO  TRUE           15270071
152710                                                                  15271071
152720     ELSE                                                         15272071
152730     IF  PV-QUOTIENT  >=  PV-ODD-FULLCASE  AND                    15273071
152740         PV-EXPTED-ITM-QTY  >  ASC-ODD-CARTON                     15274071
152750                               (ASC-BLK-SUB ASC-ITEM-SUB)  AND    15275071
152760         PS-USE-ODD-CARTON-NONE                            AND    15276071
152770         ASC-ODD-CARTON (ASC-BLK-SUB ASC-ITEM-SUB) > 0     AND    15277071
152780         ASC-FCSE-ODD-CRTN-NOT-USED (ASC-BLK-SUB ASC-ITEM-SUB)    15278071
152790                                                                  15279071
152800         SUBTRACT  ASC-ODD-CARTON(ASC-BLK-SUB ASC-ITEM-SUB)       15280071
152810             FROM  PV-EXPTED-ITM-QTY                              15281071
152820           GIVING  PV-ALLOC-AFTER-ODD-CARTON                      15282071
152830                                                                  15283071
152840         IF  PV-OUTER-PACK-QTY  >  0                              15284071
152850             DIVIDE  PV-ALLOC-AFTER-ODD-CARTON                    15285071
152860                 BY  PV-OUTER-PACK-QTY                            15286071
152870             GIVING  PV-QUOTIENT                                  15287071
152880                     REMAINDER PV-EXPT-REMAINDER                  15288071
152890         END-IF                                                   15289071
152900                                                                  15290071
152910         MULTIPLY  PV-QUOTIENT                                    15291071
152920               BY  ASC-OUTER-PACK-QTY (ASC-BLK-SUB ASC-ITEM-SUB)  15292071
152930           GIVING  PV-STR-FCSE-UNT-QTY                            15293071
152940                                                                  15294071
152950         ADD 1  TO  PV-QUOTIENT                                   15295071
152960         ADD  ASC-ODD-CARTON (ASC-BLK-SUB ASC-ITEM-SUB)           15296071
152970          TO  PV-STR-FCSE-UNT-QTY                                 15297071
152980         ADD  PV-QUOTIENT  TO  PV-SHIP-LNE-TOTAL                  15298071
152990                               PV-FULL-CASE-SHIP-TOTAL            15299071
153000         SUBTRACT  ASC-ODD-CARTON (ASC-BLK-SUB ASC-ITEM-SUB)      15300071
153010             FROM  PV-EXPTED-ITM-QTY                              15301071
153020           GIVING  PV-EXPT-REMAINDER                              15302071
153030         SET  PS-USE-ODD-CARTON-FCSE                              15303071
153040              ASC-ODD-CRTN-FCSE                                   15304071
153050              (ASC-BLK-SUB ASC-ITEM-SUB)                          15305071
153060              ASC-FCSE-ODD-CRTN-USED                              15306071
153070              (ASC-BLK-SUB ASC-ITEM-SUB)                          15307071
153080              ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO  TRUE           15308071
153090                                                                  15309071
153100     ELSE                                                         15310071
153200                                                                  15320071
153210     IF  PV-QUOTIENT  =  ZEROES                                   15321071
153220         MOVE  PV-EXPTED-ITM-QTY  TO  PV-EXPT-REMAINDER           15322071
153230     ELSE                                                         15323071
153240         ADD   PV-QUOTIENT  TO  PV-SHIP-LNE-TOTAL                 15324071
153250                                PV-FULL-CASE-SHIP-TOTAL           15325071
153260                                                                  15326071
153270         IF ASC-ODD-CARTON (ASC-BLK-SUB ASC-ITEM-SUB) > ZEROES AND15327071
153280            PV-FULL-CASE-SHIP-TOTAL  >  PV-CARTON-COUNT-LESS-ODD  15328071
153290            IF ASC-ODD-CRTN-FCSE (ASC-BLK-SUB ASC-ITEM-SUB) AND   15329071
153300               ASC-FCSE-ODD-CRTN-USED (ASC-BLK-SUB ASC-ITEM-SUB)  15330071
153310               CONTINUE                                           15331071
153320            ELSE                                                  15332071
153330               SUBTRACT PV-CARTON-COUNT-LESS-ODD                  15333071
153340                   FROM PV-FULL-CASE-SHIP-TOTAL                   15334071
153350                 GIVING PV-FULLCASE-ODD-CART-OVER                 15335071
153360               SUBTRACT PV-FULLCASE-ODD-CART-OVER                 15336071
153370                   FROM PV-QUOTIENT                               15337071
153380                 GIVING PV-QUOTIENT                               15338071
153390               SUBTRACT PV-FULLCASE-ODD-CART-OVER                 15339071
153400                   FROM PV-SHIP-LNE-TOTAL                         15340071
153410                 GIVING PV-SHIP-LNE-TOTAL                         15341071
153420               SUBTRACT PV-FULLCASE-ODD-CART-OVER                 15342071
153430                   FROM PV-FULL-CASE-SHIP-TOTAL                   15343071
153440                 GIVING PV-FULL-CASE-SHIP-TOTAL                   15344071
153450               MULTIPLY PV-FULLCASE-ODD-CART-OVER                 15345071
153460                     BY PV-OUTER-PACK-QTY                         15346071
153470                 GIVING PV-FULLCASE-ODD-UNT-OVER                  15347071
153480                    ADD PV-FULLCASE-ODD-UNT-OVER                  15348071
153490                     TO PV-EXPT-REMAINDER                         15349071
153500             END-IF                                               15350071
153510         END-IF                                                   15351071
153520                                                                  15352071
153530         MULTIPLY  PV-QUOTIENT                                    15353071
153540               BY  ASC-OUTER-PACK-QTY(ASC-BLK-SUB ASC-ITEM-SUB)   15354071
153550           GIVING  PV-STR-FCSE-UNT-QTY                            15355071
153560     END-IF.                                                      15356071
153570                                                                  15357071
153580*                                                                 15358071
153590*** CHECK ODD-CARTON                                              15359071
153600*                                                                 15360071
153610     IF  PV-EXPT-REMAINDER  >  ZEROES  AND                        15361071
153620         ASC-ODD-CARTON (ASC-BLK-SUB ASC-ITEM-SUB) > ZEROES  AND  15362071
153630         ASC-FCSE-ODD-CRTN-NOT-USED (ASC-BLK-SUB ASC-ITEM-SUB)    15363071
153640             IF  PV-EXPT-REMAINDER  =                             15364071
153650                 ASC-ODD-CARTON (ASC-BLK-SUB ASC-ITEM-SUB)        15365071
153660                     ADD  1  TO  PV-SHIP-LNE-TOTAL                15366071
153670                                 PV-FULL-CASE-SHIP-TOTAL          15367071
153680                     ADD  PV-EXPT-REMAINDER                       15368071
153690                             TO  PV-STR-FCSE-UNT-QTY              15369071
153700                     SET  ASC-FCSE-ODD-CRTN-USED                  15370071
153710                          (ASC-BLK-SUB ASC-ITEM-SUB)              15371071
153720                          ASC-ODD-CRTN-FCSE                       15372071
153730                          (ASC-BLK-SUB ASC-ITEM-SUB)              15373071
153740                          ASC-BLOCK-MODIFIED(ASC-BLK-SUB)         15374071
153750                                                      TO TRUE     15375071
153760                     MOVE  ZEROES  TO  PV-EXPT-REMAINDER          15376071
153770             END-IF                                               15377071
153780     END-IF.                                                      15378071
153790                                                                  15379071
153800*                                                                 15380071
153810*** CHECK INNER-PACK                                              15381071
153820*                                                                 15382071
153830     IF  PV-EXPT-REMAINDER  >  ZEROES                             15383071
153840         IF  ASC-IN-PAK-CONVEY (ASC-BLK-SUB ASC-ITEM-SUB) = 'Y'   15384071
153850             IF  ASC-INNER-PACK-QTY (ASC-BLK-SUB ASC-ITEM-SUB) > 015385071
153860                 DIVIDE  PV-EXPT-REMAINDER                        15386071
153870                     BY  ASC-INNER-PACK-QTY                       15387071
153880                         (ASC-BLK-SUB ASC-ITEM-SUB)               15388071
153890                 GIVING  PV-INPK-QUOTIENT                         15389071
153900                         REMAINDER  PV-INPK-REMAINDER             15390071
153910                 END-DIVIDE                                       15391071
153920             ELSE                                                 15392071
153930                 MOVE  ZEROES  TO  PV-INPK-QUOTIENT               15393071
153940                 MOVE  PV-EXPT-REMAINDER  TO  PV-INPK-REMAINDER   15394071
153950             END-IF                                               15395071
153960             ADD  PV-INPK-QUOTIENT   TO  PV-SHIP-LNE-TOTAL        15396071
153970                                         PV-INPK-SHIP-LNE-TOTAL   15397071
153980             MULTIPLY  PV-INPK-QUOTIENT                           15398071
153990                   BY  ASC-INNER-PACK-QTY                         15399071
154000                       (ASC-BLK-SUB ASC-ITEM-SUB)                 15400071
154010               GIVING  PV-STR-INPK-UNT-QTY                        15401071
154020                                                                  15402071
154030             MOVE PV-INPK-QUOTIENT   TO  PV-STR-INPK-UNT-QTY      15403071
154040             MOVE PV-INPK-REMAINDER  TO  PV-FCSE-INPK-REMAINDER   15404071
154050         ELSE                                                     15405071
154060             MOVE PV-EXPT-REMAINDER  TO  PV-FCSE-INPK-REMAINDER   15406071
154070         END-IF                                                   15407071
154080     END-IF.                                                      15408071
154090                                                                  15409071
154100*                                                                 15410071
154110*** CHECK ODD-CARTON                                              15411071
154120*                                                                 15412071
154130     IF  PV-FCSE-INPK-REMAINDER  >  ZEROES  AND                   15413071
154140         ASC-ODD-CARTON (ASC-BLK-SUB ASC-ITEM-SUB) > ZEROES  AND  15414071
154150         ASC-FCSE-ODD-CRTN-NOT-USED (ASC-BLK-SUB ASC-ITEM-SUB)    15415071
154160             IF  PV-FCSE-INPK-REMAINDER  =                        15416071
154170                 ASC-ODD-CARTON (ASC-BLK-SUB ASC-ITEM-SUB)        15417071
154180                     ADD  1  TO  PV-SHIP-LNE-TOTAL                15418071
154190                                 PV-FULL-CASE-SHIP-TOTAL          15419071
154200                     ADD  PV-FCSE-INPK-REMAINDER                  15420071
154210                             TO  PV-STR-FCSE-UNT-QTY              15421071
154220                     SET  ASC-FCSE-ODD-CRTN-USED                  15422071
154230                          (ASC-BLK-SUB ASC-ITEM-SUB)              15423071
154240                          ASC-ODD-CRTN-FCSE                       15424071
154250                          (ASC-BLK-SUB ASC-ITEM-SUB)              15425071
154260                          ASC-BLOCK-MODIFIED(ASC-BLK-SUB)         15426071
154270                                                      TO TRUE     15427071
154280             ELSE                                                 15428071
154290                 ADD  PV-FCSE-INPK-REMAINDER                      15429071
154300                  TO  PV-TOT-REMAINDER                            15430071
154310             END-IF                                               15431071
154320     ELSE                                                         15432071
154330         ADD  PV-FCSE-INPK-REMAINDER  TO  PV-TOT-REMAINDER        15433071
154340     END-IF.                                                      15434071
154350                                                                  15435071
154360                                                                  15436071
154370*----------------------------------------------------------------*15437071
154380*  CALCULATE NUMBER OF SHIPPING LABELS - CASEPACK ONLY (DISPLAY) *15438071
154390*----------------------------------------------------------------*15439071
154400 4351-CALCULATE-LBL-QTY-SML.                                      15440071
154410     SET  PS-FULLCASES-ALL-NOT-USED  TO  TRUE.                    15441071
154420     MOVE  ZEROES  TO  PV-STR-P2L-UNT-QTY                         15442071
154430                       PV-STR-FCSE-UNT-QTY                        15443071
154440                       PV-STR-INPK-UNT-QTY                        15444071
154450                       PV-STR-ACTL-UNT-QTY                        15445071
154460                       PV-FCSE-INPK-REMAINDER.                    15446071
154470                                                                  15447071
154480     IF  ASC-ODD-CARTON (ASC-BLK-SUB ASC-ITEM-SUB) > 0            15448071
154490         SUBTRACT  1                                              15449071
154500             FROM  ASC-CARTON-COUNT (ASC-BLK-SUB ASC-ITEM-SUB)    15450071
154510           GIVING  PV-CARTON-COUNT-LESS-ODD                       15451071
154520     ELSE                                                         15452071
154530          MOVE ZEROES                                             15453071
154540            TO PV-CARTON-COUNT-LESS-ODD                           15454071
154550     END-IF.                                                      15455071
154560                                                                  15456071
154570     IF  ASC-ODD-CARTON (ASC-BLK-SUB ASC-ITEM-SUB)  > 0 AND       15457071
154580         PV-FULL-CASE-SHIP-TOTAL >= PV-CARTON-COUNT-LESS-ODD      15458071
154590             SET PS-FULLCASES-ALL-USED  TO  TRUE                  15459071
154600     END-IF.                                                      15460071
154610                                                                  15461071
154620*                                                                 15462071
154630* DETERMINE IF ALLOCATION CAN BE FILLED BY FULLCASE.              15463071
154640*                                                                 15464071
154650                                                                  15465071
154660     IF  ASC-OUTER-PACK-QTY (ASC-BLK-SUB ASC-ITEM-SUB) > 0        15466071
154670         DIVIDE  PV-EXPTED-ITM-QTY                                15467071
154680             BY  ASC-OUTER-PACK-QTY (ASC-BLK-SUB ASC-ITEM-SUB)    15468071
154690         GIVING  PV-QUOTIENT                                      15469071
154700                 REMAINDER PV-EXPT-REMAINDER                      15470071
154710         END-DIVIDE                                               15471071
154720     ELSE                                                         15472071
154730         MOVE  ZEROES  TO  PV-QUOTIENT                            15473071
154740         MOVE  PV-EXPTED-ITM-QTY  TO  PV-EXPT-REMAINDER           15474071
154750     END-IF.                                                      15475071
154760                                                                  15476071
154770     IF  ASC-ODD-CARTON (ASC-BLK-SUB ASC-ITEM-SUB) > 0  AND       15477071
154780         PV-QUOTIENT  >=  PV-ODD-FULLCASE  AND                    15478071
154790         PV-EXPT-REMAINDER  =  PV-ODD-REMAINDER  AND              15479071
154800         ASC-FCSE-ODD-CRTN-NOT-USED (ASC-BLK-SUB ASC-ITEM-SUB)    15480071
154810                                                                  15481071
154820         SUBTRACT  PV-ODD-FULLCASE                                15482071
154830             FROM  PV-QUOTIENT                                    15483071
154840           GIVING  PV-QUOTIENT                                    15484071
154850                                                                  15485071
154860         MULTIPLY  PV-QUOTIENT                                    15486071
154870               BY  ASC-OUTER-PACK-QTY (ASC-BLK-SUB ASC-ITEM-SUB)  15487071
154880           GIVING  PV-STR-FCSE-UNT-QTY                            15488071
154890                                                                  15489071
154900         ADD 1  TO  PV-QUOTIENT                                   15490071
154910         ADD  ASC-ODD-CARTON (ASC-BLK-SUB ASC-ITEM-SUB)           15491071
154920          TO  PV-STR-FCSE-UNT-QTY                                 15492071
154930         ADD  PV-QUOTIENT  TO  PV-SHIP-LNE-TOTAL                  15493071
154940                               PV-FULL-CASE-SHIP-TOTAL            15494071
154950         MOVE  ZEROES  TO  PV-EXPT-REMAINDER                      15495071
154960         SET  PS-USE-ODD-CARTON-FCSE                              15496071
154970              ASC-FCSE-ODD-CRTN-USED                              15497071
154980              (ASC-BLK-SUB ASC-ITEM-SUB)                          15498071
154990              ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO  TRUE           15499071
155000                                                                  15500071
155010     ELSE                                                         15501071
155020                                                                  15502071
155030     IF  PV-QUOTIENT  >=  PV-ODD-FULLCASE  AND                    15503071
155040         PV-EXPTED-ITM-QTY  >  ASC-ODD-CARTON                     15504071
155050                               (ASC-BLK-SUB ASC-ITEM-SUB)  AND    15505071
155060         PS-USE-ODD-CARTON-NONE                            AND    15506071
155070         ASC-ODD-CARTON (ASC-BLK-SUB ASC-ITEM-SUB)  >  0   AND    15507071
155080         ASC-FCSE-ODD-CRTN-NOT-USED (ASC-BLK-SUB ASC-ITEM-SUB)    15508071
155090                                                                  15509071
155100         SUBTRACT  ASC-ODD-CARTON (ASC-BLK-SUB ASC-ITEM-SUB)      15510071
155110             FROM  PV-EXPTED-ITM-QTY                              15511071
155120           GIVING  PV-ALLOC-AFTER-ODD-CARTON                      15512071
155130                                                                  15513071
155140         IF  PV-OUTER-PACK-QTY  >  0                              15514071
155150             DIVIDE  PV-ALLOC-AFTER-ODD-CARTON                    15515071
155160                 BY  PV-OUTER-PACK-QTY                            15516071
155170             GIVING  PV-QUOTIENT                                  15517071
155180                     REMAINDER  PV-EXPT-REMAINDER                 15518071
155190         END-IF                                                   15519071
155200                                                                  15520071
155210         MULTIPLY  PV-QUOTIENT                                    15521071
155220               BY  ASC-OUTER-PACK-QTY (ASC-BLK-SUB ASC-ITEM-SUB)  15522071
155230           GIVING  PV-STR-FCSE-UNT-QTY                            15523071
155240                                                                  15524071
155250         ADD 1  TO  PV-QUOTIENT                                   15525071
155260         ADD  ASC-ODD-CARTON (ASC-BLK-SUB ASC-ITEM-SUB)           15526071
155270          TO  PV-STR-FCSE-UNT-QTY                                 15527071
155280         ADD  PV-QUOTIENT  TO  PV-SHIP-LNE-TOTAL                  15528071
155290                               PV-FULL-CASE-SHIP-TOTAL            15529071
155300         SUBTRACT  ASC-ODD-CARTON (ASC-BLK-SUB ASC-ITEM-SUB)      15530071
155310             FROM  PV-EXPTED-ITM-QTY                              15531071
155320           GIVING  PV-EXPT-REMAINDER                              15532071
155330         SET  ASC-FCSE-ODD-CRTN-USED                              15533071
155340              (ASC-BLK-SUB ASC-ITEM-SUB)                          15534071
155350              ASC-ODD-CRTN-FCSE                                   15535071
155360              (ASC-BLK-SUB ASC-ITEM-SUB)                          15536071
155370              ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO  TRUE           15537071
155380                                                                  15538071
155390     ELSE                                                         15539071
155400                                                                  15540071
155410     IF  PV-QUOTIENT  =  ZEROES                                   15541071
155420         MOVE  PV-EXPTED-ITM-QTY  TO  PV-EXPT-REMAINDER           15542071
155430     ELSE                                                         15543071
155440         ADD   PV-QUOTIENT  TO  PV-SHIP-LNE-TOTAL                 15544071
155450                                PV-FULL-CASE-SHIP-TOTAL           15545071
155460         MULTIPLY  PV-QUOTIENT                                    15546071
155470               BY  ASC-OUTER-PACK-QTY(ASC-BLK-SUB ASC-ITEM-SUB)   15547071
155480           GIVING  PV-STR-FCSE-UNT-QTY                            15548071
155490     END-IF.                                                      15549071
155500                                                                  15550071
155510*                                                                 15551071
155520*** CHECK ODD-CARTON                                              15552071
155530*                                                                 15553071
155540     IF  PV-EXPT-REMAINDER  >  ZEROES  AND                        15554071
155550         ASC-ODD-CARTON (ASC-BLK-SUB ASC-ITEM-SUB) > ZEROES  AND  15555071
155560         ASC-FCSE-ODD-CRTN-NOT-USED (ASC-BLK-SUB ASC-ITEM-SUB)    15556071
155570             IF  PV-EXPT-REMAINDER  =                             15557071
155580                 ASC-ODD-CARTON (ASC-BLK-SUB ASC-ITEM-SUB)        15558071
155590                     ADD  1  TO  PV-SHIP-LNE-TOTAL                15559071
155600                                 PV-FULL-CASE-SHIP-TOTAL          15560071
155610                     ADD  PV-EXPT-REMAINDER                       15561071
155620                             TO  PV-STR-FCSE-UNT-QTY              15562071
155630                     SET  ASC-FCSE-ODD-CRTN-USED                  15563071
155640                          (ASC-BLK-SUB ASC-ITEM-SUB)              15564071
155650                          ASC-BLOCK-MODIFIED(ASC-BLK-SUB)         15565071
155660                                                      TO TRUE     15566071
155670                     MOVE  ZEROES  TO  PV-EXPT-REMAINDER          15567071
155680             END-IF                                               15568071
155690     END-IF.                                                      15569071
155700                                                                  15570071
155710*                                                                 15571071
155720*** CHECK CONVEYABLE INNER-PACKS                                  15572071
155730*                                                                 15573071
155740     IF  PV-EXPT-REMAINDER  >  ZEROES                             15574071
155750         IF  ASC-IN-PAK-CONVEY (ASC-BLK-SUB ASC-ITEM-SUB) = 'Y'   15575071
155760             IF  ASC-INNER-PACK-QTY (ASC-BLK-SUB ASC-ITEM-SUB) > 015576071
155770                 DIVIDE  PV-EXPT-REMAINDER                        15577071
155780                     BY  ASC-INNER-PACK-QTY                       15578071
155790                         (ASC-BLK-SUB ASC-ITEM-SUB)               15579071
155800                 GIVING  PV-INPK-QUOTIENT                         15580071
155810                         REMAINDER  PV-INPK-REMAINDER             15581071
155820                 END-DIVIDE                                       15582071
155830             ELSE                                                 15583071
155840                 MOVE  ZEROES  TO  PV-INPK-QUOTIENT               15584071
155850                 MOVE  PV-EXPT-REMAINDER  TO  PV-INPK-REMAINDER   15585071
155860             END-IF                                               15586071
155870             ADD  PV-INPK-QUOTIENT   TO  PV-SHIP-LNE-TOTAL        15587071
155880                                         PV-INPK-SHIP-LNE-TOTAL   15588071
155890             MULTIPLY  PV-INPK-QUOTIENT                           15589071
155900                   BY  ASC-INNER-PACK-QTY                         15590071
155910                       (ASC-BLK-SUB ASC-ITEM-SUB)                 15591071
155920               GIVING  PV-STR-INPK-UNT-QTY                        15592071
155930                                                                  15593071
155940             MOVE PV-INPK-QUOTIENT   TO  PV-STR-INPK-UNT-QTY      15594071
155950             MOVE PV-INPK-REMAINDER  TO  PV-FCSE-INPK-REMAINDER   15595071
155960         ELSE                                                     15596071
155970             MOVE PV-EXPT-REMAINDER  TO  PV-FCSE-INPK-REMAINDER   15597071
155980         END-IF                                                   15598071
155990     END-IF.                                                      15599071
156000                                                                  15600071
156010*                                                                 15601071
156020*** CHECK ODD-CARTON                                              15602071
156030*                                                                 15603071
156040     IF  PV-FCSE-INPK-REMAINDER  >  ZEROES  AND                   15604071
156050         ASC-ODD-CARTON (ASC-BLK-SUB ASC-ITEM-SUB) > ZEROES  AND  15605071
156060         ASC-FCSE-ODD-CRTN-NOT-USED (ASC-BLK-SUB ASC-ITEM-SUB)    15606071
156070             IF  PV-FCSE-INPK-REMAINDER  =                        15607071
156080                 ASC-ODD-CARTON (ASC-BLK-SUB ASC-ITEM-SUB)        15608071
156090                     ADD  1  TO  PV-SHIP-LNE-TOTAL                15609071
156100                                 PV-FULL-CASE-SHIP-TOTAL          15610071
156110                     ADD  PV-FCSE-INPK-REMAINDER                  15611071
156120                             TO  PV-STR-FCSE-UNT-QTY              15612071
156130                     SET  ASC-FCSE-ODD-CRTN-USED                  15613071
156140                          (ASC-BLK-SUB ASC-ITEM-SUB)              15614071
156150                          ASC-ODD-CRTN-FCSE                       15615071
156160                          (ASC-BLK-SUB ASC-ITEM-SUB)              15616071
156170                          ASC-BLOCK-MODIFIED(ASC-BLK-SUB)         15617071
156180                                                      TO TRUE     15618071
156190             ELSE                                                 15619071
156200                 ADD  PV-FCSE-INPK-REMAINDER                      15620071
156210                  TO  PV-TOT-REMAINDER                            15621071
156220             END-IF                                               15622071
156230     ELSE                                                         15623071
156240         ADD  PV-FCSE-INPK-REMAINDER  TO  PV-TOT-REMAINDER        15624071
156250     END-IF.                                                      15625071
156260                                                                  15626071
156270     MOVE  ZEROES  TO  PV-TOT-REMAINDER.                          15627071
156280                                                                  15628071
156290*----------------------------------------------------------------*15629071
156300* IF SPLIT PROCESSING AND DC/RTV MAKE SURE THAT DISTRIBUTION IS  *15630071
156310* DIVISIBLE BY OUTER-PACK                                        *15631071
156320*----------------------------------------------------------------*15632071
156330 4353-CK-DC-RTV-OTPK-DISTRO.                                      15633071
156340     IF  ASC-OUTER-PACK-QTY (ASC-BLK-SUB ASC-ITEM-SUB) > ZERO     15634071
156350         DIVIDE  PV-EXPTED-ITM-QTY                                15635071
156360             BY  ASC-OUTER-PACK-QTY (ASC-BLK-SUB ASC-ITEM-SUB)    15636071
156370         GIVING  PV-OUT-ANSWER                                    15637071
156380             REMAINDER PV-OUT-REMAINDER                           15638071
156390         END-DIVIDE                                               15639071
156400         IF  PV-OUT-REMAINDER  >  ZEROES                          15640071
156410             IF  ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       15641071
156420                 SET ASC-INVALID-OTPK-YES                         15642071
156430                    ASC-LNE-BAD-OTPK-Y (ASC-BLK-SUB ASC-ITEM-SUB) 15643071
156440                     PS-DC-RTV-DISTRO-ERROR    TO TRUE            15644071
156450             END-IF                                               15645071
156460         END-IF                                                   15646071
156470     END-IF.                                                      15647071
156480                                                                  15648071
156490                                                                  15649071
156500*----------------------------------------------------------------*15650071
156510* IF FULL CASE PROCESSING DESIRED MAKE SURE OUTER PACK QUANTITY  *15651071
156520* IS DIVISIBLE BY ITEMS EXPECTED.                                *15652071
156530*----------------------------------------------------------------*15653071
156540 4360-CK-OTPK-EXPTD-ITEM.                                         15654071
156550                                                                  15655071
156560     IF  ASC-IN-PAK-CONVEY-NO (ASC-BLK-SUB ASC-ITEM-SUB)          15656071
156570         IF  ASC-OUTER-PACK-QTY (ASC-BLK-SUB ASC-ITEM-SUB) > ZERO 15657071
156580                 DIVIDE PV-EXPTED-ITM-QTY                         15658071
156590                     BY ASC-OUTER-PACK-QTY                        15659071
156600                              (ASC-BLK-SUB ASC-ITEM-SUB)          15660071
156610                 GIVING PV-OUT-ANSWER                             15661071
156620                     REMAINDER PV-OUT-REMAINDER                   15662071
156630                 END-DIVIDE                                       15663071
156640             IF PV-OUT-REMAINDER > ZERO AND                       15664071
156650                 ASC-ODD-CARTON (ASC-BLK-SUB ASC-ITEM-SUB) > ZERO 15665071
156660                                                               AND15666071
156670                 ASC-FCSE-ODD-CRTN-USED (ASC-BLK-SUB ASC-ITEM-SUB)15667071
156680                     SUBTRACT ASC-ODD-CARTON                      15668071
156690                               (ASC-BLK-SUB ASC-ITEM-SUB)         15669071
156700                         FROM PV-EXPTED-ITM-QTY                   15670071
156710                       GIVING PV-EXPTED-QTY-LESS-ODD              15671071
156720                     DIVIDE PV-EXPTED-QTY-LESS-ODD                15672071
156730                         BY ASC-OUTER-PACK-QTY                    15673071
156740                                  (ASC-BLK-SUB ASC-ITEM-SUB)      15674071
156750                     GIVING PV-OUT-ANSWER                         15675071
156760                         REMAINDER PV-OUT-REMAINDER               15676071
156770                     END-DIVIDE                                   15677071
156780             END-IF                                               15678071
156790             IF  ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       15679071
156800               IF  PV-OUT-REMAINDER  >  ZEROES                    15680071
156810                 SET ASC-INVALID-OTPK-YES                         15681071
156820                    ASC-LNE-BAD-OTPK-Y (ASC-BLK-SUB ASC-ITEM-SUB) 15682071
156830                                           TO TRUE                15683071
156840               END-IF                                             15684071
156850             END-IF                                               15685071
156860         END-IF                                                   15686071
156870     END-IF.                                                      15687071
156880                                                                  15688071
156890     IF  ASC-IN-PAK-CONVEY-YES (ASC-BLK-SUB ASC-ITEM-SUB)         15689071
156900         IF  ASC-INNER-PACK-QTY (ASC-BLK-SUB ASC-ITEM-SUB) >  1   15690071
156910             DIVIDE  PV-EXPTED-ITM-QTY                            15691071
156920                 BY  ASC-INNER-PACK-QTY (ASC-BLK-SUB ASC-ITEM-SUB)15692071
156930             GIVING  PV-ANSWER                                    15693071
156940                 REMAINDER PV-EXPT-REMAINDER                      15694071
156950         END-DIVIDE                                               15695071
156960             IF  PV-EXPT-REMAINDER  >  ZEROES                     15696071
156970                 SET ASC-INVALID-INPK-YES                         15697071
156980                    ASC-LNE-BAD-INPK-Y (ASC-BLK-SUB ASC-ITEM-SUB) 15698071
156990                                           TO TRUE                15699071
157000                 MOVE  PV-EXPTED-ITM-QTY                          15700071
157010                   TO  ASC-DISPLAY-ITM-QTY                        15701071
157020                       (ASC-BLK-SUB ASC-ITEM-SUB)                 15702071
157030                 MOVE  PV-NBR-OF-STORES                           15703071
157040                   TO  ASC-DISPLAY-STORE-CNT                      15704071
157050                       (ASC-BLK-SUB ASC-ITEM-SUB)                 15705071
157060             END-IF                                               15706071
157070         END-IF                                                   15707071
157080     END-IF.                                                      15708071
157090                                                                  15709071
157100                                                                  15710071
157110*----------------------------------------------------------------*15711071
157120* VERIFY THAT OUTERPACK QTY IS DIVISIBLE BY INNERPACK QTY        *15712071
157130*----------------------------------------------------------------*15713071
157140 4365-VERIFY-INNER-OUTER-PACK.                                    15714071
157150                                                                  15715071
157160     IF  ASC-LNE-UCC128-YES     (ASC-BLK-SUB ASC-ITEM-SUB)        15716071
157170         IF  PC166-ERR-OTPK-BY-INPK                               15717071
157180             MOVE  1       TO  PV-IN-OUT-REMAINDER                15718071
157190         ELSE                                                     15719071
157200             MOVE  ZEROES  TO  PV-IN-OUT-REMAINDER                15720071
157210         END-IF                                                   15721071
157220     ELSE                                                         15722071
157230         DIVIDE  ASC-INNER-PACK-QTY (ASC-BLK-SUB ASC-ITEM-SUB)    15723071
157240           INTO  ASC-OUTER-PACK-QTY (ASC-BLK-SUB ASC-ITEM-SUB)    15724071
157250         GIVING  PV-IN-OUT-PK-RESULT                              15725071
157260         REMAINDER PV-IN-OUT-REMAINDER                            15726071
157270     END-IF.                                                      15727071
157280                                                                  15728071
157290     IF  PV-IN-OUT-REMAINDER = ZERO                               15729071
157300         CONTINUE                                                 15730071
157310     ELSE                                                         15731071
157320         SET PS-ERROR                                             15732071
157330             DP020-MSG-FATAL                                      15733071
157340             PS-BLOCK-ERROR  TO  TRUE                             15734071
157350         IF  ASC-PRE-PACK-ORDER                                   15735071
157360             MOVE PC-TSYMSG-02445      TO DP020-MSG-NUMBER        15736071
157370         ELSE                                                     15737071
157380             MOVE PC-TSYMSG-01000      TO DP020-MSG-NUMBER        15738071
157390         END-IF                                                   15739071
157400         MOVE DP015-UNP-ALP-BRT-OFF    TO MR-INNER-PACKA (PV-SUB) 15740071
157410                                          MR-OUTER-PACKA (PV-SUB) 15741071
157420         MOVE DP015-RED                TO MR-INNER-PACKC (PV-SUB) 15742071
157430                                          MR-OUTER-PACKC (PV-SUB) 15743071
157440         MOVE DP015-REVERSE            TO MR-INNER-PACKH (PV-SUB) 15744071
157450                                          MR-OUTER-PACKH (PV-SUB) 15745071
157460         IF  ASC-LNE-UCC128-YES     (ASC-BLK-SUB ASC-ITEM-SUB)    15746071
157470             MOVE -1                   TO MR-INNER-PACKL (PV-SUB) 15747071
157480         ELSE                                                     15748071
157490             MOVE -1                   TO MR-OUTER-PACKL (PV-SUB) 15749071
157500         END-IF                                                   15750071
157510         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      15751071
157520     END-IF.                                                      15752071
157530                                                                  15753071
157540                                                                  15754071
157550*----------------------------------------------------------------*15755071
157560* VERIFY THAT ODD CARTON QTY IS DIVISIBLE BY INNERPACK QTY       *15756071
157570*----------------------------------------------------------------*15757071
157580 4366-VERIFY-ODD-INNER-PACK.                                      15758071
157590                                                                  15759071
157600     DIVIDE  ASC-INNER-PACK-QTY (ASC-BLK-SUB ASC-ITEM-SUB)        15760071
157610       INTO  ASC-ODD-CARTON (ASC-BLK-SUB ASC-ITEM-SUB)            15761071
157620     GIVING  PV-ODD-IN-PK-RESULT REMAINDER PV-ODD-IN-REMAINDER.   15762071
157630                                                                  15763071
157640     IF  PV-ODD-IN-REMAINDER = ZERO                               15764071
157650         CONTINUE                                                 15765071
157660     ELSE                                                         15766071
157670         SET PS-ERROR                                             15767071
157680             DP020-MSG-FATAL                                      15768071
157690             PS-BLOCK-ERROR  TO  TRUE                             15769071
157700         MOVE PC-TSYMSG-02000          TO DP020-MSG-NUMBER        15770071
157710         MOVE DP015-UNP-ALP-BRT-OFF    TO MR-ODD-CARTONA (PV-SUB) 15771071
157720                                          MR-INNER-PACKA (PV-SUB) 15772071
157730         MOVE DP015-RED                TO MR-ODD-CARTONC (PV-SUB) 15773071
157740                                          MR-INNER-PACKC (PV-SUB) 15774071
157750         MOVE DP015-REVERSE            TO MR-ODD-CARTONH (PV-SUB) 15775071
157760                                          MR-INNER-PACKH (PV-SUB) 15776071
157770         MOVE -1                       TO MR-ODD-CARTONL (PV-SUB) 15777071
157780                                          MR-INNER-PACKL (PV-SUB) 15778071
157790         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      15779071
157800     END-IF.                                                      15780071
157810                                                                  15781071
157820*----------------------------------------------------------------*15782071
157830*  THIS MODULE DETERMINES IF THERE IS A PENDING PRICE CHANGE.     15783071
157840*  FOR THE SKU BEING REPORTED ON.                                 15784071
157850*----------------------------------------------------------------*15785071
157860 4370-DETERMINE-IF-PPC.                                           15786071
157870                                                                  15787071
157880     PERFORM 2107-GET-BEFORE-PRICE-CHG-DAYS                       15788071
157890     PERFORM 2108-GET-AFTER-PRICE-CHG-DAYS                        15789071
157900     PERFORM 4375-CALL-PRICE-CHANGE-MODULE.                       15790071
157910                                                                  15791071
157920                                                                  15792071
157930*----------------------------------------------------------------*15793071
157940*  CALL PERM PRICE CHANGE MODULE (XLKUT086)                       15794071
157950*----------------------------------------------------------------*15795071
157960 4375-CALL-PRICE-CHANGE-MODULE.                                   15796071
157970                                                                  15797071
157980     INITIALIZE XL086-PR-CHG-COMMAREA.                            15798071
157990     MOVE PV-SKU        TO XL086-KEY-SKU-NBR                      15799071
158000     MOVE DK-ITEM-NBR   TO XL086-KEY-ITM-NBR                      15800071
158100     MOVE PV-PPCBEF-QTY TO XL086-KEY-BEFORE-DAYS                  15810071
158200     MOVE PV-PPCAFT-QTY TO XL086-KEY-AFTER-DAYS                   15820071
158210                                                                  15821071
158220     CALL XL086-PR-CHG-PGM USING DFHEIBLK                         15822071
158230                                 XL086-COMMAREA                   15823071
158240                                 XL086-PR-CHG-COMMAREA.           15824071
158250                                                                  15825071
158260     EVALUATE TRUE                                                15826071
158270        WHEN XL086-SUCCESSFUL                                     15827071
158280           IF XL086-PPC-DOC-FOUND                                 15828071
158290              SET ASC-PPC-EXISTS (ASC-BLK-SUB ASC-ITEM-SUB)       15829071
158300                  ASC-HILITE-LNE-ST                               15830071
158310                                 (ASC-BLK-SUB ASC-ITEM-SUB)       15831071
158320                  TO TRUE                                         15832071
158330           ELSE                                                   15833071
158340              SET ASC-NOT-PPC-EXISTS                              15834071
158350                                 (ASC-BLK-SUB ASC-ITEM-SUB)       15835071
158360                  ASC-NOT-HILITE-LNE-ST                           15836071
158370                                 (ASC-BLK-SUB ASC-ITEM-SUB)       15837071
158380                  TO TRUE                                         15838071
158390           END-IF                                                 15839071
158400        WHEN XL086-SQL-ERROR                                      15840071
158410              SET ASC-NOT-PPC-EXISTS                              15841071
158420                                 (ASC-BLK-SUB ASC-ITEM-SUB)       15842071
158430                  ASC-NOT-HILITE-LNE-ST                           15843071
158440                                 (ASC-BLK-SUB ASC-ITEM-SUB)       15844071
158450                  TO TRUE                                         15845071
158460     END-EVALUATE.                                                15846071
158470                                                                  15847071
158480                                                                  15848071
158490*----------------------------------------------------------------*15849071
158500* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *15850071
158600*----------------------------------------------------------------*15860071
158700 4400-MOVE-COMMAREA-TO-SCREEN.                                    15870071
158800                                                                  15880071
158900     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             15890071
159000         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          15900071
159100         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          15910071
159200             MOVE +1    TO ASC-BLK-SUB                            15920071
159300             PERFORM 5100-WRITE-TEMP-STORAGE                      15930071
159400             ADD +1     TO ASC-BLK-SUB                            15940071
159500             PERFORM 5100-WRITE-TEMP-STORAGE                      15950071
159600             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             15960071
159700                 GIVING PV-BLOCK-NUMBER                           15970071
159800                 REMAINDER PV-REMAINDER                           15980071
159900             IF  PV-REMAINDER > ZERO                              15990071
160000                 ADD +1 TO PV-BLOCK-NUMBER                        16000071
160100             END-IF                                               16010071
160200             MOVE +1    TO ASC-BLK-SUB                            16020071
160300             PERFORM 4410-READ-TEMP-STORAGE                       16030071
160400             ADD +1     TO ASC-BLK-SUB                            16040071
160500                           PV-BLOCK-NUMBER                        16050071
160600             PERFORM 4410-READ-TEMP-STORAGE                       16060071
160700     END-IF.                                                      16070071
160800     MOVE +1            TO ASC-BLK-SUB.                           16080071
160900     COMPUTE ASC-ITEM-SUB =                                       16090071
161000         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              16100071
161100         + PC-ITEMS-PER-PANEL).                                   16110071
161200                                                                  16120071
161210     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        16121071
161220         ADD +1         TO ASC-BLK-SUB                            16122071
161230         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            16123071
161240     END-IF.                                                      16124071
161250                                                                  16125071
161260     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           16126071
161270         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                16127071
161280     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        16128071
161290     PERFORM 4420-FORMAT-LIST-LINES                               16129071
161300         VARYING PV-SUB                                           16130071
161310         FROM PC-ITEMS-PER-PANEL BY -1                            16131071
161320         UNTIL PV-SUB < +1.                                       16132071
161330                                                                  16133071
161340     COMPUTE ASC-ITEMS-DISPLAYED =                                16134071
161350         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          16135071
161360     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    16136071
161370                                      ASTRTITO.                   16137071
161380     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    16138071
161390     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    16139071
161400     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            16140071
161410                                   TO ASELITO.                    16141071
161420                                                                  16142071
161430     PERFORM 4405-GET-VENDOR-NAME.                                16143071
161440     MOVE ASC-OPER-UNT-ID          TO PV-EDIT-OPER.               16144071
161450     MOVE ASC-FCLTY-ID             TO PV-EDIT-FCLTY.              16145071
161460     MOVE PV-EDIT-OPER-FCLTY       TO AOPERO.                     16146071
161470                                                                  16147071
161480     MOVE  ASC-CRE-LBL-IND         TO ALBLOPTO.                   16148071
161490     MOVE  ASC-LBL-PRT-ORDER       TO AORDERO.                    16149071
161500                                                                  16150071
161510                                                                  16151071
161520     MOVE ASC-PO-NBR               TO PV-EDIT-PO.                 16152071
161530     MOVE ASC-REC-SEQ-NBR          TO PV-EDIT-RCVR.               16153071
161540     MOVE PV-EDIT-PO-RCVR          TO APORCVO.                    16154071
161550     MOVE ASC-SEASET-SHRT-NME      TO ASEASETO.                   16155071
161560     MOVE ASC-DFLT-STR-ZN-ID       TO AZONEO.                     16156071
161570     MOVE ASC-SML-P2L-PRTR-ID      TO MDEST1O.                    16157071
161580     MOVE ASC-PGYBCK-PRTR-ID       TO MDEST2O.                    16158071
161590     MOVE PV-VENDOR-NAME           TO AVNDRO.                     16159071
161600     MOVE ASC-PRT-HEAD-FOOT        TO AHDRFTO.                    16160071
161610     MOVE ASC-FCSE-AREA-ID         TO MCSEPKO.                    16161071
161620     MOVE ASC-MODU-NBR             TO AP2LMODO.                   16162071
161630                                                                  16163071
161640                                                                  16164071
161650     IF  ASC-SEASET-YELLOW                                        16165071
161660         MOVE DP015-YELLOW         TO ASEASETC                    16166071
161670         MOVE ZEROES               TO MMOD1O                      16167071
161680                                      MMOD2O                      16168071
161690                                      MMOD3O                      16169071
161700                                      MMOD4O                      16170071
161710                                      MMOD5O                      16171071
161720     END-IF                                                       16172071
161730                                                                  16173071
161740     IF  ASC-DSP-INNER-PREPK                                      16174071
161750         MOVE  PC-INNER-PREPACK    TO MPKGCDO                     16175071
161760     ELSE                                                         16176071
161770     IF  ASC-DSP-MULTI-SKU-PREPK                                  16177071
161780         MOVE  PC-MULTI-SKU        TO MPKGCDO                     16178071
161790     ELSE                                                         16179071
161800     IF  ASC-DSP-SINGLE-SKU-PREPK                                 16180071
161810         MOVE  PC-SINGLE-SKU       TO MPKGCDO                     16181071
161820     ELSE                                                         16182071
161830     IF  ASC-DSP-CASEPACK                                         16183071
161840         MOVE  PC-CASEPACK         TO MPKGCDO                     16184071
161850     ELSE                                                         16185071
161860     IF  ASC-DSP-BULK-PACK                                        16186071
161870         MOVE  PC-BULK             TO MPKGCDO                     16187071
161880     END-IF                                                       16188071
161890     END-IF                                                       16189071
161900     END-IF                                                       16190071
161910     END-IF                                                       16191071
161920     END-IF.                                                      16192071
161930     IF  ASC-DSP-PRE-PACK-ORDER                                   16193071
161940         MOVE DP015-YELLOW         TO MPKGCDC                     16194071
161950     END-IF.                                                      16195071
161960                                                                  16196071
161970     IF  ASC-PRE-PACK-ORDER                                       16197071
161980         MOVE PC-PACK-HDG-2        TO APKSKU2O                    16198071
161990         MOVE SPACES               TO AINRAT1O                    16199071
162000         MOVE PC-RATIO-HDG-2       TO AINRAT2O                    16200071
162010     ELSE                                                         16201071
162020         MOVE DP015-WHITE          TO APKSKU2C                    16202071
162030                                      AINRAT1C                    16203071
162040                                      AINRAT2C                    16204071
162050         MOVE PC-SKU-HDG-2         TO APKSKU2O                    16205071
162060         MOVE PC-INPK-HDG-1        TO AINRAT1O                    16206071
162070         MOVE PC-INPK-HDG-2        TO AINRAT2O                    16207071
162080     END-IF.                                                      16208071
162090                                                                  16209071
162100     IF  ASC-UCC128-AVAIL-NO                                      16210071
162110         MOVE  PC-NO-UCC128-AVAIL  TO AUSE128O                    16211071
162120         MOVE  DP015-BLUE          TO AUSE128C                    16212071
162130         MOVE  'N'                 TO A128YNO                     16213071
162140         MOVE  DP015-BLUE          TO A128YNC                     16214071
162150         MOVE  DP015-ASK-NOR-OFF   TO A128YNA                     16215071
162160     ELSE                                                         16216071
162170         IF ASC-AUTOVE-PARM-YES                                   16217071
162180             MOVE  PC-USE-UCC128       TO AUSE128O                16218071
162190             MOVE  DP015-YELLOW        TO AUSE128C                16219071
162200             MOVE  'Y'                 TO A128YNO                 16220071
162210             MOVE  DP015-BLUE          TO A128YNC                 16221071
162220             MOVE  DP015-ASK-NOR-MDT   TO A128YNA                 16222071
162230         ELSE                                                     16223071
162240         IF  ASC-USE-UCC128-YES                                   16224071
162250             MOVE  PC-USE-UCC128       TO AUSE128O                16225071
162260             MOVE  DP015-YELLOW        TO AUSE128C                16226071
162270             MOVE  'Y'                 TO A128YNO                 16227071
162280         ELSE                                                     16228071
162290            IF  ASC-USE-UCC128-NO OR ASC-USE-UCC128-IGNORE        16229071
162300                MOVE  PC-IGNORE-UCC128    TO AUSE128O             16230071
162310                MOVE  DP015-YELLOW        TO AUSE128C             16231071
162320                MOVE  'N'                 TO A128YNO              16232071
162330            END-IF                                                16233071
162340         END-IF                                                   16234071
162350         END-IF                                                   16235071
162360     END-IF.                                                      16236071
162370                                                                  16237071
162380     IF  DP020-FK-SELECT-ALL(DP020-SRC-AID)                       16238071
162390         MOVE -1                   TO ASEL01L                     16239071
162400     END-IF.                                                      16240071
162410                                                                  16241071
162420     IF  DP020-MSG-NUMBER-X = SPACE                               16242071
162430         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  16243071
162440*            --- MORE ITEMS TO DISPLAY ----                       16244071
162450             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            16245071
162460             SET DP020-MSG-INFORMATIONAL TO TRUE                  16246071
162470         END-IF                                                   16247071
162480     END-IF.                                                      16248071
162490                                                                  16249071
162500                                                                  16250071
162510*----------------------------------------------------------------*16251071
162520* GET VENDOR NAME FOR PO/RECEIVER TO DISPLAY ON SCREEN           *16252071
162530*----------------------------------------------------------------*16253071
162540 4405-GET-VENDOR-NAME.                                            16254071
162550     EXEC SQL                                                     16255071
162560         SELECT ENT_NAME_DESC                                     16256071
162570           INTO :ENTNME-ENT-NAME-DESC                             16257071
162580           FROM TPURCHS A,                                        16258071
162590                TENTNME B                                         16259071
162600          WHERE A.PO_NBR         =  :ASC-PO-NBR                   16260071
162610            AND A.VER_STATUS_CDE =  'A'                           16261071
162620            AND A.ENT_ID         =   B.ENT_ID                     16262071
162630            AND B.TYPE_CDE       =  :PC-01                        16263071
162640     END-EXEC                                                     16264071
162650                                                                  16265071
162660     EVALUATE TRUE                                                16266071
162670         WHEN SQLCODE = +0                                        16267071
162680             MOVE  ENTNME-ENT-NAME-DESC TO  PV-VENDOR-NAME        16268071
162690         WHEN SQLCODE = +100                                      16269071
162700             MOVE  SPACES          TO  PV-VENDOR-NAME             16270071
162710         WHEN SQLCODE = -904                                      16271071
162720         WHEN SQLCODE = -911                                      16272071
162730         WHEN SQLCODE = -913                                      16273071
162740                                                                  16274071
162750             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   16275071
162760             MOVE '4405-GET-VENDOR-NAME'     TO PV-SOFT-PARAGRAPH 16276071
162770             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 16277071
162780             MOVE LENGTH OF PV-CICS-MSG-AREA2                     16278071
162790               TO PV-COMMAREA-LENGTH                              16279071
162800             EXEC CICS                                            16280071
162810                  WRITEQ TD                                       16281071
162820                   QUEUE  ('CSSL')                                16282071
162830                    FROM  (PV-CICS-MSG-AREA2)                     16283071
162840                  LENGTH  (PV-COMMAREA-LENGTH)                    16284071
162850                    RESP  (PV-CICS-RESP)                          16285071
162860             END-EXEC                                             16286071
162870                                                                  16287071
162880             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          16288071
162890             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              16289071
162900             PERFORM 9900-SOFT-ABORT                              16290071
162910         WHEN SQLWARN0 NOT = SPACES                               16291071
162920         WHEN SQLCODE < ZERO                                      16292071
162930         WHEN SQLCODE > ZERO                                      16293071
162940             MOVE '4405-GET-DEPARTMENT'                           16294071
162950                               TO DP013-PARAGRAPH                 16295071
162960             MOVE 'GET VENDOR NAME FOR PO/RECEIVER '              16296071
162970                               TO DP013-MESSAGE-TEXT (1)          16297071
162980             MOVE SQLCA        TO DP013-SQLCA                     16298071
162990             MOVE 'TPURCHS'    TO DP013-DB2-TABLE-NAME (1)        16299071
163000             SET DP013-DB2-ABEND                                  16300071
163010                 DP013-XCTL-DISPLAY-RESTART                       16301071
163020                               TO TRUE                            16302071
163030             PERFORM DP013-0000-PROCESS-ABEND                     16303071
163040     END-EVALUATE.                                                16304071
163050                                                                  16305071
163060                                                                  16306071
163070*----------------------------------------------------------------*16307071
163080*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *16308071
163090*----------------------------------------------------------------*16309071
163100 4410-READ-TEMP-STORAGE.                                          16310071
163110                                                                  16311071
163120     EXEC CICS                                                    16312071
163130         READQ TS                                                 16313071
163140             QUEUE (ASC-LIST-QUEUE-NAME)                          16314071
163150             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               16315071
163160             ITEM  (PV-BLOCK-NUMBER)                              16316071
163170             RESP  (PV-CICS-RESP)                                 16317071
163180     END-EXEC.                                                    16318071
163190                                                                  16319071
163200     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       16320071
163210       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     16321071
163220         CONTINUE                                                 16322071
163230     ELSE                                                         16323071
163240         SET DP013-CICS-ABEND     TO TRUE                         16324071
163250         SET DP013-NO-ROLLBACK    TO TRUE                         16325071
163260         MOVE '4410-READ-TEMP-STORAGE'                            16326071
163270                                  TO DP013-PARAGRAPH              16327071
163280         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      16328071
163290                                  TO DP013-MESSAGE-TEXT(1)        16329071
163300         PERFORM DP013-0000-PROCESS-ABEND                         16330071
163310     END-IF.                                                      16331071
163320                                                                  16332071
163330     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             16333071
163340                                                                  16334071
163350     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         16335071
163360         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               16336071
163370     END-IF.                                                      16337071
163380                                                                  16338071
163390                                                                  16339071
163400*----------------------------------------------------------------*16340071
163410*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *16341071
163420*----------------------------------------------------------------*16342071
163430 4420-FORMAT-LIST-LINES.                                          16343071
163440     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      16344071
163450         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                16345071
163460         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           16346071
163470                                    MR-PROCESS-QTYA (PV-SUB)      16347071
163480                                    MR-TRANSCRIB-QTYA (PV-SUB)    16348071
163490                                    MR-P2L-LBL-CNTA (PV-SUB)      16349071
163500                                    MR-SHP-LBL-CNTA (PV-SUB)      16350071
163510                                    MR-MODA (PV-SUB)              16351071
163520                                    MR-CARTON-CNTA (PV-SUB)       16352071
163530                                    MR-INNER-PACKA (PV-SUB)       16353071
163540                                    MR-OUTER-PACKA (PV-SUB)       16354071
163550                                    MR-IN-PCK-CONVYA (PV-SUB)     16355071
163560                                    MR-LBL-TYPEA (PV-SUB)         16356071
163570                                    MR-CRE-LBL-OPTA(PV-SUB)       16357071
163580                                    MR-CSEPK-AREAA(PV-SUB)        16358071
163590                                    MR-ODD-CARTONA (PV-SUB)       16359071
163600                                                                  16360071
163610         MOVE SPACE              TO MR-SELECTI (PV-SUB)           16361071
163620         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           16362071
163630                                    MR-MODH (PV-SUB)              16363071
163640                                    MR-CARTON-CNTH (PV-SUB)       16364071
163650                                    MR-INNER-PACKH (PV-SUB)       16365071
163660                                    MR-OUTER-PACKH (PV-SUB)       16366071
163670                                    MR-IN-PCK-CONVYH (PV-SUB)     16367071
163680                                    MR-LBL-TYPEH (PV-SUB)         16368071
163690                                    MR-CRE-LBL-OPTH (PV-SUB)      16369071
163700                                    MR-CSEPK-AREAH (PV-SUB)       16370071
163710                                    MR-ODD-CARTONH (PV-SUB)       16371071
163720                                                                  16372071
163730         MOVE SPACE              TO MR-SELECTI (PV-SUB)           16373071
163740                                    MR-ACTION (PV-SUB)            16374071
163750                                    MR-SKU (PV-SUB)               16375071
163760                                    MR-OUTER-PACK (PV-SUB)        16376071
163770                                    MR-IN-PCK-CONVY (PV-SUB)      16377071
163780                                    MR-LBL-TYPE (PV-SUB)          16378071
163790                                    MR-CRE-LBL-OPT (PV-SUB)       16379071
163800                                    MR-CSEPK-AREA (PV-SUB)        16380071
163810                                    MR-LINE-STATUS (PV-SUB)       16381071
163820                                                                  16382071
163830         MOVE ZEROES             TO MR-PO-LINE (PV-SUB)           16383071
163840                                    MR-MOD (PV-SUB)               16384071
163850                                    MR-CARTON-CNT (PV-SUB)        16385071
163860                                    MR-INNER-PACK (PV-SUB)        16386071
163870                                    MR-PROCESS-QTY (PV-SUB)       16387071
163880                                    MR-TRANSCRIB-QTY (PV-SUB)     16388071
163890                                    MR-P2L-LBL-CNT (PV-SUB)       16389071
163900                                    MR-SHP-LBL-CNT (PV-SUB)       16390071
163910                                    MR-ODD-CARTON (PV-SUB)        16391071
163920     ELSE                                                         16392071
163930         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      16393071
163940                                                   > SPACE        16394071
163950             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 16395071
163960                                 TO MR-SELECTI (PV-SUB)           16396071
163970         ELSE                                                     16397071
163980             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      16398071
163990                                 TO MR-SELECTI (PV-SUB)           16399071
164000         END-IF                                                   16400071
164010                                                                  16401071
164020         IF  DP030-SET-CURSOR-TRAILER                             16402071
164030             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)16403071
164040                 > SPACE)                                         16404071
164050               OR (PV-SUB = 1))                                   16405071
164060                SET DP030-SET-CURSOR-APPL-1 TO TRUE               16406071
164070                MOVE -1          TO MR-SELECTL (PV-SUB)           16407071
164080             END-IF                                               16408071
164090         END-IF                                                   16409071
164100                                                                  16410071
164110         IF  ASC-LNE-CRE-P2L-LBL(ASC-BLK-SUB ASC-ITEM-SUB)        16411071
164120             MOVE DP015-ASK-NOR-OFF  TO  MR-OUTER-PACKA (PV-SUB)  16412071
164130                                         MR-IN-PCK-CONVYA (PV-SUB)16413071
164140                                         MR-ODD-CARTONA (PV-SUB)  16414071
164150             MOVE DP015-BLUE         TO  MR-OUTER-PACKC (PV-SUB)  16415071
164160                                         MR-IN-PCK-CONVYC (PV-SUB)16416071
164170                                         MR-ODD-CARTONC (PV-SUB)  16417071
164180             MOVE DP015-HL-OFF       TO  MR-OUTER-PACKH (PV-SUB)  16418071
164190                                         MR-IN-PCK-CONVYH (PV-SUB)16419071
164200                                         MR-ODD-CARTONH (PV-SUB)  16420071
164210         END-IF                                                   16421071
164220         IF  ASC-LNE-CRE-SML-LBL (ASC-BLK-SUB ASC-ITEM-SUB)       16422071
164230             MOVE DP015-ASK-NOR-OFF  TO  MR-MODA (PV-SUB)         16423071
164240             MOVE DP015-BLUE         TO  MR-MODC (PV-SUB)         16424071
164250             MOVE DP015-HL-OFF       TO  MR-MODH (PV-SUB)         16425071
164260             MOVE DP015-UNP-ALP-NOR-OFF                           16426071
164270                                     TO  MR-LBL-TYPEA (PV-SUB)    16427071
164280                                         MR-IN-PCK-CONVYA (PV-SUB)16428071
164290             MOVE DP015-GREEN        TO  MR-LBL-TYPEC (PV-SUB)    16429071
164300                                         MR-IN-PCK-CONVYC (PV-SUB)16430071
164310             MOVE DP015-UNDERLINE    TO  MR-LBL-TYPEH (PV-SUB)    16431071
164320                                         MR-IN-PCK-CONVYH (PV-SUB)16432071
164330         END-IF                                                   16433071
164340         IF  ASC-LNE-CRE-BOTH-LBL (ASC-BLK-SUB ASC-ITEM-SUB)      16434071
164350             MOVE DP015-UNP-ALP-NOR-OFF                           16435071
164360                                     TO  MR-LBL-TYPEA (PV-SUB)    16436071
164370                                         MR-IN-PCK-CONVYA (PV-SUB)16437071
164380             MOVE DP015-GREEN        TO  MR-LBL-TYPEC (PV-SUB)    16438071
164390                                         MR-IN-PCK-CONVYC (PV-SUB)16439071
164400             MOVE DP015-UNDERLINE    TO  MR-LBL-TYPEH (PV-SUB)    16440071
164410                                         MR-IN-PCK-CONVYH (PV-SUB)16441071
164420         END-IF                                                   16442071
164430                                                                  16443071
164440         IF  DP020-NEXT-ACT-RETURN  AND                           16444071
164450             ASC-ACTION(ASC-BLK-SUB ASC-ITEM-SUB) > SPACE         16445071
164460             PERFORM 3305-EDIT-LINES                              16446071
164470             IF  ASC-LNE-DO-NOT-PRT-LBL                           16447071
164480                (ASC-BLK-SUB ASC-ITEM-SUB)                        16448071
164490                 IF  DISTHD-FCSE-LBL-TYP-CDE  >  SPACE            16449071
164500                     MOVE  DISTHD-FCSE-LBL-TYP-CDE                16450071
164510                       TO  ASC-LBL-TYP(ASC-BLK-SUB ASC-ITEM-SUB)  16451071
164520                 END-IF                                           16452071
164530             END-IF                                               16453071
164540         END-IF                                                   16454071
164550                                                                  16455071
164560         IF  DP020-NEXT-ACT-READ-MAP AND                          16456071
164570             ASC-ACTION(ASC-BLK-SUB ASC-ITEM-SUB) > SPACE         16457071
164580             PERFORM 3305-EDIT-LINES                              16458071
164590         END-IF                                                   16459071
164600                                                                  16460071
164610         MOVE ASC-ACTION        (ASC-BLK-SUB ASC-ITEM-SUB)        16461071
164620                                 TO MR-ACTION (PV-SUB)            16462071
164630         MOVE ASC-PO-LNE-NBR    (ASC-BLK-SUB ASC-ITEM-SUB)        16463071
164640                                 TO MR-PO-LINE (PV-SUB)           16464071
164650         IF  ASC-PRE-PACK-ORDER                                   16465071
164660             MOVE ASC-PREPK-ID (ASC-BLK-SUB ASC-ITEM-SUB)         16466071
164670                                 TO PV-DSPLY-PREPK-ID             16467071
164680             MOVE PV-DSPLY-PREPK TO MR-SKU (PV-SUB)               16468071
164690             MOVE DP015-YELLOW   TO MR-SKUC (PV-SUB)              16469071
164700         ELSE                                                     16470071
164710             MOVE ASC-SKU       (ASC-BLK-SUB ASC-ITEM-SUB)        16471071
164720                                 TO PV-SKU                        16472071
164730             MOVE PV-SKU         TO MR-SKU (PV-SUB)               16473071
164740         END-IF                                                   16474071
164750                                                                  16475071
164760         MOVE ASC-MODULE (ASC-BLK-SUB ASC-ITEM-SUB)               16476071
164770                                 TO MR-MOD (PV-SUB)               16477071
164780         MOVE ASC-CARTON-COUNT  (ASC-BLK-SUB ASC-ITEM-SUB)        16478071
164790                                 TO MR-CARTON-CNT (PV-SUB)        16479071
164800                                                                  16480071
164810         IF  ASC-PRE-PACK-ORDER                                   16481071
164820             MOVE DP015-YELLOW   TO MR-INNER-PACKC (PV-SUB)       16482071
164830             MOVE DP015-HL-OFF   TO MR-INNER-PACKH (PV-SUB)       16483071
164840             MOVE DP015-ASK-NOR-OFF                               16484071
164850                                 TO MR-INNER-PACKA (PV-SUB)       16485071
164860             MOVE ASC-PREPK-RATIO  (ASC-BLK-SUB ASC-ITEM-SUB)     16486071
164870                                 TO MR-INNER-PACK (PV-SUB)        16487071
164880         ELSE                                                     16488071
164890             MOVE ASC-INNER-PACK-QTY  (ASC-BLK-SUB ASC-ITEM-SUB)  16489071
164900                                 TO MR-INNER-PACK (PV-SUB)        16490071
164910         END-IF                                                   16491071
164920                                                                  16492071
164930         IF  ASC-MLT-OTPK-UCC128 (ASC-BLK-SUB ASC-ITEM-SUB)       16493071
164940             MOVE ASC-OUTER-PACK-QTY-X (ASC-BLK-SUB ASC-ITEM-SUB) 16494071
164950                                 TO MR-OUTER-PACK (PV-SUB)        16495071
164960         ELSE                                                     16496071
164970             MOVE ASC-OUTER-PACK-QTY  (ASC-BLK-SUB ASC-ITEM-SUB)  16497071
164980                                 TO PV-ZERO-SUP-OTPK              16498071
164990             MOVE PV-ZERO-SUP-OTPK                                16499071
165000                                 TO MR-OUTER-PACK (PV-SUB)        16500071
165010         END-IF                                                   16501071
165020                                                                  16502071
165030         MOVE ASC-IN-PAK-CONVEY  (ASC-BLK-SUB ASC-ITEM-SUB)       16503071
165040                                 TO MR-IN-PCK-CONVY (PV-SUB)      16504071
165050         EVALUATE TRUE                                            16505071
165060             WHEN ASC-SHUFFLED-SML(ASC-BLK-SUB ASC-ITEM-SUB)      16506071
165070                 MOVE 'S'           TO MR-LBL-TYPE (PV-SUB)       16507071
165080             WHEN ASC-STORE-SML(ASC-BLK-SUB ASC-ITEM-SUB)         16508071
165090                 MOVE 'S'           TO MR-LBL-TYPE (PV-SUB)       16509071
165100             WHEN ASC-DOOR-SML(ASC-BLK-SUB ASC-ITEM-SUB)          16510071
165110                 MOVE 'S'           TO MR-LBL-TYPE (PV-SUB)       16511071
165120             WHEN ASC-STORE-PGYBK(ASC-BLK-SUB ASC-ITEM-SUB)       16512071
165130                 MOVE 'P'           TO MR-LBL-TYPE (PV-SUB)       16513071
165140             WHEN ASC-LBL-TYP-VALID(ASC-BLK-SUB ASC-ITEM-SUB)     16514071
165150                  MOVE ASC-LBL-TYP(ASC-BLK-SUB ASC-ITEM-SUB)      16515071
165160                                    TO MR-LBL-TYPE (PV-SUB)       16516071
165170         END-EVALUATE                                             16517071
165180         MOVE ASC-LNE-CRE-LBL-OPT(ASC-BLK-SUB ASC-ITEM-SUB)       16518071
165190                                 TO MR-CRE-LBL-OPT (PV-SUB)       16519071
165200         MOVE ASC-ODD-CARTON     (ASC-BLK-SUB ASC-ITEM-SUB)       16520071
165210                                 TO MR-ODD-CARTON (PV-SUB)        16521071
165220         MOVE ASC-LNE-FCSE-AREA  (ASC-BLK-SUB ASC-ITEM-SUB)       16522071
165230                                 TO MR-CSEPK-AREA (PV-SUB)        16523071
165240         MOVE ASC-PROCESS-QTY    (ASC-BLK-SUB ASC-ITEM-SUB)       16524071
165250                                 TO MR-PROCESS-QTY (PV-SUB)       16525071
165260         MOVE ASC-TRANSCRIBE-QTY  (ASC-BLK-SUB ASC-ITEM-SUB)      16526071
165270                                 TO MR-TRANSCRIB-QTY (PV-SUB)     16527071
165280         MOVE ASC-P2L-LABEL-CNT  (ASC-BLK-SUB ASC-ITEM-SUB)       16528071
165290                                 TO MR-P2L-LBL-CNT (PV-SUB)       16529071
165300         MOVE ASC-SML-LABEL-CNT  (ASC-BLK-SUB ASC-ITEM-SUB)       16530071
165310                                 TO MR-SHP-LBL-CNT (PV-SUB)       16531071
165320         MOVE ASC-LINE-STATUS   (ASC-BLK-SUB ASC-ITEM-SUB)        16532071
165330                                 TO MR-LINE-STATUS (PV-SUB)       16533071
165340         IF   ASC-LINE-STATUS   (ASC-BLK-SUB ASC-ITEM-SUB)        16534071
165350              = 'PRPK'                                            16535071
165360              MOVE DP015-YELLOW  TO MR-LINE-STATUSC (PV-SUB)      16536071
165370         ELSE                                                     16537071
165380         IF   ASC-LINE-STATUS   (ASC-BLK-SUB ASC-ITEM-SUB)        16538071
165390              =  'CSTK'                                           16539071
165400              MOVE DP015-RED     TO MR-LINE-STATUSC (PV-SUB)      16540071
165410         ELSE                                                     16541071
165420              MOVE DP015-BLUE    TO MR-LINE-STATUSC (PV-SUB)      16542071
165430         END-IF                                                   16543071
165440         END-IF                                                   16544071
165450                                                                  16545071
165460                                                                  16546071
165470         IF  ASC-NO-UPDATE (ASC-BLK-SUB ASC-ITEM-SUB)             16547071
165480             IF  ASC-RESEND-P2L-NO (ASC-BLK-SUB ASC-ITEM-SUB)     16548071
165490                 MOVE DP015-ASK-NOR-OFF                           16549071
165500                                     TO MR-MODA (PV-SUB)          16550071
165510                                        MR-LBL-TYPEA (PV-SUB)     16551071
165520                 MOVE DP015-BLUE                                  16552071
165530                                     TO MR-MODC (PV-SUB)          16553071
165540                                        MR-LBL-TYPEC (PV-SUB)     16554071
165550                 MOVE DP015-HL-OFF                                16555071
165560                                     TO MR-MODH (PV-SUB)          16556071
165570                                        MR-LBL-TYPEH (PV-SUB)     16557071
165580             END-IF                                               16558071
165590             MOVE DP015-ASK-NOR-OFF                               16559071
165600                                 TO MR-CARTON-CNTA (PV-SUB)       16560071
165610                                    MR-INNER-PACKA (PV-SUB)       16561071
165620                                    MR-OUTER-PACKA (PV-SUB)       16562071
165630                                    MR-IN-PCK-CONVYA (PV-SUB)     16563071
165640                                    MR-CRE-LBL-OPTA (PV-SUB)      16564071
165650                                    MR-CSEPK-AREAA (PV-SUB)       16565071
165660                                    MR-ODD-CARTONA (PV-SUB)       16566071
165670                                                                  16567071
165680             MOVE DP015-BLUE                                      16568071
165690                                 TO MR-CARTON-CNTC (PV-SUB)       16569071
165700                                    MR-OUTER-PACKC (PV-SUB)       16570071
165710                                    MR-IN-PCK-CONVYC (PV-SUB)     16571071
165720                                    MR-CRE-LBL-OPTC (PV-SUB)      16572071
165730                                    MR-CSEPK-AREAC (PV-SUB)       16573071
165740                                    MR-ODD-CARTONC (PV-SUB)       16574071
165750                                    MR-PO-LINEC (PV-SUB)          16575071
165760                                    MR-PROCESS-QTYC (PV-SUB)      16576071
165770                                    MR-TRANSCRIB-QTYC (PV-SUB)    16577071
165780             IF  ASC-PRE-PACK-ORDER                               16578071
165790                 MOVE DP015-YELLOW                                16579071
165800                                 TO MR-INNER-PACKC (PV-SUB)       16580071
165810                                    MR-SKUC (PV-SUB)              16581071
165820             ELSE                                                 16582071
165830                 MOVE DP015-BLUE                                  16583071
165840                                 TO MR-INNER-PACKC (PV-SUB)       16584071
165850                                    MR-SKUC (PV-SUB)              16585071
165860             END-IF                                               16586071
165870             MOVE DP015-HL-OFF                                    16587071
165880                                 TO MR-CARTON-CNTH (PV-SUB)       16588071
165890                                    MR-INNER-PACKH (PV-SUB)       16589071
165900                                    MR-OUTER-PACKH (PV-SUB)       16590071
165910                                    MR-IN-PCK-CONVYH (PV-SUB)     16591071
165920                                    MR-CRE-LBL-OPTH (PV-SUB)      16592071
165930                                    MR-CSEPK-AREAH (PV-SUB)       16593071
165940                                    MR-ODD-CARTONH (PV-SUB)       16594071
165950                                                                  16595071
165960             IF  (DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID) OR       16596071
165970                  DP020-FK-CONFIRM (DP020-SRC-AID) )              16597071
165980                 IF  PS-NO-ERROR                                  16598071
165990                     IF  ASC-PO-RCVR-DWNLD-P2L-Y  OR              16599071
166000                         ASC-PO-RCVR-TROUBLE-YES  OR              16600071
166010                         ASC-INVALID-INPK-YES     OR              16601071
166020                         ASC-INVALID-OTPK-YES     OR              16602071
166030                         ASC-INVALID-DV-RTV-OTPK  OR              16603071
166040                         ASC-INVALID-OTPK-ODD                     16604071
166050                         PERFORM 4530-CHECK-RCVR-ERROR            16605071
166060                     END-IF                                       16606071
166070                 END-IF                                           16607071
166080             END-IF                                               16608071
166090         ELSE                                                     16609071
166100         IF  ASC-CRE-LBL-NO-UPDT (ASC-BLK-SUB ASC-ITEM-SUB)       16610071
166110             MOVE DP015-ASK-NOR-OFF                               16611071
166120                                 TO MR-LBL-TYPEA (PV-SUB)         16612071
166130             MOVE DP015-BLUE                                      16613071
166140                                 TO MR-LBL-TYPEC (PV-SUB)         16614071
166150             MOVE DP015-HL-OFF                                    16615071
166160                                 TO MR-LBL-TYPEH (PV-SUB)         16616071
166170         ELSE                                                     16617071
166180             MOVE DP015-UNP-ALP-NOR-OFF                           16618071
166190                                 TO MR-SELECTA (PV-SUB)           16619071
166200             MOVE DP015-GREEN                                     16620071
166210                                 TO MR-SELECTC (PV-SUB)           16621071
166220             MOVE DP015-UNDERLINE                                 16622071
166230                                 TO MR-SELECTH (PV-SUB)           16623071
166240         END-IF                                                   16624071
166250                                                                  16625071
166260         EVALUATE TRUE                                            16626071
166270             WHEN DP020-NEXT-ACT-RETURN                           16627071
166280               IF ASC-PROCESS-QTY (ASC-BLK-SUB ASC-ITEM-SUB) =    16628071
166290                  ASC-TRANSCRIBE-QTY (ASC-BLK-SUB ASC-ITEM-SUB) OR16629071
166300                  DP020-FK-LOCAL-FUNC-09 (DP020-SRC-AID)          16630071
166310                  CONTINUE                                        16631071
166320               ELSE                                               16632071
166330               SET ASC-QTY-ERROR-YES (ASC-BLK-SUB ASC-ITEM-SUB)   16633071
166340                   TO  TRUE                                       16634071
166350               END-IF                                             16635071
166360         END-EVALUATE                                             16636071
166370                                                                  16637071
166380         IF  ASC-QTY-ERROR-YES (ASC-BLK-SUB ASC-ITEM-SUB)         16638071
166390             MOVE DP015-RED                                       16639071
166400                                   TO MR-PROCESS-QTYC (PV-SUB)    16640071
166410                                      MR-TRANSCRIB-QTYC (PV-SUB)  16641071
166420         ELSE                                                     16642071
166430             MOVE DP015-BLUE                                      16643071
166440                                   TO MR-PROCESS-QTYC (PV-SUB)    16644071
166450                                      MR-TRANSCRIB-QTYC (PV-SUB)  16645071
166460         END-IF                                                   16646071
166470         IF  ASC-HILITE-LNE-ST (ASC-BLK-SUB ASC-ITEM-SUB)         16647071
166480             MOVE DP015-PRO-BRT-MDT                               16648071
166490                                 TO MR-LINE-STATUSA(PV-SUB)       16649071
166500         END-IF                                                   16650071
166510                                                                  16651071
166520     END-IF.                                                      16652071
166530     IF  ASC-TROUBLE-ERROR (ASC-BLK-SUB ASC-ITEM-SUB)  OR         16653071
166540         ASC-LNE-TROUBLE-YES (ASC-BLK-SUB ASC-ITEM-SUB)  OR       16654071
166550         MR-LINE-STATUS(PV-SUB)  =  'NPRO'                        16655071
166560         MOVE DP015-YELLOW  TO  MR-LINE-STATUSC(PV-SUB)           16656071
166570     ELSE                                                         16657071
166580         MOVE DP015-BLUE    TO  MR-LINE-STATUSC(PV-SUB)           16658071
166590     END-IF.                                                      16659071
166600                                                                  16660071
166610     IF  ASC-P2L-RESEND-HILITE-YES (ASC-BLK-SUB ASC-ITEM-SUB)     16661071
166620         MOVE DP015-RED            TO MR-PO-LINEC (PV-SUB)        16662071
166630     ELSE                                                         16663071
166640         MOVE DP015-BLUE           TO MR-PO-LINEC (PV-SUB)        16664071
166650     END-IF.                                                      16665071
166660                                                                  16666071
166670     IF   ASC-LINE-STATUS   (ASC-BLK-SUB ASC-ITEM-SUB)            16667071
166680          = 'PRPK'                                                16668071
166690          MOVE DP015-YELLOW  TO MR-LINE-STATUSC (PV-SUB)          16669071
166700     ELSE                                                         16670071
166710     IF   ASC-LINE-STATUS   (ASC-BLK-SUB ASC-ITEM-SUB)            16671071
166720          =  'CSTK'                                               16672071
166730          MOVE DP015-RED     TO MR-LINE-STATUSC (PV-SUB)          16673071
166740     END-IF                                                       16674071
166750     END-IF.                                                      16675071
166760                                                                  16676071
166770     IF  ASC-LNE-UCC128-YES (ASC-BLK-SUB ASC-ITEM-SUB)            16677071
166780         MOVE DP015-ASK-NOR-OFF  TO MR-CARTON-CNTA   (PV-SUB)     16678071
166790                                    MR-OUTER-PACKA   (PV-SUB)     16679071
166800                                    MR-ODD-CARTONA   (PV-SUB)     16680071
166810                                    MR-LBL-TYPEA     (PV-SUB)     16681071
166820         MOVE DP015-BLUE         TO MR-CARTON-CNTC   (PV-SUB)     16682071
166830                                    MR-OUTER-PACKC   (PV-SUB)     16683071
166840                                    MR-ODD-CARTONC   (PV-SUB)     16684071
166850                                    MR-LBL-TYPEC     (PV-SUB)     16685071
166860         MOVE DP015-HL-OFF       TO MR-CARTON-CNTH   (PV-SUB)     16686071
166870                                    MR-OUTER-PACKH   (PV-SUB)     16687071
166880                                    MR-ODD-CARTONH   (PV-SUB)     16688071
166890                                    MR-LBL-TYPEH     (PV-SUB)     16689071
166900         IF  ASC-PROTECTED (ASC-BLK-SUB ASC-ITEM-SUB)             16690071
166910             CONTINUE                                             16691071
166920         ELSE                                                     16692071
166930         IF  ASC-LNE-UCC128-CRTN-MLT-LNES                         16693071
166940             (ASC-BLK-SUB ASC-ITEM-SUB)                           16694071
166950             MOVE  PC-ERR        TO MR-ACTION        (PV-SUB)     16695071
166960             MOVE DP015-RED      TO MR-ACTIONC       (PV-SUB)     16696071
166970             SET PS-UCC128-CRTN-MLT-LNE                           16697071
166980                 ASC-UCC128-MLT-LNE-YES  TO  TRUE                 16698071
166990         END-IF                                                   16699071
167000         END-IF                                                   16700071
167010     END-IF.                                                      16701071
167020                                                                  16702071
167030                                                                  16703071
167040     SUBTRACT +1 FROM ASC-ITEM-SUB                                16704071
167050     IF  ASC-ITEM-SUB < + 1                                       16705071
167060         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  16706071
167070         MOVE +1                 TO ASC-BLK-SUB                   16707071
167080     END-IF.                                                      16708071
167090                                                                  16709071
167100                                                                  16710071
167110*----------------------------------------------------------------*16711071
167120*  IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF    *16712071
167130*  RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,       *16713071
167140*  ISSUE A WARNING.                                              *16714071
167150*----------------------------------------------------------------*16715071
167160 4430-CHECK-FOR-BEGIN-AND-END.                                    16716071
167170     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       16717071
167180         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     16718071
167190*            -- NO END-OF-RANGE SPECFIED ---                      16719071
167200             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            16720071
167210             SET DP020-MSG-WARNING TO TRUE                        16721071
167220             PERFORM 4431-POSITION-AT-WARNING                     16722071
167230         END-IF                                                   16723071
167240     ELSE                                                         16724071
167250         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     16725071
167260*            -- NO BEGINNING-OF-RANGE SPECFIED ---                16726071
167270             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            16727071
167280             SET DP020-MSG-WARNING TO TRUE                        16728071
167290             PERFORM 4431-POSITION-AT-WARNING                     16729071
167300         END-IF                                                   16730071
167310     END-IF.                                                      16731071
167320                                                                  16732071
167330                                                                  16733071
167340*----------------------------------------------------------------*16734071
167350*  ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,   *16735071
167360*  DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE    *16736071
167370*  IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND         *16737071
167380*  POSITION THE CURSOR THERE.                                    *16738071
167390*----------------------------------------------------------------*16739071
167400 4431-POSITION-AT-WARNING.                                        16740071
167410     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 16741071
167420                    - PV-TOP-ITEM + 1.                            16742071
167430     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      16743071
167440         CONTINUE                                                 16744071
167450     ELSE                                                         16745071
167460         SET DP030-SET-CURSOR-APPL-1                              16746071
167470                                   TO TRUE                        16747071
167480         MOVE -1                   TO MR-SELECTL (PV-SUB)         16748071
167490         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         16749071
167500         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         16750071
167510     END-IF.                                                      16751071
167520                                                                  16752071
167530     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   16753071
167540                    - PV-TOP-ITEM + 1.                            16754071
167550     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      16755071
167560         CONTINUE                                                 16756071
167570     ELSE                                                         16757071
167580         SET DP030-SET-CURSOR-APPL-1                              16758071
167590                                   TO TRUE                        16759071
167600         MOVE -1                   TO MR-SELECTL (PV-SUB)         16760071
167610         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         16761071
167620         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         16762071
167630     END-IF.                                                      16763071
167640                                                                  16764071
167650                                                                  16765071
167660*----------------------------------------------------------------*16766071
167670*                                                                *16767071
167680*----------------------------------------------------------------*16768071
167690 4500-DELETE-DISTRIBUTION.                                        16769071
167700                                                                  16770071
167710     MOVE +1                       TO ASC-BLK-SUB.                16771071
167720     PERFORM 5100-WRITE-TEMP-STORAGE.                             16772071
167730     ADD +1                        TO ASC-BLK-SUB.                16773071
167740     PERFORM 5100-WRITE-TEMP-STORAGE.                             16774071
167750                                                                  16775071
167760     PERFORM 6112-READ-LIST-QUEUE.                                16776071
167770                                                                  16777071
167780     IF PV-CICS-RESP = DFHRESP (NORMAL)                           16778071
167790         PERFORM                                                  16779071
167800         VARYING LQW-IDX  FROM 1 BY 1                             16780071
167900         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL   OR                16790071
167910                 LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO  OR        16791071
167920                 PS-SOFT-ABORT-ERROR  OR                          16792071
167930                 PS-ERROR                                         16793071
167940             IF  LQW-SELECT (LQW-IDX)                             16794071
167950                 MOVE ASC-PO-NBR             TO DK-PO-NBR         16795071
167960                 MOVE ASC-REC-SEQ-NBR        TO DK-REC-SEQ-NBR    16796071
167970                 MOVE LQW-PO-RCVR-LINE(LQW-IDX)                   16797071
167980                                             TO DK-LINE-NBR       16798071
167990                 MOVE LQW-PREPK-ID(LQW-IDX)                       16799071
168000                                             TO DK-PREPK-ID       16800071
168010                 IF  LQW-TROUBLE-ERROR(LQW-IDX)  OR               16801071
168020                     LQW-LNE-TROUBLE-YES (LQW-IDX)                16802071
168030                         SET  LQW-DESELECT (LQW-IDX)              16803071
168040                              DP020-MSG-FATAL                     16804071
168050                              ASC-PO-RCVR-TROUBLE-YES  TO TRUE    16805071
168060                         MOVE LQW-SELECTED-SW (LQW-IDX)           16806071
168070                           TO LQW-TEMP-SELECTED-SW (LQW-IDX)      16807071
168080                         MOVE PC-TSYMSG-01769                     16808071
168090                           TO DP020-MSG-NUMBER                    16809071
168100                 ELSE                                             16810071
168110                     SET PS-DONT-DELETE          TO TRUE          16811071
168120                     PERFORM  4505-CHECK-DELETE-OK                16812071
168130                     PERFORM  4506-CHECK-FOR-MANIFESTING          16813071
168140                     IF  PS-NO-SOFT-ABORT-ERROR                   16814071
168150                         EVALUATE TRUE                            16815071
168160                         WHEN  PS-DO-DELETE                       16816071
168170                             IF  LQW-LNE-UCC128-YES (LQW-IDX)     16817071
168180                                 PERFORM 4532-LABEL-XREF          16818071
168190                             END-IF                               16819071
168200                             PERFORM  4509-CHECK-RDM-BLIND-RCVNG  16820071
168210                                                                  16821071
168220                             IF PS-NO-SOFT-ABORT-ERROR            16822071
168230                                IF PS-MANIFEST-DC-FOUND AND       16823071
168240                                   ASC-RECLAIM-DC-YES             16824071
168250                                  IF ASC-PRE-PACK-ORDER           16825071
168260                                   PERFORM 4527A-CHECK-DVRTD-CRTNS16826071
168270                                  ELSE                            16827071
168280                                   PERFORM 4527-CHECK-DVRTD-CRTNS 16828071
168290                                  END-IF                          16829071
168300                                END-IF                            16830071
168310                             END-IF                               16831071
168320                                                                  16832071
168330                             IF PS-NO-SOFT-ABORT-ERROR            16833071
168340                                PERFORM  4510-DELETE-DETAIL       16834071
168350                             END-IF                               16835071
168360                                                                  16836071
168370                             IF  PS-NO-SOFT-ABORT-ERROR           16837071
168380                                 IF  ASC-PRE-PACK-ORDER           16838071
168390                                     PERFORM  4512-DEL-PREPK-DTL  16839071
168400                                 END-IF                           16840071
168410                             END-IF                               16841071
168420                             IF  PS-NO-SOFT-ABORT-ERROR           16842071
168430                                 PERFORM 4520-DEL-UPD-HEADER      16843071
168440                             END-IF                               16844071
168450                             IF  PS-NO-SOFT-ABORT-ERROR           16845071
168460                                 IF  ASC-PRE-PACK-ORDER           16846071
168470                                     PERFORM  4522-DEL-PREPK-HDR  16847071
168480                                 END-IF                           16848071
168490                             END-IF                               16849071
168500                                                                  16850071
168510                             IF  PS-NO-SOFT-ABORT-ERROR  AND      16851071
168520                                 (PS-MANIFEST-DC-FOUND OR         16852071
168530                                  PS-BLND-RECV-SIMPL-LOC-FND)     16853071
168540                                   PERFORM 4590-SEL-INACTV-OB-CART16854071
168550                                                                  16855071
168560                                   PERFORM 4598-DELETE-RFID-DIRECT16856071
168570                                                                  16857071
168580                             END-IF                               16858071
168581                                                                  16858171
168582                             IF  LQW-LNE-UCC128-YES (LQW-IDX)     16858271
168583                                 PERFORM 4590-SEL-INACTV-OB-CART  16858371
168584                             END-IF                               16858471
168585                                                                  16858571
168586*-----------------------------------------------------------------16858671
168587* if casepack was downloaded without creating labels 'x' as       16858771
168588* create label type do not call rdm module on the delete          16858871
168589*                                                                 16858971
168590*  If casepack was downloaded using ucc128 data, do not send      16859071
168600*  delete to RDM.  The delete is sent when the carton is          16860071
168700*  reclaimed. Added UCC128 check 10/15/04 - dmh                   16870071
168710*-----------------------------------------------------------------16871071
168720                           IF PS-NO-SOFT-ABORT-ERROR              16872071
168730                            IF PS-BLND-RECV-SIMPL-LOC-FND         16873071
168740                               IF LQW-LNE-DO-NOT-PRT-LBL          16874071
168750                                              (LQW-IDX)  OR       16875071
168760                                  LQW-LBL-TYP-UCC128              16876071
168770                                              (LQW-IDX)           16877071
168780                                   CONTINUE                       16878071
168790                               END-IF                             16879071
168800                            END-IF                                16880071
168810                           END-IF                                 16881071
168820                                                                  16882071
168830                             IF  PS-NO-SOFT-ABORT-ERROR           16883071
168840                               IF  ASC-P2L-AL-DOWNLOAD-NO AND     16884071
168850                                   ASC-P2L-PCC-DOWNLOAD-NO        16885071
168860                                   CONTINUE                       16886071
168870                               ELSE                               16887071
168880                               IF LQW-P2L-DYNAPACK (LQW-IDX) AND  16888071
168890                                  ASC-P2L-AL-DOWNLOAD-YES         16889071
168900                                  IF LQW-P2L-LBL-CNT(LQW-IDX)     16890071
168910                                     > ZEROES                     16891071
168920                                    PERFORM 4950-SEND-DUMMY-TO-P2L16892071
168930                                  END-IF                          16893071
168940                               ELSE                               16894071
168950                               IF LQW-P2L-PCC (LQW-IDX) AND       16895071
168960                                  ASC-P2L-PCC-DOWNLOAD-YES        16896071
168970                                   PERFORM 4920-SEND-DELETE-TO-P2L16897071
168980                               END-IF                             16898071
168990                               END-IF                             16899071
169000                               END-IF                             16900071
169010                             END-IF                               16901071
169020                                                                  16902071
169030                             MOVE ASC-CRE-LBL-IND                 16903071
169040                               TO LQW-LNE-CRE-LBL-OPT(LQW-IDX)    16904071
169050                             IF  ASC-UCC128-AVAIL-YES AND         16905071
169060                                 ASC-USE-UCC128-YES AND           16906071
169070                                 LQW-LNE-UCC128-YES (LQW-IDX)     16907071
169080                                 PERFORM 4303-UCC128-BY-LINE-LQW  16908071
169090                             ELSE                                 16909071
169100                             IF  ASC-UCC128-AVAIL-YES AND         16910071
169200                                 ASC-USE-UCC128-IGNORE            16920071
169210                                 SET  LQW-LNE-UCC128-IGNORE       16921071
169220                                      (LQW-IDX)       TO TRUE     16922071
169230                             ELSE                                 16923071
169240                                 SET  LQW-LNE-UCC128-NO (LQW-IDX) 16924071
169250                                                      TO TRUE     16925071
169260                             END-IF                               16926071
169270                             END-IF                               16927071
169280                             IF  ASC-UCC128-AVAIL-YES AND         16928071
169290                                 ASC-USE-UCC128-YES   AND         16929071
169300                                 LQW-LNE-UCC128-YES (LQW-IDX)     16930071
169310                                 PERFORM 7305-UCC128-LBL-CNT      16931071
169320                                 MOVE  ZEROES                     16932071
169330                                   TO  LQW-ODD-CARTON (LQW-IDX)   16933071
169340                                 SET  LQW-ODD-CRTN-NONE (LQW-IDX) 16934071
169350                                      LQW-FCSE-ODD-CRTN-NOT-USED  16935071
169360                                                        (LQW-IDX) 16936071
169370                                      LQW-INPK-ODD-CRTN-NOT-USED  16937071
169380                                                        (LQW-IDX) 16938071
169390                                                        TO TRUE   16939071
169400                             END-IF                               16940071
169410                             IF  PS-NO-SOFT-ABORT-ERROR  AND      16941071
169420                                 PS-NO-ERROR                      16942071
169430                              SET LQW-DESELECT (LQW-IDX)          16943071
169440                                  LQW-DEL      (LQW-IDX)          16944071
169450                                  LQW-LNE-DOWNLOADED-NO (LQW-IDX) 16945071
169460                                  LQW-UPDATE-OK(LQW-IDX)          16946071
169470                                  LQW-NOT-PROTECTED(LQW-IDX)      16947071
169480                                              TO TRUE             16948071
169490                              SUBTRACT  1                         16949071
169500                              FROM  ASC-NUMBER-OF-SELECTED-ITEMS  16950071
169510                              MOVE SPACES TO LQW-LINE-STATUS      16951071
169520                                             (LQW-IDX)            16952071
169530                              MOVE LQW-SELECTED-SW (LQW-IDX)      16953071
169540                                TO LQW-TEMP-SELECTED-SW (LQW-IDX) 16954071
169550                              MOVE PC-TSYMSG-00115                16955071
169560                                TO DP020-MSG-NUMBER               16956071
169570                              SET DP020-MSG-INFORMATIONAL         16957071
169580                                TO  TRUE                          16958071
169590                             END-IF                               16959071
169600                                                                  16960071
169610                         WHEN  PS-DONT-DELETE                     16961071
169620                             IF  DISTHD-FCSE-CNFRMN-TMST =        16962071
169630                                 PC-DEFAULT-TIMESTAMP             16963071
169640                                 SET LQW-DESELECT (LQW-IDX)       16964071
169650                                                     TO  TRUE     16965071
169660                                 MOVE LQW-SELECTED-SW (LQW-IDX)   16966071
169670                                   TO LQW-TEMP-SELECTED-SW        16967071
169680                                      (LQW-IDX)                   16968071
169690                                 MOVE PC-TSYMSG-00828             16969071
169700                                   TO DP020-MSG-NUMBER            16970071
169710                             ELSE                                 16971071
169720                                 SET LQW-DESELECT (LQW-IDX)       16972071
169730                                                     TO  TRUE     16973071
169740                                 MOVE LQW-SELECTED-SW (LQW-IDX)   16974071
169750                                   TO LQW-TEMP-SELECTED-SW        16975071
169760                                      (LQW-IDX)                   16976071
169770                                 MOVE PC-TSYMSG-01805             16977071
169780                                   TO DP020-MSG-NUMBER            16978071
169790                             END-IF                               16979071
169800                         END-EVALUATE                             16980071
169810                     END-IF                                       16981071
169820                 END-IF                                           16982071
169830             END-IF                                               16983071
169840         END-PERFORM                                              16984071
169850                                                                  16985071
169860     MOVE PV-ITEM      TO PV-SAVE-ITEM                            16986071
169870     PERFORM 6111-WRITE-LIST-QUEUE                                16987071
169880                                                                  16988071
169890     END-IF                                                       16989071
169900                                                                  16990071
169910     MOVE +1                     TO  ASC-BLK-SUB.                 16991071
169920     PERFORM 4410-READ-TEMP-STORAGE                               16992071
169930                                                                  16993071
169940     ADD +1                      TO  ASC-BLK-SUB                  16994071
169950                                     PV-BLOCK-NUMBER.             16995071
169960     PERFORM 4410-READ-TEMP-STORAGE.                              16996071
169970                                                                  16997071
169980                                                                  16998071
169990*----------------------------------------------------------------*16999071
170000*  CHECK IF DELETE OK - DO NOT DELETE IF ALREADY VERIFIED         17000071
170010*----------------------------------------------------------------*17001071
170020 4505-CHECK-DELETE-OK.                                            17002071
170030     SET  PS-NO-SOFT-ABORT-ERROR          TO  TRUE.               17003071
170040                                                                  17004071
170050     EXEC SQL                                                     17005071
170060          SELECT A.STATUS_CDE                                     17006071
170070                ,B.PRCG_STAT_CDE                                  17007071
170080                ,B.FCSE_CNFRMN_TMST                               17008071
170090                ,B.CRE_USR_ID                                     17009071
170100                ,B.RSLTS_RCVD_TMST                                17010071
170110                ,B.VRFD_TMST                                      17011071
170120            INTO :RECITM-STATUS-CDE                               17012071
170130                ,:DISTHD-PRCG-STAT-CDE                            17013071
170140                ,:DISTHD-FCSE-CNFRMN-TMST                         17014071
170150                ,:DISTHD-CRE-USR-ID                               17015071
170160                ,:DISTHD-RSLTS-RCVD-TMST                          17016071
170170                ,:DISTHD-VRFD-TMST                                17017071
170180            FROM TRECITM A                                        17018071
170190                ,TDISTHD B                                        17019071
170200           WHERE A.ORD_NBR      =  :DK-PO-NBR                     17020071
170210             AND A.REC_SEQ_NBR  =  :DK-REC-SEQ-NBR                17021071
170220             AND A.ORD_LNE_NBR  =  :DK-LINE-NBR                   17022071
170230             AND A.ORD_NBR      =  B.ORD_NBR                      17023071
170240             AND A.REC_SEQ_NBR  =  B.RCVR_SEQ_NBR                 17024071
170250             AND A.ORD_LNE_NBR  =  B.ORD_LNE_NBR                  17025071
170260             AND B.PRCG_STAT_CDE                                  17026071
170270                          NOT IN  ('C','D')                       17027071
170280     END-EXEC.                                                    17028071
170290                                                                  17029071
170300     EVALUATE TRUE                                                17030071
170310         WHEN SQLCODE = ZERO                                      17031071
170320                  SET PS-DONT-DELETE          TO TRUE             17032071
170330              IF (DISTHD-PRCG-STAT-CDE = 'A' OR 'G') AND          17033071
170340                  DISTHD-FCSE-CNFRMN-TMST                         17034071
170350                              =  PC-DEFAULT-TIMESTAMP             17035071
170360                  SET PS-DO-DELETE TO TRUE                        17036071
170370              END-IF                                              17037071
170380              IF (DISTHD-PRCG-STAT-CDE = 'K' OR 'L') AND          17038071
170390                  DISTHD-RSLTS-RCVD-TMST                          17039071
170400                              =  PC-DEFAULT-TIMESTAMP             17040071
170410                  SET PS-DO-DELETE TO TRUE                        17041071
170420              END-IF                                              17042071
170430              IF PS-DONT-DELETE                                   17043071
170440                 IF DISTHD-CRE-USR-ID = 'TRLRUNLD' OR             17044071
170450                    DISTHD-CRE-USR-ID  =  'HOTCMPLT'              17045071
170460                    AND (DISTHD-VRFD-TMST                         17046071
170470                                 =  PC-DEFAULT-TIMESTAMP)         17047071
170480                     SET PS-DO-DELETE TO TRUE                     17048071
170490                 ELSE                                             17049071
170500                    IF DISTHD-RSLTS-RCVD-TMST                     17050071
170510                                 =  PC-DEFAULT-TIMESTAMP          17051071
170520                       SET PS-DO-DELETE TO TRUE                   17052071
170530                    END-IF                                        17053071
170540                 END-IF                                           17054071
170550              END-IF                                              17055071
170560         WHEN SQLCODE = +100                                      17056071
170570                  PERFORM 4507-CHECK-DELETE-OK-OLD                17057071
170580         WHEN SQLCODE = -904                                      17058071
170590         WHEN SQLCODE = -911                                      17059071
170600         WHEN SQLCODE = -913                                      17060071
170610                                                                  17061071
170620             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   17062071
170630             MOVE '4505-CHECK-DELETE-OK'     TO PV-SOFT-PARAGRAPH 17063071
170640             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 17064071
170650             MOVE LENGTH OF PV-CICS-MSG-AREA2                     17065071
170660               TO PV-COMMAREA-LENGTH                              17066071
170670             EXEC CICS                                            17067071
170680                  WRITEQ TD                                       17068071
170690                   QUEUE  ('CSSL')                                17069071
170700                    FROM  (PV-CICS-MSG-AREA2)                     17070071
170710                  LENGTH  (PV-COMMAREA-LENGTH)                    17071071
170720                    RESP  (PV-CICS-RESP)                          17072071
170730             END-EXEC                                             17073071
170740                                                                  17074071
170750              MOVE  PC-TSYMSG-00551  TO  DP020-MSG-NUMBER         17075071
170760              PERFORM 9900-SOFT-ABORT                             17076071
170770         WHEN SQLWARN0 NOT = SPACES                               17077071
170780         WHEN SQLCODE NOT EQUAL ZERO                              17078071
170790              MOVE '4505-CHECK-DELETE-OK'                         17079071
170800                                   TO DP013-PARAGRAPH             17080071
170810              MOVE 'CHECK IF OK TO DELETE'                        17081071
170820                                   TO DP013-MESSAGE-TEXT (1)      17082071
170830              MOVE SQLCA           TO DP013-SQLCA                 17083071
170840              MOVE 'TRECITM'       TO DP013-DB2-TABLE-NAME (2)    17084071
170850              MOVE 'TDISTHD'       TO DP013-DB2-TABLE-NAME (1)    17085071
170860              SET DP013-DB2-ABEND  TO TRUE                        17086071
170870              PERFORM DP013-0000-PROCESS-ABEND                    17087071
170880     END-EVALUATE.                                                17088071
170890                                                                  17089071
170900                                                                  17090071
170910*----------------------------------------------------------------*17091071
170920*  CHECK IF DELETE OK - DO NOT DELETE IF PROCESSED OLD            17092071
170930*----------------------------------------------------------------*17093071
170940*CHECK IF DC IS USING MANIFESTING                                 17094071
170950******************************************************************17095071
170960 4506-CHECK-FOR-MANIFESTING.                                      17096071
170970     MOVE  ASC-OPER-UNT-ID       TO  DK-OPER-UNT-ID               17097071
170980                                                                  17098071
170990     EXEC SQL                                                     17099071
171000          SELECT FUNC_END_TMST                                    17100071
171010          INTO  :KRPRPM-FUNC-END-TMST                             17101071
171020          FROM   TKRPRPM                                          17102071
171030          WHERE  SYS_PRC_FUNC_CDE  = 'CSMFST'                     17103071
171040            AND  LOC_ID            = :DK-OPER-UNT-ID              17104071
171050            AND  INTFC_SYS_CDE     = 'KHL'                        17105071
171060            AND  FUNC_PRC_STAT_CDE = 'AC'                         17106071
171070            AND  FUNC_TXT          = 'Y'                          17107071
171080     END-EXEC.                                                    17108071
171090                                                                  17109071
171100                                                                  17110071
171110     EVALUATE TRUE                                                17111071
171120         WHEN SQLCODE = ZERO                                      17112071
171130             SET PS-MANIFEST-DC-FOUND  TO TRUE                    17113071
171140         WHEN SQLCODE = +100                                      17114071
171150             SET PS-MANIFEST-DC-NOT-FND TO TRUE                   17115071
171160         WHEN SQLCODE = -904                                      17116071
171170         WHEN SQLCODE = -911                                      17117071
171180         WHEN SQLCODE = -913                                      17118071
171190             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   17119071
171200             MOVE '4506-CHECK-FOR-MANIFESTI' TO PV-SOFT-PARAGRAPH 17120071
171210             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 17121071
171220             MOVE LENGTH OF PV-CICS-MSG-AREA2                     17122071
171230               TO PV-COMMAREA-LENGTH                              17123071
171240             EXEC CICS                                            17124071
171250                  WRITEQ TD                                       17125071
171260                   QUEUE  ('CSSL')                                17126071
171270                    FROM  (PV-CICS-MSG-AREA2)                     17127071
171280                  LENGTH  (PV-COMMAREA-LENGTH)                    17128071
171290                    RESP  (PV-CICS-RESP)                          17129071
171300             END-EXEC                                             17130071
171310              PERFORM 9900-SOFT-ABORT                             17131071
171320         WHEN SQLWARN0 NOT = SPACES                               17132071
171330         WHEN SQLCODE NOT EQUAL ZERO                              17133071
171340              MOVE '4506-CHECK-FOR-MANIFESTING'                   17134071
171350                                   TO DP013-PARAGRAPH             17135071
171360              MOVE 'CHECK IF MANIFESTING DC'                      17136071
171370                                   TO DP013-MESSAGE-TEXT (1)      17137071
171380              MOVE SQLCA           TO DP013-SQLCA                 17138071
171390              MOVE 'TKRPRPM'       TO DP013-DB2-TABLE-NAME (2)    17139071
171400              SET DP013-DB2-ABEND  TO TRUE                        17140071
171410              PERFORM DP013-0000-PROCESS-ABEND                    17141071
171420     END-EVALUATE.                                                17142071
171430******************************************************************17143071
171440 4506A-CHECK-FOR-RECLAIM-LBL.                                     17144071
171450     MOVE  ASC-OPER-UNT-ID       TO  DK-OPER-UNT-ID               17145071
171460                                                                  17146071
171470     EXEC SQL                                                     17147071
171480          SELECT FUNC_END_TMST                                    17148071
171490          INTO  :KRPRPM-FUNC-END-TMST                             17149071
171500          FROM   TKRPRPM                                          17150071
171510          WHERE  SYS_PRC_FUNC_CDE  = 'LBLRCL'                     17151071
171520            AND  LOC_ID            = :DK-OPER-UNT-ID              17152071
171530            AND  INTFC_SYS_CDE     = 'KHL'                        17153071
171540            AND  FUNC_PRC_STAT_CDE = 'AC'                         17154071
171550            AND  FUNC_TXT          = 'Y'                          17155071
171560     END-EXEC.                                                    17156071
171570                                                                  17157071
171580     EVALUATE TRUE                                                17158071
171590         WHEN SQLCODE = ZERO                                      17159071
171600             SET ASC-RECLAIM-DC-YES  TO TRUE                      17160071
171610                                                                  17161071
171620         WHEN SQLCODE = +100                                      17162071
171630             SET ASC-RECLAIM-DC-NO   TO TRUE                      17163071
171640                                                                  17164071
171650         WHEN SQLCODE = -904                                      17165071
171660         WHEN SQLCODE = -911                                      17166071
171670         WHEN SQLCODE = -913                                      17167071
171680             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   17168071
171690             MOVE '4506A-CHECK-FOR-RCLM-LBL' TO PV-SOFT-PARAGRAPH 17169071
171700             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 17170071
171710             MOVE LENGTH OF PV-CICS-MSG-AREA2                     17171071
171720               TO PV-COMMAREA-LENGTH                              17172071
171730             EXEC CICS                                            17173071
171740                  WRITEQ TD                                       17174071
171750                   QUEUE  ('CSSL')                                17175071
171760                    FROM  (PV-CICS-MSG-AREA2)                     17176071
171770                  LENGTH  (PV-COMMAREA-LENGTH)                    17177071
171780                    RESP  (PV-CICS-RESP)                          17178071
171790             END-EXEC                                             17179071
171800              PERFORM 9900-SOFT-ABORT                             17180071
171810         WHEN SQLWARN0 NOT = SPACES                               17181071
171820         WHEN SQLCODE NOT EQUAL ZERO                              17182071
171830              MOVE '4506A-CHECK-FOR-RCLM-LBL'                     17183071
171840                                   TO DP013-PARAGRAPH             17184071
171850              MOVE 'CHECK IF MANIFESTING DC'                      17185071
171860                                   TO DP013-MESSAGE-TEXT (1)      17186071
171870              MOVE SQLCA           TO DP013-SQLCA                 17187071
171880              MOVE 'TKRPRPM'       TO DP013-DB2-TABLE-NAME (2)    17188071
171890              SET DP013-DB2-ABEND  TO TRUE                        17189071
171900              PERFORM DP013-0000-PROCESS-ABEND                    17190071
171910     END-EVALUATE.                                                17191071
171920                                                                  17192071
171930                                                                  17193071
171940******************************************************************17194071
171950 4506B-CHECK-WRK-ORD-AUTO-STRT.                                   17195071
171960     MOVE  ASC-CURR-OPER-UNT-ID  TO  DK-OPER-UNT-ID               17196071
171970                                                                  17197071
171980     EXEC SQL                                                     17198071
171990          SELECT FUNC_END_TMST                                    17199071
172000          INTO  :KRPRPM-FUNC-END-TMST                             17200071
172010          FROM   TKRPRPM                                          17201071
172020          WHERE  SYS_PRC_FUNC_CDE  = 'RSSTWO'                     17202071
172030            AND  LOC_ID            = :DK-OPER-UNT-ID              17203071
172040            AND  INTFC_SYS_CDE     = 'KHL'                        17204071
172050            AND  FUNC_PRC_STAT_CDE = 'AC'                         17205071
172060            AND  FUNC_TXT          = 'Y'                          17206071
172070     END-EXEC.                                                    17207071
172080                                                                  17208071
172090                                                                  17209071
172100     EVALUATE TRUE                                                17210071
172110         WHEN SQLCODE = ZERO                                      17211071
172120             SET PS-AUTO-STRT-WRK-ORDER TO TRUE                   17212071
172130         WHEN SQLCODE = +100                                      17213071
172140             SET PS-AUTO-STRT-WRK-ORDER-NO TO TRUE                17214071
172150         WHEN SQLCODE = -904                                      17215071
172160         WHEN SQLCODE = -911                                      17216071
172170         WHEN SQLCODE = -913                                      17217071
172180             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   17218071
172190             MOVE '4506B-CHECK-WRK-ORD-AUTO-STRT'                 17219071
172200                                              TO PV-SOFT-PARAGRAPH17220071
172210             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 17221071
172220             MOVE LENGTH OF PV-CICS-MSG-AREA2                     17222071
172230               TO PV-COMMAREA-LENGTH                              17223071
172240             EXEC CICS                                            17224071
172250                  WRITEQ TD                                       17225071
172260                   QUEUE  ('CSSL')                                17226071
172270                    FROM  (PV-CICS-MSG-AREA2)                     17227071
172280                  LENGTH  (PV-COMMAREA-LENGTH)                    17228071
172290                    RESP  (PV-CICS-RESP)                          17229071
172300             END-EXEC                                             17230071
172310              PERFORM 9900-SOFT-ABORT                             17231071
172320         WHEN SQLWARN0 NOT = SPACES                               17232071
172330         WHEN SQLCODE NOT EQUAL ZERO                              17233071
172340              MOVE '4506B-CHECK-WRK-ORD-AUTO-STRT'                17234071
172350                                   TO DP013-PARAGRAPH             17235071
172360              MOVE 'CHECK IF AUTO START WORK ORDER'               17236071
172370                                   TO DP013-MESSAGE-TEXT (1)      17237071
172380              MOVE SQLCA           TO DP013-SQLCA                 17238071
172390              MOVE 'TKRPRPM'       TO DP013-DB2-TABLE-NAME (2)    17239071
172400              SET DP013-DB2-ABEND  TO TRUE                        17240071
172410              PERFORM DP013-0000-PROCESS-ABEND                    17241071
172420     END-EVALUATE.                                                17242071
172430*----------------------------------------------------------------*17243071
172440 4507-CHECK-DELETE-OK-OLD.                                        17244071
172450     SET  PS-NO-SOFT-ABORT-ERROR          TO  TRUE.               17245071
172460                                                                  17246071
172470     EXEC SQL                                                     17247071
172480          SELECT A.STATUS_CDE                                     17248071
172490                ,B.PRCG_STAT_CDE                                  17249071
172500                ,B.FCSE_CNFRMN_TMST                               17250071
172510                ,B.SYS_CRE_CDE                                    17251071
172520            INTO :RECITM-STATUS-CDE                               17252071
172530                ,:DISTHD-PRCG-STAT-CDE                            17253071
172540                ,:DISTHD-FCSE-CNFRMN-TMST                         17254071
172550                ,:DISTHD-SYS-CRE-CDE                              17255071
172560            FROM TRECITM A                                        17256071
172570                ,TDISTHD B                                        17257071
172580           WHERE A.ORD_NBR       =  :DK-PO-NBR                    17258071
172590             AND A.REC_SEQ_NBR   =  :DK-REC-SEQ-NBR               17259071
172600             AND A.ORD_LNE_NBR   =  :DK-LINE-NBR                  17260071
172610             AND A.ORD_NBR       =  B.ORD_NBR                     17261071
172620             AND A.REC_SEQ_NBR   =  B.RCVR_SEQ_NBR                17262071
172630             AND A.ORD_LNE_NBR   =  B.ORD_LNE_NBR                 17263071
172640             AND B.PRCG_STAT_CDE = 'D'                            17264071
172650             AND B.SYS_CRE_CDE   = 'P'                            17265071
172660     END-EXEC.                                                    17266071
172670                                                                  17267071
172680     EVALUATE TRUE                                                17268071
172690         WHEN SQLCODE = ZERO                                      17269071
172700                  SET PS-DONT-DELETE          TO TRUE             17270071
172710         WHEN SQLCODE = +100                                      17271071
172720                  SET PS-DO-DELETE          TO TRUE               17272071
172730         WHEN SQLCODE = -904                                      17273071
172740         WHEN SQLCODE = -911                                      17274071
172750         WHEN SQLCODE = -913                                      17275071
172760                                                                  17276071
172770             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   17277071
172780             MOVE '4507-CHECK-DELETE-OK-OLD' TO PV-SOFT-PARAGRAPH 17278071
172790             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 17279071
172800             MOVE LENGTH OF PV-CICS-MSG-AREA2                     17280071
172810               TO PV-COMMAREA-LENGTH                              17281071
172820             EXEC CICS                                            17282071
172830                  WRITEQ TD                                       17283071
172840                   QUEUE  ('CSSL')                                17284071
172850                    FROM  (PV-CICS-MSG-AREA2)                     17285071
172860                  LENGTH  (PV-COMMAREA-LENGTH)                    17286071
172870                    RESP  (PV-CICS-RESP)                          17287071
172880             END-EXEC                                             17288071
172890                                                                  17289071
172900              MOVE  PC-TSYMSG-00551  TO  DP020-MSG-NUMBER         17290071
172910              PERFORM 9900-SOFT-ABORT                             17291071
172920         WHEN SQLWARN0 NOT = SPACES                               17292071
172930         WHEN SQLCODE NOT EQUAL ZERO                              17293071
172940              MOVE '4507-CHECK-DELETE-OK-OLD'                     17294071
172950                                   TO DP013-PARAGRAPH             17295071
172960              MOVE 'CHECK IF OK TO DELETE-PROCESSED OLD'          17296071
172970                                   TO DP013-MESSAGE-TEXT (1)      17297071
172980              MOVE SQLCA           TO DP013-SQLCA                 17298071
172990              MOVE 'TRECITM'       TO DP013-DB2-TABLE-NAME (2)    17299071
173000              MOVE 'TDISTHD'       TO DP013-DB2-TABLE-NAME (1)    17300071
173010              SET DP013-DB2-ABEND  TO TRUE                        17301071
173020              PERFORM DP013-0000-PROCESS-ABEND                    17302071
173030     END-EVALUATE.                                                17303071
173040                                                                  17304071
173050                                                                  17305071
173060*----------------------------------------------------------------*17306071
173070*  CHECK IF THERE ARE CS OR ECOMMERCE LOCATIONS USING             17307071
173080*  BLIND RECEIVING FOR RDM                                        17308071
173090*----------------------------------------------------------------*17309071
173100 4509-CHECK-RDM-BLIND-RCVNG.                                      17310071
173110     SET  PS-NO-SOFT-ABORT-ERROR          TO  TRUE.               17311071
173120     INITIALIZE PV-DB2-RDM-LOC-COUNT.                             17312071
173130     MOVE  ZEROS TO  PV-DISTDT-ORD-NBR                            17313071
173140                                                                  17314071
173150     EXEC SQL                                                     17315071
173160          SELECT A.ORD_NBR                                        17316071
173170          INTO :PV-DISTDT-ORD-NBR                                 17317071
173180          FROM TDISTDT A                                          17318071
173190             , TKRPRPM B                                          17319071
173200          WHERE A.ORD_NBR           = :DK-PO-NBR                  17320071
173210            AND A.RCVR_SEQ_NBR      = :DK-REC-SEQ-NBR             17321071
173220            AND A.ORD_LNE_NBR       = :DK-LINE-NBR                17322071
173230            AND A.STR_NBR           = B.LOC_ID                    17323071
173240            AND B.SYS_PRC_FUNC_CDE  = 'RDMRCV'                    17324071
173250            AND B.INTFC_SYS_CDE     = 'RDM'                       17325071
173260            AND B.FUNC_PRC_STAT_CDE = 'AC'                        17326071
173270            AND B.FUNC_TXT          = 'Y'                         17327071
173280          FETCH FIRST 1 ROW ONLY                                  17328071
173290     END-EXEC.                                                    17329071
173300                                                                  17330071
173310     EVALUATE TRUE                                                17331071
173320         WHEN SQLCODE = ZERO                                      17332071
173330                                                                  17333071
173340              IF DISTDT-ORD-NBR       > 0                         17334071
173350                 SET PS-BLND-RECV-SIMPL-LOC-FND TO TRUE           17335071
173360              ELSE                                                17336071
173370                 SET PS-BLND-RECV-SIMPL-LOC-NOT-FND TO TRUE       17337071
173380              END-IF                                              17338071
173390         WHEN SQLCODE = +100                                      17339071
173400              SET PS-BLND-RECV-SIMPL-LOC-NOT-FND TO TRUE          17340071
173410         WHEN SQLCODE = -904                                      17341071
173420         WHEN SQLCODE = -911                                      17342071
173430         WHEN SQLCODE = -913                                      17343071
173440                                                                  17344071
173450              MOVE SQLCODE                   TO PV-SOFT-SQLCODE   17345071
173460              MOVE '4509-CHECK-RDM-BLIND'    TO PV-SOFT-PARAGRAPH 17346071
173470              MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2 17347071
173480              MOVE LENGTH OF PV-CICS-MSG-AREA2                    17348071
173490                TO PV-COMMAREA-LENGTH                             17349071
173500              EXEC CICS                                           17350071
173510                  WRITEQ TD                                       17351071
173520                   QUEUE  ('CSSL')                                17352071
173530                    FROM  (PV-CICS-MSG-AREA2)                     17353071
173540                  LENGTH  (PV-COMMAREA-LENGTH)                    17354071
173550                    RESP  (PV-CICS-RESP)                          17355071
173560              END-EXEC                                            17356071
173570              MOVE  PC-TSYMSG-00551  TO  DP020-MSG-NUMBER         17357071
173580              PERFORM 9900-SOFT-ABORT                             17358071
173590                                                                  17359071
173600         WHEN SQLWARN0 NOT = SPACES                               17360071
173610         WHEN SQLCODE NOT EQUAL ZERO                              17361071
173620              MOVE '4509-CHECK-RDM-BLIND'                         17362071
173630                                   TO DP013-PARAGRAPH             17363071
173640              MOVE 'SELECT FOR BLIND RCVNG LOCATIONS'             17364071
173650                                   TO DP013-MESSAGE-TEXT (1)      17365071
173660              MOVE SQLCA           TO DP013-SQLCA                 17366071
173670              MOVE 'TDISTDT'       TO DP013-DB2-TABLE-NAME (1)    17367071
173680              MOVE 'TKRPRPM'       TO DP013-DB2-TABLE-NAME (2)    17368071
173690              SET DP013-DB2-ABEND  TO TRUE                        17369071
173700              PERFORM DP013-0000-PROCESS-ABEND                    17370071
173710     END-EVALUATE.                                                17371071
173720                                                                  17372071
173730                                                                  17373071
173740*----------------------------------------------------------------*17374071
173750*  DELETE THE TRANSACTION DETAIL ROWS FOR THIS PO/RCVR/LINE       17375071
173760*----------------------------------------------------------------*17376071
173770 4510-DELETE-DETAIL.                                              17377071
173780     SET  PS-NO-SOFT-ABORT-ERROR          TO  TRUE.               17378071
173790                                                                  17379071
173800     EXEC SQL                                                     17380071
173810          DELETE FROM TDISTDT                                     17381071
173820           WHERE ORD_NBR         = :DK-PO-NBR                     17382071
173830             AND RCVR_SEQ_NBR    = :DK-REC-SEQ-NBR                17383071
173840             AND ORD_LNE_NBR     = :DK-LINE-NBR                   17384071
173850     END-EXEC.                                                    17385071
173860                                                                  17386071
173870     EVALUATE TRUE                                                17387071
173880         WHEN SQLCODE = ZERO                                      17388071
173890         WHEN SQLCODE = +100                                      17389071
173900              IF  LQW-LNE-UCC128-YES (LQW-IDX)                    17390071
173910                  IF  ASC-PRE-PACK-ORDER                          17391071
173920                      MOVE LQW-PREPK-ID (LQW-IDX)                 17392071
173930                        TO DK-PREPK-ID                            17393071
173940                      PERFORM 4511-DELETE-VRTL-LBL-PREPK          17394071
173950                  ELSE                                            17395071
173960                      PERFORM 4511-DELETE-VRTL-LBL                17396071
173970                  END-IF                                          17397071
173980              END-IF                                              17398071
173990         WHEN SQLCODE = -904                                      17399071
174000         WHEN SQLCODE = -911                                      17400071
174010         WHEN SQLCODE = -913                                      17401071
174020                                                                  17402071
174030              MOVE SQLCODE                   TO PV-SOFT-SQLCODE   17403071
174040              MOVE '4510-DELETE-DETAIL'      TO PV-SOFT-PARAGRAPH 17404071
174050              MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2 17405071
174060              MOVE LENGTH OF PV-CICS-MSG-AREA2                    17406071
174070                TO PV-COMMAREA-LENGTH                             17407071
174080              EXEC CICS                                           17408071
174090                  WRITEQ TD                                       17409071
174100                   QUEUE  ('CSSL')                                17410071
174110                    FROM  (PV-CICS-MSG-AREA2)                     17411071
174120                  LENGTH  (PV-COMMAREA-LENGTH)                    17412071
174130                    RESP  (PV-CICS-RESP)                          17413071
174140              END-EXEC                                            17414071
174150              MOVE  PC-TSYMSG-00551  TO  DP020-MSG-NUMBER         17415071
174160              PERFORM 9900-SOFT-ABORT                             17416071
174170                                                                  17417071
174180         WHEN SQLWARN0 NOT = SPACES                               17418071
174190         WHEN SQLCODE NOT EQUAL ZERO                              17419071
174200              MOVE '4510-DELETE-DETAIL'                           17420071
174210                                   TO DP013-PARAGRAPH             17421071
174220              MOVE 'DELETE TRANSACTION DETAIL ROWS'               17422071
174230                                   TO DP013-MESSAGE-TEXT (1)      17423071
174240              MOVE SQLCA           TO DP013-SQLCA                 17424071
174250              MOVE 'TDISTDT'       TO DP013-DB2-TABLE-NAME (1)    17425071
174260              SET DP013-DB2-ABEND  TO TRUE                        17426071
174270              PERFORM DP013-0000-PROCESS-ABEND                    17427071
174280     END-EVALUATE.                                                17428071
174290                                                                  17429071
174300                                                                  17430071
174310*----------------------------------------------------------------*17431071
174320*  DELETE THE VIRTUAL LABEL ROWS                                  17432071
174330*----------------------------------------------------------------*17433071
174340 4511-DELETE-VRTL-LBL.                                            17434071
174350     SET  PS-NO-SOFT-ABORT-ERROR          TO  TRUE.               17435071
174360                                                                  17436071
174370     EXEC SQL                                                     17437071
174380          DELETE FROM TLBVRDA                                     17438071
174390           WHERE PO_NBR          = :DK-PO-NBR                     17439071
174400             AND RCVR_SEQ_NBR    = :DK-REC-SEQ-NBR                17440071
174410             AND PO_LNE_NBR      = :DK-LINE-NBR                   17441071
174420     END-EXEC.                                                    17442071
174430                                                                  17443071
174440     EVALUATE TRUE                                                17444071
174450         WHEN SQLCODE = ZERO                                      17445071
174460         WHEN SQLCODE = +100                                      17446071
174470              CONTINUE                                            17447071
174480                                                                  17448071
174490         WHEN SQLCODE = -904                                      17449071
174500         WHEN SQLCODE = -911                                      17450071
174510         WHEN SQLCODE = -913                                      17451071
174520                                                                  17452071
174530              MOVE SQLCODE                   TO PV-SOFT-SQLCODE   17453071
174540              MOVE '4511-DELETE-VRTL-LBL'    TO PV-SOFT-PARAGRAPH 17454071
174550              MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2 17455071
174560              MOVE LENGTH OF PV-CICS-MSG-AREA2                    17456071
174570                TO PV-COMMAREA-LENGTH                             17457071
174580              EXEC CICS                                           17458071
174590                  WRITEQ TD                                       17459071
174600                   QUEUE  ('CSSL')                                17460071
174610                    FROM  (PV-CICS-MSG-AREA2)                     17461071
174620                  LENGTH  (PV-COMMAREA-LENGTH)                    17462071
174630                    RESP  (PV-CICS-RESP)                          17463071
174640              END-EXEC                                            17464071
174650              MOVE  PC-TSYMSG-00551  TO  DP020-MSG-NUMBER         17465071
174660              PERFORM 9900-SOFT-ABORT                             17466071
174670                                                                  17467071
174680         WHEN SQLWARN0 NOT = SPACES                               17468071
174690         WHEN SQLCODE NOT EQUAL ZERO                              17469071
174700              MOVE '4511-DELETE-VRTL-LBL'                         17470071
174710                                   TO DP013-PARAGRAPH             17471071
174720              MOVE 'DELETE VIRTUAL LABEL ROWS     '               17472071
174730                                   TO DP013-MESSAGE-TEXT (1)      17473071
174740              MOVE SQLCA           TO DP013-SQLCA                 17474071
174750              MOVE 'TLBVRDA'       TO DP013-DB2-TABLE-NAME (1)    17475071
174760              SET DP013-DB2-ABEND  TO TRUE                        17476071
174770              PERFORM DP013-0000-PROCESS-ABEND                    17477071
174780     END-EVALUATE.                                                17478071
174790                                                                  17479071
174800                                                                  17480071
174810*----------------------------------------------------------------*17481071
174820*  DELETE THE VIRTUAL LABEL ROWS = FOR PREPACK                    17482071
174830*----------------------------------------------------------------*17483071
174840 4511-DELETE-VRTL-LBL-PREPK.                                      17484071
174850     SET  PS-NO-SOFT-ABORT-ERROR          TO  TRUE.               17485071
174860                                                                  17486071
174870     EXEC SQL                                                     17487071
174880          DELETE FROM TLBVRDA                                     17488071
174890           WHERE PO_NBR          = :DK-PO-NBR                     17489071
174900             AND RCVR_SEQ_NBR    = :DK-REC-SEQ-NBR                17490071
174910             AND PREPK_ID        = :DK-PREPK-ID                   17491071
174920     END-EXEC.                                                    17492071
174930                                                                  17493071
174940     EVALUATE TRUE                                                17494071
174950         WHEN SQLCODE = ZERO                                      17495071
174960         WHEN SQLCODE = +100                                      17496071
174970              CONTINUE                                            17497071
174980                                                                  17498071
174990         WHEN SQLCODE = -904                                      17499071
175000         WHEN SQLCODE = -911                                      17500071
175010         WHEN SQLCODE = -913                                      17501071
175020                                                                  17502071
175030              MOVE SQLCODE                   TO PV-SOFT-SQLCODE   17503071
175040              MOVE '4511-DELETE-VRTL-LBL'    TO PV-SOFT-PARAGRAPH 17504071
175050              MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2 17505071
175060              MOVE LENGTH OF PV-CICS-MSG-AREA2                    17506071
175070                TO PV-COMMAREA-LENGTH                             17507071
175080              EXEC CICS                                           17508071
175090                  WRITEQ TD                                       17509071
175100                   QUEUE  ('CSSL')                                17510071
175110                    FROM  (PV-CICS-MSG-AREA2)                     17511071
175120                  LENGTH  (PV-COMMAREA-LENGTH)                    17512071
175130                    RESP  (PV-CICS-RESP)                          17513071
175140              END-EXEC                                            17514071
175150              MOVE  PC-TSYMSG-00551  TO  DP020-MSG-NUMBER         17515071
175160              PERFORM 9900-SOFT-ABORT                             17516071
175170                                                                  17517071
175180         WHEN SQLWARN0 NOT = SPACES                               17518071
175190         WHEN SQLCODE NOT EQUAL ZERO                              17519071
175200              MOVE '4511-DELETE-VRTL-LBL'                         17520071
175210                                   TO DP013-PARAGRAPH             17521071
175220              MOVE 'DELETE VIRTUAL LABEL ROWS     '               17522071
175230                                   TO DP013-MESSAGE-TEXT (1)      17523071
175240              MOVE SQLCA           TO DP013-SQLCA                 17524071
175250              MOVE 'TLBVRDA'       TO DP013-DB2-TABLE-NAME (1)    17525071
175260              SET DP013-DB2-ABEND  TO TRUE                        17526071
175270              PERFORM DP013-0000-PROCESS-ABEND                    17527071
175280     END-EVALUATE.                                                17528071
175290                                                                  17529071
175300                                                                  17530071
175310*----------------------------------------------------------------*17531071
175320*  ROUTINE TO DELETE DETAIL ROWS ASSOCIATED WITH PREPACK          17532071
175330*----------------------------------------------------------------*17533071
175340 4512-DEL-PREPK-DTL.                                              17534071
175350                                                                  17535071
175360     SET  PS-PREPK-LINES-LEFT TO TRUE.                            17536071
175370     PERFORM 4513-OPEN-DEL-PREPK-CSR.                             17537071
175380     PERFORM 4514-FETCH-DEL-PREPK-CSR                             17538071
175390       UNTIL PS-SOFT-ABORT-ERROR                                  17539071
175400          OR PS-NO-PREPK-LINES-LEFT.                              17540071
175410     PERFORM 4515-CLOSE-DEL-PREPK-CSR.                            17541071
175420                                                                  17542071
175430                                                                  17543071
175440*----------------------------------------------------------------*17544071
175450*  OPEN DELETE DETAIL CURSOR FOR PREPACKS                         17545071
175460*----------------------------------------------------------------*17546071
175470 4513-OPEN-DEL-PREPK-CSR.                                         17547071
175480     MOVE 'CURSOR:  PRE_PACK_DEL_CSR'                             17548071
175490                       TO DP013-MESSAGE-TEXT (2).                 17549071
175500     EXEC SQL                                                     17550071
175510          OPEN PRE_PACK_DEL_CSR                                   17551071
175520     END-EXEC.                                                    17552071
175530                                                                  17553071
175540     EVALUATE TRUE                                                17554071
175550         WHEN SQLCODE = ZERO                                      17555071
175560             CONTINUE                                             17556071
175570         WHEN SQLCODE = -904                                      17557071
175580         WHEN SQLCODE = -911                                      17558071
175590         WHEN SQLCODE = -913                                      17559071
175600             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    17560071
175610             MOVE '4513-OPEN-DEL-PREPK-CSR' TO PV-SOFT-PARAGRAPH  17561071
175620             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  17562071
175630             MOVE LENGTH OF PV-CICS-MSG-AREA2                     17563071
175640               TO PV-COMMAREA-LENGTH                              17564071
175650             EXEC CICS                                            17565071
175660                  WRITEQ TD                                       17566071
175670                   QUEUE  ('CSSL')                                17567071
175680                    FROM  (PV-CICS-MSG-AREA2)                     17568071
175690                  LENGTH  (PV-COMMAREA-LENGTH)                    17569071
175700                    RESP  (PV-CICS-RESP)                          17570071
175710             END-EXEC                                             17571071
175720             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          17572071
175730             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              17573071
175740             PERFORM 9900-SOFT-ABORT                              17574071
175750         WHEN SQLWARN0 NOT = SPACES                               17575071
175760         WHEN SQLCODE < ZERO                                      17576071
175770         WHEN SQLCODE > ZERO                                      17577071
175780             MOVE '4513-OPEN-DEL-PREPK-CSR'                       17578071
175790                               TO DP013-PARAGRAPH                 17579071
175800             MOVE 'OPEN DELETE PREPACK CURSOR - '                 17580071
175810                               TO DP013-MESSAGE-TEXT (1)          17581071
175820             MOVE SQLCA        TO DP013-SQLCA                     17582071
175830             MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (1)        17583071
175840             MOVE 'TPURITM '   TO DP013-DB2-TABLE-NAME (2)        17584071
175850             SET DP013-DB2-ABEND                                  17585071
175860                 DP013-XCTL-DISPLAY-RESTART TO TRUE               17586071
175870             PERFORM DP013-0000-PROCESS-ABEND                     17587071
175880     END-EVALUATE.                                                17588071
175890                                                                  17589071
175900                                                                  17590071
175910*----------------------------------------------------------------*17591071
175920* FETCH DELETE DETAIL CURSOR FOR PREPACKS                         17592071
175930*----------------------------------------------------------------*17593071
175940 4514-FETCH-DEL-PREPK-CSR.                                        17594071
175950     MOVE 'CURSOR:  PRE_PACK_DEL_CSR'                             17595071
175960                       TO DP013-MESSAGE-TEXT (2).                 17596071
175970                                                                  17597071
175980     EXEC SQL                                                     17598071
175990          FETCH PRE_PACK_DEL_CSR                                  17599071
176000           INTO :PV-PRPK-REC-ORD-LNE-NBR                          17600071
176010     END-EXEC.                                                    17601071
176020                                                                  17602071
176030     EVALUATE TRUE                                                17603071
176040         WHEN SQLCODE = ZERO                                      17604071
176050              PERFORM 4516-DELETE-PREPK-DETAIL                    17605071
176060                                                                  17606071
176070         WHEN SQLCODE = +100                                      17607071
176080         SET PS-NO-PREPK-LINES-LEFT                               17608071
176090                                   TO TRUE                        17609071
176100         WHEN SQLCODE = -904                                      17610071
176110         WHEN SQLCODE = -911                                      17611071
176120         WHEN SQLCODE = -913                                      17612071
176130             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   17613071
176140             MOVE '4514-FETCH-DEL-PREPK-CSR' TO PV-SOFT-PARAGRAPH 17614071
176150             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 17615071
176160             MOVE LENGTH OF PV-CICS-MSG-AREA2                     17616071
176170               TO PV-COMMAREA-LENGTH                              17617071
176180             EXEC CICS                                            17618071
176190                  WRITEQ TD                                       17619071
176200                   QUEUE  ('CSSL')                                17620071
176210                    FROM  (PV-CICS-MSG-AREA2)                     17621071
176220                  LENGTH  (PV-COMMAREA-LENGTH)                    17622071
176230                    RESP  (PV-CICS-RESP)                          17623071
176240             END-EXEC                                             17624071
176250             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          17625071
176260             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              17626071
176270             PERFORM 9900-SOFT-ABORT                              17627071
176280         WHEN SQLWARN0 NOT = SPACE                                17628071
176290         WHEN SQLCODE NOT = ZERO                                  17629071
176300              MOVE ASC-PO-LINE-NBR                                17630071
176310                                TO DP013-MESSAGE-TEXT (3)         17631071
176320              MOVE '4514-FETCH-DEL-PREPK-CSR'                     17632071
176330                               TO DP013-PARAGRAPH                 17633071
176340              MOVE 'FETCH PRE-PK DELETE CURSOR'                   17634071
176350                               TO DP013-MESSAGE-TEXT (1)          17635071
176360              MOVE SQLCA       TO DP013-SQLCA                     17636071
176370              SET DP013-DB2-ABEND                                 17637071
176380                               TO TRUE                            17638071
176390              PERFORM DP013-0000-PROCESS-ABEND                    17639071
176400     END-EVALUATE.                                                17640071
176410                                                                  17641071
176420                                                                  17642071
176430*----------------------------------------------------------------*17643071
176440* CLOSE DELETE DETAIL CURSOR FOR PREPACKS                         17644071
176450*----------------------------------------------------------------*17645071
176460 4515-CLOSE-DEL-PREPK-CSR.                                        17646071
176470     MOVE 'CURSOR:  PRE_PACK_DEL_CSR'                             17647071
176480                       TO DP013-MESSAGE-TEXT (2).                 17648071
176490     EXEC SQL                                                     17649071
176500          CLOSE PRE_PACK_DEL_CSR                                  17650071
176510     END-EXEC.                                                    17651071
176520                                                                  17652071
176530     EVALUATE TRUE                                                17653071
176540         WHEN SQLCODE = ZERO                                      17654071
176550             CONTINUE                                             17655071
176560         WHEN SQLCODE = -904                                      17656071
176570         WHEN SQLCODE = -911                                      17657071
176580         WHEN SQLCODE = -913                                      17658071
176590             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   17659071
176600             MOVE '4515-CLOSE-PREPK-DEL-CSR' TO PV-SOFT-PARAGRAPH 17660071
176610             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 17661071
176620             MOVE LENGTH OF PV-CICS-MSG-AREA2                     17662071
176630               TO PV-COMMAREA-LENGTH                              17663071
176640             EXEC CICS                                            17664071
176650                  WRITEQ TD                                       17665071
176660                   QUEUE  ('CSSL')                                17666071
176670                    FROM  (PV-CICS-MSG-AREA2)                     17667071
176680                  LENGTH  (PV-COMMAREA-LENGTH)                    17668071
176690                    RESP  (PV-CICS-RESP)                          17669071
176700             END-EXEC                                             17670071
176710             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          17671071
176720             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              17672071
176730             PERFORM 9900-SOFT-ABORT                              17673071
176740         WHEN SQLWARN0 NOT = SPACES                               17674071
176750         WHEN SQLCODE < ZERO                                      17675071
176760         WHEN SQLCODE > ZERO                                      17676071
176770             MOVE '4513-CLOSE-PREPK-DEL-CSR'                      17677071
176780                               TO DP013-PARAGRAPH                 17678071
176790             MOVE 'CLOSE CURSOR                '                  17679071
176800                               TO DP013-MESSAGE-TEXT (1)          17680071
176810             MOVE SQLCA        TO DP013-SQLCA                     17681071
176820             MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (1)        17682071
176830             MOVE 'TPURITM '   TO DP013-DB2-TABLE-NAME (2)        17683071
176840             SET DP013-DB2-ABEND                                  17684071
176850                 DP013-XCTL-DISPLAY-RESTART TO TRUE               17685071
176860             PERFORM DP013-0000-PROCESS-ABEND                     17686071
176870     END-EVALUATE.                                                17687071
176880                                                                  17688071
176890                                                                  17689071
176900*----------------------------------------------------------------*17690071
176910* DELETE DETAIL FOR PREPACKS                                      17691071
176920*----------------------------------------------------------------*17692071
176930 4516-DELETE-PREPK-DETAIL.                                        17693071
176940     SET  PS-NO-SOFT-ABORT-ERROR          TO  TRUE.               17694071
176950                                                                  17695071
176960     EXEC SQL                                                     17696071
176970          DELETE FROM TDISTDT                                     17697071
176980           WHERE ORD_NBR         = :DK-PO-NBR                     17698071
176990             AND RCVR_SEQ_NBR    = :DK-REC-SEQ-NBR                17699071
177000             AND ORD_LNE_NBR     = :PV-PRPK-REC-ORD-LNE-NBR       17700071
177010     END-EXEC.                                                    17701071
177020                                                                  17702071
177030     EVALUATE TRUE                                                17703071
177040         WHEN SQLCODE = ZERO                                      17704071
177050         WHEN SQLCODE = +100                                      17705071
177060                  CONTINUE                                        17706071
177070         WHEN SQLCODE = -904                                      17707071
177080         WHEN SQLCODE = -911                                      17708071
177090         WHEN SQLCODE = -913                                      17709071
177100                                                                  17710071
177110             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   17711071
177120             MOVE '4516-DELETE-PREPK-DETAIL' TO PV-SOFT-PARAGRAPH 17712071
177130             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 17713071
177140             MOVE LENGTH OF PV-CICS-MSG-AREA2                     17714071
177150               TO PV-COMMAREA-LENGTH                              17715071
177160             EXEC CICS                                            17716071
177170                  WRITEQ TD                                       17717071
177180                   QUEUE  ('CSSL')                                17718071
177190                    FROM  (PV-CICS-MSG-AREA2)                     17719071
177200                  LENGTH  (PV-COMMAREA-LENGTH)                    17720071
177210                    RESP  (PV-CICS-RESP)                          17721071
177220             END-EXEC                                             17722071
177230                                                                  17723071
177240              MOVE  PC-TSYMSG-00551  TO  DP020-MSG-NUMBER         17724071
177250              PERFORM 9900-SOFT-ABORT                             17725071
177260         WHEN SQLWARN0 NOT = SPACES                               17726071
177270         WHEN SQLCODE NOT EQUAL ZERO                              17727071
177280              MOVE '4516-DELETE-PREPK-DETAIL'                     17728071
177290                                   TO DP013-PARAGRAPH             17729071
177300              MOVE 'DELETE PREPACK DETAIL ROWS'                   17730071
177310                                   TO DP013-MESSAGE-TEXT (1)      17731071
177320              MOVE SQLCA           TO DP013-SQLCA                 17732071
177330              MOVE 'TDISTDT'       TO DP013-DB2-TABLE-NAME (1)    17733071
177340              SET DP013-DB2-ABEND  TO TRUE                        17734071
177350              PERFORM DP013-0000-PROCESS-ABEND                    17735071
177360     END-EVALUATE.                                                17736071
177370                                                                  17737071
177380                                                                  17738071
177390*----------------------------------------------------------------*17739071
177400*  DELETE THE TRANSACTION HEADER ROW FOR THIS PO/RCVR/LINE        17740071
177410*----------------------------------------------------------------*17741071
177420 4520-DEL-UPD-HEADER.                                             17742071
177430     SET  PS-NO-SOFT-ABORT-ERROR          TO  TRUE.               17743071
177440                                                                  17744071
177450     MOVE 'D'                     TO DISTHD-PRCG-STAT-CDE         17745071
177460     MOVE SPACES                  TO DISTHD-CART-DWNLD-USR-ID     17746071
177470                                     DISTHD-CRE-USR-ID            17747071
177480                                     DISTHD-SYS-CRE-CDE           17748071
177490                                     DISTHD-PRC-AREA-MODU-ID      17749071
177500                                     DISTHD-FCSE-LBL-TYP-CDE      17750071
177510                                     DISTHD-SPC-INSTR-DESC        17751071
177520                                     DISTHD-INPK-CNVYB-IND        17752071
177530                                     DISTHD-CRE-LBL-OPT-CDE       17753071
177540                                     DISTHD-FCSE-FCLTY-AREA-ID    17754071
177550                                     DISTHD-PREPK-LNE-PRC-CDE     17755071
177560                                     DISTHD-UCC128-DAT-USG-CDE    17756071
177570                                     DISTHD-FCSE-CNFRMN-PGM-ID    17757071
177580                                     DISTHD-FCSE-CNFRMN-USR-ID.   17758071
177590                                                                  17759071
177600     MOVE ZERO                    TO DISTHD-TOT-CART-CNT          17760071
177610                                     DISTHD-FCSE-CART-CNT         17761071
177620                                     DISTHD-P2L-CART-CNT          17762071
177630                                     DISTHD-INPK-CART-CNT         17763071
177640                                     DISTHD-INPK-UNT-QTY          17764071
177650                                     DISTHD-OTPK-UNT-QTY          17765071
177660                                     DISTHD-ODD-CART-UNT-QTY      17766071
177670                                     DISTHD-CAL-UNT-PRCD-QTY.     17767071
177680*-------------------------------------------------------------    17768071
177690* CHECK TO ENSURE THE CURRENT DC TO UPDATE CASEPACK               17769071
177700* APPEARS ON THE TABLE                                            17770071
177710*-------------------------------------------------------------    17771071
177720     MOVE ASC-OPER-UNT-ID         TO DISTHD-OPER-UNT-ID.          17772071
177730     MOVE DP020-USERID            TO DISTHD-DLT-REQ-SRC-ID.       17773071
177740     MOVE PC-DEFAULT-TIMESTAMP    TO DISTHD-FCSE-CNFRMN-TMST.     17774071
177750                                                                  17775071
177760     EXEC SQL                                                     17776071
177770          UPDATE TDISTHD                                          17777071
177780             SET                                                  17778071
177790                 PRC_AREA_MODU_ID  = :DISTHD-PRC-AREA-MODU-ID     17779071
177800               , TOT_CART_CNT      = :DISTHD-TOT-CART-CNT         17780071
177810               , P2L_CART_CNT      = :DISTHD-P2L-CART-CNT         17781071
177820               , CRE_USR_ID        = :DISTHD-CRE-USR-ID           17782071
177830               , SYS_CRE_CDE       = :DISTHD-SYS-CRE-CDE          17783071
177840               , INPK_UNT_QTY      = :DISTHD-INPK-UNT-QTY         17784071
177850               , OTPK_UNT_QTY      = :DISTHD-OTPK-UNT-QTY         17785071
177860               , SPC_INSTR_DESC    = :DISTHD-SPC-INSTR-DESC       17786071
177870               , FCSE_CART_CNT     = :DISTHD-FCSE-CART-CNT        17787071
177880               , FCSE_LBL_TYP_CDE  = :DISTHD-FCSE-LBL-TYP-CDE     17788071
177890               , INPK_CART_CNT     = :DISTHD-INPK-CART-CNT        17789071
177900               , CART_DWNLD_DTE    = :PC-DEFAULT-DTE              17790071
177910               , CART_DWNLD_TM     = :PC-DEFAULT-TM               17791071
177920               ,CART_DWNLD_USR_ID  = :DISTHD-CART-DWNLD-USR-ID    17792071
177930               ,INPK_CNVYB_IND     = :DISTHD-INPK-CNVYB-IND       17793071
177940               ,FCSE_CNFRMN_PGM_ID = :DISTHD-FCSE-CNFRMN-PGM-ID   17794071
177950               ,FCSE_CNFRMN_USR_ID = :DISTHD-FCSE-CNFRMN-USR-ID   17795071
177960               ,FCSE_CNFRMN_TMST   = :DISTHD-FCSE-CNFRMN-TMST     17796071
177970               ,CRE_LBL_OPT_CDE    = :DISTHD-CRE-LBL-OPT-CDE      17797071
177980               ,FCSE_FCLTY_AREA_ID = :DISTHD-FCSE-FCLTY-AREA-ID   17798071
177990               ,ODD_CART_UNT_QTY   = :DISTHD-ODD-CART-UNT-QTY     17799071
178000               ,DLT_REQ_TMST       =  CURRENT TIMESTAMP           17800071
178010               ,DLT_REQ_SRC_ID     = :DISTHD-DLT-REQ-SRC-ID       17801071
178020               ,PREPK_LNE_PRC_CDE  = :DISTHD-PREPK-LNE-PRC-CDE    17802071
178030               ,PRCG_STAT_CDE      = :DISTHD-PRCG-STAT-CDE        17803071
178040               ,CAL_UNT_PRCD_QTY   = :DISTHD-CAL-UNT-PRCD-QTY     17804071
178050               ,UCC128_DAT_USG_CDE = :DISTHD-UCC128-DAT-USG-CDE   17805071
178060               ,OPER_UNT_ID        = :DISTHD-OPER-UNT-ID          17806071
178070               ,RSLTS_RCVD_TMST    = :PC-DEFAULT-TIMESTAMP        17807071
178080           WHERE ORD_NBR           = :DK-PO-NBR                   17808071
178090             AND RCVR_SEQ_NBR      = :DK-REC-SEQ-NBR              17809071
178100             AND ORD_LNE_NBR       = :DK-LINE-NBR                 17810071
178110     END-EXEC.                                                    17811071
178120                                                                  17812071
178130     EVALUATE TRUE                                                17813071
178140         WHEN SQLCODE = ZERO                                      17814071
178150              PERFORM 7475-CREATE-TROUBLE                         17815071
178160              PERFORM 7500-CALL-PO-RCVR-TRKING-MOD                17816071
178170         WHEN SQLCODE = +100                                      17817071
178180              MOVE  PC-TSYMSG-00116  TO  DP020-MSG-NUMBER         17818071
178190              SET DP020-MSG-INFORMATIONAL                         17819071
178200                  PS-ERROR                 TO TRUE                17820071
178210         WHEN SQLCODE = -904                                      17821071
178220         WHEN SQLCODE = -911                                      17822071
178230         WHEN SQLCODE = -913                                      17823071
178240                                                                  17824071
178250             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   17825071
178260             MOVE '4520-DEL-UPD-HEADER'      TO PV-SOFT-PARAGRAPH 17826071
178270             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 17827071
178280             MOVE LENGTH OF PV-CICS-MSG-AREA2                     17828071
178290               TO PV-COMMAREA-LENGTH                              17829071
178300             EXEC CICS                                            17830071
178310                  WRITEQ TD                                       17831071
178320                   QUEUE  ('CSSL')                                17832071
178330                    FROM  (PV-CICS-MSG-AREA2)                     17833071
178340                  LENGTH  (PV-COMMAREA-LENGTH)                    17834071
178350                    RESP  (PV-CICS-RESP)                          17835071
178360             END-EXEC                                             17836071
178370                                                                  17837071
178380              MOVE  PC-TSYMSG-00551  TO  DP020-MSG-NUMBER         17838071
178390              PERFORM 9900-SOFT-ABORT                             17839071
178400         WHEN SQLWARN0 NOT = SPACES                               17840071
178410         WHEN SQLCODE NOT EQUAL ZERO                              17841071
178420              MOVE '4520-DEL-UPD-HEADER'                          17842071
178430                                   TO DP013-PARAGRAPH             17843071
178440              MOVE 'DELETE TRANSACTION HEADER ROW'                17844071
178450                                   TO DP013-MESSAGE-TEXT (1)      17845071
178460              MOVE SQLCA           TO DP013-SQLCA                 17846071
178470              MOVE 'TDISTHD'       TO DP013-DB2-TABLE-NAME (1)    17847071
178480              SET DP013-DB2-ABEND  TO TRUE                        17848071
178490              PERFORM DP013-0000-PROCESS-ABEND                    17849071
178500     END-EVALUATE.                                                17850071
178510                                                                  17851071
178520                                                                  17852071
178530*----------------------------------------------------------------*17853071
178540*  ROUTINE TO DELETE/UPDATE ROWS ASSOCIATED WITH PREPACK- HEADERS 17854071
178550*----------------------------------------------------------------*17855071
178560 4522-DEL-PREPK-HDR.                                              17856071
178570                                                                  17857071
178580     SET  PS-PREPK-LINES-LEFT TO TRUE.                            17858071
178590     PERFORM 4513-OPEN-DEL-PREPK-CSR.                             17859071
178600     PERFORM 4524-FETCH-DEL-PREPK-CSR                             17860071
178610       UNTIL PS-SOFT-ABORT-ERROR                                  17861071
178620          OR PS-NO-PREPK-LINES-LEFT.                              17862071
178630     PERFORM 4515-CLOSE-DEL-PREPK-CSR.                            17863071
178640                                                                  17864071
178650*----------------------------------------------------------------*17865071
178660* FETCH DELETE DETAIL CURSOR FOR PREPACKS                         17866071
178670*----------------------------------------------------------------*17867071
178680 4524-FETCH-DEL-PREPK-CSR.                                        17868071
178690     MOVE 'CURSOR:  PRE_PACK_DEL_CSR'                             17869071
178700                       TO DP013-MESSAGE-TEXT (2).                 17870071
178710                                                                  17871071
178720     EXEC SQL                                                     17872071
178730          FETCH PRE_PACK_DEL_CSR                                  17873071
178740           INTO :PV-PRPK-REC-ORD-LNE-NBR                          17874071
178750     END-EXEC.                                                    17875071
178760                                                                  17876071
178770     EVALUATE TRUE                                                17877071
178780         WHEN SQLCODE = ZERO                                      17878071
178790              PERFORM 4526-DELETE-PREPK-HEADER                    17879071
178800                                                                  17880071
178810         WHEN SQLCODE = +100                                      17881071
178820         SET PS-NO-PREPK-LINES-LEFT                               17882071
178830                                   TO TRUE                        17883071
178840         WHEN SQLCODE = -904                                      17884071
178850         WHEN SQLCODE = -911                                      17885071
178860         WHEN SQLCODE = -913                                      17886071
178870             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   17887071
178880             MOVE '4514-FETCH-DEL-PREPK-CSR' TO PV-SOFT-PARAGRAPH 17888071
178890             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 17889071
178900             MOVE LENGTH OF PV-CICS-MSG-AREA2                     17890071
178910               TO PV-COMMAREA-LENGTH                              17891071
178920             EXEC CICS                                            17892071
178930                  WRITEQ TD                                       17893071
178940                   QUEUE  ('CSSL')                                17894071
178950                    FROM  (PV-CICS-MSG-AREA2)                     17895071
178960                  LENGTH  (PV-COMMAREA-LENGTH)                    17896071
178970                    RESP  (PV-CICS-RESP)                          17897071
178980             END-EXEC                                             17898071
178990             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          17899071
179000             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              17900071
179010             PERFORM 9900-SOFT-ABORT                              17901071
179020         WHEN SQLWARN0 NOT = SPACE                                17902071
179030         WHEN SQLCODE NOT = ZERO                                  17903071
179040              MOVE ASC-PO-LINE-NBR                                17904071
179050                                TO DP013-MESSAGE-TEXT (3)         17905071
179060              MOVE '4514-FETCH-DEL-PREPK-CSR'                     17906071
179070                               TO DP013-PARAGRAPH                 17907071
179080              MOVE 'FETCH PRE-PK DELETE CURSOR'                   17908071
179090                               TO DP013-MESSAGE-TEXT (1)          17909071
179100              MOVE SQLCA       TO DP013-SQLCA                     17910071
179110              SET DP013-DB2-ABEND                                 17911071
179120                               TO TRUE                            17912071
179130              PERFORM DP013-0000-PROCESS-ABEND                    17913071
179140     END-EVALUATE.                                                17914071
179150                                                                  17915071
179160                                                                  17916071
179170*----------------------------------------------------------------*17917071
179180*  DELETE THE TRANSACTION HEADER ROW FOR THIS PO/RCVR/LINE        17918071
179190*----------------------------------------------------------------*17919071
179200 4526-DELETE-PREPK-HEADER.                                        17920071
179210     SET  PS-NO-SOFT-ABORT-ERROR          TO  TRUE.               17921071
179220                                                                  17922071
179230     MOVE 'D'                     TO DISTHD-PRCG-STAT-CDE         17923071
179240     MOVE SPACES                  TO DISTHD-CART-DWNLD-USR-ID     17924071
179250                                     DISTHD-CRE-USR-ID            17925071
179260                                     DISTHD-SYS-CRE-CDE           17926071
179270                                     DISTHD-PRC-AREA-MODU-ID      17927071
179280                                     DISTHD-FCSE-LBL-TYP-CDE      17928071
179290                                     DISTHD-SPC-INSTR-DESC        17929071
179300                                     DISTHD-INPK-CNVYB-IND        17930071
179310                                     DISTHD-FCSE-CNFRMN-PGM-ID    17931071
179320                                     DISTHD-FCSE-CNFRMN-USR-ID    17932071
179330                                     DISTHD-CRE-LBL-OPT-CDE       17933071
179340                                     DISTHD-FCSE-FCLTY-AREA-ID    17934071
179350                                     DISTHD-PREPK-LNE-PRC-CDE     17935071
179360                                     DISTHD-UCC128-DAT-USG-CDE.   17936071
179370                                                                  17937071
179380     MOVE ZERO                    TO DISTHD-TOT-CART-CNT          17938071
179390                                     DISTHD-FCSE-CART-CNT         17939071
179400                                     DISTHD-P2L-CART-CNT          17940071
179410                                     DISTHD-INPK-CART-CNT         17941071
179420                                     DISTHD-INPK-UNT-QTY          17942071
179430                                     DISTHD-OTPK-UNT-QTY          17943071
179440                                     DISTHD-ODD-CART-UNT-QTY      17944071
179450                                     DISTHD-CAL-UNT-PRCD-QTY.     17945071
179460*-----------------------------------------------------------------17946071
179470* CHECK TO ENSURE THE CURRENT DC TO UPDATE CASEPACK               17947071
179480* APPEARS ON THE TABLE                                            17948071
179481*-----------------------------------------------------------------17948171
179482     MOVE ASC-OPER-UNT-ID         TO DISTHD-OPER-UNT-ID.          17948271
179483     MOVE DP020-USERID            TO DISTHD-DLT-REQ-SRC-ID.       17948371
179484                                                                  17948471
179485     EXEC SQL                                                     17948571
179486          UPDATE TDISTHD                                          17948671
179487             SET                                                  17948771
179488                 PRC_AREA_MODU_ID  = :DISTHD-PRC-AREA-MODU-ID     17948871
179489               , TOT_CART_CNT      = :DISTHD-TOT-CART-CNT         17948971
179490               , P2L_CART_CNT      = :DISTHD-P2L-CART-CNT         17949071
179500               , CRE_USR_ID        = :DISTHD-CRE-USR-ID           17950071
179510               , SYS_CRE_CDE       = :DISTHD-SYS-CRE-CDE          17951071
179520               , INPK_UNT_QTY      = :DISTHD-INPK-UNT-QTY         17952071
179530               , OTPK_UNT_QTY      = :DISTHD-OTPK-UNT-QTY         17953071
179540               , SPC_INSTR_DESC    = :DISTHD-SPC-INSTR-DESC       17954071
179550               , FCSE_CART_CNT     = :DISTHD-FCSE-CART-CNT        17955071
179560               , FCSE_LBL_TYP_CDE  = :DISTHD-FCSE-LBL-TYP-CDE     17956071
179570               , INPK_CART_CNT     = :DISTHD-INPK-CART-CNT        17957071
179580               , CART_DWNLD_DTE    = :PC-DEFAULT-DTE              17958071
179590               , CART_DWNLD_TM     = :PC-DEFAULT-TM               17959071
179600               ,CART_DWNLD_USR_ID  = :DISTHD-CART-DWNLD-USR-ID    17960071
179610               ,INPK_CNVYB_IND     = :DISTHD-INPK-CNVYB-IND       17961071
179620               ,FCSE_CNFRMN_PGM_ID = :DISTHD-FCSE-CNFRMN-PGM-ID   17962071
179630               ,FCSE_CNFRMN_USR_ID = :DISTHD-FCSE-CNFRMN-USR-ID   17963071
179640               ,CRE_LBL_OPT_CDE    = :DISTHD-CRE-LBL-OPT-CDE      17964071
179650               ,FCSE_FCLTY_AREA_ID = :DISTHD-FCSE-FCLTY-AREA-ID   17965071
179660               ,ODD_CART_UNT_QTY   = :DISTHD-ODD-CART-UNT-QTY     17966071
179670               ,DLT_REQ_TMST       =  CURRENT TIMESTAMP           17967071
179680               ,DLT_REQ_SRC_ID     = :DISTHD-DLT-REQ-SRC-ID       17968071
179690               ,PREPK_LNE_PRC_CDE  = :DISTHD-PREPK-LNE-PRC-CDE    17969071
179700               ,PRCG_STAT_CDE      = :DISTHD-PRCG-STAT-CDE        17970071
179710               ,CAL_UNT_PRCD_QTY   = :DISTHD-CAL-UNT-PRCD-QTY     17971071
179720               ,UCC128_DAT_USG_CDE = :DISTHD-UCC128-DAT-USG-CDE   17972071
179730               ,OPER_UNT_ID        = :DISTHD-OPER-UNT-ID          17973071
179740               ,RSLTS_RCVD_TMST    = :PC-DEFAULT-TIMESTAMP        17974071
179750           WHERE ORD_NBR           = :DK-PO-NBR                   17975071
179760             AND RCVR_SEQ_NBR      = :DK-REC-SEQ-NBR              17976071
179770             AND ORD_LNE_NBR       = :PV-PRPK-REC-ORD-LNE-NBR     17977071
179780     END-EXEC.                                                    17978071
179790                                                                  17979071
179800     EVALUATE TRUE                                                17980071
179810         WHEN SQLCODE = ZERO                                      17981071
179820              MOVE PV-PRPK-REC-ORD-LNE-NBR TO DK-LINE-NBR         17982071
179830              PERFORM 7475-CREATE-TROUBLE                         17983071
179840         WHEN SQLCODE = +100                                      17984071
179850              MOVE  PC-TSYMSG-00116  TO  DP020-MSG-NUMBER         17985071
179860              SET DP020-MSG-INFORMATIONAL                         17986071
179870                  PS-ERROR                 TO TRUE                17987071
179880         WHEN SQLCODE = -904                                      17988071
179890         WHEN SQLCODE = -911                                      17989071
179900         WHEN SQLCODE = -913                                      17990071
179910             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   17991071
179920             MOVE '4526-DELETE-PREPK-HEADER' TO PV-SOFT-PARAGRAPH 17992071
179930             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 17993071
179940             MOVE LENGTH OF PV-CICS-MSG-AREA2                     17994071
179950               TO PV-COMMAREA-LENGTH                              17995071
179960             EXEC CICS                                            17996071
179970                  WRITEQ TD                                       17997071
179980                   QUEUE  ('CSSL')                                17998071
179990                    FROM  (PV-CICS-MSG-AREA2)                     17999071
180000                  LENGTH  (PV-COMMAREA-LENGTH)                    18000071
180010                    RESP  (PV-CICS-RESP)                          18001071
180020             END-EXEC                                             18002071
180030              MOVE  PC-TSYMSG-00551  TO  DP020-MSG-NUMBER         18003071
180040              PERFORM 9900-SOFT-ABORT                             18004071
180050         WHEN SQLWARN0 NOT = SPACES                               18005071
180060         WHEN SQLCODE NOT EQUAL ZERO                              18006071
180070              MOVE '4526-DELETE-PREPK-HEADER'                     18007071
180080                                   TO DP013-PARAGRAPH             18008071
180090              MOVE 'DELETE TRANSACTION HEADER ROW - PREPACKS'     18009071
180100                                   TO DP013-MESSAGE-TEXT (1)      18010071
180110              MOVE SQLCA           TO DP013-SQLCA                 18011071
180120              MOVE 'TDISTHD'       TO DP013-DB2-TABLE-NAME (1)    18012071
180130              SET DP013-DB2-ABEND  TO TRUE                        18013071
180140              PERFORM DP013-0000-PROCESS-ABEND                    18014071
180150     END-EVALUATE.                                                18015071
180160*----------------------------------------------------------------*18016071
180170*  CHECK IF THERE PHYSICAL LABELS SELECTED FOR DELETE THAT HAVE   18017071
180180*  AN ACTIVE DIVERT                                               18018071
180190*----------------------------------------------------------------*18019071
180200 4527-CHECK-DVRTD-CRTNS.                                          18020071
180210     SET  PS-NO-SOFT-ABORT-ERROR          TO  TRUE.               18021071
180220                                                                  18022071
180230     EXEC SQL                                                     18023071
180240       SELECT DISTINCT (B.SHIPT_UNT_ID)                           18024071
180250         INTO :SUT00024-SHIPT-UNT-ID                              18025071
180260         FROM SUT_OTBND_UPC A                                     18026071
180270            , SUT_OTBND_CART B                                    18027071
180280            , TSUCRDV C                                           18028071
180290        WHERE  A.SHIPT_UNT_ID     = B.SHIPT_UNT_ID                18029071
180300          AND  A.SHIPT_UNT_ID     = C.SHIPT_UNT_ID                18030071
180310          AND  A.TRN_NBR            = :DK-PO-NBR                  18031071
180320          AND  A.RCVR_SEQ_NBR       = :DK-REC-SEQ-NBR             18032071
180330          AND  A.TRN_LNE_NBR        = :DK-LINE-NBR                18033071
180340          AND  B.CART_SRC_CDE       = 'CPS'                       18034071
180350          AND  B.ACTV_IND           = 'Y'                         18035071
180360          AND  C.ACTV_CDE           = 'A'                         18036071
180370     END-EXEC.                                                    18037071
180380                                                                  18038071
180390     EVALUATE TRUE                                                18039071
180400         WHEN SQLCODE = ZERO                                      18040071
180410         WHEN SQLCODE = -811                                      18041071
180420              MOVE  PC-TSYMSG-02973  TO  DP020-MSG-NUMBER         18042071
180430              SET DP020-MSG-INFORMATIONAL                         18043071
180440                  PS-ERROR                                        18044071
180450                  PS-SOFT-ABORT-ERROR       TO TRUE               18045071
180460         WHEN SQLCODE = +100                                      18046071
180470            PERFORM 4528-CHECK-SCND-ON-CRTNS                      18047071
180480         WHEN SQLCODE = -904                                      18048071
180490         WHEN SQLCODE = -911                                      18049071
180500         WHEN SQLCODE = -913                                      18050071
180510                                                                  18051071
180520              MOVE SQLCODE                   TO PV-SOFT-SQLCODE   18052071
180530              MOVE '4527-CHECK-DVRTD-CRTNS'  TO PV-SOFT-PARAGRAPH 18053071
180540              MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2 18054071
180550              MOVE LENGTH OF PV-CICS-MSG-AREA2                    18055071
180560                TO PV-COMMAREA-LENGTH                             18056071
180570              EXEC CICS                                           18057071
180580                  WRITEQ TD                                       18058071
180590                   QUEUE  ('CSSL')                                18059071
180600                    FROM  (PV-CICS-MSG-AREA2)                     18060071
180610                  LENGTH  (PV-COMMAREA-LENGTH)                    18061071
180620                    RESP  (PV-CICS-RESP)                          18062071
180630              END-EXEC                                            18063071
180640              MOVE  PC-TSYMSG-00551  TO  DP020-MSG-NUMBER         18064071
180650              PERFORM 9900-SOFT-ABORT                             18065071
180660                                                                  18066071
180670         WHEN SQLWARN0 NOT = SPACES                               18067071
180680         WHEN SQLCODE NOT EQUAL ZERO                              18068071
180690              MOVE '4527-CHECK-DVRTD-CRTNS'                       18069071
180700                                   TO DP013-PARAGRAPH             18070071
180710              MOVE 'SELECT FOR DIVERTED CARTONS '                 18071071
180720                                   TO DP013-MESSAGE-TEXT (1)      18072071
180730              MOVE SQLCA           TO DP013-SQLCA                 18073071
180740              MOVE 'SUT_OTBND_UPC' TO DP013-DB2-TABLE-NAME (1)    18074071
180750              MOVE 'TSUCRDV'       TO DP013-DB2-TABLE-NAME (2)    18075071
180760              SET DP013-DB2-ABEND  TO TRUE                        18076071
180770              PERFORM DP013-0000-PROCESS-ABEND                    18077071
180780     END-EVALUATE.                                                18078071
180790                                                                  18079071
180800 4527A-CHECK-DVRTD-CRTNS.                                         18080071
180810     SET  PS-NO-SOFT-ABORT-ERROR          TO  TRUE.               18081071
180820                                                                  18082071
180830     EXEC SQL                                                     18083071
180840       SELECT DISTINCT (B.SHIPT_UNT_ID)                           18084071
180850         INTO :SUT00024-SHIPT-UNT-ID                              18085071
180860         FROM SUT_OTBND_UPC A                                     18086071
180870            , SUT_OTBND_CART B                                    18087071
180880            , TSUCRDV C                                           18088071
180890            , TRECITM D                                           18089071
180900        WHERE  A.SHIPT_UNT_ID     = B.SHIPT_UNT_ID                18090071
180910          AND  A.SHIPT_UNT_ID     = C.SHIPT_UNT_ID                18091071
180920          AND  A.TRN_NBR            = :DK-PO-NBR                  18092071
180930          AND  A.RCVR_SEQ_NBR       = :DK-REC-SEQ-NBR             18093071
180940          AND  A.TRN_NBR            = D.ORD_NBR                   18094071
180950          AND  A.RCVR_SEQ_NBR       = D.REC_SEQ_NBR               18095071
180960          AND  A.TRN_LNE_NBR        = D.ORD_LNE_NBR               18096071
180970          AND  D.PREPK_ID           = :DK-PREPK-ID                18097071
180980          AND  B.CART_SRC_CDE       = 'CPS'                       18098071
180990          AND  B.ACTV_IND           = 'Y'                         18099071
181000          AND  C.ACTV_CDE           = 'A'                         18100071
181010     END-EXEC.                                                    18101071
181020                                                                  18102071
181030     EVALUATE TRUE                                                18103071
181040         WHEN SQLCODE = ZERO                                      18104071
181050         WHEN SQLCODE = -811                                      18105071
181060              MOVE  PC-TSYMSG-02973  TO  DP020-MSG-NUMBER         18106071
181070              SET DP020-MSG-INFORMATIONAL                         18107071
181080                  PS-ERROR                                        18108071
181090                  PS-SOFT-ABORT-ERROR       TO TRUE               18109071
181100         WHEN SQLCODE = +100                                      18110071
181110            PERFORM 4528A-CHECK-SCND-ON-CRTNS                     18111071
181120         WHEN SQLCODE = -904                                      18112071
181130         WHEN SQLCODE = -911                                      18113071
181140         WHEN SQLCODE = -913                                      18114071
181150                                                                  18115071
181160              MOVE SQLCODE                   TO PV-SOFT-SQLCODE   18116071
181170              MOVE '4527A-CHECK-DVRTD-CRTNS' TO PV-SOFT-PARAGRAPH 18117071
181180              MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2 18118071
181190              MOVE LENGTH OF PV-CICS-MSG-AREA2                    18119071
181200                TO PV-COMMAREA-LENGTH                             18120071
181210              EXEC CICS                                           18121071
181220                  WRITEQ TD                                       18122071
181230                   QUEUE  ('CSSL')                                18123071
181240                    FROM  (PV-CICS-MSG-AREA2)                     18124071
181250                  LENGTH  (PV-COMMAREA-LENGTH)                    18125071
181260                    RESP  (PV-CICS-RESP)                          18126071
181270              END-EXEC                                            18127071
181280              MOVE  PC-TSYMSG-00551  TO  DP020-MSG-NUMBER         18128071
181290              PERFORM 9900-SOFT-ABORT                             18129071
181300                                                                  18130071
181310         WHEN SQLWARN0 NOT = SPACES                               18131071
181320         WHEN SQLCODE NOT EQUAL ZERO                              18132071
181330              MOVE '4527A-CHECK-DVRTD-CRTNS'                      18133071
181340                                   TO DP013-PARAGRAPH             18134071
181350              MOVE 'SELECT FOR DIVERTED CARTONS '                 18135071
181360                                   TO DP013-MESSAGE-TEXT (1)      18136071
181370              MOVE SQLCA           TO DP013-SQLCA                 18137071
181380              MOVE 'SUT_OTBND_UPC' TO DP013-DB2-TABLE-NAME (1)    18138071
181390              MOVE 'TSUCRDV'       TO DP013-DB2-TABLE-NAME (2)    18139071
181400              SET DP013-DB2-ABEND  TO TRUE                        18140071
181410              PERFORM DP013-0000-PROCESS-ABEND                    18141071
181420     END-EVALUATE.                                                18142071
181430                                                                  18143071
181440*----------------------------------------------------------------*18144071
181450*  CHECK IF THERE PHYSICAL LABELS SELECTED FOR DELETE THAT HAVE   18145071
181460*  AN ACTIVE SCAN ON                                              18146071
181470*----------------------------------------------------------------*18147071
181480 4528-CHECK-SCND-ON-CRTNS.                                        18148071
181490     SET  PS-NO-SOFT-ABORT-ERROR          TO  TRUE.               18149071
181500                                                                  18150071
181510     EXEC SQL                                                     18151071
181520       SELECT DISTINCT (B.SHIPT_UNT_ID)                           18152071
181530         INTO :SUT00024-SHIPT-UNT-ID                              18153071
181540         FROM SUT_OTBND_UPC A                                     18154071
181550            , SUT_OTBND_CART B                                    18155071
181560            , SUT_OTBND_LOC C                                     18156071
181570        WHERE  A.SHIPT_UNT_ID     = B.SHIPT_UNT_ID                18157071
181580          AND  A.SHIPT_UNT_ID     = C.SHIPT_UNT_ID                18158071
181590          AND  A.TRN_NBR            = :DK-PO-NBR                  18159071
181600          AND  A.RCVR_SEQ_NBR       = :DK-REC-SEQ-NBR             18160071
181610          AND  A.TRN_LNE_NBR        = :DK-LINE-NBR                18161071
181620          AND  B.CART_SRC_CDE       = 'CPS'                       18162071
181630          AND  B.ACTV_IND           = 'Y'                         18163071
181640          AND  C.SCN_CDE            = 'SHON'                      18164071
181650          AND  C.ACTV_CDE           = 'A'                         18165071
181660     END-EXEC.                                                    18166071
181670                                                                  18167071
181680     EVALUATE TRUE                                                18168071
181690         WHEN SQLCODE = ZERO                                      18169071
181700         WHEN SQLCODE = -811                                      18170071
181710              MOVE  PC-TSYMSG-03350  TO  DP020-MSG-NUMBER         18171071
181720              SET DP020-MSG-INFORMATIONAL                         18172071
181730                  PS-ERROR                                        18173071
181740                  PS-SOFT-ABORT-ERROR       TO TRUE               18174071
181750         WHEN SQLCODE = +100                                      18175071
181760              CONTINUE                                            18176071
181770         WHEN SQLCODE = -904                                      18177071
181780         WHEN SQLCODE = -911                                      18178071
181790         WHEN SQLCODE = -913                                      18179071
181800                                                                  18180071
181810              MOVE SQLCODE                    TO PV-SOFT-SQLCODE  18181071
181820              MOVE '4528-CHECK-SCND-ON-CRTNS' TO PV-SOFT-PARAGRAPH18182071
181830              MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2 18183071
181840              MOVE LENGTH OF PV-CICS-MSG-AREA2                    18184071
181850                TO PV-COMMAREA-LENGTH                             18185071
181860              EXEC CICS                                           18186071
181870                  WRITEQ TD                                       18187071
181880                   QUEUE  ('CSSL')                                18188071
181890                    FROM  (PV-CICS-MSG-AREA2)                     18189071
181900                  LENGTH  (PV-COMMAREA-LENGTH)                    18190071
181910                    RESP  (PV-CICS-RESP)                          18191071
181920              END-EXEC                                            18192071
181930              MOVE  PC-TSYMSG-00551  TO  DP020-MSG-NUMBER         18193071
181940              PERFORM 9900-SOFT-ABORT                             18194071
181950                                                                  18195071
181960         WHEN SQLWARN0 NOT = SPACES                               18196071
181970         WHEN SQLCODE NOT EQUAL ZERO                              18197071
181980              MOVE '4528-CHECK-SCND-ON-CRTNS'                     18198071
181990                                   TO DP013-PARAGRAPH             18199071
182000              MOVE 'SELECT FOR SCANNED ON CRTNS '                 18200071
182010                                   TO DP013-MESSAGE-TEXT (1)      18201071
182020              MOVE SQLCA           TO DP013-SQLCA                 18202071
182030              MOVE 'SUT_OTBND_UPC' TO DP013-DB2-TABLE-NAME (1)    18203071
182040              MOVE 'SUT_OTBND_LOC' TO DP013-DB2-TABLE-NAME (2)    18204071
182050              SET DP013-DB2-ABEND  TO TRUE                        18205071
182060              PERFORM DP013-0000-PROCESS-ABEND                    18206071
182070     END-EVALUATE.                                                18207071
182080                                                                  18208071
182090*----------------------------------------------------------------*18209071
182100 4528A-CHECK-SCND-ON-CRTNS.                                       18210071
182110     SET  PS-NO-SOFT-ABORT-ERROR          TO  TRUE.               18211071
182120                                                                  18212071
182130     EXEC SQL                                                     18213071
182140       SELECT DISTINCT (B.SHIPT_UNT_ID)                           18214071
182150         INTO :SUT00024-SHIPT-UNT-ID                              18215071
182160         FROM SUT_OTBND_UPC A                                     18216071
182170            , SUT_OTBND_CART B                                    18217071
182180            , SUT_OTBND_LOC C                                     18218071
182190            , TRECITM D                                           18219071
182200        WHERE  A.SHIPT_UNT_ID     = B.SHIPT_UNT_ID                18220071
182210          AND  A.SHIPT_UNT_ID     = C.SHIPT_UNT_ID                18221071
182220          AND  A.TRN_NBR            = :DK-PO-NBR                  18222071
182230          AND  A.RCVR_SEQ_NBR       = :DK-REC-SEQ-NBR             18223071
182240          AND  A.TRN_NBR            = D.ORD_NBR                   18224071
182250          AND  A.RCVR_SEQ_NBR       = D.REC_SEQ_NBR               18225071
182260          AND  A.TRN_LNE_NBR        = D.ORD_LNE_NBR               18226071
182270          AND  D.PREPK_ID           = :DK-PREPK-ID                18227071
182280          AND  B.CART_SRC_CDE       = 'CPS'                       18228071
182290          AND  B.ACTV_IND           = 'Y'                         18229071
182300          AND  C.SCN_CDE            = 'SHON'                      18230071
182310          AND  C.ACTV_CDE           = 'A'                         18231071
182320     END-EXEC.                                                    18232071
182330                                                                  18233071
182340     EVALUATE TRUE                                                18234071
182350         WHEN SQLCODE = ZERO                                      18235071
182360         WHEN SQLCODE = -811                                      18236071
182370              MOVE  PC-TSYMSG-03350  TO  DP020-MSG-NUMBER         18237071
182380              SET DP020-MSG-INFORMATIONAL                         18238071
182390                  PS-ERROR                                        18239071
182400                  PS-SOFT-ABORT-ERROR       TO TRUE               18240071
182410         WHEN SQLCODE = +100                                      18241071
182420              CONTINUE                                            18242071
182430         WHEN SQLCODE = -904                                      18243071
182440         WHEN SQLCODE = -911                                      18244071
182450         WHEN SQLCODE = -913                                      18245071
182460                                                                  18246071
182470              MOVE SQLCODE                    TO PV-SOFT-SQLCODE  18247071
182480              MOVE '4528A-CHECK-SCND-ON-CRTNS'                    18248071
182490                                              TO PV-SOFT-PARAGRAPH18249071
182500              MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2 18250071
182510              MOVE LENGTH OF PV-CICS-MSG-AREA2                    18251071
182520                TO PV-COMMAREA-LENGTH                             18252071
182530              EXEC CICS                                           18253071
182540                  WRITEQ TD                                       18254071
182550                   QUEUE  ('CSSL')                                18255071
182560                    FROM  (PV-CICS-MSG-AREA2)                     18256071
182570                  LENGTH  (PV-COMMAREA-LENGTH)                    18257071
182580                    RESP  (PV-CICS-RESP)                          18258071
182590              END-EXEC                                            18259071
182600              MOVE  PC-TSYMSG-00551  TO  DP020-MSG-NUMBER         18260071
182610              PERFORM 9900-SOFT-ABORT                             18261071
182620                                                                  18262071
182630         WHEN SQLWARN0 NOT = SPACES                               18263071
182640         WHEN SQLCODE NOT EQUAL ZERO                              18264071
182650              MOVE '4528A-CHECK-SCND-ON-CRTNS'                    18265071
182660                                   TO DP013-PARAGRAPH             18266071
182670              MOVE 'SELECT FOR SCANNED ON CRTNS '                 18267071
182680                                   TO DP013-MESSAGE-TEXT (1)      18268071
182690              MOVE SQLCA           TO DP013-SQLCA                 18269071
182700              MOVE 'SUT_OTBND_UPC' TO DP013-DB2-TABLE-NAME (1)    18270071
182710              MOVE 'SUT_OTBND_LOC' TO DP013-DB2-TABLE-NAME (2)    18271071
182720              SET DP013-DB2-ABEND  TO TRUE                        18272071
182730              PERFORM DP013-0000-PROCESS-ABEND                    18273071
182740     END-EVALUATE.                                                18274071
182750                                                                  18275071
182760*----------------------------------------------------------------*18276071
182770*                                                                *18277071
182780*----------------------------------------------------------------*18278071
182790 4530-CHECK-RCVR-ERROR.                                           18279071
182800                                                                  18280071
182810     IF  ASC-PO-RCVR-DWNLD-P2L-Y                                  18281071
182820         PERFORM 4540-RCVR-DOWNLOADED                             18282071
182830     ELSE                                                         18283071
182840     IF  ASC-PO-RCVR-TROUBLE-YES                                  18284071
182850         PERFORM 4545-RCVR-TROUBLE                                18285071
182860     ELSE                                                         18286071
182870     IF  ASC-INVALID-INPK-YES                                     18287071
182880         PERFORM 4550-RCVR-INPK-ERROR                             18288071
182890     ELSE                                                         18289071
182900     IF  ASC-INVALID-OTPK-YES                                     18290071
182910         PERFORM 4555-RCVR-OTPK-ERROR                             18291071
182920     ELSE                                                         18292071
182930     IF  ASC-INVALID-DV-RTV-OTPK                                  18293071
182940         PERFORM 4556-DC-RTV-OTPK-ERR                             18294071
182950     ELSE                                                         18295071
182960     IF  ASC-INVALID-OTPK-ODD                                     18296071
182970         PERFORM 4560-RCVR-OTPK-ODD-ERROR.                        18297071
182980                                                                  18298071
182990                                                                  18299071
183000*----------------------------------------------------------------*18300071
183010* UPDATE UCC128 LABEL XREF TO INACTIVATE ROWS                    *18301071
183020*----------------------------------------------------------------*18302071
183030 4532-LABEL-XREF.                                                 18303071
183040                                                                  18304071
183050     SET  PS-NOT-EOF-LBL-XREF-CSR  TO  TRUE.                      18305071
183060                                                                  18306071
183070     IF  ASC-PRE-PACK-ORDER                                       18307071
183080         MOVE  ZEROES      TO  DK-LINE-NBR-2                      18308071
183090     ELSE                                                         18309071
183100         MOVE DK-LINE-NBR  TO  DK-LINE-NBR-2                      18310071
183110         MOVE ZEROES       TO  DK-PREPK-ID                        18311071
183120     END-IF                                                       18312071
183130                                                                  18313071
183140     PERFORM 4533-OPEN-XREF-CSR.                                  18314071
183150     PERFORM 4534-FETCH-XREF-CSR                                  18315071
183160       UNTIL PS-SOFT-ABORT-ERROR                                  18316071
183170          OR PS-EOF-LBL-XREF-CSR.                                 18317071
183180     PERFORM 4535-CLOSE-XREF-CSR.                                 18318071
183190                                                                  18319071
183200                                                                  18320071
183210*----------------------------------------------------------------*18321071
183220* OPEN LABEL CROSS REFERENCE CURSOR                              *18322071
183230*----------------------------------------------------------------*18323071
183240 4533-OPEN-XREF-CSR.                                              18324071
183250                                                                  18325071
183260     MOVE 'CURSOR:  LBL_XREF_CSR'                                 18326071
183270                       TO DP013-MESSAGE-TEXT (2).                 18327071
183280     EXEC SQL                                                     18328071
183290          OPEN LBL_XREF_CSR                                       18329071
183300     END-EXEC.                                                    18330071
183310                                                                  18331071
183320     EVALUATE TRUE                                                18332071
183330         WHEN SQLCODE = ZERO                                      18333071
183340             CONTINUE                                             18334071
183350         WHEN SQLCODE = -904                                      18335071
183360         WHEN SQLCODE = -911                                      18336071
183370         WHEN SQLCODE = -913                                      18337071
183380             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    18338071
183390             MOVE '4533-OPEN-XREF-CSR     ' TO PV-SOFT-PARAGRAPH  18339071
183400             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  18340071
183410             MOVE LENGTH OF PV-CICS-MSG-AREA2                     18341071
183420               TO PV-COMMAREA-LENGTH                              18342071
183430             EXEC CICS                                            18343071
183440                  WRITEQ TD                                       18344071
183450                   QUEUE  ('CSSL')                                18345071
183460                    FROM  (PV-CICS-MSG-AREA2)                     18346071
183470                  LENGTH  (PV-COMMAREA-LENGTH)                    18347071
183480                    RESP  (PV-CICS-RESP)                          18348071
183490             END-EXEC                                             18349071
183500             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          18350071
183510             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              18351071
183520             PERFORM 9900-SOFT-ABORT                              18352071
183530         WHEN SQLWARN0 NOT = SPACES                               18353071
183540         WHEN SQLCODE < ZERO                                      18354071
183550         WHEN SQLCODE > ZERO                                      18355071
183560             MOVE '4533-OPEN-XREF-CSR     '                       18356071
183570                               TO DP013-PARAGRAPH                 18357071
183580             MOVE 'OPEN LABEL XREF CURSOR - '                     18358071
183590                               TO DP013-MESSAGE-TEXT (1)          18359071
183600             MOVE SQLCA        TO DP013-SQLCA                     18360071
183610             MOVE 'TLBVRDA '   TO DP013-DB2-TABLE-NAME (1)        18361071
183620             MOVE 'TSULBXF '   TO DP013-DB2-TABLE-NAME (2)        18362071
183630             SET DP013-DB2-ABEND                                  18363071
183640                 DP013-XCTL-DISPLAY-RESTART TO TRUE               18364071
183650             PERFORM DP013-0000-PROCESS-ABEND                     18365071
183660     END-EVALUATE.                                                18366071
183670                                                                  18367071
183680                                                                  18368071
183690*----------------------------------------------------------------*18369071
183700* FETCH LABEL XREF CURSOR - INACTIVATE ROWS                      *18370071
183710*----------------------------------------------------------------*18371071
183720 4534-FETCH-XREF-CSR.                                             18372071
183730                                                                  18373071
183740     MOVE 'CURSOR:  LBL_XREF_CSR'                                 18374071
183750                       TO DP013-MESSAGE-TEXT (2).                 18375071
183760                                                                  18376071
183770     EXEC SQL                                                     18377071
183780          FETCH LBL_XREF_CSR                                      18378071
183790           INTO :LBVRDA-BRCDE-NBR                                 18379071
183800               ,:LBVRDA-CART-LBL-TYP-CDE                          18380071
183810     END-EXEC.                                                    18381071
183820                                                                  18382071
183830     EVALUATE TRUE                                                18383071
183840         WHEN SQLCODE = ZERO                                      18384071
183850              PERFORM 4536-UPDATE-XREF                            18385071
183860                                                                  18386071
183870         WHEN SQLCODE = +100                                      18387071
183880         SET PS-EOF-LBL-XREF-CSR                                  18388071
183890                                   TO TRUE                        18389071
183900         WHEN SQLCODE = -904                                      18390071
183910         WHEN SQLCODE = -911                                      18391071
183920         WHEN SQLCODE = -913                                      18392071
183930             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   18393071
183940             MOVE '4534-FETCH-XREF-CSR     ' TO PV-SOFT-PARAGRAPH 18394071
183950             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 18395071
183960             MOVE LENGTH OF PV-CICS-MSG-AREA2                     18396071
183970               TO PV-COMMAREA-LENGTH                              18397071
183980             EXEC CICS                                            18398071
183990                  WRITEQ TD                                       18399071
184000                   QUEUE  ('CSSL')                                18400071
184010                    FROM  (PV-CICS-MSG-AREA2)                     18401071
184020                  LENGTH  (PV-COMMAREA-LENGTH)                    18402071
184030                    RESP  (PV-CICS-RESP)                          18403071
184040             END-EXEC                                             18404071
184050             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          18405071
184060             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              18406071
184070             PERFORM 9900-SOFT-ABORT                              18407071
184080         WHEN SQLWARN0 NOT = SPACE                                18408071
184090         WHEN SQLCODE NOT = ZERO                                  18409071
184100              MOVE ASC-PO-LINE-NBR                                18410071
184110                                TO DP013-MESSAGE-TEXT (3)         18411071
184120              MOVE '4534-FETCH-XREF-CSR     '                     18412071
184130                               TO DP013-PARAGRAPH                 18413071
184140              MOVE 'FETCH LBL_XREF_CURSOR     '                   18414071
184150                               TO DP013-MESSAGE-TEXT (1)          18415071
184160              MOVE SQLCA       TO DP013-SQLCA                     18416071
184170              SET DP013-DB2-ABEND                                 18417071
184180                               TO TRUE                            18418071
184190              PERFORM DP013-0000-PROCESS-ABEND                    18419071
184200     END-EVALUATE.                                                18420071
184210                                                                  18421071
184220                                                                  18422071
184230*----------------------------------------------------------------*18423071
184240* CLOSE LABEL CROSS REFERENCE CURSOR                             *18424071
184250*----------------------------------------------------------------*18425071
184260 4535-CLOSE-XREF-CSR.                                             18426071
184270                                                                  18427071
184280     MOVE 'CURSOR:  LBL_XREF_CSR'                                 18428071
184290                       TO DP013-MESSAGE-TEXT (2).                 18429071
184300     EXEC SQL                                                     18430071
184310          CLOSE LBL_XREF_CSR                                      18431071
184320     END-EXEC.                                                    18432071
184330                                                                  18433071
184340     EVALUATE TRUE                                                18434071
184350         WHEN SQLCODE = ZERO                                      18435071
184360             CONTINUE                                             18436071
184370         WHEN SQLCODE = -904                                      18437071
184380         WHEN SQLCODE = -911                                      18438071
184390         WHEN SQLCODE = -913                                      18439071
184400             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   18440071
184410             MOVE '4535-CLOSE-XREF-CSR     ' TO PV-SOFT-PARAGRAPH 18441071
184420             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 18442071
184430             MOVE LENGTH OF PV-CICS-MSG-AREA2                     18443071
184440               TO PV-COMMAREA-LENGTH                              18444071
184450             EXEC CICS                                            18445071
184460                  WRITEQ TD                                       18446071
184470                   QUEUE  ('CSSL')                                18447071
184480                    FROM  (PV-CICS-MSG-AREA2)                     18448071
184490                  LENGTH  (PV-COMMAREA-LENGTH)                    18449071
184500                    RESP  (PV-CICS-RESP)                          18450071
184510             END-EXEC                                             18451071
184520             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          18452071
184530             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              18453071
184540             PERFORM 9900-SOFT-ABORT                              18454071
184550         WHEN SQLWARN0 NOT = SPACES                               18455071
184560         WHEN SQLCODE < ZERO                                      18456071
184570         WHEN SQLCODE > ZERO                                      18457071
184580             MOVE '4535-CLOSE-XREF-CSR     '                      18458071
184590                               TO DP013-PARAGRAPH                 18459071
184600             MOVE 'CLOSE LBL_XREF_CURSOR       '                  18460071
184610                               TO DP013-MESSAGE-TEXT (1)          18461071
184620             MOVE SQLCA        TO DP013-SQLCA                     18462071
184630             MOVE 'TLBVRDA '   TO DP013-DB2-TABLE-NAME (1)        18463071
184640             MOVE 'TSULBXF '   TO DP013-DB2-TABLE-NAME (2)        18464071
184650             SET DP013-DB2-ABEND                                  18465071
184660                 DP013-XCTL-DISPLAY-RESTART TO TRUE               18466071
184670             PERFORM DP013-0000-PROCESS-ABEND                     18467071
184680     END-EVALUATE.                                                18468071
184690                                                                  18469071
184700                                                                  18470071
184710*----------------------------------------------------------------*18471071
184720*  INACTIVATE LABEL CROSS REFERENCE ROW                          *18472071
184730*----------------------------------------------------------------*18473071
184740 4536-UPDATE-XREF.                                                18474071
184750                                                                  18475071
184760     SET  PS-NO-SOFT-ABORT-ERROR          TO  TRUE.               18476071
184770                                                                  18477071
184780     EXEC SQL                                                     18478071
184790          UPDATE TSULBXF                                          18479071
184800             SET                                                  18480071
184810                  STAT_CDE           = 'I'                        18481071
184820                 ,LAST_STAT_CHG_TMST =  CURRENT TIMESTAMP         18482071
184830           WHERE  BRCDE_NBR          = :LBVRDA-BRCDE-NBR          18483071
184840             AND  STAT_CDE           = 'A'                        18484071
184850     END-EXEC.                                                    18485071
184860                                                                  18486071
184870     EVALUATE TRUE                                                18487071
184880         WHEN SQLCODE = ZERO                                      18488071
184890         WHEN SQLCODE = +100                                      18489071
184900            IF LBVRDA-CART-LBL-TYP-CDE = 'P'                      18490071
184910               CONTINUE                                           18491071
184920            ELSE                                                  18492071
184930               PERFORM 4536A-UPDATE-OTBND-CART                    18493071
184940            END-IF                                                18494071
184950         WHEN SQLCODE = -904                                      18495071
184960         WHEN SQLCODE = -911                                      18496071
184970         WHEN SQLCODE = -913                                      18497071
184980             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   18498071
184990             MOVE '4536-UPDATE-XREF        ' TO PV-SOFT-PARAGRAPH 18499071
185000             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 18500071
185010             MOVE LENGTH OF PV-CICS-MSG-AREA2                     18501071
185020               TO PV-COMMAREA-LENGTH                              18502071
185030             EXEC CICS                                            18503071
185040                  WRITEQ TD                                       18504071
185050                   QUEUE  ('CSSL')                                18505071
185060                    FROM  (PV-CICS-MSG-AREA2)                     18506071
185070                  LENGTH  (PV-COMMAREA-LENGTH)                    18507071
185080                    RESP  (PV-CICS-RESP)                          18508071
185090             END-EXEC                                             18509071
185100              MOVE  PC-TSYMSG-00551  TO  DP020-MSG-NUMBER         18510071
185110              PERFORM 9900-SOFT-ABORT                             18511071
185120                                                                  18512071
185130         WHEN SQLWARN0 NOT = SPACES                               18513071
185140         WHEN SQLCODE NOT EQUAL ZERO                              18514071
185150              MOVE '4536-UPDATE-XREF        '                     18515071
185160                                   TO DP013-PARAGRAPH             18516071
185170              MOVE 'INACTIVATE XREF ROWS      '                   18517071
185180                                   TO DP013-MESSAGE-TEXT (1)      18518071
185190              STRING ' BARCODE - '    DELIMITED BY SIZE           18519071
185200                     LBVRDA-BRCDE-NBR DELIMITED BY SIZE           18520071
185210                                 INTO DP013-MESSAGE-TEXT (1)      18521071
185220              MOVE SQLCA           TO DP013-SQLCA                 18522071
185230              MOVE 'TSULBXF'       TO DP013-DB2-TABLE-NAME (1)    18523071
185240              SET DP013-DB2-ABEND  TO TRUE                        18524071
185250              PERFORM DP013-0000-PROCESS-ABEND                    18525071
185260     END-EVALUATE.                                                18526071
185270*----------------------------------------------------------------*18527071
185280*  INACTIVATE OTBND CART ROWS                                    *18528071
185290*----------------------------------------------------------------*18529071
185300 4536A-UPDATE-OTBND-CART.                                         18530071
185310     MOVE LBVRDA-BRCDE-NBR             TO PV-BAR-CODE.            18531071
185320     MOVE PV-BAR-CODE-OTBND            TO SUT00024-SHIPT-UNT-ID.  18532071
185330     SET  PS-NO-SOFT-ABORT-ERROR       TO  TRUE.                  18533071
185340                                                                  18534071
185350     EXEC SQL                                                     18535071
185360          UPDATE SUT_OTBND_CART                                   18536071
185370             SET                                                  18537071
185380                  ACTV_IND           = 'N'                        18538071
185390           WHERE  SHIPT_UNT_ID       = :SUT00024-SHIPT-UNT-ID     18539071
185400             AND  ACTV_IND           = 'Y'                        18540071
185410     END-EXEC.                                                    18541071
185420                                                                  18542071
185430     EVALUATE TRUE                                                18543071
185440         WHEN SQLCODE = ZERO                                      18544071
185450         WHEN SQLCODE = +100                                      18545071
185460                  CONTINUE                                        18546071
185470                                                                  18547071
185480         WHEN SQLCODE = -904                                      18548071
185490         WHEN SQLCODE = -911                                      18549071
185500         WHEN SQLCODE = -913                                      18550071
185510             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   18551071
185520             MOVE '4536A-UPDATE-OTBND-CART ' TO PV-SOFT-PARAGRAPH 18552071
185530             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 18553071
185540             MOVE LENGTH OF PV-CICS-MSG-AREA2                     18554071
185550               TO PV-COMMAREA-LENGTH                              18555071
185560             EXEC CICS                                            18556071
185570                  WRITEQ TD                                       18557071
185580                   QUEUE  ('CSSL')                                18558071
185590                    FROM  (PV-CICS-MSG-AREA2)                     18559071
185600                  LENGTH  (PV-COMMAREA-LENGTH)                    18560071
185610                    RESP  (PV-CICS-RESP)                          18561071
185620             END-EXEC                                             18562071
185630              MOVE  PC-TSYMSG-00551  TO  DP020-MSG-NUMBER         18563071
185640              PERFORM 9900-SOFT-ABORT                             18564071
185650                                                                  18565071
185660         WHEN SQLWARN0 NOT = SPACES                               18566071
185670         WHEN SQLCODE NOT EQUAL ZERO                              18567071
185680              MOVE '4536A-UPDATE-OTBND-CART '                     18568071
185690                                   TO DP013-PARAGRAPH             18569071
185700              MOVE 'INACTIVATE OTBND ROWS      '                  18570071
185710                                   TO DP013-MESSAGE-TEXT (1)      18571071
185720              STRING ' BARCODE - '    DELIMITED BY SIZE           18572071
185730                     LBVRDA-BRCDE-NBR DELIMITED BY SIZE           18573071
185740                                 INTO DP013-MESSAGE-TEXT (1)      18574071
185750              MOVE SQLCA           TO DP013-SQLCA                 18575071
185760              MOVE 'SUT_OTBND_CART' TO DP013-DB2-TABLE-NAME (1)   18576071
185770              SET DP013-DB2-ABEND  TO TRUE                        18577071
185780              PERFORM DP013-0000-PROCESS-ABEND                    18578071
185790     END-EVALUATE.                                                18579071
185800                                                                  18580071
185900                                                                  18590071
186000*----------------------------------------------------------------*18600071
186100* CALL TO PCKUT027 TO START ZERO LINE WORK ORDER                  18610071
186110*----------------------------------------------------------------*18611071
186120 4538-START-WORK-ORDERS.                                          18612071
186130     INITIALIZE   PC027-COMMAREA-REC.                             18613071
186140     MOVE ASC-CURR-OPER-UNT-ID          TO PC027-OPER-UNT-ID.     18614071
186150     MOVE ASC-CURR-FCLTY-ID             TO PC027-FCLTY-ID.        18615071
186160     MOVE ASC-PO-NBR                    TO PC027-PO-NBR.          18616071
186170     MOVE ASC-REC-SEQ-NBR               TO PC027-REC-SEQ-NBR.     18617071
186180     MOVE PC-CURRENT-PROGRAM-NAME       TO PC027-CALLING-PGM-NAME.18618071
186190                                                                  18619071
186200     CALL PC027-STRT-WO-PGM using DFHEIBLK                        18620071
186210                                  PC027-COMMAREA                  18621071
186220                                  PC027-COMMAREA-REC              18622071
186230                                                                  18623071
186240                                                                  18624071
186250** CURRENTLY THE DC'S DO NOT WANT AN UNSUCCESSFUL CALL TO STOP    18625071
186260** PROCESSING, AS WORK ORDERS CAN BE STARTED MANUALLY             18626071
186270                                                                  18627071
186280     EVALUATE TRUE                                                18628071
186290         WHEN PC027-SUCCESSFUL                                    18629071
186300             CONTINUE                                             18630071
186310         WHEN OTHER                                               18631071
186320             CONTINUE                                             18632071
186330     END-EVALUATE.                                                18633071
186340                                                                  18634071
186350                                                                  18635071
186360*----------------------------------------------------------------*18636071
186370*  CHECK EACH LINE FOR DOWNLOAD ERROR SWITCH.  HIGHLIGHT EACH    *18637071
186380*----------------------------------------------------------------*18638071
186390 4540-RCVR-DOWNLOADED.                                            18639071
186400                                                                  18640071
186410     IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)  AND               18641071
186420         ASC-LNE-DOWNLOADED-YES (ASC-BLK-SUB ASC-ITEM-SUB)        18642071
186430         MOVE -1                 TO  MR-INNER-PACKL (PV-SUB)      18643071
186440         MOVE DP015-UNP-ALP-NOR-OFF                               18644071
186450                                 TO  MR-MODA (PV-SUB)             18645071
186460                                     MR-CARTON-CNTA (PV-SUB)      18646071
186470                                     MR-INNER-PACKA (PV-SUB)      18647071
186480                                     MR-OUTER-PACKA (PV-SUB)      18648071
186490                                     MR-IN-PCK-CONVYA (PV-SUB)    18649071
186500                                     MR-LBL-TYPEA (PV-SUB)        18650071
186510                                     MR-CRE-LBL-OPTA (PV-SUB)     18651071
186520                                     MR-CSEPK-AREAA (PV-SUB)      18652071
186530                                     MR-ODD-CARTONA (PV-SUB)      18653071
186540         MOVE DP015-YELLOW                                        18654071
186550                                 TO  MR-PO-LINEC (PV-SUB)         18655071
186560                                     MR-SKUC (PV-SUB)             18656071
186570         SET  PS-ERROR                                            18657071
186580              DP020-MSG-FATAL                                     18658071
186590              DP030-SET-CURSOR-APPL-1 TO TRUE                     18659071
186600         MOVE PC-TSYMSG-01768  TO  DP020-MSG-NUMBER               18660071
186610     END-IF.                                                      18661071
186620                                                                  18662071
186630                                                                  18663071
186640*----------------------------------------------------------------*18664071
186650*  CHECK EACH LINE FOR IN TROUBLE ERROR SWITCH. HIGHLIGHT EACH   *18665071
186660*----------------------------------------------------------------*18666071
186670 4545-RCVR-TROUBLE.                                               18667071
186680                                                                  18668071
186690     IF  ASC-LNE-TROUBLE-YES (ASC-BLK-SUB ASC-ITEM-SUB)           18669071
186700         MOVE -1                 TO  MR-INNER-PACKL (PV-SUB)      18670071
186710         MOVE DP015-UNP-ALP-NOR-OFF                               18671071
186720                                 TO  MR-MODA (PV-SUB)             18672071
186730                                     MR-CARTON-CNTA (PV-SUB)      18673071
186740                                     MR-INNER-PACKA (PV-SUB)      18674071
186750                                     MR-OUTER-PACKA (PV-SUB)      18675071
186760                                     MR-IN-PCK-CONVYA (PV-SUB)    18676071
186770                                     MR-LBL-TYPEA (PV-SUB)        18677071
186780                                     MR-CRE-LBL-OPTA (PV-SUB)     18678071
186790                                     MR-CSEPK-AREAA (PV-SUB)      18679071
186800                                     MR-ODD-CARTONA (PV-SUB)      18680071
186810         MOVE DP015-YELLOW                                        18681071
186820                                 TO  MR-PO-LINEC (PV-SUB)         18682071
186830                                     MR-SKUC (PV-SUB)             18683071
186840         SET  PS-ERROR                                            18684071
186850              DP020-MSG-FATAL                                     18685071
186860              DP030-SET-CURSOR-APPL-1                             18686071
186870              ASC-PO-RCVR-TROUBLE-YES  TO TRUE                    18687071
186880         MOVE PC-TSYMSG-01769          TO  DP020-MSG-NUMBER       18688071
186890     END-IF.                                                      18689071
186900                                                                  18690071
186910                                                                  18691071
186920*----------------------------------------------------------------*18692071
186930*  CHECK EACH LINE FOR INNERPACK ERROR SWITCH. HIGHLIGHT EACH    *18693071
186940*----------------------------------------------------------------*18694071
186950 4550-RCVR-INPK-ERROR.                                            18695071
186960                                                                  18696071
186970     IF  ASC-LNE-BAD-INPK-Y (ASC-BLK-SUB ASC-ITEM-SUB)            18697071
186980         MOVE -1                 TO  MR-INNER-PACKL (PV-SUB)      18698071
186990         MOVE DP015-UNP-ALP-NOR-MDT                               18699071
187000                                 TO  MR-MODA (PV-SUB)             18700071
187010                                     MR-SELECTA (PV-SUB)          18701071
187020                                     MR-CARTON-CNTA (PV-SUB)      18702071
187030                                     MR-INNER-PACKA (PV-SUB)      18703071
187040                                     MR-OUTER-PACKA (PV-SUB)      18704071
187050                                     MR-IN-PCK-CONVYA (PV-SUB)    18705071
187060                                     MR-LBL-TYPEA (PV-SUB)        18706071
187070                                     MR-CRE-LBL-OPTA (PV-SUB)     18707071
187080                                     MR-CSEPK-AREAA (PV-SUB)      18708071
187090                                     MR-ODD-CARTONA (PV-SUB)      18709071
187100         MOVE DP015-RED                                           18710071
187110                                 TO  MR-INNER-PACKC (PV-SUB)      18711071
187120         MOVE DP015-REVERSE                                       18712071
187130                                 TO  MR-INNER-PACKH (PV-SUB)      18713071
187140         SET  PS-ERROR                                            18714071
187150              DP020-MSG-FATAL                                     18715071
187160                                 TO  TRUE                         18716071
187170         MOVE PC-TSYMSG-01758    TO  DP020-MSG-NUMBER             18717071
187180         SET  DP030-SET-CURSOR-APPL-1                             18718071
187190              ASC-DISTRO-ERROR (ASC-BLK-SUB ASC-ITEM-SUB)         18719071
187200              ASC-CONFIRM-TROUBLE-YES                             18720071
187210                                 TO TRUE                          18721071
187220     END-IF.                                                      18722071
187230                                                                  18723071
187240*----------------------------------------------------------------*18724071
187250*  CHECK EACH LINE FOR OUTERPACK ERROR SWITCH. HIGHLIGHT EACH    *18725071
187260*----------------------------------------------------------------*18726071
187270 4555-RCVR-OTPK-ERROR.                                            18727071
187280                                                                  18728071
187290     IF  ASC-LNE-BAD-OTPK-Y (ASC-BLK-SUB ASC-ITEM-SUB)            18729071
187300         IF  ASC-LNE-UCC128-YES (ASC-BLK-SUB ASC-ITEM-SUB)        18730071
187310             MOVE -1             TO  MR-INNER-PACKL (PV-SUB)      18731071
187320         ELSE                                                     18732071
187330             MOVE -1             TO  MR-OUTER-PACKL (PV-SUB)      18733071
187340         END-IF                                                   18734071
187350         MOVE DP015-UNP-ALP-NOR-OFF                               18735071
187360                                 TO  MR-MODA (PV-SUB)             18736071
187370                                     MR-CARTON-CNTA (PV-SUB)      18737071
187380                                     MR-INNER-PACKA (PV-SUB)      18738071
187390                                     MR-OUTER-PACKA (PV-SUB)      18739071
187400                                     MR-IN-PCK-CONVYA (PV-SUB)    18740071
187410                                     MR-LBL-TYPEA (PV-SUB)        18741071
187420                                     MR-CRE-LBL-OPTA (PV-SUB)     18742071
187430                                     MR-CSEPK-AREAA (PV-SUB)      18743071
187440                                     MR-ODD-CARTONA (PV-SUB)      18744071
187450         MOVE DP015-RED                                           18745071
187460                                 TO  MR-OUTER-PACKC (PV-SUB)      18746071
187470         MOVE DP015-REVERSE                                       18747071
187480                                 TO  MR-OUTER-PACKH (PV-SUB)      18748071
187490         SET  PS-ERROR                                            18749071
187500              DP020-MSG-FATAL    TO  TRUE                         18750071
187510         MOVE PC-TSYMSG-01759  TO  DP020-MSG-NUMBER               18751071
187520         SET  DP030-SET-CURSOR-APPL-1 TO TRUE.                    18752071
187530                                                                  18753071
187540                                                                  18754071
187550*----------------------------------------------------------------*18755071
187560*  CHECK EACH LINE FOR OUTERPACK ERROR SWITCH. HIGHLIGHT EACH    *18756071
187570*----------------------------------------------------------------*18757071
187580 4556-DC-RTV-OTPK-ERR.                                            18758071
187590                                                                  18759071
187600     IF  ASC-LNE-DC-RTV-OTPK (ASC-BLK-SUB ASC-ITEM-SUB)           18760071
187610         IF  ASC-LNE-UCC128-YES (ASC-BLK-SUB ASC-ITEM-SUB)        18761071
187620             MOVE -1             TO  MR-INNER-PACKL (PV-SUB)      18762071
187630         ELSE                                                     18763071
187640             MOVE -1             TO  MR-OUTER-PACKL (PV-SUB)      18764071
187650         END-IF                                                   18765071
187660         MOVE DP015-UNP-ALP-NOR-OFF                               18766071
187670                                 TO  MR-MODA (PV-SUB)             18767071
187680                                     MR-CARTON-CNTA (PV-SUB)      18768071
187690                                     MR-INNER-PACKA (PV-SUB)      18769071
187700                                     MR-OUTER-PACKA (PV-SUB)      18770071
187710                                     MR-IN-PCK-CONVYA (PV-SUB)    18771071
187720                                     MR-LBL-TYPEA (PV-SUB)        18772071
187730                                     MR-CRE-LBL-OPTA (PV-SUB)     18773071
187740                                     MR-CSEPK-AREAA (PV-SUB)      18774071
187750                                     MR-ODD-CARTONA (PV-SUB)      18775071
187760         MOVE DP015-RED                                           18776071
187770                                 TO  MR-OUTER-PACKC (PV-SUB)      18777071
187780         MOVE DP015-REVERSE                                       18778071
187790                                 TO  MR-OUTER-PACKH (PV-SUB)      18779071
187800         SET  PS-ERROR                                            18780071
187810              DP020-MSG-FATAL    TO  TRUE                         18781071
187820         MOVE PC-TSYMSG-01815  TO  DP020-MSG-NUMBER               18782071
187830         SET  DP030-SET-CURSOR-APPL-1 TO TRUE.                    18783071
187840                                                                  18784071
187850                                                                  18785071
187860*----------------------------------------------------------------*18786071
187870*  CHECK EACH LINE FOR OUTERPACK ERROR SWITCH. HIGHLIGHT EACH    *18787071
187880*----------------------------------------------------------------*18788071
187890 4560-RCVR-OTPK-ODD-ERROR.                                        18789071
187900                                                                  18790071
187910     IF  ASC-LNE-BAD-ODD-Y (ASC-BLK-SUB ASC-ITEM-SUB)             18791071
187920         MOVE -1                 TO  MR-ODD-CARTONL (PV-SUB)      18792071
187930         MOVE DP015-UNP-ALP-NOR-OFF                               18793071
187940                                 TO  MR-MODA (PV-SUB)             18794071
187950                                     MR-CARTON-CNTA (PV-SUB)      18795071
187960                                     MR-INNER-PACKA (PV-SUB)      18796071
187970                                     MR-OUTER-PACKA (PV-SUB)      18797071
187980                                     MR-IN-PCK-CONVYA (PV-SUB)    18798071
187990                                     MR-LBL-TYPEA (PV-SUB)        18799071
188000                                     MR-CRE-LBL-OPTA (PV-SUB)     18800071
188010                                     MR-CSEPK-AREAA (PV-SUB)      18801071
188020                                     MR-ODD-CARTONA (PV-SUB)      18802071
188030         MOVE DP015-RED                                           18803071
188040                                 TO  MR-ODD-CARTONC (PV-SUB)      18804071
188050         MOVE DP015-REVERSE                                       18805071
188060                                 TO  MR-ODD-CARTONH (PV-SUB)      18806071
188070         SET  PS-ERROR                                            18807071
188080              DP020-MSG-FATAL    TO  TRUE                         18808071
188090         MOVE PC-TSYMSG-02045  TO  DP020-MSG-NUMBER               18809071
188100         SET  DP030-SET-CURSOR-APPL-1 TO TRUE.                    18810071
188110                                                                  18811071
188120*----------------------------------------------------------------*18812071
188130* SELECT SHIPT-UNT-ID FROM SUT_OTBND_UPC AND UPDATE SUT_OTBND_CART18813071
188140*----------------------------------------------------------------*18814071
188150 4590-SEL-INACTV-OB-CART.                                         18815071
188160                                                                  18816071
188170     SET  PS-NOT-EOF-UPDATE-CARTN-CSR TO TRUE.                    18817071
188180     PERFORM 4592-OPEN-UPD-CARTON-CSR                             18818071
188190     PERFORM 4594-FETCH-UPD-CARTON-CSR                            18819071
188200       UNTIL PS-SOFT-ABORT-ERROR                                  18820071
188210          OR PS-EOF-UPDATE-CARTN-CSR.                             18821071
188220     PERFORM 4596-CLOSE-UPD-CARTON-CSR.                           18822071
188230                                                                  18823071
188240                                                                  18824071
188250*----------------------------------------------------------------*18825071
188260* OPEN LABEL CROSS REFERENCE CURSOR                              *18826071
188270*----------------------------------------------------------------*18827071
188280 4592-OPEN-UPD-CARTON-CSR .                                       18828071
188290                                                                  18829071
188300     MOVE 'CURSOR: UPDATE_CARTON_CSR'                             18830071
188310                       TO DP013-MESSAGE-TEXT (2).                 18831071
188320     EXEC SQL                                                     18832071
188330          OPEN UPDATE_CARTON_CSR                                  18833071
188340     END-EXEC.                                                    18834071
188350                                                                  18835071
188360     EVALUATE TRUE                                                18836071
188370         WHEN SQLCODE = ZERO                                      18837071
188380             CONTINUE                                             18838071
188390         WHEN SQLCODE = -904                                      18839071
188400         WHEN SQLCODE = -911                                      18840071
188410         WHEN SQLCODE = -913                                      18841071
188420             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    18842071
188430             MOVE '4592-OPEN-XREF-CSR     ' TO PV-SOFT-PARAGRAPH  18843071
188440             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  18844071
188450             MOVE LENGTH OF PV-CICS-MSG-AREA2                     18845071
188460               TO PV-COMMAREA-LENGTH                              18846071
188470             EXEC CICS                                            18847071
188480                  WRITEQ TD                                       18848071
188490                   QUEUE  ('CSSL')                                18849071
188500                    FROM  (PV-CICS-MSG-AREA2)                     18850071
188510                  LENGTH  (PV-COMMAREA-LENGTH)                    18851071
188520                    RESP  (PV-CICS-RESP)                          18852071
188530             END-EXEC                                             18853071
188540             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          18854071
188550             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              18855071
188560             PERFORM 9900-SOFT-ABORT                              18856071
188570         WHEN SQLWARN0 NOT = SPACES                               18857071
188580         WHEN SQLCODE < ZERO                                      18858071
188590         WHEN SQLCODE > ZERO                                      18859071
188600             MOVE '4592-OPEN-UPDATE-CARTON'                       18860071
188610                               TO DP013-PARAGRAPH                 18861071
188620             MOVE 'OPEN UPDATE_CARTON_CSR - '                     18862071
188630                               TO DP013-MESSAGE-TEXT (1)          18863071
188640             MOVE SQLCA        TO DP013-SQLCA                     18864071
188650             MOVE 'SUT_OTBND_UPC'  TO DP013-DB2-TABLE-NAME (1)    18865071
188660             SET DP013-DB2-ABEND                                  18866071
188670                 DP013-XCTL-DISPLAY-RESTART TO TRUE               18867071
188680             PERFORM DP013-0000-PROCESS-ABEND                     18868071
188690     END-EVALUATE.                                                18869071
188700                                                                  18870071
188710                                                                  18871071
188720*----------------------------------------------------------------*18872071
188730* FETCH UPDATE CARTON CSR-                                        18873071
188740*----------------------------------------------------------------*18874071
188750 4594-FETCH-UPD-CARTON-CSR.                                       18875071
188760                                                                  18876071
188770     MOVE 'CURSOR: UPDATE_CARTON_CSR'                             18877071
188780                       TO DP013-MESSAGE-TEXT (2).                 18878071
188790                                                                  18879071
188800     EXEC SQL                                                     18880071
188810          FETCH UPDATE_CARTON_CSR                                 18881071
188820           INTO :SUT00028-SHIPT-UNT-ID                            18882071
188830     END-EXEC.                                                    18883071
188840                                                                  18884071
188850     EVALUATE TRUE                                                18885071
188860         WHEN SQLCODE = ZERO                                      18886071
188870              PERFORM 4597-INACTIVATE-OTBND-CART                  18887071
188880         WHEN SQLCODE = +100                                      18888071
188890         SET PS-EOF-UPDATE-CARTN-CSR                              18889071
188900                                   TO TRUE                        18890071
188910         WHEN SQLCODE = -904                                      18891071
188920         WHEN SQLCODE = -911                                      18892071
188930         WHEN SQLCODE = -913                                      18893071
188940             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   18894071
188950             MOVE '4594-FETCH-UPD-CARTON-'   TO PV-SOFT-PARAGRAPH 18895071
188960             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 18896071
188970             MOVE LENGTH OF PV-CICS-MSG-AREA2                     18897071
188980               TO PV-COMMAREA-LENGTH                              18898071
188990             EXEC CICS                                            18899071
189000                  WRITEQ TD                                       18900071
189010                   QUEUE  ('CSSL')                                18901071
189020                    FROM  (PV-CICS-MSG-AREA2)                     18902071
189030                  LENGTH  (PV-COMMAREA-LENGTH)                    18903071
189040                    RESP  (PV-CICS-RESP)                          18904071
189050             END-EXEC                                             18905071
189060             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          18906071
189070             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              18907071
189080             PERFORM 9900-SOFT-ABORT                              18908071
189090         WHEN SQLWARN0 NOT = SPACE                                18909071
189100         WHEN SQLCODE NOT = ZERO                                  18910071
189110              MOVE ASC-PO-LINE-NBR                                18911071
189120                                TO DP013-MESSAGE-TEXT (3)         18912071
189130              MOVE '4594-FETCH-CARTON-CSR   '                     18913071
189140                               TO DP013-PARAGRAPH                 18914071
189150              MOVE 'FETCH UPDATE_CARTON_CSR   '                   18915071
189160                               TO DP013-MESSAGE-TEXT (1)          18916071
189170              MOVE SQLCA       TO DP013-SQLCA                     18917071
189180              SET DP013-DB2-ABEND                                 18918071
189190                               TO TRUE                            18919071
189200              PERFORM DP013-0000-PROCESS-ABEND                    18920071
189210     END-EVALUATE.                                                18921071
189220                                                                  18922071
189230                                                                  18923071
189240*----------------------------------------------------------------*18924071
189250* CLOSE LABEL CROSS REFERENCE CURSOR                             *18925071
189260*----------------------------------------------------------------*18926071
189270 4596-CLOSE-UPD-CARTON-CSR.                                       18927071
189280                                                                  18928071
189290     MOVE 'CURSOR: UPDATE_CARTON_CSR'                             18929071
189300                       TO DP013-MESSAGE-TEXT (2).                 18930071
189310     EXEC SQL                                                     18931071
189320          CLOSE UPDATE_CARTON_CSR                                 18932071
189330     END-EXEC.                                                    18933071
189340                                                                  18934071
189350     EVALUATE TRUE                                                18935071
189360         WHEN SQLCODE = ZERO                                      18936071
189370             CONTINUE                                             18937071
189380         WHEN SQLCODE = -904                                      18938071
189390         WHEN SQLCODE = -911                                      18939071
189400         WHEN SQLCODE = -913                                      18940071
189410             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   18941071
189420             MOVE '4596-CLOSE-UPD-CARTON-'   TO PV-SOFT-PARAGRAPH 18942071
189430             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 18943071
189440             MOVE LENGTH OF PV-CICS-MSG-AREA2                     18944071
189450               TO PV-COMMAREA-LENGTH                              18945071
189460             EXEC CICS                                            18946071
189470                  WRITEQ TD                                       18947071
189480                   QUEUE  ('CSSL')                                18948071
189490                    FROM  (PV-CICS-MSG-AREA2)                     18949071
189500                  LENGTH  (PV-COMMAREA-LENGTH)                    18950071
189510                    RESP  (PV-CICS-RESP)                          18951071
189520             END-EXEC                                             18952071
189530             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          18953071
189540             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              18954071
189550             PERFORM 9900-SOFT-ABORT                              18955071
189560         WHEN SQLWARN0 NOT = SPACES                               18956071
189570         WHEN SQLCODE < ZERO                                      18957071
189580         WHEN SQLCODE > ZERO                                      18958071
189590             MOVE '4535-CLOSE-UPD-CARTON   '                      18959071
189600                               TO DP013-PARAGRAPH                 18960071
189610             MOVE 'CLOSE UPDATE_CARTON_CSR     '                  18961071
189620                               TO DP013-MESSAGE-TEXT (1)          18962071
189630             MOVE SQLCA        TO DP013-SQLCA                     18963071
189640             MOVE 'SUT_OTBND_UPC' TO DP013-DB2-TABLE-NAME (1)     18964071
189650             SET DP013-DB2-ABEND                                  18965071
189660                 DP013-XCTL-DISPLAY-RESTART TO TRUE               18966071
189670             PERFORM DP013-0000-PROCESS-ABEND                     18967071
189680     END-EVALUATE.                                                18968071
189690                                                                  18969071
189700                                                                  18970071
189710*----------------------------------------------------------------*18971071
189720*  INACTIVATE LABEL CROSS REFERENCE ROW                          *18972071
189730*----------------------------------------------------------------*18973071
189740 4597-INACTIVATE-OTBND-CART.                                      18974071
189750                                                                  18975071
189760     SET  PS-NO-SOFT-ABORT-ERROR          TO  TRUE.               18976071
189770                                                                  18977071
189780                                                                  18978071
189790     EXEC SQL                                                     18979071
189800          UPDATE SUT_OTBND_CART                                   18980071
189810             SET                                                  18981071
189820                  ACTV_IND           = 'N'                        18982071
189830           WHERE  SHIPT_UNT_ID       = :SUT00028-SHIPT-UNT-ID     18983071
189840     END-EXEC.                                                    18984071
189850                                                                  18985071
189860                                                                  18986071
189870     EVALUATE TRUE                                                18987071
189880         WHEN SQLCODE = ZERO                                      18988071
189890         WHEN SQLCODE = +100                                      18989071
189900                  CONTINUE                                        18990071
189910                                                                  18991071
189920         WHEN SQLCODE = -904                                      18992071
189930         WHEN SQLCODE = -911                                      18993071
189940         WHEN SQLCODE = -913                                      18994071
189950             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   18995071
189960             MOVE '4597-INACTIVATE-OTBND-CART  '                  18996071
189970                                     TO PV-SOFT-PARAGRAPH         18997071
189980             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 18998071
189990             MOVE LENGTH OF PV-CICS-MSG-AREA2                     18999071
190000               TO PV-COMMAREA-LENGTH                              19000071
190010             EXEC CICS                                            19001071
190020                  WRITEQ TD                                       19002071
190030                   QUEUE  ('CSSL')                                19003071
190040                    FROM  (PV-CICS-MSG-AREA2)                     19004071
190050                  LENGTH  (PV-COMMAREA-LENGTH)                    19005071
190060                    RESP  (PV-CICS-RESP)                          19006071
190070             END-EXEC                                             19007071
190080              MOVE  PC-TSYMSG-00551  TO  DP020-MSG-NUMBER         19008071
190090              PERFORM 9900-SOFT-ABORT                             19009071
190100                                                                  19010071
190110         WHEN SQLWARN0 NOT = SPACES                               19011071
190120         WHEN SQLCODE NOT EQUAL ZERO                              19012071
190130              MOVE '4597-INACTIVATE-OTBND-CART  '                 19013071
190140                                   TO DP013-PARAGRAPH             19014071
190150              MOVE 'INACTIVATE SUT_OTBND_CART '                   19015071
190160                                   TO DP013-MESSAGE-TEXT (1)      19016071
190170              MOVE SUT00028-SHIPT-UNT-ID                          19017071
190180                                   TO PV-SHIPT-UNT-ID             19018071
190190              STRING ' SHIP UNIT = '  DELIMITED BY SIZE           19019071
190200                     PV-SHIPT-UNT-ID  DELIMITED BY SIZE           19020071
190210                                 INTO DP013-MESSAGE-TEXT (1)      19021071
190220              MOVE SQLCA           TO DP013-SQLCA                 19022071
190230              MOVE 'SUT_OTBND_CART' TO DP013-DB2-TABLE-NAME (1)   19023071
190240              SET DP013-DB2-ABEND  TO TRUE                        19024071
190250              PERFORM DP013-0000-PROCESS-ABEND                    19025071
190260     END-EVALUATE.                                                19026071
190270                                                                  19027071
190280                                                                  19028071
190290 4598-DELETE-RFID-DIRECT.                                         19029071
190300                                                                  19030071
190310     IF ASC-AUTO-CONVEY-NO-CRTNS    OR                            19031071
190320         ASC-AUTO-CONVEY-EXCPT-CRTNS                              19032071
190321           PERFORM 4087-CHECK-RFID-DIRECTIVES                     19032171
190322           IF PS-DC-RFID-YES                                      19032271
190323              SET PS-RFID-DRTVE-DELETE TO TRUE                    19032371
190324              IF ASC-AUTO-CONVEY-EXCPT-CRTNS                      19032471
190325                 PERFORM 4786-FRMT-SEND-DIRCT-PHYSL               19032571
190326              END-IF                                              19032671
190327           END-IF                                                 19032771
190328     END-IF.                                                      19032871
190329                                                                  19032971
190330*----------------------------------------------------------------*19033071
190331*                                                                *19033171
190332*----------------------------------------------------------------*19033271
190333 4600-PROCESS-PRINT-RELEASE.                                      19033371
190334                                                                  19033471
190335     MOVE +1                       TO ASC-BLK-SUB.                19033571
190336     PERFORM 5100-WRITE-TEMP-STORAGE.                             19033671
190337     ADD +1                        TO ASC-BLK-SUB.                19033771
190338     PERFORM 5100-WRITE-TEMP-STORAGE.                             19033871
190339                                                                  19033971
190340     PERFORM 6112-READ-LIST-QUEUE.                                19034071
190350     PERFORM 4610-GET-INVALID-STORES.                             19035071
190360                                                                  19036071
190370     SET  LQW-IDX  TO   1.                                        19037071
190380                                                                  19038071
190390     IF PS-NO-SOFT-ABORT-ERROR                                    19039071
190400       IF PV-CICS-RESP = DFHRESP (NORMAL)                         19040071
190410         PERFORM                                                  19041071
190420         VARYING LQW-IDX  FROM 1 BY 1                             19042071
190430         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL                     19043071
190440            OR   LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            19044071
190450            OR   PS-SOFT-ABORT-ERROR                              19045071
190460            OR   PS-ERROR                                         19046071
190470             IF  LQW-SELECT (LQW-IDX)                             19047071
190480                 IF  PS-NO-ERROR  AND                             19048071
190490                     ASC-PO-RCVR-DWNLD-P2L-N  AND                 19049071
190500                     ASC-PO-RCVR-TROUBLE-NO   AND                 19050071
190510                     ASC-VALID-INPK-YES       AND                 19051071
190520                     ASC-VALID-OTPK-YES       AND                 19052071
190530                     ASC-INVALID-PREPK-CSTK-N AND                 19053071
190540                     ASC-UCC128-ERROR-NO                          19054071
190550                         PERFORM 4605-PROCESS-SELECTED-LINES      19055071
190560                 END-IF                                           19056071
190570                 IF  DP020-FK-CONFIRM (DP020-SRC-AID)  AND        19057071
190580                     ASC-INVALID-INPK-YES                         19058071
190590                         PERFORM 4605-PROCESS-SELECTED-LINES      19059071
190600                 END-IF                                           19060071
190610                 IF  ASC-CONFIRM-TROUBLE-YES  AND                 19061071
190620                     NOT DP020-FK-CONFIRM (DP020-SRC-AID)         19062071
190630                     SET  PS-ERROR DP020-MSG-FATAL TO TRUE        19063071
190640                     MOVE PC-TSYMSG-01758  TO DP020-MSG-NUMBER    19064071
190650                 END-IF                                           19065071
190660                 IF  ASC-PO-RCVR-DWNLD-P2L-Y                      19066071
190670                     SET  PS-ERROR DP020-MSG-FATAL TO TRUE        19067071
190680                     MOVE PC-TSYMSG-01768  TO DP020-MSG-NUMBER    19068071
190690                 END-IF                                           19069071
190700                 IF  ASC-PO-RCVR-TROUBLE-YES                      19070071
190710                     SET  PS-ERROR DP020-MSG-FATAL TO TRUE        19071071
190720                     MOVE PC-TSYMSG-01769  TO DP020-MSG-NUMBER    19072071
190730                 END-IF                                           19073071
190740                 IF  ASC-INVALID-INPK-YES                         19074071
190750                     SET  PS-ERROR DP020-MSG-FATAL TO TRUE        19075071
190760                     MOVE PC-TSYMSG-01758  TO DP020-MSG-NUMBER    19076071
190770                 END-IF                                           19077071
190780                 IF  ASC-INVALID-OTPK-YES                         19078071
190790                     SET  PS-ERROR DP020-MSG-FATAL TO TRUE        19079071
190800                     MOVE PC-TSYMSG-01759  TO DP020-MSG-NUMBER    19080071
190810                 END-IF                                           19081071
190820                 IF  ASC-INVALID-DV-RTV-OTPK                      19082071
190830                     SET  PS-ERROR DP020-MSG-FATAL TO TRUE        19083071
190840                     MOVE PC-TSYMSG-01815  TO DP020-MSG-NUMBER    19084071
190850                 END-IF                                           19085071
190860                 IF  ASC-INVALID-OTPK-ODD                         19086071
190870                     SET  PS-ERROR DP020-MSG-FATAL TO TRUE        19087071
190880                     MOVE PC-TSYMSG-02045  TO DP020-MSG-NUMBER    19088071
190890                 END-IF                                           19089071
190900                 IF  PS-DC-RTV-DISTRO-ERROR                       19090071
190910                     SET  PS-ERROR DP020-MSG-FATAL TO TRUE        19091071
190920                     MOVE PC-TSYMSG-01815  TO DP020-MSG-NUMBER    19092071
190930                 END-IF                                           19093071
190940                 IF  ASC-INVALID-PREPK-CSTK-Y                     19094071
190950                     SET  PS-ERROR DP020-MSG-FATAL TO TRUE        19095071
190960                     MOVE PC-TSYMSG-02462  TO DP020-MSG-NUMBER    19096071
190970                 END-IF                                           19097071
190980                 IF  ASC-INVALID-PREPK-E-COMM                     19098071
190990                     SET  PS-ERROR DP020-MSG-FATAL TO TRUE        19099071
191000                     MOVE PC-TSYMSG-02545  TO DP020-MSG-NUMBER    19100071
191010                 END-IF                                           19101071
191020                 IF  ASC-UCC128-MLT-LNE-YES                       19102071
191030                     SET  PS-ERROR DP020-MSG-FATAL TO TRUE        19103071
191040                     MOVE PC-TSYMSG-02502  TO DP020-MSG-NUMBER    19104071
191050                 END-IF                                           19105071
191060                 IF  ASC-UCC128-DWNLD-YES                         19106071
191070                     SET  PS-ERROR DP020-MSG-FATAL TO TRUE        19107071
191080                     MOVE PC-TSYMSG-01768  TO DP020-MSG-NUMBER    19108071
191090                 END-IF                                           19109071
191100                 IF  ASC-UCC128-PREPK-RATIO                       19110071
191110                     SET  PS-ERROR DP020-MSG-FATAL TO TRUE        19111071
191120                     MOVE PC-TSYMSG-01768  TO DP020-MSG-NUMBER    19112071
191130                 END-IF                                           19113071
191140             END-IF                                               19114071
191150         END-PERFORM                                              19115071
191160       END-IF                                                     19116071
191170     END-IF.                                                      19117071
191180                                                                  19118071
191190     MOVE PV-ITEM      TO PV-SAVE-ITEM.                           19119071
191200     PERFORM 6111-WRITE-LIST-QUEUE.                               19120071
191210                                                                  19121071
191220     MOVE +1                     TO  ASC-BLK-SUB.                 19122071
191230     PERFORM 4410-READ-TEMP-STORAGE.                              19123071
191240                                                                  19124071
191250     ADD +1                      TO  ASC-BLK-SUB                  19125071
191260                                     PV-BLOCK-NUMBER.             19126071
191270                                                                  19127071
191280     PERFORM 4410-READ-TEMP-STORAGE.                              19128071
191290                                                                  19129071
191300                                                                  19130071
191310*----------------------------------------------------------------*19131071
191320*                                                                *19132071
191330*----------------------------------------------------------------*19133071
191340 4605-PROCESS-SELECTED-LINES.                                     19134071
191350                                                                  19135071
191360     PERFORM 4620-PROCESS-LINES.                                  19136071
191370                                                                  19137071
191380     IF  PS-NO-ERROR                                              19138071
191390         EVALUATE TRUE                                            19139071
191400             WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                19140071
191410                  SET DP020-MSG-INFORMATIONAL  TO  TRUE           19141071
191420                  MOVE PC-TSYMSG-01771  TO  DP020-MSG-NUMBER      19142071
191430             WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)          19143071
191440                  SET DP020-MSG-INFORMATIONAL  TO  TRUE           19144071
191450                  MOVE PC-TSYMSG-01770  TO  DP020-MSG-NUMBER      19145071
191460         END-EVALUATE                                             19146071
191470     END-IF.                                                      19147071
191480                                                                  19148071
191490     IF  PS-NO-ERROR                                              19149071
191500         PERFORM 4506B-CHECK-WRK-ORD-AUTO-STRT                    19150071
191510         IF PS-AUTO-STRT-WRK-ORDER                                19151071
191520            PERFORM 4538-START-WORK-ORDERS                        19152071
191530         END-IF                                                   19153071
191540     END-IF.                                                      19154071
191550                                                                  19155071
191560     IF  DP020-INT-APPL-FORMAT-IND =  PC-LIST-FORMAT              19156071
191570         PERFORM 9105-READ-SEL-QUEUE-LST                          19157071
191580             SET RC816-UPD (ASC-SEL-SUB)                          19158071
191590                                  TO TRUE                         19159071
191600         PERFORM 9205-REWRITE-SEL-QUEUE-LST                       19160071
191610     END-IF.                                                      19161071
191620                                                                  19162071
191630                                                                  19163071
191640*----------------------------------------------------------------*19164071
191650* BUILD INTERNAL TABLE WITH VALID P2L STORE NUMBERS - DC RV      *19165071
191660*----------------------------------------------------------------*19166071
191670 4610-GET-INVALID-STORES.                                         19167071
191680     SET  PS-NO-SOFT-ABORT-ERROR          TO  TRUE.               19168071
191690     EXEC SQL                                                     19169071
191700         OPEN   TSTR_CURSOR                                       19170071
191710     END-EXEC                                                     19171071
191720                                                                  19172071
191730     EVALUATE TRUE                                                19173071
191740         WHEN SQLCODE = ZERO                                      19174071
191750             CONTINUE                                             19175071
191760         WHEN SQLCODE = -904                                      19176071
191770         WHEN SQLCODE = -911                                      19177071
191780         WHEN SQLCODE = -913                                      19178071
191790                                                                  19179071
191800             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   19180071
191810             MOVE '4610-GET-INVALID-STORES-1'                     19181071
191820                                             TO PV-SOFT-PARAGRAPH 19182071
191830             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 19183071
191840             MOVE LENGTH OF PV-CICS-MSG-AREA2                     19184071
191850               TO PV-COMMAREA-LENGTH                              19185071
191860             EXEC CICS                                            19186071
191870                  WRITEQ TD                                       19187071
191880                   QUEUE  ('CSSL')                                19188071
191890                    FROM  (PV-CICS-MSG-AREA2)                     19189071
191900                  LENGTH  (PV-COMMAREA-LENGTH)                    19190071
191910                    RESP  (PV-CICS-RESP)                          19191071
191920             END-EXEC                                             19192071
191930                                                                  19193071
191940              MOVE  PC-TSYMSG-00551  TO  DP020-MSG-NUMBER         19194071
191950              PERFORM 9900-SOFT-ABORT                             19195071
191960         WHEN SQLWARN0 NOT = SPACE                                19196071
191970         WHEN SQLCODE < ZERO                                      19197071
191980         WHEN SQLCODE > ZERO                                      19198071
191990             MOVE '4610-GET-INVALID-STORES'                       19199071
192000                                     TO DP013-PARAGRAPH           19200071
192010             MOVE 'OPEN THE TSTR_CURSOR'                          19201071
192020                                     TO DP013-MESSAGE-TEXT (1)    19202071
192030              MOVE SQLCA             TO DP013-SQLCA               19203071
192040              MOVE 'XLT_LOC'         TO DP013-DB2-TABLE-NAME (1)  19204071
192050              SET DP013-DB2-ABEND    TO TRUE                      19205071
192060              SET DP013-NO-ROLLBACK  TO TRUE                      19206071
192070              SET DP013-XCTL-DISPLAY-RESTART                      19207071
192080                                     TO TRUE                      19208071
192090              PERFORM DP013-0000-PROCESS-ABEND                    19209071
192100     END-EVALUATE                                                 19210071
192110                                                                  19211071
192120     IF  PS-NO-SOFT-ABORT-ERROR                                   19212071
192130         PERFORM VARYING STORE-INX FROM 1 BY 1                    19213071
192140                     UNTIL PS-INV-STORES-LOADED                   19214071
192150                        OR PS-SOFT-ABORT-ERROR                    19215071
192160             EXEC SQL                                             19216071
192170                 FETCH TSTR_CURSOR                                19217071
192180                 INTO  :XLT00010-LOC-NBR,                         19218071
192190                       :XLT00010-LOC-TYP-CDE                      19219071
192200             END-EXEC                                             19220071
192210                                                                  19221071
192220             EVALUATE TRUE                                        19222071
192230                 WHEN SQLCODE = ZERO                              19223071
192240                      MOVE XLT00010-LOC-NBR    TO                 19224071
192250                                     TBL-STORE-NBR-NUM(STORE-INX) 19225071
192260                 WHEN SQLCODE = +100                              19226071
192270                     SET PS-INV-STORES-LOADED     TO TRUE         19227071
192280                     SET PV-INVALID-STORE-ENTRIES TO STORE-INX    19228071
192290                                                                  19229071
192300             WHEN SQLCODE = -904                                  19230071
192310             WHEN SQLCODE = -911                                  19231071
192320             WHEN SQLCODE = -913                                  19232071
192330                                                                  19233071
192340             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   19234071
192350             MOVE '4610-GET-INVALID-STORES-2'                     19235071
192360                                             TO PV-SOFT-PARAGRAPH 19236071
192370             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 19237071
192380             MOVE LENGTH OF PV-CICS-MSG-AREA2                     19238071
192390               TO PV-COMMAREA-LENGTH                              19239071
192400             EXEC CICS                                            19240071
192410                  WRITEQ TD                                       19241071
192420                   QUEUE  ('CSSL')                                19242071
192430                    FROM  (PV-CICS-MSG-AREA2)                     19243071
192440                  LENGTH  (PV-COMMAREA-LENGTH)                    19244071
192450                    RESP  (PV-CICS-RESP)                          19245071
192460             END-EXEC                                             19246071
192470                                                                  19247071
192480                  MOVE PC-TSYMSG-00551  TO  DP020-MSG-NUMBER      19248071
192490                  PERFORM 9900-SOFT-ABORT                         19249071
192500             WHEN SQLWARN0 NOT = SPACE                            19250071
192510             WHEN SQLCODE < ZERO                                  19251071
192520             WHEN SQLCODE > ZERO                                  19252071
192530                 MOVE '4610-GET-INVALID-STORES'                   19253071
192540                                     TO DP013-PARAGRAPH           19254071
192550                MOVE 'ATTEMPTING TO FETCH A ROW OF THE RESULTS TAB19255071
192560-                     'FROM THE TSTR_CURSOR'                      19256071
192570                                     TO DP013-MESSAGE-TEXT (1)    19257071
192580                  MOVE SQLCA         TO DP013-SQLCA               19258071
192590                  MOVE 'XLT_LOC'     TO DP013-DB2-TABLE-NAME (1)  19259071
192600                  SET DP013-DB2-ABEND    TO TRUE                  19260071
192610                  SET DP013-NO-ROLLBACK  TO TRUE                  19261071
192620                  SET DP013-XCTL-DISPLAY-RESTART                  19262071
192630                                         TO TRUE                  19263071
192640                  PERFORM DP013-0000-PROCESS-ABEND                19264071
192650             END-EVALUATE                                         19265071
192660         END-PERFORM                                              19266071
192670     END-IF                                                       19267071
192680                                                                  19268071
192690                                                                  19269071
192700     IF  PS-NO-SOFT-ABORT-ERROR                                   19270071
192710         EXEC SQL                                                 19271071
192720             CLOSE  TSTR_CURSOR                                   19272071
192730         END-EXEC                                                 19273071
192740                                                                  19274071
192750         EVALUATE TRUE                                            19275071
192760             WHEN SQLCODE = ZERO                                  19276071
192770                 CONTINUE                                         19277071
192780         WHEN SQLCODE = -904                                      19278071
192790         WHEN SQLCODE = -911                                      19279071
192800         WHEN SQLCODE = -913                                      19280071
192810                                                                  19281071
192820             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   19282071
192830             MOVE '4610-GET-INVALID-STORES-3'                     19283071
192840                                             TO PV-SOFT-PARAGRAPH 19284071
192850             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 19285071
192860             MOVE LENGTH OF PV-CICS-MSG-AREA2                     19286071
192870               TO PV-COMMAREA-LENGTH                              19287071
192880             EXEC CICS                                            19288071
192890                  WRITEQ TD                                       19289071
192900                   QUEUE  ('CSSL')                                19290071
192910                    FROM  (PV-CICS-MSG-AREA2)                     19291071
192920                  LENGTH  (PV-COMMAREA-LENGTH)                    19292071
192930                    RESP  (PV-CICS-RESP)                          19293071
192940             END-EXEC                                             19294071
192950                                                                  19295071
192960             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          19296071
192970             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              19297071
192980             PERFORM 9900-SOFT-ABORT                              19298071
192990             WHEN SQLWARN0 NOT = SPACE                            19299071
193000             WHEN SQLCODE < ZERO                                  19300071
193010             WHEN SQLCODE > ZERO                                  19301071
193020                 MOVE '4610-GET-INVALID-STORES'                   19302071
193030                                         TO DP013-PARAGRAPH       19303071
193040                 MOVE 'CLOSE THE TSTR_CURSOR'                     19304071
193050                                        TO DP013-MESSAGE-TEXT (1) 19305071
193060                 MOVE SQLCA              TO DP013-SQLCA           19306071
193070                 MOVE 'XLT_LOC'       TO DP013-DB2-TABLE-NAME (1) 19307071
193080                 SET DP013-DB2-ABEND     TO TRUE                  19308071
193090                 SET DP013-NO-ROLLBACK   TO TRUE                  19309071
193100                 SET DP013-XCTL-DISPLAY-RESTART                   19310071
193110                                     TO TRUE                      19311071
193120                 PERFORM DP013-0000-PROCESS-ABEND                 19312071
193130         END-EVALUATE                                             19313071
193140     END-IF.                                                      19314071
193150                                                                  19315071
193160                                                                  19316071
193170*----------------------------------------------------------------*19317071
193180* DETERMINE IF LINE TO BE PROCESSED IS FOR TROUBLE CREATE OR FOR *19318071
193190* LABEL PRINT & RELEASE                                          *19319071
193200*----------------------------------------------------------------*19320071
193210 4620-PROCESS-LINES.                                              19321071
193220                                                                  19322071
193230     IF  LQW-STORE-PGYBK(LQW-IDX) AND                             19323071
193240         ASC-DO-NOT-PRINT-PGYBK                                   19324071
193250             SET  LQW-LNE-DO-NOT-PRT-LBL(LQW-IDX)  TO TRUE        19325071
193260     ELSE                                                         19326071
193270     IF  LQW-SHUFFLED-SML(LQW-IDX) AND                            19327071
193280         ASC-DO-NOT-PRINT-SML                                     19328071
193290             SET  LQW-LNE-DO-NOT-PRT-LBL(LQW-IDX)  TO TRUE        19329071
193300     ELSE                                                         19330071
193310     IF  LQW-STORE-SML(LQW-IDX) AND                               19331071
193320         ASC-DO-NOT-PRINT-SML                                     19332071
193330             SET  LQW-LNE-DO-NOT-PRT-LBL(LQW-IDX)  TO TRUE        19333071
193340     ELSE                                                         19334071
193350     IF  LQW-LBL-TYP-NONE(LQW-IDX) AND                            19335071
193360         ASC-DO-NOT-PRINT-SML                                     19336071
193370             SET  LQW-LNE-DO-NOT-PRT-LBL(LQW-IDX)  TO TRUE        19337071
193380     END-IF                                                       19338071
193390     END-IF                                                       19339071
193400     END-IF                                                       19340071
193410     END-IF.                                                      19341071
193420                                                                  19342071
193430     SET PS-LINE-NOT-PREV-DOWNLOAD       TO  TRUE.                19343071
193440                                                                  19344071
193450     MOVE ASC-PO-NBR                     TO  PV-PO-NBR            19345071
193460                                             DK-PO-NBR.           19346071
193470     MOVE ASC-REC-SEQ-NBR                TO  PV-REC-SEQ-NBR       19347071
193480                                             PV-REC-SEQ-NBR.      19348071
193490     MOVE LQW-PO-RCVR-LINE(LQW-IDX)      TO  PV-PO-LINE-NBR       19349071
193500                                             DK-LINE-NBR.         19350071
193510     MOVE LQW-SKU(LQW-IDX)               TO  PV-SKU.              19351071
193520     MOVE LQW-MODULE(LQW-IDX)            TO  PV-MODULE.           19352071
193530     MOVE LQW-CARTON-CNT-X(LQW-IDX)      TO  PV-CARTON-COUNT-X.   19353071
193540     MOVE LQW-INNER-PACK-X(LQW-IDX)      TO  PV-INNER-PACK-QTY-X. 19354071
193550     MOVE LQW-OUTER-PACK-X(LQW-IDX)      TO  PV-OUTER-PACK-QTY-X. 19355071
193560     MOVE LQW-IN-PACK-CONVY(LQW-IDX)     TO  PV-IN-PAK-CONVEY.    19356071
193570     MOVE LQW-LABEL-TYPE(LQW-IDX)        TO  PV-LBL-TYP.          19357071
193580     MOVE LQW-PROCESS-QTY(LQW-IDX)       TO  PV-LNE-PROCESS-QTY-X.19358071
193590     MOVE LQW-TRANSCRIB-QTY(LQW-IDX)     TO  PV-TRANSCRIBE-QTY-X. 19359071
193600     MOVE LQW-P2L-LBL-CNT(LQW-IDX)       TO  PV-P2L-LABEL-CNT.    19360071
193610     MOVE LQW-SHP-LBL-CNT(LQW-IDX)       TO  PV-SML-LABEL-CNT.    19361071
193620     MOVE LQW-SML-FCSE-LBL-CNT(LQW-IDX)  TO  PV-SML-FCSE-LBL-CNT. 19362071
193630     MOVE LQW-SML-INPK-LBL-CNT(LQW-IDX)  TO  PV-SML-INPK-LBL-CNT. 19363071
193640     MOVE LQW-DISPLAY-STORE-CNT(LQW-IDX) TO  PV-DISPLAY-STORE-CNT 19364071
193650     MOVE LQW-DISPLAY-ITM-CNT(LQW-IDX)   TO  PV-DISPLAY-ITEM-QTY. 19365071
193660     MOVE LQW-EXPTD-ITM-QTY(LQW-IDX)     TO  PV-EXPECTED-ITM-QTY. 19366071
193670     MOVE LQW-P2L-DIVERT-CDE(LQW-IDX)    TO  PV-P2L-DIVERT-CDE.   19367071
193680     MOVE ASC-P2L-SRVR-IP-ADDR           TO  PV-IP-ADDRESS.       19368071
193690     MOVE LQW-SKU(LQW-IDX)               TO  PV-SKU.              19369071
193700     MOVE LQW-LNE-CRE-LBL-OPT (LQW-IDX)  TO  PV-LNE-CRE-LBL-OPT.  19370071
193710     MOVE LQW-LNE-FCSE-AREA (LQW-IDX)    TO  PV-LNE-FCSE-AREA.    19371071
193720     MOVE LQW-PREPK-ID (LQW-IDX)         TO  PV-PREPK-ID.         19372071
193730                                                                  19373071
193740     EVALUATE TRUE                                                19374071
193750         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    19375071
193760              PERFORM  7000-EVALUATE-FOR-TROUBLE                  19376071
193770         WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)              19377071
193780              IF  LQW-UPDATE-OK (LQW-IDX)                         19378071
193790                  IF  LQW-LNE-UCC128-YES (LQW-IDX)                19379071
193800                      PERFORM 7400-UCC128-LBL-CREATE              19380071
193810                      PERFORM 7510-RCVR-TRKING-DOWNLOAD           19381071
193820                  ELSE                                            19382071
193830                      PERFORM 4630-PRINT-RELEASE-FUNC             19383071
193840                      PERFORM 7510-RCVR-TRKING-DOWNLOAD           19384071
193850                                                                  19385071
193860                      IF  ASC-DC-INTERFC-LABOR-YES                19386071
193870                          IF  DISTHD-PHY-LBL-PRC-CNT  >  1        19387071
193880                              CONTINUE                            19388071
193890                          ELSE                                    19389071
193900                              SET  PS-LABOR-LOG-PHY-LBL  TO TRUE  19390071
193910                              IF  PS-LABOR-HAVE-DUMMY-TK-NO       19391071
193920                                  PERFORM 3660-GET-DUMMY-LABOR-TK 19392071
193930                              END-IF                              19393071
193940                              MOVE  PV-LABOR-DUMMY-TK             19394071
193950                                TO  PV-LABOR-USER-ID              19395071
193960                              PERFORM 3610-CHECK-LABOR-ASGMT      19396071
193970                              IF  ASC-ASSOC-LABOR-ASGMT-YES       19397071
193980                                  PERFORM 3620-GET-LABOR-SEQ-NBR  19398071
193990                                  IF  LQW-P2L-LBL-CNT (LQW-IDX)   19399071
194000                                      > 0                         19400071
194010                                    SET PS-LABOR-PHY-LBL-SML-NO   19401071
194020                                        PS-LABOR-PHY-LBL-P2L-YES  19402071
194030                                     TO TRUE                      19403071
194040                                    PERFORM 3630-SEND-LABOR-TO-EAI19404071
194050                                  END-IF                          19405071
194060                                  IF  LQW-SHP-LBL-CNT (LQW-IDX)   19406071
194070                                      > 0                         19407071
194080                                      IF  LQW-P2L-LBL-CNT         19408071
194090                                          (LQW-IDX) > 0           19409071
194100                                        ADD 1                     19410071
194110                                        TO  PV-LABOR-SEQ-START-NBR19411071
194120                                      END-IF                      19412071
194130                                    SET PS-LABOR-PHY-LBL-P2L-NO   19413071
194140                                        PS-LABOR-PHY-LBL-SML-YES  19414071
194150                                     TO TRUE                      19415071
194160                                    PERFORM 3630-SEND-LABOR-TO-EAI19416071
194170                                  END-IF                          19417071
194180                              END-IF                              19418071
194190                          END-IF                                  19419071
194200                      END-IF                                      19420071
194210                                                                  19421071
194220                  END-IF                                          19422071
194230              END-IF                                              19423071
194240     END-EVALUATE                                                 19424071
194250                                                                  19425071
194260     IF  PS-NO-ERROR                                              19426071
194270         EXEC CICS                                                19427071
194280              SYNCPOINT                                           19428071
194290         END-EXEC                                                 19429071
194300     END-IF.                                                      19430071
194400                                                                  19440071
194401     IF  PS-NO-ERROR                                              19440171
194402         IF  LQW-SELECT (LQW-IDX)                                 19440271
194403             IF  LQW-LNE-DO-NOT-PRT-LBL (LQW-IDX)                 19440371
194404             OR  LQW-LNE-UCC128-YES (LQW-IDX)                     19440471
194405                 CONTINUE                                         19440571
194406             ELSE                                                 19440671
194407                 PERFORM 4779-PROCESS-DEST-LABEL-REQ              19440771
194408             END-IF                                               19440871
194409         END-IF                                                   19440971
194410     END-IF.                                                      19441071
194420                                                                  19442071
194430                                                                  19443071
194440     IF  PS-NO-ERROR                                              19444071
194450         SET  LQW-DESELECT (LQW-IDX)                              19445071
194460              LQW-NO-UPDATE (LQW-IDX)                             19446071
194470              LQW-PROTECTED (LQW-IDX)                             19447071
194480              LQW-UPD (LQW-IDX)        TO  TRUE                   19448071
194490         SUBTRACT  1                                              19449071
194500             FROM  ASC-NUMBER-OF-SELECTED-ITEMS                   19450071
194600         MOVE LQW-SELECTED-SW (LQW-IDX)                           19460071
194610                              TO LQW-TEMP-SELECTED-SW (LQW-IDX)   19461071
194620         IF  LQW-LINE-STATUS (LQW-IDX)  =  SPACES                 19462071
194630             IF  LQW-PPC-EXISTS (LQW-IDX)                         19463071
194640                 MOVE 'DWPP'      TO  LQW-LINE-STATUS (LQW-IDX)   19464071
194650             ELSE                                                 19465071
194660             IF  DISTHD-PRCG-STAT-CDE  =  PC-F                    19466071
194670                 MOVE 'NPRO'      TO  LQW-LINE-STATUS (LQW-IDX)   19467071
194680             END-IF                                               19468071
194690         END-IF                                                   19469071
194700     END-IF.                                                      19470071
194710                                                                  19471071
194720                                                                  19472071
194730                                                                  19473071
194740*----------------------------------------------------------------*19474071
194750*                                                                *19475071
194760*----------------------------------------------------------------*19476071
194770 4630-PRINT-RELEASE-FUNC.                                         19477071
194780                                                                  19478071
194790     IF  LQW-P2L-DYNAPACK (LQW-IDX)                               19479071
194800       IF  LQW-P2L-ALS-4-DIGIT-STR (LQW-IDX)                      19480071
194810         MOVE PV-PO-NBR              TO PC053-HDR-ORD-NBR         19481071
194820         MOVE PV-REC-SEQ-NBR         TO PC053-HDR-RCVR-SEQ-NBR    19482071
194830         MOVE PV-PO-LINE-NBR         TO PC053-HDR-ORD-LNE-NBR     19483071
194840         MOVE PC-001                TO PC053-HDR-WORK-ORD-SEQ-NBR 19484071
194850         MOVE SD-SYSTEM-MONTH        TO PC053-CREATE-MONTH        19485071
194860         MOVE SD-SYSTEM-DAY          TO PC053-CREATE-DAY          19486071
194870         MOVE SD-SYSTEM-CENTURY-YEAR TO PC053-CREATE-CENTURY-YEAR 19487071
194880         MOVE ST-SYSTEM-HOUR         TO PC053-CREATE-HOUR         19488071
194890         MOVE ST-SYSTEM-MINUTE       TO PC053-CREATE-MINUTE       19489071
194900         MOVE ST-SYSTEM-SECOND       TO PC053-CREATE-SECOND       19490071
194910       END-IF                                                     19491071
194920     ELSE                                                         19492071
194930         MOVE PV-PO-NBR              TO PC184-HDR-ORD-NBR         19493071
194940         MOVE PV-REC-SEQ-NBR         TO PC184-HDR-RCVR-SEQ-NBR    19494071
194950         MOVE PV-PO-LINE-NBR         TO PC184-HDR-ORD-LNE-NBR     19495071
194960         MOVE PC-001                TO PC184-HDR-WORK-ORD-SEQ-NBR 19496071
194970         MOVE ZEROES                 TO PC184-HDR-WO-INS-SEQ-NBR  19497071
194980         MOVE SD-SYSTEM-MONTH        TO PC184-CREATE-MONTH        19498071
194990         MOVE SD-SYSTEM-DAY          TO PC184-CREATE-DAY          19499071
195000         MOVE SD-SYSTEM-CENTURY-YEAR TO PC184-CREATE-CENTURY-YEAR 19500071
195010         MOVE ST-SYSTEM-HOUR         TO PC184-CREATE-HOUR         19501071
195020         MOVE ST-SYSTEM-MINUTE       TO PC184-CREATE-MINUTE       19502071
195030         MOVE ST-SYSTEM-SECOND       TO PC184-CREATE-SECOND       19503071
195040      END-IF.                                                     19504071
195050                                                                  19505071
195060      MOVE PV-MODULE  TO  PV-PREVIOUS-MOD.                        19506071
195070                                                                  19507071
195080                                                                  19508071
195090     IF  PV-LNE-CRE-P2L-LBL                                       19509071
195100         SET  PS-LABEL-SELECTION-P2L  TO  TRUE                    19510071
195110         PERFORM 4660-CREATE-P2L-ONLY                             19511071
195120     ELSE                                                         19512071
195130     IF  PV-LNE-CRE-SML-LBL                                       19513071
195140         SET  PS-LABEL-SELECTION-SML  TO  TRUE                    19514071
195150         PERFORM 4665-CREATE-SML-ONLY                             19515071
195160     ELSE                                                         19516071
195170     IF  PV-LNE-CRE-BOTH-LBL                                      19517071
195180         SET  PS-LABEL-SELECTION-BOTH TO TRUE                     19518071
195190         PERFORM 4670-CREATE-P2L-SML                              19519071
195200     END-IF.                                                      19520071
195210                                                                  19521071
195220     IF  ASC-AUTOVE-PARM-YES                                      19522071
195230         IF  LQW-LNE-UCC128-IGNORE (LQW-IDX)  OR                  19523071
195240             LQW-UCC128-USABLE-NO  (LQW-IDX)                      19524071
195250             PERFORM 7450-CREATE-TROUBLE                          19525071
195260         END-IF                                                   19526071
195270     END-IF                                                       19527071
195280                                                                  19528071
195290     IF  PS-NO-ERROR                                              19529071
195300         EXEC CICS                                                19530071
195310              SYNCPOINT                                           19531071
195320         END-EXEC                                                 19532071
195330     END-IF.                                                      19533071
195340                                                                  19534071
195350*----------------------------------------------------------------*19535071
195360*  THIS PARAGRAPH WILL TAKE EACH NUMERIC PORTION OF THE IP       *19536071
195370*  ADDRESS AND CONVERT EACH PORTION INTO ITS HEX VALUE.  THE     *19537071
195380*  HEX VALUE WILL THEN BE MOVED TO A FIELD WHICH WILL STACK THE  *19538071
195390*  FOUR HEX VALUES SIDE BY SIDE INTO A FIELD DEFINED AS X(04).   *19539071
195400*  THIS VALUE IS THEN WHAT IS USED BY THE SOCKETS LOGIC FOR THE  *19540071
195410*  IP ADDRESS.                                                   *19541071
195420*----------------------------------------------------------------*19542071
195430 4635-FORMAT-IP-ADDR.                                             19543071
195440                                                                  19544071
195450     MOVE PV-IP-ADDR-NUM1 TO PV-HEX-NUMERIC.                      19545071
195460     MOVE PV-HEX-CHAR-2 TO PV-HEX-FIELD-1.                        19546071
195470                                                                  19547071
195480     MOVE PV-IP-ADDR-NUM2 TO PV-HEX-NUMERIC.                      19548071
195490     MOVE PV-HEX-CHAR-2 TO PV-HEX-FIELD-2.                        19549071
195500                                                                  19550071
195510     MOVE PV-IP-ADDR-NUM3 TO PV-HEX-NUMERIC.                      19551071
195520     MOVE PV-HEX-CHAR-2 TO PV-HEX-FIELD-3.                        19552071
195530                                                                  19553071
195540     MOVE PV-IP-ADDR-NUM4 TO PV-HEX-NUMERIC.                      19554071
195550     MOVE PV-HEX-CHAR-2 TO PV-HEX-FIELD-4.                        19555071
195560                                                                  19556071
195570     MOVE PV-HEX-FIELD-NUMBER TO DP081-NAME-IP-ADDR.              19557071
195580                                                                  19558071
195590                                                                  19559071
195600*----------------------------------------------------------------*19560071
195610*   CALL SOCKET                                                  *19561071
195620*----------------------------------------------------------------*19562071
195630 4645-CALL-SOCKET.                                                19563071
195640                                                                  19564071
195650     IF      PS-DISPLAY-CSSL-YES                                  19565071
195660         INITIALIZE      PV-CICS-MSG-AREA2                        19566071
195670         MOVE DP020-SRC-TASK-NUMBER      TO  PV-DISPLAY-TASK-NBR  19567071
195680         MOVE ASC-PO-NBR             TO  PV-DISPLAY-PO-NBR        19568071
195690         MOVE ASC-REC-SEQ-NBR        TO  PV-DISPLAY-RCVR-SEQ-NBR  19569071
195700         MOVE DP020-LOCATION-NBR     TO  PV-DISPLAY-OPER          19570071
195710         STRING      ' PCKCS701-'          DELIMITED BY SIZE      19571071
195720                 PV-DISPLAY-OPER           DELIMITED BY SIZE      19572071
195730                 ' TERM-'                  DELIMITED BY SIZE      19573071
195740                 DP020-TERM-ID             DELIMITED BY SIZE      19574071
195750                 ' USER-'                  DELIMITED BY SIZE      19575071
195760                 DP020-USERID              DELIMITED BY SIZE      19576071
195770                 ' TASK-'                  DELIMITED BY SIZE      19577071
195780                 PV-DISPLAY-TASK-NBR       DELIMITED BY SIZE      19578071
195790                 ' PO-'                    DELIMITED BY SIZE      19579071
195800                 PV-DISPLAY-PO-NBR         DELIMITED BY SIZE      19580071
195810                 '-'                       DELIMITED BY SIZE      19581071
195820                 PV-DISPLAY-RCVR-SEQ-NBR   DELIMITED BY SIZE      19582071
195830                 ' BEF CALL SKT1-4645'     DELIMITED BY SIZE      19583071
195840                                      INTO PV-CICS-MSG-AREA2      19584071
195850         MOVE LENGTH OF PV-CICS-MSG-AREA2                         19585071
195860           TO PV-COMMAREA-LENGTH                                  19586071
195870         EXEC CICS                                                19587071
195880              WRITEQ TD                                           19588071
195890               QUEUE      ('CSSL')                                19589071
195900                FROM      (PV-CICS-MSG-AREA2)                     19590071
195910              LENGTH      (PV-COMMAREA-LENGTH)                    19591071
195920                RESP      (PV-CICS-RESP)                          19592071
195930         END-EXEC                                                 19593071
195940     END-IF.                                                      19594071
195950                                                                  19595071
195960                                                                  19596071
195970     MOVE PV-SOCKET-ONE  TO  DP081-SOCK-ID.                       19597071
195980*                                                                 19598071
195990     CALL 'EZASOKET'                                              19599071
196000         USING DP081-SOCKET-CMD                                   19600071
196010               DP081-AF-INET                                      19601071
196020               DP081-SOCK-TYPE                                    19602071
196030               DP081-PROTOCOL                                     19603071
196040               DP081-ERRNO                                        19604071
196050               DP081-RETCODE.                                     19605071
196060                                                                  19606071
196070     MOVE DP081-RETCODE TO DP081-SOCK-ID                          19607071
196080                           PV-SOCKET-ONE.                         19608071
196090                                                                  19609071
196100* CHECK IF TCP-IP ERROR ON SOCKET CALL                            19610071
196110                                                                  19611071
196120     IF DP081-RETCODE < ZERO                                      19612071
196130        MOVE PC-CURRENT-PROGRAM-NAME     TO DP081-TCP-IP-PGM-NAME 19613071
196140        SET  DP081-TCP-IP-SOCKET-ERR     TO TRUE                  19614071
196150        MOVE DP081-ERRNO                 TO DP081-TCP-IP-ERR-NBR  19615071
196160        MOVE DP081-TCP-IP-LOGGING-MSG    TO PV-CICS-MSG-DATA      19616071
196170        MOVE PV-CICS-MSG-HOLD            TO PV-CICS-MSG-AREA      19617071
196180                                                                  19618071
196190        MOVE LENGTH OF PV-CICS-MSG-AREA  TO PV-COMMAREA-LENGTH    19619071
196200                                                                  19620071
196210        EXEC CICS                                                 19621071
196220            WRITEQ TD                                             19622071
196230                QUEUE   ('CSSL')                                  19623071
196240                FROM    (PV-CICS-MSG-AREA)                        19624071
196250                LENGTH  (PV-COMMAREA-LENGTH)                      19625071
196260                RESP    (PV-CICS-RESP)                            19626071
196270        END-EXEC                                                  19627071
196280                                                                  19628071
196290        MOVE '4645-CALL-SOCKET'          TO PV-CALLING-PARAGRAPH  19629071
196300        MOVE PV-CALLING-PARAGRAPH        TO PV-CICS-MSG-DATA2     19630071
196310        MOVE PV-CICS-MSG-HOLD2           TO PV-CICS-MSG-AREA2     19631071
196320                                                                  19632071
196330        MOVE LENGTH OF PV-CICS-MSG-AREA2 TO PV-COMMAREA-LENGTH    19633071
196340                                                                  19634071
196350        EXEC CICS                                                 19635071
196360            WRITEQ TD                                             19636071
196370                QUEUE   ('CSSL')                                  19637071
196380                FROM    (PV-CICS-MSG-AREA2)                       19638071
196390                LENGTH  (PV-COMMAREA-LENGTH)                      19639071
196400                RESP    (PV-CICS-RESP)                            19640071
196410        END-EXEC                                                  19641071
196420                                                                  19642071
196430        SET  PS-ERROR                                             19643071
196440             DP020-MSG-FATAL  TO TRUE                             19644071
196450        MOVE PC-TSYMSG-01766  TO DP020-MSG-NUMBER                 19645071
196460        PERFORM 9900-SOFT-ABORT                                   19646071
196470     ELSE                                                         19647071
196480                                                                  19648071
196490     IF      PS-DISPLAY-CSSL-YES                                  19649071
196500         INITIALIZE      PV-CICS-MSG-AREA2                        19650071
196510         MOVE DP020-SRC-TASK-NUMBER      TO  PV-DISPLAY-TASK-NBR  19651071
196520         MOVE ASC-PO-NBR             TO  PV-DISPLAY-PO-NBR        19652071
196530         MOVE ASC-REC-SEQ-NBR        TO  PV-DISPLAY-RCVR-SEQ-NBR  19653071
196540         MOVE DP020-LOCATION-NBR     TO  PV-DISPLAY-OPER          19654071
196550         STRING      ' PCKCS701-'                                 19655071
196560                 PV-DISPLAY-OPER                                  19656071
196570                 ' TERM-'                                         19657071
196580                 DP020-TERM-ID                                    19658071
196590                 ' USER-'                                         19659071
196600                 DP020-USERID                                     19660071
196610                 ' TASK-'                                         19661071
196620                 PV-DISPLAY-TASK-NBR                              19662071
196630                 ' PO-'                                           19663071
196640                 PV-DISPLAY-PO-NBR                                19664071
196650                 '-'                                              19665071
196660                 PV-DISPLAY-RCVR-SEQ-NBR                          19666071
196670                 ' AFT CALL SKT1-4645'     DELIMITED BY SIZE      19667071
196680                                      INTO PV-CICS-MSG-AREA2      19668071
196690         MOVE LENGTH OF PV-CICS-MSG-AREA2                         19669071
196700           TO PV-COMMAREA-LENGTH                                  19670071
196710         EXEC CICS                                                19671071
196720              WRITEQ TD                                           19672071
196730               QUEUE      ('CSSL')                                19673071
196740                FROM      (PV-CICS-MSG-AREA2)                     19674071
196750              LENGTH      (PV-COMMAREA-LENGTH)                    19675071
196760                RESP      (PV-CICS-RESP)                          19676071
196770         END-EXEC                                                 19677071
196780     END-IF                                                       19678071
196790                                                                  19679071
196800        IF  PV-SIN-ADDR-2  =  PV-SIN-ADDR-ZERO                    19680071
196810            NEXT SENTENCE                                         19681071
196820        ELSE                                                      19682071
196830            PERFORM 4647-CALL-SOCKET-2                            19683071
196840        END-IF                                                    19684071
196850     END-IF.                                                      19685071
196860                                                                  19686071
196870                                                                  19687071
196880*----------------------------------------------------------------*19688071
196890*   CALL SOCKET - 2                                              *19689071
196900*----------------------------------------------------------------*19690071
196910 4647-CALL-SOCKET-2.                                              19691071
196920                                                                  19692071
196930     IF      PS-DISPLAY-CSSL-YES                                  19693071
196940         INITIALIZE      PV-CICS-MSG-AREA2                        19694071
196950         MOVE DP020-SRC-TASK-NUMBER      TO  PV-DISPLAY-TASK-NBR  19695071
196960         MOVE ASC-PO-NBR             TO  PV-DISPLAY-PO-NBR        19696071
196970         MOVE ASC-REC-SEQ-NBR        TO  PV-DISPLAY-RCVR-SEQ-NBR  19697071
196980         MOVE DP020-LOCATION-NBR     TO  PV-DISPLAY-OPER          19698071
196990         STRING      ' PCKCS701-'                                 19699071
197000                 PV-DISPLAY-OPER                                  19700071
197010                 ' TERM-'                                         19701071
197020                 DP020-TERM-ID                                    19702071
197030                 ' USER-'                                         19703071
197040                 DP020-USERID                                     19704071
197050                 ' TASK-'                                         19705071
197060                 PV-DISPLAY-TASK-NBR                              19706071
197070                 ' PO-'                                           19707071
197080                 PV-DISPLAY-PO-NBR                                19708071
197090                 '-'                                              19709071
197100                 PV-DISPLAY-RCVR-SEQ-NBR                          19710071
197110                 ' BEF CALL SKT2-4647'     DELIMITED BY SIZE      19711071
197120                                      INTO PV-CICS-MSG-AREA2      19712071
197130         MOVE LENGTH OF PV-CICS-MSG-AREA2                         19713071
197140           TO PV-COMMAREA-LENGTH                                  19714071
197150         EXEC CICS                                                19715071
197160              WRITEQ TD                                           19716071
197170               QUEUE      ('CSSL')                                19717071
197180                FROM      (PV-CICS-MSG-AREA2)                     19718071
197190              LENGTH      (PV-COMMAREA-LENGTH)                    19719071
197200                RESP      (PV-CICS-RESP)                          19720071
197210         END-EXEC                                                 19721071
197220     END-IF.                                                      19722071
197230                                                                  19723071
197240                                                                  19724071
197250     MOVE PV-SOCKET-TWO  TO  DP081-SOCK-ID.                       19725071
197260*                                                                 19726071
197270     CALL 'EZASOKET'                                              19727071
197280         USING DP081-SOCKET-CMD                                   19728071
197290               DP081-AF-INET                                      19729071
197300               DP081-SOCK-TYPE                                    19730071
197310               DP081-PROTOCOL                                     19731071
197320               DP081-ERRNO                                        19732071
197330               DP081-RETCODE.                                     19733071
197340                                                                  19734071
197350     MOVE DP081-RETCODE TO DP081-SOCK-ID                          19735071
197360                           PV-SOCKET-TWO.                         19736071
197370                                                                  19737071
197380* CHECK IF TCP-IP ERROR ON SOCKET CALL                            19738071
197390                                                                  19739071
197400     IF DP081-RETCODE < ZERO                                      19740071
197410        MOVE PC-CURRENT-PROGRAM-NAME    TO DP081-TCP-IP-PGM-NAME  19741071
197420        SET  DP081-TCP-IP-SOCKET-ERR    TO TRUE                   19742071
197430        MOVE DP081-ERRNO                TO DP081-TCP-IP-ERR-NBR   19743071
197440        MOVE DP081-TCP-IP-LOGGING-MSG   TO PV-CICS-MSG-DATA       19744071
197450        MOVE PV-CICS-MSG-HOLD           TO PV-CICS-MSG-AREA       19745071
197460                                                                  19746071
197470        MOVE LENGTH OF PV-CICS-MSG-AREA TO PV-COMMAREA-LENGTH     19747071
197480                                                                  19748071
197490        EXEC CICS                                                 19749071
197500            WRITEQ TD                                             19750071
197510                QUEUE   ('CSSL')                                  19751071
197520                FROM    (PV-CICS-MSG-AREA)                        19752071
197530                LENGTH  (PV-COMMAREA-LENGTH)                      19753071
197540                RESP    (PV-CICS-RESP)                            19754071
197550        END-EXEC                                                  19755071
197560                                                                  19756071
197570        MOVE '4647-CALL-SOCKET-2'        TO PV-CALLING-PARAGRAPH  19757071
197580        MOVE PV-CALLING-PARAGRAPH        TO PV-CICS-MSG-DATA2     19758071
197590        MOVE PV-CICS-MSG-HOLD2           TO PV-CICS-MSG-AREA2     19759071
197600                                                                  19760071
197610        MOVE LENGTH OF PV-CICS-MSG-AREA2 TO PV-COMMAREA-LENGTH    19761071
197620                                                                  19762071
197630        EXEC CICS                                                 19763071
197640            WRITEQ TD                                             19764071
197650                QUEUE   ('CSSL')                                  19765071
197660                FROM    (PV-CICS-MSG-AREA2)                       19766071
197670                LENGTH  (PV-COMMAREA-LENGTH)                      19767071
197680                RESP    (PV-CICS-RESP)                            19768071
197690        END-EXEC                                                  19769071
197700                                                                  19770071
197710        SET  PS-ERROR                                             19771071
197720             DP020-MSG-FATAL  TO TRUE                             19772071
197730        MOVE PC-TSYMSG-01766  TO DP020-MSG-NUMBER                 19773071
197740        PERFORM 9900-SOFT-ABORT                                   19774071
197750     END-IF.                                                      19775071
197760                                                                  19776071
197770     IF      PS-DISPLAY-CSSL-YES                                  19777071
197780         INITIALIZE      PV-CICS-MSG-AREA2                        19778071
197790         MOVE DP020-SRC-TASK-NUMBER      TO  PV-DISPLAY-TASK-NBR  19779071
197800         MOVE ASC-PO-NBR             TO  PV-DISPLAY-PO-NBR        19780071
197810         MOVE ASC-REC-SEQ-NBR        TO  PV-DISPLAY-RCVR-SEQ-NBR  19781071
197820         MOVE DP020-LOCATION-NBR     TO  PV-DISPLAY-OPER          19782071
197830         STRING      ' PCKCS701-'                                 19783071
197840                 PV-DISPLAY-OPER                                  19784071
197850                 ' TERM-'                                         19785071
197860                 DP020-TERM-ID                                    19786071
197870                 ' USER-'                                         19787071
197880                 DP020-USERID                                     19788071
197890                 ' TASK-'                                         19789071
197900                 PV-DISPLAY-TASK-NBR                              19790071
197910                 ' PO-'                                           19791071
197920                 PV-DISPLAY-PO-NBR                                19792071
197930                 '-'                                              19793071
197940                 PV-DISPLAY-RCVR-SEQ-NBR                          19794071
197950                 ' AFT CALL SKT2-4647'     DELIMITED BY SIZE      19795071
197960                                      INTO PV-CICS-MSG-AREA2      19796071
197970         MOVE LENGTH OF PV-CICS-MSG-AREA2                         19797071
197980           TO PV-COMMAREA-LENGTH                                  19798071
197990         EXEC CICS                                                19799071
198000              WRITEQ TD                                           19800071
198010               QUEUE      ('CSSL')                                19801071
198020                FROM      (PV-CICS-MSG-AREA2)                     19802071
198030              LENGTH      (PV-COMMAREA-LENGTH)                    19803071
198040                RESP      (PV-CICS-RESP)                          19804071
198050         END-EXEC                                                 19805071
198060     END-IF.                                                      19806071
198070                                                                  19807071
198080                                                                  19808071
198090*----------------------------------------------------------------*19809071
198100*  CONNECT TO SOCKET WHICH WAS GIVEN TO US BY THE AL/SYSTEMS QNX *19810071
198110*  PROGRAM.  CONNECT THE PATH (SOCKET).                          *19811071
198120*----------------------------------------------------------------*19812071
198130 4650-CONNECT-SOCKET.                                             19813071
198140                                                                  19814071
198150     MOVE PV-SOCKET-ONE  TO  DP081-SOCK-ID.                       19815071
198160     MOVE PV-SIN-ADDR-1  TO  DP081-NAME-IP-ADDR.                  19816071
198170                                                                  19817071
198180     MOVE DP081-AF-INET  TO  DP081-NAME-FAMILY.                   19818071
198190     MOVE DP081-COM-PORT TO  DP081-NAME-PORT.                     19819071
198200                                                                  19820071
198210     EVALUATE TRUE                                                19821071
198220         WHEN ASC-OPER-UNT-ID  =  90                              19822071
198230              STRING ' PCKCS701 - '          DELIMITED BY SIZE    19823071
198240                     'TEST AT CORPORATE'     DELIMITED BY SIZE    19824071
198250                     'CONNECT SOCKET 1 '     DELIMITED BY SIZE    19825071
198260                INTO PV-CICS-MSG-DATA                             19826071
198270                MOVE PV-CICS-MSG-HOLD                             19827071
198280                  TO PV-CICS-MSG-AREA                             19828071
198290                MOVE LENGTH OF PV-CICS-MSG-AREA                   19829071
198300                  TO PV-COMMAREA-LENGTH                           19830071
198310             EXEC CICS                                            19831071
198320                 WRITEQ TD                                        19832071
198330                     QUEUE   ('CSSL')                             19833071
198340                     FROM    (PV-CICS-MSG-AREA)                   19834071
198350                     LENGTH  (PV-COMMAREA-LENGTH)                 19835071
198360                     RESP    (PV-CICS-RESP)                       19836071
198370             END-EXEC                                             19837071
198380                                                                  19838071
198390                MOVE  ' 4650-CONNECT-SOCKET-1ST'                  19839071
198400                  TO  PV-CALLING-PARAGRAPH                        19840071
198410                MOVE  PV-CALLING-PARAGRAPH                        19841071
198420                  TO  PV-CICS-MSG-DATA                            19842071
198430                MOVE PV-CICS-MSG-HOLD                             19843071
198440                  TO PV-CICS-MSG-AREA                             19844071
198450                MOVE LENGTH OF PV-CICS-MSG-AREA                   19845071
198460                  TO PV-COMMAREA-LENGTH                           19846071
198470             EXEC CICS                                            19847071
198480                 WRITEQ TD                                        19848071
198490                     QUEUE   ('CSSL')                             19849071
198500                     FROM    (PV-CICS-MSG-AREA)                   19850071
198510                     LENGTH  (PV-COMMAREA-LENGTH)                 19851071
198520                     RESP    (PV-CICS-RESP)                       19852071
198530             END-EXEC                                             19853071
198540     END-EVALUATE.                                                19854071
198550                                                                  19855071
198560     IF      PS-DISPLAY-CSSL-YES                                  19856071
198570         INITIALIZE      PV-CICS-MSG-AREA2                        19857071
198580         MOVE DP020-SRC-TASK-NUMBER      TO  PV-DISPLAY-TASK-NBR  19858071
198590         MOVE ASC-PO-NBR             TO  PV-DISPLAY-PO-NBR        19859071
198600         MOVE ASC-REC-SEQ-NBR        TO  PV-DISPLAY-RCVR-SEQ-NBR  19860071
198610         MOVE DP020-LOCATION-NBR     TO  PV-DISPLAY-OPER          19861071
198620         STRING      ' PCKCS701-'                                 19862071
198630                 PV-DISPLAY-OPER                                  19863071
198640                 ' TERM-'                                         19864071
198650                 DP020-TERM-ID                                    19865071
198660                 ' USER-'                                         19866071
198670                 DP020-USERID                                     19867071
198680                 ' TASK-'                                         19868071
198690                 PV-DISPLAY-TASK-NBR                              19869071
198700                 ' PO-'                                           19870071
198710                 PV-DISPLAY-PO-NBR                                19871071
198720                 '-'                                              19872071
198730                 PV-DISPLAY-RCVR-SEQ-NBR                          19873071
198740                 ' BEF CON SKT1-4650'      DELIMITED BY SIZE      19874071
198750                                      INTO PV-CICS-MSG-AREA2      19875071
198760         MOVE LENGTH OF PV-CICS-MSG-AREA2                         19876071
198770           TO PV-COMMAREA-LENGTH                                  19877071
198780         EXEC CICS                                                19878071
198790              WRITEQ TD                                           19879071
198800               QUEUE      ('CSSL')                                19880071
198810                FROM      (PV-CICS-MSG-AREA2)                     19881071
198820              LENGTH      (PV-COMMAREA-LENGTH)                    19882071
198830                RESP      (PV-CICS-RESP)                          19883071
198840         END-EXEC                                                 19884071
198850     END-IF.                                                      19885071
198860                                                                  19886071
198870     CALL 'EZASOKET'                                              19887071
198880         USING DP081-CONNECT-CMD                                  19888071
198890               DP081-SOCK-ID                                      19889071
198900               DP081-SOCK-NAME                                    19890071
198910               DP081-ERRNO                                        19891071
198920               DP081-RETCODE.                                     19892071
198930                                                                  19893071
198940* CHECK IF TCP-IP ERROR ON SOCKET CONNECT                         19894071
198950                                                                  19895071
198960     IF DP081-RETCODE < ZERO                                      19896071
198970        MOVE PC-CURRENT-PROGRAM-NAME    TO DP081-TCP-IP-PGM-NAME  19897071
198980        SET  DP081-TCP-IP-CONNECT-ERR   TO TRUE                   19898071
198990        MOVE DP081-ERRNO                TO DP081-TCP-IP-ERR-NBR   19899071
199000                                           CONNECT-ERRNO          19900071
199010        STRING ' PCKCS701 - '              DELIMITED BY SIZE      19901071
199020               CONNECT-ERR                 DELIMITED BY SIZE      19902071
199030                                      INTO PV-CICS-MSG-DATA       19903071
199040        MOVE PV-CICS-MSG-HOLD           TO PV-CICS-MSG-AREA       19904071
199050                                                                  19905071
199060        MOVE LENGTH OF PV-CICS-MSG-AREA TO PV-COMMAREA-LENGTH     19906071
199070                                                                  19907071
199080        EXEC CICS                                                 19908071
199090            WRITEQ TD                                             19909071
199100                QUEUE   ('CSSL')                                  19910071
199110                FROM    (PV-CICS-MSG-AREA)                        19911071
199120                LENGTH  (PV-COMMAREA-LENGTH)                      19912071
199130                RESP    (PV-CICS-RESP)                            19913071
199140        END-EXEC                                                  19914071
199150                                                                  19915071
199160        INITIALIZE PV-CICS-MSG-AREA2                              19916071
199170        MOVE ASC-PO-NBR                  TO  PV-DSPLY-PO          19917071
199180        MOVE ASC-REC-SEQ-NBR             TO  PV-DSPLY-RCVR        19918071
199190        MOVE DK-LINE-NBR                 TO  PV-DSPLY-LNE         19919071
199200        MOVE ASC-OPER-UNT-ID             TO  PV-DSPLY-OPER        19920071
199210        STRING ' PCKCS701-'                  DELIMITED BY SIZE    19921071
199220               ' 4650-CONNECT-SOCKET-2ND'    DELIMITED BY SIZE    19922071
199230               ' - '                         DELIMITED BY SIZE    19923071
199240               PV-DSPLY-OPER                 DELIMITED BY SIZE    19924071
199250               ' PO/RCVR/LNE - '             DELIMITED BY SIZE    19925071
199260               PV-DSPLY-PO                   DELIMITED BY SIZE    19926071
199270               '-'                           DELIMITED BY SIZE    19927071
199280               PV-DSPLY-RCVR                 DELIMITED BY SIZE    19928071
199290               '-'                           DELIMITED BY SIZE    19929071
199300               PV-DSPLY-LNE                  DELIMITED BY SIZE    19930071
199310                                        INTO PV-CICS-MSG-AREA2    19931071
199320        MOVE LENGTH OF PV-CICS-MSG-AREA2 TO PV-COMMAREA-LENGTH    19932071
199330                                                                  19933071
199340        EXEC CICS                                                 19934071
199350             WRITEQ TD                                            19935071
199360                 QUEUE   ('CSSL')                                 19936071
199370                 FROM    (PV-CICS-MSG-AREA2)                      19937071
199380                 LENGTH  (PV-COMMAREA-LENGTH)                     19938071
199390                 RESP    (PV-CICS-RESP)                           19939071
199400        END-EXEC                                                  19940071
199410                                                                  19941071
199420        SET  PS-ERROR                                             19942071
199430             DP020-MSG-FATAL  TO TRUE                             19943071
199440        MOVE PC-TSYMSG-01766  TO DP020-MSG-NUMBER                 19944071
199450        PERFORM 9900-SOFT-ABORT                                   19945071
199460     ELSE                                                         19946071
199470                                                                  19947071
199480     IF      PS-DISPLAY-CSSL-YES                                  19948071
199490         INITIALIZE      PV-CICS-MSG-AREA2                        19949071
199500         MOVE DP020-SRC-TASK-NUMBER      TO  PV-DISPLAY-TASK-NBR  19950071
199510         MOVE ASC-PO-NBR             TO  PV-DISPLAY-PO-NBR        19951071
199520         MOVE ASC-REC-SEQ-NBR        TO  PV-DISPLAY-RCVR-SEQ-NBR  19952071
199530         MOVE DP020-LOCATION-NBR     TO  PV-DISPLAY-OPER          19953071
199540         STRING      ' PCKCS701-'                                 19954071
199550                 PV-DISPLAY-OPER                                  19955071
199560                 ' TERM-'                                         19956071
199570                 DP020-TERM-ID                                    19957071
199580                 ' USER-'                                         19958071
199590                 DP020-USERID                                     19959071
199600                 ' TASK-'                                         19960071
199610                 PV-DISPLAY-TASK-NBR                              19961071
199620                 ' PO-'                                           19962071
199630                 PV-DISPLAY-PO-NBR                                19963071
199640                 '-'                                              19964071
199650                 PV-DISPLAY-RCVR-SEQ-NBR                          19965071
199660                 ' AFT CON SKT1-4650'      DELIMITED BY SIZE      19966071
199670                                      INTO PV-CICS-MSG-AREA2      19967071
199680         MOVE LENGTH OF PV-CICS-MSG-AREA2                         19968071
199690           TO PV-COMMAREA-LENGTH                                  19969071
199700         EXEC CICS                                                19970071
199710              WRITEQ TD                                           19971071
199720               QUEUE      ('CSSL')                                19972071
199730                FROM      (PV-CICS-MSG-AREA2)                     19973071
199740              LENGTH      (PV-COMMAREA-LENGTH)                    19974071
199750                RESP      (PV-CICS-RESP)                          19975071
199760         END-EXEC                                                 19976071
199770     END-IF                                                       19977071
199780                                                                  19978071
199790         IF  PV-SIN-ADDR-2  =  PV-SIN-ADDR-ZERO                   19979071
199800             NEXT SENTENCE                                        19980071
199810         ELSE                                                     19981071
199820             PERFORM 4652-CONNECT-SOCKET-2                        19982071
199830         END-IF                                                   19983071
199840     END-IF.                                                      19984071
199850                                                                  19985071
199860*----------------------------------------------------------------*19986071
199870*  CONNECT TO SOCKET WHICH WAS GIVEN TO US BY THE AL/SYSTEMS QNX *19987071
199880*  PROGRAM.  CONNECT THE PATH (SOCKET).                          *19988071
199890*----------------------------------------------------------------*19989071
199900 4652-CONNECT-SOCKET-2.                                           19990071
199910                                                                  19991071
199920     MOVE PV-SOCKET-TWO  TO  DP081-SOCK-ID.                       19992071
199930     MOVE PV-SIN-ADDR-2  TO  DP081-NAME-IP-ADDR.                  19993071
199940                                                                  19994071
199950     MOVE DP081-AF-INET  TO  DP081-NAME-FAMILY.                   19995071
199960     MOVE DP081-COM-PORT TO  DP081-NAME-PORT.                     19996071
199970                                                                  19997071
199980     EVALUATE TRUE                                                19998071
199990         WHEN ASC-OPER-UNT-ID  =  90                              19999071
200000              STRING ' PCKCS701 - '          DELIMITED BY SIZE    20000071
200010                     'TEST AT CORPORATE'     DELIMITED BY SIZE    20001071
200020                     'CONNECT SOCKET 2 '     DELIMITED BY SIZE    20002071
200030                INTO PV-CICS-MSG-DATA                             20003071
200040                MOVE PV-CICS-MSG-HOLD                             20004071
200050                  TO PV-CICS-MSG-AREA                             20005071
200060                MOVE LENGTH OF PV-CICS-MSG-AREA                   20006071
200070                  TO PV-COMMAREA-LENGTH                           20007071
200080             EXEC CICS                                            20008071
200090                 WRITEQ TD                                        20009071
200100                     QUEUE   ('CSSL')                             20010071
200110                     FROM    (PV-CICS-MSG-AREA)                   20011071
200120                     LENGTH  (PV-COMMAREA-LENGTH)                 20012071
200130                     RESP    (PV-CICS-RESP)                       20013071
200140             END-EXEC                                             20014071
200150                                                                  20015071
200160                MOVE  '4652-CONNECT-SOCKET-2-1ST'                 20016071
200170                  TO  PV-CALLING-PARAGRAPH                        20017071
200180                MOVE  PV-CALLING-PARAGRAPH                        20018071
200190                  TO  PV-CICS-MSG-DATA                            20019071
200200                MOVE PV-CICS-MSG-HOLD                             20020071
200210                  TO PV-CICS-MSG-AREA                             20021071
200220                MOVE LENGTH OF PV-CICS-MSG-AREA                   20022071
200230                  TO PV-COMMAREA-LENGTH                           20023071
200240             EXEC CICS                                            20024071
200250                 WRITEQ TD                                        20025071
200260                     QUEUE   ('CSSL')                             20026071
200270                     FROM    (PV-CICS-MSG-AREA)                   20027071
200280                     LENGTH  (PV-COMMAREA-LENGTH)                 20028071
200290                     RESP    (PV-CICS-RESP)                       20029071
200300             END-EXEC                                             20030071
200310     END-EVALUATE.                                                20031071
200320                                                                  20032071
200330     IF PS-DISPLAY-CSSL-YES                                       20033071
200340         INITIALIZE PV-CICS-MSG-AREA2                             20034071
200350         MOVE DP020-SRC-TASK-NUMBER TO PV-DISPLAY-TASK-NBR        20035071
200360         MOVE ASC-PO-NBR             TO  PV-DISPLAY-PO-NBR        20036071
200370         MOVE ASC-REC-SEQ-NBR TO PV-DISPLAY-RCVR-SEQ-NBR          20037071
200380         MOVE DP020-LOCATION-NBR     TO  PV-DISPLAY-OPER          20038071
200390         STRING ' PCKCS701-'                                      20039071
200400                 PV-DISPLAY-OPER                                  20040071
200410                 ' TERM-'                                         20041071
200420                 DP020-TERM-ID                                    20042071
200430                 ' USER-'                                         20043071
200440                 DP020-USERID                                     20044071
200450                 ' TASK-'                                         20045071
200460                 PV-DISPLAY-TASK-NBR                              20046071
200470                 ' PO-'                                           20047071
200480                 PV-DISPLAY-PO-NBR                                20048071
200490                 '-'                                              20049071
200500                 PV-DISPLAY-RCVR-SEQ-NBR                          20050071
200510                 ' BEF CON SKT2-4652' DELIMITED BY SIZE           20051071
200520                                      INTO PV-CICS-MSG-AREA2      20052071
200530         MOVE LENGTH OF PV-CICS-MSG-AREA2                         20053071
200540           TO PV-COMMAREA-LENGTH                                  20054071
200550         EXEC CICS                                                20055071
200560              WRITEQ TD                                           20056071
200570               QUEUE ('CSSL')                                     20057071
200580                FROM (PV-CICS-MSG-AREA2)                          20058071
200590              LENGTH (PV-COMMAREA-LENGTH)                         20059071
200600                RESP (PV-CICS-RESP)                               20060071
200610         END-EXEC                                                 20061071
200620     END-IF.                                                      20062071
200630                                                                  20063071
200640                                                                  20064071
200650     CALL 'EZASOKET'                                              20065071
200660         USING DP081-CONNECT-CMD                                  20066071
200670               DP081-SOCK-ID                                      20067071
200680               DP081-SOCK-NAME                                    20068071
200690               DP081-ERRNO                                        20069071
200700               DP081-RETCODE.                                     20070071
200710                                                                  20071071
200720* CHECK IF TCP-IP ERROR ON SOCKET CONNECT                         20072071
200730                                                                  20073071
200740     IF DP081-RETCODE < ZERO                                      20074071
200750        MOVE PC-CURRENT-PROGRAM-NAME    TO DP081-TCP-IP-PGM-NAME  20075071
200760        SET  DP081-TCP-IP-CONNECT-ERR   TO TRUE                   20076071
200770        MOVE DP081-ERRNO                TO DP081-TCP-IP-ERR-NBR   20077071
200780                                           CONNECT-ERRNO          20078071
200790        STRING ' PCKCS701 - '              DELIMITED BY SIZE      20079071
200800               CONNECT-ERR                 DELIMITED BY SIZE      20080071
200810                                      INTO PV-CICS-MSG-DATA       20081071
200820        MOVE PV-CICS-MSG-HOLD           TO PV-CICS-MSG-AREA       20082071
200830                                                                  20083071
200840        MOVE LENGTH OF PV-CICS-MSG-AREA TO PV-COMMAREA-LENGTH     20084071
200850                                                                  20085071
200860        EXEC CICS                                                 20086071
200870            WRITEQ TD                                             20087071
200880                QUEUE   ('CSSL')                                  20088071
200890                FROM    (PV-CICS-MSG-AREA)                        20089071
200900                LENGTH  (PV-COMMAREA-LENGTH)                      20090071
200910                RESP    (PV-CICS-RESP)                            20091071
200920        END-EXEC                                                  20092071
200930                                                                  20093071
200940        INITIALIZE PV-CICS-MSG-AREA2                              20094071
200950        MOVE ASC-PO-NBR                  TO  PV-DSPLY-PO          20095071
200960        MOVE ASC-REC-SEQ-NBR             TO  PV-DSPLY-RCVR        20096071
200970        MOVE DK-LINE-NBR                 TO  PV-DSPLY-LNE         20097071
200980        MOVE ASC-OPER-UNT-ID             TO  PV-DSPLY-OPER        20098071
200990        STRING ' PCKCS701-'                  DELIMITED BY SIZE    20099071
201000               ' 4652-CONNECT-SOCKET-2-2ND'  DELIMITED BY SIZE    20100071
201010               ' - '                         DELIMITED BY SIZE    20101071
201020               PV-DSPLY-OPER                 DELIMITED BY SIZE    20102071
201030               ' PO/RCVR/LNE - '             DELIMITED BY SIZE    20103071
201040               PV-DSPLY-PO                   DELIMITED BY SIZE    20104071
201050               '-'                           DELIMITED BY SIZE    20105071
201060               PV-DSPLY-RCVR                 DELIMITED BY SIZE    20106071
201070               '-'                           DELIMITED BY SIZE    20107071
201080               PV-DSPLY-LNE                  DELIMITED BY SIZE    20108071
201090                                        INTO PV-CICS-MSG-AREA2    20109071
201100        MOVE LENGTH OF PV-CICS-MSG-AREA2 TO PV-COMMAREA-LENGTH    20110071
201110                                                                  20111071
201120        EXEC CICS                                                 20112071
201130             WRITEQ TD                                            20113071
201140                 QUEUE   ('CSSL')                                 20114071
201150                 FROM    (PV-CICS-MSG-AREA2)                      20115071
201160                 LENGTH  (PV-COMMAREA-LENGTH)                     20116071
201170                 RESP    (PV-CICS-RESP)                           20117071
201180        END-EXEC                                                  20118071
201190                                                                  20119071
201200        SET  PS-ERROR                                             20120071
201210             DP020-MSG-FATAL  TO TRUE                             20121071
201220        MOVE PC-TSYMSG-01766  TO DP020-MSG-NUMBER                 20122071
201230        PERFORM 9900-SOFT-ABORT                                   20123071
201240     END-IF.                                                      20124071
201250                                                                  20125071
201260     IF PS-DISPLAY-CSSL-YES                                       20126071
201270         INITIALIZE PV-CICS-MSG-AREA2                             20127071
201280         MOVE DP020-SRC-TASK-NUMBER TO PV-DISPLAY-TASK-NBR        20128071
201290         MOVE ASC-PO-NBR             TO  PV-DISPLAY-PO-NBR        20129071
201300         MOVE ASC-REC-SEQ-NBR TO PV-DISPLAY-RCVR-SEQ-NBR          20130071
201310         MOVE DP020-LOCATION-NBR     TO  PV-DISPLAY-OPER          20131071
201320         STRING ' PCKCS701-'                                      20132071
201330                  PV-DISPLAY-OPER                                 20133071
201340                 ' TERM-'                                         20134071
201350                 DP020-TERM-ID                                    20135071
201360                 ' USER-'                                         20136071
201370                 DP020-USERID                                     20137071
201380                 ' TASK-'                                         20138071
201390                 PV-DISPLAY-TASK-NBR                              20139071
201400                 ' PO-'                                           20140071
201410                 PV-DISPLAY-PO-NBR                                20141071
201420                 '-'                                              20142071
201430                 PV-DISPLAY-RCVR-SEQ-NBR                          20143071
201440                 ' AFT CON SKT2-4652' DELIMITED BY SIZE           20144071
201450                                      INTO PV-CICS-MSG-AREA2      20145071
201460         MOVE LENGTH OF PV-CICS-MSG-AREA2                         20146071
201470           TO PV-COMMAREA-LENGTH                                  20147071
201480         EXEC CICS                                                20148071
201490              WRITEQ TD                                           20149071
201500               QUEUE ('CSSL')                                     20150071
201510                FROM (PV-CICS-MSG-AREA2)                          20151071
201520              LENGTH (PV-COMMAREA-LENGTH)                         20152071
201530                RESP (PV-CICS-RESP)                               20153071
201540         END-EXEC                                                 20154071
201550     END-IF.                                                      20155071
201560                                                                  20156071
201570                                                                  20157071
201580*----------------------------------------------------------------*20158071
201590*  CLOSE THE SOCKET WHICH WAS GIVEN TO US BY THE AL/SYSTEMS QNX  *20159071
201600*  PROGRAM.                                                      *20160071
201610*----------------------------------------------------------------*20161071
201620 4655-CLOSE-SOCKET.                                               20162071
201630*===TKMA408=== THIS IS IN JUST FOR TESTING                        20163071
201640*       MOVE '4655-CLOSE-SOCKET-1'    TO PV-CALLING-PARAGRAPH     20164071
201650*       MOVE PV-CALLING-PARAGRAPH     TO PV-CICS-MSG-DATA2        20165071
201660*       MOVE PV-CICS-MSG-HOLD2        TO PV-CICS-MSG-AREA2        20166071
201670*                                                                 20167071
201680*       MOVE LENGTH OF PV-CICS-MSG-AREA2                          20168071
201690*                                     TO PV-COMMAREA-LENGTH       20169071
201700*       EXEC CICS                                                 20170071
201710*           WRITEQ TD                                             20171071
201720*               QUEUE   ('CSSL')                                  20172071
201730*               FROM    (PV-CICS-MSG-AREA2)                       20173071
201740*               LENGTH  (PV-COMMAREA-LENGTH)                      20174071
201750*               RESP    (PV-CICS-RESP)                            20175071
201760*       END-EXEC.                                                 20176071
201770*===TKMA408=== THIS IS IN JUST FOR TESTING                        20177071
201780*                                                                 20178071
201790*    IF PS-DISPLAY-CSSL-YES                                       20179071
201800*        INITIALIZE PV-CICS-MSG-AREA2                             20180071
201810*        MOVE DP020-SRC-TASK-NUMBER TO PV-DISPLAY-TASK-NBR        20181071
201820*        MOVE ASC-PO-NBR             TO  PV-DISPLAY-PO-NBR        20182071
201830*        MOVE ASC-REC-SEQ-NBR TO PV-DISPLAY-RCVR-SEQ-NBR          20183071
201840*        MOVE DP020-LOCATION-NBR     TO  PV-DISPLAY-OPER          20184071
201850*        STRING ' PCKCS701-'                                      20185071
201860*                PV-DISPLAY-OPER                                  20186071
201870*                ' TERM-'                                         20187071
201880*                DP020-TERM-ID                                    20188071
201890*                ' USER-'                                         20189071
201900*                DP020-USERID                                     20190071
201910*                ' TASK-'                                         20191071
201920*                PV-DISPLAY-TASK-NBR                              20192071
201930*                ' PO-'                                           20193071
201940*                PV-DISPLAY-PO-NBR                                20194071
201950*                '-'                                              20195071
201960*                PV-DISPLAY-RCVR-SEQ-NBR                          20196071
201970*                ' BEF CLO SKT1-4655' DELIMITED BY SIZE           20197071
201980*                                     INTO PV-CICS-MSG-AREA2      20198071
201990*        MOVE LENGTH OF PV-CICS-MSG-AREA2                         20199071
202000*          TO PV-COMMAREA-LENGTH                                  20200071
202010*        EXEC CICS                                                20201071
202020*             WRITEQ TD                                           20202071
202030*              QUEUE ('CSSL')                                     20203071
202040*               FROM (PV-CICS-MSG-AREA2)                          20204071
202050*             LENGTH (PV-COMMAREA-LENGTH)                         20205071
202060*               RESP (PV-CICS-RESP)                               20206071
202070*        END-EXEC                                                 20207071
202080*    END-IF.                                                      20208071
202090                                                                  20209071
202100                                                                  20210071
202110     MOVE PV-SOCKET-ONE  TO  DP081-SOCK-ID.                       20211071
202120                                                                  20212071
202130     CALL 'EZASOKET'                                              20213071
202140         USING DP081-CLOSE-CMD                                    20214071
202150               DP081-SOCK-ID                                      20215071
202160               DP081-ERRNO                                        20216071
202170               DP081-RETCODE.                                     20217071
202180                                                                  20218071
202190* CHECK IF TCP-IP ERROR ON SOCKET CLOSE                           20219071
202200                                                                  20220071
202210     IF DP081-RETCODE < ZERO                                      20221071
202220        MOVE PC-CURRENT-PROGRAM-NAME    TO DP081-TCP-IP-PGM-NAME  20222071
202230        SET  DP081-TCP-IP-CLOSE-ERR     TO TRUE                   20223071
202240        MOVE DP081-ERRNO                TO DP081-TCP-IP-ERR-NBR   20224071
202250        MOVE DP081-TCP-IP-LOGGING-MSG   TO PV-CICS-MSG-DATA       20225071
202260        MOVE PV-CICS-MSG-HOLD           TO PV-CICS-MSG-AREA       20226071
202270                                                                  20227071
202280        MOVE LENGTH OF PV-CICS-MSG-AREA TO PV-COMMAREA-LENGTH     20228071
202290                                                                  20229071
202300        EXEC CICS                                                 20230071
202310            WRITEQ TD                                             20231071
202320                QUEUE   ('CSSL')                                  20232071
202330                FROM    (PV-CICS-MSG-AREA)                        20233071
202340                LENGTH  (PV-COMMAREA-LENGTH)                      20234071
202350                RESP    (PV-CICS-RESP)                            20235071
202360        END-EXEC                                                  20236071
202370                                                                  20237071
202380        MOVE '4655-CLOSE-SOCKET'         TO PV-CALLING-PARAGRAPH  20238071
202390        MOVE PV-CALLING-PARAGRAPH        TO PV-CICS-MSG-DATA2     20239071
202400        MOVE PV-CICS-MSG-HOLD2           TO PV-CICS-MSG-AREA2     20240071
202410        MOVE LENGTH OF PV-CICS-MSG-AREA2 TO PV-COMMAREA-LENGTH    20241071
202420                                                                  20242071
202430        EXEC CICS                                                 20243071
202440            WRITEQ TD                                             20244071
202450                QUEUE   ('CSSL')                                  20245071
202460                FROM    (PV-CICS-MSG-AREA2)                       20246071
202470                LENGTH  (PV-COMMAREA-LENGTH)                      20247071
202480                RESP    (PV-CICS-RESP)                            20248071
202490        END-EXEC                                                  20249071
202500                                                                  20250071
202510        SET  PS-ERROR                                             20251071
202520             DP020-MSG-FATAL  TO TRUE                             20252071
202530        MOVE PC-TSYMSG-01766  TO DP020-MSG-NUMBER                 20253071
202540        PERFORM 9900-SOFT-ABORT                                   20254071
202550     ELSE                                                         20255071
202560*                                                                 20256071
202570*    IF PS-DISPLAY-CSSL-YES                                       20257071
202580*        INITIALIZE PV-CICS-MSG-AREA2                             20258071
202590*        MOVE DP020-SRC-TASK-NUMBER TO PV-DISPLAY-TASK-NBR        20259071
202600*        MOVE ASC-PO-NBR             TO  PV-DISPLAY-PO-NBR        20260071
202610*        MOVE ASC-REC-SEQ-NBR TO PV-DISPLAY-RCVR-SEQ-NBR          20261071
202620*        MOVE DP020-LOCATION-NBR     TO  PV-DISPLAY-OPER          20262071
202630*        STRING ' PCKCS701-'                                      20263071
202640*                PV-DISPLAY-OPER                                  20264071
202650*                ' TERM-'                                         20265071
202660*                DP020-TERM-ID                                    20266071
202670*                ' USER-'                                         20267071
202680*                DP020-USERID                                     20268071
202690*                ' TASK-'                                         20269071
202700*                PV-DISPLAY-TASK-NBR                              20270071
202710*                ' PO-'                                           20271071
202720*                PV-DISPLAY-PO-NBR                                20272071
202730*                '-'                                              20273071
202740*                PV-DISPLAY-RCVR-SEQ-NBR                          20274071
202750*                ' AFT CLO SKT1-4655' DELIMITED BY SIZE           20275071
202760*                                     INTO PV-CICS-MSG-AREA2      20276071
202770*        MOVE LENGTH OF PV-CICS-MSG-AREA2                         20277071
202780*          TO PV-COMMAREA-LENGTH                                  20278071
202790*        EXEC CICS                                                20279071
202800*             WRITEQ TD                                           20280071
202810*              QUEUE ('CSSL')                                     20281071
202820*               FROM (PV-CICS-MSG-AREA2)                          20282071
202830*             LENGTH (PV-COMMAREA-LENGTH)                         20283071
202840*               RESP (PV-CICS-RESP)                               20284071
202850*        END-EXEC                                                 20285071
202860*    END-IF                                                       20286071
202870                                                                  20287071
202880        IF  PV-SIN-ADDR-2  = PV-SIN-ADDR-ZERO                     20288071
202890            NEXT SENTENCE                                         20289071
202900        ELSE                                                      20290071
202910            PERFORM 4657-CLOSE-SOCKET-2                           20291071
202920        END-IF                                                    20292071
202930     END-IF.                                                      20293071
202940                                                                  20294071
202950                                                                  20295071
202960*----------------------------------------------------------------*20296071
202970*  CLOSE THE SOCKET WHICH WAS GIVEN TO US BY THE AL/SYSTEMS QNX  *20297071
202980*  PROGRAM.                                                      *20298071
202990*----------------------------------------------------------------*20299071
203000 4657-CLOSE-SOCKET-2.                                             20300071
203010*===TKMA408=== THIS IS IN JUST FOR TESTING                        20301071
203020*       MOVE '4657-CLOSE-SOCKET-2'    TO PV-CALLING-PARAGRAPH     20302071
203030*       MOVE PV-CALLING-PARAGRAPH     TO PV-CICS-MSG-DATA2        20303071
203040*       MOVE PV-CICS-MSG-HOLD2        TO PV-CICS-MSG-AREA2        20304071
203050*                                                                 20305071
203060*       MOVE LENGTH OF PV-CICS-MSG-AREA2                          20306071
203070*                                     TO PV-COMMAREA-LENGTH       20307071
203080*       EXEC CICS                                                 20308071
203090*           WRITEQ TD                                             20309071
203100*               QUEUE   ('CSSL')                                  20310071
203110*               FROM    (PV-CICS-MSG-AREA2)                       20311071
203120*               LENGTH  (PV-COMMAREA-LENGTH)                      20312071
203130*               RESP    (PV-CICS-RESP)                            20313071
203140*       END-EXEC.                                                 20314071
203150*===TKMA408=== THIS IS IN JUST FOR TESTING                        20315071
203160                                                                  20316071
203170     IF PS-DISPLAY-CSSL-YES                                       20317071
203180         INITIALIZE PV-CICS-MSG-AREA2                             20318071
203190         MOVE DP020-SRC-TASK-NUMBER TO PV-DISPLAY-TASK-NBR        20319071
203200         MOVE ASC-PO-NBR             TO  PV-DISPLAY-PO-NBR        20320071
203210         MOVE ASC-REC-SEQ-NBR TO PV-DISPLAY-RCVR-SEQ-NBR          20321071
203220         MOVE DP020-LOCATION-NBR     TO  PV-DISPLAY-OPER          20322071
203230         STRING ' PCKCS701-'                                      20323071
203240                 PV-DISPLAY-OPER                                  20324071
203250                 ' TERM-'                                         20325071
203260                 DP020-TERM-ID                                    20326071
203270                 ' USER-'                                         20327071
203280                 DP020-USERID                                     20328071
203290                 ' TASK-'                                         20329071
203300                 PV-DISPLAY-TASK-NBR                              20330071
203310                 ' PO-'                                           20331071
203320                 PV-DISPLAY-PO-NBR                                20332071
203330                 '-'                                              20333071
203340                 PV-DISPLAY-RCVR-SEQ-NBR                          20334071
203350                 ' BEF CLO SKT1-4657' DELIMITED BY SIZE           20335071
203360                                      INTO PV-CICS-MSG-AREA2      20336071
203370         MOVE LENGTH OF PV-CICS-MSG-AREA2                         20337071
203380           TO PV-COMMAREA-LENGTH                                  20338071
203390         EXEC CICS                                                20339071
203400              WRITEQ TD                                           20340071
203410               QUEUE ('CSSL')                                     20341071
203420                FROM (PV-CICS-MSG-AREA2)                          20342071
203430              LENGTH (PV-COMMAREA-LENGTH)                         20343071
203440                RESP (PV-CICS-RESP)                               20344071
203450         END-EXEC                                                 20345071
203460     END-IF.                                                      20346071
203470                                                                  20347071
203480                                                                  20348071
203490     MOVE PV-SOCKET-TWO  TO  DP081-SOCK-ID.                       20349071
203500                                                                  20350071
203510     CALL 'EZASOKET'                                              20351071
203520         USING DP081-CLOSE-CMD                                    20352071
203530               DP081-SOCK-ID                                      20353071
203540               DP081-ERRNO                                        20354071
203550               DP081-RETCODE.                                     20355071
203560                                                                  20356071
203570* CHECK IF TCP-IP ERROR ON SOCKET CLOSE                           20357071
203580                                                                  20358071
203590     IF DP081-RETCODE < ZERO                                      20359071
203600        MOVE PC-CURRENT-PROGRAM-NAME    TO DP081-TCP-IP-PGM-NAME  20360071
203610        SET  DP081-TCP-IP-CLOSE-ERR     TO TRUE                   20361071
203620        MOVE DP081-ERRNO                TO DP081-TCP-IP-ERR-NBR   20362071
203630        MOVE DP081-TCP-IP-LOGGING-MSG   TO PV-CICS-MSG-DATA       20363071
203640        MOVE PV-CICS-MSG-HOLD           TO PV-CICS-MSG-AREA       20364071
203650        MOVE LENGTH OF PV-CICS-MSG-AREA TO PV-COMMAREA-LENGTH     20365071
203660                                                                  20366071
203670        EXEC CICS                                                 20367071
203680            WRITEQ TD                                             20368071
203690                QUEUE   ('CSSL')                                  20369071
203700                FROM    (PV-CICS-MSG-AREA)                        20370071
203710                LENGTH  (PV-COMMAREA-LENGTH)                      20371071
203720                RESP    (PV-CICS-RESP)                            20372071
203730        END-EXEC                                                  20373071
203740                                                                  20374071
203750        MOVE '4657-CLOSE-SOCKET-2'       TO PV-CALLING-PARAGRAPH  20375071
203760        MOVE PV-CALLING-PARAGRAPH        TO PV-CICS-MSG-DATA2     20376071
203770        MOVE PV-CICS-MSG-HOLD2           TO PV-CICS-MSG-AREA2     20377071
203780        MOVE LENGTH OF PV-CICS-MSG-AREA2 TO PV-COMMAREA-LENGTH    20378071
203790                                                                  20379071
203800        EXEC CICS                                                 20380071
203810            WRITEQ TD                                             20381071
203820                QUEUE   ('CSSL')                                  20382071
203830                FROM    (PV-CICS-MSG-AREA2)                       20383071
203840                LENGTH  (PV-COMMAREA-LENGTH)                      20384071
203850                RESP    (PV-CICS-RESP)                            20385071
203860        END-EXEC                                                  20386071
203870                                                                  20387071
203880        SET  PS-ERROR                                             20388071
203890             DP020-MSG-FATAL  TO TRUE                             20389071
203900        MOVE PC-TSYMSG-01766  TO DP020-MSG-NUMBER                 20390071
203910        PERFORM 9900-SOFT-ABORT                                   20391071
203920     END-IF.                                                      20392071
203930                                                                  20393071
203940     IF PS-DISPLAY-CSSL-YES                                       20394071
203950         INITIALIZE PV-CICS-MSG-AREA2                             20395071
203960         MOVE DP020-SRC-TASK-NUMBER TO PV-DISPLAY-TASK-NBR        20396071
203970         MOVE ASC-PO-NBR             TO  PV-DISPLAY-PO-NBR        20397071
203980         MOVE ASC-REC-SEQ-NBR TO PV-DISPLAY-RCVR-SEQ-NBR          20398071
203990         MOVE DP020-LOCATION-NBR     TO  PV-DISPLAY-OPER          20399071
204000         STRING ' PCKCS701-'                                      20400071
204010                 PV-DISPLAY-OPER                                  20401071
204020                 ' TERM-'                                         20402071
204030                 DP020-TERM-ID                                    20403071
204040                 ' USER-'                                         20404071
204050                 DP020-USERID                                     20405071
204060                 ' TASK-'                                         20406071
204070                 PV-DISPLAY-TASK-NBR                              20407071
204080                 ' PO-'                                           20408071
204090                 PV-DISPLAY-PO-NBR                                20409071
204100                 '-'                                              20410071
204110                 PV-DISPLAY-RCVR-SEQ-NBR                          20411071
204120                 ' AFT CLO SKT1-4657' DELIMITED BY SIZE           20412071
204130                                      INTO PV-CICS-MSG-AREA2      20413071
204140         MOVE LENGTH OF PV-CICS-MSG-AREA2                         20414071
204150           TO PV-COMMAREA-LENGTH                                  20415071
204160         EXEC CICS                                                20416071
204170              WRITEQ TD                                           20417071
204180               QUEUE ('CSSL')                                     20418071
204190                FROM (PV-CICS-MSG-AREA2)                          20419071
204200              LENGTH (PV-COMMAREA-LENGTH)                         20420071
204210                RESP (PV-CICS-RESP)                               20421071
204220         END-EXEC                                                 20422071
204230     END-IF.                                                      20423071
204240                                                                  20424071
204250                                                                  20425071
204260*----------------------------------------------------------------*20426071
204270*  CREATE LABEL REQUEST - P2L ONLY (PACK-TO-LIGHT)               *20427071
204280*----------------------------------------------------------------*20428071
204290 4660-CREATE-P2L-ONLY.                                            20429071
204300     MOVE PC-N                    TO  DISTDT-ODD-CART-IND.        20430071
204310                                                                  20431071
204320     MOVE PV-PO-NBR               TO  DK-PO-NBR.                  20432071
204330     MOVE PV-REC-SEQ-NBR          TO  DK-REC-SEQ-NBR.             20433071
204340     MOVE PV-PO-LINE-NBR          TO  DK-LINE-NBR.                20434071
204350                                                                  20435071
204360     IF  ASC-P2L-AL-DOWNLOAD-NO  AND                              20436071
204370         ASC-P2L-PCC-DOWNLOAD-NO                                  20437071
204380         NEXT SENTENCE                                            20438071
204390     ELSE                                                         20439071
204400         IF  PS-SOCKET-INITIALIZED-NO                             20440071
204410             IF  PS-NO-ERROR                                      20441071
204420                 PERFORM 4645-CALL-SOCKET                         20442071
204430             END-IF                                               20443071
204440             IF  PS-NO-ERROR                                      20444071
204450                 PERFORM 4650-CONNECT-SOCKET                      20445071
204460             END-IF                                               20446071
204470             IF  PS-NO-ERROR                                      20447071
204480                 SET PS-SOCKET-INITIALIZED-YES  TO  TRUE          20448071
204490             END-IF                                               20449071
204500         END-IF                                                   20450071
204510     END-IF.                                                      20451071
204520*                                                                 20452071
204530*    IF  PS-NO-ERROR  AND                                         20453071
204540*        PS-DISPLAY-CSSL-YES                                      20454071
204550*        INITIALIZE      PV-CICS-MSG-AREA2                        20455071
204560*        MOVE DP020-SRC-TASK-NUMBER      TO  PV-DISPLAY-TASK-NBR  20456071
204570*        MOVE ASC-PO-NBR             TO  PV-DISPLAY-PO-NBR        20457071
204580*        MOVE ASC-REC-SEQ-NBR        TO  PV-DISPLAY-RCVR-SEQ-NBR  20458071
204590*        MOVE DP020-LOCATION-NBR     TO  PV-DISPLAY-OPER          20459071
204600*        STRING      ' PCKCS701-'                                 20460071
204610*                PV-DISPLAY-OPER                                  20461071
204620*                ' TERM-'                                         20462071
204630*                DP020-TERM-ID                                    20463071
204640*                ' USER-'                                         20464071
204650*                DP020-USERID                                     20465071
204660*                ' TASK-'                                         20466071
204670*                PV-DISPLAY-TASK-NBR                              20467071
204680*                ' PO-'                                           20468071
204690*                PV-DISPLAY-PO-NBR                                20469071
204700*                '-'                                              20470071
204710*                PV-DISPLAY-RCVR-SEQ-NBR                          20471071
204720*                ' BEF BLD HDR-4700 '      DELIMITED BY SIZE      20472071
204730*                                     INTO PV-CICS-MSG-AREA2      20473071
204740*        MOVE LENGTH OF PV-CICS-MSG-AREA2                         20474071
204750*          TO PV-COMMAREA-LENGTH                                  20475071
204760*        EXEC CICS                                                20476071
204770*             WRITEQ TD                                           20477071
204780*              QUEUE      ('CSSL')                                20478071
204790*               FROM      (PV-CICS-MSG-AREA2)                     20479071
204800*             LENGTH      (PV-COMMAREA-LENGTH)                    20480071
204810*               RESP      (PV-CICS-RESP)                          20481071
204820*        END-EXEC                                                 20482071
204830*    END-IF.                                                      20483071
204840                                                                  20484071
204850                                                                  20485071
204860     IF  PS-NO-ERROR                                              20486071
204870         PERFORM 4700-BLD-HDR-REC                                 20487071
204880     END-IF.                                                      20488071
204890                                                                  20489071
204900     MOVE  PV-CARTON-COUNT-X  TO  PV-P2L-LABEL-CNT.               20490071
204910     MOVE  PV-P2L-LABEL-CNT   TO  LQW-P2L-LBL-CNT(LQW-IDX).       20491071
204920     MOVE  ZEROES             TO  LQW-SHP-LBL-CNT(LQW-IDX)        20492071
204930                                  LQW-SML-INPK-LBL-CNT(LQW-IDX)   20493071
204940                                  LQW-SML-FCSE-LBL-CNT(LQW-IDX)   20494071
204950                                  PV-P2L-UNIT-CNT                 20495071
204960                                  PV-SML-FCSE-LBL-CNT             20496071
204970                                  PV-SML-INPK-LBL-CNT.            20497071
204980                                                                  20498071
204990     MOVE LQW-PREPK-ID(LQW-IDX) TO DK-PREPK-ID                    20499071
205000                                                                  20500071
205010     IF  PS-NO-ERROR                                              20501071
205020         PERFORM 4710-WRITE-TRANS-HDR-REC                         20502071
205030     END-IF.                                                      20503071
205040*                                                                 20504071
205050*    IF  PS-NO-ERROR  AND                                         20505071
205060*        PS-DISPLAY-CSSL-YES                                      20506071
205070*        INITIALIZE      PV-CICS-MSG-AREA2                        20507071
205080*        MOVE DP020-SRC-TASK-NUMBER      TO  PV-DISPLAY-TASK-NBR  20508071
205090*        MOVE ASC-PO-NBR             TO  PV-DISPLAY-PO-NBR        20509071
205100*        MOVE ASC-REC-SEQ-NBR        TO  PV-DISPLAY-RCVR-SEQ-NBR  20510071
205110*        MOVE DP020-LOCATION-NBR     TO  PV-DISPLAY-OPER          20511071
205120*        STRING      ' PCKCS701-'                                 20512071
205130*                PV-DISPLAY-OPER                                  20513071
205140*                ' TERM-'                                         20514071
205150*                DP020-TERM-ID                                    20515071
205160*                ' USER-'                                         20516071
205170*                DP020-USERID                                     20517071
205180*                ' TASK-'                                         20518071
205190*                PV-DISPLAY-TASK-NBR                              20519071
205200*                ' PO-'                                           20520071
205210*                PV-DISPLAY-PO-NBR                                20521071
205220*                '-'                                              20522071
205230*                PV-DISPLAY-RCVR-SEQ-NBR                          20523071
205240*                ' BEF BLD DTL-4740 '      DELIMITED BY SIZE      20524071
205250*                                     INTO PV-CICS-MSG-AREA2      20525071
205260*        MOVE LENGTH OF PV-CICS-MSG-AREA2                         20526071
205270*          TO PV-COMMAREA-LENGTH                                  20527071
205280*        EXEC CICS                                                20528071
205290*             WRITEQ TD                                           20529071
205300*              QUEUE      ('CSSL')                                20530071
205310*               FROM      (PV-CICS-MSG-AREA2)                     20531071
205320*             LENGTH      (PV-COMMAREA-LENGTH)                    20532071
205330*               RESP      (PV-CICS-RESP)                          20533071
205340*        END-EXEC                                                 20534071
205350*    END-IF.                                                      20535071
205360                                                                  20536071
205370     IF  PS-NO-ERROR                                              20537071
205380         PERFORM 4740-BLD-DTL-REC                                 20538071
205390     END-IF.                                                      20539071
205400*                                                                 20540071
205410*    IF  PS-NO-ERROR  AND                                         20541071
205420*        PS-DISPLAY-CSSL-YES                                      20542071
205430*        INITIALIZE      PV-CICS-MSG-AREA2                        20543071
205440*        MOVE DP020-SRC-TASK-NUMBER      TO  PV-DISPLAY-TASK-NBR  20544071
205450*        MOVE ASC-PO-NBR             TO  PV-DISPLAY-PO-NBR        20545071
205460*        MOVE ASC-REC-SEQ-NBR        TO  PV-DISPLAY-RCVR-SEQ-NBR  20546071
205470*        MOVE DP020-LOCATION-NBR     TO  PV-DISPLAY-OPER          20547071
205480*        STRING      ' PCKCS701-'                                 20548071
205490*                PV-DISPLAY-OPER                                  20549071
205500*                ' TERM-'                                         20550071
205510*                DP020-TERM-ID                                    20551071
205520*                ' USER-'                                         20552071
205530*                DP020-USERID                                     20553071
205540*                ' TASK-'                                         20554071
205550*                PV-DISPLAY-TASK-NBR                              20555071
205560*                ' PO-'                                           20556071
205570*                PV-DISPLAY-PO-NBR                                20557071
205580*                '-'                                              20558071
205590*                PV-DISPLAY-RCVR-SEQ-NBR                          20559071
205600*                ' BEF BLD TLR-4770 '      DELIMITED BY SIZE      20560071
205610*                                     INTO PV-CICS-MSG-AREA2      20561071
205620*        MOVE LENGTH OF PV-CICS-MSG-AREA2                         20562071
205630*          TO PV-COMMAREA-LENGTH                                  20563071
205640*        EXEC CICS                                                20564071
205650*             WRITEQ TD                                           20565071
205660*              QUEUE      ('CSSL')                                20566071
205670*               FROM      (PV-CICS-MSG-AREA2)                     20567071
205680*             LENGTH      (PV-COMMAREA-LENGTH)                    20568071
205690*               RESP      (PV-CICS-RESP)                          20569071
205700*        END-EXEC                                                 20570071
205710*    END-IF.                                                      20571071
205720                                                                  20572071
205730     IF  PS-NO-ERROR                                              20573071
205740         PERFORM 4770-BLD-TLR-REC                                 20574071
205750     END-IF.                                                      20575071
205760                                                                  20576071
205770     IF  PS-NO-ERROR                                              20577071
205780         IF  ASC-TBL-INPK-QTY (ASC-BLK-SUB ASC-ITEM-SUB)  =       20578071
205790             PV-INNER-PACK-QTY                                    20579071
205800             CONTINUE                                             20580071
205810         ELSE                                                     20581071
205820             PERFORM 4775-UPDATE-INNR-PACK                        20582071
205830         END-IF                                                   20583071
205840     END-IF.                                                      20584071
205850                                                                  20585071
205860     IF  PS-NO-ERROR                                              20586071
205870         SET PC-LINE-DOWNLOADED-TO-QNX TO TRUE                    20587071
205880     END-IF.                                                      20588071
205890                                                                  20589071
205900     IF  PS-NO-ERROR                                              20590071
205910         PERFORM 4785-BUILD-RECEIPT-RECS                          20591071
205920     END-IF.                                                      20592071
205930                                                                  20593071
205940     IF  PS-NO-SOFT-ABORT-ERROR                                   20594071
205950         PERFORM 4715-UPDATE-HEADER                               20595071
205960     END-IF.                                                      20596071
205970                                                                  20597071
205980     IF  PS-NO-SOFT-ABORT-ERROR                                   20598071
205990         IF  ASC-PRE-PACK-ORDER                                   20599071
206000              SET  PS-PREPK-LINES-LEFT TO TRUE                    20600071
206010              PERFORM 8000-PREPK-DISTRO                           20601071
206020              SET  PS-NO-PREPK-LINES-LEFT TO TRUE                 20602071
206030         END-IF                                                   20603071
206040     END-IF.                                                      20604071
206050                                                                  20605071
206060                                                                  20606071
206070*----------------------------------------------------------------*20607071
206080*  CREATE LABEL REQUEST - CASEPACK ONLY (SML)                    *20608071
206090*----------------------------------------------------------------*20609071
206100 4665-CREATE-SML-ONLY.                                            20610071
206110     MOVE PC-N                    TO  DISTDT-ODD-CART-IND.        20611071
206120                                                                  20612071
206130     MOVE PV-PO-NBR               TO  DK-PO-NBR.                  20613071
206140     MOVE PV-REC-SEQ-NBR          TO  DK-REC-SEQ-NBR.             20614071
206150     MOVE PV-PO-LINE-NBR          TO  DK-LINE-NBR.                20615071
206160                                                                  20616071
206170     MOVE LQW-PREPK-ID(LQW-IDX) TO DK-PREPK-ID                    20617071
206180                                                                  20618071
206190     PERFORM 4710-WRITE-TRANS-HDR-REC.                            20619071
206200                                                                  20620071
206210     MOVE  ZEROES  TO  PV-P2L-UNIT-CNT                            20621071
206220                       PV-FULL-CASE-SHIP-TOTAL                    20622071
206230                       PV-INPK-SHIP-LNE-TOTAL                     20623071
206240                       PV-ODD-CARTON-INPK-TOTAL.                  20624071
206250                                                                  20625071
206260     PERFORM 4745-OPEN-RECDIS-CURSOR.                             20626071
206270     IF  PS-NO-SOFT-ABORT-ERROR                                   20627071
206280         PERFORM 4750-FETCH-RECDIS-CURSOR                         20628071
206290     END-IF.                                                      20629071
206300                                                                  20630071
206310     MOVE ZEROES  TO  PV-ODD-CARTON-INPK-TOTAL                    20631071
206320                      PV-ODD-CARTON-INPK-USED.                    20632071
206330                                                                  20633071
206340     IF  PS-NO-SOFT-ABORT-ERROR                                   20634071
206350         SET  LQW-FCSE-ODD-CRTN-NOT-USED (LQW-IDX)                20635071
206360              LQW-ODD-CRTN-NONE (LQW-IDX)                         20636071
206370              PS-USE-ODD-CARTON-NONE                              20637071
206380              PS-ODD-CARTON-INPK-NOT-USED                         20638071
206390              PS-FULLCASES-ALL-NOT-USED  TO  TRUE                 20639071
206400         PERFORM                                                  20640071
206410             UNTIL SQLCODE = +100                                 20641071
206420                OR PS-SOFT-ABORT-ERROR                            20642071
206430                                                                  20643071
206440             INITIALIZE DISTDT-P2L-SPLT-UNT-QTY                   20644071
206450                        DISTDT-FCSE-SPLT-UNT-QTY                  20645071
206460                        DISTDT-INPK-SPLT-UNT-QTY                  20646071
206470                        DISTDT-FCSE-ACTL-UNT-QTY                  20647071
206480                                                                  20648071
206490*                                                                 20649071
206500* IF ODD-CARTON > = OUTER PACK                                    20650071
206510*    DETERMINE THE NUMBER OF FULL CASE WITHIN ODD & REMAINDER     20651071
206520*  EX:  OUTER PACK = 12                                           20652071
206530*       ODD CARTON = 27                                           20653071
206540*       ODD FULL CASE = 2  ODD REMAINDER = 3                      20654071
206550*                                                                 20655071
206560                                                                  20656071
206570             MOVE ZEROES  TO  PV-FCSE-INPK-REMAINDER              20657071
206580                              PV-ODD-FULLCASE                     20658071
206590                              PV-ODD-REMAINDER                    20659071
206600                              PV-ODD-CARTON-INPK-TOTAL            20660071
206610                                                                  20661071
206620             IF LQW-ODD-CARTON (LQW-IDX) > 0 AND                  20662071
206630                 LQW-OUTER-PACK (LQW-IDX) > 0                     20663071
206640                 DIVIDE LQW-ODD-CARTON (LQW-IDX)                  20664071
206650                     BY LQW-OUTER-PACK (LQW-IDX)                  20665071
206660                 GIVING PV-ODD-FULLCASE                           20666071
206670                        REMAINDER PV-ODD-REMAINDER                20667071
206680             END-IF                                               20668071
206690                                                                  20669071
206700*  IF ODD-CARTON AND INNER-PACK CONVEYABLE DETERMINE IF CARTON    20670071
206710*  WILL BE USED AS FULLCASE OF BY INNERPACK                       20671071
206720                                                                  20672071
206730             IF LQW-ODD-CARTON (LQW-IDX) > 0                      20673071
206740                 MOVE LQW-ODD-CARTON (LQW-IDX)                    20674071
206750                   TO PV-ODD-CARTON-UNT-QTY                       20675071
206760                 MOVE LQW-OUTER-PACK (LQW-IDX)                    20676071
206770                   TO PV-OUTER-PACK-QTY                           20677071
206780                 MOVE LQW-INNER-PACK (LQW-IDX)                    20678071
206790                   TO PV-INNER-PACK-QTY                           20679071
206800                 PERFORM 4860-ODD-CARTON-INPK-FCSE                20680071
206810             END-IF                                               20681071
206820                                                                  20682071
206830*  IF ODD-CARTON, INNER-PACK CONVEYABLE INNER PACKS TO BE USED    20683071
206840*  DETERMINE NUMBER OF INNER-PACKS IN ODD-CARTON.                 20684071
206850                                                                  20685071
206860             IF LQW-ODD-CARTON (LQW-IDX) > 0 AND                  20686071
206870                 LQW-IN-PAK-CONVEY-YES (LQW-IDX) AND              20687071
206880                 PS-USE-ODD-CARTON-INPK                           20688071
206890                 DIVIDE PV-ODD-CARTON-UNT-QTY                     20689071
206900                     BY PV-INNER-PACK-QTY                         20690071
206910                 GIVING PV-ODD-CARTON-INPK-TOTAL                  20691071
206920             END-IF                                               20692071
206930                                                                  20693071
206940             PERFORM 4667-SML-LBL-BREAKDOWN                       20694071
206950                                                                  20695071
206960             MOVE PV-STR-FCSE-UNT-QTY TO DISTDT-FCSE-SPLT-UNT-QTY 20696071
206970             MOVE PV-STR-INPK-UNT-QTY TO DISTDT-INPK-SPLT-UNT-QTY 20697071
206980                                                                  20698071
206990             SET  PS-DISTDT-INVALID-INSERT  TO  TRUE              20699071
207000             PERFORM 4765-INSERT-TRANS-DTL-REC                    20700071
207010               UNTIL  PS-DISTDT-VALID-INSERT  OR                  20701071
207020                      PS-ERROR        OR                          20702071
207030                      PS-SOFT-ABORT-ERROR                         20703071
207040             IF  PS-NO-SOFT-ABORT-ERROR                           20704071
207050                 IF  ASC-PRE-PACK-ORDER                           20705071
207060                     SET  PS-PREPK-LINES-LEFT TO TRUE             20706071
207070                     PERFORM 8105-QTY-RATIOS                      20707071
207080                     PERFORM 8100-PREPK-DISTRO                    20708071
207090                       UNTIL PS-NO-PREPK-LINES-LEFT               20709071
207100                          OR PS-SOFT-ABORT-ERROR                  20710071
207110                     SET  PS-PREPK-LINES-LEFT TO TRUE             20711071
207120                END-IF                                            20712071
207130             END-IF                                               20713071
207140             IF  PS-NO-SOFT-ABORT-ERROR                           20714071
207150                 PERFORM 4750-FETCH-RECDIS-CURSOR                 20715071
207160             END-IF                                               20716071
207170         END-PERFORM                                              20717071
207180     END-IF.                                                      20718071
207190                                                                  20719071
207200     IF  PS-NO-SOFT-ABORT-ERROR                                   20720071
207210         PERFORM 4760-CLOSE-RECDIS-CURSOR                         20721071
207220     END-IF.                                                      20722071
207230     MOVE  LQW-MODULE (LQW-IDX)                                   20723071
207240       TO  PV-MODU-NBR-HOLD.                                      20724071
207250                                                                  20725071
207260     MOVE  ZEROES                                                 20726071
207270       TO  LQW-P2L-LBL-CNT(LQW-IDX)                               20727071
207280           PV-P2L-LABEL-CNT.                                      20728071
207290     MOVE  PV-FULL-CASE-SHIP-TOTAL                                20729071
207300       TO  LQW-SML-FCSE-LBL-CNT(LQW-IDX)                          20730071
207310           PV-SML-FCSE-LBL-CNT.                                   20731071
207320     MOVE  PV-INPK-SHIP-LNE-TOTAL                                 20732071
207330       TO  LQW-SML-INPK-LBL-CNT(LQW-IDX)                          20733071
207340           PV-SML-INPK-LBL-CNT.                                   20734071
207350     ADD PV-FULL-CASE-SHIP-TOTAL  PV-INPK-SHIP-LNE-TOTAL          20735071
207360         GIVING LQW-SHP-LBL-CNT(LQW-IDX).                         20736071
207370                                                                  20737071
207380     SET  PS-DONT-SUBMIT-E200  TO  TRUE.                          20738071
207390                                                                  20739071
207400     IF  PS-NO-SOFT-ABORT-ERROR                                   20740071
207410         PERFORM 4715-UPDATE-HEADER                               20741071
207420     END-IF.                                                      20742071
207430                                                                  20743071
207440     IF  PS-NO-SOFT-ABORT-ERROR                                   20744071
207450         IF  ASC-PRE-PACK-ORDER                                   20745071
207460              SET  PS-PREPK-LINES-LEFT TO TRUE                    20746071
207470              PERFORM 8000-PREPK-DISTRO                           20747071
207480              SET  PS-NO-PREPK-LINES-LEFT TO TRUE                 20748071
207490         END-IF                                                   20749071
207500     END-IF.                                                      20750071
207510                                                                  20751071
207520                                                                  20752071
207530*-----------------------------------------------------------------20753071
207540*-----------------------------------------------------------------20754071
207550 4667-SML-LBL-BREAKDOWN.                                          20755071
207560     MOVE PC-N     TO DISTDT-ODD-CART-IND                         20756071
207570     MOVE  ZEROES  TO  PV-STR-P2L-UNT-QTY                         20757071
207580                       PV-STR-FCSE-UNT-QTY                        20758071
207590                       PV-STR-INPK-UNT-QTY                        20759071
207600                       PV-STR-ACTL-UNT-QTY                        20760071
207610                                                                  20761071
207620     IF  LQW-ODD-CARTON (LQW-IDX) > 0                             20762071
207630         SUBTRACT  1                                              20763071
207640             FROM  LQW-CARTON-CNT (LQW-IDX)                       20764071
207650           GIVING  PV-CARTON-COUNT-LESS-ODD                       20765071
207660     ELSE                                                         20766071
207670          MOVE ZEROES                                             20767071
207680            TO PV-CARTON-COUNT-LESS-ODD                           20768071
207690     END-IF.                                                      20769071
207700                                                                  20770071
207710     IF  LQW-ODD-CARTON (LQW-IDX) > 0  AND                        20771071
207720         LQW-FCSE-ODD-CRTN-NOT-USED (LQW-IDX)  AND                20772071
207730         PV-FULL-CASE-SHIP-TOTAL >= PV-CARTON-COUNT-LESS-ODD      20773071
207740             SET PS-FULLCASES-ALL-USED  TO  TRUE                  20774071
207750     END-IF.                                                      20775071
207760                                                                  20776071
207770*                                                                 20777071
207780* DETERMINE IF ALLOCATION CAN BE FILLED BY FULLCASE.              20778071
207790*                                                                 20779071
207800     IF  PS-FULLCASES-ALL-NOT-USED  AND                           20780071
207810         LQW-OUTER-PACK (LQW-IDX) > 0                             20781071
207820         DIVIDE  RECDIS-EXPTED-ITM-QTY                            20782071
207830             BY  LQW-OUTER-PACK (LQW-IDX)                         20783071
207840         GIVING  PV-QUOTIENT                                      20784071
207850                 REMAINDER PV-EXPT-REMAINDER                      20785071
207860         END-DIVIDE                                               20786071
207870     ELSE                                                         20787071
207880         MOVE  ZEROES  TO  PV-QUOTIENT                            20788071
207890         MOVE  RECDIS-EXPTED-ITM-QTY  TO  PV-EXPT-REMAINDER       20789071
207900     END-IF.                                                      20790071
207910                                                                  20791071
207920     IF  PV-QUOTIENT  >=  PV-ODD-FULLCASE  AND                    20792071
207930         LQW-ODD-CARTON (LQW-IDX) > 0  AND                        20793071
207940         PV-EXPT-REMAINDER  =  PV-ODD-REMAINDER  AND              20794071
207950         LQW-FCSE-ODD-CRTN-NOT-USED (LQW-IDX)                     20795071
207960                                                                  20796071
207970         SUBTRACT  PV-ODD-FULLCASE                                20797071
207980             FROM  PV-QUOTIENT                                    20798071
207990           GIVING  PV-QUOTIENT                                    20799071
208000                                                                  20800071
208010         MULTIPLY  PV-QUOTIENT                                    20801071
208020               BY  LQW-OUTER-PACK (LQW-IDX)                       20802071
208030           GIVING  PV-STR-FCSE-UNT-QTY                            20803071
208040                                                                  20804071
208050         ADD 1  TO  PV-QUOTIENT                                   20805071
208060         ADD  LQW-ODD-CARTON (LQW-IDX)                            20806071
208070          TO  PV-STR-FCSE-UNT-QTY                                 20807071
208080         ADD  PV-QUOTIENT  TO  PV-SHIP-LNE-TOTAL                  20808071
208090                               PV-FULL-CASE-SHIP-TOTAL            20809071
208100         MOVE  ZEROES  TO  PV-EXPT-REMAINDER                      20810071
208110         SET  PS-USE-ODD-CARTON-FCSE                              20811071
208120              LQW-FCSE-ODD-CRTN-USED (LQW-IDX)                    20812071
208130              LQW-ODD-CRTN-FCSE (LQW-IDX)      TO TRUE            20813071
208140         MOVE PC-F  TO  DISTDT-ODD-CART-IND                       20814071
208150                                                                  20815071
208160                                                                  20816071
208170     ELSE                                                         20817071
208180                                                                  20818071
208190     IF  PV-QUOTIENT  =  ZEROES                                   20819071
208200         MOVE  RECDIS-EXPTED-ITM-QTY  TO  PV-EXPT-REMAINDER       20820071
208210     ELSE                                                         20821071
208220         ADD   PV-QUOTIENT  TO  PV-SHIP-LNE-TOTAL                 20822071
208230                                PV-FULL-CASE-SHIP-TOTAL           20823071
208240         MULTIPLY  PV-QUOTIENT                                    20824071
208250               BY  LQW-OUTER-PACK (LQW-IDX)                       20825071
208260           GIVING  PV-STR-FCSE-UNT-QTY                            20826071
208270     END-IF.                                                      20827071
208280                                                                  20828071
208290* IF ALLOCATION IS NOT FILLED BY FULL CASE.   CHECK TO SEE IF     20829071
208300* CAN BE FILLED WITH FULL ODD CARTON                              20830071
208310                                                                  20831071
208320     IF  PV-EXPT-REMAINDER  >  ZEROES  AND                        20832071
208330         LQW-ODD-CARTON (LQW-IDX) > ZEROES  AND                   20833071
208340         LQW-FCSE-ODD-CRTN-NOT-USED (LQW-IDX)                     20834071
208350             IF  PV-EXPT-REMAINDER  =                             20835071
208360                 LQW-ODD-CARTON (LQW-IDX)                         20836071
208370                     ADD  1  TO  PV-SHIP-LNE-TOTAL                20837071
208380                                 PV-FULL-CASE-SHIP-TOTAL          20838071
208390                     ADD  PV-EXPT-REMAINDER                       20839071
208400                             TO  PV-STR-FCSE-UNT-QTY              20840071
208410                     SET  LQW-FCSE-ODD-CRTN-USED (LQW-IDX)        20841071
208420                          LQW-ODD-CRTN-FCSE (LQW-IDX)  TO TRUE    20842071
208430                     MOVE PC-F TO DISTDT-ODD-CART-IND             20843071
208440                     MOVE  ZEROES  TO  PV-EXPT-REMAINDER          20844071
208450             END-IF                                               20845071
208460     END-IF.                                                      20846071
208470                                                                  20847071
208480* IF ALLOCATION IS NOT FILLED BY FULL CASE/ODD CARTON. CHECK TO   20848071
208490* SEE IF CAN BE FILLED WITH CONVEYABLE INNER-PACKS                20849071
208500                                                                  20850071
208510     IF  PV-EXPT-REMAINDER  >  ZEROES                             20851071
208520         IF  LQW-IN-PACK-CONVY (LQW-IDX) = 'Y'                    20852071
208530             IF  LQW-INNER-PACK (LQW-IDX) >  0                    20853071
208540                 DIVIDE  PV-EXPT-REMAINDER                        20854071
208550                     BY  LQW-INNER-PACK (LQW-IDX)                 20855071
208560                 GIVING  PV-INPK-QUOTIENT                         20856071
208570                         REMAINDER  PV-INPK-REMAINDER             20857071
208580                 END-DIVIDE                                       20858071
208590                 IF  PV-INPK-QUOTIENT  >  0  AND                  20859071
208600                     PS-USE-ODD-CARTON-INPK  AND                  20860071
208610                     PS-ODD-CARTON-INPK-NOT-USED                  20861071
208620                     MOVE  PC-I  TO  DISTDT-ODD-CART-IND          20862071
208630                     SET  LQW-ODD-CRTN-INPK (LQW-IDX) TO TRUE     20863071
208640                     ADD  PV-INPK-QUOTIENT                        20864071
208650                      TO  PV-ODD-CARTON-INPK-USED                 20865071
208660                     IF  PV-ODD-CARTON-INPK-USED >=               20866071
208670                         PV-ODD-CARTON-INPK-TOTAL                 20867071
208680                         SET  PS-ODD-CARTON-INPK-COMPLETE         20868071
208690                              LQW-FCSE-ODD-CRTN-USED (LQW-IDX)    20869071
208700                              TO  TRUE                            20870071
208710                     END-IF                                       20871071
208720                 END-IF                                           20872071
208730             ELSE                                                 20873071
208740                 MOVE  ZEROES  TO  PV-INPK-QUOTIENT               20874071
208750                 MOVE  PV-EXPT-REMAINDER  TO  PV-INPK-REMAINDER   20875071
208760             END-IF                                               20876071
208770             ADD  PV-INPK-QUOTIENT   TO  PV-SHIP-LNE-TOTAL        20877071
208780                                         PV-INPK-SHIP-LNE-TOTAL   20878071
208790             MULTIPLY  PV-INPK-QUOTIENT                           20879071
208800                   BY  LQW-INNER-PACK (LQW-IDX)                   20880071
208810               GIVING  PV-STR-INPK-UNT-QTY                        20881071
208820                                                                  20882071
208830             ADD  PV-INPK-REMAINDER  TO  PV-FCSE-INPK-REMAINDER   20883071
208840         ELSE                                                     20884071
208850             ADD  PV-EXPT-REMAINDER  TO  PV-FCSE-INPK-REMAINDER   20885071
208860         END-IF                                                   20886071
208870     END-IF.                                                      20887071
208880                                                                  20888071
208890* IF ALLOCATION IS NOT FILLED BY FULL CASE/ODD CARTON/INNER PACK  20889071
208900* CHECK TO SEE IF CAN BE FILLED WITH FULL ODD-CARTON              20890071
208910                                                                  20891071
208920     IF  PV-FCSE-INPK-REMAINDER  >  ZEROES  AND                   20892071
208930         LQW-ODD-CARTON (LQW-IDX) > ZEROES  AND                   20893071
208940         LQW-FCSE-ODD-CRTN-NOT-USED (LQW-IDX)                     20894071
208950             IF  PV-FCSE-INPK-REMAINDER  =                        20895071
208960                 LQW-ODD-CARTON (LQW-IDX)                         20896071
208970                     ADD  1  TO  PV-SHIP-LNE-TOTAL                20897071
208980                                 PV-FULL-CASE-SHIP-TOTAL          20898071
208990                     ADD  PV-FCSE-INPK-REMAINDER                  20899071
209000                             TO  PV-STR-FCSE-UNT-QTY              20900071
209010                     SET  LQW-FCSE-ODD-CRTN-USED (LQW-IDX)        20901071
209020                          LQW-ODD-CRTN-FCSE (LQW-IDX) TO TRUE     20902071
209030                     MOVE PC-F TO DISTDT-ODD-CART-IND             20903071
209040             ELSE                                                 20904071
209050                 ADD  PV-FCSE-INPK-REMAINDER                      20905071
209060                  TO  PV-TOT-REMAINDER                            20906071
209070             END-IF                                               20907071
209080     ELSE                                                         20908071
209090         ADD  PV-FCSE-INPK-REMAINDER  TO  PV-TOT-REMAINDER        20909071
209100     END-IF.                                                      20910071
209110                                                                  20911071
209120                                                                  20912071
209130*----------------------------------------------------------------*20913071
209140*----------------------------------------------------------------*20914071
209150 4670-CREATE-P2L-SML.                                             20915071
209160                                                                  20916071
209170*===TKMA408=== THIS IS IN JUST FOR TESTING                        20917071
209180     IF   PS-DISPLAY-CSSL-YES                                     20918071
209190          move spaces to   PV-CICS-MSG-AREA2                      20919071
209200          STRING ' PCKCS701-4670-CREATE-P2L-SML'                  20920071
209210                                           DELIMITED BY SIZE      20921071
209220                                      INTO PV-CICS-MSG-AREA2      20922071
209230        MOVE LENGTH OF PV-CICS-MSG-AREA2                          20923071
209231                                      TO PV-COMMAREA-LENGTH       20923171
209232        EXEC CICS                                                 20923271
209233            WRITEQ TD                                             20923371
209234                QUEUE   ('CSSL')                                  20923471
209235                FROM    (PV-CICS-MSG-AREA2)                       20923571
209236                LENGTH  (PV-COMMAREA-LENGTH)                      20923671
209237                RESP    (PV-CICS-RESP)                            20923771
209238        END-EXEC                                                  20923871
209239     END-IF                                                       20923971
209240*===TKMA408=== THIS IS IN JUST FOR TESTING                        20924071
209241                                                                  20924171
209242     MOVE PC-N  TO  DISTDT-ODD-CART-IND.                          20924271
209243                                                                  20924371
209244     INITIALIZE  PV-P2L-UNIT-CNT                                  20924471
209245                 PV-SML-FCSE-LBL-CNT                              20924571
209246                 PV-SML-INPK-LBL-CNT.                             20924671
209247                                                                  20924771
209248     MOVE LQW-PREPK-ID(LQW-IDX) TO DK-PREPK-ID                    20924871
209249                                                                  20924971
209250     PERFORM 4710-WRITE-TRANS-HDR-REC.                            20925071
209260                                                                  20926071
209270     SET  PS-CENTRAL-STOCK-NO                                     20927071
209280          PS-EOF-RECDIS-STR-CURSR-NO                              20928071
209290          PS-USE-ODD-CARTON-NONE     TO TRUE.                     20929071
209300                                                                  20930071
209310     PERFORM 4685-OPEN-RECDIS-STR-CURSR.                          20931071
209320                                                                  20932071
209330*===TKMA408=== THIS IS IN JUST FOR TESTING                        20933071
209340     IF   PS-DISPLAY-CSSL-YES                                     20934071
209350          move spaces to   PV-CICS-MSG-AREA2                      20935071
209360          STRING ' PCKCS701-4670-CREATE-P2L-SML-AFTER OPEN'       20936071
209370                                           DELIMITED BY SIZE      20937071
209380                                      INTO PV-CICS-MSG-AREA2      20938071
209390        MOVE LENGTH OF PV-CICS-MSG-AREA2                          20939071
209391                                      TO PV-COMMAREA-LENGTH       20939171
209392        EXEC CICS                                                 20939271
209393            WRITEQ TD                                             20939371
209394                QUEUE   ('CSSL')                                  20939471
209395                FROM    (PV-CICS-MSG-AREA2)                       20939571
209396                LENGTH  (PV-COMMAREA-LENGTH)                      20939671
209397                RESP    (PV-CICS-RESP)                            20939771
209398        END-EXEC                                                  20939871
209399     END-IF                                                       20939971
209400*===TKMA408=== THIS IS IN JUST FOR TESTING                        20940071
209401                                                                  20940171
209402     IF  PS-NO-SOFT-ABORT-ERROR                                   20940271
209403         PERFORM 4690-FETCH-RECDIS-STR-CURSR                      20940371
209404     END-IF.                                                      20940471
209405                                                                  20940571
209406     MOVE  ZEROES  TO  PV-CS-BOUND-UNTS                           20940671
209407                       PV-CS-BOUND-CTNS.                          20940771
209408                                                                  20940871
209409     IF  PS-NO-SOFT-ABORT-ERROR                                   20940971
209410         IF  XLT00010-LOC-TYP-CDE = 'CS'                          20941071
209420             SET PS-CENTRAL-STOCK-YES  TO  TRUE                   20942071
209430             PERFORM 4675-SML-CENTRAL-STK                         20943071
209440               UNTIL PS-CENTRAL-STOCK-NO                          20944071
209450                  OR PS-EOF-RECDIS-STR-CURSR-YES                  20945071
209460                  OR PS-SOFT-ABORT-ERROR                          20946071
209470                                                                  20947071
209480             IF PS-EOF-RECDIS-STR-CURSR-YES                       20948071
209490                 ADD PV-CS-BOUND-CTNS                             20949071
209500                  TO PV-SML-FCSE-LBL-CNT                          20950071
209510                 PERFORM 4715-UPDATE-HEADER                       20951071
209520                                                                  20952071
209530                 IF  PS-NO-SOFT-ABORT-ERROR                       20953071
209540                     IF  ASC-PRE-PACK-ORDER                       20954071
209550                         SET  PS-PREPK-LINES-LEFT TO TRUE         20955071
209560                         PERFORM 8000-PREPK-DISTRO                20956071
209570                         SET  PS-NO-PREPK-LINES-LEFT TO TRUE      20957071
209580                     END-IF                                       20958071
209590                 END-IF                                           20959071
209600             END-IF                                               20960071
209610                                                                  20961071
209620         ELSE                                                     20962071
209630             SET PS-CENTRAL-STOCK-NO   TO  TRUE                   20963071
209640         END-IF                                                   20964071
209650     END-IF.                                                      20965071
209660                                                                  20966071
209670     MOVE PV-CS-BOUND-UNTS TO LQW-CS-BOUND-UNTS (LQW-IDX).        20967071
209680     MOVE PV-CS-BOUND-CTNS TO LQW-CS-BOUND-CTNS (LQW-IDX).        20968071
209690                                                                  20969071
209700                                                                  20970071
209710     IF  PS-EOF-RECDIS-STR-CURSR-YES  OR                          20971071
209720         PS-SOFT-ABORT-ERROR                                      20972071
209730         CONTINUE                                                 20973071
209740     ELSE                                                         20974071
209750     IF  PS-CENTRAL-STOCK-NO                                      20975071
209760         IF  ASC-P2L-AL-DOWNLOAD-NO  AND                          20976071
209770             ASC-P2L-PCC-DOWNLOAD-NO                              20977071
209780             CONTINUE                                             20978071
209790         ELSE                                                     20979071
209800             IF  PS-SOCKET-INITIALIZED-NO                         20980071
209810                                                                  20981071
209820                 AND   LQW-P2L-LBL-CNT (LQW-IDX)  >  0            20982071
209830                                                                  20983071
209840                 IF  PS-NO-ERROR                                  20984071
209850                     PERFORM 4645-CALL-SOCKET                     20985071
209860                 END-IF                                           20986071
209870                 IF  PS-NO-ERROR                                  20987071
209880                     PERFORM 4650-CONNECT-SOCKET                  20988071
209890                 END-IF                                           20989071
209900                 IF  PS-NO-ERROR                                  20990071
210000                     SET PS-SOCKET-INITIALIZED-YES  TO  TRUE      21000071
210010                 END-IF                                           21001071
210020             END-IF                                               21002071
210030         END-IF                                                   21003071
210040                                                                  21004071
210050         IF  PS-NO-ERROR                                          21005071
210060                                                                  21006071
210070                 AND   LQW-P2L-LBL-CNT (LQW-IDX)  >  0            21007071
210080                                                                  21008071
210090             PERFORM 4700-BLD-HDR-REC                             21009071
210100         END-IF                                                   21010071
210200                                                                  21020071
210300         IF  PS-USE-ODD-CARTON-NONE                               21030071
210400                                                                  21040071
210500             IF  PS-NO-ERROR                                      21050071
210510                 MOVE ZEROES  TO  PV-STR-RECS-SENT                21051071
210520                                  PV-ODD-CARTON-INPK-TOTAL        21052071
210530                                  PV-ODD-CARTON-INPK-USED         21053071
210540                 SET  LQW-FCSE-ODD-CRTN-NOT-USED (LQW-IDX)        21054071
210550                      LQW-ODD-CRTN-NONE (LQW-IDX)                 21055071
210560                      PS-ODD-CARTON-INPK-NOT-USED      TO  TRUE   21056071
210570*                                                                 21057071
210580* IF ODD-CARTON > = OUTER PACK                                    21058071
210590*    DETERMINE THE NUMBER OF FULL CASE WITHIN ODD & REMAINDER     21059071
210600*  EX:  OUTER PACK = 12                                           21060071
210610*       ODD CARTON = 27                                           21061071
210620*       ODD FULL CASE = 2  ODD REMAINDER = 3                      21062071
210630*                                                                 21063071
210640                 MOVE ZEROES TO PV-ODD-FULLCASE                   21064071
210650                                PV-FCSE-INPK-REMAINDER            21065071
210660                                PV-ODD-REMAINDER                  21066071
210670                                PV-ODD-CARTON-INPK-TOTAL          21067071
210680                                PV-ALLOC-AFTER-ODD-CARTON         21068071
210690                                                                  21069071
210700                 IF  LQW-ODD-CARTON (LQW-IDX) > 0 AND             21070071
210710                     LQW-OUTER-PACK (LQW-IDX) > 0                 21071071
210720                     DIVIDE LQW-ODD-CARTON (LQW-IDX)              21072071
210730                         BY LQW-OUTER-PACK (LQW-IDX)              21073071
210740                     GIVING PV-ODD-FULLCASE                       21074071
210750                            REMAINDER PV-ODD-REMAINDER            21075071
210760                 END-IF                                           21076071
210770                                                                  21077071
210780*  IF ODD-CARTON AND INNER-PACK CONVEYABLE DETERMINE IF CARTON    21078071
210790*  WILL BE USED AS FULLCASE OF BY INNERPACK                       21079071
210800                                                                  21080071
210810                 SET PS-USE-ODD-CARTON-NONE TO TRUE               21081071
210820                 IF  LQW-ODD-CARTON (LQW-IDX) > 0                 21082071
210830                     MOVE LQW-ODD-CARTON (LQW-IDX)                21083071
210840                       TO PV-ODD-CARTON-UNT-QTY                   21084071
210850                     MOVE LQW-OUTER-PACK (LQW-IDX)                21085071
210860                       TO PV-OUTER-PACK-QTY                       21086071
210870                     MOVE LQW-INNER-PACK (LQW-IDX)                21087071
210880                       TO PV-INNER-PACK-QTY                       21088071
210890                     PERFORM 4870-ODD-CARTON-INPK-FCSE            21089071
210900                 END-IF                                           21090071
210910                                                                  21091071
210920*  IF ODD-CARTON, INNER-PACK CONVEYABLE INNER PACKS TO BE USED    21092071
210930*  DETERMINE NUMBER OF INNER-PACKS IN ODD-CARTON.                 21093071
210940                                                                  21094071
210950                 IF LQW-ODD-CARTON (LQW-IDX) > 0 AND              21095071
210960                     LQW-IN-PAK-CONVEY-YES (LQW-IDX) AND          21096071
210970                     PS-USE-ODD-CARTON-INPK                       21097071
210980                     DIVIDE PV-ODD-CARTON-UNT-QTY                 21098071
210990                         BY PV-INNER-PACK-QTY                     21099071
211000                     GIVING PV-ODD-CARTON-INPK-TOTAL              21100071
211010                 END-IF                                           21101071
211020             END-IF                                               21102071
211030         END-IF                                                   21103071
211040                                                                  21104071
211050         IF  PS-NO-ERROR                                          21105071
211060             PERFORM 4680-NOT-CENTRAL-STK                         21106071
211070               UNTIL PS-EOF-RECDIS-STR-CURSR-YES                  21107071
211080                  OR PS-SOFT-ABORT-ERROR                          21108071
211090         END-IF                                                   21109071
211100                                                                  21110071
211110         SET  PS-DONT-SUBMIT-E200  TO  TRUE                       21111071
211120                                                                  21112071
211130         IF  PS-NO-ERROR                                          21113071
211140             ADD  PV-CS-BOUND-CTNS                                21114071
211150              TO  PV-SML-FCSE-LBL-CNT                             21115071
211160                                                                  21116071
211170             PERFORM 4715-UPDATE-HEADER                           21117071
211180             IF  PS-NO-SOFT-ABORT-ERROR                           21118071
211190                 IF  ASC-PRE-PACK-ORDER                           21119071
211200                     SET  PS-PREPK-LINES-LEFT TO TRUE             21120071
211210                     PERFORM 8000-PREPK-DISTRO                    21121071
211220                     SET  PS-NO-PREPK-LINES-LEFT TO TRUE          21122071
211230                 END-IF                                           21123071
211240             END-IF                                               21124071
211250             IF  PS-SOFT-ABORT-ERROR                              21125071
211260                 CONTINUE                                         21126071
211270             ELSE                                                 21127071
211280             IF  LQW-LNE-CRE-BOTH-LBL (LQW-IDX)  AND              21128071
211290                 PV-CARTON-COUNT = ZEROES                         21129071
211300                       CONTINUE                                   21130071
211400             ELSE                                                 21140071
211500                                                                  21150071
211600                 IF  LQW-P2L-LBL-CNT (LQW-IDX)  >  0              21160071
211700                                                                  21170071
211710                     PERFORM 4770-BLD-TLR-REC                     21171071
211720                                                                  21172071
211730                 END-IF                                           21173071
211740             END-IF                                               21174071
211750             END-IF                                               21175071
211760             MOVE PV-P2L-LABEL-CNT TO LQW-P2L-LBL-CNT (LQW-IDX)   21176071
211770             MOVE PV-SML-FCSE-LBL-CNT                             21177071
211780               TO LQW-SML-FCSE-LBL-CNT(LQW-IDX)                   21178071
211790             MOVE PV-SML-INPK-LBL-CNT                             21179071
211800               TO LQW-SML-INPK-LBL-CNT(LQW-IDX)                   21180071
211810         END-IF                                                   21181071
211820                                                                  21182071
211830         IF  PS-NO-ERROR                                          21183071
211840             IF  ASC-TBL-INPK-QTY (ASC-BLK-SUB ASC-ITEM-SUB)  =   21184071
211850                 PV-INNER-PACK-QTY                                21185071
211860                 CONTINUE                                         21186071
211870             ELSE                                                 21187071
211880                 PERFORM 4775-UPDATE-INNR-PACK                    21188071
211890             END-IF                                               21189071
211900         END-IF                                                   21190071
211910                                                                  21191071
211920         IF  PS-NO-ERROR                                          21192071
211930             SET PC-LINE-DOWNLOADED-TO-QNX TO TRUE                21193071
211940         END-IF                                                   21194071
211950                                                                  21195071
211960         IF  PS-NO-ERROR                                          21196071
211970                                                                  21197071
211980                 AND   LQW-P2L-LBL-CNT (LQW-IDX)  >  0            21198071
211990                                                                  21199071
212000             PERFORM 4785-BUILD-RECEIPT-RECS                      21200071
212010         END-IF                                                   21201071
212020     END-IF.                                                      21202071
212030                                                                  21203071
212040                                                                  21204071
212050*----------------------------------------------------------------*21205071
212060*                                                                *21206071
212070*----------------------------------------------------------------*21207071
212080 4675-SML-CENTRAL-STK.                                            21208071
212090                                                                  21209071
212100     INITIALIZE DISTDT-P2L-SPLT-UNT-QTY                           21210071
212110                DISTDT-FCSE-SPLT-UNT-QTY                          21211071
212120                DISTDT-INPK-SPLT-UNT-QTY                          21212071
212130                DISTDT-FCSE-ACTL-UNT-QTY.                         21213071
212140     IF  PV-OUTER-PACK-QTY >  0                                   21214071
212150           DIVIDE  RECDIS-EXPTED-ITM-QTY                          21215071
212160               BY  PV-OUTER-PACK-QTY                              21216071
212170           GIVING  PV-FULLCASE-CENTRAL-STK                        21217071
212180                   REMAINDER PV-FULLCASE-REMAINDER                21218071
212190     ELSE                                                         21219071
212200         MOVE  ZEROES  TO  PV-FULLCASE-CENTRAL-STK                21220071
212210         MOVE  RECDIS-EXPTED-ITM-QTY  TO  PV-FULLCASE-REMAINDER   21221071
212220     END-IF.                                                      21222071
212230                                                                  21223071
212240     IF  PV-IN-PAK-CONVEY = 'Y'                                   21224071
212250         IF  PV-INNER-PACK-QTY > 0                                21225071
212260             DIVIDE  PV-FULLCASE-REMAINDER                        21226071
212270                 BY  PV-INNER-PACK-QTY                            21227071
212280             GIVING  PV-INPK-NOT-CENTRAL-STK                      21228071
212290                     REMAINDER PV-INPK-REMAINDER                  21229071
212300         ELSE                                                     21230071
212400             MOVE  ZEROES  TO  PV-INPK-NOT-CENTRAL-STK            21240071
212410             MOVE  PV-FULLCASE-REMAINDER  TO  PV-INPK-REMAINDER   21241071
212420         END-IF                                                   21242071
212430                                                                  21243071
212440         MULTIPLY  PV-INPK-NOT-CENTRAL-STK                        21244071
212450               BY  PV-INNER-PACK-QTY                              21245071
212460           GIVING  DISTDT-INPK-SPLT-UNT-QTY                       21246071
212470         ADD  PV-INPK-NOT-CENTRAL-STK                             21247071
212480               TO  PV-SML-INPK-LBL-CNT                            21248071
212490         ADD  PV-INPK-REMAINDER                                   21249071
212500               TO   PV-P2L-UNIT-CNT                               21250071
212510     ELSE                                                         21251071
212520         MOVE  PV-FULLCASE-REMAINDER                              21252071
212530               TO   PV-P2L-UNIT-CNT                               21253071
212540     END-IF.                                                      21254071
212550                                                                  21255071
212560     MULTIPLY  PV-FULLCASE-CENTRAL-STK                            21256071
212570           BY  PV-OUTER-PACK-QTY                                  21257071
212580       GIVING  PV-FULLCASE-SPLIT-UNITS.                           21258071
212590                                                                  21259071
212600     MOVE  PV-FULLCASE-SPLIT-UNITS                                21260071
212610       TO  DISTDT-FCSE-SPLT-UNT-QTY.                              21261071
212620                                                                  21262071
212630     ADD   PV-FULLCASE-CENTRAL-STK                                21263071
212640      TO   PV-TOTAL-FULLCASE.                                     21264071
212650                                                                  21265071
212660     ADD   PV-FULLCASE-CENTRAL-STK                                21266071
212670      TO   PV-CS-BOUND-CTNS.                                      21267071
212680                                                                  21268071
212690     ADD   PV-FULLCASE-SPLIT-UNITS                                21269071
212700      TO   PV-CS-BOUND-UNTS.                                      21270071
212710                                                                  21271071
212720     IF  PV-FULLCASE-REMAINDER    >   0  AND                      21272071
212730         LQW-ODD-CARTON (LQW-IDX) >   0  AND                      21273071
212740         PV-FULLCASE-REMAINDER    =  LQW-ODD-CARTON (LQW-IDX)     21274071
212750                                                                  21275071
212760         SUBTRACT  PV-ODD-FULLCASE                                21276071
212770             FROM  PV-FULLCASE-REMAINDER                          21277071
212780           GIVING  PV-FULLCASE-REMAINDER                          21278071
212790                                                                  21279071
212800         ADD 1  TO   PV-TOTAL-FULLCASE                            21280071
212810                     PV-CS-BOUND-CTNS                             21281071
212820                                                                  21282071
212830         ADD  LQW-ODD-CARTON (LQW-IDX)                            21283071
212840          TO  DISTDT-FCSE-SPLT-UNT-QTY                            21284071
212850              PV-FULLCASE-SPLIT-UNITS                             21285071
212860              PV-CS-BOUND-UNTS                                    21286071
212870                                                                  21287071
212880         MOVE  ZEROES  TO  PV-FULLCASE-REMAINDER                  21288071
212890         SET  PS-USE-ODD-CARTON-FCSE                              21289071
212900              LQW-FCSE-ODD-CRTN-USED (LQW-IDX)                    21290071
212910              LQW-ODD-CRTN-FCSE (LQW-IDX)      TO TRUE            21291071
212920         MOVE PC-F TO DISTDT-ODD-CART-IND                         21292071
212930         MOVE ZEROES  TO  PV-P2L-UNIT-CNT                         21293071
212940     ELSE                                                         21294071
212950     IF  PV-FULLCASE-REMAINDER    >   0  AND                      21295071
212960         LQW-ODD-CARTON (LQW-IDX) >   0  AND                      21296071
212970         PV-FULLCASE-REMAINDER    =  PV-ODD-REMAINDER             21297071
212980                                                                  21298071
212990         SUBTRACT  PV-ODD-FULLCASE                                21299071
213000             FROM  PV-FULLCASE-REMAINDER                          21300071
213010           GIVING  PV-FULLCASE-REMAINDER                          21301071
213020                                                                  21302071
213030         SUBTRACT 1  FROM PV-FULLCASE-CENTRAL-STK                 21303071
213040         ADD      1  TO   PV-CS-BOUND-CTNS                        21304071
213050                                                                  21305071
213060         SUBTRACT  LQW-OUTER-PACK (LQW-IDX)                       21306071
213070             FROM  DISTDT-FCSE-SPLT-UNT-QTY                       21307071
213080                   PV-FULLCASE-SPLIT-UNITS                        21308071
213090                                                                  21309071
213100         ADD  LQW-ODD-CARTON (LQW-IDX)                            21310071
213110          TO  DISTDT-FCSE-SPLT-UNT-QTY                            21311071
213120              PV-FULLCASE-SPLIT-UNITS                             21312071
213130              PV-CS-BOUND-UNTS                                    21313071
213140                                                                  21314071
213150         MOVE  ZEROES  TO  PV-FULLCASE-REMAINDER                  21315071
213160         SET  PS-USE-ODD-CARTON-FCSE                              21316071
213170              LQW-FCSE-ODD-CRTN-USED (LQW-IDX)                    21317071
213180              LQW-ODD-CRTN-FCSE (LQW-IDX)      TO TRUE            21318071
213190         MOVE PC-F TO DISTDT-ODD-CART-IND                         21319071
213200         MOVE ZEROES  TO  PV-P2L-UNIT-CNT                         21320071
213210     END-IF                                                       21321071
213220     END-IF.                                                      21322071
213230                                                                  21323071
213240     SET  PS-DISTDT-INVALID-INSERT  TO  TRUE                      21324071
213250     PERFORM 4765-INSERT-TRANS-DTL-REC                            21325071
213260       UNTIL  PS-DISTDT-VALID-INSERT  OR                          21326071
213270              PS-ERROR        OR                                  21327071
213280              PS-SOFT-ABORT-ERROR.                                21328071
213290                                                                  21329071
213300     IF  PS-NO-SOFT-ABORT-ERROR                                   21330071
213310         IF  ASC-PRE-PACK-ORDER                                   21331071
213320             SET  PS-PREPK-LINES-LEFT TO TRUE                     21332071
213330             PERFORM 8105-QTY-RATIOS                              21333071
213340             PERFORM 8100-PREPK-DISTRO                            21334071
213350               UNTIL PS-NO-PREPK-LINES-LEFT                       21335071
213360                  OR PS-SOFT-ABORT-ERROR                          21336071
213370             SET  PS-PREPK-LINES-LEFT TO TRUE                     21337071
213380        END-IF                                                    21338071
213390     END-IF.                                                      21339071
213400                                                                  21340071
213410                                                                  21341071
213420*===TKMA408=== THIS IS IN JUST FOR TESTING                        21342071
213430     IF   PS-DISPLAY-CSSL-YES                                     21343071
213440          move spaces to   PV-CICS-MSG-AREA2                      21344071
213450          STRING ' PCKCS701-4675-SML-CENTRAL-STK'                 21345071
213451                                           DELIMITED BY SIZE      21345171
213452                                      INTO PV-CICS-MSG-AREA2      21345271
213453        MOVE LENGTH OF PV-CICS-MSG-AREA2                          21345371
213454                                      TO PV-COMMAREA-LENGTH       21345471
213455        EXEC CICS                                                 21345571
213456            WRITEQ TD                                             21345671
213457                QUEUE   ('CSSL')                                  21345771
213458                FROM    (PV-CICS-MSG-AREA2)                       21345871
213459                LENGTH  (PV-COMMAREA-LENGTH)                      21345971
213460                RESP    (PV-CICS-RESP)                            21346071
213461        END-EXEC                                                  21346171
213462     END-IF                                                       21346271
213463*===TKMA408=== THIS IS IN JUST FOR TESTING                        21346371
213464                                                                  21346471
213465     IF  PS-NO-SOFT-ABORT-ERROR                                   21346571
213466         PERFORM 4690-FETCH-RECDIS-STR-CURSR                      21346671
213467     END-IF.                                                      21346771
213468                                                                  21346871
213469     IF  PS-NO-SOFT-ABORT-ERROR                                   21346971
213470         IF  XLT00010-LOC-TYP-CDE = 'CS'                          21347071
213480             SET PS-CENTRAL-STOCK-YES  TO  TRUE                   21348071
213490         ELSE                                                     21349071
213500             SET PS-CENTRAL-STOCK-NO   TO  TRUE                   21350071
213510     END-IF.                                                      21351071
213520                                                                  21352071
213530                                                                  21353071
213540*----------------------------------------------------------------*21354071
213550* CALC - P2L-SPLT-UNT-QTY FCSE-SPLT-UNT-QTY INPK-SPLT-UNT-QTY    *21355071
213560*        FOR THE DISTDT ROWS                                     *21356071
213570*----------------------------------------------------------------*21357071
213580 4680-NOT-CENTRAL-STK.                                            21358071
213590                                                                  21359071
213600     MOVE PC-N     TO DISTDT-ODD-CART-IND                         21360071
213610     SET  PS-FULLCASES-ALL-NOT-USED  TO  TRUE                     21361071
213620     INITIALIZE DISTDT-P2L-SPLT-UNT-QTY                           21362071
213630                DISTDT-FCSE-SPLT-UNT-QTY                          21363071
213640                DISTDT-INPK-SPLT-UNT-QTY                          21364071
213650                DISTDT-FCSE-ACTL-UNT-QTY                          21365071
213660                DISTDT-ACTL-ALLOC-QTY                             21366071
213670                                                                  21367071
213680     IF  LQW-ODD-CARTON (LQW-IDX) > 0                             21368071
213690         SUBTRACT  1                                              21369071
213700             FROM  LQW-CARTON-CNT (LQW-IDX)                       21370071
213710           GIVING  PV-CARTON-COUNT-LESS-ODD                       21371071
213720     ELSE                                                         21372071
213730          MOVE ZEROES                                             21373071
213740            TO PV-CARTON-COUNT-LESS-ODD                           21374071
213750     END-IF.                                                      21375071
213760                                                                  21376071
213770     IF  LQW-ODD-CARTON (LQW-IDX) > 0                             21377071
213780         IF  PS-USE-ODD-CARTON-FCSE                               21378071
213790             IF  PV-SML-FCSE-LBL-CNT  >= LQW-CARTON-CNT (LQW-IDX) 21379071
213800                 SET PS-FULLCASES-ALL-USED  TO  TRUE              21380071
213810             END-IF                                               21381071
213820         ELSE                                                     21382071
213830             IF  PV-SML-FCSE-LBL-CNT  >= PV-CARTON-COUNT-LESS-ODD 21383071
213840                 SET PS-FULLCASES-ALL-USED  TO  TRUE              21384071
213850             END-IF                                               21385071
213860         END-IF                                                   21386071
213870     END-IF.                                                      21387071
213880                                                                  21388071
213890*                                                                 21389071
213900* DETERMINE IF ALLOCATION CAN BE FILLED BY FULLCASE.              21390071
213910*                                                                 21391071
213920     IF  PS-FULLCASES-ALL-NOT-USED  AND                           21392071
213930         PV-OUTER-PACK-QTY > 0                                    21393071
213940         DIVIDE  RECDIS-EXPTED-ITM-QTY                            21394071
213950             BY  PV-OUTER-PACK-QTY                                21395071
213960         GIVING  PV-FULLCASE-NOT-CENTRAL-STK                      21396071
213970                 REMAINDER PV-FULLCASE-REMAINDER                  21397071
213980     ELSE                                                         21398071
213990         MOVE ZEROES  TO  PV-FULLCASE-NOT-CENTRAL-STK             21399071
214000         MOVE RECDIS-EXPTED-ITM-QTY  TO PV-FULLCASE-REMAINDER     21400071
214010     END-IF.                                                      21401071
214020                                                                  21402071
214030     MULTIPLY  PV-FULLCASE-NOT-CENTRAL-STK                        21403071
214040           BY  PV-OUTER-PACK-QTY                                  21404071
214050       GIVING  PV-FULLCASE-SPLIT-UNITS.                           21405071
214060                                                                  21406071
214070     IF  LQW-ODD-CARTON (LQW-IDX) > 0  AND                        21407071
214080         PV-FULLCASE-NOT-CENTRAL-STK  >=  PV-ODD-FULLCASE  AND    21408071
214090         PV-FULLCASE-REMAINDER  =  PV-ODD-REMAINDER  AND          21409071
214100         LQW-FCSE-ODD-CRTN-NOT-USED (LQW-IDX)                     21410071
214110                                                                  21411071
214120         SUBTRACT  PV-ODD-FULLCASE                                21412071
214130             FROM  PV-FULLCASE-NOT-CENTRAL-STK                    21413071
214140           GIVING  PV-FULLCASE-NOT-CENTRAL-STK                    21414071
214150                                                                  21415071
214160         MULTIPLY  PV-FULLCASE-NOT-CENTRAL-STK                    21416071
214170               BY  PV-OUTER-PACK-QTY                              21417071
214180           GIVING  PV-FULLCASE-SPLIT-UNITS                        21418071
214190                                                                  21419071
214200         ADD 1  TO  PV-FULLCASE-NOT-CENTRAL-STK                   21420071
214210         ADD  LQW-ODD-CARTON (LQW-IDX)                            21421071
214220          TO  PV-FULLCASE-SPLIT-UNITS                             21422071
214230         MOVE  ZEROES  TO  PV-FULLCASE-REMAINDER                  21423071
214240         SET  PS-USE-ODD-CARTON-FCSE                              21424071
214250              LQW-FCSE-ODD-CRTN-USED (LQW-IDX)                    21425071
214260              LQW-ODD-CRTN-FCSE (LQW-IDX)      TO TRUE            21426071
214270         MOVE PC-F TO DISTDT-ODD-CART-IND                         21427071
214280                                                                  21428071
214290     ELSE                                                         21429071
214300     IF  PV-FULLCASE-NOT-CENTRAL-STK  >=  PV-ODD-FULLCASE  AND    21430071
214310         RECDIS-EXPTED-ITM-QTY  >  LQW-ODD-CARTON(LQW-IDX) AND    21431071
214320         PS-USE-ODD-CARTON-NONE                            AND    21432071
214330         LQW-ODD-CARTON (LQW-IDX) > 0                      AND    21433071
214340         LQW-FCSE-ODD-CRTN-NOT-USED (LQW-IDX)                     21434071
214350                                                                  21435071
214360         SUBTRACT  LQW-ODD-CARTON(LQW-IDX)                        21436071
214370             FROM  RECDIS-EXPTED-ITM-QTY                          21437071
214380           GIVING  PV-ALLOC-AFTER-ODD-CARTON                      21438071
214390                                                                  21439071
214400         DIVIDE  PV-ALLOC-AFTER-ODD-CARTON                        21440071
214410             BY  PV-OUTER-PACK-QTY                                21441071
214420         GIVING  PV-FULLCASE-NOT-CENTRAL-STK                      21442071
214430                 REMAINDER PV-FULLCASE-REMAINDER                  21443071
214440                                                                  21444071
214450         MULTIPLY  PV-FULLCASE-NOT-CENTRAL-STK                    21445071
214460               BY  PV-OUTER-PACK-QTY                              21446071
214470           GIVING  PV-FULLCASE-SPLIT-UNITS                        21447071
214480                                                                  21448071
214490         ADD 1  TO  PV-FULLCASE-NOT-CENTRAL-STK                   21449071
214500         ADD  LQW-ODD-CARTON (LQW-IDX)                            21450071
214510          TO  PV-FULLCASE-SPLIT-UNITS                             21451071
214520         SET  PS-USE-ODD-CARTON-FCSE                              21452071
214530              LQW-FCSE-ODD-CRTN-USED(LQW-IDX)                     21453071
214540              LQW-ODD-CRTN-FCSE(LQW-IDX)       TO TRUE            21454071
214550         MOVE PC-F TO DISTDT-ODD-CART-IND                         21455071
214560                                                                  21456071
214570     ELSE                                                         21457071
214580                                                                  21458071
214590     IF  PV-FULLCASE-NOT-CENTRAL-STK  =  0                        21459071
214600         MOVE  RECDIS-EXPTED-ITM-QTY  TO  PV-FULLCASE-REMAINDER   21460071
214610     ELSE                                                         21461071
214620                                                                  21462071
214630         IF LQW-ODD-CARTON (LQW-IDX) > ZEROES                     21463071
214640               ADD  PV-FULLCASE-NOT-CENTRAL-STK                   21464071
214650                TO  PV-SML-FCSE-LBL-CNT                           21465071
214660            GIVING  PV-FULLCASE-ODD-COUNT                         21466071
214670         END-IF                                                   21467071
214680         IF LQW-ODD-CARTON (LQW-IDX) > ZEROES AND                 21468071
214690            PV-FULLCASE-ODD-COUNT  >  PV-CARTON-COUNT-LESS-ODD    21469071
214700            IF LQW-ODD-CRTN-FCSE (LQW-IDX) AND                    21470071
214710               LQW-FCSE-ODD-CRTN-USED (LQW-IDX)                   21471071
214720               CONTINUE                                           21472071
214730            ELSE                                                  21473071
214740               SUBTRACT PV-CARTON-COUNT-LESS-ODD                  21474071
214750                   FROM PV-FULLCASE-ODD-COUNT                     21475071
214760                 GIVING PV-FULLCASE-ODD-CART-OVER                 21476071
214770               SUBTRACT PV-FULLCASE-ODD-CART-OVER                 21477071
214780                   FROM PV-FULLCASE-NOT-CENTRAL-STK               21478071
214790                 GIVING PV-FULLCASE-NOT-CENTRAL-STK               21479071
214800               MULTIPLY PV-FULLCASE-ODD-CART-OVER                 21480071
214810                     BY PV-OUTER-PACK-QTY                         21481071
214820                 GIVING PV-FULLCASE-ODD-UNT-OVER                  21482071
214830                    ADD PV-FULLCASE-ODD-UNT-OVER                  21483071
214840                     TO PV-FULLCASE-REMAINDER                     21484071
214850            END-IF                                                21485071
214860         END-IF                                                   21486071
214870                                                                  21487071
214880         MULTIPLY  PV-FULLCASE-NOT-CENTRAL-STK                    21488071
214890               BY  PV-OUTER-PACK-QTY                              21489071
214900           GIVING  PV-FULLCASE-SPLIT-UNITS                        21490071
214910     END-IF.                                                      21491071
214920                                                                  21492071
214930* IF ALLOCATION IS NOT FILLED BY FULL CASE.   CHECK TO SEE IF     21493071
214940* CAN BE FILLED WITH FULL ODD CARTON                              21494071
214950                                                                  21495071
214960     IF  PV-FULLCASE-REMAINDER    >  ZEROES  AND                  21496071
214970         LQW-ODD-CARTON (LQW-IDX) > ZEROES  AND                   21497071
214980         LQW-FCSE-ODD-CRTN-NOT-USED (LQW-IDX)                     21498071
214990             IF  PV-FULLCASE-REMAINDER  =                         21499071
215000                 LQW-ODD-CARTON (LQW-IDX)                         21500071
215010                     ADD  1  TO  PV-FULLCASE-NOT-CENTRAL-STK      21501071
215020                     ADD  PV-FULLCASE-REMAINDER                   21502071
215030                             TO  PV-FULLCASE-SPLIT-UNITS          21503071
215040                     SET  LQW-FCSE-ODD-CRTN-USED (LQW-IDX)        21504071
215050                          LQW-ODD-CRTN-FCSE (LQW-IDX) TO TRUE     21505071
215060                     MOVE PC-F TO DISTDT-ODD-CART-IND             21506071
215070                     MOVE  ZEROES  TO  PV-FULLCASE-REMAINDER      21507071
215080             END-IF                                               21508071
215090     END-IF.                                                      21509071
215100                                                                  21510071
215110                                                                  21511071
215120* IF ALLOCATION IS NOT FILLED BY FULL CASE/FULL ODD CARTON.       21512071
215130* CHECK TO SEE IF CAN BE FILLED WITH CONVEYABLE INNER-PACKS       21513071
215140                                                                  21514071
215150     INITIALIZE  PV-INPK-NOT-CENTRAL-STK                          21515071
215160                 PV-INPK-REMAINDER                                21516071
215170                 PV-FCSE-INPK-REMAINDER.                          21517071
215180                                                                  21518071
215190     IF  PV-IN-PAK-CONVEY = 'Y'                                   21519071
215200         IF  PV-INNER-PACK-QTY  >  0                              21520071
215210             DIVIDE  PV-FULLCASE-REMAINDER                        21521071
215220                 BY  PV-INNER-PACK-QTY                            21522071
215230             GIVING  PV-INPK-NOT-CENTRAL-STK                      21523071
215240                     REMAINDER PV-INPK-REMAINDER                  21524071
215250             IF  PV-INPK-NOT-CENTRAL-STK  >  0  AND               21525071
215260                 PS-USE-ODD-CARTON-INPK  AND                      21526071
215270                 PS-ODD-CARTON-INPK-NOT-USED                      21527071
215280                 MOVE  PC-I  TO  DISTDT-ODD-CART-IND              21528071
215290                 SET  LQW-ODD-CRTN-INPK (LQW-IDX)  TO  TRUE       21529071
215300                 ADD  PV-INPK-NOT-CENTRAL-STK                     21530071
215310                  TO  PV-ODD-CARTON-INPK-USED                     21531071
215320                 IF  PV-ODD-CARTON-INPK-USED >=                   21532071
215330                     PV-ODD-CARTON-INPK-TOTAL                     21533071
215340                     SET  PS-ODD-CARTON-INPK-COMPLETE             21534071
215350                          LQW-FCSE-ODD-CRTN-USED (LQW-IDX)        21535071
215360                          TO  TRUE                                21536071
215370                 END-IF                                           21537071
215380             END-IF                                               21538071
215390         ELSE                                                     21539071
215400             MOVE  ZEROES  TO  PV-INPK-NOT-CENTRAL-STK            21540071
215410             MOVE  PV-INNER-PACK-QTY  TO  PV-INPK-REMAINDER       21541071
215420         END-IF                                                   21542071
215430                                                                  21543071
215440         MULTIPLY  PV-INPK-NOT-CENTRAL-STK                        21544071
215450               BY  PV-INNER-PACK-QTY                              21545071
215460           GIVING  DISTDT-INPK-SPLT-UNT-QTY                       21546071
215470         MOVE  PV-INPK-REMAINDER                                  21547071
215480               TO   PV-FCSE-INPK-REMAINDER                        21548071
215490     ELSE                                                         21549071
215500         MOVE  PV-FULLCASE-REMAINDER                              21550071
215510               TO   PV-FCSE-INPK-REMAINDER                        21551071
215520     END-IF.                                                      21552071
215530                                                                  21553071
215540* IF ALLOCATION IS NOT FILLED BY FULL CASE/ODD CARTON/INNER PACK  21554071
215550* CHECK TO SEE IF CAN BE FILLED WITH FULL ODD-CARTON              21555071
215560                                                                  21556071
215570     IF  PV-FCSE-INPK-REMAINDER  >  ZEROES  AND                   21557071
215580         LQW-ODD-CARTON (LQW-IDX) > ZEROES  AND                   21558071
215590         LQW-FCSE-ODD-CRTN-NOT-USED (LQW-IDX)                     21559071
215600             IF  PV-FCSE-INPK-REMAINDER  =                        21560071
215610                 LQW-ODD-CARTON (LQW-IDX)                         21561071
215620                     ADD  1  TO  PV-FULLCASE-NOT-CENTRAL-STK      21562071
215630                     ADD  PV-FCSE-INPK-REMAINDER                  21563071
215640                             TO  PV-FULLCASE-SPLIT-UNITS          21564071
215650                     SET  LQW-FCSE-ODD-CRTN-USED (LQW-IDX)        21565071
215660                          LQW-ODD-CRTN-FCSE (LQW-IDX) TO TRUE     21566071
215670                     MOVE PC-F TO DISTDT-ODD-CART-IND             21567071
215680             ELSE                                                 21568071
215690                 MOVE PV-FCSE-INPK-REMAINDER                      21569071
215700                   TO DISTDT-P2L-SPLT-UNT-QTY                     21570071
215710             END-IF                                               21571071
215720     ELSE                                                         21572071
215730         MOVE PV-FCSE-INPK-REMAINDER  TO  DISTDT-P2L-SPLT-UNT-QTY 21573071
215740     END-IF.                                                      21574071
215750                                                                  21575071
215760                                                                  21576071
215770     MOVE PV-FULLCASE-SPLIT-UNITS                                 21577071
215780       TO DISTDT-FCSE-SPLT-UNT-QTY.                               21578071
215790                                                                  21579071
215800     ADD  DISTDT-P2L-SPLT-UNT-QTY     TO  PV-P2L-UNIT-CNT.        21580071
215810     ADD  PV-FULLCASE-NOT-CENTRAL-STK TO  PV-SML-FCSE-LBL-CNT.    21581071
215820     ADD  PV-INPK-NOT-CENTRAL-STK     TO  PV-SML-INPK-LBL-CNT.    21582071
215830                                                                  21583071
215840     PERFORM 4742-BLD-DTL-REC-CENTRL-STK                          21584071
215850                                                                  21585071
215860                                                                  21586071
215870*===TKMA408=== THIS IS IN JUST FOR TESTING                        21587071
215880     IF   PS-DISPLAY-CSSL-YES                                     21588071
215890          move spaces to   PV-CICS-MSG-AREA2                      21589071
215900          STRING ' PCKCS701-4680-NOT-CENTRAL-STK'                 21590071
215910                                           DELIMITED BY SIZE      21591071
215911                                      INTO PV-CICS-MSG-AREA2      21591171
215912        MOVE LENGTH OF PV-CICS-MSG-AREA2                          21591271
215913                                      TO PV-COMMAREA-LENGTH       21591371
215914        EXEC CICS                                                 21591471
215915            WRITEQ TD                                             21591571
215916                QUEUE   ('CSSL')                                  21591671
215917                FROM    (PV-CICS-MSG-AREA2)                       21591771
215918                LENGTH  (PV-COMMAREA-LENGTH)                      21591871
215919                RESP    (PV-CICS-RESP)                            21591971
215920        END-EXEC                                                  21592071
215921     END-IF                                                       21592171
215922*===TKMA408=== THIS IS IN JUST FOR TESTING                        21592271
215923                                                                  21592371
215924     IF  PS-NO-SOFT-ABORT-ERROR                                   21592471
215925         PERFORM 4690-FETCH-RECDIS-STR-CURSR                      21592571
215926         IF  XLT00010-LOC-TYP-CDE = 'CS'                          21592671
215927             SET PS-CENTRAL-STOCK-YES  TO  TRUE                   21592771
215928         ELSE                                                     21592871
215929             SET PS-CENTRAL-STOCK-NO   TO  TRUE                   21592971
215930         END-IF                                                   21593071
215940     END-IF.                                                      21594071
215950                                                                  21595071
215960     IF  PS-NO-SOFT-ABORT-ERROR                                   21596071
215970         IF  PS-EOF-RECDIS-STR-CURSR-YES                          21597071
215980             IF  LQW-ODD-CARTON (LQW-IDX) > 0   AND               21598071
215990                 LQW-ODD-CRTN-NONE (LQW-IDX)    AND               21599071
216000                 LQW-FCSE-ODD-CRTN-NOT-USED (LQW-IDX)             21600071
216010                     SET LQW-ODD-CRTN-P2L (LQW-IDX) TO TRUE       21601071
216020             END-IF                                               21602071
216030         END-IF                                                   21603071
216040     END-IF.                                                      21604071
216050                                                                  21605071
216060                                                                  21606071
216070*----------------------------------------------------------------*21607071
216080*                                                                *21608071
216090*----------------------------------------------------------------*21609071
216100 4685-OPEN-RECDIS-STR-CURSR.                                      21610071
216110*===TKMA408=== THIS IS IN JUST FOR TESTING                        21611071
216120     IF   PS-DISPLAY-CSSL-YES                                     21612071
216130          move spaces to   PV-CICS-MSG-AREA2                      21613071
216140          STRING ' PCKCS701-4685-OPEN-RECDIS-STR-CURSR'           21614071
216150                                           DELIMITED BY SIZE      21615071
216160                                      INTO PV-CICS-MSG-AREA2      21616071
216161        MOVE LENGTH OF PV-CICS-MSG-AREA2                          21616171
216162                                      TO PV-COMMAREA-LENGTH       21616271
216163        EXEC CICS                                                 21616371
216164            WRITEQ TD                                             21616471
216165                QUEUE   ('CSSL')                                  21616571
216166                FROM    (PV-CICS-MSG-AREA2)                       21616671
216167                LENGTH  (PV-COMMAREA-LENGTH)                      21616771
216168                RESP    (PV-CICS-RESP)                            21616871
216169        END-EXEC                                                  21616971
216170     END-IF                                                       21617071
216171*===TKMA408=== THIS IS IN JUST FOR TESTING                        21617171
216172     SET  PS-NO-SOFT-ABORT-ERROR  TO  TRUE.                       21617271
216173                                                                  21617371
216174     EXEC SQL                                                     21617471
216175         OPEN treCDIS_TSTR_CURSR                                  21617571
216176     END-EXEC.                                                    21617671
216177                                                                  21617771
216178     EVALUATE TRUE                                                21617871
216179         WHEN SQLCODE = ZERO                                      21617971
216180             CONTINUE                                             21618071
216190         WHEN SQLCODE = -904                                      21619071
216200         WHEN SQLCODE = -911                                      21620071
216210         WHEN SQLCODE = -913                                      21621071
216220                                                                  21622071
216230             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   21623071
216240             MOVE '4685-OPEN-RECDIS-STR-CURSR'                    21624071
216250                                             TO PV-SOFT-PARAGRAPH 21625071
216260             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 21626071
216270             MOVE LENGTH OF PV-CICS-MSG-AREA2                     21627071
216280               TO PV-COMMAREA-LENGTH                              21628071
216290             EXEC CICS                                            21629071
216300                  WRITEQ TD                                       21630071
216310                   QUEUE  ('CSSL')                                21631071
216320                    FROM  (PV-CICS-MSG-AREA2)                     21632071
216330                  LENGTH  (PV-COMMAREA-LENGTH)                    21633071
216340                    RESP  (PV-CICS-RESP)                          21634071
216350             END-EXEC                                             21635071
216360                                                                  21636071
216370              MOVE  PC-TSYMSG-01767  TO  DP020-MSG-NUMBER         21637071
216380              PERFORM 9900-SOFT-ABORT                             21638071
216390         WHEN SQLWARN0 NOT = SPACE                                21639071
216400         WHEN SQLCODE < ZERO                                      21640071
216410         WHEN SQLCODE > ZERO                                      21641071
216420             MOVE '4685-OPEN-RECDIS-STR-CURSR'                    21642071
216430                                     TO DP013-PARAGRAPH           21643071
216440             MOVE 'OPEN THE TRECDIS_TSTR_CURSR'                   21644071
216450                                     TO DP013-MESSAGE-TEXT (1)    21645071
216460             MOVE DK-PO-NBR          TO PV-DISPLAY-PO-NBR         21646071
216470             MOVE DK-LINE-NBR        TO PV-DISPLAY-LNE-NBR        21647071
216480             MOVE DK-REC-SEQ-NBR     TO PV-DISPLAY-RCVR-SEQ-NBR   21648071
216490             STRING PV-DISPLAY-PO-NBR '-'                         21649071
216500                    PV-DISPLAY-RCVR-SEQ-NBR '-'                   21650071
216510                    PV-DISPLAY-LNE-NBR  DELIMITED BY SIZE         21651071
216511                                   INTO DP013-MESSAGE-TEXT (2)    21651171
216512             MOVE SQLCA              TO DP013-SQLCA               21651271
216513             MOVE 'TRECDIS'          TO DP013-DB2-TABLE-NAME (1)  21651371
216514             MOVE 'XLT_LOC'          TO DP013-DB2-TABLE-NAME (2)  21651471
216515             SET DP013-DB2-ABEND     TO TRUE                      21651571
216516             SET DP013-NO-ROLLBACK   TO TRUE                      21651671
216517             SET DP013-XCTL-DISPLAY-RESTART                       21651771
216518                                     TO TRUE                      21651871
216519             PERFORM DP013-0000-PROCESS-ABEND                     21651971
216520     END-EVALUATE.                                                21652071
216530                                                                  21653071
216540                                                                  21654071
216550*----------------------------------------------------------------*21655071
216560*                                                                *21656071
216570*----------------------------------------------------------------*21657071
216580 4690-FETCH-RECDIS-STR-CURSR.                                     21658071
216590*===TKMA408=== THIS IS IN JUST FOR TESTING                        21659071
216600     IF   PS-DISPLAY-CSSL-YES                                     21660071
216610          move spaces to   PV-CICS-MSG-AREA2                      21661071
216620          STRING ' PCKCS701-4690-FETCH-RECDIS-STR-CURSR'          21662071
216630                                           DELIMITED BY SIZE      21663071
216640                                      INTO PV-CICS-MSG-AREA2      21664071
216650        MOVE LENGTH OF PV-CICS-MSG-AREA2                          21665071
216660                                      TO PV-COMMAREA-LENGTH       21666071
216661        EXEC CICS                                                 21666171
216662            WRITEQ TD                                             21666271
216663                QUEUE   ('CSSL')                                  21666371
216664                FROM    (PV-CICS-MSG-AREA2)                       21666471
216665                LENGTH  (PV-COMMAREA-LENGTH)                      21666571
216666                RESP    (PV-CICS-RESP)                            21666671
216667        END-EXEC                                                  21666771
216668     END-IF                                                       21666871
216669*===TKMA408=== THIS IS IN JUST FOR TESTING                        21666971
216670     SET  PS-NO-SOFT-ABORT-ERROR  TO  TRUE.                       21667071
216680                                                                  21668071
216690     EXEC SQL                                                     21669071
216700         FETCH TRECDIS_TSTR_CURSR                                 21670071
216710         INTO  :RECDIS-STR-NBR,                                   21671071
216720               :XLT00010-LOC-TYP-CDE,                             21672071
216730               :RECDIS-EXPTED-ITM-QTY                             21673071
216740     END-EXEC.                                                    21674071
216750                                                                  21675071
216760     EVALUATE TRUE                                                21676071
216770         WHEN SQLCODE = ZERO                                      21677071
216780             CONTINUE                                             21678071
216790         WHEN SQLCODE = +100                                      21679071
216800             SET PS-EOF-RECDIS-STR-CURSR-YES TO TRUE              21680071
216801                                                                  21680171
216802             PERFORM 4695-CLOSE-RECDIS-STR-CURSR                  21680271
216803                                                                  21680371
216804         WHEN SQLCODE = -904                                      21680471
216805         WHEN SQLCODE = -911                                      21680571
216806         WHEN SQLCODE = -913                                      21680671
216807                                                                  21680771
216808             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   21680871
216809             MOVE '4690-FETCH-RECDIS-STR-CURSR'                   21680971
216810                                             TO PV-SOFT-PARAGRAPH 21681071
216820             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 21682071
216830             MOVE LENGTH OF PV-CICS-MSG-AREA2                     21683071
216840               TO PV-COMMAREA-LENGTH                              21684071
216850             EXEC CICS                                            21685071
216860                  WRITEQ TD                                       21686071
216870                   QUEUE  ('CSSL')                                21687071
216880                    FROM  (PV-CICS-MSG-AREA2)                     21688071
216890                  LENGTH  (PV-COMMAREA-LENGTH)                    21689071
216900                    RESP  (PV-CICS-RESP)                          21690071
216910             END-EXEC                                             21691071
216920                                                                  21692071
216930              MOVE  PC-TSYMSG-01767  TO  DP020-MSG-NUMBER         21693071
216940              PERFORM 9900-SOFT-ABORT                             21694071
216950         WHEN SQLWARN0 NOT = SPACE                                21695071
216960         WHEN SQLCODE < ZERO                                      21696071
216970         WHEN SQLCODE > ZERO                                      21697071
216980             MOVE '4690-FETCH-RECDIS-STR-CURSR'                   21698071
216990                                     TO DP013-PARAGRAPH           21699071
217000             MOVE 'ATTEMPTING TO FETCH A ROW OF THE RESULTS TABLE 21700071
217010-                 'FROM THE TRECDIS_TSTR_CURSR'                   21701071
217020                                     TO DP013-MESSAGE-TEXT (1)    21702071
217030             MOVE DK-PO-NBR          TO PV-DISPLAY-PO-NBR         21703071
217040             MOVE DK-LINE-NBR        TO PV-DISPLAY-LNE-NBR        21704071
217050             MOVE DK-REC-SEQ-NBR     TO PV-DISPLAY-RCVR-SEQ-NBR   21705071
217060             STRING PV-DISPLAY-PO-NBR '-'                         21706071
217070                    PV-DISPLAY-RCVR-SEQ-NBR '-'                   21707071
217080                    PV-DISPLAY-LNE-NBR  DELIMITED BY SIZE         21708071
217081                                   INTO DP013-MESSAGE-TEXT (2)    21708171
217082             MOVE SQLCA              TO DP013-SQLCA               21708271
217083             MOVE 'TRECDIS'          TO DP013-DB2-TABLE-NAME (1)  21708371
217084             MOVE 'XLT_LOC'          TO DP013-DB2-TABLE-NAME (2)  21708471
217085             SET DP013-DB2-ABEND     TO TRUE                      21708571
217086             SET DP013-ROLLBACK      TO TRUE                      21708671
217087             SET DP013-XCTL-DISPLAY-RESTART                       21708771
217088                                     TO TRUE                      21708871
217089             PERFORM DP013-0000-PROCESS-ABEND                     21708971
217090     END-EVALUATE.                                                21709071
217100                                                                  21710071
217110                                                                  21711071
217120*----------------------------------------------------------------*21712071
217130*                                                                *21713071
217140*----------------------------------------------------------------*21714071
217150 4695-CLOSE-RECDIS-STR-CURSR.                                     21715071
217160*===TKMA408=== THIS IS IN JUST FOR TESTING                        21716071
217170     IF   PS-DISPLAY-CSSL-YES                                     21717071
217180          move spaces to   PV-CICS-MSG-AREA2                      21718071
217190          STRING ' PCKCS701-4695-CLOSE-RECDIS-STR-CURSR'          21719071
217191                                           DELIMITED BY SIZE      21719171
217192                                      INTO PV-CICS-MSG-AREA2      21719271
217193        MOVE LENGTH OF PV-CICS-MSG-AREA2                          21719371
217194                                      TO PV-COMMAREA-LENGTH       21719471
217195        EXEC CICS                                                 21719571
217196            WRITEQ TD                                             21719671
217197                QUEUE   ('CSSL')                                  21719771
217198                FROM    (PV-CICS-MSG-AREA2)                       21719871
217199                LENGTH  (PV-COMMAREA-LENGTH)                      21719971
217200                RESP    (PV-CICS-RESP)                            21720071
217201        END-EXEC                                                  21720171
217202     END-IF                                                       21720271
217203*===TKMA408=== THIS IS IN JUST FOR TESTING                        21720371
217204     SET  PS-NO-SOFT-ABORT-ERROR  TO  TRUE.                       21720471
217205                                                                  21720571
217206     EXEC SQL                                                     21720671
217207         CLOSE TRECDIS_TSTR_CURSR                                 21720771
217208     END-EXEC.                                                    21720871
217209                                                                  21720971
217210     EVALUATE TRUE                                                21721071
217211         WHEN SQLCODE = ZERO                                      21721171
217212             CONTINUE                                             21721271
217213         WHEN SQLCODE = -904                                      21721371
217214         WHEN SQLCODE = -911                                      21721471
217215         WHEN SQLCODE = -913                                      21721571
217216                                                                  21721671
217217             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   21721771
217218             MOVE '4695-CLOSE-RECDIS-STR-CURSR'                   21721871
217219                                             TO PV-SOFT-PARAGRAPH 21721971
217220             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 21722071
217221             MOVE LENGTH OF PV-CICS-MSG-AREA2                     21722171
217222               TO PV-COMMAREA-LENGTH                              21722271
217223             EXEC CICS                                            21722371
217224                  WRITEQ TD                                       21722471
217225                   QUEUE  ('CSSL')                                21722571
217226                    FROM  (PV-CICS-MSG-AREA2)                     21722671
217227                  LENGTH  (PV-COMMAREA-LENGTH)                    21722771
217228                    RESP  (PV-CICS-RESP)                          21722871
217229             END-EXEC                                             21722971
217230                                                                  21723071
217231              MOVE  PC-TSYMSG-01767  TO  DP020-MSG-NUMBER         21723171
217232              PERFORM 9900-SOFT-ABORT                             21723271
217233         WHEN SQLWARN0 NOT = SPACE                                21723371
217234         WHEN SQLCODE < ZERO                                      21723471
217235         WHEN SQLCODE > ZERO                                      21723571
217236             MOVE '4695-CLOSE-RECDIS-STR-CURSR'                   21723671
217237                                     TO DP013-PARAGRAPH           21723771
217238             MOVE 'CLOSE THE TRECDIS_TSTR_CURSR'                  21723871
217239                                     TO DP013-MESSAGE-TEXT (1)    21723971
217240             MOVE DK-PO-NBR          TO PV-DISPLAY-PO-NBR         21724071
217241             MOVE DK-LINE-NBR        TO PV-DISPLAY-LNE-NBR        21724171
217242             MOVE DK-REC-SEQ-NBR     TO PV-DISPLAY-RCVR-SEQ-NBR   21724271
217243             STRING PV-DISPLAY-PO-NBR '-'                         21724371
217244                    PV-DISPLAY-RCVR-SEQ-NBR '-'                   21724471
217245                    PV-DISPLAY-LNE-NBR  DELIMITED BY SIZE         21724571
217246                                   intO DP013-MESSAGE-TEXT (2)    21724671
217247             MOVE SQLCA              TO DP013-SQLCA               21724771
217248             MOVE 'TRECDIS'          TO DP013-DB2-TABLE-NAME (1)  21724871
217249             MOVE 'XLT_LOC'          TO DP013-DB2-TABLE-NAME (2)  21724971
217250             SET DP013-DB2-ABEND     TO TRUE                      21725071
217251             SET DP013-NO-ROLLBACK   TO TRUE                      21725171
217252             SET DP013-XCTL-DISPLAY-RESTART                       21725271
217253                                     TO TRUE                      21725371
217254             PERFORM DP013-0000-PROCESS-ABEND                     21725471
217255     END-EVALUATE.                                                21725571
217256                                                                  21725671
217257                                                                  21725771
217258*----------------------------------------------------------------*21725871
217259*  DOWNLOAD THE HEADER DATA TO AL SYSTEMS.  (P2L)                *21725971
217260*----------------------------------------------------------------*21726071
217261 4700-BLD-HDR-REC.                                                21726171
217262     PERFORM 4705-FORMAT-TIME.                                    21726271
217263     PERFORM 4707-GET-HDR-INFO.                                   21726371
217264                                                                  21726471
217265     INITIALIZE PC053-DISTRO-RECORD                               21726571
217266     INITIALIZE PC184-DISTRO-RECORD                               21726671
217267     SET  PC053-DISTRO-HDR       TO  TRUE                         21726771
217268     SET  PC184-DISTRO-HDR       TO  TRUE                         21726871
217269                                                                  21726971
217270     MOVE PV-PO-NBR-8            TO PC053-HDR-ORD-NBR             21727071
217280                                    PC184-HDR-ORD-NBR             21728071
217290     MOVE PV-REC-SEQ-NBR-3       TO PC053-HDR-RCVR-SEQ-NBR        21729071
217300                                    PC184-HDR-RCVR-SEQ-NBR        21730071
217310     MOVE PV-PO-LINE-NBR-X       TO PC053-HDR-ORD-LNE-NBR         21731071
217320                                    PC184-HDR-ORD-LNE-NBR         21732071
217330     MOVE PC-001                 TO PC053-HDR-WORK-ORD-SEQ-NBR    21733071
217340                                    PC184-HDR-WORK-ORD-SEQ-NBR    21734071
217350     MOVE ZEROES                 TO PC053-HDR-WO-INS-SEQ-NBR      21735071
217360                                    PC184-HDR-WO-INS-SEQ-NBR      21736071
217370     MOVE SD-SYSTEM-MONTH        TO PC053-CREATE-MONTH            21737071
217380                                    PC184-CREATE-MONTH            21738071
217390     MOVE SD-SYSTEM-DAY          TO PC053-CREATE-DAY              21739071
217400                                    PC184-CREATE-DAY              21740071
217410     MOVE SD-SYSTEM-CENTURY-YEAR TO PC053-CREATE-CENTURY-YEAR     21741071
217420                                    PC184-CREATE-CENTURY-YEAR     21742071
217430     MOVE ST-SYSTEM-HOUR         TO PC053-CREATE-HOUR             21743071
217440                                    PC184-CREATE-HOUR             21744071
217450     MOVE ST-SYSTEM-MINUTE       TO PC053-CREATE-MINUTE           21745071
217460                                    PC184-CREATE-MINUTE           21746071
217470     MOVE ST-SYSTEM-SECOND       TO PC053-CREATE-SECOND           21747071
217480                                    PC184-CREATE-SECOND           21748071
217490     MOVE ASC-INHOUSE-VNDR-NBR   TO PC053-VNDR-IN-HSE-NBR.        21749071
217500                                                                  21750071
217510     PERFORM 4702-GET-PRIMARY-VNDR-NME.                           21751071
217520     MOVE ENTNME-ENT-NAME-DESC   TO PC184-VNDR-NAME.              21752071
217530                                                                  21753071
217540*** when closing an order from desktop screen pcc gives error     21754071
217550*** when name contains a quote                                    21755071
217560*** these special characters dont play well with XML              21756071
217570*-----------------------------------------------------------------21757071
217580     MOVE SPACE TO  PC-SPACE.                                     21758071
217590     INSPECT PC184-VNDR-NAME     REPLACING ALL                    21759071
217600         quote BY PC-SPACE.                                       21760071
217610     INSPECT PC184-VNDR-NAME     REPLACING ALL                    21761071
217620         '&'   BY PC-SPACE.                                       21762071
217630     INSPECT PC184-VNDR-NAME     REPLACING ALL                    21763071
217640         '"'   BY PC-SPACE.                                       21764071
217641     INSPECT PC184-VNDR-NAME     REPLACING ALL                    21764171
217642         '<'   BY PC-SPACE.                                       21764271
217643     INSPECT PC184-VNDR-NAME     REPLACING ALL                    21764371
217644         '>'   BY PC-SPACE.                                       21764471
217645                                                                  21764571
217646     MOVE PV-PO-NBR-8            TO PC053-PO-NBR                  21764671
217647                                    PC184-PO-NBR                  21764771
217648                                                                  21764871
217649     IF  ASC-PRE-PACK-ORDER                                       21764971
217650         MOVE LQW-PREPK-ID (LQW-IDX)                              21765071
217660                                 TO PV-PREPK-ID-8-POS             21766071
217670         MOVE PV-PREPK-ID-8-POS  TO PC053-MERCH-SKU-NBR           21767071
217680                                    PC184-ITEM-NBR                21768071
217690         SET  PC184-PRE-PACK                                      21769071
217700              PC053-PRE-PACK     TO TRUE                          21770071
217710     ELSE                                                         21771071
217720         MOVE LQW-SKU (LQW-IDX)  TO PC053-MERCH-SKU-NBR           21772071
217730                                    PC184-ITEM-NBR                21773071
217740         MOVE ASC-DPT-NBR        TO PC184-ITEM-DEPT-NBR           21774071
217750         MOVE LQW-CLASS    (LQW-IDX)                              21775071
217760                                 TO PC184-ITEM-CLASS-NBR          21776071
217770         MOVE LQW-SUBCLASS (LQW-IDX) TO                           21777071
217780                                    PC184-ITEM-SUBCLASS-NBR       21778071
217790         SET  PC184-NOT-PRE-PACK TO TRUE                          21779071
217800         SET  PC053-NOT-PRE-PACK TO TRUE                          21780071
217810     END-IF                                                       21781071
217820                                                                  21782071
217830     MOVE PV-SKU-DESC            TO PC053-SKU-DESC                21783071
217840                                    PC184-ITEM-DESC               21784071
217850     MOVE PV-VEND-STYL-NAME      TO PC053-VNDR-STYLE-CODE         21785071
217860                                    PC184-VNDR-STYLE-CODE         21786071
217870     MOVE PV-SIZE-DESC           TO PC053-SIZE-DESC               21787071
217880                                    PC184-SIZE-DESC               21788071
217890     MOVE PV-COLOR-DESC          TO PC053-COLOR-DESC              21789071
217900                                    PC184-COLOR-DESC              21790071
217910     MOVE PV-MODULE              TO PC053-LANE-CODE               21791071
217920                                    PC184-P2L-MOD-NBR             21792071
217930     MOVE PV-CARTON-COUNT        TO PC053-CTN-TOTAL               21793071
217940     MOVE PV-STR-CNT-X           TO PC053-STR-TOTAL               21794071
217950     MOVE PV-UNIT-RETAIL         TO PC053-RTL-CST-AMT             21795071
217960                                    PC184-RTL-CST-AMT             21796071
217970     MOVE PV-INNER-PACK-QTY      TO PC053-INNR-PACK-QTY           21797071
217980                                    PC184-INNR-PACK-QTY           21798071
217990     MOVE ASC-DFLT-STR-ZN-ID     TO PC053-STORE-ZONE              21799071
218000                                    PC184-STORE-ZONE-ID           21800071
218001                                                                  21800171
218002     IF  ASC-HAZ-FACILITY-YES                                     21800271
218003         MOVE LQW-HAZ-CODE (LQW-IDX)                              21800371
218004                                 TO  PC184-HAZ-SUBMSG             21800471
218005     END-IF.                                                      21800571
218006                                                                  21800671
218007     INSPECT PC053-DISTRO-HDR-REC                                 21800771
218008             REPLACING ALL '' BY SPACES                          21800871
218009     INSPECT PC053-DISTRO-HDR-REC                                 21800971
218010             REPLACING ALL ';' BY SPACES                          21801071
218020     INSPECT PC053-DISTRO-HDR-REC                                 21802071
218030             REPLACING ALL LOW-VALUES BY SPACES                   21803071
218040*-------------------------                                        21804071
218050* ADDED CHECK FOR HEX 3F                                          21805071
218060*-------------------------                                        21806071
218061     INSPECT PC053-DISTRO-HDR-REC                                 21806171
218062             REPLACING ALL '' bY SPACES                          21806271
218063     MOVE PC-SEMI-COLON          TO PC053-HDR-TERM-CHAR.          21806371
218064                                                                  21806471
218065     INSPECT PC184-DISTRO-RECORD                                  21806571
218066             REPLACING ALL '' BY SPACES                          21806671
218067     INSPECT PC184-DISTRO-RECORD                                  21806771
218068             REPLACING ALL ';' BY SPACES                          21806871
218069     INSPECT PC184-DISTRO-RECORD                                  21806971
218070             REPLACING ALL LOW-VALUES BY SPACES                   21807071
218080*-------------------------                                        21808071
218090*  ADDED CHECK FOR HEX 3F                                         21809071
218100*-------------------------                                        21810071
218110     INSPECT PC184-DISTRO-RECORD                                  21811071
218120             REPLACING ALL '' bY SPACES                          21812071
218130*-------------------------                                        21813071
218140*  ADDED CHECK FOR HEX 71                                         21814071
218150*-------------------------                                        21815071
218151     INSPECT PC184-DISTRO-RECORD                                  21815171
218152             REPLACING ALL '' bY SPACES                          21815271
218153     IF  ASC-HAZ-FACILITY-YES                                     21815371
218154         MOVE PC-SEMI-COLON      to  PC184-HDR-TERM-CHAR2         21815471
218155     ELSE                                                         21815571
218156         MOVE PC-SEMI-COLON      to  PC184-HDR-TERM-CHAR          21815671
218157     END-IF.                                                      21815771
218158                                                                  21815871
218159*                                                                 21815971
218160*===TKMA408=== THIS IS IN JUST FOR TESTING                        21816071
218170     IF   PS-DISPLAY-CSSL-YES                                     21817071
218180             IF  LQW-P2L-DYNAPACK (LQW-IDX)                       21818071
218190               IF LQW-P2L-ALS-4-DIGIT-STR (LQW-IDX)               21819071
218200                  MOVE PC053-DISTRO-RECORD TO PV-CICS-152-RECORD  21820071
218210               END-IF                                             21821071
218220             ELSE                                                 21822071
218230                 MOVE PC184-DISTRO-RECORD  TO PV-CICS-152-RECORD  21823071
218240             END-IF                                               21824071
218250        MOVE PV-CICS-1-99             TO PV-CICS-MSG-DATA2        21825071
218260        MOVE PV-CICS-MSG-HOLD2        TO PV-CICS-MSG-AREA2        21826071
218270        MOVE LENGTH OF PV-CICS-MSG-AREA2                          21827071
218280                                      TO PV-COMMAREA-LENGTH       21828071
218290        EXEC CICS                                                 21829071
218300            WRITEQ TD                                             21830071
218310                QUEUE   ('CSSL')                                  21831071
218320                FROM    (PV-CICS-MSG-AREA2)                       21832071
218330                LENGTH  (PV-COMMAREA-LENGTH)                      21833071
218340                RESP    (PV-CICS-RESP)                            21834071
218350        END-EXEC                                                  21835071
218360        MOVE PV-CICS-100-152          TO PV-CICS-MSG-DATA2        21836071
218370        MOVE PV-CICS-MSG-HOLD2        TO PV-CICS-MSG-AREA2        21837071
218380                                                                  21838071
218390        MOVE LENGTH OF PV-CICS-MSG-AREA2                          21839071
218400                                      TO PV-COMMAREA-LENGTH       21840071
218410        EXEC CICS                                                 21841071
218420            WRITEQ TD                                             21842071
218430                QUEUE   ('CSSL')                                  21843071
218440                FROM    (PV-CICS-MSG-AREA2)                       21844071
218450                LENGTH  (PV-COMMAREA-LENGTH)                      21845071
218460                RESP    (PV-CICS-RESP)                            21846071
218470        END-EXEC                                                  21847071
218480        MOVE 'PV CARTON COUNT'        TO PV-CICS-MSG-DATA2        21848071
218490        MOVE PV-CICS-MSG-HOLD2        TO PV-CICS-MSG-AREA2        21849071
218500                                                                  21850071
218510        MOVE LENGTH OF PV-CICS-MSG-AREA2                          21851071
218520                                      TO PV-COMMAREA-LENGTH       21852071
218530        EXEC CICS                                                 21853071
218540            WRITEQ TD                                             21854071
218550                QUEUE   ('CSSL')                                  21855071
218560                FROM    (PV-CICS-MSG-AREA2)                       21856071
218570                LENGTH  (PV-COMMAREA-LENGTH)                      21857071
218580                RESP    (PV-CICS-RESP)                            21858071
218590        END-EXEC                                                  21859071
218600        MOVE PV-CARTON-COUNT          TO PV-CICS-MSG-DATA2        21860071
218610        MOVE PV-CICS-MSG-HOLD2        TO PV-CICS-MSG-AREA2        21861071
218620        MOVE LENGTH OF PV-CICS-MSG-AREA2                          21862071
218630                                      TO PV-COMMAREA-LENGTH       21863071
218640        EXEC CICS                                                 21864071
218650            WRITEQ TD                                             21865071
218660                QUEUE   ('CSSL')                                  21866071
218670                FROM    (PV-CICS-MSG-AREA2)                       21867071
218680                LENGTH  (PV-COMMAREA-LENGTH)                      21868071
218690                RESP    (PV-CICS-RESP)                            21869071
218700        END-EXEC                                                  21870071
218710        MOVE 'PV-SYSTEM-ID'           TO PV-CICS-MSG-DATA2        21871071
218720        MOVE PV-CICS-MSG-HOLD2        TO PV-CICS-MSG-AREA2        21872071
218730        MOVE LENGTH OF PV-CICS-MSG-AREA2                          21873071
218740                                      TO PV-COMMAREA-LENGTH       21874071
218750        EXEC CICS                                                 21875071
218760            WRITEQ TD                                             21876071
218770                QUEUE   ('CSSL')                                  21877071
218780                FROM    (PV-CICS-MSG-AREA2)                       21878071
218790                LENGTH  (PV-COMMAREA-LENGTH)                      21879071
218800                RESP    (PV-CICS-RESP)                            21880071
218810        END-EXEC                                                  21881071
218820        MOVE PV-SYSTEM-ID             TO PV-CICS-MSG-DATA2        21882071
218830        MOVE PV-CICS-MSG-HOLD2        TO PV-CICS-MSG-AREA2        21883071
218840                                                                  21884071
218850        MOVE LENGTH OF PV-CICS-MSG-AREA2                          21885071
218860                                      TO PV-COMMAREA-LENGTH       21886071
218870        EXEC CICS                                                 21887071
218880            WRITEQ TD                                             21888071
218890                QUEUE   ('CSSL')                                  21889071
218900                FROM    (PV-CICS-MSG-AREA2)                       21890071
218910                LENGTH  (PV-COMMAREA-LENGTH)                      21891071
218920                RESP    (PV-CICS-RESP)                            21892071
218930        END-EXEC                                                  21893071
218940     END-IF                                                       21894071
218950*===TKMA408=== THIS IS IN JUST FOR TESTING                        21895071
218960                                                                  21896071
218970                                                                  21897071
218980     IF  LQW-LNE-CRE-BOTH-LBL (LQW-IDX)  AND                      21898071
218990         LQW-P2L-LBL-CNT(LQW-IDX) = ZEROES                        21899071
219000         CONTINUE                                                 21900071
219010     ELSE                                                         21901071
219020     IF  ASC-P2L-AL-DOWNLOAD-NO  AND                              21902071
219030         ASC-P2L-PCC-DOWNLOAD-NO                                  21903071
219040         CONTINUE                                                 21904071
219050     ELSE                                                         21905071
219060         IF  LQW-P2L-DYNAPACK (LQW-IDX)  AND                      21906071
219070             ASC-P2L-AL-DOWNLOAD-YES                              21907071
219080             PERFORM 4800-SEND-HDR-DATA-TO-QNX                    21908071
219090         ELSE                                                     21909071
219100         IF  LQW-P2L-PCC (LQW-IDX)  AND                           21910071
219110             ASC-P2L-PCC-DOWNLOAD-YES                             21911071
219120             PERFORM 4970-SEND-P2L-DATA-LTP-THP                   21912071
219130         END-IF                                                   21913071
219140         END-IF                                                   21914071
219150     END-IF                                                       21915071
219160     END-IF.                                                      21916071
219170                                                                  21917071
219180                                                                  21918071
219190*----------------------------------------------------------------*21919071
219200* GET THE VENDOR NAME                                            *21920071
219210*----------------------------------------------------------------*21921071
219220 4702-GET-PRIMARY-VNDR-NME.                                       21922071
219230                                                                  21923071
219240     INITIALIZE DCLTENTNME.                                       21924071
219250                                                                  21925071
219260     EXEC SQL                                                     21926071
219270         SELECT B.ENT_NAME_DESC                                   21927071
219280           INTO :ENTNME-ENT-NAME-DESC                             21928071
219290           FROM TPURCHS A                                         21929071
219300               ,TENTNME B                                         21930071
219310          WHERE A.PO_NBR         =  :ASC-PO-NBR                   21931071
219320            AND A.VER_STATUS_CDE =  'A'                           21932071
219330            AND A.ENT_ID         =  B.ENT_ID                      21933071
219340            AND B.TYPE_CDE       =  '01'                          21934071
219350     END-EXEC                                                     21935071
219360                                                                  21936071
219370     EVALUATE TRUE                                                21937071
219380         WHEN SQLCODE = +0                                        21938071
219390              CONTINUE                                            21939071
219400         WHEN SQLCODE = +100                                      21940071
219410              MOVE  SPACES          TO  ENTNME-ENT-NAME-DESC      21941071
219420         WHEN SQLCODE = -904                                      21942071
219430         WHEN SQLCODE = -911                                      21943071
219440         WHEN SQLCODE = -913                                      21944071
219450             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    21945071
219460             MOVE '4702-GET-PRIMARY-VNDR-'  TO PV-SOFT-PARAGRAPH  21946071
219470             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  21947071
219480             MOVE LENGTH OF PV-CICS-MSG-AREA2                     21948071
219490               TO PV-COMMAREA-LENGTH                              21949071
219500             EXEC CICS                                            21950071
219510                  WRITEQ TD                                       21951071
219520                   QUEUE  ('CSSL')                                21952071
219530                    FROM  (PV-CICS-MSG-AREA2)                     21953071
219540                  LENGTH  (PV-COMMAREA-LENGTH)                    21954071
219550                    RESP  (PV-CICS-RESP)                          21955071
219560             END-EXEC                                             21956071
219570             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          21957071
219580             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              21958071
219590             PERFORM 9900-SOFT-ABORT                              21959071
219600         WHEN SQLWARN0 NOT = SPACES                               21960071
219610         WHEN SQLCODE < ZERO                                      21961071
219620         WHEN SQLCODE > ZERO                                      21962071
219630             MOVE '4702-GET-PRIMARY-VNDR-NME'                     21963071
219640                               TO DP013-PARAGRAPH                 21964071
219650             MOVE 'GET VENDOR NAME '                              21965071
219660                               TO DP013-MESSAGE-TEXT (1)          21966071
219670             MOVE SQLCA        TO DP013-SQLCA                     21967071
219680             MOVE 'TPURCHS'    TO DP013-DB2-TABLE-NAME (1)        21968071
219690             MOVE 'TENTNME'    TO DP013-DB2-TABLE-NAME (2)        21969071
219700             SET DP013-DB2-ABEND                                  21970071
219710                 DP013-XCTL-DISPLAY-RESTART                       21971071
219720                               TO TRUE                            21972071
219730             PERFORM DP013-0000-PROCESS-ABEND                     21973071
219740     END-EVALUATE.                                                21974071
219750                                                                  21975071
219760                                                                  21976071
219770*----------------------------------------------------------------*21977071
219780*                                                                *21978071
219790*----------------------------------------------------------------*21979071
219800 4705-FORMAT-TIME.                                                21980071
219810     EXEC CICS                                                    21981071
219820         ASKTIME ABSTIME (ST-ABSTIME)                             21982071
219830     END-EXEC.                                                    21983071
219840                                                                  21984071
219850     EXEC CICS                                                    21985071
219860         FORMATTIME ABSTIME  (ST-ABSTIME)                         21986071
219870                    MMDDYY   (SD-MMDDYY-FORMAT)                   21987071
219880                    DATESEP                                       21988071
219890                    TIME     (ST-HHMMSS-FORMAT)                   21989071
219900                    TIMESEP                                       21990071
219910     END-EXEC.                                                    21991071
219920                                                                  21992071
219930     EXEC CICS                                                    21993071
219940         FORMATTIME ABSTIME  (ST-ABSTIME)                         21994071
219950                       YEAR  (SD-YYYY-FORMAT)                     21995071
219960     END-EXEC.                                                    21996071
219970                                                                  21997071
219980     MOVE SD-YYYY-FORMAT  TO  SD-SYSTEM-CENTURY-YEAR.             21998071
219990                                                                  21999071
220000*----------------------------------------------------------------*22000071
220010*                                                                *22001071
220020*----------------------------------------------------------------*22002071
220030 4707-GET-HDR-INFO.                                               22003071
220040     EXEC SQL                                                     22004071
220050          SELECT B.VEND_STYL_NAME                                 22005071
220060                ,B.SKU_DESC                                       22006071
220070                ,B.SIZE_DESC                                      22007071
220080                ,B.COLOR_DESC                                     22008071
220090                ,B.ITM_NBR                                        22009071
220100                ,B.UNT_RTL_PR_AMT                                 22010071
220110                ,A.PREPK_ID                                       22011071
220120                ,A.STATUS_CDE                                     22012071
220130           INTO :PV-VEND-STYL-NAME                                22013071
220140              , :PV-SKU-DESC                                      22014071
220150              , :PV-SIZE-DESC                                     22015071
220160              , :PV-COLOR-DESC                                    22016071
220170              , :PV-ITM-NBR                                       22017071
220180              , :PURITM-UNT-RTL-PR-AMT                            22018071
220190              , :RECITM-PREPK-ID                                  22019071
220200              , :RECITM-STATUS-CDE                                22020071
220210           FROM TRECITM A                                         22021071
220220               ,TPURITM B                                         22022071
220230          WHERE A.ORD_NBR           = :DK-PO-NBR                  22023071
220240            AND A.REC_SEQ_NBR       = :DK-REC-SEQ-NBR             22024071
220250            AND A.ORD_LNE_NBR       = :DK-LINE-NBR                22025071
220260            AND A.ORD_NBR           = B.PO_NBR                    22026071
220270            AND A.ORD_LNE_NBR       = B.APP_PO_LNE_NBR            22027071
220280            AND A.VER_STATUS_CDE    = 'A'                         22028071
220290            AND B.VER_STATUS_CDE    = 'A'                         22029071
220300     END-EXEC.                                                    22030071
220310                                                                  22031071
220320     EVALUATE TRUE                                                22032071
220330         WHEN SQLCODE = ZERO                                      22033071
220340              MOVE  PURITM-UNT-RTL-PR-AMT  TO  PV-UNIT-RETAIL     22034071
220350         WHEN SQLCODE = -904                                      22035071
220360         WHEN SQLCODE = -913                                      22036071
220370                                                                  22037071
220380             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   22038071
220390             MOVE '4707-GET-HDR-INFO'        TO PV-SOFT-PARAGRAPH 22039071
220400             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 22040071
220410             MOVE LENGTH OF PV-CICS-MSG-AREA2                     22041071
220420               TO PV-COMMAREA-LENGTH                              22042071
220430             EXEC CICS                                            22043071
220440                  WRITEQ TD                                       22044071
220450                   QUEUE  ('CSSL')                                22045071
220460                    FROM  (PV-CICS-MSG-AREA2)                     22046071
220470                  LENGTH  (PV-COMMAREA-LENGTH)                    22047071
220480                    RESP  (PV-CICS-RESP)                          22048071
220490             END-EXEC                                             22049071
220500                                                                  22050071
220510              CONTINUE                                            22051071
220520         WHEN SQLWARN0 NOT = SPACES                               22052071
220530         WHEN SQLCODE < ZERO                                      22053071
220540         WHEN SQLCODE > ZERO                                      22054071
220550              MOVE '4707-GET-HDR-INFO'                            22055071
220560                                     TO DP013-PARAGRAPH           22056071
220570              MOVE 'GET HEADER INFORMATION '                      22057071
220580                                     TO DP013-MESSAGE-TEXT (1)    22058071
220590              MOVE SQLCA             TO DP013-SQLCA               22059071
220600              MOVE 'TPURITM'         TO DP013-DB2-TABLE-NAME (1)  22060071
220610              MOVE 'TRECITM'         TO DP013-DB2-TABLE-NAME (2)  22061071
220620              SET DP013-DB2-ABEND TO TRUE                         22062071
220630              SET DP013-XCTL-DISPLAY-RESTART                      22063071
220640                                     TO TRUE                      22064071
220650              PERFORM DP013-0000-PROCESS-ABEND                    22065071
220660     END-EVALUATE.                                                22066071
220670                                                                  22067071
220680                                                                  22068071
220690*----------------------------------------------------------------*22069071
220700* GET SSCC-18-IND FROM TCOCNTL TABLE TO DETERMINE IF DC IS SET   *22070071
220710* UP TO PROCESS 20 OR 22 DIGIT BARCODES                          *22071071
220720*----------------------------------------------------------------*22072071
220730 4709-GET-TCOCNTL-INFO.                                           22073071
220740                                                                  22074071
220750     MOVE ASC-OPER-UNT-ID  TO  DK-OPER-UNT-ID-3.                  22075071
220760                                                                  22076071
220770     EXEC SQL                                                     22077071
220780          SELECT  SSCC_18_IND                                     22078071
220790            INTO :COCNTL-SSCC-18-IND                              22079071
220800            FROM  TCOCNTL                                         22080071
220810           WHERE  OPER_UNT_ID  = :DK-OPER-UNT-ID-3                22081071
220820     END-EXEC.                                                    22082071
220830                                                                  22083071
220840     EVALUATE TRUE                                                22084071
220850                                                                  22085071
220860         WHEN SQLCODE = +0                                        22086071
220870              CONTINUE                                            22087071
220880         WHEN SQLCODE = -811                                      22088071
220890         WHEN SQLCODE = -904                                      22089071
220900         WHEN SQLCODE = -913                                      22090071
220910              MOVE SQLCODE                   TO PV-SOFT-SQLCODE   22091071
220920              MOVE '4709-GET-TCOCNTL-INFO'   TO PV-SOFT-PARAGRAPH 22092071
220930              MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2 22093071
220940              MOVE LENGTH OF PV-CICS-MSG-AREA2                    22094071
220950                TO PV-COMMAREA-LENGTH                             22095071
220960              EXEC CICS                                           22096071
220970                   WRITEQ TD                                      22097071
220980                    QUEUE  ('CSSL')                               22098071
220990                     FROM  (PV-CICS-MSG-AREA2)                    22099071
221000                   LENGTH  (PV-COMMAREA-LENGTH)                   22100071
221010                     RESP  (PV-CICS-RESP)                         22101071
221020              END-EXEC                                            22102071
221030                                                                  22103071
221040         WHEN SQLWARN0 NOT = SPACES                               22104071
221050         WHEN SQLCODE < +0                                        22105071
221060         WHEN SQLCODE > +0                                        22106071
221070              MOVE '4709-GET-TCOCNTL-INFO'                        22107071
221080                                 TO DP013-PARAGRAPH               22108071
221090              MOVE 'GET OUTER PACK FROM SKU TABLE'                22109071
221100                                 TO DP013-MESSAGE-TEXT (1)        22110071
221110              MOVE SQLCA         TO DP013-SQLCA                   22111071
221120              MOVE 'TCOCNTL'     TO DP013-DB2-TABLE-NAME (1)      22112071
221130              SET DP013-DB2-ABEND                                 22113071
221140                  DP013-XCTL-DISPLAY-RESTART                      22114071
221150                                 TO TRUE                          22115071
221160              PERFORM DP013-0000-PROCESS-ABEND                    22116071
221170     END-EVALUATE.                                                22117071
221180                                                                  22118071
221190                                                                  22119071
221200                                                                  22120071
221210*----------------------------------------------------------------*22121071
221220*  WRITE DATA TO THE TRANSACTION HEADER TABLE.                   *22122071
221230*----------------------------------------------------------------*22123071
221240 4710-WRITE-TRANS-HDR-REC.                                        22124071
221250     INITIALIZE DCLTDISTHD.                                       22125071
221260                                                                  22126071
221270     MOVE PV-PO-NBR               TO  DK-PO-NBR.                  22127071
221280     MOVE PV-REC-SEQ-NBR          TO  DK-REC-SEQ-NBR.             22128071
221290     MOVE PV-PO-LINE-NBR          TO  DK-LINE-NBR.                22129071
221300     MOVE PC-0001                 TO  DK-WORK-ORD-SEQ-NBR.        22130071
221310     MOVE ASC-OPER-UNT-ID         TO  DK-OPER-UNT-ID.             22131071
221320                                                                  22132071
221330     PERFORM 4900-UPDATE-HDR-ZEROES.                              22133071
221340                                                                  22134071
221350     MOVE PV-CARTON-COUNT         TO  DISTHD-TOT-CART-CNT.        22135071
221360                                                                  22136071
221370     IF  PV-P2L-UNIT-CNT    >  ZEROES  AND                        22137071
221380         PV-OUTER-PACK-QTY  >  ZEROES                             22138071
221390         DIVIDE  PV-P2L-UNIT-CNT                                  22139071
221400             BY  PV-OUTER-PACK-QTY                                22140071
221410                 GIVING  PV-P2L-LABEL-CNT ROUNDED                 22141071
221420         IF PV-P2L-LABEL-CNT = 0                                  22142071
221430            MOVE 1 TO PV-P2L-LABEL-CNT                            22143071
221440         END-IF                                                   22144071
221450     END-IF.                                                      22145071
221460                                                                  22146071
221470     MOVE PV-P2L-LABEL-CNT        TO  DISTHD-P2L-CART-CNT.        22147071
221480     MOVE PV-SML-FCSE-LBL-CNT     TO  DISTHD-FCSE-CART-CNT.       22148071
221490     MOVE ASC-MODULE (ASC-BLK-SUB ASC-ITEM-SUB)                   22149071
221500                                  TO  DISTHD-PRC-AREA-MODU-ID.    22150071
221510                                                                  22151071
221520     IF  PV-LBL-TYP-SML                                           22152071
221530         IF  ASC-LBL-PRT-SHUFFLED                                 22153071
221540             MOVE 'S'             TO  DISTHD-FCSE-LBL-TYP-CDE     22154071
221550         END-IF                                                   22155071
221560         IF  ASC-LBL-PRT-STR-ORD                                  22156071
221570             MOVE 'R'             TO  DISTHD-FCSE-LBL-TYP-CDE     22157071
221580         END-IF                                                   22158071
221590         IF  ASC-LBL-PRT-DOOR-SEQ                                 22159071
221600             MOVE 'D'             TO  DISTHD-FCSE-LBL-TYP-CDE     22160071
221610         END-IF                                                   22161071
221620     ELSE                                                         22162071
221630     IF  PV-LBL-TYP-PGYBK                                         22163071
221640         MOVE 'P'             TO  DISTHD-FCSE-LBL-TYP-CDE         22164071
221650     ELSE                                                         22165071
221660     IF  PV-LBL-TYP-NO-PRINT                                      22166071
221670         MOVE 'X'             TO  DISTHD-FCSE-LBL-TYP-CDE         22167071
221680     END-IF                                                       22168071
221690     END-IF                                                       22169071
221700     END-IF.                                                      22170071
221710                                                                  22171071
221720     MOVE PC-F                    TO  DISTHD-SYS-CRE-CDE          22172071
221730     MOVE PV-INNER-PACK-QTY       TO  DISTHD-INPK-UNT-QTY         22173071
221740     MOVE PV-SML-INPK-LBL-CNT     TO  DISTHD-INPK-CART-CNT        22174071
221750     MOVE PV-OUTER-PACK-QTY       TO  DISTHD-OTPK-UNT-QTY         22175071
221760     MOVE PV-IN-PAK-CONVEY        TO  DISTHD-INPK-CNVYB-IND       22176071
221770     MOVE ASC-SPEC-INST-DESC      TO  DISTHD-SPC-INSTR-DESC       22177071
221780                                                                  22178071
221790     MOVE DP020-USERID            TO  DISTHD-CRE-USR-ID           22179071
221800                                                                  22180071
221810     MOVE  PV-MODULE              TO  DISTHD-PRC-AREA-MODU-ID.    22181071
221820     MOVE  PC-DOWNLOADED-STATUS   TO  DISTHD-PRCG-STAT-CDE.       22182071
221830     MOVE  PC-P2L-PROCESSOR       TO  DISTHD-DISTRB-PRC-AREA-ID.  22183071
221840     MOVE  PC-DEFAULT-TIMESTAMP   TO  DISTHD-RSLTS-RCVD-TMST.     22184071
221850     MOVE  PC-DEFAULT-TIMESTAMP   TO  DISTHD-VRFD-TMST.           22185071
221860     MOVE  PC-DEFAULT-TIMESTAMP   TO  DISTHD-FCSE-CNFRMN-TMST.    22186071
221870     IF  PS-DISTHD-UPDATE                                         22187071
221880         MOVE DP020-USERID        TO  DISTHD-CART-DWNLD-USR-ID    22188071
221890     END-IF.                                                      22189071
221900                                                                  22190071
221910     IF  ASC-PRE-PACK-ORDER                                       22191071
221920         MOVE PC-PREPK-P2L-DWNLD  TO  DISTHD-PREPK-LNE-PRC-CDE    22192071
221930     ELSE                                                         22193071
221940         MOVE PC-NON-PREPK        TO  DISTHD-PREPK-LNE-PRC-CDE    22194071
221950     END-IF.                                                      22195071
221960                                                                  22196071
221970                                                                  22197071
221980                                                                  22198071
221990*----------------------------------------------------------------*22199071
222000*  UPDATE TRANSACTION HEADER WITH DISTRIBUTION TOTALS            *22200071
222010*----------------------------------------------------------------*22201071
222020 4715-UPDATE-HEADER.                                              22202071
222030                                                                  22203071
222040     MOVE PV-PO-NBR           TO  DK-PO-NBR.                      22204071
222050     MOVE PV-REC-SEQ-NBR      TO  DK-REC-SEQ-NBR.                 22205071
222060     MOVE PV-PO-LINE-NBR      TO  DK-LINE-NBR.                    22206071
222070                                                                  22207071
222080     MOVE  ZEROES  TO  PV-P2L-LABEL-CNT.                          22208071
222090                                                                  22209071
222100     IF  LQW-LNE-CRE-P2L-LBL (LQW-IDX)                            22210071
222110         MOVE  LQW-CARTON-CNT (LQW-IDX)                           22211071
222120           TO  PV-P2L-LABEL-CNT                                   22212071
222130     END-IF.                                                      22213071
222140                                                                  22214071
222150     IF  PV-P2L-UNIT-CNT    >  ZEROES  AND                        22215071
222160         PV-OUTER-PACK-QTY  >  ZEROES  AND                        22216071
222170         LQW-ODD-CRTN-P2L (LQW-IDX)                               22217071
222180         SUBTRACT  LQW-ODD-CARTON (LQW-IDX)                       22218071
222190             FROM  PV-P2L-UNIT-CNT                                22219071
222200           GIVING  PV-P2L-UNITS-AFTER-ODD                         22220071
222210         IF  PV-P2L-UNITS-AFTER-ODD  >  0                         22221071
222220             DIVIDE  PV-P2L-UNITS-AFTER-ODD                       22222071
222230                 BY  PV-OUTER-PACK-QTY                            22223071
222240             GIVING  PV-P2L-LABEL-CNT ROUNDED                     22224071
222250             ADD  1  TO  PV-P2L-LABEL-CNT                         22225071
222260         END-IF                                                   22226071
222270         IF  PV-P2L-UNITS-AFTER-ODD  =  0                         22227071
222280             MOVE 1  TO  PV-P2L-LABEL-CNT                         22228071
222290         END-IF                                                   22229071
222300         IF PV-P2L-LABEL-CNT = 0                                  22230071
222310            MOVE 1    TO PV-P2L-LABEL-CNT                         22231071
222320         END-IF                                                   22232071
222330     ELSE                                                         22233071
222340     IF  PV-P2L-UNIT-CNT    >  ZEROES  AND                        22234071
222350         PV-OUTER-PACK-QTY  >  ZEROES                             22235071
222360         DIVIDE  PV-P2L-UNIT-CNT                                  22236071
222370             BY  PV-OUTER-PACK-QTY                                22237071
222380                 GIVING  PV-P2L-LABEL-CNT ROUNDED                 22238071
222390         IF PV-P2L-LABEL-CNT = 0                                  22239071
222400            MOVE 1    TO PV-P2L-LABEL-CNT                         22240071
222410         END-IF                                                   22241071
222420     END-IF                                                       22242071
222430     END-IF.                                                      22243071
222440                                                                  22244071
222450     MOVE PV-P2L-LABEL-CNT        TO  DISTHD-P2L-CART-CNT.        22245071
222460     MOVE PV-SML-FCSE-LBL-CNT     TO  DISTHD-FCSE-CART-CNT        22246071
222470     MOVE PV-INNER-PACK-QTY       TO  DISTHD-INPK-UNT-QTY         22247071
222480     MOVE PV-SML-INPK-LBL-CNT     TO  DISTHD-INPK-CART-CNT        22248071
222490     MOVE PV-OUTER-PACK-QTY       TO  DISTHD-OTPK-UNT-QTY         22249071
222500     MOVE PV-MODULE               TO  DISTHD-PRC-AREA-MODU-ID     22250071
222510                                                                  22251071
222520     MOVE LQW-LNE-FCSE-AREA(LQW-IDX)                              22252071
222530                                    TO DISTHD-FCSE-FCLTY-AREA-ID. 22253071
222540     MOVE LQW-ODD-CARTON(LQW-IDX)                                 22254071
222550                                    TO DISTHD-ODD-CART-UNT-QTY.   22255071
222560     MOVE LQW-LNE-CRE-LBL-OPT(LQW-IDX)                            22256071
222570                                    TO DISTHD-CRE-LBL-OPT-CDE.    22257071
222580     MOVE LQW-PROCESS-QTY (LQW-IDX)                               22258071
222590                                    TO  DISTHD-CAL-UNT-PRCD-QTY   22259071
222600     IF   LQW-LNE-UCC128-YES (LQW-IDX)                            22260071
222610          MOVE  PC-U                TO  DISTHD-UCC128-DAT-USG-CDE 22261071
222620     ELSE                                                         22262071
222630     IF   LQW-LNE-UCC128-IGNORE (LQW-IDX)                         22263071
222640          MOVE  PC-I                TO  DISTHD-UCC128-DAT-USG-CDE 22264071
222650     ELSE                                                         22265071
222660          MOVE  PC-N                TO  DISTHD-UCC128-DAT-USG-CDE 22266071
222670     END-IF                                                       22267071
222680     END-IF.                                                      22268071
222690                                                                  22269071
222700     IF  LQW-LNE-UCC128-YES (LQW-IDX)                             22270071
222710         IF  LQW-MLT-OTPK-UCC128 (LQW-IDX)                        22271071
222720             MOVE  ZEROES  TO  DISTHD-OTPK-UNT-QTY                22272071
222730         ELSE                                                     22273071
222740             MOVE  LQW-OUTER-PACK (LQW-IDX)                       22274071
222750                           TO  DISTHD-OTPK-UNT-QTY                22275071
222760         END-IF                                                   22276071
222770     END-IF.                                                      22277071
222780                                                                  22278071
222790     MOVE  ZEROES              TO  DISTHD-P2L-SCN-CART-CNT        22279071
222800                                                                  22280071
222810     IF  PS-DISTHD-UPDATE                                         22281071
222820         PERFORM 4718-UPDATE-HEADER-NO-CNFRM                      22282071
222830     ELSE                                                         22283071
222840     IF  PS-DISTHD-INSERT                                         22284071
222850         PERFORM 4719-INSERT-HEADER-NO-CNFRM                      22285071
222860     END-IF                                                       22286071
222870     END-IF.                                                      22287071
222880                                                                  22288071
222890                                                                  22289071
222900*----------------------------------------------------------------*22290071
222910*  HEADER UPDATE SQL - WITH NO AUTO CONFIRM/VERIFY               *22291071
222920*----------------------------------------------------------------*22292071
222930 4718-UPDATE-HEADER-NO-CNFRM.                                     22293071
222940                                                                  22294071
222950     MOVE DP020-USERID            TO DISTHD-CART-DWNLD-USR-ID.    22295071
222960     MOVE PV-CARTON-COUNT         TO DISTHD-TOT-CART-CNT.         22296071
222970     MOVE ASC-OPER-UNT-ID         TO DISTHD-OPER-UNT-ID.          22297071
222980                                                                  22298071
222990     PERFORM 4725-GET-PRCS-COUNTS.                                22299071
223000     IF  LQW-LNE-UCC128-YES (LQW-IDX)                             22300071
223100         ADD  1  TO  DISTHD-VRTL-LBL-PRC-CNT                      22310071
223110     ELSE                                                         22311071
223120         ADD  1  TO  DISTHD-PHY-LBL-PRC-CNT                       22312071
223130     END-IF.                                                      22313071
223140                                                                  22314071
223150                                                                  22315071
223160     EXEC SQL                                                     22316071
223170          UPDATE TDISTHD                                          22317071
223180             SET                                                  22318071
223190                 TOT_CART_CNT        = :DISTHD-TOT-CART-CNT       22319071
223200               , P2L_CART_CNT        = :DISTHD-P2L-CART-CNT       22320071
223210               , INPK_UNT_QTY        = :DISTHD-INPK-UNT-QTY       22321071
223220               , OTPK_UNT_QTY        = :DISTHD-OTPK-UNT-QTY       22322071
223230               , CART_DWNLD_USR_ID   = :DISTHD-CART-DWNLD-USR-ID  22323071
223240               , FCSE_CART_CNT       = :DISTHD-FCSE-CART-CNT      22324071
223250               , INPK_CART_CNT       = :DISTHD-INPK-CART-CNT      22325071
223260               , PRC_AREA_MODU_ID    = :DISTHD-PRC-AREA-MODU-ID   22326071
223270               , PRCG_STAT_CDE       = :DISTHD-PRCG-STAT-CDE      22327071
223280               , CRE_USR_ID          = :DP020-USERID              22328071
223290               , CART_DWNLD_DTE      =  CURRENT DATE              22329071
223300               , CART_DWNLD_TM       =  CURRENT TIME              22330071
223310               , FCSE_LBL_TYP_CDE    = :DISTHD-FCSE-LBL-TYP-CDE   22331071
223320               , INPK_CNVYB_IND      = :DISTHD-INPK-CNVYB-IND     22332071
223330               , SYS_CRE_CDE         = :DISTHD-SYS-CRE-CDE        22333071
223340               , CRE_TMST            =  CURRENT TIMESTAMP         22334071
223350               , FCSE_FCLTY_AREA_ID  = :DISTHD-FCSE-FCLTY-AREA-ID 22335071
223360               , CRE_LBL_OPT_CDE     = :DISTHD-CRE-LBL-OPT-CDE    22336071
223370               , ODD_CART_UNT_QTY    = :DISTHD-ODD-CART-UNT-QTY   22337071
223380               , PREPK_LNE_PRC_CDE   = :DISTHD-PREPK-LNE-PRC-CDE  22338071
223390               , CAL_UNT_PRCD_QTY    = :DISTHD-CAL-UNT-PRCD-QTY   22339071
223400               , UCC128_DAT_USG_CDE  = :DISTHD-UCC128-DAT-USG-CDE 22340071
223410               , P2L_SCN_CART_CNT    = :DISTHD-P2L-SCN-CART-CNT   22341071
223420               , OPER_UNT_ID         = :DISTHD-OPER-UNT-ID        22342071
223430               , PHY_LBL_PRC_CNT     = :DISTHD-PHY-LBL-PRC-CNT    22343071
223440               , VRTL_LBL_PRC_CNT    = :DISTHD-VRTL-LBL-PRC-CNT   22344071
223450           WHERE ORD_NBR             = :DK-PO-NBR                 22345071
223460             AND RCVR_SEQ_NBR        = :DK-REC-SEQ-NBR            22346071
223470             AND ORD_LNE_NBR         = :DK-LINE-NBR               22347071
223480     END-EXEC.                                                    22348071
223490                                                                  22349071
223500     EVALUATE TRUE                                                22350071
223510         WHEN SQLCODE = ZERO                                      22351071
223520         WHEN SQLCODE = +100                                      22352071
223530              CONTINUE                                            22353071
223540         WHEN SQLCODE = -904                                      22354071
223550         WHEN SQLCODE = -911                                      22355071
223560         WHEN SQLCODE = -913                                      22356071
223570                                                                  22357071
223580             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   22358071
223590             MOVE '4718-UPDATE-HEADER-NO-CNFRM'                   22359071
223600                                             TO PV-SOFT-PARAGRAPH 22360071
223610             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 22361071
223620             MOVE LENGTH OF PV-CICS-MSG-AREA2                     22362071
223630               TO PV-COMMAREA-LENGTH                              22363071
223640             EXEC CICS                                            22364071
223650                  WRITEQ TD                                       22365071
223660                   QUEUE  ('CSSL')                                22366071
223670                    FROM  (PV-CICS-MSG-AREA2)                     22367071
223680                  LENGTH  (PV-COMMAREA-LENGTH)                    22368071
223690                    RESP  (PV-CICS-RESP)                          22369071
223700             END-EXEC                                             22370071
223710                                                                  22371071
223720              MOVE  PC-TSYMSG-00551  TO  DP020-MSG-NUMBER         22372071
223730              PERFORM 9900-SOFT-ABORT                             22373071
223740         WHEN SQLWARN0 NOT = SPACES                               22374071
223750         WHEN SQLCODE NOT EQUAL ZERO                              22375071
223760              MOVE '4718-UPDATE-HEADER-NO-CNFRM'                  22376071
223770                                   TO DP013-PARAGRAPH             22377071
223780              MOVE 'UPDATE COUNTS IN TRANS HEADER ROW'            22378071
223790                                   TO DP013-MESSAGE-TEXT (1)      22379071
223800              MOVE SQLCA           TO DP013-SQLCA                 22380071
223810              MOVE 'TDISTHD'       TO DP013-DB2-TABLE-NAME (1)    22381071
223820              SET DP013-DB2-ABEND  TO TRUE                        22382071
223830              PERFORM DP013-0000-PROCESS-ABEND                    22383071
223840     END-EVALUATE.                                                22384071
223850                                                                  22385071
223860                                                                  22386071
223870*----------------------------------------------------------------*22387071
223880*  INSERT UPDATE SQL - WITH NO AUTO CONFIRM/VERIFY               *22388071
223890*----------------------------------------------------------------*22389071
223900 4719-INSERT-HEADER-NO-CNFRM.                                     22390071
223910                                                                  22391071
223920     MOVE  PC-DEFAULT-TIMESTAMP  TO  DISTHD-FCSE-CNFRMN-TMST.     22392071
223930     MOVE  PC-DEFAULT-TIMESTAMP  TO  DISTHD-DLT-REQ-TMST.         22393071
223940                                                                  22394071
223950     IF  LQW-LNE-UCC128-YES (LQW-IDX)                             22395071
223960         move 1  TO  DISTHD-VRTL-LBL-PRC-CNT                      22396071
223970     ELSE                                                         22397071
223980         move 1  TO  DISTHD-PHY-LBL-PRC-CNT                       22398071
223990     END-IF.                                                      22399071
224000                                                                  22400071
224010     EXEC SQL                                                     22401071
224020          INSERT INTO TDISTHD                                     22402071
224030           ( ORD_NBR                                              22403071
224040            ,RCVR_SEQ_NBR                                         22404071
224050            ,ORD_LNE_NBR                                          22405071
224060            ,WRK_ORD_SEQ_NBR                                      22406071
224070            ,OPER_UNT_ID                                          22407071
224080            ,DISTRB_PRC_AREA_ID                                   22408071
224090            ,PRCG_STAT_CDE                                        22409071
224100            ,CRE_TMST                                             22410071
224110            ,RSLTS_RCVD_TMST                                      22411071
224120            ,VRFD_TMST                                            22412071
224130            ,PRC_AREA_MODU_ID                                     22413071
224140            ,CRE_USR_ID                                           22414071
224150            ,TOT_CART_CNT                                         22415071
224160            ,CART_DWNLD_DTE                                       22416071
224170            ,CART_DWNLD_TM                                        22417071
224180            ,CART_DWNLD_USR_ID                                    22418071
224190            ,FCSE_CART_CNT                                        22419071
224200            ,FCSE_LBL_TYP_CDE                                     22420071
224210            ,P2L_CART_CNT                                         22421071
224220            ,INPK_CART_CNT                                        22422071
224230            ,INPK_UNT_QTY                                         22423071
224240            ,INPK_CNVYB_IND                                       22424071
224250            ,OTPK_UNT_QTY                                         22425071
224260            ,SYS_CRE_CDE                                          22426071
224270            ,SPC_INSTR_DESC                                       22427071
224280            ,FCSE_CNFRMN_TMST                                     22428071
224290            ,FCSE_FCLTY_AREA_ID                                   22429071
224300            ,CRE_LBL_OPT_CDE                                      22430071
224310            ,ODD_CART_UNT_QTY                                     22431071
224320            ,DLT_REQ_TMST                                         22432071
224330            ,PREPK_LNE_PRC_CDE                                    22433071
224340            ,CAL_UNT_PRCD_QTY                                     22434071
224350            ,UCC128_DAT_USG_CDE                                   22435071
224360            ,P2L_SCN_CART_CNT                                     22436071
224370            ,PHY_LBL_PRC_CNT                                      22437071
224380            ,VRTL_LBL_PRC_CNT                                     22438071
224390           )                                                      22439071
224400         VALUES (                                                 22440071
224410             :DK-PO-NBR                                           22441071
224420           , :DK-REC-SEQ-NBR                                      22442071
224430           , :DK-LINE-NBR                                         22443071
224440           , :DK-WORK-ORD-SEQ-NBR                                 22444071
224450           , :DK-OPER-UNT-ID                                      22445071
224460           , :DISTHD-DISTRB-PRC-AREA-ID                           22446071
224470           , :DISTHD-PRCG-STAT-CDE                                22447071
224480           ,  CURRENT TIMESTAMP                                   22448071
224490           , :DISTHD-RSLTS-RCVD-TMST                              22449071
224500           , :DISTHD-VRFD-TMST                                    22450071
224510           , :DISTHD-PRC-AREA-MODU-ID                             22451071
224520           , :DISTHD-CRE-USR-ID                                   22452071
224530           , :DISTHD-TOT-CART-CNT                                 22453071
224540           ,  CURRENT DATE                                        22454071
224550           ,  CURRENT TIME                                        22455071
224560           , :DP020-USERID                                        22456071
224570           , :DISTHD-FCSE-CART-CNT                                22457071
224580           , :DISTHD-FCSE-LBL-TYP-CDE                             22458071
224590           , :DISTHD-P2L-CART-CNT                                 22459071
224600           , :DISTHD-INPK-CART-CNT                                22460071
224610           , :DISTHD-INPK-UNT-QTY                                 22461071
224620           , :DISTHD-INPK-CNVYB-IND                               22462071
224630           , :DISTHD-OTPK-UNT-QTY                                 22463071
224640           , :DISTHD-SYS-CRE-CDE                                  22464071
224650           , :DISTHD-SPC-INSTR-DESC                               22465071
224660           , :DISTHD-FCSE-CNFRMN-TMST                             22466071
224670           , :DISTHD-FCSE-FCLTY-AREA-ID                           22467071
224680           , :DISTHD-CRE-LBL-OPT-CDE                              22468071
224690           , :DISTHD-ODD-CART-UNT-QTY                             22469071
224700           , :DISTHD-DLT-REQ-TMST                                 22470071
224710           , :DISTHD-PREPK-LNE-PRC-CDE                            22471071
224720           , :DISTHD-CAL-UNT-PRCD-QTY                             22472071
224730           , :DISTHD-UCC128-DAT-USG-CDE                           22473071
224740           , :DISTHD-P2L-SCN-CART-CNT                             22474071
224750           , :DISTHD-PHY-LBL-PRC-CNT                              22475071
224760           , :DISTHD-VRTL-LBL-PRC-CNT                             22476071
224770         )                                                        22477071
224780     END-EXEC.                                                    22478071
224790                                                                  22479071
224800     EVALUATE TRUE                                                22480071
224810         WHEN SQLCODE = ZERO                                      22481071
224820              CONTINUE                                            22482071
224830         WHEN SQLCODE = -904                                      22483071
224840         WHEN SQLCODE = -911                                      22484071
224850         WHEN SQLCODE = -913                                      22485071
224860                                                                  22486071
224870             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   22487071
224880             MOVE '4719-INSERT-HEADER-NO-CNFRM'                   22488071
224890                                             TO PV-SOFT-PARAGRAPH 22489071
224900             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 22490071
224910             MOVE LENGTH OF PV-CICS-MSG-AREA2                     22491071
224920               TO PV-COMMAREA-LENGTH                              22492071
224930             EXEC CICS                                            22493071
224940                  WRITEQ TD                                       22494071
224950                   QUEUE  ('CSSL')                                22495071
224960                    FROM  (PV-CICS-MSG-AREA2)                     22496071
224970                  LENGTH  (PV-COMMAREA-LENGTH)                    22497071
224980                    RESP  (PV-CICS-RESP)                          22498071
224990             END-EXEC                                             22499071
225000                                                                  22500071
225010              MOVE  PC-TSYMSG-00551  TO  DP020-MSG-NUMBER         22501071
225020              PERFORM 9900-SOFT-ABORT                             22502071
225030         WHEN SQLWARN0 NOT = SPACES                               22503071
225040         WHEN SQLCODE NOT EQUAL ZERO                              22504071
225050              MOVE '4719-INSERT-HEADER-NO-CNFRM'                  22505071
225060                                   TO DP013-PARAGRAPH             22506071
225070              MOVE 'INSERT TRANSACTION HEADER ROW'                22507071
225080                                   TO DP013-MESSAGE-TEXT (1)      22508071
225090              MOVE SQLCA           TO DP013-SQLCA                 22509071
225100              MOVE 'TDISTHD'       TO DP013-DB2-TABLE-NAME (1)    22510071
225110              SET DP013-DB2-ABEND  TO TRUE                        22511071
225120              PERFORM DP013-0000-PROCESS-ABEND                    22512071
225130     END-EVALUATE.                                                22513071
225140                                                                  22514071
225150                                                                  22515071
225160*----------------------------------------------------------------*22516071
225170*  SELECT THE COUNTS FROM THE HEADER TABLE TO DETERMINE HOW      *22517071
225180*  MANY TIMES A LINE HAS BEEN PROCESSED USING UCC128 DATA AND    *22518071
225190*  PHYSICAL LABELS                                               *22519071
225200*----------------------------------------------------------------*22520071
225210 4725-GET-PRCS-COUNTS.                                            22521071
225220                                                                  22522071
225230     EXEC SQL                                                     22523071
225240          SELECT  PHY_LBL_PRC_CNT                                 22524071
225250                 ,VRTL_LBL_PRC_CNT                                22525071
225260          INTO    :DISTHD-PHY-LBL-PRC-CNT                         22526071
225270                 ,:DISTHD-VRTL-LBL-PRC-CNT                        22527071
225280          FROM    TDISTHD                                         22528071
225290          WHERE   ORD_NBR       = :DK-PO-NBR                      22529071
225300            AND   RCVR_SEQ_NBR  = :DK-REC-SEQ-NBR                 22530071
225310            AND   ORD_LNE_NBR   = :DK-LINE-NBR                    22531071
225320     END-EXEC.                                                    22532071
225330                                                                  22533071
225340     EVALUATE TRUE                                                22534071
225350         WHEN SQLCODE = ZERO                                      22535071
225360              CONTINUE                                            22536071
225370         WHEN SQLCODE = -904                                      22537071
225380         WHEN SQLCODE = -911                                      22538071
225390         WHEN SQLCODE = -913                                      22539071
225400                                                                  22540071
225410             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   22541071
225420             MOVE '4725-GET-PRCS-COUNTS'                          22542071
225430                                             TO PV-SOFT-PARAGRAPH 22543071
225440             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 22544071
225450             MOVE LENGTH OF PV-CICS-MSG-AREA2                     22545071
225460               TO PV-COMMAREA-LENGTH                              22546071
225470             EXEC CICS                                            22547071
225480                  WRITEQ TD                                       22548071
225490                   QUEUE  ('CSSL')                                22549071
225500                    FROM  (PV-CICS-MSG-AREA2)                     22550071
225510                  LENGTH  (PV-COMMAREA-LENGTH)                    22551071
225520                    RESP  (PV-CICS-RESP)                          22552071
225530             END-EXEC                                             22553071
225540                                                                  22554071
225550              MOVE  PC-TSYMSG-00551  TO  DP020-MSG-NUMBER         22555071
225560              PERFORM 9900-SOFT-ABORT                             22556071
225570                                                                  22557071
225580         WHEN SQLWARN0 NOT = SPACES                               22558071
225590         WHEN SQLCODE NOT EQUAL ZERO                              22559071
225600              MOVE '4725-GET-PRCS-COUNTS'                         22560071
225610                                   TO DP013-PARAGRAPH             22561071
225620              MOVE 'GET LABEL PROCESS COUNTS'                     22562071
225630                                   TO DP013-MESSAGE-TEXT (1)      22563071
225640              MOVE SQLCA           TO DP013-SQLCA                 22564071
225650              MOVE 'TDISTHD'       TO DP013-DB2-TABLE-NAME (1)    22565071
225660              SET DP013-DB2-ABEND  TO TRUE                        22566071
225670              PERFORM DP013-0000-PROCESS-ABEND                    22567071
225680     END-EVALUATE.                                                22568071
225690                                                                  22569071
225700                                                                  22570071
225710                                                                  22571071
225720                                                                  22572071
225730                                                                  22573071
225740                                                                  22574071
225750                                                                  22575071
225760                                                                  22576071
225770                                                                  22577071
225780*----------------------------------------------------------------*22578071
225790*  DOWNLOAD THE DETAIL DATA TO AL SYSTEMS.                       *22579071
225800*----------------------------------------------------------------*22580071
225900 4740-BLD-DTL-REC.                                                22590071
225910                                                                  22591071
225920     INITIALIZE PC053-DISTRO-RECORD.                              22592071
225930     INITIALIZE PC184-DISTRO-RECORD.                              22593071
225940                                                                  22594071
225950     SET  PC053-DISTRO-DTL      TO  TRUE                          22595071
225960     SET  PC184-DISTRO-DTL      TO  TRUE                          22596071
225970                                                                  22597071
225980     MOVE PV-PO-NBR-8           TO  PC053-DTL-ORD-NBR             22598071
225990                                    PC184-DTL-ORD-NBR.            22599071
226000     MOVE PV-REC-SEQ-NBR-3      TO  PC053-DTL-RCVR-SEQ-NBR        22600071
226010                                    PC184-DTL-RCVR-SEQ-NBR.       22601071
226020     MOVE PV-PO-LINE-NBR-X      TO  PC053-DTL-ORD-LNE-NBR         22602071
226030                                    PC184-DTL-ORD-LNE-NBR.        22603071
226040     MOVE PC-0001               TO  PC053-DTL-WORK-ORD-SEQ-NBR    22604071
226050                                    PC184-DTL-WORK-ORD-SEQ-NBR    22605071
226060                                    DK-WORK-ORD-SEQ-NBR.          22606071
226070     MOVE ZEROES                TO  PC053-DTL-WO-INS-SEQ-NBR      22607071
226080                                    PC184-DTL-WO-INS-SEQ-NBR.     22608071
226090                                                                  22609071
226100     IF  PS-LABEL-SELECTION-P2L                                   22610071
226110         PERFORM 4745-OPEN-RECDIS-CURSOR                          22611071
226120         IF  PS-NO-SOFT-ABORT-ERROR                               22612071
226130           MOVE  ZEROES  TO  PV-FULL-CASE-SHIP-TOTAL              22613071
226140                             PV-INPK-SHIP-LNE-TOTAL               22614071
226150           PERFORM 4750-FETCH-RECDIS-CURSOR                       22615071
226160             IF  PS-NO-SOFT-ABORT-ERROR                           22616071
226170             MOVE  ZEROES  TO  PV-STR-RECS-SENT                   22617071
226180             PERFORM                                              22618071
226190                 UNTIL SQLCODE = +100                             22619071
226200                    OR PS-SOFT-ABORT-ERROR                        22620071
226210                 MOVE  RECDIS-EXPTED-ITM-QTY  TO  PV-P2L-UNITS    22621071
226220                                                                  22622071
226230                 IF  LQW-P2L-LBL-CNT (LQW-IDX)  >  0              22623071
226240                                                                  22624071
226250                     PERFORM 4755-SEND-REC-ITM-DISTRO-RECS        22625071
226260                 END-IF                                           22626071
226270                                                                  22627071
226280                 INITIALIZE DISTDT-P2L-SPLT-UNT-QTY               22628071
226290                            DISTDT-FCSE-SPLT-UNT-QTY              22629071
226300                            DISTDT-INPK-SPLT-UNT-QTY              22630071
226310                            DISTDT-FCSE-ACTL-UNT-QTY              22631071
226320                                                                  22632071
226330                 IF  PS-VALID-STORE                               22633071
226340                     MOVE  RECDIS-EXPTED-ITM-QTY                  22634071
226350                       TO  DISTDT-P2L-SPLT-UNT-QTY                22635071
226360                 ELSE                                             22636071
226370                     MOVE  RECDIS-EXPTED-ITM-QTY                  22637071
226380                       TO  DISTDT-P2L-SPLT-UNT-QTY                22638071
226390                           DISTDT-EXPTED-ALLOC-QTY                22639071
226400                           DISTDT-ACTL-ALLOC-QTY                  22640071
226410                 END-IF                                           22641071
226420                                                                  22642071
226430                 SET  PS-DISTDT-INVALID-INSERT  TO  TRUE          22643071
226440                 PERFORM 4765-INSERT-TRANS-DTL-REC                22644071
226450                   UNTIL  PS-DISTDT-VALID-INSERT  OR              22645071
226460                          PS-ERROR        OR                      22646071
226470                          PS-SOFT-ABORT-ERROR                     22647071
226480                 IF  PS-NO-SOFT-ABORT-ERROR                       22648071
226490                     IF  ASC-PRE-PACK-ORDER                       22649071
226500                         SET  PS-PREPK-LINES-LEFT TO TRUE         22650071
226510                         PERFORM 8105-QTY-RATIOS                  22651071
226520                         PERFORM 8100-PREPK-DISTRO                22652071
226530                           UNTIL PS-NO-PREPK-LINES-LEFT           22653071
226540                              OR PS-SOFT-ABORT-ERROR              22654071
226550                         SET  PS-PREPK-LINES-LEFT TO TRUE         22655071
226560                    END-IF                                        22656071
226570                 END-IF                                           22657071
226580                 IF  PS-NO-SOFT-ABORT-ERROR                       22658071
226590                     PERFORM 4750-FETCH-RECDIS-CURSOR             22659071
226600                 END-IF                                           22660071
226610             END-PERFORM                                          22661071
226620           END-IF                                                 22662071
226630         END-IF                                                   22663071
226640                                                                  22664071
226650         IF  PS-NO-SOFT-ABORT-ERROR                               22665071
226660             PERFORM 4760-CLOSE-RECDIS-CURSOR                     22666071
226670         END-IF                                                   22667071
226680                                                                  22668071
226690     END-IF.                                                      22669071
226700                                                                  22670071
226710                                                                  22671071
226720*----------------------------------------------------------------*22672071
226730*  DOWNLOAD THE DETAIL DATA TO AL SYSTEMS.                       *22673071
226740*  USED FOR CREATE LABEL OPTION - BOTH / NOT CENTRAL STOCK       *22674071
226750*----------------------------------------------------------------*22675071
226760 4742-BLD-DTL-REC-CENTRL-STK.                                     22676071
226770                                                                  22677071
226780     INITIALIZE PC053-DISTRO-RECORD                               22678071
226790     INITIALIZE PC184-DISTRO-RECORD.                              22679071
226800     SET  PC053-DISTRO-DTL      TO  TRUE.                         22680071
226810     SET  PC184-DISTRO-DTL      TO  TRUE.                         22681071
226820     MOVE PV-PO-NBR-8           TO  PC053-DTL-ORD-NBR             22682071
226830                                    PC184-DTL-ORD-NBR.            22683071
226840     MOVE PV-REC-SEQ-NBR-3      TO  PC053-DTL-RCVR-SEQ-NBR        22684071
226850                                    PC184-DTL-RCVR-SEQ-NBR.       22685071
226860     MOVE PV-PO-LINE-NBR-X      TO  PC053-DTL-ORD-LNE-NBR         22686071
226870                                    PC184-DTL-ORD-LNE-NBR.        22687071
226880     MOVE PC-0001               TO  PC053-DTL-WORK-ORD-SEQ-NBR    22688071
226890                                    PC184-DTL-WORK-ORD-SEQ-NBR    22689071
226900                                    DK-WORK-ORD-SEQ-NBR.          22690071
226910     MOVE ZEROES                TO  PC053-DTL-WO-INS-SEQ-NBR      22691071
226920                                    PC184-DTL-WO-INS-SEQ-NBR.     22692071
226930                                                                  22693071
226940     IF  PS-LABEL-SELECTION-BOTH                                  22694071
226950                                                                  22695071
226960         SET PS-CHECK-STORE TO TRUE                               22696071
226970         PERFORM VARYING STORE-INX FROM 1 BY 1                    22697071
226980           UNTIL PS-INVALID-STORE                                 22698071
226990              OR PS-VALID-STORE                                   22699071
227000               IF RECDIS-STR-NBR = TBL-STORE-NBR-NUM (STORE-INX)  22700071
227010                  SET PS-INVALID-STORE TO TRUE                    22701071
227020               END-IF                                             22702071
227030               IF STORE-INX = PV-INVALID-STORE-ENTRIES            22703071
227040                       AND PS-CHECK-STORE                         22704071
227050                   SET PS-VALID-STORE TO TRUE                     22705071
227060               END-IF                                             22706071
227070         END-PERFORM                                              22707071
227080         IF PS-VALID-STORE                                        22708071
227090            IF  PV-CARTON-COUNT > ZEROES                          22709071
227100                ADD 1 TO PV-STR-CNT                               22710071
227110                MOVE  DISTDT-P2L-SPLT-UNT-QTY  TO  PV-P2L-UNITS   22711071
227120                                                                  22712071
227130                IF  LQW-P2L-LBL-CNT (LQW-IDX)  >  0               22713071
227140                    PERFORM 4755-SEND-REC-ITM-DISTRO-RECS         22714071
227150                END-IF                                            22715071
227160                                                                  22716071
227170             END-IF                                               22717071
227180         END-IF                                                   22718071
227190         SET  PS-DISTDT-INVALID-INSERT  TO  TRUE                  22719071
227200         PERFORM 4765-INSERT-TRANS-DTL-REC                        22720071
227210           UNTIL  PS-DISTDT-VALID-INSERT  OR                      22721071
227220                  PS-ERROR        OR                              22722071
227230                  PS-SOFT-ABORT-ERROR                             22723071
227240         IF  PS-NO-SOFT-ABORT-ERROR                               22724071
227250             IF  ASC-PRE-PACK-ORDER                               22725071
227260                 SET  PS-PREPK-LINES-LEFT TO TRUE                 22726071
227270                 PERFORM 8105-QTY-RATIOS                          22727071
227280                 PERFORM 8100-PREPK-DISTRO                        22728071
227290                   UNTIL PS-NO-PREPK-LINES-LEFT                   22729071
227300                      OR PS-SOFT-ABORT-ERROR                      22730071
227310                 SET  PS-PREPK-LINES-LEFT TO TRUE                 22731071
227320             END-IF                                               22732071
227330         END-IF                                                   22733071
227340     END-IF.                                                      22734071
227350                                                                  22735071
227360*----------------------------------------------------------------*22736071
227370*                                                                *22737071
227380*----------------------------------------------------------------*22738071
227390 4745-OPEN-RECDIS-CURSOR.                                         22739071
227400     EXEC SQL                                                     22740071
227410         OPEN RECDIS_CURSOR                                       22741071
227420     END-EXEC.                                                    22742071
227430                                                                  22743071
227440     EVALUATE TRUE                                                22744071
227450         WHEN SQLCODE = ZERO                                      22745071
227460             SET  PS-EOF-RECDIS-CURSOR-NO  TO  TRUE               22746071
227470         WHEN SQLCODE = -904                                      22747071
227480         WHEN SQLCODE = -911                                      22748071
227490         WHEN SQLCODE = -913                                      22749071
227500                                                                  22750071
227510             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   22751071
227520             MOVE '4745-OPEN-RECDIS-CURSOR'  TO PV-SOFT-PARAGRAPH 22752071
227530             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 22753071
227540             MOVE LENGTH OF PV-CICS-MSG-AREA2                     22754071
227550               TO PV-COMMAREA-LENGTH                              22755071
227560             EXEC CICS                                            22756071
227570                  WRITEQ TD                                       22757071
227580                   QUEUE  ('CSSL')                                22758071
227590                    FROM  (PV-CICS-MSG-AREA2)                     22759071
227600                  LENGTH  (PV-COMMAREA-LENGTH)                    22760071
227610                    RESP  (PV-CICS-RESP)                          22761071
227620             END-EXEC                                             22762071
227630                                                                  22763071
227640              MOVE  PC-TSYMSG-01767  TO  DP020-MSG-NUMBER         22764071
227650              PERFORM 9900-SOFT-ABORT                             22765071
227660         WHEN SQLWARN0 NOT = SPACE                                22766071
227670         WHEN SQLCODE < ZERO                                      22767071
227680         WHEN SQLCODE > ZERO                                      22768071
227690             MOVE '4745-OPEN-RECDIS-CURSOR'                       22769071
227700                                     TO DP013-PARAGRAPH           22770071
227710             MOVE 'OPEN THE RECDIS_CURSOR'                        22771071
227720                                     TO DP013-MESSAGE-TEXT (1)    22772071
227730             MOVE SQLCA              TO DP013-SQLCA               22773071
227740             MOVE 'TRECDIS'          TO DP013-DB2-TABLE-NAME (1)  22774071
227750             SET DP013-DB2-ABEND     TO TRUE                      22775071
227760             SET DP013-NO-ROLLBACK   TO TRUE                      22776071
227770             SET DP013-XCTL-DISPLAY-RESTART                       22777071
227780                                     TO TRUE                      22778071
227790             PERFORM DP013-0000-PROCESS-ABEND                     22779071
227800     END-EVALUATE.                                                22780071
227810                                                                  22781071
227820                                                                  22782071
227830*----------------------------------------------------------------*22783071
227840*                                                                *22784071
227850*----------------------------------------------------------------*22785071
227860 4750-FETCH-RECDIS-CURSOR.                                        22786071
227870     INITIALIZE DCLTRECDIS.                                       22787071
227880                                                                  22788071
227890     EXEC SQL                                                     22789071
227900         FETCH RECDIS_CURSOR                                      22790071
227910         INTO  :RECDIS-STR-NBR,                                   22791071
227920               :RECDIS-EXPTED-ITM-QTY                             22792071
227930     END-EXEC.                                                    22793071
227940                                                                  22794071
227950     SET   PS-CHECK-STORE  TO  TRUE.                              22795071
227960                                                                  22796071
227970     MOVE  ZEROES          TO  PV-SHIP-LNE-TOTAL                  22797071
227980                               PV-P2L-LNE-TOTAL.                  22798071
227990                                                                  22799071
228000     EVALUATE TRUE                                                22800071
228010         WHEN SQLCODE = ZERO                                      22801071
228020         SET PS-CHECK-STORE TO TRUE                               22802071
228030         PERFORM VARYING STORE-INX FROM 1 BY 1                    22803071
228040           UNTIL PS-INVALID-STORE                                 22804071
228050              OR PS-VALID-STORE                                   22805071
228060               IF RECDIS-STR-NBR = TBL-STORE-NBR-NUM (STORE-INX)  22806071
228070                  SET PS-INVALID-STORE TO TRUE                    22807071
228080               END-IF                                             22808071
228090               IF STORE-INX = PV-INVALID-STORE-ENTRIES            22809071
228100                       AND PS-CHECK-STORE                         22810071
228110                   SET PS-VALID-STORE TO TRUE                     22811071
228120               END-IF                                             22812071
228130         END-PERFORM                                              22813071
228140         IF PS-VALID-STORE                                        22814071
228150            ADD 1 TO PV-STR-CNT                                   22815071
228160         END-IF                                                   22816071
228170         WHEN SQLCODE = +100                                      22817071
228180             SET  PS-EOF-RECDIS-CURSOR-YES  TO  TRUE              22818071
228190         WHEN SQLCODE = -904                                      22819071
228200         WHEN SQLCODE = -911                                      22820071
228210         WHEN SQLCODE = -913                                      22821071
228220                                                                  22822071
228230             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   22823071
228240             MOVE '4750-FETCH-RECDIS-CURSOR' TO PV-SOFT-PARAGRAPH 22824071
228250             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 22825071
228260             MOVE LENGTH OF PV-CICS-MSG-AREA2                     22826071
228270               TO PV-COMMAREA-LENGTH                              22827071
228280             EXEC CICS                                            22828071
228290                  WRITEQ TD                                       22829071
228300                   QUEUE  ('CSSL')                                22830071
228310                    FROM  (PV-CICS-MSG-AREA2)                     22831071
228320                  LENGTH  (PV-COMMAREA-LENGTH)                    22832071
228330                    RESP  (PV-CICS-RESP)                          22833071
228340             END-EXEC                                             22834071
228350                                                                  22835071
228360              MOVE  PC-TSYMSG-01767  TO  DP020-MSG-NUMBER         22836071
228370              PERFORM 9900-SOFT-ABORT                             22837071
228380         WHEN SQLWARN0 NOT = SPACE                                22838071
228390         WHEN SQLCODE < ZERO                                      22839071
228400         WHEN SQLCODE > ZERO                                      22840071
228410             MOVE '4750-FETCH-RECDIS-CURSOR'                      22841071
228420                                     TO DP013-PARAGRAPH           22842071
228430             MOVE 'ATTEMPTING TO FETCH A ROW OF THE RESULTS TABLE 22843071
228440-                 'FROM THE RECDIS_CURSOR'                        22844071
228450                                     TO DP013-MESSAGE-TEXT (1)    22845071
228460             MOVE SQLCA              TO DP013-SQLCA               22846071
228470             MOVE 'TRECDIS'          TO DP013-DB2-TABLE-NAME (1)  22847071
228480             SET DP013-DB2-ABEND     TO TRUE                      22848071
228490             SET DP013-ROLLBACK      TO TRUE                      22849071
228500             SET DP013-XCTL-DISPLAY-RESTART                       22850071
228510                                     TO TRUE                      22851071
228520             PERFORM DP013-0000-PROCESS-ABEND                     22852071
228530     END-EVALUATE.                                                22853071
228540                                                                  22854071
228550                                                                  22855071
228560*----------------------------------------------------------------*22856071
228570*                                                                *22857071
228580*----------------------------------------------------------------*22858071
228590 4755-SEND-REC-ITM-DISTRO-RECS.                                   22859071
228600                                                                  22860071
228610     INITIALIZE PC053-DISTRO-RECORD                               22861071
228620                PC184-DISTRO-RECORD.                              22862071
228630     SET  PC053-DISTRO-DTL     TO TRUE.                           22863071
228640     SET  PC184-DISTRO-DTL     TO TRUE.                           22864071
228650                                                                  22865071
228660     MOVE PV-PO-NBR-8          TO PC053-DTL-ORD-NBR               22866071
228670                                  PC184-DTL-ORD-NBR.              22867071
228680     MOVE PV-REC-SEQ-NBR-3     TO PC053-DTL-RCVR-SEQ-NBR          22868071
228690                                  PC184-DTL-RCVR-SEQ-NBR.         22869071
228700     MOVE PV-PO-LINE-NBR-X     TO PC053-DTL-ORD-LNE-NBR           22870071
228710                                  PC184-DTL-ORD-LNE-NBR.          22871071
228720     MOVE PC-001               TO PC053-DTL-WORK-ORD-SEQ-NBR      22872071
228730                                  PC184-DTL-WORK-ORD-SEQ-NBR      22873071
228740                                  DK-WORK-ORD-SEQ-NBR.            22874071
228750     MOVE ZEROES               TO PC053-DTL-WO-INS-SEQ-NBR        22875071
228760                                  PC184-DTL-WO-INS-SEQ-NBR.       22876071
228770     MOVE RECDIS-STR-NBR       TO PC053-STR-NBR                   22877071
228780                                  PC184-STR-NBR.                  22878071
228790     MOVE PV-P2L-UNITS         TO PC053-INVOICED-QTY              22879071
228800                                  PC184-INVOICED-QTY.             22880071
228810                                                                  22881071
228820     INSPECT PC053-DISTRO-DTL-REC                                 22882071
228830             REPLACING ALL '' BY SPACES                          22883071
228840     INSPECT PC053-DISTRO-DTL-REC                                 22884071
228850             REPLACING ALL ';' BY SPACES                          22885071
228860     INSPECT PC053-DISTRO-DTL-REC                                 22886071
228870             REPLACING ALL LOW-VALUES BY SPACES                   22887071
228880*--------------------------                                       22888071
228890*  ADDED CHECK FOR HEX 3F                                         22889071
228900*--------------------------                                       22890071
228910     INSPECT PC053-DISTRO-HDR-REC                                 22891071
228920             REPLACING ALL '' bY SPACES                          22892071
228930     MOVE PC-SEMI-COLON        TO PC053-DTL-TERM-CHAR.            22893071
228940                                                                  22894071
228950     INSPECT PC184-DISTRO-DTL-REC                                 22895071
228960             REPLACING ALL '' BY SPACES                          22896071
228970     INSPECT PC184-DISTRO-DTL-REC                                 22897071
228980             REPLACING ALL ';' BY SPACES                          22898071
228990     INSPECT PC184-DISTRO-DTL-REC                                 22899071
229000             REPLACING ALL LOW-VALUES BY SPACES                   22900071
229010*--------------------------                                       22901071
229020*   ADDED CHECK FOR HEX 3F                                        22902071
229021*--------------------------                                       22902171
229022     INSPECT PC053-DISTRO-HDR-REC                                 22902271
229023             REPLACING ALL '' bY SPACES                          22902371
229024     MOVE PC-SEMI-COLON        TO PC184-DTL-TERM-CHAR.            22902471
229025                                                                  22902571
229026*--------------------------                                       22902671
229027*   ADDED CHECK FOR HEX 71                                        22902771
229028*--------------------------                                       22902871
229029     INSPECT PC053-DISTRO-HDR-REC                                 22902971
229030             REPLACING ALL '' bY SPACES                          22903071
229040                                                                  22904071
229050*===TKMA408=== THIS IS IN JUST FOR TESTING                        22905071
229060     IF   PS-DISPLAY-CSSL-YES                                     22906071
229070          IF  LQW-P2L-DYNAPACK (LQW-IDX)                          22907071
229080            IF  LQW-P2L-ALS-4-DIGIT-STR (LQW-IDX)                 22908071
229090              STRING ' PCKCS701-4755-AL '                         22909071
229100                     PC053-DISTRO-RECORD   DELIMITED BY SIZE      22910071
229110                                      INTO PV-CICS-152-RECORD     22911071
229120            END-IF                                                22912071
229130          ELSE                                                    22913071
229140              STRING ' PCKCS701-4755-PCC '                        22914071
229150                     PC184-DISTRO-RECORD   DELIMITED BY SIZE      22915071
229160                                      INTO PV-CICS-152-RECORD     22916071
229170          END-IF                                                  22917071
229180        MOVE PV-CICS-1-99             TO PV-CICS-MSG-DATA2        22918071
229190        MOVE PV-CICS-MSG-HOLD2        TO PV-CICS-MSG-AREA2        22919071
229200        MOVE LENGTH OF PV-CICS-MSG-AREA2                          22920071
229210                                      TO PV-COMMAREA-LENGTH       22921071
229220        EXEC CICS                                                 22922071
229230            WRITEQ TD                                             22923071
229240                QUEUE   ('CSSL')                                  22924071
229250                FROM    (PV-CICS-MSG-AREA2)                       22925071
229260                LENGTH  (PV-COMMAREA-LENGTH)                      22926071
229270                RESP    (PV-CICS-RESP)                            22927071
229280        END-EXEC                                                  22928071
229290     END-IF                                                       22929071
229300*===TKMA408=== THIS IS IN JUST FOR TESTING                        22930071
229310                                                                  22931071
229320                                                                  22932071
229330     IF  LQW-LNE-CRE-BOTH-LBL (LQW-IDX)  AND                      22933071
229340         LQW-P2L-LBL-CNT(LQW-IDX) = ZEROES                        22934071
229350         CONTINUE                                                 22935071
229360     ELSE                                                         22936071
229370     IF  PS-VALID-STORE                                           22937071
229380         IF  ASC-P2L-AL-DOWNLOAD-NO  AND                          22938071
229390             ASC-P2L-PCC-DOWNLOAD-NO                              22939071
229400             CONTINUE                                             22940071
229410         ELSE                                                     22941071
229420             IF  LQW-P2L-DYNAPACK (LQW-IDX)  AND                  22942071
229430                 ASC-P2L-AL-DOWNLOAD-YES                          22943071
229440                 PERFORM 4805-SEND-DTL-TLR-TO-QNX                 22944071
229450             ELSE                                                 22945071
229460             IF  LQW-P2L-PCC (LQW-IDX)  AND                       22946071
229470                 ASC-P2L-PCC-DOWNLOAD-YES                         22947071
229480                 PERFORM 4970-SEND-P2L-DATA-LTP-THP               22948071
229490             END-IF                                               22949071
229500             END-IF                                               22950071
229510         END-IF                                                   22951071
229520         ADD 1 TO PV-STR-RECS-SENT                                22952071
229530         MOVE PV-DIST-ACTL-ALLOC-DUMMY-VALUE                      22953071
229540                                    TO DISTDT-ACTL-ALLOC-QTY      22954071
229550     ELSE                                                         22955071
229560         MOVE RECDIS-EXPTED-ITM-QTY TO DISTDT-ACTL-ALLOC-QTY      22956071
229570     END-IF.                                                      22957071
229580                                                                  22958071
229590                                                                  22959071
229600*----------------------------------------------------------------*22960071
229610*                                                                *22961071
229620*----------------------------------------------------------------*22962071
229630 4760-CLOSE-RECDIS-CURSOR.                                        22963071
229640     EXEC SQL                                                     22964071
229650         CLOSE RECDIS_CURSOR                                      22965071
229660     END-EXEC.                                                    22966071
229670                                                                  22967071
229680     EVALUATE TRUE                                                22968071
229690         WHEN SQLCODE = ZERO                                      22969071
229700             CONTINUE                                             22970071
229710         WHEN SQLCODE = -904                                      22971071
229720         WHEN SQLCODE = -911                                      22972071
229730         WHEN SQLCODE = -913                                      22973071
229740                                                                  22974071
229750             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   22975071
229760             MOVE '4760-CLOSE-RECDIS-CURSOR' TO PV-SOFT-PARAGRAPH 22976071
229770             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 22977071
229780             MOVE LENGTH OF PV-CICS-MSG-AREA2                     22978071
229790               TO PV-COMMAREA-LENGTH                              22979071
229800             EXEC CICS                                            22980071
229810                  WRITEQ TD                                       22981071
229820                   QUEUE  ('CSSL')                                22982071
229830                    FROM  (PV-CICS-MSG-AREA2)                     22983071
229840                  LENGTH  (PV-COMMAREA-LENGTH)                    22984071
229850                    RESP  (PV-CICS-RESP)                          22985071
229860             END-EXEC                                             22986071
229870                                                                  22987071
229880             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          22988071
229890             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              22989071
229900             PERFORM 9900-SOFT-ABORT                              22990071
229910         WHEN SQLWARN0 NOT = SPACE                                22991071
229920         WHEN SQLCODE < ZERO                                      22992071
229930         WHEN SQLCODE > ZERO                                      22993071
229940             MOVE '4760-CLOSE-RECDIS-CURSOR'                      22994071
229950                                     TO DP013-PARAGRAPH           22995071
229960             MOVE 'CLOSE THE RECDIS_CURSOR'                       22996071
229970                                     TO DP013-MESSAGE-TEXT (1)    22997071
229980             MOVE SQLCA              TO DP013-SQLCA               22998071
229990             MOVE 'TRECDIS'          TO DP013-DB2-TABLE-NAME (1)  22999071
230000             SET DP013-DB2-ABEND     TO TRUE                      23000071
230010             SET DP013-NO-ROLLBACK   TO TRUE                      23001071
230020             SET DP013-XCTL-DISPLAY-RESTART                       23002071
230030                                     TO TRUE                      23003071
230040             PERFORM DP013-0000-PROCESS-ABEND                     23004071
230050     END-EVALUATE.                                                23005071
230060                                                                  23006071
230070                                                                  23007071
230080*----------------------------------------------------------------*23008071
230090*  INSERT A ROW ON THE TRANSACTION DETAIL TABLE.                 *23009071
230100*----------------------------------------------------------------*23010071
230110 4765-INSERT-TRANS-DTL-REC.                                       23011071
230120                                                                  23012071
230130                                                                  23013071
230140     ADD  DISTDT-FCSE-SPLT-UNT-QTY                                23014071
230150          DISTDT-INPK-SPLT-UNT-QTY                                23015071
230160          GIVING                                                  23016071
230170          DISTDT-FCSE-ACTL-UNT-QTY.                               23017071
230180                                                                  23018071
230190     MOVE ZEROES  TO  DISTDT-PREPK-ODD-UNT-QTY.                   23019071
230200                                                                  23020071
230210     EXEC SQL                                                     23021071
230220          INSERT                                                  23022071
230230          INTO  TDISTDT                                           23023071
230240               (ORD_NBR                                           23024071
230250               ,RCVR_SEQ_NBR                                      23025071
230260               ,ORD_LNE_NBR                                       23026071
230270               ,WRK_ORD_SEQ_NBR                                   23027071
230280               ,STR_NBR                                           23028071
230290               ,EXPTED_ALLOC_QTY                                  23029071
230300               ,ACTL_ALLOC_QTY                                    23030071
230310               ,RCVG_PSTD_STAT_CDE                                23031071
230320              , P2L_SPLT_UNT_QTY                                  23032071
230330              , FCSE_SPLT_UNT_QTY                                 23033071
230340              , INPK_SPLT_UNT_QTY                                 23034071
230350              , FCSE_ACTL_UNT_QTY                                 23035071
230360              , ODD_CART_IND                                      23036071
230370              , PREPK_ODD_UNT_QTY)                                23037071
230380        VALUES                                                    23038071
230390              (:DK-PO-NBR                                         23039071
230400              ,:DK-REC-SEQ-NBR                                    23040071
230410              ,:DK-LINE-NBR                                       23041071
230420              ,:DK-WORK-ORD-SEQ-NBR                               23042071
230430              ,:RECDIS-STR-NBR                                    23043071
230440              ,:RECDIS-EXPTED-ITM-QTY                             23044071
230450              ,:DISTDT-ACTL-ALLOC-QTY                             23045071
230460              ,:PC-READY-TO-POST-STATUS                           23046071
230470              ,:DISTDT-P2L-SPLT-UNT-QTY                           23047071
230480              ,:DISTDT-FCSE-SPLT-UNT-QTY                          23048071
230490              ,:DISTDT-INPK-SPLT-UNT-QTY                          23049071
230500              ,:DISTDT-FCSE-ACTL-UNT-QTY                          23050071
230510              ,:DISTDT-ODD-CART-IND                               23051071
230520              ,:DISTDT-PREPK-ODD-UNT-QTY)                         23052071
230530     END-EXEC.                                                    23053071
230540                                                                  23054071
230550     EVALUATE TRUE                                                23055071
230560         WHEN SQLCODE = ZERO                                      23056071
230570              SET  PS-DISTDT-VALID-INSERT  TO  TRUE               23057071
230580         WHEN SQLCODE = -803                                      23058071
230590              PERFORM 4767-DELETE-DETAIL                          23059071
230600         WHEN SQLCODE = -904                                      23060071
230610         WHEN SQLCODE = -911                                      23061071
230620         WHEN SQLCODE = -913                                      23062071
230630                                                                  23063071
230640             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   23064071
230650             MOVE '4765-INSERT-TRANS-DTL-REC'                     23065071
230660                                             TO PV-SOFT-PARAGRAPH 23066071
230670             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 23067071
230680             MOVE LENGTH OF PV-CICS-MSG-AREA2                     23068071
230690               TO PV-COMMAREA-LENGTH                              23069071
230700             EXEC CICS                                            23070071
230710                  WRITEQ TD                                       23071071
230720                   QUEUE  ('CSSL')                                23072071
230730                    FROM  (PV-CICS-MSG-AREA2)                     23073071
230740                  LENGTH  (PV-COMMAREA-LENGTH)                    23074071
230750                    RESP  (PV-CICS-RESP)                          23075071
230760             END-EXEC                                             23076071
230770                                                                  23077071
230780              MOVE  PC-TSYMSG-01767  TO  DP020-MSG-NUMBER         23078071
230790              PERFORM 9900-SOFT-ABORT                             23079071
230800         WHEN SQLWARN0 NOT = SPACES                               23080071
230810         WHEN SQLCODE NOT EQUAL ZERO                              23081071
230820                                                                  23082071
230830             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   23083071
230840             MOVE '4765-INSERT-TRANS-DTL-REC'                     23084071
230850                                             TO PV-SOFT-PARAGRAPH 23085071
230860             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 23086071
230870             MOVE LENGTH OF PV-CICS-MSG-AREA2                     23087071
230880               TO PV-COMMAREA-LENGTH                              23088071
230890             EXEC CICS                                            23089071
230900                  WRITEQ TD                                       23090071
230910                   QUEUE  ('CSSL')                                23091071
230920                    FROM  (PV-CICS-MSG-AREA2)                     23092071
230930                  LENGTH  (PV-COMMAREA-LENGTH)                    23093071
230940                    RESP  (PV-CICS-RESP)                          23094071
230950             END-EXEC                                             23095071
230960             MOVE DK-PO-NBR          TO  PV-HOLD3-PO              23096071
230970             MOVE DK-REC-SEQ-NBR     TO  PV-HOLD3-RCVR            23097071
230980             MOVE DK-LINE-NBR        TO  PV-HOLD3-LINE            23098071
230990             MOVE PV-CICS-MSG-HOLD3  TO  PV-CICS-MSG-AREA2        23099071
231000             MOVE LENGTH OF PV-CICS-MSG-AREA2                     23100071
231010               TO PV-COMMAREA-LENGTH                              23101071
231020             EXEC CICS                                            23102071
231030                  WRITEQ TD                                       23103071
231040                   QUEUE  ('CSSL')                                23104071
231050                    FROM  (PV-CICS-MSG-AREA2)                     23105071
231060                  LENGTH  (PV-COMMAREA-LENGTH)                    23106071
231070                    RESP  (PV-CICS-RESP)                          23107071
231080             END-EXEC                                             23108071
231090                                                                  23109071
231100             MOVE '4765-INSERT-TRANS-DTL-REC'                     23110071
231110                                     TO DP013-PARAGRAPH           23111071
231120             MOVE 'INSERT TRANSACTION DETAIL ROW'                 23112071
231130                                     TO DP013-MESSAGE-TEXT (1)    23113071
231140             MOVE RECDIS-STR-NBR     TO DP013-MESSAGE-TEXT (2)    23114071
231150             MOVE SQLCA              TO DP013-SQLCA               23115071
231160             MOVE 'TDISTDT'          TO DP013-DB2-TABLE-NAME (1)  23116071
231170             SET DP013-DB2-ABEND     TO TRUE                      23117071
231180             SET DP013-ROLLBACK      TO TRUE                      23118071
231190             SET DP013-XCTL-DISPLAY-RESTART                       23119071
231200                                     TO TRUE                      23120071
231210             PERFORM DP013-0000-PROCESS-ABEND                     23121071
231220     END-EVALUATE.                                                23122071
231230                                                                  23123071
231240*----------------------------------------------------------------*23124071
231250*  DELETE THE TRANSACTION DETAIL ROWS FOR THIS PO/RCVR/LINE (-803)23125071
231260*----------------------------------------------------------------*23126071
231270 4767-DELETE-DETAIL.                                              23127071
231280     SET  PS-NO-SOFT-ABORT-ERROR          TO  TRUE.               23128071
231290                                                                  23129071
231300     EXEC SQL                                                     23130071
231310          DELETE FROM TDISTDT                                     23131071
231320           WHERE ORD_NBR         = :DK-PO-NBR                     23132071
231330             AND RCVR_SEQ_NBR    = :DK-REC-SEQ-NBR                23133071
231340             AND ORD_LNE_NBR     = :DK-LINE-NBR                   23134071
231350             AND STR_NBR         = :RECDIS-STR-NBR                23135071
231360     END-EXEC.                                                    23136071
231370                                                                  23137071
231380     EVALUATE TRUE                                                23138071
231390         WHEN SQLCODE = ZERO                                      23139071
231400         WHEN SQLCODE = +100                                      23140071
231410              CONTINUE                                            23141071
231420         WHEN SQLCODE = -904                                      23142071
231430         WHEN SQLCODE = -911                                      23143071
231440         WHEN SQLCODE = -913                                      23144071
231450                                                                  23145071
231460              MOVE SQLCODE                   TO PV-SOFT-SQLCODE   23146071
231470              MOVE '4767-DELETE-DETAIL'      TO PV-SOFT-PARAGRAPH 23147071
231480              MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2 23148071
231490              MOVE LENGTH OF PV-CICS-MSG-AREA2                    23149071
231500                TO PV-COMMAREA-LENGTH                             23150071
231510              EXEC CICS                                           23151071
231520                  WRITEQ TD                                       23152071
231530                   QUEUE  ('CSSL')                                23153071
231540                    FROM  (PV-CICS-MSG-AREA2)                     23154071
231550                  LENGTH  (PV-COMMAREA-LENGTH)                    23155071
231560                    RESP  (PV-CICS-RESP)                          23156071
231570              END-EXEC                                            23157071
231580              MOVE  PC-TSYMSG-00551  TO  DP020-MSG-NUMBER         23158071
231590              PERFORM 9900-SOFT-ABORT                             23159071
231600                                                                  23160071
231610         WHEN SQLWARN0 NOT = SPACES                               23161071
231620         WHEN SQLCODE NOT EQUAL ZERO                              23162071
231630              MOVE '4767-DELETE-DETAIL'                           23163071
231640                                   TO DP013-PARAGRAPH             23164071
231650              MOVE 'DELETE TRANSACTION DETAIL ROWS'               23165071
231660                                   TO DP013-MESSAGE-TEXT (1)      23166071
231670              MOVE SQLCA           TO DP013-SQLCA                 23167071
231680              MOVE 'TDISTDT'       TO DP013-DB2-TABLE-NAME (1)    23168071
231690              SET DP013-DB2-ABEND  TO TRUE                        23169071
231700              PERFORM DP013-0000-PROCESS-ABEND                    23170071
231710     END-EVALUATE.                                                23171071
231720                                                                  23172071
231730                                                                  23173071
231740                                                                  23174071
231750*----------------------------------------------------------------*23175071
231760*  DELETE THE TRANSACTION DETAIL ROWS FOR THIS PO/RCVR/LINE (-803)23176071
231770*  FOR THE REMAINING LINES IN THE PACK                            23177071
231780*----------------------------------------------------------------*23178071
231790 4768-DELETE-PREPK-DTL.                                           23179071
231800     SET  PS-NO-SOFT-ABORT-ERROR          TO  TRUE.               23180071
231801                                                                  23180171
231802     EXEC SQL                                                     23180271
231803          DELETE FROM TDISTDT                                     23180371
231804           WHERE ORD_NBR         = :DK-PO-NBR                     23180471
231805             AND RCVR_SEQ_NBR    = :DK-REC-SEQ-NBR                23180571
231806             AND ORD_LNE_NBR     = :PV-PRPK-REC-ORD-LNE-NBR       23180671
231807             AND STR_NBR         = :RECDIS-STR-NBR                23180771
231808     END-EXEC.                                                    23180871
231809                                                                  23180971
231810     EVALUATE TRUE                                                23181071
231811         WHEN SQLCODE = ZERO                                      23181171
231812         WHEN SQLCODE = +100                                      23181271
231813              CONTINUE                                            23181371
231814         WHEN SQLCODE = -904                                      23181471
231815         WHEN SQLCODE = -911                                      23181571
231816         WHEN SQLCODE = -913                                      23181671
231817                                                                  23181771
231818              MOVE SQLCODE                   TO PV-SOFT-SQLCODE   23181871
231819              MOVE '4768-DELETE-PREPK-DTL'   TO PV-SOFT-PARAGRAPH 23181971
231820              MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2 23182071
231821              MOVE LENGTH OF PV-CICS-MSG-AREA2                    23182171
231822                TO PV-COMMAREA-LENGTH                             23182271
231823              EXEC CICS                                           23182371
231824                  WRITEQ TD                                       23182471
231825                   QUEUE  ('CSSL')                                23182571
231826                    FROM  (PV-CICS-MSG-AREA2)                     23182671
231827                  LENGTH  (PV-COMMAREA-LENGTH)                    23182771
231828                    RESP  (PV-CICS-RESP)                          23182871
231829              END-EXEC                                            23182971
231830              MOVE  PC-TSYMSG-00551  TO  DP020-MSG-NUMBER         23183071
231831              PERFORM 9900-SOFT-ABORT                             23183171
231832                                                                  23183271
231833         WHEN SQLWARN0 NOT = SPACES                               23183371
231834         WHEN SQLCODE NOT EQUAL ZERO                              23183471
231835              MOVE '4768-DELETE-PREPK-DTL '                       23183571
231836                                   TO DP013-PARAGRAPH             23183671
231837              MOVE 'DELETE TRANSACTION DETAIL ROWS'               23183771
231838                                   TO DP013-MESSAGE-TEXT (1)      23183871
231839              MOVE SQLCA           TO DP013-SQLCA                 23183971
231840              MOVE 'TDISTDT'       TO DP013-DB2-TABLE-NAME (1)    23184071
231841              SET DP013-DB2-ABEND  TO TRUE                        23184171
231842              PERFORM DP013-0000-PROCESS-ABEND                    23184271
231843     END-EVALUATE.                                                23184371
231844                                                                  23184471
231845                                                                  23184571
231846                                                                  23184671
231847*----------------------------------------------------------------*23184771
231848*  DOWNLOAD THE TRAILER DATA TO AL SYSTEMS.                      *23184871
231849*----------------------------------------------------------------*23184971
231850 4770-BLD-TLR-REC.                                                23185071
231851                                                                  23185171
231852     INITIALIZE PC053-DISTRO-RECORD                               23185271
231853                PC184-DISTRO-RECORD.                              23185371
231854     SET  PC053-DISTRO-TLR     TO TRUE.                           23185471
231855     SET  PC184-DISTRO-TLR     TO TRUE.                           23185571
231856                                                                  23185671
231857     MOVE PV-PO-NBR-8          TO PC053-TLR-ORD-NBR               23185771
231858                                  PC184-TLR-ORD-NBR.              23185871
231859     MOVE PV-REC-SEQ-NBR-3     TO PC053-TLR-RCVR-SEQ-NBR          23185971
231860                                  PC184-TLR-RCVR-SEQ-NBR.         23186071
231870     MOVE PV-PO-LINE-NBR-X     TO PC053-TLR-ORD-LNE-NBR           23187071
231880                                  PC184-TLR-ORD-LNE-NBR.          23188071
231890     MOVE PC-001               TO PC053-TLR-WORK-ORD-SEQ-NBR      23189071
231900                                  PC184-TLR-WORK-ORD-SEQ-NBR.     23190071
231910     MOVE ZEROES               TO PC053-DTL-WO-INS-SEQ-NBR        23191071
231920                                  PC184-DTL-WO-INS-SEQ-NBR.       23192071
231930     MOVE PV-STR-RECS-SENT     TO PC053-STR-RECS-SENT             23193071
231940                                  PC184-TLR-RECS-SENT.            23194071
231950                                                                  23195071
231960     INSPECT PC053-DISTRO-TLR-REC                                 23196071
231970             REPLACING ALL '' BY SPACES                          23197071
231980     INSPECT PC053-DISTRO-TLR-REC                                 23198071
231990             REPLACING ALL ';' BY SPACES                          23199071
232000     INSPECT PC053-DISTRO-TLR-REC                                 23200071
232010             REPLACING ALL LOW-VALUES BY SPACES                   23201071
232020*----------------------------                                     23202071
232021*    ADDED CHECK FOR HEX 3F                                       23202171
232022*----------------------------                                     23202271
232023     INSPECT PC053-DISTRO-HDR-REC                                 23202371
232024             REPLACING ALL '' bY SPACES                          23202471
232025     MOVE PC-SEMI-COLON        TO PC053-TLR-TERM-CHAR.            23202571
232026                                                                  23202671
232027     INSPECT PC184-DISTRO-TLR-REC                                 23202771
232028             REPLACING ALL '' BY SPACES                          23202871
232029     INSPECT PC184-DISTRO-TLR-REC                                 23202971
232030             REPLACING ALL ';' BY SPACES                          23203071
232040     INSPECT PC184-DISTRO-TLR-REC                                 23204071
232050             REPLACING ALL LOW-VALUES BY SPACES                   23205071
232060*----------------------------                                     23206071
232070*   ADDED CHECK FOR HEX 3F                                        23207071
232080*----------------------------                                     23208071
232090     INSPECT PC053-DISTRO-HDR-REC                                 23209071
232100             REPLACING ALL '' bY SPACES                          23210071
232110     MOVE PC-SEMI-COLON        TO PC184-TLR-TERM-CHAR.            23211071
232111*----------------------------                                     23211171
232112*   ADDED CHECK FOR HEX 71                                        23211271
232113*----------------------------                                     23211371
232114     INSPECT PC053-DISTRO-HDR-REC                                 23211471
232115             REPLACING ALL '' bY SPACES                          23211571
232116                                                                  23211671
232117*===TKMA408=== THIS IS IN JUST FOR TESTING                        23211771
232118     IF   PS-DISPLAY-CSSL-YES                                     23211871
232119          IF  LQW-P2L-DYNAPACK (LQW-IDX)                          23211971
232120            IF LQW-P2L-ALS-4-DIGIT-STR (LQW-IDX)                  23212071
232130               STRING ' PCKCS701-4770-AL '                        23213071
232140                     PC053-DISTRO-RECORD   DELIMITED BY SIZE      23214071
232150                                      INTO PV-CICS-152-RECORD     23215071
232160            END-IF                                                23216071
232170          ELSE                                                    23217071
232180              STRING ' PCKCS701-4770-PCC '                        23218071
232190                     PC184-DISTRO-RECORD   DELIMITED BY SIZE      23219071
232200                                      INTO PV-CICS-152-RECORD     23220071
232210          END-IF                                                  23221071
232220        MOVE PV-CICS-1-99             TO PV-CICS-MSG-DATA2        23222071
232230        MOVE PV-CICS-MSG-HOLD2        TO PV-CICS-MSG-AREA2        23223071
232240        MOVE LENGTH OF PV-CICS-MSG-AREA2                          23224071
232250                                      TO PV-COMMAREA-LENGTH       23225071
232260        EXEC CICS                                                 23226071
232270            WRITEQ TD                                             23227071
232280                QUEUE   ('CSSL')                                  23228071
232290                FROM    (PV-CICS-MSG-AREA2)                       23229071
232300                LENGTH  (PV-COMMAREA-LENGTH)                      23230071
232310                RESP    (PV-CICS-RESP)                            23231071
232320        END-EXEC                                                  23232071
232330     END-IF                                                       23233071
232340*===TKMA408=== THIS IS IN JUST FOR TESTING                        23234071
232350                                                                  23235071
232360                                                                  23236071
232370     IF  LQW-LNE-CRE-BOTH-LBL (LQW-IDX)  AND                      23237071
232380         LQW-P2L-LBL-CNT(LQW-IDX) = ZEROES                        23238071
232390         CONTINUE                                                 23239071
232400     ELSE                                                         23240071
232410     IF  ASC-P2L-AL-DOWNLOAD-NO  AND                              23241071
232420         ASC-P2L-PCC-DOWNLOAD-NO                                  23242071
232430         CONTINUE                                                 23243071
232440     ELSE                                                         23244071
232450         IF  LQW-P2L-DYNAPACK (LQW-IDX)  AND                      23245071
232460             ASC-P2L-AL-DOWNLOAD-YES                              23246071
232470             PERFORM 4805-SEND-DTL-TLR-TO-QNX                     23247071
232480         ELSE                                                     23248071
232490         IF  LQW-P2L-PCC (LQW-IDX)  AND                           23249071
232500             ASC-P2L-PCC-DOWNLOAD-YES                             23250071
232510             PERFORM 4970-SEND-P2L-DATA-LTP-THP                   23251071
232520         END-IF                                                   23252071
232530         END-IF                                                   23253071
232540     END-IF.                                                      23254071
232550                                                                  23255071
232560                                                                  23256071
232570*----------------------------------------------------------------*23257071
232580*  CREATE THE AUDIT RECORD FOR RECITM, THEN UPDATE THE INNER      23258071
232590*  PACK QUANTITY.                                                 23259071
232600*----------------------------------------------------------------*23260071
232610 4775-UPDATE-INNR-PACK.                                           23261071
232620                                                                  23262071
232630     MOVE ASC-PO-NBR                TO  DK-PO-NBR                 23263071
232640                                        RC031-PO-NBR.             23264071
232650     MOVE ASC-REC-SEQ-NBR           TO  DK-REC-SEQ-NBR            23265071
232660                                        RC031-REC-SEQ-NBR.        23266071
232670     MOVE ASC-PO-LINE-NBR           TO  DK-LINE-NBR               23267071
232680                                        RC031-PO-LNE-NBR.         23268071
232690     MOVE PV-INNER-PACK-QTY         TO  DK-INNR-PACK-QTY.         23269071
232700     MOVE ASC-OPER-UNT-ID           TO RC031-OPER-UNT-ID.         23270071
232710     MOVE ASC-FCLTY-ID              TO RC031-FCLTY-ID.            23271071
232720     MOVE PC-CURRENT-PROGRAM-NAME   TO RC031-UPD-PGM-ID.          23272071
232730                                                                  23273071
232740     SET RC031-AUDIT-TRECITM                                      23274071
232750         RC031-BEFORE                                             23275071
232760         RC031-UPDATE               TO TRUE.                      23276071
232770                                                                  23277071
232780     MOVE LENGTH OF RC031-FIELDS                                  23278071
232790                                    TO PV-COMMAREA-LENGTH.        23279071
232800                                                                  23280071
232810     EXEC CICS                                                    23281071
232820         LINK PROGRAM  (PC-AUDIT-RTN)                             23282071
232830              COMMAREA (RC031-FIELDS)                             23283071
232840              LENGTH   (PV-COMMAREA-LENGTH)                       23284071
232850     END-EXEC.                                                    23285071
232860                                                                  23286071
232870     EVALUATE TRUE                                                23287071
232880         WHEN RC031-CALL-SUCCESSFUL                               23288071
232890             CONTINUE                                             23289071
232900                                                                  23290071
232910         WHEN OTHER                                               23291071
232920            MOVE '4775-UPDATE-INNR-PACK'                          23292071
232930                                    TO DP013-PARAGRAPH            23293071
232940            MOVE 'UNSUCCESSFUL CALL TO AUDIT RTN'                 23294071
232950                                    TO DP013-MESSAGE-TEXT (1)     23295071
232960            MOVE RC031-RETURN-DESC  TO DP013-MESSAGE-TEXT (2)     23296071
232970            MOVE RC031-SQLCA        TO DP013-SQLCA                23297071
232980            SET DP013-DB2-ABEND                                   23298071
232990                DP013-XCTL-DISPLAY-RESTART                        23299071
233000                                    TO TRUE                       23300071
233010            PERFORM DP013-0000-PROCESS-ABEND                      23301071
233020     END-EVALUATE.                                                23302071
233030                                                                  23303071
233040     MOVE  PV-INNER-PACK-QTY  TO  DK-INNR-PACK-QTY.               23304071
233050                                                                  23305071
233060     EXEC SQL                                                     23306071
233070         UPDATE TRECITM                                           23307071
233080         SET INNR_PACK_QTY      = :DK-INNR-PACK-QTY               23308071
233090         WHERE ORD_NBR          = :DK-PO-NBR                      23309071
233100           AND REC_SEQ_NBR      = :DK-REC-SEQ-NBR                 23310071
233110           AND ORD_LNE_NBR      = :DK-LINE-NBR                    23311071
233120           AND VER_STATUS_CDE   = 'A'                             23312071
233130     END-EXEC.                                                    23313071
233140                                                                  23314071
233150     EVALUATE TRUE                                                23315071
233160         WHEN SQLCODE = ZERO                                      23316071
233170              CONTINUE                                            23317071
233180         WHEN SQLCODE = -904                                      23318071
233190         WHEN SQLCODE = -911                                      23319071
233200         WHEN SQLCODE = -913                                      23320071
233210                                                                  23321071
233220             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   23322071
233230             MOVE '4775-UPDATE-INNR-PACK'    TO PV-SOFT-PARAGRAPH 23323071
233240             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 23324071
233250             MOVE LENGTH OF PV-CICS-MSG-AREA2                     23325071
233260               TO PV-COMMAREA-LENGTH                              23326071
233270             EXEC CICS                                            23327071
233280                  WRITEQ TD                                       23328071
233290                   QUEUE  ('CSSL')                                23329071
233300                    FROM  (PV-CICS-MSG-AREA2)                     23330071
233310                  LENGTH  (PV-COMMAREA-LENGTH)                    23331071
233320                    RESP  (PV-CICS-RESP)                          23332071
233330             END-EXEC                                             23333071
233340                                                                  23334071
233350              MOVE PC-TSYMSG-01767  TO  DP020-MSG-NUMBER          23335071
233360              PERFORM 9900-SOFT-ABORT                             23336071
233370         WHEN SQLWARN0 NOT = SPACES                               23337071
233380         WHEN SQLCODE NOT EQUAL ZERO                              23338071
233390              MOVE PV-PO-NBR-X        TO PV-ERROR-ORD-NBR         23339071
233400              MOVE PV-REC-SEQ-NBR-X   TO PV-ERROR-RCVR-SEQ-NBR    23340071
233410              MOVE PV-PO-LINE-NBR-X   TO PV-ERROR-ORD-LNE-NBR     23341071
233420              MOVE '4775-UPDATE-INNR-PACK'                        23342071
233430                                   TO DP013-PARAGRAPH             23343071
233440              MOVE 'UPDATE INNER PACK ON RECITM'                  23344071
233450                                   TO DP013-MESSAGE-TEXT (1)      23345071
233460              STRING PV-ERROR-ORD-NBR      DELIMITED BY SIZE      23346071
233470                     ' : '                 DELIMITED BY SIZE      23347071
233480                     PV-ERROR-RCVR-SEQ-NBR DELIMITED BY SIZE      23348071
233490                     ' : '                 DELIMITED BY SIZE      23349071
233500                     PV-ERROR-ORD-LNE-NBR  DELIMITED BY SIZE      23350071
233510                                 INTO DP013-MESSAGE-TEXT (2)      23351071
233520              MOVE SQLCA           TO DP013-SQLCA                 23352071
233530              MOVE 'TRECITM'       TO DP013-DB2-TABLE-NAME (1)    23353071
233540              SET DP013-DB2-ABEND  TO TRUE                        23354071
233550              PERFORM DP013-0000-PROCESS-ABEND                    23355071
233560     END-EVALUATE.                                                23356071
233570                                                                  23357071
233580*----------------------------------------------------------------*23358071
233590*                                                                *23359071
233600*----------------------------------------------------------------*23360071
233610                                                                  23361071
233620 4779-PROCESS-DEST-LABEL-REQ.                                     23362071
233630     MOVE ASC-PO-NBR                    TO DK-PO-NBR.             23363071
233640     MOVE ASC-REC-SEQ-NBR               TO DK-REC-SEQ-NBR.        23364071
233650     MOVE LQW-PO-RCVR-LINE(LQW-IDX)     TO DK-LINE-NBR.           23365071
233660     PERFORM 4707-GET-HDR-INFO.                                   23366071
233670     PERFORM 4709-GET-TCOCNTL-INFO.                               23367071
233680     IF RECITM-STATUS-CDE = 'VE'                                  23368071
233681        MOVE  PC-TSYMSG-03410  TO  DP020-MSG-NUMBER               23368171
233682        PERFORM 9900-SOFT-ABORT                                   23368271
233683     END-IF                                                       23368371
233684                                                                  23368471
233685     IF PS-NO-ERROR                                               23368571
233686        PERFORM 4780-ISSUE-DEST-LBL-REQ                           23368671
233687        IF PC126-RFID-STORE-YES                                   23368771
233688           SET PS-RFID-DRTVE-CREATE TO TRUE                       23368871
233689           IF ASC-AUTO-CONVEY-EXCPT-CRTNS                         23368971
233690              PERFORM 4786-FRMT-SEND-DIRCT-PHYSL                  23369071
233691           END-IF                                                 23369171
233692        END-IF                                                    23369271
233693     END-IF.                                                      23369371
233694*----------------------------------------------------------------*23369471
233695*                                                                *23369571
233696*----------------------------------------------------------------*23369671
233697 4780-ISSUE-DEST-LBL-REQ.                                         23369771
233698                                                                  23369871
233699                                                                  23369971
233700     INITIALIZE PC126-COMMAREA-REC.                               23370071
233800                                                                  23380071
233801     MOVE ASC-PO-NBR                    TO PC126-PO-NBR.          23380171
233802     MOVE ASC-REC-SEQ-NBR               TO PC126-RCVR-SEQ-NBR.    23380271
233803     MOVE LQW-PO-RCVR-LINE(LQW-IDX)     TO PC126-PO-LNE-NBR.      23380371
233804     MOVE ASC-OPER-UNT-ID               TO PC126-OPER-UNT-ID.     23380471
233805     MOVE COCNTL-SSCC-18-IND            TO PC126-SSCC-18-IND.     23380571
233806     MOVE LQW-LABEL-TYPE(LQW-IDX)       TO PC126-SHIP-LABEL-TYPE. 23380671
233807     SET  PC126-INITIAL-PRINT           TO TRUE.                  23380771
233808                                                                  23380871
233809     IF  LQW-STORE-PGYBK(LQW-IDX)                                 23380971
233810         MOVE  'R'                      TO PC126-PRT-SEQ          23381071
233820     ELSE                                                         23382071
233830         MOVE ASC-LBL-PRT-ORDER         TO PC126-PRT-SEQ          23383071
233840     END-IF.                                                      23384071
233850                                                                  23385071
233860     IF ASC-SPEC-INST-DESC = SPACES                               23386071
233870        MOVE ASC-DFLT-STR-ZN-ID         TO PC126-STR-ZNE          23387071
233880     ELSE                                                         23388071
233890        MOVE ASC-SPEC-INST-DESC         TO PC126-STR-ZNE          23389071
233900     END-IF.                                                      23390071
233910     MOVE ASC-DPT-NBR                   TO PC126-DEPT-NBR.        23391071
233920     MOVE LQW-SKU (LQW-IDX)             TO PC126-SKU.             23392071
233930     MOVE LQW-SUBCLASS (LQW-IDX)        TO PC126-CL-NBR.          23393071
233940     MOVE LQW-CLASS    (LQW-IDX)        TO PC126-MAJ-CL-NBR.      23394071
233950     MOVE PV-VEND-STYL-NAME             TO PC126-VENDOR-STYLE.    23395071
233960     MOVE LQW-SML-FCSE-LBL-CNT(LQW-IDX) TO PC126-FCSE-LBL-CNT.    23396071
233970     MOVE LQW-SML-INPK-LBL-CNT(LQW-IDX) TO PC126-INPK-LBL-CNT.    23397071
233980     MOVE LQW-P2L-LBL-CNT(LQW-IDX)      TO PC126-P2L-LBL-CNT.     23398071
233990     MOVE LQW-CS-BOUND-UNTS(LQW-IDX)    TO PC126-CS-BOUND-UNTS.   23399071
234000     MOVE LQW-DC-BOUND-UNTS(LQW-IDX)    TO PC126-DC-BOUND-UNTS.   23400071
234010     MOVE LQW-RTV-BOUND-UNTS (LQW-IDX)  TO PC126-RTV-BOUND-UNTS.  23401071
234020     MOVE LQW-CS-BOUND-CTNS (LQW-IDX)   TO PC126-CS-BOUND-CTNS.   23402071
234030     IF  LQW-LNE-CRE-P2L-LBL (LQW-IDX)                            23403071
234040         MOVE ZEROES                    TO PC126-OTPK-UNT-QTY     23404071
234050     ELSE                                                         23405071
234060         MOVE LQW-OUTER-PACK (LQW-IDX)  TO PC126-OTPK-UNT-QTY     23406071
234070     END-IF.                                                      23407071
234080     MOVE LQW-INNER-PACK (LQW-IDX)      TO PC126-INPK-UNT-QTY.    23408071
234090     MOVE LQW-MODULE (LQW-IDX)          TO PC126-MOD-NBR.         23409071
234100     MOVE ASC-SML-P2L-PRTR-ID           TO PC126-SHP-PRTR-ID.     23410071
234110     MOVE PV-SHP-PRTR-CLUSTER-NBR  TO PC126-SHP-PRTR-CLUSTER-NBR. 23411071
234120     MOVE PV-SHP-PRTR-ID-ADDR      TO PC126-SHP-PRTR-IP-ADDR.     23412071
234130     MOVE PV-SHP-PRTR-OS-RLSE-CDE  TO PC126-SHP-PRTR-OS-RLSE-CDE. 23413071
234140     MOVE PV-SHP-DATA-XFER-MODE-ID TO PC126-SHP-DATA-XFER-MODE-ID.23414071
234150     MOVE PV-SHP-XMIT-INTFC-CDE    TO PC126-SHP-XMIT-INTFC-CDE.   23415071
234160     MOVE PV-SHP-PRTR-TYP-CDE      TO PC126-SHP-PRTR-TYP-CDE.     23416071
234170     MOVE ASC-PGYBCK-PRTR-ID       TO PC126-PGYBK-PRTR-ID.        23417071
234180     MOVE PV-PGYBK-PRTR-CLUSTER-NBR                               23418071
234190                                  TO PC126-PGYBK-PRTR-CLUSTER-NBR.23419071
234200     MOVE PV-PGYBK-PRTR-ID-ADDR   TO PC126-PGYBK-PRTR-IP-ADDR.    23420071
234210     MOVE PV-PGYBK-PRTR-OS-RLSE-CDE                               23421071
234220                                  TO PC126-PGYBK-PRTR-OS-RLSE-CDE.23422071
234230     MOVE PV-PGYBK-DATA-XFER-MODE-ID                              23423071
234240                                 TO PC126-PGYBK-DATA-XFER-MODE-ID.23424071
234250     MOVE PV-PGYBK-XMIT-INTFC-CDE TO PC126-PGYBK-XMIT-INTFC-CDE.  23425071
234260     MOVE PV-PGYBK-PRTR-TYP-CDE   TO PC126-PGYBK-PRTR-TYP-CDE.    23426071
234270     MOVE ASC-DC-PRTD-AT          TO PC126-DC-PRTD-AT.            23427071
234280     IF  PS-LINE-PREV-DOWNLOAD                                    23428071
234290         SET  PC126-REVISED             TO TRUE                   23429071
234300     END-IF.                                                      23430071
234310     SET  PS-LINE-NOT-PREV-DOWNLOAD     TO TRUE.                  23431071
234320     MOVE PC-CURRENT-PROGRAM-NAME       TO PC126-CALLING-PGM-NME. 23432071
234330                                                                  23433071
234340     IF  LQW-LNE-CRE-P2L-LBL (LQW-IDX)                            23434071
234350         MOVE ASC-PRT-HEAD-FOOT         TO PC126-P2L-PRT-HDR-SW   23435071
234360     ELSE                                                         23436071
234370         SET  PC126-PRINT-P2L-HDRS  TO  TRUE                      23437071
234380     END-IF.                                                      23438071
234390     MOVE LQW-ODD-CRTN-USE-SW (LQW-IDX) TO PC126-ODD-CRTN-USE.    23439071
234400     MOVE LQW-ODD-CARTON (LQW-IDX)      TO PC126-ODD-CRTN-UNT-QTY.23440071
234410     MOVE LQW-ITM-NBR  (LQW-IDX)        TO PC126-ITEM-NBR.        23441071
234420                                                                  23442071
234430     MOVE ASC-PKGNG-CD                  TO PC126-PKGNG-CD.        23443071
234440     MOVE ASC-DSPLY-PKGNG-CD            TO PC126-DSPLY-PKGNG-CD.  23444071
234450     MOVE LQW-PREPK-ID (LQW-IDX)        TO PC126-PREPK-ID         23445071
234460                                           DK-PREPK-ID.           23446071
234470     MOVE LQW-PREPK-RATIO (LQW-IDX)     TO PC126-PREPK-RATIO.     23447071
234480     MOVE LQW-PACKS-IN-CRTN (LQW-IDX)   TO PC126-PACKS-IN-CRTN.   23448071
234490     MOVE PV-USER-ID                    TO PC126-USER-ID.         23449071
234500     MOVE ASC-AUTOVE-PARM-SW            TO PC126-AUTOVE-PO-SW.    23450071
234510                                                                  23451071
234520     MOVE ASC-TRIP-ARRIVE-DATE       TO PC126-TRIP-ARRIVE-DATE.   23452071
234530                                                                  23453071
234531     IF  ASC-PRE-PACK-ORDER                                       23453171
234532         PERFORM 4781-GET-TOT-PREPK-UNTS                          23453271
234533         MOVE  PV-TOT-PREPK-UNTS  TO  PC126-TOT-PREPK-UNTS        23453371
234534         MOVE  PV-TOT-PREPK-INPK-UNTS                             23453471
234535                                  TO  PC126-PREPK-INPK-UNT-QTY    23453571
234536     ELSE                                                         23453671
234537         MOVE  ZEROES             TO  PC126-TOT-PREPK-UNTS        23453771
234538                                      PC126-PREPK-INPK-UNT-QTY    23453871
234539     END-IF.                                                      23453971
234540                                                                  23454071
234550     MOVE ASC-AUTO-CONVEY-LVL-SW TO PC126-AUTO-CONVEY-LVL-SW      23455071
234560     SET PC126-RFID-STORE-NO     TO TRUE                          23456071
234570                                                                  23457071
234580     IF  PS-DISPLAY-CSSL-YES                                      23458071
234590         INITIALIZE      PV-CICS-MSG-AREA2                        23459071
234600         MOVE DP020-SRC-TASK-NUMBER      TO  PV-DISPLAY-TASK-NBR  23460071
234610         MOVE ASC-PO-NBR             TO  PV-DISPLAY-PO-NBR        23461071
234620         MOVE ASC-REC-SEQ-NBR        TO  PV-DISPLAY-RCVR-SEQ-NBR  23462071
234630         MOVE DP020-LOCATION-NBR     TO  PV-DISPLAY-OPER          23463071
234640         STRING      ' PCKCS701-'                                 23464071
234650                 PV-DISPLAY-OPER                                  23465071
234660                 ' TERM-'                                         23466071
234670                 DP020-TERM-ID                                    23467071
234680                 ' USER-'                                         23468071
234690                 DP020-USERID                                     23469071
234700                 ' TASK-'                                         23470071
234710                 PV-DISPLAY-TASK-NBR                              23471071
234720                 ' PO-'                                           23472071
234730                 PV-DISPLAY-PO-NBR                                23473071
234740                 '-'                                              23474071
234750                 PV-DISPLAY-RCVR-SEQ-NBR                          23475071
234760                 '-'                                              23476071
234770                 PC126-PO-LNE-NBR                                 23477071
234780                 ' BEFORE PCKCS191'        DELIMITED BY SIZE      23478071
234790                                      INTO PV-CICS-MSG-AREA2      23479071
234800         MOVE LENGTH OF PV-CICS-MSG-AREA2                         23480071
234810           TO PV-COMMAREA-LENGTH                                  23481071
234820         EXEC CICS                                                23482071
234830              WRITEQ TD                                           23483071
234840               QUEUE      ('CSSL')                                23484071
234850                FROM      (PV-CICS-MSG-AREA2)                     23485071
234860              LENGTH      (PV-COMMAREA-LENGTH)                    23486071
234870                RESP      (PV-CICS-RESP)                          23487071
234880         END-EXEC                                                 23488071
234890     END-IF.                                                      23489071
234900                                                                  23490071
234910     MOVE LENGTH OF PC126-COMMAREA-REC  TO PV-COMMAREA-LENGTH.    23491071
234920                                                                  23492071
234930     EXEC CICS                                                    23493071
234940         LINK                                                     23494071
234950             PROGRAM   (PC-LABEL-PROGRAM)                         23495071
234960             COMMAREA  (PC126-COMMAREA-REC)                       23496071
234970             LENGTH    (PV-COMMAREA-LENGTH)                       23497071
234980             RESP      (PV-CICS-RESP)                             23498071
234990     END-EXEC.                                                    23499071
235000                                                                  23500071
235010     EVALUATE TRUE                                                23501071
235020         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     23502071
235030             PERFORM 4783-VALIDATE-LBL-REQ-CALL                   23503071
235040         WHEN OTHER                                               23504071
235050             IF  LQW-LNE-CRE-SML-LBL (LQW-IDX)                    23505071
235060                 MOVE PC-TSYMSG-01792  TO DP020-MSG-NUMBER        23506071
235070             ELSE                                                 23507071
235080                 MOVE PC-TSYMSG-01791  TO DP020-MSG-NUMBER        23508071
235090             END-IF                                               23509071
235100             PERFORM 9900-SOFT-ABORT                              23510071
235110     END-EVALUATE.                                                23511071
235120                                                                  23512071
235130     IF      PS-DISPLAY-CSSL-YES                                  23513071
235140         INITIALIZE      PV-CICS-MSG-AREA2                        23514071
235150         MOVE DP020-SRC-TASK-NUMBER      TO  PV-DISPLAY-TASK-NBR  23515071
235160         MOVE ASC-PO-NBR             TO  PV-DISPLAY-PO-NBR        23516071
235170         MOVE ASC-REC-SEQ-NBR        TO  PV-DISPLAY-RCVR-SEQ-NBR  23517071
235180         MOVE DP020-LOCATION-NBR     TO  PV-DISPLAY-OPER          23518071
235190         STRING      ' PCKCS701-'                                 23519071
235200                 PV-DISPLAY-OPER                                  23520071
235210                 ' TERM-'                                         23521071
235220                 DP020-TERM-ID                                    23522071
235230                 ' USER-'                                         23523071
235240                 DP020-USERID                                     23524071
235250                 ' TASK-'                                         23525071
235260                 PV-DISPLAY-TASK-NBR                              23526071
235270                 ' PO-'                                           23527071
235280                 PV-DISPLAY-PO-NBR                                23528071
235290                 '-'                                              23529071
235300                 PV-DISPLAY-RCVR-SEQ-NBR                          23530071
235310                 '-'                                              23531071
235320                 PC126-PO-LNE-NBR                                 23532071
235330                 ' AFTER  PCKCS191'        DELIMITED BY SIZE      23533071
235340                                      INTO PV-CICS-MSG-AREA2      23534071
235350         MOVE LENGTH OF PV-CICS-MSG-AREA2                         23535071
235360           TO PV-COMMAREA-LENGTH                                  23536071
235370         EXEC CICS                                                23537071
235380              WRITEQ TD                                           23538071
235390               QUEUE      ('CSSL')                                23539071
235400                FROM      (PV-CICS-MSG-AREA2)                     23540071
235410              LENGTH      (PV-COMMAREA-LENGTH)                    23541071
235420                RESP      (PV-CICS-RESP)                          23542071
235430         END-EXEC                                                 23543071
235440     END-IF.                                                      23544071
235450                                                                  23545071
235460                                                                  23546071
235470*----------------------------------------------------------------*23547071
235480* GET THE TOTAL NUMBER OF UNITS FOR A PREPACK ORDER (M OR I)     *23548071
235490*----------------------------------------------------------------*23549071
235500 4781-GET-TOT-PREPK-UNTS.                                         23550071
235510     EXEC SQL                                                     23551071
235520         SELECT SUM(PREPK_RATO_QTY)                               23552071
235530               ,SUM(INNR_PACK_QTY)                                23553071
235540           INTO :PV-TOT-PREPK-UNTS                                23554071
235550               ,:PV-TOT-PREPK-INPK-UNTS                           23555071
235560           FROM TRECITM                                           23556071
235570          WHERE ORD_NBR      =  :ASC-PO-NBR                       23557071
235580            AND REC_SEQ_NBR  =  :ASC-REC-SEQ-NBR                  23558071
235590            AND PREPK_ID     =  :DK-PREPK-ID                      23559071
235600     END-EXEC                                                     23560071
235610                                                                  23561071
235620     EVALUATE TRUE                                                23562071
235630         WHEN SQLCODE = +0                                        23563071
235640             CONTINUE                                             23564071
235650         WHEN SQLCODE = -904                                      23565071
235660         WHEN SQLCODE = -911                                      23566071
235670         WHEN SQLCODE = -913                                      23567071
235680             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    23568071
235690             MOVE '4781-GET-TOT-PREPK-UNTS' TO PV-SOFT-PARAGRAPH  23569071
235700             INITIALIZE                        PV-CICS-MSG-AREA2  23570071
235710             MOVE  ASC-PO-NBR               TO  PV-DSPLY-PO       23571071
235720             MOVE  ASC-REC-SEQ-NBR          TO  PV-DSPLY-RCVR     23572071
235730             MOVE  DK-PREPK-ID              TO  PV-DSPLY-PACK     23573071
235740             STRING ' ' PV-DSPLY-PO '-'         DELIMITED BY SIZE 23574071
235750                        PV-DSPLY-RCVR '-'       DELIMITED BY SIZE 23575071
235760                    ' PACK-' PV-DSPLY-PACK      DELIMITED BY SIZE 23576071
235770                                  INTO PV-CICS-MSG-AREA2          23577071
235780             MOVE LENGTH OF PV-CICS-MSG-AREA2                     23578071
235790               TO PV-COMMAREA-LENGTH                              23579071
235800             EXEC CICS                                            23580071
235810                  WRITEQ TD                                       23581071
235820                   QUEUE  ('CSSL')                                23582071
235830                    FROM  (PV-CICS-MSG-AREA2)                     23583071
235840                  LENGTH  (PV-COMMAREA-LENGTH)                    23584071
235850                    RESP  (PV-CICS-RESP)                          23585071
235860             END-EXEC                                             23586071
235870             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          23587071
235880             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              23588071
235890             PERFORM 9900-SOFT-ABORT                              23589071
235900         WHEN SQLWARN0 NOT = SPACES                               23590071
235910         WHEN SQLCODE < ZERO                                      23591071
235920         WHEN SQLCODE > ZERO                                      23592071
235930             MOVE '4781-GET-TOT-PREPK-UNTS'                       23593071
235940                               TO DP013-PARAGRAPH                 23594071
235950             MOVE 'GET TOTAL UNITS IN PREPACK     '               23595071
235960                               TO DP013-MESSAGE-TEXT (1)          23596071
235970             MOVE SQLCA        TO DP013-SQLCA                     23597071
235980             MOVE 'TRECITM'    TO DP013-DB2-TABLE-NAME (1)        23598071
235990             MOVE  ASC-PO-NBR               TO  PV-DSPLY-PO       23599071
236000             MOVE  ASC-REC-SEQ-NBR          TO  PV-DSPLY-RCVR     23600071
236010             MOVE  DK-PREPK-ID              TO  PV-DSPLY-PACK     23601071
236020             STRING ' ' PV-DSPLY-PO '-'         DELIMITED BY SIZE 23602071
236030                        PV-DSPLY-RCVR '-'       DELIMITED BY SIZE 23603071
236040                    ' PACK-' PV-DSPLY-PACK      DELIMITED BY SIZE 23604071
236050                                    INTO DP013-MESSAGE-TEXT (2)   23605071
236060             SET DP013-DB2-ABEND                                  23606071
236070                 DP013-XCTL-DISPLAY-RESTART                       23607071
236080                               TO TRUE                            23608071
236090             PERFORM DP013-0000-PROCESS-ABEND                     23609071
236100     END-EVALUATE.                                                23610071
236110                                                                  23611071
236120                                                                  23612071
236130*----------------------------------------------------------------*23613071
236140* CHECK RETURN CODE FROM LABEL PRINT PROGRAM TO SEE IF SUCCESSFUL*23614071
236150*----------------------------------------------------------------*23615071
236160 4783-VALIDATE-LBL-REQ-CALL.                                      23616071
236170                                                                  23617071
236180     IF  PC126-CRA-INVALID-SQL                                    23618071
236190             STRING 'PCKCS191 PARAGRAPH-' DELIMITED BY SIZE       23619071
236200                    PC126-CRA-REQ-ID      DELIMITED BY SIZE       23620071
236210                                     INTO DP013-PARAGRAPH         23621071
236220             MOVE 'LINK TO PCKCS191               '               23622071
236230                               TO DP013-MESSAGE-TEXT (1)          23623071
236240             STRING 'MSG - '              DELIMITED BY SIZE       23624071
236250                    PC126-CRA-RET-MSG     DELIMITED BY SIZE       23625071
236260                             INTO DP013-MESSAGE-TEXT (2)          23626071
236270             MOVE 'CHECK CSSL FOR MORE DETAIL     '               23627071
236280                               TO DP013-MESSAGE-TEXT (3)          23628071
236290             STRING  ' PO:'                    DELIMITED BY SIZE  23629071
236300                     PC126-PO-NBR              DELIMITED BY SIZE  23630071
236310                     ' RCVR:'                  DELIMITED BY SIZE  23631071
236320                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  23632071
236330                     ' LINE:'                  DELIMITED BY SIZE  23633071
236340                     PC126-PO-LNE-NBR          DELIMITED BY SIZE  23634071
236350                             INTO DP013-MESSAGE-TEXT (4)          23635071
236360             MOVE SQLCA        TO DP013-SQLCA                     23636071
236370             SET DP013-DB2-ABEND                                  23637071
236380                 DP013-LINK-RETURN                                23638071
236390                               TO TRUE                            23639071
236400             PERFORM DP013-0000-PROCESS-ABEND                     23640071
236410                                                                  23641071
236420             MOVE PC-TSYMSG-01792  TO DP020-MSG-NUMBER            23642071
236430             PERFORM 9900-SOFT-ABORT                              23643071
236440             PERFORM 4910-UPD-DISTHD-AFT-ABEND                    23644071
236450                                                                  23645071
236460     ELSE                                                         23646071
236470     IF  PC126-CRA-SQL-CONTENTION                                 23647071
236480             MOVE PC-TSYMSG-01792  TO DP020-MSG-NUMBER            23648071
236490             PERFORM 9900-SOFT-ABORT                              23649071
236500             PERFORM 4910-UPD-DISTHD-AFT-ABEND                    23650071
236510             SET  LQW-LNE-DO-NOT-PRT-LBL(LQW-IDX)  TO TRUE        23651071
236520             SET   ASC-NOT-PROTECTED (ASC-BLK-SUB ASC-ITEM-SUB)   23652071
236530                                                    TO TRUE       23653071
236540     ELSE                                                         23654071
236550         IF  NOT  PC126-CRA-SUCCESSFUL                            23655071
236560             IF  LQW-LNE-CRE-SML-LBL(LQW-IDX)                     23656071
236570                 MOVE PC-TSYMSG-01792  TO DP020-MSG-NUMBER        23657071
236580             ELSE                                                 23658071
236590                 MOVE PC-TSYMSG-01791  TO DP020-MSG-NUMBER        23659071
236600             END-IF                                               23660071
236610             PERFORM 9900-SOFT-ABORT                              23661071
236620         END-IF                                                   23662071
236630     END-IF                                                       23663071
236640     END-IF.                                                      23664071
236650                                                                  23665071
236660                                                                  23666071
236670*----------------------------------------------------------------*23667071
236680* SEND ALL CARTON RECORDS TO THE PACK-TO-LIGHT SYSTEM            *23668071
236690*  BUILD THE RECEIPT RECORD TO BE SENT TO THE QNX BOX.            23669071
236700*----------------------------------------------------------------*23670071
236710 4785-BUILD-RECEIPT-RECS.                                         23671071
236720                                                                  23672071
236730     INITIALIZE PC002-RECEIPT-RECORD.                             23673071
236740     INITIALIZE PC184-DISTRO-RECORD.                              23674071
236750     SET PC002-RECEIPT-DTL                                        23675071
236760         PC184-CARTON-DTL          TO TRUE                        23676071
236770     MOVE PV-PO-NBR-8              TO PC002-DTL-ORD-NBR           23677071
236780                                      PC184-CDTL-ORD-NBR          23678071
236790     MOVE PV-REC-SEQ-NBR-3         TO PC002-DTL-RCVR-SEQ-NBR      23679071
236800                                      PC184-CDTL-RCVR-SEQ-NBR     23680071
236810     MOVE PV-PO-LINE-NBR-X         TO PC002-DTL-ORD-LNE-NBR       23681071
236820                                      PC184-CDTL-ORD-LNE-NBR      23682071
236830     MOVE PC-001                   TO PC002-DTL-WORK-ORD-SEQ-NBR  23683071
236840                                      PC184-CDTL-WORK-ORD-SEQ-NBR 23684071
236850     MOVE ZEROES                   TO PC002-DTL-WO-INS-SEQ-NBR    23685071
236860                                      PC184-CDTL-WO-INS-SEQ-NBR   23686071
236870     MOVE PC-SEMI-COLON            TO PC184-TLR-TERM-CHAR.        23687071
236880                                                                  23688071
236890     MOVE PV-PO-NBR                TO DK-PO-NBR                   23689071
236900     MOVE PV-REC-SEQ-NBR           TO DK-REC-SEQ-NBR              23690071
236910     MOVE PV-PO-LINE-NBR           TO DK-LINE-NBR                 23691071
236920                                                                  23692071
236930     MOVE  ZEROES                  TO PV-P2L-CARTON-NBR.          23693071
236940                                                                  23694071
236950     PERFORM 4790-WRITE-DETAIL-RECS                               23695071
236960       UNTIL PV-P2L-CARTON-NBR = PV-P2L-LABEL-CNT                 23696071
236970          OR PS-SOFT-ABORT-ERROR.                                 23697071
236980                                                                  23698071
236990     INITIALIZE PC002-RECEIPT-RECORD                              23699071
237000                PC184-DISTRO-RECORD.                              23700071
237010     SET PC002-RECEIPT-TLR                                        23701071
237020         PC184-CARTON-TLR       TO TRUE.                          23702071
237030     MOVE PV-PO-NBR-8           TO PC002-TLR-ORD-NBR              23703071
237040                                   PC184-CTLR-ORD-NBR.            23704071
237050     MOVE PV-REC-SEQ-NBR-3      TO PC002-TLR-RCVR-SEQ-NBR         23705071
237060                                   PC184-CTLR-RCVR-SEQ-NBR.       23706071
237070     MOVE PV-PO-LINE-NBR-X      TO PC002-TLR-ORD-LNE-NBR          23707071
237080                                   PC184-CTLR-ORD-LNE-NBR.        23708071
237090     MOVE PC-001                TO PC002-TLR-WORK-ORD-SEQ-NBR     23709071
237100                                   PC184-CTLR-WORK-ORD-SEQ-NBR.   23710071
237110     MOVE ZEROES                TO PC002-TLR-WO-INS-SEQ-NBR       23711071
237120                                   PC184-CTLR-WO-INS-SEQ-NBR.     23712071
237130     MOVE PV-P2L-CARTON-NBR     TO PC002-TOTAL-CTNS-RECEIVED      23713071
237140                                   PC184-CTLR-RECS-SENT.          23714071
237150     MOVE PC-SEMI-COLON         TO PC002-TLR-TERM-CHAR            23715071
237160                                   PC184-CTLR-TERM-CHAR.          23716071
237170                                                                  23717071
237180     MOVE '4785-BUILD-RECEIPT-RECS' TO  PV-CALLING-PARAGRAPH.     23718071
237190                                                                  23719071
237200*===TKMA408=== THIS IS IN JUST FOR TESTING                        23720071
237210     IF   PS-DISPLAY-CSSL-YES                                     23721071
237220             IF  LQW-P2L-DYNAPACK (LQW-IDX)                       23722071
237230                 STRING ' PCKCS701-4785-AL '                      23723071
237240                        PC002-RECEIPT-RECORD  DELIMITED BY SIZE   23724071
237250                                         INTO PV-CICS-152-RECORD  23725071
237260             ELSE                                                 23726071
237270                 STRING ' PCKCS701-4785-PCC '                     23727071
237280                        PC184-DISTRO-RECORD   DELIMITED BY SIZE   23728071
237290                                         INTO PV-CICS-152-RECORD  23729071
237300             END-IF                                               23730071
237310        MOVE PV-CICS-1-99             TO PV-CICS-MSG-DATA2        23731071
237320        MOVE PV-CICS-MSG-HOLD2        TO PV-CICS-MSG-AREA2        23732071
237330        MOVE LENGTH OF PV-CICS-MSG-AREA2                          23733071
237340                                      TO PV-COMMAREA-LENGTH       23734071
237350        EXEC CICS                                                 23735071
237360            WRITEQ TD                                             23736071
237370                QUEUE   ('CSSL')                                  23737071
237380                FROM    (PV-CICS-MSG-AREA2)                       23738071
237390                LENGTH  (PV-COMMAREA-LENGTH)                      23739071
237400                RESP    (PV-CICS-RESP)                            23740071
237410        END-EXEC                                                  23741071
237420     END-IF                                                       23742071
237430*===TKMA408=== THIS IS IN JUST FOR TESTING                        23743071
237440                                                                  23744071
237450                                                                  23745071
237460     IF  (ASC-P2L-AL-DOWNLOAD-NO   AND                            23746071
237470          ASC-P2L-PCC-DOWNLOAD-NO)  OR                            23747071
237480         PS-SOFT-ABORT-ERROR                                      23748071
237490         CONTINUE                                                 23749071
237500     ELSE                                                         23750071
237510         IF  LQW-P2L-DYNAPACK (LQW-IDX)  AND                      23751071
237520             ASC-P2L-AL-DOWNLOAD-YES                              23752071
237530             PERFORM 4820-SEND-RCPT-RECS-TO-QNX                   23753071
237540         ELSE                                                     23754071
237550         IF  LQW-P2L-PCC (LQW-IDX)  AND                           23755071
237560             ASC-P2L-PCC-DOWNLOAD-YES                             23756071
237570             PERFORM 4970-SEND-P2L-DATA-LTP-THP                   23757071
237580         END-IF                                                   23758071
237590         END-IF                                                   23759071
237600     END-IF.                                                      23760071
237610                                                                  23761071
237620                                                                  23762071
237630 4786-FRMT-SEND-DIRCT-PHYSL.                                      23763071
237640     IF PS-RFID-DRTVE-CREATE                                      23764071
237650        SET SU095-CSEPK-SPLIT TO TRUE                             23765071
237660     ELSE                                                         23766071
237670        SET SU095-CSEPK-DEL TO TRUE                               23767071
237680     END-IF                                                       23768071
237690                                                                  23769071
237700     SET SU095-ADD-ACTION  TO TRUE.                               23770071
237710                                                                  23771071
237711     MOVE ASC-CURR-OPER-UNT-ID TO SU095-KEY-OPER-UNT-ID           23771171
237712     MOVE ASC-PO-NBR TO SU095-KEY-PO                              23771271
237713     MOVE ASC-REC-SEQ-NBR TO SU095-KEY-REC-SEQ-NBR                23771371
237714     MOVE DP020-USERID    TO SU095-ASSOC-ID                       23771471
237715                                                                  23771571
237716     IF ASC-PRE-PACK-ORDER                                        23771671
237717        SET SU095-PREPK-ORDER-YES TO TRUE                         23771771
237718        MOVE LQW-PREPK-ID (LQW-IDX) TO SU095-KEY-PREPK-ID         23771871
237719     ELSE                                                         23771971
237720        SET SU095-PREPK-ORDER-NO  TO TRUE                         23772071
237721     END-IF                                                       23772171
237722     MOVE LQW-PO-RCVR-LINE(LQW-IDX)                               23772271
237723                             TO SU095-KEY-LNE-NBR                 23772371
237724                                                                  23772471
237725     CALL SU095-CRTN-DIR-PGM   USING DFHEIBLK                     23772571
237726                                     SU095-COMMAREA               23772671
237727                                     SU095-DIRECTIVE-COMMAREA.    23772771
237728     EVALUATE TRUE                                                23772871
237729       WHEN SU095-SUCCESS                                         23772971
237730           CONTINUE                                               23773071
237731       WHEN OTHER                                                 23773171
237732           MOVE ASC-PO-NBR             TO  PV-DISPLAY-PO-NBR      23773271
237733           MOVE ASC-REC-SEQ-NBR        TO  PV-DISPLAY-RCVR-SEQ-NBR23773371
237734           STRING       ' PCKCS701-'          DELIMITED BY SIZE   23773471
237735                 ' PO-'                    DELIMITED BY SIZE      23773571
237736                 PV-DISPLAY-PO-NBR         DELIMITED BY SIZE      23773671
237737                 '-'                       DELIMITED BY SIZE      23773771
237738                 PV-DISPLAY-RCVR-SEQ-NBR   DELIMITED BY SIZE      23773871
237739                 ' 4786-FRMT-SEND-DIRCT-P' DELIMITED BY SIZE      23773971
237740                                      INTO PV-CICS-MSG-AREA2      23774071
237741         MOVE LENGTH OF PV-CICS-MSG-AREA2                         23774171
237742           TO PV-COMMAREA-LENGTH                                  23774271
237743         EXEC CICS                                                23774371
237744              WRITEQ TD                                           23774471
237745               QUEUE      ('CSSL')                                23774571
237746                FROM      (PV-CICS-MSG-AREA2)                     23774671
237747              LENGTH      (PV-COMMAREA-LENGTH)                    23774771
237748                RESP      (PV-CICS-RESP)                          23774871
237749         END-EXEC                                                 23774971
237750         MOVE SU095-RETURN-CODE          TO PV-SOFT-SQLCODE       23775071
237751         MOVE '4786-FRMT-SEND-DIRCT-PHY' TO PV-SOFT-PARAGRAPH     23775171
237752          MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2    23775271
237753          MOVE LENGTH OF PV-CICS-MSG-AREA2                        23775371
237754             TO PV-COMMAREA-LENGTH                                23775471
237755           EXEC CICS                                              23775571
237756                WRITEQ TD                                         23775671
237757                 QUEUE  ('CSSL')                                  23775771
237758                  FROM  (PV-CICS-MSG-AREA2)                       23775871
237759                LENGTH  (PV-COMMAREA-LENGTH)                      23775971
237760                  RESP  (PV-CICS-RESP)                            23776071
237761           END-EXEC                                               23776171
237762           DISPLAY 'SQLCA' SU095-SQLCA                            23776271
237763     END-EVALUATE.                                                23776371
237764*----------------------------------------------------------------*23776471
237765*  WRITE THE DETAIL RECEIPT RECORDS.                              23776571
237766*----------------------------------------------------------------*23776671
237767 4790-WRITE-DETAIL-RECS.                                          23776771
237768                                                                  23776871
237769     ADD 1                          TO PV-P2L-CARTON-NBR.         23776971
237770                                                                  23777071
237771     INITIALIZE PC002-RECEIPT-RECORD                              23777171
237772                PC184-DISTRO-RECORD.                              23777271
237773     SET PC002-RECEIPT-DTL                                        23777371
237774         PC184-CARTON-DTL       TO TRUE.                          23777471
237775     MOVE PV-PO-NBR-8           TO PC002-DTL-ORD-NBR              23777571
237776                                   PC184-CDTL-ORD-NBR.            23777671
237777     MOVE PV-REC-SEQ-NBR-3      TO PC002-DTL-RCVR-SEQ-NBR         23777771
237778                                   PC184-CDTL-RCVR-SEQ-NBR.       23777871
237779     MOVE PV-PO-LINE-NBR-X      TO PC002-DTL-ORD-LNE-NBR          23777971
237780                                   PC184-CDTL-ORD-LNE-NBR.        23778071
237790     MOVE PC-001                TO PC002-DTL-WORK-ORD-SEQ-NBR     23779071
237800                                   PC184-CDTL-WORK-ORD-SEQ-NBR.   23780071
237810     MOVE ZEROES                TO PC002-DTL-WO-INS-SEQ-NBR       23781071
237820                                   PC184-CDTL-WO-INS-SEQ-NBR.     23782071
237830     MOVE PV-P2L-CARTON-NBR     TO PC002-CTN-NBR                  23783071
237840                                   PC184-CDTL-CTN-NBR.            23784071
237850     MOVE SPACES                   TO PC184-CDTL-SSCC-18-NBR.     23785071
237860     MOVE PC-SEMI-COLON            TO PC002-DTL-TERM-CHAR         23786071
237870                                      PC184-CDTL-TERM-CHAR.       23787071
237880                                                                  23788071
237890     MOVE '4790-WRITE-DETAIL-RECS ' TO  PV-CALLING-PARAGRAPH.     23789071
237900                                                                  23790071
237910*===TKMA408=== THIS IS IN JUST FOR TESTING                        23791071
237920     IF   PS-DISPLAY-CSSL-YES                                     23792071
237930             IF  LQW-P2L-DYNAPACK (LQW-IDX)                       23793071
237940                 STRING ' PCKCS701-4790-AL '                      23794071
237950                        PC002-RECEIPT-RECORD  DELIMITED BY SIZE   23795071
237960                                         INTO PV-CICS-152-RECORD  23796071
237970             ELSE                                                 23797071
237980                 STRING ' PCKCS701-4790-PCC '                     23798071
237990                        PC184-DISTRO-RECORD   DELIMITED BY SIZE   23799071
238000                                         INTO PV-CICS-152-RECORD  23800071
238010             END-IF                                               23801071
238020        MOVE PV-CICS-1-99             TO PV-CICS-MSG-DATA2        23802071
238030        MOVE PV-CICS-MSG-HOLD2        TO PV-CICS-MSG-AREA2        23803071
238040        MOVE LENGTH OF PV-CICS-MSG-AREA2                          23804071
238050                                      TO PV-COMMAREA-LENGTH       23805071
238060        EXEC CICS                                                 23806071
238070            WRITEQ TD                                             23807071
238080                QUEUE   ('CSSL')                                  23808071
238090                FROM    (PV-CICS-MSG-AREA2)                       23809071
238100                LENGTH  (PV-COMMAREA-LENGTH)                      23810071
238110                RESP    (PV-CICS-RESP)                            23811071
238120        END-EXEC                                                  23812071
238130     END-IF                                                       23813071
238140*===TKMA408=== THIS IS IN JUST FOR TESTING                        23814071
238150                                                                  23815071
238160     IF  ASC-P2L-AL-DOWNLOAD-NO  AND                              23816071
238170         ASC-P2L-PCC-DOWNLOAD-NO                                  23817071
238180         CONTINUE                                                 23818071
238190     ELSE                                                         23819071
238200         IF  LQW-P2L-DYNAPACK (LQW-IDX)  AND                      23820071
238210             ASC-P2L-AL-DOWNLOAD-YES                              23821071
238220             PERFORM 4820-SEND-RCPT-RECS-TO-QNX                   23822071
238230         ELSE                                                     23823071
238240         IF  LQW-P2L-PCC (LQW-IDX)  AND                           23824071
238250             ASC-P2L-PCC-DOWNLOAD-YES                             23825071
238260             PERFORM 4970-SEND-P2L-DATA-LTP-THP                   23826071
238270         END-IF                                                   23827071
238280         END-IF                                                   23828071
238290     END-IF.                                                      23829071
238300                                                                  23830071
238310                                                                  23831071
238320*----------------------------------------------------------------*23832071
238330*  CONNECT TO SOCKET WHICH WAS GIVEN TO US BY THE AL/SYSTEMS QNX *23833071
238340*  PROGRAM.  CONNECT THE PATH (SOCKET).                          *23834071
238350*----------------------------------------------------------------*23835071
238360 4800-SEND-HDR-DATA-TO-QNX.                                       23836071
238370*                                                                 23837071
238380*===TKMA408=== THIS IS IN JUST FOR TESTING                        23838071
238390*       INITIALIZE  PV-CICS-MSG-AREA2                             23839071
238400*      STRING ' PCKCS701 - '              DELIMITED BY SIZE       23840071
238410*             '4800-SEND-HDR-DATA-TO-QNX' DELIMITED BY SIZE       23841071
238420*                                   INTO PV-CICS-MSG-AREA2        23842071
238430*       MOVE LENGTH OF PV-CICS-MSG-AREA2                          23843071
238440*                                     TO PV-COMMAREA-LENGTH       23844071
238450*       EXEC CICS                                                 23845071
238460*           WRITEQ TD                                             23846071
238470*               QUEUE   ('CSSL')                                  23847071
238480*               FROM    (PV-CICS-MSG-AREA2)                       23848071
238490*               LENGTH  (PV-COMMAREA-LENGTH)                      23849071
238500*               RESP    (PV-CICS-RESP)                            23850071
238510*       END-EXEC                                                  23851071
238520*       INITIALIZE  PV-CICS-MSG-AREA2                             23852071
238530*                                                                 23853071
238540*       MOVE PC053-DISTRO-RECORD      TO PV-CICS-152-RECORD       23854071
238550*       MOVE PV-CICS-1-99             TO PV-CICS-MSG-DATA2        23855071
238560*       MOVE PV-CICS-MSG-HOLD2        TO PV-CICS-MSG-AREA2        23856071
238570*       MOVE LENGTH OF PV-CICS-MSG-AREA2                          23857071
238580*                                     TO PV-COMMAREA-LENGTH       23858071
238590*       EXEC CICS                                                 23859071
238600*           WRITEQ TD                                             23860071
238610*               QUEUE   ('CSSL')                                  23861071
238620*               FROM    (PV-CICS-MSG-AREA2)                       23862071
238630*               LENGTH  (PV-COMMAREA-LENGTH)                      23863071
238640*               RESP    (PV-CICS-RESP)                            23864071
238650*       END-EXEC                                                  23865071
238660*       MOVE PV-CICS-100-152          TO PV-CICS-MSG-DATA2        23866071
238670*       MOVE PV-CICS-MSG-HOLD2        TO PV-CICS-MSG-AREA2        23867071
238680*       MOVE LENGTH OF PV-CICS-MSG-AREA2                          23868071
238690*                                     TO PV-COMMAREA-LENGTH       23869071
238700*       EXEC CICS                                                 23870071
238710*           WRITEQ TD                                             23871071
238720*               QUEUE   ('CSSL')                                  23872071
238730*               FROM    (PV-CICS-MSG-AREA2)                       23873071
238740*               LENGTH  (PV-COMMAREA-LENGTH)                      23874071
238750*               RESP    (PV-CICS-RESP)                            23875071
238760*       END-EXEC.                                                 23876071
238770*===TKMA408=== THIS IS IN JUST FOR TESTING                        23877071
238780                                                                  23878071
238790                                                                  23879071
238800     MOVE LOW-VALUES              TO TCP-BUF2.                    23880071
238810     MOVE 150                     TO DP081-TCPLENG                23881071
238820                                     DP081-NBR-BYTES.             23882071
238830                                                                  23883071
238840     IF  LQW-P2L-ALS-4-DIGIT-STR (LQW-IDX)                        23884071
238850         MOVE PC053-DISTRO-RECORD     TO TCP-BUF2                 23885071
238860     END-IF                                                       23886071
238870                                                                  23887071
238880     CALL 'EZACIC04'                                              23888071
238890         USING DP081-TOASCII-TOKEN                                23889071
238900               TCP-BUF2                                           23890071
238910               DP081-TCPLENG.                                     23891071
238920                                                                  23892071
238930*===TKMA408=== THIS IS IN JUST FOR TESTING                        23893071
238940     IF   PS-DISPLAY-CSSL-YES                                     23894071
238950          IF LQW-P2L-ALS-4-DIGIT-STR (LQW-IDX)                    23895071
238960             MOVE PC053-DISTRO-RECORD  TO PV-CICS-152-RECORD      23896071
238970          END-IF                                                  23897071
238980          MOVE PV-CICS-1-99         TO PV-CICS-MSG-DATA2          23898071
238990          MOVE PV-CICS-MSG-HOLD2    TO PV-CICS-MSG-AREA2          23899071
239000          MOVE LENGTH OF PV-CICS-MSG-AREA2                        23900071
239010                                    TO PV-COMMAREA-LENGTH         23901071
239020          EXEC CICS                                               23902071
239030               WRITEQ TD                                          23903071
239040                QUEUE   ('CSSL')                                  23904071
239050                FROM    (PV-CICS-MSG-AREA2)                       23905071
239060                LENGTH  (PV-COMMAREA-LENGTH)                      23906071
239070                RESP    (PV-CICS-RESP)                            23907071
239080          END-EXEC                                                23908071
239090     END-IF                                                       23909071
239100*===TKMA408=== THIS IS IN JUST FOR TESTING                        23910071
239110* CHECK FOR TCP-IP ERROR ON SEND HDR TO QNX                       23911071
239120                                                                  23912071
239130     PERFORM 4802-CK-RETCD-MF-WIN.                                23913071
239140                                                                  23914071
239150     IF  PS-NO-ERROR                                              23915071
239160         MOVE '4800-SEND-HDR-DATA-TO-QNX'                         23916071
239170           TO  PV-CALLING-PARAGRAPH                               23917071
239180         PERFORM 4973-CHECK-SOCKET-CONNECTION                     23918071
239190     END-IF.                                                      23919071
239200                                                                  23920071
239210     IF  PS-NO-ERROR                                              23921071
239220         MOVE '4800-SEND-HDR-DATA-TO-QNX'                         23922071
239230           TO  PV-CALLING-PARAGRAPH                               23923071
239240         PERFORM 4810-RECEIVE-CONFIRM-FROM-QNX                    23924071
239250     END-IF.                                                      23925071
239260                                                                  23926071
239270                                                                  23927071
239280*----------------------------------------------------------------*23928071
239290* CHECK FOR TCP-IP ERROR ON SEND HDR TO QNX                      *23929071
239300*----------------------------------------------------------------*23930071
239310 4802-CK-RETCD-MF-WIN.                                            23931071
239320*===TKMA408=== THIS IS IN JUST FOR TESTING                        23932071
239330*       INITIALIZE  PV-CICS-MSG-AREA2                             23933071
239340*      STRING ' PCKCS701 - '              DELIMITED BY SIZE       23934071
239350*             '4802-CK-RETCD-MF-WIN     ' DELIMITED BY SIZE       23935071
239360*                                   INTO PV-CICS-MSG-AREA2        23936071
239370*       MOVE LENGTH OF PV-CICS-MSG-AREA2                          23937071
239380*                                     TO PV-COMMAREA-LENGTH       23938071
239390*       EXEC CICS                                                 23939071
239400*           WRITEQ TD                                             23940071
239410*               QUEUE   ('CSSL')                                  23941071
239420*               FROM    (PV-CICS-MSG-AREA2)                       23942071
239430*               LENGTH  (PV-COMMAREA-LENGTH)                      23943071
239440*               RESP    (PV-CICS-RESP)                            23944071
239450*       END-EXEC                                                  23945071
239460*       INITIALIZE  PV-CICS-MSG-AREA2                             23946071
239470*===TKMA408=== THIS IS IN JUST FOR TESTING                        23947071
239480*                                                                 23948071
239490     SET   DP081-OUT-OF-BAND-FLAG    TO  TRUE.                    23949071
239500     IF    LQW-SOCKET-NBR (LQW-IDX)  =  PC-ONE                    23950071
239510           MOVE PV-SOCKET-ONE        TO  DP081-SOCK-ID            23951071
239520     ELSE                                                         23952071
239530           MOVE PV-SOCKET-TWO        TO  DP081-SOCK-ID            23953071
239540     END-IF.                                                      23954071
239550                                                                  23955071
239560                                                                  23956071
239570     CALL 'EZASOKET'                                              23957071
239580         USING DP081-SEND-CMD                                     23958071
239590               DP081-SOCK-ID                                      23959071
239600               DP081-FLAG                                         23960071
239610               DP081-NBR-BYTES                                    23961071
239620               TCP-BUF2                                           23962071
239630               DP081-ERRNO                                        23963071
239640               DP081-RETCODE.                                     23964071
239650                                                                  23965071
239660     IF DP081-RETCODE < ZERO                                      23966071
239670        MOVE PC-CURRENT-PROGRAM-NAME    TO DP081-TCP-IP-PGM-NAME  23967071
239680        SET  DP081-TCP-IP-SEND-ERR      TO TRUE                   23968071
239690        MOVE DP081-ERRNO                TO DP081-TCP-IP-ERR-NBR   23969071
239700                                           RECEIVE-ERRNO          23970071
239710        MOVE DP081-RETCODE              TO RECEIVE-RETCODE        23971071
239720        MOVE ASC-PO-NBR                 TO RECEIVE-RECEIVER       23972071
239730        MOVE ASC-REC-SEQ-NBR            TO RECEIVE-SEQ            23973071
239740        MOVE PV-PO-LINE-NBR-X           TO RECEIVE-LINE           23974071
239750        MOVE '4802'                     TO RECEIVE-PARA           23975071
239760        MOVE RECEIVE-ERR                TO PV-CICS-MSG-DATA       23976071
239770        MOVE PV-CICS-MSG-HOLD           TO PV-CICS-MSG-AREA       23977071
239780        MOVE LENGTH OF PV-CICS-MSG-AREA TO PV-COMMAREA-LENGTH     23978071
239790                                                                  23979071
239800        EXEC CICS                                                 23980071
239810            WRITEQ TD                                             23981071
239820                QUEUE   ('CSSL')                                  23982071
239830                FROM    (PV-CICS-MSG-AREA)                        23983071
239840                LENGTH  (PV-COMMAREA-LENGTH)                      23984071
239850                RESP    (PV-CICS-RESP)                            23985071
239860        END-EXEC                                                  23986071
239870                                                                  23987071
239880        MOVE '4802-CK-RETCD-MF-WIN'      TO PV-CALLING-PARAGRAPH  23988071
239890        MOVE PV-CALLING-PARAGRAPH        TO PV-CICS-MSG-DATA2     23989071
239900        MOVE PV-CICS-MSG-HOLD2           TO PV-CICS-MSG-AREA2     23990071
239910        MOVE LENGTH OF PV-CICS-MSG-AREA2 TO PV-COMMAREA-LENGTH    23991071
239920                                                                  23992071
239930        EXEC CICS                                                 23993071
239940            WRITEQ TD                                             23994071
239950                QUEUE   ('CSSL')                                  23995071
239960                FROM    (PV-CICS-MSG-AREA2)                       23996071
239970                LENGTH  (PV-COMMAREA-LENGTH)                      23997071
239980                RESP    (PV-CICS-RESP)                            23998071
239990        END-EXEC                                                  23999071
240000                                                                  24000071
240010        SET  PS-ERROR                                             24001071
240020             DP020-MSG-FATAL  TO TRUE                             24002071
240030        MOVE PC-TSYMSG-01766  TO DP020-MSG-NUMBER                 24003071
240040        PERFORM 9900-SOFT-ABORT                                   24004071
240050     END-IF.                                                      24005071
240060                                                                  24006071
240070                                                                  24007071
240080*----------------------------------------------------------------*24008071
240090*  CONNECT TO SOCKET WHICH WAS GIVEN TO US BY THE AL/SYSTEMS QNX *24009071
240100*  PROGRAM.  CONNECT THE PATH (SOCKET).  SEND 50 BYTES FOR DETAIL*24010071
240110*  AND TRAILER RECORDS ONLY.                                     *24011071
240120*----------------------------------------------------------------*24012071
240130*                                                                 24013071
240140 4805-SEND-DTL-TLR-TO-QNX.                                        24014071
240150*===TKMA408=== THIS IS IN JUST FOR TESTING                        24015071
240160*       INITIALIZE  PV-CICS-MSG-AREA2                             24016071
240170*      STRING ' PCKCS701 - '              DELIMITED BY SIZE       24017071
240180*             '4805-SEND-DTL-TLR-TO-QNX ' DELIMITED BY SIZE       24018071
240190*                                   INTO PV-CICS-MSG-AREA2        24019071
240200*       MOVE LENGTH OF PV-CICS-MSG-AREA2                          24020071
240210*                                     TO PV-COMMAREA-LENGTH       24021071
240220*       EXEC CICS                                                 24022071
240230*           WRITEQ TD                                             24023071
240240*               QUEUE   ('CSSL')                                  24024071
240250*               FROM    (PV-CICS-MSG-AREA2)                       24025071
240260*               LENGTH  (PV-COMMAREA-LENGTH)                      24026071
240270*               RESP    (PV-CICS-RESP)                            24027071
240280*       END-EXEC                                                  24028071
240290*       INITIALIZE  PV-CICS-MSG-AREA2                             24029071
240300*                                                                 24030071
240310*       MOVE PC053-DISTRO-RECORD      TO PV-CICS-152-RECORD       24031071
240320*       MOVE PV-CICS-1-99             TO PV-CICS-MSG-DATA2        24032071
240330*       MOVE PV-CICS-MSG-HOLD2        TO PV-CICS-MSG-AREA2        24033071
240340*       MOVE LENGTH OF PV-CICS-MSG-AREA2                          24034071
240350*                                     TO PV-COMMAREA-LENGTH       24035071
240360*       EXEC CICS                                                 24036071
240370*           WRITEQ TD                                             24037071
240380*               QUEUE   ('CSSL')                                  24038071
240390*               FROM    (PV-CICS-MSG-AREA2)                       24039071
240400*               LENGTH  (PV-COMMAREA-LENGTH)                      24040071
240410*               RESP    (PV-CICS-RESP)                            24041071
240420*       END-EXEC                                                  24042071
240430*===TKMA408=== THIS IS IN JUST FOR TESTING                        24043071
240440                                                                  24044071
240450     MOVE LOW-VALUES              TO TCP-BUF2.                    24045071
240460     MOVE 50                      TO DP081-TCPLENG                24046071
240470                                     DP081-NBR-BYTES.             24047071
240480                                                                  24048071
240490     IF  LQW-P2L-ALS-4-DIGIT-STR (LQW-IDX)                        24049071
240500         MOVE PC053-DISTRO-RECORD     TO TCP-BUF2                 24050071
240510     END-IF.                                                      24051071
240520                                                                  24052071
240530     CALL 'EZACIC04'                                              24053071
240540         USING DP081-TOASCII-TOKEN                                24054071
240550               TCP-BUF2                                           24055071
240560               DP081-TCPLENG.                                     24056071
240570                                                                  24057071
240580* CHECK FOR TCP-IP ERROR ON SEND DTL-TLR TO QNX                   24058071
240590                                                                  24059071
240600     PERFORM 4807-DTL-TLR-CK-RETCD-MF-WIN.                        24060071
240610                                                                  24061071
240620     IF  PS-NO-ERROR                                              24062071
240630         MOVE '4805-SEND-DTL-TLR-TO-QNX '                         24063071
240640           TO  PV-CALLING-PARAGRAPH                               24064071
240650         PERFORM 4973-CHECK-SOCKET-CONNECTION                     24065071
240660     END-IF.                                                      24066071
240670                                                                  24067071
240680     IF  PS-NO-ERROR                                              24068071
240690         MOVE '4805-SEND-DTL-TLR-TO-QNX '                         24069071
240700           TO  PV-CALLING-PARAGRAPH                               24070071
240710         PERFORM 4810-RECEIVE-CONFIRM-FROM-QNX                    24071071
240720     END-IF.                                                      24072071
240730                                                                  24073071
240740                                                                  24074071
240750*----------------------------------------------------------------*24075071
240760* CHECK FOR TCP-IP ERROR ON SEND DTL-TLR TO QNX                  *24076071
240770* MENOMONEE FALLS & WINCHESTER                                   *24077071
240780*----------------------------------------------------------------*24078071
240790 4807-DTL-TLR-CK-RETCD-MF-WIN.                                    24079071
240800*                                                                 24080071
240810*===TKMA408=== THIS IS IN JUST FOR TESTING                        24081071
240820*       INITIALIZE  PV-CICS-MSG-AREA2                             24082071
240830*      STRING ' PCKCS701 - '              DELIMITED BY SIZE       24083071
240840*             '4807-DTL-TLR-CK-RETCD-MF-' DELIMITED BY SIZE       24084071
240850*                                   INTO PV-CICS-MSG-AREA2        24085071
240860*       MOVE LENGTH OF PV-CICS-MSG-AREA2                          24086071
240870*                                     TO PV-COMMAREA-LENGTH       24087071
240880*       EXEC CICS                                                 24088071
240890*           WRITEQ TD                                             24089071
240900*               QUEUE   ('CSSL')                                  24090071
240910*               FROM    (PV-CICS-MSG-AREA2)                       24091071
240920*               LENGTH  (PV-COMMAREA-LENGTH)                      24092071
240930*               RESP    (PV-CICS-RESP)                            24093071
240940*       END-EXEC                                                  24094071
240950*       INITIALIZE  PV-CICS-MSG-AREA2                             24095071
240960*===TKMA408=== THIS IS IN JUST FOR TESTING                        24096071
240970                                                                  24097071
240980     SET   DP081-OUT-OF-BAND-FLAG    TO  TRUE.                    24098071
240990     IF    LQW-SOCKET-NBR (LQW-IDX)  =  PC-ONE                    24099071
241000           MOVE PV-SOCKET-ONE        TO  DP081-SOCK-ID            24100071
241010     ELSE                                                         24101071
241020           MOVE PV-SOCKET-TWO        TO  DP081-SOCK-ID            24102071
241030     END-IF.                                                      24103071
241040                                                                  24104071
241050                                                                  24105071
241060     CALL 'EZASOKET'                                              24106071
241070         USING DP081-SEND-CMD                                     24107071
241080               DP081-SOCK-ID                                      24108071
241090               DP081-FLAG                                         24109071
241100               DP081-NBR-BYTES                                    24110071
241110               TCP-BUF2                                           24111071
241120               DP081-ERRNO                                        24112071
241130               DP081-RETCODE.                                     24113071
241140                                                                  24114071
241150* CHECK FOR TCP-IP ERROR ON SEND DTL/TLR TO QNX                   24115071
241160                                                                  24116071
241170     IF DP081-RETCODE < ZERO                                      24117071
241180        MOVE PC-CURRENT-PROGRAM-NAME    TO DP081-TCP-IP-PGM-NAME  24118071
241190        SET  DP081-TCP-IP-SEND-ERR      TO TRUE                   24119071
241200        MOVE DP081-ERRNO                TO DP081-TCP-IP-ERR-NBR   24120071
241210                                           RECEIVE-ERRNO          24121071
241220        MOVE DP081-RETCODE              TO RECEIVE-RETCODE        24122071
241230        MOVE ASC-PO-NBR                 TO RECEIVE-RECEIVER       24123071
241240        MOVE ASC-REC-SEQ-NBR            TO RECEIVE-SEQ            24124071
241250        MOVE PV-PO-LINE-NBR-X           TO RECEIVE-LINE           24125071
241260        MOVE '4807'                     TO RECEIVE-PARA           24126071
241270        MOVE RECEIVE-ERR                TO PV-CICS-MSG-DATA       24127071
241280        MOVE PV-CICS-MSG-HOLD           TO PV-CICS-MSG-AREA       24128071
241290        MOVE LENGTH OF PV-CICS-MSG-AREA TO PV-COMMAREA-LENGTH     24129071
241300                                                                  24130071
241310        EXEC CICS                                                 24131071
241320            WRITEQ TD                                             24132071
241330                QUEUE   ('CSSL')                                  24133071
241340                FROM    (PV-CICS-MSG-AREA)                        24134071
241350                LENGTH  (PV-COMMAREA-LENGTH)                      24135071
241360                RESP    (PV-CICS-RESP)                            24136071
241370        END-EXEC                                                  24137071
241380                                                                  24138071
241390        MOVE '4807-DTL-TLR-CK-RETCD-MF-WIN'                       24139071
241400                                         TO PV-CALLING-PARAGRAPH  24140071
241410        MOVE PV-CALLING-PARAGRAPH        TO PV-CICS-MSG-DATA2     24141071
241420        MOVE PV-CICS-MSG-HOLD2           TO PV-CICS-MSG-AREA2     24142071
241430        MOVE LENGTH OF PV-CICS-MSG-AREA2 TO PV-COMMAREA-LENGTH    24143071
241440                                                                  24144071
241450        EXEC CICS                                                 24145071
241460            WRITEQ TD                                             24146071
241470                QUEUE   ('CSSL')                                  24147071
241480                FROM    (PV-CICS-MSG-AREA2)                       24148071
241490                LENGTH  (PV-COMMAREA-LENGTH)                      24149071
241500                RESP    (PV-CICS-RESP)                            24150071
241510        END-EXEC                                                  24151071
241520                                                                  24152071
241530        SET  PS-ERROR                                             24153071
241540             DP020-MSG-FATAL  TO TRUE                             24154071
241550        IF  PS-DISTHD-UPDATE                                      24155071
241560            MOVE PC-TSYMSG-02458  TO DP020-MSG-NUMBER             24156071
241570        ELSE                                                      24157071
241580            MOVE PC-TSYMSG-01766  TO DP020-MSG-NUMBER             24158071
241590        END-IF                                                    24159071
241600        PERFORM 9900-SOFT-ABORT                                   24160071
241610     END-IF.                                                      24161071
241620                                                                  24162071
241630                                                                  24163071
241640*----------------------------------------------------------------*24164071
241650*  RECEIVE CONFIRMATION BACK FROM AL SYSTEMS THAT THEY RECEIVED  *24165071
241660*  ALL RECORDS CORRECTLY.                                        *24166071
241670*----------------------------------------------------------------*24167071
241680 4810-RECEIVE-CONFIRM-FROM-QNX.                                   24168071
241690*                                                                 24169071
241700*===TKMA408=== THIS IS IN JUST FOR TESTING                        24170071
241710*       INITIALIZE  PV-CICS-MSG-AREA2                             24171071
241720*      STRING ' PCKCS701 - '              DELIMITED BY SIZE       24172071
241730*             '4810-RECEIVE-CONFIRM-FROM' DELIMITED BY SIZE       24173071
241740*                                   INTO PV-CICS-MSG-AREA2        24174071
241750*       MOVE LENGTH OF PV-CICS-MSG-AREA2                          24175071
241760*                                     TO PV-COMMAREA-LENGTH       24176071
241770*       EXEC CICS                                                 24177071
241780*           WRITEQ TD                                             24178071
241790*               QUEUE   ('CSSL')                                  24179071
241800*               FROM    (PV-CICS-MSG-AREA2)                       24180071
241810*               LENGTH  (PV-COMMAREA-LENGTH)                      24181071
241820*               RESP    (PV-CICS-RESP)                            24182071
241830*       END-EXEC                                                  24183071
241840*       INITIALIZE  PV-CICS-MSG-AREA2                             24184071
241850*===TKMA408=== THIS IS IN JUST FOR TESTING                        24185071
241860                                                                  24186071
241870     IF    LQW-SOCKET-NBR (LQW-IDX)  =  PC-ONE                    24187071
241880           MOVE PV-SOCKET-ONE        TO  DP081-SOCK-ID            24188071
241890     ELSE                                                         24189071
241900           MOVE PV-SOCKET-TWO        TO  DP081-SOCK-ID            24190071
241910     END-IF.                                                      24191071
241920                                                                  24192071
241930     MOVE LOW-VALUES                 TO  TCP-BUF2.                24193071
241940     MOVE 50                         TO  DP081-TCPLENG            24194071
241950                                         DP081-NBR-BYTES.         24195071
241960                                                                  24196071
241970     CALL 'EZASOKET'                                              24197071
241980         USING DP081-RECV-CMD                                     24198071
241990               DP081-SOCK-ID                                      24199071
242000               DP081-RECV-FLAG                                    24200071
242010               DP081-NBR-BYTES                                    24201071
242020               TCP-BUF                                            24202071
242030               DP081-ERRNO                                        24203071
242040               DP081-RETCODE.                                     24204071
242050                                                                  24205071
242060*----------------------------------------------------------------*24206071
242070*  CHECK FOR TCP-IP ERROR ON CONFIRM-RECEIVE                      24207071
242080*  RECEIVE CONFIRMATION BACK FROM AL SYSTEMS THAT THEY RECEIVED  *24208071
242090*  ALL RECORDS CORRECTLY. - MENO FALLS & WINCHESTER FACILITIES   *24209071
242100*----------------------------------------------------------------*24210071
242110*                                                                 24211071
242120                                                                  24212071
242130     IF  DP081-RETCODE < ZERO                                     24213071
242140         MOVE  DP081-RETCODE  TO  PV-SOCKET-RETCODE               24214071
242150         MOVE  DP081-ERRNO    TO  PV-SOCKET-ERRNO                 24215071
242160         INITIALIZE  PV-CICS-MSG-AREA2                            24216071
242170         STRING ' PCKCS701 - '              DELIMITED BY SIZE     24217071
242180                '4810-RECEIVE-CONF'         DELIMITED BY SIZE     24218071
242190                ' RETCODE = '               DELIMITED BY SIZE     24219071
242200                PV-SOCKET-RETCODE           DELIMITED BY SIZE     24220071
242210                ' ERROR # = '               DELIMITED BY SIZE     24221071
242220                PV-SOCKET-ERRNO             DELIMITED BY SIZE     24222071
242230                                        INTO PV-CICS-MSG-AREA2    24223071
242240         MOVE LENGTH OF PV-CICS-MSG-AREA2 TO PV-COMMAREA-LENGTH   24224071
242250                                                                  24225071
242260         EXEC CICS                                                24226071
242270             WRITEQ TD                                            24227071
242280                 QUEUE   ('CSSL')                                 24228071
242290                 FROM    (PV-CICS-MSG-AREA2)                      24229071
242300                 LENGTH  (PV-COMMAREA-LENGTH)                     24230071
242310                 RESP    (PV-CICS-RESP)                           24231071
242320         END-EXEC                                                 24232071
242330                                                                  24233071
242340         MOVE PC-CURRENT-PROGRAM-NAME    TO DP081-TCP-IP-PGM-NAME 24234071
242350         SET  DP081-TCP-IP-READ-ERR      TO TRUE                  24235071
242360         MOVE DP081-ERRNO                TO DP081-TCP-IP-ERR-NBR  24236071
242370         MOVE DP081-TCP-IP-LOGGING-MSG   TO PV-CICS-MSG-DATA      24237071
242380         MOVE PV-CICS-MSG-HOLD           TO PV-CICS-MSG-AREA      24238071
242390         MOVE LENGTH OF PV-CICS-MSG-AREA TO PV-COMMAREA-LENGTH    24239071
242400                                                                  24240071
242410         EXEC CICS                                                24241071
242420             WRITEQ TD                                            24242071
242430                 QUEUE   ('CSSL')                                 24243071
242440                 FROM    (PV-CICS-MSG-AREA)                       24244071
242450                 LENGTH  (PV-COMMAREA-LENGTH)                     24245071
242460                 RESP    (PV-CICS-RESP)                           24246071
242470         END-EXEC                                                 24247071
242480                                                                  24248071
242490         SET  PS-ERROR                                            24249071
242500              DP020-MSG-FATAL  TO TRUE                            24250071
242510         IF  PS-DISTHD-UPDATE                                     24251071
242520             MOVE PC-TSYMSG-02458  TO DP020-MSG-NUMBER            24252071
242530         ELSE                                                     24253071
242540             MOVE PC-TSYMSG-01766  TO DP020-MSG-NUMBER            24254071
242550         END-IF                                                   24255071
242560         PERFORM 9900-SOFT-ABORT                                  24256071
242570                                                                  24257071
242580     ELSE                                                         24258071
242590                                                                  24259071
242600         CALL 'EZACIC05'                                          24260071
242610             USING DP081-TOEBCDIC-TOKEN                           24261071
242620                   TCP-BUF                                        24262071
242630                   DP081-TCPLENG                                  24263071
242640                                                                  24264071
242650     END-IF.                                                      24265071
242660                                                                  24266071
242670* CHECK TO SEE IF AL SYSTEMS (P2L) RECEIVED TRANSMISSION OK       24267071
242680                                                                  24268071
242690     IF  LQW-P2L-ALS-4-DIGIT-STR (LQW-IDX)                        24269071
242700         MOVE TCP-BUF TO PC053-DISTRO-RECORD                      24270071
242710     END-IF.                                                      24271071
242720                                                                  24272071
242730*===TKMA408=== THIS IS IN JUST FOR TESTING                        24273071
242740     IF   PS-DISPLAY-CSSL-YES                                     24274071
242750          IF  LQW-P2L-ALS-4-DIGIT-STR (LQW-IDX)                   24275071
242760                 STRING ' PCKCS701-4810-AL '                      24276071
242770                        PC053-DISTRO-RECORD   DELIMITED BY SIZE   24277071
242780                                         INTO PV-CICS-152-RECORD  24278071
242790          END-IF                                                  24279071
242800        MOVE PV-CICS-1-99             TO PV-CICS-MSG-DATA2        24280071
242810        MOVE PV-CICS-MSG-HOLD2        TO PV-CICS-MSG-AREA2        24281071
242820        MOVE LENGTH OF PV-CICS-MSG-AREA2                          24282071
242830                                      TO PV-COMMAREA-LENGTH       24283071
242840        EXEC CICS                                                 24284071
242850            WRITEQ TD                                             24285071
242860                QUEUE   ('CSSL')                                  24286071
242870                FROM    (PV-CICS-MSG-AREA2)                       24287071
242880                LENGTH  (PV-COMMAREA-LENGTH)                      24288071
242890                RESP    (PV-CICS-RESP)                            24289071
242900        END-EXEC                                                  24290071
242910     END-IF.                                                      24291071
242920*===TKMA408=== THIS IS IN JUST FOR TESTING                        24292071
242930                                                                  24293071
242940     IF (LQW-P2L-ALS-4-DIGIT-STR (LQW-IDX) AND                    24294071
242950         NOT PC053-DISTRO-CONFIRM)                                24295071
242960                                                                  24296071
242970        PERFORM 4655-CLOSE-SOCKET                                 24297071
242980        SET  PS-SOCKET-INITIALIZED-NO   TO TRUE                   24298071
242990        MOVE PC-CURRENT-PROGRAM-NAME    TO DP081-TCP-IP-PGM-NAME  24299071
243000        SET  DP081-TCP-IP-READ-ERR      TO TRUE                   24300071
243010        MOVE DP081-ERRNO                TO DP081-TCP-IP-ERR-NBR   24301071
243020                                           RECEIVE-ERRNO          24302071
243030        MOVE ASC-PO-NBR                 TO RECEIVE-RECEIVER       24303071
243040        MOVE ASC-REC-SEQ-NBR            TO RECEIVE-SEQ            24304071
243050        MOVE PV-PO-LINE-NBR-X           TO RECEIVE-LINE           24305071
243060        MOVE '4810'                     TO RECEIVE-PARA           24306071
243070        MOVE RECEIVE-ERR                TO PV-CICS-MSG-DATA       24307071
243080        MOVE PV-CICS-MSG-HOLD           TO PV-CICS-MSG-AREA       24308071
243090        MOVE LENGTH OF PV-CICS-MSG-AREA TO PV-COMMAREA-LENGTH     24309071
243100                                                                  24310071
243110        EXEC CICS                                                 24311071
243120            WRITEQ TD                                             24312071
243130                QUEUE   ('CSSL')                                  24313071
243140                FROM    (PV-CICS-MSG-AREA)                        24314071
243150                LENGTH  (PV-COMMAREA-LENGTH)                      24315071
243160                RESP    (PV-CICS-RESP)                            24316071
243170        END-EXEC                                                  24317071
243180                                                                  24318071
243190        MOVE '4810-RECEIVE-CONFIRM- NOT PC053-DISTRO-CONFIRM'     24319071
243200                                         TO PV-CALLING-PARAGRAPH  24320071
243210        MOVE PV-CALLING-PARAGRAPH        TO PV-CICS-MSG-DATA2     24321071
243220        MOVE PV-CICS-MSG-HOLD2           TO PV-CICS-MSG-AREA2     24322071
243230        MOVE LENGTH OF PV-CICS-MSG-AREA2 TO PV-COMMAREA-LENGTH    24323071
243240                                                                  24324071
243250        EXEC CICS                                                 24325071
243260            WRITEQ TD                                             24326071
243270                QUEUE   ('CSSL')                                  24327071
243280                FROM    (PV-CICS-MSG-AREA2)                       24328071
243290                LENGTH  (PV-COMMAREA-LENGTH)                      24329071
243300                RESP    (PV-CICS-RESP)                            24330071
243310        END-EXEC                                                  24331071
243320                                                                  24332071
243330        SET  PS-ERROR                                             24333071
243340             DP020-MSG-FATAL  TO TRUE                             24334071
243350        IF  PS-DISTHD-UPDATE  OR                                  24335071
243360            PS-P2L-DISTRO-DELETE                                  24336071
243370            MOVE PC-TSYMSG-02458  TO DP020-MSG-NUMBER             24337071
243380        ELSE                                                      24338071
243390            MOVE PC-TSYMSG-01766  TO DP020-MSG-NUMBER             24339071
243400        END-IF                                                    24340071
243410        PERFORM 9900-SOFT-ABORT                                   24341071
243420     END-IF.                                                      24342071
243430                                                                  24343071
243440                                                                  24344071
243450*----------------------------------------------------------------*24345071
243460*  RECEIVE CONFIRMATION BACK FROM AL SYSTEMS THAT THEY RECEIVED  *24346071
243470*  ALL CARTON RECORDS CORRECTLY                                  *24347071
243480*----------------------------------------------------------------*24348071
243490 4815-RECEIVE-CONFIRM-FROM-QNX.                                   24349071
243500*                                                                 24350071
243510*===TKMA408=== THIS IS IN JUST FOR TESTING                        24351071
243520*       INITIALIZE  PV-CICS-MSG-AREA2                             24352071
243530*      STRING ' PCKCS701 - '              DELIMITED BY SIZE       24353071
243540*             '4815-RECEIVE-CONFIRM-FROM' DELIMITED BY SIZE       24354071
243550*                                   INTO PV-CICS-MSG-AREA2        24355071
243560*       MOVE LENGTH OF PV-CICS-MSG-AREA2                          24356071
243570*                                     TO PV-COMMAREA-LENGTH       24357071
243580*       EXEC CICS                                                 24358071
243590*           WRITEQ TD                                             24359071
243600*               QUEUE   ('CSSL')                                  24360071
243610*               FROM    (PV-CICS-MSG-AREA2)                       24361071
243620*               LENGTH  (PV-COMMAREA-LENGTH)                      24362071
243630*               RESP    (PV-CICS-RESP)                            24363071
243640*       END-EXEC                                                  24364071
243650*       INITIALIZE  PV-CICS-MSG-AREA2                             24365071
243660*===TKMA408=== THIS IS IN JUST FOR TESTING                        24366071
243670                                                                  24367071
243680     IF    LQW-SOCKET-NBR (LQW-IDX)  =  PC-ONE                    24368071
243690           MOVE PV-SOCKET-ONE        TO  DP081-SOCK-ID            24369071
243700     ELSE                                                         24370071
243710           MOVE PV-SOCKET-TWO        TO  DP081-SOCK-ID            24371071
243720     END-IF.                                                      24372071
243730                                                                  24373071
243740     MOVE LOW-VALUES                 TO  TCP-BUF2.                24374071
243750     MOVE 50                         TO  DP081-TCPLENG            24375071
243760                                         DP081-NBR-BYTES.         24376071
243770                                                                  24377071
243780     CALL 'EZASOKET'                                              24378071
243790         USING DP081-RECV-CMD                                     24379071
243800               DP081-SOCK-ID                                      24380071
243810               DP081-RECV-FLAG                                    24381071
243820               DP081-NBR-BYTES                                    24382071
243830               TCP-BUF                                            24383071
243840               DP081-ERRNO                                        24384071
243850               DP081-RETCODE.                                     24385071
243860                                                                  24386071
243870     CALL 'EZACIC05'                                              24387071
243880         USING DP081-TOEBCDIC-TOKEN                               24388071
243890               TCP-BUF                                            24389071
243900               DP081-TCPLENG.                                     24390071
243910                                                                  24391071
243920* CHECK FOR TCP-IP ERROR ON CONFIRM-RECEIVE                       24392071
243930                                                                  24393071
243940     PERFORM 4817-CK-CONFIRM-MF-WIN.                              24394071
243950                                                                  24395071
243960                                                                  24396071
243970*----------------------------------------------------------------*24397071
243980*  RECEIVE CONFIRMATION BACK FROM AL SYSTEMS THAT THEY RECEIVED  *24398071
243990*  ALL RECORDS CORRECTLY. - MENO FALLS & WINCHESTER FACILITIES   *24399071
244000*  -----CARTON RECORDS -----                                     *24400071
244010*----------------------------------------------------------------*24401071
244020 4817-CK-CONFIRM-MF-WIN.                                          24402071
244030*===TKMA408=== THIS IS IN JUST FOR TESTING                        24403071
244040*       INITIALIZE  PV-CICS-MSG-AREA2                             24404071
244050*      STRING ' PCKCS701 - '              DELIMITED BY SIZE       24405071
244060*             '4817-CK-CONFIRM-MF-WIN   ' DELIMITED BY SIZE       24406071
244070*                                   INTO PV-CICS-MSG-AREA2        24407071
244080*       MOVE LENGTH OF PV-CICS-MSG-AREA2                          24408071
244090*                                     TO PV-COMMAREA-LENGTH       24409071
244100*       EXEC CICS                                                 24410071
244110*           WRITEQ TD                                             24411071
244120*               QUEUE   ('CSSL')                                  24412071
244130*               FROM    (PV-CICS-MSG-AREA2)                       24413071
244140*               LENGTH  (PV-COMMAREA-LENGTH)                      24414071
244150*               RESP    (PV-CICS-RESP)                            24415071
244160*       END-EXEC                                                  24416071
244170*       INITIALIZE  PV-CICS-MSG-AREA2                             24417071
244180*===TKMA408=== THIS IS IN JUST FOR TESTING                        24418071
244190                                                                  24419071
244200     IF  DP081-RETCODE < ZERO                                     24420071
244210         MOVE PC-CURRENT-PROGRAM-NAME    TO DP081-TCP-IP-PGM-NAME 24421071
244220         SET  DP081-TCP-IP-READ-ERR      TO TRUE                  24422071
244230         MOVE DP081-RETCODE              TO DP081-TCP-IP-ERR-NBR  24423071
244240         MOVE DP081-TCP-IP-LOGGING-MSG   TO PV-CICS-MSG-DATA      24424071
244250         MOVE PV-CICS-MSG-HOLD           TO PV-CICS-MSG-AREA      24425071
244260         MOVE LENGTH OF PV-CICS-MSG-AREA TO PV-COMMAREA-LENGTH    24426071
244270                                                                  24427071
244280         EXEC CICS                                                24428071
244290             WRITEQ TD                                            24429071
244300                 QUEUE   ('CSSL')                                 24430071
244310                 FROM    (PV-CICS-MSG-AREA)                       24431071
244320                 LENGTH  (PV-COMMAREA-LENGTH)                     24432071
244330                 RESP    (PV-CICS-RESP)                           24433071
244340         END-EXEC                                                 24434071
244350                                                                  24435071
244360         MOVE PV-CALLING-PARAGRAPH        TO PV-CICS-MSG-DATA2    24436071
244370         MOVE PV-CICS-MSG-HOLD2           TO PV-CICS-MSG-AREA2    24437071
244380         MOVE LENGTH OF PV-CICS-MSG-AREA2 TO PV-COMMAREA-LENGTH   24438071
244390                                                                  24439071
244400         EXEC CICS                                                24440071
244410             WRITEQ TD                                            24441071
244420                 QUEUE   ('CSSL')                                 24442071
244430                 FROM    (PV-CICS-MSG-AREA2)                      24443071
244440                 LENGTH  (PV-COMMAREA-LENGTH)                     24444071
244450                 RESP    (PV-CICS-RESP)                           24445071
244460         END-EXEC                                                 24446071
244470                                                                  24447071
244480         SET  PS-ERROR                                            24448071
244490              DP020-MSG-FATAL  TO TRUE                            24449071
244500         IF  PS-DISTHD-UPDATE                                     24450071
244510             MOVE PC-TSYMSG-02458  TO DP020-MSG-NUMBER            24451071
244520         ELSE                                                     24452071
244530             MOVE PC-TSYMSG-01766  TO DP020-MSG-NUMBER            24453071
244540         END-IF                                                   24454071
244550         PERFORM 9900-SOFT-ABORT                                  24455071
244560     END-IF.                                                      24456071
244570                                                                  24457071
244580* CHECK TO SEE IF AL SYSTEMS (P2L) RECEIVED TRANSMISSION OK       24458071
244590                                                                  24459071
244600     MOVE TCP-BUF TO PC002-RECEIPT-RECORD.                        24460071
244610                                                                  24461071
244620*                                                                 24462071
244630*===TKMA408=== THIS IS IN JUST FOR TESTING                        24463071
244640     IF   PS-DISPLAY-CSSL-YES                                     24464071
244650             IF  LQW-P2L-DYNAPACK (LQW-IDX)                       24465071
244660                 STRING ' PCKCS701-4817-AL '                      24466071
244670                        PC002-RECEIPT-RECORD  DELIMITED BY SIZE   24467071
244680                                         INTO PV-CICS-152-RECORD  24468071
244690             ELSE                                                 24469071
244700                 STRING ' PCKCS701-4817-PCC '                     24470071
244710                        PC184-DISTRO-RECORD   DELIMITED BY SIZE   24471071
244720                                         INTO PV-CICS-152-RECORD  24472071
244730             END-IF                                               24473071
244740        MOVE PV-CICS-1-99             TO PV-CICS-MSG-DATA2        24474071
244750        MOVE PV-CICS-MSG-HOLD2        TO PV-CICS-MSG-AREA2        24475071
244760        MOVE LENGTH OF PV-CICS-MSG-AREA2                          24476071
244770                                      TO PV-COMMAREA-LENGTH       24477071
244780        EXEC CICS                                                 24478071
244790            WRITEQ TD                                             24479071
244800                QUEUE   ('CSSL')                                  24480071
244810                FROM    (PV-CICS-MSG-AREA2)                       24481071
244820                LENGTH  (PV-COMMAREA-LENGTH)                      24482071
244830                RESP    (PV-CICS-RESP)                            24483071
244840        END-EXEC                                                  24484071
244850     END-IF.                                                      24485071
244860*===TKMA408=== THIS IS IN JUST FOR TESTING                        24486071
244870                                                                  24487071
244880                                                                  24488071
244890     IF  (PC002-RECEIPT-CONFIRM  OR                               24489071
244900          PC002-RECEIPT-CARTON-CONFIRM)                           24490071
244910        CONTINUE                                                  24491071
244920     ELSE                                                         24492071
244930        PERFORM 4655-CLOSE-SOCKET                                 24493071
244940        SET PS-SOCKET-INITIALIZED-NO    TO TRUE                   24494071
244950        MOVE PC-CURRENT-PROGRAM-NAME    TO DP081-TCP-IP-PGM-NAME  24495071
244960        SET  DP081-TCP-IP-READ-ERR      TO TRUE                   24496071
244970        MOVE DP081-ERRNO                TO DP081-TCP-IP-ERR-NBR   24497071
244980                                           RECEIVE-ERRNO          24498071
244990        MOVE ASC-PO-NBR                 TO RECEIVE-RECEIVER       24499071
245000        MOVE ASC-REC-SEQ-NBR            TO RECEIVE-SEQ            24500071
245010        MOVE PV-PO-LINE-NBR-X           TO RECEIVE-LINE           24501071
245020        MOVE '4817'                     TO RECEIVE-PARA           24502071
245030        MOVE RECEIVE-ERR                TO PV-CICS-MSG-DATA       24503071
245040        MOVE PV-CICS-MSG-HOLD           TO PV-CICS-MSG-AREA       24504071
245050        MOVE LENGTH OF PV-CICS-MSG-AREA TO PV-COMMAREA-LENGTH     24505071
245060                                                                  24506071
245070        EXEC CICS                                                 24507071
245080            WRITEQ TD                                             24508071
245090                QUEUE   ('CSSL')                                  24509071
245100                FROM    (PV-CICS-MSG-AREA)                        24510071
245110                LENGTH  (PV-COMMAREA-LENGTH)                      24511071
245120                RESP    (PV-CICS-RESP)                            24512071
245130        END-EXEC                                                  24513071
245140                                                                  24514071
245150        MOVE '4817-CK-CONFIRM-MF-WIN - NOT CONFIRM'               24515071
245160                                         TO PV-CALLING-PARAGRAPH  24516071
245170        MOVE PV-CALLING-PARAGRAPH        TO PV-CICS-MSG-DATA2     24517071
245180        MOVE PV-CICS-MSG-HOLD2           TO PV-CICS-MSG-AREA2     24518071
245190        MOVE LENGTH OF PV-CICS-MSG-AREA2 TO PV-COMMAREA-LENGTH    24519071
245200                                                                  24520071
245210        EXEC CICS                                                 24521071
245220            WRITEQ TD                                             24522071
245230                QUEUE   ('CSSL')                                  24523071
245240                FROM    (PV-CICS-MSG-AREA2)                       24524071
245250                LENGTH  (PV-COMMAREA-LENGTH)                      24525071
245260                RESP    (PV-CICS-RESP)                            24526071
245270        END-EXEC                                                  24527071
245280                                                                  24528071
245290        SET  PS-ERROR                                             24529071
245300             DP020-MSG-FATAL  TO TRUE                             24530071
245310        IF  PS-DISTHD-UPDATE                                      24531071
245320            MOVE PC-TSYMSG-02458  TO DP020-MSG-NUMBER             24532071
245330        ELSE                                                      24533071
245340            MOVE PC-TSYMSG-01766  TO DP020-MSG-NUMBER             24534071
245350        END-IF                                                    24535071
245360        PERFORM 9900-SOFT-ABORT                                   24536071
245370     END-IF.                                                      24537071
245380                                                                  24538071
245390                                                                  24539071
245400*----------------------------------------------------------------*24540071
245410*  CONNECT TO SOCKET WHICH WAS GIVEN TO US BY THE AL/SYSTEMS QNX *24541071
245420*  PROGRAM.  CONNECT THE PATH (SOCKET).  SEND 50 BYTES FOR DETAIL*24542071
245430*  AND TRAILER RECORDS ONLY.                                     *24543071
245440*----------------------------------------------------------------*24544071
245450 4820-SEND-RCPT-RECS-TO-QNX.                                      24545071
245460*                                                                 24546071
245470*===TKMA408=== THIS IS IN JUST FOR TESTING                        24547071
245480*       INITIALIZE  PV-CICS-MSG-AREA2                             24548071
245490*      STRING ' PCKCS701 - '              DELIMITED BY SIZE       24549071
245500*             '4820-SEND-RCPT-RECS-TO-Q'  DELIMITED BY SIZE       24550071
245510*                                   INTO PV-CICS-MSG-AREA2        24551071
245520*       MOVE LENGTH OF PV-CICS-MSG-AREA2                          24552071
245530*                                     TO PV-COMMAREA-LENGTH       24553071
245540*       EXEC CICS                                                 24554071
245550*           WRITEQ TD                                             24555071
245560*               QUEUE   ('CSSL')                                  24556071
245570*               FROM    (PV-CICS-MSG-AREA2)                       24557071
245580*               LENGTH  (PV-COMMAREA-LENGTH)                      24558071
245590*               RESP    (PV-CICS-RESP)                            24559071
245600*       END-EXEC                                                  24560071
245610*       INITIALIZE  PV-CICS-MSG-AREA2                             24561071
245620*                                                                 24562071
245630*       MOVE PC002-RECEIPT-RECORD     TO PV-CICS-MSG-DATA2        24563071
245640*       MOVE PV-CICS-MSG-HOLD2        TO PV-CICS-MSG-AREA2        24564071
245650*       MOVE LENGTH OF PV-CICS-MSG-AREA2                          24565071
245660*                                     TO PV-COMMAREA-LENGTH       24566071
245670*       EXEC CICS                                                 24567071
245680*           WRITEQ TD                                             24568071
245690*               QUEUE   ('CSSL')                                  24569071
245700*               FROM    (PV-CICS-MSG-AREA2)                       24570071
245710*               LENGTH  (PV-COMMAREA-LENGTH)                      24571071
245720*               RESP    (PV-CICS-RESP)                            24572071
245730*       END-EXEC.                                                 24573071
245740*===TKMA408=== THIS IS IN JUST FOR TESTING                        24574071
245750                                                                  24575071
245760     MOVE LOW-VALUES              TO TCP-BUF.                     24576071
245770     MOVE 50                      TO DP081-TCPLENG                24577071
245780                                     DP081-NBR-BYTES.             24578071
245790     MOVE PC002-RECEIPT-RECORD    TO TCP-BUF.                     24579071
245800                                                                  24580071
245810     CALL 'EZACIC04'                                              24581071
245820         USING DP081-TOASCII-TOKEN                                24582071
245830               TCP-BUF2                                           24583071
245840               DP081-TCPLENG.                                     24584071
245850                                                                  24585071
245860     SET   DP081-OUT-OF-BAND-FLAG    TO  TRUE.                    24586071
245870     IF    LQW-SOCKET-NBR (LQW-IDX)  =  PC-ONE                    24587071
245880           MOVE PV-SOCKET-ONE        TO  DP081-SOCK-ID            24588071
245890     ELSE                                                         24589071
245900           MOVE PV-SOCKET-TWO        TO  DP081-SOCK-ID            24590071
245910     END-IF.                                                      24591071
245920                                                                  24592071
245930                                                                  24593071
245940* CHECK FOR TCP-IP ERROR ON SEND DTL-TLR TO QNX                   24594071
245950                                                                  24595071
245960     CALL 'EZASOKET'                                              24596071
245970         USING DP081-SEND-CMD                                     24597071
245980               DP081-SOCK-ID                                      24598071
245990               DP081-FLAG                                         24599071
246000               DP081-NBR-BYTES                                    24600071
246010               TCP-BUF2                                           24601071
246020               DP081-ERRNO                                        24602071
246030               DP081-RETCODE.                                     24603071
246040                                                                  24604071
246050* CHECK FOR TCP-IP ERROR ON SEND DTL/TLR TO QNX                   24605071
246060                                                                  24606071
246070     IF DP081-RETCODE < ZERO                                      24607071
246080        INITIALIZE PV-CICS-MSG-AREA                               24608071
246090        MOVE DK-PO-NBR      TO  PV-DSPLY-PO                       24609071
246100        MOVE DK-REC-SEQ-NBR TO  PV-DSPLY-RCVR                     24610071
246110        MOVE DK-LINE-NBR    TO  PV-DSPLY-LNE                      24611071
246120        STRING  ' PCKCS701 -'     DELIMITED BY SIZE               24612071
246130                ' PO/RCVR/LNE - ' DELIMITED BY SIZE               24613071
246140                PV-DSPLY-PO       DELIMITED BY SIZE               24614071
246150                '-'               DELIMITED BY SIZE               24615071
246160                PV-DSPLY-RCVR     DELIMITED BY SIZE               24616071
246170                '-'               DELIMITED BY SIZE               24617071
246180                PV-DSPLY-LNE      DELIMITED BY SIZE               24618071
246190                             INTO PV-CICS-MSG-AREA                24619071
246200        MOVE LENGTH OF PV-CICS-MSG-AREA TO PV-COMMAREA-LENGTH     24620071
246210                                                                  24621071
246220        EXEC CICS                                                 24622071
246230            WRITEQ TD                                             24623071
246240                QUEUE   ('CSSL')                                  24624071
246250                FROM    (PV-CICS-MSG-AREA)                        24625071
246260                LENGTH  (PV-COMMAREA-LENGTH)                      24626071
246270                RESP    (PV-CICS-RESP)                            24627071
246280        END-EXEC                                                  24628071
246290                                                                  24629071
246300        MOVE PC-CURRENT-PROGRAM-NAME    TO DP081-TCP-IP-PGM-NAME  24630071
246310        SET  DP081-TCP-IP-SEND-ERR      TO TRUE                   24631071
246320        MOVE DP081-ERRNO                TO DP081-TCP-IP-ERR-NBR   24632071
246330        MOVE DP081-TCP-IP-LOGGING-MSG   TO PV-CICS-MSG-DATA       24633071
246340        MOVE PV-CICS-MSG-HOLD           TO PV-CICS-MSG-AREA       24634071
246350        MOVE LENGTH OF PV-CICS-MSG-AREA TO PV-COMMAREA-LENGTH     24635071
246360                                                                  24636071
246370        EXEC CICS                                                 24637071
246380            WRITEQ TD                                             24638071
246390                QUEUE   ('CSSL')                                  24639071
246400                FROM    (PV-CICS-MSG-AREA)                        24640071
246410                LENGTH  (PV-COMMAREA-LENGTH)                      24641071
246420                RESP    (PV-CICS-RESP)                            24642071
246430        END-EXEC                                                  24643071
246440                                                                  24644071
246450        INITIALIZE PV-CICS-MSG-AREA                               24645071
246460        MOVE '4820-SEND-RCPT-RECS-TO-QN' TO PV-CALLING-PARAGRAPH  24646071
246470        MOVE PV-CALLING-PARAGRAPH        TO PV-CICS-MSG-DATA2     24647071
246480        MOVE PV-CICS-MSG-HOLD2           TO PV-CICS-MSG-AREA2     24648071
246490        MOVE LENGTH OF PV-CICS-MSG-AREA2 TO PV-COMMAREA-LENGTH    24649071
246500                                                                  24650071
246510        EXEC CICS                                                 24651071
246520            WRITEQ TD                                             24652071
246530                QUEUE   ('CSSL')                                  24653071
246540                FROM    (PV-CICS-MSG-AREA2)                       24654071
246550                LENGTH  (PV-COMMAREA-LENGTH)                      24655071
246560                RESP    (PV-CICS-RESP)                            24656071
246570        END-EXEC                                                  24657071
246580                                                                  24658071
246590        MOVE '4820-SEND-RCPT-RECS-TO-QNX' TO PV-CALLING-PARAGRAPH 24659071
246600        MOVE PV-CALLING-PARAGRAPH        TO PV-CICS-MSG-DATA2     24660071
246610        MOVE PV-CICS-MSG-HOLD2           TO PV-CICS-MSG-AREA2     24661071
246620        MOVE LENGTH OF PV-CICS-MSG-AREA2 TO PV-COMMAREA-LENGTH    24662071
246630                                                                  24663071
246640        EXEC CICS                                                 24664071
246650            WRITEQ TD                                             24665071
246660                QUEUE   ('CSSL')                                  24666071
246670                FROM    (PV-CICS-MSG-AREA2)                       24667071
246680                LENGTH  (PV-COMMAREA-LENGTH)                      24668071
246690                RESP    (PV-CICS-RESP)                            24669071
246700        END-EXEC                                                  24670071
246710                                                                  24671071
246720        SET  PS-ERROR                                             24672071
246730             DP020-MSG-FATAL  TO TRUE                             24673071
246740        IF  PS-DISTHD-UPDATE                                      24674071
246750            MOVE PC-TSYMSG-02458  TO DP020-MSG-NUMBER             24675071
246760        ELSE                                                      24676071
246770            MOVE PC-TSYMSG-01766  TO DP020-MSG-NUMBER             24677071
246780        END-IF                                                    24678071
246790        PERFORM 9900-SOFT-ABORT                                   24679071
246800     END-IF.                                                      24680071
246810                                                                  24681071
246820                                                                  24682071
246830     IF  PS-NO-ERROR                                              24683071
246840         MOVE '4815-SEND-RCPT-RECS-TO-QNX'                        24684071
246850           TO  PV-CALLING-PARAGRAPH                               24685071
246860         PERFORM 4973-CHECK-SOCKET-CONNECTION                     24686071
246870     END-IF.                                                      24687071
246880                                                                  24688071
246890     IF  PS-NO-ERROR                                              24689071
246900         MOVE '4815-SEND-RCPT-RECS-TO-QNX'                        24690071
246910           TO  PV-CALLING-PARAGRAPH                               24691071
246920         PERFORM 4815-RECEIVE-CONFIRM-FROM-QNX                    24692071
246930     END-IF.                                                      24693071
246940                                                                  24694071
246950                                                                  24695071
246960*-----------------------------------------------------------------24696071
246970* IF ODD-CARTON > 0 AND INNER PACK CONVEYABLE                    *24697071
246980* DETERMINE IF ODD-CARTON WILL BE USED AS FULL CASE OR INNERPACK *24698071
246990*-----------------------------------------------------------------24699071
247000 4850-ODD-CARTON-INPK-FCSE.                                       24700071
247010                                                                  24701071
247020     SET  PS-USE-ODD-CARTON-NONE  TO  TRUE.                       24702071
247030     SET  ASC-ODD-CRTN-NONE (ASC-BLK-SUB ASC-ITEM-SUB)            24703071
247040                                  TO  TRUE.                       24704071
247050                                                                  24705071
247060     MOVE  ZEROES  TO  PV-RECDIS-FCSE-EQUAL-CNT.                  24706071
247070                                                                  24707071
247080*                                                                 24708071
247090* IF ODD-CARTON    AND                                            24709071
247100*    INNER-PACK CONVEYABLE                                        24710071
247110*    DETERMINE IF CARTON BEING USED AS FULLCASE                   24711071
247120*                                                                 24712071
247130*    - CHECK RECDIS FOR STORE ALLOCATION = ODD CARTON UNIT QTY    24713071
247140*    - CHECK RECDIS FOR STORE ALLOCATION > ODD CARTON UNIT QTY    24714071
247150*                                                                 24715071
247160     PERFORM 4852-ODD-FCSE-EQUAL.                                 24716071
247170                                                                  24717071
247180     IF  PS-USE-ODD-CARTON-FCSE                                   24718071
247190         CONTINUE                                                 24719071
247200     ELSE                                                         24720071
247210         PERFORM 4854-ODD-FCSE-GREATER                            24721071
247220     END-IF.                                                      24722071
247230                                                                  24723071
247240     IF  PS-USE-ODD-CARTON-FCSE                                   24724071
247250         CONTINUE                                                 24725071
247260     ELSE                                                         24726071
247270     IF  ASC-IN-PAK-CONVEY-YES (ASC-BLK-SUB ASC-ITEM-SUB)         24727071
247280         SET  PS-USE-ODD-CARTON-INPK  TO  TRUE                    24728071
247290         SET  ASC-ODD-CRTN-INPK                                   24729071
247300              (ASC-BLK-SUB ASC-ITEM-SUB)                          24730071
247310              ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                    24731071
247320                                      TO TRUE                     24732071
247330     END-IF.                                                      24733071
247340                                                                  24734071
247350                                                                  24735071
247360*-----------------------------------------------------------------24736071
247370* DETERMINE IF STORE ALLOCATION = ODD CARTON UNIT QTY            -24737071
247380*-----------------------------------------------------------------24738071
247390 4852-ODD-FCSE-EQUAL.                                             24739071
247400     MOVE  ZEROES  TO  PV-RECDIS-ORD-NBR                          24740071
247410                                                                  24741071
247420     EXEC SQL                                                     24742071
247430         SELECT A.ORD_NBR                                         24743071
247440           INTO :PV-RECDIS-ORD-NBR                                24744071
247450           FROM TRECDIS A                                         24745071
247460          WHERE A.ORD_NBR         =  :DK-PO-NBR                   24746071
247470            AND A.REC_SEQ_NBR     =  :DK-REC-SEQ-NBR              24747071
247480            AND A.ORD_LNE_NBR     =  :DK-LINE-NBR                 24748071
247490            AND A.EXPTED_ITM_QTY  =  :PV-ODD-CARTON-UNT-QTY       24749071
247510          FETCH FIRST 1 ROW ONLY                                  24751071
247520     END-EXEC                                                     24752071
247530                                                                  24753071
247540     EVALUATE TRUE                                                24754071
247550         WHEN SQLCODE = +0                                        24755071
247560             IF  PV-RECDIS-ORD-NBR       > +0                     24756071
247570                 SET PS-USE-ODD-CARTON-FCSE  TO  TRUE             24757071
247580                 SET ASC-ODD-CRTN-FCSE                            24758071
247590                     (ASC-BLK-SUB ASC-ITEM-SUB)                   24759071
247600                     ASC-BLOCK-MODIFIED (ASC-BLK-SUB)             24760071
247610                                                 TO TRUE          24761071
247620             END-IF                                               24762071
247630         WHEN SQLCODE = +100                                      24763071
247640              CONTINUE                                            24764071
247650         WHEN SQLCODE = -904                                      24765071
247660         WHEN SQLCODE = -911                                      24766071
247670         WHEN SQLCODE = -913                                      24767071
247680                                                                  24768071
247690             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    24769071
247700             MOVE '4852-ODD-FCSE-EQUAL'     TO PV-SOFT-PARAGRAPH  24770071
247710             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  24771071
247720             MOVE LENGTH OF PV-CICS-MSG-AREA2                     24772071
247730               TO PV-COMMAREA-LENGTH                              24773071
247740             EXEC CICS                                            24774071
247750                  WRITEQ TD                                       24775071
247760                   QUEUE  ('CSSL')                                24776071
247770                    FROM  (PV-CICS-MSG-AREA2)                     24777071
247780                  LENGTH  (PV-COMMAREA-LENGTH)                    24778071
247790                    RESP  (PV-CICS-RESP)                          24779071
247800             END-EXEC                                             24780071
247810                                                                  24781071
247820             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          24782071
247830             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              24783071
247840             PERFORM 9900-SOFT-ABORT                              24784071
247850         WHEN SQLWARN0 NOT = SPACES                               24785071
247860         WHEN SQLCODE < ZERO                                      24786071
247870         WHEN SQLCODE > ZERO                                      24787071
247880             MOVE '4852-ODD-FCSE-EQUAL'                           24788071
247890                               TO DP013-PARAGRAPH                 24789071
247900             MOVE 'CHECK USE OF ODD CARTON - FULLCASE'            24790071
247910                               TO DP013-MESSAGE-TEXT (1)          24791071
247920             MOVE SQLCA        TO DP013-SQLCA                     24792071
247930             MOVE 'TRECDIS'    TO DP013-DB2-TABLE-NAME (1)        24793071
247940             SET DP013-DB2-ABEND                                  24794071
247950                 DP013-XCTL-DISPLAY-RESTART                       24795071
247960                               TO TRUE                            24796071
247970             PERFORM DP013-0000-PROCESS-ABEND                     24797071
247980     END-EVALUATE.                                                24798071
247990                                                                  24799071
248000                                                                  24800071
248010*-----------------------------------------------------------------24801071
248020* DETERMINE IF STORE ALLOCATION > ODD CARTON UNIT QTY            -24802071
248030*-----------------------------------------------------------------24803071
248040 4854-ODD-FCSE-GREATER.                                           24804071
248050                                                                  24805071
248060     PERFORM 4856-OPEN-ODD-FCSE-CURSOR.                           24806071
248070                                                                  24807071
248080     SET PS-NOT-EOF-ODD-FCSE-CSR  TO  TRUE.                       24808071
248090                                                                  24809071
248100     PERFORM 4857-FETCH-ODD-FCSE-CSR                              24810071
248110       UNTIL PS-USE-ODD-CARTON-FCSE  OR                           24811071
248120             PS-EOF-ODD-FCSE-CSR     OR                           24812071
248130             PS-ERROR.                                            24813071
248140                                                                  24814071
248150     PERFORM 4859-CLOSE-ODD-FCSE-CURSOR.                          24815071
248160                                                                  24816071
248170                                                                  24817071
248180*----------------------------------------------------------------*24818071
248190* OPEN ODD_FCSE_CSR CURSOR                                       *24819071
248200*----------------------------------------------------------------*24820071
248210 4856-OPEN-ODD-FCSE-CURSOR.                                       24821071
248220     SET  PS-NO-SOFT-ABORT-ERROR  TO  TRUE.                       24822071
248230                                                                  24823071
248240     EXEC SQL                                                     24824071
248250         OPEN ODD_FCSE_CSR                                        24825071
248260     END-EXEC.                                                    24826071
248270                                                                  24827071
248280     EVALUATE TRUE                                                24828071
248290         WHEN SQLCODE = ZERO                                      24829071
248300             CONTINUE                                             24830071
248310         WHEN SQLCODE = -904                                      24831071
248320         WHEN SQLCODE = -911                                      24832071
248330         WHEN SQLCODE = -913                                      24833071
248340                                                                  24834071
248350             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   24835071
248360             MOVE '4856-OPEN-ODD-FCSE-CSR'                        24836071
248370                                             TO PV-SOFT-PARAGRAPH 24837071
248380             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 24838071
248390             MOVE LENGTH OF PV-CICS-MSG-AREA2                     24839071
248400               TO PV-COMMAREA-LENGTH                              24840071
248410             EXEC CICS                                            24841071
248420                  WRITEQ TD                                       24842071
248430                   QUEUE  ('CSSL')                                24843071
248440                    FROM  (PV-CICS-MSG-AREA2)                     24844071
248450                  LENGTH  (PV-COMMAREA-LENGTH)                    24845071
248460                    RESP  (PV-CICS-RESP)                          24846071
248470             END-EXEC                                             24847071
248480                                                                  24848071
248490              MOVE  PC-TSYMSG-01767  TO  DP020-MSG-NUMBER         24849071
248500              PERFORM 9900-SOFT-ABORT                             24850071
248510         WHEN SQLWARN0 NOT = SPACE                                24851071
248520         WHEN SQLCODE < ZERO                                      24852071
248530         WHEN SQLCODE > ZERO                                      24853071
248540             MOVE '4856-OPEN-ODD-FCSE-CURSOR'                     24854071
248550                                     TO DP013-PARAGRAPH           24855071
248560             MOVE 'OPEN THE ODD_FCSE_CSR CURSOR'                  24856071
248570                                     TO DP013-MESSAGE-TEXT (1)    24857071
248580             MOVE SQLCA              TO DP013-SQLCA               24858071
248590             MOVE 'TRECDIS'          TO DP013-DB2-TABLE-NAME (1)  24859071
248600             SET DP013-DB2-ABEND     TO TRUE                      24860071
248610             SET DP013-NO-ROLLBACK   TO TRUE                      24861071
248620             SET DP013-XCTL-DISPLAY-RESTART                       24862071
248630                                     TO TRUE                      24863071
248640             PERFORM DP013-0000-PROCESS-ABEND                     24864071
248650     END-EVALUATE.                                                24865071
248660                                                                  24866071
248670                                                                  24867071
248680*----------------------------------------------------------------*24868071
248690* FETCH ODD_FCSE_CSR                                             *24869071
248700*----------------------------------------------------------------*24870071
248710 4857-FETCH-ODD-FCSE-CSR.                                         24871071
248720     SET  PS-NO-SOFT-ABORT-ERROR  TO  TRUE.                       24872071
248730                                                                  24873071
248740     EXEC SQL                                                     24874071
248750         FETCH ODD_FCSE_CSR                                       24875071
248760          INTO :PV-ODD-RECDIS-STR-NBR,                            24876071
248770               :PV-ODD-RECDIS-EXPTED-ITM-QTY                      24877071
248780     END-EXEC.                                                    24878071
248790                                                                  24879071
248800     EVALUATE TRUE                                                24880071
248810         WHEN SQLCODE = ZERO                                      24881071
248820             PERFORM 4858-CHECK-ODD-CRTN-USE                      24882071
248830         WHEN SQLCODE = +100                                      24883071
248840             SET PS-EOF-ODD-FCSE-CSR TO TRUE                      24884071
248850         WHEN SQLCODE = -904                                      24885071
248860         WHEN SQLCODE = -911                                      24886071
248870         WHEN SQLCODE = -913                                      24887071
248880                                                                  24888071
248890             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   24889071
248900             MOVE '4857-FETCH-ODD-FCSE-CSR'                       24890071
248910                                             TO PV-SOFT-PARAGRAPH 24891071
248920             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 24892071
248930             MOVE LENGTH OF PV-CICS-MSG-AREA2                     24893071
248940               TO PV-COMMAREA-LENGTH                              24894071
248950             EXEC CICS                                            24895071
248960                  WRITEQ TD                                       24896071
248970                   QUEUE  ('CSSL')                                24897071
248980                    FROM  (PV-CICS-MSG-AREA2)                     24898071
248990                  LENGTH  (PV-COMMAREA-LENGTH)                    24899071
249000                    RESP  (PV-CICS-RESP)                          24900071
249010             END-EXEC                                             24901071
249020                                                                  24902071
249030              MOVE  PC-TSYMSG-01767  TO  DP020-MSG-NUMBER         24903071
249040              PERFORM 9900-SOFT-ABORT                             24904071
249050         WHEN SQLWARN0 NOT = SPACE                                24905071
249060         WHEN SQLCODE < ZERO                                      24906071
249070         WHEN SQLCODE > ZERO                                      24907071
249080             MOVE '4857-FETCH-ODD-FCSE-CSR'                       24908071
249090                                     TO DP013-PARAGRAPH           24909071
249100             MOVE 'ATTEMPTING TO FETCH A ROW OF THE RESULTS TABLE 24910071
249110-                 'FROM THE ODD_FCSE_CSR'                         24911071
249120                                     TO DP013-MESSAGE-TEXT (1)    24912071
249130             MOVE SQLCA              TO DP013-SQLCA               24913071
249140             MOVE 'TRECDIS'          TO DP013-DB2-TABLE-NAME (1)  24914071
249150             SET DP013-DB2-ABEND     TO TRUE                      24915071
249160             SET DP013-ROLLBACK      TO TRUE                      24916071
249170             SET DP013-XCTL-DISPLAY-RESTART                       24917071
249180                                     TO TRUE                      24918071
249190             PERFORM DP013-0000-PROCESS-ABEND                     24919071
249200     END-EVALUATE.                                                24920071
249210                                                                  24921071
249220                                                                  24922071
249230*----------------------------------------------------------------*24923071
249240* CHECK ODD CARTON USE IF STORE ALLOCATION > ODD UNIT QTY        *24924071
249250*----------------------------------------------------------------*24925071
249260 4858-CHECK-ODD-CRTN-USE.                                         24926071
249270                                                                  24927071
249280     MOVE  ZEROES  TO  PV-ODD-RECDIS-DIFF                         24928071
249290                       PV-ODD-RECDIS-CTNS                         24929071
249300                       PV-ODD-RECDIS-REMAINDER.                   24930071
249310                                                                  24931071
249320     SUBTRACT  PV-ODD-CARTON-UNT-QTY                              24932071
249330         FROM  PV-ODD-RECDIS-EXPTED-ITM-QTY                       24933071
249340       GIVING  PV-ODD-RECDIS-DIFF.                                24934071
249350                                                                  24935071
249360     DIVIDE    PV-ODD-RECDIS-DIFF                                 24936071
249370         BY    PV-OUTER-PACK-QTY                                  24937071
249380     GIVING    PV-ODD-RECDIS-CTNS                                 24938071
249390     REMAINDER PV-ODD-RECDIS-REMAINDER.                           24939071
249400                                                                  24940071
249410     IF  PV-ODD-RECDIS-REMAINDER  =  0                            24941071
249420         SET  PS-USE-ODD-CARTON-FCSE  TO  TRUE                    24942071
249430         SET  ASC-ODD-CRTN-FCSE                                   24943071
249440              (ASC-BLK-SUB ASC-ITEM-SUB)                          24944071
249450              ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                    24945071
249460                                      TO TRUE                     24946071
249470     END-IF.                                                      24947071
249480                                                                  24948071
249490                                                                  24949071
249500*----------------------------------------------------------------*24950071
249510* CLOSE ODD_FCSE_CSR CURSOR                                      *24951071
249520*----------------------------------------------------------------*24952071
249530 4859-CLOSE-ODD-FCSE-CURSOR.                                      24953071
249540     SET  PS-NO-SOFT-ABORT-ERROR  TO  TRUE.                       24954071
249550                                                                  24955071
249560     EXEC SQL                                                     24956071
249570         CLOSE ODD_FCSE_CSR                                       24957071
249580     END-EXEC.                                                    24958071
249590                                                                  24959071
249600     EVALUATE TRUE                                                24960071
249610         WHEN SQLCODE = ZERO                                      24961071
249620             CONTINUE                                             24962071
249630         WHEN SQLCODE = -904                                      24963071
249640         WHEN SQLCODE = -911                                      24964071
249650         WHEN SQLCODE = -913                                      24965071
249660                                                                  24966071
249670             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   24967071
249680             MOVE '4859-CLOSE-ODD-FCSE-CSR'                       24968071
249690                                             TO PV-SOFT-PARAGRAPH 24969071
249700             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 24970071
249710             MOVE LENGTH OF PV-CICS-MSG-AREA2                     24971071
249720               TO PV-COMMAREA-LENGTH                              24972071
249730             EXEC CICS                                            24973071
249740                  WRITEQ TD                                       24974071
249750                   QUEUE  ('CSSL')                                24975071
249760                    FROM  (PV-CICS-MSG-AREA2)                     24976071
249770                  LENGTH  (PV-COMMAREA-LENGTH)                    24977071
249780                    RESP  (PV-CICS-RESP)                          24978071
249790             END-EXEC                                             24979071
249800                                                                  24980071
249810              MOVE  PC-TSYMSG-01767  TO  DP020-MSG-NUMBER         24981071
249820              PERFORM 9900-SOFT-ABORT                             24982071
249830         WHEN SQLWARN0 NOT = SPACE                                24983071
249840         WHEN SQLCODE < ZERO                                      24984071
249850         WHEN SQLCODE > ZERO                                      24985071
249860             MOVE '4859-CLOSE-ODD-FCSE-CURSOR'                    24986071
249870                                     TO DP013-PARAGRAPH           24987071
249880             MOVE 'CLOSE THE ODD_FCSE_CSR CURSOR'                 24988071
249890                                     TO DP013-MESSAGE-TEXT (1)    24989071
249900             MOVE SQLCA              TO DP013-SQLCA               24990071
249910             MOVE 'TRECDIS'          TO DP013-DB2-TABLE-NAME (1)  24991071
249920             SET DP013-DB2-ABEND     TO TRUE                      24992071
249930             SET DP013-NO-ROLLBACK   TO TRUE                      24993071
249940             SET DP013-XCTL-DISPLAY-RESTART                       24994071
249950                                     TO TRUE                      24995071
249960             PERFORM DP013-0000-PROCESS-ABEND                     24996071
249970     END-EVALUATE.                                                24997071
249980                                                                  24998071
249990                                                                  24999071
250000*-----------------------------------------------------------------25000071
250010* IF ODD-CARTON > 0 AND INNER PACK CONVEYABLE                    *25001071
250020* DETERMINE IF ODD-CARTON WILL BE USED AS FULL CASE OR INNERPACK *25002071
250030*-----------------------------------------------------------------25003071
250040 4860-ODD-CARTON-INPK-FCSE.                                       25004071
250050                                                                  25005071
250060     MOVE  ZEROES  TO  PV-RECDIS-FCSE-EQUAL-CNT.                  25006071
250070                                                                  25007071
250080*                                                                 25008071
250090* IF ODD-CARTON    AND                                            25009071
250100*    INNER-PACK CONVEYABLE                                        25010071
250110*    DETERMINE IF CARTON BEING USED AS FULLCASE                   25011071
250120*                                                                 25012071
250130*    - CHECK RECDIS FOR STORE ALLOCATION = ODD CARTON UNIT QTY    25013071
250140*    - CHECK RECDIS FOR STORE ALLOCATION > ODD CARTON UNIT QTY    25014071
250150*                                                                 25015071
250160     PERFORM 4862-ODD-FCSE-EQUAL.                                 25016071
250170                                                                  25017071
250180     IF  PS-USE-ODD-CARTON-FCSE                                   25018071
250190         CONTINUE                                                 25019071
250200     ELSE                                                         25020071
250210         PERFORM 4864-ODD-FCSE-GREATER                            25021071
250220     END-IF.                                                      25022071
250230                                                                  25023071
250240     IF  PS-USE-ODD-CARTON-FCSE                                   25024071
250250         CONTINUE                                                 25025071
250260     ELSE                                                         25026071
250270     IF  LQW-IN-PAK-CONVEY-YES (LQW-IDX)                          25027071
250280         SET  PS-USE-ODD-CARTON-INPK                              25028071
250290              LQW-ODD-CRTN-INPK (LQW-IDX)  TO  TRUE               25029071
250300     END-IF.                                                      25030071
250310                                                                  25031071
250320                                                                  25032071
250330*-----------------------------------------------------------------25033071
250340* DETERMINE IF STORE ALLOCATION = ODD CARTON UNIT QTY            -25034071
250350*-----------------------------------------------------------------25035071
250360 4862-ODD-FCSE-EQUAL.                                             25036071
250370     MOVE ZEROES  TO  PV-RECDIS-ORD-NBR                           25037071
250380     EXEC SQL                                                     25038071
250390         SELECT A.ORD_NBR                                         25039071
250400           INTO :PV-RECDIS-ORD-NBR                                25040071
250410           FROM TRECDIS A                                         25041071
250420          WHERE A.ORD_NBR         =  :DK-PO-NBR                   25042071
250430            AND A.REC_SEQ_NBR     =  :DK-REC-SEQ-NBR              25043071
250440            AND A.ORD_LNE_NBR     =  :DK-LINE-NBR                 25044071
250450            AND A.EXPTED_ITM_QTY  =  :PV-ODD-CARTON-UNT-QTY       25045071
250470          FETCH FIRST 1 ROW ONLY                                  25047071
250480     END-EXEC                                                     25048071
250490                                                                  25049071
250500     EVALUATE TRUE                                                25050071
250510         WHEN SQLCODE = +0                                        25051071
250520             IF PV-RECDIS-ORD-NBR        > +0                     25052071
250530                 SET PS-USE-ODD-CARTON-FCSE                       25053071
250540                     LQW-ODD-CRTN-FCSE (LQW-IDX) TO TRUE          25054071
250550             END-IF                                               25055071
250551         WHEN SQLCODE = +100                                      25055171
250552              CONTINUE                                            25055271
250553         WHEN SQLCODE = -904                                      25055371
250554         WHEN SQLCODE = -911                                      25055471
250555         WHEN SQLCODE = -913                                      25055571
250556                                                                  25055671
250557             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    25055771
250558             MOVE '4862-ODD-FCSE-EQUAL'     TO PV-SOFT-PARAGRAPH  25055871
250559             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  25055971
250560             MOVE LENGTH OF PV-CICS-MSG-AREA2                     25056071
250570               TO PV-COMMAREA-LENGTH                              25057071
250580             EXEC CICS                                            25058071
250590                  WRITEQ TD                                       25059071
250600                   QUEUE  ('CSSL')                                25060071
250610                    FROM  (PV-CICS-MSG-AREA2)                     25061071
250620                  LENGTH  (PV-COMMAREA-LENGTH)                    25062071
250630                    RESP  (PV-CICS-RESP)                          25063071
250640             END-EXEC                                             25064071
250650                                                                  25065071
250660             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          25066071
250670             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              25067071
250680             PERFORM 9900-SOFT-ABORT                              25068071
250690         WHEN SQLWARN0 NOT = SPACES                               25069071
250700         WHEN SQLCODE < ZERO                                      25070071
250710         WHEN SQLCODE > ZERO                                      25071071
250720             MOVE '4862-ODD-FCSE-EQUAL'                           25072071
250730                               TO DP013-PARAGRAPH                 25073071
250740             MOVE 'CHECK USE OF ODD CARTON - FULLCASE'            25074071
250750                               TO DP013-MESSAGE-TEXT (1)          25075071
250760             MOVE SQLCA        TO DP013-SQLCA                     25076071
250770             MOVE 'TRECDIS'    TO DP013-DB2-TABLE-NAME (1)        25077071
250780             SET DP013-DB2-ABEND                                  25078071
250790                 DP013-XCTL-DISPLAY-RESTART                       25079071
250800                               TO TRUE                            25080071
250810             PERFORM DP013-0000-PROCESS-ABEND                     25081071
250820     END-EVALUATE.                                                25082071
250830                                                                  25083071
250840                                                                  25084071
250850*-----------------------------------------------------------------25085071
250860* DETERMINE IF STORE ALLOCATION > ODD CARTON UNIT QTY            -25086071
250870*-----------------------------------------------------------------25087071
250880 4864-ODD-FCSE-GREATER.                                           25088071
250890                                                                  25089071
250900     PERFORM 4856-OPEN-ODD-FCSE-CURSOR.                           25090071
250910                                                                  25091071
250920     PERFORM 4867-FETCH-ODD-FCSE-CSR                              25092071
250930       UNTIL PS-USE-ODD-CARTON-FCSE  OR                           25093071
250940             PS-EOF-ODD-FCSE-CSR     OR                           25094071
250950             PS-ERROR.                                            25095071
250960                                                                  25096071
250970     PERFORM 4859-CLOSE-ODD-FCSE-CURSOR.                          25097071
250980                                                                  25098071
250990                                                                  25099071
251000*----------------------------------------------------------------*25100071
251010* FETCH ODD_FCSE_CSR                                             *25101071
251020*----------------------------------------------------------------*25102071
251030 4867-FETCH-ODD-FCSE-CSR.                                         25103071
251040     SET  PS-NO-SOFT-ABORT-ERROR  TO  TRUE.                       25104071
251050                                                                  25105071
251060     EXEC SQL                                                     25106071
251070         FETCH ODD_FCSE_CSR                                       25107071
251080          INTO :PV-ODD-RECDIS-STR-NBR,                            25108071
251090               :PV-ODD-RECDIS-EXPTED-ITM-QTY                      25109071
251100     END-EXEC.                                                    25110071
251110                                                                  25111071
251120     EVALUATE TRUE                                                25112071
251130         WHEN SQLCODE = ZERO                                      25113071
251140             PERFORM 4868-CHECK-ODD-CRTN-USE                      25114071
251150         WHEN SQLCODE = +100                                      25115071
251160             SET PS-EOF-ODD-FCSE-CSR TO TRUE                      25116071
251170         WHEN SQLCODE = -904                                      25117071
251180         WHEN SQLCODE = -911                                      25118071
251190         WHEN SQLCODE = -913                                      25119071
251200                                                                  25120071
251210             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   25121071
251220             MOVE '4867-FETCH-ODD-FCSE-CSR'                       25122071
251230                                             TO PV-SOFT-PARAGRAPH 25123071
251240             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 25124071
251250             MOVE LENGTH OF PV-CICS-MSG-AREA2                     25125071
251260               TO PV-COMMAREA-LENGTH                              25126071
251270             EXEC CICS                                            25127071
251280                  WRITEQ TD                                       25128071
251290                   QUEUE  ('CSSL')                                25129071
251300                    FROM  (PV-CICS-MSG-AREA2)                     25130071
251310                  LENGTH  (PV-COMMAREA-LENGTH)                    25131071
251320                    RESP  (PV-CICS-RESP)                          25132071
251330             END-EXEC                                             25133071
251340                                                                  25134071
251350              MOVE  PC-TSYMSG-01767  TO  DP020-MSG-NUMBER         25135071
251360              PERFORM 9900-SOFT-ABORT                             25136071
251370         WHEN SQLWARN0 NOT = SPACE                                25137071
251380         WHEN SQLCODE < ZERO                                      25138071
251390         WHEN SQLCODE > ZERO                                      25139071
251400             MOVE '4867-FETCH-ODD-FCSE-CSR'                       25140071
251410                                     TO DP013-PARAGRAPH           25141071
251420             MOVE 'ATTEMPTING TO FETCH A ROW OF THE RESULTS TABLE 25142071
251430-                 'FROM THE ODD_FCSE_CSR'                         25143071
251440                                     TO DP013-MESSAGE-TEXT (1)    25144071
251450             MOVE SQLCA              TO DP013-SQLCA               25145071
251460             MOVE 'TRECDIS'          TO DP013-DB2-TABLE-NAME (1)  25146071
251470             SET DP013-DB2-ABEND     TO TRUE                      25147071
251480             SET DP013-ROLLBACK      TO TRUE                      25148071
251490             SET DP013-XCTL-DISPLAY-RESTART                       25149071
251500                                     TO TRUE                      25150071
251510             PERFORM DP013-0000-PROCESS-ABEND                     25151071
251520     END-EVALUATE.                                                25152071
251530                                                                  25153071
251540                                                                  25154071
251550*----------------------------------------------------------------*25155071
251560* CHECK ODD CARTON USE IF STORE ALLOCATION > ODD UNIT QTY        *25156071
251570*----------------------------------------------------------------*25157071
251580 4868-CHECK-ODD-CRTN-USE.                                         25158071
251590                                                                  25159071
251600     MOVE  ZEROES  TO  PV-ODD-RECDIS-DIFF                         25160071
251610                       PV-ODD-RECDIS-CTNS                         25161071
251620                       PV-ODD-RECDIS-REMAINDER.                   25162071
251630                                                                  25163071
251640     SUBTRACT  PV-ODD-CARTON-UNT-QTY                              25164071
251650         FROM  PV-ODD-RECDIS-EXPTED-ITM-QTY                       25165071
251660       GIVING  PV-ODD-RECDIS-DIFF.                                25166071
251670                                                                  25167071
251680     DIVIDE    PV-ODD-RECDIS-DIFF                                 25168071
251690         BY    PV-OUTER-PACK-QTY                                  25169071
251700     GIVING    PV-ODD-RECDIS-CTNS                                 25170071
251710     REMAINDER PV-ODD-RECDIS-REMAINDER.                           25171071
251720                                                                  25172071
251730     IF  PV-ODD-RECDIS-REMAINDER  =  0                            25173071
251740         SET  PS-USE-ODD-CARTON-FCSE                              25174071
251750              LQW-ODD-CRTN-FCSE(LQW-IDX)  TO  TRUE                25175071
251760     END-IF.                                                      25176071
251770                                                                  25177071
251780                                                                  25178071
251790*-----------------------------------------------------------------25179071
251800* IF ODD-CARTON > 0 AND INNER PACK CONVEYABLE                    *25180071
251810* DETERMINE IF ODD-CARTON WILL BE USED AS FULL CASE OR INNERPACK *25181071
251820*-----------------------------------------------------------------25182071
251830 4870-ODD-CARTON-INPK-FCSE.                                       25183071
251840                                                                  25184071
251850     SET  PS-USE-ODD-CARTON-NONE       TO  TRUE.                  25185071
251860     SET  LQW-ODD-CRTN-NONE (LQW-IDX)  TO  TRUE.                  25186071
251870                                                                  25187071
251880     MOVE  ZEROES  TO  PV-RECDIS-FCSE-EQUAL-CNT.                  25188071
251890                                                                  25189071
251900*                                                                 25190071
251910* IF ODD-CARTON    AND                                            25191071
251920*    INNER-PACK CONVEYABLE                                        25192071
251930*    DETERMINE IF CARTON BEING USED AS FULLCASE                   25193071
251940*                                                                 25194071
251950*    - CHECK RECDIS FOR STORE ALLOCATION = ODD CARTON UNIT QTY    25195071
251960*    - CHECK RECDIS FOR STORE ALLOCATION > ODD CARTON UNIT QTY    25196071
251970*                                                                 25197071
251980     PERFORM 4872-ODD-FCSE-EQUAL.                                 25198071
251990                                                                  25199071
252000     IF  PS-USE-ODD-CARTON-FCSE                                   25200071
252010         CONTINUE                                                 25201071
252020     ELSE                                                         25202071
252030         PERFORM 4874-ODD-FCSE-GREATER                            25203071
252040     END-IF.                                                      25204071
252050                                                                  25205071
252060     IF  PS-USE-ODD-CARTON-FCSE                                   25206071
252070         CONTINUE                                                 25207071
252080     ELSE                                                         25208071
252090     IF  LQW-IN-PAK-CONVEY-YES (LQW-IDX)                          25209071
252100         SET  PS-USE-ODD-CARTON-INPK                              25210071
252110              LQW-ODD-CRTN-INPK (LQW-IDX)  TO TRUE                25211071
252120     END-IF.                                                      25212071
252130                                                                  25213071
252140                                                                  25214071
252150*-----------------------------------------------------------------25215071
252160* DETERMINE IF STORE ALLOCATION = ODD CARTON UNIT QTY            -25216071
252170*-----------------------------------------------------------------25217071
252180 4872-ODD-FCSE-EQUAL.                                             25218071
252190                                                                  25219071
252200      MOVE  ZEROES  TO  PV-RECDIS-ORD-NBR                         25220071
252210                                                                  25221071
252220     EXEC SQL                                                     25222071
252230         SELECT A.ORD_NBR                                         25223071
252240           INTO :PV-RECDIS-ORD-NBR                                25224071
252250           FROM TRECDIS A                                         25225071
252260          WHERE A.ORD_NBR         =  :DK-PO-NBR                   25226071
252270            AND A.REC_SEQ_NBR     =  :DK-REC-SEQ-NBR              25227071
252280            AND A.ORD_LNE_NBR     =  :DK-LINE-NBR                 25228071
252290            AND A.EXPTED_ITM_QTY  =  :PV-ODD-CARTON-UNT-QTY       25229071
252310          FETCH FIRST 1 ROW ONLY                                  25231071
252320     END-EXEC                                                     25232071
252330                                                                  25233071
252340     EVALUATE TRUE                                                25234071
252350         WHEN SQLCODE = +0                                        25235071
252360             IF PV-RECDIS-ORD-NBR        > +0                     25236071
252370                 SET PS-USE-ODD-CARTON-FCSE                       25237071
252380                     LQW-ODD-CRTN-FCSE (LQW-IDX)  TO  TRUE        25238071
252390             END-IF                                               25239071
252400         WHEN SQLCODE = +100                                      25240071
252410              CONTINUE                                            25241071
252420                                                                  25242071
252421         WHEN SQLCODE = -904                                      25242171
252422         WHEN SQLCODE = -911                                      25242271
252423         WHEN SQLCODE = -913                                      25242371
252424                                                                  25242471
252425             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    25242571
252426             MOVE '4872-ODD-FCSE-EQUAL'     TO PV-SOFT-PARAGRAPH  25242671
252427             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  25242771
252428             MOVE LENGTH OF PV-CICS-MSG-AREA2                     25242871
252429               TO PV-COMMAREA-LENGTH                              25242971
252430             EXEC CICS                                            25243071
252440                  WRITEQ TD                                       25244071
252450                   QUEUE  ('CSSL')                                25245071
252460                    FROM  (PV-CICS-MSG-AREA2)                     25246071
252470                  LENGTH  (PV-COMMAREA-LENGTH)                    25247071
252480                    RESP  (PV-CICS-RESP)                          25248071
252490             END-EXEC                                             25249071
252500                                                                  25250071
252510             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          25251071
252520             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              25252071
252530             PERFORM 9900-SOFT-ABORT                              25253071
252540         WHEN SQLWARN0 NOT = SPACES                               25254071
252550         WHEN SQLCODE < ZERO                                      25255071
252560         WHEN SQLCODE > ZERO                                      25256071
252570             MOVE '4872-ODD-FCSE-EQUAL'                           25257071
252580                               TO DP013-PARAGRAPH                 25258071
252590             MOVE 'CHECK USE OF ODD CARTON - FULLCASE'            25259071
252600                               TO DP013-MESSAGE-TEXT (1)          25260071
252610             MOVE SQLCA        TO DP013-SQLCA                     25261071
252620             MOVE 'TRECDIS'    TO DP013-DB2-TABLE-NAME (1)        25262071
252630             SET DP013-DB2-ABEND                                  25263071
252640                 DP013-XCTL-DISPLAY-RESTART                       25264071
252650                               TO TRUE                            25265071
252660             PERFORM DP013-0000-PROCESS-ABEND                     25266071
252670     END-EVALUATE.                                                25267071
252680                                                                  25268071
252690                                                                  25269071
252700*-----------------------------------------------------------------25270071
252710* DETERMINE IF STORE ALLOCATION > ODD CARTON UNIT QTY            -25271071
252720*-----------------------------------------------------------------25272071
252730 4874-ODD-FCSE-GREATER.                                           25273071
252740                                                                  25274071
252750     MOVE LQW-PO-RCVR-LINE(LQW-IDX)  TO  ASC-PO-LINE-NBR.         25275071
252760     PERFORM 4876-OPEN-ODD-FCSE-CURSOR.                           25276071
252770                                                                  25277071
252780     SET PS-NOT-EOF-ODD-FCSE-CSR  TO  TRUE.                       25278071
252790                                                                  25279071
252800     PERFORM 4877-FETCH-ODD-FCSE-CSR                              25280071
252810       UNTIL PS-USE-ODD-CARTON-FCSE  OR                           25281071
252820             PS-EOF-ODD-FCSE-CSR     OR                           25282071
252830             PS-ERROR.                                            25283071
252840                                                                  25284071
252850     PERFORM 4879-CLOSE-ODD-FCSE-CURSOR.                          25285071
252860                                                                  25286071
252870                                                                  25287071
252880*----------------------------------------------------------------*25288071
252890* OPEN ODD_FCSE_CSR CURSOR                                       *25289071
252900*----------------------------------------------------------------*25290071
252910 4876-OPEN-ODD-FCSE-CURSOR.                                       25291071
252920     SET  PS-NO-SOFT-ABORT-ERROR  TO  TRUE.                       25292071
252930                                                                  25293071
252940     EXEC SQL                                                     25294071
252950         OPEN ODD_FCSE_CSR                                        25295071
252960     END-EXEC.                                                    25296071
252970                                                                  25297071
252980     EVALUATE TRUE                                                25298071
252990         WHEN SQLCODE = ZERO                                      25299071
253000             CONTINUE                                             25300071
253010         WHEN SQLCODE = -904                                      25301071
253020         WHEN SQLCODE = -911                                      25302071
253030         WHEN SQLCODE = -913                                      25303071
253040                                                                  25304071
253050             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   25305071
253060             MOVE '4876-OPEN-ODD-FCSE-CSR'                        25306071
253070                                             TO PV-SOFT-PARAGRAPH 25307071
253080             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 25308071
253090             MOVE LENGTH OF PV-CICS-MSG-AREA2                     25309071
253100               TO PV-COMMAREA-LENGTH                              25310071
253110             EXEC CICS                                            25311071
253120                  WRITEQ TD                                       25312071
253130                   QUEUE  ('CSSL')                                25313071
253140                    FROM  (PV-CICS-MSG-AREA2)                     25314071
253150                  LENGTH  (PV-COMMAREA-LENGTH)                    25315071
253160                    RESP  (PV-CICS-RESP)                          25316071
253170             END-EXEC                                             25317071
253180                                                                  25318071
253190              MOVE  PC-TSYMSG-01767  TO  DP020-MSG-NUMBER         25319071
253200              PERFORM 9900-SOFT-ABORT                             25320071
253210         WHEN SQLWARN0 NOT = SPACE                                25321071
253220         WHEN SQLCODE < ZERO                                      25322071
253230         WHEN SQLCODE > ZERO                                      25323071
253240             MOVE '4876-OPEN-ODD-FCSE-CURSOR'                     25324071
253250                                     TO DP013-PARAGRAPH           25325071
253260             MOVE 'OPEN THE ODD_FCSE_CSR CURSOR'                  25326071
253270                                     TO DP013-MESSAGE-TEXT (1)    25327071
253280             MOVE SQLCA              TO DP013-SQLCA               25328071
253290             MOVE 'TRECDIS'          TO DP013-DB2-TABLE-NAME (1)  25329071
253300             SET DP013-DB2-ABEND     TO TRUE                      25330071
253310             SET DP013-NO-ROLLBACK   TO TRUE                      25331071
253320             SET DP013-XCTL-DISPLAY-RESTART                       25332071
253330                                     TO TRUE                      25333071
253340             PERFORM DP013-0000-PROCESS-ABEND                     25334071
253350     END-EVALUATE.                                                25335071
253360                                                                  25336071
253370                                                                  25337071
253380*----------------------------------------------------------------*25338071
253390* FETCH ODD_FCSE_CSR                                             *25339071
253400*----------------------------------------------------------------*25340071
253410 4877-FETCH-ODD-FCSE-CSR.                                         25341071
253420     SET  PS-NO-SOFT-ABORT-ERROR  TO  TRUE.                       25342071
253430                                                                  25343071
253440     EXEC SQL                                                     25344071
253450         FETCH ODD_FCSE_CSR                                       25345071
253460          INTO :PV-ODD-RECDIS-STR-NBR,                            25346071
253470               :PV-ODD-RECDIS-EXPTED-ITM-QTY                      25347071
253480     END-EXEC.                                                    25348071
253490                                                                  25349071
253500     EVALUATE TRUE                                                25350071
253510         WHEN SQLCODE = ZERO                                      25351071
253520             PERFORM 4878-CHECK-ODD-CRTN-USE                      25352071
253530         WHEN SQLCODE = +100                                      25353071
253540             SET PS-EOF-ODD-FCSE-CSR TO TRUE                      25354071
253550         WHEN SQLCODE = -904                                      25355071
253560         WHEN SQLCODE = -911                                      25356071
253570         WHEN SQLCODE = -913                                      25357071
253580                                                                  25358071
253590             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   25359071
253600             MOVE '4877-FETCH-ODD-FCSE-CSR'                       25360071
253610                                             TO PV-SOFT-PARAGRAPH 25361071
253620             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 25362071
253630             MOVE LENGTH OF PV-CICS-MSG-AREA2                     25363071
253640               TO PV-COMMAREA-LENGTH                              25364071
253650             EXEC CICS                                            25365071
253660                  WRITEQ TD                                       25366071
253670                   QUEUE  ('CSSL')                                25367071
253680                    FROM  (PV-CICS-MSG-AREA2)                     25368071
253690                  LENGTH  (PV-COMMAREA-LENGTH)                    25369071
253700                    RESP  (PV-CICS-RESP)                          25370071
253710             END-EXEC                                             25371071
253720                                                                  25372071
253730              MOVE  PC-TSYMSG-01767  TO  DP020-MSG-NUMBER         25373071
253740              PERFORM 9900-SOFT-ABORT                             25374071
253750         WHEN SQLWARN0 NOT = SPACE                                25375071
253760         WHEN SQLCODE < ZERO                                      25376071
253770         WHEN SQLCODE > ZERO                                      25377071
253780             MOVE '4877-FETCH-ODD-FCSE-CSR'                       25378071
253790                                     TO DP013-PARAGRAPH           25379071
253800             MOVE 'ATTEMPTING TO FETCH A ROW OF THE RESULTS TABLE 25380071
253810-                 'FROM THE ODD_FCSE_CSR'                         25381071
253820                                     TO DP013-MESSAGE-TEXT (1)    25382071
253830             MOVE SQLCA              TO DP013-SQLCA               25383071
253840             MOVE 'TRECDIS'          TO DP013-DB2-TABLE-NAME (1)  25384071
253850             SET DP013-DB2-ABEND     TO TRUE                      25385071
253860             SET DP013-ROLLBACK      TO TRUE                      25386071
253870             SET DP013-XCTL-DISPLAY-RESTART                       25387071
253880                                     TO TRUE                      25388071
253890             PERFORM DP013-0000-PROCESS-ABEND                     25389071
253900     END-EVALUATE.                                                25390071
253910                                                                  25391071
253920                                                                  25392071
253930*----------------------------------------------------------------*25393071
253940* CHECK ODD CARTON USE IF STORE ALLOCATION > ODD UNIT QTY        *25394071
253950*----------------------------------------------------------------*25395071
253960 4878-CHECK-ODD-CRTN-USE.                                         25396071
253970                                                                  25397071
253980     MOVE  ZEROES  TO  PV-ODD-RECDIS-DIFF                         25398071
253990                       PV-ODD-RECDIS-CTNS                         25399071
254000                       PV-ODD-RECDIS-REMAINDER.                   25400071
254010                                                                  25401071
254020     SUBTRACT  PV-ODD-CARTON-UNT-QTY                              25402071
254030         FROM  PV-ODD-RECDIS-EXPTED-ITM-QTY                       25403071
254040       GIVING  PV-ODD-RECDIS-DIFF.                                25404071
254050                                                                  25405071
254060     DIVIDE    PV-ODD-RECDIS-DIFF                                 25406071
254070         BY    PV-OUTER-PACK-QTY                                  25407071
254080     GIVING    PV-ODD-RECDIS-CTNS                                 25408071
254090     REMAINDER PV-ODD-RECDIS-REMAINDER.                           25409071
254100                                                                  25410071
254110     IF  PV-ODD-RECDIS-REMAINDER  =  0                            25411071
254120         SET  PS-USE-ODD-CARTON-FCSE                              25412071
254130              LQW-ODD-CRTN-FCSE (LQW-IDX)  TO  TRUE               25413071
254140     END-IF.                                                      25414071
254150                                                                  25415071
254160                                                                  25416071
254170*----------------------------------------------------------------*25417071
254180* CLOSE ODD_FCSE_CSR CURSOR                                      *25418071
254190*----------------------------------------------------------------*25419071
254200 4879-CLOSE-ODD-FCSE-CURSOR.                                      25420071
254210     SET  PS-NO-SOFT-ABORT-ERROR  TO  TRUE.                       25421071
254220                                                                  25422071
254230     EXEC SQL                                                     25423071
254240         CLOSE ODD_FCSE_CSR                                       25424071
254250     END-EXEC.                                                    25425071
254260                                                                  25426071
254270     EVALUATE TRUE                                                25427071
254280         WHEN SQLCODE = ZERO                                      25428071
254290             CONTINUE                                             25429071
254300         WHEN SQLCODE = -904                                      25430071
254310         WHEN SQLCODE = -911                                      25431071
254320         WHEN SQLCODE = -913                                      25432071
254330                                                                  25433071
254340             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   25434071
254350             MOVE '4879-CLOSE-ODD-FCSE-CSR'                       25435071
254360                                             TO PV-SOFT-PARAGRAPH 25436071
254370             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 25437071
254380             MOVE LENGTH OF PV-CICS-MSG-AREA2                     25438071
254390               TO PV-COMMAREA-LENGTH                              25439071
254400             EXEC CICS                                            25440071
254410                  WRITEQ TD                                       25441071
254420                   QUEUE  ('CSSL')                                25442071
254430                    FROM  (PV-CICS-MSG-AREA2)                     25443071
254440                  LENGTH  (PV-COMMAREA-LENGTH)                    25444071
254450                    RESP  (PV-CICS-RESP)                          25445071
254460             END-EXEC                                             25446071
254470                                                                  25447071
254480              MOVE  PC-TSYMSG-01767  TO  DP020-MSG-NUMBER         25448071
254490              PERFORM 9900-SOFT-ABORT                             25449071
254500         WHEN SQLWARN0 NOT = SPACE                                25450071
254510         WHEN SQLCODE < ZERO                                      25451071
254520         WHEN SQLCODE > ZERO                                      25452071
254530             MOVE '4879-CLOSE-ODD-FCSE-CURSOR'                    25453071
254540                                     TO DP013-PARAGRAPH           25454071
254550             MOVE 'CLOSE THE ODD_FCSE_CSR CURSOR'                 25455071
254560                                     TO DP013-MESSAGE-TEXT (1)    25456071
254570             MOVE SQLCA              TO DP013-SQLCA               25457071
254580             MOVE 'TRECDIS'          TO DP013-DB2-TABLE-NAME (1)  25458071
254590             SET DP013-DB2-ABEND     TO TRUE                      25459071
254600             SET DP013-NO-ROLLBACK   TO TRUE                      25460071
254610             SET DP013-XCTL-DISPLAY-RESTART                       25461071
254620                                     TO TRUE                      25462071
254630             PERFORM DP013-0000-PROCESS-ABEND                     25463071
254640     END-EVALUATE.                                                25464071
254650                                                                  25465071
254660                                                                  25466071
254670*-----------------------------------------------------------------25467071
254680* IF ODD-CARTON > 0 AND INNER PACK CONVEYABLE                    *25468071
254690* DETERMINE IF ODD-CARTON WILL BE USED AS FULL CASE OR INNERPACK *25469071
254700*-----------------------------------------------------------------25470071
254710 4880-ODD-CARTON-INPK-FCSE.                                       25471071
254720                                                                  25472071
254730     MOVE  ZEROES  TO  PV-RECDIS-FCSE-EQUAL-CNT.                  25473071
254740                                                                  25474071
254750*                                                                 25475071
254760* IF ODD-CARTON    AND                                            25476071
254770*    INNER-PACK CONVEYABLE                                        25477071
254780*    DETERMINE IF CARTON BEING USED AS FULLCASE                   25478071
254790*                                                                 25479071
254800*    - CHECK RECDIS FOR STORE ALLOCATION = ODD CARTON UNIT QTY    25480071
254810*    - CHECK RECDIS FOR STORE ALLOCATION > ODD CARTON UNIT QTY    25481071
254820*                                                                 25482071
254830     PERFORM 4882-ODD-FCSE-EQUAL.                                 25483071
254840                                                                  25484071
254850     IF  PS-USE-ODD-CARTON-FCSE                                   25485071
254860         CONTINUE                                                 25486071
254870     ELSE                                                         25487071
254880         PERFORM 4884-ODD-FCSE-GREATER                            25488071
254890     END-IF.                                                      25489071
254900                                                                  25490071
254910     IF  PS-USE-ODD-CARTON-FCSE                                   25491071
254920         CONTINUE                                                 25492071
254930     ELSE                                                         25493071
254940     IF  LQW-IN-PAK-CONVEY-YES (LQW-IDX)                          25494071
254950         SET  PS-USE-ODD-CARTON-INPK                              25495071
254960              LQW-ODD-CRTN-INPK (LQW-IDX)  TO  TRUE               25496071
254970     END-IF.                                                      25497071
254980                                                                  25498071
254990                                                                  25499071
255000*-----------------------------------------------------------------25500071
255010* DETERMINE IF STORE ALLOCATION = ODD CARTON UNIT QTY            -25501071
255020*-----------------------------------------------------------------25502071
255030 4882-ODD-FCSE-EQUAL.                                             25503071
255040                                                                  25504071
255050     MOVE  ZEROES  TO  PV-RECDIS-ORD-NBR                          25505071
255060                                                                  25506071
255070     EXEC SQL                                                     25507071
255080         SELECT A.ORD_NBR                                         25508071
255090           INTO :PV-RECDIS-ORD-NBR                                25509071
255100           FROM TRECDIS A                                         25510071
255200          WHERE A.ORD_NBR         =  :DK-PO-NBR                   25520071
255210            AND A.REC_SEQ_NBR     =  :DK-REC-SEQ-NBR              25521071
255220            AND A.ORD_LNE_NBR     =  :DK-LINE-NBR                 25522071
255230            AND A.EXPTED_ITM_QTY  =  :PV-ODD-CARTON-UNT-QTY       25523071
255241          FETCH FIRST 1 ROW ONLY                                  25524171
255242     END-EXEC                                                     25524271
255243                                                                  25524371
255244     EVALUATE TRUE                                                25524471
255245         WHEN SQLCODE = +0                                        25524571
255246             IF PV-RECDIS-ORD-NBR        > +0                     25524671
255247                 SET PS-USE-ODD-CARTON-FCSE                       25524771
255248                     LQW-ODD-CRTN-FCSE (LQW-IDX) TO TRUE          25524871
255249             END-IF                                               25524971
255250         WHEN SQLCODE = +100                                      25525071
255260              CONTINUE                                            25526071
255270         WHEN SQLCODE = -904                                      25527071
255280         WHEN SQLCODE = -911                                      25528071
255290         WHEN SQLCODE = -913                                      25529071
255300                                                                  25530071
255310             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    25531071
255320             MOVE '4882-ODD-FCSE-EQUAL'     TO PV-SOFT-PARAGRAPH  25532071
255330             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  25533071
255340             MOVE LENGTH OF PV-CICS-MSG-AREA2                     25534071
255350               TO PV-COMMAREA-LENGTH                              25535071
255360             EXEC CICS                                            25536071
255370                  WRITEQ TD                                       25537071
255380                   QUEUE  ('CSSL')                                25538071
255390                    FROM  (PV-CICS-MSG-AREA2)                     25539071
255400                  LENGTH  (PV-COMMAREA-LENGTH)                    25540071
255410                    RESP  (PV-CICS-RESP)                          25541071
255420             END-EXEC                                             25542071
255430                                                                  25543071
255440             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          25544071
255450             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              25545071
255460             PERFORM 9900-SOFT-ABORT                              25546071
255470         WHEN SQLWARN0 NOT = SPACES                               25547071
255480         WHEN SQLCODE < ZERO                                      25548071
255490         WHEN SQLCODE > ZERO                                      25549071
255500             MOVE '4882-ODD-FCSE-EQUAL'                           25550071
255510                               TO DP013-PARAGRAPH                 25551071
255520             MOVE 'CHECK USE OF ODD CARTON - FULLCASE'            25552071
255530                               TO DP013-MESSAGE-TEXT (1)          25553071
255540             MOVE SQLCA        TO DP013-SQLCA                     25554071
255550             MOVE 'TRECDIS'    TO DP013-DB2-TABLE-NAME (1)        25555071
255560             SET DP013-DB2-ABEND                                  25556071
255570                 DP013-XCTL-DISPLAY-RESTART                       25557071
255580                               TO TRUE                            25558071
255590             PERFORM DP013-0000-PROCESS-ABEND                     25559071
255600     END-EVALUATE.                                                25560071
255610                                                                  25561071
255620                                                                  25562071
255630*-----------------------------------------------------------------25563071
255640* DETERMINE IF STORE ALLOCATION > ODD CARTON UNIT QTY            -25564071
255650*-----------------------------------------------------------------25565071
255660 4884-ODD-FCSE-GREATER.                                           25566071
255670                                                                  25567071
255680     PERFORM 4856-OPEN-ODD-FCSE-CURSOR.                           25568071
255690                                                                  25569071
255700     PERFORM 4867-FETCH-ODD-FCSE-CSR                              25570071
255710       UNTIL PS-USE-ODD-CARTON-FCSE  OR                           25571071
255720             PS-EOF-ODD-FCSE-CSR     OR                           25572071
255730             PS-ERROR.                                            25573071
255740                                                                  25574071
255750     PERFORM 4859-CLOSE-ODD-FCSE-CURSOR.                          25575071
255760                                                                  25576071
255770                                                                  25577071
255780*----------------------------------------------------------------*25578071
255790* FETCH ODD_FCSE_CSR                                             *25579071
255800*----------------------------------------------------------------*25580071
255810 4887-FETCH-ODD-FCSE-CSR.                                         25581071
255820     SET  PS-NO-SOFT-ABORT-ERROR  TO  TRUE.                       25582071
255830                                                                  25583071
255840     EXEC SQL                                                     25584071
255850         FETCH ODD_FCSE_CSR                                       25585071
255860          INTO :PV-ODD-RECDIS-STR-NBR,                            25586071
255870               :PV-ODD-RECDIS-EXPTED-ITM-QTY                      25587071
255880     END-EXEC.                                                    25588071
255890                                                                  25589071
255900     EVALUATE TRUE                                                25590071
255910         WHEN SQLCODE = ZERO                                      25591071
255920             PERFORM 4888-CHECK-ODD-CRTN-USE                      25592071
255930         WHEN SQLCODE = +100                                      25593071
255940             SET PS-EOF-ODD-FCSE-CSR TO TRUE                      25594071
255950         WHEN SQLCODE = -904                                      25595071
255960         WHEN SQLCODE = -911                                      25596071
255970         WHEN SQLCODE = -913                                      25597071
255980                                                                  25598071
255990             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   25599071
256000             MOVE '4887-FETCH-ODD-FCSE-CSR'                       25600071
256010                                             TO PV-SOFT-PARAGRAPH 25601071
256020             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 25602071
256030             MOVE LENGTH OF PV-CICS-MSG-AREA2                     25603071
256040               TO PV-COMMAREA-LENGTH                              25604071
256050             EXEC CICS                                            25605071
256060                  WRITEQ TD                                       25606071
256070                   QUEUE  ('CSSL')                                25607071
256080                    FROM  (PV-CICS-MSG-AREA2)                     25608071
256090                  LENGTH  (PV-COMMAREA-LENGTH)                    25609071
256100                    RESP  (PV-CICS-RESP)                          25610071
256110             END-EXEC                                             25611071
256120                                                                  25612071
256130              MOVE  PC-TSYMSG-01767  TO  DP020-MSG-NUMBER         25613071
256140              PERFORM 9900-SOFT-ABORT                             25614071
256150         WHEN SQLWARN0 NOT = SPACE                                25615071
256160         WHEN SQLCODE < ZERO                                      25616071
256170         WHEN SQLCODE > ZERO                                      25617071
256180             MOVE '4887-FETCH-ODD-FCSE-CSR'                       25618071
256190                                     TO DP013-PARAGRAPH           25619071
256200             MOVE 'ATTEMPTING TO FETCH A ROW OF THE RESULTS TABLE 25620071
256210-                 'FROM THE ODD_FCSE_CSR'                         25621071
256220                                     TO DP013-MESSAGE-TEXT (1)    25622071
256230             MOVE SQLCA              TO DP013-SQLCA               25623071
256240             MOVE 'TRECDIS'          TO DP013-DB2-TABLE-NAME (1)  25624071
256250             SET DP013-DB2-ABEND     TO TRUE                      25625071
256260             SET DP013-ROLLBACK      TO TRUE                      25626071
256270             SET DP013-XCTL-DISPLAY-RESTART                       25627071
256280                                     TO TRUE                      25628071
256290             PERFORM DP013-0000-PROCESS-ABEND                     25629071
256300     END-EVALUATE.                                                25630071
256310                                                                  25631071
256320                                                                  25632071
256330*----------------------------------------------------------------*25633071
256340* CHECK ODD CARTON USE IF STORE ALLOCATION > ODD UNIT QTY        *25634071
256350*----------------------------------------------------------------*25635071
256360 4888-CHECK-ODD-CRTN-USE.                                         25636071
256370                                                                  25637071
256380     MOVE  ZEROES  TO  PV-ODD-RECDIS-DIFF                         25638071
256390                       PV-ODD-RECDIS-CTNS                         25639071
256400                       PV-ODD-RECDIS-REMAINDER.                   25640071
256410                                                                  25641071
256420     SUBTRACT  PV-ODD-CARTON-UNT-QTY                              25642071
256430         FROM  PV-ODD-RECDIS-EXPTED-ITM-QTY                       25643071
256440       GIVING  PV-ODD-RECDIS-DIFF.                                25644071
256450                                                                  25645071
256460     DIVIDE    PV-ODD-RECDIS-DIFF                                 25646071
256470         BY    PV-OUTER-PACK-QTY                                  25647071
256480     GIVING    PV-ODD-RECDIS-CTNS                                 25648071
256490     REMAINDER PV-ODD-RECDIS-REMAINDER.                           25649071
256500                                                                  25650071
256510     IF  PV-ODD-RECDIS-REMAINDER  =  0                            25651071
256520         SET  PS-USE-ODD-CARTON-FCSE                              25652071
256530              LQW-ODD-CRTN-FCSE(LQW-IDX)  TO  TRUE                25653071
256540     END-IF.                                                      25654071
256550                                                                  25655071
256560                                                                  25656071
256570                                                                  25657071
256580                                                                  25658071
256590                                                                  25659071
256600                                                                  25660071
256610                                                                  25661071
256620*----------------------------------------------------------------*25662071
256630* THIS PARAGRAPH WILL RESET ALL VALUES IN DISTHD.  IF FOUND      *25663071
256640* DELETE ALL CORESPONDING DISTDT RECORDS AND SET PS-DISTHD-UPDATE*25664071
256650* TO TRUE                                                        *25665071
256660* IF NO RECORD WAS FOUND ON UPDATE SET PS-DISTHD-INSERT TO TRUE  *25666071
256670*----------------------------------------------------------------*25667071
256680 4900-UPDATE-HDR-ZEROES.                                          25668071
256690                                                                  25669071
256700     MOVE  SPACE  TO  PS-INSERT-UPDATE-SW.                        25670071
256710                                                                  25671071
256720     PERFORM 4905-DEL-UPD-HEADER.                                 25672071
256730                                                                  25673071
256740     IF  PS-DISTHD-UPDATE                                         25674071
256750         PERFORM 4510-DELETE-DETAIL                               25675071
256760         IF  PS-NO-SOFT-ABORT-ERROR                               25676071
256770             IF  ASC-PRE-PACK-ORDER                               25677071
256780                 PERFORM  4512-DEL-PREPK-DTL                      25678071
256790             END-IF                                               25679071
256800         END-IF                                                   25680071
256810         EXEC CICS                                                25681071
256820              SYNCPOINT                                           25682071
256830         END-EXEC                                                 25683071
256840     END-IF.                                                      25684071
256850                                                                  25685071
256860                                                                  25686071
256870*----------------------------------------------------------------*25687071
256880*  UPDATE TRANSACTION HEADER ROW FOR THIS PO/RCVR/LINE            25688071
256890*----------------------------------------------------------------*25689071
256900 4905-DEL-UPD-HEADER.                                             25690071
256910     SET  PS-NO-SOFT-ABORT-ERROR          TO  TRUE.               25691071
256920                                                                  25692071
256930     MOVE SPACES                  TO DISTHD-CART-DWNLD-USR-ID     25693071
256940                                     DISTHD-CRE-USR-ID            25694071
256950                                     DISTHD-SYS-CRE-CDE           25695071
256960                                     DISTHD-PRC-AREA-MODU-ID      25696071
256970                                     DISTHD-FCSE-LBL-TYP-CDE      25697071
256980                                     DISTHD-SPC-INSTR-DESC        25698071
256990                                     DISTHD-INPK-CNVYB-IND        25699071
257000                                     DISTHD-FCSE-CNFRMN-PGM-ID.   25700071
257010                                                                  25701071
257020     MOVE ZERO                    TO DISTHD-TOT-CART-CNT          25702071
257030                                     DISTHD-FCSE-CART-CNT         25703071
257040                                     DISTHD-P2L-CART-CNT          25704071
257050                                     DISTHD-INPK-CART-CNT         25705071
257060                                     DISTHD-INPK-UNT-QTY          25706071
257070                                     DISTHD-OTPK-UNT-QTY.         25707071
257080                                                                  25708071
257090     MOVE ASC-OPER-UNT-ID         TO DISTHD-OPER-UNT-ID.          25709071
257100                                                                  25710071
257110     EXEC SQL                                                     25711071
257120          UPDATE TDISTHD                                          25712071
257130             SET                                                  25713071
257140                 PRC_AREA_MODU_ID  = :DISTHD-PRC-AREA-MODU-ID     25714071
257150               , TOT_CART_CNT      = :DISTHD-TOT-CART-CNT         25715071
257160               , P2L_CART_CNT      = :DISTHD-P2L-CART-CNT         25716071
257170               , CRE_USR_ID        = :DISTHD-CRE-USR-ID           25717071
257180               , SYS_CRE_CDE       = :DISTHD-SYS-CRE-CDE          25718071
257190               , INPK_UNT_QTY      = :DISTHD-INPK-UNT-QTY         25719071
257200               , OTPK_UNT_QTY      = :DISTHD-OTPK-UNT-QTY         25720071
257210               , SPC_INSTR_DESC    = :DISTHD-SPC-INSTR-DESC       25721071
257220               , FCSE_CART_CNT     = :DISTHD-FCSE-CART-CNT        25722071
257230               , FCSE_LBL_TYP_CDE  = :DISTHD-FCSE-LBL-TYP-CDE     25723071
257240               , INPK_CART_CNT     = :DISTHD-INPK-CART-CNT        25724071
257250               , CART_DWNLD_DTE    = :PC-DEFAULT-DTE              25725071
257260               , CART_DWNLD_TM     = :PC-DEFAULT-TM               25726071
257270               ,CART_DWNLD_USR_ID  = :DISTHD-CART-DWNLD-USR-ID    25727071
257280               ,INPK_CNVYB_IND     = :DISTHD-INPK-CNVYB-IND       25728071
257290               ,FCSE_CNFRMN_PGM_ID = :DISTHD-FCSE-CNFRMN-PGM-ID   25729071
257300               ,ODD_CART_UNT_QTY   = :DISTHD-ODD-CART-UNT-QTY     25730071
257310               ,OPER_UNT_ID        = :DISTHD-OPER-UNT-ID          25731071
257320           WHERE ORD_NBR           = :DK-PO-NBR                   25732071
257330             AND RCVR_SEQ_NBR      = :DK-REC-SEQ-NBR              25733071
257340             AND ORD_LNE_NBR       = :DK-LINE-NBR                 25734071
257350     END-EXEC.                                                    25735071
257360                                                                  25736071
257370     EVALUATE TRUE                                                25737071
257380         WHEN SQLCODE = ZERO                                      25738071
257390              SET PS-DISTHD-UPDATE   TO  TRUE                     25739071
257400         WHEN SQLCODE = +100                                      25740071
257410              SET PS-DISTHD-INSERT   TO  TRUE                     25741071
257420         WHEN SQLCODE = -904                                      25742071
257430         WHEN SQLCODE = -911                                      25743071
257440         WHEN SQLCODE = -913                                      25744071
257450                                                                  25745071
257460             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   25746071
257470             MOVE '4905-DEL-UPD-HEADER'      TO PV-SOFT-PARAGRAPH 25747071
257480             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 25748071
257490             MOVE LENGTH OF PV-CICS-MSG-AREA2                     25749071
257500               TO PV-COMMAREA-LENGTH                              25750071
257510             EXEC CICS                                            25751071
257520                  WRITEQ TD                                       25752071
257530                   QUEUE  ('CSSL')                                25753071
257540                    FROM  (PV-CICS-MSG-AREA2)                     25754071
257550                  LENGTH  (PV-COMMAREA-LENGTH)                    25755071
257560                    RESP  (PV-CICS-RESP)                          25756071
257570             END-EXEC                                             25757071
257580                                                                  25758071
257590              MOVE  PC-TSYMSG-00551  TO  DP020-MSG-NUMBER         25759071
257600              PERFORM 9900-SOFT-ABORT                             25760071
257610         WHEN SQLWARN0 NOT = SPACES                               25761071
257620         WHEN SQLCODE NOT EQUAL ZERO                              25762071
257630              MOVE '4905-DEL-UPD-HEADER'                          25763071
257640                                   TO DP013-PARAGRAPH             25764071
257650              MOVE 'RESET DISTRIBUITON HEADER ROW'                25765071
257660                                   TO DP013-MESSAGE-TEXT (1)      25766071
257670              MOVE SQLCA           TO DP013-SQLCA                 25767071
257680              MOVE 'TDISTHD'       TO DP013-DB2-TABLE-NAME (1)    25768071
257690              SET DP013-DB2-ABEND  TO TRUE                        25769071
257700              PERFORM DP013-0000-PROCESS-ABEND                    25770071
257710     END-EVALUATE.                                                25771071
257720                                                                  25772071
257730                                                                  25773071
257740*----------------------------------------------------------------*25774071
257750*  UPDATE TRANSACTION HEADER ROW FOR THIS PO/RCVR/LINE            25775071
257760*----------------------------------------------------------------*25776071
257770 4910-UPD-DISTHD-AFT-ABEND.                                       25777071
257780     SET  PS-NO-SOFT-ABORT-ERROR          TO  TRUE.               25778071
257790                                                                  25779071
257800     EXEC SQL                                                     25780071
257810          UPDATE TDISTHD                                          25781071
257820             SET                                                  25782071
257830                 FCSE_LBL_TYP_CDE  = :PC-X                        25783071
257840           WHERE ORD_NBR           = :DK-PO-NBR                   25784071
257850             AND RCVR_SEQ_NBR      = :DK-REC-SEQ-NBR              25785071
257860             AND ORD_LNE_NBR       = :DK-LINE-NBR                 25786071
257870     END-EXEC.                                                    25787071
257880                                                                  25788071
257890     EVALUATE TRUE                                                25789071
257900         WHEN SQLCODE = ZERO                                      25790071
257910         WHEN SQLCODE = +100                                      25791071
257920              CONTINUE                                            25792071
257930         WHEN SQLCODE = -904                                      25793071
257940         WHEN SQLCODE = -911                                      25794071
257950         WHEN SQLCODE = -913                                      25795071
257960             MOVE SQLCODE                     TO PV-SOFT-SQLCODE  25796071
257970             MOVE '4910-UPD-DISTHD-AFT-ABEND' TO PV-SOFT-PARAGRAPH25797071
257980             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 25798071
257990             MOVE LENGTH OF PV-CICS-MSG-AREA2                     25799071
258000               TO PV-COMMAREA-LENGTH                              25800071
258010             EXEC CICS                                            25801071
258020                  WRITEQ TD                                       25802071
258030                   QUEUE  ('CSSL')                                25803071
258040                    FROM  (PV-CICS-MSG-AREA2)                     25804071
258050                  LENGTH  (PV-COMMAREA-LENGTH)                    25805071
258060                    RESP  (PV-CICS-RESP)                          25806071
258070             END-EXEC                                             25807071
258080             MOVE  PC-TSYMSG-00551  TO  DP020-MSG-NUMBER          25808071
258090             PERFORM 9900-SOFT-ABORT                              25809071
258100         WHEN SQLWARN0 NOT = SPACES                               25810071
258110         WHEN SQLCODE NOT EQUAL ZERO                              25811071
258120              MOVE '4910-UPD-DISTHD-AFT-ABEND'                    25812071
258130                                   TO DP013-PARAGRAPH             25813071
258140              MOVE 'UPD DISTRIBUITON HEADER ROW'                  25814071
258150                                   TO DP013-MESSAGE-TEXT (1)      25815071
258160              MOVE SQLCA           TO DP013-SQLCA                 25816071
258170              MOVE 'TDISTHD'       TO DP013-DB2-TABLE-NAME (1)    25817071
258180              SET DP013-DB2-ABEND  TO TRUE                        25818071
258190              PERFORM DP013-0000-PROCESS-ABEND                    25819071
258200     END-EVALUATE.                                                25820071
258210                                                                  25821071
258220                                                                  25822071
258230*----------------------------------------------------------------*25823071
258240* SEND DELETE REQUEST TO NEW P2L SYSTEMS                         *25824071
258250*         (PCC-LIGHTENING PICK AND THEOTEK-THEOPACK)             *25825071
258260* ADDED 11-07-2000                                               *25826071
258270*----------------------------------------------------------------*25827071
258280 4920-SEND-DELETE-TO-P2L.                                         25828071
258290                                                                  25829071
258300     IF  PS-SOCKET-INITIALIZED-NO                                 25830071
258310         IF  PS-NO-ERROR                                          25831071
258320             PERFORM 4645-CALL-SOCKET                             25832071
258330         END-IF                                                   25833071
258340         IF  PS-NO-ERROR                                          25834071
258350             PERFORM 4650-CONNECT-SOCKET                          25835071
258360         END-IF                                                   25836071
258370         IF  PS-NO-ERROR                                          25837071
258380             SET PS-SOCKET-INITIALIZED-YES  TO  TRUE              25838071
258390         END-IF                                                   25839071
258400     END-IF.                                                      25840071
258410                                                                  25841071
258420     PERFORM 4925-BLD-P2L-DELETE.                                 25842071
258430                                                                  25843071
258440     IF  PC184-DIST-BEING-WORKED                                  25844071
258450         INITIALIZE  PV-CICS-MSG-AREA2                            25845071
258460         STRING ' PCKCS701 -'               DELIMITED BY SIZE     25846071
258470                ' P2L LAUNCHED - '          DELIMITED BY SIZE     25847071
258480                PC184-DEL-CONF-ORD-NBR      DELIMITED BY SIZE     25848071
258490                '-'                         DELIMITED BY SIZE     25849071
258500                PC184-DEL-CONF-RECEIVER-NBR DELIMITED BY SIZE     25850071
258510                '-'                         DELIMITED BY SIZE     25851071
258520                PC184-DEL-CONF-LINE-NBR     DELIMITED BY SIZE     25852071
258530                                       INTO PV-CICS-MSG-AREA2     25853071
258540         MOVE LENGTH OF PV-CICS-MSG-AREA2                         25854071
258550                TO PV-COMMAREA-LENGTH                             25855071
258560         EXEC CICS                                                25856071
258570              WRITEQ TD                                           25857071
258580              QUEUE  ('CSSL')                                     25858071
258590              FROM   (PV-CICS-MSG-AREA2)                          25859071
258600              LENGTH (PV-COMMAREA-LENGTH)                         25860071
258610              RESP   (PV-CICS-RESP)                               25861071
258620         END-EXEC                                                 25862071
258630         MOVE  PC-TSYMSG-02540  TO  DP020-MSG-NUMBER              25863071
258640         PERFORM 9900-SOFT-ABORT                                  25864071
258650     END-IF.                                                      25865071
258660                                                                  25866071
258670                                                                  25867071
258680*----------------------------------------------------------------*25868071
258690* BUILD DELETE REQUEST TO BE SENT TO NEW P2L SYSTEMS             *25869071
258700*         (PCC-LIGHTENING PICK AND THEOTEK-THEOPACK)             *25870071
258710* ADDED 11-07-2000                                               *25871071
258720*----------------------------------------------------------------*25872071
258730 4925-BLD-P2L-DELETE.                                             25873071
258740     INITIALIZE  PC184-DISTRO-RECORD.                             25874071
258750     SET  PC184-DISTRO-DEL        TO  TRUE.                       25875071
258760     MOVE ASC-PO-NBR              TO  PV-DISPLAY-PO-NBR           25876071
258770     MOVE ASC-REC-SEQ-NBR         TO  PV-DISPLAY-RCVR-SEQ-NBR     25877071
258780                                      PV-REC-SEQ-NBR              25878071
258790     MOVE PV-DISPLAY-PO-NBR       TO  PC184-DDEL-ORD-NBR.         25879071
258800     MOVE PV-REC-SEQ-NBR-3        TO  PC184-DDEL-RCVR-SEQ-NBR.    25880071
258810     MOVE LQW-PO-RCVR-LINE (LQW-IDX)                              25881071
258820                                  TO  PC184-DDEL-ORD-LNE-NBR.     25882071
258830     MOVE PC-001                  TO  PC184-DDEL-WORK-ORD-SEQ-NBR.25883071
258840     MOVE ZEROES                  TO  PC184-DDEL-WO-INS-SEQ-NBR   25884071
258850     MOVE PC-SEMI-COLON           TO  PC184-DDEL-TERM-CHAR.       25885071
258860                                                                  25886071
258870*===TKMA408=== THIS IS IN JUST FOR TESTING                        25887071
258880     IF   PS-DISPLAY-CSSL-YES                                     25888071
258890          IF  LQW-P2L-DYNAPACK (LQW-IDX)                          25889071
258900              IF LQW-P2L-ALS-4-DIGIT-STR (LQW-IDX)                25890071
258910                 STRING ' PCKCS701-4925-AL '                      25891071
258920                        PC053-DISTRO-RECORD   DELIMITED BY SIZE   25892071
258930                                         INTO PV-CICS-152-RECORD  25893071
258940              END-IF                                              25894071
258950          ELSE                                                    25895071
258960                 STRING ' PCKCS701-4925-PCC '                     25896071
258970                        PC184-DISTRO-RECORD   DELIMITED BY SIZE   25897071
258980                                         INTO PV-CICS-152-RECORD  25898071
258990          END-IF                                                  25899071
259000        MOVE PV-CICS-1-99             TO PV-CICS-MSG-DATA2        25900071
259010        MOVE PV-CICS-MSG-HOLD2        TO PV-CICS-MSG-AREA2        25901071
259020        MOVE LENGTH OF PV-CICS-MSG-AREA2                          25902071
259030                                      TO PV-COMMAREA-LENGTH       25903071
259040        EXEC CICS                                                 25904071
259050            WRITEQ TD                                             25905071
259060                QUEUE   ('CSSL')                                  25906071
259070                FROM    (PV-CICS-MSG-AREA2)                       25907071
259080                LENGTH  (PV-COMMAREA-LENGTH)                      25908071
259090                RESP    (PV-CICS-RESP)                            25909071
259100        END-EXEC                                                  25910071
259110     END-IF                                                       25911071
259120*===TKMA408=== THIS IS IN JUST FOR TESTING                        25912071
259130                                                                  25913071
259140     PERFORM 4970-SEND-P2L-DATA-LTP-THP.                          25914071
259150                                                                  25915071
259160                                                                  25916071
259170*----------------------------------------------------------------*25917071
259180* WHEN DELETING DATA IN P2L FOR AL SYSTEMS.  SEND HEADER RECORD  *25918071
259190* AND STORE ALLOCATION = 0 FOR DC. DO NOT SEND CARTON RECORDS.   *25919071
259200* THIS WILL PREVENT ASSOCIATES FROM LAUNCHING LINES IN P2L THAT  *25920071
259210* HAVE BEEN DELETED ON THE MAINFRAME.                             25921071
259220*----------------------------------------------------------------*25922071
259230 4950-SEND-DUMMY-TO-P2L.                                          25923071
259240                                                                  25924071
259250     IF  PS-SOCKET-INITIALIZED-NO                                 25925071
259260         IF  PS-NO-ERROR                                          25926071
259270             PERFORM 4645-CALL-SOCKET                             25927071
259280         END-IF                                                   25928071
259290         IF  PS-NO-ERROR                                          25929071
259300             PERFORM 4650-CONNECT-SOCKET                          25930071
259310         END-IF                                                   25931071
259320         IF  PS-NO-ERROR                                          25932071
259330             SET PS-SOCKET-INITIALIZED-YES  TO  TRUE              25933071
259340         END-IF                                                   25934071
259350     END-IF.                                                      25935071
259360                                                                  25936071
259370     IF  PS-NO-ERROR  AND                                         25937071
259380         PS-DISPLAY-CSSL-YES                                      25938071
259390         INITIALIZE      PV-CICS-MSG-AREA2                        25939071
259400         MOVE ASC-PO-NBR             TO  PV-DISPLAY-PO-NBR        25940071
259410         MOVE ASC-REC-SEQ-NBR        TO  PV-DISPLAY-RCVR-SEQ-NBR  25941071
259420         STRING      ' PCKCS701-'          DELIMITED BY SIZE      25942071
259430                 ' PO-'                    DELIMITED BY SIZE      25943071
259440                 PV-DISPLAY-PO-NBR         DELIMITED BY SIZE      25944071
259450                 '-'                       DELIMITED BY SIZE      25945071
259460                 PV-DISPLAY-RCVR-SEQ-NBR   DELIMITED BY SIZE      25946071
259470                 ' 4950-SEND-DUMMY-TO-P2L' DELIMITED BY SIZE      25947071
259480                                      INTO PV-CICS-MSG-AREA2      25948071
259490         MOVE LENGTH OF PV-CICS-MSG-AREA2                         25949071
259500           TO PV-COMMAREA-LENGTH                                  25950071
259510         EXEC CICS                                                25951071
259520              WRITEQ TD                                           25952071
259530               QUEUE      ('CSSL')                                25953071
259540                FROM      (PV-CICS-MSG-AREA2)                     25954071
259550              LENGTH      (PV-COMMAREA-LENGTH)                    25955071
259560                RESP      (PV-CICS-RESP)                          25956071
259570         END-EXEC                                                 25957071
259580     END-IF.                                                      25958071
259590                                                                  25959071
259600     MOVE ASC-PO-NBR                     TO  PV-PO-NBR.           25960071
259610     MOVE ASC-REC-SEQ-NBR                TO  PV-REC-SEQ-NBR.      25961071
259620     MOVE LQW-PO-RCVR-LINE(LQW-IDX)      TO  PV-PO-LINE-NBR.      25962071
259630     MOVE 1                              TO  PV-CARTON-COUNT.     25963071
259640     MOVE ZEROES                         TO  PV-STR-CNT.          25964071
259650     MOVE ZEROES                         TO  PV-INNER-PACK-QTY.   25965071
259660     MOVE LQW-MODULE (LQW-IDX)           TO  PV-MODULE-X.         25966071
259670     MOVE PV-MODULE                      TO  PC053-LANE-CODE.     25967071
259680                                                                  25968071
259690     SET  PS-P2L-DISTRO-DELETE           TO TRUE.                 25969071
259700                                                                  25970071
259710     IF  PS-NO-ERROR                                              25971071
259720         PERFORM 4700-BLD-HDR-REC                                 25972071
259730     END-IF.                                                      25973071
259740                                                                  25974071
259750     IF  PS-NO-ERROR                                              25975071
259760         PERFORM 4770-BLD-TLR-REC                                 25976071
259770     END-IF.                                                      25977071
259780                                                                  25978071
259790                                                                  25979071
259800*----------------------------------------------------------------*25980071
259810* SEND DATA TO LTP -OR- THP P2L SYSTEMS.                         *25981071
259820* ADDED 11-07-2000                                               *25982071
259830*----------------------------------------------------------------*25983071
259840 4970-SEND-P2L-DATA-LTP-THP.                                      25984071
259850*===TKMA408=== THIS IS IN JUST FOR TESTING                        25985071
259860     IF   PS-DISPLAY-CSSL-YES                                     25986071
259870          IF  LQW-P2L-DYNAPACK (LQW-IDX)                          25987071
259880              IF LQW-P2L-ALS-4-DIGIT-STR (LQW-IDX)                25988071
259890                 STRING ' PCKCS701-4970-AL '                      25989071
259900                        PC053-DISTRO-RECORD   DELIMITED BY SIZE   25990071
259910                                         INTO PV-CICS-152-RECORD  25991071
259920              END-IF                                              25992071
259930          ELSE                                                    25993071
259940                 STRING ' PCKCS701-4970-PCC '                     25994071
259950                        PC184-DISTRO-RECORD   DELIMITED BY SIZE   25995071
259960                                         INTO PV-CICS-152-RECORD  25996071
259970          END-IF                                                  25997071
259980        MOVE PV-CICS-1-99             TO PV-CICS-MSG-DATA2        25998071
259990        MOVE PV-CICS-MSG-HOLD2        TO PV-CICS-MSG-AREA2        25999071
260000        MOVE LENGTH OF PV-CICS-MSG-AREA2                          26000071
260010                                      TO PV-COMMAREA-LENGTH       26001071
260020        EXEC CICS                                                 26002071
260030            WRITEQ TD                                             26003071
260040                QUEUE   ('CSSL')                                  26004071
260050                FROM    (PV-CICS-MSG-AREA2)                       26005071
260060                LENGTH  (PV-COMMAREA-LENGTH)                      26006071
260070                RESP    (PV-CICS-RESP)                            26007071
260080        END-EXEC                                                  26008071
260090     END-IF                                                       26009071
260100*===TKMA408=== THIS IS IN JUST FOR TESTING                        26010071
260110                                                                  26011071
260120     MOVE LOW-VALUES                TO TCP-BUF2.                  26012071
260130                                                                  26013071
260140     IF  PC184-DISTRO-HDR                                         26014071
260150       IF ASC-HAZ-FACILITY-YES                                    26015071
260160         MOVE PC184-DL-DIST-HEADER-2 TO DP081-TCPLENG             26016071
260170                                        DP081-NBR-BYTES           26017071
260180       ELSE                                                       26018071
260190         MOVE PC184-DL-DIST-HEADER  TO DP081-TCPLENG              26019071
260200                                       DP081-NBR-BYTES            26020071
260210       END-IF                                                     26021071
260220         SET  PS-P2L-HEADER         TO TRUE                       26022071
260230     ELSE                                                         26023071
260240     IF  PC184-DISTRO-DTL                                         26024071
260250         MOVE PC184-DL-DIST-DETAIL  TO DP081-TCPLENG              26025071
260260                                       DP081-NBR-BYTES            26026071
260270         SET  PS-P2L-DISTRO-DETAIL  TO TRUE                       26027071
260280     ELSE                                                         26028071
260290     IF  PC184-DISTRO-TLR                                         26029071
260300         MOVE PC184-DL-DIST-TRAILER TO DP081-TCPLENG              26030071
260310                                       DP081-NBR-BYTES            26031071
260320         SET  PS-P2L-DISTRO-TRAILER TO TRUE                       26032071
260330     ELSE                                                         26033071
260340     IF  PC184-DISTRO-DEL                                         26034071
260350         MOVE PC184-DL-DIST-DELETE  TO DP081-TCPLENG              26035071
260360                                       DP081-NBR-BYTES            26036071
260370         SET  PS-P2L-DISTRO-DELETE  TO TRUE                       26037071
260380     ELSE                                                         26038071
260390     IF  PC184-CARTON-DTL                                         26039071
260400         MOVE PC184-DL-CART-DETAIL  TO DP081-TCPLENG              26040071
260410                                       DP081-NBR-BYTES            26041071
260420         SET  PS-P2L-CARTON-DETAIL  TO TRUE                       26042071
260430     ELSE                                                         26043071
260440     IF  PC184-CARTON-TLR                                         26044071
260450         MOVE PC184-DL-CART-TRAILER TO DP081-TCPLENG              26045071
260460                                       DP081-NBR-BYTES            26046071
260470         SET  PS-P2L-CARTON-TRAILER TO TRUE                       26047071
260480     END-IF.                                                      26048071
260490                                                                  26049071
260500     MOVE PC184-DISTRO-RECORD       TO TCP-BUF2.                  26050071
260510                                                                  26051071
260520     CALL 'EZACIC04'                                              26052071
260530         USING DP081-TOASCII-TOKEN                                26053071
260540               TCP-BUF2                                           26054071
260550               DP081-TCPLENG.                                     26055071
260560                                                                  26056071
260570     SET   DP081-OUT-OF-BAND-FLAG    TO  TRUE.                    26057071
260580     IF    LQW-SOCKET-NBR (LQW-IDX)  =  PC-ONE                    26058071
260590           MOVE PV-SOCKET-ONE        TO  DP081-SOCK-ID            26059071
260600     ELSE                                                         26060071
260610           MOVE PV-SOCKET-TWO        TO  DP081-SOCK-ID            26061071
260620     END-IF.                                                      26062071
260630                                                                  26063071
260640* SEND DATA TO LTP -OR- THP P2L SYSTEMS                           26064071
260650                                                                  26065071
260660     CALL 'EZASOKET'                                              26066071
260670         USING DP081-SEND-CMD                                     26067071
260680               DP081-SOCK-ID                                      26068071
260690               DP081-FLAG                                         26069071
260700               DP081-NBR-BYTES                                    26070071
260710               TCP-BUF2                                           26071071
260720               DP081-ERRNO                                        26072071
260730               DP081-RETCODE.                                     26073071
260740                                                                  26074071
260750* CHECK FOR TCP-IP ERROR ON SEND DATA TO LTP -OR- THP P2L SYSTEMS 26075071
260760                                                                  26076071
260770     IF  DP081-RETCODE < ZERO                                     26077071
260780         MOVE PC-CURRENT-PROGRAM-NAME    TO DP081-TCP-IP-PGM-NAME 26078071
260790         SET  DP081-TCP-IP-SEND-ERR      TO TRUE                  26079071
260800         MOVE DP081-ERRNO                TO DP081-TCP-IP-ERR-NBR  26080071
260810         MOVE DP081-RETCODE              TO RECEIVE-RETCODE       26081071
260820         MOVE DP081-TCP-IP-LOGGING-MSG   TO PV-CICS-MSG-DATA      26082071
260830         MOVE PV-CICS-MSG-HOLD           TO PV-CICS-MSG-AREA      26083071
260840         MOVE LENGTH OF PV-CICS-MSG-AREA TO PV-COMMAREA-LENGTH    26084071
260850                                                                  26085071
260860         EXEC CICS                                                26086071
260870              WRITEQ TD                                           26087071
260880                     QUEUE   ('CSSL')                             26088071
260890                     FROM    (PV-CICS-MSG-AREA)                   26089071
260900                     LENGTH  (PV-COMMAREA-LENGTH)                 26090071
260910                     RESP    (PV-CICS-RESP)                       26091071
260920         END-EXEC                                                 26092071
260930                                                                  26093071
260940        INITIALIZE PV-CICS-MSG-AREA2                              26094071
260950        MOVE ASC-PO-NBR                  TO  PV-DSPLY-PO          26095071
260960        MOVE ASC-REC-SEQ-NBR             TO  PV-DSPLY-RCVR        26096071
260970        MOVE DK-LINE-NBR                 TO  PV-DSPLY-LNE         26097071
260980        MOVE ASC-OPER-UNT-ID             TO  PV-DSPLY-OPER        26098071
260990        STRING ' PCKCS701-'                  DELIMITED BY SIZE    26099071
261000               '4970-SEND-P2L-DATA-LTP-THP'  DELIMITED BY SIZE    26100071
261010               ' - '                         DELIMITED BY SIZE    26101071
261020               PV-DSPLY-OPER                 DELIMITED BY SIZE    26102071
261030               ' PO/RCVR/LNE - '             DELIMITED BY SIZE    26103071
261040               PV-DSPLY-PO                   DELIMITED BY SIZE    26104071
261050               '-'                           DELIMITED BY SIZE    26105071
261060               PV-DSPLY-RCVR                 DELIMITED BY SIZE    26106071
261070               '-'                           DELIMITED BY SIZE    26107071
261080               PV-DSPLY-LNE                  DELIMITED BY SIZE    26108071
261090                                        INTO PV-CICS-MSG-AREA2    26109071
261100        MOVE LENGTH OF PV-CICS-MSG-AREA2 TO PV-COMMAREA-LENGTH    26110071
261110                                                                  26111071
261120        EXEC CICS                                                 26112071
261130            WRITEQ TD                                             26113071
261140                QUEUE   ('CSSL')                                  26114071
261150                FROM    (PV-CICS-MSG-AREA2)                       26115071
261160                LENGTH  (PV-COMMAREA-LENGTH)                      26116071
261170                RESP    (PV-CICS-RESP)                            26117071
261180        END-EXEC                                                  26118071
261190                                                                  26119071
261200        SET  PS-ERROR                                             26120071
261210             DP020-MSG-FATAL  TO TRUE                             26121071
261220        IF  PS-DISTHD-UPDATE                                      26122071
261230            MOVE PC-TSYMSG-02458  TO DP020-MSG-NUMBER             26123071
261240        ELSE                                                      26124071
261250            MOVE PC-TSYMSG-01766  TO DP020-MSG-NUMBER             26125071
261260        END-IF                                                    26126071
261270        PERFORM 9900-SOFT-ABORT                                   26127071
261280     END-IF.                                                      26128071
261290                                                                  26129071
261300*** CHANGE  CONFIRM  TO ONLY BE REQUIRED IF COMING FROM:          26130071
261310*** THEOPACK - FOR ALL RECORDS                                    26131071
261320*** PCC - DISTRO-TLR OR CARTON-TLR                                26132071
261330                                                                  26133071
261340     EVALUATE TRUE                                                26134071
261350         WHEN LQW-P2L-THEOPACK(LQW-IDX)                           26135071
261360         WHEN PC184-DISTRO-TLR                                    26136071
261370         WHEN PC184-CARTON-TLR                                    26137071
261380         WHEN PC184-DISTRO-DEL                                    26138071
261390                                                                  26139071
261400              IF  PS-NO-ERROR                                     26140071
261410                  MOVE '4970-SEND-P2L-DATA-LTP-THP'               26141071
261420                    TO  PV-CALLING-PARAGRAPH                      26142071
261430                        PERFORM 4973-CHECK-SOCKET-CONNECTION      26143071
261440                    IF  PS-NO-ERROR                               26144071
261450                        PERFORM 4975-RECV-CONFIRM-FROM-LTP-THP    26145071
261460                    END-IF                                        26146071
261470              END-IF                                              26147071
261480     END-EVALUATE.                                                26148071
261490                                                                  26149071
261500* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 26150071
261510*  added Select socket command to check if socket connection    * 26151071
261520*  is still active.  if return code > 0 then socket is active   * 26152071
261530*  if return code = 0 socket is no longer active.               * 26153071
261540* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 26154071
261550 4973-CHECK-SOCKET-CONNECTION.                                    26155071
261560                                                                  26156071
261570     IF   PS-DISPLAY-CSSL-YES                                     26157071
261580          IF  LQW-P2L-DYNAPACK (LQW-IDX)                          26158071
261590              STRING ' PCKCS701-4973-AL '     DELIMITED BY SIZE   26159071
261600                                         INTO PV-CICS-152-RECORD  26160071
261610          ELSE                                                    26161071
261620              STRING ' PCKCS701-4973-PCC '    DELIMITED BY SIZE   26162071
261630                                         INTO PV-CICS-152-RECORD  26163071
261640          END-IF                                                  26164071
261650        MOVE PV-CICS-1-99             TO PV-CICS-MSG-DATA2        26165071
261660        MOVE PV-CICS-MSG-HOLD2        TO PV-CICS-MSG-AREA2        26166071
261670        MOVE LENGTH OF PV-CICS-MSG-AREA2                          26167071
261680                                      TO PV-COMMAREA-LENGTH       26168071
261690        EXEC CICS                                                 26169071
261700            WRITEQ TD                                             26170071
261710                QUEUE   ('CSSL')                                  26171071
261720                FROM    (PV-CICS-MSG-AREA2)                       26172071
261730                LENGTH  (PV-COMMAREA-LENGTH)                      26173071
261740                RESP    (PV-CICS-RESP)                            26174071
261750        END-EXEC                                                  26175071
261760     END-IF.                                                      26176071
261770                                                                  26177071
261780* ZERO OUT ALL OUTPUT BIT MASKS FOR SELECT                        26178071
261790     PERFORM VARYING SOCKNO FROM 1 BY 1 UNTIL SOCKNO > SOCKETS    26179071
261800        MOVE '0' TO CHAR-ENTRY(SOCKNO)                            26180071
261810     END-PERFORM.                                                 26181071
261820     PERFORM 4974-CHAR-TO-BIT.                                    26182071
261830     MOVE BIT-MASK TO SELECT-RR-MASK.                             26183071
261840     MOVE BIT-MASK TO SELECT-RW-MASK.                             26184071
261850     MOVE BIT-MASK TO SELECT-RE-MASK.                             26185071
261860     MOVE BIT-MASK TO SELECT-EX-MASK.                             26186071
261870     MOVE BIT-MASK TO SELECT-WR-MASK.                             26187071
261880                                                                  26188071
261890* set all input bit masks for select to 1                         26189071
261900     PERFORM VARYING SOCKNO FROM 1 BY 1 UNTIL SOCKNO > SOCKETS    26190071
261910        MOVE '1' TO CHAR-ENTRY(SOCKNO)                            26191071
261920     END-PERFORM.                                                 26192071
261930     PERFORM 4974-CHAR-TO-BIT.                                    26193071
261940     MOVE BIT-MASK TO SELECT-RD-MASK.                             26194071
261950*                                                                 26195071
261960* ISSUE THE SELECT COMMAND ----------------------------           26196071
261970* SELECT WILL FLIP A BIT IN THE READ MASK TO '1' FOR ANY          26197071
261980* SOCKET THAT HAS DATA TO BE PROCESSED.                           26198071
261990*                                                                 26199071
262000                                                                  26200071
262010     MOVE 0 TO DP081-ERRNO.                                       26201071
262020     MOVE 0 TO DP081-RETCODE.                                     26202071
262030     CALL 'EZASOKET' USING DP081-SELECT-CMD                       26203071
262040         SELECT-NUMFDS SELECT-TIMEOUT                             26204071
262050         SELECT-RD-MASK SELECT-WR-MASK SELECT-EX-MASK             26205071
262060         SELECT-RR-MASK SELECT-RW-MASK SELECT-RE-MASK             26206071
262070         DP081-ERRNO DP081-RETCODE.                               26207071
262080                                                                  26208071
262090     IF DP081-RETCODE < 0                                         26209071
262100         MOVE  DP081-RETCODE  TO  PV-SOCKET-RETCODE               26210071
262110         MOVE  DP081-ERRNO    TO  PV-SOCKET-ERRNO                 26211071
262120         INITIALIZE  PV-CICS-MSG-AREA2                            26212071
262130         STRING ' PCKCS701 - '              DELIMITED BY SIZE     26213071
262140                '4973-select-socket'        DELIMITED BY SIZE     26214071
262150                ' RETCODE = '               DELIMITED BY SIZE     26215071
262160                PV-SOCKET-RETCODE           DELIMITED BY SIZE     26216071
262170                ' ERROR # = '               DELIMITED BY SIZE     26217071
262180                PV-SOCKET-ERRNO             DELIMITED BY SIZE     26218071
262190                                        INTO PV-CICS-MSG-AREA2    26219071
262200         MOVE LENGTH OF PV-CICS-MSG-AREA2 TO PV-COMMAREA-LENGTH   26220071
262210                                                                  26221071
262220         EXEC CICS                                                26222071
262230             WRITEQ TD                                            26223071
262240                 QUEUE   ('CSSL')                                 26224071
262250                 FROM    (PV-CICS-MSG-AREA2)                      26225071
262260                 LENGTH  (PV-COMMAREA-LENGTH)                     26226071
262270                 RESP    (PV-CICS-RESP)                           26227071
262280         END-EXEC                                                 26228071
262290                                                                  26229071
262300         MOVE PC-CURRENT-PROGRAM-NAME    TO DP081-TCP-IP-PGM-NAME 26230071
262310         SET  DP081-TCP-IP-READ-ERR      TO TRUE                  26231071
262320         MOVE DP081-ERRNO                TO DP081-TCP-IP-ERR-NBR  26232071
262330         MOVE DP081-TCP-IP-LOGGING-MSG   TO PV-CICS-MSG-DATA      26233071
262340         MOVE PV-CICS-MSG-HOLD           TO PV-CICS-MSG-AREA      26234071
262350         MOVE LENGTH OF PV-CICS-MSG-AREA TO PV-COMMAREA-LENGTH    26235071
262360                                                                  26236071
262370         EXEC CICS                                                26237071
262380             WRITEQ TD                                            26238071
262390                 QUEUE   ('CSSL')                                 26239071
262400                 FROM    (PV-CICS-MSG-AREA)                       26240071
262410                 LENGTH  (PV-COMMAREA-LENGTH)                     26241071
262420                 RESP    (PV-CICS-RESP)                           26242071
262430         END-EXEC                                                 26243071
262440                                                                  26244071
262450         SET  PS-ERROR                                            26245071
262460              PS-SOFT-ABORT-ERROR                                 26246071
262470              DP020-MSG-FATAL  TO TRUE                            26247071
262480         IF  PS-DISTHD-UPDATE                                     26248071
262490             MOVE PC-TSYMSG-02458  TO DP020-MSG-NUMBER            26249071
262500         ELSE                                                     26250071
262510             MOVE PC-TSYMSG-01766  TO DP020-MSG-NUMBER            26251071
262520         END-IF                                                   26252071
262530         PERFORM 9900-SOFT-ABORT                                  26253071
262540                                                                  26254071
262550     ELSE                                                         26255071
262560     IF DP081-RETCODE = 0                                         26256071
262570         MOVE  DP081-RETCODE  TO  PV-SOCKET-RETCODE               26257071
262580         MOVE  DP081-ERRNO    TO  PV-SOCKET-ERRNO                 26258071
262590         INITIALIZE  PV-CICS-MSG-AREA2                            26259071
262600         STRING ' PCKCS701 - '              DELIMITED BY SIZE     26260071
262610                '4973-select-socket'        DELIMITED BY SIZE     26261071
262620                ' RETCODE = '               DELIMITED BY SIZE     26262071
262630                PV-SOCKET-RETCODE           DELIMITED BY SIZE     26263071
262640                ' ERROR # = '               DELIMITED BY SIZE     26264071
262650                PV-SOCKET-ERRNO             DELIMITED BY SIZE     26265071
262660                ' socket timeout '          DELIMITED BY SIZE     26266071
262670                                        INTO PV-CICS-MSG-AREA2    26267071
262680         MOVE LENGTH OF PV-CICS-MSG-AREA2 TO PV-COMMAREA-LENGTH   26268071
262690                                                                  26269071
262700         EXEC CICS                                                26270071
262710             WRITEQ TD                                            26271071
262720                 QUEUE   ('CSSL')                                 26272071
262730                 FROM    (PV-CICS-MSG-AREA2)                      26273071
262740                 LENGTH  (PV-COMMAREA-LENGTH)                     26274071
262750                 RESP    (PV-CICS-RESP)                           26275071
262760         END-EXEC                                                 26276071
262770                                                                  26277071
262780         MOVE PC-CURRENT-PROGRAM-NAME    TO DP081-TCP-IP-PGM-NAME 26278071
262790         SET  DP081-TCP-IP-READ-ERR      TO TRUE                  26279071
262800         MOVE DP081-ERRNO                TO DP081-TCP-IP-ERR-NBR  26280071
262810         MOVE DP081-TCP-IP-LOGGING-MSG   TO PV-CICS-MSG-DATA      26281071
262820         MOVE PV-CICS-MSG-HOLD           TO PV-CICS-MSG-AREA      26282071
262830         MOVE LENGTH OF PV-CICS-MSG-AREA TO PV-COMMAREA-LENGTH    26283071
262840                                                                  26284071
262850         EXEC CICS                                                26285071
262860             WRITEQ TD                                            26286071
262870                 QUEUE   ('CSSL')                                 26287071
262880                 FROM    (PV-CICS-MSG-AREA)                       26288071
262890                 LENGTH  (PV-COMMAREA-LENGTH)                     26289071
262900                 RESP    (PV-CICS-RESP)                           26290071
262910         END-EXEC                                                 26291071
262920                                                                  26292071
262930         SET  PS-ERROR                                            26293071
262940              DP020-MSG-FATAL  TO TRUE                            26294071
262950         IF  PS-DISTHD-UPDATE                                     26295071
262960             MOVE PC-TSYMSG-02458  TO DP020-MSG-NUMBER            26296071
262970         ELSE                                                     26297071
262980             MOVE PC-TSYMSG-01766  TO DP020-MSG-NUMBER            26298071
262990         END-IF                                                   26299071
263000        PERFORM 9900-SOFT-ABORT                                   26300071
263010     END-IF.                                                      26301071
263020                                                                  26302071
263030***************************************************************   26303071
263040* CHAR-TO-BIT                                                 *   26304071
263050* CONVERT THE CHARACTER ARRAY TO A SELECT BIT MASK SO THAT THE*   26305071
263060* COBOL PROGRAM CAN WRITE IT.                                 *   26306071
263070***************************************************************   26307071
263080 4974-CHAR-TO-BIT.                                                26308071
263090                                                                  26309071
263100     IF   PS-DISPLAY-CSSL-YES                                     26310071
263110          IF  LQW-P2L-DYNAPACK (LQW-IDX)                          26311071
263120              STRING ' PCKCS701-4974-AL '     DELIMITED BY SIZE   26312071
263130                                         INTO PV-CICS-152-RECORD  26313071
263140          ELSE                                                    26314071
263150              STRING ' PCKCS701-4974-PCC '    DELIMITED BY SIZE   26315071
263160                                         INTO PV-CICS-152-RECORD  26316071
263170          END-IF                                                  26317071
263180        MOVE PV-CICS-1-99             TO PV-CICS-MSG-DATA2        26318071
263190        MOVE PV-CICS-MSG-HOLD2        TO PV-CICS-MSG-AREA2        26319071
263200        MOVE LENGTH OF PV-CICS-MSG-AREA2                          26320071
263210                                      TO PV-COMMAREA-LENGTH       26321071
263220        EXEC CICS                                                 26322071
263230            WRITEQ TD                                             26323071
263240                QUEUE   ('CSSL')                                  26324071
263250                FROM    (PV-CICS-MSG-AREA2)                       26325071
263260                LENGTH  (PV-COMMAREA-LENGTH)                      26326071
263270                RESP    (PV-CICS-RESP)                            26327071
263280        END-EXEC                                                  26328071
263290     END-IF.                                                      26329071
263300*                                                                 26330071
263310* CHAR-TO-BIT                                                     26331071
263320* CONVERT THE CHARACTER ARRAY TO A SELECT BIT MASK SO THAT THE    26332071
263330* COBOL PROGRAM CAN WRITE IT.                                     26333071
263340*                                                                 26334071
263350     CALL 'EZACIC06' USING BITMASK-TOKEN CTOB                     26335071
263360          BIT-MASK CHAR-MASK BIT-MASK-LENGTH EZRETC               26336071
263370     IF  EZRETC < 0 THEN                                          26337071
263380         MOVE '!EZCIC06 - CTOB-EXCP ' TO PV-CICS-MSG-AREA         26338071
263390         MOVE LENGTH OF PV-CICS-MSG-AREA TO PV-COMMAREA-LENGTH    26339071
263400                                                                  26340071
263410         EXEC CICS                                                26341071
263420             WRITEQ TD                                            26342071
263430                 QUEUE   ('CSSL')                                 26343071
263440                 FROM    (PV-CICS-MSG-AREA)                       26344071
263450                 LENGTH  (PV-COMMAREA-LENGTH)                     26345071
263460                 RESP    (PV-CICS-RESP)                           26346071
263470         END-EXEC                                                 26347071
263480                                                                  26348071
263490         SET  PS-ERROR                                            26349071
263500              DP020-MSG-FATAL  TO TRUE                            26350071
263510         IF  PS-DISTHD-UPDATE                                     26351071
263520             MOVE PC-TSYMSG-02458  TO DP020-MSG-NUMBER            26352071
263530         ELSE                                                     26353071
263540             MOVE PC-TSYMSG-01766  TO DP020-MSG-NUMBER            26354071
263550         END-IF                                                   26355071
263560     END-IF.                                                      26356071
263570                                                                  26357071
263580                                                                  26358071
263590*----------------------------------------------------------------*26359071
263600*  RECEIVE CONFIRMATION BACK FROM P2L SYSTEMS LTP -OR- THP       *26360071
263610* ADDED 11-07-2000                                               *26361071
263620*----------------------------------------------------------------*26362071
263630 4975-RECV-CONFIRM-FROM-LTP-THP.                                  26363071
263640                                                                  26364071
263650*                                                                 26365071
263660*===TKMA408=== THIS IS IN JUST FOR TESTING                        26366071
263670*       INITIALIZE  PV-CICS-MSG-AREA2                             26367071
263680*      STRING ' PCKCS701 - '              DELIMITED BY SIZE       26368071
263690*             '4975-RECV-CONFIRM-FROM-LT' DELIMITED BY SIZE       26369071
263700*                                   INTO PV-CICS-MSG-AREA2        26370071
263710*       MOVE LENGTH OF PV-CICS-MSG-AREA2                          26371071
263720*                                     TO PV-COMMAREA-LENGTH       26372071
263730*       EXEC CICS                                                 26373071
263740*           WRITEQ TD                                             26374071
263750*               QUEUE   ('CSSL')                                  26375071
263760*               FROM    (PV-CICS-MSG-AREA2)                       26376071
263770*               LENGTH  (PV-COMMAREA-LENGTH)                      26377071
263780*               RESP    (PV-CICS-RESP)                            26378071
263790*       END-EXEC                                                  26379071
263800*       INITIALIZE  PV-CICS-MSG-AREA2                             26380071
263810*===TKMA408=== THIS IS IN JUST FOR TESTING                        26381071
263820                                                                  26382071
263830                                                                  26383071
263840* RECEIVE DATA ON A CONNECTED SOCKET                              26384071
263850                                                                  26385071
263860     MOVE ZERO                       TO PV-BUFFER-SUB.            26386071
263870     MOVE SPACES                     TO TCP-BUF-AREA.             26387071
263880     SET PS-SOCKET-OPEN              TO TRUE.                     26388071
263890                                                                  26389071
263900     IF    LQW-SOCKET-NBR (LQW-IDX)  =  PC-ONE                    26390071
263910           MOVE PV-SOCKET-ONE        TO  DP081-SOCK-ID            26391071
263920     ELSE                                                         26392071
263930           MOVE PV-SOCKET-TWO        TO  DP081-SOCK-ID            26393071
263940     END-IF.                                                      26394071
263950                                                                  26395071
263960     MOVE LOW-VALUES                 TO  TCP-BUF2.                26396071
263970                                                                  26397071
263980     IF  PS-P2L-DISTRO-DELETE                                     26398071
263990         MOVE PC184-DL-DEL-CONFIRM   TO  DP081-TCPLENG            26399071
264000     ELSE                                                         26400071
264010         MOVE PC184-DL-CONFIRM       TO  DP081-TCPLENG            26401071
264020     END-IF.                                                      26402071
264030     MOVE 1                          TO  DP081-NBR-BYTES.         26403071
264040                                                                  26404071
264050     PERFORM UNTIL TCP-BUF-ONE(PV-BUFFER-SUB) = PC-SEMI-COLON     26405071
264060                OR TCP-BUF-ONE(PV-BUFFER-SUB) = PC-SEMI-COLON-2   26406071
264070                OR TCP-BUF-ONE(PV-BUFFER-SUB) = PC-SEMI-COLON-3   26407071
264080                OR PS-SOCKET-CLOSED                               26408071
264090                OR PS-ERROR                                       26409071
264100             CALL 'EZASOKET'                                      26410071
264110                   USING DP081-RECV-CMD                           26411071
264120                         DP081-SOCK-ID                            26412071
264130                         DP081-RECV-FLAG                          26413071
264140                         DP081-NBR-BYTES                          26414071
264150                         TCP-BUF-ONE (PV-BUFFER-SUB + 1)          26415071
264160                         DP081-ERRNO                              26416071
264170                         DP081-RETCODE                            26417071
264180                                                                  26418071
264190             IF  DP081-RETCODE > ZERO                             26419071
264200                 ADD DP081-RETCODE        TO PV-BUFFER-SUB        26420071
264210             ELSE                                                 26421071
264220             IF  DP081-RETCODE = ZERO                             26422071
264230                 SET PS-SOCKET-CLOSED     TO TRUE                 26423071
264240             ELSE                                                 26424071
264250                 IF  PS-NO-ERROR                                  26425071
264260                     INITIALIZE PV-CICS-MSG-AREA                  26426071
264270                     MOVE DK-PO-NBR      TO  PV-DSPLY-PO          26427071
264280                     MOVE DK-REC-SEQ-NBR TO  PV-DSPLY-RCVR        26428071
264290                     MOVE DK-LINE-NBR    TO  PV-DSPLY-LNE         26429071
264300                     MOVE ASC-OPER-UNT-ID  TO  PV-DSPLY-OPER      26430071
264310                     STRING  ' PCKCS701 -'     DELIMITED BY SIZE  26431071
264320                             PV-DSPLY-OPER     DELIMITED BY SIZE  26432071
264330                             ' PO/RCVR/LNE - ' DELIMITED BY SIZE  26433071
264340                             PV-DSPLY-PO       DELIMITED BY SIZE  26434071
264350                             '-'               DELIMITED BY SIZE  26435071
264360                             PV-DSPLY-RCVR     DELIMITED BY SIZE  26436071
264370                             '-'               DELIMITED BY SIZE  26437071
264380                             PV-DSPLY-LNE      DELIMITED BY SIZE  26438071
264390                                          INTO PV-CICS-MSG-AREA   26439071
264400                     MOVE LENGTH OF PV-CICS-MSG-AREA              26440071
264410                                            TO PV-COMMAREA-LENGTH 26441071
264420                                                                  26442071
264430                     EXEC CICS                                    26443071
264440                          WRITEQ TD                               26444071
264450                          QUEUE   ('CSSL')                        26445071
264460                          FROM    (PV-CICS-MSG-AREA)              26446071
264470                          LENGTH  (PV-COMMAREA-LENGTH)            26447071
264480                          RESP    (PV-CICS-RESP)                  26448071
264490                     END-EXEC                                     26449071
264500                                                                  26450071
264510                     INITIALIZE PV-CICS-MSG-AREA                  26451071
264520                     MOVE PC-CURRENT-PROGRAM-NAME                 26452071
264530                                         TO DP081-TCP-IP-PGM-NAME 26453071
264540                     SET  DP081-TCP-IP-READ-ERR                   26454071
264550                                         TO TRUE                  26455071
264560                     MOVE DP081-ERRNO                             26456071
264570                                         TO DP081-TCP-IP-ERR-NBR  26457071
264580                     MOVE DP081-RETCODE                           26458071
264590                                         TO RECEIVE-RETCODE       26459071
264600                     MOVE DP081-TCP-IP-LOGGING-MSG                26460071
264610                                         TO PV-CICS-MSG-DATA      26461071
264620                     MOVE PV-CICS-MSG-HOLD                        26462071
264630                                         TO PV-CICS-MSG-AREA      26463071
264640                     MOVE LENGTH OF PV-CICS-MSG-AREA              26464071
264650                                         TO PV-COMMAREA-LENGTH    26465071
264660                                                                  26466071
264670                     EXEC CICS                                    26467071
264680                          WRITEQ TD                               26468071
264690                                 QUEUE   ('CSSL')                 26469071
264700                                 FROM    (PV-CICS-MSG-AREA)       26470071
264710                                 LENGTH  (PV-COMMAREA-LENGTH)     26471071
264720                             RESP    (PV-CICS-RESP)               26472071
264730                     END-EXEC                                     26473071
264740                                                                  26474071
264750                     MOVE '4975-RECV-CONFIRM-FROM-LTP-THP'        26475071
264760                       TO PV-CALLING-PARAGRAPH                    26476071
264770                                                                  26477071
264780                     MOVE PV-CALLING-PARAGRAPH                    26478071
264790                                         TO PV-CICS-MSG-DATA2     26479071
264800                     MOVE PV-CICS-MSG-HOLD2                       26480071
264810                                         TO PV-CICS-MSG-AREA2     26481071
264820                     MOVE LENGTH OF PV-CICS-MSG-AREA2             26482071
264830                                         TO PV-COMMAREA-LENGTH    26483071
264840                                                                  26484071
264850                     EXEC CICS                                    26485071
264860                          WRITEQ TD                               26486071
264870                           QUEUE   ('CSSL')                       26487071
264880                           FROM    (PV-CICS-MSG-AREA2)            26488071
264890                           LENGTH  (PV-COMMAREA-LENGTH)           26489071
264900                           RESP    (PV-CICS-RESP)                 26490071
264910                     END-EXEC                                     26491071
264920                 END-IF                                           26492071
264930                                                                  26493071
264940                 SET  PS-ERROR                                    26494071
264950                      DP020-MSG-FATAL  TO TRUE                    26495071
264960                 IF  PS-DISTHD-UPDATE                             26496071
264970                     MOVE PC-TSYMSG-02458  TO DP020-MSG-NUMBER    26497071
264980                 ELSE                                             26498071
264990                     MOVE PC-TSYMSG-01766  TO DP020-MSG-NUMBER    26499071
265000                 END-IF                                           26500071
265010                 PERFORM 9900-SOFT-ABORT                          26501071
265020             END-IF                                               26502071
265030             END-IF                                               26503071
265040     END-PERFORM.                                                 26504071
265050                                                                  26505071
265060* TRANSLATE ASCII TO EBCDIC                                       26506071
265070                                                                  26507071
265080     CALL 'EZACIC05'                                              26508071
265090         USING DP081-TOEBCDIC-TOKEN                               26509071
265100               TCP-BUF-ALL                                        26510071
265110               DP081-TCPLENG.                                     26511071
265120                                                                  26512071
265130* CHECK FOR TCP-IP ERROR ON CONFIRM-RECEIVE                       26513071
265140                                                                  26514071
265150                                                                  26515071
265160*                                                                 26516071
265170*===TKMA408=== THIS IS IN JUST FOR TESTING                        26517071
265180*    INITIALIZE  PV-CICS-MSG-AREA2                                26518071
265190*    STRING ' PCKCS701 - '                DELIMITED BY SIZE       26519071
265200*           '4975-RECV-CONFIRM-FROM-LTP'  DELIMITED BY SIZE       26520071
265210*                                    INTO PV-CICS-MSG-AREA2       26521071
265220*    MOVE LENGTH OF PV-CICS-MSG-AREA2                             26522071
265230*                                     TO PV-COMMAREA-LENGTH       26523071
265240*       EXEC CICS                                                 26524071
265250*           WRITEQ TD                                             26525071
265260*               QUEUE   ('CSSL')                                  26526071
265270*               FROM    (PV-CICS-MSG-AREA2)                       26527071
265280*               LENGTH  (PV-COMMAREA-LENGTH)                      26528071
265290*               RESP    (PV-CICS-RESP)                            26529071
265300*       END-EXEC                                                  26530071
265310*       INITIALIZE  PV-CICS-MSG-AREA2                             26531071
265320*===TKMA408=== THIS IS IN JUST FOR TESTING                        26532071
265330                                                                  26533071
265340                                                                  26534071
265350* CHECK TO SEE IF NEW P2L SYSTEMS RCVD TRANSMISSION OK (LTP & THP)26535071
265360                                                                  26536071
265370     MOVE TCP-BUF-ALL TO PC184-DISTRO-RECORD.                     26537071
265380                                                                  26538071
265390*===TKMA408=== THIS IS IN JUST FOR TESTING                        26539071
265400     IF   PS-DISPLAY-CSSL-YES                                     26540071
265410          IF  LQW-P2L-DYNAPACK (LQW-IDX)                          26541071
265420              IF  LQW-P2L-ALS-4-DIGIT-STR (LQW-IDX)               26542071
265430                 MOVE PC053-DISTRO-RECORD  TO PV-CICS-152-RECORD  26543071
265440              END-IF                                              26544071
265450          ELSE                                                    26545071
265460                 MOVE PC184-DISTRO-RECORD  TO PV-CICS-152-RECORD  26546071
265470          END-IF                                                  26547071
265480        MOVE PV-CICS-1-99             TO PV-CICS-MSG-DATA2        26548071
265490        MOVE PV-CICS-MSG-HOLD2        TO PV-CICS-MSG-AREA2        26549071
265500        MOVE LENGTH OF PV-CICS-MSG-AREA2                          26550071
265510                                      TO PV-COMMAREA-LENGTH       26551071
265520        EXEC CICS                                                 26552071
265530            WRITEQ TD                                             26553071
265540                QUEUE   ('CSSL')                                  26554071
265550                FROM    (PV-CICS-MSG-AREA2)                       26555071
265560                LENGTH  (PV-COMMAREA-LENGTH)                      26556071
265570                RESP    (PV-CICS-RESP)                            26557071
265580        END-EXEC                                                  26558071
265590     END-IF                                                       26559071
265600*===TKMA408=== THIS IS IN JUST FOR TESTING                        26560071
265610                                                                  26561071
265620                                                                  26562071
265630     IF  PS-P2L-DISTRO-DELETE                     AND             26563071
265640           ((PC184-DIST-CONFIRM   AND                             26564071
265650             PC184-DIST-DEL-COMPLETE)   OR                        26565071
265660            (PC184-CONFIRM-ERROR  AND                             26566071
265670             PC184-DIST-DID-NOT-EXIST))                           26567071
265680        CONTINUE                                                  26568071
265690                                                                  26569071
265700     ELSE                                                         26570071
265710                                                                  26571071
265720     IF  (PS-P2L-HEADER               OR                          26572071
265730          PS-P2L-DISTRO-DETAIL        OR                          26573071
265740          PS-P2L-DISTRO-TRAILER)                  AND             26574071
265750             PC184-DIST-CONFIRM                                   26575071
265760        CONTINUE                                                  26576071
265770                                                                  26577071
265780     ELSE                                                         26578071
265790                                                                  26579071
265800     IF  (PS-P2L-CARTON-DETAIL        OR                          26580071
265810          PS-P2L-CARTON-TRAILER)                  AND             26581071
265820             PC184-CART-CONFIRM                                   26582071
265830        CONTINUE                                                  26583071
265840                                                                  26584071
265850     ELSE                                                         26585071
265860                                                                  26586071
265870        PERFORM 4655-CLOSE-SOCKET                                 26587071
265880        SET PS-SOCKET-INITIALIZED-NO    TO TRUE                   26588071
265890        MOVE PC-CURRENT-PROGRAM-NAME    TO DP081-TCP-IP-PGM-NAME  26589071
265900        SET  DP081-TCP-IP-READ-ERR      TO TRUE                   26590071
265910        MOVE DP081-ERRNO                TO DP081-TCP-IP-ERR-NBR   26591071
265920                                           RECEIVE-ERRNO          26592071
265930        MOVE ASC-PO-NBR                 TO RECEIVE-RECEIVER       26593071
265940        MOVE ASC-REC-SEQ-NBR            TO RECEIVE-SEQ            26594071
265950        MOVE PV-PO-LINE-NBR-X           TO RECEIVE-LINE           26595071
265960        MOVE '4975'                     TO RECEIVE-PARA           26596071
265970        IF  PS-P2L-DISTRO-DELETE                                  26597071
265980            MOVE PC184-DEL-CONF-ERROR-CODE                        26598071
265990                                        TO RECEIVE-P2L-ERR        26599071
266000        ELSE                                                      26600071
266010            MOVE PC184-CONFIRM-ERROR-CODE                         26601071
266020                                        TO RECEIVE-P2L-ERR        26602071
266030        END-IF                                                    26603071
266040        MOVE RECEIVE-ERR                TO PV-CICS-MSG-DATA       26604071
266050        MOVE PV-CICS-MSG-HOLD           TO PV-CICS-MSG-AREA       26605071
266060        MOVE LENGTH OF PV-CICS-MSG-AREA TO PV-COMMAREA-LENGTH     26606071
266070                                                                  26607071
266080        EXEC CICS                                                 26608071
266090            WRITEQ TD                                             26609071
266100                QUEUE   ('CSSL')                                  26610071
266110                FROM    (PV-CICS-MSG-AREA)                        26611071
266120                LENGTH  (PV-COMMAREA-LENGTH)                      26612071
266130                RESP    (PV-CICS-RESP)                            26613071
266140        END-EXEC                                                  26614071
266150                                                                  26615071
266160        MOVE '4975-RECV-CONFIRM-FROM-LTP-THP'                     26616071
266170                                         TO PV-CALLING-PARAGRAPH  26617071
266180        MOVE PV-CALLING-PARAGRAPH        TO PV-CICS-MSG-DATA2     26618071
266190        MOVE PV-CICS-MSG-HOLD2           TO PV-CICS-MSG-AREA2     26619071
266200        MOVE LENGTH OF PV-CICS-MSG-AREA2 TO PV-COMMAREA-LENGTH    26620071
266210                                                                  26621071
266220        EXEC CICS                                                 26622071
266230            WRITEQ TD                                             26623071
266240                QUEUE   ('CSSL')                                  26624071
266250                FROM    (PV-CICS-MSG-AREA2)                       26625071
266260                LENGTH  (PV-COMMAREA-LENGTH)                      26626071
266270                RESP    (PV-CICS-RESP)                            26627071
266280        END-EXEC                                                  26628071
266290                                                                  26629071
266300        MOVE  PC184-CONFIRM-ERROR-CODE  TO  PC184-VNDR-ERROR-CODE 26630071
266310                                                                  26631071
266320        INITIALIZE      PV-CICS-MSG-AREA2                         26632071
266330        STRING ' PCKCS701-'        DELIMITED BY SIZE              26633071
266340               PC184-DISTRO-RECORD DELIMITED BY SIZE              26634071
266350                              INTO PV-CICS-MSG-AREA2              26635071
266360        MOVE LENGTH OF PV-CICS-MSG-AREA2                          26636071
266370                                TO PV-COMMAREA-LENGTH             26637071
266380        EXEC CICS                                                 26638071
266390             WRITEQ TD                                            26639071
266400              QUEUE      ('CSSL')                                 26640071
266410               FROM      (PV-CICS-MSG-AREA2)                      26641071
266420             LENGTH      (PV-COMMAREA-LENGTH)                     26642071
266430               RESP      (PV-CICS-RESP)                           26643071
266440        END-EXEC                                                  26644071
266450                                                                  26645071
266460        SET  PS-ERROR                                             26646071
266470             DP020-MSG-FATAL  TO TRUE                             26647071
266480        IF  LQW-P2L-PCC(LQW-IDX)  AND                             26648071
266490            PC184-LTP-ALREADY-LAUNCHED                            26649071
266500                MOVE PC-TSYMSG-02540  TO DP020-MSG-NUMBER         26650071
266510        ELSE                                                      26651071
266520        IF  LQW-P2L-THEOPACK(LQW-IDX)  AND                        26652071
266530            PC184-THP-DISTRO-WRONG-STATUS                         26653071
266540                MOVE PC-TSYMSG-02540  TO DP020-MSG-NUMBER         26654071
266550        ELSE                                                      26655071
266560        IF   PS-P2L-DISTRO-DELETE                                 26656071
266570                MOVE PC-TSYMSG-02540  TO DP020-MSG-NUMBER         26657071
266580        ELSE                                                      26658071
266590                MOVE PC-TSYMSG-01766  TO DP020-MSG-NUMBER         26659071
266600        END-IF                                                    26660071
266610        END-IF                                                    26661071
266620        END-IF                                                    26662071
266630        PERFORM 9900-SOFT-ABORT                                   26663071
266640     END-IF                                                       26664071
266650     END-IF                                                       26665071
266660     END-IF.                                                      26666071
266670                                                                  26667071
266680                                                                  26668071
266690*----------------------------------------------------------------*26669071
266700* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *26670071
266710* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *26671071
266720* FOR THE SELECTED ITEMS QUEUE.                                  *26672071
266730*                                                                *26673071
266740* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *26674071
266750* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *26675071
266760* THE ARRAY IS FULL.                                             *26676071
266770*----------------------------------------------------------------*26677071
266780 5000-PREPARE-SEL-QUEUE.                                          26678071
266790                                                                  26679071
266800     MOVE +1                   TO  ASC-BLK-SUB.                   26680071
266810     PERFORM 5100-WRITE-TEMP-STORAGE.                             26681071
266820     ADD +1                    TO  ASC-BLK-SUB.                   26682071
266830     PERFORM 5100-WRITE-TEMP-STORAGE.                             26683071
266840                                                                  26684071
266850     EVALUATE TRUE                                                26685071
266860         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              26686071
266870         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              26687071
266880              MOVE ASC-SEL-QUEUE-NAME   TO  PC122-SEL-QUEUE-NAME  26688071
266890     END-EVALUATE.                                                26689071
266900                                                                  26690071
266910     PERFORM 6010-DELETE-SEL-QUEUE.                               26691071
266920                                                                  26692071
266930     SET ASC-UPDATE-TSQ        TO  TRUE.                          26693071
266940                                                                  26694071
266950     SET PC121-IDX             TO  1.                             26695071
266960                                                                  26696071
266970     EVALUATE TRUE                                                26697071
266980         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              26698071
266990         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              26699071
267000              MOVE ZERO              TO PC122-NUMBER-OF-TS-ITEMS  26700071
267010     END-EVALUATE.                                                26701071
267020                                                                  26702071
267030     INITIALIZE PC121-SELECTED-ITEM-ARRAY.                        26703071
267040                                                                  26704071
267050     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           26705071
267060             VARYING PV-ITEM                                      26706071
267070             FROM 1 BY 1                                          26707071
267080             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     26708071
267090                                                                  26709071
267100     IF  PC121-IDX > 1                                            26710071
267110         PERFORM 5205-WRITE-SEL-QUEUE                             26711071
267120         EVALUATE TRUE                                            26712071
267130             WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)          26713071
267140             WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)          26714071
267150                  ADD +1             TO PC122-NUMBER-OF-TS-ITEMS  26715071
267160         END-EVALUATE                                             26716071
267170     END-IF.                                                      26717071
267180                                                                  26718071
267190                                                                  26719071
267200*----------------------------------------------------------------*26720071
267210* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *26721071
267220* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *26722071
267230* FOR THE SELECTED ITEMS QUEUE.                                  *26723071
267240*                                                                *26724071
267250* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *26725071
267260* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *26726071
267270* THE ARRAY IS FULL.                                             *26727071
267280*                                                                *26728071
267290* THIS QUEUE IS USED FOR CARTON ASSIGNED LIST                    *26729071
267300*----------------------------------------------------------------*26730071
267310 5001-PREPARE-SEL-QUEUE-CRTN.                                     26731071
267320     MOVE +1                       TO ASC-BLK-SUB.                26732071
267330     PERFORM 5100-WRITE-TEMP-STORAGE.                             26733071
267340     ADD +1                        TO ASC-BLK-SUB.                26734071
267350     PERFORM 5100-WRITE-TEMP-STORAGE.                             26735071
267360                                                                  26736071
267370     MOVE ASC-SEL-QUEUE-NAME       TO SU003-SEL-QUEUE-NAME.       26737071
267380     PERFORM 6010-DELETE-SEL-QUEUE.                               26738071
267390                                                                  26739071
267400     SET ASC-UPDATE-TSQ      TO TRUE.                             26740071
267410     SET SU004-IDX           TO 1.                                26741071
267420     MOVE ZERO               TO SU003-NUMBER-OF-TS-ITEMS.         26742071
267430                                                                  26743071
267440     INITIALIZE SU004-SELECTED-ITEM-ARRAY.                        26744071
267450                                                                  26745071
267460     PERFORM 5201-FILL-SEL-QUEUE-RECORD                           26746071
267470             VARYING PV-ITEM                                      26747071
267480             FROM 1 BY 1                                          26748071
267490             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     26749071
267500                                                                  26750071
267510     IF  SU004-IDX > 1                                            26751071
267520         PERFORM 5209-WRITE-SEL-QUEUE-CRTNASGN                    26752071
267530             ADD +1              TO SU003-NUMBER-OF-TS-ITEMS.     26753071
267540                                                                  26754071
267550                                                                  26755071
267560                                                                  26756071
267570                                                                  26757071
267580*----------------------------------------------------------------*26758071
267590* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *26759071
267600* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *26760071
267610* FOR THE SELECTED ITEMS QUEUE.                                  *26761071
267620*                                                                *26762071
267630* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *26763071
267640* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *26764071
267650* THE ARRAY IS FULL.                                             *26765071
267660*                                                                *26766071
267670* THIS QUEUE IS USED FOR TROUBLE LIST                            *26767071
267680*----------------------------------------------------------------*26768071
267690 5002-PREPARE-SEL-QUEUE-TRBL.                                     26769071
267700     MOVE +1                       TO ASC-BLK-SUB.                26770071
267710     PERFORM 5100-WRITE-TEMP-STORAGE.                             26771071
267720     ADD +1                        TO ASC-BLK-SUB.                26772071
267730     PERFORM 5100-WRITE-TEMP-STORAGE.                             26773071
267740                                                                  26774071
267750     MOVE ASC-SEL-QUEUE-NAME       TO PC000-SEL-QUEUE-NAME.       26775071
267760     PERFORM 6010-DELETE-SEL-QUEUE.                               26776071
267770                                                                  26777071
267780     SET ASC-UPDATE-TSQ      TO TRUE.                             26778071
267790     SET PC016-IDX           TO 1.                                26779071
267800     MOVE ZERO               TO PC000-NUMBER-OF-TS-ITEMS          26780071
267810                                PC000-NUMBER-OF-SELECTED-ITEMS.   26781071
267820     INITIALIZE PC016-SELECTED-ITEM-ARRAY.                        26782071
267830                                                                  26783071
267840     PERFORM 5005-GET-OPER-FROM-TRECEIV.                          26784071
267850                                                                  26785071
267860     PERFORM 5202-FILL-SEL-QUEUE-RECORD                           26786071
267870             VARYING PV-ITEM                                      26787071
267880             FROM 1 BY 1                                          26788071
267890             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     26789071
267900                                                                  26790071
267910     IF  PC016-IDX > 1                                            26791071
267920         PERFORM 5207-WRITE-SEL-QUEUE                             26792071
267930             ADD +1              TO PC000-NUMBER-OF-TS-ITEMS.     26793071
267940                                                                  26794071
267950                                                                  26795071
267960*----------------------------------------------------------------*26796071
267970* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *26797071
267980* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *26798071
267990* FOR THE SELECTED ITEMS QUEUE.                                  *26799071
268000*                                                                *26800071
268010* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *26801071
268020* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *26802071
268030* THE ARRAY IS FULL.                                             *26803071
268040*                                                                *26804071
268050* THIS QUEUE IS USED FOR DISTRO                                  *26805071
268060*----------------------------------------------------------------*26806071
268070 5003-PREPARE-SEL-QUEUE-DISTRO.                                   26807071
268080     MOVE +1                       TO ASC-BLK-SUB.                26808071
268090     PERFORM 5100-WRITE-TEMP-STORAGE.                             26809071
268100     ADD +1                        TO ASC-BLK-SUB.                26810071
268110     PERFORM 5100-WRITE-TEMP-STORAGE.                             26811071
268120                                                                  26812071
268130     MOVE ASC-SEL-QUEUE-NAME       TO RC015-SEL-QUEUE-NAME.       26813071
268140     PERFORM 6010-DELETE-SEL-QUEUE.                               26814071
268150                                                                  26815071
268160     SET ASC-UPDATE-TSQ      TO TRUE.                             26816071
268170     SET RC013-IDX           TO 1.                                26817071
268180     MOVE ZERO               TO RC015-NUMBER-OF-TS-ITEMS          26818071
268190                                RC015-NUMBER-OF-SELECTED-ITEMS.   26819071
268200     INITIALIZE RC013-SELECTED-ITEM-ARRAY.                        26820071
268210                                                                  26821071
268220     PERFORM 5005-GET-OPER-FROM-TRECEIV.                          26822071
268230                                                                  26823071
268240     MOVE ASC-PO-NBR          TO RC015-PO-NBR.                    26824071
268250     MOVE ASC-REC-SEQ-NBR     TO RC015-REC-SEQ-NBR.               26825071
268260     MOVE RECEIV-OPER-UNT-ID  TO RC015-OPER-UNT-ID.               26826071
268270     MOVE 1                   TO RC015-FCLTY-ID.                  26827071
268280                                                                  26828071
268290     PERFORM 5203-FILL-SEL-QUEUE-DISTRO                           26829071
268300             VARYING PV-ITEM                                      26830071
268310             FROM 1 BY 1                                          26831071
268320             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     26832071
268330                                                                  26833071
268340     IF  RC013-IDX > 1                                            26834071
268350         PERFORM 5208-WRITE-SEL-QUEUE                             26835071
268360             ADD +1              TO RC015-NUMBER-OF-TS-ITEMS.     26836071
268370                                                                  26837071
268380                                                                  26838071
268390*----------------------------------------------------------------*26839071
268400* THIS QUEUE IS USED FOR PRE-PACK DETAIL LIST                    *26840071
268410* LOCAL-FUNC-09 (F19-PKDTLST)                                    *26841071
268420*----------------------------------------------------------------*26842071
268430 5004-PREPARE-SEL-QUEUE-PKDTLST.                                  26843071
268440     MOVE +1                       TO ASC-BLK-SUB.                26844071
268450     PERFORM 5100-WRITE-TEMP-STORAGE.                             26845071
268460     ADD +1                        TO ASC-BLK-SUB.                26846071
268470     PERFORM 5100-WRITE-TEMP-STORAGE.                             26847071
268480                                                                  26848071
268490     MOVE ASC-SEL-QUEUE-NAME       TO RC800-SEL-QUEUE-NAME.       26849071
268500     PERFORM 6010-DELETE-SEL-QUEUE.                               26850071
268510                                                                  26851071
268520     SET ASC-UPDATE-TSQ      TO TRUE.                             26852071
268530     SET RC801-IDX           TO 1.                                26853071
268540     MOVE ZERO               TO RC800-NUMBER-OF-TS-ITEMS          26854071
268550                                RC800-NUMBER-OF-SELECTED-ITEMS.   26855071
268560     INITIALIZE RC801-SELECTED-ITEM-ARRAY.                        26856071
268570                                                                  26857071
268580     PERFORM 5204-FILL-SEL-QUEUE-PKDTLST                          26858071
268590             VARYING PV-ITEM                                      26859071
268600             FROM 1 BY 1                                          26860071
268610             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     26861071
268620                                                                  26862071
268630     IF  RC801-IDX > 1                                            26863071
268640         PERFORM 5206-WRITE-SEL-QUEUE                             26864071
268650             ADD +1              TO RC800-NUMBER-OF-TS-ITEMS.     26865071
268660                                                                  26866071
268670                                                                  26867071
268680*----------------------------------------------------------------*26868071
268690*  GET OPER-UNT-ID FROM TRECEIVE - FOR TROUBLE & DISTRO          *26869071
268700*----------------------------------------------------------------*26870071
268710 5005-GET-OPER-FROM-TRECEIV.                                      26871071
268720                                                                  26872071
268730     EXEC SQL                                                     26873071
268740         SELECT OPER_UNT_ID                                       26874071
268750                , DATE(REC_TMST)                                  26875071
268760           INTO :RECEIV-OPER-UNT-ID                               26876071
268770               , :ASC-TRIP-ARRIVE-DATE                            26877071
268780           FROM TRECEIV                                           26878071
268790          WHERE ORD_NBR      =  :ASC-PO-NBR                       26879071
268800            AND REC_SEQ_NBR  =  :ASC-REC-SEQ-NBR                  26880071
268810     END-EXEC                                                     26881071
268820                                                                  26882071
268830     EVALUATE TRUE                                                26883071
268840         WHEN SQLCODE = +0                                        26884071
268850              CONTINUE                                            26885071
268860         WHEN SQLCODE = -904                                      26886071
268870         WHEN SQLCODE = -911                                      26887071
268880         WHEN SQLCODE = -913                                      26888071
268890                                                                  26889071
268900             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   26890071
268910             MOVE '5005-GET-OPER-FROM-TRECEIV'                    26891071
268920                                             TO PV-SOFT-PARAGRAPH 26892071
268930             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 26893071
268940             MOVE LENGTH OF PV-CICS-MSG-AREA2                     26894071
268950               TO PV-COMMAREA-LENGTH                              26895071
268960             EXEC CICS                                            26896071
268970                  WRITEQ TD                                       26897071
268980                   QUEUE  ('CSSL')                                26898071
268990                    FROM  (PV-CICS-MSG-AREA2)                     26899071
269000                  LENGTH  (PV-COMMAREA-LENGTH)                    26900071
269010                    RESP  (PV-CICS-RESP)                          26901071
269020             END-EXEC                                             26902071
269030                                                                  26903071
269040             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          26904071
269050             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              26905071
269060             PERFORM 9900-SOFT-ABORT                              26906071
269070         WHEN OTHER                                               26907071
269080              MOVE '5005-GET-OPER-FROM-TRECEIV'                   26908071
269090                               TO DP013-PARAGRAPH                 26909071
269100              MOVE 'GET OPER-UNT-ID FROM TRECEIVE FOR TROUBLE'    26910071
269110                               TO DP013-MESSAGE-TEXT (1)          26911071
269120              MOVE SQLCA       TO DP013-SQLCA                     26912071
269130              MOVE 'TRECEIV '  TO DP013-DB2-TABLE-NAME (1)        26913071
269140              SET DP013-DB2-ABEND                                 26914071
269150                  DP013-XCTL-DISPLAY-RESTART                      26915071
269160                                   TO TRUE                        26916071
269170                  PERFORM DP013-0000-PROCESS-ABEND                26917071
269180     END-EVALUATE.                                                26918071
269190                                                                  26919071
269200                                                                  26920071
269210*----------------------------------------------------------------*26921071
269220*  GET OPER-UNT-ID FROM TRECEIVE - FOR TROUBLE & DISTRO          *26922071
269230*----------------------------------------------------------------*26923071
269240 5007-GET-PURITM-RECITM.                                          26924071
269250                                                                  26925071
269260     MOVE  RECEIV-OPER-UNT-ID          TO  DK-OPER-UNT-ID.        26926071
269270     MOVE  1                           TO  DK-FCLTY-ID.           26927071
269280     MOVE  LQW-PO-RCVR-LINE (LQW-IDX)  TO  DK-LINE-NBR.           26928071
269290                                                                  26929071
269300     EXEC SQL                                                     26930071
269310           SELECT A.VER_NBR                                       26931071
269320                , A.ITM_NBR                                       26932071
269330                , A.SKU_DESC                                      26933071
269340                , A.VEND_STYL_NAME                                26934071
269350                , A.UNT_QTY                                       26935071
269360                , A.UNT_RTL_PR_AMT                                26936071
269370                , A.GP_RTL_AMT                                    26937071
269380                , A.GP_QTY                                        26938071
269390                , B.DTL_CK_ITM_QTY                                26939071
269400                , B.PKSL_ITM_QTY                                  26940071
269410                , B.PREPK_ID                                      26941071
269420           INTO   :PURITM-VER-NBR                                 26942071
269430                , :PURITM-ITM-NBR                                 26943071
269440                , :PURITM-SKU-DESC                                26944071
269450                , :PURITM-VEND-STYL-NAME                          26945071
269460                , :PURITM-UNT-QTY                                 26946071
269470                , :PURITM-UNT-RTL-PR-AMT                          26947071
269480                , :PURITM-GP-RTL-AMT                              26948071
269490                , :PURITM-GP-QTY                                  26949071
269500                , :RECITM-DTL-CK-ITM-QTY                          26950071
269510                , :RECITM-PKSL-ITM-QTY                            26951071
269520                , :RECITM-PREPK-ID                                26952071
269530           FROM   TPURITM A                                       26953071
269540                , TRECITM B                                       26954071
269550                , TRECEIV C                                       26955071
269560           WHERE  A.PO_NBR         = :ASC-PO-NBR                  26956071
269570             AND  A.PO_NBR         = B.ORD_NBR                    26957071
269580             AND  A.PO_NBR         = C.ORD_NBR                    26958071
269590             AND  A.APP_PO_LNE_NBR = :DK-LINE-NBR                 26959071
269600             AND  A.APP_PO_LNE_NBR = B.ORD_LNE_NBR                26960071
269610             AND  B.REC_SEQ_NBR    = :ASC-REC-SEQ-NBR             26961071
269620             AND  B.REC_SEQ_NBR    = C.REC_SEQ_NBR                26962071
269630             AND  A.VER_STATUS_CDE = 'A'                          26963071
269640             AND  B.VER_STATUS_CDE = 'A'                          26964071
269650             AND  C.VER_STATUS_CDE = 'A'                          26965071
269660             AND  B.OPER_UNT_ID    = :DK-OPER-UNT-ID              26966071
269670             AND  B.FCLTY_ID       = :DK-FCLTY-ID                 26967071
269680     END-EXEC                                                     26968071
269690                                                                  26969071
269700     EVALUATE TRUE                                                26970071
269710         WHEN SQLCODE = +0                                        26971071
269720              CONTINUE                                            26972071
269730                                                                  26973071
269740         WHEN SQLCODE = -904                                      26974071
269750         WHEN SQLCODE = -911                                      26975071
269760         WHEN SQLCODE = -913                                      26976071
269770                                                                  26977071
269780             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   26978071
269790             MOVE '5007-GET-PURITM-RECITM'   TO PV-SOFT-PARAGRAPH 26979071
269800             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 26980071
269810             MOVE LENGTH OF PV-CICS-MSG-AREA2                     26981071
269820               TO PV-COMMAREA-LENGTH                              26982071
269830             EXEC CICS                                            26983071
269840                  WRITEQ TD                                       26984071
269850                   QUEUE  ('CSSL')                                26985071
269860                    FROM  (PV-CICS-MSG-AREA2)                     26986071
269870                  LENGTH  (PV-COMMAREA-LENGTH)                    26987071
269880                    RESP  (PV-CICS-RESP)                          26988071
269890             END-EXEC                                             26989071
269900                                                                  26990071
269910             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          26991071
269920             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              26992071
269930             PERFORM 9900-SOFT-ABORT                              26993071
269940                                                                  26994071
269950         WHEN OTHER                                               26995071
269960              MOVE '5007-GET-PURITM-RECITM'                       26996071
269970                               TO DP013-PARAGRAPH                 26997071
269980              MOVE 'GET PURITM & RECITM INFO FOR DISTRO QUEUE'    26998071
269990                               TO DP013-MESSAGE-TEXT (1)          26999071
270000              MOVE SQLCA       TO DP013-SQLCA                     27000071
270010              MOVE 'TRECEIV '  TO DP013-DB2-TABLE-NAME (1)        27001071
270020              SET DP013-DB2-ABEND                                 27002071
270030                  DP013-XCTL-DISPLAY-RESTART                      27003071
270040                                   TO TRUE                        27004071
270050                  PERFORM DP013-0000-PROCESS-ABEND                27005071
270060     END-EVALUATE.                                                27006071
270070                                                                  27007071
270080                                                                  27008071
270090*----------------------------------------------------------------*27009071
270100*  GET SHIPMENT INFORMATION FOR DISTRO                           *27010071
270110*----------------------------------------------------------------*27011071
270120 5008-GET-SHIPMT-INFO.                                            27012071
270130                                                                  27013071
270140     MOVE  ASC-PO-NBR       TO  DK-PO-NBR.                        27014071
270150     MOVE  ASC-REC-SEQ-NBR  TO  DK-REC-SEQ-NBR.                   27015071
270160                                                                  27016071
270170     EXEC SQL                                                     27017071
270180          SELECT A.TRIP_ID                                        27018071
270190                ,A.SHIPT_ID                                       27019071
270200                ,A.PRO_SCAC_ID                                    27020071
270210                ,A.PRO_NBR                                        27021071
270220                ,A.BOL_NBR                                        27022071
270230                ,A.VEND_SHIP_DTE                                  27023071
270240                ,A.ORIG_SCAC_ID                                   27024071
270250                ,A.VEH_NBR                                        27025071
270260          INTO   :SHIPMT-TRIP-ID                                  27026071
270270                ,:SHIPMT-SHIPT-ID                                 27027071
270280                ,:SHIPMT-PRO-SCAC-ID                              27028071
270290                ,:SHIPMT-PRO-NBR                                  27029071
270300                ,:SHIPMT-BOL-NBR                                  27030071
270310                ,:SHIPMT-VEND-SHIP-DTE                            27031071
270320                ,:SHIPMT-ORIG-SCAC-ID                             27032071
270330                ,:SHIPMT-VEH-NBR                                  27033071
270340            FROM TSHIPMT A,                                       27034071
270350                 TSHPTPO B                                        27035071
270360           WHERE B.PO_NBR      = :DK-PO-NBR                       27036071
270370             AND B.REC_SEQ_NBR = :DK-REC-SEQ-NBR                  27037071
270380             AND A.SHIPT_ID    =  B.SHIPT_ID                      27038071
270390             AND A.PRO_NBR    <> :PC-SPACES                       27039071
270400     END-EXEC.                                                    27040071
270410                                                                  27041071
270420     EVALUATE TRUE                                                27042071
270430         WHEN SQLCODE = +0                                        27043071
270440              CONTINUE                                            27044071
270450                                                                  27045071
270460         WHEN SQLCODE = -904                                      27046071
270470         WHEN SQLCODE = -911                                      27047071
270480         WHEN SQLCODE = -913                                      27048071
270490                                                                  27049071
270500             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   27050071
270510             MOVE '5008-GET-SHIPMT-INFO'     TO PV-SOFT-PARAGRAPH 27051071
270520             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 27052071
270530             MOVE LENGTH OF PV-CICS-MSG-AREA2                     27053071
270540               TO PV-COMMAREA-LENGTH                              27054071
270550             EXEC CICS                                            27055071
270560                  WRITEQ TD                                       27056071
270570                   QUEUE  ('CSSL')                                27057071
270580                    FROM  (PV-CICS-MSG-AREA2)                     27058071
270590                  LENGTH  (PV-COMMAREA-LENGTH)                    27059071
270600                    RESP  (PV-CICS-RESP)                          27060071
270610             END-EXEC                                             27061071
270620                                                                  27062071
270630             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          27063071
270640             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              27064071
270650             PERFORM 9900-SOFT-ABORT                              27065071
270660                                                                  27066071
270670         WHEN OTHER                                               27067071
270680              MOVE '5008-GET-SHIPMT-INFO'                         27068071
270690                               TO DP013-PARAGRAPH                 27069071
270700              MOVE 'GET PURITM & RECITM INFO FOR DISTRO QUEUE'    27070071
270710                               TO DP013-MESSAGE-TEXT (1)          27071071
270720              MOVE SQLCA       TO DP013-SQLCA                     27072071
270730              MOVE 'TRECEIV '  TO DP013-DB2-TABLE-NAME (1)        27073071
270740              SET DP013-DB2-ABEND                                 27074071
270750                  DP013-XCTL-DISPLAY-RESTART                      27075071
270760                                   TO TRUE                        27076071
270770                  PERFORM DP013-0000-PROCESS-ABEND                27077071
270780     END-EVALUATE.                                                27078071
270790                                                                  27079071
270800                                                                  27080071
270810*----------------------------------------------------------------*27081071
270820*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *27082071
270830*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *27083071
270840*----------------------------------------------------------------*27084071
270850 5100-WRITE-TEMP-STORAGE.                                         27085071
270860     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     27086071
270870                                   TO PV-LIST-ITEM-NUMBER.        27087071
270880     COMPUTE PV-BLOCK-NUMBER =                                    27088071
270890         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    27089071
270900                                                                  27090071
270910     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             27091071
270920     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             27092071
270930         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      27093071
270940             PERFORM 5105-REWRITE-ASC-LISTQ                       27094071
270950         END-IF                                                   27095071
270960     ELSE                                                         27096071
270970         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       27097071
270980         ASC-HIGHEST-BLOCK-WRITTEN + 1                            27098071
270990         PERFORM 5110-WRITE-ASC-LISTQ                             27099071
271000         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   27100071
271010     END-IF.                                                      27101071
271020                                                                  27102071
271030     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             27103071
271040                                                                  27104071
271050                                                                  27105071
271060*----------------------------------------------------------------*27106071
271070*  REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-     *27107071
271080*  SPECIFIC COMMAREA.                                            *27108071
271090*----------------------------------------------------------------*27109071
271100 5105-REWRITE-ASC-LISTQ.                                          27110071
271110     EXEC CICS                                                    27111071
271120         WRITEQ TS                                                27112071
271130             QUEUE (ASC-LIST-QUEUE-NAME)                          27113071
271140             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               27114071
271150             ITEM  (PV-BLOCK-NUMBER)                              27115071
271160             REWRITE                                              27116071
271170             RESP  (PV-CICS-RESP)                                 27117071
271180     END-EXEC.                                                    27118071
271190                                                                  27119071
271200     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           27120071
271210         CONTINUE                                                 27121071
271220     ELSE                                                         27122071
271230         SET DP013-CICS-ABEND            TO TRUE                  27123071
271240         SET DP013-NO-ROLLBACK           TO TRUE                  27124071
271250         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       27125071
271260         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     27126071
271270                                         TO DP013-MESSAGE-TEXT(1) 27127071
271280         PERFORM DP013-0000-PROCESS-ABEND                         27128071
271290     END-IF.                                                      27129071
271300                                                                  27130071
271310                                                                  27131071
271320*----------------------------------------------------------------*27132071
271330*  REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-     *27133071
271340*  SPECIFIC COMMAREA.                                            *27134071
271350*                                                                *27135071
271360* THIS QUEUE IS USED FOR TROUBLE LIST                            *27136071
271370*----------------------------------------------------------------*27137071
271380 5107-REWRITE-ASC-LISTQ.                                          27138071
271390                                                                  27139071
271400     EXEC CICS                                                    27140071
271410         WRITEQ TS                                                27141071
271420             QUEUE (ASC-LIST-QUEUE-NAME)                          27142071
271430             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               27143071
271440             ITEM  (PV-BLOCK-NUMBER)                              27144071
271450             REWRITE                                              27145071
271460             RESP  (PV-CICS-RESP)                                 27146071
271470     END-EXEC.                                                    27147071
271480                                                                  27148071
271490     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           27149071
271500         CONTINUE                                                 27150071
271510     ELSE                                                         27151071
271520         SET DP013-CICS-ABEND      TO TRUE                        27152071
271530         SET DP013-NO-ROLLBACK     TO TRUE                        27153071
271540         MOVE '5107-REWRITE-ASC-LISTQ'                            27154071
271550                                   TO DP013-PARAGRAPH             27155071
271560         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     27156071
271570                                   TO DP013-MESSAGE-TEXT(1)       27157071
271580         PERFORM DP013-0000-PROCESS-ABEND                         27158071
271590     END-IF.                                                      27159071
271600                                                                  27160071
271610                                                                  27161071
271620*----------------------------------------------------------------*27162071
271630*  WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-       *27163071
271640*  SPECIFIC COMMAREA.                                            *27164071
271650*----------------------------------------------------------------*27165071
271660 5110-WRITE-ASC-LISTQ.                                            27166071
271670     EXEC CICS                                                    27167071
271680         WRITEQ TS                                                27168071
271690             QUEUE (ASC-LIST-QUEUE-NAME)                          27169071
271700             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               27170071
271710             ITEM  (PV-BLOCK-NUMBER)                              27171071
271720             RESP  (PV-CICS-RESP)                                 27172071
271730     END-EXEC.                                                    27173071
271740     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      27174071
271750         SET DP013-CICS-ABEND      TO TRUE                        27175071
271760         SET DP013-NO-ROLLBACK     TO TRUE                        27176071
271770         MOVE '5110-WRITE-ASC-LISTQ'                              27177071
271780                                   TO DP013-PARAGRAPH             27178071
271790         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           27179071
271800                                   TO DP013-MESSAGE-TEXT(1)       27180071
271810         PERFORM DP013-0000-PROCESS-ABEND                         27181071
271820     END-IF.                                                      27182071
271830                                                                  27183071
271840*----------------------------------------------------------------*27184071
271850*  WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-       *27185071
271860*  SPECIFIC COMMAREA.                                            *27186071
271870*                                                                *27187071
271880* THIS QUEUE IS USED FOR TROUBLE LIST                            *27188071
271890*----------------------------------------------------------------*27189071
271900 5112-WRITE-ASC-LISTQ.                                            27190071
271910                                                                  27191071
271920     EXEC CICS                                                    27192071
271930         WRITEQ TS                                                27193071
271940             QUEUE (ASC-LIST-QUEUE-NAME)                          27194071
271950             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               27195071
271960             ITEM  (PV-BLOCK-NUMBER)                              27196071
271970             RESP  (PV-CICS-RESP)                                 27197071
271980     END-EXEC.                                                    27198071
271990                                                                  27199071
272000     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      27200071
272010         SET DP013-CICS-ABEND      TO TRUE                        27201071
272020         SET DP013-NO-ROLLBACK     TO TRUE                        27202071
272030         MOVE '5112-WRITE-ASC-LISTQ'                              27203071
272040                                   TO DP013-PARAGRAPH             27204071
272050         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           27205071
272060                                   TO DP013-MESSAGE-TEXT(1)       27206071
272070         PERFORM DP013-0000-PROCESS-ABEND                         27207071
272080     END-IF.                                                      27208071
272090                                                                  27209071
272100                                                                  27210071
272110*----------------------------------------------------------------*27211071
272120* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *27212071
272130* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *27213071
272140*----------------------------------------------------------------*27214071
272150 5200-FILL-SEL-QUEUE-RECORD.                                      27215071
272160                                                                  27216071
272170     PERFORM 6112-READ-LIST-QUEUE.                                27217071
272180                                                                  27218071
272190     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       27219071
272200         PERFORM                                                  27220071
272210         VARYING LQW-IDX                                          27221071
272220         FROM 1 BY 1                                              27222071
272230         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            27223071
272240           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          27224071
272250                                                                  27225071
272260             IF  LQW-SELECT (LQW-IDX)                             27226071
272270                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              27227071
272280                               TO PC121-ITEM (PC121-IDX)          27228071
272290                 MOVE LQW-PO-RCVR-LINE (LQW-IDX)                  27229071
272300                               TO PC121-PO-LNE-NBR(PC121-IDX)     27230071
272310                 MOVE LQW-SKU (LQW-IDX)  TO  PC121-SKU-NBR        27231071
272320                                                    (PC121-IDX)   27232071
272330                 MOVE LQW-SUBCLASS (LQW-IDX)                      27233071
272340                               TO PC121-CL-NBR (PC121-IDX)        27234071
272350                 MOVE LQW-SKU (LQW-IDX)                           27235071
272360                               TO PC121-SKU-NBR(PC121-IDX)        27236071
272370                 MOVE LQW-MODULE (LQW-IDX)                        27237071
272380                               TO PC121-MODU-NBR (PC121-IDX)      27238071
272390                 EVALUATE TRUE                                    27239071
272400                     WHEN LQW-SHUFFLED-SML(LQW-IDX)               27240071
272410                          MOVE 'S'   TO PC121-LBL-TYP (PC121-IDX) 27241071
272420                     WHEN LQW-STORE-SML(LQW-IDX)                  27242071
272430                          MOVE 'S'   TO PC121-LBL-TYP (PC121-IDX) 27243071
272440                     WHEN LQW-STORE-PGYBK(LQW-IDX)                27244071
272450                          MOVE 'P'   TO PC121-LBL-TYP (PC121-IDX) 27245071
272460                     WHEN LQW-LBL-TYP-VALID(LQW-IDX)              27246071
272470                          MOVE LQW-LABEL-TYPE(LQW-IDX)            27247071
272480                                     TO PC121-LBL-TYP (PC121-IDX) 27248071
272490                 END-EVALUATE                                     27249071
272500                 MOVE LQW-LABEL-TYPE (LQW-IDX)                    27250071
272510                               TO PC121-LBL-TYP (PC121-IDX)       27251071
272520                 MOVE LQW-INNER-PACK (LQW-IDX)                    27252071
272530                               TO PC121-INPK-UNT-QTY (PC121-IDX)  27253071
272540                 MOVE LQW-OUTER-PACK (LQW-IDX)                    27254071
272550                               TO PC121-OTPK-UNT-QTY (PC121-IDX)  27255071
272560                 MOVE LQW-IN-PACK-CONVY (LQW-IDX)                 27256071
272570                               TO PC121-INPK-CNVYB-IND (PC121-IDX)27257071
272580                 MOVE LQW-TRANSCRIB-QTY (LQW-IDX)                 27258071
272590                               TO PC121-PKSLIP-UNT-QTY (PC121-IDX)27259071
272600                 MOVE LQW-P2L-LBL-CNT (LQW-IDX)                   27260071
272610                               TO PC121-P2L-CTN (PC121-IDX)       27261071
272620                 MOVE LQW-SHP-LBL-CNT (LQW-IDX)                   27262071
272630                               TO PC121-SHIP-CTN (PC121-IDX)      27263071
272640                 MOVE LQW-LNE-CRE-LBL-OPT (LQW-IDX)               27264071
272650                               TO PC121-CRE-LBL-IND (PC121-IDX)   27265071
272660                 IF  LQW-LNE-CRE-P2L-LBL (LQW-IDX)                27266071
272670                     MOVE ASC-PRT-HEAD-FOOT                       27267071
272680                               TO PC121-P2L-PRT-HDR-SW (PC121-IDX)27268071
272690                 ELSE                                             27269071
272700                     SET  PC121-PRINT-P2L-HDRS (PC121-IDX) TO TRUE27270071
272710                 END-IF                                           27271071
272720                                                                  27272071
272730                 MOVE SPACE     TO PC121-ACTION-SW (PC121-IDX)    27273071
272740                                                                  27274071
272750                 MOVE  LQW-ODD-CARTON (LQW-IDX)                   27275071
272760                                TO PC121-ODD-CARTON (PC121-IDX)   27276071
272770                 MOVE  LQW-ODD-CRTN-USE-SW (LQW-IDX)              27277071
272780                                TO PC121-ODD-CRTN-USE-SW          27278071
272790                                   (PC121-IDX)                    27279071
272800                                                                  27280071
272810                 MOVE  LQW-PREPK-ID (LQW-IDX)                     27281071
272820                                TO PC121-PREPK-ID (PC121-IDX)     27282071
272830                 MOVE  LQW-PREPK-RATIO (LQW-IDX)                  27283071
272840                                TO PC121-PREPK-RATIO (PC121-IDX)  27284071
272850                 MOVE  LQW-PACKS-IN-CRTN (LQW-IDX)                27285071
272860                                TO PC121-PACKS-IN-CRTN(PC121-IDX) 27286071
272870                 MOVE  LQW-LNE-UCC128-DATA-IND (LQW-IDX)          27287071
272880                                TO PC121-UCC128-USAGE(PC121-IDX)  27288071
272890                 MOVE  LQW-ITM-NBR (LQW-IDX)                      27289071
272900                                TO PC121-ITEM-NBR (PC121-IDX)     27290071
272910                                                                  27291071
272920                 SET PC121-IDX UP BY 1                            27292071
272930                 IF  PC121-IDX > PC121-MAX-ITEMS                  27293071
272940                     PERFORM 5205-WRITE-SEL-QUEUE                 27294071
272950                                                                  27295071
272960                         EVALUATE TRUE                            27296071
272970                           WHEN DP020-FK-LOCAL-FUNC-02            27297071
272980                                       (DP020-SRC-AID)            27298071
272990                           WHEN DP020-FK-LOCAL-FUNC-04            27299071
273000                                       (DP020-SRC-AID)            27300071
273010                               ADD +1 TO PC122-NUMBER-OF-TS-ITEMS 27301071
273020                           WHEN DP020-FK-LOCAL-FUNC-03            27302071
273030                                       (DP020-SRC-AID)            27303071
273040                               ADD +1 TO RC012-NUMBER-OF-TS-ITEMS 27304071
273050                           END-EVALUATE                           27305071
273060                                                                  27306071
273070                     INITIALIZE PC121-SELECTED-ITEM-ARRAY         27307071
273080                     SET PC121-IDX TO  1                          27308071
273090                 END-IF                                           27309071
273100             END-IF                                               27310071
273110         END-PERFORM                                              27311071
273120     END-IF.                                                      27312071
273130                                                                  27313071
273140                                                                  27314071
273150*----------------------------------------------------------------*27315071
273160* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *27316071
273170* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *27317071
273180* CARTON ASSIGN LIST - QUEUE                                     *27318071
273190*----------------------------------------------------------------*27319071
273200 5201-FILL-SEL-QUEUE-RECORD.                                      27320071
273210                                                                  27321071
273220     PERFORM 6112-READ-LIST-QUEUE.                                27322071
273230                                                                  27323071
273240     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       27324071
273250         PERFORM                                                  27325071
273260         VARYING LQW-IDX                                          27326071
273270         FROM 1 BY 1                                              27327071
273280         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            27328071
273290           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          27329071
273300                                                                  27330071
273310             IF  LQW-SELECT (LQW-IDX)                             27331071
273320                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              27332071
273330                                  TO SU004-ITEM        (SU004-IDX)27333071
273340                 MOVE ASC-OPER-UNT-ID                             27334071
273350                                  TO SU004-OPER-UNT-ID (SU004-IDX)27335071
273360                 MOVE ASC-FCLTY-ID                                27336071
273370                                  TO SU004-FCLTY-ID    (SU004-IDX)27337071
273380                 MOVE ASC-PO-NBR                                  27338071
273390                                  TO SU004-PO-NBR      (SU004-IDX)27339071
273400                 MOVE ASC-REC-SEQ-NBR                             27340071
273410                                  TO SU004-REC-SEQ-NBR (SU004-IDX)27341071
273420                 MOVE LQW-PO-RCVR-LINE (LQW-IDX)                  27342071
273430                                  TO SU004-LINE-NO     (SU004-IDX)27343071
273440                                                                  27344071
273450                 MOVE SPACES      TO SU004-ACTION-SW   (SU004-IDX)27345071
273460                                     SU004-SCAC-CDE    (SU004-IDX)27346071
273470                                     SU004-VEH-NBR     (SU004-IDX)27347071
273480                                     SU004-CSR-IND     (SU004-IDX)27348071
273490                                                                  27349071
273500                 MOVE ZEROES      TO SU004-TRIP-ID     (SU004-IDX)27350071
273510                                     SU004-SHIPT-UNT-ID(SU004-IDX)27351071
273520                                                                  27352071
273530                 SET SU004-IDX UP BY 1                            27353071
273540                 IF  SU004-IDX > SU004-MAX-ITEMS                  27354071
273550                     PERFORM 5209-WRITE-SEL-QUEUE-CRTNASGN        27355071
273560                     ADD  +1  TO  SU003-NUMBER-OF-TS-ITEMS        27356071
273570                     INITIALIZE SU004-SELECTED-ITEM-ARRAY         27357071
273580                     SET SU004-IDX TO  1                          27358071
273590                 END-IF                                           27359071
273600             END-IF                                               27360071
273610         END-PERFORM                                              27361071
273620     END-IF.                                                      27362071
273630                                                                  27363071
273640                                                                  27364071
273650*----------------------------------------------------------------*27365071
273660* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *27366071
273670* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *27367071
273680*                                                                *27368071
273690* THIS QUEUE IS USED FOR TROUBLE LIST                            *27369071
273700*----------------------------------------------------------------*27370071
273710 5202-FILL-SEL-QUEUE-RECORD.                                      27371071
273720     PERFORM 6112-READ-LIST-QUEUE.                                27372071
273730                                                                  27373071
273740     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       27374071
273750         PERFORM                                                  27375071
273760         VARYING LQW-IDX                                          27376071
273770         FROM 1 BY 1                                              27377071
273780         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            27378071
273790           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          27379071
273800                                                                  27380071
273810             IF  (LQW-SELECT (LQW-IDX))                           27381071
273820                 PERFORM 5007-GET-PURITM-RECITM                   27382071
273830                 ADD +1 TO PC000-NUMBER-OF-SELECTED-ITEMS         27383071
273840                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              27384071
273850                                   TO PC016-ITEM (PC016-IDX)      27385071
273860                 MOVE SPACE        TO PC016-ACTION-SW (PC016-IDX) 27386071
273870                 MOVE RECEIV-OPER-UNT-ID                          27387071
273880                                   TO PC016-OPER-UNT-ID(PC016-IDX)27388071
273890                 MOVE ASC-FCLTY-ID                                27389071
273900                                   TO PC016-FCLTY-ID (PC016-IDX)  27390071
273910                 MOVE ASC-PO-NBR   TO PC016-PO-NBR-N  (PC016-IDX) 27391071
273920                 MOVE ASC-REC-SEQ-NBR                             27392071
273930                                    TO PC016-REC-SEQ-NBR-N        27393071
273940                                                       (PC016-IDX)27394071
273950                 MOVE LQW-PO-RCVR-LINE (LQW-IDX)                  27395071
273960                                    TO PC016-LINE-NBR(PC016-IDX)  27396071
273970                 MOVE ASC-DPT-NBR                                 27397071
273980                                    TO PC016-DEPT(PC016-IDX)      27398071
273990                 MOVE LQW-SUBCLASS (LQW-IDX)                      27399071
274000                                    TO PC016-CL(PC016-IDX)        27400071
274010                 MOVE PURITM-SKU-DESC                             27401071
274020                                    TO PC016-SKU-DESC(PC016-IDX)  27402071
274030                 MOVE LQW-ITM-NBR (LQW-IDX)                       27403071
274040                                    TO PC016-ITM-NBR(PC016-IDX)   27404071
274050                 MOVE PURITM-VER-NBR                              27405071
274060                                    TO PC016-VER-NBR(PC016-IDX)   27406071
274070                 MOVE RECITM-DTL-CK-ITM-QTY                       27407071
274080                                    TO PC016-DTL-CK-ITM-QTY       27408071
274090                                                       (PC016-IDX)27409071
274100                 MOVE RECITM-PKSL-ITM-QTY                         27410071
274110                                    TO PC016-PKSL-ITM-QTY         27411071
274120                                                       (PC016-IDX)27412071
274130                 MOVE PURITM-VEND-STYL-NAME                       27413071
274140                                    TO PC016-VEND-STYL-NAME       27414071
274150                                                       (PC016-IDX)27415071
274160                 MOVE PURITM-UNT-QTY                              27416071
274170                                    TO PC016-UNT-QTY   (PC016-IDX)27417071
274180                 MOVE PURITM-UNT-RTL-PR-AMT                       27418071
274190                                    TO PC016-UNT-RTL-PR-AMT       27419071
274200                                                       (PC016-IDX)27420071
274210                 MOVE PURITM-GP-RTL-AMT                           27421071
274220                                    TO PC016-GP-RTL-AMT(PC016-IDX)27422071
274230                 MOVE PURITM-GP-QTY                               27423071
274240                                    TO PC016-GP-QTY    (PC016-IDX)27424071
274250                 MOVE PC-Y          TO PC016-MRKG-APRON-REQ-IND   27425071
274260                                                       (PC016-IDX)27426071
274270                                                                  27427071
274280                 SET PC016-IDX UP BY 1                            27428071
274290                 IF  PC016-IDX > PC016-MAX-ITEMS                  27429071
274300                     PERFORM 5207-WRITE-SEL-QUEUE                 27430071
274310                     ADD +1        TO PC000-NUMBER-OF-TS-ITEMS    27431071
274320                     INITIALIZE PC016-SELECTED-ITEM-ARRAY         27432071
274330                     SET PC016-IDX TO 1                           27433071
274340                 END-IF                                           27434071
274350             END-IF                                               27435071
274360         END-PERFORM                                              27436071
274370     END-IF.                                                      27437071
274380                                                                  27438071
274390     MOVE PV-ITEM TO PV-SAVE-ITEM.                                27439071
274400     PERFORM 6111-WRITE-LIST-QUEUE.                               27440071
274410                                                                  27441071
274420                                                                  27442071
274430*----------------------------------------------------------------*27443071
274440* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *27444071
274450* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *27445071
274460*                                                                *27446071
274470* THIS QUEUE IS USED FOR DISTRIBUITON LIST                       *27447071
274480*----------------------------------------------------------------*27448071
274490 5203-FILL-SEL-QUEUE-DISTRO.                                      27449071
274500     PERFORM 6112-READ-LIST-QUEUE.                                27450071
274510                                                                  27451071
274520     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       27452071
274530         PERFORM                                                  27453071
274540         VARYING LQW-IDX                                          27454071
274550         FROM 1 BY 1                                              27455071
274560         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            27456071
274570           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          27457071
274580                                                                  27458071
274590             IF  (LQW-SELECT (LQW-IDX))                           27459071
274600                 ADD +1 TO RC015-NUMBER-OF-SELECTED-ITEMS         27460071
274610                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              27461071
274620                                   TO RC013-ITEM (RC013-IDX)      27462071
274630                 MOVE SPACE        TO RC013-ACTION-SW (RC013-IDX) 27463071
274640                 MOVE RECEIV-OPER-UNT-ID                          27464071
274650                                   TO RC013-OPER-UNT-ID(RC013-IDX)27465071
274660                 MOVE ASC-FCLTY-ID                                27466071
274670                                   TO RC013-FCLTY-ID (RC013-IDX)  27467071
274680                 MOVE ASC-PO-NBR   TO RC013-PO-NBR  (RC013-IDX)   27468071
274690                 MOVE ASC-REC-SEQ-NBR                             27469071
274700                                   TO RC013-REC-SEQ-NBR           27470071
274710                                                       (RC013-IDX)27471071
274720                 MOVE LQW-PO-RCVR-LINE (LQW-IDX)                  27472071
274730                                    TO RC013-PKSL-LNE-NBR         27473071
274740                                                       (RC013-IDX)27474071
274750                 SET RC013-IDX UP BY 1                            27475071
274760                 IF  RC013-IDX > RC013-MAX-ITEMS                  27476071
274770                     PERFORM 5208-WRITE-SEL-QUEUE                 27477071
274780                     ADD +1        TO RC015-NUMBER-OF-TS-ITEMS    27478071
274790                     INITIALIZE RC013-SELECTED-ITEM-ARRAY         27479071
274800                     SET RC013-IDX TO 1                           27480071
274810                 END-IF                                           27481071
274820             END-IF                                               27482071
274830         END-PERFORM                                              27483071
274840     END-IF.                                                      27484071
274850                                                                  27485071
274860     MOVE PV-ITEM TO PV-SAVE-ITEM.                                27486071
274870     PERFORM 6111-WRITE-LIST-QUEUE.                               27487071
274880                                                                  27488071
274890                                                                  27489071
274900*----------------------------------------------------------------*27490071
274910* THIS QUEUE IS USED FOR PRE-PACK DETAIL LIST                    *27491071
274920* LOCAL-FUNC-09 (F19 - PKDTLST)                                  *27492071
274930*----------------------------------------------------------------*27493071
274940 5204-FILL-SEL-QUEUE-PKDTLST.                                     27494071
274950     PERFORM 6112-READ-LIST-QUEUE.                                27495071
274960                                                                  27496071
274970     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       27497071
274980         PERFORM                                                  27498071
274990         VARYING LQW-IDX                                          27499071
275000         FROM 1 BY 1                                              27500071
275010         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            27501071
275020           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          27502071
275030                                                                  27503071
275040             IF  (LQW-SELECT (LQW-IDX))                           27504071
275050                 ADD +1 TO RC800-NUMBER-OF-SELECTED-ITEMS         27505071
275060                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              27506071
275070                                   TO RC801-ITEM (RC013-IDX)      27507071
275080                 MOVE SPACE        TO RC801-ACTION-SW (RC013-IDX) 27508071
275090                                                                  27509071
275100                 MOVE ASC-CURR-OPER-UNT-ID                        27510071
275110                                      TO RC800-OPER-UNIT-ID       27511071
275120                 MOVE ASC-FCLTY-ID    TO RC800-FACILITY-ID        27512071
275130                 MOVE ASC-PO-NBR      TO RC800-REC-NBR-N          27513071
275140                 MOVE ASC-REC-SEQ-NBR TO RC800-REC-SEQ-NBR-N      27514071
275150                 MOVE LQW-PREPK-ID (LQW-IDX)                      27515071
275160                                      TO RC801-PACK-ID (RC801-IDX)27516071
275170                 MOVE LQW-PO-RCVR-LINE (LQW-IDX)                  27517071
275180                                      TO RC801-REC-LNE-NBR        27518071
275190                                                       (RC801-IDX)27519071
275200                                                                  27520071
275210                 SET RC801-IDX UP BY 1                            27521071
275220                 IF  RC801-IDX > RC801-MAX-ITEMS                  27522071
275230                     PERFORM 5206-WRITE-SEL-QUEUE                 27523071
275240                     ADD +1        TO RC800-NUMBER-OF-TS-ITEMS    27524071
275250                     INITIALIZE RC801-SELECTED-ITEM-ARRAY         27525071
275260                     SET RC801-IDX TO 1                           27526071
275270                 END-IF                                           27527071
275280             END-IF                                               27528071
275290         END-PERFORM                                              27529071
275300     END-IF.                                                      27530071
275310                                                                  27531071
275320     MOVE PV-ITEM TO PV-SAVE-ITEM.                                27532071
275330     PERFORM 6111-WRITE-LIST-QUEUE.                               27533071
275340                                                                  27534071
275350                                                                  27535071
275360                                                                  27536071
275370                                                                  27537071
275380*----------------------------------------------------------------*27538071
275390*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *27539071
275400*----------------------------------------------------------------*27540071
275410 5205-WRITE-SEL-QUEUE.                                            27541071
275420     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            27542071
275430                                   TO PC121-SELECTED-ITEMS.       27543071
275440                                                                  27544071
275450     EXEC CICS                                                    27545071
275460          WRITEQ TS                                               27546071
275470              QUEUE (ASC-SEL-QUEUE-NAME)                          27547071
275480              FROM  (PC121-DC-SELECT-RECORD)                      27548071
275490              ITEM  (PV-SEL-QUEUE-ITEM)                           27549071
275500              RESP  (PV-CICS-RESP)                                27550071
275510     END-EXEC.                                                    27551071
275520                                                                  27552071
275530     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          27553071
275540         CONTINUE                                                 27554071
275550     ELSE                                                         27555071
275560         SET DP013-CICS-ABEND      TO TRUE                        27556071
275570         SET DP013-NO-ROLLBACK     TO TRUE                        27557071
275580         MOVE '5205-WRITE-SEL-QUEUE'                              27558071
275590                                   TO DP013-PARAGRAPH             27559071
275600         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          27560071
275610                                   TO DP013-MESSAGE-TEXT(1)       27561071
275620         PERFORM DP013-0000-PROCESS-ABEND                         27562071
275630     END-IF.                                                      27563071
275640                                                                  27564071
275650                                                                  27565071
275660*----------------------------------------------------------------*27566071
275670*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *27567071
275680*    LOCAL-FUNC-09 - (F19-PKDTLST)                               *27568071
275690*----------------------------------------------------------------*27569071
275700 5206-WRITE-SEL-QUEUE.                                            27570071
275710     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            27571071
275720                                   TO RC801-SELECTED-ITEMS.       27572071
275730                                                                  27573071
275740     EXEC CICS                                                    27574071
275750          WRITEQ TS                                               27575071
275760              QUEUE (ASC-SEL-QUEUE-NAME)                          27576071
275770              FROM  (RC801-PREPACK-SELECT-RECORD)                 27577071
275780              ITEM  (PV-SEL-QUEUE-ITEM)                           27578071
275790              RESP  (PV-CICS-RESP)                                27579071
275800     END-EXEC.                                                    27580071
275810                                                                  27581071
275820     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          27582071
275830         CONTINUE                                                 27583071
275840     ELSE                                                         27584071
275850         SET DP013-CICS-ABEND      TO TRUE                        27585071
275860         SET DP013-NO-ROLLBACK     TO TRUE                        27586071
275870         MOVE '5206-WRITE-SEL-QUEUE'                              27587071
275880                                   TO DP013-PARAGRAPH             27588071
275890         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          27589071
275900                                   TO DP013-MESSAGE-TEXT(1)       27590071
275910         PERFORM DP013-0000-PROCESS-ABEND                         27591071
275920     END-IF.                                                      27592071
275930                                                                  27593071
275940                                                                  27594071
275950*----------------------------------------------------------------*27595071
275960*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *27596071
275970*                                                                *27597071
275980* THIS QUEUE IS USED FOR TROUBLE LIST                            *27598071
275990*----------------------------------------------------------------*27599071
276000 5207-WRITE-SEL-QUEUE.                                            27600071
276010                                                                  27601071
276020     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            27602071
276030                                   TO PC016-SELECTED-ITEMS.       27603071
276040                                                                  27604071
276050     EXEC CICS                                                    27605071
276060          WRITEQ TS                                               27606071
276070              QUEUE (ASC-SEL-QUEUE-NAME)                          27607071
276080              FROM  (PC016-TS-SEL-REC)                            27608071
276090              ITEM  (PV-SEL-QUEUE-ITEM)                           27609071
276100              RESP  (PV-CICS-RESP)                                27610071
276110     END-EXEC.                                                    27611071
276120                                                                  27612071
276130     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          27613071
276140         CONTINUE                                                 27614071
276150     ELSE                                                         27615071
276160         SET DP013-CICS-ABEND      TO TRUE                        27616071
276170         SET DP013-NO-ROLLBACK     TO TRUE                        27617071
276180         MOVE '5207-WRITE-SEL-QUEUE'                              27618071
276190                                   TO DP013-PARAGRAPH             27619071
276200         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          27620071
276210                                   TO DP013-MESSAGE-TEXT(1)       27621071
276220         PERFORM DP013-0000-PROCESS-ABEND                         27622071
276230     END-IF.                                                      27623071
276240                                                                  27624071
276250                                                                  27625071
276260*----------------------------------------------------------------*27626071
276270*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *27627071
276280*                                                                *27628071
276290* THIS QUEUE IS USED FOR DISTRO  LIST                            *27629071
276300*----------------------------------------------------------------*27630071
276310 5208-WRITE-SEL-QUEUE.                                            27631071
276320                                                                  27632071
276330     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            27633071
276340                                   TO PC016-SELECTED-ITEMS.       27634071
276350                                                                  27635071
276360     EXEC CICS                                                    27636071
276370          WRITEQ TS                                               27637071
276380              QUEUE (ASC-SEL-QUEUE-NAME)                          27638071
276390              FROM  (RC013-DC-SELECT-RECORD)                      27639071
276400              ITEM  (PV-SEL-QUEUE-ITEM)                           27640071
276410              RESP  (PV-CICS-RESP)                                27641071
276420     END-EXEC.                                                    27642071
276430                                                                  27643071
276440     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          27644071
276450         CONTINUE                                                 27645071
276460     ELSE                                                         27646071
276470         SET DP013-CICS-ABEND      TO TRUE                        27647071
276480         SET DP013-NO-ROLLBACK     TO TRUE                        27648071
276490         MOVE '5208-WRITE-SEL-QUEUE'                              27649071
276500                                   TO DP013-PARAGRAPH             27650071
276510         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          27651071
276520                                   TO DP013-MESSAGE-TEXT(1)       27652071
276530         PERFORM DP013-0000-PROCESS-ABEND                         27653071
276540     END-IF.                                                      27654071
276550                                                                  27655071
276560                                                                  27656071
276570*----------------------------------------------------------------*27657071
276580*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *27658071
276590*                                                                *27659071
276600* THIS QUEUE IS USED FOR CARTON ASSIGN LIST                      *27660071
276610*----------------------------------------------------------------*27661071
276620 5209-WRITE-SEL-QUEUE-CRTNASGN.                                   27662071
276630                                                                  27663071
276640     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            27664071
276650                                   TO SU004-SELECTED-ITEMS.       27665071
276660                                                                  27666071
276670     EXEC CICS                                                    27667071
276680          WRITEQ TS                                               27668071
276690              QUEUE (ASC-SEL-QUEUE-NAME)                          27669071
276700              FROM  (SU004-DC-SELECT-RECORD)                      27670071
276710              ITEM  (PV-SEL-QUEUE-ITEM)                           27671071
276720              RESP  (PV-CICS-RESP)                                27672071
276730     END-EXEC.                                                    27673071
276740                                                                  27674071
276750     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          27675071
276760         CONTINUE                                                 27676071
276770     ELSE                                                         27677071
276780         SET DP013-CICS-ABEND      TO TRUE                        27678071
276790         SET DP013-NO-ROLLBACK     TO TRUE                        27679071
276800         MOVE '5209-WRITE-SEL-QUEUE-CRTNASGN'                     27680071
276810                                   TO DP013-PARAGRAPH             27681071
276820         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          27682071
276830                                   TO DP013-MESSAGE-TEXT(1)       27683071
276840         PERFORM DP013-0000-PROCESS-ABEND                         27684071
276850     END-IF.                                                      27685071
276860                                                                  27686071
276870                                                                  27687071
276880*----------------------------------------------------------------*27688071
276890*  RESEND SELECTED LINES BACK TO P2L                             *27689071
276900*----------------------------------------------------------------*27690071
276910 5300-PROCESS-P2L-RESEND.                                         27691071
276920                                                                  27692071
276930     MOVE +1                       TO ASC-BLK-SUB.                27693071
276940     PERFORM 5100-WRITE-TEMP-STORAGE.                             27694071
276950     ADD +1                        TO ASC-BLK-SUB.                27695071
276960     PERFORM 5100-WRITE-TEMP-STORAGE.                             27696071
276970                                                                  27697071
276980     PERFORM 6112-READ-LIST-QUEUE.                                27698071
276990                                                                  27699071
277000     SET  LQW-IDX  TO   1.                                        27700071
277010                                                                  27701071
277020     IF PS-NO-SOFT-ABORT-ERROR                                    27702071
277030       IF PV-CICS-RESP = DFHRESP (NORMAL)                         27703071
277040         PERFORM                                                  27704071
277050         VARYING LQW-IDX  FROM 1 BY 1                             27705071
277060         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL                     27706071
277070            OR   LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            27707071
277080            OR   PS-SOFT-ABORT-ERROR                              27708071
277090            OR   PS-ERROR                                         27709071
277100             IF  LQW-SELECT (LQW-IDX)                             27710071
277110                 IF  PS-NO-ERROR                                  27711071
277120                         PERFORM 5305-PROCESS-SELECTED-LINES      27712071
277130                 END-IF                                           27713071
277140             END-IF                                               27714071
277150         END-PERFORM                                              27715071
277160       END-IF                                                     27716071
277170     END-IF.                                                      27717071
277180                                                                  27718071
277190     MOVE PV-ITEM      TO PV-SAVE-ITEM.                           27719071
277200     PERFORM 6111-WRITE-LIST-QUEUE.                               27720071
277210                                                                  27721071
277220     MOVE +1                     TO  ASC-BLK-SUB.                 27722071
277230     PERFORM 4410-READ-TEMP-STORAGE.                              27723071
277240                                                                  27724071
277250     ADD +1                      TO  ASC-BLK-SUB                  27725071
277260                                     PV-BLOCK-NUMBER.             27726071
277270                                                                  27727071
277280     PERFORM 4410-READ-TEMP-STORAGE.                              27728071
277290                                                                  27729071
277300                                                                  27730071
277310*----------------------------------------------------------------*27731071
277320*  RESEND SELECTED LINES BACK TO P2L - PROCESS SELECTED LINES    *27732071
277330*----------------------------------------------------------------*27733071
277340 5305-PROCESS-SELECTED-LINES.                                     27734071
277350                                                                  27735071
277360     PERFORM 5310-PROCESS-LINES.                                  27736071
277370                                                                  27737071
277380     IF  PS-NO-ERROR                                              27738071
277390         SET DP020-MSG-INFORMATIONAL  TO TRUE                     27739071
277400         MOVE PC-TSYMSG-01898         TO  DP020-MSG-NUMBER        27740071
277410     END-IF.                                                      27741071
277420                                                                  27742071
277430                                                                  27743071
277440*----------------------------------------------------------------*27744071
277450*  RESEND SELECTED LINES BACK TO P2L - PROCESS SELECTED LINES    *27745071
277460*----------------------------------------------------------------*27746071
277470 5310-PROCESS-LINES.                                              27747071
277480                                                                  27748071
277490     MOVE ASC-PO-NBR                     TO  PV-PO-NBR            27749071
277500                                             DK-PO-NBR.           27750071
277510     MOVE ASC-REC-SEQ-NBR                TO  PV-REC-SEQ-NBR       27751071
277520                                             PV-REC-SEQ-NBR.      27752071
277530     MOVE LQW-PO-RCVR-LINE(LQW-IDX)      TO  PV-PO-LINE-NBR       27753071
277540                                             DK-LINE-NBR.         27754071
277550     MOVE LQW-SKU(LQW-IDX)               TO  PV-SKU.              27755071
277560     MOVE LQW-MODULE(LQW-IDX)            TO  PV-MODULE.           27756071
277570     MOVE LQW-CARTON-CNT-X(LQW-IDX)      TO  PV-CARTON-COUNT-X.   27757071
277580     MOVE LQW-INNER-PACK-X(LQW-IDX)      TO  PV-INNER-PACK-QTY-X. 27758071
277590     MOVE LQW-OUTER-PACK-X(LQW-IDX)      TO  PV-OUTER-PACK-QTY-X. 27759071
277600     MOVE LQW-IN-PACK-CONVY(LQW-IDX)     TO  PV-IN-PAK-CONVEY.    27760071
277610     MOVE LQW-LABEL-TYPE(LQW-IDX)        TO  PV-LBL-TYP.          27761071
277620     MOVE LQW-PROCESS-QTY(LQW-IDX)       TO  PV-LNE-PROCESS-QTY-X.27762071
277630     MOVE LQW-TRANSCRIB-QTY(LQW-IDX)     TO  PV-TRANSCRIBE-QTY-X. 27763071
277640     MOVE LQW-P2L-LBL-CNT(LQW-IDX)       TO  PV-P2L-LABEL-CNT.    27764071
277650     MOVE LQW-SHP-LBL-CNT(LQW-IDX)       TO  PV-SML-LABEL-CNT.    27765071
277660     MOVE LQW-SML-FCSE-LBL-CNT(LQW-IDX)  TO  PV-SML-FCSE-LBL-CNT. 27766071
277670     MOVE LQW-SML-INPK-LBL-CNT(LQW-IDX)  TO  PV-SML-INPK-LBL-CNT. 27767071
277680     MOVE LQW-DISPLAY-STORE-CNT(LQW-IDX) TO  PV-DISPLAY-STORE-CNT 27768071
277690     MOVE LQW-DISPLAY-ITM-CNT(LQW-IDX)   TO  PV-DISPLAY-ITEM-QTY. 27769071
277700     MOVE LQW-EXPTD-ITM-QTY(LQW-IDX)     TO  PV-EXPECTED-ITM-QTY. 27770071
277710     MOVE LQW-P2L-DIVERT-CDE(LQW-IDX)    TO  PV-P2L-DIVERT-CDE.   27771071
277720     MOVE ASC-P2L-SRVR-IP-ADDR           TO  PV-IP-ADDRESS.       27772071
277730     MOVE LQW-SKU (LQW-IDX)              TO  PV-SKU.              27773071
277740     MOVE LQW-LNE-CRE-LBL-OPT (LQW-IDX)  TO  PV-LNE-CRE-LBL-OPT.  27774071
277750     MOVE LQW-LNE-FCSE-AREA (LQW-IDX)    TO  PV-LNE-FCSE-AREA.    27775071
277760                                                                  27776071
277770     PERFORM 5315-P2L-RESEND-FUNC.                                27777071
277780                                                                  27778071
277790     IF  PS-NO-ERROR                                              27779071
277800         EXEC CICS                                                27780071
277810              SYNCPOINT                                           27781071
277820         END-EXEC                                                 27782071
277830     END-IF.                                                      27783071
277840                                                                  27784071
277850     IF  PS-NO-ERROR                                              27785071
277860         SET  LQW-DESELECT (LQW-IDX)                              27786071
277870              LQW-NO-UPDATE (LQW-IDX)                             27787071
277880              LQW-PROTECTED (LQW-IDX)                             27788071
277890              LQW-UPD (LQW-IDX)        TO  TRUE                   27789071
277900         IF  LQW-LNE-UCC128-YES (LQW-IDX)                         27790071
277910             CONTINUE                                             27791071
277920         ELSE                                                     27792071
277930             SUBTRACT  1                                          27793071
277940                 FROM  ASC-NUMBER-OF-SELECTED-ITEMS               27794071
277950         END-IF                                                   27795071
277960         MOVE LQW-SELECTED-SW (LQW-IDX)                           27796071
277970                              TO LQW-TEMP-SELECTED-SW (LQW-IDX)   27797071
277980         IF  LQW-LINE-STATUS (LQW-IDX)  =  SPACES                 27798071
277990             IF  LQW-PPC-EXISTS (LQW-IDX)                         27799071
278000                 MOVE 'DWPP'      TO  LQW-LINE-STATUS (LQW-IDX)   27800071
278010             ELSE                                                 27801071
278020             IF  DISTHD-PRCG-STAT-CDE  =  PC-F                    27802071
278030                 MOVE 'NPRO'      TO  LQW-LINE-STATUS (LQW-IDX)   27803071
278040             END-IF                                               27804071
278050         END-IF                                                   27805071
278060     END-IF.                                                      27806071
278070                                                                  27807071
278080                                                                  27808071
278090*----------------------------------------------------------------*27809071
278100*                                                                *27810071
278110*----------------------------------------------------------------*27811071
278120 5315-P2L-RESEND-FUNC.                                            27812071
278130                                                                  27813071
278140     MOVE PV-PO-NBR                 TO  PC053-HDR-ORD-NBR         27814071
278150                                        PC184-HDR-ORD-NBR.        27815071
278160     MOVE PV-REC-SEQ-NBR            TO  PC053-HDR-RCVR-SEQ-NBR    27816071
278170                                        PC184-HDR-RCVR-SEQ-NBR.   27817071
278180     MOVE PV-PO-LINE-NBR            TO  PC053-HDR-ORD-LNE-NBR     27818071
278190                                        PC184-HDR-ORD-LNE-NBR.    27819071
278200     MOVE PC-001                    TO  PC053-HDR-WORK-ORD-SEQ-NBR27820071
278210                                        PC184-HDR-WORK-ORD-SEQ-NBR27821071
278220     MOVE SD-SYSTEM-MONTH           TO  PC053-CREATE-MONTH        27822071
278230                                        PC184-CREATE-MONTH.       27823071
278240     MOVE SD-SYSTEM-DAY             TO  PC053-CREATE-DAY          27824071
278250                                        PC184-CREATE-DAY.         27825071
278260     MOVE SD-SYSTEM-CENTURY-YEAR    TO  PC053-CREATE-CENTURY-YEAR 27826071
278270                                        PC184-CREATE-CENTURY-YEAR.27827071
278280     MOVE ST-SYSTEM-HOUR            TO  PC053-CREATE-HOUR         27828071
278290                                        PC184-CREATE-HOUR.        27829071
278300     MOVE ST-SYSTEM-MINUTE          TO  PC053-CREATE-MINUTE       27830071
278310                                        PC184-CREATE-MINUTE.      27831071
278320     MOVE ST-SYSTEM-SECOND          TO  PC053-CREATE-SECOND       27832071
278330                                        PC184-CREATE-SECOND.      27833071
278340     MOVE PV-MODULE                 TO  PV-PREVIOUS-MOD.          27834071
278350                                                                  27835071
278360     PERFORM 5320-CREATE-P2L-RESEND.                              27836071
278370                                                                  27837071
278380     IF  PS-NO-ERROR                                              27838071
278390         EXEC CICS                                                27839071
278400              SYNCPOINT                                           27840071
278410         END-EXEC                                                 27841071
278420     END-IF.                                                      27842071
278430                                                                  27843071
278440                                                                  27844071
278450*----------------------------------------------------------------*27845071
278460*                                                                *27846071
278470*----------------------------------------------------------------*27847071
278480 5320-CREATE-P2L-RESEND.                                          27848071
278490                                                                  27849071
278500     MOVE PV-PO-NBR               TO  DK-PO-NBR.                  27850071
278510     MOVE PV-REC-SEQ-NBR          TO  DK-REC-SEQ-NBR.             27851071
278520     MOVE PV-PO-LINE-NBR          TO  DK-LINE-NBR.                27852071
278530                                                                  27853071
278540     IF  ASC-P2L-AL-DOWNLOAD-NO  AND                              27854071
278550         ASC-P2L-PCC-DOWNLOAD-NO                                  27855071
278560         NEXT SENTENCE                                            27856071
278570     ELSE                                                         27857071
278580     IF  PS-SOCKET-INITIALIZED-NO                                 27858071
278590         IF  PS-NO-ERROR                                          27859071
278600             PERFORM 4645-CALL-SOCKET                             27860071
278610         END-IF                                                   27861071
278620         IF  PS-NO-ERROR                                          27862071
278630             PERFORM 4650-CONNECT-SOCKET                          27863071
278640         END-IF                                                   27864071
278650         IF  PS-NO-ERROR                                          27865071
278660             SET PS-SOCKET-INITIALIZED-YES  TO  TRUE              27866071
278670         END-IF                                                   27867071
278680     END-IF                                                       27868071
278690                                                                  27869071
278700     END-IF.                                                      27870071
278800                                                                  27880071
278900                                                                  27890071
279000     IF  PS-NO-ERROR                                              27900071
279100         PERFORM 4700-BLD-HDR-REC                                 27910071
279110     END-IF.                                                      27911071
279120                                                                  27912071
279130     MOVE  PV-P2L-LABEL-CNT   TO  LQW-P2L-LBL-CNT(LQW-IDX).       27913071
279140     MOVE  ZEROES             TO  LQW-SHP-LBL-CNT(LQW-IDX)        27914071
279150                                  LQW-SML-INPK-LBL-CNT(LQW-IDX)   27915071
279160                                  LQW-SML-FCSE-LBL-CNT(LQW-IDX)   27916071
279170                                  PV-P2L-UNIT-CNT                 27917071
279180                                  PV-SML-FCSE-LBL-CNT             27918071
279190                                  PV-SML-INPK-LBL-CNT.            27919071
279200                                                                  27920071
279300     IF  PS-NO-ERROR  AND                                         27930071
279310         PS-DISPLAY-CSSL-YES                                      27931071
279320         INITIALIZE      PV-CICS-MSG-AREA2                        27932071
279330         MOVE DP020-SRC-TASK-NUMBER      TO  PV-DISPLAY-TASK-NBR  27933071
279340         MOVE ASC-PO-NBR             TO  PV-DISPLAY-PO-NBR        27934071
279350         MOVE ASC-REC-SEQ-NBR        TO  PV-DISPLAY-RCVR-SEQ-NBR  27935071
279360         MOVE DP020-LOCATION-NBR     TO  PV-DISPLAY-OPER          27936071
279370         STRING      ' PCKCS701-'                                 27937071
279380                 PV-DISPLAY-OPER                                  27938071
279390                 ' TERM-'                                         27939071
279400                 DP020-TERM-ID                                    27940071
279410                 ' USER-'                                         27941071
279420                 DP020-USERID                                     27942071
279430                 ' TASK-'                                         27943071
279440                 PV-DISPLAY-TASK-NBR                              27944071
279450                 ' PO-'                                           27945071
279460                 PV-DISPLAY-PO-NBR                                27946071
279470                 '-'                                              27947071
279480                 PV-DISPLAY-RCVR-SEQ-NBR                          27948071
279490                 ' BEF BLD DTL-5330 '      DELIMITED BY SIZE      27949071
279500                                      INTO PV-CICS-MSG-AREA2      27950071
279510         MOVE LENGTH OF PV-CICS-MSG-AREA2                         27951071
279520           TO PV-COMMAREA-LENGTH                                  27952071
279530         EXEC CICS                                                27953071
279540              WRITEQ TD                                           27954071
279550               QUEUE      ('CSSL')                                27955071
279560                FROM      (PV-CICS-MSG-AREA2)                     27956071
279570              LENGTH      (PV-COMMAREA-LENGTH)                    27957071
279580                RESP      (PV-CICS-RESP)                          27958071
279590         END-EXEC                                                 27959071
279600     END-IF                                                       27960071
279610                                                                  27961071
279620     IF  PS-NO-ERROR                                              27962071
279630         PERFORM 5330-BLD-DTL-REC                                 27963071
279640     END-IF.                                                      27964071
279650                                                                  27965071
279660                                                                  27966071
279670     IF  PS-NO-ERROR                                              27967071
279680         PERFORM 4770-BLD-TLR-REC                                 27968071
279690     END-IF.                                                      27969071
279700                                                                  27970071
279800     IF  PS-NO-ERROR                                              27980071
279900         SET PC-LINE-DOWNLOADED-TO-QNX TO TRUE                    27990071
280000     END-IF.                                                      28000071
280010                                                                  28001071
280020                                                                  28002071
280030     IF  PS-NO-ERROR                                              28003071
280040         PERFORM 4785-BUILD-RECEIPT-RECS                          28004071
280050     END-IF.                                                      28005071
280060                                                                  28006071
280070                                                                  28007071
280080*===TKMA408=== THIS IS IN JUST FOR TESTING                        28008071
280090*    IF  PS-NO-ERROR                                              28009071
280100*       MOVE ' BEFORE - 5360-UPDATE-HEADER-P2L-RESEND PERFORM'    28010071
280110*                                     TO PV-CICS-MSG-DATA2        28011071
280120*       MOVE PV-CICS-MSG-HOLD2        TO PV-CICS-MSG-AREA2        28012071
280130*       MOVE LENGTH OF PV-CICS-MSG-AREA2                          28013071
280140*                                     TO PV-COMMAREA-LENGTH       28014071
280150*       EXEC CICS                                                 28015071
280160*           WRITEQ TD                                             28016071
280170*               QUEUE   ('CSSL')                                  28017071
280180*               FROM    (PV-CICS-MSG-AREA2)                       28018071
280190*               LENGTH  (PV-COMMAREA-LENGTH)                      28019071
280200*               RESP    (PV-CICS-RESP)                            28020071
280210*       END-EXEC                                                  28021071
280220*    END-IF.                                                      28022071
280230*===TKMA408=== THIS IS IN JUST FOR TESTING                        28023071
280240                                                                  28024071
280250                                                                  28025071
280260     IF  PS-NO-SOFT-ABORT-ERROR                                   28026071
280270         PERFORM 5360-UPDATE-HEADER-P2L-RESEND                    28027071
280280     END-IF.                                                      28028071
280290                                                                  28029071
280300                                                                  28030071
280310*----------------------------------------------------------------*28031071
280320* BUILD P2L DETAIL RECORDS FROM DISTDT TABLE                     *28032071
280330*----------------------------------------------------------------*28033071
280340 5330-BLD-DTL-REC.                                                28034071
280350                                                                  28035071
280360                                                                  28036071
280370     PERFORM 5335-OPEN-DISTDT-P2L-CURSOR.                         28037071
280380                                                                  28038071
280390                                                                  28039071
280400     IF  PS-NO-SOFT-ABORT-ERROR                                   28040071
280410         MOVE ZEROES  TO  PV-STR-RECS-SENT                        28041071
280420         PERFORM 5340-FETCH-DISTDT-P2L-CURSOR                     28042071
280430         IF PS-NO-SOFT-ABORT-ERROR                                28043071
280440            PERFORM                                               28044071
280450              UNTIL SQLCODE  =  +100                              28045071
280460                 OR PS-SOFT-ABORT-ERROR                           28046071
280470                    PERFORM 5345-SEND-DISTRO-RECS                 28047071
280480                        IF PS-NO-SOFT-ABORT-ERROR                 28048071
280490                           PERFORM 5340-FETCH-DISTDT-P2L-CURSOR   28049071
280500                        END-IF                                    28050071
280510            END-PERFORM                                           28051071
280520         END-IF                                                   28052071
280530     END-IF.                                                      28053071
280540                                                                  28054071
280550     IF  PS-NO-SOFT-ABORT-ERROR                                   28055071
280560         PERFORM 5350-CLOSE-DISTDT-P2L-CURSOR                     28056071
280570     END-IF.                                                      28057071
280580                                                                  28058071
280590                                                                  28059071
280600*----------------------------------------------------------------*28060071
280610* OPEN P2L RESEND CURSOR                                         *28061071
280620*----------------------------------------------------------------*28062071
280630 5335-OPEN-DISTDT-P2L-CURSOR.                                     28063071
280640     SET  PS-NO-SOFT-ABORT-ERROR  TO  TRUE.                       28064071
280650                                                                  28065071
280660     EXEC SQL                                                     28066071
280670         OPEN DISTDT_P2LRSND_CSR                                  28067071
280680     END-EXEC.                                                    28068071
280690                                                                  28069071
280700     EVALUATE TRUE                                                28070071
280710         WHEN SQLCODE = ZERO                                      28071071
280720             CONTINUE                                             28072071
280730         WHEN SQLCODE = -904                                      28073071
280740         WHEN SQLCODE = -911                                      28074071
280750         WHEN SQLCODE = -913                                      28075071
280760                                                                  28076071
280770             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   28077071
280780             MOVE '5335-OPEN-DISTDT-P2L-CURSOR'                   28078071
280790                                             TO PV-SOFT-PARAGRAPH 28079071
280800             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 28080071
280810             MOVE LENGTH OF PV-CICS-MSG-AREA2                     28081071
280820               TO PV-COMMAREA-LENGTH                              28082071
280830             EXEC CICS                                            28083071
280840                  WRITEQ TD                                       28084071
280850                   QUEUE  ('CSSL')                                28085071
280860                    FROM  (PV-CICS-MSG-AREA2)                     28086071
280870                  LENGTH  (PV-COMMAREA-LENGTH)                    28087071
280880                    RESP  (PV-CICS-RESP)                          28088071
280890             END-EXEC                                             28089071
280900                                                                  28090071
280910              MOVE  PC-TSYMSG-01767  TO  DP020-MSG-NUMBER         28091071
280920              PERFORM 9900-SOFT-ABORT                             28092071
280930         WHEN SQLWARN0 NOT = SPACE                                28093071
280940         WHEN SQLCODE < ZERO                                      28094071
280950         WHEN SQLCODE > ZERO                                      28095071
280960             MOVE '5335-OPEN-DISTDT-P2L-CURSOR'                   28096071
280970                                     TO DP013-PARAGRAPH           28097071
280980             MOVE 'OPEN THE DISTDT_P2LRSND_CSR'                   28098071
280990                                     TO DP013-MESSAGE-TEXT (1)    28099071
281000             MOVE SQLCA              TO DP013-SQLCA               28100071
281010             MOVE 'TDISTDT'          TO DP013-DB2-TABLE-NAME (1)  28101071
281020             SET DP013-DB2-ABEND     TO TRUE                      28102071
281030             SET DP013-NO-ROLLBACK   TO TRUE                      28103071
281040             SET DP013-XCTL-DISPLAY-RESTART                       28104071
281050                                     TO TRUE                      28105071
281060             PERFORM DP013-0000-PROCESS-ABEND                     28106071
281070     END-EVALUATE.                                                28107071
281080                                                                  28108071
281090                                                                  28109071
281100*----------------------------------------------------------------*28110071
281110* FETCH P2L RESEND CURSOR                                        *28111071
281120*----------------------------------------------------------------*28112071
281130 5340-FETCH-DISTDT-P2L-CURSOR.                                    28113071
281140     SET  PS-NO-SOFT-ABORT-ERROR  TO  TRUE.                       28114071
281150                                                                  28115071
281160     EXEC SQL                                                     28116071
281170         FETCH DISTDT_P2LRSND_CSR                                 28117071
281180          INTO :DISTDT-ORD-NBR,                                   28118071
281190               :DISTDT-RCVR-SEQ-NBR,                              28119071
281200               :DISTDT-ORD-LNE-NBR,                               28120071
281210               :DISTDT-STR-NBR,                                   28121071
281220               :DISTDT-P2L-SPLT-UNT-QTY                           28122071
281230     END-EXEC.                                                    28123071
281240                                                                  28124071
281250     EVALUATE TRUE                                                28125071
281260         WHEN SQLCODE = ZERO                                      28126071
281270             CONTINUE                                             28127071
281280         WHEN SQLCODE = +100                                      28128071
281290             SET PS-EOF-P2L-RESEND-CSR TO TRUE                    28129071
281300         WHEN SQLCODE = -904                                      28130071
281310         WHEN SQLCODE = -911                                      28131071
281320         WHEN SQLCODE = -913                                      28132071
281330                                                                  28133071
281340             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   28134071
281350             MOVE '5340-FETCH-DISTDT-P2L-CURSOR'                  28135071
281360                                             TO PV-SOFT-PARAGRAPH 28136071
281370             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 28137071
281380             MOVE LENGTH OF PV-CICS-MSG-AREA2                     28138071
281390               TO PV-COMMAREA-LENGTH                              28139071
281400             EXEC CICS                                            28140071
281410                  WRITEQ TD                                       28141071
281420                   QUEUE  ('CSSL')                                28142071
281430                    FROM  (PV-CICS-MSG-AREA2)                     28143071
281440                  LENGTH  (PV-COMMAREA-LENGTH)                    28144071
281450                    RESP  (PV-CICS-RESP)                          28145071
281460             END-EXEC                                             28146071
281470                                                                  28147071
281480              MOVE  PC-TSYMSG-01767  TO  DP020-MSG-NUMBER         28148071
281490              PERFORM 9900-SOFT-ABORT                             28149071
281500         WHEN SQLWARN0 NOT = SPACE                                28150071
281510         WHEN SQLCODE < ZERO                                      28151071
281520         WHEN SQLCODE > ZERO                                      28152071
281530             MOVE '5340-FETCH-DISTDT-P2L-CURSOR'                  28153071
281540                                     TO DP013-PARAGRAPH           28154071
281550             MOVE 'ATTEMPTING TO FETCH A ROW OF THE RESULTS TABLE 28155071
281560-                 'FROM THE DISTDT_P2LRSND_CSR'                   28156071
281570                                     TO DP013-MESSAGE-TEXT (1)    28157071
281580             MOVE SQLCA              TO DP013-SQLCA               28158071
281590             MOVE 'TDISTDT'          TO DP013-DB2-TABLE-NAME (1)  28159071
281600             SET DP013-DB2-ABEND     TO TRUE                      28160071
281610             SET DP013-ROLLBACK      TO TRUE                      28161071
281620             SET DP013-XCTL-DISPLAY-RESTART                       28162071
281630                                     TO TRUE                      28163071
281640             PERFORM DP013-0000-PROCESS-ABEND                     28164071
281650     END-EVALUATE.                                                28165071
281660                                                                  28166071
281670                                                                  28167071
281680*----------------------------------------------------------------*28168071
281690* BUILD P2L DISTRO FOR P2L RESEND                                *28169071
281700*----------------------------------------------------------------*28170071
281710 5345-SEND-DISTRO-RECS.                                           28171071
281720                                                                  28172071
281730     INITIALIZE PC053-DISTRO-RECORD                               28173071
281740                PC184-DISTRO-RECORD.                              28174071
281750     SET  PC053-DISTRO-DTL         TO TRUE.                       28175071
281760     SET  PC184-DISTRO-DTL         TO TRUE.                       28176071
281770     MOVE DISTDT-ORD-NBR           TO PV-PO-NBR.                  28177071
281780     MOVE DISTDT-RCVR-SEQ-NBR      TO PV-REC-SEQ-NBR.             28178071
281790     MOVE DISTDT-ORD-LNE-NBR       TO PV-PO-LINE-NBR.             28179071
281800     MOVE PV-PO-NBR-8              TO PC053-DTL-ORD-NBR           28180071
281810                                      PC184-DTL-ORD-NBR.          28181071
281820     MOVE PV-REC-SEQ-NBR-3         TO PC053-DTL-RCVR-SEQ-NBR      28182071
281830                                      PC184-DTL-RCVR-SEQ-NBR.     28183071
281840     MOVE PV-PO-LINE-NBR-X         TO PC053-DTL-ORD-LNE-NBR       28184071
281850                                      PC184-DTL-ORD-LNE-NBR.      28185071
281860     MOVE PC-001                   TO PC053-DTL-WORK-ORD-SEQ-NBR  28186071
281870                                      PC184-DTL-WORK-ORD-SEQ-NBR  28187071
281880                                      DK-WORK-ORD-SEQ-NBR.        28188071
281890     MOVE ZEROES                   TO PC053-DTL-WO-INS-SEQ-NBR    28189071
281900                                      PC184-DTL-WO-INS-SEQ-NBR.   28190071
281910     MOVE DISTDT-STR-NBR           TO PC053-STR-NBR               28191071
281920                                      PC184-STR-NBR.              28192071
281930     MOVE DISTDT-P2L-SPLT-UNT-QTY  TO PC053-INVOICED-QTY          28193071
281940                                      PC184-INVOICED-QTY.         28194071
281950                                                                  28195071
281960     INSPECT PC053-DISTRO-DTL-REC                                 28196071
281970             REPLACING ALL '' BY SPACES                          28197071
281980     INSPECT PC053-DISTRO-DTL-REC                                 28198071
281990             REPLACING ALL ';' BY SPACES                          28199071
282000     INSPECT PC053-DISTRO-DTL-REC                                 28200071
282010             REPLACING ALL LOW-VALUES BY SPACES                   28201071
282020     MOVE PC-SEMI-COLON        TO PC053-DTL-TERM-CHAR.            28202071
282030                                                                  28203071
282040     INSPECT PC184-DISTRO-DTL-REC                                 28204071
282050             REPLACING ALL '' BY SPACES                          28205071
282060     INSPECT PC184-DISTRO-DTL-REC                                 28206071
282070             REPLACING ALL ';' BY SPACES                          28207071
282080     INSPECT PC184-DISTRO-DTL-REC                                 28208071
282090             REPLACING ALL LOW-VALUES BY SPACES                   28209071
282100*---------------------------------                                28210071
282110*   ADDED CHECK FOR HEX 71                                        28211071
282120*---------------------------------                                28212071
282130     INSPECT PC184-DISTRO-DTL-REC                                 28213071
282140             REPLACING ALL '' bY SPACES                          28214071
282141                                                                  28214171
282142     MOVE PC-SEMI-COLON        TO PC184-DTL-TERM-CHAR.            28214271
282143                                                                  28214371
282144*===TKMA408=== THIS IS IN JUST FOR TESTING                        28214471
282145     IF   PS-DISPLAY-CSSL-YES                                     28214571
282146          IF  LQW-P2L-DYNAPACK (LQW-IDX)                          28214671
282147            IF  LQW-P2L-ALS-4-DIGIT-STR (LQW-IDX)                 28214771
282148              STRING ' PCKCS701-5345-AL4 '                        28214871
282149                     PC053-DISTRO-RECORD   DELIMITED BY SIZE      28214971
282150                                      INTO PV-CICS-152-RECORD     28215071
282160            END-IF                                                28216071
282170          ELSE                                                    28217071
282180                 STRING ' PCKCS701-5345-PCC '                     28218071
282190                        PC184-DISTRO-RECORD   DELIMITED BY SIZE   28219071
282200                                      INTO PV-CICS-152-RECORD     28220071
282210          END-IF                                                  28221071
282220        MOVE PV-CICS-1-99             TO PV-CICS-MSG-DATA2        28222071
282230        MOVE PV-CICS-MSG-HOLD2        TO PV-CICS-MSG-AREA2        28223071
282240        MOVE LENGTH OF PV-CICS-MSG-AREA2                          28224071
282250                                      TO PV-COMMAREA-LENGTH       28225071
282260        EXEC CICS                                                 28226071
282270            WRITEQ TD                                             28227071
282280                QUEUE   ('CSSL')                                  28228071
282290                FROM    (PV-CICS-MSG-AREA2)                       28229071
282300                LENGTH  (PV-COMMAREA-LENGTH)                      28230071
282310                RESP    (PV-CICS-RESP)                            28231071
282320        END-EXEC                                                  28232071
282330     END-IF                                                       28233071
282340*===TKMA408=== THIS IS IN JUST FOR TESTING                        28234071
282350                                                                  28235071
282360     IF  LQW-LNE-CRE-BOTH-LBL (LQW-IDX)  AND                      28236071
282370         LQW-P2L-LBL-CNT(LQW-IDX) = ZEROES                        28237071
282380         CONTINUE                                                 28238071
282390     ELSE                                                         28239071
282400     IF  ASC-P2L-AL-DOWNLOAD-NO   AND                             28240071
282410         ASC-P2L-PCC-DOWNLOAD-NO                                  28241071
282420         CONTINUE                                                 28242071
282430     ELSE                                                         28243071
282440         IF  LQW-P2L-DYNAPACK (LQW-IDX)  AND                      28244071
282450             ASC-P2L-AL-DOWNLOAD-YES                              28245071
282460             PERFORM 4805-SEND-DTL-TLR-TO-QNX                     28246071
282470         ELSE                                                     28247071
282480         IF  LQW-P2L-PCC (LQW-IDX)  AND                           28248071
282490             ASC-P2L-PCC-DOWNLOAD-YES                             28249071
282500             PERFORM 4970-SEND-P2L-DATA-LTP-THP                   28250071
282510         END-IF                                                   28251071
282520         END-IF                                                   28252071
282530         ADD 1 TO PV-STR-RECS-SENT                                28253071
282540     END-IF.                                                      28254071
282550                                                                  28255071
282560                                                                  28256071
282570*----------------------------------------------------------------*28257071
282580* CLOSE P2L RESEND CURSOR                                        *28258071
282590*----------------------------------------------------------------*28259071
282600 5350-CLOSE-DISTDT-P2L-CURSOR.                                    28260071
282610     SET  PS-NO-SOFT-ABORT-ERROR  TO  TRUE.                       28261071
282620                                                                  28262071
282630     EXEC SQL                                                     28263071
282640         CLOSE DISTDT_P2LRSND_CSR                                 28264071
282650     END-EXEC.                                                    28265071
282660                                                                  28266071
282670     EVALUATE TRUE                                                28267071
282680         WHEN SQLCODE = ZERO                                      28268071
282690             CONTINUE                                             28269071
282700         WHEN SQLCODE = -904                                      28270071
282710         WHEN SQLCODE = -911                                      28271071
282720         WHEN SQLCODE = -913                                      28272071
282730                                                                  28273071
282740             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   28274071
282750             MOVE '5350-CLOSE-DISTDT-P2L-CURSOR'                  28275071
282760                                             TO PV-SOFT-PARAGRAPH 28276071
282770             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 28277071
282780             MOVE LENGTH OF PV-CICS-MSG-AREA2                     28278071
282790               TO PV-COMMAREA-LENGTH                              28279071
282800             EXEC CICS                                            28280071
282810                  WRITEQ TD                                       28281071
282820                   QUEUE  ('CSSL')                                28282071
282830                    FROM  (PV-CICS-MSG-AREA2)                     28283071
282840                  LENGTH  (PV-COMMAREA-LENGTH)                    28284071
282850                    RESP  (PV-CICS-RESP)                          28285071
282860             END-EXEC                                             28286071
282870                                                                  28287071
282880              MOVE  PC-TSYMSG-01767  TO  DP020-MSG-NUMBER         28288071
282890              PERFORM 9900-SOFT-ABORT                             28289071
282900         WHEN SQLWARN0 NOT = SPACE                                28290071
282910         WHEN SQLCODE < ZERO                                      28291071
282920         WHEN SQLCODE > ZERO                                      28292071
282930             MOVE '5350-CLOSE-DISTDT-P2L-CURSOR'                  28293071
282940                                     TO DP013-PARAGRAPH           28294071
282950             MOVE 'CLOSE DISTDT_P2LRSND_CSR'                      28295071
282960                                     TO DP013-MESSAGE-TEXT (1)    28296071
282970             MOVE SQLCA              TO DP013-SQLCA               28297071
282980             MOVE 'TDISTDT'          TO DP013-DB2-TABLE-NAME (1)  28298071
282990             SET DP013-DB2-ABEND     TO TRUE                      28299071
283000             SET DP013-NO-ROLLBACK   TO TRUE                      28300071
283010             SET DP013-XCTL-DISPLAY-RESTART                       28301071
283020                                     TO TRUE                      28302071
283030             PERFORM DP013-0000-PROCESS-ABEND                     28303071
283040     END-EVALUATE.                                                28304071
283050                                                                  28305071
283060                                                                  28306071
283070*----------------------------------------------------------------*28307071
283080* UPDATE DISTHD WITH THE NEW P2L MODULE FROM P2L-RESEND          *28308071
283090*----------------------------------------------------------------*28309071
283100 5360-UPDATE-HEADER-P2L-RESEND.                                   28310071
283110     MOVE PV-MODULE               TO  DISTHD-PRC-AREA-MODU-ID.    28311071
283120                                                                  28312071
283130     EXEC SQL                                                     28313071
283140          UPDATE TDISTHD                                          28314071
283150             SET                                                  28315071
283160                 PRC_AREA_MODU_ID    = :DISTHD-PRC-AREA-MODU-ID   28316071
283170           WHERE ORD_NBR             = :DK-PO-NBR                 28317071
283180             AND RCVR_SEQ_NBR        = :DK-REC-SEQ-NBR            28318071
283190             AND ORD_LNE_NBR         = :DK-LINE-NBR               28319071
283200     END-EXEC.                                                    28320071
283210                                                                  28321071
283220     EVALUATE TRUE                                                28322071
283230         WHEN SQLCODE = ZERO                                      28323071
283240         WHEN SQLCODE = +100                                      28324071
283250              CONTINUE                                            28325071
283260         WHEN SQLCODE = -904                                      28326071
283270         WHEN SQLCODE = -911                                      28327071
283280         WHEN SQLCODE = -913                                      28328071
283290                                                                  28329071
283300             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   28330071
283310             MOVE '5360-UPDATE-HEADER-P2L-RESEND'                 28331071
283320                                             TO PV-SOFT-PARAGRAPH 28332071
283330             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 28333071
283340             MOVE LENGTH OF PV-CICS-MSG-AREA2                     28334071
283350               TO PV-COMMAREA-LENGTH                              28335071
283360             EXEC CICS                                            28336071
283370                  WRITEQ TD                                       28337071
283380                   QUEUE  ('CSSL')                                28338071
283390                    FROM  (PV-CICS-MSG-AREA2)                     28339071
283400                  LENGTH  (PV-COMMAREA-LENGTH)                    28340071
283410                    RESP  (PV-CICS-RESP)                          28341071
283420             END-EXEC                                             28342071
283430                                                                  28343071
283440              MOVE  PC-TSYMSG-00551  TO  DP020-MSG-NUMBER         28344071
283450              PERFORM 9900-SOFT-ABORT                             28345071
283460         WHEN SQLWARN0 NOT = SPACES                               28346071
283470         WHEN SQLCODE NOT EQUAL ZERO                              28347071
283480              MOVE '5360-UPDATE-HEADER-P2L-RESEND'                28348071
283490                                   TO DP013-PARAGRAPH             28349071
283500              MOVE 'UPDATE DISTHD MODULE FOR P2L RESEND'          28350071
283510                                   TO DP013-MESSAGE-TEXT (1)      28351071
283520              MOVE SQLCA           TO DP013-SQLCA                 28352071
283530              MOVE 'TDISTHD'       TO DP013-DB2-TABLE-NAME (1)    28353071
283540              SET DP013-DB2-ABEND  TO TRUE                        28354071
283550              PERFORM DP013-0000-PROCESS-ABEND                    28355071
283560     END-EVALUATE.                                                28356071
283570                                                                  28357071
283580                                                                  28358071
283590*----------------------------------------------------------------*28359071
283600*  WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION,  *28360071
283610*  SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT  *28361071
283620*  THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO     *28362071
283630*  THE USER.                                                     *28363071
283640*----------------------------------------------------------------*28364071
283650 6000-REFRESH-PANEL-FROM-TEMP.                                    28365071
283660     IF  ASC-UPDATE-TSQ                                           28366071
283670         SET ASC-NO-TSQ-UPDATE TO TRUE                            28367071
283680         MOVE ZERO                 TO PV-SAVE-ITEM                28368071
283690                                      PV-SEL-QUEUE-ITEM           28369071
283700         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        28370071
283710                                   TO PV-HOLD-SELECTED-ITEMS      28371071
283720         MOVE +1                   TO PV-ITEMS-PROCESSED          28372071
283730                                                                  28373071
283740         IF  ASC-OTHER-QUEUE                                      28374071
283750             PERFORM 6100-UPDATE-TSQ                              28375071
283760                 UNTIL PV-ITEMS-PROCESSED >                       28376071
283770                                         PV-HOLD-SELECTED-ITEMS   28377071
283780         END-IF                                                   28378071
283790                                                                  28379071
283800         IF  ASC-TROUBLE-QUEUE                                    28380071
283810             PERFORM 6102-UPDATE-TSQ                              28381071
283820                 UNTIL PV-ITEMS-PROCESSED >                       28382071
283830                                         PV-HOLD-SELECTED-ITEMS   28383071
283840         END-IF                                                   28384071
283850                                                                  28385071
283860         IF  ASC-DISTRO-QUEUE                                     28386071
283870             PERFORM 6103-UPDATE-TSQ                              28387071
283880                 UNTIL PV-ITEMS-PROCESSED >                       28388071
283890                                         PV-HOLD-SELECTED-ITEMS   28389071
283900         END-IF                                                   28390071
283910                                                                  28391071
283920         IF  ASC-PREPK-QUEUE                                      28392071
283930             PERFORM 6104-UPDATE-TSQ                              28393071
283940                 UNTIL PV-ITEMS-PROCESSED >                       28394071
283950                                         PV-HOLD-SELECTED-ITEMS   28395071
283960         END-IF                                                   28396071
283970                                                                  28397071
283980         IF  ASC-CARTON-QUEUE                                     28398071
283990             PERFORM 6101-UPDATE-TSQ                              28399071
284000                 UNTIL PV-ITEMS-PROCESSED >                       28400071
284010                                         PV-HOLD-SELECTED-ITEMS   28401071
284020         END-IF                                                   28402071
284030                                                                  28403071
284040         PERFORM 6010-DELETE-SEL-QUEUE                            28404071
284050         INITIALIZE ASC-BLOCK-ENTRIES (1)                         28405071
284060                    ASC-BLOCK-ENTRIES (2)                         28406071
284070     END-IF.                                                      28407071
284080                                                                  28408071
284090                                                                  28409071
284100*----------------------------------------------------------------*28410071
284110*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *28411071
284120*----------------------------------------------------------------*28412071
284130 6010-DELETE-SEL-QUEUE.                                           28413071
284140     EXEC CICS                                                    28414071
284150         DELETEQ TS                                               28415071
284160             QUEUE (ASC-SEL-QUEUE-NAME)                           28416071
284170             RESP  (PV-CICS-RESP)                                 28417071
284180     END-EXEC.                                                    28418071
284190                                                                  28419071
284200     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      28420071
284210        (PV-CICS-RESP = DFHRESP(QIDERR)))                         28421071
284220         CONTINUE                                                 28422071
284230     ELSE                                                         28423071
284240         SET DP013-CICS-ABEND TO TRUE                             28424071
284250         SET DP013-NO-ROLLBACK TO TRUE                            28425071
284260         MOVE '6010-DELETE-SEL-QUEUE'                             28426071
284270                        TO DP013-PARAGRAPH                        28427071
284280         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         28428071
284290                        TO DP013-MESSAGE-TEXT (1)                 28429071
284300         PERFORM DP013-0000-PROCESS-ABEND                         28430071
284310     END-IF.                                                      28431071
284320                                                                  28432071
284330                                                                  28433071
284340*----------------------------------------------------------------*28434071
284350*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *28435071
284360*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *28436071
284370*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *28437071
284380*    THE TEMP QUEUE.                                             *28438071
284390*----------------------------------------------------------------*28439071
284400 6100-UPDATE-TSQ.                                                 28440071
284410     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             28441071
284420     PERFORM 6105-READ-SEL-QUEUE.                                 28442071
284430     PERFORM                                                      28443071
284440         VARYING PC121-IDX                                        28444071
284450         FROM 1 BY 1                                              28445071
284460         UNTIL ((PV-ITEMS-PROCESSED >                             28446071
284470                              PV-HOLD-SELECTED-ITEMS)             28447071
284480         OR (PC121-IDX GREATER THAN PC121-MAX-ITEMS))             28448071
284490         IF  PC121-ACTION-SW (PC121-IDX) > SPACE                  28449071
284500             PERFORM 6110-PROCESS-ITEMS                           28450071
284510         END-IF                                                   28451071
284520         ADD +1                TO PV-ITEMS-PROCESSED              28452071
284530     END-PERFORM.                                                 28453071
284540     PERFORM 6111-WRITE-LIST-QUEUE.                               28454071
284550                                                                  28455071
284560                                                                  28456071
284570*----------------------------------------------------------------*28457071
284580*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *28458071
284590*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *28459071
284600*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *28460071
284610*                                                                *28461071
284620*    THIS QUEUE IS USED FOR CARTON ASSIGNED LIST                 *28462071
284630*----------------------------------------------------------------*28463071
284640 6101-UPDATE-TSQ.                                                 28464071
284650     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             28465071
284660     PERFORM 6106-READ-SEL-QUEUE.                                 28466071
284670     PERFORM                                                      28467071
284680         VARYING SU004-IDX                                        28468071
284690         FROM 1 BY 1                                              28469071
284700         UNTIL ((PV-ITEMS-PROCESSED >                             28470071
284710                              PV-HOLD-SELECTED-ITEMS)             28471071
284720         OR (SU004-IDX GREATER THAN SU004-MAX-ITEMS))             28472071
284730         IF  SU004-ACTION-SW (SU004-IDX) > SPACE                  28473071
284740             PERFORM 6150-PROCESS-ITEMS                           28474071
284750         END-IF                                                   28475071
284760         ADD +1                TO PV-ITEMS-PROCESSED              28476071
284770     END-PERFORM.                                                 28477071
284780     PERFORM 6111-WRITE-LIST-QUEUE.                               28478071
284790                                                                  28479071
284800                                                                  28480071
284810*----------------------------------------------------------------*28481071
284820*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *28482071
284830*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *28483071
284840*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *28484071
284850*    THE TEMP QUEUE.                                             *28485071
284860*                                                                *28486071
284870* THIS QUEUE IS USED FOR TROUBLE LIST                            *28487071
284880*----------------------------------------------------------------*28488071
284890 6102-UPDATE-TSQ.                                                 28489071
284900     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             28490071
284910     PERFORM 6107-READ-SEL-QUEUE.                                 28491071
284920     PERFORM                                                      28492071
284930         VARYING PC016-IDX                                        28493071
284940         FROM 1 BY 1                                              28494071
284950         UNTIL ((PV-ITEMS-PROCESSED >                             28495071
284960                              PV-HOLD-SELECTED-ITEMS)             28496071
284970         OR (PC016-IDX GREATER THAN PC016-MAX-ITEMS))             28497071
284980         IF  PC016-ACTION-SW (PC016-IDX) > SPACE                  28498071
284990             PERFORM 6120-PROCESS-ITEMS                           28499071
285000         END-IF                                                   28500071
285010         ADD +1                TO PV-ITEMS-PROCESSED              28501071
285020     END-PERFORM.                                                 28502071
285030     PERFORM 6111-WRITE-LIST-QUEUE.                               28503071
285040                                                                  28504071
285050                                                                  28505071
285060*----------------------------------------------------------------*28506071
285070*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *28507071
285080*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *28508071
285090*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *28509071
285100*    THE TEMP QUEUE.                                             *28510071
285110*                                                                *28511071
285120* THIS QUEUE IS USED FOR TROUBLE LIST                            *28512071
285130*----------------------------------------------------------------*28513071
285140 6103-UPDATE-TSQ.                                                 28514071
285150     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             28515071
285160     PERFORM 6108-READ-SEL-QUEUE.                                 28516071
285170     PERFORM                                                      28517071
285180         VARYING RC013-IDX                                        28518071
285190         FROM 1 BY 1                                              28519071
285200         UNTIL ((PV-ITEMS-PROCESSED >                             28520071
285210                              PV-HOLD-SELECTED-ITEMS)             28521071
285220         OR (RC013-IDX GREATER THAN RC013-MAX-ITEMS))             28522071
285230         IF  RC013-ACTION-SW (RC013-IDX) > SPACE                  28523071
285240             PERFORM 6130-PROCESS-ITEMS                           28524071
285250         END-IF                                                   28525071
285260         ADD +1                TO PV-ITEMS-PROCESSED              28526071
285270     END-PERFORM.                                                 28527071
285280     PERFORM 6111-WRITE-LIST-QUEUE.                               28528071
285290                                                                  28529071
285300                                                                  28530071
285310*----------------------------------------------------------------*28531071
285320*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *28532071
285330*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *28533071
285340*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *28534071
285350*    THE TEMP QUEUE.                                             *28535071
285360*                                                                *28536071
285370* THIS QUEUE IS USED FOR PREPACK DETAIL LIST                     *28537071
285380*----------------------------------------------------------------*28538071
285390 6104-UPDATE-TSQ.                                                 28539071
285400     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             28540071
285410     PERFORM 6109-READ-SEL-QUEUE.                                 28541071
285420     PERFORM                                                      28542071
285430         VARYING RC801-IDX                                        28543071
285440         FROM 1 BY 1                                              28544071
285450         UNTIL ((PV-ITEMS-PROCESSED >                             28545071
285460                              PV-HOLD-SELECTED-ITEMS)             28546071
285470         OR (RC801-IDX GREATER THAN RC801-MAX-ITEMS))             28547071
285480         IF  RC801-ACTION-SW (RC801-IDX) > SPACE                  28548071
285490             PERFORM 6140-PROCESS-ITEMS                           28549071
285500         END-IF                                                   28550071
285510         ADD +1                TO PV-ITEMS-PROCESSED              28551071
285520     END-PERFORM.                                                 28552071
285530     PERFORM 6111-WRITE-LIST-QUEUE.                               28553071
285540                                                                  28554071
285550                                                                  28555071
285560*----------------------------------------------------------------*28556071
285570*    READ THE LIST QUEUE RECORD.                                 *28557071
285580*----------------------------------------------------------------*28558071
285590 6105-READ-SEL-QUEUE.                                             28559071
285600     EXEC CICS                                                    28560071
285610          READQ TS                                                28561071
285620              QUEUE (ASC-SEL-QUEUE-NAME)                          28562071
285630              INTO  (PC121-DC-SELECT-RECORD)                      28563071
285640              ITEM  (PV-SEL-QUEUE-ITEM)                           28564071
285650              RESP  (PV-CICS-RESP)                                28565071
285660     END-EXEC.                                                    28566071
285670                                                                  28567071
285680     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          28568071
285690         CONTINUE                                                 28569071
285700     ELSE                                                         28570071
285710         SET DP013-CICS-ABEND      TO  TRUE                       28571071
285720         SET DP013-NO-ROLLBACK     TO  TRUE                       28572071
285730         MOVE '6105-READ-SEL-QUEUE'                               28573071
285740                                   TO  DP013-PARAGRAPH            28574071
285750         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           28575071
285760                                   TO  DP013-MESSAGE-TEXT(1)      28576071
285770         PERFORM DP013-0000-PROCESS-ABEND                         28577071
285780     END-IF.                                                      28578071
285790                                                                  28579071
285800                                                                  28580071
285810*----------------------------------------------------------------*28581071
285820*    READ THE LIST QUEUE RECORD.                                 *28582071
285830*                                                                *28583071
285840*    THIS QUEUE IS USED FOR THE CARTON  ASSGN LIST               *28584071
285850*----------------------------------------------------------------*28585071
285860 6106-READ-SEL-QUEUE.                                             28586071
285870     EXEC CICS                                                    28587071
285880          READQ TS                                                28588071
285890              QUEUE (ASC-SEL-QUEUE-NAME)                          28589071
285900              INTO  (SU004-DC-SELECT-RECORD)                      28590071
285910              ITEM  (PV-SEL-QUEUE-ITEM)                           28591071
285920              RESP  (PV-CICS-RESP)                                28592071
285930     END-EXEC.                                                    28593071
285940                                                                  28594071
285950     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          28595071
285960         CONTINUE                                                 28596071
285970     ELSE                                                         28597071
285980         SET DP013-CICS-ABEND      TO  TRUE                       28598071
285990         SET DP013-NO-ROLLBACK     TO  TRUE                       28599071
286000         MOVE '6106-READ-SEL-QUEUE'                               28600071
286010                                   TO  DP013-PARAGRAPH            28601071
286020         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           28602071
286030                                   TO  DP013-MESSAGE-TEXT(1)      28603071
286040         PERFORM DP013-0000-PROCESS-ABEND                         28604071
286050     END-IF.                                                      28605071
286060                                                                  28606071
286070                                                                  28607071
286080*----------------------------------------------------------------*28608071
286090*    READ THE LIST QUEUE RECORD.                                 *28609071
286100*                                                                *28610071
286110* THIS QUEUE IS USED FOR TROUBLE LIST                            *28611071
286120*----------------------------------------------------------------*28612071
286130 6107-READ-SEL-QUEUE.                                             28613071
286140     EXEC CICS                                                    28614071
286150          READQ TS                                                28615071
286160              QUEUE (ASC-SEL-QUEUE-NAME)                          28616071
286170              INTO  (PC016-TS-SEL-REC)                            28617071
286180              ITEM  (PV-SEL-QUEUE-ITEM)                           28618071
286190              RESP  (PV-CICS-RESP)                                28619071
286200     END-EXEC.                                                    28620071
286210                                                                  28621071
286220     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          28622071
286230         CONTINUE                                                 28623071
286240     ELSE                                                         28624071
286250         SET DP013-CICS-ABEND      TO  TRUE                       28625071
286260         SET DP013-NO-ROLLBACK     TO  TRUE                       28626071
286270         MOVE '6107-READ-SEL-QUEUE'                               28627071
286280                                   TO  DP013-PARAGRAPH            28628071
286290         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           28629071
286300                                   TO  DP013-MESSAGE-TEXT(1)      28630071
286310         PERFORM DP013-0000-PROCESS-ABEND                         28631071
286320     END-IF.                                                      28632071
286330                                                                  28633071
286340                                                                  28634071
286350*----------------------------------------------------------------*28635071
286360*    READ THE LIST QUEUE RECORD.                                 *28636071
286370*                                                                *28637071
286380* THIS QUEUE IS USED FOR DISTRO                                  *28638071
286390*----------------------------------------------------------------*28639071
286400 6108-READ-SEL-QUEUE.                                             28640071
286410     EXEC CICS                                                    28641071
286420          READQ TS                                                28642071
286430              QUEUE (ASC-SEL-QUEUE-NAME)                          28643071
286440              INTO  (RC013-DC-SELECT-RECORD)                      28644071
286450              ITEM  (PV-SEL-QUEUE-ITEM)                           28645071
286460              RESP  (PV-CICS-RESP)                                28646071
286470     END-EXEC.                                                    28647071
286480                                                                  28648071
286490     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          28649071
286500         CONTINUE                                                 28650071
286510     ELSE                                                         28651071
286520         SET DP013-CICS-ABEND      TO  TRUE                       28652071
286530         SET DP013-NO-ROLLBACK     TO  TRUE                       28653071
286540         MOVE '6108-READ-SEL-QUEUE'                               28654071
286550                                   TO  DP013-PARAGRAPH            28655071
286560         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           28656071
286570                                   TO  DP013-MESSAGE-TEXT(1)      28657071
286580         PERFORM DP013-0000-PROCESS-ABEND                         28658071
286590     END-IF.                                                      28659071
286600                                                                  28660071
286610                                                                  28661071
286620*----------------------------------------------------------------*28662071
286630*    READ THE LIST QUEUE RECORD.                                 *28663071
286640*                                                                *28664071
286650* THIS QUEUE IS USED FOR PREPACK DETAIL LIST                     *28665071
286660*----------------------------------------------------------------*28666071
286670 6109-READ-SEL-QUEUE.                                             28667071
286680     EXEC CICS                                                    28668071
286690          READQ TS                                                28669071
286700              QUEUE (ASC-SEL-QUEUE-NAME)                          28670071
286710              INTO  (RC801-PREPACK-SELECT-RECORD)                 28671071
286720              ITEM  (PV-SEL-QUEUE-ITEM)                           28672071
286730              RESP  (PV-CICS-RESP)                                28673071
286740     END-EXEC.                                                    28674071
286750                                                                  28675071
286760     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          28676071
286770         CONTINUE                                                 28677071
286780     ELSE                                                         28678071
286790         SET DP013-CICS-ABEND      TO  TRUE                       28679071
286800         SET DP013-NO-ROLLBACK     TO  TRUE                       28680071
286810         MOVE '6109-READ-SEL-QUEUE'                               28681071
286820                                   TO  DP013-PARAGRAPH            28682071
286830         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           28683071
286840                                   TO  DP013-MESSAGE-TEXT(1)      28684071
286850         PERFORM DP013-0000-PROCESS-ABEND                         28685071
286860     END-IF.                                                      28686071
286870                                                                  28687071
286880                                                                  28688071
286890*----------------------------------------------------------------*28689071
286900*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*28690071
286910*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*28691071
286920*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *28692071
286930*----------------------------------------------------------------*28693071
286940 6110-PROCESS-ITEMS.                                              28694071
286950     COMPUTE PV-ITEM = 1 + ((PC121-ITEM (PC121-IDX) - 1)          28695071
286960                     / PC-ITEMS-PER-PANEL).                       28696071
286970                                                                  28697071
286980     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           28698071
286990         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          28699071
287000             PERFORM 6111-WRITE-LIST-QUEUE                        28700071
287010         END-IF                                                   28701071
287020         MOVE PV-ITEM          TO PV-SAVE-ITEM                    28702071
287030                                                                  28703071
287040         PERFORM 6112-READ-LIST-QUEUE                             28704071
287050         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               28705071
287060             CONTINUE                                             28706071
287070         END-IF                                                   28707071
287080     END-IF.                                                      28708071
287090                                                                  28709071
287100     COMPUTE PV-SUB = (PC121-ITEM (PC121-IDX)                     28710071
287110                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              28711071
287120     SET LQW-DESELECT (PV-SUB) TO    TRUE                         28712071
287130     MOVE LQW-SELECTED-SW (PV-SUB)                                28713071
287140                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  28714071
287150     EVALUATE TRUE                                                28715071
287160         WHEN PC121-INQ (PC121-IDX)                               28716071
287170              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             28717071
287180                                                                  28718071
287190         WHEN PC121-UPD (PC121-IDX)                               28719071
287200              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             28720071
287210                                                                  28721071
287220         WHEN PC121-DEL (PC121-IDX)                               28722071
287230              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             28723071
287240                                                                  28724071
287250         WHEN PC121-ERR (PC121-IDX)                               28725071
287260              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             28726071
287270     END-EVALUATE.                                                28727071
287280                                                                  28728071
287290     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                28729071
287300                                                                  28730071
287310                                                                  28731071
287320*----------------------------------------------------------------*28732071
287330*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *28733071
287340*----------------------------------------------------------------*28734071
287350 6111-WRITE-LIST-QUEUE.                                           28735071
287360     EXEC CICS                                                    28736071
287370         WRITEQ TS                                                28737071
287380             QUEUE (ASC-LIST-QUEUE-NAME)                          28738071
287390             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     28739071
287400             ITEM  (PV-SAVE-ITEM)                                 28740071
287410             REWRITE                                              28741071
287420             RESP  (PV-CICS-RESP)                                 28742071
287430     END-EXEC.                                                    28743071
287440                                                                  28744071
287450     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          28745071
287460         CONTINUE                                                 28746071
287470     ELSE                                                         28747071
287480         SET DP013-CICS-ABEND  TO  TRUE                           28748071
287490         SET DP013-NO-ROLLBACK TO  TRUE                           28749071
287500         MOVE '6111-WRITE-LIST-QUEUE'                             28750071
287510                               TO  DP013-PARAGRAPH                28751071
287520         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  28752071
287530                               TO  DP013-MESSAGE-TEXT(1)          28753071
287540         PERFORM DP013-0000-PROCESS-ABEND                         28754071
287550     END-IF.                                                      28755071
287560                                                                  28756071
287570                                                                  28757071
287580*----------------------------------------------------------------*28758071
287590*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*28759071
287600*----------------------------------------------------------------*28760071
287610 6112-READ-LIST-QUEUE.                                            28761071
287620     EXEC CICS                                                    28762071
287630         READQ TS                                                 28763071
287640             QUEUE (ASC-LIST-QUEUE-NAME)                          28764071
287650             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     28765071
287660             ITEM  (PV-ITEM)                                      28766071
287670             RESP  (PV-CICS-RESP)                                 28767071
287680     END-EXEC.                                                    28768071
287690                                                                  28769071
287700     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          28770071
287710         CONTINUE                                                 28771071
287720     ELSE                                                         28772071
287730         SET DP013-CICS-ABEND        TO TRUE                      28773071
287740         SET DP013-NO-ROLLBACK       TO TRUE                      28774071
287750         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           28775071
287760         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    28776071
287770                                     TO DP013-MESSAGE-TEXT(1)     28777071
287780         PERFORM DP013-0000-PROCESS-ABEND                         28778071
287790     END-IF.                                                      28779071
287800                                                                  28780071
287810                                                                  28781071
287820*----------------------------------------------------------------*28782071
287830*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*28783071
287840*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*28784071
287850*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *28785071
287860*----------------------------------------------------------------*28786071
287870 6120-PROCESS-ITEMS.                                              28787071
287880     COMPUTE PV-ITEM = 1 + ((PC016-ITEM (PC016-IDX) - 1)          28788071
287890                     / PC-ITEMS-PER-PANEL).                       28789071
287900                                                                  28790071
287910     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           28791071
287920         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          28792071
287930             PERFORM 6111-WRITE-LIST-QUEUE                        28793071
287940         END-IF                                                   28794071
287950         MOVE PV-ITEM          TO PV-SAVE-ITEM                    28795071
287960                                                                  28796071
287970         PERFORM 6112-READ-LIST-QUEUE                             28797071
287980         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               28798071
287990             CONTINUE                                             28799071
288000         END-IF                                                   28800071
288010     END-IF.                                                      28801071
288020                                                                  28802071
288030     COMPUTE PV-SUB = (PC016-ITEM (PC016-IDX)                     28803071
288040                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              28804071
288050     SET LQW-DESELECT (PV-SUB) TO    TRUE                         28805071
288060     MOVE LQW-SELECTED-SW (PV-SUB)                                28806071
288070                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  28807071
288080     EVALUATE TRUE                                                28808071
288090         WHEN PC016-INQ (PC016-IDX)                               28809071
288100              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             28810071
288110                                                                  28811071
288120         WHEN PC016-UPD (PC016-IDX)                               28812071
288130              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             28813071
288140                                                                  28814071
288150         WHEN PC016-DEL (PC016-IDX)                               28815071
288160              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             28816071
288170                                                                  28817071
288180         WHEN PC016-ERR (PC016-IDX)                               28818071
288190              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             28819071
288200     END-EVALUATE.                                                28820071
288210                                                                  28821071
288220     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                28822071
288230                                                                  28823071
288240                                                                  28824071
288250*----------------------------------------------------------------*28825071
288260*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*28826071
288270*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*28827071
288280*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *28828071
288290*    DISTRO QUEUE                                                *28829071
288300*----------------------------------------------------------------*28830071
288310 6130-PROCESS-ITEMS.                                              28831071
288320     COMPUTE PV-ITEM = 1 + ((RC013-ITEM (RC013-IDX) - 1)          28832071
288330                     / PC-ITEMS-PER-PANEL).                       28833071
288340                                                                  28834071
288350     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           28835071
288360         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          28836071
288370             PERFORM 6111-WRITE-LIST-QUEUE                        28837071
288380         END-IF                                                   28838071
288390         MOVE PV-ITEM          TO PV-SAVE-ITEM                    28839071
288400                                                                  28840071
288410         PERFORM 6112-READ-LIST-QUEUE                             28841071
288420         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               28842071
288430             CONTINUE                                             28843071
288440         END-IF                                                   28844071
288450     END-IF.                                                      28845071
288460                                                                  28846071
288470     COMPUTE PV-SUB = (RC013-ITEM (RC013-IDX)                     28847071
288480                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              28848071
288490     SET LQW-DESELECT (PV-SUB) TO    TRUE                         28849071
288500     MOVE LQW-SELECTED-SW (PV-SUB)                                28850071
288510                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  28851071
288520     EVALUATE TRUE                                                28852071
288530         WHEN RC013-INQ (RC013-IDX)                               28853071
288540              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             28854071
288550                                                                  28855071
288560         WHEN RC013-UPD (RC013-IDX)                               28856071
288570              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             28857071
288580                                                                  28858071
288590         WHEN RC013-DEL (RC013-IDX)                               28859071
288600              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             28860071
288610                                                                  28861071
288620         WHEN RC013-ERR (RC013-IDX)                               28862071
288630              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             28863071
288640     END-EVALUATE.                                                28864071
288650                                                                  28865071
288660     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                28866071
288670                                                                  28867071
288680                                                                  28868071
288690*----------------------------------------------------------------*28869071
288700*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*28870071
288710*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*28871071
288720*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *28872071
288730*    PREPACK DETAIL LIST QUEUE                                   *28873071
288740*----------------------------------------------------------------*28874071
288750 6140-PROCESS-ITEMS.                                              28875071
288760     COMPUTE PV-ITEM = 1 + ((RC801-ITEM (RC013-IDX) - 1)          28876071
288770                     / PC-ITEMS-PER-PANEL).                       28877071
288780                                                                  28878071
288790     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           28879071
288800         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          28880071
288810             PERFORM 6111-WRITE-LIST-QUEUE                        28881071
288820         END-IF                                                   28882071
288830         MOVE PV-ITEM          TO PV-SAVE-ITEM                    28883071
288840                                                                  28884071
288850         PERFORM 6112-READ-LIST-QUEUE                             28885071
288860         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               28886071
288870             CONTINUE                                             28887071
288880         END-IF                                                   28888071
288890     END-IF.                                                      28889071
288900                                                                  28890071
288910     COMPUTE PV-SUB = (RC801-ITEM (RC013-IDX)                     28891071
288920                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              28892071
288930     SET LQW-DESELECT (PV-SUB) TO    TRUE                         28893071
288940     MOVE LQW-SELECTED-SW (PV-SUB)                                28894071
288950                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  28895071
288960     EVALUATE TRUE                                                28896071
288970         WHEN RC801-INQ (RC801-IDX)                               28897071
288980              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             28898071
288990                                                                  28899071
289000         WHEN RC801-UPD (RC801-IDX)                               28900071
289010              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             28901071
289020                                                                  28902071
289030         WHEN RC801-DEL (RC801-IDX)                               28903071
289040              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             28904071
289050                                                                  28905071
289060         WHEN RC801-ERR (RC801-IDX)                               28906071
289070              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             28907071
289080     END-EVALUATE.                                                28908071
289090                                                                  28909071
289100     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                28910071
289110                                                                  28911071
289120                                                                  28912071
289130*----------------------------------------------------------------*28913071
289140*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*28914071
289150*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*28915071
289160*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *28916071
289170*                                                                *28917071
289180*    THIS QUEUE IS USED FOR THE CARTON ASSIGN LIST               *28918071
289190*----------------------------------------------------------------*28919071
289200 6150-PROCESS-ITEMS.                                              28920071
289210     COMPUTE PV-ITEM = 1 + ((SU004-ITEM (SU004-IDX) - 1)          28921071
289220                     / PC-ITEMS-PER-PANEL).                       28922071
289230                                                                  28923071
289240     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           28924071
289250         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          28925071
289260             PERFORM 6111-WRITE-LIST-QUEUE                        28926071
289270         END-IF                                                   28927071
289280         MOVE PV-ITEM          TO PV-SAVE-ITEM                    28928071
289290                                                                  28929071
289300         PERFORM 6112-READ-LIST-QUEUE                             28930071
289310         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               28931071
289320             CONTINUE                                             28932071
289330         END-IF                                                   28933071
289340     END-IF.                                                      28934071
289350                                                                  28935071
289360     COMPUTE PV-SUB = (SU004-ITEM (SU004-IDX)                     28936071
289370                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              28937071
289380     SET LQW-DESELECT (PV-SUB) TO    TRUE                         28938071
289390     MOVE LQW-SELECTED-SW (PV-SUB)                                28939071
289400                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  28940071
289410     EVALUATE TRUE                                                28941071
289420         WHEN SU004-INQ (SU004-IDX)                               28942071
289430              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             28943071
289440                                                                  28944071
289450         WHEN SU004-UPD (SU004-IDX)                               28945071
289460              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             28946071
289470                                                                  28947071
289480         WHEN SU004-DEL (SU004-IDX)                               28948071
289490              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             28949071
289500                                                                  28950071
289510         WHEN SU004-ERR (SU004-IDX)                               28951071
289520              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             28952071
289530     END-EVALUATE.                                                28953071
289540                                                                  28954071
289550     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                28955071
289560                                                                  28956071
289570                                                                  28957071
289580*----------------------------------------------------------------*28958071
289590* IF CONFIRM (F2) DETERMINE IF LINE BEING PROCESSED IS TO CREATE *28959071
289600* TROUBLE RECORD OR TO CREATE LABELS                             *28960071
289610*----------------------------------------------------------------*28961071
289620 7000-EVALUATE-FOR-TROUBLE.                                       28962071
289630                                                                  28963071
289640     EVALUATE TRUE                                                28964071
289650         WHEN  LQW-DISTRO-ERROR (LQW-IDX)                         28965071
289660         WHEN  LQW-LNE-BAD-INPK-Y(LQW-IDX)                        28966071
289670               PERFORM 7100-CREATE-TROUBLE                        28967071
289680               SET LQW-NO-UPDATE (LQW-IDX) TO TRUE                28968071
289690         WHEN  LQW-UPDATE-OK (LQW-IDX)                            28969071
289700               PERFORM 4630-PRINT-RELEASE-FUNC                    28970071
289710     END-EVALUATE.                                                28971071
289720                                                                  28972071
289730                                                                  28973071
289740*----------------------------------------------------------------*28974071
289750*                                                                *28975071
289760*----------------------------------------------------------------*28976071
289770 7100-CREATE-TROUBLE.                                             28977071
289780                                                                  28978071
289790     SET  TM500-ADD-DETAILS                                       28979071
289800          TM500-CREATE-AUTO        TO TRUE.                       28980071
289810                                                                  28981071
289820     MOVE  LQW-PO-RCVR-LINE (LQW-IDX)                             28982071
289830                                   TO ASC-PO-LINE-NBR.            28983071
289840                                                                  28984071
289850     MOVE PC-TRBL-CODE-525         TO TM500-TRBL-RSN-CDE.         28985071
289860     MOVE ASC-PO-NBR               TO TM500-PO-NBR.               28986071
289870     MOVE ASC-PO-LINE-NBR          TO TM500-PO-LNE-NBR.           28987071
289880     MOVE RECITM-OPER-UNT-ID       TO TM500-OPER-UNT-ID.          28988071
289890     MOVE RECITM-FCLTY-ID          TO TM500-FCLTY-ID.             28989071
289900     MOVE ASC-REC-SEQ-NBR          TO TM500-REC-SEQ-NBR.          28990071
289910     MOVE PC-CURRENT-PROGRAM-NAME  TO TM500-NOTIF-UID.            28991071
289920                                                                  28992071
289930* SET-UP THE TROUBLE DETAIL INFORMATION                           28993071
289940                                                                  28994071
289950     INITIALIZE PV-TROUBLE-DETAIL                                 28995071
289960     MOVE PV-INNER-PACK-QTY        TO PV-DISPLAY-ITM-QTY.         28996071
289970     STRING  '             '          DELIMITED BY SIZE           28997071
289980             ' INNR PACK QTY: '       DELIMITED BY SIZE           28998071
289990             PV-DISPLAY-ITM-QTY       DELIMITED BY SIZE           28999071
290000                                 INTO PV-TROUBLE-DETAIL-1.        29000071
290010                                                                  29001071
290020     MOVE  PV-EXPECTED-ITM-QTY     TO PV-DISPLAY-ITM-QTY          29002071
290030                                                                  29003071
290040     STRING  '             '          DELIMITED BY SIZE           29004071
290050             'UNITS RECEIVED: '       DELIMITED BY SIZE           29005071
290060             PV-DISPLAY-ITM-QTY       DELIMITED BY SIZE           29006071
290070                                 INTO PV-TROUBLE-DETAIL-2.        29007071
290080                                                                  29008071
290090     MOVE PV-DISPLAY-ITEM-QTY      TO PV-DISPLAY-ITM-QTY.         29009071
290100     MOVE PV-DISPLAY-STORE-CNT     TO PV-DISPLAY-STORE-COUNT.     29010071
290110                                                                  29011071
290120     STRING  ' '                        DELIMITED BY SIZE         29012071
290130             PV-DISPLAY-STORE-COUNT     DELIMITED BY SIZE         29013071
290140             ' STORES WITH ORDER QTY: ' DELIMITED BY SIZE         29014071
290150             PV-DISPLAY-ITM-QTY         DELIMITED BY SIZE         29015071
290160                                 INTO PV-TROUBLE-DETAIL-3.        29016071
290170                                                                  29017071
290180                                                                  29018071
290190     EXEC CICS                                                    29019071
290200         LINK PROGRAM  (PC-TROUBLE-WTR)                           29020071
290210              COMMAREA (TM500-FIELDS)                             29021071
290220              LENGTH   (PC-TROUBLE-LENGTH)                        29022071
290230     END-EXEC.                                                    29023071
290240                                                                  29024071
290250                                                                  29025071
290260     EVALUATE TRUE                                                29026071
290270         WHEN TM500-CALL-SUCCESSFUL                               29027071
290280              CONTINUE                                            29028071
290290         WHEN OTHER                                               29029071
290300             MOVE '7100-CREATE-TROUBLE'                           29030071
290310                                      TO DP013-PARAGRAPH          29031071
290320             STRING TM500-RETURN-CODE    DELIMITED BY SIZE        29032071
290330                    ' / '                DELIMITED BY SIZE        29033071
290340                    TM500-RETURN-MSG     DELIMITED BY '  '        29034071
290350                    ' SQLCODE:'          DELIMITED BY SIZE        29035071
290360                    TM500-SQLCODE        DELIMITED BY SIZE        29036071
290370                                    INTO DP013-MESSAGE-TEXT (1)   29037071
290380             MOVE TM500-SQLCA         TO DP013-MESSAGE-TEXT (2)   29038071
290390             SET DP013-OTHER-ABEND                                29039071
290400                 DP013-ROLLBACK    TO TRUE                        29040071
290410             PERFORM DP013-0000-PROCESS-ABEND                     29041071
290420     END-EVALUATE.                                                29042071
290430                                                                  29043071
290440     MOVE 'PRPK'      TO  LQW-LINE-STATUS (LQW-IDX).              29044071
290450                                                                  29045071
290460                                                                  29046071
290470*----------------------------------------------------------------*29047071
290480* LABEL CALCULATION MODULE - WHEN USING UCC128 DATA              *29048071
290490*----------------------------------------------------------------*29049071
290500 7300-UCC128-LBL-CNT.                                             29050071
290510                                                                  29051071
290520     MOVE ASC-PO-NBR                    TO DK-PO-NBR.             29052071
290530     MOVE ASC-REC-SEQ-NBR               TO DK-REC-SEQ-NBR.        29053071
290540     MOVE ASC-PO-LNE-NBR                                          29054071
290550          (ASC-BLK-SUB ASC-ITEM-SUB)    TO DK-LINE-NBR.           29055071
290560                                                                  29056071
290570     INITIALIZE PC166-COMMAREA-REC.                               29057071
290580                                                                  29058071
290590     SET  PC166-FUNC-LBL-CALC           TO TRUE.                  29059071
290600                                                                  29060071
290610     MOVE ASC-PO-NBR                    TO PC166-PO-NBR.          29061071
290620     MOVE ASC-REC-SEQ-NBR               TO PC166-RCVR-SEQ-NBR.    29062071
290630     MOVE ASC-PO-LNE-NBR                                          29063071
290640          (ASC-BLK-SUB ASC-ITEM-SUB)    TO PC166-PO-LNE-NBR.      29064071
290650     MOVE ASC-OPER-UNT-ID               TO PC166-OPER-UNT-ID.     29065071
290660     MOVE COCNTL-SSCC-18-IND            TO PC166-SSCC-18-IND.     29066071
290670     MOVE ASC-LBL-TYP                                             29067071
290680          (ASC-BLK-SUB ASC-ITEM-SUB)    TO PC166-SHIP-LABEL-TYPE. 29068071
290690     MOVE ASC-LBL-PRT-ORDER             TO PC166-PRT-SEQ          29069071
290700                                                                  29070071
290800     MOVE ASC-LNE-CRE-LBL-OPT                                     29080071
290810          (ASC-BLK-SUB ASC-ITEM-SUB)    TO PC166-CASEPACK-FUNCTION29081071
290820                                                                  29082071
290830     IF ASC-SPEC-INST-DESC = SPACES                               29083071
290840        MOVE ASC-DFLT-STR-ZN-ID         TO PC166-STR-ZNE          29084071
290850     ELSE                                                         29085071
290860        MOVE ASC-SPEC-INST-DESC         TO PC166-STR-ZNE          29086071
290870     END-IF.                                                      29087071
290880     MOVE ASC-DPT-NBR                   TO PC166-DEPT-NBR.        29088071
290890     MOVE ASC-SKU                                                 29089071
290900          (ASC-BLK-SUB ASC-ITEM-SUB)    TO PC166-SKU.             29090071
290910     MOVE ASC-SUBCLASS                                            29091071
290920          (ASC-BLK-SUB ASC-ITEM-SUB)    TO PC166-CL-NBR.          29092071
290930     MOVE PV-VEND-STYL-NAME             TO PC166-VENDOR-STYLE.    29093071
290940     MOVE ZEROES                        TO PC166-FCSE-LBL-CNT     29094071
290950                                           PC166-INPK-LBL-CNT     29095071
290960                                           PC166-P2L-LBL-CNT      29096071
290970                                           PC166-CS-BOUND-UNTS    29097071
290980                                           PC166-DC-BOUND-UNTS    29098071
290990                                           PC166-RTV-BOUND-UNTS   29099071
291000                                           PC166-CS-BOUND-CTNS.   29100071
291010     MOVE ASC-CARTON-COUNT (ASC-BLK-SUB ASC-ITEM-SUB)             29101071
291020                                        TO PC166-TOTAL-CARTONS.   29102071
291030     IF  ASC-LNE-CRE-P2L-LBL (ASC-BLK-SUB ASC-ITEM-SUB)           29103071
291040         MOVE ZEROES                    TO PC166-OTPK-UNT-QTY     29104071
291050     ELSE                                                         29105071
291060         MOVE ASC-OUTER-PACK-QTY                                  29106071
291070              (ASC-BLK-SUB ASC-ITEM-SUB) TO PC166-OTPK-UNT-QTY    29107071
291080     END-IF.                                                      29108071
291090     MOVE ASC-INNER-PACK-QTY                                      29109071
291100          (ASC-BLK-SUB ASC-ITEM-SUB)    TO PC166-INPK-UNT-QTY.    29110071
291110     MOVE ASC-MODULE (ASC-BLK-SUB ASC-ITEM-SUB)                   29111071
291120                                        TO PC166-MOD-NBR.         29112071
291130     MOVE PC-CURRENT-PROGRAM-NAME       TO PC166-CALLING-PGM-NME. 29113071
291140                                                                  29114071
291150     MOVE ASC-PKGNG-CD                  TO PC166-PKGNG-CD.        29115071
291160     MOVE ASC-PREPK-ID (ASC-BLK-SUB ASC-ITEM-SUB)                 29116071
291170                                        TO PC166-PREPK-ID.        29117071
291180     MOVE ASC-PREPK-RATIO (ASC-BLK-SUB ASC-ITEM-SUB)              29118071
291190                                        TO PC166-PREPK-RATIO.     29119071
291200     MOVE ASC-PACKS-IN-CRTN (ASC-BLK-SUB ASC-ITEM-SUB)            29120071
291210                                        TO PC166-PACKS-IN-CRTN.   29121071
291220     MOVE PV-USER-ID                    TO PC166-USER-ID.         29122071
291230                                                                  29123071
291240     MOVE ZEROES                        TO PC166-ITEM-NBR         29124071
291250                                           PC166-TOT-PREPK-UNTS.  29125071
291260     MOVE ASC-IN-PAK-CONVEY (ASC-BLK-SUB ASC-ITEM-SUB)            29126071
291270                                        TO PC166-INPK-CNVY-IND.   29127071
291280     MOVE ASC-SPEC-INST-DESC            TO  PC166-SPEC-INST-DESC. 29128071
291290     MOVE ASC-LNE-FCSE-AREA (ASC-BLK-SUB ASC-ITEM-SUB)            29129071
291300                                        TO  PC166-FCSE-AREA.      29130071
291310     MOVE ASC-PROCESS-QTY   (ASC-BLK-SUB ASC-ITEM-SUB)            29131071
291320                                        TO  PC166-PRCS-QTY.       29132071
291330                                                                  29133071
291340     IF  ASC-TRIP-ARRIVE-CCYY  =  9999                            29134071
291350         MOVE 99  TO  ASC-TRIP-ARRIVE-MM                          29135071
291360         MOVE 99  TO  ASC-TRIP-ARRIVE-DD                          29136071
291370     END-IF                                                       29137071
291371                                                                  29137171
291372     MOVE ASC-TRIP-ARRIVE-DATE       TO PC166-TRIP-ARRIVE-DATE.   29137271
291373                                                                  29137371
291374     IF      PS-DISPLAY-CSSL-YES                                  29137471
291375         INITIALIZE      PV-CICS-MSG-AREA2                        29137571
291376         MOVE DP020-SRC-TASK-NUMBER      TO  PV-DISPLAY-TASK-NBR  29137671
291377         MOVE ASC-PO-NBR             TO  PV-DISPLAY-PO-NBR        29137771
291378         MOVE ASC-REC-SEQ-NBR        TO  PV-DISPLAY-RCVR-SEQ-NBR  29137871
291379         MOVE DP020-LOCATION-NBR     TO  PV-DISPLAY-OPER          29137971
291380         STRING      ' PCKCS701-'                                 29138071
291390                 PV-DISPLAY-OPER                                  29139071
291400                 ' TERM-'                                         29140071
291410                 DP020-TERM-ID                                    29141071
291420                 ' USER-'                                         29142071
291430                 DP020-USERID                                     29143071
291440                 ' TASK-'                                         29144071
291450                 PV-DISPLAY-TASK-NBR                              29145071
291460                 ' PO-'                                           29146071
291470                 PV-DISPLAY-PO-NBR                                29147071
291480                 '-'                                              29148071
291490                 PV-DISPLAY-RCVR-SEQ-NBR                          29149071
291500                 '-'                                              29150071
291510                 PC166-PO-LNE-NBR                                 29151071
291520                 ' BEFORE PCKCS719 CALC'  DELIMITED BY SIZE       29152071
291530                                      INTO PV-CICS-MSG-AREA2      29153071
291540         MOVE LENGTH OF PV-CICS-MSG-AREA2                         29154071
291550           TO PV-COMMAREA-LENGTH                                  29155071
291560         EXEC CICS                                                29156071
291570              WRITEQ TD                                           29157071
291580               QUEUE      ('CSSL')                                29158071
291590                FROM      (PV-CICS-MSG-AREA2)                     29159071
291600              LENGTH      (PV-COMMAREA-LENGTH)                    29160071
291610                RESP      (PV-CICS-RESP)                          29161071
291620         END-EXEC                                                 29162071
291630     END-IF.                                                      29163071
291640                                                                  29164071
291650     MOVE LENGTH OF PC166-COMMAREA-REC  TO PV-COMMAREA-LENGTH.    29165071
291660                                                                  29166071
291670     EXEC CICS                                                    29167071
291680         LINK                                                     29168071
291690             PROGRAM   (PC-UCC128-LBL-CALC)                       29169071
291700             COMMAREA  (PC166-COMMAREA-REC)                       29170071
291710             LENGTH    (PV-COMMAREA-LENGTH)                       29171071
291720             RESP      (PV-CICS-RESP)                             29172071
291730     END-EXEC.                                                    29173071
291740                                                                  29174071
291750     EVALUATE TRUE                                                29175071
291760         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     29176071
291770             PERFORM 7310-VALIDATE-LBL-CALC-CALL                  29177071
291780         WHEN OTHER                                               29178071
291790              MOVE PV-CICS-RESP  TO  PV-CICS-RESP-DISPLAY         29179071
291800              STRING ' PCKCS701 - '          DELIMITED BY SIZE    29180071
291810                     '7300-UCC128-LBL-CNT '  DELIMITED BY SIZE    29181071
291820                     '-LINK RESPONSE - '     DELIMITED BY SIZE    29182071
291830                     PV-CICS-RESP-DISPLAY    DELIMITED BY SIZE    29183071
291840                INTO PV-CICS-MSG-DATA                             29184071
291850                MOVE PV-CICS-MSG-HOLD                             29185071
291860                  TO PV-CICS-MSG-AREA                             29186071
291870                MOVE LENGTH OF PV-CICS-MSG-AREA                   29187071
291880                  TO PV-COMMAREA-LENGTH                           29188071
291890             EXEC CICS                                            29189071
291900                 WRITEQ TD                                        29190071
291910                     QUEUE   ('CSSL')                             29191071
291920                     FROM    (PV-CICS-MSG-AREA)                   29192071
291930                     LENGTH  (PV-COMMAREA-LENGTH)                 29193071
291940                     RESP    (PV-CICS-RESP)                       29194071
291950             END-EXEC                                             29195071
291960             MOVE PC-TSYMSG-02519  TO DP020-MSG-NUMBER            29196071
291970             PERFORM 9900-SOFT-ABORT                              29197071
291980     END-EVALUATE.                                                29198071
291990                                                                  29199071
292000     IF      PS-DISPLAY-CSSL-YES                                  29200071
292010         INITIALIZE      PV-CICS-MSG-AREA2                        29201071
292020         MOVE DP020-SRC-TASK-NUMBER      TO  PV-DISPLAY-TASK-NBR  29202071
292030         MOVE ASC-PO-NBR             TO  PV-DISPLAY-PO-NBR        29203071
292040         MOVE ASC-REC-SEQ-NBR        TO  PV-DISPLAY-RCVR-SEQ-NBR  29204071
292050         MOVE DP020-LOCATION-NBR     TO  PV-DISPLAY-OPER          29205071
292060         STRING      ' PCKCS701-'                                 29206071
292070                 PV-DISPLAY-OPER                                  29207071
292080                 ' TERM-'                                         29208071
292090                 DP020-TERM-ID                                    29209071
292100                 ' USER-'                                         29210071
292110                 DP020-USERID                                     29211071
292120                 ' TASK-'                                         29212071
292130                 PV-DISPLAY-TASK-NBR                              29213071
292140                 ' PO-'                                           29214071
292150                 PV-DISPLAY-PO-NBR                                29215071
292160                 '-'                                              29216071
292170                 PV-DISPLAY-RCVR-SEQ-NBR                          29217071
292180                 '-'                                              29218071
292190                 PC166-PO-LNE-NBR                                 29219071
292200                 ' AFTER  PCKCS719 CALC'   DELIMITED BY SIZE      29220071
292210                                      INTO PV-CICS-MSG-AREA2      29221071
292220         MOVE LENGTH OF PV-CICS-MSG-AREA2                         29222071
292230           TO PV-COMMAREA-LENGTH                                  29223071
292240         EXEC CICS                                                29224071
292250              WRITEQ TD                                           29225071
292260               QUEUE      ('CSSL')                                29226071
292270                FROM      (PV-CICS-MSG-AREA2)                     29227071
292280              LENGTH      (PV-COMMAREA-LENGTH)                    29228071
292290                RESP      (PV-CICS-RESP)                          29229071
292300         END-EXEC                                                 29230071
292310     END-IF.                                                      29231071
292320                                                                  29232071
292330                                                                  29233071
292340*----------------------------------------------------------------*29234071
292350* LABEL CALCULATION MODULE - WHEN USING UCC128 DATA              *29235071
292360* LQW AREA - AFTER DELETE                                        *29236071
292370*----------------------------------------------------------------*29237071
292380 7305-UCC128-LBL-CNT.                                             29238071
292390                                                                  29239071
292400     MOVE ASC-PO-NBR                    TO DK-PO-NBR.             29240071
292410     MOVE ASC-REC-SEQ-NBR               TO DK-REC-SEQ-NBR.        29241071
292420     MOVE LQW-PO-RCVR-LINE (LQW-IDX)    TO DK-LINE-NBR.           29242071
292430                                                                  29243071
292440     INITIALIZE PC166-COMMAREA-REC.                               29244071
292450                                                                  29245071
292460     SET  PC166-FUNC-LBL-CALC           TO TRUE.                  29246071
292470                                                                  29247071
292480     MOVE ASC-PO-NBR                    TO PC166-PO-NBR.          29248071
292490     MOVE ASC-REC-SEQ-NBR               TO PC166-RCVR-SEQ-NBR.    29249071
292500     MOVE LQW-PO-RCVR-LINE (LQW-IDX)    TO PC166-PO-LNE-NBR.      29250071
292510     MOVE ASC-OPER-UNT-ID               TO PC166-OPER-UNT-ID.     29251071
292520     MOVE COCNTL-SSCC-18-IND            TO PC166-SSCC-18-IND.     29252071
292530     MOVE LQW-LABEL-TYPE (LQW-IDX)      TO PC166-SHIP-LABEL-TYPE. 29253071
292540     MOVE ASC-LBL-PRT-ORDER             TO PC166-PRT-SEQ          29254071
292550                                                                  29255071
292560     MOVE LQW-LNE-CRE-LBL-OPT (LQW-IDX) TO PC166-CASEPACK-FUNCTION29256071
292570                                                                  29257071
292580     IF ASC-SPEC-INST-DESC = SPACES                               29258071
292590        MOVE ASC-DFLT-STR-ZN-ID         TO PC166-STR-ZNE          29259071
292600     ELSE                                                         29260071
292700        MOVE ASC-SPEC-INST-DESC         TO PC166-STR-ZNE          29270071
292710     END-IF.                                                      29271071
292720     MOVE ASC-DPT-NBR                   TO PC166-DEPT-NBR.        29272071
292730     MOVE LQW-SKU (LQW-IDX)             TO PV-SKU.                29273071
292740     MOVE LQW-SUBCLASS (LQW-IDX)        TO PC166-CL-NBR.          29274071
292750     MOVE PV-VEND-STYL-NAME             TO PC166-VENDOR-STYLE.    29275071
292760     MOVE ZEROES                        TO PC166-FCSE-LBL-CNT     29276071
292770                                           PC166-INPK-LBL-CNT     29277071
292780                                           PC166-P2L-LBL-CNT      29278071
292790                                           PC166-CS-BOUND-UNTS    29279071
292800                                           PC166-DC-BOUND-UNTS    29280071
292810                                           PC166-RTV-BOUND-UNTS   29281071
292820                                           PC166-CS-BOUND-CTNS.   29282071
292830     MOVE LQW-CARTON-CNT (LQW-IDX)      TO PC166-TOTAL-CARTONS.   29283071
292840     IF  LQW-LNE-CRE-P2L-LBL (LQW-IDX)                            29284071
292850         MOVE ZEROES                    TO PC166-OTPK-UNT-QTY     29285071
292860     ELSE                                                         29286071
292870         MOVE LQW-OUTER-PACK (LQW-IDX)  TO PC166-OTPK-UNT-QTY     29287071
292880     END-IF.                                                      29288071
292890     MOVE LQW-INNER-PACK (LQW-IDX)      TO PC166-INPK-UNT-QTY.    29289071
292900     MOVE LQW-MODULE (LQW-IDX)          TO PC166-MOD-NBR.         29290071
292910     MOVE PC-CURRENT-PROGRAM-NAME       TO PC166-CALLING-PGM-NME. 29291071
292920                                                                  29292071
292930     MOVE ASC-PKGNG-CD                  TO PC166-PKGNG-CD.        29293071
292940     MOVE LQW-PREPK-ID (LQW-IDX)        TO PC166-PREPK-ID.        29294071
292950     MOVE LQW-PREPK-RATIO (LQW-IDX)     TO PC166-PREPK-RATIO.     29295071
292960     MOVE LQW-PACKS-IN-CRTN (LQW-IDX)   TO PC166-PACKS-IN-CRTN.   29296071
292970     MOVE PV-USER-ID                    TO PC166-USER-ID.         29297071
292980                                                                  29298071
292990     MOVE ZEROES                        TO PC166-ITEM-NBR         29299071
293000                                           PC166-TOT-PREPK-UNTS.  29300071
293010     MOVE LQW-IN-PACK-CONVY (LQW-IDX)   TO PC166-INPK-CNVY-IND.   29301071
293020     MOVE ASC-SPEC-INST-DESC            TO  PC166-SPEC-INST-DESC. 29302071
293030     MOVE LQW-LNE-FCSE-AREA (LQW-IDX)   TO  PC166-FCSE-AREA.      29303071
293040     MOVE LQW-PROCESS-QTY (LQW-IDX)     TO  PC166-PRCS-QTY.       29304071
293050                                                                  29305071
293060     IF  ASC-TRIP-ARRIVE-CCYY  =  9999                            29306071
293061         MOVE 99  TO  ASC-TRIP-ARRIVE-MM                          29306171
293062         MOVE 99  TO  ASC-TRIP-ARRIVE-DD                          29306271
293063     END-IF                                                       29306371
293064                                                                  29306471
293065     MOVE ASC-TRIP-ARRIVE-DATE       TO PC166-TRIP-ARRIVE-DATE.   29306571
293066                                                                  29306671
293067     IF      PS-DISPLAY-CSSL-YES                                  29306771
293068         INITIALIZE      PV-CICS-MSG-AREA2                        29306871
293069         MOVE DP020-SRC-TASK-NUMBER      TO  PV-DISPLAY-TASK-NBR  29306971
293070         MOVE ASC-PO-NBR             TO  PV-DISPLAY-PO-NBR        29307071
293071         MOVE ASC-REC-SEQ-NBR        TO  PV-DISPLAY-RCVR-SEQ-NBR  29307171
293072         MOVE DP020-LOCATION-NBR     TO  PV-DISPLAY-OPER          29307271
293073         STRING      ' PCKCS701-'                                 29307371
293074                 PV-DISPLAY-OPER                                  29307471
293075                 ' TERM-'                                         29307571
293076                 DP020-TERM-ID                                    29307671
293077                 ' USER-'                                         29307771
293078                 DP020-USERID                                     29307871
293079                 ' TASK-'                                         29307971
293080                 PV-DISPLAY-TASK-NBR                              29308071
293090                 ' PO-'                                           29309071
293100                 PV-DISPLAY-PO-NBR                                29310071
293110                 '-'                                              29311071
293120                 PV-DISPLAY-RCVR-SEQ-NBR                          29312071
293130                 '-'                                              29313071
293140                 PC166-PO-LNE-NBR                                 29314071
293150                 ' BEF PCKCS719 DEL CALC'  DELIMITED BY SIZE      29315071
293160                                      INTO PV-CICS-MSG-AREA2      29316071
293170         MOVE LENGTH OF PV-CICS-MSG-AREA2                         29317071
293180           TO PV-COMMAREA-LENGTH                                  29318071
293190         EXEC CICS                                                29319071
293200              WRITEQ TD                                           29320071
293210               QUEUE      ('CSSL')                                29321071
293220                FROM      (PV-CICS-MSG-AREA2)                     29322071
293230              LENGTH      (PV-COMMAREA-LENGTH)                    29323071
293240                RESP      (PV-CICS-RESP)                          29324071
293250         END-EXEC                                                 29325071
293260     END-IF.                                                      29326071
293270                                                                  29327071
293280     MOVE LENGTH OF PC166-COMMAREA-REC  TO PV-COMMAREA-LENGTH.    29328071
293290                                                                  29329071
293300     EXEC CICS                                                    29330071
293310         LINK                                                     29331071
293320             PROGRAM   (PC-UCC128-LBL-CALC)                       29332071
293330             COMMAREA  (PC166-COMMAREA-REC)                       29333071
293340             LENGTH    (PV-COMMAREA-LENGTH)                       29334071
293350             RESP      (PV-CICS-RESP)                             29335071
293360     END-EXEC.                                                    29336071
293370                                                                  29337071
293380     EVALUATE TRUE                                                29338071
293390         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     29339071
293400             PERFORM 7315-VALIDATE-LBL-CALC-CALL                  29340071
293410         WHEN OTHER                                               29341071
293420              MOVE PV-CICS-RESP  TO  PV-CICS-RESP-DISPLAY         29342071
293430              STRING ' PCKCS701 - '          DELIMITED BY SIZE    29343071
293440                     '7305-UCC128-LBL-CNT '  DELIMITED BY SIZE    29344071
293450                     '-LINK RESPONSE - '     DELIMITED BY SIZE    29345071
293460                     PV-CICS-RESP-DISPLAY    DELIMITED BY SIZE    29346071
293470                INTO PV-CICS-MSG-DATA                             29347071
293480                MOVE PV-CICS-MSG-HOLD                             29348071
293490                  TO PV-CICS-MSG-AREA                             29349071
293500                MOVE LENGTH OF PV-CICS-MSG-AREA                   29350071
293510                  TO PV-COMMAREA-LENGTH                           29351071
293520             EXEC CICS                                            29352071
293530                 WRITEQ TD                                        29353071
293540                     QUEUE   ('CSSL')                             29354071
293550                     FROM    (PV-CICS-MSG-AREA)                   29355071
293560                     LENGTH  (PV-COMMAREA-LENGTH)                 29356071
293570                     RESP    (PV-CICS-RESP)                       29357071
293580             END-EXEC                                             29358071
293590             MOVE PC-TSYMSG-02519  TO DP020-MSG-NUMBER            29359071
293600             PERFORM 9900-SOFT-ABORT                              29360071
293610     END-EVALUATE.                                                29361071
293620                                                                  29362071
293630     IF      PS-DISPLAY-CSSL-YES                                  29363071
293640         INITIALIZE      PV-CICS-MSG-AREA2                        29364071
293650         MOVE DP020-SRC-TASK-NUMBER      TO  PV-DISPLAY-TASK-NBR  29365071
293660         MOVE ASC-PO-NBR             TO  PV-DISPLAY-PO-NBR        29366071
293670         MOVE ASC-REC-SEQ-NBR        TO  PV-DISPLAY-RCVR-SEQ-NBR  29367071
293680         MOVE DP020-LOCATION-NBR     TO  PV-DISPLAY-OPER          29368071
293690         STRING      ' PCKCS701-'                                 29369071
293700                 PV-DISPLAY-OPER                                  29370071
293710                 ' TERM-'                                         29371071
293720                 DP020-TERM-ID                                    29372071
293730                 ' USER-'                                         29373071
293740                 DP020-USERID                                     29374071
293750                 ' TASK-'                                         29375071
293760                 PV-DISPLAY-TASK-NBR                              29376071
293770                 ' PO-'                                           29377071
293780                 PV-DISPLAY-PO-NBR                                29378071
293790                 '-'                                              29379071
293800                 PV-DISPLAY-RCVR-SEQ-NBR                          29380071
293810                 '-'                                              29381071
293820                 PC166-PO-LNE-NBR                                 29382071
293830                 ' AFT PCKCS719 DEL CALC'  DELIMITED BY SIZE      29383071
293840                                      INTO PV-CICS-MSG-AREA2      29384071
293850         MOVE LENGTH OF PV-CICS-MSG-AREA2                         29385071
293860           TO PV-COMMAREA-LENGTH                                  29386071
293870         EXEC CICS                                                29387071
293880              WRITEQ TD                                           29388071
293890               QUEUE      ('CSSL')                                29389071
293900                FROM      (PV-CICS-MSG-AREA2)                     29390071
293910              LENGTH      (PV-COMMAREA-LENGTH)                    29391071
293920                RESP      (PV-CICS-RESP)                          29392071
293930         END-EXEC                                                 29393071
293940     END-IF.                                                      29394071
293950                                                                  29395071
293960*----------------------------------------------------------------*29396071
293970* CHECK RETURN CODE FROM UCC128 LBL CALCULATION - IF SUCCESSFUL  *29397071
293980*----------------------------------------------------------------*29398071
293990 7310-VALIDATE-LBL-CALC-CALL.                                     29399071
294000                                                                  29400071
294010     SET  ASC-BLOCK-MODIFIED (ASC-BLK-SUB)  TO  TRUE.             29401071
294020                                                                  29402071
294030     SET  LQW-LBL-TYP-UCC128 (LQW-IDX) TO TRUE.                   29403071
294040                                                                  29404071
294050     IF  ASC-PRE-PACK-ORDER                                       29405071
294060         IF  PC166-PREPK-UCC128-YES                               29406071
294070             SET  ASC-LNE-UCC128-YES                              29407071
294080                   (ASC-BLK-SUB ASC-ITEM-SUB)  TO TRUE            29408071
294090         ELSE                                                     29409071
294100             SET  ASC-LNE-UCC128-NO                               29410071
294110                   (ASC-BLK-SUB ASC-ITEM-SUB)  TO TRUE            29411071
294120                                                                  29412071
294130             SET  ASC-UCC128-USABLE-NO                            29413071
294140                   (ASC-BLK-SUB ASC-ITEM-SUB)  TO TRUE            29414071
294150                                                                  29415071
294160         END-IF                                                   29416071
294170     END-IF.                                                      29417071
294180                                                                  29418071
294190     ADD  PC166-FCSE-LBL-CNT                                      29419071
294200          PC166-INPK-LBL-CNT                                      29420071
294300          GIVING  PV-SHIP-LNE-TOTAL                               29430071
294310     MOVE PC166-FCSE-LBL-CNT                                      29431071
294320       TO PV-FULL-CASE-SHIP-TOTAL                                 29432071
294330          ASC-SML-FCSE-LBL-CNT (ASC-BLK-SUB ASC-ITEM-SUB)         29433071
294340     MOVE PC166-INPK-LBL-CNT                                      29434071
294350       TO PV-INPK-SHIP-LNE-TOTAL                                  29435071
294360          ASC-SML-INPK-LBL-CNT (ASC-BLK-SUB ASC-ITEM-SUB)         29436071
294370     MOVE PC166-P2L-LBL-CNT                                       29437071
294380       TO PV-P2L-LNE-TOTAL                                        29438071
294390          ASC-P2L-LABEL-CNT (ASC-BLK-SUB ASC-ITEM-SUB)            29439071
294400     MOVE PC166-CS-BOUND-UNTS                                     29440071
294410       TO ASC-CS-BOUND-UNTS (ASC-BLK-SUB ASC-ITEM-SUB)            29441071
294420     MOVE PC166-DC-BOUND-UNTS                                     29442071
294430       TO ASC-DC-BOUND-UNTS (ASC-BLK-SUB ASC-ITEM-SUB)            29443071
294440     MOVE PC166-RTV-BOUND-UNTS                                    29444071
294450       TO ASC-RTV-BOUND-UNTS (ASC-BLK-SUB ASC-ITEM-SUB)           29445071
294460     MOVE PC166-CS-BOUND-CTNS                                     29446071
294470       TO ASC-CS-BOUND-CTNS (ASC-BLK-SUB ASC-ITEM-SUB)            29447071
294480     MOVE PC166-TOTAL-CARTONS                                     29448071
294490       TO ASC-CARTON-COUNT (ASC-BLK-SUB ASC-ITEM-SUB)             29449071
294500                                                                  29450071
294510     IF  ASC-CARTON-COUNT (ASC-BLK-SUB ASC-ITEM-SUB)  = 0         29451071
294520         MOVE  ZEROES                                             29452071
294530           TO  ASC-PROCESS-QTY (ASC-BLK-SUB ASC-ITEM-SUB)         29453071
294540         IF  ASC-QTY-ERROR-YES(ASC-BLK-SUB ASC-ITEM-SUB)          29454071
294550             SET  ASC-NO-LINE-ERROR (ASC-BLK-SUB ASC-ITEM-SUB)    29455071
294560                  TO  TRUE                                        29456071
294570         END-IF                                                   29457071
294580     END-IF.                                                      29458071
294590                                                                  29459071
294600     IF  PC166-MULT-OTPK                                          29460071
294610         SET  ASC-MLT-OTPK-UCC128                                 29461071
294620              (ASC-BLK-SUB ASC-ITEM-SUB) TO  TRUE                 29462071
294630     ELSE                                                         29463071
294640         MOVE PC166-OTPK-UNT-QTY                                  29464071
294650           TO ASC-OUTER-PACK-QTY                                  29465071
294660              (ASC-BLK-SUB ASC-ITEM-SUB)                          29466071
294670     END-IF.                                                      29467071
294680                                                                  29468071
294690     IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)                    29469071
294700         IF  PC166-ERR-OTPK-BY-INPK                               29470071
294710             SET  ASC-LNE-BAD-INPK-Y  (ASC-BLK-SUB ASC-ITEM-SUB)  29471071
294720                  ASC-INVALID-INPK-YES  TO  TRUE                  29472071
294730         ELSE                                                     29473071
294740         IF  PC166-ERR-INVALID-OTPK                               29474071
294750             SET  ASC-LNE-BAD-OTPK-Y  (ASC-BLK-SUB ASC-ITEM-SUB)  29475071
294760              ASC-INVALID-OTPK-YES  TO  TRUE                      29476071
294770         ELSE                                                     29477071
294780         IF  PC166-ERR-LNES-NOT-PRPK                              29478071
294790             SET  ASC-LNE-BAD-OTPK-Y (ASC-BLK-SUB ASC-ITEM-SUB)   29479071
294800                  ASC-INVALID-OTPK-YES  TO  TRUE                  29480071
294810         ELSE                                                     29481071
294820                                                                  29482071
294830         IF  PC166-ERR-DC-RTV-NOT-OTPK                            29483071
294840             SET  ASC-LNE-DC-RTV-OTPK (ASC-BLK-Sub asc-item-sub)  29484071
294850                  ASC-INVALID-DV-RTV-OTPK  TO  TRUE               29485071
294860         END-IF                                                   29486071
294870                                                                  29487071
294880         END-IF                                                   29488071
294890         END-IF                                                   29489071
294900         END-IF                                                   29490071
294910     END-IF.                                                      29491071
294920                                                                  29492071
294930     IF  ASC-LNE-CRE-SML-LBL (ASC-BLK-SUB ASC-ITEM-SUB) AND       29493071
294940         ASC-P2L-LABEL-CNT (ASC-BLK-SUB ASC-ITEM-SUB) > 0         29494071
294950         SET  ASC-INVALID-OTPK-YES                                29495071
294960              ASC-LNE-BAD-OTPK-Y (ASC-BLK-SUB ASC-ITEM-SUB)       29496071
294970              TO  TRUE                                            29497071
294980     END-IF.                                                      29498071
294990                                                                  29499071
295000                                                                  29500071
295010* OUTER PACK                                                      29501071
295020     IF  ASC-LNE-UCC128-NO (ASC-BLK-SUB ASC-ITEM-SUB)             29502071
295030         IF  ASC-OTPK-UNT-QTY  >  +0                              29503071
295040             MOVE  ASC-OTPK-UNT-QTY  TO  ASC-OUTER-PACK-QTY       29504071
295050                                       (ASC-BLK-SUB ASC-ITEM-SUB) 29505071
295060             SET  PS-OUTER-PK-FROM-CRIT  TO  TRUE                 29506071
295070         ELSE                                                     29507071
295080             COMPUTE ASC-OUTER-PACK-QTY (ASC-BLK-SUB ASC-ITEM-SUB)29508071
295090                  =  RECITM-CASE-PACK-QTY  *                      29509071
295100                     RECITM-PREPK-RATO-QTY                        29510071
295110         END-IF                                                   29511071
295120                                                                  29512071
295130* CARTON COUNT                                                    29513071
295140         IF  ASC-CART-CNT  >  +0                                  29514071
295150             MOVE ASC-CART-CNT     TO  ASC-CARTON-COUNT           29515071
295160                                       (ASC-BLK-SUB ASC-ITEM-SUB) 29516071
295170         ELSE                                                     29517071
295180             MOVE ZEROES           TO  ASC-CARTON-COUNT           29518071
295190                                       (ASC-BLK-SUB ASC-ITEM-SUB) 29519071
295200         END-IF                                                   29520071
295210                                                                  29521071
295220         IF  ASC-LNE-CRE-P2L-LBL (ASC-BLK-SUB ASC-ITEM-SUB) OR    29522071
295230             ASC-PROTECTED (ASC-BLK-SUB ASC-ITEM-SUB)             29523071
295240             CONTINUE                                             29524071
295250         ELSE                                                     29525071
295260         IF  ASC-TRANSCRIBE-QTY(ASC-BLK-SUB ASC-ITEM-SUB) > +0 AND29526071
295270             ASC-OUTER-PACK-QTY(ASC-BLK-SUB ASC-ITEM-SUB) > +0 AND29527071
295280             ASC-CARTON-COUNT (ASC-BLK-SUB ASC-ITEM-SUB)  = +0    29528071
295290             PERFORM 4312-CALC-CARTON-CNT                         29529071
295300         END-IF                                                   29530071
295310         END-IF                                                   29531071
295320         PERFORM 4345-GET-LABEL-COUNT                             29532071
295330                                                                  29533071
295340* LABEL TYPE                                                      29534071
295350                                                                  29535071
295360         IF  PS-DISTHD-RECORD-FOUND                               29536071
295370             IF  DISTHD-PRC-AREA-MODU-ID  =  SPACES  AND          29537071
295380                 DISTHD-TOT-CART-CNT      =  ZEROES  AND          29538071
295390                 DISTHD-P2L-CART-CNT      =  ZEROES  AND          29539071
295400                 DISTHD-FCSE-CART-CNT     =  ZEROES  AND          29540071
295410                 DISTHD-INPK-CART-CNT     =  ZEROES               29541071
295420                 IF  ASC-DO-NOT-PRINT-SML OR                      29542071
295430                     ASC-DO-NOT-PRINT-PGYBK                       29543071
295440                     SET  ASC-LNE-DO-NOT-PRT-LBL                  29544071
295450                          (ASC-BLK-SUB ASC-ITEM-SUB)  TO TRUE     29545071
295460                 ELSE                                             29546071
295470                 IF  ASC-LNE-CRE-P2L-LBL(ASC-BLK-SUB ASC-ITEM-SUB)29547071
295480                     SET  ASC-LBL-TYP-NONE                        29548071
295490                          (ASC-BLK-SUB ASC-ITEM-SUB)  TO TRUE     29549071
295500                 ELSE                                             29550071
295510                 IF  ASC-PGYBCK-PRTR-ID  >  SPACES  AND           29551071
295520                     ASC-LBL-PRT-STR-ORD                          29552071
295530                     SET  ASC-LBL-TYP-PGYBK                       29553071
295540                          (ASC-BLK-SUB ASC-ITEM-SUB)              29554071
295550                          ASC-CRE-LBL-UPDT                        29555071
295560                          (ASC-BLK-SUB ASC-ITEM-SUB)  TO TRUE     29556071
295570                 ELSE                                             29557071
295580                     SET ASC-LBL-TYP-SML                          29558071
295590                         (ASC-BLK-SUB ASC-ITEM-SUB)               29559071
295600                         ASC-CRE-LBL-UPDT                         29560071
295610                         (ASC-BLK-SUB ASC-ITEM-SUB)  TO  TRUE     29561071
295620                 END-IF                                           29562071
295630                 END-IF                                           29563071
295640                 END-IF                                           29564071
295650             ELSE                                                 29565071
295660                 MOVE DISTHD-FCSE-LBL-TYP-CDE                     29566071
295670                      TO  ASC-LBL-TYP (ASC-BLK-SUB ASC-ITEM-SUB)  29567071
295680                          IF  DISTHD-FCSE-LBL-TYP-CDE = SPACE     29568071
295690                              MOVE PC-N    TO ASC-LBL-TYP         29569071
295700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 29570071
295710                          END-IF                                  29571071
295720             END-IF                                               29572071
295730         ELSE                                                     29573071
295740         IF  ASC-DO-NOT-PRINT-SML   OR                            29574071
295750             ASC-DO-NOT-PRINT-PGYBK                               29575071
295760             SET  ASC-LNE-DO-NOT-PRT-LBL                          29576071
295770                  (ASC-BLK-SUB ASC-ITEM-SUB)  TO TRUE             29577071
295780         ELSE                                                     29578071
295790         IF  ASC-LNE-CRE-P2L-LBL (ASC-BLK-SUB ASC-ITEM-SUB)       29579071
295800             SET  ASC-LBL-TYP-NONE                                29580071
295810                  (ASC-BLK-SUB ASC-ITEM-SUB)  TO TRUE             29581071
295820         ELSE                                                     29582071
295830         IF  ASC-PGYBCK-PRTR-ID  >  SPACES  AND                   29583071
295840             ASC-LBL-PRT-STR-ORD                                  29584071
295850             SET  ASC-LBL-TYP-PGYBK                               29585071
295860                  (ASC-BLK-SUB ASC-ITEM-SUB)                      29586071
295870                  ASC-CRE-LBL-UPDT                                29587071
295880                  (ASC-BLK-SUB ASC-ITEM-SUB)  TO  TRUE            29588071
295890         ELSE                                                     29589071
295900             SET  ASC-LBL-TYP-SML                                 29590071
295910                  (ASC-BLK-SUB ASC-ITEM-SUB)                      29591071
295920                  ASC-CRE-LBL-UPDT                                29592071
295930                  (ASC-BLK-SUB ASC-ITEM-SUB)  TO  TRUE            29593071
295940         END-IF                                                   29594071
295950         END-IF                                                   29595071
295960         END-IF                                                   29596071
295970         END-IF                                                   29597071
295980                                                                  29598071
295990* PROCESS QTY                                                     29599071
296000                                                                  29600071
296010         IF  ASC-CARTON-COUNT (ASC-BLK-SUB ASC-ITEM-SUB)  > +0 AND29601071
296020             ASC-OUTER-PACK-QTY (ASC-BLK-SUB ASC-ITEM-SUB) > +0   29602071
296030             MULTIPLY ASC-CARTON-COUNT (ASC-BLK-SUB ASC-ITEM-SUB) 29603071
296040                   BY ASC-OUTER-PACK-QTY(ASC-BLK-SUB ASC-ITEM-SUB)29604071
296050               GIVING ASC-PROCESS-QTY (ASC-BLK-SUB ASC-ITEM-SUB)  29605071
296060         END-IF                                                   29606071
296070         IF  ASC-QTY-ERROR-YES (ASC-BLK-SUB ASC-ITEM-SUB)  AND    29607071
296080             ASC-CARTON-COUNT  (ASC-BLK-SUB ASC-ITEM-SUB) >  +0   29608071
296090             IF  ASC-PROCESS-QTY (ASC-BLK-SUB ASC-ITEM-SUB) =     29609071
296100                 ASC-TRANSCRIBE-QTY(ASC-BLK-SUB ASC-ITEM-SUB)  OR 29610071
296110                 DP020-FK-LOCAL-FUNC-10 (DP020-SRC-AID)        OR 29611071
296120                 DP020-FK-LOCAL-FUNC-09 (DP020-SRC-AID)        OR 29612071
296130                 DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)           29613071
296140                 SET  ASC-NO-LINE-ERROR (ASC-BLK-SUB ASC-ITEM-SUB)29614071
296150                      TO  TRUE                                    29615071
296160             ELSE                                                 29616071
296170             IF  ASC-LNE-CRE-P2L-LBL(ASC-BLK-SUB ASC-ITEM-SUB)    29617071
296180                 SET  ASC-NO-LINE-ERROR (ASC-BLK-SUB ASC-ITEM-SUB)29618071
296190                      TO  TRUE                                    29619071
296200             END-IF                                               29620071
296210             END-IF                                               29621071
296220         END-IF                                                   29622071
296230                                                                  29623071
296240     END-IF.                                                      29624071
296250                                                                  29625071
296260     EVALUATE TRUE                                                29626071
296270         WHEN PC166-CRA-SUCCESSFUL                                29627071
296280              CONTINUE                                            29628071
296290         WHEN PC166-CRA-DB-BUSY                                   29629071
296300              MOVE  PC-TSYMSG-01767  TO  DP020-MSG-NUMBER         29630071
296310              STRING ' PCKCS701 - '       DELIMITED BY SIZE       29631071
296320                     ' PO-RCVR -'         DELIMITED BY SIZE       29632071
296330                     PC166-PO-NBR         DELIMITED BY SIZE       29633071
296340                     '-'                  DELIMITED BY SIZE       29634071
296350                     PC166-RCVR-SEQ-NBR   DELIMITED BY SIZE       29635071
296360                     ' LINE-'             DELIMITED BY SIZE       29636071
296370                     PC166-PO-LNE-NBR     DELIMITED BY SIZE       29637071
296380                     ' RET-CDE-'          DELIMITED BY SIZE       29638071
296390                     PC166-CRA-RET-CDE    DELIMITED BY SIZE       29639071
296400                     ' '                  DELIMITED BY SIZE       29640071
296410                     PC166-CRA-RET-MSG    DELIMITED BY SIZE       29641071
296420                                     INTO PV-CICS-MSG-AREA2       29642071
296430              MOVE LENGTH OF PV-CICS-MSG-AREA2                    29643071
296440                TO PV-COMMAREA-LENGTH                             29644071
296450              EXEC CICS                                           29645071
296460                   WRITEQ TD                                      29646071
296470                    QUEUE  ('CSSL')                               29647071
296480                     FROM  (PV-CICS-MSG-AREA2)                    29648071
296490                   LENGTH  (PV-COMMAREA-LENGTH)                   29649071
296500                     RESP  (PV-CICS-RESP)                         29650071
296510              END-EXEC                                            29651071
296520              INITIALIZE PV-CICS-MSG-AREA2                        29652071
296530              STRING ' PO/RCVR-'          DELIMITED BY SIZE       29653071
296540                     PC166-PO-NBR         DELIMITED BY SIZE       29654071
296550                     '-'                  DELIMITED BY SIZE       29655071
296560                     PC166-RCVR-SEQ-NBR   DELIMITED BY SIZE       29656071
296570                     ' LINE-'             DELIMITED BY SIZE       29657071
296580                     PC166-PO-LNE-NBR     DELIMITED BY SIZE       29658071
296590                     ' BARCODE-'          DELIMITED BY SIZE       29659071
296600                     LBVRDA-BRCDE-NBR     DELIMITED BY SIZE       29660071
296610                                     INTO PV-CICS-MSG-AREA2       29661071
296620              MOVE LENGTH OF PV-CICS-MSG-AREA2                    29662071
296630                TO PV-COMMAREA-LENGTH                             29663071
296640              EXEC CICS                                           29664071
296650                   WRITEQ TD                                      29665071
296660                    QUEUE  ('CSSL')                               29666071
296670                     FROM  (PV-CICS-MSG-AREA2)                    29667071
296680                   LENGTH  (PV-COMMAREA-LENGTH)                   29668071
296690                     RESP  (PV-CICS-RESP)                         29669071
296700              END-EXEC                                            29670071
296710                                                                  29671071
296720              PERFORM 9900-SOFT-ABORT                             29672071
296730         WHEN PC166-CRA-SQL-ERROR                                 29673071
296740             MOVE '7310-VALIDATE-LBL-CALC-CALL'                   29674071
296750                                     TO DP013-PARAGRAPH           29675071
296760             MOVE 'VALIDATE CALL OF VIRTUAL LABEL ROUTINE'        29676071
296770                                     TO DP013-MESSAGE-TEXT (1)    29677071
296780             STRING PC166-PO-NBR        DELIMITED BY SIZE         29678071
296790                    '-'                 DELIMITED BY SIZE         29679071
296800                    PC166-RCVR-SEQ-NBR  DELIMITED BY SIZE         29680071
296810                    '-'                 DELIMITED BY SIZE         29681071
296820                    PC166-PO-LNE-NBR    DELIMITED BY SIZE         29682071
296830                                   INTO DP013-MESSAGE-TEXT (2)    29683071
296840             MOVE SQLCA              TO DP013-SQLCA               29684071
296850             MOVE PC166-CRA-RET-MSG  TO DP013-DB2-TABLE-NAME (1)  29685071
296860             SET DP013-DB2-ABEND     TO TRUE                      29686071
296870             SET DP013-ROLLBACK      TO TRUE                      29687071
296880             SET DP013-XCTL-DISPLAY-RESTART                       29688071
296890                                     TO TRUE                      29689071
296900             PERFORM DP013-0000-PROCESS-ABEND                     29690071
296910         WHEN OTHER                                               29691071
296920              CONTINUE                                            29692071
296930     END-EVALUATE.                                                29693071
296940                                                                  29694071
296950                                                                  29695071
296960*----------------------------------------------------------------*29696071
296970* CHECK RETURN CODE FROM UCC128 LBL CALCULATION - IF SUCCESSFUL  *29697071
296980* LQW AREA - AFTER DELETE                                        *29698071
296990*----------------------------------------------------------------*29699071
297000 7315-VALIDATE-LBL-CALC-CALL.                                     29700071
297010                                                                  29701071
297020     IF  ASC-PRE-PACK-ORDER                                       29702071
297030         IF  PC166-PREPK-UCC128-YES                               29703071
297040             SET  LQW-LNE-UCC128-YES (LQW-IDX) TO TRUE            29704071
297050         ELSE                                                     29705071
297060             SET  LQW-LNE-UCC128-NO  (LQW-IDX) TO TRUE            29706071
297070         END-IF                                                   29707071
297080     END-IF.                                                      29708071
297090                                                                  29709071
297100     ADD  PC166-FCSE-LBL-CNT                                      29710071
297110          PC166-INPK-LBL-CNT                                      29711071
297120          GIVING  PV-SHIP-LNE-TOTAL.                              29712071
297130                                                                  29713071
297140     MOVE PC166-FCSE-LBL-CNT                                      29714071
297150       TO PV-FULL-CASE-SHIP-TOTAL                                 29715071
297160          LQW-SML-FCSE-LBL-CNT (LQW-IDX).                         29716071
297170                                                                  29717071
297180     MOVE PC166-INPK-LBL-CNT                                      29718071
297190       TO PV-INPK-SHIP-LNE-TOTAL                                  29719071
297200          LQW-SML-INPK-LBL-CNT (LQW-IDX).                         29720071
297210                                                                  29721071
297220     MOVE PC166-P2L-LBL-CNT                                       29722071
297230       TO PV-P2L-LNE-TOTAL                                        29723071
297240          LQW-P2L-LBL-CNT (LQW-IDX).                              29724071
297250                                                                  29725071
297260     MOVE PC166-CS-BOUND-UNTS                                     29726071
297270       TO LQW-CS-BOUND-UNTS (LQW-IDX).                            29727071
297280                                                                  29728071
297290     MOVE PC166-DC-BOUND-UNTS                                     29729071
297300       TO LQW-DC-BOUND-UNTS (LQW-IDX).                            29730071
297310                                                                  29731071
297320     MOVE PC166-RTV-BOUND-UNTS                                    29732071
297330       TO LQW-RTV-BOUND-UNTS (LQW-IDX).                           29733071
297340                                                                  29734071
297350     MOVE PC166-CS-BOUND-CTNS                                     29735071
297360       TO LQW-CS-BOUND-CTNS (LQW-IDX).                            29736071
297370                                                                  29737071
297380     MOVE PC166-TOTAL-CARTONS                                     29738071
297390       TO LQW-CARTON-CNT (LQW-IDX).                               29739071
297400                                                                  29740071
297410     IF  PC166-MULT-OTPK                                          29741071
297420         SET  LQW-MLT-OTPK-UCC128 (LQW-IDX)  TO  TRUE             29742071
297430     ELSE                                                         29743071
297440         MOVE PC166-OTPK-UNT-QTY                                  29744071
297450           TO LQW-OUTER-PACK (LQW-IDX)                            29745071
297460     END-IF.                                                      29746071
297470                                                                  29747071
297480     IF  PC166-ERR-OTPK-BY-INPK                                   29748071
297490         SET  LQW-LNE-BAD-INPK-Y (LQW-IDX)                        29749071
297500              ASC-INVALID-INPK-YES  TO  TRUE                      29750071
297510     ELSE                                                         29751071
297520     IF  PC166-ERR-INVALID-OTPK                                   29752071
297530         SET  LQW-LNE-BAD-OTPK-Y (LQW-IDX)                        29753071
297540              ASC-INVALID-OTPK-YES  TO  TRUE                      29754071
297550                                                                  29755071
297560     ELSE                                                         29756071
297570     IF  PC166-ERR-DC-RTV-NOT-OTPK                                29757071
297580         SET  LQW-LNE-DC-RTV-OTPK (LQW-IDX)                       29758071
297590              ASC-INVALID-DV-RTV-OTPK  TO  TRUE                   29759071
297600     END-IF                                                       29760071
297610                                                                  29761071
297620     END-IF                                                       29762071
297630     END-IF.                                                      29763071
297640                                                                  29764071
297650     IF  LQW-LNE-CRE-SML-LBL (LQW-IDX)  AND                       29765071
297660         LQW-P2L-LBL-CNT (LQW-IDX)  >  0                          29766071
297670         SET  ASC-INVALID-OTPK-YES                                29767071
297680              LQW-LNE-BAD-OTPK-Y (LQW-IDX)                        29768071
297690              TO  TRUE                                            29769071
297700     END-IF.                                                      29770071
297710                                                                  29771071
297720* OUTER PACK                                                      29772071
297730     IF  LQW-LNE-UCC128-NO (LQW-IDX)                              29773071
297740         IF  ASC-OTPK-UNT-QTY  >  +0                              29774071
297750             MOVE  ASC-OTPK-UNT-QTY  TO  LQW-OUTER-PACK (LQW-IDX) 29775071
297760             SET  PS-OUTER-PK-FROM-CRIT  TO  TRUE                 29776071
297770         ELSE                                                     29777071
297780             COMPUTE LQW-OUTER-PACK (LQW-IDX)                     29778071
297790                  =  RECITM-CASE-PACK-QTY  *                      29779071
297800                     RECITM-PREPK-RATO-QTY                        29780071
297810         END-IF                                                   29781071
297820                                                                  29782071
297830* CARTON COUNT                                                    29783071
297840         IF  ASC-CART-CNT  >  +0                                  29784071
297850             MOVE ASC-CART-CNT     TO  LQW-CARTON-CNT (LQW-IDX)   29785071
297860         ELSE                                                     29786071
297870             MOVE ZEROES           TO  LQW-CARTON-CNT (LQW-IDX)   29787071
297880         END-IF                                                   29788071
297890                                                                  29789071
297900         IF  LQW-LNE-CRE-P2L-LBL (LQW-IDX)  OR                    29790071
297910             LQW-PROTECTED (LQW-IDX)                              29791071
297920             CONTINUE                                             29792071
297930         ELSE                                                     29793071
297940         IF  LQW-TRANSCRIB-QTY(LQW-IDX)  > +0 AND                 29794071
297950             LQW-OUTER-PACK   (LQW-IDX)  > +0 AND                 29795071
297960             LQW-CARTON-CNT   (LQW-IDX)  = +0                     29796071
297970             PERFORM 4312-CALC-CARTON-CNT                         29797071
297980         END-IF                                                   29798071
297990         END-IF                                                   29799071
298000         PERFORM 4345-GET-LABEL-COUNT                             29800071
298010                                                                  29801071
298020* LABEL TYPE                                                      29802071
298030                                                                  29803071
298040         IF  PS-DISTHD-RECORD-FOUND                               29804071
298050             IF  DISTHD-PRC-AREA-MODU-ID  =  SPACES  AND          29805071
298060                 DISTHD-TOT-CART-CNT      =  ZEROES  AND          29806071
298070                 DISTHD-P2L-CART-CNT      =  ZEROES  AND          29807071
298080                 DISTHD-FCSE-CART-CNT     =  ZEROES  AND          29808071
298090                 DISTHD-INPK-CART-CNT     =  ZEROES               29809071
298100                 IF  ASC-DO-NOT-PRINT-SML OR                      29810071
298110                     ASC-DO-NOT-PRINT-PGYBK                       29811071
298120                     SET  LQW-LNE-DO-NOT-PRT-LBL (LQW-IDX)        29812071
298130                                                      TO TRUE     29813071
298140                 ELSE                                             29814071
298150                 IF  LQW-LNE-CRE-P2L-LBL(LQW-IDX)                 29815071
298160                     SET  LQW-LBL-TYP-NONE (LQW-IDX)              29816071
298170                                                      TO TRUE     29817071
298180                 ELSE                                             29818071
298190                 IF  ASC-PGYBCK-PRTR-ID  >  SPACES  AND           29819071
298200                     ASC-LBL-PRT-STR-ORD                          29820071
298210                     SET  LQW-STORE-PGYBK   (LQW-IDX)             29821071
298220                          LQW-CRE-LBL-UPDT  (LQW-IDX)             29822071
298230                                                      TO TRUE     29823071
298240                 ELSE                                             29824071
298250                     SET LQW-SHUFFLED-SML  (LQW-IDX)              29825071
298260                         LQW-CRE-LBL-UPDT (LQW-IDX)               29826071
298270                                                     TO  TRUE     29827071
298280                 END-IF                                           29828071
298290                 END-IF                                           29829071
298300                 END-IF                                           29830071
298310             ELSE                                                 29831071
298320                 MOVE DISTHD-FCSE-LBL-TYP-CDE                     29832071
298330                      TO  LQW-LABEL-TYPE (LQW-IDX)                29833071
298340                          IF  DISTHD-FCSE-LBL-TYP-CDE = SPACE     29834071
298350                              MOVE PC-N TO LQW-LABEL-TYPE(LQW-IDX)29835071
298360                          END-IF                                  29836071
298370             END-IF                                               29837071
298380         ELSE                                                     29838071
298390         IF  ASC-DO-NOT-PRINT-SML   OR                            29839071
298400             ASC-DO-NOT-PRINT-PGYBK                               29840071
298410             SET  LQW-LNE-DO-NOT-PRT-LBL (LQW-IDX) TO TRUE        29841071
298420         ELSE                                                     29842071
298430         IF  LQW-LNE-CRE-P2L-LBL   (LQW-IDX)                      29843071
298440             SET  LQW-LBL-TYP-NONE (LQW-IDX)  TO TRUE             29844071
298450         ELSE                                                     29845071
298460         IF  ASC-PGYBCK-PRTR-ID  >  SPACES  AND                   29846071
298470             ASC-LBL-PRT-STR-ORD                                  29847071
298480             SET  LQW-STORE-PGYBK   (LQW-IDX)                     29848071
298490                  LQW-CRE-LBL-UPDT  (LQW-IDX) TO TRUE             29849071
298500         ELSE                                                     29850071
298510             SET  LQW-SHUFFLED-SML (LQW-IDX)                      29851071
298520                  LQW-CRE-LBL-UPDT (LQW-IDX)  TO  TRUE            29852071
298530         END-IF                                                   29853071
298540         END-IF                                                   29854071
298550         END-IF                                                   29855071
298560     END-IF.                                                      29856071
298570                                                                  29857071
298580                                                                  29858071
298590     EVALUATE TRUE                                                29859071
298600         WHEN PC166-CRA-SUCCESSFUL                                29860071
298610              CONTINUE                                            29861071
298620         WHEN PC166-CRA-DB-BUSY                                   29862071
298630              MOVE  PC-TSYMSG-01767  TO  DP020-MSG-NUMBER         29863071
298640              STRING ' PCKCS701 - '       DELIMITED BY SIZE       29864071
298650                     ' PO-RCVR -'         DELIMITED BY SIZE       29865071
298660                     PC166-PO-NBR         DELIMITED BY SIZE       29866071
298670                     '-'                  DELIMITED BY SIZE       29867071
298680                     PC166-RCVR-SEQ-NBR   DELIMITED BY SIZE       29868071
298690                     ' LINE-'             DELIMITED BY SIZE       29869071
298700                     PC166-PO-LNE-NBR     DELIMITED BY SIZE       29870071
298710                     ' RET-CDE-'          DELIMITED BY SIZE       29871071
298720                     PC166-CRA-RET-CDE    DELIMITED BY SIZE       29872071
298730                     ' '                  DELIMITED BY SIZE       29873071
298740                     PC166-CRA-RET-MSG    DELIMITED BY SIZE       29874071
298750                                     INTO PV-CICS-MSG-AREA2       29875071
298760              MOVE LENGTH OF PV-CICS-MSG-AREA2                    29876071
298770                TO PV-COMMAREA-LENGTH                             29877071
298780              EXEC CICS                                           29878071
298790                   WRITEQ TD                                      29879071
298800                    QUEUE  ('CSSL')                               29880071
298810                     FROM  (PV-CICS-MSG-AREA2)                    29881071
298820                   LENGTH  (PV-COMMAREA-LENGTH)                   29882071
298830                     RESP  (PV-CICS-RESP)                         29883071
298840              END-EXEC                                            29884071
298850              INITIALIZE PV-CICS-MSG-AREA2                        29885071
298860              STRING ' PO/RCVR-'          DELIMITED BY SIZE       29886071
298870                     PC166-PO-NBR         DELIMITED BY SIZE       29887071
298880                     '-'                  DELIMITED BY SIZE       29888071
298890                     PC166-RCVR-SEQ-NBR   DELIMITED BY SIZE       29889071
298900                     ' LINE-'             DELIMITED BY SIZE       29890071
298910                     PC166-PO-LNE-NBR     DELIMITED BY SIZE       29891071
298920                     ' BARCODE-'          DELIMITED BY SIZE       29892071
298930                     LBVRDA-BRCDE-NBR     DELIMITED BY SIZE       29893071
298940                                     INTO PV-CICS-MSG-AREA2       29894071
298950              MOVE LENGTH OF PV-CICS-MSG-AREA2                    29895071
298960                TO PV-COMMAREA-LENGTH                             29896071
298970              EXEC CICS                                           29897071
298980                   WRITEQ TD                                      29898071
298990                    QUEUE  ('CSSL')                               29899071
299000                     FROM  (PV-CICS-MSG-AREA2)                    29900071
299010                   LENGTH  (PV-COMMAREA-LENGTH)                   29901071
299020                     RESP  (PV-CICS-RESP)                         29902071
299030              END-EXEC                                            29903071
299040                                                                  29904071
299050              PERFORM 9900-SOFT-ABORT                             29905071
299060         WHEN PC166-CRA-SQL-ERROR                                 29906071
299070             MOVE '7315-VALIDATE-LBL-CALC-CALL'                   29907071
299080                                     TO DP013-PARAGRAPH           29908071
299090             MOVE 'VALIDATE CALL OF VIRTUAL LABEL ROUTINE'        29909071
299100                                     TO DP013-MESSAGE-TEXT (1)    29910071
299110             STRING PC166-PO-NBR        DELIMITED BY SIZE         29911071
299120                    '-'                 DELIMITED BY SIZE         29912071
299130                    PC166-RCVR-SEQ-NBR  DELIMITED BY SIZE         29913071
299140                    '-'                 DELIMITED BY SIZE         29914071
299150                    PC166-PO-LNE-NBR    DELIMITED BY SIZE         29915071
299160                                   INTO DP013-MESSAGE-TEXT (2)    29916071
299170             MOVE SQLCA              TO DP013-SQLCA               29917071
299180             MOVE PC166-CRA-RET-MSG  TO DP013-DB2-TABLE-NAME (1)  29918071
299190             SET DP013-DB2-ABEND     TO TRUE                      29919071
299200             SET DP013-ROLLBACK      TO TRUE                      29920071
299210             SET DP013-XCTL-DISPLAY-RESTART                       29921071
299220                                     TO TRUE                      29922071
299230             PERFORM DP013-0000-PROCESS-ABEND                     29923071
299240         WHEN OTHER                                               29924071
299250              CONTINUE                                            29925071
299260     END-EVALUATE.                                                29926071
299270                                                                  29927071
299280                                                                  29928071
299290*----------------------------------------------------------------*29929071
299300* UCC128 VIRTUAL LABEL CREATE MODULE - WHEN USING UCC128 DATA    *29930071
299310*----------------------------------------------------------------*29931071
299320 7400-UCC128-LBL-CREATE.                                          29932071
299330                                                                  29933071
299340     MOVE ASC-PO-NBR                    TO DK-PO-NBR.             29934071
299350     MOVE ASC-REC-SEQ-NBR               TO DK-REC-SEQ-NBR.        29935071
299360     MOVE LQW-PO-RCVR-LINE(LQW-IDX)     TO DK-LINE-NBR.           29936071
299370     PERFORM 4707-GET-HDR-INFO.                                   29937071
299380     PERFORM 4709-GET-TCOCNTL-INFO.                               29938071
299390                                                                  29939071
299400     INITIALIZE PC166-COMMAREA-REC.                               29940071
299410                                                                  29941071
299420     SET  PC166-FUNC-CRE-VRTL-LBL       TO TRUE.                  29942071
299430                                                                  29943071
299440     MOVE ASC-PO-NBR                    TO PC166-PO-NBR.          29944071
299450     MOVE ASC-REC-SEQ-NBR               TO PC166-RCVR-SEQ-NBR.    29945071
299460     MOVE LQW-PO-RCVR-LINE(LQW-IDX)     TO PC166-PO-LNE-NBR.      29946071
299470     MOVE ASC-OPER-UNT-ID               TO PC166-OPER-UNT-ID.     29947071
299480     MOVE COCNTL-SSCC-18-IND            TO PC166-SSCC-18-IND.     29948071
299490     MOVE LQW-LABEL-TYPE(LQW-IDX)       TO PC166-SHIP-LABEL-TYPE. 29949071
299500     MOVE ASC-LBL-PRT-ORDER             TO PC166-PRT-SEQ          29950071
299600                                                                  29960071
299610     MOVE LQW-LNE-CRE-LBL-OPT (LQW-IDX) TO PC166-CASEPACK-FUNCTION29961071
299620                                                                  29962071
299630     IF ASC-SPEC-INST-DESC = SPACES                               29963071
299640        MOVE ASC-DFLT-STR-ZN-ID         TO PC166-STR-ZNE          29964071
299650     ELSE                                                         29965071
299660        MOVE ASC-SPEC-INST-DESC         TO PC166-STR-ZNE          29966071
299670     END-IF.                                                      29967071
299680     MOVE ASC-DPT-NBR                   TO PC166-DEPT-NBR.        29968071
299690     MOVE LQW-SKU (LQW-IDX)             TO PC166-SKU.             29969071
299700     MOVE LQW-SUBCLASS (LQW-IDX)        TO PC166-CL-NBR.          29970071
299710     MOVE PV-VEND-STYL-NAME             TO PC166-VENDOR-STYLE.    29971071
299720     MOVE LQW-SML-FCSE-LBL-CNT(LQW-IDX) TO PC166-FCSE-LBL-CNT.    29972071
299730     MOVE LQW-SML-INPK-LBL-CNT(LQW-IDX) TO PC166-INPK-LBL-CNT.    29973071
299740     MOVE LQW-P2L-LBL-CNT(LQW-IDX)      TO PC166-P2L-LBL-CNT.     29974071
299750     MOVE LQW-CS-BOUND-UNTS(LQW-IDX)    TO PC166-CS-BOUND-UNTS.   29975071
299760     MOVE LQW-DC-BOUND-UNTS(LQW-IDX)    TO PC166-DC-BOUND-UNTS.   29976071
299770     MOVE LQW-RTV-BOUND-UNTS (LQW-IDX)  TO PC166-RTV-BOUND-UNTS.  29977071
299780     MOVE LQW-CS-BOUND-CTNS (LQW-IDX)   TO PC166-CS-BOUND-CTNS.   29978071
299790     MOVE LQW-CARTON-CNT (LQW-IDX)      TO PC166-TOTAL-CARTONS.   29979071
299800     IF  LQW-LNE-CRE-P2L-LBL (LQW-IDX)                            29980071
299810         MOVE ZEROES                    TO PC166-OTPK-UNT-QTY     29981071
299820     ELSE                                                         29982071
299830         MOVE LQW-OUTER-PACK (LQW-IDX)  TO PC166-OTPK-UNT-QTY     29983071
299840     END-IF.                                                      29984071
299850     MOVE LQW-INNER-PACK (LQW-IDX)      TO PC166-INPK-UNT-QTY.    29985071
299860     MOVE LQW-MODULE (LQW-IDX)          TO PC166-MOD-NBR.         29986071
299870     MOVE PC-CURRENT-PROGRAM-NAME       TO PC166-CALLING-PGM-NME. 29987071
299880                                                                  29988071
299890     MOVE LQW-ITM-NBR (LQW-IDX)         TO PC166-ITEM-NBR.        29989071
299900                                                                  29990071
299910     MOVE ASC-PKGNG-CD                  TO PC166-PKGNG-CD.        29991071
299920     MOVE LQW-PREPK-ID (LQW-IDX)        TO PC166-PREPK-ID         29992071
299930                                           DK-PREPK-ID.           29993071
299940     MOVE LQW-PREPK-RATIO (LQW-IDX)     TO PC166-PREPK-RATIO.     29994071
299950     MOVE LQW-PACKS-IN-CRTN (LQW-IDX)   TO PC166-PACKS-IN-CRTN.   29995071
299960     MOVE PV-USER-ID                    TO PC166-USER-ID.         29996071
299970                                                                  29997071
299980     IF  ASC-PRE-PACK-ORDER                                       29998071
299990         PERFORM 4781-GET-TOT-PREPK-UNTS                          29999071
300000         MOVE  PV-TOT-PREPK-UNTS  TO  PC166-TOT-PREPK-UNTS        30000071
300010         MOVE  PV-TOT-PREPK-INPK-UNTS                             30001071
300020                                  TO  PC166-PREPK-INPK-UNT-QTY    30002071
300030     ELSE                                                         30003071
300040         MOVE  ZEROES             TO  PC166-TOT-PREPK-UNTS        30004071
300050                                      PC166-PREPK-INPK-UNT-QTY    30005071
300060     END-IF.                                                      30006071
300070                                                                  30007071
300080     MOVE LQW-IN-PACK-CONVY (LQW-IDX)   TO PC166-INPK-CNVY-IND.   30008071
300090     MOVE LQW-LNE-FCSE-AREA (LQW-IDX)   TO  PC166-FCSE-AREA.      30009071
300100     MOVE LQW-PROCESS-QTY   (LQW-IDX)   TO  PC166-PRCS-QTY.       30010071
300110                                                                  30011071
300120     IF  ASC-TRIP-ARRIVE-CCYY  =  9999                            30012071
300130         MOVE 99  TO  ASC-TRIP-ARRIVE-MM                          30013071
300140         MOVE 99  TO  ASC-TRIP-ARRIVE-DD                          30014071
300150     END-IF                                                       30015071
300160                                                                  30016071
300170     MOVE ASC-TRIP-ARRIVE-DATE       TO PC166-TRIP-ARRIVE-DATE.   30017071
300180                                                                  30018071
300181     IF      PS-DISPLAY-CSSL-YES                                  30018171
300182         INITIALIZE      PV-CICS-MSG-AREA2                        30018271
300183         MOVE DP020-SRC-TASK-NUMBER      TO  PV-DISPLAY-TASK-NBR  30018371
300184         MOVE ASC-PO-NBR             TO  PV-DISPLAY-PO-NBR        30018471
300185         MOVE ASC-REC-SEQ-NBR        TO  PV-DISPLAY-RCVR-SEQ-NBR  30018571
300186         MOVE DP020-LOCATION-NBR     TO  PV-DISPLAY-OPER          30018671
300187         STRING      ' PCKCS701-'                                 30018771
300188                 PV-DISPLAY-OPER                                  30018871
300189                 ' TERM-'                                         30018971
300190                 DP020-TERM-ID                                    30019071
300200                 ' USER-'                                         30020071
300210                 DP020-USERID                                     30021071
300220                 ' TASK-'                                         30022071
300230                 PV-DISPLAY-TASK-NBR                              30023071
300240                 ' PO-'                                           30024071
300250                 PV-DISPLAY-PO-NBR                                30025071
300260                 '-'                                              30026071
300270                 PV-DISPLAY-RCVR-SEQ-NBR                          30027071
300280                 '-'                                              30028071
300290                 PC166-PO-LNE-NBR                                 30029071
300300                 ' BEF PCKCS719 VIRTUAL '  DELIMITED BY SIZE      30030071
300310                                      INTO PV-CICS-MSG-AREA2      30031071
300320         MOVE LENGTH OF PV-CICS-MSG-AREA2                         30032071
300330           TO PV-COMMAREA-LENGTH                                  30033071
300340         EXEC CICS                                                30034071
300350              WRITEQ TD                                           30035071
300360               QUEUE      ('CSSL')                                30036071
300370                FROM      (PV-CICS-MSG-AREA2)                     30037071
300380              LENGTH      (PV-COMMAREA-LENGTH)                    30038071
300390                RESP      (PV-CICS-RESP)                          30039071
300400         END-EXEC                                                 30040071
300410     END-IF.                                                      30041071
300420                                                                  30042071
300430     MOVE LENGTH OF PC166-COMMAREA-REC  TO PV-COMMAREA-LENGTH.    30043071
300440                                                                  30044071
300450     EXEC CICS                                                    30045071
300460         LINK                                                     30046071
300470             PROGRAM   (PC-UCC128-LBL-CALC)                       30047071
300480             COMMAREA  (PC166-COMMAREA-REC)                       30048071
300490             LENGTH    (PV-COMMAREA-LENGTH)                       30049071
300500             RESP      (PV-CICS-RESP)                             30050071
300510     END-EXEC.                                                    30051071
300520                                                                  30052071
300530     EVALUATE TRUE                                                30053071
300540         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     30054071
300550             PERFORM 7410-VALIDATE-LBL-CRE-CALL                   30055071
300560         WHEN OTHER                                               30056071
300570              MOVE PV-CICS-RESP  TO  PV-CICS-RESP-DISPLAY         30057071
300580              STRING ' PCKCS701 - '           DELIMITED BY SIZE   30058071
300590                     '7400-UCC128-LBL-CREATE' DELIMITED BY SIZE   30059071
300600                     '-LINK RESPONSE - '      DELIMITED BY SIZE   30060071
300610                     PV-CICS-RESP-DISPLAY     DELIMITED BY SIZE   30061071
300620                INTO PV-CICS-MSG-DATA                             30062071
300630                MOVE PV-CICS-MSG-HOLD                             30063071
300640                  TO PV-CICS-MSG-AREA                             30064071
300650                MOVE LENGTH OF PV-CICS-MSG-AREA                   30065071
300660                  TO PV-COMMAREA-LENGTH                           30066071
300670             EXEC CICS                                            30067071
300680                 WRITEQ TD                                        30068071
300690                     QUEUE   ('CSSL')                             30069071
300700                     FROM    (PV-CICS-MSG-AREA)                   30070071
300710                     LENGTH  (PV-COMMAREA-LENGTH)                 30071071
300720                     RESP    (PV-CICS-RESP)                       30072071
300730             END-EXEC                                             30073071
300740             MOVE PC-TSYMSG-02519  TO DP020-MSG-NUMBER            30074071
300750             PERFORM 9900-SOFT-ABORT                              30075071
300760     END-EVALUATE.                                                30076071
300770                                                                  30077071
300780     IF      PS-DISPLAY-CSSL-YES                                  30078071
300790         INITIALIZE      PV-CICS-MSG-AREA2                        30079071
300800         MOVE DP020-SRC-TASK-NUMBER      TO  PV-DISPLAY-TASK-NBR  30080071
300810         MOVE ASC-PO-NBR             TO  PV-DISPLAY-PO-NBR        30081071
300820         MOVE ASC-REC-SEQ-NBR        TO  PV-DISPLAY-RCVR-SEQ-NBR  30082071
300830         MOVE DP020-LOCATION-NBR     TO  PV-DISPLAY-OPER          30083071
300840         STRING      ' PCKCS701-'                                 30084071
300850                 PV-DISPLAY-OPER                                  30085071
300860                 ' TERM-'                                         30086071
300870                 DP020-TERM-ID                                    30087071
300880                 ' USER-'                                         30088071
300890                 DP020-USERID                                     30089071
300900                 ' TASK-'                                         30090071
300910                 PV-DISPLAY-TASK-NBR                              30091071
300920                 ' PO-'                                           30092071
300930                 PV-DISPLAY-PO-NBR                                30093071
300940                 '-'                                              30094071
300950                 PV-DISPLAY-RCVR-SEQ-NBR                          30095071
300960                 '-'                                              30096071
300970                 PC166-PO-LNE-NBR                                 30097071
300980                 ' AFT PCKCS719 VIRTUAL '  DELIMITED BY SIZE      30098071
300990                                      INTO PV-CICS-MSG-AREA2      30099071
301000         MOVE LENGTH OF PV-CICS-MSG-AREA2                         30100071
301010           TO PV-COMMAREA-LENGTH                                  30101071
301020         EXEC CICS                                                30102071
301030              WRITEQ TD                                           30103071
301040               QUEUE      ('CSSL')                                30104071
301050                FROM      (PV-CICS-MSG-AREA2)                     30105071
301060              LENGTH      (PV-COMMAREA-LENGTH)                    30106071
301070                RESP      (PV-CICS-RESP)                          30107071
301080         END-EXEC                                                 30108071
301090     END-IF.                                                      30109071
301100                                                                  30110071
301110                                                                  30111071
301120*----------------------------------------------------------------*30112071
301130* CHECK RETURN CODE FROM UCC128 LBL CREATION - IF SUCCESSFUL     *30113071
301140*----------------------------------------------------------------*30114071
301150 7410-VALIDATE-LBL-CRE-CALL.                                      30115071
301160                                                                  30116071
301170     IF  PC166-CRA-SUCCESSFUL                                     30117071
301180         MOVE PC166-FCSE-LBL-CNT TO LQW-SML-FCSE-LBL-CNT(LQW-IDX) 30118071
301190         MOVE PC166-INPK-LBL-CNT TO LQW-SML-INPK-LBL-CNT(LQW-IDX) 30119071
301200         MOVE PC166-P2L-LBL-CNT    TO LQW-P2L-LBL-CNT(LQW-IDX)    30120071
301210         MOVE PC166-CS-BOUND-UNTS  TO LQW-CS-BOUND-UNTS(LQW-IDX)  30121071
301220         MOVE PC166-DC-BOUND-UNTS  TO LQW-DC-BOUND-UNTS(LQW-IDX)  30122071
301230         MOVE PC166-RTV-BOUND-UNTS TO LQW-RTV-BOUND-UNTS(LQW-IDX) 30123071
301240         MOVE PC166-CS-BOUND-CTNS  TO LQW-CS-BOUND-CTNS(LQW-IDX)  30124071
301250         MOVE PC166-TOTAL-CARTONS  TO LQW-CARTON-CNT(LQW-IDX)     30125071
301260         IF   PC166-MULT-OTPK                                     30126071
301270              SET  LQW-MLT-OTPK-UCC128(LQW-IDX) TO TRUE           30127071
301280         ELSE                                                     30128071
301290              MOVE PC166-OTPK-UNT-QTY                             30129071
301300                                   TO LQW-OUTER-PACK(LQW-IDX)     30130071
301310         END-IF                                                   30131071
301320         IF  PC166-P2L-LBL-CNT  >  0                              30132071
301330             PERFORM 5310-PROCESS-LINES                           30133071
301340*                (SYSCPOINT ROLLBACK WILL ROLL BACK DISTHD/DISTDT)30134071
301350             IF  PS-ERROR                                         30135071
301360                 EXEC CICS SYNCPOINT                              30136071
301370                           ROLLBACK                               30137071
301380                 END-EXEC                                         30138071
301390                                                                  30139071
301400                 MOVE  PC166-PO-NBR        TO  DK-PO-NBR          30140071
301410                 MOVE  PC166-RCVR-SEQ-NBR  TO  DK-REC-SEQ-NBR     30141071
301420                 MOVE  PC166-PREPK-ID      TO  DK-PREPK-ID        30142071
301430                 MOVE  PC166-PO-LNE-NBR    TO  DK-LINE-NBR        30143071
301440                                                                  30144071
301450                 IF  ASC-PRE-PACK-ORDER                           30145071
301460                     PERFORM 4511-DELETE-VRTL-LBL-PREPK           30146071
301470                 ELSE                                             30147071
301480                     PERFORM 4511-DELETE-VRTL-LBL                 30148071
301490                 END-IF                                           30149071
301500                                                                  30150071
301510                                                                  30151071
301520*                (SYSCPOINT WILL COMMIT DELETE OF VIRTUAL TABLE)  30152071
301530                 EXEC CICS SYNCPOINT                              30153071
301540                 END-EXEC                                         30154071
301550             END-IF                                               30155071
301560         END-IF                                                   30156071
301570     ELSE                                                         30157071
301580         MOVE SPACES               TO PV-CICS-MSG-AREA2           30158071
301590         STRING ' PCKCS701 - '        DELIMITED BY SIZE           30159071
301600                ' PO/RCVR/LNE - '     DELIMITED BY SIZE           30160071
301610                PC166-PO-NBR          DELIMITED BY SIZE           30161071
301620                '-'                   DELIMITED BY SIZE           30162071
301630                PC166-RCVR-SEQ-NBR    DELIMITED BY SIZE           30163071
301640                '-'                   DELIMITED BY SIZE           30164071
301650                PC166-PO-LNE-NBR      DELIMITED BY SIZE           30165071
301660                '   PCKCS719 RETCDE-' DELIMITED BY SIZE           30166071
301670                PC166-CRA-RET-CDE     DELIMITED BY SIZE           30167071
301680                '   REASON-'          DELIMITED BY SIZE           30168071
301690                PC166-CRA-RET-MSG     DELIMITED BY SIZE           30169071
301700                                 INTO PV-CICS-MSG-AREA2           30170071
301710         MOVE LENGTH OF PV-CICS-MSG-AREA2                         30171071
301720                                   TO PV-COMMAREA-LENGTH          30172071
301730         EXEC CICS                                                30173071
301740              WRITEQ TD                                           30174071
301750               QUEUE  ('CSSL')                                    30175071
301760                FROM  (PV-CICS-MSG-AREA2)                         30176071
301770              LENGTH  (PV-COMMAREA-LENGTH)                        30177071
301780                RESP  (PV-CICS-RESP)                              30178071
301790         END-EXEC                                                 30179071
301800         IF  PC166-CRA-DB-BUSY                                    30180071
301900             MOVE PC-TSYMSG-00984 TO DP020-MSG-NUMBER             30190071
301910         ELSE                                                     30191071
301920             MOVE PC-TSYMSG-02519 TO DP020-MSG-NUMBER             30192071
301930         END-IF                                                   30193071
301940         PERFORM 9900-SOFT-ABORT                                  30194071
301950     END-IF.                                                      30195071
301960                                                                  30196071
301970                                                                  30197071
301980*----------------------------------------------------------------*30198071
301990* IGNORE UCC128 DATA                                             *30199071
302000*----------------------------------------------------------------*30200071
302010 7420-IGNORE-UCC128-DATA.                                         30201071
302020                                                                  30202071
302030     MOVE +1                       TO ASC-BLK-SUB.                30203071
302040     PERFORM 5100-WRITE-TEMP-STORAGE.                             30204071
302050     ADD +1                        TO ASC-BLK-SUB.                30205071
302060     PERFORM 5100-WRITE-TEMP-STORAGE.                             30206071
302070                                                                  30207071
302080     PERFORM 6112-READ-LIST-QUEUE.                                30208071
302090                                                                  30209071
302100     IF PV-CICS-RESP = DFHRESP (NORMAL)                           30210071
302110         PERFORM                                                  30211071
302120         VARYING LQW-IDX  FROM 1 BY 1                             30212071
302130         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL   OR                30213071
302140                 LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO  OR        30214071
302150                 PS-SOFT-ABORT-ERROR  OR                          30215071
302160                 PS-ERROR                                         30216071
302170             IF  LQW-SELECT (LQW-IDX)                             30217071
302180                 IF  LQW-LNE-UCC128-YES(LQW-IDX)                  30218071
302190                   IF LQW-PROTECTED(LQW-IDX)                      30219071
302200                     SET LQW-DESELECT (LQW-IDX)      TO TRUE      30220071
302210                   ELSE                                           30221071
302220                     SET LQW-DESELECT (LQW-IDX)                   30222071
302230                         LQW-UPD      (LQW-IDX)                   30223071
302240                         LQW-LNE-UCC128-IGNORE (LQW-IDX)          30224071
302250                                                     TO  TRUE     30225071
302260                     MOVE SPACES  TO LQW-LABEL-TYPE (LQW-IDX)     30226071
302270                     IF  LQW-LNE-CRE-P2L-LBL (LQW-IDX)            30227071
302280                         IF  ASC-DO-NOT-PRINT-SML OR              30228071
302290                             ASC-DO-NOT-PRINT-PGYBK               30229071
302300                             SET LQW-LNE-DO-NOT-PRT-LBL (LQW-IDX) 30230071
302310                                                   TO TRUE        30231071
302320                         ELSE                                     30232071
302330                             SET LQW-LBL-TYP-NONE (LQW-IDX)       30233071
302340                                                   TO TRUE        30234071
302350                         END-IF                                   30235071
302360                     ELSE                                         30236071
302370                     IF  LQW-LNE-CRE-BOTH-LBL (LQW-IDX) OR        30237071
302380                         LQW-LNE-CRE-SML-LBL  (LQW-IDX)           30238071
302390                         IF  ASC-DO-NOT-PRINT-SML  OR             30239071
302400                             ASC-DO-NOT-PRINT-PGYBK               30240071
302410                             SET  LQW-LNE-DO-NOT-PRT-LBL (LQW-IDX)30241071
302420                                                          TO TRUE 30242071
302430                         ELSE                                     30243071
302440                         IF  ASC-PGYBCK-PRTR-ID  >  SPACES  AND   30244071
302450                             ASC-LBL-PRT-STR-ORD                  30245071
302460                             SET  LQW-STORE-PGYBK (LQW-IDX)       30246071
302470                                  LQW-CRE-LBL-UPDT  (LQW-IDX)     30247071
302480                                                          TO TRUE 30248071
302490                         ELSE                                     30249071
302500                             SET  LQW-SHUFFLED-SML (LQW-IDX)      30250071
302510                                  LQW-CRE-LBL-UPDT (LQW-IDX)      30251071
302520                                                          TO TRUE 30252071
302530                         END-IF                                   30253071
302540                         END-IF                                   30254071
302550                     END-IF                                       30255071
302560                     END-IF                                       30256071
302570                                                                  30257071
302580                     MOVE ZEROES  TO LQW-CARTON-CNT (LQW-IDX)     30258071
302590                                     LQW-INNER-PACK (LQW-IDX)     30259071
302600                                     LQW-OUTER-PACK (LQW-IDX)     30260071
302610                                                                  30261071
302620                     PERFORM 7430-GET-INNER-PACK                  30262071
302630                     PERFORM 4250-CALL-XLKUT001                   30263071
302640                     IF  ASC-PRE-PACK-ORDER                       30264071
302650                        COMPUTE LQW-OUTER-PACK (LQW-IDX) =        30265071
302660                            RECITM-CASE-PACK-QTY  *               30266071
302670                            RECITM-PREPK-RATO-QTY                 30267071
302680                     ELSE                                         30268071
302690                        MOVE RECITM-CASE-PACK-QTY                 30269071
302700                                       TO  LQW-OUTER-PACK         30270071
302800                                           (LQW-IDX)              30280071
302810                     END-IF                                       30281071
302820                     IF  LQW-OUTER-PACK (LQW-IDX) = 0             30282071
302830                         MOVE  1  TO  LQW-OUTER-PACK (LQW-IDX)    30283071
302840                     END-IF                                       30284071
302850                     PERFORM 7435-GET-CARTON-COUNT                30285071
302860                                                                  30286071
302870                     SUBTRACT  1                                  30287071
302880                         FROM  ASC-NUMBER-OF-SELECTED-ITEMS       30288071
302890                     MOVE LQW-SELECTED-SW (LQW-IDX)               30289071
302900                       TO LQW-TEMP-SELECTED-SW (LQW-IDX)          30290071
302910                     MOVE PC-TSYMSG-02501                         30291071
302920                       TO DP020-MSG-NUMBER                        30292071
302930                      SET DP020-MSG-INFORMATIONAL  TO TRUE        30293071
302940                   END-IF                                         30294071
302950                 ELSE                                             30295071
302960                     SET  LQW-DESELECT (LQW-IDX)                  30296071
302970                          DP020-MSG-FATAL                         30297071
302980                          ASC-PO-RCVR-TROUBLE-YES  TO TRUE        30298071
302990                     MOVE LQW-SELECTED-SW (LQW-IDX)               30299071
303000                       TO LQW-TEMP-SELECTED-SW (LQW-IDX)          30300071
303010                     MOVE PC-TSYMSG-02498                         30301071
303020                       TO DP020-MSG-NUMBER                        30302071
303030                 END-IF                                           30303071
303040             END-IF                                               30304071
303050         END-PERFORM                                              30305071
303060                                                                  30306071
303070     MOVE PV-ITEM      TO PV-SAVE-ITEM                            30307071
303080     PERFORM 6111-WRITE-LIST-QUEUE                                30308071
303090                                                                  30309071
303100     END-IF                                                       30310071
303110                                                                  30311071
303120     MOVE +1                     TO  ASC-BLK-SUB.                 30312071
303130     PERFORM 4410-READ-TEMP-STORAGE                               30313071
303140                                                                  30314071
303150     ADD +1                      TO  ASC-BLK-SUB                  30315071
303160                                     PV-BLOCK-NUMBER.             30316071
303170     PERFORM 4410-READ-TEMP-STORAGE.                              30317071
303180                                                                  30318071
303190                                                                  30319071
303200*----------------------------------------------------------------*30320071
303210* GET INNERPACK QUANTITY AFTER IGNORE UCC128 DATA                *30321071
303220*----------------------------------------------------------------*30322071
303230 7430-GET-INNER-PACK.                                             30323071
303240                                                                  30324071
303250     MOVE LQW-PO-RCVR-LINE (LQW-IDX)  TO  DK-LINE-NBR.            30325071
303260                                                                  30326071
303270     EXEC SQL                                                     30327071
303280          SELECT A.INNR_PACK_QTY                                  30328071
303290               , A.PREPK_RATO_QTY                                 30329071
303300               , B.ITM_NBR                                        30330071
303310               , A.CASE_PACK_QTY                                  30331071
303320            INTO :RECITM-INNR-PACK-QTY                            30332071
303330               , :RECITM-PREPK-RATO-QTY                           30333071
303340               , :PURITM-ITM-NBR                                  30334071
303350               , :RECITM-CASE-PACK-QTY                            30335071
303360            FROM TRECITM A                                        30336071
303370                ,TPURITM B                                        30337071
303380           WHERE A.ORD_NBR           = :ASC-PO-NBR                30338071
303390             AND A.REC_SEQ_NBR       = :ASC-REC-SEQ-NBR           30339071
303400             AND A.ORD_LNE_NBR       = :DK-LINE-NBR               30340071
303410             AND A.ORD_NBR           = B.PO_NBR                   30341071
303420             AND A.ORD_LNE_NBR       = B.APP_PO_LNE_NBR           30342071
303430             AND A.VER_STATUS_CDE    = 'A'                        30343071
303440             AND A.PO_VER_NBR        = B.VER_NBR                  30344071
303450     END-EXEC.                                                    30345071
303460                                                                  30346071
303470     EVALUATE TRUE                                                30347071
303480                                                                  30348071
303490         WHEN SQLCODE = +0                                        30349071
303500              IF  ASC-PRE-PACK-ORDER                              30350071
303510                  MOVE RECITM-PREPK-RATO-QTY                      30351071
303520                                       TO  LQW-INNER-PACK         30352071
303530                                           (LQW-IDX)              30353071
303540              ELSE                                                30354071
303550                  MOVE RECITM-INNR-PACK-QTY                       30355071
303560                                       TO  LQW-INNER-PACK         30356071
303570                                           (LQW-IDX)              30357071
303580              END-IF                                              30358071
303590                                                                  30359071
303600              IF  LQW-INNER-PACK (LQW-IDX) = 0                    30360071
303610                  MOVE  1  TO  LQW-INNER-PACK (LQW-IDX)           30361071
303620              END-IF                                              30362071
303630         WHEN SQLCODE = +100                                      30363071
303640         WHEN SQLCODE = -811                                      30364071
303650         WHEN SQLCODE = -904                                      30365071
303660         WHEN SQLCODE = -913                                      30366071
303670              MOVE SQLCODE                   TO PV-SOFT-SQLCODE   30367071
303680              MOVE '7430-GET-INNER-PACK    ' TO PV-SOFT-PARAGRAPH 30368071
303690              MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2 30369071
303700              MOVE LENGTH OF PV-CICS-MSG-AREA2                    30370071
303710                                            TO PV-COMMAREA-LENGTH 30371071
303720              EXEC CICS                                           30372071
303730                   WRITEQ TD                                      30373071
303740                    QUEUE  ('CSSL')                               30374071
303750                     FROM  (PV-CICS-MSG-AREA2)                    30375071
303760                   LENGTH  (PV-COMMAREA-LENGTH)                   30376071
303770                     RESP  (PV-CICS-RESP)                         30377071
303780              END-EXEC                                            30378071
303790              CONTINUE                                            30379071
303800                                                                  30380071
303810         WHEN SQLWARN0 NOT = SPACES                               30381071
303820         WHEN SQLCODE < +0                                        30382071
303830         WHEN SQLCODE > +0                                        30383071
303840              MOVE '7430-GET-INNER-PACK    '                      30384071
303850                                 TO DP013-PARAGRAPH               30385071
303860              MOVE 'GET INNER PACK FROM TRECITM TABLE'            30386071
303870                                 TO DP013-MESSAGE-TEXT (1)        30387071
303880              MOVE SQLCA      TO DP013-SQLCA                      30388071
303890              MOVE 'TRECITM'  TO DP013-DB2-TABLE-NAME (1)         30389071
303900              MOVE 'TPURITM'  TO DP013-DB2-TABLE-NAME (2)         30390071
303910              SET  DP013-DB2-ABEND                                30391071
303920                   DP013-XCTL-DISPLAY-RESTART                     30392071
303930                                 TO TRUE                          30393071
303940              PERFORM DP013-0000-PROCESS-ABEND                    30394071
303950     END-EVALUATE.                                                30395071
303960                                                                  30396071
303970                                                                  30397071
303980*----------------------------------------------------------------*30398071
303990* GET CARTON COUNT AFTER IGNORE UCC128 DATA                      *30399071
304000*----------------------------------------------------------------*30400071
304010 7435-GET-CARTON-COUNT.                                           30401071
304020                                                                  30402071
304030     MOVE  ZEROES  TO  PV-CARTON-COUNT-CALC                       30403071
304040                       PV-CARTON-COUNT-REM.                       30404071
304050                                                                  30405071
304060     IF  LQW-OUTER-PACK (LQW-IDX)  >  0                           30406071
304070         DIVIDE  LQW-TRANSCRIB-QTY (LQW-IDX)                      30407071
304080             BY  LQW-OUTER-PACK    (LQW-IDX)                      30408071
304090         GIVING  PV-CARTON-COUNT-CALC                             30409071
304100                 REMAINDER PV-CARTON-COUNT-REM                    30410071
304110         END-DIVIDE                                               30411071
304120                                                                  30412071
304130         IF  PV-CARTON-COUNT-REM  >  +0                           30413071
304140             CONTINUE                                             30414071
304150         ELSE                                                     30415071
304160             IF ASC-CART-CNT > 0                                  30416071
304170               MOVE ASC-CART-CNT                                  30417071
304180                 TO LQW-CARTON-CNT (LQW-IDX)                      30418071
304190             ELSE                                                 30419071
304200               MOVE PV-CARTON-COUNT-CALC                          30420071
304210                 TO LQW-CARTON-CNT (LQW-IDX)                      30421071
304220             END-IF                                               30422071
304230         END-IF                                                   30423071
304240                                                                  30424071
304250     END-IF.                                                      30425071
304260                                                                  30426071
304270                                                                  30427071
304280 7450-CREATE-TROUBLE.                                             30428071
304290                                                                  30429071
304300     INITIALIZE TM500-FIELDS.                                     30430071
304310     SET TM500-ADD-DETAILS                                        30431071
304320         TM500-CREATE-MANUAL       TO  TRUE.                      30432071
304330                                                                  30433071
304340     IF LQW-UCC128-USABLE-NO (LQW-IDX)                            30434071
304350        MOVE 377      TO  TM500-TRBL-RSN-CDE                      30435071
304360     ELSE                                                         30436071
304370        MOVE 378      TO  TM500-TRBL-RSN-CDE                      30437071
304380     END-IF                                                       30438071
304390     MOVE 0                        TO  TM500-NOTIF-NBR.           30439071
304400     MOVE ASC-OPER-UNT-ID          TO  TM500-OPER-UNT-ID.         30440071
304410     MOVE 1                        TO  TM500-FCLTY-ID.            30441071
304420                                                                  30442071
304430     MOVE ASC-PO-NBR               TO  TM500-PO-NBR.              30443071
304440                                                                  30444071
304450     SET TM500-LINE-LEVEL          TO  TRUE.                      30445071
304460     MOVE LQW-PO-RCVR-LINE (LQW-IDX)  TO  TM500-PO-LNE-NBR.       30446071
304470                                                                  30447071
304480     MOVE ASC-REC-SEQ-NBR          TO  TM500-REC-SEQ-NBR.         30448071
304490     MOVE PV-USER-ID               TO  TM500-CRE-UID              30449071
304500                                       TM500-NOTIF-UID.           30450071
304510                                                                  30451071
304520     EXEC CICS LINK                                               30452071
304530          PROGRAM (PC-TMKCS520)                                   30453071
304540          COMMAREA(TM500-FIELDS)                                  30454071
304550     END-EXEC.                                                    30455071
304560                                                                  30456071
304570     IF TM500-CALL-SUCCESSFUL                                     30457071
304580      OR TM500-DUPLICATE-TROUBLE                                  30458071
304590             CONTINUE                                             30459071
304600     ELSE                                                         30460071
304610         MOVE TM500-SQLCODE             TO PV-SOFT-SQLCODE        30461071
304620         MOVE '7450-CREATE-TROUBLE '    TO PV-SOFT-PARAGRAPH      30462071
304630         MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2      30463071
304640         MOVE LENGTH OF PV-CICS-MSG-AREA2                         30464071
304650           TO PV-COMMAREA-LENGTH                                  30465071
304660         EXEC CICS                                                30466071
304670              WRITEQ TD                                           30467071
304680               QUEUE  ('CSSL')                                    30468071
304690                FROM  (PV-CICS-MSG-AREA2)                         30469071
304700              LENGTH  (PV-COMMAREA-LENGTH)                        30470071
304710                RESP  (PV-CICS-RESP)                              30471071
304720         END-EXEC                                                 30472071
304730         SET PS-ERROR TO TRUE                                     30473071
304740         MOVE '7450-CREATE-TROUBLE '                              30474071
304750                               TO DP013-PARAGRAPH                 30475071
304760          MOVE 'UNABLE TO ACCESS CICS'                            30476071
304770                               TO DP013-MESSAGE-TEXT (1)          30477071
304780          MOVE TM500-SQLCA           TO DP013-SQLCA               30478071
304790          SET DP013-DB2-ABEND                                     30479071
304800              DP013-XCTL-DISPLAY-RESTART                          30480071
304810                               TO TRUE                            30481071
304820          PERFORM DP013-0000-PROCESS-ABEND                        30482071
304830     END-IF.                                                      30483071
304840                                                                  30484071
304850*                                                                 30485071
304860 7475-CREATE-TROUBLE.                                             30486071
304870                                                                  30487071
304880     INITIALIZE TM500-FIELDS.                                     30488071
304890     SET TM500-ADD-DETAILS                                        30489071
304900         TM500-CREATE-MANUAL       TO  TRUE.                      30490071
304910     MOVE 382                      TO  TM500-TRBL-RSN-CDE.        30491071
304920     MOVE 0                        TO  TM500-NOTIF-NBR.           30492071
304930     MOVE ASC-OPER-UNT-ID          TO  TM500-OPER-UNT-ID.         30493071
304940     MOVE 1                        TO  TM500-FCLTY-ID.            30494071
304950     MOVE ASC-PO-NBR               TO  TM500-PO-NBR.              30495071
304960     MOVE ASC-REC-SEQ-NBR          TO  TM500-REC-SEQ-NBR.         30496071
304970     SET TM500-LINE-LEVEL          TO  TRUE.                      30497071
304980     MOVE DK-LINE-NBR              TO  TM500-PO-LNE-NBR.          30498071
304990     MOVE PV-USER-ID               TO  TM500-CRE-UID              30499071
305000                                       TM500-NOTIF-UID.           30500071
305010                                                                  30501071
305020     EXEC CICS LINK                                               30502071
305030          PROGRAM (PC-TMKCS520)                                   30503071
305040          COMMAREA(TM500-FIELDS)                                  30504071
305050     END-EXEC.                                                    30505071
305060                                                                  30506071
305070     IF TM500-CALL-SUCCESSFUL                                     30507071
305080      OR TM500-DUPLICATE-TROUBLE                                  30508071
305090             CONTINUE                                             30509071
305100     ELSE                                                         30510071
305110         MOVE TM500-SQLCODE             TO PV-SOFT-SQLCODE        30511071
305120         MOVE '7475-CREATE-TROUBLE '    TO PV-SOFT-PARAGRAPH      30512071
305130         MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2      30513071
305140         MOVE LENGTH OF PV-CICS-MSG-AREA2                         30514071
305150           TO PV-COMMAREA-LENGTH                                  30515071
305160         EXEC CICS                                                30516071
305170              WRITEQ TD                                           30517071
305180               QUEUE  ('CSSL')                                    30518071
305190                FROM  (PV-CICS-MSG-AREA2)                         30519071
305200              LENGTH  (PV-COMMAREA-LENGTH)                        30520071
305210                RESP  (PV-CICS-RESP)                              30521071
305220         END-EXEC                                                 30522071
305230         SET PS-ERROR TO TRUE                                     30523071
305240         MOVE '7475-CREATE-TROUBLE '                              30524071
305250                               TO DP013-PARAGRAPH                 30525071
305260          MOVE 'UNABLE TO ACCESS CICS'                            30526071
305270                               TO DP013-MESSAGE-TEXT (1)          30527071
305280          MOVE TM500-SQLCA           TO DP013-SQLCA               30528071
305290          SET DP013-DB2-ABEND                                     30529071
305300              DP013-XCTL-DISPLAY-RESTART                          30530071
305310                               TO TRUE                            30531071
305320          PERFORM DP013-0000-PROCESS-ABEND                        30532071
305330     END-IF.                                                      30533071
305340                                                                  30534071
305350                                                                  30535071
305360 7500-CALL-PO-RCVR-TRKING-MOD.                                    30536071
305370                                                                  30537071
305380     INITIALIZE RC071-FIELDS.                                     30538071
305390     MOVE ASC-PO-NBR                TO RC071-PO-NBR               30539071
305400     MOVE ASC-REC-SEQ-NBR           TO RC071-PO-RCVR              30540071
305410                                                                  30541071
305420     IF DK-PREPK-ID   > 0                                         30542071
305430        MOVE DK-PREPK-ID            TO RC071-PREPK-ID             30543071
305440        MOVE ZERO                   TO RC071-PO-LINE              30544071
305450     ELSE                                                         30545071
305460        MOVE ZERO                   TO RC071-PREPK-ID             30546071
305470        MOVE DK-LINE-NBR            TO RC071-PO-LINE              30547071
305480     END-IF                                                       30548071
305490                                                                  30549071
305500     MOVE ASC-OPER-UNT-ID           TO RC071-SIGNON-LOCATION      30550071
305510     MOVE DP020-USERID              TO RC071-USER-ID              30551071
305520     MOVE PC-CURRENT-PROGRAM-NAME   TO RC071-CALLING-PROGRAM      30552071
305530     MOVE '21'                      TO RC071-DC-FUNCTION-CODE     30553071
305540                                                                  30554071
305550     MOVE LENGTH OF RC071-FIELDS    TO PV-COMMAREA-LENGTH.        30555071
305560                                                                  30556071
305570     CALL RC071-PO-RCVR-TRACKING USING  DFHEIBLK                  30557071
305580                                        RC071-COMMAREA            30558071
305590                                        RC071-FIELDS.             30559071
305600     EVALUATE TRUE                                                30560071
305610        WHEN RC071-SUCCESSFUL                                     30561071
305620            CONTINUE                                              30562071
305630        WHEN RC071-DATABASE-BUSY                                  30563071
305640          MOVE ASC-OPER-UNT-ID   TO  PV-DISPLAY-OPER              30564071
305650          MOVE ASC-PO-NBR        TO  PV-DISPLAY-PO-NBR            30565071
305660          MOVE ASC-REC-SEQ-NBR   TO  PV-DISPLAY-RCVR-SEQ-NBR      30566071
305670          INITIALIZE PV-CICS-MSG-AREA                             30567071
305680          STRING ' PCKCS701-7500- '                               30568071
305690                  PV-DISPLAY-OPER   '-'                           30569071
305700                  PV-DISPLAY-PO-NBR '-'                           30570071
305710                  PV-DISPLAY-RCVR-SEQ-NBR ' - '                   30571071
305720                 ' - CONTENTION'            DELIMITED BY SIZE     30572071
305730                                       INTO PV-CICS-MSG-AREA2     30573071
305740           MOVE LENGTH OF PV-CICS-MSG-AREA2                       30574071
305750                                         TO PV-COMMAREA-LENGTH    30575071
305760           EXEC CICS                                              30576071
305770                WRITEQ TD                                         30577071
305780                 QUEUE  ('CSSL')                                  30578071
305790                  FROM  (PV-CICS-MSG-AREA2)                       30579071
305800                LENGTH  (PV-COMMAREA-LENGTH)                      30580071
305810                  RESP  (PV-CICS-RESP)                            30581071
305820           END-EXEC                                               30582071
305830                                                                  30583071
305840        WHEN OTHER                                                30584071
305850          MOVE ASC-OPER-UNT-ID   TO  PV-DISPLAY-OPER              30585071
305860          MOVE ASC-PO-NBR        TO  PV-DISPLAY-PO-NBR            30586071
305870          MOVE ASC-REC-SEQ-NBR   TO  PV-DISPLAY-RCVR-SEQ-NBR      30587071
305880          INITIALIZE PV-CICS-MSG-AREA                             30588071
305890          STRING ' PCKCS701-7500- '                               30589071
305900                  PV-DISPLAY-OPER   '-'                           30590071
305910                  PV-DISPLAY-PO-NBR '-'                           30591071
305920                  PV-DISPLAY-RCVR-SEQ-NBR ' - '                   30592071
305930                 ' - SUCCESS IND - '                              30593071
305940                  RC071-SUCCESS-IND     DELIMITED BY SIZE         30594071
305950                                       INTO PV-CICS-MSG-AREA2     30595071
305960           MOVE LENGTH OF PV-CICS-MSG-AREA2                       30596071
305970                                         TO PV-COMMAREA-LENGTH    30597071
305980           EXEC CICS                                              30598071
305990                WRITEQ TD                                         30599071
306000                 QUEUE  ('CSSL')                                  30600071
306010                  FROM  (PV-CICS-MSG-AREA2)                       30601071
306020                LENGTH  (PV-COMMAREA-LENGTH)                      30602071
306030                  RESP  (PV-CICS-RESP)                            30603071
306040           END-EXEC.                                              30604071
306050                                                                  30605071
306060                                                                  30606071
306070******************************************************************30607071
306080* INSERT ROW INTO RECEIVER TRACKING TABLE FOR CASEPACK DOWNLOAD  *30608071
306090* RCT_PO_RCVR_TRKG                                               *30609071
306100******************************************************************30610071
306110 7510-RCVR-TRKING-DOWNLOAD.                                       30611071
306120                                                                  30612071
306130     INITIALIZE RC071-FIELDS.                                     30613071
306140     MOVE ASC-PO-NBR                TO RC071-PO-NBR               30614071
306150     MOVE ASC-REC-SEQ-NBR           TO RC071-PO-RCVR              30615071
306160                                                                  30616071
306170     IF DK-PREPK-ID   > 0                                         30617071
306180        MOVE DK-PREPK-ID            TO RC071-PREPK-ID             30618071
306190        MOVE ZERO                   TO RC071-PO-LINE              30619071
306200     ELSE                                                         30620071
306210        MOVE ZERO                   TO RC071-PREPK-ID             30621071
306220        MOVE LQW-PO-RCVR-LINE (LQW-IDX)                           30622071
306230                                    TO RC071-PO-LINE              30623071
306240     END-IF                                                       30624071
306250                                                                  30625071
306260     MOVE ASC-OPER-UNT-ID           TO RC071-SIGNON-LOCATION      30626071
306270     MOVE DP020-USERID              TO RC071-USER-ID              30627071
306280     MOVE PC-CURRENT-PROGRAM-NAME   TO RC071-CALLING-PROGRAM      30628071
306290                                                                  30629071
306300     IF  LQW-LNE-UCC128-YES (LQW-IDX)                             30630071
306310         MOVE '23'                  TO RC071-DC-FUNCTION-CODE     30631071
306320     ELSE                                                         30632071
306330         MOVE '22'                  TO RC071-DC-FUNCTION-CODE     30633071
306340     END-IF.                                                      30634071
306350                                                                  30635071
306360     MOVE LENGTH OF RC071-FIELDS    TO PV-COMMAREA-LENGTH.        30636071
306370                                                                  30637071
306380     CALL RC071-PO-RCVR-TRACKING USING  DFHEIBLK                  30638071
306390                                        RC071-COMMAREA            30639071
306400                                        RC071-FIELDS.             30640071
306410     EVALUATE TRUE                                                30641071
306420        WHEN RC071-SUCCESSFUL                                     30642071
306430            CONTINUE                                              30643071
306440        WHEN RC071-DATABASE-BUSY                                  30644071
306450          MOVE ASC-OPER-UNT-ID   TO  PV-DISPLAY-OPER              30645071
306460          MOVE ASC-PO-NBR        TO  PV-DISPLAY-PO-NBR            30646071
306470          MOVE ASC-REC-SEQ-NBR   TO  PV-DISPLAY-RCVR-SEQ-NBR      30647071
306480          INITIALIZE PV-CICS-MSG-AREA                             30648071
306490          STRING ' PCKCS701-7510- '                               30649071
306500                  PV-DISPLAY-OPER   '-'                           30650071
306510                  PV-DISPLAY-PO-NBR '-'                           30651071
306520                  PV-DISPLAY-RCVR-SEQ-NBR ' - '                   30652071
306530                 ' - CONTENTION'            DELIMITED BY SIZE     30653071
306540                                       INTO PV-CICS-MSG-AREA2     30654071
306550           MOVE LENGTH OF PV-CICS-MSG-AREA2                       30655071
306560                                         TO PV-COMMAREA-LENGTH    30656071
306570           EXEC CICS                                              30657071
306580                WRITEQ TD                                         30658071
306590                 QUEUE  ('CSSL')                                  30659071
306600                  FROM  (PV-CICS-MSG-AREA2)                       30660071
306610                LENGTH  (PV-COMMAREA-LENGTH)                      30661071
306620                  RESP  (PV-CICS-RESP)                            30662071
306630           END-EXEC                                               30663071
306640                                                                  30664071
306650        WHEN OTHER                                                30665071
306660          MOVE ASC-OPER-UNT-ID   TO  PV-DISPLAY-OPER              30666071
306670          MOVE ASC-PO-NBR        TO  PV-DISPLAY-PO-NBR            30667071
306680          MOVE ASC-REC-SEQ-NBR   TO  PV-DISPLAY-RCVR-SEQ-NBR      30668071
306690          INITIALIZE PV-CICS-MSG-AREA                             30669071
306700          STRING ' PCKCS701-7510- '                               30670071
306710                  PV-DISPLAY-OPER   '-'                           30671071
306720                  PV-DISPLAY-PO-NBR '-'                           30672071
306730                  PV-DISPLAY-RCVR-SEQ-NBR ' - '                   30673071
306740                 ' - SUCCESS IND - '                              30674071
306750                  RC071-SUCCESS-IND     DELIMITED BY SIZE         30675071
306760                                       INTO PV-CICS-MSG-AREA2     30676071
306770           MOVE LENGTH OF PV-CICS-MSG-AREA2                       30677071
306780                                         TO PV-COMMAREA-LENGTH    30678071
306790           EXEC CICS                                              30679071
306800                WRITEQ TD                                         30680071
306810                 QUEUE  ('CSSL')                                  30681071
306820                  FROM  (PV-CICS-MSG-AREA2)                       30682071
306830                LENGTH  (PV-COMMAREA-LENGTH)                      30683071
306840                  RESP  (PV-CICS-RESP)                            30684071
306850           END-EXEC.                                              30685071
306860                                                                  30686071
306870                                                                  30687071
306880*----------------------------------------------------------------*30688071
306890* CREATE DISTHD & DISTDT RECORDS FOR PREPACK ORDER - FOR LINES   *30689071
306900* NOT DOWNLOADED TO P2L.                                         *30690071
306910*----------------------------------------------------------------*30691071
306920 8000-PREPK-DISTRO.                                               30692071
306930                                                                  30693071
306940     SET  PS-PREPK-LINES-LEFT     TO  TRUE.                       30694071
306950     MOVE PV-PO-NBR               TO  DK-PO-NBR.                  30695071
306960     MOVE PV-REC-SEQ-NBR          TO  DK-REC-SEQ-NBR.             30696071
306970     MOVE PV-PO-LINE-NBR          TO  DK-LINE-NBR.                30697071
306980     MOVE PV-PREPK-ID             TO  DK-PREPK-ID.                30698071
306990                                                                  30699071
307000     COMPUTE PV-OUTER-PK-RATIO                                    30700071
307010           = DISTHD-OTPK-UNT-QTY                                  30701071
307020           / LQW-PREPK-RATIO (LQW-IDX).                           30702071
307030                                                                  30703071
307040     PERFORM 8010-OPEN-PREPK-CSR.                                 30704071
307050     PERFORM 8015-FETCH-PREPK-CSR                                 30705071
307060       UNTIL PS-SOFT-ABORT-ERROR                                  30706071
307070          OR PS-NO-PREPK-LINES-LEFT.                              30707071
307080     PERFORM 8020-CLOSE-PREPK-CSR.                                30708071
307090                                                                  30709071
307100                                                                  30710071
307110*----------------------------------------------------------------*30711071
307120* PRE-PACK ORDER - OPEN CURSOR                                   *30712071
307130*----------------------------------------------------------------*30713071
307140 8010-OPEN-PREPK-CSR.                                             30714071
307150     MOVE 'CURSOR:  PRE_PACK_CSR'                                 30715071
307160                       TO DP013-MESSAGE-TEXT (2).                 30716071
307170     EXEC SQL                                                     30717071
307180          OPEN PRE_PACK_LNE_CSR                                   30718071
307190     END-EXEC.                                                    30719071
307200                                                                  30720071
307210     EVALUATE TRUE                                                30721071
307220         WHEN SQLCODE = ZERO                                      30722071
307230             CONTINUE                                             30723071
307240         WHEN SQLCODE = -904                                      30724071
307250         WHEN SQLCODE = -911                                      30725071
307260         WHEN SQLCODE = -913                                      30726071
307270             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    30727071
307280             MOVE '8010-OPEN-PREPK-CSR    ' TO PV-SOFT-PARAGRAPH  30728071
307290             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  30729071
307300             MOVE LENGTH OF PV-CICS-MSG-AREA2                     30730071
307310               TO PV-COMMAREA-LENGTH                              30731071
307320             EXEC CICS                                            30732071
307330                  WRITEQ TD                                       30733071
307340                   QUEUE  ('CSSL')                                30734071
307350                    FROM  (PV-CICS-MSG-AREA2)                     30735071
307360                  LENGTH  (PV-COMMAREA-LENGTH)                    30736071
307370                    RESP  (PV-CICS-RESP)                          30737071
307380             END-EXEC                                             30738071
307390             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          30739071
307400             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              30740071
307410             PERFORM 9900-SOFT-ABORT                              30741071
307420         WHEN SQLWARN0 NOT = SPACES                               30742071
307430         WHEN SQLCODE < ZERO                                      30743071
307440         WHEN SQLCODE > ZERO                                      30744071
307450             MOVE '8010-OPEN-PREPK-CSR    '                       30745071
307460                               TO DP013-PARAGRAPH                 30746071
307470             MOVE 'OPEN SYSTEM MESSAGE CURSOR - '                 30747071
307480                               TO DP013-MESSAGE-TEXT (1)          30748071
307490             MOVE SQLCA        TO DP013-SQLCA                     30749071
307500             MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (1)        30750071
307510             MOVE 'TPURITM '   TO DP013-DB2-TABLE-NAME (2)        30751071
307520             SET DP013-DB2-ABEND                                  30752071
307530                 DP013-XCTL-DISPLAY-RESTART TO TRUE               30753071
307540             PERFORM DP013-0000-PROCESS-ABEND                     30754071
307550     END-EVALUATE.                                                30755071
307560                                                                  30756071
307570                                                                  30757071
307580*----------------------------------------------------------------*30758071
307590* PRE-PACK ORDER - FETCH CURSOR - LINES NOT DOWNLOADED TO P2L    *30759071
307600*----------------------------------------------------------------*30760071
307610 8015-FETCH-PREPK-CSR.                                            30761071
307620     MOVE 'CURSOR:  PRE_PACK_CSR'                                 30762071
307630                       TO DP013-MESSAGE-TEXT (2).                 30763071
307640                                                                  30764071
307650     EXEC SQL                                                     30765071
307660          FETCH PRE_PACK_LNE_CSR                                  30766071
307670           INTO :PV-PRPK-REC-ORD-LNE-NBR                          30767071
307680              , :PV-PRPK-REC-INNR-PACK-QTY                        30768071
307690              , :PV-PRPK-REC-OPER-UNT-ID                          30769071
307700              , :PV-PRPK-REC-FCLTY-ID                             30770071
307710              , :PV-PRPK-REC-STATUS-CDE                           30771071
307720              , :PV-PRPK-REC-PKSL-ITM-QTY                         30772071
307730              , :PV-PRPK-REC-DTL-CK-ITM-QTY                       30773071
307740              , :PV-PRPK-REC-PREPK-ID                             30774071
307750              , :PV-PRPK-REC-PREPK-RATO-QTY                       30775071
307760              , :PV-PRPK-REC-CASE-PACK-QTY                        30776071
307770              , :PURITM-ITM-NBR                                   30777071
307780     END-EXEC.                                                    30778071
307790                                                                  30779071
307800     EVALUATE TRUE                                                30780071
307810         WHEN SQLCODE = ZERO                                      30781071
307820              PERFORM 8025-BUILD-PREPK-HEADER                     30782071
307830                                                                  30783071
307840         WHEN SQLCODE = +100                                      30784071
307850         SET PS-NO-PREPK-LINES-LEFT                               30785071
307860                                   TO TRUE                        30786071
307870         WHEN SQLCODE = -904                                      30787071
307880         WHEN SQLCODE = -911                                      30788071
307890         WHEN SQLCODE = -913                                      30789071
307900             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    30790071
307910             MOVE '8015-FETCH-PREPK-CSR '   TO PV-SOFT-PARAGRAPH  30791071
307920             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  30792071
307930             MOVE LENGTH OF PV-CICS-MSG-AREA2                     30793071
307940               TO PV-COMMAREA-LENGTH                              30794071
307950             EXEC CICS                                            30795071
307960                  WRITEQ TD                                       30796071
307970                   QUEUE  ('CSSL')                                30797071
307980                    FROM  (PV-CICS-MSG-AREA2)                     30798071
307990                  LENGTH  (PV-COMMAREA-LENGTH)                    30799071
308000                    RESP  (PV-CICS-RESP)                          30800071
308010             END-EXEC                                             30801071
308020             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          30802071
308030             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              30803071
308040             PERFORM 9900-SOFT-ABORT                              30804071
308050         WHEN SQLWARN0 NOT = SPACE                                30805071
308060         WHEN SQLCODE NOT = ZERO                                  30806071
308070              MOVE ASC-PO-LINE-NBR                                30807071
308080                                TO DP013-MESSAGE-TEXT (3)         30808071
308090              MOVE '8015-FETCH-PREPK-CSR '                        30809071
308100                               TO DP013-PARAGRAPH                 30810071
308110              MOVE 'FETCH RECITM/PURITM CURSOR'                   30811071
308120                               TO DP013-MESSAGE-TEXT (1)          30812071
308130              MOVE SQLCA       TO DP013-SQLCA                     30813071
308140              SET DP013-DB2-ABEND                                 30814071
308150                               TO TRUE                            30815071
308160              PERFORM DP013-0000-PROCESS-ABEND                    30816071
308170     END-EVALUATE.                                                30817071
308180                                                                  30818071
308190*----------------------------------------------------------------*30819071
308200* PRE-PACK ORDER - CLOSE CURSOR                                  *30820071
308210*----------------------------------------------------------------*30821071
308220 8020-CLOSE-PREPK-CSR.                                            30822071
308230     MOVE 'CURSOR:  PRE_PACK_CSR'                                 30823071
308240                       TO DP013-MESSAGE-TEXT (2).                 30824071
308250     EXEC SQL                                                     30825071
308260          CLOSE PRE_PACK_LNE_CSR                                  30826071
308270     END-EXEC.                                                    30827071
308280                                                                  30828071
308290     EVALUATE TRUE                                                30829071
308300         WHEN SQLCODE = ZERO                                      30830071
308310             CONTINUE                                             30831071
308320         WHEN SQLCODE = -904                                      30832071
308330         WHEN SQLCODE = -911                                      30833071
308340         WHEN SQLCODE = -913                                      30834071
308350             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   30835071
308360             MOVE '8020-CLOSE-PREPK-CSR    ' TO PV-SOFT-PARAGRAPH 30836071
308370             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 30837071
308380             MOVE LENGTH OF PV-CICS-MSG-AREA2                     30838071
308390               TO PV-COMMAREA-LENGTH                              30839071
308400             EXEC CICS                                            30840071
308410                  WRITEQ TD                                       30841071
308420                   QUEUE  ('CSSL')                                30842071
308430                    FROM  (PV-CICS-MSG-AREA2)                     30843071
308440                  LENGTH  (PV-COMMAREA-LENGTH)                    30844071
308450                    RESP  (PV-CICS-RESP)                          30845071
308460             END-EXEC                                             30846071
308470             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          30847071
308480             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              30848071
308490             PERFORM 9900-SOFT-ABORT                              30849071
308500         WHEN SQLWARN0 NOT = SPACES                               30850071
308510         WHEN SQLCODE < ZERO                                      30851071
308520         WHEN SQLCODE > ZERO                                      30852071
308530             MOVE '8020-CLOSE-PREPK-CSR    '                      30853071
308540                               TO DP013-PARAGRAPH                 30854071
308550             MOVE 'CLOSE CURSOR                '                  30855071
308560                               TO DP013-MESSAGE-TEXT (1)          30856071
308570             MOVE SQLCA        TO DP013-SQLCA                     30857071
308580             MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (1)        30858071
308590             MOVE 'TPURITM '   TO DP013-DB2-TABLE-NAME (2)        30859071
308600             SET DP013-DB2-ABEND                                  30860071
308610                 DP013-XCTL-DISPLAY-RESTART TO TRUE               30861071
308620             PERFORM DP013-0000-PROCESS-ABEND                     30862071
308630     END-EVALUATE.                                                30863071
308640                                                                  30864071
308650                                                                  30865071
308660*----------------------------------------------------------------*30866071
308670* CREATE DISTRIBUTION HEADER PREPK LINE NOT DOWNLOADED (TDISTHD) *30867071
308680*----------------------------------------------------------------*30868071
308690 8025-BUILD-PREPK-HEADER.                                         30869071
308700                                                                  30870071
308710     MOVE 'X'                     TO  DISTHD-FCSE-LBL-TYP-CDE.    30871071
308720     MOVE 'P'                     TO  DISTHD-PREPK-LNE-PRC-CDE.   30872071
308730                                                                  30873071
308740     COMPUTE PV-OUTER-PK-PREPK                                    30874071
308750           = PV-OUTER-PK-RATIO                                    30875071
308760           * PV-PRPK-REC-PREPK-RATO-QTY.                          30876071
308770                                                                  30877071
308780     IF  PS-DISTHD-UPDATE                                         30878071
308790         PERFORM 8030-UPDATE-PREPK-DISTHD                         30879071
308800     ELSE                                                         30880071
308810     IF  PS-DISTHD-INSERT                                         30881071
308820         PERFORM 8040-INSERT-PREPK-DISTHD                         30882071
308830     END-IF                                                       30883071
308840     END-IF.                                                      30884071
308850                                                                  30885071
308860                                                                  30886071
308870*----------------------------------------------------------------*30887071
308880* UPDATE DISTRIBUTION HEADER PREPK LINE NOT DOWNLOADED (TDISTHD) *30888071
308890*----------------------------------------------------------------*30889071
308900 8030-UPDATE-PREPK-DISTHD.                                        30890071
308910                                                                  30891071
308920     MOVE DP020-USERID            TO DISTHD-CART-DWNLD-USR-ID.    30892071
308930     MOVE PV-CARTON-COUNT         TO DISTHD-TOT-CART-CNT.         30893071
308940     MOVE ASC-OPER-UNT-ID         TO DISTHD-OPER-UNT-ID.          30894071
308950                                                                  30895071
308960     PERFORM 8050-GET-PRCS-COUNTS-PREPK.                          30896071
308970     IF  LQW-LNE-UCC128-YES (LQW-IDX)                             30897071
308980         ADD  1  TO  DISTHD-VRTL-LBL-PRC-CNT                      30898071
308990     ELSE                                                         30899071
309000         ADD  1  TO  DISTHD-PHY-LBL-PRC-CNT                       30900071
309010     END-IF.                                                      30901071
309020                                                                  30902071
309030                                                                  30903071
309040     EXEC SQL                                                     30904071
309050          UPDATE TDISTHD                                          30905071
309060             SET                                                  30906071
309070                 TOT_CART_CNT        = :DISTHD-TOT-CART-CNT       30907071
309080               , P2L_CART_CNT        = :DISTHD-P2L-CART-CNT       30908071
309090               , INPK_UNT_QTY        = :PV-PRPK-REC-PREPK-RATO-QTY30909071
309100               , OTPK_UNT_QTY        = :PV-OUTER-PK-PREPK         30910071
309110               , CART_DWNLD_USR_ID   = :DISTHD-CART-DWNLD-USR-ID  30911071
309120               , FCSE_CART_CNT       = :DISTHD-FCSE-CART-CNT      30912071
309130               , INPK_CART_CNT       = :DISTHD-INPK-CART-CNT      30913071
309140               , PRC_AREA_MODU_ID    = :DISTHD-PRC-AREA-MODU-ID   30914071
309150               , PRCG_STAT_CDE       = :DISTHD-PRCG-STAT-CDE      30915071
309160               , CRE_USR_ID          = :DP020-USERID              30916071
309170               , CART_DWNLD_DTE      =  CURRENT DATE              30917071
309180               , CART_DWNLD_TM       =  CURRENT TIME              30918071
309190               , FCSE_LBL_TYP_CDE    = :DISTHD-FCSE-LBL-TYP-CDE   30919071
309200               , INPK_CNVYB_IND      = :DISTHD-INPK-CNVYB-IND     30920071
309210               , SYS_CRE_CDE         = :DISTHD-SYS-CRE-CDE        30921071
309220               , CRE_TMST            =  CURRENT TIMESTAMP         30922071
309230               , FCSE_FCLTY_AREA_ID  = :DISTHD-FCSE-FCLTY-AREA-ID 30923071
309240               , CRE_LBL_OPT_CDE     = :DISTHD-CRE-LBL-OPT-CDE    30924071
309250               , ODD_CART_UNT_QTY    = :DISTHD-ODD-CART-UNT-QTY   30925071
309260               , PREPK_LNE_PRC_CDE   = :DISTHD-PREPK-LNE-PRC-CDE  30926071
309270               , OPER_UNT_ID         = :DISTHD-OPER-UNT-ID        30927071
309280           WHERE ORD_NBR             = :DK-PO-NBR                 30928071
309290             AND RCVR_SEQ_NBR        = :DK-REC-SEQ-NBR            30929071
309300             AND ORD_LNE_NBR         = :PV-PRPK-REC-ORD-LNE-NBR   30930071
309310     END-EXEC.                                                    30931071
309320                                                                  30932071
309330     EVALUATE TRUE                                                30933071
309340         WHEN SQLCODE = ZERO                                      30934071
309350              CONTINUE                                            30935071
309360         WHEN SQLCODE = +100                                      30936071
309370              PERFORM 8040-INSERT-PREPK-DISTHD                    30937071
309380         WHEN SQLCODE = -904                                      30938071
309390         WHEN SQLCODE = -911                                      30939071
309400         WHEN SQLCODE = -913                                      30940071
309410                                                                  30941071
309420             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   30942071
309430             MOVE '8030-UPDATE-PREPK-DISTHD   '                   30943071
309440                                             TO PV-SOFT-PARAGRAPH 30944071
309450             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 30945071
309460             MOVE LENGTH OF PV-CICS-MSG-AREA2                     30946071
309470               TO PV-COMMAREA-LENGTH                              30947071
309480             EXEC CICS                                            30948071
309490                  WRITEQ TD                                       30949071
309500                   QUEUE  ('CSSL')                                30950071
309510                    FROM  (PV-CICS-MSG-AREA2)                     30951071
309520                  LENGTH  (PV-COMMAREA-LENGTH)                    30952071
309530                    RESP  (PV-CICS-RESP)                          30953071
309540             END-EXEC                                             30954071
309550                                                                  30955071
309560              MOVE  PC-TSYMSG-00551  TO  DP020-MSG-NUMBER         30956071
309570              PERFORM 9900-SOFT-ABORT                             30957071
309580         WHEN SQLWARN0 NOT = SPACES                               30958071
309590         WHEN SQLCODE NOT EQUAL ZERO                              30959071
309600              MOVE '8030-UPDATE-PREPK-DISTHD   '                  30960071
309610                                   TO DP013-PARAGRAPH             30961071
309620              MOVE 'UPDATE COUNTS IN TRANS HEADER ROW'            30962071
309630                                   TO DP013-MESSAGE-TEXT (1)      30963071
309640              MOVE SQLCA           TO DP013-SQLCA                 30964071
309650              MOVE 'TDISTHD'       TO DP013-DB2-TABLE-NAME (1)    30965071
309660              SET DP013-DB2-ABEND  TO TRUE                        30966071
309670              PERFORM DP013-0000-PROCESS-ABEND                    30967071
309680     END-EVALUATE.                                                30968071
309690                                                                  30969071
309700                                                                  30970071
309710*----------------------------------------------------------------*30971071
309720* INSERT DISTRIBUTION HEADER PREPK LINE NOT DOWNLOADED (TDISTHD) *30972071
309730*----------------------------------------------------------------*30973071
309740 8040-INSERT-PREPK-DISTHD.                                        30974071
309750                                                                  30975071
309760     MOVE  PC-DEFAULT-TIMESTAMP  TO  DISTHD-FCSE-CNFRMN-TMST.     30976071
309770     MOVE  PC-DEFAULT-TIMESTAMP  TO  DISTHD-DLT-REQ-TMST.         30977071
309780                                                                  30978071
309790     IF  LQW-LNE-UCC128-YES (LQW-IDX)                             30979071
309800         MOVE 1  TO  DISTHD-VRTL-LBL-PRC-CNT                      30980071
309900     ELSE                                                         30990071
309910         MOVE 1  TO  DISTHD-PHY-LBL-PRC-CNT                       30991071
309920     END-IF.                                                      30992071
309930                                                                  30993071
309940     EXEC SQL                                                     30994071
309950          INSERT INTO TDISTHD                                     30995071
309960           ( ORD_NBR                                              30996071
309970            ,RCVR_SEQ_NBR                                         30997071
309980            ,ORD_LNE_NBR                                          30998071
309990            ,WRK_ORD_SEQ_NBR                                      30999071
310000            ,OPER_UNT_ID                                          31000071
310010            ,DISTRB_PRC_AREA_ID                                   31001071
310020            ,PRCG_STAT_CDE                                        31002071
310030            ,CRE_TMST                                             31003071
310040            ,RSLTS_RCVD_TMST                                      31004071
310050            ,VRFD_TMST                                            31005071
310060            ,PRC_AREA_MODU_ID                                     31006071
310070            ,CRE_USR_ID                                           31007071
310080            ,TOT_CART_CNT                                         31008071
310090            ,CART_DWNLD_DTE                                       31009071
310100            ,CART_DWNLD_TM                                        31010071
310110            ,CART_DWNLD_USR_ID                                    31011071
310120            ,FCSE_CART_CNT                                        31012071
310130            ,FCSE_LBL_TYP_CDE                                     31013071
310140            ,P2L_CART_CNT                                         31014071
310150            ,INPK_CART_CNT                                        31015071
310160            ,INPK_UNT_QTY                                         31016071
310170            ,INPK_CNVYB_IND                                       31017071
310180            ,OTPK_UNT_QTY                                         31018071
310190            ,SYS_CRE_CDE                                          31019071
310200            ,SPC_INSTR_DESC                                       31020071
310210            ,FCSE_CNFRMN_TMST                                     31021071
310220            ,FCSE_FCLTY_AREA_ID                                   31022071
310230            ,CRE_LBL_OPT_CDE                                      31023071
310240            ,ODD_CART_UNT_QTY                                     31024071
310250            ,DLT_REQ_TMST                                         31025071
310260            ,PREPK_LNE_PRC_CDE                                    31026071
310270            ,PHY_LBL_PRC_CNT                                      31027071
310280            ,VRTL_LBL_PRC_CNT                                     31028071
310290           )                                                      31029071
310300         VALUES (                                                 31030071
310310             :DK-PO-NBR                                           31031071
310320           , :DK-REC-SEQ-NBR                                      31032071
310330           , :PV-PRPK-REC-ORD-LNE-NBR                             31033071
310340           , :DK-WORK-ORD-SEQ-NBR                                 31034071
310350           , :DK-OPER-UNT-ID                                      31035071
310360           , :DISTHD-DISTRB-PRC-AREA-ID                           31036071
310370           , :DISTHD-PRCG-STAT-CDE                                31037071
310380           ,  CURRENT TIMESTAMP                                   31038071
310390           , :DISTHD-RSLTS-RCVD-TMST                              31039071
310400           , :DISTHD-VRFD-TMST                                    31040071
310410           , :DISTHD-PRC-AREA-MODU-ID                             31041071
310420           , :DISTHD-CRE-USR-ID                                   31042071
310430           , :DISTHD-TOT-CART-CNT                                 31043071
310440           ,  CURRENT DATE                                        31044071
310450           ,  CURRENT TIME                                        31045071
310460           , :DP020-USERID                                        31046071
310470           , :DISTHD-FCSE-CART-CNT                                31047071
310480           , :DISTHD-FCSE-LBL-TYP-CDE                             31048071
310490           , :DISTHD-P2L-CART-CNT                                 31049071
310500           , :DISTHD-INPK-CART-CNT                                31050071
310510           , :PV-PRPK-REC-PREPK-RATO-QTY                          31051071
310520           , :DISTHD-INPK-CNVYB-IND                               31052071
310530           , :PV-OUTER-PK-PREPK                                   31053071
310540           , :DISTHD-SYS-CRE-CDE                                  31054071
310550           , :DISTHD-SPC-INSTR-DESC                               31055071
310560           , :DISTHD-FCSE-CNFRMN-TMST                             31056071
310570           , :DISTHD-FCSE-FCLTY-AREA-ID                           31057071
310580           , :DISTHD-CRE-LBL-OPT-CDE                              31058071
310590           , :DISTHD-ODD-CART-UNT-QTY                             31059071
310600           , :DISTHD-DLT-REQ-TMST                                 31060071
310610           , :DISTHD-PREPK-LNE-PRC-CDE                            31061071
310620           , :DISTHD-PHY-LBL-PRC-CNT                              31062071
310630           , :DISTHD-VRTL-LBL-PRC-CNT                             31063071
310640         )                                                        31064071
310650     END-EXEC.                                                    31065071
310660                                                                  31066071
310670     EVALUATE TRUE                                                31067071
310680         WHEN SQLCODE = ZERO                                      31068071
310690              CONTINUE                                            31069071
310700         WHEN SQLCODE = -803                                      31070071
310710              PERFORM 8030-UPDATE-PREPK-DISTHD                    31071071
310720         WHEN SQLCODE = -904                                      31072071
310730         WHEN SQLCODE = -911                                      31073071
310740         WHEN SQLCODE = -913                                      31074071
310750                                                                  31075071
310760             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   31076071
310770             MOVE '8040-INSERT-PREPK-DISTHD   '                   31077071
310780                                             TO PV-SOFT-PARAGRAPH 31078071
310790             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 31079071
310800             MOVE LENGTH OF PV-CICS-MSG-AREA2                     31080071
310810               TO PV-COMMAREA-LENGTH                              31081071
310820             EXEC CICS                                            31082071
310830                  WRITEQ TD                                       31083071
310840                   QUEUE  ('CSSL')                                31084071
310850                    FROM  (PV-CICS-MSG-AREA2)                     31085071
310860                  LENGTH  (PV-COMMAREA-LENGTH)                    31086071
310870                    RESP  (PV-CICS-RESP)                          31087071
310880             END-EXEC                                             31088071
310890                                                                  31089071
310900              MOVE  PC-TSYMSG-00551  TO  DP020-MSG-NUMBER         31090071
310910              PERFORM 9900-SOFT-ABORT                             31091071
310920         WHEN SQLWARN0 NOT = SPACES                               31092071
310930         WHEN SQLCODE NOT EQUAL ZERO                              31093071
310940              MOVE '8040-INSERT-PREPK-DISTHD   '                  31094071
310950                                   TO DP013-PARAGRAPH             31095071
310960              MOVE 'INSERT TRANSACTION HEADER ROW'                31096071
310970                                   TO DP013-MESSAGE-TEXT (1)      31097071
310980             MOVE DK-PO-NBR      TO  PV-DSPLY-PO                  31098071
310990             MOVE DK-REC-SEQ-NBR TO  PV-DSPLY-RCVR                31099071
311000             MOVE PV-PRPK-REC-ORD-LNE-NBR                         31100071
311010                                 TO  PV-DSPLY-LNE                 31101071
311020             STRING  ' PO/RCVR/LNE - ' DELIMITED BY SIZE          31102071
311030                     PV-DSPLY-PO       DELIMITED BY SIZE          31103071
311040                     '-'               DELIMITED BY SIZE          31104071
311050                     PV-DSPLY-RCVR     DELIMITED BY SIZE          31105071
311060                     '-'               DELIMITED BY SIZE          31106071
311070                     PV-DSPLY-LNE      DELIMITED BY SIZE          31107071
311080                             INTO DP013-MESSAGE-TEXT (2)          31108071
311090              MOVE SQLCA           TO DP013-SQLCA                 31109071
311100              MOVE 'TDISTHD'       TO DP013-DB2-TABLE-NAME (1)    31110071
311110              SET DP013-DB2-ABEND  TO TRUE                        31111071
311120              PERFORM DP013-0000-PROCESS-ABEND                    31112071
311130     END-EVALUATE.                                                31113071
311140                                                                  31114071
311150                                                                  31115071
311160*----------------------------------------------------------------*31116071
311170* DMH - 1/23/04 - LABOR - BEGIN                                   31117071
311180*  SELECT THE COUNTS FROM THE HEADER TABLE TO DETERMINE HOW      *31118071
311190*  MANY TIMES A LINE HAS BEEN PROCESSED USING UCC128 DATA AND    *31119071
311200*  PHYSICAL LABELS - prepacks                                    *31120071
311210*----------------------------------------------------------------*31121071
311220 8050-GET-PRCS-COUNTS-PREPK.                                      31122071
311230                                                                  31123071
311240     EXEC SQL                                                     31124071
311250          SELECT  PHY_LBL_PRC_CNT                                 31125071
311260                 ,VRTL_LBL_PRC_CNT                                31126071
311270          INTO    :DISTHD-PHY-LBL-PRC-CNT                         31127071
311280                 ,:DISTHD-VRTL-LBL-PRC-CNT                        31128071
311290          FROM    TDISTHD                                         31129071
311300          WHERE   ORD_NBR       = :DK-PO-NBR                      31130071
311310            AND   RCVR_SEQ_NBR  = :DK-REC-SEQ-NBR                 31131071
311320            AND   ORD_LNE_NBR   = :PV-PRPK-REC-ORD-LNE-NBR        31132071
311330     END-EXEC.                                                    31133071
311340                                                                  31134071
311350     EVALUATE TRUE                                                31135071
311360         WHEN SQLCODE = ZERO                                      31136071
311370         WHEN SQLCODE = +100                                      31137071
311380              CONTINUE                                            31138071
311390         WHEN SQLCODE = -904                                      31139071
311400         WHEN SQLCODE = -911                                      31140071
311410         WHEN SQLCODE = -913                                      31141071
311420                                                                  31142071
311430             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   31143071
311440             MOVE '8050-GET-PRCS-COUNTS-PREPK'                    31144071
311450                                             TO PV-SOFT-PARAGRAPH 31145071
311460             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 31146071
311470             MOVE LENGTH OF PV-CICS-MSG-AREA2                     31147071
311480               TO PV-COMMAREA-LENGTH                              31148071
311490             EXEC CICS                                            31149071
311500                  WRITEQ TD                                       31150071
311510                   QUEUE  ('CSSL')                                31151071
311520                    FROM  (PV-CICS-MSG-AREA2)                     31152071
311530                  LENGTH  (PV-COMMAREA-LENGTH)                    31153071
311540                    RESP  (PV-CICS-RESP)                          31154071
311550             END-EXEC                                             31155071
311560                                                                  31156071
311570              MOVE  PC-TSYMSG-00551  TO  DP020-MSG-NUMBER         31157071
311580              PERFORM 9900-SOFT-ABORT                             31158071
311590                                                                  31159071
311600         WHEN SQLWARN0 NOT = SPACES                               31160071
311610         WHEN SQLCODE NOT EQUAL ZERO                              31161071
311620              MOVE '8050-GET-PRCS-COUNTS-PREPK'                   31162071
311630                                   TO DP013-PARAGRAPH             31163071
311640              MOVE 'GET LABEL PROCESS COUNTS'                     31164071
311650                                   TO DP013-MESSAGE-TEXT (1)      31165071
311660              MOVE SQLCA           TO DP013-SQLCA                 31166071
311670              MOVE 'TDISTHD'       TO DP013-DB2-TABLE-NAME (1)    31167071
311680              SET DP013-DB2-ABEND  TO TRUE                        31168071
311690              PERFORM DP013-0000-PROCESS-ABEND                    31169071
311700     END-EVALUATE.                                                31170071
311710                                                                  31171071
311720                                                                  31172071
311730*----------------------------------------------------------------*31173071
311740* CREATE DISTDT RECORDS FOR PREPACK ORDER - FOR LINES NOT SENT   *31174071
311750* DOWN TO P2L.                                                   *31175071
311760*----------------------------------------------------------------*31176071
311770 8100-PREPK-DISTRO.                                               31177071
311780     SET  PS-PREPK-LINES-LEFT      TO  TRUE.                      31178071
311790     MOVE PV-PO-NBR                TO  DK-PO-NBR.                 31179071
311800     MOVE PV-REC-SEQ-NBR           TO  DK-REC-SEQ-NBR.            31180071
311810     MOVE PV-PO-LINE-NBR           TO  DK-LINE-NBR.               31181071
311820     MOVE PV-PREPK-ID              TO  DK-PREPK-ID.               31182071
311830                                                                  31183071
311840     PERFORM 8010-OPEN-PREPK-CSR.                                 31184071
311850     PERFORM 8115-FETCH-PREPK-CSR                                 31185071
311860       UNTIL PS-SOFT-ABORT-ERROR                                  31186071
311870          OR PS-NO-PREPK-LINES-LEFT.                              31187071
311880     PERFORM 8020-CLOSE-PREPK-CSR.                                31188071
311890                                                                  31189071
311900                                                                  31190071
311910*----------------------------------------------------------------*31191071
311920* DETERMINE LABEL/UNIT QUANTITIES BASED ON DOWNLOAD LINE RATIO   *31192071
311930*----------------------------------------------------------------*31193071
311940 8105-QTY-RATIOS.                                                 31194071
311950                                                                  31195071
311960     DIVIDE    DISTDT-P2L-SPLT-UNT-QTY                            31196071
311970         BY    LQW-PREPK-RATIO (LQW-IDX)                          31197071
311980     GIVING    PV-P2L-SPLT-UNT-QTY-RATIO                          31198071
311990     REMAINDER PV-P2L-SPLT-UNT-QTY-REM.                           31199071
312000                                                                  31200071
312010     DIVIDE    DISTDT-FCSE-SPLT-UNT-QTY                           31201071
312020         BY    LQW-PREPK-RATIO (LQW-IDX)                          31202071
312030     GIVING    PV-FCSE-SPLT-UNT-QTY-RATIO                         31203071
312040     REMAINDER PV-FCSE-SPLT-UNT-QTY-REM.                          31204071
312050                                                                  31205071
312060     DIVIDE    DISTDT-INPK-SPLT-UNT-QTY                           31206071
312070         BY    LQW-PREPK-RATIO (LQW-IDX)                          31207071
312080     GIVING    PV-INPK-SPLT-UNT-QTY-RATIO                         31208071
312090     REMAINDER PV-INPK-SPLT-UNT-QTY-REM.                          31209071
312100                                                                  31210071
312110     DIVIDE    DISTDT-FCSE-ACTL-UNT-QTY                           31211071
312120         BY    LQW-PREPK-RATIO (LQW-IDX)                          31212071
312130     GIVING    PV-FCSE-ACTL-UNT-QTY-RATIO                         31213071
312140     REMAINDER PV-FCSE-ACTL-UNT-QTY-REM.                          31214071
312150                                                                  31215071
312160     DIVIDE    RECDIS-EXPTED-ITM-QTY                              31216071
312170         BY    LQW-PREPK-RATIO (LQW-IDX)                          31217071
312180     GIVING    PV-EXPTED-ITM-QTY-RATIO                            31218071
312190     REMAINDER PV-EXPTED-ITM-QTY-REM.                             31219071
312200                                                                  31220071
312210     DIVIDE    DISTDT-ACTL-ALLOC-QTY                              31221071
312220         BY    LQW-PREPK-RATIO (LQW-IDX)                          31222071
312230     GIVING    PV-ACTL-ALLOC-QTY-RATIO                            31223071
312240     REMAINDER PV-ACTL-ALLOC-QTY-REM.                             31224071
312250                                                                  31225071
312260     IF  PV-P2L-SPLT-UNT-QTY-REM   >  0  OR                       31226071
312270         PV-FCSE-SPLT-UNT-QTY-REM  >  0  OR                       31227071
312280         PV-INPK-SPLT-UNT-QTY-REM  >  0  OR                       31228071
312290         PV-FCSE-ACTL-UNT-QTY-REM  >  0  OR                       31229071
312300         PV-EXPTED-ITM-QTY-REM     >  0  OR                       31230071
312310         PV-ACTL-ALLOC-QTY-REM     >  0                           31231071
312320         MOVE PC-TSYMSG-02480      TO  DP020-MSG-NUMBER           31232071
312330         SET  PS-SOFT-ABORT-ERROR                                 31233071
312340              PS-ERROR                                            31234071
312350              DP020-MSG-FATAL                                     31235071
312360              PS-RATIO-ALLOCATION-ERROR  TO TRUE                  31236071
312370         SET  LQW-ERR (LQW-IDX)          TO TRUE                  31237071
312380         EXEC CICS SYNCPOINT                                      31238071
312390              ROLLBACK                                            31239071
312400         END-EXEC                                                 31240071
312410     END-IF.                                                      31241071
312420                                                                  31242071
312430                                                                  31243071
312440*----------------------------------------------------------------*31244071
312450* PRE-PACK ORDER - FETCH CURSOR - LINES NOT DOWNLOADED TO P2L    *31245071
312460*----------------------------------------------------------------*31246071
312470 8115-FETCH-PREPK-CSR.                                            31247071
312480     MOVE 'CURSOR:  PRE_PACK_CSR'                                 31248071
312490                       TO DP013-MESSAGE-TEXT (2).                 31249071
312500                                                                  31250071
312510     EXEC SQL                                                     31251071
312520          FETCH PRE_PACK_LNE_CSR                                  31252071
312530           INTO :PV-PRPK-REC-ORD-LNE-NBR                          31253071
312540              , :PV-PRPK-REC-INNR-PACK-QTY                        31254071
312550              , :PV-PRPK-REC-OPER-UNT-ID                          31255071
312560              , :PV-PRPK-REC-FCLTY-ID                             31256071
312570              , :PV-PRPK-REC-STATUS-CDE                           31257071
312580              , :PV-PRPK-REC-PKSL-ITM-QTY                         31258071
312590              , :PV-PRPK-REC-DTL-CK-ITM-QTY                       31259071
312600              , :PV-PRPK-REC-PREPK-ID                             31260071
312610              , :PV-PRPK-REC-PREPK-RATO-QTY                       31261071
312620              , :PV-PRPK-REC-CASE-PACK-QTY                        31262071
312630              , :PURITM-ITM-NBR                                   31263071
312640     END-EXEC.                                                    31264071
312650                                                                  31265071
312660     EVALUATE TRUE                                                31266071
312670         WHEN SQLCODE = ZERO                                      31267071
312680              SET  PS-DISTDT-INVALID-INSERT TO TRUE               31268071
312690              PERFORM 8120-BUILD-PREPK-DETAIL                     31269071
312700               UNTIL  PS-DISTDT-VALID-INSERT  OR                  31270071
312710                      PS-ERROR        OR                          31271071
312720                      PS-SOFT-ABORT-ERROR                         31272071
312730         WHEN SQLCODE = +100                                      31273071
312740              SET PS-NO-PREPK-LINES-LEFT         TO TRUE          31274071
312750         WHEN SQLCODE = -904                                      31275071
312760         WHEN SQLCODE = -911                                      31276071
312770         WHEN SQLCODE = -913                                      31277071
312780             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    31278071
312790             MOVE '8115-FETCH-PREPK-CSR '   TO PV-SOFT-PARAGRAPH  31279071
312800             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  31280071
312810             MOVE LENGTH OF PV-CICS-MSG-AREA2                     31281071
312820               TO PV-COMMAREA-LENGTH                              31282071
312830             EXEC CICS                                            31283071
312840                  WRITEQ TD                                       31284071
312850                   QUEUE  ('CSSL')                                31285071
312860                    FROM  (PV-CICS-MSG-AREA2)                     31286071
312870                  LENGTH  (PV-COMMAREA-LENGTH)                    31287071
312880                    RESP  (PV-CICS-RESP)                          31288071
312890             END-EXEC                                             31289071
312900             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          31290071
312910             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              31291071
312920             PERFORM 9900-SOFT-ABORT                              31292071
312930         WHEN SQLWARN0 NOT = SPACE                                31293071
312940         WHEN SQLCODE NOT = ZERO                                  31294071
312950              MOVE ASC-PO-LINE-NBR                                31295071
312960                                TO DP013-MESSAGE-TEXT (3)         31296071
312970              MOVE '8115-FETCH-PREPK-CSR '                        31297071
312980                               TO DP013-PARAGRAPH                 31298071
312990              MOVE 'FETCH RECITM/PURITM CURSOR'                   31299071
313000                               TO DP013-MESSAGE-TEXT (1)          31300071
313010              MOVE SQLCA       TO DP013-SQLCA                     31301071
313020              SET DP013-DB2-ABEND                                 31302071
313030                               TO TRUE                            31303071
313040              PERFORM DP013-0000-PROCESS-ABEND                    31304071
313050     END-EVALUATE.                                                31305071
313060                                                                  31306071
313070                                                                  31307071
313080*----------------------------------------------------------------*31308071
313090* CREATE DISTRIBUTION DETAIL PREPK LINE NOT DOWNLOADED (TDISTDT) *31309071
313100*----------------------------------------------------------------*31310071
313110 8120-BUILD-PREPK-DETAIL.                                         31311071
313120                                                                  31312071
313130     COMPUTE PV-P2L-SPLT-UNT-QTY-PREPK                            31313071
313140           = PV-P2L-SPLT-UNT-QTY-RATIO                            31314071
313150           * PV-PRPK-REC-PREPK-RATO-QTY.                          31315071
313160                                                                  31316071
313170     COMPUTE PV-FCSE-SPLT-UNT-QTY-PREPK                           31317071
313180           = PV-FCSE-SPLT-UNT-QTY-RATIO                           31318071
313190           * PV-PRPK-REC-PREPK-RATO-QTY.                          31319071
313200                                                                  31320071
313210     COMPUTE PV-INPK-SPLT-UNT-QTY-PREPK                           31321071
313220           = PV-INPK-SPLT-UNT-QTY-RATIO                           31322071
313230           * PV-PRPK-REC-PREPK-RATO-QTY.                          31323071
313240                                                                  31324071
313250     COMPUTE PV-FCSE-ACTL-UNT-QTY-PREPK                           31325071
313260           = PV-FCSE-ACTL-UNT-QTY-RATIO                           31326071
313270           * PV-PRPK-REC-PREPK-RATO-QTY.                          31327071
313280                                                                  31328071
313290     COMPUTE PV-EXPTED-ITM-QTY-PREPK                              31329071
313300           = PV-EXPTED-ITM-QTY-RATIO                              31330071
313310           * PV-PRPK-REC-PREPK-RATO-QTY.                          31331071
313320                                                                  31332071
313330     COMPUTE PV-ACTL-ALLOC-QTY-PREPK                              31333071
313340           = PV-ACTL-ALLOC-QTY-RATIO                              31334071
313350           * PV-PRPK-REC-PREPK-RATO-QTY.                          31335071
313360                                                                  31336071
313370     MOVE ZEROES  TO  DISTDT-PREPK-ODD-UNT-QTY.                   31337071
313380                                                                  31338071
313390     EXEC SQL                                                     31339071
313400          INSERT                                                  31340071
313410          INTO  TDISTDT                                           31341071
313420               (ORD_NBR                                           31342071
313430               ,RCVR_SEQ_NBR                                      31343071
313440               ,ORD_LNE_NBR                                       31344071
313450               ,WRK_ORD_SEQ_NBR                                   31345071
313460               ,STR_NBR                                           31346071
313470               ,EXPTED_ALLOC_QTY                                  31347071
313480               ,ACTL_ALLOC_QTY                                    31348071
313490               ,RCVG_PSTD_STAT_CDE                                31349071
313500              , P2L_SPLT_UNT_QTY                                  31350071
313510              , FCSE_SPLT_UNT_QTY                                 31351071
313520              , INPK_SPLT_UNT_QTY                                 31352071
313530              , FCSE_ACTL_UNT_QTY                                 31353071
313540              , ODD_CART_IND                                      31354071
313550              , PREPK_ODD_UNT_QTY)                                31355071
313560        VALUES                                                    31356071
313570              (:DK-PO-NBR                                         31357071
313580              ,:DK-REC-SEQ-NBR                                    31358071
313590              ,:PV-PRPK-REC-ORD-LNE-NBR                           31359071
313600              ,:DK-WORK-ORD-SEQ-NBR                               31360071
313610              ,:RECDIS-STR-NBR                                    31361071
313620              ,:PV-EXPTED-ITM-QTY-PREPK                           31362071
313630              ,:PV-ACTL-ALLOC-QTY-PREPK                           31363071
313640              ,:PC-READY-TO-POST-STATUS                           31364071
313650              ,:PV-P2L-SPLT-UNT-QTY-PREPK                         31365071
313660              ,:PV-FCSE-SPLT-UNT-QTY-PREPK                        31366071
313670              ,:PV-INPK-SPLT-UNT-QTY-PREPK                        31367071
313680              ,:PV-FCSE-ACTL-UNT-QTY-PREPK                        31368071
313690              ,:DISTDT-ODD-CART-IND                               31369071
313700              ,:DISTDT-PREPK-ODD-UNT-QTY)                         31370071
313710     END-EXEC.                                                    31371071
313720                                                                  31372071
313730     EVALUATE TRUE                                                31373071
313740         WHEN SQLCODE = ZERO                                      31374071
313750              SET PS-DISTDT-VALID-INSERT TO TRUE                  31375071
313760         WHEN SQLCODE = -803                                      31376071
313770              SET PS-DISTDT-INVALID-INSERT TO TRUE                31377071
313780              PERFORM 4768-DELETE-PREPK-DTL                       31378071
313790         WHEN SQLCODE = -904                                      31379071
313800         WHEN SQLCODE = -911                                      31380071
313810         WHEN SQLCODE = -913                                      31381071
313820             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   31382071
313830             MOVE '8120-BUILD-PREPK-DETAIL'                       31383071
313840                                             TO PV-SOFT-PARAGRAPH 31384071
313850             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 31385071
313860             MOVE LENGTH OF PV-CICS-MSG-AREA2                     31386071
313870               TO PV-COMMAREA-LENGTH                              31387071
313880             EXEC CICS                                            31388071
313890                  WRITEQ TD                                       31389071
313900                   QUEUE  ('CSSL')                                31390071
313910                    FROM  (PV-CICS-MSG-AREA2)                     31391071
313920                  LENGTH  (PV-COMMAREA-LENGTH)                    31392071
313930                    RESP  (PV-CICS-RESP)                          31393071
313940             END-EXEC                                             31394071
313950              MOVE  PC-TSYMSG-01767  TO  DP020-MSG-NUMBER         31395071
313960              PERFORM 9900-SOFT-ABORT                             31396071
313970         WHEN SQLWARN0 NOT = SPACES                               31397071
313980         WHEN SQLCODE NOT EQUAL ZERO                              31398071
313990                                                                  31399071
314000             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   31400071
314010             MOVE '8120-BUILD-PREPK-DETAIL'                       31401071
314020                                             TO PV-SOFT-PARAGRAPH 31402071
314030             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 31403071
314040             MOVE LENGTH OF PV-CICS-MSG-AREA2                     31404071
314050               TO PV-COMMAREA-LENGTH                              31405071
314060             EXEC CICS                                            31406071
314070                  WRITEQ TD                                       31407071
314080                   QUEUE  ('CSSL')                                31408071
314090                    FROM  (PV-CICS-MSG-AREA2)                     31409071
314100                  LENGTH  (PV-COMMAREA-LENGTH)                    31410071
314110                    RESP  (PV-CICS-RESP)                          31411071
314120             END-EXEC                                             31412071
314130             MOVE DK-PO-NBR          TO  PV-HOLD3-PO              31413071
314140             MOVE DK-REC-SEQ-NBR     TO  PV-HOLD3-RCVR            31414071
314150             MOVE DK-LINE-NBR        TO  PV-HOLD3-LINE            31415071
314160             MOVE PV-CICS-MSG-HOLD3  TO  PV-CICS-MSG-AREA2        31416071
314170             MOVE LENGTH OF PV-CICS-MSG-AREA2                     31417071
314180               TO PV-COMMAREA-LENGTH                              31418071
314190             EXEC CICS                                            31419071
314200                  WRITEQ TD                                       31420071
314210                   QUEUE  ('CSSL')                                31421071
314220                    FROM  (PV-CICS-MSG-AREA2)                     31422071
314230                  LENGTH  (PV-COMMAREA-LENGTH)                    31423071
314240                    RESP  (PV-CICS-RESP)                          31424071
314250             END-EXEC                                             31425071
314260                                                                  31426071
314270             MOVE '8120-BUILD-PREPK-DETAIL'                       31427071
314280                                     TO DP013-PARAGRAPH           31428071
314290             MOVE 'INSERT TRANSACTION DETAIL ROW'                 31429071
314300                                     TO DP013-MESSAGE-TEXT (1)    31430071
314310             MOVE RECDIS-STR-NBR     TO DP013-MESSAGE-TEXT (2)    31431071
314320             MOVE SQLCA              TO DP013-SQLCA               31432071
314330             MOVE 'TDISTDT'          TO DP013-DB2-TABLE-NAME (1)  31433071
314340             SET DP013-DB2-ABEND     TO TRUE                      31434071
314350             SET DP013-ROLLBACK      TO TRUE                      31435071
314360             SET DP013-XCTL-DISPLAY-RESTART                       31436071
314370                                     TO TRUE                      31437071
314380             PERFORM DP013-0000-PROCESS-ABEND                     31438071
314390     END-EVALUATE.                                                31439071
314400                                                                  31440071
314410                                                                  31441071
314420*----------------------------------------------------------------*31442071
314430* CHECK IF ANY OF THE LINES ASSOCIATED TO THE PREPACK HAVE AN    *31443071
314440* ALLOCATION GREATER THAN 0 BELONG TO A CENTRAL STOCK LOCATION   *31444071
314450*----------------------------------------------------------------*31445071
314460 8200-CHECK-FOR-CNTL-STK.                                         31446071
314470                                                                  31447071
314480     MOVE ZEROES  TO  PV-RECITM-ORD-NBR                           31448071
314490     MOVE ZEROES  TO  PV-PREPK-CNTL-STK-COUNT                     31449071
314500                                                                  31450071
314510     EXEC SQL                                                     31451071
314511         SELECT A.ORD_NBR                                         31451171
314512           INTO :PV-RECITM-ORD-NBR                                31451271
314513           FROM TRECITM A                                         31451371
314514               ,TRECDIS B                                         31451471
314515               ,XLT_LOC C                                         31451571
314516          WHERE A.ORD_NBR         =  :DK-PO-NBR                   31451671
314517            AND A.PREPK_ID        =  :DK-PREPK-ID                 31451771
314518            AND A.REC_SEQ_NBR     =  :DK-REC-SEQ-NBR              31451871
314519            AND A.VER_STATUS_CDE  = 'A'                           31451971
314520            AND A.ORD_NBR         =  B.ORD_NBR                    31452071
314530            AND A.ORD_LNE_NBR     =  B.ORD_LNE_NBR                31453071
314540            AND A.REC_SEQ_NBR     =  B.REC_SEQ_NBR                31454071
314550            AND B.EXPTED_ITM_QTY  >  0                            31455071
314560            AND B.STR_NBR         =  C.LOC_NBR                    31456071
314570            AND C.LOC_TYP_CDE     =  'CS'                         31457071
314580          FETCH FIRST 1 ROW ONLY                                  31458071
314590     END-EXEC.                                                    31459071
314600                                                                  31460071
314610     EVALUATE TRUE                                                31461071
314620         WHEN SQLCODE = ZERO                                      31462071
314630              IF  PV-RECITM-ORD-NBR  >  0                         31463071
314640                  MOVE  1  TO  PV-PREPK-CNTL-STK-COUNT            31464071
314650              END-IF                                              31465071
314660         WHEN SQLCODE = +100                                      31466071
314670              CONTINUE                                            31467071
314680         WHEN SQLCODE = -904                                      31468071
314690         WHEN SQLCODE = -911                                      31469071
314700         WHEN SQLCODE = -913                                      31470071
314710             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   31471071
314720             MOVE '8200-CHECK-FOR-CNTL-STK'                       31472071
314721                                             TO PV-SOFT-PARAGRAPH 31472171
314722             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 31472271
314723             MOVE LENGTH OF PV-CICS-MSG-AREA2                     31472371
314724               TO PV-COMMAREA-LENGTH                              31472471
314725             EXEC CICS                                            31472571
314726                  WRITEQ TD                                       31472671
314727                   QUEUE  ('CSSL')                                31472771
314728                    FROM  (PV-CICS-MSG-AREA2)                     31472871
314729                  LENGTH  (PV-COMMAREA-LENGTH)                    31472971
314730                    RESP  (PV-CICS-RESP)                          31473071
314740             END-EXEC                                             31474071
314750              MOVE  PC-TSYMSG-01767  TO  DP020-MSG-NUMBER         31475071
314760              PERFORM 9900-SOFT-ABORT                             31476071
314770         WHEN SQLWARN0 NOT = SPACES                               31477071
314780         WHEN SQLCODE NOT EQUAL ZERO                              31478071
314790                                                                  31479071
314800             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   31480071
314810             MOVE '8200-CHECK-FOR-CNTL-STK'                       31481071
314820                                             TO PV-SOFT-PARAGRAPH 31482071
314830             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 31483071
314840             MOVE LENGTH OF PV-CICS-MSG-AREA2                     31484071
314850               TO PV-COMMAREA-LENGTH                              31485071
314860             EXEC CICS                                            31486071
314870                  WRITEQ TD                                       31487071
314880                   QUEUE  ('CSSL')                                31488071
314890                    FROM  (PV-CICS-MSG-AREA2)                     31489071
314900                  LENGTH  (PV-COMMAREA-LENGTH)                    31490071
314910                    RESP  (PV-CICS-RESP)                          31491071
314920             END-EXEC                                             31492071
314930             MOVE DK-PO-NBR          TO  PV-HOLD3-PO              31493071
314940             MOVE DK-REC-SEQ-NBR     TO  PV-HOLD3-RCVR            31494071
314950             MOVE DK-LINE-NBR        TO  PV-HOLD3-LINE            31495071
314960             MOVE PV-CICS-MSG-HOLD3  TO  PV-CICS-MSG-AREA2        31496071
314970             MOVE LENGTH OF PV-CICS-MSG-AREA2                     31497071
314980               TO PV-COMMAREA-LENGTH                              31498071
314990             EXEC CICS                                            31499071
315000                  WRITEQ TD                                       31500071
315010                   QUEUE  ('CSSL')                                31501071
315020                    FROM  (PV-CICS-MSG-AREA2)                     31502071
315030                  LENGTH  (PV-COMMAREA-LENGTH)                    31503071
315040                    RESP  (PV-CICS-RESP)                          31504071
315050             END-EXEC                                             31505071
315060                                                                  31506071
315070             MOVE '8200-CHECK-FOR-CNTL-STK'                       31507071
315080                                     TO DP013-PARAGRAPH           31508071
315090             MOVE 'CHECK FOR CENTRAL STOCK      '                 31509071
315100                                     TO DP013-MESSAGE-TEXT (1)    31510071
315110             MOVE RECDIS-STR-NBR     TO DP013-MESSAGE-TEXT (2)    31511071
315120             MOVE SQLCA              TO DP013-SQLCA               31512071
315130             MOVE 'TRECITM'          TO DP013-DB2-TABLE-NAME (1)  31513071
315140             MOVE 'TRECDIS'          TO DP013-DB2-TABLE-NAME (2)  31514071
315150             MOVE 'XLT_LOC'          TO DP013-DB2-TABLE-NAME (3)  31515071
315160             SET DP013-DB2-ABEND     TO TRUE                      31516071
315170             SET DP013-ROLLBACK      TO TRUE                      31517071
315180             SET DP013-XCTL-DISPLAY-RESTART                       31518071
315190                                     TO TRUE                      31519071
315200             PERFORM DP013-0000-PROCESS-ABEND                     31520071
315210     END-EVALUATE.                                                31521071
315220                                                                  31522071
315230                                                                  31523071
315240*----------------------------------------------------------------*31524071
315250* CHECK IF ANY OF THE LINES ASSOCIATED TO THE PREPACK HAVE AN    *31525071
315260* ALLOCATION GREATER THAN 0 BELONG TO A E-COMMERCE STORE          31526071
315270*----------------------------------------------------------------*31527071
315280 8205-CHECK-FOR-E-COMM.                                           31528071
315290                                                                  31529071
315300     MOVE ZEROES  TO  PV-RECITM-ORD-NBR.                          31530071
315310     MOVE ZEROES  TO  PV-PREPK-E-COMM-COUNT.                      31531071
315320                                                                  31532071
315330     EXEC SQL                                                     31533071
315340         SELECT A.ORD_NBR                                         31534071
315350           INTO :PV-RECITM-ORD-NBR                                31535071
315360           FROM TRECITM A                                         31536071
315370               ,TRECDIS B                                         31537071
315380               ,XLT_LOC C                                         31538071
315390          WHERE A.ORD_NBR         =  :DK-PO-NBR                   31539071
315400            AND A.PREPK_ID        =  :DK-PREPK-ID                 31540071
315410            AND A.REC_SEQ_NBR     =  :DK-REC-SEQ-NBR              31541071
315420            AND A.VER_STATUS_CDE  = 'A'                           31542071
315430            AND A.ORD_NBR         =  B.ORD_NBR                    31543071
315440            AND A.ORD_LNE_NBR     =  B.ORD_LNE_NBR                31544071
315450            AND A.REC_SEQ_NBR     =  B.REC_SEQ_NBR                31545071
315460            AND B.EXPTED_ITM_QTY  >  0                            31546071
315470            AND B.STR_NBR         =  C.LOC_NBR                    31547071
315480            AND C.LOC_TYP_CDE     =  'DS'                         31548071
315490            AND C.E_BUS_IND       =  'Y'                          31549071
315500          FETCH FIRST 1 ROW ONLY                                  31550071
315510     END-EXEC.                                                    31551071
315520                                                                  31552071
315530     EVALUATE TRUE                                                31553071
315540         WHEN SQLCODE = ZERO                                      31554071
315550              IF  PV-RECITM-ORD-NBR  >  0                         31555071
315560                  MOVE  1  to PV-PREPK-E-COMM-COUNT               31556071
315570              END-IF                                              31557071
315580         WHEN SQLCODE = +100                                      31558071
315590              CONTINUE                                            31559071
315600         WHEN SQLCODE = -904                                      31560071
315610         WHEN SQLCODE = -911                                      31561071
315620         WHEN SQLCODE = -913                                      31562071
315630             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   31563071
315640             MOVE '8205-CHECK-FOR-E-COMM'                         31564071
315650                                             TO PV-SOFT-PARAGRAPH 31565071
315660             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 31566071
315661             MOVE LENGTH OF PV-CICS-MSG-AREA2                     31566171
315662               TO PV-COMMAREA-LENGTH                              31566271
315663             EXEC CICS                                            31566371
315664                  WRITEQ TD                                       31566471
315665                   QUEUE  ('CSSL')                                31566571
315666                    FROM  (PV-CICS-MSG-AREA2)                     31566671
315667                  LENGTH  (PV-COMMAREA-LENGTH)                    31566771
315668                    RESP  (PV-CICS-RESP)                          31566871
315669             END-EXEC                                             31566971
315670              MOVE  PC-TSYMSG-01767  TO  DP020-MSG-NUMBER         31567071
315680              PERFORM 9900-SOFT-ABORT                             31568071
315690         WHEN SQLWARN0 NOT = SPACES                               31569071
315700         WHEN SQLCODE NOT EQUAL ZERO                              31570071
315710                                                                  31571071
315720             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   31572071
315730             MOVE '8205-CHECK-FOR-E-COMM'                         31573071
315740                                             TO PV-SOFT-PARAGRAPH 31574071
315750             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 31575071
315760             MOVE LENGTH OF PV-CICS-MSG-AREA2                     31576071
315770               TO PV-COMMAREA-LENGTH                              31577071
315780             EXEC CICS                                            31578071
315790                  WRITEQ TD                                       31579071
315800                   QUEUE  ('CSSL')                                31580071
315810                    FROM  (PV-CICS-MSG-AREA2)                     31581071
315820                  LENGTH  (PV-COMMAREA-LENGTH)                    31582071
315830                    RESP  (PV-CICS-RESP)                          31583071
315840             END-EXEC                                             31584071
315850             MOVE DK-PO-NBR          TO  PV-HOLD3-PO              31585071
315860             MOVE DK-REC-SEQ-NBR     TO  PV-HOLD3-RCVR            31586071
315870             MOVE DK-LINE-NBR        TO  PV-HOLD3-LINE            31587071
315880             MOVE PV-CICS-MSG-HOLD3  TO  PV-CICS-MSG-AREA2        31588071
315890             MOVE LENGTH OF PV-CICS-MSG-AREA2                     31589071
315900               TO PV-COMMAREA-LENGTH                              31590071
315910             EXEC CICS                                            31591071
315920                  WRITEQ TD                                       31592071
315930                   QUEUE  ('CSSL')                                31593071
315940                    FROM  (PV-CICS-MSG-AREA2)                     31594071
315950                  LENGTH  (PV-COMMAREA-LENGTH)                    31595071
315960                    RESP  (PV-CICS-RESP)                          31596071
315970             END-EXEC                                             31597071
315980                                                                  31598071
315990             MOVE '8205-CHECK-FOR-E-COMM'                         31599071
316000                                     TO DP013-PARAGRAPH           31600071
316010             MOVE 'CHECK FOR E-COMMERCE ALLOCATION'               31601071
316020                                     TO DP013-MESSAGE-TEXT (1)    31602071
316030             MOVE RECDIS-STR-NBR     TO DP013-MESSAGE-TEXT (2)    31603071
316040             MOVE SQLCA              TO DP013-SQLCA               31604071
316050             MOVE 'TRECITM'          TO DP013-DB2-TABLE-NAME (1)  31605071
316060             MOVE 'TRECDIS'          TO DP013-DB2-TABLE-NAME (2)  31606071
316070             MOVE 'XLT_LOC'          TO DP013-DB2-TABLE-NAME (3)  31607071
316080             SET DP013-DB2-ABEND     TO TRUE                      31608071
316090             SET DP013-ROLLBACK      TO TRUE                      31609071
316100             SET DP013-XCTL-DISPLAY-RESTART                       31610071
316110                                     TO TRUE                      31611071
316120             PERFORM DP013-0000-PROCESS-ABEND                     31612071
316130     END-EVALUATE.                                                31613071
316140                                                                  31614071
316150                                                                  31615071
316160 8210-PROCESS-DC-DEFAULTS.                                        31616071
316170                                                                  31617071
316180      MOVE ASC-OPER-UNT-ID  TO DK-OPER-UNT-ID                     31618071
316190      MOVE ASC-FCLTY-ID     TO DK-FCLTY-ID                        31619071
316200                                                                  31620071
316210      PERFORM 8220-GET-DC-DEFAULTS                                31621071
316220                                                                  31622071
316230      MOVE COCNTL-DFLT-CRE-LBL-CDE   TO  ASC-CRE-LBL-IND          31623071
316240      MOVE COCNTL-DFLT-PRT-ORD-CDE   TO  ASC-LBL-PRT-ORDER        31624071
316250      MOVE COCNTL-DFLT-FCSE-AREA-ID  TO  ASC-FCSE-AREA-ID         31625071
316260      MOVE PC-Y                      TO  ASC-PRT-HEAD-FOOT        31626071
316270                                                                  31627071
316280      PERFORM 8225-CHECK-DC-P2L-MODULES                           31628071
316290      IF  PV-DC-P2L-MODULE-COUNT  >  0                            31629071
316300          CONTINUE                                                31630071
316310      ELSE                                                        31631071
316320          MOVE  PC-CASE-PROCESS-ONLY  TO  ASC-CRE-LBL-IND         31632071
316330      END-IF.                                                     31633071
316340                                                                  31634071
316350*----------------------------------------------------------------*31635071
316360* GET DC DEFAULTS FROM TCOCNTL                                   *31636071
316370*----------------------------------------------------------------*31637071
316380 8220-GET-DC-DEFAULTS.                                            31638071
316390                                                                  31639071
316400     INITIALIZE DCLTCOCNTL.                                       31640071
316410                                                                  31641071
316420     EXEC SQL                                                     31642071
316430         SELECT  DFLT_CRE_LBL_CDE                                 31643071
316440                ,DFLT_PRT_ORD_CDE                                 31644071
316450                ,DFLT_FCSE_AREA_ID                                31645071
316460           INTO  :COCNTL-DFLT-CRE-LBL-CDE                         31646071
316470                ,:COCNTL-DFLT-PRT-ORD-CDE                         31647071
316480                ,:COCNTL-DFLT-FCSE-AREA-ID                        31648071
316490           FROM  TCOCNTL                                          31649071
316500          WHERE  OPER_UNT_ID = :ASC-OPER-UNT-ID                   31650071
316510            AND  FCLTY_ID    = :ASC-FCLTY-ID                      31651071
316520     END-EXEC.                                                    31652071
316530                                                                  31653071
316540     EVALUATE TRUE                                                31654071
316550         WHEN SQLCODE = +0                                        31655071
316560         WHEN SQLCODE = -904                                      31656071
316570         WHEN SQLCODE = -913                                      31657071
316580              CONTINUE                                            31658071
316590         WHEN SQLWARN0 NOT = +0                                   31659071
316600         WHEN SQLCODE < +0                                        31660071
316610         WHEN SQLCODE > +0                                        31661071
316620              MOVE ASC-OPER-UNT-ID   TO  PV-DISPLAY-OPER          31662071
316630              MOVE ASC-FCLTY-ID      TO  PV-DISPLAY-FCLTY         31663071
316640              MOVE ASC-PO-NBR        TO  PV-DISPLAY-PO-NBR        31664071
316650              MOVE ASC-REC-SEQ-NBR   TO  PV-DISPLAY-RCVR-SEQ-NBR  31665071
316660              MOVE '8220-GET-DC-DEFAULTS'                         31666071
316670                              TO DP013-PARAGRAPH                  31667071
316680              MOVE 'UNSUCCESSFUL SELECT ON CONTROL TABLE'         31668071
316690                              TO DP013-MESSAGE-TEXT (1)           31669071
316700              STRING  PV-DISPLAY-OPER   '-'                       31670071
316710                      PV-DISPLAY-FCLTY  '-'                       31671071
316720                      PV-DISPLAY-PO-NBR '-'                       31672071
316730                      PV-DISPLAY-RCVR-SEQ-NBR ' - '               31673071
316740                     ' - INVALID SQLCODE'      DELIMITED BY SIZE  31674071
316750                             INTO DP013-MESSAGE-TEXT (2)          31675071
316760              MOVE SQLCA      TO DP013-SQLCA                      31676071
316770              MOVE 'TCOCNTL ' TO DP013-DB2-TABLE-NAME (1)         31677071
316780              SET DP013-DB2-ABEND                                 31678071
316790                  DP013-XCTL-DISPLAY-RESTART  TO  TRUE            31679071
316800          PERFORM DP013-0000-PROCESS-ABEND                        31680071
316810     END-EVALUATE.                                                31681071
316820                                                                  31682071
316830                                                                  31683071
316840*----------------------------------------------------------------*31684071
316850* CHECK TO SEE IF DC HAS VALID P2L MODULES                       *31685071
316860*----------------------------------------------------------------*31686071
316870 8225-CHECK-DC-P2L-MODULES.                                       31687071
316880                                                                  31688071
316890     MOVE  ZEROES  TO  PV-P2LMOD-OPER-UNT-ID.                     31689071
316900     MOVE  ZEROES  TO  PV-DC-P2L-MODULE-COUNT.                    31690071
316910                                                                  31691071
316920     EXEC SQL                                                     31692071
316930         SELECT  OPER_UNT_ID                                      31693071
316940           INTO  :PV-P2LMOD-OPER-UNT-ID                           31694071
316950           FROM  TP2LMOD                                          31695071
316960          WHERE  OPER_UNT_ID = :ASC-OPER-UNT-ID                   31696071
316970            AND  FCLTY_ID    = :ASC-FCLTY-ID                      31697071
316980          FETCH FIRST 1 ROW ONLY                                  31698071
316990     END-EXEC.                                                    31699071
317000                                                                  31700071
317100     EVALUATE TRUE                                                31710071
317110         WHEN SQLCODE = +0                                        31711071
317120              IF  PV-P2LMOD-OPER-UNT-ID  > 0                      31712071
317130                  MOVE 1  TO  PV-DC-P2L-MODULE-COUNT              31713071
317140              END-IF                                              31714071
317150         WHEN SQLCODE  =  +100                                    31715071
317151              CONTINUE                                            31715171
317152         WHEN SQLWARN0 NOT = +0                                   31715271
317153         WHEN SQLCODE < +0                                        31715371
317154         WHEN SQLCODE > +0                                        31715471
317155              MOVE '8225-CHECK-DC-P2L-MODULES'                    31715571
317156                              TO DP013-PARAGRAPH                  31715671
317157              MOVE 'UNSUCCESSFUL COUNT FOR DC P2L MODULES'        31715771
317158                              TO DP013-MESSAGE-TEXT (1)           31715871
317159              MOVE SQLCA      TO DP013-SQLCA                      31715971
317160              MOVE 'TP2LMOD ' TO DP013-DB2-TABLE-NAME (1)         31716071
317170              SET DP013-DB2-ABEND                                 31717071
317180                  DP013-XCTL-DISPLAY-RESTART  TO  TRUE            31718071
317190          PERFORM DP013-0000-PROCESS-ABEND                        31719071
317200     END-EVALUATE.                                                31720071
317210                                                                  31721071
317220                                                                  31722071
317230*----------------------------------------------------------------*31723071
317240* CHECK WHETHER THE ITEM IS HAZMAT OR NOT                        *31724071
317241*----------------------------------------------------------------*31724171
317242 8230-CHECK-IF-ITEM-HAZMAT.                                       31724271
317243                                                                  31724371
317244       MOVE ASC-SKU (ASC-BLK-SUB ASC-ITEM-SUB)                    31724471
317245         TO  PV-HAZ-SKU-NBR.                                      31724571
317246                                                                  31724671
317247     EXEC SQL                                                     31724771
317248          SELECT                                                  31724871
317249             F.SYS_TRLG_CDE                                       31724971
317250           , E.ATTR_ELEM_TXT                                      31725071
317251          INTO                                                    31725171
317252             :PV-SYS-TRAIL-CODE                                   31725271
317253           , :PV-LABEL-DESGNTN                                    31725371
317254          FROM                                                    31725471
317255             WST_INTGRTN_TYP    A                                 31725571
317256           , WST_ATTR_DEFN      B                                 31725671
317257           , WST_ATTR_ELEM      C                                 31725771
317258           , WST_ATTR_ELEM      D                                 31725871
317259           , WST_ATTR_ELEM      E                                 31725971
317260           , XLT_HAZDS_MTRL_SKU F                                 31726071
317261          WHERE                                                   31726171
317262               A.INTGRTN_TYP_CDE     = 'HZLBLAPP'                 31726271
317263           AND A.INTGRTN_TYP_CDE     = B.INTGRTN_TYP_CDE          31726371
317264           AND B.ATTR_DEFN_SEQ_NBR   = 1                          31726471
317265           AND B.INTGRTN_TYP_CDE     = C.INTGRTN_TYP_CDE          31726571
317266           AND C.ATTR_DEFN_SEQ_NBR   = 1                          31726671
317267           AND B.INTGRTN_TYP_CDE     = D.INTGRTN_TYP_CDE          31726771
317268           AND D.ATTR_DEFN_SEQ_NBR   = 2                          31726871
317269           AND B.INTGRTN_TYP_CDE     = E.INTGRTN_TYP_CDE          31726971
317270           AND E.ATTR_DEFN_SEQ_NBR   = 3                          31727071
317271           AND C.ATTR_ELEM_SEQ_NBR   = D.ATTR_ELEM_SEQ_NBR        31727171
317272           AND C.ATTR_ELEM_SEQ_NBR   = E.ATTR_ELEM_SEQ_NBR        31727271
317273           AND C.ATTR_ELEM_TXT       = F.SYS_TRLG_CDE             31727371
317274           AND D.ATTR_ELEM_TXT       = 'PACKTOLIGHT'              31727471
317275           AND F.HAZDS_IND           = 'Y'                        31727571
317276           AND F.SKU_NBR             = :PV-HAZ-SKU-NBR            31727671
317277     END-EXEC                                                     31727771
317278                                                                  31727871
317279     EVALUATE TRUE                                                31727971
317280         WHEN SQLCODE = +0                                        31728071
317281           IF PV-SYS-TRAIL-CODE   > SPACES AND                    31728171
317282              PV-LABEL-DESGNTN    > SPACES AND                    31728271
317283              ASC-HAZ-FACILITY-YES                                31728371
317284                 MOVE PV-LABEL-DESGNTN  TO ASC-HAZ-CODE           31728471
317285                                       (ASC-BLK-SUB ASC-ITEM-SUB) 31728571
317286           ELSE                                                   31728671
317287                 MOVE SPACES            TO ASC-HAZ-CODE           31728771
317288                                       (ASC-BLK-SUB ASC-ITEM-SUB) 31728871
317289           END-IF                                                 31728971
317290         WHEN SQLCODE = +100                                      31729071
317300                 MOVE SPACES            TO ASC-HAZ-CODE           31730071
317301                                       (ASC-BLK-SUB ASC-ITEM-SUB) 31730171
317302         WHEN SQLCODE = -904                                      31730271
317303         WHEN SQLCODE = -911                                      31730371
317304         WHEN SQLCODE = -913                                      31730471
317305             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    31730571
317306             MOVE '8230-CHECK-IF-ITEM-HAZ'  TO PV-SOFT-PARAGRAPH  31730671
317307             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  31730771
317308             MOVE LENGTH OF PV-CICS-MSG-AREA2                     31730871
317309               TO PV-COMMAREA-LENGTH                              31730971
317310             EXEC CICS                                            31731071
317311                  WRITEQ TD                                       31731171
317312                   QUEUE  ('CSSL')                                31731271
317313                    FROM  (PV-CICS-MSG-AREA2)                     31731371
317314                  LENGTH  (PV-COMMAREA-LENGTH)                    31731471
317315                    RESP  (PV-CICS-RESP)                          31731571
317316             END-EXEC                                             31731671
317317             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          31731771
317318             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              31731871
317319             PERFORM 9900-SOFT-ABORT                              31731971
317320         WHEN SQLWARN0 NOT = SPACES                               31732071
317321         WHEN SQLCODE < ZERO                                      31732171
317322         WHEN SQLCODE > ZERO                                      31732271
317323             MOVE '8230-CHECK-IF-ITEM-HAZMAT'                     31732371
317324                               TO DP013-PARAGRAPH                 31732471
317325             MOVE 'CHK IF HAZ ITEM '                              31732571
317326                               TO DP013-MESSAGE-TEXT (1)          31732671
317327             MOVE SQLCA        TO DP013-SQLCA                     31732771
317328             MOVE 'WST_INTGRTN_TYP' TO DP013-DB2-TABLE-NAME (1)   31732871
317329             MOVE 'WST_ATTR_DEFN'   TO DP013-DB2-TABLE-NAME (2)   31732971
317330             MOVE 'WST_ATTR_ELEM'   TO DP013-DB2-TABLE-NAME (3)   31733071
317331             MOVE 'XLT_HAZDS_MTRL_SKU'                            31733171
317332                                    TO DP013-DB2-TABLE-NAME (4)   31733271
317333             SET DP013-DB2-ABEND                                  31733371
317334                 DP013-XCTL-DISPLAY-RESTART                       31733471
317335                               TO TRUE                            31733571
317336             PERFORM DP013-0000-PROCESS-ABEND                     31733671
317337     END-EVALUATE.                                                31733771
317338                                                                  31733871
317339                                                                  31733971
317340*----------------------------------------------------------------*31734071
317341* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *31734171
317342*----------------------------------------------------------------*31734271
317343 9100-READ-SEL-QUEUE.                                             31734371
317344     EXEC CICS                                                    31734471
317345         READQ TS                                                 31734571
317346             QUEUE (ASC-PREV-SEL-QUEUE-NAME)                      31734671
317347             INTO  (PC121-DC-SELECT-RECORD)                       31734771
317348             ITEM  (ASC-SEL-ITEM)                                 31734871
317349             RESP  (PV-CICS-RESP)                                 31734971
317350     END-EXEC.                                                    31735071
317360                                                                  31736071
317370     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       31737071
317380         CONTINUE                                                 31738071
317390     ELSE                                                         31739071
317400         SET DP013-LOGIC-ABEND                                    31740071
317410             DP013-NO-ROLLBACK     TO TRUE                        31741071
317420         MOVE '9100-READ-SEL-QUEUE'                               31742071
317430                                   TO DP013-PARAGRAPH             31743071
317440         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   31744071
317450                                   TO DP013-MESSAGE-TEXT (1)      31745071
317460         PERFORM DP013-0000-PROCESS-ABEND                         31746071
317470     END-IF.                                                      31747071
317480                                                                  31748071
317490                                                                  31749071
317500*----------------------------------------------------------------*31750071
317510* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *31751071
317520*----------------------------------------------------------------*31752071
317530 9105-READ-SEL-QUEUE-LST.                                         31753071
317540     EXEC CICS                                                    31754071
317550         READQ TS                                                 31755071
317560             QUEUE (ASC-PREV-SEL-QUEUE-NAME)                      31756071
317570             INTO  (RC816-SELECT-RECORD)                          31757071
317580             ITEM  (ASC-SEL-ITEM)                                 31758071
317590             RESP  (PV-CICS-RESP)                                 31759071
317600     END-EXEC.                                                    31760071
317610                                                                  31761071
317620     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       31762071
317630         CONTINUE                                                 31763071
317640     ELSE                                                         31764071
317650         SET DP013-LOGIC-ABEND                                    31765071
317660             DP013-NO-ROLLBACK     TO TRUE                        31766071
317670         MOVE '9105-READ-SEL-QUEUE-LST'                           31767071
317680                                   TO DP013-PARAGRAPH             31768071
317690         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   31769071
317700                                   TO DP013-MESSAGE-TEXT (1)      31770071
317710         PERFORM DP013-0000-PROCESS-ABEND                         31771071
317720     END-IF.                                                      31772071
317730                                                                  31773071
317740                                                                  31774071
317750*----------------------------------------------------------------*31775071
317760* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *31776071
317770*----------------------------------------------------------------*31777071
317780 9200-REWRITE-SEL-QUEUE.                                          31778071
317790     EXEC CICS                                                    31779071
317800          WRITEQ TS                                               31780071
317810              QUEUE  (ASC-PREV-SEL-QUEUE-NAME)                    31781071
317820              FROM   (PC121-DC-SELECT-RECORD)                     31782071
317830              ITEM   (ASC-SEL-ITEM)                               31783071
317840              RESP   (PV-CICS-RESP)                               31784071
317850              REWRITE                                             31785071
317860     END-EXEC.                                                    31786071
317870                                                                  31787071
317880     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   31788071
317890         SET DP013-CICS-ABEND                                     31789071
317900             DP013-NO-ROLLBACK     TO TRUE                        31790071
317910         MOVE '9200-REWRITE-SEL-QUEUE'                            31791071
317920                                   TO DP013-PARAGRAPH             31792071
317930         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   31793071
317940                                   TO DP013-MESSAGE-TEXT (1)      31794071
317950         PERFORM DP013-0000-PROCESS-ABEND                         31795071
317960     END-IF.                                                      31796071
317970                                                                  31797071
317980                                                                  31798071
317990*----------------------------------------------------------------*31799071
318000* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *31800071
318010*----------------------------------------------------------------*31801071
318020 9205-REWRITE-SEL-QUEUE-LST.                                      31802071
318030     EXEC CICS                                                    31803071
318040          WRITEQ TS                                               31804071
318050              QUEUE  (ASC-PREV-SEL-QUEUE-NAME)                    31805071
318060              FROM   (RC816-SELECT-RECORD)                        31806071
318070              ITEM   (ASC-SEL-ITEM)                               31807071
318080              RESP   (PV-CICS-RESP)                               31808071
318090              REWRITE                                             31809071
318100     END-EXEC.                                                    31810071
318110                                                                  31811071
318120     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   31812071
318130         SET DP013-CICS-ABEND                                     31813071
318140             DP013-NO-ROLLBACK     TO TRUE                        31814071
318150         MOVE '9205-REWRITE-SEL-QUEUE-LST'                        31815071
318160                                   TO DP013-PARAGRAPH             31816071
318170         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   31817071
318180                                   TO DP013-MESSAGE-TEXT (1)      31818071
318190         PERFORM DP013-0000-PROCESS-ABEND                         31819071
318200     END-IF.                                                      31820071
318210                                                                  31821071
318220                                                                  31822071
318230*----------------------------------------------------------------*31823071
318240*    THE DB2 RESOURCE IS NOT AVAILABLE, DISPLAY A MESSAGE ON     *31824071
318250*    THE TERMINAL INDICATING THAT THE RESOURCE IS UNAVAILABLE.   *31825071
318260*----------------------------------------------------------------*31826071
318270 9900-SOFT-ABORT.                                                 31827071
318280                                                                  31828071
318290     EXEC CICS SYNCPOINT                                          31829071
318300          ROLLBACK                                                31830071
318310     END-EXEC.                                                    31831071
318320                                                                  31832071
318330     SET  PS-ERROR                                                31833071
318340          PS-SOFT-ABORT-ERROR                                     31834071
318350          DP020-MSG-FATAL       TO  TRUE.                         31835071
318360                                                                  31836071
318370                                                                  31837071
318380*                                                                 31838071
318390*----------------------------------------------------------------*31839071
318400*    ABEND PROCESSOR MODULE                                      *31840071
318410*----------------------------------------------------------------*31841071
318420                                                                  31842071
318430     COPY DPPD013.                                                31843071
