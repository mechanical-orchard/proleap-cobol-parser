       ID  DIVISION.                                                            
       PROGRAM-ID.          INKRP111                                            
       AUTHOR.              JULIE SEIDLER.                                      
       INSTALLATION.        KOHLS DEPARTMENT STORES.                            
       DATE-WRITTEN.        6/00.                                               
       DATE-COMPILED.                                                           
                                                                                
      ******************************************************************        
      *   ADJUSTED PHYSICAL INVENTORY SUMMARY - BY STORE/DEPT                   
      *                                                                         
      *CHANGE HISTORY:                                                          
21015 * 01/22/2001  MADE BY: ROD JANSSEN         WR/PITS: 21015                 
21015 *    THE REPORT DOES NOT BREAK. ADJUST THE LOGIC TO PERFORM LINE          
21015 *    AND PAGE BREAKS.                                                     
      *     CHANGED: 06/12/01  SCOTT JACKSON       CHGID: W22000                
      *  MISSED MARKDOWN ADJUSTMENTS (TADJDTL_TYPE_CDE = 'MM') ARE              
      *  TO BE REPORTED SEPARATELY FROM 'AUDIT CORRECTIONS'. NEW RPT            
      *  COLUMN WAS ADDED TO THIS REPORT TO SEGREGATE THESE CORRECTIONS         
W21732*     CHANGED: 02/06/03  SUDHARSHAN, IGSI    CHGID: W21732                
W21732*  INCREASED LENGTH OF DEPT IN THE REPORT TO 4 BYTES. ALSO                
W21732*  REMOVED THE LOGIC FOR FETCHING RECORDS FROM DIFFERENT TABLES           
W21732*  USING CURSORS. THIS LOGIC IS IMPLEMENTED IN THE NEW INKUT109           
W21732*  PROGRAM. NEW CHANGES ARE DONE TO READ THE FILE THAT GENERATED          
W21732*  FROM INKUT109 PROGRAM AND TO CREATE THE REPORT.                        
RLB312*     CHANGED: 03/12/03  RONNA BUTZ          CHGID: RLB312                
RLB312*  FIXED BUGS FROM CHANGES WITH CHANGE ID W21732                          
RLB312*  THE PROBLEM WAS THAT RECORDS WERE BEING DROPPED WHEN A STORE           
RLB312*  CHANGED IN PARAGRAPH B200                                              
RLB312*  ALSO CLEANED UP THE CODE IN PARAGRAPH B300.  THE NESTED IF             
RLB312*  THEN ELSE LOGIC WAS REPLACED WITH SIMPLER IF LOGIC AND                 
RLB312*  THE EVALUATE STATEMENT.                                                
21732 *     CHANGED: 04/28/03  ROD JANSSEN         CHGID: WR21732               
21732 *  DAILY DETAIL STOCKROOM WITHDRAWAL & STORE CORRECTIONS REPORT           
21732 *  CREATION.                                                              
W26600*  W26600  03-08-2004 ROD JANSSEN MERCH LEDGER STORE EXPANSION            
W27710*  W27710  01-28-2005 ROD JANSSEN REMOVE CONTENTION ISSUES WITH           
W27710*  OTHER INVENTORY JOBS.                                                  
W28543*  W28543  05-02-2005 ROD JANSSEN MISSED MARKDOWN/MISSED MARKUP           
W28543*                                 ENHANCEMENTS                            
W33304*  W33304  06-18-2008 CHUCK EBERT HOLD THE INVENTORY LEDGER OPEN          
W33304*          ACROSS PERIODS.                                                
PE7657******************************************************************        
PE7657*  CHANGED: 04/18/2011 LALITHA/COGNIZANT  CHGID: PKE000000007657          
PE7657*  CHANGED TO HANDLE THE SALES ADJUSTMENTS IN TADJADD TABLE WITH          
PE7657*  AREA NUMBER OF 77777 AS PART OF PBI3966 CHANGES TO PROCESS             
PE7657*  UNCOUNTED RETURNS.                                                     
PE7657******************************************************************        
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
W21732     SELECT PHY-INVENTORY-SUMMARY-FILE                                    
W21732         ASSIGN TO INP01.                                                 
W21732                                                                          
           SELECT ADJ-PHY-INVENTORY-REPORT                                      
               ASSIGN TO RPT01.                                                 
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
W21732                                                                          
W21732 FD  PHY-INVENTORY-SUMMARY-FILE                                           
W21732     RECORDING MODE IS F                                          INKUT115
W21732     BLOCK CONTAINS 0 CHARACTERS                                  INKUT115
W21732     LABEL RECORDS ARE STANDARD.                                  INKUT115
W21732                                                                  INKUT115
W21732 01  PHY-INVENTORY-SUMMARY-REC     PIC X(100).                       CL*12
W21732                                                                  INKUT115
       FD  ADJ-PHY-INVENTORY-REPORT                                             
           LABEL RECORDS ARE OMITTED                                            
           RECORD CONTAINS 133 CHARACTERS                                       
           RECORDING  MODE IS F                                                 
           DATA RECORD IS REPORT-LINE.                                          
       01  REPORT-LINE.                                                         
           05  REPORT-LINE-CC    PIC X(001).                                    
           05  REPORT-LINE-DATA  PIC X(132).                                    
           05  FILLER REDEFINES  REPORT-LINE-DATA.                              
               10  FILLER        PIC X(131).                                    
               10  REPORT-HEADER-FONT-INDICATOR                                 
                                 PIC X(001).                                    
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
       01  ABEND-CODE                  PIC S9(04)  VALUE ZERO COMP SYNC.        
                                                                                
       01  PC-PRINT-CONTROL.                                                    
           05  PC-PAGE-COUNT           PIC S9(05)  VALUE ZERO.                  
           05  PC-LINE-COUNT           PIC S9(03)  VALUE ZERO COMP-3.           
           05  PC-REPORT-CC            PIC X(01)  VALUE SPACES.                 
                                                                                
       01  SA-SAVE-AREAS.                                                       
W26600     05  SA-STORE-NUMBER         PIC X(05)   VALUE SPACES.                
           05  SA-CURR-KEY.                                                     
               10  SA-CURR-SHEET       PIC X(6)    VALUE SPACES.                
               10  SA-CURR-LINE        PIC X(2)    VALUE SPACES.                
           05  SA-PRIOR-KEY.                                                    
               10  SA-PRIOR-SHEET      PIC X(6)    VALUE SPACES.                
               10  SA-PRIOR-LINE       PIC X(2)    VALUE SPACES.                
           05  SA-FIRST-SHEET          PIC X(6)    VALUE SPACES.                
           05  SA-LAST-SHEET           PIC X(6)    VALUE SPACES.                
W33304     05  INT-STAT-CDE            PIC X(02)    VALUE SPACES.               
W33304     05  INT-STAT-CDE-DESC       PIC X(40)    VALUE SPACES.               
W33304     05  HOLD-STAT-CDE           PIC X(02)    VALUE SPACES.               
W33304     05  HOLD-INV-ID             PIC S9(9) COMP VALUE +0.                 
W33304     05  HOLD-INV-NAME           PIC X(20)    VALUE SPACES.               
W33304     05  WORK-INV-ID             PIC S9(5)    VALUE ZEROS.                
W33304     05  WORK-INV-ID-R  REDEFINES WORK-INV-ID                             
W33304                                 PIC 9(5).                                
W33304     05  BREAK-INV-ID            PIC S9(5)    VALUE ZEROS.                
W33304     05  BREAK-INV-ID-R  REDEFINES BREAK-INV-ID                           
W33304                                 PIC 9(5).                                
W33304     05  STAT-HEAD               PIC X(5)    VALUE SPACES.                
W33304     05  STAT-STAT-CDE           PIC X(02)   VALUE SPACES.                
W33304     05  STAT-INV-DESC           PIC X(65)   VALUE SPACES.                
W33304     05  WORK-PHY-INV            PIC 9(19) VALUE ZEROS.                   
                                                                                
       01  PV-PROGRAM-VARIABLES.                                                
W26600     05  PV-EDIT-LOC-NBR         PIC X(05)  VALUE ZEROS.                  
W26600     05  PV-EDIT-LOC-NBR-NUM  REDEFINES                                   
W26600         PV-EDIT-LOC-NBR         PIC 9(05).                               
W21732     05  PV-PREV-DEPT            PIC X(4).                                
W26600     05  PV-PREV-STORE           PIC X(5).                                
           05  PV-PARA                 PIC X(30)    VALUE SPACES.               
           05  PV-DB2-OPER-ATTEMPTED   PIC X(30)    VALUE SPACES.               
           05  PV-DEPT-NBR             PIC X(3).                                
W26600     05  PV-STORE-NBR            PIC X(5).                                
           05  PV-MERCH-DEPT-NBR       PIC X(3).                                
           05  PV-DEFAULT-DATE         PIC X(10)    VALUE '9999-09-09'.         
           05  PV-TEST-DATE            PIC X(10)    VALUE '2001-06-06'.         
           05  PC-MAX-RETRIES          PIC S9(4)                                
                                           COMP SYNC VALUE +2.                  
           05  PV-RETRY-COUNT          PIC S9(4) COMP SYNC VALUE +0.            
W26600     05  PV-TAB-MAX              PIC 9(04)    VALUE 9999.                 
W26600     05  PV-STORE-SUB            PIC S9(04) COMP VALUE ZEROS.             
           05  PV-DEPT-X               PIC X(03).                               
           05  PV-DEPT-NUM REDEFINES PV-DEPT-X                                  
                                       PIC 9(03).                               
           05  PV-DEPT-SUB             PIC 9(04)    VALUE ZEROES.               
W26600     05  PV-TOTAL-STORES-IN-TABLE PIC S9(04) COMP VALUE ZEROS.            
           05  PV-SYSTEM-DATE.                                                  
               10  PV-SYS-YY           PIC 9(2)    VALUE ZEROES.                
               10  PV-SYS-MM           PIC 9(2)    VALUE ZEROES.                
               10  PV-SYS-DD           PIC 9(2)    VALUE ZEROES.                
           05  PV-DB2-DATE.                                                     
               10  PV-DB2-CC           PIC 9(2)    VALUE ZEROES.                
               10  PV-DB2-YY           PIC 9(2)    VALUE ZEROES.                
               10  FILLER              PIC X(1)    VALUE '-'.                   
               10  PV-DB2-MM           PIC 9(2)    VALUE ZEROES.                
               10  FILLER              PIC X(1)    VALUE '-'.                   
               10  PV-DB2-DD           PIC 9(2)    VALUE ZEROES.                
                                                                                
           05  PV-COMPUTED-FIELDS.                                              
               10  PV-TSUMINV-AMT                PIC S9(15)V99 VALUE +0         
                                                 COMP-3.                        
               10  PV-TSTKRMW-AMT                PIC S9(15)V99 VALUE +0         
                                                 COMP-3.                        
               10  PV-TADJDTL-AUDIT-AMT          PIC S9(15)V99 VALUE +0         
                                                 COMP-3.                        
               10  PV-TADJDTL-STORE-AMT          PIC S9(15)V99 VALUE +0         
                                                 COMP-3.                        
               10  PV-TADJDTL-SALE-ADJMT-AMT     PIC S9(15)V99 VALUE +0         
                                                 COMP-3.                        
W28543         10  PV-TADJDTL-MISS-MKUP-AMT      PIC S9(15)V99 VALUE +0         
W22000                                           COMP-3.                        
W33304 01  CYL-COMPUTED-FIELDS.                                                 
W21732     05  PV-CYL-TSUMINV-AMT            PIC S9(15)V99 VALUE +0             
W21732                                           COMP-3.                        
W21732     05  PV-CYL-TSTKRMW-AMT            PIC S9(15)V99 VALUE +0             
W21732                                           COMP-3.                        
W21732     05  PV-CYL-TADJDTL-AUDIT-AMT      PIC S9(15)V99 VALUE +0             
W21732                                           COMP-3.                        
W21732     05  PV-CYL-TADJDTL-SALE-ADJMT-AMT PIC S9(15)V99 VALUE +0             
W21732                                           COMP-3.                        
W28543     05  PV-CYL-TADJDTL-MISS-MKUP-AMT  PIC S9(15)V99 VALUE +0             
W21732                                           COMP-3.                        
W21732     05  PV-CYL-TADJDTL-STORE-AMT      PIC S9(15)V99 VALUE +0             
W21732                                           COMP-3.                        
W21732     05  PV-CYL-NET-ADJUSTMENT         PIC S9(15)V99 VALUE +0             
W21732                                           COMP-3.                        
W21732     05  PV-CYL-ADJUSTED-PHYSICAL      PIC S9(15)V99 VALUE +0             
W21732                                           COMP-3.                        
W21732     05  PV-ADJUSTED-PHYSICAL          PIC S9(15)V99 VALUE +0             
W21732                                           COMP-3.                        
W33304 01  STAT-COMPUTED-FIELDS.                                                
W33304     05  PV-STAT-TSUMINV-AMT            PIC S9(15)V99 VALUE +0            
W33304                                           COMP-3.                        
W33304     05  PV-STAT-TSTKRMW-AMT            PIC S9(15)V99 VALUE +0            
W33304                                           COMP-3.                        
W33304     05  PV-STAT-TADJDTL-AUDIT-AMT      PIC S9(15)V99 VALUE +0            
W33304                                           COMP-3.                        
W33304     05  PV-STAT-TADJDTL-SALE-ADJMT-AMT PIC S9(15)V99 VALUE +0            
W33304                                           COMP-3.                        
W33304     05  PV-STAT-TADJDTL-MISS-MKUP-AMT  PIC S9(15)V99 VALUE +0            
W33304                                           COMP-3.                        
W33304     05  PV-STAT-TADJDTL-STORE-AMT      PIC S9(15)V99 VALUE +0            
W33304                                           COMP-3.                        
W33304     05  PV-STAT-NET-ADJUSTMENT         PIC S9(15)V99 VALUE +0            
W33304                                           COMP-3.                        
W33304     05  PV-STAT-ADJUSTED-PHYSICAL      PIC S9(15)V99 VALUE +0            
W33304                                           COMP-3.                        
W33304     05  PV-STAT-ADJUSTED-PHYSICAL-TOT  PIC S9(15)V99 VALUE +0            
W33304                                           COMP-3.                        
W33304 01  STAT-GRND-TOT-FIELDS.                                                
                                                                                
W21732     05  PV-GTT-TSUMINV-AMT            PIC S9(15)V99 VALUE +0             
W21732                                           COMP-3.                        
W21732     05  PV-GTT-TSTKRMW-AMT            PIC S9(15)V99 VALUE +0             
W21732                                           COMP-3.                        
W33304     05  PV-GTT-TADJDTL-AUDIT-AMT      PIC S9(15)V99 VALUE +0             
W33304                                           COMP-3.                        
W33304     05  PV-GTT-TADJDTL-SALE-ADJMT-AMT PIC S9(15)V99 VALUE +0             
W33304                                           COMP-3.                        
W33304     05  PV-GTT-TADJDTL-MISS-MKUP-AMT  PIC S9(15)V99 VALUE +0             
W33304                                           COMP-3.                        
W33304     05  PV-GTT-TADJDTL-STORE-AMT      PIC S9(15)V99 VALUE +0             
W33304                                           COMP-3.                        
W33304     05  PV-GTT-NET-ADJUSTMENT         PIC S9(15)V99 VALUE +0             
W33304                                           COMP-3.                        
W33304     05  PV-GTT-ADJUSTED-PHYSICAL      PIC S9(15)V99 VALUE +0             
W33304                                           COMP-3.                        
W33304     05  PV-GTT-ADJUSTED-PHYSICAL-TOT  PIC S9(15)V99 VALUE +0             
W33304                                           COMP-3.                        
       01  SWITCHES.                                                            
W21732     05  PS-END-OF-PHY-INV-IND      PIC X       VALUE 'N'.                
W21732         88  PS-END-OF-PHY-INV-FILE          VALUE 'Y'.                   
W33304     05  FST-SW                     PIC X       VALUE 'Y'.                
W33304     05  STAT-BK                    PIC X       VALUE 'N'.                
W33304     05  CYCLE-BK                   PIC X       VALUE 'N'.                
W33304     05  END-PGM                    PIC X       VALUE 'N'.                
                                                                                
       01  TB-STORE-TABLE.                                                      
W26600     05 TB-STORE-TAB OCCURS 10000 TIMES.                                  
W26600        10  TB-STORE-NBR         PIC 9(05).                               
                                                                                
       01  TB-DEPT-TABLE.                                                       
W21732        10  TB-DEPT-NBR                   PIC X(04) VALUE SPACES.         
              10  TB-TSUMINV-AMT                PIC S9(15)V99 VALUE +0          
                                                COMP-3.                         
              10  TB-TSTKRMW-AMT                PIC S9(15)V99 VALUE +0          
                                                COMP-3.                         
W28543        10  TB-TADJDTL-MISS-MKUP-AMT      PIC S9(15)V99 VALUE +0          
W22000                                          COMP-3.                         
              10  TB-TADJDTL-AUDIT-AMT          PIC S9(15)V99 VALUE +0          
                                                COMP-3.                         
              10  TB-TADJDTL-STORE-AMT          PIC S9(15)V99 VALUE +0          
                                                COMP-3.                         
              10  TB-TADJDTL-SALE-ADJMT-AMT     PIC S9(15)V99 VALUE +0          
                                                COMP-3.                         
              10  TB-ADJUSTED-PHYSICAL          PIC S9(15)V99 VALUE +0          
                                                COMP-3.                         
              10  TB-NET-ADJUSTMENT             PIC S9(15)V99 VALUE +0          
                                                COMP-3.                         
              10  TB-TOT-TSUMINV-AMT            PIC S9(15)V99 VALUE +0          
                                                COMP-3.                         
              10  TB-TOT-TSTKRMW-AMT            PIC S9(15)V99 VALUE +0          
                                                COMP-3.                         
W28543        10  TB-TOT-MISS-MKUP-AMT          PIC S9(15)V99 VALUE +0          
W22000                                          COMP-3.                         
              10  TB-TOT-TADJDTL-AUDIT-AMT      PIC S9(15)V99 VALUE +0          
                                                COMP-3.                         
              10  TB-TOT-TADJDTL-SALE-ADJMT-AMT PIC S9(15)V99 VALUE +0          
                                                COMP-3.                         
              10  TB-TOT-TADJDTL-STORE-AMT      PIC S9(15)V99 VALUE +0          
                                                COMP-3.                         
              10  TB-TOT-ADJUSTED-PHYSICAL      PIC S9(15)V99 VALUE +0          
                                                COMP-3.                         
              10  TB-TOT-NET-ADJUSTMENT         PIC S9(15)V99 VALUE +0          
                                                COMP-3.                         
                                                                                
       01  CPU-DATE.                                                            
           05  CPU-YEAR                    PIC X(02)     VALUE SPACES.          
           05  CPU-MONTH                   PIC X(02)     VALUE SPACES.          
           05  CPU-DAY                     PIC X(02)     VALUE SPACES.          
                                                                                
       01  CPU-TIME.                                                            
           05  CPU-HOUR                    PIC X(02)     VALUE SPACES.          
           05  CPU-MINUTE                  PIC X(02)     VALUE SPACES.          
           05  FILLER                      PIC X(02)     VALUE SPACES.          
                                                                                
       01  H1-HEADING.                                                          
           05  FILLER              PIC X(44)   VALUE SPACES.                    
           05  FILLER              PIC X(97)   VALUE                            
              'SUMMARIZED ADJUSTED PHYSICAL INVENTORY REPORT - BY DEPT'.        
                                                                                
W33304 01  H1A-HEADING.                                                         
W33304     05  FILLER              PIC X(01)   VALUE ' '.                       
W33304     05  H1A-STAT-CDE        PIC 9(05)   VALUE ZEROS.                     
W33304     05  H1A-STAT-RED REDEFINES H1A-STAT-CDE PIC X(05).                   
W33304     05  FILLER              PIC X(02)   VALUE SPACES.                    
W33304     05  H1A-INV-STAT-CDE    PIC X(02)   VALUE SPACES.                    
W33304     05  FILLER              PIC X(36)   VALUE SPACES.                    
W33304     05  H1A-INV-STAT        PIC X(22)   VALUE SPACES.                    
W33304     05  FILLER              PIC X(02)   VALUE SPACES.                    
W33304     05  H1A-INV-DESC        PIC X(63)   VALUE SPACES.                    
                                                                                
       01  H1B-HEADING.                                                         
           05  FILLER              PIC X(58)   VALUE SPACES.                    
           05  FILLER              PIC X(06)   VALUE 'STORE '.                  
           05  FILLER              PIC X(01)   VALUE SPACES.                    
W26600     05  H1B-STORE           PIC X(05)   VALUE ZEROS.                     
           05  FILLER              PIC X(02)   VALUE SPACES.                    
           05  H1B-STORE-NAME      PIC X(13)   VALUE SPACES.                    
                                                                                
       01  H2-HEADING.                                                          
           05  FILLER              PIC X(01)   VALUE   '-'.                     
           05  FILLER              PIC X(49)   VALUE                            
      **        ----5----0----5----0----5----0----5----0----5----0----5         
               'DEPARTMENT                PHYSICAL     STOCKROOM'.              
           05  FILLER              PIC X(50)   VALUE                            
               '       STORE         MISSED        AUDIT          '.            
           05  FILLER              PIC X(33)   VALUE                            
               '     SALE              ADJUSTED  '.                             
                                                                                
       01  H3-HEADING.                                                          
           05  FILLER              PIC X(01)   VALUE   ' '.                     
           05  FILLER              PIC X(48)   VALUE                            
      **        ----5----0----5----0----5----0----5----0----5----0----5         
               '                         INVENTORY     WITHDRAWL'.              
           05  FILLER              PIC X(51)   VALUE                            
W28543         '    CORRECTIONS       MARKUPS    CORRECTIONS      '.            
           05  FILLER              PIC X(32)   VALUE                            
               ' ADJUSTMENTS           PHYSICAL '.                              
           EJECT                                                                
       01  C1-COMMENT.                                                          
W26600     05  C1-STORE-NBR        PIC X(05)   VALUE ZEROS.                     
           05  FILLER              PIC X(01)   VALUE SPACES.                    
           05  FILLER              PIC X(07)   VALUE                            
               'TTL **'.                                                        
W33304 01  C2-COMMENT.                                                          
W33304     05  C2-STAT             PIC X(02)   VALUE SPACES.                    
W33304     05  FILLER              PIC X(01)   VALUE SPACES.                    
W33304     05  FILLER              PIC X(07)   VALUE 'TOTAL  '.                 
                                                                                
       01  D1-DETAIL-LINE.                                                      
           05  D1-CC                    PIC X(01).                              
               88  D1-SINGLE-SPACE                       VALUE ' '.             
               88  D1-DOUBLE-SPACE                       VALUE '0'.             
           05  D1-DETAIL-DATA.                                                  
W21732         10  D1-DEPT-NBR          PIC X(04)        VALUE SPACES.          
               10  FILLER               PIC X(01)        VALUE SPACES.          
               10  D1-COMMENT           PIC X(10)        VALUE SPACES.          
W21732         10  FILLER               PIC X(01)        VALUE SPACES.          
               10  D1-PHYSICAL-INVEN    PIC ZZZ,ZZZ,ZZZ,ZZ9.99-.                
               10  FILLER               PIC X(01)        VALUE SPACES.          
               10  D1-STOCKROOM-WDRAWL  PIC Z,ZZZ,ZZ9.99-.                      
               10  FILLER               PIC X(01)        VALUE SPACES.          
               10  D1-STORE-CORRECTIONS PIC ZZ,ZZZ,ZZ9.99-.                     
               10  FILLER               PIC X(01)        VALUE SPACES.          
W28543         10  D1-MISSED-MARKUPS    PIC Z,ZZZ,ZZ9.99-.                      
W22000         10  FILLER               PIC X(01)        VALUE SPACES.          
               10  D1-AUDIT-CORRECTIONS PIC ZZ,ZZZ,ZZ9.99-.                     
               10  FILLER               PIC X(01)        VALUE SPACES.          
               10  D1-SALE-ADJUST       PIC ZZ,ZZZ,ZZZ,ZZ9.99-.                 
               10  FILLER               PIC X(01)        VALUE SPACES.          
               10  D1-ADJUSTED-PHYSICAL PIC ZZ,ZZZ,ZZZ,ZZ9.99-.                 
                                                                                
                                                                                
      * COPY FOR STANDARD HEADING                                               
           COPY DPWS133O.                                                       
                                                                                
      *****************************************************************         
      *  SQL ABEND ROUTINE WORKING STORAGE                                      
      *****************************************************************         
                                                                                
           COPY DPWS004.                                                        
                                                                                
W21732*****************************************************************         
W21732*  COPYBOOK FOR INPUT                                                     
W21732*****************************************************************         
W21732                                                                          
W26600     COPY INRD109.                                                        
W21732                                                                          
W33304*****************************************************************         
W33304* TINCNTL DCLGEN                                                          
W33304*****************************************************************         
W33304     EXEC SQL                                                             
W33304         INCLUDE TINCNTL                                                  
W33304     END-EXEC.                                                            
W33304                                                                          
      *****************************************************************         
      * DB2 STORE TABLE DCLGEN.                                                 
      *****************************************************************         
           EXEC SQL                                                             
W26600         INCLUDE XMT00001                                                 
           END-EXEC.                                                            
      *****************************************************************         
      * DB2 MERCHANDISE DEPARTMENT                                              
      *****************************************************************         
           EXEC SQL                                                             
               INCLUDE SQLCA                                                    
           END-EXEC.                                                            
                                                                                
           COPY SQLCA2.                                                         
           EJECT                                                                
W33304*****************************************************************         
W33304* INT_INV_STAT_CDE DCLGEN                                                 
W33304*****************************************************************         
W33304     EXEC SQL                                                             
W33304         INCLUDE INT00001                                                 
W33304     END-EXEC.                                                            
W33304                                                                          
                                                                                
           EJECT                                                                
       LINKAGE SECTION.                                                         
           EJECT                                                                
       PROCEDURE DIVISION.                                                      
                                                                                
       A100-MAIN-MODULE.                                                        
                                                                                
           PERFORM B100-HOUSEKEEPING.                                           
                                                                                
W21732     PERFORM B200-PROCESS-PHY-INV-FILE                                    
W21732          UNTIL PS-END-OF-PHY-INV-FILE.                                   
                                                                                
           PERFORM B600-EOJ.                                                    
                                                                                
           STOP RUN.                                                            
           EJECT                                                                
       B100-HOUSEKEEPING.                                                       
           MOVE '*B100-HOUSEKEEPING.              *' TO PV-PARA                 
                                                                                
W21732     OPEN INPUT  PHY-INVENTORY-SUMMARY-FILE                               
W21732          OUTPUT ADJ-PHY-INVENTORY-REPORT.                                
                                                                                
           ACCEPT CPU-DATE FROM DATE.                                           
           MOVE CPU-YEAR   TO DP133O-RUN-YEAR.                                  
           MOVE CPU-MONTH  TO DP133O-RUN-MONTH.                                 
           MOVE CPU-DAY    TO DP133O-RUN-DAY.                                   
                                                                                
           ACCEPT CPU-TIME FROM TIME.                                           
           MOVE CPU-HOUR   TO DP133O-RUN-HOUR.                                  
           MOVE CPU-MINUTE TO DP133O-RUN-MINUTE.                                
           MOVE 'INKRP111' TO DP133O-PROGRAM-NAME.                              
                                                                                
           MOVE +0         TO PC-PAGE-COUNT.                                    
                                                                                
           INITIALIZE TB-DEPT-TABLE.                                            
                                                                                
W21732     PERFORM B150-READ-PHY-INV-FILE.                                      
                                                                                
W21732     IF NOT PS-END-OF-PHY-INV-FILE                                        
W33304        PERFORM Z200-READ-CNTL                                            
W21732        MOVE IN109-STORE-NBR TO PV-PREV-STORE                             
W21732        MOVE IN109-DEPT      TO PV-PREV-DEPT                              
W26600        PERFORM Z100-READ-XMTLOC                                          
W33304        MOVE IN109-FINCL-INV-STAT-CDE TO HOLD-STAT-CDE                    
W33304        MOVE IN109-INV-ID             TO WORK-INV-ID                      
W33304                                         BREAK-INV-ID                     
W21732        PERFORM Z800-PRINT-HEADINGS                                       
W33304        MOVE 'N' TO FST-SW                                                
W21732     END-IF.                                                              
W21732                                                                          
W21732 B150-READ-PHY-INV-FILE.                                                  
W21732                                                                          
W21732     READ PHY-INVENTORY-SUMMARY-FILE                                      
W21732            INTO IN109-PHY-IN-SUMMARY-RECORD                              
W21732            AT END                                                        
W33304                 MOVE 'Y' TO END-PGM                                      
W21732                 SET PS-END-OF-PHY-INV-FILE TO TRUE                       
W21732     END-READ.                                                            
W21732                                                                          
W21732 B200-PROCESS-PHY-INV-FILE.                                               
                                                                                
W33304     IF IN109-STORE-NBR EQUAL TO PV-PREV-STORE                            
W33304        AND IN109-FINCL-INV-STAT-CDE NOT = HOLD-STAT-CDE                  
W33304            PERFORM B400-PRINT-DETAIL-LINE                                
W33304            PERFORM B410-PRINT-STORE-TOTAL                                
W33304            PERFORM Z100-READ-XMTLOC                                      
W33304            MOVE IN109-FINCL-INV-STAT-CDE TO HOLD-STAT-CDE                
W33304            PERFORM Z800-PRINT-HEADINGS                                   
W33304            PERFORM B440-PRINT-STAT-TOTAL                                 
W33304            MOVE IN109-STORE-NBR TO PV-PREV-STORE                         
W33304            MOVE IN109-DEPT TO PV-PREV-DEPT.                              
                                                                                
W21732     IF IN109-STORE-NBR EQUAL TO PV-PREV-STORE                            
W21732         IF IN109-DEPT EQUAL TO PV-PREV-DEPT                              
W21732               PERFORM B300-PROCESS-RECORD                                
W21732         ELSE                                                             
W21732            PERFORM B400-PRINT-DETAIL-LINE                                
W21732            INITIALIZE TB-DEPT-TABLE                                      
W21732            PERFORM B300-PROCESS-RECORD                                   
W21732         END-IF                                                           
W21732      ELSE                                                                
W21732        IF (PV-TSUMINV-AMT       NOT = +0) OR                             
W21732           (PV-TSTKRMW-AMT       NOT = +0) OR                             
W21732           (PV-TADJDTL-AUDIT-AMT NOT = +0) OR                             
W21732           (PV-TADJDTL-STORE-AMT NOT = +0) OR                             
W28543           (PV-TADJDTL-MISS-MKUP-AMT NOT = +0)                            
W21732            PERFORM B400-PRINT-DETAIL-LINE                                
W21732            PERFORM B410-PRINT-STORE-TOTAL                                
W26600            PERFORM Z100-READ-XMTLOC                                      
W21732            PERFORM Z800-PRINT-HEADINGS                                   
W21732            INITIALIZE TB-DEPT-TABLE                                      
W21732            INITIALIZE PV-COMPUTED-FIELDS                                 
W21732        END-IF                                                            
RLB312        PERFORM B300-PROCESS-RECORD                                       
W21732      END-IF.                                                             
W21732                                                                          
W21732      MOVE IN109-DEPT       TO PV-PREV-DEPT                               
W21732      MOVE IN109-STORE-NBR  TO PV-PREV-STORE                              
W21732                                                                          
W21732      PERFORM B150-READ-PHY-INV-FILE.                                     
W21732                                                                          
W21732 B300-PROCESS-RECORD.                                                     
W21732                                                                          
W21732     IF IN109-TABLE-NAME = 'SUMINV'                                       
W21732           ADD IN109-EXTD-AMT TO PV-TSUMINV-AMT                           
W21732                                     PV-CYL-TSUMINV-AMT                   
W33304                                     PV-STAT-TSUMINV-AMT                  
W33304                                     PV-GTT-TSUMINV-AMT                   
W21732                                     TB-TSUMINV-AMT                       
W21732                                     TB-TOT-TSUMINV-AMT                   
RLB312     END-IF.                                                              
W21732     IF IN109-TABLE-NAME = 'STKRMW'                                       
W21732           ADD IN109-EXTD-AMT TO PV-TSTKRMW-AMT                           
W21732                                 PV-CYL-TSTKRMW-AMT                       
W33304                                 PV-STAT-TSTKRMW-AMT                      
W33304                                 PV-GTT-TSTKRMW-AMT                       
W21732                                 TB-TSTKRMW-AMT                           
W21732                                 TB-TOT-TSTKRMW-AMT                       
RLB312     END-IF.                                                              
W21732     IF IN109-TABLE-NAME = 'ADJDTL'                                       
RLB312        EVALUATE TRUE                                                     
RLB312           WHEN IN109-ADJUST-TYPE-CODE = 'CO'                             
W21732             ADD IN109-EXTD-AMT TO PV-TADJDTL-STORE-AMT                   
W21732                                    PV-CYL-TADJDTL-STORE-AMT              
W33304                                    PV-STAT-TADJDTL-STORE-AMT             
W33304                                    PV-GTT-TADJDTL-STORE-AMT              
W21732                                    TB-TADJDTL-STORE-AMT                  
W21732                                    TB-TOT-TADJDTL-STORE-AMT              
RLB312           WHEN IN109-ADJUST-TYPE-CODE = 'SA'                             
W21732              ADD IN109-EXTD-AMT TO PV-TADJDTL-SALE-ADJMT-AMT             
W21732                                    PV-CYL-TADJDTL-SALE-ADJMT-AMT         
W33304                                    PV-STAT-TADJDTL-SALE-ADJMT-AMT        
W33304                                    PV-GTT-TADJDTL-SALE-ADJMT-AMT         
W21732                                    TB-TADJDTL-SALE-ADJMT-AMT             
W21732                                    TB-TOT-TADJDTL-SALE-ADJMT-AMT         
RLB312           WHEN IN109-ADJUST-TYPE-CODE = 'MM'                             
W28543              ADD IN109-EXTD-AMT TO PV-TADJDTL-MISS-MKUP-AMT              
W28543                                    PV-CYL-TADJDTL-MISS-MKUP-AMT          
W33304                                    PV-STAT-TADJDTL-MISS-MKUP-AMT         
W33304                                    PV-GTT-TADJDTL-MISS-MKUP-AMT          
W28543                                    TB-TADJDTL-MISS-MKUP-AMT              
W28543                                    TB-TOT-MISS-MKUP-AMT                  
RLB312           WHEN OTHER                                                     
W21732              ADD IN109-EXTD-AMT TO PV-TADJDTL-AUDIT-AMT                  
W21732                                    PV-CYL-TADJDTL-AUDIT-AMT              
W33304                                    PV-STAT-TADJDTL-AUDIT-AMT             
W33304                                    PV-GTT-TADJDTL-AUDIT-AMT              
W21732                                    TB-TADJDTL-AUDIT-AMT                  
W21732                                    TB-TOT-TADJDTL-AUDIT-AMT              
RLB312        END-EVALUATE                                                      
RLB312     END-IF.                                                              
RLB312                                                                          
RBL312     IF IN109-TABLE-NAME = 'ADJADD'                                       
PE7657         IF IN109-AREA-NBR = 777777                                       
PE7657* AREA NUMBER OF 777777 IS ONLY FOR SALES ADJUSTMENT FOR MISSING          
PE7657* RETURNS - ITEM NOT IN STORE AND RETURNED ON INVENTORY DAY               
PE7657            ADD IN109-EXTD-AMT TO PV-TADJDTL-SALE-ADJMT-AMT               
PE7657                                  PV-CYL-TADJDTL-SALE-ADJMT-AMT           
PE7657                                  PV-STAT-TADJDTL-SALE-ADJMT-AMT          
PE7657                                  PV-GTT-TADJDTL-SALE-ADJMT-AMT           
PE7657                                  TB-TADJDTL-SALE-ADJMT-AMT               
PE7657                                  TB-TOT-TADJDTL-SALE-ADJMT-AMT           
PE7657        ELSE                                                              
W21732            ADD IN109-EXTD-AMT TO PV-TADJDTL-AUDIT-AMT                    
W21732                                  PV-CYL-TADJDTL-AUDIT-AMT                
W33304                                  PV-STAT-TADJDTL-AUDIT-AMT               
W33304                                  PV-GTT-TADJDTL-AUDIT-AMT                
W21732                                  TB-TADJDTL-AUDIT-AMT                    
W21732                                  TB-TOT-TADJDTL-AUDIT-AMT                
PE7657        END-IF                                                            
W21732     END-IF.                                                              
                                                                                
       B400-PRINT-DETAIL-LINE.                                                  
                                                                                
           MOVE SPACES                    TO D1-DETAIL-DATA.                    
                                                                                
W21732         MOVE PV-PREV-DEPT                                                
                    TO D1-DEPT-NBR                                              
W21732         MOVE TB-TSUMINV-AMT                                              
                    TO D1-PHYSICAL-INVEN                                        
W33304                 WORK-PHY-INV                                             
W21732         MOVE TB-TSTKRMW-AMT                                              
                    TO D1-STOCKROOM-WDRAWL                                      
W21732         MOVE TB-TADJDTL-STORE-AMT                                        
                    TO D1-STORE-CORRECTIONS                                     
W28543         MOVE TB-TADJDTL-MISS-MKUP-AMT                                    
W28543              TO D1-MISSED-MARKUPS                                        
W21732         MOVE TB-TADJDTL-AUDIT-AMT                                        
                    TO D1-AUDIT-CORRECTIONS                                     
W21732         MOVE TB-TADJDTL-SALE-ADJMT-AMT                                   
                    TO D1-SALE-ADJUST                                           
                                                                                
               COMPUTE PV-ADJUSTED-PHYSICAL =                                   
W21732                 TB-TSUMINV-AMT          -                                
W21732                 TB-TSTKRMW-AMT          +                                
W21732                 TB-TADJDTL-STORE-AMT    +                                
W28543                 TB-TADJDTL-MISS-MKUP-AMT  +                              
W21732                 TB-TADJDTL-AUDIT-AMT    +                                
W21732                 TB-TADJDTL-SALE-ADJMT-AMT                                
                                                                                
               IF PC-LINE-COUNT > +59                                           
                   PERFORM Z800-PRINT-HEADINGS                                  
               END-IF                                                           
                                                                                
               MOVE PV-ADJUSTED-PHYSICAL     TO D1-ADJUSTED-PHYSICAL            
               MOVE D1-DETAIL-LINE           TO REPORT-LINE                     
W33304         IF WORK-PHY-INV NOT = ZERO                                       
                 PERFORM Z700-WRITE-REPORT-LINE.                                
                                                                                
W21732         SET  D1-SINGLE-SPACE          TO TRUE.                           
                                                                                
       B410-PRINT-STORE-TOTAL.                                                  
                                                                                
           MOVE SPACES                    TO D1-DETAIL-DATA.                    
                                                                                
W26600     MOVE XMT00001-LOC-NBR          TO PV-EDIT-LOC-NBR-NUM                
W26600     MOVE PV-EDIT-LOC-NBR-NUM       TO C1-STORE-NBR                       
           MOVE C1-COMMENT                TO D1-COMMENT                         
                                                                                
           MOVE PV-TSUMINV-AMT            TO D1-PHYSICAL-INVEN                  
W33304                                       WORK-PHY-INV                       
           MOVE PV-TSTKRMW-AMT            TO D1-STOCKROOM-WDRAWL                
           MOVE PV-TADJDTL-STORE-AMT      TO D1-STORE-CORRECTIONS               
W28543     MOVE PV-TADJDTL-MISS-MKUP-AMT  TO D1-MISSED-MARKUPS                  
           MOVE PV-TADJDTL-AUDIT-AMT      TO D1-AUDIT-CORRECTIONS               
           MOVE PV-TADJDTL-SALE-ADJMT-AMT TO D1-SALE-ADJUST                     
                                                                                
           COMPUTE PV-ADJUSTED-PHYSICAL =                                       
                   PV-TSUMINV-AMT         -                                     
                   PV-TSTKRMW-AMT         +                                     
                   PV-TADJDTL-STORE-AMT   +                                     
W28543             PV-TADJDTL-MISS-MKUP-AMT +                                   
                   PV-TADJDTL-AUDIT-AMT   +                                     
                   PV-TADJDTL-SALE-ADJMT-AMT.                                   
                                                                                
           IF PC-LINE-COUNT > +59                                               
               PERFORM Z800-PRINT-HEADINGS                                      
           END-IF.                                                              
                                                                                
           MOVE PV-ADJUSTED-PHYSICAL     TO D1-ADJUSTED-PHYSICAL.               
           MOVE D1-DETAIL-LINE           TO REPORT-LINE.                        
W33304     IF WORK-PHY-INV NOT = ZERO                                           
           PERFORM Z700-WRITE-REPORT-LINE.                                      
                                                                                
           SET  D1-SINGLE-SPACE          TO TRUE.                               
W33304     INITIALIZE PV-COMPUTED-FIELDS                                        
                                                                                
W33304      IF IN109-FINCL-INV-STAT-CDE NOT = HOLD-STAT-CDE                     
W33304      OR IN109-INV-ID NOT = BREAK-INV-ID                                  
W33304            MOVE 'Y' TO STAT-BK                                           
W33304            PERFORM Z800-PRINT-HEADINGS                                   
W33304            MOVE 'N' TO STAT-BK                                           
W33304            PERFORM B440-PRINT-STAT-TOTAL                                 
W33304            MOVE IN109-FINCL-INV-STAT-CDE TO HOLD-STAT-CDE                
W33304            PERFORM Z100-READ-XMTLOC                                      
W33304            INITIALIZE PV-COMPUTED-FIELDS                                 
W33304      END-IF.                                                             
W33304      MOVE IN109-FINCL-INV-STAT-CDE TO HOLD-STAT-CDE.                     
                                                                                
W33304 B440-PRINT-STAT-TOTAL.                                                   
W33304                                                                          
W33304     MOVE SPACES                    TO D1-DETAIL-DATA.                    
W33304                                                                          
W33304     MOVE XMT00001-LOC-NBR          TO PV-EDIT-LOC-NBR-NUM                
W33304     MOVE PV-EDIT-LOC-NBR-NUM       TO C1-STORE-NBR                       
W33304     MOVE HOLD-STAT-CDE             TO C2-STAT                            
W33304     MOVE C2-COMMENT     TO D1-DETAIL-DATA(1:10)                          
W33304                                                                          
           MOVE PV-STAT-TSUMINV-AMT            TO D1-PHYSICAL-INVEN             
                                                  WORK-PHY-INV                  
           MOVE PV-STAT-TSTKRMW-AMT            TO D1-STOCKROOM-WDRAWL           
           MOVE PV-STAT-TADJDTL-STORE-AMT      TO D1-STORE-CORRECTIONS          
W28543     MOVE PV-STAT-TADJDTL-MISS-MKUP-AMT  TO D1-MISSED-MARKUPS             
           MOVE PV-STAT-TADJDTL-AUDIT-AMT      TO D1-AUDIT-CORRECTIONS          
           MOVE PV-STAT-TADJDTL-SALE-ADJMT-AMT TO D1-SALE-ADJUST                
W33304                                                                          
           COMPUTE PV-STAT-ADJUSTED-PHYSICAL =                                  
                   PV-STAT-TSUMINV-AMT       -                                  
                   PV-STAT-TSTKRMW-AMT       +                                  
                   PV-STAT-TADJDTL-STORE-AMT +                                  
W28543             PV-STAT-TADJDTL-MISS-MKUP-AMT +                              
                   PV-STAT-TADJDTL-AUDIT-AMT +                                  
                   PV-STAT-TADJDTL-SALE-ADJMT-AMT                               
                                                                                
W33304                                                                          
W33304     IF PC-LINE-COUNT > +59                                               
W33304         PERFORM Z800-PRINT-HEADINGS                                      
W33304     END-IF.                                                              
                                                                                
W33304     MOVE PV-STAT-ADJUSTED-PHYSICAL TO D1-ADJUSTED-PHYSICAL.              
W33304     IF WORK-PHY-INV NOT = ZERO                                           
W33304     MOVE D1-DETAIL-LINE           TO REPORT-LINE.                        
W33304     PERFORM Z700-WRITE-REPORT-LINE.                                      
W33304     INITIALIZE STAT-COMPUTED-FIELDS.                                     
                                                                                
W33304     SET  D1-SINGLE-SPACE          TO TRUE.                               
W33304     IF IN109-INV-ID NOT = BREAK-INV-ID                                   
W33304            MOVE 'Y' TO CYCLE-BK                                          
W33304            PERFORM Z800-PRINT-HEADINGS                                   
W33304            MOVE 'N' TO CYCLE-BK                                          
W33304            PERFORM B460-PRINT-CYCLE-TOTAL                                
W33304            PERFORM Z100-READ-XMTLOC                                      
W33304            MOVE IN109-INV-ID TO BREAK-INV-ID                             
W33304            MOVE IN109-INV-ID TO WORK-INV-ID                              
W33304            INITIALIZE CYL-COMPUTED-FIELDS                                
W33304      END-IF.                                                             
W33304                                                                          
W33304 B460-PRINT-CYCLE-TOTAL.                                                  
W33304                                                                          
W33304     MOVE SPACES                    TO D1-DETAIL-DATA.                    
W33304                                                                          
W33304     MOVE XMT00001-LOC-NBR          TO PV-EDIT-LOC-NBR-NUM                
W33304     MOVE PV-EDIT-LOC-NBR-NUM       TO C1-STORE-NBR                       
W33304     MOVE 'CYCLE TOTAL ' TO D1-DETAIL-DATA(1:12)                          
W33304                                                                          
           MOVE PV-CYL-TSUMINV-AMT            TO D1-PHYSICAL-INVEN              
W33304                                           WORK-PHY-INV                   
           MOVE PV-CYL-TSTKRMW-AMT            TO D1-STOCKROOM-WDRAWL            
           MOVE PV-CYL-TADJDTL-STORE-AMT      TO D1-STORE-CORRECTIONS           
W28543     MOVE PV-CYL-TADJDTL-MISS-MKUP-AMT  TO D1-MISSED-MARKUPS              
           MOVE PV-CYL-TADJDTL-AUDIT-AMT      TO D1-AUDIT-CORRECTIONS           
           MOVE PV-CYL-TADJDTL-SALE-ADJMT-AMT TO D1-SALE-ADJUST                 
W33304                                                                          
           COMPUTE PV-CYL-ADJUSTED-PHYSICAL =                                   
                   PV-CYL-TSUMINV-AMT       -                                   
                   PV-CYL-TSTKRMW-AMT       +                                   
                   PV-CYL-TADJDTL-STORE-AMT +                                   
W28543             PV-CYL-TADJDTL-MISS-MKUP-AMT +                               
                   PV-CYL-TADJDTL-AUDIT-AMT +                                   
                   PV-CYL-TADJDTL-SALE-ADJMT-AMT                                
                                                                                
W33304                                                                          
W33304     IF PC-LINE-COUNT > +59                                               
W33304         PERFORM Z800-PRINT-HEADINGS                                      
W33304     END-IF.                                                              
                                                                                
W33304     MOVE PV-CYL-ADJUSTED-PHYSICAL TO D1-ADJUSTED-PHYSICAL.               
W33304     IF WORK-PHY-INV NOT = ZERO                                           
W33304     MOVE D1-DETAIL-LINE           TO REPORT-LINE.                        
W33304     PERFORM Z700-WRITE-REPORT-LINE.                                      
W33304     INITIALIZE CYL-COMPUTED-FIELDS.                                      
                                                                                
W33304     SET  D1-SINGLE-SPACE          TO TRUE.                               
       B600-EOJ.                                                                
                                                                                
W21732        IF (PV-TSUMINV-AMT       NOT = +0) OR                             
W21732           (PV-TSTKRMW-AMT       NOT = +0) OR                             
W21732           (PV-TADJDTL-AUDIT-AMT NOT = +0) OR                             
W21732           (PV-TADJDTL-STORE-AMT NOT = +0) OR                             
W28543           (PV-TADJDTL-MISS-MKUP-AMT NOT = +0)                            
W21732            PERFORM B400-PRINT-DETAIL-LINE                                
W21732            PERFORM B410-PRINT-STORE-TOTAL                                
W21732            INITIALIZE TB-DEPT-TABLE                                      
W21732            INITIALIZE PV-COMPUTED-FIELDS                                 
W21732        END-IF                                                            
W26600**** MOVE 'TTL'                    TO H1B-STORE                           
W26600     MOVE SPACES                   TO H1B-STORE-NAME                      
           PERFORM Z800-PRINT-HEADINGS                                          
                                                                                
W33304     PERFORM B440-PRINT-STAT-TOTAL.                                       
                                                                                
           PERFORM Z800-PRINT-HEADINGS                                          
W33304     PERFORM B460-PRINT-CYCLE-TOTAL.                                      
W33304     MOVE SPACES TO H1A-HEADING                                           
W33304     MOVE SPACES TO H1A-STAT-RED                                          
W33304     MOVE '     CYCLE TTL        ' TO H1A-INV-STAT                        
W33304     PERFORM Z800-PRINT-HEADINGS                                          
           MOVE SPACES                        TO D1-DETAIL-LINE.                
           SET  D1-DOUBLE-SPACE               TO TRUE.                          
                                                                                
           MOVE 'ALL CYCLES'                  TO D1-COMMENT                     
           MOVE PV-GTT-TSUMINV-AMT            TO D1-PHYSICAL-INVEN              
W33304                                           WORK-PHY-INV                   
           MOVE PV-GTT-TSTKRMW-AMT            TO D1-STOCKROOM-WDRAWL            
           MOVE PV-GTT-TADJDTL-STORE-AMT      TO D1-STORE-CORRECTIONS           
W28543     MOVE PV-GTT-TADJDTL-MISS-MKUP-AMT  TO D1-MISSED-MARKUPS              
           MOVE PV-GTT-TADJDTL-AUDIT-AMT      TO D1-AUDIT-CORRECTIONS           
           MOVE PV-GTT-TADJDTL-SALE-ADJMT-AMT TO D1-SALE-ADJUST                 
                                                                                
           COMPUTE PV-GTT-ADJUSTED-PHYSICAL =                                   
                   PV-GTT-TSUMINV-AMT       -                                   
                   PV-GTT-TSTKRMW-AMT       +                                   
                   PV-GTT-TADJDTL-STORE-AMT +                                   
W28543             PV-GTT-TADJDTL-MISS-MKUP-AMT +                               
                   PV-GTT-TADJDTL-AUDIT-AMT +                                   
                   PV-GTT-TADJDTL-SALE-ADJMT-AMT                                
                                                                                
           COMPUTE PV-GTT-NET-ADJUSTMENT =                                      
                   PV-GTT-TSTKRMW-AMT       +                                   
                   PV-GTT-TADJDTL-STORE-AMT +                                   
                   PV-GTT-TADJDTL-AUDIT-AMT +                                   
                   PV-GTT-TADJDTL-SALE-ADJMT-AMT                                
                                                                                
           MOVE PV-GTT-ADJUSTED-PHYSICAL TO D1-ADJUSTED-PHYSICAL                
W33304     IF WORK-PHY-INV NOT = ZERO                                           
              MOVE D1-DETAIL-LINE           TO REPORT-LINE.                     
           PERFORM Z700-WRITE-REPORT-LINE.                                      
                                                                                
W21732     CLOSE PHY-INVENTORY-SUMMARY-FILE                                     
W21732           ADJ-PHY-INVENTORY-REPORT.                                      
                                                                                
W26600 Z100-READ-XMTLOC.                                                        
W21732                                                                          
W21732     MOVE '*Z100-READ-XMTLOC.   *' TO PV-PARA.                            
W26600     MOVE IN109-STORE-NBR           TO PV-EDIT-LOC-NBR.                   
W26600     MOVE PV-EDIT-LOC-NBR-NUM       TO XMT00001-LOC-NBR.                  
W21732                                                                          
W21732     EXEC SQL                                                             
W26600         SELECT LOC_NM                                                    
W26600          INTO :XMT00001-LOC-NM                                           
W26600          FROM XMT_LOC                                                    
W26600         WHERE LOC_NBR = :XMT00001-LOC-NBR                                
W27710         WITH UR                                                          
W21732     END-EXEC                                                             
W21732                                                                          
W21732     EVALUATE TRUE                                                        
W21732         WHEN SQLCODE = +0                                                
W26600           MOVE IN109-STORE-NBR        TO H1B-STORE                       
W26600           MOVE XMT00001-LOC-NM (1:12) TO H1B-STORE-NAME                  
W21732         WHEN OTHER                                                       
W26600             MOVE 'READING XMTLOC TABLE'                                  
W21732                           TO  PV-DB2-OPER-ATTEMPTED                      
W21732             PERFORM Z900-SQL-ABEND                                       
W21732     END-EVALUATE.                                                        
                                                                                
W33304 Z200-READ-CNTL.                                                          
                                                                                
W33304     MOVE '*Z200-READ-CNTL.                  *' TO PV-PARA.               
                                                                                
W33304     EXEC SQL                                                             
W33304         SELECT INV_ID                                                    
W33304               ,INV_NM                                                    
W33304          INTO :INCNTL-INV-ID                                             
W33304              ,:INCNTL-INV-NM                                             
W33304          FROM TINCNTL                                                    
W33304         WHERE INV_ID = :IN109-INV-ID                                     
W33304     END-EXEC.                                                            
W33304     MOVE SPACES             TO H1A-INV-STAT                              
W33304     MOVE INCNTL-INV-NM-TEXT TO H1A-INV-STAT.                             
W33304     MOVE INCNTL-INV-ID      TO HOLD-INV-ID.                              
                                                                                
W33304 Z300-READ-INV-STAT.                                                      
                                                                                
W33304     MOVE '*Z300-READ-INV-STAT               *' TO PV-PARA.               
W33304                                                                          
W33304     EXEC SQL                                                             
W33304         SELECT INV_STAT_CDE                                              
W33304               ,INV_STAT_CDE_DESC                                         
W33304          INTO :INT-STAT-CDE                                              
W33304              ,:INT-STAT-CDE-DESC                                         
W33304          FROM INT_INV_STAT_CDE                                           
W33304         WHERE INV_STAT_CDE = :IN109-FINCL-INV-STAT-CDE                   
W33304     END-EXEC.                                                            
                                                                                
       Z700-WRITE-REPORT-LINE.                                                  
                                                                                
           MOVE REPORT-LINE-CC  TO  PC-REPORT-CC.                               
21015      MOVE SPACE           TO  REPORT-LINE-CC.                             
  |                                                                             
  |        IF PC-REPORT-CC IS EQUAL TO SPACE                                    
  |          WRITE REPORT-LINE AFTER ADVANCING 1 LINE                           
  |        ELSE                                                                 
  |        IF PC-REPORT-CC IS EQUAL TO '0'                                      
  |          WRITE REPORT-LINE AFTER ADVANCING 2 LINES                          
  |        ELSE                                                                 
  |        IF PC-REPORT-CC IS EQUAL TO '-'                                      
  |          WRITE REPORT-LINE AFTER ADVANCING 3 LINES                          
  |        ELSE                                                                 
  |        IF PC-REPORT-CC IS EQUAL TO '1'                                      
  |          WRITE REPORT-LINE AFTER ADVANCING PAGE                             
  |        ELSE                                                                 
  |          WRITE REPORT-LINE AFTER ADVANCING 1 LINE.                          
21015                                                                           
           EVALUATE TRUE                                                        
21015          WHEN PC-REPORT-CC   = '1'                                        
21015              CONTINUE                                                     
               WHEN PC-REPORT-CC   = ' '                                        
                   ADD +1 TO  PC-LINE-COUNT                                     
               WHEN PC-REPORT-CC   = '0'                                        
                   ADD +2 TO  PC-LINE-COUNT                                     
               WHEN PC-REPORT-CC   = '-'                                        
                   ADD +3 TO  PC-LINE-COUNT                                     
21015          WHEN OTHER                                                       
21015              ADD +1 TO  PC-LINE-COUNT                                     
           END-EVALUATE.                                                        
                                                                                
       Z800-PRINT-HEADINGS.                                                     
                                                                                
           ADD 1              TO PC-PAGE-COUNT.                                 
                                                                                
           MOVE PC-PAGE-COUNT TO DP133O-PAGE-NUMBER.                            
           MOVE 1             TO DP133O-REPORT-NUMBER.                          
           MOVE DP133O-STANDRD-HEADER-133-COLS TO REPORT-LINE.                  
           MOVE '1'           TO REPORT-LINE-CC                                 
           MOVE ' '           TO REPORT-HEADER-FONT-INDICATOR                   
                                                                                
           PERFORM Z700-WRITE-REPORT-LINE.                                      
           MOVE H1-HEADING TO REPORT-LINE.                                      
           PERFORM Z700-WRITE-REPORT-LINE.                                      
                                                                                
W33304     PERFORM Z300-READ-INV-STAT                                           
W33304     PERFORM Z200-READ-CNTL                                               
W33304     MOVE IN109-FINCL-INV-STAT-CDE TO H1A-INV-STAT-CDE.                   
W33304     MOVE INT-STAT-CDE-DESC TO H1A-INV-DESC.                              
                                                                                
W33304     MOVE WORK-INV-ID-R TO H1A-STAT-CDE                                   
W33304     IF STAT-BK = 'Y'                                                     
W33304        MOVE 'N' TO STAT-BK                                               
W33304        MOVE STAT-STAT-CDE TO H1A-INV-STAT-CDE                            
W33304        MOVE STAT-INV-DESC TO H1A-INV-DESC                                
W33304        MOVE STAT-HEAD TO H1A-STAT-CDE                                    
W33304        MOVE SPACES TO H1B-HEADING.                                       
                                                                                
W33304     IF CYCLE-BK = 'Y'                                                    
W33304        MOVE 'N' TO CYCLE-BK                                              
W33304        MOVE SPACES        TO H1A-INV-STAT-CDE                            
W33304                              H1A-INV-DESC                                
W33304        MOVE SPACES TO H1B-HEADING.                                       
                                                                                
W33304     MOVE WORK-INV-ID-R TO STAT-HEAD.                                     
W33304     MOVE IN109-FINCL-INV-STAT-CDE TO STAT-STAT-CDE.                      
W33304     MOVE INT-STAT-CDE-DESC TO STAT-INV-DESC.                             
W33304     IF END-PGM = 'Y'                                                     
W33304        MOVE SPACES TO H1A-INV-STAT                                       
W33304                       H1A-INV-DESC                                       
W33304                       H1B-STORE.                                         
                                                                                
W33304     MOVE H1A-HEADING TO REPORT-LINE.                                     
W33304     PERFORM Z700-WRITE-REPORT-LINE.                                      
W26600***  MOVE XMT00001-LOC-NBR         TO H1B-STORE.                          
W26600***  MOVE XMT00001-LOC-NM (1:12)   TO H1B-STORE-NAME.                     
           MOVE H1B-HEADING TO REPORT-LINE.                                     
                                                                                
           PERFORM Z700-WRITE-REPORT-LINE.                                      
           MOVE H2-HEADING TO REPORT-LINE.                                      
           PERFORM Z700-WRITE-REPORT-LINE.                                      
           MOVE H3-HEADING TO REPORT-LINE.                                      
           PERFORM Z700-WRITE-REPORT-LINE.                                      
W33304     MOVE SPACES TO REPORT-LINE.                                          
                                                                                
           MOVE +6         TO PC-LINE-COUNT.                                    
                                                                                
           SET  D1-DOUBLE-SPACE          TO TRUE.                               
                                                                                
      ******************************************************************        
      *  STANDARD DB2 ERROR ABEND ROUTINE                                       
      *  THIS ROUTINE FORCES AN ABEND DUE TO A DB2 PROBLEM.                     
      ******************************************************************        
       Z900-SQL-ABEND.                                                          
                                                                                
           MOVE +4013                 TO ABEND-CODE.                            
           DISPLAY '**  ABEND     **'.                                          
           DISPLAY '**  PROGRAM   **  =  INKRP111'.                             
           DISPLAY '**  PARAGRAPH **  = ' PV-PARA.                              
           DISPLAY '**  OPERATION **  = ' PV-DB2-OPER-ATTEMPTED.                
                                                                                
      *    THE FOLLOWING COPYBOOK UTILIZES THE DB2 ABEND MODULE                 
      *    DSNTIAR TO CONVERT SQLCA INTO UNDERSTANDABLE VERBAGE.                
                                                                                
           COPY DPPD004.                                                        
                                                                                
           CALL 'ILBOABN0'  USING ABEND-CODE.                                   
