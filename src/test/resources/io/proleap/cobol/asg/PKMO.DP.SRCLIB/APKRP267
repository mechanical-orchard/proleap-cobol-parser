000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.     APKRP267.                                        00020000
000300 AUTHOR.         R.OCONNELL, STRATAGEM.                           00030000
000400 DATE-WRITTEN.   07/08/1994.                                      00040000
000500 DATE-COMPILED.                                                   00050000
000600*************************************************************     00060000
000700*    COBOL 2                                                *     00070000
000800*                                                           *     00080000
000900*    FREIGHT ON INVOICE REPORT                              *     00090000
001000*                                                           *     00100000
001100*   PROGRAM OVERVIEW:                                       *     00110000
001200*                                                           *     00120000
001300*     THIS PROGRAM CREATES THE FREIGHT ON INVOICE REPORT    *     00130000
001400*   FROM THE FREIGHT EXTRACT CREATED IN APKRP265            *     00140000
001500*                                                           *     00150000
001600*   INPUT:                                                  *     00160000
001700*                                                           *     00170000
001800*  1) FREIGHT-EXT-FILE                  (APRD267)           *     00180000
001900*                                                           *     00190000
002000*   OUTPUT:                                                 *     00200000
002100*                                                           *     00210000
002200*  1) PRINT-FILE                        (DPWS150O)          *     00220000
002300*  2) ERROR-FILE                        (DPWS150O)          *     00230000
002400*                                                           *     00240000
002500*************************************************************     00250000
002600*   CHANGES:                                                *     00260000
002700*                                                           *     00270000
002800* 11/06/95  INCREASED INVOICE TABLE OCCURS FROM 200 TO 500  *     00280000
002900*           MADE BY: MARILYN WILKINSON          IR #: 9657  *     00290000
003000* 07/25/96  ADDED RPT-LINE-2 TO HELP MAKE THE COLUMN        *     00300000
003100*           HEADINGS EASIER TO READ.  SINCE AS/OF WR3707    *     00310000
003200*           THE FREIGHT COLUMN IS KOHLS FREIGHT NOT THE     *     00320000
003300*           TOTAL FREIGHT.                                  *     00330000
003400*           BY: PDVOLK                          WR#:3707    *     00340000
003500* 05/12/97  INCREASED THE NUMBER OF OCCURRENCES OF THE      *     00350000
003600*           INVOICE-TBL-DATA FROM 500 TO 1000.              *     00360000
003700*           MADE BY: NANCY EILBES             PITS#: 82323  *     00370000
003800*                                                           *     00380000
003900* 09/30/97  MODIFICATIONS WERE MADE TO HANDLE THE PRINTING  *     00390000
004000*           OF THE NON-INVOICED RECEIPTS.                   *     00400000
004100*           MADE BY: JOYCE KNOKE(TCC)/MARY KING WR#:5536    *     00410000
004200*                                                           *     00420000
004300* 11/01/99  INCREASED THE NUMBER OF ENTRIES FROM 20 TO 99   *     00430000
004400*           FOR THE INTERNAL CLASS NUMBER TABLE.  ALSO HAD  *     00440000
004500*           TO INCREASE THE TABLE SIZE IN THE COPYBOOK      *     00450000
004600*           APRD267I ALSO.  THIS MEANT THAT THE SIZE OF THE *     00460000
004700*           INPUT FILE WAS INCREASED FROM 82 TO 242.        *     00470000
004800*           MADE BY: MIKE BESKE                 IR#:327155  *     00480000
004900*                                                           *     00490000
005000* 11/08/99  INCREASED THE SIZE OF BOTH THE INVOICE AND      *     00500000
005100*           REC-SEQ INTERNAL TABLES FROM 1000 TO 2000.      *     00510000
005200*           MADE BY: ROBIN BERNOSKI             IR#:328350  *     00520000
005300*                                                           *     00530000
005400* 01/02/03  CORRECTED SIZE OF INPUT FILE (APRD267I          *     00540000
005500*           COPYBOOK) TO 218.  AP267I-FREIGHT-AMT WAS       *     00550000
005600*           CHANGED TO AP267I-CHARGE-AMT.                   *     00560000
005700*           MADE BY: KEVIN CATLIN           WR#: WR23646    *     00570000
005800*                                                           *     00580000
005900* 02/05/2003                                                *     00590000
006000*    CHANGE MADE: ARKPO PHASE3 PROJECT.                     *     00600000
006100*    UPDATED THE PROGRAM TITLE TO MATCH THE SPEC TITLE.     *     00610000
006200*    UPDATED THE FILE NAMES IN THE PROGRAM COMMENT BLOCK.   *     00620000
006300*    UPDATED THE VARIOUS W/S AND PRINT PO NUMBER FIELDS TO  *     00630000
006400*    SIMILAR FIELD NAMES (IE, -PO-NBR). CHANGED THE VARIOUS *     00640000
006500*    PRINT PO NUMBERS TO PIC Z(9). INCREASED THE SIZE OF THE*     00650000
006600*    VARIOUS W/S PO NBR FROM 7 TO 9 BYTES. CHANGED THE LEN  *     00660000
006700*    OF THE INPUT FILE TO 255 BYTES BECAUSE APRD267 WAS     *     00670000
006800*    INCREASED. CHANGED THE COPYBOOK PREFIXES FROM AP267I-  *     00680000
006900*    TO AP267-. REALIGNED THE PRINT HEADERS BECAUSE OF THE  *     00690000
007000*    INCREASED PO NBR LENGTH.                               *     00700000
007100* MADE BY:  MIKE BESKE                          WR#: 23500  *     00710000
007101*                                                           *     00710100
007102* 03/11/2007                                                *     00710201
007103*     MATCH BY DC PROJECT.                                  *     00710300
007104*     ADDED DC AND MTCH LVL CDE TO THE DETAIL HEADER AND    *     00710400
007105*     THE DETAIL LINE.  ADDED DC-NBR AND MTCH LVL CDE TO    *     00710500
007106*     INVTBL AND PRINT AREA IN WORKING STORAGE.  MODIFIED   *     00710600
007107*     2000- AND 3100- TO PLACE DC NBR AND MTCH LVL CDE      *     00710700
007108*     ONTO REPORT LINE.                                     *     00710800
007109*                                                           *     00710900
007110*     INCREASED THE SIZE OF THE REPORT FROM 133 TO 150      *     00711000
007120*     CHARACTERS.  THIS REQUIRED THE COPYBOOK FOR THE       *     00712000
007130*     THE HEADERS TO BE CHANGED FROM DPWS133O TO DPWS150O.  *     00713000
007140* MADE BY: MICHELE RINDFLEISCH            WR #: 21578       *     00714000
007150*************************************************************     00715000
007160     EJECT                                                        00716000
007170 ENVIRONMENT DIVISION.                                            00717000
007180 CONFIGURATION SECTION.                                           00718000
007190 INPUT-OUTPUT SECTION.                                            00719000
007200 FILE-CONTROL.                                                    00720000
007300     SELECT FREIGHT-EXT-FILE  ASSIGN TO UT-S-INP01.               00730000
007400     SELECT PRINT-FILE        ASSIGN TO UT-S-RPT01.               00740000
007500     SELECT ERROR-FILE        ASSIGN TO UT-S-RPT02.               00750000
007600     EJECT                                                        00760000
007700 DATA DIVISION.                                                   00770000
007800 FILE SECTION.                                                    00780000
007900 FD  FREIGHT-EXT-FILE                                             00790000
008000     RECORDING MODE IS F                                          00800000
008100     LABEL RECORDS ARE STANDARD                                   00810000
008200     BLOCK CONTAINS 0 RECORDS                                     00820000
008300     DATA RECORD IS FREIGHT-EXT-RECORD.                           00830000
008400 01  FREIGHT-EXT-RECORD               PIC  X(255).                00840000
008500                                                                  00850000
008600 FD  PRINT-FILE                                                   00860000
008700     RECORDING MODE IS F                                          00870000
008800     LABEL RECORDS ARE STANDARD                                   00880000
008900     BLOCK CONTAINS 0 RECORDS                                     00890000
009000     RECORD CONTAINS 150 CHARACTERS                               00900000
009100     DATA RECORD IS PRINT-RECORD.                                 00910000
009200 01  PRINT-RECORD                     PIC  X(150).                00920000
009300                                                                  00930000
009400 FD  ERROR-FILE                                                   00940000
009500     RECORDING MODE IS F                                          00950000
009600     LABEL RECORDS ARE STANDARD                                   00960000
009700     BLOCK CONTAINS 0 RECORDS                                     00970000
009800     DATA RECORD IS ERROR-REC.                                    00980000
009900 01  ERROR-REC                        PIC  X(150).                00990000
010000     EJECT                                                        01000000
010100 WORKING-STORAGE SECTION.                                         01010000
010200 01  PROGRAM-WORKAREA.                                            01020000
010300     05  FILLER                      PIC  X(30) VALUE             01030000
010400                                 '** BEGINING OF APKRP267 W/S **'.01040000
010500     05  PW-CURRENT-PARAGRAPH         PIC  X(30).                 01050000
010600     05  PW-REPORT-NAME               PIC  X(08)    VALUE         01060000
010700                                      'APKRP267'.                 01070000
010800     05  PW-REPORT-NBR                PIC  9(01)    VALUE 1.      01080000
010900     05  PW-FREIGHT-AMT-TOT           PIC  9(09)V99 VALUE ZEROES  01090000
011000                                                    COMP-3.       01100000
011100     05  PW-LINE-COUNT                PIC  9(03)    VALUE 99      01110000
011200                                                    COMP-3.       01120000
011300     05  PW-PAGE-COUNT                PIC  9(05)    VALUE ZERO    01130000
011400                                                    COMP-3.       01140000
011500     05  PW-ERROR-COUNT               PIC  9(05)    VALUE ZERO    01150000
011600                                                    COMP-3.       01160000
011700     05  PW-INPUT-COUNT               PIC  9(05)    VALUE ZERO    01170000
011800                                                    COMP-3.       01180000
011900     05  PW-MAX-LINES                 PIC  9(03)    VALUE 60      01190000
012000                                                    COMP-3.       01200000
012100     05  PW-ADVANCE-COUNT             PIC S9(03)    VALUE ZERO    01210000
012200                                                    COMP-3.       01220000
012300     05  PW-ERROR-PERCENT             PIC  9V99     VALUE 0.05    01230000
012400                                                    COMP-3.       01240000
012500     05  PW-ERROR-LINE-COUNT          PIC  9(03)    VALUE  99     01250000
012600                                                    COMP-3.       01260000
012700     05  PW-ERROR-PAGE-COUNT          PIC  9(05)    VALUE ZERO    01270000
012800                                                    COMP-3.       01280000
012900     05  PW-ERROR-THRESH              PIC  9(05)    VALUE 0       01290000
013000                                                    COMP-3.       01300000
013100     05  PW-DISPLAY-COUNT             PIC  9(05)    VALUE 0.      01310000
013200                                                                  01320000
013300     05  PW-SAVE-ENTRY-METHOD         PIC  X(01)    VALUE SPACE.  01330000
013400     05  PW-SAVE-REPORT-NUMBER        PIC  9(01)    VALUE ZERO.   01340000
013500     05  PW-PREV-PO-NBR               PIC  9(9)     VALUE ZERO.   01350000
013600     05  PW-PREV-RECORD-TYPE          PIC  X(01)    VALUE SPACE.  01360000
013700         88  PW-PREV-VENDOR                         VALUE 'A'.    01370000
013800         88  PW-PREV-INVOICE                        VALUE 'B'.    01380000
013900         88  PW-PREV-RECEIVER                       VALUE 'C'.    01390000
014000     05  PW-PREV-VENDOR-NAME          PIC  X(15)    VALUE SPACES. 01400000
014100     05  PW-PREV-VENDOR-NUMBER        PIC  9(09)    VALUE ZERO.   01410000
014200     05  PW-PREV-INVOICE-NUMBER       PIC  X(22)    VALUE SPACES. 01420000
014300     05  PW-SAVE-INVOICE-NUMBER       PIC  X(22)    VALUE SPACES. 01430000
014400                                                                  01440000
014500     05  PW-SAVE-PO-NBR               PIC  9(9)     VALUE ZERO.   01450000
014600     05  PW-SAVE-VENDOR-NAME          PIC  X(15)    VALUE SPACES. 01460000
014700     05  PW-SAVE-VENDOR-NUMBER        PIC  9(09)    VALUE ZERO.   01470000
014800     05  PW-SAVE-DEPARTMENT-NUMBER    PIC  9(03)    VALUE ZERO.   01480000
014900     05  PW-SAVE-CARTON-COUNT         PIC  9(05)    VALUE ZERO.   01490000
015000     05  PW-NINREC-CARTONS            PIC  9(05)    VALUE ZERO.   01500000
015100                                                                  01510000
015200 01  WS-ABEND-FIELDS.                                             01520000
015300     05  WS-ABEND-PROGRAM             PIC X(8)  VALUE 'APKRP267'. 01530000
015400     05  WS-ABEND-PARAGRAPH           PIC X(50) VALUE SPACES.     01540000
015500     05  WS-ABEND-OPERATION           PIC X(50) VALUE SPACES.     01550000
015600     05  WS-ABEND-STATUS              PIC XX    VALUE SPACES.     01560000
015700     05  WS-ABEND-CODE                PIC S9(04)    VALUE ZERO    01570000
015800                                                    COMP SYNC.    01580000
015900         88 WRITE-ERROR                             VALUE +4001.  01590000
016000         88 READ-ERROR                              VALUE +4002.  01600000
016100         88 CC-ERRROR                               VALUE +4003.  01610000
016200         88 TABLE-ERROR                             VALUE +4004.  01620000
016300         88 OPEN-ERROR                              VALUE +4005.  01630000
016400         88 CLOSE-ERROR                             VALUE +4006.  01640000
016500         88 SEQ-ERROR                               VALUE +4007.  01650000
016600         88 DATA-ERROR                              VALUE +4008.  01660000
016700         88 KEYPUNCH-ERROR                          VALUE +4009.  01670000
016800         88 SORT-ERROR                              VALUE +4012.  01680000
016900         88 DB2-ERROR                               VALUE +4013.  01690000
017000         88 DATE-ERROR                              VALUE +4019.  01700000
017100                                                                  01710000
017200                                                                  01720000
017300 01  PROGRAM-SWITCHES.                                            01730000
017400     05  PW-END-PROCESSING-SW         PIC  X(01)    VALUE 'N'.    01740000
017500         88  END-OF-PROCESSING                      VALUE 'Y'.    01750000
017600     05  PW-NEW-VENDOR-RPT-SW         PIC  X(01)    VALUE 'N'.    01760000
017700         88  NEW-VENDOR                             VALUE 'Y'.    01770000
017800         88  NOT-NEW-VENDOR                         VALUE 'N'.    01780000
017900     05  PW-RECVR-PROC-RPT-SW         PIC  X(01)    VALUE 'N'.    01790000
018000         88  RECEIVER-DATA                          VALUE 'Y'.    01800000
018100         88  NO-RECEIVER-DATA                       VALUE 'N'.    01810000
018200     05  PW-NINREC-SW                 PIC  X(01)    VALUE 'N'.    01820000
018300         88  NINREC-DATA                            VALUE 'Y'.    01830000
018400         88  NO-NINREC-DATA                         VALUE 'N'.    01840000
018500     05  PW-CLASS-TBL-PROC-SW         PIC  X(01)    VALUE 'N'.    01850000
018600         88  ALL-CLASS-TBL-PROC                     VALUE 'Y'.    01860000
018700         88  CLASS-TBL-NOT-PROC                     VALUE 'N'.    01870000
018800     05  PW-RECVR-TBL-PROC-SW         PIC  X(01)    VALUE 'N'.    01880000
018900         88  ALL-RECVR-TBL-PROC                     VALUE 'Y'.    01890000
019000         88  RECVR-TBL-NOT-PROC                     VALUE 'N'.    01900000
019100     05  PW-INVC-TBL-PROC-SW          PIC  X(01)    VALUE 'N'.    01910000
019200         88  ALL-INVC-TBL-PROC                      VALUE 'Y'.    01920000
019300         88  INVC-TBL-NOT-PROC                      VALUE 'N'.    01930000
019400     05  PW-DUP-CLASS-PROC-SW         PIC  X(01)    VALUE 'N'.    01940000
019500         88  DUPLICATE-CLASS                        VALUE 'Y'.    01950000
019600         88  NOT-DUPLICATE-CLASS                    VALUE 'N'.    01960000
019700     05  PW-DUP-RECV-PROC-SW          PIC  X(01)    VALUE 'N'.    01970000
019800         88  DUPLICATE-RECV                         VALUE 'Y'.    01980000
019900         88  NOT-DUPLICATE-RECV                     VALUE 'N'.    01990000
020000     05  PW-SEARCH-PROC-SW            PIC  X(01)    VALUE 'N'.    02000000
020100         88  END-OF-SEARCH                          VALUE 'Y'.    02010000
020200         88  NOT-END-OF-SEARCH                      VALUE 'N'.    02020000
020300     05  PW-FIRST-PROC-SW             PIC  X(01)    VALUE 'Y'.    02030000
020400         88  FIRST-PASS                             VALUE 'Y'.    02040000
020500         88  NOT-FIRST-PASS                         VALUE 'N'.    02050000
020600                                                                  02060000
020700 01  INVOICE-TABLE.                                               02070000
020800     05  INVOICE-TBL-DATA         OCCURS 3000 TIMES.              02080005
020900         10  INVTBL-INVOICE-NUMBER           PIC X(22).           02090000
021000         10  INVTBL-INVOICE-DATE.                                 02100000
021100             15  INVTBL-INVC-MONTH           PIC 9(02).           02110000
021200             15  INVTBL-INVC-DAY             PIC 9(02).           02120000
021300             15  INVTBL-INVC-YEAR            PIC 9(02).           02130000
021400         10  INVTBL-STORE-NUMBER             PIC 9(04).           02140000
021500         10  INVTBL-FREIGHT-AMT              PIC 9(09)V99  COMP-3.02150000
021600         10  INVTBL-DC-NBR                   PIC 9(05).           02160000
021700         10  INVTBL-MTCH-LVL-CDE             PIC X(01).           02170000
021800 01  INV-TBL-SUB            PIC 9(4) VALUE ZERO.                  02180000
021900                                                                  02190000
022000 01  CLASS-TABLE.                                                 02200000
022100     05  CLASS-DATA         OCCURS 99 TIMES.                      02210000
022200         10  CLASS-TABLE-ENTRY  PIC 9(3).                         02220000
022300 01  CLASS-NBR              PIC 9(2) VALUE ZERO.                  02230000
022400 01  CLASS-NBR-PROC         PIC 9(2) VALUE ZERO.                  02240000
022500 01  SEARCH-CLASS           PIC X(3).                             02250000
022600 01  SEARCH-SUB             PIC 9(4) VALUE ZERO.                  02260000
022700 01  NBR-ENTRY-MOVES        PIC 9(2) VALUE ZERO.                  02270000
022800                                                                  02280000
022900 01  RECV-SEQ-TABLE.                                              02290000
023000     05  RECV-SEQ-DATA         OCCURS 3000 TIMES.                 02300005
023100         10  RECV-SEQ-TBL-ENTRY  PIC 9(4).                        02310000
023200         10  RECV-SEQ-TBL-ENTRY-R   REDEFINES RECV-SEQ-TBL-ENTRY  02320000
023300                                 PIC X(4).                        02330000
023400                                                                  02340000
023500 01  RECV-SEQ-SUB              PIC 9(4) VALUE ZERO.               02350000
023600 01  RECV-SEQ-NBR-PROC         PIC 9(4) VALUE ZERO.               02360000
023700                                                                  02370000
023800 01  PW-CURRENT-DATE.                                             02380000
023900     05  PW-CURRENT-YEAR              PIC  9(02)    VALUE ZEROES. 02390000
024000     05  PW-CURRENT-MONTH             PIC  9(02)    VALUE ZEROES. 02400000
024100     05  PW-CURRENT-DAY               PIC  9(02)    VALUE ZEROES. 02410000
024200                                                                  02420000
024300 01  PW-CURRENT-TIME.                                             02430000
024400     05  PW-CURRENT-HOUR              PIC  9(02)    VALUE ZEROES. 02440000
024500     05  PW-CURRENT-MINUTE            PIC  9(02)    VALUE ZEROES. 02450000
024600     05  FILLER                       PIC  9(02)    VALUE ZEROES. 02460000
024700                                                                  02470000
024800 01  RECV-SEQ-NBR-TRUNC.                                          02480000
024900     05  FILLER                       PIC X(5).                   02490000
025000     05  RECV-SEQ-NBR-1-4             PIC X(4).                   02500000
025100                                                                  02510000
025200 01  PW-CONSTANTS.                                                02520000
025300     05  PW-NO-INVOICE                PIC  X(34)    VALUE         02530000
025400         'MISSING INVOICE RECORD            '.                    02540000
025500     05  PW-NO-INVC-OR-RECEIVERS      PIC  X(34)    VALUE         02550000
025600         'MISSING INVOICE/RECEIVING RECORDS '.                    02560000
025700     05  PW-NO-RECEIVERS              PIC  X(34)    VALUE         02570000
025800         'MISSING RECEIVING RECORD          '.                    02580000
025900     05  PW-MULTIPLE-VENDORS          PIC  X(34)    VALUE         02590000
026000         'MULTIPLE VENDOR RECORDS           '.                    02600000
026100     05  PW-NO-VENDOR                 PIC  X(34)    VALUE         02610000
026200         'MISSING  VENDOR RECORD            '.                    02620000
026300     05  PW-NO-VEND-RECV              PIC  X(34)    VALUE         02630000
026400         'MISSING VENDOR/RECEIVER RECORDS   '.                    02640000
026500     EJECT                                                        02650000
026600     COPY DPWS150O.                                               02660000
026700                                                                  02670000
026800 01  HDR-LINE-2.                                                  02680000
026900     05  FILLER                       PIC  X(66)   VALUE SPACES.  02690000
027000     05  FILLER                       PIC  X(18)  VALUE           02700000
027100                                      'FREIGHT ON INVOICE'.       02710000
027200     05  FILLER                       PIC  X(66)   VALUE SPACES.  02720000
027300                                                                  02730000
027400 01  RPT-LINE-1.                                                  02740000
027500     05  FILLER                       PIC  X(04)    VALUE         02750000
027600                                      'P/O '.                     02760000
027700     05  FILLER                       PIC  X(06)    VALUE SPACES. 02770000
027800     05  FILLER                       PIC  X(07)    VALUE         02780000
027900                                      'VENDOR '.                  02790000
028000     05  FILLER                       PIC  X(03)    VALUE SPACES. 02800000
028100     05  FILLER                       PIC  X(11)    VALUE         02810000
028200                                      'VENDOR NAME'.              02820000
028300     05  FILLER                       PIC  X(05)    VALUE SPACES. 02830000
028400     05  FILLER                       PIC  X(08)    VALUE         02840000
028500                                      'INVOICE '.                 02850000
028600     05  FILLER                       PIC  X(13)    VALUE SPACES. 02860000
028700     05  FILLER                       PIC  X(08)    VALUE         02870000
028800                                      'INVOICE '.                 02880000
028900     05  FILLER                       PIC  X(01)    VALUE SPACES. 02890000
029000     05  FILLER                       PIC  X(06)    VALUE         02900000
029100                                      'STORE '.                   02910000
029200     05  FILLER                       PIC  X(01)    VALUE SPACES. 02920000
029300     05  FILLER                       PIC  X(04)    VALUE         02930000
029400                                      'CART'.                     02940000
029500     05  FILLER                       PIC  X(09)    VALUE SPACES. 02950000
029600     05  FILLER                       PIC  X(07)    VALUE         02960000
029700                                      'KOHLS  '.                  02970000
029800     05  FILLER                       PIC  X(01)    VALUE SPACES. 02980000
029900     05  FILLER                       PIC  X(04)    VALUE         02990000
030000                                      'DEPT'.                     03000000
030100     05  FILLER                       PIC  X(01)    VALUE SPACES. 03010000
030200     05  FILLER                       PIC  X(05)    VALUE         03020000
030300                                      'CLASS'.                    03030000
030400     05  FILLER                       PIC  X(08)    VALUE SPACES. 03040000
030500     05  FILLER                       PIC  X(09)    VALUE         03050000
030600                                      'RCVR SEQ#'.                03060000
030700     05  FILLER                       PIC  X(06)    VALUE SPACES. 03070000
030800     05  FILLER                       PIC  X(02)    VALUE         03080000
030900                                      'DC'.                       03090000
030910     05  FILLER                       PIC  X(04)    VALUE SPACES. 03091000
030920     05  FILLER                       PIC  X(05)    VALUE         03092000
030930                                      'MATCH'.                    03093000
030940     05  FILLER                       PIC  X(11)    VALUE SPACES. 03094000
030950                                                                  03095000
030960                                                                  03096000
030970 01  RPT-LINE-2.                                                  03097000
030980     05  FILLER                       PIC  X(06)    VALUE         03098000
030990                                      'NUMBER'.                   03099000
031000     05  FILLER                       PIC  X(04)    VALUE SPACES. 03100000
031100     05  FILLER                       PIC  X(07)    VALUE         03110000
031200                                      'NUMBER '.                  03120000
031300     05  FILLER                       PIC  X(19)    VALUE SPACES. 03130000
031400     05  FILLER                       PIC  X(08)    VALUE         03140000
031500                                      'NUMBER  '.                 03150000
031600     05  FILLER                       PIC  X(13)    VALUE SPACES. 03160000
031700     05  FILLER                       PIC  X(08)    VALUE         03170000
031800                                      ' DATE   '.                 03180000
031900     05  FILLER                       PIC  X(01)    VALUE SPACES. 03190000
032000     05  FILLER                       PIC  X(06)    VALUE         03200000
032100                                      'NUMBER'.                   03210000
032200     05  FILLER                       PIC  X(14)    VALUE SPACES. 03220000
032300     05  FILLER                       PIC  X(07)    VALUE         03230000
032400                                      'FREIGHT'.                  03240000
032500     05  FILLER                       PIC  X(34)    VALUE SPACES. 03250000
032600     05  FILLER                       PIC  X(03)    VALUE         03260000
032700                                      'NBR'.                      03270000
032800     05  FILLER                       PIC  X(03)    VALUE SPACES. 03280000
032900     05  FILLER                       PIC  X(07)    VALUE         03290000
032910                                      'LVL CDE'.                  03291000
032920     05  FILLER                       PIC  X(10)    VALUE SPACES. 03292000
032930     EJECT                                                        03293000
032940 01  PRINT-LINE.                                                  03294000
032950     05  PRINT-PO-NBR                 PIC  Z(09).                 03295000
032960     05  FILLER                       PIC  X(01)    VALUE SPACES. 03296000
032970     05  PRINT-VENDOR-NUMBER          PIC  X(09).                 03297000
032980     05  FILLER                       PIC  X(01)    VALUE SPACES. 03298000
032990     05  PRINT-VENDOR-NAME            PIC  X(15).                 03299000
033000     05  FILLER                       PIC  X(01)    VALUE SPACE.  03300000
033100     05  PRINT-INVOICE-NUMBER         PIC  X(20).                 03310000
033200     05  FILLER                       PIC  X(01)    VALUE SPACES. 03320000
033300     05  PRINT-INVOICE-DATE.                                      03330000
033400         10  PRINT-INVC-DTE-MM        PIC  X(02).                 03340000
033500         10  PRINT-DASH1              PIC  X(01)    VALUE SPACES. 03350000
033600         10  PRINT-INVC-DTE-DD        PIC  X(02).                 03360000
033700         10  PRINT-DASH2              PIC  X(01)    VALUE SPACES. 03370000
033800         10  PRINT-INVC-DTE-YY        PIC  X(02).                 03380000
033900     05  FILLER                       PIC  X(01)    VALUE SPACES. 03390000
034000     05  PRINT-STORE-NUMBER           PIC  X(04).                 03400000
034100     05  FILLER                       PIC  X(03)    VALUE SPACES. 03410000
034200     05  PRINT-CARTON-COUNT           PIC  ZZZZZ.                 03420000
034300     05  PRINT-CART-CNT-ALPHA REDEFINES                           03430000
034400                              PRINT-CARTON-COUNT PIC X(5).        03440000
034500     05  FILLER                       PIC  X(01)    VALUE SPACES. 03450000
034600     05  PRINT-FREIGHT-AMT            PIC  ZZZ,ZZZ,ZZZ.ZZ.        03460000
034700     05  FILLER                       PIC  X(01)    VALUE SPACES. 03470000
034800     05  PRINT-DEPARTMENT-NUMBER      PIC  X(03).                 03480000
034900     05  FILLER                       PIC  X(01)    VALUE SPACES. 03490000
035000     05  PRINT-CLASSES.                                           03500000
035100         10  PRINT-CLASS-DATA         OCCURS 3 TIMES.             03510000
035200             15 FILLER                PIC X VALUE SPACE.          03520000
035300             15  PRINT-CLASS-ENTRY    PIC X(3).                   03530000
035400     05  FILLER                       PIC  X(01)    VALUE SPACE.  03540000
035500     05  PRINT-RCVR-SEQ.                                          03550000
035600         10  PRINT-RECV-SEQ-DATA         OCCURS 3 TIMES.          03560000
035700             15 FILLER                PIC X VALUE SPACE.          03570000
035800             15  PRINT-RECV-SEQ-ENTRY PIC X(4).                   03580000
035900     05  FILLER                       PIC X(01)    VALUE SPACES.  03590000
036000     05  PRINT-DC-NBR                 PIC X(05)    VALUE SPACES.  03600000
036100     05  FILLER                       PIC X(01)    VALUE SPACES.  03610000
036200     05  PRINT-MTCH-LVL-CDE           PIC X(01)    VALUE SPACES.  03620000
036300     05  FILLER                       PIC X(15)    VALUE SPACES.  03630000
036400                                                                  03640000
036500 01  TOTAL-LINE.                                                  03650000
036600     05  FILLER                       PIC  X(13)    VALUE SPACES. 03660000
036700     05  FILLER                       PIC  X(06)    VALUE         03670000
036800                                                    'TOTALS'.     03680000
036900     05  FILLER                       PIC  X(60)    VALUE SPACES. 03690000
037000     05  TOTAL-FREIGHT-AMT            PIC  ZZZ,ZZZ,ZZ9.99.        03700000
037100     05  FILLER                       PIC  X(57)    VALUE SPACES. 03710000
037200                                                                  03720000
037300 01  MANUAL-NOTE.                                                 03730000
037400     05  FILLER                       PIC  X(14)    VALUE         03740000
037500         '  NOTE:       '.                                        03750000
037600     05  FILLER                       PIC  X(54)    VALUE         03760000
037700         'WHEN "INVOICED BY STORE", RECEIVER CARTON COUNT TOTALS'.03770000
037800     05  FILLER                       PIC  X(29)    VALUE         03780000
037900         ' REFLECT THE ENTIRE RECEIVER.'.                         03790000
038000     05  FILLER                       PIC  X(53)    VALUE SPACES. 03800000
038100                                                                  03810000
038200 01  EOR-END-OF-REPORT.                                           03820000
038300     05  FILLER                  PIC  X(61)  VALUE SPACES.        03830000
038400     05  FILLER                  PIC  X(89)  VALUE                03840000
038500         '*****  END OF REPORT *****'.                            03850000
038600                                                                  03860000
038700 01  EH-ERROR-HEADER.                                             03870000
038800     05  FILLER                  PIC  X(01)  VALUE SPACE.         03880000
038900     05  FILLER                  PIC  X(11)  VALUE 'P/O#'.        03890000
039000     05  FILLER                  PIC  X(11)  VALUE 'VENDOR#'.     03900000
039100     05  FILLER                  PIC  X(19)  VALUE 'VENDOR NAME'. 03910000
039200     05  FILLER                  PIC  X(24)  VALUE 'INVOICE#'.    03920000
039300     05  FILLER                  PIC  X(40)  VALUE                03930000
039400         'ERROR MESSAGE'.                                         03940000
039500     05  FILLER                  PIC  X(44)  VALUE SPACES.        03950000
039600                                                                  03960000
039700 01  H3-HEADER3.                                                  03970000
039800     05  FILLER                  PIC  X(69) VALUE SPACES.         03980000
039900     05  FILLER                  PIC  X(12)  VALUE                03990000
040000         'ERROR REPORT'.                                          04000000
040100     05  FILLER                  PIC  X(69) VALUE SPACES.         04010000
040200                                                                  04020000
040300 01  ED-ERROR-DETAIL.                                             04030000
040400     05  FILLER                  PIC  X(01)  VALUE SPACE.         04040000
040500     05  ED-PO-NBR               PIC  Z(09)  VALUE ZEROS.         04050000
040600     05  FILLER                  PIC  X(02)  VALUE SPACES.        04060000
040700     05  ED-VENDOR-NUMBER        PIC  9(09)  VALUE ZEROS.         04070000
040800     05  FILLER                  PIC  X(02)  VALUE SPACES.        04080000
040900     05  ED-VENDOR-NAME          PIC  X(15)  VALUE SPACES.        04090000
041000     05  FILLER                  PIC  X(04)  VALUE SPACES.        04100000
041100     05  ED-INVOICE-NUMBER       PIC  X(22)  VALUE ZEROS.         04110000
041200     05  FILLER                  PIC  X(02)  VALUE SPACES.        04120000
041300     05  ED-ERROR-MESSAGE        PIC  X(40)  VALUE SPACES.        04130000
041400     05  FILLER                  PIC  X(44)  VALUE SPACES.        04140000
041500                                                                  04150000
041600 01  ET-ERROR-TOTALS.                                             04160000
041700     05  FILLER                  PIC  X(01)  VALUE SPACE.         04170000
041800     05  FILLER                  PIC  X(24)  VALUE                04180000
041900         'TOTAL NUMBER OF ERRORS: '.                              04190000
042000     05  ET-ERROR-COUNT          PIC  ZZZZ9  VALUE ZEROS.         04200000
042100     05  FILLER                  PIC  X(120) VALUE SPACES.        04210000
042200     EJECT                                                        04220000
042300     COPY APRD267.                                                04230000
042400     EJECT                                                        04240000
042500 PROCEDURE DIVISION.                                              04250000
042600*                                                                 04260000
042700 0000-MAINLINE.                                                   04270000
042800                                                                  04280000
042900     MOVE '0000-MAINLINE                ' TO PW-CURRENT-PARAGRAPH.04290000
043000     PERFORM 1000-INITIALIZATION THRU 1000-EXIT.                  04300000
043100     PERFORM 2000-DETAIL-PROCESSING THRU 2000-EXIT                04310000
043200         UNTIL END-OF-PROCESSING.                                 04320000
043300     PERFORM 9900-END-OF-INPUT   THRU 9900-EXIT.                  04330000
043400                                                                  04340000
043500     GOBACK.                                                      04350000
043600     EJECT                                                        04360000
043700 1000-INITIALIZATION.                                             04370000
043800     MOVE '1000-INITIALIZATION          ' TO PW-CURRENT-PARAGRAPH.04380000
043900*                                                                 04390000
044000     MOVE ZERO TO PW-PAGE-COUNT                                   04400000
044100                  PW-ERROR-PAGE-COUNT.                            04410000
044200     OPEN INPUT  FREIGHT-EXT-FILE                                 04420000
044300          OUTPUT PRINT-FILE                                       04430000
044400                 ERROR-FILE.                                      04440000
044500     ACCEPT PW-CURRENT-DATE FROM DATE.                            04450000
044600     MOVE PW-CURRENT-MONTH            TO DP150O-RUN-MONTH.        04460000
044700     MOVE PW-CURRENT-DAY              TO DP150O-RUN-DAY.          04470000
044800     MOVE PW-CURRENT-YEAR             TO DP150O-RUN-YEAR.         04480000
044900     ACCEPT PW-CURRENT-TIME FROM TIME.                            04490000
045000     MOVE PW-CURRENT-HOUR             TO DP150O-RUN-HOUR.         04500000
045100     MOVE PW-CURRENT-MINUTE           TO DP150O-RUN-MINUTE.       04510000
045200     MOVE PW-REPORT-NAME              TO DP150O-PROGRAM-NAME.     04520000
045300     MOVE PW-REPORT-NBR               TO DP150O-REPORT-NUMBER.    04530000
045400     PERFORM 8000-READ-FREIGHT-EXT-FILE THRU 8000-EXIT.           04540000
045500     IF NOT END-OF-PROCESSING                                     04550000
045600         PERFORM 7000-NEW-PAGE-PROCESSING THRU 7000-EXIT          04560000
045700         PERFORM 7820-PRINT-ERROR-HEADERS THRU 7820-EXIT          04570000
045800     ELSE                                                         04580000
045900*----EMPTY FILE NO DATA TO REPORT                                 04590000
046000         PERFORM 7000-NEW-PAGE-PROCESSING THRU 7000-EXIT          04600000
046100         PERFORM 7820-PRINT-ERROR-HEADERS THRU 7820-EXIT          04610000
046200         PERFORM 7810-PRINT-END-ERROR THRU 7810-EXIT              04620000
046300     END-IF.                                                      04630000
046400     SET FIRST-PASS                                               04640000
046500         NO-RECEIVER-DATA                                         04650000
046600         NO-NINREC-DATA   TO TRUE.                                04660000
046700                                                                  04670000
046800     INITIALIZE INVOICE-TABLE                                     04680000
046900                CLASS-TABLE                                       04690000
047000                RECV-SEQ-TABLE.                                   04700000
047100     MOVE ZERO TO NBR-ENTRY-MOVES                                 04710000
047200                  CLASS-NBR-PROC                                  04720000
047300                  RECV-SEQ-NBR-PROC.                              04730000
047400                                                                  04740000
047500 1000-EXIT.                                                       04750000
047600     EXIT.                                                        04760000
047700     EJECT                                                        04770000
047800 2000-DETAIL-PROCESSING.                                          04780000
047900     MOVE '2000-DETAIL-PROCESSING       ' TO PW-CURRENT-PARAGRAPH.04790000
048000*                                                                 04800000
048100     IF VENDOR-RECORD                                             04810000
048200         IF AP267-PO-NBR = PW-PREV-PO-NBR                         04820000
048300             MOVE PW-MULTIPLE-VENDORS TO ED-ERROR-MESSAGE         04830000
048400             PERFORM 7800-PRINT-ERRORS THRU 7800-EXIT             04840000
048500         ELSE                                                     04850000
048600             IF PW-PREV-VENDOR                                    04860000
048700                 MOVE PW-NO-INVC-OR-RECEIVERS TO ED-ERROR-MESSAGE 04870000
048800                 PERFORM 7800-PRINT-ERRORS THRU 7800-EXIT         04880000
048900                 MOVE '*****' TO PRINT-CART-CNT-ALPHA             04890000
049000             END-IF                                               04900000
049100         END-IF                                                   04910000
049200     END-IF.                                                      04920000
049300                                                                  04930000
049400     IF INVOICE-RECORD                                            04940000
049500         IF AP267-PO-NBR NOT EQUAL          PW-PREV-PO-NBR        04950000
049600             MOVE PW-NO-VENDOR TO ED-ERROR-MESSAGE                04960000
049700             PERFORM 7800-PRINT-ERRORS THRU 7800-EXIT             04970000
049800         END-IF                                                   04980000
049900     END-IF.                                                      04990000
050000                                                                  05000000
050100     IF RECEIVER-RECORD                                           05010000
050200         IF AP267-PO-NBR NOT EQUAL          PW-PREV-PO-NBR        05020000
050300             MOVE PW-NO-VEND-RECV TO ED-ERROR-MESSAGE             05030000
050400             PERFORM 7800-PRINT-ERRORS THRU 7800-EXIT             05040000
050500             MOVE '*****' TO PRINT-CART-CNT-ALPHA                 05050000
050600         ELSE                                                     05060000
050700             IF PW-PREV-VENDOR                                    05070000
050800                 MOVE PW-NO-INVOICE TO ED-ERROR-MESSAGE           05080000
050900                 PERFORM 7800-PRINT-ERRORS THRU 7800-EXIT         05090000
051000                 MOVE '*****' TO PRINT-CART-CNT-ALPHA             05100000
051100             END-IF                                               05110000
051200         END-IF                                                   05120000
051300     END-IF.                                                      05130000
051400                                                                  05140000
051500     IF VENDOR-RECORD                                             05150000
051600         IF NOT-FIRST-PASS                                        05160000
051700             MOVE ZERO TO CLASS-NBR-PROC                          05170000
051800                          RECV-SEQ-NBR-PROC                       05180000
051900                          INV-TBL-SUB                             05190000
052000             PERFORM 3000-CREATE-DETAIL-RPT THRU 3000-EXIT        05200000
052100         END-IF                                                   05210000
052200         SET NOT-FIRST-PASS TO TRUE                               05220000
052300         MOVE AP267-PO-NBR TO PW-SAVE-PO-NBR                      05230000
052400                                       PW-PREV-PO-NBR             05240000
052500                                       PRINT-PO-NBR               05250000
052600         MOVE AP267-RECORD-TYPE     TO PW-PREV-RECORD-TYPE        05260000
052700         MOVE AP267-VENDOR-NAME TO PW-SAVE-VENDOR-NAME            05270000
052800                                    PRINT-VENDOR-NAME             05280000
052900         MOVE AP267-VENDOR-NUMBER TO PW-SAVE-VENDOR-NUMBER        05290000
053000                                      PRINT-VENDOR-NUMBER         05300000
053100         MOVE AP267-DEPT-NUMBER TO PW-SAVE-DEPARTMENT-NUMBER      05310000
053200                                    PRINT-DEPARTMENT-NUMBER       05320000
053300         SET NEW-VENDOR TO TRUE                                   05330000
053400         MOVE ZERO TO INV-TBL-SUB                                 05340000
053500                      PW-FREIGHT-AMT-TOT                          05350000
053600                      PW-SAVE-CARTON-COUNT                        05360000
053700     ELSE                                                         05370000
053800         IF INVOICE-RECORD                                        05380000
053900             ADD 1 TO INV-TBL-SUB                                 05390000
054000             IF INV-TBL-SUB IS GREATER THAN 3000                  05400005
054100                 MOVE PW-CURRENT-PARAGRAPH  TO                    05410000
054200                      WS-ABEND-PARAGRAPH                          05420000
054300                 MOVE 'EXCEEDED INVOICE TBL LIMIT ' TO            05430000
054400                      WS-ABEND-OPERATION                          05440000
054500                 SET TABLE-ERROR TO TRUE                          05450000
054600                 PERFORM 9999-ABEND                               05460000
054700             END-IF                                               05470000
054800             MOVE AP267-RECORD-TYPE     TO PW-PREV-RECORD-TYPE    05480000
054900             MOVE AP267-INVOICE-NUMBER TO                         05490000
055000                  INVTBL-INVOICE-NUMBER (INV-TBL-SUB)             05500000
055100             MOVE AP267-INVC-MONTH TO                             05510000
055200                  INVTBL-INVC-MONTH (INV-TBL-SUB)                 05520000
055300             MOVE AP267-INVC-DAY    TO                            05530000
055400                  INVTBL-INVC-DAY (INV-TBL-SUB)                   05540000
055500             MOVE AP267-INVC-YEAR   TO                            05550000
055600                  INVTBL-INVC-YEAR (INV-TBL-SUB)                  05560000
055700             MOVE AP267-STORE-NUMBER TO                           05570000
055800                  INVTBL-STORE-NUMBER (INV-TBL-SUB)               05580000
055900             MOVE AP267-CHARGE-AMT   TO                           05590000
056000                  INVTBL-FREIGHT-AMT (INV-TBL-SUB)                05600000
056100             ADD  AP267-CHARGE-AMT   TO PW-FREIGHT-AMT-TOT        05610000
056200             MOVE AP267-DC-NBR        TO                          05620000
056300                  INVTBL-DC-NBR (INV-TBL-SUB)                     05630000
056400             MOVE AP267-MTCH-LVL-CDE  TO                          05640000
056500                  INVTBL-MTCH-LVL-CDE (INV-TBL-SUB)               05650000
056600         ELSE                                                     05660000
056700*        RECEIVER RECORD                                          05670000
056800             MOVE AP267-RECORD-TYPE     TO PW-PREV-RECORD-TYPE    05680000
056900             PERFORM 2300-ADD-RECV-TO-TBL THRU 2300-EXIT          05690000
057000             PERFORM 2500-ADD-CLASS-TO-TBL THRU 2500-EXIT         05700000
057100                     VARYING CL-IDX FROM 1 BY 1                   05710000
057200                     UNTIL CL-IDX GREATER THAN 99 OR              05720000
057300                           AP267-RECVR-CLASS (CL-IDX) EQUAL ZERO  05730000
057400         END-IF                                                   05740000
057500     END-IF.                                                      05750000
057600                                                                  05760000
057700     PERFORM 8000-READ-FREIGHT-EXT-FILE THRU 8000-EXIT.           05770000
057800                                                                  05780000
057900 2000-EXIT.                                                       05790000
058000     EXIT.                                                        05800000
058100     EJECT                                                        05810000
058200 2300-ADD-RECV-TO-TBL.                                            05820000
058300*----SEARCH TABLE TO VERIFY NOT DUPLICATE.                        05830000
058400     SET NOT-DUPLICATE-RECV                                       05840000
058500         NOT-END-OF-SEARCH  TO TRUE.                              05850000
058600     MOVE AP267-RECVR-SEQ-NO TO RECV-SEQ-NBR-TRUNC.               05860000
058700     PERFORM 2400-SEARCH-RECV-TBL THRU 2400-EXIT                  05870000
058800         VARYING SEARCH-SUB FROM 1 BY 1                           05880000
058900         UNTIL SEARCH-SUB GREATER THAN 1000 OR                    05890000
059000               END-OF-SEARCH.                                     05900000
059100                                                                  05910000
059200     IF DUPLICATE-RECV                                            05920000
059300         NEXT SENTENCE                                            05930000
059400     ELSE                                                         05940000
059500         ADD 1 TO RECV-SEQ-SUB                                    05950000
059600         IF RECV-SEQ-SUB IS GREATER THAN 3000                     05960005
059700             MOVE PW-CURRENT-PARAGRAPH  TO WS-ABEND-PARAGRAPH     05970000
059800             MOVE 'EXCEEDED RECV SEQ TBL LIMIT' TO                05980000
059900                      WS-ABEND-OPERATION                          05990000
060000             SET TABLE-ERROR TO TRUE                              06000000
060100             PERFORM 9999-ABEND                                   06010000
060200         ELSE                                                     06020000
060300           IF RECV-SEQ-NBR-1-4 = 9999                             06030000
060400               MOVE ' NR ' TO RECV-SEQ-TBL-ENTRY-R (RECV-SEQ-SUB) 06040000
060500               MOVE AP267-RECVR-CARTONS TO PW-NINREC-CARTONS      06050000
060600               SET NINREC-DATA TO TRUE                            06060000
060700           ELSE                                                   06070000
060800               MOVE RECV-SEQ-NBR-1-4 TO                           06080000
060900                            RECV-SEQ-TBL-ENTRY (RECV-SEQ-SUB)     06090000
061000               ADD AP267-RECVR-CARTONS TO PW-SAVE-CARTON-COUNT    06100000
061100               SET RECEIVER-DATA        TO TRUE.                  06110000
061200 2300-EXIT.                                                       06120000
061300     EXIT.                                                        06130000
061400     SKIP3                                                        06140000
061500 2400-SEARCH-RECV-TBL.                                            06150000
061600                                                                  06160000
061700     IF RECV-SEQ-TBL-ENTRY (SEARCH-SUB) EQUAL ZERO                06170000
061800         SET END-OF-SEARCH TO TRUE                                06180000
061900         GO TO 2400-EXIT.                                         06190000
062000                                                                  06200000
062100     IF RECV-SEQ-NBR-1-4 EQUAL RECV-SEQ-TBL-ENTRY (SEARCH-SUB)    06210000
062200         SET END-OF-SEARCH                                        06220000
062300             DUPLICATE-RECV TO TRUE.                              06230000
062400                                                                  06240000
062500 2400-EXIT.                                                       06250000
062600     EXIT.                                                        06260000
062700     EJECT                                                        06270000
062800 2500-ADD-CLASS-TO-TBL.                                           06280000
062900                                                                  06290000
063000*----SEARCH TABLE TO VERIFY NOT DUPLICATE.                        06300000
063100     SET NOT-DUPLICATE-CLASS                                      06310000
063200         NOT-END-OF-SEARCH  TO TRUE.                              06320000
063300     MOVE AP267-RECVR-CLASS (CL-IDX) TO SEARCH-CLASS.             06330000
063400     PERFORM 2600-SEARCH-CLASS-TBL THRU 2600-EXIT                 06340000
063500             VARYING SEARCH-SUB FROM 1 BY 1                       06350000
063600             UNTIL SEARCH-SUB GREATER THAN 99 OR                  06360000
063700                   END-OF-SEARCH.                                 06370000
063800                                                                  06380000
063900     IF DUPLICATE-CLASS                                           06390000
064000         NEXT SENTENCE                                            06400000
064100     ELSE                                                         06410000
064200         ADD 1 TO CLASS-NBR                                       06420000
064300         IF CLASS-NBR IS GREATER THAN 99                          06430000
064400             MOVE PW-CURRENT-PARAGRAPH  TO                        06440000
064500                  WS-ABEND-PARAGRAPH                              06450000
064600             MOVE 'EXCEEDED CLASS TBL LIMIT   ' TO                06460000
064700                  WS-ABEND-OPERATION                              06470000
064800             SET TABLE-ERROR TO TRUE                              06480000
064900             PERFORM 9999-ABEND                                   06490000
065000         END-IF                                                   06500000
065100         MOVE AP267-RECVR-CLASS (CL-IDX) TO                       06510000
065200              CLASS-TABLE-ENTRY (CLASS-NBR)                       06520000
065300     END-IF.                                                      06530000
065400                                                                  06540000
065500 2500-EXIT.                                                       06550000
065600     EXIT.                                                        06560000
065700     EJECT                                                        06570000
065800 2600-SEARCH-CLASS-TBL.                                           06580000
065900                                                                  06590000
066000     IF CLASS-TABLE-ENTRY (SEARCH-SUB) EQUAL ZERO                 06600000
066100         SET END-OF-SEARCH TO TRUE                                06610000
066200         GO TO 2600-EXIT.                                         06620000
066300                                                                  06630000
066400     IF SEARCH-CLASS EQUAL CLASS-TABLE-ENTRY (SEARCH-SUB)         06640000
066500         SET END-OF-SEARCH                                        06650000
066600             DUPLICATE-CLASS TO TRUE.                             06660000
066700                                                                  06670000
066800 2600-EXIT.                                                       06680000
066900     EXIT.                                                        06690000
067000     EJECT                                                        06700000
067100 3000-CREATE-DETAIL-RPT.                                          06710000
067200                                                                  06720000
067300*----CREATE FULL DETAIL LINE INCLUDE VENDOR DATA, PO, CART CNT ETC06730000
067400     IF PRINT-CART-CNT-ALPHA EQUAL '*****'                        06740000
067500         MOVE '***' TO PRINT-CLASS-ENTRY (1)                      06750000
067600         MOVE '****' TO PRINT-RECV-SEQ-ENTRY (1)                  06760000
067700     ELSE                                                         06770000
067800* NINREC CARTON COUNT COMES FROM THE TOTAL OF THE INVOICE CARTON  06780000
067900* COUNTS.  IF THERE ARE BOTH NINRECS AND RECEIVERS AND BOTH CARTON06790000
068000* COUNTS ARE ADDED IN, THE CARTON COUNT TOTAL COULD BE DOUBLED    06800000
068100* SINCE THE RECEIVER CARTON COUNTS COME DIRECTLY FROM THE RECEIVER06810000
068200* ONLY USE THE CARTON COUNT FOR NINREC IF THERE ARE NO OTHER      06820000
068300* RECEIVERS.                                                      06830000
068400         IF NINREC-DATA AND NO-RECEIVER-DATA                      06840000
068500             MOVE PW-NINREC-CARTONS    TO PRINT-CARTON-COUNT      06850000
068600         ELSE                                                     06860000
068700             MOVE PW-SAVE-CARTON-COUNT TO PRINT-CARTON-COUNT      06870000
068800         END-IF                                                   06880000
068900     END-IF.                                                      06890000
069000                                                                  06900000
069100     PERFORM 3100-RPT-REST-OF-RECV THRU 3100-EXIT                 06910000
069200             UNTIL ALL-CLASS-TBL-PROC                             06920000
069300               AND ALL-RECVR-TBL-PROC                             06930000
069400               AND ALL-INVC-TBL-PROC.                             06940000
069500                                                                  06950000
069600     PERFORM 7200-PRINT-TOTAL-LINE THRU 7200-EXIT.                06960000
069700                                                                  06970000
069800     INITIALIZE INVOICE-TABLE                                     06980000
069900                CLASS-TABLE                                       06990000
070000                RECV-SEQ-TABLE.                                   07000000
070100     MOVE ZERO TO NBR-ENTRY-MOVES                                 07010000
070200                  CLASS-NBR-PROC                                  07020000
070300                  RECV-SEQ-NBR-PROC                               07030000
070400                  CLASS-NBR                                       07040000
070500                  RECV-SEQ-SUB.                                   07050000
070600     SET NO-RECEIVER-DATA                                         07060000
070700         NO-NINREC-DATA                                           07070000
070800         CLASS-TBL-NOT-PROC                                       07080000
070900         RECVR-TBL-NOT-PROC                                       07090000
071000         INVC-TBL-NOT-PROC  TO TRUE.                              07100000
071100                                                                  07110000
071200 3000-EXIT.                                                       07120000
071300     EXIT.                                                        07130000
071400     EJECT                                                        07140000
071500 3100-RPT-REST-OF-RECV.                                           07150000
071600                                                                  07160000
071700     IF ALL-CLASS-TBL-PROC                                        07170000
071800        AND ALL-RECVR-TBL-PROC                                    07180000
071900        AND ALL-INVC-TBL-PROC                                     07190000
072000         GO TO 3100-EXIT.                                         07200000
072100                                                                  07210000
072200     IF ALL-INVC-TBL-PROC                                         07220000
072300         NEXT SENTENCE                                            07230000
072400     ELSE                                                         07240000
072500         ADD 1 TO INV-TBL-SUB.                                    07250000
072600     IF INVTBL-INVOICE-NUMBER (INV-TBL-SUB) EQUAL ZERO            07260000
072700        OR INVTBL-INVOICE-NUMBER (INV-TBL-SUB) EQUAL SPACES       07270000
072800         SET ALL-INVC-TBL-PROC TO TRUE                            07280000
072900     ELSE                                                         07290000
073000         MOVE INVTBL-INVOICE-NUMBER (INV-TBL-SUB) TO              07300000
073100              PRINT-INVOICE-NUMBER                                07310000
073200         MOVE INVTBL-INVC-MONTH (INV-TBL-SUB) TO                  07320000
073300              PRINT-INVC-DTE-MM                                   07330000
073400         MOVE INVTBL-INVC-DAY (INV-TBL-SUB) TO                    07340000
073500              PRINT-INVC-DTE-DD                                   07350000
073600         MOVE INVTBL-INVC-YEAR (INV-TBL-SUB) TO                   07360000
073700              PRINT-INVC-DTE-YY                                   07370000
073800         MOVE '-' TO PRINT-DASH1                                  07380000
073900         MOVE '-' TO PRINT-DASH2                                  07390000
074000         MOVE INVTBL-STORE-NUMBER (INV-TBL-SUB) TO                07400000
074100             PRINT-STORE-NUMBER                                   07410000
074200         MOVE INVTBL-FREIGHT-AMT (INV-TBL-SUB) TO                 07420000
074300              PRINT-FREIGHT-AMT                                   07430000
074310         MOVE INVTBL-DC-NBR (INV-TBL-SUB) TO                      07431000
074320              PRINT-DC-NBR                                        07432000
074330         MOVE INVTBL-MTCH-LVL-CDE (INV-TBL-SUB) TO                07433000
074340              PRINT-MTCH-LVL-CDE                                  07434000
074350     END-IF.                                                      07435000
074360                                                                  07436000
074370     IF ALL-CLASS-TBL-PROC                                        07437000
074380        AND ALL-RECVR-TBL-PROC                                    07438000
074390        AND ALL-INVC-TBL-PROC                                     07439000
074400         GO TO 3100-EXIT.                                         07440000
074500                                                                  07450000
074600     MOVE ZERO TO NBR-ENTRY-MOVES.                                07460000
074700     PERFORM 3200-MOVE-ANY-CLASS-RECV-DATA THRU 3200-EXIT         07470000
074800             UNTIL NBR-ENTRY-MOVES EQUAL 3.                       07480000
074900     PERFORM 7100-PRINT-DETAIL-LINE THRU 7100-EXIT.               07490000
075000                                                                  07500000
075100 3100-EXIT.                                                       07510000
075200     EXIT.                                                        07520000
075300     EJECT                                                        07530000
075400 3200-MOVE-ANY-CLASS-RECV-DATA.                                   07540000
075500                                                                  07550000
075600     ADD 1 TO NBR-ENTRY-MOVES.                                    07560000
075700     IF ALL-CLASS-TBL-PROC                                        07570000
075800         NEXT SENTENCE                                            07580000
075900     ELSE                                                         07590000
076000         ADD 1 TO CLASS-NBR-PROC.                                 07600000
076100     IF ALL-RECVR-TBL-PROC                                        07610000
076200         NEXT SENTENCE                                            07620000
076300     ELSE                                                         07630000
076400         ADD 1 TO RECV-SEQ-NBR-PROC.                              07640000
076500                                                                  07650000
076600     IF PRINT-CLASS-ENTRY (NBR-ENTRY-MOVES) EQUAL '***'           07660000
076700         NEXT SENTENCE                                            07670000
076800     ELSE                                                         07680000
076900     IF ALL-CLASS-TBL-PROC                                        07690000
077000         MOVE SPACES TO PRINT-CLASS-ENTRY (NBR-ENTRY-MOVES)       07700000
077100     ELSE                                                         07710000
077200         IF CLASS-TABLE-ENTRY (CLASS-NBR-PROC) EQUAL ZERO OR      07720000
077300            CLASS-TABLE-ENTRY (CLASS-NBR-PROC) NOT NUMERIC        07730000
077400             MOVE SPACES TO PRINT-CLASS-ENTRY (NBR-ENTRY-MOVES)   07740000
077500         ELSE                                                     07750000
077600             MOVE CLASS-TABLE-ENTRY (CLASS-NBR-PROC) TO           07760000
077700                  PRINT-CLASS-ENTRY (NBR-ENTRY-MOVES).            07770000
077800     IF CLASS-NBR-PROC >= CLASS-NBR                               07780000
077900         SET ALL-CLASS-TBL-PROC TO TRUE.                          07790000
078000                                                                  07800000
078100     IF PRINT-RECV-SEQ-ENTRY (NBR-ENTRY-MOVES) EQUAL '****'       07810000
078200         NEXT SENTENCE                                            07820000
078300     ELSE                                                         07830000
078400     IF ALL-RECVR-TBL-PROC                                        07840000
078500         MOVE SPACES TO PRINT-RECV-SEQ-ENTRY (NBR-ENTRY-MOVES)    07850000
078600     ELSE                                                         07860000
078700     IF RECV-SEQ-TBL-ENTRY-R (RECV-SEQ-NBR-PROC) EQUAL ' NR '     07870000
078800         MOVE RECV-SEQ-TBL-ENTRY-R (RECV-SEQ-NBR-PROC) TO         07880000
078900              PRINT-RECV-SEQ-ENTRY (NBR-ENTRY-MOVES)              07890000
079000     ELSE                                                         07900000
079100     IF RECV-SEQ-TBL-ENTRY (RECV-SEQ-NBR-PROC) EQUAL ZERO OR      07910000
079200        RECV-SEQ-TBL-ENTRY (RECV-SEQ-NBR-PROC) NOT NUMERIC        07920000
079300         MOVE SPACES TO PRINT-RECV-SEQ-ENTRY (NBR-ENTRY-MOVES)    07930000
079400     ELSE                                                         07940000
079500         MOVE RECV-SEQ-TBL-ENTRY (RECV-SEQ-NBR-PROC) TO           07950000
079600              PRINT-RECV-SEQ-ENTRY (NBR-ENTRY-MOVES).             07960000
079700     IF RECV-SEQ-NBR-PROC >= RECV-SEQ-SUB                         07970000
079800         SET ALL-RECVR-TBL-PROC TO TRUE.                          07980000
079900                                                                  07990000
080000 3200-EXIT.                                                       08000000
080100     EXIT.                                                        08010000
080200     EJECT                                                        08020000
080300 7000-NEW-PAGE-PROCESSING.                                        08030000
080400     MOVE '7000-NEW-PAGE-PROCESSING     ' TO PW-CURRENT-PARAGRAPH.08040000
080500*                                                                 08050000
080600     ADD 1                            TO PW-PAGE-COUNT.           08060000
080700     MOVE PW-PAGE-COUNT               TO DP150O-PAGE-NUMBER.      08070000
080800     MOVE 1 TO DP150O-REPORT-NUMBER                               08080000
080900     WRITE PRINT-RECORD                                           08090000
081000           FROM  DP150O-STANDRD-HEADER-150-COLS                   08100000
081100           AFTER ADVANCING PAGE.                                  08110000
081200     WRITE PRINT-RECORD                                           08120000
081300           FROM HDR-LINE-2                                        08130000
081400           AFTER ADVANCING 2 LINE.                                08140000
081500     WRITE PRINT-RECORD                                           08150000
081600           FROM RPT-LINE-1                                        08160000
081700           AFTER ADVANCING 2 LINES.                               08170000
081800     WRITE PRINT-RECORD                                           08180000
081900           FROM RPT-LINE-2                                        08190000
082000           AFTER ADVANCING 1 LINES.                               08200000
082100     INITIALIZE PRINT-RECORD.                                     08210000
082200     MOVE 7                           TO PW-LINE-COUNT.           08220000
082300*                                                                 08230000
082400 7000-EXIT.                                                       08240000
082500     EXIT.                                                        08250000
082600     EJECT                                                        08260000
082700 7100-PRINT-DETAIL-LINE.                                          08270000
082800     MOVE '7100-PRINT-DETAIL-LINE       ' TO PW-CURRENT-PARAGRAPH.08280000
082900*                                                                 08290000
083000     ADD 2                            TO PW-LINE-COUNT.           08300000
083100     IF PW-LINE-COUNT >= PW-MAX-LINES                             08310000
083200         PERFORM 7300-PRINT-MANUAL-NOTE THRU 7300-EXIT            08320000
083300         PERFORM 7000-NEW-PAGE-PROCESSING THRU 7000-EXIT          08330000
083400         ADD 2                        TO PW-LINE-COUNT            08340000
083500     END-IF.                                                      08350000
083600                                                                  08360000
083700     MOVE PRINT-LINE                  TO PRINT-RECORD.            08370000
083800     IF INV-TBL-SUB EQUAL 1                                       08380000
083900         WRITE PRINT-RECORD AFTER ADVANCING 2 LINE                08390000
084000     ELSE                                                         08400000
084100         WRITE PRINT-RECORD AFTER ADVANCING 1 LINE.               08410000
084200     INITIALIZE PRINT-LINE.                                       08420000
084300 7100-EXIT.                                                       08430000
084400     EXIT.                                                        08440000
084500     EJECT                                                        08450000
084600 7200-PRINT-TOTAL-LINE.                                           08460000
084700     MOVE '7200-PRINT-TOTAL-LINE        ' TO PW-CURRENT-PARAGRAPH.08470000
084800*                                                                 08480000
084900     ADD 2                            TO PW-LINE-COUNT.           08490000
085000     IF PW-LINE-COUNT >= PW-MAX-LINES                             08500000
085100         PERFORM 7300-PRINT-MANUAL-NOTE THRU 7300-EXIT            08510000
085200         PERFORM 7000-NEW-PAGE-PROCESSING THRU 7000-EXIT          08520000
085300     END-IF.                                                      08530000
085400                                                                  08540000
085500     MOVE PW-FREIGHT-AMT-TOT  TO  TOTAL-FREIGHT-AMT.              08550000
085600     MOVE TOTAL-LINE      TO PRINT-RECORD.                        08560000
085700     WRITE PRINT-RECORD AFTER ADVANCING 2 LINES.                  08570000
085800     INITIALIZE PW-FREIGHT-AMT-TOT.                               08580000
085900*                                                                 08590000
086000 7200-EXIT.                                                       08600000
086100     EXIT.                                                        08610000
086200     EJECT                                                        08620000
086300 7300-PRINT-MANUAL-NOTE.                                          08630000
086400     MOVE '7300-PRINT-MANUAL-NOTE       ' TO PW-CURRENT-PARAGRAPH.08640000
086500*                                                                 08650000
086600     MOVE MANUAL-NOTE                 TO PRINT-RECORD.            08660000
086700     COMPUTE PW-ADVANCE-COUNT = PW-MAX-LINES - PW-LINE-COUNT.     08670000
086800     WRITE PRINT-RECORD AFTER ADVANCING PW-ADVANCE-COUNT LINES.   08680000
086900 7300-EXIT.                                                       08690000
087000     EXIT.                                                        08700000
087100     EJECT                                                        08710000
087200 7800-PRINT-ERRORS.                                               08720000
087300                                                                  08730000
087400     MOVE '7800-PRINT-ERRORS' TO PW-CURRENT-PARAGRAPH.            08740000
087500                                                                  08750000
087600     ADD 1  TO PW-ERROR-LINE-COUNT.                               08760000
087700     IF PW-ERROR-LINE-COUNT >= PW-MAX-LINES                       08770000
087800         PERFORM 7820-PRINT-ERROR-HEADERS THRU 7820-EXIT          08780000
087900         ADD 1  TO PW-ERROR-LINE-COUNT                            08790000
088000     END-IF.                                                      08800000
088100                                                                  08810000
088200     MOVE PW-SAVE-PO-NBR TO ED-PO-NBR.                            08820000
088300     MOVE PW-SAVE-VENDOR-NAME    TO ED-VENDOR-NAME.               08830000
088400     MOVE PW-SAVE-VENDOR-NUMBER  TO ED-VENDOR-NUMBER.             08840000
088500     MOVE PW-SAVE-INVOICE-NUMBER TO ED-INVOICE-NUMBER.            08850000
088600     MOVE INVTBL-INVOICE-NUMBER (INV-TBL-SUB) TO                  08860000
088700          ED-INVOICE-NUMBER.                                      08870000
088800                                                                  08880000
088900     WRITE ERROR-REC FROM ED-ERROR-DETAIL AFTER 1.                08890000
089000                                                                  08900000
089100     INITIALIZE ERROR-REC.                                        08910000
089200     ADD 1  TO PW-ERROR-COUNT.                                    08920000
089300 7800-EXIT.                                                       08930000
089400     EXIT.                                                        08940000
089500     EJECT                                                        08950000
089600 7810-PRINT-END-ERROR.                                            08960000
089700                                                                  08970000
089800     MOVE '7810-PRINT-END-ERROR' TO PW-CURRENT-PARAGRAPH.         08980000
089900                                                                  08990000
090000     ADD 2  TO PW-ERROR-LINE-COUNT.                               09000000
090100     IF PW-ERROR-LINE-COUNT >= PW-MAX-LINES                       09010000
090200         PERFORM 7820-PRINT-ERROR-HEADERS THRU 7820-EXIT          09020000
090300     END-IF.                                                      09030000
090400                                                                  09040000
090500     WRITE ERROR-REC FROM EOR-END-OF-REPORT AFTER 2.              09050000
090600 7810-EXIT.                                                       09060000
090700     EXIT.                                                        09070000
090800     EJECT                                                        09080000
090900 7820-PRINT-ERROR-HEADERS.                                        09090000
091000                                                                  09100000
091100     MOVE '7820-PRINT-ERROR-HEADERS'  TO PW-CURRENT-PARAGRAPH.    09110000
091200                                                                  09120000
091300     ADD 1                            TO PW-ERROR-PAGE-COUNT.     09130000
091400     MOVE PW-ERROR-PAGE-COUNT         TO DP150O-PAGE-NUMBER.      09140000
091500     MOVE DP150O-REPORT-NUMBER        TO PW-SAVE-REPORT-NUMBER.   09150000
091600     MOVE 2                           TO DP150O-REPORT-NUMBER.    09160000
091700                                                                  09170000
091800     WRITE ERROR-REC                                              09180000
091900           FROM DP150O-STANDRD-HEADER-150-COLS AFTER PAGE.        09190000
092000     WRITE ERROR-REC FROM HDR-LINE-2 AFTER 1.                     09200000
092100     WRITE ERROR-REC FROM H3-HEADER3 AFTER 1.                     09210000
092200     WRITE ERROR-REC FROM EH-ERROR-HEADER AFTER 2.                09220000
092300                                                                  09230000
092400     MOVE PW-SAVE-REPORT-NUMBER TO DP150O-REPORT-NUMBER.          09240000
092500     INITIALIZE ERROR-REC.                                        09250000
092600     WRITE ERROR-REC AFTER 1.                                     09260000
092700                                                                  09270000
092800     MOVE 6                           TO PW-ERROR-LINE-COUNT.     09280000
092900 7820-EXIT.                                                       09290000
093000     EXIT.                                                        09300000
093100     EJECT                                                        09310000
093200 8000-READ-FREIGHT-EXT-FILE.                                      09320000
093300     MOVE '8000-READ-FREIGHT-EXT-FILE   ' TO PW-CURRENT-PARAGRAPH 09330000
093400*                                                                 09340000
093500     READ FREIGHT-EXT-FILE                                        09350000
093600          INTO AP267-INPUT-RECORD                                 09360000
093700          AT END SET END-OF-PROCESSING TO TRUE.                   09370000
093800     IF NOT END-OF-PROCESSING                                     09380000
093900         ADD 1 TO PW-INPUT-COUNT.                                 09390000
094000*                                                                 09400000
094100 8000-EXIT.                                                       09410000
094200     EXIT.                                                        09420000
094300     EJECT                                                        09430000
094400 9900-END-OF-INPUT.                                               09440000
094500     MOVE '9900-END-OF-INPUT            ' TO PW-CURRENT-PARAGRAPH.09450000
094600                                                                  09460000
094700*----WRITE DETAIL RECORDS FOR LAST PURCHASE ORDER. INCLUDING ALL  09470000
094800*----VENDOR/INVOICE/RECEIVER DATA                                 09480000
094900     IF NO-RECEIVER-DATA                                          09490000
095000         MOVE '*****' TO PRINT-CART-CNT-ALPHA.                    09500000
095100                                                                  09510000
095200     MOVE ZERO TO CLASS-NBR-PROC                                  09520000
095300                  RECV-SEQ-NBR-PROC.                              09530000
095400         MOVE ZERO TO INV-TBL-SUB.                                09540000
095500     PERFORM 3000-CREATE-DETAIL-RPT THRU 3000-EXIT.               09550000
095600                                                                  09560000
095700     COMPUTE PW-ERROR-THRESH ROUNDED =                            09570000
095800         PW-INPUT-COUNT * PW-ERROR-PERCENT.                       09580000
095900******************************************************************09590000
096000     DISPLAY '** APKRP267 SUMMARY **'.                            09600000
096100     MOVE PW-INPUT-COUNT TO PW-DISPLAY-COUNT.                     09610000
096200     DISPLAY '** INPUT COUNT - ' PW-DISPLAY-COUNT.                09620000
096300     MOVE PW-ERROR-COUNT TO PW-DISPLAY-COUNT.                     09630000
096400     DISPLAY '** ERROR COUNT - ' PW-DISPLAY-COUNT.                09640000
096500     MOVE PW-ERROR-THRESH TO PW-DISPLAY-COUNT.                    09650000
096600     DISPLAY '** THRSH COUNT - ' PW-DISPLAY-COUNT.                09660000
096700                                                                  09670000
096800     PERFORM 7810-PRINT-END-ERROR THRU 7810-EXIT.                 09680000
096900     PERFORM 7300-PRINT-MANUAL-NOTE THRU 7300-EXIT.               09690000
097000                                                                  09700000
097100     CLOSE FREIGHT-EXT-FILE                                       09710000
097200           PRINT-FILE                                             09720000
097300           ERROR-FILE.                                            09730000
097400 9900-EXIT.                                                       09740000
097500     EXIT.                                                        09750000
097600                                                                  09760000
097700***************************************************************** 09770000
097800*    ABEND ROUTINE                                               *09780000
097900***************************************************************** 09790000
098000 9999-ABEND.                                                      09800000
098100                                                                  09810000
098200     MOVE '9999-ABEND' TO PW-CURRENT-PARAGRAPH.                   09820000
098300                                                                  09830000
098400     DISPLAY '*** PROGRAM   = ' WS-ABEND-PROGRAM.                 09840000
098500     DISPLAY '*** PARAGRAPH = ' WS-ABEND-PARAGRAPH.               09850000
098600     DISPLAY '*** OPERATION = ' WS-ABEND-OPERATION.               09860000
098700     CALL 'ILBOABN0' USING WS-ABEND-CODE.                         09870000
098800                                                                  09880000
