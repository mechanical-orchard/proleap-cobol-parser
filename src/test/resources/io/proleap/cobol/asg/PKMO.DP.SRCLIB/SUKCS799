000801*--CHANGE TO ADD RFID CHECKS FOR DIRECTIVES---------------------* 00001000
000100*-----------------------*                                         00002000
000200 IDENTIFICATION DIVISION.                                         00003000
000300*-----------------------*                                         00004000
000400 PROGRAM-ID.    SUKCS799.                                         00005000
000500 AUTHOR.        OMAN.                                             00006000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00007000
000700 DATE-WRITTEN.  OCTOBER 2008.                                     00008000
000800 DATE-COMPILED.                                                   00009000
000900                                                                  00010000
001000*---------------------------------------------------------------* 00020000
001010*  18574 IR    DAVID MEDICI. FORMAT PO-RCVR ON SCREEN AS        * 00030000
001020*              8-DIGIT PO, 3-DIGIT RCVR SEPARATED BY HYPHEN.    * 00040000
001030*                                                               * 00050000
001100*  12/30 OMAN                                                   * 00060000
001101*  17860 IR   AUTOMATICALLY REFRESH SCREEN AFTER RELEASE.       * 00070000
001102*             WAS WORKING FOR SCREENS FOR MULTIPLE LINE BUT     * 00080000
001103*             NOT FOR THOSE WITH A SINGLE LINE.  NEED TO SEND   * 00090000
001104*             APPROPRIATE DP030-SEND-DATAONLY SWITCH.           * 00100000
001105*                                                               * 00110000
001106*                                                               * 00110100
001107*  12/29 OMAN                                                   * 00110200
001108*  17860 IR   AUTOMATICALLY REFRESH SCREEN AFTER RELEASE.       * 00110300
001109*                                                               * 00110400
001110*  17886 IR   DIRECTIVE CARTON COUNT SHOULD BE REFRESHED ON F5. * 00110500
001111*                                                               * 00110600
001112*  17888 IR   RE-RELEASE WILL NOT BE ABLE OR OCCUR AS AUTO      * 00110700
001113*             REFRESH WILL NO LONGER SHOW LINE RELEASED.        * 00110800
001114*                                                               * 00110900
001115*  12/29 OMAN CHANGED 7200- FUNCTION TEMPORARILY SO MIKE W.     * 00111000
001116*             COULD CONTINUE TO TEST.                           * 00111100
001117*                                                               * 00111200
001118*  12/26 OMAN ADDED NULL INDICATORS FOR NULLABLE FIELDS.        * 00111300
001119*                                                               * 00111400
001120*  12/26 OMAN   CHANGE RACF FUNCTION IN 7200- PARA TO SUDIRRLS  * 00111500
001121*               TALK TO CATHY FAIRWEATHER.                      * 00111600
001122*                                                               * 00111700
001123*  01/28/09 CHRISTINE TWIEHAUS IR 12,061                          00111800
001124*           DESCRIPTION 1) STOP ERRONEOUS ERROR 3644/3064         00111900
001125*           CHANGED ASC- FIELDS (IN LIST AREA) TO MATCH MR/MAP  * 00112000
001126*           DESCRIPTION 3) CHANGE CURSORS AND DO SEPERATE         00112100
001127*           SELECTS ON FILEDS NOT ON SCREEN BUT NEEDED IN DG      00112200
001128*           4) CHANGE MSG 3064 TO 3644                            00112300
001129*                                                               * 00112400
001130*  02/02/09 CHRISTINE TWIEHAUS IR 12,319                          00112500
001131*           UPDATE SUT_PO_AUD_REQ BY AUD CNTRL NUMBER AFTER       00112600
001132*           SUCCESSFUL CALL TO SUKUT129 (DG)                      00112700
001133*                                                               * 00112800
001134*  02/02/09 CHRISTINE TWIEHAUS IR 12,315                          00112900
001135*           GET RID OF GREEN LINES ON BLANK LINES WHEN F15        00113000
001136*                                                               * 00113100
001137*  02/02/09 CHRISTINE TWIEHAUS IR 12,412                          00113200
001138*           CORRECTED LOOK UP OF LINE NBR ON TRECEIV              00113300
001139*                                                               * 00113400
000815* 12/13 RLK    ADDED LOGIC TO SET DIRECTIVES WHEN FAILED OR     * 00113500
000819*              PENDING RFID AUDIT.                              * 00113600
001139*                                                               * 00113700
000815* 09/14 CLP    CHANGED ASC PO# FROM 7 DIGITS TO 8 DIGITS          00113800
001140*---------------------------------------------------------------* 00113900
263968* CHANGED 11/15/2021    BY JIM HUNTER      WR: CHG0263968         00114101
263968* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00114201
263968* MAKING THE CALL DYNAMIC VS STATIC.                              00114301
001130*                                                                 00114402
001110* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00114502
001120* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00114602
263968*---------------------------------------------------------------* 00114701
001141                                                                  00114800
001142*---------------------------------------------------------------* 00114900
001143*    S799 - DIRECTIVE RELEASE BY RECEIVER                       * 00115000
001144*---------------------------------------------------------------* 00115100
001145 ENVIRONMENT DIVISION.                                            00115200
001146 DATA DIVISION.                                                   00115300
001147                                                                  00115400
001148 WORKING-STORAGE SECTION.                                         00115500
001149                                                                  00115600
001150 01  DK-DB2-KEYS.                                                 00115700
001151     05  DK-OPER-UNT-ID            PIC S9(04) COMP VALUE +0.      00115800
001152     05  DK-TRIP-ID                PIC S9(09) COMP VALUE +0.      00115900
001153     05  DK-PO-NBR                 PIC S9(09) COMP VALUE +0.      00116000
001154     05  DK-RCVR-SEQ-NBR           PIC S9(09) COMP VALUE +0.      00116100
001155     05  DK-REC-SEQ-NBR            PIC S9(09) COMP VALUE +0.      00116200
001156     05  DK-PO-LNE-NBR             PIC S9(09) COMP VALUE +0.      00116300
001157     05  DK-PREPK-ID               PIC S9(04) COMP VALUE +0.      00116400
001158     05  DK-AUD-CNTL-NBR           PIC S9(09) COMP VALUE +0.      00116500
001159     05  DK-BRCDE-NBR              PIC X(22)      VALUE SPACES.   00116600
001160     05  DK-STATUS-DATE            PIC X(10)      VALUE SPACES.   00116700
001161     05  DK-STATUS-TIME            PIC X(08)      VALUE SPACES.   00116800
001162     05  DK-CRE-TMST               PIC X(26)      VALUE SPACES.   00116900
001163     05  DK-RLSD-CRTN-NOT-RCVD     PIC X(01)      VALUE SPACES.   00117000
001164                                                                  00117100
001165 01  DN-DB2-NULL-INDICATORS.                                      00117200
001166     05  DN-VEH-NBR                PIC S9(04) COMP VALUE +0.      00117300
001167     05  DN-STR-ZN-ID              PIC S9(04) COMP VALUE +0.      00117400
001168     05  DN-AUD-FALR-RSN-NM        PIC S9(04) COMP VALUE +0.      00117500
001169     05  DN-SEASET-YR              PIC S9(04) COMP VALUE +0.      00117600
001170     05  DN-SEASET-SHRT-NM         PIC S9(04) COMP VALUE +0.      00117700
001180     05  DN-CASI-CDE               PIC S9(04) COMP VALUE +0.      00117800
001190                                                                  00117900
001200 01  PC-PROGRAM-CONSTANTS.                                        00118000
001300     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'SUK799  '.  00118100
001400     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'SUKM799 '.  00118200
001500     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'SUKCS799'.  00118300
001600     05  PC-APPL-MAP               PIC S9(04)  VALUE  +1          00118400
001700                                                     COMP.        00118500
001800     05  PC-LIST-QUEUE-SEQ         PIC  9(01)  VALUE 1.           00118600
001900     05  PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE 2.           00118700
002000     05  PC-CRIT-SPEC-FORMAT       PIC  X(01)  VALUE '1'.         00118800
002100     05  PC-DETAIL-SCREEN          PIC  X(01)  VALUE '2'.         00119000
002200     05  PC-ITEMS-PER-PANEL        PIC S9(04)  VALUE +08          00120000
002300                                               COMP SYNC.         00130000
002400     05  PC-MAX-BLOCKS-IN-ARRAY    PIC S9(04)  VALUE +2           00140000
002500                                               COMP SYNC.         00150000
002600     05  PC-MAX-ITEMS              PIC S9(09)  VALUE +1000000     00160000
002700                                               COMP-3.            00170000
002800     05  PC-MSG-NUMBER-LENGTH      PIC S9(04)  VALUE +5           00180000
002900                                               COMP SYNC.         00190000
003000     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            00200000
003100                                               COMP-3.            00210000
003200     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       00220000
003300     05  PC-ADD                    PIC  X(03)  VALUE 'ADD'.       00230000
003400     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       00240000
003500     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       00250000
003600     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       00260000
003700     05  PC-DOOR                   PIC  X(04)  VALUE 'DOOR'.      00270000
003800     05  PC-STORE                  PIC  X(05)  VALUE 'STORE'.     00280000
003900     05  PC-01                     PIC  X(02)  VALUE '01'.        00290000
004000     05  PC-A                      PIC  X(01)  VALUE 'A'.         00300000
004100     05  PC-D                      PIC  X(01)  VALUE 'D'.         00310000
004200     05  PC-S                      PIC  X(01)  VALUE 'S'.         00320000
004300     05  PC-U                      PIC  X(01)  VALUE 'U'.         00330000
004400     05  PC-Y                      PIC  X(01)  VALUE 'Y'.         00340000
004500     05  PC-N                      PIC  X(01)  VALUE 'N'.         00350000
004600     05  PC-RLO                    PIC  X(03)  VALUE 'RLO'.       00360000
004700     05  PC-MULTI                  PIC  X(05)  VALUE 'MULTI'.     00370000
004800     05  PC-CAROUSEL               PIC  X(08)  VALUE 'CAROUSEL'.  00380000
004900     05  PC-DEFAULT-TIMESTAMP     PIC  X(26)                      00390000
005000                          VALUE  '9999-09-09-09.09.09.999999'.    00400000
005100                                                                  00410000
005200**   FOLLOWING ARE PACK TYPE DESCRIPTIONS                         00420000
005300**                                                                00430000
005400     05  PC-MULTIPLE-SKU-PPK       PIC  X(20)  VALUE              00440000
005500         'M-MULTI SKU PREPACK '.                                  00450000
005600     05  PC-SINGLE-SKU-PPK         PIC  X(20)  VALUE              00460000
005700         'S-SINGLE SKU PREPACK'.                                  00470000
005800     05  PC-INNER-PPK              PIC  X(20)  VALUE              00480000
005900         'I-INNER PREPACK     '.                                  00490000
006000     05  PC-BULK-PPK               PIC  X(20)  VALUE              00500000
006100         'B-BULK PACK         '.                                  00510000
006200     05  PC-CASEPACK               PIC  X(20)  VALUE              00520000
006300         'C-CASEPACK          '.                                  00530000
006400     05  PC-PACK-BY-STORE          PIC  X(20)  VALUE              00540000
006500         'PACK BY STORE       '.                                  00550000
006600     05  PC-OTHER                  PIC  X(20)  VALUE              00560000
006700         'OTHER - ?????       '.                                  00570000
006800                                                                  00580000
006900*----------------------------------------------------------------*00590000
007000*  SYSTEM MESSAGES                                               *00600000
007100*----------------------------------------------------------------*00610000
007200*   00004 = PRESS F2 TO CONFIRM REQUEST                          *00620000
007300*   00005 = INVALID VALUE                                        *00630000
007400*   00008 = MUST BE NUMERIC                                      *00640000
007500*   00045 - INVALID FUNCTION KEY                                 *00650000
007510*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *00660000
007600*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *00670000
007700*   00052 - END OF RANGE PRECEDES START OF RANGE                 *00680000
007800*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *00690000
007900*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *00700000
008000*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *00710000
008100*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *00720000
008200*   00069 - TOP OF LIST                                          *00730000
008300*   00070 - BOTTOM OF LIST                                       *00740000
008400*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *00750000
008500*   00279 - MORE ITEMS TO DISPLAY                                *00760000
008600*   02571 - UNABLE TO UPD - CURRENT OPER UNT AND OPER UNIT ID ENTE00770000
008700*   02575 - STORE ASSIGNMNT FUNCTION ONLY VALID FOR DOOR TYPES SHI00780000
008800*   03645 - UNABLE TO RELEASE DIRECTIVES FOR ANOTHER DC          *00790000
008900*   03646 - YOU DO NOT HAVE AUTHORITY TO RELEASE DIRECTIVES.     *00800000
009000*   03657 - DIRECTIVES HAVE BEEN RELEASED                        *00810000
009100*   03644 - CARTONS NOT RECEIVED INDICATOR REQUIRED FOR         (*00820000
009200*           RELEASE (Y/N)                                        *00830000
009300*----------------------------------------------------------------*00840000
009400     05  PC-TSYMSG-NUMBERS.                                       00850000
009500         10  PC-TSYMSG-00004            PIC  9(05)  VALUE 00004.  00860000
009600         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  00870000
009700         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  00880000
009800         10  PC-TSYMSG-00045            PIC  9(05)  VALUE 00045.  00890000
009900         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  00900000
010000         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  00910000
010100         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  00920000
010200         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  00930000
010300         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  00940000
010400         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  00950000
010500         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  00960000
010600         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  00970000
010700         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  00980000
010800         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  00990000
010900         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01000000
011000         10  PC-TSYMSG-02571            PIC  9(05)  VALUE 02571.  01010000
011100         10  PC-TSYMSG-02575            PIC  9(05)  VALUE 02575.  01020000
011200         10  PC-TSYMSG-03064            PIC  9(05)  VALUE 03064.  01030000
011300         10  PC-TSYMSG-03628            PIC  9(05)  VALUE 03628.  01040000
011400         10  PC-TSYMSG-03640            PIC  9(05)  VALUE 03640.  01050000
011500         10  PC-TSYMSG-03641            PIC  9(05)  VALUE 03641.  01060000
011600         10  PC-TSYMSG-03642            PIC  9(05)  VALUE 03642.  01070000
011700         10  PC-TSYMSG-03643            PIC  9(05)  VALUE 03643.  01080000
011800         10  PC-TSYMSG-03644            PIC  9(05)  VALUE 03644.  01090000
011900         10  PC-TSYMSG-03645            PIC  9(05)  VALUE 03645.  01100000
012000         10  PC-TSYMSG-03646            PIC  9(05)  VALUE 03646.  01110000
012100         10  PC-TSYMSG-03657            PIC  9(05)  VALUE 03657.  01120000
012110         10  PC-TSYMSG-03660            PIC  9(05)  VALUE 03660.  01130000
012200*                                                                 01140000
012300 01  PS-PROGRAM-SWITCHES.                                         01150000
012400     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01160000
012500         88  PS-NO-ERROR                            VALUE 'Y'.    01170000
012600         88  PS-ERROR                               VALUE 'N'.    01180000
012700     05  PS-RELEASE-SW                  PIC  X(01)  VALUE 'Y'.    01190000
012800         88  PS-RELEASE-ALLOWED                     VALUE 'Y'.    01200000
012900         88  PS-RELEASE-NOT-ALLOWED                 VALUE 'N'.    01210000
013000     05  PS-BLOCK-ERROR-SW              PIC  X(01)  VALUE 'Y'.    01220000
013100         88  PS-NO-BLOCK-ERROR                      VALUE 'Y'.    01230000
013200         88  PS-BLOCK-ERROR                         VALUE 'N'.    01240000
013300     05  PS-CONFIRM-PROCESSING-IND      PIC  X(01)  VALUE  'N'.   01250000
013400         88  PS-CONFIRM-PROCESSING                  VALUE  'Y'.   01260000
013500         88  PS-NOT-CONFIRM-PROCESSING              VALUE  'N'.   01270000
013600     05  PS-SOFT-ABORT-ERROR-SW         PIC  X(01)  VALUE 'N'.    01280000
013700         88  PS-SOFT-ABORT-ERROR                    VALUE 'Y'.    01290000
013800         88  PS-NO-SOFT-ABORT-ERROR                 VALUE 'N'.    01300000
013900     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01310000
014000         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01320000
014100         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01330000
014200     05  PS-LIST-END-SW                 PIC  X(01)  VALUE 'N'.    01340000
014300         88  PS-LIST-END                            VALUE 'Y'.    01350000
014400         88  PS-NO-LIST-END                         VALUE 'N'.    01360000
      * 12/13 RLK BEG                                                   01370000
016400     05  PS-RFID-AUDIT-NO-FAIL-SW       PIC  X(01)  VALUE 'N'.    01380000
016500         88  PS-RFID-AUDIT-NO-FAIL                  VALUE ' '.    01390000
016600         88  PS-FAILED-RF-AUD                       VALUE 'F'.    01400000
016600         88  PS-PENDING-RF-AUD                      VALUE 'I'.    01410000
016600         88  PS-FAILED-PENDING-RF-FOUND        VALUES 'I', 'F'.   01420000
      * 12/13 RLK END                                                   01430000
014500*                                                                 01440000
014600 01  PV-PROGRAM-VARIABLES.                                        01441000
014700     05  PV-CICS-RESPONSE               PIC S9(08)  VALUE ZEROES  01442000
014800                                        COMP SYNC.                01443000
014900     05  PV-SUB                         PIC S9(04)  VALUE +0      01444000
015000                                                    COMP SYNC.    01445000
015100     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01446000
015200                                                    COMP SYNC.    01447000
015300     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01448000
015400                                                    COMP-3.       01449000
015500     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      01450000
015600                                                    COMP-3.       01460000
015700     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      01470000
015800                                                    COMP-3.       01480000
015900     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      01490000
016000                                                    COMP-3.       01500000
016100     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01510000
016200                                                    COMP-3.       01520000
016300     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01530000
016400                                                    COMP-3.       01540000
016500     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      01550000
016600                                                    COMP-3.       01560000
016700     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01570000
016800                                                    COMP SYNC.    01580000
016900     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01590000
017000                                                    COMP SYNC.    01600000
017100     05  PV-ITEM                        PIC S9(04)  VALUE +0      01610000
017200                                                    COMP SYNC.    01620000
017300     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01630000
017400                                                    COMP SYNC.    01640000
017500     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01650000
017600                                                    COMP SYNC.    01660000
017700     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      01670000
017800                                                    COMP SYNC.    01680000
017900     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      01690000
018000                                                    COMP SYNC.    01700000
018100     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      01710000
018200                                                    COMP SYNC.    01720000
018300     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01730000
018400                                                    COMP SYNC.    01740000
018500     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01750000
018600                                                    COMP SYNC.    01760000
018700     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      01770000
018800                                                    COMP SYNC.    01780000
018900     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      01790000
019000                                                    COMP SYNC.    01800000
019100     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      01810000
019200                                                    COMP SYNC.    01820000
019300     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      01830000
019400                                                    COMP SYNC.    01840000
019500     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      01850000
019600                                                    COMP SYNC.    01860000
019700     05  PV-SOFT-ABORT-MSG.                                       01870000
019800         10  FILLER            PIC X(12) VALUE ' SUKCS799 - '.    01880000
019900         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       01890000
020000         10  PV-SOFT-SQLCODE   PIC ZZZZZZZZ9-.                    01900000
020100         10  FILLER            PIC X(12) VALUE ' PARAGRAPH: '.    01910000
020200         10  PV-SOFT-PARAGRAPH PIC X(30).                         01920000
020300     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     01930000
020400                                                     COMP SYNC.   01940000
020600     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 01950000
020700     05  PV-CICS-MSG-HOLD.                                        01960000
020800         10  FILLER                      PIC  X(01)  VALUE SPACE. 01970000
020900         10  PV-CICS-MSG-DATA            PIC  X(79)  VALUE SPACE. 01980000
021000     05  PV-CICS-MSG-HOLD2.                                       01990000
021100         10  FILLER                      PIC  X(01)  VALUE SPACE. 02000000
021200         10  PV-CICS-MSG-DATA2           PIC  X(99)  VALUE SPACE. 02010000
021300                                                                  02020000
021400     05  PV-ORIGINAL-BLOCK               PIC S9(04)  VALUE +0     02030000
021500                                                     COMP SYNC.   02040000
021600     05  PV-COUNT                 PIC S9(04)  VALUE +0 COMP.      02050000
021700     05  PV-COUNT-EXPECTED-HDR    PIC S9(07)  VALUE +0 COMP-3.    02060000
021800     05  PV-COUNT-DIRECTIVE-HDR   PIC S9(07)  VALUE +0 COMP-3.    02070000
021900     05  PV-COUNT-DIRECTIVES      PIC S9(07)  VALUE +0 COMP-3.    02080000
022000     05  PV-COUNT-EXPECTED        PIC S9(07)  VALUE +0 COMP-3.    02090000
022100     05  PV-COUNT-RELEASED        PIC S9(07)  VALUE +0 COMP-3.    02100000
022200                                                                  02110000
022300     05  PV-MAX-CRE-TMST          PIC  X(26)  VALUE SPACES.       02120000
022310     05  PV-MINIMUM-TMST          PIC  X(26)  VALUE SPACES.       02130000
022400     05  PV-ITEMS-HOLD            PIC S9(03)  COMP-3.             02140000
022500     05  PV-ITEMS-DIFF            PIC S9(03)  COMP-3.             02150000
022600     05  PV-SQLCODE               PIC S9(09)  VALUE 0.            02160000
022700     05  PV-MQ-COND-CODE          PIC S9(09)  VALUE 0.            02170000
022800     05  PV-MQ-REAS-CODE          PIC S9(09)  VALUE 0.            02180000
022800     05  PV-RFID-AUD-CNTL         PIC S9(09)  COMP VALUE +0.      02190000
022900                                                                  02200000
023000     05  PV-SELECT                PIC  X(01)  VALUE SPACES.       02210000
023100         88  PC-AUDIT                         VALUE 'A'.          02220000
023200         88  PC-PREPK-PO-RCVR-PK              VALUE 'B'.          02230000
023300         88  PC-PREPK-PO-RCVR                 VALUE 'C'.          02240000
023400         88  PC-PK-BY-STR-PO-RCVR             VALUE 'D'.          02250000
023500         88  PC-PO-RCVR-LNE                   VALUE 'E'.          02260000
023600         88  PC-PO-RCVR                       VALUE 'F'.          02270000
023610     05  PV-PO-RCVR-FORMAT.                                       02280000
023620         10  PV-PO-NBR            PIC  9(08)  VALUE 0.            02290000
023630         10  FILLER               PIC  X(01)  VALUE '-'.          02300000
023640         10  PV-RCVR-NBR          PIC  9(03)  VALUE 0.            02310000
023700                                                                  02320000
023710 01  PV-AREA.                                                     02330000
023720     05  PV-CICS-MSG-AREA.                                        02340000
023730         10  FILLER                    PIC X(19)     VALUE        02350000
023740                       'SUKUT129 CALLED BY '.                     02360000
023750         10  PV-MSG-PGM                PIC X(08)     VALUE SPACES.02361000
023760         10  PV-ERROR-TYPE             PIC X(14)     VALUE SPACES.02362000
023770             88  PV-PARM-ERROR                       VALUE        02363000
023780                       '  PARM ERROR: '.                          02364000
023790             88  PV-DB2-ERROR                        VALUE        02365000
023791                       '   DB2 ERROR: '.                          02366000
023792             88  PV-MQ-ERROR                         VALUE        02367000
023793                       '    MQ ERROR: '.                          02368000
023794             88  PV-OTHER-ERROR                      VALUE        02369000
023795                       ' OTHER ERROR: '.                          02370000
023796         10  PV-ERROR-DESC             PIC X(59)     VALUE SPACES.02371000
023797******************************************************************02372000
023900**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **02373000
024000**  THIS MUST BE THE EXACT SAME FORMAT AS BLOCK IN THE          **02374000
024100**  APPLICATION-SPECIFIC COMMAREA.                              **02375000
024200******************************************************************02376000
024300 01  LQW-LIST-QUEUE-WORK-AREA.                                    02377000
024400     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  02378000
024500     05  LQW-ITEM-ENTRIES               OCCURS 08 TIMES           02379000
024600                                        INDEXED BY LQW-IDX.       02380000
024700         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       02390000
024800         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               02400000
024900         10  LQW-SELECTED-SW            PIC  X(01).               02410000
025000             88  LQW-SELECT                         VALUE 'S'.    02420000
025100             88  LQW-DESELECT                       VALUE ' '.    02430000
025200         10  LQW-ACTION                 PIC  X(03).               02440000
025300             88  LQW-ADD                            VALUE 'ADD'.  02450000
025400             88  LQW-INQ                            VALUE 'INQ'.  02460000
025500             88  LQW-UPD                            VALUE 'UPD'.  02470000
025600             88  LQW-ERR                            VALUE 'ERR'.  02480000
025700         10  LQW-LNE-NBR                PIC  9(04).               02490000
025800         10  LQW-PREPACK-ID             PIC  9(04).               02500000
025900         10  LQW-SKU                    PIC  X(08).               02510000
026000*CT BEGIN 01/28/09 IR #18061 WERE 5,MADE TO MATCH MAP             02520000
026100         10  LQW-EXPECTED-CTNS          PIC  9(04).               02530000
026200         10  LQW-DIRTV-CTNS             PIC  9(04).               02540000
026300         10  LQW-RLSD-CTNS              PIC  9(04).               02550000
026400*CT END   01/28/09 IR #18061                                      02560000
026500         10  LQW-AUD-CNTL-NBR           PIC  9(09).               02570000
026600         10  LQW-AUD-FALR-RSN-NM        PIC  X(04).               02580000
026700*CT BEGIN 01/28/09 IR #18061 WAS 10,MADE TO MATCH MAP             02590000
026800         10  LQW-DIRTV-DATE             PIC  X(08).               02600000
026900*CT END   01/28/09 IR #18061                                      02610000
027000         10  LQW-DIRTV-TIME             PIC  X(08).               02620000
027100         10  LQW-RLSD-CRTN-NOT-RCVD     PIC  X(01).               02630000
027200         10  LQW-CREATE-DATE            PIC  X(26).               02640000
027300         10  LQW-BARCODE                PIC  X(22).               02650000
027400         10  LQW-STR-ZN-ID              PIC  X(05).               02660000
027500         10  LQW-STR-NBR                PIC  9(05).               02670000
027600         10  LQW-AUD-STAT-CDE           PIC  X(01).               02680000
027700         10  LQW-SHIPT-UNT-ID           PIC S9(18) COMP-3.        02690000
027800         10  LQW-SEASET-YR              PIC  X(04).               02700000
027900         10  LQW-SEASET-SHRT-NM         PIC  X(05).               02710000
028000         10  LQW-BRCDE-TYPE             PIC  X(01).               02720000
028100                                                                  02730000
028200*---------------------------------------------------------------* 02740000
028300*    COMMAREA TO CALL SUKUT129                                  * 02750000
028400*---------------------------------------------------------------* 02760000
028500     COPY SUWS090.                                                02770000
028600                                                                  02780000
028700*---------------------------------------------------------------* 02790000
028800* SELECTION QUEUE LAYOUT                                        * 02800000
028900*---------------------------------------------------------------* 02810000
029000     COPY SUWS099.                                                02820000
029100/                                                                 02830000
029200*---------------------------------------------------------------* 02840000
029300*    MAP LAYOUT                                                 * 02850000
029400*---------------------------------------------------------------* 02860000
029500     COPY SUKM799.                                                02870000
029600*                                                                 02880000
029700 01  MR-OCCURS-LAYOUT                   REDEFINES  SUK799O.       02890000
029800     05  FILLER                         PIC X(172).               02900000
029900     05  MR-SCROLL-AREA                 OCCURS 08 TIMES.          02910000
030000         10  MR-SELECTL                 PIC S9(04) COMP.          02920000
030100         10  MR-SELECTA                 PIC  X(01).               02930000
030200         10  MR-SELECTC                 PIC  X(01).               02940000
030300         10  MR-SELECTH                 PIC  X(01).               02950000
030400         10  MR-SELECTI                 PIC  X(01).               02960000
030500                                                                  02970000
030600         10  MR-ACTIONL                 PIC S9(04) COMP.          02980000
030700         10  MR-ACTIONA                 PIC  X(01).               02990000
030800         10  MR-ACTIONC                 PIC  X(01).               03000000
030900         10  MR-ACTIONH                 PIC  X(01).               03010000
031000         10  MR-ACTION                  PIC  X(03).               03020000
031100                                                                  03030000
031200         10  MR-LINE-NBRL              PIC S9(04) COMP.           03040000
031300         10  MR-LINE-NBRA              PIC  X(01).                03050000
031400         10  MR-LINE-NBRC              PIC  X(01).                03060000
031500         10  MR-LINE-NBRH              PIC  X(01).                03070000
031600         10  MR-LINE-NBR               PIC  Z(04).                03080000
031700                                                                  03090000
031800         10  MR-SKUL                   PIC S9(04) COMP.           03100000
031900         10  MR-SKUA                   PIC  X(01).                03110000
032000         10  MR-SKUC                   PIC  X(01).                03120000
032100         10  MR-SKUH                   PIC  X(01).                03130000
032200         10  MR-SKU                    PIC  X(08).                03140000
032300                                                                  03150000
032400         10  MR-EXP-CTNSL              PIC S9(04) COMP.           03160000
032500         10  MR-EXP-CTNSA              PIC  X(01).                03170000
032600         10  MR-EXP-CTNSC              PIC  X(01).                03180000
032700         10  MR-EXP-CTNSH              PIC  X(01).                03190000
032800         10  MR-EXP-CTNS               PIC  Z(04).                03200000
032900                                                                  03210000
033000         10  MR-DRTV-CTNSL             PIC S9(04) COMP.           03220000
033100         10  MR-DRTV-CTNSA             PIC  X(01).                03230000
033200         10  MR-DRTV-CTNSC             PIC  X(01).                03240000
033300         10  MR-DRTV-CTNSH             PIC  X(01).                03250000
033400         10  MR-DRTV-CTNS              PIC  Z(04).                03260000
033500                                                                  03270000
033600         10  MR-RLSD-CTNSL             PIC S9(04) COMP.           03280000
033700         10  MR-RLSD-CTNSA             PIC  X(01).                03290000
033800         10  MR-RLSD-CTNSC             PIC  X(01).                03300000
033900         10  MR-RLSD-CTNSH             PIC  X(01).                03310000
034000         10  MR-RLSD-CTNS              PIC  Z(04).                03320000
034100                                                                  03330000
034200         10  MR-FAIL-RSNL              PIC S9(04) COMP.           03340000
034300         10  MR-FAIL-RSNA              PIC  X(01).                03350000
034400         10  MR-FAIL-RSNC              PIC  X(01).                03360000
034500         10  MR-FAIL-RSNH              PIC  X(01).                03370000
034600         10  MR-FAIL-RSN               PIC  X(04).                03380000
034700                                                                  03390000
034800         10  MR-AUD-CNTL-NBRL          PIC S9(04) COMP.           03400000
034900         10  MR-AUD-CNTL-NBRA          PIC  X(01).                03410000
035000         10  MR-AUD-CNTL-NBRC          PIC  X(01).                03420000
035100         10  MR-AUD-CNTL-NBRH          PIC  X(01).                03430000
035200         10  MR-AUD-CNTL-NBR           PIC  Z(09).                03440000
035300                                                                  03450000
035400         10  MR-CTN-NOT-RCVDL          PIC S9(04) COMP.           03460000
035500         10  MR-CTN-NOT-RCVDA          PIC  X(01).                03470000
035600         10  MR-CTN-NOT-RCVDC          PIC  X(01).                03480000
035700         10  MR-CTN-NOT-RCVDH          PIC  X(01).                03490000
035800         10  MR-CTN-NOT-RCVD           PIC  X(01).                03500000
035900                                                                  03510000
036000         10  MR-CREATE-DTEL            PIC S9(04) COMP.           03520000
036100         10  MR-CREATE-DTEA            PIC  X(01).                03530000
036200         10  MR-CREATE-DTEC            PIC  X(01).                03540000
036300         10  MR-CREATE-DTEH            PIC  X(01).                03550000
036400         10  MR-CREATE-DTE             PIC  X(08).                03560000
036500                                                                  03570000
036600         10  MR-CREATE-TMEL            PIC S9(04) COMP.           03580000
036700         10  MR-CREATE-TMEA            PIC  X(01).                03590000
036800         10  MR-CREATE-TMEC            PIC  X(01).                03600000
036900         10  MR-CREATE-TMEH            PIC  X(01).                03610000
037000         10  MR-CREATE-TME             PIC  X(08).                03620000
037100                                                                  03630000
037200     05  FILLER                         PIC  X(12).               03640000
037300                                                                  03650000
037400*----------------------------------------------------------------*03660000
037500*  SENDING/RECEIVING AREA FOR THE                                 03670000
037600*  PRINTER VALIDATION ROUTING (DPKCS060)                          03680000
037700*----------------------------------------------------------------*03690000
037800     COPY DPWS072.                                                03700000
037900                                                                  03710000
038000*---------------------------------------------------------------* 03720000
038100*    RACF COPYBOOK.                                             * 03730000
038200*---------------------------------------------------------------* 03740000
038300     COPY DPWS008.                                                03750000
038400                                                                  03760000
038500*---------------------------------------------------------------* 03770000
038600*    ATTRIBUTE SETTINGS COPYBOOK.                               * 03780000
038700*---------------------------------------------------------------* 03790000
038800     COPY DPWS015.                                                03800000
038900                                                                  03810000
039000*---------------------------------------------------------------* 03820000
039100*    FUNCTION KEYS COPYBOOK.                                    * 03830000
039200*---------------------------------------------------------------* 03840000
039300     COPY DPWS016.                                                03850000
039400                                                                  03860000
039500*---------------------------------------------------------------* 03870000
039600*    NUMERIC EDIT LAYOUT.                                       * 03880000
039700*---------------------------------------------------------------* 03890000
039800     COPY DPWS010I.                                               03900000
039900                                                                  03910000
040000*---------------------------------------------------------------* 03920000
040100*    PARAMETERS FOR CALLING CICS ARCHITECTURE API               * 03930002
040200*---------------------------------------------------------------* 03940000
040300     COPY DPWS030.                                                03950000
040300     COPY DPWS930.                                                03951002
040400                                                                  03960000
040500*---------------------------------------------------------------* 03970000
040600*    STANDARD COMMAREA.                                         * 03980000
040700*---------------------------------------------------------------* 03990000
040800     COPY DPWS020.                                                04000000
040900     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04010000
041000                                                                  04020000
041100*---------------------------------------------------------------* 04030000
041200* INTER-APPLICATION COMMAREA.                                   * 04040000
041300*   SUWS097 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 04050000
041400*             SPEC SCREEN.                                      * 04060000
041500*   SUWS098 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 04070000
041600*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 04080000
041700*---------------------------------------------------------------* 04090000
041800         10  INTER-APPL-COMM-AREA       PIC X(200).               04100000
041900     COPY SUWS097.                                                04110000
042000     COPY SUWS098.                                                04120000
042100                                                                  04130000
042200*---------------------------------------------------------------* 04140000
042300*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 04150000
042400*---------------------------------------------------------------* 04160000
042500         10  ASC-SPECIFIC-COMMAREA.                               04170000
042600             15  ASC-FUNCTION                 PIC  X(01).         04180000
042700             15  ASC-INT-APPL-FORMAT-IND      PIC  X(01).         04190000
042800             15  ASC-OPER-UNT-ID              PIC  9(04).         04200000
042900             15  ASC-FCLTY-NAME               PIC  X(25).         04210000
      *CLP 09/25/2014                                                   04220000
043000             15  ASC-PO-NBR                   PIC  9(08).         04230000
043100             15  ASC-RCVR                     PIC  9(04).         04240000
043200             15  ASC-PO-LNE-NBR               PIC  9(04).         04250000
043300             15  ASC-PREPK-ID                 PIC  9(04).         04260000
043400             15  ASC-PACK-TYPE                PIC  X(14).         04270000
043500             15  ASC-SCAC                     PIC  X(04).         04280000
043600             15  ASC-TRAILER                  PIC  X(10).         04290000
043700             15  ASC-ARRIVE-DATE              PIC  X(10).         04300000
043800             15  ASC-TRIP-ID                  PIC  9(09).         04310000
043900             15  ASC-AUDIT-CNTL-NBR           PIC  9(09).         04320000
044000             15  ASC-ARRIVAL-DATE             PIC  X(08).         04330000
044100             15  ASC-TRAILER-STATUS           PIC  X(14).         04340000
044200             15  ASC-RCVR-EXP-CRTN-CNT        PIC  9(04).         04350000
044300             15  ASC-ORIG-DIRTV-CRTN-CNT      PIC  9(04).         04360000
044400             15  ASC-DIRECTIVE-CARTONS        PIC  9(07).         04370000
044500             15  ASC-EXPECTED-CARTONS         PIC  9(07).         04380000
044600             15  ASC-BRCDE-NBR                PIC  X(22).         04390000
044700             15  ASC-F2-CONFIRM-SW            PIC  X(01).         04400000
044800                 88  ASC-F2-CONFIRM-YES            VALUE 'Y'.     04410000
044900                 88  ASC-F2-CONFIRM-NO             VALUE 'N'.     04420000
045000             15  ASC-PKGING-CODE-SW           PIC  X(01).         04430000
045100                 88  ASC-PREPK-ORDER               VALUE '1'.     04440000
045200                 88  ASC-PACK-BY-STORE-ORDER       VALUE '2'.     04450000
045300                 88  ASC-BULK-CASE-ORDER           VALUE '3'.     04460000
045400             15  ASC-RQST-SW                  PIC  X(01).         04470000
045500                 88  ASC-RQST-PO-RCVR              VALUE '1'.     04480000
045600                 88  ASC-RQST-PO-RCVR-PREPK        VALUE '2'.     04490000
045700                 88  ASC-RQST-PO-RCVR-LINE         VALUE '3'.     04500000
045800                 88  ASC-RQST-AUDIT                VALUE '4'.     04510000
045900                 88  ASC-RQST-BAR-CODE             VALUE '5'.     04520000
046000             15  ASC-BLK-SUB                  PIC S9(04) COMP     04530000
046100                                                         SYNC.    04540000
046200             15  ASC-ITEM-SUB                 PIC S9(04) COMP     04550000
046300                                                         SYNC.    04560000
046400             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09) COMP-3.  04570000
046500             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09) COMP-3.  04580000
046600             15  ASC-ITEMS-DISPLAYED          PIC S9(03) COMP-3.  04590000
046700             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09) COMP-3.  04600000
046800             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09) COMP-3.  04610000
046900             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04) COMP     04620000
047000                                                         SYNC.    04630000
047100             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09) COMP-3.  04640000
047200             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09) COMP-3.  04650000
047300             15  ASC-XCNTL-TO-RESEND-SW       PIC  X(01).         04660000
047400                 88  ASC-XCNTL-TO-RESEND           VALUE 'Y'.     04670000
047500                 88  ASC-XCNTL-TO-RESEND-NO        VALUE 'N'.     04680000
047600             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         04690000
047700                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     04700000
047800                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     04710000
047900             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         04720000
048000                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     04730000
048100                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     04740000
048200             15  ASC-LIST-QUEUE-NAME.                             04750000
048300                 20  ASC-LIST-TERM-ID         PIC  X(04).         04760000
048400                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  04770000
048500                 20  ASC-LIST-SEQ             PIC  9(01).         04780000
048600                                                                  04790000
048700             15  ASC-START-ITEM-REQUEST.                          04800000
048800                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         04810000
048900                                                                  04820000
049000             15  ASC-SEL-SUB                  PIC S9(4) COMP.     04830000
049100             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     04840000
049200             15  ASC-CURSOR-SW                PIC  X(02).         04850000
049300                 88  ASC-NO-CURSOR                   VALUE 'Z '.  04860000
049400                 88  ASC-DOOR-TYPE-CSR               VALUE 'A '.  04870000
049500                                                                  04880000
049600             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          04890000
049700                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 04900000
049800             15  ASC-SEL-QUEUE-NAME.                              04910000
049900                 20  ASC-SEL-TERM-ID          PIC  X(04).         04920000
050000                 20  ASC-SEL-TASK-NUMBER      PIC S9(05) COMP-3.  04930000
050100                 20  ASC-SEL-SEQ              PIC  9(01).         04940000
050200                                                                  04950000
050300             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  04960000
050400                                                                  04970000
050500*-----------------------------------------------------------------04980000
050600             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                04990000
050700                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  05000000
050800                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   05010000
050900                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   05020000
051000                                                                  05030000
051100                 20  ASC-ITEM-ARRAY.                              05040000
051200                     25  ASC-ITEM-ENTRIES OCCURS 08 TIMES.        05050000
051300                         30  ASC-LIST-ITEM-NUMBER                 05060000
051400                                                     PIC S9(09)   05070000
051500                                                     COMP-3.      05080000
051600                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  05090000
051700                             88  ASC-VALID-SELECT    VALUE ' '    05100000
051800                                                           'S'    05110000
051900                                                           'B'    05120000
052000                                                           'E'.   05130000
052100                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   05140000
052200                             88  ASC-TEMP-SELECT     VALUE 'S'.   05150000
052300                             88  ASC-TEMP-BEGIN      VALUE 'B'.   05160000
052400                             88  ASC-TEMP-END        VALUE 'E'.   05170000
052500                         30  ASC-SELECTED-SW         PIC  X(01).  05180000
052600                             88  ASC-NO-SELECT       VALUE ' '.   05190000
052700                             88  ASC-SELECT          VALUE 'S'.   05200000
052800                             88  ASC-BEGIN           VALUE 'B'.   05210000
052900                             88  ASC-END             VALUE 'E'.   05220000
053000                         30  ASC-ACTION              PIC  X(03).  05230000
053100                         30  ASC-LNE-NBR             PIC  9(04).  05240000
053200                         30  ASC-PREPACK-ID          PIC  9(04).  05250000
053300                         30  ASC-SKU                 PIC  X(08).  05260000
053400*CT BEGIN 01/28/09 IR #18061 WERE 5,MADE TO MATCH MAP             05270000
053500                         30  ASC-EXP-CTNS            PIC  9(04).  05280000
053600                         30  ASC-DRTV-CTNS           PIC  9(04).  05290000
053700                         30  ASC-RLSD-CTNS           PIC  9(04).  05300000
053800*CT END   01/28/09 IR #18061                                      05310000
053900                         30  ASC-AUD-CNTL-NBR        PIC  9(09).  05320000
054000                         30  ASC-AUD-FALR-RSN-NM     PIC  X(04).  05330000
054100                         30  ASC-DIRTV-DATE          PIC  X(08).  05340000
054200                         30  ASC-DIRTV-TIME          PIC  X(08).  05350000
054300                         30  ASC-CTN-NOT-RCVD        PIC  X(01).  05360000
054400                         30  ASC-CREATE-TMST         PIC  X(26).  05370000
054410                         30  ASC-BARCODE             PIC  X(22).  05380000
054420                         30  ASC-STR-ZN-ID           PIC  X(05).  05390000
054430                         30  ASC-STR-NBR             PIC  9(05).  05400000
054440                         30  ASC-AUD-STAT-CDE        PIC  X(01).  05410000
054450                         30  ASC-SHIPT-UNT-ID        PIC S9(18)   05420000
054460                                                     COMP-3.      05430000
054470                         30  ASC-SEASET-YR           PIC  X(04).  05440000
054480                         30  ASC-SEASET-SHRT-NM      PIC  X(05).  05441000
054490                         30  ASC-BRCDE-TYPE          PIC  X(01).  05442000
054500                             88  ASC-NO-BARCODE     VALUE ' '.    05443000
054600                             88  ASC-BRCDE-SML      VALUE 'S'.    05444000
054700                             88  ASC-BRCDE-P2L      VALUE 'P'.    05445000
054800                                                                  05446000
054900*---------------------------------------------------------------* 05447000
055000*    ABEND PROCESSING COPYBOOK.                                 * 05448000
055100*---------------------------------------------------------------* 05449000
055200     COPY DPWS013.                                                05450000
055300                                                                  05460000
055400*----------------------------------------------------------------*05470000
055500*    DB2 TABLE                                                    05480000
055600*----------------------------------------------------------------*05490000
055700     EXEC SQL                                                     05500000
055800          INCLUDE SUT00015                                        05510000
055900     END-EXEC.                                                    05520000
056000                                                                  05530000
056100*----------------------------------------------------------------*05540000
056200*    DB2 TABLE                                                    05550000
056300*----------------------------------------------------------------*05560000
056400     EXEC SQL                                                     05570000
056500          INCLUDE SUT00102                                        05580000
056600     END-EXEC.                                                    05590000
056700                                                                  05600000
056800*----------------------------------------------------------------*05610000
056900*    DB2 TABLE                                                    05620000
057000*----------------------------------------------------------------*05630000
057100     EXEC SQL                                                     05640000
057200          INCLUDE TRECEIV                                         05650000
057300     END-EXEC.                                                    05660000
057400                                                                  05670000
057500*----------------------------------------------------------------*05680000
057600*    DB2 TABLE                                                    05690000
057700*----------------------------------------------------------------*05700000
057800     EXEC SQL                                                     05710000
057900          INCLUDE TTRIPST                                         05720000
058000     END-EXEC.                                                    05730000
058100                                                                  05740000
058200*----------------------------------------------------------------*05750000
058300*    DB2 TABLE                                                    05760000
058400*----------------------------------------------------------------*05770000
058500     EXEC SQL                                                     05780000
058600          INCLUDE TVHTRIP                                         05790000
058700     END-EXEC.                                                    05800000
058800                                                                  05810000
058900*----------------------------------------------------------------*05820000
059000*    DB2 TABLE                                                    05830000
059100*----------------------------------------------------------------*05840000
059200     EXEC SQL                                                     05850000
059300          INCLUDE TSHIPMT                                         05860000
059400     END-EXEC.                                                    05870000
059500                                                                  05880000
059600*----------------------------------------------------------------*05890000
059700*    DB2 TABLE                                                    05900000
059800*----------------------------------------------------------------*05910000
059900     EXEC SQL                                                     05920000
060000          INCLUDE TSHPTPO                                         05930000
060100     END-EXEC.                                                    05940000
060200                                                                  05950000
060300*----------------------------------------------------------------*05960000
060400*    DB2 TABLE                                                    05970000
060500*----------------------------------------------------------------*05980000
060600     EXEC SQL                                                     05990000
060700          INCLUDE TPKSLIP                                         06000000
060800     END-EXEC.                                                    06010000
060900                                                                  06020000
061000*----------------------------------------------------------------*06030000
061100*    DB2 TABLE                                                    06040000
061200*----------------------------------------------------------------*06050000
061300     EXEC SQL                                                     06060000
061400          INCLUDE TINPKSU                                         06070000
061500     END-EXEC.                                                    06080000
061600                                                                  06090000
061700*----------------------------------------------------------------*06100000
061800*    DB2 TABLE                                                    06110000
061900*----------------------------------------------------------------*06120000
062000     EXEC SQL                                                     06130000
062100          INCLUDE TSHPUNT                                         06140000
062200     END-EXEC.                                                    06150000
062300                                                                  06160000
062400*----------------------------------------------------------------*06170000
062500*    DB2 TABLE                                                    06180000
062600*----------------------------------------------------------------*06190000
062700     EXEC SQL                                                     06200000
062800          INCLUDE TSHUUPC                                         06210000
062900     END-EXEC.                                                    06220000
063000                                                                  06230000
063100*----------------------------------------------------------------*06240000
063200*    DB2 TABLE                                                    06250000
063300*----------------------------------------------------------------*06260000
063400     EXEC SQL                                                     06270000
063500          INCLUDE TRECITM                                         06280000
063600     END-EXEC.                                                    06290000
063700                                                                  06300000
063800*----------------------------------------------------------------*06310000
063900*    DB2 TABLE                                                    06320000
064000*----------------------------------------------------------------*06330000
064100     EXEC SQL                                                     06340000
064200          INCLUDE XLT00003                                        06350000
064300     END-EXEC.                                                    06360000
064400                                                                  06370000
064500*----------------------------------------------------------------*06380000
064600*    DB2 TABLE                                                    06390000
064700*----------------------------------------------------------------*06400000
064800     EXEC SQL                                                     06410000
064900          INCLUDE WST00008                                        06420000
065000     END-EXEC.                                                    06430000
065100                                                                  06440000
065200*----------------------------------------------------------------*06450000
065300*    DB2 TABLE                                                    06460000
065400*----------------------------------------------------------------*06470000
065500     EXEC SQL                                                     06480000
065600          INCLUDE WST00009                                        06490000
065700     END-EXEC.                                                    06500000
065800                                                                  06510000
065900*----------------------------------------------------------------*06520000
066000*    DB2 TABLE                                                    06530000
066100*----------------------------------------------------------------*06540000
066200     EXEC SQL                                                     06550000
066300          INCLUDE WST00010                                        06560000
066400     END-EXEC.                                                    06570000
066500                                                                  06580000
066600*CT BEGIN 01/28/09 IR #18061                                      06590000
066700     EXEC SQL                                                     06600000
066800        DECLARE PO-RCVR-CSR CURSOR FOR                            06610000
066900        SELECT  DISTINCT                                          06620000
067000                A.AUD_CNTL_NBR                                    06630000
067200               ,A.PO_LNE_NBR                                      06640000
067300               ,A.PREPK_ID                                        06650000
067400               FROM  SUT_CART_DIRV_TRKG          A                06660000
067500              WHERE  A.OPER_UNT_ID    = :DK-OPER-UNT-ID           06670000
067600                AND  A.PO_NBR         = :DK-PO-NBR                06680000
067700                AND  A.RCVR_SEQ_NBR   = :DK-REC-SEQ-NBR           06690000
067800                AND  A.CNVYR_PRC_ACTN_NM NOT IN ('DELETE')        06700000
067810                AND  A.DIRV_RSN_CDE   <>    'AUQ'                 06710000
067900                AND  A.CRE_TMST       =                           06720000
068000                       ( SELECT MAX (CRE_TMST)                    06730000
068100                         FROM SUT_CART_DIRV_TRKG B                06740000
068200                         WHERE B.BRCDE_NBR  =  A.BRCDE_NBR        06750000
068300                         )                                        06760000
068400                AND  A.LGCL_LOC_NM  IN                            06770000
068500           (                                                      06780000
068600               SELECT DISTINCT(E.ATTR_ELEM_TXT)                   06790000
068700               FROM WST_INTGRTN_TYP A                             06800000
068800                  , WST_ATTR_DEFN           B                     06810000
068900                  , WST_ATTR_ELEM           C                     06820000
069000                  , WST_ATTR_ELEM           D                     06830000
069100                  , WST_ATTR_ELEM           E                     06840000
069200                  , WST_ATTR_ELEM           F                     06850000
069300                  , WST_ATTR_ELEM           G                     06860000
069400                  , WST_ATTR_ELEM           H                     06870000
069500                  , WST_ATTR_ELEM           I                     06880000
069600                  , WST_ATTR_ELEM           J                     06890000
069700                  , WST_ATTR_ELEM           K                     06900000
069800               WHERE A.INTGRTN_TYP_CDE    =  'ACAULGDST'          06910000
069900                 AND A.INTGRTN_TYP_CDE    =  B.INTGRTN_TYP_CDE    06920000
070000                 AND A.INTGRTN_TYP_CDE    =  C.INTGRTN_TYP_CDE    06930000
070100                 AND A.INTGRTN_TYP_CDE    =  D.INTGRTN_TYP_CDE    06940000
070200                 AND A.INTGRTN_TYP_CDE    =  E.INTGRTN_TYP_CDE    06950000
070300                 AND A.INTGRTN_TYP_CDE    =  F.INTGRTN_TYP_CDE    06960000
070400                 AND A.INTGRTN_TYP_CDE    =  G.INTGRTN_TYP_CDE    06970000
070500                 AND A.INTGRTN_TYP_CDE    =  H.INTGRTN_TYP_CDE    06980000
070600                 AND A.INTGRTN_TYP_CDE    =  I.INTGRTN_TYP_CDE    06990000
070700                 AND A.INTGRTN_TYP_CDE    =  J.INTGRTN_TYP_CDE    07000000
070800                 AND A.INTGRTN_TYP_CDE    =  K.INTGRTN_TYP_CDE    07010000
070900                 AND B.ATTR_DEFN_SEQ_NBR  =  1                    07020000
071000                 AND C.ATTR_DEFN_SEQ_NBR  =  1                    07030000
071100                 AND D.ATTR_DEFN_SEQ_NBR  =  2                    07040000
071200                 AND E.ATTR_DEFN_SEQ_NBR  =  3                    07050000
071300                 AND F.ATTR_DEFN_SEQ_NBR  =  4                    07060000
071400                 AND G.ATTR_DEFN_SEQ_NBR  =  5                    07070000
071500                 AND H.ATTR_DEFN_SEQ_NBR  =  6                    07080000
071600                 AND I.ATTR_DEFN_SEQ_NBR  =  7                    07090000
071700                 AND J.ATTR_DEFN_SEQ_NBR  =  8                    07100000
071800                 AND K.ATTR_DEFN_SEQ_NBR  =  9                    07110000
071900                 AND C.ATTR_ELEM_SEQ_NBR  =  D.ATTR_ELEM_SEQ_NBR  07120000
072000                 AND C.ATTR_ELEM_SEQ_NBR  =  E.ATTR_ELEM_SEQ_NBR  07130000
072100                 AND C.ATTR_ELEM_SEQ_NBR  =  F.ATTR_ELEM_SEQ_NBR  07140000
072200                 AND C.ATTR_ELEM_SEQ_NBR  =  G.ATTR_ELEM_SEQ_NBR  07150000
072300                 AND C.ATTR_ELEM_SEQ_NBR  =  H.ATTR_ELEM_SEQ_NBR  07160000
072400                 AND C.ATTR_ELEM_SEQ_NBR  =  I.ATTR_ELEM_SEQ_NBR  07170000
072500                 AND C.ATTR_ELEM_SEQ_NBR  =  J.ATTR_ELEM_SEQ_NBR  07180000
072600                 AND C.ATTR_ELEM_SEQ_NBR  =  K.ATTR_ELEM_SEQ_NBR  07190000
072700                 AND F.ATTR_ELEM_TXT      =  'Y'                  07200000
072800                 AND G.ATTR_ELEM_TMST    <=  CURRENT TIMESTAMP    07210000
072900                 AND H.ATTR_ELEM_TMST    >=  CURRENT TIMESTAMP    07220000
073000                 AND C.ATTR_ELEM_NBR      = :DK-OPER-UNT-ID       07230000
073100                 AND K.ATTR_ELEM_TXT      =  'Y'                  07240000
073200                                                )                 07250000
073300             ORDER BY A.PO_LNE_NBR                                07260000
073400         WITH UR                                                  07270000
073500     END-EXEC.                                                    07280000
073600                                                                  07290000
073700     EXEC SQL                                                     07300000
073800        DECLARE PO-RCVR-LINE-CSR CURSOR FOR                       07310000
073900        SELECT  DISTINCT                                          07320000
074000                A.AUD_CNTL_NBR                                    07330000
074200               ,A.PO_LNE_NBR                                      07340000
074300               ,A.PREPK_ID                                        07350000
074400               FROM  SUT_CART_DIRV_TRKG          A                07360000
074500              WHERE  A.OPER_UNT_ID    = :DK-OPER-UNT-ID           07370000
074600                AND  A.PO_NBR         = :DK-PO-NBR                07380000
074700                AND  A.RCVR_SEQ_NBR   = :DK-REC-SEQ-NBR           07390000
074800                AND  A.PO_LNE_NBR     = :DK-PO-LNE-NBR            07400000
074900                AND  A.CNVYR_PRC_ACTN_NM NOT IN ('DELETE')        07410000
074910                AND  A.DIRV_RSN_CDE   <>    'AUQ'                 07420000
075000                AND  A.CRE_TMST       =                           07430000
075100                       ( SELECT MAX (CRE_TMST)                    07440000
075200                         FROM SUT_CART_DIRV_TRKG B                07450000
075300                         WHERE B.BRCDE_NBR  =  A.BRCDE_NBR        07460000
075400                         )                                        07470000
075500                AND  A.LGCL_LOC_NM  IN                            07480000
075600           (                                                      07490000
075700               SELECT DISTINCT(E.ATTR_ELEM_TXT)                   07500000
075800               FROM WST_INTGRTN_TYP A                             07510000
075900                  , WST_ATTR_DEFN           B                     07520000
076000                  , WST_ATTR_ELEM           C                     07530000
076100                  , WST_ATTR_ELEM           D                     07540000
076200                  , WST_ATTR_ELEM           E                     07550000
076300                  , WST_ATTR_ELEM           F                     07560000
076400                  , WST_ATTR_ELEM           G                     07570000
076500                  , WST_ATTR_ELEM           H                     07580000
076600                  , WST_ATTR_ELEM           I                     07590000
076700                  , WST_ATTR_ELEM           J                     07600000
076800                  , WST_ATTR_ELEM           K                     07610000
076900               WHERE A.INTGRTN_TYP_CDE    =  'ACAULGDST'          07620000
077000                 AND A.INTGRTN_TYP_CDE    =  B.INTGRTN_TYP_CDE    07630000
077100                 AND A.INTGRTN_TYP_CDE    =  C.INTGRTN_TYP_CDE    07640000
077200                 AND A.INTGRTN_TYP_CDE    =  D.INTGRTN_TYP_CDE    07650000
077300                 AND A.INTGRTN_TYP_CDE    =  E.INTGRTN_TYP_CDE    07660000
077400                 AND A.INTGRTN_TYP_CDE    =  F.INTGRTN_TYP_CDE    07670000
077500                 AND A.INTGRTN_TYP_CDE    =  G.INTGRTN_TYP_CDE    07680000
077600                 AND A.INTGRTN_TYP_CDE    =  H.INTGRTN_TYP_CDE    07690000
077700                 AND A.INTGRTN_TYP_CDE    =  I.INTGRTN_TYP_CDE    07700000
077800                 AND A.INTGRTN_TYP_CDE    =  J.INTGRTN_TYP_CDE    07710000
077900                 AND A.INTGRTN_TYP_CDE    =  K.INTGRTN_TYP_CDE    07720000
078000                 AND B.ATTR_DEFN_SEQ_NBR  =  1                    07730000
078100                 AND C.ATTR_DEFN_SEQ_NBR  =  1                    07740000
078200                 AND D.ATTR_DEFN_SEQ_NBR  =  2                    07750000
078300                 AND E.ATTR_DEFN_SEQ_NBR  =  3                    07760000
078400                 AND F.ATTR_DEFN_SEQ_NBR  =  4                    07770000
078500                 AND G.ATTR_DEFN_SEQ_NBR  =  5                    07780000
078600                 AND H.ATTR_DEFN_SEQ_NBR  =  6                    07790000
078700                 AND I.ATTR_DEFN_SEQ_NBR  =  7                    07800000
078800                 AND J.ATTR_DEFN_SEQ_NBR  =  8                    07810000
078900                 AND K.ATTR_DEFN_SEQ_NBR  =  9                    07820000
079000                 AND C.ATTR_ELEM_SEQ_NBR  =  D.ATTR_ELEM_SEQ_NBR  07830000
079100                 AND C.ATTR_ELEM_SEQ_NBR  =  E.ATTR_ELEM_SEQ_NBR  07840000
079200                 AND C.ATTR_ELEM_SEQ_NBR  =  F.ATTR_ELEM_SEQ_NBR  07850000
079300                 AND C.ATTR_ELEM_SEQ_NBR  =  G.ATTR_ELEM_SEQ_NBR  07860000
079400                 AND C.ATTR_ELEM_SEQ_NBR  =  H.ATTR_ELEM_SEQ_NBR  07870000
079500                 AND C.ATTR_ELEM_SEQ_NBR  =  I.ATTR_ELEM_SEQ_NBR  07880000
079600                 AND C.ATTR_ELEM_SEQ_NBR  =  J.ATTR_ELEM_SEQ_NBR  07890000
079700                 AND C.ATTR_ELEM_SEQ_NBR  =  K.ATTR_ELEM_SEQ_NBR  07900000
079800                 AND F.ATTR_ELEM_TXT      =  'Y'                  07910000
079900                 AND G.ATTR_ELEM_TMST    <=  CURRENT TIMESTAMP    07920000
080000                 AND H.ATTR_ELEM_TMST    >=  CURRENT TIMESTAMP    07930000
080100                 AND C.ATTR_ELEM_NBR      = :DK-OPER-UNT-ID       07940000
080200                 AND K.ATTR_ELEM_TXT      =  'Y'                  07950000
080300                                                )                 07960000
080400             ORDER BY A.PO_LNE_NBR                                07970000
080500         WITH UR                                                  07980000
080600     END-EXEC.                                                    07990000
080700                                                                  08000000
080800     EXEC SQL                                                     08010000
080900        DECLARE PO-RCVR-PREPK-CSR CURSOR FOR                      08020000
081000        SELECT  DISTINCT                                          08030000
081100                A.AUD_CNTL_NBR                                    08040000
081300               ,A.PO_LNE_NBR                                      08050000
081400               ,A.PREPK_ID                                        08060000
081500               FROM  SUT_CART_DIRV_TRKG          A                08070000
081600              WHERE  A.OPER_UNT_ID    = :DK-OPER-UNT-ID           08080000
081700                AND  A.PO_NBR         = :DK-PO-NBR                08090000
081800                AND  A.RCVR_SEQ_NBR   = :DK-REC-SEQ-NBR           08100000
081900                AND  A.PREPK_ID       = :DK-PREPK-ID              08110000
082000                AND  A.CNVYR_PRC_ACTN_NM NOT IN ('DELETE')        08120000
082010                AND  A.DIRV_RSN_CDE   <>    'AUQ'                 08130000
082100                AND  A.CRE_TMST       =                           08140000
082200                       ( SELECT MAX (CRE_TMST)                    08150000
082300                         FROM SUT_CART_DIRV_TRKG B                08160000
082400                         WHERE B.BRCDE_NBR  =  A.BRCDE_NBR        08170000
082500                         )                                        08180000
082600                AND  A.LGCL_LOC_NM  IN                            08190000
082700           (                                                      08200000
082800               SELECT DISTINCT(E.ATTR_ELEM_TXT)                   08210000
082900               FROM WST_INTGRTN_TYP A                             08220000
083000                  , WST_ATTR_DEFN           B                     08230000
083100                  , WST_ATTR_ELEM           C                     08240000
083200                  , WST_ATTR_ELEM           D                     08250000
083300                  , WST_ATTR_ELEM           E                     08260000
083400                  , WST_ATTR_ELEM           F                     08270000
083500                  , WST_ATTR_ELEM           G                     08280000
083600                  , WST_ATTR_ELEM           H                     08290000
083700                  , WST_ATTR_ELEM           I                     08300000
083800                  , WST_ATTR_ELEM           J                     08310000
083900                  , WST_ATTR_ELEM           K                     08320000
084000               WHERE A.INTGRTN_TYP_CDE    =  'ACAULGDST'          08330000
084100                 AND A.INTGRTN_TYP_CDE    =  B.INTGRTN_TYP_CDE    08340000
084200                 AND A.INTGRTN_TYP_CDE    =  C.INTGRTN_TYP_CDE    08350000
084300                 AND A.INTGRTN_TYP_CDE    =  D.INTGRTN_TYP_CDE    08360000
084400                 AND A.INTGRTN_TYP_CDE    =  E.INTGRTN_TYP_CDE    08370000
084500                 AND A.INTGRTN_TYP_CDE    =  F.INTGRTN_TYP_CDE    08380000
084600                 AND A.INTGRTN_TYP_CDE    =  G.INTGRTN_TYP_CDE    08390000
084700                 AND A.INTGRTN_TYP_CDE    =  H.INTGRTN_TYP_CDE    08400000
084800                 AND A.INTGRTN_TYP_CDE    =  I.INTGRTN_TYP_CDE    08410000
084900                 AND A.INTGRTN_TYP_CDE    =  J.INTGRTN_TYP_CDE    08420000
085000                 AND A.INTGRTN_TYP_CDE    =  K.INTGRTN_TYP_CDE    08430000
085100                 AND B.ATTR_DEFN_SEQ_NBR  =  1                    08440000
085200                 AND C.ATTR_DEFN_SEQ_NBR  =  1                    08450000
085300                 AND D.ATTR_DEFN_SEQ_NBR  =  2                    08460000
085400                 AND E.ATTR_DEFN_SEQ_NBR  =  3                    08470000
085500                 AND F.ATTR_DEFN_SEQ_NBR  =  4                    08480000
085600                 AND G.ATTR_DEFN_SEQ_NBR  =  5                    08490000
085700                 AND H.ATTR_DEFN_SEQ_NBR  =  6                    08500000
085800                 AND I.ATTR_DEFN_SEQ_NBR  =  7                    08510000
085900                 AND J.ATTR_DEFN_SEQ_NBR  =  8                    08520000
086000                 AND K.ATTR_DEFN_SEQ_NBR  =  9                    08530000
086100                 AND C.ATTR_ELEM_SEQ_NBR  =  D.ATTR_ELEM_SEQ_NBR  08540000
086200                 AND C.ATTR_ELEM_SEQ_NBR  =  E.ATTR_ELEM_SEQ_NBR  08550000
086300                 AND C.ATTR_ELEM_SEQ_NBR  =  F.ATTR_ELEM_SEQ_NBR  08560000
086400                 AND C.ATTR_ELEM_SEQ_NBR  =  G.ATTR_ELEM_SEQ_NBR  08570000
086500                 AND C.ATTR_ELEM_SEQ_NBR  =  H.ATTR_ELEM_SEQ_NBR  08580000
086600                 AND C.ATTR_ELEM_SEQ_NBR  =  I.ATTR_ELEM_SEQ_NBR  08590000
086700                 AND C.ATTR_ELEM_SEQ_NBR  =  J.ATTR_ELEM_SEQ_NBR  08600000
086800                 AND C.ATTR_ELEM_SEQ_NBR  =  K.ATTR_ELEM_SEQ_NBR  08610000
086900                 AND F.ATTR_ELEM_TXT      =  'Y'                  08620000
087000                 AND G.ATTR_ELEM_TMST    <=  CURRENT TIMESTAMP    08630000
087100                 AND H.ATTR_ELEM_TMST    >=  CURRENT TIMESTAMP    08640000
087200                 AND C.ATTR_ELEM_NBR      = :DK-OPER-UNT-ID       08650000
087300                 AND K.ATTR_ELEM_TXT      =  'Y'                  08660000
087400                                                )                 08670000
087500             ORDER BY A.PO_LNE_NBR                                08680000
087600         WITH UR                                                  08690000
087700     END-EXEC.                                                    08700000
087800                                                                  08710000
087900     EXEC SQL                                                     08720000
088000        DECLARE AUDIT-CSR         CURSOR FOR                      08730000
088100        SELECT  DISTINCT                                          08740000
088200                A.AUD_CNTL_NBR                                    08750000
088400               ,A.PO_LNE_NBR                                      08760000
088500               ,A.PREPK_ID                                        08770000
088600               FROM  SUT_CART_DIRV_TRKG          A                08780000
088700              WHERE  A.OPER_UNT_ID    = :DK-OPER-UNT-ID           08790000
088800                AND  A.PO_NBR         = :DK-PO-NBR                08800000
088900                AND  A.RCVR_SEQ_NBR   = :DK-REC-SEQ-NBR           08810000
089000                AND  A.AUD_CNTL_NBR   = :DK-AUD-CNTL-NBR          08820000
089100                AND  A.CNVYR_PRC_ACTN_NM NOT IN ('DELETE')        08830000
089110                AND  A.DIRV_RSN_CDE   <>    'AUQ'                 08840000
089200                AND  A.CRE_TMST       =                           08850000
089300                       ( SELECT MAX (CRE_TMST)                    08860000
089400                         FROM SUT_CART_DIRV_TRKG B                08870000
089500                         WHERE B.BRCDE_NBR  =  A.BRCDE_NBR        08880000
089600                         )                                        08890000
089700                AND  A.LGCL_LOC_NM  IN                            08900000
089800           (                                                      08910000
089900               SELECT DISTINCT(E.ATTR_ELEM_TXT)                   08920000
090000               FROM WST_INTGRTN_TYP A                             08930000
090100                  , WST_ATTR_DEFN           B                     08940000
090200                  , WST_ATTR_ELEM           C                     08950000
090300                  , WST_ATTR_ELEM           D                     08960000
090400                  , WST_ATTR_ELEM           E                     08970000
090500                  , WST_ATTR_ELEM           F                     08980000
090600                  , WST_ATTR_ELEM           G                     08990000
090700                  , WST_ATTR_ELEM           H                     09000000
090800                  , WST_ATTR_ELEM           I                     09010000
090900                  , WST_ATTR_ELEM           J                     09020000
091000                  , WST_ATTR_ELEM           K                     09030000
091100               WHERE A.INTGRTN_TYP_CDE    =  'ACAULGDST'          09040000
091200                 AND A.INTGRTN_TYP_CDE    =  B.INTGRTN_TYP_CDE    09050000
091300                 AND A.INTGRTN_TYP_CDE    =  C.INTGRTN_TYP_CDE    09060000
091400                 AND A.INTGRTN_TYP_CDE    =  D.INTGRTN_TYP_CDE    09070000
091500                 AND A.INTGRTN_TYP_CDE    =  E.INTGRTN_TYP_CDE    09080000
091600                 AND A.INTGRTN_TYP_CDE    =  F.INTGRTN_TYP_CDE    09090000
091700                 AND A.INTGRTN_TYP_CDE    =  G.INTGRTN_TYP_CDE    09100000
091800                 AND A.INTGRTN_TYP_CDE    =  H.INTGRTN_TYP_CDE    09110000
091900                 AND A.INTGRTN_TYP_CDE    =  I.INTGRTN_TYP_CDE    09120000
092000                 AND A.INTGRTN_TYP_CDE    =  J.INTGRTN_TYP_CDE    09130000
092100                 AND A.INTGRTN_TYP_CDE    =  K.INTGRTN_TYP_CDE    09140000
092200                 AND B.ATTR_DEFN_SEQ_NBR  =  1                    09150000
092300                 AND C.ATTR_DEFN_SEQ_NBR  =  1                    09160000
092400                 AND D.ATTR_DEFN_SEQ_NBR  =  2                    09170000
092500                 AND E.ATTR_DEFN_SEQ_NBR  =  3                    09180000
092600                 AND F.ATTR_DEFN_SEQ_NBR  =  4                    09190000
092700                 AND G.ATTR_DEFN_SEQ_NBR  =  5                    09200000
092800                 AND H.ATTR_DEFN_SEQ_NBR  =  6                    09210000
092900                 AND I.ATTR_DEFN_SEQ_NBR  =  7                    09220000
093000                 AND J.ATTR_DEFN_SEQ_NBR  =  8                    09230000
093100                 AND K.ATTR_DEFN_SEQ_NBR  =  9                    09240000
093200                 AND C.ATTR_ELEM_SEQ_NBR  =  D.ATTR_ELEM_SEQ_NBR  09250000
093300                 AND C.ATTR_ELEM_SEQ_NBR  =  E.ATTR_ELEM_SEQ_NBR  09260000
093400                 AND C.ATTR_ELEM_SEQ_NBR  =  F.ATTR_ELEM_SEQ_NBR  09270000
093500                 AND C.ATTR_ELEM_SEQ_NBR  =  G.ATTR_ELEM_SEQ_NBR  09280000
093600                 AND C.ATTR_ELEM_SEQ_NBR  =  H.ATTR_ELEM_SEQ_NBR  09290000
093700                 AND C.ATTR_ELEM_SEQ_NBR  =  I.ATTR_ELEM_SEQ_NBR  09300000
093800                 AND C.ATTR_ELEM_SEQ_NBR  =  J.ATTR_ELEM_SEQ_NBR  09310000
093900                 AND C.ATTR_ELEM_SEQ_NBR  =  K.ATTR_ELEM_SEQ_NBR  09320000
094000                 AND F.ATTR_ELEM_TXT      =  'Y'                  09330000
094100                 AND G.ATTR_ELEM_TMST    <=  CURRENT TIMESTAMP    09340000
094200                 AND H.ATTR_ELEM_TMST    >=  CURRENT TIMESTAMP    09350000
094300                 AND C.ATTR_ELEM_NBR      = :DK-OPER-UNT-ID       09360000
094400                 AND K.ATTR_ELEM_TXT      =  'Y'                  09370000
094500                                                )                 09380000
094600             ORDER BY A.PO_LNE_NBR                                09390000
094700         WITH UR                                                  09400000
094800     END-EXEC.                                                    09410000
094900                                                                  09420000
095000     EXEC SQL                                                     09430000
095100        DECLARE BAR-CODE-CSR     CURSOR FOR                       09440000
095200        SELECT  DISTINCT                                          09450000
095300                A.AUD_CNTL_NBR                                    09460000
095500               ,A.PO_LNE_NBR                                      09470000
095600               ,A.PREPK_ID                                        09480000
095700       FROM  SUT_CART_DIRV_TRKG   A                               09490000
095800      WHERE  A.BRCDE_NBR      = :DK-BRCDE-NBR                     09500000
095900        AND  A.CNVYR_PRC_ACTN_NM NOT IN ('DELETE')                09510000
095910        AND  A.DIRV_RSN_CDE   <>    'AUQ'                         09520000
096000        AND  A.CRE_TMST       =                                   09530000
096100               ( SELECT MAX (CRE_TMST)                            09540000
096200                 FROM SUT_CART_DIRV_TRKG B                        09550000
096300                 WHERE B.BRCDE_NBR  =  A.BRCDE_NBR                09560000
096400                 )                                                09570000
096500        AND  A.LGCL_LOC_NM  IN                                    09580000
096600   (                                                              09590000
096700       SELECT DISTINCT(E.ATTR_ELEM_TXT)                           09600000
096800       FROM WST_INTGRTN_TYP A                                     09610000
096900          , WST_ATTR_DEFN           B                             09620000
097000          , WST_ATTR_ELEM           C                             09630000
097100          , WST_ATTR_ELEM           D                             09640000
097200          , WST_ATTR_ELEM           E                             09650000
097300          , WST_ATTR_ELEM           F                             09660000
097400          , WST_ATTR_ELEM           G                             09670000
097500          , WST_ATTR_ELEM           H                             09680000
097600          , WST_ATTR_ELEM           I                             09690000
097700          , WST_ATTR_ELEM           J                             09700000
097800          , WST_ATTR_ELEM           K                             09710000
097900       WHERE A.INTGRTN_TYP_CDE   = 'ACAULGDST'                    09720000
098000         AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE              09730000
098100         AND A.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE              09740000
098200         AND A.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE              09750000
098300         AND A.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE              09760000
098400         AND A.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE              09770000
098500         AND A.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE              09780000
098600         AND A.INTGRTN_TYP_CDE   = H.INTGRTN_TYP_CDE              09790000
098700         AND A.INTGRTN_TYP_CDE   = I.INTGRTN_TYP_CDE              09800000
098800         AND A.INTGRTN_TYP_CDE   = J.INTGRTN_TYP_CDE              09810000
098900         AND A.INTGRTN_TYP_CDE   = K.INTGRTN_TYP_CDE              09820000
099000         AND B.ATTR_DEFN_SEQ_NBR = 1                              09830000
099100         AND C.ATTR_DEFN_SEQ_NBR = 1                              09840000
099200         AND D.ATTR_DEFN_SEQ_NBR = 2                              09850000
099300         AND E.ATTR_DEFN_SEQ_NBR = 3                              09860000
099400         AND F.ATTR_DEFN_SEQ_NBR = 4                              09870000
099500         AND G.ATTR_DEFN_SEQ_NBR = 5                              09880000
099600         AND H.ATTR_DEFN_SEQ_NBR = 6                              09890000
099700         AND I.ATTR_DEFN_SEQ_NBR = 7                              09900000
099800         AND J.ATTR_DEFN_SEQ_NBR = 8                              09910000
099900         AND K.ATTR_DEFN_SEQ_NBR = 9                              09920000
100000         AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR            09930000
100100         AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR            09940000
100200         AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR            09950000
100300         AND C.ATTR_ELEM_SEQ_NBR = G.ATTR_ELEM_SEQ_NBR            09960000
100400         AND C.ATTR_ELEM_SEQ_NBR = H.ATTR_ELEM_SEQ_NBR            09970000
100500         AND C.ATTR_ELEM_SEQ_NBR = I.ATTR_ELEM_SEQ_NBR            09980000
100600         AND C.ATTR_ELEM_SEQ_NBR = J.ATTR_ELEM_SEQ_NBR            09990000
100700         AND C.ATTR_ELEM_SEQ_NBR = K.ATTR_ELEM_SEQ_NBR            10000000
100800         AND F.ATTR_ELEM_TXT     = 'Y'                            10010000
100900         AND G.ATTR_ELEM_TMST    <=  CURRENT TIMESTAMP            10020000
101000         AND H.ATTR_ELEM_TMST    >=  CURRENT TIMESTAMP            10030000
101100         AND C.ATTR_ELEM_NBR     = :DK-OPER-UNT-ID                10040000
101200         AND K.ATTR_ELEM_TXT     = 'Y'                            10050000
101300                                        )                         10060000
101400             ORDER BY A.PO_LNE_NBR                                10070000
101500     END-EXEC.                                                    10080000
101600*CT END   01/28/09 IR #18061                                      10090000
101700                                                                  10100000
101800                                                                  10110000
101900*---------------------------------------------------------------* 10120000
102000*                                                               * 10130000
102100*---------------------------------------------------------------* 10140000
102200                                                                  10150000
102300                                                                  10160000
102400                                                                  10170000
102500                                                                  10180000
102600*---------------------------------------------------------------* 10190000
102700*    DB2 AREA FOR COMMUNICATIONS                                * 10200000
102800*---------------------------------------------------------------* 10210000
102900     EXEC SQL                                                     10220000
103000          INCLUDE SQLCA                                           10230000
103100     END-EXEC.                                                    10240000
103200                                                                  10250000
103300                                                                  10260000
103400***************************************************************** 10270000
103500 LINKAGE SECTION.                                                 10280000
103600                                                                  10290000
103700 01  DFHCOMMAREA.                                                 10300000
103800     05  FILLER                         OCCURS  1 TO 4072 TIMES   10310000
103900                                        DEPENDING ON EIBCALEN.    10320000
104000         10  FILLER                     PIC X.                    10330000
104100                                                                  10340000
104200                                                                  10350000
104300 PROCEDURE DIVISION.                                              10360000
104400******************************************************************10370000
104500**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **10380000
104600**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **10390000
104700**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **10400000
104800******************************************************************10410000
104900 0000-MAIN-MODULE.                                                10420000
105000     INITIALIZE DP030-CICS-API-FIELDS.                            10430000
105100     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       10440000
105200     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          10450000
105300     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         10460000
105400     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       10470000
105500     MOVE LENGTH OF SUK799I        TO DP030-MAP-LENGTH (1).       10480000
105600     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     10490000
105700     PERFORM 0001-CALL-CICS-ARCH-API.                             10500000
105800*                                                                 10510000
105900     PERFORM 1000-CONTROL-PROCESSING                              10520000
106000*                                                                 10530000
106100     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     10540000
106200     PERFORM 0001-CALL-CICS-ARCH-API.                             10550000
106300                                                                  10560000
106400******************************************************************10570000
106500**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **10580000
106600**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **10590000
106700******************************************************************10600000
106800 0001-CALL-CICS-ARCH-API.                                         10610000
106900*    CALL 'DPKCS030' USING DFHEIBLK                               10620002
106900     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      10621002
107000                           DFHCOMMAREA                            10630000
107100                           DP030-CICS-API-FIELDS                  10640000
107200                           DP020-STANDARD-COMMAREA                10650000
107300                           SUK799I.                               10660000
107400*                                                                 10670000
107500     IF  DP030-RC-CALL-SUCCESSFUL                                 10680000
107600         CONTINUE                                                 10690000
107700     ELSE                                                         10700000
107800         SET DP013-NO-ROLLBACK                                    10710000
107900             DP013-XCTL-DISPLAY-RESTART                           10720000
108000             DP013-CICS-ABEND      TO TRUE                        10730000
108100         MOVE '0001-CALL-CICS-ARCH-API'                           10740000
108200                                   TO DP013-PARAGRAPH             10750000
108300*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX10760002
108400*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      10770002
108300         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O10771002
108400-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      10772002
108500         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      10780000
108600         PERFORM DP013-0000-PROCESS-ABEND                         10790000
108700     END-IF.                                                      10800000
108800                                                                  10810000
108900*----------------------------------------------------------------*10820000
109000* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *10830000
109100* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *10840000
109200*                                                                *10850000
109300* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *10860000
109400*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *10870000
109500*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *10880000
109600*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *10890000
109700*----------------------------------------------------------------*10900000
109800 1000-CONTROL-PROCESSING.                                         10910000
109900     EVALUATE TRUE                                                10920000
110000         WHEN DP020-NEXT-ACT-INITIAL                              10930000
110100             INITIALIZE ASC-SPECIFIC-COMMAREA                     10940000
110200             MOVE EIBTRMID    TO ASC-LIST-TERM-ID                 10950000
110300                                 ASC-SEL-TERM-ID                  10960000
110400             MOVE DP020-SRC-TASK-NUMBER TO ASC-LIST-TASK-NUMBER   10970000
110500                                           ASC-SEL-TASK-NUMBER    10980000
110600             MOVE PC-LIST-QUEUE-SEQ TO ASC-LIST-SEQ               10990000
110700             MOVE PC-SEL-QUEUE-SEQ  TO ASC-SEL-SEQ                11000000
110800             PERFORM 1100-PROCESS-INTER-APPL-COMM                 11010000
110900             IF PS-NO-ERROR                                       11020000
111000             PERFORM 4000-BUILD-INITIAL-PANEL                     11030000
111100             END-IF                                               11040000
111200                                                                  11050000
111300         WHEN DP020-NEXT-ACT-READ-MAP                             11060000
111400             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         11070000
111500             PERFORM 2000-PROCESS-PANEL                           11080000
111600                                                                  11090000
111700         WHEN DP020-NEXT-ACT-RETURN                               11100000
111800             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         11110000
111900             MOVE ZERO  TO ASC-ITEM-AT-TOP-OF-PANEL               11120000
112000             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 11130000
112100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11140000
112200                                                                  11150000
112300         WHEN OTHER                                               11160000
112400             SET DP013-LOGIC-ABEND TO TRUE                        11170000
112500             SET DP013-NO-ROLLBACK TO TRUE                        11180000
112600             MOVE '1000-CONTROL-PROCESSING' TO DP013-PARAGRAPH    11190000
112700             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    11200000
112800                                   TO DP013-MESSAGE-TEXT(1)       11210000
112900             PERFORM DP013-0000-PROCESS-ABEND                     11220000
113000     END-EVALUATE.                                                11230000
113100                                                                  11240000
113200*----------------------------------------------------------------*11250000
113300* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *11260000
113400* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *11270000
113500*----------------------------------------------------------------*11280000
113600 1100-PROCESS-INTER-APPL-COMM.                                    11290000
113700                                                                  11300000
113800     SET PS-COMMAREA-VALID         TO TRUE.                       11310000
113900     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     11320000
114000     MOVE DP020-INT-APPL-FORMAT-IND TO ASC-INT-APPL-FORMAT-IND.   11330000
114100                                                                  11340000
114200     IF  ASC-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT            11350000
114300         MOVE SU097-OPER-UNT-ID        TO ASC-OPER-UNT-ID         11360000
114400                                          DK-OPER-UNT-ID          11370000
114500         MOVE SU097-FCLTY-NME          TO ASC-FCLTY-NAME          11380000
114600         MOVE SU097-PO-NBR             TO ASC-PO-NBR              11390000
114700         MOVE SU097-RCVR-SEQ-NBR       TO ASC-RCVR                11400000
114800         MOVE SU097-PO-LNE-NBR         TO ASC-PO-LNE-NBR          11410000
114900         MOVE SU097-PREPACK-ID         TO ASC-PREPK-ID            11420000
115000         MOVE SU097-AUD-CNTL-NBR       TO ASC-AUDIT-CNTL-NBR      11430000
115100         MOVE SU097-BRCDE-NBR          TO ASC-BRCDE-NBR           11440000
115200         MOVE SU097-PACK-TYPE          TO ASC-PACK-TYPE           11450000
115300         PERFORM 1200-DETERMINE-DATA-COMBO                        11460000
115400     ELSE                                                         11470000
115500         IF SU098-NUMBER-OF-SELECTED-ITEMS > 0                    11480000
115600            SET  ASC-USE-SELECTION-QUEUE TO TRUE                  11490000
115700            MOVE SU098-NUMBER-OF-SELECTED-ITEMS                   11500000
115800                               TO ASC-NUMBER-OF-SELECTED-ITEMS    11510000
115900            MOVE SU098-NUMBER-OF-TS-ITEMS                         11520000
116000                               TO ASC-NUMBER-OF-TS-ITEMS          11530000
116100            MOVE SU098-SEL-QUEUE-NAME                             11540000
116200                                   TO ASC-SEL-QUEUE-NAME          11550000
116300            MOVE SU098-OPER-UNT-ID        TO ASC-OPER-UNT-ID      11560000
116400                                             DK-OPER-UNT-ID       11570000
116500            MOVE SU098-PO-NBR             TO ASC-PO-NBR           11580000
116600            MOVE SU098-FCLTY-NME          TO ASC-FCLTY-NAME       11590000
116700            MOVE SU098-PACK-TYPE          TO ASC-PACK-TYPE        11600000
116800            PERFORM 1120-PREPARE-LIST-ENTRY                       11610000
116900            PERFORM 1200-DETERMINE-DATA-COMBO                     11620000
117000                                                                  11630000
117100         END-IF                                                   11640000
117200     END-IF.                                                      11650000
117300                                                                  11660000
117400*----------------------------------------------------------------*11670000
117500* ENTRY IS FROM A LIST.  GET THE MESSAGE NUMBER FROM THE TEMP    *11680000
117600* STORAGE QUEUE PASSED FROM THE LIST.                            *11690000
117700*----------------------------------------------------------------*11700000
117800 1120-PREPARE-LIST-ENTRY.                                         11710000
117900     MOVE SU099-MAX-ITEMS          TO ASC-SEL-SUB.                11720000
118000     MOVE ZERO                     TO ASC-SEL-ITEM.               11730000
118100     PERFORM 1130-GET-NEXT-RECORD.                                11740000
118200                                                                  11750000
118300*---------------------------------------------------------------- 11760000
118400*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*11770000
118500*---------------------------------------------------------------- 11780000
118600 1130-GET-NEXT-RECORD.                                            11790000
118700     ADD +1                        TO ASC-SEL-SUB.                11800000
118800                                                                  11810000
118900     SET ASC-UPDATE-TSQ TO TRUE.                                  11820000
119000                                                                  11830000
119100     IF  ASC-SEL-SUB > SU099-MAX-ITEMS                            11840000
119200         ADD +1                    TO ASC-SEL-ITEM                11850000
119300         MOVE +1                   TO ASC-SEL-SUB                 11860000
119400     END-IF.                                                      11870000
119500                                                                  11880000
119600     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                11890000
119700         PERFORM 9100-READ-SEL-QUEUE                              11900000
119800         IF  SU099-ITEM (ASC-SEL-SUB) > ZERO                      11910000
119900             PERFORM 1160-MOVE-TO-ASC                             11920000
120000             SET SU099-INQ (ASC-SEL-SUB) TO TRUE                  11930000
120100             PERFORM 9200-REWRITE-SEL-QUEUE                       11940000
120200         ELSE                                                     11950000
120300             SUBTRACT +1 FROM ASC-SEL-SUB                         11960000
120400             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            11970000
120500             SET DP020-MSG-INFORMATIONAL                          11980000
120600                 PS-LIST-END       TO TRUE                        11990000
120700         END-IF                                                   12000000
120800     ELSE                                                         12010000
120900         SUBTRACT +1 FROM ASC-SEL-ITEM                            12020000
121000         MOVE SU099-MAX-ITEMS      TO ASC-SEL-SUB                 12030000
121100         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            12040000
121200         SET DP020-MSG-INFORMATIONAL                              12050000
121300                 PS-LIST-END       TO TRUE                        12060000
121400     END-IF.                                                      12070000
121500                                                                  12080000
121600******************************************************************12090000
121700*  GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING         12100000
121800*  PROCESSED.                                                     12110000
121900******************************************************************12120000
122000 1140-GET-PREV-RECORD.                                            12130000
122100     SUBTRACT +1 FROM ASC-SEL-SUB.                                12140000
122200                                                                  12150000
122300     IF  ASC-SEL-SUB < +1                                         12160000
122400         SUBTRACT +1 FROM ASC-SEL-ITEM                            12170000
122500         MOVE SU099-MAX-ITEMS      TO ASC-SEL-SUB                 12180000
122600     END-IF.                                                      12190000
122700                                                                  12200000
122800     IF  ASC-SEL-ITEM > ZERO                                      12210000
122900         PERFORM 9100-READ-SEL-QUEUE                              12220000
123000         IF  SU099-ITEM (ASC-SEL-SUB) > ZERO                      12230000
123100             PERFORM 1160-MOVE-TO-ASC                             12240000
123200         END-IF                                                   12250000
123300                                                                  12260000
123400         SET SU099-INQ (ASC-SEL-SUB) TO TRUE                      12270000
123500         PERFORM 9200-REWRITE-SEL-QUEUE                           12280000
123600     ELSE                                                         12290000
123700         MOVE +1                   TO ASC-SEL-ITEM                12300000
123800                                      ASC-SEL-SUB                 12310000
123900         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            12320000
124000         SET DP020-MSG-INFORMATIONAL                              12330000
124100             PS-LIST-END             TO TRUE                      12340000
124200     END-IF.                                                      12350000
124300                                                                  12360000
124400 1160-MOVE-TO-ASC.                                                12370000
124500                                                                  12380000
124600     MOVE SU099-RCVR        (ASC-SEL-SUB)  TO ASC-RCVR.           12390000
124700                                                                  12400000
124800                                                                  12410000
124900                                                                  12420000
125000*----------------------------------------------------------------*12430000
125100*                                                                *12440000
125200*                                                                *12450000
125300*----------------------------------------------------------------*12460000
125400 1200-DETERMINE-DATA-COMBO.                                       12470000
125500                                                                  12480000
125600     EVALUATE TRUE                                                12490000
125700         WHEN ASC-BRCDE-NBR > 0                                   12500000
125800              SET ASC-RQST-BAR-CODE  TO TRUE                      12510000
125900              PERFORM 6900-SELECT-BAR-CODE                        12520000
126000              PERFORM 7000-SELECT-TRECEIV                         12530000
126100                                                                  12540000
126200         WHEN ASC-AUDIT-CNTL-NBR > 0                              12550000
126300              SET ASC-RQST-AUDIT     TO TRUE                      12560000
126400              PERFORM 7020-SELECT-AUD-CNTL-NBR                    12570000
126500              PERFORM 7000-SELECT-TRECEIV                         12580000
126600                                                                  12590000
126700         WHEN ASC-PREPK-ID  > 0                                   12600000
126800              SET ASC-RQST-PO-RCVR-PREPK TO TRUE                  12610000
126900              PERFORM 7000-SELECT-TRECEIV                         12620000
127000                                                                  12630000
127100              EVALUATE TRUE                                       12640000
127200                  WHEN ASC-BULK-CASE-ORDER                        12650000
127300                       SET DP020-NEXT-ACT-APPL-ERROR TO TRUE      12660000
127400                       SET DP020-MSG-FATAL   TO  TRUE             12670000
127500                       SET PS-ERROR          TO  TRUE             12680000
127600                       MOVE PC-TSYMSG-03642  TO  DP020-MSG-NUMBER 12690000
127700                                                                  12700000
127800                  WHEN ASC-PACK-BY-STORE-ORDER                    12710000
127900                       SET DP020-NEXT-ACT-APPL-ERROR TO TRUE      12720000
128000                       SET DP020-MSG-FATAL   TO  TRUE             12730000
128100                       SET PS-ERROR          TO  TRUE             12740000
128200                       MOVE PC-TSYMSG-03640  TO  DP020-MSG-NUMBER 12750000
128300                                                                  12760000
128400              END-EVALUATE                                        12770000
128500                                                                  12780000
128600         WHEN ASC-PO-LNE-NBR > 0                                  12790000
128700              SET ASC-RQST-PO-RCVR-LINE TO TRUE                   12800000
128800              PERFORM 7000-SELECT-TRECEIV                         12810000
128900                                                                  12820000
129000              EVALUATE TRUE                                       12830000
129100                  WHEN ASC-PREPK-ORDER                            12840000
129200                       SET DP020-NEXT-ACT-APPL-ERROR TO TRUE      12850000
129300                       SET DP020-MSG-FATAL   TO  TRUE             12860000
129400                       SET PS-ERROR          TO  TRUE             12870000
129500                       MOVE PC-TSYMSG-03641  TO  DP020-MSG-NUMBER 12880000
129600                                                                  12890000
129700                  WHEN ASC-PACK-BY-STORE-ORDER                    12900000
129800                       SET DP020-NEXT-ACT-APPL-ERROR TO TRUE      12910000
129900                       SET DP020-MSG-FATAL   TO  TRUE             12920000
130000                       SET PS-ERROR          TO  TRUE             12930000
130100                       MOVE PC-TSYMSG-03640  TO  DP020-MSG-NUMBER 12940000
130200                                                                  12950000
130300              END-EVALUATE                                        12960000
130400                                                                  12970000
130500         WHEN OTHER                                               12980000
130600              SET ASC-RQST-PO-RCVR TO TRUE                        12990000
130700              PERFORM 7000-SELECT-TRECEIV                         13000000
130800                                                                  13010000
130900     END-EVALUATE.                                                13020000
131000                                                                  13030000
131100     IF PS-NO-ERROR                                               13040000
131200        PERFORM 7040-SELECT-SCAC-TRAILER.                         13050000
131300                                                                  13060000
131400     IF PS-NO-ERROR                                               13070000
131500        PERFORM 7080-SELECT-EXPECTED-CARTONS.                     13080000
131600                                                                  13090000
131700     IF PS-NO-ERROR                                               13100000
131800        PERFORM 7090-DIRECTIVES-AVAIL.                            13110000
131900                                                                  13120000
132000     IF PS-NO-ERROR                                               13130000
132100        PERFORM 7100-SELECT-TRIPST.                               13140000
132200                                                                  13150000
132300*----------------------------------------------------------------*13160000
132400* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *13170000
132500* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *13180000
132600* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *13190000
132700* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *13200000
132800* FUNCTION KEYS CAN GET THIS FAR.                                *13210000
132900*----------------------------------------------------------------*13220000
133000 2000-PROCESS-PANEL.                                              13230000
133100     EVALUATE TRUE                                                13240000
133200         WHEN DP020-SRC-AID = DP016-CLEAR                         13250000
133300             MOVE ZERO TO ASC-ITEM-AT-TOP-OF-PANEL                13260000
133400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   13270000
133500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13280000
133600                                                                  13290000
133700         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    13300000
133800             PERFORM 2050-DELETE-LIST-QUEUE                       13310000
133900             PERFORM 4000-BUILD-INITIAL-PANEL                     13320000
134000                                                                  13330000
134100         WHEN DP020-FK-DESELECT (DP020-SRC-AID)                   13340000
134200             PERFORM 2140-DESELECT-ALL-ITEMS                      13350000
134300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13360000
134400                                                                  13370000
134500         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  13380000
134600             PERFORM 2150-SELECT-ALL-ITEMS                        13390000
134700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13400000
134800                                                                  13410000
134900*F20-NEXT SEL                                                     13420000
135000         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             13430000
135100             IF DP020-INT-APPL-FORMAT-IND = '2'                   13440000
135200               IF  ASC-USE-SELECTION-QUEUE                        13450000
135300                   PERFORM 1130-GET-NEXT-RECORD                   13460000
135400                   PERFORM 3000-EDIT-DATA-IN-COMMAREA             13470000
135500                   IF PS-LIST-END                                 13480000
135600                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN       13490000
135700                       SET PS-NO-LIST-END TO TRUE                 13500000
135800                   ELSE                                           13510000
135900                       PERFORM 2050-DELETE-LIST-QUEUE             13520000
136000                       PERFORM 3200-RESET-ATTRIBUTES              13530000
136100                       PERFORM 4000-BUILD-INITIAL-PANEL           13540000
136200                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN       13550000
136300                   END-IF                                         13560000
136400               ELSE                                               13570000
136500*                --- BOTTOM OF LIST ---                           13580000
136600                   MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER       13590000
136700                   SET DP020-MSG-INFORMATIONAL TO TRUE            13600000
136800               END-IF                                             13610000
136900           ELSE                                                   13620000
137000               MOVE PC-TSYMSG-00045 TO DP020-MSG-NUMBER           13630000
137100               SET DP020-MSG-FATAL TO TRUE                        13640000
137200           END-IF                                                 13650000
137300                                                                  13660000
137400*F19-PREV SEL                                                     13670000
137500         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             13680000
137600             IF DP020-INT-APPL-FORMAT-IND = '2'                   13690000
137700                IF  ASC-USE-SELECTION-QUEUE                       13700000
137800                   PERFORM 1140-GET-PREV-RECORD                   13710000
137900                   PERFORM 3000-EDIT-DATA-IN-COMMAREA             13720000
138000                   IF PS-LIST-END                                 13730000
138100                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN       13740000
138200                       SET PS-NO-LIST-END TO TRUE                 13750000
138300                   ELSE                                           13760000
138400                       PERFORM 2050-DELETE-LIST-QUEUE             13770000
138500                       PERFORM 3200-RESET-ATTRIBUTES              13780000
138600                       PERFORM 4000-BUILD-INITIAL-PANEL           13790000
138700                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN       13800000
138800                   END-IF                                         13810000
138900               ELSE                                               13820000
139000                   MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER       13830000
139100                   SET DP020-MSG-INFORMATIONAL TO TRUE            13840000
139200               END-IF                                             13850000
139300           ELSE                                                   13860000
139400               MOVE PC-TSYMSG-00045 TO DP020-MSG-NUMBER           13870000
139500               SET DP020-MSG-FATAL TO TRUE                        13880000
139600           END-IF                                                 13890000
139700                                                                  13900000
139800                                                                  13910000
139900         WHEN OTHER                                               13920000
140000             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 13930000
140100             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   13940000
140200             IF  PS-NO-ERROR                                      13950000
140300                 SET DP030-CONTINUE-GO TO TRUE                    13960000
140400                 PERFORM 2100-CHECK-FUNCTION-KEY                  13970000
140500             ELSE                                                 13980000
140600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             13990000
140700                 SET DP030-OVERRIDE-GO TO TRUE                    14000000
140800             END-IF                                               14010000
140900     END-EVALUATE.                                                14020000
141000                                                                  14030000
141100*----------------------------------------------------------------*14040000
141200*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *14050000
141300*----------------------------------------------------------------*14060000
141400 2050-DELETE-LIST-QUEUE.                                          14070000
141500                                                                  14080000
141600     EXEC CICS                                                    14090000
141700         DELETEQ TS                                               14100000
141800             QUEUE (ASC-LIST-QUEUE-NAME)                          14110000
141900             RESP  (PV-CICS-RESP)                                 14120000
142000     END-EXEC.                                                    14130000
142100                                                                  14140000
142200     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       14150000
142300        (PV-CICS-RESP = DFHRESP(QIDERR))                          14160000
142400         CONTINUE                                                 14170000
142500     ELSE                                                         14180000
142600         SET DP013-CICS-ABEND      TO TRUE                        14190000
142700         SET DP013-NO-ROLLBACK     TO TRUE                        14200000
142800                                                                  14210000
142900         MOVE '2050-DELETE-LIST-QUEUE' TO DP013-PARAGRAPH         14220000
143000         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    14230000
143100                                   TO DP013-MESSAGE-TEXT (1)      14240000
143200         PERFORM DP013-0000-PROCESS-ABEND                         14250000
143300     END-IF.                                                      14260000
143400                                                                  14270000
143500     MOVE +0  TO ASC-HIGHEST-BLOCK-WRITTEN.                       14280000
143600                                                                  14290000
143700*----------------------------------------------------------------*14300000
143800* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*14310000
143900* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *14320000
144000* CICS ARCHITECTURE API.                                         *14330000
144100*----------------------------------------------------------------*14340000
144200 2100-CHECK-FUNCTION-KEY.                                         14350000
144300                                                                  14360000
144400     EVALUATE TRUE                                                14370000
144500                                                                  14380000
144600*CT BEGIN 02/03/09 IR #18061                                      14390000
144700* F2 - CONFIRM UPDATE                                             14400000
144800         WHEN DP020-FK-CONFIRM  (DP020-SRC-AID)                   14410000
144900              AND ASC-F2-CONFIRM-SW = ' '                         14420000
145100                  PERFORM 4400-MOVE-COMMAREA-TO-SCREEN            14430000
145201                  SET DP030-OVERRIDE-GO TO TRUE                   14440000
145202                  MOVE PC-TSYMSG-00045  TO DP020-MSG-NUMBER       14450000
145203                  SET DP020-MSG-WARNING TO TRUE                   14460000
145204*CT END   02/03/09 IR #18061                                      14470000
145205                                                                  14480000
145206* F24 -  INQ/UPD (LOCAL-FUNC-04) SULDIRCN                         14490000
145207*             SUKCS765 - DIRECTIVE RELEASE CARTON LIST            14500000
145208         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              14510000
145209             MOVE DP020-LOCATION-NBR TO DK-OPER-UNT-ID            14520000
145210             IF ASC-OPER-UNT-ID = DK-OPER-UNT-ID                  14520100
145220                 IF ASC-NUMBER-OF-SELECTED-ITEMS > 0              14520200
145230                     SET ASC-USE-SELECTION-QUEUE TO TRUE          14520300
145240                     MOVE ASC-NUMBER-OF-SELECTED-ITEMS            14520400
145250                                TO SU098-NUMBER-OF-SELECTED-ITEMS 14520500
145260                     MOVE ASC-NUMBER-OF-TS-ITEMS                  14520600
145270                                      TO SU098-NUMBER-OF-TS-ITEMS 14520700
145280                     MOVE ASC-SEL-QUEUE-NAME                      14520800
145290                                         TO  SU098-SEL-QUEUE-NAME 14520900
145300                     MOVE DP020-LOCATION-NBR TO DK-OPER-UNT-ID    14521000
145400                     MOVE ASC-OPER-UNT-ID  TO SU098-OPER-UNT-ID   14522000
145500                     MOVE ASC-FCLTY-NAME   TO SU098-FCLTY-NME     14523000
145600                     MOVE 1                TO SU098-FCLTY-ID      14524000
145700                     MOVE ASC-PO-NBR       TO SU098-PO-NBR        14525000
145800                     PERFORM 5000-PREPARE-SEL-QUEUE               14526000
145900                 ELSE                                             14527000
146000                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         14528000
146100                     SET DP030-OVERRIDE-GO TO TRUE                14529000
146200                     MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER    14530000
146300                     SET DP020-MSG-FATAL   TO TRUE                14540000
146400                 END-IF                                           14550000
146500             ELSE                                                 14560000
146600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             14570000
146700                 SET DP030-OVERRIDE-GO TO TRUE                    14580000
146800                 MOVE PC-TSYMSG-02571  TO DP020-MSG-NUMBER        14590000
146900                 SET PS-ERROR                                     14600000
147000                     DP020-MSG-FATAL   TO TRUE                    14610000
147100             END-IF                                               14620000
147200* F2 - CONFIRM UPDATE                                             14630000
147300         WHEN DP020-FK-CONFIRM  (DP020-SRC-AID)                   14640000
147400              AND ASC-F2-CONFIRM-YES                              14650000
147500               IF ASC-NUMBER-OF-SELECTED-ITEMS > 0                14660000
147600                  PERFORM 2800-PROCESS-UPDATES                    14670000
147700                          VARYING PV-ITEM FROM 1 BY 1             14680000
147800                            UNTIL PV-ITEM >                       14690000
147900                                     ASC-HIGHEST-BLOCK-WRITTEN    14700000
148000                               OR PS-ERROR                        14710000
148100                                                                  14720000
148200                  IF PS-NO-ERROR                                  14730000
148300                     MOVE PC-TSYMSG-03657  TO DP020-MSG-NUMBER    14740000
148400                     SET DP030-OVERRIDE-GO TO TRUE                14750000
148500                     SET DP020-MSG-WARNING TO TRUE                14760000
148600                     SET DP030-DONT-ERASE                         14770000
148700                         DP030-SEND-DATAONLY (1)  TO TRUE         14780000
148800                                                                  14790000
148900**??  17860 IR REFRESH AFTER RELEASE                              14800000
149000**??        FOLLOWING 2 LINES ADDED AND PREVIOUS 2 LINES TO       14810000
149100**??        SEND THE NEW DATA                                     14820000
149200                     PERFORM 2050-DELETE-LIST-QUEUE               14830000
149300                     PERFORM 4000-BUILD-INITIAL-PANEL             14840000
149400                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         14850000
149500                  END-IF                                          14860000
149600               ELSE                                               14870000
149700*CT BEGIN 02/03/09 IR 18061                                       14880000
149800                  PERFORM 4400-MOVE-COMMAREA-TO-SCREEN            14890000
149900*CT END   02/03/09 IR 18061                                       14900000
150000                  SET DP030-OVERRIDE-GO TO TRUE                   14910000
150100                  MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER       14920000
150200                  SET DP020-MSG-WARNING TO TRUE                   14930000
150300               END-IF                                             14940000
150400                                                                  14950000
150500* F15 -  RELEASE (LOCAL-FUNC-01)                                  14960000
150600         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              14970000
150700            MOVE DP020-LOCATION-NBR TO DK-OPER-UNT-ID             14980000
150800            IF ASC-OPER-UNT-ID = DK-OPER-UNT-ID                   14990000
150900*CT BEGIN 02/03/09 IR #18061                                      15000000
151000                IF ASC-NUMBER-OF-SELECTED-ITEMS > 0               15010000
151100                    SET ASC-F2-CONFIRM-NO  TO TRUE                15020000
151200                    PERFORM 7200-RACF-ACCESS                      15030000
151300                    IF PS-RELEASE-ALLOWED                         15040000
151400                        SET ASC-F2-CONFIRM-YES TO TRUE            15050000
151500                        SET PS-ERROR                              15060000
151600                            DP020-MSG-FATAL   TO TRUE             15070000
151700*CT BEGIN 01/30/09 IR 12315                                       15080000
151800                        PERFORM 4400-MOVE-COMMAREA-TO-SCREEN      15090000
151900*CT END   01/30/09 IR 12315                                       15100000
152000                        MOVE PC-TSYMSG-03643 TO DP020-MSG-NUMBER  15110000
152100                        MOVE -1              TO MR-SELECTL (1)    15120000
152200                        SET DP030-SET-CURSOR-APPL-1 TO TRUE       15130000
152300                    ELSE                                          15140000
152400                       SET DP030-OVERRIDE-GO TO TRUE              15150000
152500                       MOVE PC-TSYMSG-03646  TO DP020-MSG-NUMBER  15160000
152600                       SET PS-ERROR                               15170000
152700                           DP020-MSG-FATAL   TO TRUE              15180000
152800                       SET DP030-SET-CURSOR-APPL-1 TO TRUE        15190000
152900                       MOVE -1              TO MR-SELECTL (1)     15200000
153000                    END-IF                                        15210000
153100                ELSE                                              15220000
153200                    PERFORM 4400-MOVE-COMMAREA-TO-SCREEN          15230000
153300                    SET DP030-OVERRIDE-GO TO TRUE                 15240000
153400                    MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER     15250000
153500                    SET DP020-MSG-FATAL   TO TRUE                 15260000
153600                END-IF                                            15270000
153700*CT END   02/03/09 IR #18061                                      15280000
153800            ELSE                                                  15290000
153810                PERFORM 4400-MOVE-COMMAREA-TO-SCREEN              15300000
153820                SET DP030-OVERRIDE-GO TO TRUE                     15310000
153830                MOVE PC-TSYMSG-03645  TO DP020-MSG-NUMBER         15320000
153840                SET PS-ERROR                                      15330000
153850                    DP020-MSG-FATAL   TO TRUE                     15340000
153860            END-IF                                                15350000
153870                                                                  15360000
153880* F6 - FIRST PAGE                                                 15370000
153890         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  15380000
153900             MOVE +1               TO PV-TOP-ITEM                 15381000
154000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 15382000
154100                                                                  15383000
154200* F7 - PREVIOUS PAGE                                              15384000
154300         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   15385000
154400             PERFORM 2110-BROWSE-BACKWARD                         15386000
154500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 15387000
154600                                                                  15388000
154700* F8 - NEXT PAGE                                                  15389000
154800         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   15390000
154900             PERFORM 2120-BROWSE-FORWARD                          15400000
155000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 15410000
155100                                                                  15420000
155200* ENTER KEY                                                       15430000
155300         WHEN DP020-SRC-AID = DP016-ENTER                         15440000
155400             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   15450000
155500             IF  PS-ERROR                                         15460000
155600                 CONTINUE                                         15470000
155700             ELSE                                                 15480000
155800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             15490000
155900             END-IF                                               15500000
156000                                                                  15510000
156100         WHEN OTHER                                               15520000
156200             SET DP013-NO-ROLLBACK                                15530000
156300                 DP013-XCTL-DISPLAY-RESTART                       15540000
156400                 DP013-CICS-ABEND  TO TRUE                        15550000
156500             MOVE '2100-CHECK-FUNCTION-KEY' TO DP013-PARAGRAPH    15560000
156600             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      15570000
156700                                   TO DP013-MESSAGE-TEXT (1)      15580000
156800             PERFORM DP013-0000-PROCESS-ABEND                     15590000
156900     END-EVALUATE.                                                15600000
157000                                                                  15610000
157100******************************************************************15620000
157200** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **15630000
157300** INTER-APPLICATION COMMAREA.                                  **15640000
157400******************************************************************15650000
157500 2110-PREPARE-INTER-APPL-COMM.                                    15660000
157600                                                                  15670000
157700     INITIALIZE SU097-INTER-APPL-COMMAREA.                        15680000
157800                                                                  15690000
157900     MOVE DP020-LOCATION-NBR       TO DK-OPER-UNT-ID.             15700000
158000     MOVE ASC-OPER-UNT-ID          TO SU097-OPER-UNT-ID.          15710000
158100     MOVE ASC-FCLTY-NAME           TO SU097-FCLTY-NME.            15720000
158200                                                                  15730000
158300*----------------------------------------------------------------*15740000
158400*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *15750000
158500*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *15760000
158600*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *15770000
158700*    MESSAGE.                                                    *15780000
158800*----------------------------------------------------------------*15790000
158900 2110-BROWSE-BACKWARD.                                            15800000
159000     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    15810000
159100         GIVING PV-TOP-ITEM.                                      15820000
159200*                                                                 15830000
159300     IF  ((PV-TOP-ITEM < +1)                                      15840000
159400       OR (PV-TOP-ITEM = +1))                                     15850000
159500         MOVE +1                   TO PV-TOP-ITEM                 15860000
159600*        -- TOP OF LIST --                                        15870000
159700         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            15880000
159800         SET DP020-MSG-INFORMATIONAL TO TRUE                      15890000
159900     END-IF.                                                      15900000
160000                                                                  15910000
160100*----------------------------------------------------------------*15920000
160200*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *15930000
160300*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *15940000
160400*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *15950000
160500*----------------------------------------------------------------*15960000
160600 2120-BROWSE-FORWARD.                                             15970000
160700     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              15980000
160800         GIVING PV-TOP-ITEM.                                      15990000
160900     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   16000000
161000         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             16010000
161100*        -- BOTTOM OF LIST --                                     16020000
161200         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            16030000
161300         SET DP020-MSG-INFORMATIONAL TO TRUE                      16040000
161400     ELSE                                                         16050000
161500         COMPUTE PV-BOTTOM-ITEM =                                 16060000
161600             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 16070000
161700         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            16080000
161800*            -- BOTTOM OF LIST --                                 16090000
161900             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            16100000
162000             SET DP020-MSG-INFORMATIONAL TO TRUE                  16110000
162100         END-IF                                                   16120000
162200     END-IF.                                                      16130000
162300                                                                  16140000
162400*----------------------------------------------------------------*16150000
162500*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *16160000
162600*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *16170000
162700*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *16180000
162800*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *16190000
162900*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *16200000
163000*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *16210000
163100*----------------------------------------------------------------*16220000
163200 2130-CHECK-FOR-JUMP-BROWSE.                                      16230000
163300     SET PS-NO-ERROR               TO TRUE.                       16240000
163400     IF (ASC-START-ITEM-REQUEST = SPACE)                          16250000
163500         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             16260000
163600     ELSE                                                         16270000
163700         MOVE ASC-START-ITEM-REQUEST TO DP010I-UNEDITED-FIELD     16280000
163800         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       16290000
163900         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     16300000
164000         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  16310000
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         16321001
263968              USING DP010I-NUMERIC-EDIT-AREA                      16322001
164200                                                                  16330000
164300         IF  NOT DP010I-ERROR-DETECTED                            16340000
164400             MOVE DP010I-NUMERIC-FIELD TO ASC-START-ITEM-REQUEST-N16350000
164500             IF  ASC-START-ITEM-REQUEST-N > ZERO                  16360000
164600                 IF  ASC-START-ITEM-REQUEST-N >                   16370000
164700                                          ASC-NUMBER-OF-ITEMS-READ16380000
164800                     MOVE SPACE TO ASC-START-ITEM-REQUEST         16390000
164900                     COMPUTE PV-TOP-ITEM =                        16400000
165000                             ASC-NUMBER-OF-ITEMS-READ             16410000
165100                             - PC-ITEMS-PER-PANEL + 1             16420000
165200                     IF  PV-TOP-ITEM < +1                         16430000
165300                         MOVE +1   TO PV-TOP-ITEM                 16440000
165400                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 16450000
165500                         SET DP020-MSG-INFORMATIONAL TO TRUE      16460000
165600                     END-IF                                       16470000
165700                 ELSE                                             16480000
165800                     MOVE ASC-START-ITEM-REQUEST-N                16490000
165900                                   TO PV-TOP-ITEM                 16500000
166000                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      16510000
166100                     COMPUTE PV-BOTTOM-ITEM =                     16520000
166200                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     16530000
166300                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ16540000
166400*                        -- BOTTOM OF LIST --                     16550000
166500                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 16560000
166600                         SET DP020-MSG-INFORMATIONAL TO TRUE      16570000
166700                     END-IF                                       16580000
166800                 END-IF                                           16590000
166900             ELSE                                                 16600000
167000*                --- VALUE OUT OF RANGE ----                      16610000
167100                 MOVE PC-TSYMSG-00101 TO DP020-MSG-NUMBER         16620000
167200                 MOVE -1              TO ASTRTITL                 16630000
167300                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              16640000
167400                 MOVE DP015-REVERSE   TO ASTRTITH                 16650000
167500                 MOVE DP015-RED       TO ASTRTITC                 16660000
167600                 MOVE DP015-UNP-NUM-BRT-MDT TO ASTRTITA           16670000
167700                 SET DP020-MSG-FATAL  TO TRUE                     16680000
167800                 SET PS-ERROR         TO TRUE                     16690000
167900             END-IF                                               16700000
168000         ELSE                                                     16710000
168100             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            16720000
168200             MOVE -1               TO ASTRTITL                    16730000
168300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  16740000
168400             MOVE DP015-REVERSE    TO ASTRTITH                    16750000
168500             MOVE DP015-RED        TO ASTRTITC                    16760000
168600             MOVE DP015-UNP-NUM-BRT-MDT TO ASTRTITA               16770000
168700             SET DP020-MSG-FATAL   TO TRUE                        16780000
168800             SET PS-ERROR          TO TRUE                        16790000
168900         END-IF                                                   16800000
169000     END-IF.                                                      16810000
169100                                                                  16820000
169200*----------------------------------------------------------------*16830000
169300*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *16840000
169400*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *16850000
169500*----------------------------------------------------------------*16860000
169600 2140-DESELECT-ALL-ITEMS.                                         16870000
169700     MOVE +1                       TO ASC-BLK-SUB.                16880000
169800                                                                  16890000
169900     PERFORM 2141-CLEAR-SELECTED-INDS                             16900000
170000         VARYING ASC-ITEM-SUB                                     16910000
170100         FROM 1 BY 1                                              16920000
170200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 16930000
170300                                                                  16940000
170400     ADD +1                        TO ASC-BLK-SUB.                16950000
170500                                                                  16960000
170600     PERFORM 2141-CLEAR-SELECTED-INDS                             16970000
170700         VARYING ASC-ITEM-SUB                                     16980000
170800         FROM 1 BY 1                                              16990000
170900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 17000000
171000                                                                  17010000
171100     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               17020000
171200                                   TO PV-LIST-ITEM-NUMBER.        17030000
171300                                                                  17040000
171400     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            17050000
171500         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    17060000
171600                                                                  17070000
171700     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            17080000
171800         MOVE +1                   TO ASC-BLK-SUB                 17090000
171900                                                                  17100000
172000         PERFORM 5100-WRITE-TEMP-STORAGE                          17110000
172100         MOVE +2                   TO ASC-BLK-SUB                 17120000
172200         PERFORM 5100-WRITE-TEMP-STORAGE                          17130000
172300         MOVE +1                   TO ASC-BLK-SUB                 17140000
172400         MOVE +1                   TO PV-BLOCK-NUMBER             17150000
172500     END-IF.                                                      17160000
172600                                                                  17170000
172700     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     17180000
172800        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      17190000
172900         MOVE +1                   TO ASC-BLK-SUB                 17200000
173000                                                                  17210000
173100         PERFORM 5100-WRITE-TEMP-STORAGE                          17220000
173200         MOVE +2  TO ASC-BLK-SUB                                  17230000
173300         PERFORM 5100-WRITE-TEMP-STORAGE                          17240000
173400         MOVE +1  TO ASC-BLK-SUB                                  17250000
173500         MOVE +1  TO PV-BLOCK-NUMBER                              17260000
173600                                                                  17270000
173700         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         17280000
173800             PV-FIRST-BLOCK-IN-ARRAY - 1                          17290000
173900                                                                  17300000
174000         PERFORM                                                  17310000
174100             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       17320000
174200                                                                  17330000
174300             PERFORM 4410-READ-TEMP-STORAGE                       17340000
174400                                                                  17350000
174500             PERFORM 2141-CLEAR-SELECTED-INDS                     17360000
174600                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 17370000
174700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          17380000
174800                                                                  17390000
174900             PERFORM 5100-WRITE-TEMP-STORAGE                      17400000
175000                                                                  17410000
175100             ADD +1                TO PV-BLOCK-NUMBER             17420000
175200                                                                  17430000
175300         END-PERFORM                                              17440000
175400                                                                  17450000
175500         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         17460000
175600             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     17470000
175700                                                                  17480000
175800         PERFORM                                                  17490000
175900             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       17500000
176000                   ASC-HIGHEST-BLOCK-WRITTEN                      17510000
176100                                                                  17520000
176200             MOVE PV-NEXT-BLOCK-IN-ARRAY                          17530000
176300                                   TO PV-BLOCK-NUMBER             17540000
176400                                                                  17550000
176500             PERFORM 4410-READ-TEMP-STORAGE                       17560000
176600                                                                  17570000
176700             PERFORM 2141-CLEAR-SELECTED-INDS                     17580000
176800                 VARYING ASC-ITEM-SUB                             17590000
176900                 FROM 1 BY 1                                      17600000
177000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          17610000
177100                                                                  17620000
177200             PERFORM 5100-WRITE-TEMP-STORAGE                      17630000
177300                                                                  17640000
177400             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      17650000
177500                                                                  17660000
177600         END-PERFORM                                              17670000
177700                                                                  17680000
177800         MOVE PV-FIRST-BLOCK-IN-ARRAY                             17690000
177900                                   TO PV-BLOCK-NUMBER             17700000
178000                                                                  17710000
178100         PERFORM 4410-READ-TEMP-STORAGE                           17720000
178200     END-IF.                                                      17730000
178300                                                                  17740000
178400     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 17750000
178500     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.17760000
178600     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  17770000
178700                                                                  17780000
178800     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        17790000
178900                                                                  17800000
179000*----------------------------------------------------------------*17810000
179100*    MARK EACH ITEM AS BEING NOT SELECTED.                       *17820000
179200*----------------------------------------------------------------*17830000
179300 2141-CLEAR-SELECTED-INDS.                                        17840000
179400     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           17850000
179500             NOT EQUAL ZERO                                       17860000
179600         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          17870000
179700             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          17880000
179800                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    17890000
179900                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE          17900000
180000         END-IF                                                   17910000
180100     END-IF.                                                      17920000
180200                                                                  17930000
180300*----------------------------------------------------------------*17940000
180400*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTION SWITCH *17950000
180500*  FOR ALL ITEMS.                                                *17960000
180600*----------------------------------------------------------------*17970000
180700 2150-SELECT-ALL-ITEMS.                                           17980000
180800     MOVE +1                       TO ASC-BLK-SUB.                17990000
180900                                                                  18000000
181000     PERFORM 2151-SET-SELECTED-INDS                               18010000
181100         VARYING ASC-ITEM-SUB                                     18020000
181200         FROM 1 BY 1                                              18030000
181300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 18040000
181400                                                                  18050000
181500     ADD +1                        TO ASC-BLK-SUB.                18060000
181600                                                                  18070000
181700     PERFORM 2151-SET-SELECTED-INDS                               18080000
181800         VARYING ASC-ITEM-SUB                                     18090000
181900         FROM 1 BY 1                                              18100000
182000         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 18110000
182100                                                                  18120000
182200     MOVE ASC-LIST-ITEM-NUMBER(1 1)  TO PV-LIST-ITEM-NUMBER.      18130000
182300                                                                  18140000
182400     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            18150000
182500         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    18160000
182600                                                                  18170000
182700     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            18180000
182800         MOVE +1                   TO ASC-BLK-SUB                 18190000
182900                                                                  18200000
183000         PERFORM 5100-WRITE-TEMP-STORAGE                          18210000
183100         MOVE +2                   TO ASC-BLK-SUB                 18220000
183200         PERFORM 5100-WRITE-TEMP-STORAGE                          18230000
183300         MOVE +1                   TO ASC-BLK-SUB                 18240000
183400         MOVE +1                   TO PV-BLOCK-NUMBER             18250000
183500     END-IF.                                                      18260000
183600     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     18270000
183700        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    18280000
183800         MOVE +1                   TO ASC-BLK-SUB                 18290000
183900                                                                  18300000
184000         PERFORM 5100-WRITE-TEMP-STORAGE                          18310000
184100                                                                  18320000
184200         MOVE +1                   TO PV-BLOCK-NUMBER             18330000
184300                                                                  18340000
184400         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         18350000
184500             PV-FIRST-BLOCK-IN-ARRAY - 1                          18360000
184600                                                                  18370000
184700         PERFORM                                                  18380000
184800             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       18390000
184900                                                                  18400000
185000             PERFORM 4410-READ-TEMP-STORAGE                       18410000
185100                                                                  18420000
185200             PERFORM 2151-SET-SELECTED-INDS                       18430000
185300                 VARYING ASC-ITEM-SUB                             18440000
185400                 FROM 1 BY 1                                      18450000
185500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          18460000
185600                                                                  18470000
185700             PERFORM 5100-WRITE-TEMP-STORAGE                      18480000
185800                                                                  18490000
185900             ADD +1                TO PV-BLOCK-NUMBER             18500000
186000                                                                  18510000
186100         END-PERFORM                                              18520000
186200                                                                  18530000
186300         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         18540000
186400             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     18550000
186500                                                                  18560000
186600         PERFORM                                                  18570000
186700             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       18580000
186800                   ASC-HIGHEST-BLOCK-WRITTEN                      18590000
186900                                                                  18600000
187000             MOVE PV-NEXT-BLOCK-IN-ARRAY                          18610000
187100                                   TO PV-BLOCK-NUMBER             18620000
187200                                                                  18630000
187300             PERFORM 4410-READ-TEMP-STORAGE                       18640000
187400                                                                  18650000
187500             PERFORM 2151-SET-SELECTED-INDS                       18660000
187600                 VARYING ASC-ITEM-SUB                             18670000
187700                 FROM 1 BY 1                                      18680000
187800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          18690000
187900                                                                  18700000
188000             PERFORM 5100-WRITE-TEMP-STORAGE                      18710000
188100                                                                  18720000
188200             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      18730000
188300                                                                  18740000
188400         END-PERFORM                                              18750000
188500                                                                  18760000
188600         MOVE PV-FIRST-BLOCK-IN-ARRAY  TO PV-BLOCK-NUMBER         18770000
188700                                                                  18780000
188800         PERFORM 4410-READ-TEMP-STORAGE                           18790000
188900     END-IF.                                                      18800000
189000                                                                  18810000
189100     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             18820000
189200                       ASC-NUMBER-OF-SELECTED-ITEMS.              18830000
189300                                                                  18840000
189400     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        18850000
189500                                                                  18860000
189600*----------------------------------------------------------------*18870000
189700*    MARK EACH ITEM AS BEING SELECTED.                           *18880000
189800*----------------------------------------------------------------*18890000
189900 2151-SET-SELECTED-INDS.                                          18900000
190000     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           18910000
190100             NOT EQUAL ZERO                                       18920000
190200         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             18930000
190300             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             18940000
190400                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        18950000
190500                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  18960000
190600                               TO  TRUE                           18970000
190700         END-IF                                                   18980000
190800     END-IF.                                                      18990000
190900                                                                  19000000
191000******************************************************************19010000
191100** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **19020000
191200** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **19030000
191300******************************************************************19040000
191400 2200-MOVE-SCREEN-TO-COMMAREA.                                    19050000
191500                                                                  19060000
191600     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             19070000
191700     MOVE +1                       TO PV-SUB.                     19080000
191800*                                                                 19090000
191900     PERFORM 3100-SET-SUBSCRIPTS.                                 19100000
192000                                                                  19110000
192100     IF  ASTRTITL > ZERO                                          19120000
192200         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          19130000
192300     ELSE                                                         19140000
192400         IF  ASTRTITF = DP015-ERASE-EOF                           19150000
192500             INITIALIZE ASC-START-ITEM-REQUEST                    19160000
192600         END-IF                                                   19170000
192700     END-IF.                                                      19180000
192800                                                                  19190000
192900     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          19200000
193000         VARYING PV-SUB FROM 1 BY 1                               19210000
193100         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      19220000
193200                                                                  19230000
193300******************************************************************19240000
193400** MOVE THE ENTERABLE FIELDS OF EACH LIST LINE INTO THE COMMAREA**19250000
193500******************************************************************19260000
193600 2210-MOVE-LINES-TO-COMMAREA.                                     19270000
193700     IF  MR-SELECTL (PV-SUB) > ZERO                               19280000
193800         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             19290000
193900         MOVE MR-SELECTI (PV-SUB)  TO ASC-TEMP-SELECTED-SW        19300000
194000                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 19310000
194100*        MOVE MR-CTN-NOT-RCVD  (PV-SUB)  TO                       19320000
194200*                                     ASC-CTN-NOT-RCVD            19330000
194300*                                     (ASC-BLK-SUB, ASC-ITEM-SUB) 19340000
194400     ELSE                                                         19350000
194500         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                19360000
194600             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE         19370000
194700             MOVE SPACE  TO ASC-TEMP-SELECTED-SW                  19380000
194800                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 19390000
194900*            MOVE SPACE  TO ASC-CTN-NOT-RCVD                      19400000
195000*                                     (ASC-BLK-SUB, ASC-ITEM-SUB) 19410000
195100         END-IF                                                   19420000
195200     END-IF.                                                      19430000
195300     IF  MR-CTN-NOT-RCVDL (PV-SUB) > ZERO                         19440000
195400         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             19450000
195500         MOVE MR-CTN-NOT-RCVD  (PV-SUB)  TO                       19460000
195600                                      ASC-CTN-NOT-RCVD            19470000
195700                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 19480000
195800     ELSE                                                         19490000
195900         IF  MR-CTN-NOT-RCVDA (PV-SUB) = DP015-ERASE-EOF          19500000
196000             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE         19510000
196100             MOVE SPACE  TO ASC-CTN-NOT-RCVD                      19520000
196200                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 19530000
196300         END-IF                                                   19540000
196400     END-IF.                                                      19550000
196500                                                                  19560000
196600     ADD +1                        TO ASC-ITEM-SUB.               19570000
196700     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        19580000
196800         ADD +1                    TO ASC-BLK-SUB                 19590000
196900         MOVE +1                   TO ASC-ITEM-SUB                19600000
197000     END-IF.                                                      19610000
197100                                                                  19620000
197200******************************************************************19630000
197300*                                                                 19640000
197400*                                                                 19650000
197500******************************************************************19660000
197600 2800-PROCESS-UPDATES.                                            19670000
197700                                                                  19680000
197800     MOVE +1                       TO ASC-BLK-SUB.                19690000
197900     PERFORM 5100-WRITE-TEMP-STORAGE.                             19700000
198000     ADD +1                        TO ASC-BLK-SUB.                19710000
198100     PERFORM 5100-WRITE-TEMP-STORAGE.                             19720000
198200                                                                  19730000
198300     PERFORM 6112-READ-LIST-QUEUE.                                19740000
198400                                                                  19750000
198500     SET  LQW-IDX  TO   1.                                        19760000
198600                                                                  19770000
198700     IF PV-CICS-RESP = DFHRESP (NORMAL)                           19780000
198800         PERFORM                                                  19790000
198900         VARYING LQW-IDX  FROM 1 BY 1                             19800000
199000         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL                     19810000
199100            OR   LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            19820000
199200            OR   PS-ERROR                                         19830000
199300             IF  LQW-SELECT (LQW-IDX)                             19840000
199400                 PERFORM 2820-PROCESS-SELECTIONS                  19850000
199500             END-IF                                               19860000
199600         END-PERFORM                                              19870000
199700     END-IF.                                                      19880000
199800                                                                  19890000
199900     MOVE PV-ITEM      TO PV-SAVE-ITEM.                           19900000
200000     PERFORM 6111-WRITE-LIST-QUEUE.                               19910000
200100                                                                  19920000
200200     MOVE +1                     TO  ASC-BLK-SUB.                 19930000
200300     PERFORM 4410-READ-TEMP-STORAGE.                              19940000
200400                                                                  19950000
200500     ADD +1                      TO  ASC-BLK-SUB                  19960000
200600                                     PV-BLOCK-NUMBER.             19970000
200700                                                                  19980000
200800     PERFORM 4410-READ-TEMP-STORAGE.                              19990000
200900                                                                  20000000
201000******************************************************************20010000
201100*                                                                 20020000
201200*                                                                 20030000
201300******************************************************************20040000
201400 2820-PROCESS-SELECTIONS.                                         20050000
201500                                                                  20060000
201600     PERFORM 7400-BUILD-REQUEST.                                  20070000
201700     PERFORM 7500-CALL-SUKUT129.                                  20080000
201800                                                                  20090000
201900                                                                  20100000
202000******************************************************************20110000
202100** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **20120000
202200** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **20130000
202300******************************************************************20140000
202400 3000-EDIT-DATA-IN-COMMAREA.                                      20150000
202500     PERFORM 3200-RESET-ATTRIBUTES.                               20160000
202600     SET PS-NO-ERROR               TO TRUE.                       20170000
202700     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     20180000
202800                                                                  20190000
202900* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              20200000
203000* EDITTING IS DONE FROM THE BOTTOM UP.                            20210000
203100**                                                                20220000
203200     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       20230000
203300         ASC-ITEMS-DISPLAYED - 1.                                 20240000
203400     PERFORM 3100-SET-SUBSCRIPTS.                                 20250000
203500                                                                  20260000
203600      IF  PS-NO-ERROR                                             20270000
203700          PERFORM 3005-EDIT-COMMAREA-BLOCKS                       20280000
203800      END-IF.                                                     20290000
203900                                                                  20300000
204000     IF  PS-NO-ERROR                                              20310000
204100         PERFORM 3400-CHECK-RANGE-SEQUENCE                        20320000
204200     END-IF.                                                      20330000
204300                                                                  20340000
204400     IF  ((PS-NO-ERROR)                                           20350000
204500       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   20360000
204600       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    20370000
204700             PERFORM 3500-MARK-RANGE-AS-SELECTED                  20380000
204800     END-IF.                                                      20390000
204900                                                                  20400000
205000*----------------------------------------------------------------*20410000
205100* 3005-EDIT-COMMAREA-BLOCKS                                      *20420000
205200*----------------------------------------------------------------*20430000
205300 3005-EDIT-COMMAREA-BLOCKS.                                       20440000
205400     MOVE +1                       TO PV-BLOCK-NUMBER.            20450000
205500     MOVE +1                       TO ASC-BLK-SUB.                20460000
205600     MOVE PC-ITEMS-PER-PANEL       TO ASC-ITEM-SUB.               20470000
205700                                                                  20480000
205800     COMPUTE PV-BLOCK-NUMBER  =                                   20490000
205900             1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /            20500000
206000             PC-ITEMS-PER-PANEL.                                  20510000
206100                                                                  20520000
206200     MOVE  PV-BLOCK-NUMBER         TO PV-ORIGINAL-BLOCK.          20530000
206300                                                                  20540000
206400     PERFORM                                                      20550000
206500        UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN         20560000
206600           OR PS-ERROR                                            20570000
206700           OR PS-BLOCK-ERROR                                      20580000
206800                                                                  20590000
206900              COMPUTE PV-ITEMS-HOLD  =                            20600000
207000                      ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +       20610000
207100                      PC-ITEMS-PER-PANEL - 1                      20620000
207200                                                                  20630000
207300               IF  PV-ITEMS-HOLD  >  ASC-NUMBER-OF-ITEMS-READ     20640000
207400                   SUBTRACT  ASC-NUMBER-OF-ITEMS-READ             20650000
207500                       FROM  PV-ITEMS-HOLD                        20660000
207600                     GIVING  PV-ITEMS-DIFF                        20670000
207700                   SUBTRACT  PV-ITEMS-DIFF                        20680000
207800                       FROM  PC-ITEMS-PER-PANEL                   20690000
207900                     GIVING  PV-ITEMS-HOLD                        20700000
208000                       MOVE  PV-ITEMS-HOLD TO PV-SUB              20710000
208100                                              ASC-ITEM-SUB        20720000
208200                                              ASC-ITEMS-DISPLAYED 20730000
208300               ELSE                                               20740000
208400                   MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB            20750000
208500                   MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB      20760000
208600               END-IF                                             20770000
208700                                                                  20780000
208800               PERFORM 3300-EDIT-SELECTIONS                       20790000
208900                       VARYING PV-SUB                             20800000
209000                          FROM PV-SUB BY -1                       20810000
209100                          UNTIL PV-SUB < +1                       20820000
209200                                                                  20830000
209300               MOVE +1               TO ASC-BLK-SUB               20840000
209400                                                                  20850000
209500               PERFORM 5105-REWRITE-ASC-LISTQ                     20860000
209600                                                                  20870000
209700               MOVE +1                TO ASC-BLK-SUB              20880000
209800                                                                  20890000
209900               IF  PS-BLOCK-ERROR                                 20900000
210000                   SET  PS-ERROR     TO TRUE                      20910000
210100                   MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)      20920000
210200                                     TO PV-TOP-ITEM               20930000
210300               ELSE                                               20940000
210400                   ADD  +1           TO PV-BLOCK-NUMBER           20950000
210500                   IF  PV-BLOCK-NUMBER >                          20960000
210600                       ASC-HIGHEST-BLOCK-WRITTEN                  20970000
210700                       MOVE +2       TO ASC-BLK-SUB               20980000
210800                       PERFORM 4410-READ-TEMP-STORAGE             20990000
210900                       MOVE +1       TO ASC-BLK-SUB               21000000
211000                   ELSE                                           21010000
211100                       PERFORM 4410-READ-TEMP-STORAGE             21020000
211200                       ADD  +1        TO PV-BLOCK-NUMBER          21030000
211300                       MOVE +2        TO ASC-BLK-SUB              21040000
211400                       PERFORM 4410-READ-TEMP-STORAGE             21050000
211500                       SUBTRACT +1  FROM PV-BLOCK-NUMBER          21060000
211600                       MOVE +1        TO ASC-BLK-SUB              21070000
211700               END-IF                                             21080000
211800           END-IF                                                 21090000
211900     END-PERFORM.                                                 21100000
212000                                                                  21110000
212100     IF  (PV-ORIGINAL-BLOCK  = +1   AND                           21120000
212200          ASC-LIST-ITEM-NUMBER (1 1) = 1)  OR                     21130000
212300         PS-ERROR                   OR                            21140000
212400         PS-BLOCK-ERROR                                           21150000
212500             CONTINUE                                             21160000
212600     ELSE                                                         21170000
212700         MOVE +1                 TO PV-BLOCK-NUMBER               21180000
212800         MOVE +1                 TO ASC-BLK-SUB                   21190000
212900         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  21200000
213000         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEMS-DISPLAYED           21210000
213100         PERFORM 4410-READ-TEMP-STORAGE                           21220000
213200                                                                  21230000
213300         PERFORM                                                  21240000
213400            UNTIL PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK             21250000
213500               OR PS-ERROR                                        21260000
213600               OR PS-BLOCK-ERROR                                  21270000
213700                                                                  21280000
213800                  COMPUTE PV-ITEMS-HOLD  =                        21290000
213900                          ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +   21300000
214000                          PC-ITEMS-PER-PANEL - 1                  21310000
214100                                                                  21320000
214200                  IF  PV-ITEMS-HOLD > ASC-NUMBER-OF-ITEMS-READ    21330000
214300                      SUBTRACT  ASC-NUMBER-OF-ITEMS-READ          21340000
214400                          FROM  PV-ITEMS-HOLD                     21350000
214500                        GIVING  PV-ITEMS-DIFF                     21360000
214600                      SUBTRACT  PV-ITEMS-DIFF                     21370000
214700                          FROM  PC-ITEMS-PER-PANEL                21380000
214800                        GIVING  PV-ITEMS-HOLD                     21390000
214900                          MOVE  PV-ITEMS-HOLD TO PV-SUB           21400000
215000                                                 ASC-ITEM-SUB     21410000
215100                                              ASC-ITEMS-DISPLAYED 21420000
215200                  ELSE                                            21430000
215300                      MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB         21440000
215400                      MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB   21450000
215500                  END-IF                                          21460000
215600                                                                  21470000
215700                  PERFORM 3300-EDIT-SELECTIONS                    21480000
215800                          VARYING PV-SUB                          21490000
215900                             FROM PV-SUB BY -1                    21500000
216000                            UNTIL PV-SUB < +1                     21510000
216100                                                                  21520000
216200                  MOVE +1               TO ASC-BLK-SUB            21530000
216300                                                                  21540000
216400                  PERFORM 5105-REWRITE-ASC-LISTQ                  21550000
216500                                                                  21560000
216600                  MOVE +1                TO ASC-BLK-SUB           21570000
216700                                                                  21580000
216800                  IF  PS-BLOCK-ERROR                              21590000
216900                      SET  PS-ERROR     TO TRUE                   21600000
217000                      MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)   21610000
217100                                        TO PV-TOP-ITEM            21620000
217200                  ELSE                                            21630000
217300                      ADD  +1            TO PV-BLOCK-NUMBER       21640000
217400                      IF  PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK     21650000
217500                          MOVE +2        TO ASC-BLK-SUB           21660000
217600                          PERFORM 4410-READ-TEMP-STORAGE          21670000
217700                          MOVE +1        TO ASC-BLK-SUB           21680000
217800                      ELSE                                        21690000
217900                          PERFORM 4410-READ-TEMP-STORAGE          21700000
218000                          ADD  +1        TO PV-BLOCK-NUMBER       21710000
218100                          MOVE +2        TO ASC-BLK-SUB           21720000
218200                          PERFORM 4410-READ-TEMP-STORAGE          21730000
218300                          SUBTRACT +1  FROM PV-BLOCK-NUMBER       21740000
218400                          MOVE +1        TO ASC-BLK-SUB           21750000
218500                      END-IF                                      21760000
218600                  END-IF                                          21770000
218700     END-PERFORM.                                                 21780000
218800     MOVE +0 TO PV-ITEMS-HOLD.                                    21790000
218900                                                                  21800000
219000*----------------------------------------------------------------*21810000
219100*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *21820000
219200*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*21830000
219300*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *21840000
219400*                                                                *21850000
219500*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *21860000
219600*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *21870000
219700*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *21880000
219800*    US IN THE 2ND BLOCK OF THE ARRAY.                           *21890000
219900*----------------------------------------------------------------*21900000
220000 3100-SET-SUBSCRIPTS.                                             21910000
220100     COMPUTE ASC-ITEM-SUB =                                       21920000
220200         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        21930000
220300                                                                  21940000
220400     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         21950000
220500         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            21960000
220600         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               21970000
220700     ELSE                                                         21980000
220800         MOVE +1                     TO ASC-BLK-SUB               21990000
220900     END-IF.                                                      22000000
221000                                                                  22010000
221100******************************************************************22020000
221200** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **22030000
221300******************************************************************22040000
221400 3200-RESET-ATTRIBUTES.                                           22050000
221500     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   22060000
221600     MOVE DP015-GREEN              TO ASTRTITC.                   22070000
221700     MOVE DP015-UNDERLINE          TO ASTRTITH.                   22080000
221800                                                                  22090000
221900     PERFORM                                                      22100000
222000         VARYING PV-SUB                                           22110000
222100         FROM 1 BY 1                                              22120000
222200         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        22130000
222300                                                                  22140000
222400         MOVE DP015-UNP-ALP-NOR-OFF TO MR-SELECTA (PV-SUB)        22150000
222500         MOVE DP015-GREEN           TO MR-SELECTC (PV-SUB)        22160000
222600         MOVE DP015-UNDERLINE       TO MR-SELECTH (PV-SUB)        22170000
222700                                                                  22180000
222800         MOVE DP015-UNP-ALP-NOR-OFF TO MR-CTN-NOT-RCVDA (PV-SUB)  22190000
222900         MOVE DP015-GREEN           TO MR-CTN-NOT-RCVDC (PV-SUB)  22200000
223000         MOVE DP015-UNDERLINE       TO MR-CTN-NOT-RCVDH (PV-SUB)  22210000
223100                                                                  22220000
223200     END-PERFORM.                                                 22230000
223300                                                                  22240000
223400******************************************************************22250000
223500** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **22260000
223600** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **22270000
223700** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **22280000
223800** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **22290000
223900******************************************************************22300000
224000 3300-EDIT-SELECTIONS.                                            22310000
224100     EVALUATE TRUE                                                22320000
224200         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     22330000
224300             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         22340000
224400                 CONTINUE                                         22350000
224500         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         22360000
224600             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        22370000
224700                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   22380000
224800                 MOVE ASC-TEMP-SELECTED-SW                        22390000
224900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22400000
225000                                TO ASC-SELECTED-SW                22410000
225100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22420000
225200             END-IF                                               22430000
225300         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     22440000
225400                 = SPACE                                          22450000
225500             EVALUATE TRUE                                        22460000
225600                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       22470000
225700                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS22480000
225800                     MOVE SPACE TO ASC-SELECTED-SW                22490000
225900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22500000
226000                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        22510000
226100                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    22520000
226200                     MOVE SPACE TO ASC-SELECTED-SW                22530000
226300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22540000
226400                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          22550000
226500                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      22560000
226600                     MOVE SPACE TO ASC-SELECTED-SW                22570000
226700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22580000
226800             END-EVALUATE                                         22590000
226900         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           22600000
227000             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            22610000
227100                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    22620000
227200             END-IF                                               22630000
227300             PERFORM 3310-EDIT-RANGE                              22640000
227400         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             22650000
227500             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            22660000
227600                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    22670000
227700             END-IF                                               22680000
227800             PERFORM 3310-EDIT-RANGE                              22690000
227900         WHEN OTHER                                               22700000
228000             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           22710000
228100             SET DP020-MSG-FATAL    TO TRUE                       22720000
228200             MOVE -1                TO ASTRTITL                   22730000
228300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  22740000
228400*            MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        22750000
228500*            MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        22760000
228600             SET PS-ERROR TO TRUE                                 22770000
228700             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            22780000
228800                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     22790000
228900                 MOVE SPACE         TO ASC-SELECTED-SW            22800000
229000                                        (ASC-BLK-SUB ASC-ITEM-SUB)22810000
229100             END-IF                                               22820000
229200     END-EVALUATE.                                                22830000
229300                                                                  22840000
229400     IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)                     22850000
229500        PERFORM 3330-EDIT-LINES                                   22860000
229600     END-IF.                                                      22870000
229700                                                                  22880000
229800     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 22890000
229900     SUBTRACT +1 FROM ASC-ITEM-SUB.                               22900000
230000     IF  ASC-ITEM-SUB < 1                                         22910000
230100         SUBTRACT +1 FROM ASC-BLK-SUB                             22920000
230200         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                22930000
230300     END-IF.                                                      22940000
230400                                                                  22950000
230500******************************************************************22960000
230600** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **22970000
230700** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **22980000
230800** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**22990000
230900** THE ENDING.                                                  **23000000
231000******************************************************************23010000
231100 3310-EDIT-RANGE.                                                 23020000
231200     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                23030000
231300         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   23040000
231400             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)23050000
231500                                   TO ASC-SELECTED-SW             23060000
231600                                        (ASC-BLK-SUB ASC-ITEM-SUB)23070000
231700             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 23080000
231800         ELSE                                                     23090000
231900             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     23100000
232000                 CONTINUE                                         23110000
232100             ELSE                                                 23120000
232200*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        23130000
232300                 MOVE PC-TSYMSG-00054                             23140000
232400                                   TO DP020-MSG-NUMBER            23150000
232500                 SET DP020-MSG-FATAL                              23160000
232600                                   TO TRUE                        23170000
232700                 MOVE -1           TO ASTRTITL                    23180000
232800                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              23190000
232900                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         23200000
233000                 MOVE DP015-UNDERLINE TO MR-SELECTH (PV-SUB)      23210000
233100                 SET PS-ERROR      TO TRUE                        23220000
233200             END-IF                                               23230000
233300         END-IF                                                   23240000
233400     ELSE                                                         23250000
233500         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     23260000
233600             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 23270000
233700                                   TO ASC-SELECTED-SW             23280000
233800                                     (ASC-BLK-SUB ASC-ITEM-SUB)   23290000
233900             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   23300000
234000         ELSE                                                     23310000
234100             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       23320000
234200                 CONTINUE                                         23330000
234300             ELSE                                                 23340000
234400*                -- ONLY ONE END-OF-RANGE ALLOWED --              23350000
234500                 MOVE PC-TSYMSG-00055                             23360000
234600                                   TO DP020-MSG-NUMBER            23370000
234700                 SET DP020-MSG-FATAL                              23380000
234800                                   TO TRUE                        23390000
234900                 MOVE -1           TO ASTRTITL                    23400000
235000                 SET DP030-SET-CURSOR-APPL-1                      23410000
235100                                   TO TRUE                        23420000
235200                 SET PS-ERROR      TO TRUE                        23430000
235300             END-IF                                               23440000
235400         END-IF                                                   23450000
235500     END-IF.                                                      23460000
235600                                                                  23470000
235700 3330-EDIT-LINES.                                                 23480000
235800                                                                  23490000
235900     EVALUATE TRUE                                                23500000
236000**       FOLLOWING EDIT IS FOR F15 TO MAKE SURE A VALUE IS        23510000
236100**       ENTERED FOR SELECTED LINES TO BE RELEASED.               23520000
236200         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              23530000
236300              IF ASC-CTN-NOT-RCVD (ASC-BLK-SUB ASC-ITEM-SUB)      23540000
236400                             = SPACE                              23550000
236500                 MOVE PC-TSYMSG-03644 TO DP020-MSG-NUMBER         23560000
236600                 MOVE -1              TO MR-CTN-NOT-RCVDL (PV-SUB)23570000
236700                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              23580000
236800**??             MOVE DP015-REVERSE   TO MR-CTN-NOT-RCVDH (PV-SUB)23590000
236900**??             MOVE DP015-RED       TO MR-CTN-NOT-RCVDC (PV-SUB)23600000
237000**??             MOVE DP015-UNP-ALP-NOR-OFF TO                    23610000
237100**??                                   MR-CTN-NOT-RCVDA (PV-SUB)  23620000
237200                 SET PS-ERROR                                     23630000
237300                     DP020-MSG-FATAL   TO TRUE                    23640000
237400              ELSE                                                23650000
237500              IF ASC-CTN-NOT-RCVD (ASC-BLK-SUB ASC-ITEM-SUB)      23660000
237600                             = PC-Y OR                            23670000
237700                               PC-N                               23680000
237800                 CONTINUE                                         23690000
237900              ELSE                                                23700000
238000                 MOVE PC-TSYMSG-03644 TO DP020-MSG-NUMBER         23710000
238100                 MOVE -1              TO MR-CTN-NOT-RCVDL (PV-SUB)23720000
238200                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              23730000
238300**??             MOVE DP015-REVERSE   TO MR-CTN-NOT-RCVDH (PV-SUB)23740000
238400**??             MOVE DP015-RED       TO MR-CTN-NOT-RCVDC (PV-SUB)23750000
238500**??             MOVE DP015-UNP-ALP-NOR-OFF TO                    23760000
238600**??                                   MR-CTN-NOT-RCVDA (PV-SUB)  23770000
238700                 SET PS-ERROR                                     23780000
238800                     DP020-MSG-FATAL   TO TRUE                    23790000
238900              END-IF                                              23800000
239000              END-IF                                              23810000
239100                                                                  23820000
239200     END-EVALUATE.                                                23830000
239300                                                                  23840000
239400                                                                  23850000
239500******************************************************************23860000
239600** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **23870000
239700** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **23880000
239800******************************************************************23890000
239900 3400-CHECK-RANGE-SEQUENCE.                                       23900000
240000     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       23910000
240100       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      23920000
240200       AND  ASC-START-OF-SELECTED-RANGE >                         23930000
240300                                         ASC-END-OF-SELECTED-RANGE23940000
240400*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                23950000
240500         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 23960000
240600         SET DP020-MSG-FATAL TO TRUE                              23970000
240700         SET PS-ERROR TO TRUE                                     23980000
240800         PERFORM 3410-POSITION-AT-ERROR                           23990000
240900     END-IF.                                                      24000000
241000                                                                  24010000
241100******************************************************************24020000
241200** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **24030000
241300** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **24040000
241400** SHOULD BE POSITIONED ON A RANGE ERROR.                       **24050000
241500******************************************************************24060000
241600 3410-POSITION-AT-ERROR.                                          24070000
241700     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       24080000
241800     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 24090000
241900                    - PV-TOP-ITEM + 1.                            24100000
242000     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      24110000
242100         CONTINUE                                                 24120000
242200     ELSE                                                         24130000
242300         MOVE -1                   TO MR-SELECTL (PV-SUB)         24140000
242400         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         24150000
242500         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         24160000
242600     END-IF.                                                      24170000
242700                                                                  24180000
242800     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   24190000
242900                    - PV-TOP-ITEM + 1.                            24200000
243000     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      24210000
243100         CONTINUE                                                 24220000
243200     ELSE                                                         24230000
243300         MOVE -1                   TO MR-SELECTL (PV-SUB)         24240000
243400         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         24250000
243500         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         24260000
243600     END-IF.                                                      24270000
243700                                                                  24280000
243800*----------------------------------------------------------------*24290000
243900*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *24300000
244000*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *24310000
244100*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *24320000
244200*----------------------------------------------------------------*24330000
244300 3500-MARK-RANGE-AS-SELECTED.                                     24340000
244400     MOVE +1                       TO  ASC-BLK-SUB.               24350000
244500     PERFORM 3510-MARK-SELECTED-INDS                              24360000
244600         VARYING ASC-ITEM-SUB                                     24370000
244700         FROM 1 BY 1                                              24380000
244800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 24390000
244900                                                                  24400000
245000     ADD +1                        TO ASC-BLK-SUB.                24410000
245100     PERFORM 3510-MARK-SELECTED-INDS                              24420000
245200         VARYING ASC-ITEM-SUB                                     24430000
245300         FROM 1 BY 1                                              24440000
245400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 24450000
245500                                                                  24460000
245600     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               24470000
245700                                   TO  PV-LIST-ITEM-NUMBER.       24480000
245800     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            24490000
245900         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         24500000
246000               PC-ITEMS-PER-PANEL).                               24510000
246100                                                                  24520000
246200     MOVE ASC-START-OF-SELECTED-RANGE                             24530000
246300                                   TO PV-START-OF-SELECTED-RANGE. 24540000
246400     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            24550000
246500         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  24560000
246600               PC-ITEMS-PER-PANEL).                               24570000
246700                                                                  24580000
246800     MOVE ASC-END-OF-SELECTED-RANGE                               24590000
246900                                   TO  PV-END-OF-SELECTED-RANGE.  24600000
247000     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             24610000
247100         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    24620000
247200               PC-ITEMS-PER-PANEL).                               24630000
247300     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             24640000
247400         PV-FIRST-BLOCK-IN-ARRAY + 1.                             24650000
247500                                                                  24660000
247600     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    24670000
247700        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        24680000
247800         MOVE +1                   TO ASC-BLK-SUB                 24690000
247900         PERFORM 5100-WRITE-TEMP-STORAGE                          24700000
248000         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         24710000
248100             PV-FIRST-BLOCK-IN-ARRAY - 1                          24720000
248200                                                                  24730000
248300         PERFORM                                                  24740000
248400             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      24750000
248500                   PV-PREV-BLOCK-IN-ARRAY                         24760000
248600             MOVE PV-FIRST-BLOCK-IN-RANGE                         24770000
248700                                   TO PV-BLOCK-NUMBER             24780000
248800             PERFORM 4410-READ-TEMP-STORAGE                       24790000
248900             PERFORM 3510-MARK-SELECTED-INDS                      24800000
249000                 VARYING ASC-ITEM-SUB                             24810000
249100                 FROM 1 BY 1                                      24820000
249200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          24830000
249300             PERFORM 5100-WRITE-TEMP-STORAGE                      24840000
249400             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     24850000
249500         END-PERFORM                                              24860000
249600                                                                  24870000
249700         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         24880000
249800             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     24890000
249900         PERFORM                                                  24900000
250000             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       24910000
250100                   PV-LAST-BLOCK-IN-RANGE                         24920000
250200             MOVE PV-NEXT-BLOCK-IN-ARRAY                          24930000
250300                                   TO PV-BLOCK-NUMBER             24940000
250400             PERFORM 4410-READ-TEMP-STORAGE                       24950000
250500             PERFORM 3510-MARK-SELECTED-INDS                      24960000
250600                 VARYING ASC-ITEM-SUB                             24970000
250700                 FROM 1 BY 1                                      24980000
250800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          24990000
250900             PERFORM 5100-WRITE-TEMP-STORAGE                      25000000
251000             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      25010000
251100         END-PERFORM                                              25020000
251200                                                                  25030000
251300         MOVE PV-FIRST-BLOCK-IN-ARRAY                             25040000
251400                                   TO PV-BLOCK-NUMBER             25050000
251500         PERFORM 4410-READ-TEMP-STORAGE                           25060000
251600     END-IF.                                                      25070000
251700                                                                  25080000
251800     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 25090000
251900                                      ASC-END-OF-SELECTED-RANGE.  25100000
252000                                                                  25110000
252100*----------------------------------------------------------------*25120000
252200* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *25130000
252300*----------------------------------------------------------------*25140000
252400 3510-MARK-SELECTED-INDS.                                         25150000
252500     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         25160000
252600                                ASC-ITEM-SUB) >                   25170000
252700         ASC-START-OF-SELECTED-RANGE)                             25180000
252800     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         25190000
252900                                ASC-ITEM-SUB) =                   25200000
253000         ASC-START-OF-SELECTED-RANGE)                             25210000
253100                                                                  25220000
253200         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     25230000
253300                                    ASC-ITEM-SUB) <               25240000
253400             ASC-END-OF-SELECTED-RANGE)                           25250000
253500         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     25260000
253600                                    ASC-ITEM-SUB) =               25270000
253700             ASC-END-OF-SELECTED-RANGE)                           25280000
253800                                                                  25290000
253900             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          25300000
254000                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   25310000
254100                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   25320000
254200                               TO TRUE                            25330000
254300                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              25340000
254400                               TO TRUE                            25350000
254500                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    25360000
254600             END-IF                                               25370000
254700         END-IF                                                   25380000
254800     END-IF.                                                      25390000
254900                                                                  25400000
255000*----------------------------------------------------------------*25410000
255100*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *25420000
255200*    INITIALIZE ALL COUNTERS AND FLAGS.                          *25430000
255300*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *25440000
255400*    DISPLAY THE PANEL TO USER.                                  *25450000
255500*----------------------------------------------------------------*25460000
255600 4000-BUILD-INITIAL-PANEL.                                        25470000
255700     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            25480000
255800                                 ASC-BLOCK-ENTRIES (2).           25490000
255900     MOVE +1                   TO ASC-BLK-SUB.                    25500000
256000     SET ASC-ITEMS-LEFT-ON-DB  TO TRUE.                           25510000
256100                                                                  25520000
256200     MOVE +0                 TO ASC-ITEM-SUB                      25530000
256300                                ASC-NUMBER-OF-ITEMS-READ          25540000
256400                                ASC-NUMBER-OF-SELECTED-ITEMS      25550000
256500                                ASC-HIGHEST-BLOCK-WRITTEN         25560000
256600                                ASC-START-OF-SELECTED-RANGE       25570000
256700                                ASC-END-OF-SELECTED-RANGE         25580000
256800                                ASC-ITEM-AT-TOP-OF-PANEL.         25590000
256900                                                                  25600000
257000     PERFORM 4100-PREPARE-CURSOR.                                 25610000
257100     PERFORM 4120-OPEN-CURSOR.                                    25620000
257200     PERFORM 4300-READ-ITEMS-FROM-DB.                             25630000
257300     PERFORM 4140-CLOSE-CURSOR.                                   25640000
257400                                                                  25650000
257500     MOVE +1                   TO  PV-TOP-ITEM.                   25660000
257600     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          25670000
257700         IF DP020-MSG-NUMBER  =  PC-TSYMSG-03657                  25680000
257800            CONTINUE                                              25690000
257900         ELSE                                                     25700000
258000            SET DP020-MSG-FATAL   TO  TRUE                        25710000
258100            MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER            25720000
258200            IF ASC-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT      25730000
258300               SET DP020-NEXT-ACT-APPL-ERROR TO TRUE              25740000
258400            END-IF                                                25750000
258500         END-IF                                                   25760000
258600     ELSE                                                         25770000
258700         MOVE -1               TO MR-SELECTL (1)                  25780000
258800         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      25790000
258900         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     25800000
259000     END-IF.                                                      25810000
259100                                                                  25820000
259200*----------------------------------------------------------------*25830000
259300* OPEN THE CURSOR.                                               *25840000
259400*   IN THIS PARTICULAR APPLICATION ONE OF 3 DIFFERENT CURSORS    *25850000
259500*   WILL BE OPENED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *25860000
259600*   ASSOCIATE.                                                   *25870000
259700*----------------------------------------------------------------*25880000
259800 4120-OPEN-CURSOR.                                                25890000
259900     PERFORM                                                      25900000
260000         WITH TEST AFTER                                          25910000
260100         VARYING PV-RETRY-COUNTER                                 25920000
260200         FROM 1 BY 1                                              25930000
260300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               25940000
260400                   OR (SQLCODE = ZERO))                           25950000
260500                                                                  25960000
260600         MOVE 'CURSOR:  DOOR-CAPABLE-CSR '                        25970000
260700                               TO DP013-MESSAGE-TEXT (2)          25980000
260800         EVALUATE TRUE                                            25990000
260900             WHEN ASC-RQST-BAR-CODE                               26000000
261000                  EXEC SQL                                        26010000
261100                       OPEN BAR-CODE-CSR                          26020000
261200                  END-EXEC                                        26030000
261300                                                                  26040000
261400             WHEN ASC-RQST-PO-RCVR                                26050000
261500                  EXEC SQL                                        26060000
261600                       OPEN PO-RCVR-CSR                           26070000
261700                  END-EXEC                                        26080000
261800                                                                  26090000
261900             WHEN ASC-RQST-PO-RCVR-PREPK                          26100000
262000                  EXEC SQL                                        26110000
262100                       OPEN PO-RCVR-PREPK-CSR                     26120000
262200                  END-EXEC                                        26130000
262300                                                                  26140000
262400             WHEN ASC-RQST-PO-RCVR-LINE                           26150000
262500                  EXEC SQL                                        26160000
262600                       OPEN PO-RCVR-LINE-CSR                      26170000
262700                  END-EXEC                                        26180000
262800                                                                  26190000
262900             WHEN ASC-RQST-AUDIT                                  26200000
263000                  EXEC SQL                                        26210000
263100                       OPEN AUDIT-CSR                             26220000
263200                  END-EXEC                                        26230000
263300                                                                  26240000
263400         END-EVALUATE                                             26250000
263500                                                                  26260000
263600         EVALUATE TRUE                                            26270000
263700             WHEN SQLCODE = ZERO                                  26280000
263800             WHEN SQLCODE = -904                                  26290000
263900             WHEN SQLCODE = -913                                  26300000
264000                 CONTINUE                                         26310000
264100             WHEN SQLWARN0 NOT = SPACES                           26320000
264200             WHEN SQLCODE < ZERO                                  26330000
264300             WHEN SQLCODE > ZERO                                  26340000
264400                 MOVE '4120-OPEN-CURSOR' TO DP013-PARAGRAPH       26350000
264500                 MOVE 'UNABLE TO OPEN A CURSOR -'                 26360000
264600                                   TO DP013-MESSAGE-TEXT (1)      26370000
264700                 MOVE SQLCA        TO DP013-SQLCA                 26380000
264800                 MOVE 'SUT-CART-DIRV-TRKG' TO                     26390000
264900                                      DP013-DB2-TABLE-NAME (1)    26400000
265000                 SET DP013-DB2-ABEND                              26410000
265100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           26420000
265200                 PERFORM DP013-0000-PROCESS-ABEND                 26430000
265300         END-EVALUATE                                             26440000
265400     END-PERFORM.                                                 26450000
265500                                                                  26460000
265600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        26470000
265700         MOVE '4120-OPEN-CURSOR'   TO DP013-PARAGRAPH             26480000
265800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   26490000
265900                                   TO DP013-MESSAGE-TEXT (1)      26500000
266000         MOVE SQLCA                TO DP013-SQLCA                 26510000
266100         MOVE 'SUT-CART-DIRV-TRKG' TO DP013-DB2-TABLE-NAME (1)    26520000
266200         SET DP013-DB2-ABEND                                      26530000
266300             DP013-XCTL-DISPLAY-RESTART TO TRUE                   26540000
266400         PERFORM DP013-0000-PROCESS-ABEND                         26550000
266500     END-IF.                                                      26560000
266600                                                                  26570000
266700*----------------------------------------------------------------*26580000
266800* CLOSE THE CURSOR                                               *26590000
266900*----------------------------------------------------------------*26600000
267000 4140-CLOSE-CURSOR.                                               26610000
267100                                                                  26620000
267200     EVALUATE TRUE                                                26630000
267300         WHEN ASC-RQST-BAR-CODE                                   26640000
267400              EXEC SQL                                            26650000
267500                  CLOSE BAR-CODE-CSR                              26660000
267600              END-EXEC                                            26670000
267700                                                                  26680000
267800         WHEN ASC-RQST-PO-RCVR                                    26690000
267900              EXEC SQL                                            26700000
268000                   CLOSE PO-RCVR-CSR                              26710000
268100              END-EXEC                                            26720000
268200                                                                  26730000
268300         WHEN ASC-RQST-PO-RCVR-PREPK                              26740000
268400              EXEC SQL                                            26750000
268500                   CLOSE PO-RCVR-PREPK-CSR                        26760000
268600              END-EXEC                                            26770000
268700                                                                  26780000
268800         WHEN ASC-RQST-PO-RCVR-LINE                               26790000
268900              EXEC SQL                                            26800000
269000                   CLOSE PO-RCVR-LINE-CSR                         26810000
269100              END-EXEC                                            26820000
269200                                                                  26830000
269300         WHEN ASC-RQST-AUDIT                                      26840000
269400              EXEC SQL                                            26850000
269500                   CLOSE AUDIT-CSR                                26860000
269600              END-EXEC                                            26870000
269700                                                                  26880000
269800     END-EVALUATE.                                                26890000
269900                                                                  26900000
270000     EVALUATE TRUE                                                26910000
270100         WHEN SQLCODE = ZERO                                      26920000
270200             CONTINUE                                             26930000
270300         WHEN SQLWARN0 NOT = SPACES                               26940000
270400         WHEN SQLCODE < ZERO                                      26950000
270500         WHEN SQLCODE > ZERO                                      26960000
270600             MOVE '4140-CLOSE-CURSOR' TO DP013-PARAGRAPH          26970000
270700             MOVE 'UNABLE TO CLOSE CURSOR '                       26980000
270800                               TO DP013-MESSAGE-TEXT (1)          26990000
270900             MOVE SQLCA        TO DP013-SQLCA                     27000000
271000             MOVE 'SUT-CART-DIRV-TRKG' TO                         27010000
271100                                      DP013-DB2-TABLE-NAME (1)    27020000
271200             SET DP013-DB2-ABEND                                  27030000
271300                 DP013-XCTL-DISPLAY-RESTART TO TRUE               27040000
271400             PERFORM DP013-0000-PROCESS-ABEND                     27050000
271500     END-EVALUATE.                                                27060000
271600                                                                  27070000
271700*----------------------------------------------------------------*27080000
271800*    SET UP THE HOST VARIABLES.                                  *27090000
271900*----------------------------------------------------------------*27100000
272000 4100-PREPARE-CURSOR.                                             27110000
272100                                                                  27120000
272200                                                                  27130000
272300     MOVE ASC-OPER-UNT-ID      TO  DK-OPER-UNT-ID.                27140000
272400     MOVE ASC-PO-NBR           TO  DK-PO-NBR.                     27150000
272500     MOVE ASC-RCVR             TO  DK-REC-SEQ-NBR.                27160000
272600     MOVE ASC-PO-LNE-NBR       TO  DK-PO-LNE-NBR.                 27170000
272700     MOVE ASC-PREPK-ID         TO  DK-PREPK-ID.                   27180000
272800                                                                  27190000
272900     MOVE ASC-AUDIT-CNTL-NBR   TO  DK-AUD-CNTL-NBR.               27200000
273000     MOVE ASC-BRCDE-NBR        TO  DK-BRCDE-NBR.                  27210000
273100                                                                  27220000
273200     IF PS-NO-ERROR                                               27230000
273300        PERFORM 7080-SELECT-EXPECTED-CARTONS.                     27240000
273400                                                                  27250000
273500     IF PS-NO-ERROR                                               27260000
273600        PERFORM 7090-DIRECTIVES-AVAIL.                            27270000
273700                                                                  27280000
273800                                                                  27290000
273900*----------------------------------------------------------------*27300000
274000*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *27310000
274100*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *27320000
274200*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *27330000
274300*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *27340000
274400*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *27350000
274500*                                                                *27360000
274600*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *27370000
274700*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *27380000
274800*    UPON INITIALIZATION.                                        *27390000
274900*----------------------------------------------------------------*27400000
275000 4300-READ-ITEMS-FROM-DB.                                         27410000
275100     PERFORM                                                      27420000
275200         VARYING PV-READ-COUNT                                    27430000
275300         FROM 1 BY 1                                              27440000
275400         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    27450000
275500            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         27460000
275600                                                                  27470000
275700         PERFORM 4310-FETCH                                       27480000
275800                                                                  27490000
275900         IF  ASC-ITEMS-LEFT-ON-DB                                 27500000
276000             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                27510000
276100                 ADD +1            TO ASC-ITEM-SUB                27520000
276200             ELSE                                                 27530000
276300                 ADD +1            TO ASC-BLK-SUB                 27540000
276400                 MOVE +1           TO ASC-ITEM-SUB                27550000
276500                                                                  27560000
276600                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         27570000
276700                     MOVE +1       TO ASC-BLK-SUB                 27580000
276800                     SET ASC-BLOCK-MODIFIED (1) TO TRUE           27590000
276900                     PERFORM 5100-WRITE-TEMP-STORAGE              27600000
277000                     MOVE ASC-BLOCK-ENTRIES                       27610000
277100                               (PC-MAX-BLOCKS-IN-ARRAY)           27620000
277200                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 27630000
277300                     ADD +1        TO ASC-BLK-SUB                 27640000
277400                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   27650000
277500                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      27660000
277600                                   TO TRUE                        27670000
277700                 END-IF                                           27680000
277800             END-IF                                               27690000
277900             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    27700000
278000             MOVE ASC-NUMBER-OF-ITEMS-READ                        27710000
278100                                   TO ASC-LIST-ITEM-NUMBER        27720000
278200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27730000
278300             EVALUATE TRUE                                        27740000
278400                 WHEN ASC-PREPK-ORDER                             27750000
278500                      MOVE RECITM-ORD-LNE-NBR  TO ASC-LNE-NBR     27760000
278600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27770000
278700                                                                  27780000
278800                 WHEN ASC-PACK-BY-STORE-ORDER                     27790000
278900                      CONTINUE                                    27800000
279000                                                                  27810000
279100                 WHEN ASC-BULK-CASE-ORDER                         27820000
279200                      MOVE SUT00102-PO-LNE-NBR TO ASC-LNE-NBR     27830000
279300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27840000
279400                                                                  27850000
279500             END-EVALUATE                                         27860000
279600                                                                  27870000
279700             MOVE SUT00102-PREPK-ID         TO  ASC-PREPACK-ID    27880000
279800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27890000
279900             MOVE PV-COUNT-EXPECTED         TO  ASC-EXP-CTNS      27900000
280000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27910000
280100             MOVE PV-COUNT-DIRECTIVES       TO  ASC-DRTV-CTNS     27920000
280200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27930000
280300             MOVE PV-COUNT-RELEASED         TO  ASC-RLSD-CTNS     27940000
280400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27950000
280500             MOVE SUT00102-AUD-CNTL-NBR     TO  ASC-AUD-CNTL-NBR  27960000
280600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27970000
280700             IF SUT00015-DIRV-RLSE-IND = SPACES                   27980000
280800                MOVE SPACES                 TO ASC-CTN-NOT-RCVD   27990000
280900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 28000000
281000             ELSE                                                 28010000
281100                MOVE SUT00015-DIRV-RLSE-IND TO ASC-CTN-NOT-RCVD   28020000
281200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 28030000
281300             END-IF                                               28040000
281400             MOVE SUT00102-CRE-TMST         TO  ASC-CREATE-TMST   28050000
281500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 28060000
281600*CT BEGIN 01/28/09 IR #18061 FIELDS NOT USED                      28070000
281700*            MOVE SUT00102-BRCDE-NBR        TO  ASC-BARCODE       28080000
281800*                                      (ASC-BLK-SUB ASC-ITEM-SUB) 28090000
281900*            MOVE SUT00102-SHIPT-UNT-ID     TO  ASC-SHIPT-UNT-ID  28100000
282000*                                      (ASC-BLK-SUB ASC-ITEM-SUB) 28110000
282100*CT END   01/28/09 IR #18061                                      28120000
282200             MOVE SUT00015-AUD-STAT-CDE     TO  ASC-AUD-STAT-CDE  28130000
282300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 28140000
282400             MOVE SUT00102-PREPK-ID         TO  ASC-PREPACK-ID    28150000
282500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 28160000
282600             MOVE SUT00102-STR-NBR          TO  ASC-STR-NBR       28170000
282700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 28180000
282800             IF DN-STR-ZN-ID     = 0                              28190000
282900                MOVE SUT00102-STR-ZN-ID     TO  ASC-STR-ZN-ID     28200000
283000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 28210000
283100             ELSE                                                 28220000
283200                MOVE SPACES                 TO  ASC-STR-ZN-ID     28230000
283300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 28240000
283400             END-IF                                               28250000
283500             IF DN-SEASET-YR     = 0                              28260000
283600                MOVE SUT00102-SEASET-YR     TO                    28270000
283700                                             ASC-SEASET-YR        28280000
283800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 28290000
283900             ELSE                                                 28300000
284000                MOVE SPACES                 TO                    28310000
284100                                             ASC-SEASET-YR        28320000
284200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 28330000
284300             END-IF                                               28340000
284400             IF DN-SEASET-SHRT-NM = 0                             28350000
284500                MOVE SUT00102-SEASET-SHRT-NM TO                   28360000
284600                                            ASC-SEASET-SHRT-NM    28370000
284700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 28380000
284800             ELSE                                                 28390000
284900                MOVE SPACES                  TO                   28400000
285000                                            ASC-SEASET-SHRT-NM    28410000
285100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 28420000
285200             END-IF                                               28430000
285300             IF DN-AUD-FALR-RSN-NM = 0                            28440000
285400                MOVE SUT00102-AUD-FALR-RSN-NM TO                  28450000
285500                                            ASC-AUD-FALR-RSN-NM   28460000
285600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 28470000
285700             ELSE                                                 28480000
285800                MOVE SPACES                   TO                  28490000
285900                                            ASC-AUD-FALR-RSN-NM   28500000
286000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 28510000
286100             END-IF                                               28520000
286200                                                                  28530000
286300         END-IF                                                   28540000
286400     END-PERFORM.                                                 28550000
286500                                                                  28560000
286600     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          28570000
286700         MOVE +1               TO ASC-BLK-SUB                     28580000
286800         PERFORM 5100-WRITE-TEMP-STORAGE                          28590000
286900         ADD +1                TO ASC-BLK-SUB                     28600000
287000         PERFORM 5100-WRITE-TEMP-STORAGE                          28610000
287100                                                                  28620000
287200         MOVE 1                TO ASC-BLK-SUB                     28630000
287300                                  PV-BLOCK-NUMBER                 28640000
287400         PERFORM 4410-READ-TEMP-STORAGE                           28650000
287500         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             28660000
287600             MOVE 2            TO ASC-BLK-SUB                     28670000
287700                                  PV-BLOCK-NUMBER                 28680000
287800             PERFORM 4410-READ-TEMP-STORAGE                       28690000
287900         END-IF                                                   28700000
288000     END-IF.                                                      28710000
288100                                                                  28720000
288200*----------------------------------------------------------------*28730000
288300*    FETCH THE CURSOR                                             28740000
288400*----------------------------------------------------------------*28750000
288500 4310-FETCH.                                                      28760000
288600                                                                  28770000
288700     EVALUATE TRUE                                                28780000
288800         WHEN ASC-RQST-BAR-CODE                                   28790000
288900              EXEC SQL                                            28800000
289000                  FETCH BAR-CODE-CSR                              28810000
289100                   INTO :SUT00102-AUD-CNTL-NBR                    28820000
289400                       ,:SUT00102-PO-LNE-NBR                      28830000
289500                       ,:SUT00102-PREPK-ID                        28840000
289600              END-EXEC                                            28850000
289700                                                                  28860000
289800         WHEN ASC-RQST-PO-RCVR                                    28870000
289900              EXEC SQL                                            28880000
290000                  FETCH PO-RCVR-CSR                               28890000
290100                   INTO :SUT00102-AUD-CNTL-NBR                    28900000
290400                       ,:SUT00102-PO-LNE-NBR                      28910000
290500                       ,:SUT00102-PREPK-ID                        28920000
290600              END-EXEC                                            28930000
290700                                                                  28940000
290800         WHEN ASC-RQST-PO-RCVR-PREPK                              28950000
290900              EXEC SQL                                            28960000
291000                  FETCH PO-RCVR-PREPK-CSR                         28970000
291100                   INTO :SUT00102-AUD-CNTL-NBR                    28980000
291400                       ,:SUT00102-PO-LNE-NBR                      28990000
291500                       ,:SUT00102-PREPK-ID                        29000000
291600              END-EXEC                                            29010000
291700                                                                  29020000
291800         WHEN ASC-RQST-PO-RCVR-LINE                               29030000
291900              EXEC SQL                                            29040000
292000                  FETCH PO-RCVR-LINE-CSR                          29050000
292100                   INTO :SUT00102-AUD-CNTL-NBR                    29060000
292400                       ,:SUT00102-PO-LNE-NBR                      29070000
292500                       ,:SUT00102-PREPK-ID                        29080000
292600              END-EXEC                                            29090000
292700                                                                  29100000
292800         WHEN ASC-RQST-AUDIT                                      29110000
292900              EXEC SQL                                            29120000
293000                  FETCH AUDIT-CSR                                 29130000
293100                   INTO :SUT00102-AUD-CNTL-NBR                    29140000
293400                       ,:SUT00102-PO-LNE-NBR                      29150000
293500                       ,:SUT00102-PREPK-ID                        29160000
293600              END-EXEC                                            29170000
293700                                                                  29180000
293800     END-EVALUATE.                                                29190000
293900                                                                  29200000
294000     EVALUATE TRUE                                                29210000
294100         WHEN SQLCODE = ZERO                                      29220000
294200              PERFORM 4330-COUNT-EXPECTED-CARTONS                 29230000
294300              PERFORM 4340-COUNT-RELEASED-CARTONS                 29240000
294400              PERFORM 4350-SELECT-TRECITM                         29250000
294800              PERFORM 4320-GET-DIRV-RLSE-IND                      29260000
294900              PERFORM 7140-SELECT-DIRV-TRKG                       29270000
295000*CT BEGIN 01/28/09 IR #18061                                      29280000
295100              PERFORM 4360-SELECT-AUDIT-STATUS                    29290000
295200              PERFORM 4361-SELECT-MIN-CRE-TMST                    29300000
295300              PERFORM 4362-SELECT-STR-NBR-ZN                      29310000
295310              PERFORM 4363-SELECT-MAX-CRE-TMST                    29320000
295320              PERFORM 4364-SELECT-AUD-FALR-RSN                    29330000
295400*CT END   01/28/09 IR #18061                                      29340000
295500                                                                  29350000
295600         WHEN SQLCODE = +100                                      29360000
295700              SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                 29370000
295800         WHEN SQLWARN0 NOT = SPACE                                29380000
295900         WHEN SQLCODE NOT = ZERO                                  29390000
296000              MOVE '4310-FETCH       ' TO DP013-PARAGRAPH         29400000
296100              STRING 'COULD NOT FETCH CURSOR - '                  29410000
296200                      ASC-RQST-SW                                 29420000
296300                      DELIMITED BY SIZE                           29430000
296400                      INTO DP013-MESSAGE-TEXT (1)                 29440000
296500              MOVE SQLCA       TO DP013-SQLCA                     29450000
296600              MOVE 'SUT-CART-DIRV-TRKG' TO                        29460000
296700                                   DP013-DB2-TABLE-NAME (1)       29470000
296800              SET DP013-DB2-ABEND                                 29480000
296900                  DP013-XCTL-DISPLAY-RESTART TO TRUE              29490000
297000              PERFORM DP013-0000-PROCESS-ABEND                    29500000
297100     END-EVALUATE.                                                29510000
297200                                                                  29520000
297300                                                                  29530000
297400*----------------------------------------------------------------*29540000
297500*                                                                 29550000
297600*----------------------------------------------------------------*29560000
297700 4320-GET-DIRV-RLSE-IND.                                          29570000
297800                                                                  29580000
297900     EVALUATE TRUE                                                29590000
298000         WHEN ASC-RQST-AUDIT                                      29600000
298100              EXEC SQL                                            29610000
298200                 SELECT                                           29620000
298300                         S015.DIRV_RLSE_IND                       29630000
298400                   INTO                                           29640000
298500                        :SUT00015-DIRV-RLSE-IND                   29650000
298600                                                                  29660000
298700                   FROM  SUT_PO_AUD_REQ   S015                    29670000
298800                  WHERE  S015.PO_NBR       = :DK-PO-NBR           29680000
298900                    AND  S015.RCVR_SEQ_NBR = :DK-REC-SEQ-NBR      29690000
299000                    AND  S015.PO_PREPK_ID  = :DK-PREPK-ID         29700000
299100                   WITH  UR                                       29710000
299200              END-EXEC                                            29720000
299300                                                                  29730000
299400         WHEN ASC-RQST-PO-RCVR-PREPK                              29740000
299500              EXEC SQL                                            29750000
299600                 SELECT                                           29760000
299700                         S015.DIRV_RLSE_IND                       29770000
299800                   INTO                                           29780000
299900                        :SUT00015-DIRV-RLSE-IND                   29790000
300000                                                                  29800000
300100                   FROM  SUT_PO_AUD_REQ   S015                    29810000
300200                  WHERE  S015.PO_NBR       = :DK-PO-NBR           29820000
300300                    AND  S015.RCVR_SEQ_NBR = :DK-REC-SEQ-NBR      29830000
300400                    AND  S015.PO_PREPK_ID  = :DK-PREPK-ID         29840000
300500                   WITH  UR                                       29850000
300600              END-EXEC                                            29860000
300700                                                                  29870000
300800         WHEN ASC-RQST-PO-RCVR-LINE                               29880000
300900              EXEC SQL                                            29890000
301000                 SELECT                                           29900000
301100                         S015.DIRV_RLSE_IND                       29910000
301200                   INTO                                           29920000
301300                        :SUT00015-DIRV-RLSE-IND                   29930000
301400                                                                  29940000
301500                   FROM  SUT_PO_AUD_REQ   S015                    29950000
301600                  WHERE  S015.PO_NBR       = :DK-PO-NBR           29960000
301700                    AND  S015.RCVR_SEQ_NBR = :DK-REC-SEQ-NBR      29970000
301800                    AND  S015.PO_LNE_NBR   = :DK-PO-LNE-NBR       29980000
301900                   WITH  UR                                       29990000
302000              END-EXEC                                            30000000
302100                                                                  30010000
302200         WHEN ASC-RQST-PO-RCVR                                    30020000
302300              EXEC SQL                                            30030000
302400                 SELECT                                           30040000
302500                         S015.DIRV_RLSE_IND                       30050000
302600                   INTO                                           30060000
302700                        :SUT00015-DIRV-RLSE-IND                   30070000
302800                                                                  30080000
302900                   FROM  SUT_PO_AUD_REQ   S015                    30090000
303000                  WHERE  S015.PO_NBR       = :DK-PO-NBR           30100000
303100                    AND  S015.RCVR_SEQ_NBR = :DK-REC-SEQ-NBR      30110000
303200                   WITH  UR                                       30120000
303300              END-EXEC                                            30130000
303400                                                                  30140000
303500     END-EVALUATE.                                                30150000
303600                                                                  30160000
303700     EVALUATE TRUE                                                30170000
303800         WHEN SQLCODE = ZERO                                      30180000
303900         WHEN SQLCODE = -811                                      30190000
304000              CONTINUE                                            30200000
304100         WHEN SQLCODE = +100                                      30210000
304200              CONTINUE                                            30220000
304300                                                                  30230000
304400         WHEN SQLWARN0 NOT = SPACE                                30240000
304500         WHEN SQLCODE NOT = ZERO                                  30250000
304600              MOVE '4320-GET-DIRV-RLSE-IND' TO                    30260000
304700                                   DP013-PARAGRAPH                30270000
304800              MOVE 'SELECT FOR PO BAD' TO                         30280000
304900                                   DP013-MESSAGE-TEXT (1)         30290000
305000              MOVE SQLCA       TO DP013-SQLCA                     30300000
305100              MOVE 'SUT-PO-AUD-REQ    ' TO                        30310000
305200                                   DP013-DB2-TABLE-NAME (1)       30320000
305300              SET DP013-DB2-ABEND                                 30330000
305400                  DP013-XCTL-DISPLAY-RESTART TO TRUE              30340000
305500              PERFORM DP013-0000-PROCESS-ABEND                    30350000
305600     END-EVALUATE.                                                30360000
305700                                                                  30370000
305800*----------------------------------------------------------------*30380000
305900*    COUNT EXPECTED CARTONS                                       30390000
306000*----------------------------------------------------------------*30400000
306100 4330-COUNT-EXPECTED-CARTONS.                                     30410000
306101                                                                  30420000
306110     MOVE SUT00102-PREPK-ID   TO DK-PREPK-ID.                     30430000
306120     MOVE SUT00102-PO-LNE-NBR TO DK-PO-LNE-NBR.                   30440000
306200                                                                  30450000
306210*CT BEGIN 02/04/09 IR #18412                                      30460000
306300     EVALUATE TRUE                                                30470000
306400*        WHEN ASC-RQST-AUDIT                                      30480000
306500*             EXEC SQL                                            30490000
306600*                SELECT  COUNT(*)                                 30500000
306700*                  INTO  :PV-COUNT-EXPECTED                       30510000
306800*                                                                 30520000
306900*                  FROM   TSHPTPO    A                            30530000
307000*                        ,TPKSLIP    B                            30540000
307100*                        ,TINPKSU    C                            30550000
307200*                        ,TSHPUNT    D                            30560000
307300*                        ,TSHUUPC    E                            30570000
307400*                        ,TRECITM    F                            30580000
307500*                  WHERE  A.PO_NBR         = :DK-PO-NBR           30590000
307600*                    AND  A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR      30600000
307700*                    AND  A.PO_NBR         =  B.PO_NBR            30610000
307800*                    AND  A.REC_SEQ_NBR    =  B.REC_SEQ_NBR       30620000
307900*                    AND  A.PO_NBR         =  F.ORD_NBR           30630000
308000*                    AND  A.REC_SEQ_NBR    =  F.REC_SEQ_NBR       30640000
308100*                    AND  B.VER_STAT_CDE   = :PC-A                30650000
308200*                    AND  B.PO_NBR         =  C.PO_NBR            30660000
308300*                    AND  B.SEQ_NBR        =  C.SEQ_NBR           30670000
308400*                    AND  C.SHIPT_UNT_ID   =  D.SHIPT_UNT_ID      30680000
308500*                    AND  D.SHIPT_UNT_ID   =  E.SHIPT_UNT_ID      30690000
308600*                    AND  E.TRN_LNE_NBR    =  F.ORD_LNE_NBR       30700000
308700*                    AND  F.PREPK_ID          = :DK-PREPK-ID      30710000
308800*                    AND  F.PREPK_DRV_LNE_CDE = :PC-A             30720000
308900*                    AND  D.ACTV_IND          = :PC-A             30730000
309000*                   WITH  UR                                      30740000
309100*             END-EXEC                                            30750000
309200*                                                                 30760000
309300         WHEN ASC-PREPK-ORDER                                     30770000
309400              EXEC SQL                                            30780000
309500                 SELECT  COUNT(*)                                 30790000
309600                   INTO  :PV-COUNT-EXPECTED                       30800000
309700                                                                  30810000
309800                   FROM   TSHPTPO    A                            30820000
309900                         ,TPKSLIP    B                            30830000
310000                         ,TINPKSU    C                            30840000
310100                         ,TSHPUNT    D                            30850000
310200                         ,TSHUUPC    E                            30860000
310300                         ,TRECITM    F                            30870000
310400                   WHERE  A.PO_NBR         = :DK-PO-NBR           30880000
310500                     AND  A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR      30890000
310600                     AND  A.PO_NBR         =  B.PO_NBR            30900000
310700                     AND  A.REC_SEQ_NBR    =  B.REC_SEQ_NBR       30910000
310800                     AND  A.PO_NBR         =  F.ORD_NBR           30920000
310900                     AND  A.REC_SEQ_NBR    =  F.REC_SEQ_NBR       30930000
311000                     AND  B.VER_STAT_CDE   = :PC-A                30940000
311100                     AND  B.PO_NBR         =  C.PO_NBR            30950000
311200                     AND  B.SEQ_NBR        =  C.SEQ_NBR           30960000
311300                     AND  C.SHIPT_UNT_ID   =  D.SHIPT_UNT_ID      30970000
311400                     AND  D.SHIPT_UNT_ID   =  E.SHIPT_UNT_ID      30980000
311500                     AND  E.TRN_LNE_NBR    =  F.ORD_LNE_NBR       30990000
311600                     AND  F.PREPK_ID          = :DK-PREPK-ID      31000000
311700                     AND  F.PREPK_DRV_LNE_CDE = :PC-A             31010000
311800                     AND  D.ACTV_IND          = :PC-A             31020000
311900                    WITH  UR                                      31030000
312000              END-EXEC                                            31040000
312100                                                                  31050000
312200                                                                  31060000
312300         WHEN ASC-BULK-CASE-ORDER                                 31070000
312400              EXEC SQL                                            31080000
312500                 SELECT  COUNT(*)                                 31090000
312600                   INTO  :PV-COUNT-EXPECTED                       31100000
312700                                                                  31110000
312800                   FROM   TSHPTPO    A                            31120000
312900                         ,TPKSLIP    B                            31130000
313000                         ,TINPKSU    C                            31140000
313100                         ,TSHPUNT    D                            31150000
313200                         ,TSHUUPC    E                            31160000
313300                         ,TRECITM    F                            31170000
313400                   WHERE  A.PO_NBR         = :DK-PO-NBR           31180000
313500                     AND  A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR      31190000
313600                     AND  A.PO_NBR         =  B.PO_NBR            31200000
313700                     AND  A.REC_SEQ_NBR    =  B.REC_SEQ_NBR       31210000
313800                     AND  A.PO_NBR         =  F.ORD_NBR           31220000
313900                     AND  A.REC_SEQ_NBR    =  F.REC_SEQ_NBR       31230000
314000                     AND  B.VER_STAT_CDE   = :PC-A                31240000
314100                     AND  B.PO_NBR         =  C.PO_NBR            31250000
314200                     AND  B.SEQ_NBR        =  C.SEQ_NBR           31260000
314300                     AND  C.SHIPT_UNT_ID   =  D.SHIPT_UNT_ID      31270000
314400                     AND  D.SHIPT_UNT_ID   =  E.SHIPT_UNT_ID      31280000
314500                     AND  E.TRN_LNE_NBR    =  F.ORD_LNE_NBR       31290000
314520                     AND   F.ORD_LNE_NBR   = :DK-PO-LNE-NBR       31300000
314600                     AND  D.ACTV_IND          = :PC-A             31310000
314700                    WITH  UR                                      31320000
314800              END-EXEC                                            31330000
314900                                                                  31340000
315100         WHEN ASC-PACK-BY-STORE-ORDER                             31350000
315110            EXEC SQL                                              31360000
315200             SELECT COUNT(*)                                      31370000
315210               INTO :PV-COUNT-EXPECTED                            31380000
315220                                                                  31390000
315230               FROM  TSHIPMT   A                                  31400000
315240                    ,TSHPTPO   B                                  31410000
315250                    ,TPKSLIP   C                                  31420000
315260                    ,TINPKSU   D                                  31430000
315270                    ,TSHPUNT   E                                  31440000
315280                                                                  31450000
315290              WHERE  B.PO_NBR         = :DK-PO-NBR                31460000
315291                AND  B.REC_SEQ_NBR    = :DK-REC-SEQ-NBR           31470000
315292                AND  B.PO_NBR         =  C.PO_NBR                 31480000
315293                AND  B.REC_SEQ_NBR    =  C.REC_SEQ_NBR            31490000
315294                AND  B.PRIM_SHIPT_IND = :PC-Y                     31500000
315295                AND  C.VER_STAT_CDE   = :PC-A                     31510000
315296                AND  B.PO_NBR         =  D.PO_NBR                 31520000
315297                AND  D.SEQ_NBR        =  C.SEQ_NBR                31521000
315298                AND  A.SHIPT_ID       =  B.SHIPT_ID               31522000
315299                AND  D.SHIPT_UNT_ID   =  E.SHIPT_UNT_ID           31523000
315300                AND  E.ACTV_IND       = :PC-A                     31524000
315301            END-EXEC                                              31525000
317500                                                                  31526000
317600     END-EVALUATE.                                                31527000
317700                                                                  31528000
317800     EVALUATE TRUE                                                31529000
317900         WHEN SQLCODE = ZERO                                      31529100
318000              CONTINUE                                            31529200
318100         WHEN SQLCODE = +100                                      31529300
318200              CONTINUE                                            31529400
318300         WHEN SQLWARN0 NOT = SPACE                                31529500
318400         WHEN SQLCODE NOT = ZERO                                  31529600
318500              MOVE '4330-COUNT-EXPECTED-CARTONS' TO               31529700
318600                                   DP013-PARAGRAPH                31529800
318700              MOVE 'SELECT FOR PO BAD' TO                         31529900
318800                                   DP013-MESSAGE-TEXT (1)         31530000
318900              MOVE SQLCA       TO DP013-SQLCA                     31540000
319000              MOVE 'SUT_CART_DIRV_TRKG' TO                        31550000
319100                                   DP013-DB2-TABLE-NAME (1)       31560000
319200              SET DP013-DB2-ABEND                                 31570000
319300                  DP013-XCTL-DISPLAY-RESTART TO TRUE              31580000
319400              PERFORM DP013-0000-PROCESS-ABEND                    31590000
319500     END-EVALUATE.                                                31600000
319600                                                                  31610000
319700*----------------------------------------------------------------*31620000
319800*    COUNT RELEASED CARTONS                                       31630000
319900*----------------------------------------------------------------*31640000
320000 4340-COUNT-RELEASED-CARTONS.                                     31650000
320100                                                                  31660000
320110*CT BEGIN 02/04/09 IR #18412                                      31670000
320200     EVALUATE TRUE                                                31680000
320300*        WHEN ASC-RQST-AUDIT                                      31690000
320400*             EXEC SQL                                            31700000
320500*                  SELECT COUNT(*)                                31710000
320600*                    INTO :PV-COUNT-RELEASED                      31720000
320700*                    FROM SUT_CART_DIRV_TRKG                      31730000
320800*                   WHERE PO_NBR       = :DK-PO-NBR               31740000
320900*                    AND  RCVR_SEQ_NBR = :DK-REC-SEQ-NBR          31750000
321000*                    AND  DIRV_RSN_CDE IN ('RLC','RLR', 'RLO')    31760000
321100*             END-EXEC                                            31770000
321200*                                                                 31780000
321300         WHEN ASC-PREPK-ORDER                                     31790000
321400              EXEC SQL                                            31800000
321500                   SELECT COUNT(*)                                31810000
321600                     INTO :PV-COUNT-RELEASED                      31820000
321700                     FROM SUT_CART_DIRV_TRKG                      31830000
321800                    WHERE PO_NBR       = :DK-PO-NBR               31840000
321900                     AND  RCVR_SEQ_NBR = :DK-REC-SEQ-NBR          31850000
322000                     AND  PREPK_ID     = :DK-PREPK-ID             31860000
322100                     AND  DIRV_RSN_CDE IN ('RLC','RLR', 'RLO')    31870000
322200              END-EXEC                                            31880000
322300                                                                  31890000
323500         WHEN ASC-BULK-CASE-ORDER                                 31900000
323600**            THIS IS NOT A PREPACK OR A PACK-BY-STORE            31910000
323700              EXEC SQL                                            31920000
323800                   SELECT COUNT(*)                                31930000
323900                     INTO :PV-COUNT-RELEASED                      31940000
324000                     FROM SUT_CART_DIRV_TRKG                      31950000
324100                    WHERE PO_NBR       = :DK-PO-NBR               31960000
324200                     AND  RCVR_SEQ_NBR = :DK-REC-SEQ-NBR          31970000
324300                     AND  PO_LNE_NBR   = :DK-PO-LNE-NBR           31980000
324400                     AND  DIRV_RSN_CDE IN ('RLC','RLR', 'RLO')    31990000
324500              END-EXEC                                            32000000
324501                                                                  32010000
324510         WHEN ASC-PACK-BY-STORE-ORDER                             32020000
324520              EXEC SQL                                            32030000
324530                   SELECT COUNT(*)                                32040000
324540                     INTO :PV-COUNT-RELEASED                      32050000
324550                     FROM SUT_CART_DIRV_TRKG                      32060000
324560                    WHERE PO_NBR       = :DK-PO-NBR               32070000
324570                     AND  RCVR_SEQ_NBR = :DK-REC-SEQ-NBR          32080000
324590                     AND  DIRV_RSN_CDE IN ('RLC','RLR', 'RLO')    32090000
324591              END-EXEC                                            32100000
324600                                                                  32110000
324700     END-EVALUATE.                                                32120000
324800                                                                  32130000
324900     EVALUATE TRUE                                                32140000
325000         WHEN SQLCODE = ZERO                                      32150000
325100              CONTINUE                                            32160000
325200         WHEN SQLCODE = +100                                      32170000
325300              CONTINUE                                            32180000
325400         WHEN SQLWARN0 NOT = SPACE                                32190000
325500         WHEN SQLCODE NOT = ZERO                                  32200000
325600              MOVE '4340-COUNT-RELEASED-CARTONS' TO               32210000
325700                                   DP013-PARAGRAPH                32220000
325800              MOVE 'SELECT FOR RELEASED COUNT ' TO                32230000
325900                                   DP013-MESSAGE-TEXT (1)         32240000
326000              MOVE SQLCA       TO DP013-SQLCA                     32250000
326100              MOVE 'SUT_CART_DIRV_TRKG' TO                        32260000
326200                                   DP013-DB2-TABLE-NAME (1)       32270000
326300              SET DP013-DB2-ABEND                                 32280000
326400                  DP013-XCTL-DISPLAY-RESTART TO TRUE              32290000
326500              PERFORM DP013-0000-PROCESS-ABEND                    32300000
326600     END-EVALUATE.                                                32310000
326700                                                                  32320000
326800                                                                  32330000
326900*----------------------------------------------------------------*32340000
327000*                                                                *32350000
327100*----------------------------------------------------------------*32360000
327200 4350-SELECT-TRECITM.                                             32370000
327300                                                                  32380000
327400     MOVE ASC-PO-NBR          TO DK-PO-NBR.                       32390000
327500     MOVE ASC-RCVR            TO DK-RCVR-SEQ-NBR.                 32400000
327600*CT BEGIN 02/03/09 IR #18412                                      32410000
327700     MOVE SUT00102-PREPK-ID   TO DK-PREPK-ID.                     32420000
327800     MOVE SUT00102-PO-LNE-NBR TO DK-PO-LNE-NBR.                   32430000
327900*CT END   02/03/09                                                32440000
328000                                                                  32450000
328100     EVALUATE TRUE                                                32460000
328200*        WHEN ASC-RQST-AUDIT                                      32470000
328300*             EXEC SQL                                            32480000
328400*                 SELECT  ORD_NBR                                 32490000
328500*                        ,REC_SEQ_NBR                             32500000
328600*                        ,PREPK_ID                                32510000
328700*                        ,ORD_LNE_NBR                             32520000
328800*                   INTO  :RECITM-ORD-NBR                         32530000
328900*                        ,:RECITM-REC-SEQ-NBR                     32540000
329000*                        ,:RECITM-PREPK-ID                        32550000
329100*                        ,:RECITM-ORD-LNE-NBR                     32560000
329200*                   FROM  TRECITM                                 32570000
329300*                  WHERE  ORD_NBR        = :DK-PO-NBR             32580000
329400*                    AND  REC_SEQ_NBR    = :DK-RCVR-SEQ-NBR       32590000
329500*                    AND  PREPK_ID       = :DK-PREPK-ID           32600000
329600*                    AND  PREPK_DRV_LNE_CDE = :PC-A               32610000
329700*             END-EXEC                                            32620000
329800                                                                  32630000
329900         WHEN ASC-PREPK-ORDER                                     32640000
330000              EXEC SQL                                            32650000
330100                  SELECT  ORD_NBR                                 32660000
330200                         ,REC_SEQ_NBR                             32670000
330300                         ,PREPK_ID                                32680000
330400                         ,ORD_LNE_NBR                             32690000
330500                    INTO  :RECITM-ORD-NBR                         32700000
330600                         ,:RECITM-REC-SEQ-NBR                     32710000
330700                         ,:RECITM-PREPK-ID                        32720000
330800                         ,:RECITM-ORD-LNE-NBR                     32730000
330900                    FROM  TRECITM                                 32740000
331000                   WHERE  ORD_NBR        = :DK-PO-NBR             32750000
331100                     AND  REC_SEQ_NBR    = :DK-RCVR-SEQ-NBR       32760000
331200                     AND  PREPK_ID       = :DK-PREPK-ID           32770000
331300                     AND  PREPK_DRV_LNE_CDE = :PC-A               32780000
331400              END-EXEC                                            32790000
331500                                                                  32800000
333600         WHEN ASC-BULK-CASE-ORDER                                 32810000
333610**            THIS IS NOT A PREPACK OR A PACK-BY-STORE            32820000
333620              EXEC SQL                                            32830000
333630                  SELECT  ORD_NBR                                 32840000
333640                         ,REC_SEQ_NBR                             32850000
333650                         ,PREPK_ID                                32860000
333660                         ,ORD_LNE_NBR                             32870000
333670                    INTO  :RECITM-ORD-NBR                         32880000
333680                         ,:RECITM-REC-SEQ-NBR                     32890000
333690                         ,:RECITM-PREPK-ID                        32900000
333700                         ,:RECITM-ORD-LNE-NBR                     32910000
333800                    FROM  TRECITM                                 32920000
333900                   WHERE  ORD_NBR        = :DK-PO-NBR             32930000
334000                     AND  REC_SEQ_NBR    = :DK-RCVR-SEQ-NBR       32940000
334100                     AND  ORD_LNE_NBR    = :DK-PO-LNE-NBR         32950000
334200                     AND  PREPK_DRV_LNE_CDE = :PC-A               32960000
334300              END-EXEC                                            32970000
334301                                                                  32980000
334310         WHEN ASC-PACK-BY-STORE-ORDER                             32990000
334330              EXEC SQL                                            33000000
334340                  SELECT  ORD_NBR                                 33010000
334350                         ,REC_SEQ_NBR                             33020000
334360                         ,PREPK_ID                                33030000
334370                         ,ORD_LNE_NBR                             33040000
334380                    INTO  :RECITM-ORD-NBR                         33050000
334390                         ,:RECITM-REC-SEQ-NBR                     33060000
334391                         ,:RECITM-PREPK-ID                        33070000
334392                         ,:RECITM-ORD-LNE-NBR                     33080000
334393                    FROM  TRECITM                                 33090000
334394                   WHERE  ORD_NBR        = :DK-PO-NBR             33100000
334395                     AND  REC_SEQ_NBR    = :DK-RCVR-SEQ-NBR       33110000
334398              END-EXEC                                            33120000
334400                                                                  33130000
334500     END-EVALUATE.                                                33140000
334600                                                                  33150000
334700     EVALUATE TRUE                                                33160000
334800         WHEN SQLCODE = ZERO                                      33170000
334900         WHEN SQLCODE = -811                                      33180000
335000              CONTINUE                                            33190000
335100         WHEN SQLCODE = +100                                      33200000
335200              CONTINUE                                            33210000
335300         WHEN SQLWARN0 NOT = SPACE                                33220000
335400         WHEN SQLCODE NOT = ZERO                                  33230000
335500              MOVE '7120-SELECT-TRECITM    '  TO                  33240000
335600                                   DP013-PARAGRAPH                33250000
335700              MOVE 'SELECT FOR PO BAD' TO                         33260000
335800                                   DP013-MESSAGE-TEXT (1)         33270000
335900              MOVE SQLCA       TO DP013-SQLCA                     33280000
336000              MOVE 'TRECITM           ' TO                        33290000
336100                                   DP013-DB2-TABLE-NAME (1)       33300000
336200              SET DP013-DB2-ABEND                                 33310000
336300                  DP013-XCTL-DISPLAY-RESTART TO TRUE              33320000
336400              PERFORM DP013-0000-PROCESS-ABEND                    33330000
336500     END-EVALUATE.                                                33340000
336600                                                                  33350000
336700                                                                  33360000
336800*CT BEGIN 01/28/09 IR #18061                                      33370000
336900*----------------------------------------------------------------*33380000
337000*    USE AUDIT CONTROL NUMBER TO                                  33390000
337100*----------------------------------------------------------------*33400000
337200 4360-SELECT-AUDIT-STATUS.                                        33410000
337300                                                                  33420000
337400     MOVE SUT00102-AUD-CNTL-NBR TO DK-AUD-CNTL-NBR.               33430000
337500                                                                  33440000
337600     EXEC SQL                                                     33450000
337700        SELECT                                                    33460000
337800                S015.AUD_STAT_CDE                                 33470000
337900                                                                  33480000
338000          INTO                                                    33490000
338100                :SUT00015-AUD-STAT-CDE                            33500000
338200                                                                  33510000
338300          FROM  SUT_PO_AUD_REQ   S015                             33520000
338400         WHERE  S015.AUD_CNTL_NBR = :DK-AUD-CNTL-NBR              33530000
338500          WITH  UR                                                33540000
338600     END-EXEC.                                                    33550000
338700                                                                  33560000
338800     EVALUATE TRUE                                                33570000
338900         WHEN SQLCODE = ZERO                                      33580000
339000              CONTINUE                                            33590000
339100         WHEN SQLCODE = +100                                      33600000
339200              MOVE 'NOTFOUND' TO SUT00015-AUD-STAT-CDE            33610000
339300         WHEN SQLWARN0 NOT = SPACE                                33620000
339400         WHEN SQLCODE NOT = ZERO                                  33630000
339500              MOVE '4360-SELECT-AUDIT-STATUS  ' TO                33640000
339600                                   DP013-PARAGRAPH                33650000
339700              MOVE 'SELECT AUD STAT CDE OF ' TO                   33660000
339800                                   DP013-MESSAGE-TEXT (1)         33670000
339900              MOVE DK-AUD-CNTL-NBR           TO                   33680000
340000                                   DP013-MESSAGE-TEXT (2)         33690000
340100              MOVE SQLCA       TO DP013-SQLCA                     33700000
340200              MOVE 'SUT-PO-AUD-REQ    ' TO                        33710000
340300                                   DP013-DB2-TABLE-NAME (1)       33720000
340400              SET DP013-DB2-ABEND                                 33730000
340500                  DP013-XCTL-DISPLAY-RESTART TO TRUE              33740000
340600              PERFORM DP013-0000-PROCESS-ABEND                    33750000
340700     END-EVALUATE.                                                33760000
340800                                                                  33770000
340900*----------------------------------------------------------------*33780000
341000*    GET DIRECTIVE CREATE TIMESTAMP USING OPER,PO,RCVR,LINE,PREPK 33790000
341100*----------------------------------------------------------------*33800000
341200 4361-SELECT-MIN-CRE-TMST.                                        33810000
341300                                                                  33820000
341400     MOVE SUT00102-PO-LNE-NBR  TO DK-PO-LNE-NBR.                  33830000
341500     MOVE SUT00102-PREPK-ID    TO DK-PREPK-ID.                    33840000
341600                                                                  33850000
341700     EXEC SQL                                                     33860000
341800                                                                  33870000
341900     SELECT  MIN(CRE_TMST)                                        33880000
342000       INTO :SUT00102-CRE-TMST                                    33890000
342100       FROM  SUT_CART_DIRV_TRKG  A                                33900000
342200      WHERE  A.OPER_UNT_ID    = :DK-OPER-UNT-ID                   33910000
342300        AND  A.PO_NBR         = :DK-PO-NBR                        33920000
342400        AND  A.RCVR_SEQ_NBR   = :DK-REC-SEQ-NBR                   33930000
342500        AND  A.PO_LNE_NBR     = :DK-PO-LNE-NBR                    33940000
342600        AND  A.PREPK_ID       = :DK-PREPK-ID                      33950000
342700     WITH UR                                                      33960000
342800                                                                  33970000
342900     END-EXEC.                                                    33980000
343000                                                                  33990000
343100     EVALUATE TRUE                                                34000000
343200         WHEN SQLCODE      = ZERO                                 34010000
343300              CONTINUE                                            34020000
343400         WHEN SQLWARN0 NOT = SPACE                                34030000
343500         WHEN SQLCODE  NOT = ZERO                                 34040000
343600              MOVE '4361-SELECT-MIN-CRE-TMST  ' TO                34050000
343700                                   DP013-PARAGRAPH                34060000
343800              MOVE 'SELECT MIN CRE TMST OF ' TO                   34070000
343900                                   DP013-MESSAGE-TEXT (1)         34080000
344000              MOVE DK-PO-NBR                 TO                   34090000
344100                                   DP013-MESSAGE-TEXT (2)         34100000
344200              MOVE DK-REC-SEQ-NBR            TO                   34110000
344300                                   DP013-MESSAGE-TEXT (3)         34120000
344400              MOVE SQLCA       TO DP013-SQLCA                     34130000
344410              MOVE 'SUT_CART_DIRV_TRKG' TO                        34140000
344420                                   DP013-DB2-TABLE-NAME (1)       34150000
344430              SET DP013-DB2-ABEND                                 34160000
344440                  DP013-XCTL-DISPLAY-RESTART TO TRUE              34170000
344450              PERFORM DP013-0000-PROCESS-ABEND                    34180000
344460     END-EVALUATE.                                                34190000
344470                                                                  34200000
344471*----------------------------------------------------------------*34210000
344472*    GET DIRECTIVE STORE INFO USING OPER,O, RCVR,LINE,PREPK,TMST  34220000
344473*----------------------------------------------------------------*34230000
344474 4362-SELECT-STR-NBR-ZN.                                          34240000
344475                                                                  34250000
344476     MOVE SUT00102-CRE-TMST    TO DK-CRE-TMST.                    34260000
344477                                                                  34270000
344478     EXEC SQL                                                     34280000
344479                                                                  34290000
344480     SELECT  STR_NBR                                              34300000
344481            ,STR_ZN_ID                                            34310000
344483       INTO :SUT00102-STR-NBR                                     34320000
344484           ,:SUT00102-STR-ZN-ID                                   34330000
344488       FROM  SUT_CART_DIRV_TRKG  A                                34340000
344489      WHERE  A.OPER_UNT_ID    = :DK-OPER-UNT-ID                   34350000
344490        AND  A.PO_NBR         = :DK-PO-NBR                        34360000
344491        AND  A.RCVR_SEQ_NBR   = :DK-REC-SEQ-NBR                   34370000
344492        AND  A.PO_LNE_NBR     = :DK-PO-LNE-NBR                    34380000
344493        AND  A.PREPK_ID       = :DK-PREPK-ID                      34390000
344494        AND  A.CRE_TMST       = :DK-CRE-TMST                      34400000
344495     WITH UR                                                      34410000
344496                                                                  34420000
344497     END-EXEC.                                                    34430000
344498                                                                  34440000
344499     EVALUATE TRUE                                                34441000
344500         WHEN SQLCODE      = ZERO                                 34442000
344501              CONTINUE                                            34443000
344502         WHEN SQLWARN0 NOT = SPACE                                34444000
344503         WHEN SQLCODE  NOT = ZERO                                 34445000
344504              MOVE '4362-SELECT-STR-NBR-ZN    ' TO                34446000
344505                                   DP013-PARAGRAPH                34447000
344506              MOVE 'SELECT STR NBR AND ID  ' TO                   34448000
344507                                   DP013-MESSAGE-TEXT (1)         34449000
344508              MOVE DK-PO-NBR                 TO                   34450000
344509                                   DP013-MESSAGE-TEXT (2)         34450100
344510              MOVE DK-REC-SEQ-NBR            TO                   34450200
344511                                   DP013-MESSAGE-TEXT (3)         34450300
344512              MOVE SQLCA       TO DP013-SQLCA                     34450400
344513              MOVE 'SUT_CART_DIRV_TRKG' TO                        34450500
344514                                   DP013-DB2-TABLE-NAME (1)       34450600
344515              SET DP013-DB2-ABEND                                 34450700
344516                  DP013-XCTL-DISPLAY-RESTART TO TRUE              34450800
344517              PERFORM DP013-0000-PROCESS-ABEND                    34450900
344518     END-EVALUATE.                                                34451000
344519                                                                  34451100
344520*CT END   01/28/09 IR #18061                                      34451200
344521 4363-SELECT-MAX-CRE-TMST.                                        34451300
344525                                                                  34451400
344526     EXEC SQL                                                     34451500
344527                                                                  34451600
344528     SELECT  MAX(CRE_TMST)                                        34451700
344529       INTO :PV-MAX-CRE-TMST                                      34451800
344530       FROM  SUT_CART_DIRV_TRKG  A                                34451900
344531      WHERE  A.OPER_UNT_ID    = :DK-OPER-UNT-ID                   34452000
344532        AND  A.PO_NBR         = :DK-PO-NBR                        34452100
344533        AND  A.RCVR_SEQ_NBR   = :DK-REC-SEQ-NBR                   34452200
344534        AND  A.PO_LNE_NBR     = :DK-PO-LNE-NBR                    34452300
344535        AND  A.PREPK_ID       = :DK-PREPK-ID                      34452400
344536     WITH UR                                                      34452500
344537                                                                  34452600
344538     END-EXEC.                                                    34452700
344539                                                                  34452800
344540     EVALUATE TRUE                                                34452900
344541         WHEN SQLCODE      = ZERO                                 34453000
344542              CONTINUE                                            34453100
344543         WHEN SQLWARN0 NOT = SPACE                                34453200
344544         WHEN SQLCODE  NOT = ZERO                                 34453300
344545              MOVE '4363-SELECT-AUD-FALR-RSN  ' TO                34453400
344546                                   DP013-PARAGRAPH                34453500
344547              MOVE 'SELECT MAX CRE TMST OF ' TO                   34453600
344548                                   DP013-MESSAGE-TEXT (1)         34453700
344549              MOVE DK-PO-NBR                 TO                   34453800
344550                                   DP013-MESSAGE-TEXT (2)         34453900
344551              MOVE DK-REC-SEQ-NBR            TO                   34454000
344552                                   DP013-MESSAGE-TEXT (3)         34454100
344553              MOVE SQLCA       TO DP013-SQLCA                     34454200
344554              MOVE 'SUT_CART_DIRV_TRKG' TO                        34454300
344555                                   DP013-DB2-TABLE-NAME (1)       34454400
344556              SET DP013-DB2-ABEND                                 34454500
344557                  DP013-XCTL-DISPLAY-RESTART TO TRUE              34454600
344558              PERFORM DP013-0000-PROCESS-ABEND                    34454700
344559     END-EVALUATE.                                                34454800
344560                                                                  34454900
344570 4364-SELECT-AUD-FALR-RSN.                                        34455000
344590                                                                  34455100
344591     EXEC SQL                                                     34455200
344592                                                                  34455300
344595     SELECT  AUD_FALR_RSN_NM                                      34455400
344598       INTO :SUT00102-AUD-FALR-RSN-NM                             34455500
344599                              :DN-AUD-FALR-RSN-NM                 34455600
344600       FROM  SUT_CART_DIRV_TRKG  A                                34455700
344601      WHERE  A.OPER_UNT_ID    = :DK-OPER-UNT-ID                   34455800
344602        AND  A.PO_NBR         = :DK-PO-NBR                        34455900
344603        AND  A.RCVR_SEQ_NBR   = :DK-REC-SEQ-NBR                   34456000
344604        AND  A.PO_LNE_NBR     = :DK-PO-LNE-NBR                    34457000
344605        AND  A.PREPK_ID       = :DK-PREPK-ID                      34458000
344606        AND  A.CRE_TMST       = :PV-MAX-CRE-TMST                  34459000
344607     WITH UR                                                      34460000
344608                                                                  34460100
344609     END-EXEC.                                                    34460200
344610                                                                  34460300
344611     EVALUATE TRUE                                                34460400
344612         WHEN SQLCODE      = ZERO                                 34460500
344613         WHEN SQLCODE      = +100                                 34460600
344614              CONTINUE                                            34460700
344615         WHEN SQLWARN0 NOT = SPACE                                34460800
344616         WHEN SQLCODE  NOT = ZERO                                 34460900
344617              MOVE '4364-SELECT-AUD-FALR-RSN  ' TO                34461000
344618                                   DP013-PARAGRAPH                34461100
344619              MOVE 'SELECT AUD FLR REASON  ' TO                   34461200
344620                                   DP013-MESSAGE-TEXT (1)         34461300
344621              MOVE DK-PO-NBR                 TO                   34461400
344622                                   DP013-MESSAGE-TEXT (2)         34461500
344623              MOVE DK-REC-SEQ-NBR            TO                   34461600
344624                                   DP013-MESSAGE-TEXT (3)         34461700
344625              MOVE SQLCA       TO DP013-SQLCA                     34461800
344626              MOVE 'SUT_CART_DIRV_TRKG' TO                        34461900
344627                                   DP013-DB2-TABLE-NAME (1)       34462000
344628              SET DP013-DB2-ABEND                                 34462100
344629                  DP013-XCTL-DISPLAY-RESTART TO TRUE              34462200
344630              PERFORM DP013-0000-PROCESS-ABEND                    34462300
344631     END-EVALUATE.                                                34462400
344632                                                                  34462500
344633*----------------------------------------------------------------*34462600
344634* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *34462700
344635*----------------------------------------------------------------*34462800
344636 4400-MOVE-COMMAREA-TO-SCREEN.                                    34462900
344637     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             34463000
344638         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          34463100
344639         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          34463200
344640             MOVE +1    TO ASC-BLK-SUB                            34463300
344641             PERFORM 5100-WRITE-TEMP-STORAGE                      34463400
344642             ADD +1     TO ASC-BLK-SUB                            34463500
344643             PERFORM 5100-WRITE-TEMP-STORAGE                      34463600
344644             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             34463700
344645                 GIVING PV-BLOCK-NUMBER                           34463800
344646                 REMAINDER PV-REMAINDER                           34463900
344647             IF  PV-REMAINDER > ZERO                              34464000
344648                 ADD +1 TO PV-BLOCK-NUMBER                        34464100
344649             END-IF                                               34464200
344650             MOVE +1    TO ASC-BLK-SUB                            34464300
344651             PERFORM 4410-READ-TEMP-STORAGE                       34464400
344652             ADD +1     TO ASC-BLK-SUB                            34464500
344660                           PV-BLOCK-NUMBER                        34464600
344700             PERFORM 4410-READ-TEMP-STORAGE                       34464700
344800     END-IF.                                                      34464800
344900     MOVE +1            TO ASC-BLK-SUB.                           34464900
345000     COMPUTE ASC-ITEM-SUB =                                       34465000
345100         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              34465100
345200         + PC-ITEMS-PER-PANEL).                                   34465200
345300*                                                                 34465300
345400     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        34465400
345500         ADD +1         TO ASC-BLK-SUB                            34465500
345600         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            34465600
345700     END-IF.                                                      34465700
345800*                                                                 34465800
345900     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           34465900
346000         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                34466000
346100     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        34467000
346200     PERFORM 4420-FORMAT-LIST-LINES                               34468000
346300         VARYING PV-SUB                                           34469000
346400         FROM PC-ITEMS-PER-PANEL BY -1                            34470000
346500         UNTIL PV-SUB < +1.                                       34480000
346600*                                                                 34490000
346700     COMPUTE ASC-ITEMS-DISPLAYED =                                34500000
346800         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          34510000
346900     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    34520000
347000                                      ASTRTITO.                   34530000
347100     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    34540000
347200     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    34550000
347300     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            34560000
347400                                   TO ASELITO.                    34570000
347500     MOVE ASC-OPER-UNT-ID          TO AOPRUNTO.                   34580000
347510     MOVE ASC-PO-NBR               TO PV-PO-NBR.                  34590000
347520     MOVE ASC-RCVR                 TO PV-RCVR-NBR.                34600000
347530     MOVE PV-PO-RCVR-FORMAT        TO APORCVRO.                   34610000
348000     MOVE ASC-SCAC                 TO ASCACO.                     34620000
348100     MOVE ASC-TRAILER              TO ATRLRO.                     34630000
348200     MOVE ASC-TRIP-ID              TO ATRIPIDO.                   34640000
348300     MOVE ASC-TRAILER-STATUS       TO ATRLSTTO.                   34650000
348400     MOVE ASC-PACK-TYPE            TO APCKTPO.                    34660000
348500**?? 17886 IR REPLACED FOLLOWING TWO LINES WITH ASC-COUNTS.       34670000
348600**?? MOVE PV-COUNT-EXPECTED-HDR    TO AEXPCTNO.                   34680000
348700**?? MOVE PV-COUNT-DIRECTIVE-HDR   TO ADIRCTNO.                   34690000
348800                                                                  34700000
348900     MOVE ASC-EXPECTED-CARTONS     TO AEXPCTNO.                   34710000
349000     MOVE ASC-DIRECTIVE-CARTONS    TO ADIRCTNO.                   34720000
349100                                                                  34730000
349200     STRING ASC-ARRIVE-DATE (6:2) '/'                             34740000
349300            ASC-ARRIVE-DATE (9:2) '/'                             34750000
349400            ASC-ARRIVE-DATE (3:2)                                 34760000
349500            DELIMITED BY SIZE                                     34770000
349600            INTO AARRDATO.                                        34780000
349700                                                                  34790000
349800     IF  DP020-MSG-NUMBER-X = SPACE                               34800000
349900         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  34810000
350000*            --- MORE ITEMS TO DISPLAY ----                       34820000
350100             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            34830000
350200             SET DP020-MSG-INFORMATIONAL TO TRUE                  34840000
350300         END-IF                                                   34850000
350400     END-IF.                                                      34860000
350500                                                                  34870000
350600*----------------------------------------------------------------*34880000
350700*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *34890000
350800*----------------------------------------------------------------*34900000
350900 4410-READ-TEMP-STORAGE.                                          34910000
351000     EXEC CICS                                                    34920000
351100         READQ TS                                                 34930000
351200             QUEUE (ASC-LIST-QUEUE-NAME)                          34940000
351300             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               34950000
351400             ITEM  (PV-BLOCK-NUMBER)                              34960000
351500             RESP  (PV-CICS-RESP)                                 34970000
351600     END-EXEC.                                                    34980000
351700                                                                  34990000
351800     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       35000000
351900       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     35010000
352000         CONTINUE                                                 35020000
352100     ELSE                                                         35030000
352200         SET DP013-CICS-ABEND     TO TRUE                         35040000
352300         SET DP013-NO-ROLLBACK    TO TRUE                         35050000
352400         MOVE '4410-READ-TEMP-STORAGE' TO DP013-PARAGRAPH         35060000
352500         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      35070000
352600                                  TO DP013-MESSAGE-TEXT(1)        35080000
352700         PERFORM DP013-0000-PROCESS-ABEND                         35090000
352800     END-IF.                                                      35100000
352900                                                                  35110000
353000     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             35120000
353100*                                                                 35130000
353200     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         35140000
353300         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               35150000
353400     END-IF.                                                      35160000
353500                                                                  35170000
353600*----------------------------------------------------------------*35180000
353700*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *35190000
353800*----------------------------------------------------------------*35200000
353900 4420-FORMAT-LIST-LINES.                                          35210000
354000     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      35220000
354100         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                35230000
354200         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           35240000
354300                                    MR-CTN-NOT-RCVDA (PV-SUB)     35250000
354400         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           35260000
354500                                    MR-CTN-NOT-RCVDH (PV-SUB)     35270000
354600         MOVE SPACES             TO MR-SELECTI      (PV-SUB)      35280000
354700                                    MR-ACTION       (PV-SUB)      35290000
354800                                    MR-SKU          (PV-SUB)      35300000
354900                                    MR-FAIL-RSN     (PV-SUB)      35310000
355000                                    MR-CREATE-DTE (PV-SUB)        35320000
355100                                    MR-CREATE-TME (PV-SUB)        35330000
355200         MOVE 0                  TO MR-EXP-CTNS (PV-SUB)          35340000
355300                                    MR-DRTV-CTNS (PV-SUB)         35350000
355400                                    MR-RLSD-CTNS (PV-SUB)         35360000
355500                                    MR-LINE-NBR  (PV-SUB)         35370000
355600                                    MR-AUD-CNTL-NBR (PV-SUB)      35380000
355700     ELSE                                                         35390000
355800         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      35400000
355900                                                   > SPACE        35410000
356000             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 35420000
356100                                          TO MR-SELECTI (PV-SUB)  35430000
356200             MOVE ASC-CTN-NOT-RCVD     (ASC-BLK-SUB ASC-ITEM-SUB) 35440000
356300                                     TO MR-CTN-NOT-RCVD (PV-SUB)  35450000
356400         ELSE                                                     35460000
356500             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      35470000
356600                                           TO MR-SELECTI (PV-SUB) 35480000
356700             MOVE ASC-CTN-NOT-RCVD     (ASC-BLK-SUB ASC-ITEM-SUB) 35490000
356800                                     TO MR-CTN-NOT-RCVD (PV-SUB)  35500000
356900         END-IF                                                   35510000
357000                                                                  35520000
357100         IF  DP030-SET-CURSOR-TRAILER                             35530000
357200             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)35540000
357300                 > SPACE)                                         35550000
357400               OR (PV-SUB = 1))                                   35560000
357500                SET DP030-SET-CURSOR-APPL-1 TO TRUE               35570000
357600                MOVE -1          TO MR-SELECTL (PV-SUB)           35580000
357700             END-IF                                               35590000
357800         END-IF                                                   35600000
357900*>>>>>>>>                                                         35610000
358000         MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)               35620000
358100                                            TO MR-ACTION (PV-SUB) 35630000
358200         PERFORM 4425-BUILD-LINE                                  35640000
358300     END-IF.                                                      35650000
358400     SUBTRACT +1 FROM ASC-ITEM-SUB                                35660000
358500     IF  ASC-ITEM-SUB < + 1                                       35670000
358600         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  35680000
358700         MOVE +1                 TO ASC-BLK-SUB                   35690000
358800     END-IF.                                                      35700000
358900                                                                  35710000
359000****************************************************************  35720000
359100*                                                              *  35730000
359200*                                                              *  35740000
359300****************************************************************  35750000
359400 4425-BUILD-LINE.                                                 35760000
359500                                                                  35770000
359600     EVALUATE TRUE                                                35780000
359700         WHEN ASC-PREPK-ORDER                                     35790000
359800              MOVE ASC-LNE-NBR                                    35800000
359900                          (ASC-BLK-SUB ASC-ITEM-SUB)              35810000
360000                          TO MR-LINE-NBR (PV-SUB)                 35820000
360100              STRING 'PK-' ASC-PREPACK-ID                         35830000
360200                          (ASC-BLK-SUB ASC-ITEM-SUB)              35840000
360300                      DELIMITED BY SIZE                           35850000
360400                      INTO MR-SKU (PV-SUB)                        35860000
360500         WHEN ASC-PACK-BY-STORE-ORDER                             35870000
360600              MOVE 0       TO MR-LINE-NBR (PV-SUB)                35880000
360700              MOVE 'PBS RCVR'  TO MR-SKU (PV-SUB)                 35890000
360800                                                                  35900000
360900         WHEN ASC-BULK-CASE-ORDER                                 35910000
361000              MOVE ASC-LNE-NBR                                    35920000
361100                          (ASC-BLK-SUB ASC-ITEM-SUB)              35930000
361200                          TO MR-LINE-NBR (PV-SUB)                 35940000
361210*CT BEGIN IR 18,412                                               35950000
361300              PERFORM 4426-GET-SKU                                35960000
361310*CT END   IR 18,412                                               35970000
361400              MOVE ASC-SKU (ASC-BLK-SUB ASC-ITEM-SUB)             35980000
361500                            TO MR-SKU    (PV-SUB)                 35990000
361600     END-EVALUATE.                                                36000000
361700     MOVE ASC-EXP-CTNS    (ASC-BLK-SUB ASC-ITEM-SUB)              36010000
361800                   TO  MR-EXP-CTNS       (PV-SUB).                36020000
361900     MOVE ASC-DRTV-CTNS   (ASC-BLK-SUB ASC-ITEM-SUB)              36030000
362000                   TO  MR-DRTV-CTNS      (PV-SUB).                36040000
362100     MOVE ASC-RLSD-CTNS   (ASC-BLK-SUB ASC-ITEM-SUB)              36050000
362200                   TO  MR-RLSD-CTNS      (PV-SUB).                36060000
362300     MOVE ASC-AUD-FALR-RSN-NM                                     36070000
362400                          (ASC-BLK-SUB ASC-ITEM-SUB)              36080000
362500                   TO  MR-FAIL-RSN       (PV-SUB).                36090000
362600     MOVE ASC-AUD-CNTL-NBR(ASC-BLK-SUB ASC-ITEM-SUB)              36100000
362700                   TO  MR-AUD-CNTL-NBR   (PV-SUB).                36110000
362800     MOVE ASC-CTN-NOT-RCVD(ASC-BLK-SUB ASC-ITEM-SUB)              36120000
362900                   TO  MR-CTN-NOT-RCVD   (PV-SUB).                36130000
363000     IF ASC-CTN-NOT-RCVD(ASC-BLK-SUB ASC-ITEM-SUB)                36140000
363100                    = SPACE  OR                                   36150000
363200                      LOW-VALUES                                  36160000
363300        MOVE DP015-UNP-ALP-NOR-OFF TO                             36170000
363400                          MR-CTN-NOT-RCVDA (PV-SUB)               36180000
363500        MOVE DP015-GREEN           TO                             36190000
363600                          MR-CTN-NOT-RCVDC (PV-SUB)               36200000
363700        MOVE DP015-UNDERLINE       TO                             36210000
363800                          MR-CTN-NOT-RCVDH (PV-SUB)               36220000
363900     ELSE                                                         36230000
364000        MOVE DP015-PRO-NOR-OFF TO                                 36240000
364100                          MR-CTN-NOT-RCVDA (PV-SUB)               36250000
364200        MOVE DP015-BLUE            TO                             36260000
364300                          MR-CTN-NOT-RCVDC (PV-SUB)               36270000
364400        MOVE DP015-HL-OFF          TO                             36280000
364500                          MR-CTN-NOT-RCVDH (PV-SUB)               36290000
364600     END-IF.                                                      36300000
364700                                                                  36310000
364800     STRING ASC-CREATE-TMST                                       36320000
364900               (ASC-BLK-SUB ASC-ITEM-SUB) (6:6)                   36330000
365000            ASC-CREATE-TMST                                       36340000
365100               (ASC-BLK-SUB ASC-ITEM-SUB) (3:2)                   36350000
365200            DELIMITED BY SIZE                                     36360000
365300            INTO MR-CREATE-DTE (PV-SUB).                          36370000
365400     MOVE ASC-CREATE-TMST                                         36380000
365500               (ASC-BLK-SUB ASC-ITEM-SUB) (12:8)                  36390000
365600              TO MR-CREATE-TME (PV-SUB).                          36400000
365700                                                                  36410000
365710*CT BEGIN IR 18,412                                               36420000
365800*----------------------------------------------------------------*36430000
365900*  GET SKU FOR CASE PACK ORDERS USING PO AND RCVR                 36440000
366000*----------------------------------------------------------------*36450000
366100 4426-GET-SKU.                                                    36460000
366200                                                                  36470000
366300     MOVE ASC-PO-NBR          TO DK-PO-NBR.                       36480000
366400     MOVE ASC-RCVR            TO DK-RCVR-SEQ-NBR.                 36490000
366410     MOVE ASC-LNE-NBR (ASC-BLK-SUB ASC-ITEM-SUB)                  36500000
366430                              TO DK-PO-LNE-NBR.                   36510000
366500                                                                  36520000
366600     EXEC SQL                                                     36530000
366700        SELECT  B.SKU_NBR                                         36540000
366800          INTO :XLT00003-SKU-NBR                                  36550000
366900          FROM TRECITM A                                          36560000
366910              ,XLT_SKU B                                          36570000
366920         WHERE A.ORD_NBR        = :DK-PO-NBR                      36580000
366930           AND A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR                 36590000
366931           AND A.ORD_LNE_NBR    = :DK-PO-LNE-NBR                  36600000
366940           AND A.VER_STATUS_CDE = 'A'                             36610000
366950           AND A.ITM_NBR        = B.ITM_NBR                       36620000
366960        WITH UR                                                   36630000
366970     END-EXEC.                                                    36640000
366980                                                                  36650000
366990     EVALUATE TRUE                                                36660000
366991         WHEN SQLCODE = ZERO                                      36670000
366992              MOVE XLT00003-SKU-NBR TO ASC-SKU                    36680000
366993                                       (ASC-BLK-SUB ASC-ITEM-SUB) 36690000
366994         WHEN SQLCODE = +100                                      36691000
366995              CONTINUE                                            36692000
366996                                                                  36693000
366997         WHEN SQLWARN0 NOT = SPACE                                36694000
366998         WHEN SQLCODE NOT = ZERO                                  36695000
366999              MOVE '4426-GET-SKU FOR EACH LINE'   TO              36696000
367000                                   DP013-PARAGRAPH                36697000
367010              MOVE 'SELECT BAD XLT00003-SKU-NBR=' TO              36698000
367020                                   DP013-MESSAGE-TEXT (1)         36699000
367021              MOVE DK-PO-NBR                      TO              36699100
367022                                   DP013-MESSAGE-TEXT (2)         36699200
367023              MOVE DK-RCVR-SEQ-NBR                TO              36699300
367024                                   DP013-MESSAGE-TEXT (3)         36699400
367025              MOVE SQLCA       TO DP013-SQLCA                     36699500
367026              MOVE 'TRECITM & XLT_SKU'  TO                        36699600
367027                                   DP013-DB2-TABLE-NAME (1)       36699700
367028              SET DP013-DB2-ABEND                                 36699800
367029                  DP013-XCTL-DISPLAY-RESTART TO TRUE              36699900
367030              PERFORM DP013-0000-PROCESS-ABEND                    36700000
367031     END-EVALUATE.                                                36701000
367032                                                                  36702000
367033                                                                  36702100
367034*CT END   IR 18,412                                               36702200
367035******************************************************************36702300
367036** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **36702400
367037** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **36702500
367038** ISSUE A WARNING.                                             **36702600
367039******************************************************************36702700
367040 4430-CHECK-FOR-BEGIN-AND-END.                                    36702800
367041     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       36702900
367050         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     36703000
367060*            -- NO END-OF-RANGE SPECFIED ---                      36703100
367070             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            36703200
367080             SET DP020-MSG-WARNING TO TRUE                        36703300
367090             PERFORM 4431-POSITION-AT-WARNING                     36703400
367100         END-IF                                                   36703500
367200     ELSE                                                         36703600
367300         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     36703700
367400*            -- NO BEGINNING-OF-RANGE SPECFIED ---                36703800
367500             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            36703900
367600             SET DP020-MSG-WARNING TO TRUE                        36704000
367700             PERFORM 4431-POSITION-AT-WARNING                     36705000
367800         END-IF                                                   36706000
367900     END-IF.                                                      36707000
368000                                                                  36708000
368100******************************************************************36709000
368200** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **36710000
368300** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **36720000
368400** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **36730000
368500** POSITION THE CURSOR THERE.                                   **36740000
368600******************************************************************36750000
368700 4431-POSITION-AT-WARNING.                                        36760000
368800     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 36770000
368900                    - PV-TOP-ITEM + 1.                            36780000
369000     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      36790000
369100         CONTINUE                                                 36800000
369200     ELSE                                                         36810000
369300         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      36820000
369400         MOVE -1                     TO MR-SELECTL (PV-SUB)       36830000
369500         MOVE DP015-REVERSE          TO MR-SELECTH (PV-SUB)       36840000
369600         MOVE DP015-YELLOW           TO MR-SELECTC (PV-SUB)       36850000
369700     END-IF.                                                      36860000
369800                                                                  36870000
369900     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   36880000
370000                    - PV-TOP-ITEM + 1.                            36890000
370100     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      36900000
370200         CONTINUE                                                 36910000
370300     ELSE                                                         36920000
370400         SET DP030-SET-CURSOR-APPL-1                              36930000
370500                                   TO TRUE                        36940000
370600         MOVE -1                   TO MR-SELECTL (PV-SUB)         36950000
370700         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         36960000
370800         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         36970000
370900     END-IF.                                                      36980000
371000                                                                  36990000
371100*----------------------------------------------------------------*37000000
371200* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *37010000
371300* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *37020000
371400* FOR THE SELECTED ITEMS QUEUE.                                  *37030000
371500*                                                                *37040000
371600* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *37050000
371700* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *37060000
371800* THE ARRAY IS FULL.                                             *37070000
371900*----------------------------------------------------------------*37080000
372000 5000-PREPARE-SEL-QUEUE.                                          37090000
372100     MOVE +1                   TO  ASC-BLK-SUB.                   37100000
372200     PERFORM 5100-WRITE-TEMP-STORAGE.                             37110000
372300     ADD +1                    TO  ASC-BLK-SUB.                   37120000
372400     PERFORM 5100-WRITE-TEMP-STORAGE.                             37130000
372500                                                                  37140000
372600     MOVE ASC-SEL-QUEUE-NAME   TO  SU098-SEL-QUEUE-NAME.          37150000
372700     PERFORM 6010-DELETE-SEL-QUEUE.                               37160000
372800                                                                  37170000
372900     SET ASC-UPDATE-TSQ        TO  TRUE.                          37180000
373000                                                                  37190000
373100     SET SU099-IDX             TO  1.                             37200000
373200     MOVE ZERO                 TO SU098-NUMBER-OF-TS-ITEMS.       37210000
373300     INITIALIZE SU099-SELECTED-ITEM-ARRAY.                        37220000
373400                                                                  37230000
373500     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           37240000
373600             VARYING PV-ITEM                                      37250000
373700             FROM 1 BY 1                                          37260000
373800             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     37270000
373900                                                                  37280000
374000     IF  SU099-IDX > 1                                            37290000
374100         PERFORM 5205-WRITE-SEL-QUEUE                             37300000
374200         ADD +1                TO SU098-NUMBER-OF-TS-ITEMS        37310000
374300     END-IF.                                                      37320000
374400                                                                  37330000
374500*----------------------------------------------------------------*37340000
374600*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *37350000
374700*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *37360000
374800*----------------------------------------------------------------*37370000
374900 5100-WRITE-TEMP-STORAGE.                                         37380000
375000     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     37390000
375100                                   TO PV-LIST-ITEM-NUMBER.        37400000
375200     COMPUTE PV-BLOCK-NUMBER =                                    37410000
375300         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    37420000
375400                                                                  37430000
375500     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             37440000
375600     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             37450000
375700         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      37460000
375800             PERFORM 5105-REWRITE-ASC-LISTQ                       37470000
375900         END-IF                                                   37480000
376000     ELSE                                                         37490000
376100         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       37500000
376200         ASC-HIGHEST-BLOCK-WRITTEN + 1                            37510000
376300         PERFORM 5110-WRITE-ASC-LISTQ                             37520000
376400         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   37530000
376500     END-IF.                                                      37540000
376600                                                                  37550000
376700     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             37560000
376800                                                                  37570000
376900******************************************************************37580000
377000** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **37590000
377100** SPECIFIC COMMAREA.                                           **37600000
377200******************************************************************37610000
377300 5105-REWRITE-ASC-LISTQ.                                          37620000
377400     EXEC CICS                                                    37630000
377500         WRITEQ TS                                                37640000
377600             QUEUE (ASC-LIST-QUEUE-NAME)                          37650000
377700             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               37660000
377800             ITEM  (PV-BLOCK-NUMBER)                              37670000
377900             REWRITE                                              37680000
378000             RESP  (PV-CICS-RESP)                                 37690000
378100     END-EXEC.                                                    37700000
378200                                                                  37710000
378300     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           37720000
378400         CONTINUE                                                 37730000
378500     ELSE                                                         37740000
378600         SET DP013-CICS-ABEND            TO TRUE                  37750000
378700         SET DP013-NO-ROLLBACK           TO TRUE                  37760000
378800         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       37770000
378900         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     37780000
379000                                         TO DP013-MESSAGE-TEXT(1) 37790000
379100         PERFORM DP013-0000-PROCESS-ABEND                         37800000
379200     END-IF.                                                      37810000
379300                                                                  37820000
379400******************************************************************37830000
379500** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **37840000
379600** SPECIFIC COMMAREA.                                           **37850000
379700******************************************************************37860000
379800 5110-WRITE-ASC-LISTQ.                                            37870000
379900     EXEC CICS                                                    37880000
380000         WRITEQ TS                                                37890000
380100             QUEUE (ASC-LIST-QUEUE-NAME)                          37900000
380200             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               37910000
380300             ITEM  (PV-BLOCK-NUMBER)                              37920000
380400             RESP  (PV-CICS-RESP)                                 37930000
380500     END-EXEC.                                                    37940000
380600     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      37950000
380700         SET DP013-CICS-ABEND      TO TRUE                        37960000
380800         SET DP013-NO-ROLLBACK     TO TRUE                        37970000
380900         MOVE '5110-WRITE-ASC-LISTQ'                              37980000
381000                                   TO DP013-PARAGRAPH             37990000
381100         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           38000000
381200                                   TO DP013-MESSAGE-TEXT(1)       38010000
381300         PERFORM DP013-0000-PROCESS-ABEND                         38020000
381400     END-IF.                                                      38030000
381500                                                                  38040000
381600*----------------------------------------------------------------*38050000
381700* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *38060000
381800* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *38070000
381900*----------------------------------------------------------------*38080000
382000 5200-FILL-SEL-QUEUE-RECORD.                                      38090000
382100     PERFORM 6112-READ-LIST-QUEUE.                                38100000
382200                                                                  38110000
382300     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       38120000
382400         PERFORM VARYING LQW-IDX                                  38130000
382500         FROM 1 BY 1                                              38140000
382600         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            38150000
382700           OR  LQW-LIST-ITEM-NUMBER(LQW-IDX) = ZERO               38160000
382800                                                                  38170000
382900           IF LQW-SELECT (LQW-IDX)                                38180000
383000                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              38190000
383100                   TO SU099-ITEM        (SU099-IDX)               38200000
383200                 MOVE LQW-ACTION           (LQW-IDX)              38210000
383300                   TO SU099-ACTION-SW   (SU099-IDX)               38220000
383400                 MOVE ASC-RCVR                                    38230000
383500                   TO SU099-RCVR        (SU099-IDX)               38240000
383510                 MOVE LQW-LNE-NBR          (LQW-IDX)              38250000
383520                   TO SU099-PO-LNE-NBR  (SU099-IDX)               38260000
383530                 MOVE LQW-PREPACK-ID       (LQW-IDX)              38270000
383540                   TO SU099-PREPACK-ID  (SU099-IDX)               38280000
383600                                                                  38290000
383700                 SET SU099-IDX UP BY 1                            38300000
383800                 IF  SU099-IDX > SU099-MAX-ITEMS                  38310000
383900                     PERFORM 5205-WRITE-SEL-QUEUE                 38320000
384000                     ADD +1        TO SU098-NUMBER-OF-TS-ITEMS    38330000
384100                     INITIALIZE SU099-SELECTED-ITEM-ARRAY         38340000
384200                     SET SU099-IDX TO  1                          38350000
384300                 END-IF                                           38360000
384400           END-IF                                                 38370000
384500         END-PERFORM                                              38380000
384600     END-IF.                                                      38390000
384700                                                                  38400000
384800*----------------------------------------------------------------*38410000
384900*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *38420000
385000*----------------------------------------------------------------*38430000
385100 5205-WRITE-SEL-QUEUE.                                            38440000
385200     MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO SU099-SELECTED-ITEMS.   38450000
385300                                                                  38460000
385400     EXEC CICS                                                    38470000
385500          WRITEQ TS                                               38480000
385600              QUEUE (ASC-SEL-QUEUE-NAME)                          38490000
385700              FROM  (SU099-SELECT-RECORD)                         38500000
385800              ITEM  (PV-SEL-QUEUE-ITEM)                           38510000
385900              RESP  (PV-CICS-RESP)                                38520000
386000     END-EXEC.                                                    38530000
386100                                                                  38540000
386200     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          38550000
386300         CONTINUE                                                 38560000
386400     ELSE                                                         38570000
386500         SET DP013-CICS-ABEND      TO TRUE                        38580000
386600         SET DP013-NO-ROLLBACK     TO TRUE                        38590000
386700         MOVE '5205-WRITE-SEL-QUEUE'                              38600000
386800                                   TO DP013-PARAGRAPH             38610000
386900         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          38620000
387000                                   TO DP013-MESSAGE-TEXT(1)       38630000
387100         PERFORM DP013-0000-PROCESS-ABEND                         38640000
387200     END-IF.                                                      38650000
387300                                                                  38660000
387400******************************************************************38670000
387500** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **38680000
387600** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **38690000
387700** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **38700000
387800** THE USER.                                                    **38710000
387900******************************************************************38720000
388000 6000-REFRESH-PANEL-FROM-TEMP.                                    38730000
388100     IF  ASC-UPDATE-TSQ                                           38740000
388200         SET ASC-NO-TSQ-UPDATE TO TRUE                            38750000
388300         MOVE ZERO                 TO PV-SAVE-ITEM                38760000
388400                                      PV-SEL-QUEUE-ITEM           38770000
388500         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        38780000
388600                                   TO PV-HOLD-SELECTED-ITEMS      38790000
388700         MOVE +1                   TO PV-ITEMS-PROCESSED          38800000
388800         PERFORM 6100-UPDATE-TSQ                                  38810000
388900             UNTIL PV-ITEMS-PROCESSED >                           38820000
389000                                     PV-HOLD-SELECTED-ITEMS       38830000
389100         INITIALIZE ASC-BLOCK-ENTRIES (1)                         38840000
389200                    ASC-BLOCK-ENTRIES (2)                         38850000
389300     END-IF.                                                      38860000
389400                                                                  38870000
389500*----------------------------------------------------------------*38880000
389600*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *38890000
389700*----------------------------------------------------------------*38900000
389800 6010-DELETE-SEL-QUEUE.                                           38910000
389900                                                                  38920000
390000     EXEC CICS                                                    38930000
390100         DELETEQ TS                                               38940000
390200             QUEUE (ASC-SEL-QUEUE-NAME)                           38950000
390300             RESP  (PV-CICS-RESP)                                 38960000
390400     END-EXEC.                                                    38970000
390500*                                                                 38980000
390600     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      38990000
390700        (PV-CICS-RESP = DFHRESP(QIDERR)))                         39000000
390800         CONTINUE                                                 39010000
390900     ELSE                                                         39020000
391000         SET DP013-CICS-ABEND TO TRUE                             39030000
391100         SET DP013-NO-ROLLBACK TO TRUE                            39040000
391200         MOVE '6010-DELETE-SEL-QUEUE' TO DP013-PARAGRAPH          39050000
391300         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         39060000
391400                                        TO DP013-MESSAGE-TEXT (1) 39070000
391500         PERFORM DP013-0000-PROCESS-ABEND                         39080000
391600     END-IF.                                                      39090000
391700                                                                  39100000
391800*----------------------------------------------------------------*39110000
391900*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *39120000
392000*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *39130000
392100*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *39140000
392200*    THE TEMP QUEUE.                                             *39150000
392300*----------------------------------------------------------------*39160000
392400 6100-UPDATE-TSQ.                                                 39170000
392500                                                                  39180000
392600     ADD 1    TO  PV-SEL-QUEUE-ITEM.                              39190000
392700     PERFORM 6105-READ-SEL-QUEUE.                                 39200000
392800     PERFORM                                                      39210000
392900         VARYING SU099-IDX FROM 1 BY 1                            39220000
393000         UNTIL ((PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS)     39230000
393100         OR (SU099-IDX GREATER THAN SU099-MAX-ITEMS))             39240000
393200         IF  SU099-ACTION-SW (SU099-IDX) > SPACE                  39250000
393300             PERFORM 6110-PROCESS-ITEMS                           39260000
393400         END-IF                                                   39270000
393500         ADD +1                TO PV-ITEMS-PROCESSED              39280000
393600     END-PERFORM.                                                 39290000
393700     PERFORM 6111-WRITE-LIST-QUEUE.                               39300000
393800                                                                  39310000
393900*----------------------------------------------------------------*39320000
394000*    READ THE LIST QUEUE RECORD.                                 *39330000
394100*----------------------------------------------------------------*39340000
394200 6105-READ-SEL-QUEUE.                                             39350000
394300                                                                  39360000
394400     EXEC CICS                                                    39370000
394500          READQ TS                                                39380000
394600              QUEUE (ASC-SEL-QUEUE-NAME)                          39390000
394700              INTO  (SU099-SELECT-RECORD)                         39400000
394800              ITEM  (PV-SEL-QUEUE-ITEM)                           39410000
394900              RESP  (PV-CICS-RESP)                                39420000
395000     END-EXEC.                                                    39430000
395100*                                                                 39440000
395200     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          39450000
395300         CONTINUE                                                 39460000
395400     ELSE                                                         39470000
395500         SET DP013-CICS-ABEND      TO  TRUE                       39480000
395600         SET DP013-NO-ROLLBACK     TO  TRUE                       39490000
395700         MOVE '6105-READ-SEL-QUEUE'                               39500000
395800                                   TO  DP013-PARAGRAPH            39510000
395900         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           39520000
396000                                   TO  DP013-MESSAGE-TEXT(1)      39530000
396100         PERFORM DP013-0000-PROCESS-ABEND                         39540000
396200     END-IF.                                                      39550000
396300                                                                  39560000
396400*----------------------------------------------------------------*39570000
396500*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*39580000
396600*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*39590000
396700*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *39600000
396800*----------------------------------------------------------------*39610000
396900 6110-PROCESS-ITEMS.                                              39620000
397000                                                                  39630000
397100     COMPUTE PV-ITEM = 1 + ((SU099-ITEM (SU099-IDX) - 1)          39640000
397200                     / PC-ITEMS-PER-PANEL).                       39650000
397300                                                                  39660000
397400     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           39670000
397500         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          39680000
397600             PERFORM 6111-WRITE-LIST-QUEUE                        39690000
397700         END-IF                                                   39700000
397800         MOVE PV-ITEM          TO PV-SAVE-ITEM                    39710000
397900                                                                  39720000
398000         PERFORM 6112-READ-LIST-QUEUE                             39730000
398100         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               39740000
398200             CONTINUE                                             39750000
398300         END-IF                                                   39760000
398400     END-IF.                                                      39770000
398500                                                                  39780000
398600     COMPUTE PV-SUB = (SU099-ITEM (SU099-IDX)                     39790000
398700                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              39800000
398800     SET LQW-DESELECT (PV-SUB) TO    TRUE                         39810000
398900     MOVE LQW-SELECTED-SW (PV-SUB)                                39820000
399000                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  39830000
399100     EVALUATE TRUE                                                39840000
399200         WHEN SU099-INQ (SU099-IDX)                               39850000
399300              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             39860000
399400                                                                  39870000
399500         WHEN SU099-UPD (SU099-IDX)                               39880000
399600              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             39890000
399700                                                                  39900000
399800         WHEN SU099-DEL (SU099-IDX)                               39910000
399900              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             39920000
400000                                                                  39930000
400100         WHEN SU099-ERR (SU099-IDX)                               39940000
400200              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             39950000
400300                                                                  39960000
400400         WHEN OTHER                                               39970000
400500              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             39980000
400600                                                                  39990000
400700     END-EVALUATE.                                                40000000
400800                                                                  40010000
400900     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                40020000
401000                                                                  40030000
401100*----------------------------------------------------------------*40040000
401200*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *40050000
401300*----------------------------------------------------------------*40060000
401400 6111-WRITE-LIST-QUEUE.                                           40070000
401500                                                                  40080000
401600     EXEC CICS                                                    40090000
401700         WRITEQ TS                                                40100000
401800             QUEUE (ASC-LIST-QUEUE-NAME)                          40110000
401900             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     40120000
402000             ITEM  (PV-SAVE-ITEM)                                 40130000
402100             REWRITE                                              40140000
402200             RESP  (PV-CICS-RESP)                                 40150000
402300     END-EXEC.                                                    40160000
402400*                                                                 40170000
402500     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          40180000
402600         CONTINUE                                                 40190000
402700     ELSE                                                         40200000
402800         SET DP013-CICS-ABEND  TO  TRUE                           40210000
402900         SET DP013-NO-ROLLBACK TO  TRUE                           40220000
403000         MOVE '6111-WRITE-LIST-QUEUE' TO  DP013-PARAGRAPH         40230000
403100         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  40240000
403200                               TO  DP013-MESSAGE-TEXT(1)          40250000
403300         PERFORM DP013-0000-PROCESS-ABEND                         40260000
403400     END-IF.                                                      40270000
403500                                                                  40280000
403600*----------------------------------------------------------------*40290000
403700*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*40300000
403800*----------------------------------------------------------------*40310000
403900 6112-READ-LIST-QUEUE.                                            40320000
404000     EXEC CICS                                                    40330000
404100         READQ TS                                                 40340000
404200             QUEUE (ASC-LIST-QUEUE-NAME)                          40350000
404300             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     40360000
404400             ITEM  (PV-ITEM)                                      40370000
404500             RESP  (PV-CICS-RESP)                                 40380000
404600     END-EXEC.                                                    40390000
404700*                                                                 40400000
404800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          40410000
404900         CONTINUE                                                 40420000
405000     ELSE                                                         40430000
405100         SET DP013-CICS-ABEND        TO TRUE                      40440000
405200         SET DP013-NO-ROLLBACK       TO TRUE                      40450000
405300         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           40460000
405400         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    40470000
405500                                     TO DP013-MESSAGE-TEXT(1)     40480000
405600         PERFORM DP013-0000-PROCESS-ABEND                         40490000
405700     END-IF.                                                      40500000
405800                                                                  40510000
405900*----------------------------------------------------------------*40520000
406000*                                                                 40530000
406100*----------------------------------------------------------------*40540000
406200 6900-SELECT-BAR-CODE.                                            40550000
406300                                                                  40560000
406400     MOVE ASC-BRCDE-NBR   TO DK-BRCDE-NBR.                        40570000
406500     EXEC SQL                                                     40580000
406600        SELECT                                                    40590000
406700                A.BRCDE_NBR                                       40600000
406800               ,A.CRE_TMST                                        40610000
406900               ,A.AUD_CNTL_NBR                                    40620000
407000               ,A.SHIPT_UNT_ID                                    40630000
407100               ,A.AUD_STAT_CDE                                    40640000
407200               ,A.PO_LNE_NBR                                      40650000
407300               ,A.PO_NBR                                          40660000
407400               ,A.RCVR_SEQ_NBR                                    40670000
407500               ,A.PREPK_ID                                        40680000
407600               ,A.STR_NBR                                         40690000
407700               ,A.STR_ZN_ID                                       40700000
407800               ,A.SEASET_YR                                       40710000
407900               ,A.SEASET_SHRT_NM                                  40720000
408000               ,A.AUD_FALR_RSN_NM                                 40730000
408100          INTO :SUT00102-BRCDE-NBR                                40740000
408200              ,:SUT00102-CRE-TMST                                 40750000
408300              ,:SUT00102-AUD-CNTL-NBR                             40760000
408400              ,:SUT00102-SHIPT-UNT-ID                             40770000
408500              ,:SUT00015-AUD-STAT-CDE                             40780000
408600              ,:SUT00102-PO-LNE-NBR                               40790000
408700              ,:SUT00102-PO-NBR                                   40800000
408800              ,:SUT00102-RCVR-SEQ-NBR                             40810000
408900              ,:SUT00102-PREPK-ID                                 40820000
409000              ,:SUT00102-STR-NBR                                  40830000
409100              ,:SUT00102-STR-ZN-ID   :DN-STR-ZN-ID                40840000
409200              ,:SUT00102-SEASET-YR   :DN-SEASET-YR                40850000
409300              ,:SUT00102-SEASET-SHRT-NM                           40860000
409400                                 :DN-SEASET-SHRT-NM               40870000
409500              ,:SUT00102-AUD-FALR-RSN-NM                          40880000
409600                                 :DN-AUD-FALR-RSN-NM              40890000
409700       FROM  SUT_CART_DIRV_TRKG   A                               40900000
409800      WHERE  A.BRCDE_NBR      = :DK-BRCDE-NBR                     40910000
409900        AND  A.CRE_TMST       =                                   40920000
410000               ( SELECT MAX (CRE_TMST)                            40930000
410100                 FROM SUT_CART_DIRV_TRKG B                        40940000
410200                 WHERE B.BRCDE_NBR  =  A.BRCDE_NBR                40950000
410300                 )                                                40960000
410400        AND  A.LGCL_LOC_NM  IN                                    40970000
410500   (                                                              40980000
410600       SELECT DISTINCT(E.ATTR_ELEM_TXT)                           40990000
410700       FROM WST_INTGRTN_TYP A                                     41000000
410800          , WST_ATTR_DEFN           B                             41010000
410900          , WST_ATTR_ELEM           C                             41020000
411000          , WST_ATTR_ELEM           D                             41030000
411100          , WST_ATTR_ELEM           E                             41040000
411200          , WST_ATTR_ELEM           F                             41050000
411300          , WST_ATTR_ELEM           G                             41060000
411400          , WST_ATTR_ELEM           H                             41070000
411500          , WST_ATTR_ELEM           I                             41080000
411600          , WST_ATTR_ELEM           J                             41090000
411700          , WST_ATTR_ELEM           K                             41100000
411800       WHERE A.INTGRTN_TYP_CDE   = 'ACAULGDST'                    41110000
411900         AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE              41120000
412000         AND A.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE              41130000
412100         AND A.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE              41140000
412200         AND A.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE              41150000
412300         AND A.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE              41160000
412400         AND A.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE              41170000
412500         AND A.INTGRTN_TYP_CDE   = H.INTGRTN_TYP_CDE              41180000
412600         AND A.INTGRTN_TYP_CDE   = I.INTGRTN_TYP_CDE              41190000
412700         AND A.INTGRTN_TYP_CDE   = J.INTGRTN_TYP_CDE              41200000
412800         AND A.INTGRTN_TYP_CDE   = K.INTGRTN_TYP_CDE              41210000
412900         AND B.ATTR_DEFN_SEQ_NBR = 1                              41220000
413000         AND C.ATTR_DEFN_SEQ_NBR = 1                              41230000
413100         AND D.ATTR_DEFN_SEQ_NBR = 2                              41240000
413200         AND E.ATTR_DEFN_SEQ_NBR = 3                              41250000
413300         AND F.ATTR_DEFN_SEQ_NBR = 4                              41260000
413400         AND G.ATTR_DEFN_SEQ_NBR = 5                              41270000
413500         AND H.ATTR_DEFN_SEQ_NBR = 6                              41280000
413600         AND I.ATTR_DEFN_SEQ_NBR = 7                              41290000
413700         AND J.ATTR_DEFN_SEQ_NBR = 8                              41300000
413800         AND K.ATTR_DEFN_SEQ_NBR = 9                              41310000
413900         AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR            41320000
414000         AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR            41330000
414100         AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR            41340000
414200         AND C.ATTR_ELEM_SEQ_NBR = G.ATTR_ELEM_SEQ_NBR            41350000
414300         AND C.ATTR_ELEM_SEQ_NBR = H.ATTR_ELEM_SEQ_NBR            41360000
414400         AND C.ATTR_ELEM_SEQ_NBR = I.ATTR_ELEM_SEQ_NBR            41370000
414500         AND C.ATTR_ELEM_SEQ_NBR = J.ATTR_ELEM_SEQ_NBR            41380000
414600         AND C.ATTR_ELEM_SEQ_NBR = K.ATTR_ELEM_SEQ_NBR            41390000
414700         AND F.ATTR_ELEM_TXT     = 'Y'                            41400000
414800         AND G.ATTR_ELEM_TMST    <=  CURRENT TIMESTAMP            41410000
414900         AND H.ATTR_ELEM_TMST    >=  CURRENT TIMESTAMP            41420000
415000         AND C.ATTR_ELEM_NBR     = :DK-OPER-UNT-ID                41430000
415100         AND K.ATTR_ELEM_TXT     = 'Y'                            41440000
415200                                        )                         41450000
415300     END-EXEC.                                                    41460000
415400                                                                  41470000
415500     EVALUATE TRUE                                                41480000
415600         WHEN SQLCODE = ZERO                                      41490000
415700              MOVE SUT00102-PO-NBR      TO DK-PO-NBR              41500000
415800                                           ASC-PO-NBR             41510000
415900              MOVE SUT00102-RCVR-SEQ-NBR TO DK-REC-SEQ-NBR        41520000
416000                                           ASC-RCVR               41530000
416100              MOVE SUT00102-PO-LNE-NBR   TO DK-PO-LNE-NBR         41540000
416200                                           ASC-PO-LNE-NBR         41550000
416300              MOVE SUT00102-PREPK-ID     TO DK-PREPK-ID           41560000
416400                                           ASC-PO-LNE-NBR         41570000
416500              MOVE SUT00102-AUD-CNTL-NBR TO DK-AUD-CNTL-NBR       41580000
416600                                                                  41590000
416700         WHEN SQLCODE = +100                                      41600000
416800              CONTINUE                                            41610000
416900                                                                  41620000
417000         WHEN SQLWARN0 NOT = SPACE                                41630000
417100         WHEN SQLCODE NOT = ZERO                                  41640000
417200              MOVE '6900-SELECT-BAR-CODE  ' TO                    41650000
417300                                   DP013-PARAGRAPH                41660000
417400              MOVE 'SELECT FOR BAD   ' TO                         41670000
417500                                   DP013-MESSAGE-TEXT (1)         41680000
417600              MOVE SQLCA       TO DP013-SQLCA                     41690000
417700              MOVE 'SUT-CART-DIRV-TRKG' TO                        41700000
417800                                   DP013-DB2-TABLE-NAME (1)       41710000
417900              SET DP013-DB2-ABEND                                 41720000
418000                  DP013-XCTL-DISPLAY-RESTART TO TRUE              41730000
418100              PERFORM DP013-0000-PROCESS-ABEND                    41740000
418200     END-EVALUATE.                                                41750000
418300                                                                  41760000
418400                                                                  41770000
418500*----------------------------------------------------------------*41780000
418600*                                                                 41790000
418700*----------------------------------------------------------------*41800000
418800 6940-SELECT-PO-RCVR-PREPK.                                       41810000
418900                                                                  41820000
419000     MOVE ASC-PO-NBR       TO DK-PO-NBR.                          41830000
419100     MOVE ASC-RCVR         TO DK-RCVR-SEQ-NBR.                    41840000
419200                                                                  41850000
419300     EXEC SQL                                                     41860000
419400        SELECT                                                    41870000
419500                A.PO_NBR                                          41880000
419600               ,A.RCVR_SEQ_NBR                                    41890000
419700               ,A.PREPK_ID                                        41900000
419800               ,A.PO_LNE_NBR                                      41910000
419900          INTO                                                    41920000
420000               :SUT00102-PO-NBR                                   41930000
420100              ,:SUT00102-RCVR-SEQ-NBR                             41940000
420200              ,:SUT00102-PREPK-ID                                 41950000
420300              ,:SUT00102-PO-LNE-NBR                               41960000
420400       FROM  SUT_CART_DIRV_TRKG   A                               41970000
420500      WHERE  A.PO_NBR         = :DK-PO-NBR                        41980000
420600        AND  A.RCVR_SEQ_NBR   = :DK-RCVR-SEQ-NBR                  41990000
420610     END-EXEC.                                                    42000000
420620                                                                  42010000
420630     EVALUATE TRUE                                                42020000
420640         WHEN SQLCODE = ZERO                                      42030000
420650              MOVE SUT00102-PO-LNE-NBR   TO DK-PO-LNE-NBR         42040000
420660                                           ASC-PO-LNE-NBR         42050000
420670              MOVE SUT00102-PREPK-ID     TO DK-PREPK-ID           42060000
420680                                           ASC-PO-LNE-NBR         42061000
420690                                                                  42062000
420700         WHEN SQLCODE = +100                                      42063000
420710              CONTINUE                                            42064000
420720                                                                  42065000
420730         WHEN SQLWARN0 NOT = SPACE                                42066000
420740         WHEN SQLCODE NOT = ZERO                                  42067000
420750              MOVE '6940-SELECT-PO-RCVR-PREPK  ' TO               42068000
420760                                   DP013-PARAGRAPH                42069000
420770              MOVE 'SELECT BAD FOR PREPK ' TO                     42070000
420780                                   DP013-MESSAGE-TEXT (1)         42071000
420781              MOVE SQLCA       TO DP013-SQLCA                     42072000
420782              MOVE 'SUT-CART-DIRV-TRKG' TO                        42073000
420783                                   DP013-DB2-TABLE-NAME (1)       42074000
420784              SET DP013-DB2-ABEND                                 42075000
420785                  DP013-XCTL-DISPLAY-RESTART TO TRUE              42076000
420786              PERFORM DP013-0000-PROCESS-ABEND                    42077000
420787     END-EVALUATE.                                                42078000
420788                                                                  42078100
420789                                                                  42078200
420790*----------------------------------------------------------------*42078300
420791*                                                                 42078400
420792*----------------------------------------------------------------*42078500
420793 7000-SELECT-TRECEIV.                                             42078600
420794                                                                  42078700
420795     MOVE ASC-PO-NBR   TO DK-PO-NBR.                              42078800
420796     MOVE ASC-RCVR     TO DK-RCVR-SEQ-NBR.                        42078900
420797                                                                  42079000
420798     EXEC SQL                                                     42079100
420799         SELECT  OPER_UNT_ID                                      42079200
420800                ,PACK_BY_ST_IND                                   42079300
420801                ,PKGNG_CDE                                        42079400
420802           INTO  :RECEIV-OPER-UNT-ID                              42079500
420803                ,:RECEIV-PACK-BY-ST-IND                           42079600
420804                ,:RECEIV-PKGNG-CDE                                42079700
420805           FROM  TRECEIV                                          42079800
420806          WHERE  ORD_NBR       =  :DK-PO-NBR                      42079900
420807            AND  REC_SEQ_NBR   =  :DK-RCVR-SEQ-NBR                42080000
420808     END-EXEC.                                                    42080100
420809                                                                  42080200
420810     EVALUATE TRUE                                                42080300
420820         WHEN SQLCODE = ZERO                                      42080400
420830              EVALUATE RECEIV-PKGNG-CDE                           42080500
420840                  WHEN 'M'                                        42080600
420850                  WHEN 'I'                                        42080700
420860                       SET ASC-PREPK-ORDER TO TRUE                42080800
420870                  WHEN ' '                                        42080900
420880                       SET ASC-PACK-BY-STORE-ORDER TO TRUE        42081000
420890                  WHEN OTHER                                      42082000
420900                       SET ASC-BULK-CASE-ORDER TO TRUE            42083000
421000              END-EVALUATE                                        42084000
421100              IF RECEIV-PACK-BY-ST-IND = PC-Y                     42085000
421200                 MOVE PC-PACK-BY-STORE    TO ASC-PACK-TYPE        42086000
421300              ELSE                                                42087000
421400              EVALUATE RECEIV-PKGNG-CDE                           42088000
421500                  WHEN 'M'                                        42089000
421600                       MOVE PC-MULTIPLE-SKU-PPK TO ASC-PACK-TYPE  42090000
421700                  WHEN 'S'                                        42100000
421800                       MOVE PC-SINGLE-SKU-PPK   TO ASC-PACK-TYPE  42110000
421900                  WHEN 'I'                                        42120000
422000                       MOVE PC-INNER-PPK        TO ASC-PACK-TYPE  42130000
422100                  WHEN 'B'                                        42140000
422200                       MOVE PC-BULK-PPK         TO ASC-PACK-TYPE  42150000
422300                  WHEN 'C'                                        42160000
422400                       MOVE PC-CASEPACK         TO ASC-PACK-TYPE  42170000
422500                  WHEN OTHER                                      42180000
422600                       MOVE PC-OTHER            TO ASC-PACK-TYPE  42190000
422700              END-EVALUATE                                        42200000
422800              END-IF                                              42210000
422900         WHEN SQLCODE = +100                                      42220000
423000              CONTINUE                                            42230000
423100         WHEN SQLWARN0 NOT = SPACE                                42240000
423200         WHEN SQLCODE NOT = ZERO                                  42250000
423300              MOVE '7000-SELECT-TRECEIV   ' TO                    42260000
423400                                   DP013-PARAGRAPH                42270000
423500              MOVE 'SELECT FOR PO BAD' TO                         42280000
423600                                   DP013-MESSAGE-TEXT (1)         42290000
423700              MOVE SQLCA       TO DP013-SQLCA                     42300000
423800              MOVE 'TRECEIV           ' TO                        42310000
423900                                   DP013-DB2-TABLE-NAME (1)       42320000
424000              SET DP013-DB2-ABEND                                 42330000
424100                  DP013-XCTL-DISPLAY-RESTART TO TRUE              42340000
424200              PERFORM DP013-0000-PROCESS-ABEND                    42350000
424300     END-EVALUATE.                                                42360000
424400                                                                  42370000
424500*----------------------------------------------------------------*42380000
424600*    USE AUDIT CONTROL NUMBER TO                                  42390000
424700*----------------------------------------------------------------*42400000
424800 7020-SELECT-AUD-CNTL-NBR.                                        42410000
424900                                                                  42420000
425000     MOVE ASC-AUDIT-CNTL-NBR   TO DK-AUD-CNTL-NBR.                42430000
425100                                                                  42440000
425200     EXEC SQL                                                     42450000
425300        SELECT                                                    42460000
425400                S015.PO_NBR                                       42470000
425500               ,S015.RCVR_SEQ_NBR                                 42480000
425600               ,S015.PO_LNE_NBR                                   42490000
425700               ,S015.PO_PREPK_ID                                  42500000
425800               ,S015.DIRV_RLSE_IND                                42510000
425900          INTO                                                    42520000
426000                :SUT00015-PO-NBR                                  42530000
426100               ,:SUT00015-RCVR-SEQ-NBR                            42540000
426200               ,:SUT00015-PO-LNE-NBR                              42550000
426300               ,:SUT00015-PO-PREPK-ID                             42560000
426400               ,:SUT00015-DIRV-RLSE-IND                           42570000
426500                                                                  42580000
426600          FROM  SUT_PO_AUD_REQ   S015                             42590000
426700         WHERE  S015.AUD_CNTL_NBR = :DK-AUD-CNTL-NBR              42600000
426800          WITH  UR                                                42610000
426900     END-EXEC.                                                    42620000
427000                                                                  42630000
427100     EVALUATE TRUE                                                42640000
427200         WHEN SQLCODE = ZERO                                      42650000
427300              MOVE SUT00015-PO-NBR        TO ASC-PO-NBR           42660000
427400              MOVE SUT00015-RCVR-SEQ-NBR  TO ASC-RCVR             42670000
427500              MOVE SUT00015-PO-LNE-NBR    TO ASC-PO-LNE-NBR       42680000
427600              MOVE SUT00015-PO-PREPK-ID   TO ASC-PREPK-ID         42690000
427700         WHEN SQLCODE = +100                                      42700000
427800              CONTINUE                                            42710000
427900         WHEN SQLWARN0 NOT = SPACE                                42720000
428000         WHEN SQLCODE NOT = ZERO                                  42730000
428100              MOVE '7020-SELECT-AUD-CNTL-NBR  ' TO                42740000
428200                                   DP013-PARAGRAPH                42750000
428300              MOVE 'SELECT FOR PO BAD' TO                         42760000
428400                                   DP013-MESSAGE-TEXT (1)         42770000
428500              MOVE SQLCA       TO DP013-SQLCA                     42780000
428600              MOVE 'SUT-PO-AUD-REQ    ' TO                        42790000
428700                                   DP013-DB2-TABLE-NAME (1)       42800000
428800              SET DP013-DB2-ABEND                                 42810000
428900                  DP013-XCTL-DISPLAY-RESTART TO TRUE              42820000
429000              PERFORM DP013-0000-PROCESS-ABEND                    42830000
429100     END-EVALUATE.                                                42840000
429200                                                                  42850000
429300*----------------------------------------------------------------*42860000
429400*    FIND SCAC AND TRAILER                                        42870000
429500*----------------------------------------------------------------*42880000
429600 7040-SELECT-SCAC-TRAILER.                                        42890000
429700                                                                  42900000
429800     MOVE ASC-PO-NBR  TO DK-PO-NBR.                               42910000
429900     MOVE ASC-RCVR    TO DK-REC-SEQ-NBR.                          42920000
430000                                                                  42930000
430100     EXEC SQL                                                     42940000
430200         SELECT                                                   42950000
430300                A.OWNER_SCAC_ID                                   42960000
430400               ,A.VEH_NBR                                         42970000
430500               ,A.TRIP_ID                                         42980000
430600          INTO                                                    42990000
430700                :VHTRIP-OWNER-SCAC-ID                             43000000
430800               ,:VHTRIP-VEH-NBR   :DN-VEH-NBR                     43010000
430900               ,:VHTRIP-TRIP-ID                                   43020000
431000         FROM  TVHTRIP   A                                        43030000
431100              ,TSHIPMT   B                                        43040000
431200              ,TSHPTPO   C                                        43050000
431300        WHERE  A.TRIP_ID     = B.TRIP_ID                          43060000
431400          AND  C.SHIPT_ID    = B.SHIPT_ID                         43070000
431500          AND  C.PO_NBR      = :DK-PO-NBR                         43080000
431600          AND  C.REC_SEQ_NBR = :DK-REC-SEQ-NBR                    43090000
431700     END-EXEC.                                                    43100000
431800                                                                  43110000
431900     EVALUATE TRUE                                                43120000
432000         WHEN SQLCODE = ZERO                                      43130000
432100         WHEN SQLCODE = -811                                      43140000
432200              MOVE VHTRIP-OWNER-SCAC-ID  TO ASC-SCAC              43150000
432300              MOVE VHTRIP-TRIP-ID        TO ASC-TRIP-ID           43160000
432400              IF DN-VEH-NBR = 0                                   43170000
432500                 MOVE VHTRIP-VEH-NBR TO ASC-TRAILER               43180000
432600              ELSE                                                43190000
432700                 MOVE SPACES         TO ASC-TRAILER               43200000
432800              END-IF                                              43210000
432900                                                                  43220000
433000         WHEN SQLCODE = +100                                      43230000
433100              MOVE SPACES         TO ASC-SCAC                     43240000
433200              MOVE ZEROES         TO ASC-TRIP-ID                  43250000
433300              MOVE SPACES         TO ASC-TRAILER                  43260000
433400                                                                  43270000
433500         WHEN SQLWARN0 NOT = SPACE                                43280000
433600         WHEN SQLCODE NOT = ZERO                                  43290000
433700              MOVE '7040-SELECT-SCAC-TRAILER'  TO                 43300000
433800                                   DP013-PARAGRAPH                43310000
433900              MOVE 'SELECT FOR PO BAD' TO                         43320000
434000                                   DP013-MESSAGE-TEXT (1)         43330000
434100              MOVE SQLCA       TO DP013-SQLCA                     43340000
434200              MOVE 'TVHTRIP TSHIPMT   ' TO                        43350000
434300                                   DP013-DB2-TABLE-NAME (1)       43360000
434400              MOVE 'TSHPTPO           ' TO                        43370000
434500                                   DP013-DB2-TABLE-NAME (2)       43380000
434600              SET DP013-DB2-ABEND                                 43390000
434700                  DP013-XCTL-DISPLAY-RESTART TO TRUE              43400000
434800              PERFORM DP013-0000-PROCESS-ABEND                    43410000
434900     END-EVALUATE.                                                43420000
435000                                                                  43430000
435100*----------------------------------------------------------------*43440000
435200*    COUNT EXPECTED CARTONS                                       43450000
435300*----------------------------------------------------------------*43460000
435400 7080-SELECT-EXPECTED-CARTONS.                                    43470000
435500                                                                  43480000
435600     EXEC SQL                                                     43490000
435700         SELECT COUNT(*)                                          43500000
435800           INTO :PV-COUNT-EXPECTED-HDR                            43510000
435900                                                                  43520000
436000           FROM  TSHIPMT   A                                      43530000
436100                ,TSHPTPO   B                                      43540000
436200                ,TPKSLIP   C                                      43550000
436300                ,TINPKSU   D                                      43560000
436400                ,TSHPUNT   E                                      43570000
436500                                                                  43580000
436600          WHERE  B.PO_NBR         = :DK-PO-NBR                    43590000
436700            AND  B.REC_SEQ_NBR    = :DK-REC-SEQ-NBR               43600000
436800            AND  B.PO_NBR         =  C.PO_NBR                     43610000
436900            AND  B.REC_SEQ_NBR    =  C.REC_SEQ_NBR                43620000
437000            AND  B.PRIM_SHIPT_IND = :PC-Y                         43630000
437100            AND  C.VER_STAT_CDE   = :PC-A                         43640000
437200            AND  B.PO_NBR         =  D.PO_NBR                     43650000
437300            AND  D.SEQ_NBR        =  C.SEQ_NBR                    43660000
437400            AND  A.SHIPT_ID       =  B.SHIPT_ID                   43670000
437500            AND  D.SHIPT_UNT_ID   =  E.SHIPT_UNT_ID               43680000
437600            AND  E.ACTV_IND       = :PC-A                         43690000
437700     END-EXEC.                                                    43700000
437800                                                                  43710000
437900     EVALUATE TRUE                                                43720000
438000         WHEN SQLCODE = ZERO                                      43730000
438100**??          17886 IR - FIX COUNTS                               43740000
438200              MOVE PV-COUNT-EXPECTED-HDR TO ASC-EXPECTED-CARTONS  43750000
438300         WHEN SQLCODE = +100                                      43760000
438400**??          MOVE 0    TO  PV-COUNT-EXPECTED-HDR                 43770000
438500              MOVE 0    TO  ASC-EXPECTED-CARTONS                  43780000
438600                                                                  43790000
438700         WHEN SQLWARN0 NOT = SPACE                                43800000
438800         WHEN SQLCODE NOT = ZERO                                  43810000
438900              MOVE '7080-SELECT-EXPECTED-CARTONS'  TO             43820000
439000                                   DP013-PARAGRAPH                43830000
439100              MOVE 'SELECT FOR PO BAD' TO                         43840000
439200                                   DP013-MESSAGE-TEXT (1)         43850000
439300              MOVE SQLCA       TO DP013-SQLCA                     43860000
439400              MOVE 'TSHIPMT  TSHPTPO  ' TO                        43870000
439500                                   DP013-DB2-TABLE-NAME (1)       43880000
439600              MOVE 'TPKSLIP  TINPKSU  ' TO                        43890000
439700                                   DP013-DB2-TABLE-NAME (1)       43900000
439800              MOVE 'TSHPUNT           ' TO                        43910000
439900                                   DP013-DB2-TABLE-NAME (1)       43920000
440000              SET DP013-DB2-ABEND                                 43930000
440100                  DP013-XCTL-DISPLAY-RESTART TO TRUE              43940000
440200              PERFORM DP013-0000-PROCESS-ABEND                    43950000
440300     END-EVALUATE.                                                43960000
440400                                                                  43970000
440500******************************************************************43980000
440600*                                                                 43990000
440700*                                                                 44000000
440800******************************************************************44010000
440900 7090-DIRECTIVES-AVAIL.                                           44020000
441000                                                                  44030000
441100     MOVE ASC-OPER-UNT-ID  TO DK-OPER-UNT-ID.                     44040000
441110     MOVE ASC-PO-NBR       TO DK-PO-NBR.                          44050000
441200     MOVE ASC-RCVR         TO DK-REC-SEQ-NBR.                     44060000
441300     MOVE ZEROES           TO ASC-DIRECTIVE-CARTONS.              44070000
441400                                                                  44080000
441500     EXEC SQL                                                     44090000
441600         SELECT  COUNT(*)                                         44100000
441700                                                                  44110000
441800           INTO  :PV-COUNT-DIRECTIVE-HDR                          44111000
441900                                                                  44112000
442000           FROM  SUT_CART_DIRV_TRKG   A                           44113000
442100          WHERE  A.OPER_UNT_ID       = :DK-OPER-UNT-ID            44114000
442200            AND  A.PO_NBR            = :DK-PO-NBR                 44115000
442210            AND  A.RCVR_SEQ_NBR      = :DK-REC-SEQ-NBR            44116000
442220            AND  A.DIRV_RSN_CDE     <> 'AUQ'                      44117000
442400            AND  A.CRE_TMST          =                            44118000
442500                        (SELECT MAX(B.CRE_TMST)                   44119000
442600                           FROM SUT_CART_DIRV_TRKG  B             44120000
442700                          WHERE B.BRCDE_NBR = A.BRCDE_NBR)        44130000
442710                  AND  A.LGCL_LOC_NM       IN                     44140000
442720                   (                                              44150000
442730                      SELECT DISTINCT(E.ATTR_ELEM_TXT)            44160000
442740                      FROM WST_INTGRTN_TYP A                      44170000
442750                         , WST_ATTR_DEFN           B              44180000
442760                         , WST_ATTR_ELEM           C              44190000
442770                         , WST_ATTR_ELEM           D              44200000
442780                         , WST_ATTR_ELEM           E              44210000
442790                         , WST_ATTR_ELEM           F              44220000
442791                         , WST_ATTR_ELEM           G              44230000
442792                         , WST_ATTR_ELEM           H              44240000
442793                         , WST_ATTR_ELEM           I              44250000
442794                         , WST_ATTR_ELEM           J              44260000
442795                         , WST_ATTR_ELEM           K              44270000
442796                 WHERE A.INTGRTN_TYP_CDE    =  'ACAULGDST'        44271000
442797                   AND A.INTGRTN_TYP_CDE    =  B.INTGRTN_TYP_CDE  44272000
442798                   AND A.INTGRTN_TYP_CDE    =  C.INTGRTN_TYP_CDE  44273000
442799                   AND A.INTGRTN_TYP_CDE    =  D.INTGRTN_TYP_CDE  44274000
442800                   AND A.INTGRTN_TYP_CDE    =  E.INTGRTN_TYP_CDE  44275000
442801                   AND A.INTGRTN_TYP_CDE    =  F.INTGRTN_TYP_CDE  44276000
442802                   AND A.INTGRTN_TYP_CDE    =  G.INTGRTN_TYP_CDE  44277000
442803                   AND A.INTGRTN_TYP_CDE    =  H.INTGRTN_TYP_CDE  44278000
442804                   AND A.INTGRTN_TYP_CDE    =  I.INTGRTN_TYP_CDE  44279000
442805                   AND A.INTGRTN_TYP_CDE    =  J.INTGRTN_TYP_CDE  44279100
442806                   AND A.INTGRTN_TYP_CDE    =  K.INTGRTN_TYP_CDE  44279200
442807                   AND B.ATTR_DEFN_SEQ_NBR  =  1                  44279300
442808                   AND C.ATTR_DEFN_SEQ_NBR  =  1                  44279400
442809                   AND D.ATTR_DEFN_SEQ_NBR  =  2                  44279500
442810                   AND E.ATTR_DEFN_SEQ_NBR  =  3                  44279600
442811                   AND F.ATTR_DEFN_SEQ_NBR  =  4                  44279700
442812                   AND G.ATTR_DEFN_SEQ_NBR  =  5                  44279800
442813                   AND H.ATTR_DEFN_SEQ_NBR  =  6                  44279900
442814                   AND I.ATTR_DEFN_SEQ_NBR  =  7                  44280000
442815                   AND J.ATTR_DEFN_SEQ_NBR  =  8                  44280100
442816                   AND K.ATTR_DEFN_SEQ_NBR  =  9                  44280200
442817                   AND C.ATTR_ELEM_SEQ_NBR  =  D.ATTR_ELEM_SEQ_NBR44280300
442818                   AND C.ATTR_ELEM_SEQ_NBR  =  E.ATTR_ELEM_SEQ_NBR44280400
442819                   AND C.ATTR_ELEM_SEQ_NBR  =  F.ATTR_ELEM_SEQ_NBR44280500
442820                   AND C.ATTR_ELEM_SEQ_NBR  =  G.ATTR_ELEM_SEQ_NBR44280600
442821                   AND C.ATTR_ELEM_SEQ_NBR  =  H.ATTR_ELEM_SEQ_NBR44280700
442822                   AND C.ATTR_ELEM_SEQ_NBR  =  I.ATTR_ELEM_SEQ_NBR44280800
442823                   AND C.ATTR_ELEM_SEQ_NBR  =  J.ATTR_ELEM_SEQ_NBR44280900
442824                   AND C.ATTR_ELEM_SEQ_NBR  =  K.ATTR_ELEM_SEQ_NBR44281000
442825                   AND F.ATTR_ELEM_TXT      =  'Y'                44281100
442826                   AND G.ATTR_ELEM_TMST    <=  CURRENT TIMESTAMP  44281200
442827                   AND H.ATTR_ELEM_TMST    >=  CURRENT TIMESTAMP  44281300
442828                   AND C.ATTR_ELEM_NBR      = :DK-OPER-UNT-ID     44281400
442829                   AND K.ATTR_ELEM_TXT      =  'Y'                44281500
442830                                                  )               44281600
442840     END-EXEC.                                                    44281700
442900                                                                  44281800
443000     EVALUATE TRUE                                                44281900
443100         WHEN SQLCODE = +0                                        44282000
443200             MOVE PV-COUNT-DIRECTIVE-HDR TO ASC-DIRECTIVE-CARTONS 44282100
443300                                                                  44282200
443400         WHEN SQLCODE = +100                                      44282300
443500              CONTINUE                                            44282400
443600         WHEN SQLWARN0 NOT = SPACES                               44282500
443700         WHEN SQLCODE < +0                                        44282600
443800         WHEN SQLCODE > +0                                        44282700
443900             MOVE '7090-DIRECTIVES-AVAIL       '                  44282800
444000                                       TO DP013-PARAGRAPH         44282900
444100             MOVE 'BAD SELECT                     '               44283000
444200                                 TO DP013-MESSAGE-TEXT (1)        44284000
444300             MOVE SQLCA      TO DP013-SQLCA                       44285000
444400             MOVE 'SUT_CART_DIRV_TRKG'  TO                        44286000
444500                                DP013-DB2-TABLE-NAME (1)          44287000
444600             SET DP013-DB2-ABEND                                  44288000
444700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               44289000
444800             PERFORM DP013-0000-PROCESS-ABEND                     44290000
444900     END-EVALUATE.                                                44300000
445000                                                                  44310000
445100*----------------------------------------------------------------*44320000
445200*    GET TRAILER STATUS                                           44330000
445300*----------------------------------------------------------------*44340000
445400 7100-SELECT-TRIPST.                                              44350000
445500                                                                  44360000
445600     MOVE ASC-TRIP-ID  TO DK-TRIP-ID.                             44370000
445700                                                                  44380000
445800     EXEC SQL                                                     44390000
445900          SELECT   MAX(STATUS_DTE)                                44400000
446000                  ,MAX(STATUS_TME)                                44410000
446100                  ,TRIP_STATUS_CDE                                44420000
446200            INTO  :DK-STATUS-DATE                                 44430000
446300                 ,:DK-STATUS-TIME                                 44440000
446400                 ,:TRIPST-TRIP-STATUS-CDE                         44450000
446500            FROM   TVHTRIP A                                      44460000
446600                  ,TTRIPST B                                      44470000
446700           WHERE  A.TRIP_ID = :DK-TRIP-ID                         44480000
446800             AND  A.TRIP_ID =  B.TRIP_ID                          44490000
446900             AND  B.STATUS_DTE =                                  44500000
447000                 (SELECT MAX(D.STATUS_DTE)                        44510000
447100                    FROM TTRIPST D                                44520000
447200                   WHERE D.TRIP_ID = A.TRIP_ID)                   44530000
447300         GROUP BY  TRIP_STATUS_CDE                                44540000
447400                   WITH UR                                        44550000
447500     END-EXEC.                                                    44560000
447600                                                                  44570000
447700     EVALUATE TRUE                                                44580000
447800         WHEN SQLCODE = ZERO                                      44590000
447900         WHEN SQLCODE = -811                                      44600000
448000                                                                  44610000
448100              EVALUATE TRIPST-TRIP-STATUS-CDE                     44620000
448200                  WHEN 'AR'                                       44630000
448300                       MOVE 'ARRIVED'   TO ASC-TRAILER-STATUS     44640000
448400                  WHEN 'UN'                                       44650000
448500                       MOVE 'UNLOADED'  TO ASC-TRAILER-STATUS     44660000
448600                  WHEN 'UG'                                       44670000
448700                       MOVE 'UNLOADING' TO ASC-TRAILER-STATUS     44680000
448800                  WHEN 'EN'                                       44690000
448900                       MOVE 'ENROUTE'   TO ASC-TRAILER-STATUS     44700000
449000                  WHEN 'DP'                                       44710000
449100                       MOVE 'DEPARTED'  TO ASC-TRAILER-STATUS     44720000
449200                  WHEN 'ET'                                       44730000
449300                       MOVE 'END TRIP'  TO ASC-TRAILER-STATUS     44740000
449400              END-EVALUATE                                        44750000
449500              MOVE DK-STATUS-DATE       TO ASC-ARRIVE-DATE        44760000
449600                                                                  44770000
449700         WHEN SQLCODE = +100                                      44780000
449800              MOVE SPACES                 TO ASC-TRAILER-STATUS   44790000
449900              MOVE SPACES                 TO ASC-ARRIVE-DATE      44800000
450000                                                                  44810000
450100         WHEN SQLWARN0 NOT = SPACE                                44820000
450200         WHEN SQLCODE NOT = ZERO                                  44830000
450300              MOVE '7100-SELECT-TRIPST    '  TO                   44840000
450400                                   DP013-PARAGRAPH                44850000
450500              MOVE 'SELECT FOR PO BAD' TO                         44860000
450600                                   DP013-MESSAGE-TEXT (1)         44870000
450700              MOVE SQLCA       TO DP013-SQLCA                     44880000
450800              MOVE 'TVHTRIP  TTRIPST  ' TO                        44890000
450900                                   DP013-DB2-TABLE-NAME (1)       44900000
451000              SET DP013-DB2-ABEND                                 44910000
451100                  DP013-XCTL-DISPLAY-RESTART TO TRUE              44920000
451200              PERFORM DP013-0000-PROCESS-ABEND                    44930000
451300     END-EVALUATE.                                                44940000
451400                                                                  44950000
451500*----------------------------------------------------------------*44960000
451600*    ????                                                         44970000
451700*----------------------------------------------------------------*44980000
451800 7120-SELECT-TRECITM.                                             44990000
451900                                                                  45000000
452000     MOVE ASC-PO-NBR        TO DK-PO-NBR.                         45010000
452100     MOVE ASC-RCVR          TO DK-RCVR-SEQ-NBR.                   45020000
452200     MOVE SUT00102-PREPK-ID TO DK-PREPK-ID.                       45030000
452300                                                                  45040000
452400     EXEC SQL                                                     45050000
452500         SELECT  ORD_NBR                                          45060000
452600                ,REC_SEQ_NBR                                      45070000
452700                ,PREPK_ID                                         45080000
452800                ,ORD_LNE_NBR                                      45090000
452900           INTO  :RECITM-ORD-NBR                                  45100000
453000                ,:RECITM-REC-SEQ-NBR                              45110000
453100                ,:RECITM-PREPK-ID                                 45120000
453200                ,:RECITM-ORD-LNE-NBR                              45130000
453300           FROM  TRECITM                                          45140000
453400          WHERE  ORD_NBR        = :DK-PO-NBR                      45150000
453500            AND  REC_SEQ_NBR    = :DK-RCVR-SEQ-NBR                45160000
453600            AND  PREPK_ID       = :DK-PREPK-ID                    45170000
453700            AND  PREPK_DRV_LNE_CDE = :PC-A                        45180000
453800     END-EXEC.                                                    45190000
453900                                                                  45200000
454000     EVALUATE TRUE                                                45210000
454100         WHEN SQLCODE = ZERO                                      45220000
454200         WHEN SQLCODE = -811                                      45230000
454300              CONTINUE                                            45240000
454400         WHEN SQLCODE = +100                                      45250000
454500              CONTINUE                                            45260000
454600         WHEN SQLWARN0 NOT = SPACE                                45270000
454700         WHEN SQLCODE NOT = ZERO                                  45280000
454800              MOVE '7120-SELECT-TRECITM    '  TO                  45290000
454900                                   DP013-PARAGRAPH                45300000
455000              MOVE 'SELECT FOR PO BAD' TO                         45310000
455100                                   DP013-MESSAGE-TEXT (1)         45320000
455200              MOVE SQLCA       TO DP013-SQLCA                     45330000
455300              MOVE 'TRECITM           ' TO                        45340000
455400                                   DP013-DB2-TABLE-NAME (1)       45350000
455500              SET DP013-DB2-ABEND                                 45360000
455600                  DP013-XCTL-DISPLAY-RESTART TO TRUE              45370000
455700              PERFORM DP013-0000-PROCESS-ABEND                    45380000
455800     END-EVALUATE.                                                45390000
455900                                                                  45400000
456000*----------------------------------------------------------------*45410000
456100*    COUNT DIRECTIVE CARTONS                                      45420000
456200*----------------------------------------------------------------*45430000
456300 7140-SELECT-DIRV-TRKG.                                           45440000
456400                                                                  45450000
456500     MOVE SUT00102-PO-LNE-NBR TO DK-PO-LNE-NBR.                   45460000
456600     MOVE SUT00102-PREPK-ID   TO DK-PREPK-ID.                     45470000
456700     MOVE 0                   TO PV-COUNT-DIRECTIVES.             45480000
456800                                                                  45490000
456810*CT BEGIN 02/04/09 IR #18412                                      45500000
456900     EVALUATE TRUE                                                45510000
456910                                                                  45520000
457000         WHEN ASC-PREPK-ORDER                                     45530000
457010             EXEC SQL                                             45540000
457100               SELECT  COUNT(*)                                   45550000
457300                 INTO  :PV-COUNT-DIRECTIVES                       45560000
457500                 FROM  SUT_CART_DIRV_TRKG   A                     45570000
457600                WHERE  A.OPER_UNT_ID       = :DK-OPER-UNT-ID      45580000
457700                  AND  A.PO_NBR            = :DK-PO-NBR           45590000
457800                  AND  A.RCVR_SEQ_NBR      = :DK-REC-SEQ-NBR      45600000
457900                  AND  A.PREPK_ID          = :DK-PREPK-ID         45610000
458000                  AND  A.DIRV_RSN_CDE   <>    'AUQ'               45620000
458100                  AND  A.CRE_TMST          =                      45630000
458200                        (SELECT MAX(B.CRE_TMST)                   45640000
458300                           FROM SUT_CART_DIRV_TRKG  B             45650000
458400                          WHERE B.BRCDE_NBR = A.BRCDE_NBR)        45660000
462210                  AND  A.LGCL_LOC_NM       IN                     45670000
462220                   (                                              45680000
462230                      SELECT DISTINCT(E.ATTR_ELEM_TXT)            45690000
462240                      FROM WST_INTGRTN_TYP A                      45700000
462250                         , WST_ATTR_DEFN           B              45710000
462260                         , WST_ATTR_ELEM           C              45720000
462270                         , WST_ATTR_ELEM           D              45730000
462280                         , WST_ATTR_ELEM           E              45740000
462290                         , WST_ATTR_ELEM           F              45750000
462291                         , WST_ATTR_ELEM           G              45760000
462292                         , WST_ATTR_ELEM           H              45770000
462293                         , WST_ATTR_ELEM           I              45780000
462294                         , WST_ATTR_ELEM           J              45790000
462295                         , WST_ATTR_ELEM           K              45800000
462296                 WHERE A.INTGRTN_TYP_CDE    =  'ACAULGDST'        45810000
462297                   AND A.INTGRTN_TYP_CDE    =  B.INTGRTN_TYP_CDE  45820000
462298                   AND A.INTGRTN_TYP_CDE    =  C.INTGRTN_TYP_CDE  45830000
462299                   AND A.INTGRTN_TYP_CDE    =  D.INTGRTN_TYP_CDE  45840000
462300                   AND A.INTGRTN_TYP_CDE    =  E.INTGRTN_TYP_CDE  45850000
462301                   AND A.INTGRTN_TYP_CDE    =  F.INTGRTN_TYP_CDE  45860000
462302                   AND A.INTGRTN_TYP_CDE    =  G.INTGRTN_TYP_CDE  45870000
462303                   AND A.INTGRTN_TYP_CDE    =  H.INTGRTN_TYP_CDE  45880000
462304                   AND A.INTGRTN_TYP_CDE    =  I.INTGRTN_TYP_CDE  45890000
462305                   AND A.INTGRTN_TYP_CDE    =  J.INTGRTN_TYP_CDE  45900000
462306                   AND A.INTGRTN_TYP_CDE    =  K.INTGRTN_TYP_CDE  45910000
462307                   AND B.ATTR_DEFN_SEQ_NBR  =  1                  45920000
462308                   AND C.ATTR_DEFN_SEQ_NBR  =  1                  45930000
462309                   AND D.ATTR_DEFN_SEQ_NBR  =  2                  45940000
462310                   AND E.ATTR_DEFN_SEQ_NBR  =  3                  45950000
462311                   AND F.ATTR_DEFN_SEQ_NBR  =  4                  45960000
462312                   AND G.ATTR_DEFN_SEQ_NBR  =  5                  45970000
462313                   AND H.ATTR_DEFN_SEQ_NBR  =  6                  45980000
462314                   AND I.ATTR_DEFN_SEQ_NBR  =  7                  45990000
462315                   AND J.ATTR_DEFN_SEQ_NBR  =  8                  46000000
462316                   AND K.ATTR_DEFN_SEQ_NBR  =  9                  46010000
462317                   AND C.ATTR_ELEM_SEQ_NBR  =  D.ATTR_ELEM_SEQ_NBR46020000
462318                   AND C.ATTR_ELEM_SEQ_NBR  =  E.ATTR_ELEM_SEQ_NBR46030000
462319                   AND C.ATTR_ELEM_SEQ_NBR  =  F.ATTR_ELEM_SEQ_NBR46040000
462320                   AND C.ATTR_ELEM_SEQ_NBR  =  G.ATTR_ELEM_SEQ_NBR46050000
462321                   AND C.ATTR_ELEM_SEQ_NBR  =  H.ATTR_ELEM_SEQ_NBR46060000
462322                   AND C.ATTR_ELEM_SEQ_NBR  =  I.ATTR_ELEM_SEQ_NBR46070000
462323                   AND C.ATTR_ELEM_SEQ_NBR  =  J.ATTR_ELEM_SEQ_NBR46080000
462324                   AND C.ATTR_ELEM_SEQ_NBR  =  K.ATTR_ELEM_SEQ_NBR46090000
462325                   AND F.ATTR_ELEM_TXT      =  'Y'                46100000
462326                   AND G.ATTR_ELEM_TMST    <=  CURRENT TIMESTAMP  46110000
462327                   AND H.ATTR_ELEM_TMST    >=  CURRENT TIMESTAMP  46120000
462328                   AND C.ATTR_ELEM_NBR      = :DK-OPER-UNT-ID     46130000
462329                   AND K.ATTR_ELEM_TXT      =  'Y'                46140000
462330                                                  )               46150000
462340              END-EXEC                                            46160000
462341                                                                  46170000
462342         WHEN ASC-PACK-BY-STORE-ORDER                             46180000
462343             EXEC SQL                                             46190000
462344               SELECT  COUNT(*)                                   46200000
462345                 INTO  :PV-COUNT-DIRECTIVES                       46210000
462346                 FROM  SUT_CART_DIRV_TRKG   A                     46220000
462347                WHERE  A.OPER_UNT_ID       = :DK-OPER-UNT-ID      46230000
462348                  AND  A.PO_NBR            = :DK-PO-NBR           46231000
462349                  AND  A.RCVR_SEQ_NBR      = :DK-REC-SEQ-NBR      46232000
462350                  AND  A.DIRV_RSN_CDE   <>    'AUQ'               46233000
462351                  AND  A.CRE_TMST          =                      46234000
462360                        (SELECT MAX(B.CRE_TMST)                   46234100
462370                           FROM SUT_CART_DIRV_TRKG  B             46234200
462380                          WHERE B.BRCDE_NBR = A.BRCDE_NBR)        46234300
462391                  AND  A.LGCL_LOC_NM  IN                          46234400
462392                   (                                              46234500
462393                      SELECT DISTINCT(E.ATTR_ELEM_TXT)            46234600
462394                      FROM WST_INTGRTN_TYP A                      46234700
462395                         , WST_ATTR_DEFN           B              46234800
462396                         , WST_ATTR_ELEM           C              46234900
462397                         , WST_ATTR_ELEM           D              46235000
462398                         , WST_ATTR_ELEM           E              46236000
462399                         , WST_ATTR_ELEM           F              46237000
462400                         , WST_ATTR_ELEM           G              46238000
462401                         , WST_ATTR_ELEM           H              46239000
462402                         , WST_ATTR_ELEM           I              46239100
462403                         , WST_ATTR_ELEM           J              46239200
462404                         , WST_ATTR_ELEM           K              46239300
462405                 WHERE A.INTGRTN_TYP_CDE    =  'ACAULGDST'        46239400
462406                   AND A.INTGRTN_TYP_CDE    =  B.INTGRTN_TYP_CDE  46239500
462407                   AND A.INTGRTN_TYP_CDE    =  C.INTGRTN_TYP_CDE  46239600
462408                   AND A.INTGRTN_TYP_CDE    =  D.INTGRTN_TYP_CDE  46239700
462409                   AND A.INTGRTN_TYP_CDE    =  E.INTGRTN_TYP_CDE  46239800
462410                   AND A.INTGRTN_TYP_CDE    =  F.INTGRTN_TYP_CDE  46239900
462411                   AND A.INTGRTN_TYP_CDE    =  G.INTGRTN_TYP_CDE  46240000
462412                   AND A.INTGRTN_TYP_CDE    =  H.INTGRTN_TYP_CDE  46240100
462413                   AND A.INTGRTN_TYP_CDE    =  I.INTGRTN_TYP_CDE  46240200
462414                   AND A.INTGRTN_TYP_CDE    =  J.INTGRTN_TYP_CDE  46240300
462415                   AND A.INTGRTN_TYP_CDE    =  K.INTGRTN_TYP_CDE  46240400
462416                   AND B.ATTR_DEFN_SEQ_NBR  =  1                  46240500
462417                   AND C.ATTR_DEFN_SEQ_NBR  =  1                  46240600
462418                   AND D.ATTR_DEFN_SEQ_NBR  =  2                  46240700
462419                   AND E.ATTR_DEFN_SEQ_NBR  =  3                  46240800
462420                   AND F.ATTR_DEFN_SEQ_NBR  =  4                  46240900
462421                   AND G.ATTR_DEFN_SEQ_NBR  =  5                  46241000
462422                   AND H.ATTR_DEFN_SEQ_NBR  =  6                  46241100
462423                   AND I.ATTR_DEFN_SEQ_NBR  =  7                  46241200
462424                   AND J.ATTR_DEFN_SEQ_NBR  =  8                  46241300
462425                   AND K.ATTR_DEFN_SEQ_NBR  =  9                  46241400
462426                   AND C.ATTR_ELEM_SEQ_NBR  =  D.ATTR_ELEM_SEQ_NBR46241500
462427                   AND C.ATTR_ELEM_SEQ_NBR  =  E.ATTR_ELEM_SEQ_NBR46241600
462428                   AND C.ATTR_ELEM_SEQ_NBR  =  F.ATTR_ELEM_SEQ_NBR46241700
462429                   AND C.ATTR_ELEM_SEQ_NBR  =  G.ATTR_ELEM_SEQ_NBR46241800
462430                   AND C.ATTR_ELEM_SEQ_NBR  =  H.ATTR_ELEM_SEQ_NBR46241900
462431                   AND C.ATTR_ELEM_SEQ_NBR  =  I.ATTR_ELEM_SEQ_NBR46242000
462432                   AND C.ATTR_ELEM_SEQ_NBR  =  J.ATTR_ELEM_SEQ_NBR46242100
462433                   AND C.ATTR_ELEM_SEQ_NBR  =  K.ATTR_ELEM_SEQ_NBR46242200
462434                   AND F.ATTR_ELEM_TXT      =  'Y'                46242300
462435                   AND G.ATTR_ELEM_TMST    <=  CURRENT TIMESTAMP  46242400
462436                   AND H.ATTR_ELEM_TMST    >=  CURRENT TIMESTAMP  46242500
462437                   AND C.ATTR_ELEM_NBR      = :DK-OPER-UNT-ID     46242600
462438                   AND K.ATTR_ELEM_TXT      =  'Y'                46242700
462439                                                  )               46242800
462440              END-EXEC                                            46242900
462441                                                                  46243000
462450         WHEN ASC-BULK-CASE-ORDER                                 46243100
462460             EXEC SQL                                             46243200
462470               SELECT  COUNT(*)                                   46243300
462480                 INTO  :PV-COUNT-DIRECTIVES                       46243400
462490                 FROM  SUT_CART_DIRV_TRKG   A                     46243500
462500                WHERE  A.OPER_UNT_ID       = :DK-OPER-UNT-ID      46243600
462600                   AND A.PO_NBR            = :DK-PO-NBR           46243700
462700                   AND A.RCVR_SEQ_NBR      = :DK-REC-SEQ-NBR      46243800
462800                   AND A.PO_LNE_NBR        = :DK-PO-LNE-NBR       46243900
462801                   AND  A.DIRV_RSN_CDE   <>    'AUQ'              46244000
462810                   AND A.CRE_TMST          =                      46245000
462900                        (SELECT MAX(B.CRE_TMST)                   46246000
463000                           FROM SUT_CART_DIRV_TRKG  B             46247000
463100                          WHERE B.BRCDE_NBR = A.BRCDE_NBR)        46248000
463200                   AND  A.LGCL_LOC_NM  IN                         46249000
463300                   (                                              46250000
463400                      SELECT DISTINCT(E.ATTR_ELEM_TXT)            46260000
463500                      FROM WST_INTGRTN_TYP A                      46270000
463600                         , WST_ATTR_DEFN           B              46280000
463700                         , WST_ATTR_ELEM           C              46290000
463800                         , WST_ATTR_ELEM           D              46300000
463900                         , WST_ATTR_ELEM           E              46310000
464000                         , WST_ATTR_ELEM           F              46320000
464100                         , WST_ATTR_ELEM           G              46330000
464200                         , WST_ATTR_ELEM           H              46340000
464300                         , WST_ATTR_ELEM           I              46350000
464400                         , WST_ATTR_ELEM           J              46360000
464500                         , WST_ATTR_ELEM           K              46370000
464600                 WHERE A.INTGRTN_TYP_CDE    =  'ACAULGDST'        46380000
464700                   AND A.INTGRTN_TYP_CDE    =  B.INTGRTN_TYP_CDE  46390000
464800                   AND A.INTGRTN_TYP_CDE    =  C.INTGRTN_TYP_CDE  46400000
464900                   AND A.INTGRTN_TYP_CDE    =  D.INTGRTN_TYP_CDE  46410000
465000                   AND A.INTGRTN_TYP_CDE    =  E.INTGRTN_TYP_CDE  46420000
465100                   AND A.INTGRTN_TYP_CDE    =  F.INTGRTN_TYP_CDE  46430000
465200                   AND A.INTGRTN_TYP_CDE    =  G.INTGRTN_TYP_CDE  46440000
465300                   AND A.INTGRTN_TYP_CDE    =  H.INTGRTN_TYP_CDE  46450000
465400                   AND A.INTGRTN_TYP_CDE    =  I.INTGRTN_TYP_CDE  46460000
465500                   AND A.INTGRTN_TYP_CDE    =  J.INTGRTN_TYP_CDE  46470000
465600                   AND A.INTGRTN_TYP_CDE    =  K.INTGRTN_TYP_CDE  46480000
465700                   AND B.ATTR_DEFN_SEQ_NBR  =  1                  46490000
465800                   AND C.ATTR_DEFN_SEQ_NBR  =  1                  46500000
465900                   AND D.ATTR_DEFN_SEQ_NBR  =  2                  46510000
466000                   AND E.ATTR_DEFN_SEQ_NBR  =  3                  46520000
466100                   AND F.ATTR_DEFN_SEQ_NBR  =  4                  46530000
466200                   AND G.ATTR_DEFN_SEQ_NBR  =  5                  46540000
466300                   AND H.ATTR_DEFN_SEQ_NBR  =  6                  46550000
466310                   AND I.ATTR_DEFN_SEQ_NBR  =  7                  46560000
466320                   AND J.ATTR_DEFN_SEQ_NBR  =  8                  46570000
466330                   AND K.ATTR_DEFN_SEQ_NBR  =  9                  46580000
466340                   AND C.ATTR_ELEM_SEQ_NBR  =  D.ATTR_ELEM_SEQ_NBR46590000
466350                   AND C.ATTR_ELEM_SEQ_NBR  =  E.ATTR_ELEM_SEQ_NBR46600000
466360                   AND C.ATTR_ELEM_SEQ_NBR  =  F.ATTR_ELEM_SEQ_NBR46610000
466370                   AND C.ATTR_ELEM_SEQ_NBR  =  G.ATTR_ELEM_SEQ_NBR46620000
466380                   AND C.ATTR_ELEM_SEQ_NBR  =  H.ATTR_ELEM_SEQ_NBR46630000
466390                   AND C.ATTR_ELEM_SEQ_NBR  =  I.ATTR_ELEM_SEQ_NBR46631000
466391                   AND C.ATTR_ELEM_SEQ_NBR  =  J.ATTR_ELEM_SEQ_NBR46632000
466392                   AND C.ATTR_ELEM_SEQ_NBR  =  K.ATTR_ELEM_SEQ_NBR46633000
466393                   AND F.ATTR_ELEM_TXT      =  'Y'                46634000
466394                   AND G.ATTR_ELEM_TMST    <=  CURRENT TIMESTAMP  46635000
466395                   AND H.ATTR_ELEM_TMST    >=  CURRENT TIMESTAMP  46636000
466396                   AND C.ATTR_ELEM_NBR      = :DK-OPER-UNT-ID     46637000
466397                   AND K.ATTR_ELEM_TXT      =  'Y'                46638000
466398                                                  )               46639000
466399              END-EXEC                                            46639100
466400                                                                  46639200
466401     END-EVALUATE.                                                46639300
466410*CT END   02/04/09 IR #18412                                      46639400
466500                                                                  46639500
466600     EVALUATE TRUE                                                46639600
466700         WHEN SQLCODE = ZERO                                      46639700
466800              CONTINUE                                            46639800
466900         WHEN SQLCODE = +100                                      46639900
467000              CONTINUE                                            46640000
467100         WHEN SQLWARN0 NOT = SPACE                                46641000
467200         WHEN SQLCODE NOT = ZERO                                  46642000
467300              MOVE '7140-SELECT-DIRV-TRKG  ' TO                   46643000
467400                                   DP013-PARAGRAPH                46644000
467500              MOVE 'SELECT FOR PO BAD' TO                         46645000
467600                                   DP013-MESSAGE-TEXT (1)         46646000
467700              MOVE SQLCA       TO DP013-SQLCA                     46647000
467800              MOVE 'SUT_CART_DIRV_TRKG' TO                        46648000
467900                                   DP013-DB2-TABLE-NAME (1)       46649000
468000              SET DP013-DB2-ABEND                                 46650000
468100                  DP013-XCTL-DISPLAY-RESTART TO TRUE              46660000
468200              PERFORM DP013-0000-PROCESS-ABEND                    46670000
468300     END-EVALUATE.                                                46680000
468400/                                                                 46690000
480400 7200-RACF-ACCESS.                                                46700000
480500                                                                  46710000
480600* IS THE USER AUTHORIZED TO RELEASE DIRECTIVES ON THIS SCREEN?    46720000
480700                                                                  46730000
480800      SET DP008-RSRC-TYPE-FUNC           TO TRUE                  46740000
480900**??  SHOULD BE CHANGED BACK TO SUDIRRLS AFTER IT IS DEFINED      46750000
481000**??  TALK TO CATHY FAIRWEATHER.                                  46760000
481100      MOVE 'SUDIRRLS'                    TO DP008-FUNCTION-NAME   46770000
481200**??  MOVE 'RCPSINAC'                    TO DP008-FUNCTION-NAME   46780000
481300      SET DP008-ACCESS-TYPE-USE          TO TRUE                  46790000
481400                                                                  46800000
481500      EXEC CICS                                                   46810000
481600         LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                 46820000
481700              COMMAREA (DP008-SECURITY-COMMAREA)                  46830000
481800              LENGTH (DP008-SECURITY-COMMAREA-LENGTH)             46840000
481900      END-EXEC                                                    46850000
482000                                                                  46860000
482100      IF DP008-CALL-SUCCESSFUL                                    46870000
482200         IF DP008-ACCESS-ALLOWED                                  46880000
482300             SET PS-RELEASE-ALLOWED TO TRUE                       46890000
482400         ELSE                                                     46900000
482500             SET PS-RELEASE-NOT-ALLOWED TO TRUE                   46910000
482600         END-IF                                                   46920000
482700     ELSE                                                         46930000
482800         MOVE '7200-RACF-ACCESS'                                  46940000
482900                               TO DP013-PARAGRAPH                 46950000
483000          MOVE 'UNABLE TO ACCESS CICS'                            46960000
483100                               TO DP013-MESSAGE-TEXT (1)          46970000
483200          MOVE SQLCA                 TO DP013-SQLCA               46980000
483300          SET DP013-DB2-ABEND                                     46990000
483400              DP013-XCTL-DISPLAY-RESTART                          47000000
483500                               TO TRUE                            47010000
483600          PERFORM DP013-0000-PROCESS-ABEND                        47020000
483700      END-IF.                                                     47030000
483800                                                                  47040000
483900 7400-BUILD-REQUEST.                                              47050000
484000                                                                  47060000
484100     INITIALIZE SU090-DG-REQUEST-COMMAREA.                        47070000
484200                                                                  47080000
484300     MOVE '00'                  TO SU090-RET-CODE.                47090000
484400     MOVE 'SUKCS799'            TO SU090-CALLING-PGM.             47100000
484500     SET  SU090-ONLINE          TO TRUE.                          47110000
484600                                                                  47120000
484700     MOVE ASC-OPER-UNT-ID       TO SU090-OPER-UNT-ID.             47130000
484800     SET SU090-ADD-ACTION       TO TRUE.                          47140000
484900                                                                  47150000
485000     EVALUATE TRUE                                                47160000
485100         WHEN ASC-PACK-BY-STORE-ORDER                             47170000
485200              SET SU090-PO-RCVR-DIRECTIVE TO TRUE                 47180000
485300                                                                  47190000
485400         WHEN ASC-PREPK-ORDER                                     47200000
485500              SET SU090-PO-RCVR-PACK-DIRECTIVE TO TRUE            47210000
485600                                                                  47220000
485700         WHEN OTHER                                               47230000
485800              SET SU090-PO-RCVR-LINE-DIRECTIVE TO TRUE            47240000
485900                                                                  47250000
486000     END-EVALUATE.                                                47260000
486100                                                                  47270000
486200     MOVE PC-RLO                TO SU090-DIRV-RSN-CDE.            47280000
486300                                                                  47290000
486400     MOVE SPACES  TO  SU090-BRCDE-TYP-CDE.                        47300000
486500     MOVE SPACES  TO  SU090-P2L-BRCDE-NBR.                        47310000
486600     MOVE ZEROES  TO  SU090-SML-BRCDE-NBR.                        47320000
486700                                                                  47330000
486800     MOVE ASC-PO-NBR            TO SU090-PO-NBR.                  47340000
486900                                                                  47350000
487000     EVALUATE TRUE                                                47360000
487100         WHEN ASC-PREPK-ORDER                                     47370000
487200              MOVE LQW-PREPACK-ID (LQW-IDX) TO                    47380000
487300                                           SU090-PO-PREPK-ID      47390000
487400                                                                  47400000
487500         WHEN ASC-PACK-BY-STORE-ORDER                             47410000
487600              CONTINUE                                            47420000
487700                                                                  47430000
487800         WHEN ASC-BULK-CASE-ORDER                                 47440000
487900              MOVE LQW-LNE-NBR (LQW-IDX) TO                       47450000
488000                                             SU090-PO-LNE-NBR     47460000
488100                                                                  47470000
488200     END-EVALUATE.                                                47480000
488300                                                                  47490000
488400     MOVE ASC-RCVR        TO SU090-RCVR-SEQ-NBR.                  47500000
488500                                                                  47510000
488600     SET  SU090-ACTIVE-CART        TO TRUE.                       47520000
488700                                                                  47530000
488800     MOVE LQW-AUD-CNTL-NBR (LQW-IDX) TO                           47540000
488900                                   SU090-AUD-CNTL-NBR             47550000
489000     MOVE LQW-AUD-STAT-CDE (LQW-IDX) TO                           47560000
489100                                   SU090-AUD-STAT-CDE             47570000
489200                                                                  47580000
489300     MOVE LQW-AUD-FALR-RSN-NM (LQW-IDX) TO                        47590000
489400                                      SU090-AUD-FAIL-RSN.         47600000
489500     MOVE LQW-STR-ZN-ID    (LQW-IDX) TO                           47610000
489600                                      SU090-STR-ZN.               47620000
489700     MOVE LQW-SEASET-YR    (LQW-IDX) TO                           47630000
489800                                      SU090-SEASET-YR.            47640000
489900     MOVE LQW-SEASET-SHRT-NM (LQW-IDX) TO                         47650000
490000                                      SU090-SEASET-CDE.           47660000
490100     MOVE LQW-STR-NBR      (LQW-IDX) TO                           47670000
490200                                      SU090-STR-NBR.              47680000
490300     MOVE DP020-USERID     TO         SU090-ASSOC-ID.             47690000
490400                                                                  47700000
      * 12/13 RLK BEG                                                   47710000
           PERFORM 7700-CHECK-FOR-PRV-RF-AUD-FAIL                       47720000
      ***NEED TO CHECK FOR RF PENDING/FAILED                            47730000
           IF PS-FAILED-PENDING-RF-FOUND                                47740000
             MOVE PV-RFID-AUD-CNTL TO SU090-AUD-CNTL-NBR                47750000
             IF PS-FAILED-RF-AUD                                        47760000
      ***IF RF PENDING/FAILED WE WILL USE RF AUDIT AS SOURCE FOR DI     47770000
               MOVE 'R'   TO SU090-CASI-CDE                             47780000
               MOVE 'AUR' TO SU090-DIRV-RSN-CDE                         47790000
             ELSE                                                       47800000
               MOVE 'U'   TO SU090-CASI-CDE                             47810000
               MOVE 'AUU' TO SU090-DIRV-RSN-CDE                         47820000
             END-IF                                                     47830000
           END-IF.                                                      47840000
      * 12/13 RLK END                                                   47850000
490500                                                                  47860000
490600******************************************************************47870000
490700*     CALL PGM SUKUT129. CHECK FOR ERRORS UPON RETURN            *47880000
490800******************************************************************47890000
490900 7500-CALL-SUKUT129.                                              47900000
491000                                                                  47910000
491100     INSPECT SU090-DG-REQUEST-COMMAREA                            47920000
491200         REPLACING ALL LOW-VALUES BY '?'.                         47930000
491300                                                                  47940000
491400     CALL SU090-DIRV-GEN-PGM USING DFHEIBLK                       47950000
491500                                SU090-COMMAREA                    47960000
491600                                SU090-DG-REQUEST-COMMAREA.        47970000
491700                                                                  47980000
491800     IF SU090-SUCCESS                                             47990000
491900*CT BEGIN 02/02/09 IR 18319                                       48000000
492000        PERFORM 7501-UPDATE-PO-AUD-REQ                            48010000
492100*CT END   02/02/09                                                48020000
492200     ELSE                                                         48030000
492210         SET PS-ERROR                  TO TRUE                    48040000
492220         SET DP020-MSG-WARNING         TO TRUE                    48050000
492230                                                                  48060000
492300         MOVE SU090-SQLCA             TO DP013-SQLCA              48070000
492600         MOVE '7500-CALL-SUKUT129'    TO DP013-PARAGRAPH          48080000
492700         MOVE SU090-SQLCODE           TO PV-SQLCODE               48090000
492800         MOVE SU090-MQ-COND-CODE      TO PV-MQ-COND-CODE          48100000
492900         MOVE SU090-MQ-REAS-CODE      TO PV-MQ-REAS-CODE          48110000
493000         MOVE PC-TSYMSG-03660         TO DP020-MSG-NUMBER         48120000
493010                                                                  48130000
493020         MOVE PC-CURRENT-PROGRAM-NAME TO PV-MSG-PGM               48140000
493030                                                                  48150000
493100         EVALUATE TRUE                                            48160000
493200             WHEN SU090-PARAMETER-ERROR                           48170000
493210                 SET PV-PARM-ERROR  TO TRUE                       48180000
493220                 MOVE '** INVALID PARM UPON RETURN FROM SUKUT129 '48190000
493230                   TO PV-ERROR-DESC                               48200000
493240             WHEN SU090-DB2-ERROR                                 48210000
493250                 SET PV-DB2-ERROR   TO TRUE                       48220000
493260                 STRING '** DB2 ERROR - '                         48230000
493270                        'PGM SUKUT129 - '                         48240000
493280                        'PARA - '         SU090-ERR-PARAGRAPH     48250000
493290                        ' SQLCODE =: '    PV-SQLCODE              48260000
493300                     DELIMITED BY SIZE INTO PV-SQLCODE            48270000
493400             WHEN SU090-MQ-ERROR                                  48280000
493500                 SET PV-MQ-ERROR    TO TRUE                       48290000
493600                 STRING '** MQ ERROR - '                          48300000
493700                        'PGM SUKUT129 - '                         48310000
493800                        'PARA - '         SU090-ERR-PARAGRAPH     48320000
493900                        ' MQCODE =: '     PV-MQ-COND-CODE         48330000
494000                     DELIMITED BY SIZE INTO PV-ERROR-DESC         48340000
494100             WHEN SU090-OTHER-ERROR                               48350000
494200                 SET PV-OTHER-ERROR TO TRUE                       48360000
494300                 STRING '** UNKNOWN ERROR UPON '                  48370000
494400                        'RETURN FROM SUKUT129 '                   48380000
494500                     DELIMITED BY SIZE INTO PV-ERROR-DESC         48390000
494800         END-EVALUATE                                             48400000
494900         PERFORM 9999-WRITE-CSSL-MSG                              48410000
495300      END-IF.                                                     48420000
495400                                                                  48430000
495500*----------------------------------------------------------------*48440000
495600* UPDATE DIRV_RLSE_IN TO WHAT WAS ENTERED IN SCREEN              *48450000
495700*----------------------------------------------------------------*48460000
495800 7501-UPDATE-PO-AUD-REQ.                                          48470000
495900                                                                  48480000
496000     MOVE LQW-RLSD-CRTN-NOT-RCVD (LQW-IDX) TO                     48490000
496100                                           DK-RLSD-CRTN-NOT-RCVD. 48500000
496200     MOVE SU090-AUD-CNTL-NBR               TO DK-AUD-CNTL-NBR.    48510000
496300                                                                  48520000
496400     EXEC SQL                                                     48530000
496500          UPDATE SUT_PO_AUD_REQ                                   48540000
496501             SET DIRV_RLSE_IND  = :DK-RLSD-CRTN-NOT-RCVD          48550000
496502           WHERE AUD_CNTL_NBR   = :DK-AUD-CNTL-NBR                48560000
496503     END-EXEC.                                                    48570000
496504                                                                  48580000
496505     EVALUATE TRUE                                                48590000
496506         WHEN SQLCODE = ZERO                                      48600000
496507              CONTINUE                                            48610000
496508         WHEN SQLCODE = +100                                      48620000
496509              CONTINUE                                            48630000
496510         WHEN SQLWARN0 NOT = SPACE                                48640000
496520         WHEN SQLCODE NOT = ZERO                                  48650000
496530              MOVE '7140-SELECT-DIRV-TRKG  ' TO                   48660000
496540                                   DP013-PARAGRAPH                48670000
496550              MOVE 'SELECT FOR PO BAD' TO                         48680000
496560                                   DP013-MESSAGE-TEXT (1)         48690000
496570              MOVE SQLCA       TO DP013-SQLCA                     48700000
496580              MOVE 'SUT_CART_DIRV_TRKG' TO                        48710000
496581                                   DP013-DB2-TABLE-NAME (1)       48720000
496582              SET DP013-DB2-ABEND                                 48730000
496583                  DP013-XCTL-DISPLAY-RESTART TO TRUE              48740000
496584              PERFORM DP013-0000-PROCESS-ABEND                    48750000
496585     END-EVALUATE.                                                48760000
496586                                                                  48770000
      * 12/13 RLK BEG                                                   48780000
430000******************************************************************48790000
430100* GET ANY FAILED/PENDING RFID AUDITS                              48800000
430200*                                                                 48810000
430300******************************************************************48820000
430400 7700-CHECK-FOR-PRV-RF-AUD-FAIL.                                  48830000
430500                                                                  48840000
430600     MOVE LQW-AUD-CNTL-NBR (LQW-IDX) TO DK-AUD-CNTL-NBR.          48850000
430600     MOVE ASC-OPER-UNT-ID            TO DK-OPER-UNT-ID.           48860000
430600     MOVE ASC-PO-NBR                 TO SUT00015-PO-NBR.          48870000
430700                                                                  48880000
430800     EXEC SQL                                                     48890000
              SELECT B.AUD_STAT_CDE                                     48900000
                    ,B.AUD_CNTL_NBR                                     48910000
              INTO :SUT00015-AUD-STAT-CDE                               48920000
                  ,:PV-RFID-AUD-CNTL                                    48930000
              FROM SUT_PO_AUD_REQ A                                     48940000
                  ,SUT_PO_AUD_REQ B                                     48950000
              WHERE A.PO_NBR = :SUT00015-PO-NBR                         48960000
                AND A.OPER_UNT_ID    = :DK-OPER-UNT-ID                  48970000
                AND A.AUD_CNTL_NBR = :DK-AUD-CNTL-NBR                   48980000
                AND B.AUD_CNTL_NBR = A.RWRK_AUD_CNTL_NBR                48990000
                AND B.AUD_STAT_CDE IN ('I','F')                         49000000
431500     END-EXEC.                                                    49010000
431600                                                                  49020000
431700     EVALUATE TRUE                                                49030000
431800         WHEN SQLCODE = +0                                        49040000
                 MOVE SUT00015-AUD-STAT-CDE TO PS-RFID-AUDIT-NO-FAIL-SW 49050000
               WHEN SQLCODE = +100                                      49060000
                 SET PS-RFID-AUDIT-NO-FAIL TO TRUE                      49070000
432400         WHEN SQLWARN0 NOT = SPACES                               49080000
432500         WHEN SQLCODE < +0                                        49090000
432600         WHEN SQLCODE > +0                                        49100000
432700             MOVE '7700-CHECK-FOR-PRV-RF-AUD-FAIL'                49110000
432800                                       TO DP013-PARAGRAPH         49120000
432900             MOVE 'BAD SELECT                     '               49130000
433000                                 TO DP013-MESSAGE-TEXT (1)        49140000
433100             MOVE SQLCA      TO DP013-SQLCA                       49150000
433200             MOVE 'SUT_PO_AUD_REQ    '  TO                        49160000
433300                                DP013-DB2-TABLE-NAME (1)          49170000
433400             SET DP013-DB2-ABEND                                  49180000
433500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               49190000
433600             PERFORM DP013-0000-PROCESS-ABEND                     49200000
433700     END-EVALUATE.                                                49210000
433800/                                                                 49220000
      * 12/13 RLK END                                                   49230000
496587*----------------------------------------------------------------*49240000
496588* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *49250000
496589*----------------------------------------------------------------*49260000
496590 9100-READ-SEL-QUEUE.                                             49270000
496600     EXEC CICS                                                    49280000
496610         READQ TS                                                 49290000
496620             QUEUE (ASC-SEL-QUEUE-NAME)                           49300000
496630             INTO  (SU099-SELECT-RECORD)                          49310000
496640             ITEM  (ASC-SEL-ITEM)                                 49320000
496650             RESP  (PV-CICS-RESPONSE)                             49330000
496660     END-EXEC.                                                    49340000
496670                                                                  49350000
496680     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       49360000
496690         CONTINUE                                                 49370000
496700     ELSE                                                         49380000
496800         SET DP013-LOGIC-ABEND                                    49390000
496900             DP013-NO-ROLLBACK     TO TRUE                        49400000
497000         MOVE '9100-READ-SEL-QUEUE' TO DP013-PARAGRAPH            49410000
497100         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   49420000
497200                                   TO DP013-MESSAGE-TEXT (1)      49430000
497300         PERFORM DP013-0000-PROCESS-ABEND                         49440000
497400     END-IF.                                                      49450000
497500                                                                  49460000
497600*----------------------------------------------------------------*49470000
497700* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *49480000
497710*----------------------------------------------------------------*49490000
497720 9200-REWRITE-SEL-QUEUE.                                          49500000
497730     EXEC CICS                                                    49510000
497740          WRITEQ TS                                               49520000
497750              QUEUE  (ASC-SEL-QUEUE-NAME)                         49530000
497760              FROM   (SU099-SELECT-RECORD)                        49540000
497770              ITEM   (ASC-SEL-ITEM)                               49550000
497780              RESP   (PV-CICS-RESPONSE)                           49560000
497790              REWRITE                                             49570000
497800     END-EXEC.                                                    49580000
497900                                                                  49590000
498000     IF  PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                   49600000
498100         SET DP013-CICS-ABEND                                     49610000
498200             DP013-NO-ROLLBACK     TO TRUE                        49620000
498300         MOVE '9200-REWRITE-SEL-QUEUE'  TO DP013-PARAGRAPH        49630000
498400         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   49640000
498500                                   TO DP013-MESSAGE-TEXT (1)      49650000
498600         PERFORM DP013-0000-PROCESS-ABEND                         49660000
498700     END-IF.                                                      49670000
498800                                                                  49680000
498900                                                                  49690000
498910******************************************************************49700000
498920* 9999-WRITE-CSSL-MSG                                            *49710000
498930*     WRITE SPECIFIC ERROR MESSAGES TO THE CSSL QUEUE            *49720000
498940******************************************************************49730000
498950 9999-WRITE-CSSL-MSG.                                             49740000
498960                                                                  49750000
498970     MOVE LENGTH OF PV-CICS-MSG-AREA TO PV-COMMAREA-LENGTH.       49760000
498980                                                                  49770000
498990     EXEC CICS                                                    49780000
498991          WRITEQ TD                                               49790000
498992           QUEUE  ('CSSL')                                        49800000
498993            FROM  (PV-CICS-MSG-AREA)                              49810000
498994          LENGTH  (PV-COMMAREA-LENGTH)                            49820000
498995            RESP  (PV-CICS-RESPONSE)                              49830000
498996     END-EXEC.                                                    49840000
498997/                                                                 49850000
499000*----------------------------------------------------------------*49860000
499100*    ABEND PROCESSOR MODULE                                      *49870000
499200*----------------------------------------------------------------*49880000
499300     COPY DPPD013.                                                49890000
