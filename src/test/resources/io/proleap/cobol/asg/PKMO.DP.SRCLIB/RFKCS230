000100 IDENTIFICATION DIVISION.                                         00010099
000200 PROGRAM-ID.        RFKCS230.                                     00020099
000300 AUTHOR.            KOHLS DEPARTMENT STORES.                      00030099
000400 INSTALLATION.      KOHLS DEPARTMENT STORES.                      00040099
000500 DATE-WRITTEN.      JUNE, 2000.                                   00050099
000600 DATE-COMPILED.                                                   00060099
000700 ENVIRONMENT DIVISION.                                            00070099
000800 DATA DIVISION.                                                   00080099
000900******************************************************************00090099
001000**T230: MQ LISTENER                                               00100099
001100**    PROGRAM THAT READS THE QUEUE AND STARTS THE TRANSACTION NUM-00110099
001200**    BER IN THE HEADER OF THE MESSAGE.                           00120099
001300******************************************************************00130099
001400**DATE:03/15/2004 CHANGED BY:JULIE TEWES PUT PROGRAM IN AND INDEF-00140099
001500**                INITE LOOP FOR MULTIPLE CICS REGIONS.           00150099
001600******************************************************************00160099
001700**DATE:03/08/2005 CHANGED BY:JULIE TEWES CHANGE TO NOT ABEND IF   00170099
001800**                INVALID TRANID IS RETURNED WHEN TRANSACTION IS  00180099
001900**                STARTED.                                        00190099
002000******************************************************************00200099
002100 WORKING-STORAGE SECTION.                                         00210099
002200******************************************************************00220099
002300 01  RF-SVR-READ-Q             PIC X(48)                          00230099
002400                               VALUE 'RF.SVR.READ.Q'.             00240099
002500 01  WS-MQCONN               PIC X(8)  VALUE 'CSQCCONN'.          00250099
002600 01  WS-MQOPEN               PIC X(8)  VALUE 'CSQCOPEN'.          00260099
002700 01  WS-MQINQ                PIC X(8)  VALUE 'CSQCINQ'.           00270099
002800 01  WS-MQGET                PIC X(8)  VALUE 'CSQCGET'.           00280099
002900 01  WS-MQPUT1               PIC X(8)  VALUE 'CSQCPUT1'.          00290099
003000 01  WS-MQPUT                PIC X(8)  VALUE 'CSQCPUT'.           00300099
003100 01  WS-MQBACK               PIC X(8)  VALUE 'CSQCBACK'.          00310099
003200 01  WS-MQCMIT               PIC X(8)  VALUE 'CSQCCOMM'.          00320099
003300 01  WS-MQCLOSE              PIC X(8)  VALUE 'CSQCCLOS'.          00330099
003400 01  WS-MQDISC               PIC X(8)  VALUE 'CSQCDISC'.          00340099
003500                                                                  00350099
003600*    API CONTROL BLOCKS                                           00360099
003700 01  MQM-OBJECT-DESCRIPTOR.                                       00370099
003800     COPY CMQODV.                                                 00380099
003900 01  MQM-MESSAGE-DESCRIPTOR.                                      00390099
004000     COPY CMQMDV.                                                 00400099
004100 01  MQM-GET-MESSAGE-OPTIONS.                                     00410099
004200     COPY CMQGMOV.                                                00420099
004300 01  MQM-PUT-MESSAGE-OPTIONS.                                     00430099
004400     COPY CMQPMOV.                                                00440099
004500*    MQV CONTAINS CONSTANTS (FOR FILLING IN THE CONTROL BLOCKS)   00450099
004600*    AND RETURN CODES (FOR TESTING THE RESULT OF A CALL)          00460099
004700 01  MQM-CONSTANTS.                                               00470099
004800     COPY CMQV.                                                   00480099
004900**---------------------------------------------------------------*00490099
005000**  VARIABLES REQUIRED FOR THE USE OF THE LOG MESSAGE ROUTINE    *00500099
005100**  (EPPD000)                                                    *00510099
005200**---------------------------------------------------------------*00520099
005300     COPY EPWS000.                                                00530099
005400*----------------------------------------------------------------*00540099
005500*    PROGRAM CONSTANTS                                            00550099
005600*----------------------------------------------------------------*00560099
005700 01  PC-PROGRAM-CONSTANTS.                                        00570099
005800     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08) VALUE             00580099
005900         'RFKCS230'.                                              00590099
006000     05  PC-YES                      PIC  X(01) VALUE 'Y'.        00600099
006100     05  PC-MQPUT-RETRY-COUNTER      PIC  9(3)  VALUE ZERO.       00610099
006200     05  PC-DELAY-INTERVAL.                                       00620099
006300         10  FILLER                  PIC X(2)   VALUE SPACES.     00630099
006400         10  PC-DELAY-TIME           PIC 9(8)   VALUE 1500.       00640099
006500*----------------------------------------------------------------*00650099
006600*    PROGRAM SWITCHES                                             00660099
006700*----------------------------------------------------------------*00670099
006800 01  PS-PROGRAM-SWITCHES.                                         00680099
006900     05  PS-MQGET-SUCCESSFUL-SW    PIC X(01) VALUE 'Y'.           00690099
007000         88  PS-MQGET-SUCCESSFUL             VALUE 'Y'.           00700099
007100         88  PS-MQGET-NOT-SUCCESSFUL         VALUE 'N'.           00710099
007200     05  PS-START-TRANID-INDICATOR PIC X(01) VALUE 'Y'.           00720099
007300         88  PS-START-TRANID-YES             VALUE 'Y'.           00730099
007400         88  PS-START-TRANID-NO              VALUE 'N'.           00740099
007500*----------------------------------------------------------------*00750099
007600*    PROGRAM VARIABLES                                            00760099
007700*----------------------------------------------------------------*00770099
007800 01  PV-PROGRAM-VARIABLES.                                        00780099
007900     05  PV-QMGR-NAME               PIC X(04)   VALUE SPACES.     00790099
008000         88  PV-PROD-QMGR-NAME                  VALUE 'QKSP'.     00800099
008100         88  PV-TEST-QMGR-NAME                  VALUE 'QKST'.     00810099
008200         88  PV-QA-QMGR-NAME                    VALUE 'QKSQ'.     00820099
008300     05  PV-RECV-MSG-BUFFER.                                      00830099
008400         10  PV-RECV-TRANID         PIC X(04)   VALUE SPACES.     00840099
008500         10  PV-RECV-MSG.                                         00850099
008600             15 FILLER              PIC X(12)   VALUE SPACES.     00860099
008700             15 PV-RECV-BUFFER      PIC X(4108) VALUE SPACES.     00870099
008800     05  PV-SEND-MSG-BUFFER.                                      00880099
008900         10  PV-SEND-BUFFER         PIC X(4120) VALUE ZEROES.     00890099
009000         10  PV-SEND-MQ-INDICATOR   PIC X(01)   VALUE SPACES.     00900099
009100         10  PV-SEND-REPLYTOQ       PIC X(48)   VALUE SPACES.     00910099
009200         10  PV-SEND-REPLYTOQMGR    PIC X(48)   VALUE SPACES.     00920099
009300         10  PV-SEND-MSGID          PIC X(24)   VALUE SPACES.     00930099
009400     05  PV-START-LENGTH            PIC 9(4)   BINARY VALUE 0.    00940099
009500     05  PV-RC                      PIC 9(4)   BINARY VALUE 0.    00950099
009600     05  PV-ERROR-MESSAGE           PIC X(48)  VALUE SPACES.      00960099
009700     05  PV-QM-NAME                 PIC X(48).                    00970099
009800     05  PV-MSGBUFFER               PIC X(1000000) VALUE SPACES.  00980099
009900     05  PV-MSGLENGTH            PIC S9(9) BINARY VALUE +1000000. 00990099
010000     05  PV-DATA-LENGTH          PIC S9(9) BINARY.                01000099
010100     05  PV-HCONN                PIC S9(9) BINARY VALUE 0.        01010099
010200     05  PV-GQ-HANDLE            PIC S9(9) BINARY VALUE 0.        01020099
010300     05  PV-OPEN-OPTIONS         PIC S9(9) BINARY VALUE 0.        01030099
010400     05  PV-COMPLETION-CODE      PIC S9(9) BINARY VALUE 0.        01040099
010500     05  PV-REASON               PIC S9(9) BINARY VALUE 0.        01050099
010600     05  PV-CON-REASON           PIC S9(9) BINARY VALUE 0.        01060099
010700     05  PV-PQ-HANDLE            PIC S9(9) BINARY VALUE 0.        01070099
010800     05  PV-CICS-RESPONSE                PIC S9(08)  VALUE ZEROS  01080099
010900                                                     COMP SYNC.   01090099
011000                                                                  01100099
011100 01  PH-PROGRAM-HOLD-VARIABLES.                                   01110099
011200     05  PH-COMPLETION-CODE          PIC  S9(09) BINARY.          01120099
011300     05  PH-REASON                   PIC  S9(09) BINARY.          01130099
011400                                                                  01140099
011500*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA                01150099
011600     COPY DPWS013.                                                01160099
011700*  RECORD LAYOUT FOR SYSTEM MESSAGES FILE USED FOR CICS MESSAGES  01170099
011800     COPY DPRD507I.                                               01180099
011900*  FORMATS CICS SYSTEM MESSAGES FOR NON-ARCHITECTURE PROGRAMS     01190099
012000     COPY DPWS011.                                                01200099
012100                                                                  01210099
012200 PROCEDURE DIVISION.                                              01220099
012300******************************************************************01230099
012400 0000-PROGRAM-MAINLINE.                                           01240099
012500                                                                  01250099
012600     PERFORM 1500-MQ-SETUP.                                       01260099
012700     INITIALIZE PS-PROGRAM-SWITCHES.                              01270099
012800     PERFORM 2100-MQGET-MSG.                                      01280099
012900     PERFORM 2000-PROCESS-MESSAGES                                01290099
013000             UNTIL PS-MQGET-NOT-SUCCESSFUL.                       01300099
013100     PERFORM 1600-CLOSE-GET-Q.                                    01310099
013200     PERFORM 1700-DISCONNECT-QMGR.                                01320099
013300     GOBACK.                                                      01330099
013400                                                                  01340099
013500 1500-MQ-SETUP.                                                   01350099
013600                                                                  01360099
013700* DETERMINE THE SYSTEM                                            01370099
013800     PERFORM EP000-0000-INITIALIZE.                               01380099
013900     IF EP000-PV-KOHLS-PROD-SYSTEM                                01390099
014000         SET PV-PROD-QMGR-NAME     TO TRUE                        01400099
014100     ELSE                                                         01410099
014200          IF EP000-PV-KOHLS-QA-SYSTEM                             01420099
014300              SET PV-QA-QMGR-NAME  TO TRUE                        01430099
014400          ELSE                                                    01440099
014500              SET PV-TEST-QMGR-NAME                               01450099
014600                                   TO TRUE                        01460099
014700          END-IF                                                  01470099
014800     END-IF.                                                      01480099
014900***************************************************************   01490099
015000*    CONNECT TO THE QUEUE MANAGER                                 01500099
015100***************************************************************   01510099
015200     MOVE PV-QMGR-NAME TO PV-QM-NAME.                             01520099
015300     CALL WS-MQCONN USING PV-QM-NAME                              01530099
015400                         PV-HCONN                                 01540099
015500                         PV-COMPLETION-CODE                       01550099
015600                         PV-REASON.                               01560099
015700***************************************************************   01570099
015800*    IF CONNECTION FAILED THEN DISPLAY ERROR MESSAGE              01580099
015900*    AND EXIT                                                     01590099
016000***************************************************************   01600099
016100     MOVE PV-REASON TO PV-CON-REASON.                             01610099
016200     IF (PV-COMPLETION-CODE NOT = MQCC-OK) THEN                   01620099
016300         MOVE 'MQCONN ERROR'        TO PV-ERROR-MESSAGE           01630099
016400         MOVE '1500-MQ-SETUP'       TO DP013-PARAGRAPH            01640099
016500         MOVE  PV-ERROR-MESSAGE     TO DP013-MESSAGE-TEXT (1)     01650099
016600         MOVE  PV-COMPLETION-CODE   TO DP013-MESSAGE-TEXT (2)     01660099
016700         MOVE  PV-REASON            TO DP013-MESSAGE-TEXT (3)     01670099
016800         SET DP013-CICS-ABEND                                     01680099
016900             DP013-NO-ROLLBACK       TO TRUE                      01690099
017000         PERFORM 9999-WRITE-CICS-LOG-MSG                          01700099
017100         PERFORM 9100-EXEC-CICS-RETURN                            01710099
017200     END-IF.                                                      01720099
017300***************************************************************   01730099
017400*    OPEN THE RF.SVR.READ.Q QUEUE FOR INPUT                       01740099
017500*    THIS QUEUE RESIDES ON THE SERVER                             01750099
017600***************************************************************   01760099
017700     COMPUTE PV-OPEN-OPTIONS = MQOO-INPUT-SHARED +                01770099
017800                               MQOO-FAIL-IF-QUIESCING.            01780099
017900     MOVE MQOT-Q                   TO MQOD-OBJECTTYPE.            01790099
018000     MOVE RF-SVR-READ-Q            TO MQOD-OBJECTNAME.            01800099
018100     MOVE PV-QM-NAME               TO MQOD-OBJECTQMGRNAME.        01810099
018200                                                                  01820099
018300     CALL WS-MQOPEN USING PV-HCONN                                01830099
018400                         MQM-OBJECT-DESCRIPTOR                    01840099
018500                         PV-OPEN-OPTIONS                          01850099
018600                         PV-GQ-HANDLE                             01860099
018700                         PV-COMPLETION-CODE                       01870099
018800                         PV-REASON.                               01880099
018900**********************************************************        01890099
019000*    IF OPEN FAILED THEN DISPLAY ERROR MESSAGE                    01900099
019100*    AND EXIT.                                                    01910099
019200**********************************************************        01920099
019300     IF (PV-COMPLETION-CODE NOT = MQCC-OK) THEN                   01930099
019400         PERFORM 1700-DISCONNECT-QMGR                             01940099
019500         MOVE 'MQOPEN READ Q'       TO PV-ERROR-MESSAGE           01950099
019600         MOVE '1500-MQ-SETUP'       TO DP013-PARAGRAPH            01960099
019700         MOVE  PV-ERROR-MESSAGE     TO DP013-MESSAGE-TEXT (1)     01970099
019800         MOVE  PV-COMPLETION-CODE   TO DP013-MESSAGE-TEXT (2)     01980099
019900         MOVE  PV-REASON            TO DP013-MESSAGE-TEXT (3)     01990099
020000         SET DP013-CICS-ABEND                                     02000099
020100             DP013-NO-ROLLBACK       TO TRUE                      02010099
020200         PERFORM 9999-WRITE-CICS-LOG-MSG                          02020099
020300         PERFORM 9100-EXEC-CICS-RETURN                            02030099
020400     END-IF.                                                      02040099
020500                                                                  02050099
020600 1600-CLOSE-GET-Q.                                                02060099
020700                                                                  02070099
020800     CALL WS-MQCLOSE USING PV-HCONN                               02080099
020900                           PV-GQ-HANDLE                           02090099
021000                           MQCO-NONE                              02100099
021100                           PV-COMPLETION-CODE                     02110099
021200                           PV-REASON.                             02120099
021300     IF (PV-COMPLETION-CODE NOT = MQCC-OK) THEN                   02130099
021400         MOVE 'MQCLOSE GQ HANDLE'   TO PV-ERROR-MESSAGE           02140099
021500         MOVE '1600-CLOSE-GET-Q'    TO DP013-PARAGRAPH            02150099
021600         MOVE  PV-ERROR-MESSAGE     TO DP013-MESSAGE-TEXT (1)     02160099
021700         MOVE  PV-COMPLETION-CODE   TO DP013-MESSAGE-TEXT (2)     02170099
021800         MOVE  PV-REASON            TO DP013-MESSAGE-TEXT (3)     02180099
021900         SET DP013-CICS-ABEND                                     02190099
022000             DP013-NO-ROLLBACK       TO TRUE                      02200099
022100         PERFORM 9999-WRITE-CICS-LOG-MSG                          02210099
022200         PERFORM 9100-EXEC-CICS-RETURN                            02220099
022300     END-IF.                                                      02230099
022400                                                                  02240099
022500 1700-DISCONNECT-QMGR.                                            02250099
022600                                                                  02260099
022700     IF PV-CON-REASON IS NOT EQUAL TO MQRC-ALREADY-CONNECTED      02270099
022800        CALL WS-MQDISC USING PV-HCONN                             02280099
022900                            PV-COMPLETION-CODE                    02290099
023000                            PV-REASON                             02300099
023100        IF (PV-COMPLETION-CODE NOT = MQCC-OK) THEN                02310099
023200            MOVE 'MQDISC'           TO PV-ERROR-MESSAGE           02320099
023300            MOVE '1700-DISCONNECT'  TO DP013-PARAGRAPH            02330099
023400            MOVE PV-ERROR-MESSAGE   TO DP013-MESSAGE-TEXT (1)     02340099
023500            MOVE PV-COMPLETION-CODE TO DP013-MESSAGE-TEXT (2)     02350099
023600            MOVE PV-REASON          TO DP013-MESSAGE-TEXT (3)     02360099
023700            SET DP013-CICS-ABEND                                  02370099
023800                DP013-NO-ROLLBACK    TO TRUE                      02380099
023900            PERFORM 9999-WRITE-CICS-LOG-MSG                       02390099
024000            PERFORM 9100-EXEC-CICS-RETURN                         02400099
024100        END-IF                                                    02410099
024200     END-IF.                                                      02420099
024300                                                                  02430099
024400******************************************************************02440099
024500**MAIN PROGRAM PROCESSOR                                          02450099
024600******************************************************************02460099
024700 2000-PROCESS-MESSAGES.                                           02470099
024800                                                                  02480099
024900      IF  PS-START-TRANID-YES                                     02490099
025000          PERFORM 2200-START-TRANID                               02500099
025100      END-IF.                                                     02510099
025200                                                                  02520099
025300      PERFORM 2100-MQGET-MSG.                                     02530099
025400                                                                  02540099
025500******************************************************************02550099
025600**GET MESSAGE FROM QUEUE FOR PROCESSING                           02560099
025700******************************************************************02570099
025800 2100-MQGET-MSG.                                                  02580099
025900                                                                  02590099
026000     INITIALIZE PV-MSGBUFFER.                                     02600099
026100     MOVE MQMI-NONE                   TO MQMD-MSGID.              02610099
026200     MOVE MQCI-NONE                   TO MQMD-CORRELID.           02620099
026300     MOVE RF-SVR-READ-Q               TO MQOD-OBJECTNAME.         02630099
026400     MOVE 1000                        TO MQGMO-WAITINTERVAL.      02640099
026500                                                                  02650099
026600     COMPUTE MQGMO-OPTIONS  = MQGMO-NO-SYNCPOINT +                02660099
026700                              MQGMO-CONVERT +                     02670099
026800                              MQGMO-WAIT.                         02680099
026900                                                                  02690099
027000     CALL WS-MQGET USING PV-HCONN                                 02700099
027100                         PV-GQ-HANDLE                             02710099
027200                         MQM-MESSAGE-DESCRIPTOR                   02720099
027300                         MQM-GET-MESSAGE-OPTIONS                  02730099
027400                         PV-MSGLENGTH                             02740099
027500                         PV-MSGBUFFER                             02750099
027600                         PV-DATA-LENGTH                           02760099
027700                         PV-COMPLETION-CODE                       02770099
027800                         PV-REASON.                               02780099
027900                                                                  02790099
028000     IF  PV-COMPLETION-CODE = MQCC-OK                             02800099
028100         SET PS-MQGET-SUCCESSFUL      TO TRUE                     02810099
028200         SET PS-START-TRANID-YES      TO TRUE                     02820099
028300         MOVE PC-YES                  TO PV-SEND-MQ-INDICATOR     02830099
028400         MOVE MQMD-REPLYTOQ           TO PV-SEND-REPLYTOQ         02840099
028500         MOVE MQMD-REPLYTOQMGR        TO PV-SEND-REPLYTOQMGR      02850099
028600         MOVE MQMD-MSGID              TO PV-SEND-MSGID            02860099
028700         MOVE PV-MSGBUFFER            TO PV-RECV-MSG-BUFFER       02870099
028800         MOVE PV-RECV-MSG             TO PV-SEND-BUFFER           02880099
028900     ELSE                                                         02890099
029000         IF  PV-REASON NOT EQUAL MQRC-NO-MSG-AVAILABLE            02900099
029100             MOVE PV-COMPLETION-CODE                              02910099
029200                                      TO PH-COMPLETION-CODE       02920099
029300             MOVE PV-REASON           TO PH-REASON                02930099
029400             PERFORM 1600-CLOSE-GET-Q                             02940099
029500             PERFORM 1700-DISCONNECT-QMGR                         02950099
029600             MOVE 'MQGET'             TO PV-ERROR-MESSAGE         02960099
029700             MOVE '2100-MQGET-MSG'    TO DP013-PARAGRAPH          02970099
029800             MOVE 'MQGET ERR'         TO DP013-MESSAGE-TEXT (1)   02980099
029900             MOVE PH-COMPLETION-CODE                              02990099
030000                                      TO DP013-MESSAGE-TEXT (2)   03000099
030100             MOVE PH-REASON           TO DP013-MESSAGE-TEXT (3)   03010099
030200             SET DP013-CICS-ABEND                                 03020099
030300                 DP013-NO-ROLLBACK    TO TRUE                     03030099
030400             PERFORM 9999-WRITE-CICS-LOG-MSG                      03040099
030500             PERFORM 9100-EXEC-CICS-RETURN                        03050099
030600         END-IF                                                   03060099
030700         SET PS-START-TRANID-NO       TO TRUE                     03070099
030800*        SET PS-MQGET-SUCCESSFUL-NOT  TO TRUE                     03080099
030900     END-IF.                                                      03090099
031000                                                                  03100099
031100******************************************************************03110099
031200**START TRANSACTION BASED ON HEADER INFORMATION ON TRANSACTION    03120099
031300******************************************************************03130099
031400 2200-START-TRANID.                                               03140099
031500                                                                  03150099
031600     MOVE LENGTH OF PV-SEND-MSG-BUFFER TO PV-START-LENGTH.        03160099
031700                                                                  03170099
031800     EXEC CICS START TRANSID (PV-RECV-TRANID)                     03180099
031900                     FROM    (PV-SEND-MSG-BUFFER)                 03190099
032000                     LENGTH  (PV-START-LENGTH)                    03200099
032100                     RESP    (PV-RC)                              03210099
032200     END-EXEC.                                                    03220099
032300                                                                  03230099
032400     EVALUATE TRUE                                                03240099
032500        WHEN PV-RC = 0                                            03250099
032600             CONTINUE                                             03260099
032700        WHEN PV-RC = 28                                           03270099
032800             MOVE 'EXEC CICS START' TO PV-ERROR-MESSAGE           03280099
032900             MOVE '2200-START-TRANID'                             03290099
033000                                    TO DP013-PARAGRAPH            03300099
033100             MOVE PV-ERROR-MESSAGE  TO DP013-MESSAGE-TEXT (1)     03310099
033200             MOVE PV-RECV-TRANID    TO DP013-MESSAGE-TEXT (2)     03320099
033300             PERFORM 9999-WRITE-CICS-LOG-MSG                      03330099
033400        WHEN OTHER                                                03340099
033500             PERFORM 1600-CLOSE-GET-Q                             03350099
033600             PERFORM 1700-DISCONNECT-QMGR                         03360099
033700             MOVE 'EXEC CICS START'     TO PV-ERROR-MESSAGE       03370099
033800             MOVE '2200-START-TRANID'   TO DP013-PARAGRAPH        03380099
033900             MOVE PV-ERROR-MESSAGE      TO DP013-MESSAGE-TEXT (1) 03390099
034000             MOVE PV-RECV-TRANID        TO DP013-MESSAGE-TEXT (2) 03400099
034100             SET DP013-CICS-ABEND                                 03410099
034200                 DP013-NO-ROLLBACK       TO TRUE                  03420099
034300             PERFORM 9999-WRITE-CICS-LOG-MSG                      03430099
034400             PERFORM 9100-EXEC-CICS-RETURN                        03440099
034500     END-EVALUATE.                                                03450099
034600                                                                  03460099
034700***-----------------------------------------------------------*** 03470099
034800*      PARAGRAPH WILL ISSUE A CICS RETURN                       * 03480099
034900***-----------------------------------------------------------*** 03490099
035000 9100-EXEC-CICS-RETURN.                                           03500099
035100     EXEC CICS                                                    03510099
035200         RETURN                                                   03520099
035300     END-EXEC.                                                    03530099
035400                                                                  03540099
035500***-----------------------------------------------------------*** 03550099
035600*      PARAGRAPH WILL WRITE THE CIC LOG MESSAGE WHEN ERROR      * 03560099
035700*      WHEN ERROR SITUATION IS ENCOUNTERED.                     * 03570099
035800***-----------------------------------------------------------*** 03580099
035900 9999-WRITE-CICS-LOG-MSG.                                         03590099
036000                                                                  03600099
036100     MOVE PC-CURRENT-PROGRAM-NAME                                 03610099
036200                                 TO DP013-PROGRAM.                03620099
036300     MOVE DFHEIBLK               TO DP013-DFHEIBLK.               03630099
036400     INITIALIZE DP013-SRC-TASK-NUMBER                             03640099
036500                DP013-STACK.                                      03650099
036600     SET DP013-LINK-RETURN       TO TRUE.                         03660099
036700                                                                  03670099
036800     EXEC CICS                                                    03680099
036900         LINK                                                     03690099
037000             PROGRAM   (DP013-NAME)                               03700099
037100             COMMAREA  (DP013-PARAMETERS)                         03710099
037200             LENGTH    (DP013-LENGTH)                             03720099
037300     END-EXEC.                                                    03730099
037400                                                                  03740099
037500*   NON-CICS ARCHITECTURE SYSTEM MESSAGE FORMAT MODULE            03750099
037600     COPY DPPD011.                                                03760099
037700*   NON-CICS ARCHITECTURE ABEND ROUTINE CALL                      03770099
037800     COPY DPPD014.                                                03780099
037900     COPY EPPD000.                                                03790099
